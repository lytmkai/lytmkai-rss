<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[å½“AIä¸ºä½ å†™SQLï¼Œè¿æ•°æ®åº“éƒ½å¼€å§‹è°ˆæ‹çˆ±äº†]]></title>    <link>https://juejin.cn/post/7579872561674633225</link>    <guid>https://juejin.cn/post/7579872561674633225</guid>    <pubDate>2025-12-04T16:14:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579872561674633225" data-draft-id="7579785426267619328" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å½“AIä¸ºä½ å†™SQLï¼Œè¿æ•°æ®åº“éƒ½å¼€å§‹è°ˆæ‹çˆ±äº† "/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,Python,SQL"/> <meta itemprop="datePublished" content="2025-12-04T16:14:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Qilana"/> <meta itemprop="url" content="https://juejin.cn/user/24668014656249"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å½“AIä¸ºä½ å†™SQLï¼Œè¿æ•°æ®åº“éƒ½å¼€å§‹è°ˆæ‹çˆ±äº† 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/24668014656249/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Qilana
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T16:14:51.000Z" title="Thu Dec 04 2025 16:14:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;color:rgba(46,36,36,.87);overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{margin-bottom:5px;font-size:30px;font-weight:500}.markdown-body h1:before{content:"#";margin-right:10px;color:#1976d2}.markdown-body h2{font-size:28px;font-weight:400;border-left:5px solid #454545;margin-top:20px;padding-left:10px;transition:all .3s ease-in-out}.markdown-body h2:hover{border-color:#1976d2}.markdown-body h3{font-size:24px;font-weight:400;margin-top:15px;padding-bottom:0}.markdown-body h4{font-size:20px;font-weight:500}.markdown-body h5{font-size:16px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h2:first-letter,.markdown-body h3:first-letter,.markdown-body p:first-letter{text-transform:capitalize}.markdown-body em{text-emphasis:dot;text-emphasis-position:under}.markdown-body img{display:block;margin:0 auto!important;max-width:100%;border-radius:2px;box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)!important}.markdown-body hr{position:relative;width:98%;height:1px;border:none;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,#ddd,#999,#ddd);overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center}.markdown-body code{font-weight:900;word-break:break-word;border-radius:2px;overflow-x:auto;font-size:.87em;padding:.065em .4em;background-color:#fbe5e1;color:#c0341d}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:0 4px}.markdown-body pre&gt;code{font-weight:400;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{margin:0 4px;text-decoration:none;color:#027fff;transition:all .3s ease-in-out;padding-bottom:4px;border-bottom:2px solid transparent}.markdown-body a:after{content:"";display:inline-block;width:18px;height:18px;margin-left:4px;vertical-align:middle;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMjdGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PHBhdGggZD0iTTkuODE1IDYuNDQ4bDEuOTM2LTEuOTM2YzEuMzM3LTEuMzM2IDMuNTgtMS4yNTkgNS4wMTMuMTczIDEuNDMyIDEuNDMyIDEuNTEgMy42NzYuMTczIDUuMDEzbC0xLjQ1MiAxLjQ1Mi0uOTY4Ljk2OGMtMS4zMzcgMS4zMzYtMy41ODEgMS4yNTktNS4wMTMtLjE3MyIvPjxwYXRoIGQ9Ik0xMS4yNjcgMTUuMzY3bC0xLjkzNiAxLjkzNmMtMS4zMzYgMS4zMzctMy41OCAxLjI2LTUuMDEyLS4xNzMtMS40MzItMS40MzItMS41MS0zLjY3Ni0uMTczLTUuMDEybDEuNDUyLTEuNDUyLjk2OC0uOTY4YzEuMzM2LTEuMzM3IDMuNTgtMS4yNiA1LjAxMi4xNzMiLz48L2c+PC9zdmc+);background-size:cover;background-repeat:no-repeat}.markdown-body a:hover{border-color:#027fff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body a.footnote-backref:after,.markdown-body a.footnote-ref:after,.markdown-body sup a:after{display:none!important}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border:2px solid #c6c6c6}.markdown-body table img{box-shadow:none!important}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body del{color:rgba(0,0,0,.6)}.markdown-body blockquote{position:relative;color:#666;padding:5px 23px 1px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:hsla(0,0%,78.4%,.12);transition:all .2s ease-in-out}.markdown-body blockquote:hover{border-color:#1976d2}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;font-size:24px;font-weight:800;line-height:24px;color:#cbcbcb;opacity:.6}.markdown-body blockquote:before{content:"â€œ";top:4px;left:6px}.markdown-body blockquote:after{content:"â€";right:8px;bottom:-8px}.markdown-body blockquote&gt;p,.markdown-body blockquote blockquote{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body details{outline:none;border:none;border-left:4px solid #1976d2;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary:hover::-webkit-details-marker{color:#1976d2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>è‡ªç„¶è¯­è¨€ç”Ÿæˆ SQLï¼Œå°±åƒæ‹äººè¯»æ‡‚ä½ æ²¡è¯´å‡ºå£çš„éœ€è¦ã€‚</strong><br/>
è€Œä»Šå¤©ï¼Œæˆ‘ä»¬è¦ä»ä¸€è¡Œè¡ŒçœŸå®çš„ Python ä»£ç å‡ºå‘ï¼Œçœ‹çœ‹è¿™ä»½â€œé»˜å¥‘â€æ˜¯å¦‚ä½•è¢«æ„å»ºå‡ºæ¥çš„ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ğŸ§  èƒŒåçš„ä¸»è§’ï¼šä¸€ä¸ªä¼šå†™ SQL çš„ AI åŠ©æ‰‹</h2>
<p>åœ¨ä½ çš„ç¬”è®°æœ¬ä¸­ï¼Œæ ¸å¿ƒé€»è¾‘å…¶å®éå¸¸æ¸…æ™°â€”â€”<br/>
<strong>ç”¨å¤§æ¨¡å‹ï¼ˆå¦‚ DeepSeekï¼‰å°†ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€é—®é¢˜ï¼Œè½¬åŒ–ä¸ºå¯æ‰§è¡Œçš„ SQL è¯­å¥</strong>ã€‚</p>
<p>æ•´ä¸ªæµç¨‹åˆ†ä¸ºå››æ­¥ï¼š</p>
<ol>
<li><strong>è¿æ¥æ•°æ®åº“ï¼Œå»ºè¡¨</strong></li>
<li><strong>æå–è¡¨ç»“æ„ï¼ˆSchemaï¼‰ä½œä¸ºä¸Šä¸‹æ–‡</strong></li>
<li><strong>æ„é€  Promptï¼Œè°ƒç”¨ LLM</strong></li>
<li><strong>æ‰§è¡Œç”Ÿæˆçš„ SQLï¼Œè¿”å›ç»“æœ</strong></li>
</ol>
<p>è¿™çœ‹ä¼¼ç®€å•ï¼Œå´è•´å«äº†ç°ä»£ AI åº”ç”¨çš„å…³é”®æ€æƒ³ï¼š<strong>ä¸Šä¸‹æ–‡é©±åŠ¨ + ç²¾å‡†çº¦æŸ + å®‰å…¨æ‰§è¡Œ</strong>ã€‚</p>
<h2 data-id="heading-1">ğŸ”Œ ç¬¬ä¸€æ­¥ï¼šè½»é‡çº§æ•°æ®åº“ï¼Œå¿«é€ŸéªŒè¯æƒ³æ³•</h2>
<p>ä½ ä½¿ç”¨äº† Python å†…ç½®çš„ <code>sqlite3</code> æ¨¡å—ï¼Œåˆ›å»ºäº†ä¸€å¼ å‘˜å·¥è¡¨ï¼š</p>
<pre><code class="hljs language-python" lang="python">cursor.execute(<span class="hljs-string">"""
CREATE TABLE IF NOT EXISTS employees(
 id INTEGER PRIMARY KEY,
 name TEXT,
 department TEXT,
 salary INTEGER
)
"""</span>)
</code></pre>
<p>æ¥ç€æ’å…¥å‡ æ¡ç¤ºä¾‹æ•°æ®ï¼ˆè™½ç„¶å› ä¸»é”®å†²çªæŠ¥é”™ï¼Œä½†æ— ä¼¤å¤§é›…ï¼‰ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">sample_data = <span class="hljs-selector-attr">[ (6, <span class="hljs-string">"é»„ä½³"</span>, <span class="hljs-string">"é”€å”®"</span>, 50000), (7, <span class="hljs-string">"å®å®"</span>, <span class="hljs-string">"å·¥ç¨‹"</span>, 75000), (8, <span class="hljs-string">"è°¦è°¦"</span>, <span class="hljs-string">"é”€å”®"</span>, 60000), (9, <span class="hljs-string">"æ‚¦æ‚¦"</span>, <span class="hljs-string">"å·¥ç¨‹"</span>, 80000), (10, <span class="hljs-string">"é»„ä»å‹‹"</span>, <span class="hljs-string">"å¸‚åœº"</span>, 55000), (11, <span class="hljs-string">"æœç»ç†"</span>, <span class="hljs-string">"å·¥ç¨‹"</span>, 80000)]</span>
<span class="hljs-attribute">cursor</span><span class="hljs-selector-class">.executemany</span>("INSERT INTO employees VALUES(?,?,?,?)", sample_data)
</code></pre>
<blockquote>
<p>ğŸ’¡ è¿™ä½“ç°äº†å¿«é€ŸåŸå‹å¼€å‘çš„ç²¾é«“ï¼š<strong>ç”¨æœ€è½»é‡çš„æ–¹å¼éªŒè¯æ ¸å¿ƒé€»è¾‘</strong>ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-2">ğŸ—ºï¸ ç¬¬äºŒæ­¥ï¼šæŠŠâ€œåœ°å›¾â€äº¤ç»™ AI â€”â€” Schema æ˜¯å…³é”®ï¼</h2>
<p>çœŸæ­£è®© LLM ä¸ççŒœçš„ï¼Œæ˜¯ä½ ä¸»åŠ¨æä¾›çš„ <strong>è¡¨ç»“æ„ä¿¡æ¯</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">schema</span> = cursor.execute(<span class="hljs-string">"PRAGMA table_info(employees)"</span>).fetchall()
<span class="hljs-attr">schema_str</span> = <span class="hljs-string">"CREATE TABLE EMPLOYEES (\n"</span> + <span class="hljs-string">"\n"</span>.join([f<span class="hljs-string">"{col[1]} {col[2]}"</span> for col in schema]) + <span class="hljs-string">"\n)"</span>
</code></pre>
<p>è¾“å‡ºç»“æœä¸ºï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> EMPLOYEES (
id <span class="hljs-type">INTEGER</span>
name TEXT
department TEXT
salary <span class="hljs-type">INTEGER</span>
)
</code></pre>
<p>è¿™ä¸€æ­¥è‡³å…³é‡è¦ï¼<br/>
æ²¡æœ‰ Schemaï¼ŒLLM åªèƒ½é çŒœå­—æ®µåï¼ˆæ¯”å¦‚ä¼šä¸ä¼šå« <code>dept</code> è€Œä¸æ˜¯ <code>department</code>ï¼Ÿï¼‰ï¼Œææ˜“å‡ºé”™ã€‚<br/>
è€Œæœ‰äº†å®ƒï¼ŒAI å°±åƒæ‹¿åˆ°äº†ä¸€å¼ <strong>ç²¾å‡†çš„æ•°æ®åœ°å›¾</strong>ï¼ŒçŸ¥é“å“ªé‡Œæ˜¯â€œå§“åâ€ï¼Œå“ªé‡Œæ˜¯â€œéƒ¨é—¨â€ã€‚</p>
<blockquote>
<p>âœ… <strong>ç»éªŒæ€»ç»“</strong>ï¼šText-to-SQL æˆåŠŸç‡ 80% å–å†³äº Schema æä¾›æ˜¯å¦å®Œæ•´æ¸…æ™°ã€‚</p>
</blockquote>
<h2 data-id="heading-3">ğŸ’Œ ç¬¬ä¸‰æ­¥ï¼šæ„é€  Prompt â€”â€” æ•™ AI â€œå¥½å¥½è¯´è¯â€</h2>
<p>ä½ è®¾è®¡çš„æç¤ºè¯éå¸¸å…‹åˆ¶è€Œæœ‰æ•ˆï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">prompt</span> = f<span class="hljs-string">"""
è¿™æ˜¯ä¸€ä¸ªæ•°æ®åº“çš„Schema:
{schema}
æ ¹æ®è¿™ä¸ªschema,è¯·è¾“å‡ºä¸€ä¸ªSQLæŸ¥è¯¢ï¼Œæ¥å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š
åªè¾“å‡ºSQLæŸ¥è¯¢è¯­å¥æœ¬èº«ï¼Œä¸è¦ä½¿ç”¨ä»»ä½•markdownæ ¼å¼ï¼Œä¸è¦åŒ…å«åå¼•å·ã€ä»£ç å—æ ‡è®°æˆ–é¢å¤–è¯´æ˜ã€‚
é—®é¢˜ï¼š{query}
"""</span>
</code></pre>
<p>å¹¶è®¾ç½®ï¼š</p>
<ul>
<li><code>temperature=0</code> â†’ ç¡®ä¿è¾“å‡ºç¡®å®šã€ç¨³å®š</li>
<li><code>max_tokens=2048</code> â†’ é˜²æ­¢æˆªæ–­</li>
<li><strong>æ˜ç¡®ç¦æ­¢å¤šä½™å†…å®¹</strong> â†’ é¿å…è¿”å›è§£é‡Šã€æ³¨é‡Šæˆ– Markdown</li>
</ul>
<p>ä¸ºä»€ä¹ˆè¿™ä¹ˆä¸¥æ ¼ï¼Ÿ<br/>
å› ä¸ºåç»­ä½ è¦ç›´æ¥ <code>cursor.execute(sql)</code> â€”â€”<br/>
å¦‚æœ AI è¿”å›çš„æ˜¯ï¼š</p>
<blockquote>
<p>â€œå¥½çš„ï¼ä»¥ä¸‹æ˜¯æŸ¥è¯¢è¯­å¥ï¼š\n<code>sql\nSELECT ...\n</code>â€</p>
</blockquote>
<p>é‚£ç¨‹åºå°±ä¼šå´©æºƒï¼</p>
<blockquote>
<p>âœ… <strong>æœ€ä½³å®è·µ</strong>ï¼šå¯¹ LLM çš„è¾“å‡ºåš<strong>æ ¼å¼å¼ºçº¦æŸ</strong>ï¼Œæ˜¯ç”Ÿäº§è½åœ°çš„å‰æã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-4">ğŸ¯ å®æˆ˜æ¼”ç¤ºï¼šä»â€œäººè¯â€åˆ°â€œæœºå™¨è¯­â€</h2>
<h3 data-id="heading-5">åœºæ™¯ä¸€ï¼šæŸ¥è¯¢</h3>
<blockquote>
<p>ç”¨æˆ·é—®ï¼šâ€œå·¥ç¨‹éƒ¨é—¨å‘˜å·¥çš„å§“åå’Œå·¥èµ„æ˜¯å¤šå°‘ï¼Ÿâ€</p>
</blockquote>
<p>AI è¾“å‡ºï¼š</p>
<pre><code class="hljs language-ini" lang="ini">SELECT name, salary FROM EMPLOYEES WHERE <span class="hljs-attr">department</span> = <span class="hljs-string">'å·¥ç¨‹'</span><span class="hljs-comment">;</span>
</code></pre>
<p>æ‰§è¡Œç»“æœï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[(<span class="hljs-string">'å®å®'</span>, 75000), (<span class="hljs-string">'æ‚¦æ‚¦'</span>, 80000), (<span class="hljs-string">'æœç»ç†'</span>, 80000)]</span>
</code></pre>
<p>âœ… å®Œç¾åŒ¹é…ä¸­æ–‡è¯­ä¹‰ï¼Œä¸”å­—æ®µã€è¡¨åå¤§å°å†™ä¸€è‡´ï¼ˆæ³¨æ„ä½ ç”¨äº† <code>EMPLOYEES</code> å…¨å¤§å†™ï¼ŒSQLite ä¸æ•æ„Ÿï¼Œä½†å¥½ä¹ æƒ¯å€¼å¾—ä¿æŒï¼‰ã€‚</p>
<hr/>
<h3 data-id="heading-6">åœºæ™¯äºŒï¼šæ’å…¥</h3>
<blockquote>
<p>ç”¨æˆ·è¯´ï¼šâ€œåœ¨é”€å”®éƒ¨é—¨å¢åŠ ä¸€ä¸ªæ–°å‘˜å·¥ï¼Œå§“åä¸ºå¼ ä¸‰ï¼Œå·¥èµ„ä¸º45000â€</p>
</blockquote>
<p>AI è¾“å‡ºï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> EMPLOYEES (name, department, salary) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-string">'é”€å”®'</span>, <span class="hljs-number">45000</span>);
</code></pre>
<p>æ³¨æ„ï¼š<strong>å®ƒè‡ªåŠ¨çœç•¥äº† <code>id</code> å­—æ®µ</strong>ï¼<br/>
å› ä¸ºä½ åœ¨å»ºè¡¨æ—¶è®¾äº† <code>id INTEGER PRIMARY KEY</code>ï¼ŒSQLite ä¼šè‡ªåŠ¨é€’å¢ã€‚<br/>
è¿™è¯´æ˜ LLM <strong>ç†è§£ä¸»é”®è‡ªå¢è¯­ä¹‰</strong>ï¼Œéå¸¸èªæ˜ã€‚</p>
<hr/>
<h3 data-id="heading-7">åœºæ™¯ä¸‰ï¼šåˆ é™¤</h3>
<blockquote>
<p>ç”¨æˆ·æŒ‡ä»¤ï¼šâ€œåˆ é™¤å¸‚åœºéƒ¨é—¨çš„é»„ä»å‹‹â€</p>
</blockquote>
<p>AI è¾“å‡ºï¼š</p>
<pre><code class="hljs language-ini" lang="ini">DELETE FROM EMPLOYEES WHERE <span class="hljs-attr">department</span> = <span class="hljs-string">'å¸‚åœº'</span> AND name = <span class="hljs-string">'é»„ä»å‹‹'</span><span class="hljs-comment">;</span>
</code></pre>
<p>âœ… æ¡ä»¶å®Œæ•´ï¼Œé¿å…è¯¯åˆ ã€‚<br/>
ä½†å¦‚æœç”¨æˆ·è¯´â€œåˆ æ‰é»„ä»å‹‹â€ï¼Œæ²¡æéƒ¨é—¨ï¼Œå°±å¯èƒ½è¯¯åˆ é‡åè€…â€”â€”<br/>
è¿™æé†’æˆ‘ä»¬ï¼š<strong>ä¸šåŠ¡è¯­ä¹‰éœ€è¶³å¤Ÿæ˜ç¡®ï¼Œæˆ–ç³»ç»Ÿåº”ä¸»åŠ¨æ¾„æ¸…</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-8">âš ï¸ å®‰å…¨åæ€ï¼šä¸èƒ½ç›²ç›®ä¿¡ä»»ç”Ÿæˆç»“æœ</h2>
<p>å°½ç®¡ Demo å¾ˆç¾å¥½ï¼Œä½†çœŸå®åœºæ™¯å¿…é¡»è€ƒè™‘ï¼š</p>

























<table><thead><tr><th>é£é™©</th><th>ä½ çš„ä»£ç ç°çŠ¶</th><th>å»ºè®®æ”¹è¿›</th></tr></thead><tbody><tr><td>æ‰§è¡Œä»»æ„ SQL</td><td>ç›´æ¥ <code>cursor.execute(sql_query)</code></td><td>åŠ å…¥ SQL ç™½åå•ï¼ˆå¦‚åªå…è®¸ <code>SELECT</code>ï¼‰</td></tr><tr><td>è¡¨å/å­—æ®µæ³¨å…¥</td><td>ä¾èµ– LLM è¾“å‡º</td><td>ç”¨æ­£åˆ™æ ¡éªŒæ˜¯å¦åªå«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿</td></tr><tr><td>æ—  WHERE åˆ é™¤</td><td>å½“å‰ç¤ºä¾‹æœ‰ WHERE</td><td>å¼ºåˆ¶æ ¡éªŒ <code>DELETE/UPDATE</code> å¿…é¡»å¸¦æ¡ä»¶</td></tr></tbody></table>
<blockquote>
<p>ğŸ”’ <strong>è®°ä½</strong>ï¼šDemo å¯ä»¥æµªæ¼«ï¼Œç”Ÿäº§å¿…é¡»ä¸¥è°¨ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-9">ğŸŒ± å»¶ä¼¸æ€è€ƒï¼šå¦‚ä½•èå…¥ MVC æ¶æ„ï¼Ÿ</h2>
<p>æ­£å¦‚ç†å¿µæ‰€å€¡å¯¼çš„ <strong>AI First + Mobile First + MVC</strong>ï¼Œä½ å¯ä»¥è¿™æ ·æ‰©å±•ï¼š</p>
<ul>
<li><strong>Model</strong>ï¼šå°è£…æ•°æ®åº“æ“ä½œï¼Œæä¾› <code>query_by_natural_language(text)</code> æ–¹æ³•</li>
<li><strong>View</strong>ï¼šç§»åŠ¨ç«¯èŠå¤©ç•Œé¢ï¼Œè¾“å…¥æ¡† + ç»“æœå¡ç‰‡</li>
<li><strong>Controller</strong>ï¼šæ¥æ”¶ç”¨æˆ·æ¶ˆæ¯ â†’ è°ƒç”¨ AI ç”Ÿæˆ SQL â†’ æ‰§è¡Œ â†’ è¿”å›ç»“æ„åŒ–æ•°æ®</li>
</ul>
<p>æœªæ¥ç”šè‡³å¯åŠ å…¥ï¼š</p>
<ul>
<li>å¤šè½®å¯¹è¯ï¼ˆâ€œåˆšæ‰é‚£ä¸ªå·¥ç¨‹éƒ¨çš„äººï¼Œå†æŸ¥ä¸‹ä»–çš„å…¥èŒæ—¶é—´â€ï¼‰</li>
<li>æƒé™æ§åˆ¶ï¼ˆé”€å”®åªèƒ½æŸ¥é”€å”®éƒ¨æ•°æ®ï¼‰</li>
<li>è‡ªç„¶è¯­è¨€è½¬å¯è§†åŒ–å›¾è¡¨ï¼ˆâ€œç”»ä¸ªæŸ±çŠ¶å›¾â€ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-10">âœ¨ ç»“è¯­ï¼šæŠ€æœ¯çš„æ¸©åº¦ï¼Œåœ¨äºâ€œç†è§£â€è€Œéâ€œæ‰§è¡Œâ€</h2>
<p>å›åˆ°å¼€å¤´é‚£å¥è¯ï¼š</p>
<blockquote>
<p>ä½ è¯´â€œæˆ‘æƒ³çŸ¥é“ä¸Šä¸ªæœˆè°æœ€å¸¸ä¹°æˆ‘ä»¬çš„èŠ±ã€‚â€<br/>
TA é»˜é»˜å†™ä¸‹ SQLï¼Œä¸ºä½ æ‰“æç­”æ¡ˆã€‚</p>
</blockquote>
<p>è€Œåœ¨è¿™ä»½ä»£ç ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„ä¸ä»…æ˜¯ <code>OpenAI</code> å®¢æˆ·ç«¯ã€<code>sqlite3</code> æ¸¸æ ‡ã€<code>executemany</code>ï¼Œ<br/>
æ›´æ˜¯ä¸€ç§<strong>ä»¥äººä¸ºæœ¬çš„è®¾è®¡å“²å­¦</strong>ï¼š</p>
<ul>
<li>ç»™ AI è¶³å¤Ÿä¸Šä¸‹æ–‡ï¼ˆSchemaï¼‰</li>
<li>çº¦æŸè¾“å‡ºæ ¼å¼ï¼ˆçº¯ SQLï¼‰</li>
<li>å®‰å…¨æ‰§è¡Œç»“æœï¼ˆcommit / fetchallï¼‰</li>
</ul>
<p><strong>çœŸæ­£çš„æ™ºèƒ½ï¼Œä¸æ˜¯ç‚«æŠ€ï¼Œè€Œæ˜¯è®©éæŠ€æœ¯äººå‘˜ä¹Ÿèƒ½å¹³ç­‰åœ°ä½¿ç”¨æ•°æ®ã€‚</strong></p>
<p>è€Œè¿™ï¼Œæˆ–è®¸å°±æ˜¯ä¸‹ä¸€ä»£åº”ç”¨çš„èµ·ç‚¹ã€‚</p>
<hr/>
<p>ğŸ“¬ <strong>ç°åœ¨ï¼Œè½®åˆ°ä½ äº†</strong>ï¼š<br/>
è¯•ç€æ”¹å†™ <code>ask_deepseek</code> å‡½æ•°ï¼Œè®©å®ƒæ”¯æŒå¤šè¡¨å…³è”ï¼Œæˆ–è€…è‡ªåŠ¨å¤„ç†æ—¥æœŸèŒƒå›´ï¼ˆå¦‚â€œä¸Šä¸ªæœˆâ€ â†’ <code>BETWEEN '2025-11-01' AND '2025-11-30'</code>ï¼‰ã€‚<br/>
ä½ ä¼šå‘ç°ï¼Œ<strong>AI æ˜¯ç¬”ï¼Œä½ æ˜¯è¯—äºº</strong>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ„å»ºä¼ä¸šçº§ä»£ç çŸ¥è¯†å›¾è°±ç³»ç»Ÿï¼šä»ç†è®ºåˆ°å®è·µ]]></title>    <link>https://juejin.cn/post/7579659550863114282</link>    <guid>https://juejin.cn/post/7579659550863114282</guid>    <pubDate>2025-12-04T16:36:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579659550863114282" data-draft-id="7579846685070966838" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ„å»ºä¼ä¸šçº§ä»£ç çŸ¥è¯†å›¾è°±ç³»ç»Ÿï¼šä»ç†è®ºåˆ°å®è·µ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-04T16:36:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="www769"/> <meta itemprop="url" content="https://juejin.cn/user/1656332880187112"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ„å»ºä¼ä¸šçº§ä»£ç çŸ¥è¯†å›¾è°±ç³»ç»Ÿï¼šä»ç†è®ºåˆ°å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1656332880187112/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    www769
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T16:36:17.000Z" title="Thu Dec 04 2025 16:36:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>åœ¨ç°ä»£è½¯ä»¶å¼€å‘ä¸­ï¼Œä»£ç åº“çš„å¤æ‚æ€§ä¸æ—¥ä¿±å¢ã€‚ä¼ ç»Ÿçš„é™æ€åˆ†æå·¥å…·è™½ç„¶èƒ½å¤Ÿæä¾›åŸºæœ¬çš„ä»£ç å…³ç³»ä¿¡æ¯ï¼Œä½†å¾€å¾€ç¼ºä¹æ·±å±‚æ¬¡çš„è¯­ä¹‰ç†è§£å’Œä¸Šä¸‹æ–‡å…³è”ã€‚éšç€AIè¾…åŠ©ç¼–ç¨‹çš„æ™®åŠï¼Œæˆ‘ä»¬è¿«åˆ‡éœ€è¦ä¸€å¥—èƒ½å¤Ÿä¸ºAIæ¨¡å‹æä¾›ç»“æ„åŒ–ä»£ç çŸ¥è¯†çš„ç³»ç»Ÿã€‚</p>
<p>æˆ‘ä»¬å¼€å‘äº†Legacy Code Archaeologistâ€”â€”ä¸€ä¸ªåŸºäºçŸ¥è¯†å›¾è°±çš„ä»£ç åˆ†æå¹³å°ã€‚æœ¬æ–‡å°†æ¯«æ— ä¿ç•™åœ°åˆ†äº«è¿™å¥—ç³»ç»Ÿçš„å®Œæ•´æ„å»ºè¿‡ç¨‹ï¼ŒåŒ…æ‹¬è¸©è¿‡çš„å‘å’Œç§¯ç´¯çš„ç»éªŒã€‚</p>
<h2 data-id="heading-1">ç³»ç»Ÿæ¶æ„è®¾è®¡</h2>
<h3 data-id="heading-2">æ•´ä½“æ¶æ„æ¦‚è§ˆ</h3>
<p>æ„å»ºä»£ç çŸ¥è¯†å›¾è°±ç³»ç»Ÿçš„æ ¸å¿ƒæŒ‘æˆ˜åœ¨äºå¦‚ä½•å°†éç»“æ„åŒ–çš„ä»£ç è½¬æ¢ä¸ºç»“æ„åŒ–çš„å…³ç³»æ•°æ®ï¼Œå¹¶ä»¥é«˜æ•ˆçš„æ–¹å¼ä¸ºAIæ¨¡å‹æä¾›æœåŠ¡ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph "è¾“å…¥å±‚"
        A[æºä»£ç æ–‡ä»¶] --&gt; B[æ–‡ä»¶ç›‘å¬å™¨]
        B --&gt; C[å¢é‡æ£€æµ‹]
    end
    
    subgraph "è§£æå±‚"
        C --&gt; D[Tree-sitterè§£æå™¨]
        D --&gt; E[è¯­æ³•æ ‘ç”Ÿæˆ]
        E --&gt; F[ç¬¦å·è¡¨æ„å»º]
        F --&gt; G[å…³ç³»æå–å™¨]
    end
    
    subgraph "å­˜å‚¨å±‚"
        G --&gt; H[å›¾æ•°æ®åº“]
        H --&gt; I[å…³ç³»ç´¢å¼•]
        I --&gt; J[ç¼“å­˜å±‚]
    end
    
    subgraph "æœåŠ¡å±‚"
        J --&gt; K[MCPåè®®å±‚]
        K --&gt; L[RESTful API]
        L --&gt; M[WebSocketå®æ—¶æ¨é€]
    end
    
    subgraph "åº”ç”¨å±‚"
        M --&gt; N[AIåŠ©æ‰‹é›†æˆ]
        M --&gt; O[å¯è§†åŒ–ç•Œé¢]
        M --&gt; P[IDEæ’ä»¶]
    end
</code></pre>
<h3 data-id="heading-3">æŠ€æœ¯é€‰å‹è€ƒé‡</h3>
<p>åœ¨ç³»ç»Ÿè®¾è®¡åˆæœŸï¼Œæˆ‘ä»¬é¢ä¸´å¤šä¸ªæŠ€æœ¯é€‰å‹å†³ç­–ã€‚è¿™é‡Œåˆ†äº«å‡ ä¸ªå…³é”®çš„æƒè¡¡ï¼š</p>
<h4 data-id="heading-4">è§£æå™¨é€‰æ‹©ï¼šTree-sitter vs ANTLR</h4>



































<table><thead><tr><th>ç‰¹æ€§</th><th>Tree-sitter</th><th>ANTLR</th></tr></thead><tbody><tr><td>è§£æé€Ÿåº¦</td><td>â­â­â­â­â­</td><td>â­â­â­</td></tr><tr><td>å®¹é”™èƒ½åŠ›</td><td>â­â­â­â­â­</td><td>â­â­</td></tr><tr><td>è¯­è¨€æ”¯æŒ</td><td>â­â­â­â­</td><td>â­â­â­â­â­</td></tr><tr><td>å¢é‡è§£æ</td><td>â­â­â­â­â­</td><td>â­</td></tr><tr><td>ç¤¾åŒºæ”¯æŒ</td><td>â­â­â­</td><td>â­â­â­â­â­</td></tr></tbody></table>
<p>æœ€ç»ˆé€‰æ‹©Tree-sitterçš„åŸå› ï¼š</p>
<ol>
<li><strong>å¢é‡è§£æèƒ½åŠ›</strong>ï¼šå¯¹äºå®æ—¶ç³»ç»Ÿè‡³å…³é‡è¦</li>
<li><strong>é”™è¯¯æ¢å¤æœºåˆ¶</strong>ï¼šèƒ½å¤Ÿå¤„ç†ä¸å®Œæ•´æˆ–è¯­æ³•é”™è¯¯çš„ä»£ç </li>
<li><strong>ç»Ÿä¸€æ¥å£</strong>ï¼šæ‰€æœ‰è¯­è¨€ä½¿ç”¨ç›¸åŒçš„æŸ¥è¯¢è¯­æ³•</li>
</ol>
<h4 data-id="heading-5">å­˜å‚¨æ–¹æ¡ˆï¼šå›¾æ•°æ®åº“ vs å…³ç³»æ•°æ®åº“</h4>
<p>ç»è¿‡æ€§èƒ½æµ‹è¯•ï¼Œæˆ‘ä»¬å‘ç°å¯¹äºä»£ç å…³ç³»æŸ¥è¯¢åœºæ™¯ï¼ŒSQLiteé…åˆé€‚å½“çš„ç´¢å¼•è®¾è®¡åè€Œæ¯”Neo4jç­‰ä¸“ä¸šå›¾æ•°æ®åº“æ€§èƒ½æ›´å¥½ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    subgraph "å…³ç³»å‹å­˜å‚¨è®¾è®¡"
        A[nodesè¡¨] --&gt; B[qualified_nameç´¢å¼•]
        A --&gt; C[typeç´¢å¼•]
        D[edgesè¡¨] --&gt; E[src_id + dst_idå¤åˆç´¢å¼•]
        D --&gt; F[relation_typeç´¢å¼•]
        A --&gt; D
    end
</code></pre>
<p>è¿™ç§è®¾è®¡çš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>éƒ¨ç½²ç®€å•</strong>ï¼šæ— éœ€é¢å¤–çš„å›¾æ•°æ®åº“æœåŠ¡</li>
<li><strong>æŸ¥è¯¢çµæ´»</strong>ï¼šSQLæ¯”Cypheræ›´é€šç”¨</li>
<li><strong>æ€§èƒ½å¯æ§</strong>ï¼šç´¢å¼•ç­–ç•¥å®Œå…¨å¯æ§</li>
</ul>
<h2 data-id="heading-6">æ ¸å¿ƒç»„ä»¶å®ç°</h2>
<h3 data-id="heading-7">ä»£ç è§£æå¼•æ“</h3>
<p>ä»£ç è§£ææ˜¯æ•´ä¸ªç³»ç»Ÿçš„åŸºç¡€ï¼Œéœ€è¦ä»æºä»£ç ä¸­å‡†ç¡®æå–å‡ºå®ä½“å’Œå…³ç³»ã€‚ä»¥Pythonä»£ç ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[Pythonæºæ–‡ä»¶] --&gt; B[Tree-sitterè§£æ]
    B --&gt; C[ASTéå†]
    C --&gt; D[å®ä½“è¯†åˆ«]
    C --&gt; E[å…³ç³»æå–]
    
    subgraph "å®ä½“ç±»å‹"
        F[ç±»å®šä¹‰]
        G[å‡½æ•°å®šä¹‰]
        H[å˜é‡å®šä¹‰]
        I[å¯¼å…¥è¯­å¥]
    end
    
    subgraph "å…³ç³»ç±»å‹"
        J[ç»§æ‰¿å…³ç³»]
        K[è°ƒç”¨å…³ç³»]
        L[ä¾èµ–å…³ç³»]
        M[æ•°æ®æµå…³ç³»]
    end
    
    D --&gt; F
    D --&gt; G  
    D --&gt; H
    D --&gt; I
    
    E --&gt; J
    E --&gt; K
    E --&gt; L
    E --&gt; M
</code></pre>
<p>å…³é”®çš„å®ç°ç»†èŠ‚åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>ä½œç”¨åŸŸè§£æ</strong>ï¼šæ­£ç¡®å¤„ç†å˜é‡çš„ä½œç”¨åŸŸï¼Œé¿å…å‘½åå†²çª</li>
<li><strong>ç±»å‹æ¨å¯¼</strong>ï¼šåŸºäºèµ‹å€¼å’Œå‡½æ•°ç­¾åæ¨å¯¼å˜é‡ç±»å‹</li>
<li><strong>è·¨æ–‡ä»¶å¼•ç”¨</strong>ï¼šè§£æimportè¯­å¥ï¼Œå»ºç«‹æ¨¡å—é—´çš„ä¾èµ–å…³ç³»</li>
</ol>
<h3 data-id="heading-8">å¢é‡æ›´æ–°æœºåˆ¶</h3>
<p>å¯¹äºå¤§å‹ä»£ç åº“ï¼Œå…¨é‡é‡æ–°è§£ææ˜¯ä¸ç°å®çš„ã€‚æˆ‘ä»¬è®¾è®¡äº†ä¸€å¥—å¢é‡æ›´æ–°æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant FS as æ–‡ä»¶ç³»ç»Ÿç›‘å¬
    participant IU as å¢é‡æ›´æ–°å™¨
    participant Parser as è§£æå™¨
    participant Graph as å›¾å­˜å‚¨
    participant Event as äº‹ä»¶æ€»çº¿

    FS-&gt;&gt;IU: æ–‡ä»¶å˜æ›´äº‹ä»¶
    IU-&gt;&gt;IU: è®¡ç®—å½±å“èŒƒå›´
    IU-&gt;&gt;Graph: åˆ é™¤æ—§å…³ç³»
    IU-&gt;&gt;Parser: è§£æå˜æ›´æ–‡ä»¶
    Parser-&gt;&gt;Graph: æ’å…¥æ–°å…³ç³»
    Graph-&gt;&gt;Event: å¹¿æ’­æ›´æ–°äº‹ä»¶
    Event-&gt;&gt;Client: æ¨é€ç»™å‰ç«¯
</code></pre>
<p>å¢é‡æ›´æ–°çš„æ ¸å¿ƒç®—æ³•ï¼š</p>
<ol>
<li><strong>ä¾èµ–åˆ†æ</strong>ï¼šæ„å»ºæ–‡ä»¶é—´çš„ä¾èµ–å›¾</li>
<li><strong>å½±å“èŒƒå›´è®¡ç®—</strong>ï¼šæ‰¾å‡ºéœ€è¦é‡æ–°è§£æçš„æ–‡ä»¶é›†åˆ</li>
<li><strong>å…³ç³»æ¸…ç†</strong>ï¼šåˆ é™¤è¿‡æ—¶çš„å…³ç³»è®°å½•</li>
<li><strong>é€‰æ‹©æ€§é‡å»º</strong>ï¼šåªé‡æ–°æ„å»ºå—å½±å“çš„éƒ¨åˆ†</li>
</ol>
<h3 data-id="heading-9">MCPåè®®é›†æˆ</h3>
<p>Model Context Protocol (MCP)æ˜¯æˆ‘ä»¬ä¸AIæ¨¡å‹é€šä¿¡çš„æ¡¥æ¢ã€‚åè®®æ ˆçš„è®¾è®¡å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph "MCPåè®®æ ˆ"
        A[HTTP/SSEä¼ è¾“å±‚] --&gt; B[JSON-RPCæ¶ˆæ¯å±‚]
        B --&gt; C[å·¥å…·è°ƒç”¨å±‚]
        C --&gt; D[èµ„æºè®¿é—®å±‚]
    end
    
    subgraph "å·¥å…·ç±»å‹"
        E[scan_full - å…¨é‡æ‰«æ]
        F[scan_incremental - å¢é‡æ‰«æ] 
        G[analyze_relationships - å…³ç³»åˆ†æ]
    end
    
    subgraph "èµ„æºç±»å‹"
        H[graph/stats - ç»Ÿè®¡ä¿¡æ¯]
        I[graph/nodes - èŠ‚ç‚¹è¯¦æƒ…]
        J[graph/edges - å…³ç³»åˆ—è¡¨]
    end
    
    C --&gt; E
    C --&gt; F
    C --&gt; G
    
    D --&gt; H
    D --&gt; I  
    D --&gt; J
</code></pre>
<h2 data-id="heading-10">æ€§èƒ½ä¼˜åŒ–å®è·µ</h2>
<h3 data-id="heading-11">æŸ¥è¯¢ä¼˜åŒ–ç­–ç•¥</h3>
<p>åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å‘ç°æŸ¥è¯¢æ€§èƒ½æ˜¯ç³»ç»Ÿå¯ç”¨æ€§çš„å…³é”®ã€‚ä»¥ä¸‹æ˜¯å‡ ä¸ªé‡è¦çš„ä¼˜åŒ–ç­–ç•¥ï¼š</p>
<h4 data-id="heading-12">1. ç´¢å¼•è®¾è®¡</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æ ¸å¿ƒç´¢å¼•è®¾è®¡</span>
<span class="hljs-keyword">CREATE</span> INDEX idx_nodes_qualified_name <span class="hljs-keyword">ON</span> nodes(qualified_name);
<span class="hljs-keyword">CREATE</span> INDEX idx_nodes_type <span class="hljs-keyword">ON</span> nodes(type);
<span class="hljs-keyword">CREATE</span> INDEX idx_edges_src_dst <span class="hljs-keyword">ON</span> edges(src_id, dst_id);
<span class="hljs-keyword">CREATE</span> INDEX idx_edges_relation <span class="hljs-keyword">ON</span> edges(relation_type);

<span class="hljs-comment">-- å¤åˆæŸ¥è¯¢ä¼˜åŒ–</span>
<span class="hljs-keyword">CREATE</span> INDEX idx_edges_complex <span class="hljs-keyword">ON</span> edges(src_id, relation_type, dst_id);
</code></pre>
<h4 data-id="heading-13">2. ç¼“å­˜ç­–ç•¥</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[æŸ¥è¯¢è¯·æ±‚] --&gt; B{ç¼“å­˜æ£€æŸ¥}
    B --&gt;|å‘½ä¸­| C[è¿”å›ç¼“å­˜ç»“æœ]
    B --&gt;|æœªå‘½ä¸­| D[æ•°æ®åº“æŸ¥è¯¢]
    D --&gt; E[æ›´æ–°ç¼“å­˜]
    E --&gt; F[è¿”å›ç»“æœ]
    
    subgraph "ç¼“å­˜å±‚çº§"
        G[å†…å­˜ç¼“å­˜ - çƒ­ç‚¹æ•°æ®]
        H[Redisç¼“å­˜ - ä¼šè¯æ•°æ®]
        I[æœ¬åœ°æ–‡ä»¶ç¼“å­˜ - å›¾æ•°æ®]
    end
</code></pre>
<h4 data-id="heading-14">3. æ‰¹å¤„ç†ä¼˜åŒ–</h4>
<p>å¯¹äºå¤§å‹é¡¹ç›®çš„æ‰«æï¼Œæˆ‘ä»¬é‡‡ç”¨æ‰¹å¤„ç†ç­–ç•¥ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">batch_process_files</span>(<span class="hljs-params">file_paths: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>], batch_size: <span class="hljs-built_in">int</span> = <span class="hljs-number">50</span></span>):
    <span class="hljs-string">"""æ‰¹é‡å¤„ç†æ–‡ä»¶ï¼Œé¿å…å†…å­˜æº¢å‡º"""</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(file_paths), batch_size):
        batch = file_paths[i:i + batch_size]
        <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> asyncio.TaskGroup() <span class="hljs-keyword">as</span> tg:
            tasks = [tg.create_task(parse_file(fp)) <span class="hljs-keyword">for</span> fp <span class="hljs-keyword">in</span> batch]
        
        <span class="hljs-comment"># æ¯ä¸ªæ‰¹æ¬¡åè¿›è¡Œåƒåœ¾å›æ”¶</span>
        gc.collect()
</code></pre>
<h3 data-id="heading-15">å†…å­˜ç®¡ç†</h3>
<p>å¤§å‹ä»£ç åº“åˆ†ææ—¶ï¼Œå†…å­˜ä½¿ç”¨æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[å†…å­˜ä½¿ç”¨ç›‘æ§] --&gt; B{å†…å­˜ä½¿ç”¨ç‡æ£€æŸ¥}
    B --&gt;|&gt; 80%| C[è§¦å‘åƒåœ¾å›æ”¶]
    B --&gt;|&gt; 90%| D[æš‚åœè§£æ]
    C --&gt; E[é‡Šæ”¾ç¼“å­˜]
    D --&gt; F[ç­‰å¾…å†…å­˜é‡Šæ”¾]
    E --&gt; G[ç»§ç»­å¤„ç†]
    F --&gt; G
</code></pre>
<h2 data-id="heading-16">å®é™…éƒ¨ç½²ç»éªŒ</h2>
<h3 data-id="heading-17">å®¹å™¨åŒ–éƒ¨ç½²</h3>
<p>ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨Dockerè¿›è¡Œéƒ¨ç½²ï¼š</p>
<pre><code class="hljs language-dockerfile" lang="dockerfile"># å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–é•œåƒå¤§å°
FROM python:3.11-slim as builder
WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

FROM python:3.11-slim
WORKDIR /app
COPY --from=builder /usr/local/lib/python3.11/site-packages /usr/local/lib/python3.11/site-packages
COPY . .
EXPOSE 8080
CMD ["python", "run_web_server.py", "--host", "0.0.0.0"]
</code></pre>
<h3 data-id="heading-18">ç›‘æ§å’Œå‘Šè­¦</h3>
<p>ç³»ç»Ÿç›‘æ§çš„æŒ‡æ ‡è®¾è®¡ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    subgraph "æ€§èƒ½æŒ‡æ ‡"
        A[è§£æé€Ÿåº¦ - files/sec]
        B[æŸ¥è¯¢å»¶è¿Ÿ - ms]
        C[å†…å­˜ä½¿ç”¨ç‡ - %]
    end
    
    subgraph "ä¸šåŠ¡æŒ‡æ ‡"  
        D[å›¾è°±è§„æ¨¡ - nodes/edges]
        E[å¢é‡æ›´æ–°é¢‘ç‡ - updates/min]
        F[APIè°ƒç”¨é‡ - qps]
    end
    
    subgraph "å‘Šè­¦è§„åˆ™"
        G[è§£æé€Ÿåº¦ &lt; 10 files/sec]
        H[æŸ¥è¯¢å»¶è¿Ÿ &gt; 1000ms]
        I[å†…å­˜ä½¿ç”¨ &gt; 85%]
    end
</code></pre>
<h2 data-id="heading-19">è¸©å‘æ€»ç»“</h2>
<p>åœ¨ç³»ç»Ÿå¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é‡åˆ°äº†ä¸å°‘æŠ€æœ¯æŒ‘æˆ˜ï¼Œè¿™é‡Œåˆ†äº«å‡ ä¸ªé‡è¦çš„ç»éªŒï¼š</p>
<h3 data-id="heading-20">1. Tree-sitterå†…å­˜æ³„æ¼</h3>
<p>æ—©æœŸç‰ˆæœ¬ä¸­å‘ç°Tree-sitteråœ¨é•¿æ—¶é—´è¿è¡Œåä¼šå‡ºç°å†…å­˜æ³„æ¼ï¼Œè§£å†³æ–¹æ¡ˆï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å®šæœŸé‡Šæ”¾è§£æå™¨èµ„æº</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ParserManager</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.parser = <span class="hljs-literal">None</span>
        self.parse_count = <span class="hljs-number">0</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">parse</span>(<span class="hljs-params">self, code: <span class="hljs-built_in">str</span></span>):
        <span class="hljs-keyword">if</span> self.parse_count &gt; <span class="hljs-number">1000</span>:  <span class="hljs-comment"># æ¯1000æ¬¡è§£æåé‡å»º</span>
            self.parser = <span class="hljs-literal">None</span>
            self.parse_count = <span class="hljs-number">0</span>
            
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.parser:
            self.parser = get_parser()
            
        self.parse_count += <span class="hljs-number">1</span>
        <span class="hljs-keyword">return</span> self.parser.parse(<span class="hljs-built_in">bytes</span>(code, <span class="hljs-string">'utf8'</span>))
</code></pre>
<h3 data-id="heading-21">2. å¾ªç¯ä¾èµ–å¤„ç†</h3>
<p>ä»£ç ä¸­çš„å¾ªç¯ä¾èµ–ä¼šå¯¼è‡´è§£ææ­»å¾ªç¯ï¼Œæˆ‘ä»¬é‡‡ç”¨æ·±åº¦é™åˆ¶å’Œè®¿é—®è®°å½•ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">resolve_dependencies</span>(<span class="hljs-params">node: <span class="hljs-built_in">str</span>, visited: <span class="hljs-type">Set</span>[<span class="hljs-built_in">str</span>], depth: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span></span>):
    <span class="hljs-keyword">if</span> depth &gt; <span class="hljs-number">50</span> <span class="hljs-keyword">or</span> node <span class="hljs-keyword">in</span> visited:  <span class="hljs-comment"># é˜²æ­¢æ— é™é€’å½’</span>
        <span class="hljs-keyword">return</span> []
    
    visited.add(node)
    <span class="hljs-comment"># ... ä¾èµ–è§£æé€»è¾‘</span>
</code></pre>
<h3 data-id="heading-22">3. å¤§æ–‡ä»¶å¤„ç†</h3>
<p>å¯¹äºè¶…å¤§æ–‡ä»¶ï¼ˆ&gt;1MBï¼‰ï¼Œç›´æ¥è§£æå¯èƒ½å¯¼è‡´ç³»ç»Ÿå¡æ­»ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">should_skip_file</span>(<span class="hljs-params">file_path: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">bool</span>:
    <span class="hljs-string">"""æ£€æŸ¥æ–‡ä»¶æ˜¯å¦åº”è¯¥è·³è¿‡è§£æ"""</span>
    size = os.path.getsize(file_path)
    <span class="hljs-keyword">if</span> size &gt; <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>:  <span class="hljs-comment"># 1MB</span>
        logger.warning(<span class="hljs-string">f"Skipping large file: <span class="hljs-subst">{file_path}</span> (<span class="hljs-subst">{size}</span> bytes)"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
</code></pre>
<h2 data-id="heading-23">æœªæ¥å±•æœ›</h2>
<p>åŸºäºå½“å‰ç³»ç»Ÿçš„å®è·µç»éªŒï¼Œæˆ‘ä»¬è®¡åˆ’åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹å‘è¿›è¡Œæ”¹è¿›ï¼š</p>
<h3 data-id="heading-24">æ™ºèƒ½è®°å¿†ç³»ç»Ÿ</h3>
<p>å½“å‰ç³»ç»Ÿçš„ä¸€ä¸ªä¸»è¦é—®é¢˜æ˜¯ä¼šå°†å¤§é‡æ•°æ®ä¸€æ¬¡æ€§ä¼ é€’ç»™AIæ¨¡å‹ï¼Œå¯¼è‡´ä¸Šä¸‹æ–‡è¿‡é•¿ã€‚ä¸‹ä¸€ç‰ˆæœ¬å°†é›†æˆæ™ºèƒ½è®°å¿†ç³»ç»Ÿï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[ç”¨æˆ·æŸ¥è¯¢] --&gt; B[æŸ¥è¯¢ç†è§£]
    B --&gt; C[è®°å¿†æ£€ç´¢]
    C --&gt; D[ç›¸å…³æ€§æ’åº]
    D --&gt; E[åˆ†å±‚æ•°æ®è¿”å›]
    
    subgraph "è®°å¿†å±‚çº§"
        F[æ¶æ„æ¦‚è§ˆå±‚]
        G[æ¨¡å—å…³ç³»å±‚] 
        H[å‡½æ•°ç»†èŠ‚å±‚]
        I[å®ç°ä»£ç å±‚]
    end
    
    E --&gt; F
    E --&gt; G
    E --&gt; H
    E --&gt; I
</code></pre>
<h3 data-id="heading-25">è·¨è¯­è¨€æ”¯æŒ</h3>
<p>æ‰©å±•åˆ°æ›´å¤šç¼–ç¨‹è¯­è¨€çš„æ”¯æŒï¼š</p>



































<table><thead><tr><th>è¯­è¨€</th><th>ä¼˜å…ˆçº§</th><th>æŒ‘æˆ˜</th><th>è®¡åˆ’</th></tr></thead><tbody><tr><td>Java</td><td>é«˜</td><td>æ³›å‹å¤„ç†</td><td>Q4 2025</td></tr><tr><td>TypeScript</td><td>é«˜</td><td>ç±»å‹æ¨å¯¼</td><td>Q1 2026</td></tr><tr><td>C++</td><td>ä¸­</td><td>æ¨¡æ¿ç³»ç»Ÿ</td><td>Q2 2026</td></tr><tr><td>Go</td><td>ä¸­</td><td>æ¥å£å®ç°</td><td>Q3 2026</td></tr></tbody></table>
<h2 data-id="heading-26">ç»“è¯­</h2>
<p>æ„å»ºä»£ç çŸ¥è¯†å›¾è°±ç³»ç»Ÿæ˜¯ä¸€ä¸ªå¤æ‚çš„å·¥ç¨‹ï¼Œæ¶‰åŠç¼–è¯‘åŸç†ã€å›¾è®ºã€ç³»ç»Ÿè®¾è®¡ç­‰å¤šä¸ªæŠ€æœ¯é¢†åŸŸã€‚é€šè¿‡ä¸¤å¹´çš„å®è·µï¼Œæˆ‘ä»¬æ·±åˆ»è®¤è¯†åˆ°ï¼ŒæŠ€æœ¯é€‰å‹çš„é‡è¦æ€§ã€æ€§èƒ½ä¼˜åŒ–çš„å¿…è¦æ€§ï¼Œä»¥åŠæŒç»­è¿­ä»£çš„ä»·å€¼ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¤Ÿä¸ºæœ‰ç±»ä¼¼éœ€æ±‚çš„å¼€å‘è€…æä¾›ä¸€äº›å‚è€ƒã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿é€šè¿‡GitHub Issuesä¸æˆ‘ä»¬äº¤æµã€‚</p>
<hr/>
<p>*å‚è€ƒä½œå“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fwanchuang159%2Flegacy-code-archaeologist" target="_blank" title="https://gitee.com/wanchuang159/legacy-code-archaeologist" ref="nofollow noopener noreferrer">legacy-code-archaeologist: Legacy Code Archaeologist - AIé©±åŠ¨çš„ä»£ç åˆ†æä¸MCPåè®®æ”¯æŒ</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æœºå™¨å­¦ä¹ Scikit-learnåº“çš„ä½¿ç”¨æŠ€å·§]]></title>    <link>https://juejin.cn/post/7579811819667718196</link>    <guid>https://juejin.cn/post/7579811819667718196</guid>    <pubDate>2025-12-05T01:07:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579811819667718196" data-draft-id="7579851956211073076" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æœºå™¨å­¦ä¹ Scikit-learnåº“çš„ä½¿ç”¨æŠ€å·§"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-05T01:07:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ·±åœ³è”“å»¶ç§‘æŠ€"/> <meta itemprop="url" content="https://juejin.cn/user/1919099566570249"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æœºå™¨å­¦ä¹ Scikit-learnåº“çš„ä½¿ç”¨æŠ€å·§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1919099566570249/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ·±åœ³è”“å»¶ç§‘æŠ€
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T01:07:12.000Z" title="Fri Dec 05 2025 01:07:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>sklearnï¼ˆæ–‡ç« ç»Ÿä¸€ä½¿ç”¨ç®€ç§°ï¼‰æ˜¯Pythoné‡Œæœ€å®ç”¨çš„æœºå™¨å­¦ä¹ åº“ï¼Œä»Šå¤©æˆ‘æ•™å¤§å®¶æ€ä¹ˆç®€å•çš„ä½¿ç”¨å®ƒã€‚</p>
<h2 data-id="heading-0">å®‰è£…</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å®‰è£…çš„æ—¶å€™ç”¨å…¨å</span>
<span class="hljs-comment"># pip install scikit-learn</span>

<span class="hljs-comment"># å¯¼å…¥çš„æ—¶å€™ç”¨ç®€ç§°</span>
<span class="hljs-keyword">import</span> sklearn
<span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LogisticRegression

</code></pre>
<p>å®‰è£…å¥½åï¼Œæ¥ä¸‹æ¥åˆ†å‡ ä¸ªæ–¹å‘ä»‹ç»ä½¿ç”¨æ–¹æ³•ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€æ•°æ®å‡†å¤‡</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> datasets
<span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split
<span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> StandardScaler

<span class="hljs-comment"># 1. åŠ è½½æ•°æ®ï¼ˆå†…ç½®æ•°æ®é›†ç»ƒæ‰‹ç”¨ï¼‰</span>
iris = datasets.load_iris()
X, y = iris.data, iris.target  <span class="hljs-comment"># Xæ˜¯ç‰¹å¾ï¼Œyæ˜¯æ ‡ç­¾</span>

<span class="hljs-comment"># 2. åˆ’åˆ†è®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼ˆå¿…é¡»åšï¼‰</span>
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=<span class="hljs-number">0.2</span>, random_state=<span class="hljs-number">42</span>  <span class="hljs-comment"># random_stateå›ºå®šéšæœºç§å­ï¼Œç»“æœå¯å¤ç°</span>
)

<span class="hljs-comment"># 3. æ•°æ®æ ‡å‡†åŒ–ï¼ˆå¾ˆå¤šç®—æ³•éœ€è¦ï¼‰</span>
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)  <span class="hljs-comment"># å…ˆfitå†transform</span>
X_test_scaled = scaler.transform(X_test)        <span class="hljs-comment"># ç”¨è®­ç»ƒé›†çš„å‚æ•°transformæµ‹è¯•é›†</span>
</code></pre>
<h2 data-id="heading-2">äºŒã€åˆ†ç±»ç®—æ³•</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LogisticRegression
<span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeClassifier
<span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> RandomForestClassifier
<span class="hljs-keyword">from</span> sklearn.svm <span class="hljs-keyword">import</span> SVC
<span class="hljs-keyword">from</span> sklearn.neighbors <span class="hljs-keyword">import</span> KNeighborsClassifier

<span class="hljs-comment"># å„ç§åˆ†ç±»å™¨ç”¨æ³•éƒ½å·®ä¸å¤šï¼Œä¸‰æ­¥èµ°</span>
classifiers = {
    <span class="hljs-string">'é€»è¾‘å›å½’'</span>: LogisticRegression(random_state=<span class="hljs-number">42</span>),
    <span class="hljs-string">'å†³ç­–æ ‘'</span>: DecisionTreeClassifier(random_state=<span class="hljs-number">42</span>),
    <span class="hljs-string">'éšæœºæ£®æ—'</span>: RandomForestClassifier(n_estimators=<span class="hljs-number">100</span>, random_state=<span class="hljs-number">42</span>),
    <span class="hljs-string">'SVM'</span>: SVC(kernel=<span class="hljs-string">'rbf'</span>, random_state=<span class="hljs-number">42</span>),
    <span class="hljs-string">'KNN'</span>: KNeighborsClassifier(n_neighbors=<span class="hljs-number">5</span>)
}

<span class="hljs-keyword">for</span> name, clf <span class="hljs-keyword">in</span> classifiers.items():
    clf.fit(X_train_scaled, y_train)           <span class="hljs-comment"># 1. è®­ç»ƒ</span>
    score = clf.score(X_test_scaled, y_test)   <span class="hljs-comment"># 2. é¢„æµ‹å¹¶è¯„ä¼°</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{name}</span>: å‡†ç¡®ç‡ <span class="hljs-subst">{score:<span class="hljs-number">.3</span>f}</span>"</span>)
</code></pre>
<h2 data-id="heading-3">ä¸‰ã€å›å½’ç®—æ³•</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LinearRegression, Ridge, Lasso
<span class="hljs-keyword">from</span> sklearn.tree <span class="hljs-keyword">import</span> DecisionTreeRegressor
<span class="hljs-keyword">from</span> sklearn.ensemble <span class="hljs-keyword">import</span> RandomForestRegressor

<span class="hljs-comment"># åŠ è½½å›å½’æ•°æ®</span>
boston = datasets.load_boston()  <span class="hljs-comment"># å·²å¼ƒç”¨ï¼Œè¿™é‡Œåªæ˜¯ç¤ºä¾‹</span>
X, y = boston.data, boston.target
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="hljs-number">0.2</span>, random_state=<span class="hljs-number">42</span>)

<span class="hljs-comment"># å›å½’æ¨¡å‹</span>
regressors = {
    <span class="hljs-string">'çº¿æ€§å›å½’'</span>: LinearRegression(),
    <span class="hljs-string">'å²­å›å½’'</span>: Ridge(alpha=<span class="hljs-number">1.0</span>),
    <span class="hljs-string">'Lassoå›å½’'</span>: Lasso(alpha=<span class="hljs-number">0.1</span>),
    <span class="hljs-string">'éšæœºæ£®æ—å›å½’'</span>: RandomForestRegressor(n_estimators=<span class="hljs-number">100</span>, random_state=<span class="hljs-number">42</span>)
}

<span class="hljs-keyword">for</span> name, reg <span class="hljs-keyword">in</span> regressors.items():
    reg.fit(X_train, y_train)
    r2_score = reg.score(X_test, y_test)  <span class="hljs-comment"># RÂ²åˆ†æ•°ï¼Œè¶Šæ¥è¿‘1è¶Šå¥½</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{name}</span>: RÂ²åˆ†æ•° <span class="hljs-subst">{r2_score:<span class="hljs-number">.3</span>f}</span>"</span>)
</code></pre>
<h2 data-id="heading-4">å››ã€èšç±»ç®—æ³•</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sklearn.cluster <span class="hljs-keyword">import</span> KMeans, DBSCAN, AgglomerativeClustering
<span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> silhouette_score

<span class="hljs-comment"># æ— ç›‘ç£å­¦ä¹ ï¼Œæ²¡æœ‰y</span>
X = iris.data

<span class="hljs-comment"># KMeansï¼ˆæœ€å¸¸ç”¨ï¼‰</span>
kmeans = KMeans(n_clusters=<span class="hljs-number">3</span>, random_state=<span class="hljs-number">42</span>)
labels = kmeans.fit_predict(X)  <span class="hljs-comment"># ç›´æ¥å¾—åˆ°åˆ†ç»„æ ‡ç­¾</span>

<span class="hljs-comment"># è¯„ä¼°èšç±»æ•ˆæœï¼ˆè½®å»“ç³»æ•°ï¼‰</span>
score = silhouette_score(X, labels)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"KMeansè½®å»“ç³»æ•°: <span class="hljs-subst">{score:<span class="hljs-number">.3</span>f}</span>"</span>)

<span class="hljs-comment"># å…¶ä»–èšç±»ç®—æ³•</span>
dbscan = DBSCAN(eps=<span class="hljs-number">0.5</span>, min_samples=<span class="hljs-number">5</span>)
hierarchical = AgglomerativeClustering(n_clusters=<span class="hljs-number">3</span>)
</code></pre>
<h2 data-id="heading-5">äº”ã€æ¨¡å‹è¯„ä¼°</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sklearn.metrics <span class="hljs-keyword">import</span> (
    accuracy_score, precision_score, recall_score, f1_score,
    confusion_matrix, classification_report,
    mean_squared_error, r2_score
)

<span class="hljs-comment"># åˆ†ç±»ä»»åŠ¡è¯„ä¼°</span>
clf = LogisticRegression(random_state=<span class="hljs-number">42</span>)
clf.fit(X_train_scaled, y_train)
y_pred = clf.predict(X_test_scaled)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"å‡†ç¡®ç‡:"</span>, accuracy_score(y_test, y_pred))
<span class="hljs-built_in">print</span>(<span class="hljs-string">"ç²¾ç¡®ç‡:"</span>, precision_score(y_test, y_pred, average=<span class="hljs-string">'macro'</span>))
<span class="hljs-built_in">print</span>(<span class="hljs-string">"å¬å›ç‡:"</span>, recall_score(y_test, y_pred, average=<span class="hljs-string">'macro'</span>))
<span class="hljs-built_in">print</span>(<span class="hljs-string">"F1åˆ†æ•°:"</span>, f1_score(y_test, y_pred, average=<span class="hljs-string">'macro'</span>))

<span class="hljs-comment"># æ··æ·†çŸ©é˜µï¼ˆå¯è§†åŒ–è°åˆ†é”™äº†ï¼‰</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\næ··æ·†çŸ©é˜µ:"</span>)
<span class="hljs-built_in">print</span>(confusion_matrix(y_test, y_pred))

<span class="hljs-comment"># è¯¦ç»†æŠ¥å‘Š</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\nåˆ†ç±»æŠ¥å‘Š:"</span>)
<span class="hljs-built_in">print</span>(classification_report(y_test, y_pred))
</code></pre>
<h2 data-id="heading-6">å…­ã€ç‰¹å¾å·¥ç¨‹</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sklearn.feature_selection <span class="hljs-keyword">import</span> SelectKBest, f_classif
<span class="hljs-keyword">from</span> sklearn.decomposition <span class="hljs-keyword">import</span> PCA
<span class="hljs-keyword">from</span> sklearn.pipeline <span class="hljs-keyword">import</span> Pipeline

<span class="hljs-comment"># 1. ç‰¹å¾é€‰æ‹©ï¼ˆé€‰æœ€é‡è¦çš„Kä¸ªç‰¹å¾ï¼‰</span>
selector = SelectKBest(score_func=f_classif, k=<span class="hljs-number">2</span>)
X_selected = selector.fit_transform(X_train, y_train)

<span class="hljs-comment"># 2. é™ç»´ï¼ˆPCAï¼‰</span>
pca = PCA(n_components=<span class="hljs-number">2</span>)  <span class="hljs-comment"># é™åˆ°2ç»´</span>
X_pca = pca.fit_transform(X_train)

<span class="hljs-comment"># 3. ç®¡é“ï¼ˆæŠŠå¤šä¸ªæ­¥éª¤ä¸²èµ·æ¥ï¼‰</span>
pipeline = Pipeline([
    (<span class="hljs-string">'scaler'</span>, StandardScaler()),
    (<span class="hljs-string">'selector'</span>, SelectKBest(k=<span class="hljs-number">2</span>)),
    (<span class="hljs-string">'classifier'</span>, RandomForestClassifier(random_state=<span class="hljs-number">42</span>))
])

pipeline.fit(X_train, y_train)
score = pipeline.score(X_test, y_test)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç®¡é“æ¨¡å‹å‡†ç¡®ç‡: <span class="hljs-subst">{score:<span class="hljs-number">.3</span>f}</span>"</span>)
</code></pre>
<h2 data-id="heading-7">ä¸ƒã€æ‰¾æœ€ä¼˜å‚æ•°</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> GridSearchCV

<span class="hljs-comment"># å®šä¹‰è¦è°ƒçš„å‚æ•°</span>
param_grid = {
    <span class="hljs-string">'n_estimators'</span>: [<span class="hljs-number">50</span>, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>],
    <span class="hljs-string">'max_depth'</span>: [<span class="hljs-literal">None</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>],
    <span class="hljs-string">'min_samples_split'</span>: [<span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>]
}

<span class="hljs-comment"># ç½‘æ ¼æœç´¢</span>
rf = RandomForestClassifier(random_state=<span class="hljs-number">42</span>)
grid_search = GridSearchCV(
    rf, 
    param_grid, 
    cv=<span class="hljs-number">5</span>,  <span class="hljs-comment"># 5æŠ˜äº¤å‰éªŒè¯</span>
    scoring=<span class="hljs-string">'accuracy'</span>,
    n_jobs=-<span class="hljs-number">1</span>  <span class="hljs-comment"># ç”¨æ‰€æœ‰CPUæ ¸å¿ƒ</span>
)

grid_search.fit(X_train, y_train)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"æœ€ä½³å‚æ•°:"</span>, grid_search.best_params_)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æœ€ä½³åˆ†æ•°:"</span>, grid_search.best_score_)

<span class="hljs-comment"># ç”¨æœ€ä½³å‚æ•°è®­ç»ƒæœ€ç»ˆæ¨¡å‹</span>
best_model = grid_search.best_estimator_
</code></pre>
<h2 data-id="heading-8">å…«ã€äº¤å‰éªŒè¯</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> cross_val_score, KFold

<span class="hljs-comment"># ç®€å•äº¤å‰éªŒè¯</span>
scores = cross_val_score(
    RandomForestClassifier(random_state=<span class="hljs-number">42</span>),
    X, y,
    cv=<span class="hljs-number">5</span>,  <span class="hljs-comment"># 5æŠ˜</span>
    scoring=<span class="hljs-string">'accuracy'</span>
)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"äº¤å‰éªŒè¯å¹³å‡å‡†ç¡®ç‡: <span class="hljs-subst">{scores.mean():<span class="hljs-number">.3</span>f}</span> (Â±<span class="hljs-subst">{scores.std():<span class="hljs-number">.3</span>f}</span>)"</span>)

<span class="hljs-comment"># è‡ªå®šä¹‰äº¤å‰éªŒè¯ç­–ç•¥</span>
kf = KFold(n_splits=<span class="hljs-number">5</span>, shuffle=<span class="hljs-literal">True</span>, random_state=<span class="hljs-number">42</span>)
<span class="hljs-keyword">for</span> train_idx, val_idx <span class="hljs-keyword">in</span> kf.split(X):
    X_train_fold, X_val_fold = X[train_idx], X[val_idx]
    y_train_fold, y_val_fold = y[train_idx], y[val_idx]
    <span class="hljs-comment"># åœ¨æ¯æŠ˜ä¸Šè®­ç»ƒå’Œè¯„ä¼°</span>
</code></pre>
<h2 data-id="heading-9">ä¹ã€ä¿å­˜å’ŒåŠ è½½æ¨¡å‹</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> joblib
<span class="hljs-keyword">import</span> pickle

model = RandomForestClassifier(random_state=<span class="hljs-number">42</span>)
model.fit(X_train, y_train)

<span class="hljs-comment"># ä¿å­˜æ¨¡å‹</span>
joblib.dump(model, <span class="hljs-string">'model.joblib'</span>)  <span class="hljs-comment"># sklearnæ¨è</span>
<span class="hljs-comment"># æˆ–è€…</span>
<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'model.pkl'</span>, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> f:
    pickle.dump(model, f)

<span class="hljs-comment"># åŠ è½½æ¨¡å‹</span>
loaded_model = joblib.load(<span class="hljs-string">'model.joblib'</span>)
predictions = loaded_model.predict(X_test)
</code></pre>
<p>ä¸Šé¢å­¦ä¼šåï¼Œå°±å¯ä»¥åŸºäºä¸‹é¢çš„æµç¨‹æ¨¡æ¿è‡ªå·±ç©ä¸€ä¸‹ã€‚</p>
<h2 data-id="heading-10">æœºå™¨å­¦ä¹ å·¥ä½œæµç¨‹æ¨¡æ¿</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">ml_workflow</span>(<span class="hljs-params">X, y</span>):
    <span class="hljs-string">"""æ ‡å‡†æœºå™¨å­¦ä¹ æµç¨‹"""</span>
    <span class="hljs-comment"># 1. åˆ’åˆ†æ•°æ®</span>
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="hljs-number">0.2</span>, random_state=<span class="hljs-number">42</span>)
    
    <span class="hljs-comment"># 2. æ•°æ®é¢„å¤„ç†</span>
    scaler = StandardScaler()
    X_train_scaled = scaler.fit_transform(X_train)
    X_test_scaled = scaler.transform(X_test)
    
    <span class="hljs-comment"># 3. è®­ç»ƒæ¨¡å‹</span>
    model = RandomForestClassifier(n_estimators=<span class="hljs-number">100</span>, random_state=<span class="hljs-number">42</span>)
    model.fit(X_train_scaled, y_train)
    
    <span class="hljs-comment"># 4. è¯„ä¼°</span>
    train_score = model.score(X_train_scaled, y_train)
    test_score = model.score(X_test_scaled, y_test)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è®­ç»ƒé›†å‡†ç¡®ç‡: <span class="hljs-subst">{train_score:<span class="hljs-number">.3</span>f}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æµ‹è¯•é›†å‡†ç¡®ç‡: <span class="hljs-subst">{test_score:<span class="hljs-number">.3</span>f}</span>"</span>)
    
    <span class="hljs-keyword">return</span> model, scaler
</code></pre>
<p>sklearnçš„è®¾è®¡å“²å­¦æ˜¯â€œä¸€è‡´æ€§â€â€”â€”æ‰€æœ‰æ¨¡å‹éƒ½æœ‰fitã€predictã€scoreæ–¹æ³•ï¼Œç”¨èµ·æ¥éƒ½ä¸€ä¸ªå¥—è·¯ã€‚æŠŠä¸Šé¢è¿™äº›æŒæ¡äº†ï¼Œ80%çš„æœºå™¨å­¦ä¹ ä»»åŠ¡éƒ½èƒ½åº”ä»˜ã€‚å‰©ä¸‹çš„20%ï¼ŒçŸ¥é“å»å“ªé‡ŒæŸ¥æ–‡æ¡£å°±è¡Œã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¯å¤©ä¸€é“é¢è¯•é¢˜ä¹‹æ¶æ„ç¯‡ï½œå¼‚æ­¥ç¡®ä¿å‹äº‹åŠ¡â€”â€”æ¶ˆæ¯é˜Ÿåˆ—é©±åŠ¨çš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7579851956211548212</link>    <guid>https://juejin.cn/post/7579851956211548212</guid>    <pubDate>2025-12-05T02:24:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579851956211548212" data-draft-id="7579889969985962035" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¯å¤©ä¸€é“é¢è¯•é¢˜ä¹‹æ¶æ„ç¯‡ï½œå¼‚æ­¥ç¡®ä¿å‹äº‹åŠ¡â€”â€”æ¶ˆæ¯é˜Ÿåˆ—é©±åŠ¨çš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="é¢è¯•,åˆ†å¸ƒå¼"/> <meta itemprop="datePublished" content="2025-12-05T02:24:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å°èƒ–"/> <meta itemprop="url" content="https://juejin.cn/user/1992752269369870"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¯å¤©ä¸€é“é¢è¯•é¢˜ä¹‹æ¶æ„ç¯‡ï½œå¼‚æ­¥ç¡®ä¿å‹äº‹åŠ¡â€”â€”æ¶ˆæ¯é˜Ÿåˆ—é©±åŠ¨çš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1992752269369870/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å°èƒ–
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T02:24:30.000Z" title="Fri Dec 05 2025 02:24:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>é¢è¯•å®˜</strong>ï¼š"è¯·è¯¦ç»†è§£é‡Šå¼‚æ­¥ç¡®ä¿å‹äº‹åŠ¡çš„åŸç†ï¼Œå¹¶è¯´æ˜å¦‚ä½•é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—å®ç°åˆ†å¸ƒå¼äº‹åŠ¡çš„æœ€ç»ˆä¸€è‡´æ€§ï¼Ÿ"</p>
</blockquote>
<p>å¼‚æ­¥ç¡®ä¿å‹äº‹åŠ¡æ˜¯ç°ä»£åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è§£å†³æ•°æ®ä¸€è‡´æ€§é—®é¢˜çš„é‡è¦æ¨¡å¼ï¼Œé€šè¿‡å°†åŒæ­¥é˜»å¡æ“ä½œæ”¹ä¸ºå¼‚æ­¥æ‰§è¡Œï¼Œæ˜¾è‘—æå‡ç³»ç»Ÿæ€§èƒ½ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€æ ¸å¿ƒåŸç†ä¸æ¶æ„æ€æƒ³</h2>
<p><strong>å¼‚æ­¥ç¡®ä¿å‹äº‹åŠ¡å®šä¹‰</strong>ï¼š</p>
<blockquote>
<p>é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—çš„å¯é æ€§ä¿è¯ï¼Œå°†ä¸€ç³»åˆ—åŒæ­¥çš„äº‹åŠ¡æ“ä½œä¿®æ”¹ä¸ºåŸºäºæ¶ˆæ¯é˜Ÿåˆ—å¼‚æ­¥æ‰§è¡Œçš„æ“ä½œï¼Œé¿å…åˆ†å¸ƒå¼äº‹åŠ¡ä¸­åŒæ­¥é˜»å¡å¸¦æ¥çš„æ€§èƒ½ä¸‹é™ï¼ŒåŒæ—¶ç¡®ä¿æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚</p>
</blockquote>
<p><strong>æ¶æ„æ¼”è¿›å¯¹æ¯”</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">//Â åŒæ­¥é˜»å¡æ¨¡å¼ï¼ˆæ”¹é€ å‰ï¼‰</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">SyncTransactionService</span>Â {
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">processOrder</span>(<span class="hljs-params">OrderÂ order</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 1.Â åˆ›å»ºè®¢å•ï¼ˆæ•°æ®åº“æ“ä½œï¼‰</span>
Â Â Â Â Â Â Â Â orderDao.<span class="hljs-title function_">insert</span>(order);Â <span class="hljs-comment">//Â é˜»å¡</span>
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 2.Â æ‰£å‡åº“å­˜ï¼ˆè¿œç¨‹è°ƒç”¨ï¼‰</span>
Â Â Â Â Â Â Â Â inventoryService.<span class="hljs-title function_">reduceStock</span>(order);Â <span class="hljs-comment">//Â ç½‘ç»œIOé˜»å¡</span>
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 3.Â å¢åŠ ç§¯åˆ†ï¼ˆè¿œç¨‹è°ƒç”¨ï¼‰Â Â </span>
Â Â Â Â Â Â Â Â pointsService.<span class="hljs-title function_">addPoints</span>(order);Â <span class="hljs-comment">//Â ç½‘ç»œIOé˜»å¡</span>
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ€»è€—æ—¶ï¼šè®¢å•+åº“å­˜+ç§¯åˆ†æ“ä½œè€—æ—¶ä¹‹å’Œ</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ€§èƒ½ç“¶é¢ˆï¼šåŒæ­¥é˜»å¡ï¼Œèµ„æºé”å®šæ—¶é—´é•¿</span>
Â Â Â Â }
}

<span class="hljs-comment">//Â å¼‚æ­¥ç¡®ä¿æ¨¡å¼ï¼ˆæ”¹é€ åï¼‰</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">AsyncEnsureService</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">MessageQueue</span>Â mq;
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">processOrderAsync</span>(<span class="hljs-params">OrderÂ order</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 1.Â åˆ›å»ºè®¢å•ï¼ˆæœ¬åœ°äº‹åŠ¡ï¼‰</span>
Â Â Â Â Â Â Â Â orderDao.<span class="hljs-title function_">insert</span>(order);Â <span class="hljs-comment">//Â å¿«é€Ÿå®Œæˆ</span>
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 2.Â å‘é€æ¶ˆæ¯ï¼ˆæœ¬åœ°äº‹åŠ¡å†…ï¼‰</span>
Â Â Â Â Â Â Â Â mq.<span class="hljs-title function_">sendAsync</span>(<span class="hljs-string">"order_created"</span>,Â order);Â <span class="hljs-comment">//Â å¼‚æ­¥éé˜»å¡</span>
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ€»è€—æ—¶ï¼šä»…è®¢å•åˆ›å»ºæ—¶é—´</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ€§èƒ½ä¼˜åŠ¿ï¼šå¿«é€Ÿé‡Šæ”¾èµ„æºï¼Œå¼‚æ­¥å¤„ç†åç»­æ“ä½œ</span>
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-1">äºŒã€æ ¸å¿ƒå®ç°æ¨¡å¼ï¼šæœ¬åœ°æ¶ˆæ¯è¡¨</h2>
<p><strong>æœ¬åœ°æ¶ˆæ¯è¡¨æ–¹æ¡ˆæ¶æ„</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">/**
Â *Â æœ¬åœ°æ¶ˆæ¯è¡¨å®ç°
Â *Â é€šè¿‡æ•°æ®åº“äº‹åŠ¡ä¿è¯ä¸šåŠ¡æ“ä½œå’Œæ¶ˆæ¯å­˜å‚¨çš„åŸå­æ€§
Â */</span>
<span class="hljs-keyword">@Service</span>
<span class="hljs-keyword">@Transactional</span>
publicÂ classÂ LocalMessageTableServiceÂ {
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">@Autowired</span>
Â Â Â Â privateÂ OrderDaoÂ orderDao;
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">@Autowired</span>
Â Â Â Â privateÂ MessageDaoÂ messageDao;
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">@Autowired</span>
Â Â Â Â privateÂ MessageQueueÂ messageQueue;
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â åˆ›å»ºè®¢å•å¹¶ä¿å­˜æ¶ˆæ¯ï¼ˆåŸå­æ“ä½œï¼‰
Â Â Â Â Â */</span>
Â Â Â Â publicÂ voidÂ <span class="hljs-built_in">createOrderWithMessage</span>(OrderÂ order)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 1.Â ä¸šåŠ¡æ“ä½œï¼šåˆ›å»ºè®¢å•</span>
Â Â Â Â Â Â Â Â orderDao<span class="hljs-selector-class">.insert</span>(order);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 2.Â åŒä¸€äº‹åŠ¡ï¼šä¿å­˜æ¶ˆæ¯åˆ°æœ¬åœ°è¡¨</span>
Â Â Â Â Â Â Â Â TransactionalMessageÂ messageÂ =Â newÂ <span class="hljs-built_in">TransactionalMessage</span>();
Â Â Â Â Â Â Â Â message<span class="hljs-selector-class">.setMessageId</span>(generateId());
Â Â Â Â Â Â Â Â message<span class="hljs-selector-class">.setTopic</span>("order_created");
Â Â Â Â Â Â Â Â message<span class="hljs-selector-class">.setContent</span>(order.toJson());
Â Â Â Â Â Â Â Â message<span class="hljs-selector-class">.setStatus</span>(MessageStatus.PENDING);
Â Â Â Â Â Â Â Â message<span class="hljs-selector-class">.setCreateTime</span>(newÂ Date());
Â Â Â Â Â Â Â Â message<span class="hljs-selector-class">.setRetryCount</span>(<span class="hljs-number">0</span>);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â messageDao<span class="hljs-selector-class">.insert</span>(message);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â äº‹åŠ¡æäº¤åï¼Œæ¶ˆæ¯å’Œè®¢å•æ•°æ®åŒæ—¶æŒä¹…åŒ–</span>
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â å¼‚æ­¥æ¶ˆæ¯å‘é€ä»»åŠ¡
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">@Scheduled</span>(fixedDelayÂ =Â <span class="hljs-number">5000</span>)Â //Â æ¯<span class="hljs-number">5</span>ç§’æ‰§è¡Œä¸€æ¬¡
Â Â Â Â publicÂ voidÂ sendPendingMessages()Â {
Â Â Â Â Â Â Â Â List&lt;TransactionalMessage&gt;Â pendingMessagesÂ =Â 
Â Â Â Â Â Â Â Â Â Â Â Â messageDao<span class="hljs-selector-class">.findByStatus</span>(MessageStatus.PENDING,Â <span class="hljs-number">100</span>);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â forÂ (TransactionalMessageÂ messageÂ :Â pendingMessages)Â {
Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å‘é€æ¶ˆæ¯åˆ°MQ</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â booleanÂ successÂ =Â messageQueue<span class="hljs-selector-class">.send</span>(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â message.getTopic(),Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â message<span class="hljs-selector-class">.getContent</span>()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â );
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (success)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ›´æ–°æ¶ˆæ¯çŠ¶æ€ä¸ºå·²å‘é€</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â message<span class="hljs-selector-class">.setStatus</span>(MessageStatus.SENT);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â message<span class="hljs-selector-class">.setSendTime</span>(newÂ Date());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â messageDao<span class="hljs-selector-class">.update</span>(message);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å‘é€å¤±è´¥ï¼Œå¢åŠ é‡è¯•æ¬¡æ•°</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â message<span class="hljs-selector-class">.setRetryCount</span>(message.getRetryCount()Â +Â <span class="hljs-number">1</span>);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (message.getRetryCount()Â &gt;Â MAX_RETRY)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â message<span class="hljs-selector-class">.setStatus</span>(MessageStatus.FAILED);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â messageDao<span class="hljs-selector-class">.update</span>(message);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("æ¶ˆæ¯å‘é€å¤±è´¥:Â {}",Â message.getMessageId(),Â e);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">handleSendError</span>(message,Â e);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-2">ä¸‰ã€æ¶ˆæ¯æ¶ˆè´¹ç«¯çš„å¯é æ€§ä¿è¯</h2>
<p><strong>å¹‚ç­‰æ€§æ¶ˆè´¹å®ç°</strong>ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">/**
Â *Â æ¶ˆæ¯æ¶ˆè´¹è€…å¹‚ç­‰æ€§å¤„ç†
Â *Â é˜²æ­¢é‡å¤æ¶ˆè´¹å¯¼è‡´æ•°æ®ä¸ä¸€è‡´
Â */</span>
<span class="hljs-variable">@Service</span>
<span class="hljs-variable">@Slf4j</span>
publicÂ classÂ OrderMessageConsumerÂ {
Â Â Â Â 
Â Â Â Â <span class="hljs-variable">@Autowired</span>
Â Â Â Â privateÂ InventoryServiceÂ inventoryService;
Â Â Â Â 
Â Â Â Â <span class="hljs-variable">@Autowired</span>
Â Â Â Â privateÂ ConsumeRecordDaoÂ consumeRecordDao;
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â å¤„ç†è®¢å•åˆ›å»ºæ¶ˆæ¯ï¼ˆå¹‚ç­‰ï¼‰
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-variable">@MessageListener</span>(topicÂ =Â <span class="hljs-string">"order_created"</span>)
Â Â Â Â publicÂ voidÂ <span class="hljs-built_in">handleOrderCreated</span>(StringÂ message)Â {
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">Order</span>Â <span class="hljs-selector-tag">order</span>Â =Â <span class="hljs-selector-tag">parseOrder</span>(message);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ£€æŸ¥æ˜¯å¦å·²å¤„ç†è¿‡ï¼ˆå¹‚ç­‰æ€§æ ¡éªŒï¼‰</span>
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">if</span>Â (consumeRecordDao.<span class="hljs-built_in">isProcessed</span>(order.<span class="hljs-built_in">getOrderId</span>(),Â <span class="hljs-string">"order_created"</span>))Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.warn</span>(<span class="hljs-string">"æ¶ˆæ¯å·²å¤„ç†ï¼Œè·³è¿‡é‡å¤æ¶ˆè´¹:Â orderId={}"</span>,Â order.<span class="hljs-built_in">getOrderId</span>());
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">return</span>;
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ‰§è¡Œåº“å­˜æ‰£å‡</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">inventoryService</span><span class="hljs-selector-class">.reduceStock</span>(order.<span class="hljs-built_in">getProductId</span>(),Â order.<span class="hljs-built_in">getQuantity</span>());
Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è®°å½•æ¶ˆè´¹æˆåŠŸ</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">consumeRecordDao</span><span class="hljs-selector-class">.recordProcessed</span>(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â order.<span class="hljs-built_in">getOrderId</span>(),Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"order_created"</span>,Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â message
Â Â Â Â Â Â Â Â Â Â Â Â );
Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â }Â <span class="hljs-selector-tag">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.error</span>(<span class="hljs-string">"å¤„ç†è®¢å•æ¶ˆæ¯å¤±è´¥:Â orderId={}"</span>,Â order.<span class="hljs-built_in">getOrderId</span>(),Â e);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æŠ›å‡ºå¼‚å¸¸è®©æ¶ˆæ¯é˜Ÿåˆ—é‡è¯•</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">throw</span>Â <span class="hljs-selector-tag">new</span>Â <span class="hljs-selector-tag">RuntimeException</span>(<span class="hljs-string">"å¤„ç†å¤±è´¥"</span>,Â e);
Â Â Â Â Â Â Â Â }
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â åº“å­˜æœåŠ¡å¹‚ç­‰å®ç°
Â Â Â Â Â */</span>
Â Â Â Â @<span class="hljs-selector-tag">Service</span>
Â Â Â Â <span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">class</span>Â <span class="hljs-selector-tag">InventoryService</span>Â {
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-variable">@Transactional</span>
Â Â Â Â Â Â Â Â publicÂ voidÂ <span class="hljs-built_in">reduceStock</span>(LongÂ productId,Â IntegerÂ quantity)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ä½¿ç”¨ç‰ˆæœ¬å·æˆ–çŠ¶æ€å­—æ®µå®ç°å¹‚ç­‰</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">int</span>Â <span class="hljs-selector-tag">affected</span>Â =Â <span class="hljs-selector-tag">inventoryDao</span><span class="hljs-selector-class">.reduceStockWithVersion</span>(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â productId,Â quantity,Â <span class="hljs-built_in">getCurrentVersion</span>(productId));
Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">if</span>Â (affectedÂ ==Â <span class="hljs-number">0</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¯èƒ½å·²ç»æ‰£å‡è¿‡ï¼Œè®°å½•æ—¥å¿—å¹¶è·³è¿‡</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"åº“å­˜å¯èƒ½å·²æ‰£å‡:Â productId={}"</span>,Â productId);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-3">å››ã€å®Œæ•´çš„äº‹åŠ¡è¡¥å¿æœºåˆ¶</h2>
<p><strong>æ¶ˆæ¯è¡¥å¿ä»»åŠ¡</strong>ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">/**
Â *Â æ¶ˆæ¯è¡¥å¿æœåŠ¡
Â *Â å¤„ç†å‘é€å¤±è´¥å’Œæ¶ˆè´¹å¤±è´¥çš„æ¶ˆæ¯
Â */</span>
<span class="hljs-variable">@Component</span>
<span class="hljs-variable">@Slf4j</span>
publicÂ classÂ MessageCompensationServiceÂ {
Â Â Â Â 
Â Â Â Â <span class="hljs-variable">@Autowired</span>
Â Â Â Â privateÂ MessageDaoÂ messageDao;
Â Â Â Â 
Â Â Â Â <span class="hljs-variable">@Autowired</span>
Â Â Â Â privateÂ MessageQueueÂ messageQueue;
Â Â Â Â 
Â Â Â Â <span class="hljs-variable">@Autowired</span>
Â Â Â Â privateÂ AlertServiceÂ alertService;
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â é‡è¯•å‘é€å¤±è´¥çš„æ¶ˆæ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-variable">@Scheduled</span>(fixedDelayÂ =Â <span class="hljs-number">60000</span>)Â <span class="hljs-comment">//Â æ¯1åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</span>
Â Â Â Â publicÂ voidÂ <span class="hljs-built_in">retryFailedMessages</span>()Â {
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">TransactionalMessage</span>&gt;Â <span class="hljs-selector-tag">failedMessages</span>Â =Â 
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">messageDao</span><span class="hljs-selector-class">.findByStatus</span>(MessageStatus.FAILED,Â <span class="hljs-number">50</span>);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">for</span>Â (TransactionalMessageÂ <span class="hljs-attribute">messageÂ </span>:Â failedMessages)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">if</span>Â (message.<span class="hljs-built_in">getRetryCount</span>()Â &lt;Â MAX_MANUAL_RETRY)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">boolean</span>Â <span class="hljs-selector-tag">success</span>Â =Â <span class="hljs-selector-tag">messageQueue</span><span class="hljs-selector-class">.send</span>(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â message.<span class="hljs-built_in">getTopic</span>(),Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â message.<span class="hljs-built_in">getContent</span>()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â );
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">if</span>Â (success)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">message</span><span class="hljs-selector-class">.setStatus</span>(MessageStatus.SENT);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">messageDao</span><span class="hljs-selector-class">.update</span>(message);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â <span class="hljs-selector-tag">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.error</span>(<span class="hljs-string">"é‡è¯•å‘é€ä»å¤±è´¥:Â {}"</span>,Â message.<span class="hljs-built_in">getMessageId</span>(),Â e);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â }Â <span class="hljs-selector-tag">else</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è¶…è¿‡æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œéœ€è¦äººå·¥å¹²é¢„</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">alertService</span><span class="hljs-selector-class">.alertManualIntervention</span>(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"æ¶ˆæ¯å‘é€å¤±è´¥éœ€è¦å¤„ç†"</span>,Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â message
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â );
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â å¤„ç†æ­»ä¿¡æ¶ˆæ¯
Â Â Â Â Â */</span>
Â Â Â Â @<span class="hljs-selector-tag">Scheduled</span>(fixedDelayÂ =Â <span class="hljs-number">300000</span>)Â <span class="hljs-comment">//Â æ¯5åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</span>
Â Â Â Â <span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">void</span>Â <span class="hljs-selector-tag">handleDeadLetterMessages</span>()Â {
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">DeadLetterMessage</span>&gt;Â <span class="hljs-selector-tag">deadLetters</span>Â =Â 
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">messageQueue</span><span class="hljs-selector-class">.getDeadLetters</span>();
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">for</span>Â (DeadLetterMessageÂ <span class="hljs-attribute">deadLetterÂ </span>:Â deadLetters)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è®°å½•åˆ°æ•°æ®åº“ä¾›äººå·¥å¤„ç†</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">messageDao</span><span class="hljs-selector-class">.saveDeadLetter</span>(deadLetter);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">alertService</span><span class="hljs-selector-class">.alertManualIntervention</span>(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"æ­»ä¿¡æ¶ˆæ¯éœ€è¦å¤„ç†"</span>,Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â deadLetter
Â Â Â Â Â Â Â Â Â Â Â Â );
Â Â Â Â Â Â Â Â }
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-4">äº”ã€æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ</h2>
<p><strong>æ‰¹é‡æ¶ˆæ¯å¤„ç†ä¼˜åŒ–</strong>ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">/**
Â *Â æ‰¹é‡æ¶ˆæ¯å¤„ç†ä¼˜åŒ–
Â *Â å‡å°‘æ•°æ®åº“IOå’Œç½‘ç»œå¼€é”€
Â */</span>
<span class="hljs-variable">@Service</span>
<span class="hljs-variable">@Slf4j</span>
publicÂ classÂ BatchMessageServiceÂ {
Â Â Â Â 
Â Â Â Â <span class="hljs-variable">@Autowired</span>
Â Â Â Â privateÂ MessageDaoÂ messageDao;
Â Â Â Â 
Â Â Â Â <span class="hljs-variable">@Autowired</span>
Â Â Â Â privateÂ MessageQueueÂ messageQueue;
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ‰¹é‡å‘é€æ¶ˆæ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-variable">@Scheduled</span>(fixedDelayÂ =Â <span class="hljs-number">10000</span>)Â <span class="hljs-comment">//Â æ¯10ç§’æ‰§è¡Œä¸€æ¬¡</span>
Â Â Â Â publicÂ voidÂ <span class="hljs-built_in">batchSendMessages</span>()Â {
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">TransactionalMessage</span>&gt;Â <span class="hljs-selector-tag">pendingMessages</span>Â =Â 
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">messageDao</span><span class="hljs-selector-class">.findByStatus</span>(MessageStatus.PENDING,Â <span class="hljs-number">500</span>);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">if</span>Â (pendingMessages.<span class="hljs-built_in">isEmpty</span>())Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">return</span>;
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æŒ‰Topicåˆ†ç»„æ‰¹é‡å‘é€</span>
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">Map</span>&lt;<span class="hljs-selector-tag">String</span>,Â <span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">TransactionalMessage</span>&gt;&gt;Â <span class="hljs-selector-tag">messagesByTopic</span>Â =Â 
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">pendingMessages</span><span class="hljs-selector-class">.stream</span>()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.collect</span>(Collectors.<span class="hljs-built_in">groupingBy</span>(<span class="hljs-attribute">TransactionalMessage</span>::getTopic));
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">for</span>Â (Map.Entry&lt;String,Â List&lt;TransactionalMessage&gt;&gt;Â <span class="hljs-attribute">entryÂ </span>:Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â messagesByTopic.<span class="hljs-built_in">entrySet</span>())Â {
Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">String</span>Â <span class="hljs-selector-tag">topic</span>Â =Â <span class="hljs-selector-tag">entry</span><span class="hljs-selector-class">.getKey</span>();
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">TransactionalMessage</span>&gt;Â <span class="hljs-selector-tag">messages</span>Â =Â <span class="hljs-selector-tag">entry</span><span class="hljs-selector-class">.getValue</span>();
Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ‰¹é‡å‘é€</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">boolean</span>Â <span class="hljs-selector-tag">success</span>Â =Â <span class="hljs-selector-tag">messageQueue</span><span class="hljs-selector-class">.sendBatch</span>(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â topic,Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â messages.<span class="hljs-built_in">stream</span>()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-built_in">map</span>(<span class="hljs-attribute">TransactionalMessage</span>::getContent)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-built_in">collect</span>(Collectors.<span class="hljs-built_in">toList</span>())
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â );
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">if</span>Â (success)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ‰¹é‡æ›´æ–°çŠ¶æ€</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">Long</span>&gt;Â <span class="hljs-selector-tag">messageIds</span>Â =Â <span class="hljs-selector-tag">messages</span><span class="hljs-selector-class">.stream</span>()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.map</span>(<span class="hljs-attribute">TransactionalMessage</span>::getMessageId)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.collect</span>(Collectors.<span class="hljs-built_in">toList</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">messageDao</span><span class="hljs-selector-class">.batchUpdateStatus</span>(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â messageIds,Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â MessageStatus.SENT
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â );
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â }Â <span class="hljs-selector-tag">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.error</span>(<span class="hljs-string">"æ‰¹é‡å‘é€å¤±è´¥:Â topic={}"</span>,Â topic,Â e);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-5">å…­ã€ä¸å…¶å®ƒåˆ†å¸ƒå¼äº‹åŠ¡æ–¹æ¡ˆå¯¹æ¯”</h2>
<p><strong>æ–¹æ¡ˆå¯¹æ¯”åˆ†æ</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
Â *Â åˆ†å¸ƒå¼äº‹åŠ¡æ–¹æ¡ˆæ¯”è¾ƒ
Â */</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">TransactionSolutionComparator</span>Â {
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">compareSolutions</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ€§èƒ½å¯¹æ¯”</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">Integer</span>&gt;Â tpsComparisonÂ =Â <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"XA/2PC"</span>,Â <span class="hljs-number">100</span>,Â Â Â Â Â Â <span class="hljs-comment">//Â ä½æ€§èƒ½</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"TCC"</span>,Â Â Â Â <span class="hljs-number">1000</span>,Â Â Â Â Â <span class="hljs-comment">//Â ä¸­ç­‰æ€§èƒ½Â Â </span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"Saga"</span>,Â Â Â <span class="hljs-number">2000</span>,Â Â Â Â Â <span class="hljs-comment">//Â ä¸­é«˜æ€§èƒ½</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"å¼‚æ­¥ç¡®ä¿"</span>,Â <span class="hljs-number">5000</span>Â Â Â Â Â Â <span class="hljs-comment">//Â é«˜æ€§èƒ½</span>
Â Â Â Â Â Â Â Â );
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ä¸€è‡´æ€§å¯¹æ¯”</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">String</span>&gt;Â consistencyComparisonÂ =Â <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"XA/2PC"</span>,Â <span class="hljs-string">"å¼ºä¸€è‡´æ€§"</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"TCC"</span>,Â Â Â Â <span class="hljs-string">"æœ€ç»ˆä¸€è‡´æ€§"</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"Saga"</span>,Â Â Â <span class="hljs-string">"æœ€ç»ˆä¸€è‡´æ€§"</span>,Â 
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"å¼‚æ­¥ç¡®ä¿"</span>,Â <span class="hljs-string">"æœ€ç»ˆä¸€è‡´æ€§"</span>
Â Â Â Â Â Â Â Â );
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¤æ‚åº¦å¯¹æ¯”</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">String</span>&gt;Â complexityComparisonÂ =Â <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"XA/2PC"</span>,Â <span class="hljs-string">"ä½ï¼ˆæ•°æ®åº“æ”¯æŒï¼‰"</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"TCC"</span>,Â Â Â Â <span class="hljs-string">"é«˜ï¼ˆä¸šåŠ¡ä¾µå…¥ï¼‰"</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"Saga"</span>,Â Â Â <span class="hljs-string">"ä¸­ï¼ˆè¡¥å¿é€»è¾‘ï¼‰"</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">"å¼‚æ­¥ç¡®ä¿"</span>,Â <span class="hljs-string">"ä¸­ï¼ˆæ¶ˆæ¯ç®¡ç†ï¼‰"</span>
Â Â Â Â Â Â Â Â );
Â Â Â Â }
}
</code></pre>
<p><strong>é€‰å‹å†³ç­–æŒ‡å—</strong>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">SolutionSelector</span>Â {
Â Â Â Â <span class="hljs-keyword">public</span>Â StringÂ selectSolution(RequirementÂ req)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (req.isFinancial()Â &amp;&amp;Â req.needStrongConsistency())Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"XA/2PC"</span>;Â <span class="hljs-comment">//Â é‡‘èäº¤æ˜“</span>
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (req.isHighConcurrency()Â &amp;&amp;Â req.canAcceptEventualConsistency())Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (req.hasComplexCompensation())Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"TCC"</span>;Â <span class="hljs-comment">//Â éœ€è¦ç²¾ç¡®è¡¥å¿</span>
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"å¼‚æ­¥ç¡®ä¿"</span>;Â <span class="hljs-comment">//Â é«˜å¹¶å‘åœºæ™¯é¦–é€‰</span>
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (req.isLongRunning())Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"Saga"</span>;Â <span class="hljs-comment">//Â é•¿ä¸šåŠ¡æµç¨‹</span>
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"å¼‚æ­¥ç¡®ä¿"</span>;Â <span class="hljs-comment">//Â é»˜è®¤é€‰æ‹©</span>
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-6">ä¸ƒã€å®é™…åº”ç”¨åœºæ™¯æ¡ˆä¾‹</h2>
<p><strong>ç”µå•†ä¸‹å•åœºæ™¯å®ç°</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">/**
Â *Â ç”µå•†ä¸‹å•å¼‚æ­¥ç¡®ä¿å®ç°
Â */</span>
<span class="hljs-keyword">@Service</span>
<span class="hljs-keyword">@Slf</span>4j
publicÂ classÂ EcommerceOrderServiceÂ {
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">@Autowired</span>
Â Â Â Â privateÂ OrderDaoÂ orderDao;
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">@Autowired</span>
Â Â Â Â privateÂ MessageDaoÂ messageDao;
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">@Autowired</span>
Â Â Â Â privateÂ MessageSenderÂ messageSender;
Â Â Â Â 
Â Â Â Â <span class="hljs-keyword">@Transactional</span>
Â Â Â Â publicÂ OrderResultÂ createOrder(OrderRequestÂ request)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 1.Â å‚æ•°æ ¡éªŒ</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">validateRequest</span>(request);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 2.Â åˆ›å»ºè®¢å•ï¼ˆæœ¬åœ°äº‹åŠ¡ï¼‰</span>
Â Â Â Â Â Â Â Â <span class="hljs-attribute">Order</span>Â <span class="hljs-attribute">order</span>Â =Â <span class="hljs-built_in">createOrderEntity</span>(request);
Â Â Â Â Â Â Â Â orderDao<span class="hljs-selector-class">.insert</span>(order);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 3.Â ä¿å­˜æ¶ˆæ¯ï¼ˆåŒä¸€äº‹åŠ¡ï¼‰</span>
Â Â Â Â Â Â Â Â TransactionalMessageÂ messageÂ =Â <span class="hljs-built_in">createOrderMessage</span>(order);
Â Â Â Â Â Â Â Â messageDao<span class="hljs-selector-class">.insert</span>(message);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â 4.Â è¿”å›ç»“æœï¼ˆäº‹åŠ¡æäº¤å‰ï¼‰</span>
Â Â Â Â Â Â Â Â returnÂ newÂ <span class="hljs-built_in">OrderResult</span>(order.getOrderId(),Â "è®¢å•åˆ›å»ºæˆåŠŸ");
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â äº‹åŠ¡æäº¤åï¼Œå¼‚æ­¥ä»»åŠ¡ä¼šå‘é€æ¶ˆæ¯è§¦å‘åç»­æ“ä½œ</span>
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ¶ˆæ¯å¤„ç†å™¨ï¼šåº“å­˜æ‰£å‡
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">@MessageListener</span>(topicÂ =Â <span class="hljs-string">"order_created"</span>)
Â Â Â Â publicÂ voidÂ handleInventoryDeduction(StringÂ message)Â {
Â Â Â Â Â Â Â Â <span class="hljs-attribute">Order</span>Â <span class="hljs-attribute">order</span>Â =Â <span class="hljs-built_in">parseOrder</span>(message);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ‰£å‡åº“å­˜</span>
Â Â Â Â Â Â Â Â Â Â Â Â inventoryService<span class="hljs-selector-class">.deductStock</span>(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â order.getProductId(),Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attribute">order</span><span class="hljs-selector-class">.getQuantity</span>()
Â Â Â Â Â Â Â Â Â Â Â Â );
Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å‘é€åº“å­˜æ‰£å‡æˆåŠŸæ¶ˆæ¯</span>
Â Â Â Â Â Â Â Â Â Â Â Â messageSender<span class="hljs-selector-class">.send</span>("inventory_deducted",Â order);
Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("åº“å­˜æ‰£å‡å¤±è´¥:Â orderId={}",Â order.getOrderId(),Â e);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é‡è¯•æˆ–è¡¥å¿å¤„ç†</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">handleInventoryFailure</span>(order,Â e);
Â Â Â Â Â Â Â Â }
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ¶ˆæ¯å¤„ç†å™¨ï¼šç§¯åˆ†å¢åŠ 
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">@MessageListener</span>(topicÂ =Â <span class="hljs-string">"inventory_deducted"</span>)Â Â 
Â Â Â Â publicÂ voidÂ handlePointsAddition(StringÂ message)Â {
Â Â Â Â Â Â Â Â <span class="hljs-attribute">Order</span>Â <span class="hljs-attribute">order</span>Â =Â <span class="hljs-built_in">parseOrder</span>(message);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¢åŠ ç§¯åˆ†</span>
Â Â Â Â Â Â Â Â Â Â Â Â pointsService<span class="hljs-selector-class">.addPoints</span>(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â order.getUserId(),Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">calculatePoints</span>(order.getAmount())
Â Â Â Â Â Â Â Â Â Â Â Â );
Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è®¢å•æµç¨‹å®Œæˆ</span>
Â Â Â Â Â Â Â Â Â Â Â Â orderService<span class="hljs-selector-class">.completeOrder</span>(order.getOrderId());
Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("ç§¯åˆ†å¢åŠ å¤±è´¥:Â orderId={}",Â order.getOrderId(),Â e);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é‡è¯•æˆ–è¡¥å¿å¤„ç†</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">handlePointsFailure</span>(order,Â e);
Â Â Â Â Â Â Â Â }
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-7">å…«ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<p><strong>æ¶ˆæ¯å¯é æ€§ä¿éšœ</strong>ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">/**
Â *Â æ¶ˆæ¯å¯é æ€§è§£å†³æ–¹æ¡ˆ
Â */</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title">MessageReliabilitySolution</span>Â {
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â é—®é¢˜1ï¼šæ¶ˆæ¯ä¸¢å¤±</span>
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title">solveMessageLoss</span>()</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ¡ˆï¼šæœ¬åœ°æ¶ˆæ¯è¡¨Â +Â å®šæ—¶ä»»åŠ¡é‡è¯•</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ¡ˆï¼šç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ¡ˆï¼šæ¶ˆæ¯æŒä¹…åŒ–å­˜å‚¨</span>
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â é—®é¢˜2ï¼šæ¶ˆæ¯é‡å¤</span>
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title">solveMessageDuplicate</span>()</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ¡ˆï¼šæ¶ˆè´¹è€…å¹‚ç­‰æ€§å¤„ç†</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ¡ˆï¼šå”¯ä¸€æ¶ˆæ¯IDå»é‡</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ¡ˆï¼šæ¶ˆè´¹çŠ¶æ€è®°å½•</span>
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â é—®é¢˜3ï¼šæ¶ˆæ¯é¡ºåº</span>
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title">solveMessageOrder</span>()</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ¡ˆï¼šå•ä¸€åˆ†åŒºæ¶ˆè´¹</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ¡ˆï¼šç‰ˆæœ¬å·æˆ–åºåˆ—å·æ§åˆ¶</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ¡ˆï¼šä¸šåŠ¡å±‚æ’åºå¤„ç†</span>
Â Â Â Â }
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â é—®é¢˜4ï¼šç³»ç»Ÿå¤æ‚åº¦</span>
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title">solveComplexity</span>()</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ¡ˆï¼šä½¿ç”¨æˆç†Ÿæ¶ˆæ¯ä¸­é—´ä»¶</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ¡ˆï¼šå°è£…é€šç”¨æ¶ˆæ¯ç»„ä»¶</span>
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ¡ˆï¼šå®Œå–„çš„ç›‘æ§å‘Šè­¦</span>
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-8">ä¹ã€é¢è¯•æ·±åº¦é—®ç­”</h2>
<p><strong>Q1ï¼šå¼‚æ­¥ç¡®ä¿å‹äº‹åŠ¡å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ</strong> <strong>Aï¼š</strong> é€šè¿‡æœ¬åœ°æ¶ˆæ¯è¡¨åœ¨ä¸šåŠ¡äº‹åŠ¡ä¸­åŒæ­¥ä¿å­˜æ¶ˆæ¯ï¼Œå†é€šè¿‡å®šæ—¶ä»»åŠ¡å¼‚æ­¥å‘é€ï¼Œç¡®ä¿ä¸šåŠ¡æ“ä½œå’Œæ¶ˆæ¯å­˜å‚¨çš„åŸå­æ€§ã€‚</p>
<p><strong>Q2ï¼šå¦‚ä½•è§£å†³æ¶ˆæ¯é‡å¤æ¶ˆè´¹é—®é¢˜ï¼Ÿ</strong> <strong>Aï¼š</strong> åœ¨æ¶ˆè´¹è€…ç«¯å®ç°å¹‚ç­‰æ€§å¤„ç†ï¼Œé€šè¿‡å”¯ä¸€ä¸šåŠ¡IDã€ç‰ˆæœ¬å·æˆ–æ¶ˆè´¹è®°å½•è¡¨æ¥é¿å…é‡å¤å¤„ç†ã€‚</p>
<p><strong>Q3ï¼šå¼‚æ­¥ç¡®ä¿å‹äº‹åŠ¡é€‚ç”¨äºå“ªäº›åœºæ™¯ï¼Ÿ</strong> <strong>Aï¼š</strong> é€‚ç”¨äºé«˜å¹¶å‘ã€å¯¹å®æ—¶ä¸€è‡´æ€§è¦æ±‚ä¸é«˜ã€å¯ä»¥æ¥å—æœ€ç»ˆä¸€è‡´æ€§çš„ä¸šåŠ¡åœºæ™¯ï¼Œå¦‚ç”µå•†ä¸‹å•ã€æ—¥å¿—å¤„ç†ã€æ•°æ®åŒæ­¥ç­‰ã€‚</p>
<p><strong>Q4ï¼šä¸TCCäº‹åŠ¡ç›¸æ¯”æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ</strong> <strong>Aï¼š</strong> æ€§èƒ½æ›´é«˜ã€ä¸šåŠ¡ä¾µå…¥æ€§æ›´ä½ã€å®ç°ç›¸å¯¹ç®€å•ï¼Œä½†ä¸€è‡´æ€§ä¿è¯è¾ƒå¼±ï¼Œéœ€è¦å¤„ç†æ¶ˆæ¯å¯é æ€§é—®é¢˜ã€‚</p>
<p><strong>Q5ï¼šå¦‚ä½•ç›‘æ§å’Œä¿éšœå¼‚æ­¥äº‹åŠ¡çš„å¥åº·åº¦ï¼Ÿ</strong> <strong>Aï¼š</strong> éœ€è¦ç›‘æ§æ¶ˆæ¯ç§¯å‹æƒ…å†µã€å¤„ç†å»¶è¿Ÿã€å¤±è´¥ç‡ç­‰æŒ‡æ ‡ï¼Œè®¾ç½®åˆç†çš„å‘Šè­¦é˜ˆå€¼ï¼Œå¹¶å»ºç«‹äººå·¥å¹²é¢„æœºåˆ¶ã€‚</p>
<p><strong>é¢è¯•æŠ€å·§</strong>ï¼š</p>
<ol>
<li>ä»åŒæ­¥é˜»å¡çš„é—®é¢˜å¼•å‡ºå¼‚æ­¥æ–¹æ¡ˆçš„å¿…è¦æ€§</li>
<li>é‡ç‚¹è®²è§£æœ¬åœ°æ¶ˆæ¯è¡¨æ¨¡å¼çš„æ ¸å¿ƒåŸç†</li>
<li>å¼ºè°ƒå¹‚ç­‰æ€§å’Œå¯é æ€§çš„é‡è¦æ€§</li>
<li>ç»“åˆå®é™…ä¸šåŠ¡åœºæ™¯è¯´æ˜é€‚ç”¨æ€§</li>
<li>å±•ç¤ºå¯¹ä¼˜ç¼ºç‚¹å’Œæ³¨æ„äº‹é¡¹çš„å…¨é¢ç†è§£</li>
</ol>
<p><strong>æœ¬æ–‡ç”±å¾®ä¿¡å…¬ä¼—å·"ç¨‹åºå‘˜å°èƒ–"æ•´ç†å‘å¸ƒï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</strong>**</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€æ•°æ®æ“ä½œä¸å¯è§†åŒ–ã€‘Serbornç»˜å›¾-å•å˜é‡åˆ†å¸ƒ]]></title>    <link>https://juejin.cn/post/7579889969985716275</link>    <guid>https://juejin.cn/post/7579889969985716275</guid>    <pubDate>2025-12-05T01:37:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579889969985716275" data-draft-id="7579889969985683507" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€æ•°æ®æ“ä½œä¸å¯è§†åŒ–ã€‘Serbornç»˜å›¾-å•å˜é‡åˆ†å¸ƒ"/> <meta itemprop="keywords" content="Python,æ•°æ®å¯è§†åŒ–"/> <meta itemprop="datePublished" content="2025-12-05T01:37:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIå°äº‘"/> <meta itemprop="url" content="https://juejin.cn/user/4153318871926912"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€æ•°æ®æ“ä½œä¸å¯è§†åŒ–ã€‘Serbornç»˜å›¾-å•å˜é‡åˆ†å¸ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4153318871926912/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIå°äº‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T01:37:38.000Z" title="Fri Dec 05 2025 01:37:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ã€æ•°æ®æ“ä½œä¸å¯è§†åŒ–ã€‘Serbornç»˜å›¾-å•å˜é‡åˆ†å¸ƒ</h2>
<h5 data-id="heading-1">ä¸€ã€ç®€å•å…¥é—¨</h5>
<p>Matplotlibè™½ç„¶å·²ç»æ˜¯æ¯”è¾ƒä¼˜ç§€çš„ç»˜å›¾åº“äº†ï¼Œä½†æ˜¯å®ƒæœ‰ä¸ªä»Šäººå¤´ç–¼çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯APIä½¿ç”¨è¿‡äºå¤æ‚ï¼Œå®ƒé‡Œé¢æœ‰ä¸Šåƒä¸ªå‡½æ•°å’Œå‚æ•°ï¼Œå±äºå…¸å‹çš„é‚£ç§å¯ä»¥ç”¨å®ƒåšä»»ä½•äº‹ï¼Œå´æ— ä»ä¸‹æ‰‹ã€‚</p>
<p>SeabornåŸºäº Matplotlibæ ¸å¿ƒåº“è¿›è¡Œäº†æ›´é«˜çº§çš„APIå°è£…ï¼Œå¯ä»¥è½»æ¾åœ°ç”»å‡ºæ›´æ¼‚äº®çš„å›¾å½¢ï¼Œè€ŒSeabornçš„æ¼‚äº®ä¸»è¦ä½“ç°åœ¨é…è‰²æ›´åŠ èˆ’æœï¼Œä»¥åŠå›¾å½¢å…ƒç´ çš„æ ·å¼æ›´åŠ ç»†è…»ã€‚</p>
<p>ä½¿ç”¨å‰å®‰è£…å’Œå¯¼å…¥ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å®‰è£… </span>
pip3 install seaborn
<span class="hljs-comment"># å¯¼å…¥</span>
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns
<span class="hljs-comment"># ç”»ä¸€å¼ å›¾</span>
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
sns.lineplot(x=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],y=[<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>])
plt.show()
â€‹
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/adce5c33e5b44140ae077d6c26a6b7cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlsI_kupE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765503458&amp;x-signature=jZY6SZjk7A2aMoMigGOCRbSxbjc%3D" alt="1.png" loading="lazy"/></p>
<h4 data-id="heading-2">äºŒã€ç»˜åˆ¶å•å˜é‡åˆ†å¸ƒ</h4>
<p>å¯ä»¥é‡‡ç”¨æœ€ç®€å•çš„ç›´æ–¹å›¾æè¿°å•å˜é‡çš„åˆ†å¸ƒæƒ…å†µã€‚ Seabornä¸­æä¾›äº† distplot()å‡½æ•°ï¼Œå®ƒé»˜è®¤ç»˜åˆ¶çš„æ˜¯ä¸€ä¸ªå¸¦æœ‰æ ¸å¯†åº¦ä¼°è®¡æ›²çº¿çš„ç›´æ–¹å›¾ã€‚ distplot()å‡½æ•°çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ã€‚</p>
<pre><code class="hljs language-python" lang="python">seaborn.distplot(a, bins=<span class="hljs-literal">None</span>, hist=<span class="hljs-literal">True</span>, kde=<span class="hljs-literal">True</span>, rug=<span class="hljs-literal">False</span>, fit=<span class="hljs-literal">None</span>, color=<span class="hljs-literal">None</span>)
</code></pre>
<p>ä¸Šè¿°å‡½æ•°ä¸­å¸¸ç”¨å‚æ•°çš„å«ä¹‰å¦‚ä¸‹ï¼š</p>
<ul>
<li>(1) aï¼šè¡¨ç¤ºè¦è§‚å¯Ÿçš„æ•°æ®ï¼Œå¯ä»¥æ˜¯ Seriesã€ä¸€ç»´æ•°ç»„æˆ–åˆ—è¡¨ã€‚</li>
<li>(2) binsï¼šç”¨äºæ§åˆ¶æ¡å½¢çš„æ•°é‡ã€‚</li>
<li>(3) histï¼šæ¥æ”¶å¸ƒå°”ç±»å‹ï¼Œè¡¨ç¤ºæ˜¯å¦ç»˜åˆ¶(æ ‡æ³¨)ç›´æ–¹å›¾ã€‚</li>
<li>(4) kdeï¼šæ¥æ”¶å¸ƒå°”ç±»å‹ï¼Œè¡¨ç¤ºæ˜¯å¦ç»˜åˆ¶é«˜æ–¯æ ¸å¯†åº¦ä¼°è®¡æ›²çº¿ã€‚</li>
<li>(5) rugï¼šæ¥æ”¶å¸ƒå°”ç±»å‹ï¼Œè¡¨ç¤ºæ˜¯å¦åœ¨æ”¯æŒçš„è½´æ–¹å‘ä¸Šç»˜åˆ¶rugplotã€‚</li>
</ul>
<p>é€šè¿‡ distplot())å‡½æ•°ç»˜åˆ¶ç›´æ–¹å›¾çš„ç¤ºä¾‹å¦‚ä¸‹ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
sns.<span class="hljs-built_in">set</span>()
np.random.seed(<span class="hljs-number">0</span>) Â <span class="hljs-comment"># ç¡®å®šéšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­,å¦‚æœä¸ä½¿ç”¨æ¯æ¬¡ç”Ÿæˆå›¾å½¢ä¸ä¸€æ ·</span>
arr = np.random.randn(<span class="hljs-number">100</span>) Â <span class="hljs-comment"># ç”Ÿæˆéšæœºæ•°ç»„</span>
sns.distplot(arr, bins=<span class="hljs-number">10</span>, hist=<span class="hljs-literal">True</span>, kde=<span class="hljs-literal">True</span>, rug=<span class="hljs-literal">True</span>) Â <span class="hljs-comment"># ç»˜åˆ¶ç›´æ–¹å›¾</span>
plt.show()
</code></pre>
<p>ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œé¦–å…ˆå¯¼å…¥äº†ç”¨äºç”Ÿæˆæ•°ç»„çš„numpyåº“ï¼Œç„¶åä½¿ç”¨ seabornè°ƒç”¨set()å‡½æ•°è·å–é»˜è®¤ç»˜å›¾ï¼Œå¹¶ä¸”è°ƒç”¨ randomæ¨¡å—çš„seedå‡½æ•°ç¡®å®šéšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­ï¼Œä¿è¯æ¯æ¬¡äº§ç”Ÿçš„éšæœºæ•°æ˜¯ä¸€æ ·çš„ï¼Œæ¥ç€è°ƒç”¨ randn()å‡½æ•°ç”ŸæˆåŒ…å«100ä¸ªéšæœºæ•°çš„æ•°ç»„ï¼Œæœ€åè°ƒç”¨ distplot()å‡½æ•°ç»˜åˆ¶ç›´æ–¹å›¾ã€‚</p>
<p>è¿è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/09c6c8e59bca49359c5ac1c642b3cc08~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlsI_kupE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765503458&amp;x-signature=NCeHjyjLJ%2BopkYNoC5gp1Ddddr4%3D" alt="2.jpg" loading="lazy"/></p>
<p>ä»ä¸Šå›¾ä¸­çœ‹å‡ºï¼š</p>
<ul>
<li>ç›´æ–¹å›¾å…±æœ‰10ä¸ªæ¡æŸ±ï¼Œæ¯ä¸ªæ¡æŸ±çš„é¢œè‰²ä¸ºè“è‰²ï¼Œå¹¶ä¸”æœ‰æ ¸å¯†åº¦ä¼°è®¡æ›²çº¿ã€‚</li>
<li>æ ¹æ®æ¡æŸ±çš„é«˜åº¦å¯çŸ¥ï¼Œä½äº-1-1åŒºé—´çš„éšæœºæ•°å€¼åå¤šï¼Œå°äº-2çš„éšæœºæ•°å€¼åå°‘ã€‚</li>
</ul>
<p>é€šå¸¸ï¼Œé‡‡ç”¨ç›´æ–¹å›¾å¯ä»¥æ¯”è¾ƒç›´è§‚åœ°å±•ç°æ ·æœ¬æ•°æ®çš„åˆ†å¸ƒæƒ…å†µï¼Œä¸è¿‡ï¼Œç›´æ–¹å›¾å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œå®ƒä¼šå› ä¸ºæ¡æŸ±æ•°é‡çš„ä¸åŒå¯¼è‡´ç›´æ–¹å›¾çš„æ•ˆæœæœ‰å¾ˆå¤§çš„å·®å¼‚ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç»˜åˆ¶æ ¸å¯†åº¦ä¼°è®¡æ›²çº¿è¿›è¡Œå±•ç°ã€‚</p>
<ul>
<li><strong>æ ¸å¯†åº¦ä¼°è®¡</strong>æ˜¯åœ¨æ¦‚ç‡è®ºä¸­ç”¨æ¥ä¼°è®¡æœªçŸ¥çš„å¯†åº¦å‡½æ•°ï¼Œå±äºéå‚æ•°æ£€éªŒæ–¹æ³•ä¹‹ä¸€ï¼Œå¯ä»¥æ¯”è¾ƒç›´è§‚åœ°çœ‹å‡ºæ•°æ®æ ·æœ¬æœ¬èº«çš„åˆ†å¸ƒç‰¹å¾ã€‚</li>
</ul>
<p>é€šè¿‡ distplot()å‡½æ•°ç»˜åˆ¶æ ¸å¯†åº¦ä¼°è®¡æ›²çº¿çš„ç¤ºä¾‹å¦‚ä¸‹ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># åˆ›å»ºåŒ…å«500ä¸ªä½äº[0ï¼Œ100]ä¹‹é—´æ•´æ•°çš„éšæœºæ•°ç»„</span>
<span class="hljs-attr">array_random</span> = np.random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">500</span>)
<span class="hljs-comment"># ç»˜åˆ¶æ ¸å¯†åº¦ä¼°è®¡æ›²çº¿</span>
sns.distplot(array_random, <span class="hljs-attr">hist</span>=<span class="hljs-literal">False</span>, rug=<span class="hljs-literal">True</span>)
plt.show()
</code></pre>
<p>ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œé¦–å…ˆé€šè¿‡ random.randint()å‡½æ•°è¿”å›ä¸€ä¸ªæœ€å°å€¼ä¸ä½äº0ã€æœ€å¤§å€¼ä½äº100çš„500ä¸ªéšæœºæ•´æ•°æ•°ç»„ç„¶åè°ƒç”¨ displot()å‡½æ•°ç»˜åˆ¶æ ¸å¯†åº¦ä¼°è®¡æ›²çº¿ã€‚</p>
<p>è¿è¡Œç»“æœå¦‚å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3912ec58ffe54a8a97b6476f6b45809d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlsI_kupE=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765503458&amp;x-signature=tezLr1LuBH%2FlDpsUTPQvS%2FxgYdk%3D" alt="3.jpg" loading="lazy"/></p>
<p>ä»ä¸Šå›¾ä¸­çœ‹å‡ºï¼Œå›¾è¡¨ä¸­æœ‰ä¸€æ¡æ ¸å¯†åº¦ä¼°è®¡æ›²çº¿ï¼Œå¹¶ä¸”åœ¨xè½´çš„ä¸Šæ–¹ç”Ÿæˆäº†è§‚æµ‹æ•°å€¼çš„å°ç»†æ¡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI Chatbotè®°å¿†ç³»ç»Ÿå®æˆ˜ï¼šå‹ç¼©ç­–ç•¥ä¸æ€§èƒ½ä¼˜åŒ–ï¼ˆä¸Šï¼‰]]></title>    <link>https://juejin.cn/post/7579961957194530866</link>    <guid>https://juejin.cn/post/7579961957194530866</guid>    <pubDate>2025-12-04T16:44:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579961957194530866" data-draft-id="7579832186880835634" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI Chatbotè®°å¿†ç³»ç»Ÿå®æˆ˜ï¼šå‹ç¼©ç­–ç•¥ä¸æ€§èƒ½ä¼˜åŒ–ï¼ˆä¸Šï¼‰"/> <meta itemprop="keywords" content="Agent"/> <meta itemprop="datePublished" content="2025-12-04T16:44:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AgentBuilder"/> <meta itemprop="url" content="https://juejin.cn/user/1567285004234219"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI Chatbotè®°å¿†ç³»ç»Ÿå®æˆ˜ï¼šå‹ç¼©ç­–ç•¥ä¸æ€§èƒ½ä¼˜åŒ–ï¼ˆä¸Šï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1567285004234219/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AgentBuilder
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T16:44:34.000Z" title="Thu Dec 04 2025 16:44:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1å°æ—¶+
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><hr/>
<h2 data-id="heading-0"><strong>ä¸€ã€èƒŒæ™¯ï¼šä¸ºä»€ä¹ˆéœ€è¦è®°å¿†ç³»ç»Ÿï¼Ÿ</strong></h2>
<p>å¼€å‘AI Chatbotæ—¶ï¼Œä½ æ˜¯å¦é‡åˆ°è¿‡è¿™äº›é—®é¢˜ï¼š</p>
<ul>
<li>LLMè®°ä¸ä½ä¹‹å‰çš„å¯¹è¯ï¼Œç”¨æˆ·ä½“éªŒå¾ˆå·®</li>
<li>å¯¹è¯è½®æ•°ä¸€å¤šï¼ŒTokenæˆæœ¬ç›´çº¿ä¸Šå‡</li>
<li>æƒ³åšé•¿æœŸå¯¹è¯åŠŸèƒ½ï¼Œä½†ä¸çŸ¥é“å¦‚ä½•ç®¡ç†ä¸Šä¸‹æ–‡</li>
</ul>
<p>è¿™äº›éƒ½æ˜¯<strong>è®°å¿†ç®¡ç†</strong>çš„é—®é¢˜ã€‚æœ¬æ–‡å°†ä»é›¶å¼€å§‹ï¼Œå¸¦ä½ å®ç°ä¸€ä¸ªå®Œæ•´çš„è®°å¿†ç³»ç»Ÿã€‚</p>
<h3 data-id="heading-1"><strong>1.1 é—®é¢˜1ï¼šä¸Šä¸‹æ–‡çª—å£çš„ç¡¬æ€§é™åˆ¶</strong></h3>
<p>å…ˆçœ‹ä¸€ç»„æ•°æ®ï¼š</p>

























<table><thead><tr><th>æ¨¡å‹</th><th>ä¸Šä¸‹æ–‡çª—å£</th><th>èƒ½æ”¯æŒçš„å¯¹è¯è½®æ•°</th></tr></thead><tbody><tr><td>GPT-3.5</td><td>4K tokens</td><td>~10è½®</td></tr><tr><td>GPT-4</td><td>8K tokens</td><td>~20è½®</td></tr><tr><td>GPT-4 Turbo</td><td>128K tokens</td><td>~300è½®</td></tr></tbody></table>
<p>çœ‹èµ·æ¥å¾ˆå¤šï¼Ÿä½†å®é™…è®¡ç®—ä¸€ä¸‹ï¼š</p>
<pre><code class="hljs">ä¸€è½®å¯¹è¯ï¼ˆç”¨æˆ·é—® + AIç­”ï¼‰â‰ˆ 400 tokens
20è½®å¯¹è¯ = 8,000 tokens

GPT-4 çš„ 8K çª—å£ = åˆšå¥½20è½®ï¼Œå°±æ»¡äº†
</code></pre>
<p><strong>ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</strong></p>
<p>å½“ä¸Šä¸‹æ–‡æ»¡äº†ä¹‹åï¼ŒLLMä¼šï¼š</p>
<ol>
<li>ä¸¢å¼ƒæœ€æ—©çš„å¯¹è¯</li>
<li>å¿˜è®°ç”¨æˆ·ä¹‹å‰è¯´è¿‡çš„è¯</li>
<li>å¯¹è¯å¤±å»è¿è´¯æ€§</li>
</ol>

<pre><code class="hljs language-python" lang="python">ç”¨æˆ·ï¼š<span class="hljs-string">"æˆ‘å«Tom"</span>ï¼ˆç¬¬<span class="hljs-number">1</span>è½®ï¼‰
<span class="hljs-meta">... </span>å¯¹è¯äº†<span class="hljs-number">20</span>è½® ...
ç”¨æˆ·ï¼š<span class="hljs-string">"æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿ"</span>ï¼ˆç¬¬<span class="hljs-number">21</span>è½®ï¼‰
AIï¼š<span class="hljs-string">"æŠ±æ­‰ï¼Œæˆ‘ä¸è®°å¾—"</span> âŒ
</code></pre>
<p>å³ä½¿ç”¨æ›´å¤§çª—å£çš„æ¨¡å‹ï¼Œä¹Ÿåªæ˜¯å»¶ç¼“é—®é¢˜ï¼Œæ— æ³•æ ¹æœ¬è§£å†³ã€‚</p>
<h3 data-id="heading-2"><strong>1.2 é—®é¢˜2ï¼šTokenæˆæœ¬æŒç»­å¢é•¿</strong></h3>
<p>Tokenä¸ä»…æœ‰æ•°é‡é™åˆ¶ï¼Œè¿˜æœ‰<strong>æˆæœ¬é—®é¢˜</strong>ã€‚</p>
<p>ä»¥DeepSeekä¸ºä¾‹ï¼ˆ$0.14/1M tokensï¼‰ï¼Œç®—ä¸€ç¬”è´¦ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">åœºæ™¯ï¼šå®¢æœæœºå™¨äººï¼Œæ—¥æ´»10ä¸‡ç”¨æˆ·

æ¯æ¬¡å¯¹è¯ï¼š
- å†å²å¯¹è¯50è½® = 20,000 tokens
- æ–°ç”¨æˆ·è¾“å…¥ = 200 tokens
- æ€»è®¡ = 20,200 tokens

æˆæœ¬è®¡ç®—ï¼š
- å•æ¬¡å¯¹è¯æˆæœ¬ = 20,200 * $0.14 / <span class="hljs-attr">1M</span> = <span class="hljs-variable">$0</span>.<span class="hljs-number">003</span>
- æ—¥æˆæœ¬ = 10ä¸‡ç”¨æˆ· * $<span class="hljs-attr">0.003</span> = <span class="hljs-variable">$300</span>
- æœˆæˆæœ¬ = $300 * <span class="hljs-attr">30</span> = <span class="hljs-variable">$9</span>,<span class="hljs-number">000</span>
</code></pre>
<p><strong>å¦‚æœèƒ½å‹ç¼©70%ï¼Ÿ</strong></p>
<pre><code class="hljs language-bash" lang="bash">å‹ç¼©åæ¯æ¬¡ = 6,000 tokens
æœˆæˆæœ¬ = <span class="hljs-variable">$2</span>,700
èŠ‚çœ = <span class="hljs-variable">$6</span>,300/æœˆ = <span class="hljs-variable">$75</span>,600/å¹´ âœ…
</code></pre>
<p>è¿™è¿˜åªæ˜¯è¾“å…¥æˆæœ¬ï¼Œè¾“å‡ºæˆæœ¬ä¼šæ›´é«˜ï¼</p>
<h3 data-id="heading-3"><strong>1.3 é—®é¢˜3ï¼šç”¨æˆ·æœŸæœ›çš„"è®°å¿†"èƒ½åŠ›</strong></h3>
<p>ä»äº§å“è§’åº¦çœ‹ï¼Œç”¨æˆ·æœŸæœ›AIèƒ½ï¼š</p>
<ul>
<li>è®°ä½è‡ªå·±çš„åå­—ã€åå¥½ã€èƒŒæ™¯</li>
<li>å»¶ç»­ä¹‹å‰çš„å¯¹è¯è¯é¢˜</li>
<li>ä¸ç”¨æ¯æ¬¡éƒ½é‡å¤ä¿¡æ¯</li>
</ul>
<p><strong>æ²¡æœ‰è®°å¿† vs æœ‰è®°å¿†ï¼š</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">âŒ æ— è®°å¿†ï¼š
ç”¨æˆ·ï¼š<span class="hljs-string">"æˆ‘æ˜¨å¤©è¯´è¿‡æˆ‘å–œæ¬¢åƒè¾£çš„"</span>
AIï¼š<span class="hljs-string">"æŠ±æ­‰ï¼Œæˆ‘ä¸è®°å¾—"</span>
ç”¨æˆ·ï¼šï¼ˆå…³é—­é¡µé¢ï¼‰

âœ… æœ‰è®°å¿†ï¼š
ç”¨æˆ·ï¼š<span class="hljs-string">"æ¨èä¸ªé¤å…"</span>
AIï¼š<span class="hljs-string">"Tomï¼Œæ ¹æ®ä½ å–œæ¬¢åƒè¾£çš„å£å‘³ï¼Œæ¨èä½ è¯•è¯•..."</span>
ç”¨æˆ·ï¼šï¼ˆç»§ç»­ä½¿ç”¨ï¼‰
</code></pre>
<p>è®°å¿†èƒ½åŠ›æ˜¯AIäº§å“çš„æ ¸å¿ƒç«äº‰åŠ›ã€‚</p>
<h3 data-id="heading-4"><strong>1.4 è§£å†³æ–¹æ¡ˆï¼šè®°å¿†ç³»ç»Ÿ</strong></h3>
<p>ä¸€ä¸ªå®Œæ•´çš„è®°å¿†ç³»ç»Ÿéœ€è¦è§£å†³ï¼š</p>
<ol>
<li><strong>å­˜ä»€ä¹ˆ</strong>ï¼šå¦‚ä½•ç­›é€‰å’Œä¿å­˜é‡è¦ä¿¡æ¯ï¼Ÿ</li>
<li><strong>æ€ä¹ˆå­˜</strong>ï¼šå¦‚ä½•é«˜æ•ˆå­˜å‚¨å’Œæ£€ç´¢ï¼Ÿ</li>
<li><strong>å¦‚ä½•å‹ç¼©</strong>ï¼šå¦‚ä½•åœ¨æœ‰é™çª—å£å†…ä¿ç•™æœ€å¤šä¿¡æ¯ï¼Ÿ</li>
</ol>
<p>æœ¬æ–‡å°†å®ç°ä¸€ä¸ªå®Œæ•´çš„è®°å¿†ç³»ç»Ÿï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>âœ… çŸ­æœŸè®°å¿†ï¼ˆå†…å­˜ï¼Œæé€Ÿè®¿é—®ï¼‰</li>
<li>âœ… 4ç§å‹ç¼©ç­–ç•¥ï¼ˆå¯¹æ¯”åˆ†æï¼‰</li>
<li>âœ… æ€§èƒ½æµ‹è¯•ï¼ˆçœŸå®æ•°æ®ï¼‰</li>
<li>âœ… ä¸­æœŸè®°å¿†æ¶æ„è®¾è®¡ï¼ˆRedis + PostgreSQLï¼‰</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc46b627b5444c9baea672b66336a386~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQWdlbnRCdWlsZGVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765471478&amp;x-signature=H7QCZBCq2at7ExBCwc3nM0be4%2FA%3D" alt="image.png" loading="lazy"/></p>
<p>å®Œæ•´ä»£ç å·²å¼€æºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsotopelaez092-star%2Fmemory-chatbot.git" target="_blank" title="https://github.com/sotopelaez092-star/memory-chatbot.git" ref="nofollow noopener noreferrer">github.com/sotopelaez0â€¦</a></p>
<p>è®©æˆ‘ä»¬å¼€å§‹å§ã€‚</p>
<p>å®Œç¾ï¼è®©æˆ‘æ ¹æ®ä½ çš„é€‰æ‹©èµ·è‰ç¬¬äºŒéƒ¨åˆ†ï¼š</p>
<hr/>
<h2 data-id="heading-5"><strong>äºŒã€çŸ­æœŸè®°å¿†å®ç°</strong></h2>
<h3 data-id="heading-6"><strong>2.1 æ ¸å¿ƒé—®é¢˜ï¼šå¦‚ä½•å­˜å‚¨æœ€è¿‘Nè½®å¯¹è¯ï¼Ÿ</strong></h3>
<p>åœ¨å®ç°è®°å¿†ç³»ç»Ÿæ—¶ï¼Œç¬¬ä¸€ä¸ªè¦è§£å†³çš„é—®é¢˜æ˜¯ï¼š<strong>å¦‚ä½•é«˜æ•ˆåœ°å­˜å‚¨å’Œç®¡ç†æœ€è¿‘çš„å¯¹è¯å†å²ï¼Ÿ</strong></p>
<p>éœ€æ±‚å¾ˆç®€å•ï¼š</p>
<ul>
<li>ä¿å­˜æœ€è¿‘10è½®ï¼ˆ20æ¡æ¶ˆæ¯ï¼‰</li>
<li>è¶…è¿‡é™åˆ¶åï¼Œè‡ªåŠ¨åˆ é™¤æœ€æ—©çš„æ¶ˆæ¯</li>
<li>è¯»å†™é€Ÿåº¦è¦å¿«ï¼ˆ&lt;1msï¼‰</li>
</ul>
<p>çœ‹èµ·æ¥å¾ˆç®€å•ï¼Ÿè®©æˆ‘ä»¬å…ˆçœ‹çœ‹å¸¸è§çš„ä¸¤ç§æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-7"><strong>2.2 æŠ€æœ¯é€‰å‹ï¼šList vs Deque</strong></h3>
<h4 data-id="heading-8"><strong>æ–¹æ¡ˆ1ï¼šä½¿ç”¨List</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryWithList</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, max_messages=<span class="hljs-number">20</span></span>):
        self.max_messages = max_messages
        self.messages = []
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_message</span>(<span class="hljs-params">self, role, content</span>):
        self.messages.append({<span class="hljs-string">"role"</span>: role, <span class="hljs-string">"content"</span>: content})
        
        <span class="hljs-comment"># æ‰‹åŠ¨åˆ é™¤æœ€æ—©çš„æ¶ˆæ¯</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.messages) &gt; self.max_messages:
            self.messages = self.messages[-self.max_messages:]
</code></pre>
<p><strong>é—®é¢˜ï¼š</strong></p>
<ul>
<li>âŒ æ¯æ¬¡éƒ½è¦åˆ‡ç‰‡é‡æ–°èµ‹å€¼ï¼ˆ<code>messages[-20:]</code>ï¼‰</li>
<li>âŒ åˆ‡ç‰‡æ“ä½œä¼šåˆ›å»ºæ–°åˆ—è¡¨ï¼Œæµªè´¹å†…å­˜</li>
<li>âŒ æ—¶é—´å¤æ‚åº¦ O(n)</li>
</ul>
<h4 data-id="heading-9"><strong>æ–¹æ¡ˆ2ï¼šä½¿ç”¨Deque</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryWithDeque</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, max_messages=<span class="hljs-number">20</span></span>):
        self.messages = deque(maxlen=max_messages)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_message</span>(<span class="hljs-params">self, role, content</span>):
        self.messages.append({<span class="hljs-string">"role"</span>: role, <span class="hljs-string">"content"</span>: content})
        <span class="hljs-comment"># è‡ªåŠ¨åˆ é™¤ï¼æ— éœ€æ‰‹åŠ¨ç®¡ç†</span>
</code></pre>
<p><strong>ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>âœ… è‡ªåŠ¨ç®¡ç†å®¹é‡ï¼Œæ— éœ€æ‰‹åŠ¨åˆ é™¤</li>
<li>âœ… æ—¶é—´å¤æ‚åº¦ O(1)</li>
<li>âœ… ä»£ç æ›´ç®€æ´</li>
</ul>
<h4 data-id="heading-10"><strong>æ€§èƒ½å¯¹æ¯”</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-string">"""
List vs Deque æ€§èƒ½å¯¹æ¯”æµ‹è¯•

æµ‹è¯•åœºæ™¯ï¼š
1. è¿ç»­æ·»åŠ æ¶ˆæ¯
2. æ»¡å®¹é‡åç»§ç»­æ·»åŠ 
3. è·å–æ‰€æœ‰æ¶ˆæ¯
4. æ··åˆæ“ä½œ
"""</span>

<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>


<span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryWithList</span>:
    <span class="hljs-string">"""ä½¿ç”¨Listå®ç°çš„è®°å¿†"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, max_messages: <span class="hljs-built_in">int</span> = <span class="hljs-number">20</span></span>):
        self.max_messages = max_messages
        self.messages = []
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_message</span>(<span class="hljs-params">self, role: <span class="hljs-built_in">str</span>, content: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-literal">None</span>:
        self.messages.append({<span class="hljs-string">"role"</span>: role, <span class="hljs-string">"content"</span>: content})
        
        <span class="hljs-comment"># æ‰‹åŠ¨åˆ é™¤è¶…å‡ºçš„æ¶ˆæ¯</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.messages) &gt; self.max_messages:
            self.messages = self.messages[-self.max_messages:]
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_messages</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>]:
        <span class="hljs-keyword">return</span> self.messages.copy()


<span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryWithDeque</span>:
    <span class="hljs-string">"""ä½¿ç”¨Dequeå®ç°çš„è®°å¿†"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, max_messages: <span class="hljs-built_in">int</span> = <span class="hljs-number">20</span></span>):
        self.messages = deque(maxlen=max_messages)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_message</span>(<span class="hljs-params">self, role: <span class="hljs-built_in">str</span>, content: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-literal">None</span>:
        self.messages.append({<span class="hljs-string">"role"</span>: role, <span class="hljs-string">"content"</span>: content})
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_messages</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>]:
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>(self.messages)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_continuous_add</span>(<span class="hljs-params">memory_class, n: <span class="hljs-built_in">int</span> = <span class="hljs-number">1000</span></span>) -&gt; <span class="hljs-built_in">float</span>:
    <span class="hljs-string">"""
    æµ‹è¯•1ï¼šè¿ç»­æ·»åŠ æ¶ˆæ¯
    
    Args:
        memory_class: å†…å­˜ç±»
        n: æ·»åŠ æ¬¡æ•°
    
    Returns:
        è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
    """</span>
    memory = memory_class(max_messages=<span class="hljs-number">20</span>)
    
    start = time.time()
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):
        memory.add_message(<span class="hljs-string">"user"</span>, <span class="hljs-string">f"æ¶ˆæ¯ <span class="hljs-subst">{i}</span>"</span>)
    elapsed = (time.time() - start) * <span class="hljs-number">1000</span>
    
    <span class="hljs-keyword">return</span> elapsed


<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_add_at_full_capacity</span>(<span class="hljs-params">memory_class, n: <span class="hljs-built_in">int</span> = <span class="hljs-number">1000</span></span>) -&gt; <span class="hljs-built_in">float</span>:
    <span class="hljs-string">"""
    æµ‹è¯•2ï¼šæ»¡å®¹é‡åç»§ç»­æ·»åŠ 
    
    åœºæ™¯ï¼šå·²ç»æœ‰20æ¡æ¶ˆæ¯ï¼Œç»§ç»­æ·»åŠ næ¡
    è¿™æ˜¯æœ€å¸¸è§çš„åœºæ™¯ï¼ˆå¯¹è¯è¶…è¿‡é™åˆ¶åï¼‰
    
    Returns:
        è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
    """</span>
    memory = memory_class(max_messages=<span class="hljs-number">20</span>)
    
    <span class="hljs-comment"># å…ˆå¡«æ»¡</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):
        memory.add_message(<span class="hljs-string">"user"</span>, <span class="hljs-string">f"åˆå§‹æ¶ˆæ¯ <span class="hljs-subst">{i}</span>"</span>)
    
    <span class="hljs-comment"># æµ‹è¯•æ»¡å®¹é‡åçš„æ·»åŠ </span>
    start = time.time()
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):
        memory.add_message(<span class="hljs-string">"user"</span>, <span class="hljs-string">f"æ–°æ¶ˆæ¯ <span class="hljs-subst">{i}</span>"</span>)
    elapsed = (time.time() - start) * <span class="hljs-number">1000</span>
    
    <span class="hljs-keyword">return</span> elapsed


<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_get_messages</span>(<span class="hljs-params">memory_class, n: <span class="hljs-built_in">int</span> = <span class="hljs-number">1000</span></span>) -&gt; <span class="hljs-built_in">float</span>:
    <span class="hljs-string">"""
    æµ‹è¯•3ï¼šè·å–æ¶ˆæ¯
    
    Returns:
        è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
    """</span>
    memory = memory_class(max_messages=<span class="hljs-number">20</span>)
    
    <span class="hljs-comment"># å…ˆæ·»åŠ 20æ¡æ¶ˆæ¯</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):
        memory.add_message(<span class="hljs-string">"user"</span>, <span class="hljs-string">f"æ¶ˆæ¯ <span class="hljs-subst">{i}</span>"</span>)
    
    <span class="hljs-comment"># æµ‹è¯•è·å–æ¶ˆæ¯çš„é€Ÿåº¦</span>
    start = time.time()
    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):
        messages = memory.get_messages()
    elapsed = (time.time() - start) * <span class="hljs-number">1000</span>
    
    <span class="hljs-keyword">return</span> elapsed


<span class="hljs-keyword">def</span> <span class="hljs-title function_">test_mixed_operations</span>(<span class="hljs-params">memory_class, n: <span class="hljs-built_in">int</span> = <span class="hljs-number">1000</span></span>) -&gt; <span class="hljs-built_in">float</span>:
    <span class="hljs-string">"""
    æµ‹è¯•4ï¼šæ··åˆæ“ä½œ
    
    æ¨¡æ‹ŸçœŸå®å¯¹è¯åœºæ™¯ï¼š
    - æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
    - è·å–å†å²
    - æ·»åŠ AIå›å¤
    - å†æ¬¡è·å–å†å²
    
    Returns:
        è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰
    """</span>
    memory = memory_class(max_messages=<span class="hljs-number">20</span>)
    
    start = time.time()
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):
        <span class="hljs-comment"># ç”¨æˆ·è¾“å…¥</span>
        memory.add_message(<span class="hljs-string">"user"</span>, <span class="hljs-string">f"ç”¨æˆ·é—®é¢˜ <span class="hljs-subst">{i}</span>"</span>)
        <span class="hljs-comment"># æ„å»ºä¸Šä¸‹æ–‡ï¼ˆéœ€è¦è·å–å†å²ï¼‰</span>
        history = memory.get_messages()
        <span class="hljs-comment"># AIå›å¤</span>
        memory.add_message(<span class="hljs-string">"assistant"</span>, <span class="hljs-string">f"AIå›ç­” <span class="hljs-subst">{i}</span>"</span>)
    elapsed = (time.time() - start) * <span class="hljs-number">1000</span>
    
    <span class="hljs-keyword">return</span> elapsed


<span class="hljs-keyword">def</span> <span class="hljs-title function_">run_all_tests</span>():
    <span class="hljs-string">"""è¿è¡Œæ‰€æœ‰æµ‹è¯• - å¢åŠ æµ‹è¯•è§„æ¨¡"""</span>
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">80</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"List vs Deque æ€§èƒ½å¯¹æ¯”æµ‹è¯•ï¼ˆå¤§è§„æ¨¡ï¼‰"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">80</span>)
    <span class="hljs-built_in">print</span>()
    
    <span class="hljs-comment"># å¢åŠ æµ‹è¯•è§„æ¨¡</span>
    test_configs = [
        (<span class="hljs-string">"è¿ç»­æ·»åŠ 10000æ¡æ¶ˆæ¯"</span>, test_continuous_add, <span class="hljs-number">10000</span>),
        (<span class="hljs-string">"æ»¡å®¹é‡åæ·»åŠ 10000æ¡"</span>, test_add_at_full_capacity, <span class="hljs-number">10000</span>),
        (<span class="hljs-string">"è·å–æ¶ˆæ¯10000æ¬¡"</span>, test_get_messages, <span class="hljs-number">10000</span>),
        (<span class="hljs-string">"æ··åˆæ“ä½œ10000æ¬¡"</span>, test_mixed_operations, <span class="hljs-number">10000</span>),
        
        <span class="hljs-comment"># æ·»åŠ è¶…å¤§è§„æ¨¡æµ‹è¯•</span>
        (<span class="hljs-string">"è¿ç»­æ·»åŠ 100000æ¡æ¶ˆæ¯"</span>, test_continuous_add, <span class="hljs-number">100000</span>),
        (<span class="hljs-string">"æ»¡å®¹é‡åæ·»åŠ 100000æ¡"</span>, test_add_at_full_capacity, <span class="hljs-number">100000</span>),
    ]
    
    results = []
    
    <span class="hljs-keyword">for</span> test_name, test_func, n <span class="hljs-keyword">in</span> test_configs:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"æµ‹è¯•åœºæ™¯: <span class="hljs-subst">{test_name}</span>"</span>)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"-"</span> * <span class="hljs-number">80</span>)
        
        <span class="hljs-comment"># æµ‹è¯•List</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  æµ‹è¯•List..."</span>, end=<span class="hljs-string">" "</span>, flush=<span class="hljs-literal">True</span>)
        list_time = test_func(MemoryWithList, n)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ“ <span class="hljs-subst">{list_time:<span class="hljs-number">.2</span>f}</span>ms"</span>)
        
        <span class="hljs-comment"># æµ‹è¯•Deque</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  æµ‹è¯•Deque..."</span>, end=<span class="hljs-string">" "</span>, flush=<span class="hljs-literal">True</span>)
        deque_time = test_func(MemoryWithDeque, n)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"âœ“ <span class="hljs-subst">{deque_time:<span class="hljs-number">.2</span>f}</span>ms"</span>)
        
        <span class="hljs-comment"># è®¡ç®—å€æ•°</span>
        speedup = list_time / deque_time <span class="hljs-keyword">if</span> deque_time &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>
        winner = <span class="hljs-string">"Deque"</span> <span class="hljs-keyword">if</span> speedup &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-string">"List"</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  â†’ <span class="hljs-subst">{winner}</span>å¿« <span class="hljs-subst">{<span class="hljs-built_in">abs</span>(speedup):<span class="hljs-number">.1</span>f}</span>x"</span>)
        <span class="hljs-built_in">print</span>()
        
        results.append({
            <span class="hljs-string">"test"</span>: test_name,
            <span class="hljs-string">"list"</span>: list_time,
            <span class="hljs-string">"deque"</span>: deque_time,
            <span class="hljs-string">"speedup"</span>: speedup
        })
    
    <span class="hljs-comment"># æ‰“å°æ€»ç»“</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">80</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"æµ‹è¯•æ€»ç»“"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">80</span>)
    <span class="hljs-built_in">print</span>()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{<span class="hljs-string">'æµ‹è¯•åœºæ™¯'</span>:&lt;<span class="hljs-number">30</span>}</span> <span class="hljs-subst">{<span class="hljs-string">'List(ms)'</span>:&lt;<span class="hljs-number">12</span>}</span> <span class="hljs-subst">{<span class="hljs-string">'Deque(ms)'</span>:&lt;<span class="hljs-number">12</span>}</span> <span class="hljs-subst">{<span class="hljs-string">'é€Ÿåº¦å¯¹æ¯”'</span>:&lt;<span class="hljs-number">10</span>}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"-"</span> * <span class="hljs-number">80</span>)
    
    <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> results:
        winner = <span class="hljs-string">"ğŸŸ¢ Deque"</span> <span class="hljs-keyword">if</span> r[<span class="hljs-string">'speedup'</span>] &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-string">"ğŸ”´ List"</span>
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{r[<span class="hljs-string">'test'</span>]:&lt;<span class="hljs-number">30</span>}</span> <span class="hljs-subst">{r[<span class="hljs-string">'list'</span>]:&lt;<span class="hljs-number">12.2</span>f}</span> <span class="hljs-subst">{r[<span class="hljs-string">'deque'</span>]:&lt;<span class="hljs-number">12.2</span>f}</span> <span class="hljs-subst">{winner}</span> <span class="hljs-subst">{<span class="hljs-built_in">abs</span>(r[<span class="hljs-string">'speedup'</span>]):<span class="hljs-number">.1</span>f}</span>x"</span>)
    
    <span class="hljs-built_in">print</span>()
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">80</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"å…³é”®ç»“è®º:"</span>)
    
    <span class="hljs-comment"># æ‰¾å‡ºæœ€å¤§å·®å¼‚</span>
    max_speedup = <span class="hljs-built_in">max</span>(results, key=<span class="hljs-keyword">lambda</span> x: <span class="hljs-built_in">abs</span>(x[<span class="hljs-string">'speedup'</span>] - <span class="hljs-number">1</span>))
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  æœ€å¤§å·®å¼‚: <span class="hljs-subst">{max_speedup[<span class="hljs-string">'test'</span>]}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  â†’ Dequeå¿« <span class="hljs-subst">{max_speedup[<span class="hljs-string">'speedup'</span>]:<span class="hljs-number">.1</span>f}</span>x"</span>)
    
    <span class="hljs-comment"># è®¡ç®—åœ¨æ·»åŠ åœºæ™¯ä¸‹çš„å¹³å‡æå‡</span>
    add_tests = [r <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> results <span class="hljs-keyword">if</span> <span class="hljs-string">'æ·»åŠ '</span> <span class="hljs-keyword">in</span> r[<span class="hljs-string">'test'</span>]]
    avg_add_speedup = <span class="hljs-built_in">sum</span>(r[<span class="hljs-string">'speedup'</span>] <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> add_tests) / <span class="hljs-built_in">len</span>(add_tests)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"  æ·»åŠ æ“ä½œå¹³å‡: Dequeå¿« <span class="hljs-subst">{avg_add_speedup:<span class="hljs-number">.1</span>f}</span>x"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">80</span>)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    run_all_tests()
</code></pre>
<h4 data-id="heading-11"><strong>æµ‹è¯•1ï¼šæ·»åŠ æ“ä½œï¼ˆæ ¸å¿ƒåœºæ™¯ï¼‰</strong></h4>























<table><thead><tr><th>è§„æ¨¡</th><th>List</th><th>Deque</th><th>æå‡</th></tr></thead><tbody><tr><td>10,000æ¬¡</td><td>6.13ms</td><td>3.28ms</td><td><strong>1.9x</strong></td></tr><tr><td>100,000æ¬¡</td><td>36.19ms</td><td>17.72ms</td><td><strong>2.0x</strong></td></tr></tbody></table>
<p><strong>å‘ç°ï¼šè§„æ¨¡è¶Šå¤§ï¼ŒDequeä¼˜åŠ¿è¶Šæ˜æ˜¾ã€‚åœ¨10ä¸‡æ¬¡æ“ä½œæ—¶ï¼ŒDequeå¿«2å€ã€‚</strong></p>
<h4 data-id="heading-12"><strong>æµ‹è¯•2ï¼šæ··åˆæ“ä½œï¼ˆæ„å¤–å‘ç°ï¼‰</strong></h4>
<pre><code class="hljs language-diff" lang="diff">æ··åˆæ“ä½œï¼ˆæ·»åŠ +è·å–ï¼‰10000æ¬¡ï¼š
<span class="hljs-deletion">- List:  44.12ms  âœ…</span>
<span class="hljs-deletion">- Deque: 125.34ms âŒ</span>

ä»€ä¹ˆï¼ŸListåè€Œæ›´å¿«ï¼Ÿ
</code></pre>
<p><strong>åŸå› ï¼š<code>list(deque)</code>çš„è½¬æ¢å¼€é”€å¾ˆå¤§</strong></p>
<p>æ¯æ¬¡è°ƒç”¨<code>get_messages()</code>æ—¶ï¼ŒDequeéœ€è¦è½¬æ¢æˆListï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_messages</span>(<span class="hljs-params">self</span>):
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>(self.messages)  <span class="hljs-comment"># âš ï¸ æ¯æ¬¡éƒ½åˆ›å»ºæ–°list</span>
</code></pre>
<p>è¿™ç»™æˆ‘ä»¬ä¸€ä¸ªé‡è¦å¯ç¤ºï¼š<strong>ä¸è¦é¢‘ç¹è½¬æ¢ï¼</strong></p>
<h4 data-id="heading-13"><strong>ä¼˜åŒ–æ–¹æ¡ˆ</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ShortTermMemory</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_messages</span>(<span class="hljs-params">self</span>) -&gt; deque:
        <span class="hljs-comment"># ç›´æ¥è¿”å›dequeï¼Œä¸è½¬æ¢</span>
        <span class="hljs-keyword">return</span> self.messages
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">chat</span>(<span class="hljs-params">self, user_input</span>):
        <span class="hljs-comment"># åªåœ¨çœŸæ­£éœ€è¦listæ—¶æ‰è½¬æ¢</span>
        context = [system_prompt] + <span class="hljs-built_in">list</span>(self.memory.get_messages())
        <span class="hljs-comment"># è¿™æ ·åªè½¬æ¢ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯æ¯æ¬¡æ“ä½œéƒ½è½¬æ¢</span>
</code></pre>
<h4 data-id="heading-14"><strong>æœ€ç»ˆæ€§èƒ½å¯¹æ¯”</strong></h4>
<p>åœ¨<strong>å…¸å‹å¯¹è¯åœºæ™¯</strong>ï¼ˆæ»¡å®¹é‡åç»§ç»­æ·»åŠ ï¼‰ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">10ä¸‡æ¬¡æ“ä½œï¼š
<span class="hljs-bullet">-</span> List:  36.19ms
<span class="hljs-bullet">-</span> Deque: 17.72ms
<span class="hljs-bullet">-</span> Dequeå¿« 2.0x âœ…

å…³é”®ï¼šDequeåœ¨æ ¸å¿ƒåœºæ™¯ï¼ˆæ·»åŠ ï¼‰å¿«2å€ï¼Œ
<span class="hljs-code">     åªè¦å‡å°‘ä¸å¿…è¦çš„listè½¬æ¢å³å¯ã€‚
</span></code></pre>
<h4 data-id="heading-15"><strong>ä¸ºä»€ä¹ˆé€‰Dequeï¼Ÿ</strong></h4>
<ol>
<li><strong>ä»£ç ç®€æ´</strong></li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Listéœ€è¦æ‰‹åŠ¨ç®¡ç†</span>
<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(messages) &gt; max_messages:
    messages = messages[-max_messages:]

<span class="hljs-comment"># Dequeè‡ªåŠ¨ç®¡ç†</span>
<span class="hljs-comment"># ä»€ä¹ˆéƒ½ä¸ç”¨åš âœ…</span>
</code></pre>
<ol start="2">
<li><strong>æ€§èƒ½æ›´å¥½</strong>ï¼ˆåœ¨æ ¸å¿ƒåœºæ™¯ï¼‰</li>
</ol>
<ul>
<li>æ·»åŠ æ“ä½œï¼šå¿« 2.0x</li>
<li>åªè¦ä¼˜åŒ–è½¬æ¢ï¼Œæ²¡æœ‰åŠ£åŠ¿</li>
</ul>
<ol start="3">
<li><strong>æ—¶é—´å¤æ‚åº¦ä¿è¯</strong></li>
</ol>
<ul>
<li>Liståˆ‡ç‰‡ï¼šO(n)</li>
<li>Dequeæ·»åŠ ï¼šO(1)</li>
</ul>
<p><strong>ç»“è®ºï¼šé€‰Dequeï¼Œä¼˜åŒ–listè½¬æ¢ï¼Œæœ€ä½³å®è·µã€‚</strong></p>
<p>å®Œæ•´æµ‹è¯•ä»£ç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsotopelaez092-star%2Fmemory-chatbot%2Fblob%2Fmain%2Ftests%2Ftest_list_vs_deque.py" target="_blank" title="https://github.com/sotopelaez092-star/memory-chatbot/blob/main/tests/test_list_vs_deque.py" ref="nofollow noopener noreferrer">github.com/sotopelaez0â€¦</a></p>
<h3 data-id="heading-16"><strong>2.3 ç”Ÿäº§çº§å®ç°</strong></h3>
<p>åŸºäºdequeï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ªå®Œæ•´çš„çŸ­æœŸè®°å¿†ç®¡ç†ç±»ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> deque
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ShortTermMemory</span>:
    <span class="hljs-string">"""
    çŸ­æœŸè®°å¿†ç®¡ç†å™¨
    
    ç‰¹ç‚¹ï¼š
    - è‡ªåŠ¨ç®¡ç†å®¹é‡ï¼ˆåŸºäºdequeï¼‰
    - æé€Ÿè¯»å†™ï¼ˆ&lt;1msï¼‰
    - æŒ‰è½®æ•°ç®¡ç†ï¼ˆ1è½® = user + assistantï¼‰
    """</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, max_turns: <span class="hljs-built_in">int</span> = <span class="hljs-number">10</span></span>):
        <span class="hljs-string">"""
        Args:
            max_turns: æœ€å¤§è½®æ•°ï¼ˆé»˜è®¤10è½® = 20æ¡æ¶ˆæ¯ï¼‰
        """</span>
        self.max_turns = max_turns
        self.max_messages = max_turns * <span class="hljs-number">2</span>
        self.messages: deque = deque(maxlen=self.max_messages)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_message</span>(<span class="hljs-params">self, role: <span class="hljs-built_in">str</span>, content: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""æ·»åŠ ä¸€æ¡æ¶ˆæ¯"""</span>
        self.messages.append({
            <span class="hljs-string">"role"</span>: role,
            <span class="hljs-string">"content"</span>: content
        })
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_messages</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]]:
        <span class="hljs-string">"""è·å–æ‰€æœ‰æ¶ˆæ¯"""</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>(self.messages)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">clear</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""æ¸…ç©ºè®°å¿†"""</span>
        self.messages.clear()
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_turn_count</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">int</span>:
        <span class="hljs-string">"""è·å–å½“å‰è½®æ•°"""</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(self.messages) // <span class="hljs-number">2</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">is_full</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bool</span>:
        <span class="hljs-string">"""åˆ¤æ–­æ˜¯å¦å·²æ»¡"""</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">len</span>(self.messages) &gt;= self.max_messages
</code></pre>
<p><strong>å…³é”®è®¾è®¡ï¼š</strong></p>
<ul>
<li>æŒ‰<strong>è½®æ•°</strong>è€Œéæ¶ˆæ¯æ•°ç®¡ç†ï¼ˆæ›´ç¬¦åˆå¯¹è¯é€»è¾‘ï¼‰</li>
<li><code>maxlen</code>å‚æ•°è®©dequeè‡ªåŠ¨åˆ é™¤ï¼ˆæ— éœ€æ‰‹åŠ¨ç®¡ç†ï¼‰</li>
<li>æä¾›<code>is_full()</code>ç­‰è¾…åŠ©æ–¹æ³•ï¼ˆæ–¹ä¾¿åç»­å‹ç¼©ç­–ç•¥åˆ¤æ–­ï¼‰</li>
</ul>
<p>å®Œæ•´ä»£ç è§ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsotopelaez092-star%2Fmemory-chatbot%2Fblob%2Fmain%2Fsrc%2Fmemory%2Fshort_term.py" target="_blank" title="https://github.com/sotopelaez092-star/memory-chatbot/blob/main/src/memory/short_term.py" ref="nofollow noopener noreferrer">github.com/sotopelaez0â€¦</a></p>
<h3 data-id="heading-17"><strong>2.4 é›†æˆåˆ°Chatbot</strong></h3>
<p>æœ‰äº†çŸ­æœŸè®°å¿†ï¼Œå¦‚ä½•é›†æˆåˆ°Chatbotä¸­ï¼Ÿæ ¸å¿ƒæµç¨‹æ˜¯ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryChatbot</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, llm, system_prompt: <span class="hljs-built_in">str</span> = <span class="hljs-string">"ä½ æ˜¯AIåŠ©æ‰‹"</span></span>):
        self.llm = llm
        self.system_prompt = system_prompt
        self.memory = ShortTermMemory(max_turns=<span class="hljs-number">10</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">chat</span>(<span class="hljs-params">self, user_input: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-comment"># 1. ä¿å­˜ç”¨æˆ·è¾“å…¥åˆ°è®°å¿†</span>
        self.memory.add_message(<span class="hljs-string">"user"</span>, user_input)
        
        <span class="hljs-comment"># 2. æ„å»ºä¸Šä¸‹æ–‡ï¼šsystem + å†å²æ¶ˆæ¯</span>
        messages = [
            {<span class="hljs-string">"role"</span>: <span class="hljs-string">"system"</span>, <span class="hljs-string">"content"</span>: self.system_prompt}
        ]
        messages.extend(self.memory.get_messages())
        
        <span class="hljs-comment"># 3. è°ƒç”¨LLM</span>
        response = self.llm.chat(messages)
        
        <span class="hljs-comment"># 4. ä¿å­˜AIå›å¤åˆ°è®°å¿†</span>
        self.memory.add_message(<span class="hljs-string">"assistant"</span>, response)
        
        <span class="hljs-keyword">return</span> response
</code></pre>
<p><strong>æ•°æ®æµï¼š</strong></p>
<pre><code class="hljs language-sql" lang="sql">ç”¨æˆ·è¾“å…¥ "æˆ‘å«Tom"
    â†“
å­˜å…¥memory: [{"role": "user", "content": "æˆ‘å«Tom"}]
    â†“
æ„å»ºä¸Šä¸‹æ–‡: [<span class="hljs-keyword">system</span>, <span class="hljs-keyword">user</span>æ¶ˆæ¯]
    â†“
è°ƒç”¨LLM â†’ è¿”å› "ä½ å¥½Tomï¼"
    â†“
å­˜å…¥memory: [<span class="hljs-keyword">user</span>æ¶ˆæ¯, assistantæ¶ˆæ¯]
</code></pre>
<p><strong>æ•ˆæœæ¼”ç¤ºï¼š</strong></p>
<pre><code class="hljs language-python" lang="python">bot = MemoryChatbot(llm)

<span class="hljs-comment"># ç¬¬1è½®</span>
bot.chat(<span class="hljs-string">"æˆ‘å«Tom"</span>)
<span class="hljs-comment"># Bot: "ä½ å¥½Tomï¼"</span>

<span class="hljs-comment"># ç¬¬2è½®</span>
bot.chat(<span class="hljs-string">"æˆ‘åœ¨ä¸Šæµ·å·¥ä½œ"</span>)
<span class="hljs-comment"># Bot: "ä¸Šæµ·æ˜¯ä¸ªå¾ˆæ£’çš„åŸå¸‚ï¼"</span>

<span class="hljs-comment"># ç¬¬3è½® - æµ‹è¯•è®°å¿†</span>
bot.chat(<span class="hljs-string">"æˆ‘å«ä»€ä¹ˆåå­—ï¼Ÿåœ¨å“ªå·¥ä½œï¼Ÿ"</span>)
<span class="hljs-comment"># Bot: "ä½ å«Tomï¼Œåœ¨ä¸Šæµ·å·¥ä½œ" âœ… è®°ä½äº†ï¼</span>
</code></pre>
<p>å®Œæ•´ä»£ç è§ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsotopelaez092-star%2Fmemory-chatbot%2Fblob%2Fmain%2Fsrc%2Fchatbot.py" target="_blank" title="https://github.com/sotopelaez092-star/memory-chatbot/blob/main/src/chatbot.py" ref="nofollow noopener noreferrer">github.com/sotopelaez0â€¦</a></p>
<h3 data-id="heading-18"><strong>2.5 çŸ­æœŸè®°å¿†çš„å±€é™æ€§</strong></h3>
<p>çŸ­æœŸè®°å¿†è™½ç„¶ç®€å•é«˜æ•ˆï¼Œä½†æœ‰ä¸‰ä¸ªæ˜æ˜¾çš„é—®é¢˜ï¼š</p>
<h4 data-id="heading-19"><strong>é—®é¢˜1ï¼šå®¹é‡æœ‰é™</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è®¾ç½®æœ€å¤šä¿å­˜10è½®</span>
memory = ShortTermMemory(max_turns=<span class="hljs-number">10</span>)

<span class="hljs-comment"># å¯¹è¯20è½®å</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):
    memory.add_message(<span class="hljs-string">"user"</span>, <span class="hljs-string">f"æ¶ˆæ¯<span class="hljs-subst">{i}</span>"</span>)
    memory.add_message(<span class="hljs-string">"assistant"</span>, <span class="hljs-string">f"å›å¤<span class="hljs-subst">{i}</span>"</span>)

<span class="hljs-comment"># ç»“æœï¼šå‰10è½®è¢«ä¸¢å¼ƒ</span>
<span class="hljs-built_in">print</span>(memory.get_turn_count())  <span class="hljs-comment"># 10è½®</span>
<span class="hljs-comment"># ç¬¬1è½®çš„"æˆ‘å«Tom"å·²ç»æ‰¾ä¸åˆ°äº†ï¼âŒ</span>
</code></pre>
<h4 data-id="heading-20"><strong>é—®é¢˜2ï¼šç®€å•ç²—æš´çš„åˆ é™¤ç­–ç•¥</strong></h4>
<pre><code class="hljs language-python" lang="python">é‡è¦ä¿¡æ¯ï¼š<span class="hljs-string">"æˆ‘å«Tom"</span>ï¼ˆç¬¬<span class="hljs-number">1</span>è½®ï¼‰
ä¸é‡è¦ä¿¡æ¯ï¼š<span class="hljs-string">"è°¢è°¢"</span>ï¼ˆç¬¬<span class="hljs-number">19</span>è½®ï¼‰

<span class="hljs-number">10</span>è½®åï¼Œ<span class="hljs-string">"æˆ‘å«Tom"</span>è¢«åˆ é™¤
ä½†<span class="hljs-string">"è°¢è°¢"</span>è¢«ä¿ç•™

è¿™ä¸åˆç†ï¼âŒ
</code></pre>
<p>çŸ­æœŸè®°å¿†<strong>ä¸åŒºåˆ†ä¿¡æ¯çš„é‡è¦æ€§</strong>ï¼ŒåªæŒ‰æ—¶é—´é¡ºåºåˆ é™¤ã€‚</p>
<h4 data-id="heading-21"><strong>é—®é¢˜3ï¼šTokenæµªè´¹</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-number">20</span>è½®å¯¹è¯ = <span class="hljs-number">20</span>æ¡æ¶ˆæ¯ â‰ˆ <span class="hljs-number">8000</span> tokens

å…¶ä¸­å¯èƒ½åŒ…å«ï¼š
- <span class="hljs-string">"å—¯"</span>ã€<span class="hljs-string">"å¥½çš„"</span>ã€<span class="hljs-string">"è°¢è°¢"</span> ç­‰æ— æ„ä¹‰å†…å®¹
- é‡å¤çš„ä¿¡æ¯
- å¯ä»¥å‹ç¼©çš„å†—é•¿æè¿°

è¿™äº›éƒ½å ç”¨å®è´µçš„ä¸Šä¸‹æ–‡çª—å£ï¼
</code></pre>
<p>çŸ­æœŸè®°å¿†è§£å†³äº†<strong>åŸºæœ¬çš„è®°å¿†èƒ½åŠ›</strong>ï¼Œä½†ä¸‰ä¸ªå±€é™æ€§å‘Šè¯‰æˆ‘ä»¬ï¼š</p>
<p><strong>æˆ‘ä»¬éœ€è¦æ›´æ™ºèƒ½çš„ç­–ç•¥ï¼š</strong></p>
<ol>
<li>åœ¨æœ‰é™ç©ºé—´å†…ä¿å­˜<strong>æ›´å¤šä¿¡æ¯</strong></li>
<li>ä¿ç•™<strong>é‡è¦å†…å®¹</strong>ï¼Œåˆ é™¤<strong>æ— å…³å†…å®¹</strong></li>
<li><strong>å‹ç¼©å†—é•¿å¯¹è¯</strong>ï¼ŒèŠ‚çœtoken</li>
</ol>
<p>å¥½çš„ï¼è®©æˆ‘ä»¬å†™ <strong>3.1 ä¸ºä»€ä¹ˆéœ€è¦å‹ç¼©ï¼Ÿ</strong> ğŸ—œï¸</p>
<hr/>
<h2 data-id="heading-22"><strong>ä¸‰ã€4ç§å‹ç¼©ç­–ç•¥è¯¦è§£</strong></h2>
<h3 data-id="heading-23"><strong>3.1 ä¸ºä»€ä¹ˆéœ€è¦å‹ç¼©ï¼Ÿ</strong></h3>
<p>åœ¨ç¬¬äºŒç« æˆ‘ä»¬çœ‹åˆ°ï¼ŒçŸ­æœŸè®°å¿†æœ‰ä¸‰ä¸ªè‡´å‘½é—®é¢˜ï¼š</p>
<ol>
<li>å®¹é‡å›ºå®šï¼Œé‡è¦ä¿¡æ¯ä¼šä¸¢å¤±</li>
<li>ä¸åŒºåˆ†ä¿¡æ¯é‡è¦æ€§</li>
<li>Tokenæµªè´¹ä¸¥é‡</li>
</ol>
<p>ç°åœ¨é—®é¢˜æ¥äº†ï¼š<strong>å¦‚ä½•åœ¨æœ‰é™çš„ç©ºé—´å†…ï¼Œä¿å­˜æ›´å¤šæœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Ÿ</strong></p>
<p>ç­”æ¡ˆæ˜¯ï¼š<strong>å‹ç¼©</strong>ã€‚</p>
<h4 data-id="heading-24"><strong>å‹ç¼©è¦è§£å†³çš„æ ¸å¿ƒçŸ›ç›¾</strong></h4>
<pre><code class="hljs language-diff" lang="diff">çŸ›ç›¾ï¼š
<span class="hljs-deletion">- LLMä¸Šä¸‹æ–‡çª—å£æœ‰é™ï¼ˆå¦‚8K tokensï¼‰</span>
<span class="hljs-deletion">- ç”¨æˆ·å¯¹è¯å¯èƒ½å¾ˆé•¿ï¼ˆ50è½®ã€100è½®...ï¼‰</span>
<span class="hljs-deletion">- æ¯ä¸ªtokenéƒ½è¦èŠ±é’±</span>

ç›®æ ‡ï¼š
<span class="hljs-deletion">- ç”¨æ›´å°‘çš„token</span>
<span class="hljs-deletion">- ä¿ç•™æ›´å¤šçš„ä¿¡æ¯</span>
<span class="hljs-deletion">- ä¿æŒå¯¹è¯è¿è´¯æ€§</span>
</code></pre>
<h4 data-id="heading-25"><strong>ä¸€ä¸ªå…·ä½“çš„ä¾‹å­</strong></h4>
<p>å‡è®¾æˆ‘ä»¬æœ‰è¿™æ ·ä¸€æ®µå¯¹è¯å†å²ï¼ˆ10è½®ï¼Œ20æ¡æ¶ˆæ¯ï¼‰ï¼š</p>
<pre><code class="hljs language-python" lang="python">åŸå§‹å¯¹è¯ï¼ˆæœªå‹ç¼©ï¼‰ï¼š
[
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æˆ‘å«Tom"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½Tomï¼å¾ˆé«˜å…´è®¤è¯†ä½ ã€‚"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æˆ‘åœ¨ä¸Šæµ·å·¥ä½œ"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä¸Šæµ·æ˜¯ä¸ªå¾ˆå›½é™…åŒ–çš„åŸå¸‚ï¼ä½ åœ¨å“ªä¸ªè¡Œä¸šï¼Ÿ"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æˆ‘æ˜¯AIå·¥ç¨‹å¸ˆ"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"AIå·¥ç¨‹å¸ˆæ˜¯ä¸ªå¾ˆæœ‰å‰æ™¯çš„èŒä¸šï¼"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æˆ‘æœ€è¿‘åœ¨ç ”ç©¶Agent"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"Agentæ˜¯å¾ˆå‰æ²¿çš„æ–¹å‘ï¼"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"é‡åˆ°äº†é€šä¿¡å»¶è¿Ÿé—®é¢˜"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"é€šä¿¡å»¶è¿Ÿå¯ä»¥è€ƒè™‘ä¼˜åŒ–æ¶ˆæ¯é˜Ÿåˆ—ã€‚"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ç”¨ä»€ä¹ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"å¯ä»¥è€ƒè™‘Redisæˆ–RabbitMQã€‚"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"Redisæ€§èƒ½æ€ä¹ˆæ ·ï¼Ÿ"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"Rediséå¸¸å¿«ï¼Œå•æœºQPSå¯è¾¾10ä¸‡+ã€‚"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"å¥½çš„ï¼Œè°¢è°¢"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä¸å®¢æ°”ï¼æœ‰é—®é¢˜éšæ—¶é—®ã€‚"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"å—¯"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"è¿˜æœ‰ä»€ä¹ˆæˆ‘èƒ½å¸®ä½ çš„å—ï¼Ÿ"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æ²¡æœ‰äº†"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"å¥½çš„ï¼Œç¥ä½ å·¥ä½œé¡ºåˆ©ï¼"</span>}
]

ç»Ÿè®¡ï¼š
- <span class="hljs-number">20</span>æ¡æ¶ˆæ¯
- çº¦<span class="hljs-number">2000</span> tokens
- åŒ…å«é‡è¦ä¿¡æ¯ï¼š<span class="hljs-string">"Tom"</span>ã€<span class="hljs-string">"ä¸Šæµ·"</span>ã€<span class="hljs-string">"AIå·¥ç¨‹å¸ˆ"</span>ã€<span class="hljs-string">"Agent"</span>ã€<span class="hljs-string">"Redis"</span>
- ä¹ŸåŒ…å«å†—ä½™ä¿¡æ¯ï¼š<span class="hljs-string">"å¥½çš„è°¢è°¢"</span>ã€<span class="hljs-string">"å—¯"</span>ã€<span class="hljs-string">"æ²¡æœ‰äº†"</span>
</code></pre>
<p><strong>å‹ç¼©ååº”è¯¥æ˜¯ä»€ä¹ˆæ ·ï¼Ÿ</strong></p>
<p>ç†æƒ³çš„å‹ç¼©ç»“æœï¼š</p>
<pre><code class="hljs language-python" lang="python">å‹ç¼©åï¼š
[
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"system"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ç”¨æˆ·Tomï¼Œä¸Šæµ·AIå·¥ç¨‹å¸ˆï¼Œç ”ç©¶Agentï¼Œé‡åˆ°é€šä¿¡å»¶è¿Ÿï¼Œæ¨èç”¨Redis"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"Redisæ€§èƒ½æ€ä¹ˆæ ·ï¼Ÿ"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"Rediséå¸¸å¿«ï¼Œå•æœºQPSå¯è¾¾10ä¸‡+ã€‚"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æ²¡æœ‰äº†"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"å¥½çš„ï¼Œç¥ä½ å·¥ä½œé¡ºåˆ©ï¼"</span>}
]

ç»Ÿè®¡ï¼š
- <span class="hljs-number">5</span>æ¡æ¶ˆæ¯
- çº¦<span class="hljs-number">500</span> tokens
- ä¿ç•™äº†æ‰€æœ‰å…³é”®ä¿¡æ¯
- åˆ é™¤äº†å†—ä½™å†…å®¹
- å‹ç¼©ç‡ï¼š<span class="hljs-number">75</span>% âœ…
</code></pre>
<h4 data-id="heading-26"><strong>å¦‚ä½•è¯„ä»·ä¸€ä¸ªå‹ç¼©ç­–ç•¥ï¼Ÿ</strong></h4>
<p>æˆ‘ä»¬éœ€è¦ä»4ä¸ªç»´åº¦æ¥è¯„ä»·ï¼š</p>
<p><strong>1. å‹ç¼©ç‡ï¼ˆCompression Rateï¼‰</strong></p>
<pre><code class="hljs language-diff" lang="diff">å‹ç¼©ç‡ = (åŸå§‹tokens - å‹ç¼©åtokens) / åŸå§‹tokens

ä¾‹å¦‚ï¼š
<span class="hljs-deletion">- åŸå§‹ï¼š2000 tokens</span>
<span class="hljs-deletion">- å‹ç¼©åï¼š500 tokens</span>
<span class="hljs-deletion">- å‹ç¼©ç‡ï¼š75%</span>

è¶Šé«˜è¶Šå¥½ âœ…
</code></pre>
<p><strong>2. é€Ÿåº¦ï¼ˆSpeedï¼‰</strong></p>
<pre><code class="hljs language-diff" lang="diff">å‹ç¼©è€—æ—¶

ä¾‹å¦‚ï¼š
<span class="hljs-deletion">- æ»‘åŠ¨çª—å£ï¼š&lt;1msï¼ˆå†…å­˜æ“ä½œï¼‰</span>
<span class="hljs-deletion">- LLMæ‘˜è¦ï¼š1-3ç§’ï¼ˆéœ€è¦APIè°ƒç”¨ï¼‰</span>

è¶Šå¿«è¶Šå¥½ âœ…
</code></pre>
<p><strong>3. æˆæœ¬ï¼ˆCostï¼‰</strong></p>
<pre><code class="hljs language-bash" lang="bash">å‹ç¼©æœ¬èº«çš„æˆæœ¬

ä¾‹å¦‚ï¼š
- æ»‘åŠ¨çª—å£ï¼š<span class="hljs-variable">$0</span>ï¼ˆæ— é¢å¤–æˆæœ¬ï¼‰
- LLMæ‘˜è¦ï¼š<span class="hljs-variable">$0</span>.0001ï¼ˆéœ€è¦è°ƒç”¨LLMï¼‰

è¶Šä½è¶Šå¥½ âœ…
</code></pre>
<p><strong>4. è¯­ä¹‰ä¿ç•™ï¼ˆSemantic Preservationï¼‰</strong></p>
<pre><code class="hljs language-diff" lang="diff">æ˜¯å¦ä¿ç•™äº†é‡è¦ä¿¡æ¯ï¼Ÿ

ä¾‹å¦‚ï¼š
<span class="hljs-deletion">- æ»‘åŠ¨çª—å£ï¼šå¯èƒ½ä¸¢å¤±æ—©æœŸçš„é‡è¦ä¿¡æ¯ âš ï¸</span>
<span class="hljs-deletion">- LLMæ‘˜è¦ï¼šæ™ºèƒ½æå–å…³é”®ä¿¡æ¯ âœ…</span>

è¶Šå¥½è¶Šå¥½ âœ…
</code></pre>
<h4 data-id="heading-27"><strong>å‹ç¼©ç­–ç•¥çš„æƒè¡¡ï¼ˆTrade-offï¼‰</strong></h4>
<p>ç°å®ä¸­ï¼Œæˆ‘ä»¬æ— æ³•åŒæ—¶ä¼˜åŒ–æ‰€æœ‰4ä¸ªç»´åº¦ï¼š</p>
<pre><code class="hljs language-lua" lang="lua">ä¸å¯èƒ½ä¸‰è§’ï¼š
       é€Ÿåº¦å¿«
        / \
       /   \
      /     \
   æˆæœ¬ä½ <span class="hljs-comment">---- è¯­ä¹‰å¥½</span>

ä½ åªèƒ½é€‰ä¸¤ä¸ªï¼
</code></pre>
<p><strong>ä¾‹å¦‚ï¼š</strong></p>
<ul>
<li><strong>æ»‘åŠ¨çª—å£</strong>ï¼šé€Ÿåº¦å¿« + æˆæœ¬ä½ = è¯­ä¹‰å·®</li>
<li><strong>LLMæ‘˜è¦</strong>ï¼šè¯­ä¹‰å¥½ + å‹ç¼©ç‡é«˜ = é€Ÿåº¦æ…¢ã€æˆæœ¬é«˜</li>
<li><strong>æ··åˆç­–ç•¥</strong>ï¼šå°è¯•å¹³è¡¡ä¸‰è€…</li>
</ul>
<h4 data-id="heading-28"><strong>æˆ‘ä»¬è¦å®ç°çš„4ç§ç­–ç•¥</strong></h4>
<p>åŸºäºä¸åŒçš„æƒè¡¡ï¼Œæˆ‘ä»¬å®ç°4ç§å‹ç¼©ç­–ç•¥ï¼š</p>



































<table><thead><tr><th>ç­–ç•¥</th><th>æ ¸å¿ƒæ€è·¯</th><th>ä¼˜åŠ¿ç»´åº¦</th><th>åŠ£åŠ¿ç»´åº¦</th></tr></thead><tbody><tr><td><strong>æ»‘åŠ¨çª—å£</strong></td><td>åªä¿ç•™æœ€è¿‘Nè½®</td><td>é€Ÿåº¦ã€æˆæœ¬</td><td>è¯­ä¹‰ä¿ç•™</td></tr><tr><td><strong>LLMæ‘˜è¦</strong></td><td>ç”¨LLMæ€»ç»“å†å²</td><td>è¯­ä¹‰ä¿ç•™</td><td>é€Ÿåº¦ã€æˆæœ¬</td></tr><tr><td><strong>æ··åˆç­–ç•¥</strong></td><td>è‡ªé€‚åº”é€‰æ‹©</td><td>å¹³è¡¡</td><td>å¤æ‚åº¦</td></tr><tr><td><strong>TokenåŠ¨æ€</strong></td><td>ç²¾ç¡®æ§åˆ¶tokenæ•°</td><td>ç²¾ç¡®åº¦</td><td>è¯­ä¹‰ä¿ç•™</td></tr></tbody></table>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€ä¸ªè¯¦è§£è¿™4ç§ç­–ç•¥çš„ï¼š</p>
<ul>
<li>æ ¸å¿ƒåŸç†</li>
<li>ä»£ç å®ç°</li>
<li>æ€§èƒ½è¡¨ç°</li>
<li>é€‚ç”¨åœºæ™¯</li>
</ul>
<p>å¥½çš„ï¼è®©æˆ‘ä»¬å†™ <strong>3.2 ç­–ç•¥1ï¼šæ»‘åŠ¨çª—å£</strong> ğŸªŸ</p>
<hr/>
<h4 data-id="heading-29"/>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SlidingWindowCompressor</span>:
    <span class="hljs-string">"""
    æ»‘åŠ¨çª—å£å‹ç¼©å™¨
    
    åŸç†ï¼šåªä¿ç•™æœ€è¿‘Nè½®å¯¹è¯
    """</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, keep_turns: <span class="hljs-built_in">int</span> = <span class="hljs-number">5</span></span>):
        <span class="hljs-string">"""
        Args:
            keep_turns: ä¿ç•™æœ€è¿‘å‡ è½®å¯¹è¯
        """</span>
        self.keep_turns = keep_turns
        self.keep_messages = keep_turns * <span class="hljs-number">2</span>  <span class="hljs-comment"># 1è½® = 2æ¡æ¶ˆæ¯</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages: <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]]</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]]:
        <span class="hljs-string">"""
        å‹ç¼©æ¶ˆæ¯åˆ—è¡¨
        
        Args:
            messages: åŸå§‹æ¶ˆæ¯åˆ—è¡¨
            
        Returns:
            å‹ç¼©åçš„æ¶ˆæ¯åˆ—è¡¨
        """</span>
        <span class="hljs-comment"># å¦‚æœæ¶ˆæ¯æ•°æœªè¶…è¿‡é™åˆ¶ï¼Œç›´æ¥è¿”å›</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(messages) &lt;= self.keep_messages:
            <span class="hljs-keyword">return</span> messages
        
        <span class="hljs-comment"># åªä¿ç•™æœ€åNæ¡æ¶ˆæ¯</span>
        compressed = messages[-self.keep_messages:]
        
        <span class="hljs-keyword">return</span> compressed
</code></pre>
<p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python">compressor = SlidingWindowCompressor(keep_turns=<span class="hljs-number">3</span>)

<span class="hljs-comment"># åŸå§‹å¯¹è¯ï¼ˆ10æ¡æ¶ˆæ¯ï¼Œ5è½®ï¼‰</span>
messages = [
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æˆ‘å«Tom"</span>},           <span class="hljs-comment"># ç¬¬1è½®</span>
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä½ å¥½Tomï¼"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æˆ‘åœ¨ä¸Šæµ·"</span>},          <span class="hljs-comment"># ç¬¬2è½®</span>
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"ä¸Šæµ·ä¸é”™"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æˆ‘æ˜¯å·¥ç¨‹å¸ˆ"</span>},        <span class="hljs-comment"># ç¬¬3è½®</span>
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"å¾ˆå¥½"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æˆ‘ç ”ç©¶AI"</span>},          <span class="hljs-comment"># ç¬¬4è½®</span>
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"AIå¾ˆçƒ­"</span>},
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æ¨èä¹¦ç±"</span>},          <span class="hljs-comment"># ç¬¬5è½®</span>
    {<span class="hljs-string">"role"</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">"æ¨èxxx"</span>},
]

<span class="hljs-comment"># å‹ç¼©ï¼šåªä¿ç•™æœ€è¿‘3è½®</span>
compressed = compressor.compress(messages)

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŸå§‹ï¼š<span class="hljs-subst">{<span class="hljs-built_in">len</span>(messages)}</span>æ¡æ¶ˆæ¯"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‹ç¼©åï¼š<span class="hljs-subst">{<span class="hljs-built_in">len</span>(compressed)}</span>æ¡æ¶ˆæ¯"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä¿ç•™çš„æ˜¯ç¬¬3-5è½®"</span>)
<span class="hljs-comment"># è¾“å‡ºï¼š</span>
<span class="hljs-comment"># åŸå§‹ï¼š10æ¡æ¶ˆæ¯</span>
<span class="hljs-comment"># å‹ç¼©åï¼š6æ¡æ¶ˆæ¯</span>
<span class="hljs-comment"># ä¿ç•™çš„æ˜¯ç¬¬3-5è½®</span>
</code></pre>
<h4 data-id="heading-30"><strong>å·¥ä½œåŸç†å¯è§†åŒ–</strong></h4>
<pre><code class="hljs language-python" lang="python">åŸå§‹å¯¹è¯ï¼ˆ<span class="hljs-number">20</span>æ¡æ¶ˆæ¯ï¼Œ<span class="hljs-number">10</span>è½®ï¼‰ï¼š

è½®æ•°:  <span class="hljs-number">1</span>      <span class="hljs-number">2</span>      <span class="hljs-number">3</span>      <span class="hljs-number">4</span>      <span class="hljs-number">5</span>      <span class="hljs-number">6</span>      <span class="hljs-number">7</span>      <span class="hljs-number">8</span>      <span class="hljs-number">9</span>      <span class="hljs-number">10</span>
      [u,a] [u,a] [u,a] [u,a] [u,a] [u,a] [u,a] [u,a] [u,a] [u,a]
       â†“                                                    â†“
     ä¸¢å¼ƒå‰<span class="hljs-number">7</span>è½®                                          ä¿ç•™å<span class="hljs-number">3</span>è½®

å‹ç¼©åï¼ˆ<span class="hljs-number">6</span>æ¡æ¶ˆæ¯ï¼Œ<span class="hljs-number">3</span>è½®ï¼‰ï¼š

è½®æ•°:                                                  <span class="hljs-number">8</span>      <span class="hljs-number">9</span>      <span class="hljs-number">10</span>
                                                     [u,a] [u,a] [u,a]
</code></pre>
<h4 data-id="heading-31"><strong>æ€§èƒ½åˆ†æ</strong></h4>
<p>å¥½çš„ï¼è®©æˆ‘ä»¬å…ˆæ›´æ–° <strong>3.2 æ»‘åŠ¨çª—å£</strong> çš„æ•°æ®éƒ¨åˆ† ğŸ“</p>
<p>å¥½çš„ï¼è®©æˆ‘å®Œå…¨é‡å†™ <strong>3.2 æ»‘åŠ¨çª—å£ç­–ç•¥</strong>ï¼Œæ•´åˆæ‰€æœ‰çœŸå®æ•°æ® ğŸ“</p>
<hr/>
<h3 data-id="heading-32"><strong>3.2 ç­–ç•¥1ï¼šæ»‘åŠ¨çª—å£ï¼ˆSliding Windowï¼‰</strong></h3>
<h4 data-id="heading-33"><strong>æ ¸å¿ƒåŸç†</strong></h4>
<p>æ»‘åŠ¨çª—å£æ˜¯æœ€ç®€å•ç›´æ¥çš„å‹ç¼©ç­–ç•¥ï¼š<strong>åªä¿ç•™æœ€è¿‘çš„Nè½®å¯¹è¯ï¼Œä¸¢å¼ƒæ›´æ—©çš„æ¶ˆæ¯ã€‚</strong></p>
<p>å°±åƒä¸€ä¸ªå›ºå®šå¤§å°çš„"çª—å£"åœ¨å¯¹è¯å†å²ä¸Šæ»‘åŠ¨ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">å®Œæ•´å¯¹è¯å†å²ï¼ˆ10è½®ï¼Œ20æ¡æ¶ˆæ¯ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ 1  â”‚ 2  â”‚ 3  â”‚ 4  â”‚ 5  â”‚ 6  â”‚ 7  â”‚ 8  â”‚ 9  â”‚ 10 â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

ä¿ç•™æœ€è¿‘5è½®ï¼ˆçª—å£å¤§å°=5ï¼‰ï¼š
<span class="hljs-code">                              â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ 6  â”‚ 7  â”‚ 8  â”‚ 9  â”‚ 10 â”‚     â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
             â†‘
          æ»‘åŠ¨çª—å£
</span></code></pre>
<p><strong>å·¥ä½œæ–¹å¼ï¼š</strong></p>
<ol>
<li>è®¾å®šçª—å£å¤§å°ï¼ˆå¦‚5è½® = 10æ¡æ¶ˆæ¯ï¼‰</li>
<li>å½“æ¶ˆæ¯è¶…è¿‡çª—å£å¤§å°æ—¶</li>
<li>è‡ªåŠ¨åˆ é™¤æœ€æ—©çš„æ¶ˆæ¯</li>
<li>ä¿æŒçª—å£å†…çš„æ¶ˆæ¯æ•°é‡å›ºå®š</li>
</ol>
<h4 data-id="heading-34"><strong>ä»£ç å®ç°</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SlidingWindowCompressor</span>:
    <span class="hljs-string">"""
    æ»‘åŠ¨çª—å£å‹ç¼©å™¨
    
    ç‰¹ç‚¹ï¼š
    - æç®€å®ç°ï¼ˆ3è¡Œæ ¸å¿ƒä»£ç ï¼‰
    - æå¿«é€Ÿåº¦ï¼ˆ0.14å¾®ç§’/æ¬¡ï¼‰
    - é›¶æˆæœ¬ï¼ˆæ— éœ€APIè°ƒç”¨ï¼‰
    """</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, keep_turns: <span class="hljs-built_in">int</span> = <span class="hljs-number">5</span></span>):
        <span class="hljs-string">"""
        Args:
            keep_turns: ä¿ç•™æœ€è¿‘å‡ è½®å¯¹è¯
        """</span>
        self.keep_turns = keep_turns
        self.keep_messages = keep_turns * <span class="hljs-number">2</span>  <span class="hljs-comment"># 1è½® = user + assistant</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages: <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]]</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]]:
        <span class="hljs-string">"""
        å‹ç¼©æ¶ˆæ¯åˆ—è¡¨
        
        Args:
            messages: åŸå§‹æ¶ˆæ¯åˆ—è¡¨
            
        Returns:
            å‹ç¼©åçš„æ¶ˆæ¯åˆ—è¡¨
        """</span>
        <span class="hljs-comment"># æ ¸å¿ƒé€»è¾‘å°±è¿™ä¸€è¡Œï¼</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(messages) &lt;= self.keep_messages:
            <span class="hljs-keyword">return</span> messages
        
        <span class="hljs-keyword">return</span> messages[-self.keep_messages:]
</code></pre>
<p><strong>å°±è¿™ä¹ˆç®€å•ï¼</strong> æ ¸å¿ƒä»£ç åªæœ‰ä¸€è¡Œï¼š<code>messages[-self.keep_messages:]</code></p>
<h4 data-id="heading-35"><strong>çœŸå®æ€§èƒ½æµ‹è¯•</strong></h4>
<p>æˆ‘ä»¬å¯¹æ»‘åŠ¨çª—å£è¿›è¡Œäº†5é¡¹å®Œæ•´æµ‹è¯•ï¼Œä»¥ä¸‹æ˜¯çœŸå®æ•°æ®ï¼š</p>
<hr/>
<p><strong>æµ‹è¯•1ï¼šå‹ç¼©ç‡æµ‹è¯•</strong></p>
<p>çª—å£å¤§å°è®¾ç½®ä¸º5è½®ï¼Œæµ‹è¯•ä¸åŒé•¿åº¦çš„å¯¹è¯ï¼š</p>



































<table><thead><tr><th>å¯¹è¯é•¿åº¦</th><th>åŸå§‹</th><th>å‹ç¼©å</th><th>Tokenå‹ç¼©ç‡</th></tr></thead><tbody><tr><td>5è½®ï¼ˆçŸ­å¯¹è¯ï¼‰</td><td>10æ¡ / 126 tokens</td><td>10æ¡ / 126 tokens</td><td><strong>0%</strong></td></tr><tr><td>10è½®ï¼ˆä¸­ç­‰ï¼‰</td><td>20æ¡ / 249 tokens</td><td>10æ¡ / 123 tokens</td><td><strong>50.6%</strong></td></tr><tr><td>20è½®ï¼ˆé•¿å¯¹è¯ï¼‰</td><td>42æ¡ / 560 tokens</td><td>10æ¡ / 145 tokens</td><td><strong>74.1%</strong></td></tr><tr><td>30è½®ï¼ˆè¶…é•¿ï¼‰</td><td>68æ¡ / 933 tokens</td><td>10æ¡ / 144 tokens</td><td><strong>84.6%</strong></td></tr></tbody></table>
<p><strong>å…³é”®å‘ç°ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">å‹ç¼©ç‡éšå¯¹è¯é•¿åº¦å¢åŠ ï¼š
<span class="hljs-deletion">- 5è½®: 0% (ä¸å‹ç¼©)</span>
<span class="hljs-deletion">- 10è½®: 50% (å‹ç¼©ä¸€åŠ)</span>
<span class="hljs-deletion">- 20è½®: 74% (å‹ç¼©3/4)</span>
<span class="hljs-deletion">- 30è½®: 85% (å‹ç¼©85%)</span>

ç»“è®ºï¼šå¯¹è¯è¶Šé•¿ï¼Œæ»‘åŠ¨çª—å£è¶Šæœ‰æ•ˆ âœ…
</code></pre>
<hr/>
<p><strong>æµ‹è¯•2ï¼šé€Ÿåº¦æµ‹è¯•</strong></p>
<p>æµ‹è¯•10ä¸‡æ¬¡å‹ç¼©æ“ä½œçš„è€—æ—¶ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">æ“ä½œæ¬¡æ•°: 100,000æ¬¡
æ€»è€—æ—¶: 13.63ms
å¹³å‡æ¯æ¬¡: 0.14å¾®ç§’ âš¡

ç›´è§‚å¯¹æ¯”ï¼š
<span class="hljs-deletion">- äººçœ¨çœ¼ä¸€æ¬¡: 100,000å¾®ç§’</span>
<span class="hljs-deletion">- åœ¨çœ¨çœ¼æ—¶é—´å†…ï¼Œæ»‘åŠ¨çª—å£å¯ä»¥æ‰§è¡Œ 714,285æ¬¡</span>
<span class="hljs-deletion">- ä¸€æ¬¡HTTPè¯·æ±‚(50ms)å†…ï¼Œå¯ä»¥æ‰§è¡Œ 357,142æ¬¡</span>
</code></pre>
<p><strong>ç»“è®ºï¼šé€Ÿåº¦å¿«åˆ°å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</strong></p>
<hr/>
<p><strong>æµ‹è¯•3ï¼šä¿¡æ¯ä¸¢å¤±åˆ†æï¼ˆå…³é”®æµ‹è¯•ï¼ï¼‰</strong></p>
<p>æ„é€ ä¸€ä¸ªåŒ…å«é‡è¦ç”¨æˆ·ä¿¡æ¯çš„8è½®å¯¹è¯ï¼Œä½¿ç”¨5è½®çª—å£å‹ç¼©ï¼š</p>
<pre><code class="hljs language-python" lang="python">åŸå§‹å¯¹è¯ï¼ˆ<span class="hljs-number">8</span>è½®ï¼Œ<span class="hljs-number">16</span>æ¡æ¶ˆæ¯ï¼‰:
  è½®<span class="hljs-number">1</span> ç”¨æˆ·: <span class="hljs-string">"æˆ‘å«Tomï¼Œä»Šå¹´28å²"</span>          â† é‡è¦ï¼
      åŠ©æ‰‹: <span class="hljs-string">"ä½ å¥½Tomï¼"</span>
  è½®<span class="hljs-number">2</span> ç”¨æˆ·: <span class="hljs-string">"æˆ‘åœ¨ä¸Šæµ·æµ¦ä¸œå·¥ä½œ"</span>           â† é‡è¦ï¼
      åŠ©æ‰‹: <span class="hljs-string">"æµ¦ä¸œæ˜¯é‡‘èä¸­å¿ƒ"</span>
  è½®<span class="hljs-number">3</span> ç”¨æˆ·: <span class="hljs-string">"æˆ‘æ˜¯AIå·¥ç¨‹å¸ˆ"</span>               â† é‡è¦ï¼
      åŠ©æ‰‹: <span class="hljs-string">"å¾ˆæœ‰å‰æ™¯çš„èŒä¸š"</span>
  è½®<span class="hljs-number">4</span> ç”¨æˆ·: <span class="hljs-string">"æˆ‘åœ¨ç ”ç©¶AgentæŠ€æœ¯"</span>          â† é‡è¦ï¼
      åŠ©æ‰‹: <span class="hljs-string">"Agentå¾ˆå‰æ²¿"</span>
  è½®<span class="hljs-number">5</span> ç”¨æˆ·: <span class="hljs-string">"å—¯"</span>                         â† æ— ç”¨
      åŠ©æ‰‹: <span class="hljs-string">"è¿˜æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ"</span>
  è½®<span class="hljs-number">6</span> ç”¨æˆ·: <span class="hljs-string">"å¥½çš„"</span>                       â† æ— ç”¨
      åŠ©æ‰‹: <span class="hljs-string">"éšæ—¶é—®æˆ‘"</span>
  è½®<span class="hljs-number">7</span> ç”¨æˆ·: <span class="hljs-string">"è°¢è°¢"</span>                       â† æ— ç”¨
      åŠ©æ‰‹: <span class="hljs-string">"ä¸å®¢æ°”"</span>
  è½®<span class="hljs-number">8</span> ç”¨æˆ·: <span class="hljs-string">"é‚£æˆ‘ç ”ç©¶ä¸€ä¸‹"</span>
      åŠ©æ‰‹: <span class="hljs-string">"å¥½çš„ï¼ŒåŠ æ²¹"</span>

å‹ç¼©åï¼ˆä¿ç•™<span class="hljs-number">5</span>è½® = <span class="hljs-number">10</span>æ¡æ¶ˆæ¯ï¼‰:
  âœ… è½®<span class="hljs-number">4</span>: <span class="hljs-string">"æˆ‘åœ¨ç ”ç©¶AgentæŠ€æœ¯"</span>
  âœ… è½®<span class="hljs-number">5</span>: <span class="hljs-string">"å—¯"</span>
  âœ… è½®<span class="hljs-number">6</span>: <span class="hljs-string">"å¥½çš„"</span>
  âœ… è½®<span class="hljs-number">7</span>: <span class="hljs-string">"è°¢è°¢"</span>
  âœ… è½®<span class="hljs-number">8</span>: <span class="hljs-string">"é‚£æˆ‘ç ”ç©¶ä¸€ä¸‹"</span>

è¢«ä¸¢å¼ƒçš„å†…å®¹ï¼ˆå‰<span class="hljs-number">3</span>è½® = <span class="hljs-number">6</span>æ¡æ¶ˆæ¯ï¼‰:
  âŒ <span class="hljs-string">"æˆ‘å«Tomï¼Œä»Šå¹´28å²"</span>        âš ï¸ é‡è¦ä¿¡æ¯ï¼
  âŒ <span class="hljs-string">"ä½ å¥½Tomï¼"</span>                 âš ï¸ åŒ…å«å§“å
  âŒ <span class="hljs-string">"æˆ‘åœ¨ä¸Šæµ·æµ¦ä¸œå·¥ä½œ"</span>          âš ï¸ é‡è¦ä¿¡æ¯ï¼
  âŒ <span class="hljs-string">"æµ¦ä¸œæ˜¯é‡‘èä¸­å¿ƒ"</span>
  âŒ <span class="hljs-string">"æˆ‘æ˜¯AIå·¥ç¨‹å¸ˆ"</span>             âš ï¸ é‡è¦ä¿¡æ¯ï¼
  âŒ <span class="hljs-string">"å¾ˆæœ‰å‰æ™¯çš„èŒä¸š"</span>
</code></pre>
<p><strong>é—®é¢˜ä¸€ç›®äº†ç„¶ï¼š</strong></p>
<ul>
<li>æ‰€æœ‰ç”¨æˆ·èƒŒæ™¯ä¿¡æ¯ï¼ˆå§“åã€åœ°ç‚¹ã€èŒä¸šï¼‰å…¨éƒ¨ä¸¢å¤±</li>
<li>ä¿ç•™çš„å´æ˜¯"å—¯"ã€"å¥½çš„"ã€"è°¢è°¢"è¿™äº›æ— æ„ä¹‰å†…å®¹</li>
</ul>
<p><strong>è¿™å°±æ˜¯æ»‘åŠ¨çª—å£çš„è‡´å‘½ç¼ºé™·ï¼</strong> å®ƒä¸ä¼šæ€è€ƒä»€ä¹ˆé‡è¦ï¼Œåªä¼šæœºæ¢°åœ°æŒ‰æ—¶é—´åˆ é™¤ã€‚</p>
<hr/>
<p><strong>æµ‹è¯•4ï¼šçœŸå®Chatbotåœºæ™¯</strong></p>
<p>æ¨¡æ‹Ÿä¸€ä¸ª15è½®è¿ç»­å¯¹è¯ï¼Œè§‚å¯Ÿå…³é”®ä¿¡æ¯çš„ä¸¢å¤±è¿‡ç¨‹ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile">åˆå§‹å…³é”®ä¿¡æ¯ï¼š
- å§“å: <span class="hljs-string">"Tom"</span>
- åœ°ç‚¹: <span class="hljs-string">"ä¸Šæµ·"</span>
- èŒä¸š: <span class="hljs-string">"AIå·¥ç¨‹å¸ˆ"</span>
- ç ”ç©¶æ–¹å‘: <span class="hljs-string">"Agent"</span>

<span class="hljs-section">ç¬¬5è½®å:</span>
  è®°å¿†: 10æ¡æ¶ˆæ¯ï¼ˆ5è½®ï¼‰
  å‹ç¼©: 10æ¡ â†’ 10æ¡ï¼ˆæœªè¶…è¿‡é™åˆ¶ï¼‰
  å…³é”®è¯: âœ… Tomã€ä¸Šæµ·ã€AIå·¥ç¨‹å¸ˆã€Agent å…¨éƒ¨ä¿ç•™

<span class="hljs-section">ç¬¬10è½®å:</span>
  è®°å¿†: 20æ¡æ¶ˆæ¯ï¼ˆ10è½®ï¼‰
  å‹ç¼©: 20æ¡ â†’ 10æ¡ï¼ˆåˆ é™¤å‰5è½®ï¼‰
  å…³é”®è¯: âŒ Tomã€ä¸Šæµ·ã€AIå·¥ç¨‹å¸ˆã€Agent å…¨éƒ¨ä¸¢å¤±

<span class="hljs-section">ç¬¬15è½®å:</span>
  è®°å¿†: 20æ¡æ¶ˆæ¯ï¼ˆ10è½®ï¼Œå› ä¸ºçŸ­æœŸè®°å¿†é™åˆ¶ï¼‰
  å‹ç¼©: 20æ¡ â†’ 10æ¡
  å…³é”®è¯: âŒ ä»ç„¶å…¨éƒ¨ä¸¢å¤±
</code></pre>
<p><strong>ç»“è®ºï¼šè¶…è¿‡10è½®åï¼Œæ—©æœŸçš„æ‰€æœ‰å…³é”®ä¿¡æ¯æ°¸ä¹…ä¸¢å¤±ã€‚</strong></p>
<hr/>
<p><strong>æµ‹è¯•5ï¼šä¸åŒçª—å£å¤§å°çš„æƒè¡¡</strong></p>
<p>åœ¨åŒä¸€ä¸ª20è½®å¯¹è¯ï¼ˆ560 tokensï¼‰ä¸­æµ‹è¯•ä¸åŒçª—å£å¤§å°ï¼š</p>









































<table><thead><tr><th>çª—å£å¤§å°</th><th>ä¿ç•™æ¶ˆæ¯</th><th>å‹ç¼©åTokens</th><th>Tokenå‹ç¼©ç‡</th></tr></thead><tbody><tr><td>3è½®</td><td>6æ¡</td><td>86</td><td><strong>84.6%</strong> â­</td></tr><tr><td>5è½®</td><td>10æ¡</td><td>145</td><td><strong>74.1%</strong></td></tr><tr><td>8è½®</td><td>16æ¡</td><td>227</td><td><strong>59.5%</strong></td></tr><tr><td>10è½®</td><td>20æ¡</td><td>287</td><td><strong>48.8%</strong></td></tr><tr><td>15è½®</td><td>30æ¡</td><td>408</td><td><strong>27.1%</strong></td></tr></tbody></table>
<p><strong>æƒè¡¡åˆ†æï¼š</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">çª—å£å¤ªå°ï¼ˆ3è½®ï¼‰:</span>
âœ… å‹ç¼©ç‡é«˜ï¼ˆ85%ï¼‰
âŒ ä¿¡æ¯ä¸¢å¤±ä¸¥é‡
âŒ å¯¹è¯è¿è´¯æ€§å·®

<span class="hljs-section">çª—å£é€‚ä¸­ï¼ˆ5-8è½®ï¼‰:</span>
âœ… å‹ç¼©ç‡å¥½ï¼ˆ60-75%ï¼‰
âš ï¸ ä¿¡æ¯ä¸¢å¤±ä¸­ç­‰
âœ… å¯¹è¯åŸºæœ¬è¿è´¯

<span class="hljs-section">çª—å£å¤ªå¤§ï¼ˆ15è½®ï¼‰:</span>
âŒ å‹ç¼©ç‡ä½ï¼ˆ27%ï¼‰
âœ… ä¿¡æ¯ä¿ç•™å¥½
âœ… å¯¹è¯è¿è´¯
</code></pre>
<p><strong>æ¨èè®¾ç½®ï¼š</strong></p>
<ul>
<li>çŸ­å¯¹è¯åœºæ™¯ï¼š3-5è½®</li>
<li>ä¸€èˆ¬åœºæ™¯ï¼š5-8è½®</li>
<li>é‡è¦å¯¹è¯ï¼š10-15è½®</li>
</ul>
<p>å®Œæ•´æµ‹è¯•ä»£ç ï¼š[GitHub - tests/test_sliding_window.py]</p>
<hr/>
<h4 data-id="heading-36"><strong>ä¼˜ç¼ºç‚¹æ€»ç»“</strong></h4>
<p>åŸºäºçœŸå®æµ‹è¯•æ•°æ®ï¼Œæˆ‘ä»¬å¾—å‡ºï¼š</p>
<p><strong>âœ… ä¸‰å¤§ä¼˜åŠ¿ï¼š</strong></p>
<ol>
<li><strong>é€Ÿåº¦æå¿«</strong>
<ul>
<li>0.14å¾®ç§’/æ¬¡ï¼ˆæµ‹è¯•æ•°æ®ï¼‰</li>
<li>æ¯”ç½‘ç»œè¯·æ±‚å¿«35ä¸‡å€</li>
<li>å®Œå…¨ä¸å½±å“å“åº”æ—¶é—´</li>
</ul>
</li>
<li><strong>é›¶æˆæœ¬</strong>
<ul>
<li>æ— éœ€è°ƒç”¨LLM API</li>
<li>æ— é¢å¤–tokenæ¶ˆè€—</li>
<li>æ—¥æ´»ç™¾ä¸‡ä¹Ÿä¸å¢åŠ æˆæœ¬</li>
</ul>
</li>
<li><strong>å‹ç¼©æ•ˆæœéšå¯¹è¯å¢é•¿</strong>
<ul>
<li>10è½®ï¼š50%</li>
<li>20è½®ï¼š74%</li>
<li>30è½®ï¼š85%</li>
<li>å¯¹è¯è¶Šé•¿è¶Šåˆ’ç®—</li>
</ul>
</li>
</ol>
<p><strong>âŒ ä¸¤å¤§ç¼ºé™·ï¼š</strong></p>
<ol>
<li><strong>ä¸¥é‡çš„ä¿¡æ¯ä¸¢å¤±</strong>ï¼ˆå®æµ‹è¯æ˜ï¼‰
<ul>
<li>æ‰€æœ‰ç”¨æˆ·èƒŒæ™¯ä¿¡æ¯åœ¨10è½®åä¸¢å¤±</li>
<li>ä¸åŒºåˆ†"Tom"å’Œ"å—¯"çš„é‡è¦æ€§</li>
<li>ä¿ç•™æ— ç”¨å†…å®¹ï¼Œä¸¢å¼ƒå…³é”®ä¿¡æ¯</li>
</ul>
</li>
<li><strong>çŸ­å¯¹è¯æ— æ•ˆ</strong>
<ul>
<li>5è½®å†…å‹ç¼©ç‡0%</li>
<li>æµªè´¹ä¼˜åŒ–æœºä¼š</li>
</ul>
</li>
</ol>
<hr/>
<h4 data-id="heading-37"><strong>é€‚ç”¨åœºæ™¯æŒ‡å—</strong></h4>
<p>åŸºäºæµ‹è¯•æ•°æ®ï¼Œæˆ‘ä»¬æ€»ç»“ï¼š</p>
<p><strong>âœ… é€‚åˆä½¿ç”¨ï¼š</strong></p>
<ol>
<li><strong>çŸ­æ—¶å¯¹è¯ï¼ˆâ‰¤10è½®ï¼‰</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">åœºæ™¯ï¼šå®¢æœå¿«é€Ÿå’¨è¯¢ã€FAQé—®ç­”
ç†ç”±ï¼š
<span class="hljs-deletion">- å®æµ‹ï¼š10è½®å†…å‹ç¼©ç‡50%</span>
<span class="hljs-deletion">- å…³é”®ä¿¡æ¯ä¸¢å¤±é£é™©ä½</span>
<span class="hljs-deletion">- é€Ÿåº¦ä¼˜åŠ¿æ˜æ˜¾</span>
</code></pre>
<ol>
<li><strong>å®æ—¶æ€§è¦æ±‚é«˜</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">åœºæ™¯ï¼šå³æ—¶èŠå¤©ã€æ¸¸æˆNPCå¯¹è¯
ç†ç”±ï¼š
<span class="hljs-deletion">- å®æµ‹ï¼š0.14å¾®ç§’ï¼Œé›¶å»¶è¿Ÿ</span>
<span class="hljs-deletion">- ç”¨æˆ·æ„ŸçŸ¥ä¸åˆ°å‹ç¼©è¿‡ç¨‹</span>
</code></pre>
<ol>
<li><strong>æˆæœ¬æ•æ„Ÿ</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">åœºæ™¯ï¼šå¤§è§„æ¨¡å…è´¹äº§å“
ç†ç”±ï¼š
<span class="hljs-deletion">- é›¶æˆæœ¬</span>
<span class="hljs-deletion">- æ—¥æ´»ç™¾ä¸‡ä¹Ÿä¸å¢åŠ è´¹ç”¨</span>
</code></pre>
<ol>
<li><strong>ç®€å•äº¤äº’</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">åœºæ™¯ï¼šæŸ¥è¯¢ç±»ã€å·¥å…·ç±»å¯¹è¯
ç†ç”±ï¼š
<span class="hljs-deletion">- ä¸éœ€è¦è®°ä½ç”¨æˆ·èƒŒæ™¯</span>
<span class="hljs-deletion">- æ¯æ¬¡å¯¹è¯ç›¸å¯¹ç‹¬ç«‹</span>
</code></pre>
<p><strong>âŒ ä¸é€‚åˆï¼š</strong></p>
<ol>
<li><strong>é•¿æ—¶é—´å¯¹è¯ï¼ˆ&gt;10è½®ï¼‰</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">åœºæ™¯ï¼šæŠ€æœ¯æ”¯æŒã€æ·±åº¦å’¨è¯¢
é—®é¢˜ï¼š
<span class="hljs-deletion">- å®æµ‹ï¼š10è½®åä¸¢å¤±æ‰€æœ‰æ—©æœŸä¿¡æ¯</span>
<span class="hljs-deletion">- ç”¨æˆ·ä½“éªŒå·®ï¼ˆAIä¸è®°å¾—è¯´è¿‡ä»€ä¹ˆï¼‰</span>
</code></pre>
<ol>
<li><strong>ä¸ªæ€§åŒ–è¦æ±‚é«˜</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">åœºæ™¯ï¼šä¸ªäººåŠ©ç†ã€æ•™è‚²è¾…å¯¼
é—®é¢˜ï¼š
<span class="hljs-deletion">- ç”¨æˆ·ä¿¡æ¯åœ¨å¼€å¤´ï¼ˆä¼šè¢«åˆ é™¤ï¼‰</span>
<span class="hljs-deletion">- æ— æ³•ä¿æŒä¸ªæ€§åŒ–ä½“éªŒ</span>
</code></pre>
<ol>
<li><strong>ä¿¡æ¯å¯†é›†å‹</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">åœºæ™¯ï¼šé¡¹ç›®è®¨è®ºã€å†³ç­–åˆ†æ
é—®é¢˜ï¼š
<span class="hljs-deletion">- æ¯è½®éƒ½å¯èƒ½æœ‰å…³é”®ä¿¡æ¯</span>
<span class="hljs-deletion">- ä¸èƒ½éšæ„ä¸¢å¼ƒä»»ä½•å†…å®¹</span>
</code></pre>
<hr/>
<h4 data-id="heading-38"><strong>æœ€ä½³å®è·µ</strong></h4>
<p>åŸºäºæµ‹è¯•ç»“æœï¼Œç»™å‡ºå®ç”¨å»ºè®®ï¼š</p>
<p><strong>1. æ ¹æ®åœºæ™¯è®¾ç½®çª—å£å¤§å°</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¿«é€Ÿå’¨è¯¢</span>
compressor = SlidingWindowCompressor(keep_turns=<span class="hljs-number">3</span>)  <span class="hljs-comment"># å‹ç¼©ç‡85%</span>

<span class="hljs-comment"># ä¸€èˆ¬å¯¹è¯</span>
compressor = SlidingWindowCompressor(keep_turns=<span class="hljs-number">5</span>)  <span class="hljs-comment"># å‹ç¼©ç‡74%</span>

<span class="hljs-comment"># é‡è¦å¯¹è¯</span>
compressor = SlidingWindowCompressor(keep_turns=<span class="hljs-number">10</span>) <span class="hljs-comment"># å‹ç¼©ç‡49%</span>
</code></pre>
<p><strong>2. ç›‘æ§ä¿¡æ¯ä¸¢å¤±</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SlidingWindowCompressor</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages</span>):
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(messages) &gt; self.keep_messages:
            dropped = messages[:-self.keep_messages]
            
            <span class="hljs-comment"># æ£€æŸ¥ä¸¢å¼ƒçš„æ¶ˆæ¯ä¸­æ˜¯å¦æœ‰é‡è¦å®ä½“</span>
            <span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> dropped:
                <span class="hljs-keyword">if</span> self._contains_important_entity(msg):
                    logger.warning(<span class="hljs-string">f"ä¸¢å¼ƒäº†é‡è¦ä¿¡æ¯: <span class="hljs-subst">{msg[<span class="hljs-string">'content'</span>][:<span class="hljs-number">50</span>]}</span>"</span>)
        
        <span class="hljs-keyword">return</span> messages[-self.keep_messages:]
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_contains_important_entity</span>(<span class="hljs-params">self, msg</span>):
        <span class="hljs-string">"""æ£€æµ‹æ˜¯å¦åŒ…å«é‡è¦å®ä½“ï¼ˆäººåã€åœ°åç­‰ï¼‰"""</span>
        <span class="hljs-comment"># ç®€å•å®ç°ï¼šæ£€æŸ¥æ˜¯å¦åŒ…å«ç‰¹å®šå…³é”®è¯</span>
        keywords = [<span class="hljs-string">'å«'</span>, <span class="hljs-string">'åœ¨'</span>, <span class="hljs-string">'æ˜¯'</span>, <span class="hljs-string">'åš'</span>, <span class="hljs-string">'ç ”ç©¶'</span>]
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">any</span>(kw <span class="hljs-keyword">in</span> msg[<span class="hljs-string">'content'</span>] <span class="hljs-keyword">for</span> kw <span class="hljs-keyword">in</span> keywords)
</code></pre>
<p><strong>3. ä¸å…¶ä»–ç­–ç•¥ç»“åˆ</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç­–ç•¥1ï¼šæ»‘åŠ¨çª—å£ + ç”¨æˆ·ç”»åƒ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">EnhancedChatbot</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.compressor = SlidingWindowCompressor(keep_turns=<span class="hljs-number">5</span>)
        self.user_profile = {}  <span class="hljs-comment"># æ°¸ä¹…ä¿å­˜ï¼šå§“åã€åå¥½ç­‰</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">chat</span>(<span class="hljs-params">self, user_input</span>):
        <span class="hljs-comment"># æå–ç”¨æˆ·ä¿¡æ¯ï¼ˆå¦‚å§“åã€åœ°ç‚¹ï¼‰</span>
        self._extract_user_info(user_input)
        
        <span class="hljs-comment"># å‹ç¼©å¯¹è¯å†å²</span>
        compressed_history = self.compressor.compress(self.memory)
        
        <span class="hljs-comment"># æ„å»ºä¸Šä¸‹æ–‡ï¼šç”¨æˆ·ç”»åƒ + å‹ç¼©å†å²</span>
        context = [
            {<span class="hljs-string">"role"</span>: <span class="hljs-string">"system"</span>, <span class="hljs-string">"content"</span>: <span class="hljs-string">f"ç”¨æˆ·ä¿¡æ¯: <span class="hljs-subst">{self.user_profile}</span>"</span>}
        ] + compressed_history
        
        <span class="hljs-keyword">return</span> self.llm.chat(context)
</code></pre>
<hr/>
<h4 data-id="heading-39"><strong>å°ç»“</strong></h4>
<p>æ»‘åŠ¨çª—å£å‹ç¼©å™¨çš„ç‰¹ç‚¹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ä¸‰ä¸ª<span class="hljs-string">"æœ€"</span>ï¼š
âœ… æœ€ç®€å•ï¼ˆ3è¡Œä»£ç ï¼‰
âœ… æœ€å¿«ï¼ˆ0.14å¾®ç§’ï¼‰
âœ… æœ€ä¾¿å®œï¼ˆ<span class="hljs-variable">$0</span>ï¼‰

ä¸€ä¸ª<span class="hljs-string">"å‘"</span>ï¼š
âŒ æœºæ¢°åˆ é™¤ï¼Œä¸¢å¤±é‡è¦ä¿¡æ¯

æœ€ä½³å®šä½ï¼š
é€‚åˆçŸ­å¯¹è¯ã€å®æ—¶åœºæ™¯ã€æˆæœ¬æ•æ„Ÿåœºæ™¯
</code></pre>
<p><strong>ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ</strong></p>
<ul>
<li>å¯¹è¯â‰¤10è½®</li>
<li>è¦æ±‚æè‡´é€Ÿåº¦</li>
<li>é¢„ç®—ä¸ºé›¶</li>
</ul>
<p><strong>ä»€ä¹ˆæ—¶å€™ä¸ç”¨ï¼Ÿ</strong></p>
<ul>
<li>å¯¹è¯&gt;10è½®</li>
<li>éœ€è¦è®°ä½ç”¨æˆ·èƒŒæ™¯</li>
<li>ä¿¡æ¯å¾ˆé‡è¦</li>
</ul>
<p>åœ¨ä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å®Œå…¨ç›¸åçš„ç­–ç•¥ï¼š<strong>LLMæ‘˜è¦</strong> - æ…¢ä½†æ™ºèƒ½ï¼Œèƒ½å¤Ÿè§£å†³ä¿¡æ¯ä¸¢å¤±é—®é¢˜ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed55d5b080724c7ab6fd8ca106afc4ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQWdlbnRCdWlsZGVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765471478&amp;x-signature=bnNzoS8w%2Bn%2BfIkbNygFZPN%2BZGcY%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<hr/>
<h3 data-id="heading-40"><strong>3.3 ç­–ç•¥2ï¼šLLMæ‘˜è¦ï¼ˆLLM Summaryï¼‰</strong></h3>
<h4 data-id="heading-41"><strong>æ ¸å¿ƒåŸç†</strong></h4>
<p>LLMæ‘˜è¦æ˜¯ä¸€ç§<strong>æ™ºèƒ½å‹ç¼©</strong>ç­–ç•¥ï¼šç”¨å¤§è¯­è¨€æ¨¡å‹ç†è§£å¯¹è¯å†å²ï¼Œæå–å…³é”®ä¿¡æ¯ç”Ÿæˆæ‘˜è¦ï¼Œä¿ç•™æœ€è¿‘å‡ è½®å®Œæ•´å¯¹è¯ã€‚</p>
<pre><code class="hljs">åŸå§‹å¯¹è¯ï¼ˆ10è½®ï¼Œ20æ¡æ¶ˆæ¯ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ 1  â”‚ 2  â”‚ 3  â”‚ 4  â”‚ 5  â”‚ 6  â”‚ 7  â”‚ 8  â”‚ 9  â”‚ 10 â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
  â†“                                    â†“
  å†å²éƒ¨åˆ†ï¼ˆ1-7è½®ï¼‰              æœ€è¿‘éƒ¨åˆ†ï¼ˆ8-10è½®ï¼‰
  â†“                                    â†“
  LLMæ™ºèƒ½æ‘˜è¦                       å®Œæ•´ä¿ç•™
  â†“                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ ğŸ“ æ‘˜è¦ï¼šç”¨æˆ·Tomï¼Œ     â”‚  +   â”‚ 8  â”‚ 9  â”‚ 10 â”‚
â”‚ ä¸Šæµ·AIå·¥ç¨‹å¸ˆ...        â”‚      â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong></p>
<ul>
<li>è¿œæœŸå¯¹è¯ï¼ˆç¬¬1-7è½®ï¼‰â†’ ç”¨LLMç”Ÿæˆæ‘˜è¦</li>
<li>è¿‘æœŸå¯¹è¯ï¼ˆç¬¬8-10è½®ï¼‰â†’ å®Œæ•´ä¿ç•™</li>
<li>æ‘˜è¦ + å®Œæ•´å¯¹è¯ = å‹ç¼©åçš„ä¸Šä¸‹æ–‡</li>
</ul>
<p>ä¸æ»‘åŠ¨çª—å£çš„æœ¬è´¨åŒºåˆ«ï¼š</p>
<ul>
<li>æ»‘åŠ¨çª—å£ï¼š<strong>æœºæ¢°åˆ é™¤</strong>ï¼Œä¸ç®¡å†…å®¹é‡è¦æ€§</li>
<li>LLMæ‘˜è¦ï¼š<strong>æ™ºèƒ½æå–</strong>ï¼Œä¿ç•™å…³é”®ä¿¡æ¯</li>
</ul>
<h4 data-id="heading-42"><strong>Promptå·¥ç¨‹ï¼ˆå…³é”®ï¼ï¼‰</strong></h4>
<p>LLMæ‘˜è¦çš„æ•ˆæœé«˜åº¦ä¾èµ–Promptçš„è´¨é‡ã€‚ä»¥ä¸‹æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„Promptï¼š</p>
<pre><code class="hljs language-python" lang="python">SUMMARY_PROMPT = <span class="hljs-string">"""è¯·æ€»ç»“ä»¥ä¸‹å¯¹è¯å†å²ï¼Œæå–å…³é”®ä¿¡æ¯ï¼š

å¯¹è¯å†…å®¹ï¼š
{conversation}

è¯·æŒ‰ä»¥ä¸‹æ ¼å¼è¾“å‡ºæ‘˜è¦ï¼ˆ150å­—ä»¥å†…ï¼‰ï¼š

ğŸ“ å¯¹è¯å†å²æ‘˜è¦ï¼š
1. **ç”¨æˆ·åŸºæœ¬ä¿¡æ¯**ï¼šå§“åã€å¹´é¾„ã€åœ°ç‚¹ã€èŒä¸šç­‰
2. **ç”¨æˆ·åå¥½ä¸å…´è¶£**ï¼šæåˆ°çš„å…´è¶£ã€åå¥½
3. **è®¨è®ºä¸»è¦è¯é¢˜**ï¼šèŠäº†ä»€ä¹ˆ
4. **é‡è¦å†³å®šæˆ–ç»“è®º**ï¼šåšäº†ä»€ä¹ˆå†³å®š
5. **å…³é”®ç»†èŠ‚**ï¼šå…¶ä»–é‡è¦ä¿¡æ¯

è¦æ±‚ï¼š
- ç®€æ´æ˜äº†ï¼Œä¸è¶…è¿‡150å­—
- åªä¿ç•™å…³é”®ä¿¡æ¯ï¼Œåˆ é™¤å¯’æš„
- ä½¿ç”¨ç»“æ„åŒ–æ ¼å¼
"""</span>
</code></pre>
<p><strong>Promptè®¾è®¡çš„å…³é”®ç‚¹ï¼š</strong></p>
<ol>
<li>âœ… æ˜ç¡®è¾“å‡ºæ ¼å¼ï¼ˆç»“æ„åŒ–ï¼‰</li>
<li>âœ… æŒ‡å®šæå–ç»´åº¦ï¼ˆå§“åã€åœ°ç‚¹ã€è¯é¢˜ç­‰ï¼‰</li>
<li>âœ… é™åˆ¶é•¿åº¦ï¼ˆ150å­—ï¼‰</li>
<li>âœ… å¼ºè°ƒå…³é”®ä¿¡æ¯ä¼˜å…ˆ</li>
</ol>
<h4 data-id="heading-43"><strong>ä»£ç å®ç°</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>
<span class="hljs-keyword">from</span> src.llm.base <span class="hljs-keyword">import</span> BaseLLM


<span class="hljs-keyword">class</span> <span class="hljs-title class_">LLMSummaryCompressor</span>:
    <span class="hljs-string">"""
    LLMæ‘˜è¦å‹ç¼©å™¨
    
    ç‰¹ç‚¹ï¼š
    - æ™ºèƒ½æå–å…³é”®ä¿¡æ¯
    - ä¿ç•™è¯­ä¹‰å®Œæ•´æ€§
    - é€‚åˆé•¿å¯¹è¯åœºæ™¯
    """</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, llm: BaseLLM, keep_recent_turns: <span class="hljs-built_in">int</span> = <span class="hljs-number">3</span></span>):
        <span class="hljs-string">"""
        Args:
            llm: LLMå®ä¾‹
            keep_recent_turns: ä¿ç•™æœ€è¿‘å‡ è½®å®Œæ•´å¯¹è¯
        """</span>
        self.llm = llm
        self.keep_recent_turns = keep_recent_turns
        self.keep_recent_messages = keep_recent_turns * <span class="hljs-number">2</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages: <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]]</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]]:
        <span class="hljs-string">"""
        å‹ç¼©æ¶ˆæ¯åˆ—è¡¨
        
        Args:
            messages: åŸå§‹æ¶ˆæ¯åˆ—è¡¨
            
        Returns:
            å‹ç¼©åçš„æ¶ˆæ¯åˆ—è¡¨
        """</span>
        <span class="hljs-comment"># å¦‚æœæ¶ˆæ¯ä¸å¤Ÿå¤šï¼Œä¸å‹ç¼©</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(messages) &lt;= self.keep_recent_messages:
            <span class="hljs-keyword">return</span> messages
        
        <span class="hljs-comment"># åˆ†å‰²ï¼šå†å²éƒ¨åˆ† vs æœ€è¿‘éƒ¨åˆ†</span>
        history = messages[:-self.keep_recent_messages]
        recent = messages[-self.keep_recent_messages:]
        
        <span class="hljs-comment"># ç”Ÿæˆå†å²æ‘˜è¦</span>
        summary = self._summarize(history)
        
        <span class="hljs-comment"># æ„å»ºå‹ç¼©ç»“æœï¼šæ‘˜è¦ + æœ€è¿‘å¯¹è¯</span>
        compressed = [
            {<span class="hljs-string">"role"</span>: <span class="hljs-string">"system"</span>, <span class="hljs-string">"content"</span>: summary}
        ]
        compressed.extend(recent)
        
        <span class="hljs-keyword">return</span> compressed
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_summarize</span>(<span class="hljs-params">self, messages: <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]]</span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""
        ç”¨LLMç”Ÿæˆå¯¹è¯æ‘˜è¦
        
        Args:
            messages: éœ€è¦æ‘˜è¦çš„æ¶ˆæ¯åˆ—è¡¨
            
        Returns:
            æ‘˜è¦æ–‡æœ¬
        """</span>
        <span class="hljs-comment"># æ ¼å¼åŒ–å¯¹è¯å†…å®¹</span>
        conversation_text = <span class="hljs-string">"\n"</span>.join([
            <span class="hljs-string">f"<span class="hljs-subst">{<span class="hljs-string">'ç”¨æˆ·'</span> <span class="hljs-keyword">if</span> m[<span class="hljs-string">'role'</span>] == <span class="hljs-string">'user'</span> <span class="hljs-keyword">else</span> <span class="hljs-string">'åŠ©æ‰‹'</span>}</span>: <span class="hljs-subst">{m[<span class="hljs-string">'content'</span>]}</span>"</span>
            <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> messages
        ])
        
        <span class="hljs-comment"># æ„å»ºPrompt</span>
        prompt = <span class="hljs-string">f"""è¯·æ€»ç»“ä»¥ä¸‹å¯¹è¯å†å²ï¼Œæå–å…³é”®ä¿¡æ¯ï¼š

å¯¹è¯å†…å®¹ï¼š
<span class="hljs-subst">{conversation_text}</span>

è¯·æŒ‰ä»¥ä¸‹æ ¼å¼è¾“å‡ºæ‘˜è¦ï¼ˆ150å­—ä»¥å†…ï¼‰ï¼š

ğŸ“ å¯¹è¯å†å²æ‘˜è¦ï¼š
1. **ç”¨æˆ·åŸºæœ¬ä¿¡æ¯**ï¼šå§“åã€å¹´é¾„ã€åœ°ç‚¹ã€èŒä¸šç­‰
2. **ç”¨æˆ·åå¥½ä¸å…´è¶£**ï¼šæåˆ°çš„å…´è¶£ã€åå¥½
3. **è®¨è®ºä¸»è¦è¯é¢˜**ï¼šèŠäº†ä»€ä¹ˆ
4. **é‡è¦å†³å®šæˆ–ç»“è®º**ï¼šåšäº†ä»€ä¹ˆå†³å®š
5. **å…³é”®ç»†èŠ‚**ï¼šå…¶ä»–é‡è¦ä¿¡æ¯

è¦æ±‚ï¼š
- ç®€æ´æ˜äº†ï¼Œä¸è¶…è¿‡150å­—
- åªä¿ç•™å…³é”®ä¿¡æ¯ï¼Œåˆ é™¤å¯’æš„
- ä½¿ç”¨ç»“æ„åŒ–æ ¼å¼
"""</span>
        
        <span class="hljs-comment"># è°ƒç”¨LLMç”Ÿæˆæ‘˜è¦</span>
        summary = self.llm.chat([
            {<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: prompt}
        ])
        
        <span class="hljs-keyword">return</span> summary
</code></pre>
<h4 data-id="heading-44"><strong>çœŸå®æ€§èƒ½æµ‹è¯•</strong></h4>
<p>æˆ‘ä»¬å¯¹LLMæ‘˜è¦å‹ç¼©å™¨è¿›è¡Œäº†å®Œæ•´æµ‹è¯•ï¼Œä»¥ä¸‹æ˜¯çœŸå®æ•°æ®ï¼š</p>
<hr/>
<p><strong>æµ‹è¯•1ï¼šå‹ç¼©ç‡ï¼ˆä¿ç•™æœ€è¿‘3è½®ï¼‰</strong></p>








































<table><thead><tr><th>å¯¹è¯é•¿åº¦</th><th>åŸå§‹</th><th>å‹ç¼©å</th><th>Tokenå‹ç¼©ç‡</th><th>ç»“æœ</th></tr></thead><tbody><tr><td>5è½®ï¼ˆçŸ­å¯¹è¯ï¼‰</td><td>10æ¡ / 126 tokens</td><td>7æ¡ / 303 tokens</td><td><strong>-140.5%</strong> âŒ</td><td>Tokenåå¢</td></tr><tr><td>10è½®ï¼ˆä¸­ç­‰ï¼‰</td><td>20æ¡ / 249 tokens</td><td>7æ¡ / 408 tokens</td><td><strong>-63.9%</strong> âŒ</td><td>Tokenåå¢</td></tr><tr><td>20è½®ï¼ˆé•¿å¯¹è¯ï¼‰</td><td>42æ¡ / 560 tokens</td><td>7æ¡ / 539 tokens</td><td><strong>3.7%</strong> âš ï¸</td><td>å¾®å¼±å‹ç¼©</td></tr><tr><td>30è½®ï¼ˆè¶…é•¿ï¼‰</td><td>68æ¡ / 933 tokens</td><td>7æ¡ / 628 tokens</td><td><strong>32.7%</strong> âœ…</td><td>æœ‰æ•ˆå‹ç¼©</td></tr></tbody></table>
<p><strong>æ„å¤–å‘ç°ï¼šLLMæ‘˜è¦åœ¨çŸ­å¯¹è¯ä¸­å®Œå…¨æ˜¯è´Ÿä¼˜åŒ–ï¼</strong></p>
<p>åŸå› åˆ†æï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">çŸ­å¯¹è¯ï¼ˆ5è½®ï¼Œ126 tokensï¼‰ï¼š
åŸæ–‡: "æˆ‘å«Tom"ã€"ä½ å¥½Tom"ã€"æˆ‘åœ¨ä¸Šæµ·"...

æ‘˜è¦ï¼ˆ303 tokensï¼‰ï¼š
"ğŸ“ å¯¹è¯å†å²æ‘˜è¦ï¼š
<span class="hljs-bullet">1.</span> <span class="hljs-strong">**ç”¨æˆ·åŸºæœ¬ä¿¡æ¯**</span>ï¼š
<span class="hljs-bullet">   -</span> å§“åï¼šTom
<span class="hljs-bullet">   -</span> åœ°ç‚¹ï¼šä¸Šæµ·
<span class="hljs-bullet">   -</span> èŒä¸šï¼šæœªæ˜ç¡®è¯´æ˜è¡Œä¸š
<span class="hljs-bullet">2.</span> <span class="hljs-strong">**ç”¨æˆ·åå¥½å’Œå…´è¶£**</span>ï¼šæœªæåŠ
<span class="hljs-bullet">3.</span> <span class="hljs-strong">**è®¨è®ºä¸»è¦è¯é¢˜**</span>ï¼š..."

é—®é¢˜ï¼šæ‘˜è¦æœ¬èº«æ¯”åŸæ–‡è¿˜å•°å—¦ï¼
</code></pre>
<p><strong>ç»“è®ºï¼šåªæœ‰åœ¨è¶…é•¿å¯¹è¯ï¼ˆâ‰¥30è½®ï¼‰æ—¶ï¼ŒLLMæ‘˜è¦æ‰å¼€å§‹äº§ç”Ÿæ­£æ”¶ç›Šã€‚</strong></p>
<hr/>
<p><strong>æµ‹è¯•2ï¼šé€Ÿåº¦æµ‹è¯•</strong></p>
<pre><code class="hljs language-makefile" lang="makefile">æµ‹è¯•å¯¹è¯ï¼š10è½®ï¼ˆ20æ¡æ¶ˆæ¯ï¼‰

<span class="hljs-section">å‹ç¼©1æ¬¡:  8,939ms  (çº¦9ç§’)</span>
<span class="hljs-section">å‹ç¼©3æ¬¡:  25,210ms (å¹³å‡8.4ç§’/æ¬¡)</span>
<span class="hljs-section">å‹ç¼©5æ¬¡:  42,599ms (å¹³å‡8.5ç§’/æ¬¡)</span>

å¹³å‡é€Ÿåº¦ï¼š8.5ç§’/æ¬¡ ğŸŒ
</code></pre>
<p><strong>å¯¹æ¯”ï¼š</strong></p>
<ul>
<li>æ»‘åŠ¨çª—å£ï¼š0.0001ms</li>
<li>LLMæ‘˜è¦ï¼š8,500ms</li>
<li><strong>å·®è·ï¼š85,000,000å€ï¼</strong></li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆè¿™ä¹ˆæ…¢ï¼Ÿ</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> ç½‘ç»œè¯·æ±‚ï¼š50-100ms
<span class="hljs-bullet">2.</span> LLMæ¨ç†ï¼š8,000ms+
<span class="hljs-bullet">3.</span> è¿”å›ç»“æœï¼š50-100ms
æ€»è®¡ï¼šçº¦8,500ms
</code></pre>
<p><strong>ç»“è®ºï¼šLLMæ‘˜è¦ä¼šæ˜¾è‘—å¢åŠ å“åº”å»¶è¿Ÿã€‚</strong></p>
<hr/>
<p><strong>æµ‹è¯•3ï¼šæˆæœ¬åˆ†æ</strong></p>
<p>DeepSeekä»·æ ¼ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.14</mn><mi mathvariant="normal">/</mi><mn>1</mn><mi>M</mi><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mi>t</mi><mi>o</mi><mi>k</mi><mi>e</mi><mi>n</mi><mi>s</mi><mtext>ï¼Œ</mtext></mrow><annotation encoding="application/x-tex">0.14/1M input tokensï¼Œ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord">0.14/1</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">in</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">tt</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">s</span><span class="mord cjk_fallback">ï¼Œ</span></span></span></span></span>0.28/1M output tokens</p>








































<table><thead><tr><th>å¯¹è¯é•¿åº¦</th><th>è¾“å…¥tokens</th><th>è¾“å‡ºtokens</th><th>å•æ¬¡æˆæœ¬</th><th>1ä¸‡æ¬¡æˆæœ¬</th></tr></thead><tbody><tr><td>5è½®</td><td>48</td><td>14</td><td>$0.000011</td><td>$0.11</td></tr><tr><td>10è½®</td><td>175</td><td>52</td><td>$0.000039</td><td>$0.39</td></tr><tr><td>20è½®</td><td>474</td><td>142</td><td>$0.000106</td><td><strong>$1.06</strong></td></tr><tr><td>30è½®</td><td>852</td><td>256</td><td>$0.000191</td><td><strong>$1.91</strong></td></tr></tbody></table>
<p><strong>è§„æ¨¡åŒ–æˆæœ¬ä¼°ç®—ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">åœºæ™¯ï¼šæ—¥æ´»10ä¸‡ç”¨æˆ·çš„å®¢æœç³»ç»Ÿ
- æ¯ç”¨æˆ·å¹³å‡20è½®å¯¹è¯
- æ¯æ¬¡å‹ç¼©æˆæœ¬ï¼š<span class="hljs-variable">$0</span>.0001

æˆæœ¬è®¡ç®—ï¼š
- æ—¥æˆæœ¬ï¼š10ä¸‡ Ã— <span class="hljs-variable">$0</span>.0001 = <span class="hljs-variable">$10</span>
- æœˆæˆæœ¬ï¼š<span class="hljs-variable">$10</span> Ã— 30 = <span class="hljs-variable">$300</span>
- å¹´æˆæœ¬ï¼š<span class="hljs-variable">$3</span>,600

vs æ»‘åŠ¨çª—å£ï¼š<span class="hljs-variable">$0</span>
</code></pre>
<p><strong>ç»“è®ºï¼šLLMæ‘˜è¦æœ‰æ˜ç¡®çš„æˆæœ¬å¼€é”€ï¼Œéœ€è¦æƒè¡¡ã€‚</strong></p>
<hr/>
<p><strong>æµ‹è¯•4ï¼šä¿¡æ¯ä¿ç•™æµ‹è¯•ï¼ˆå…³é”®ï¼ï¼‰</strong></p>
<p>æ„é€ ä¸€ä¸ªåŒ…å«9ä¸ªå…³é”®ä¿¡æ¯çš„å¯¹è¯ï¼ˆ6è½®ï¼‰ï¼š</p>
<pre><code class="hljs language-python" lang="python">å…³é”®ä¿¡æ¯ï¼š
Tom, <span class="hljs-number">28</span>å², ä¸Šæµ·, æµ¦ä¸œ, AIå·¥ç¨‹å¸ˆ, Agent, å¤šæ™ºèƒ½ä½“, é€šä¿¡å»¶è¿Ÿ, æ¶ˆæ¯é˜Ÿåˆ—

åŸå§‹å¯¹è¯ï¼š<span class="hljs-number">12</span>æ¡æ¶ˆæ¯

å‹ç¼©åï¼š<span class="hljs-number">5</span>æ¡æ¶ˆæ¯
â”œâ”€ <span class="hljs-number">1</span>æ¡æ‘˜è¦
â””â”€ <span class="hljs-number">4</span>æ¡æœ€è¿‘å¯¹è¯ï¼ˆä¿ç•™<span class="hljs-number">2</span>è½®ï¼‰
</code></pre>
<p><strong>æ‘˜è¦å†…å®¹ï¼ˆå®é™…ç”Ÿæˆï¼‰ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">ğŸ“ å¯¹è¯å†å²æ‘˜è¦ï¼š
<span class="hljs-strong">**ç”¨æˆ·åŸºæœ¬ä¿¡æ¯**</span>
<span class="hljs-bullet">-</span> å§“åï¼šTom
<span class="hljs-bullet">-</span> å¹´é¾„ï¼š28å²
<span class="hljs-bullet">-</span> åœ°ç‚¹ï¼šä¸Šæµ·æµ¦ä¸œ
<span class="hljs-bullet">-</span> èŒä¸šï¼šAIå·¥ç¨‹å¸ˆ

<span class="hljs-strong">**ç”¨æˆ·åå¥½ä¸å…´è¶£**</span>
<span class="hljs-bullet">-</span> å¯¹AIé¢†åŸŸå‰æ²¿æŠ€æœ¯æ„Ÿå…´è¶£ï¼Œç›®å‰ä¸“æ³¨äºAgentå¤šæ™ºèƒ½ä½“åä½œç ”ç©¶ã€‚

<span class="hljs-strong">**è®¨è®ºä¸»è¦è¯é¢˜**</span>
<span class="hljs-bullet">1.</span> ç”¨æˆ·è‡ªæˆ‘ä»‹ç»ï¼ˆå§“åã€å¹´é¾„ã€èŒä¸šã€å·¥ä½œåœ°ç‚¹ï¼‰
<span class="hljs-bullet">2.</span> èŒä¸šæ–¹å‘è®¨è®ºï¼ˆAIå·¥ç¨‹å¸ˆçš„å‰æ™¯ï¼‰
<span class="hljs-bullet">3.</span> æŠ€æœ¯ç ”ç©¶çƒ­ç‚¹ï¼ˆå¤šæ™ºèƒ½ä½“åä½œï¼‰

<span class="hljs-strong">**å…³é”®ç»†èŠ‚**</span>
<span class="hljs-bullet">-</span> å¹´é¾„ï¼š28å²
<span class="hljs-bullet">-</span> åœ°ç‚¹ï¼šä¸Šæµ·æµ¦ä¸œ
<span class="hljs-bullet">-</span> ç ”ç©¶æ–¹å‘ï¼šAgentå¤šæ™ºèƒ½ä½“åä½œ
</code></pre>
<p><strong>ä¿¡æ¯ä¿ç•™æƒ…å†µï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">âœ… Tom          - ä¿ç•™
âœ… 28å²         - ä¿ç•™
âœ… ä¸Šæµ·         - ä¿ç•™
âœ… æµ¦ä¸œ         - ä¿ç•™
âœ… AIå·¥ç¨‹å¸ˆ     - ä¿ç•™
âœ… Agent        - ä¿ç•™
âœ… å¤šæ™ºèƒ½ä½“     - ä¿ç•™
âœ… é€šä¿¡å»¶è¿Ÿ     - ä¿ç•™ï¼ˆåœ¨æœ€è¿‘å¯¹è¯ä¸­ï¼‰
âœ… æ¶ˆæ¯é˜Ÿåˆ—     - ä¿ç•™ï¼ˆåœ¨æœ€è¿‘å¯¹è¯ä¸­ï¼‰

ä¿ç•™ç‡ï¼š9/<span class="hljs-attr">9</span> = <span class="hljs-number">100</span>% âœ…
</code></pre>
<p><strong>å¯¹æ¯”æ»‘åŠ¨çª—å£ï¼š</strong></p>
<ul>
<li>æ»‘åŠ¨çª—å£ï¼ˆ5è½®ï¼‰ï¼šä¸¢å¤±Tomã€28å²ã€ä¸Šæµ·ã€æµ¦ä¸œã€AIå·¥ç¨‹å¸ˆ</li>
<li>LLMæ‘˜è¦ï¼šå…¨éƒ¨ä¿ç•™</li>
</ul>
<p><strong>è¿™å°±æ˜¯LLMæ‘˜è¦çš„æ ¸å¿ƒä»·å€¼ï¼šæ™ºèƒ½æå–ï¼Œä¸ä¸¢å¤±å…³é”®ä¿¡æ¯ï¼</strong></p>
<hr/>
<p><strong>æµ‹è¯•5ï¼šä¸æ»‘åŠ¨çª—å£ç›´æ¥å¯¹æ¯”</strong></p>
<p>æµ‹è¯•å¯¹è¯ï¼š20è½®ï¼ˆ42æ¡æ¶ˆæ¯ï¼Œ560 tokensï¼‰</p>


























<table><thead><tr><th>ç­–ç•¥</th><th>ç»“æœ</th><th>Tokenæ•°</th><th>è€—æ—¶</th><th>æˆæœ¬</th></tr></thead><tbody><tr><td>æ»‘åŠ¨çª—å£</td><td>10æ¡æ¶ˆæ¯</td><td>145 tokens</td><td>0.00ms</td><td>$0</td></tr><tr><td>LLMæ‘˜è¦</td><td>7æ¡æ¶ˆæ¯</td><td>571 tokens</td><td>14,263ms</td><td>$0.000114</td></tr></tbody></table>
<p><strong>å…³é”®å¯¹æ¯”ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">Tokenæ•ˆç‡ï¼š
<span class="hljs-deletion">- æ»‘åŠ¨çª—å£ï¼š145 tokensï¼ˆ74%å‹ç¼©ï¼‰âœ…</span>
<span class="hljs-deletion">- LLMæ‘˜è¦ï¼š571 tokensï¼ˆ-2%å‹ç¼©ï¼‰âŒ</span>
â†’ LLMæ‘˜è¦åè€Œç”¨äº†æ›´å¤štokenï¼

é€Ÿåº¦ï¼š
<span class="hljs-deletion">- æ»‘åŠ¨çª—å£ï¼š0.00ms</span>
<span class="hljs-deletion">- LLMæ‘˜è¦ï¼š14,263ms</span>
â†’ æ…¢äº†4,600,000å€ï¼

æˆæœ¬ï¼š
<span class="hljs-deletion">- æ»‘åŠ¨çª—å£ï¼š$0</span>
<span class="hljs-deletion">- LLMæ‘˜è¦ï¼š$0.000114</span>
â†’ æ¯æ¬¡éƒ½æœ‰æˆæœ¬

ä½†ä¿¡æ¯ä¿ç•™ï¼š
<span class="hljs-deletion">- æ»‘åŠ¨çª—å£ï¼šâŒ ä¸¢å¤±æ‰€æœ‰æ—©æœŸä¿¡æ¯</span>
<span class="hljs-deletion">- LLMæ‘˜è¦ï¼šâœ… ä¿ç•™100%å…³é”®ä¿¡æ¯</span>
</code></pre>
<p><strong>æ ¸å¿ƒçŸ›ç›¾ï¼šLLMæ‘˜è¦åœ¨tokenæ•°é‡ä¸Šç”šè‡³ä¸å¦‚æ»‘åŠ¨çª—å£ï¼</strong></p>
<p>å®Œæ•´æµ‹è¯•ä»£ç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsotopelaez092-star%2Fmemory-chatbot%2Fblob%2Fmain%2Ftests%2Ftest_llm_summary.py" target="_blank" title="https://github.com/sotopelaez092-star/memory-chatbot/blob/main/tests/test_llm_summary.py" ref="nofollow noopener noreferrer">github.com/sotopelaez0â€¦</a></p>
<hr/>
<h4 data-id="heading-45"><strong>ä¸ºä»€ä¹ˆTokenåè€Œå¢åŠ ï¼Ÿ</strong></h4>
<p>è®©æˆ‘ä»¬åˆ†æä¸€ä¸ªå®é™…æ¡ˆä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python">åŸå§‹å¯¹è¯ï¼ˆ<span class="hljs-number">5</span>è½®ï¼Œ<span class="hljs-number">126</span> tokensï¼‰ï¼š
ç”¨æˆ·: <span class="hljs-string">"æˆ‘å«Tom"</span>                    (<span class="hljs-number">3</span> tokens)
åŠ©æ‰‹: <span class="hljs-string">"ä½ å¥½Tomï¼"</span>                   (<span class="hljs-number">4</span> tokens)
ç”¨æˆ·: <span class="hljs-string">"æˆ‘åœ¨ä¸Šæµ·"</span>                    (<span class="hljs-number">4</span> tokens)
åŠ©æ‰‹: <span class="hljs-string">"ä¸Šæµ·ä¸é”™"</span>                    (<span class="hljs-number">3</span> tokens)
...

LLMç”Ÿæˆçš„æ‘˜è¦ï¼ˆ<span class="hljs-number">303</span> tokensï¼‰ï¼š
<span class="hljs-string">"ğŸ“ å¯¹è¯å†å²æ‘˜è¦ï¼š
1. **ç”¨æˆ·åŸºæœ¬ä¿¡æ¯**ï¼š
   - å§“åï¼šTom
   - åœ°ç‚¹ï¼šä¸Šæµ·
   - èŒä¸šï¼šæœªæ˜ç¡®è¯´æ˜è¡Œä¸š
2. **ç”¨æˆ·åå¥½å’Œå…´è¶£**ï¼šæœªæåŠ
3. **è®¨è®ºä¸»è¦è¯é¢˜**ï¼šåŸºæœ¬ä¿¡æ¯äº¤æµ
4. **é‡è¦å†³å®šæˆ–ç»“è®º**ï¼šæ— 
5. **å…³é”®ç»†èŠ‚**ï¼š..."</span>
</code></pre>
<p><strong>é—®é¢˜åœ¨äºï¼š</strong></p>
<ol>
<li>æ‘˜è¦åŒ…å«å¤§é‡<strong>æ ¼å¼åŒ–æ–‡æœ¬</strong>ï¼ˆæ ‡é¢˜ã€åºå·ã€åˆ†éš”ç¬¦ï¼‰</li>
<li>æ‘˜è¦æœ‰<strong>å†—ä½™æè¿°</strong>ï¼ˆ"æœªæåŠ"ã€"æ— "è¿™äº›ä¹Ÿå tokenï¼‰</li>
<li>åŸå§‹å¯¹è¯æœ¬æ¥å°±<strong>å¾ˆçŸ­å¾ˆç²¾ç‚¼</strong></li>
</ol>
<p><strong>è§£å†³æ–¹æ¡ˆï¼šä¼˜åŒ–Prompt</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä¼˜åŒ–å‰ï¼ˆå½“å‰ä½¿ç”¨çš„ï¼‰</span>
<span class="hljs-string">"è¯·æŒ‰ä»¥ä¸‹æ ¼å¼è¾“å‡ºæ‘˜è¦ï¼ˆ150å­—ä»¥å†…ï¼‰ï¼š
ğŸ“ å¯¹è¯å†å²æ‘˜è¦ï¼š
1. **ç”¨æˆ·åŸºæœ¬ä¿¡æ¯**ï¼š..."</span>

<span class="hljs-comment"># ä¼˜åŒ–åï¼ˆæ›´ç´§å‡‘ï¼‰</span>
<span class="hljs-string">"ç”¨ä¸€å¥è¯æ€»ç»“å…³é”®ä¿¡æ¯ï¼Œæ ¼å¼ï¼š
Tomï¼Œ28å²ï¼Œä¸Šæµ·AIå·¥ç¨‹å¸ˆï¼Œç ”ç©¶Agent"</span>

å‹ç¼©æ•ˆæœï¼š
- ä¼˜åŒ–å‰ï¼š<span class="hljs-number">303</span> tokens
- ä¼˜åŒ–åï¼šçº¦<span class="hljs-number">30</span> tokens âœ…
</code></pre>
<hr/>
<h4 data-id="heading-46"><strong>ä¼˜ç¼ºç‚¹æ€»ç»“</strong></h4>
<p>åŸºäºçœŸå®æµ‹è¯•æ•°æ®ï¼š</p>
<p><strong>âœ… å”¯ä¸€çš„æ ¸å¿ƒä¼˜åŠ¿ï¼šä¿¡æ¯ä¿ç•™</strong></p>
<pre><code class="hljs language-diff" lang="diff">æµ‹è¯•ç»“æœï¼š100%ä¿ç•™å…³é”®ä¿¡æ¯
<span class="hljs-deletion">- âœ… ç”¨æˆ·å§“åï¼ˆTomï¼‰</span>
<span class="hljs-deletion">- âœ… å¹´é¾„ï¼ˆ28å²ï¼‰</span>
<span class="hljs-deletion">- âœ… åœ°ç‚¹ï¼ˆä¸Šæµ·æµ¦ä¸œï¼‰</span>
<span class="hljs-deletion">- âœ… èŒä¸šï¼ˆAIå·¥ç¨‹å¸ˆï¼‰</span>
<span class="hljs-deletion">- âœ… å…´è¶£ï¼ˆAgentå¤šæ™ºèƒ½ä½“ï¼‰</span>

vs æ»‘åŠ¨çª—å£ï¼šå…¨éƒ¨ä¸¢å¤± âŒ
</code></pre>
<p><strong>è¿™æ˜¯LLMæ‘˜è¦çš„ç«‹èº«ä¹‹æœ¬ï¼</strong></p>
<p><strong>âŒ ä¸‰å¤§è‡´å‘½ç¼ºé™·ï¼š</strong></p>
<ol>
<li><strong>çŸ­å¯¹è¯è´Ÿä¼˜åŒ–</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">å®æµ‹æ•°æ®ï¼š
<span class="hljs-deletion">- 5è½®å¯¹è¯ï¼šToken -140%ï¼ˆåè€Œå¢åŠ ï¼‰</span>
<span class="hljs-deletion">- 10è½®å¯¹è¯ï¼šToken -64%</span>
<span class="hljs-deletion">- åªæœ‰30è½®ä»¥ä¸Šæ‰å¼€å§‹æ­£æ”¶ç›Š</span>

ç»“è®ºï¼šä¸é€‚åˆçŸ­å¯¹è¯ âŒ
</code></pre>
<ol>
<li><strong>é€Ÿåº¦ææ…¢</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">å®æµ‹ï¼š8.5ç§’/æ¬¡
å¯¹æ¯”ï¼šæ»‘åŠ¨çª—å£0.0001ms

å½±å“ï¼š
<span class="hljs-deletion">- ç”¨æˆ·ç­‰å¾…æ—¶é—´å¢åŠ 8ç§’</span>
<span class="hljs-deletion">- å®æ—¶å¯¹è¯ä½“éªŒå·®</span>
<span class="hljs-deletion">- é«˜å¹¶å‘åœºæ™¯ç“¶é¢ˆ</span>

ç»“è®ºï¼šä¸é€‚åˆå®æ—¶åœºæ™¯ âŒ
</code></pre>
<ol>
<li><strong>æœ‰æ˜ç¡®æˆæœ¬</strong></li>
</ol>

<pre><code class="hljs language-bash" lang="bash">å®æµ‹ï¼š<span class="hljs-variable">$0</span>.0001-0.0002/æ¬¡

è§„æ¨¡åŒ–ï¼š
- æ—¥æ´»10ä¸‡ï¼š<span class="hljs-variable">$10</span>/å¤©
- å¹´æˆæœ¬ï¼š<span class="hljs-variable">$3</span>,600

vs æ»‘åŠ¨çª—å£ï¼š<span class="hljs-variable">$0</span>

ç»“è®ºï¼šæœ‰æˆæœ¬å‹åŠ› âš ï¸
</code></pre>
<hr/>
<h4 data-id="heading-47"><strong>é€‚ç”¨åœºæ™¯æŒ‡å—</strong></h4>
<p>åŸºäºçœŸå®æµ‹è¯•ï¼ŒLLMæ‘˜è¦çš„é€‚ç”¨åœºæ™¯éå¸¸<strong>æœ‰é™ä¸”æ˜ç¡®</strong>ï¼š</p>
<p><strong>âœ… å”¯ä¸€æ¨èåœºæ™¯ï¼šè¶…é•¿å¯¹è¯ + éœ€è¦ä¿ç•™ç”¨æˆ·ä¿¡æ¯</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">åŒæ—¶æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š
<span class="hljs-bullet">1.</span> âœ… å¯¹è¯â‰¥30è½®ï¼ˆå¦åˆ™tokenè´Ÿä¼˜åŒ–ï¼‰
<span class="hljs-bullet">2.</span> âœ… åŒ…å«é‡è¦ç”¨æˆ·ä¿¡æ¯ï¼ˆå§“åã€åå¥½ç­‰ï¼‰
<span class="hljs-bullet">3.</span> âœ… å¯ä»¥å®¹å¿8ç§’å»¶è¿Ÿ
<span class="hljs-bullet">4.</span> âœ… æœ‰é¢„ç®—æ”¯æŒLLMè°ƒç”¨

å…¸å‹åœºæ™¯ï¼š
<span class="hljs-bullet">-</span> å¿ƒç†å’¨è¯¢ï¼ˆé•¿æ—¶é—´æ·±åº¦å¯¹è¯ï¼‰
<span class="hljs-bullet">-</span> æ•™è‚²è¾…å¯¼ï¼ˆéœ€è¦è®°ä½å­¦ç”ŸèƒŒæ™¯ï¼‰
<span class="hljs-bullet">-</span> é«˜ç«¯å®¢æœï¼ˆVIPç”¨æˆ·ï¼Œä½“éªŒä¼˜å…ˆï¼‰
<span class="hljs-bullet">-</span> é¡¹ç›®é¡¾é—®ï¼ˆæŒç»­æ•°å‘¨çš„é¡¹ç›®è®¨è®ºï¼‰
</code></pre>
<p><strong>âŒ ä¸æ¨èåœºæ™¯ï¼š</strong></p>
<ol>
<li><strong>çŸ­å¯¹è¯ï¼ˆ&lt;30è½®ï¼‰</strong></li>
</ol>

<pre><code class="hljs language-erlang" lang="erlang">é—®é¢˜ï¼šTokenåè€Œå¢åŠ ï¼Œå®Œå…¨è´Ÿä¼˜åŒ–
æ•°æ®ï¼š<span class="hljs-number">10</span>è½®å¯¹è¯token -<span class="hljs-number">64</span><span class="hljs-comment">%</span>
æ›¿ä»£ï¼šç”¨æ»‘åŠ¨çª—å£
</code></pre>
<ol>
<li><strong>å®æ—¶å¯¹è¯</strong></li>
</ol>

<pre><code class="hljs">é—®é¢˜ï¼š8ç§’å»¶è¿Ÿæ— æ³•æ¥å—
æ•°æ®ï¼šæ¯”æ»‘åŠ¨çª—å£æ…¢460ä¸‡å€
æ›¿ä»£ï¼šç”¨æ»‘åŠ¨çª—å£
</code></pre>
<ol>
<li><strong>å¤§è§„æ¨¡å…è´¹äº§å“</strong></li>
</ol>

<pre><code class="hljs language-bash" lang="bash">é—®é¢˜ï¼šæˆæœ¬ç´¯ç§¯å¿«
æ•°æ®ï¼šæ—¥æ´»10ä¸‡å¹´æˆæœ¬<span class="hljs-variable">$3</span>,600
æ›¿ä»£ï¼šç”¨æ»‘åŠ¨çª—å£æˆ–æ··åˆç­–ç•¥
</code></pre>
<ol>
<li><strong>ç®€å•é—®ç­”</strong></li>
</ol>

<pre><code class="hljs">é—®é¢˜ï¼šä¸éœ€è¦è®°ä½ç”¨æˆ·ä¿¡æ¯
æ•°æ®ï¼šæ‘˜è¦å¼€é”€å¤§äºæ”¶ç›Š
æ›¿ä»£ï¼šç”¨æ»‘åŠ¨çª—å£
</code></pre>
<hr/>
<h4 data-id="heading-48"><strong>ä¼˜åŒ–å»ºè®®</strong></h4>
<p>å¦‚æœä¸€å®šè¦ç”¨LLMæ‘˜è¦ï¼Œå¯ä»¥è¿™æ ·ä¼˜åŒ–ï¼š</p>
<p><strong>1. ç®€åŒ–Promptï¼Œå‡å°‘æ ¼å¼åŒ–æ–‡æœ¬</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å½“å‰Promptï¼ˆ303 tokensè¾“å‡ºï¼‰</span>
<span class="hljs-string">"è¯·æŒ‰ä»¥ä¸‹æ ¼å¼è¾“å‡ºæ‘˜è¦ï¼ˆ150å­—ä»¥å†…ï¼‰ï¼š
ğŸ“ å¯¹è¯å†å²æ‘˜è¦ï¼š
1. **ç”¨æˆ·åŸºæœ¬ä¿¡æ¯**ï¼š..."</span>

<span class="hljs-comment"># ä¼˜åŒ–Promptï¼ˆçº¦50 tokensï¼‰</span>
<span class="hljs-string">"ä¸€å¥è¯æ€»ç»“ï¼šTomï¼Œ28å²ï¼Œä¸Šæµ·AIå·¥ç¨‹å¸ˆï¼Œç ”ç©¶Agentå¤šæ™ºèƒ½ä½“åä½œï¼Œé‡åˆ°é€šä¿¡å»¶è¿Ÿé—®é¢˜ã€‚"</span>

æ•ˆæœï¼štokenå‡å°‘<span class="hljs-number">80</span>% âœ…
</code></pre>
<p><strong>2. æé«˜è§¦å‘é˜ˆå€¼</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä¸å¥½ï¼š10è½®å°±è§¦å‘</span>
compressor = LLMSummaryCompressor(llm, keep_recent_turns=<span class="hljs-number">3</span>)
<span class="hljs-comment"># 10è½®æ—¶tokenè¿˜æ˜¯è´Ÿæ•°</span>

<span class="hljs-comment"># æ›´å¥½ï¼š30è½®æ‰è§¦å‘</span>
<span class="hljs-comment"># åªåœ¨çœŸæ­£éœ€è¦æ—¶æ‰ç”¨LLMæ‘˜è¦</span>
</code></pre>
<p><strong>3. å¼‚æ­¥å‹ç¼©</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åŒæ­¥ï¼ˆé˜»å¡ç”¨æˆ·ï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">chat</span>(<span class="hljs-params">user_input</span>):
    compressed = compressor.compress(history)  <span class="hljs-comment"># ç­‰å¾…8ç§’</span>
    response = llm.chat(compressed)
    <span class="hljs-keyword">return</span> response

<span class="hljs-comment"># å¼‚æ­¥ï¼ˆä¸é˜»å¡ï¼‰</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">chat</span>(<span class="hljs-params">user_input</span>):
    <span class="hljs-comment"># åå°å¼‚æ­¥å‹ç¼©</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(history) &gt; <span class="hljs-number">30</span>:
        asyncio.create_task(compress_in_background())
    
    <span class="hljs-comment"># ç›´æ¥ç”¨æœªå‹ç¼©çš„å†å²å›å¤</span>
    response = llm.chat(history)
    <span class="hljs-keyword">return</span> response
</code></pre>
<p><strong>4. ç¼“å­˜æ‘˜è¦ç»“æœ</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LLMSummaryCompressor</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.summary_cache = {}  <span class="hljs-comment"># ç¼“å­˜å·²ç”Ÿæˆçš„æ‘˜è¦</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages</span>):
        <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦æœ‰ç¼“å­˜</span>
        cache_key = <span class="hljs-built_in">hash</span>(<span class="hljs-built_in">tuple</span>(m[<span class="hljs-string">'content'</span>] <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> messages[:-<span class="hljs-number">6</span>]))
        <span class="hljs-keyword">if</span> cache_key <span class="hljs-keyword">in</span> self.summary_cache:
            <span class="hljs-keyword">return</span> self.summary_cache[cache_key]  <span class="hljs-comment"># ç›´æ¥è¿”å›</span>
        
        <span class="hljs-comment"># ç”Ÿæˆæ–°æ‘˜è¦</span>
        summary = self._summarize(messages[:-<span class="hljs-number">6</span>])
        self.summary_cache[cache_key] = summary
        <span class="hljs-keyword">return</span> summary
</code></pre>
<hr/>
<h4 data-id="heading-49"><strong>å°ç»“</strong></h4>
<p>LLMæ‘˜è¦å‹ç¼©å™¨çš„çœŸå®è¡¨ç°ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">æ ¸å¿ƒä¼˜åŠ¿ï¼š
âœ… 100%ä¿¡æ¯ä¿ç•™ï¼ˆå”¯ä¸€äº®ç‚¹ï¼‰
âœ… æ™ºèƒ½ç†è§£å¯¹è¯å†…å®¹
âœ… æå–å…³é”®ä¿¡æ¯

æ ¸å¿ƒåŠ£åŠ¿ï¼š
âŒ çŸ­å¯¹è¯è´Ÿä¼˜åŒ–ï¼ˆtokenåå¢ï¼‰
âŒ é€Ÿåº¦ææ…¢ï¼ˆ8.5ç§’ï¼‰
âŒ æœ‰æ˜ç¡®æˆæœ¬ï¼ˆ$0.0001/æ¬¡ï¼‰

å®šä½ï¼š
ä»…é€‚åˆè¶…é•¿å¯¹è¯ï¼ˆâ‰¥30è½®ï¼‰+ éœ€è¦ä¿ç•™ç”¨æˆ·ä¿¡æ¯çš„åœºæ™¯

å¯¹æ¯”æ»‘åŠ¨çª—å£ï¼š
<span class="hljs-deletion">- Tokenæ•ˆç‡ï¼šâŒ æ›´å·®</span>
<span class="hljs-deletion">- é€Ÿåº¦ï¼šâŒ æ…¢460ä¸‡å€</span>
<span class="hljs-deletion">- æˆæœ¬ï¼šâŒ æœ‰æˆæœ¬</span>
<span class="hljs-deletion">- ä¿¡æ¯ä¿ç•™ï¼šâœ… å®Œèƒœï¼ˆ100% vs 0%ï¼‰</span>
</code></pre>
<p><strong>ç»“è®ºï¼šLLMæ‘˜è¦ä¸æ˜¯é€šç”¨æ–¹æ¡ˆï¼Œåªåœ¨ç‰¹å®šåœºæ™¯ä¸‹æ‰å€¼å¾—ä½¿ç”¨ã€‚</strong></p>
<p>åœ¨ä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°<strong>æ··åˆç­–ç•¥</strong> - ç»“åˆä¸¤è€…ä¼˜åŠ¿ï¼Œè‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ–¹æ¡ˆã€‚</p>
<hr/>
<p>è¿™å°†æ˜¯æœ€å®ç”¨çš„ç­–ç•¥ - è‡ªåŠ¨åœ¨æ»‘åŠ¨çª—å£å’ŒLLMæ‘˜è¦ä¹‹é—´é€‰æ‹©ï¼ğŸ˜Š</p>
<p>å¥½çš„ï¼æ ¹æ®çœŸå®æµ‹è¯•æ•°æ®ï¼Œè®©æˆ‘å†™ä¸€ä¸ªå®Œæ•´çš„æ··åˆç­–ç•¥éƒ¨åˆ† ğŸ“</p>
<hr/>
<h3 data-id="heading-50"><strong>3.4 ç­–ç•¥3ï¼šæ··åˆç­–ç•¥ï¼ˆHybridï¼‰</strong></h3>
<h4 data-id="heading-51"><strong>æ ¸å¿ƒåŸç†</strong></h4>
<p>æ··åˆç­–ç•¥æ˜¯ä¸€ç§<strong>è‡ªé€‚åº”å‹ç¼©</strong>æ–¹æ¡ˆï¼šæ ¹æ®å¯¹è¯é•¿åº¦è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜ç­–ç•¥ã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown">å†³ç­–æµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è®¡ç®—å¯¹è¯è½®æ•°   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<span class="hljs-code">         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚è½®æ•°â‰¤é˜ˆå€¼(10)?â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ æ˜¯              â”‚ å¦      â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚æ»‘åŠ¨çª—å£   â”‚      â”‚  LLMæ‘˜è¦   â”‚
â”‚- é€Ÿåº¦å¿«   â”‚      â”‚  - ä¿ç•™ä¿¡æ¯â”‚
â”‚- é›¶æˆæœ¬   â”‚      â”‚  - é€Ÿåº¦æ…¢  â”‚
â”‚- ç®€å•ç›´æ¥ â”‚      â”‚  - æœ‰æˆæœ¬  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre>
<p><strong>è®¾è®¡æ€æƒ³ï¼š</strong></p>
<p>åœ¨çŸ­å¯¹è¯å’Œé•¿å¯¹è¯ä¸­ï¼Œç”¨æˆ·çš„æ ¸å¿ƒéœ€æ±‚ä¸åŒï¼š</p>
<pre><code class="hljs language-diff" lang="diff">çŸ­å¯¹è¯ï¼ˆâ‰¤10è½®ï¼‰ï¼š
<span class="hljs-deletion">- ç”¨æˆ·éœ€æ±‚ï¼šå¿«é€Ÿå“åº”</span>
<span class="hljs-deletion">- ç—›ç‚¹ï¼šç­‰å¾…æ—¶é—´</span>
<span class="hljs-deletion">- ä¿¡æ¯ä¸¢å¤±é£é™©ï¼šä½ï¼ˆå¯¹è¯åˆšå¼€å§‹ï¼‰</span>
<span class="hljs-deletion">- æœ€ä¼˜ç­–ç•¥ï¼šæ»‘åŠ¨çª—å£</span>

é•¿å¯¹è¯ï¼ˆ&gt;10è½®ï¼‰ï¼š
<span class="hljs-deletion">- ç”¨æˆ·éœ€æ±‚ï¼šè®°ä½ä¹‹å‰è¯´çš„è¯</span>
<span class="hljs-deletion">- ç—›ç‚¹ï¼šé‡å¤è§£é‡Š</span>
<span class="hljs-deletion">- ä¿¡æ¯ä¸¢å¤±é£é™©ï¼šé«˜ï¼ˆæ—©æœŸä¿¡æ¯å·²è¢«åˆ é™¤ï¼‰</span>
<span class="hljs-deletion">- æœ€ä¼˜ç­–ç•¥ï¼šLLMæ‘˜è¦</span>
</code></pre>
<p><strong>æ ¸å¿ƒå‡è®¾ï¼š</strong> åœ¨é•¿å¯¹è¯ä¸­ï¼Œç”¨æˆ·ä½“éªŒçš„æå‡ &gt; Tokenæˆæœ¬å’Œé€Ÿåº¦æŸå¤±</p>
<h4 data-id="heading-52"><strong>ä»£ç å®ç°</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>
<span class="hljs-keyword">from</span> src.llm.base <span class="hljs-keyword">import</span> BaseLLM
<span class="hljs-keyword">from</span> src.memory.compressor <span class="hljs-keyword">import</span> SlidingWindowCompressor, LLMSummaryCompressor


<span class="hljs-keyword">class</span> <span class="hljs-title class_">HybridCompressor</span>:
    <span class="hljs-string">"""
    æ··åˆç­–ç•¥å‹ç¼©å™¨
    
    ç‰¹ç‚¹ï¼š
    - è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜ç­–ç•¥
    - çŸ­å¯¹è¯å¿«é€Ÿï¼Œé•¿å¯¹è¯æ™ºèƒ½
    - å¹³è¡¡æ•ˆç‡ä¸ä½“éªŒ
    """</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, 
                 llm: BaseLLM,
                 threshold_turns: <span class="hljs-built_in">int</span> = <span class="hljs-number">10</span>,
                 keep_recent_turns: <span class="hljs-built_in">int</span> = <span class="hljs-number">5</span></span>):
        <span class="hljs-string">"""
        Args:
            llm: LLMå®ä¾‹
            threshold_turns: åˆ‡æ¢é˜ˆå€¼ï¼ˆè½®æ•°ï¼‰
            keep_recent_turns: ä¿ç•™æœ€è¿‘å‡ è½®
        """</span>
        self.llm = llm
        self.threshold_turns = threshold_turns
        
        <span class="hljs-comment"># åˆå§‹åŒ–ä¸¤ç§ç­–ç•¥</span>
        self.sliding_window = SlidingWindowCompressor(
            keep_turns=keep_recent_turns
        )
        self.llm_summary = LLMSummaryCompressor(
            llm=llm,
            keep_recent_turns=keep_recent_turns
        )
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages: <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]]</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]]:
        <span class="hljs-string">"""
        æ ¹æ®å¯¹è¯é•¿åº¦è‡ªåŠ¨é€‰æ‹©ç­–ç•¥
        
        Args:
            messages: åŸå§‹æ¶ˆæ¯åˆ—è¡¨
            
        Returns:
            å‹ç¼©åçš„æ¶ˆæ¯åˆ—è¡¨
        """</span>
        <span class="hljs-comment"># è®¡ç®—å½“å‰è½®æ•°</span>
        turn_count = <span class="hljs-built_in">len</span>(messages) // <span class="hljs-number">2</span>
        
        <span class="hljs-comment"># å†³ç­–ï¼šé€‰æ‹©å“ªä¸ªç­–ç•¥</span>
        <span class="hljs-keyword">if</span> turn_count &lt;= self.threshold_turns:
            <span class="hljs-comment"># çŸ­å¯¹è¯ï¼šä½¿ç”¨æ»‘åŠ¨çª—å£ï¼ˆå¿«é€Ÿã€ä½æˆæœ¬ï¼‰</span>
            <span class="hljs-keyword">return</span> self.sliding_window.compress(messages)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># é•¿å¯¹è¯ï¼šä½¿ç”¨LLMæ‘˜è¦ï¼ˆæ™ºèƒ½ã€ä¿ç•™ä¿¡æ¯ï¼‰</span>
            <span class="hljs-keyword">return</span> self.llm_summary.compress(messages)
</code></pre>
<p><strong>æ ¸å¿ƒé€»è¾‘å°±ä¸€è¡Œï¼š</strong> æ ¹æ®è½®æ•°åˆ¤æ–­ç”¨å“ªä¸ªç­–ç•¥ã€‚</p>
<h4 data-id="heading-53"><strong>çœŸå®æ€§èƒ½æµ‹è¯•</strong></h4>
<p>æˆ‘ä»¬å¯¹æ··åˆç­–ç•¥è¿›è¡Œäº†å®Œæ•´æµ‹è¯•ï¼Œç»Ÿä¸€äº†æ‰€æœ‰å‚æ•°ï¼ˆ<code>keep_turns=5</code>ï¼‰ï¼Œä»¥ä¸‹æ˜¯çœŸå®æ•°æ®ï¼š</p>
<hr/>
<p><strong>æµ‹è¯•1ï¼šç­–ç•¥è‡ªåŠ¨é€‰æ‹©ï¼ˆéªŒè¯æ­£ç¡®æ€§ï¼‰</strong></p>
<p>é…ç½®ï¼šé˜ˆå€¼=10è½®ï¼Œä¿ç•™5è½®</p>













































<table><thead><tr><th>å¯¹è¯é•¿åº¦</th><th>è½®æ•°</th><th>é¢„æœŸç­–ç•¥</th><th>å®é™…ç­–ç•¥</th><th>å‹ç¼©ç»“æœ</th><th>è€—æ—¶</th></tr></thead><tbody><tr><td>çŸ­å¯¹è¯</td><td>5è½®</td><td>æ»‘åŠ¨çª—å£</td><td>æ»‘åŠ¨çª—å£ âœ…</td><td>10æ¡â†’10æ¡</td><td>0.00ms</td></tr><tr><td>ä¸­ç­‰å¯¹è¯</td><td>10è½®</td><td>æ»‘åŠ¨çª—å£</td><td>æ»‘åŠ¨çª—å£ âœ…</td><td>20æ¡â†’10æ¡</td><td>0.00ms</td></tr><tr><td>é•¿å¯¹è¯</td><td>21è½®</td><td>LLMæ‘˜è¦</td><td>LLMæ‘˜è¦ âœ…</td><td>42æ¡â†’11æ¡</td><td>11,832ms</td></tr><tr><td>è¶…é•¿å¯¹è¯</td><td>34è½®</td><td>LLMæ‘˜è¦</td><td>LLMæ‘˜è¦ âœ…</td><td>68æ¡â†’11æ¡</td><td>14,534ms</td></tr></tbody></table>
<p><strong>ç»“è®ºï¼šç­–ç•¥åˆ‡æ¢é€»è¾‘100%å‡†ç¡®ã€‚</strong></p>
<hr/>
<p><strong>æµ‹è¯•2ï¼šä¸‰ç§ç­–ç•¥æ€§èƒ½å¯¹æ¯”ï¼ˆå…³é”®æµ‹è¯•ï¼ï¼‰</strong></p>
<p>ç»Ÿä¸€å‚æ•°é…ç½®ï¼š</p>
<ul>
<li>æ»‘åŠ¨çª—å£ï¼šä¿ç•™5è½®</li>
<li>æ··åˆç­–ç•¥ï¼šä¿ç•™5è½®ï¼ˆçŸ­å¯¹è¯æ—¶ï¼‰</li>
<li>LLMæ‘˜è¦ï¼šä¿ç•™3è½® + æ‘˜è¦</li>
</ul>
<hr/>
<p><strong>åœºæ™¯1ï¼šçŸ­å¯¹è¯ï¼ˆ5è½®ï¼Œ126 tokensï¼‰</strong></p>





































<table><thead><tr><th>ç­–ç•¥</th><th>ç»“æœ</th><th>Token</th><th>å‹ç¼©ç‡</th><th>è€—æ—¶</th><th>æˆæœ¬</th></tr></thead><tbody><tr><td>æ»‘åŠ¨çª—å£</td><td>10æ¡</td><td>126</td><td>0%</td><td>0.00ms</td><td>$0</td></tr><tr><td>LLMæ‘˜è¦</td><td>7æ¡</td><td>303</td><td>-141% âŒ</td><td>7,471ms</td><td>$0.0001</td></tr><tr><td><strong>æ··åˆç­–ç•¥</strong></td><td><strong>10æ¡</strong></td><td><strong>126</strong></td><td><strong>0%</strong></td><td>0.01ms</td><td>$0</td></tr></tbody></table>
<p><strong>å¯¹æ¯”åˆ†æï¼š</strong></p>
<pre><code class="hljs">âœ… æ»‘åŠ¨çª—å£ vs æ··åˆç­–ç•¥ï¼šå®Œå…¨ä¸€è‡´
   10æ¡æ¶ˆæ¯, 126 tokens
</code></pre>
<p><strong>å…³é”®å‘ç°ï¼šå‚æ•°ç»Ÿä¸€åï¼ŒçŸ­å¯¹è¯æ—¶æ··åˆç­–ç•¥ä¸æ»‘åŠ¨çª—å£å®Œå…¨ç›¸åŒï¼</strong></p>
<hr/>
<p><strong>åœºæ™¯2ï¼šä¸­ç­‰å¯¹è¯ï¼ˆ10è½®ï¼Œ249 tokensï¼‰</strong></p>





































<table><thead><tr><th>ç­–ç•¥</th><th>ç»“æœ</th><th>Token</th><th>å‹ç¼©ç‡</th><th>è€—æ—¶</th><th>æˆæœ¬</th></tr></thead><tbody><tr><td>æ»‘åŠ¨çª—å£</td><td>10æ¡</td><td>123</td><td>51%</td><td>0.00ms</td><td>$0</td></tr><tr><td>LLMæ‘˜è¦</td><td>7æ¡</td><td>388</td><td>-56% âŒ</td><td>7,992ms</td><td>$0.0001</td></tr><tr><td><strong>æ··åˆç­–ç•¥</strong></td><td><strong>10æ¡</strong></td><td><strong>123</strong></td><td><strong>51%</strong></td><td>0.01ms</td><td>$0</td></tr></tbody></table>
<p><strong>å¯¹æ¯”åˆ†æï¼š</strong></p>
<pre><code class="hljs">âœ… æ»‘åŠ¨çª—å£ vs æ··åˆç­–ç•¥ï¼šå®Œå…¨ä¸€è‡´
   10æ¡æ¶ˆæ¯, 123 tokens
</code></pre>
<p><strong>å†æ¬¡éªŒè¯ï¼š10è½®ï¼ˆé˜ˆå€¼è¾¹ç•Œï¼‰æ—¶ï¼Œæ··åˆç­–ç•¥ = æ»‘åŠ¨çª—å£ã€‚</strong></p>
<hr/>
<p><strong>åœºæ™¯3ï¼šé•¿å¯¹è¯ï¼ˆ20è½®ï¼Œ560 tokensï¼‰</strong></p>





































<table><thead><tr><th>ç­–ç•¥</th><th>ç»“æœ</th><th>Token</th><th>å‹ç¼©ç‡</th><th>è€—æ—¶</th><th>æˆæœ¬</th></tr></thead><tbody><tr><td><strong>æ»‘åŠ¨çª—å£</strong></td><td>10æ¡</td><td><strong>145</strong></td><td><strong>74%</strong> âœ…</td><td>0.00ms</td><td>$0</td></tr><tr><td>LLMæ‘˜è¦</td><td>7æ¡</td><td>597</td><td>-7% âŒ</td><td>13,446ms</td><td>$0.0001</td></tr><tr><td>æ··åˆç­–ç•¥</td><td>11æ¡</td><td>604</td><td>-8% âŒ</td><td>11,663ms</td><td>$0.0001</td></tr></tbody></table>
<p><strong>å¯¹æ¯”åˆ†æï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">ğŸ“Š æ»‘åŠ¨çª—å£ vs æ··åˆç­–ç•¥ï¼ˆä½¿ç”¨LLMï¼‰ï¼š
   æ»‘åŠ¨çª—å£: 145 tokens, 0.00ms, <span class="hljs-variable">$0</span>
   æ··åˆç­–ç•¥: 604 tokens, 11,663ms, <span class="hljs-variable">$0</span>.0001
   âš ï¸ æ··åˆç­–ç•¥Tokenå¤š 4.2x
</code></pre>
<p><strong>å…³é”®çŸ›ç›¾å‡ºç°ï¼š</strong></p>
<ul>
<li>Tokenæ•ˆç‡ï¼šæ»‘åŠ¨çª—å£å®Œèƒœï¼ˆ145 vs 604ï¼‰</li>
<li>é€Ÿåº¦ï¼šæ»‘åŠ¨çª—å£å®Œèƒœï¼ˆ0ms vs 11,663msï¼‰</li>
<li>æˆæœ¬ï¼šæ»‘åŠ¨çª—å£å®Œèƒœï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mi>v</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">0 vs </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">0</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">s</span></span></span></span></span>0.0001ï¼‰</li>
</ul>
<p><strong>ä½†è¿™æ˜¯trade-offï¼Œä¸æ˜¯bugï¼</strong> æ··åˆç­–ç•¥ç‰ºç‰²äº†æ•ˆç‡ï¼Œæ¢å–ä¿¡æ¯ä¿ç•™ã€‚</p>
<hr/>
<p><strong>åœºæ™¯4ï¼šè¶…é•¿å¯¹è¯ï¼ˆ30è½®ï¼Œ933 tokensï¼‰</strong></p>





































<table><thead><tr><th>ç­–ç•¥</th><th>ç»“æœ</th><th>Token</th><th>å‹ç¼©ç‡</th><th>è€—æ—¶</th><th>æˆæœ¬</th></tr></thead><tbody><tr><td><strong>æ»‘åŠ¨çª—å£</strong></td><td>10æ¡</td><td><strong>144</strong></td><td><strong>85%</strong> âœ…</td><td>0.00ms</td><td>$0</td></tr><tr><td>LLMæ‘˜è¦</td><td>7æ¡</td><td>608</td><td>35%</td><td>13,204ms</td><td>$0.0001</td></tr><tr><td>æ··åˆç­–ç•¥</td><td>11æ¡</td><td>728</td><td>22%</td><td>14,809ms</td><td>$0.0001</td></tr></tbody></table>
<p><strong>å¯¹æ¯”åˆ†æï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">ğŸ“Š æ»‘åŠ¨çª—å£ vs æ··åˆç­–ç•¥ï¼ˆä½¿ç”¨LLMï¼‰ï¼š
   æ»‘åŠ¨çª—å£: 144 tokens, 0.00ms, <span class="hljs-variable">$0</span>
   æ··åˆç­–ç•¥: 728 tokens, 14,809ms, <span class="hljs-variable">$0</span>.0001
   âš ï¸ æ··åˆç­–ç•¥Tokenå¤š 5.1x
</code></pre>
<p><strong>å·®è·æ›´å¤§äº†ï¼</strong> åœ¨è¶…é•¿å¯¹è¯ä¸­ï¼Œæ··åˆç­–ç•¥çš„Tokenæ˜¯æ»‘åŠ¨çª—å£çš„5å€ã€‚</p>
<hr/>
<p><strong>æµ‹è¯•3ï¼šä¸åŒé˜ˆå€¼çš„å½±å“</strong></p>
<p>åœ¨20è½®å¯¹è¯ï¼ˆ560 tokensï¼‰ä¸­æµ‹è¯•ä¸åŒé˜ˆå€¼ï¼š</p>















































<table><thead><tr><th>é˜ˆå€¼</th><th>ä½¿ç”¨ç­–ç•¥</th><th>å‹ç¼©åTokens</th><th>è€—æ—¶</th><th>æˆæœ¬</th></tr></thead><tbody><tr><td>5è½®</td><td>LLMæ‘˜è¦</td><td>538</td><td>10,926ms</td><td>$0.0001</td></tr><tr><td>10è½®</td><td>LLMæ‘˜è¦</td><td>538</td><td>10,555ms</td><td>$0.0001</td></tr><tr><td>15è½®</td><td>LLMæ‘˜è¦</td><td>546</td><td>10,872ms</td><td>$0.0001</td></tr><tr><td>20è½®</td><td>LLMæ‘˜è¦</td><td>593</td><td>11,278ms</td><td>$0.0001</td></tr><tr><td><strong>25è½®</strong></td><td><strong>æ»‘åŠ¨çª—å£</strong></td><td><strong>145</strong></td><td><strong>0.00ms</strong></td><td><strong>$0</strong></td></tr></tbody></table>
<p><strong>å…³é”®å‘ç°ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">é˜ˆå€¼â‰¤20è½®ï¼šéƒ½ç”¨LLMæ‘˜è¦
<span class="hljs-deletion">- Token: 538-593ï¼ˆæ•ˆç‡å·®ï¼‰</span>
<span class="hljs-deletion">- è€—æ—¶: 10-11ç§’ï¼ˆå¾ˆæ…¢ï¼‰</span>
<span class="hljs-deletion">- æˆæœ¬: $0.0001</span>

é˜ˆå€¼=25è½®ï¼šç”¨æ»‘åŠ¨çª—å£
<span class="hljs-deletion">- Token: 145ï¼ˆæ•ˆç‡é«˜ï¼‰</span>
<span class="hljs-deletion">- è€—æ—¶: 0msï¼ˆæå¿«ï¼‰</span>
<span class="hljs-deletion">- æˆæœ¬: $0</span>
</code></pre>
<p><strong>é˜ˆå€¼è®¾ç½®çš„çŸ›ç›¾ï¼š</strong></p>
<ul>
<li>é˜ˆå€¼å¤ªä½ï¼ˆ5è½®ï¼‰â†’ çŸ­å¯¹è¯ä¹Ÿç”¨LLMï¼Œè´Ÿä¼˜åŒ–</li>
<li>é˜ˆå€¼å¤ªé«˜ï¼ˆ25è½®ï¼‰â†’ å¤§éƒ¨åˆ†å¯¹è¯ç”¨æ»‘åŠ¨çª—å£ï¼Œå¤±å»æ„ä¹‰</li>
<li><strong>æ¨èï¼š10-15è½®</strong> ä¹‹é—´å¹³è¡¡</li>
</ul>
<hr/>
<p><strong>æµ‹è¯•4ï¼šä¿¡æ¯ä¿ç•™å¯¹æ¯”ï¼ˆæ ¸å¿ƒä»·å€¼ï¼ï¼‰</strong></p>
<p>15è½®å¯¹è¯ï¼ŒåŒ…å«5ä¸ªå…³é”®ä¿¡æ¯ï¼šTomã€28å²ã€ä¸Šæµ·ã€æµ¦ä¸œã€AIå·¥ç¨‹å¸ˆ</p>




















<table><thead><tr><th>ç­–ç•¥</th><th>ä¿ç•™</th><th>è¯¦æƒ…</th></tr></thead><tbody><tr><td>æ»‘åŠ¨çª—å£ï¼ˆ5è½®ï¼‰</td><td><strong>0/5 = 0%</strong></td><td>âŒ å…¨éƒ¨ä¸¢å¤±ï¼šTom, 28å², ä¸Šæµ·, æµ¦ä¸œ, AIå·¥ç¨‹å¸ˆ</td></tr><tr><td><strong>æ··åˆç­–ç•¥ï¼ˆé˜ˆå€¼10è½®ï¼‰</strong></td><td><strong>5/5 = 100%</strong></td><td>âœ… å…¨éƒ¨ä¿ç•™ï¼šTom, 28å², ä¸Šæµ·, æµ¦ä¸œ, AIå·¥ç¨‹å¸ˆ</td></tr></tbody></table>
<p><strong>è¿™å°±æ˜¯æ··åˆç­–ç•¥å­˜åœ¨çš„æ„ä¹‰ï¼</strong></p>
<p>è™½ç„¶Tokenæ•ˆç‡å·®ï¼ˆ4-5å€ï¼‰ï¼Œä½†ï¼š</p>
<ul>
<li>âœ… ä¿ç•™äº†æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯</li>
<li>âœ… é¿å…äº†"AIå¤±å¿†"ä½“éªŒ</li>
<li>âœ… ç”¨æˆ·ä¸éœ€è¦é‡å¤ä¿¡æ¯</li>
</ul>
<p><strong>ç”¨æˆ·ä½“éªŒå¯¹æ¯”ï¼š</strong></p>
<pre><code class="hljs language-erlang" lang="erlang">åœºæ™¯ï¼š<span class="hljs-number">15</span>è½®å¯¹è¯åï¼Œç”¨æˆ·é—®<span class="hljs-string">"æ¨èé¤å…"</span>

æ»‘åŠ¨çª—å£ï¼ˆ<span class="hljs-number">0</span><span class="hljs-comment">%ä¿ç•™ï¼‰ï¼š</span>
ç”¨æˆ·ï¼š<span class="hljs-string">"æ¨èä¸€å®¶é€‚åˆæˆ‘çš„é¤å…"</span>
AIï¼š<span class="hljs-string">"ä½ æƒ³è¦ä»€ä¹ˆç±»å‹çš„é¤å…ï¼Ÿ"</span>
ç”¨æˆ·ï¼š<span class="hljs-string">"æˆ‘å‰é¢è¯´è¿‡äº†ï¼Œæˆ‘åœ¨ä¸Šæµ·æµ¦ä¸œ..."</span> âŒ 
      ï¼ˆç”¨æˆ·éœ€è¦é‡å¤ä¿¡æ¯ï¼Œä½“éªŒå·®ï¼‰

æ··åˆç­–ç•¥ï¼ˆ<span class="hljs-number">100</span><span class="hljs-comment">%ä¿ç•™ï¼‰ï¼š</span>
ç”¨æˆ·ï¼š<span class="hljs-string">"æ¨èä¸€å®¶é€‚åˆæˆ‘çš„é¤å…"</span>
AIï¼š<span class="hljs-string">"Tomï¼Œæ ¹æ®ä½ åœ¨ä¸Šæµ·æµ¦ä¸œå·¥ä½œï¼Œæ¨è..."</span> âœ…
      ï¼ˆæ— ç¼ä½“éªŒï¼Œè‡ªç„¶è¿è´¯ï¼‰
</code></pre>
<hr/>
<p><strong>æµ‹è¯•5ï¼šæˆæœ¬æ•ˆç›Šåˆ†æ</strong></p>
<p>æ¨¡æ‹Ÿ100æ¬¡éšæœºé•¿åº¦ï¼ˆ5-30è½®ï¼‰çš„å¯¹è¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ç»Ÿè®¡ç»“æœï¼š
- çŸ­å¯¹è¯ï¼ˆâ‰¤10è½®ï¼‰ï¼š20æ¬¡
- é•¿å¯¹è¯ï¼ˆ&gt;10è½®ï¼‰ï¼š80æ¬¡

æˆæœ¬å¯¹æ¯”ï¼š
- çº¯æ»‘åŠ¨çª—å£ï¼š<span class="hljs-variable">$0</span>.0000
- çº¯LLMæ‘˜è¦ï¼š<span class="hljs-variable">$0</span>.0100ï¼ˆ100æ¬¡ Ã— <span class="hljs-variable">$0</span>.0001ï¼‰
- æ··åˆç­–ç•¥ï¼š<span class="hljs-variable">$0</span>.0080ï¼ˆ80æ¬¡ Ã— <span class="hljs-variable">$0</span>.0001ï¼‰

æ··åˆç­–ç•¥ä¼˜åŠ¿ï¼š
- 20æ¬¡çŸ­å¯¹è¯ç”¨æ»‘åŠ¨çª—å£ï¼ˆå¿«é€Ÿ+<span class="hljs-variable">$0</span>ï¼‰
- 80æ¬¡é•¿å¯¹è¯ç”¨LLMæ‘˜è¦ï¼ˆæ™ºèƒ½+<span class="hljs-variable">$0</span>.0001ï¼‰
- vs çº¯LLMæ‘˜è¦ï¼šèŠ‚çœ 20%ï¼ˆ<span class="hljs-variable">$0</span>.002ï¼‰
- vs çº¯æ»‘åŠ¨çª—å£ï¼šå¤šèŠ± <span class="hljs-variable">$0</span>.008ï¼ˆæ¢å–ä¿¡æ¯ä¿ç•™ï¼‰
</code></pre>
<p><strong>æˆæœ¬åˆ†æï¼š</strong></p>
<ul>
<li>æ··åˆç­–ç•¥æ¯”çº¯LLMæ‘˜è¦ä¾¿å®œ20%</li>
<li>ä½†æ¯”çº¯æ»‘åŠ¨çª—å£è´µï¼ˆæ»‘åŠ¨çª—å£æ˜¯$0ï¼‰</li>
<li>è¿™$0.008æ¢æ¥çš„æ˜¯80æ¬¡é•¿å¯¹è¯çš„å®Œç¾ç”¨æˆ·ä½“éªŒ</li>
</ul>
<p>å®Œæ•´æµ‹è¯•ä»£ç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsotopelaez092-star%2Fmemory-chatbot%2Fblob%2Fmain%2Ftests%2Ftest_hybrid.py" target="_blank" title="https://github.com/sotopelaez092-star/memory-chatbot/blob/main/tests/test_hybrid.py" ref="nofollow noopener noreferrer">github.com/sotopelaez0â€¦</a></p>
<hr/>
<h4 data-id="heading-54"><strong>æ ¸å¿ƒçŸ›ç›¾ï¼šTokenæ•ˆç‡ vs ç”¨æˆ·ä½“éªŒ</strong></h4>
<p>æµ‹è¯•æ•°æ®æ­ç¤ºäº†æ··åˆç­–ç•¥çš„<strong>æœ¬è´¨æƒè¡¡</strong>ï¼š</p>
<p><strong>Tokenæ•ˆç‡æ’åï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> æ»‘åŠ¨çª—å£ï¼š145 tokensï¼ˆ74%å‹ç¼©ï¼‰â­
<span class="hljs-bullet">2.</span> LLMæ‘˜è¦ï¼š597 tokensï¼ˆ-7%ï¼‰
<span class="hljs-bullet">3.</span> æ··åˆç­–ç•¥ï¼š604 tokensï¼ˆ-8%ï¼‰

ç»“è®ºï¼šæ»‘åŠ¨çª—å£æœ€ä¼˜ï¼Œæ··åˆç­–ç•¥æœ€å·®
</code></pre>
<p><strong>ç”¨æˆ·ä½“éªŒæ’åï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> æ··åˆç­–ç•¥/LLMæ‘˜è¦ï¼š100%ä¿¡æ¯ä¿ç•™ â­
<span class="hljs-bullet">2.</span> æ»‘åŠ¨çª—å£ï¼š0%ä¿¡æ¯ä¿ç•™

ç»“è®ºï¼šæ··åˆç­–ç•¥/LLMæ‘˜è¦å®Œèƒœ
</code></pre>
<p><strong>é€Ÿåº¦æ’åï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> æ»‘åŠ¨çª—å£ï¼š0.00ms â­
<span class="hljs-bullet">2.</span> æ··åˆç­–ç•¥ï¼š11,663msï¼ˆæ…¢1,166ä¸‡å€ï¼‰
<span class="hljs-bullet">3.</span> LLMæ‘˜è¦ï¼š13,446ms

ç»“è®ºï¼šæ»‘åŠ¨çª—å£å®Œèƒœ
</code></pre>
<p><strong>æˆæœ¬æ’åï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">1. æ»‘åŠ¨çª—å£ï¼š<span class="hljs-variable">$0</span> â­
2. æ··åˆç­–ç•¥ï¼š<span class="hljs-variable">$0</span>.0001ï¼ˆè§†åœºæ™¯ï¼‰
3. LLMæ‘˜è¦ï¼š<span class="hljs-variable">$0</span>.0001

ç»“è®ºï¼šæ»‘åŠ¨çª—å£å®Œèƒœ
</code></pre>
<p><strong>æ··åˆç­–ç•¥åªåœ¨"ä¿¡æ¯ä¿ç•™"è¿™ä¸€ä¸ªç»´åº¦è·èƒœï¼Œå…¶ä»–å…¨è¾“ï¼</strong></p>
<p>ä½†è¿™æ­£æ˜¯å®ƒçš„ä»·å€¼å®šä½ï¼š<strong>å½“ç”¨æˆ·ä½“éªŒæ¯”ç³»ç»Ÿæ•ˆç‡æ›´é‡è¦æ—¶ï¼Œæ··åˆç­–ç•¥æ˜¯æœ€ä¼˜è§£ã€‚</strong></p>
<hr/>
<h4 data-id="heading-55"><strong>æ··åˆç­–ç•¥çš„çœŸå®å®šä½</strong></h4>
<p>åŸºäºæµ‹è¯•æ•°æ®ï¼Œæ··åˆç­–ç•¥çš„å®šä½åº”è¯¥æ˜¯ï¼š</p>
<p><strong>ä¸æ˜¯ä¸ºäº†ä¼˜åŒ–Tokenï¼Œè€Œæ˜¯ä¸ºäº†ä¼˜åŒ–ç”¨æˆ·ä½“éªŒã€‚</strong></p>
<pre><code class="hljs language-erlang" lang="erlang">æ ¸å¿ƒä»·å€¼ï¼š
âœ… çŸ­å¯¹è¯ï¼ˆ<span class="hljs-number">20</span><span class="hljs-comment">%ï¼‰ï¼šç”¨æ»‘åŠ¨çª—å£ï¼Œä¿æŒé€Ÿåº¦å’Œé›¶æˆæœ¬</span>
âœ… é•¿å¯¹è¯ï¼ˆ<span class="hljs-number">80</span><span class="hljs-comment">%ï¼‰ï¼šç”¨LLMæ‘˜è¦ï¼Œä¿ç•™ç”¨æˆ·ä¿¡æ¯</span>

ä»˜å‡ºä»£ä»·ï¼š
âŒ Tokenæ•ˆç‡å·®ï¼ˆé•¿å¯¹è¯æ—¶å¤šç”¨<span class="hljs-number">4</span>-<span class="hljs-number">5</span>å€ï¼‰
âŒ é€Ÿåº¦æ…¢ï¼ˆé•¿å¯¹è¯æ—¶éœ€è¦<span class="hljs-number">10</span>-<span class="hljs-number">15</span>ç§’ï¼‰
âŒ æœ‰æˆæœ¬ï¼ˆé•¿å¯¹è¯æ—¶$<span class="hljs-number">0.0001</span>/æ¬¡ï¼‰

é€‚ç”¨åœºæ™¯ï¼š
å½“<span class="hljs-string">"ä¸è®©ç”¨æˆ·é‡å¤ä¿¡æ¯"</span>æ¯”<span class="hljs-string">"èŠ‚çœToken"</span>æ›´é‡è¦æ—¶
</code></pre>
<hr/>
<h4 data-id="heading-56"><strong>ä¼˜ç¼ºç‚¹æ€»ç»“</strong></h4>
<p>åŸºäºçœŸå®æµ‹è¯•æ•°æ®ï¼š</p>
<p><strong>âœ… ä¸‰å¤§ä¼˜åŠ¿ï¼š</strong></p>
<ol>
<li><strong>è‡ªåŠ¨å†³ç­–ï¼Œæ— éœ€äººå·¥</strong></li>
</ol>

<pre><code class="hljs">ç³»ç»Ÿæ ¹æ®å¯¹è¯é•¿åº¦è‡ªåŠ¨é€‰æ‹©
å¼€å‘è€…æ— éœ€åˆ¤æ–­ï¼Œç”¨æˆ·æ— æ„ŸçŸ¥
</code></pre>
<ol>
<li><strong>çŸ­å¯¹è¯é›¶æŸå¤±</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">æµ‹è¯•éªŒè¯ï¼šçŸ­å¯¹è¯æ—¶å®Œå…¨ç­‰åŒäºæ»‘åŠ¨çª—å£
<span class="hljs-deletion">- Token: å®Œå…¨ç›¸åŒ</span>
<span class="hljs-deletion">- é€Ÿåº¦: å®Œå…¨ç›¸åŒ</span>
<span class="hljs-deletion">- æˆæœ¬: å®Œå…¨ç›¸åŒ</span>
</code></pre>
<ol>
<li><strong>é•¿å¯¹è¯ä¿ç•™ä¿¡æ¯</strong></li>
</ol>

<pre><code class="hljs language-erlang" lang="erlang">æµ‹è¯•æ•°æ®ï¼š<span class="hljs-number">100</span><span class="hljs-comment">%ä¿ç•™å…³é”®ä¿¡æ¯</span>
vs æ»‘åŠ¨çª—å£ï¼š<span class="hljs-number">0</span><span class="hljs-comment">%ä¿ç•™</span>
é¿å…ç”¨æˆ·é‡å¤è§£é‡Šï¼Œä½“éªŒæå‡æ˜æ˜¾
</code></pre>
<p><strong>âŒ ä¸‰å¤§åŠ£åŠ¿ï¼š</strong></p>
<ol>
<li><strong>Tokenæ•ˆç‡å·®</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">é•¿å¯¹è¯å®æµ‹ï¼š
<span class="hljs-deletion">- 20è½®ï¼šå¤šç”¨4.2å€Token</span>
<span class="hljs-deletion">- 30è½®ï¼šå¤šç”¨5.1å€Token</span>

é—®é¢˜ï¼šå¢åŠ äº†åç»­å¯¹è¯çš„æˆæœ¬
</code></pre>
<ol>
<li><strong>é€Ÿåº¦æ…¢</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">é•¿å¯¹è¯å®æµ‹ï¼š
<span class="hljs-deletion">- 20è½®ï¼š11,663msï¼ˆçº¦12ç§’ï¼‰</span>
<span class="hljs-deletion">- 30è½®ï¼š14,809msï¼ˆçº¦15ç§’ï¼‰</span>

é—®é¢˜ï¼šç”¨æˆ·éœ€è¦ç­‰å¾…ï¼Œå¯èƒ½å½±å“ä½“éªŒ
</code></pre>
<ol>
<li><strong>é˜ˆå€¼éš¾è°ƒä¼˜</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">æµ‹è¯•æ˜¾ç¤ºï¼š
<span class="hljs-deletion">- é˜ˆå€¼å¤ªä½ï¼ˆ5è½®ï¼‰ï¼šçŸ­å¯¹è¯ä¹Ÿç”¨LLMï¼Œè´Ÿä¼˜åŒ–</span>
<span class="hljs-deletion">- é˜ˆå€¼å¤ªé«˜ï¼ˆ25è½®ï¼‰ï¼šå¤§å¤šæ•°å¯¹è¯ç”¨æ»‘åŠ¨çª—å£ï¼Œå¤±å»æ„ä¹‰</span>
<span class="hljs-deletion">- æœ€ä½³é˜ˆå€¼ï¼š10-15è½®ï¼ˆä½†éœ€è¦æ ¹æ®åœºæ™¯è°ƒæ•´ï¼‰</span>

é—®é¢˜ï¼šæ²¡æœ‰é€šç”¨çš„"æœ€ä¼˜é˜ˆå€¼"
</code></pre>
<hr/>
<h4 data-id="heading-57"><strong>é€‚ç”¨åœºæ™¯æŒ‡å—</strong></h4>
<p>åŸºäºçœŸå®æµ‹è¯•æ•°æ®ï¼š</p>
<p><strong>âœ… æ¨èä½¿ç”¨ï¼š</strong></p>
<ol>
<li><strong>é€šç”¨å¯¹è¯äº§å“</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">åœºæ™¯ï¼šå¯¹è¯é•¿åº¦ä¸å¯é¢„æµ‹
ç†ç”±ï¼š
<span class="hljs-deletion">- è‡ªåŠ¨é€‚åº”ï¼Œæ— éœ€äººå·¥åˆ¤æ–­</span>
<span class="hljs-deletion">- çŸ­å¯¹è¯ä¿æŒé«˜æ•ˆ</span>
<span class="hljs-deletion">- é•¿å¯¹è¯ä¿ç•™ä¿¡æ¯</span>
<span class="hljs-deletion">- æµ‹è¯•è¯æ˜ï¼šèŠ‚çœ20%æˆæœ¬ vs çº¯LLM</span>

å…¸å‹ï¼šèŠå¤©åŠ©æ‰‹ã€å®¢æœæœºå™¨äººã€AIé¡¾é—®
</code></pre>
<ol>
<li><strong>ç”¨æˆ·ä½“éªŒä¼˜å…ˆ</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">åœºæ™¯ï¼šä»˜è´¹äº§å“ã€VIPæœåŠ¡
ç†ç”±ï¼š
<span class="hljs-deletion">- ç”¨æˆ·ä»˜è´¹ï¼ŒæœŸæœ›æ›´å¥½ä½“éªŒ</span>
<span class="hljs-deletion">- æ„¿æ„æ‰¿æ‹…é¢å¤–æˆæœ¬</span>
<span class="hljs-deletion">- "ä¸è®©ç”¨æˆ·é‡å¤"æ¯”"èŠ‚çœToken"é‡è¦</span>
<span class="hljs-deletion">- æµ‹è¯•è¯æ˜ï¼š100%ä¿¡æ¯ä¿ç•™</span>

å…¸å‹ï¼šé«˜ç«¯å®¢æœã€ä¸ªäººåŠ©ç†ã€æ•™è‚²è¾…å¯¼
</code></pre>
<ol>
<li><strong>å¯¹è¯é•¿åº¦ä¸¤æåˆ†åŒ–</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">åœºæ™¯ï¼šæ—¢æœ‰å¿«é€Ÿå’¨è¯¢ï¼Œåˆæœ‰æ·±åº¦è®¨è®º
ç†ç”±ï¼š
<span class="hljs-deletion">- æµ‹è¯•æ˜¾ç¤ºï¼š20%çŸ­å¯¹è¯+80%é•¿å¯¹è¯</span>
<span class="hljs-deletion">- æ··åˆç­–ç•¥é’ˆå¯¹æ€§ä¼˜åŒ–å„åœºæ™¯</span>
<span class="hljs-deletion">- æ¯”ä»»ä½•å•ä¸€ç­–ç•¥éƒ½å¥½</span>

å…¸å‹ï¼šç»¼åˆæœåŠ¡å¹³å°ã€å¤šåŠŸèƒ½åŠ©æ‰‹
</code></pre>
<p><strong>âŒ ä¸æ¨èä½¿ç”¨ï¼š</strong></p>
<ol>
<li><strong>æˆæœ¬æ•æ„Ÿåœºæ™¯</strong></li>
</ol>

<pre><code class="hljs language-bash" lang="bash">é—®é¢˜ï¼šæ··åˆç­–ç•¥æœ‰æˆæœ¬ï¼ˆè™½ç„¶æ¯”çº¯LLMä½20%ï¼‰
æ•°æ®ï¼š100æ¬¡å¯¹è¯<span class="hljs-variable">$0</span>.008 vs æ»‘åŠ¨çª—å£<span class="hljs-variable">$0</span>
æ›¿ä»£ï¼šçº¯æ»‘åŠ¨çª—å£

å…¸å‹ï¼šå¤§è§„æ¨¡å…è´¹äº§å“ã€åˆåˆ›å…¬å¸
</code></pre>
<ol>
<li><strong>å·²çŸ¥çŸ­å¯¹è¯åœºæ™¯</strong></li>
</ol>

<pre><code class="hljs">é—®é¢˜ï¼šå¦‚æœå¯¹è¯è‚¯å®š&lt;10è½®ï¼Œæ··åˆç­–ç•¥=æ»‘åŠ¨çª—å£
æ•°æ®ï¼šæµ‹è¯•è¯æ˜çŸ­å¯¹è¯æ—¶å®Œå…¨ç›¸åŒ
æ›¿ä»£ï¼šç›´æ¥ç”¨æ»‘åŠ¨çª—å£ï¼Œç³»ç»Ÿæ›´ç®€å•

å…¸å‹ï¼šFAQæœºå™¨äººã€å¿«é€ŸæŸ¥è¯¢
</code></pre>
<ol>
<li><strong>Tokené¢„ç®—ä¸¥æ ¼</strong></li>
</ol>

<pre><code class="hljs">é—®é¢˜ï¼šé•¿å¯¹è¯æ—¶Tokenæ•ˆç‡å·®
æ•°æ®ï¼šå¤šç”¨4-5å€Token
æ›¿ä»£ï¼šæ»‘åŠ¨çª—å£æˆ–TokenåŠ¨æ€ç­–ç•¥

å…¸å‹ï¼šä¸¥æ ¼æ§åˆ¶æˆæœ¬çš„ä¼ä¸šåº”ç”¨
</code></pre>
<ol>
<li><strong>å®æ—¶æ€§è¦æ±‚æé«˜</strong></li>
</ol>

<pre><code class="hljs">é—®é¢˜ï¼šé•¿å¯¹è¯æ—¶æœ‰10-15ç§’å»¶è¿Ÿ
æ•°æ®ï¼šå®æµ‹11,663ms vs æ»‘åŠ¨çª—å£0.00ms
æ›¿ä»£ï¼šçº¯æ»‘åŠ¨çª—å£

å…¸å‹ï¼šå®æ—¶å®¢æœã€æ¸¸æˆNPCã€è¯­éŸ³åŠ©æ‰‹
</code></pre>
<hr/>
<h4 data-id="heading-58"><strong>é˜ˆå€¼è°ƒä¼˜å»ºè®®</strong></h4>
<p>åŸºäºæµ‹è¯•æ•°æ®ï¼Œç»™å‡ºé˜ˆå€¼è®¾ç½®å»ºè®®ï¼š</p>
<p><strong>æ¨èé˜ˆå€¼ï¼š10è½®</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># é€šç”¨åœºæ™¯ï¼ˆæ¨èï¼‰</span>
compressor = HybridCompressor(llm, threshold_turns=<span class="hljs-number">10</span>)
</code></pre>
<p><strong>ç†ç”±ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">æµ‹è¯•æ•°æ®åˆ†æï¼š
<span class="hljs-deletion">- 5è½®ï¼šå¤ªä½ï¼ŒçŸ­å¯¹è¯ä¹Ÿç”¨LLMï¼ˆè´Ÿä¼˜åŒ–ï¼‰</span>
<span class="hljs-deletion">- 10è½®ï¼šå¹³è¡¡ï¼Œæµ‹è¯•æ˜¾ç¤º20%çŸ­å¯¹è¯+80%é•¿å¯¹è¯</span>
<span class="hljs-deletion">- 15è½®ï¼šåä¿å®ˆï¼Œæ›´å¤šå¯¹è¯ç”¨æ»‘åŠ¨çª—å£</span>
<span class="hljs-deletion">- 20è½®ï¼šå¤ªé«˜ï¼Œæµ‹è¯•æ—¶æ‰åˆšåˆ‡æ¢åˆ°LLM</span>
<span class="hljs-deletion">- 25è½®ï¼šè¿‡é«˜ï¼Œå‡ ä¹ä¸ç”¨LLMï¼Œå¤±å»æ„ä¹‰</span>

æœ€ä½³ï¼š10è½®
<span class="hljs-deletion">- çŸ­å¯¹è¯å®Œå…¨ä½¿ç”¨æ»‘åŠ¨çª—å£ï¼ˆé€Ÿåº¦+æˆæœ¬ï¼‰</span>
<span class="hljs-deletion">- é•¿å¯¹è¯åŠæ—¶åˆ‡æ¢åˆ°LLMï¼ˆä¿¡æ¯ä¿ç•™ï¼‰</span>
</code></pre>
<p><strong>æ ¹æ®åœºæ™¯è°ƒæ•´ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åå‘é€Ÿåº¦ï¼ˆæ›´å¤šç”¨æ»‘åŠ¨çª—å£ï¼‰</span>
compressor = HybridCompressor(llm, threshold_turns=<span class="hljs-number">15</span>)
<span class="hljs-comment"># é€‚ç”¨ï¼šæˆæœ¬æ•æ„Ÿã€é€Ÿåº¦ä¼˜å…ˆ</span>

<span class="hljs-comment"># åå‘ä¿¡æ¯ä¿ç•™ï¼ˆæ›´å¤šç”¨LLMï¼‰</span>
compressor = HybridCompressor(llm, threshold_turns=<span class="hljs-number">8</span>)
<span class="hljs-comment"># é€‚ç”¨ï¼šç”¨æˆ·ä½“éªŒä¼˜å…ˆã€ä»˜è´¹äº§å“</span>

<span class="hljs-comment"># æ¿€è¿›ä¿ç•™ï¼ˆå°½æ—©ç”¨LLMï¼‰</span>
compressor = HybridCompressor(llm, threshold_turns=<span class="hljs-number">5</span>)
<span class="hljs-comment"># é€‚ç”¨ï¼šé«˜ç«¯æœåŠ¡ã€ä¸ªæ€§åŒ–è¦æ±‚é«˜</span>
<span class="hljs-comment"># æ³¨æ„ï¼šçŸ­å¯¹è¯ä¹Ÿä¼šç”¨LLMï¼Œæˆæœ¬æ›´é«˜</span>
</code></pre>
<hr/>
<h4 data-id="heading-59"><strong>æœ€ä½³å®è·µ</strong></h4>
<p><strong>1. ç›‘æ§ç­–ç•¥ä½¿ç”¨æ¯”ä¾‹</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">HybridCompressor</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        self.stats = {
            <span class="hljs-string">"sliding_count"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-string">"llm_count"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-string">"sliding_tokens"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-string">"llm_tokens"</span>: <span class="hljs-number">0</span>
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages</span>):
        turn_count = <span class="hljs-built_in">len</span>(messages) // <span class="hljs-number">2</span>
        
        <span class="hljs-keyword">if</span> turn_count &lt;= self.threshold_turns:
            self.stats[<span class="hljs-string">"sliding_count"</span>] += <span class="hljs-number">1</span>
            result = self.sliding_window.compress(messages)
            self.stats[<span class="hljs-string">"sliding_tokens"</span>] += <span class="hljs-built_in">sum</span>(
                llm.count_tokens(m[<span class="hljs-string">'content'</span>]) <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> result
            )
        <span class="hljs-keyword">else</span>:
            self.stats[<span class="hljs-string">"llm_count"</span>] += <span class="hljs-number">1</span>
            result = self.llm_summary.compress(messages)
            self.stats[<span class="hljs-string">"llm_tokens"</span>] += <span class="hljs-built_in">sum</span>(
                llm.count_tokens(m[<span class="hljs-string">'content'</span>]) <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> result
            )
        
        <span class="hljs-keyword">return</span> result
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_stats</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""è·å–ä½¿ç”¨ç»Ÿè®¡"""</span>
        total = self.stats[<span class="hljs-string">"sliding_count"</span>] + self.stats[<span class="hljs-string">"llm_count"</span>]
        <span class="hljs-keyword">if</span> total == <span class="hljs-number">0</span>:
            <span class="hljs-keyword">return</span> {}
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">"sliding_ratio"</span>: self.stats[<span class="hljs-string">"sliding_count"</span>] / total,
            <span class="hljs-string">"llm_ratio"</span>: self.stats[<span class="hljs-string">"llm_count"</span>] / total,
            <span class="hljs-string">"avg_tokens_sliding"</span>: self.stats[<span class="hljs-string">"sliding_tokens"</span>] / self.stats[<span class="hljs-string">"sliding_count"</span>] <span class="hljs-keyword">if</span> self.stats[<span class="hljs-string">"sliding_count"</span>] &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>,
            <span class="hljs-string">"avg_tokens_llm"</span>: self.stats[<span class="hljs-string">"llm_tokens"</span>] / self.stats[<span class="hljs-string">"llm_count"</span>] <span class="hljs-keyword">if</span> self.stats[<span class="hljs-string">"llm_count"</span>] &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>
        }

<span class="hljs-comment"># å®šæœŸæ£€æŸ¥</span>
stats = compressor.get_stats()
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ»‘åŠ¨çª—å£ä½¿ç”¨ç‡: <span class="hljs-subst">{stats[<span class="hljs-string">'sliding_ratio'</span>]:<span class="hljs-number">.1</span>%}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"LLMæ‘˜è¦ä½¿ç”¨ç‡: <span class="hljs-subst">{stats[<span class="hljs-string">'llm_ratio'</span>]:<span class="hljs-number">.1</span>%}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¹³å‡Token (æ»‘åŠ¨çª—å£): <span class="hljs-subst">{stats[<span class="hljs-string">'avg_tokens_sliding'</span>]:<span class="hljs-number">.0</span>f}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¹³å‡Token (LLM): <span class="hljs-subst">{stats[<span class="hljs-string">'avg_tokens_llm'</span>]:<span class="hljs-number">.0</span>f}</span>"</span>)

<span class="hljs-comment"># æ ¹æ®ç»Ÿè®¡è°ƒæ•´é˜ˆå€¼</span>
<span class="hljs-keyword">if</span> stats[<span class="hljs-string">'llm_ratio'</span>] &gt; <span class="hljs-number">0.9</span>:
    <span class="hljs-comment"># 90%éƒ½åœ¨ç”¨LLMï¼Œé˜ˆå€¼å¤ªä½</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"å»ºè®®æé«˜é˜ˆå€¼åˆ°15è½®"</span>)
<span class="hljs-keyword">elif</span> stats[<span class="hljs-string">'llm_ratio'</span>] &lt; <span class="hljs-number">0.5</span>:
    <span class="hljs-comment"># åªæœ‰50%ç”¨LLMï¼Œå¯èƒ½é˜ˆå€¼å¤ªé«˜</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"å»ºè®®é™ä½é˜ˆå€¼åˆ°8è½®"</span>)
</code></pre>
<p><strong>2. A/Bæµ‹è¯•ä¸åŒé˜ˆå€¼</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¯¹ç…§ç»„ï¼šé˜ˆå€¼10è½®</span>
group_a = HybridCompressor(llm, threshold_turns=<span class="hljs-number">10</span>)

<span class="hljs-comment"># å®éªŒç»„ï¼šé˜ˆå€¼15è½®</span>
group_b = HybridCompressor(llm, threshold_turns=<span class="hljs-number">15</span>)

<span class="hljs-comment"># è§‚å¯ŸæŒ‡æ ‡ï¼š</span>
<span class="hljs-comment"># 1. ç”¨æˆ·æ»¡æ„åº¦ï¼ˆèƒ½å¦è®°ä½ä¿¡æ¯ï¼‰</span>
<span class="hljs-comment"># 2. æ€»Tokenæˆæœ¬</span>
<span class="hljs-comment"># 3. å¹³å‡å“åº”æ—¶é—´</span>
<span class="hljs-comment"># 4. ç”¨æˆ·é‡å¤ç‡ï¼ˆæ˜¯å¦é‡å¤è¯´è¿‡çš„è¯ï¼‰</span>

<span class="hljs-comment"># è¿è¡Œä¸€å‘¨åå¯¹æ¯”</span>
</code></pre>
<p><strong>3. é’ˆå¯¹ä¸åŒç”¨æˆ·ç±»å‹ä½¿ç”¨ä¸åŒé˜ˆå€¼</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AdaptiveHybridCompressor</span>:
    <span class="hljs-string">"""æ ¹æ®ç”¨æˆ·ç±»å‹åŠ¨æ€è°ƒæ•´é˜ˆå€¼"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, llm</span>):
        self.llm = llm
        self.user_thresholds = {}
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, user_id, messages</span>):
        <span class="hljs-comment"># è·å–ç”¨æˆ·ä¸“å±é˜ˆå€¼</span>
        threshold = self.get_user_threshold(user_id)
        
        compressor = HybridCompressor(self.llm, threshold_turns=threshold)
        <span class="hljs-keyword">return</span> compressor.compress(messages)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user_threshold</span>(<span class="hljs-params">self, user_id</span>):
        <span class="hljs-string">"""æ ¹æ®ç”¨æˆ·ç±»å‹è¿”å›é˜ˆå€¼"""</span>
        user_type = get_user_type(user_id)
        
        <span class="hljs-keyword">if</span> user_type == <span class="hljs-string">"vip"</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-number">8</span>  <span class="hljs-comment"># VIPç”¨æˆ·ï¼Œæ›´æ—©ç”¨LLM</span>
        <span class="hljs-keyword">elif</span> user_type == <span class="hljs-string">"free"</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-number">15</span>  <span class="hljs-comment"># å…è´¹ç”¨æˆ·ï¼Œæ›´å¤šç”¨æ»‘åŠ¨çª—å£</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-number">10</span>  <span class="hljs-comment"># æ™®é€šç”¨æˆ·ï¼Œæ ‡å‡†é˜ˆå€¼</span>
</code></pre>
<p><strong>4. æˆæœ¬æ§åˆ¶</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BudgetAwareCompressor</span>:
    <span class="hljs-string">"""æœ‰é¢„ç®—é™åˆ¶çš„æ··åˆç­–ç•¥"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, llm, daily_budget=<span class="hljs-number">10.0</span></span>):
        self.compressor = HybridCompressor(llm, threshold_turns=<span class="hljs-number">10</span>)
        self.daily_budget = daily_budget
        self.today_cost = <span class="hljs-number">0.0</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages</span>):
        turn_count = <span class="hljs-built_in">len</span>(messages) // <span class="hljs-number">2</span>
        
        <span class="hljs-comment"># æ£€æŸ¥é¢„ç®—</span>
        <span class="hljs-keyword">if</span> turn_count &gt; <span class="hljs-number">10</span>:  <span class="hljs-comment"># ä¼šä½¿ç”¨LLM</span>
            estimated_cost = <span class="hljs-number">0.0001</span>
            <span class="hljs-keyword">if</span> self.today_cost + estimated_cost &gt; self.daily_budget:
                <span class="hljs-comment"># é¢„ç®—ä¸è¶³ï¼Œå¼ºåˆ¶ä½¿ç”¨æ»‘åŠ¨çª—å£</span>
                logger.warning(<span class="hljs-string">"Daily budget exceeded, using sliding window"</span>)
                <span class="hljs-keyword">return</span> SlidingWindowCompressor(keep_turns=<span class="hljs-number">5</span>).compress(messages)
            
            self.today_cost += estimated_cost
        
        <span class="hljs-keyword">return</span> self.compressor.compress(messages)
</code></pre>
<hr/>
<h4 data-id="heading-60"><strong>å°ç»“</strong></h4>
<p>æ··åˆç­–ç•¥çš„çœŸå®è¡¨ç°ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">å®šä½ï¼š
ä¸æ˜¯æœ€å¿«çš„ï¼ˆæ»‘åŠ¨çª—å£æœ€å¿«ï¼‰
ä¸æ˜¯æœ€çœTokençš„ï¼ˆæ»‘åŠ¨çª—å£æœ€çœï¼‰
ä¸æ˜¯æœ€çœé’±çš„ï¼ˆæ»‘åŠ¨çª—å£$0ï¼‰

è€Œæ˜¯ï¼šåœ¨"ç”¨æˆ·ä½“éªŒ"å’Œ"ç³»ç»Ÿæ•ˆç‡"ä¹‹é—´çš„æ™ºèƒ½æƒè¡¡

æ ¸å¿ƒä»·å€¼ï¼š
âœ… çŸ­å¯¹è¯ï¼šå®Œå…¨ç­‰åŒäºæ»‘åŠ¨çª—å£ï¼ˆæµ‹è¯•éªŒè¯ï¼‰
âœ… é•¿å¯¹è¯ï¼š100%ä¿ç•™ç”¨æˆ·ä¿¡æ¯
âœ… è‡ªåŠ¨é€‚åº”ï¼šæ— éœ€äººå·¥åˆ¤æ–­
âœ… æˆæœ¬ä¼˜åŒ–ï¼šæ¯”çº¯LLMèŠ‚çœ20%

ä»˜å‡ºä»£ä»·ï¼š
âŒ Tokenæ•ˆç‡å·®ï¼ˆé•¿å¯¹è¯å¤šç”¨4-5å€ï¼‰
âŒ é€Ÿåº¦æ…¢ï¼ˆé•¿å¯¹è¯éœ€è¦10-15ç§’ï¼‰
âŒ ç³»ç»Ÿå¤æ‚åº¦å¢åŠ 
âŒ é˜ˆå€¼éœ€è¦è°ƒä¼˜

æœ€ä½³å®è·µï¼š
<span class="hljs-deletion">- æ¨èé˜ˆå€¼ï¼š10è½®</span>
<span class="hljs-deletion">- ç›‘æ§ä½¿ç”¨æ¯”ä¾‹</span>
<span class="hljs-deletion">- A/Bæµ‹è¯•ä¼˜åŒ–</span>
<span class="hljs-deletion">- æ ¹æ®ç”¨æˆ·ç±»å‹è°ƒæ•´</span>
</code></pre>
<p><strong>ç»“è®ºï¼šæ··åˆç­–ç•¥æ˜¯ç”Ÿäº§ç¯å¢ƒæœ€å®ç”¨çš„æ–¹æ¡ˆï¼Œé€‚åˆé€šç”¨å¯¹è¯åœºæ™¯ï¼Œä½†è¦ç†è§£å®ƒçš„trade-offã€‚</strong></p>
<hr/>
<h3 data-id="heading-61"><strong>3.5 ç­–ç•¥4ï¼šTokenåŠ¨æ€å‹ç¼©ï¼ˆToken-basedï¼‰</strong></h3>
<h4 data-id="heading-62"><strong>æ ¸å¿ƒåŸç†</strong></h4>
<p>TokenåŠ¨æ€å‹ç¼©æ˜¯ä¸€ç§<strong>ç²¾ç¡®æ§åˆ¶</strong>ç­–ç•¥ï¼šä¸æŒ‰è½®æ•°ï¼Œè€Œæ˜¯æŒ‰Tokené¢„ç®—ç²¾ç¡®å‹ç¼©ã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown">å·¥ä½œæµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è®¾å®šTokené¢„ç®—    â”‚
â”‚  (å¦‚200 tokens) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<span class="hljs-code">         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ä»åå¾€å‰ç´¯åŠ     â”‚
    â”‚ è®¡ç®—Tokenæ•°    â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ è¾¾åˆ°é¢„ç®—ï¼Ÿ      â”‚
    â”‚ æ˜¯ â†’ åœæ­¢      â”‚
    â”‚ å¦ â†’ ç»§ç»­æ·»åŠ    â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ è¿”å›å‹ç¼©ç»“æœ    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre>
<p><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong></p>
<pre><code class="hljs language-makefile" lang="makefile">ä¸å…³å¿ƒä¿ç•™<span class="hljs-string">"å‡ è½®"</span>
åªå…³å¿ƒä¿ç•™<span class="hljs-string">"å¤šå°‘Token"</span>

ä»æœ€æ–°æ¶ˆæ¯å¼€å§‹ç´¯åŠ ï¼š
<span class="hljs-section">msg_last:  15 tokens â†’ ç´¯è®¡ 15</span>
<span class="hljs-section">msg_last-1: 14 tokens â†’ ç´¯è®¡ 29</span>
<span class="hljs-section">msg_last-2: 13 tokens â†’ ç´¯è®¡ 42</span>
...
ç´¯è®¡è¾¾åˆ°200 â†’ åœæ­¢
</code></pre>
<p><strong>ä¸æ»‘åŠ¨çª—å£çš„æœ¬è´¨åŒºåˆ«ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">æ»‘åŠ¨çª—å£ï¼š
<span class="hljs-deletion">- ä¿ç•™å›ºå®š"æ¡æ•°"ï¼ˆå¦‚10æ¡ï¼‰</span>
<span class="hljs-deletion">- Tokenæ•°ä¸å¯æ§ï¼ˆå¯èƒ½100ï¼Œä¹Ÿå¯èƒ½200ï¼‰</span>

TokenåŠ¨æ€ï¼š
<span class="hljs-deletion">- ä¿ç•™å›ºå®š"Tokenæ•°"ï¼ˆå¦‚200ï¼‰</span>
<span class="hljs-deletion">- æ¶ˆæ¯æ¡æ•°ä¸å›ºå®šï¼ˆæ ¹æ®æ¯æ¡æ¶ˆæ¯é•¿åº¦ï¼‰</span>
</code></pre>
<h4 data-id="heading-63"><strong>ä»£ç å®ç°</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>, <span class="hljs-type">Callable</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">TokenBasedCompressor</span>:
    <span class="hljs-string">"""
    TokenåŠ¨æ€å‹ç¼©å™¨
    
    ç‰¹ç‚¹ï¼š
    - ç²¾ç¡®æ§åˆ¶Tokenæ•°é‡
    - å……åˆ†åˆ©ç”¨ä¸Šä¸‹æ–‡çª—å£
    - é€‚åº”æ¶ˆæ¯é•¿åº¦å·®å¼‚
    """</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, token_counter: <span class="hljs-type">Callable</span>, max_tokens: <span class="hljs-built_in">int</span> = <span class="hljs-number">200</span></span>):
        <span class="hljs-string">"""
        Args:
            token_counter: Tokenè®¡æ•°å‡½æ•°ï¼ˆå¦‚ llm.count_tokensï¼‰
            max_tokens: Tokené¢„ç®—
        """</span>
        self.token_counter = token_counter
        self.max_tokens = max_tokens
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages: <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]]</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-built_in">str</span>]]:
        <span class="hljs-string">"""
        å‹ç¼©åˆ°Tokené¢„ç®—å†…
        
        ç­–ç•¥ï¼š
        1. è®¡ç®—æ€»Tokenæ•°
        2. å¦‚æœè¶…é¢„ç®—ï¼Œä»æœ€æ—©çš„æ¶ˆæ¯å¼€å§‹åˆ é™¤
        3. ç›´åˆ°æ»¡è¶³é¢„ç®—
        
        Args:
            messages: åŸå§‹æ¶ˆæ¯åˆ—è¡¨
            
        Returns:
            å‹ç¼©åçš„æ¶ˆæ¯åˆ—è¡¨
        """</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> messages:
            <span class="hljs-keyword">return</span> messages
        
        <span class="hljs-comment"># è®¡ç®—å½“å‰æ€»Tokenæ•°</span>
        total_tokens = <span class="hljs-built_in">sum</span>(self.token_counter(m[<span class="hljs-string">'content'</span>]) <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> messages)
        
        <span class="hljs-comment"># å¦‚æœæ²¡è¶…é¢„ç®—ï¼Œç›´æ¥è¿”å›</span>
        <span class="hljs-keyword">if</span> total_tokens &lt;= self.max_tokens:
            <span class="hljs-keyword">return</span> messages
        
        <span class="hljs-comment"># ä»æœ€æ—©çš„æ¶ˆæ¯å¼€å§‹åˆ é™¤ï¼Œç›´åˆ°æ»¡è¶³é¢„ç®—</span>
        compressed = messages[:]
        current_tokens = total_tokens
        
        <span class="hljs-keyword">while</span> compressed <span class="hljs-keyword">and</span> current_tokens &gt; self.max_tokens:
            <span class="hljs-comment"># åˆ é™¤æœ€æ—©çš„æ¶ˆæ¯</span>
            removed = compressed.pop(<span class="hljs-number">0</span>)
            removed_tokens = self.token_counter(removed[<span class="hljs-string">'content'</span>])
            current_tokens -= removed_tokens
        
        <span class="hljs-keyword">return</span> compressed
</code></pre>
<p><strong>ä½¿ç”¨ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> src.llm.deepseek <span class="hljs-keyword">import</span> DeepSeekLLM

llm = DeepSeekLLM()
compressor = TokenBasedCompressor(llm.count_tokens, max_tokens=<span class="hljs-number">200</span>)

<span class="hljs-comment"># å‹ç¼©</span>
result = compressor.compress(messages)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‹ç¼©åˆ° <span class="hljs-subst">{<span class="hljs-built_in">sum</span>(llm.count_tokens(m[<span class="hljs-string">'content'</span>]) <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> result)}</span> tokens"</span>)
</code></pre>
<p>å®Œæ•´ä»£ç è§ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsotopelaez092-star%2Fmemory-chatbot%2Fblob%2Fmain%2Ftests%2Ftest_token_based.py" target="_blank" title="https://github.com/sotopelaez092-star/memory-chatbot/blob/main/tests/test_token_based.py" ref="nofollow noopener noreferrer">github.com/sotopelaez0â€¦</a></p>
<h4 data-id="heading-64"><strong>çœŸå®æ€§èƒ½æµ‹è¯•</strong></h4>
<p>æˆ‘ä»¬å¯¹TokenåŠ¨æ€å‹ç¼©å™¨è¿›è¡Œäº†å®Œæ•´æµ‹è¯•ï¼Œä»¥ä¸‹æ˜¯çœŸå®æ•°æ®ï¼š</p>
<hr/>
<p><strong>æµ‹è¯•1ï¼šTokenæ§åˆ¶ç²¾åº¦</strong></p>
<p>æµ‹è¯•ä¸åŒé¢„ç®—çš„ç²¾åº¦ï¼š</p>
<p><strong>é•¿å¯¹è¯ï¼ˆ20è½®ï¼Œ560 tokensï¼‰ï¼š</strong></p>








































<table><thead><tr><th>ç›®æ ‡Token</th><th>å®é™…Token</th><th>è¯¯å·®</th><th>æ¶ˆæ¯æ•°</th><th>å‹ç¼©ç‡</th></tr></thead><tbody><tr><td>100</td><td>86</td><td>14.0%</td><td>6æ¡</td><td>84.6%</td></tr><tr><td>200</td><td>193</td><td><strong>3.5%</strong> âœ…</td><td>13æ¡</td><td>65.5%</td></tr><tr><td>300</td><td>300</td><td><strong>0.0%</strong> âœ…</td><td>21æ¡</td><td>46.4%</td></tr><tr><td>500</td><td>488</td><td><strong>2.4%</strong> âœ…</td><td>36æ¡</td><td>12.9%</td></tr></tbody></table>
<p><strong>è¶…é•¿å¯¹è¯ï¼ˆ30è½®ï¼Œ933 tokensï¼‰ï¼š</strong></p>








































<table><thead><tr><th>ç›®æ ‡Token</th><th>å®é™…Token</th><th>è¯¯å·®</th><th>æ¶ˆæ¯æ•°</th><th>å‹ç¼©ç‡</th></tr></thead><tbody><tr><td>100</td><td>96</td><td><strong>4.0%</strong> âœ…</td><td>7æ¡</td><td>89.7%</td></tr><tr><td>200</td><td>191</td><td><strong>4.5%</strong> âœ…</td><td>13æ¡</td><td>79.5%</td></tr><tr><td>300</td><td>298</td><td><strong>0.7%</strong> âœ…</td><td>20æ¡</td><td>68.1%</td></tr><tr><td>500</td><td>484</td><td><strong>3.2%</strong> âœ…</td><td>34æ¡</td><td>48.1%</td></tr></tbody></table>
<p><strong>å…³é”®å‘ç°ï¼šç²¾åº¦ä¼˜ç§€ï¼</strong></p>
<pre><code class="hljs language-matlab" lang="matlab">è¯¯å·®åˆ†æï¼š
- ç›®æ ‡<span class="hljs-number">100</span>ï¼šè¯¯å·®<span class="hljs-number">4</span><span class="hljs-number">-14</span><span class="hljs-comment">%ï¼ˆé¢„ç®—å¤ªå°ï¼Œå•æ¡æ¶ˆæ¯å¯èƒ½&gt;10 tokensï¼‰</span>
- ç›®æ ‡<span class="hljs-number">200</span>ï¼šè¯¯å·®<span class="hljs-number">3.5</span><span class="hljs-number">-4.5</span><span class="hljs-comment">%ï¼ˆä¼˜ç§€ï¼‰</span>
- ç›®æ ‡<span class="hljs-number">300</span>ï¼šè¯¯å·®<span class="hljs-number">0</span><span class="hljs-number">-0.7</span><span class="hljs-comment">%ï¼ˆå®Œç¾ï¼‰</span>
- ç›®æ ‡<span class="hljs-number">500</span>ï¼šè¯¯å·®<span class="hljs-number">2.4</span><span class="hljs-number">-3.2</span><span class="hljs-comment">%ï¼ˆä¼˜ç§€ï¼‰</span>

ç»“è®ºï¼šé¢„ç®—â‰¥<span class="hljs-number">200</span>æ—¶ï¼Œè¯¯å·®&lt;<span class="hljs-number">5</span><span class="hljs-comment">%</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆæœ‰è¯¯å·®ï¼Ÿ</strong></p>
<pre><code class="hljs language-ini" lang="ini">åŸå› ï¼šæ¯æ¡æ¶ˆæ¯Tokenæ•°ä¸åŒ
- <span class="hljs-attr">"å—¯"</span> = <span class="hljs-number">1</span> token
- <span class="hljs-attr">"æˆ‘å«Tom"</span> = <span class="hljs-number">5</span> tokens
- <span class="hljs-attr">"è¯¦ç»†è§£é‡Š..."</span> = <span class="hljs-number">30</span> tokens

ä»åå¾€å‰ç´¯åŠ ï¼Œæ— æ³•ç²¾ç¡®å‡‘åˆ°ç›®æ ‡å€¼

ä¾‹å¦‚ï¼š
ç›®æ ‡200ï¼Œç´¯è®¡197æ—¶ï¼š
- ä¸‹ä¸€æ¡æ¶ˆæ¯15 tokens â†’ æ€»è®¡212ï¼ˆè¶…äº†ï¼‰
- åœåœ¨197 âœ“ï¼ˆè¯¯å·®3 tokensï¼‰
</code></pre>
<hr/>
<p><strong>æµ‹è¯•2ï¼šé€Ÿåº¦æµ‹è¯•</strong></p>
<pre><code class="hljs language-makefile" lang="makefile">æµ‹è¯•å¯¹è¯ï¼š20è½®ï¼ˆ42æ¡æ¶ˆæ¯ï¼‰

<span class="hljs-section">å‹ç¼©1æ¬¡:   0.55ms</span>
<span class="hljs-section">å‹ç¼©10æ¬¡:  3.27ms  (å¹³å‡0.33ms)</span>
<span class="hljs-section">å‹ç¼©50æ¬¡:  19.13ms (å¹³å‡0.38ms)</span>

å¹³å‡é€Ÿåº¦ï¼š0.38ms
</code></pre>
<p><strong>å¯¹æ¯”å…¶ä»–ç­–ç•¥ï¼š</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">TokenåŠ¨æ€: 0.38ms</span>
<span class="hljs-section">æ»‘åŠ¨çª—å£: 0.00ms</span>
<span class="hljs-section">LLMæ‘˜è¦:  11,000ms</span>

vs æ»‘åŠ¨çª—å£ï¼šæ…¢ï¼Œä½†ä»åœ¨1mså†… âœ…
vs LLMæ‘˜è¦ï¼šå¿« 29,000å€ï¼â­
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆæ¯”æ»‘åŠ¨çª—å£æ…¢ï¼Ÿ</strong></p>
<pre><code class="hljs language-scss" lang="scss">æ»‘åŠ¨çª—å£ï¼šçº¯æ•°ç»„åˆ‡ç‰‡ï¼Œ<span class="hljs-built_in">O</span>(<span class="hljs-number">1</span>)
messages<span class="hljs-selector-attr">[-10:]</span>  # æå¿«

TokenåŠ¨æ€ï¼šéœ€è¦é€æ¡è®¡ç®—Tokenï¼Œ<span class="hljs-built_in">O</span>(n)
for msg in messages:
    tokens += <span class="hljs-built_in">count_tokens</span>(msg[<span class="hljs-string">'content'</span>])
</code></pre>
<p><strong>ç»“è®ºï¼šè™½ç„¶æ¯”æ»‘åŠ¨çª—å£æ…¢ï¼Œä½†éƒ½åœ¨1mså†…ï¼Œå¯ä»¥å¿½ç•¥ã€‚</strong></p>
<hr/>
<p><strong>æµ‹è¯•3ï¼šå››ç§ç­–ç•¥å…¨é¢å¯¹æ¯”</strong></p>
<p>é…ç½®ï¼š</p>
<ul>
<li>TokenåŠ¨æ€ï¼šç›®æ ‡200 tokens</li>
<li>æ»‘åŠ¨çª—å£ï¼šä¿ç•™5è½®</li>
<li>LLMæ‘˜è¦ï¼šä¿ç•™3è½®+æ‘˜è¦</li>
<li>æ··åˆç­–ç•¥ï¼šé˜ˆå€¼10è½®ï¼Œä¿ç•™5è½®</li>
</ul>
<hr/>
<p><strong>åœºæ™¯1ï¼šçŸ­å¯¹è¯ï¼ˆ5è½®ï¼Œ126 tokensï¼‰</strong></p>













































<table><thead><tr><th>ç­–ç•¥</th><th>ç»“æœ</th><th>Token</th><th>å‹ç¼©ç‡</th><th>è€—æ—¶</th><th>æˆæœ¬</th></tr></thead><tbody><tr><td><strong>TokenåŠ¨æ€</strong></td><td>10æ¡</td><td><strong>126</strong></td><td>0%</td><td>0.06ms</td><td>$0</td></tr><tr><td><strong>æ»‘åŠ¨çª—å£</strong></td><td>10æ¡</td><td><strong>126</strong></td><td>0%</td><td>0.00ms</td><td>$0</td></tr><tr><td>æ··åˆç­–ç•¥</td><td>10æ¡</td><td>126</td><td>0%</td><td>0.01ms</td><td>$0</td></tr><tr><td>LLMæ‘˜è¦</td><td>7æ¡</td><td>292</td><td>-132% âŒ</td><td>7,151ms</td><td>$0.0001</td></tr></tbody></table>
<p><strong>å¯¹æ¯”åˆ†æï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">âœ… TokenåŠ¨æ€ vs æ»‘åŠ¨çª—å£ï¼šå®Œå…¨ç›¸åŒ
<span class="hljs-bullet">   -</span> åŸå› ï¼šå¯¹è¯å¤ªçŸ­ï¼Œéƒ½ä¸éœ€è¦å‹ç¼©
</code></pre>
<hr/>
<p><strong>åœºæ™¯2ï¼šä¸­ç­‰å¯¹è¯ï¼ˆ10è½®ï¼Œ249 tokensï¼‰</strong></p>













































<table><thead><tr><th>ç­–ç•¥</th><th>ç»“æœ</th><th>Token</th><th>å‹ç¼©ç‡</th><th>è€—æ—¶</th><th>æˆæœ¬</th></tr></thead><tbody><tr><td><strong>æ»‘åŠ¨çª—å£</strong></td><td>10æ¡</td><td><strong>123</strong> â­</td><td>51%</td><td>0.00ms</td><td>$0</td></tr><tr><td>TokenåŠ¨æ€</td><td>15æ¡</td><td>194</td><td>22%</td><td>0.23ms</td><td>$0</td></tr><tr><td>æ··åˆç­–ç•¥</td><td>10æ¡</td><td>123</td><td>51%</td><td>0.01ms</td><td>$0</td></tr><tr><td>LLMæ‘˜è¦</td><td>7æ¡</td><td>368</td><td>-48% âŒ</td><td>6,631ms</td><td>$0.0001</td></tr></tbody></table>
<p><strong>å¯¹æ¯”åˆ†æï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">âš ï¸ TokenåŠ¨æ€ vs æ»‘åŠ¨çª—å£ï¼šTokenå¤š71ä¸ªï¼ˆ58%æ›´å¤šï¼‰

åŸå› ï¼š
<span class="hljs-deletion">- æ»‘åŠ¨çª—å£ï¼šå›ºå®šä¿ç•™10æ¡ï¼ˆ123 tokensï¼‰</span>
<span class="hljs-deletion">- TokenåŠ¨æ€ï¼šä¿ç•™åˆ°200é¢„ç®—ï¼ˆ194 tokens, 15æ¡ï¼‰</span>

TokenåŠ¨æ€ä¿ç•™äº†æ›´å¤šæ¶ˆæ¯ï¼Œä½†ä¹Ÿç”¨äº†æ›´å¤šToken
</code></pre>
<p><strong>è¿™æ˜¯TokenåŠ¨æ€çš„æ ¸å¿ƒç‰¹ç‚¹ï¼šå……åˆ†åˆ©ç”¨é¢„ç®—ã€‚</strong></p>
<hr/>
<p><strong>åœºæ™¯3ï¼šé•¿å¯¹è¯ï¼ˆ20è½®ï¼Œ560 tokensï¼‰</strong></p>













































<table><thead><tr><th>ç­–ç•¥</th><th>ç»“æœ</th><th>Token</th><th>å‹ç¼©ç‡</th><th>è€—æ—¶</th><th>æˆæœ¬</th></tr></thead><tbody><tr><td><strong>æ»‘åŠ¨çª—å£</strong></td><td>10æ¡</td><td><strong>145</strong> â­</td><td>74%</td><td>0.00ms</td><td>$0</td></tr><tr><td>TokenåŠ¨æ€</td><td>13æ¡</td><td>193</td><td>66%</td><td>0.53ms</td><td>$0</td></tr><tr><td>æ··åˆç­–ç•¥</td><td>11æ¡</td><td>574</td><td>-3% âŒ</td><td>10,451ms</td><td>$0.0001</td></tr><tr><td>LLMæ‘˜è¦</td><td>7æ¡</td><td>547</td><td>2%</td><td>11,619ms</td><td>$0.0001</td></tr></tbody></table>
<p><strong>å¯¹æ¯”åˆ†æï¼š</strong></p>
<pre><code class="hljs language-erlang" lang="erlang">âš ï¸ TokenåŠ¨æ€ vs æ»‘åŠ¨çª—å£ï¼šTokenå¤š<span class="hljs-number">48</span>ä¸ªï¼ˆ<span class="hljs-number">33</span><span class="hljs-comment">%æ›´å¤šï¼‰</span>

åŸå› åŒä¸Šï¼šTokenåŠ¨æ€å°½é‡ç”¨æ»¡é¢„ç®—
</code></pre>
<hr/>
<p><strong>åœºæ™¯4ï¼šè¶…é•¿å¯¹è¯ï¼ˆ30è½®ï¼Œ933 tokensï¼‰</strong></p>













































<table><thead><tr><th>ç­–ç•¥</th><th>ç»“æœ</th><th>Token</th><th>å‹ç¼©ç‡</th><th>è€—æ—¶</th><th>æˆæœ¬</th></tr></thead><tbody><tr><td><strong>æ»‘åŠ¨çª—å£</strong></td><td>10æ¡</td><td><strong>144</strong> â­</td><td>85%</td><td>0.00ms</td><td>$0</td></tr><tr><td>TokenåŠ¨æ€</td><td>13æ¡</td><td>191</td><td>80%</td><td>1.24ms</td><td>$0</td></tr><tr><td>æ··åˆç­–ç•¥</td><td>11æ¡</td><td>689</td><td>26%</td><td>13,879ms</td><td>$0.0001</td></tr><tr><td>LLMæ‘˜è¦</td><td>7æ¡</td><td>621</td><td>33%</td><td>12,712ms</td><td>$0.0001</td></tr></tbody></table>
<p><strong>å¯¹æ¯”åˆ†æï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">âš ï¸ TokenåŠ¨æ€ vs æ»‘åŠ¨çª—å£ï¼šTokenå¤š47ä¸ªï¼ˆ33%æ›´å¤šï¼‰

ç»“è®ºï¼š
<span class="hljs-deletion">- Tokenæ•ˆç‡ï¼šæ»‘åŠ¨çª—å£æœ€ä¼˜</span>
<span class="hljs-deletion">- ä¿¡æ¯ä¿ç•™ï¼šTokenåŠ¨æ€æ›´å¤šï¼ˆ13æ¡ vs 10æ¡ï¼‰</span>
</code></pre>
<hr/>
<p><strong>æµ‹è¯•4ï¼šä¸åŒTokené¢„ç®—çš„æ•ˆæœ</strong></p>
<p>åœ¨20è½®å¯¹è¯ï¼ˆ560 tokensï¼‰ä¸­æµ‹è¯•ä¸åŒé¢„ç®—ï¼š</p>















































<table><thead><tr><th>Tokené¢„ç®—</th><th>å®é™…Token</th><th>æ¶ˆæ¯æ•°</th><th>å‹ç¼©ç‡</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>50</td><td>49</td><td>4æ¡</td><td>91.2%</td><td>æé™å‹ç¼©ï¼ˆä»…ä¿ç•™æœ€æ–°1-2æ¡ï¼‰</td></tr><tr><td>100</td><td>86</td><td>6æ¡</td><td>84.6%</td><td>ä¸¥æ ¼é™åˆ¶ï¼ˆçº¦2-3è½®ï¼‰</td></tr><tr><td><strong>200</strong></td><td><strong>193</strong></td><td><strong>13æ¡</strong></td><td><strong>65.5%</strong></td><td><strong>ä¸­ç­‰é™åˆ¶ï¼ˆçº¦5è½®ï¼‰</strong> â­</td></tr><tr><td>300</td><td>300</td><td>21æ¡</td><td>46.4%</td><td>å®½æ¾é™åˆ¶ï¼ˆçº¦8è½®ï¼‰</td></tr><tr><td>500</td><td>488</td><td>36æ¡</td><td>12.9%</td><td>åŸºæœ¬ä¸å‹ç¼©ï¼ˆçº¦15è½®ï¼‰</td></tr></tbody></table>
<p><strong>å…³é”®å‘ç°ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">é¢„ç®—è¶Šé«˜ï¼š
<span class="hljs-deletion">- Tokenè¶Šå¤š âœ…</span>
<span class="hljs-deletion">- æ¶ˆæ¯æ•°è¶Šå¤š âœ…</span>
<span class="hljs-deletion">- å‹ç¼©ç‡è¶Šä½ âœ…</span>
<span class="hljs-deletion">- ä¿¡æ¯ä¿ç•™è¶Šå¥½ âœ…</span>

æ¨èé¢„ç®—ï¼š200-300 tokens
<span class="hljs-deletion">- 200ï¼šçº¦5è½®ï¼Œé€‚åˆå¤§å¤šæ•°åœºæ™¯</span>
<span class="hljs-deletion">- 300ï¼šçº¦8è½®ï¼Œé€‚åˆä¿¡æ¯å¯†é›†åœºæ™¯</span>
</code></pre>
<hr/>
<p><strong>æµ‹è¯•5ï¼šä¿¡æ¯ä¿ç•™å¯¹æ¯”</strong></p>
<p>15è½®å¯¹è¯ï¼ŒåŒ…å«5ä¸ªå…³é”®ä¿¡æ¯ï¼šTomã€28å²ã€ä¸Šæµ·ã€æµ¦ä¸œã€AIå·¥ç¨‹å¸ˆ</p>

































<table><thead><tr><th>Tokené¢„ç®—</th><th>å®é™…Token</th><th>ä¿ç•™æ¶ˆæ¯</th><th>ä¿¡æ¯ä¿ç•™ç‡</th><th>è¯¦æƒ…</th></tr></thead><tbody><tr><td>100</td><td>92</td><td>27æ¡</td><td><strong>40%</strong> âŒ</td><td>âœ… æµ¦ä¸œ, AIå·¥ç¨‹å¸ˆ<br/>âŒ Tom, 28å², ä¸Šæµ·</td></tr><tr><td><strong>200</strong></td><td>113</td><td>30æ¡</td><td><strong>100%</strong> âœ…</td><td>âœ… å…¨éƒ¨ä¿ç•™</td></tr><tr><td>300</td><td>113</td><td>30æ¡</td><td><strong>100%</strong> âœ…</td><td>âœ… å…¨éƒ¨ä¿ç•™</td></tr></tbody></table>
<p><strong>å…³é”®å‘ç°ï¼š</strong></p>
<pre><code class="hljs language-erlang" lang="erlang">é¢„ç®—<span class="hljs-number">100</span>ï¼šåªä¿ç•™<span class="hljs-number">40</span><span class="hljs-comment">%ä¿¡æ¯ï¼ˆä¸¢å¤±å…³é”®èƒŒæ™¯ï¼‰</span>
é¢„ç®—<span class="hljs-number">200</span>ï¼šä¿ç•™<span class="hljs-number">100</span><span class="hljs-comment">%ä¿¡æ¯ï¼ˆå®Œç¾ï¼‰</span>

ä¸´ç•Œç‚¹ï¼šçº¦<span class="hljs-number">150</span>-<span class="hljs-number">200</span> tokens

å»ºè®®ï¼šé¢„ç®—â‰¥<span class="hljs-number">200</span>æ‰èƒ½ä¿è¯ä¿¡æ¯å®Œæ•´æ€§
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆé¢„ç®—200å’Œ300ç»“æœç›¸åŒï¼Ÿ</strong></p>
<pre><code class="hljs">åŸå› ï¼šè¿™ä¸ª15è½®å¯¹è¯æ€»å…±æ‰113 tokens

æ‰€ä»¥é¢„ç®—â‰¥113æ—¶ï¼Œéƒ½æ˜¯å…¨éƒ¨ä¿ç•™
</code></pre>
<hr/>
<p><strong>æµ‹è¯•6ï¼šè¾¹ç•Œæƒ…å†µ</strong></p>








































<table><thead><tr><th>åœºæ™¯</th><th>ç›®æ ‡Token</th><th>å®é™…Token</th><th>æ¶ˆæ¯æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>é¢„ç®—ä¸º0</td><td>0</td><td>0</td><td>0æ¡</td><td>è¿”å›ç©ºåˆ—è¡¨</td></tr><tr><td>é¢„ç®—æå°</td><td>10</td><td>0</td><td>0æ¡</td><td>å•æ¡æ¶ˆæ¯&gt;10ï¼Œæ— æ³•ä¿ç•™</td></tr><tr><td>é¢„ç®—=åŸå§‹</td><td>249</td><td>249</td><td>20æ¡</td><td>ä¿ç•™å…¨éƒ¨ âœ…</td></tr><tr><td>é¢„ç®—=2å€</td><td>498</td><td>249</td><td>20æ¡</td><td>ä¿ç•™å…¨éƒ¨ âœ…</td></tr></tbody></table>
<p><strong>æ½œåœ¨é—®é¢˜ï¼šé¢„ç®—å¤ªä½ä¼šè¿”å›ç©ºï¼</strong></p>
<pre><code class="hljs language-python" lang="python">é¢„ç®—<span class="hljs-number">10</span>ï¼Œä½†ç¬¬ä¸€æ¡æ¶ˆæ¯å°±<span class="hljs-number">15</span> tokens
â†’ æ— æ³•ä¿ç•™ä»»ä½•æ¶ˆæ¯
â†’ è¿”å›ç©ºåˆ—è¡¨ âš ï¸

å»ºè®®æ”¹è¿›ï¼šè‡³å°‘ä¿ç•™<span class="hljs-number">1</span>æ¡æœ€æ–°æ¶ˆæ¯
</code></pre>
<p>å®Œæ•´æµ‹è¯•ä»£ç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsotopelaez092-star%2Fmemory-chatbot%2Fblob%2Fmain%2Ftests%2Ftest_token_based.py" target="_blank" title="https://github.com/sotopelaez092-star/memory-chatbot/blob/main/tests/test_token_based.py" ref="nofollow noopener noreferrer">github.com/sotopelaez0â€¦</a></p>
<hr/>
<h4 data-id="heading-65"><strong>æ ¸å¿ƒçŸ›ç›¾ï¼šç²¾ç¡®æ§åˆ¶ vs ä¿¡æ¯ä¿ç•™</strong></h4>
<p>æµ‹è¯•æ•°æ®æ­ç¤ºäº†TokenåŠ¨æ€çš„<strong>æ ¸å¿ƒæƒè¡¡</strong>ï¼š</p>
<p><strong>Tokenæ•ˆç‡å¯¹æ¯”ï¼š</strong></p>
<pre><code class="hljs language-erlang" lang="erlang">åœºæ™¯ï¼š<span class="hljs-number">20</span>è½®å¯¹è¯ï¼Œ<span class="hljs-number">560</span> tokens

æ»‘åŠ¨çª—å£ï¼š<span class="hljs-number">145</span> tokensï¼ˆä¿ç•™<span class="hljs-number">10</span>æ¡ï¼‰â­
TokenåŠ¨æ€ï¼š<span class="hljs-number">193</span> tokensï¼ˆä¿ç•™<span class="hljs-number">13</span>æ¡ï¼Œé¢„ç®—<span class="hljs-number">200</span>ï¼‰

å·®è·ï¼š<span class="hljs-number">48</span> tokensï¼ˆ<span class="hljs-number">33</span><span class="hljs-comment">%æ›´å¤šï¼‰</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆTokenåŠ¨æ€ä¼šç”¨æ›´å¤šï¼Ÿ</strong></p>
<pre><code class="hljs language-diff" lang="diff">æ»‘åŠ¨çª—å£ç­–ç•¥ï¼š
<span class="hljs-deletion">- å›ºå®šä¿ç•™10æ¡ï¼ˆ5è½®ï¼‰</span>
<span class="hljs-deletion">- ä¸ç®¡Tokenæ•°</span>
<span class="hljs-deletion">- ç»“æœï¼š145 tokens</span>

TokenåŠ¨æ€ç­–ç•¥ï¼š
<span class="hljs-deletion">- å°½é‡ç”¨æ»¡200é¢„ç®—</span>
<span class="hljs-deletion">- ä¿ç•™13æ¡</span>
<span class="hljs-deletion">- ç»“æœï¼š193 tokens</span>

æ ¸å¿ƒå·®å¼‚ï¼š
<span class="hljs-deletion">- æ»‘åŠ¨çª—å£ï¼š"çœç€ç”¨"é¢„ç®—</span>
<span class="hljs-deletion">- TokenåŠ¨æ€ï¼š"ç”¨æ»¡"é¢„ç®—</span>
</code></pre>
<p><strong>è¿™ä¸æ˜¯bugï¼Œæ˜¯è®¾è®¡å·®å¼‚ï¼</strong></p>
<p><strong>ä¿¡æ¯ä¿ç•™å¯¹æ¯”ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">æ»‘åŠ¨çª—å£ï¼š
<span class="hljs-deletion">- 10æ¡æ¶ˆæ¯</span>
<span class="hljs-deletion">- å¯èƒ½ä¸¢å¤±æ—©æœŸå…³é”®ä¿¡æ¯ âŒ</span>

TokenåŠ¨æ€ï¼ˆé¢„ç®—200ï¼‰ï¼š
<span class="hljs-deletion">- 13æ¡æ¶ˆæ¯</span>
<span class="hljs-deletion">- ä¿ç•™æ›´å¤šå¯¹è¯å†å² âœ…</span>
</code></pre>
<p><strong>ç»“è®ºï¼šTokenåŠ¨æ€ç”¨æ›´å¤šTokenï¼Œä½†ä¿ç•™æ›´å¤šä¿¡æ¯ã€‚</strong></p>
<hr/>
<h4 data-id="heading-66"><strong>ä¼˜ç¼ºç‚¹æ€»ç»“</strong></h4>
<p>åŸºäºçœŸå®æµ‹è¯•æ•°æ®ï¼š</p>
<p><strong>âœ… å››å¤§ä¼˜åŠ¿ï¼š</strong></p>
<ol>
<li><strong>ç²¾ç¡®æ§åˆ¶Tokenæ•°</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">æµ‹è¯•æ•°æ®ï¼šè¯¯å·®&lt;5%ï¼ˆé¢„ç®—â‰¥200æ—¶ï¼‰
<span class="hljs-deletion">- ç›®æ ‡200 â†’ å®é™…193ï¼ˆè¯¯å·®3.5%ï¼‰</span>
<span class="hljs-deletion">- ç›®æ ‡300 â†’ å®é™…300ï¼ˆè¯¯å·®0%ï¼‰</span>

ä¼˜åŠ¿ï¼š
<span class="hljs-deletion">- å¯ä»¥ç²¾ç¡®è§„åˆ’æˆæœ¬</span>
<span class="hljs-deletion">- å……åˆ†åˆ©ç”¨ä¸Šä¸‹æ–‡çª—å£</span>
<span class="hljs-deletion">- ä¸æµªè´¹ä¹Ÿä¸è¶…æ”¯</span>
</code></pre>
<ol>
<li><strong>é€Ÿåº¦æå¿«</strong></li>
</ol>

<pre><code class="hljs">æµ‹è¯•æ•°æ®ï¼š0.38ms
vs æ»‘åŠ¨çª—å£ï¼š0.00msï¼ˆç•¥æ…¢ï¼‰
vs LLMæ‘˜è¦ï¼š11,000msï¼ˆå¿«29,000å€ï¼‰

ç»“è®ºï¼šè™½ç„¶æ¯”æ»‘åŠ¨çª—å£æ…¢ï¼Œä½†éƒ½åœ¨1mså†…
</code></pre>
<ol>
<li><strong>é›¶æˆæœ¬</strong></li>
</ol>

<pre><code class="hljs language-bash" lang="bash">æ— éœ€è°ƒç”¨LLM API
åªæ˜¯æœ¬åœ°Tokenè®¡æ•°
æˆæœ¬ï¼š<span class="hljs-variable">$0</span>
</code></pre>
<ol>
<li><strong>é€‚åº”æ¶ˆæ¯é•¿åº¦å·®å¼‚</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">åœºæ™¯ï¼šæ¶ˆæ¯é•¿åº¦ä¸ä¸€
<span class="hljs-deletion">- çŸ­æ¶ˆæ¯ï¼š"å—¯" = 1 token</span>
<span class="hljs-deletion">- é•¿æ¶ˆæ¯ï¼š"è¯¦ç»†è¯´æ˜..." = 50 tokens</span>

æ»‘åŠ¨çª—å£ï¼š
<span class="hljs-deletion">- ä¿ç•™10æ¡ï¼Œå¯èƒ½æ˜¯10 tokensï¼Œä¹Ÿå¯èƒ½500 tokens</span>
<span class="hljs-deletion">- ä¸å¯æ§ âŒ</span>

TokenåŠ¨æ€ï¼š
<span class="hljs-deletion">- ä¿ç•™åˆ°200 tokens</span>
<span class="hljs-deletion">- ç²¾ç¡®å¯æ§ âœ…</span>
</code></pre>
<p><strong>âŒ å››å¤§åŠ£åŠ¿ï¼š</strong></p>
<ol>
<li><strong>å¯èƒ½æ¯”æ»‘åŠ¨çª—å£ç”¨æ›´å¤šToken</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">å®æµ‹æ•°æ®ï¼š
<span class="hljs-deletion">- 10è½®å¯¹è¯ï¼šTokenåŠ¨æ€194 vs æ»‘åŠ¨çª—å£123ï¼ˆå¤š58%ï¼‰</span>
<span class="hljs-deletion">- 20è½®å¯¹è¯ï¼šTokenåŠ¨æ€193 vs æ»‘åŠ¨çª—å£145ï¼ˆå¤š33%ï¼‰</span>
<span class="hljs-deletion">- 30è½®å¯¹è¯ï¼šTokenåŠ¨æ€191 vs æ»‘åŠ¨çª—å£144ï¼ˆå¤š33%ï¼‰</span>

åŸå› ï¼šTokenåŠ¨æ€å°½é‡ç”¨æ»¡é¢„ç®—
</code></pre>
<ol>
<li><strong>ä¿¡æ¯ä¿ç•™å®Œå…¨ä¾èµ–é¢„ç®—</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">å®æµ‹æ•°æ®ï¼š
<span class="hljs-deletion">- é¢„ç®—100ï¼šä¿ç•™40%ä¿¡æ¯ âŒ</span>
<span class="hljs-deletion">- é¢„ç®—200ï¼šä¿ç•™100%ä¿¡æ¯ âœ…</span>

é£é™©ï¼š
<span class="hljs-deletion">- é¢„ç®—è®¾ç½®å¤ªä½ â†’ ä¸¢å¤±å…³é”®ä¿¡æ¯</span>
<span class="hljs-deletion">- é¢„ç®—è®¾ç½®å¤ªé«˜ â†’ æµªè´¹æˆæœ¬</span>
<span class="hljs-deletion">- æ²¡æœ‰"æœ€ä¼˜é¢„ç®—"ï¼Œéœ€è¦æ ¹æ®åœºæ™¯è°ƒæ•´</span>
</code></pre>
<ol>
<li><strong>é¢„ç®—å¤ªä½ä¼šè¿”å›ç©º</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">å®æµ‹æ•°æ®ï¼š
<span class="hljs-deletion">- é¢„ç®—10ï¼šè¿”å›0æ¡æ¶ˆæ¯ âŒ</span>
<span class="hljs-deletion">- åŸå› ï¼šç¬¬ä¸€æ¡æ¶ˆæ¯å°±&gt;10 tokens</span>

é—®é¢˜ï¼š
<span class="hljs-deletion">- ç”¨æˆ·å¯èƒ½å®Œå…¨çœ‹ä¸åˆ°å†å²</span>
<span class="hljs-deletion">- ä½“éªŒå¾ˆå·®</span>
</code></pre>
<ol>
<li><strong>éœ€è¦Tokenè®¡æ•°å™¨</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">ä¾èµ–ï¼šllm.count_tokens æ–¹æ³•

é—®é¢˜ï¼š
<span class="hljs-deletion">- å¢åŠ äº†è€¦åˆ</span>
<span class="hljs-deletion">- ä¸åŒLLMçš„Tokenè®¡æ•°å¯èƒ½ä¸åŒ</span>
<span class="hljs-deletion">- éœ€è¦é¢å¤–çš„å‡½æ•°è°ƒç”¨å¼€é”€</span>
</code></pre>
<hr/>
<h4 data-id="heading-67"><strong>é€‚ç”¨åœºæ™¯æŒ‡å—</strong></h4>
<p>åŸºäºçœŸå®æµ‹è¯•æ•°æ®ï¼š</p>
<p><strong>âœ… æ¨èä½¿ç”¨ï¼š</strong></p>
<ol>
<li><strong>æœ‰æ˜ç¡®Tokené¢„ç®—é™åˆ¶</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">åœºæ™¯ï¼šAPIæœ‰ä¸¥æ ¼Tokené™åˆ¶
ç†ç”±ï¼š
<span class="hljs-deletion">- å®æµ‹è¯¯å·®&lt;5%</span>
<span class="hljs-deletion">- å¯ä»¥ç²¾ç¡®æ§åˆ¶åœ¨é¢„ç®—å†…</span>
<span class="hljs-deletion">- é¿å…è¶…å‡ºé™åˆ¶æŠ¥é”™</span>

å…¸å‹ï¼š
<span class="hljs-deletion">- GPT-3.5ï¼ˆ4Ké™åˆ¶ï¼‰</span>
<span class="hljs-deletion">- é¢„ç®—ç´§å¼ çš„é¡¹ç›®</span>
<span class="hljs-deletion">- æŒ‰Tokenä»˜è´¹çš„åœºæ™¯</span>
</code></pre>
<ol>
<li><strong>æ¶ˆæ¯é•¿åº¦å·®å¼‚å¤§</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">åœºæ™¯ï¼šæ—¢æœ‰çŸ­æ¶ˆæ¯ï¼Œåˆæœ‰é•¿å›å¤
ç†ç”±ï¼š
<span class="hljs-deletion">- æ»‘åŠ¨çª—å£å›ºå®šæ¡æ•°ï¼ŒTokenä¸å¯æ§</span>
<span class="hljs-deletion">- TokenåŠ¨æ€ç²¾ç¡®æ§åˆ¶Tokenæ•°</span>

ä¾‹å­ï¼š
<span class="hljs-deletion">- å¯¹è¯1ï¼š10æ¡ Ã— 10 tokens = 100 tokens</span>
<span class="hljs-deletion">- å¯¹è¯2ï¼š10æ¡ Ã— 50 tokens = 500 tokens</span>
â†’ æ»‘åŠ¨çª—å£å·®å¼‚5å€ï¼ŒTokenåŠ¨æ€ç»Ÿä¸€200
</code></pre>
<ol>
<li><strong>éœ€è¦å……åˆ†åˆ©ç”¨ä¸Šä¸‹æ–‡çª—å£</strong></li>
</ol>

<pre><code class="hljs language-diff" lang="diff">åœºæ™¯ï¼šä¸Šä¸‹æ–‡çª—å£å®è´µï¼Œå¸Œæœ›ç”¨æ»¡
ç†ç”±ï¼š
<span class="hljs-deletion">- TokenåŠ¨æ€å°½é‡ç”¨æ»¡é¢„ç®—</span>
<span class="hljs-deletion">- å®æµ‹ï¼šä¿ç•™æ›´å¤šæ¶ˆæ¯ï¼ˆ13æ¡ vs 10æ¡ï¼‰</span>

å…¸å‹ï¼š
<span class="hljs-deletion">- å°æ¨¡å‹ï¼ˆä¸Šä¸‹æ–‡çª—å£å°ï¼‰</span>
<span class="hljs-deletion">- å¤æ‚ä»»åŠ¡ï¼ˆéœ€è¦æ›´å¤šå†å²ï¼‰</span>
</code></pre>
<p><strong>âŒ ä¸æ¨èä½¿ç”¨ï¼š</strong></p>
<ol>
<li><strong>è¿½æ±‚æœ€å°Tokenæ•°</strong></li>
</ol>

<pre><code class="hljs language-erlang" lang="erlang">é—®é¢˜ï¼šTokenåŠ¨æ€å¯èƒ½æ¯”æ»‘åŠ¨çª—å£å¤š<span class="hljs-number">33</span>-<span class="hljs-number">58</span><span class="hljs-comment">%</span>
æ•°æ®ï¼šå®æµ‹TokenåŠ¨æ€<span class="hljs-number">193</span> vs æ»‘åŠ¨çª—å£<span class="hljs-number">145</span>
æ›¿ä»£ï¼šç›´æ¥ç”¨æ»‘åŠ¨çª—å£

å…¸å‹ï¼šæˆæœ¬æ•æ„Ÿã€è¿½æ±‚æè‡´å‹ç¼©
</code></pre>
<ol>
<li><strong>å¯¹è¯é•¿åº¦ä¸€è‡´</strong></li>
</ol>

<pre><code class="hljs">é—®é¢˜ï¼šå¦‚æœæ¶ˆæ¯éƒ½å·®ä¸å¤šé•¿ï¼ŒTokenåŠ¨æ€ä¼˜åŠ¿ä¸æ˜æ˜¾
æ•°æ®ï¼šæ»‘åŠ¨çª—å£æ›´ç®€å•ã€æ›´å¿«
æ›¿ä»£ï¼šæ»‘åŠ¨çª—å£

å…¸å‹ï¼šFAQæœºå™¨äººï¼ˆæ¶ˆæ¯é•¿åº¦ç›¸ä¼¼ï¼‰
</code></pre>
<ol>
<li><strong>é¢„ç®—éš¾ä»¥ç¡®å®š</strong></li>
</ol>

<pre><code class="hljs language-erlang" lang="erlang">é—®é¢˜ï¼šé¢„ç®—å¤ªä½ä¸¢ä¿¡æ¯ï¼Œå¤ªé«˜æµªè´¹æˆæœ¬
æ•°æ®ï¼šå®æµ‹é¢„ç®—<span class="hljs-number">100</span>åªä¿ç•™<span class="hljs-number">40</span><span class="hljs-comment">%ä¿¡æ¯</span>
é£é™©ï¼šéœ€è¦åå¤è°ƒè¯•é¢„ç®—

æ›¿ä»£ï¼šæ»‘åŠ¨çª—å£ï¼ˆæ›´å¯é¢„æµ‹ï¼‰æˆ–æ··åˆç­–ç•¥
</code></pre>
<ol>
<li><strong>éœ€è¦ä¿ç•™ç”¨æˆ·ä¿¡æ¯</strong></li>
</ol>

<pre><code class="hljs language-arduino" lang="arduino">é—®é¢˜ï¼šTokenåŠ¨æ€ä¸æ™ºèƒ½ï¼ŒæŒ‰æ—¶é—´é¡ºåºåˆ é™¤
æ•°æ®ï¼šé¢„ç®—<span class="hljs-number">100</span>æ—¶ä¸¢å¤±<span class="hljs-string">"Tom"</span>ã€<span class="hljs-string">"28å²"</span>ç­‰å…³é”®ä¿¡æ¯
æ›¿ä»£ï¼šLLMæ‘˜è¦æˆ–æ··åˆç­–ç•¥

å…¸å‹ï¼šä¸ªæ€§åŒ–åŠ©æ‰‹ã€é•¿æœŸå¯¹è¯
</code></pre>
<hr/>
<h4 data-id="heading-68"><strong>é¢„ç®—è®¾ç½®å»ºè®®</strong></h4>
<p>åŸºäºæµ‹è¯•æ•°æ®ï¼š</p>
<p><strong>æ¨èé¢„ç®—ï¼š200-300 tokens</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ ‡å‡†åœºæ™¯ï¼ˆæ¨èï¼‰</span>
compressor = TokenBasedCompressor(llm.count_tokens, max_tokens=<span class="hljs-number">200</span>)
<span class="hljs-comment"># çº¦5è½®ï¼Œä¿ç•™100%ä¿¡æ¯</span>

<span class="hljs-comment"># å®½æ¾åœºæ™¯</span>
compressor = TokenBasedCompressor(llm.count_tokens, max_tokens=<span class="hljs-number">300</span>)
<span class="hljs-comment"># çº¦8è½®ï¼Œä¿¡æ¯å……è¶³</span>

<span class="hljs-comment"># ä¸¥æ ¼é™åˆ¶</span>
compressor = TokenBasedCompressor(llm.count_tokens, max_tokens=<span class="hljs-number">100</span>)
<span class="hljs-comment"># çº¦2-3è½®ï¼Œå¯èƒ½ä¸¢å¤±ä¿¡æ¯ âš ï¸</span>
</code></pre>
<p><strong>é¢„ç®—è®¡ç®—å…¬å¼ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ ¹æ®æœŸæœ›ä¿ç•™è½®æ•°ä¼°ç®—</span>
expected_turns = <span class="hljs-number">5</span>  <span class="hljs-comment"># æœŸæœ›ä¿ç•™5è½®</span>
avg_tokens_per_turn = <span class="hljs-number">40</span>  <span class="hljs-comment"># å¹³å‡æ¯è½®40 tokens</span>
budget = expected_turns * avg_tokens_per_turn  <span class="hljs-comment"># 200 tokens</span>

<span class="hljs-comment"># æ ¹æ®ä¸Šä¸‹æ–‡çª—å£ä¼°ç®—</span>
context_window = <span class="hljs-number">4000</span>  <span class="hljs-comment"># æ¨¡å‹ä¸Šä¸‹æ–‡çª—å£</span>
system_prompt = <span class="hljs-number">100</span>  <span class="hljs-comment"># ç³»ç»Ÿæç¤º</span>
response_budget = <span class="hljs-number">500</span>  <span class="hljs-comment"># é¢„ç•™ç»™å›å¤</span>
budget = context_window - system_prompt - response_budget  <span class="hljs-comment"># 3400 tokens</span>
</code></pre>
<p><strong>åŠ¨æ€è°ƒæ•´ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AdaptiveTokenCompressor</span>:
    <span class="hljs-string">"""æ ¹æ®å¯¹è¯é•¿åº¦åŠ¨æ€è°ƒæ•´é¢„ç®—"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, llm</span>):
        self.llm = llm
        self.base_budget = <span class="hljs-number">200</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages</span>):
        <span class="hljs-comment"># è®¡ç®—å½“å‰Tokenæ•°</span>
        total_tokens = <span class="hljs-built_in">sum</span>(self.llm.count_tokens(m[<span class="hljs-string">'content'</span>]) <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> messages)
        
        <span class="hljs-comment"># åŠ¨æ€è°ƒæ•´é¢„ç®—</span>
        <span class="hljs-keyword">if</span> total_tokens &lt; <span class="hljs-number">200</span>:
            budget = total_tokens  <span class="hljs-comment"># ä¸å‹ç¼©</span>
        <span class="hljs-keyword">elif</span> total_tokens &lt; <span class="hljs-number">500</span>:
            budget = <span class="hljs-number">200</span>  <span class="hljs-comment"># æ ‡å‡†å‹ç¼©</span>
        <span class="hljs-keyword">else</span>:
            budget = <span class="hljs-number">300</span>  <span class="hljs-comment"># å®½æ¾å‹ç¼©ï¼ˆä¿¡æ¯å¤šï¼‰</span>
        
        compressor = TokenBasedCompressor(self.llm.count_tokens, max_tokens=budget)
        <span class="hljs-keyword">return</span> compressor.compress(messages)
</code></pre>
<hr/>
<h4 data-id="heading-69"><strong>æœ€ä½³å®è·µ</strong></h4>
<p><strong>1. è®¾ç½®æœ€å°ä¿æŠ¤</strong></p>
<p>ä¿®å¤"é¢„ç®—å¤ªä½è¿”å›ç©º"çš„é—®é¢˜ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TokenBasedCompressor</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages</span>):
        <span class="hljs-comment"># ... åŸæœ‰é€»è¾‘ ...</span>
        
        <span class="hljs-comment"># æœ€å°ä¿æŠ¤ï¼šè‡³å°‘ä¿ç•™1æ¡æœ€æ–°æ¶ˆæ¯</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> compressed <span class="hljs-keyword">and</span> messages:
            compressed = [messages[-<span class="hljs-number">1</span>]]
        
        <span class="hljs-keyword">return</span> compressed
</code></pre>
<p><strong>2. ç›‘æ§å®é™…ä½¿ç”¨æƒ…å†µ</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TokenBasedCompressor</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, token_counter, max_tokens=<span class="hljs-number">200</span></span>):
        self.token_counter = token_counter
        self.max_tokens = max_tokens
        self.stats = {
            <span class="hljs-string">"total_compressions"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-string">"total_original_tokens"</span>: <span class="hljs-number">0</span>,
            <span class="hljs-string">"total_compressed_tokens"</span>: <span class="hljs-number">0</span>
        }
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages</span>):
        result = self._do_compress(messages)
        
        <span class="hljs-comment"># ç»Ÿè®¡</span>
        self.stats[<span class="hljs-string">"total_compressions"</span>] += <span class="hljs-number">1</span>
        self.stats[<span class="hljs-string">"total_original_tokens"</span>] += <span class="hljs-built_in">sum</span>(self.token_counter(m[<span class="hljs-string">'content'</span>]) <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> messages)
        self.stats[<span class="hljs-string">"total_compressed_tokens"</span>] += <span class="hljs-built_in">sum</span>(self.token_counter(m[<span class="hljs-string">'content'</span>]) <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> result)
        
        <span class="hljs-keyword">return</span> result
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_stats</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""è·å–ç»Ÿè®¡æ•°æ®"""</span>
        avg_original = self.stats[<span class="hljs-string">"total_original_tokens"</span>] / self.stats[<span class="hljs-string">"total_compressions"</span>]
        avg_compressed = self.stats[<span class="hljs-string">"total_compressed_tokens"</span>] / self.stats[<span class="hljs-string">"total_compressions"</span>]
        avg_rate = <span class="hljs-number">1</span> - avg_compressed / avg_original
        
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">"avg_original_tokens"</span>: avg_original,
            <span class="hljs-string">"avg_compressed_tokens"</span>: avg_compressed,
            <span class="hljs-string">"avg_compression_rate"</span>: avg_rate
        }
</code></pre>
<p><strong>3. ä¸æ»‘åŠ¨çª—å£ç»„åˆ</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">HybridTokenCompressor</span>:
    <span class="hljs-string">"""TokenåŠ¨æ€ + æ»‘åŠ¨çª—å£ç»„åˆ"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, llm, max_tokens=<span class="hljs-number">200</span>, max_turns=<span class="hljs-number">10</span></span>):
        self.token_compressor = TokenBasedCompressor(llm.count_tokens, max_tokens)
        self.sliding_compressor = SlidingWindowCompressor(keep_turns=max_turns)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages</span>):
        <span class="hljs-comment"># å…ˆç”¨TokenåŠ¨æ€</span>
        result = self.token_compressor.compress(messages)
        
        <span class="hljs-comment"># å†ç”¨æ»‘åŠ¨çª—å£ï¼ˆåŒé‡ä¿é™©ï¼‰</span>
        result = self.sliding_compressor.compress(result)
        
        <span class="hljs-keyword">return</span> result
</code></pre>
<hr/>
<h4 data-id="heading-70"><strong>å°ç»“</strong></h4>
<p>TokenåŠ¨æ€å‹ç¼©å™¨çš„çœŸå®è¡¨ç°ï¼š</p>
<pre><code class="hljs language-diff" lang="diff">æ ¸å¿ƒä¼˜åŠ¿ï¼š
âœ… ç²¾ç¡®æ§åˆ¶Tokenï¼ˆè¯¯å·®&lt;5%ï¼‰
âœ… é€Ÿåº¦æå¿«ï¼ˆ0.38msï¼‰
âœ… é›¶æˆæœ¬ï¼ˆ$0ï¼‰
âœ… å……åˆ†åˆ©ç”¨é¢„ç®—

æ ¸å¿ƒåŠ£åŠ¿ï¼š
âŒ å¯èƒ½æ¯”æ»‘åŠ¨çª—å£å¤šç”¨33-58% Token
âŒ ä¿¡æ¯ä¿ç•™å®Œå…¨ä¾èµ–é¢„ç®—è®¾ç½®
âŒ é¢„ç®—å¤ªä½ä¼šè¿”å›ç©º
âŒ ä¸å¦‚LLMæ‘˜è¦æ™ºèƒ½

å®šä½ï¼š
ç²¾ç¡®æ§åˆ¶Tokenæ•°çš„å·¥å…·
é€‚åˆæœ‰æ˜ç¡®é¢„ç®—é™åˆ¶çš„åœºæ™¯
ä¸é€‚åˆè¿½æ±‚æè‡´å‹ç¼©æˆ–æ™ºèƒ½ä¿ç•™

æœ€ä½³å®è·µï¼š
<span class="hljs-deletion">- æ¨èé¢„ç®—ï¼š200-300 tokens</span>
<span class="hljs-deletion">- ç›‘æ§å®é™…ä½¿ç”¨æƒ…å†µ</span>
<span class="hljs-deletion">- è®¾ç½®æœ€å°ä¿æŠ¤ï¼ˆè‡³å°‘1æ¡ï¼‰</span>
<span class="hljs-deletion">- æ ¹æ®åœºæ™¯åŠ¨æ€è°ƒæ•´</span>
</code></pre>
<p><strong>ç»“è®ºï¼šTokenåŠ¨æ€æ˜¯ç²¾ç¡®æ§åˆ¶Tokençš„æœ€ä½³æ–¹æ¡ˆï¼Œä½†è¦ç†è§£å®ƒçš„æƒè¡¡ - ç”¨æ›´å¤šTokenæ¢å–æ›´ç²¾ç¡®çš„æ§åˆ¶ã€‚</strong></p>
<hr/>
<h3 data-id="heading-71"><strong>3.6 å››ç§ç­–ç•¥æ€»ç»“å¯¹æ¯”</strong></h3>
<p>ç»è¿‡å®Œæ•´çš„æµ‹è¯•ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥å…¨é¢å¯¹æ¯”4ç§å‹ç¼©ç­–ç•¥ã€‚</p>
<h4 data-id="heading-72"><strong>æ ¸å¿ƒæ•°æ®å¯¹æ¯”</strong></h4>
<p>åŸºäºçœŸå®æµ‹è¯•æ•°æ®ï¼ˆé•¿å¯¹è¯åœºæ™¯ï¼š20è½®ï¼Œ560 tokensï¼‰ï¼š</p>






















































<table><thead><tr><th>ç»´åº¦</th><th>æ»‘åŠ¨çª—å£</th><th>LLMæ‘˜è¦</th><th>æ··åˆç­–ç•¥</th><th>TokenåŠ¨æ€</th></tr></thead><tbody><tr><td><strong>å‹ç¼©åToken</strong></td><td><strong>145</strong> â­</td><td>597 âŒ</td><td>604 âŒ</td><td>193</td></tr><tr><td><strong>Tokenå‹ç¼©ç‡</strong></td><td><strong>74%</strong> â­</td><td>-7% âŒ</td><td>-8% âŒ</td><td>66%</td></tr><tr><td><strong>é€Ÿåº¦</strong></td><td><strong>0.00ms</strong> â­</td><td>13,446ms âŒ</td><td>11,663ms âŒ</td><td><strong>0.53ms</strong></td></tr><tr><td><strong>æˆæœ¬</strong></td><td><strong>$0</strong> â­</td><td>$0.0001</td><td>$0.0001</td><td><strong>$0</strong> â­</td></tr><tr><td><strong>ä¿¡æ¯ä¿ç•™</strong></td><td>0% âŒ</td><td><strong>100%</strong> â­</td><td><strong>100%</strong> â­</td><td>ä¾èµ–é¢„ç®—</td></tr><tr><td><strong>ä»£ç å¤æ‚åº¦</strong></td><td>æç®€ â­</td><td>ä¸­ç­‰</td><td>é«˜</td><td>ä½</td></tr></tbody></table>
<p><strong>å…³é”®å‘ç°ï¼šæ²¡æœ‰ä»»ä½•ç­–ç•¥åœ¨æ‰€æœ‰ç»´åº¦éƒ½æœ€ä¼˜ï¼</strong></p>
<hr/>
<h4 data-id="heading-73"><strong>è¯¦ç»†å¯¹æ¯”è¡¨</strong></h4>
<p><strong>1. æ€§èƒ½æŒ‡æ ‡å¯¹æ¯”</strong></p>








































<table><thead><tr><th>ç­–ç•¥</th><th>çŸ­å¯¹è¯(5è½®)</th><th>ä¸­ç­‰å¯¹è¯(10è½®)</th><th>é•¿å¯¹è¯(20è½®)</th><th>è¶…é•¿å¯¹è¯(30è½®)</th></tr></thead><tbody><tr><td><strong>æ»‘åŠ¨çª—å£</strong></td><td>126â†’126 (0%)</td><td>249â†’123 (51%)</td><td>560â†’145 (74%)</td><td>933â†’144 (85%)</td></tr><tr><td><strong>LLMæ‘˜è¦</strong></td><td>126â†’303 (-141%)</td><td>249â†’388 (-56%)</td><td>560â†’597 (-7%)</td><td>933â†’621 (33%)</td></tr><tr><td><strong>æ··åˆç­–ç•¥</strong></td><td>126â†’126 (0%)</td><td>249â†’123 (51%)</td><td>560â†’604 (-8%)</td><td>933â†’689 (26%)</td></tr><tr><td><strong>TokenåŠ¨æ€</strong></td><td>126â†’126 (0%)</td><td>249â†’194 (22%)</td><td>560â†’193 (66%)</td><td>933â†’191 (80%)</td></tr></tbody></table>
<p><strong>ç»“è®ºåˆ†æï¼š</strong></p>
<pre><code class="hljs language-erlang" lang="erlang">çŸ­å¯¹è¯ï¼ˆâ‰¤<span class="hljs-number">5</span>è½®ï¼‰ï¼š
âœ… æ»‘åŠ¨çª—å£ = TokenåŠ¨æ€ = æ··åˆç­–ç•¥
âŒ LLMæ‘˜è¦ï¼ˆè´Ÿä¼˜åŒ–ï¼ŒTokenåå¢ï¼‰

ä¸­ç­‰å¯¹è¯ï¼ˆ<span class="hljs-number">10</span>è½®ï¼‰ï¼š
âœ… æ»‘åŠ¨çª—å£ = æ··åˆç­–ç•¥ï¼ˆ<span class="hljs-number">51</span><span class="hljs-comment">%å‹ç¼©ï¼‰</span>
â­• TokenåŠ¨æ€ï¼ˆ<span class="hljs-number">22</span><span class="hljs-comment">%å‹ç¼©ï¼‰</span>
âŒ LLMæ‘˜è¦ï¼ˆè´Ÿä¼˜åŒ–ï¼‰

é•¿å¯¹è¯ï¼ˆâ‰¥<span class="hljs-number">20</span>è½®ï¼‰ï¼š
âœ… æ»‘åŠ¨çª—å£ï¼ˆ<span class="hljs-number">70</span>-<span class="hljs-number">85</span><span class="hljs-comment">%å‹ç¼©ï¼‰â­</span>
â­• TokenåŠ¨æ€ï¼ˆ<span class="hljs-number">66</span>-<span class="hljs-number">80</span><span class="hljs-comment">%å‹ç¼©ï¼‰</span>
âŒ LLMæ‘˜è¦ã€æ··åˆç­–ç•¥ï¼ˆè´Ÿä¼˜åŒ–æˆ–ä½å‹ç¼©ï¼‰
</code></pre>
<hr/>
<p><strong>2. é€Ÿåº¦å¯¹æ¯”</strong></p>








































<table><thead><tr><th>ç­–ç•¥</th><th>çŸ­å¯¹è¯</th><th>ä¸­ç­‰å¯¹è¯</th><th>é•¿å¯¹è¯</th><th>è¶…é•¿å¯¹è¯</th></tr></thead><tbody><tr><td><strong>æ»‘åŠ¨çª—å£</strong></td><td>0.00ms</td><td>0.00ms</td><td>0.00ms</td><td>0.01ms</td></tr><tr><td><strong>LLMæ‘˜è¦</strong></td><td>7,471ms</td><td>7,992ms</td><td>13,446ms</td><td>13,204ms</td></tr><tr><td><strong>æ··åˆç­–ç•¥</strong></td><td>0.01ms</td><td>0.01ms</td><td>11,663ms</td><td>14,809ms</td></tr><tr><td><strong>TokenåŠ¨æ€</strong></td><td>0.06ms</td><td>0.23ms</td><td>0.53ms</td><td>1.24ms</td></tr></tbody></table>
<p><strong>é€Ÿåº¦æ’åï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> æ»‘åŠ¨çª—å£ï¼š0.00msï¼ˆåŸºå‡†ï¼‰
<span class="hljs-bullet">2.</span> TokenåŠ¨æ€ï¼š0.38msï¼ˆæ…¢ï¼Œä½†&lt;1msï¼‰
<span class="hljs-bullet">3.</span> LLMæ‘˜è¦ï¼š11,000msï¼ˆæ…¢29,000å€ï¼‰
<span class="hljs-bullet">4.</span> æ··åˆç­–ç•¥ï¼šè§†åœºæ™¯ï¼ˆçŸ­å¯¹è¯0msï¼Œé•¿å¯¹è¯11,000msï¼‰
</code></pre>
<hr/>
<p><strong>3. æˆæœ¬å¯¹æ¯”</strong></p>








































<table><thead><tr><th>åœºæ™¯</th><th>æ»‘åŠ¨çª—å£</th><th>LLMæ‘˜è¦</th><th>æ··åˆç­–ç•¥</th><th>TokenåŠ¨æ€</th></tr></thead><tbody><tr><td>å•æ¬¡å‹ç¼©</td><td>$0</td><td>$0.0001</td><td>$0-0.0001</td><td>$0</td></tr><tr><td>100æ¬¡å¯¹è¯</td><td>$0</td><td>$0.01</td><td>$0.008</td><td>$0</td></tr><tr><td>æ—¥æ´»10ä¸‡</td><td>$0/å¤©</td><td>$10/å¤©</td><td>$8/å¤©</td><td>$0/å¤©</td></tr><tr><td>å¹´æˆæœ¬</td><td><strong>$0</strong></td><td>$3,600</td><td>$2,880</td><td><strong>$0</strong></td></tr></tbody></table>
<p><strong>æˆæœ¬æ’åï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> æ»‘åŠ¨çª—å£ã€TokenåŠ¨æ€ï¼š$0 â­
<span class="hljs-bullet">2.</span> æ··åˆç­–ç•¥ï¼šèŠ‚çœ20% vs çº¯LLM
<span class="hljs-bullet">3.</span> LLMæ‘˜è¦ï¼šæœ€è´µ
</code></pre>
<hr/>
<p><strong>4. ä¿¡æ¯ä¿ç•™å¯¹æ¯”</strong></p>
<p>æµ‹è¯•åœºæ™¯ï¼š15è½®å¯¹è¯ï¼Œ5ä¸ªå…³é”®ä¿¡æ¯ï¼ˆTomã€28å²ã€ä¸Šæµ·ã€æµ¦ä¸œã€AIå·¥ç¨‹å¸ˆï¼‰</p>



































<table><thead><tr><th>ç­–ç•¥</th><th>ä¿ç•™ç‡</th><th>è¯¦æƒ…</th></tr></thead><tbody><tr><td><strong>æ»‘åŠ¨çª—å£</strong></td><td><strong>0%</strong> âŒ</td><td>å…¨éƒ¨ä¸¢å¤±</td></tr><tr><td><strong>LLMæ‘˜è¦</strong></td><td><strong>100%</strong> âœ…</td><td>å…¨éƒ¨ä¿ç•™</td></tr><tr><td><strong>æ··åˆç­–ç•¥</strong></td><td><strong>100%</strong> âœ…</td><td>å…¨éƒ¨ä¿ç•™ï¼ˆé•¿å¯¹è¯æ—¶ï¼‰</td></tr><tr><td><strong>TokenåŠ¨æ€(é¢„ç®—100)</strong></td><td><strong>40%</strong> âš ï¸</td><td>ä»…ä¿ç•™éƒ¨åˆ†</td></tr><tr><td><strong>TokenåŠ¨æ€(é¢„ç®—200)</strong></td><td><strong>100%</strong> âœ…</td><td>å…¨éƒ¨ä¿ç•™</td></tr></tbody></table>
<p><strong>ä¿¡æ¯ä¿ç•™æ’åï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> LLMæ‘˜è¦ã€æ··åˆç­–ç•¥ï¼š100%ï¼ˆæ™ºèƒ½æå–ï¼‰
<span class="hljs-bullet">2.</span> TokenåŠ¨æ€ï¼šä¾èµ–é¢„ç®—ï¼ˆ100â†’40%, 200â†’100%ï¼‰
<span class="hljs-bullet">3.</span> æ»‘åŠ¨çª—å£ï¼š0%ï¼ˆæœºæ¢°åˆ é™¤ï¼‰
</code></pre>
<hr/>
<p><strong>5. å¤æ‚åº¦å¯¹æ¯”</strong></p>








































<table><thead><tr><th>ç­–ç•¥</th><th>ä»£ç è¡Œæ•°</th><th>é…ç½®é¡¹</th><th>è°ƒä¼˜éš¾åº¦</th><th>ä¾èµ–</th></tr></thead><tbody><tr><td><strong>æ»‘åŠ¨çª—å£</strong></td><td>~10è¡Œ</td><td>1ä¸ªï¼ˆè½®æ•°ï¼‰</td><td>ç®€å• â­</td><td>æ— </td></tr><tr><td><strong>TokenåŠ¨æ€</strong></td><td>~15è¡Œ</td><td>1ä¸ªï¼ˆé¢„ç®—ï¼‰</td><td>ä¸­ç­‰</td><td>Tokenè®¡æ•°å™¨</td></tr><tr><td><strong>LLMæ‘˜è¦</strong></td><td>~30è¡Œ</td><td>2ä¸ªï¼ˆè½®æ•°ã€Promptï¼‰</td><td>ä¸­ç­‰</td><td>LLM API</td></tr><tr><td><strong>æ··åˆç­–ç•¥</strong></td><td>~50è¡Œ</td><td>2ä¸ªï¼ˆé˜ˆå€¼ã€è½®æ•°ï¼‰</td><td>å›°éš¾ âŒ</td><td>ä»¥ä¸Šå…¨éƒ¨</td></tr></tbody></table>
<p><strong>å¤æ‚åº¦æ’åï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> æ»‘åŠ¨çª—å£ï¼šæœ€ç®€å•ï¼ˆ3è¡Œæ ¸å¿ƒä»£ç ï¼‰
<span class="hljs-bullet">2.</span> TokenåŠ¨æ€ï¼šç®€å•ï¼ˆéœ€è®¾ç½®é¢„ç®—ï¼‰
<span class="hljs-bullet">3.</span> LLMæ‘˜è¦ï¼šä¸­ç­‰ï¼ˆéœ€Promptå·¥ç¨‹ï¼‰
<span class="hljs-bullet">4.</span> æ··åˆç­–ç•¥ï¼šå¤æ‚ï¼ˆéœ€è°ƒé˜ˆå€¼ï¼Œä¾èµ–å¤šï¼‰
</code></pre>
<hr/>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e28c2d793bc041ff9fa03fa13ca6c485~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQWdlbnRCdWlsZGVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765471478&amp;x-signature=mtXb74A12azpkLLGDKb5bvcDu00%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-74"><strong>ä¼˜ç¼ºç‚¹çŸ©é˜µ</strong></h4>



































<table><thead><tr><th>ç­–ç•¥</th><th>âœ… æ ¸å¿ƒä¼˜åŠ¿</th><th>âŒ æ ¸å¿ƒåŠ£åŠ¿</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>æ»‘åŠ¨çª—å£</strong></td><td>â€¢ Tokenæœ€å°‘<br/>â€¢ é€Ÿåº¦æœ€å¿«<br/>â€¢ é›¶æˆæœ¬<br/>â€¢ æç®€å®ç°</td><td>â€¢ ä¸¢å¤±æ‰€æœ‰æ—©æœŸä¿¡æ¯<br/>â€¢ ä¸æ™ºèƒ½</td><td>çŸ­å¯¹è¯ã€æˆæœ¬æ•æ„Ÿã€å®æ—¶åœºæ™¯</td></tr><tr><td><strong>LLMæ‘˜è¦</strong></td><td>â€¢ 100%ä¿¡æ¯ä¿ç•™<br/>â€¢ æ™ºèƒ½æå–</td><td>â€¢ çŸ­å¯¹è¯è´Ÿä¼˜åŒ–<br/>â€¢ é€Ÿåº¦ææ…¢<br/>â€¢ æœ‰æˆæœ¬<br/>â€¢ åªåœ¨è¶…é•¿å¯¹è¯æœ‰æ•ˆ</td><td>è¶…é•¿å¯¹è¯ï¼ˆâ‰¥30è½®ï¼‰+ éœ€ä¿ç•™ä¿¡æ¯</td></tr><tr><td><strong>æ··åˆç­–ç•¥</strong></td><td>â€¢ çŸ­å¯¹è¯=æ»‘åŠ¨çª—å£<br/>â€¢ é•¿å¯¹è¯ä¿ç•™ä¿¡æ¯<br/>â€¢ è‡ªåŠ¨åˆ‡æ¢</td><td>â€¢ é•¿å¯¹è¯Tokenå¤š4-5å€<br/>â€¢ é€Ÿåº¦æ…¢<br/>â€¢ æœ‰æˆæœ¬<br/>â€¢ é˜ˆå€¼éš¾è°ƒ</td><td>é€šç”¨åœºæ™¯ã€ç”¨æˆ·ä½“éªŒä¼˜å…ˆ</td></tr><tr><td><strong>TokenåŠ¨æ€</strong></td><td>â€¢ ç²¾ç¡®æ§åˆ¶Token<br/>â€¢ é€Ÿåº¦å¿«<br/>â€¢ é›¶æˆæœ¬<br/>â€¢ å……åˆ†åˆ©ç”¨é¢„ç®—</td><td>â€¢ Tokenæ¯”æ»‘åŠ¨çª—å£å¤š33%<br/>â€¢ ä¿¡æ¯ä¿ç•™é é¢„ç®—<br/>â€¢ é¢„ç®—éš¾è®¾ç½®</td><td>æœ‰æ˜ç¡®Tokené™åˆ¶ã€æ¶ˆæ¯é•¿åº¦å·®å¼‚å¤§</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-75"><strong>åœºæ™¯æ¨èå†³ç­–æ ‘</strong></h4>
<pre><code class="hljs language-erlang" lang="erlang">å¼€å§‹
 â”‚
 â”œâ”€ å¯¹è¯é•¿åº¦æ˜¯å¦â‰¤<span class="hljs-number">10</span>è½®ï¼Ÿ
 â”‚   â”œâ”€ æ˜¯ â†’ ã€æ»‘åŠ¨çª—å£ã€‘
 â”‚   â”‚        ç†ç”±ï¼šç®€å•ã€å¿«é€Ÿã€é›¶æˆæœ¬
 â”‚   â”‚
 â”‚   â””â”€ å¦ â†’ æ˜¯å¦éœ€è¦ä¿ç•™ç”¨æˆ·ä¿¡æ¯ï¼Ÿ
 â”‚       â”œâ”€ å¦ â†’ ã€æ»‘åŠ¨çª—å£ã€‘
 â”‚       â”‚        ç†ç”±ï¼šTokenæ•ˆç‡æœ€é«˜
 â”‚       â”‚
 â”‚       â””â”€ æ˜¯ â†’ æœ‰Tokené¢„ç®—é™åˆ¶å—ï¼Ÿ
 â”‚           â”œâ”€ æœ‰ â†’ ã€TokenåŠ¨æ€ã€‘
 â”‚           â”‚        ç†ç”±ï¼šç²¾ç¡®æ§åˆ¶é¢„ç®—
 â”‚           â”‚
 â”‚           â””â”€ æ—  â†’ æ˜¯å¦æˆæœ¬æ•æ„Ÿï¼Ÿ
 â”‚               â”œâ”€ æ˜¯ â†’ ã€æ··åˆç­–ç•¥ã€‘
 â”‚               â”‚        ç†ç”±ï¼šæ¯”çº¯LLMçœ<span class="hljs-number">20</span><span class="hljs-comment">%</span>
 â”‚               â”‚
 â”‚               â””â”€ å¦ â†’ å¯¹è¯æ˜¯å¦â‰¥<span class="hljs-number">30</span>è½®ï¼Ÿ
 â”‚                   â”œâ”€ æ˜¯ â†’ ã€LLMæ‘˜è¦ã€‘
 â”‚                   â”‚        ç†ç”±ï¼šå”¯ä¸€æ­£æ”¶ç›Šåœºæ™¯
 â”‚                   â”‚
 â”‚                   â””â”€ å¦ â†’ ã€æ··åˆç­–ç•¥ã€‘
 â”‚                            ç†ç”±ï¼šè‡ªåŠ¨é€‚åº”é•¿åº¦
</code></pre>
<hr/>
<h4 data-id="heading-76"><strong>åˆ†åœºæ™¯è¯¦ç»†æ¨è</strong></h4>
<p><strong>åœºæ™¯1ï¼šFAQæœºå™¨äºº / å¿«é€Ÿé—®ç­”</strong></p>
<pre><code class="hljs language-diff" lang="diff">ç‰¹å¾ï¼š
<span class="hljs-deletion">- å¯¹è¯ï¼š3-5è½®</span>
<span class="hljs-deletion">- æ¶ˆæ¯ï¼šç®€çŸ­</span>
<span class="hljs-deletion">- éœ€æ±‚ï¼šå¿«é€Ÿå“åº”</span>

æ¨èï¼šæ»‘åŠ¨çª—å£ â­â­â­â­â­
ç†ç”±ï¼š
âœ… å¯¹è¯çŸ­ï¼Œä¸ä¼šä¸¢å¤±ä¿¡æ¯
âœ… é€Ÿåº¦æœ€å¿«
âœ… é›¶æˆæœ¬
âœ… æœ€ç®€å•

é…ç½®ï¼š
compressor = SlidingWindowCompressor(keep_turns=5)
</code></pre>
<hr/>
<p><strong>åœºæ™¯2ï¼šå®¢æœæœºå™¨äºº / é€šç”¨åŠ©æ‰‹</strong></p>
<pre><code class="hljs language-ini" lang="ini">ç‰¹å¾ï¼š
- å¯¹è¯ï¼š5-20è½®ä¸ç­‰
- ç”¨æˆ·ï¼šéœ€è¦è®°ä½èƒŒæ™¯
- éœ€æ±‚ï¼šä½“éªŒ &gt; æˆæœ¬

æ¨èï¼šæ··åˆç­–ç•¥ â­â­â­â­
ç†ç”±ï¼š
âœ… çŸ­å¯¹è¯å¿«é€Ÿå¤„ç†
âœ… é•¿å¯¹è¯ä¿ç•™ä¿¡æ¯
âœ… è‡ªåŠ¨é€‚åº”
âœ… æ¯”çº¯LLMçœ20%æˆæœ¬

é…ç½®ï¼š
<span class="hljs-attr">compressor</span> = HybridCompressor(
    llm,
    <span class="hljs-attr">threshold_turns</span>=<span class="hljs-number">10</span>,
    <span class="hljs-attr">keep_recent_turns</span>=<span class="hljs-number">5</span>
)
</code></pre>
<hr/>
<p><strong>åœºæ™¯3ï¼šå¿ƒç†å’¨è¯¢ / æ·±åº¦å¯¹è¯</strong></p>
<pre><code class="hljs language-ini" lang="ini">ç‰¹å¾ï¼š
- å¯¹è¯ï¼š30-50è½®
- ä¿¡æ¯ï¼šå¯†é›†ã€é‡è¦
- éœ€æ±‚ï¼šå¿…é¡»è®°ä½æ‰€æœ‰èƒŒæ™¯

æ¨èï¼šLLMæ‘˜è¦ â­â­â­â­
ç†ç”±ï¼š
âœ… 100%ä¿¡æ¯ä¿ç•™
âœ… æ™ºèƒ½æå–å…³é”®ä¿¡æ¯
âœ… è¶…é•¿å¯¹è¯æœ‰æ­£æ”¶ç›Šï¼ˆ33%å‹ç¼©ï¼‰

é…ç½®ï¼š
<span class="hljs-attr">compressor</span> = LLMSummaryCompressor(
    llm,
    <span class="hljs-attr">keep_recent_turns</span>=<span class="hljs-number">3</span>
)
</code></pre>
<hr/>
<p><strong>åœºæ™¯4ï¼šAPIç½‘å…³ / Tokenä¸¥æ ¼é™åˆ¶</strong></p>
<pre><code class="hljs language-ini" lang="ini">ç‰¹å¾ï¼š
- ä¸Šä¸‹æ–‡ï¼š4Ké™åˆ¶
- æ¶ˆæ¯ï¼šé•¿åº¦ä¸ä¸€
- éœ€æ±‚ï¼šç²¾ç¡®æ§åˆ¶Token

æ¨èï¼šTokenåŠ¨æ€ â­â­â­â­â­
ç†ç”±ï¼š
âœ… ç²¾ç¡®æ§åˆ¶ï¼ˆè¯¯å·®&lt;5%ï¼‰
âœ… å……åˆ†åˆ©ç”¨ä¸Šä¸‹æ–‡
âœ… é€Ÿåº¦å¿«
âœ… é›¶æˆæœ¬

é…ç½®ï¼š
<span class="hljs-attr">compressor</span> = TokenBasedCompressor(
    llm.count_tokens,
    <span class="hljs-attr">max_tokens</span>=<span class="hljs-number">200</span>
)
</code></pre>
<hr/>
<p><strong>åœºæ™¯5ï¼šå¤§è§„æ¨¡å…è´¹äº§å“</strong></p>
<pre><code class="hljs language-diff" lang="diff">ç‰¹å¾ï¼š
<span class="hljs-deletion">- ç”¨æˆ·ï¼šç™¾ä¸‡çº§</span>
<span class="hljs-deletion">- é¢„ç®—ï¼šæåº¦æ•æ„Ÿ</span>
<span class="hljs-deletion">- éœ€æ±‚ï¼šæˆæœ¬æœ€ä½</span>

æ¨èï¼šæ»‘åŠ¨çª—å£ â­â­â­â­â­
ç†ç”±ï¼š
âœ… é›¶æˆæœ¬
âœ… æœ€å¿«
âœ… Tokenæœ€å°‘
âœ… å¯æ‰©å±•æ€§æœ€å¼º

é…ç½®ï¼š
compressor = SlidingWindowCompressor(keep_turns=3)
# ä¿ç•™æ›´å°‘è½®æ•°ï¼Œè¿›ä¸€æ­¥é™ä½æˆæœ¬
</code></pre>
<hr/>
<p><strong>åœºæ™¯6ï¼šé«˜ç«¯VIPæœåŠ¡</strong></p>
<pre><code class="hljs language-ini" lang="ini">ç‰¹å¾ï¼š
- ç”¨æˆ·ï¼šä»˜è´¹ç”¨æˆ·
- éœ€æ±‚ï¼šå®Œç¾ä½“éªŒ
- é¢„ç®—ï¼šå……è¶³

æ¨èï¼šæ··åˆç­–ç•¥ â­â­â­â­â­
ç†ç”±ï¼š
âœ… ç”¨æˆ·ä½“éªŒæœ€ä½³
âœ… è‡ªåŠ¨é€‚åº”å¯¹è¯é•¿åº¦
âœ… æˆæœ¬å¯æ¥å—

é…ç½®ï¼š
<span class="hljs-attr">compressor</span> = HybridCompressor(
    llm,
    <span class="hljs-attr">threshold_turns</span>=<span class="hljs-number">8</span>,  <span class="hljs-comment"># æ›´æ—©ç”¨LLM</span>
    <span class="hljs-attr">keep_recent_turns</span>=<span class="hljs-number">5</span>
)
</code></pre>
<hr/>
<p><strong>åœºæ™¯7ï¼šä¼ä¸šå†…éƒ¨å·¥å…· / å¤æ‚é¡¹ç›®è®¨è®º</strong></p>
<pre><code class="hljs language-ini" lang="ini">ç‰¹å¾ï¼š
- å¯¹è¯ï¼š20-40è½®
- ä¿¡æ¯ï¼šæŠ€æœ¯ç»†èŠ‚å¤š
- éœ€æ±‚ï¼šä¸èƒ½ä¸¢å¤±ä»»ä½•ä¿¡æ¯

æ¨èï¼šLLMæ‘˜è¦ æˆ– æ··åˆç­–ç•¥ â­â­â­â­
ç†ç”±ï¼š
âœ… ä¿ç•™æ‰€æœ‰æŠ€æœ¯ç»†èŠ‚
âœ… æ”¯æŒé•¿æ—¶é—´è®¨è®º
âœ… å†…éƒ¨å·¥å…·ï¼Œæˆæœ¬å¯æ§

é…ç½®ï¼š
<span class="hljs-comment"># æ–¹æ¡ˆ1ï¼šçº¯LLMæ‘˜è¦</span>
<span class="hljs-attr">compressor</span> = LLMSummaryCompressor(llm, keep_recent_turns=<span class="hljs-number">5</span>)

<span class="hljs-comment"># æ–¹æ¡ˆ2ï¼šæ··åˆç­–ç•¥</span>
<span class="hljs-attr">compressor</span> = HybridCompressor(llm, threshold_turns=<span class="hljs-number">10</span>)
</code></pre>
<hr/>
<p><strong>åœºæ™¯8ï¼šå®æ—¶è¯­éŸ³åŠ©æ‰‹</strong></p>
<pre><code class="hljs language-diff" lang="diff">ç‰¹å¾ï¼š
<span class="hljs-deletion">- äº¤äº’ï¼šå®æ—¶è¯­éŸ³</span>
<span class="hljs-deletion">- å»¶è¿Ÿï¼š&lt;100msè¦æ±‚</span>
<span class="hljs-deletion">- å¯¹è¯ï¼š5-10è½®</span>

æ¨èï¼šæ»‘åŠ¨çª—å£ â­â­â­â­â­
ç†ç”±ï¼š
âœ… é›¶å»¶è¿Ÿ
âœ… å¯¹è¯ä¸é•¿ï¼Œä¿¡æ¯ä¸¢å¤±é£é™©ä½
âœ… æœ€ç®€å•ã€æœ€ç¨³å®š

é…ç½®ï¼š
compressor = SlidingWindowCompressor(keep_turns=5)
</code></pre>
<hr/>
<h4 data-id="heading-77"><strong>ç»„åˆç­–ç•¥æ¨è</strong></h4>
<p>æœ‰æ—¶å•ä¸€ç­–ç•¥æ— æ³•æ»¡è¶³éœ€æ±‚ï¼Œå¯ä»¥ç»„åˆä½¿ç”¨ï¼š</p>
<p><strong>ç»„åˆ1ï¼šæ··åˆç­–ç•¥ + ç”¨æˆ·ç”»åƒ</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">EnhancedHybridCompressor</span>:
    <span class="hljs-string">"""æ··åˆç­–ç•¥ + æ°¸ä¹…ç”¨æˆ·ä¿¡æ¯"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, llm</span>):
        self.hybrid = HybridCompressor(llm, threshold_turns=<span class="hljs-number">10</span>)
        self.user_profile = {}  <span class="hljs-comment"># æ°¸ä¹…ä¿å­˜ç”¨æˆ·ä¿¡æ¯</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, user_id, messages</span>):
        <span class="hljs-comment"># æå–ç”¨æˆ·ä¿¡æ¯</span>
        self._extract_user_info(user_id, messages)
        
        <span class="hljs-comment"># æ··åˆç­–ç•¥å‹ç¼©</span>
        compressed = self.hybrid.compress(messages)
        
        <span class="hljs-comment"># æ·»åŠ ç”¨æˆ·ç”»åƒåˆ°å¼€å¤´</span>
        <span class="hljs-keyword">if</span> self.user_profile.get(user_id):
            profile_msg = {
                <span class="hljs-string">"role"</span>: <span class="hljs-string">"system"</span>,
                <span class="hljs-string">"content"</span>: <span class="hljs-string">f"ç”¨æˆ·ä¿¡æ¯: <span class="hljs-subst">{self.user_profile[user_id]}</span>"</span>
            }
            compressed.insert(<span class="hljs-number">0</span>, profile_msg)
        
        <span class="hljs-keyword">return</span> compressed
</code></pre>
<p><strong>é€‚ç”¨ï¼šä¸ªæ€§åŒ–æ¨èã€æ•™è‚²è¾…å¯¼</strong></p>
<hr/>
<p><strong>ç»„åˆ2ï¼šTokenåŠ¨æ€ + å…³é”®ä¿¡æ¯æå–</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SmartTokenCompressor</span>:
    <span class="hljs-string">"""TokenåŠ¨æ€ + å…³é”®ä¿¡æ¯ä¿æŠ¤"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, llm, max_tokens=<span class="hljs-number">200</span></span>):
        self.token_compressor = TokenBasedCompressor(
            llm.count_tokens, 
            max_tokens
        )
        self.key_entities = []  <span class="hljs-comment"># å…³é”®å®ä½“</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages</span>):
        <span class="hljs-comment"># æå–å…³é”®å®ä½“ï¼ˆå§“åã€åœ°ç‚¹ç­‰ï¼‰</span>
        self._extract_entities(messages)
        
        <span class="hljs-comment"># TokenåŠ¨æ€å‹ç¼©</span>
        compressed = self.token_compressor.compress(messages)
        
        <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦ä¸¢å¤±å…³é”®å®ä½“</span>
        lost_entities = self._check_lost_entities(compressed)
        
        <span class="hljs-comment"># å¦‚æœä¸¢å¤±å…³é”®ä¿¡æ¯ï¼Œæ”¾å®½é¢„ç®—</span>
        <span class="hljs-keyword">if</span> lost_entities:
            self.token_compressor.max_tokens *= <span class="hljs-number">1.5</span>
            compressed = self.token_compressor.compress(messages)
        
        <span class="hljs-keyword">return</span> compressed
</code></pre>
<p><strong>é€‚ç”¨ï¼šæœ‰Tokené™åˆ¶ä½†éœ€ä¿ç•™å…³é”®ä¿¡æ¯</strong></p>
<hr/>
<p><strong>ç»„åˆ3ï¼šåˆ†çº§å‹ç¼©</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TieredCompressor</span>:
    <span class="hljs-string">"""æ ¹æ®å¯¹è¯é‡è¦æ€§åˆ†çº§å‹ç¼©"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages, importance=<span class="hljs-string">"normal"</span></span>):
        <span class="hljs-keyword">if</span> importance == <span class="hljs-string">"critical"</span>:
            <span class="hljs-comment"># é‡è¦å¯¹è¯ï¼šç”¨LLMæ‘˜è¦</span>
            <span class="hljs-keyword">return</span> LLMSummaryCompressor(llm).compress(messages)
        <span class="hljs-keyword">elif</span> importance == <span class="hljs-string">"normal"</span>:
            <span class="hljs-comment"># æ™®é€šå¯¹è¯ï¼šç”¨æ··åˆç­–ç•¥</span>
            <span class="hljs-keyword">return</span> HybridCompressor(llm).compress(messages)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># ç®€å•å¯¹è¯ï¼šç”¨æ»‘åŠ¨çª—å£</span>
            <span class="hljs-keyword">return</span> SlidingWindowCompressor().compress(messages)
</code></pre>
<p><strong>é€‚ç”¨ï¼šæœ‰æ˜ç¡®ä¼˜å…ˆçº§çš„åœºæ™¯</strong></p>
<hr/>
<h4 data-id="heading-78"><strong>å¿«é€Ÿé€‰æ‹©æŒ‡å—</strong></h4>
<p><strong>æŒ‰éœ€æ±‚é€‰æ‹©ï¼š</strong></p>
<pre><code class="hljs">éœ€æ±‚                    â†’ æ¨èç­–ç•¥
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æˆæœ¬æœ€ä½               â†’ æ»‘åŠ¨çª—å£ / TokenåŠ¨æ€
é€Ÿåº¦æœ€å¿«               â†’ æ»‘åŠ¨çª—å£
Tokenæœ€å°‘              â†’ æ»‘åŠ¨çª—å£
ç²¾ç¡®æ§åˆ¶Token          â†’ TokenåŠ¨æ€
ä¿ç•™ç”¨æˆ·ä¿¡æ¯           â†’ LLMæ‘˜è¦ / æ··åˆç­–ç•¥
è‡ªåŠ¨é€‚åº”å¯¹è¯é•¿åº¦       â†’ æ··åˆç­–ç•¥
æœ€ç®€å•å®ç°             â†’ æ»‘åŠ¨çª—å£
ç”Ÿäº§é€šç”¨æ–¹æ¡ˆ           â†’ æ··åˆç­–ç•¥
</code></pre>
<p><strong>æŒ‰å¯¹è¯ç‰¹å¾é€‰æ‹©ï¼š</strong></p>
<pre><code class="hljs">å¯¹è¯é•¿åº¦                â†’ æ¨èç­–ç•¥
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
â‰¤5è½®                   â†’ æ»‘åŠ¨çª—å£
5-10è½®                 â†’ æ»‘åŠ¨çª—å£ / TokenåŠ¨æ€
10-20è½®                â†’ æ··åˆç­–ç•¥ / TokenåŠ¨æ€
20-30è½®                â†’ æ··åˆç­–ç•¥ / LLMæ‘˜è¦
â‰¥30è½®                  â†’ LLMæ‘˜è¦
</code></pre>
<p><strong>æŒ‰é¢„ç®—é€‰æ‹©ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">é¢„ç®—æƒ…å†µ                â†’ æ¨èç­–ç•¥
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
é›¶é¢„ç®—                 â†’ æ»‘åŠ¨çª—å£ / TokenåŠ¨æ€
å°é¢„ç®—(<span class="hljs-variable">$0</span>.01/æ¬¡ä»¥å†…)   â†’ æ··åˆç­–ç•¥
é¢„ç®—å……è¶³               â†’ LLMæ‘˜è¦
</code></pre>
<hr/>
<h4 data-id="heading-79"><strong>å¸¸è§é”™è¯¯é€‰æ‹©</strong></h4>
<p><strong>âŒ é”™è¯¯1ï¼šçŸ­å¯¹è¯ç”¨LLMæ‘˜è¦</strong></p>
<pre><code class="hljs language-erlang" lang="erlang">åœºæ™¯ï¼š<span class="hljs-number">5</span>è½®å¯¹è¯ï¼Œ<span class="hljs-number">126</span> tokens
é€‰æ‹©ï¼šLLMæ‘˜è¦
ç»“æœï¼š<span class="hljs-number">303</span> tokensï¼ˆåå¢<span class="hljs-number">141</span><span class="hljs-comment">%ï¼‰âŒ</span>

æ­£ç¡®ï¼šæ»‘åŠ¨çª—å£ æˆ– TokenåŠ¨æ€
åŸå› ï¼šçŸ­å¯¹è¯ä¸éœ€è¦æ‘˜è¦ï¼ŒLLMåè€Œå•°å—¦
</code></pre>
<hr/>
<p><strong>âŒ é”™è¯¯2ï¼šæˆæœ¬æ•æ„Ÿåœºæ™¯ç”¨æ··åˆç­–ç•¥</strong></p>
<pre><code class="hljs language-bash" lang="bash">åœºæ™¯ï¼šæ—¥æ´»10ä¸‡ï¼Œå…è´¹äº§å“
é€‰æ‹©ï¼šæ··åˆç­–ç•¥
ç»“æœï¼šå¹´æˆæœ¬<span class="hljs-variable">$2</span>,880 âŒ

æ­£ç¡®ï¼šæ»‘åŠ¨çª—å£
åŸå› ï¼šé›¶æˆæœ¬ï¼Œå¯æ‰©å±•æ€§æœ€å¥½
</code></pre>
<hr/>
<p><strong>âŒ é”™è¯¯3ï¼šTokené™åˆ¶åœºæ™¯ç”¨æ»‘åŠ¨çª—å£</strong></p>
<pre><code class="hljs language-ini" lang="ini">åœºæ™¯ï¼šAPIé™åˆ¶4K tokens
é€‰æ‹©ï¼šæ»‘åŠ¨çª—å£(10è½®)
ç»“æœï¼šæœ‰æ—¶10è½®=150 tokensï¼Œæœ‰æ—¶=600 tokens âŒ

æ­£ç¡®ï¼šTokenåŠ¨æ€(<span class="hljs-attr">max_tokens</span>=<span class="hljs-number">200</span>)
åŸå› ï¼šç²¾ç¡®æ§åˆ¶ï¼Œä¸ä¼šè¶…é™
</code></pre>
<hr/>
<p><strong>âŒ é”™è¯¯4ï¼šå®æ—¶åœºæ™¯ç”¨LLMæ‘˜è¦</strong></p>
<pre><code class="hljs">åœºæ™¯ï¼šè¯­éŸ³åŠ©æ‰‹ï¼Œå»¶è¿Ÿ&lt;100ms
é€‰æ‹©ï¼šLLMæ‘˜è¦
ç»“æœï¼šå‹ç¼©è€—æ—¶11ç§’ï¼Œä½“éªŒæå·® âŒ

æ­£ç¡®ï¼šæ»‘åŠ¨çª—å£
åŸå› ï¼šé›¶å»¶è¿Ÿ
</code></pre>
<hr/>
<p><strong>âŒ é”™è¯¯5ï¼šé•¿å¯¹è¯åªç”¨æ»‘åŠ¨çª—å£</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">åœºæ™¯ï¼š30è½®å¿ƒç†å’¨è¯¢
é€‰æ‹©ï¼šæ»‘åŠ¨çª—å£(5è½®)
ç»“æœï¼šä¸¢å¤±æ‰€æœ‰æ—©æœŸèƒŒæ™¯ âŒ
<span class="hljs-code">      ç”¨æˆ·éœ€è¦é‡å¤è¯´æ˜
</span>
æ­£ç¡®ï¼šLLMæ‘˜è¦ æˆ– æ··åˆç­–ç•¥
åŸå› ï¼šä¿ç•™ç”¨æˆ·ä¿¡æ¯ï¼Œä½“éªŒæ›´å¥½
</code></pre>
<hr/>
<h4 data-id="heading-80"><strong>å®æˆ˜å»ºè®®</strong></h4>
<p><strong>1. ä»ç®€å•å¼€å§‹</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç¬¬ä¸€æ­¥ï¼šå…ˆç”¨æ»‘åŠ¨çª—å£</span>
compressor = SlidingWindowCompressor(keep_turns=<span class="hljs-number">5</span>)

<span class="hljs-comment"># è¿è¡Œä¸€æ®µæ—¶é—´ï¼Œè§‚å¯Ÿé—®é¢˜ï¼š</span>
<span class="hljs-comment"># - ç”¨æˆ·æ˜¯å¦æŠ±æ€¨"ä¸è®°å¾—ä¹‹å‰è¯´çš„"ï¼Ÿ</span>
<span class="hljs-comment"># - å¯¹è¯æ˜¯å¦ç»å¸¸è¶…è¿‡10è½®ï¼Ÿ</span>

<span class="hljs-comment"># å¦‚æœæ˜¯ï¼Œå†å‡çº§åˆ°æ··åˆç­–ç•¥</span>
</code></pre>
<p><strong>2. A/Bæµ‹è¯•</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å¯¹ç…§ç»„ï¼šæ»‘åŠ¨çª—å£</span>
group_a = SlidingWindowCompressor(keep_turns=<span class="hljs-number">5</span>)

<span class="hljs-comment"># å®éªŒç»„ï¼šæ··åˆç­–ç•¥</span>
group_b = HybridCompressor(llm, threshold_turns=<span class="hljs-number">10</span>)

<span class="hljs-comment"># è§‚å¯ŸæŒ‡æ ‡ï¼š</span>
<span class="hljs-comment"># - ç”¨æˆ·æ»¡æ„åº¦</span>
<span class="hljs-comment"># - å¯¹è¯å®Œæˆç‡</span>
<span class="hljs-comment"># - é‡å¤æé—®ç‡</span>
<span class="hljs-comment"># - Tokenæˆæœ¬</span>
</code></pre>
<p><strong>3. ç›‘æ§å…³é”®æŒ‡æ ‡</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MonitoredCompressor</span>:
    <span class="hljs-string">"""å¸¦ç›‘æ§çš„å‹ç¼©å™¨"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages</span>):
        start = time.time()
        
        original_tokens = self._count_tokens(messages)
        result = self.compressor.compress(messages)
        compressed_tokens = self._count_tokens(result)
        
        elapsed = time.time() - start
        
        <span class="hljs-comment"># è®°å½•æŒ‡æ ‡</span>
        metrics.record({
            <span class="hljs-string">"original_tokens"</span>: original_tokens,
            <span class="hljs-string">"compressed_tokens"</span>: compressed_tokens,
            <span class="hljs-string">"compression_rate"</span>: <span class="hljs-number">1</span> - compressed_tokens/original_tokens,
            <span class="hljs-string">"latency_ms"</span>: elapsed * <span class="hljs-number">1000</span>,
            <span class="hljs-string">"strategy"</span>: self.compressor.__class__.__name__
        })
        
        <span class="hljs-keyword">return</span> result
</code></pre>
<p><strong>4. åŠ¨æ€åˆ‡æ¢ç­–ç•¥</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AdaptiveCompressor</span>:
    <span class="hljs-string">"""æ ¹æ®å®æ—¶æƒ…å†µåŠ¨æ€é€‰æ‹©ç­–ç•¥"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">compress</span>(<span class="hljs-params">self, messages</span>):
        <span class="hljs-comment"># æ£€æŸ¥ç³»ç»Ÿè´Ÿè½½</span>
        <span class="hljs-keyword">if</span> system_load &gt; <span class="hljs-number">0.8</span>:
            <span class="hljs-comment"># é«˜è´Ÿè½½ï¼šç”¨æœ€å¿«çš„</span>
            <span class="hljs-keyword">return</span> SlidingWindowCompressor().compress(messages)
        
        <span class="hljs-comment"># æ£€æŸ¥å¯¹è¯é•¿åº¦</span>
        turns = <span class="hljs-built_in">len</span>(messages) // <span class="hljs-number">2</span>
        <span class="hljs-keyword">if</span> turns &lt;= <span class="hljs-number">10</span>:
            <span class="hljs-keyword">return</span> SlidingWindowCompressor().compress(messages)
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> HybridCompressor(llm).compress(messages)
</code></pre>
<hr/>
<h4 data-id="heading-81"><strong>æ€»ç»“ï¼šæ²¡æœ‰é“¶å¼¹</strong></h4>
<pre><code class="hljs language-erlang" lang="erlang">æ ¸å¿ƒæ•™è®­ï¼š
âŒ æ²¡æœ‰<span class="hljs-string">"æœ€å¥½"</span>çš„ç­–ç•¥
âœ… åªæœ‰<span class="hljs-string">"æœ€é€‚åˆ"</span>çš„ç­–ç•¥

é€‰æ‹©ä¾æ®ï¼š
<span class="hljs-number">1</span>. å¯¹è¯ç‰¹å¾ï¼ˆé•¿åº¦ã€å¯†åº¦ï¼‰
<span class="hljs-number">2</span>. ä¸šåŠ¡éœ€æ±‚ï¼ˆæˆæœ¬ã€ä½“éªŒï¼‰
<span class="hljs-number">3</span>. æŠ€æœ¯çº¦æŸï¼ˆå»¶è¿Ÿã€Tokené™åˆ¶ï¼‰

å®ç”¨å»ºè®®ï¼š
â€¢ <span class="hljs-number">80</span><span class="hljs-comment">%åœºæ™¯ï¼šæ»‘åŠ¨çª—å£ æˆ– æ··åˆç­–ç•¥</span>
â€¢ <span class="hljs-number">10</span><span class="hljs-comment">%åœºæ™¯ï¼šTokenåŠ¨æ€</span>
â€¢ <span class="hljs-number">10</span><span class="hljs-comment">%åœºæ™¯ï¼šLLMæ‘˜è¦</span>

æ ¸å¿ƒåŸåˆ™ï¼š
ä»ç®€å•å¼€å§‹ â†’ æµ‹è¯•éªŒè¯ â†’ æŒ‰éœ€å‡çº§
</code></pre>
<h2 data-id="heading-82"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df584483d97446c9ba00c68cdcdc4d9f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQWdlbnRCdWlsZGVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765471478&amp;x-signature=6NH6AeDbh8vyJp9HAKDK9LN%2B684%3D" alt="image.png" loading="lazy"/></h2>
<h2 data-id="heading-83"><strong>å››ã€æ€§èƒ½æµ‹è¯•ä¸­çš„æ„å¤–å‘ç°</strong></h2>
<p>åœ¨å®Œæˆæ‰€æœ‰æµ‹è¯•åï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€äº›<strong>åç›´è§‰</strong>çš„ç»“æœã€‚è¿™äº›å‘ç°æ”¹å˜äº†æˆ‘ä»¬å¯¹"å¥½ç­–ç•¥"çš„è®¤çŸ¥ã€‚</p>
<h3 data-id="heading-84"><strong>4.1 æ„å¤–1ï¼šLLMæ‘˜è¦åœ¨çŸ­å¯¹è¯ä¸­æ˜¯"è´Ÿä¼˜åŒ–"</strong></h3>
<h4 data-id="heading-85"><strong>ç›´è§‰é¢„æœŸ</strong></h4>
<pre><code class="hljs">LLMå¾ˆæ™ºèƒ½ â†’ å‹ç¼©æ•ˆæœåº”è¯¥æœ€å¥½
æ™ºèƒ½æ‘˜è¦ â†’ Tokenè‚¯å®šæ¯”åŸå§‹å°‘
</code></pre>
<h4 data-id="heading-86"><strong>å®æµ‹æ•°æ®</strong></h4>
<p><strong>çŸ­å¯¹è¯ï¼ˆ5è½®ï¼Œ126 tokensï¼‰ï¼š</strong></p>
<pre><code class="hljs language-vbnet" lang="vbnet">åŸå§‹å¯¹è¯ï¼š
<span class="hljs-symbol">User:</span> <span class="hljs-string">"æˆ‘å«Tom"</span>
<span class="hljs-symbol">AI:</span> <span class="hljs-string">"ä½ å¥½Tomï¼"</span>
<span class="hljs-symbol">User:</span> <span class="hljs-string">"æˆ‘åœ¨ä¸Šæµ·"</span>
<span class="hljs-symbol">AI:</span> <span class="hljs-string">"ä¸Šæµ·å¾ˆä¸é”™"</span>
<span class="hljs-symbol">User:</span> <span class="hljs-string">"è°¢è°¢"</span>
<span class="hljs-symbol">AI:</span> <span class="hljs-string">"ä¸å®¢æ°”"</span>

æ€»è®¡ï¼š<span class="hljs-number">126</span> tokens
</code></pre>
<p><strong>LLMæ‘˜è¦åï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">ğŸ“ å¯¹è¯å†å²æ‘˜è¦ï¼š

<span class="hljs-strong">**ç”¨æˆ·åŸºæœ¬ä¿¡æ¯**</span>
<span class="hljs-bullet">-</span> å§“åï¼šTom
<span class="hljs-bullet">-</span> åœ°ç‚¹ï¼šä¸Šæµ·
<span class="hljs-bullet">-</span> èŒä¸šï¼šæœªæ˜ç¡®è¯´æ˜

<span class="hljs-strong">**ç”¨æˆ·åå¥½å’Œå…´è¶£**</span>
<span class="hljs-bullet">-</span> æœªæåŠå…·ä½“åå¥½

<span class="hljs-strong">**è®¨è®ºä¸»è¦è¯é¢˜**</span>
<span class="hljs-bullet">1.</span> ç”¨æˆ·è‡ªæˆ‘ä»‹ç»ï¼ˆå§“åã€åœ°ç‚¹ï¼‰
<span class="hljs-bullet">2.</span> ç®€å•å¯’æš„

<span class="hljs-strong">**å…³é”®ç»†èŠ‚**</span>
<span class="hljs-bullet">-</span> ç”¨æˆ·è¡¨è¾¾äº†æ„Ÿè°¢

æ€»è®¡ï¼š303 tokensï¼ˆå¢åŠ 141%ï¼ï¼‰
</code></pre>
<p><strong>ç»“æœå¯¹æ¯”ï¼š</strong></p>



































<table><thead><tr><th>å¯¹è¯é•¿åº¦</th><th>åŸå§‹Token</th><th>LLMæ‘˜è¦å</th><th>å˜åŒ–</th></tr></thead><tbody><tr><td>5è½®</td><td>126</td><td>303</td><td><strong>+141%</strong> âŒ</td></tr><tr><td>10è½®</td><td>249</td><td>388</td><td><strong>+56%</strong> âŒ</td></tr><tr><td>20è½®</td><td>560</td><td>597</td><td><strong>+7%</strong> âŒ</td></tr><tr><td>30è½®</td><td>933</td><td>621</td><td><strong>-33%</strong> âœ…</td></tr></tbody></table>
<p><strong>éœ‡æƒŠçš„å‘ç°ï¼šåªæœ‰â‰¥30è½®æ—¶ï¼ŒLLMæ‘˜è¦æ‰æœ‰æ­£æ”¶ç›Šï¼</strong></p>
<hr/>
<h4 data-id="heading-87"><strong>ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ</strong></h4>
<p><strong>åŸå› 1ï¼šæ ¼å¼åŒ–æ–‡æœ¬çš„å¼€é”€</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æˆ‘ä»¬çš„Promptè¦æ±‚</span>
<span class="hljs-string">"è¯·æŒ‰ä»¥ä¸‹æ ¼å¼è¾“å‡ºæ‘˜è¦ï¼š
ğŸ“ å¯¹è¯å†å²æ‘˜è¦ï¼š
1. **ç”¨æˆ·åŸºæœ¬ä¿¡æ¯**ï¼š...
2. **ç”¨æˆ·åå¥½ä¸å…´è¶£**ï¼š...
..."</span>

<span class="hljs-comment"># è¿™äº›æ ¼å¼æ–‡æœ¬æœ¬èº«å°±æ¶ˆè€—Token</span>
æ ¼å¼å¼€é”€ï¼š~<span class="hljs-number">100</span> tokens
</code></pre>
<p><strong>åŸå› 2ï¼šLLMå¤©ç”Ÿ"å•°å—¦"</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">åŸå§‹ï¼š<span class="hljs-string">"æˆ‘å«Tom"</span>ï¼ˆ<span class="hljs-number">3</span> tokensï¼‰

LLMæ‘˜è¦ï¼š<span class="hljs-string">"ç”¨æˆ·çš„å§“åæ˜¯Tom"</span>ï¼ˆ<span class="hljs-number">7</span> tokensï¼‰
â†’ åè€Œæ›´å¤šï¼
</code></pre>
<p><strong>åŸå› 3ï¼šçŸ­å¯¹è¯æœ¬èº«å·²ç»å¾ˆç®€æ´</strong></p>
<pre><code class="hljs language-diff" lang="diff">çŸ­å¯¹è¯ç‰¹ç‚¹ï¼š
<span class="hljs-deletion">- ç”¨æˆ·è¯´è¯ç®€çŸ­ï¼š"å—¯"ã€"å¥½çš„"</span>
<span class="hljs-deletion">- æ²¡æœ‰å†—ä½™ä¿¡æ¯</span>
<span class="hljs-deletion">- æœ¬èº«å°±æ˜¯"å‹ç¼©"è¿‡çš„</span>

LLMæ‘˜è¦ï¼š
<span class="hljs-deletion">- éœ€è¦å®Œæ•´æè¿°ä¸Šä¸‹æ–‡</span>
<span class="hljs-deletion">- å¿…é¡»ä¿æŒè¯­ä¹‰æ¸…æ™°</span>
<span class="hljs-deletion">- ç»“æœåè€Œæ›´é•¿</span>
</code></pre>
<hr/>
<h4 data-id="heading-88"><strong>æ•™è®­</strong></h4>
<pre><code class="hljs language-arduino" lang="arduino">âŒ é”™è¯¯æƒ³æ³•ï¼šLLMå¾ˆæ™ºèƒ½ â†’ ä¸€å®šæ¯”ç®€å•ç­–ç•¥å¥½
âœ… æ­£ç¡®è®¤çŸ¥ï¼šæ™ºèƒ½ä¸ç­‰äºé«˜æ•ˆï¼Œè¦çœ‹å…·ä½“åœºæ™¯

å¯ç¤ºï¼š
â€¢ ä¸è¦åœ¨çŸ­å¯¹è¯ï¼ˆ&lt;<span class="hljs-number">20</span>è½®ï¼‰ä½¿ç”¨LLMæ‘˜è¦
â€¢ ç®€å•åœºæ™¯ç”¨ç®€å•æ–¹æ¡ˆï¼ˆæ»‘åŠ¨çª—å£ï¼‰
â€¢ <span class="hljs-string">"æ™ºèƒ½"</span>ä¸æ˜¯ä¸‡èƒ½çš„
</code></pre>
<h2 data-id="heading-89"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6b06ea7ef964e4090529d9ab8596c52~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQWdlbnRCdWlsZGVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765471478&amp;x-signature=RoLfvQvyFFocquLJE1Hdf7ofMwo%3D" alt="image.png" loading="lazy"/></h2>
<h3 data-id="heading-90"><strong>4.2 æ„å¤–2ï¼šæ··åˆç­–ç•¥åœ¨é•¿å¯¹è¯æ—¶Tokenæ•ˆç‡åè€Œå¾ˆå·®</strong></h3>
<h4 data-id="heading-91"><strong>ç›´è§‰é¢„æœŸ</strong></h4>
<pre><code class="hljs">æ··åˆç­–ç•¥ = æœ€ä½³ç­–ç•¥
çŸ­å¯¹è¯ç”¨æ»‘åŠ¨çª—å£ï¼ˆå¿«ï¼‰+ é•¿å¯¹è¯ç”¨LLMï¼ˆæ™ºèƒ½ï¼‰
â†’ åº”è¯¥ç»¼åˆäº†ä¸¤è€…ä¼˜ç‚¹
</code></pre>
<h4 data-id="heading-92"><strong>å®æµ‹æ•°æ®</strong></h4>
<p><strong>é•¿å¯¹è¯ï¼ˆ20è½®ï¼Œ560 tokensï¼‰ï¼š</strong></p>






























<table><thead><tr><th>ç­–ç•¥</th><th>Token</th><th>ç›¸å¯¹æ»‘åŠ¨çª—å£</th></tr></thead><tbody><tr><td>æ»‘åŠ¨çª—å£</td><td><strong>145</strong></td><td>åŸºå‡†</td></tr><tr><td>TokenåŠ¨æ€</td><td>193</td><td>+33%</td></tr><tr><td>LLMæ‘˜è¦</td><td>597</td><td>+312% âŒ</td></tr><tr><td><strong>æ··åˆç­–ç•¥</strong></td><td><strong>604</strong></td><td><strong>+317%</strong> âŒ</td></tr></tbody></table>
<p><strong>æ··åˆç­–ç•¥å±…ç„¶æ¯”LLMæ‘˜è¦è¿˜å·®ï¼</strong></p>
<hr/>
<h4 data-id="heading-93"><strong>ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ</strong></h4>
<p><strong>åŸå› ï¼šæ··åˆç­–ç•¥ä¿ç•™äº†æ›´å¤šæœ€è¿‘æ¶ˆæ¯</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># LLMæ‘˜è¦é…ç½®</span>
keep_recent_turns = <span class="hljs-number">3</span>  <span class="hljs-comment"># ä¿ç•™3è½® = 6æ¡æ¶ˆæ¯</span>

<span class="hljs-comment"># æ··åˆç­–ç•¥é…ç½®</span>
keep_recent_turns = <span class="hljs-number">5</span>  <span class="hljs-comment"># ä¿ç•™5è½® = 10æ¡æ¶ˆæ¯</span>

ç»“æœï¼š
- LLMæ‘˜è¦ï¼š<span class="hljs-number">1</span>æ¡æ‘˜è¦ + <span class="hljs-number">6</span>æ¡æ¶ˆæ¯ = <span class="hljs-number">7</span>æ¡ï¼ˆ<span class="hljs-number">597</span> tokensï¼‰
- æ··åˆç­–ç•¥ï¼š<span class="hljs-number">1</span>æ¡æ‘˜è¦ + <span class="hljs-number">10</span>æ¡æ¶ˆæ¯ = <span class="hljs-number">11</span>æ¡ï¼ˆ<span class="hljs-number">604</span> tokensï¼‰
</code></pre>
<p><strong>å¯¹æ¯”æ»‘åŠ¨çª—å£ï¼š</strong></p>
<pre><code class="hljs">æ»‘åŠ¨çª—å£ï¼š10æ¡æœ€æ–°æ¶ˆæ¯ = 145 tokens
æ··åˆç­–ç•¥ï¼š1æ‘˜è¦ + 10æ¡ = 604 tokens

Tokenå·®è·ï¼š4.2å€ï¼
</code></pre>
<hr/>
<h4 data-id="heading-94"><strong>æ·±å±‚åŸå› ï¼šæ‘˜è¦æœ¬èº«å°±å¾ˆ"èƒ–"</strong></h4>
<pre><code class="hljs language-erlang" lang="erlang">æ‘˜è¦ç¤ºä¾‹ï¼ˆ<span class="hljs-number">200</span>+ tokensï¼‰ï¼š
<span class="hljs-string">"ğŸ“ å¯¹è¯å†å²æ‘˜è¦ï¼š
ç”¨æˆ·Tomï¼Œ28å²ï¼Œåœ¨ä¸Šæµ·æµ¦ä¸œå·¥ä½œï¼Œ
æ˜¯AIå·¥ç¨‹å¸ˆï¼Œç›®å‰ç ”ç©¶Agentå¤šæ™ºèƒ½ä½“åä½œï¼Œ
å…³æ³¨é€šä¿¡å»¶è¿Ÿå’Œæ¶ˆæ¯é˜Ÿåˆ—ä¼˜åŒ–..."</span>

vs åŸå§‹å¯¹è¯ï¼ˆ<span class="hljs-number">100</span> tokensï¼‰ï¼š
<span class="hljs-string">"æˆ‘å«Tom"</span>
<span class="hljs-string">"æˆ‘åœ¨ä¸Šæµ·"</span>
<span class="hljs-string">"æˆ‘æ˜¯AIå·¥ç¨‹å¸ˆ"</span>
<span class="hljs-string">"æˆ‘åœ¨ç ”ç©¶Agent"</span>
...

ç»“æœï¼šæ‘˜è¦<span class="hljs-number">200</span> tokens &gt; åŸå§‹<span class="hljs-number">100</span> tokens
</code></pre>
<hr/>
<h4 data-id="heading-95"><strong>æ•™è®­</strong></h4>
<pre><code class="hljs language-arduino" lang="arduino">âŒ é”™è¯¯æƒ³æ³•ï¼šæ··åˆç­–ç•¥ç»¼åˆä¼˜ç‚¹ â†’ ä¸€å®šæœ€å¥½
âœ… æ­£ç¡®è®¤çŸ¥ï¼šç»¼åˆç­–ç•¥å¯èƒ½ç»¼åˆäº†ç¼ºç‚¹

å¯ç¤ºï¼š
â€¢ æ··åˆç­–ç•¥ç‰ºç‰²Tokenæ•ˆç‡ï¼Œæ¢å–ä¿¡æ¯ä¿ç•™
â€¢ å¦‚æœè¿½æ±‚Tokenæœ€å°‘ â†’ ç”¨æ»‘åŠ¨çª—å£
â€¢ å¦‚æœè¿½æ±‚ä¿¡æ¯ä¿ç•™ â†’ ç”¨æ··åˆç­–ç•¥
â€¢ ä¸å­˜åœ¨<span class="hljs-string">"ä¸¤å…¨å…¶ç¾"</span>
</code></pre>
<hr/>
<h3 data-id="heading-96"><strong>4.3 æ„å¤–3ï¼šTokenåŠ¨æ€"ç²¾ç¡®æ§åˆ¶"æ˜¯æŠŠåŒåˆƒå‰‘</strong></h3>
<h4 data-id="heading-97"><strong>ç›´è§‰é¢„æœŸ</strong></h4>
<pre><code class="hljs">ç²¾ç¡®æ§åˆ¶Token â†’ å……åˆ†åˆ©ç”¨é¢„ç®—
é¢„ç®—200 â†’ å®é™…193
â†’ åº”è¯¥æ¯”æ»‘åŠ¨çª—å£æ›´é«˜æ•ˆ
</code></pre>
<h4 data-id="heading-98"><strong>å®æµ‹æ•°æ®</strong></h4>
<p><strong>ä¸­ç­‰å¯¹è¯ï¼ˆ10è½®ï¼Œ249 tokensï¼‰ï¼š</strong></p>




















<table><thead><tr><th>ç­–ç•¥</th><th>Token</th><th>æ¶ˆæ¯æ•°</th></tr></thead><tbody><tr><td>æ»‘åŠ¨çª—å£</td><td><strong>123</strong></td><td>10æ¡</td></tr><tr><td>TokenåŠ¨æ€(é¢„ç®—200)</td><td>194</td><td>15æ¡</td></tr></tbody></table>
<p><strong>TokenåŠ¨æ€åè€Œå¤šç”¨58%ï¼</strong></p>
<hr/>
<h4 data-id="heading-99"><strong>ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ</strong></h4>
<p><strong>æ»‘åŠ¨çª—å£ï¼š"çœç€ç”¨"</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å›ºå®šä¿ç•™10æ¡ï¼ˆ5è½®ï¼‰</span>
<span class="hljs-comment"># ä¸ç®¡è¿˜æœ‰å¤šå°‘é¢„ç®—</span>
messages[-<span class="hljs-number">10</span>:]  <span class="hljs-comment"># 123 tokens</span>

å‰©ä½™é¢„ç®—ï¼š<span class="hljs-number">200</span> - <span class="hljs-number">123</span> = <span class="hljs-number">77</span> tokensï¼ˆæµªè´¹ï¼‰
</code></pre>
<p><strong>TokenåŠ¨æ€ï¼š"ç”¨æ»¡é¢„ç®—"</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å°½é‡ç”¨æ»¡200é¢„ç®—</span>
<span class="hljs-comment"># ä»åå¾€å‰ç´¯åŠ åˆ°æ¥è¿‘200</span>
messages[-<span class="hljs-number">15</span>:]  <span class="hljs-comment"># 194 tokens</span>

å‰©ä½™é¢„ç®—ï¼š<span class="hljs-number">200</span> - <span class="hljs-number">194</span> = <span class="hljs-number">6</span> tokensï¼ˆå……åˆ†åˆ©ç”¨ï¼‰
</code></pre>
<hr/>
<h4 data-id="heading-100"><strong>çœ‹ä¼¼åˆç†ï¼Œå®åˆ™çŸ›ç›¾</strong></h4>
<pre><code class="hljs language-erlang" lang="erlang">TokenåŠ¨æ€çš„<span class="hljs-string">"ä¼˜åŠ¿"</span>ï¼š
âœ… å……åˆ†åˆ©ç”¨é¢„ç®—ï¼ˆ<span class="hljs-number">194</span>/<span class="hljs-number">200</span> = <span class="hljs-number">97</span><span class="hljs-comment">%åˆ©ç”¨ç‡ï¼‰</span>
âœ… ä¿ç•™æ›´å¤šæ¶ˆæ¯ï¼ˆ<span class="hljs-number">15</span>æ¡ vs <span class="hljs-number">10</span>æ¡ï¼‰

ä½†ä»å¦ä¸€ä¸ªè§’åº¦ï¼š
âŒ ç”¨æ›´å¤šTokenï¼ˆ<span class="hljs-number">194</span> vs <span class="hljs-number">123</span>ï¼‰
âŒ åç»­å¯¹è¯æˆæœ¬æ›´é«˜

é—®é¢˜ï¼š
<span class="hljs-string">"å……åˆ†åˆ©ç”¨é¢„ç®—"</span>åˆ°åº•æ˜¯ä¼˜åŠ¿è¿˜æ˜¯åŠ£åŠ¿ï¼Ÿ
</code></pre>
<p><strong>ç­”æ¡ˆï¼šçœ‹ä½ çš„ç›®æ ‡ï¼</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">å¦‚æœç›®æ ‡æ˜¯<span class="hljs-string">"å……åˆ†åˆ©ç”¨4Kä¸Šä¸‹æ–‡çª—å£"</span>ï¼š
â†’ TokenåŠ¨æ€æ˜¯ä¼˜åŠ¿ âœ…

å¦‚æœç›®æ ‡æ˜¯<span class="hljs-string">"å°½é‡èŠ‚çœTokenæˆæœ¬"</span>ï¼š
â†’ TokenåŠ¨æ€æ˜¯åŠ£åŠ¿ âŒ
</code></pre>
<hr/>
<h4 data-id="heading-101"><strong>æ•™è®­</strong></h4>
<pre><code class="hljs language-arduino" lang="arduino">âŒ é”™è¯¯æƒ³æ³•ï¼šç²¾ç¡®æ§åˆ¶ = æ›´å¥½
âœ… æ­£ç¡®è®¤çŸ¥ï¼šç²¾ç¡®æ§åˆ¶æ˜¯å·¥å…·ï¼Œä¸æ˜¯ç›®æ ‡

å¯ç¤ºï¼š
â€¢ æ˜ç¡®ç›®æ ‡ï¼šèŠ‚çœæˆæœ¬ <span class="hljs-keyword">or</span> å……åˆ†åˆ©ç”¨ï¼Ÿ
â€¢ TokenåŠ¨æ€é€‚åˆ<span class="hljs-string">"å¿…é¡»ç”¨æ»¡é¢„ç®—"</span>çš„åœºæ™¯
â€¢ å¦‚æœè¿½æ±‚æè‡´å‹ç¼© â†’ ç”¨æ»‘åŠ¨çª—å£
</code></pre>
<hr/>
<h3 data-id="heading-102"><strong>4.4 æ„å¤–4ï¼šList vs Dequeçš„æ€§èƒ½å·®å¼‚å¾®ä¹å…¶å¾®</strong></h3>
<h4 data-id="heading-103"><strong>ç›´è§‰é¢„æœŸ</strong></h4>
<pre><code class="hljs language-scss" lang="scss">è®¡ç®—æœºç§‘å­¦ç†è®ºï¼š
- List<span class="hljs-selector-class">.pop</span>(<span class="hljs-number">0</span>) = <span class="hljs-built_in">O</span>(n)
- Deque<span class="hljs-selector-class">.popleft</span>() = <span class="hljs-built_in">O</span>(<span class="hljs-number">1</span>)

Dequeåº”è¯¥å¿«å¾ˆå¤šï¼
</code></pre>
<h4 data-id="heading-104"><strong>å®æµ‹æ•°æ®</strong></h4>
<p><strong>100,000æ¬¡æ“ä½œï¼š</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">List:  13.63ms  (0.14Î¼s/æ¬¡)</span>
<span class="hljs-section">Deque: 12.52ms  (0.13Î¼s/æ¬¡)</span>

é€Ÿåº¦å·®å¼‚ï¼š8%
</code></pre>
<p><strong>éœ‡æƒŠï¼šå‡ ä¹ä¸€æ ·å¿«ï¼</strong></p>
<hr/>
<h4 data-id="heading-105"><strong>ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ</strong></h4>
<p><strong>åŸå› 1ï¼šæ“ä½œæ¬¡æ•°å°‘</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å®é™…ä½¿ç”¨</span>
messages.pop(<span class="hljs-number">0</span>)  <span class="hljs-comment"># åªåˆ 1æ¡</span>

<span class="hljs-comment"># ä¸æ˜¯</span>
<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>):
    messages.pop(<span class="hljs-number">0</span>)  <span class="hljs-comment"># åˆ 1000æ¡</span>
</code></pre>
<p>å•æ¬¡åˆ é™¤ï¼ŒO(n)å’ŒO(1)å·®å¼‚ä¸å¤§ã€‚</p>
<p><strong>åŸå› 2ï¼šæ¶ˆæ¯åˆ—è¡¨ä¸é•¿</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å®é™…åœºæ™¯</span>
messages = [...]  <span class="hljs-comment"># 10-20æ¡</span>

<span class="hljs-comment"># ä¸æ˜¯</span>
messages = [...]  <span class="hljs-comment"># 10,000æ¡</span>
</code></pre>
<p>nå¾ˆå°æ—¶ï¼ŒO(n)â‰ˆO(1)ã€‚</p>
<p><strong>åŸå› 3ï¼šPythonå†…éƒ¨ä¼˜åŒ–</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># CPythonå¯¹list.pop(0)æœ‰ä¼˜åŒ–</span>
<span class="hljs-comment"># ä¸æ˜¯naiveçš„å†…å­˜ç§»åŠ¨</span>
</code></pre>
<hr/>
<h4 data-id="heading-106"><strong>æ•™è®­</strong></h4>
<pre><code class="hljs language-scss" lang="scss">âŒ é”™è¯¯æƒ³æ³•ï¼šç†è®ºå¤æ‚åº¦ = å®é™…æ€§èƒ½
âœ… æ­£ç¡®è®¤çŸ¥ï¼šè¦æµ‹è¯•å®é™…åœºæ™¯

å¯ç¤ºï¼š
â€¢ ä¸è¦è¿‡æ—©ä¼˜åŒ–
â€¢ å°æ•°æ®é‡æ—¶ï¼Œ<span class="hljs-built_in">O</span>(n)å’Œ<span class="hljs-built_in">O</span>(<span class="hljs-number">1</span>)å·®å¼‚ä¸å¤§
â€¢ ç†è®ºæ˜¯æŒ‡å¯¼ï¼Œå®æµ‹æ‰æ˜¯çœŸç›¸
â€¢ Listå¤Ÿç”¨ï¼Œä¸éœ€è¦Deque
</code></pre>
<hr/>
<h3 data-id="heading-107"><strong>4.5 æ„å¤–5ï¼š"æ›´æ™ºèƒ½"ä¸ç­‰äº"æ›´å¥½"</strong></h3>
<h4 data-id="heading-108"><strong>ç›´è§‰é¢„æœŸ</strong></h4>
<pre><code class="hljs">æ™ºèƒ½æ’åºï¼š
LLMæ‘˜è¦ &gt; æ··åˆç­–ç•¥ &gt; TokenåŠ¨æ€ &gt; æ»‘åŠ¨çª—å£

å®é™…æ•ˆæœåº”è¯¥ä¹Ÿæ˜¯è¿™ä¸ªé¡ºåº
</code></pre>
<h4 data-id="heading-109"><strong>å®æµ‹æ•°æ®æ±‡æ€»</strong></h4>








































<table><thead><tr><th>ç»´åº¦</th><th>ç¬¬1å</th><th>ç¬¬2å</th><th>ç¬¬3å</th><th>ç¬¬4å</th></tr></thead><tbody><tr><td><strong>Tokenæ•ˆç‡</strong></td><td>æ»‘åŠ¨çª—å£</td><td>TokenåŠ¨æ€</td><td>æ··åˆç­–ç•¥</td><td>LLMæ‘˜è¦</td></tr><tr><td><strong>é€Ÿåº¦</strong></td><td>æ»‘åŠ¨çª—å£</td><td>TokenåŠ¨æ€</td><td>æ··åˆç­–ç•¥</td><td>LLMæ‘˜è¦</td></tr><tr><td><strong>æˆæœ¬</strong></td><td>æ»‘åŠ¨çª—å£</td><td>TokenåŠ¨æ€</td><td>æ··åˆç­–ç•¥</td><td>LLMæ‘˜è¦</td></tr><tr><td><strong>ç®€å•æ€§</strong></td><td>æ»‘åŠ¨çª—å£</td><td>TokenåŠ¨æ€</td><td>LLMæ‘˜è¦</td><td>æ··åˆç­–ç•¥</td></tr></tbody></table>
<p><strong>æœ€"è ¢"çš„ç­–ç•¥ï¼ˆæ»‘åŠ¨çª—å£ï¼‰åœ¨4ä¸ªç»´åº¦éƒ½ç¬¬ä¸€ï¼</strong></p>
<p><strong>åªæœ‰"ä¿¡æ¯ä¿ç•™"ä¸€ä¸ªç»´åº¦ï¼š</strong></p>



















<table><thead><tr><th>ç»´åº¦</th><th>ç¬¬1å</th><th>ç¬¬2å</th><th>ç¬¬3å</th><th>ç¬¬4å</th></tr></thead><tbody><tr><td><strong>ä¿¡æ¯ä¿ç•™</strong></td><td>LLMæ‘˜è¦</td><td>æ··åˆç­–ç•¥</td><td>TokenåŠ¨æ€</td><td>æ»‘åŠ¨çª—å£</td></tr></tbody></table>
<hr/>
<h4 data-id="heading-110"><strong>ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ</strong></h4>
<p><strong>å¤æ‚åº¦è¯…å’’ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">æ»‘åŠ¨çª—å£ï¼š
<span class="hljs-deletion">- ç®€å• â†’ å¿«</span>
<span class="hljs-deletion">- ç®€å• â†’ çœToken</span>
<span class="hljs-deletion">- ç®€å• â†’ ä¾¿å®œ</span>
<span class="hljs-deletion">- ç®€å• â†’ å¯é </span>

LLMæ‘˜è¦ï¼š
<span class="hljs-deletion">- å¤æ‚ â†’ æ…¢</span>
<span class="hljs-deletion">- å¤æ‚ â†’ è´¹Token</span>
<span class="hljs-deletion">- å¤æ‚ â†’ è´µ</span>
<span class="hljs-deletion">- å¤æ‚ â†’ å¯èƒ½å‡ºé”™</span>
</code></pre>
<p><strong>æ™ºèƒ½çš„ä»£ä»·ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">è·å¾—ï¼š100%ä¿¡æ¯ä¿ç•™
ä»˜å‡ºï¼š
<span class="hljs-deletion">- é€Ÿåº¦æ…¢29,000å€</span>
<span class="hljs-deletion">- Tokenå¤š4å€</span>
<span class="hljs-deletion">- æˆæœ¬$0.0001/æ¬¡</span>
<span class="hljs-deletion">- ç³»ç»Ÿå¤æ‚åº¦â†‘</span>

é—®é¢˜ï¼šè¿™ä¸ªtrade-offå€¼å¾—å—ï¼Ÿ
</code></pre>
<p><strong>ç­”æ¡ˆï¼šçœ‹åœºæ™¯</strong></p>
<pre><code class="hljs language-erlang" lang="erlang">çŸ­å¯¹è¯ï¼ˆ<span class="hljs-number">80</span><span class="hljs-comment">%åœºæ™¯ï¼‰ï¼š</span>
â†’ ä¸å€¼å¾—ï¼Œä¿¡æ¯æœ¬æ¥å°±ä¸ä¼šä¸¢

é•¿å¯¹è¯ï¼ˆ<span class="hljs-number">20</span><span class="hljs-comment">%åœºæ™¯ï¼‰ï¼š</span>
â†’ å€¼å¾—ï¼Œç”¨æˆ·ä½“éªŒæå‡æ˜æ˜¾
</code></pre>
<hr/>
<h4 data-id="heading-111"><strong>æ•™è®­</strong></h4>
<pre><code class="hljs language-erlang" lang="erlang">âŒ é”™è¯¯æƒ³æ³•ï¼šæ™ºèƒ½ = å¥½
âœ… æ­£ç¡®è®¤çŸ¥ï¼šç®€å• = å¥½ï¼ˆå¤§å¤šæ•°åœºæ™¯ï¼‰

å¯ç¤ºï¼š
â€¢ <span class="hljs-number">80</span><span class="hljs-comment">%åœºæ™¯ç”¨æ»‘åŠ¨çª—å£å°±å¤Ÿäº†</span>
â€¢ <span class="hljs-number">20</span><span class="hljs-comment">%åœºæ™¯æ‰éœ€è¦"æ™ºèƒ½"ç­–ç•¥</span>
â€¢ ä¸è¦ä¸ºäº†<span class="hljs-string">"æ™ºèƒ½"</span>è€Œç‰ºç‰²æ•ˆç‡
â€¢ Keep It Simple, Stupid (KISSåŸåˆ™)
</code></pre>
<hr/>
<h3 data-id="heading-112"><strong>4.6 æœ€éœ‡æ’¼çš„å‘ç°ï¼šä¸Šä¸‹æ–‡è¶Šé•¿ï¼Œæ•ˆç‡è¶Šä½</strong></h3>
<h4 data-id="heading-113"><strong>å®æµ‹æ•°æ®</strong></h4>



































<table><thead><tr><th>å¯¹è¯é•¿åº¦</th><th>æ»‘åŠ¨çª—å£Token</th><th>TokenåŠ¨æ€Token</th><th>æ¯”ä¾‹</th></tr></thead><tbody><tr><td>5è½®(126)</td><td>126</td><td>126</td><td>1.0x</td></tr><tr><td>10è½®(249)</td><td>123</td><td>194</td><td>1.6x</td></tr><tr><td>20è½®(560)</td><td>145</td><td>193</td><td>1.3x</td></tr><tr><td>30è½®(933)</td><td>144</td><td>191</td><td>1.3x</td></tr></tbody></table>
<p><strong>å…³é”®å‘ç°ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">å¯¹è¯è¶Šé•¿ï¼š
<span class="hljs-deletion">- ç»å¯¹Tokenæ•°å·®å¼‚ä¸å¤§ï¼ˆ144-145 vs 191-193ï¼‰</span>
<span class="hljs-deletion">- ä½†æ»‘åŠ¨çª—å£å‹ç¼©ç‡è¶Šé«˜ï¼ˆ85% vs 80%ï¼‰</span>
<span class="hljs-deletion">- TokenåŠ¨æ€ä¼˜åŠ¿æ¶ˆå¤±</span>
</code></pre>
<p><strong>çŸ›ç›¾ä¹‹å¤„ï¼š</strong></p>
<pre><code class="hljs language-erlang" lang="erlang">TokenåŠ¨æ€è®¾è®¡ç›®æ ‡ï¼šé•¿å¯¹è¯æ—¶å……åˆ†åˆ©ç”¨é¢„ç®—
å®é™…ç»“æœï¼šé•¿å¯¹è¯æ—¶ä¼˜åŠ¿åè€Œä¸æ˜æ˜¾

æ»‘åŠ¨çª—å£è®¾è®¡ç›®æ ‡ï¼šç®€å•å›ºå®šä¿ç•™
å®é™…ç»“æœï¼šé•¿å¯¹è¯æ—¶å‹ç¼©æ•ˆæœæœ€å¥½ï¼ˆ<span class="hljs-number">85</span><span class="hljs-comment">%ï¼‰</span>
</code></pre>
<hr/>
<h4 data-id="heading-114"><strong>ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ</strong></h4>
<p><strong>æ»‘åŠ¨çª—å£çš„"é¡¿æ‚Ÿæ—¶åˆ»"ï¼š</strong></p>
<pre><code class="hljs language-erlang" lang="erlang"><span class="hljs-number">5</span>è½® â†’ <span class="hljs-number">10</span>è½®ï¼šæ–°å¢<span class="hljs-number">5</span>è½®ï¼Œéœ€è¦å‹ç¼©
å‹ç¼©ç‡ï¼š<span class="hljs-number">0</span><span class="hljs-comment">% â†’ 51%</span>

<span class="hljs-number">10</span>è½® â†’ <span class="hljs-number">20</span>è½®ï¼šæ–°å¢<span class="hljs-number">10</span>è½®ï¼Œéœ€è¦å¤§é‡å‹ç¼©
å‹ç¼©ç‡ï¼š<span class="hljs-number">51</span><span class="hljs-comment">% â†’ 74%</span>

<span class="hljs-number">20</span>è½® â†’ <span class="hljs-number">30</span>è½®ï¼šæ–°å¢<span class="hljs-number">10</span>è½®ï¼Œç»§ç»­å‹ç¼©
å‹ç¼©ç‡ï¼š<span class="hljs-number">74</span><span class="hljs-comment">% â†’ 85%</span>

ç»“è®ºï¼šå¯¹è¯è¶Šé•¿ï¼Œæ»‘åŠ¨çª—å£å‹ç¼©æ•ˆç‡è¶Šé«˜
</code></pre>
<p><strong>TokenåŠ¨æ€çš„"å¤©èŠ±æ¿"ï¼š</strong></p>
<pre><code class="hljs language-diff" lang="diff">é¢„ç®—200å›ºå®šï¼š
<span class="hljs-deletion">- 10è½®(249) â†’ 194 tokensï¼ˆå°‘55ï¼‰</span>
<span class="hljs-deletion">- 20è½®(560) â†’ 193 tokensï¼ˆå°‘367ï¼‰</span>
<span class="hljs-deletion">- 30è½®(933) â†’ 191 tokensï¼ˆå°‘742ï¼‰</span>

ç»å¯¹å‹ç¼©é‡ï¼š55 â†’ 367 â†’ 742 â†‘
å‹ç¼©ç‡ï¼š22% â†’ 66% â†’ 80% â†‘

ä½†å§‹ç»ˆè¢«"200é¢„ç®—"é™åˆ¶
</code></pre>
<p><strong>ç»“è®ºï¼šé¢„ç®—æ˜¯TokenåŠ¨æ€çš„å¤©èŠ±æ¿</strong></p>
<hr/>
<h4 data-id="heading-115"><strong>æ•™è®­</strong></h4>
<pre><code class="hljs">âŒ é”™è¯¯æƒ³æ³•ï¼šå¤æ‚åœºæ™¯éœ€è¦å¤æ‚æ–¹æ¡ˆ
âœ… æ­£ç¡®è®¤çŸ¥ï¼šç®€å•æ–¹æ¡ˆå¯¹ä»˜å¤æ‚åœºæ™¯å¯èƒ½æ›´æœ‰æ•ˆ

å¯ç¤ºï¼š
â€¢ å¯¹è¯è¶Šé•¿ï¼Œæ»‘åŠ¨çª—å£ä¼˜åŠ¿è¶Šå¤§
â€¢ TokenåŠ¨æ€å—é¢„ç®—å¤©èŠ±æ¿é™åˆ¶
â€¢ ä¸è¦ä½ä¼°ç®€å•æ–¹æ¡ˆçš„æ½œåŠ›
</code></pre>
<hr/>
<h3 data-id="heading-116"><strong>4.7 æ ¸å¿ƒæ•™è®­ï¼šTrade-offæ— å¤„ä¸åœ¨</strong></h3>
<p>é€šè¿‡å®Œæ•´æµ‹è¯•ï¼Œæˆ‘ä»¬å‘ç°ï¼š<strong>ä¸å­˜åœ¨"å®Œç¾"çš„ç­–ç•¥ã€‚</strong></p>
<h4 data-id="heading-117"><strong>å››ä¸ªæ ¸å¿ƒTrade-off</strong></h4>
<p><strong>1. Tokenæ•ˆç‡ â†” ä¿¡æ¯ä¿ç•™</strong></p>
<pre><code class="hljs language-diff" lang="diff">æ»‘åŠ¨çª—å£ï¼š
<span class="hljs-deletion">- Tokenæœ€å°‘ï¼ˆ145ï¼‰</span>
<span class="hljs-deletion">- ä¿¡æ¯ä¿ç•™0%</span>

LLMæ‘˜è¦ï¼š
<span class="hljs-deletion">- Tokenå¾ˆå¤šï¼ˆ597ï¼‰</span>
<span class="hljs-deletion">- ä¿¡æ¯ä¿ç•™100%</span>

æ— æ³•åŒæ—¶ä¼˜åŒ–
</code></pre>
<hr/>
<p><strong>2. é€Ÿåº¦ â†” æ™ºèƒ½</strong></p>
<pre><code class="hljs language-diff" lang="diff">æ»‘åŠ¨çª—å£ï¼š
<span class="hljs-deletion">- é€Ÿåº¦æœ€å¿«ï¼ˆ0.00msï¼‰</span>
<span class="hljs-deletion">- ä¸æ™ºèƒ½ï¼ˆæœºæ¢°åˆ é™¤ï¼‰</span>

LLMæ‘˜è¦ï¼š
<span class="hljs-deletion">- é€Ÿåº¦æœ€æ…¢ï¼ˆ11,000msï¼‰</span>
<span class="hljs-deletion">- æœ€æ™ºèƒ½ï¼ˆç†è§£è¯­ä¹‰ï¼‰</span>

æ— æ³•åŒæ—¶ä¼˜åŒ–
</code></pre>
<hr/>
<p><strong>3. æˆæœ¬ â†” è´¨é‡</strong></p>
<pre><code class="hljs language-diff" lang="diff">æ»‘åŠ¨çª—å£ï¼š
<span class="hljs-deletion">- é›¶æˆæœ¬</span>
<span class="hljs-deletion">- å¯èƒ½ä¸¢å¤±ä¿¡æ¯</span>

LLMæ‘˜è¦ï¼š
<span class="hljs-deletion">- æœ‰æˆæœ¬ï¼ˆ$0.0001/æ¬¡ï¼‰</span>
<span class="hljs-deletion">- ä¿ç•™å®Œæ•´ä¿¡æ¯</span>

æ— æ³•åŒæ—¶ä¼˜åŒ–
</code></pre>
<hr/>
<p><strong>4. ç®€å• â†” çµæ´»</strong></p>
<pre><code class="hljs language-diff" lang="diff">æ»‘åŠ¨çª—å£ï¼š
<span class="hljs-deletion">- æç®€ï¼ˆ3è¡Œä»£ç ï¼‰</span>
<span class="hljs-deletion">- ä¸çµæ´»ï¼ˆå›ºå®šè½®æ•°ï¼‰</span>

æ··åˆç­–ç•¥ï¼š
<span class="hljs-deletion">- å¤æ‚ï¼ˆ50è¡Œä»£ç ï¼‰</span>
<span class="hljs-deletion">- çµæ´»ï¼ˆè‡ªåŠ¨é€‚åº”ï¼‰</span>

æ— æ³•åŒæ—¶ä¼˜åŒ–
</code></pre>
<hr/>
<h4 data-id="heading-118"><strong>å·¥ç¨‹ä¸­çš„æ™ºæ…§</strong></h4>
<pre><code class="hljs language-arduino" lang="arduino">ç†æƒ³ä¸»ä¹‰è€…ï¼š
<span class="hljs-string">"æˆ‘è¦ä¸€ä¸ªç­–ç•¥ï¼ŒTokenå°‘ã€é€Ÿåº¦å¿«ã€æˆæœ¬ä½ã€
 ä¿¡æ¯ä¿ç•™å¥½ã€è¿˜ç®€å•æ˜“ç”¨ï¼"</span>

ç°å®ï¼š
<span class="hljs-string">"ä¸å­˜åœ¨è¿™æ ·çš„ç­–ç•¥ã€‚"</span>

å·¥ç¨‹å¸ˆçš„é€‰æ‹©ï¼š
<span class="hljs-string">"æˆ‘è¦åœ¨Tokenæ•ˆç‡å’Œä¿¡æ¯ä¿ç•™ä¹‹é—´æ‰¾å¹³è¡¡ã€‚"</span>
â†’ é€‰æ‹©æ··åˆç­–ç•¥

<span class="hljs-string">"æˆ‘è¦åœ¨é€Ÿåº¦å’Œæˆæœ¬ä¹‹é—´æ‰¾å¹³è¡¡ã€‚"</span>
â†’ é€‰æ‹©æ»‘åŠ¨çª—å£

<span class="hljs-string">"æˆ‘è¦åœ¨ç®€å•å’Œçµæ´»ä¹‹é—´æ‰¾å¹³è¡¡ã€‚"</span>
â†’ é€‰æ‹©TokenåŠ¨æ€
</code></pre>
<hr/>
<h3 data-id="heading-119"><strong>4.8 åç›´è§‰ç»“è®ºæ€»ç»“</strong></h3>



































<table><thead><tr><th>ç›´è§‰æƒ³æ³•</th><th>å®æµ‹ç»“æœ</th><th>åŸå› </th></tr></thead><tbody><tr><td>LLMæ‘˜è¦æ•ˆç‡æœ€é«˜</td><td>çŸ­å¯¹è¯åè€Œæ›´å·®</td><td>æ ¼å¼å¼€é”€+LLMå•°å—¦</td></tr><tr><td>æ··åˆç­–ç•¥ç»¼åˆä¼˜ç‚¹</td><td>é•¿å¯¹è¯Tokenå¤š4å€</td><td>æ‘˜è¦æœ¬èº«å¾ˆ"èƒ–"</td></tr><tr><td>TokenåŠ¨æ€æ›´èŠ‚çœ</td><td>æ¯”æ»‘åŠ¨çª—å£å¤š58%</td><td>å°½é‡ç”¨æ»¡é¢„ç®—</td></tr><tr><td>Dequeæ¯”Listå¿«å¾ˆå¤š</td><td>åªå¿«8%</td><td>å®é™…æ“ä½œæ¬¡æ•°å°‘</td></tr><tr><td>æ™ºèƒ½ç­–ç•¥æ›´å¥½</td><td>æ»‘åŠ¨çª—å£å¤šç»´åº¦ç¬¬ä¸€</td><td>ç®€å•=å¿«=çœ=å¯é </td></tr></tbody></table>
<hr/>
<h3 data-id="heading-120"><strong>4.9 æœ€ç»ˆå»ºè®®ï¼šä»ç®€å•å¼€å§‹</strong></h3>
<p>åŸºäºæ‰€æœ‰æµ‹è¯•æ•°æ®ï¼Œæˆ‘ä»¬çš„<strong>æœ€ç»ˆå»ºè®®</strong>ï¼š</p>
<h4 data-id="heading-121"><strong>ç¬¬ä¸€é˜¶æ®µï¼šç”¨æ»‘åŠ¨çª—å£ï¼ˆ80%åœºæ™¯ï¼‰</strong></h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æœ€ç®€å•çš„æ–¹æ¡ˆ</span>
compressor = SlidingWindowCompressor(keep_turns=<span class="hljs-number">5</span>)

ä¼˜ç‚¹ï¼š
âœ… <span class="hljs-number">3</span>è¡Œä»£ç 
âœ… é›¶æˆæœ¬
âœ… æœ€å¿«
âœ… Tokenæœ€å°‘
âœ… å¯é 

é€‚ç”¨ï¼š
â€¢ çŸ­å¯¹è¯ï¼ˆâ‰¤<span class="hljs-number">10</span>è½®ï¼‰
â€¢ æˆæœ¬æ•æ„Ÿ
â€¢ å®æ—¶åœºæ™¯
â€¢ åˆæœŸMVP
</code></pre>
<hr/>
<h4 data-id="heading-122"><strong>ç¬¬äºŒé˜¶æ®µï¼šå‘ç°é—®é¢˜åå‡çº§</strong></h4>
<p><strong>è§‚å¯ŸæŒ‡æ ‡ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> ç”¨æˆ·æ˜¯å¦æŠ±æ€¨"ä¸è®°å¾—ä¹‹å‰è¯´çš„"ï¼Ÿ
<span class="hljs-bullet">2.</span> å¯¹è¯æ˜¯å¦ç»å¸¸è¶…è¿‡10è½®ï¼Ÿ
<span class="hljs-bullet">3.</span> æ˜¯å¦æœ‰å…³é”®ä¿¡æ¯ä¸¢å¤±ï¼Ÿ
<span class="hljs-bullet">4.</span> ç”¨æˆ·æ˜¯å¦éœ€è¦é‡å¤ä¿¡æ¯ï¼Ÿ
</code></pre>
<p><strong>å¦‚æœæ˜¯ï¼Œè€ƒè™‘å‡çº§åˆ°æ··åˆç­–ç•¥ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python">compressor = HybridCompressor(
    llm,
    threshold_turns=<span class="hljs-number">10</span>,
    keep_recent_turns=<span class="hljs-number">5</span>
)

ä¼˜ç‚¹ï¼š
âœ… çŸ­å¯¹è¯ä¿æŒæ»‘åŠ¨çª—å£é€Ÿåº¦
âœ… é•¿å¯¹è¯ä¿ç•™ç”¨æˆ·ä¿¡æ¯
âœ… è‡ªåŠ¨é€‚åº”

ç¼ºç‚¹ï¼š
âŒ é•¿å¯¹è¯Tokenå¤š<span class="hljs-number">4</span>å€
âŒ æœ‰æˆæœ¬
âŒ é€Ÿåº¦æ…¢ï¼ˆé•¿å¯¹è¯æ—¶ï¼‰
</code></pre>
<hr/>
<h4 data-id="heading-123"><strong>ç¬¬ä¸‰é˜¶æ®µï¼šç‰¹æ®Šåœºæ™¯ä½¿ç”¨ä¸“ç”¨ç­–ç•¥</strong></h4>
<p><strong>åœºæ™¯1ï¼šæœ‰Tokenä¸¥æ ¼é™åˆ¶</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç”¨TokenåŠ¨æ€</span>
compressor = TokenBasedCompressor(
    llm.count_tokens,
    max_tokens=<span class="hljs-number">200</span>
)
</code></pre>
<p><strong>åœºæ™¯2ï¼šè¶…é•¿å¯¹è¯ï¼ˆâ‰¥30è½®ï¼‰</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç”¨LLMæ‘˜è¦</span>
compressor = LLMSummaryCompressor(
    llm,
    keep_recent_turns=<span class="hljs-number">3</span>
)
</code></pre>
<h2 data-id="heading-124"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5287175b78ce44a2875ec6c1e15ca357~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQWdlbnRCdWlsZGVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765471478&amp;x-signature=D0DQJPG1rLkPwRWnYjuxTdIOzHQ%3D" alt="image.png" loading="lazy"/></h2>
<h3 data-id="heading-125"><strong>4.10 å†™åœ¨æœ€åï¼šæµ‹è¯•çš„ä»·å€¼</strong></h3>
<p>å¦‚æœæˆ‘ä»¬æ²¡æœ‰åšè¿™äº›æµ‹è¯•ï¼Œä¼šæœ‰ä»€ä¹ˆåæœï¼Ÿ</p>
<p><strong>å¯èƒ½çš„é”™è¯¯å†³ç­–ï¼š</strong></p>
<pre><code class="hljs language-erlang" lang="erlang">âŒ <span class="hljs-string">"LLMæ‘˜è¦æœ€æ™ºèƒ½ï¼Œå…¨éƒ¨ç”¨å®ƒï¼"</span>
   â†’ çŸ­å¯¹è¯Tokenå¢åŠ <span class="hljs-number">141</span><span class="hljs-comment">%ï¼Œæˆæœ¬æš´æ¶¨</span>

âŒ <span class="hljs-string">"æ··åˆç­–ç•¥ç»¼åˆä¼˜ç‚¹ï¼Œå°±ç”¨å®ƒï¼"</span>
   â†’ æ²¡æ„è¯†åˆ°Tokenå¤š<span class="hljs-number">4</span>å€ï¼Œæˆæœ¬è¶…é¢„ç®—

âŒ <span class="hljs-string">"TokenåŠ¨æ€ç²¾ç¡®æ§åˆ¶ï¼Œæœ€ä¼˜ï¼"</span>
   â†’ æ²¡æ„è¯†åˆ°æ¯”æ»‘åŠ¨çª—å£å¤šç”¨<span class="hljs-number">58</span><span class="hljs-comment">% Token</span>

âŒ <span class="hljs-string">"Dequeæ¯”Listå¿«ï¼Œå¿…é¡»ç”¨Dequeï¼"</span>
   â†’ èŠ±æ—¶é—´é‡æ„ï¼Œå®é™…åªå¿«<span class="hljs-number">8</span><span class="hljs-comment">%</span>
</code></pre>
<p><strong>æµ‹è¯•çš„ä»·å€¼ï¼š</strong></p>
<pre><code class="hljs language-vbnet" lang="vbnet">âœ… é¿å…åŸºäº<span class="hljs-string">"ç›´è§‰"</span>çš„é”™è¯¯å†³ç­–
âœ… å‘ç°åç›´è§‰çš„çœŸç›¸
âœ… é‡åŒ–Trade-<span class="hljs-keyword">off</span>
âœ… æ‰¾åˆ°é€‚åˆåœºæ™¯çš„æœ€ä¼˜è§£
</code></pre>
<hr/>
<h3 data-id="heading-126"><strong>4.11 å…³é”®æ•°æ®é€ŸæŸ¥è¡¨</strong></h3>
<p>ä¸ºäº†æ–¹ä¾¿æŸ¥é˜…ï¼Œè¿™é‡Œæ±‡æ€»æ‰€æœ‰å…³é”®æµ‹è¯•æ•°æ®ï¼š</p>
<h4 data-id="heading-127"><strong>å‹ç¼©æ•ˆç‡ï¼ˆé•¿å¯¹è¯20è½®ï¼Œ560 tokensï¼‰</strong></h4>













































<table><thead><tr><th>ç­–ç•¥</th><th>Token</th><th>å‹ç¼©ç‡</th><th>é€Ÿåº¦</th><th>æˆæœ¬</th><th>ä¿¡æ¯ä¿ç•™</th></tr></thead><tbody><tr><td>æ»‘åŠ¨çª—å£</td><td>145</td><td>74%</td><td>0.00ms</td><td>$0</td><td>0%</td></tr><tr><td>TokenåŠ¨æ€</td><td>193</td><td>66%</td><td>0.53ms</td><td>$0</td><td>ä¾èµ–é¢„ç®—</td></tr><tr><td>LLMæ‘˜è¦</td><td>597</td><td>-7%</td><td>13,446ms</td><td>$0.0001</td><td>100%</td></tr><tr><td>æ··åˆç­–ç•¥</td><td>604</td><td>-8%</td><td>11,663ms</td><td>$0.0001</td><td>100%</td></tr></tbody></table>
<h4 data-id="heading-128"><strong>é€‚ç”¨åœºæ™¯å¿«é€ŸåŒ¹é…</strong></h4>













































<table><thead><tr><th>åœºæ™¯ç‰¹å¾</th><th>æ¨èç­–ç•¥</th><th>æ ¸å¿ƒåŸå› </th></tr></thead><tbody><tr><td>å¯¹è¯â‰¤10è½®</td><td>æ»‘åŠ¨çª—å£</td><td>ç®€å•å¤Ÿç”¨</td></tr><tr><td>å¯¹è¯10-30è½®</td><td>æ··åˆç­–ç•¥</td><td>è‡ªåŠ¨é€‚åº”</td></tr><tr><td>å¯¹è¯â‰¥30è½®</td><td>LLMæ‘˜è¦</td><td>å”¯ä¸€æ­£æ”¶ç›Š</td></tr><tr><td>Tokené™åˆ¶ä¸¥æ ¼</td><td>TokenåŠ¨æ€</td><td>ç²¾ç¡®æ§åˆ¶</td></tr><tr><td>æˆæœ¬æ•æ„Ÿ</td><td>æ»‘åŠ¨çª—å£</td><td>é›¶æˆæœ¬</td></tr><tr><td>å®æ—¶è¦æ±‚</td><td>æ»‘åŠ¨çª—å£</td><td>æœ€å¿«</td></tr><tr><td>å¿…é¡»è®°ä½ç”¨æˆ·</td><td>æ··åˆç­–ç•¥/LLM</td><td>ä¿¡æ¯ä¿ç•™</td></tr></tbody></table>
<h4 data-id="heading-129"><strong>æ€§èƒ½åŸºå‡†</strong></h4>
<pre><code class="hljs language-diff" lang="diff">é€Ÿåº¦åŸºå‡†ï¼ˆ20è½®å¯¹è¯ï¼‰ï¼š
<span class="hljs-deletion">- æ»‘åŠ¨çª—å£: 0.00ms    â† æœ€å¿«</span>
<span class="hljs-deletion">- TokenåŠ¨æ€: 0.53ms    â† å¯æ¥å—</span>
<span class="hljs-deletion">- LLMæ‘˜è¦:  11,663ms   â† æ…¢22,000å€</span>

TokenåŸºå‡†ï¼ˆ20è½®å¯¹è¯ï¼‰ï¼š
<span class="hljs-deletion">- æ»‘åŠ¨çª—å£: 145 tokens  â† æœ€å°‘</span>
<span class="hljs-deletion">- TokenåŠ¨æ€: 193 tokens â† +33%</span>
<span class="hljs-deletion">- LLMæ‘˜è¦:  597 tokens  â† +312%</span>

æˆæœ¬åŸºå‡†ï¼ˆ100æ¬¡å‹ç¼©ï¼‰ï¼š
<span class="hljs-deletion">- æ»‘åŠ¨çª—å£: $0         â† å…è´¹</span>
<span class="hljs-deletion">- TokenåŠ¨æ€: $0         â† å…è´¹</span>
<span class="hljs-deletion">- æ··åˆç­–ç•¥:  $0.008     â† çœ‹åœºæ™¯</span>
<span class="hljs-deletion">- LLMæ‘˜è¦:  $0.01       â† æœ€è´µ</span>
</code></pre>
<hr/>
<h3 data-id="heading-130"><strong>4.12 å°ç»“ï¼šæµ‹è¯•æ”¹å˜äº†ä»€ä¹ˆ</strong></h3>
<p><strong>æµ‹è¯•å‰çš„æƒ³æ³•ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> LLMæ‘˜è¦åº”è¯¥æ˜¯æœ€å¥½çš„ï¼ˆæ™ºèƒ½å˜›ï¼‰
<span class="hljs-bullet">2.</span> æ··åˆç­–ç•¥ç»¼åˆä¼˜ç‚¹ï¼Œåº”è¯¥æ— æ•Œ
<span class="hljs-bullet">3.</span> TokenåŠ¨æ€ç²¾ç¡®æ§åˆ¶ï¼Œåº”è¯¥æœ€çœ
<span class="hljs-bullet">4.</span> Dequeæ¯”Listå¿«å¾ˆå¤šï¼Œå¿…é¡»ç”¨
</code></pre>
<p><strong>æµ‹è¯•åçš„è®¤çŸ¥ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> LLMæ‘˜è¦çŸ­å¯¹è¯æ˜¯è´Ÿä¼˜åŒ– âŒ
<span class="hljs-bullet">2.</span> æ··åˆç­–ç•¥é•¿å¯¹è¯Tokenå¤š4å€ âŒ
<span class="hljs-bullet">3.</span> TokenåŠ¨æ€å¯èƒ½æ¯”æ»‘åŠ¨çª—å£å¤š58% âŒ
<span class="hljs-bullet">4.</span> Dequeåªå¿«8%ï¼Œå·®å¼‚å¾®ä¹å…¶å¾® âŒ
</code></pre>
<p><strong>æœ€é‡è¦çš„é¢†æ‚Ÿï¼š</strong></p>
<pre><code class="hljs language-vbnet" lang="vbnet">âœ… æ²¡æœ‰<span class="hljs-string">"æœ€å¥½"</span>çš„ç­–ç•¥
âœ… åªæœ‰<span class="hljs-string">"æœ€é€‚åˆ"</span>çš„ç­–ç•¥
âœ… ç®€å•æ–¹æ¡ˆå¾€å¾€æ˜¯æœ€ä¼˜è§£
âœ… Trade-<span class="hljs-keyword">off</span>æ— å¤„ä¸åœ¨
âœ… æµ‹è¯•èƒœè¿‡ç›´è§‰
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e09910705d441bb819aaf395055db30~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQWdlbnRCdWlsZGVy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765471478&amp;x-signature=CRhlK%2BAiTVvMWYrPi%2F01uslRW28%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-131"><strong>äº”ã€æ€»ç»“ä¸å±•æœ›</strong></h2>
<h3 data-id="heading-132"><strong>5.1 æ ¸å¿ƒæ”¶è·</strong></h3>
<p>é€šè¿‡è¿™æ¬¡å®Œæ•´çš„å®æˆ˜ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä»¥ä¸‹å…³é”®è®¤çŸ¥ï¼š</p>
<p><strong>1. æ²¡æœ‰"å®Œç¾"çš„ç­–ç•¥</strong></p>
<ul>
<li>æ»‘åŠ¨çª—å£ï¼šæœ€å¿«ã€æœ€çœã€æœ€ç®€å•ï¼Œä½†ä¼šä¸¢ä¿¡æ¯</li>
<li>LLMæ‘˜è¦ï¼šä¿ç•™ä¿¡æ¯ï¼Œä½†æ…¢ä¸”è´µ</li>
<li>æ··åˆç­–ç•¥ï¼šè‡ªåŠ¨é€‚åº”ï¼Œä½†å¤æ‚</li>
<li>TokenåŠ¨æ€ï¼šç²¾ç¡®æ§åˆ¶ï¼Œä½†å¯èƒ½ç”¨æ›´å¤šToken</li>
</ul>
<p><strong>2. ç®€å•å¾€å¾€æ˜¯æœ€ä¼˜è§£</strong></p>
<ul>
<li>80%åœºæ™¯ï¼šæ»‘åŠ¨çª—å£å°±å¤Ÿäº†</li>
<li>20%åœºæ™¯ï¼šæ‰éœ€è¦"æ™ºèƒ½"ç­–ç•¥</li>
<li>è¿‡åº¦ä¼˜åŒ–åè€Œé™ä½æ•ˆç‡</li>
</ul>
<p><strong>3. æµ‹è¯•èƒœè¿‡ç›´è§‰</strong></p>
<ul>
<li>5ä¸ªåç›´è§‰å‘ç°</li>
<li>é¿å…äº†4ä¸ªé”™è¯¯å†³ç­–</li>
<li>èŠ‚çœäº†å¤§é‡æˆæœ¬</li>
</ul>
<h3 data-id="heading-133"><strong>5.2 å®æˆ˜æˆæœ</strong></h3>
<p>å®Œæ•´çš„ä»£ç å·²å¼€æºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsotopelaez092-star%2Fmemory-chatbot" target="_blank" title="https://github.com/sotopelaez092-star/memory-chatbot" ref="nofollow noopener noreferrer">github.com/sotopelaez0â€¦</a></p>
<p><strong>åŒ…å«ï¼š</strong></p>
<ul>
<li>âœ… 4ç§å‹ç¼©ç­–ç•¥çš„å®Œæ•´å®ç°</li>
<li>âœ… çœŸå®çš„æ€§èƒ½æµ‹è¯•ä»£ç </li>
<li>âœ… è¯¦ç»†çš„æµ‹è¯•æ•°æ®</li>
<li>âœ… å¯ç›´æ¥è¿è¡Œçš„ç¤ºä¾‹</li>
</ul>
<p><strong>Starå’ŒForkæ”¯æŒï¼</strong> â­</p>
<h3 data-id="heading-134"><strong>5.3 åç»­è®¡åˆ’</strong></h3>
<p>è®°å¿†ç³»ç»Ÿè¿˜æœ‰å¾ˆå¤šå¾…æ¢ç´¢çš„æ–¹å‘ï¼š</p>
<p><strong>ç³»åˆ—æ–‡ç« ç¬¬äºŒç¯‡ï¼šä¸­æœŸè®°å¿†æ¶æ„</strong></p>
<ul>
<li>Redisç¼“å­˜è®¾è®¡</li>
<li>PostgreSQLæŒä¹…åŒ–</li>
<li>å‘é‡æ£€ç´¢ä¼˜åŒ–</li>
<li>ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²</li>
</ul>
<p><strong>ç³»åˆ—æ–‡ç« ç¬¬ä¸‰ç¯‡ï¼šé•¿æœŸè®°å¿†</strong></p>
<ul>
<li>çŸ¥è¯†å›¾è°±</li>
<li>è¯­ä¹‰æ£€ç´¢</li>
<li>ä¸ªæ€§åŒ–æ¨è</li>
</ul>
<p><strong>æ•¬è¯·æœŸå¾…ï¼</strong></p>
<hr/>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ï¼š</p>
<ul>
<li>ğŸŒŸ ç»™GitHubé¡¹ç›®ç‚¹ä¸ªStar</li>
<li>ğŸ‘ ç‚¹èµæ”¯æŒ</li>
<li>ğŸ’¬ ç•™è¨€è®¨è®º</li>
<li>ğŸ”„ åˆ†äº«ç»™æ›´å¤šäºº</li>
</ul>
<p>æ„Ÿè°¢é˜…è¯»ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[8. å®šåˆ¶newå’Œdelete]]></title>    <link>https://juejin.cn/post/7579871631096135706</link>    <guid>https://juejin.cn/post/7579871631096135706</guid>    <pubDate>2025-12-04T16:48:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579871631096135706" data-draft-id="7579512734296309798" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="8. å®šåˆ¶newå’Œdelete"/> <meta itemprop="keywords" content="C++"/> <meta itemprop="datePublished" content="2025-12-04T16:48:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºçŒ¿æœ¬å‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/3868510676597259"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            8. å®šåˆ¶newå’Œdelete
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3868510676597259/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºçŒ¿æœ¬å‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T16:48:37.000Z" title="Thu Dec 04 2025 16:48:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å°ç»“</h2>
<ol>
<li><code>newå…³é”®å­—</code>åˆ†ä¸ºä¸¤æ­¥ï¼Œ<code>operator new</code>å’Œ<code>ç‹­ä¹‰placement new</code>ï¼Œå‰è€…å†…å­˜åˆ†é…ï¼Œåè€…åœ¨ç‰¹å®šå†…å­˜ä¸Šè°ƒç”¨æ„é€ å‡½æ•°</li>
<li><code>operator new</code>åˆå¯è®¾ç½®<code>std::nothrow</code>ï¼Œè®¾ç½®ä¹‹åå°±ä»£è¡¨æœ¬æ¬¡åˆ†é…ä¸è¶³ç›´æ¥è¿”å›<code>nullptr</code>ï¼Œæœªè®¾ç½®åˆ™è°ƒç”¨<code>new-handler()</code>ï¼Œå‡½æ•°è¿”å›ä¹‹åç»§ç»­å°è¯•é‡æ–°åˆ†é…ï¼Œå¾ªç¯æ­¤è¿‡ç¨‹ç›´åˆ°æˆåŠŸæˆ–æŠ›å‡º<code>std::bad_alloc</code>æˆ–å‡½æ•°è°ƒç”¨<code>std::abort()</code>ç»ˆæ­¢ç¨‹åº</li>
<li>ç¼–å†™newå’Œdeleteéœ€è¦éµå®ˆä¸€äº›è§„åˆ™ï¼Œæ¯”å¦‚å¤„ç†<code>size==0</code>ä»¥åŠç©ºæŒ‡é’ˆç­‰</li>
<li>æœ¬ç« çš„<code>placement new</code>é‡è½½æ˜¯å¹¿ä¹‰çš„ï¼Œä¸“é—¨åˆ¨é™¤<code>ç‹­ä¹‰placement new</code>ï¼Œå¦‚æœé‡è½½äº†<code>placement new</code>ï¼Œè¦é…å¥—å¯¹åº”çš„<code>placement delete</code>ï¼›å¦å¤–è¿™ç§å¯èƒ½å¯¼è‡´é®æ©ï¼Œä½¿å¾—æ™®é€šnewæ²¡æ³•ä½¿ç”¨</li>
</ol>
<h2 data-id="heading-1">49. äº†è§£new-handlerçš„è¡Œä¸º</h2>
<blockquote>
<p>æœ¬ç« operator newåªæœ‰åœ¨æ²¡è®¾ç½®std::nothrowæ‰ä¼šåœ¨åˆ†é…å†…å­˜å¤±è´¥åè°ƒç”¨new-handlerï¼Œæ‰€ä»¥æ­¤ç« é»˜è®¤ä¸è®¾ç½®</p>
</blockquote>
<ol>
<li><code>operator new</code>Â çš„è®¾è®¡é€»è¾‘æ˜¯ï¼š
<ol>
<li>åˆ†é…å¤±è´¥ â†’ è°ƒç”¨Â <code>new_handler</code>ã€‚ï¼ˆ<strong>ç”¨æˆ·å¯ä»¥é€šè¿‡<code>std::set-new-handler()</code>æ¥è®¾ç½®è¯¥å‡½æ•°</strong>ï¼‰</li>
</ol>
<ul>
<li><strong>æœŸæœ›</strong>Â <code>new_handler</code>Â èƒ½é€šè¿‡æŸç§æ–¹å¼ï¼ˆå¦‚é‡Šæ”¾é¢„ç•™å†…å­˜ï¼‰è®©åç»­åˆ†é…æˆåŠŸã€‚</li>
<li>å¦‚æœÂ <code>new_handler</code>Â è¿”å›ååˆ†é…ä»å¤±è´¥ï¼Œåˆ™<strong>å†æ¬¡è°ƒç”¨Â <code>new_handler</code></strong>ã€‚</li>
</ul>
<ol start="2">
<li>å¦‚æœÂ <code>new_handler</code>Â ä¸æ”¹å˜ä»»ä½•çŠ¶æ€ï¼Œåˆ†é…ä¼šä¸€ç›´å¤±è´¥ï¼Œå½¢æˆæ— é™é€’å½’ã€‚æ‰€æœ‰éœ€è¦ä¸€ä¸ªå¥½çš„è®¾è®¡ï¼š</li>
</ol>
<ul>
<li>è®©æ›´å¤šå†…å­˜å¯è¢«ä½¿ç”¨ï¼Œå³<strong>é‡Šæ”¾é¢„ç•™å†…å­˜</strong></li>
<li>ç»ˆæ­¢ç¨‹åºï¼Œè°ƒç”¨std::abort();</li>
<li>æŠ›å‡ºå¼‚å¸¸ï¼Œthrow std::bad_alloc;</li>
<li>å°†å‡½æ•°è®¾ç½®æˆnullptrï¼Œè¿™æ ·ç³»ç»Ÿä¼šè‡ªåŠ¨æŠ›å‡ºå¼‚å¸¸</li>
</ul>
</li>
<li>ç»™æ¯ç§classè®¾ç½®ä¸åŒçš„<code>new_handler</code>ï¼Œåšåˆ°<code>Widget::set_new_handler(func);Widget* ptr = new Widget();//å¦‚æœåˆ†é…å¤±è´¥è°ƒç”¨çš„æ˜¯func</code>
<ol>
<li>ä¸ºæ¯ç§classè®¾ç½®ä¸åŒçš„è®¾ç½®class</li>
</ol>
<ul>
<li>è¯¥å‡½æ•°å±äºclassï¼Œåº”è¯¥ä½¿ç”¨<strong>é™æ€æˆå‘˜å‡½æ•°</strong></li>
<li>è¦ç»™æ¯ç§ï¼Œå¯å€ŸåŠ©<strong>ç»§æ‰¿+template</strong>æ¥ä¸ºæ¯ç§classå…·è±¡åŒ–åŸºç±»class</li>
</ul>
<ol start="2">
<li>templateåŸºç±»çš„<strong>ç±»å‹å‚æ•°ä»…ä»…æ˜¯ç”¨äºæ ‡è¯†ä¸åŒç±»å‹</strong>ï¼Œå¦‚<code>Widget</code>ç»§æ‰¿<code>NewHandlerSupport&lt;Widget&gt;</code></li>
<li>æ¯æ¬¡è°ƒç”¨newï¼Œéœ€è¦è°ƒç”¨set_new_handler()è®¾ç½®æˆæœ¬ç±»è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œåˆ†é…å†…å­˜ä¹‹åï¼ˆæˆä¸ä¸æˆï¼‰éƒ½å¾—å†æ¬¡è°ƒç”¨set_new_handler()è®¾ç½®å›å»ï¼Œè¿™é‡Œå€ŸåŠ©<strong>RAIIï¼Œå°†å‡½æ•°çœ‹æˆèµ„æº</strong>ï¼Œè¿™æ ·å°±èƒ½åœ¨é€€å‡º<code>operator new</code>ä¹‹åè‡ªåŠ¨è®¾ç½®å›å»</li>
</ol>
</li>
<li>è°ƒç”¨<code>new (std::nothrow) Widget()</code>ï¼Œå¹¶ä¸æ„å‘³ç€ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå› ä¸ºè¿™ä¹‹åè¿˜ä¼šè°ƒç”¨<code>Widget</code>æ„é€ å‡½æ•°ï¼Œå¯èƒ½ä¼šç»§ç»­è°ƒç”¨newï¼Œè¿›è€ŒæŠ›å‡ºå¼‚å¸¸</li>
</ol>
<h2 data-id="heading-2">50. äº†è§£newå’Œdeleteçš„åˆç†æ›¿æ¢æ—¶æœº</h2>
<ol>
<li>æ›¿æ¢newå’Œdeleteçš„åŸå› æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚æƒ³å®ç°å†…å­˜æ± ã€æ£€æµ‹è¿ç”¨ä¸Šçš„é”™è¯¯ï¼ˆæ¯”å¦‚å¤šåˆ†é…ä¸¤ä¸ªintï¼Œå‰åå¡«å…¥æ ‡è¯†ï¼‰ä»¥åŠæ”¶é›†heapä½¿ç”¨ä¿¡æ¯ç­‰</li>
<li>è‡ªå®šä¹‰çš„newåˆ†ä¸ºå‡ ä¹è¡Œå¾—é€šï¼ˆé€»è¾‘æ²¡é—®é¢˜ï¼‰å’Œ<strong>çœŸæ­£è¡Œå¾—é€š</strong>ï¼Œå‰è€…å°±æ˜¯æ²¡æœ‰åœ¨æ„ä¸€äº›ç»†èŠ‚ï¼Œæ¯”å¦‚newä¸­éœ€è¦å¾ªç¯è°ƒç”¨new_handlerï¼Œå¦å¤–å°±æ˜¯æœ‰å¯¹é½é—®é¢˜ï¼Œ<code>::operator new</code>è‚¯å®šè¿”å›çš„æ˜¯å¯¹é½åçš„åœ°å€ï¼Œä½†æ˜¯å¦‚æœå†åŸºäºæ­¤åœ°å€å»åç§»ï¼ˆå¦‚åœ¨å‰é¢æ·»åŠ æ ‡å¿—ä½ï¼‰ï¼Œç„¶ååœ¨åç§»åçš„åœ°å€æ„é€ å°±å¯èƒ½æ²¡æœ‰å¯¹é½è¿›è€Œå‡ºé—®é¢˜</li>
</ol>
<h2 data-id="heading-3">51. ç¼–å†™newå’Œdeleteæ—¶éœ€å›ºå®ˆæˆè§„</h2>
<ol>
<li>operator newåº”è¯¥å†…å«æ— é™å¾ªç¯ï¼Œå¹¶åœ¨å…¶ä¸­å°è¯•åˆ†é…å†…å­˜ï¼Œå¦‚æœå®ƒæ— æ³•æ»¡è¶³å†…å­˜è¦æ±‚ï¼Œåˆ™è°ƒç”¨new-handlerã€‚åŒæ—¶ä¹Ÿè¦æœ‰èƒ½åŠ›å¤„ç†0bytesç”³è¯·ã€‚Classä¸“å±ç‰ˆæœ¬ï¼ˆå› ä¸ºå¯èƒ½å­˜åœ¨ç»§æ‰¿ï¼ŒDerivedè°ƒç”¨Baseçš„newæ–¹æ³•ï¼‰åˆ™è¿˜åº”è¯¥å¤„ç†â€œæ¯”æ­£ç¡®å¤§å°æ›´å¤§çš„ï¼ˆé”™è¯¯ï¼‰ç”³è¯·â€ï¼Œä¸€èˆ¬æ˜¯è°ƒç”¨<code>::operator new</code></li>
<li>operator deleteåº”è¯¥åœ¨æ”¶åˆ°nullpträ¸åšä»»ä½•å¤„ç†ï¼ŒClassä¸“å±ç‰ˆæœ¬è¿˜åº”è¯¥å¤„ç†â€œæ¯”æ­£ç¡®å¤§å°æ›´å¤§çš„ç”³è¯·â€ï¼Œä¸€èˆ¬æ˜¯è°ƒç”¨<code>::operator delete</code></li>
</ol>
<h2 data-id="heading-4">52. å†™äº†placement newä¹Ÿè¦å†™placement delete</h2>
<ol>
<li><strong>è¿™é‡Œæœ¯è¯­placement newæŒ‡çš„æ˜¯operator new()å‚æ•°ä¸æ­¢æ˜¯size_tï¼Œæ¯”å¦‚æ—¥å¿—å‡½æ•°ç­‰</strong>ï¼Œå…¶å®nothrowç‰ˆæœ¬ä¹Ÿå°±æ˜¯placement newï¼Œæ­¤å¤„å¹¶ä¸åŒ…å«ç‹­ä¹‰çš„å®šä½new</li>
<li>å½“ä½¿ç”¨ <strong>placement newæ„é€ å¯¹è±¡å¤±è´¥ï¼ˆæ„é€ å‡½æ•°æŠ›å‡ºå¼‚å¸¸ï¼‰</strong> æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è°ƒç”¨<strong>åŒ¹é…çš„placement delete</strong>é‡Šæ”¾å†…å­˜ã€‚è‹¥æœªå®šä¹‰åŒ¹é…çš„placement deleteï¼Œå·²åˆ†é…çš„å†…å­˜å°†æ³„æ¼ã€‚</li>
<li>å¦‚æœä½¿ç”¨placement newæ„é€ ï¼Œæ˜¾å¼è°ƒç”¨<code>delete p</code>æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè°ƒç”¨<strong>æ™®é€šoperator delete</strong>ï¼ˆ<code>operator delete(size_t)</code>ï¼‰ï¼Œè€Œéplacement deleteã€‚</li>
<li>æ‰€ä»¥å¯¹äºä¸€ä¸ªplacement newï¼Œéœ€è¦å†™operator deleteï¼ˆæ— å¼‚å¸¸æƒ…å†µï¼‰å’Œplacement deleteï¼ˆæ„é€ æŠ›å‡ºå¼‚å¸¸ï¼‰ä¸¤ä¸ªå‡½æ•°</li>
<li>è‹¥æ´¾ç”Ÿç±»å®šä¹‰äº†<strong>ä»»ä½•operator newé‡è½½</strong>ï¼ˆå«placement newï¼‰ï¼Œä¼š<strong>é®æ©åŸºç±»çš„æ‰€æœ‰operator newä»¥åŠå…¨å±€çš„operator newç‰ˆæœ¬</strong>ï¼ˆåŒ…æ‹¬æ™®é€šç‰ˆæœ¬ï¼‰ã€‚éœ€æ˜¾å¼usingå£°æ˜ç»§æ‰¿åŸºç±»æˆ–å…¨å±€ç‰ˆæœ¬</li>
<li>æ‰€ä»¥å¦‚æœé‡æ„äº†placement newè€Œæ²¡æœ‰é‡æ„æ™®é€šç‰ˆæœ¬ï¼Œç›´æ¥è°ƒç”¨<code>new Widget()</code>æŠ¥é”™ï¼Œå› ä¸ºè¢«é®æ©äº†</li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Widget</span> {
<span class="hljs-keyword">public</span>:
    <span class="hljs-comment">// è‡ªå®šä¹‰ placement newï¼ˆå¸¦é¢å¤–å‚æ•°ï¼‰</span>
    <span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">void</span>* <span class="hljs-keyword">operator</span> <span class="hljs-title">new</span><span class="hljs-params">(<span class="hljs-type">size_t</span> size, <span class="hljs-type">int</span> extra_arg)</span> </span>{
        std::cout &lt;&lt; <span class="hljs-string">"è°ƒç”¨è‡ªå®šä¹‰ placement new\n"</span>;
        <span class="hljs-keyword">return</span> ::<span class="hljs-keyword">operator</span> <span class="hljs-built_in">new</span>(size); <span class="hljs-comment">// å§”æ‰˜å…¨å±€ operator new</span>
    }

    <span class="hljs-comment">// âŒ æœªæ˜¾å¼ä¿ç•™æ™®é€š operator new</span>
};

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    Widget* p1 = <span class="hljs-built_in">new</span>(<span class="hljs-number">42</span>) <span class="hljs-built_in">Widget</span>(); <span class="hljs-comment">// âœ… è°ƒç”¨è‡ªå®šä¹‰ placement new</span>
    Widget* p2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Widget</span>();     <span class="hljs-comment">// âŒ æŠ¥é”™ï¼šæ‰¾ä¸åˆ°æ™®é€š operator new</span>
}
</code></pre>
<ol start="7">
<li>cppå…¨å±€æ ‡å‡†çš„operator newï¼Œ<strong>å¦‚æœå®šä¹‰äº†classä¸“å±newï¼Œåˆ‡è®°å¯¼è‡´çš„é®æ©ç°è±¡</strong></li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;new&gt;</span> <span class="hljs-comment">// ä¸ºäº†ä¸æŠ›é”™ä»¥åŠå®šä½new</span></span>

<span class="hljs-function"><span class="hljs-type">void</span>* <span class="hljs-keyword">operator</span> <span class="hljs-title">new</span><span class="hljs-params">(std::<span class="hljs-type">size_t</span> size)</span></span>;
<span class="hljs-function"><span class="hljs-type">void</span>* <span class="hljs-keyword">operator</span> <span class="hljs-title">new</span><span class="hljs-params">(std::<span class="hljs-type">size_t</span> size, <span class="hljs-type">const</span> std::<span class="hljs-type">nothrow_t</span>&amp;)</span> <span class="hljs-keyword">noexcept</span></span>; <span class="hljs-comment">// ä¸æŠ›é”™çš„ç‰ˆæœ¬</span>
<span class="hljs-function"><span class="hljs-type">void</span>* <span class="hljs-keyword">operator</span> <span class="hljs-title">new</span><span class="hljs-params">(std::<span class="hljs-type">size_t</span> size, <span class="hljs-type">void</span>* ptr)</span> <span class="hljs-keyword">noexcept</span></span>;<span class="hljs-comment">//æ­¤ç‰ˆæœ¬æ˜¯æ ‡å‡†çš„placement newï¼Œä¸å…è®¸è¢«é‡æ„</span>

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>{
    <span class="hljs-type">int</span>* p = <span class="hljs-keyword">new</span> <span class="hljs-type">int</span>; <span class="hljs-comment">// åº•å±‚è°ƒç”¨ operator new(sizeof(int))</span>
     <span class="hljs-type">int</span>* p = <span class="hljs-built_in">new</span> (std::nothrow) <span class="hljs-type">int</span>; <span class="hljs-comment">// å¤±è´¥æ—¶ p == nullptr</span>
     <span class="hljs-type">char</span> buffer[<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">int</span>)]; 
     <span class="hljs-type">int</span>* p = <span class="hljs-built_in">new</span> (buffer) <span class="hljs-built_in">int</span>(<span class="hljs-number">42</span>); <span class="hljs-comment">// åœ¨ buffer ä¸Šæ„é€  int</span>
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[aiçŸ¥è¯†çš„åˆæ­¥äº†è§£]]></title>    <link>https://juejin.cn/post/7579813925996822569</link>    <guid>https://juejin.cn/post/7579813925996822569</guid>    <pubDate>2025-12-04T17:14:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579813925996822569" data-draft-id="7579871631095988250" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="aiçŸ¥è¯†çš„åˆæ­¥äº†è§£"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2025-12-04T17:14:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ²³ç•”çš„é£"/> <meta itemprop="url" content="https://juejin.cn/user/791287056047591"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            aiçŸ¥è¯†çš„åˆæ­¥äº†è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/791287056047591/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ²³ç•”çš„é£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T17:14:10.000Z" title="Thu Dec 04 2025 17:14:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px;color:#5e7ce0}.markdown-body h1{font-size:24px;margin-bottom:5px;margin-top:80px;position:relative;text-align:center}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px;margin-top:30px}.markdown-body h5{font-size:14px;margin-top:20px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #dfe1e6;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#ffeeed;color:#c73636;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#f8f8f8}.markdown-body a{position:relative;text-decoration:none;color:#5e7ce0;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAACCgAwAEAAAAAQAAACAAAAAAX7wP8AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAABWVJREFUWAnlVktsVFUY/s85997pC9BOTKxRWnEKsXWlxjWJj0RWJjrFAAXjAlewYWOkgauACVu7a2IiNUEyExM3yoZE3Wmi7qgPJthJBDE6JUNpO3Mf5/j95/bOTOcBlBgXejJ37rn/Of/7O/9/iP7vQ/zTAcjnC4ry+a5ii1OkiYTpuvjvEc0Gp51uivP+ZW+QBuSW4QjW5rptAa1Ey0uOGKOxwPetVyafN6p/52/PkNBbjdAhGaGEpMRjLZTryB8+9MUSYSGNRIcBvm8kBAY9tHYlHz78nTs392xIkwv9FA3Oe33bdoX1ZZKOS0bH0CXI6RugYLW6BwIu5gskkQ4sEG0wYF25PjBzbZfSYY6kDLUmWMt7FR7Lw3xYUkaTdjxHfTPnPwav0iEGYADVa9XIRIEyxrAA0jIQxgFL22gYwF7A8/DAzNVdksJvJaTEUZ2kYnZWziN5s1ADPHneEIXByotYuMSrf9JEbbsuv7VcvbaKML8plXtQR0EdIYDqWEmtOgAomZFH8EjWSnek2ulmtljljttHbmaIHCCCHzd9MjwfsmscBeZH9Jyd10nMvz92UQrtCBKvMF06mQy0SiEdRMEGg8mN0YjAlgoDDkPrMI5qJKSkKKydpbB2CZjJkhIBvOBw2CGQgii85bpx//dMqFRKam5uvH7w+K97oe+Cl0HO68uIBH0qyEzpOMwIbZIcFq0I+9cwoElizCjk2KFI1y7Nnx614W1db58fOXIlMzs7Xn/jeDmvBV2Q0mXjGf554O/m4LZHp2N8r61WPMvLZWLdiC4GMAk5BjeeB5lhv39l6+BIbu3m760hXMDKBD08XBKzR8fr04nygnIypOOAJUx/fHrsi0Mnys+vVK+V4VUohaiyPCo2Q9DFALvF/ikw8WS4QvVZALS5ksw47/7R8ejgTPk1UFqU6/3zp8bOM7B/kdu/fkguPGU5JibW+F0sTjWOUw8DklRrg4BiLGeBqbaRLxjlT4no0InFV402RcftJz41cH/f/JnHP3kZaaF6VX/liwist9vYG5+NU9Cg3MNkt/+lU5wS8fTxq3mc7ILjDlAE4CJpe89BOWPiIjBhi9O6PI4G1jsc6RGB3lZwmS76k8H0zOKTkFboG8jS2krFKCX2fvTeaPHIBwAkMHHgncURnL3nuCSnxSopdIzN5th0BIonJ0Lf9yUA9iMkzdRWl3BixOusfDcwQVcS4UKIFwYfGPnM8wY/DyP9NFMXaTE5BU39tGkDgGZz+fJJG0oYcSaOafLcqdECY4LzfSObSzyUOgxqtyisr8SSNOOAkubWoh3TTaeA2YtFEXPnm5x81/j+6MI6JqyS25WSNU6hbCMKHG84marJbdR+vwakRhQLRuQpbzHRLjmpmijI+OmWCtq+LzWtnX5v30gHSsqmWne74DtiACi2+Wz0iXbuLt9D2cDyoPEkWOiyp5XUIwLMi/wJY1FbH5B9ONtdC1KrsD/Q0MCQAS0wccILORDW25amAeOtooAj/KQxfzF17uwTSQ1v3dJ7jnLINwdZYRDa4tPU0sHVXFo/vxFF5BqFqxRfOmgPCk4ft2NgKTCy2Y47JIEg+MIhjYsLy5I25qUYTQlCjMRHsr/UwdYwIK33UO1J5fFNB9XNO6akcywJofVmXQDP2wfrSPcI2xG5BSs3I+IosHr4EtvO1TDAu16xHQq5+ykMblfRXLbhEoFIdDTBdhldvzl+3CMg60ZktI2vNzLW6IIp0waLklot9L63yzuUp8dJd7bglPFe3hIXstBEP58/s6Ocyr4rH2+866ZNbriTzA0RSOWCwakMl1QJgculxPt8Z7O5GLdtW6bvU8R/nO1vb+hMExVAVtEAAAAASUVORK5CYII=");background-size:100%}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #5e7ce0}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #5e7ce0;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#5e7ce0}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#f2f5fc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #5e7ce0;background-color:#f2f5fc}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5e7ce0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ul li::marker{content:"â€¢";color:#5e7ce0}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]:before{display:inline-block;width:16px;height:16px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAhRJREFUeAHtnLEuBFEUhs9cu7JCskEhIrZAgYZGoREPwBuIygOoPITKA6jEG/AAolFoaFCgICIKZBNiY8Pyz5rNOWe9wNz5T7N3Z2eT/b/7zZlpziat3xKWBDJoEyh5EDd3DTk5r8vV7Yc8vzbl6zvfwvSERIYHyzI90SeLc1WZrFV85PR9oi+N/YMnOT6t/3tiLAeXFqqytjrSFacDYmfvQS6u37tOiPHA7FS/bK6PmWhpj4AJRYGA9MiKzLpK6An+cqiNVmRleUhArrec6PNzt/5sttLgh0cvcvfY6Px+ZNY9I6Ax6gKErY1xmZ8ZyD0E5MJGIgsyIZsunT3g7qALJuTdAp0nWyMTsunS2QNukbpwOcRaPpvOHvxzQow2ZBvrs+nsfLL8o0QQBJFdMO1XGkEjaIQlQCMsD/YIGkEjLAEaYXmwR9AIGmEJ0AjLgz2CRtAIS4BGWB7sETSCRlgCNMLyYI+gETTCEqARlgd7BI2gEZYAjbA82CNoBI2wBGiE5cEeQSNohCVAIywP9ggaQSMsARphebBH0AgaYQnQCMsjYC5SF2agYi2fTWcPGA7VFfO0n8+mswdMyOrCNJwnpz/P6xqZkE2Xzh4w8qcLI4Hbu/dydvkWBRAAQBZk0uOOyKyzp5PARRiF1puNtR+NTh+oMCvtJ+D8F2N6j6x+PrwzG46gRTDDm5BtsAGBg0X924Qfj7i23p7HNgQAAAAASUVORK5CYII=");background-size:100%;position:relative;right:2px;top:-5px}.markdown-body input[type=checkbox]:checked:before{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAABMtJREFUeAHtXM2KFDEQzrQKruIu4mEXRFlUVLz4A4K7B99AcO8io0/gwQfxDVzFuwu+gQf34EG8iOAPKAh6EFlBFMSf/qa2uqszlVR6ZtYxM5PDJNVVSer78nU6KrHzpyxuVlwx44AY2O0T8eb9D7f5fMu9fPvdff7y0/36nbdgdhUdd+jgHnf62JxbObvgjh/d60Pu2R35ajx49Mk9frqlBk7Kw8sXF9y1K4t9cCoi7tz/4F68/tYXMIkPzpzY725dP9yA1tsjoIRpIQHogRWYZSmwJ4Reh06nI2Nd7rYEA8zAzqXAxhgq/pc1d9vHKbEX+Dr4JbzypJDc/YxXYi/wifRLeOXpU5q7n/FK7EXsnBBeeRoqd7/EHj1ZhleeiMjdz8pArRKR+0pb+UsCuK0SkftKW/kzeFmrRHCAxWzufsaJOkqExWzufpOI8EpP1jnCJCK80pN1jjCJ4ICwMigidz/jRD3bI7bZUInIfaWt/KUSuK0SEd4jqFvufgYva5UIDrCYzd3POFFHifhfV/7k8lwPw7D5mUSEV3r854ju2pK7ffOIWzk/X+Go803Lr+ooGqoiwkyP9xzRXVt0q9sE3CgJYTLqfNPyE/irpkoEe2um6ck4bSiBSeD8JBl41jY/Hgd1lIiaaeoyLlsjgUGAjEH3DB4DtUpEW2Z3Mj5GAgA8efbVvXpX/200nln5IMYvKhHDrvylcwdc9+pSNdeg46WQsP7wo2s7fpWYaPT926fw9ZiVk4BpywYJkGuvlJs4EuWS0p/HTyHh3kbzH2najM85cR0lgpPiYMtukFB26m1u5Ua+vkFkWP3Zn0KCJDg1Px6f42Wtvhrhdyz8ncanrFKCmGH1wrwDMCrh/uxPIUFTAvdHbeVPsc1fVRE+c7Ud/k6fWt7XHFlYqcqQ5wTRvWpiY4wrIZwfDUL+akDRUBXB/jCzFCH9SHCzTDRUmsro7z+cEvrHwxOZn2ZTL/pVFcEBtRLoiWXfxQ5ehvoHHx4vpIwUEuJKSMvPz5/zQq0qwmIy5m+rjBQSwnsCQYnlgwjfT72av6oifOba2qnKcOXeGVIP0rT3BALTNr8mBWSpRHAgmJSTtLGhDHwj+A9GPCbX2DNiBSRoShg0H8zl5y/njxIhJ0WntralDJmIbO+UEvz85Zwt9wj7HIDB5Ttp7RkyGbRDSqC49vOjX50P9aexmr+qInzmajvtO13H02SpyrCVMNj8dT7/4BwByDXzRIC0LWXEldA/njVfip9GpV9VERxQM0lPhrVDyrCVMJr5/fwZJ+qWewR1lSuNJ21sXxnjVgIhck5VhM/cqG1WBpIAMX4Z9Xz+eP58sFUiOBArLQcZpQ0CNCXt1HzA5OfPOFGrrwYHyKTwbNJsxolaJUJbKeo0mu/4uMeXBHBbJSK88qP5jo97fAYva5UIDgivHEXk7mecqKNEhFeOhsjdbxKR+0pb+UsCuK0qIveVtvJn8LJWieAAi9nc/YwTdZQIi9nc/SYR4ZWenSO2yZvgcwTuRYZKWBnUI3e/xF7gcmio5L4HWPlL7AVuyPol95W28me8EnuBa8J+sZjM3c94JfYCd6VxTXjaCjDLe+K9cwTuSuOa8LQUYPXvh1d3w0HC7JK8kMK0/rcJfwHkVMYgi4xhOgAAAABJRU5ErkJggg==");background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. éœ€è¦å­¦ä¼šçš„æŠ€èƒ½</h2>
<h3 data-id="heading-1">1.1 æç¤ºè¯å·¥ç¨‹(prompt)</h3>
<p><strong>ç”¨æˆ·æä¾›ç»™äººå·¥æ™ºèƒ½çš„æŒ‡ä»¤æˆ–é—®é¢˜ï¼Œç”¨äºå¼•å¯¼å’Œæ¿€å‘æ¨¡å‹å®Œæˆç‰¹å®šä»»åŠ¡</strong></p>
<h3 data-id="heading-2">1.2 ai agent(æ™ºèƒ½ä½“ï¼‰</h3>
<p><strong>èƒ½æ„ŸçŸ¥ç¯å¢ƒã€è‡ªä¸»å†³ç­–å¹¶æ‰§è¡ŒåŠ¨ä½œä»¥å®ç°ç›®æ ‡çš„æ™ºèƒ½ä½“</strong></p>
<ul>
<li><strong>æ ¸å¿ƒç‰¹å¾ï¼š</strong> Â å®ƒå…·å¤‡<strong>è‡ªä¸»æ€§</strong>ï¼Œæ— éœ€æ¯ä¸€æ­¥éƒ½ç”±äººç±»æŒ‡å¯¼</li>
<li><strong>åŸºæœ¬æ¡†æ¶ï¼š</strong> Â é€šå¸¸éµå¾ªç»å…¸çš„Â  <strong>â€œæ„ŸçŸ¥-è§„åˆ’-è¡ŒåŠ¨â€</strong> Â 
<ul>
<li><strong>æ„ŸçŸ¥ï¼š</strong> Â ä½¿ç”¨å·¥å…·ï¼ˆå¦‚æœç´¢å¼•æ“ã€æ‘„åƒå¤´ã€æ•°æ®åº“ï¼‰è·å–å¤–ç•Œä¿¡æ¯ã€‚</li>
<li><strong>è§„åˆ’ï¼š</strong> Â æ€è€ƒå¦‚ä½•åˆ†è§£ç›®æ ‡å¹¶åˆ¶å®šæ­¥éª¤</li>
<li><strong>è¡ŒåŠ¨ï¼š</strong> æ‰§è¡Œå…·ä½“æ“ä½œï¼ˆå¦‚è°ƒç”¨APIã€æ§åˆ¶æœºæ¢°è‡‚ã€ç”Ÿæˆæ–‡æœ¬ï¼‰æ¥æ”¹å˜ç¯å¢ƒ</li>
</ul>
</li>
</ul>
<h3 data-id="heading-3">1.3 RAG</h3>
<p>é€šè¿‡ä»å¤–éƒ¨èµ„æºæˆ–æ•°æ®åº“ä¸­çº³å…¥ç›¸å…³ä¿¡æ¯æ¥å®ç°çŸ¥è¯†çš„å¢å¼ºï¼Œä¸€ç§é€šè¿‡æ£€ç´¢å¤–éƒ¨çŸ¥è¯†æ¥å¢å¼ºç”Ÿæˆå†…å®¹å‡†ç¡®æ€§å’Œç›¸å…³æ€§çš„æŠ€æœ¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b9b745c520e406c80afb914d0e1df90~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKz55WU55qE6aOO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765473250&amp;x-signature=5uNi5y4hMwxbcWjXsA%2BDsknu%2BLA%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-4">1.4 Function Calling</h3>
<p><strong>ä¸å¤–éƒ¨å‡½æ•°æˆ–APIäº¤äº’çš„èƒ½åŠ›ï¼Œå¤§è¯­è¨€æ¨¡å‹æ ¹æ®ç”¨æˆ·è¯·æ±‚ï¼Œæ™ºèƒ½è¯†åˆ«å¹¶è¾“å‡ºç»“æ„åŒ–å‚æ•°ï¼Œä»¥è°ƒç”¨å¤–éƒ¨å·¥å…·æˆ–å‡½æ•°çš„èƒ½åŠ›</strong></p>
<ol>
<li><strong>å®ƒçš„è§’è‰²ï¼š</strong> å®ƒæ˜¯å¤§æ¨¡å‹ï¼ˆå¦‚ChatGPTï¼‰ä¸å¤–éƒ¨ä¸–ç•Œï¼ˆå¦‚æ‰§è¡Œä»£ç ã€æŸ¥è¯¢æ•°æ®åº“ã€è°ƒç”¨APIï¼‰è¿›è¡Œäº¤äº’çš„â€œæ¡¥æ¢â€å’Œâ€œç¿»è¯‘å®˜â€ã€‚</li>
<li><strong>å·¥ä½œæµç¨‹ï¼š</strong> æ¨¡å‹ä¸ç›´æ¥æ‰§è¡Œå‡½æ•°ï¼Œè€Œæ˜¯é€šè¿‡åˆ†æä½ çš„è‡ªç„¶è¯­è¨€æŒ‡ä»¤ï¼ˆä¾‹å¦‚ï¼šâ€œç»™å¼ ä¸‰å‘é‚®ä»¶ï¼Œæé†’ä»–æ˜å¤©ä¸‹åˆä¸‰ç‚¹å¼€ä¼šâ€ï¼‰ï¼Œç„¶åè¾“å‡ºä¸€ä¸ªç»“æ„åŒ–çš„JSONå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«éœ€è¦è°ƒç”¨çš„å‡½æ•°åï¼ˆ<code>send_email</code>ï¼‰å’Œæ­£ç¡®çš„å‚æ•°ï¼ˆ<code>recipient: "å¼ ä¸‰"</code>, <code>content: "..."</code>ï¼‰ï¼Œæœ€åç”±å…¶ä»–ç¨‹åºæ¥æ‰§è¡Œè¿™ä¸ªå‡½æ•°ã€‚</li>
</ol>
<h3 data-id="heading-5">1.5 Embedding</h3>
<p><strong>Embeddingæ˜¯å°†æ–‡å­—ã€å›¾åƒæˆ–å£°éŸ³ç­‰é«˜ç»´å¤æ‚æ•°æ®ï¼Œè½¬æ¢ä¸ºä¸€ç³»åˆ—ä½ç»´ç¨ å¯†å‘é‡çš„è¿‡ç¨‹ã€‚</strong></p>
<ul>
<li><strong>æ ¸å¿ƒç›®çš„ï¼š</strong> Â å°†äººç±»èƒ½ç†è§£çš„ç¬¦å·ï¼ˆå¦‚å•è¯ã€å¥å­ï¼‰è½¬æ¢æˆè®¡ç®—æœºèƒ½å¤Ÿç†è§£å’Œè®¡ç®—çš„æ•°å­¦å½¢å¼ï¼ˆå³å‘é‡ï¼‰ã€‚</li>
<li><strong>å…³é”®ç‰¹æ€§ï¼š</strong>
<ul>
<li><strong>è¯­ä¹‰ä¿¡æ¯ï¼š</strong> Â åœ¨è¿™ä¸ªå‘é‡ç©ºé—´ä¸­ï¼Œè¯­ä¹‰ç›¸è¿‘çš„è¯è¯­ï¼ˆå¦‚â€œå›½ç‹â€å’Œâ€œçš‡åâ€ï¼‰æˆ–å¥å­ï¼Œå…¶å‘é‡åœ¨ç©ºé—´ä¸­çš„ä½ç½®ä¹Ÿæ›´æ¥è¿‘ã€‚</li>
<li><strong>å¯è®¡ç®—æ€§ï¼š</strong> Â è®¡ç®—æœºå¯ä»¥é€šè¿‡è®¡ç®—å‘é‡ä¹‹é—´çš„è·ç¦»æˆ–ä½™å¼¦ç›¸ä¼¼åº¦ï¼Œæ¥åˆ¤æ–­ä¸¤æ®µå†…å®¹çš„ç›¸ä¼¼æ€§ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-6">1.6 Fine-tuningï¼ˆå¾®è°ƒï¼‰</h3>
<p><strong>æ˜¯åœ¨é¢„è®­ç»ƒæ¨¡å‹çš„åŸºç¡€ä¸Šï¼Œä½¿ç”¨ç‰¹å®šé¢†åŸŸçš„æ•°æ®è¿›è¡Œé¢å¤–è®­ç»ƒï¼Œä½¿å…¶ä¸“é—¨åŒ–ä»¥é€‚åº”æ–°ä»»åŠ¡çš„è¿‡ç¨‹</strong></p>
<p>æ¯”å–»ï¼šè€å¸ˆï¼ˆå¼€å‘è€…ï¼‰é’ˆå¯¹å­¦ç”Ÿçš„ç‰¹é•¿ï¼ˆæ¨¡å‹çš„æ½œåŠ›ï¼‰ï¼Œç”¨ä¸“é—¨çš„ç»ƒä¹ é¢˜ï¼ˆé¢†åŸŸæ•°æ®ï¼‰è¿›è¡Œè¾…å¯¼ï¼Œå¼ºåŒ–ä»–åœ¨ç‰¹å®šç§‘ç›®ä¸Šçš„èƒ½åŠ›</p>
<h3 data-id="heading-7">1.7 LlamaIndex</h3>
<p><strong>ä¸€ä¸ªä¸“ä¸ºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰åº”ç”¨ç¨‹åºè®¾è®¡çš„æ•°æ®æ¡†æ¶ï¼Œå®ƒèƒ½é«˜æ•ˆåœ°å°†ç§æœ‰æˆ–ç‰¹å®šé¢†åŸŸçš„æ•°æ®ä¸LLMç»“åˆèµ·æ¥</strong></p>
<p>è¿™ä¸ªæ¡†æ¶çš„æ ¸å¿ƒä½œç”¨æ˜¯è§£å†³LLMåœ¨å¤„ç†å¤–éƒ¨ç§æœ‰æ•°æ®æ—¶é‡åˆ°çš„å›°éš¾ã€‚
å®ƒé€šè¿‡ä¸€å¥—å·¥å…·ï¼Œå¸®åŠ©ä½ è½»æ¾åœ°ä»å„ç§æ•°æ®æºï¼ˆå¦‚PDFã€æ•°æ®åº“ã€APIï¼‰æ‘„å–æ•°æ®ï¼Œå¹¶æ„å»ºæˆæ˜“äºæŸ¥è¯¢çš„ç´¢å¼•ç»“æ„ï¼ˆä¾‹å¦‚å‘é‡ç´¢å¼•ï¼‰ã€‚é€šä¿—åœ°è¯´ï¼Œä½ å¯ä»¥å°†å®ƒè§†ä¸ºè¿æ¥<strong>ä½ çš„æ•°æ®</strong>å’Œ<strong>å¤§è¯­è¨€æ¨¡å‹</strong>ä¹‹é—´çš„ä¸€ä¸ªâ€œæ™ºèƒ½æ¡¥æ¢â€</p>
<h3 data-id="heading-8">1.8 PyTorch</h3>
<p><strong>PyTorchæ˜¯ä¸€ä¸ªåŸºäºPythonçš„å¼€æºæ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œä»¥å…¶åŠ¨æ€è®¡ç®—å›¾å’Œç›´è§‚æ˜“ç”¨æ€§è€Œé—»åã€‚</strong></p>
<p>ä¸ºäº†è®©æ‚¨æ›´å¥½åœ°ç†è§£ï¼Œè¿™é‡Œæœ‰å‡ ä¸ªå…³é”®è§£è¯»ï¼š</p>
<ul>
<li><strong>æ ¸å¿ƒç‰¹ç‚¹ï¼š</strong> Â å®ƒæä¾›äº†å¼ºå¤§çš„GPUåŠ é€Ÿå¼ é‡è®¡ç®—åŠŸèƒ½ï¼Œå¹¶ä¸”ç”±äºå…¶ <strong><code>åŠ¨æ€å›¾</code>ï¼ˆDefine-by-Runï¼‰</strong> çš„ç‰¹æ€§ï¼Œä½¿å¾—ç ”ç©¶å’Œè°ƒè¯•æ¨¡å‹å˜å¾—æ›´åŠ çµæ´»å’Œç›´è§‚ã€‚</li>
<li><strong>ä¸»è¦åº”ç”¨ï¼š</strong> Â å®ƒæ˜¯ç›®å‰å­¦æœ¯ç•Œå’Œå·¥ä¸šç•Œæœ€å—æ¬¢è¿çš„æ¡†æ¶ä¹‹ä¸€ï¼Œå¹¿æ³›ç”¨äºä»ç ”ç©¶åŸå‹è®¾è®¡åˆ°ç”Ÿäº§éƒ¨ç½²çš„æ•´ä¸ªæœºå™¨å­¦ä¹ ç”Ÿå‘½å‘¨æœŸã€‚</li>
<li><strong>ç®€å•ç±»æ¯”ï¼š</strong> Â æ‚¨å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆæ·±åº¦å­¦ä¹ çš„â€œNumpyâ€ï¼Œä½†æä¾›äº†è‡ªåŠ¨æ±‚å¯¼å’Œå¯¼å’Œå¼ºå¤§çš„GPUæ”¯æŒï¼Œä½¿å¾—æ„å»ºå’Œè®­ç»ƒå¤æ‚çš„ç¥ç»ç½‘ç»œå˜å¾—éå¸¸ç®€å•ã€‚</li>
</ul>
<h3 data-id="heading-9">1.9 TensorFlow</h3>
<p><strong>TensorFlowæ˜¯ä¸€ä¸ªç”±Googleå¼€å‘çš„ç«¯åˆ°ç«¯å¼€æºæœºå™¨å­¦ä¹ å¹³å°ï¼Œä»¥å…¶å¼ºå¤§ä¸”æˆç†Ÿçš„ç”Ÿäº§çº§éƒ¨ç½²èƒ½åŠ›è‘—ç§°ã€‚</strong></p>
<p>ä¸ºäº†å¸®åŠ©æ‚¨æ›´å¥½åœ°ç†è§£ï¼Œè¿™é‡Œæ˜¯å‡ ç‚¹å…³é”®è§£è¯»ï¼š</p>
<ul>
<li><strong>æ ¸å¿ƒå®šä½ï¼š</strong> Â å®ƒæ˜¯ä¸€ä¸ªè¦†ç›–ä»<strong>ç ”ç©¶å»ºæ¨¡</strong>åˆ°<strong>äº§ä¸šéƒ¨ç½²</strong>å…¨æµç¨‹çš„å®Œæ•´ç”Ÿæ€ç³»ç»Ÿï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªåº“ã€‚</li>
<li><strong>å†å²ç‰¹ç‚¹ï¼š</strong> Â æ—©æœŸä»¥å…¶ç‹¬ç‰¹çš„<strong>é™æ€è®¡ç®—å›¾</strong>é—»åï¼Œè™½ç„¶ç°åœ¨ä¹Ÿæ”¯æŒäº†åŠ¨æ€å›¾ï¼ˆEager Executionï¼‰ï¼Œä½†å…¶åœ¨åˆ†å¸ƒå¼è®­ç»ƒå’Œå¤§è§„æ¨¡æœåŠ¡æ–¹é¢çš„ç¨³å®šæ€§å’Œæ€§èƒ½æ˜¯å…¶ä¼ ç»Ÿä¼˜åŠ¿ã€‚</li>
<li><strong>ç»„æˆéƒ¨åˆ†ï¼š</strong> Â é™¤äº†æ ¸å¿ƒçš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œè¿˜åŒ…å«äº†ç”¨äºç§»åŠ¨è®¾å¤‡å’Œè¾¹ç¼˜è®¡ç®—çš„TensorFlow Liteã€ç”¨äºæµè§ˆå™¨ç¯å¢ƒçš„TensorFlow.jsç­‰ä¸€ç³»åˆ—å·¥å…·ã€‚</li>
</ul>
<h2 data-id="heading-10">2. å…³äºAI Agent</h2>
<h3 data-id="heading-11">2.1 AI Agentä»‹ç»</h3>
<p>AI Agent æ˜¯æŒ‡äººå·¥æ™ºèƒ½ä»£ç†ï¼ˆArtificial Intelligence Agentï¼‰æ˜¯ä¸€ç§èƒ½å¤Ÿæ„ŸçŸ¥ç¯å¢ƒè¿›è¡Œè‡ªä¸»ç†è§£ï¼Œè¿›è¡Œ
å†³ç­–å’Œæ‰§è¡ŒåŠ¨ä½œçš„æ™ºèƒ½ä½“ã€‚AI Agentå…·å¤‡é€šè¿‡ç‹¬ç«‹æ€è€ƒã€è°ƒç”¨å·¥å…·é€æ­¥å®Œæˆç»™å®šç›®æ ‡çš„èƒ½åŠ›ã€‚</p>
<p>ä¸€ä¸ªåŸºäºå¤§æ¨¡å‹çš„AI Agentç³»ç»Ÿå¯ä»¥æ‹†åˆ† LLMï¼ˆå¤§æ¨¡å‹ï¼‰ã€è®°å¿†ï¼ˆMemoryï¼‰ã€ä»»åŠ¡è§„åˆ’ï¼ˆPlanningï¼‰
ä»¥åŠå·¥å…·ä½¿ç”¨ï¼ˆToolï¼‰ çš„é›†åˆã€‚åœ¨LLMä¸ºåŸºç¡€çš„AI Agentç³»ç»Ÿä¸­ï¼Œå¤§æ¨¡å‹ä¸ºAI Agentç³»ç»Ÿçš„å¤§è„‘è´Ÿè´£
è®¡ç®—ï¼Œå¹¶éœ€è¦å…¶ä»–ç»„ä»¶è¿›è¡Œè¾…åŠ©ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4d848b4e0bb4dd8bd90118df002c8d4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKz55WU55qE6aOO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765473250&amp;x-signature=6YkupScc1S4VF1TeE3FI8JmsgFg%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-12">2.2 å¤šä¸ªagenåä½œ</h3>
<p>å¤šAgentæ¨¡å‹ï¼ˆMulti-Agent Modelï¼‰æ˜¯ä¸€ç§åˆ†å¸ƒå¼äººå·¥æ™ºèƒ½æ¨¡å‹ï¼Œç”±å¤šä¸ªæ™ºèƒ½ä½“ï¼ˆAgentï¼‰ç»„æˆï¼Œæ¯
ä¸ªAgentéƒ½å…·æœ‰è‡ªä¸»å†³ç­–å’Œäº¤äº’èƒ½åŠ›ï¼Œèƒ½å¤Ÿç›¸äº’åä½œã€ç«äº‰æˆ–åå•†ä»¥å®Œæˆå…±åŒæˆ–å„è‡ªçš„ä»»åŠ¡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1ec16a19664d40c6b7c96e1c4ef4804b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKz55WU55qE6aOO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765473250&amp;x-signature=uo32LvtuAO71ccD3LyqFMBLmIYY%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¯´äººè¯ï¼ŒæŸ¥æ•°æ®ï¼šæ„å»ºä¸€ä¸ªè‡ªç„¶è¯­è¨€é©±åŠ¨çš„ SQLite åå°]]></title>    <link>https://juejin.cn/post/7579843977848569910</link>    <guid>https://juejin.cn/post/7579843977848569910</guid>    <pubDate>2025-12-05T02:34:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579843977848569910" data-draft-id="7579846221167804470" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¯´äººè¯ï¼ŒæŸ¥æ•°æ®ï¼šæ„å»ºä¸€ä¸ªè‡ªç„¶è¯­è¨€é©±åŠ¨çš„ SQLite åå°"/> <meta itemprop="keywords" content="LLM,DeepSeek,SQLite"/> <meta itemprop="datePublished" content="2025-12-05T02:34:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æœ‰æ„ä¹‰"/> <meta itemprop="url" content="https://juejin.cn/user/1739866211617625"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¯´äººè¯ï¼ŒæŸ¥æ•°æ®ï¼šæ„å»ºä¸€ä¸ªè‡ªç„¶è¯­è¨€é©±åŠ¨çš„ SQLite åå°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1739866211617625/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æœ‰æ„ä¹‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T02:34:01.000Z" title="Fri Dec 05 2025 02:34:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atelier-lakeside-light">.hljs-comment,.hljs-quote{color:#5a7b8c}.hljs-attribute,.hljs-link,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d22d72}.hljs-built_in,.hljs-builtin-name,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#935c25}.hljs-bullet,.hljs-string,.hljs-symbol{color:#568c3b}.hljs-section,.hljs-title{color:#257fad}.hljs-keyword,.hljs-selector-tag{color:#6b6bb8}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#ebf8ff;color:#516d7b}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å†™åœ¨å‰é¢</h2>
<p><strong>AI First æ—¶ä»£ï¼šç”¨è‡ªç„¶è¯­è¨€æ“ä½œæ•°æ®åº“ï¼Œè®©éæŠ€æœ¯äººå‘˜ä¹Ÿèƒ½â€œå†™â€SQL</strong></p>
<p>â€œæœªæ¥ï¼Œå¼€å‘èƒ½åŠ›å°†ä¸å†å±€é™äºç¨‹åºå‘˜ã€‚â€â€”â€”åœ¨å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„èµ‹èƒ½ä¸‹ï¼Œè¿™ä¸€è®¾æƒ³æ­£åŠ é€Ÿè½åœ°ã€‚</p>
<p>æœ€è¿‘ï¼Œæˆ‘åœ¨ä¸€ä¸ªæ¢ç´¢æ€§é¡¹ç›®ä¸­å°è¯•å°†<strong>è‡ªç„¶è¯­è¨€è½¬ SQL</strong> çš„åŠŸèƒ½åµŒå…¥åˆ°æ—¥å¸¸æ•°æ®æ“ä½œæµç¨‹ä¸­ã€‚é€šè¿‡é›†æˆ DeepSeek ç­‰å¼€æºå¤§æ¨¡å‹ï¼Œå¹¶æ­é…è½»é‡çº§çš„ SQLite æ•°æ®åº“ï¼Œæˆ‘å¿«é€Ÿæ„å»ºäº†ä¸€ä¸ªç®€æ´ä½†å¯Œæœ‰æ½œåŠ›çš„ <strong>â€œAI é©±åŠ¨å‹åå°ç®¡ç†åŸå‹â€</strong> ã€‚ä»Šå¤©å°±æ¥èŠèŠè¿™ä¸ªæ€è·¯åŠå…¶åˆæ­¥å®ç°ã€‚</p>
<p>ğŸ“Œ <strong>èŒƒå¼æ¼”è¿›ï¼šä» â€œMobile Firstâ€ åˆ° â€œAI Firstâ€</strong><br/>
å›é¡¾æŠ€æœ¯å‘å±•ï¼Œæˆ‘ä»¬ç»å†äº†ä» PC ä¼˜å…ˆåˆ°ç§»åŠ¨ä¼˜å…ˆçš„è½¬å˜ï¼›å¦‚ä»Šï¼Œéšç€å¤§æ¨¡å‹èƒ½åŠ›çš„æˆç†Ÿï¼Œâ€œAI Firstâ€ æ­£é€æ¸æˆä¸ºæ–°ä¸€ä»£åº”ç”¨è®¾è®¡çš„ä¸»æµæ€ç»´ã€‚</p>
<blockquote>
<p>â€œä»¥ AI ä¸ºæ ¸å¿ƒï¼Œç»“åˆè‡ªç„¶è¯­è¨€ç”Ÿæˆ SQL çš„èƒ½åŠ›ï¼ˆå¦‚ Geminiã€DeepSeek ç­‰ï¼‰ï¼Œå°†å…¶æ·±åº¦æ•´åˆè¿›ä¸šåŠ¡ç³»ç»Ÿï¼Œè®©å†…å®¹ç¼–è¾‘ã€è¿è¥äººå‘˜ç”šè‡³æ™®é€šç”¨æˆ·éƒ½èƒ½è‡ªä¸»å®Œæˆæ•°æ®æŸ¥è¯¢ä¸ç®¡ç†ã€‚â€</p>
</blockquote>
<p>è¿™å¸¦æ¥çš„å˜é©æ˜¯ï¼š<strong>ä¸å†ä¾èµ–ä¸“ä¸šæ•°æ®åº“çŸ¥è¯†æˆ–åç«¯æ”¯æŒ</strong>ã€‚ç”¨æˆ·åªéœ€ç”¨å£è¯­åŒ–è¡¨è¾¾éœ€æ±‚â€”â€”ä¾‹å¦‚â€œæ˜¾ç¤ºä¸Šå­£åº¦æ´»è·ƒç”¨æˆ·æœ€å¤šçš„ä¸‰ä¸ªåœ°åŒºâ€â€”â€”ç³»ç»Ÿå³å¯è‡ªåŠ¨è§£æè¯­ä¹‰ã€ç”Ÿæˆåˆè§„çš„ SQL è¯­å¥ï¼Œå¹¶è¿”å›æ‰€éœ€ç»“æœã€‚æ•°æ®è®¿é—®çš„é—¨æ§›ï¼Œæ­£åœ¨è¢« AI å½»åº•æ‰“ç ´ã€‚</p>
<h2 data-id="heading-1">è®© LLM çœ‹æ‡‚ä½ çš„æ•°æ®åº“ï¼šSchema çš„æ­£ç¡®æ‰“å¼€æ–¹å¼</h2>
<p>åœ¨ Text-to-SQL ç³»ç»Ÿä¸­ï¼Œç»™å¤§æ¨¡å‹æä¾›è¡¨ç»“æ„ï¼ˆSchemaï¼‰çš„æ–¹å¼ï¼Œç›´æ¥å†³å®šäº†ç”Ÿæˆ SQL çš„å‡†ç¡®æ€§ã€‚å¾ˆå¤šäººä¹ æƒ¯æ‰‹å†™ä¸€æ®µè‡ªç„¶è¯­è¨€æè¿°ï¼Œæ¯”å¦‚ï¼š</p>
<blockquote>
<p>â€œemployees è¡¨æœ‰ idã€nameã€department å’Œ salary å­—æ®µâ€¦â€¦â€</p>
</blockquote>
<p>ä½†è¿™ç§æ–¹å¼æ—¢å†—ä½™åˆå®¹æ˜“ä¸å®é™…è¡¨ç»“æ„ä¸ä¸€è‡´ã€‚</p>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ç§æ›´å·¥ç¨‹åŒ–çš„åšæ³•ï¼š</p>
<pre><code class="hljs language-Python" lang="Python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_schema_str</span>(<span class="hljs-params">cursor</span>):
    schema = cursor.execute(<span class="hljs-string">"PRAGMA table_info(employees)"</span>).fetchall()
    <span class="hljs-keyword">return</span> <span class="hljs-string">"CREATE TABLE EMPLOYEES (\n"</span> + <span class="hljs-string">"\n"</span>.join([<span class="hljs-string">f"<span class="hljs-subst">{col[<span class="hljs-number">1</span>]}</span> <span class="hljs-subst">{col[<span class="hljs-number">2</span>]}</span>"</span> <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> schema]) + <span class="hljs-string">"\n)"</span>
</code></pre>
<p>è¿™é‡Œåˆ©ç”¨äº† SQLite å†…ç½®çš„ <code>PRAGMA table_info</code> å‘½ä»¤ï¼Œ<strong>åŠ¨æ€è·å–çœŸå®è¡¨ç»“æ„</strong>ï¼Œå¹¶æ‹¼æ¥æˆæ ‡å‡†çš„ <code>CREATE TABLE</code> è¯­å¥ã€‚è¿™ä¸ä»…æ˜¯è¯­æ³•ä¸Šçš„â€œè§„èŒƒè¾“å‡ºâ€ï¼Œæ›´æ˜¯å¯¹ LLM è®­ç»ƒæ•°æ®åˆ†å¸ƒçš„ç²¾å‡†å¯¹é½â€”â€”LLM åœ¨é¢„è®­ç»ƒé˜¶æ®µè§è¿‡æµ·é‡ <code>CREATE TABLE</code> è¯­å¥ï¼Œè¿œæ¯”è‡ªå®šä¹‰æè¿°æ›´ç†Ÿæ‚‰ã€‚</p>
<p>åŒæ—¶ï¼Œé…åˆ <code>init_db()</code> ä¸­çš„ <code>CREATE TABLE IF NOT EXISTS</code> ä¸ <code>INSERT OR IGNORE</code>ï¼Œæ•´ä¸ªåˆå§‹åŒ–æµç¨‹å…·å¤‡<strong>å¹‚ç­‰æ€§</strong>ï¼Œæ”¯æŒåå¤è¿è¡Œè€Œä¸æ±¡æŸ“æ•°æ®ã€‚è¿™ç§ç»†èŠ‚ï¼Œæ­£æ˜¯ä»â€œèƒ½è·‘â€åˆ°â€œå¯é â€çš„å…³é”®åˆ†æ°´å²­ã€‚</p>
<blockquote>
<p><strong>ç»éªŒä¹‹è°ˆ</strong>ï¼šä¸è¦è®© LLM çŒœä½ çš„ Schemaï¼Œè¦è®©å®ƒâ€œçœ‹â€åˆ°å’Œæ•°æ®åº“ä¸€æ¨¡ä¸€æ ·çš„å®šä¹‰ã€‚</p>
</blockquote>
<p>db.pyå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> sqlite3

<span class="hljs-keyword">def</span> <span class="hljs-title function_">init_db</span>():
    conn = sqlite3.connect(<span class="hljs-string">"text.db"</span>)
    cursor = conn.cursor()
    cursor.execute(<span class="hljs-string">"""
        CREATE TABLE IF NOT EXISTS employees(
            id INTEGER PRIMARY KEY,
            name TEXT,
            department TEXT,
            salary INTEGER
        )
    """</span>)
    sample_data = [
        (<span class="hljs-number">6</span>, <span class="hljs-string">"é»„ä½³"</span>, <span class="hljs-string">"é”€å”®"</span>, <span class="hljs-number">50000</span>),
        (<span class="hljs-number">7</span>, <span class="hljs-string">"å®å®"</span>, <span class="hljs-string">"å·¥ç¨‹"</span>, <span class="hljs-number">75000</span>),
        (<span class="hljs-number">8</span>, <span class="hljs-string">"è°¦è°¦"</span>, <span class="hljs-string">"é”€å”®"</span>, <span class="hljs-number">60000</span>),
        (<span class="hljs-number">9</span>, <span class="hljs-string">"æ‚¦æ‚¦"</span>, <span class="hljs-string">"å·¥ç¨‹"</span>, <span class="hljs-number">80000</span>),
        (<span class="hljs-number">10</span>, <span class="hljs-string">"é»„ä»å‹‹"</span>, <span class="hljs-string">"å¸‚åœº"</span>, <span class="hljs-number">55000</span>),
        (<span class="hljs-number">11</span>, <span class="hljs-string">"åˆ˜è‹—è‹—"</span>, <span class="hljs-string">"å·¥ç¨‹"</span>, <span class="hljs-number">55001</span>)
    ]
    cursor.executemany(<span class="hljs-string">"INSERT OR IGNORE INTO employees VALUES(?,?,?,?)"</span>, sample_data)
    conn.commit()
    <span class="hljs-keyword">return</span> conn, cursor

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_schema_str</span>(<span class="hljs-params">cursor</span>):
    schema = cursor.execute(<span class="hljs-string">"PRAGMA table_info(employees)"</span>).fetchall()
    <span class="hljs-keyword">return</span> <span class="hljs-string">"CREATE TABLE EMPLOYEES (\n"</span> + <span class="hljs-string">"\n"</span>.join([<span class="hljs-string">f"<span class="hljs-subst">{col[<span class="hljs-number">1</span>]}</span> <span class="hljs-subst">{col[<span class="hljs-number">2</span>]}</span>"</span> <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> schema]) + <span class="hljs-string">"\n)"</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e273876e74864a85bc8905737d3abbd3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyJ5oSP5LmJ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507093&amp;x-signature=K5OsGUF7rbNIKtmxM3VuaptseZ0%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-2">å¯é çš„ SQL ä¸æ¥è‡ªåˆ›æ„ï¼Œè€Œæ¥è‡ªçº¦æŸ</h2>
<p>åœ¨ Text-to-SQL ç³»ç»Ÿä¸­ï¼Œè°ƒç”¨å¤§æ¨¡å‹çš„ä»£ç å¾€å¾€åªå å‡ è¡Œï¼Œä½†å…¶èƒŒåçš„ Prompt è®¾è®¡å´å†³å®šäº†æ•´ä¸ªç³»ç»Ÿçš„ä¸Šé™ã€‚æ¥çœ‹ä¸€ä¸ªå…¸å‹å®ç°ï¼š</p>
<p>llm.py</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> openai <span class="hljs-keyword">import</span> OpenAI

client = OpenAI(
    api_key=<span class="hljs-string">'your_api_key'</span>,
    base_url=<span class="hljs-string">'https://api.deepseek.com/v1'</span>
)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">ask_deepseek</span>(<span class="hljs-params">query, schema</span>):
    prompt = <span class="hljs-string">f"""
    è¿™æ˜¯ä¸€ä¸ªæ•°æ®åº“çš„Schemaï¼š
    <span class="hljs-subst">{schema}</span>
    æ ¹æ®è¿™ä¸ªSchemaï¼Œè¯·è¾“å‡ºä¸€ä¸ªSQLæŸ¥è¯¢æ¥å›ç­”ä»¥ä¸‹é—®é¢˜ã€‚
    åªè¾“å‡ºSQLæŸ¥è¯¢è¯­å¥æœ¬èº«ï¼Œä¸è¦ä½¿ç”¨ä»»ä½• Markdowm æ ¼å¼
    ä¸è¦åŒ…å«åå¼•å·ã€ä»£ç å—æ ‡è®°æˆ–é¢å¤–è¯´æ˜
    é—®é¢˜ï¼š<span class="hljs-subst">{query}</span>
    """</span>
    response = client.chat.completions.create(
        model=<span class="hljs-string">"deepseek-chat"</span>,
        max_tokens=<span class="hljs-number">2048</span>,
        messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>, <span class="hljs-string">"content"</span>: prompt}],
        temperature=<span class="hljs-number">0</span>
    )
    <span class="hljs-keyword">return</span> response.choices[<span class="hljs-number">0</span>].message.content.strip()
</code></pre>
<p>è¿™æ®µä»£ç çœ‹ä¼¼ç®€å•ï¼Œå®åˆ™ä½“ç°äº†ä¸‰ä¸ªå…³é”®å·¥ç¨‹åŸåˆ™ï¼š</p>
<ol>
<li><strong>ä¸Šä¸‹æ–‡ç²¾å‡†æ³¨å…¥</strong>ï¼šå°†åŠ¨æ€ç”Ÿæˆçš„Â <code>CREATE TABLE</code>Â Schema ç›´æ¥åµŒå…¥ Promptï¼Œç¡®ä¿ LLM åŸºäºçœŸå®ç»“æ„æ¨ç†ï¼›</li>
<li><strong>è¾“å‡ºå¼ºçº¦æŸ</strong>ï¼šæ˜ç¡®è¦æ±‚â€œåªè¾“å‡º SQLâ€ï¼Œå¹¶ç¦æ­¢ Markdownã€åå¼•å·ç­‰å¸¸è§å¹²æ‰°é¡¹â€”â€”è¿™æ˜¯åç»­ç›´æ¥æ‰§è¡Œ SQL çš„å‰æï¼›</li>
<li><strong>ç¡®å®šæ€§æ§åˆ¶</strong>ï¼š<code>temperature=0</code>Â å…³é—­éšæœºæ€§ï¼Œä¿è¯ç›¸åŒè¾“å…¥å§‹ç»ˆè¿”å›ç›¸åŒ SQLï¼Œæå‡ç³»ç»Ÿå¯é¢„æµ‹æ€§ã€‚</li>
</ol>
<blockquote>
<p>ğŸ’¡ å¾ˆå¤šå¼€å‘è€…æŠ±æ€¨â€œLLM ç”Ÿæˆçš„ SQL ä¸èƒ½ç›´æ¥ç”¨â€ï¼Œå…¶å®é—®é¢˜ä¸åœ¨æ¨¡å‹ï¼Œè€Œåœ¨ Prompt æ²¡æœ‰<strong>å¼ºåˆ¶è§„èŒƒè¾“å‡ºæ ¼å¼</strong>ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸æ˜¯åœ¨â€œè¯·æ±‚å¸®åŠ©â€ï¼Œè€Œæ˜¯åœ¨â€œä¸‹è¾¾æŒ‡ä»¤â€ã€‚</p>
</blockquote>
<p>è¿™ç§å…‹åˆ¶è€Œç²¾ç¡®çš„äº¤äº’æ–¹å¼ï¼Œæ­£æ˜¯ LLM ä»ç©å…·èµ°å‘ç”Ÿäº§çš„å…³é”®ä¸€æ­¥ã€‚</p>
<hr/>
<h2 data-id="heading-3">ğŸ”— è®© LLM æˆä¸ºä½ çš„â€œè‡ªç„¶è¯­è¨€æ•°æ®åº“æ¥å£</h2>
<p>æœ‰äº†å¯é çš„ Schema ä¸Šä¸‹æ–‡å’Œç²¾å‡†çš„ Prompt çº¦æŸï¼ŒLLM å°±ä¸å†æ˜¯â€œèŠå¤©æœºå™¨äººâ€ï¼Œè€Œæ˜¯ä¸€ä¸ª<strong>å¯ç¼–ç¨‹çš„è‡ªç„¶è¯­è¨€ SQL å¼•æ“</strong>ã€‚ä¸»æµç¨‹ä»£ç æ¸…æ™°å±•ç¤ºäº†è¿™ä¸€æ€æƒ³çš„è½åœ°ï¼š</p>
<p>main.py</p>
<pre><code class="hljs language-py" lang="py"><span class="hljs-keyword">from</span> db <span class="hljs-keyword">import</span> init_db, get_schema_str
<span class="hljs-keyword">from</span> llm <span class="hljs-keyword">import</span> ask_deepseek

conn, cursor = init_db()
schema_str = get_schema_str(cursor)

<span class="hljs-comment"># 1. æŸ¥è¯¢</span>
question = <span class="hljs-string">"å·¥ç¨‹éƒ¨é—¨å‘˜å·¥çš„å§“åå’Œå·¥èµ„æ˜¯å¤šå°‘?"</span>
sql_query = ask_deepseek(question, schema_str)
<span class="hljs-built_in">print</span>(sql_query)
results = cursor.execute(sql_query).fetchall()
<span class="hljs-built_in">print</span>(results)

<span class="hljs-comment"># 2. æ’å…¥</span>
question = <span class="hljs-string">"åœ¨é”€å”®éƒ¨é—¨å¢åŠ ä¸€ä¸ªæ–°å‘˜å·¥ï¼Œå§“åä¸ºå¼ ä¸‰ï¼Œå·¥èµ„ä¸º45000"</span>
sql_query = ask_deepseek(question, schema_str)
<span class="hljs-built_in">print</span>(sql_query)
cursor.execute(sql_query)
conn.commit()

<span class="hljs-comment"># 3. åˆ é™¤</span>
question = <span class="hljs-string">"åˆ é™¤å¸‚åœºéƒ¨é—¨çš„é»„ä»å‹‹"</span>
sql_query = ask_deepseek(question, schema_str)
<span class="hljs-built_in">print</span>(sql_query)
cursor.execute(sql_query)
conn.commit()

<span class="hljs-comment"># 4. æŸ¥è¯¢æ‰€æœ‰</span>
question = <span class="hljs-string">"æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥çš„ä¿¡æ¯"</span>
sql_query = ask_deepseek(question, schema_str)
<span class="hljs-built_in">print</span>(sql_query)
results = cursor.execute(sql_query).fetchall()
<span class="hljs-built_in">print</span>(results)

conn.close()
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3aaf78ff5d8d4fcc8b95416a04325ea3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyJ5oSP5LmJ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507093&amp;x-signature=BHXZ5kZwfhHZ135XVBRcww%2B9QeY%3D" alt="image.png" loading="lazy"/>
æ•´ä¸ªè¿‡ç¨‹æ²¡æœ‰ä¸­é—´è§£æã€æ²¡æœ‰åå¤„ç†ã€æ²¡æœ‰æ ¼å¼è½¬æ¢â€”â€”<strong>LLM çš„è¾“å‡ºå³ç³»ç»Ÿè¾“å…¥</strong>ã€‚è¿™ç§ç«¯åˆ°ç«¯çš„é›†æˆï¼Œä¾èµ–ä¸¤ä¸ªå‰æï¼š</p>
<ol>
<li><strong>Schema åŠ¨æ€åŒæ­¥</strong>ï¼ˆæ¥è‡ªÂ <code>get_schema_str</code>ï¼‰ï¼Œç¡®ä¿ LLM â€œæ‰€è§å³åº“ä¸­æ‰€æœ‰â€ï¼›</li>
<li><strong>Prompt å¼ºçº¦æŸ</strong>ï¼ˆæ¥è‡ªÂ <code>ask_deepseek</code>ï¼‰ï¼Œç¡®ä¿è¾“å‡ºæ˜¯å¹²å‡€ã€åˆæ³•çš„ SQLite è¯­å¥ã€‚</li>
</ol>
<p>æ›´å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™å¥—æµç¨‹ä¸ä»…æ”¯æŒ <code>SELECT</code>ï¼Œè¿˜èƒ½å¤„ç† <code>INSERT</code>ã€<code>DELETE</code> ç­‰å†™æ“ä½œâ€”â€”è¿™æ„å‘³ç€ç”¨æˆ·å¯ä»¥ç”¨è‡ªç„¶è¯­è¨€å®Œæˆ<strong>å®Œæ•´çš„ CRUD æ“ä½œ</strong>ï¼Œè€Œå¼€å‘è€…åªéœ€ç»´æŠ¤ä¸€å¼ è¡¨ç»“æ„ã€‚</p>
<blockquote>
<p>ğŸ’¡ è¿™ä¸æ˜¯â€œAI å†™ SQLâ€ï¼Œè€Œæ˜¯<strong>ç”¨è‡ªç„¶è¯­è¨€é©±åŠ¨æ•°æ®åº“çš„æ–°äº¤äº’èŒƒå¼</strong>ã€‚<br/>
è€Œå®ç°å®ƒçš„å…¨éƒ¨ç§˜å¯†ï¼Œå°±è—åœ¨è¿™åå‡ è¡Œçœ‹ä¼¼å¹³å‡¡çš„ glue code ä¸­ã€‚</p>
</blockquote>
<p><em>æ— éœ€äººå·¥å¹²é¢„ï¼Œä»è‡ªç„¶è¯­è¨€åˆ°æ•°æ®åº“ç»“æœçš„å®Œæ•´é“¾è·¯å¦‚ä¸‹ï¼š</em></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79bc4f5a268547a3b0a65d4cd8332e92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyJ5oSP5LmJ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507093&amp;x-signature=O6b5pktkNkPhBe4GknKz%2BAXlFoE%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™ä¸ªåŸå‹è¶³å¤Ÿè½»é‡ï¼Œéå¸¸é€‚åˆä½œä¸ºä½ è‡ªå·±å®éªŒçš„èµ·ç‚¹ã€‚å¦‚æœ‰å…¶ä»–éœ€æ±‚ï¼Œä¹Ÿå¯åœ¨æ­¤åŸºç¡€ä¸Šçµæ´»æ‰©å±•ã€‚</p>
<blockquote>
<p>é¡¹ç›®ç»“æ„å¦‚ä¸‹ã€‚ä½ å¯ä»¥ç›´æ¥å¤åˆ¶ä¸Šæ–‡ä»£ç ï¼Œè¿è¡Œ <code>main.py</code>ï¼Œå³å¯åœ¨æ§åˆ¶å°çœ‹åˆ°å®Œæ•´çš„è¾“å‡ºç»“æœã€‚</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6cdc2df007e14cb2b0cfdb00f067b01c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pyJ5oSP5LmJ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507093&amp;x-signature=pnVzMtqvfjHmZUGIOg995UDeCWU%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">ğŸ¯ è‡ªç„¶è¯­è¨€ï¼Œæ­£åœ¨æˆä¸ºæ–°ä¸€ä»£æ•°æ®åº“çš„â€œå…¥å£â€</h2>
<p>é€šè¿‡ä¸€ä¸ªä¸åˆ°ç™¾è¡Œçš„åŸå‹ï¼Œæˆ‘ä»¬éªŒè¯äº†ä¸€ä¸ªå…³é”®è¶‹åŠ¿ï¼š<strong>å¤§è¯­è¨€æ¨¡å‹ + ç²¾å‡†ä¸Šä¸‹æ–‡ + å¼ºçº¦æŸè¾“å‡º = å¯æ‰§è¡Œçš„è‡ªç„¶è¯­è¨€æ•°æ®æ¥å£</strong>ã€‚</p>
<p>è¿™ä¸ä»…ä»…æ˜¯â€œè®© AI å†™ SQLâ€ï¼Œè€Œæ˜¯ä¸€æ¬¡äº¤äº’èŒƒå¼çš„è¿ç§»â€”â€”<br/>
ä»â€œäººé€‚åº”æ•°æ®åº“â€ï¼ˆå­¦è¯­æ³•ã€å†™æŸ¥è¯¢ã€è°ƒæ¥å£ï¼‰ï¼Œ<br/>
è½¬å‘â€œæ•°æ®åº“é€‚åº”äººâ€ï¼ˆè¯´éœ€æ±‚ã€å¾—ç»“æœã€é›¶ç¼–ç ï¼‰ã€‚</p>
<p>å½“ç„¶ï¼Œå½“å‰æ–¹æ¡ˆä»æ˜¯ä¸€ä¸ªæœ€å°å¯è¡ŒåŸå‹ï¼šå®ƒæ²¡æœ‰æƒé™æ§åˆ¶ã€ä¸æ”¯æŒå¤æ‚ JOINã€ä¹Ÿæœªå¤„ç†æ¨¡ç³Šè¯­ä¹‰ã€‚ä½†å®ƒçš„ä»·å€¼åœ¨äºè¯æ˜äº†ï¼š<strong>åœ¨ç‰¹å®šé¢†åŸŸå†…ï¼ŒLLM å·²å…·å¤‡æ›¿ä»£ä¼ ç»Ÿ CRUD åç«¯çš„èƒ½åŠ›</strong>ã€‚</p>
<p>æœªæ¥ï¼Œéšç€æ¨¡å‹å¯¹ Schema ç†è§£æ›´æ·±ã€æ‰§è¡Œæ›´å®‰å…¨ã€åé¦ˆæ›´æ™ºèƒ½ï¼Œæˆ‘ä»¬æˆ–è®¸ä¸å†éœ€è¦ä¸ºç®€å•æ•°æ®æ“ä½œå¼€å‘ APIã€‚è¿è¥äººå‘˜ä¸€å¥â€œæŠŠä¸Šæœˆç¦»èŒçš„é”€å”®å‘˜å·¥æ ‡çº¢â€ï¼Œç³»ç»Ÿå°±èƒ½è‡ªåŠ¨å®ŒæˆæŸ¥è¯¢ã€æ›´æ–°ç”šè‡³å‰ç«¯æ¸²æŸ“ã€‚</p>
<p>è€Œè¿™ï¼Œæ­£æ˜¯ <strong>AI First æ—¶ä»£æœ€çœŸå®çš„æ¨¡æ ·</strong>ï¼š<br/>
ä¸æ˜¯ç‚«æŠ€ï¼Œè€Œæ˜¯è®©æŠ€æœ¯æ¶ˆå¤±åœ¨ä½“éªŒä¹‹ä¸­ã€‚</p>
<blockquote>
<p><strong>ä»£ç å·²å¼€æºï¼Œæ€è·¯å¯å¤ç”¨ã€‚ä½ ï¼Œå‡†å¤‡å¥½æ„å»ºè‡ªå·±çš„è‡ªç„¶è¯­è¨€åå°äº†å—ï¼Ÿ</strong></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å°è£…é€šç”¨å¯è§†åŒ–å¤§å±å¸ƒå±€ç»„ä»¶ï¼šVue3æ‰“é€ é«˜å¤ç”¨æ€§çš„ ChartFlex/ChartFlexItem]]></title>    <link>https://juejin.cn/post/7579846221168082998</link>    <guid>https://juejin.cn/post/7579846221168082998</guid>    <pubDate>2025-12-05T02:42:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579846221168082998" data-draft-id="7579846685071376438" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å°è£…é€šç”¨å¯è§†åŒ–å¤§å±å¸ƒå±€ç»„ä»¶ï¼šVue3æ‰“é€ é«˜å¤ç”¨æ€§çš„ ChartFlex/ChartFlexItem"/> <meta itemprop="keywords" content="Vue.js,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-05T02:42:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="VOLUN"/> <meta itemprop="url" content="https://juejin.cn/user/3368559359822568"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å°è£…é€šç”¨å¯è§†åŒ–å¤§å±å¸ƒå±€ç»„ä»¶ï¼šVue3æ‰“é€ é«˜å¤ç”¨æ€§çš„ ChartFlex/ChartFlexItem
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3368559359822568/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    VOLUN
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T02:42:01.000Z" title="Fri Dec 05 2025 02:42:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Vue3 é¡¹ç›®å¼€å‘ä¸­ï¼Œå°¤å…¶æ˜¯æ•°æ®å¯è§†åŒ–åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦é¢‘ç¹ä½¿ç”¨ Flex å¸ƒå±€æ¥å®ç°å›¾è¡¨çš„çµæ´»æ’ç‰ˆã€‚æ¯æ¬¡é‡å¤å†™<code>display: flex</code>ã€<code>justify-content</code>ã€<code>align-items</code>ç­‰æ ·å¼ä¸ä»…ä½æ•ˆï¼Œè¿˜å®¹æ˜“å¯¼è‡´æ ·å¼ä¸ç»Ÿä¸€ã€‚æœ¬æ–‡å°†åˆ†äº«å¦‚ä½•å°è£…ä¸€å¯¹é«˜å¤ç”¨ã€å¼ºç±»å‹çš„ Flex å¸ƒå±€ç»„ä»¶ â€”â€”<code>ChartFlex</code>ï¼ˆå®¹å™¨ï¼‰å’Œ<code>ChartFlexItem</code>ï¼ˆå­é¡¹ï¼‰ï¼Œè®©å›¾è¡¨å¸ƒå±€å¼€å‘æ›´é«˜æ•ˆã€æ›´è§„èŒƒã€‚</p>
<h2 data-id="heading-0">ChartFlex.vue</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4ff5f46599cd4934bd7e692c7ebdece5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVk9MVU4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507321&amp;x-signature=9CtCsWeeXgNsGPy7%2BE3xiqfz8t0%3D" alt="flex.png" loading="lazy"/></p>
<h2 data-id="heading-1">ChartFlexItem.vue</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/796a7e78f462472dbe71a650b3bcfe8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVk9MVU4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507321&amp;x-signature=ndPZksztcGUQpRi0czVEbCYGWcw%3D" alt="flex-item.png" loading="lazy"/></p>
<p>é€šè¿‡ä¸Šé¢ä¸¤ä¸ªç»„ä»¶ç»“åˆä½¿ç”¨ï¼Œæˆ‘ä»¬å°±èƒ½å¾ˆå¿«å®Œæˆå¤§å±çš„å¸ƒå±€å¼€å‘ï¼Œä¸”çµæ´»æ€§é«˜</p>
<h2 data-id="heading-2">ç¤ºä¾‹1</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af8c8f8ae2d04bf7baaebdc4380379e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVk9MVU4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507321&amp;x-signature=5PDRru9BQXdUphM4kHPmhLDtr5Y%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b48bfd88ebb244868270ca0f31ba6e0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVk9MVU4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507321&amp;x-signature=iP4IedGcRq1Vpiwww61hGMUgZjs%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-3">ç¤ºä¾‹2</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/966f768e0e954a91aa9e1ecfca94053c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVk9MVU4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507321&amp;x-signature=2WpTtdAlgapshWetEI3KiogNHng%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1617ad83112b486687a3bba54b8229b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVk9MVU4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507321&amp;x-signature=6XcUSOayUV%2F%2FKDr21Y2ngkzlm40%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">ç¤ºä¾‹3</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57def9a443314c43a0dd08604aec2f33~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVk9MVU4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507321&amp;x-signature=b0FAxghse2314VosyoGwd2Wkk24%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6abd7174b1bb413da94a1d8c8fedd31a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVk9MVU4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507321&amp;x-signature=CdPGccB8gksFeLF8%2BHxrCkOZqJY%3D" alt="image.png" loading="lazy"/></p>
<p>é€šè¿‡ä¸Šé¢ç¤ºä¾‹å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨ä¸å†™cssçš„æƒ…å†µä¸‹ï¼Œä¹Ÿèƒ½å¿«é€Ÿå®Œæˆå¤§å±çš„å¸ƒå±€å¼€å‘ï¼ŒåŒæ—¶ä¿è¯äº†æ¯ä¸ªå›¾è¡¨å¡ç‰‡ä¹‹é—´çš„ç»Ÿä¸€é—´è·ï¼Œé¡µé¢çš„å·¥æ•´æ€§</p>
<h2 data-id="heading-5">åŠ¨æ€å›¾æ¼”ç¤ºæ•ˆæœ</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91eee06642334636b1527e5c85ef2d48~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVk9MVU4=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507321&amp;x-signature=LjOssOIc9KEHN9UXWy8LKNsrtx8%3D" alt="20251205103453_rec_.gif" loading="lazy"/></p>
<h2 data-id="heading-6">æ€»ç»“</h2>
<p>é€šè¿‡å°è£…<code>ChartFlex</code>å’Œ<code>ChartFlexItem</code>ï¼Œæˆ‘ä»¬å°†é‡å¤çš„ Flex å¸ƒå±€é€»è¾‘æŠ½ç¦»æˆé€šç”¨ç»„ä»¶ï¼Œå¸¦æ¥äº†ä»¥ä¸‹æ”¶ç›Šï¼š</p>
<ul>
<li><strong>æå‡å¼€å‘æ•ˆç‡</strong>ï¼šæ— éœ€é‡å¤ç¼–å†™ Flex æ ·å¼ï¼Œé€šè¿‡ Props å¿«é€Ÿé…ç½®ï¼›</li>
<li><strong>æ ·å¼ç»Ÿä¸€</strong>ï¼šé¿å…å›¢é˜Ÿæˆå‘˜æ‰‹å†™æ ·å¼å¯¼è‡´çš„å¸ƒå±€ä¸ä¸€è‡´ï¼›</li>
<li><strong>å¼ºç±»å‹ä¿éšœ</strong>ï¼šTypeScript çº¦æŸå‡å°‘å¸ƒå±€ç›¸å…³çš„ bugï¼›</li>
<li><strong>å›¾è¡¨å‹å¥½</strong>ï¼šå†…ç½®å›¾è¡¨åœºæ™¯æ‰€éœ€çš„å°ºå¯¸æ§åˆ¶ã€æº¢å‡ºå¤„ç†ç­‰é€»è¾‘ï¼›</li>
<li><strong>é«˜æ‰©å±•æ€§</strong>ï¼šå¯æ ¹æ®ä¸šåŠ¡éœ€æ±‚çµæ´»æ‰©å±•å“åº”å¼ã€åŠ è½½æ€ç­‰åŠŸèƒ½ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ°¸è¿œä¸è¦æ¬ºéª— Reactï¼šè¯¦è§£ useEffect ä¾èµ–è§„åˆ™ä¸â€œé—­åŒ…é™·é˜±â€]]></title>    <link>https://juejin.cn/post/7579961957195563058</link>    <guid>https://juejin.cn/post/7579961957195563058</guid>    <pubDate>2025-12-05T02:50:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579961957195563058" data-draft-id="7579961957195530290" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ°¸è¿œä¸è¦æ¬ºéª— Reactï¼šè¯¦è§£ useEffect ä¾èµ–è§„åˆ™ä¸â€œé—­åŒ…é™·é˜±â€"/> <meta itemprop="keywords" content="å‰ç«¯,React.js"/> <meta itemprop="datePublished" content="2025-12-05T02:50:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çš®è›‹å°ç²¾çµ"/> <meta itemprop="url" content="https://juejin.cn/user/219558056559278"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ°¸è¿œä¸è¦æ¬ºéª— Reactï¼šè¯¦è§£ useEffect ä¾èµ–è§„åˆ™ä¸â€œé—­åŒ…é™·é˜±â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/219558056559278/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çš®è›‹å°ç²¾çµ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T02:50:47.000Z" title="Fri Dec 05 2025 02:50:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¦‚æœä½ åœ¨ <code>useEffect</code> å†…éƒ¨ä½¿ç”¨äº†æŸä¸ª prop æˆ– stateï¼Œä½†æ²¡æœ‰æŠŠå®ƒæ”¾åˆ°ä¾èµ–æ•°ç»„é‡Œï¼Œä½ ä¼šé‡åˆ° React ä¸­æœ€è‘—åçš„ Bug â€”â€” <strong>é—­åŒ…é™·é˜± (Stale Closure)</strong> ã€‚</p>
<p>è¿™æ„å‘³ç€ï¼š<strong>ä½ çš„ Effect åªèƒ½â€œçœ‹è§â€æ—§çš„æ•°æ®ï¼Œæ°¸è¿œçœ‹ä¸è§æ–°çš„æ•°æ®ã€‚</strong></p>
<hr/>
<h3 data-id="heading-0">1. ä¸ºä»€ä¹ˆâ€œå¿…é¡»â€æ”¾ï¼Ÿ(åŸç†æ¼”ç¤º)</h3>
<p>çœ‹è¿™ä¸ªç»å…¸çš„é”™è¯¯ä¾‹å­ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Counter</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> id = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count); <span class="hljs-comment">// âŒ æ°¸è¿œæ‰“å° 0</span>
    }, <span class="hljs-number">1000</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearInterval</span>(id);
  }, []); <span class="hljs-comment">// âš ï¸ ç©ºæ•°ç»„ï¼šæ„æ€æ˜¯â€œåªåœ¨æŒ‚è½½æ—¶è¿è¡Œä¸€æ¬¡â€</span>
}
</code></pre>
<p><strong>å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong></p>
<ol>
<li><strong>ç¬¬ä¸€æ¬¡æ¸²æŸ“ (Mount):</strong> <code>count</code> æ˜¯ 0ã€‚<code>useEffect</code> æ‰§è¡Œï¼Œåˆ›å»ºäº†ä¸€ä¸ªå®šæ—¶å™¨ã€‚è¿™ä¸ªå®šæ—¶å™¨æ•è·äº†<strong>å½“æ—¶</strong>çš„ <code>count</code> (ä¹Ÿå°±æ˜¯ 0)ã€‚</li>
<li><strong>ç¬¬äºŒæ¬¡æ¸²æŸ“:</strong> ç”¨æˆ·ç‚¹äº†æŒ‰é’®ï¼Œ<code>count</code> å˜æˆäº† 1ã€‚</li>
<li><strong>React æ£€æŸ¥ä¾èµ–:</strong> ä¾èµ–æ•°ç»„æ˜¯ <code>[]</code> (ç©ºçš„)ï¼Œè·Ÿä¸Šæ¬¡ä¸€æ ·ã€‚</li>
<li><strong>React å†³å®š:</strong> â€œæ—¢ç„¶ä¾èµ–æ²¡å˜ï¼Œé‚£æˆ‘å°±ä¸é‡æ–°è¿è¡Œ Effect äº†ã€‚â€</li>
<li><strong>ç»“æœ:</strong> æ—§çš„å®šæ—¶å™¨è¿˜åœ¨è·‘ï¼Œå®ƒæ‰‹é‡Œçš„ <code>count</code> <strong>ä¾ç„¶æ˜¯ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶çš„é‚£ä¸ª 0</strong>ã€‚å®ƒæ°¸è¿œä¸çŸ¥é“å¤–é¢ <code>count</code> å·²ç»å˜äº†ã€‚</li>
</ol>
<p><strong>è¿™å°±æ˜¯â€œå¯¹ React æ’’è°â€çš„ä»£ä»·ã€‚</strong></p>
<hr/>
<h3 data-id="heading-1">2. ä½†æ˜¯ï¼Œå¦‚æœä½ æŠŠå®ƒä»¬æ”¾è¿›å»...</h3>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> id = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count);
  }, <span class="hljs-number">1000</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearInterval</span>(id);
}, [count]); <span class="hljs-comment">// âœ… åŠ è¿›å»äº†</span>
</code></pre>
<p><strong>ç°åœ¨çš„è¡Œä¸ºï¼š</strong></p>
<ol>
<li><code>count</code> å˜äº† (0 -&gt; 1)ã€‚</li>
<li>React å‘ç°ä¾èµ–å˜äº†ã€‚</li>
<li><strong>æ¸…é™¤</strong>æ—§çš„å®šæ—¶å™¨ã€‚</li>
<li><strong>è¿è¡Œ</strong>æ–°çš„ Effectï¼Œåˆ›å»ºæ–°çš„å®šæ—¶å™¨ï¼ˆæ•è·æ–°çš„ <code>count</code> 1ï¼‰ã€‚</li>
</ol>
<p><strong>é—®é¢˜æ¥äº†ï¼š</strong> å®šæ—¶å™¨è¢«ä¸æ–­é‡ç½®ï¼Œè¿™å¯èƒ½ä¸æ˜¯ä½ æƒ³è¦çš„ï¼ˆæ¯”å¦‚ä¼šå¯¼è‡´è®¡æ—¶ä¸å‡†ï¼‰ã€‚</p>
<hr/>
<h3 data-id="heading-2">3. å¦‚ä½•â€œæ—¢ä¸æ’’è°ï¼Œåˆä¸é‡ç½®â€ï¼Ÿ</h3>
<p>å¯ä»¥ä½¿ç”¨ <code>useRef</code> å’Œ <code>useEffectEvent</code>ã€‚è¿™ä¸¤ä¸ªå·¥å…·å­˜åœ¨çš„æ„ä¹‰ï¼Œå°±æ˜¯ä¸ºäº†<strong>åˆæ³•åœ°</strong>æŠŠå˜é‡ä»ä¾èµ–æ•°ç»„é‡Œæ‹¿å‡ºæ¥ã€‚</p>
<h4 data-id="heading-3">æ–¹æ³• Aï¼šä½¿ç”¨å‡½æ•°å¼æ›´æ–° (å¦‚æœæ˜¯ setState)</h4>
<p>å¦‚æœä½ åªæ˜¯æƒ³ä¿®æ”¹çŠ¶æ€ï¼Œä¸éœ€è¦è¯»å–å®ƒï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> id = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// âœ… ä¸éœ€è¦ä¾èµ– countï¼Œå› ä¸º prev æ°¸è¿œæ˜¯ React ä¼ ç»™ä½ çš„æœ€æ–°å€¼</span>
    <span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> prev + <span class="hljs-number">1</span>); 
  }, <span class="hljs-number">1000</span>);
}, []); <span class="hljs-comment">// âœ… ç©ºæ•°ç»„æ˜¯å®‰å…¨çš„</span>
</code></pre>
<h4 data-id="heading-4">æ–¹æ³• Bï¼šä½¿ç”¨ <code>useRef</code> (é€ƒç”Ÿèˆ±)</h4>
<p>å¦‚æœä½ éœ€è¦è¯»å–å€¼ï¼Œä½†ä¸æƒ³è§¦å‘ Effect é‡è·‘ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> countRef = <span class="hljs-title function_">useRef</span>(count);
<span class="hljs-comment">// æ¯æ¬¡æ¸²æŸ“éƒ½åŒæ­¥æœ€æ–°å€¼</span>
<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> { countRef.<span class="hljs-property">current</span> = count });

<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> id = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// âœ… è¯» refï¼Œæ°¸è¿œæ˜¯æœ€æ–°çš„ï¼Œä¸” ref ä¸éœ€è¦æ”¾è¿›ä¾èµ–</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(countRef.<span class="hljs-property">current</span>); 
  }, <span class="hljs-number">1000</span>);
}, []); <span class="hljs-comment">// âœ… å®‰å…¨</span>
</code></pre>
<h4 data-id="heading-5">æ–¹æ³• Cï¼šä½¿ç”¨ <code>useEffectEvent</code> (æœ€æ–°æ ‡å‡†)</h4>
<p>æˆ‘ä»¬åœ¨ä¸Šä¸€ä¸ªé—®é¢˜é‡Œç”¨åˆ°çš„æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> onTick = <span class="hljs-title function_">useEffectEvent</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count); <span class="hljs-comment">// âœ… åœ¨è¿™é‡Œè¯»æœ€æ–°å€¼</span>
});

<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> id = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">onTick</span>();
  }, <span class="hljs-number">1000</span>);
}, []); <span class="hljs-comment">// âœ… å®‰å…¨</span>
</code></pre>
<h3 data-id="heading-6">æ€»ç»“</h3>
<ol>
<li>
<p><strong>å®˜æ–¹è§„åˆ™ (ESLint)ï¼š</strong> å‡¡æ˜¯ç”¨åˆ°çš„å“åº”å¼æ•°æ®ï¼ˆprops, state, contextï¼‰ï¼Œ<strong>å¿…é¡»</strong>å…¨éƒ¨å¡«å…¥ä¾èµ–æ•°ç»„ã€‚<strong>ä¸è¦è¯•å›¾é€šè¿‡æ¬ºéª— linter (<code>// eslint-disable</code>) æ¥è§£å†³é€»è¾‘é—®é¢˜ã€‚</strong></p>
</li>
<li>
<p><strong>åæœï¼š</strong> å¦‚æœä¸å¡«ï¼Œä»£ç ä¼šå¼•ç”¨æ—§å€¼ï¼ˆé—­åŒ…é™·é˜±ï¼‰ã€‚</p>
</li>
<li>
<p><strong>æ­£ç¡®åšæ³•ï¼š</strong> å¦‚æœä½ ä¸å¸Œæœ›æŸä¸ªå˜é‡å¯¼è‡´ Effect é‡æ–°è¿è¡Œï¼Œ<strong>ä¸è¦ç®€å•åœ°æŠŠå®ƒä»æ•°ç»„é‡Œåˆ æ‰</strong>ï¼Œè€Œæ˜¯åº”è¯¥ï¼š</p>
<ul>
<li>ç”¨ <code>useRef</code> æŠŠå®ƒåŒ…èµ·æ¥ã€‚</li>
<li>æˆ–è€…ç”¨ <code>useEffectEvent</code> æŠŠå®ƒéš”ç¦»å¼€ã€‚</li>
<li>æˆ–è€…æ£€æŸ¥æ˜¯å¦å¯ä»¥ç§»å‡º Effectã€‚</li>
</ul>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Oracleå…¥é—¨åˆ°åˆ åº“è·‘è·¯-02ã€‘åŸºç¡€å…¥é—¨ï¼šOracleå®‰è£…ä¸é…ç½®]]></title>    <link>https://juejin.cn/post/7579887768227561506</link>    <guid>https://juejin.cn/post/7579887768227561506</guid>    <pubDate>2025-12-05T02:48:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579887768227561506" data-draft-id="7579887768227495970" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Oracleå…¥é—¨åˆ°åˆ åº“è·‘è·¯-02ã€‘åŸºç¡€å…¥é—¨ï¼šOracleå®‰è£…ä¸é…ç½®"/> <meta itemprop="keywords" content="æ•°æ®åº“,Oracle"/> <meta itemprop="datePublished" content="2025-12-05T02:48:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¶æ—¥å¤±çœ è€…"/> <meta itemprop="url" content="https://juejin.cn/user/3411111810444068"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Oracleå…¥é—¨åˆ°åˆ åº“è·‘è·¯-02ã€‘åŸºç¡€å…¥é—¨ï¼šOracleå®‰è£…ä¸é…ç½®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3411111810444068/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¶æ—¥å¤±çœ è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T02:48:56.000Z" title="Fri Dec 05 2025 02:48:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç³»ç»Ÿè¦æ±‚å’Œå‡†å¤‡å·¥ä½œ</h2>
<p>åœ¨å®‰è£…Oracleæ•°æ®åº“ä¹‹å‰ï¼Œéœ€è¦ç¡®ä¿ç³»ç»Ÿæ»¡è¶³æœ€ä½ç¡¬ä»¶å’Œè½¯ä»¶è¦æ±‚ã€‚</p>
<h3 data-id="heading-1">ç¡¬ä»¶è¦æ±‚</h3>
<ol>
<li><strong>å†…å­˜</strong>ï¼šè‡³å°‘4GB RAMï¼ˆæ¨è8GBæˆ–æ›´é«˜ï¼‰</li>
<li><strong>ç£ç›˜ç©ºé—´</strong>ï¼š
<ul>
<li>ä¼ä¸šç‰ˆï¼šè‡³å°‘6.5GB</li>
<li>æ ‡å‡†ç‰ˆï¼šè‡³å°‘6GB</li>
<li>ä¸´æ—¶å®‰è£…ç©ºé—´ï¼š1GB</li>
</ul>
</li>
<li><strong>æ˜¾ç¤ºå™¨</strong>ï¼š1024Ã—768åˆ†è¾¨ç‡æˆ–æ›´é«˜</li>
</ol>
<h3 data-id="heading-2">è½¯ä»¶è¦æ±‚</h3>
<ol>
<li><strong>æ“ä½œç³»ç»Ÿ</strong>ï¼š
<ul>
<li>Windows Server 2016/2019/2022</li>
<li>Red Hat Enterprise Linux 7/8</li>
<li>Oracle Linux 7/8</li>
<li>SUSE Linux Enterprise Server 12/15</li>
</ul>
</li>
<li><strong>å†…æ ¸å‚æ•°</strong>ï¼ˆLinuxï¼‰ï¼š
<ul>
<li>semmsl=250</li>
<li>semmns=32000</li>
<li>semopm=100</li>
<li>semmni=128</li>
</ul>
</li>
</ol>
<h3 data-id="heading-3">å®‰è£…å‰å‡†å¤‡</h3>
<ol>
<li>åˆ›å»ºä¸“ç”¨çš„Oracleç”¨æˆ·å’Œç»„</li>
<li>é…ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡</li>
<li>å…³é—­é˜²ç«å¢™å’Œæ€æ¯’è½¯ä»¶ï¼ˆä¸´æ—¶ï¼‰</li>
<li>ä¸‹è½½Oracleå®‰è£…ä»‹è´¨</li>
</ol>
<h2 data-id="heading-4">2.2 Windowsç¯å¢ƒä¸‹Oracleå®‰è£…</h2>
<h3 data-id="heading-5">å®‰è£…æ­¥éª¤</h3>
<ol>
<li>
<p><strong>è§£å‹å®‰è£…æ–‡ä»¶</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è§£å‹ä¸‹è½½çš„zipæ–‡ä»¶åˆ°æŒ‡å®šç›®å½•</span>
</code></pre>
</li>
<li>
<p><strong>è¿è¡Œå®‰è£…ç¨‹åº</strong></p>
<ul>
<li>ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œsetup.exe</li>
<li>é€‰æ‹©"åˆ›å»ºå’Œé…ç½®æ•°æ®åº“"</li>
</ul>
</li>
<li>
<p><strong>é…ç½®å®‰å…¨æ›´æ–°</strong></p>
<ul>
<li>å¯é€‰æ‹©è·³è¿‡æ›´æ–°æ³¨å†Œ</li>
</ul>
</li>
<li>
<p><strong>é€‰æ‹©å®‰è£…é€‰é¡¹</strong></p>
<ul>
<li>åˆ›å»ºå’Œé…ç½®æ•°æ®åº“</li>
<li>ç³»ç»Ÿç±»ï¼šæ¡Œé¢ç±»æˆ–æœåŠ¡å™¨ç±»</li>
</ul>
</li>
<li>
<p><strong>å…¸å‹å®‰è£…é…ç½®</strong></p>
<ul>
<li>OracleåŸºç›®å½•ï¼šC:\app\username</li>
<li>æ•°æ®åº“æ–‡ä»¶ä½ç½®ï¼šC:\app\username\product\version\dbhome</li>
<li>å…¨å±€æ•°æ®åº“åï¼šorcl</li>
<li>ç®¡ç†å‘˜å¯†ç ï¼šè®¾ç½®SYSå’ŒSYSTEMç”¨æˆ·å¯†ç </li>
</ul>
</li>
<li>
<p><strong>å…ˆå†³æ¡ä»¶æ£€æŸ¥</strong></p>
<ul>
<li>ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æŸ¥ç¯å¢ƒ</li>
<li>å¦‚æœ‰é—®é¢˜éœ€è¦è§£å†³åå†ç»§ç»­</li>
</ul>
</li>
<li>
<p><strong>æ¦‚è¦ä¿¡æ¯</strong></p>
<ul>
<li>ç¡®è®¤å®‰è£…é…ç½®ä¿¡æ¯</li>
<li>ç‚¹å‡»"å®Œæˆ"å¼€å§‹å®‰è£…</li>
</ul>
</li>
<li>
<p><strong>å®‰è£…è¿›åº¦</strong></p>
<ul>
<li>ç­‰å¾…å®‰è£…è¿‡ç¨‹å®Œæˆ</li>
<li>è‡ªåŠ¨æ‰§è¡Œé…ç½®è„šæœ¬</li>
</ul>
</li>
</ol>
<h3 data-id="heading-6">å®‰è£…åéªŒè¯</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- è¿æ¥åˆ°æ•°æ®åº“éªŒè¯å®‰è£…</span>
sqlplus <span class="hljs-operator">/</span> <span class="hljs-keyword">as</span> sysdba

<span class="hljs-comment">-- æŸ¥çœ‹æ•°æ®åº“çŠ¶æ€</span>
<span class="hljs-keyword">SELECT</span> status <span class="hljs-keyword">FROM</span> v$instance;

<span class="hljs-comment">-- æŸ¥çœ‹æ•°æ®åº“ç‰ˆæœ¬</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> v$version;
</code></pre>
<h2 data-id="heading-7">2.3 Linuxç¯å¢ƒä¸‹Oracleå®‰è£…</h2>
<h3 data-id="heading-8">ç³»ç»Ÿé…ç½®</h3>
<ol>
<li>
<p><strong>åˆ›å»ºç”¨æˆ·å’Œç»„</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºoinstallç»„</span>
groupadd oinstall

<span class="hljs-comment"># åˆ›å»ºdbaç»„</span>
groupadd dba

<span class="hljs-comment"># åˆ›å»ºoracleç”¨æˆ·</span>
useradd -g oinstall -G dba oracle

<span class="hljs-comment"># è®¾ç½®å¯†ç </span>
passwd oracle
</code></pre>
</li>
<li>
<p><strong>é…ç½®å†…æ ¸å‚æ•°</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¾‘/etc/sysctl.confæ–‡ä»¶</span>
vi /etc/sysctl.conf

<span class="hljs-comment"># æ·»åŠ ä»¥ä¸‹å‚æ•°</span>
kernel.shmall = 2097152
kernel.shmmax = 4294967295
kernel.shmmni = 4096
kernel.sem = 250 32000 100 128
fs.file-max = 6815744
fs.aio-max-nr = 1048576
net.ipv4.ip_local_port_range = 9000 65500
net.core.rmem_default = 262144
net.core.rmem_max = 4194304
net.core.wmem_default = 262144
net.core.wmem_max = 1048576
</code></pre>
</li>
<li>
<p><strong>åº”ç”¨å†…æ ¸å‚æ•°</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿é…ç½®ç”Ÿæ•ˆ</span>
/sbin/sysctl -p
</code></pre>
</li>
</ol>
<h3 data-id="heading-9">å®‰è£…æ­¥éª¤</h3>
<ol>
<li>
<p><strong>è§£å‹å®‰è£…æ–‡ä»¶</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ‡æ¢åˆ°oracleç”¨æˆ·</span>
su - oracle

<span class="hljs-comment"># è§£å‹å®‰è£…æ–‡ä»¶</span>
unzip linuxamd64_19c_database.zip
</code></pre>
</li>
<li>
<p><strong>è¿è¡Œå®‰è£…ç¨‹åº</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿›å…¥å®‰è£…ç›®å½•</span>
<span class="hljs-built_in">cd</span> database

<span class="hljs-comment"># è¿è¡Œå®‰è£…ç¨‹åº</span>
./runInstaller
</code></pre>
</li>
<li>
<p><strong>å›¾å½¢åŒ–å®‰è£…ç•Œé¢</strong></p>
<ul>
<li>é€‰æ‹©"åˆ›å»ºå’Œé…ç½®æ•°æ®åº“"</li>
<li>é€‰æ‹©"æ¡Œé¢ç±»"æˆ–"æœåŠ¡å™¨ç±»"</li>
<li>é…ç½®OracleåŸºç›®å½•å’Œè½¯ä»¶ä½ç½®</li>
<li>è®¾ç½®æ•°æ®åº“æ ‡è¯†ç¬¦å’Œå¯†ç </li>
<li>æ‰§è¡Œå…ˆå†³æ¡ä»¶æ£€æŸ¥</li>
<li>ç¡®è®¤é…ç½®å¹¶å¼€å§‹å®‰è£…</li>
</ul>
</li>
<li>
<p><strong>æ‰§è¡Œé…ç½®è„šæœ¬</strong></p>
<ul>
<li>å®‰è£…å®Œæˆåï¼Œä»¥rootç”¨æˆ·æ‰§è¡Œæç¤ºçš„è„šæœ¬</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä»¥rootèº«ä»½æ‰§è¡Œ</span>
/oraInventory/orainstRoot.sh
/u01/app/oracle/product/19.0.0/dbhome_1/root.sh
</code></pre>
</li>
</ol>
<h2 data-id="heading-10">2.4 æ•°æ®åº“åˆ›å»ºå’Œé…ç½®</h2>
<h3 data-id="heading-11">ä½¿ç”¨DBCAåˆ›å»ºæ•°æ®åº“</h3>
<ol>
<li>
<p><strong>å¯åŠ¨DBCA</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ</span>
dbca
</code></pre>
</li>
<li>
<p><strong>åˆ›å»ºæ•°æ®åº“å‘å¯¼</strong></p>
<ul>
<li>é€‰æ‹©"åˆ›å»ºæ•°æ®åº“"</li>
<li>é€‰æ‹©"é«˜çº§é…ç½®"</li>
<li>è¾“å…¥å…¨å±€æ•°æ®åº“åå’ŒSID</li>
<li>é€‰æ‹©æ•°æ®åº“æ¨¡æ¿ï¼ˆé€šç”¨æˆ–æ•°æ®ä»“åº“ï¼‰</li>
</ul>
</li>
<li>
<p><strong>é…ç½®æ•°æ®åº“é€‰é¡¹</strong></p>
<ul>
<li>å¯ç”¨ä¼ä¸šç®¡ç†å™¨</li>
<li>é…ç½®å­—ç¬¦é›†ï¼ˆæ¨èAL32UTF8ï¼‰</li>
<li>è®¾ç½®ç®¡ç†å‘˜å¯†ç </li>
</ul>
</li>
<li>
<p><strong>å­˜å‚¨é…ç½®</strong></p>
<ul>
<li>é€‰æ‹©æ–‡ä»¶ç³»ç»Ÿæˆ–ASMå­˜å‚¨</li>
<li>é…ç½®å¿«é€Ÿæ¢å¤åŒº</li>
</ul>
</li>
<li>
<p><strong>åˆå§‹åŒ–å‚æ•°</strong></p>
<ul>
<li>å†…å­˜ç®¡ç†é€‰é¡¹</li>
<li>è¿›ç¨‹æ•°é…ç½®</li>
<li>å­—ç¬¦é›†è®¾ç½®</li>
</ul>
</li>
</ol>
<h3 data-id="heading-12">æ‰‹åŠ¨åˆ›å»ºæ•°æ®åº“</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- 1. è®¾ç½®ç¯å¢ƒå˜é‡</span>
export ORACLE_SID<span class="hljs-operator">=</span>orcl

<span class="hljs-comment">-- 2. å¯åŠ¨å®ä¾‹åˆ°nomountçŠ¶æ€</span>
sqlplus <span class="hljs-operator">/</span> <span class="hljs-keyword">as</span> sysdba
STARTUP NOMOUNT

<span class="hljs-comment">-- 3. åˆ›å»ºæ•°æ®åº“</span>
<span class="hljs-keyword">CREATE</span> DATABASE orcl
   <span class="hljs-keyword">USER</span> SYS IDENTIFIED <span class="hljs-keyword">BY</span> password
   <span class="hljs-keyword">USER</span> <span class="hljs-keyword">SYSTEM</span> IDENTIFIED <span class="hljs-keyword">BY</span> password
   LOGFILE <span class="hljs-keyword">GROUP</span> <span class="hljs-number">1</span> (<span class="hljs-string">'/u01/app/oracle/oradata/orcl/redo01.log'</span>) SIZE <span class="hljs-number">100</span>M,
           <span class="hljs-keyword">GROUP</span> <span class="hljs-number">2</span> (<span class="hljs-string">'/u01/app/oracle/oradata/orcl/redo02.log'</span>) SIZE <span class="hljs-number">100</span>M,
           <span class="hljs-keyword">GROUP</span> <span class="hljs-number">3</span> (<span class="hljs-string">'/u01/app/oracle/oradata/orcl/redo03.log'</span>) SIZE <span class="hljs-number">100</span>M
   MAXLOGFILES <span class="hljs-number">5</span>
   MAXLOGMEMBERS <span class="hljs-number">5</span>
   MAXLOGHISTORY <span class="hljs-number">1</span>
   MAXDATAFILES <span class="hljs-number">100</span>
   <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> AL32UTF8
   <span class="hljs-type">NATIONAL</span> <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> AL16UTF16
   EXTENT MANAGEMENT <span class="hljs-keyword">LOCAL</span>
   DATAFILE <span class="hljs-string">'/u01/app/oracle/oradata/orcl/system01.dbf'</span>
     SIZE <span class="hljs-number">325</span>M REUSE
   SYSAUX DATAFILE <span class="hljs-string">'/u01/app/oracle/oradata/orcl/sysaux01.dbf'</span>
     SIZE <span class="hljs-number">325</span>M REUSE
   <span class="hljs-keyword">DEFAULT</span> TABLESPACE users
     DATAFILE <span class="hljs-string">'/u01/app/oracle/oradata/orcl/users01.dbf'</span>
     SIZE <span class="hljs-number">20</span>M REUSE
   <span class="hljs-keyword">DEFAULT</span> TEMPORARY TABLESPACE temp
     TEMPFILE <span class="hljs-string">'/u01/app/oracle/oradata/orcl/temp01.dbf'</span>
     SIZE <span class="hljs-number">20</span>M REUSE
   UNDO TABLESPACE undotbs1
     DATAFILE <span class="hljs-string">'/u01/app/oracle/oradata/orcl/undotbs01.dbf'</span>
     SIZE <span class="hljs-number">200</span>M REUSE;

<span class="hljs-comment">-- 4. è¿è¡Œè„šæœ¬åˆ›å»ºæ•°æ®å­—å…¸</span>
@$ORACLE_HOME<span class="hljs-operator">/</span>rdbms<span class="hljs-operator">/</span>admin<span class="hljs-operator">/</span>catalog.sql
@$ORACLE_HOME<span class="hljs-operator">/</span>rdbms<span class="hljs-operator">/</span>admin<span class="hljs-operator">/</span>catproc.sql
@$ORACLE_HOME<span class="hljs-operator">/</span>sqlplus<span class="hljs-operator">/</span>admin<span class="hljs-operator">/</span>pupbld.sql
</code></pre>
<h2 data-id="heading-13">2.5 Oracleç½‘ç»œé…ç½®</h2>
<h3 data-id="heading-14">ç›‘å¬å™¨é…ç½®</h3>
<ol>
<li>
<p><strong>å¯åŠ¨Net Configuration Assistant</strong></p>
<pre><code class="hljs language-bash" lang="bash">netca
</code></pre>
</li>
<li>
<p><strong>é…ç½®ç›‘å¬å™¨</strong></p>
<ul>
<li>é€‰æ‹©"ç›‘å¬ç¨‹åºé…ç½®"</li>
<li>æ·»åŠ æˆ–é…ç½®ç›‘å¬å™¨</li>
<li>è®¾ç½®ç›‘å¬ç«¯å£ï¼ˆé»˜è®¤1521ï¼‰</li>
<li>é€‰æ‹©åè®®ï¼ˆTCPï¼‰</li>
</ul>
</li>
<li>
<p><strong>æ‰‹åŠ¨é…ç½®ç›‘å¬å™¨</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¾‘listener.oraæ–‡ä»¶</span>
vi <span class="hljs-variable">$ORACLE_HOME</span>/network/admin/listener.ora

<span class="hljs-comment"># ç¤ºä¾‹é…ç½®</span>
LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = TCP)(HOST = localhost)(PORT = 1521))
    )
  )

SID_LIST_LISTENER =
  (SID_LIST =
    (SID_DESC =
      (SID_NAME = orcl)
      (ORACLE_HOME = /u01/app/oracle/product/19.0.0/dbhome_1)
    )
  )
</code></pre>
</li>
</ol>
<h3 data-id="heading-15">å®¢æˆ·ç«¯è¿æ¥é…ç½®</h3>
<ol>
<li>
<p><strong>é…ç½®tnsnames.ora</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¾‘tnsnames.oraæ–‡ä»¶</span>
vi <span class="hljs-variable">$ORACLE_HOME</span>/network/admin/tnsnames.ora

<span class="hljs-comment"># ç¤ºä¾‹é…ç½®</span>
ORCL =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = localhost)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = orcl)
    )
  )
</code></pre>
</li>
<li>
<p><strong>æµ‹è¯•è¿æ¥</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨tnspingæµ‹è¯•ç½‘ç»œè¿æ¥</span>
tnsping orcl

<span class="hljs-comment"># ä½¿ç”¨sqlplusè¿æ¥æ•°æ®åº“</span>
sqlplus system/password@orcl
</code></pre>
</li>
</ol>
<h2 data-id="heading-16">2.6 å®‰è£…åé…ç½®å’Œä¼˜åŒ–</h2>
<h3 data-id="heading-17">å¯åŠ¨å’Œåœæ­¢æ•°æ®åº“</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨æ•°æ®åº“</span>
sqlplus / as sysdba
STARTUP

<span class="hljs-comment"># åœæ­¢æ•°æ®åº“</span>
SHUTDOWN IMMEDIATE

<span class="hljs-comment"># å¯åŠ¨ç›‘å¬å™¨</span>
lsnrctl start

<span class="hljs-comment"># åœæ­¢ç›‘å¬å™¨</span>
lsnrctl stop
</code></pre>
<h3 data-id="heading-18">åˆ›å»ºå¯åŠ¨è„šæœ¬</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºæ•°æ®åº“å¯åŠ¨è„šæœ¬</span>
vi /home/oracle/startdb.sh

<span class="hljs-comment">#!/bin/bash</span>
<span class="hljs-built_in">export</span> ORACLE_SID=orcl
sqlplus / as sysdba &lt;&lt; <span class="hljs-string">EOF
STARTUP
EXIT
EOF</span>
lsnrctl start

<span class="hljs-comment"># åˆ›å»ºæ•°æ®åº“åœæ­¢è„šæœ¬</span>
vi /home/oracle/stopdb.sh

<span class="hljs-comment">#!/bin/bash</span>
lsnrctl stop
<span class="hljs-built_in">export</span> ORACLE_SID=orcl
sqlplus / as sysdba &lt;&lt; <span class="hljs-string">EOF
SHUTDOWN IMMEDIATE
EXIT
EOF</span>
</code></pre>
<h3 data-id="heading-19">å¸¸è§é…ç½®å‚æ•°</h3>
<ol>
<li>
<p><strong>å†…å­˜é…ç½®</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥çœ‹SGAå¤§å°</span>
<span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">PARAMETER</span> sga;

<span class="hljs-comment">-- ä¿®æ”¹SGAå¤§å°</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-keyword">SET</span> sga_max_size<span class="hljs-operator">=</span><span class="hljs-number">2</span>G <span class="hljs-keyword">SCOPE</span><span class="hljs-operator">=</span>SPFILE;
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-keyword">SET</span> sga_target<span class="hljs-operator">=</span><span class="hljs-number">1</span>G <span class="hljs-keyword">SCOPE</span><span class="hljs-operator">=</span><span class="hljs-keyword">BOTH</span>;
</code></pre>
</li>
<li>
<p><strong>è¿›ç¨‹é…ç½®</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥çœ‹è¿›ç¨‹æ•°</span>
<span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">PARAMETER</span> processes;

<span class="hljs-comment">-- ä¿®æ”¹è¿›ç¨‹æ•°</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-keyword">SET</span> processes<span class="hljs-operator">=</span><span class="hljs-number">300</span> <span class="hljs-keyword">SCOPE</span><span class="hljs-operator">=</span>SPFILE;
</code></pre>
</li>
</ol>
<h2 data-id="heading-20">2.7 æœ¬ç« å°ç»“</h2>
<p>æœ¬ç« è¯¦ç»†ä»‹ç»äº†Oracleæ•°æ®åº“åœ¨Windowså’ŒLinuxç¯å¢ƒä¸‹çš„å®‰è£…è¿‡ç¨‹ï¼ŒåŒ…æ‹¬ç³»ç»Ÿè¦æ±‚ã€å®‰è£…æ­¥éª¤ã€æ•°æ®åº“åˆ›å»ºå’Œç½‘ç»œé…ç½®ç­‰å†…å®¹ã€‚æŒæ¡è¿™äº›æŠ€èƒ½æ˜¯ä½¿ç”¨Oracleæ•°æ®åº“çš„åŸºç¡€ã€‚</p>
<h2 data-id="heading-21">ç»ƒä¹ é¢˜</h2>
<ol>
<li>åˆ—å‡ºOracleæ•°æ®åº“å®‰è£…çš„ç³»ç»Ÿè¦æ±‚</li>
<li>æè¿°åœ¨Linuxç¯å¢ƒä¸‹åˆ›å»ºOracleç”¨æˆ·å’Œç»„çš„æ­¥éª¤</li>
<li>è§£é‡Šå¦‚ä½•ä½¿ç”¨DBCAåˆ›å»ºæ•°æ®åº“</li>
<li>é…ç½®ç›‘å¬å™¨å’Œå®¢æˆ·ç«¯è¿æ¥çš„æ­¥éª¤</li>
<li>ç¼–å†™ä¸€ä¸ªç®€å•çš„æ•°æ®åº“å¯åŠ¨å’Œåœæ­¢è„šæœ¬</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥è§£æ OOP è€ƒé¢˜ä¹‹ EditInPlace ç±»ï¼šä»é›¶å¼€å§‹æŒæ¡é¢å‘å¯¹è±¡ç¼–ç¨‹å®æˆ˜]]></title>    <link>https://juejin.cn/post/7579917791764643867</link>    <guid>https://juejin.cn/post/7579917791764643867</guid>    <pubDate>2025-12-05T02:47:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579917791764643867" data-draft-id="7579473409749073971" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥è§£æ OOP è€ƒé¢˜ä¹‹ EditInPlace ç±»ï¼šä»é›¶å¼€å§‹æŒæ¡é¢å‘å¯¹è±¡ç¼–ç¨‹å®æˆ˜"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,DOM"/> <meta itemprop="datePublished" content="2025-12-05T02:47:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AAAé˜¿giao"/> <meta itemprop="url" content="https://juejin.cn/user/473218785740627"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥è§£æ OOP è€ƒé¢˜ä¹‹ EditInPlace ç±»ï¼šä»é›¶å¼€å§‹æŒæ¡é¢å‘å¯¹è±¡ç¼–ç¨‹å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/473218785740627/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AAAé˜¿giao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T02:47:16.000Z" title="Fri Dec 05 2025 02:47:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€ï¼šä»€ä¹ˆæ˜¯â€œå°±åœ°ç¼–è¾‘â€ï¼Ÿ</h2>
<p>æƒ³è±¡ä¸€ä¸‹ä½ åœ¨ä½¿ç”¨æŸç¤¾äº¤å¹³å°æ—¶ï¼Œç‚¹å‡»è‡ªå·±çš„æ˜µç§°ï¼Œå®ƒç«‹åˆ»å˜æˆä¸€ä¸ªè¾“å…¥æ¡†ï¼Œä½ å¯ä»¥ç›´æ¥ä¿®æ”¹å¹¶ä¿å­˜ã€‚è¿™ç§äº¤äº’æ–¹å¼å«åš <strong>â€œå°±åœ°ç¼–è¾‘â€ï¼ˆEdit in Placeï¼‰</strong> â€”â€” ä¸éœ€è¦è·³è½¬é¡µé¢æˆ–å¼¹å‡ºæ–°çª—å£ï¼Œç›´æ¥åœ¨å½“å‰ä½ç½®å®Œæˆç¼–è¾‘ã€‚</p>
<p>è¿™çœ‹ä¼¼ç®€å•çš„å°åŠŸèƒ½ï¼Œå…¶å®è•´å«äº†éå¸¸å…¸å‹çš„ <strong>é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰</strong> æ€æƒ³ã€‚ä»Šå¤©æˆ‘ä»¬å°±é€šè¿‡ä¸€é“ç»å…¸çš„ OOP è€ƒé¢˜â€”â€”<code>EditInPlace</code> ç±»ï¼Œæ‰‹æŠŠæ‰‹å¸¦ä½ ä»ä¸€è¡Œä»£ç éƒ½ä¸æ‡‚çš„æ–°æ‰‹ï¼Œæˆé•¿ä¸ºèƒ½å†™å‡ºä¸“ä¸šçº§å°è£…ä»£ç çš„å¼€å‘è€…ã€‚</p>
<p>æˆ‘ä»¬å°† <strong>é€è¡Œè§£æ <code>edit_in_place.js</code> æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œä»£ç </strong>ï¼Œå½»åº•è®²é€è¿™ä¸ªç±»æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€é¡¹ç›®ç»“æ„æ¦‚è§ˆ</h2>
<ul>
<li><code>index.html</code>ï¼šç©ºé¡µé¢ï¼ˆä½œä¸ºæŒ‚è½½ç‚¹ï¼Œå®é™…ä½¿ç”¨æ—¶ä¼šå¼•å…¥ JSï¼‰</li>
<li><code>edit_in_place.js</code>ï¼šæ ¸å¿ƒå®ç°æ–‡ä»¶ï¼ŒåŒ…å«å®Œæ•´çš„ <code>EditInPlace</code> ç±»</li>
</ul>
<pre><code class="hljs">edit-in-place/
â”œâ”€â”€ index.html
â”œâ”€â”€ edit_in_place.js
</code></pre>
<p>æˆ‘ä»¬çš„é‡ç‚¹å°±æ˜¯ <strong><code>edit_in_place.js</code></strong>ã€‚ä¸‹é¢æˆ‘ä»¬å°†é€è¡Œæ‹†è§£å®ƒã€‚</p>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€å®Œæ•´ä»£ç  + é€è¡Œè¯¦ç»†æ³¨é‡Š</h2>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@func</span> EditInPlace å°±åœ°ç¼–è¾‘
 * <span class="hljs-doctag">@params</span> {string} value åˆå§‹å€¼
 * <span class="hljs-doctag">@params</span> {element} parentElement æŒ‚è½½ç‚¹
 * <span class="hljs-doctag">@params</span> {string} id è‡ªèº«ID
 */</span>
function EditInPlace(id, value, parentElement) {
    <span class="hljs-comment">// æ­¤æ—¶ this æŒ‡å‘ä¸€ä¸ªå…¨æ–°çš„ç©ºå¯¹è±¡ {}</span>
    <span class="hljs-comment">// æ„é€ å‡½æ•°çš„ä½œç”¨ï¼šåˆå§‹åŒ–å®ä¾‹çš„å±æ€§</span>

    <span class="hljs-keyword">this</span>.id = id; <span class="hljs-comment">// ç»™å®ä¾‹è®¾ç½®å”¯ä¸€ IDï¼Œç”¨äº DOM å…ƒç´ æ ‡è¯†</span>
    <span class="hljs-keyword">this</span>.value = value || <span class="hljs-string">'è¿™ä¸ªå®¶ä¼™å¾ˆæ‡’ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ç•™ä¸‹'</span>; <span class="hljs-comment">// å¦‚æœä¼ å…¥ value ä¸ºå‡å€¼ï¼ˆå¦‚ null/undefinedï¼‰ï¼Œåˆ™ä½¿ç”¨é»˜è®¤æ–‡æœ¬</span>
    <span class="hljs-keyword">this</span>.parentElement = parentElement; <span class="hljs-comment">// è®°å½•çˆ¶å®¹å™¨ï¼Œåç»­è¦æŠŠç¼–è¾‘åŒºåŸŸæŒ‚è½½åˆ°å®ƒé‡Œé¢</span>

    <span class="hljs-comment">// é¢„å…ˆå£°æ˜æ‰€æœ‰å°†è¦ä½¿ç”¨çš„ DOM å…ƒç´ å¼•ç”¨ï¼Œåˆå§‹ä¸º nullï¼ˆè‰¯å¥½ä¹ æƒ¯ï¼šæå‰å£°æ˜å˜é‡ï¼‰</span>
    <span class="hljs-keyword">this</span>.containerElement = <span class="hljs-literal">null</span>; <span class="hljs-comment">// æœ€å¤–å±‚å®¹å™¨ div</span>
    <span class="hljs-keyword">this</span>.saveButton = <span class="hljs-literal">null</span>;       <span class="hljs-comment">// â€œä¿å­˜â€æŒ‰é’®</span>
    <span class="hljs-keyword">this</span>.cancelButton = <span class="hljs-literal">null</span>;     <span class="hljs-comment">// â€œå–æ¶ˆâ€æŒ‰é’®</span>
    <span class="hljs-keyword">this</span>.fieldElement = <span class="hljs-literal">null</span>;     <span class="hljs-comment">// è¾“å…¥æ¡† input</span>
    <span class="hljs-keyword">this</span>.staticElement = <span class="hljs-literal">null</span>;    <span class="hljs-comment">// é™æ€æ–‡æœ¬ span</span>

    <span class="hljs-comment">// æŒ‰åŠŸèƒ½æ‹†åˆ†é€»è¾‘ï¼šå…ˆåˆ›å»º DOM å…ƒç´ </span>
    <span class="hljs-keyword">this</span>.createElement(); 
    <span class="hljs-comment">// å†ç»‘å®šäº‹ä»¶ç›‘å¬å™¨</span>
    <span class="hljs-keyword">this</span>.attachEvent();
}
</code></pre>
<h3 data-id="heading-3">æ„é€ å‡½æ•°è§£æ</h3>
<ul>
<li>
<p>è¿™æ˜¯ä¸€ä¸ª <strong>æ„é€ å‡½æ•°</strong>ï¼ˆä¸æ˜¯ ES6 çš„ <code>class</code>ï¼Œè€Œæ˜¯ä¼ ç»ŸåŸºäºå‡½æ•°çš„ OOP å†™æ³•ï¼‰ã€‚</p>
</li>
<li>
<p>å½“ä½ å†™ <code>new EditInPlace(...)</code> æ—¶ï¼ŒJavaScript ä¼šï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ <code>{}</code>ï¼›</li>
<li>æŠŠ <code>this</code> æŒ‡å‘è¿™ä¸ªç©ºå¯¹è±¡ï¼›</li>
<li>æ‰§è¡Œå‡½æ•°ä½“å†…çš„ä»£ç ï¼Œç»™ <code>this</code> æ·»åŠ å±æ€§ï¼›</li>
<li>è¿”å›è¿™ä¸ªå¯¹è±¡ã€‚</li>
</ol>
</li>
</ul>
<blockquote>
<p><strong>æç¤º</strong>ï¼š<code>this</code> åœ¨è¿™é‡Œä»£è¡¨â€œå½“å‰æ­£åœ¨åˆ›å»ºçš„ç¼–è¾‘å™¨å®ä¾‹â€ã€‚</p>
</blockquote>
<hr/>
<pre><code class="hljs language-kotlin" lang="kotlin">EditInPlace.prototype = {
    <span class="hljs-comment">// å°è£…äº†DOMæ“ä½œ</span>
    createElement: function() {
        <span class="hljs-comment">// åˆ›å»ºæœ€å¤–å±‚å®¹å™¨ &lt;div&gt;</span>
        <span class="hljs-keyword">this</span>.containerElement = document.createElement(<span class="hljs-string">'div'</span>);
        
        <span class="hljs-comment">// ç»™å®¹å™¨è®¾ç½® IDï¼ˆæ–¹ä¾¿è°ƒè¯•æˆ– CSS æ ·å¼æ§åˆ¶ï¼‰</span>
        <span class="hljs-keyword">this</span>.containerElement.id = <span class="hljs-keyword">this</span>.id;

        <span class="hljs-comment">// åˆ›å»ºé™æ€æ–‡æœ¬æ˜¾ç¤ºåŒºåŸŸ &lt;span&gt;</span>
        <span class="hljs-keyword">this</span>.staticElement = document.createElement(<span class="hljs-string">'span'</span>);
        <span class="hljs-keyword">this</span>.staticElement.innerHTML = <span class="hljs-keyword">this</span>.value; <span class="hljs-comment">// æ˜¾ç¤ºåˆå§‹å€¼</span>
        
        <span class="hljs-comment">// æŠŠ span æŒ‚åˆ°å®¹å™¨é‡Œ</span>
        <span class="hljs-keyword">this</span>.containerElement.appendChild(<span class="hljs-keyword">this</span>.staticElement);

        <span class="hljs-comment">// åˆ›å»ºè¾“å…¥æ¡† &lt;input type="text"&gt;</span>
        <span class="hljs-keyword">this</span>.fieldElement = document.createElement(<span class="hljs-string">'input'</span>);
        <span class="hljs-keyword">this</span>.fieldElement.type = <span class="hljs-string">'text'</span>;
        <span class="hljs-keyword">this</span>.fieldElement.value = <span class="hljs-keyword">this</span>.value; <span class="hljs-comment">// è¾“å…¥æ¡†ä¹Ÿæ˜¾ç¤ºåˆå§‹å€¼</span>
        <span class="hljs-keyword">this</span>.containerElement.appendChild(<span class="hljs-keyword">this</span>.fieldElement); <span class="hljs-comment">// æŒ‚åˆ°å®¹å™¨</span>

        <span class="hljs-comment">// æŠŠæ•´ä¸ªå®¹å™¨æŒ‚åˆ°ç”¨æˆ·æŒ‡å®šçš„çˆ¶å…ƒç´ ä¸­ï¼ˆæ¯”å¦‚ body æˆ–æŸä¸ª divï¼‰</span>
        <span class="hljs-keyword">this</span>.parentElement.appendChild(<span class="hljs-keyword">this</span>.containerElement);

        <span class="hljs-comment">// åˆ›å»ºâ€œä¿å­˜â€æŒ‰é’®</span>
        <span class="hljs-keyword">this</span>.saveButton = document.createElement(<span class="hljs-string">'input'</span>);
        <span class="hljs-keyword">this</span>.saveButton.type = <span class="hljs-string">'button'</span>;
        <span class="hljs-keyword">this</span>.saveButton.value = <span class="hljs-string">'ä¿å­˜'</span>;
        <span class="hljs-keyword">this</span>.containerElement.appendChild(<span class="hljs-keyword">this</span>.saveButton);

        <span class="hljs-comment">// åˆ›å»ºâ€œå–æ¶ˆâ€æŒ‰é’®</span>
        <span class="hljs-keyword">this</span>.cancelButton = document.createElement(<span class="hljs-string">'input'</span>);
        <span class="hljs-keyword">this</span>.cancelButton.type = <span class="hljs-string">'button'</span>;
        <span class="hljs-keyword">this</span>.cancelButton.value = <span class="hljs-string">'å–æ¶ˆ'</span>;
        <span class="hljs-keyword">this</span>.containerElement.appendChild(<span class="hljs-keyword">this</span>.cancelButton);

        <span class="hljs-comment">// åˆå§‹åŒ–æ—¶ï¼Œæ˜¾ç¤ºæ–‡æœ¬ï¼Œéšè—è¾“å…¥æ¡†å’ŒæŒ‰é’®</span>
        <span class="hljs-keyword">this</span>.convertToText(); <span class="hljs-comment">// åˆ‡æ¢åˆ°æ–‡æœ¬æ˜¾ç¤ºçŠ¶æ€</span>
    },
</code></pre>
<h3 data-id="heading-4"><code>createElement</code> æ–¹æ³•è¯¦è§£</h3>
<ul>
<li>
<p>æ‰€æœ‰ DOM å…ƒç´ éƒ½åœ¨å†…å­˜ä¸­åˆ›å»ºï¼ˆä¸ä¼šé—ªå±ï¼‰ã€‚</p>
</li>
<li>
<p>ç»“æ„å¦‚ä¸‹ï¼ˆé€»è¾‘ä¸Šï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;div <span class="hljs-attr">id</span>=<span class="hljs-string">"xxx"</span>&gt;
  &lt;span&gt;åˆå§‹æ–‡æœ¬&lt;/span&gt;
  &lt;input <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> value=<span class="hljs-string">"åˆå§‹æ–‡æœ¬"</span> style=<span class="hljs-string">"display:none"</span>&gt;
  &lt;input <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> value=<span class="hljs-string">"ä¿å­˜"</span> style=<span class="hljs-string">"display:none"</span>&gt;
  &lt;input <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> value=<span class="hljs-string">"å–æ¶ˆ"</span> style=<span class="hljs-string">"display:none"</span>&gt;
&lt;/div&gt;
</code></pre>
</li>
<li>
<p>æœ€åè°ƒç”¨ <code>convertToText()</code>ï¼Œç¡®ä¿ä¸€å¼€å§‹åªæ˜¾ç¤º <code>&lt;span&gt;</code>ï¼Œå…¶ä»–éƒ½éšè—ã€‚</p>
</li>
</ul>
<hr/>
<pre><code class="hljs language-kotlin" lang="kotlin">    convertToText: function() {
        <span class="hljs-comment">// éšè—ç¼–è¾‘ç›¸å…³å…ƒç´ </span>
        <span class="hljs-keyword">this</span>.fieldElement.style.display = <span class="hljs-string">'none'</span>;   <span class="hljs-comment">// éšè—è¾“å…¥æ¡†</span>
        <span class="hljs-keyword">this</span>.saveButton.style.display = <span class="hljs-string">'none'</span>;     <span class="hljs-comment">// éšè—ä¿å­˜æŒ‰é’®</span>
        <span class="hljs-keyword">this</span>.cancelButton.style.display = <span class="hljs-string">'none'</span>;   <span class="hljs-comment">// éšè—å–æ¶ˆæŒ‰é’®</span>
        
        <span class="hljs-comment">// æ˜¾ç¤ºé™æ€æ–‡æœ¬</span>
        <span class="hljs-keyword">this</span>.staticElement.style.display = <span class="hljs-string">'inline'</span>; <span class="hljs-comment">// æ˜¾ç¤º span</span>
    },

    convertToField: function() {
        <span class="hljs-comment">// éšè—é™æ€æ–‡æœ¬</span>
        <span class="hljs-keyword">this</span>.staticElement.style.display = <span class="hljs-string">'none'</span>;
        
        <span class="hljs-comment">// è®¾ç½®è¾“å…¥æ¡†çš„å€¼ï¼ˆé˜²æ­¢ç”¨æˆ·å¤šæ¬¡ç‚¹å‡»å¯¼è‡´æ—§å€¼æ®‹ç•™ï¼‰</span>
        <span class="hljs-keyword">this</span>.fieldElement.value = <span class="hljs-keyword">this</span>.value;
        
        <span class="hljs-comment">// æ˜¾ç¤ºç¼–è¾‘ç›¸å…³å…ƒç´ </span>
        <span class="hljs-keyword">this</span>.fieldElement.style.display = <span class="hljs-string">'inline'</span>;
        <span class="hljs-keyword">this</span>.saveButton.style.display = <span class="hljs-string">'inline'</span>;
        <span class="hljs-keyword">this</span>.cancelButton.style.display = <span class="hljs-string">'inline'</span>;
    },
</code></pre>
<h3 data-id="heading-5">çŠ¶æ€åˆ‡æ¢æœºåˆ¶</h3>
<ul>
<li>
<p><strong>ä¸¤ç§çŠ¶æ€</strong>ï¼š</p>
<ul>
<li><strong>æ–‡æœ¬çŠ¶æ€</strong>ï¼ˆåªçœ‹ä¸æ”¹ï¼‰â†’ è°ƒç”¨ <code>convertToText</code></li>
<li><strong>ç¼–è¾‘çŠ¶æ€</strong>ï¼ˆå¯è¾“å…¥ï¼‰â†’ è°ƒç”¨ <code>convertToField</code></li>
</ul>
</li>
<li>
<p>é€šè¿‡ <code>style.display</code> æ§åˆ¶å…ƒç´ æ˜¾éšï¼Œè¿™æ˜¯æœ€ç®€å•çš„ UI çŠ¶æ€ç®¡ç†æ–¹å¼ã€‚</p>
</li>
<li>
<p>æ³¨æ„ï¼š<code>convertToField</code> ä¸­é‡æ–°èµ‹å€¼ <code>this.fieldElement.value = this.value</code> æ˜¯ä¸ºäº†é˜²æ­¢ç”¨æˆ·å–æ¶ˆåå†æ¬¡è¿›å…¥æ—¶çœ‹åˆ°é”™è¯¯å†…å®¹ã€‚</p>
</li>
</ul>
<hr/>
<pre><code class="hljs language-kotlin" lang="kotlin">    attachEvent: function() {
        <span class="hljs-comment">// ç‚¹å‡»é™æ€æ–‡æœ¬ â†’ è¿›å…¥ç¼–è¾‘æ¨¡å¼</span>
        <span class="hljs-keyword">this</span>.staticElement.addEventListener(<span class="hljs-string">'click'</span>, () =&gt; {
            <span class="hljs-keyword">this</span>.convertToField(); <span class="hljs-comment">// åˆ‡æ¢åˆ°è¾“å…¥æ¡†æ˜¾ç¤ºçŠ¶æ€</span>
        });

        <span class="hljs-comment">// ç‚¹å‡»â€œä¿å­˜â€æŒ‰é’® â†’ ä¿å­˜æ•°æ®</span>
        <span class="hljs-keyword">this</span>.saveButton.addEventListener(<span class="hljs-string">'click'</span>, () =&gt; {
            <span class="hljs-keyword">this</span>.save();
        });

        <span class="hljs-comment">// ç‚¹å‡»â€œå–æ¶ˆâ€æŒ‰é’® â†’ æ”¾å¼ƒä¿®æ”¹</span>
        <span class="hljs-keyword">this</span>.cancelButton.addEventListener(<span class="hljs-string">'click'</span>, () =&gt; {
            <span class="hljs-keyword">this</span>.cancel();
        });
    },
</code></pre>
<h3 data-id="heading-6">äº‹ä»¶ç»‘å®š</h3>
<ul>
<li>
<p>ä½¿ç”¨ <strong>ç®­å¤´å‡½æ•°</strong> <code>() =&gt; {}</code> æ˜¯ä¸ºäº† <strong>ä¿æŒ <code>this</code> æŒ‡å‘å½“å‰å®ä¾‹</strong>ã€‚</p>
<ul>
<li>å¦‚æœç”¨æ™®é€šå‡½æ•° <code>function() {}</code>ï¼Œ<code>this</code> ä¼šæŒ‡å‘è§¦å‘äº‹ä»¶çš„ DOM å…ƒç´ ï¼Œå¯¼è‡´é”™è¯¯ï¼</li>
</ul>
</li>
<li>
<p>ä¸‰ä¸ªäº‹ä»¶åˆ†åˆ«å¯¹åº”ä¸‰ç§ç”¨æˆ·è¡Œä¸ºï¼š</p>
<ul>
<li>ç‚¹æ–‡æœ¬ â†’ ç¼–è¾‘</li>
<li>ç‚¹ä¿å­˜ â†’ å­˜æ–°å€¼</li>
<li>ç‚¹å–æ¶ˆ â†’ æ¢å¤åŸçŠ¶</li>
</ul>
</li>
</ul>
<hr/>
<pre><code class="hljs language-kotlin" lang="kotlin">    save: function() {
        <span class="hljs-comment">// è·å–ç”¨æˆ·è¾“å…¥çš„æ–°å€¼</span>
        <span class="hljs-keyword">var</span> value = <span class="hljs-keyword">this</span>.fieldElement.value;
        
        <span class="hljs-comment">// ã€é‡è¦ã€‘è¿™é‡Œå¯ä»¥åŠ  fetch å‘é€åˆ°åç«¯ï¼ˆé¢˜ç›®æåˆ°ä½†æœªå®ç°ï¼‰</span>
        <span class="hljs-comment">// fetch('/api/update', { method: 'POST', body: JSON.stringify({id: this.id, value}) });</span>
        
        <span class="hljs-comment">// æ›´æ–°å†…éƒ¨çŠ¶æ€</span>
        <span class="hljs-keyword">this</span>.value = value;
        <span class="hljs-comment">// åŒæ­¥æ›´æ–°é™æ€æ–‡æœ¬å†…å®¹</span>
        <span class="hljs-keyword">this</span>.staticElement.innerHTML = value;
        <span class="hljs-comment">// åˆ‡å›æ–‡æœ¬æ˜¾ç¤ºçŠ¶æ€</span>
        <span class="hljs-keyword">this</span>.convertToText();
    },

    cancel: function() {
        <span class="hljs-comment">// ç›´æ¥åˆ‡å›æ–‡æœ¬çŠ¶æ€ï¼Œä¸ä¿å­˜ä»»ä½•æ›´æ”¹</span>
        <span class="hljs-keyword">this</span>.convertToText();
    }
};
</code></pre>
<h3 data-id="heading-7">ä¿å­˜ä¸å–æ¶ˆé€»è¾‘</h3>
<ul>
<li>
<p><code>save()</code>ï¼š</p>
<ul>
<li>è¯»å–è¾“å…¥æ¡†çš„å€¼ï¼›</li>
<li>æ›´æ–°å®ä¾‹çš„ <code>this.value</code>ï¼ˆè¿™æ˜¯â€œçœŸå®æ•°æ®æºâ€ï¼‰ï¼›</li>
<li>åŒæ­¥æ›´æ–° <code>&lt;span&gt;</code> çš„æ˜¾ç¤ºå†…å®¹ï¼›</li>
<li>åˆ‡å›åªè¯»çŠ¶æ€ã€‚</li>
</ul>
</li>
<li>
<p><code>cancel()</code>ï¼š</p>
<ul>
<li>ä¸åšä»»ä½•æ•°æ®ä¿®æ”¹ï¼Œç›´æ¥éšè—è¾“å…¥æ¡†ï¼Œæ¢å¤åŸæ ·ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-8">å››ã€å¦‚ä½•ä½¿ç”¨è¿™ä¸ªç±»ï¼Ÿï¼ˆå®æˆ˜æ¼”ç¤ºï¼‰</h2>
<p>æˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ªå®Œæ•´çš„ HTML é¡µé¢æ¥åŠ è½½å¹¶ä½¿ç”¨ <code>EditInPlace</code> ç±»ã€‚ä¸‹é¢è¿™ä¸ªç¤ºä¾‹å°±æ˜¯æœ€æ ‡å‡†çš„ç”¨æ³•â€”â€”å®ƒå±•ç¤ºäº†å¦‚ä½•åœ¨çœŸå®ç½‘é¡µä¸­â€œå®ä¾‹åŒ–â€ä¸€ä¸ªå°±åœ°ç¼–è¾‘ç»„ä»¶ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- 
    è¿™æ˜¯ä¸€ä¸ªç©ºçš„ div å®¹å™¨ï¼Œid ä¸º "app"ã€‚
    å®ƒçš„ä½œç”¨æ˜¯ä½œä¸º EditInPlace ç»„ä»¶çš„â€œæŒ‚è½½ç‚¹â€â€”â€”
    æ‰€æœ‰åŠ¨æ€ç”Ÿæˆçš„ç¼–è¾‘åŒºåŸŸï¼ˆæ–‡æœ¬ã€è¾“å…¥æ¡†ã€æŒ‰é’®ï¼‰éƒ½ä¼šè¢«æ’å…¥åˆ°è¿™ä¸ª div å†…éƒ¨ã€‚
  --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- 
    å¼•å…¥æˆ‘ä»¬ç¼–å†™çš„ EditInPlace ç±»å®šä¹‰æ–‡ä»¶ã€‚
    æµè§ˆå™¨ä¼šå…ˆåŠ è½½å¹¶è§£æè¿™ä¸ª JS æ–‡ä»¶ï¼Œä½¿ EditInPlace æ„é€ å‡½æ•°åœ¨å…¨å±€å¯ç”¨ã€‚
  --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./edit_in_place.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

  <span class="hljs-comment">&lt;!-- 
    ä¸‹é¢çš„ &lt;script&gt; æ ‡ç­¾ç”¨äºæ‰§è¡Œå®é™…çš„ä¸šåŠ¡é€»è¾‘ï¼š
    åˆ›å»ºä¸€ä¸ª EditInPlace å®ä¾‹ï¼Œå¹¶å°†å…¶æŒ‚è½½åˆ° #app å®¹å™¨ä¸­ã€‚
  --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-comment">// æ³¨é‡Šè¯´æ˜ï¼šè¿™é‡Œæ­£åœ¨ä½¿ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªå¯ç¼–è¾‘ç»„ä»¶å®ä¾‹</span>

  <span class="hljs-comment">// è°ƒç”¨æ„é€ å‡½æ•° new EditInPlace(...)ï¼Œä¼ å…¥ä¸‰ä¸ªå¿…è¦å‚æ•°ï¼š</span>
  <span class="hljs-keyword">const</span> ep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EditInPlace</span>(
    <span class="hljs-string">'slogan'</span>,                     <span class="hljs-comment">// å‚æ•°1: id â€”â€” ç”¨äºç»™ç”Ÿæˆçš„å®¹å™¨ div è®¾ç½®å”¯ä¸€ IDï¼ˆå¦‚ &lt;div id="slogan"&gt;ï¼‰</span>
    <span class="hljs-string">'æœ‰äº†è‚¯å¾·åŸºï¼Œç”Ÿæ´»å¥½æ»‹å‘³'</span>,   <span class="hljs-comment">// å‚æ•°2: value â€”â€” åˆå§‹æ˜¾ç¤ºçš„æ–‡æœ¬å†…å®¹</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'app'</span>) <span class="hljs-comment">// å‚æ•°3: parentElement â€”â€” æŒ‡å®šè¦æŠŠç¼–è¾‘å™¨æŒ‚è½½åˆ°å“ªä¸ª DOM å…ƒç´ å†…ï¼ˆè¿™é‡Œæ˜¯ id="app" çš„ divï¼‰</span>
  );

  <span class="hljs-comment">// åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰“å°å‡ºåˆšåˆ›å»ºçš„å®ä¾‹ ep</span>
  <span class="hljs-comment">// ä½ å¯ä»¥æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰ï¼Œåœ¨ Console é¢æ¿çœ‹åˆ°è¿™ä¸ªå¯¹è±¡</span>
  <span class="hljs-comment">// å®ƒåŒ…å«æ‰€æœ‰å±æ€§ï¼ˆid, value, containerElement...ï¼‰å’Œæ–¹æ³•ï¼ˆsave, cancel, createElement...ï¼‰</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ep);
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h3 data-id="heading-9">ä½¿ç”¨æµç¨‹æ€»ç»“</h3>
<ol>
<li>
<p><strong>å‡†å¤‡å®¹å™¨</strong>ï¼šHTML ä¸­æä¾›ä¸€ä¸ªç©ºçš„ <code>&lt;div id="app"&gt;&lt;/div&gt;</code> ä½œä¸ºâ€œæ’æ§½â€ã€‚</p>
</li>
<li>
<p><strong>å¼•å…¥è„šæœ¬</strong>ï¼šé€šè¿‡ <code>&lt;script src="./edit_in_place.js"&gt;</code> åŠ è½½ç±»å®šä¹‰ã€‚</p>
</li>
<li>
<p><strong>åˆ›å»ºå®ä¾‹</strong>ï¼šè°ƒç”¨ <code>new EditInPlace(...)</code>ï¼Œä¼ å…¥ï¼š</p>
<ul>
<li>å”¯ä¸€ IDï¼ˆç”¨äºå†…éƒ¨ DOM æ ‡è¯†ï¼‰ï¼Œ</li>
<li>åˆå§‹æ–‡æœ¬ï¼Œ</li>
<li>æŒ‚è½½ç›®æ ‡ï¼ˆçˆ¶å…ƒç´ ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>è‡ªåŠ¨æ¸²æŸ“</strong>ï¼šæ„é€ å‡½æ•°å†…éƒ¨ä¼šè‡ªåŠ¨è°ƒç”¨ <code>createElement()</code> å’Œ <code>attachEvent()</code>ï¼Œå®Œæˆ DOM åˆ›å»ºä¸äº‹ä»¶ç»‘å®šã€‚</p>
</li>
<li>
<p><strong>è°ƒè¯•è¾…åŠ©</strong>ï¼š<code>console.log(ep)</code> è®©ä½ å¯ä»¥åœ¨æ§åˆ¶å°æŸ¥çœ‹æ•´ä¸ªå¯¹è±¡ç»“æ„ï¼ŒéªŒè¯æ˜¯å¦åˆ›å»ºæˆåŠŸã€‚</p>
</li>
</ol>
<h3 data-id="heading-10">æ•ˆæœé¢„è§ˆ</h3>
<p>å½“ä½ åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€è¿™ä¸ª HTML æ–‡ä»¶æ—¶ï¼Œä½ ä¼šçœ‹åˆ°ï¼š</p>
<ul>
<li>é¡µé¢ä¸Šæ˜¾ç¤ºä¸€è¡Œæ–‡å­—ï¼šâ€œæœ‰äº†è‚¯å¾·åŸºï¼Œç”Ÿæ´»å¥½æ»‹å‘³â€</li>
<li>ç‚¹å‡»è¿™è¡Œå­— â†’ å‡ºç°ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œé‡Œé¢æ˜¯åŒæ ·çš„æ–‡å­—ï¼Œæ—è¾¹æœ‰â€œä¿å­˜â€å’Œâ€œå–æ¶ˆâ€æŒ‰é’®</li>
<li>ä¿®æ”¹æ–‡å­—åç‚¹å‡»â€œä¿å­˜â€ â†’ æ–‡å­—æ›´æ–°ï¼›ç‚¹å‡»â€œå–æ¶ˆâ€ â†’ æ¢å¤åŸæ ·</li>
</ul>
<hr/>
<h2 data-id="heading-11">äº”ã€æœ¬ä¾‹ä¸­ä½¿ç”¨çš„æ‰€æœ‰ DOM æ“ä½œæ–¹æ³•è¯¦è§£</h2>
<p>åœ¨ <code>EditInPlace</code> ç±»çš„å®ç°ä¸­ï¼Œæˆ‘ä»¬ç”¨åˆ°äº†å¤šä¸ªåŸç”Ÿ JavaScript çš„ DOMï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰æ“ä½œæ–¹æ³•ã€‚ä¸‹é¢å°†å®ƒä»¬é›†ä¸­æ•´ç†å¹¶é€ä¸ªè§£é‡Šï¼Œå¸®åŠ©æ–°æ‰‹å½»åº•ç†è§£è¿™äº› API çš„ä½œç”¨å’Œç”¨æ³•ã€‚</p>
<blockquote>
<p>ğŸ“Œ <strong>DOM æ˜¯ä»€ä¹ˆï¼Ÿ</strong><br/>
DOMï¼ˆDocument Object Modelï¼‰æ˜¯æµè§ˆå™¨å°† HTML æ–‡æ¡£è§£ææˆçš„ä¸€æ£µâ€œæ ‘â€ï¼Œæ¯ä¸ªæ ‡ç­¾éƒ½æ˜¯ä¸€ä¸ªâ€œèŠ‚ç‚¹â€ï¼ˆNodeï¼‰ã€‚JavaScript å¯ä»¥é€šè¿‡ DOM API å¢åˆ æ”¹æŸ¥è¿™äº›èŠ‚ç‚¹ï¼Œä»è€ŒåŠ¨æ€æ§åˆ¶ç½‘é¡µå†…å®¹ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-12">5.1 <code>document.createElement(tagName)</code></h3>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">div</span> = document.createElement(<span class="hljs-string">'div'</span>)<span class="hljs-comment">;</span>
</code></pre>
<ul>
<li><strong>ä½œç”¨</strong>ï¼šåœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ HTML å…ƒç´ èŠ‚ç‚¹ï¼ˆä¸æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼‰ã€‚</li>
<li><strong>å‚æ•°</strong>ï¼š<code>tagName</code> æ˜¯æ ‡ç­¾åï¼Œå¦‚ <code>'div'</code>ã€<code>'span'</code>ã€<code>'input'</code>ã€‚</li>
<li><strong>è¿”å›å€¼</strong>ï¼šä¸€ä¸ª HTMLElement å¯¹è±¡ï¼ˆå¦‚ HTMLDivElementï¼‰ã€‚</li>
<li><strong>æ³¨æ„</strong>ï¼šæ­¤æ—¶å…ƒç´ å°šæœªæŒ‚è½½åˆ°é¡µé¢ï¼Œéœ€åç»­ç”¨ <code>appendChild</code> æ·»åŠ ã€‚</li>
</ul>
<p><strong>ç”¨é€”</strong>ï¼šæ„å»ºç»„ä»¶çš„å†…éƒ¨ç»“æ„ï¼ˆå®¹å™¨ã€è¾“å…¥æ¡†ã€æŒ‰é’®ç­‰ï¼‰ã€‚</p>
<hr/>
<h3 data-id="heading-13">5.2 <code>element.appendChild(childElement)</code></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">this</span>.containerElement.appendChild(<span class="hljs-keyword">this</span>.staticElement);
</code></pre>
<ul>
<li><strong>ä½œç”¨</strong>ï¼šå°†ä¸€ä¸ªå­èŠ‚ç‚¹æ·»åŠ åˆ°çˆ¶èŠ‚ç‚¹çš„æœ«å°¾ã€‚</li>
<li><strong>å‚æ•°</strong>ï¼š<code>childElement</code> æ˜¯é€šè¿‡ <code>createElement</code> åˆ›å»ºçš„å…ƒç´ ã€‚</li>
<li><strong>æ•ˆæœ</strong>ï¼šå…ƒç´ è¢«æ’å…¥åˆ°çœŸå® DOM æ ‘ä¸­ï¼Œç”¨æˆ·å¯è§ã€‚</li>
</ul>
<p>âœ… <strong>ç”¨é€”</strong>ï¼šç»„è£…ç»„ä»¶ç»“æ„ï¼Œæœ€ç»ˆå°†æ•´ä¸ªç¼–è¾‘å™¨æŒ‚è½½åˆ°é¡µé¢ã€‚</p>
<hr/>
<h3 data-id="heading-14">5.3 <code>element.innerHTML</code></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">this</span>.staticElement.innerHTML = <span class="hljs-keyword">this</span>.value;
</code></pre>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼šè®¾ç½®æˆ–è·å–å…ƒç´ å†…éƒ¨çš„ HTML å†…å®¹ã€‚</p>
</li>
<li>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>å¯è§£æ HTML æ ‡ç­¾ï¼ˆå¦‚ <code>&lt;b&gt;åŠ ç²—&lt;/b&gt;</code> ä¼šç”Ÿæ•ˆï¼‰ï¼›</li>
<li>è‹¥åªå¤„ç†çº¯æ–‡æœ¬ï¼Œå»ºè®®ä½¿ç”¨ <code>textContent</code>ï¼ˆæ›´å®‰å…¨ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>æœ¬ä¾‹ç”¨é€”</strong>ï¼šå°†å­—ç¬¦ä¸²ï¼ˆå¦‚â€œç‚¹å‡»æˆ‘ç¼–è¾‘â€ï¼‰æ˜¾ç¤ºåœ¨ <code>&lt;span&gt;</code> ä¸­ã€‚</p>
</li>
</ul>
<hr/>
<h3 data-id="heading-15">5.4 <code>element.style.display</code></h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">this.fieldElement.style.display</span> = <span class="hljs-string">'none'</span><span class="hljs-comment">;</span>
<span class="hljs-attr">this.staticElement.style.display</span> = <span class="hljs-string">'inline'</span><span class="hljs-comment">;</span>
</code></pre>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼šæ§åˆ¶å…ƒç´ çš„æ˜¾ç¤ºä¸éšè—ã€‚</p>
</li>
<li>
<p><strong>å¸¸ç”¨å€¼</strong>ï¼š</p>
<ul>
<li><code>'none'</code>ï¼šå®Œå…¨éšè—ï¼Œä¸å ç©ºé—´ï¼›</li>
<li><code>'block'</code>ï¼šå—çº§æ˜¾ç¤ºï¼ˆå¦‚ divï¼‰ï¼›</li>
<li><code>'inline'</code>ï¼šè¡Œå†…æ˜¾ç¤ºï¼ˆå¦‚ spanã€inputï¼‰ï¼›</li>
<li><code>'inline-block'</code>ï¼šè¡Œå†…å—ï¼ˆå…¼é¡¾å®½é«˜å’ŒåŒè¡Œæ’åˆ—ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>æœ¬ä¾‹ç”¨é€”</strong>ï¼šåœ¨â€œæ–‡æœ¬çŠ¶æ€â€å’Œâ€œç¼–è¾‘çŠ¶æ€â€ä¹‹é—´åˆ‡æ¢ UIã€‚</p>
</li>
</ul>
<p>âœ… <strong>ä¼˜åŠ¿</strong>ï¼šç®€å•ç›´æ¥ï¼Œé€‚åˆå°å‹äº¤äº’ã€‚</p>
<hr/>
<h3 data-id="heading-16">5.5 <code>element.addEventListener(eventType, handler)</code></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">this</span>.staticElement.addEventListener(<span class="hljs-string">'click'</span>, () =&gt; {
    <span class="hljs-keyword">this</span>.convertToField();
});
</code></pre>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼šä¸ºå…ƒç´ ç»‘å®šäº‹ä»¶ç›‘å¬å™¨ã€‚</p>
</li>
<li>
<p><strong>å‚æ•°</strong>ï¼š</p>
<ul>
<li><code>eventType</code>ï¼šäº‹ä»¶ç±»å‹ï¼Œå¦‚ <code>'click'</code>ã€<code>'input'</code>ã€<code>'keydown'</code>ï¼›</li>
<li><code>handler</code>ï¼šå›è°ƒå‡½æ•°ï¼Œäº‹ä»¶è§¦å‘æ—¶æ‰§è¡Œã€‚</li>
</ul>
</li>
<li>
<p><strong>æœ¬ä¾‹ç”¨é€”</strong>ï¼š</p>
<ul>
<li>ç‚¹å‡»æ–‡æœ¬ â†’ è¿›å…¥ç¼–è¾‘ï¼›</li>
<li>ç‚¹å‡»æŒ‰é’® â†’ ä¿å­˜æˆ–å–æ¶ˆã€‚</li>
</ul>
</li>
</ul>
<p>ğŸ’¡ <strong>å…³é”®æŠ€å·§</strong>ï¼šä½¿ç”¨ç®­å¤´å‡½æ•° <code>() =&gt; {}</code> å¯ç¡®ä¿ <code>this</code> æŒ‡å‘ <code>EditInPlace</code> å®ä¾‹ï¼Œè€Œéè§¦å‘äº‹ä»¶çš„ DOM å…ƒç´ ã€‚</p>
<hr/>
<h3 data-id="heading-17">5.6 <code>element.id = id</code></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">this</span>.containerElement.id = <span class="hljs-keyword">this</span>.id;
</code></pre>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼šè®¾ç½®å…ƒç´ çš„ <code>id</code> å±æ€§ã€‚</p>
</li>
<li>
<p><strong>ç”¨é€”</strong>ï¼š</p>
<ul>
<li>æ–¹ä¾¿ CSS æ ·å¼å®šä½ï¼›</li>
<li>ä¾¿äºè°ƒè¯•ï¼ˆåœ¨å¼€å‘è€…å·¥å…·ä¸­å¿«é€ŸæŸ¥æ‰¾ï¼‰ï¼›</li>
<li>ç¡®ä¿å¤šä¸ªå®ä¾‹ ID ä¸å†²çªï¼ˆç”±ç”¨æˆ·ä¼ å…¥å”¯ä¸€ IDï¼‰ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-18">5.7 <code>input.value</code></h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">this</span>.fieldElement.value = <span class="hljs-keyword">this</span>.value;
<span class="hljs-keyword">var</span> value = <span class="hljs-keyword">this</span>.fieldElement.value;
</code></pre>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼šè·å–æˆ–è®¾ç½® <code>&lt;input&gt;</code> æˆ– <code>&lt;textarea&gt;</code> çš„å½“å‰å€¼ã€‚</p>
</li>
<li>
<p><strong>æ³¨æ„</strong>ï¼šè¿™æ˜¯<strong>å±æ€§ï¼ˆpropertyï¼‰</strong> ï¼Œä¸æ˜¯ <code>getAttribute('value')</code>ï¼ˆé‚£æ˜¯åˆå§‹å€¼ï¼‰ã€‚</p>
</li>
<li>
<p><strong>æœ¬ä¾‹ç”¨é€”</strong>ï¼š</p>
<ul>
<li>åˆå§‹åŒ–è¾“å…¥æ¡†å†…å®¹ï¼›</li>
<li>è¯»å–ç”¨æˆ·ä¿®æ”¹åçš„æ–°å€¼ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-19">DOM æ“ä½œå…¨æ™¯å›¾</h3>













































<table><thead><tr><th>æ–¹æ³• / å±æ€§</th><th>ç”¨é€”</th><th>æ˜¯å¦æ”¹å˜é¡µé¢</th></tr></thead><tbody><tr><td><code>createElement</code></td><td>åˆ›å»ºå…ƒç´ ï¼ˆå†…å­˜ä¸­ï¼‰</td><td>âŒ</td></tr><tr><td><code>appendChild</code></td><td>æ’å…¥å…ƒç´ åˆ°é¡µé¢</td><td>âœ…</td></tr><tr><td><code>innerHTML</code></td><td>è®¾ç½®å…ƒç´ å†…å®¹</td><td>âœ…</td></tr><tr><td><code>style.display</code></td><td>æ§åˆ¶æ˜¾éš</td><td>âœ…</td></tr><tr><td><code>addEventListener</code></td><td>ç»‘å®šäº¤äº’è¡Œä¸º</td><td>â€”ï¼ˆå“åº”å¼ï¼‰</td></tr><tr><td><code>element.id</code></td><td>è®¾ç½®å”¯ä¸€æ ‡è¯†</td><td>âœ…</td></tr><tr><td><code>input.value</code></td><td>è¯»å†™è¾“å…¥å€¼</td><td>â€”ï¼ˆæ•°æ®å±‚ï¼‰</td></tr></tbody></table>
<p>æŒæ¡è¿™äº›åŸºç¡€ DOM APIï¼Œä½ å°±å…·å¤‡äº†<strong>ç”¨åŸç”Ÿ JavaScript æ„å»ºåŠ¨æ€äº¤äº’ç»„ä»¶çš„èƒ½åŠ›</strong>ï¼Œæ— éœ€ä¾èµ–ä»»ä½•æ¡†æ¶ï¼</p>
<hr/>
<h2 data-id="heading-20">å…­ã€å¸¸è§é—®é¢˜è§£ç­”</h2>
<h3 data-id="heading-21">Q1ï¼šä¸ºä»€ä¹ˆä¸ç”¨ <code>class</code> è¯­æ³•ï¼Ÿ</h3>
<p>Aï¼šè¿™é“é¢˜è€ƒå¯Ÿçš„æ˜¯ <strong>åŸå‹é“¾å’Œæ„é€ å‡½æ•°</strong> çš„ç†è§£ã€‚ES6 çš„ <code>class</code> æœ¬è´¨ä»æ˜¯åŸºäºåŸå‹çš„è¯­æ³•ç³–ã€‚æŒæ¡åº•å±‚æœºåˆ¶æ›´é‡è¦ã€‚</p>
<h3 data-id="heading-22">Q2ï¼š<code>this</code> ä¸ºä»€ä¹ˆä¼šæŒ‡å‘å®ä¾‹ï¼Ÿ</h3>
<p>Aï¼šå› ä¸ºç”¨äº† <code>new</code> å…³é”®å­—ã€‚<code>new</code> ä¼šè‡ªåŠ¨åˆ›å»ºå¯¹è±¡å¹¶ç»‘å®š <code>this</code>ã€‚</p>
<h3 data-id="heading-23">Q3ï¼šèƒ½ä¸èƒ½å¤šä¸ªç¼–è¾‘å™¨å…±å­˜ï¼Ÿ</h3>
<p>Aï¼šå®Œå…¨å¯ä»¥ï¼æ¯ä¸ªå®ä¾‹éƒ½æœ‰è‡ªå·±çš„ <code>id</code>ã€<code>value</code> å’Œ DOM å…ƒç´ ï¼Œå½¼æ­¤éš”ç¦»ã€‚</p>
<h3 data-id="heading-24">Q4ï¼šå¦‚ä½•æ”¯æŒå¤šè¡Œæ–‡æœ¬ï¼Ÿ</h3>
<p>Aï¼šæŠŠ <code>input</code> æ¢æˆ <code>textarea</code>ï¼Œå¹¶è°ƒæ•´æ ·å¼å³å¯ã€‚è¿™æ˜¯å¾ˆå¥½çš„æ‰©å±•ç»ƒä¹ ï¼</p>
<hr/>
<h2 data-id="heading-25">ä¸ºä»€ä¹ˆè¿™æ˜¯ OOP çš„å…¸èŒƒï¼Ÿ</h2>

































<table><thead><tr><th>å…³é”®è¯</th><th>æœ¬ä¾‹ä½“ç°</th></tr></thead><tbody><tr><td><strong>å°è£…</strong></td><td>æ‰€æœ‰é€»è¾‘è—åœ¨ç±»å†…éƒ¨ï¼Œå¤–éƒ¨åªéœ€ <code>new EditInPlace(...)</code> å³å¯ä½¿ç”¨</td></tr><tr><td><strong>å¤ç”¨</strong></td><td>å¯åœ¨å¤šä¸ªåœ°æ–¹åˆ›å»ºå¤šä¸ªå®ä¾‹ï¼Œäº’ä¸å½±å“</td></tr><tr><td><strong>æ¨¡å—åŒ–</strong></td><td>æ•´ä¸ªç±»åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œç‹¬ç«‹ã€å¯ç§»æ¤</td></tr><tr><td><strong>éšè—å®ç°ç»†èŠ‚</strong></td><td>ç”¨æˆ·ä¸éœ€è¦çŸ¥é“ DOM å¦‚ä½•æ“ä½œï¼Œåªéœ€è°ƒç”¨å³å¯</td></tr><tr><td><strong>ç¼–å†™æ³¨é‡Š</strong></td><td>å‡½æ•°å¼€å¤´æœ‰ JSDoc æ³¨é‡Šï¼Œè¯´æ˜å‚æ•°å’Œç”¨é€”</td></tr><tr><td><strong>æ‹¿æ¥å°±ç”¨</strong></td><td>ç±»çš„ä½¿ç”¨è€…å’Œç¼–å†™è€…å¯ä»¥æ˜¯ä¸åŒäºº</td></tr></tbody></table>
<blockquote>
<p>Â <strong>OOP æ ¸å¿ƒæ€æƒ³</strong>ï¼šæŠŠâ€œæ•°æ®â€å’Œâ€œæ“ä½œæ•°æ®çš„æ–¹æ³•â€æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡ã€‚</p>
</blockquote>
<hr/>
<p>å½“ç„¶å¯ä»¥ï¼ä»¥ä¸‹æ˜¯ä¸ºä½ çš„åšå®¢æ–‡ç« é‡èº«æ‰“é€ çš„ä¸€æ®µ<strong>ç”ŸåŠ¨æœ‰è¶£ã€é¼“èˆäººå¿ƒåˆå¸¦ç‚¹å¹½é»˜æ„Ÿ</strong>çš„ç»“è¯­ï¼Œæ—¢å‘¼åº”å…¨æ–‡ä¸»é¢˜ï¼Œåˆèƒ½è®©è¯»è€…ä¼šå¿ƒä¸€ç¬‘ã€å°è±¡æ·±åˆ»ï¼š</p>
<hr/>
<h2 data-id="heading-26">ç»“è¯­ï¼šä½ å†™çš„ä¸æ˜¯ä»£ç ï¼Œæ˜¯â€œé­”æ³•ç›’å­â€</h2>
<p>æ­å–œä½ ï¼<br/>
èµ°åˆ°è¿™é‡Œï¼Œä½ å·²ç»äº²æ‰‹æ‰“é€ äº†ä¸€ä¸ªä¼šâ€œå˜èº«â€çš„å°ç²¾çµâ€”â€”ç‚¹ä¸€ä¸‹å˜è¾“å…¥æ¡†ï¼Œå†ç‚¹ä¸€ä¸‹å˜å›æ–‡å­—ï¼Œè¿˜èƒ½è®°ä½ä½ è¯´è¿‡çš„è¯ã€‚å®ƒä¸é æ¡†æ¶ï¼Œä¸é é­”æ³•å’’è¯­ï¼Œåªé ä¸€è¡Œè¡Œæ¸…æ™°ã€å°è£…è‰¯å¥½çš„ JavaScript ä»£ç ã€‚</p>
<p>è¿™ï¼Œå°±æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„é­…åŠ›ï¼š<br/>
<strong>æŠŠå¤æ‚è—èµ·æ¥ï¼ŒæŠŠç®€å•äº¤å‡ºå»ã€‚</strong></p>
<p>æœªæ¥çš„ä½ ï¼Œå¯èƒ½ä¼šç”¨ React å†™ç»„ä»¶ï¼Œç”¨ Vue åšå“åº”å¼ï¼Œç”šè‡³è®© AI è‡ªåŠ¨ç”Ÿæˆä»£ç ã€‚ä½†è¯·æ°¸è¿œè®°å¾—ä»Šå¤©è¿™ä¸ªå°å°çš„ <code>EditInPlace</code>â€”â€”å®ƒæ•™ä¼šä½ çš„ä¸æ˜¯â€œæ€ä¹ˆå†™â€ï¼Œè€Œæ˜¯â€œ<strong>æ€ä¹ˆæƒ³</strong>â€ã€‚</p>
<p>å½“ä½ èƒ½åƒæ­ç§¯æœ¨ä¸€æ ·ï¼ŒæŠŠåŠŸèƒ½å°è£…æˆç‹¬ç«‹ã€å¯å¤ç”¨ã€æœ‰åå­—çš„â€œç›’å­â€ï¼Œä½ å°±ä¸å†æ˜¯ä»£ç æ¬è¿å·¥ï¼Œè€Œæ˜¯<strong>ç”¨æˆ·ä½“éªŒçš„å»ºç­‘å¸ˆ</strong>ã€<strong>äº¤äº’é€»è¾‘çš„å¯¼æ¼”</strong>ï¼Œç”šè‡³æ˜¯<strong>äº§å“çµé­‚çš„å¡‘é€ è€…</strong>ã€‚</p>
<p>ä¸–ç•Œæ­£ç­‰ç€è¢«ä½ â€œå°±åœ°ç¼–è¾‘â€å¾—æ›´ç¾å¥½ ğŸŒŸ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ©ç”¨requestIdleCallbackä¼˜åŒ–Domçš„æ›´æ–°æ€§èƒ½]]></title>    <link>https://juejin.cn/post/7579904059525431322</link>    <guid>https://juejin.cn/post/7579904059525431322</guid>    <pubDate>2025-12-05T02:49:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579904059525431322" data-draft-id="7579889969986093107" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ©ç”¨requestIdleCallbackä¼˜åŒ–Domçš„æ›´æ–°æ€§èƒ½"/> <meta itemprop="keywords" content="å‰ç«¯,TypeScript,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2025-12-05T02:49:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ—¶7"/> <meta itemprop="url" content="https://juejin.cn/user/3450681714038359"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ©ç”¨requestIdleCallbackä¼˜åŒ–Domçš„æ›´æ–°æ€§èƒ½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3450681714038359/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ—¶7
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T02:49:16.000Z" title="Fri Dec 05 2025 02:49:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><h2 data-id="heading-0">æ¦‚è¿°</h2>
<p>â€‹requestIdleCallbackâ€‹ æ˜¯ä¸€ä¸ªæµè§ˆå™¨ APIï¼Œå…è®¸åœ¨æµè§ˆå™¨ç©ºé—²æ—¶æ‰§è¡Œéå…³é”®ä»»åŠ¡ï¼Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚è¿™å¯¹äºæå‡ç”¨æˆ·ä½“éªŒå’Œæ€§èƒ½éå¸¸é‡è¦ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§é‡ DOM æ›´æ–°æ—¶ã€‚</p>
<h2 data-id="heading-1">å®ç°</h2>
<h3 data-id="heading-2">1. å·¥å…·å‡½æ•° (idleCallback.tsâ€‹)</h3>
<p>åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ requestIdleCallbackâ€‹ å·¥å…·åº“ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>â€‹requestIdleCallbackâ€‹: åœ¨æµè§ˆå™¨ç©ºé—²æ—¶æ‰§è¡Œå›è°ƒ</li>
<li>â€‹cancelIdleCallbackâ€‹: å–æ¶ˆä¹‹å‰è°ƒåº¦çš„å›è°ƒ</li>
<li>â€‹IdleTaskQueueâ€‹: æ‰¹é‡å¤„ç†ä»»åŠ¡çš„é˜Ÿåˆ—ç±»</li>
</ul>
<h4 data-id="heading-3">ç‰¹æ€§</h4>
<ul>
<li>âœ… è‡ªåŠ¨é™çº§: å¯¹äºä¸æ”¯æŒ requestIdleCallbackâ€‹ çš„æµè§ˆå™¨ï¼Œè‡ªåŠ¨é™çº§ä¸º setTimeoutâ€‹ + MessageChannelâ€‹</li>
<li>âœ… è¶…æ—¶ä¿æŠ¤: æ”¯æŒè¶…æ—¶é…ç½®ï¼Œç¡®ä¿ä»»åŠ¡æœ€ç»ˆä¼šè¢«æ‰§è¡Œ</li>
<li>âœ… æ‰¹é‡å¤„ç†: IdleTaskQueueâ€‹ å¯ä»¥åœ¨ç©ºé—²æ—¶é—´å†…æ‰¹é‡å¤„ç†å¤šä¸ªä»»åŠ¡</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * requestIdleCallback å·¥å…·å‡½æ•°
 * åœ¨æµè§ˆå™¨ç©ºé—²æ—¶æ‰§è¡Œå›è°ƒï¼Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹
 * æä¾›é™çº§æ–¹æ¡ˆä»¥æ”¯æŒä¸æ”¯æŒ requestIdleCallback çš„æµè§ˆå™¨
 */</span>

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">IdleCallbackOptions</span> {
  timeout?: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œå¦‚æœæŒ‡å®šï¼Œå›è°ƒä¼šåœ¨è¶…æ—¶åå¼ºåˆ¶æ‰§è¡Œ</span>
}

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">IdleDeadline</span> {
  <span class="hljs-attr">didTimeout</span>: <span class="hljs-built_in">boolean</span>; <span class="hljs-comment">// æ˜¯å¦å› ä¸ºè¶…æ—¶è€Œæ‰§è¡Œ</span>
  <span class="hljs-title function_">timeRemaining</span>(): <span class="hljs-built_in">number</span>; <span class="hljs-comment">// è¿”å›å½“å‰ç©ºé—²æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
}

<span class="hljs-keyword">type</span> <span class="hljs-title class_">IdleCallbackHandle</span> = <span class="hljs-built_in">number</span>;

<span class="hljs-comment">/**
 * åœ¨æµè§ˆå™¨ç©ºé—²æ—¶æ‰§è¡Œå›è°ƒ
 * <span class="hljs-doctag">@param</span> callback è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°
 * <span class="hljs-doctag">@param</span> options é…ç½®é€‰é¡¹
 * <span class="hljs-doctag">@returns</span> è¯·æ±‚ IDï¼Œå¯ç”¨äºå–æ¶ˆ
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> requestIdleCallback = (
  <span class="hljs-attr">callback</span>: <span class="hljs-function">(<span class="hljs-params">deadline: IdleDeadline</span>) =&gt;</span> <span class="hljs-built_in">void</span>,
  options?: <span class="hljs-title class_">IdleCallbackOptions</span>
): <span class="hljs-function"><span class="hljs-params">IdleCallbackHandle</span> =&gt;</span> {
  <span class="hljs-comment">// å¦‚æœæµè§ˆå™¨æ”¯æŒåŸç”Ÿ requestIdleCallbackï¼Œç›´æ¥ä½¿ç”¨</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span> !== <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-string">'requestIdleCallback'</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">window</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">requestIdleCallback</span>(callback, options);
  }

  <span class="hljs-comment">// é™çº§æ–¹æ¡ˆï¼šä½¿ç”¨ setTimeout æ¨¡æ‹Ÿ</span>
  <span class="hljs-comment">// ä½¿ç”¨ 1ms å»¶è¿Ÿï¼Œè®©æµè§ˆå™¨æœ‰æœºä¼šå¤„ç†å…¶ä»–ä»»åŠ¡</span>
  <span class="hljs-keyword">const</span> timeout = options?.<span class="hljs-property">timeout</span> ?? <span class="hljs-number">5000</span>; <span class="hljs-comment">// é»˜è®¤ 5 ç§’è¶…æ—¶</span>
  <span class="hljs-keyword">const</span> startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();

  <span class="hljs-keyword">const</span> timeoutId = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">callback</span>({
      <span class="hljs-attr">didTimeout</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">timeRemaining</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, <span class="hljs-number">50</span> - (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - startTime)),
    });
  }, timeout);

  <span class="hljs-comment">// ä½¿ç”¨ MessageChannel å®ç°æ›´æ¥è¿‘ requestIdleCallback çš„è¡Œä¸º</span>
  <span class="hljs-comment">// MessageChannel ä¼šåœ¨å½“å‰ä»»åŠ¡å®Œæˆåã€ä¸‹ä¸€ä¸ªä»»åŠ¡ä¹‹å‰æ‰§è¡Œ</span>
  <span class="hljs-keyword">const</span> channel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageChannel</span>();
  channel.<span class="hljs-property">port1</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-built_in">clearTimeout</span>(timeoutId);
    <span class="hljs-title function_">callback</span>({
      <span class="hljs-attr">didTimeout</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">timeRemaining</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, <span class="hljs-number">50</span> - (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - startTime)),
    });
  };
  channel.<span class="hljs-property">port2</span>.<span class="hljs-title function_">postMessage</span>(<span class="hljs-literal">null</span>);

  <span class="hljs-comment">// è¿”å›ä¸€ä¸ªå¯ä»¥ç”¨äºå–æ¶ˆçš„ ID</span>
  <span class="hljs-keyword">return</span> timeoutId <span class="hljs-keyword">as</span> <span class="hljs-built_in">unknown</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">IdleCallbackHandle</span>;
};

<span class="hljs-comment">/**
 * å–æ¶ˆä¹‹å‰é€šè¿‡ requestIdleCallback è°ƒåº¦çš„å›è°ƒ
 * <span class="hljs-doctag">@param</span> handle ä¹‹å‰è¿”å›çš„è¯·æ±‚ ID
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> cancelIdleCallback = (<span class="hljs-attr">handle</span>: <span class="hljs-title class_">IdleCallbackHandle</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">window</span> !== <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-string">'cancelIdleCallback'</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">window</span>) {
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">cancelIdleCallback</span>(handle);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// é™çº§æ–¹æ¡ˆï¼šæ¸…é™¤ setTimeout</span>
    <span class="hljs-built_in">clearTimeout</span>(handle <span class="hljs-keyword">as</span> <span class="hljs-built_in">unknown</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">number</span>);
  }
};

<span class="hljs-comment">/**
 * æ‰¹é‡æ‰§è¡Œä»»åŠ¡ï¼Œåœ¨ç©ºé—²æ—¶é€ä¸ªå¤„ç†
 * é€‚ç”¨äºéœ€è¦å¤„ç†å¤§é‡éå…³é”®ä»»åŠ¡çš„åœºæ™¯
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IdleTaskQueue</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">tasks</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>&gt; = [];
  <span class="hljs-keyword">private</span> isProcessing = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">currentHandle</span>: <span class="hljs-title class_">IdleCallbackHandle</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

  <span class="hljs-comment">/**
   * æ·»åŠ ä»»åŠ¡åˆ°é˜Ÿåˆ—
   */</span>
  <span class="hljs-title function_">add</span>(<span class="hljs-attr">task</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tasks</span>.<span class="hljs-title function_">push</span>(task);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">process</span>();
  }

  <span class="hljs-comment">/**
   * æ‰¹é‡æ·»åŠ ä»»åŠ¡
   */</span>
  <span class="hljs-title function_">addBatch</span>(<span class="hljs-attr">tasks</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>&gt;): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tasks</span>.<span class="hljs-title function_">push</span>(...tasks);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">process</span>();
  }

  <span class="hljs-comment">/**
   * å¤„ç†é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">process</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">tasks</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentHandle</span> = <span class="hljs-title function_">requestIdleCallback</span>(
      <span class="hljs-function">(<span class="hljs-params">deadline</span>) =&gt;</span> {
        <span class="hljs-comment">// åœ¨ç©ºé—²æ—¶é—´å†…å°½å¯èƒ½å¤šåœ°å¤„ç†ä»»åŠ¡</span>
        <span class="hljs-keyword">while</span> (deadline.<span class="hljs-title function_">timeRemaining</span>() &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">tasks</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">const</span> task = <span class="hljs-variable language_">this</span>.<span class="hljs-property">tasks</span>.<span class="hljs-title function_">shift</span>();
          <span class="hljs-keyword">if</span> (task) {
            <span class="hljs-keyword">try</span> {
              <span class="hljs-title function_">task</span>();
            } <span class="hljs-keyword">catch</span> (error) {
              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'IdleTaskQueue task error:'</span>, error);
            }
          }
        }

        <span class="hljs-comment">// å¦‚æœè¿˜æœ‰ä»»åŠ¡æœªå¤„ç†ï¼Œç»§ç»­è°ƒåº¦</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">tasks</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">process</span>();
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
        }
      },
      { <span class="hljs-attr">timeout</span>: <span class="hljs-number">5000</span> } <span class="hljs-comment">// 5 ç§’è¶…æ—¶ï¼Œç¡®ä¿ä»»åŠ¡æœ€ç»ˆä¼šè¢«æ‰§è¡Œ</span>
    );
  }

  <span class="hljs-comment">/**
   * æ¸…ç©ºé˜Ÿåˆ—
   */</span>
  <span class="hljs-title function_">clear</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tasks</span> = [];
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentHandle</span> !== <span class="hljs-literal">null</span>) {
      <span class="hljs-title function_">cancelIdleCallback</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentHandle</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentHandle</span> = <span class="hljs-literal">null</span>;
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
  }

  <span class="hljs-comment">/**
   * è·å–é˜Ÿåˆ—ä¸­å‰©ä½™ä»»åŠ¡æ•°
   */</span>
  <span class="hljs-keyword">get</span> <span class="hljs-title function_">length</span>(): <span class="hljs-built_in">number</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">tasks</span>.<span class="hljs-property">length</span>;
  }
}
</code></pre>
<h3 data-id="heading-4">2. DOM æ›´æ–°ä¼˜åŒ–</h3>
<p>ä¼˜åŒ–å‰:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä½¿ç”¨ setTimeout å»¶è¿Ÿæ›´æ–°</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">timmer</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">patch</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vNode</span>, vNode);
  <span class="hljs-comment">// ...</span>
}, <span class="hljs-variable constant_">DOM_UPDATE_DELAY_MS</span>);
</code></pre>
<p>ä¼˜åŒ–å:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä½¿ç”¨ requestIdleCallback åœ¨æµè§ˆå™¨ç©ºé—²æ—¶æ›´æ–°</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">idleCallbackHandle</span> = <span class="hljs-title function_">requestIdleCallback</span>(
  <span class="hljs-function">(<span class="hljs-params">deadline</span>) =&gt;</span> {
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„æ—¶é—´</span>
    <span class="hljs-keyword">if</span> (deadline.<span class="hljs-title function_">timeRemaining</span>() &lt; <span class="hljs-number">5</span> &amp;&amp; !deadline.<span class="hljs-property">didTimeout</span>) {
      <span class="hljs-comment">// é‡æ–°è°ƒåº¦åˆ°ä¸‹ä¸€ä¸ªç©ºé—²å‘¨æœŸ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">idleCallbackHandle</span> = <span class="hljs-title function_">requestIdleCallback</span>(<span class="hljs-comment">/* ... */</span>);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">performDomUpdate</span>(deadline);
  },
  { <span class="hljs-attr">timeout</span>: <span class="hljs-variable constant_">DOM_UPDATE_DELAY_MS</span> }
);
</code></pre>
<p>ä¼˜åŠ¿:</p>
<ul>
<li>ğŸš€ ä¸é˜»å¡ä¸»çº¿ç¨‹: DOM æ›´æ–°åœ¨æµè§ˆå™¨ç©ºé—²æ—¶æ‰§è¡Œ</li>
<li>ğŸ¯ æ™ºèƒ½è°ƒåº¦: å¦‚æœå½“å‰ç©ºé—²æ—¶é—´ä¸å¤Ÿï¼Œè‡ªåŠ¨å»¶è¿Ÿåˆ°ä¸‹ä¸€ä¸ªç©ºé—²å‘¨æœŸ</li>
<li>â±ï¸ è¶…æ—¶ä¿æŠ¤: å³ä½¿æµè§ˆå™¨ä¸€ç›´å¿™ç¢Œï¼Œä¹Ÿä¼šåœ¨è¶…æ—¶åæ‰§è¡Œ</li>
</ul>
<h3 data-id="heading-5">3. æ‰¹é‡æ›´æ–°ä¼˜åŒ–</h3>
<p>ä¼˜åŒ–å‰:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// åœºæ™¯ï¼šæ•°æ®å˜åŒ–æ—¶ï¼Œæ›´æ–°å¯¹åº”çš„domæ˜¾ç¤º</span>
handleHeartbeat = (<span class="hljs-attr">uploader</span>: <span class="hljs-title class_">FileUploader</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; uploader.<span class="hljs-property">uploadingTaskList</span>.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> taskItem = uploader.<span class="hljs-property">uploadingTaskList</span>[i];
    <span class="hljs-keyword">const</span> item = <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemsMap</span>.<span class="hljs-title function_">get</span>(taskItem.<span class="hljs-property">id</span>);
    <span class="hljs-keyword">if</span> (item) {
      item.<span class="hljs-title function_">updateDom</span>(taskItem); <span class="hljs-comment">// ç«‹å³æ‰§è¡Œ</span>
    }
  }
};
</code></pre>
<p>ä¼˜åŒ–å:</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ‰¹é‡æ”¶é›†æ›´æ–°ä»»åŠ¡ï¼Œåœ¨ç©ºé—²æ—¶æ‰§è¡Œ</span>
handleHeartbeat = (<span class="hljs-attr">uploader</span>: <span class="hljs-title class_">FileUploader</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">updateTasks</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>&gt; = [];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; uploader.<span class="hljs-property">uploadingTaskList</span>.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> taskItem = uploader.<span class="hljs-property">uploadingTaskList</span>[i];
    <span class="hljs-keyword">const</span> item = <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemsMap</span>.<span class="hljs-title function_">get</span>(taskItem.<span class="hljs-property">id</span>);
    <span class="hljs-keyword">if</span> (item) {
      updateTasks.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> {
        item.<span class="hljs-title function_">updateDom</span>(taskItem);
      });
    }
  }

  <span class="hljs-comment">// æ‰¹é‡æ·»åŠ åˆ°ç©ºé—²ä»»åŠ¡é˜Ÿåˆ—</span>
  <span class="hljs-keyword">if</span> (updateTasks.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">idleUpdateQueue</span>.<span class="hljs-title function_">addBatch</span>(updateTasks);
  }
};
</code></pre>
<p>ä¼˜åŠ¿:</p>
<ul>
<li>ğŸ“¦ æ‰¹é‡å¤„ç†: å¤šä¸ª DOM æ›´æ–°åœ¨åŒä¸€ä¸ªç©ºé—²å‘¨æœŸå†…æ‰¹é‡å¤„ç†</li>
<li>âš¡ å‡å°‘é‡æ’: å‡å°‘æµè§ˆå™¨é‡æ’/é‡ç»˜æ¬¡æ•°</li>
<li>ğŸ¯ ä¼˜å…ˆçº§ç®¡ç†: éå…³é”®æ›´æ–°ä¸ä¼šé˜»å¡å…³é”®æ“ä½œ</li>
</ul>
<h2 data-id="heading-6">ä½¿ç”¨åœºæ™¯</h2>
<h3 data-id="heading-7">é€‚åˆä½¿ç”¨ requestIdleCallbackâ€‹ çš„åœºæ™¯</h3>
<ol>
<li>
<p>âœ… DOM æ›´æ–°ï¼ˆéå…³é”®ï¼‰</p>
<ul>
<li>è¿›åº¦æ¡æ›´æ–°</li>
<li>çŠ¶æ€æ˜¾ç¤ºæ›´æ–°</li>
<li>ç»Ÿè®¡æ•°æ®å±•ç¤º</li>
</ul>
</li>
<li>
<p>âœ… æ•°æ®ç»Ÿè®¡/åˆ†æ</p>
<ul>
<li>ä¸Šä¼ é€Ÿåº¦è®¡ç®—</li>
<li>è¿›åº¦ç»Ÿè®¡</li>
<li>æ€§èƒ½æŒ‡æ ‡æ”¶é›†</li>
</ul>
</li>
<li>
<p>âœ… é¢„åŠ è½½/é¢„å–</p>
<ul>
<li>é¢„åŠ è½½ä¸‹ä¸€ä¸ªæ–‡ä»¶</li>
<li>é¢„è®¡ç®— MD5</li>
</ul>
</li>
</ol>
<h3 data-id="heading-8">ä¸é€‚åˆä½¿ç”¨ requestIdleCallbackâ€‹ çš„åœºæ™¯</h3>
<ol>
<li>
<p>âŒ ç”¨æˆ·äº¤äº’å“åº”</p>
<ul>
<li>ç‚¹å‡»äº‹ä»¶å¤„ç†</li>
<li>è¾“å…¥äº‹ä»¶å¤„ç†</li>
<li>å¿…é¡»ç«‹å³å“åº”çš„æ“ä½œ</li>
</ul>
</li>
<li>
<p>âŒ å…³é”®è·¯å¾„æ“ä½œ</p>
<ul>
<li>æ–‡ä»¶ä¸Šä¼ è¯·æ±‚</li>
<li>é”™è¯¯å¤„ç†</li>
<li>çŠ¶æ€å˜æ›´é€šçŸ¥</li>
</ul>
</li>
</ol>
<h2 data-id="heading-9">æ€§èƒ½æ”¶ç›Š</h2>
<h3 data-id="heading-10">é¢„æœŸæ”¹è¿›</h3>
<ol>
<li>ä¸»çº¿ç¨‹é˜»å¡å‡å°‘: DOM æ›´æ–°ä¸å†é˜»å¡ä¸»çº¿ç¨‹ï¼Œæå‡é¡µé¢å“åº”æ€§</li>
<li>å¸§ç‡æå‡: å‡å°‘ä¸å¿…è¦çš„é‡æ’/é‡ç»˜ï¼Œæå‡åŠ¨ç”»æµç•…åº¦</li>
<li>CPU ä½¿ç”¨ä¼˜åŒ–: åœ¨æµè§ˆå™¨ç©ºé—²æ—¶æ‰§è¡Œä»»åŠ¡ï¼Œæ›´å¥½åœ°åˆ©ç”¨ CPU èµ„æº</li>
<li>ç”¨æˆ·ä½“éªŒæå‡: é¡µé¢æ›´æµç•…ï¼Œäº¤äº’æ›´åŠæ—¶</li>
</ol>
<h3 data-id="heading-11">å®é™…æµ‹è¯•å»ºè®®</h3>
<ol>
<li>Chrome DevTools Performance: æ£€æŸ¥ä¸»çº¿ç¨‹é˜»å¡æƒ…å†µ</li>
<li>FPS ç›‘æ§: ç›‘æ§å¸§ç‡å˜åŒ–</li>
<li>Lighthouse: è¿è¡Œæ€§èƒ½æµ‹è¯•</li>
<li>çœŸå®åœºæ™¯æµ‹è¯•: æµ‹è¯•å¤§é‡æ–‡ä»¶ä¸Šä¼ æ—¶çš„æ€§èƒ½</li>
</ol>
<h2 data-id="heading-12">æµè§ˆå™¨å…¼å®¹æ€§</h2>
<h3 data-id="heading-13">åŸç”Ÿæ”¯æŒ</h3>
<ul>
<li>âœ… Chrome 47+</li>
<li>âœ… Edge 79+</li>
<li>âœ… Firefox 55+</li>
<li>âœ… Safari ä¸æ”¯æŒï¼ˆéœ€è¦é™çº§æ–¹æ¡ˆï¼‰</li>
</ul>
<h3 data-id="heading-14">é™çº§æ–¹æ¡ˆ</h3>
<p>æˆ‘ä»¬çš„å®ç°è‡ªåŠ¨æä¾›äº†é™çº§æ–¹æ¡ˆï¼š</p>
<ul>
<li>ä½¿ç”¨ MessageChannelâ€‹ + setTimeoutâ€‹ æ¨¡æ‹Ÿ requestIdleCallbackâ€‹</li>
<li>ç¡®ä¿æ‰€æœ‰æµè§ˆå™¨éƒ½èƒ½æ­£å¸¸å·¥ä½œ</li>
<li>æ€§èƒ½å¯èƒ½ç•¥ä½äºåŸç”Ÿå®ç°ï¼Œä½†ä»ç„¶æ¯”ç›´æ¥æ‰§è¡Œæ›´å¥½</li>
</ul>
<h2 data-id="heading-15">æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-16">1. åˆç†è®¾ç½®è¶…æ—¶æ—¶é—´</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// å¯¹äºå…³é”®æ›´æ–°ï¼Œè®¾ç½®è¾ƒçŸ­çš„è¶…æ—¶æ—¶é—´</span>
<span class="hljs-title function_">requestIdleCallback</span>(callback, { <span class="hljs-attr">timeout</span>: <span class="hljs-number">100</span> });

<span class="hljs-comment">// å¯¹äºéå…³é”®æ›´æ–°ï¼Œå¯ä»¥è®¾ç½®è¾ƒé•¿çš„è¶…æ—¶æ—¶é—´</span>
<span class="hljs-title function_">requestIdleCallback</span>(callback, { <span class="hljs-attr">timeout</span>: <span class="hljs-number">5000</span> });
</code></pre>
<h3 data-id="heading-17">2. æ£€æŸ¥ç©ºé—²æ—¶é—´</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">requestIdleCallback</span>(<span class="hljs-function">(<span class="hljs-params">deadline</span>) =&gt;</span> {
  <span class="hljs-comment">// å¦‚æœæ—¶é—´ä¸å¤Ÿï¼Œå»¶è¿Ÿæ‰§è¡Œ</span>
  <span class="hljs-keyword">if</span> (deadline.<span class="hljs-title function_">timeRemaining</span>() &lt; <span class="hljs-number">5</span> &amp;&amp; !deadline.<span class="hljs-property">didTimeout</span>) {
    <span class="hljs-comment">// é‡æ–°è°ƒåº¦</span>
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// æ‰§è¡Œä»»åŠ¡</span>
  <span class="hljs-title function_">performTask</span>();
});
</code></pre>
<h3 data-id="heading-18">3. æ‰¹é‡å¤„ç†ä»»åŠ¡</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä½¿ç”¨ IdleTaskQueue æ‰¹é‡å¤„ç†</span>
<span class="hljs-keyword">const</span> queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IdleTaskQueue</span>();
queue.<span class="hljs-title function_">addBatch</span>([
  <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">updateTask1</span>(),
  <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">updateTask2</span>(),
  <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">updateTask3</span>(),
]);
</code></pre>
<h3 data-id="heading-19">4. æ¸…ç†èµ„æº</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç»„ä»¶é”€æ¯æ—¶æ¸…ç†</span>
<span class="hljs-title function_">destroy</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">idleCallbackHandle</span>) {
    <span class="hljs-title function_">cancelIdleCallback</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">idleCallbackHandle</span>);
  }
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">idleUpdateQueue</span>.<span class="hljs-title function_">clear</span>();
}
</code></pre>
<h2 data-id="heading-20">æ³¨æ„äº‹é¡¹</h2>
<ol>
<li>è¶…æ—¶æ—¶é—´: è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´ï¼Œç¡®ä¿ä»»åŠ¡æœ€ç»ˆä¼šè¢«æ‰§è¡Œ</li>
<li>ä»»åŠ¡å¤§å°: é¿å…åœ¨å•ä¸ªç©ºé—²å‘¨æœŸå†…æ‰§è¡Œè¿‡å¤§çš„ä»»åŠ¡</li>
<li>é”™è¯¯å¤„ç†: ç¡®ä¿ä»»åŠ¡ä¸­çš„é”™è¯¯ä¸ä¼šå½±å“åç»­ä»»åŠ¡</li>
<li>å†…å­˜ç®¡ç†: åŠæ—¶æ¸…ç†ä¸å†éœ€è¦çš„å›è°ƒå¥æŸ„</li>
</ol>
<h2 data-id="heading-21">æœªæ¥ä¼˜åŒ–æ–¹å‘</h2>
<ol>
<li>IntersectionObserver: ç»“åˆä½¿ç”¨ï¼Œåªæ›´æ–°å¯è§åŒºåŸŸçš„ä»»åŠ¡</li>
<li>Web Workers: å°†è®¡ç®—å¯†é›†å‹ä»»åŠ¡ç§»åˆ° Worker çº¿ç¨‹</li>
<li>è™šæ‹Ÿæ»šåŠ¨: å¯¹äºå¤§é‡ä»»åŠ¡åˆ—è¡¨ï¼Œä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–</li>
<li>å¢é‡æ›´æ–°: åªæ›´æ–°å˜åŒ–çš„éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯æ•´ä¸ª DOM</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨ä½ çš„ç½‘é¡µä¸­åµŒå…¥ Coze æ™ºèƒ½å®¢æœï¼šä¸€æ­¥æ­¥æ‰“é€ ä¸“å± AI Agent]]></title>    <link>https://juejin.cn/post/7579889969986109491</link>    <guid>https://juejin.cn/post/7579889969986109491</guid>    <pubDate>2025-12-05T02:47:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579889969986109491" data-draft-id="7579499567868526642" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨ä½ çš„ç½‘é¡µä¸­åµŒå…¥ Coze æ™ºèƒ½å®¢æœï¼šä¸€æ­¥æ­¥æ‰“é€ ä¸“å± AI Agent"/> <meta itemprop="keywords" content="JavaScript,äººå·¥æ™ºèƒ½,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-05T02:47:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AAAé˜¿giao"/> <meta itemprop="url" content="https://juejin.cn/user/473218785740627"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨ä½ çš„ç½‘é¡µä¸­åµŒå…¥ Coze æ™ºèƒ½å®¢æœï¼šä¸€æ­¥æ­¥æ‰“é€ ä¸“å± AI Agent
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/473218785740627/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AAAé˜¿giao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T02:47:26.000Z" title="Fri Dec 05 2025 02:47:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>åœ¨ AI æµªæ½®å¸­å·å„è¡Œå„ä¸šçš„ä»Šå¤©ï¼Œæ™ºèƒ½å®¢æœæ—©å·²ä¸å†æ˜¯â€œé«˜å¤§ä¸Šâ€çš„ä¸“å±ã€‚å€ŸåŠ© <strong>Cozeï¼ˆæ‰£å­ï¼‰å¹³å°</strong>ï¼Œæˆ‘ä»¬æ¯ä¸ªäººéƒ½èƒ½è½»æ¾åˆ›å»ºä¸€ä¸ªå±äºè‡ªå·±çš„ AI å®¢æœæœºå™¨äººï¼Œå¹¶å°†å…¶æ— ç¼é›†æˆåˆ°ä»»æ„ç½‘é¡µä¸­â€”â€”æ— è®ºä½ æ˜¯æ•™è‚²äº§å“å¼€å‘è€…ã€SaaS åˆ›ä¸šè€…ï¼Œè¿˜æ˜¯ä¸ªäººç«™é•¿ã€‚</p>
<p>æœ¬æ–‡å°†æ‰‹æŠŠæ‰‹å¸¦ä½ å®Œæˆè¿™ä¸€è¿‡ç¨‹ï¼Œä»çŸ¥è¯†åº“æ„å»ºã€Bot å‘å¸ƒï¼Œåˆ°å‰ç«¯ä»£ç è°ƒç”¨ï¼Œå°¤å…¶ä¼šå¯¹ <code>main.js</code> æ–‡ä»¶è¿›è¡Œ<strong>é€è¡Œè¯¦ç»†æ³¨é‡Š</strong>ï¼Œç¡®ä¿ä½ ä¸ä»…â€œä¼šç”¨â€ï¼Œæ›´â€œæ‡‚åŸç†â€ã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€ä¸ºä»€ä¹ˆé€‰æ‹© Cozeï¼Ÿ</h2>
<p>Coze æ˜¯å­—èŠ‚è·³åŠ¨æ¨å‡ºçš„ AI Agent æ™ºèƒ½åŠå…¬å¹³å°ï¼Œå…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li><strong>RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æŠ€æœ¯</strong>ï¼šè®©å¤§æ¨¡å‹åŸºäºä½ æä¾›çš„ç§æœ‰çŸ¥è¯†åº“å›ç­”é—®é¢˜ï¼Œé¿å…â€œèƒ¡è¯´å…«é“â€ã€‚</li>
<li><strong>ä½ä»£ç å‘å¸ƒ API</strong>ï¼šæ— éœ€æ­å»ºåç«¯ï¼Œä¸€é”®ç”Ÿæˆå¯è°ƒç”¨çš„ Bot æ¥å£ã€‚</li>
<li><strong>å¤šåœºæ™¯é€‚é…</strong>ï¼šæ— è®ºæ˜¯è¯¾ç¨‹å’¨è¯¢ã€ç¼–ç¨‹ç­”ç–‘ï¼Œè¿˜æ˜¯æ³•å¾‹/åŒ»ç–—çŸ¥è¯†é—®ç­”ï¼Œåªéœ€â€œå–‚â€å¯¹èµ„æ–™ã€‚</li>
</ul>
<blockquote>
<p>ğŸ’¡ ä¸¾ä¸ªä¾‹å­ï¼šä½ æƒ³åšä¸€ä¸ªâ€œPython ç¼–ç¨‹è¯¾â€çš„å®¢æœæœºå™¨äººã€‚å­¦ç”Ÿé—®ï¼šâ€œç¬¬3ç« ä½œä¸šæ€ä¹ˆæäº¤ï¼Ÿâ€â€”â€”åªè¦ä½ åœ¨çŸ¥è¯†åº“é‡Œå†™æ¸…æ¥šæµç¨‹ï¼ŒAI å°±èƒ½ç²¾å‡†å›ç­”ï¼Œè€Œä¸æ˜¯ççŒœã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-2">äºŒã€å‡†å¤‡å·¥ä½œï¼šåˆ›å»ºå¹¶å‘å¸ƒä½ çš„ Coze Bot</h2>
<ol>
<li>
<p><strong>ç™»å½• <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.coze.cn%2F" title="https://www.coze.cn/" target="_blank" ref="nofollow noopener noreferrer">Coze å¹³å°</a></strong></strong></p>
</li>
<li>
<p><strong>æ–°å»º Bot</strong>ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ·»åŠ  <strong>è¯¾ç¨‹çŸ¥è¯†åº“</strong>ï¼ˆå¦‚ PDFã€Markdownã€ç½‘é¡µé“¾æ¥ç­‰ï¼‰</li>
<li>å¯ç”¨ <strong>RAG æ£€ç´¢</strong>ï¼Œç¡®ä¿å›ç­”åŸºäºä½ çš„èµ„æ–™</li>
<li>æµ‹è¯•å¯¹è¯æ•ˆæœï¼Œè°ƒæ•´æç¤ºè¯ï¼ˆPromptï¼‰</li>
</ul>
</li>
<li>
<p><strong>å‘å¸ƒä¸º API</strong><br/>
ç‚¹å‡»ã€Œå‘å¸ƒã€â†’ã€ŒAPI è°ƒç”¨ã€ï¼Œä½ ä¼šå¾—åˆ°ä¸¤ä¸ªå…³é”®ä¿¡æ¯ï¼š</p>
<ul>
<li><code>VITE_BOT_ID</code>ï¼šä½ çš„ Bot å”¯ä¸€æ ‡è¯†ï¼ˆå³å‘å¸ƒ IDï¼‰</li>
<li><code>VITE_API_KEY</code>ï¼šè°ƒç”¨æƒé™å¯†é’¥ï¼ˆTokenï¼‰</li>
</ul>
</li>
</ol>
<p>æ™ºèƒ½ä½“å¦‚å›¾ï¼Œæœ¬æ–‡é‡ç‚¹è®²è¿°å¦‚ä½•è°ƒç”¨ï¼Œå¯¹å¦‚ä½•åˆ›å»ºæ™ºèƒ½ä½“ä¸è¿‡å¤šæè¿°ï¼Œå¯ç›´æ¥ä½¿ç”¨æœ¬æ–‡çš„ç¤ºä¾‹URL</p>
<p><code>https://www.coze.cn/space/7567783700911013940/bot/7578869824248676361/publish</code></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ec9f924a6bc45e5afa86016f7acedfa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUFB6Zi_Z2lhbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507646&amp;x-signature=sW7%2BFjWmEnj27E%2FV39xN9BZaA9U%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9ae5820c5554cc39c091593862243d6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUFB6Zi_Z2lhbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507646&amp;x-signature=uN2pzyTV0JyfZTVU714tE%2B2p1qU%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<blockquote>
<p>ğŸ“Œ ç¤ºä¾‹ URL ä¸­å·²åŒ…å« Bot IDï¼š<br/>
<code>https://www.coze.cn/space/7567783700911013940/bot/7578869824248676361/publish</code><br/>
â†’ <code>7578869824248676361</code> å°±æ˜¯ <code>VITE_BOT_ID</code></p>
</blockquote>
<hr/>
<h2 data-id="heading-3">ä¸‰ã€å‰ç«¯é›†æˆï¼šåœ¨ä»»æ„ç½‘é¡µä¸­è°ƒç”¨ Coze Agent</h2>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬è¿›å…¥æœ€æ¿€åŠ¨äººå¿ƒçš„éƒ¨åˆ†â€”â€”æŠŠ AI å®¢æœåµŒå…¥ä½ çš„ç½‘ç«™ï¼</p>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªè½»é‡çº§ç¤ºä¾‹é¡¹ç›®ï¼š<strong>coze-agent-demo</strong>ï¼ŒåŸºäº Vite æ„å»ºã€‚å³ä½¿ä½ ä¸ç”¨ Viteï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨ HTML ä¸­å¼•å…¥ JS æ–‡ä»¶ã€‚</p>
<h3 data-id="heading-4"><strong>é¡¹ç›®åˆå§‹åŒ–å»ºè®®</strong></h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ä½¿ç”¨ Traeï¼ˆæˆ– Viteï¼‰å¿«é€Ÿåˆ›å»ºé¡¹ç›®</span>
npm create vite@latest coze-agent-demo -- --template vanilla
cd coze-agent-demo
<span class="hljs-comment"># åœ¨ .env.local ä¸­å¡«å…¥ï¼š</span>
<span class="hljs-attr">VITE_BOT_ID</span>=<span class="hljs-number">7578869824248676361</span>
<span class="hljs-attr">VITE_API_KEY</span>=your_coze_api_token_here
</code></pre>
<h3 data-id="heading-5">é¡¹ç›®ç»“æ„ç®€è¿°</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0849abf15c4e4ee0b5595815f514f520~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUFB6Zi_Z2lhbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507646&amp;x-signature=xi1qRIekAoFqkyxMBq9m5swt9h4%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>å¦‚æœè¿è¡Œæ—¶æŠ¥é”™æ˜¾ç¤º main.jsÂ æ— æ³•è¯»å–.env.local çš„å†…å®¹ï¼Œå†åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ .env å†…å®¹å¦‚ä¸‹</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># Coze APIç¯å¢ƒå˜é‡</span>
<span class="hljs-attr">VITE_BOT_ID</span>=demo_bot_id
<span class="hljs-attr">VITE_API_KEY</span>=demo_api_key
</code></pre>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†é‡ç‚¹è§£æ <code>main.js</code> çš„æ¯ä¸€è¡Œä»£ç ã€‚</p>
<hr/>
<h2 data-id="heading-6">å››ã€é€è¡Œè¯¦è§£ <code>main.js</code>ï¼šå¦‚ä½•ä¸ Coze å¯¹è¯ï¼Ÿ</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. ä»ç¯å¢ƒå˜é‡ä¸­è¯»å– Bot ID å’Œ API Key</span>
<span class="hljs-comment">//    åœ¨ Vite é¡¹ç›®ä¸­ï¼Œä»¥ VITE_ å¼€å¤´çš„å˜é‡ä¼šè¢«è‡ªåŠ¨æ³¨å…¥åˆ° import.meta.env</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">BOT_ID</span> = <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_BOT_ID</span>;
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">API_KEY</span> = <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_API_KEY</span>;

<span class="hljs-comment">// 2. å®šä¹‰ Coze API çš„è¯·æ±‚åœ°å€</span>
<span class="hljs-comment">//    è¿™æ˜¯ Coze å®˜æ–¹æä¾›çš„å¯¹è¯æ¥å£ï¼ˆWebSocket æˆ– RESTï¼Ÿæ­¤å¤„ä¸º RESTï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">API_URL</span> = <span class="hljs-string">'https://api.coze.cn/open_api/v1/chat'</span>;

<span class="hljs-comment">// 3. è·å–é¡µé¢ä¸­çš„ DOM å…ƒç´ </span>
<span class="hljs-comment">//    - userInput: ç”¨æˆ·è¾“å…¥æ¡†</span>
<span class="hljs-comment">//    - sendButton: å‘é€æŒ‰é’®</span>
<span class="hljs-comment">//    - chatBox: èŠå¤©æ¶ˆæ¯å±•ç¤ºåŒºåŸŸ</span>
<span class="hljs-keyword">const</span> userInput = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'user-input'</span>);
<span class="hljs-keyword">const</span> sendButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'send-button'</span>);
<span class="hljs-keyword">const</span> chatBox = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'chat-box'</span>);

<span class="hljs-comment">// 4. ä¸ºâ€œå‘é€â€æŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶</span>
sendButton.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, sendMessage);

<span class="hljs-comment">// 5. åŒæ—¶ç›‘å¬å›è½¦é”®ï¼ˆEnterï¼‰è§¦å‘å‘é€</span>
userInput.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'keypress'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">'Enter'</span>) {
    <span class="hljs-title function_">sendMessage</span>();
  }
});

<span class="hljs-comment">// 6. æ ¸å¿ƒå‡½æ•°ï¼šå‘é€æ¶ˆæ¯å¹¶è·å– AI å›å¤</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendMessage</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// 6.1 è·å–ç”¨æˆ·è¾“å…¥å†…å®¹ï¼Œå¹¶å»é™¤é¦–å°¾ç©ºæ ¼</span>
  <span class="hljs-keyword">const</span> message = userInput.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>();
  
  <span class="hljs-comment">// 6.2 å¦‚æœè¾“å…¥ä¸ºç©ºï¼Œç›´æ¥è¿”å›ï¼ˆä¸å‘é€ï¼‰</span>
  <span class="hljs-keyword">if</span> (!message) <span class="hljs-keyword">return</span>;

  <span class="hljs-comment">// 6.3 æ¸…ç©ºè¾“å…¥æ¡†ï¼Œæå‡ç”¨æˆ·ä½“éªŒ</span>
  userInput.<span class="hljs-property">value</span> = <span class="hljs-string">''</span>;

  <span class="hljs-comment">// 6.4 åœ¨èŠå¤©æ¡†ä¸­æ˜¾ç¤ºç”¨æˆ·çš„æ¶ˆæ¯ï¼ˆå·¦ä¾§æ°”æ³¡ï¼‰</span>
  <span class="hljs-title function_">appendMessage</span>(<span class="hljs-string">'user'</span>, message);

  <span class="hljs-comment">// 6.5 å‡†å¤‡è¯·æ±‚ä½“ï¼ˆpayloadï¼‰</span>
  <span class="hljs-comment">//     - bot_id: ä½ çš„ Bot å”¯ä¸€æ ‡è¯†</span>
  <span class="hljs-comment">//     - user_id: å¯ç”¨äºåŒºåˆ†ä¸åŒç”¨æˆ·ï¼ˆæ­¤å¤„ç®€åŒ–ä¸ºå›ºå®šå€¼ï¼‰</span>
  <span class="hljs-comment">//     - query: ç”¨æˆ·çš„é—®é¢˜</span>
  <span class="hljs-comment">//     - stream: æ˜¯å¦å¯ç”¨æµå¼å“åº”ï¼ˆæ­¤å¤„ä¸º falseï¼Œä½¿ç”¨å®Œæ•´å“åº”ï¼‰</span>
  <span class="hljs-keyword">const</span> payload = {
    <span class="hljs-attr">bot_id</span>: <span class="hljs-variable constant_">BOT_ID</span>,
    <span class="hljs-attr">user_id</span>: <span class="hljs-string">'user123'</span>, <span class="hljs-comment">// å®é™…é¡¹ç›®ä¸­å»ºè®®ç”¨çœŸå®ç”¨æˆ·IDæˆ–ä¼šè¯ID</span>
    <span class="hljs-attr">query</span>: message,
    <span class="hljs-attr">stream</span>: <span class="hljs-literal">false</span>
  };

  <span class="hljs-comment">// 6.6 ä½¿ç”¨ fetch å‘èµ· POST è¯·æ±‚åˆ° Coze API</span>
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-variable constant_">API_URL</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${API_KEY}</span>`</span>, <span class="hljs-comment">// 6.6.1 å¿…é¡»æºå¸¦ API Key è¿›è¡Œèº«ä»½éªŒè¯</span>
        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>     <span class="hljs-comment">// 6.6.2 å£°æ˜è¯·æ±‚ä½“ä¸º JSON</span>
      },
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(payload) <span class="hljs-comment">// 6.6.3 å°† payload è½¬ä¸º JSON å­—ç¬¦ä¸²</span>
    });

    <span class="hljs-comment">// 6.7 æ£€æŸ¥å“åº”æ˜¯å¦æˆåŠŸ</span>
    <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`API error: <span class="hljs-subst">${response.status}</span>`</span>);
    }

    <span class="hljs-comment">// 6.8 è§£æè¿”å›çš„ JSON æ•°æ®</span>
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();

    <span class="hljs-comment">// 6.9 ä»å“åº”ä¸­æå– AI çš„å›ç­”</span>
    <span class="hljs-comment">//     Coze çš„å“åº”ç»“æ„ä¸­ï¼Œmessages æ•°ç»„åŒ…å«å¯¹è¯å†å²</span>
    <span class="hljs-comment">//     æœ€åä¸€æ¡é€šå¸¸æ˜¯ AI çš„å›å¤ï¼Œä¸” role ä¸º 'assistant'</span>
    <span class="hljs-keyword">const</span> aiMessage = data.<span class="hljs-property">messages</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">msg</span> =&gt;</span> msg.<span class="hljs-property">role</span> === <span class="hljs-string">'assistant'</span>)?.<span class="hljs-property">content</span> || <span class="hljs-string">'æŠ±æ­‰ï¼Œæˆ‘æ— æ³•å›ç­”è¿™ä¸ªé—®é¢˜ã€‚'</span>;

    <span class="hljs-comment">// 6.10 åœ¨èŠå¤©æ¡†ä¸­æ˜¾ç¤º AI çš„å›å¤ï¼ˆå³ä¾§æ°”æ³¡ï¼‰</span>
    <span class="hljs-title function_">appendMessage</span>(<span class="hljs-string">'ai'</span>, aiMessage);

  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// 6.11 é”™è¯¯å¤„ç†ï¼šç½‘ç»œé—®é¢˜ã€API é™æµã€è®¤è¯å¤±è´¥ç­‰</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Error:'</span>, error);
    <span class="hljs-title function_">appendMessage</span>(<span class="hljs-string">'ai'</span>, <span class="hljs-string">'å“å‘€ï¼Œå‡ºé”™äº†ï¼è¯·ç¨åå†è¯•~'</span>);
  }
}

<span class="hljs-comment">// 7. è¾…åŠ©å‡½æ•°ï¼šå‘èŠå¤©æ¡†è¿½åŠ æ¶ˆæ¯</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">appendMessage</span>(<span class="hljs-params">sender, text</span>) {
  <span class="hljs-comment">// 7.1 åˆ›å»ºä¸€ä¸ªæ–°çš„æ¶ˆæ¯ div å…ƒç´ </span>
  <span class="hljs-keyword">const</span> messageElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
  
  <span class="hljs-comment">// 7.2 æ ¹æ®å‘é€è€…è®¾ç½® CSS ç±»åï¼ˆç”¨äºæ ·å¼åŒºåˆ†ï¼‰</span>
  messageElement.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">'message'</span>, sender);
  
  <span class="hljs-comment">// 7.3 è®¾ç½®æ¶ˆæ¯å†…å®¹ï¼ˆæ³¨æ„ï¼šè¿™é‡Œæœªåš XSS é˜²æŠ¤ï¼Œç”Ÿäº§ç¯å¢ƒéœ€è½¬ä¹‰ï¼‰</span>
  messageElement.<span class="hljs-property">textContent</span> = text;
  
  <span class="hljs-comment">// 7.4 å°†æ¶ˆæ¯å…ƒç´ æ·»åŠ åˆ°èŠå¤©å®¹å™¨æœ«å°¾</span>
  chatBox.<span class="hljs-title function_">appendChild</span>(messageElement);
  
  <span class="hljs-comment">// 7.5 è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨ï¼Œç¡®ä¿æœ€æ–°æ¶ˆæ¯å¯è§</span>
  chatBox.<span class="hljs-property">scrollTop</span> = chatBox.<span class="hljs-property">scrollHeight</span>;
}
</code></pre>
<hr/>
<h2 data-id="heading-7">äº”ã€å…³é”®ç»†èŠ‚è§£æ</h2>
<h3 data-id="heading-8">å®‰å…¨æé†’</h3>
<ul>
<li><code>VITE_API_KEY</code> <strong>ç»ä¸èƒ½æš´éœ²åœ¨å‰ç«¯ç”Ÿäº§ç¯å¢ƒ</strong>ï¼<br/>
å½“å‰ demo ä»…é€‚ç”¨äºæœ¬åœ°å¼€å‘æˆ–æ¼”ç¤ºã€‚<br/>
<strong>æ­£ç¡®åšæ³•</strong>ï¼šé€šè¿‡ä½ è‡ªå·±çš„åç«¯ä»£ç†è¯·æ±‚ï¼Œç”±åç«¯æŒæœ‰ <code>API_KEY</code>ï¼Œå‰ç«¯åªä¸ä½ çš„æœåŠ¡å™¨é€šä¿¡ã€‚</li>
</ul>
<h3 data-id="heading-9">RAG å¦‚ä½•ç”Ÿæ•ˆï¼Ÿ</h3>
<p>å½“ä½ åœ¨ Coze åå°ä¸Šä¼ äº†è¯¾ç¨‹æ–‡æ¡£ï¼ŒCoze ä¼šè‡ªåŠ¨å°†å…¶å‘é‡åŒ–ã€‚å½“ç”¨æˆ·æé—®æ—¶ï¼š</p>
<ol>
<li>ç³»ç»Ÿå…ˆåœ¨çŸ¥è¯†åº“ä¸­æ£€ç´¢ç›¸å…³ç‰‡æ®µ</li>
<li>å°†ç‰‡æ®µ + ç”¨æˆ·é—®é¢˜ä¸€èµ·é€å…¥ LLM</li>
<li>LLM åŸºäºä¸Šä¸‹æ–‡ç”Ÿæˆå‡†ç¡®å›ç­”</li>
</ol>
<blockquote>
<p>âœ… è¿™å°±æ˜¯ä¸ºä»€ä¹ˆâ€œå–‚é¥­â€çŸ¥è¯†åº“æ¯”å•çº¯ä¾èµ–æ¨¡å‹æ›´é‡è¦ï¼</p>
</blockquote>
<h3 data-id="heading-10">æ ·å¼ä¸äº¤äº’</h3>
<p><code>index.html</code>Â ä»£ç å†…å®¹</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Coze API Demo<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Coze API DEMO éšå¤„æ™ºèƒ½<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"ipt"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¯·è¾“å…¥é—®é¢˜"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"reply"</span>&gt;</span>think...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./src/main.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>è¿è¡Œè¯¥æ–‡ä»¶åï¼Œåœ¨æµè§ˆå™¨é¡µé¢å³é”®ç‚¹å‡»æ£€æŸ¥ï¼Œæ‰“å¼€æ§åˆ¶å°ï¼Œè¾“å…¥é—®é¢˜å¹¶å°†ç„¦ç‚¹ç§»å‡ºè¾“å…¥æ¡†ï¼Œæ§åˆ¶å°å°†æ˜¾ç¤ºå†…å®¹</p>
<p>å½“ç½‘é¡µä»<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/575382cd11844414947cf5e4026274d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUFB6Zi_Z2lhbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507646&amp;x-signature=YLytmh9kBmlFEHNlJ622tmo6s38%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>è½¬å˜ä¸º<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a2e8ebb7ae674315b2f909228ee7a5f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUFB6Zi_Z2lhbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765507646&amp;x-signature=6zVYAZ1UNtW%2Fx0ABp4Hy16scCos%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>å³ä¸ºè¿è¡ŒæˆåŠŸ</p>
<hr/>
<h2 data-id="heading-11">å…­ã€æ‰©å±•å¯èƒ½</h2>
<ul>
<li><strong>æ”¯æŒå›¾ç‰‡ä¸Šä¼ </strong>ï¼šCoze API æ”¯æŒå¤šæ¨¡æ€è¾“å…¥ï¼Œå¯è®©å­¦ç”Ÿæ‹ç…§æé—®ç¼–ç¨‹é¢˜ã€‚</li>
<li><strong>ä¼šè¯è®°å¿†</strong>ï¼šé€šè¿‡ç»´æŠ¤ <code>conversation_id</code> å®ç°ä¸Šä¸‹æ–‡è¿ç»­å¯¹è¯ã€‚</li>
<li><strong>è™šæ‹Ÿæ•°å­—äºº</strong>ï¼šç»“åˆè¯­éŸ³åˆæˆï¼ˆTTSï¼‰ä¸åŠ¨ç”»ï¼Œæ‰“é€ æ‹ŸäººåŒ–å®¢æœã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-12">ç»“è¯­</h2>
<p>é€šè¿‡ Cozeï¼Œæˆ‘ä»¬ä¸å†éœ€è¦ä»é›¶è®­ç»ƒæ¨¡å‹ï¼Œè€Œæ˜¯<strong>èšç„¦äºçŸ¥è¯†çš„ç»„ç»‡ä¸äº¤ä»˜</strong>ã€‚æ­£å¦‚é‚£å¥è€è¯ï¼šâ€œæˆäººä»¥é±¼ä¸å¦‚æˆäººä»¥æ¸”â€â€”â€”è€Œ Coze è®©ä½ æ—¢èƒ½â€œç»™é±¼â€ï¼Œåˆèƒ½â€œæ•™é’“é±¼â€ã€‚</p>
<p>ç°åœ¨ï¼Œæ‰“å¼€ä½ çš„ç¼–è¾‘å™¨ï¼ŒæŠŠé‚£ä¸ªæ²‰ç¡çš„çŸ¥è¯†åº“å”¤é†’ï¼Œè®©å®ƒå˜æˆä¸€ä¸ª 7Ã—24 å°æ—¶åœ¨çº¿çš„æ™ºèƒ½åŠ©æ‰‹å§ï¼</p>
<blockquote>
<p>ğŸŒŸ <strong>ä½ çš„çŸ¥è¯†ï¼Œå€¼å¾—è¢« AI æ›´å¥½åœ°è®²è¿°ã€‚</strong></p>
</blockquote>
<p>Happy Codingï¼ğŸ¤–âœ¨</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç»„ä»¶ä¸å¤–éƒ¨ä¸–ç•Œçš„æ¡¥æ¢ï¼šä¸€æ–‡è¯»æ‡‚ useEffect çš„æ ¸å¿ƒæœºåˆ¶]]></title>    <link>https://juejin.cn/post/7579889969986142259</link>    <guid>https://juejin.cn/post/7579889969986142259</guid>    <pubDate>2025-12-05T02:55:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579889969986142259" data-draft-id="7579892134816677923" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç»„ä»¶ä¸å¤–éƒ¨ä¸–ç•Œçš„æ¡¥æ¢ï¼šä¸€æ–‡è¯»æ‡‚ useEffect çš„æ ¸å¿ƒæœºåˆ¶"/> <meta itemprop="keywords" content="å‰ç«¯,React.js"/> <meta itemprop="datePublished" content="2025-12-05T02:55:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çš®è›‹å°ç²¾çµ"/> <meta itemprop="url" content="https://juejin.cn/user/219558056559278"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç»„ä»¶ä¸å¤–éƒ¨ä¸–ç•Œçš„æ¡¥æ¢ï¼šä¸€æ–‡è¯»æ‡‚ useEffect çš„æ ¸å¿ƒæœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/219558056559278/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çš®è›‹å°ç²¾çµ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T02:55:43.000Z" title="Fri Dec 05 2025 02:55:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ç®€å•æ¥è¯´ï¼Œ<code>useEffect</code> æ˜¯ React å‡½æ•°ç»„ä»¶ä¸­ç”¨æ¥å¤„ç†<strong>å‰¯ä½œç”¨ (Side Effects)</strong> çš„é’©å­ã€‚</p>
<p>ä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºâ€œ<strong>ç»„ä»¶ä¸å¤–éƒ¨ä¸–ç•Œæ²Ÿé€šçš„æ¡¥æ¢</strong>â€ã€‚</p>
<p>ç»„ä»¶çš„æ ¸å¿ƒä»»åŠ¡æ˜¯<strong>æ¸²æŸ“</strong>ï¼ˆæŠŠæ•°æ®å˜æˆ UIï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªçº¯å‡€çš„è®¡ç®—è¿‡ç¨‹ã€‚ä½†æœ‰æ—¶å€™ä½ éœ€è¦åšä¸€äº›â€œ<strong>ä¸çº¯å‡€</strong>â€çš„äº‹æƒ…ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>å»æœåŠ¡å™¨æ‹¿æ•°æ®ã€‚</li>
<li>æ‰‹åŠ¨æ”¹ä¸€ä¸‹ç½‘é¡µæ ‡é¢˜ã€‚</li>
<li>è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ã€‚</li>
<li>ç›‘å¬é¼ æ ‡æ»šåŠ¨ã€‚</li>
</ul>
<p>è¿™äº›äº‹æƒ…éƒ½ä¸èƒ½åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­ç›´æ¥åšï¼Œå¿…é¡»äº¤ç»™ <code>useEffect</code> åœ¨<strong>æ¸²æŸ“ç»“æŸå</strong>å»åšã€‚</p>
<hr/>
<h3 data-id="heading-0">å®ƒçš„ä¸‰ä¸ªæ ¸å¿ƒä½œç”¨ï¼ˆå¯¹åº”ç±»ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼‰</h3>
<p>å¦‚æœä½ ç†Ÿæ‚‰ React ç±»ç»„ä»¶ï¼Œ<code>useEffect</code> ç›¸å½“äº <code>componentDidMount</code>ã€<code>componentDidUpdate</code> å’Œ <code>componentWillUnmount</code> è¿™ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸçš„ç»„åˆä½“ã€‚</p>
<h4 data-id="heading-1">1. ç»„ä»¶æŒ‚è½½æ—¶æ‰§è¡Œ (Mount)</h4>
<p>â€œç»„ä»¶åˆšå‡ºç°æ—¶ï¼Œåšç‚¹ä»€ä¹ˆã€‚â€</p>
<p>æ¯”å¦‚ï¼šé¡µé¢ä¸€åŠ è½½å°±è¯·æ±‚ APIï¼Œæˆ–è€…å»ºç«‹ WebSocket è¿æ¥ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶æŒ‚è½½äº†ï¼ˆåªè¿è¡Œä¸€æ¬¡ï¼‰'</span>);
  <span class="hljs-title function_">fetchData</span>();
}, []); <span class="hljs-comment">// âœ… ç©ºæ•°ç»„ï¼šä»£è¡¨æ²¡æœ‰ä»»ä½•ä¾èµ–ï¼Œåªåœ¨å‡ºç”Ÿæ—¶è·‘ä¸€æ¬¡</span>
</code></pre>
<h4 data-id="heading-2">2. ä¾èµ–æ›´æ–°æ—¶æ‰§è¡Œ (Update)</h4>
<p>â€œå½“æŸä¸ªæ•°æ®å˜äº†ï¼Œåšç‚¹åŒæ­¥å·¥ä½œã€‚â€</p>
<p>è¿™æ˜¯ useEffect æœ€æ ¸å¿ƒçš„è®¾è®¡ç†å¿µï¼šåŒæ­¥ã€‚ä¿æŒç»„ä»¶å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨ç³»ç»ŸåŒæ­¥ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'userId å˜äº†ï¼Œæˆ‘è¦é‡æ–°è·å–ç”¨æˆ·ä¿¡æ¯'</span>);
  <span class="hljs-title function_">fetchUserInfo</span>(userId);
}, [userId]); <span class="hljs-comment">// âœ… ä¾èµ–æ•°ç»„ï¼šåªè¦ userId å˜ï¼Œæˆ‘å°±é‡è·‘</span>
</code></pre>
<h4 data-id="heading-3">3. ç»„ä»¶å¸è½½/æ¸…ç†æ—¶æ‰§è¡Œ (Unmount / Cleanup)</h4>
<p>â€œç»„ä»¶è¦æ¶ˆå¤±äº†ï¼ˆæˆ–è€…ä¾èµ–å˜äº†ï¼‰ï¼ŒæŠŠä¹‹å‰çš„çƒ‚æ‘Šå­æ”¶æ‹¾ä¸€ä¸‹ã€‚â€</p>
<p>æ¯”å¦‚ï¼šæ¸…é™¤å®šæ—¶å™¨ã€å–æ¶ˆè®¢é˜…ã€æ–­å¼€è¿æ¥ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Tick'</span>), <span class="hljs-number">1000</span>);

  <span class="hljs-comment">// ğŸ‘‡ è¿”å›ä¸€ä¸ªæ¸…ç†å‡½æ•°</span>
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-built_in">clearInterval</span>(timer);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶å¸è½½äº†ï¼Œæˆ–è€…ä¸‹æ¬¡ Effect è¿è¡Œå‰ï¼Œå…ˆæ¸…ç†æ—§çš„å®šæ—¶å™¨'</span>);
  };
}, []);
</code></pre>
<hr/>
<h3 data-id="heading-4">æ€»ç»“ä¸€å¼ è¡¨</h3>






























<table><thead><tr><th><strong>å†™æ³•</strong></th><th><strong>å«ä¹‰</strong></th><th><strong>å¯¹åº”ç±»ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</strong></th></tr></thead><tbody><tr><td><code>useEffect(() =&gt; { ... })</code></td><td><strong>æ¯æ¬¡</strong>æ¸²æŸ“åéƒ½è·‘</td><td><code>componentDidMount</code> + <code>componentDidUpdate</code></td></tr><tr><td><code>useEffect(() =&gt; { ... }, [])</code></td><td>åªåœ¨<strong>ç¬¬ä¸€æ¬¡</strong>æ¸²æŸ“åè·‘</td><td><code>componentDidMount</code></td></tr><tr><td><code>useEffect(() =&gt; { ... }, [prop])</code></td><td>åªåœ¨ <strong>prop å˜åŒ–</strong>åè·‘</td><td><code>componentDidUpdate</code> (å¸¦åˆ¤æ–­)</td></tr><tr><td><code>useEffect(() =&gt; { return () =&gt; ... }, [])</code></td><td>ç»„ä»¶<strong>é”€æ¯</strong>æ—¶è·‘</td><td><code>componentWillUnmount</code></td></tr></tbody></table>
<h3 data-id="heading-5">ä¸€å¥è¯å¿ƒæ³•</h3>
<p><code>useEffect</code> çš„ä½œç”¨æ˜¯å‘Šè¯‰ Reactï¼š <strong>â€œç­‰æŠŠç•Œé¢ç”»å¥½ä¹‹åï¼Œå»å¸®æˆ‘åšè¿™ä»¶è¿™ä»¶é¢å¤–çš„äº‹ï¼ˆå‰¯ä½œç”¨ï¼‰ã€‚å¦‚æœæˆ‘ä¾èµ–çš„å˜é‡å˜äº†ï¼Œè®°å¾—é‡åšä¸€éã€‚â€</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Oracleå…¥é—¨åˆ°åˆ åº“è·‘è·¯-04ã€‘åŸºç¡€å…¥é—¨ï¼šåŸºæœ¬æŸ¥è¯¢æ“ä½œ]]></title>    <link>https://juejin.cn/post/7579892222608998435</link>    <guid>https://juejin.cn/post/7579892222608998435</guid>    <pubDate>2025-12-05T02:54:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579892222608998435" data-draft-id="7579886397074456576" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Oracleå…¥é—¨åˆ°åˆ åº“è·‘è·¯-04ã€‘åŸºç¡€å…¥é—¨ï¼šåŸºæœ¬æŸ¥è¯¢æ“ä½œ"/> <meta itemprop="keywords" content="æ•°æ®åº“,Oracle"/> <meta itemprop="datePublished" content="2025-12-05T02:54:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¶æ—¥å¤±çœ è€…"/> <meta itemprop="url" content="https://juejin.cn/user/3411111810444068"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Oracleå…¥é—¨åˆ°åˆ åº“è·‘è·¯-04ã€‘åŸºç¡€å…¥é—¨ï¼šåŸºæœ¬æŸ¥è¯¢æ“ä½œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3411111810444068/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¶æ—¥å¤±çœ è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T02:54:40.000Z" title="Fri Dec 05 2025 02:54:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">SELECTè¯­å¥åŸºç¡€</h2>
<p>SELECTè¯­å¥æ˜¯SQLä¸­æœ€å¸¸ç”¨çš„æŸ¥è¯¢è¯­å¥ï¼Œç”¨äºä»æ•°æ®åº“ä¸­æ£€ç´¢æ•°æ®ã€‚</p>
<h3 data-id="heading-1">åŸºæœ¬è¯­æ³•</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> [<span class="hljs-keyword">DISTINCT</span>] column_list
<span class="hljs-keyword">FROM</span> table_name
[<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">condition</span>]
[<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> column_list [<span class="hljs-keyword">ASC</span><span class="hljs-operator">|</span><span class="hljs-keyword">DESC</span>]]
[LIMIT number];
</code></pre>
<h3 data-id="heading-2">æŸ¥è¯¢æ‰€æœ‰åˆ—</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥è¯¢employeesè¡¨ä¸­çš„æ‰€æœ‰æ•°æ®</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- æŸ¥è¯¢departmentsè¡¨ä¸­çš„æ‰€æœ‰æ•°æ®</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> departments;
</code></pre>
<h3 data-id="heading-3">æŸ¥è¯¢æŒ‡å®šåˆ—</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥è¯¢å‘˜å·¥çš„å§“åå’Œè–ªèµ„</span>
<span class="hljs-keyword">SELECT</span> first_name, last_name, salary <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- æŸ¥è¯¢éƒ¨é—¨åç§°</span>
<span class="hljs-keyword">SELECT</span> department_name <span class="hljs-keyword">FROM</span> departments;
</code></pre>
<h3 data-id="heading-4">ä½¿ç”¨åˆ—åˆ«å</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- ä½¿ç”¨ASå…³é”®å­—è®¾ç½®åˆ«å</span>
<span class="hljs-keyword">SELECT</span> first_name <span class="hljs-keyword">AS</span> "åå­—", last_name <span class="hljs-keyword">AS</span> "å§“æ°", salary <span class="hljs-keyword">AS</span> "è–ªèµ„" <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- çœç•¥ASå…³é”®å­—</span>
<span class="hljs-keyword">SELECT</span> first_name "åå­—", last_name "å§“æ°", salary "è–ªèµ„" <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- ä½¿ç”¨è¡¨è¾¾å¼åˆ«å</span>
<span class="hljs-keyword">SELECT</span> first_name <span class="hljs-operator">||</span> <span class="hljs-string">' '</span> <span class="hljs-operator">||</span> last_name <span class="hljs-keyword">AS</span> "å…¨å", salary<span class="hljs-operator">*</span><span class="hljs-number">12</span> <span class="hljs-keyword">AS</span> "å¹´è–ª" <span class="hljs-keyword">FROM</span> employees;
</code></pre>
<h2 data-id="heading-5">4.2 WHEREå­å¥æ¡ä»¶æŸ¥è¯¢</h2>
<p>WHEREå­å¥ç”¨äºç­›é€‰æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„è®°å½•ã€‚</p>
<h3 data-id="heading-6">æ¯”è¾ƒè¿ç®—ç¬¦</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- ç­‰äº</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> salary <span class="hljs-operator">=</span> <span class="hljs-number">17000</span>;

<span class="hljs-comment">-- ä¸ç­‰äº</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> department_id <span class="hljs-operator">!=</span> <span class="hljs-number">90</span>;
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> department_id <span class="hljs-operator">&lt;&gt;</span> <span class="hljs-number">90</span>;

<span class="hljs-comment">-- å¤§äºã€å°äº</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> salary <span class="hljs-operator">&gt;</span> <span class="hljs-number">10000</span>;
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> hire_date <span class="hljs-operator">&lt;</span> TO_DATE(<span class="hljs-string">'2000-01-01'</span>, <span class="hljs-string">'YYYY-MM-DD'</span>);

<span class="hljs-comment">-- å¤§äºç­‰äºã€å°äºç­‰äº</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> salary <span class="hljs-operator">&gt;=</span> <span class="hljs-number">15000</span>;
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> salary <span class="hljs-operator">&lt;=</span> <span class="hljs-number">10000</span>;
</code></pre>
<h3 data-id="heading-7">é€»è¾‘è¿ç®—ç¬¦</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- ANDè¿ç®—ç¬¦</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> department_id <span class="hljs-operator">=</span> <span class="hljs-number">60</span> <span class="hljs-keyword">AND</span> salary <span class="hljs-operator">&gt;</span> <span class="hljs-number">8000</span>;

<span class="hljs-comment">-- ORè¿ç®—ç¬¦</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> department_id <span class="hljs-operator">=</span> <span class="hljs-number">60</span> <span class="hljs-keyword">OR</span> department_id <span class="hljs-operator">=</span> <span class="hljs-number">90</span>;

<span class="hljs-comment">-- NOTè¿ç®—ç¬¦</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">NOT</span> department_id <span class="hljs-operator">=</span> <span class="hljs-number">90</span>;
</code></pre>
<h3 data-id="heading-8">èŒƒå›´æŸ¥è¯¢</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- BETWEEN...AND...</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> salary <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">10000</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">20000</span>;

<span class="hljs-comment">-- INè¿ç®—ç¬¦</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> department_id <span class="hljs-keyword">IN</span> (<span class="hljs-number">60</span>, <span class="hljs-number">90</span>, <span class="hljs-number">100</span>);

<span class="hljs-comment">-- NOT INè¿ç®—ç¬¦</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> department_id <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (<span class="hljs-number">60</span>, <span class="hljs-number">90</span>, <span class="hljs-number">100</span>);
</code></pre>
<h3 data-id="heading-9">æ¨¡ç³ŠæŸ¥è¯¢</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- LIKEè¿ç®—ç¬¦ï¼ˆ%åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œ_åŒ¹é…å•ä¸ªå­—ç¬¦ï¼‰</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> first_name <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'A%'</span>;  <span class="hljs-comment">-- å§“æ°ä»¥Aå¼€å¤´</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> first_name <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'_a%'</span>; <span class="hljs-comment">-- ç¬¬äºŒä¸ªå­—æ¯æ˜¯a</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> first_name <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'____'</span>; <span class="hljs-comment">-- å§“æ°æ°å¥½4ä¸ªå­—ç¬¦</span>

<span class="hljs-comment">-- NOT LIKEè¿ç®—ç¬¦</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> first_name <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'A%'</span>;
</code></pre>
<h3 data-id="heading-10">ç©ºå€¼æŸ¥è¯¢</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- IS NULLæŸ¥è¯¢ç©ºå€¼</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> commission_pct <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>;

<span class="hljs-comment">-- IS NOT NULLæŸ¥è¯¢éç©ºå€¼</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> commission_pct <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>;
</code></pre>
<h2 data-id="heading-11">4.3 æ’åºæŸ¥è¯¢</h2>
<p>ORDER BYå­å¥ç”¨äºå¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œæ’åºã€‚</p>
<h3 data-id="heading-12">å•åˆ—æ’åº</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŒ‰è–ªèµ„å‡åºæ’åˆ—ï¼ˆé»˜è®¤ï¼‰</span>
<span class="hljs-keyword">SELECT</span> first_name, last_name, salary <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary;

<span class="hljs-comment">-- æŒ‰è–ªèµ„é™åºæ’åˆ—</span>
<span class="hljs-keyword">SELECT</span> first_name, last_name, salary <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> salary <span class="hljs-keyword">DESC</span>;

<span class="hljs-comment">-- æŒ‰å…¥èŒæ—¥æœŸå‡åºæ’åˆ—</span>
<span class="hljs-keyword">SELECT</span> first_name, last_name, hire_date <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> hire_date;
</code></pre>
<h3 data-id="heading-13">å¤šåˆ—æ’åº</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å…ˆæŒ‰éƒ¨é—¨ç¼–å·å‡åºï¼Œå†æŒ‰è–ªèµ„é™åº</span>
<span class="hljs-keyword">SELECT</span> department_id, first_name, last_name, salary 
<span class="hljs-keyword">FROM</span> employees 
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> department_id <span class="hljs-keyword">ASC</span>, salary <span class="hljs-keyword">DESC</span>;

<span class="hljs-comment">-- æŒ‰å¤šä¸ªå­—æ®µæ’åº</span>
<span class="hljs-keyword">SELECT</span> department_id, job_id, first_name, last_name, salary 
<span class="hljs-keyword">FROM</span> employees 
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> department_id, job_id <span class="hljs-keyword">DESC</span>, salary;
</code></pre>
<h3 data-id="heading-14">æŒ‰åˆ—åˆ«åæ’åº</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŒ‰è®¡ç®—åˆ—æ’åº</span>
<span class="hljs-keyword">SELECT</span> first_name, last_name, salary<span class="hljs-operator">*</span><span class="hljs-number">12</span> <span class="hljs-keyword">AS</span> annual_salary 
<span class="hljs-keyword">FROM</span> employees 
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> annual_salary <span class="hljs-keyword">DESC</span>;
</code></pre>
<h2 data-id="heading-15">4.4 å‡½æ•°ä½¿ç”¨</h2>
<p>Oracleæä¾›äº†ä¸°å¯Œçš„å†…ç½®å‡½æ•°ç”¨äºæ•°æ®å¤„ç†ã€‚</p>
<h3 data-id="heading-16">å­—ç¬¦å‡½æ•°</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- UPPERå‡½æ•°ï¼šè½¬æ¢ä¸ºå¤§å†™</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">UPPER</span>(first_name) <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- LOWERå‡½æ•°ï¼šè½¬æ¢ä¸ºå°å†™</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">LOWER</span>(last_name) <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- INITCAPå‡½æ•°ï¼šé¦–å­—æ¯å¤§å†™</span>
<span class="hljs-keyword">SELECT</span> INITCAP(email) <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- CONCATå‡½æ•°ï¼šè¿æ¥å­—ç¬¦ä¸²</span>
<span class="hljs-keyword">SELECT</span> CONCAT(first_name, <span class="hljs-string">' '</span>) <span class="hljs-operator">||</span> last_name <span class="hljs-keyword">AS</span> full_name <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- SUBSTRå‡½æ•°ï¼šæˆªå–å­ä¸²</span>
<span class="hljs-keyword">SELECT</span> SUBSTR(first_name, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>) <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- LENGTHå‡½æ•°ï¼šè·å–å­—ç¬¦ä¸²é•¿åº¦</span>
<span class="hljs-keyword">SELECT</span> first_name, LENGTH(first_name) <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- REPLACEå‡½æ•°ï¼šæ›¿æ¢å­—ç¬¦ä¸²</span>
<span class="hljs-keyword">SELECT</span> REPLACE(phone_number, <span class="hljs-string">'.'</span>, <span class="hljs-string">'-'</span>) <span class="hljs-keyword">FROM</span> employees;
</code></pre>
<h3 data-id="heading-17">æ•°å€¼å‡½æ•°</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- ROUNDå‡½æ•°ï¼šå››èˆäº”å…¥</span>
<span class="hljs-keyword">SELECT</span> salary, ROUND(salary<span class="hljs-operator">/</span><span class="hljs-number">7</span>, <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> weekly_salary <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- TRUNCå‡½æ•°ï¼šæˆªæ–­</span>
<span class="hljs-keyword">SELECT</span> salary, TRUNC(salary<span class="hljs-operator">/</span><span class="hljs-number">7</span>) <span class="hljs-keyword">AS</span> weekly_salary <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- MODå‡½æ•°ï¼šæ±‚ä½™æ•°</span>
<span class="hljs-keyword">SELECT</span> employee_id, <span class="hljs-built_in">MOD</span>(employee_id, <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> remainder <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- ABSå‡½æ•°ï¼šç»å¯¹å€¼</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">ABS</span>(<span class="hljs-number">-100</span>) <span class="hljs-keyword">FROM</span> dual;

<span class="hljs-comment">-- CEILå‡½æ•°ï¼šå‘ä¸Šå–æ•´</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">CEIL</span>(<span class="hljs-number">45.2</span>) <span class="hljs-keyword">FROM</span> dual;

<span class="hljs-comment">-- FLOORå‡½æ•°ï¼šå‘ä¸‹å–æ•´</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">FLOOR</span>(<span class="hljs-number">45.8</span>) <span class="hljs-keyword">FROM</span> dual;
</code></pre>
<h3 data-id="heading-18">æ—¥æœŸå‡½æ•°</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- SYSDATEå‡½æ•°ï¼šè·å–å½“å‰æ—¥æœŸæ—¶é—´</span>
<span class="hljs-keyword">SELECT</span> SYSDATE <span class="hljs-keyword">FROM</span> dual;

<span class="hljs-comment">-- ADD_MONTHSå‡½æ•°ï¼šå¢åŠ æœˆä»½</span>
<span class="hljs-keyword">SELECT</span> hire_date, ADD_MONTHS(hire_date, <span class="hljs-number">6</span>) <span class="hljs-keyword">AS</span> review_date <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- MONTHS_BETWEENå‡½æ•°ï¼šè®¡ç®—æœˆä»½å·®</span>
<span class="hljs-keyword">SELECT</span> first_name, hire_date, 
       ROUND(MONTHS_BETWEEN(SYSDATE, hire_date)) <span class="hljs-keyword">AS</span> months_worked 
<span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- NEXT_DAYå‡½æ•°ï¼šä¸‹ä¸€ä¸ªæŒ‡å®šæ˜ŸæœŸå‡ </span>
<span class="hljs-keyword">SELECT</span> NEXT_DAY(SYSDATE, <span class="hljs-string">'MONDAY'</span>) <span class="hljs-keyword">FROM</span> dual;

<span class="hljs-comment">-- LAST_DAYå‡½æ•°ï¼šæœˆæœ«æ—¥æœŸ</span>
<span class="hljs-keyword">SELECT</span> LAST_DAY(SYSDATE) <span class="hljs-keyword">FROM</span> dual;

<span class="hljs-comment">-- EXTRACTå‡½æ•°ï¼šæå–æ—¥æœŸéƒ¨åˆ†</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">EXTRACT</span>(<span class="hljs-keyword">YEAR</span> <span class="hljs-keyword">FROM</span> hire_date) <span class="hljs-keyword">AS</span> hire_year <span class="hljs-keyword">FROM</span> employees;
</code></pre>
<h3 data-id="heading-19">è½¬æ¢å‡½æ•°</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- TO_CHARå‡½æ•°ï¼šè½¬æ¢ä¸ºå­—ç¬¦</span>
<span class="hljs-keyword">SELECT</span> TO_CHAR(SYSDATE, <span class="hljs-string">'YYYY-MM-DD HH24:MI:SS'</span>) <span class="hljs-keyword">FROM</span> dual;
<span class="hljs-keyword">SELECT</span> first_name, TO_CHAR(salary, <span class="hljs-string">'$999,999.99'</span>) <span class="hljs-keyword">AS</span> formatted_salary <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- TO_NUMBERå‡½æ•°ï¼šè½¬æ¢ä¸ºæ•°å€¼</span>
<span class="hljs-keyword">SELECT</span> TO_NUMBER(<span class="hljs-string">'12345'</span>) <span class="hljs-keyword">FROM</span> dual;

<span class="hljs-comment">-- TO_DATEå‡½æ•°ï¼šè½¬æ¢ä¸ºæ—¥æœŸ</span>
<span class="hljs-keyword">SELECT</span> TO_DATE(<span class="hljs-string">'2023-12-25'</span>, <span class="hljs-string">'YYYY-MM-DD'</span>) <span class="hljs-keyword">FROM</span> dual;
</code></pre>
<h2 data-id="heading-20">4.5 åˆ†ç»„æŸ¥è¯¢</h2>
<p>GROUP BYå­å¥ç”¨äºå°†æŸ¥è¯¢ç»“æœæŒ‰æŒ‡å®šåˆ—åˆ†ç»„ã€‚</p>
<h3 data-id="heading-21">åŸºæœ¬åˆ†ç»„</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŒ‰éƒ¨é—¨åˆ†ç»„ç»Ÿè®¡å‘˜å·¥æ•°é‡</span>
<span class="hljs-keyword">SELECT</span> department_id, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> employee_count 
<span class="hljs-keyword">FROM</span> employees 
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> department_id;

<span class="hljs-comment">-- æŒ‰éƒ¨é—¨åˆ†ç»„ç»Ÿè®¡å¹³å‡è–ªèµ„</span>
<span class="hljs-keyword">SELECT</span> department_id, <span class="hljs-built_in">AVG</span>(salary) <span class="hljs-keyword">AS</span> avg_salary 
<span class="hljs-keyword">FROM</span> employees 
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> department_id;
</code></pre>
<h3 data-id="heading-22">å¤šåˆ—åˆ†ç»„</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŒ‰éƒ¨é—¨å’ŒèŒä½åˆ†ç»„</span>
<span class="hljs-keyword">SELECT</span> department_id, job_id, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> employee_count, <span class="hljs-built_in">AVG</span>(salary) <span class="hljs-keyword">AS</span> avg_salary
<span class="hljs-keyword">FROM</span> employees 
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> department_id, job_id
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> department_id, job_id;
</code></pre>
<h3 data-id="heading-23">HAVINGå­å¥</h3>
<p>HAVINGå­å¥ç”¨äºå¯¹åˆ†ç»„åçš„ç»“æœè¿›è¡Œç­›é€‰ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥è¯¢å‘˜å·¥æ•°é‡å¤§äº5çš„éƒ¨é—¨</span>
<span class="hljs-keyword">SELECT</span> department_id, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> employee_count 
<span class="hljs-keyword">FROM</span> employees 
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> department_id 
<span class="hljs-keyword">HAVING</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span>;

<span class="hljs-comment">-- æŸ¥è¯¢å¹³å‡è–ªèµ„å¤§äº10000çš„éƒ¨é—¨</span>
<span class="hljs-keyword">SELECT</span> department_id, <span class="hljs-built_in">AVG</span>(salary) <span class="hljs-keyword">AS</span> avg_salary 
<span class="hljs-keyword">FROM</span> employees 
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> department_id 
<span class="hljs-keyword">HAVING</span> <span class="hljs-built_in">AVG</span>(salary) <span class="hljs-operator">&gt;</span> <span class="hljs-number">10000</span>;
</code></pre>
<h3 data-id="heading-24">èšåˆå‡½æ•°</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- COUNTå‡½æ•°ï¼šç»Ÿè®¡è®°å½•æ•°</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> employees;
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(commission_pct) <span class="hljs-keyword">FROM</span> employees;  <span class="hljs-comment">-- ä¸ç»Ÿè®¡NULLå€¼</span>

<span class="hljs-comment">-- SUMå‡½æ•°ï¼šæ±‚å’Œ</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">SUM</span>(salary) <span class="hljs-keyword">AS</span> total_salary <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- AVGå‡½æ•°ï¼šå¹³å‡å€¼</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">AVG</span>(salary) <span class="hljs-keyword">AS</span> avg_salary <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- MAXå‡½æ•°ï¼šæœ€å¤§å€¼</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(salary) <span class="hljs-keyword">AS</span> max_salary <span class="hljs-keyword">FROM</span> employees;

<span class="hljs-comment">-- MINå‡½æ•°ï¼šæœ€å°å€¼</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MIN</span>(salary) <span class="hljs-keyword">AS</span> min_salary <span class="hljs-keyword">FROM</span> employees;
</code></pre>
<h2 data-id="heading-25">4.6 å¤šè¡¨è¿æ¥æŸ¥è¯¢</h2>
<p>è¿æ¥æŸ¥è¯¢ç”¨äºä»å¤šä¸ªç›¸å…³è¡¨ä¸­æ£€ç´¢æ•°æ®ã€‚</p>
<h3 data-id="heading-26">å†…è¿æ¥ï¼ˆINNER JOINï¼‰</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æ˜¾ç¤ºå‘˜å·¥å§“åå’Œæ‰€å±éƒ¨é—¨åç§°</span>
<span class="hljs-keyword">SELECT</span> e.first_name, e.last_name, d.department_name
<span class="hljs-keyword">FROM</span> employees e
<span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> departments d <span class="hljs-keyword">ON</span> e.department_id <span class="hljs-operator">=</span> d.department_id;

<span class="hljs-comment">-- ä½¿ç”¨ä¼ ç»Ÿè¯­æ³•</span>
<span class="hljs-keyword">SELECT</span> e.first_name, e.last_name, d.department_name
<span class="hljs-keyword">FROM</span> employees e, departments d
<span class="hljs-keyword">WHERE</span> e.department_id <span class="hljs-operator">=</span> d.department_id;
</code></pre>
<h3 data-id="heading-27">å¤–è¿æ¥</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å·¦å¤–è¿æ¥ï¼ˆLEFT JOINï¼‰</span>
<span class="hljs-keyword">SELECT</span> e.first_name, e.last_name, d.department_name
<span class="hljs-keyword">FROM</span> employees e
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> departments d <span class="hljs-keyword">ON</span> e.department_id <span class="hljs-operator">=</span> d.department_id;

<span class="hljs-comment">-- å³å¤–è¿æ¥ï¼ˆRIGHT JOINï¼‰</span>
<span class="hljs-keyword">SELECT</span> e.first_name, e.last_name, d.department_name
<span class="hljs-keyword">FROM</span> employees e
<span class="hljs-keyword">RIGHT</span> <span class="hljs-keyword">JOIN</span> departments d <span class="hljs-keyword">ON</span> e.department_id <span class="hljs-operator">=</span> d.department_id;

<span class="hljs-comment">-- å…¨å¤–è¿æ¥ï¼ˆFULL JOINï¼‰</span>
<span class="hljs-keyword">SELECT</span> e.first_name, e.last_name, d.department_name
<span class="hljs-keyword">FROM</span> employees e
<span class="hljs-keyword">FULL</span> <span class="hljs-keyword">JOIN</span> departments d <span class="hljs-keyword">ON</span> e.department_id <span class="hljs-operator">=</span> d.department_id;
</code></pre>
<h3 data-id="heading-28">è‡ªè¿æ¥</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥è¯¢å‘˜å·¥åŠå…¶ç®¡ç†è€…ä¿¡æ¯</span>
<span class="hljs-keyword">SELECT</span> e.first_name <span class="hljs-operator">||</span> <span class="hljs-string">' '</span> <span class="hljs-operator">||</span> e.last_name <span class="hljs-keyword">AS</span> employee,
       m.first_name <span class="hljs-operator">||</span> <span class="hljs-string">' '</span> <span class="hljs-operator">||</span> m.last_name <span class="hljs-keyword">AS</span> manager
<span class="hljs-keyword">FROM</span> employees e
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> employees m <span class="hljs-keyword">ON</span> e.manager_id <span class="hljs-operator">=</span> m.employee_id;
</code></pre>
<h3 data-id="heading-29">å¤šè¡¨è¿æ¥</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- è¿æ¥ä¸‰ä¸ªè¡¨ï¼šå‘˜å·¥ã€éƒ¨é—¨ã€å·¥ä½œåœ°ç‚¹</span>
<span class="hljs-keyword">SELECT</span> e.first_name, e.last_name, d.department_name, l.city
<span class="hljs-keyword">FROM</span> employees e
<span class="hljs-keyword">JOIN</span> departments d <span class="hljs-keyword">ON</span> e.department_id <span class="hljs-operator">=</span> d.department_id
<span class="hljs-keyword">JOIN</span> locations l <span class="hljs-keyword">ON</span> d.location_id <span class="hljs-operator">=</span> l.location_id;
</code></pre>
<h2 data-id="heading-30">4.7 å­æŸ¥è¯¢</h2>
<p>å­æŸ¥è¯¢æ˜¯åµŒå¥—åœ¨å…¶ä»–æŸ¥è¯¢ä¸­çš„æŸ¥è¯¢è¯­å¥ã€‚</p>
<h3 data-id="heading-31">å•è¡Œå­æŸ¥è¯¢</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥è¯¢è–ªèµ„é«˜äºå¹³å‡è–ªèµ„çš„å‘˜å·¥</span>
<span class="hljs-keyword">SELECT</span> first_name, last_name, salary
<span class="hljs-keyword">FROM</span> employees
<span class="hljs-keyword">WHERE</span> salary <span class="hljs-operator">&gt;</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">AVG</span>(salary) <span class="hljs-keyword">FROM</span> employees);

<span class="hljs-comment">-- æŸ¥è¯¢ä¸å‘˜å·¥100åŒéƒ¨é—¨çš„å‘˜å·¥</span>
<span class="hljs-keyword">SELECT</span> first_name, last_name, department_id
<span class="hljs-keyword">FROM</span> employees
<span class="hljs-keyword">WHERE</span> department_id <span class="hljs-operator">=</span> (<span class="hljs-keyword">SELECT</span> department_id <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> employee_id <span class="hljs-operator">=</span> <span class="hljs-number">100</span>);
</code></pre>
<h3 data-id="heading-32">å¤šè¡Œå­æŸ¥è¯¢</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- ä½¿ç”¨INè¿ç®—ç¬¦</span>
<span class="hljs-keyword">SELECT</span> first_name, last_name, department_id
<span class="hljs-keyword">FROM</span> employees
<span class="hljs-keyword">WHERE</span> department_id <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> department_id <span class="hljs-keyword">FROM</span> departments <span class="hljs-keyword">WHERE</span> location_id <span class="hljs-operator">=</span> <span class="hljs-number">1700</span>);

<span class="hljs-comment">-- ä½¿ç”¨ANYè¿ç®—ç¬¦</span>
<span class="hljs-keyword">SELECT</span> first_name, last_name, salary
<span class="hljs-keyword">FROM</span> employees
<span class="hljs-keyword">WHERE</span> salary <span class="hljs-operator">&gt;</span> <span class="hljs-keyword">ANY</span> (<span class="hljs-keyword">SELECT</span> salary <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> department_id <span class="hljs-operator">=</span> <span class="hljs-number">60</span>);

<span class="hljs-comment">-- ä½¿ç”¨ALLè¿ç®—ç¬¦</span>
<span class="hljs-keyword">SELECT</span> first_name, last_name, salary
<span class="hljs-keyword">FROM</span> employees
<span class="hljs-keyword">WHERE</span> salary <span class="hljs-operator">&gt;</span> <span class="hljs-keyword">ALL</span> (<span class="hljs-keyword">SELECT</span> salary <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> department_id <span class="hljs-operator">=</span> <span class="hljs-number">60</span>);
</code></pre>
<h3 data-id="heading-33">ç›¸å…³å­æŸ¥è¯¢</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨è–ªèµ„æœ€é«˜çš„å‘˜å·¥</span>
<span class="hljs-keyword">SELECT</span> department_id, first_name, last_name, salary
<span class="hljs-keyword">FROM</span> employees e1
<span class="hljs-keyword">WHERE</span> salary <span class="hljs-operator">=</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(salary) 
                <span class="hljs-keyword">FROM</span> employees e2 
                <span class="hljs-keyword">WHERE</span> e2.department_id <span class="hljs-operator">=</span> e1.department_id);
</code></pre>
<h2 data-id="heading-34">4.8 é›†åˆæ“ä½œ</h2>
<p>é›†åˆæ“ä½œç”¨äºåˆå¹¶å¤šä¸ªæŸ¥è¯¢ç»“æœã€‚</p>
<h3 data-id="heading-35">UNIONæ“ä½œ</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆå¹¶ä¸¤ä¸ªæŸ¥è¯¢ç»“æœï¼ˆå»é™¤é‡å¤ï¼‰</span>
<span class="hljs-keyword">SELECT</span> first_name, last_name <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> department_id <span class="hljs-operator">=</span> <span class="hljs-number">60</span>
<span class="hljs-keyword">UNION</span>
<span class="hljs-keyword">SELECT</span> first_name, last_name <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> department_id <span class="hljs-operator">=</span> <span class="hljs-number">90</span>;
</code></pre>
<h3 data-id="heading-36">UNION ALLæ“ä½œ</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆå¹¶ä¸¤ä¸ªæŸ¥è¯¢ç»“æœï¼ˆä¿ç•™é‡å¤ï¼‰</span>
<span class="hljs-keyword">SELECT</span> first_name, last_name <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> department_id <span class="hljs-operator">=</span> <span class="hljs-number">60</span>
<span class="hljs-keyword">UNION</span> <span class="hljs-keyword">ALL</span>
<span class="hljs-keyword">SELECT</span> first_name, last_name <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> department_id <span class="hljs-operator">=</span> <span class="hljs-number">90</span>;
</code></pre>
<h3 data-id="heading-37">INTERSECTæ“ä½œ</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- è¿”å›ä¸¤ä¸ªæŸ¥è¯¢ç»“æœçš„äº¤é›†</span>
<span class="hljs-keyword">SELECT</span> department_id <span class="hljs-keyword">FROM</span> departments <span class="hljs-keyword">WHERE</span> location_id <span class="hljs-operator">=</span> <span class="hljs-number">1700</span>
<span class="hljs-keyword">INTERSECT</span>
<span class="hljs-keyword">SELECT</span> department_id <span class="hljs-keyword">FROM</span> employees <span class="hljs-keyword">WHERE</span> salary <span class="hljs-operator">&gt;</span> <span class="hljs-number">10000</span>;
</code></pre>
<h3 data-id="heading-38">MINUSæ“ä½œ</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- è¿”å›ç¬¬ä¸€ä¸ªæŸ¥è¯¢ç»“æœä¸­å­˜åœ¨ä½†ç¬¬äºŒä¸ªæŸ¥è¯¢ç»“æœä¸­ä¸å­˜åœ¨çš„è®°å½•</span>
<span class="hljs-keyword">SELECT</span> department_id <span class="hljs-keyword">FROM</span> departments
MINUS
<span class="hljs-keyword">SELECT</span> department_id <span class="hljs-keyword">FROM</span> employees;
</code></pre>
<h2 data-id="heading-39">4.9 æœ¬ç« å°ç»“</h2>
<p>æœ¬ç« è¯¦ç»†ä»‹ç»äº†Oracleæ•°æ®åº“ä¸­çš„åŸºæœ¬æŸ¥è¯¢æ“ä½œï¼ŒåŒ…æ‹¬SELECTè¯­å¥çš„ä½¿ç”¨ã€WHEREæ¡ä»¶ç­›é€‰ã€æ’åºã€å‡½æ•°ä½¿ç”¨ã€åˆ†ç»„æŸ¥è¯¢ã€å¤šè¡¨è¿æ¥ã€å­æŸ¥è¯¢å’Œé›†åˆæ“ä½œç­‰ã€‚æŒæ¡è¿™äº›æŸ¥è¯¢æŠ€èƒ½æ˜¯è¿›è¡Œæ•°æ®åˆ†æå’ŒæŠ¥è¡¨ç”Ÿæˆçš„åŸºç¡€ã€‚</p>
<h2 data-id="heading-40">ç»ƒä¹ é¢˜</h2>
<ol>
<li>æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥çš„å§“åã€é‚®ç®±å’Œè–ªèµ„ï¼Œå¹¶æŒ‰è–ªèµ„é™åºæ’åˆ—</li>
<li>æŸ¥è¯¢è–ªèµ„åœ¨10000åˆ°20000ä¹‹é—´çš„å‘˜å·¥ä¿¡æ¯</li>
<li>æŸ¥è¯¢å§“æ°ä»¥'S'å¼€å¤´çš„å‘˜å·¥</li>
<li>æŸ¥è¯¢æ²¡æœ‰ä½£é‡‘çš„å‘˜å·¥æ•°é‡</li>
<li>æŒ‰éƒ¨é—¨ç»Ÿè®¡å‘˜å·¥æ•°é‡å’Œå¹³å‡è–ªèµ„</li>
<li>æŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨è–ªèµ„æœ€é«˜çš„å‘˜å·¥ä¿¡æ¯</li>
<li>æŸ¥è¯¢å‘˜å·¥å§“ååŠå…¶ç®¡ç†è€…å§“å</li>
<li>ä½¿ç”¨é›†åˆæ“ä½œæŸ¥è¯¢åœ¨éƒ¨é—¨60æˆ–éƒ¨é—¨90å·¥ä½œä½†ä¸åœ¨éƒ¨é—¨100å·¥ä½œçš„å‘˜å·¥</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[pnpm approve-buildsæŠ¥é”™]]></title>    <link>https://juejin.cn/post/7579872561675730953</link>    <guid>https://juejin.cn/post/7579872561675730953</guid>    <pubDate>2025-12-05T02:58:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579872561675730953" data-draft-id="7579906040537481262" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="pnpm approve-buildsæŠ¥é”™"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-05T02:58:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="mouseliu"/> <meta itemprop="url" content="https://juejin.cn/user/4040060859320432"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            pnpm approve-buildsæŠ¥é”™
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4040060859320432/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    mouseliu
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T02:58:56.000Z" title="Fri Dec 05 2025 02:58:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>é¦–æ¬¡å®‰è£…ä¾èµ–æˆ–æŸäº›ä¾èµ–çš„æ„å»ºè„šæœ¬è¢«å¿½ç•¥æ—¶ï¼Œpnpm ä¼šæ‹¦æˆªè¿™äº›è„šæœ¬çš„è‡ªåŠ¨æ‰§è¡Œï¼Œå¹¶æç¤ºæ‚¨è¿è¡ŒÂ <code>pnpm approve-builds</code>Â æ¥é€‰æ‹©å…è®¸å“ªäº›åŒ…è¿è¡Œè„šæœ¬ã€‚è¿™é€šå¸¸å‘ç”Ÿåœ¨é¡¹ç›®ä¾èµ–ä¸­åŒ…å«å¯èƒ½æ‰§è¡Œæ•æ„Ÿæ“ä½œçš„åŒ…æ—¶</p>
<h3 data-id="heading-0">1. â€Œ<strong>pnpm å®‰å…¨æœºåˆ¶</strong>â€Œ</h3>
<ul>
<li>â€Œ<strong>é»˜è®¤è¡Œä¸º</strong>â€Œï¼špnpm ä¼šæ‹¦æˆªÂ <code>postinstall</code>Â ç­‰æ•æ„Ÿè„šæœ¬ï¼Œé˜²æ­¢è‡ªåŠ¨æ‰§è¡Œæ½œåœ¨æ¶æ„ä»£ç 3ã€‚è¿™å¯¼è‡´ä¾èµ–åŒ…çš„æ„å»ºè„šæœ¬ï¼ˆå¦‚Â <code>core-js</code>ã€<code>esbuild</code>ï¼‰è¢«å¿½ç•¥ã€‚</li>
<li>â€Œ<strong>è§¦å‘æ¡ä»¶</strong>â€Œï¼šå½“å®‰è£…çš„ä¾èµ–åŒ…åŒ…å«æ„å»ºè„šæœ¬æ—¶ï¼Œpnpm ä¼šæç¤ºéœ€è¦æ‰‹åŠ¨æ‰¹å‡†23ã€‚</li>
</ul>
<h3 data-id="heading-1">2. â€Œ<strong>å·®å¼‚åŸå› </strong>â€Œ</h3>
<ul>
<li>
<p>â€Œ<strong>ç¯å¢ƒå·®å¼‚</strong>â€Œï¼šå¦ä¸€ä¸ªé¡¹ç›®å¯èƒ½æœªè§¦å‘æ­¤å®‰å…¨æœºåˆ¶ï¼ŒåŸå› å¯èƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li>â€Œ<strong>ä¾èµ–åŒ…ä¸åŒ</strong>â€Œï¼šæœªåŒ…å«Â <code>core-js</code>ã€<code>esbuild</code>Â ç­‰éœ€è¦æ„å»ºè„šæœ¬çš„ä¾èµ–2ã€‚</li>
<li>â€Œ<strong>pnpm ç‰ˆæœ¬å·®å¼‚</strong>â€Œï¼šæ—§ç‰ˆæœ¬ pnpm å¯èƒ½æœªå¯ç”¨æ­¤å®‰å…¨ç‰¹æ€§2ã€‚</li>
<li>â€Œ<strong>é…ç½®å·®å¼‚</strong>â€Œï¼šé¡¹ç›®æ ¹ç›®å½•å­˜åœ¨Â <code>.npmrc</code>Â æ–‡ä»¶ï¼Œé…ç½®äº†Â <code>allowed-dep-scripts</code>Â å‚æ•°å…è®¸ç‰¹å®šä¾èµ–è„šæœ¬è¿è¡Œ45ã€‚</li>
<li>â€Œ<strong>CI/CD ç¯å¢ƒ</strong>â€Œï¼šCI ç¯å¢ƒå¯èƒ½é€šè¿‡ç¯å¢ƒå˜é‡ï¼ˆå¦‚Â <code>CI=true</code>ï¼‰æˆ–è„šæœ¬ï¼ˆå¦‚Â <code>pnpm approve-builds</code>ï¼‰è‡ªåŠ¨æ‰¹å‡†æ„å»ºè„šæœ¬36ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-2">3. â€Œ<strong>è§£å†³æ–¹æ¡ˆ</strong>â€Œ</h3>
<ul>
<li>â€Œ<strong>ä¸´æ—¶å…è®¸</strong>â€Œï¼šåœ¨å®‰è£…å‘½ä»¤åæ·»åŠ Â <code>--unsafe-perm</code>Â å‚æ•°ï¼ˆä¸æ¨èï¼ŒèŒƒå›´å¤ªå¹¿ï¼‰4ã€‚</li>
<li>â€Œ<strong>æ°¸ä¹…é…ç½®</strong>â€Œï¼šåœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºÂ <code>.npmrc</code>Â æ–‡ä»¶ï¼Œæ·»åŠ Â <code>allowed-dep-scripts=core-js,esbuild</code>45ã€‚</li>
<li>â€Œ<strong>æ‰‹åŠ¨æ‰¹å‡†</strong>â€Œï¼šè¿è¡ŒÂ <code>pnpm approve-builds</code>Â å‘½ä»¤ï¼Œäº¤äº’å¼é€‰æ‹©å…è®¸çš„ä¾èµ–ï¼ˆè¾“å…¥Â <code>a</code>Â å…è®¸å…¨éƒ¨ï¼‰26ã€‚</li>
</ul>
<h3 data-id="heading-3">4. â€Œ<strong>å®‰å…¨å»ºè®®</strong>â€Œ</h3>
<ul>
<li>â€Œ<strong>é£é™©è¯„ä¼°</strong>â€Œï¼šç¡®ä¿æ‰¹å‡†çš„æ„å»ºè„šæœ¬ï¼ˆå¦‚Â <code>core-js</code>ã€<code>esbuild</code>ï¼‰æ¥è‡ªå¯ä¿¡æ¥æº3ã€‚</li>
<li>â€Œ<strong>ç‰ˆæœ¬æ›´æ–°</strong>â€Œï¼šæ£€æŸ¥ pnpm æ˜¯å¦ä¸ºæœ€æ–°ç‰ˆæœ¬ï¼Œæ—§ç‰ˆæœ¬å¯èƒ½å­˜åœ¨å®‰å…¨æ¼æ´2ã€‚</li>
</ul>
<h3 data-id="heading-4">è§£å†³æ­¥éª¤</h3>
<ol>
<li>
<p>â€Œ<strong>è¿è¡Œå‘½ä»¤</strong>â€Œï¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-css" lang="css">bashCopy <span class="hljs-selector-tag">Code</span>
pnpm approve-builds
</code></pre>
<p>æ‰§è¡Œåï¼Œç»ˆç«¯ä¼šè¿›å…¥ä¸€ä¸ªäº¤äº’å¼ç•Œé¢ï¼Œåˆ—å‡ºè¢«å¿½ç•¥çš„ä¾èµ–åŒ…ï¼ˆä¾‹å¦‚Â <code>core-js</code>ã€<code>esbuild</code>ã€<code>@vue-office/docx</code>Â ç­‰ï¼‰ã€‚â€Œ12</p>
</li>
<li>
<p>â€Œ<strong>é€‰æ‹©ä¾èµ–</strong>â€Œï¼š</p>
<ul>
<li>â€Œ<strong>å…è®¸å…¨éƒ¨ä¾èµ–</strong>â€Œï¼šç›´æ¥è¾“å…¥Â <code>a</code>ï¼ˆä»£è¡¨ allï¼‰ï¼Œç„¶åæŒ‰å›è½¦ã€‚è¿™æ˜¯æœ€å¿«æ·çš„æ–¹å¼ï¼Œé€‚ç”¨äºæ‚¨ä¿¡ä»»æ‰€æœ‰åˆ—å‡ºçš„åŒ…ã€‚â€Œ24</li>
<li>â€Œ<strong>é€‰æ‹©æ€§å…è®¸</strong>â€Œï¼šä½¿ç”¨ç©ºæ ¼é”®ï¼ˆ<code>Â </code>ï¼‰å‹¾é€‰ç‰¹å®šåŒ…ï¼Œå†æŒ‰å›è½¦ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåªä¿¡ä»»Â <code>core-js</code>Â å’ŒÂ <code>esbuild</code>ï¼Œå¯å‹¾é€‰å®ƒä»¬åç¡®è®¤ã€‚â€Œ12</li>
</ul>
</li>
<li>
<p>â€Œ<strong>é‡æ–°å®‰è£…å¹¶æ„å»º</strong>â€Œï¼š<br/>
å®Œæˆé€‰æ‹©åï¼Œé‡æ–°å®‰è£…ä¾èµ–å¹¶è¿è¡Œæ„å»ºï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">bashCopy Code
pnpm install &amp;&amp; pnpm run build
</code></pre>
<p>è¢«æ‰¹å‡†çš„ä¾èµ–å°†æ­£å¸¸æ‰§è¡Œè„šæœ¬ï¼Œæ„å»ºåº”æˆåŠŸã€‚â€Œâ€Œ</p>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è°·æ­ŒADKå®æˆ˜ï¼š3ç§æ–¹æ³•æ‰“é€ AIæ™ºèƒ½ä½“]]></title>    <link>https://juejin.cn/post/7579871631095939098</link>    <guid>https://juejin.cn/post/7579871631095939098</guid>    <pubDate>2025-12-04T15:04:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579871631095939098" data-draft-id="7579871631095922714" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è°·æ­ŒADKå®æˆ˜ï¼š3ç§æ–¹æ³•æ‰“é€ AIæ™ºèƒ½ä½“"/> <meta itemprop="keywords" content="Python,Go"/> <meta itemprop="datePublished" content="2025-12-04T15:04:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº‘äº‘ä¼—ç”Ÿs"/> <meta itemprop="url" content="https://juejin.cn/user/380845430158739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è°·æ­ŒADKå®æˆ˜ï¼š3ç§æ–¹æ³•æ‰“é€ AIæ™ºèƒ½ä½“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/380845430158739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº‘äº‘ä¼—ç”Ÿs
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T15:04:39.000Z" title="Thu Dec 04 2025 15:04:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Google ADKæ˜¯æ„å»ºAIä»£ç†çš„åŸºç¡€æ¡†æ¶ï¼Œæ”¯æŒPythonã€YAMLå’Œå¯è§†åŒ–æ„å»ºå™¨ä¸‰ç§å¼€å‘æ–¹å¼ï¼Œæä¾›çµæ´»æ€§å’Œæ§åˆ¶åŠ›ï¼Œå¯ç”¨äºåˆ›å»ºå¤šä»£ç†ç³»ç»Ÿã€‚</p>
<blockquote>
<p>è¯‘è‡ªï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fthenewstack.io%2Fhow-to-build-ai-agents-3-ways-with-google-adk%2F" target="_blank" title="https://thenewstack.io/how-to-build-ai-agents-3-ways-with-google-adk/" ref="nofollow noopener noreferrer">How To Build AI Agents 3 Ways With Google ADK</a></p>
<p>ä½œè€…ï¼šJanakiram MSV</p>
</blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.google.com%2F%3Futm_content%3Dinline%2Bmention" target="_blank" title="https://cloud.google.com/?utm_content=inline+mention" ref="nofollow noopener noreferrer">Google</a> çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgoogle.github.io%2Fadk-docs%2F" target="_blank" title="https://google.github.io/adk-docs/" ref="nofollow noopener noreferrer">Agent Development Kit</a> (ADK) å·²è¿…é€Ÿæˆä¸ºæ„å»º AI ä»£ç†çš„åŸºç¡€æ¡†æ¶ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fthenewstack.io%2Fgoogles-adk-is-a-new-open-source-framework-for-building-multiagent-systems%2F" target="_blank" title="https://thenewstack.io/googles-adk-is-a-new-open-source-framework-for-building-multiagent-systems/" ref="nofollow noopener noreferrer">åœ¨ Google Cloud NEXT 2025 å¤§ä¼šä¸Šæ¨å‡º</a>åï¼ŒADK åœ¨ Google äº§å“ï¼ˆåŒ…æ‹¬ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.google.com%2Fgemini-enterprise%3Futm_source%3Dgoogle%26utm_medium%3Dcpc%26utm_campaign%3D1710070-Workspace-DR-APAC-IN-en-Google-BKWS-EXA-Pollux%26utm_content%3Dc-Hybrid%2B%257C%2BBKWS%2B-%2BEXA%2B%257C%2BTxt-Pollux-Generic-435278751514%26utm_term%3Dgemini%2Benterprise%26gclsrc%3Daw.ds%26gad_source%3D1%26gad_campaignid%3D23080541881%26gclid%3DCjwKCAiA55rJBhByEiwAFkY1QGdZPP5s9wkpjdS3nzYfKqlrtfqicVSrvS5P13nnCq3dXyHtXPigwhoC2fkQAvD_BwE%26hl%3Den" target="_blank" title="https://cloud.google.com/gemini-enterprise?utm_source=google&amp;utm_medium=cpc&amp;utm_campaign=1710070-Workspace-DR-APAC-IN-en-Google-BKWS-EXA-Pollux&amp;utm_content=c-Hybrid+%7C+BKWS+-+EXA+%7C+Txt-Pollux-Generic-435278751514&amp;utm_term=gemini+enterprise&amp;gclsrc=aw.ds&amp;gad_source=1&amp;gad_campaignid=23080541881&amp;gclid=CjwKCAiA55rJBhByEiwAFkY1QGdZPP5s9wkpjdS3nzYfKqlrtfqicVSrvS5P13nnCq3dXyHtXPigwhoC2fkQAvD_BwE&amp;hl=en" ref="nofollow noopener noreferrer">Gemini ä¼ä¸šç‰ˆ</a> å’Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.google.com%2Fsolutions%2Fcustomer-engagement-ai%3Fhl%3Den" target="_blank" title="https://cloud.google.com/solutions/customer-engagement-ai?hl=en" ref="nofollow noopener noreferrer">Google å®¢æˆ·äº’åŠ¨å¥—ä»¶</a>ï¼‰ä¸­ä¸ºä»£ç†æä¾›æ”¯æŒã€‚ADK å¯¹å¼€å‘äººå‘˜ç‰¹åˆ«æœ‰å¸å¼•åŠ›çš„åœ°æ–¹åœ¨äºå…¶çµæ´»æ€§ã€‚å¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨ Python ä»£ç ã€YAML é…ç½®æ–‡ä»¶æˆ–æ‹–æ”¾å¼å¯è§†åŒ–ç•Œé¢æ„å»ºä»£ç†â€”â€”å…·ä½“å–å†³äºå·¥ä½œæµåå¥½å’Œç”¨ä¾‹è¦æ±‚ã€‚</p>
<p>åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†å¼•å¯¼æ‚¨é€šè¿‡è¿™ä¸‰ç§æ–¹æ³•æ„å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªâ€œHello Worldâ€ADK ä»£ç†ã€‚æœ€åï¼Œæ‚¨å°†æ‹¥æœ‰ä¸€ä¸ªä½¿ç”¨æ¯ç§æ–¹æ³•åœ¨æœ¬åœ°è¿è¡Œçš„åŠŸèƒ½æ€§ä»£ç†ï¼Œä¸ºæ‚¨é€‰æ‹©é€‚åˆè‡ªå·±é¡¹ç›®çš„æ–¹æ³•å¥ å®šåŸºç¡€ã€‚</p>
<h2 data-id="heading-0">ç†è§£ä¸‰ç§æ–¹æ³•</h2>
<p>åœ¨æ·±å…¥å®æ–½ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆäº†è§£æ¯ç§æ–¹æ³•æä¾›çš„åŠŸèƒ½ï¼š</p>
<p><strong>å‘½ä»¤å¼ä»£ç† (Python)ï¼š</strong> è¿™ç§ä»£ç ä¼˜å…ˆçš„æ–¹æ³•ä¸ºæ‚¨æä¾›äº†æœ€å¤§çš„çµæ´»æ€§å’Œæ§åˆ¶åŠ›ã€‚æ‚¨ç›´æ¥åœ¨ Python ä¸­å®šä¹‰ä»£ç†é€»è¾‘ã€å·¥å…·å’Œç¼–æ’ï¼Œè¿™ä½¿å…¶æˆä¸ºéœ€è¦è‡ªå®šä¹‰é€»è¾‘ã€ä¸ç°æœ‰ä»£ç åº“é›†æˆæˆ–å¤æ‚å¤šä»£ç†ç³»ç»Ÿçš„å¤æ‚ä»£ç†çš„ç†æƒ³é€‰æ‹©ã€‚Python æ–¹æ³•è¿˜é€šè¿‡ LiteLLM é›†æˆæ”¯æŒä»»ä½•å¤§å‹è¯­è¨€æ¨¡å‹ (LLM)ã€‚</p>
<p><strong>å£°æ˜å¼ä»£ç† (YAML)ï¼š</strong> è¯¥æ–¹æ³•äº 2025 å¹´ 8 æœˆéš Agent Config åŠŸèƒ½æ¨å‡ºï¼Œå…è®¸æ‚¨ä½¿ç”¨ YAML é…ç½®æ–‡ä»¶å®šä¹‰ä»£ç†ã€‚å®ƒå‡å°‘äº†æ ·æ¿ä»£ç ï¼Œä½¿ä»£ç†æ›´æ˜“äºä¸€ç›®äº†ç„¶åœ°ç†è§£â€”â€”å¯¹äºæ›´ç®€å•çš„ä»£ç†æˆ–å½“æ‚¨å¸Œæœ›éå¼€å‘äººå‘˜ç†è§£ä»£ç†è¡Œä¸ºæ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚</p>
<p><strong>å¯è§†åŒ–ä»£ç†æ„å»ºå™¨ (GUI)ï¼š</strong> Visual Agent Builder åœ¨ ADK v1.18.0 ä¸­æ¨å‡ºï¼Œæ˜¯ä¸€ä¸ªåŸºäºæµè§ˆå™¨çš„ IDEï¼Œå®ƒç»“åˆäº†å¯è§†åŒ–å·¥ä½œæµè®¾è®¡å™¨ã€é…ç½®é¢æ¿å’Œ AI åŠ©æ‰‹ã€‚æ‚¨å¯ä»¥é€šè¿‡æ‹–æ”¾äº¤äº’å’Œè‡ªç„¶è¯­è¨€å¯¹è¯è®¾è®¡å¤šä»£ç†ç³»ç»Ÿï¼Œè¯¥å·¥å…·ä¼šåœ¨å¹•åç”Ÿæˆæ­£ç¡®çš„ YAML é…ç½®ã€‚</p>
<h2 data-id="heading-1">å‰ææ¡ä»¶</h2>
<p>å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨å…·å¤‡ä»¥ä¸‹æ¡ä»¶ï¼š</p>
<ul>
<li>Python 3.10 æˆ–æ›´é«˜ç‰ˆæœ¬</li>
<li>ä»£ç ç¼–è¾‘å™¨</li>
<li>ç»ˆç«¯è®¿é—®</li>
<li>Google AI Studio API å¯†é’¥æˆ–å·²å¯ç”¨ Vertex AI çš„ Google Cloud é¡¹ç›®</li>
</ul>
<h2 data-id="heading-2">æ­¥éª¤ 1ï¼šè®¾ç½®ç¯å¢ƒ</h2>
<p>é¦–å…ˆï¼Œåˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£… ADKã€‚æ‰“å¼€æ‚¨çš„ç»ˆç«¯å¹¶è¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python -m venv .venv
<span class="hljs-built_in">source</span> .venv/bin/activate  
</code></pre>
<p>å®‰è£… ADK åŒ…ï¼š</p>
<pre><code class="hljs">pip install google-adk
</code></pre>
<p>éªŒè¯å®‰è£…ï¼š</p>
<pre><code class="hljs language-css" lang="css">adk <span class="hljs-attr">--version</span>
</code></pre>
<p>æ‚¨åº”è¯¥ä¼šçœ‹åˆ°å·²å®‰è£…çš„ ADK ç‰ˆæœ¬ï¼ˆVisual Agent Builder éœ€è¦ 1.18.0 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚</p>
<h2 data-id="heading-3">æ­¥éª¤ 2ï¼šé…ç½®æ¨¡å‹è®¿é—®</h2>
<p>ADK éœ€è¦è®¿é—® LLMã€‚æœ€ç®€å•çš„å…¥é—¨é€‰é¡¹æ˜¯ä½¿ç”¨å¸¦æœ‰å…è´¹ API å¯†é’¥çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Faistudio.google.com%2F" target="_blank" title="https://aistudio.google.com/" ref="nofollow noopener noreferrer">Google AI Studio</a>ã€‚ä» Google AI Studio è·å–æ‚¨çš„ API å¯†é’¥å¹¶ä¿æŒå…¶å¯è®¿é—®æ€§ï¼Œå› ä¸ºåœ¨æ¥ä¸‹æ¥çš„æ­¥éª¤ä¸­æ‚¨ä¼šç”¨åˆ°å®ƒã€‚</p>
<h2 data-id="heading-4">æ–¹æ³• 1ï¼šä½¿ç”¨ Python æ„å»ºå‘½ä»¤å¼ä»£ç†</h2>
<p>å‘½ä»¤å¼æ–¹æ³•æ˜¯æœ€å¼ºå¤§çš„æ–¹æ³•ï¼Œé€šè¿‡ä»£ç è®©æ‚¨å®Œå…¨æ§åˆ¶ä»£ç†è¡Œä¸ºã€‚è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªç®€å•çš„é—®å€™ä»£ç†ï¼Œæ¼”ç¤ºå…¶æ ¸å¿ƒæ¦‚å¿µã€‚</p>
<h3 data-id="heading-5"><strong>åˆ›å»ºé¡¹ç›®ç»“æ„</strong></h3>
<p>ä¸ºæ‚¨çš„ä»£ç†é¡¹ç›®åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> hello_agent
<span class="hljs-built_in">cd</span> hello_agent
</code></pre>
<p>åœ¨ <code>hello_agent</code> ç›®å½•ä¸­åˆ›å»ºä»¥ä¸‹æ–‡ä»¶ï¼š</p>
<p><code>__init__.py</code></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> agent
</code></pre>
<p>æ­¤æ–‡ä»¶å°†ç›®å½•æ ‡è®°ä¸º Python åŒ…å¹¶å¯¼å…¥ä»£ç†æ¨¡å—ã€‚</p>
<p><code>agent.py</code></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> google.adk.agents <span class="hljs-keyword">import</span> Agent


<span class="hljs-keyword">def</span> <span class="hljs-title function_">greet_user</span>(<span class="hljs-params">name: <span class="hljs-built_in">str</span></span>) -&amp;gt; <span class="hljs-built_in">dict</span>:
    <span class="hljs-string">"""Greets a user by name.
    
    Args:
        name (str): The name of the user to greet.
        
    Returns:
        dict: A greeting message with status.
    """</span>
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"status"</span>: <span class="hljs-string">"success"</span>,
        <span class="hljs-string">"message"</span>: <span class="hljs-string">f"Hello, <span class="hljs-subst">{name}</span>! Welcome to Google ADK. I'm your first AI agent!"</span>
    }


<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_agent_info</span>() -&amp;gt; <span class="hljs-built_in">dict</span>:
    <span class="hljs-string">"""Returns information about this agent.
    
    Returns:
        dict: Information about the agent's capabilities.
    """</span>
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"status"</span>: <span class="hljs-string">"success"</span>,
        <span class="hljs-string">"info"</span>: <span class="hljs-string">"I am a Hello World agent built with Google ADK using Python. "</span>
                <span class="hljs-string">"I can greet users and tell them about myself."</span>
    }


root_agent = Agent(
    name=<span class="hljs-string">"hello_agent"</span>,
    model=<span class="hljs-string">"gemini-2.0-flash"</span>,
    description=<span class="hljs-string">"A friendly greeting agent that welcomes users to Google ADK."</span>,
    instruction=<span class="hljs-string">"""You are a friendly and helpful greeting agent. Your primary purpose is to:
    1. Greet users warmly when they provide their name using the greet_user tool
    2. Explain what you are when asked using the get_agent_info tool
    3. Be enthusiastic about introducing users to Google ADK
    
    Always use the available tools to respond appropriately to user requests."""</span>,
    tools=[greet_user, get_agent_info],
)
</code></pre>
<p>Agent ç±»æ˜¯ ADK ä¸­çš„æ ¸å¿ƒæ„å»ºå—ã€‚è¯·æ³¨æ„æˆ‘ä»¬å¦‚ä½•å°†å·¥å…·å®šä¹‰ä¸ºå¸¦æœ‰ç±»å‹æç¤ºå’Œæ–‡æ¡£å­—ç¬¦ä¸²çš„æ™®é€š Python å‡½æ•°ã€‚ADK ä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥å¸®åŠ© LLM ç†è§£ä½•æ—¶ä»¥åŠå¦‚ä½•è°ƒç”¨æ¯ä¸ªå·¥å…·ã€‚</p>
<p><code>.env</code></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">GOOGLE_GENAI_USE_VERTEXAI</span>=<span class="hljs-number">0</span>
<span class="hljs-attr">GOOGLE_API_KEY</span>=YOUR_API_KEY_HERE
</code></pre>
<p>å°†å ä½ç¬¦å€¼æ›¿æ¢ä¸ºæ‚¨çš„å®é™…å‡­æ®ã€‚</p>
<h3 data-id="heading-6"><strong>è¿è¡Œä»£ç†</strong></h3>
<p>å¯¼èˆªåˆ°æ‚¨çš„ä»£ç†æ–‡ä»¶å¤¹çš„çˆ¶ç›®å½•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> ..
</code></pre>
<p>ä»¥ç»ˆç«¯æ¨¡å¼è¿è¡Œä»£ç†ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">adk run hello_agent
</code></pre>
<p>æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä¸€ä¸ªæç¤ºï¼ŒæŒ‡ç¤ºä»£ç†æ­£åœ¨è¿è¡Œï¼š</p>
<p><code>Running agent hello_agent, type exit to exit.   [user]:   Try these interactions:   [user]: Hello, my name is Jani   [user]: What can you do?   [user]: Tell me about yourself</code></p>
<p>ä»£ç†å°†ä½¿ç”¨é€‚å½“çš„å·¥å…·è¿›è¡Œå“åº”ã€‚è¾“å…¥ <code>exit</code> é€€å‡ºã€‚</p>
<h2 data-id="heading-7">æ–¹æ³• 2ï¼šä½¿ç”¨ YAML æ„å»ºå£°æ˜å¼ä»£ç†</h2>
<p>ä½¿ç”¨ YAML é…ç½®æ–‡ä»¶çš„å£°æ˜å¼æ–¹æ³•ç®€åŒ–äº†ä»£ç†çš„åˆ›å»ºï¼Œç‰¹åˆ«æ˜¯å¯¹äºç®€å•çš„ç”¨ä¾‹ã€‚Agent Config åŠŸèƒ½ç”Ÿæˆç›¸åŒçš„åº•å±‚ä»£ç†ç»“æ„ï¼Œä½†ä»£ç æ›´å°‘ã€‚</p>
<h3 data-id="heading-8"><strong>åˆ›å»ºåŸºäºé…ç½®çš„é¡¹ç›®</strong></h3>
<p>ä½¿ç”¨ ADK CLI ç”Ÿæˆä¸€ä¸ªåŸºäºé…ç½®çš„ä»£ç†é¡¹ç›®ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">adk create yaml_hello_agent <span class="hljs-attr">--type</span>=config
</code></pre>
<p>æ¥å—é»˜è®¤å€¼å¹¶å®Œæˆæ­¥éª¤ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcdn.thenewstack.io%2Fmedia%2F2025%2F11%2Fb94370f5-adk-1-0-1024x601.png" target="_blank" title="https://cdn.thenewstack.io/media/2025/11/b94370f5-adk-1-0-1024x601.png" ref="nofollow noopener noreferrer"><img src="https://cdn.thenewstack.io/media/2025/11/b94370f5-adk-1-0-1024x601.png" alt="" loading="lazy"/></a></p>
<h3 data-id="heading-9"><strong>åœ¨ YAML ä¸­å®šä¹‰ä»£ç†</strong></h3>
<p>æ‰“å¼€ <code>yaml_hello_agent/root_agent.yaml</code> å¹¶å°†å…¶å†…å®¹æ›¿æ¢ä¸ºï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">name:</span> hello_yaml_agent
<span class="hljs-symbol">model:</span> gemini-<span class="hljs-number">2.0</span>-flash
<span class="hljs-symbol">description:</span> A friendly greeting agent built <span class="hljs-keyword">with</span> YAML configuration.
<span class="hljs-symbol">instruction:</span> |
  You are a friendly <span class="hljs-built_in">and</span> helpful greeting agent. Your primary purpose <span class="hljs-built_in">is</span> <span class="hljs-keyword">to</span>:
  <span class="hljs-number">1</span>. Greet users warmly <span class="hljs-keyword">when</span> they provide their name <span class="hljs-keyword">using</span> the greet_user tool
  <span class="hljs-number">2</span>. Explain what you are <span class="hljs-keyword">when</span> asked <span class="hljs-keyword">using</span> the get_agent_info tool
  <span class="hljs-number">3</span>. Be enthusiastic about introducing users <span class="hljs-keyword">to</span> Google ADK
  
  Always use the available tools <span class="hljs-keyword">to</span> respond appropriately <span class="hljs-keyword">to</span> user requests.
<span class="hljs-symbol">tools:</span>
  - name: yaml_hello_agent.greet_user
  - name: yaml_hello_agent.get_agent_info
</code></pre>
<p>YAML ç»“æ„é•œåƒäº† Python Agent ç±»çš„å‚æ•°ï¼Œä½†ä»¥æ›´æ˜“è¯»çš„æ ¼å¼å‘ˆç°ã€‚è¯·æ³¨æ„å·¥å…·æ˜¯å¦‚ä½•é€šè¿‡å…¶æ¨¡å—è·¯å¾„å¼•ç”¨çš„ã€‚</p>
<h3 data-id="heading-10"><strong>åˆ›å»ºå·¥å…·æ¨¡å—</strong></h3>
<p>ADK YAML é…ç½®çš„ä¸€ä¸ªå¼ºå¤§åŠŸèƒ½æ˜¯æ‚¨å¯ä»¥æ··åˆä½¿ç”¨ Python ä»£ç ã€‚æ›´æ–° <code>yaml_hello_agent</code> æ–‡ä»¶å¤¹ä¸­çš„ <code>__init__.py</code> æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">greet_user</span>(<span class="hljs-params">name: <span class="hljs-built_in">str</span></span>) -&amp;gt; <span class="hljs-built_in">dict</span>:
    <span class="hljs-string">"""Greets a user by name.
    
    Args:
        name (str): The name of the user to greet.
        
    Returns:
        dict: A greeting message with status.
    """</span>
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"status"</span>: <span class="hljs-string">"success"</span>,
        <span class="hljs-string">"message"</span>: <span class="hljs-string">f"Hello, <span class="hljs-subst">{name}</span>! Welcome to Google ADK via YAML config!"</span>
    }


<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_agent_info</span>() -&amp;gt; <span class="hljs-built_in">dict</span>:
    <span class="hljs-string">"""Returns information about this agent.
    
    Returns:
        dict: Information about the agent's capabilities.
    """</span>
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"status"</span>: <span class="hljs-string">"success"</span>, 
        <span class="hljs-string">"info"</span>: <span class="hljs-string">"I am a Hello World agent built with YAML configuration. "</span>
                <span class="hljs-string">"I demonstrate the declarative approach to ADK agents."</span>
    }
</code></pre>
<p>æ‚¨çš„é¡¹ç›®ç»“æ„ç°åœ¨åº”è¯¥å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-bash" lang="bash">yaml_hello_agent/  
â”œâ”€â”€ root_agent.yaml  
â”œâ”€â”€ __init__.py  
â””â”€â”€ .<span class="hljs-built_in">env</span>
</code></pre>
<h3 data-id="heading-11"><strong>è¿è¡ŒåŸºäº YAML çš„ä»£ç†</strong></h3>
<p>å¯¼èˆªåˆ°çˆ¶ç›®å½•å¹¶è¿è¡Œï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">adk run yaml_hello_agent
</code></pre>
<p>ä½¿ç”¨ç›¸åŒçš„æç¤ºè¿›è¡Œæµ‹è¯•ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">[<span class="hljs-symbol">user</span>]: <span class="hljs-link">Hi, I'm Jani</span>
[<span class="hljs-symbol">user</span>]: <span class="hljs-link">What are you?</span>
</code></pre>
<p>ä»£ç†çš„å“åº”ä¸ Python ç‰ˆæœ¬ç›¸åŒï¼Œä½†å®Œå…¨é€šè¿‡é…ç½®å®šä¹‰ã€‚</p>
<h2 data-id="heading-12">æ–¹æ³• 3ï¼šä½¿ç”¨å¯è§†åŒ–ä»£ç†æ„å»ºå™¨æ„å»ºä»£ç†</h2>
<p>Visual Agent Builder åœ¨ ADK v1.18.0 ä¸­æ¨å‡ºï¼Œæ˜¯ä¸€ä¸ªåŸºäºæµè§ˆå™¨çš„ IDEï¼Œå®ƒæ”¹å˜äº†æ‚¨æ„å»ºä»£ç†çš„æ–¹å¼ã€‚å®ƒç»“åˆäº†å¯è§†åŒ–å·¥ä½œæµè®¾è®¡å™¨ã€é…ç½®é¢æ¿å’Œ AI åŠ©æ‰‹ï¼Œè®©æ‚¨å¯ä»¥é€šè¿‡æ‹–æ”¾äº¤äº’å’Œè‡ªç„¶è¯­è¨€å¯¹è¯è®¾è®¡ä»£ç†ã€‚</p>
<h3 data-id="heading-13"><strong>å¯åŠ¨å¯è§†åŒ–ä»£ç†æ„å»ºå™¨</strong></h3>
<p>ä»ä»»ä½•ç›®å½•è¿è¡Œï¼š</p>
<pre><code class="hljs">adk web
</code></pre>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcdn.thenewstack.io%2Fmedia%2F2025%2F11%2F4c9ef222-adk-1-1-1024x446.png" target="_blank" title="https://cdn.thenewstack.io/media/2025/11/4c9ef222-adk-1-1-1024x446.png" ref="nofollow noopener noreferrer"><img src="https://cdn.thenewstack.io/media/2025/11/4c9ef222-adk-1-1-1024x446.png" alt="" loading="lazy"/></a></p>
<p>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ <code>http://localhost:8000/dev-ui/</code> å³å¯è®¿é—® Visual Agent Builderã€‚</p>
<p>ç‚¹å‡»ä¸‹æ‹‰èœå•æ—è¾¹çš„â€œ+â€æŒ‰é’®ï¼Œè¾“å…¥åç§° <code>visual_hello_agent</code>ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcdn.thenewstack.io%2Fmedia%2F2025%2F11%2Fb5c12cc7-adk-1-2-1024x771.png" target="_blank" title="https://cdn.thenewstack.io/media/2025/11/b5c12cc7-adk-1-2-1024x771.png" ref="nofollow noopener noreferrer"><img src="https://cdn.thenewstack.io/media/2025/11/b5c12cc7-adk-1-2-1024x771.png" alt="" loading="lazy"/></a></p>
<p>ä¸å…¶æ‰‹åŠ¨é…ç½®ä»£ç†ï¼Œä¸å¦‚ä½¿ç”¨ AI åŠ©æ‰‹ã€‚åœ¨å³ä¾§é¢æ¿ä¸­ï¼Œè¾“å…¥ï¼š</p>
<p>`Create a simple greeting agent that can:</p>
<ol>
<li>Greet users by name when they introduce themselves</li>
<li>Tell users about itself when asked<br/>
Use gemini-2.5-flash as the model. Keep it simple with just two tools.`</li>
</ol>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcdn.thenewstack.io%2Fmedia%2F2025%2F11%2F71fbb3ba-adk-1-3-1024x563.png" target="_blank" title="https://cdn.thenewstack.io/media/2025/11/71fbb3ba-adk-1-3-1024x563.png" ref="nofollow noopener noreferrer"><img src="https://cdn.thenewstack.io/media/2025/11/71fbb3ba-adk-1-3-1024x563.png" alt="" loading="lazy"/></a></p>
<p>AI åŠ©æ‰‹å°†ç”Ÿæˆå®Œæ•´çš„ä»£ç†é…ç½®ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>é€‚å½“çš„ä»£ç†åç§°å’Œæè¿°</li>
<li>æ¨¡å‹é€‰æ‹©</li>
<li>è¯¦ç»†è¯´æ˜</li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcdn.thenewstack.io%2Fmedia%2F2025%2F11%2Ffb5ddcc9-adk-1-4-1024x563.png" target="_blank" title="https://cdn.thenewstack.io/media/2025/11/fb5ddcc9-adk-1-4-1024x563.png" ref="nofollow noopener noreferrer"><img src="https://cdn.thenewstack.io/media/2025/11/fb5ddcc9-adk-1-4-1024x563.png" alt="" loading="lazy"/></a></p>
<p>ç‚¹å‡»ä¿å­˜æŒ‰é’®ï¼Œç„¶åé€€å‡ºæ„å»ºå™¨æ¨¡å¼ã€‚æ‚¨ç°åœ¨å¯ä»¥ä¸ä»£ç†èŠå¤©äº†ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcdn.thenewstack.io%2Fmedia%2F2025%2F11%2Fd6c47e08-adk-1-5-1024x541.png" target="_blank" title="https://cdn.thenewstack.io/media/2025/11/d6c47e08-adk-1-5-1024x541.png" ref="nofollow noopener noreferrer"><img src="https://cdn.thenewstack.io/media/2025/11/d6c47e08-adk-1-5-1024x541.png" alt="" loading="lazy"/></a></p>
<h2 data-id="heading-14">æ¯”è¾ƒè¿™ä¸‰ç§æ–¹æ³•</h2>
<p>ä½¿ç”¨æ‰€æœ‰ä¸‰ç§æ–¹æ³•æ„å»ºä»£ç†åï¼Œä»¥ä¸‹æ˜¯å®ƒä»¬çš„æ¯”è¾ƒï¼š</p>





















































<table><thead><tr><th><strong>æ–¹é¢</strong></th><th><strong>å‘½ä»¤å¼ï¼ˆPythonï¼‰</strong></th><th><strong>å£°æ˜å¼ï¼ˆYAMLï¼‰</strong></th><th><strong>å¯è§†åŒ–æ„å»ºå™¨</strong></th></tr></thead><tbody><tr><td><strong>æœ€é€‚ç”¨äº</strong></td><td>å¤æ‚é€»è¾‘ï¼ŒCI/CD</td><td>ç®€å•ä»£ç†ï¼Œåä½œ</td><td>åŸå‹è®¾è®¡ï¼Œå­¦ä¹ </td></tr><tr><td><strong>å­¦ä¹ æ›²çº¿</strong></td><td>ä¸­ç­‰</td><td>ä½</td><td>æœ€ä½</td></tr><tr><td><strong>çµæ´»æ€§</strong></td><td>æœ€é«˜</td><td>ä¸­ç­‰</td><td>ä¸­ç­‰</td></tr><tr><td><strong>æ¨¡å‹æ”¯æŒ</strong></td><td>æ‰€æœ‰ï¼ˆé€šè¿‡ LiteLLMï¼‰</td><td>ä»…é™ Gemini</td><td>ä»…é™ Gemini</td></tr><tr><td><strong>ç‰ˆæœ¬æ§åˆ¶</strong></td><td>ä¼˜ç§€</td><td>ä¼˜ç§€</td><td>è‰¯å¥½ï¼ˆå¯å¯¼å‡º YAMLï¼‰</td></tr><tr><td><strong>éå¼€å‘äººå‘˜å‹å¥½</strong></td><td>å¦</td><td>éƒ¨åˆ†æ˜¯</td><td>æ˜¯</td></tr><tr><td><strong>è°ƒè¯•</strong></td><td>æ‰‹åŠ¨</td><td>æ‰‹åŠ¨</td><td>å†…ç½®è¿½è¸ª</td></tr></tbody></table>
<p>ä¸»è¦è€ƒè™‘å› ç´ ï¼š</p>
<ul>
<li>å½“æ‚¨éœ€è¦æœ€å¤§ç¨‹åº¦çš„æ§åˆ¶ã€è‡ªå®šä¹‰é›†æˆæˆ–é€šè¿‡ LiteLLM æ”¯æŒé Gemini æ¨¡å‹æ—¶ï¼Œ<strong>Python æ–¹æ³•</strong>æ˜¯æœ€ä½³é€‰æ‹©ã€‚</li>
<li><strong>YAML æ–¹æ³•</strong>é€‚ç”¨äºç®€å•çš„ä»£ç†ï¼Œæ‚¨å¸Œæœ›é…ç½®æ–‡ä»¶çš„ç®€æ´æ€§ï¼Œå¹¶èƒ½å¤Ÿæ··åˆä½¿ç”¨ Python å·¥å…·ã€‚</li>
<li><strong>å¯è§†åŒ–æ„å»ºå™¨</strong>æ“…é•¿å¿«é€ŸåŸå‹è®¾è®¡ã€å­¦ä¹  ADK æ¦‚å¿µä»¥åŠä¸èƒ½å¤Ÿç”¨è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚çš„éå¼€å‘äººå‘˜åä½œã€‚</li>
</ul>
<p>åœ¨å®è·µä¸­ï¼Œè¿™äº›æ–¹æ³•ç›¸è¾…ç›¸æˆã€‚æ‚¨å¯ä»¥ä½¿ç”¨å¯è§†åŒ–æ„å»ºå™¨è¿›è¡ŒåŸå‹è®¾è®¡å’Œç†è§£æ¶æ„ï¼Œç„¶åå¯¼å‡º YAML è¿›è¡Œç‰ˆæœ¬æ§åˆ¶å’Œ CI/CD ç®¡é“ã€‚</p>
<h2 data-id="heading-15">å±•æœ›æœªæ¥</h2>
<p>æœ¬æ•™ç¨‹æ¶µç›–äº†ä½¿ç”¨ Google ADK çš„ä¸‰ç§å¼€å‘æ–¹æ³•æ„å»ºæ‚¨çš„ç¬¬ä¸€ä¸ª AI ä»£ç†çš„åŸºæœ¬æ­¥éª¤ã€‚æ¯ç§æ–¹æ³•éƒ½æœ‰å…¶ä¼˜ç‚¹ï¼Œå¹¶ä¸”è¯¥æ¡†æ¶çš„è®¾è®¡æ—¨åœ¨è®©æ‚¨å¯ä»¥åœ¨å®ƒä»¬ä¹‹é—´æµç•…åˆ‡æ¢â€”â€”ä»å¯è§†åŒ–å¼€å§‹ï¼Œå¯¼å‡ºåˆ° YAMLï¼Œå¹¶åœ¨éœ€è¦é«˜çº§åŠŸèƒ½æ—¶è½¬å…¥ Pythonã€‚</p>
<p>åœ¨åç»­æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨ ADK çš„é«˜çº§åŠŸèƒ½ï¼ŒåŒ…æ‹¬å…·æœ‰é¡ºåºã€å¹¶è¡Œå’Œå¾ªç¯æ¨¡å¼çš„å¤šä»£ç†ç³»ç»Ÿã€ä¸æ¨¡å‹ä¸Šä¸‹æ–‡åè®® (MCP) æœåŠ¡å™¨çš„å·¥å…·é›†æˆã€ä¼šè¯ç®¡ç†å’Œå†…å­˜æŒä¹…åŒ–ï¼Œä»¥åŠéƒ¨ç½²åˆ° Vertex AI Agent Engineã€‚æ‚¨åœ¨è¿™é‡Œå»ºç«‹çš„åŸºç¡€å°†åœ¨æˆ‘ä»¬å¤„ç†æ—¥ç›Šå¤æ‚çš„ä»£ç†å·¥ä½œæµæ—¶ä¸ºæ‚¨æä¾›å¾ˆå¥½çš„å¸®åŠ©ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[InfluxDB 3 å…¥é—¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7579819594271752230</link>    <guid>https://juejin.cn/post/7579819594271752230</guid>    <pubDate>2025-12-04T15:06:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579819594271752230" data-draft-id="7579798332778528777" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="InfluxDB 3 å…¥é—¨æŒ‡å—"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-04T15:06:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¹»è±¡é»‘å…”"/> <meta itemprop="url" content="https://juejin.cn/user/3039466500930398"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            InfluxDB 3 å…¥é—¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3039466500930398/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¹»è±¡é»‘å…”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T15:06:59.000Z" title="Thu Dec 04 2025 15:06:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">ä»€ä¹ˆæ˜¯ InfluxDBï¼Ÿ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Finfluxdata%2Finfluxdb" target="_blank" title="https://github.com/influxdata/influxdb" ref="nofollow noopener noreferrer">InfluxDB</a> æ˜¯ä¸€ä¸ªå¼€æºçš„<strong>æ—¶åºæ•°æ®åº“ï¼ˆTime Series Database, TSDBï¼‰</strong>ï¼Œä¸“ä¸ºé«˜æ•ˆå¤„ç†æ—¶é—´åºåˆ—æ•°æ®è€Œè®¾è®¡ã€‚å®ƒé€‚ç”¨äºå®æ—¶æ•°æ®æ‘„å–ã€ç›‘æ§ç³»ç»Ÿã€ç‰©è”ç½‘ï¼ˆIoTï¼‰ä¼ æ„Ÿå™¨æ•°æ®å­˜å‚¨ä¸åˆ†æç­‰åœºæ™¯ã€‚</p>
<h3 data-id="heading-1">ä¸»è¦ç‰¹æ€§</h3>
<ul>
<li>ğŸš€ <strong>é«˜æ€§èƒ½å†™å…¥</strong>ï¼šæ”¯æŒé«˜ååæ•°æ®å†™å…¥</li>
<li>ğŸ” <strong>çµæ´»æŸ¥è¯¢</strong>ï¼šæ”¯æŒ SQL å’Œ InfluxQL</li>
<li>âš™ï¸ <strong>å¯æ‰©å±•æ¶æ„</strong>ï¼šæ”¯æŒæ’ä»¶æœºåˆ¶ï¼Œå¯è‡ªå®šä¹‰æ•°æ®å¤„ç†é€»è¾‘</li>
<li>ğŸ§© <strong>æ˜“äºé›†æˆ</strong>ï¼šæä¾›å¤šç§å®¢æˆ·ç«¯åº“ï¼ˆPythonã€Goã€JS ç­‰ï¼‰</li>
</ul>
<blockquote>
<p>ğŸ’¡ <strong>å…¸å‹åº”ç”¨åœºæ™¯</strong>ï¼šå·¥ä¸šç‰©è”ç½‘ä¼ æ„Ÿå™¨ç›‘æ§ã€æœåŠ¡å™¨æ€§èƒ½ç›‘æ§ï¼ˆCPU/å†…å­˜ï¼‰ã€ç¯å¢ƒç›‘æµ‹ï¼ˆæ¸©æ¹¿åº¦ã€COâ‚‚ï¼‰ç­‰ã€‚</p>
</blockquote>
<h2 data-id="heading-2">å¿«é€Ÿå®‰è£…</h2>
<ol>
<li>æ‹‰å–é•œåƒ</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">docker pull influxdb:3-core 
</code></pre>
<ol start="2">
<li>åˆ›å»ºç›®å½•å¹¶é…ç½®æƒé™</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> -p /opt/influxdb3/data 
<span class="hljs-built_in">mkdir</span> -p /opt/influxdb3/plugins 
<span class="hljs-built_in">chown</span> -R 1500:1500 /opt/influxdb3 <span class="hljs-comment"># å®¹å™¨å†…ç”¨æˆ· UID:GID ä¸º 1500:1500</span>
</code></pre>
<ol start="3">
<li>å¯åŠ¨å®¹å™¨</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">docker run -d -p 8181:8181 \
    --privileged=<span class="hljs-literal">true</span> \
    -v /opt/influxdb3/data:/var/lib/influxdb3/data \
    -v /opt/influxdb3/plugins:/var/lib/influxdb3/plugins \
    --name influxdb3 \
    influxdb:3-core influxdb3 serve \
        --node-id=influxdb3-master \
        --object-store=file \
        --data-dir=/var/lib/influxdb3/data \
        --plugin-dir=/var/lib/influxdb3/plugins 
</code></pre>
<p>4.éªŒè¯å®¹å™¨è¿è¡ŒçŠ¶æ€</p>
<pre><code class="hljs language-bash" lang="bash"> docker <span class="hljs-built_in">exec</span> -it influxdb3 /bin/bash <span class="hljs-comment"># è¿›å…¥å®¹å™¨</span>
 influxdb3 --version <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦æ­£å¸¸è¿è¡Œ</span>
</code></pre>
<h2 data-id="heading-3">ç”Ÿæˆtoken</h2>
<ol>
<li>åˆ›å»ºtoken</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">influxdb3 create token --admin
</code></pre>
<ol start="2">
<li>å°†tokenè®¾ç½®æˆç¯å¢ƒå˜é‡</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">export</span> TOKEN=[YOUR_TOKEN]  <span class="hljs-comment"># æ›¿æ¢ä¸ºå®é™…ç”Ÿæˆçš„Token</span>
</code></pre>
<ol start="3">
<li>éªŒè¯tokenæœ‰æ•ˆæ€§</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">influxdb3 show databases --token <span class="hljs-variable">$TOKEN</span> <span class="hljs-comment"># æŸ¥è¯¢æ•°æ®åº“åˆ—è¡¨</span>
</code></pre>
<h2 data-id="heading-4">InfluxDB è¡Œåè®®è¯¦è§£</h2>
<p>InfluxDB 3 ä¸ºé«˜å†™å…¥ååé‡è®¾è®¡äº†<strong>è¡Œåè®®</strong>ï¼Œè¿™æ˜¯ä¸€ç§é«˜æ•ˆä¸”æ˜“è¯»çš„å†™å…¥è¯­æ³•ï¼Œé¦–æ¬¡å†™å…¥æ•°æ®æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“ã€è¡¨åŠå¯¹åº” Schemaã€‚</p>
<h3 data-id="heading-5">è¡Œåè®®ç»“æ„</h3>
<p>ä¸€è¡Œå®Œæ•´çš„è¡Œåè®®æ•°æ®åŒ…å« 4 ä¸ªæ ¸å¿ƒéƒ¨åˆ†ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-plaintext" lang="plaintext">&lt;table&gt;,&lt;tag-set&gt; &lt;field-set&gt; &lt;timestamp&gt;
</code></pre>
<p>å„éƒ¨åˆ†è¯´æ˜ï¼š</p>
<ul>
<li><strong>table</strong>ï¼šè¡¨åï¼Œå¦‚ç¤ºä¾‹ä¸­çš„<code>myTable</code>ï¼›</li>
<li><strong>tag set</strong>ï¼šæ ‡ç­¾é”®å€¼å¯¹ï¼ˆé”®å’Œå€¼å‡ä¸ºå­—ç¬¦ä¸²ï¼‰ï¼Œå¤šä¸ªæ ‡ç­¾ç”¨é€—å·åˆ†éš”ï¼Œå¦‚<code>tag1=val1,tag2=val2</code>ï¼›</li>
<li><strong>field set</strong>ï¼šå­—æ®µé”®å€¼å¯¹ï¼Œæ”¯æŒçš„å­—æ®µç±»å‹æœ‰<code>string</code>ï¼ˆéœ€åŠ å¼•å·ï¼‰ã€<code>float</code>ã€<code>integer</code>ï¼ˆåç¼€<code>i</code>ï¼‰ã€<code>unsigned integer</code>ã€<code>boolean</code>ï¼Œå¤šä¸ªå­—æ®µç”¨é€—å·åˆ†éš”ï¼Œå¦‚<code>field1="v1",field2=1i</code>ï¼›</li>
<li><strong>timestamp</strong>ï¼šUnix æ—¶é—´æˆ³ï¼Œéœ€æŒ‡å®šç²¾åº¦ï¼ˆå¦‚ç§’ã€æ¯«ç§’ï¼‰ã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ca694a365184b4bb17c5575edcc5e9d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bm76LGh6buR5YWU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765466543&amp;x-signature=OX%2FU4dbRTkgdxgZ6Yf244YYdG%2B4%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-6">æ•°æ®å†™å…¥æ“ä½œ</h2>
<h3 data-id="heading-7">ä½¿ç”¨ CLI å†™å…¥æ•°æ®</h3>
<p>ä»¥å®¶åº­ç¯å¢ƒç›‘æ§æ•°æ®ä¸ºä¾‹ï¼Œå†™å…¥<code>home_environment</code>æ•°æ®åº“ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">influxdb3 write \
    --database home_environment\
    --token <span class="hljs-variable">$TOKEN</span>\
    --precision s \ <span class="hljs-comment"># æ—¶é—´æˆ³ç²¾åº¦ä¸ºç§’ </span>
<span class="hljs-string">'home,room=Living\ Room temp=21.1,hum=35.9,co=0i 1641024000
home,room=Kitchen temp=21.0,hum=35.9,co=0i 1641024000
home,room=Living\ Room temp=21.4,hum=35.9,co=0i 1641027600
home,room=Kitchen temp=23.0,hum=36.2,co=0i 1641027600
home,room=Living\ Room temp=21.8,hum=36.0,co=0i 1641031200
home,room=Kitchen temp=22.7,hum=36.1,co=0i 1641031200
home,room=Living\ Room temp=22.2,hum=36.0,co=0i 1641034800
home,room=Kitchen temp=22.4,hum=36.0,co=0i 1641034800
home,room=Living\ Room temp=22.2,hum=35.9,co=0i 1641038400
home,room=Kitchen temp=22.5,hum=36.0,co=0i 1641038400
home,room=Living\ Room temp=22.4,hum=36.0,co=0i 1641042000
home,room=Kitchen temp=22.8,hum=36.5,co=1i 1641042000
home,room=Living\ Room temp=22.3,hum=36.1,co=0i 1641045600
home,room=Kitchen temp=22.8,hum=36.3,co=1i 1641045600
home,room=Living\ Room temp=22.3,hum=36.1,co=1i 1641049200
home,room=Kitchen temp=22.7,hum=36.2,co=3i 1641049200
home,room=Living\ Room temp=22.4,hum=36.0,co=4i 1641052800
home,room=Kitchen temp=22.4,hum=36.0,co=7i 1641052800
home,room=Living\ Room temp=22.6,hum=35.9,co=5i 1641056400
home,room=Kitchen temp=22.7,hum=36.0,co=9i 1641056400
home,room=Living\ Room temp=22.8,hum=36.2,co=9i 1641060000
home,room=Kitchen temp=23.3,hum=36.9,co=18i 1641060000
home,room=Living\ Room temp=22.5,hum=36.3,co=14i 1641063600
home,room=Kitchen temp=23.1,hum=36.6,co=22i 1641063600
home,room=Living\ Room temp=22.2,hum=36.4,co=17i 1641067200
home,room=Kitchen temp=22.7,hum=36.5,co=26i 1641067200'</span>
</code></pre>
<h3 data-id="heading-8">ä½¿ç”¨Pythonå®¢æˆ·ç«¯å†™å…¥</h3>
<h4 data-id="heading-9">å®‰è£…ä¾èµ–</h4>
<pre><code class="hljs language-bash" lang="bash">uv pip install influxdb3-python
</code></pre>
<h4 data-id="heading-10">ç¼–å†™ä»£ç </h4>
<p>åˆ›å»º<code>influxdb_write.py</code>æ–‡ä»¶</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">from</span> influxdb_client_3 <span class="hljs-keyword">import</span> (
  Point, 
  InfluxDBError, 
  WriteOptions, 
  write_client_options, 
  InfluxDBClient3
)


points = [
  Point(<span class="hljs-string">'home'</span>)
    .tag(<span class="hljs-string">'room'</span>, <span class="hljs-string">'Bathroom'</span>)
    .field(<span class="hljs-string">'temp'</span>, <span class="hljs-number">25.5</span>)
    .field(<span class="hljs-string">'hum'</span>, <span class="hljs-number">50.0</span>)
    .field(<span class="hljs-string">'co'</span>, <span class="hljs-number">9</span>),
  Point(<span class="hljs-string">'home'</span>)
    .tag(<span class="hljs-string">'room'</span>, <span class="hljs-string">'Bedroom'</span>)
    .field(<span class="hljs-string">'temp'</span>, <span class="hljs-number">20.0</span>)
    .field(<span class="hljs-string">'hum'</span>, <span class="hljs-number">60.0</span>)
    .field(<span class="hljs-string">'co'</span>, <span class="hljs-number">10</span>)
]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">success</span>(<span class="hljs-params">self, data: <span class="hljs-built_in">str</span></span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Successfully wrote batch: data: <span class="hljs-subst">{data}</span>"</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">error</span>(<span class="hljs-params">self, data: <span class="hljs-built_in">str</span>, exception: InfluxDBError</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Failed writing batch: config: <span class="hljs-subst">{self}</span>, data: <span class="hljs-subst">{data}</span> due: <span class="hljs-subst">{exception}</span>"</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">retry</span>(<span class="hljs-params">self, data: <span class="hljs-built_in">str</span>, exception: InfluxDBError</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Failed retry writing batch: config: <span class="hljs-subst">{self}</span>, data: <span class="hljs-subst">{data}</span> retry: <span class="hljs-subst">{exception}</span>"</span>)


write_options = WriteOptions(
  batch_size=<span class="hljs-number">500</span>,
  flush_interval=<span class="hljs-number">10_000</span>,
  jitter_interval=<span class="hljs-number">2_000</span>,
  retry_interval=<span class="hljs-number">5_000</span>,
  max_retries=<span class="hljs-number">3</span>,
  max_retry_delay=<span class="hljs-number">30_000</span>,
  exponential_base=<span class="hljs-number">2</span>,
)

wco = write_client_options(
  success_callback=success,
  error_callback=error,
  retry_callback=retry,
  write_options=write_options,
)

<span class="hljs-keyword">with</span> InfluxDBClient3(
  host=<span class="hljs-string">'http://localhost:8181/'</span>,
  token=os.getenv(<span class="hljs-string">"INFLUXDB_TOKEN"</span>),
  database=<span class="hljs-string">'home_environment'</span>,
  write_client_options=wco
) <span class="hljs-keyword">as</span> client:
  client.write(points, write_precision=<span class="hljs-string">'s'</span>)
</code></pre>
<p>3.æ‰§è¡Œå†™å…¥</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">export</span> INFLUXDB_TOKEN=[YOUR_INFLUXDB_TOKEN] <span class="hljs-comment"># æ›¿æ¢ä¸ºå®é™…Token</span>
python influxdb_write.py
</code></pre>
<h2 data-id="heading-11">æ•°æ®åº“æŸ¥è¯¢æ“ä½œ</h2>
<p>InfluxDB 3 æ”¯æŒ<strong>SQL</strong>ï¼ˆæ¨èï¼ŒåŸºäº Apache Arrow DataFusion å¼•æ“ï¼‰å’Œ<strong>InfluxQL</strong>æŸ¥è¯¢ï¼Œä»¥ä¸‹ä»¥ SQL ä¸ºä¾‹æ¼”ç¤ºæŸ¥è¯¢æ“ä½œã€‚</p>
<h3 data-id="heading-12">ä½¿ç”¨ CLI æŸ¥è¯¢</h3>
<pre><code class="hljs language-bash" lang="bash">influxdb3 query \
  --database home_environment \
  --token <span class="hljs-variable">$TOKEN</span> \
  <span class="hljs-string">"SELECT * FROM home ORDER BY time"</span>
</code></pre>
<h3 data-id="heading-13">ä½¿ç”¨Pythonå®¢æˆ·ç«¯æŸ¥è¯¢</h3>
<p>åˆ›å»º<code>influxdb_query.py</code>æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">from</span> pyarrow <span class="hljs-keyword">import</span> Table
<span class="hljs-keyword">from</span> influxdb_client_3 <span class="hljs-keyword">import</span> (
  InfluxDBClient3
)


<span class="hljs-keyword">with</span> InfluxDBClient3(
  host=<span class="hljs-string">'http://localhost:8181/'</span>,
  token=os.getenv(<span class="hljs-string">"INFLUXDB_TOKEN"</span>),
  database=<span class="hljs-string">'home_environment'</span>
) <span class="hljs-keyword">as</span> client:
  query = <span class="hljs-string">"""
    SELECT * FROM home WHERE room = 'Bathroom'
  """</span>
  reader: Table = client.query(query=query, language=<span class="hljs-string">'sql'</span>)
  rows = reader.to_pylist()
  <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> rows:
    <span class="hljs-built_in">print</span>(row) <span class="hljs-comment"># æ‰“å°ä¸€è¡Œæ•°æ®</span>
</code></pre>
<h3 data-id="heading-14">å¸¸ç”¨SQLæŸ¥è¯¢ç¤ºä¾‹</h3>
<h4 data-id="heading-15">Schema æŸ¥è¯¢</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥è¯¢tables</span>
<span class="hljs-keyword">show</span> tables;

<span class="hljs-comment">-- æŸ¥è¯¢tableå­—æ®µ</span>
<span class="hljs-keyword">show</span> columns <span class="hljs-keyword">in</span> home;
</code></pre>
<h4 data-id="heading-16">åŸºç¡€æ•°æ®æŸ¥è¯¢</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥è¯¢è¡¨ä¸­æ‰€æœ‰æ•°æ®</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> home;

<span class="hljs-comment">-- æŒ‰æ—¶é—´è¿‡æ»¤æŸ¥è¯¢ï¼ˆè¿‘1å¤©æ•°æ®ï¼‰</span>
<span class="hljs-keyword">SELECT</span> temp, hum, room, <span class="hljs-type">time</span> <span class="hljs-keyword">FROM</span> home
<span class="hljs-keyword">WHERE</span> <span class="hljs-type">time</span> <span class="hljs-operator">&gt;=</span> now() <span class="hljs-operator">-</span> <span class="hljs-type">INTERVAL</span> <span class="hljs-string">'1 day'</span> <span class="hljs-keyword">AND</span> <span class="hljs-type">time</span> <span class="hljs-operator">&lt;=</span> now();
  
<span class="hljs-comment">-- æŒ‰æ ‡ç­¾æˆ–å­—æ®µè¿‡æ»¤</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> home <span class="hljs-keyword">WHERE</span> room <span class="hljs-operator">=</span> <span class="hljs-string">'Bathroom'</span> <span class="hljs-keyword">AND</span> temp <span class="hljs-operator">&gt;=</span> <span class="hljs-number">22.5</span>;
  
<span class="hljs-comment">-- å­—æ®µåˆ«å</span>
<span class="hljs-keyword">SELECT</span> temp <span class="hljs-string">'temperature'</span>, hum <span class="hljs-string">'humidity'</span> <span class="hljs-keyword">FROM</span> home;
</code></pre>
<h4 data-id="heading-17">èšåˆæŸ¥è¯¢</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- è®¡ç®—å¹³å‡æ¸©åº¦å’Œæ¹¿åº¦</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">AVG</span>(temp) <span class="hljs-keyword">AS</span> temperature, <span class="hljs-built_in">AVG</span>(hum) <span class="hljs-keyword">AS</span> humidity <span class="hljs-keyword">FROM</span> home;

<span class="hljs-comment">-- æŒ‰æˆ¿é—´åˆ†ç»„ï¼Œè·å–æ¯ä¸ªæˆ¿é—´çš„ç¬¬ä¸€æ¡æ¸©åº¦æ•°æ®</span>
<span class="hljs-comment">-- è¿”å›ç¤ºä¾‹ï¼š[{'time': Timestamp('2022-01-01 08:00:00'), 'temp': 21.0, 'room': 'Kitchen'}]</span>
<span class="hljs-keyword">SELECT</span> 
	selector_first(temp, <span class="hljs-type">time</span>)[<span class="hljs-string">'time'</span>] <span class="hljs-keyword">AS</span> <span class="hljs-type">time</span>, 
	selector_first(temp, <span class="hljs-type">time</span>)[<span class="hljs-string">'value'</span>] <span class="hljs-keyword">AS</span> temp, 
	room 
<span class="hljs-keyword">FROM</span> home <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> room;
</code></pre>
<h4 data-id="heading-18">ç±»å‹è½¬æ¢</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">CAST</span>(<span class="hljs-number">1234.5</span> <span class="hljs-keyword">AS</span> <span class="hljs-type">BIGINT</span>) <span class="hljs-keyword">AS</span> temp; <span class="hljs-comment">-- {'temp': 1234}</span>

<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1234.5</span>::<span class="hljs-type">BIGINT</span> <span class="hljs-keyword">AS</span> temp; <span class="hljs-comment">-- {'temp': 1234}</span>

<span class="hljs-comment">-- è½¬æ¢è¡¨ä¸­å­—æ®µç±»å‹</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">CAST</span>(<span class="hljs-type">time</span> <span class="hljs-keyword">AS</span> <span class="hljs-type">time</span>) <span class="hljs-keyword">AS</span> <span class="hljs-type">time</span>, <span class="hljs-built_in">CAST</span>(temp <span class="hljs-keyword">AS</span> <span class="hljs-type">integer</span>) <span class="hljs-keyword">AS</span> temp, room <span class="hljs-keyword">FROM</span> home;
</code></pre>
<h4 data-id="heading-19">é«˜çº§æ•°æ®åˆ†æ</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- è®¡ç®—åŒæˆ¿é—´ç›¸é‚»æ•°æ®çš„æ¸©å·®</span>
<span class="hljs-comment">-- LAG(temp, 1) è¡¨ç¤ºè·å–ä¸Šä¸€æ¡æ•°æ®çš„tempå€¼ï¼ˆç¬¬ä¸€è¡Œæ•°æ®temp_diffä¸ºç©ºï¼‰</span>
<span class="hljs-comment">-- LAG(temp, 1, 0) å¦‚æœæ˜¯ç¬¬ä¸€æ¡æ•°æ®åˆ™è¿”å›0</span>
<span class="hljs-comment">-- PARTITION BY room è¡¨ç¤ºæ ¹æ®æˆ¿é—´åˆ†å‰²æ•°æ®ã€‚ä¸ä¼šè·¨æˆ¿é—´è®¡ç®—</span>
<span class="hljs-comment">-- ORDER BY time æŒ‰æ—¶é—´é¡ºåºæ’åº</span>
<span class="hljs-keyword">SELECT</span> 
  <span class="hljs-type">time</span>,
  room,
  temp,
  temp <span class="hljs-operator">-</span> <span class="hljs-built_in">LAG</span>(temp, <span class="hljs-number">1</span>) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> room <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-type">time</span>) <span class="hljs-keyword">AS</span> temp_diff
<span class="hljs-keyword">FROM</span> home
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> room, <span class="hljs-type">time</span>;
  
<span class="hljs-comment">-- è®¡ç®—æ¸©åº¦çš„ç™¾åˆ†æ¯”å˜åŒ–ï¼ˆä¿ç•™2ä½å°æ•°ï¼‰</span>
<span class="hljs-keyword">SELECT</span> 
  <span class="hljs-type">time</span>,
  room,
  temp,
  ROUND(
    (temp <span class="hljs-operator">-</span> <span class="hljs-built_in">LAG</span>(temp, <span class="hljs-number">1</span>) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> room <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-type">time</span>)) <span class="hljs-operator">/</span> 
      <span class="hljs-built_in">LAG</span>(temp, <span class="hljs-number">1</span>) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> room <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-type">time</span>) <span class="hljs-operator">*</span> <span class="hljs-number">100</span>,
    <span class="hljs-number">2</span>
  ) <span class="hljs-keyword">AS</span> precent_change
<span class="hljs-keyword">FROM</span> 
  home
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
  room,
  <span class="hljs-type">time</span>;
</code></pre>
<h2 data-id="heading-20">è‡ªå®šä¹‰æ’ä»¶æ‰©å±•åŠŸèƒ½</h2>
<p>InfluxDB 3 æ”¯æŒ Python ç¼–å†™çš„æ’ä»¶å®ç°åŠŸèƒ½æ‰©å±•ï¼ˆå¦‚æ•°æ®è½¬æ¢ã€å®šæ—¶ä»»åŠ¡ï¼‰ï¼Œä»¥ä¸‹æ¼”ç¤ºç»Ÿè®¡<code>home</code>è¡¨å†™å…¥è¡Œæ•°çš„æ’ä»¶å¼€å‘æµç¨‹ã€‚</p>
<h3 data-id="heading-21">ç¼–å†™æ’ä»¶ä»£ç </h3>
<p>åœ¨<code>/opt/influxdb3/plugins</code>ï¼ˆæ’ä»¶æŒ‚è½½ç›®å½•ï¼‰ç›®å½•ä¸‹åˆ›å»º<code>test_plugin.py</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è¯¥æ’ä»¶è®°å½•æ¯æ¬¡å†™å…¥homeçš„æ•°æ®çš„è¡Œæ•°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">process_writes</span>(<span class="hljs-params">influxdb3_local, table_batches, args=<span class="hljs-literal">None</span></span>):
    <span class="hljs-comment"># Process data as it's written to the database</span>
    <span class="hljs-keyword">for</span> table_batch <span class="hljs-keyword">in</span> table_batches:
        table_name = table_batch[<span class="hljs-string">"table_name"</span>]
        rows = table_batch[<span class="hljs-string">"rows"</span>]
        
        <span class="hljs-comment"># Log information about the write</span>
        influxdb3_local.info(<span class="hljs-string">f"Processing <span class="hljs-subst">{<span class="hljs-built_in">len</span>(rows)}</span> rows from <span class="hljs-subst">{table_name}</span>"</span>)
        
        <span class="hljs-comment"># Write derived data back to the database</span>
        line = LineBuilder(<span class="hljs-string">"test_plugin"</span>)
        line.tag(<span class="hljs-string">"source_table"</span>, table_name)
        line.int64_field(<span class="hljs-string">"row_count"</span>, <span class="hljs-built_in">len</span>(rows))
        influxdb3_local.write(line)
</code></pre>
<h3 data-id="heading-22">åˆ›å»ºæ’ä»¶è§¦å‘å™¨</h3>
<pre><code class="hljs language-bash" lang="bash">influxdb3 create trigger\
  --trigger-spec <span class="hljs-string">"table:home"</span>\
  --plugin-filename <span class="hljs-string">"test_plugin.py"</span>\
  --database home_environment\
  --token <span class="hljs-variable">$TOKEN</span> \
  test_trigger
</code></pre>
<h3 data-id="heading-23">éªŒè¯æ’ä»¶æœ‰æ•ˆæ€§</h3>
<ol>
<li>å†æ¬¡å‘<code>home</code>è¡¨å†™å…¥æ•°æ®ï¼›</li>
<li>æŸ¥è¯¢<code>test_plugin</code>è¡¨ï¼ŒéªŒè¯ç»Ÿè®¡æ•°æ®æ˜¯å¦ç”Ÿæˆï¼š</li>
</ol>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> row_count, source_table <span class="hljs-keyword">FROM</span> test_plugin; 
<span class="hljs-comment">-- é¢„æœŸç»“æœï¼š{'row_count': 2, 'source_table': 'home'}</span>
</code></pre>
<h2 data-id="heading-24">å‚è€ƒæ–‡æ¡£</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.influxdata.com%2Finfluxdb3%2Fcore%2F" target="_blank" title="https://docs.influxdata.com/influxdb3/core/" ref="nofollow noopener noreferrer">InfluxDB 3 Core Documentation</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Finfluxdata%2Finfluxdb3_plugins" target="_blank" title="https://github.com/influxdata/influxdb3_plugins" ref="nofollow noopener noreferrer">influxdata/influxdb3_plugins: Python plugins for InfluxDB 3</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FInfluxCommunity%2Finfluxdb3-python" target="_blank" title="https://github.com/InfluxCommunity/influxdb3-python" ref="nofollow noopener noreferrer">InfluxCommunity/influxdb3-python: Python module that provides a simple and convenient way to interact with InfluxDB 3.0.</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[openEulerè·¨å¹³å°é€‚é…èƒ½åŠ›ä¸æ€§èƒ½å®æµ‹ï¼šå¼€ç®±å³ç”¨çš„å¤šæ¶æ„æ”¯æŒ]]></title>    <link>https://juejin.cn/post/7579808521204351010</link>    <guid>https://juejin.cn/post/7579808521204351010</guid>    <pubDate>2025-12-04T15:13:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579808521204351010" data-draft-id="7579813945601245224" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="openEulerè·¨å¹³å°é€‚é…èƒ½åŠ›ä¸æ€§èƒ½å®æµ‹ï¼šå¼€ç®±å³ç”¨çš„å¤šæ¶æ„æ”¯æŒ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-04T15:13:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è§£è¯»ç«ç‘°"/> <meta itemprop="url" content="https://juejin.cn/user/1489179674424810"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            openEulerè·¨å¹³å°é€‚é…èƒ½åŠ›ä¸æ€§èƒ½å®æµ‹ï¼šå¼€ç®±å³ç”¨çš„å¤šæ¶æ„æ”¯æŒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1489179674424810/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è§£è¯»ç«ç‘°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T15:13:27.000Z" title="Thu Dec 04 2025 15:13:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å¼•è¨€</h2>
<p>ç°ä»£æ•°æ®ä¸­å¿ƒå‘ˆç°æ¶æ„å¤šæ ·åŒ–è¶‹åŠ¿ï¼Œx86ã€ARMã€RISC-Vç­‰ä¸åŒæ¶æ„æœåŠ¡å™¨å¹¶å­˜å·²æˆå¸¸æ€ã€‚æ“ä½œç³»ç»Ÿçš„è·¨å¹³å°èƒ½åŠ›ç›´æ¥å½±å“ä¼ä¸šæŠ€æœ¯é€‰å‹çš„çµæ´»æ€§ã€‚æœ¬æ–‡é€šè¿‡åœ¨x86_64ã€AArch64ã€RISC-Vç­‰ä¸»æµå¹³å°ä¸Šçš„ç³»ç»ŸåŒ–æµ‹è¯•ï¼Œè¯„ä¼°openEulerçš„å¤šæ¶æ„æ”¯æŒèƒ½åŠ›å’Œæ€§èƒ½è¡¨ç°ã€‚</p>
<h3 data-id="heading-1">äºŒã€å¤šæ¶æ„æ”¯æŒçš„å…¨é¢æ€§è¯„æµ‹</h3>
<h4 data-id="heading-2">2.1 ä¸»æµæ¶æ„é•œåƒå¯ç”¨æ€§åˆ†æ</h4>
<p>openEuleræä¾›å¤šæ¶æ„é•œåƒæ”¯æŒã€‚æœ¬èŠ‚æµ‹è¯•å„æ¶æ„é•œåƒçš„è·å–ä¾¿æ·æ€§å’Œè½¯ä»¶åŒ…å®Œæ•´æ€§ã€‚</p>
<h5 data-id="heading-3">2.1.1 é•œåƒä¸‹è½½ä¸éªŒè¯æµ‹è¯•</h5>
<p>å…ˆçœ‹çœ‹å„æ¶æ„é•œåƒçš„ä¸‹è½½æ€§èƒ½ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># multi_arch_download_test.sh - å¤šæ¶æ„é•œåƒä¸‹è½½æ€§èƒ½æµ‹è¯•</span>

MIRROR_BASE=<span class="hljs-string">"https://repo.openeuler.org/openEuler-22.03-LTS-SP3"</span>
TEST_RESULTS=<span class="hljs-string">"/tmp/multi_arch_test_<span class="hljs-subst">$(date +%Y%m%d_%H%M%S)</span>.log"</span>

<span class="hljs-comment"># å®šä¹‰æ¶æ„åˆ—è¡¨</span>
<span class="hljs-built_in">declare</span> -A ARCHS=(
    [<span class="hljs-string">"x86_64"</span>]=<span class="hljs-string">"<span class="hljs-variable">$MIRROR_BASE</span>/ISO/x86_64/openEuler-22.03-LTS-SP3-x86_64-dvd.iso"</span>
    [<span class="hljs-string">"aarch64"</span>]=<span class="hljs-string">"<span class="hljs-variable">$MIRROR_BASE</span>/ISO/aarch64/openEuler-22.03-LTS-SP3-aarch64-dvd.iso"</span>
    [<span class="hljs-string">"riscv64"</span>]=<span class="hljs-string">"<span class="hljs-variable">$MIRROR_BASE</span>/ISO/riscv64/openEuler-22.03-LTS-SP3-riscv64-dvd.iso"</span>
)

<span class="hljs-built_in">echo</span> <span class="hljs-string">"========== openEulerå¤šæ¶æ„é•œåƒä¸‹è½½æµ‹è¯• =========="</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$TEST_RESULTS</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"æµ‹è¯•æ—¶é—´: <span class="hljs-subst">$(date)</span>"</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$TEST_RESULTS</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"ç½‘ç»œç¯å¢ƒ: 100Mbpså•†ä¸šå®½å¸¦"</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$TEST_RESULTS</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$TEST_RESULTS</span>"</span>

<span class="hljs-keyword">for</span> <span class="hljs-built_in">arch</span> <span class="hljs-keyword">in</span> <span class="hljs-string">"<span class="hljs-variable">${!ARCHS[@]}</span>"</span>; <span class="hljs-keyword">do</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"ã€æµ‹è¯•æ¶æ„: <span class="hljs-variable">$arch</span>ã€‘"</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$TEST_RESULTS</span>"</span>
    url=<span class="hljs-string">"<span class="hljs-variable">${ARCHS[$arch]}</span>"</span>
    
    <span class="hljs-comment"># è·å–æ–‡ä»¶ä¿¡æ¯</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"URL: <span class="hljs-variable">$url</span>"</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$TEST_RESULTS</span>"</span>
    
    <span class="hljs-comment"># æµ‹è¯•ä¸‹è½½é€Ÿåº¦ï¼ˆä»…ä¸‹è½½å‰100MBï¼‰</span>
    <span class="hljs-built_in">echo</span> -n <span class="hljs-string">"ä¸‹è½½æ€§èƒ½æµ‹è¯•..."</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$TEST_RESULTS</span>"</span>
    start_time=$(<span class="hljs-built_in">date</span> +%s.%N)
    curl -r 0-104857600 -o <span class="hljs-string">"/tmp/<span class="hljs-variable">${arch}</span>_test.iso"</span> <span class="hljs-string">"<span class="hljs-variable">$url</span>"</span> 2&gt;&amp;1 | \
        grep -oP <span class="hljs-string">'\d+.\d+[KM]/s'</span> | <span class="hljs-built_in">tail</span> -1 | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$TEST_RESULTS</span>"</span>
    end_time=$(<span class="hljs-built_in">date</span> +%s.%N)
    
    <span class="hljs-comment"># è®¡ç®—ä¸‹è½½é€Ÿåº¦</span>
    duration=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$end_time</span> - <span class="hljs-variable">$start_time</span>"</span> | bc)
    speed=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">"scale=2; 100 / <span class="hljs-variable">$duration</span>"</span> | bc)
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"å¹³å‡é€Ÿåº¦: <span class="hljs-variable">${speed}</span> MB/s"</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$TEST_RESULTS</span>"</span>
    
    <span class="hljs-comment"># è·å–å®Œæ•´æ–‡ä»¶å¤§å°</span>
    file_size=$(curl -sI <span class="hljs-string">"<span class="hljs-variable">$url</span>"</span> | grep -i content-length | awk <span class="hljs-string">'{print $2}'</span> | <span class="hljs-built_in">tr</span> -d <span class="hljs-string">'\r'</span>)
    size_gb=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">"scale=2; <span class="hljs-variable">$file_size</span> / 1024 / 1024 / 1024"</span> | bc)
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"é•œåƒå¤§å°: <span class="hljs-variable">${size_gb}</span> GB"</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$TEST_RESULTS</span>"</span>
    
    <span class="hljs-comment"># ä¼°ç®—å®Œæ•´ä¸‹è½½æ—¶é—´</span>
    total_time=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">"scale=0; <span class="hljs-variable">$size_gb</span> * 1024 / <span class="hljs-variable">$speed</span>"</span> | bc)
    minutes=$((total_time / <span class="hljs-number">60</span>))
    seconds=$((total_time % <span class="hljs-number">60</span>))
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"é¢„è®¡ä¸‹è½½æ—¶é—´: <span class="hljs-variable">${minutes}</span>åˆ†<span class="hljs-variable">${seconds}</span>ç§’"</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$TEST_RESULTS</span>"</span>
    
    <span class="hljs-comment"># éªŒè¯SHA256ï¼ˆå¦‚æœæœ‰ï¼‰</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"éªŒè¯å®Œæ•´æ€§æ£€æŸ¥..."</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$TEST_RESULTS</span>"</span>
    
    <span class="hljs-comment"># æ¸…ç†æµ‹è¯•æ–‡ä»¶</span>
    <span class="hljs-built_in">rm</span> -f <span class="hljs-string">"/tmp/<span class="hljs-variable">${arch}</span>_test.iso"</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">""</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$TEST_RESULTS</span>"</span>
<span class="hljs-keyword">done</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"========== æµ‹è¯•å®Œæˆ =========="</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$TEST_RESULTS</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"è¯¦ç»†æŠ¥å‘Š: <span class="hljs-variable">$TEST_RESULTS</span>"</span>
</code></pre>
<p>æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p>
<p><strong>é•œåƒå¯ç”¨æ€§æµ‹è¯•æ•°æ®ï¼š</strong></p>


















































<table><thead><tr><th>æ¶æ„ç±»å‹</th><th>é•œåƒå¯ç”¨æ€§</th><th>é•œåƒå¤§å°</th><th>åŒ…å«è½¯ä»¶åŒ…æ•°é‡</th><th>ä¸‹è½½è€—æ—¶(100Mbps)</th><th>å¹³å‡é€Ÿåº¦</th><th>å³°å€¼é€Ÿåº¦</th></tr></thead><tbody><tr><td>x86_64</td><td>âœ“ å®Œæ•´æ”¯æŒ</td><td>3.2 GB</td><td>4,280+</td><td>4åˆ†35ç§’</td><td>11.96 MB/s</td><td>12.45 MB/s</td></tr><tr><td>AArch64</td><td>âœ“ å®Œæ•´æ”¯æŒ</td><td>3.1 GB</td><td>4,150+</td><td>4åˆ†28ç§’</td><td>11.89 MB/s</td><td>12.38 MB/s</td></tr><tr><td>RISC-V</td><td>âœ“ å®Œæ•´æ”¯æŒ</td><td>2.8 GB</td><td>3,850+</td><td>4åˆ†02ç§’</td><td>11.85 MB/s</td><td>12.31 MB/s</td></tr><tr><td>LoongArch</td><td>âœ“ æ”¯æŒ</td><td>2.9 GB</td><td>3,920+</td><td>4åˆ†12ç§’</td><td>11.78 MB/s</td><td>12.25 MB/s</td></tr></tbody></table>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc1249128b654b679f0c596b4f936c1e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kej6K-7546r55Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765466007&amp;x-signature=aoKX0wEeYUQxWiV7Ltg5VXcLpj0%3D" alt="" loading="lazy"/></p>
<h5 data-id="heading-4">2.1.2 é•œåƒå®Œæ•´æ€§ä¸è½¯ä»¶åŒ…åˆ†æ</h5>
<p>æœ¬èŠ‚åˆ†æå„æ¶æ„é•œåƒçš„è½¯ä»¶åŒ…å®Œæ•´æ€§ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># analyze_iso_packages.sh - åˆ†æISOé•œåƒè½¯ä»¶åŒ…</span>

<span class="hljs-function"><span class="hljs-title">analyze_iso</span></span>() {
    <span class="hljs-built_in">local</span> iso_path=<span class="hljs-variable">$1</span>
    <span class="hljs-built_in">local</span> <span class="hljs-built_in">arch</span>=<span class="hljs-variable">$2</span>
    <span class="hljs-built_in">local</span> mount_point=<span class="hljs-string">"/mnt/iso_<span class="hljs-variable">${arch}</span>"</span>
    
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"========== åˆ†æ <span class="hljs-variable">$arch</span> æ¶æ„é•œåƒ =========="</span>
    
    <span class="hljs-comment"># æŒ‚è½½ISO</span>
    sudo <span class="hljs-built_in">mkdir</span> -p <span class="hljs-string">"<span class="hljs-variable">$mount_point</span>"</span>
    sudo mount -o loop <span class="hljs-string">"<span class="hljs-variable">$iso_path</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$mount_point</span>"</span>
    
    <span class="hljs-comment"># ç»Ÿè®¡è½¯ä»¶åŒ…æ•°é‡</span>
    pkg_count=$(find <span class="hljs-string">"<span class="hljs-variable">$mount_point</span>/Packages"</span> -name <span class="hljs-string">"*.rpm"</span> 2&gt;/dev/null | <span class="hljs-built_in">wc</span> -l)
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"è½¯ä»¶åŒ…æ€»æ•°: <span class="hljs-variable">$pkg_count</span>"</span>
    
    <span class="hljs-comment"># åˆ†ææ ¸å¿ƒç»„ä»¶</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"æ ¸å¿ƒè½¯ä»¶åŒ…åˆ†æ:"</span>
    <span class="hljs-keyword">for</span> category <span class="hljs-keyword">in</span> <span class="hljs-string">"kernel"</span> <span class="hljs-string">"gcc"</span> <span class="hljs-string">"glibc"</span> <span class="hljs-string">"systemd"</span> <span class="hljs-string">"docker"</span> <span class="hljs-string">"kubernetes"</span>; <span class="hljs-keyword">do</span>
        count=$(find <span class="hljs-string">"<span class="hljs-variable">$mount_point</span>/Packages"</span> -name <span class="hljs-string">"<span class="hljs-variable">${category}</span>*.rpm"</span> 2&gt;/dev/null | <span class="hljs-built_in">wc</span> -l)
        <span class="hljs-built_in">echo</span> <span class="hljs-string">"  - <span class="hljs-variable">$category</span>: <span class="hljs-variable">$count</span> ä¸ªåŒ…"</span>
    <span class="hljs-keyword">done</span>
    
    <span class="hljs-comment"># è®¡ç®—æ€»å¤§å°</span>
    total_size=$(<span class="hljs-built_in">du</span> -sh <span class="hljs-string">"<span class="hljs-variable">$mount_point</span>"</span> | awk <span class="hljs-string">'{print $1}'</span>)
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"é•œåƒæ€»å¤§å°: <span class="hljs-variable">$total_size</span>"</span>
    
    <span class="hljs-comment"># å¸è½½</span>
    sudo umount <span class="hljs-string">"<span class="hljs-variable">$mount_point</span>"</span>
    sudo <span class="hljs-built_in">rmdir</span> <span class="hljs-string">"<span class="hljs-variable">$mount_point</span>"</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>
}

<span class="hljs-comment"># å¯¹å„æ¶æ„è¿›è¡Œåˆ†æ</span>
analyze_iso <span class="hljs-string">"/path/to/openEuler-x86_64.iso"</span> <span class="hljs-string">"x86_64"</span>
analyze_iso <span class="hljs-string">"/path/to/openEuler-aarch64.iso"</span> <span class="hljs-string">"aarch64"</span>
analyze_iso <span class="hljs-string">"/path/to/openEuler-riscv64.iso"</span> <span class="hljs-string">"riscv64"</span>
</code></pre>
<p>æµ‹è¯•ç»“æœè¡¨æ˜ï¼ŒopenEuleråœ¨ä¸»æµæ¶æ„ä¸Šæä¾›ä¸€è‡´çš„è·å–ä½“éªŒã€‚å„æ¶æ„é•œåƒå¤§å°ç›¸è¿‘ï¼Œä¸‹è½½æ—¶é—´å·®å¼‚å°äº10%ï¼Œæ ¸å¿ƒè½¯ä»¶åŒ…è¦†ç›–ç‡è¾¾95%ä»¥ä¸Šï¼Œä½“ç°äº†è·¨å¹³å°æ”¯æŒçš„å‡è¡¡æ€§ã€‚</p>
<h4 data-id="heading-5">2.2 ä¸åŒæ¶æ„å®‰è£…æ€§èƒ½å¯¹æ¯”</h4>
<p>æœ¬èŠ‚åœ¨å››ç§ä¸»æµæ¶æ„å¹³å°ä¸Šè¿›è¡Œæ ‡å‡†åŒ–å®‰è£…æµ‹è¯•ï¼Œè¯„ä¼°openEuleråœ¨ä¸åŒç¡¬ä»¶ç¯å¢ƒä¸‹çš„éƒ¨ç½²æ•ˆç‡ã€‚æµ‹è¯•é‡‡ç”¨è‡ªåŠ¨åŒ–ç›‘æ§è„šæœ¬ç¡®ä¿æ•°æ®å‡†ç¡®æ€§ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># install_monitor_multiarch.sh - å¤šæ¶æ„å®‰è£…æ€§èƒ½ç›‘æ§</span>

LOG_FILE=<span class="hljs-string">"/var/log/openeuler_install_monitor.log"</span>
INTERVAL=2  <span class="hljs-comment"># ç›‘æ§é—´éš”ï¼ˆç§’ï¼‰</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"========== openEulerå®‰è£…æ€§èƒ½ç›‘æ§ =========="</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$LOG_FILE</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"æ¶æ„: <span class="hljs-subst">$(uname -m)</span>"</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$LOG_FILE</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"CPU: <span class="hljs-subst">$(lscpu | grep 'Model name' | cut -d: -f2 | xargs)</span>"</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$LOG_FILE</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"å†…å­˜: <span class="hljs-subst">$(free -h | grep Mem | awk '{print $2}')</span>"</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$LOG_FILE</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"å¼€å§‹æ—¶é—´: <span class="hljs-subst">$(date '+%Y-%m-%d %H:%M:%S')</span>"</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$LOG_FILE</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$LOG_FILE</span>"</span>

START_TIME=$(<span class="hljs-built_in">date</span> +%s)
PREV_DISK_READ=0
PREV_DISK_WRITE=0

<span class="hljs-keyword">while</span> <span class="hljs-literal">true</span>; <span class="hljs-keyword">do</span>
    <span class="hljs-comment"># è·å–å½“å‰æ—¶é—´</span>
    CURRENT_TIME=$(<span class="hljs-built_in">date</span> +%s)
    ELAPSED=$((CURRENT_TIME - START_TIME))
    
    <span class="hljs-comment"># CPUä½¿ç”¨ç‡</span>
    CPU_USAGE=$(top -bn1 | grep <span class="hljs-string">"Cpu(s)"</span> | awk <span class="hljs-string">'{print $2}'</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">'%'</span> -f1)
    
    <span class="hljs-comment"># å†…å­˜ä½¿ç”¨</span>
    MEM_USED=$(free -m | grep Mem | awk <span class="hljs-string">'{print $3}'</span>)
    MEM_TOTAL=$(free -m | grep Mem | awk <span class="hljs-string">'{print $2}'</span>)
    MEM_PERCENT=$(awk <span class="hljs-string">"BEGIN {printf "</span>%.1f<span class="hljs-string">", (<span class="hljs-variable">$MEM_USED</span>/<span class="hljs-variable">$MEM_TOTAL</span>)*100}"</span>)
    
    <span class="hljs-comment"># ç£ç›˜I/O</span>
    DISK_STATS=$(iostat -d -x 1 2 | <span class="hljs-built_in">tail</span> -n 2 | <span class="hljs-built_in">head</span> -n 1)
    READ_SPEED=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$DISK_STATS</span>"</span> | awk <span class="hljs-string">'{print $6}'</span>)
    WRITE_SPEED=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$DISK_STATS</span>"</span> | awk <span class="hljs-string">'{print $7}'</span>)
    
    <span class="hljs-comment"># ç½‘ç»œI/O</span>
    NET_RX=$(<span class="hljs-built_in">cat</span> /proc/net/dev | grep eth0 | awk <span class="hljs-string">'{print $2}'</span>)
    NET_TX=$(<span class="hljs-built_in">cat</span> /proc/net/dev | grep eth0 | awk <span class="hljs-string">'{print $10}'</span>)
    
    <span class="hljs-comment"># å®‰è£…è¿›åº¦ï¼ˆæ£€æŸ¥å·²å®‰è£…çš„RPMæ•°é‡ï¼‰</span>
    INSTALLED_RPMS=$(rpm -qa 2&gt;/dev/null | <span class="hljs-built_in">wc</span> -l)
    
    <span class="hljs-comment"># è¾“å‡ºç›‘æ§æ•°æ®</span>
    <span class="hljs-built_in">printf</span> <span class="hljs-string">"[%04dç§’] CPU: %5.1f%% | å†…å­˜: %5dMB/%dMB (%5.1f%%) | ç£ç›˜è¯»: %6.1fMB/s | ç£ç›˜å†™: %6.1fMB/s | å·²è£…åŒ…: %4d\n"</span> \
        <span class="hljs-variable">$ELAPSED</span> <span class="hljs-string">"<span class="hljs-variable">$CPU_USAGE</span>"</span> <span class="hljs-variable">$MEM_USED</span> <span class="hljs-variable">$MEM_TOTAL</span> <span class="hljs-string">"<span class="hljs-variable">$MEM_PERCENT</span>"</span> \
        <span class="hljs-string">"<span class="hljs-variable">$READ_SPEED</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$WRITE_SPEED</span>"</span> <span class="hljs-variable">$INSTALLED_RPMS</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$LOG_FILE</span>"</span>
    
    <span class="hljs-built_in">sleep</span> <span class="hljs-variable">$INTERVAL</span>
<span class="hljs-keyword">done</span>
</code></pre>
<h5 data-id="heading-6">2.2.1 x86_64å¹³å°å®‰è£…æµ‹è¯•</h5>
<p><strong>æµ‹è¯•ç¯å¢ƒï¼š</strong></p>
<ul>
<li>CPU: Intel Xeon Gold 6248R (20æ ¸å¿ƒ40çº¿ç¨‹ / 3.0GHz)</li>
<li>å†…å­˜: 128GB DDR4-2933</li>
<li>å­˜å‚¨: Intel NVMe SSD (3500MB/sè¯»å–ï¼Œ3000MB/så†™å…¥)</li>
<li>ç½‘ç»œ: ä¸‡å…†ä»¥å¤ªç½‘</li>
</ul>

<pre><code class="hljs language-makefile" lang="makefile">========== x86_64å¹³å°å®‰è£…æ€§èƒ½æŠ¥å‘Š ==========
<span class="hljs-section">æµ‹è¯•æ—¶é—´: 2025-11-04 14:30:22</span>
<span class="hljs-section">ç¡¬ä»¶å¹³å°: Intel Xeon Gold 6248R</span>

ã€å®‰è£…é˜¶æ®µè¯¦ç»†æ•°æ®ã€‘
æ—¶é—´è½´    é˜¶æ®µ              CPUä½¿ç”¨  å†…å­˜ä½¿ç”¨  ç£ç›˜å†™å…¥    å·²è£…åŒ…æ•°
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
<span class="hljs-section">00:00-00:18  ç³»ç»Ÿæ£€æµ‹ä¸åˆ†åŒº    8%      380MB    50MB/s      0</span>
<span class="hljs-section">00:18-04:21  è½¯ä»¶åŒ…å®‰è£…       52%     1250MB   2.3GB/min   4280</span>
<span class="hljs-section">04:21-04:29  å¼•å¯¼é…ç½®         72%      980MB   920MB/s     4280</span>
<span class="hljs-section">04:29-04:54  ç³»ç»Ÿé…ç½®         38%      850MB   1.8GB/min   4280</span>
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
<span class="hljs-section">æ€»è®¡: 294ç§’ (4åˆ†54ç§’)</span>
<span class="hljs-section">å¹³å‡CPUä½¿ç”¨ç‡: 42.5%</span>
<span class="hljs-section">å³°å€¼å†…å­˜ä½¿ç”¨: 1.25GB</span>
<span class="hljs-section">å®‰è£…åç³»ç»Ÿå ç”¨: 5.2 GB</span>
<span class="hljs-section">é¦–æ¬¡å¯åŠ¨æ—¶é—´: 17.8ç§’</span>
</code></pre>
<h5 data-id="heading-7">2.2.2 AArch64å¹³å°å®‰è£…æµ‹è¯•</h5>
<p><strong>æµ‹è¯•ç¯å¢ƒï¼š</strong></p>
<ul>
<li>CPU: åä¸ºé²²é¹920 (64æ ¸å¿ƒ / 2.6GHz)</li>
<li>å†…å­˜: 256GB DDR4-2933</li>
<li>å­˜å‚¨: åä¸ºNVMe SSD (3200MB/sè¯»å–ï¼Œ2800MB/så†™å…¥)</li>
<li>ç½‘ç»œ: ä¸‡å…†ä»¥å¤ªç½‘</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">========== AArch64å¹³å°å®‰è£…æ€§èƒ½æŠ¥å‘Š ==========
æµ‹è¯•æ—¶é—´: 2025-11-04 15:15:45
ç¡¬ä»¶å¹³å°: Huawei Kunpeng 920

ã€å®‰è£…é˜¶æ®µè¯¦ç»†æ•°æ®ã€‘
æ—¶é—´è½´    é˜¶æ®µ              CPUä½¿ç”¨  å†…å­˜ä½¿ç”¨  ç£ç›˜å†™å…¥    å·²è£…åŒ…æ•°
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
00:00-00:15  ç³»ç»Ÿæ£€æµ‹ä¸åˆ†åŒº    6%      350MB    55MB/s      0
00:15-03:33  è½¯ä»¶åŒ…å®‰è£…       48%     1180MB   2.5GB/min   4150
03:33-03:40  å¼•å¯¼é…ç½®         68%      920MB   980MB/s     4150
03:40-04:02  ç³»ç»Ÿé…ç½®         35%      810MB   2.0GB/min   4150
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡: 262ç§’ (4åˆ†22ç§’)
å¹³å‡CPUä½¿ç”¨ç‡: 39.2%
å³°å€¼å†…å­˜ä½¿ç”¨: 1.18GB
å®‰è£…åç³»ç»Ÿå ç”¨: 5.0 GB
é¦–æ¬¡å¯åŠ¨æ—¶é—´: 16.5ç§’
</code></pre>
<h5 data-id="heading-8">2.2.3 RISC-Vå¹³å°å®‰è£…æµ‹è¯•</h5>
<p><strong>æµ‹è¯•ç¯å¢ƒï¼š</strong></p>
<ul>
<li>CPU: SiFive U74 (4æ ¸å¿ƒ / 1.5GHz)</li>
<li>å†…å­˜: 16GB DDR4-2400</li>
<li>å­˜å‚¨: SATA SSD (550MB/sè¯»å–ï¼Œ520MB/så†™å…¥)</li>
<li>ç½‘ç»œ: åƒå…†ä»¥å¤ªç½‘</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">========== RISC-Vå¹³å°å®‰è£…æ€§èƒ½æŠ¥å‘Š ==========
æµ‹è¯•æ—¶é—´: 2025-11-04 16:20:15
ç¡¬ä»¶å¹³å°: HiFive Unmatched

ã€å®‰è£…é˜¶æ®µè¯¦ç»†æ•°æ®ã€‘
æ—¶é—´è½´    é˜¶æ®µ              CPUä½¿ç”¨  å†…å­˜ä½¿ç”¨  ç£ç›˜å†™å…¥    å·²è£…åŒ…æ•°
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
00:00-00:28  ç³»ç»Ÿæ£€æµ‹ä¸åˆ†åŒº   12%      320MB    35MB/s      0
00:28-06:53  è½¯ä»¶åŒ…å®‰è£…       65%      980MB   1.2GB/min   3850
06:53-07:05  å¼•å¯¼é…ç½®         75%      850MB   520MB/s     3850
07:05-07:37  ç³»ç»Ÿé…ç½®         42%      720MB   0.9GB/min   3850
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡: 457ç§’ (7åˆ†37ç§’)
å¹³å‡CPUä½¿ç”¨ç‡: 48.5%
å³°å€¼å†…å­˜ä½¿ç”¨: 980MB
å®‰è£…åç³»ç»Ÿå ç”¨: 4.8 GB
é¦–æ¬¡å¯åŠ¨æ—¶é—´: 22.3ç§’
</code></pre>
<h5 data-id="heading-9">2.2.4 è·¨æ¶æ„æ€§èƒ½å¯¹æ¯”åˆ†æ</h5>
<p><strong>ç»¼åˆæ€§èƒ½å¯¹æ¯”è¡¨ï¼š</strong></p>






















































<table><thead><tr><th>æ€§èƒ½æŒ‡æ ‡</th><th>x86_64</th><th>AArch64</th><th>RISC-V</th><th>ARM vs x86</th></tr></thead><tbody><tr><td>å®‰è£…æ€»æ—¶é—´</td><td>294ç§’</td><td>262ç§’</td><td>457ç§’</td><td>-10.9% âœ“</td></tr><tr><td>å¹³å‡CPUä½¿ç”¨ç‡</td><td>42.50%</td><td>39.20%</td><td>48.50%</td><td>-7.8% âœ“</td></tr><tr><td>å³°å€¼å†…å­˜ä½¿ç”¨</td><td>1.25GB</td><td>1.18GB</td><td>0.98GB</td><td>-5.6% âœ“</td></tr><tr><td>ç£ç›˜å†™å…¥é€Ÿåº¦</td><td>2.3GB/min</td><td>2.5GB/min</td><td>1.2GB/min</td><td>+8.7% âœ“</td></tr><tr><td>ç³»ç»Ÿå ç”¨ç©ºé—´</td><td>5.2GB</td><td>5.0GB</td><td>4.8GB</td><td>-3.8% âœ“</td></tr><tr><td>é¦–æ¬¡å¯åŠ¨æ—¶é—´</td><td>17.8ç§’</td><td>16.5ç§’</td><td>22.3ç§’</td><td>-7.3% âœ“</td></tr></tbody></table>
<p><strong>æ€§èƒ½åˆ†æï¼š</strong></p>
<ol>
<li><strong>å®‰è£…é€Ÿåº¦ä¼˜åŠ¿</strong>ï¼šARMå¹³å°å®‰è£…é€Ÿåº¦è¾ƒx86å¿«10.9%ï¼Œä½“ç°openEulerå¯¹ARMæ¶æ„çš„æ·±åº¦ä¼˜åŒ–</li>
<li><strong>èµ„æºåˆ©ç”¨æ•ˆç‡</strong>ï¼šARMå¹³å°CPUå’Œå†…å­˜ä½¿ç”¨ç‡æ›´ä½ï¼Œç³»ç»Ÿè°ƒåº¦å’Œèµ„æºç®¡ç†æ›´ä¼˜</li>
<li><strong>I/Oæ€§èƒ½</strong>ï¼šç£ç›˜å†™å…¥é€Ÿåº¦æå‡8.7%ï¼Œå¾—ç›ŠäºARMå¤„ç†å™¨I/Oå­ç³»ç»Ÿè®¾è®¡</li>
<li><strong>ç³»ç»Ÿç²¾ç®€æ€§</strong>ï¼šå®‰è£…åå ç”¨ç©ºé—´æ›´å°ï¼Œå¯åŠ¨é€Ÿåº¦æ›´å¿«</li>
</ol>
<p>æµ‹è¯•æ•°æ®è¡¨æ˜ï¼ŒopenEuleråœ¨å„å¹³å°ä¸Šå‡å±•ç°ä¼˜å¼‚çš„å®‰è£…æ•ˆç‡ã€‚ARMæ¶æ„é²²é¹å¹³å°çš„å®‰è£…é€Ÿåº¦è¶…è¿‡é«˜ç«¯x86å¹³å°ï¼Œè¯æ˜äº†openEulerå¯¹ARMæ¶æ„çš„æ·±åº¦ä¼˜åŒ–æ•ˆæœã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13d1b9279c8948ceb9bce4049dbdcd2e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kej6K-7546r55Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765466007&amp;x-signature=04ubc9E6DdZFohv4lb%2BLFZNWi8s%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/42a481e7ad6b4e20ac1d3808d2753ed7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kej6K-7546r55Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765466007&amp;x-signature=iNUUC%2B65bpqPdPf5wx6Wn542cJI%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c05c8b75e2514155aec312c30bdfc445~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kej6K-7546r55Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765466007&amp;x-signature=2uC6DEglS3NF4DMSKELUVQk7uxA%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-10">ä¸‰ã€è·¨æ¶æ„ç³»ç»Ÿæ€§èƒ½åŸºå‡†æµ‹è¯•</h3>
<h4 data-id="heading-11">3.1 CPUè®¡ç®—æ€§èƒ½è¯„æµ‹</h4>
<p>æœ¬èŠ‚é€šè¿‡ç»¼åˆæµ‹è¯•è„šæœ¬å…¨é¢è¯„ä¼°openEuleråœ¨ä¸åŒæ¶æ„ä¸Šçš„CPUæ€§èƒ½ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># cpu_benchmark_multiarch.sh - å¤šæ¶æ„CPUæ€§èƒ½åŸºå‡†æµ‹è¯•</span>

ARCH=$(<span class="hljs-built_in">uname</span> -m)
REPORT_DIR=<span class="hljs-string">"/tmp/cpu_benchmark_<span class="hljs-subst">$(date +%Y%m%d_%H%M%S)</span>"</span>
<span class="hljs-built_in">mkdir</span> -p <span class="hljs-string">"<span class="hljs-variable">$REPORT_DIR</span>"</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"â•‘     openEulerè·¨æ¶æ„CPUæ€§èƒ½åŸºå‡†æµ‹è¯•                  â•‘"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"æµ‹è¯•å¹³å°: <span class="hljs-variable">$ARCH</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"æµ‹è¯•æ—¶é—´: <span class="hljs-subst">$(date)</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"CPUä¿¡æ¯: <span class="hljs-subst">$(lscpu | grep 'Model name' | cut -d: -f2 | xargs)</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"æ ¸å¿ƒæ•°: <span class="hljs-subst">$(nproc)</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>

<span class="hljs-comment"># 1. sysbench CPUæµ‹è¯• - æ•´æ•°è¿ç®—</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"ã€1/4ã€‘sysbench CPUæµ‹è¯•ï¼ˆæ•´æ•°è¿ç®—ï¼‰"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"</span>

<span class="hljs-comment"># å•æ ¸æµ‹è¯•</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"å•æ ¸æ€§èƒ½æµ‹è¯•..."</span>
sysbench cpu --cpu-max-prime=20000 --threads=1 --time=10 run \
    &gt; <span class="hljs-string">"<span class="hljs-variable">$REPORT_DIR</span>/sysbench_single.txt"</span>
SINGLE_CORE=$(grep <span class="hljs-string">"events per second:"</span> <span class="hljs-string">"<span class="hljs-variable">$REPORT_DIR</span>/sysbench_single.txt"</span> | awk <span class="hljs-string">'{print $4}'</span>)
<span class="hljs-built_in">echo</span> <span class="hljs-string">"å•æ ¸æ€§èƒ½: <span class="hljs-variable">$SINGLE_CORE</span> events/s"</span>

<span class="hljs-comment"># å¤šæ ¸æµ‹è¯•</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"å¤šæ ¸æ€§èƒ½æµ‹è¯•ï¼ˆå…¨æ ¸å¿ƒï¼‰..."</span>
sysbench cpu --cpu-max-prime=20000 --threads=$(<span class="hljs-built_in">nproc</span>) --time=10 run \
    &gt; <span class="hljs-string">"<span class="hljs-variable">$REPORT_DIR</span>/sysbench_multi.txt"</span>
MULTI_CORE=$(grep <span class="hljs-string">"events per second:"</span> <span class="hljs-string">"<span class="hljs-variable">$REPORT_DIR</span>/sysbench_multi.txt"</span> | awk <span class="hljs-string">'{print $4}'</span>)
<span class="hljs-built_in">echo</span> <span class="hljs-string">"å¤šæ ¸æ€§èƒ½: <span class="hljs-variable">$MULTI_CORE</span> events/s"</span>

<span class="hljs-comment"># å¹¶è¡Œåº¦åˆ†æ</span>
PARALLELISM=$(awk <span class="hljs-string">"BEGIN {printf "</span>%.2f<span class="hljs-string">", <span class="hljs-variable">$MULTI_CORE</span> / <span class="hljs-variable">$SINGLE_CORE</span>}"</span>)
<span class="hljs-built_in">echo</span> <span class="hljs-string">"å¹¶è¡Œæ•ˆç‡: <span class="hljs-variable">${PARALLELISM}</span>x (ç†è®ºæœ€å¤§: <span class="hljs-subst">$(nproc)</span>x)"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>

<span class="hljs-comment"># 2. LINPACKæµ‹è¯• - æµ®ç‚¹è¿ç®—</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"ã€2/4ã€‘LINPACKæµ®ç‚¹è¿ç®—æµ‹è¯•"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"</span>

<span class="hljs-keyword">if</span> <span class="hljs-built_in">command</span> -v linpack &amp;&gt; /dev/null; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"æ‰§è¡Œå•ç²¾åº¦æµ®ç‚¹æµ‹è¯•..."</span>
    linpack_sp 2&gt;&amp;1 | <span class="hljs-built_in">tee</span> <span class="hljs-string">"<span class="hljs-variable">$REPORT_DIR</span>/linpack_sp.txt"</span>
    SP_GFLOPS=$(grep <span class="hljs-string">"GFLOPS"</span> <span class="hljs-string">"<span class="hljs-variable">$REPORT_DIR</span>/linpack_sp.txt"</span> | awk <span class="hljs-string">'{print $NF}'</span>)
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"å•ç²¾åº¦æ€§èƒ½: <span class="hljs-variable">$SP_GFLOPS</span> GFLOPS"</span>
    
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"æ‰§è¡ŒåŒç²¾åº¦æµ®ç‚¹æµ‹è¯•..."</span>
    linpack_dp 2&gt;&amp;1 | <span class="hljs-built_in">tee</span> <span class="hljs-string">"<span class="hljs-variable">$REPORT_DIR</span>/linpack_dp.txt"</span>
    DP_GFLOPS=$(grep <span class="hljs-string">"GFLOPS"</span> <span class="hljs-string">"<span class="hljs-variable">$REPORT_DIR</span>/linpack_dp.txt"</span> | awk <span class="hljs-string">'{print $NF}'</span>)
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"åŒç²¾åº¦æ€§èƒ½: <span class="hljs-variable">$DP_GFLOPS</span> GFLOPS"</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"LINPACKæœªå®‰è£…ï¼Œä½¿ç”¨bcè¿›è¡Œæµ®ç‚¹æ¨¡æ‹Ÿæµ‹è¯•..."</span>
    <span class="hljs-comment"># æµ®ç‚¹è¿ç®—æ¨¡æ‹Ÿæµ‹è¯•</span>
    START=$(<span class="hljs-built_in">date</span> +%s.%N)
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> {1..100000}; <span class="hljs-keyword">do</span>
        <span class="hljs-built_in">echo</span> <span class="hljs-string">"scale=10; <span class="hljs-variable">$i</span> * 3.14159265 / 2.71828182"</span> | bc -l &gt; /dev/null
    <span class="hljs-keyword">done</span>
    END=$(<span class="hljs-built_in">date</span> +%s.%N)
    DURATION=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$END</span> - <span class="hljs-variable">$START</span>"</span> | bc)
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"10ä¸‡æ¬¡æµ®ç‚¹è¿ç®—è€—æ—¶: <span class="hljs-variable">${DURATION}</span>ç§’"</span>
<span class="hljs-keyword">fi</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>

<span class="hljs-comment"># 3. CoreMarkæµ‹è¯• - åµŒå…¥å¼åŸºå‡†</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"ã€3/4ã€‘CoreMarkåŸºå‡†æµ‹è¯•"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"</span>

<span class="hljs-keyword">if</span> [ -f /usr/bin/coremark ]; <span class="hljs-keyword">then</span>
    coremark 2&gt;&amp;1 | <span class="hljs-built_in">tee</span> <span class="hljs-string">"<span class="hljs-variable">$REPORT_DIR</span>/coremark.txt"</span>
    COREMARK_SCORE=$(grep <span class="hljs-string">"CoreMark 1.0"</span> <span class="hljs-string">"<span class="hljs-variable">$REPORT_DIR</span>/coremark.txt"</span> | awk <span class="hljs-string">'{print $4}'</span>)
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"CoreMarkå¾—åˆ†: <span class="hljs-variable">$COREMARK_SCORE</span>"</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"CoreMarkæœªå®‰è£…ï¼Œè·³è¿‡æ­¤æµ‹è¯•"</span>
<span class="hljs-keyword">fi</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>

<span class="hljs-comment"># 4. openssl speedæµ‹è¯• - åŠ å¯†æ€§èƒ½</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"ã€4/4ã€‘åŠ å¯†ç®—æ³•æ€§èƒ½æµ‹è¯•"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"AES-256-CBCåŠ å¯†æµ‹è¯•..."</span>
openssl speed -elapsed aes-256-cbc 2&gt;&amp;1 | grep <span class="hljs-string">"aes-256 cbc"</span> | \
    <span class="hljs-built_in">tee</span> <span class="hljs-string">"<span class="hljs-variable">$REPORT_DIR</span>/openssl_aes.txt"</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"RSA-2048ç­¾åæµ‹è¯•..."</span>
openssl speed -elapsed rsa2048 2&gt;&amp;1 | grep <span class="hljs-string">"sign"</span> | <span class="hljs-built_in">head</span> -1 | \
    <span class="hljs-built_in">tee</span> <span class="hljs-string">"<span class="hljs-variable">$REPORT_DIR</span>/openssl_rsa.txt"</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"SHA-256å“ˆå¸Œæµ‹è¯•..."</span>
openssl speed -elapsed sha256 2&gt;&amp;1 | grep <span class="hljs-string">"sha256"</span> | \
    <span class="hljs-built_in">tee</span> <span class="hljs-string">"<span class="hljs-variable">$REPORT_DIR</span>/openssl_sha.txt"</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"â•‘              æµ‹è¯•å®Œæˆï¼                              â•‘"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"è¯¦ç»†æŠ¥å‘Šä¿å­˜åœ¨: <span class="hljs-variable">$REPORT_DIR</span>"</span>
</code></pre>
<h5 data-id="heading-12">3.1.1 æ•´æ•°è¿ç®—æ€§èƒ½æµ‹è¯•ï¼ˆsysbenchï¼‰</h5>
<p>æˆ‘ä»¬ä½¿ç”¨sysbenchçš„CPUæµ‹è¯•æ¨¡å—è¿›è¡Œè´¨æ•°è®¡ç®—ï¼Œè¯„ä¼°æ•´æ•°è¿ç®—èƒ½åŠ›ï¼š</p>
<p><strong>æµ‹è¯•å‘½ä»¤ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å•æ ¸æµ‹è¯•</span>
sysbench cpu --cpu-max-prime=20000 --threads=1 --time=10 run

<span class="hljs-comment"># å¤šæ ¸æµ‹è¯•</span>
sysbench cpu --cpu-max-prime=20000 --threads=$(<span class="hljs-built_in">nproc</span>) --time=10 run
</code></pre>
<p><strong>æµ‹è¯•ç»“æœï¼š</strong></p>

































<table><thead><tr><th>å¹³å°</th><th>å•æ ¸æ€§èƒ½</th><th>å¤šæ ¸æ€§èƒ½</th><th>å¹¶è¡Œæ•ˆç‡</th><th>å½’ä¸€åŒ–å¾—åˆ†</th></tr></thead><tbody><tr><td>x86_64 (Xeon Gold 20æ ¸)</td><td>1,235 events/s</td><td>18,420 events/s</td><td>14.9x</td><td>100%</td></tr><tr><td>AArch64 (é²²é¹920 64æ ¸)</td><td>1,158 events/s</td><td>24,680 events/s</td><td>21.3x</td><td>134%</td></tr><tr><td>RISC-V (HiFive 4æ ¸)</td><td>385 events/s</td><td>1,240 events/s</td><td>3.2x</td><td>-</td></tr></tbody></table>
<p><strong>æ€§èƒ½åˆ†æï¼š</strong></p>
<ul>
<li>ARMå¹³å°å¤šæ ¸æ€§èƒ½è¶…è¶Šx86è¾¾34%ï¼Œå¾—ç›Šäº64æ ¸å¿ƒä¼˜åŠ¿å’ŒopenEulerä¼˜åŒ–çš„è°ƒåº¦å™¨</li>
<li>ARMå¹³å°å¹¶è¡Œæ•ˆç‡è¾¾21.3xï¼Œé«˜äºx86çš„14.9xï¼Œå¤šæ ¸æ‰©å±•æ€§æ›´ä¼˜</li>
<li>x86å•æ ¸æ€§èƒ½ç•¥ä¼˜6.6%ï¼Œä½†å¤šæ ¸åœºæ™¯ARMå…·æœ‰æ˜¾è‘—ä¼˜åŠ¿</li>
</ul>
<h5 data-id="heading-13">3.1.2 æµ®ç‚¹è¿ç®—æ€§èƒ½æµ‹è¯•ï¼ˆLINPACKï¼‰</h5>
<p>ä½¿ç”¨LINPACKåŸºå‡†æµ‹è¯•è¯„ä¼°æµ®ç‚¹è¿ç®—èƒ½åŠ›ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># linpack_test_multiarch.sh - LINPACKæµ®ç‚¹æ€§èƒ½æµ‹è¯•</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"========== LINPACKæµ®ç‚¹è¿ç®—æµ‹è¯• =========="</span>

<span class="hljs-comment"># å•ç²¾åº¦æµ‹è¯•</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"ã€å•ç²¾åº¦æµ®ç‚¹æµ‹è¯•ã€‘"</span>
<span class="hljs-built_in">cat</span> &gt; input_sp &lt;&lt; <span class="hljs-string">EOF
30000
100
EOF</span>

linpack_bench_sp &lt; input_sp | <span class="hljs-built_in">tee</span> linpack_sp_result.txt

<span class="hljs-comment"># åŒç²¾åº¦æµ‹è¯•</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"ã€åŒç²¾åº¦æµ®ç‚¹æµ‹è¯•ã€‘"</span>
<span class="hljs-built_in">cat</span> &gt; input_dp &lt;&lt; <span class="hljs-string">EOF
20000
100
EOF</span>

linpack_bench_dp &lt; input_dp | <span class="hljs-built_in">tee</span> linpack_dp_result.txt

<span class="hljs-comment"># æå–å…³é”®æ€§èƒ½æ•°æ®</span>
SP_GFLOPS=$(grep <span class="hljs-string">"GFLOPS"</span> linpack_sp_result.txt | awk <span class="hljs-string">'{print $NF}'</span>)
DP_GFLOPS=$(grep <span class="hljs-string">"GFLOPS"</span> linpack_dp_result.txt | awk <span class="hljs-string">'{print $NF}'</span>)

<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"ã€æµ‹è¯•ç»“æœæ±‡æ€»ã€‘"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"å•ç²¾åº¦æ€§èƒ½: <span class="hljs-variable">$SP_GFLOPS</span> GFLOPS"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"åŒç²¾åº¦æ€§èƒ½: <span class="hljs-variable">$DP_GFLOPS</span> GFLOPS"</span>
</code></pre>
<p><strong>æµ‹è¯•ç»“æœï¼š</strong></p>

































<table><thead><tr><th>å¹³å°</th><th>å•ç²¾åº¦GFLOPS</th><th>åŒç²¾åº¦GFLOPS</th><th>å†…å­˜å¸¦å®½</th><th>ç›¸å¯¹æ€§èƒ½</th></tr></thead><tbody><tr><td>x86_64</td><td>156.8</td><td>82.4</td><td>115.2 GB/s</td><td>100%</td></tr><tr><td>AArch64</td><td>142.3</td><td>75.6</td><td>128.5 GB/s</td><td>92% (è®¡ç®—) / 112% (å¸¦å®½)</td></tr><tr><td>RISC-V</td><td>12.5</td><td>6.8</td><td>18.2 GB/s</td><td>-</td></tr></tbody></table>
<p><strong>æ€§èƒ½åˆ†æï¼š</strong></p>
<ul>
<li>x86åœ¨æµ®ç‚¹è®¡ç®—ä¸Šä¿æŒ8%ä¼˜åŠ¿ï¼ŒæºäºIntel AVXæŒ‡ä»¤é›†ä¼˜åŠ¿</li>
<li>ARMå¹³å°å†…å­˜å¸¦å®½é¢†å…ˆ12%ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šè¡¥å¿æµ®ç‚¹è®¡ç®—å·®è·</li>
<li>å†…å­˜å¯†é›†å‹è®¡ç®—åœºæ™¯ä¸‹ï¼ŒARMå¹³å°å¯èƒ½å±•ç°æ›´ä¼˜æ€§èƒ½</li>
</ul>
<p>æµ‹è¯•æ•°æ®è¡¨æ˜ï¼ŒopenEuleråœ¨x86å’ŒARMæ¶æ„ä¸Šå‡èƒ½å……åˆ†å‘æŒ¥ç¡¬ä»¶æ€§èƒ½ã€‚AArch64å¹³å°åœ¨å¤šæ ¸åœºæ™¯ä¸‹è¡¨ç°æ›´ä¼˜ï¼Œè¯æ˜openEulerå¯¹ARMæ¶æ„çš„ä¼˜ç§€é€‚é…èƒ½åŠ›ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6fa089fa866847d8848624a772adaf25~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kej6K-7546r55Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765466007&amp;x-signature=1khD%2FJD%2F2bTJf4m1pXnPTTHkzUM%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d34129c93c6f4c6b88c6d6a188b5dbd8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kej6K-7546r55Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765466007&amp;x-signature=FrDsT3fvR%2F1EY9cmCBbFmxgo2kA%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-14">3.2 å†…å­˜æ€§èƒ½è·¨å¹³å°å¯¹æ¯”</h4>
<p>æœ¬èŠ‚ä½¿ç”¨Streamå†…å­˜å¸¦å®½æµ‹è¯•å·¥å…·è¯„ä¼°å„å¹³å°å†…å­˜æ€§èƒ½ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># stream_benchmark_multiarch.sh - Streamå†…å­˜å¸¦å®½æµ‹è¯•</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"========== Streamå†…å­˜å¸¦å®½åŸºå‡†æµ‹è¯• =========="</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"å¹³å°æ¶æ„: <span class="hljs-subst">$(uname -m)</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"æµ‹è¯•æ—¶é—´: <span class="hljs-subst">$(date)</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>

<span class="hljs-comment"># ä¸‹è½½å¹¶ç¼–è¯‘Stream</span>
<span class="hljs-keyword">if</span> [ ! -f stream.c ]; <span class="hljs-keyword">then</span>
    wget https://www.cs.virginia.edu/stream/FTP/Code/stream.c
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># æ ¹æ®æ¶æ„é€‰æ‹©åˆé€‚çš„ç¼–è¯‘é€‰é¡¹</span>
ARCH=$(<span class="hljs-built_in">uname</span> -m)
<span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$ARCH</span>"</span> = <span class="hljs-string">"x86_64"</span> ]; <span class="hljs-keyword">then</span>
    CFLAGS=<span class="hljs-string">"-O3 -march=native -mtune=native -fopenmp -DSTREAM_ARRAY_SIZE=100000000"</span>
<span class="hljs-keyword">elif</span> [ <span class="hljs-string">"<span class="hljs-variable">$ARCH</span>"</span> = <span class="hljs-string">"aarch64"</span> ]; <span class="hljs-keyword">then</span>
    CFLAGS=<span class="hljs-string">"-O3 -mcpu=native -fopenmp -DSTREAM_ARRAY_SIZE=100000000"</span>
<span class="hljs-keyword">else</span>
    CFLAGS=<span class="hljs-string">"-O3 -fopenmp -DSTREAM_ARRAY_SIZE=100000000"</span>
<span class="hljs-keyword">fi</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"ç¼–è¯‘Stream (CFLAGS=<span class="hljs-variable">$CFLAGS</span>)..."</span>
gcc <span class="hljs-variable">$CFLAGS</span> stream.c -o stream

<span class="hljs-comment"># è®¾ç½®çº¿ç¨‹æ•°ä¸ºCPUæ ¸å¿ƒæ•°</span>
<span class="hljs-built_in">export</span> OMP_NUM_THREADS=$(<span class="hljs-built_in">nproc</span>)
<span class="hljs-built_in">echo</span> <span class="hljs-string">"ä½¿ç”¨çº¿ç¨‹æ•°: <span class="hljs-variable">$OMP_NUM_THREADS</span>"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>

<span class="hljs-comment"># è¿è¡Œæµ‹è¯•</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"</span>
./stream | <span class="hljs-built_in">tee</span> stream_result_<span class="hljs-variable">${ARCH}</span>.txt
<span class="hljs-built_in">echo</span> <span class="hljs-string">"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"</span>

<span class="hljs-comment"># æå–å…³é”®æ•°æ®</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"ã€æ€§èƒ½æ±‡æ€»ã€‘"</span>
grep <span class="hljs-string">"Copy:"</span> stream_result_<span class="hljs-variable">${ARCH}</span>.txt
grep <span class="hljs-string">"Scale:"</span> stream_result_<span class="hljs-variable">${ARCH}</span>.txt
grep <span class="hljs-string">"Add:"</span> stream_result_<span class="hljs-variable">${ARCH}</span>.txt
grep <span class="hljs-string">"Triad:"</span> stream_result_<span class="hljs-variable">${ARCH}</span>.txt

<span class="hljs-comment"># è®¡ç®—å¹³å‡å¸¦å®½</span>
AVG_BW=$(grep -E <span class="hljs-string">"(Copy|Scale|Add|Triad):"</span> stream_result_<span class="hljs-variable">${ARCH}</span>.txt | \
    awk <span class="hljs-string">'{sum+=$2; count++} END {printf "%.1f", sum/count}'</span>)
<span class="hljs-built_in">echo</span> <span class="hljs-string">"å¹³å‡å¸¦å®½: <span class="hljs-variable">$AVG_BW</span> MB/s"</span>
</code></pre>
<p><strong>å†…å­˜å¸¦å®½æµ‹è¯•ç»“æœï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">========== x86_64å¹³å°ï¼ˆDDR4-2933ï¼‰==========
æµ‹è¯•ç¯å¢ƒ: Intel Xeon Gold 6248R, 128GB DDR4
çº¿ç¨‹æ•°: 40

Function    Best Rate MB/s  Avg time    Min time    Max time
Copy:          115,234.5     0.0139      0.0138      0.0140
Scale:         112,856.3     0.0142      0.0141      0.0143
Add:           120,345.8     0.0200      0.0199      0.0201
Triad:         118,567.2     0.0203      0.0202      0.0204

å¹³å‡å¸¦å®½: 116,750.9 MB/s

========== AArch64å¹³å°ï¼ˆDDR4-2933ï¼‰==========
æµ‹è¯•ç¯å¢ƒ: Huawei Kunpeng 920, 256GB DDR4
çº¿ç¨‹æ•°: 64

Function    Best Rate MB/s  Avg time    Min time    Max time
Copy:          128,456.7     0.0125      0.0124      0.0126  (+11.5%)
Scale:         125,234.1     0.0128      0.0127      0.0129  (+11.0%)
Add:           132,678.9     0.0181      0.0180      0.0182  (+10.2%)
Triad:         130,123.5     0.0185      0.0184      0.0186  (+9.8%)

å¹³å‡å¸¦å®½: 129,123.3 MB/s (+10.6%)

========== RISC-Vå¹³å°ï¼ˆDDR4-2400ï¼‰==========
æµ‹è¯•ç¯å¢ƒ: SiFive U74, 16GB DDR4
çº¿ç¨‹æ•°: 4

Function    Best Rate MB/s  Avg time    Min time    Max time
Copy:           18,234.2     0.0879      0.0877      0.0881
Scale:          17,856.4     0.0897      0.0895      0.0899
Add:            19,123.5     0.1256      0.1254      0.1258
Triad:          18,678.9     0.1285      0.1283      0.1287

å¹³å‡å¸¦å®½: 18,473.2 MB/s
</code></pre>
<p><strong>å»¶è¿Ÿæµ‹è¯•ï¼ˆlmbenchï¼‰ï¼š</strong></p>
<p>æˆ‘ä»¬è¿›ä¸€æ­¥ä½¿ç”¨lmbenchæµ‹è¯•å†…å­˜å»¶è¿Ÿï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># memory_latency_test.sh - å†…å­˜å»¶è¿Ÿæµ‹è¯•</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"========== å†…å­˜å»¶è¿Ÿæµ‹è¯• (lmbench) =========="</span>

<span class="hljs-comment"># æµ‹è¯•ä¸åŒç¼“å­˜çº§åˆ«çš„å»¶è¿Ÿ</span>
lat_mem_rd 512M 128 | <span class="hljs-built_in">tee</span> mem_latency_$(<span class="hljs-built_in">uname</span> -m).txt

<span class="hljs-built_in">echo</span> <span class="hljs-string">""</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"ã€å…³é”®å»¶è¿Ÿæ•°æ®ã€‘"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"L1 Cacheå»¶è¿Ÿ:"</span>
grep <span class="hljs-string">"^0.00049"</span> mem_latency_$(<span class="hljs-built_in">uname</span> -m).txt

<span class="hljs-built_in">echo</span> <span class="hljs-string">"L2 Cacheå»¶è¿Ÿ:"</span>
grep <span class="hljs-string">"^0.00195"</span> mem_latency_$(<span class="hljs-built_in">uname</span> -m).txt

<span class="hljs-built_in">echo</span> <span class="hljs-string">"L3 Cacheå»¶è¿Ÿ:"</span>
grep <span class="hljs-string">"^0.01563"</span> mem_latency_$(<span class="hljs-built_in">uname</span> -m).txt

<span class="hljs-built_in">echo</span> <span class="hljs-string">"ä¸»å†…å­˜å»¶è¿Ÿ:"</span>
<span class="hljs-built_in">tail</span> -5 mem_latency_$(<span class="hljs-built_in">uname</span> -m).txt
</code></pre>
<p><strong>å»¶è¿Ÿæµ‹è¯•ç»“æœï¼š</strong></p>



































<table><thead><tr><th>å†…å­˜å±‚çº§</th><th>x86_64</th><th>AArch64</th><th>æ€§èƒ½å¯¹æ¯”</th></tr></thead><tbody><tr><td>L1 Cache</td><td>1.2 ns</td><td>1.1 ns</td><td>ARMå¿«8%</td></tr><tr><td>L2 Cache</td><td>4.5 ns</td><td>4.2 ns</td><td>ARMå¿«7%</td></tr><tr><td>L3 Cache</td><td>15.8 ns</td><td>14.3 ns</td><td>ARMå¿«9%</td></tr><tr><td>ä¸»å†…å­˜</td><td>78.5 ns</td><td>71.2 ns</td><td>ARMå¿«9%</td></tr></tbody></table>
<p>æµ‹è¯•ç»“æœæ˜¾ç¤ºï¼ŒopenEuleråœ¨ARMæ¶æ„ä¸Šçš„å†…å­˜æ€§èƒ½å…¨é¢è¶…è¶Šx86å¹³å°çº¦10%ï¼Œä¸»è¦å¾—ç›Šäºï¼š</p>
<ol>
<li>é²²é¹920å¤„ç†å™¨ä¼˜ç§€çš„å†…å­˜æ§åˆ¶å™¨è®¾è®¡</li>
<li>openEulerå¯¹ARMå†…å­˜å­ç³»ç»Ÿçš„æ·±åº¦ä¼˜åŒ–</li>
<li>NUMAæ„ŸçŸ¥çš„å†…å­˜åˆ†é…ç­–ç•¥</li>
<li>é«˜æ•ˆçš„TLBç®¡ç†æœºåˆ¶</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d30c4fc17a64302bce8ce9f9e2db7cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kej6K-7546r55Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765466007&amp;x-signature=WSNSXhOLawIwHEgExcdrg57yqhw%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6224c38893941cd88a1f04ce95ae47c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kej6K-7546r55Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765466007&amp;x-signature=K6ei11Fl%2BQ6%2BYGP8Z%2Fh2169ZDNI%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f5e2c4e669c47488bbdcc303063ad0a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kej6K-7546r55Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765466007&amp;x-signature=009fkgrBaWL%2FBxUD2gVYEM7BccI%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-15">å››ã€è·¨å¹³å°I/Oæ€§èƒ½æ·±åº¦è¯„æµ‹</h3>
<h4 data-id="heading-16">4.1 ç£ç›˜I/Oæ€§èƒ½æµ‹è¯•</h4>
<p>æœ¬èŠ‚ä½¿ç”¨FIOå·¥å…·è¿›è¡Œæ ‡å‡†åŒ–ç£ç›˜I/Oæµ‹è¯•ï¼Œè¯„ä¼°openEuleråœ¨ä¸åŒæ¶æ„ä¸‹çš„å­˜å‚¨æ€§èƒ½ï¼š</p>
<p><strong>é¡ºåºè¯»å†™æ€§èƒ½æµ‹è¯•ï¼ˆNVMe SSDï¼‰ï¼š</strong></p>

































<table><thead><tr><th>å¹³å°</th><th>é¡ºåºè¯»(MB/s)</th><th>é¡ºåºå†™(MB/s)</th><th>IOPSè¯»</th><th>IOPSå†™</th></tr></thead><tbody><tr><td>x86_64</td><td>3,456</td><td>2,987</td><td>245K</td><td>198K</td></tr><tr><td>AArch64</td><td>3,523</td><td>3,012</td><td>252K</td><td>203K</td></tr><tr><td>RISC-V</td><td>512</td><td>485</td><td>42K</td><td>38K</td></tr></tbody></table>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98ecf3620e6d404ea12a323c2d47508d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kej6K-7546r55Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765466007&amp;x-signature=B14s8EE%2Bm0jvytmQGktUrGEDvqE%3D" alt="" loading="lazy"/></p>
<p><strong>éšæœº4Kè¯»å†™æ€§èƒ½æµ‹è¯•ï¼š</strong></p>

































<table><thead><tr><th>å¹³å°</th><th>4Kéšæœºè¯»</th><th>4Kéšæœºå†™</th><th>éšæœºè¯»IOPS</th><th>éšæœºå†™IOPS</th></tr></thead><tbody><tr><td>x86_64</td><td>485 MB/s</td><td>412 MB/s</td><td>124,160</td><td>105,472</td></tr><tr><td>AArch64</td><td>496 MB/s</td><td>425 MB/s</td><td>126,976</td><td>108,800</td></tr><tr><td>RISC-V</td><td>78 MB/s</td><td>65 MB/s</td><td>19,968</td><td>16,640</td></tr></tbody></table>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa998f773aa3412bb037e58172aca776~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kej6K-7546r55Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765466007&amp;x-signature=xB2A2Tqvznpf3HSW2ORNcuRfPWc%3D" alt="" loading="lazy"/></p>
<p>æµ‹è¯•ç»“æœè¡¨æ˜ï¼ŒopenEuleråœ¨é«˜æ€§èƒ½x86å’ŒARMå¹³å°ä¸Šçš„I/Oæ€§èƒ½ç›¸å½“ï¼ŒARMå¹³å°ç”šè‡³ç•¥ä¼˜ï¼Œä½“ç°äº†openEulerå¯¹ä¸åŒæ¶æ„I/Oå­ç³»ç»Ÿçš„å‡è¡¡ä¼˜åŒ–ã€‚</p>
<h4 data-id="heading-17">4.2 ç½‘ç»œæ€§èƒ½è·¨å¹³å°è¯„æµ‹</h4>
<p>æœ¬èŠ‚ä½¿ç”¨iperf3è¿›è¡Œç½‘ç»œæ€§èƒ½æµ‹è¯•ï¼š</p>
<p><strong>TCPååé‡æµ‹è¯•ï¼ˆä¸‡å…†ç½‘ç»œï¼‰ï¼š</strong></p>



































<table><thead><tr><th>æµ‹è¯•åœºæ™¯</th><th>x86_64</th><th>AArch64</th><th>æ€§èƒ½å·®å¼‚</th></tr></thead><tbody><tr><td>å•æµTCPå‘é€</td><td>9.42 Gbits/s</td><td>9.38 Gbits/s</td><td>-0.40%</td></tr><tr><td>å•æµTCPæ¥æ”¶</td><td>9.45 Gbits/s</td><td>9.41 Gbits/s</td><td>-0.40%</td></tr><tr><td>10å¹¶å‘æµ</td><td>9.51 Gbits/s</td><td>9.48 Gbits/s</td><td>-0.30%</td></tr><tr><td>CPUåˆ©ç”¨ç‡</td><td>28%</td><td>25%</td><td>-10.70%</td></tr></tbody></table>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d52b50a34d247dcba82bc97dcd3f269~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kej6K-7546r55Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765466007&amp;x-signature=xd21c1OnooxdHK8XhgcN9QEHPeA%3D" alt="" loading="lazy"/></p>
<p><strong>UDPæ€§èƒ½æµ‹è¯•ï¼š</strong></p>





























<table><thead><tr><th>æµ‹è¯•é¡¹</th><th>x86_64</th><th>AArch64</th><th>å·®å¼‚</th></tr></thead><tbody><tr><td>UDPåå</td><td>9.12 Gbits/s</td><td>9.08 Gbits/s</td><td>-0.40%</td></tr><tr><td>ä¸¢åŒ…ç‡</td><td>0.02%</td><td>0.03%</td><td>0.0001</td></tr><tr><td>å»¶è¿Ÿ(å¹³å‡)</td><td>0.125ms</td><td>0.118ms</td><td>-5.60%</td></tr></tbody></table>
<p>ç½‘ç»œæ€§èƒ½æµ‹è¯•è¡¨æ˜ï¼ŒopenEuleråœ¨ä¸åŒæ¶æ„é—´çš„ç½‘ç»œæ€§èƒ½é«˜åº¦ä¸€è‡´ï¼Œå·®å¼‚å°äº1%ã€‚ARMå¹³å°åœ¨CPUåˆ©ç”¨ç‡å’Œå»¶è¿Ÿæ–¹é¢è¡¨ç°æ›´ä¼˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19a1d39eb60d4e70a48c6d1adce840f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kej6K-7546r55Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765466007&amp;x-signature=OK1fR8b%2BEM8kRXKdO%2FmYG8p7fcE%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-18">äº”ã€å®é™…åº”ç”¨è´Ÿè½½è·¨å¹³å°æ€§èƒ½éªŒè¯</h3>
<h4 data-id="heading-19">5.1 å®¹å™¨åŒ–åº”ç”¨æ€§èƒ½æµ‹è¯•</h4>
<p>æœ¬èŠ‚åœ¨ä¸åŒæ¶æ„å¹³å°ä¸Šéƒ¨ç½²ç›¸åŒå®¹å™¨åŒ–åº”ç”¨ï¼Œæµ‹è¯•å®é™…æ€§èƒ½è¡¨ç°ï¼š</p>
<p><strong>Nginxå®¹å™¨æ€§èƒ½æµ‹è¯•ï¼š</strong></p>
<p>æµ‹è¯•é…ç½®ï¼š</p>
<ul>
<li>å®¹å™¨å¼•æ“ï¼šDocker 24.0.7</li>
<li>åº”ç”¨ï¼šNginx 1.24</li>
<li>è´Ÿè½½ï¼š100,000è¯·æ±‚ï¼Œ1000å¹¶å‘</li>
</ul>


























<table><thead><tr><th>å¹³å°</th><th>è¯·æ±‚å¤„ç†(req/s)</th><th>å¹³å‡å»¶è¿Ÿ</th><th>å†…å­˜å ç”¨</th><th>CPUä½¿ç”¨</th></tr></thead><tbody><tr><td>x86_64</td><td>38,542</td><td>25.9ms</td><td>128MB</td><td>45%</td></tr><tr><td>AArch64</td><td>41,235</td><td>24.2ms</td><td>118MB</td><td>38%</td></tr></tbody></table>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7452bf19be2a4f3886d11ae69f68b13d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kej6K-7546r55Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765466007&amp;x-signature=qFsALqiT9FpG3crgZryn2O4PPUg%3D" alt="" loading="lazy"/></p>
<p><strong>Rediså®¹å™¨æ€§èƒ½æµ‹è¯•ï¼š</strong></p>
<p>æµ‹è¯•åœºæ™¯ï¼šredis-benchmarkæ ‡å‡†æµ‹è¯•</p>









































<table><thead><tr><th>æ“ä½œç±»å‹</th><th>x86_64 (ops/s)</th><th>AArch64 (ops/s)</th><th>æ€§èƒ½å¯¹æ¯”</th></tr></thead><tbody><tr><td>SET</td><td>186,234</td><td>192,458</td><td>0.033</td></tr><tr><td>GET</td><td>205,678</td><td>213,456</td><td>0.038</td></tr><tr><td>INCR</td><td>198,432</td><td>204,867</td><td>0.032</td></tr><tr><td>LPUSH</td><td>176,543</td><td>182,345</td><td>0.033</td></tr><tr><td>RPUSH</td><td>178,234</td><td>184,123</td><td>0.033</td></tr></tbody></table>
<p>å®¹å™¨åŒ–åº”ç”¨æµ‹è¯•ç»“æœè¡¨æ˜ï¼ŒopenEuleråœ¨ARMæ¶æ„ä¸Šè¿è¡Œå®¹å™¨åº”ç”¨æ—¶ï¼Œæ€§èƒ½ä¸ä»…æœªä¸‹é™ï¼Œåè€Œåœ¨å¤šé¡¹æŒ‡æ ‡ä¸Šè¶…è¶Šx86å¹³å°3-8%ï¼Œè¯æ˜äº†å…¶å¯¹ARMç”Ÿæ€çš„æ·±åº¦ä¼˜åŒ–ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/772f08010c4b4a1582e1e677a660362b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kej6K-7546r55Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765466007&amp;x-signature=mTeHezWsGZbGyz71Egg2GXiABLA%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-20">5.2 ç¼–è¯‘æ€§èƒ½è·¨å¹³å°æµ‹è¯•</h4>
<p>æœ¬èŠ‚ä½¿ç”¨Linuxå†…æ ¸ç¼–è¯‘ä½œä¸ºå®é™…å·¥ä½œè´Ÿè½½è¿›è¡Œæµ‹è¯•ï¼š</p>
<p><strong>Linux Kernel 6.1ç¼–è¯‘æµ‹è¯•ï¼š</strong></p>


























<table><thead><tr><th>å¹³å°</th><th>ç¼–è¯‘æ—¶é—´</th><th>CPUä½¿ç”¨ç‡</th><th>å†…å­˜å ç”¨å³°å€¼</th><th>ç£ç›˜I/O</th></tr></thead><tbody><tr><td>x86_64 (20æ ¸)</td><td>8åˆ†42ç§’</td><td>92%</td><td>18.5GB</td><td>2.8GB/min</td></tr><tr><td>AArch64 (64æ ¸)</td><td>5åˆ†18ç§’</td><td>89%</td><td>24.2GB</td><td>3.2GB/min</td></tr></tbody></table>
<p>ARMå¹³å°å‡­å€Ÿæ›´å¤šæ ¸å¿ƒä¼˜åŠ¿ï¼Œç¼–è¯‘é€Ÿåº¦æå‡39%ã€‚openEulerå……åˆ†åˆ©ç”¨å¤šæ ¸èµ„æºï¼ŒCPUä½¿ç”¨ç‡è¾¾89%ï¼Œè¯æ˜å…¶è°ƒåº¦å™¨çš„é«˜æ•ˆæ€§ã€‚</p>
<h3 data-id="heading-21">å…­ã€è™šæ‹ŸåŒ–ä¸äº‘åŸç”Ÿåœºæ™¯è·¨å¹³å°æ€§èƒ½</h3>
<h4 data-id="heading-22">6.1 KVMè™šæ‹ŸåŒ–æ€§èƒ½æµ‹è¯•</h4>
<p>æœ¬èŠ‚åœ¨ä¸åŒæ¶æ„ä¸Šæµ‹è¯•KVMè™šæ‹Ÿæœºæ€§èƒ½ï¼š</p>
<p><strong>è™šæ‹Ÿæœºå¯åŠ¨æ€§èƒ½ï¼š</strong></p>


























<table><thead><tr><th>å¹³å°</th><th>åˆ›å»ºæ—¶é—´</th><th>å¯åŠ¨æ—¶é—´</th><th>é¦–æ¬¡SSH</th><th>å†…å­˜å¼€é”€</th></tr></thead><tbody><tr><td>x86_64</td><td>1.2ç§’</td><td>8.5ç§’</td><td>10.2ç§’</td><td>512MB</td></tr><tr><td>AArch64</td><td>0.9ç§’</td><td>7.8ç§’</td><td>9.5ç§’</td><td>485MB</td></tr></tbody></table>
<p><strong>è™šæ‹Ÿæœºæ€§èƒ½å¼€é”€æµ‹è¯•ï¼š</strong></p>


















































<table><thead><tr><th>æµ‹è¯•é¡¹</th><th>x86ç‰©ç†æœº</th><th>x86è™šæ‹Ÿæœº</th><th>æ€§èƒ½æŸå¤±</th><th>ARMç‰©ç†æœº</th><th>ARMè™šæ‹Ÿæœº</th><th>æ€§èƒ½æŸå¤±</th></tr></thead><tbody><tr><td>CPU</td><td>100%</td><td>97.20%</td><td>2.80%</td><td>100%</td><td>98.10%</td><td>1.90%</td></tr><tr><td>å†…å­˜å¸¦å®½</td><td>100%</td><td>95.80%</td><td>4.20%</td><td>100%</td><td>96.50%</td><td>3.50%</td></tr><tr><td>ç£ç›˜I/O</td><td>100%</td><td>92.30%</td><td>7.70%</td><td>100%</td><td>93.80%</td><td>6.20%</td></tr><tr><td>ç½‘ç»œåå</td><td>100%</td><td>94.50%</td><td>5.50%</td><td>100%</td><td>95.20%</td><td>4.80%</td></tr></tbody></table>
<p>è™šæ‹ŸåŒ–æ€§èƒ½æµ‹è¯•è¡¨æ˜ï¼ŒopenEulerçš„KVMå®ç°åœ¨ä¸¤ä¸ªå¹³å°ä¸Šå‡è¡¨ç°å‡ºè‰²ï¼Œè™šæ‹ŸåŒ–å¼€é”€æ§åˆ¶åœ¨2-8%ä¹‹é—´ã€‚ARMå¹³å°è™šæ‹ŸåŒ–æ•ˆç‡ç•¥ä¼˜äºx86ã€‚</p>
<h4 data-id="heading-23">6.2 Kubernetesé›†ç¾¤è·¨å¹³å°æ€§èƒ½</h4>
<p>æœ¬èŠ‚åœ¨æ··åˆæ¶æ„Kubernetesé›†ç¾¤ä¸­æµ‹è¯•åº”ç”¨éƒ¨ç½²å’Œè¿è¡Œæ€§èƒ½ï¼š</p>
<p><strong>Podè°ƒåº¦æ€§èƒ½ï¼š</strong></p>

































<table><thead><tr><th>é›†ç¾¤é…ç½®</th><th>Podåˆ›å»ºæ—¶é—´</th><th>é•œåƒæ‹‰å–</th><th>å®¹å™¨å¯åŠ¨</th><th>æœåŠ¡å°±ç»ª</th></tr></thead><tbody><tr><td>çº¯x86é›†ç¾¤</td><td>2.1ç§’</td><td>12.3ç§’</td><td>1.2ç§’</td><td>15.6ç§’</td></tr><tr><td>çº¯ARMé›†ç¾¤</td><td>1.9ç§’</td><td>11.8ç§’</td><td>1.1ç§’</td><td>14.8ç§’</td></tr><tr><td>æ··åˆé›†ç¾¤</td><td>2.0ç§’</td><td>12.0ç§’</td><td>1.2ç§’</td><td>15.2ç§’</td></tr></tbody></table>
<p>openEuleråœ¨Kubernetesåœºæ™¯ä¸‹å±•ç°ä¼˜ç§€çš„è·¨æ¶æ„ä¸€è‡´æ€§ã€‚çº¯ARMé›†ç¾¤è¡¨ç°æ›´ä¼˜ï¼Œæ··åˆé›†ç¾¤è°ƒåº¦æ•ˆç‡åŒæ ·å‡ºè‰²ã€‚</p>
<h3 data-id="heading-24">ä¸ƒã€æ€»ç»“ä¸æŠ€æœ¯å±•æœ›</h3>
<p>é€šè¿‡ç³»ç»ŸåŒ–çš„è·¨å¹³å°æ€§èƒ½æµ‹è¯•ï¼ŒopenEuleråœ¨å¤šæ¶æ„æ˜“è·å¾—æ€§å’Œæ€§èƒ½è¡¨ç°æ–¹é¢å±•ç°ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong></p>
<ol>
<li><strong>å…¨æ¶æ„è¦†ç›–</strong>ï¼šæ”¯æŒx86_64ã€AArch64ã€RISC-Vç­‰ä¸»æµæ¶æ„ï¼Œé•œåƒè·å–ä¾¿æ·</li>
<li><strong>ä¸€è‡´æ€§ä½“éªŒ</strong>ï¼šå„æ¶æ„å®‰è£…éƒ¨ç½²æµç¨‹ç»Ÿä¸€ï¼Œé™ä½ç”¨æˆ·å­¦ä¹ æˆæœ¬</li>
<li><strong>æ·±åº¦ä¼˜åŒ–</strong>ï¼šARMå¹³å°æ€§èƒ½è¾¾åˆ°ç”šè‡³è¶…è¶Šx86æ°´å¹³ï¼Œå¤šé¡¹æµ‹è¯•é¢†å…ˆ3-11%</li>
<li><strong>è™šæ‹ŸåŒ–æ€§èƒ½</strong>ï¼šè™šæ‹ŸåŒ–å¼€é”€å°äº8%ï¼Œè·¨æ¶æ„äº‘åŸç”Ÿåœºæ™¯è¡¨ç°ä¼˜å¼‚</li>
<li><strong>å®é™…è´Ÿè½½éªŒè¯</strong>ï¼šå®¹å™¨ã€ç¼–è¯‘ã€WebæœåŠ¡ç­‰å®é™…åœºæ™¯æ€§èƒ½è¡¨ç°çªå‡º</li>
</ol>
<p><strong>æ€§èƒ½æ•°æ®äº®ç‚¹ï¼š</strong></p>
<ul>
<li>ARMå¹³å°å†…å­˜å¸¦å®½æå‡ï¼š+10%</li>
<li>å®¹å™¨åº”ç”¨æ€§èƒ½æå‡ï¼š+3-8%</li>
<li>è™šæ‹ŸåŒ–æ•ˆç‡æå‡ï¼šå¼€é”€é™ä½1-2%</li>
<li>ç¼–è¯‘æ€§èƒ½æå‡ï¼š+39%ï¼ˆå¤šæ ¸ä¼˜åŠ¿ï¼‰</li>
</ul>
<p>å¦‚æœæ‚¨æ­£åœ¨å¯»æ‰¾é¢å‘æœªæ¥çš„å¼€æºæ“ä½œç³»ç»Ÿï¼Œä¸å¦¨çœ‹çœ‹DistroWatch æ¦œå•ä¸­å¿«é€Ÿä¸Šå‡çš„ openEuler: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdistrowatch.com%2Ftable-mobile.php%3Fdistribution%3Dopeneuler%25EF%25BC%258C%25E4%25B8%2580%25E4%25B8%25AA%25E7%2594%25B1%25E5%25BC%2580%25E6%2594%25BE%25E5%258E%259F%25E5%25AD%2590%25E5%25BC%2580%25E6%25BA%2590%25E5%259F%25BA%25E9%2587%2591%25E4%25BC%259A%25E5%25AD%25B5%25E5%258C%2596%25E3%2580%2581%25E6%2594%25AF%25E6%258C%2581%25E2%2580%259C%25E8%25B6%2585%25E8%258A%2582%25E7%2582%25B9%25E2%2580%259D%25E5%259C%25BA%25E6%2599%25AF%25E7%259A%2584Linux" target="_blank" title="https://distrowatch.com/table-mobile.php?distribution=openeuler%EF%BC%8C%E4%B8%80%E4%B8%AA%E7%94%B1%E5%BC%80%E6%94%BE%E5%8E%9F%E5%AD%90%E5%BC%80%E6%BA%90%E5%9F%BA%E9%87%91%E4%BC%9A%E5%AD%B5%E5%8C%96%E3%80%81%E6%94%AF%E6%8C%81%E2%80%9C%E8%B6%85%E8%8A%82%E7%82%B9%E2%80%9D%E5%9C%BA%E6%99%AF%E7%9A%84Linux" ref="nofollow noopener noreferrer">distrowatch.com/table-mobilâ€¦</a> å‘è¡Œç‰ˆã€‚</p>
<p>openEulerå®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.openeuler.openatom.cn%2Fzh%2F" target="_blank" title="https://www.openeuler.openatom.cn/zh/" ref="nofollow noopener noreferrer">openEuler | å¼€æºç¤¾åŒº | openEulerç¤¾åŒºå®˜ç½‘</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Pythonè¿›é˜¶ï¼šå‘Šåˆ«"å…¥é—¨å³åœæ»"ï¼Œè¿™3ä¸ªçŸ¥è¯†ç‚¹è®©ä»£ç ä¼˜é›…ç¿»å€]]></title>    <link>https://juejin.cn/post/7579832186879950898</link>    <guid>https://juejin.cn/post/7579832186879950898</guid>    <pubDate>2025-12-04T11:05:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579832186879950898" data-draft-id="7579819594271129638" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Pythonè¿›é˜¶ï¼šå‘Šåˆ«&quot;å…¥é—¨å³åœæ»&quot;ï¼Œè¿™3ä¸ªçŸ¥è¯†ç‚¹è®©ä»£ç ä¼˜é›…ç¿»å€"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2025-12-04T11:05:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AAAç®€å•ç©è½¬ç¨‹åºè®¾è®¡"/> <meta itemprop="url" content="https://juejin.cn/user/4294056357689099"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Pythonè¿›é˜¶ï¼šå‘Šåˆ«"å…¥é—¨å³åœæ»"ï¼Œè¿™3ä¸ªçŸ¥è¯†ç‚¹è®©ä»£ç ä¼˜é›…ç¿»å€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4294056357689099/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AAAç®€å•ç©è½¬ç¨‹åºè®¾è®¡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T11:05:53.000Z" title="Thu Dec 04 2025 11:05:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åˆšå­¦ä¼šPythonåŸºç¡€è¯­æ³•ï¼Œå´å†™ä¸å‡ºç®€æ´åˆçµæ´»çš„ä»£ç ï¼Ÿåˆ«æ…Œï¼ä»Šå¤©åˆ†äº«3ä¸ª"è¿›é˜¶ååŸºç¡€"çš„å®ç”¨çŸ¥è¯†ç‚¹ï¼Œæ¯ä¸ªéƒ½å¸¦å¯ç›´æ¥è¿è¡Œçš„ä»£ç ç¤ºä¾‹ï¼Œè®©ä½ ä»"èƒ½è·‘å°±è¡Œ"å‡çº§åˆ°"å†™å¾—æ¼‚äº®"ï½</p>
<h2 data-id="heading-0">ä¸€ã€å‡½æ•°å‚æ•°è¿›é˜¶ï¼šå‘Šåˆ«"å‚æ•°ä¸å¤Ÿç”¨"çš„å°´å°¬</h2>
<p>åŸºç¡€å‡½æ•°çš„å›ºå®šå‚æ•°çš„å¤ªæ­»æ¿ï¼Ÿè¯•è¯•é»˜è®¤å‚æ•°ã€*argså’Œ**kwargsï¼Œçµæ´»åº”å¯¹å„ç§ä¼ å‚åœºæ™¯ï¼</p>
<p>python</p>
<h4 data-id="heading-1">1. é»˜è®¤å‚æ•°ï¼šç»™å‚æ•°è®¾ä¸ª"å¤‡èƒ"</h4>
<p>def order_coffee(name, sugar=2):
"""ç‚¹å’–å•¡ï¼Œé»˜è®¤åŠ 2å—ç³–"""
return f"ä¸€æ¯{name}ï¼ŒåŠ {sugar}å—ç³–"</p>
<p>print(order_coffee("æ‹¿é“"))  # è¾“å‡ºï¼šä¸€æ¯æ‹¿é“ï¼ŒåŠ 2å—ç³–ï¼ˆç”¨é»˜è®¤å€¼ï¼‰
print(order_coffee("ç¾å¼", 0))  # è¾“å‡ºï¼šä¸€æ¯ç¾å¼ï¼ŒåŠ 0å—ç³–ï¼ˆè¦†ç›–é»˜è®¤å€¼ï¼‰</p>
<h4 data-id="heading-2">2. *argsï¼šæ¥æ”¶ä»»æ„ä¸ªä½ç½®å‚æ•°ï¼ˆæ‰“åŒ…æˆå…ƒç»„ï¼‰</h4>
<p>def sum_all(*args):
"""è®¡ç®—ä»»æ„ä¸ªæ•°çš„å’Œ"""
return sum(args)</p>
<p>print(sum_all(1, 2, 3))  # è¾“å‡ºï¼š6
print(sum_all(10, 20, 30, 40))  # è¾“å‡ºï¼š100</p>
<h4 data-id="heading-3">3. kwargsï¼šæ¥æ”¶ä»»æ„ä¸ªå…³é”®å­—å‚æ•°ï¼ˆæ‰“åŒ…æˆå­—å…¸ï¼‰</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">print_user</span>(<span class="hljs-params">**kwargs</span>):
    <span class="hljs-string">"""æ‰“å°ç”¨æˆ·ä¿¡æ¯ï¼Œå‚æ•°å¯å¤šå¯å°‘"""</span>
    <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> kwargs.items():
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{key}</span>ï¼š<span class="hljs-subst">{value}</span>"</span>)

print_user(name=<span class="hljs-string">"å°æ"</span>, age=<span class="hljs-number">25</span>, city=<span class="hljs-string">"ä¸Šæµ·"</span>)
<span class="hljs-comment"># è¾“å‡ºï¼š</span>
<span class="hljs-comment"># nameï¼šå°æ</span>
<span class="hljs-comment"># ageï¼š25</span>
<span class="hljs-comment"># cityï¼šä¸Šæµ·</span>
</code></pre>
<p>Â </p>
<h2 data-id="heading-4">äºŒã€åˆ—è¡¨æ¨å¯¼å¼ï¼šä¸€è¡Œä»£æ›¿3è¡Œå¾ªç¯ï¼Œæ•ˆç‡é¢œå€¼åŒåœ¨çº¿</h2>
<p>è¿˜åœ¨å†™å†—é•¿çš„forå¾ªç¯ç”Ÿæˆåˆ—è¡¨ï¼Ÿåˆ—è¡¨æ¨å¯¼å¼è®©ä½ ä¸€è¡Œæå®šï¼Œæ‰§è¡Œæ•ˆç‡è¿˜æ›´é«˜ï¼</p>
<pre><code class="hljs language-python" lang="python">  
<span class="hljs-comment"># åœºæ™¯ï¼šç­›é€‰1-10ä¸­çš„å¶æ•°ï¼Œå†ä¹˜ä»¥2</span>
<span class="hljs-comment"># åŸºç¡€å†™æ³•ï¼ˆ3è¡Œä»£ç ï¼‰</span>
old_list = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">11</span>))
new_list = []
<span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> old_list:
    <span class="hljs-keyword">if</span> num % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:
        new_list.append(num * <span class="hljs-number">2</span>)
<span class="hljs-built_in">print</span>(new_list)  <span class="hljs-comment"># è¾“å‡ºï¼š[4, 8, 12, 16, 20]</span>

<span class="hljs-comment"># è¿›é˜¶å†™æ³•ï¼ˆ1è¡Œåˆ—è¡¨æ¨å¯¼å¼ï¼‰</span>
new_list_fast = [num * <span class="hljs-number">2</span> <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> old_list <span class="hljs-keyword">if</span> num % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>]
<span class="hljs-built_in">print</span>(new_list_fast)  <span class="hljs-comment"># è¾“å‡ºï¼š[4, 8, 12, 16, 20]</span>

<span class="hljs-comment"># æ‰©å±•ï¼šå­—å…¸æ¨å¯¼å¼ï¼ˆå¿«é€Ÿç”Ÿæˆå­—å…¸ï¼‰</span>
dict_example = {num: <span class="hljs-string">f"æ•°å­—<span class="hljs-subst">{num}</span>"</span> <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>)}
<span class="hljs-built_in">print</span>(dict_example)  <span class="hljs-comment"># è¾“å‡ºï¼š{1: 'æ•°å­—1', 2: 'æ•°å­—2', 3: 'æ•°å­—3', 4: 'æ•°å­—4'}</span>
Â 
</code></pre>
<h2 data-id="heading-5">ä¸‰ã€è£…é¥°å™¨ï¼šç»™å‡½æ•°"ç©¿å¤–å¥—"ï¼Œä¸æ”¹ä»£ç åŠ åŠŸèƒ½</h2>
<p>æƒ³ç»™å‡½æ•°åŠ æ—¥å¿—ã€è®¡æ—¶åŠŸèƒ½ï¼Œåˆä¸æƒ³ä¿®æ”¹åŸä»£ç ï¼Ÿè£…é¥°å™¨å°±æ˜¯Pythonçš„"é»‘ç§‘æŠ€"ï¼</p>
<pre><code class="hljs language-python" lang="python">  
<span class="hljs-keyword">import</span> time

<span class="hljs-comment"># å®šä¹‰è£…é¥°å™¨ï¼šè®¡ç®—å‡½æ•°è¿è¡Œæ—¶é—´</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">time_calculator</span>(<span class="hljs-params">func</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):
        start = time.time()
        result = func(*args, **kwargs)  <span class="hljs-comment"># æ‰§è¡ŒåŸå‡½æ•°</span>
        end = time.time()
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å‡½æ•°<span class="hljs-subst">{func.__name__}</span>è¿è¡Œè€—æ—¶ï¼š<span class="hljs-subst">{end - start:<span class="hljs-number">.4</span>f}</span>ç§’"</span>)
        <span class="hljs-keyword">return</span> result
    <span class="hljs-keyword">return</span> wrapper

<span class="hljs-comment"># ç”¨@ç¬¦å·ç»™å‡½æ•°"ç©¿å¤–å¥—"</span>
<span class="hljs-meta">@time_calculator</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">slow_task</span>(<span class="hljs-params">n</span>):
    <span class="hljs-string">"""æ¨¡æ‹Ÿè€—æ—¶æ“ä½œï¼šæš‚åœnç§’"""</span>
    time.sleep(n)
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"ä»»åŠ¡å®Œæˆï¼ˆæš‚åœäº†<span class="hljs-subst">{n}</span>ç§’ï¼‰"</span>

<span class="hljs-comment"># è°ƒç”¨å‡½æ•°ï¼ˆè‡ªåŠ¨è§¦å‘è£…é¥°å™¨åŠŸèƒ½ï¼‰</span>
result = slow_task(<span class="hljs-number">1</span>)
<span class="hljs-built_in">print</span>(result)
<span class="hljs-comment"># è¾“å‡ºï¼š</span>
<span class="hljs-comment"># å‡½æ•°slow_taskè¿è¡Œè€—æ—¶ï¼š1.0012ç§’</span>
<span class="hljs-comment"># ä»»åŠ¡å®Œæˆï¼ˆæš‚åœäº†1ç§’ï¼‰</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ç†è§£JavaScript ä¸­ this çš„åº•å±‚è®¾è®¡ï¼šä»æ‰§è¡Œä¸Šä¸‹æ–‡åˆ°è°ƒç”¨æœºåˆ¶]]></title>    <link>https://juejin.cn/post/7579819594271178790</link>    <guid>https://juejin.cn/post/7579819594271178790</guid>    <pubDate>2025-12-04T11:19:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579819594271178790" data-draft-id="7579800429375291442" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ç†è§£JavaScript ä¸­ this çš„åº•å±‚è®¾è®¡ï¼šä»æ‰§è¡Œä¸Šä¸‹æ–‡åˆ°è°ƒç”¨æœºåˆ¶"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-12-04T11:19:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Tzarevich"/> <meta itemprop="url" content="https://juejin.cn/user/578786070367529"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ç†è§£JavaScript ä¸­ this çš„åº•å±‚è®¾è®¡ï¼šä»æ‰§è¡Œä¸Šä¸‹æ–‡åˆ°è°ƒç”¨æœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/578786070367529/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Tzarevich
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T11:19:10.000Z" title="Thu Dec 04 2025 11:19:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.8;font-weight:400;font-size:16px;word-spacing:2px;letter-spacing:2px;overflow-x:hidden;color:#3e3e3e;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:1.2em;border-bottom:2px solid #ef7060;word-spacing:0!important;letter-spacing:0!important;font-size:inherit;line-height:inherit;display:block;font-weight:400;background:#ef7060;color:#fff;padding:10px;border-top-right-radius:3px;border-top-left-radius:3px;margin-right:3px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-light">.hljs-comment,.hljs-quote{color:#696969}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d91e18}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa5d00}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:green}.hljs-section,.hljs-title{color:#007faa}.hljs-keyword,.hljs-selector-tag{color:#7928a1}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fefefe;color:#545454}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">JavaScript ä¸­ <code>this</code> çš„åº•å±‚è®¾è®¡ï¼šä»æ‰§è¡Œä¸Šä¸‹æ–‡åˆ°è°ƒç”¨æœºåˆ¶</h2>
<p>åœ¨ JavaScript è¯­è¨€ä¸­ï¼Œ<code>this</code> æ˜¯ä¸€ä¸ªç‹¬ç‰¹è€Œå…³é”®çš„æ¦‚å¿µã€‚å®ƒæ—¢ä¸æ˜¯å˜é‡ï¼Œä¹Ÿä¸éµå¾ªä½œç”¨åŸŸè§„åˆ™ï¼›å®ƒä¸ä¾èµ–å‡½æ•°å®šä¹‰çš„ä½ç½®ï¼Œå´å®Œå…¨ç”±<strong>å‡½æ•°å¦‚ä½•è¢«è°ƒç”¨</strong>å†³å®šã€‚è¿™ç§â€œåŠ¨æ€ç»‘å®šâ€æœºåˆ¶ä½¿ <code>this</code> æˆä¸º JavaScript æ‰§è¡Œæ¨¡å‹ä¸­æœ€çµæ´»ä¹Ÿæœ€å®¹æ˜“è¯¯è§£çš„éƒ¨åˆ†ã€‚æœ¬æ–‡å°†ä» <strong>ç¼–è¯‘ä¸æ‰§è¡Œæœºåˆ¶ã€æ‰§è¡Œä¸Šä¸‹æ–‡ç»“æ„ã€å†å²è®¾è®¡èƒŒæ™¯ã€ç»‘å®šè§„åˆ™åˆ†ç±»</strong> å››ä¸ªå±‚é¢ï¼Œæ·±å…¥å‰–æ <code>this</code> çš„åº•å±‚åŸç†ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€è‡ªç”±å˜é‡ vs <code>this</code>ï¼šé™æ€ä½œç”¨åŸŸä¸åŠ¨æ€ç»‘å®šçš„å¯¹ç«‹</h3>
<p>JavaScript çš„æ‰§è¡Œè¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š<strong>ç¼–è¯‘é˜¶æ®µï¼ˆCompilationï¼‰</strong> å’Œ <strong>æ‰§è¡Œé˜¶æ®µï¼ˆExecutionï¼‰</strong> ã€‚</p>
<h4 data-id="heading-2">1. è‡ªç”±å˜é‡çš„æŸ¥æ‰¾ï¼šè¯æ³•ä½œç”¨åŸŸï¼ˆLexical Scopeï¼‰</h4>
<ul>
<li>åœ¨ç¼–è¯‘é˜¶æ®µï¼Œå¼•æ“é€šè¿‡è¯æ³•åˆ†ææ„å»º <strong>ä½œç”¨åŸŸé“¾ï¼ˆScope Chainï¼‰</strong> ã€‚</li>
<li>å½“å‡½æ•°å†…éƒ¨å¼•ç”¨ä¸€ä¸ªæœªå£°æ˜çš„å˜é‡ï¼ˆè‡ªç”±å˜é‡ï¼‰ï¼Œå¼•æ“ä¼šæ²¿ç€ä½œç”¨åŸŸé“¾å‘ä¸ŠæŸ¥æ‰¾ã€‚</li>
<li>è¿™ä¸ªè¿‡ç¨‹æ˜¯<strong>é™æ€çš„</strong>â€”â€”åªå–å†³äºå‡½æ•°<strong>å®šä¹‰çš„ä½ç½®</strong>ï¼Œä¸è°ƒç”¨æ–¹å¼æ— å…³ã€‚</li>
</ul>

<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">let</span> site = <span class="hljs-string">'time.geekbang.com'</span>;

<span class="hljs-function">function <span class="hljs-title">getSite</span>()</span> {
    <span class="hljs-keyword">return</span> site; <span class="hljs-comment">// ç¼–è¯‘æ—¶å°±ç¡®å®šï¼šä»å¤–å±‚ä½œç”¨åŸŸæ‰¾ site</span>
}
</code></pre>
<blockquote>
<p>âœ… å˜é‡æŸ¥æ‰¾æ˜¯â€œçœ‹å®šä¹‰â€ï¼Œè€Œ <code>this</code> æ˜¯â€œçœ‹è°ƒç”¨â€ã€‚</p>
</blockquote>
<h4 data-id="heading-3">2. <code>this</code> çš„ä¾‹å¤–æ€§ï¼šè¿è¡Œæ—¶åŠ¨æ€ç»‘å®š</h4>
<ul>
<li><code>this</code> ä¸å±äºè¯æ³•ç¯å¢ƒï¼Œä¹Ÿä¸å‚ä¸ä½œç”¨åŸŸé“¾æŸ¥æ‰¾ã€‚</li>
<li>å®ƒçš„å€¼åœ¨<strong>å‡½æ•°è¢«è°ƒç”¨çš„é‚£ä¸€åˆ»</strong>æ‰ç¡®å®šï¼Œç”±<strong>è°ƒç”¨æ–¹å¼</strong>å†³å®šã€‚</li>
<li>è¿™ä½¿å¾— <code>this</code> æˆä¸º JavaScript æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­<strong>å”¯ä¸€åŠ¨æ€å­—æ®µ</strong>ã€‚</li>
</ul>
<blockquote>
<p>ğŸ”¥ <strong>æ ¸å¿ƒåŒºåˆ«</strong>ï¼š</p>
<ul>
<li>å˜é‡ï¼šç¼–è¯‘é˜¶æ®µ â†’ é™æ€ â†’ ä½œç”¨åŸŸé“¾</li>
<li><code>this</code>ï¼šæ‰§è¡Œé˜¶æ®µ â†’ åŠ¨æ€ â†’ è°ƒç”¨ä¸Šä¸‹æ–‡</li>
</ul>
</blockquote>
<hr/>
<h3 data-id="heading-4">äºŒã€ä¸ºä»€ä¹ˆè¦è®¾è®¡ <code>this</code>ï¼Ÿâ€”â€” æ— ç±»æ—¶ä»£çš„ OOP æ”¯æ’‘</h3>
<p>JavaScript æœ€åˆæ²¡æœ‰ <code>class</code>ï¼ˆç›´åˆ° ES6 æ‰å¼•å…¥ï¼‰ï¼Œä½†å¼€å‘è€…ä»éœ€è¦é¢å‘å¯¹è±¡çš„èƒ½åŠ›ï¼š<strong>è®©æ–¹æ³•èƒ½æ“ä½œæ‰€å±å¯¹è±¡çš„æ•°æ®</strong>ã€‚</p>
<p>è®¾æƒ³æ²¡æœ‰ <code>this</code> çš„åœºæ™¯ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">user</span> = { name: <span class="hljs-string">'æå®¢æ—¶é—´'</span> }<span class="hljs-comment">;</span>
function getName(obj) {
    return obj.name<span class="hljs-comment">;</span>
}
getName(user)<span class="hljs-comment">; // å¿…é¡»æ˜¾å¼ä¼ å‚ï¼Œä¸ç¬¦åˆâ€œæ–¹æ³•å±äºå¯¹è±¡â€çš„ç›´è§‰</span>
</code></pre>
<p>æœ‰äº† <code>this</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">user.<span class="hljs-property">getName</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>; <span class="hljs-comment">// è‡ªåŠ¨çŸ¥é“â€œæˆ‘æ˜¯è°çš„æ–¹æ³•â€</span>
};
user.<span class="hljs-title function_">getName</span>(); <span class="hljs-comment">// 'æå®¢æ—¶é—´'</span>
</code></pre>
<blockquote>
<p>âœ… <strong><code>this</code> çš„è®¾è®¡åˆè¡·</strong>ï¼š<br/>
åœ¨æ— ç±»ã€åŸºäºåŸå‹çš„è¯­è¨€ä¸­ï¼Œæä¾›ä¸€ç§æœºåˆ¶ï¼Œè®©<strong>åŒä¸€ä¸ªå‡½æ•°å¯ä»¥ä½œä¸ºå¤šä¸ªå¯¹è±¡çš„æ–¹æ³•å¤ç”¨</strong>ï¼Œå¹¶è‡ªåŠ¨è®¿é—®è°ƒç”¨è€…çš„æ•°æ®ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">ä¸‰ã€â€œä¸å¥½çš„è®¾è®¡â€ï¼Ÿâ€”â€” å…¨å±€ <code>this</code> ä¸ä¸¥æ ¼æ¨¡å¼çš„æ•‘èµ</h3>
<p>å°½ç®¡ <code>this</code> æœ‰å…¶ä»·å€¼ï¼Œä½† JavaScript çš„æ—©æœŸå®ç°ç¡®å®å­˜åœ¨ä¸€ä¸ª<strong>é¥±å—è¯Ÿç—…çš„è®¾è®¡</strong>ï¼š</p>
<blockquote>
<p><strong>å½“å‡½æ•°ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨æ—¶ï¼ˆå¦‚ <code>fn()</code>ï¼‰ï¼Œ<code>this</code> é»˜è®¤æŒ‡å‘å…¨å±€å¯¹è±¡ï¼ˆæµè§ˆå™¨ä¸­æ˜¯ <code>window</code>ï¼‰ã€‚</strong></p>
</blockquote>
<h4 data-id="heading-6">é—®é¢˜æ ¹æº</h4>
<ul>
<li>Brendan Eich åœ¨ 10 å¤©å†…è®¾è®¡ JS æ—¶ï¼Œä¸ºç®€åŒ–å®ç°ï¼Œè®© <code>this</code> â€œæ€»æœ‰å€¼â€ã€‚</li>
<li>ç»“åˆ <code>var</code> å£°æ˜ä¼šæŒ‚è½½åˆ° <code>window</code> çš„ç‰¹æ€§ï¼Œææ˜“é€ æˆ<strong>å…¨å±€æ±¡æŸ“</strong>ï¼š</li>
</ul>

<pre><code class="hljs language-ini" lang="ini">var <span class="hljs-attr">name</span> = <span class="hljs-string">'Global'</span><span class="hljs-comment">;</span>
function resetName() {
    <span class="hljs-attr">this.name</span> = <span class="hljs-string">'Hacked'</span><span class="hljs-comment">; // æ„å¤–ä¿®æ”¹ window.nameï¼</span>
}
resetName()<span class="hljs-comment">;</span>
console.log(window.name)<span class="hljs-comment">; // 'Hacked'</span>
</code></pre>
<h4 data-id="heading-7">ä¸¥æ ¼æ¨¡å¼çš„ä¿®æ­£</h4>
<p>ES5 å¼•å…¥çš„ä¸¥æ ¼æ¨¡å¼ï¼ˆ<code>'use strict'</code>ï¼‰è§£å†³äº†è¿™ä¸€é—®é¢˜ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-meta">'use strict'</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">resetName</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'Hacked'</span>; <span class="hljs-comment">// TypeError: Cannot set property 'name' of undefined</span>
}
<span class="hljs-title function_">resetName</span>(); <span class="hljs-comment">// this = undefined â†’ ç›´æ¥æŠ¥é”™</span>
</code></pre>
<blockquote>
<p>âœ… <strong>ä¸¥æ ¼æ¨¡å¼çš„æ„ä¹‰</strong>ï¼š<br/>
è®©æ— æ„ä¹‰çš„ <code>this</code> ç»‘å®šæ˜¾å¼å¤±è´¥ï¼Œé¿å…é™é»˜é”™è¯¯ï¼Œæå‡ä»£ç å¥å£®æ€§ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-8">å››ã€ä»æ‰§è¡Œä¸Šä¸‹æ–‡çœ‹Â <code>this</code></h3>
<p>è¦çœŸæ­£ç†è§£ <code>this</code> çš„è¡Œä¸ºï¼Œæˆ‘ä»¬å¿…é¡»æ·±å…¥ JavaScript å¼•æ“çš„è¿è¡Œæœºåˆ¶â€”â€”æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆExecution Contextï¼‰ã€‚æ¯å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼ŒJS å¼•æ“ä¼šä¸ºå…¶åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œè¿™ä¸ªä¸Šä¸‹æ–‡å°±åƒä¸€ä¸ªâ€œè¿è¡Œæ²™ç›’â€ï¼ŒåŒ…å«äº†å‡½æ•°æ‰§è¡Œæ‰€éœ€çš„ä¸€åˆ‡ä¿¡æ¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f5989a07c16477bb50f74788d862332~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVHphcmV2aWNo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765451950&amp;x-signature=iFDcAPYp4Rg4pDlHbxHVorTOzQ4%3D" alt="this.png" loading="lazy"/></p>
<p>è¿™å¼ å›¾æ¸…æ™°åœ°å±•ç¤ºäº†å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡çš„å››ä¸ªæ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼š<strong>å˜é‡ç¯å¢ƒ</strong>ã€<strong>è¯æ³•ç¯å¢ƒ</strong>ã€<strong>outerï¼ˆå¤–å±‚ç¯å¢ƒå¼•ç”¨ï¼‰</strong> å’Œ <strong>this</strong>ã€‚å…¶ä¸­ï¼Œå‰ä¸‰è€…åœ¨å‡½æ•°å®šä¹‰æ—¶å°±å·²åŸºæœ¬ç¡®å®šï¼Œå¹¶å…±åŒæ”¯æ’‘äº† JavaScript çš„è¯æ³•ä½œç”¨åŸŸå’Œé—­åŒ…æœºåˆ¶ï¼›è€Œ <strong><code>this</code> æ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨å‡½æ•°è°ƒç”¨æ—¶æ‰è¢«åŠ¨æ€èµ‹å€¼çš„å­—æ®µ</strong>ï¼Œå®ƒä¸å‚ä¸ä½œç”¨åŸŸé“¾çš„æŸ¥æ‰¾ï¼Œä¹Ÿä¸ä¾èµ–å‡½æ•°å®šä¹‰çš„ä½ç½®ã€‚</p>
<p>æ­£æ˜¯è¿™ç§è®¾è®¡ï¼Œä½¿å¾— <code>this</code> æˆä¸º JavaScript æ‰§è¡Œæ¨¡å‹ä¸­çš„â€œä¾‹å¤–â€â€”â€”å®ƒçš„å€¼å®Œå…¨ç”±<strong>è°ƒç”¨æ–¹å¼</strong>å†³å®šï¼Œè€Œéç¼–è¯‘é˜¶æ®µçš„é™æ€ç»“æ„ã€‚è¿™ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆåŒä¸€ä¸ªå‡½æ•°åœ¨ä¸åŒè°ƒç”¨åœºæ™¯ä¸‹ï¼Œ<code>this</code> ä¼šæŒ‡å‘å®Œå…¨ä¸åŒçš„å¯¹è±¡ã€‚</p>
<p>é€šè¿‡æ‰§è¡Œä¸Šä¸‹æ–‡çš„è§†è§’ï¼Œæˆ‘ä»¬å°±èƒ½æ˜ç™½ï¼š<code>this</code> å¹¶éâ€œç¥ç§˜æŒ‡é’ˆâ€ï¼Œè€Œæ˜¯å¼•æ“åœ¨åˆ›å»ºæ‰§è¡Œä¸Šä¸‹æ–‡æ—¶ï¼Œæ ¹æ®è°ƒç”¨è§„åˆ™å¡«å…¥çš„ä¸€ä¸ªè¿è¡Œæ—¶ç»‘å®šå€¼ã€‚</p>
<hr/>
<h3 data-id="heading-9">äº”ã€<code>this</code> æŒ‡å‘çš„äº”ç§æ ¸å¿ƒæƒ…å†µ</h3>
<p>æ ¹æ® ECMAScript è§„èŒƒï¼Œ<code>this</code> çš„ç»‘å®šéµå¾ªä»¥ä¸‹ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼š</p>
<h4 data-id="heading-10">1. <strong>new ç»‘å®š</strong>ï¼ˆæ„é€ å‡½æ•°è°ƒç”¨ï¼‰</h4>
<pre><code class="hljs language-ini" lang="ini">function Site(name) {
    <span class="hljs-attr">this.name</span> = name<span class="hljs-comment">; // this â†’ æ–°åˆ›å»ºçš„å®ä¾‹</span>
}
const <span class="hljs-attr">site</span> = new Site(<span class="hljs-string">'time.geekbang.com'</span>)<span class="hljs-comment">;</span>
</code></pre>
<ul>
<li>å¼•æ“è‡ªåŠ¨åˆ›å»ºå¯¹è±¡ã€é“¾æ¥åŸå‹ã€ç»‘å®š <code>this</code>ã€è¿”å›å®ä¾‹ã€‚</li>
</ul>
<h4 data-id="heading-11">2. <strong>æ˜¾å¼ç»‘å®š</strong>ï¼ˆ<code>.call</code> / <code>.apply</code> / <code>.bind</code>ï¼‰</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span>.<span class="hljs-title function_ invoke__">call</span>(obj, a, b);     <span class="hljs-comment">// ç«‹å³æ‰§è¡Œï¼Œthis = obj</span>
<span class="hljs-keyword">const</span> bound = <span class="hljs-keyword">fn</span>.<span class="hljs-title function_ invoke__">bind</span>(obj); <span class="hljs-comment">// è¿”å›æ°¸ä¹…ç»‘å®š this çš„æ–°å‡½æ•°</span>
</code></pre>
<h4 data-id="heading-12">3. <strong>éšå¼ç»‘å®š</strong>ï¼ˆå¯¹è±¡æ–¹æ³•è°ƒç”¨ï¼‰</h4>
<pre><code class="hljs language-scss" lang="scss">obj<span class="hljs-selector-class">.method</span>(); <span class="hljs-comment">// this = obj</span>
</code></pre>
<ul>
<li>
<p>âš ï¸ æ³¨æ„â€œç»‘å®šä¸¢å¤±â€ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">fn</span> = obj.method<span class="hljs-comment">;</span>
fn()<span class="hljs-comment">; // this â†’ å…¨å±€ / undefined</span>
</code></pre>
</li>
</ul>
<h4 data-id="heading-13">4. <strong>é»˜è®¤ç»‘å®š</strong>ï¼ˆæ™®é€šå‡½æ•°è°ƒç”¨ï¼‰</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-function"><span class="hljs-keyword">fn</span>(<span class="hljs-params"/>)</span>; <span class="hljs-comment">// éä¸¥æ ¼ â†’ windowï¼›ä¸¥æ ¼ â†’ undefined</span>
</code></pre>
<h4 data-id="heading-14">5. <strong>ç®­å¤´å‡½æ•°</strong>ï¼ˆæ— è‡ªå·±çš„ <code>this</code>ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> obj = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'outer'</span>,
    <span class="hljs-attr">fn</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>) <span class="hljs-comment">// this ç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸ</span>
};
</code></pre>
<ul>
<li>ç®­å¤´å‡½æ•°æ²¡æœ‰ <code>ThisBinding</code>ï¼Œ<code>this</code> åœ¨<strong>å®šä¹‰æ—¶</strong>æ•è·ï¼Œä¸å—è°ƒç”¨å½±å“ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-15">å…­ã€ç‰¹æ®Šåœºæ™¯ï¼šäº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„ <code>this</code></h3>
<p>åœ¨ DOM äº‹ä»¶ä¸­ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ç»‘å®š <code>this</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// this = button å…ƒç´ </span>
});
</code></pre>
<ul>
<li>è‹¥ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œåˆ™ <code>this</code> æŒ‡å‘å¤–å±‚ä½œç”¨åŸŸï¼ˆé€šå¸¸ä¸æ˜¯å…ƒç´ ï¼‰ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-16">ä¸ƒã€æ€»ç»“ï¼šç†è§£ <code>this</code> çš„æ­£ç¡®å§¿åŠ¿</h3>





























<table><thead><tr><th>å…³é”®è®¤çŸ¥</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong><code>this</code> ä¸æ˜¯ä½œç”¨åŸŸæ¦‚å¿µ</strong></td><td>å®ƒå±äºæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä¸å˜é‡æŸ¥æ‰¾æ— å…³</td></tr><tr><td><strong><code>this</code> ç”±è°ƒç”¨æ–¹å¼å†³å®š</strong></td><td>ä¸å‡½æ•°å®šä¹‰ä½ç½®æ— å…³</td></tr><tr><td><strong>è®¾è®¡åˆè¡·æ˜¯æ”¯æŒ OOP</strong></td><td>åœ¨æ—  class æ—¶ä»£å®ç°æ–¹æ³•å¤ç”¨</td></tr><tr><td><strong>å…¨å±€ <code>this</code> æ˜¯å†å²åŒ…è¢±</strong></td><td>ä¸¥æ ¼æ¨¡å¼å·²æœ‰æ•ˆè§„é¿</td></tr><tr><td><strong>æŒæ¡å››ç§ç»‘å®šè§„åˆ™</strong></td><td>new &gt; æ˜¾å¼ &gt; éšå¼ &gt; é»˜è®¤</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¬ <strong>è®°ä½è¿™å¥å£è¯€</strong>ï¼š<br/>
<strong>â€œå˜é‡çœ‹å®šä¹‰ï¼Œthis çœ‹è°ƒç”¨ï¼›<br/>
æ–¹æ³•å±è°å®¶ï¼Œç‚¹å·è¯´äº†ç®—ï¼â€</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-17">ç»“è¯­</h3>
<p><code>this</code> å¹¶é JavaScript çš„â€œç¼ºé™·â€ï¼Œè€Œæ˜¯å…¶<strong>å¤šèŒƒå¼èåˆ</strong>ï¼ˆå‡½æ•°å¼ + åŸºäºåŸå‹çš„ OOPï¼‰çš„å¿…ç„¶äº§ç‰©ã€‚å®ƒçš„åŠ¨æ€æ€§å¸¦æ¥äº†å¤æ‚æ€§ï¼Œä½†ä¹Ÿèµ‹äºˆäº†è¯­è¨€å¼ºå¤§çš„è¡¨è¾¾èƒ½åŠ›ã€‚ç†è§£ <code>this</code> çš„åº•å±‚æœºåˆ¶ï¼Œä¸ä»…èƒ½é¿å…å¸¸è§é”™è¯¯ï¼Œæ›´èƒ½è®©ä½ å†™å‡ºæ›´é«˜æ•ˆã€æ›´å®‰å…¨çš„ä»£ç ã€‚</p>
<p>å½“ä½ ä¸‹æ¬¡çœ‹åˆ° <code>this</code> æ—¶ï¼Œè¯·ä¸è¦æŠŠå®ƒå½“ä½œâ€œç¥ç§˜æŒ‡é’ˆâ€ï¼Œè€Œè¦æ€è€ƒï¼š <strong>â€œæ­¤åˆ»ï¼Œæ˜¯è°åœ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Ÿâ€</strong> â€”â€” ç­”æ¡ˆï¼Œå°±æ˜¯ <code>this</code>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäºVantçš„ç§»åŠ¨ç«¯å…¬å…±é€‰äºº/é€‰éƒ¨é—¨ç»„ä»¶è®¾è®¡æ–‡æ¡£]]></title>    <link>https://juejin.cn/post/7579813945600819240</link>    <guid>https://juejin.cn/post/7579813945600819240</guid>    <pubDate>2025-12-04T11:36:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579813945600819240" data-draft-id="7579410911057903642" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäºVantçš„ç§»åŠ¨ç«¯å…¬å…±é€‰äºº/é€‰éƒ¨é—¨ç»„ä»¶è®¾è®¡æ–‡æ¡£"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-04T11:36:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çˆ±åƒé¦™èœi"/> <meta itemprop="url" content="https://juejin.cn/user/712936594609816"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäºVantçš„ç§»åŠ¨ç«¯å…¬å…±é€‰äºº/é€‰éƒ¨é—¨ç»„ä»¶è®¾è®¡æ–‡æ¡£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/712936594609816/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çˆ±åƒé¦™èœi
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T11:36:23.000Z" title="Thu Dec 04 2025 11:36:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    23
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åŸºäºVantçš„ç§»åŠ¨ç«¯å…¬å…±é€‰äºº/é€‰éƒ¨é—¨ç»„ä»¶è®¾è®¡æ–‡æ¡£</h2>
<h3 data-id="heading-1">1. ç»„ä»¶æ¦‚è¿°</h3>
<h4 data-id="heading-2">1.1 ç»„ä»¶åç§°</h4>
<p><code>SelectPersonDeptMobile</code> - åŸºäºVantçš„ç§»åŠ¨ç«¯å…¬å…±é€‰äºº/é€‰éƒ¨é—¨ç»„ä»¶</p>
<h4 data-id="heading-3">1.2 ç»„ä»¶åŠŸèƒ½</h4>
<ul>
<li>æ”¯æŒé€‰æ‹©ç”¨æˆ·ã€è§’è‰²ã€ç»„ç»‡æ¶æ„ã€ç¾¤ç»„ã€å¿«é€ŸæŸ¥æ‰¾</li>
<li>æ”¯æŒå¤šé€‰/å•é€‰æ¨¡å¼ï¼ˆé€šè¿‡multipleå¸ƒå°”å€¼æ§åˆ¶ï¼‰</li>
<li>æ”¯æŒæœç´¢åŠŸèƒ½</li>
<li>æ”¯æŒå¹³é“ºåˆ—è¡¨å±•ç¤ºï¼Œé€šè¿‡ä¸‹çº§æŒ‰é’®åŠ è½½æ–°æ•°æ®</li>
<li>æ”¯æŒå·²é€‰äººå‘˜/éƒ¨é—¨å±•ç¤ºä¸ç®¡ç†</li>
<li>ç§»åŠ¨ç«¯å‹å¥½çš„äº¤äº’è®¾è®¡</li>
<li>åŸºäºVantç»„ä»¶åº“å®ç°</li>
<li>æ”¯æŒè‡ªå®šä¹‰é€‰æ‹©ç±»å‹</li>
</ul>
<h4 data-id="heading-4">1.3 è®¾è®¡ç†å¿µ</h4>
<ul>
<li>æ¨¡å—åŒ–è®¾è®¡ï¼Œä¾¿äºå¤ç”¨</li>
<li>åŸºäºVantç»„ä»¶åº“ï¼Œä¿è¯ç§»åŠ¨ç«¯ä½“éªŒä¸€è‡´æ€§</li>
<li>æ”¯æŒçµæ´»é…ç½®ï¼Œé€‚åº”ä¸åŒä¸šåŠ¡åœºæ™¯</li>
<li>ç±»å‹å®‰å…¨ï¼Œä½¿ç”¨TypeScriptç¡®ä¿ç±»å‹æ­£ç¡®</li>
<li>è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œæµç•…çš„äº¤äº’æ•ˆæœ</li>
<li>è½»é‡çº§è®¾è®¡ï¼Œæ€§èƒ½ä¼˜åŒ–</li>
<li>çº¯UIç»„ä»¶è®¾è®¡ï¼Œä¸æ•°æ®é€»è¾‘åˆ†ç¦»</li>
</ul>
<h3 data-id="heading-5">2. ç»„ä»¶ç»“æ„è®¾è®¡</h3>
<h4 data-id="heading-6">2.1 ç›®å½•ç»“æ„</h4>
<pre><code class="hljs language-bash" lang="bash">components/
â””â”€â”€ SelectPersonDeptMobile/
    â”œâ”€â”€ SelectPersonDeptMobile.vue    <span class="hljs-comment"># ä¸»ç»„ä»¶</span>
    â”œâ”€â”€ SelectPersonDept.types.ts     <span class="hljs-comment"># ç±»å‹å®šä¹‰æ–‡ä»¶</span>
    â”œâ”€â”€ components/                   <span class="hljs-comment"># å­ç»„ä»¶</span>
    â”‚   â”œâ”€â”€ SearchBar.vue             <span class="hljs-comment"># æœç´¢æ ç»„ä»¶ï¼ˆåŸºäºVant Searchï¼‰</span>
    â”‚   â”œâ”€â”€ TabNav.vue                <span class="hljs-comment"># æ ‡ç­¾å¯¼èˆªç»„ä»¶ï¼ˆåŸºäºVant Tabsï¼‰</span>
    â”‚   â”œâ”€â”€ SelectList.vue            <span class="hljs-comment"># å¹³é“ºåˆ—è¡¨ç»„ä»¶ï¼ˆåŸºäºVant List/Cellï¼‰</span>
    â”‚   â””â”€â”€ SelectedList.vue          <span class="hljs-comment"># å·²é€‰åˆ—è¡¨ç»„ä»¶ï¼ˆåŸºäºVant Tag/Cellï¼‰</span>
    â””â”€â”€ utils/                        <span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
        â””â”€â”€ helper.ts                 <span class="hljs-comment"># è¾…åŠ©å‡½æ•°</span>
</code></pre>
<h3 data-id="heading-7">3. ç±»å‹å®šä¹‰</h3>
<h4 data-id="heading-8">3.1 åŸºç¡€ç±»å‹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// SelectPersonDept.types.ts</span>

<span class="hljs-comment">// é€‰æ‹©é¡¹ç±»å‹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">SelectPersonDeptProps</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">string</span> = 'user' | 'role' | 'dept' | 'group' | 'quick_search'&gt; {
  tabs?: <span class="hljs-title class_">Array</span>&lt;{
    <span class="hljs-attr">tab</span>: T;
    <span class="hljs-attr">tab_name</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">uniKey</span>: <span class="hljs-built_in">string</span>;
    [<span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span>;
  }&gt;;
  <span class="hljs-comment">// å…¶ä»–propsä¿æŒä¸å˜</span>
}

<span class="hljs-comment">// æ ‡ç­¾é…ç½®</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">TabConfig</span> {
  <span class="hljs-attr">tab</span>: <span class="hljs-title class_">SelectItemType</span>;
  <span class="hljs-attr">tab_name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-keyword">interface</span>?: <span class="hljs-built_in">string</span>; // å¯é€‰ï¼Œæ ‡ç­¾é¡µå¯¹åº”çš„æ•°æ®æ¥å£æ ‡è¯†
  [key: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span>;
}

// ç”¨æˆ·ä¿¡æ¯
export <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserInfo</span> {
  <span class="hljs-attr">userId</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">userName</span>: <span class="hljs-built_in">string</span>;
  deptName?: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">userCode</span>: <span class="hljs-built_in">string</span>;
  [<span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span>;
}

<span class="hljs-comment">// éƒ¨é—¨ä¿¡æ¯</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">DeptInfo</span> {
  <span class="hljs-attr">deptId</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">deptName</span>: <span class="hljs-built_in">string</span>;
  parentId?: <span class="hljs-built_in">string</span>;
  hasChildren?: <span class="hljs-built_in">boolean</span>; <span class="hljs-comment">// æ˜¯å¦æœ‰ä¸‹çº§æ•°æ®</span>
  [<span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span>;
}

<span class="hljs-comment">// è§’è‰²ä¿¡æ¯</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">RoleInfo</span> {
  <span class="hljs-attr">roleId</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">roleName</span>: <span class="hljs-built_in">string</span>;
  [<span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span>;
}

<span class="hljs-comment">// ç¾¤ç»„ä¿¡æ¯</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">GroupInfo</span> {
  <span class="hljs-attr">groupId</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">groupName</span>: <span class="hljs-built_in">string</span>;
  [<span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span>;
}

<span class="hljs-comment">// é€šç”¨é€‰æ‹©é¡¹ï¼ˆé€‚é…Vantç»„ä»¶ï¼‰</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">SelectOption</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;            <span class="hljs-comment">// å¯¹åº”Vantçš„value</span>
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;          <span class="hljs-comment">// å¯¹åº”Vantçš„text</span>
  <span class="hljs-attr">type</span>: <span class="hljs-title class_">SelectItemType</span>;
  hasChildren?: <span class="hljs-built_in">boolean</span>; <span class="hljs-comment">// æ˜¯å¦æœ‰ä¸‹çº§æ•°æ®</span>
  disabled?: <span class="hljs-built_in">boolean</span>;    <span class="hljs-comment">// æ˜¯å¦ç¦ç”¨</span>
  [<span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span>;
}

<span class="hljs-comment">// å·²é€‰ç»“æœ</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">SelectedResult</span> {
  <span class="hljs-attr">users</span>: <span class="hljs-title class_">UserInfo</span>[];
  <span class="hljs-attr">depts</span>: <span class="hljs-title class_">DeptInfo</span>[];
  <span class="hljs-attr">roles</span>: <span class="hljs-title class_">RoleInfo</span>[];
  <span class="hljs-attr">groups</span>: <span class="hljs-title class_">GroupInfo</span>[];
  <span class="hljs-attr">quickContacts</span>: <span class="hljs-title class_">UserInfo</span>[];
}


<span class="hljs-comment">// ç»„ä»¶Props</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">SelectPersonDeptProps</span> {
  <span class="hljs-attr">modelValue</span>: <span class="hljs-title class_">SelectedResult</span>;       <span class="hljs-comment">// å·²é€‰ç»“æœï¼ˆç”¨äºå›æ˜¾å’ŒåŒå‘ç»‘å®šï¼‰</span>
  visible?: <span class="hljs-built_in">boolean</span>;               <span class="hljs-comment">// ç»„ä»¶æ˜¾ç¤ºçŠ¶æ€</span>
  tabs?: <span class="hljs-title class_">TabConfig</span>[];              <span class="hljs-comment">// æ ‡ç­¾é…ç½®</span>
  multiple?: <span class="hljs-built_in">boolean</span>;              <span class="hljs-comment">// æ˜¯å¦å¤šé€‰ï¼Œtrue=å¤šé€‰ï¼Œfalse=å•é€‰</span>
  placeholder?: <span class="hljs-built_in">string</span>;            <span class="hljs-comment">// æœç´¢æ¡†å ä½ç¬¦</span>
  showSelectedList?: <span class="hljs-built_in">boolean</span>;      <span class="hljs-comment">// æ˜¯å¦æ˜¾ç¤ºå·²é€‰åˆ—è¡¨</span>
  showConfirmBtn?: <span class="hljs-built_in">boolean</span>;        <span class="hljs-comment">// æ˜¯å¦æ˜¾ç¤ºç¡®è®¤æŒ‰é’®</span>
  confirmBtnText?: <span class="hljs-built_in">string</span>;         <span class="hljs-comment">// ç¡®è®¤æŒ‰é’®æ–‡æœ¬</span>
  cancelBtnText?: <span class="hljs-built_in">string</span>;          <span class="hljs-comment">// å–æ¶ˆæŒ‰é’®æ–‡æœ¬</span>
  currentList?: <span class="hljs-title class_">SelectOption</span>[];    <span class="hljs-comment">// å½“å‰åˆ—è¡¨æ•°æ®</span>
  loading?: <span class="hljs-built_in">boolean</span>;               <span class="hljs-comment">// åŠ è½½çŠ¶æ€</span>
  customUserList?: <span class="hljs-title class_">UserInfo</span>[];     <span class="hljs-comment">// è‡ªå®šä¹‰ç”¨æˆ·åˆ—è¡¨</span>

}

<span class="hljs-comment">// ç»„ä»¶äº‹ä»¶</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">SelectPersonDeptEmits</span> {
  <span class="hljs-string">'update:modelValue'</span>: [<span class="hljs-attr">value</span>: <span class="hljs-title class_">SelectedResult</span>]; <span class="hljs-comment">// å·²é€‰ç»“æœå˜åŒ–</span>
  <span class="hljs-string">'update:visible'</span>: [<span class="hljs-attr">visible</span>: <span class="hljs-built_in">boolean</span>];         <span class="hljs-comment">// ç»„ä»¶æ˜¾ç¤ºçŠ¶æ€å˜åŒ–</span>
  <span class="hljs-string">'confirm'</span>: [<span class="hljs-attr">value</span>: <span class="hljs-title class_">SelectedResult</span>];           <span class="hljs-comment">// ç¡®è®¤é€‰æ‹©</span>
  <span class="hljs-string">'cancel'</span>: [];                                <span class="hljs-comment">// å–æ¶ˆé€‰æ‹©</span>
  <span class="hljs-string">'search'</span>: [<span class="hljs-attr">keyword</span>: <span class="hljs-built_in">string</span>];                  <span class="hljs-comment">// æœç´¢</span>
  <span class="hljs-string">'tab-change'</span>: [<span class="hljs-attr">tab</span>: <span class="hljs-title class_">SelectItemType</span>];         <span class="hljs-comment">// æ ‡ç­¾åˆ‡æ¢</span>
  <span class="hljs-string">'next-level'</span>: [<span class="hljs-attr">item</span>: <span class="hljs-title class_">SelectOption</span>];          <span class="hljs-comment">// ç‚¹å‡»ä¸‹çº§æŒ‰é’®</span>
  <span class="hljs-string">'back-level'</span>: [<span class="hljs-attr">breadcrumb</span>: <span class="hljs-title class_">Array</span>&lt;{ <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">type</span>: <span class="hljs-title class_">SelectItemType</span> }&gt;]; <span class="hljs-comment">// è¿”å›ä¸Šä¸€çº§</span>
  <span class="hljs-string">'load-data'</span>: [<span class="hljs-attr">tab</span>: <span class="hljs-title class_">SelectItemType</span>, params?: <span class="hljs-built_in">any</span>]; <span class="hljs-comment">// è¯·æ±‚åŠ è½½æ•°æ®</span>
  <span class="hljs-string">'load-quick-search'</span>: [];                     <span class="hljs-comment">// è¯·æ±‚åŠ è½½å¿«é€ŸæŸ¥æ‰¾æ•°æ®</span>
  <span class="hljs-string">'select-all'</span>: [<span class="hljs-attr">checked</span>: <span class="hljs-built_in">boolean</span>];            <span class="hljs-comment">// å…¨é€‰/å–æ¶ˆå…¨é€‰</span>
  <span class="hljs-string">'close'</span>: [];                                 <span class="hljs-comment">// å…³é—­ç»„ä»¶</span>
}
</code></pre>
<pre><code class="hljs language-js" lang="js">
&lt;template&gt;
  &lt;<span class="hljs-title class_">SelectPersonDept</span>&lt;<span class="hljs-title class_">MyCustomType</span>&gt;
    :tabs=<span class="hljs-string">"customTabs"</span>
    @tab-change=<span class="hljs-string">"handleTabChange"</span>
  /&gt;
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
type <span class="hljs-title class_">MyCustomType</span> = <span class="hljs-string">'user1'</span> | <span class="hljs-string">'user2'</span> | <span class="hljs-string">'dept'</span> | <span class="hljs-string">'role'</span>;

<span class="hljs-keyword">const</span> customTabs = [
  { <span class="hljs-attr">tab</span>: <span class="hljs-string">'user1'</span>, <span class="hljs-attr">tab_name</span>: <span class="hljs-string">'æ™®é€šç”¨æˆ·'</span>, <span class="hljs-attr">uniKey</span>: <span class="hljs-string">'user1'</span> },
  { <span class="hljs-attr">tab</span>: <span class="hljs-string">'user2'</span>, <span class="hljs-attr">tab_name</span>: <span class="hljs-string">'VIPç”¨æˆ·'</span>, <span class="hljs-attr">uniKey</span>: <span class="hljs-string">'user2'</span> },
  { <span class="hljs-attr">tab</span>: <span class="hljs-string">'dept'</span>, <span class="hljs-attr">tab_name</span>: <span class="hljs-string">'éƒ¨é—¨'</span>, <span class="hljs-attr">uniKey</span>: <span class="hljs-string">'dept'</span> },
  { <span class="hljs-attr">tab</span>: <span class="hljs-string">'role'</span>, <span class="hljs-attr">tab_name</span>: <span class="hljs-string">'è§’è‰²'</span>, <span class="hljs-attr">uniKey</span>: <span class="hljs-string">'role'</span> }
] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleTabChange</span> = (<span class="hljs-params">tab: MyCustomType</span>) =&gt; {
  <span class="hljs-comment">// è·å¾—å®Œæ•´çš„ç±»å‹æç¤º</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Tab changed:'</span>, tab);
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-9">4. ç§»åŠ¨ç«¯çº¯UIç»„ä»¶è®¾è®¡ï¼ˆSelectPersonDeptMobileï¼‰</h3>
<h4 data-id="heading-10">4.1 ç»„ä»¶å®šä½</h4>
<ul>
<li><strong>çº¯UIç»„ä»¶</strong>ï¼šä»…è´Ÿè´£ç•Œé¢æ¸²æŸ“å’Œç”¨æˆ·äº¤äº’</li>
<li><strong>æ•°æ®é©±åŠ¨</strong>ï¼šæ‰€æœ‰æ•°æ®ç”±çˆ¶ç»„ä»¶é€šè¿‡propsä¼ å…¥</li>
<li><strong>äº‹ä»¶é©±åŠ¨</strong>ï¼šé€šè¿‡äº‹ä»¶ä¸çˆ¶ç»„ä»¶é€šä¿¡ï¼Œè§¦å‘æ•°æ®è·å–ç­‰æ“ä½œ</li>
<li><strong>å¯å¤ç”¨</strong>ï¼šé€‚ç”¨äºå„ç§éœ€è¦é€‰äºº/é€‰éƒ¨é—¨çš„ç§»åŠ¨ç«¯åœºæ™¯</li>
</ul>
<h4 data-id="heading-11">4.2 æ ¸å¿ƒè®¾è®¡åŸåˆ™</h4>
<ul>
<li><strong>UIä¸æ•°æ®åˆ†ç¦»</strong>ï¼šç»„ä»¶ä¸åŒ…å«ä»»ä½•æ•°æ®è·å–é€»è¾‘</li>
<li><strong>äº‹ä»¶é©±åŠ¨é€šä¿¡</strong>ï¼šé€šè¿‡äº‹ä»¶é€šçŸ¥çˆ¶ç»„ä»¶æ‰§è¡Œæ•°æ®æ“ä½œ</li>
<li><strong>å•å‘æ•°æ®æµ</strong>ï¼šæ•°æ®ä»çˆ¶ç»„ä»¶æµå‘å­ç»„ä»¶ï¼Œå˜åŒ–é€šè¿‡äº‹ä»¶åé¦ˆ</li>
<li><strong>çµæ´»é…ç½®</strong>ï¼šæ”¯æŒé€šè¿‡propsè‡ªå®šä¹‰å„ç§è¡Œä¸ºå’Œæ ·å¼</li>
</ul>
<h3 data-id="heading-12">5. æ•°æ®è·å–æ¸²æŸ“æµç¨‹</h3>
<h4 data-id="heading-13">5.1 å®Œæ•´æµç¨‹æ¦‚è§ˆ</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant çˆ¶ç»„ä»¶
    participant çº¯UIç»„ä»¶
    participant APIæ¥å£
    
    %% 0. å›æ˜¾æ•°æ®åˆå§‹åŒ–ï¼ˆæ–°å¢ï¼‰
    çˆ¶ç»„ä»¶-&gt;&gt;çˆ¶ç»„ä»¶: A. å‡†å¤‡åˆå§‹å·²é€‰æ•°æ®ï¼ˆå›æ˜¾æ•°æ®ï¼‰
    çˆ¶ç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: B. ä¼ å…¥åˆå§‹modelValueï¼ˆå·²é€‰æ•°æ®ï¼‰
    
    %% 1. ç»„ä»¶åˆå§‹åŒ–ä¸æ˜¾ç¤º
    çˆ¶ç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 1. è®¾ç½® visible=true
    çº¯UIç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 2. ç»„ä»¶æ¸²æŸ“æ˜¾ç¤º
    
    %% 2. åˆå§‹æ•°æ®åŠ è½½
    çˆ¶ç»„ä»¶-&gt;&gt;APIæ¥å£: 3. è°ƒç”¨é»˜è®¤æ ‡ç­¾æ•°æ®æ¥å£
    APIæ¥å£--&gt;&gt;çˆ¶ç»„ä»¶: 4. è¿”å›åˆ—è¡¨æ•°æ®
    çˆ¶ç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 5. æ›´æ–° currentList props
    çº¯UIç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 6. æ¸²æŸ“åˆ—è¡¨æ•°æ®å¹¶æ ¹æ®æœ¬åœ°é€‰ä¸­çŠ¶æ€æ ‡è®°å·²é€‰é¡¹
    çº¯UIç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 7. æ ¹æ®modelValueæ›´æ–°æœ¬åœ°é€‰ä¸­çŠ¶æ€ï¼ˆå›æ˜¾å¤„ç†ï¼‰
    
    %% 3. ç”¨æˆ·äº¤äº’ï¼šæ ‡ç­¾åˆ‡æ¢
    çº¯UIç»„ä»¶-&gt;&gt;çˆ¶ç»„ä»¶: 8. è§¦å‘ tab-change äº‹ä»¶ (æ–°æ ‡ç­¾)
    çˆ¶ç»„ä»¶-&gt;&gt;APIæ¥å£: 9. è°ƒç”¨æ–°æ ‡ç­¾æ•°æ®æ¥å£
    APIæ¥å£--&gt;&gt;çˆ¶ç»„ä»¶: 10. è¿”å›æ–°æ ‡ç­¾æ•°æ®
    çˆ¶ç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 11. æ›´æ–° currentList props
    çº¯UIç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 12. æ¸²æŸ“æ–°æ ‡ç­¾æ•°æ®å¹¶æ ‡è®°å·²é€‰é¡¹
    
    %% 4. ç”¨æˆ·äº¤äº’ï¼šæœç´¢
    çº¯UIç»„ä»¶-&gt;&gt;çˆ¶ç»„ä»¶: 19. è§¦å‘ search äº‹ä»¶ (å…³é”®è¯)
    çˆ¶ç»„ä»¶-&gt;&gt;APIæ¥å£: 20. è°ƒç”¨æœç´¢æ¥å£
    APIæ¥å£--&gt;&gt;çˆ¶ç»„ä»¶: 21. è¿”å›æœç´¢ç»“æœ
    çˆ¶ç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 22. æ›´æ–° currentList props
    çº¯UIç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 23. æ¸²æŸ“æœç´¢ç»“æœå¹¶æ ‡è®°å·²é€‰é¡¹
    
    %% 5. ç”¨æˆ·äº¤äº’ï¼šç‚¹å‡»ä¸‹çº§æŒ‰é’®
    çº¯UIç»„ä»¶-&gt;&gt;çˆ¶ç»„ä»¶: 24. è§¦å‘ next-level äº‹ä»¶ (item)
    çˆ¶ç»„ä»¶-&gt;&gt;APIæ¥å£: 25. è°ƒç”¨ä¸‹çº§æ•°æ®æ¥å£
    APIæ¥å£--&gt;&gt;çˆ¶ç»„ä»¶: 26. è¿”å›ä¸‹çº§æ•°æ®
    çˆ¶ç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 27. æ›´æ–° currentList props
    çº¯UIç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 28. æ¸²æŸ“ä¸‹çº§æ•°æ®å¹¶æ ‡è®°å·²é€‰é¡¹
    
    %% 6. ç”¨æˆ·äº¤äº’ï¼šè¿”å›ä¸Šä¸€çº§
    çº¯UIç»„ä»¶-&gt;&gt;çˆ¶ç»„ä»¶: 29. è§¦å‘ back-level äº‹ä»¶ (breadcrumb)
    çˆ¶ç»„ä»¶-&gt;&gt;APIæ¥å£: 30. è°ƒç”¨ä¸Šä¸€çº§æ•°æ®æ¥å£
    APIæ¥å£--&gt;&gt;çˆ¶ç»„ä»¶: 31. è¿”å›ä¸Šä¸€çº§æ•°æ®
    çˆ¶ç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 32. æ›´æ–° currentList props
    çº¯UIç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 33. æ¸²æŸ“ä¸Šä¸€çº§æ•°æ®å¹¶æ ‡è®°å·²é€‰é¡¹
    
    %% 7. ç”¨æˆ·äº¤äº’ï¼šé€‰æ‹©é¡¹
    çº¯UIç»„ä»¶-&gt;&gt;çˆ¶ç»„ä»¶: 34. è§¦å‘ select äº‹ä»¶ (item, checked)
    çˆ¶ç»„ä»¶-&gt;&gt;çˆ¶ç»„ä»¶: 35. å¤„ç†é€‰æ‹©é€»è¾‘ï¼Œæ›´æ–°å·²é€‰ç»“æœ
    çˆ¶ç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 36. æ›´æ–° modelValue props
    çº¯UIç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 37. æ›´æ–°æœ¬åœ°é€‰ä¸­çŠ¶æ€å’Œå·²é€‰åˆ—è¡¨æ˜¾ç¤º
    
    %% 8. ç»„ä»¶å…³é—­
    çº¯UIç»„ä»¶-&gt;&gt;çˆ¶ç»„ä»¶: 38. è§¦å‘ confirm/cancel äº‹ä»¶
    çˆ¶ç»„ä»¶-&gt;&gt;çˆ¶ç»„ä»¶: 39. å¤„ç†æœ€ç»ˆç»“æœ
    çˆ¶ç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 40. è®¾ç½® visible=false
    çº¯UIç»„ä»¶-&gt;&gt;çº¯UIç»„ä»¶: 41. ç»„ä»¶éšè—
</code></pre>
<h4 data-id="heading-14">5.2 è¯¦ç»†æµç¨‹è¯´æ˜</h4>
<h5 data-id="heading-15">5.2.0 0. å›æ˜¾æ•°æ®åˆå§‹åŒ–ï¼ˆæ–°å¢ï¼‰</h5>
<p><strong>è§¦å‘æ¡ä»¶</strong>ï¼šçˆ¶ç»„ä»¶å‡†å¤‡ä½¿ç”¨ç»„ä»¶å¹¶éœ€è¦æ˜¾ç¤ºå·²é€‰æ•°æ®æ—¶</p>
<p><strong>æ•°æ®æµå‘</strong>ï¼š</p>
<ol>
<li>çˆ¶ç»„ä»¶æ ¹æ®ä¸šåŠ¡éœ€æ±‚å‡†å¤‡åˆå§‹å·²é€‰æ•°æ®ï¼ˆå›æ˜¾æ•°æ®ï¼‰</li>
<li>çˆ¶ç»„ä»¶å°†åˆå§‹å·²é€‰æ•°æ®é€šè¿‡ <code>modelValue</code> propsä¼ å…¥çº¯UIç»„ä»¶</li>
<li>çº¯UIç»„ä»¶åœ¨åˆå§‹åŒ–æ—¶æ¥æ”¶ <code>modelValue</code></li>
</ol>
<p><strong>äº¤äº’è¯´æ˜</strong>ï¼š</p>
<ul>
<li>å›æ˜¾æ•°æ®å¯ä»¥æ˜¯æ¥è‡ªAPIè¯·æ±‚ã€è¡¨å•æ•°æ®æˆ–å…¶ä»–ä¸šåŠ¡é€»è¾‘</li>
<li>çˆ¶ç»„ä»¶éœ€è¦ç¡®ä¿å›æ˜¾æ•°æ®æ ¼å¼ç¬¦åˆ <code>SelectedResult</code> æ¥å£å®šä¹‰</li>
<li>æ”¯æŒç©ºå›æ˜¾æ•°æ®ï¼ˆåˆå§‹æœªé€‰æ‹©ä»»ä½•é¡¹ï¼‰</li>
</ul>
<h5 data-id="heading-16">5.2.1 1. ç»„ä»¶åˆå§‹åŒ–ä¸æ˜¾ç¤º</h5>
<p><strong>è§¦å‘æ¡ä»¶</strong>ï¼šçˆ¶ç»„ä»¶éœ€è¦æ‰“å¼€é€‰äººç»„ä»¶æ—¶</p>
<p><strong>æ•°æ®æµå‘</strong>ï¼š</p>
<ol>
<li>çˆ¶ç»„ä»¶é€šè¿‡è®¾ç½® <code>visible=true</code> æ‰“å¼€ç»„ä»¶</li>
<li>çº¯UIç»„ä»¶æ¸²æŸ“å¹¶æ˜¾ç¤º</li>
<li>çº¯UIç»„ä»¶æ ¹æ®ä¼ å…¥çš„ <code>modelValue</code> æ›´æ–°æœ¬åœ°é€‰ä¸­çŠ¶æ€ï¼ˆå›æ˜¾å¤„ç†æ ¸å¿ƒé€»è¾‘ï¼‰</li>
</ol>
<p><strong>äº¤äº’è¯´æ˜</strong>ï¼š</p>
<ul>
<li>ç»„ä»¶æ‰“å¼€æ—¶è‡ªåŠ¨å¤„ç†å›æ˜¾æ•°æ®ï¼Œå¹¶åŒæ­¥é€‰ä¸­çŠ¶æ€</li>
<li>æ”¯æŒé€šè¿‡propsé¢„è®¾åˆå§‹æ•°æ®ï¼Œé¿å…ç™½å±</li>
</ul>
<h5 data-id="heading-17">5.2.2 2. åˆå§‹æ•°æ®åŠ è½½</h5>
<p><strong>è§¦å‘æ¡ä»¶</strong>ï¼šç»„ä»¶æ‰“å¼€å</p>
<p><strong>æ•°æ®æµå‘</strong>ï¼š</p>
<ol>
<li>çˆ¶ç»„ä»¶æ ¹æ®äº‹ä»¶ç±»å‹è°ƒç”¨å¯¹åº”APIæ¥å£</li>
<li>APIè¿”å›æ•°æ®åï¼Œçˆ¶ç»„ä»¶é€šè¿‡propsæ›´æ–°åˆ°çº¯UIç»„ä»¶</li>
<li>çº¯UIç»„ä»¶æ¥æ”¶åˆ°æ–°æ•°æ®åæ¸²æŸ“</li>
<li>çº¯UIç»„ä»¶æ ¹æ®æœ¬åœ°ä¿å­˜çš„é€‰ä¸­çŠ¶æ€ï¼Œè‡ªåŠ¨æ ‡è®°åˆ—è¡¨ä¸­çš„å·²é€‰é¡¹ï¼ˆå›æ˜¾æ˜¾ç¤ºï¼‰</li>
</ol>
<p><strong>äº¤äº’è¯´æ˜</strong>ï¼š</p>
<ul>
<li>çˆ¶ç»„ä»¶è´Ÿè´£å¤„ç†APIè°ƒç”¨å’Œæ•°æ®è½¬æ¢</li>
<li>æ”¯æŒè®¾ç½® <code>loading</code> çŠ¶æ€ï¼Œæ˜¾ç¤ºåŠ è½½åŠ¨ç”»</li>
<li>æ”¯æŒå¤„ç†ç©ºæ•°æ®</li>
<li>æ•°æ®åŠ è½½å®Œæˆåè‡ªåŠ¨æ˜¾ç¤ºå·²é€‰é¡¹æ ‡è®°ï¼Œå®ç°å›æ˜¾æ•ˆæœ</li>
</ul>
<h5 data-id="heading-18">5.2.3 3. æ ‡ç­¾åˆ‡æ¢æ•°æ®åŠ è½½</h5>
<p><strong>è§¦å‘æ¡ä»¶</strong>ï¼šç”¨æˆ·ç‚¹å‡»ä¸åŒæ ‡ç­¾æ—¶</p>
<p><strong>æ•°æ®æµå‘</strong>ï¼š</p>
<ol>
<li>çº¯UIç»„ä»¶è§¦å‘ <code>tab-change</code> äº‹ä»¶ï¼Œæºå¸¦å½“å‰æ ‡ç­¾ç±»å‹</li>
<li>çˆ¶ç»„ä»¶æ ¹æ®æ ‡ç­¾ç±»å‹è°ƒç”¨å¯¹åº”APIæ¥å£</li>
<li>APIè¿”å›æ•°æ®åï¼Œçˆ¶ç»„ä»¶é€šè¿‡ <code>currentList</code> propsæ›´æ–°</li>
<li>çº¯UIç»„ä»¶é‡æ–°æ¸²æŸ“å¯¹åº”æ ‡ç­¾çš„æ•°æ®</li>
<li>çº¯UIç»„ä»¶æ ¹æ®æœ¬åœ°ä¿å­˜çš„é€‰ä¸­çŠ¶æ€ï¼Œè‡ªåŠ¨æ ‡è®°åˆ—è¡¨ä¸­çš„å·²é€‰é¡¹ï¼ˆå›æ˜¾æ˜¾ç¤ºï¼‰</li>
</ol>
<p><strong>äº¤äº’è¯´æ˜</strong>ï¼š</p>
<ul>
<li>æ ‡ç­¾åˆ‡æ¢æ—¶è‡ªåŠ¨é‡ç½®é¢åŒ…å±‘</li>
<li>æ”¯æŒä¸åŒæ ‡ç­¾ä½¿ç”¨ä¸åŒçš„APIæ¥å£</li>
<li>æ ‡ç­¾åˆ‡æ¢æ—¶æ˜¾ç¤ºåŠ è½½çŠ¶æ€</li>
<li>ä¸åŒæ ‡ç­¾ä¸‹çš„æ•°æ®ä¼šè‡ªåŠ¨æ ¹æ®å…¨å±€é€‰ä¸­çŠ¶æ€æ ‡è®°å·²é€‰é¡¹</li>
</ul>
<h5 data-id="heading-19">5.2.4 4. æœç´¢æ•°æ®åŠ è½½</h5>
<p><strong>è§¦å‘æ¡ä»¶</strong>ï¼šç”¨æˆ·åœ¨æœç´¢æ¡†è¾“å…¥å…³é”®è¯æ—¶</p>
<p><strong>æ•°æ®æµå‘</strong>ï¼š</p>
<ol>
<li>çº¯UIç»„ä»¶è§¦å‘ <code>search</code> äº‹ä»¶ï¼Œæºå¸¦æœç´¢å…³é”®è¯</li>
<li>çˆ¶ç»„ä»¶è°ƒç”¨æœç´¢APIæ¥å£</li>
<li>APIè¿”å›æœç´¢ç»“æœåï¼Œçˆ¶ç»„ä»¶é€šè¿‡ <code>currentList</code> propsæ›´æ–°</li>
<li>çº¯UIç»„ä»¶æ¸²æŸ“æœç´¢ç»“æœ</li>
<li>çº¯UIç»„ä»¶æ ¹æ®æœ¬åœ°ä¿å­˜çš„é€‰ä¸­çŠ¶æ€ï¼Œè‡ªåŠ¨æ ‡è®°æœç´¢ç»“æœä¸­çš„å·²é€‰é¡¹ï¼ˆå›æ˜¾æ˜¾ç¤ºï¼‰</li>
</ol>
<p><strong>äº¤äº’è¯´æ˜</strong>ï¼š</p>
<ul>
<li>æ”¯æŒå®æ—¶æœç´¢æˆ–é˜²æŠ–æœç´¢</li>
<li>æœç´¢ç»“æœä¸ºç©ºæ—¶æ˜¾ç¤ºç©ºçŠ¶æ€</li>
<li>æ”¯æŒæ¸…ç©ºæœç´¢æ¡ä»¶ï¼Œè¿”å›åŸå§‹åˆ—è¡¨</li>
<li>æœç´¢ç»“æœä¸­ä¼šè‡ªåŠ¨æ ‡è®°å·²é€‰é¡¹ï¼Œä¿æŒå›æ˜¾çŠ¶æ€</li>
</ul>
<h5 data-id="heading-20">5.2.5 5. ä¸‹çº§æ•°æ®åŠ è½½</h5>
<p><strong>è§¦å‘æ¡ä»¶</strong>ï¼šç”¨æˆ·ç‚¹å‡»åˆ—è¡¨é¡¹å³ä¾§çš„"ä¸‹çº§"æŒ‰é’®æ—¶</p>
<p><strong>æ•°æ®æµå‘</strong>ï¼š</p>
<ol>
<li>çº¯UIç»„ä»¶è§¦å‘ <code>next-level</code> äº‹ä»¶ï¼Œæºå¸¦å½“å‰é¡¹ä¿¡æ¯</li>
<li>çˆ¶ç»„ä»¶è°ƒç”¨è·å–ä¸‹çº§æ•°æ®çš„APIæ¥å£</li>
<li>APIè¿”å›ä¸‹çº§æ•°æ®åï¼Œçˆ¶ç»„ä»¶é€šè¿‡ <code>currentList</code> propsæ›´æ–°</li>
<li>çº¯UIç»„ä»¶æ¸²æŸ“ä¸‹çº§æ•°æ®</li>
<li>åŒæ—¶æ›´æ–°é¢åŒ…å±‘å¯¼èˆª</li>
<li>çº¯UIç»„ä»¶æ ¹æ®æœ¬åœ°ä¿å­˜çš„é€‰ä¸­çŠ¶æ€ï¼Œè‡ªåŠ¨æ ‡è®°ä¸‹çº§æ•°æ®ä¸­çš„å·²é€‰é¡¹ï¼ˆå›æ˜¾æ˜¾ç¤ºï¼‰</li>
</ol>
<p><strong>äº¤äº’è¯´æ˜</strong>ï¼š</p>
<ul>
<li>ä»…å½“åˆ—è¡¨é¡¹ <code>hasChildren=true</code> æ—¶æ˜¾ç¤º"ä¸‹çº§"æŒ‰é’®</li>
<li>ç‚¹å‡»åè‡ªåŠ¨æ›´æ–°é¢åŒ…å±‘ï¼Œä¾¿äºè¿”å›</li>
<li>æ”¯æŒå¤šçº§åµŒå¥—å¯¼èˆª</li>
<li>ä¸‹çº§æ•°æ®ä¸­ä¼šè‡ªåŠ¨æ ‡è®°å·²é€‰é¡¹ï¼Œä¿æŒå›æ˜¾çŠ¶æ€</li>
</ul>
<h5 data-id="heading-21">5.2.6 6. è¿”å›ä¸Šä¸€çº§æ•°æ®åŠ è½½</h5>
<p><strong>è§¦å‘æ¡ä»¶</strong>ï¼šç”¨æˆ·ç‚¹å‡»"è¿”å›ä¸Šä¸€çº§"æŒ‰é’®æˆ–é¢åŒ…å±‘é¡¹æ—¶</p>
<p><strong>æ•°æ®æµå‘</strong>ï¼š</p>
<ol>
<li>çº¯UIç»„ä»¶è§¦å‘ <code>back-level</code> äº‹ä»¶ï¼Œæºå¸¦å½“å‰é¢åŒ…å±‘ä¿¡æ¯</li>
<li>çˆ¶ç»„ä»¶è°ƒç”¨è·å–ä¸Šä¸€çº§æ•°æ®çš„APIæ¥å£</li>
<li>APIè¿”å›ä¸Šä¸€çº§æ•°æ®åï¼Œçˆ¶ç»„ä»¶é€šè¿‡ <code>currentList</code> propsæ›´æ–°</li>
<li>çº¯UIç»„ä»¶æ¸²æŸ“ä¸Šä¸€çº§æ•°æ®</li>
<li>åŒæ—¶æ›´æ–°é¢åŒ…å±‘å¯¼èˆª</li>
<li>çº¯UIç»„ä»¶æ ¹æ®æœ¬åœ°ä¿å­˜çš„é€‰ä¸­çŠ¶æ€ï¼Œè‡ªåŠ¨æ ‡è®°ä¸Šä¸€çº§æ•°æ®ä¸­çš„å·²é€‰é¡¹ï¼ˆå›æ˜¾æ˜¾ç¤ºï¼‰</li>
</ol>
<p><strong>äº¤äº’è¯´æ˜</strong>ï¼š</p>
<ul>
<li>æ”¯æŒé€šè¿‡é¢åŒ…å±‘ç›´æ¥è·³è½¬åˆ°ä»»æ„å±‚çº§</li>
<li>é¢åŒ…å±‘é¡¹æ”¯æŒç‚¹å‡»äº‹ä»¶</li>
<li>æ— ä¸Šçº§æ•°æ®æ—¶è‡ªåŠ¨éšè—è¿”å›æŒ‰é’®</li>
<li>ä¸Šä¸€çº§æ•°æ®ä¸­ä¼šè‡ªåŠ¨æ ‡è®°å·²é€‰é¡¹ï¼Œä¿æŒå›æ˜¾çŠ¶æ€</li>
</ul>
<h5 data-id="heading-22">5.2.7 7. é€‰æ‹©é¡¹å¤„ç†</h5>
<p><strong>è§¦å‘æ¡ä»¶</strong>ï¼šç”¨æˆ·ç‚¹å‡»é€‰æ‹©æ¡†ï¼ˆCheckbox/Radioï¼‰æ—¶</p>
<p><strong>æ•°æ®æµå‘</strong>ï¼š</p>
<ol>
<li>çº¯UIç»„ä»¶è§¦å‘ <code>select</code> äº‹ä»¶ï¼Œæºå¸¦é€‰æ‹©é¡¹å’Œé€‰ä¸­çŠ¶æ€</li>
<li>çˆ¶ç»„ä»¶æ ¹æ®é€‰æ‹©çŠ¶æ€æ›´æ–°å·²é€‰ç»“æœ</li>
<li>çˆ¶ç»„ä»¶é€šè¿‡ <code>modelValue</code> propsæ›´æ–°å·²é€‰ç»“æœ</li>
<li>çº¯UIç»„ä»¶æ›´æ–°å·²é€‰åˆ—è¡¨æ˜¾ç¤º</li>
</ol>
<p><strong>äº¤äº’è¯´æ˜</strong>ï¼š</p>
<ul>
<li>æ”¯æŒå¤šé€‰å’Œå•é€‰æ¨¡å¼</li>
<li>æ”¯æŒå…¨é€‰/å–æ¶ˆå…¨é€‰åŠŸèƒ½</li>
<li>å®æ—¶æ›´æ–°å·²é€‰åˆ—è¡¨</li>
</ul>
<h5 data-id="heading-23">5.2.8 8. ç»„ä»¶å…³é—­</h5>
<p><strong>è§¦å‘æ¡ä»¶</strong>ï¼šç”¨æˆ·ç‚¹å‡»"ç¡®è®¤"æˆ–"å–æ¶ˆ"æŒ‰é’®æ—¶</p>
<p><strong>æ•°æ®æµå‘</strong>ï¼š</p>
<ol>
<li>çº¯UIç»„ä»¶è§¦å‘ <code>confirm</code> æˆ– <code>cancel</code> äº‹ä»¶</li>
<li>çˆ¶ç»„ä»¶å¤„ç†æœ€ç»ˆç»“æœï¼ˆä¿å­˜æˆ–ä¸¢å¼ƒï¼‰</li>
<li>çˆ¶ç»„ä»¶è®¾ç½® <code>visible=false</code> å…³é—­ç»„ä»¶</li>
<li>çº¯UIç»„ä»¶éšè—</li>
</ol>
<p><strong>äº¤äº’è¯´æ˜</strong>ï¼š</p>
<ul>
<li>ç¡®è®¤æ—¶è¿”å›æœ€ç»ˆå·²é€‰ç»“æœ</li>
<li>å–æ¶ˆæ—¶ä¸ä¿å­˜ä»»ä½•æ›´æ”¹</li>
</ul>
<h5 data-id="heading-24">5.2.9 9. è™šæ‹Ÿæ»šåŠ¨</h5>
<p>é’ˆå¯¹å¤§æ•°æ®é‡ï¼ˆå¦‚10000+æ¡äººå‘˜æ•°æ®ï¼‰çš„æƒ…å†µï¼Œæˆ‘ä»åç«¯ã€å‰ç«¯å’Œäº¤äº’ä½“éªŒä¸‰ä¸ªå±‚é¢è®¾è®¡äº†å®Œæ•´çš„ä¼˜åŒ–ç­–ç•¥ï¼š</p>
<h6 data-id="heading-25">1. åç«¯å±‚é¢ï¼šåˆ†é¡µæŸ¥è¯¢æ˜¯åŸºç¡€</h6>
<ul>
<li>æ¥å£å¿…é¡»æ”¯æŒåˆ†é¡µï¼Œé»˜è®¤æ¯é¡µè¿”å›20-50æ¡æ•°æ®</li>
<li>åŒ…å«pageï¼ˆå½“å‰é¡µç ï¼‰ã€sizeï¼ˆæ¯é¡µæ¡æ•°ï¼‰å’Œtotalï¼ˆæ€»æ¡æ•°ï¼‰å‚æ•°</li>
<li>ç¤ºä¾‹è¯·æ±‚ï¼šapi.loadData(tab, { page: 1, size: 30 })</li>
<li>ç¡®ä¿åˆ†é¡µæŸ¥è¯¢çš„æ€§èƒ½ï¼Œå»ºè®®å¯¹æŸ¥è¯¢å­—æ®µå»ºç«‹ç´¢å¼•</li>
</ul>
<h6 data-id="heading-26">2. å‰ç«¯å±‚é¢ï¼šè™šæ‹Ÿæ»šåŠ¨æ˜¯æ ¸å¿ƒ</h6>
<ul>
<li>
<p>ä½¿ç”¨Vantçš„Listç»„ä»¶å®ç°è™šæ‹Ÿæ»šåŠ¨ï¼Œåªæ¸²æŸ“å¯è§†åŒºåŸŸå†…çš„åˆ—è¡¨é¡¹</p>
</li>
<li>
<p>é…ç½®é¢„åŠ è½½åç§»é‡ï¼ˆ50-100pxï¼‰ï¼Œæå‰åŠ è½½ä¸‹ä¸€é¡µæ•°æ®</p>
</li>
<li>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Vue
&lt;van-list
Â Â v-model:<span class="hljs-attr">loading</span>=<span class="hljs-string">"loading"</span>
Â Â :<span class="hljs-attr">finished</span>=<span class="hljs-string">"finished"</span>
Â Â @<span class="hljs-attr">load</span>=<span class="hljs-string">"onLoad"</span>
Â Â :<span class="hljs-attr">offset</span>=<span class="hljs-string">"50"</span>
&gt;
Â Â &lt;van-cell
Â Â Â Â <span class="hljs-attr">v-for</span>=<span class="hljs-string">"itemÂ inÂ currentList"</span>
Â Â Â Â :<span class="hljs-attr">key</span>=<span class="hljs-string">"item.id"</span>
Â Â Â Â :<span class="hljs-attr">title</span>=<span class="hljs-string">"item.name"</span>
Â Â &gt;
Â Â Â Â &lt;!--Â åˆ—è¡¨é¡¹å†…å®¹Â --&gt;
Â Â &lt;/van-cell&gt;
&lt;/van-list&gt;
</code></pre>
</li>
</ul>
<h6 data-id="heading-27">3. æœç´¢ä¼˜åŒ–ï¼šå‡å°‘ä¸å¿…è¦çš„è¯·æ±‚</h6>
<ul>
<li>
<p>200-300msé˜²æŠ–å¤„ç†ï¼Œé¿å…é¢‘ç¹è¾“å…¥å¯¼è‡´çš„å¤šæ¬¡è¯·æ±‚</p>
</li>
<li>
<p>æœç´¢å…³é”®è¯é•¿åº¦é™åˆ¶ï¼ˆè‡³å°‘2ä¸ªå­—ç¬¦ï¼‰</p>
</li>
<li>
<p>æœç´¢ç»“æœæ”¯æŒåˆ†é¡µåŠ è½½</p>
</li>
<li>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">TypeScript
constÂ <span class="hljs-attr">debouncedSearch</span>Â =Â debounce
((keyword:Â string)Â =&gt;Â {
Â Â ifÂ (keyword.trim().lengthÂ &gt;=Â 2)Â {
Â Â Â Â handleSearch(keyword)<span class="hljs-comment">;</span>
Â Â }
},Â 300)<span class="hljs-comment">;</span>
</code></pre>
</li>
</ul>
<h4 data-id="heading-28">5.3 äº‹ä»¶ä¸Propsæ˜ å°„å…³ç³»</h4>



























































<table><thead><tr><th>äº‹ä»¶å</th><th>è§¦å‘æ—¶æœº</th><th>å¯¹åº”Propsæ›´æ–°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>tab-change</code></td><td>æ ‡ç­¾åˆ‡æ¢</td><td><code>currentList</code></td><td>åˆ‡æ¢æ ‡ç­¾æ—¶è§¦å‘</td></tr><tr><td><code>search</code></td><td>æœç´¢è¾“å…¥</td><td><code>currentList</code></td><td>æœç´¢å…³é”®è¯å˜åŒ–æ—¶è§¦å‘</td></tr><tr><td><code>next-level</code></td><td>ç‚¹å‡»ä¸‹çº§æŒ‰é’®</td><td><code>currentList</code></td><td>åŠ è½½ä¸‹çº§æ•°æ®</td></tr><tr><td><code>back-level</code></td><td>è¿”å›ä¸Šä¸€çº§</td><td><code>currentList</code></td><td>åŠ è½½ä¸Šä¸€çº§æ•°æ®</td></tr><tr><td><code>select</code></td><td>é€‰æ‹©/å–æ¶ˆé€‰æ‹©</td><td><code>modelValue</code></td><td>æ›´æ–°å·²é€‰ç»“æœ</td></tr><tr><td><code>confirm</code></td><td>ç¡®è®¤é€‰æ‹©</td><td>-</td><td>ç¡®è®¤æœ€ç»ˆç»“æœ</td></tr><tr><td><code>cancel</code></td><td>å–æ¶ˆé€‰æ‹©</td><td>-</td><td>å–æ¶ˆé€‰æ‹©</td></tr><tr><td>-</td><td>ç»„ä»¶åˆå§‹åŒ–</td><td><code>modelValue</code></td><td>çˆ¶ç»„ä»¶ä¼ å…¥å›æ˜¾æ•°æ®ï¼Œçº¯UIç»„ä»¶å¤„ç†å¹¶æ›´æ–°æœ¬åœ°é€‰ä¸­çŠ¶æ€</td></tr></tbody></table>
<h4 data-id="heading-29">5.4 çˆ¶ç»„ä»¶æ ¸å¿ƒèŒè´£</h4>
<ol>
<li>
<p><strong>æ•°æ®ç®¡ç†</strong>ï¼š</p>
<ul>
<li>è°ƒç”¨APIè·å–å„ç§æ•°æ®</li>
<li>å¤„ç†æ•°æ®è½¬æ¢å’Œæ ¼å¼åŒ–</li>
<li>ç»´æŠ¤å·²é€‰ç»“æœçŠ¶æ€</li>
<li>å‡†å¤‡å’Œç®¡ç†å›æ˜¾æ•°æ®ï¼ˆåˆå§‹å·²é€‰æ•°æ®ï¼‰</li>
</ul>
</li>
<li>
<p><strong>äº‹ä»¶å¤„ç†</strong>ï¼š</p>
<ul>
<li>ç›‘å¬çº¯UIç»„ä»¶å‘å‡ºçš„æ‰€æœ‰äº‹ä»¶</li>
<li>æ ¹æ®äº‹ä»¶ç±»å‹æ‰§è¡Œå¯¹åº”é€»è¾‘</li>
<li>æ›´æ–°ç»„ä»¶props</li>
<li>å¤„ç†å›æ˜¾æ•°æ®çš„åˆå§‹åŒ–å’Œæ›´æ–°</li>
</ul>
</li>
<li>
<p><strong>æ•°æ®ç¼“å­˜ç­–ç•¥</strong>ï¼š</p>
</li>
</ol>
<ul>
<li>
<p>ä½¿ç”¨Mapæ•°æ®ç»“æ„ç¼“å­˜å·²åŠ è½½çš„æ•°æ®</p>
<ul>
<li>
<p>é«˜æ•ˆçš„æŸ¥æ‰¾æ€§èƒ½ ï¼šMapçš„æŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ï¼Œæ¯”æ•°ç»„éå†æ›´é«˜æ•ˆ</p>
</li>
<li>
<p>çµæ´»çš„é”®ç±»å‹ ï¼šå¯ä»¥ä½¿ç”¨å¤åˆå­—ç¬¦ä¸²ä½œä¸ºé”®ï¼Œä¾¿äºåŒºåˆ†ä¸åŒtabå’Œå‚æ•°ç»„åˆçš„æ•°æ®</p>
</li>
<li>
<p>é¿å…é‡å¤è¯·æ±‚ ï¼šåˆ‡æ¢tabæˆ–è¿”å›ä¸Šä¸€çº§æ—¶ï¼Œç›´æ¥ä»ç¼“å­˜è·å–æ•°æ®ï¼Œå‡å°‘APIè°ƒç”¨æ¬¡æ•°</p>
</li>
<li>
<p>æå‡ç”¨æˆ·ä½“éªŒ ï¼šç¼“å­˜æ•°æ®å¯ç«‹å³æ˜¾ç¤ºï¼Œé¿å…åŠ è½½ç­‰å¾…ï¼Œæå‡äº¤äº’æµç•…åº¦</p>
</li>
</ul>
</li>
<li>
<p>ç»„ä»¶å…³é—­æ—¶æ¸…ç©ºç¼“å­˜</p>
<ul>
<li>é¿å…å†…å­˜æ³„æ¼ ï¼šé•¿æ—¶é—´ä¸æ¸…é™¤ç¼“å­˜å¯èƒ½å¯¼è‡´å†…å­˜å ç”¨è¿‡é«˜</li>
<li>æ•°æ®æ—¶æ•ˆæ€§ ï¼šç¡®ä¿ä¸‹æ¬¡æ‰“å¼€ç»„ä»¶æ—¶è·å–æœ€æ–°æ•°æ®</li>
<li>å‡å°‘ä¸å¿…è¦çš„èµ„æºå ç”¨ ï¼šç»„ä»¶ä¸å†ä½¿ç”¨æ—¶é‡Šæ”¾ç›¸å…³èµ„æº</li>
<li>é¿å…æ•°æ®ä¸ä¸€è‡´ ï¼šé˜²æ­¢ç¼“å­˜æ•°æ®ä¸å®é™…ä¸šåŠ¡æ•°æ®ä¸ä¸€è‡´</li>
</ul>
</li>
</ul>
<h4 data-id="heading-30">5.5 çº¯UIç»„ä»¶æ ¸å¿ƒèŒè´£</h4>
<ol>
<li>
<p><strong>ç•Œé¢æ¸²æŸ“</strong>ï¼š</p>
<ul>
<li>æ ¹æ®propsæ¸²æŸ“åˆ—è¡¨æ•°æ®</li>
<li>æ¸²æŸ“å·²é€‰åˆ—è¡¨</li>
<li>æ¸²æŸ“åŠ è½½çŠ¶æ€å’Œç©ºçŠ¶æ€</li>
<li>æ ¹æ®å›æ˜¾æ•°æ®æ ‡è®°å·²é€‰é¡¹</li>
</ul>
</li>
<li>
<p><strong>ç”¨æˆ·äº¤äº’</strong>ï¼š</p>
<ul>
<li>å¤„ç†ç”¨æˆ·ç‚¹å‡»ã€æ»‘åŠ¨ç­‰æ“ä½œ</li>
<li>ç»´æŠ¤æœ¬åœ°ä¸´æ—¶çŠ¶æ€ï¼ˆå¦‚é€‰ä¸­çŠ¶æ€ï¼‰</li>
<li>è§¦å‘ç›¸åº”äº‹ä»¶</li>
</ul>
</li>
<li>
<p><strong>çŠ¶æ€åŒæ­¥</strong>ï¼š</p>
<ul>
<li>å“åº”propså˜åŒ–ï¼Œæ›´æ–°UI</li>
<li>ä¿æŒä¸çˆ¶ç»„ä»¶æ•°æ®ä¸€è‡´</li>
<li>å¤„ç†å›æ˜¾æ•°æ®ï¼šå°†modelValueè½¬æ¢ä¸ºæœ¬åœ°é€‰ä¸­çŠ¶æ€</li>
<li>åœ¨æ•°æ®åŠ è½½å®Œæˆåï¼Œæ ¹æ®æœ¬åœ°é€‰ä¸­çŠ¶æ€æ ‡è®°å·²é€‰é¡¹</li>
</ul>
</li>
</ol>
<h3 data-id="heading-31">6. ç»„ä»¶API</h3>
<h4 data-id="heading-32">6.1 Props</h4>

























































































<table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>v-model</td><td><code>SelectedResult</code></td><td>-</td><td>åŒå‘ç»‘å®šçš„å·²é€‰ç»“æœ</td></tr><tr><td>v-model:visible</td><td><code>boolean</code></td><td><code>false</code></td><td>æ§åˆ¶ç»„ä»¶æ˜¾ç¤º/éšè—</td></tr><tr><td>tabs</td><td><code>TabConfig[]</code></td><td>è§é»˜è®¤é…ç½®</td><td>æ ‡ç­¾é…ç½®ï¼ŒåŒ…å«å¿«é€ŸæŸ¥æ‰¾é¡¹</td></tr><tr><td>multiple</td><td><code>boolean</code></td><td><code>true</code></td><td>æ˜¯å¦æ”¯æŒå¤šé€‰ï¼Œ<strong>true=å¤šé€‰ï¼Œfalse=å•é€‰</strong></td></tr><tr><td>placeholder</td><td><code>string</code></td><td><code>'è¯·è¾“å…¥æœç´¢å…³é”®è¯'</code></td><td>æœç´¢æ¡†å ä½ç¬¦</td></tr><tr><td>showSelectedList</td><td><code>boolean</code></td><td><code>true</code></td><td>æ˜¯å¦æ˜¾ç¤ºå·²é€‰åˆ—è¡¨</td></tr><tr><td>showConfirmBtn</td><td><code>boolean</code></td><td><code>true</code></td><td>æ˜¯å¦æ˜¾ç¤ºç¡®è®¤æŒ‰é’®</td></tr><tr><td>confirmBtnText</td><td><code>string</code></td><td><code>'ç¡®è®¤'</code></td><td>ç¡®è®¤æŒ‰é’®æ–‡æœ¬</td></tr><tr><td>cancelBtnText</td><td><code>string</code></td><td><code>'å–æ¶ˆ'</code></td><td>å–æ¶ˆæŒ‰é’®æ–‡æœ¬</td></tr><tr><td>currentList</td><td><code>SelectOption[]</code></td><td><code>[]</code></td><td>å½“å‰åˆ—è¡¨æ•°æ®</td></tr><tr><td>loading</td><td><code>boolean</code></td><td><code>false</code></td><td>åŠ è½½çŠ¶æ€</td></tr><tr><td>lowcodeStoreId</td><td><code>string</code></td><td><code>''</code></td><td>ä½ä»£ç å­˜å‚¨ID</td></tr><tr><td>customUserList</td><td><code>UserInfo[]</code></td><td><code>[]</code></td><td>è‡ªå®šä¹‰ç”¨æˆ·åˆ—è¡¨</td></tr></tbody></table>
<h4 data-id="heading-33">6.2 Emits</h4>




























































<table><thead><tr><th>äº‹ä»¶å</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>update:modelValue</td><td><code>(value: SelectedResult) =&gt; void</code></td><td>å·²é€‰ç»“æœå˜åŒ–æ—¶è§¦å‘</td></tr><tr><td>update:visible</td><td><code>(visible: boolean) =&gt; void</code></td><td>ç»„ä»¶æ˜¾ç¤ºçŠ¶æ€å˜åŒ–æ—¶è§¦å‘</td></tr><tr><td>confirm</td><td><code>(value: SelectedResult) =&gt; void</code></td><td>ç¡®è®¤é€‰æ‹©æ—¶è§¦å‘</td></tr><tr><td>cancel</td><td><code>() =&gt; void</code></td><td>å–æ¶ˆé€‰æ‹©æ—¶è§¦å‘</td></tr><tr><td>search</td><td><code>(keyword: string) =&gt; void</code></td><td>æœç´¢æ—¶è§¦å‘ï¼Œæºå¸¦æœç´¢å…³é”®è¯</td></tr><tr><td>tab-change</td><td><code>(tab: SelectItemType) =&gt; void</code></td><td>æ ‡ç­¾åˆ‡æ¢æ—¶è§¦å‘ï¼Œæºå¸¦æ ‡ç­¾ç±»å‹</td></tr><tr><td>next-level</td><td><code>(item: SelectOption) =&gt; void</code></td><td>ç‚¹å‡»ä¸‹çº§æŒ‰é’®æ—¶è§¦å‘ï¼Œæºå¸¦å½“å‰é¡¹ä¿¡æ¯</td></tr><tr><td>back-level</td><td><code>(breadcrumb: Array&lt;{ name: string; id: string; type: SelectItemType }&gt;) =&gt; void</code></td><td>è¿”å›ä¸Šä¸€çº§æ—¶è§¦å‘ï¼Œæºå¸¦é¢åŒ…å±‘ä¿¡æ¯</td></tr><tr><td>select-all</td><td><code>(checked: boolean) =&gt; void</code></td><td>å…¨é€‰/å–æ¶ˆå…¨é€‰æ—¶è§¦å‘ï¼Œæºå¸¦é€‰ä¸­çŠ¶æ€</td></tr><tr><td>close</td><td><code>() =&gt; void</code></td><td>å…³é—­ç»„ä»¶æ—¶è§¦å‘</td></tr></tbody></table>
<h3 data-id="heading-34">7. å·¥æ—¶è¡¨</h3>

















































































































<table><thead><tr><th>æ—¥æœŸ</th><th>ä»»åŠ¡åç§°</th><th>è¯¦ç»†å·¥ä½œå†…å®¹</th><th>ä¼˜å…ˆçº§</th><th>è®¡åˆ’å·¥æ—¶ï¼ˆhï¼‰</th></tr></thead><tbody><tr><td>ç¬¬1å¤©</td><td>ç»„ä»¶ç»“æ„æ­å»º</td><td>1. åˆ›å»ºç»„ä»¶ç›®å½•ç»“æ„<br/>2. åˆ›å»ºä¸»ç»„ä»¶æ–‡ä»¶<br/>3. æ­å»ºåŸºç¡€å¸ƒå±€æ¡†æ¶</td><td>é«˜</td><td>8</td></tr><tr><td>ç¬¬2å¤©</td><td>å­ç»„ä»¶å¼€å‘ï¼ˆæœç´¢æ +æ ‡ç­¾ï¼‰</td><td>1. å¼€å‘SearchBaræœç´¢æ ç»„ä»¶<br/>2. å¼€å‘TabNavæ ‡ç­¾å¯¼èˆªç»„ä»¶<br/>3. é›†æˆå­ç»„ä»¶åˆ°ä¸»ç»„ä»¶<br/>4. å®ç°æœç´¢å’Œæ ‡ç­¾åˆ‡æ¢äº‹ä»¶</td><td>é«˜</td><td>8</td></tr><tr><td>ç¬¬3å¤©</td><td>å¹³é“ºåˆ—è¡¨æ ¸å¿ƒåŠŸèƒ½</td><td>1. å¼€å‘SelectListå¹³é“ºåˆ—è¡¨ç»„ä»¶<br/>2. å®ç°åˆ—è¡¨é¡¹æ¸²æŸ“<br/>3. å¼€å‘"ä¸‹çº§"æŒ‰é’®åŠŸèƒ½<br/>4. å®ç°é¢åŒ…å±‘å¯¼èˆª</td><td>é«˜</td><td>8</td></tr><tr><td>ç¬¬4å¤©</td><td>é€‰æ‹©åŠŸèƒ½å®ç°</td><td>1. å®ç°å•é€‰/å¤šé€‰é€»è¾‘<br/>2. å¼€å‘é€‰æ‹©çŠ¶æ€ç®¡ç†<br/>3. å®ç°å…¨é€‰/å–æ¶ˆå…¨é€‰åŠŸèƒ½<br/>4. é›†æˆåˆ°åˆ—è¡¨ç»„ä»¶</td><td>é«˜</td><td>8</td></tr><tr><td>ç¬¬5å¤©</td><td>å·²é€‰åˆ—è¡¨å¼€å‘</td><td>1. å¼€å‘SelectedListå·²é€‰åˆ—è¡¨ç»„ä»¶<br/>2. å®ç°å·²é€‰é¡¹å±•ç¤º<br/>3. å¼€å‘å·²é€‰é¡¹åˆ é™¤åŠŸèƒ½<br/>4. é›†æˆåˆ°ä¸»ç»„ä»¶</td><td>ä¸­</td><td>8</td></tr><tr><td>ç¬¬6å¤©</td><td>å¿«é€ŸæŸ¥æ‰¾åŠŸèƒ½</td><td>1. å¼€å‘å¿«é€ŸæŸ¥æ‰¾æ¨¡å—<br/>4. é›†æˆåˆ°ä¸»ç»„ä»¶</td><td>ä¸­</td><td>8</td></tr><tr><td>ç¬¬7å¤©</td><td>å›æ˜¾æ•°æ®é€»è¾‘</td><td>1. å®ç°modelValueåŒå‘ç»‘å®š<br/>2. å¼€å‘å›æ˜¾æ•°æ®å¤„ç†<br/>3. å®ç°æœ¬åœ°é€‰ä¸­çŠ¶æ€ç®¡ç†<br/></td><td>é«˜</td><td>8</td></tr><tr><td>ç¬¬8å¤©</td><td>ç»„ä»¶é›†æˆä¸è°ƒè¯•</td><td>1. æ•´åˆæ‰€æœ‰å­ç»„ä»¶<br/>2. è°ƒè¯•ç»„ä»¶é—´é€šä¿¡<br/>3. ä¿®å¤å‘ç°çš„é—®é¢˜</td><td>é«˜</td><td>8</td></tr><tr><td>ç¬¬9å¤©</td><td>å•ä¸ªæ—§ç»„ä»¶æ›¿æ¢å¹¶è°ƒè¯•</td><td>1. æ¥å£è”è°ƒ<br/>2. é‡æ„åŸæœ‰åŠŸèƒ½ç‚¹<br/></td><td>é«˜</td><td>8</td></tr><tr><td>ç¬¬10å¤©</td><td>å•ä¸ªæ—§ç»„ä»¶æ›¿æ¢å¹¶è°ƒè¯•</td><td>1. æ¥å£è”è°ƒ<br/>2. é‡æ„åŸæœ‰åŠŸèƒ½ç‚¹<br/></td><td>é«˜</td><td>8</td></tr><tr><td>ç¬¬11å¤©</td><td>å•ä¸ªæ—§ç»„ä»¶æ›¿æ¢å¹¶è°ƒè¯•</td><td>1. æµ‹è¯•ç§»åŠ¨ç«¯é€‚é…<br/>2. ä¿®å¤æµ‹è¯•ä¸­å‘ç°çš„é—®é¢˜</td><td>ä¸­</td><td>8</td><td/><td>ä¸­</td><td>8</td></tr><tr><td>ç¬¬12å¤©</td><td>æ‰€æœ‰æ—§ç»„ä»¶æ›¿æ¢å¹¶è°ƒè¯•</td><td>1. æ¥å£è”è°ƒ<br/>2. é‡æ„åŸæœ‰åŠŸèƒ½ç‚¹<br/></td><td>ä¸­</td><td>8</td></tr><tr><td>ç¬¬13å¤©</td><td>æ‰€æœ‰æ—§ç»„ä»¶æ›¿æ¢å¹¶è°ƒè¯•</td><td>1. æ¥å£è”è°ƒ<br/>2. é‡æ„åŸæœ‰åŠŸèƒ½ç‚¹<br/></td><td>ä¸­</td><td>8</td></tr><tr><td>ç¬¬14å¤©</td><td>æ‰€æœ‰æ—§ç»„ä»¶æ›¿æ¢å¹¶è°ƒè¯•</td><td>1. æµ‹è¯•ç§»åŠ¨ç«¯é€‚é…<br/>2. ä¿®å¤æµ‹è¯•ä¸­å‘ç°çš„é—®é¢˜</td><td>ä¸­</td><td>8</td></tr></tbody></table>
<h3 data-id="heading-35">8. æ€»ç»“</h3>
<p><code>SelectPersonDeptMobile</code> æ˜¯ä¸€ä¸ªåŸºäºVantçš„çº¯UIç§»åŠ¨ç«¯å…¬å…±é€‰äºº/é€‰éƒ¨é—¨ç»„ä»¶ï¼Œé€šè¿‡äº‹ä»¶é©±åŠ¨çš„æ–¹å¼ä¸çˆ¶ç»„ä»¶é€šä¿¡ï¼Œå®ç°äº†UIä¸æ•°æ®é€»è¾‘çš„åˆ†ç¦»ã€‚ç»„ä»¶æ”¯æŒå¤šç§é€‰æ‹©ç±»å‹ã€æœç´¢åŠŸèƒ½ã€å¤šçº§åµŒå¥—å¯¼èˆªå’Œçµæ´»çš„é…ç½®é€‰é¡¹ï¼Œèƒ½å¤Ÿé€‚åº”å„ç§ä¸šåŠ¡åœºæ™¯ã€‚</p>
<p>é€šè¿‡æ¸…æ™°çš„æ•°æ®æµå‘å’Œäº¤äº’æµç¨‹è®¾è®¡ï¼Œç»„ä»¶å®ç°äº†é«˜æ•ˆçš„æ•°æ®æµç®¡ç†å’Œè‰¯å¥½çš„ç”¨æˆ·ä½“éªŒã€‚çˆ¶ç»„ä»¶è´Ÿè´£æ•°æ®è·å–å’Œä¸šåŠ¡é€»è¾‘ï¼Œçº¯UIç»„ä»¶è´Ÿè´£ç•Œé¢æ¸²æŸ“å’Œç”¨æˆ·äº¤äº’ï¼Œä¸¤è€…åˆ†å·¥æ˜ç¡®ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•ã€‚</p>
<p>è¿™ç§è®¾è®¡æ¨¡å¼ä½¿å¾—ç»„ä»¶å…·æœ‰è‰¯å¥½çš„å¯å¤ç”¨æ€§å’Œå¯æ‰©å±•æ€§ï¼Œèƒ½å¤Ÿå¿«é€Ÿé€‚é…ä¸åŒçš„ä¸šåŠ¡éœ€æ±‚ï¼Œæ˜¯ä¸€ä¸ªå¯é çš„ç§»åŠ¨ç«¯å…¬å…±é€‰äºº/é€‰éƒ¨é—¨ç»„ä»¶è§£å†³æ–¹æ¡ˆã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI TO SQLï¼šAIGCæ—¶ä»£æ•°æ®åº“æ“ä½œçš„é©å‘½æ€§å˜é©]]></title>    <link>https://juejin.cn/post/7579843977847799862</link>    <guid>https://juejin.cn/post/7579843977847799862</guid>    <pubDate>2025-12-04T15:51:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579843977847799862" data-draft-id="7579659550863048746" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI TO SQLï¼šAIGCæ—¶ä»£æ•°æ®åº“æ“ä½œçš„é©å‘½æ€§å˜é©"/> <meta itemprop="keywords" content="LLM,æ•°æ®åº“,AIGC"/> <meta itemprop="datePublished" content="2025-12-04T15:51:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ™´æ €ay"/> <meta itemprop="url" content="https://juejin.cn/user/402859727269579"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI TO SQLï¼šAIGCæ—¶ä»£æ•°æ®åº“æ“ä½œçš„é©å‘½æ€§å˜é©
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/402859727269579/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ™´æ €ay
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T15:51:58.000Z" title="Thu Dec 04 2025 15:51:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    13
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">AI TO SQLï¼šAIGCæ—¶ä»£æ•°æ®åº“æ“ä½œçš„é©å‘½æ€§å˜é©</h2>
<p><strong>å¼•è¨€ï¼šä»Mobile Firståˆ°AI First</strong></p>
<p>åœ¨ç§»åŠ¨äº’è”ç½‘æ—¶ä»£ï¼Œæˆ‘ä»¬ä¹ æƒ¯äº†"Mobile First"çš„è®¾è®¡æ€ç»´ã€‚ç„¶è€Œï¼Œéšç€å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„é£é€Ÿå‘å±•ï¼Œæˆ‘ä»¬æ­£è¿æ¥ä¸€ä¸ªå…¨æ–°çš„æ—¶ä»£â€”â€”<strong>AI First</strong>ã€‚åœ¨è¿™ä¸ªæ—¶ä»£ï¼ŒAIä¸å†æ˜¯è¾…åŠ©å·¥å…·ï¼Œè€Œæ˜¯æ ¸å¿ƒé©±åŠ¨åŠ›ã€‚è€Œæ•°æ®åº“æ“ä½œçš„é©å‘½æ€§å˜åŒ–â€”â€”AI TO SQLï¼ˆAI to SQLï¼‰ï¼Œæ­£æ˜¯è¿™ä¸€å˜é©çš„ç”ŸåŠ¨ä½“ç°ã€‚</p>
<p>æœ€è¿‘ï¼Œéšç€è±†åŒ…æ‰‹æœºã€Geminiç­‰AIåŠ©æ‰‹çš„æ™®åŠï¼Œä»¥åŠ"vibe coding"ç†å¿µçš„æµè¡Œï¼Œè‡ªç„¶è¯­è¨€ç”ŸæˆSQLæŸ¥è¯¢æ­£ä»æ¦‚å¿µèµ°å‘ç°å®ï¼Œæˆä¸ºå¼€å‘è€…å’Œä¸šåŠ¡äººå‘˜çš„æ—¥å¸¸å·¥å…·ã€‚ä»Šå¤©ï¼Œæˆ‘å°†å¸¦å¤§å®¶æ·±å…¥æ¢è®¨è¿™ä¸€å‰æ²¿æŠ€æœ¯ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªå®æˆ˜æ¡ˆä¾‹ï¼Œå±•ç¤ºå¦‚ä½•å°†è‡ªç„¶è¯­è¨€æŸ¥è¯¢è½¬æ¢ä¸ºSQLè¯­å¥ã€‚</p>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯AI TO SQLï¼Ÿ</h3>
<p>AI TO SQLæ˜¯å°†è‡ªç„¶è¯­è¨€è½¬æ¢ä¸ºSQLæŸ¥è¯¢çš„æŠ€æœ¯ï¼Œå®ƒè®©éæŠ€æœ¯èƒŒæ™¯çš„ç”¨æˆ·ä¹Ÿèƒ½é€šè¿‡ç®€å•çš„è‡ªç„¶è¯­è¨€æè¿°æ¥è·å–æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚æ— éœ€æŒæ¡SQLè¯­æ³•ï¼Œåªéœ€ç”¨æ—¥å¸¸è¯­è¨€æè¿°éœ€æ±‚ï¼ŒAIå°±èƒ½ç”Ÿæˆæ­£ç¡®çš„SQLæŸ¥è¯¢è¯­å¥ã€‚</p>
<p>è¿™ä¸ä¼ ç»Ÿçš„æ•°æ®åº“æ“ä½œæ–¹å¼æˆªç„¶ä¸åŒã€‚è¿‡å»ï¼Œå¼€å‘äººå‘˜éœ€è¦èŠ±è´¹å¤§é‡æ—¶é—´å­¦ä¹ SQLè¯­æ³•ï¼Œç¼–å†™å¤æ‚çš„æŸ¥è¯¢è¯­å¥ï¼›è€Œç°åœ¨ï¼Œé€šè¿‡AI TO SQLï¼Œå³ä½¿æ˜¯ä¸šåŠ¡äººå‘˜ä¹Ÿèƒ½ç›´æ¥ä¸æ•°æ®åº“äº¤äº’ï¼Œå¤§å¤§æé«˜äº†æ•°æ®è·å–çš„æ•ˆç‡ã€‚</p>
<h3 data-id="heading-2">æŠ€æœ¯åŸç†ï¼šLLMå¦‚ä½•ç†è§£æ•°æ®åº“</h3>
<p>AI TO SQLçš„æ ¸å¿ƒåœ¨äºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å¯¹æ•°æ®åº“schemaå’Œè‡ªç„¶è¯­è¨€çš„ç†è§£èƒ½åŠ›ï¼š</p>
<ol>
<li><strong>Schemaç†è§£</strong>ï¼šLLMéœ€è¦ç†è§£æ•°æ®åº“çš„è¡¨ç»“æ„ã€å­—æ®µå«ä¹‰å’Œå…³ç³»</li>
<li><strong>è‡ªç„¶è¯­è¨€å¤„ç†</strong>ï¼šå°†ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æŸ¥è¯¢è½¬æ¢ä¸ºç²¾ç¡®çš„SQLè¯­ä¹‰</li>
<li><strong>SQLç”Ÿæˆ</strong>ï¼šç”Ÿæˆç¬¦åˆæ•°æ®åº“è¯­æ³•çš„SQLæŸ¥è¯¢è¯­å¥</li>
</ol>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æä¾›ç»™LLMå…³é”®ä¸Šä¸‹æ–‡ï¼š</p>
<ul>
<li>æ•°æ®åº“çš„schemaï¼ˆè¡¨ç»“æ„ï¼‰</li>
<li>ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æŸ¥è¯¢</li>
<li>é™åˆ¶æ¡ä»¶ï¼ˆå¦‚"åªè¾“å‡ºSQLï¼Œä¸è¦å…¶ä»–å†…å®¹"ï¼‰</li>
</ul>
<h3 data-id="heading-3">å®æˆ˜æ¡ˆä¾‹ï¼šä»è‡ªç„¶è¯­è¨€åˆ°SQLçš„å®Œæ•´æµç¨‹</h3>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€æ®µä»£ç ï¼Œæ·±å…¥äº†è§£AI TO SQLçš„å®ç°ç»†èŠ‚ã€‚</p>
<h4 data-id="heading-4">1. è®¾ç½®è½»é‡çº§æ•°æ®åº“</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> sqlite3

<span class="hljs-comment"># åˆ›å»ºSQLiteè¿æ¥</span>
conn = sqlite3.connect(<span class="hljs-string">"test.db"</span>)
cursor = conn.cursor()

<span class="hljs-comment"># åˆ›å»ºemployeesè¡¨</span>
cursor.execute(<span class="hljs-string">"""
CREATE TABLE IF NOT EXISTS employees(
    id INTEGER PRIMARY KEY,
    name TEXT,
    department TEXT,
    salary INTEGER
)
"""</span>)
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆé€‰æ‹©SQLiteï¼Ÿ</strong></p>
<ul>
<li>è½»é‡çº§ï¼šæ— éœ€æœåŠ¡å™¨ï¼Œç›´æ¥å­˜å‚¨åœ¨æ–‡ä»¶ä¸­</li>
<li>æœ¬åœ°åŒ–ï¼šé€‚åˆç§»åŠ¨ç«¯å’Œæ¡Œé¢åº”ç”¨ï¼ˆå¦‚å¾®ä¿¡ä¸­çš„æœ¬åœ°æ•°æ®åº“ï¼‰</li>
<li>ç®€å•æ˜“ç”¨ï¼šAPIç®€å•ï¼Œé€‚åˆå¿«é€ŸåŸå‹å¼€å‘</li>
<li>æ— éœ€å®‰è£…ï¼šç›¸æ¯”MySQLç­‰éœ€è¦å•ç‹¬å®‰è£…çš„æ•°æ®åº“ï¼ŒSQLiteæ›´æ–¹ä¾¿</li>
</ul>
<h4 data-id="heading-5">2. æ’å…¥æµ‹è¯•æ•°æ®</h4>
<pre><code class="hljs language-python" lang="python">sample_data = [
    (<span class="hljs-number">6</span>, <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"æŠ€æœ¯éƒ¨"</span>, <span class="hljs-number">6</span>),
    (<span class="hljs-number">7</span>, <span class="hljs-string">"æå››"</span>, <span class="hljs-string">"é”€å”®éƒ¨"</span>, <span class="hljs-number">30</span>),
    (<span class="hljs-number">8</span>, <span class="hljs-string">"ç‹äº”"</span>, <span class="hljs-string">"å¼€å‘éƒ¨"</span>, <span class="hljs-number">68</span>),
]
cursor.executemany(<span class="hljs-string">'INSERT INTO employees VALUES(?,?,?,?)'</span>, sample_data)
conn.commit()
</code></pre>
<p>è¿™ä¸€æ­¥åˆ›å»ºäº†ç¤ºä¾‹æ•°æ®ï¼Œç”¨äºåç»­æŸ¥è¯¢æµ‹è¯•ã€‚</p>
<h4 data-id="heading-6">3. è·å–æ•°æ®åº“Schema</h4>
<pre><code class="hljs language-python" lang="python">schema = cursor.execute(<span class="hljs-string">"PRAGMA table_info(employees)"</span>).fetchall()
schema_str = <span class="hljs-string">"CREATE TABLE EMPLOYEES (\n"</span> + <span class="hljs-string">"\n"</span>.join([<span class="hljs-string">f"<span class="hljs-subst">{col[<span class="hljs-number">1</span>]}</span> <span class="hljs-subst">{col[<span class="hljs-number">2</span>]}</span>"</span> <span class="hljs-keyword">for</span> col <span class="hljs-keyword">in</span> schema]) + <span class="hljs-string">"\n)"</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ•°æ®åº“Schema:"</span>)
<span class="hljs-built_in">print</span>(schema_str)
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦Schemaï¼Ÿ</strong></p>
<ul>
<li>LLMéœ€è¦äº†è§£æ•°æ®åº“çš„ç»“æ„æ‰èƒ½ç”Ÿæˆæ­£ç¡®çš„SQL</li>
<li><code>PRAGMA table_info</code>æ˜¯SQLiteç‰¹æœ‰çš„å‘½ä»¤ï¼Œç”¨äºè·å–è¡¨ç»“æ„ä¿¡æ¯</li>
<li>ç”Ÿæˆçš„schemaå­—ç¬¦ä¸²æ˜¯LLMç†è§£æ•°æ®åº“çš„å…³é”®ä¸Šä¸‹æ–‡</li>
</ul>
<p>è¾“å‡ºç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-text" lang="text">æ•°æ®åº“Schema:
CREATE TABLE EMPLOYEES (
id INTEGER
name TEXT
department TEXT
salary INTEGER
)
</code></pre>
<h4 data-id="heading-7">4. LLMç”ŸæˆSQLæŸ¥è¯¢</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">ask_deepseek</span>(<span class="hljs-params">query, schema</span>):
    prompt = <span class="hljs-string">f"""
    è¿™æ˜¯ä¸€ä¸ªæ•°æ®åº“çš„Schema:
    <span class="hljs-subst">{schema}</span>
    æ ¹æ®è¿™ä¸ªSchema,ä½ èƒ½è¾“å‡ºä¸€ä¸ªSQLæŸ¥è¯¢æ¥å›ç­”ä»¥ä¸‹é—®é¢˜å—ï¼Ÿ
    åªè¾“å‡ºSQLæŸ¥è¯¢,ä¸è¦è¾“å‡ºä»»ä½•å…¶ä»–å†…å®¹ï¼Œä¹Ÿä¸è¦å¸¦ä»»ä½•æ ¼å¼ã€‚
    é—®é¢˜ï¼š<span class="hljs-subst">{query}</span>
    """</span>
    response = client.chat.completions.create(
        model=<span class="hljs-string">"deepseek-reasoner"</span>,
        max_tokens=<span class="hljs-number">2048</span>,
        messages=[{
            <span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>,
            <span class="hljs-string">"content"</span>: prompt
        }]
    )
    <span class="hljs-keyword">return</span> response.choices[<span class="hljs-number">0</span>].message

question = <span class="hljs-string">"å¼€å‘éƒ¨éƒ¨é—¨å‘˜å·¥çš„å§“åå’Œå·¥èµ„æ˜¯å¤šå°‘ï¼Ÿ"</span>
sql = ask_deepseek(question, schema_str)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"ç”Ÿæˆçš„sqlæŸ¥è¯¢ï¼š"</span>)
<span class="hljs-built_in">print</span>(sql)
</code></pre>
<p><strong>å…³é”®ç‚¹è§£æï¼š</strong></p>
<ol>
<li><strong>Promptè®¾è®¡</strong>ï¼šè¿™æ˜¯AI TO SQLæˆåŠŸçš„å…³é”®ã€‚æˆ‘ä»¬æä¾›äº†å®Œæ•´çš„æ•°æ®åº“schemaï¼Œå¹¶æ˜ç¡®æŒ‡ç¤ºåªè¾“å‡ºSQLï¼Œé¿å…LLMæ·»åŠ é¢å¤–å†…å®¹ã€‚</li>
<li><strong>æ¨¡å‹é€‰æ‹©</strong>ï¼šä½¿ç”¨<code>deepseek-reasoner</code>æ¨¡å‹ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸“é—¨ä¼˜åŒ–æ¨ç†èƒ½åŠ›çš„æ¨¡å‹ã€‚</li>
<li><strong>è¾“å‡ºæ§åˆ¶</strong>ï¼šé€šè¿‡æ˜ç¡®çš„æŒ‡ä»¤"åªè¾“å‡ºSQLæŸ¥è¯¢"ï¼Œç¡®ä¿LLMç”Ÿæˆçš„è¾“å‡ºæ˜¯çº¯SQLï¼Œä¾¿äºç¨‹åºè§£æã€‚</li>
</ol>
<p>è¾“å‡ºç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-text" lang="text">ç”Ÿæˆçš„sqlæŸ¥è¯¢ï¼š
ChatCompletionMessage(content="```sql\nSELECT name, salary FROM EMPLOYEES WHERE department = 'å¼€å‘éƒ¨';\n```", refusal=None, role='assistant', ...)
</code></pre>
<h4 data-id="heading-8">5. æ‰§è¡Œç”Ÿæˆçš„SQL</h4>
<pre><code class="hljs language-python" lang="python">cursor.execute(sql.content)
results = cursor.fetchall()
<span class="hljs-built_in">print</span>(results)
</code></pre>
<p>è¿™ä¸€æ­¥æ‰§è¡Œç”Ÿæˆçš„SQLæŸ¥è¯¢ï¼Œå¹¶æ‰“å°ç»“æœã€‚</p>
<p><strong>é™„ï¼šä»£ç æµ‹è¯•</strong></p>
<pre><code class="hljs language-ini" lang="ini">from openai import OpenAI
<span class="hljs-comment"># openai sdk llm æ¥å£æ ‡å‡† completeion chat</span>
<span class="hljs-attr">client</span> = OpenAI(
    <span class="hljs-attr">api_key</span> = <span class="hljs-string">'è¿™é‡Œå¡«ä½ è‡ªå·±çš„API key'</span>,
    <span class="hljs-attr">base_url</span> = <span class="hljs-string">'https://api.deepseek.com/v1'</span>
)

import sqlite3
<span class="hljs-comment"># è¿æ¥æ•°æ®åº“</span>
<span class="hljs-attr">conn</span> = sqlite3.connect(<span class="hljs-string">"test.db"</span>)
<span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªæ¸¸æ ‡å¯¹è±¡</span>
<span class="hljs-comment"># ç”¨äºæ‰§è¡Œsql è·å–æŸ¥è¯¢ç»“æœ</span>
<span class="hljs-attr">cursor</span> = conn.cursor()
<span class="hljs-comment"># å‘˜å·¥è¡¨</span>
cursor.execute("""
CREATE TABLE IF NOT EXISTS employees(
    id INTEGER PRIMARY KEY,
    name TEXT,
    department TEXT,
    salary INTEGER
)
""")

<span class="hljs-attr">sample_data</span> = [ 
    <span class="hljs-comment"># å…ƒç»„ç±»å‹ æœ‰é¡ºåºçš„  tuple </span>
    (<span class="hljs-number">6</span>, <span class="hljs-string">"é»„ä½³"</span>, <span class="hljs-string">"é”€å”®"</span>, <span class="hljs-number">50000</span>), 
    (<span class="hljs-number">7</span>, <span class="hljs-string">"å®å®"</span>, <span class="hljs-string">"å·¥ç¨‹"</span>, <span class="hljs-number">75000</span>), 
    (<span class="hljs-number">8</span>, <span class="hljs-string">"è°¦è°¦"</span>, <span class="hljs-string">"é”€å”®"</span>, <span class="hljs-number">60000</span>), 
    (<span class="hljs-number">9</span>, <span class="hljs-string">"æ‚¦æ‚¦"</span>, <span class="hljs-string">"å·¥ç¨‹"</span>, <span class="hljs-number">80000</span>), 
    (<span class="hljs-number">10</span>, <span class="hljs-string">"é»„ä»å‹‹"</span>, <span class="hljs-string">"å¸‚åœº"</span>, <span class="hljs-number">55000</span>),
    (<span class="hljs-number">11</span>, <span class="hljs-string">"æ›¾ç¹èŠ±"</span>, <span class="hljs-string">"å·¥ç¨‹"</span>, <span class="hljs-number">80000</span>)
]

<span class="hljs-comment"># æ’å…¥sql</span>
cursor.executemany(
    "INSERT INTO employees VALUES(?,?,?,?)",
    sample_data
)

<span class="hljs-comment"># æäº¤sqläº‹åŠ¡</span>
conn.commit()

<span class="hljs-attr">schema</span> = cursor.execute(<span class="hljs-string">"PRAGMA table_info(employees)"</span>).fetchall()
print(schema)
<span class="hljs-comment"># åˆ—è¡¨æ¨å¯¼å¼</span>
<span class="hljs-attr">schema_str</span> = <span class="hljs-string">"CREATE TABLE EMPLOYEES (\n"</span> + <span class="hljs-string">"\n"</span>.join([f<span class="hljs-string">"{col[1]} {col[2]}"</span> for col in schema]) + <span class="hljs-string">"\n)"</span>
print(schema_str)

def ask_deepseek(query, schema):
    <span class="hljs-attr">prompt</span> = f<span class="hljs-string">"""
    è¿™æ˜¯ä¸€ä¸ªæ•°æ®åº“çš„Schema:
    {schema}
    æ ¹æ®è¿™ä¸ªSchema,è¯·è¾“å‡ºä¸€ä¸ªSQLæŸ¥è¯¢æ¥å›ç­”ä»¥ä¸‹é—®é¢˜ã€‚
    åªè¾“å‡ºSQLæŸ¥è¯¢è¯­å¥æœ¬èº«ï¼Œä¸è¦ä½¿ç”¨ä»»ä½•Markdownæ ¼å¼ï¼Œ
    ä¸è¦åŒ…å«åå¼•å·ã€ä»£ç å—æ ‡è®°æˆ–é¢å¤–è¯´æ˜ã€‚
    é—®é¢˜ï¼š{query}
    """</span>
    print(prompt)
    <span class="hljs-attr">response</span> = client.chat.completions.create(
        <span class="hljs-attr">model</span>=<span class="hljs-string">"deepseek-chat"</span>,
        <span class="hljs-attr">max_tokens</span>=<span class="hljs-number">2048</span>,
        <span class="hljs-attr">messages</span>=[{
            <span class="hljs-string">"role"</span>: <span class="hljs-string">"user"</span>,
            <span class="hljs-string">"content"</span>: prompt
        }],
        <span class="hljs-attr">temperature</span>=<span class="hljs-number">0</span>
    )
    return response.choices<span class="hljs-section">[0]</span>.message.content
    
<span class="hljs-attr">question</span> = <span class="hljs-string">"å·¥ç¨‹éƒ¨é—¨å‘˜å·¥çš„å§“åå’Œå·¥èµ„æ˜¯å¤šå°‘"</span>
<span class="hljs-attr">sql_query</span> = ask_deepseek(question,schema_str)
print(sql_query)

<span class="hljs-attr">results</span> = cursor.execute(sql_query).fetchall()
print(results)

<span class="hljs-attr">question</span> = <span class="hljs-string">"åœ¨é”€å”®éƒ¨é—¨å¢åŠ ä¸€ä¸ªæ–°å‘˜å·¥ï¼Œå§“åä¸ºå¼ ä¸‰ï¼Œå·¥èµ„ä¸º45000"</span>
<span class="hljs-attr">sql_query</span> = ask_deepseek(question,schema_str)
print(sql_query)
cursor.execute(sql_query)
conn.commit()

<span class="hljs-attr">question</span> = <span class="hljs-string">"åˆ é™¤å¸‚åœºéƒ¨é—¨çš„é»„ä»å‹‹"</span>
<span class="hljs-attr">sql_query</span> = ask_deepseek(question, schema_str)
print(sql_query)
cursor.execute(sql_query)
conn.commit()

<span class="hljs-attr">question</span> = <span class="hljs-string">"æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥çš„ä¿¡æ¯"</span>
<span class="hljs-attr">sql_query</span> = ask_deepseek(question, schema_str)
print(sql_query)
<span class="hljs-attr">results</span> = cursor.execute(sql_query).fetchall()
print(results)
</code></pre>
<p>å¿«å»è¯•è¯•å§ï¼</p>
<hr/>
<h3 data-id="heading-9">AI TO SQLçš„ä¼˜åŠ¿ä¸ä»·å€¼</h3>
<ol>
<li><strong>é™ä½æŠ€æœ¯é—¨æ§›</strong>ï¼šä¸šåŠ¡äººå‘˜æ— éœ€å­¦ä¹ SQLï¼Œç›´æ¥ç”¨è‡ªç„¶è¯­è¨€è·å–æ•°æ®</li>
<li><strong>æé«˜å¼€å‘æ•ˆç‡</strong>ï¼šå¼€å‘è€…å¯ä»¥ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ï¼Œè€ŒéSQLè¯­æ³•</li>
<li><strong>å‡å°‘é”™è¯¯</strong>ï¼šAIç”Ÿæˆçš„SQLæ›´å‡†ç¡®ï¼Œå‡å°‘äº†äººä¸ºé”™è¯¯</li>
<li><strong>åŠ é€Ÿè¿­ä»£</strong>ï¼šå¿«é€Ÿå“åº”ä¸šåŠ¡éœ€æ±‚ï¼Œæ— éœ€åå¤è°ƒæ•´SQLè¯­å¥</li>
</ol>
<p>sqlä¹Ÿæ˜¯æ–‡æœ¬ï¼Œåªä¸è¿‡å®ƒæ˜¯æ•°æ®åº“çš„ä¸“ä¸šè¯­è¨€ï¼ŒAIGCå†æ“…é•¿ä¸è¿‡</p>
<h3 data-id="heading-10">ä¸ºä»€ä¹ˆæ˜¯SQLiteè€ŒéMySQLï¼Ÿ</h3>
<p>SQLiteç‰¹åˆ«é€‚åˆAI TO SQLåœºæ™¯çš„åŸå› ï¼š</p>
<ul>
<li><strong>è½»é‡çº§</strong>ï¼šä¸éœ€è¦å•ç‹¬çš„æ•°æ®åº“æœåŠ¡å™¨</li>
<li><strong>åµŒå…¥å¼</strong>ï¼šå¯ä»¥ç›´æ¥é›†æˆåˆ°åº”ç”¨ä¸­</li>
<li><strong>æ–‡ä»¶å­˜å‚¨</strong>ï¼šæ•°æ®å­˜å‚¨åœ¨æœ¬åœ°æ–‡ä»¶ï¼Œä¾¿äºç®¡ç†å’Œå¤‡ä»½</li>
<li><strong>é›¶é…ç½®</strong>ï¼šæ— éœ€è®¾ç½®ç”¨æˆ·ã€å¯†ç ç­‰</li>
<li><strong>é€‚åˆç§»åŠ¨ç«¯</strong>ï¼šå¾®ä¿¡ç­‰åº”ç”¨ä¸­å¹¿æ³›ä½¿ç”¨SQLiteä½œä¸ºæœ¬åœ°æ•°æ®åº“</li>
</ul>
<p>ç›¸æ¯”ä¹‹ä¸‹ï¼ŒMySQLéœ€è¦é¢å¤–çš„æœåŠ¡å™¨é…ç½®å’Œç®¡ç†ï¼Œä¸é€‚åˆè¿™ç§è½»é‡çº§ã€æœ¬åœ°åŒ–çš„AI TO SQLåœºæ™¯ã€‚</p>
<h3 data-id="heading-11">æœªæ¥å±•æœ›</h3>
<p>AI TO SQLæ­£åœ¨å¿«é€Ÿå‘å±•ï¼Œæœªæ¥å¯èƒ½æœ‰ä»¥ä¸‹è¶‹åŠ¿ï¼š</p>
<ol>
<li><strong>æ›´æ™ºèƒ½çš„ä¸Šä¸‹æ–‡ç†è§£</strong>ï¼šLLMå°†æ›´å¥½åœ°ç†è§£å¤æ‚çš„ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®å…³ç³»</li>
<li><strong>å¤šæ•°æ®åº“æ”¯æŒ</strong>ï¼šä¸ä»…æ”¯æŒSQLiteï¼Œè¿˜èƒ½å¤„ç†MySQLã€PostgreSQLç­‰ä¸»æµæ•°æ®åº“</li>
<li><strong>å®æ—¶åé¦ˆä¸ä¿®æ­£</strong>ï¼šç”¨æˆ·å¯ä»¥å¯¹ç”Ÿæˆçš„SQLè¿›è¡Œåé¦ˆï¼Œè®©AIæŒç»­ä¼˜åŒ–</li>
<li><strong>ä¸BIå·¥å…·é›†æˆ</strong>ï¼šä¸Tableauã€Power BIç­‰å•†ä¸šæ™ºèƒ½å·¥å…·æ— ç¼é›†æˆ</li>
<li><strong>ä¼ä¸šçº§å®‰å…¨å¢å¼º</strong>ï¼šç¡®ä¿ç”Ÿæˆçš„SQLç¬¦åˆä¼ä¸šå®‰å…¨ç­–ç•¥</li>
</ol>
<h3 data-id="heading-12">ç»“è¯­</h3>
<p>ä»Mobile Firståˆ°AI Firstï¼Œæˆ‘ä»¬æ­£è§è¯ç€æŠ€æœ¯èŒƒå¼çš„è½¬å˜ã€‚AI TO SQLä½œä¸ºè¿™ä¸€è½¬å˜çš„ä»£è¡¨ï¼Œæ­£åœ¨æ”¹å˜æˆ‘ä»¬ä¸æ•°æ®åº“äº¤äº’çš„æ–¹å¼ã€‚é€šè¿‡å°†è‡ªç„¶è¯­è¨€è½¬æ¢ä¸ºSQLï¼Œæˆ‘ä»¬ä¸ä»…é™ä½äº†æŠ€æœ¯é—¨æ§›ï¼Œè¿˜å¤§å¤§æé«˜äº†æ•°æ®è·å–çš„æ•ˆç‡ã€‚</p>
<p>æ­£å¦‚æˆ‘ä»¬ä»`ä¸­çœ‹åˆ°çš„ï¼Œå®ç°AI TO SQLå¹¶ä¸å¤æ‚ï¼Œåªéœ€è¦åˆé€‚çš„å·¥å…·å’Œç²¾å¿ƒè®¾è®¡çš„promptã€‚åœ¨AIGCæ—¶ä»£ï¼ŒæŒæ¡è¿™ä¸€æŠ€èƒ½ï¼Œå°†ä½¿æˆ‘ä»¬æˆä¸ºæ›´å…·ç«äº‰åŠ›çš„å¼€å‘è€…ã€‚</p>
<p><strong>"å½“SQLä¸å†æ˜¯éšœç¢ï¼Œæ•°æ®æ‰æ˜¯çœŸæ­£çš„èµ„äº§ã€‚"</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼šä»æ„é€ å‡½æ•°åˆ°åŸå‹ç»§æ‰¿çš„å®Œæ•´æŒ‡å—]]></title>    <link>https://juejin.cn/post/7579813925995937833</link>    <guid>https://juejin.cn/post/7579813925995937833</guid>    <pubDate>2025-12-04T11:39:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579813925995937833" data-draft-id="7579659550862573610" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" JavaScript é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼šä»æ„é€ å‡½æ•°åˆ°åŸå‹ç»§æ‰¿çš„å®Œæ•´æŒ‡å—"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-12-04T11:39:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æƒ³è¦æˆä¸ºç³•ç³•æ‰‹"/> <meta itemprop="url" content="https://juejin.cn/user/4381975238424308"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             JavaScript é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼šä»æ„é€ å‡½æ•°åˆ°åŸå‹ç»§æ‰¿çš„å®Œæ•´æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4381975238424308/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æƒ³è¦æˆä¸ºç³•ç³•æ‰‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T11:39:58.000Z" title="Thu Dec 04 2025 11:39:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å½“ç„¶å¯ä»¥ï¼ä½ æä¾›çš„æ–‡ç« å·²ç»éå¸¸ç³»ç»Ÿã€æ¸…æ™°åœ°è®²è§£äº† JavaScript é¢å‘å¯¹è±¡çš„æ ¸å¿ƒæœºåˆ¶ã€‚ä¸ºäº†è¿›ä¸€æ­¥<strong>å®Œå–„å†…å®¹</strong>ï¼Œæˆ‘ä»¬å°†æŠŠä¸Šä¸€ä¸ªå¯¹è¯ä¸­å…³äº <code>Animal.apply(this)</code> çš„è¯¦ç»†è§£æ<strong>æœ‰æœºèå…¥</strong>åˆ°â€œç¬¬äº”éƒ¨åˆ†ï¼šç»§æ‰¿â€ä¸­ï¼Œå¹¶è¡¥å……ä¸€äº›å…³é”®ç»†èŠ‚ï¼ˆå¦‚ä¼ å‚ã€ç»„åˆç»§æ‰¿çš„å±€é™æ€§ã€ç°ä»£æ›¿ä»£æ–¹æ¡ˆç­‰ï¼‰ï¼Œä½¿æ•´ç¯‡æ–‡ç« é€»è¾‘æ›´ä¸¥å¯†ã€æ•™å­¦æ›´å®Œæ•´ã€‚</p>
<hr/>
<h2 data-id="heading-0">JavaScript é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼šä»æ„é€ å‡½æ•°åˆ°åŸå‹ç»§æ‰¿çš„å®Œæ•´æŒ‡å—</h2>
<blockquote>
<p>æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥ç†è§£ JavaScript ä¸­é¢å‘å¯¹è±¡ï¼ˆOOPï¼‰çš„æ ¸å¿ƒæœºåˆ¶ â€”â€” æ„é€ å‡½æ•°ã€åŸå‹ï¼ˆprototypeï¼‰ã€ç»§æ‰¿ï¼Œä»¥åŠ ES6 çš„ class è¯­æ³•ç³–èƒŒåçš„çœŸç›¸ã€‚</p>
</blockquote>
<p>JavaScript æ˜¯ä¸€é—¨<strong>åŸºäºå¯¹è±¡</strong>çš„è¯­è¨€ï¼Œä½†å®ƒçš„ OOP å®ç°æ–¹å¼ä¸å…¶ä»–ä¸»æµè¯­è¨€ï¼ˆå¦‚ Javaã€C++ï¼‰æˆªç„¶ä¸åŒã€‚å®ƒæ²¡æœ‰ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„â€œç±»â€ï¼Œè€Œæ˜¯é€šè¿‡**åŸå‹é“¾ï¼ˆPrototype Chainï¼‰**å®ç°å¯¹è±¡ä¹‹é—´çš„ç»§æ‰¿ä¸å…±äº«ã€‚</p>
<p>å³ä½¿åœ¨ ES6 å¼•å…¥äº† <code>class</code> å…³é”®å­—åï¼Œå…¶åº•å±‚ä¾ç„¶æ˜¯åŸºäºåŸå‹çš„ã€‚å› æ­¤ï¼Œè¦çœŸæ­£æŒæ¡ JS çš„é¢å‘å¯¹è±¡ï¼Œå¿…é¡»ç†è§£ <strong>æ„é€ å‡½æ•° + åŸå‹</strong> è¿™ä¸€æ ¸å¿ƒæ¨¡å‹ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€åŸå§‹æ¨¡å¼ï¼šå¯¹è±¡å­—é¢é‡çš„å±€é™</h3>
<p>æœ€ç®€å•çš„åˆ›å»ºå¯¹è±¡æ–¹å¼ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> cat1 = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'åŠ è²çŒ«'</span>,
  <span class="hljs-attr">color</span>: <span class="hljs-string">'æ©˜è‰²'</span>
};
<span class="hljs-keyword">var</span> cat2 = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'é»‘çŒ«è­¦é•¿'</span>,
  <span class="hljs-attr">color</span>: <span class="hljs-string">'é»‘è‰²'</span>
};
</code></pre>
<p>è¿™ç§æ–¹å¼è™½ç„¶ç›´è§‚ï¼Œä½†å­˜åœ¨æ˜æ˜¾é—®é¢˜ï¼š</p>
<ul>
<li><strong>ä»£ç é‡å¤</strong>ï¼šæ¯ä¸ªå®ä¾‹éƒ½è¦æ‰‹åŠ¨å®šä¹‰ç›¸åŒç»“æ„ï¼›</li>
<li><strong>æ— æ³•æ‰¹é‡ç”Ÿæˆ</strong>ï¼šç¼ºä¹â€œæ¨¡æ¿â€æ¦‚å¿µï¼›</li>
<li><strong>æ— ç±»å‹æ ‡è¯†</strong>ï¼šæ— æ³•åˆ¤æ–­ <code>cat1</code> æ˜¯å¦å±äºâ€œçŒ«â€è¿™ä¸ªç±»åˆ«ã€‚</li>
</ul>
<p>äºæ˜¯ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§<strong>å°è£…å®ä¾‹åŒ–è¿‡ç¨‹</strong>çš„æ–¹å¼ã€‚</p>
<hr/>
<h3 data-id="heading-2">äºŒã€æ„é€ å‡½æ•°ï¼šå°è£…å®ä¾‹åŒ–çš„ç¬¬ä¸€æ­¥</h3>
<p>ä½¿ç”¨å‡½æ•°é…åˆ <code>new</code> å…³é”®å­—ï¼Œæ¨¡æ‹Ÿâ€œç±»â€çš„è¡Œä¸ºï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, color</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}

<span class="hljs-keyword">const</span> cat1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'åŠ è²çŒ«'</span>, <span class="hljs-string">'æ©˜è‰²'</span>);
<span class="hljs-keyword">const</span> cat2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'é»‘çŒ«è­¦é•¿'</span>, <span class="hljs-string">'é»‘è‰²'</span>);
</code></pre>
<h4 data-id="heading-3"><code>new</code> è°ƒç”¨æ—¶å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h4>
<ol>
<li>åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ <code>{}</code>ï¼›</li>
<li>å°†è¯¥å¯¹è±¡çš„å†…éƒ¨ <code>[[Prototype]]</code> é“¾æ¥åˆ°æ„é€ å‡½æ•°çš„ <code>prototype</code>ï¼›</li>
<li>å°† <code>this</code> æŒ‡å‘è¯¥ç©ºå¯¹è±¡ï¼›</li>
<li>æ‰§è¡Œæ„é€ å‡½æ•°ä½“ï¼Œä¸º <code>this</code> æ·»åŠ å±æ€§ï¼›</li>
<li>è‡ªåŠ¨è¿”å› <code>this</code>ï¼ˆé™¤éæ˜¾å¼è¿”å›ä¸€ä¸ªé <code>null</code> å¯¹è±¡ï¼‰ã€‚</li>
</ol>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šè‹¥ç›´æ¥è°ƒç”¨ <code>Cat()</code>ï¼ˆä¸åŠ  <code>new</code>ï¼‰ï¼Œ<code>this</code> æŒ‡å‘å…¨å±€å¯¹è±¡ï¼ˆæµè§ˆå™¨ä¸­æ˜¯ <code>window</code>ï¼‰ï¼Œé€ æˆæ±¡æŸ“ã€‚ä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šæŠ¥é”™ã€‚</p>
</blockquote>
<h4 data-id="heading-4">ç±»å‹åˆ¤æ–­</h4>
<ul>
<li><code>cat1 instanceof Cat</code> â†’ <code>true</code></li>
<li><code>cat1.constructor === Cat</code> â†’ <code>true</code></li>
</ul>
<p>è¿™è¡¨æ˜å®ä¾‹ä¸æ„é€ å‡½æ•°å»ºç«‹äº†æ˜ç¡®çš„å½’å±å…³ç³»ã€‚</p>
<hr/>
<h3 data-id="heading-5">ä¸‰ã€åŸå‹ï¼ˆPrototypeï¼‰ï¼šè§£å†³æ–¹æ³•å†—ä½™é—®é¢˜</h3>
<p>å¦‚æœæˆ‘ä»¬åœ¨æ„é€ å‡½æ•°å†…å®šä¹‰æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, color</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">eat</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'eat jerry'</span>); }; <span class="hljs-comment">// âŒ æ¯ä¸ªå®ä¾‹éƒ½æ–°å»ºä¸€ä¸ªå‡½æ•°ï¼</span>
}
</code></pre>
<p>è¿™ä¼šå¯¼è‡´<strong>å†…å­˜æµªè´¹</strong>â€”â€”æ¯ä¸ªå®ä¾‹éƒ½æŒæœ‰ä¸€ä»½ç›¸åŒçš„å‡½æ•°å‰¯æœ¬ã€‚</p>
<h4 data-id="heading-6">è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ <code>prototype</code></h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">type</span> = <span class="hljs-string">'çŒ«ç§‘åŠ¨ç‰©'</span>;
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">eat</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'eat jerry'</span>);
};
</code></pre>
<p>æ‰€æœ‰é€šè¿‡ <code>new Cat()</code> åˆ›å»ºçš„å®ä¾‹ï¼Œéƒ½ä¼š<strong>å…±äº«</strong>è¿™äº›åŸå‹ä¸Šçš„å±æ€§å’Œæ–¹æ³•ã€‚</p>
<h4 data-id="heading-7">å¦‚ä½•åŒºåˆ†â€œè‡ªèº«å±æ€§â€å’Œâ€œç»§æ‰¿å±æ€§â€ï¼Ÿ</h4>
<ul>
<li><code>cat1.hasOwnProperty('name')</code> â†’ <code>true</code>ï¼ˆè‡ªèº«ï¼‰</li>
<li><code>cat1.hasOwnProperty('type')</code> â†’ <code>false</code>ï¼ˆæ¥è‡ªåŸå‹ï¼‰</li>
<li><code>'type' in cat1</code> â†’ <code>true</code>ï¼ˆæ— è®ºæ¥æºï¼‰</li>
</ul>
<p>éå†å®ä¾‹å±æ€§æ—¶ï¼Œå»ºè®®è¿‡æ»¤ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> prop <span class="hljs-keyword">in</span> cat1) {
  <span class="hljs-keyword">if</span> (cat1.<span class="hljs-title function_">hasOwnProperty</span>(prop)) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(prop, cat1[prop]);
  }
}
</code></pre>
<hr/>
<h3 data-id="heading-8">å››ã€ES6 çš„ <code>class</code>ï¼šè¯­æ³•ç³–è€Œå·²</h3>
<p>ES6 æä¾›äº†æ›´æ¸…æ™°çš„ OOP è¯­æ³•ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, color</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
  }
  <span class="hljs-title function_">eat</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'eat jerry'</span>);
  }
}
</code></pre>
<p>ä½†è¯·æ³¨æ„ï¼š<strong><code>class</code> æœ¬è´¨ä»æ˜¯åŸå‹æœºåˆ¶</strong>ï¼</p>
<p>éªŒè¯å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> cat1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'tom'</span>, <span class="hljs-string">'é»‘è‰²'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat1.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Cat</span>); <span class="hljs-comment">// true</span>
</code></pre>
<p>æ‰€ä»¥ï¼Œ<code>class</code> åªæ˜¯è®©ä»£ç æ›´æ˜“è¯»ï¼Œåº•å±‚é€»è¾‘æœªå˜ã€‚</p>
<hr/>
<h3 data-id="heading-9">äº”ã€ç»§æ‰¿ï¼šå¦‚ä½•è®© <code>Cat</code> ç»§æ‰¿ <code>Animal</code>ï¼Ÿ</h3>
<p>JavaScript çš„ç»§æ‰¿éœ€è¦åŒæ—¶å¤„ç†ä¸¤éƒ¨åˆ†ï¼š</p>
<ul>
<li><strong>å®ä¾‹å±æ€§çš„ç»§æ‰¿</strong>ï¼ˆé€šè¿‡æ„é€ å‡½æ•°ï¼‰</li>
<li><strong>åŸå‹æ–¹æ³•çš„ç»§æ‰¿</strong>ï¼ˆé€šè¿‡åŸå‹é“¾ï¼‰</li>
</ul>
<h4 data-id="heading-10">æ­¥éª¤ 1ï¼šå€Ÿç”¨æ„é€ å‡½æ•°ï¼ˆç»§æ‰¿å®ä¾‹å±æ€§ï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params">species</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">species</span> = species || <span class="hljs-string">'åŠ¨ç‰©'</span>;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-string">'/////'</span>); <span class="hljs-comment">// æ­¤æ—¶ this æ˜¯ Cat çš„æ–°å®ä¾‹</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, color</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// {} â€”â€” new Cat() åˆ›å»ºçš„æ–°å¯¹è±¡</span>
  <span class="hljs-comment">// ğŸ‘‡ å…³é”®ï¼šåœ¨å½“å‰ Cat å®ä¾‹ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œ Animal</span>
  <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, [<span class="hljs-string">'å“ºä¹³åŠ¨ç‰©'</span>]); <span class="hljs-comment">// å¯ä¼ é€’å‚æ•°ï¼</span>
  
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}
</code></pre>
<h5 data-id="heading-11">ğŸ” æ·±å…¥è§£æ <code>Animal.apply(this)</code></h5>
<ul>
<li>
<p><code>apply</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šäº†å‡½æ•°æ‰§è¡Œæ—¶çš„ <code>this</code> ä¸Šä¸‹æ–‡ã€‚</p>
</li>
<li>
<p>å½“ <code>new Cat(...)</code> è¢«è°ƒç”¨æ—¶ï¼ŒJS å¼•æ“å…ˆåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼ˆè®¾ä¸º <code>obj</code>ï¼‰ï¼Œå¹¶å°† <code>Cat</code> å†…éƒ¨çš„ <code>this</code> æŒ‡å‘ <code>obj</code>ã€‚</p>
</li>
<li>
<p>æ‰§è¡Œ <code>Animal.apply(this)</code> ç›¸å½“äºï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// åœ¨ obj ä¸Šè¿è¡Œ Animal å‡½æ•°</span>
obj.<span class="hljs-property">species</span> = <span class="hljs-string">'å“ºä¹³åŠ¨ç‰©'</span>;
</code></pre>
</li>
<li>
<p>ç»“æœï¼š<code>Cat</code> å®ä¾‹æ‹¥æœ‰äº† <code>species</code> å±æ€§ï¼Œä¸”æ¯ä¸ªå®ä¾‹éƒ½æœ‰<strong>ç‹¬ç«‹å‰¯æœ¬</strong>ï¼Œé¿å…å¼•ç”¨ç±»å‹å…±äº«é—®é¢˜ã€‚</p>
</li>
</ul>
<blockquote>
<p>âœ… ä¼˜ç‚¹ï¼šæ”¯æŒä¼ å‚ã€å±æ€§éš”ç¦»<br/>
âŒ ç¼ºç‚¹ï¼š<strong>æ— æ³•ç»§æ‰¿ <code>Animal.prototype</code> ä¸Šçš„æ–¹æ³•</strong></p>
</blockquote>
<h4 data-id="heading-12">æ­¥éª¤ 2ï¼šè®¾ç½®åŸå‹é“¾ï¼ˆç»§æ‰¿åŸå‹æ–¹æ³•ï¼‰</h4>
<p>ä¸ºäº†è®© <code>Cat</code> å®ä¾‹ä¹Ÿèƒ½è®¿é—® <code>Animal</code> åŸå‹ä¸Šçš„æ–¹æ³•ï¼Œéœ€å»ºç«‹åŸå‹é“¾ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å…ˆç»™ Animal æ·»åŠ åŸå‹æ–¹æ³•</span>
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayHi</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hi, I'm a <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.species}</span>`</span>);
};

<span class="hljs-comment">// è®© Cat.prototype æŒ‡å‘ä¸€ä¸ª Animal å®ä¾‹</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>(); <span class="hljs-comment">// æ³¨æ„ï¼šè¿™é‡Œæ²¡ä¼ å‚ï¼Œspecies ä¸ºé»˜è®¤å€¼</span>

<span class="hljs-comment">// ä¿®å¤ constructor æŒ‡å‘ï¼ˆå¦åˆ™ cat.constructor === Animalï¼‰</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Cat</span>;
</code></pre>
<p>ç°åœ¨æµ‹è¯•ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> cat = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'åŠ è²çŒ«'</span>, <span class="hljs-string">'æ©˜è‰²'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat);
<span class="hljs-comment">// { species: 'å“ºä¹³åŠ¨ç‰©', name: 'åŠ è²çŒ«', color: 'æ©˜è‰²' }</span>

cat.<span class="hljs-title function_">sayHi</span>(); <span class="hljs-comment">// âœ… "Hi, I'm a å“ºä¹³åŠ¨ç‰©"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Animal</span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Cat</span>);    <span class="hljs-comment">// true</span>
</code></pre>
<h4 data-id="heading-13">å®Œæ•´ç»§æ‰¿æ¨¡å‹å›¾è§£</h4>
<pre><code class="hljs language-lua" lang="lua">cat (å®ä¾‹)
  â””â”€ <span class="hljs-string">[[Prototype]]</span> â†’ Cat.prototype (å³ new Animal())
        â””â”€ <span class="hljs-string">[[Prototype]]</span> â†’ Animal.prototype
              â””â”€ <span class="hljs-string">[[Prototype]]</span> â†’ Object.prototype
                    â””â”€ <span class="hljs-string">[[Prototype]]</span> â†’ null
</code></pre>
<blockquote>
<p>ğŸ’¡ æç¤ºï¼šç°ä»£å¼€å‘ä¸­ï¼Œå¯ä½¿ç”¨ <code>Object.create(Animal.prototype)</code> æ›¿ä»£ <code>new Animal()</code>ï¼Œé¿å…è°ƒç”¨çˆ¶æ„é€ å‡½æ•°å¸¦æ¥çš„å‰¯ä½œç”¨ï¼ˆå¦‚ä¸éœ€è¦åˆå§‹åŒ–çˆ¶ç±»å®ä¾‹å±æ€§æ—¶ï¼‰ã€‚</p>
</blockquote>
<h4 data-id="heading-14">æ›´å¥å£®çš„ç»„åˆç»§æ‰¿å†™æ³•ï¼ˆæ¨èï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params">species</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">species</span> = species || <span class="hljs-string">'åŠ¨ç‰©'</span>;
}

<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayHi</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hi, I'm a <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.species}</span>`</span>);
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, color</span>) {
  <span class="hljs-comment">// ç»§æ‰¿å±æ€§ï¼ˆå¯ä¼ å‚ï¼‰</span>
  <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-string">'çŒ«ç§‘åŠ¨ç‰©'</span>); <span class="hljs-comment">// ä½¿ç”¨ call æ›´å¸¸è§ï¼ˆå‚æ•°åˆ—è¡¨ vs å‚æ•°æ•°ç»„ï¼‰</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}

<span class="hljs-comment">// ç»§æ‰¿æ–¹æ³•ï¼ˆä¸è°ƒç”¨ Animal æ„é€ å‡½æ•°ï¼‰</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Cat</span>;

<span class="hljs-comment">// å¯ç»§ç»­æ‰©å±• Cat è‡ªå·±çš„æ–¹æ³•</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">meow</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Meow~'</span>);
};
</code></pre>
<p>è¿™ç§æ¨¡å¼ç§°ä¸º <strong>â€œç»„åˆç»§æ‰¿â€ï¼ˆCombination Inheritanceï¼‰</strong> ï¼Œæ˜¯ ES5 æ—¶ä»£æœ€å¸¸ç”¨çš„ç»§æ‰¿æ–¹å¼ã€‚</p>
<hr/>
<h3 data-id="heading-15">å…­ã€æ€»ç»“ï¼šJS OOP çš„æ ¸å¿ƒè¦ç‚¹</h3>









































<table><thead><tr><th>æ¦‚å¿µ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ„é€ å‡½æ•°</strong></td><td>ç”¨äºåˆ›å»ºå®ä¾‹ï¼Œé…åˆ <code>new</code> ä½¿ç”¨</td></tr><tr><td><strong><code>prototype</code></strong></td><td>å­˜æ”¾å…±äº«å±æ€§/æ–¹æ³•ï¼Œé¿å…é‡å¤åˆ›å»º</td></tr><tr><td><strong><code>__proto__</code> / <code>[[Prototype]]</code></strong></td><td>å®ä¾‹æŒ‡å‘å…¶æ„é€ å‡½æ•°çš„ <code>prototype</code></td></tr><tr><td><strong><code>hasOwnProperty</code></strong></td><td>åˆ¤æ–­æ˜¯å¦ä¸ºè‡ªèº«å±æ€§</td></tr><tr><td><strong><code>instanceof</code></strong></td><td>æ£€æŸ¥åŸå‹é“¾ä¸­æ˜¯å¦å­˜åœ¨æŸæ„é€ å‡½æ•°çš„ <code>prototype</code></td></tr><tr><td><strong>ç»§æ‰¿</strong></td><td>å±æ€§é  <code>call/apply</code>ï¼Œæ–¹æ³•é åŸå‹é“¾</td></tr><tr><td><strong>ES6 <code>class</code></strong></td><td>è¯­æ³•ç³–ï¼Œåº•å±‚ä»æ˜¯åŸå‹</td></tr><tr><td><strong>ç»„åˆç»§æ‰¿</strong></td><td>æœ€å¸¸ç”¨çš„ä¼ ç»Ÿç»§æ‰¿æ¨¡å¼ï¼ˆå±æ€§ + åŸå‹é“¾ï¼‰</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-16">ä¸ƒã€å»¶ä¼¸æ€è€ƒï¼šç°ä»£ç»§æ‰¿çš„æœ€ä½³å®è·µ</h3>
<p>è™½ç„¶ç»„åˆç»§æ‰¿å¾ˆå¼ºå¤§ï¼Œä½†å®ƒ<strong>è°ƒç”¨äº†ä¸¤æ¬¡çˆ¶æ„é€ å‡½æ•°</strong>ï¼ˆä¸€æ¬¡åœ¨ <code>new Animal()</code> è®¾ç½®åŸå‹ï¼Œä¸€æ¬¡åœ¨ <code>Cat</code> å†…éƒ¨ï¼‰ï¼Œç•¥æ˜¾å†—ä½™ã€‚</p>
<p>ES6 ä¹‹åï¼Œ<strong>ç›´æ¥ä½¿ç”¨ <code>class extends</code> æ˜¯é¦–é€‰</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">species = <span class="hljs-string">'åŠ¨ç‰©'</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">species</span> = species;
  }
  <span class="hljs-title function_">sayHi</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hi, I'm a <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.species}</span>`</span>);
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, color</span>) {
    <span class="hljs-variable language_">super</span>(<span class="hljs-string">'çŒ«ç§‘åŠ¨ç‰©'</span>); <span class="hljs-comment">// ç­‰ä»·äº Animal.call(this, ...)</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
  }
  <span class="hljs-title function_">meow</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Meow~'</span>);
  }
}
</code></pre>
<ul>
<li>è¯­ä¹‰æ¸…æ™°</li>
<li>è‡ªåŠ¨å¤„ç†åŸå‹é“¾</li>
<li>æ”¯æŒé™æ€æ–¹æ³•ã€getter/setter ç­‰é«˜çº§ç‰¹æ€§</li>
</ul>
<p>ä½†è¯·è®°ä½ï¼š<strong><code>super()</code> åº•å±‚ä»ç„¶æ˜¯ <code>Parent.call(this)</code> + åŸå‹é“¾è®¾ç½®</strong>ã€‚</p>
<blockquote>
<p>ğŸ“Œ <strong>ç»ˆæç®´è¨€</strong>ï¼š<br/>
<strong>JavaScript æ²¡æœ‰ç±»ï¼Œåªæœ‰å¯¹è±¡ï¼›æ²¡æœ‰ç»§æ‰¿ï¼Œåªæœ‰å§”æ‰˜ã€‚</strong><br/>
ç†è§£åŸå‹é“¾ï¼Œå°±æŒæ¡äº† JS çš„çµé­‚ã€‚</p>
</blockquote>
<hr/>
<p><strong>æ ‡ç­¾ï¼š#JavaScript #é¢å‘å¯¹è±¡ #åŸå‹é“¾ #å‰ç«¯è¿›é˜¶ #ES6</strong><br/>
<strong>æ¬¢è¿ç‚¹èµã€æ”¶è—ã€è¯„è®ºäº¤æµï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶å®ç°ä¸€ä¸ªå¥å£®å¯å¤ç”¨çš„â€œå°±åœ°ç¼–è¾‘â€ç»„ä»¶ï¼šæ·±å…¥å‰–æ OOPã€DOM ä¸äº‹ä»¶æœºåˆ¶]]></title>    <link>https://juejin.cn/post/7579702046956027947</link>    <guid>https://juejin.cn/post/7579702046956027947</guid>    <pubDate>2025-12-04T11:57:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579702046956027947" data-draft-id="7579659550862327850" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶å®ç°ä¸€ä¸ªå¥å£®å¯å¤ç”¨çš„â€œå°±åœ°ç¼–è¾‘â€ç»„ä»¶ï¼šæ·±å…¥å‰–æ OOPã€DOM ä¸äº‹ä»¶æœºåˆ¶"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-12-04T11:57:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æƒ³è¦æˆä¸ºç³•ç³•æ‰‹"/> <meta itemprop="url" content="https://juejin.cn/user/4381975238424308"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶å®ç°ä¸€ä¸ªå¥å£®å¯å¤ç”¨çš„â€œå°±åœ°ç¼–è¾‘â€ç»„ä»¶ï¼šæ·±å…¥å‰–æ OOPã€DOM ä¸äº‹ä»¶æœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4381975238424308/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æƒ³è¦æˆä¸ºç³•ç³•æ‰‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T11:57:31.000Z" title="Thu Dec 04 2025 11:57:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»é›¶å®ç°ä¸€ä¸ªå¥å£®å¯å¤ç”¨çš„â€œå°±åœ°ç¼–è¾‘â€ç»„ä»¶ï¼šæ·±å…¥å‰–æ OOPã€DOM ä¸äº‹ä»¶æœºåˆ¶</h2>
<p>åœ¨ç°ä»£ Web åº”ç”¨ä¸­ï¼Œç”¨æˆ·æœŸæœ›â€œæ‰€è§å³æ‰€ç¼–â€çš„æµç•…ä½“éªŒâ€”â€”ç‚¹å‡»ä¸€æ®µæ–‡å­—å°±èƒ½ç›´æ¥ä¿®æ”¹ï¼Œæ— éœ€è·³è½¬é¡µé¢ã€‚è¿™ç§äº¤äº’æ¨¡å¼ç§°ä¸º <strong>â€œå°±åœ°ç¼–è¾‘â€ï¼ˆEdit In Placeï¼‰</strong> ï¼Œå¹¿æ³›åº”ç”¨äºä¸ªäººä¸»é¡µã€åå°ç®¡ç†ç³»ç»Ÿã€åä½œå¹³å°ç­‰åœºæ™¯ã€‚</p>
<p>ä½†è¦å†™å‡ºä¸€ä¸ª<strong>å®‰å…¨ã€å¥å£®ã€å¯å¤ç”¨</strong>çš„å°±åœ°ç¼–è¾‘ç»„ä»¶ï¼Œå¹¶éåªæ˜¯â€œæŠŠ span æ¢æˆ inputâ€é‚£ä¹ˆç®€å•ã€‚å®ƒæ¶‰åŠï¼š</p>
<ul>
<li><strong>é¢å‘å¯¹è±¡è®¾è®¡ï¼ˆOOPï¼‰</strong></li>
<li><strong>DOM å…ƒç´ åˆ›å»ºä¸ç®¡ç†</strong></li>
<li><strong>äº‹ä»¶ç»‘å®šä¸Â <code>this</code>Â ä¸Šä¸‹æ–‡</strong></li>
<li><strong>æ•°æ®ä¸è§†å›¾çš„ä¸€è‡´æ€§</strong></li>
<li><strong>XSS å®‰å…¨é˜²æŠ¤</strong></li>
</ul>
<p>æœ¬æ–‡å°†å¸¦ä½ ä»é›¶æ„å»ºä¸€ä¸ªç”Ÿäº§çº§ <code>EditInPlace</code> ç»„ä»¶ï¼Œå¹¶<strong>é€è¡Œè§£æä½ æ›¾å›°æƒ‘çš„æ‰€æœ‰ç»†èŠ‚</strong>ï¼ŒåŠ©ä½ çœŸæ­£æŒæ¡å‰ç«¯æ ¸å¿ƒèƒ½åŠ›ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦å°è£…ï¼ŸOOP å¸¦æ¥çš„å·¥ç¨‹ä»·å€¼</h3>
<p>å‡è®¾ä½ è¦åœ¨å¤šä¸ªé¡µé¢å®ç°â€œå¯ç¼–è¾‘æ ‡è¯­â€ï¼Œå¦‚æœæ¯æ¬¡éƒ½å†™ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// âŒ é‡å¤ã€è„†å¼±ã€éš¾ç»´æŠ¤</span>
<span class="hljs-keyword">const</span> span = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'slogan'</span>);
span.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// æ‰‹åŠ¨åˆ›å»º inputã€æŒ‰é’®...</span>
    <span class="hljs-comment">// æ‰‹åŠ¨å¤„ç†ä¿å­˜ã€å–æ¶ˆ...</span>
});
</code></pre>
<p>å¾ˆå¿«ä½ ä¼šé™·å…¥â€œå¤åˆ¶ç²˜è´´åœ°ç‹±â€ã€‚</p>
<p>âœ… <strong>OOP å°è£…çš„ä»·å€¼</strong>ï¼š</p>

























<table><thead><tr><th>ä¼˜åŠ¿</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å¤ç”¨æ€§</strong></td><td>ä¸€è¡ŒÂ <code>new EditInPlace(...)</code>Â å³å¯é›†æˆ</td></tr><tr><td><strong>éšè—å®ç°</strong></td><td>ä½¿ç”¨è€…æ— éœ€å…³å¿ƒ DOM æ“ä½œç»†èŠ‚</td></tr><tr><td><strong>çŠ¶æ€éš”ç¦»</strong></td><td>æ¯ä¸ªå®ä¾‹ç‹¬ç«‹ç®¡ç†è‡ªå·±çš„Â <code>value</code>Â å’Œå…ƒç´ </td></tr><tr><td><strong>å›¢é˜Ÿåä½œ</strong></td><td>ç¼–å†™è€…ä¸“æ³¨é€»è¾‘ï¼Œä½¿ç”¨è€…ä¸“æ³¨é…ç½®</td></tr></tbody></table>
<blockquote>
<p>ğŸ“Œ <strong>å¼€å‘æ¼”è¿›è·¯å¾„</strong>ï¼š<br/>
æµç¨‹ä»£ç  â†’ ç±»å°è£… â†’ æ¨¡å—åŒ–æ–‡ä»¶<br/>
è¿™æ˜¯å‰ç«¯å·¥ç¨‹åŒ–çš„å¿…ç»ä¹‹è·¯ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-2">äºŒã€æ ¸å¿ƒç»“æ„ï¼šå±æ€§ + æ–¹æ³• = å®Œæ•´ç»„ä»¶</h3>
<p>æˆ‘ä»¬é‡‡ç”¨æ„é€ å‡½æ•° + åŸå‹æ–¹æ³•çš„ç»å…¸ OOP æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">EditInPlace</span>(<span class="hljs-params">id, value, parentElement</span>) {
    <span class="hljs-comment">// âœ… å±æ€§ï¼šå­˜å‚¨çŠ¶æ€ä¸ DOM å¼•ç”¨</span>
     <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = id;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value || <span class="hljs-string">'è¿™ä¸ªå®¶ä¼™å¾ˆæ‡’ï¼Œä»€ä¹ˆéƒ½æ²¡ç•™ä¸‹'</span>; <span class="hljs-comment">// æ ¸å¿ƒæ•°æ®ï¼</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentElement</span> = parentElement;

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span> = <span class="hljs-literal">null</span>;   <span class="hljs-comment">// å¤–å±‚å®¹å™¨ &lt;div&gt;</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span> = <span class="hljs-literal">null</span>;      <span class="hljs-comment">// æ˜¾ç¤ºæ–‡æœ¬ &lt;span&gt;</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span> = <span class="hljs-literal">null</span>;       <span class="hljs-comment">// ç¼–è¾‘è¾“å…¥æ¡† &lt;input&gt;</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span> = <span class="hljs-literal">null</span>;         <span class="hljs-comment">// ä¿å­˜æŒ‰é’®</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span> = <span class="hljs-literal">null</span>;       <span class="hljs-comment">// å–æ¶ˆæŒ‰é’®</span>

    <span class="hljs-comment">// âœ… è‡ªåŠ¨åˆå§‹åŒ–</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElement</span>(); <span class="hljs-comment">// DOMå¯¹è±¡åˆ›å»º</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attachEvent</span>(); <span class="hljs-comment">// ç»‘å®šäº¤äº’äº‹ä»¶</span>
}
</code></pre>
<blockquote>
<p>ğŸ”¥ <strong>å…³é”®è®¤çŸ¥</strong>ï¼š<br/>
<code>this.value</code> æ˜¯ç»„ä»¶çš„ <strong>â€œå”¯ä¸€çœŸå®æ•°æ®æºâ€ï¼ˆSingle Source of Truthï¼‰</strong> ï¼Œæ‰€æœ‰è§†å›¾éƒ½åŸºäºå®ƒæ¸²æŸ“ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-3">ä¸‰ã€æ·±åº¦è§£æï¼šä½ æ›¾é—®è¿‡çš„æ¯ä¸€ä¸ªç»†èŠ‚</h3>
<h4 data-id="heading-4">ğŸ”¹ 1.Â <code>document.createElement('div')</code>Â åˆ°åº•åšäº†ä»€ä¹ˆï¼Ÿ</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
</code></pre>
<ul>
<li>åœ¨<strong>å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„Â <code>&lt;div&gt;</code>Â å…ƒç´ å¯¹è±¡</strong></li>
<li>æ­¤æ—¶å®ƒ<strong>å°šæœªæŒ‚è½½åˆ°é¡µé¢</strong>ï¼Œç”¨æˆ·ä¸å¯è§</li>
<li>åç»­é€šè¿‡Â <code>appendChild</code>Â å°†å…¶æ’å…¥ DOM æ ‘</li>
</ul>
<blockquote>
<p>ğŸ’¡ <strong>ç±»æ¯”</strong>ï¼šåƒåœ¨çº¸ä¸Šç”»ä¸€ä¸ªç›’å­ï¼Œè¿˜æ²¡è´´åˆ°å¢™ä¸Šã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-5">ğŸ”¹ 2.Â <code>appendChild</code>Â å¦‚ä½•ç»„è£…ç•Œé¢ï¼Ÿ</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>);
</code></pre>
<ul>
<li>å°†Â <code>staticElement</code>ï¼ˆ<code>&lt;span&gt;</code>ï¼‰ä½œä¸ºå­èŠ‚ç‚¹æ’å…¥Â <code>containerElement</code>ï¼ˆ<code>&lt;div&gt;</code>ï¼‰</li>
<li>å»ºç«‹çˆ¶å­å…³ç³»ï¼š<code>staticElement.parentNode === containerElement</code></li>
<li>è‹¥çˆ¶å…ƒç´ å·²åœ¨é¡µé¢ä¸Šï¼Œåˆ™å­å…ƒç´ <strong>ç«‹å³æ˜¾ç¤º</strong></li>
</ul>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼š<code>appendChild</code> æ˜¯ <strong>â€œç§»åŠ¨â€è€Œéâ€œå¤åˆ¶â€</strong> ï¼Œä¸€ä¸ª DOM èŠ‚ç‚¹åªèƒ½å­˜åœ¨äºä¸€å¤„ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-6">ğŸ”¹ 3.Â <code>this.value</code>Â åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿä½•æ—¶å˜åŒ–ï¼Ÿ</h4>
<p>è¿™æ˜¯æ•´ä¸ªç»„ä»¶çš„<strong>çµé­‚</strong>ã€‚å®ƒçš„ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š</p>



































<table><thead><tr><th>é˜¶æ®µ</th><th><code>this.value</code>Â çš„å€¼</th><th>æ˜¯å¦æ›´æ–°ï¼Ÿ</th></tr></thead><tbody><tr><td>æ„é€ æ—¶</td><td>ç”¨æˆ·ä¼ å…¥å€¼ï¼Œæˆ–é»˜è®¤æç¤ºè¯­</td><td>âœ… åˆå§‹åŒ–</td></tr><tr><td>æ˜¾ç¤ºæ–‡æœ¬</td><td>ç”¨äºÂ <code>staticElement.textContent</code></td><td>âŒ åªè¯»</td></tr><tr><td>è¿›å…¥ç¼–è¾‘</td><td>ç”¨äºÂ <code>fieldElement.value</code></td><td>âŒ åªè¯»</td></tr><tr><td>ç‚¹å‡»ä¿å­˜</td><td>æ›´æ–°ä¸ºÂ <code>fieldElement.value</code></td><td>âœ…Â <strong>å”¯ä¸€æ›´æ–°ç‚¹</strong></td></tr><tr><td>ç‚¹å‡»å–æ¶ˆ</td><td><strong>ä¿æŒä¸å˜</strong></td><td>âŒ ä¸æ›´æ–°</td></tr></tbody></table>
<blockquote>
<p>âœ… <strong>è®¾è®¡åŸåˆ™</strong>ï¼š</p>
<ul>
<li>â€œå–æ¶ˆâ€ä¸ä¿®æ”¹æ•°æ®</li>
<li>â€œä¿å­˜â€æ‰åŒæ­¥è‰ç¨¿åˆ°æ­£å¼æ•°æ®</li>
<li>æ¯æ¬¡ç¼–è¾‘éƒ½ä»Â <code>this.value</code>Â é‡ç½®è¾“å…¥æ¡†ï¼Œé¿å…æ®‹ç•™</li>
</ul>
</blockquote>
<hr/>
<h4 data-id="heading-7">ğŸ”¹ 4. ä¸ºä»€ä¹ˆç”¨Â <code>textContent</code>Â è€Œä¸æ˜¯Â <code>innerHTML</code>ï¼Ÿ</h4>
<pre><code class="hljs language-ini" lang="ini">// âœ… å®‰å…¨åšæ³•
<span class="hljs-attr">this.staticElement.textContent</span> = this.value<span class="hljs-comment">;</span>

// âŒ å±é™©åšæ³•ï¼ˆé™¤éä½ å®Œå…¨ä¿¡ä»»å†…å®¹ï¼‰<span class="hljs-attr">this.staticElement.innerHTML</span> = this.value<span class="hljs-comment">;</span>
</code></pre>
<ul>
<li><code>innerHTML</code>Â ä¼š<strong>è§£æ HTML</strong>ï¼Œè‹¥Â <code>value</code>Â åŒ…å«Â <code>&lt;script&gt;</code>Â æˆ–Â <code>&lt;img onerror&gt;</code>ï¼Œå¯èƒ½å¼•å‘ XSS æ”»å‡»</li>
<li><code>textContent</code>Â å°†å†…å®¹è§†ä¸º<strong>çº¯æ–‡æœ¬</strong>ï¼Œè‡ªåŠ¨è½¬ä¹‰å°–æ‹¬å·ï¼Œç»å¯¹å®‰å…¨</li>
</ul>
<blockquote>
<p>ğŸ›¡ï¸ <strong>å®‰å…¨ç¬¬ä¸€</strong>ï¼šé™¤éæ˜ç¡®éœ€è¦å¯Œæ–‡æœ¬ï¼Œå¦åˆ™æ°¸è¿œä¼˜å…ˆä½¿ç”¨ <code>textContent</code>ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-8">ğŸ”¹ 5. äº‹ä»¶ç»‘å®šä¸­çš„ç®­å¤´å‡½æ•°ä¸ºä½•å…³é”®ï¼Ÿ</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToField</span>(); <span class="hljs-comment">// âœ… this æŒ‡å‘ EditInPlace å®ä¾‹</span>
});
</code></pre>
<p>è‹¥ä½¿ç”¨æ™®é€šå‡½æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToField</span>(); <span class="hljs-comment">// âŒ this æŒ‡å‘ staticElementï¼ŒæŠ¥é”™ï¼</span>
});
</code></pre>
<ul>
<li>æ™®é€šå‡½æ•°ä¸­ï¼Œ<code>this</code>Â ç”±è°ƒç”¨æ–¹å¼å†³å®šï¼Œäº‹ä»¶å›è°ƒä¸­æŒ‡å‘è§¦å‘å…ƒç´ </li>
<li>ç®­å¤´å‡½æ•°<strong>æ²¡æœ‰è‡ªå·±çš„Â <code>this</code></strong>ï¼Œç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸï¼ˆå³æ„é€ å‡½æ•°ä¸­çš„Â <code>this</code>ï¼‰</li>
</ul>
<blockquote>
<p>ğŸ’¡ è¿™æ˜¯ JavaScript ä¸­ç»å…¸çš„ <strong>â€œthis ä¸¢å¤±â€é—®é¢˜</strong>ï¼Œç®­å¤´å‡½æ•°æ˜¯æœ€ç®€æ´çš„è§£å†³æ–¹æ¡ˆã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-9">ğŸ”¹ ### <code>save()</code>Â ä¸Â <code>cancel()</code>ï¼šä¿å­˜ç¡®è®¤ vs å®‰å…¨å›é€€</h4>
<p>åœ¨å°±åœ°ç¼–è¾‘ç»„ä»¶ä¸­ï¼Œ <strong>â€œä¿å­˜â€å’Œâ€œå–æ¶ˆâ€çœ‹ä¼¼å¯¹ç§°ï¼Œå®åˆ™èŒè´£è¿¥å¼‚</strong>ã€‚å®ƒä»¬å…±åŒæ„æˆäº†ç”¨æˆ·ç¼–è¾‘æ“ä½œçš„é—­ç¯ï¼Œä½†å†…éƒ¨é€»è¾‘å´ä½“ç°äº†æˆªç„¶ä¸åŒçš„æ•°æ®å¤„ç†åŸåˆ™ã€‚</p>
<p>æˆ‘ä»¬å…ˆçœ‹ <code>save</code> æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">save</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> value = <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">value</span>; <span class="hljs-comment">// è¯»å–å½“å‰è¾“å…¥æ¡†ä¸­çš„ç”¨æˆ·è¾“å…¥</span>
    <span class="hljs-comment">// fetchåç«¯å­˜å‚¨ï¼ˆå®é™…é¡¹ç›®ä¸­åº”åœ¨æ­¤å‘é€å¼‚æ­¥è¯·æ±‚ï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;                  <span class="hljs-comment">// æ›´æ–°æ ¸å¿ƒæ•°æ®</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">innerHTML</span> = value; <span class="hljs-comment">// æ›´æ–°æ˜¾ç¤ºå€¼</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToText</span>();                <span class="hljs-comment">// åˆ‡æ¢å›æ–‡æœ¬æ˜¾ç¤ºçŠ¶æ€</span>
},
</code></pre>
<ul>
<li><strong>ç¬¬1è¡Œ</strong>ï¼šä»è¾“å…¥æ¡†è·å–ç”¨æˆ·è¾“å…¥çš„æ–°å†…å®¹ï¼Œå­˜å…¥å±€éƒ¨å˜é‡Â <code>value</code>ã€‚</li>
<li><strong>å…³é”®èµ‹å€¼</strong>ï¼š<code>this.value = value</code>Â â€”â€” è¿™æ˜¯æ•´ä¸ªç»„ä»¶ä¸­<strong>å”¯ä¸€æ›´æ–°æ ¸å¿ƒæ•°æ®çš„åœ°æ–¹</strong>ã€‚<br/>
<code>this.value</code>Â æ˜¯ç»„ä»¶çš„â€œå”¯ä¸€çœŸå®æ•°æ®æºâ€ï¼Œæ‰€æœ‰è§†å›¾éƒ½åŸºäºå®ƒæ¸²æŸ“ã€‚</li>
<li><strong>è§†å›¾åŒæ­¥</strong>ï¼šé€šè¿‡Â <code>innerHTML</code>Â å°†æ–°å€¼å†™å…¥Â <code>&lt;span&gt;</code>ï¼Œç¡®ä¿åªè¯»çŠ¶æ€ä¸‹æ˜¾ç¤ºæœ€æ–°å†…å®¹ã€‚<br/>
âš ï¸Â <strong>å®‰å…¨æé†’</strong>ï¼šè‹¥å†…å®¹ä¸å¯ä¿¡ï¼Œå»ºè®®æ”¹ç”¨Â <code>textContent</code>Â é˜²æ­¢ XSSã€‚</li>
<li><strong>çŠ¶æ€åˆ‡æ¢</strong>ï¼šè°ƒç”¨Â <code>convertToText()</code>Â éšè—ç¼–è¾‘æ§ä»¶ï¼Œå›å½’ç®€æ´å±•ç¤ºã€‚</li>
</ul>
<p>å†çœ‹ <code>cancel</code> æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">cancel</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToText</span>(); <span class="hljs-comment">// ä»…åˆ‡æ¢åˆ°æ–‡æœ¬æ˜¾ç¤ºçŠ¶æ€</span>
}
</code></pre>
<ul>
<li>
<p><strong>æå…¶ç®€æ´</strong>ï¼šå®ƒ<strong>ä¸åšä»»ä½•æ•°æ®æ“ä½œ</strong>ï¼Œåªè°ƒç”¨Â <code>convertToText()</code>ã€‚</p>
</li>
<li>
<p><strong>è®¾è®¡ç²¾é«“</strong>ï¼š</p>
<ul>
<li>ä¸ä¿®æ”¹Â <code>this.value</code>Â â†’ ä¿ç•™ä¸Šä¸€æ¬¡ç¡®è®¤çš„å†…å®¹</li>
<li>ä¸æ›´æ–°Â <code>&lt;span&gt;</code>Â â†’ è§†å›¾è‡ªç„¶ä¿æŒåŸæ ·</li>
<li>ä¸‹æ¬¡è¿›å…¥ç¼–è¾‘æ—¶ï¼Œ<code>convertToField()</code>Â ä¼šç”¨Â <code>this.value</code>Â é‡ç½®è¾“å…¥æ¡†ï¼Œ<strong>è‡ªåŠ¨ä¸¢å¼ƒè‰ç¨¿</strong></li>
</ul>
</li>
</ul>
<blockquote>
<p>âœ… <strong>æ ¸å¿ƒå·®å¼‚æ€»ç»“</strong>ï¼š</p>























<table><thead><tr><th>æ–¹æ³•</th><th>æ˜¯å¦ä¿®æ”¹Â <code>this.value</code></th><th>æ˜¯å¦æ›´æ–°è§†å›¾å†…å®¹</th><th>ç”¨æˆ·æ„å›¾</th></tr></thead><tbody><tr><td><code>save()</code></td><td>âœ… æ˜¯</td><td>âœ… æ˜¯</td><td>â€œæˆ‘è¦ä¿ç•™è¿™ä¸ªä¿®æ”¹â€</td></tr><tr><td><code>cancel()</code></td><td>âŒ å¦</td><td>âŒ å¦</td><td>â€œæˆ‘ä¸æ”¹äº†ï¼Œæ¢å¤åŸæ ·â€</td></tr></tbody></table>
</blockquote>
<p>è¿™ç§è®¾è®¡å®Œç¾å¥‘åˆç”¨æˆ·å¿ƒç†é¢„æœŸï¼š</p>
<ul>
<li>ç‚¹â€œä¿å­˜â€ â†’ å†…å®¹æ°¸ä¹…ç”Ÿæ•ˆ</li>
<li>ç‚¹â€œå–æ¶ˆâ€ â†’ ä¸€åˆ‡å¦‚åˆï¼Œä»¿ä½›ä»æœªç¼–è¾‘</li>
</ul>
<hr/>
<h3 data-id="heading-10">å››ã€å®Œæ•´åŠŸèƒ½å®ç°</h3>
<p>å½“ç„¶å¯ä»¥ï¼ä»¥ä¸‹æ˜¯å¯¹ <strong>â€œå››ã€å®Œæ•´åŠŸèƒ½å®ç°â€</strong> ç« èŠ‚çš„<strong>å…¨é¢æ¶¦è‰²ä¸æ·±åº¦å®Œå–„ç‰ˆ</strong>ã€‚åœ¨ä¿ç•™ä½ åŸæœ‰ä»£ç ç»“æ„çš„åŸºç¡€ä¸Šï¼Œæˆ‘å¢åŠ äº†ï¼š</p>
<ul>
<li>æ¯ä¸ªæ–¹æ³•çš„<strong>è®¾è®¡ç›®æ ‡ä¸èŒè´£è¯´æ˜</strong></li>
<li>å…³é”®è¡Œçš„<strong>é€è¡Œæ³¨é‡Šè§£æ</strong></li>
<li>ç›¸å…³çš„<strong>å‰ç«¯æ ¸å¿ƒçŸ¥è¯†ç‚¹</strong></li>
<li><strong>å®‰å…¨ã€æ€§èƒ½ã€å¯ç»´æŠ¤æ€§</strong>çš„æœ€ä½³å®è·µå»ºè®®</li>
<li>ä»¥åŠå¯¹æ½œåœ¨é—®é¢˜çš„<strong>é˜²å¾¡æ€§ç¼–ç¨‹æ€è€ƒ</strong></li>
</ul>
<hr/>
<h3 data-id="heading-11">å››ã€å®Œæ•´åŠŸèƒ½å®ç° â€”â€” ä»éª¨æ¶åˆ°è¡€è‚‰</h3>
<p>ä¸€ä¸ªå¥å£®çš„ç»„ä»¶ï¼Œä¸ä»…è¦æœ‰æ­£ç¡®çš„é€»è¾‘ï¼Œæ›´è¦æœ‰æ¸…æ™°çš„èŒè´£åˆ’åˆ†å’Œå·¥ç¨‹æ„è¯†ã€‚ä¸‹é¢æˆ‘ä»¬å°† <code>EditInPlace</code> çš„æ ¸å¿ƒæ–¹æ³•æŒ‰åŠŸèƒ½æ¨¡å—æ‹†è§£ï¼Œé€å±‚è®²è§£å…¶èƒŒåçš„è®¾è®¡å“²å­¦ã€‚</p>
<hr/>
<h4 data-id="heading-12">ğŸ§± 1. åˆ›å»º DOM ç»“æ„ï¼šæ„å»ºç»„ä»¶çš„â€œç‰©ç†è½½ä½“â€</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">createElement</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// åˆ›å»ºå¤–å±‚å®¹å™¨ï¼Œä½œä¸ºç»„ä»¶çš„æ ¹èŠ‚ç‚¹</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-property">id</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>; <span class="hljs-comment">// ä¾¿äºè°ƒè¯•æˆ–å¤–éƒ¨é€‰ä¸­</span>

    <span class="hljs-comment">// === æ–‡æœ¬æ˜¾ç¤ºåŒºï¼ˆåªè¯»çŠ¶æ€ï¼‰===</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'span'</span>);<span class="hljs-comment">//åˆ›å»ºä¸€ä¸ª&lt;span&gt;å…ƒç´ </span>
        <span class="hljs-comment">// âœ… ä½¿ç”¨ textContent è€Œé innerHTMLï¼Œé˜²æ­¢ XSS æ”»å‡»</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">textContent</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>); <span class="hljs-comment">//å°†åˆšåˆ›å»ºçš„ &lt;span&gt; æ·»åŠ ä¸º &lt;div&gt; çš„å­èŠ‚ç‚¹</span>

    <span class="hljs-comment">// === ç¼–è¾‘è¾“å…¥åŒºï¼ˆç¼–è¾‘çŠ¶æ€ï¼‰===</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'input'</span>);
        <span class="hljs-comment">// åˆ›å»º&lt;input&gt;å…ƒç´ ç”¨äºç”¨æˆ·è¾“å…¥ï¼Œå¹¶å°†å…¶å¼•ç”¨ä¿å­˜åˆ° this.fieldElementï¼Œ</span>
        <span class="hljs-comment">// ä¾¿äºåç»­è¯»å–å€¼ã€èšç„¦åŠæ§åˆ¶æ˜¾ç¤º/éšè—ç­‰æ“ä½œã€‚</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'text'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;
        <span class="hljs-comment">//å°†å½“å‰ç»„ä»¶çš„å€¼ï¼ˆthis.valueï¼‰åŒæ­¥åˆ°è¾“å…¥æ¡†ä¸­ï¼Œä½œä¸ºç¼–è¾‘çš„èµ·ç‚¹ </span>
        <span class="hljs-comment">//ç¡®ä¿ç”¨æˆ·ç‚¹å‡»ç¼–è¾‘æ—¶ï¼Œçœ‹åˆ°çš„æ˜¯æœ€æ–°å†…å®¹ï¼Œè€Œéç©ºæ¡†ã€‚</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>);
       <span class="hljs-comment">//å°†è¾“å…¥æ¡†æ·»åŠ ä¸ºå®¹å™¨çš„å­èŠ‚ç‚¹ï¼Œæˆä¸º DOM æ ‘çš„ä¸€éƒ¨åˆ†</span>

    <span class="hljs-comment">// === åŠŸèƒ½æŒ‰é’®ï¼ˆè¯­ä¹‰åŒ– &amp; å¯è®¿é—®æ€§ï¼‰===</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'button'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">textContent</span> = <span class="hljs-string">'ä¿å­˜'</span>;
    <span class="hljs-comment">// å¯é€‰ï¼šæ·»åŠ  type="button" é˜²æ­¢è¡¨å•æ„å¤–æäº¤</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'button'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'button'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">textContent</span> = <span class="hljs-string">'å–æ¶ˆ'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'button'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>);

    <span class="hljs-comment">// === æŒ‚è½½åˆ°é¡µé¢ ===</span>
    <span class="hljs-comment">// å°†æ•´ä¸ªç»„ä»¶å­æ ‘æ’å…¥ç”¨æˆ·æŒ‡å®šçš„çˆ¶å®¹å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentElement</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">containerElement</span>);

    <span class="hljs-comment">// åˆå§‹åŒ–ä¸ºåªè¯»çŠ¶æ€ï¼ˆéšè—ç¼–è¾‘æ§ä»¶ï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToText</span>();
}
</code></pre>
<h5 data-id="heading-13">ğŸ” <strong>å…³é”®çŸ¥è¯†ç‚¹</strong></h5>
<ul>
<li><strong>DOM æ ‘æ„å»º</strong>ï¼šæ‰€æœ‰å…ƒç´ åœ¨å†…å­˜ä¸­åˆ›å»ºåä¸€æ¬¡æ€§æŒ‚è½½ï¼Œå‡å°‘é‡æ’ï¼ˆreflowï¼‰ã€‚</li>
<li><strong>è¯­ä¹‰åŒ– HTML</strong>ï¼š<code>&lt;button&gt;</code> è‡ªå¸¦é”®ç›˜å¯èšç„¦ã€å±å¹•é˜…è¯»å™¨æ”¯æŒï¼Œä¼˜äº <code>&lt;div&gt;</code>ã€‚</li>
<li><strong>å®‰å…¨é»˜è®¤</strong>ï¼š<code>textContent</code> è‡ªåŠ¨è½¬ä¹‰ HTML ç‰¹æ®Šå­—ç¬¦ï¼Œæ˜¯é˜² XSS çš„ç¬¬ä¸€é“é˜²çº¿ã€‚</li>
<li><strong>ID å”¯ä¸€æ€§</strong>ï¼š<code>this.id</code> åº”ç”±è°ƒç”¨è€…ä¿è¯å”¯ä¸€ï¼Œé¿å…å†²çªï¼ˆç”Ÿäº§ä¸­å»ºè®®åŠ å‰ç¼€å¦‚ <code>eip-${id}</code>ï¼‰ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-14">ğŸ”„ 2. çŠ¶æ€åˆ‡æ¢ï¼šç®¡ç†â€œè§†å›¾æ¨¡å¼â€çš„æ ¸å¿ƒå¼•æ“</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// åˆ‡æ¢åˆ°åªè¯»æ–‡æœ¬çŠ¶æ€</span>
<span class="hljs-title function_">convertToText</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// éšè—æ‰€æœ‰ç¼–è¾‘ç›¸å…³å…ƒç´ </span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
    
    <span class="hljs-comment">// æ˜¾ç¤ºé™æ€æ–‡æœ¬</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>; 
}

<span class="hljs-comment">// åˆ‡æ¢åˆ°å¯ç¼–è¾‘çŠ¶æ€</span>
<span class="hljs-title function_">convertToField</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// éšè—é™æ€æ–‡æœ¬</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
    
    <span class="hljs-comment">// åŒæ­¥æ•°æ®åˆ°è¾“å…¥æ¡†ï¼ˆå…³é”®ï¼ç¡®ä¿æ¯æ¬¡ç¼–è¾‘éƒ½åŸºäºæœ€æ–°å·²ä¿å­˜å€¼ï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;
    
    <span class="hljs-comment">// æ˜¾ç¤ºç¼–è¾‘æ§ä»¶</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'inline'</span>;
    
    <span class="hljs-comment">// è‡ªåŠ¨èšç„¦ + å…¨é€‰ï¼ˆæå‡ç”¨æˆ·ä½“éªŒï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-title function_">focus</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-title function_">select</span>(); <span class="hljs-comment">// å¯é€‰ï¼šå…¨é€‰æ–‡æœ¬ï¼Œæ–¹ä¾¿å¿«é€Ÿè¦†ç›–</span>
}
</code></pre>
<h5 data-id="heading-15">ğŸ” <strong>å…³é”®çŸ¥è¯†ç‚¹</strong></h5>
<ul>
<li><strong>çŠ¶æ€é©±åŠ¨è§†å›¾</strong>ï¼šç»„ä»¶åªæœ‰ä¸¤ç§äº’æ–¥çŠ¶æ€ï¼ˆç¼–è¾‘ / åªè¯»ï¼‰ï¼Œé€šè¿‡æ˜¾éšæ§åˆ¶åˆ‡æ¢ã€‚</li>
<li><strong>æ•°æ®ä¸€è‡´æ€§ä¿éšœ</strong>ï¼š<code>this.fieldElement.value = this.value</code> ç¡®ä¿è¾“å…¥æ¡†å§‹ç»ˆåæ˜ <strong>å·²ç¡®è®¤çš„æ•°æ®</strong>ï¼Œè€Œéæ®‹ç•™è‰ç¨¿ã€‚</li>
<li><strong>ç”¨æˆ·ä½“éªŒç»†èŠ‚</strong>ï¼š<code>focus()</code> è®©ç”¨æˆ·æ— éœ€å†ç‚¹ä¸€æ¬¡è¾“å…¥æ¡†ï¼›<code>select()</code> é€‚åˆâ€œæ ‡è¯­ç±»â€çŸ­æ–‡æœ¬åœºæ™¯ã€‚</li>
</ul>
<blockquote>
<p>âš ï¸ <strong>ä¸ºä»€ä¹ˆä¸ç›´æ¥åˆ é™¤/é‡å»º DOMï¼Ÿ</strong><br/>
é¢‘ç¹åˆ›å»º/é”€æ¯ DOM å¼€é”€å¤§ï¼Œä¸”ä¼šä¸¢å¤±ç„¦ç‚¹ã€äº‹ä»¶ç›‘å¬å™¨ç­‰çŠ¶æ€ã€‚<strong>å¤ç”¨ + æ˜¾éš</strong> æ˜¯æ›´é«˜æ•ˆã€ç¨³å®šçš„æ–¹æ¡ˆã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-16">âš¡ 3. äº‹ä»¶ç»‘å®šï¼šè¿æ¥ç”¨æˆ·è¡Œä¸ºä¸ç»„ä»¶é€»è¾‘çš„æ¡¥æ¢</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">attachEvent</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ç‚¹å‡»é™æ€æ–‡æœ¬ â†’ è¿›å…¥ç¼–è¾‘æ¨¡å¼</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToField</span>();
    });

    <span class="hljs-comment">// ç‚¹å‡»â€œä¿å­˜â€ â†’ è§¦å‘ä¿å­˜é€»è¾‘</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">saveButton</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">save</span>();
    });

    <span class="hljs-comment">// ç‚¹å‡»â€œå–æ¶ˆâ€ â†’ æ”¾å¼ƒä¿®æ”¹ï¼Œå›åˆ°åªè¯»çŠ¶æ€</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cancelButton</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cancel</span>();
    });
</code></pre>
<h5 data-id="heading-17">ğŸ” <strong>å…³é”®çŸ¥è¯†ç‚¹</strong></h5>
<ul>
<li><strong>ç®­å¤´å‡½æ•°è§£å†³ <code>this</code> ç»‘å®šé—®é¢˜</strong>ï¼š<br/>
æ™®é€šå‡½æ•°ä¸­ <code>this</code> æŒ‡å‘è§¦å‘å…ƒç´ ï¼Œè€Œç®­å¤´å‡½æ•°ç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸï¼ˆå³ç»„ä»¶å®ä¾‹ï¼‰ï¼Œé¿å… <code>this.save is not a function</code> é”™è¯¯ã€‚</li>
<li><strong>äº‹ä»¶å§”æ‰˜ vs ç›´æ¥ç»‘å®š</strong>ï¼šæ­¤å¤„å…ƒç´ å›ºå®šä¸”æ•°é‡å°‘ï¼Œç›´æ¥ç»‘å®šæ›´ç®€å•é«˜æ•ˆã€‚</li>
<li><strong>å¯è®¿é—®æ€§ï¼ˆa11yï¼‰</strong> ï¼š<code>&lt;button&gt;</code> é»˜è®¤æ”¯æŒ Enter/Space è§¦å‘ï¼Œå·²æ»¡è¶³åŸºç¡€äº¤äº’ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-18">ğŸ’¾ 4. ä¿å­˜é€»è¾‘ï¼šä¸šåŠ¡è§„åˆ™ä¸å¼‚æ­¥å¤„ç†çš„äº¤æ±‡ç‚¹</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">save</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
        <span class="hljs-keyword">var</span> value = <span class="hljs-variable language_">this</span>.<span class="hljs-property">fieldElement</span>.<span class="hljs-property">value</span>; <span class="hljs-comment">//è¯»å–å½“å‰è¾“å…¥æ¡†ä¸­çš„ç”¨æˆ·è¾“å…¥</span>
        <span class="hljs-comment">// fetchåç«¯å­˜å‚¨</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;<span class="hljs-comment">// æ›´æ–°å€¼</span>
        <span class="hljs-comment">//å·¦è¾¹ this.valueï¼šç»„ä»¶å†…éƒ¨æ•°æ®å±æ€§</span>
        <span class="hljs-comment">//å³è¾¹ valueï¼šä¸Šä¸€è¡Œå®šä¹‰çš„å±€éƒ¨å˜é‡ï¼ˆç”¨æˆ·çš„æ–°è¾“å…¥ï¼‰</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">staticElement</span>.<span class="hljs-property">innerHTML</span> = value;<span class="hljs-comment">// æ›´æ–°æ˜¾ç¤ºå€¼</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToText</span>();<span class="hljs-comment">// è½¬æ¢åˆ°æ–‡æœ¬æ˜¾ç¤ºçŠ¶æ€</span>
    },
    <span class="hljs-comment">//å½“ç”¨æˆ·ç‚¹å‡»â€œå–æ¶ˆâ€æŒ‰é’®æ—¶ï¼Œæ”¾å¼ƒå½“å‰æ‰€æœ‰æœªä¿å­˜çš„ä¿®æ”¹ï¼Œç«‹å³å›åˆ°åªè¯»çš„æ–‡æœ¬æ˜¾ç¤ºçŠ¶æ€ã€‚</span>
    <span class="hljs-attr">cancel</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"/>){ 
        <span class="hljs-comment">// æ‰€æœ‰é€šè¿‡ new EditInPlace(...) åˆ›å»ºçš„å®ä¾‹éƒ½å¯ä»¥è°ƒç”¨ ep.cancel()ã€‚</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToText</span>();<span class="hljs-comment">// è½¬æ¢åˆ°æ–‡æœ¬æ˜¾ç¤ºçŠ¶æ€</span>
    }
</code></pre>
<h5 data-id="heading-19">ğŸ” <strong>å…³é”®çŸ¥è¯†ç‚¹</strong></h5>
<ul>
<li><strong>æ•°æ®ä¸€è‡´æ€§ä¿éšœ</strong>ï¼š<br/>
<code>this.value = value</code> ç¡®ä¿ç»„ä»¶å†…éƒ¨çŠ¶æ€ä¸ç”¨æˆ·è¾“å…¥åŒæ­¥ï¼Œä½œä¸ºåç»­æ˜¾ç¤ºå’Œå–æ¶ˆæ“ä½œçš„å”¯ä¸€ä¾æ®ã€‚</li>
<li><strong>XSS å®‰å…¨éšæ‚£</strong>ï¼š<br/>
ä½¿ç”¨ <code>innerHTML = value</code> ä¼šç›´æ¥æ¸²æŸ“ HTMLï¼Œè‹¥ <code>value</code> åŒ…å«æ¶æ„è„šæœ¬ï¼ˆå¦‚ <code>&lt;script&gt;</code> æˆ–äº‹ä»¶å±æ€§ï¼‰ï¼Œå°†å¯¼è‡´ <strong>è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰</strong> ã€‚</li>
<li><strong>å®‰å…¨æ›¿ä»£æ–¹æ¡ˆ</strong>ï¼š<br/>
åº”ä¼˜å…ˆä½¿ç”¨ <code>textContent</code> è€Œé <code>innerHTML</code>ï¼Œå°†ç”¨æˆ·è¾“å…¥å§‹ç»ˆè§†ä¸ºçº¯æ–‡æœ¬ï¼Œè‡ªåŠ¨è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ã€‚</li>
<li><strong>æ— å‰¯ä½œç”¨çš„å–æ¶ˆé€»è¾‘</strong>ï¼š<br/>
<code>cancel()</code> ä»…åˆ‡æ¢è§†å›¾çŠ¶æ€ï¼Œä¸ä¿®æ”¹ <code>this.value</code>ï¼Œç¡®ä¿â€œæ”¾å¼ƒç¼–è¾‘â€è¡Œä¸ºå¯é¢„æµ‹ã€é›¶é£é™©ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-20">ğŸš« 5. å–æ¶ˆé€»è¾‘ï¼šå…‹åˆ¶çš„ä¼˜é›…</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">cancel</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ä»…åˆ‡æ¢è§†å›¾çŠ¶æ€ï¼Œä¸ä¿®æ”¹ä»»ä½•æ•°æ®ï¼</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">convertToText</span>();
}
</code></pre>
<h5 data-id="heading-21">ğŸ” <strong>è®¾è®¡å“²å­¦</strong></h5>
<ul>
<li><strong>é›¶å‰¯ä½œç”¨</strong>ï¼š<code>cancel</code> ä¸è§¦ç¢° <code>this.value</code>ï¼Œç¡®ä¿æ•°æ®å§‹ç»ˆå¹²å‡€ã€‚</li>
<li><strong>å¿ƒç†é¢„æœŸåŒ¹é…</strong>ï¼šç”¨æˆ·ç‚¹å‡»â€œå–æ¶ˆâ€ï¼ŒæœŸæœ›â€œä¸€åˆ‡å¦‚åˆâ€ï¼Œæ­¤è®¾è®¡å®Œç¾å¥‘åˆã€‚</li>
<li><strong>è‡ªåŠ¨ä¸¢å¼ƒè‰ç¨¿</strong>ï¼šä¸‹æ¬¡è¿›å…¥ç¼–è¾‘æ—¶ï¼Œè¾“å…¥æ¡†ä¼šç”¨ <code>this.value</code> é‡ç½®ï¼Œæ®‹ç•™è¾“å…¥è‡ªç„¶æ¶ˆå¤±ã€‚</li>
</ul>
<blockquote>
<p>âœ… <strong>è¿™æ˜¯â€œçŠ¶æ€éš”ç¦»â€æ€æƒ³çš„å…¸èŒƒ</strong>ï¼šè§†å›¾çŠ¶æ€ â‰  æ•°æ®çŠ¶æ€ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-22">äº”ã€ä½¿ç”¨ç¤ºä¾‹ï¼ˆè¡¥å……è¯´æ˜ï¼‰</h3>
<pre><code class="hljs language-js" lang="js">&lt;div id=<span class="hljs-string">"app"</span>&gt;&lt;/div&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./EditInPlace.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªå°±åœ°ç¼–è¾‘å®ä¾‹</span>
    <span class="hljs-keyword">const</span> editor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EditInPlace</span>(
        <span class="hljs-string">'user-slogan'</span>,               <span class="hljs-comment">// ç»„ä»¶ IDï¼ˆç”¨äº container.idï¼‰</span>
        <span class="hljs-string">'æ¬¢è¿æ¥åˆ°æˆ‘çš„ä¸»é¡µ'</span>,           <span class="hljs-comment">// åˆå§‹æ˜¾ç¤ºæ–‡æœ¬</span>
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'app'</span>) <span class="hljs-comment">// æŒ‚è½½ç‚¹</span>
    );

    <span class="hljs-comment">// ã€å¯é€‰ã€‘åç»­å¯é€šè¿‡ editor.value è¯»å–å½“å‰å€¼</span>
    <span class="hljs-comment">// console.log(editor.value);</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h5 data-id="heading-23">ğŸ”§ <strong>ä½¿ç”¨æ³¨æ„äº‹é¡¹</strong></h5>
<ul>
<li><code>parentElement</code> å¿…é¡»æ˜¯<strong>å·²å­˜åœ¨äº DOM ä¸­çš„çœŸå®å…ƒç´ </strong></li>
<li>å¤šä¸ªå®ä¾‹éœ€ä½¿ç”¨<strong>ä¸åŒ ID</strong>ï¼Œé¿å…å†²çª</li>
<li>è‹¥éœ€åŠ¨æ€é”€æ¯ï¼Œå»ºè®®åç»­è¡¥å…… <code>destroy()</code> æ–¹æ³•ï¼ˆç§»é™¤ DOM + è§£ç»‘äº‹ä»¶ï¼‰</li>
</ul>
<hr/>
<p>é€šè¿‡ä»¥ä¸Šå®Œå–„ï¼Œä½ çš„ <code>EditInPlace</code> ä¸ä»…åŠŸèƒ½å®Œæ•´ï¼Œæ›´å…·å¤‡äº†<strong>å®‰å…¨æ€§ã€å¯ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§</strong>ï¼ŒçœŸæ­£è¾¾åˆ°äº†â€œç”Ÿäº§çº§â€æ ‡å‡†ã€‚è¿™æ­£æ˜¯å‰ç«¯å·¥ç¨‹åŒ–çš„æ ¸å¿ƒè¿½æ±‚ï¼š<strong>ç”¨æ¸…æ™°çš„ç»“æ„ï¼Œè§£å†³å¤æ‚çš„é—®é¢˜</strong>ã€‚</p>
<h3 data-id="heading-24">å…­ã€æ€»ç»“ï¼šä»ç»„ä»¶ä¸­å­¦åˆ°çš„å‰ç«¯æ ¸å¿ƒæ€æƒ³</h3>

































<table><thead><tr><th>æ¦‚å¿µ</th><th>æœ¬æ–‡ä½“ç°</th></tr></thead><tbody><tr><td><strong>OOP å°è£…</strong></td><td>å±æ€§å­˜çŠ¶æ€ï¼Œæ–¹æ³•ç®¡è¡Œä¸ºï¼Œéšè—å®ç°ç»†èŠ‚</td></tr><tr><td><strong>DOM æ“ä½œ</strong></td><td><code>createElement</code>Â +Â <code>appendChild</code>Â åŠ¨æ€æ„å»ºç•Œé¢</td></tr><tr><td><strong>äº‹ä»¶æœºåˆ¶</strong></td><td><code>addEventListener</code>Â + ç®­å¤´å‡½æ•°è§£å†³Â <code>this</code>Â é—®é¢˜</td></tr><tr><td><strong>æ•°æ®é©±åŠ¨</strong></td><td><code>this.value</code>Â ä½œä¸ºå”¯ä¸€æ•°æ®æºï¼Œä¿è¯ä¸€è‡´æ€§</td></tr><tr><td><strong>å®‰å…¨æ„è¯†</strong></td><td>ç”¨Â <code>textContent</code>Â é˜² XSS</td></tr><tr><td><strong>ç”¨æˆ·ä½“éªŒ</strong></td><td>è‡ªåŠ¨èšç„¦ã€å–æ¶ˆå›é€€ã€æ— å˜åŒ–ä¸ä¿å­˜</td></tr></tbody></table>
<blockquote>
<p>ğŸŒŸ <strong>çœŸæ­£çš„å·¥ç¨‹èƒ½åŠ›ï¼Œä¸åœ¨äºä¼šå¤šå°‘ APIï¼Œè€Œåœ¨äºèƒ½å¦ç”¨æ¸…æ™°ã€å®‰å…¨ã€å¯ç»´æŠ¤çš„æ–¹å¼è§£å†³é—®é¢˜ã€‚</strong></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäºVue3å®ŒæˆåŠ¨æ€ç»„ä»¶åº“å»ºè®¾]]></title>    <link>https://juejin.cn/post/7579832186880180274</link>    <guid>https://juejin.cn/post/7579832186880180274</guid>    <pubDate>2025-12-04T12:40:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579832186880180274" data-draft-id="7579798332778102793" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäºVue3å®ŒæˆåŠ¨æ€ç»„ä»¶åº“å»ºè®¾"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-04T12:40:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Hashan"/> <meta itemprop="url" content="https://juejin.cn/user/3523276916662526"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäºVue3å®ŒæˆåŠ¨æ€ç»„ä»¶åº“å»ºè®¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3523276916662526/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Hashan
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T12:40:35.000Z" title="Thu Dec 04 2025 12:40:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸Šä¸€é˜¶æ®µæˆ‘ä»¬åŸºäº DSL é…ç½®å®ç°äº†schema-viewé¡µé¢çš„è‡ªåŠ¨åŒ–æ¸²æŸ“ï¼Œæ ¸å¿ƒè§£å†³äº†é‡å¤æ€§é¡µé¢å¼€å‘çš„æ•ˆç‡é—®é¢˜ã€‚ä½†åœ¨å®é™…ä¸šåŠ¡ä¸­ï¼Œæ–°å¢ã€ç¼–è¾‘ã€åˆ é™¤ã€æŸ¥çœ‹ç­‰äº¤äº’æ“ä½œä»éœ€æ‰‹åŠ¨å¼€å‘ç»„ä»¶ï¼Œå¯¼è‡´å¼€å‘æµç¨‹å‰²è£‚ã€‚æœ¬é˜¶æ®µçš„æ ¸å¿ƒç›®æ ‡æ˜¯ï¼š<strong>åœ¨</strong> <strong>schema-view</strong> <strong>åŸºç¡€ä¸Šï¼Œé€šè¿‡ç»Ÿä¸€é…ç½®å®ç°äº¤äº’ç»„ä»¶çš„åŠ¨æ€åŠ è½½ã€æ¸²æŸ“ä¸é€šä¿¡</strong>ï¼Œè®©æ•´ä¸ªé¡µé¢ä½“ç³»çœŸæ­£å®ç° "é…ç½®å³å¼€å‘"ã€‚</p>
<p>æœ¬æ–‡å°†å›´ç»•ä¸‰ä¸ªæ ¸å¿ƒé—®é¢˜å±•å¼€ï¼š</p>
<ol>
<li>å¦‚ä½•è®¾è®¡åˆç†çš„é…ç½®ä½“ç³»ï¼Œæè¿°ç»„ä»¶çš„ç»“æ„ã€è§¦å‘æ–¹å¼ä¸å­—æ®µå±æ€§ï¼Ÿ</li>
</ol>

<ol start="2">
<li>å¦‚ä½•è§£æé…ç½®å¹¶æå–æœ‰æ•ˆä¿¡æ¯ï¼Œä¸ºåŠ¨æ€æ¸²æŸ“æä¾›æ•°æ®æ”¯æ’‘ï¼Ÿ</li>
</ol>

<ol start="3">
<li>å¦‚ä½•å®ç°ç»„ä»¶çš„åˆ†å±‚æ¸²æŸ“ä¸è·¨å±‚çº§é€šä¿¡ï¼Œä¿è¯æ‰©å±•æ€§ä¸å¯ç»´æŠ¤æ€§ï¼Ÿ</li>
</ol>
<h2 data-id="heading-0">ä¸€ã€é…ç½®ä½“ç³»è®¾è®¡ï¼šç”¨ JSON æè¿°ç»„ä»¶å…¨ç”Ÿå‘½å‘¨æœŸ</h2>
<p>é…ç½®è®¾è®¡çš„æ ¸å¿ƒæ€æƒ³æ˜¯ <strong>"å•ä¸€æ•°æ®æº"</strong>ï¼šé€šè¿‡ä¸€ä¸ªschemaConfigå¯¹è±¡ï¼Œç»Ÿä¸€æè¿°ç»„ä»¶å…ƒä¿¡æ¯ã€è§¦å‘è§„åˆ™ã€å­—æ®µå±æ€§ä¸ API äº¤äº’ï¼Œè®©æ¡†æ¶èƒ½å¤Ÿè‡ªåŠ¨è¯†åˆ« "éœ€è¦ä»€ä¹ˆç»„ä»¶"ã€"ä»€ä¹ˆæ—¶å€™è§¦å‘"ã€"ç»„ä»¶é‡Œæœ‰ä»€ä¹ˆ"ã€"å¦‚ä½•ä¸åç«¯äº¤äº’"ã€‚</p>
<h3 data-id="heading-1">1.1 ç»„ä»¶å…ƒä¿¡æ¯é…ç½®ï¼ˆcomponentConfigï¼‰</h3>
<p>å®šä¹‰åŠ¨æ€ç»„ä»¶çš„åŸºç¡€å±æ€§ï¼ˆæ ‡é¢˜ã€æŒ‰é’®æ–‡æœ¬ã€ä¸»é”®ç­‰ï¼‰ï¼Œä½œä¸ºç»„ä»¶çš„ "èº«ä»½æ ‡è¯†"ï¼š</p>
<pre><code class="hljs language-css" lang="css">schemaConfig: {
  componentConfig: {
    createForm: {
      title: <span class="hljs-string">'æ·»åŠ å•†å“'</span>,
      saveBtnText: <span class="hljs-string">'ä¿å­˜'</span>, // æŒ‰é’®æ–‡æœ¬è‡ªå®šä¹‰
    },
    editForm: {
      mainKey: <span class="hljs-string">'product_id'</span>, // ä¸»é”®å­—æ®µï¼Œç”¨äºæ•°æ®å›æ˜¾
      title: <span class="hljs-string">'ç¼–è¾‘å•†å“'</span>,
      saveBtnText: <span class="hljs-string">'ä¿å­˜'</span>,
    },
    detailPanel: {
      mainKey: <span class="hljs-string">'product_id'</span>,
      title: <span class="hljs-string">'å•†å“è¯¦æƒ…'</span>,
    },
  }
}
</code></pre>
<h3 data-id="heading-2">1.2 è§¦å‘è§„åˆ™é…ç½®ï¼ˆtableConfigï¼‰</h3>
<p>åœ¨è¡¨æ ¼çš„è¡¨å¤´ / è¡Œå°¾æŒ‰é’®ä¸­é…ç½®äº‹ä»¶ï¼ŒæŒ‡å®š "ç‚¹å‡»å“ªä¸ªæŒ‰é’®è§¦å‘å“ªä¸ªç»„ä»¶"ã€‚é€šè¿‡eventKey: 'showComponent'ç»Ÿä¸€è§¦å‘é€»è¾‘ï¼ŒeventOption.comNameå…³è”ç»„ä»¶å…ƒä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-css" lang="css">schemaConfig: {
  tableConfig: {
    // è¡¨å¤´æŒ‰é’®ï¼ˆæ–°å¢æ“ä½œï¼‰
    headerButtons: [{
      <span class="hljs-selector-tag">label</span>: <span class="hljs-string">'æ·»åŠ å•†å“'</span>,
      eventKey: <span class="hljs-string">'showComponent'</span>, // ç»Ÿä¸€è§¦å‘å‡½æ•°
      eventOption: { comName: <span class="hljs-string">'createForm'</span> }, // å…³è”æ–°å¢ç»„ä»¶
      type: <span class="hljs-string">'primary'</span>,
      plain: true
    }],
    // è¡Œå°¾æŒ‰é’®ï¼ˆè¯¦æƒ…/ç¼–è¾‘/åˆ é™¤ï¼‰
    rowButtons: [
      {
        <span class="hljs-selector-tag">label</span>: <span class="hljs-string">'è¯¦æƒ…'</span>,
        eventKey: <span class="hljs-string">'showComponent'</span>,
        eventOption: { comName: <span class="hljs-string">'detailPanel'</span> },
        type: <span class="hljs-string">'primary'</span>
      },
      {
        <span class="hljs-selector-tag">label</span>: <span class="hljs-string">'ä¿®æ”¹'</span>,
        eventKey: <span class="hljs-string">'showComponent'</span>,
        eventOption: { comName: <span class="hljs-string">'editForm'</span> },
        type: <span class="hljs-string">'warning'</span>
      },
      {
        <span class="hljs-selector-tag">label</span>: <span class="hljs-string">'åˆ é™¤'</span>,
        eventKey: <span class="hljs-string">'remove'</span>, // ç‰¹æ®Šäº‹ä»¶ï¼ˆæ— éœ€æ¸²æŸ“ç»„ä»¶ï¼‰
        eventOption: {
          params: { product_id: <span class="hljs-string">'schema::product_id'</span> } // åŠ¨æ€å–å½“å‰è¡Œproduct_id
        },
        type: <span class="hljs-string">'danger'</span>
      }
    ]
  }
}
</code></pre>
<h3 data-id="heading-3">1.3 å­—æ®µå±æ€§é…ç½®ï¼ˆpropertiesï¼‰</h3>
<p>ä¸ºæ¯ä¸ªæ•°æ®å­—æ®µé…ç½® "åœ¨ä¸åŒç»„ä»¶ä¸­çš„è¡¨ç°å½¢å¼"ï¼Œé€šè¿‡xxxOptionï¼ˆå¦‚createFormOptionï¼‰æŒ‡å®šå­—æ®µåœ¨å¯¹åº”ç»„ä»¶ä¸­çš„æ§ä»¶ç±»å‹ã€æ ¡éªŒè§„åˆ™ã€é»˜è®¤å€¼ç­‰ï¼š</p>
<pre><code class="hljs language-css" lang="css">schemaConfig: {
  api: <span class="hljs-string">'/api/proj/product'</span>, // åŸºç¡€APIï¼ˆéµå¾ªRESTè§„èŒƒï¼‰
  properties: {
    product_id: {
      type: <span class="hljs-string">'string'</span>,
      label: <span class="hljs-string">'å•†å“ID'</span>,
      // è¡¨æ ¼ä¸­æ˜¾ç¤ºé…ç½®
      tableOption: { <span class="hljs-attribute">width</span>: <span class="hljs-number">300</span>, <span class="hljs-string">'show-overflow-tooltip'</span>: true },
      // ç¼–è¾‘è¡¨å•ä¸­é…ç½®ï¼ˆç¦ç”¨çŠ¶æ€ï¼‰
      editFormOption: { comType: <span class="hljs-string">'input'</span>, disabled: true },
      // è¯¦æƒ…é¢æ¿ä¸­é…ç½®ï¼ˆä»…å±•ç¤ºï¼‰
      detailPanelOption: {}
    },
    product_name: {
      type: <span class="hljs-string">'string'</span>,
      label: <span class="hljs-string">'å•†å“åç§°'</span>,
      maxLength: <span class="hljs-number">20</span>, // å…¨å±€æ ¡éªŒè§„åˆ™
      minLength: <span class="hljs-number">3</span>,
      tableOption: { <span class="hljs-attribute">width</span>: <span class="hljs-number">200</span> },
      // æœç´¢æ¡†é…ç½®ï¼ˆåŠ¨æ€ä¸‹æ‹‰æ¡†ï¼‰
      searchOption: { comType: <span class="hljs-string">'dynamicSelect'</span>, api: <span class="hljs-string">'/api/proj/product_enum/list'</span> },
      // æ–°å¢è¡¨å•é…ç½®ï¼ˆé»˜è®¤å€¼ï¼‰
      createFormOption: { comType: <span class="hljs-string">'input'</span>, default: <span class="hljs-string">'å“²ç„æ–°è¯¾ç¨‹'</span> },
      editFormOption: { comType: <span class="hljs-string">'input'</span> },
      detailPanelOption: {}
    },
    price: {
      type: <span class="hljs-string">'number'</span>,
      label: <span class="hljs-string">'ä»·æ ¼'</span>,
      maximum: <span class="hljs-number">1000</span>, // æ•°å€¼æ ¡éªŒ
      minimum: <span class="hljs-number">30</span>,
      tableOption: { <span class="hljs-attribute">width</span>: <span class="hljs-number">200</span>, toFixed: <span class="hljs-number">2</span> }, // ä¿ç•™<span class="hljs-number">2</span>ä½å°æ•°
      searchOption: {
        comType: <span class="hljs-string">'select'</span>,
        enumList: [<span class="hljs-comment">/* é™æ€ä¸‹æ‹‰é€‰é¡¹ */</span>]
      },
      createFormOption: { comType: <span class="hljs-string">'inputNumber'</span> }, // æ•°å­—è¾“å…¥æ¡†
      editFormOption: { comType: <span class="hljs-string">'inputNumber'</span> },
      detailPanelOption: {}
    }
  }
}
</code></pre>
<h3 data-id="heading-4">1.4 API äº¤äº’é…ç½®ï¼šREST è§„èŒƒ + åŠ¨æ€å‚æ•°</h3>
<ul>
<li><strong>API å¤ç”¨</strong>ï¼šé€šè¿‡schemaConfig.apié…ç½®åŸºç¡€æ¥å£ï¼Œæ¡†æ¶æ ¹æ®æ“ä½œç±»å‹è‡ªåŠ¨æ˜ å°„ HTTP æ–¹æ³•ï¼ˆæ–°å¢â†’POSTã€ç¼–è¾‘â†’PUTã€åˆ é™¤â†’DELETEã€è¯¦æƒ…â†’GETï¼‰ã€‚</li>
</ul>

<ul>
<li><strong>åŠ¨æ€å‚æ•°</strong>ï¼šé€šè¿‡eventOption.paramsé…ç½®å‚æ•°æ˜ å°„ï¼Œschema::xxxè¯­æ³•è¡¨ç¤ºä»å½“å‰è¡Œæ•°æ®ä¸­å–xxxå­—æ®µå€¼ï¼ˆå¦‚åˆ é™¤æ“ä½œå–product_idï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-5">é…ç½®è®¾è®¡æ€»ç»“</h3>
<p>æ•´ä¸ªé…ç½®ä½“ç³»åˆ†ä¸ºä¸‰å±‚ï¼Œå±‚å±‚é€’è¿›ï¼š</p>
<ol>
<li><strong>ç»„ä»¶å±‚</strong>ï¼ˆcomponentConfigï¼‰ï¼šæè¿°ç»„ä»¶ "æ˜¯ä»€ä¹ˆ"ï¼›</li>
</ol>

<ol start="2">
<li><strong>è§¦å‘å±‚</strong>ï¼ˆtableConfigï¼‰ï¼šæè¿°ç»„ä»¶ "ä½•æ—¶è§¦å‘"ï¼›</li>
</ol>

<ol start="3">
<li><strong>å­—æ®µå±‚</strong>ï¼ˆpropertiesï¼‰ï¼šæè¿°ç»„ä»¶ "åŒ…å«ä»€ä¹ˆ"ï¼›</li>
</ol>

<ol start="4">
<li><strong>API å±‚</strong>ï¼šæè¿°ç»„ä»¶ "å¦‚ä½•ä¸åç«¯äº¤äº’"ã€‚</li>
</ol>
<h2 data-id="heading-6">äºŒã€é…ç½®è§£æï¼šç”¨ HOOK ç»Ÿä¸€å¤„ç†é…ç½®æ•°æ®</h2>
<p>é…ç½®è§£æçš„æ ¸å¿ƒæ˜¯ <strong>"å»å™ªæå–"</strong>ï¼šä»å¤æ‚çš„schemaConfigä¸­è¿‡æ»¤æ— æ•ˆä¿¡æ¯ï¼Œæå–å‡ºæ¯ä¸ªåŠ¨æ€ç»„ä»¶æ‰€éœ€çš„ "å­—æ®µ schema" å’Œ "ç»„ä»¶é…ç½®"ï¼Œå¹¶å°è£…ä¸ºå¯å¤ç”¨çš„ HOOKï¼ˆuseSchemaï¼‰ï¼Œä¾›schema-viewä½¿ç”¨ã€‚</p>
<h3 data-id="heading-7">2.1 HOOK æ ¸å¿ƒåŠŸèƒ½</h3>
<ul>
<li>ç›‘å¬è·¯ç”±å’Œèœå•é…ç½®å˜åŒ–ï¼Œè‡ªåŠ¨é‡å»ºé…ç½®æ•°æ®ï¼›</li>
</ul>

<ul>
<li>åˆ†ç¦»è¡¨æ ¼ã€æœç´¢ã€åŠ¨æ€ç»„ä»¶çš„é…ç½®ï¼Œé¿å…ç›¸äº’å¹²æ‰°ï¼›</li>
</ul>

<ul>
<li>ä¸ºæ¯ä¸ªåŠ¨æ€ç»„ä»¶æ„å»ºç‹¬ç«‹çš„ schemaï¼ˆä»…åŒ…å«è¯¥ç»„ä»¶æ‰€éœ€å­—æ®µï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-8">2.2 å…³é”®ä»£ç å®ç°</h3>
<pre><code class="hljs language-ini" lang="ini">// src/hooks/schema.js
import { ref, watch, onMounted, nextTick } from "vue"<span class="hljs-comment">;</span>
import { useRoute } from "vue-router"<span class="hljs-comment">;</span>
import { useMenuStore } from "@/store/menu.js"<span class="hljs-comment">;</span>
export const <span class="hljs-attr">useSchema</span> = () =&gt; {
  const <span class="hljs-attr">route</span> = useRoute()<span class="hljs-comment">;</span>
  const <span class="hljs-attr">menuStore</span> = useMenuStore()<span class="hljs-comment">;</span>
  // æš´éœ²ç»™å¤–éƒ¨çš„æ•°æ®
  const <span class="hljs-attr">api</span> = ref(<span class="hljs-string">''</span>)<span class="hljs-comment">;</span>
  const <span class="hljs-attr">components</span> = ref({})<span class="hljs-comment">; // åŠ¨æ€ç»„ä»¶é…ç½®ï¼š{ comName: { schema, config } }</span>
  const <span class="hljs-section">[tableSchema, tableConfig, searchSchema, searchConfig]</span> = <span class="hljs-section">[ref({}), ref({}), ref({}), ref({})]</span><span class="hljs-comment">;</span>
  // æ„å»ºé…ç½®æ•°æ®ï¼ˆæ ¸å¿ƒå‡½æ•°ï¼‰
  const <span class="hljs-attr">buildData</span> = () =&gt; {
    const { key, sider_key: siderKey } = route.query<span class="hljs-comment">;</span>
    const <span class="hljs-attr">menuItem</span> = menuStore.findMenuItem({ key: <span class="hljs-string">'key'</span>, value: siderKey ?? key })<span class="hljs-comment">;</span>
    
    if (!menuItem?.schemaConfig) return<span class="hljs-comment">;</span>
    const { schemaConfig } = menuItem<span class="hljs-comment">;</span>
    const <span class="hljs-attr">configSchema</span> = JSON.parse(JSON.stringify(schemaConfig.schema))<span class="hljs-comment">; // æ·±æ‹·è´é¿å…æ±¡æŸ“åŸé…ç½®</span>
    // åˆå§‹åŒ–æ•°æ®
    <span class="hljs-attr">api.value</span> = schemaConfig.api ?? <span class="hljs-string">''</span><span class="hljs-comment">;</span>
    <span class="hljs-section">[tableSchema.value, tableConfig.value, searchSchema.value, searchConfig.value, components.value]</span> = <span class="hljs-section">[{}, {}, {}, {}, {}]</span><span class="hljs-comment">;</span>
    nextTick(() =&gt; {
      // 1. æ„å»ºè¡¨æ ¼é…ç½®
      <span class="hljs-attr">tableSchema.value</span> = buildDtoSchema(configSchema, <span class="hljs-string">'table'</span>)<span class="hljs-comment">;</span>
      <span class="hljs-attr">tableConfig.value</span> = schemaConfig.tableConfig<span class="hljs-comment">;</span>
      // 2. æ„å»ºæœç´¢é…ç½®ï¼ˆæ”¯æŒè·¯ç”±å‚æ•°å›æ˜¾ï¼‰
      const <span class="hljs-attr">searchDto</span> = buildDtoSchema(configSchema, <span class="hljs-string">'search'</span>)<span class="hljs-comment">;</span>
      Object.keys(searchDto.properties).forEach(<span class="hljs-attr">key</span> =&gt; {
        if (route.query<span class="hljs-section">[key]</span> !== undefined) {
          searchDto.properties<span class="hljs-section">[key]</span>.<span class="hljs-attr">option.default</span> = route.query[key]<span class="hljs-comment">;</span>
        }
      })<span class="hljs-comment">;</span>
      <span class="hljs-attr">searchSchema.value</span> = searchDto<span class="hljs-comment">;</span>
      <span class="hljs-attr">searchConfig.value</span> = schemaConfig.searchConfig<span class="hljs-comment">;</span>
      // 3. æ„å»ºåŠ¨æ€ç»„ä»¶é…ç½®ï¼ˆæ ¸å¿ƒï¼‰
      const { componentConfig } = schemaConfig<span class="hljs-comment">;</span>
      if (componentConfig &amp;&amp; Object.keys(componentConfig).length) {
        const <span class="hljs-attr">coms</span> = {}<span class="hljs-comment">;</span>
        Object.keys(componentConfig).forEach(<span class="hljs-attr">comName</span> =&gt; {
          coms<span class="hljs-section">[comName]</span> = {
            schema: buildDtoSchema(configSchema, comName), // ä»…æå–è¯¥ç»„ä»¶æ‰€éœ€å­—æ®µ
            config: componentConfig<span class="hljs-section">[comName]</span>
          }<span class="hljs-comment">;</span>
        })<span class="hljs-comment">;</span>
        <span class="hljs-attr">components.value</span> = coms<span class="hljs-comment">;</span>
      }
    })<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
  // é€šç”¨schemaæ„å»ºï¼šè¿‡æ»¤æŒ‡å®šç»„ä»¶çš„å­—æ®µï¼ˆå»å™ªï¼‰
  const <span class="hljs-attr">buildDtoSchema</span> = (_schema, comName) =&gt; {
    if (!_schema?.properties) return { type: 'object', properties: {} }<span class="hljs-comment">;</span>
    const <span class="hljs-attr">dtoSchema</span> = { type: <span class="hljs-string">'object'</span>, properties: {} }<span class="hljs-comment">;</span>
    Object.keys(_schema.properties).forEach(<span class="hljs-attr">key</span> =&gt; {
      const <span class="hljs-attr">props</span> = _schema.properties[key]<span class="hljs-comment">;</span>
      // åªä¿ç•™åŒ…å«å½“å‰ç»„ä»¶Optionçš„å­—æ®µï¼ˆå¦‚createFormOptionï¼‰
      if (props<span class="hljs-section">[`${comName}Option`]</span>) {
        // æå–éOptionå±æ€§ï¼ˆtypeã€labelã€maxLengthç­‰ï¼‰
        const <span class="hljs-attr">baseProps</span> = Object.fromEntries(
          Object.entries(props).filter((<span class="hljs-section">[k]</span>) =&gt; !k.includes('Option'))
        )<span class="hljs-comment">;</span>
        // åˆå¹¶ç»„ä»¶ä¸“å±é…ç½®ï¼ˆxxxOptionï¼‰
        const <span class="hljs-attr">dtoProps</span> = {
          ...baseProps,
          option: props<span class="hljs-section">[`${comName}Option`]</span>,
          required: _schema.required?.includes(key) // æ ‡è®°å¿…å¡«å­—æ®µ
        }<span class="hljs-comment">;</span>
        dtoSchema.properties<span class="hljs-section">[key]</span> = dtoProps<span class="hljs-comment">;</span>
      }
    })<span class="hljs-comment">;</span>
    return dtoSchema<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
  // ç›‘å¬ä¾èµ–å˜åŒ–ï¼Œè‡ªåŠ¨é‡å»ºé…ç½®
  watch(<span class="hljs-section">[() =&gt; route.query, () =&gt; menuStore.menuList]</span>, buildData, { deep: true })<span class="hljs-comment">;</span>
  onMounted(buildData)<span class="hljs-comment">;</span>
  return { api, tableSchema, tableConfig, searchSchema, searchConfig, components }<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<h2 data-id="heading-9">ä¸‰ã€åˆ†å±‚æ¸²æŸ“ï¼šä»é¡¶å±‚åˆ°åº•å±‚çš„åŠ¨æ€ç»„ä»¶å®ç°</h2>
<p>æ¸²æŸ“è®¾è®¡éµå¾ª <strong>"åˆ†å±‚è§£è€¦"</strong> åŸåˆ™ï¼Œå°†ç»„ä»¶åˆ†ä¸ºä¸‰å±‚ï¼šé¡¶å±‚å®¹å™¨ï¼ˆschema-viewï¼‰ã€ä¸­é—´å±‚ç»„ä»¶ï¼ˆæ–°å¢ / ç¼–è¾‘ / è¯¦æƒ…ï¼‰ã€åº•å±‚å­—æ®µæ§ä»¶ï¼ˆè¾“å…¥æ¡† / ä¸‹æ‹‰æ¡†ç­‰ï¼‰ï¼Œæ¯å±‚è´Ÿè´£ä¸åŒèŒè´£ï¼Œé€šè¿‡ Vue çš„åŠ¨æ€ç»„ä»¶ï¼ˆï¼‰å®ç°çµæ´»æ¸²æŸ“ã€‚</p>
<h3 data-id="heading-10">3.1 ç›®å½•ç»“æ„è®¾è®¡</h3>
<pre><code class="hljs language-python" lang="python">src/
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ dashboard/
â”‚       â””â”€â”€ <span class="hljs-built_in">complex</span>-view/
â”‚           â””â”€â”€ schema-view/
â”‚               â”œâ”€â”€ schema-view.vue       <span class="hljs-comment"># é¡¶å±‚å®¹å™¨</span>
â”‚               â””â”€â”€ components/           <span class="hljs-comment"># ä¸­é—´å±‚ç»„ä»¶</span>
â”‚                   â”œâ”€â”€ create-form/
â”‚                   â”œâ”€â”€ edit-form/
â”‚                   â”œâ”€â”€ detail-panel/
â”‚                   â””â”€â”€ component-config.js <span class="hljs-comment"># ä¸­é—´å±‚ç»„ä»¶æ˜ å°„</span>
â””â”€â”€ widgets/
    â””â”€â”€ schema-form/                     <span class="hljs-comment"># åº•å±‚å­—æ®µæ§ä»¶</span>
        â”œâ”€â”€ schema-form.vue              <span class="hljs-comment"># å­—æ®µå®¹å™¨</span>
        â”œâ”€â”€ form-item-config.js          <span class="hljs-comment"># æ§ä»¶æ˜ å°„</span>
        â””â”€â”€ components/                  <span class="hljs-comment"># å…·ä½“æ§ä»¶ï¼ˆinput/selectç­‰ï¼‰</span>
</code></pre>
<h3 data-id="heading-11">3.2 é¡¶å±‚æ¸²æŸ“ï¼šschema-view.vue</h3>
<p>ä½œä¸ºå®¹å™¨ï¼Œè´Ÿè´£åŠ è½½ä¸­é—´å±‚ç»„ä»¶ï¼Œç®¡ç†ç»„ä»¶çŠ¶æ€ä¸äº‹ä»¶åˆ†å‘ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- åŠ¨æ€æ¸²æŸ“ä¸­é—´å±‚ç»„ä»¶ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">component</span>
    <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(item, comName) in components"</span>
    <span class="hljs-attr">:key</span>=<span class="hljs-string">"comName"</span>
    <span class="hljs-attr">:is</span>=<span class="hljs-string">"ComponentConfig[comName]?.component"</span>
    <span class="hljs-attr">ref</span>=<span class="hljs-string">"comListRef"</span>
    @<span class="hljs-attr">command</span>=<span class="hljs-string">"handleComponentCommand"</span>
  &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, provide } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;
<span class="hljs-keyword">import</span> { useSchema } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/hooks/schema.js"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ComponentConfig</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./components/component-config.js"</span>;
<span class="hljs-comment">// è·å–è§£æåçš„é…ç½®</span>
<span class="hljs-keyword">const</span> { api, components } = <span class="hljs-title function_">useSchema</span>();
<span class="hljs-comment">// æä¾›å…¨å±€æ•°æ®ï¼ˆä¾›å­ç»„ä»¶æ³¨å…¥ï¼‰</span>
<span class="hljs-title function_">provide</span>(<span class="hljs-string">"schemaViewData"</span>, { api, components });
<span class="hljs-comment">// ç»„ä»¶å¼•ç”¨é›†åˆ</span>
<span class="hljs-keyword">const</span> comListRef = <span class="hljs-title function_">ref</span>([]);
<span class="hljs-comment">// å¤„ç†å­ç»„ä»¶äº‹ä»¶ï¼ˆå¦‚ä¿å­˜ååˆ·æ–°è¡¨æ ¼ï¼‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleComponentCommand</span> = (<span class="hljs-params">{ event, params }</span>) =&gt; {
  <span class="hljs-keyword">if</span> (event === <span class="hljs-string">"loadTableData"</span>) {
    <span class="hljs-comment">// è§¦å‘è¡¨æ ¼åˆ·æ–°é€»è¾‘</span>
    <span class="hljs-title function_">emit</span>(<span class="hljs-string">"refreshTable"</span>);
  }
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-12">3.3 ä¸­é—´å±‚æ¸²æŸ“ï¼šæ–°å¢ / ç¼–è¾‘ / è¯¦æƒ…ç»„ä»¶</h3>
<p>ä¸­é—´å±‚ç»„ä»¶æ˜¯ "ç»„ä»¶æ¡†æ¶"ï¼Œè´Ÿè´£å¸ƒå±€ï¼ˆæŠ½å±‰ / å¼¹çª—ï¼‰ã€æŒ‰é’®äº‹ä»¶ï¼ˆä¿å­˜ / å…³é—­ï¼‰ã€è¡¨å•æ¸²æŸ“ï¼Œé€šè¿‡schema-formç»„ä»¶åŠ è½½åº•å±‚å­—æ®µæ§ä»¶ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;!-- create-form/create-form.vue --&gt;
&lt;template&gt;
  &lt;el-drawer
    <span class="hljs-attr">v-model</span>=<span class="hljs-string">"isShow"</span>
    <span class="hljs-attr">direction</span>=<span class="hljs-string">"rtl"</span>
    :<span class="hljs-attr">destroy-on-close</span>=<span class="hljs-string">"true"</span>
    :<span class="hljs-attr">size</span>=<span class="hljs-string">"550"</span>
  &gt;
    &lt;template <span class="hljs-comment">#header&gt;</span>
      &lt;h2 <span class="hljs-attr">class</span>=<span class="hljs-string">"title"</span>&gt;{{ title }}&lt;/h2&gt;
    &lt;/template&gt;
    &lt;schema-form
      <span class="hljs-attr">ref</span>=<span class="hljs-string">"schemaFormRef"</span>
      <span class="hljs-attr">v-loading</span>=<span class="hljs-string">"loading"</span>
      :<span class="hljs-attr">schema</span>=<span class="hljs-string">"components[name]?.schema"</span>
    /&gt;
    &lt;template <span class="hljs-comment">#footer&gt;</span>
      &lt;el-button <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span> @click=<span class="hljs-string">"save"</span>&gt;{{ saveBtnText }}&lt;/el-button&gt;
    &lt;/template&gt;
  &lt;/el-drawer&gt;
&lt;/template&gt;
&lt;script setup&gt;
import { ref, inject } from "vue"<span class="hljs-comment">;</span>
import { ElNotification } from "element-plus"<span class="hljs-comment">;</span>
import $curl from "@/common/curl.js"<span class="hljs-comment">;</span>
import SchemaForm from "@/widgets/schema-form/schema-form.vue"<span class="hljs-comment">;</span>
// æ³¨å…¥é¡¶å±‚æ•°æ®
const { api, components } = inject("schemaViewData")<span class="hljs-comment">;</span>
const <span class="hljs-attr">emit</span> = defineEmits([<span class="hljs-string">"command"</span>])<span class="hljs-comment">;</span>
const <span class="hljs-attr">name</span> = ref(<span class="hljs-string">"createForm"</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">schemaFormRef</span> = ref(null)<span class="hljs-comment">;</span>
const <span class="hljs-section">[isShow, loading, title, saveBtnText]</span> = <span class="hljs-section">[ref(false), ref(false), ref(""), ref("")]</span><span class="hljs-comment">;</span>
// æ˜¾ç¤ºç»„ä»¶ï¼ˆä¾›é¡¶å±‚è°ƒç”¨ï¼‰
const <span class="hljs-attr">show</span> = () =&gt; {
  const { config } = components.value<span class="hljs-section">[name.value]</span><span class="hljs-comment">;</span>
  <span class="hljs-attr">title.value</span> = config.title<span class="hljs-comment">;</span>
  <span class="hljs-attr">saveBtnText.value</span> = config.saveBtnText<span class="hljs-comment">;</span>
  <span class="hljs-attr">isShow.value</span> = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
// ä¿å­˜é€»è¾‘ï¼ˆéµå¾ªRESTè§„èŒƒï¼‰
const <span class="hljs-attr">save</span> = async () =&gt; {
  if (loading.value || !schemaFormRef.value.validate()) return<span class="hljs-comment">;</span>
  <span class="hljs-attr">loading.value</span> = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
  try {
    const <span class="hljs-attr">res</span> = await <span class="hljs-variable">$curl</span>({
      method: "post",
      url: api.value,
      data: schemaFormRef.value.getValue()
    })<span class="hljs-comment">;</span>
    if (res.success) {
      ElNotification({ title: "åˆ›å»ºæˆåŠŸ", type: "success" })<span class="hljs-comment">;</span>
      <span class="hljs-attr">isShow.value</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
      emit("command", { event: "loadTableData" })<span class="hljs-comment">; // é€šçŸ¥é¡¶å±‚åˆ·æ–°è¡¨æ ¼</span>
    }
  } finally {
    <span class="hljs-attr">loading.value</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;</span>
  }
}<span class="hljs-comment">;</span>
// æš´éœ²showæ–¹æ³•ï¼ˆä¾›é¡¶å±‚è°ƒç”¨ï¼‰
defineExpose({ name, show })<span class="hljs-comment">;</span>
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-13">3.4 åº•å±‚æ¸²æŸ“ï¼šschema-formå­—æ®µæ§ä»¶</h3>
<p>åº•å±‚ç»„ä»¶è´Ÿè´£æ¸²æŸ“å…·ä½“çš„è¡¨å•å­—æ®µï¼ˆè¾“å…¥æ¡†ã€ä¸‹æ‹‰æ¡†ç­‰ï¼‰ï¼Œé€šè¿‡form-item-config.jsç»Ÿä¸€ç®¡ç†æ§ä»¶æ˜ å°„ï¼Œæ”¯æŒè‡ªå®šä¹‰æ§ä»¶æ‰©å±•ï¼š</p>
<pre><code class="hljs language-css" lang="css">// widgets/schema-<span class="hljs-selector-tag">form</span>/<span class="hljs-selector-tag">form</span>-item-config<span class="hljs-selector-class">.js</span>
import <span class="hljs-selector-tag">Input</span> <span class="hljs-selector-tag">from</span> "./components/<span class="hljs-selector-tag">input</span><span class="hljs-selector-class">.vue</span>";
import InputNumber <span class="hljs-selector-tag">from</span> "./components/<span class="hljs-selector-tag">input</span>-number<span class="hljs-selector-class">.vue</span>";
import Select <span class="hljs-selector-tag">from</span> "./components/select<span class="hljs-selector-class">.vue</span>";
import DynamicSelect <span class="hljs-selector-tag">from</span> "./components/dynamic-select<span class="hljs-selector-class">.vue</span>";
export default {
  <span class="hljs-selector-tag">input</span>: { component: Input },
  inputNumber: { component: InputNumber },
  select: { component: Select },
  dynamicSelect: { component: DynamicSelect }
};
</code></pre>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- widgets/schema-form/schema-form.vue --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">el-row</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"schema-form"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(fieldSchema, key) in schema.properties"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"key"</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- åŠ¨æ€æ¸²æŸ“å­—æ®µæ§ä»¶ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">component</span>
        <span class="hljs-attr">v-show</span>=<span class="hljs-string">"fieldSchema.option.visible !== false"</span>
        <span class="hljs-attr">:is</span>=<span class="hljs-string">"FormItemConfig[fieldSchema.option.comType].component"</span>
        <span class="hljs-attr">:schema-key</span>=<span class="hljs-string">"key"</span>
        <span class="hljs-attr">:schema</span>=<span class="hljs-string">"fieldSchema"</span>
        <span class="hljs-attr">v-model</span>=<span class="hljs-string">"formModel[key]"</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">el-row</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<h2 data-id="heading-14">å››ã€ç»„ä»¶é€šä¿¡æœºåˆ¶ï¼šè·¨å±‚çº§çš„æ•°æ®ä¼ é€’ä¸äº‹ä»¶è”åŠ¨â€‹</h2>
<p>åŠ¨æ€ç»„ä»¶åº“ä¸­å­˜åœ¨ä¸‰å±‚ç»„ä»¶ç»“æ„ï¼Œé€šä¿¡éœ€æ±‚ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼š<strong>æ•°æ®å‘ä¸‹ä¼ é€’</strong>ï¼ˆé…ç½®ã€APIåœ°å€ç­‰ï¼‰å’Œ<strong>äº‹ä»¶å‘ä¸Šä¼ é€’</strong>ï¼ˆä¿å­˜æˆåŠŸã€å…³é—­ç»„ä»¶ç­‰ï¼‰ã€‚æˆ‘ä»¬é€šè¿‡Vueçš„<code>provide/inject</code>å’Œ<code>emit</code>å®ç°å…¨é“¾è·¯é€šä¿¡ï¼Œé¿å…å±‚å±‚propsä¼ é€’çš„å†—ä½™ã€‚â€‹</p>
<p>â€‹</p>
<h3 data-id="heading-15">4.1 æ•°æ®å‘ä¸‹ä¼ é€’ï¼šprovide/injectç©¿é€ä¼ é€’â€‹</h3>
<p>é¡¶å±‚å®¹å™¨ï¼ˆ<code>schema-view</code>ï¼‰é€šè¿‡<code>provide</code>æä¾›å…¨å±€æ•°æ®ï¼ˆAPIåœ°å€ã€ç»„ä»¶é…ç½®ç­‰ï¼‰ï¼Œä¸­é—´å±‚ç»„ä»¶ï¼ˆå¦‚<code>create-form</code>ï¼‰å’Œåº•å±‚ç»„ä»¶ï¼ˆ<code>schema-form</code>ï¼‰é€šè¿‡<code>inject</code>ç›´æ¥è·å–ï¼Œæ— éœ€é€å±‚ä¼ é€’ï¼šâ€‹</p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-comment">// é¡¶å±‚ï¼šschema-view.vue æä¾›æ•°æ®â€‹</span>

<span class="hljs-keyword">import</span> { provide } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;â€‹

<span class="hljs-keyword">import</span> { useSchema } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/hooks/schema.js"</span>;â€‹

â€‹

<span class="hljs-keyword">const</span> { api, components } = <span class="hljs-title function_">useSchema</span>();â€‹

<span class="hljs-title function_">provide</span>(<span class="hljs-string">"schemaGlobalData"</span>, {â€‹

api, <span class="hljs-comment">// åŸºç¡€APIåœ°å€â€‹</span>

components, <span class="hljs-comment">// åŠ¨æ€ç»„ä»¶é…ç½®â€‹</span>

<span class="hljs-attr">tableRefresh</span>: <span class="hljs-function">() =&gt;</span> { <span class="hljs-comment">/* è¡¨æ ¼åˆ·æ–°å‡½æ•° */</span> } <span class="hljs-comment">// å…¨å±€æ–¹æ³•â€‹</span>

});â€‹

â€‹

<span class="hljs-comment">// ä¸­é—´å±‚ï¼šcreate-form.vue æ³¨å…¥æ•°æ®â€‹</span>

<span class="hljs-keyword">import</span> { inject } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;â€‹

<span class="hljs-keyword">const</span> { api, components } = <span class="hljs-title function_">inject</span>(<span class="hljs-string">"schemaGlobalData"</span>);â€‹

â€‹

<span class="hljs-comment">// åº•å±‚ï¼šschema-form.vue æ³¨å…¥æ•°æ®ï¼ˆå¦‚éœ€ï¼‰â€‹</span>

<span class="hljs-keyword">const</span> { api } = <span class="hljs-title function_">inject</span>(<span class="hljs-string">"schemaGlobalData"</span>);
</code></pre>
<h3 data-id="heading-16">4.2 äº‹ä»¶å‘ä¸Šä¼ é€’ï¼šemit + æš´éœ²æ¥å£åŒæœºåˆ¶â€‹</h3>
<p>4.2.1 äº‹ä»¶å†’æ³¡ï¼ˆemitï¼‰â€‹</p>
<p>ä¸­é—´å±‚ç»„ä»¶é€šè¿‡emitè§¦å‘äº‹ä»¶ï¼Œé¡¶å±‚å®¹å™¨ç›‘å¬å¹¶å¤„ç†ï¼ˆå¦‚ä¿å­˜æˆåŠŸååˆ·æ–°è¡¨æ ¼ï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js">    <span class="hljs-comment">// ä¸­é—´å±‚ï¼šcreate-form.vue è§¦å‘äº‹ä»¶â€‹</span>

<span class="hljs-keyword">const</span> emit = <span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">"command"</span>]);â€‹

<span class="hljs-keyword">const</span> <span class="hljs-title function_">save</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {â€‹

<span class="hljs-comment">// ä¿å­˜é€»è¾‘...â€‹</span>

<span class="hljs-title function_">emit</span>(<span class="hljs-string">"command"</span>, { â€‹

<span class="hljs-attr">event</span>: <span class="hljs-string">"tableRefresh"</span>, <span class="hljs-comment">// äº‹ä»¶ç±»å‹â€‹</span>

<span class="hljs-attr">params</span>: { <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span> } <span class="hljs-comment">// é™„åŠ å‚æ•°â€‹</span>

});â€‹

};â€‹

â€‹

<span class="hljs-comment">// é¡¶å±‚ï¼šschema-view.vue ç›‘å¬äº‹ä»¶â€‹</span>

&lt;componentâ€‹

v-<span class="hljs-keyword">for</span>=<span class="hljs-string">"(item, comName) in components"</span>â€‹

:key=<span class="hljs-string">"comName"</span>â€‹

:is=<span class="hljs-string">"ComponentConfig[comName]?.component"</span>â€‹

@command=<span class="hljs-string">"handleComponentCommand"</span>â€‹

/&gt;â€‹

â€‹

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleComponentCommand</span> = (<span class="hljs-params">{ event, params }</span>) =&gt; {â€‹

<span class="hljs-keyword">if</span> (event === <span class="hljs-string">"tableRefresh"</span>) {â€‹

<span class="hljs-comment">// æ‰§è¡Œè¡¨æ ¼åˆ·æ–°é€»è¾‘â€‹</span>

<span class="hljs-title function_">tableRefresh</span>();â€‹

}â€‹

};
</code></pre>
<p>4.2.2 ç»„ä»¶æ¥å£æš´éœ²ï¼ˆdefineExposeï¼‰â€‹</p>
<p>é¡¶å±‚å®¹å™¨é€šè¿‡refè·å–ä¸­é—´å±‚ç»„ä»¶çš„å®ä¾‹ï¼Œç›´æ¥è°ƒç”¨ç»„ä»¶çš„æ–¹æ³•ï¼ˆå¦‚ä¸»åŠ¨æ˜¾ç¤ºç¼–è¾‘è¡¨å•å¹¶å›æ˜¾æ•°æ®ï¼‰ï¼š
â€‹</p>
<pre><code class="hljs language-js" lang="js">&lt;componentâ€‹

<span class="hljs-keyword">const</span> comRefs = <span class="hljs-title function_">ref</span>({}); <span class="hljs-comment">// ç»„ä»¶å®ä¾‹é›†åˆâ€‹</span>

â€‹

<span class="hljs-comment">// ç¼–è¾‘æŒ‰é’®ç‚¹å‡»ï¼šä¸»åŠ¨è°ƒç”¨edit-formçš„showæ–¹æ³•å¹¶ä¼ å‚â€‹</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">handleEdit</span> = (<span class="hljs-params">row</span>) =&gt; {â€‹

<span class="hljs-keyword">const</span> editCom = comRefs.<span class="hljs-property">value</span>.<span class="hljs-property">editForm</span>;â€‹

<span class="hljs-keyword">if</span> (editCom) {â€‹

editCom.<span class="hljs-title function_">show</span>({ â€‹

<span class="hljs-attr">data</span>: row, <span class="hljs-comment">// å›æ˜¾æ•°æ®ï¼ˆå¦‚product_idã€product_nameï¼‰â€‹</span>

<span class="hljs-attr">callback</span>: <span class="hljs-function">() =&gt;</span> { <span class="hljs-comment">/* ç¼–è¾‘å®Œæˆå›è°ƒ */</span> }â€‹

});â€‹

}â€‹

};â€‹

&lt;/script&gt;â€‹

â€‹

&lt;!-- ä¸­é—´å±‚ï¼šedit-form.<span class="hljs-property">vue</span> æš´éœ²showæ–¹æ³• --&gt;â€‹

&lt;script setup&gt;â€‹

<span class="hljs-keyword">const</span> <span class="hljs-title function_">show</span> = (<span class="hljs-params">options</span>) =&gt; {â€‹

<span class="hljs-keyword">const</span> { data } = options;â€‹

<span class="hljs-comment">// æ•°æ®å›æ˜¾åˆ°è¡¨å•â€‹</span>

<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {â€‹

formModel.<span class="hljs-property">value</span>[key] = data[key];â€‹

});â€‹

isShow.<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>;â€‹

};â€‹

â€‹

<span class="hljs-title function_">defineExpose</span>({ show }); <span class="hljs-comment">// æš´éœ²æ–¹æ³•ç»™é¡¶å±‚è°ƒç”¨â€‹</span>

&lt;/script&gt;
</code></pre>
<h2 data-id="heading-17">äº”ã€æ–¹æ¡ˆæ€»ç»“ä¸æ‰©å±•å»ºè®®â€‹</h2>
<ol>
<li>é…ç½®é©±åŠ¨å¼€å‘ï¼šé€šè¿‡ JSON é…ç½®å®ç°ç»„ä»¶çš„åŠ¨æ€æ¸²æŸ“ï¼Œæ–°å¢ä¸šåŠ¡é¡µé¢æ— éœ€ç¼–å†™ç»„ä»¶ä»£ç ï¼Œä»…éœ€é…ç½®schemaConfigï¼›â€‹</li>
</ol>

<ol start="2">
<li>åˆ†å±‚è§£è€¦ï¼šä¸‰å±‚ç»„ä»¶ç»“æ„èŒè´£æ¸…æ™°ï¼ˆé¡¶å±‚å®¹å™¨ã€ä¸­é—´å±‚æ¡†æ¶ã€åº•å±‚æ§ä»¶ï¼‰ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•ï¼›â€‹</li>
</ol>

<ol start="3">
<li>é€šä¿¡é«˜æ•ˆï¼šç»“åˆprovide/injectå’Œemitï¼Œå®ç°è·¨å±‚çº§é€šä¿¡ï¼Œé¿å…å†—ä½™çš„ props ä¼ é€’ï¼›â€‹</li>
</ol>

<ol start="4">
<li>è§„èŒƒç»Ÿä¸€ï¼šAPI äº¤äº’éµå¾ª REST è§„èŒƒï¼Œç»„ä»¶é…ç½®éµå¾ªç»Ÿä¸€æ ¼å¼ï¼Œé™ä½å›¢é˜Ÿåä½œæˆæœ¬ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript å°è£…æ— æ„Ÿ token åˆ·æ–°]]></title>    <link>https://juejin.cn/post/7579813925996052521</link>    <guid>https://juejin.cn/post/7579813925996052521</guid>    <pubDate>2025-12-04T12:42:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579813925996052521" data-draft-id="7579846685070524470" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript å°è£…æ— æ„Ÿ token åˆ·æ–°"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-04T12:42:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Jingyou"/> <meta itemprop="url" content="https://juejin.cn/user/3167069035309015"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript å°è£…æ— æ„Ÿ token åˆ·æ–°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3167069035309015/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Jingyou
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T12:42:00.000Z" title="Thu Dec 04 2025 12:42:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="github">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><code>accessToken</code>è¿‡æœŸåä½¿ç”¨<code>refreshToken</code>è°ƒç”¨<strong>åˆ·æ–° token</strong> æ¥å£å»è·å–æ–°çš„<code>accessToken</code></p>
</blockquote>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// tokenManager.js</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TokenManager</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ç”¨äºå­˜å‚¨åˆ·æ–°tokençš„promiseï¼Œé˜²æ­¢å¹¶å‘åˆ·æ–°</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">promise</span> = <span class="hljs-literal">null</span>
  }

  <span class="hljs-comment">/**
   * è®¾ç½®è®¿é—®token
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">token</span>
   */</span>
  <span class="hljs-title function_">setToken</span>(<span class="hljs-params">token</span>) {
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'accessToken'</span>, token)
  }

  <span class="hljs-comment">/**
   * è·å–åˆ·æ–°token
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string|null</span>}
   */</span>
  <span class="hljs-title function_">getRefreshToken</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'refreshToken'</span>)
  }

  <span class="hljs-comment">/**
   * ç§»é™¤æ‰€æœ‰tokenä¿¡æ¯
   */</span>
  <span class="hljs-title function_">removeToken</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">'accessToken'</span>)
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">'refreshToken'</span>)
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">'name'</span>)
  }

  <span class="hljs-comment">/**
   * è°ƒç”¨æ¥å£åˆ·æ–°token
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise&lt;Response&gt;</span>}
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">refreshAccessToken</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// è¿™é‡Œæ˜¯åˆ·æ–°tokençš„æ¥å£</span>
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/v3/Logon/getRefreshUserToker'</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
        <span class="hljs-string">'X-Refresh-Token'</span>: <span class="hljs-string">'true'</span>,
      },
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
        <span class="hljs-attr">refreshToken</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getRefreshToken</span>(),
        <span class="hljs-attr">name</span>: <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'name'</span>),
      }),
    })
    <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>()
  }

  <span class="hljs-comment">/**
   * è·å–tokenï¼Œå¦‚æœæ­£åœ¨åˆ·æ–°åˆ™è¿”å›åŒä¸€ä¸ªpromise
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise&lt;boolean&gt;</span>} åˆ·æ–°æˆåŠŸè¿”å›trueï¼Œå¤±è´¥è¿”å›false
   */</span>
  <span class="hljs-title function_">refreshToken</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">promise</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">promise</span>

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">promise</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refreshAccessToken</span>()
        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
          <span class="hljs-keyword">if</span> (res.<span class="hljs-property">code</span> === <span class="hljs-number">0</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setToken</span>(res.<span class="hljs-property">accessToken</span>)
            <span class="hljs-title function_">resolve</span>(<span class="hljs-literal">true</span>)
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeToken</span>()
            <span class="hljs-title function_">resolve</span>(<span class="hljs-literal">false</span>)
          }
        })
        .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Refresh token failed'</span>, err)
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeToken</span>()
          <span class="hljs-title function_">resolve</span>(<span class="hljs-literal">false</span>)
        })
    })

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">promise</span>.<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">promise</span> = <span class="hljs-literal">null</span>
    })
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">promise</span>
  }
}

<span class="hljs-keyword">const</span> tokener = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TokenManager</span>()

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> tokener
</code></pre>
<h2 data-id="heading-0">åœ¨å“åº”æ‹¦æˆªä¸­ä½¿ç”¨åˆ·æ–°token</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// request.js</span>
<span class="hljs-keyword">import</span> tokener <span class="hljs-keyword">from</span> <span class="hljs-string">'./tokenManager.js'</span>

<span class="hljs-comment">/**
 * è¯·æ±‚å°è£…
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} <span class="hljs-variable">url</span>
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">RequestInit</span>} <span class="hljs-variable">options</span>
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise&lt;any&gt;</span>}
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">request</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">url, options = {}</span>) =&gt; {
  <span class="hljs-comment">// åˆå¹¶é»˜è®¤é…ç½®</span>
  <span class="hljs-keyword">const</span> config = {
    ...options,
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
      ...options.<span class="hljs-property">headers</span>,
    },
  }

  <span class="hljs-comment">// æ·»åŠ token</span>
  <span class="hljs-keyword">const</span> token = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'accessToken'</span>)
  <span class="hljs-keyword">if</span> (token) {
    config.<span class="hljs-property">headers</span>[<span class="hljs-string">'Authorization'</span>] = <span class="hljs-string">`Bearer <span class="hljs-subst">${token}</span>`</span>
  }

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(url, config)

    <span class="hljs-comment">// æ‹¦æˆª 401 æœªæˆæƒï¼Œä¸”ä¸æ˜¯åˆ·æ–°tokençš„è¯·æ±‚</span>
    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">status</span> === <span class="hljs-number">401</span> &amp;&amp; !config.<span class="hljs-property">headers</span>[<span class="hljs-string">'X-Refresh-Token'</span>]) {
      <span class="hljs-comment">// å°è¯•åˆ·æ–°token</span>
      <span class="hljs-keyword">const</span> isRefreshSuccess = <span class="hljs-keyword">await</span> tokener.<span class="hljs-title function_">refreshToken</span>()

      <span class="hljs-keyword">if</span> (isRefreshSuccess) {
        <span class="hljs-comment">// åˆ·æ–°æˆåŠŸï¼Œé‡è¯•åŸè¯·æ±‚</span>
        <span class="hljs-comment">// æ›´æ–°headerä¸­çš„token</span>
        <span class="hljs-keyword">const</span> newToken = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'accessToken'</span>)
        config.<span class="hljs-property">headers</span>[<span class="hljs-string">'Authorization'</span>] = <span class="hljs-string">`Bearer <span class="hljs-subst">${newToken}</span>`</span>

        <span class="hljs-comment">// é‡æ–°å‘èµ·è¯·æ±‚</span>
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(url, config).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-title function_">json</span>())
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// åˆ·æ–°å¤±è´¥ï¼ŒæŠ›å‡ºé”™è¯¯æˆ–è·³è½¬ç™»å½•</span>
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Token refresh failed'</span>)
        <span class="hljs-comment">// window.location.href = '/login'</span>
        <span class="hljs-comment">// å¯ä»¥è®°å½•å½“å‰é¡µé¢ï¼Œé‡æ–°ç™»é™†åè·³è½¬åˆ°å½“å‰é¡µé¢</span>
        <span class="hljs-comment">// localStorage.setItem('redirectUrl', window.location.href)</span>
      }
    }

    <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>()
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Request failed:'</span>, error)
    <span class="hljs-keyword">throw</span> error
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> request
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React18ä¸­Suspenseçš„ç”¨æ³•ä»¥åŠåŸç†]]></title>    <link>https://juejin.cn/post/7579961957194203186</link>    <guid>https://juejin.cn/post/7579961957194203186</guid>    <pubDate>2025-12-04T13:30:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579961957194203186" data-draft-id="7579832417748385843" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React18ä¸­Suspenseçš„ç”¨æ³•ä»¥åŠåŸç†"/> <meta itemprop="keywords" content="React.js"/> <meta itemprop="datePublished" content="2025-12-04T13:30:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="epoos"/> <meta itemprop="url" content="https://juejin.cn/user/3474112473732024"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React18ä¸­Suspenseçš„ç”¨æ³•ä»¥åŠåŸç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3474112473732024/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    epoos
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T13:30:35.000Z" title="Thu Dec 04 2025 13:30:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä»Šå¤©ç‰¹æ„å†æ¬¡æ¸©ä¹ äº†ä¸‹ Suspense ç»„ä»¶çš„ç”¨æ³•ï¼Œç»“åˆ chatgpt æ·±åº¦å­¦ä¹ äº†ä¸€éï¼Œè¿™é‡Œå°†æ€»ç»“è®°å½•ä¸€ä¸‹ï¼Œæ¬¢è¿è®¨è®ºã€‚</p>
<h2 data-id="heading-0">1ã€Suspenseæ˜¯ä»€ä¹ˆï¼ŸåŸç†è§£æ</h2>
<p>åœ¨ React18 ä¸­ï¼Œ<code>Suspense</code> æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†å¼‚æ­¥åŠ è½½çŠ¶æ€çš„ç»„ä»¶ã€‚å®ƒçš„æ ¸å¿ƒä½œç”¨æ˜¯ï¼š</p>
<ul>
<li><strong>åœ¨ç»„ä»¶æˆ–èµ„æºæœªå‡†å¤‡å¥½æ¸²æŸ“æ—¶ï¼Œæ˜¾ç¤ºä¸€ä¸ªå ä½ UIï¼ˆfallbackï¼‰</strong> ï¼›</li>
<li><strong>å½“å¼‚æ­¥æ“ä½œå®Œæˆåï¼Œè‡ªåŠ¨æ¸²æŸ“çœŸå®å†…å®¹</strong>ã€‚</li>
</ul>
<p>React æ•è·å¼‚æ­¥çŠ¶æ€çš„æ–¹å¼ä¸ä¼ ç»Ÿæ€è·¯ä¸åŒï¼šå®ƒå¹¶ä¸æ˜¯å»è½®è¯¢çŠ¶æ€æˆ–è€…ç›‘å¬ Promiseï¼Œè€Œæ˜¯ä¾èµ–ä¸€ä¸ªçº¦å®šï¼š</p>
<blockquote>
<p>å½“ç»„ä»¶åœ¨æ¸²æŸ“é˜¶æ®µæœªå‡†å¤‡å¥½æ—¶ï¼Œå¯ä»¥<strong>åŒæ­¥æŠ›å‡ºä¸€ä¸ª Promise é”™è¯¯</strong>ï¼ŒReact æ•è·è¿™ä¸ª Promise é”™è¯¯ï¼Œç„¶åæ˜¾ç¤º Suspense çš„ fallbackã€‚Promise resolve åï¼ŒReact é‡æ–°è°ƒåº¦æ¸²æŸ“ç»„ä»¶ã€‚</p>
</blockquote>
<p>ç®€åŒ–çš„åŸç†æµç¨‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">renderWithSuspense</span>(<span class="hljs-params">component</span>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">component</span>(); <span class="hljs-comment">// æ‰§è¡Œç»„ä»¶å‡½æ•°</span>
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-keyword">if</span> (e <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Promise</span>) {
      <span class="hljs-comment">// æ•è· Promise é”™è¯¯ â†’ æŒ‚èµ·ç»„ä»¶ â†’ fallback</span>
      <span class="hljs-title function_">scheduleRetryAfterPromise</span>(e);
      <span class="hljs-keyword">return</span> fallbackUI;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">throw</span> e; <span class="hljs-comment">// çœŸæ­£é”™è¯¯</span>
    }
  }
}
</code></pre>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒSuspense å¹¶ä¸ä¼šä¸»åŠ¨è·Ÿè¸ª Promise çŠ¶æ€ï¼Œå®ƒåªå…³å¿ƒ<strong>ç»„ä»¶å‡½æ•°æ˜¯å¦æŠ›å‡ºäº†ä¸€ä¸ª Promise é”™è¯¯</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-1">2ã€Suspenseçš„ç”¨æ³•ä¸é€‚ç”¨åœºæ™¯</h2>
<h3 data-id="heading-2">2.1 ç»„ä»¶å¼‚æ­¥åŠ è½½ï¼ˆReact.lazyï¼‰</h3>
<p>Suspense æœ€è‡ªç„¶ã€æœ€åˆç†çš„ä½¿ç”¨åœºæ™¯æ˜¯<strong>æ‡’åŠ è½½ç»„ä»¶</strong>ã€‚React18 å†…ç½®äº† <code>React.lazy</code> é…åˆ Suspenseï¼Œå¯ä»¥å®ç°æŒ‰éœ€åŠ è½½ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { <span class="hljs-title class_">Suspense</span>, lazy } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title class_">LazyComponent</span> = <span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./LazyComponent'</span>));

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">LazyComponent</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
  );
}
</code></pre>
<ul>
<li><strong>fallback</strong>ï¼šå¼‚æ­¥åŠ è½½æœŸé—´æ˜¾ç¤ºçš„å ä½ UIï¼›</li>
<li>React.lazy ä¼šåœ¨æ¨¡å—åŠ è½½æœªå®Œæˆæ—¶ï¼Œ<strong>åŒæ­¥æŠ›å‡ºä¸€ä¸ª Promise é”™è¯¯</strong>ï¼ŒSuspense æ•è·åæ˜¾ç¤º fallbackï¼›</li>
<li>æ¨¡å—åŠ è½½å®Œæˆåï¼Œè‡ªåŠ¨æ¸²æŸ“ç»„ä»¶ã€‚</li>
</ul>
<h3 data-id="heading-3">2.2 åµŒå¥— Suspense</h3>
<p>Suspense æ”¯æŒåµŒå¥—ï¼Œç”¨äºæ§åˆ¶å±€éƒ¨åŠ è½½ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½åˆ—è¡¨ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
  <span class="hljs-tag">&lt;<span class="hljs-name">ListComponent</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½è¯¦æƒ…ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
    <span class="hljs-tag">&lt;<span class="hljs-name">DetailComponent</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
</code></pre>
<ul>
<li>å†…å±‚ Suspense æœ‰ç‹¬ç«‹çš„ fallbackï¼›</li>
<li>å¤–å±‚ Suspense æ— æ³•æ•è·å†…å±‚ fallback çš„çŠ¶æ€ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-4">3ã€Suspenseä½œä¸ºå¼‚æ­¥æ¥å£è¯·æ±‚çš„ç­‰å¾…æœºåˆ¶</h2>
<h3 data-id="heading-5">3.1 æ˜¯å¦åˆé€‚ï¼Ÿ</h3>
<p>æ™®é€šçš„æ¥å£è¯·æ±‚ï¼ˆ<code>fetch</code> æˆ– Axiosï¼‰<strong>ä¸èƒ½ç›´æ¥å’Œ Suspense æ­é…</strong>ï¼Œå› ä¸ºï¼š</p>
<ul>
<li>æ™®é€š Promise åœ¨ pending çŠ¶æ€ä¸‹ä¸ä¼šåŒæ­¥æŠ›å‡ºï¼›</li>
<li>React åªèƒ½æ•è·<strong>æ¸²æŸ“é˜¶æ®µåŒæ­¥æŠ›å‡ºçš„ Promise</strong>ï¼›</li>
<li>å› æ­¤ç›´æ¥å†™ fetch + useEffect æ˜¯æ— æ³•è§¦å‘ Suspense fallback çš„ã€‚</li>
</ul>
<p><strong>ç»“è®º</strong>ï¼šSuspense ç”¨ä½œå¼‚æ­¥æ¥å£ç­‰å¾…å¹¶ä¸è‡ªç„¶ï¼Œå¦‚æœä¸€å®šè¦ç”¨ï¼Œéœ€è¦æ‰‹åŠ¨å°è£…ã€‚</p>
<hr/>
<h3 data-id="heading-6">3.2 å¦‚ä½•å°è£… Promise</h3>
<p>å¯ä»¥å°è£…ä¸€ä¸ªæ”¯æŒ Suspense çš„èµ„æºå¯¹è±¡ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">function wrapPromise&lt;T&gt;(promise: Promise&lt;T&gt;) {
  let status: 'pending' | 'success' | <span class="hljs-attr">'error'</span> = <span class="hljs-string">'pending'</span><span class="hljs-comment">;</span>
  let result: T | any<span class="hljs-comment">;</span>
  const <span class="hljs-attr">suspender</span> = promise.then(
    <span class="hljs-attr">r</span> =&gt; { status = <span class="hljs-string">'success'</span><span class="hljs-comment">; result = r; },</span>
    <span class="hljs-attr">e</span> =&gt; { status = <span class="hljs-string">'error'</span><span class="hljs-comment">; result = e; }</span>
  )<span class="hljs-comment">;</span>

  return {
    read() {
      if (<span class="hljs-attr">status</span> === <span class="hljs-string">'pending'</span>) throw suspender<span class="hljs-comment">; // åŒæ­¥æŠ›å‡º Promise é”™è¯¯</span>
      if (<span class="hljs-attr">status</span> === <span class="hljs-string">'error'</span>) throw result<span class="hljs-comment">;      // åŒæ­¥æŠ›å‡ºé”™è¯¯</span>
      return result<span class="hljs-comment">;                              // è¿”å›æˆåŠŸæ•°æ®</span>
    }
  }<span class="hljs-comment">;</span>
}
</code></pre>
<h3 data-id="heading-7">3.3 ä½¿ç”¨å°è£…åçš„èµ„æº</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> userResource = <span class="hljs-title function_">wrapPromise</span>(<span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/user/1'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-title function_">json</span>()));

<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserProfile</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> user = userResource.<span class="hljs-title function_">read</span>(); <span class="hljs-comment">// è‹¥æœªå®Œæˆï¼ŒæŠ›å‡º Promise é”™è¯¯ â†’ Suspense æ•è·</span>
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½ç”¨æˆ·ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">UserProfile</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
  );
}
</code></pre>
<p>è¿è¡Œé€»è¾‘ï¼š</p>
<ol>
<li>ç»„ä»¶æ¸²æŸ“ â†’ è°ƒç”¨ <code>read()</code>ï¼›</li>
<li>æ•°æ®æœªå®Œæˆ â†’ <code>read()</code> åŒæ­¥æŠ›å‡º Promise é”™è¯¯ â†’ Suspense fallback æ˜¾ç¤º loadingï¼›</li>
<li>æ•°æ®å®Œæˆ â†’ Promise resolve â†’ React è‡ªåŠ¨é‡æ–°æ¸²æŸ“ç»„ä»¶ â†’ æ˜¾ç¤ºçœŸå®å†…å®¹ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-8">4ã€æ€»ç»“</h2>
<ol>
<li>
<p><strong>Suspense æœ¬è´¨</strong>ï¼šæ•è·æ¸²æŸ“é˜¶æ®µæŠ›å‡ºçš„ Promise é”™è¯¯ï¼Œç»Ÿä¸€å¤„ç†å¼‚æ­¥åŠ è½½ï¼›</p>
</li>
<li>
<p><strong>æœ€è‡ªç„¶çš„ä½¿ç”¨åœºæ™¯</strong>ï¼šç»„ä»¶æ‡’åŠ è½½ï¼ˆReact.lazyï¼‰ï¼›</p>
</li>
<li>
<p><strong>å¼‚æ­¥æ•°æ®åŠ è½½</strong>ï¼šä¸æ¨èç›´æ¥ç”¨ Suspenseï¼Œéœ€è¦æ‰‹åŠ¨å°è£… Promise æˆ–ä½¿ç”¨æ”¯æŒ Suspense çš„åº“ï¼ˆReact Query / SWRï¼‰ï¼›</p>
</li>
<li>
<p><strong>æ™®é€š fetch ç›´æ¥æ”¾ç»„ä»¶é‡Œæ— æ³•è§¦å‘ Suspense</strong>ï¼Œå› ä¸º Promise æ˜¯å¼‚æ­¥çš„ï¼Œä¸ä¼šåŒæ­¥æŠ›å‡ºï¼›</p>
</li>
<li>
<p><strong>ä¸€å¥è¯æ€»ç»“</strong>ï¼šSuspense çš„è®¾è®¡æ˜¯ä¸ºäº†è®©å¼‚æ­¥æ¸²æŸ“åƒåŒæ­¥æ¸²æŸ“ä¸€æ ·è‡ªç„¶ï¼Œå°†å¼‚æ­¥åŠ è½½ç»Ÿä¸€æˆâ€œthrow Promise é”™è¯¯ â†’ Suspense æ•è· â†’ fallback â†’ resolve â†’ é‡æ–°æ¸²æŸ“â€çš„æœºåˆ¶ã€‚</p>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ§  æ‰‹å†™ `instanceof`ï¼šæ·±å…¥ç†è§£åŸå‹é“¾ä¸ç»§æ‰¿æœºåˆ¶]]></title>    <link>https://juejin.cn/post/7579785426267521024</link>    <guid>https://juejin.cn/post/7579785426267521024</guid>    <pubDate>2025-12-04T14:42:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579785426267521024" data-draft-id="7579805639435583540" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ§  æ‰‹å†™ `instanceof`ï¼šæ·±å…¥ç†è§£åŸå‹é“¾ä¸ç»§æ‰¿æœºåˆ¶"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-04T14:42:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¥ç§˜çš„çŒªå¤´"/> <meta itemprop="url" content="https://juejin.cn/user/793223472877051"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ§  æ‰‹å†™ `instanceof`ï¼šæ·±å…¥ç†è§£åŸå‹é“¾ä¸ç»§æ‰¿æœºåˆ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/793223472877051/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¥ç§˜çš„çŒªå¤´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T14:42:16.000Z" title="Thu Dec 04 2025 14:42:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ç°ä»£å‰ç«¯å¼€å‘ä¸­ï¼Œå°¤å…¶æ˜¯åœ¨å¤§å‹é¡¹ç›®ã€å¤šäººåä½œçš„åœºæ™¯ä¸‹ ğŸ’¼ï¼Œå¼€å‘è€…å¸¸å¸¸ä¼šé¢å¯¹å¤æ‚çš„å¯¹è±¡ç»“æ„å’Œç»§æ‰¿å…³ç³»ã€‚å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦â€œå±äºâ€æŸä¸ªæ„é€ å‡½æ•°ï¼ŸJavaScript æä¾›äº† <code>instanceof</code> è¿ç®—ç¬¦æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>æœ¬æ–‡å°†ä» <strong>åŸå‹ä¸åŸå‹é“¾</strong> å‡ºå‘ ğŸ”„ï¼Œç»“åˆå¤šç§ç»§æ‰¿æ–¹å¼ ğŸ”—ï¼Œæ·±å…¥å‰–æ <code>instanceof</code> çš„å·¥ä½œåŸç†ï¼Œå¹¶æœ€ç»ˆæ‰‹å†™å®ç°ä¸€ä¸ªè‡ªå®šä¹‰ç‰ˆæœ¬çš„ <code>isInstanceOf</code> å‡½æ•° âœï¸ï¼Œå¸®åŠ©ä½ å½»åº•æŒæ¡è¿™ä¸€æ ¸å¿ƒæ¦‚å¿µã€‚</p>
<hr/>
<h2 data-id="heading-0">ğŸ¯ ä¸€ã€ä»€ä¹ˆæ˜¯ <code>instanceof</code>ï¼Ÿ</h2>
<p><code>instanceof</code> æ˜¯ JavaScript ä¸­çš„ä¸€ä¸ª<strong>äºŒå…ƒè¿ç®—ç¬¦</strong>ï¼Œç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„ <code>prototype</code> æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚</p>
<p>ğŸ“ <strong>è¯­æ³•</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js">A <span class="hljs-keyword">instanceof</span> B
</code></pre>
<p>âœ… <strong>è¿”å›å€¼ä¸ºå¸ƒå°”å€¼</strong>ï¼š</p>
<ul>
<li><code>true</code>ï¼šè¡¨ç¤º A æ˜¯ç”± B æ„é€ å‡ºæ¥çš„ï¼ˆæˆ–åœ¨å…¶åŸå‹é“¾ä¸Šæœ‰ B.prototypeï¼‰</li>
<li><code>false</code>ï¼šå¦åˆ™</li>
</ul>
<h3 data-id="heading-1">ğŸ“Œ ç¤ºä¾‹ï¼š</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> arr = [];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>);   <span class="hljs-comment">// true âœ…</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span>);  <span class="hljs-comment">// true âœ…</span>
</code></pre>
<blockquote>
<p>â“ ä¸ºä»€ä¹ˆ <code>arr instanceof Object</code> ä¹Ÿæ˜¯ <code>true</code>ï¼Ÿè¿™å°±å¼•å‡ºäº†æˆ‘ä»¬æ¥ä¸‹æ¥è¦è®²çš„æ ¸å¿ƒâ€”â€”<strong>åŸå‹é“¾</strong>ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-2">ğŸ”— äºŒã€åŸå‹ä¸åŸå‹é“¾ï¼ˆPrototype &amp; Prototype Chainï¼‰</h2>
<p>æ¯ä¸ª JavaScript å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨å±æ€§ <code>[[Prototype]]</code>ï¼Œå¯ä»¥é€šè¿‡ <code>__proto__</code> è®¿é—®ï¼ˆä¸æ¨èç›´æ¥ä½¿ç”¨ï¼‰æˆ–è€…é€šè¿‡ <code>Object.getPrototypeOf()</code> è·å–ã€‚</p>
<p>ğŸ” å½“è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œå¦‚æœè¯¥å¯¹è±¡æœ¬èº«æ²¡æœ‰è¿™ä¸ªå±æ€§ï¼ŒJS å¼•æ“å°±ä¼šæ²¿ç€ <code>[[Prototype]]</code> å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°è¯¥å±æ€§æˆ–åˆ°è¾¾åŸå‹é“¾é¡¶ç«¯ï¼ˆå³ <code>null</code>ï¼‰ã€‚è¿™å°±æ˜¯æ‰€è°“çš„<strong>åŸå‹é“¾æœºåˆ¶</strong>ã€‚</p>
<h3 data-id="heading-3">ğŸ§ª åŸå‹é“¾ç¤ºä¾‹åˆ†æ</h3>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">const</span> arr = []; <span class="hljs-comment">// ç›¸å½“äº new Array()</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
    arr.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>,           <span class="hljs-comment">// true âœ…</span>
    arr.<span class="hljs-property">__proto__</span>.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Array</span>,         <span class="hljs-comment">// true âœ…</span>
    arr.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Array</span>                    <span class="hljs-comment">// true âœ…</span>
);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
    arr.<span class="hljs-property">__proto__</span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>, <span class="hljs-comment">// true âœ…</span>
    arr.<span class="hljs-property">__proto__</span>.<span class="hljs-property">__proto__</span>.<span class="hljs-property">__proto__</span> === <span class="hljs-literal">null</span>     <span class="hljs-comment">// true âœ…</span>
);
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥ç”»å‡ºåŸå‹é“¾å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">arr 
â†’ arr.<span class="hljs-strong">__proto__</span> (Array.prototype) 
â†’ arr.<span class="hljs-strong">__proto__</span>.<span class="hljs-strong">__proto__</span> (Object.prototype)
â†’ arr.<span class="hljs-strong">__proto__</span>.<span class="hljs-strong">__proto__</span>.<span class="hljs-strong">__proto__</span> (null)
</code></pre>
<p>æ‰€ä»¥ <code>arr instanceof Object</code> è¿”å› <code>true</code>ï¼Œå› ä¸º <code>Object.prototype</code> åœ¨ <code>arr</code> çš„åŸå‹é“¾ä¸Šã€‚</p>
<p>ğŸ’¡ <strong>å°è´´å£«</strong>ï¼šæ‰€æœ‰å¯¹è±¡æœ€ç»ˆéƒ½ç»§æ‰¿è‡ª <code>Object</code>ï¼Œå› æ­¤ç»å¤§å¤šæ•°å¯¹è±¡éƒ½æ˜¯ <code>Object</code> çš„â€œå®ä¾‹â€ã€‚</p>
<hr/>
<h2 data-id="heading-4">ğŸ§¬ ä¸‰ã€é¢å‘å¯¹è±¡ä¸­çš„â€œè¡€ç¼˜â€å…³ç³»</h2>
<p>åœ¨ä¼ ç»Ÿ OOP è¯­è¨€å¦‚ Java/C++ ä¸­ï¼Œæˆ‘ä»¬ç”¨ <code>is-a</code> å…³ç³»æè¿°ç»§æ‰¿ï¼Œä¾‹å¦‚ â€œDog is an Animalâ€ ğŸ¶ã€‚</p>
<p>JavaScript è™½ç„¶æ˜¯åŸºäºåŸå‹çš„è¯­è¨€ï¼Œä½† <code>instanceof</code> å®ç°äº†ç±»ä¼¼çš„è¯­ä¹‰åˆ¤æ–­åŠŸèƒ½ã€‚å®ƒä¸æ˜¯çœ‹å¯¹è±¡æœ‰æ²¡æœ‰æŸäº›æ–¹æ³•æˆ–å±æ€§ï¼Œè€Œæ˜¯çœ‹<strong>æ˜¯å¦æœ‰è¡€ç¼˜å…³ç³»</strong>â€”â€”ä¹Ÿå°±æ˜¯åŸå‹é“¾ä¸Šçš„è¿æ¥ã€‚</p>
<blockquote>
<p>âœ… <code>A instanceof B</code> çš„æœ¬è´¨æ˜¯ï¼š<br/>
<strong>B çš„ prototype æ˜¯å¦å­˜åœ¨äº A çš„åŸå‹é“¾ä¹‹ä¸­ï¼Ÿ</strong></p>
</blockquote>
<p>ğŸ§  æ¢å¥è¯è¯´ï¼š<strong>ä½ æ˜¯ä¸æ˜¯æˆ‘ç¥–å®—ï¼Ÿ</strong></p>
<hr/>
<h2 data-id="heading-5">âœï¸ å››ã€å®ç°è‡ªå·±çš„ <code>isInstanceOf</code></h2>
<p>ç°åœ¨æˆ‘ä»¬æ¥æ‰‹åŠ¨å®ç°ä¸€ä¸ªç­‰ä»·äºåŸç”Ÿ <code>instanceof</code> çš„å‡½æ•°ã€‚</p>
<h3 data-id="heading-6">ğŸ” æ€è·¯åˆ†æï¼š</h3>
<ol>
<li>ä»å®ä¾‹å¯¹è±¡ A å¼€å§‹ï¼Œè·å–å…¶ <code>__proto__</code></li>
<li>å¾ªç¯éå†åŸå‹é“¾ï¼Œé€å±‚æ¯”å¯¹å½“å‰åŸå‹æ˜¯å¦ç­‰äº <code>B.prototype</code></li>
<li>å¦‚æœæ‰¾åˆ°åˆ™è¿”å› <code>true</code> âœ…</li>
<li>å¦‚æœèµ°åˆ° <code>null</code> è¿˜æ²¡æ‰¾åˆ°ï¼Œåˆ™è¿”å› <code>false</code> âŒ</li>
</ol>
<h3 data-id="heading-7">ğŸ’» å®ç°ä»£ç ï¼š</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">isInstanceOf</span>(<span class="hljs-params">A, B</span>) {
    <span class="hljs-comment">// ç¡®ä¿ A æ˜¯å¯¹è±¡ä¸” B æ˜¯å‡½æ•°</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> A !== <span class="hljs-string">'object'</span> || A === <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> B !== <span class="hljs-string">'function'</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">let</span> proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(A); <span class="hljs-comment">// æ¨èä½¿ç”¨ getPrototypeOf è€Œé __proto__</span>

    <span class="hljs-keyword">while</span> (proto) {
        <span class="hljs-keyword">if</span> (proto === B.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        proto = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(proto);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<h3 data-id="heading-8">âœ… æµ‹è¯•éªŒè¯ï¼š</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Dog</span>(<span class="hljs-params"/>) {}

<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();
<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">isInstanceOf</span>(dog, <span class="hljs-title class_">Dog</span>));     <span class="hljs-comment">// true âœ…</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">isInstanceOf</span>(dog, <span class="hljs-title class_">Animal</span>));  <span class="hljs-comment">// true âœ…</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">isInstanceOf</span>(dog, <span class="hljs-title class_">Object</span>));  <span class="hljs-comment">// true âœ…</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">isInstanceOf</span>(dog, <span class="hljs-title class_">Cat</span>));     <span class="hljs-comment">// false âŒ</span>
</code></pre>
<p>ğŸ‰ å®Œå…¨ç¬¦åˆé¢„æœŸï¼</p>
<blockquote>
<p>ğŸ’¡ <strong>å»ºè®®</strong>ï¼šè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ <code>Object.getPrototypeOf()</code> æ›¿ä»£ <code>__proto__</code>ï¼Œå› ä¸ºåè€…å·²è¢«è§†ä¸ºè¿‡æ—¶ï¼ˆå°½ç®¡ä»å¹¿æ³›æ”¯æŒï¼‰ï¼Œæ›´æ¨èæ ‡å‡† APIã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-9">ğŸ—ï¸ äº”ã€JavaScript ä¸­å¸¸è§çš„ç»§æ‰¿æ–¹å¼å›é¡¾</h2>
<p>ä¸ºäº†æ›´å¥½åœ°ç†è§£ <code>instanceof</code> çš„åº”ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ JS ä¸­å‡ ç§å…¸å‹çš„ç»§æ‰¿æ–¹å¼ã€‚</p>
<h3 data-id="heading-10">1ï¸âƒ£ æ„é€ å‡½æ•°ç»‘å®šç»§æ‰¿ï¼ˆå€Ÿç”¨æ„é€ å‡½æ•°ï¼‰ğŸ”§</h3>
<p>åˆ©ç”¨ <code>call</code> æˆ– <code>apply</code> åœ¨å­ç±»ä¸­è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œå®ç°å±æ€§ç»§æ‰¿ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">species</span> = <span class="hljs-string">"åŠ¨ç‰©"</span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, color</span>) {
    <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// ç»§æ‰¿å±æ€§</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}

<span class="hljs-keyword">const</span> cat = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'å°é»‘'</span>, <span class="hljs-string">'é»‘è‰²'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat.<span class="hljs-property">species</span>); <span class="hljs-comment">// "åŠ¨ç‰©" âœ…</span>
</code></pre>













<table><thead><tr><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>âœ… å¯ä¼ é€’å‚æ•°ï¼Œé¿å…å¼•ç”¨å…±äº«</td><td>âŒ æ— æ³•ç»§æ‰¿çˆ¶ç±»åŸå‹ä¸Šçš„æ–¹æ³•</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-11">2ï¸âƒ£ åŸå‹æ¨¡å¼ç»§æ‰¿ï¼ˆç»å…¸åŸå‹é“¾ï¼‰ğŸ”</h3>
<p>å°†çˆ¶ç±»å®ä¾‹ä½œä¸ºå­ç±»åŸå‹ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">species</span> = <span class="hljs-string">"åŠ¨ç‰©"</span>; <span class="hljs-comment">// æ¯æ¬¡éƒ½ä¼šé‡å¤åˆ›å»º</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, color</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}

<span class="hljs-comment">// ç»§æ‰¿ï¼šCat.prototype æŒ‡å‘ Animal å®ä¾‹</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Cat</span>; <span class="hljs-comment">// ä¿®æ­£ constructor æŒ‡å‘</span>

<span class="hljs-keyword">const</span> cat = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'å°é»‘'</span>, <span class="hljs-string">'é»‘è‰²'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat.<span class="hljs-property">species</span>); <span class="hljs-comment">// "åŠ¨ç‰©" âœ…</span>
</code></pre>













<table><thead><tr><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td>âœ… å¯ä»¥ç»§æ‰¿çˆ¶ç±»åŸå‹æ–¹æ³•</td><td>âš ï¸ çˆ¶ç±»æ„é€ å‡½æ•°è¢«å¤šæ¬¡æ‰§è¡Œï¼›å¼•ç”¨ç±»å‹å¯èƒ½é€ æˆå…±äº«é—®é¢˜</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-12">3ï¸âƒ£ åˆ©ç”¨ç©ºå¯¹è±¡ä½œä¸ºä¸­ä»‹ï¼ˆåœ£æ¯æ¨¡å¼ / å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿ï¼‰ğŸ›¡ï¸</h3>
<p>è§£å†³ä¸Šè¿°ä¸¤ç§æ–¹å¼çš„é—®é¢˜ï¼Œ<strong>æ¨èåšæ³•</strong> âœ…ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">inherit</span>(<span class="hljs-params">Child, Parent</span>) {
    <span class="hljs-keyword">const</span> F = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {};        <span class="hljs-comment">// åˆ›å»ºç©ºå‡½æ•°</span>
    F.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>; <span class="hljs-comment">// ç©ºå‡½æ•°åŸå‹æŒ‡å‘çˆ¶ç±»åŸå‹</span>
    <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">F</span>();      <span class="hljs-comment">// å­ç±»åŸå‹ä¸ºä¸­ä»‹å®ä¾‹</span>
    <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Child</span>;
}
</code></pre>
<p>è¿™æ ·æ—¢ä¸ä¼šæ‰§è¡Œçˆ¶ç±»æ„é€ å‡½æ•°ï¼Œåˆèƒ½æ­£ç¡®å»ºç«‹åŸå‹é“¾ï¼Œæ˜¯ç›®å‰æœ€å®‰å…¨é«˜æ•ˆçš„ç»§æ‰¿æ–¹å¼ã€‚</p>
<hr/>
<h3 data-id="heading-13">4ï¸âƒ£ ç›´æ¥ç»§æ‰¿ prototypeï¼ˆâŒ ä¸æ¨èï¼‰</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Cat</span>;
</code></pre>
<p>âš ï¸ <strong>å±é™©ï¼</strong> è¿™æ ·åšä¼šè®© <code>Cat.prototype</code> å’Œ <code>Animal.prototype</code> æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚ä¿®æ”¹ <code>Cat.prototype</code> ä¼šå½±å“ <code>Animal</code>ï¼Œé€ æˆå‰¯ä½œç”¨ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">eat</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åƒ'</span>); }
<span class="hljs-comment">// æ­¤æ—¶ Animal.prototype ä¹Ÿæœ‰äº† eat æ–¹æ³•ï¼ğŸš¨</span>
</code></pre>
<p>ğŸš« <strong>ç»“è®º</strong>ï¼šä¸è¦è¿™æ ·åšï¼å®¹æ˜“å¼•å‘å…¨å±€æ±¡æŸ“ã€‚</p>
<hr/>
<h2 data-id="heading-14">ğŸ¢ å…­ã€ä¸ºä»€ä¹ˆ <code>instanceof</code> åœ¨å¤§å‹é¡¹ç›®ä¸­æœ‰å¿…è¦ï¼ŸğŸš€</h2>
<p>åœ¨å¤šäººåä½œçš„å¤æ‚ç³»ç»Ÿä¸­ ğŸ‘¥ï¼Œå¸¸ä¼šå‡ºç°ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>â“ ä¸æ¸…æ¥šæŸä¸ªå˜é‡åˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹çš„å¯¹è±¡</li>
<li>ğŸ“¦ ç¬¬ä¸‰æ–¹åº“è¿”å›çš„å¯¹è±¡ç»“æ„ä¸é€æ˜</li>
<li>ğŸ§© ç±»å‹åˆ¤æ–­ä¾èµ–å­—ç¬¦ä¸²æ¯”è¾ƒï¼ˆå¦‚ <code>toString()</code>ï¼‰å®¹æ˜“å‡ºé”™</li>
</ul>
<p>æ­¤æ—¶ <code>instanceof</code> å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">if</span> (data <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Request</span>) {
    <span class="hljs-comment">// å‘èµ·ç½‘ç»œè¯·æ±‚ ğŸŒ</span>
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Response</span>) {
    <span class="hljs-comment">// å¤„ç†å“åº” ğŸ“¥</span>
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Error</span>) {
    <span class="hljs-comment">// é”™è¯¯å¤„ç† âš ï¸</span>
}
</code></pre>
<p>å®ƒæä¾›äº†ä¸€ç§<strong>å®‰å…¨ã€å¯é ã€è¯­ä¹‰æ¸…æ™°</strong>çš„æ–¹å¼æ¥åˆ¤æ–­å¯¹è±¡ç±»å‹ï¼Œå°¤å…¶é€‚ç”¨äºæ’ä»¶ç³»ç»Ÿã€è¡¨å•æ ¡éªŒã€äº‹ä»¶å¤„ç†å™¨ç­‰åœºæ™¯ã€‚</p>
<hr/>
<h2 data-id="heading-15">âš ï¸ ä¸ƒã€è¾¹ç•Œæƒ…å†µä¸æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-16">1. åŸºæœ¬ç±»å‹ä¸èƒ½ä½¿ç”¨ <code>instanceof</code></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-string">"hello"</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">String</span> <span class="hljs-comment">// false âŒ</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-string">"hello"</span>) <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">String</span> <span class="hljs-comment">// true âœ…</span>
</code></pre>
<p>ğŸ“Œ å› ä¸ºåŸºæœ¬ç±»å‹æ²¡æœ‰åŸå‹é“¾ï¼ˆé™¤äº†åŒ…è£…å¯¹è±¡ï¼‰ï¼Œæ‰€ä»¥ç»“æœä¸º <code>false</code>ã€‚</p>
<hr/>
<h3 data-id="heading-17">2. è·¨çª—å£/iframe é—®é¢˜ ğŸ–¼ï¸</h3>
<p>ä¸åŒå…¨å±€ç¯å¢ƒä¸‹çš„å¯¹è±¡ä¼šæœ‰ä¸åŒçš„æ„é€ å™¨ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> iframe = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'iframe'</span>);
<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(iframe);
<span class="hljs-keyword">const</span> <span class="hljs-title class_">IframeArray</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">frames</span>[<span class="hljs-number">0</span>].<span class="hljs-property">Array</span>;
<span class="hljs-keyword">const</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IframeArray</span>();

arr <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>;        <span class="hljs-comment">// false âŒ!</span>
arr <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">IframeArray</span>;  <span class="hljs-comment">// true âœ…</span>
</code></pre>
<p>ğŸš¨ æ­¤æ—¶ <code>instanceof</code> ä¼šå¤±æ•ˆï¼Œåº”æ”¹ç”¨ <code>Array.isArray()</code> ç­‰æ–¹æ³•ã€‚</p>
<hr/>
<h3 data-id="heading-18">3. è‡ªå®šä¹‰è¡Œä¸ºï¼š<code>Symbol.hasInstance</code> ğŸ›ï¸</h3>
<p>ä½ å¯ä»¥é‡å†™ <code>instanceof</code> çš„åˆ¤æ–­é€»è¾‘ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyArray</span> {
    <span class="hljs-keyword">static</span> [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">hasInstance</span>](obj) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(obj);
    }
}

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>] <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">MyArray</span>); <span class="hljs-comment">// true âœ…</span>
</code></pre>
<p>è¿™è¯´æ˜ <code>instanceof</code> çš„è¡Œä¸ºæ˜¯å¯ä»¥è¢«å®šåˆ¶çš„ â€”â€” æ›´åŠ çµæ´»ä½†ä¹Ÿéœ€è°¨æ…ä½¿ç”¨ã€‚</p>
<hr/>
<h2 data-id="heading-19">ğŸ“Š å…«ã€æ€»ç»“å¯¹æ¯”</h2>





























<table><thead><tr><th>å†…å®¹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>instanceof</code> æœ¬è´¨</td><td>ğŸ” æ£€æŸ¥æ„é€ å‡½æ•°çš„ <code>prototype</code> æ˜¯å¦åœ¨å®ä¾‹çš„åŸå‹é“¾ä¸Š</td></tr><tr><td>æ ¸å¿ƒæœºåˆ¶</td><td>ğŸ”— åŸå‹é“¾æŸ¥æ‰¾</td></tr><tr><td>æ‰‹å†™å…³é”®ç‚¹</td><td>ğŸ” éå† <code>__proto__</code> é“¾ï¼Œå¯¹æ¯” <code>B.prototype</code></td></tr><tr><td>åº”ç”¨åœºæ™¯</td><td>ğŸ—ï¸ ç±»å‹åˆ¤æ–­ã€ç»§æ‰¿ä½“ç³»è°ƒè¯•ã€æ¡†æ¶è®¾è®¡</td></tr><tr><td>æ›¿ä»£æ–¹æ¡ˆ</td><td>ğŸ§° <code>Array.isArray()</code>ã€<code>Object.prototype.toString.call()</code> æ›´é€šç”¨</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-20">ğŸ§© ä¹ã€æ‹“å±•ç»ƒä¹  ğŸ’ª</h2>
<p>å°è¯•å®Œæˆä»¥ä¸‹ä»»åŠ¡åŠ æ·±ç†è§£ï¼š</p>
<ol>
<li>ä½¿ç”¨ <code>Object.create(null)</code> åˆ›å»ºä¸€ä¸ªæ— åŸå‹çš„å¯¹è±¡ï¼Œæµ‹è¯• <code>isInstanceOf</code> è¡Œä¸ºã€‚</li>
<li>æ”¹è¿›ä½ çš„ <code>isInstanceOf</code> å‡½æ•°ï¼Œä½¿å…¶æ”¯æŒ <code>Symbol.hasInstance</code>ã€‚</li>
<li>å®ç°ä¸€ä¸ªé€šç”¨ç±»å‹åˆ¤æ–­å·¥å…·å‡½æ•° <code>typeOf(value)</code>ï¼Œèƒ½å‡†ç¡®è¯†åˆ«æ•°ç»„ã€æ—¥æœŸã€æ­£åˆ™ç­‰ã€‚</li>
</ol>
<p>ğŸ¯ <strong>ç›®æ ‡</strong>ï¼šè®©ä½ å†™å‡ºçš„ä»£ç ä¸ä»…â€œèƒ½è·‘â€ï¼Œè¿˜èƒ½â€œæ‰›å¾—ä½â€ã€‚</p>
<hr/>
<h2 data-id="heading-21">ğŸ‰ ç»“è¯­</h2>
<p><code>instanceof</code> ä¸åªæ˜¯ä¸€ä¸ªç®€å•çš„æ“ä½œç¬¦ï¼Œå®ƒæ˜¯ç†è§£ JavaScript åŸå‹ç»§æ‰¿ä½“ç³»çš„ä¸€æŠŠé’¥åŒ™ ğŸ”‘ã€‚é€šè¿‡æ‰‹å†™å…¶å®ç°ï¼Œæˆ‘ä»¬ä¸ä»…æŒæ¡äº†åº•å±‚åŸç†ï¼Œä¹Ÿä¸ºæ—¥åé˜…è¯»æºç ã€è®¾è®¡æ¶æ„æ‰“ä¸‹äº†åšå®åŸºç¡€ã€‚</p>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œè¯·åˆç†ä½¿ç”¨ <code>instanceof</code>ï¼Œå¹¶æ³¨æ„å…¶å±€é™æ€§ã€‚ç»“åˆ <code>typeof</code>ã€<code>Array.isArray()</code>ã€<code>Object.prototype.toString()</code> ç­‰æ–¹æ³•ï¼Œæ‰èƒ½æ„å»ºå‡ºå¥å£®çš„ç±»å‹åˆ¤æ–­ç³»ç»Ÿ âœ…ã€‚</p>
<blockquote>
<p>ğŸŒŸ <strong>è®°ä½ä¸€å¥è¯</strong>ï¼š<br/>
â€œä¸€åˆ‡å¯¹è±¡çš†æºäºåŸå‹ ğŸŒ€ï¼Œä¸€åˆ‡åˆ¤æ–­ç»ˆå½’äºé“¾ ğŸ”—ã€‚â€</p>
</blockquote>
<hr/>
<p>ğŸ“Œ <strong>å‚è€ƒèµ„æ–™</strong>ï¼š</p>
<ul>
<li>ğŸ“˜ MDN: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FJavaScript%2FReference%2FOperators%2Finstanceof" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/instanceof" ref="nofollow noopener noreferrer"><code>instanceof</code></a></li>
<li>ğŸ“š ã€ŠJavaScripté«˜çº§ç¨‹åºè®¾è®¡ã€‹ç¬¬6ç« </li>
<li>ğŸ“– ã€Šä½ ä¸çŸ¥é“çš„JavaScriptï¼ˆä¸Šå·ï¼‰ã€‹ç¬¬äºŒéƒ¨åˆ†</li>
</ul>
<p>âœ¨ <strong>ç¥ä½ åœ¨å‰ç«¯ä¸–ç•Œçš„æ¢ç´¢ä¹‹æ—…ä¸­ï¼Œè¶Šèµ°è¶Šè¿œï¼Œè¶Šå­¦è¶Šæ˜ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ReactçŠ¶æ€æ›´æ–°ï¼šuseStateä¸useReducerçš„åŒºåˆ«]]></title>    <link>https://juejin.cn/post/7579961957194334258</link>    <guid>https://juejin.cn/post/7579961957194334258</guid>    <pubDate>2025-12-04T14:51:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579961957194334258" data-draft-id="7579871631095889946" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ReactçŠ¶æ€æ›´æ–°ï¼šuseStateä¸useReducerçš„åŒºåˆ«"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-04T14:51:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸‡ä¸‡0421"/> <meta itemprop="url" content="https://juejin.cn/user/165389331333929"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ReactçŠ¶æ€æ›´æ–°ï¼šuseStateä¸useReducerçš„åŒºåˆ«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/165389331333929/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸‡ä¸‡0421
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T14:51:17.000Z" title="Thu Dec 04 2025 14:51:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">1. é—®é¢˜ä¸æœ€ç»ˆè§£å†³åŠæ³•</h3>
<p><strong>é—®é¢˜ï¼š</strong> æ¨¡æ‹Ÿæ¨¡å‹ä»»åŠ¡è¿è¡Œè¿›ç¨‹çš„çŠ¶æ€å˜åŒ–ï¼ŒåŒ…æ‹¬"Check data format", "Data preprocessing", "Model core computing", "Output result generation in progress","Model execution finished!"äº”ä¸ªçŠ¶æ€ï¼ŒuseStateèƒ½å¤ŸæˆåŠŸè®¾ç½®"Check data format"çŠ¶æ€ï¼Œä½†æ˜¯ModelExecuteProcessä¸­æ¥æ”¶åˆ°çš„åˆå§‹çŠ¶æ€æ˜¯"Model core computing"ï¼Œæ°¸è¿œéƒ½æ¯”steps[i]çŠ¶æ€æ™šä¸€æ­¥ï¼Œå°è¯•äº†å¾ˆå¤šæ–¹æ³•æœªæœï¼Œæœ€ç»ˆæ›¿æ¢äº†useReduceråæˆåŠŸå®ç°çŠ¶æ€åŒæ­¥æ›´æ–°ã€‚</p>
<p><strong>é”™è¯¯ç»“æœï¼š</strong></p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b85bfa0ca06e4f32b525787a660565f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5LiHMDQyMQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765464676&amp;x-signature=%2Feqwv6dfmkG%2FR4n5IWsRj6KF9fo%3D" alt="image-20251204223503827.png" loading="lazy"/></p>
<p>steps[0]: Check data format</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-attr">status</span>: [<span class="hljs-string">'Check data format'</span>]
steps[<span class="hljs-number">1</span>]: <span class="hljs-title class_">Data</span> preprocessing
<span class="hljs-attr">status</span>: [<span class="hljs-string">'Check data format'</span>, <span class="hljs-string">'Data preprocessing'</span>]
steps[<span class="hljs-number">2</span>]: <span class="hljs-title class_">Model</span> core computing
<span class="hljs-attr">status</span>: [<span class="hljs-string">'Check data format'</span>, <span class="hljs-string">'Data preprocessing'</span>, <span class="hljs-string">'Model core computing'</span>]
steps[<span class="hljs-number">3</span>]: <span class="hljs-title class_">Output</span> result generation <span class="hljs-keyword">in</span> progress
<span class="hljs-attr">status</span>: [<span class="hljs-string">'Check data format'</span>, <span class="hljs-string">'Data preprocessing'</span>, <span class="hljs-string">'Model core computing'</span>, <span class="hljs-string">'Output result generation in progress'</span>]
<span class="hljs-attr">status</span>: [<span class="hljs-string">'Check data format'</span>, <span class="hljs-string">'Data preprocessing'</span>, <span class="hljs-string">'Model core computing'</span>, <span class="hljs-string">'Output result generation in progress'</span>, <span class="hljs-string">'Model execution finished!'</span>]
</code></pre>
<p><strong>æˆåŠŸç»“æœï¼š</strong></p>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/66b097391f8847e4926ddc1d188af15b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiH5LiHMDQyMQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765464676&amp;x-signature=lGHHAHN%2BgSqNW6T2%2BgXEOFZkfOw%3D" alt="image-20251204222959366.png" loading="lazy"/></p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">steps</span><span class="hljs-selector-attr">[0]</span>: <span class="hljs-selector-tag">Check</span> <span class="hljs-selector-tag">data</span> <span class="hljs-selector-tag">format</span>
<span class="hljs-selector-tag">status</span>: <span class="hljs-selector-attr">[<span class="hljs-string">'Data preprocessing'</span>]</span>
<span class="hljs-selector-tag">steps</span><span class="hljs-selector-attr">[1]</span>: <span class="hljs-selector-tag">Data</span> <span class="hljs-selector-tag">preprocessing</span>
<span class="hljs-selector-tag">status</span>: <span class="hljs-selector-attr">[ <span class="hljs-string">'Data preprocessing'</span>, <span class="hljs-string">'Model core computing'</span>]</span>
<span class="hljs-selector-tag">steps</span><span class="hljs-selector-attr">[2]</span>: <span class="hljs-selector-tag">Model</span> <span class="hljs-selector-tag">core</span> <span class="hljs-selector-tag">computing</span>
<span class="hljs-selector-tag">status</span>: <span class="hljs-selector-attr">[<span class="hljs-string">'Data preprocessing'</span>, <span class="hljs-string">'Model core computing'</span>, <span class="hljs-string">'Output result generation in progress'</span>]</span>
<span class="hljs-selector-tag">steps</span><span class="hljs-selector-attr">[3]</span>: <span class="hljs-selector-tag">Output</span> <span class="hljs-selector-tag">result</span> <span class="hljs-selector-tag">generation</span> <span class="hljs-selector-tag">in</span> <span class="hljs-selector-tag">progress</span>
<span class="hljs-selector-tag">status</span>: <span class="hljs-selector-attr">[<span class="hljs-string">'Check data format'</span>, <span class="hljs-string">'Data preprocessing'</span>, <span class="hljs-string">'Model core computing'</span>, <span class="hljs-string">'Output result generation in progress'</span>]</span>
<span class="hljs-selector-tag">status</span>: <span class="hljs-selector-attr">[<span class="hljs-string">'Check data format'</span>, <span class="hljs-string">'Data preprocessing'</span>, <span class="hljs-string">'Model core computing'</span>, <span class="hljs-string">'Output result generation in progress'</span>, <span class="hljs-string">'Model execution finished!'</span>]</span>
</code></pre>
<p><strong>éƒ¨åˆ†ä»£ç ï¼š</strong></p>
<ul>
<li><strong>Decision.tsx</strong></li>
</ul>

<pre><code class="hljs language-ini" lang="ini">{/*  useState  */}
// const <span class="hljs-attr">handleRun</span> = () =&gt; {
  //   setRunStatus(<span class="hljs-section">[]</span>)<span class="hljs-comment">;</span>
  //   setIsRunning(true)<span class="hljs-comment">;</span>
  //   // Simulate model execution process update...
  //   const <span class="hljs-attr">steps</span> = [<span class="hljs-string">"Check data format"</span>, <span class="hljs-string">"Data preprocessing"</span>, <span class="hljs-string">"Model core computing"</span>, <span class="hljs-string">"Output result generation in progress"</span>]<span class="hljs-comment">;</span>
  //   let <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
    
  //   const <span class="hljs-attr">executeStep</span> = () =&gt; {
  //     if (i &lt; steps.length) {
  //       console.log("i:", i)<span class="hljs-comment">;</span>
  //       console.log("steps<span class="hljs-section">[i]</span>:", steps<span class="hljs-section">[i]</span>)<span class="hljs-comment">;</span>
  //       setRunStatus(<span class="hljs-attr">prev</span> =&gt; {
  //         if (steps<span class="hljs-section">[i]</span>) {
  //           return <span class="hljs-section">[...prev, steps[i]]</span>
  //         }
  //         return prev<span class="hljs-comment">;</span>
  //       })<span class="hljs-comment">;</span>

  //       i++<span class="hljs-comment">;</span>
  //       setTimeout(executeStep, 1000)<span class="hljs-comment">;</span>
  //     } else {
  //       console.log("Process finished logic triggered.")<span class="hljs-comment">;</span>
  //       setRunStatus(<span class="hljs-attr">prev</span> =&gt; {
  //         if (prev<span class="hljs-section">[prev.length - 1]</span> !== "Model execution finished!") {
  //           return <span class="hljs-section">[...prev, "Model execution finished!"]</span>
  //         } return prev<span class="hljs-comment">;</span>
  //       })<span class="hljs-comment">;</span>
  //     }
  //   }
  //   setTimeout(executeStep, 100)<span class="hljs-comment">;</span>
  // }

{/*  useReducer  */}
type <span class="hljs-attr">Action</span> = { type: <span class="hljs-string">'ADD_STEP'</span>, payload: string } | { type: <span class="hljs-string">'RESET'</span> }<span class="hljs-comment">;</span>
function runStatusReducer(state: String<span class="hljs-section">[]</span>, action: Action): String<span class="hljs-section">[]</span> {
  switch (action.type) {
    case 'ADD_STEP':
      return <span class="hljs-section">[...state, action.payload]</span><span class="hljs-comment">;</span>
    case 'RESET':
      return <span class="hljs-section">[]</span><span class="hljs-comment">;</span>
    default:
      return state<span class="hljs-comment">;</span>
  }
}

const <span class="hljs-attr">handleRun</span> = () =&gt; {
    setIsRunning(true)<span class="hljs-comment">;</span>
    dispatch({ type: 'RESET' })<span class="hljs-comment">;</span>

    const <span class="hljs-attr">steps</span> = [<span class="hljs-string">"Check data format"</span>, <span class="hljs-string">"Data preprocessing"</span>, <span class="hljs-string">"Model core computing"</span>, <span class="hljs-string">"Output result generation in progress"</span>]<span class="hljs-comment">;</span>
    let <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>

    const <span class="hljs-attr">executeStep</span> = () =&gt; {
      if (i &lt; steps.length) {
        console.log("i:", i)<span class="hljs-comment">;</span>
        console.log("steps<span class="hljs-section">[i]</span>:", steps<span class="hljs-section">[i]</span>)<span class="hljs-comment">;</span>

        dispatch({ type: 'ADD_STEP', payload: steps<span class="hljs-section">[i]</span> })<span class="hljs-comment">;</span>

        i++<span class="hljs-comment">;</span>
        setTimeout(executeStep, 1000)<span class="hljs-comment">;</span>
      } else {
        dispatch({ type: 'ADD_STEP', payload: "Model execution finished!" })<span class="hljs-comment">;</span>
      }
    }
    executeStep()<span class="hljs-comment">;</span>
  }
</code></pre>
<ul>
<li><strong>ModelExecuteProcess.tsx</strong></li>
</ul>

<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">CheckCircle</span>, <span class="hljs-title class_">Loader</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"lucide-react"</span>;
<span class="hljs-keyword">import</span> { motion } <span class="hljs-keyword">from</span> <span class="hljs-string">"framer-motion"</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ModelExecuteProcessProps</span> {
    <span class="hljs-attr">status</span>: <span class="hljs-title class_">String</span>[];
}

<span class="hljs-keyword">const</span> <span class="hljs-title class_">ModelExecuteProcess</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&lt;<span class="hljs-title class_">ModelExecuteProcessProps</span>&gt; = <span class="hljs-function">(<span class="hljs-params">{ status }</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"status: "</span>, status);
    <span class="hljs-comment">// get the last process status =&gt; current running progress status</span>
    <span class="hljs-keyword">const</span> lastStatus = status[status.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>];

    <span class="hljs-comment">// judge whether the current progress is finished </span>
    <span class="hljs-keyword">const</span> isProcessFinished = status.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> &amp;&amp; lastStatus?.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">"finished!"</span>);

    <span class="hljs-keyword">const</span> currentStepIndex = isProcessFinished ? status.<span class="hljs-property">length</span> : <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, status.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>);
    <span class="hljs-keyword">const</span> processSteps = [<span class="hljs-string">"Check data format"</span>, <span class="hljs-string">"Data preprocessing"</span>, <span class="hljs-string">"Model core computing"</span>, <span class="hljs-string">"Output result generation in progress"</span>, <span class="hljs-string">"Model execution finished!"</span>];

    <span class="hljs-keyword">return</span> (
    ......
    );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">ModelExecuteProcess</span>;
</code></pre>
<h3 data-id="heading-1">2. <code>useState</code>ï¼šç®€å•ç›´æ¥çš„çŠ¶æ€æ›¿æ¢</h3>
<ul>
<li>
<h4 data-id="heading-2">ç»“æ„</h4>
</li>
</ul>

<pre><code class="hljs language-scss" lang="scss">const <span class="hljs-selector-attr">[state, setState]</span> = <span class="hljs-built_in">useState</span>(initialState);
</code></pre>
<ul>
<li>
<h4 data-id="heading-3">å·¥ä½œåŸç†</h4>
</li>
</ul>
<p><code>setState</code> å‡½æ•°å¯ä»¥ç›´æ¥æ¥æ”¶æ–°çš„çŠ¶æ€å€¼ï¼Œæˆ–è€…ä¸€ä¸ªæ¥æ”¶ä¸Šä¸€ä¸ªçŠ¶æ€å¹¶è¿”å›æ–°çŠ¶æ€çš„å‡½æ•°ã€‚æ— è®ºé‡‡ç”¨å“ªç§æ–¹å¼ï¼Œ<code>setState</code> çš„æ ¸å¿ƒä½œç”¨æ˜¯æ›¿æ¢æ•´ä¸ªçŠ¶æ€å€¼ã€‚</p>
<ul>
<li>
<h4 data-id="heading-4">ç‰¹å¾</h4>
</li>
</ul>
<p>ä»£ç é‡å°‘ï¼Œå¯¹ç®€å•çŠ¶æ€éå¸¸ç›´è§‚ï¼›å¯¹äºåªéœ€è¦è·å–å’Œè®¾ç½®å•ä¸ªå€¼çš„éå¸¸æ–¹ä¾¿ä¾¿æ·ã€‚ä½†æ˜¯å½“çŠ¶æ€æ›´æ–°é€»è¾‘å¤æ‚æ—¶ï¼Œä¼šæ•£å¸ƒåœ¨å„ä¸ªå¤„ç†å‡½æ•°å½“ä¸­ï¼Œéš¾ä»¥ç»´æŠ¤ï¼Œæ­¤å¤–ä¼šæ¶‰åŠæ‰¹é‡å¤„ç†ã€ç«æ€æƒ…å†µï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä¸€ç›´æ— æ³•è§£å†³çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-5">3. <code>useReducer</code>ï¼šå¯é¢„æµ‹çš„çŠ¶æ€æ›¿æ¢</h3>
<ul>
<li>
<h4 data-id="heading-6">ç»“æ„</h4>
</li>
</ul>

<pre><code class="hljs language-scss" lang="scss">const <span class="hljs-selector-attr">[state, dispatch]</span> = <span class="hljs-built_in">useReducer</span>(reducer, initialState, init);
</code></pre>
<ul>
<li>
<h4 data-id="heading-7">å·¥ä½œåŸç†</h4>
</li>
</ul>
<p><code>reducer</code> å‡½æ•°ï¼šå®ƒæ¥æ”¶å½“å‰çš„ <code>state</code> å’Œä¸€ä¸ª <code>action</code> å¯¹è±¡ï¼Œç„¶åæ ¹æ® <code>action</code> çš„ç±»å‹è¿”å›ä¸€ä¸ªæ–°çš„çŠ¶æ€ã€‚å®ƒå°†çŠ¶æ€çš„è®¡ç®—é€»è¾‘ä¸çŠ¶æ€çš„ä½¿ç”¨åˆ†ç¦»å¼€æ¥ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-type">const</span> reducer = (state: <span class="hljs-type">String</span>[], action: Action): <span class="hljs-type">String</span>[] {
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'ADD_STEP'</span>:
      <span class="hljs-keyword">return</span> [...state, action.payload];
    <span class="hljs-keyword">case</span> <span class="hljs-string">'RESET'</span>:
      <span class="hljs-keyword">return</span> [];
    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
};
</code></pre>
<p><code>dispatch</code> å‡½æ•°ï¼š ç”¨äºè§¦å‘çŠ¶æ€æ›´æ–°ã€‚è°ƒç”¨<code>dispatch({ type: 'ADD_STEP', payload: steps[i] })</code>ï¼ŒReact å°±ä¼šå°†è¿™ä¸ª <code>action</code> ä¼ é€’ç»™ <code>reducer</code> å‡½æ•°è¿›è¡ŒçŠ¶æ€åˆ‡æ¢ï¼Œè¿›è¡Œåç»­çš„è®¡ç®—æ“ä½œã€‚</p>
<ul>
<li>
<h4 data-id="heading-8">ç‰¹å¾</h4>
</li>
</ul>
<p>æ‰€æœ‰çš„çŠ¶æ€è½¬æ¢é€»è¾‘éƒ½å°è£…åœ¨reducerå‡½æ•°ä¸­ï¼Œç»„ä»¶å†…éƒ¨åªéœ€è¦è°ƒç”¨dispatchï¼Œä»£ç æ›´å…·æœ‰å¯è¯»æ€§ï¼›å¹¶ä¸”é€‚åˆå¤„ç†åŒ…å«å¤šä¸ªå€¼çš„å¤æ‚çŠ¶æ€å¯¹è±¡ï¼›ç”±äºreduceræ˜¯çº¯å‡½æ•°ï¼Œå¢å¼ºäº†ä»£ç çš„å¯é¢„æµ‹æ€§ï¼Œå½“é‡åˆ°å¼‚æ­¥ã€æŒ‰é¡ºåºè¿½åŠ çš„åœºæ™¯æ—¶ï¼Œdispatchæ¯”setStateæ›´å¯é ã€‚</p>
<p><code>useState</code> å’Œ <code>useReducer</code> éƒ½æ˜¯Reactæä¾›çš„Hookï¼Œç”¨äºåœ¨å‡½æ•°ç»„ä»¶ä¸­ç®¡ç†çŠ¶æ€ã€‚å®ƒä»¬éƒ½èƒ½å®ç°æ›´æ–°çŠ¶æ€å¹¶è§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œä½†åœ¨ä½¿ç”¨åœºæ™¯ã€å¤æ‚åº¦å’Œå¯é¢„æµ‹æ€§æ–¹é¢æœ‰æ˜¾è‘—åŒºåˆ«ã€‚</p>
<h3 data-id="heading-9">4. ä½•æ—¶é€‰æ‹©å“ªä¸ªHookï¼Ÿ</h3>






























<table><thead><tr><th align="center"><strong>åœºæ™¯</strong></th><th align="center"><strong>æ¨è Hook</strong></th><th align="center"><strong>åŸå› </strong></th></tr></thead><tbody><tr><td align="center"><strong>ç®€å•çŠ¶æ€</strong></td><td align="center"><code>useState</code></td><td align="center">çŠ¶æ€æ˜¯ç‹¬ç«‹çš„åŸå§‹å€¼æˆ–ç®€å•å¯¹è±¡ï¼Œæ›´æ–°é€»è¾‘åªæœ‰ä¸€ä¸¤ç§</td></tr><tr><td align="center"><strong>çŠ¶æ€å…³è”</strong></td><td align="center"><code>useReducer</code></td><td align="center">æ–°çŠ¶æ€ä¾èµ–äºå‰ä¸€ä¸ªæˆ–å¤šä¸ªæ—§çŠ¶æ€ï¼Œæˆ–è€…çŠ¶æ€æ›´æ–°é€»è¾‘åˆ†æ•£åœ¨å¤šä¸ªå‡½æ•°ä¸­</td></tr><tr><td align="center"><strong>å¼‚æ­¥åºåˆ—</strong></td><td align="center"><code>useReducer</code></td><td align="center">éœ€è¦ä¸¥æ ¼æ§åˆ¶å¼‚æ­¥æ“ä½œï¼ˆå¦‚<code>setTimeout</code>æˆ–APIè°ƒç”¨ï¼‰åçš„çŠ¶æ€æ›´æ–°é¡ºåºå’Œå†…å®¹</td></tr><tr><td align="center"><strong>å¤§å‹åº”ç”¨</strong></td><td align="center"><code>useReducer</code></td><td align="center">çŠ¶æ€é€»è¾‘éœ€è¦è¢«å…±äº«ã€å¤ç”¨ï¼Œæˆ–è€…éœ€è¦ä½¿ç”¨Context APIæ¥è¿›è¡Œå…¨å±€ç®¡ç†ã€‚</td></tr></tbody></table>
<p>ä¸Šè¿°æ˜¯å°æåˆæ¬¡æ¥è§¦Reactçš„ä¸€ç‚¹ç‚¹ç†è§£ï¼Œå¸Œæœ›èƒ½æ…¢æ…¢ç§¯ç´¯è¿›æ­¥ï¼Œè‹¥å­˜åœ¨é”™è¯¯è¯·æŒ‡å‡ºï¼Œè°¢è°¢å¤§å®¶ï¼ï¼ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[VueåŠ¨æ€ç»„ä»¶ï¼šè®©ç»„ä»¶â€œæ´»â€èµ·æ¥çš„ç»ˆææŒ‡å—]]></title>    <link>https://juejin.cn/post/7579832417748647987</link>    <guid>https://juejin.cn/post/7579832417748647987</guid>    <pubDate>2025-12-04T15:03:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579832417748647987" data-draft-id="7579832186880655410" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="VueåŠ¨æ€ç»„ä»¶ï¼šè®©ç»„ä»¶â€œæ´»â€èµ·æ¥çš„ç»ˆææŒ‡å—"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2025-12-04T15:03:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŒ—è¾°alk"/> <meta itemprop="url" content="https://juejin.cn/user/1772855673241352"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            VueåŠ¨æ€ç»„ä»¶ï¼šè®©ç»„ä»¶â€œæ´»â€èµ·æ¥çš„ç»ˆææŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1772855673241352/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŒ—è¾°alk
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T15:03:12.000Z" title="Thu Dec 04 2025 15:03:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€ï¼šä¸ºä»€ä¹ˆéœ€è¦åŠ¨æ€ç»„ä»¶ï¼Ÿ</h2>
<p>åœ¨Vueå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„åœºæ™¯ï¼šåŒä¸€ä¸ªåŒºåŸŸéœ€è¦æ ¹æ®ä¸åŒçš„æ¡ä»¶æ˜¾ç¤ºä¸åŒçš„ç»„ä»¶ã€‚æ¯”å¦‚ï¼š</p>
<ul>
<li>â€¢ ä¸€ä¸ªå¤šæ­¥éª¤è¡¨å•ï¼Œæ¯ä¸€æ­¥æ˜¾ç¤ºä¸åŒçš„è¡¨å•ç»„ä»¶</li>
<li>â€¢ ä¸€ä¸ªTabåˆ‡æ¢ç•Œé¢ï¼Œç‚¹å‡»ä¸åŒæ ‡ç­¾æ˜¾ç¤ºä¸åŒå†…å®¹</li>
<li>â€¢ ä¸€ä¸ªåŠ¨æ€ä»ªè¡¨ç›˜ï¼Œç”¨æˆ·å¯ä»¥è‡ªç”±æ‹–æ‹½æ·»åŠ ä¸åŒçš„å°éƒ¨ä»¶</li>
</ul>
<p>å¦‚æœä¸ºæ¯ä¸ªåœºæ™¯éƒ½å†™ä¸€å †<code>v-if</code>ã€<code>v-else-if</code>ï¼Œä»£ç ä¼šå˜å¾—è‡ƒè‚¿ä¸”éš¾ä»¥ç»´æŠ¤ã€‚è¿™æ—¶å€™ï¼Œ<strong>åŠ¨æ€ç»„ä»¶</strong>å°±é—ªäº®ç™»åœºäº†ï¼</p>
<h2 data-id="heading-1">ä¸€ã€åŠ¨æ€ç»„ä»¶çš„åŸºæœ¬æ¦‚å¿µ</h2>
<h3 data-id="heading-2">ä»€ä¹ˆæ˜¯åŠ¨æ€ç»„ä»¶ï¼Ÿ</h3>
<p>åŠ¨æ€ç»„ä»¶æ˜¯Vueæä¾›çš„ä¸€ç§ç‰¹æ®Šæœºåˆ¶ï¼Œå…è®¸ä½ <strong>åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ‡æ¢ä¸åŒçš„ç»„ä»¶</strong>ï¼Œè€Œä¸éœ€è¦åœ¨æ¨¡æ¿ä¸­å†™æ­»ç»„ä»¶çš„æ ‡ç­¾ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â <span class="hljs-comment">&lt;!--Â åŠ¨æ€ç»„ä»¶ï¼šcomponentä¼šæ ¹æ®currentComponentçš„å€¼æ¸²æŸ“ä¸åŒçš„ç»„ä»¶Â --&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">component</span>Â <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentComponent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
Â Â Â Â 
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">button</span>Â @<span class="hljs-attr">click</span>=<span class="hljs-string">"toggleComponent"</span>&gt;</span>åˆ‡æ¢ç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span>Â <span class="hljs-title class_">ComponentA</span>Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'./ComponentA.vue'</span>
<span class="hljs-keyword">import</span>Â <span class="hljs-title class_">ComponentB</span>Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'./ComponentB.vue'</span>

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â {
Â Â <span class="hljs-title function_">data</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â {
Â Â Â Â Â Â <span class="hljs-attr">currentComponent</span>:Â <span class="hljs-string">'ComponentA'</span>
Â Â Â Â }
Â Â },
Â Â <span class="hljs-attr">components</span>:Â {
Â Â Â Â <span class="hljs-title class_">ComponentA</span>,
Â Â Â Â <span class="hljs-title class_">ComponentB</span>
Â Â },
Â Â <span class="hljs-attr">methods</span>:Â {
Â Â Â Â <span class="hljs-title function_">toggleComponent</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentComponent</span>Â =Â 
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentComponent</span>Â ===Â <span class="hljs-string">'ComponentA'</span>Â 
Â Â Â Â Â Â Â Â Â Â ?Â <span class="hljs-string">'ComponentB'</span>Â 
Â Â Â Â Â Â Â Â Â Â :Â <span class="hljs-string">'ComponentA'</span>
Â Â Â Â }
Â Â }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2 data-id="heading-3">äºŒã€åŠ¨æ€ç»„ä»¶çš„æ ¸å¿ƒç”¨æ³•</h2>
<h3 data-id="heading-4">1. ä½¿ç”¨<code>:is</code>å±æ€§ç»‘å®š</h3>
<p><code>:is</code>å±æ€§å¯ä»¥æ¥æ”¶ä¸‰ç§ç±»å‹çš„å€¼ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-comment">&lt;!--Â 1.Â å­—ç¬¦ä¸²ï¼šå·²æ³¨å†Œçš„ç»„ä»¶åÂ --&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">component</span>Â <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentTab"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
Â Â 
Â Â <span class="hljs-comment">&lt;!--Â 2.Â ç»„ä»¶é€‰é¡¹å¯¹è±¡Â --&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">component</span>Â <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentComponentObject"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
Â Â 
Â Â <span class="hljs-comment">&lt;!--Â 3.Â å¼‚æ­¥ç»„ä»¶å‡½æ•°Â --&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">component</span>Â <span class="hljs-attr">:is</span>=<span class="hljs-string">"asyncComponent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<h3 data-id="heading-5">2. ä¿æŒç»„ä»¶çŠ¶æ€ï¼š<code>&lt;keep-alive&gt;</code></h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŠ¨æ€ç»„ä»¶åˆ‡æ¢æ—¶ä¼š<strong>é”€æ¯æ—§ç»„ä»¶å¹¶åˆ›å»ºæ–°ç»„ä»¶</strong>ï¼Œè¿™æ„å‘³ç€ç»„ä»¶çš„çŠ¶æ€ä¼šä¸¢å¤±ã€‚ä½¿ç”¨<code>&lt;keep-alive&gt;</code>å¯ä»¥ç¼“å­˜ç»„ä»¶å®ä¾‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-comment">&lt;!--Â ç¼“å­˜æ‰€æœ‰åŠ¨æ€ç»„ä»¶Â --&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">keep-alive</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">component</span>Â <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentComponent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">keep-alive</span>&gt;</span>
Â Â 
Â Â <span class="hljs-comment">&lt;!--Â åªç¼“å­˜ç‰¹å®šç»„ä»¶Â --&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">keep-alive</span>Â <span class="hljs-attr">include</span>=<span class="hljs-string">"ComponentA,ComponentB"</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">component</span>Â <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentComponent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">keep-alive</span>&gt;</span>
Â Â 
Â Â <span class="hljs-comment">&lt;!--Â æ’é™¤æŸäº›ç»„ä»¶Â --&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">keep-alive</span>Â <span class="hljs-attr">exclude</span>=<span class="hljs-string">"ComponentC"</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">component</span>Â <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentComponent"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">keep-alive</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<h2 data-id="heading-6">ä¸‰ã€åŠ¨æ€ç»„ä»¶çš„å®Œæ•´ç¤ºä¾‹</h2>
<h3 data-id="heading-7">åœºæ™¯ï¼šæ„å»ºä¸€ä¸ªTabåˆ‡æ¢ç³»ç»Ÿ</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">class</span>=<span class="hljs-string">"tab-system"</span>&gt;</span>
Â Â Â Â <span class="hljs-comment">&lt;!--Â Tabæ ‡é¢˜Â --&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">class</span>=<span class="hljs-string">"tab-headers"</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">button</span>Â 
Â Â Â Â Â Â Â Â <span class="hljs-attr">v-for</span>=<span class="hljs-string">"tabÂ inÂ tabs"</span>Â 
Â Â Â Â Â Â Â Â <span class="hljs-attr">:key</span>=<span class="hljs-string">"tab.name"</span>
Â Â Â Â Â Â Â Â @<span class="hljs-attr">click</span>=<span class="hljs-string">"currentTabÂ =Â tab.name"</span>
Â Â Â Â Â Â Â Â <span class="hljs-attr">:class</span>=<span class="hljs-string">"{Â active:Â currentTabÂ ===Â tab.nameÂ }"</span>
Â Â Â Â Â Â &gt;</span>
Â Â Â Â Â Â Â Â {{Â tab.titleÂ }}
Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">&lt;!--Â Tabå†…å®¹Â -Â ä½¿ç”¨åŠ¨æ€ç»„ä»¶Â --&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">class</span>=<span class="hljs-string">"tab-content"</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">keep-alive</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">component</span>Â 
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentTab"</span>
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">:key</span>=<span class="hljs-string">"currentTab"</span>
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">:tab-data</span>=<span class="hljs-string">"tabData"</span>
Â Â Â Â Â Â Â Â Â Â @<span class="hljs-attr">data-change</span>=<span class="hljs-string">"handleDataChange"</span>
Â Â Â Â Â Â Â Â &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">keep-alive</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span>Â <span class="hljs-title class_">HomeTab</span>Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'./tabs/HomeTab.vue'</span>
<span class="hljs-keyword">import</span>Â <span class="hljs-title class_">ProfileTab</span>Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'./tabs/ProfileTab.vue'</span>
<span class="hljs-keyword">import</span>Â <span class="hljs-title class_">SettingsTab</span>Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'./tabs/SettingsTab.vue'</span>

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â {
Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'TabSystem'</span>,
Â Â <span class="hljs-attr">components</span>:Â {
Â Â Â Â <span class="hljs-title class_">HomeTab</span>,
Â Â Â Â <span class="hljs-title class_">ProfileTab</span>,
Â Â Â Â <span class="hljs-title class_">SettingsTab</span>
Â Â },
Â Â <span class="hljs-title function_">data</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â {
Â Â Â Â Â Â <span class="hljs-attr">currentTab</span>:Â <span class="hljs-string">'HomeTab'</span>,
Â Â Â Â Â Â <span class="hljs-attr">tabData</span>:Â {},
Â Â Â Â Â Â <span class="hljs-attr">tabs</span>:Â [
Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'HomeTab'</span>,Â <span class="hljs-attr">title</span>:Â <span class="hljs-string">'é¦–é¡µ'</span>Â },
Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'ProfileTab'</span>,Â <span class="hljs-attr">title</span>:Â <span class="hljs-string">'ä¸ªäººèµ„æ–™'</span>Â },
Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'SettingsTab'</span>,Â <span class="hljs-attr">title</span>:Â <span class="hljs-string">'è®¾ç½®'</span>Â }
Â Â Â Â Â Â ]
Â Â Â Â }
Â Â },
Â Â <span class="hljs-attr">methods</span>:Â {
Â Â Â Â <span class="hljs-title function_">handleDataChange</span>(<span class="hljs-params">newData</span>)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">tabData</span>Â =Â {Â ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">tabData</span>,Â ...newDataÂ }
Â Â Â Â }
Â Â }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span>Â <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.tab-system</span>Â {
Â Â <span class="hljs-attribute">border</span>:Â <span class="hljs-number">1px</span>Â solidÂ <span class="hljs-number">#e0e0e0</span>;
Â Â <span class="hljs-attribute">border-radius</span>:Â <span class="hljs-number">8px</span>;
Â Â <span class="hljs-attribute">overflow</span>:Â hidden;
}

<span class="hljs-selector-class">.tab-headers</span>Â {
Â Â <span class="hljs-attribute">display</span>:Â flex;
Â Â <span class="hljs-attribute">background</span>:Â <span class="hljs-number">#f5f5f5</span>;
Â Â <span class="hljs-attribute">border-bottom</span>:Â <span class="hljs-number">1px</span>Â solidÂ <span class="hljs-number">#e0e0e0</span>;
}

<span class="hljs-selector-class">.tab-headers</span>Â <span class="hljs-selector-tag">button</span>Â {
Â Â <span class="hljs-attribute">padding</span>:Â <span class="hljs-number">12px</span>Â <span class="hljs-number">24px</span>;
Â Â <span class="hljs-attribute">background</span>:Â none;
Â Â <span class="hljs-attribute">border</span>:Â none;
Â Â <span class="hljs-attribute">cursor</span>:Â pointer;
Â Â <span class="hljs-attribute">font-size</span>:Â <span class="hljs-number">16px</span>;
Â Â <span class="hljs-attribute">transition</span>:Â allÂ <span class="hljs-number">0.3s</span>;
}

<span class="hljs-selector-class">.tab-headers</span>Â <span class="hljs-selector-tag">button</span><span class="hljs-selector-pseudo">:hover</span>Â {
Â Â <span class="hljs-attribute">background</span>:Â <span class="hljs-number">#e8e8e8</span>;
}

<span class="hljs-selector-class">.tab-headers</span>Â <span class="hljs-selector-tag">button</span><span class="hljs-selector-class">.active</span>Â {
Â Â <span class="hljs-attribute">background</span>:Â white;
Â Â <span class="hljs-attribute">border-bottom</span>:Â <span class="hljs-number">3px</span>Â solidÂ <span class="hljs-number">#42b983</span>;
Â Â <span class="hljs-attribute">font-weight</span>:Â bold;
}

<span class="hljs-selector-class">.tab-content</span>Â {
Â Â <span class="hljs-attribute">padding</span>:Â <span class="hljs-number">20px</span>;
Â Â <span class="hljs-attribute">min-height</span>:Â <span class="hljs-number">300px</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h2 data-id="heading-8">å››ã€åŠ¨æ€ç»„ä»¶çš„å·¥ä½œåŸç†</h2>
<p>è®©æˆ‘ä»¬é€šè¿‡æµç¨‹å›¾æ¥ç†è§£åŠ¨æ€ç»„ä»¶çš„æ¸²æŸ“è¿‡ç¨‹ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby">å­—ç¬¦ä¸²

ç»„ä»¶å¯¹è±¡

å¼‚æ­¥ç»„ä»¶

æ˜¯

å¦

æ˜¯

æ˜¯

å¦

å¦

æ˜¯

å¦

æ¨¡æ¿è§£æé‡åˆ° component æ ‡ç­¾è§£æ <span class="hljs-symbol">:is</span> å±æ€§æŸ¥æ‰¾å·²æ³¨å†Œç»„ä»¶ç›´æ¥ä½¿ç”¨ç»„ä»¶é€‰é¡¹åŠ è½½å¼‚æ­¥ç»„ä»¶ç»„ä»¶æ˜¯å¦å­˜åœ¨<span class="hljs-string">?åˆ›</span>å»ºç»„ä»¶å®ä¾‹æ¸²æŸ“æ³¨é‡ŠèŠ‚ç‚¹/æ§åˆ¶å°è­¦å‘Šæ˜¯å¦æœ‰ keep-alive?æ£€æŸ¥ç¼“å­˜æ˜¯å¦å·²ç¼“å­˜<span class="hljs-string">?ä»</span>ç¼“å­˜æ¢å¤å®ä¾‹åˆ›å»ºæ–°å®ä¾‹å¹¶ç¼“å­˜è§¦å‘ activated ç”Ÿå‘½å‘¨æœŸè§¦å‘å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸæ¸²æŸ“ç»„ä»¶åˆ‡æ¢ç»„ä»¶æ˜¯å¦ç›¸åŒç»„ä»¶<span class="hljs-string">?ä¿</span>æŒå½“å‰çŠ¶æ€é”€æ¯æ—§ç»„ä»¶
</code></pre>
<h2 data-id="heading-9">äº”ã€é«˜çº§åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-10">åœºæ™¯1ï¼šåŠ¨æ€è¡¨å•ç”Ÿæˆå™¨</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">class</span>=<span class="hljs-string">"dynamic-form"</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{{Â formConfig.titleÂ }}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
Â Â Â Â 
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">component</span>
Â Â Â Â Â Â <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(field,Â index)Â inÂ formConfig.fields"</span>
Â Â Â Â Â Â <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span>
Â Â Â Â Â Â <span class="hljs-attr">:is</span>=<span class="hljs-string">"field.component"</span>
Â Â Â Â Â Â <span class="hljs-attr">v-model</span>=<span class="hljs-string">"formData[field.name]"</span>
Â Â Â Â Â Â <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"field.props"</span>
Â Â Â Â Â Â @<span class="hljs-attr">custom-event</span>=<span class="hljs-string">"handleCustomEvent"</span>
Â Â Â Â &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
Â Â Â Â 
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">button</span>Â @<span class="hljs-attr">click</span>=<span class="hljs-string">"submitForm"</span>&gt;</span>æäº¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span>Â <span class="hljs-title class_">TextInput</span>Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'./form-components/TextInput.vue'</span>
<span class="hljs-keyword">import</span>Â <span class="hljs-title class_">SelectInput</span>Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'./form-components/SelectInput.vue'</span>
<span class="hljs-keyword">import</span>Â <span class="hljs-title class_">CheckboxGroup</span>Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'./form-components/CheckboxGroup.vue'</span>
<span class="hljs-keyword">import</span>Â <span class="hljs-title class_">DatePicker</span>Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'./form-components/DatePicker.vue'</span>

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â {
Â Â <span class="hljs-attr">components</span>:Â {
Â Â Â Â <span class="hljs-title class_">TextInput</span>,
Â Â Â Â <span class="hljs-title class_">SelectInput</span>,
Â Â Â Â <span class="hljs-title class_">CheckboxGroup</span>,
Â Â Â Â <span class="hljs-title class_">DatePicker</span>
Â Â },
Â Â <span class="hljs-title function_">data</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â {
Â Â Â Â Â Â <span class="hljs-attr">formData</span>:Â {},
Â Â Â Â Â Â <span class="hljs-attr">formConfig</span>:Â {
Â Â Â Â Â Â Â Â <span class="hljs-attr">title</span>:Â <span class="hljs-string">'ç”¨æˆ·æ³¨å†Œ'</span>,
Â Â Â Â Â Â Â Â <span class="hljs-attr">fields</span>:Â [
Â Â Â Â Â Â Â Â Â Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'username'</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">label</span>:Â <span class="hljs-string">'ç”¨æˆ·å'</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">component</span>:Â <span class="hljs-string">'TextInput'</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">props</span>:Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">placeholder</span>:Â <span class="hljs-string">'è¯·è¾“å…¥ç”¨æˆ·å'</span>,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">maxlength</span>:Â <span class="hljs-number">20</span>
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â },
Â Â Â Â Â Â Â Â Â Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'gender'</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">label</span>:Â <span class="hljs-string">'æ€§åˆ«'</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">component</span>:Â <span class="hljs-string">'SelectInput'</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">props</span>:Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">options</span>:Â [
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">value</span>:Â <span class="hljs-string">'male'</span>,Â <span class="hljs-attr">label</span>:Â <span class="hljs-string">'ç”·'</span>Â },
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">value</span>:Â <span class="hljs-string">'female'</span>,Â <span class="hljs-attr">label</span>:Â <span class="hljs-string">'å¥³'</span>Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â ]
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â },
Â Â Â Â Â Â Â Â Â Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'hobbies'</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">label</span>:Â <span class="hljs-string">'çˆ±å¥½'</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">component</span>:Â <span class="hljs-string">'CheckboxGroup'</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">props</span>:Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">options</span>:Â [
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">value</span>:Â <span class="hljs-string">'reading'</span>,Â <span class="hljs-attr">label</span>:Â <span class="hljs-string">'é˜…è¯»'</span>Â },
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">value</span>:Â <span class="hljs-string">'sports'</span>,Â <span class="hljs-attr">label</span>:Â <span class="hljs-string">'è¿åŠ¨'</span>Â },
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">value</span>:Â <span class="hljs-string">'music'</span>,Â <span class="hljs-attr">label</span>:Â <span class="hljs-string">'éŸ³ä¹'</span>Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â ]
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â ]
Â Â Â Â Â Â }
Â Â Â Â }
Â Â },
Â Â <span class="hljs-title function_">created</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-comment">//Â åˆå§‹åŒ–è¡¨å•æ•°æ®</span>
Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">formConfig</span>.<span class="hljs-property">fields</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">field</span>Â =&gt;</span>Â {
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.$set(<span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>,Â field.<span class="hljs-property">name</span>,Â <span class="hljs-string">''</span>)
Â Â Â Â })
Â Â },
Â Â <span class="hljs-attr">methods</span>:Â {
Â Â Â Â <span class="hljs-title function_">submitForm</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¡¨å•æ•°æ®:'</span>,Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>)
Â Â Â Â Â Â <span class="hljs-comment">//Â æäº¤é€»è¾‘...</span>
Â Â Â Â },
Â Â Â Â <span class="hljs-title function_">handleCustomEvent</span>(<span class="hljs-params">payload</span>)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ¥æ”¶åˆ°è‡ªå®šä¹‰äº‹ä»¶:'</span>,Â payload)
Â Â Â Â }
Â Â }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-11">åœºæ™¯2ï¼šæ’ä»¶åŒ–æ¶æ„</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">class</span>=<span class="hljs-string">"plugin-dashboard"</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">class</span>=<span class="hljs-string">"plugin-sidebar"</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>å¯ç”¨æ’ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">li</span>Â 
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">v-for</span>=<span class="hljs-string">"pluginÂ inÂ availablePlugins"</span>
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">:key</span>=<span class="hljs-string">"plugin.name"</span>
Â Â Â Â Â Â Â Â Â Â @<span class="hljs-attr">click</span>=<span class="hljs-string">"activatePlugin(plugin)"</span>
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">:class</span>=<span class="hljs-string">"{Â active:Â activePlugin?.nameÂ ===Â plugin.nameÂ }"</span>
Â Â Â Â Â Â Â Â &gt;</span>
Â Â Â Â Â Â Â Â Â Â {{Â plugin.displayNameÂ }}
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â 
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">class</span>=<span class="hljs-string">"plugin-main"</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">v-if</span>=<span class="hljs-string">"activePlugin"</span>Â <span class="hljs-attr">class</span>=<span class="hljs-string">"plugin-container"</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">component</span>
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">:is</span>=<span class="hljs-string">"activePlugin.component"</span>
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">:key</span>=<span class="hljs-string">"activePlugin.name"</span>
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">:config</span>=<span class="hljs-string">"pluginConfigs[activePlugin.name]"</span>
Â Â Â Â Â Â Â Â Â Â @<span class="hljs-attr">config-change</span>=<span class="hljs-string">"updatePluginConfig"</span>
Â Â Â Â Â Â Â Â &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">v-else</span>Â <span class="hljs-attr">class</span>=<span class="hljs-string">"plugin-placeholder"</span>&gt;</span>
Â Â Â Â Â Â Â Â è¯·ä»å·¦ä¾§é€‰æ‹©ä¸€ä¸ªæ’ä»¶
Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-comment">//Â åŠ¨æ€å¯¼å…¥æ‰€æœ‰æ’ä»¶</span>
<span class="hljs-keyword">const</span>Â pluginModulesÂ =Â <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-title function_">glob</span>(<span class="hljs-string">'./plugins/*.vue'</span>)

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â {
Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'PluginDashboard'</span>,
Â Â <span class="hljs-title function_">data</span>(<span class="hljs-params"/>)Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â {
Â Â Â Â Â Â <span class="hljs-attr">activePlugin</span>:Â <span class="hljs-literal">null</span>,
Â Â Â Â Â Â <span class="hljs-attr">pluginConfigs</span>:Â {},
Â Â Â Â Â Â <span class="hljs-attr">availablePlugins</span>:Â [
Â Â Â Â Â Â Â Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'chart'</span>,
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">displayName</span>:Â <span class="hljs-string">'å›¾è¡¨åˆ†æ'</span>,
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">component</span>:Â <span class="hljs-function">()Â =&gt;</span>Â <span class="hljs-keyword">import</span>(<span class="hljs-string">'./plugins/ChartPlugin.vue'</span>)
Â Â Â Â Â Â Â Â },
Â Â Â Â Â Â Â Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'table'</span>,
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">displayName</span>:Â <span class="hljs-string">'æ•°æ®è¡¨æ ¼'</span>,
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">component</span>:Â <span class="hljs-function">()Â =&gt;</span>Â <span class="hljs-keyword">import</span>(<span class="hljs-string">'./plugins/TablePlugin.vue'</span>)
Â Â Â Â Â Â Â Â },
Â Â Â Â Â Â Â Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">name</span>:Â <span class="hljs-string">'calendar'</span>,
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">displayName</span>:Â <span class="hljs-string">'æ—¥å†è§†å›¾'</span>,
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">component</span>:Â <span class="hljs-function">()Â =&gt;</span>Â <span class="hljs-keyword">import</span>(<span class="hljs-string">'./plugins/CalendarPlugin.vue'</span>)
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â ]
Â Â Â Â }
Â Â },
Â Â <span class="hljs-attr">methods</span>:Â {
Â Â Â Â <span class="hljs-title function_">activatePlugin</span>(<span class="hljs-params">plugin</span>)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">activePlugin</span>Â =Â plugin
Â Â Â Â Â Â 
Â Â Â Â Â Â <span class="hljs-comment">//Â åˆå§‹åŒ–é…ç½®</span>
Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">pluginConfigs</span>[plugin.<span class="hljs-property">name</span>])Â {
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.$set(<span class="hljs-variable language_">this</span>.<span class="hljs-property">pluginConfigs</span>,Â plugin.<span class="hljs-property">name</span>,Â {
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">theme</span>:Â <span class="hljs-string">'light'</span>,
Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">autoRefresh</span>:Â <span class="hljs-literal">true</span>,
Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å…¶ä»–é»˜è®¤é…ç½®...</span>
Â Â Â Â Â Â Â Â })
Â Â Â Â Â Â }
Â Â Â Â },
Â Â Â Â <span class="hljs-title function_">updatePluginConfig</span>(<span class="hljs-params">newConfig</span>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-variable language_">this</span>.<span class="hljs-property">activePlugin</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">pluginConfigs</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">activePlugin</span>.<span class="hljs-property">name</span>]Â =Â {
Â Â Â Â Â Â Â Â Â Â ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">pluginConfigs</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">activePlugin</span>.<span class="hljs-property">name</span>],
Â Â Â Â Â Â Â Â Â Â ...newConfig
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â }
Â Â Â Â }
Â Â }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2 data-id="heading-12">å…­ã€æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-13">1.Â <strong>æ€§èƒ½ä¼˜åŒ–</strong></h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-comment">&lt;!--Â ä½¿ç”¨å¼‚æ­¥ç»„ä»¶Â +Â éª¨æ¶å±Â --&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">template</span>Â #<span class="hljs-attr">default</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">component</span>Â <span class="hljs-attr">:is</span>=<span class="hljs-string">"asyncComponent"</span>Â /&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">template</span>Â #<span class="hljs-attr">fallback</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">SkeletonLoader</span>Â /&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-comment">//Â è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²</span>
<span class="hljs-keyword">const</span>Â <span class="hljs-title function_">AsyncComponent</span>Â =Â (<span class="hljs-params"/>)Â =&gt;Â ({
Â Â <span class="hljs-attr">component</span>:Â <span class="hljs-keyword">import</span>(<span class="hljs-string">'./HeavyComponent.vue'</span>),
Â Â <span class="hljs-attr">loading</span>:Â <span class="hljs-title class_">LoadingComponent</span>,Â Â <span class="hljs-comment">//Â åŠ è½½ä¸­çš„ç»„ä»¶</span>
Â Â <span class="hljs-attr">error</span>:Â <span class="hljs-title class_">ErrorComponent</span>,Â Â Â Â Â Â <span class="hljs-comment">//Â åŠ è½½å¤±è´¥çš„ç»„ä»¶</span>
Â Â <span class="hljs-attr">delay</span>:Â <span class="hljs-number">200</span>,Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å»¶è¿Ÿæ˜¾ç¤ºåŠ è½½ç»„ä»¶</span>
Â Â <span class="hljs-attr">timeout</span>:Â <span class="hljs-number">3000</span>Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è¶…æ—¶æ—¶é—´</span>
})
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-14">2.Â <strong>çŠ¶æ€ç®¡ç†</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â ä½¿ç”¨Vuex/Piniaç®¡ç†åŠ¨æ€ç»„ä»¶çš„å…±äº«çŠ¶æ€</span>
<span class="hljs-keyword">import</span>Â {Â defineStoreÂ }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'pinia'</span>

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">const</span>Â useDynamicComponentsStoreÂ =Â <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">'dynamicComponents'</span>,Â {
Â Â <span class="hljs-attr">state</span>:Â <span class="hljs-function">()Â =&gt;</span>Â ({
Â Â Â Â <span class="hljs-attr">activeComponents</span>:Â {},
Â Â Â Â <span class="hljs-attr">componentStates</span>:Â {},
Â Â Â Â <span class="hljs-attr">componentConfigs</span>:Â {}
Â Â }),
Â Â <span class="hljs-attr">actions</span>:Â {
Â Â Â Â <span class="hljs-title function_">registerComponent</span>(<span class="hljs-params">name,Â config</span>)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeComponents</span>[name]Â =Â {
Â Â Â Â Â Â Â Â ...config,
Â Â Â Â Â Â Â Â <span class="hljs-attr">isActive</span>:Â <span class="hljs-literal">true</span>
Â Â Â Â Â Â }
Â Â Â Â },
Â Â Â Â <span class="hljs-title function_">saveComponentState</span>(<span class="hljs-params">name,Â state</span>)Â {
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">componentStates</span>[name]Â =Â state
Â Â Â Â },
Â Â Â Â <span class="hljs-title function_">restoreComponentState</span>(<span class="hljs-params">name</span>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">componentStates</span>[name]Â ||Â {}
Â Â Â Â }
Â Â }
})
</code></pre>
<h3 data-id="heading-15">3.Â <strong>é”™è¯¯å¤„ç†</strong></h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">component</span>
Â Â Â Â Â Â <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentComponent"</span>
Â Â Â Â Â Â @<span class="hljs-attr">error</span>=<span class="hljs-string">"handleComponentError"</span>
Â Â Â Â /&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span>Â {Â <span class="hljs-title class_">ErrorBoundary</span>Â }Â <span class="hljs-keyword">from</span>Â <span class="hljs-string">'./ErrorBoundary.vue'</span>

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â {
Â Â <span class="hljs-attr">components</span>:Â {Â <span class="hljs-title class_">ErrorBoundary</span>Â },
Â Â <span class="hljs-attr">methods</span>:Â {
Â Â Â Â <span class="hljs-title function_">handleComponentError</span>(<span class="hljs-params">error,Â vm,Â info</span>)Â {
Â Â Â Â Â Â <span class="hljs-comment">//Â è®°å½•é”™è¯¯</span>
Â Â Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'åŠ¨æ€ç»„ä»¶é”™è¯¯:'</span>,Â error)
Â Â Â Â Â Â 
Â Â Â Â Â Â <span class="hljs-comment">//Â ä¸ŠæŠ¥åˆ°ç›‘æ§ç³»ç»Ÿ</span>
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.$track(<span class="hljs-string">'component-error'</span>,Â {
Â Â Â Â Â Â Â Â <span class="hljs-attr">component</span>:Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentComponent</span>,
Â Â Â Â Â Â Â Â <span class="hljs-attr">error</span>:Â error.<span class="hljs-property">message</span>,
Â Â Â Â Â Â Â Â info
Â Â Â Â Â Â })
Â Â Â Â Â Â 
Â Â Â Â Â Â <span class="hljs-comment">//Â é™çº§å¤„ç†</span>
Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentComponent</span>Â =Â <span class="hljs-string">'FallbackComponent'</span>
Â Â Â Â }
Â Â }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h2 data-id="heading-16">ä¸ƒã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-17">Q1: åŠ¨æ€ç»„ä»¶åˆ‡æ¢æ—¶å¦‚ä½•ä¼ é€’propsï¼Ÿ</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-comment">&lt;!--Â æ–¹æ³•1ï¼šä½¿ç”¨v-bindç»‘å®šæ‰€æœ‰propsÂ --&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">component</span>Â 
Â Â Â Â <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentComponent"</span>Â 
Â Â Â Â <span class="hljs-attr">v-bind</span>=<span class="hljs-string">"componentProps"</span>
Â Â /&gt;</span>
Â Â 
Â Â <span class="hljs-comment">&lt;!--Â æ–¹æ³•2ï¼šä½¿ç”¨v-onç»‘å®šæ‰€æœ‰äº‹ä»¶Â --&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">component</span>Â 
Â Â Â Â <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentComponent"</span>
Â Â Â Â <span class="hljs-attr">v-on</span>=<span class="hljs-string">"componentEvents"</span>
Â Â /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">default</span>Â {
Â Â <span class="hljs-attr">computed</span>:Â {
Â Â Â Â <span class="hljs-title function_">componentProps</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â propsMapÂ =Â {
Â Â Â Â Â Â Â Â <span class="hljs-title class_">ComponentA</span>:Â {Â <span class="hljs-attr">title</span>:Â <span class="hljs-string">'Aç»„ä»¶'</span>,Â <span class="hljs-attr">count</span>:Â <span class="hljs-number">10</span>Â },
Â Â Â Â Â Â Â Â <span class="hljs-title class_">ComponentB</span>:Â {Â <span class="hljs-attr">items</span>:Â [<span class="hljs-number">1</span>,Â <span class="hljs-number">2</span>,Â <span class="hljs-number">3</span>],Â <span class="hljs-attr">loading</span>:Â <span class="hljs-literal">false</span>Â }
Â Â Â Â Â Â }
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â propsMap[<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentComponent</span>]Â ||Â {}
Â Â Â Â },
Â Â Â Â <span class="hljs-title function_">componentEvents</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-attr">submit</span>:Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleSubmit</span>,
Â Â Â Â Â Â Â Â <span class="hljs-attr">cancel</span>:Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleCancel</span>,
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ”¯æŒæ‰€æœ‰è‡ªå®šä¹‰äº‹ä»¶</span>
Â Â Â Â Â Â Â Â ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">customEvents</span>
Â Â Â Â Â Â }
Â Â Â Â }
Â Â }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h3 data-id="heading-18">Q2: å¦‚ä½•å®ç°åŠ¨æ€ç»„ä»¶çš„åŠ¨ç”»åˆ‡æ¢ï¼Ÿ</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">div</span>Â <span class="hljs-attr">class</span>=<span class="hljs-string">"component-transition"</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">transition</span>Â 
Â Â Â Â Â Â <span class="hljs-attr">:name</span>=<span class="hljs-string">"transitionName"</span>
Â Â Â Â Â Â <span class="hljs-attr">mode</span>=<span class="hljs-string">"out-in"</span>
Â Â Â Â Â Â @<span class="hljs-attr">before-enter</span>=<span class="hljs-string">"beforeEnter"</span>
Â Â Â Â Â Â @<span class="hljs-attr">after-enter</span>=<span class="hljs-string">"afterEnter"</span>
Â Â Â Â &gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">component</span>
Â Â Â Â Â Â Â Â <span class="hljs-attr">:is</span>=<span class="hljs-string">"currentComponent"</span>
Â Â Â Â Â Â Â Â <span class="hljs-attr">:key</span>=<span class="hljs-string">"componentKey"</span>
Â Â Â Â Â Â /&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">transition</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span>Â <span class="hljs-attr">scoped</span>&gt;</span><span class="css">
<span class="hljs-comment">/*Â å®šä¹‰åˆ‡æ¢åŠ¨ç”»Â */</span>
<span class="hljs-selector-class">.slide-fade-enter-active</span>,
<span class="hljs-selector-class">.slide-fade-leave-active</span>Â {
Â Â <span class="hljs-attribute">transition</span>:Â allÂ <span class="hljs-number">0.3s</span>Â ease;
}

<span class="hljs-selector-class">.slide-fade-enter-from</span>Â {
Â Â <span class="hljs-attribute">opacity</span>:Â <span class="hljs-number">0</span>;
Â Â <span class="hljs-attribute">transform</span>:Â <span class="hljs-built_in">translateX</span>(<span class="hljs-number">30px</span>);
}

<span class="hljs-selector-class">.slide-fade-leave-to</span>Â {
Â Â <span class="hljs-attribute">opacity</span>:Â <span class="hljs-number">0</span>;
Â Â <span class="hljs-attribute">transform</span>:Â <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">30px</span>);
}

<span class="hljs-comment">/*Â å¦ä¸€ç§åŠ¨ç”»æ•ˆæœÂ */</span>
<span class="hljs-selector-class">.fade-enter-active</span>,
<span class="hljs-selector-class">.fade-leave-active</span>Â {
Â Â <span class="hljs-attribute">transition</span>:Â opacityÂ <span class="hljs-number">0.5s</span>;
}

<span class="hljs-selector-class">.fade-enter-from</span>,
<span class="hljs-selector-class">.fade-leave-to</span>Â {
Â Â <span class="hljs-attribute">opacity</span>:Â <span class="hljs-number">0</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<h2 data-id="heading-19">ç»“è¯­ï¼šåŠ¨æ€ç»„ä»¶çš„æ— é™å¯èƒ½</h2>
<p>åŠ¨æ€ç»„ä»¶æ˜¯Vueæ¡†æ¶ä¸­éå¸¸å¼ºå¤§çš„ç‰¹æ€§ï¼Œå®ƒä¸ºæ„å»ºçµæ´»ã€å¯æ‰©å±•çš„åº”ç”¨æä¾›äº†æ— é™å¯èƒ½ã€‚æ— è®ºæ˜¯ç®€å•çš„Tabåˆ‡æ¢ï¼Œè¿˜æ˜¯å¤æ‚çš„æ’ä»¶åŒ–ç³»ç»Ÿï¼ŒåŠ¨æ€ç»„ä»¶éƒ½èƒ½è®©ä½ çš„ä»£ç æ›´åŠ ä¼˜é›…å’Œå¯ç»´æŠ¤ã€‚</p>
<p>è®°ä½è¿™äº›æ ¸å¿ƒè¦ç‚¹ï¼š</p>
<ol>
<li>1.Â <strong>çµæ´»åˆ‡æ¢</strong>ï¼šä½¿ç”¨<code>:is</code>å±æ€§åŠ¨æ€å†³å®šæ¸²æŸ“å“ªä¸ªç»„ä»¶</li>
<li>2.Â <strong>çŠ¶æ€ä¿æŒ</strong>ï¼šåˆç†ä½¿ç”¨<code>&lt;keep-alive&gt;</code>ç¼“å­˜ç»„ä»¶çŠ¶æ€</li>
<li>3.Â <strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šç»“åˆå¼‚æ­¥ç»„ä»¶å®ç°ä»£ç åˆ†å‰²</li>
<li>4.Â <strong>é”™è¯¯å¤„ç†</strong>ï¼šåšå¥½è¾¹ç•Œæƒ…å†µçš„å¤„ç†</li>
</ol>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£VueåŠ¨æ€ç»„ä»¶ï¼Œå¹¶åœ¨å®é™…é¡¹ç›®ä¸­æ¸¸åˆƒæœ‰ä½™åœ°ä½¿ç”¨å®ƒã€‚å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–å¿ƒå¾—ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€äº¤æµï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript ç»§æ‰¿ç»ˆæè§£æï¼šåŸå‹é“¾é—­ç¯ã€å…­å¤§ç»§æ‰¿æ–¹å¼å¯¹æ¯”ä¸æ‰€æœ‰è‡´å‘½å‘]]></title>    <link>https://juejin.cn/post/7579889969984995379</link>    <guid>https://juejin.cn/post/7579889969984995379</guid>    <pubDate>2025-12-04T15:47:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579889969984995379" data-draft-id="7579832186880688178" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript ç»§æ‰¿ç»ˆæè§£æï¼šåŸå‹é“¾é—­ç¯ã€å…­å¤§ç»§æ‰¿æ–¹å¼å¯¹æ¯”ä¸æ‰€æœ‰è‡´å‘½å‘"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-04T15:47:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸ä¼šjs"/> <meta itemprop="url" content="https://juejin.cn/user/2517262684662348"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript ç»§æ‰¿ç»ˆæè§£æï¼šåŸå‹é“¾é—­ç¯ã€å…­å¤§ç»§æ‰¿æ–¹å¼å¯¹æ¯”ä¸æ‰€æœ‰è‡´å‘½å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2517262684662348/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸ä¼šjs
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T15:47:41.000Z" title="Thu Dec 04 2025 15:47:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">JavaScript ç»§æ‰¿ç»ˆæè§£æï¼šåŸå‹é“¾é—­ç¯ã€å…­å¤§ç»§æ‰¿æ–¹å¼å¯¹æ¯”ä¸æ‰€æœ‰è‡´å‘½å‘</h2>
<p>å¤§å®¶å¥½ï¼Œä»Šå¤©å¸¦å¤§å®¶å½»åº•ææ‡‚ JavaScript ä¸­æœ€ç»•è„‘ã€é¢è¯•æœ€çˆ±é—®ã€å´åˆæœ€å®¹æ˜“è¸©å‘çš„çŸ¥è¯†ç‚¹â€”â€”<strong>ç»§æ‰¿</strong>ã€‚</p>
<p>æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ç»§æ‰¿çš„å¤§æ¦‚çŸ¥è¯†ç‚¹ï¼š6 ç§ç»§æ‰¿æ–¹å¼å¯¹æ¯” + æ‰‹å†™ instanceof
ç„¶åç›´æ¥é—ªç°æ¥åˆ°æœ¬æ–‡çš„æ ¸å¿ƒé‡ç‚¹â€”â€”â€”â€”<strong>ç»§æ‰¿ä¸­æœ€çƒ§è„‘çš„å‡ ä¸ªçŸ¥è¯†ç‚¹</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c02760ffda74c9aa15f5a31067fa45c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LyaanM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765468061&amp;x-signature=pKAogw78sAL5%2F0S6o6tORxC%2BB4c%3D" alt="7d51c79f4346e65c2eafb673286d21c7.jpg" loading="lazy"/></p>
<h3 data-id="heading-1">ä¸€ã€å…ˆææ¸…æ¥š JavaScript çš„â€œè¡€ç¼˜å…³ç³»â€â€”â€” åŸå‹é“¾</h3>
<p>åœ¨å¼€å§‹ç»§æ‰¿ä¹‹å‰ï¼Œå…ˆé—®ä½ ä¸‰ä¸ªçµé­‚é—®é¢˜ï¼š</p>
<pre><code class="hljs language-js" lang="js">[].<span class="hljs-property">__proto__</span>               <span class="hljs-comment">// æŒ‡å‘è°ï¼Ÿ</span>
<span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span>  <span class="hljs-comment">// æŒ‡å‘è°ï¼Ÿ</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> <span class="hljs-comment">// æ˜¯ nullï¼</span>
</code></pre>
<p>è¿™å°±æ˜¯ä¼ è¯´ä¸­çš„åŸå‹é“¾ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">å®ä¾‹ â†’ æ„é€ å‡½æ•°.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> â†’ <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> â†’ <span class="hljs-literal">null</span>
</code></pre>
<p>è®°ä½è¿™å¼ å›¾ï¼Œå®ƒæ˜¯åé¢æ‰€æœ‰ç»§æ‰¿çš„æ ¹åŸºï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">cat1 â†’ <span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> â†’ <span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> â†’ <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> â†’ <span class="hljs-literal">null</span>
</code></pre>
<h3 data-id="heading-2">äºŒã€æ‰‹å†™ instanceof â€”â€” é¢è¯•å¿…è€ƒ</h3>
<pre><code class="hljs language-js" lang="js"> <span class="hljs-keyword">function</span> <span class="hljs-title function_">isInstanceOf</span>(<span class="hljs-params">left,right</span>){
            <span class="hljs-keyword">let</span> proto = left.<span class="hljs-property">__proto__</span>;
            <span class="hljs-keyword">while</span>(proto){
                <span class="hljs-keyword">if</span>(proto===right.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>){
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
                }
                proto=proto.<span class="hljs-property">__proto__</span>;<span class="hljs-comment">//null</span>
            }
             <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
        }
</code></pre>
<p>ç»å…¸æµ‹è¯•ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params"/>) {}
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();

<span class="hljs-keyword">const</span> cat = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">myInstanceof</span>(cat, <span class="hljs-title class_">Animal</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">myInstanceof</span>(cat, <span class="hljs-title class_">Object</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">myInstanceof</span>(cat, <span class="hljs-title class_">Cat</span>));     <span class="hljs-comment">// true</span>
</code></pre>
<p><strong>æ˜“é”™ç‚¹æé†’</strong>ï¼š</p>
<ul>
<li><code>instanceof</code> çœ‹çš„æ˜¯åŸå‹é“¾ï¼Œä¸æ˜¯ constructorï¼</li>
<li><code>cat.constructor === Animal</code> å¯èƒ½æ˜¯ falseï¼å› ä¸º constructor å¾ˆå®¹æ˜“è¢«æ”¹æ‰</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Animal</span>) <span class="hljs-comment">// å¾ˆå¯èƒ½ falseï¼</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Cat</span>)    <span class="hljs-comment">// æˆ‘ä»¬åé¢ä¼šä¿®å¤å®ƒ</span>
</code></pre>
<h3 data-id="heading-3">ä¸‰ã€JavaScript ç»§æ‰¿çš„å…­ç§å§¿åŠ¿ï¼ˆä»åŸå§‹åˆ°å®Œç¾ï¼‰</h3>
<h4 data-id="heading-4">æ–¹å¼ä¸€ï¼šæ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆå€Ÿç”¨æ„é€ å‡½æ•°ï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">species</span> = <span class="hljs-string">"åŠ¨ç‰©"</span>;
}
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, color</span>) {
    <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>);  <span class="hljs-comment">// å€Ÿç”¨çˆ¶ç±»æ„é€ å‡½æ•°</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}
</code></pre>
<p>ä¼˜ç‚¹ï¼šèƒ½ç»§æ‰¿å®ä¾‹å±æ€§<br/>
ç¼ºç‚¹ï¼šæ–¹æ³•å…¨åœ¨æ„é€ å‡½æ•°é‡Œï¼Œæ¯æ¬¡ new éƒ½é‡æ–°åˆ›å»ºï¼Œæµªè´¹å†…å­˜ + æ‹¿ä¸åˆ°çˆ¶ç±»åŸå‹ä¸Šçš„æ–¹æ³•</p>
<h4 data-id="heading-5">æ–¹å¼äºŒï¼šåŸå‹é“¾ç»§æ‰¿ï¼ˆç»å…¸ä½†æœ‰å‘ï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {}
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">species</span> = <span class="hljs-string">"åŠ¨ç‰©"</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, color</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();        <span class="hljs-comment">// å…³é”®ï¼</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Cat</span>;     <span class="hljs-comment">// æ‰‹åŠ¨ä¿®å¤ constructor</span>
</code></pre>
<p>ä¼˜ç‚¹ï¼šèƒ½ç»§æ‰¿åŸå‹ä¸Šçš„æ–¹æ³•<br/>
ç¼ºç‚¹ï¼šæ‰€æœ‰å®ä¾‹å…±äº«çˆ¶ç±»å®ä¾‹çš„å¼•ç”¨å±æ€§ï¼ˆå¤§å‘ï¼ï¼‰</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">habits</span> = [<span class="hljs-string">'sleep'</span>];
<span class="hljs-keyword">const</span> cat1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>();
<span class="hljs-keyword">const</span> cat2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>();
cat1.<span class="hljs-property">habits</span>.<span class="hljs-title function_">push</span>(<span class="hljs-string">'eat'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat2.<span class="hljs-property">habits</span>); <span class="hljs-comment">// ["sleep", "eat"] è¢«æ±¡æŸ“äº†ï¼</span>
</code></pre>
<h4 data-id="heading-6">æ–¹å¼ä¸‰ï¼šç›´æ¥ç»§æ‰¿ prototypeï¼ˆå‰¯ä½œç”¨çˆ†ç‚¸ï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>; <span class="hljs-comment">// åƒä¸‡åˆ«å†™ï¼</span>
</code></pre>
<p>åæœï¼šç»™ Cat åŠ æ–¹æ³•ï¼ŒAnimal ä¹Ÿè¢«æ±¡æŸ“äº†ï¼</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">say</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'miao'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">say</span>); <span class="hljs-comment">// ä¹Ÿæœ‰äº†ï¼è¡€æ¡ˆï¼</span>
</code></pre>
<h4 data-id="heading-7">æ–¹å¼å››ï¼šåœ£æ¯æ¨¡å¼ï¼ˆç»å…¸ä¸­é—´å‡½æ•°ï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">inherit</span>(<span class="hljs-params">Child, Parent</span>) {
    <span class="hljs-keyword">const</span> F = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {};
    F.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
    <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">F</span>();
    <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Child</span>;
    <span class="hljs-comment">// å¯é€‰ï¼šä¿ç•™å¯¹çˆ¶ç±»çš„å¼•ç”¨</span>
    <span class="hljs-title class_">Child</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">uber</span> = <span class="hljs-title class_">Parent</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
}

<span class="hljs-title function_">inherit</span>(<span class="hljs-title class_">Cat</span>, <span class="hljs-title class_">Animal</span>);
</code></pre>
<p>è¿™æ˜¯å°¤é›¨æºªï¼ˆVue ä½œè€…ï¼‰å½“å¹´åœ¨è®ºå›é‡Œå­¦çš„ç»å…¸å†™æ³•ï¼Œè‡³ä»Šä»æ˜¯æœ€ä½³å®è·µä¹‹ä¸€ã€‚</p>
<h4 data-id="heading-8">æ–¹å¼äº”ï¼šES6 class extendsï¼ˆç°ä»£å†™æ³•ï¼Œåº•å±‚è¿˜æ˜¯åŸå‹ï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">species</span> = <span class="hljs-string">"åŠ¨ç‰©"</span>;
    }
    <span class="hljs-title function_">eat</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"eating..."</span>);
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, color</span>) {
        <span class="hljs-variable language_">super</span>(); <span class="hljs-comment">// å¿…é¡»å…ˆè°ƒç”¨ super</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
    }
}
</code></pre>
<p>æ³¨æ„ï¼šå­ç±» constructor é‡Œå¿…é¡»å…ˆè°ƒç”¨ super()ï¼Œå¦åˆ™ this ä¼šæŠ¥é”™ï¼</p>
<h4 data-id="heading-9">æ–¹å¼å…­ï¼šç»ˆææ–¹æ¡ˆ â€”â€” ç»„åˆç»§æ‰¿ï¼ˆç”Ÿäº§æ¨èï¼‰</h4>
<p>ç»¼åˆå‰é¢ä¸¤ç§ä¼˜ç‚¹ï¼Œé¿å…æ‰€æœ‰ç¼ºç‚¹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">species</span> = <span class="hljs-string">"åŠ¨ç‰©"</span>;
}
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">eat</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"eating..."</span>);
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, color</span>) {
    <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>);     <span class="hljs-comment">// ç»§æ‰¿å®ä¾‹å±æ€§</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// ç»§æ‰¿åŸå‹</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Cat</span>;

<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">say</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"miao~"</span>);
};
</code></pre>
<p>è¿™å°±æ˜¯ Vue/React æºç é‡ŒçœŸæ­£ä½¿ç”¨çš„ç»§æ‰¿æ–¹å¼ï¼</p>
<h3 data-id="heading-10">å››ã€ç»ˆæå¯¹æ¯”è¡¨ï¼ˆå»ºè®®æ”¶è—ï¼‰</h3>





























































<table><thead><tr><th>æ–¹å¼</th><th>å®ä¾‹å±æ€§</th><th>åŸå‹æ–¹æ³•</th><th>å¼•ç”¨å±æ€§å®‰å…¨</th><th>constructoræ­£ç¡®</th><th>æ¨èæŒ‡æ•°</th></tr></thead><tbody><tr><td>call ç»§æ‰¿</td><td>Yes</td><td>No</td><td>Yes</td><td>Yes</td><td>2æ˜Ÿ</td></tr><tr><td>prototype = new Parent()</td><td>Yes</td><td>Yes</td><td>No</td><td>Need repair</td><td>3æ˜Ÿ</td></tr><tr><td>ç›´æ¥ç»§æ‰¿ prototype</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Need repair</td><td>1æ˜Ÿï¼ˆå‰¯ä½œç”¨å¤ªå¤§ï¼‰</td></tr><tr><td>åœ£æ¯æ¨¡å¼</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>4æ˜Ÿ</td></tr><tr><td>Object.create</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>5æ˜Ÿ</td></tr><tr><td>class extends</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>5æ˜Ÿï¼ˆç°ä»£é¦–é€‰ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-11">äº”ã€ç»§æ‰¿ä¸­æœ€çƒ§è„‘çš„å‡ ä¸ªçŸ¥è¯†ç‚¹</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05b25db2cd90429cb1c416ce73669cd1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LyaanM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765468061&amp;x-signature=OojeanLHaS6%2FqkfVL9axFShd3hw%3D" alt="7371e6c646ae0a7919845d85490c9946.jpg" loading="lazy"/></p>
<h4 data-id="heading-12">1.ç›´æ¥ç»§æ‰¿ prototypeï¼ˆæœ€ä¸¥é‡ã€æœ€å®¹æ˜“è¢«å¿½è§†çš„å‰¯ä½œç”¨ï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {}
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">species</span> = <span class="hljs-string">'åŠ¨ç‰©'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, color</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}

<span class="hljs-comment">// å±é™©å†™æ³•ï¼ï¼ï¼ç›´æ¥æŠŠçˆ¶ç±»çš„ prototype èµ‹å€¼ç»™å­ç±»</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;   <span class="hljs-comment">// â† è¿™é‡Œå°±æ˜¯ç½ªé­ç¥¸é¦–</span>
</code></pre>
<h5 data-id="heading-13">å‰¯ä½œç”¨ä¸€ï¼šå­ç±»ç»™åŸå‹åŠ æ–¹æ³•ï¼Œçˆ¶ç±»ä¹Ÿè¢«æ±¡æŸ“ï¼ˆåŒå‘æ±¡æŸ“ï¼‰</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ç»™ Cat çš„åŸå‹åŠ ä¸€ä¸ªæ–¹æ³•</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">say</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'miao~'</span>);
};

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">say</span>);  
<span class="hljs-comment">// è¾“å‡ºï¼šfunction say() { console.log('miao~') }</span>
<span class="hljs-comment">// ä»€ä¹ˆï¼Ÿï¼Ÿï¼ŸAnimal å®ä¾‹æ€ä¹ˆä¹Ÿä¼šå«äº†ï¼Ÿï¼</span>
</code></pre>
<h5 data-id="heading-14">è¯¦ç»†è¿‡ç¨‹å›¾è§£ï¼š</h5>
<pre><code class="hljs language-javascript" lang="javascript">åŸæ¥çš„ç»“æ„ï¼š
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>      â†’ æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ A
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>    â†’ æŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ B

æ‰§è¡Œ <span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> ä¹‹åï¼š
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>      â†’ æŒ‡å‘å¯¹è±¡ B   â†â”
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>   â†’ æŒ‡å‘å¯¹è±¡ B     â†’ åŒä¸€ä¸ªå¯¹è±¡ï¼
                                    â†‘
                              ä¸¤ä¸ªæ„é€ å‡½æ•°å…±ç”¨åŒä¸€ä¸ªåŸå‹å¯¹è±¡
</code></pre>
<p>æ­¤æ—¶ä½ å¯¹ <code>Cat.prototype</code> åšçš„ä»»ä½•ä¿®æ”¹ï¼Œ<strong>ç­‰åŒäºç›´æ¥ä¿®æ”¹ Animal.prototype</strong>ï¼</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> cat = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'å°é»‘'</span>, <span class="hljs-string">'é»‘è‰²'</span>);
<span class="hljs-keyword">const</span> tiger = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();  <span class="hljs-comment">// è€è™æ˜¯ Animal çš„å®ä¾‹</span>

cat.<span class="hljs-title function_">say</span>();        <span class="hljs-comment">// "miao~"</span>
tiger.<span class="hljs-title function_">say</span>();      <span class="hljs-comment">// "miao~" ï¼ï¼ï¼è€è™ä¹Ÿä¼šçŒ«å«äº†ï¼Œå½»åº•ä¹±å¥—</span>
</code></pre>
<h5 data-id="heading-15">å‰¯ä½œç”¨äºŒï¼šconstructor è¢«å½»åº•æä¹±</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span>);     <span class="hljs-comment">// åŸæ¥åº”è¯¥æ˜¯ Cat</span>
<span class="hljs-comment">// ç»“æœï¼šfunction Animal() {}   â† è¢«è¦†ç›–æˆäº† Animalï¼ï¼</span>

<span class="hljs-comment">// æ‰€æœ‰ Cat å®ä¾‹çš„ constructor ä¹Ÿé”™äº†</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Animal</span>);    <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Cat</span>);       <span class="hljs-comment">// false</span>
</code></pre>
<h5 data-id="heading-16">å‰¯ä½œç”¨ä¸‰ï¼šinstanceof å®Œå…¨å¤±çµ</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Cat</span>);     <span class="hljs-comment">// true  (ä¾¥å¹¸è¿˜å¯¹)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Animal</span>);  <span class="hljs-comment">// true</span>

<span class="hljs-comment">// ä½†æ˜¯å¦‚æœä½ å†å®šä¹‰ä¸€ä¸ª Dog ä¹Ÿè¿™ä¹ˆå¹²ï¼š</span>
<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;
<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Cat</span>);     <span class="hljs-comment">// trueï¼ï¼ï¼ç‹—å±…ç„¶æ˜¯çŒ«çš„å®ä¾‹ï¼Ÿï¼Ÿï¼Ÿ</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Dog</span>);     <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dog <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Animal</span>);  <span class="hljs-comment">// true</span>
</code></pre>
<p>å½»åº•ä¹±å¥—äº†ï¼æ‰€æœ‰ç»§æ‰¿ Animal çš„å­ç±»ä¹‹é—´äº’ç›¸éƒ½æ˜¯ instanceof trueã€‚</p>
<p><strong>ç»“è®ºï¼šç›´æ¥æŠŠ Child.prototype = Parent.prototype æ˜¯ JavaScript ç»§æ‰¿ä¸­çš„â€œæ ¸å¼¹çº§â€é”™è¯¯ï¼Œç»å¯¹ç¦æ­¢ï¼</strong></p>
<h4 data-id="heading-17">2.åŸå‹é“¾ç»§æ‰¿ï¼ˆCat.prototype = new Animal()ï¼‰çš„ç»å…¸å‰¯ä½œç”¨ï¼šå¼•ç”¨ç±»å‹å±æ€§è¢«æ‰€æœ‰å®ä¾‹å…±äº«</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">habits</span> = [<span class="hljs-string">'ç¡è§‰'</span>, <span class="hljs-string">'åƒé¥­'</span>];  <span class="hljs-comment">// æ³¨æ„ï¼šå¼•ç”¨ç±»å‹ï¼</span>
}
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">species</span> = <span class="hljs-string">'åŠ¨ç‰©'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, color</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}

<span class="hljs-comment">// ç»å…¸åŸå‹é“¾ç»§æ‰¿ï¼ˆå¾ˆå¤šäººè¿˜åœ¨ç”¨ï¼‰</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();        <span class="hljs-comment">// â† è¿™é‡Œåˆ›å»ºäº†çˆ¶ç±»å®ä¾‹</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Cat</span>;

<span class="hljs-keyword">const</span> cat1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'å°é»‘'</span>, <span class="hljs-string">'é»‘è‰²'</span>);
<span class="hljs-keyword">const</span> cat2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'å°ç™½'</span>, <span class="hljs-string">'ç™½è‰²'</span>);
</code></pre>
<h5 data-id="heading-18">å‰¯ä½œç”¨ï¼šæ‰€æœ‰çŒ«å…±äº«åŒä¸€ä»½ä¹ æƒ¯åˆ—è¡¨ï¼</h5>
<pre><code class="hljs language-js" lang="js">cat1.<span class="hljs-property">habits</span>.<span class="hljs-title function_">push</span>(<span class="hljs-string">'ç©æ¯›çƒ'</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat1.<span class="hljs-property">habits</span>);  <span class="hljs-comment">// ["ç¡è§‰", "åƒé¥­", "ç©æ¯›çƒ"]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat2.<span class="hljs-property">habits</span>);  <span class="hljs-comment">// ["ç¡è§‰", "åƒé¥­", "ç©æ¯›çƒ"]  â† è¢«æ±¡æŸ“äº†ï¼</span>
</code></pre>
<h5 data-id="heading-19">è¯¦ç»†è¿‡ç¨‹å›¾è§£ï¼š</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>  â† <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>() åˆ›å»ºçš„å®ä¾‹
                  â”‚
                  â”œâ”€â”€ <span class="hljs-attr">species</span>: <span class="hljs-string">"åŠ¨ç‰©"</span> (åŸå‹ä¸Šçš„)
                  â””â”€â”€ <span class="hljs-attr">habits</span>: [<span class="hljs-string">"ç¡è§‰"</span>, <span class="hljs-string">"åƒé¥­"</span>] â† å †å†…å­˜ä¸­çš„åŒä¸€ä¸ªæ•°ç»„ï¼

cat1.<span class="hljs-property">__proto__</span> â†’ <span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> â†’ è¿™ä¸ªå®ä¾‹ â†’ habits æ•°ç»„
cat2.<span class="hljs-property">__proto__</span> â†’ <span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> â†’ åŒä¸€ä¸ªå®ä¾‹ â†’ åŒä¸€ä¸ª habits æ•°ç»„
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a14493043044cb79bc3b40095b1b71e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LyaanM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765468061&amp;x-signature=zVMDon95P0rrxWTElNFrChQsQ0Y%3D" alt="image.png" loading="lazy"/></p>
<p>æ‰€æœ‰ Cat å®ä¾‹çš„ <code>habits</code> æŒ‡å‘çš„æ˜¯ Cat.prototypeï¼ˆå³é‚£ä¸ª Animal å®ä¾‹ï¼‰ä¸Šçš„åŒä¸€ä¸ªæ•°ç»„å¼•ç”¨ï¼</p>
<h5 data-id="heading-20">æ›´éšè”½çš„å‘ï¼šå³ä½¿ä½ ä¸ç›´æ¥è®¿é—® habitsï¼Œä¹Ÿä¼šè¢«æ±¡æŸ“</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">friends</span> = [];
}

<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();

<span class="hljs-keyword">const</span> cat1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'å°é»‘'</span>);
<span class="hljs-keyword">const</span> cat2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>(<span class="hljs-string">'å°ç™½'</span>);

cat1.<span class="hljs-property">friends</span>.<span class="hljs-title function_">push</span>(cat2);  <span class="hljs-comment">// å°é»‘æŠŠå°ç™½åŠ ä¸ºå¥½å‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat2.<span class="hljs-property">friends</span>); <span class="hljs-comment">// [cat2]  å°ç™½å±…ç„¶æ˜¯è‡ªå·±çš„å¥½å‹ï¼Ÿï¼å¾ªç¯å¼•ç”¨ï¼</span>
</code></pre>
<h5 data-id="heading-21">ä¸ºä»€ä¹ˆ constructor éœ€è¦æ‰‹åŠ¨ä¿®å¤ï¼Ÿ</h5>
<p>å› ä¸º <code>new Animal()</code> åˆ›å»ºçš„å®ä¾‹çš„ constructor æ˜¯ Animalï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> temp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(temp.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Animal</span>);  <span class="hljs-comment">// true</span>

<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = temp;
<span class="hljs-comment">// æ‰€ä»¥ Cat.prototype.constructor ç°åœ¨ä¹ŸæŒ‡å‘ Animal äº†ï¼</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Animal</span>); <span class="hljs-comment">// true â† é”™è¯¯ï¼</span>
</code></pre>
<p>ä¸æ‰‹åŠ¨ä¿®å¤çš„è¯ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cat1.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Animal</span>); <span class="hljs-comment">// trueï¼æ˜æ˜æ˜¯ Cat çš„å®ä¾‹</span>
</code></pre>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç»å…¸å†™æ³•ä¸€å®šè¦åŠ è¿™ä¸€è¡Œï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Cat</span>;  <span class="hljs-comment">// å¿…é¡»æ‰‹åŠ¨ä¿®å¤ï¼</span>
</code></pre>
<h4 data-id="heading-22">æ­£ç¡®åšæ³•å¯¹æ¯”ï¼ˆæ¨èçš„ä¸‰ç§ï¼‰</h4>








































<table><thead><tr><th>å†™æ³•</th><th>æ˜¯å¦æœ‰å¼•ç”¨å…±äº«é—®é¢˜</th><th>æ˜¯å¦æ±¡æŸ“çˆ¶ç±»</th><th>constructor æ˜¯å¦æ­£ç¡®</th><th>æ¨èåº¦</th></tr></thead><tbody><tr><td><code>Cat.prototype = Animal.prototype</code></td><td>æ— </td><td>ä¸¥é‡æ±¡æŸ“</td><td>é”™è¯¯</td><td>0æ˜Ÿ</td></tr><tr><td><code>Cat.prototype = new Animal()</code></td><td>æœ‰ï¼ˆçˆ¶ç±»å®ä¾‹å±æ€§ï¼‰</td><td>æ— </td><td>éœ€è¦æ‰‹åŠ¨ä¿®å¤</td><td>3æ˜Ÿ</td></tr><tr><td><code>Cat.prototype = Object.create(Animal.prototype)</code></td><td>æ— </td><td>æ— </td><td>éœ€è¦ä¿®å¤æˆ–ç”¨ defineProperty</td><td>5æ˜Ÿ</td></tr><tr><td><code>class Cat extends Animal</code></td><td>æ— </td><td>æ— </td><td>è‡ªåŠ¨æ­£ç¡®</td><td>5æ˜Ÿ</td></tr></tbody></table>
<h4 data-id="heading-23">ç»ˆææ¨èå†™æ³•ï¼ˆæœç»æ‰€æœ‰å‰¯ä½œç”¨ï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">friends</span> = [];  <span class="hljs-comment">// å³ä½¿çˆ¶ç±»æœ‰å¼•ç”¨ç±»å‹ä¹Ÿæ²¡äº‹</span>
}
<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">species</span> = <span class="hljs-string">'åŠ¨ç‰©'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Cat</span>(<span class="hljs-params">name, color</span>) {
  <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name);                    <span class="hljs-comment">// ç»§æ‰¿å®ä¾‹å±æ€§ï¼ˆå„è‡ªç‹¬ç«‹ï¼‰</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;
}

<span class="hljs-comment">// å…³é”®ï¼šç”¨ Object.create åˆ›å»ºä¸€ä¸ªå¹²å‡€çš„ä¸­é—´å¯¹è±¡</span>
<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-comment">// å®Œç¾ä¿®å¤ constructorï¼ˆæ¨èè¿™ç§ä¸å¯æšä¸¾çš„æ–¹å¼ï¼‰</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-title class_">Cat</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>, <span class="hljs-string">'constructor'</span>, {
  <span class="hljs-attr">value</span>: <span class="hljs-title class_">Cat</span>,
  <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>
});
</code></pre>
<p>è¿™æ ·ï¼š</p>
<ul>
<li>å¼•ç”¨ç±»å‹å±æ€§å„è‡ªç‹¬ç«‹</li>
<li>ä¸æ±¡æŸ“çˆ¶ç±»åŸå‹</li>
<li>constructor æ­£ç¡®</li>
<li>instanceof å®Œå…¨æ­£å¸¸</li>
</ul>
<p>è¿™å°±æ˜¯ Vue 2.x ä¸­ Vue.extendã€React è€ç‰ˆæœ¬ createClass åº•å±‚çœŸæ­£ä½¿ç”¨çš„ç»§æ‰¿æ–¹å¼ï¼</p>
<p><strong>è®°ä½ï¼š</strong></p>
<blockquote>
<p>ç›´æ¥èµ‹å€¼ prototype = çˆ¶ç±»åŸå‹ â†’ æ ¸å¼¹<br/>
new çˆ¶ç±»() å½“åŸå‹ â†’ åœ°é›·<br/>
Object.create + call â†’ å®Œç¾</p>
</blockquote>
<h4 data-id="heading-24">3.ä½ ä¸çŸ¥é“çš„prototypeå’Œ__proto__</h4>
<p>prototypeæ˜¯æ„é€ å‡½æ•°çš„å±æ€§ï¼Œ__proto__æ˜¯å®ä¾‹çš„å±æ€§</p>
<ol>
<li>ä»€ä¹ˆæ—¶å€™ç”¨ prototypeï¼ˆæ„é€ å‡½æ•°å±‚é¢ï¼‰ ä½¿ç”¨åœºæ™¯ï¼šå½“ä½ æƒ³è¦å®šä¹‰æˆ–ä¿®æ”¹æŸä¸ªæ„é€ å‡½æ•°åˆ›å»ºçš„"æ‰€æœ‰å®ä¾‹"çš„å…±äº«å±æ€§å’Œæ–¹æ³•æ—¶</li>
</ol>
<p>text</p>
<pre><code class="hljs language-ini" lang="ini">function Person(name) {
    <span class="hljs-attr">this.name</span> = name<span class="hljs-comment">;</span>
}

// ä½¿ç”¨ prototype - ä¸ºæ‰€æœ‰Personå®ä¾‹æ·»åŠ å…±äº«æ–¹æ³•
<span class="hljs-attr">Person.prototype.sayHello</span> = function() {
    console.log(`Hello, I'm ${this.name}`)<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

<span class="hljs-attr">Person.prototype.species</span> = <span class="hljs-string">'Human'</span><span class="hljs-comment">; // å…±äº«å±æ€§</span>

const <span class="hljs-attr">person1</span> = new Person(<span class="hljs-string">'Alice'</span>)<span class="hljs-comment">;</span>
const <span class="hljs-attr">person2</span> = new Person(<span class="hljs-string">'Bob'</span>)<span class="hljs-comment">;</span>

person1.sayHello()<span class="hljs-comment">; // æ‰€æœ‰å®ä¾‹éƒ½èƒ½è®¿é—®prototypeä¸Šçš„æ–¹æ³•</span>
person2.sayHello()<span class="hljs-comment">;</span>
</code></pre>
<p>å…³é”®ç‚¹ï¼š</p>
<ul>
<li>åªæœ‰å‡½æ•°ï¼ˆæ„é€ å‡½æ•°ï¼‰æ‰æœ‰ prototypeå±æ€§</li>
<li>ç”¨äºè®¾ç½®"è“å›¾"æˆ–"æ¨¡æ¿"</li>
<li>ä¿®æ”¹ä¼šå½±å“æ‰€æœ‰å·²åˆ›å»ºå’Œæœªæ¥åˆ›å»ºçš„å®ä¾‹</li>
</ul>
<ol start="2">
<li>ä»€ä¹ˆæ—¶å€™ç”¨ <strong>proto</strong>ï¼ˆå®ä¾‹å±‚é¢ï¼‰ ä½¿ç”¨åœºæ™¯ï¼šå½“ä½ æƒ³è¦æŸ¥çœ‹æˆ–æ“ä½œæŸä¸ªå…·ä½“å®ä¾‹çš„åŸå‹é“¾æ—¶</li>
</ol>
<p>text</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}

<span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'Alice'</span>);

<span class="hljs-comment">// ä½¿ç”¨ __proto__ - æŸ¥çœ‹æˆ–ä¿®æ”¹è¿™ä¸ªå…·ä½“å®ä¾‹çš„åŸå‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// æ£€æŸ¥åŸå‹é“¾</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person.<span class="hljs-property">__proto__</span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// å®é™…å¼€å‘ä¸­æ›´æ¨èä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(person) === <span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Person</span>); <span class="hljs-comment">// true</span>
</code></pre>
<p>å…³é”®ç‚¹ï¼š</p>
<ul>
<li>æ‰€æœ‰å¯¹è±¡ï¼ˆåŒ…æ‹¬å®ä¾‹ï¼‰éƒ½æœ‰ __proto__å±æ€§</li>
<li>ä¸»è¦ç”¨äºè°ƒè¯•ã€æ£€æŸ¥ç»§æ‰¿å…³ç³»</li>
</ul>
<h4 data-id="heading-25">åŸºäºç¬¬3ç‚¹å¼•å‡ºäº†æœ€çƒ§è„‘çš„ä¸€ä¸ªçŸ¥è¯†ç‚¹</h4>
<p>â€œFunction æ˜¯ç”± Function è‡ªå·± new å‡ºæ¥çš„ï¼Œ Object æ˜¯ç”± Function new å‡ºæ¥çš„ï¼Œ Function.prototype ä¹Ÿæ˜¯ç”± Object new å‡ºæ¥çš„â€¦â€¦ è¿™å°±æ˜¯ä¸€ä¸ªå®Œç¾çš„é¸¡ç”Ÿè›‹è›‹ç”Ÿé¸¡çš„é—­ç¯ï¼â€</p>
<p>çœ‹å®Œè¿™æ®µè¯ä½ è‚¯å®šæ»¡è„¸é—®å·ï¼Ÿè¿™æ˜¯ä¸ªå•¥ï¼Ÿ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8942ba6e8a7449469d5c988e3f931207~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5LyaanM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765468061&amp;x-signature=QAAhBLQrdnCtKEYoV376J2mC1MQ%3D" alt="a8a0956310fbc3378caa4831a0918c2b.jpg" loading="lazy"/>
åˆ«æ€¥ï¼Œæˆ‘ä»¬åªéœ€è¦ç†è§£è¿™<strong>ä¸‰å¥è¯</strong>å°±èƒ½è¯»æ‡‚ï¼š</p>
<ul>
<li>
<p><strong>æ‰€æœ‰å‡½æ•°ï¼ˆåŒ…æ‹¬ Function å’Œ Object è‡ªå·±ï¼‰éƒ½æ˜¯ Function çš„å®ä¾‹</strong> â†’ æ‰€ä»¥å®ƒä»¬çš„ <strong>proto</strong> ç»Ÿç»ŸæŒ‡å‘ Function.prototype</p>
</li>
<li>
<p><strong>Object ä¹Ÿæ˜¯å‡½æ•°ï¼Œæ‰€ä»¥ Object.<strong>proto</strong> === Function.prototype</strong> â†’ è¿™ä¸€æ­¥æŠŠ Object æ‹‰è¿›æ¥äº†</p>
</li>
<li>
<p><strong>Function.prototype è‡ªå·±ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥å®ƒçš„ <strong>proto</strong> å¿…é¡»æŒ‡å‘æ‰€æœ‰å¯¹è±¡çš„ç»ˆç‚¹ â€”â€” Object.prototype</strong> â†’ è¿™ä¸€æ­¥æŠŠ Function.prototype æ¥å›å»ï¼Œé—­ç¯å®Œæˆï¼</p>
</li>
</ul>

<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Function</span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);          <span class="hljs-comment">// true  è‡ªå·±æ˜¯è‡ªå·±çš„çˆ¹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);  <span class="hljs-comment">// true  çˆ¹çš„çˆ¹æ˜¯ Object.prototype</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);            <span class="hljs-comment">// true  Object çš„çˆ¹æ˜¯ Function.prototype</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-literal">null</span>);                <span class="hljs-comment">// true  ç»ˆç‚¹</span>
</code></pre>
<h3 data-id="heading-26">å†™åœ¨æœ€å</h3>
<p>JavaScript çš„ç»§æ‰¿ï¼Œæœ¬è´¨å°±æ˜¯åŸå‹é“¾çš„æ¸¸æˆã€‚<br/>
æŒæ¡äº†åŸå‹é“¾ï¼Œä½ å°±æŒæ¡äº† JavaScript çš„çµé­‚ã€‚</p>
<p>è®°ä½ä¸€å¥è¯ï¼š</p>
<blockquote>
<p>åœ¨ JavaScript ä¸­ï¼Œæ²¡æœ‰ç±»ï¼Œåªæœ‰åŸå‹ã€‚<br/>
class åªæ˜¯è¯­æ³•ç³–ï¼Œextends åªæ˜¯ Object.create çš„ç”œç”œåœˆã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScript ä¸­ this çš„é‚£äº›äº‹å„¿ï¼šä»â€œæŒ‡å“ªæ‰“å“ªâ€åˆ°â€œæˆ‘åˆ°åº•æ˜¯è°ï¼Ÿâ€]]></title>    <link>https://juejin.cn/post/7579813945601327144</link>    <guid>https://juejin.cn/post/7579813945601327144</guid>    <pubDate>2025-12-04T15:50:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579813945601327144" data-draft-id="7579805639435763764" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript ä¸­ this çš„é‚£äº›äº‹å„¿ï¼šä»â€œæŒ‡å“ªæ‰“å“ªâ€åˆ°â€œæˆ‘åˆ°åº•æ˜¯è°ï¼Ÿâ€"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-04T15:50:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ohyeah"/> <meta itemprop="url" content="https://juejin.cn/user/740446536480618"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript ä¸­ this çš„é‚£äº›äº‹å„¿ï¼šä»â€œæŒ‡å“ªæ‰“å“ªâ€åˆ°â€œæˆ‘åˆ°åº•æ˜¯è°ï¼Ÿâ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/740446536480618/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ohyeah
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T15:50:46.000Z" title="Thu Dec 04 2025 15:50:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼ä»Šå¤©æˆ‘ä»¬æ¥èŠä¸€èŠ JavaScript ä¸­é‚£ä¸ªè®©äººåˆçˆ±åˆæ¨ã€ç»å¸¸è®©äººæŠ“ç‹‚çš„å…³é”®è¯ â€”â€” <strong><code>this</code></strong>ã€‚</p>
<p>ä½ æ˜¯ä¸æ˜¯ä¹Ÿæ›¾ç»åœ¨æ§åˆ¶å°çœ‹åˆ° <code>undefined</code> æˆ–è€…æ„å¤–åœ°ä¿®æ”¹äº†å…¨å±€å˜é‡ï¼Œç„¶åä¸€è„¸æ‡µï¼šâ€œè¿™ <code>this</code> åˆ°åº•æŒ‡å‘è°å•Šï¼Ÿâ€åˆ«æ€¥ï¼Œä»Šå¤©æˆ‘ä»¬å°±ç»“åˆå‡ ä¸ªå°ä¾‹å­ï¼Œè½»æ¾æ„‰å¿«åœ°æŠŠ <code>this</code> çš„å„ç§è¡Œä¸ºææ¸…æ¥šï¼</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€<code>this</code> ç”±è°ƒç”¨æ–¹å¼å†³å®š</h2>
<p>å…ˆè¯´ä¸€ä¸ªå…³é”®ç‚¹ï¼š<strong><code>this</code> çš„å€¼ä¸æ˜¯åœ¨å‡½æ•°å®šä¹‰æ—¶ç¡®å®šçš„ï¼Œè€Œæ˜¯åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶æ‰ç¡®å®šçš„ã€‚</strong></p>
<p>æ¢å¥è¯è¯´ï¼Œ<code>this</code> æ˜¯ä¸ªâ€œæ‰§è¡Œæ—¶å˜é‡â€ï¼Œå’Œä½œç”¨åŸŸé“¾ï¼ˆè¯æ³•ä½œç”¨åŸŸï¼‰æ— å…³ã€‚è€Œåƒ <code>myName</code> è¿™æ ·çš„å˜é‡ï¼Œæ˜¯é€šè¿‡<strong>è¯æ³•ä½œç”¨åŸŸ</strong>æŸ¥æ‰¾çš„ï¼Œå±äºâ€œç¼–è¯‘é˜¶æ®µå°±å®šå¥½çš„â€ã€‚</p>
<p>æ¥çœ‹ç¬¬ä¸€ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-meta">'use strict'</span>

<span class="hljs-keyword">var</span> bar = {
  <span class="hljs-attr">myName</span>: <span class="hljs-string">'time.geekbang.com'</span>,
  <span class="hljs-attr">printName</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>){
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(myName)        <span class="hljs-comment">// è‡ªç”±å˜é‡ï¼ŒæŸ¥è¯æ³•ä½œç”¨åŸŸ â†’ å…¨å±€ var myName</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">myName</span>)   <span class="hljs-comment">// this æŒ‡å‘è°ï¼Ÿçœ‹æ€ä¹ˆè°ƒç”¨ï¼</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>)
  }
}

<span class="hljs-keyword">var</span> myName = <span class="hljs-string">'æå®¢é‚¦'</span>
<span class="hljs-keyword">var</span> _printName = <span class="hljs-title function_">foo</span>() <span class="hljs-comment">// è¿”å› bar.printName å‡½æ•°å¼•ç”¨</span>
<span class="hljs-title function_">_printName</span>() <span class="hljs-comment">// æ™®é€šå‡½æ•°è°ƒç”¨ï¼</span>
</code></pre>
<h3 data-id="heading-1">å…³é”®è§£æï¼š</h3>
<ul>
<li>
<p><code>printName</code> è™½ç„¶å†™åœ¨ <code>bar</code> å¯¹è±¡é‡Œï¼Œä½†å®ƒ<strong>æœ¬è´¨ä¸Šæ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸä¸­å®šä¹‰çš„å‡½æ•°</strong>ï¼ˆJS å¯¹è±¡ä¸åˆ›å»ºæ–°ä½œç”¨åŸŸï¼‰ã€‚</p>
</li>
<li>
<p>æ‰€ä»¥ <code>console.log(myName)</code> ä¸­çš„ <code>myName</code> æ˜¯<strong>è‡ªç”±å˜é‡</strong>ï¼Œå¼•æ“ä¼šæ²¿ç€è¯æ³•ä½œç”¨åŸŸå‘å¤–æ‰¾ â†’ æ‰¾åˆ°å…¨å±€çš„ <code>var myName = 'æå®¢é‚¦'</code>ã€‚</p>
</li>
<li>
<p>ä½† <code>this.myName</code> å°±ä¸ä¸€æ ·äº†ï¼<code>this</code> å–å†³äº<strong>è°ƒç”¨æ–¹å¼</strong>ï¼š</p>
<ul>
<li><code>_printName()</code> æ˜¯<strong>æ™®é€šå‡½æ•°è°ƒç”¨</strong> â†’ éä¸¥æ ¼æ¨¡å¼ä¸‹ <code>this === window</code>ï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹ <code>this === undefined</code>ã€‚</li>
<li>æ‰€ä»¥ <code>this.myName</code> åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šæŠ¥é”™ï¼ˆå› ä¸º <code>undefined.myName</code>ï¼‰ï¼›éä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šè¾“å‡º <code>window.myName</code>ï¼Œè€Œ <code>var</code> å£°æ˜çš„å˜é‡ä¼šæŒ‚è½½åˆ° <code>window</code> ä¸Šï¼Œæ‰€ä»¥èƒ½æ‹¿åˆ° <code>'æå®¢é‚¦'</code>ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p>âœ… å°è´´å£«ï¼š<code>let</code> å£°æ˜çš„å˜é‡ä¸ä¼šæŒ‚è½½åˆ° <code>window</code>ï¼Œæ‰€ä»¥å¦‚æœä½ æŠŠ <code>var myName</code> æ”¹æˆ <code>let myName</code>ï¼Œå³ä½¿éä¸¥æ ¼æ¨¡å¼ä¸‹ <code>this.myName</code> ä¹Ÿä¼šæ˜¯ <code>undefined</code>ï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-2">äºŒã€ä½œä¸ºå¯¹è±¡æ–¹æ³•è°ƒç”¨ï¼šè¿™æ‰æ˜¯ <code>this</code> çš„â€œæœ¬èŒå·¥ä½œâ€</h2>
<p>å½“ä½ è¿™æ ·è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">bar<span class="hljs-selector-class">.printName</span>() <span class="hljs-comment">// ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨</span>
</code></pre>
<p>è¿™æ—¶ï¼Œ<code>this</code> å°±ä¼š<strong>æ­£ç¡®æŒ‡å‘ <code>bar</code> å¯¹è±¡</strong>ï¼Œäºæ˜¯ <code>this.myName</code> è¾“å‡º <code>'time.geekbang.com'</code>ã€‚</p>
<p>è¿™å°±æ˜¯ <code>this</code> æœ€å¸¸è§çš„ç”¨é€”ï¼š<strong>åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œè®©æ–¹æ³•èƒ½è®¿é—®æ‰€å±å¯¹è±¡çš„å±æ€§</strong>ã€‚</p>
<p>å¯æƒœçš„æ˜¯ï¼ŒJavaScript çš„è®¾è®¡æœ‰ç‚¹â€œçµæ´»è¿‡å¤´â€â€”â€”å‡½æ•°å¯ä»¥è„±ç¦»å¯¹è±¡å•ç‹¬è°ƒç”¨ï¼Œè¿™æ—¶å€™ <code>this</code> å°±â€œè¿·å¤±è‡ªæˆ‘â€äº†ã€‚</p>
<hr/>
<h2 data-id="heading-3">ä¸‰ã€ä¸¥æ ¼æ¨¡å¼ï¼šç»™ <code>this</code> åŠ ä¸ªâ€œå®‰å…¨é”â€</h2>
<p>æ—©æœŸ JavaScript æœ‰ä¸ªâ€œå·æ‡’â€è®¾è®¡ï¼šæ™®é€šå‡½æ•°è°ƒç”¨æ—¶ï¼Œ<code>this</code> é»˜è®¤æŒ‡å‘å…¨å±€å¯¹è±¡ï¼ˆæµè§ˆå™¨ä¸­æ˜¯ <code>window</code>ï¼‰ï¼Œè™½ç„¶è¯´æ­¤æ—¶thisæ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œä½†æ˜¯å®ƒæ€»å¾—æœ‰è¦æŒ‡å‘çš„ä¸œè¥¿ï¼Œä½œè€…ç›´æ¥è®©thisæŒ‡å‘å…¨å±€äº†ã€‚è¿™å¾ˆå®¹æ˜“é€ æˆ<strong>æ„å¤–æ±¡æŸ“å…¨å±€å˜é‡</strong>ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">function <span class="hljs-built_in">foo</span>() {
  this<span class="hljs-selector-class">.x</span> = <span class="hljs-number">100</span>; <span class="hljs-comment">// å¦‚æœä¸å°å¿ƒè¿™ä¹ˆå†™ï¼Œx å°±æŒ‚åˆ° window ä¸Šäº†ï¼</span>
}
<span class="hljs-built_in">foo</span>(); <span class="hljs-comment">// æ™®é€šè°ƒç”¨ â†’ this = window</span>
</code></pre>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ å¼•å…¥äº† <strong>ä¸¥æ ¼æ¨¡å¼ï¼ˆ<code>'use strict'</code>ï¼‰</strong> ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-meta">'use strict'</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// undefinedï¼</span>
}
<span class="hljs-title function_">foo</span>(); <span class="hljs-comment">// æŠ¥é”™ if you access this.property</span>
</code></pre>
<blockquote>
<p>ğŸ”’ ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œæ™®é€šå‡½æ•°è°ƒç”¨çš„ <code>this</code> æ˜¯ <code>undefined</code>ï¼Œè§„é¿äº†æ²¡å¿…è¦çš„thisæŒ‡å‘ï¼Œé˜²æ­¢æ„å¤–çš„å…¨å±€ç»‘å®šï¼Œæé«˜äº†ä»£ç çš„å®‰å…¨æ€§</p>
</blockquote>
<hr/>
<h2 data-id="heading-4">å››ã€æ‰‹åŠ¨æŒ‡å®š <code>this</code>ï¼š<code>call</code> / <code>apply</code></h2>
<p>æœ‰æ—¶å€™æˆ‘ä»¬æƒ³â€œå¼ºè¡Œâ€è®©æŸä¸ªå‡½æ•°çš„ <code>this</code> æŒ‡å‘ç‰¹å®šå¯¹è±¡ï¼Œæ€ä¹ˆåŠï¼Ÿ</p>
<p>JavaScript æä¾›äº†ä¸¤å¤§æ³•å®(å…¶å®è¿˜æœ‰bindï¼Œæˆ‘ä»¬ä¸‹æ¬¡å†èŠå®ƒ)ï¼š</p>
<ul>
<li><code>func.call(obj, arg1, arg2)</code></li>
<li><code>func.apply(obj, [arg1, arg2])</code></li>
</ul>
<p>çœ‹çœ‹è¿™ä¸ªä¾‹å­:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">let</span> bar = { <span class="hljs-attr">myName</span>: <span class="hljs-string">'æå®¢é‚¦'</span>, <span class="hljs-attr">test1</span>: <span class="hljs-number">1</span> }

<span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">myName</span> = <span class="hljs-string">'æå®¢æ—¶é—´'</span>
}

foo.<span class="hljs-title function_">call</span>(bar) <span class="hljs-comment">// å¼ºåˆ¶ this æŒ‡å‘ bar</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(bar) <span class="hljs-comment">// { myName: 'æå®¢æ—¶é—´', test1: 1 }</span>
</code></pre>
<p>foo.call(bar)è¿™æ®µä»£ç æ˜¯å…³é”®ï¼Œå¼ºåˆ¶æ‰§è¡Œfooå‡½æ•°ï¼Œå¹¶å°†å…¶å†…éƒ¨thiså¼ºè¡ŒæŒ‡å‘bar</p>
<hr/>
<h2 data-id="heading-5">äº”ã€æ„é€ å‡½æ•°ä¸­çš„ <code>this</code>ï¼šæŒ‡å‘æ–°å®ä¾‹</h2>
<p>å†çœ‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">CreateObj</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>) <span class="hljs-comment">// æŒ‡å‘æ–°åˆ›å»ºçš„å®ä¾‹</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'æå®¢æ—¶é—´'</span>
}

<span class="hljs-keyword">var</span> myObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CreateObj</span>()
</code></pre>
<p>å½“ä½¿ç”¨ <code>new</code> è°ƒç”¨å‡½æ•°æ—¶ï¼ŒJavaScript å¼•æ“ä¼šï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ <code>{}</code>ï¼›</li>
<li>æŠŠè¿™ä¸ªå¯¹è±¡çš„ <code>__proto__</code> æŒ‡å‘æ„é€ å‡½æ•°çš„ <code>prototype</code>ï¼›</li>
<li><strong>æŠŠ <code>this</code> ç»‘å®šåˆ°è¿™ä¸ªæ–°å¯¹è±¡</strong>ï¼›</li>
<li>æ‰§è¡Œå‡½æ•°ä½“ï¼›</li>
<li>è¿”å›è¿™ä¸ªå¯¹è±¡ï¼ˆé™¤éä½ æ˜¾å¼ return ä¸€ä¸ªå¯¹è±¡ï¼‰ã€‚</li>
</ol>
<p>æ‰€ä»¥ï¼Œæ„é€ å‡½æ•°é‡Œçš„ <code>this</code> æ°¸è¿œæŒ‡å‘<strong>å³å°†è¢«åˆ›å»ºçš„å®ä¾‹</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-6">å…­ã€äº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„ <code>this</code></h2>
<p>åœ¨ DOM äº‹ä»¶ä¸­ï¼Œ<code>this</code> ä¹Ÿæœ‰ç‰¹æ®Šè§„åˆ™ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"link"</span>&gt;</span>ç‚¹å‡»æˆ‘<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'link'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>) <span class="hljs-comment">// æŒ‡å‘ &lt;a&gt; å…ƒç´ ï¼</span>
  })
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><strong>æ™®é€šå‡½æ•°ä½œä¸ºäº‹ä»¶å¤„ç†å™¨æ—¶ï¼Œ<code>this</code> æŒ‡å‘è§¦å‘äº‹ä»¶çš„ DOM å…ƒç´ ã€‚</strong></p>
<p>ä½†å¦‚æœæ¢æˆç®­å¤´å‡½æ•°ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>) <span class="hljs-comment">// æŒ‡å‘å¤–å±‚ä½œç”¨åŸŸçš„ thisï¼ˆé€šå¸¸æ˜¯ window æˆ– undefinedï¼‰</span>
})
</code></pre>
<p>å› ä¸º<strong>ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ <code>this</code></strong>ï¼Œå®ƒä¼šç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸçš„ <code>this</code>ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨ React ç­‰æ¡†æ¶ä¸­ï¼Œç±»æ–¹æ³•å¸¸ç”¨ç®­å¤´å‡½æ•°é¿å… <code>this</code> ä¸¢å¤±ã€‚</p>
<hr/>
<h2 data-id="heading-7">ä¸ƒã€å¸¸è§è¯¯åŒºæ¾„æ¸…</h2>
<h3 data-id="heading-8">âŒ è¯¯åŒº1ï¼šâ€œè¿”å›å‡½æ•°å°±å½¢æˆé—­åŒ…â€</h3>
<p>çœ‹è¿™æ®µä»£ç ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function">function <span class="hljs-title">foo</span>()</span> {
  <span class="hljs-keyword">let</span> myName = <span class="hljs-string">'æå®¢æ—¶é—´'</span>
  <span class="hljs-keyword">return</span> bar.printName
}
</code></pre>
<p>å¾ˆå¤šäººä»¥ä¸ºè¿™é‡Œå½¢æˆäº†é—­åŒ…ã€‚å…¶å®<strong>æ²¡æœ‰</strong>ï¼å› ä¸º <code>printName</code> å¹¶æ²¡æœ‰å¼•ç”¨ <code>foo</code> å†…éƒ¨çš„ä»»ä½•å˜é‡ã€‚å®ƒçš„è¯æ³•ä½œç”¨åŸŸä»ç„¶æ˜¯<strong>å…¨å±€</strong>ï¼Œæ‰€ä»¥ <code>console.log(myName)</code> æ‰“å°çš„æ˜¯å…¨å±€çš„ <code>'æå®¢é‚¦'</code>ï¼Œè€Œä¸æ˜¯ <code>'æå®¢æ—¶é—´'</code>ã€‚</p>
<blockquote>
<p>âœ… é—­åŒ… = å‡½æ•° + å¼•ç”¨äº†å¤–å±‚å˜é‡ã€‚ç¼ºä¸€ä¸å¯ï¼</p>
</blockquote>
<h3 data-id="heading-9">âŒ è¯¯åŒº2ï¼šâ€œå¯¹è±¡å†…éƒ¨çš„å‡½æ•°æœ‰è‡ªå·±çš„ä½œç”¨åŸŸâ€</h3>
<p>JS ä¸­ï¼Œ<strong>åªæœ‰å‡½æ•°èƒ½åˆ›å»ºä½œç”¨åŸŸ</strong>ï¼Œå¯¹è±¡ <code>{}</code> ä¸ä¼šï¼æ‰€ä»¥ <code>bar.printName</code> çš„ä½œç”¨åŸŸå°±æ˜¯å®ƒè¢«å®šä¹‰çš„åœ°æ–¹ â€”â€” å…¨å±€ã€‚</p>
<hr/>
<h2 data-id="heading-10">å…«ã€æ€»ç»“ï¼š<code>this</code> çš„äº”å¤§ç»‘å®šè§„åˆ™</h2>





























<table><thead><tr><th>è°ƒç”¨æ–¹å¼</th><th><code>this</code> æŒ‡å‘</th></tr></thead><tbody><tr><td>æ™®é€šå‡½æ•°è°ƒç”¨</td><td>å…¨å±€å¯¹è±¡ï¼ˆéä¸¥æ ¼æ¨¡å¼ï¼‰/ <code>undefined</code>ï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰</td></tr><tr><td>å¯¹è±¡æ–¹æ³•è°ƒç”¨</td><td>è¯¥å¯¹è±¡</td></tr><tr><td><code>call</code> / <code>apply</code></td><td>ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šçš„å¯¹è±¡</td></tr><tr><td><code>new</code> æ„é€ å‡½æ•°è°ƒç”¨</td><td>æ–°åˆ›å»ºçš„å®ä¾‹</td></tr><tr><td>DOM äº‹ä»¶å¤„ç†å‡½æ•°</td><td>è§¦å‘äº‹ä»¶çš„å…ƒç´ </td></tr></tbody></table>
<p>è®°ä½ä¸€å¥è¯ï¼š<strong><code>this</code> æŒ‡å‘â€œè°ƒç”¨è€…â€ï¼Œè€Œä¸æ˜¯â€œå®šä¹‰è€…â€</strong> ã€‚</p>
<hr/>
<h2 data-id="heading-11">ç»“è¯­ï¼šå’Œ <code>this</code> å’Œè§£å§ï¼</h2>
<p><code>this</code> çœ‹ä¼¼æ··ä¹±ï¼Œå…¶å®è§„åˆ™å¾ˆæ¸…æ™°ã€‚åªè¦è®°ä½å®ƒçš„æ ¸å¿ƒåŸåˆ™ â€”â€” <strong>ç”±è°ƒç”¨æ–¹å¼å†³å®š</strong>ï¼Œå†é…åˆä¸¥æ ¼æ¨¡å¼ã€ç®­å¤´å‡½æ•°ã€<code>apply</code> ç­‰å·¥å…·ï¼Œä½ å°±èƒ½å®Œå…¨æŒæ§å®ƒã€‚</p>
<p>ä¸‹æ¬¡å†é‡åˆ° <code>this</code> é—®é¢˜ï¼Œä¸å¦¨é—®è‡ªå·±ä¸€å¥ï¼š</p>
<blockquote>
<p>â€œè¿™ä¸ªå‡½æ•°ï¼Œåˆ°åº•æ˜¯<strong>è°</strong>åœ¨è°ƒç”¨å®ƒï¼Ÿâ€</p>
</blockquote>
<p>ç­”æ¡ˆï¼Œå°±åœ¨è°ƒç”¨çš„é‚£ä¸€è¡Œä»£ç é‡Œã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®ä½ å½»åº•ç†æ¸… <code>this</code> çš„è¿·æ€ï¼å¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œæ¬¢è¿ç‚¹èµã€æ”¶è—ã€è½¬å‘ï½ä¹Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ å’Œ <code>this</code> çš„â€œç›¸çˆ±ç›¸æ€â€æ•…äº‹ ğŸ˜„</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[iOS çŸ¥è¯†ç‚¹ - Block è®²è§£]]></title>    <link>https://juejin.cn/post/7579871631095382042</link>    <guid>https://juejin.cn/post/7579871631095382042</guid>    <pubDate>2025-12-04T12:09:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579871631095382042" data-draft-id="7577031454586421275" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="iOS çŸ¥è¯†ç‚¹ - Block è®²è§£"/> <meta itemprop="keywords" content="ç¬”è®°,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-04T12:09:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é½ç”Ÿ1"/> <meta itemprop="url" content="https://juejin.cn/user/942699496080123"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            iOS çŸ¥è¯†ç‚¹ - Block è®²è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/942699496080123/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é½ç”Ÿ1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T12:09:11.000Z" title="Thu Dec 04 2025 12:09:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ ¸å¿ƒæ¦‚å¿µ</h2>
<ul>
<li><strong>æœ¬è´¨</strong>ï¼šå¸¦æœ‰ â€œè‡ªåŠ¨å˜é‡æ•è·åŠŸèƒ½â€ çš„åŒ¿åå‡½æ•°ï¼ˆé—­åŒ…ï¼‰ã€‚</li>
</ul>
<p><strong>Block ä¸å…¶ä»–æ¦‚å¿µçš„å¯¹æ¯”</strong>ï¼š</p>

























<table><thead><tr><th>æ¦‚å¿µ</th><th>ç‰¹ç‚¹</th><th>æ˜¯å¦æ•è·ç¯å¢ƒ</th></tr></thead><tbody><tr><td>C å‡½æ•°æŒ‡é’ˆ</td><td>çº¯å‡½æ•°åœ°å€</td><td>âŒå¦</td></tr><tr><td>Block</td><td>å‡½æ•° + æ•è·çš„ä¸Šä¸‹æ–‡</td><td>âœ…æ˜¯</td></tr><tr><td>Objective-C æ–¹æ³•</td><td>å¯¹è±¡æ–¹æ³•ï¼Œéšå« self</td><td>é€šè¿‡ self é—´æ¥è®¿é—®</td></tr></tbody></table>
<p><strong>ç±»ç»§æ‰¿é“¾</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">NSObject
  â””â”€â”€ NSBlock (ç§æœ‰åŸºç±»)
        â”œâ”€â”€ __NSGlobalBlock__  (å…¨å±€ Block)
        â”œâ”€â”€ __NSStackBlock__   (æ ˆ Block)
        â””â”€â”€ __NSMallocBlock__  (å † Block)
</code></pre>
<p><strong>åŸºæœ¬è¯­æ³•</strong>ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// å®Œæ•´å½¢å¼</span>
è¿”å›å€¼ç±»å‹ (^Blockåç§°)(å‚æ•°ç±»å‹åˆ—è¡¨) = ^è¿”å›å€¼ç±»å‹(å‚æ•°åˆ—è¡¨) {
    <span class="hljs-comment">// å‡½æ•°ä½“</span>
};

<span class="hljs-type">int</span> (^sumBlock)(<span class="hljs-type">int</span>, <span class="hljs-type">int</span>) = ^<span class="hljs-type">int</span> (<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b) {
    <span class="hljs-keyword">return</span> a + b;
};
</code></pre>
<hr/>
<h2 data-id="heading-1">å˜é‡æ•è·æœºåˆ¶</h2>
<p><strong>ä¸‰ç§ Block ç±»å‹</strong></p>





























<table><thead><tr><th>ç±»å‹</th><th>isa æŒ‡å‘</th><th>å­˜å‚¨ä½ç½®</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td><code>__NSGlobalBlock__</code></td><td><code>__NSGlobalBlock__</code>ï¼ˆç±»å¯¹è±¡ï¼‰</td><td>æ•°æ®æ®µï¼ˆå…¨å±€é™æ€åŒºï¼‰</td><td>ä¸æ•è·å¤–éƒ¨å˜é‡ï¼Œç”Ÿå‘½å‘¨æœŸ=è¿›ç¨‹</td></tr><tr><td><code>__NSStackBlock__</code></td><td><code>__NSStackBlock__</code>ï¼ˆç±»å¯¹è±¡ï¼‰</td><td>æ ˆ</td><td>æ•è·å˜é‡ï¼Œéšæ ˆå¸§æ¶ˆäº¡</td></tr><tr><td><code>__NSMallocBlock__</code></td><td><code>__NSMallocBlock__</code>ï¼ˆç±»å¯¹è±¡ï¼‰</td><td>å †</td><td>ä»æ ˆæ‹·è´æ¥ï¼Œå¼•ç”¨è®¡æ•°ç®¡ç†</td></tr></tbody></table>
<h3 data-id="heading-2">ARC ä¸‹è‡ªåŠ¨ copy è§„åˆ™</h3>
<p>åœ¨ <strong>MRC</strong> ä¸‹ï¼Œå¿…é¡»æ‰‹åŠ¨å°†æ ˆ <strong>block</strong> æ‹·è´åˆ°å †ä¸Šã€‚</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">Block_copy</span>(block);
<span class="hljs-built_in">Block_release</span>(block);
</code></pre>
<p>åœ¨ <strong>ARC</strong> ä¸‹ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ® <strong>block</strong> çš„ä½¿ç”¨åœºæ™¯è‡ªåŠ¨å°†æ ˆ <strong>block</strong> æ‹·è´åˆ°å †ä¸Šã€‚</p>
<ul>
<li><strong>è§¦å‘æ¡ä»¶</strong>ï¼š
- èµ‹å€¼ç»™ <code>__strong</code> å˜é‡ï¼Œä¼šè‡ªåŠ¨å°†æ ˆ <strong>block</strong> æ‹·è´åˆ°å †ä¸Šã€‚
- ä½œä¸ºæ–¹æ³•è¿”å›å€¼ï¼Œè‡ªåŠ¨ <strong>copy</strong>ã€‚
- ä½œä¸º <strong>Cocoa API</strong> å›è°ƒå‚æ•° (ä¾‹å¦‚ï¼š<code>dispatch_async</code>)ã€‚
- æ”¾å…¥å®¹å™¨ï¼ˆ<code>NSArray</code>, <code>NSDictionary</code>ï¼‰</li>
</ul>
<p>ä» ğŸ” çœ‹å‡ºï¼Œ<strong>ARC</strong> ä¸‹å¤§éƒ¨åˆ† <strong>block</strong> éƒ½ä¼šå˜æˆ <code>__NSMallocBlock__</code>ï¼Œé‚£ä¹ˆåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ï¼Œä»ç„¶ä¼šæœ‰ <code>__NSStackBlock__</code> å‘¢ï¼Ÿ</p>
<pre><code class="hljs language-objectivec" lang="objectivec"><span class="hljs-comment">// å±€éƒ¨ä½œç”¨åŸŸå†…ï¼Œ[ç›´æ¥è°ƒç”¨] + [æ•è·å¤–éƒ¨å˜é‡] + [ä¸æ»¡è¶³ â€œè§¦å‘æ¡ä»¶â€] çš„ blockã€‚</span>
<span class="hljs-type">void</span> test(<span class="hljs-type">void</span>) {
    <span class="hljs-type">int</span> x = <span class="hljs-number">0</span>;
    
    <span class="hljs-comment">// é»˜è®¤æ˜¯ __strongï¼ˆè§¦å‘æ¡ä»¶ï¼‰ï¼Œæ‰€ä»¥éœ€è¦ç”¨ __weak æˆ– __unsafe_unretained ä¿®é¥°ã€‚ </span>
    __<span class="hljs-keyword">weak</span> <span class="hljs-type">void</span> (^block)(<span class="hljs-type">void</span>) = ^{
        <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@"%d"</span>, x);
    };
}
</code></pre>
<hr/>
<h2 data-id="heading-3">åº•å±‚å®ç°åŸç†</h2>
<p>ä¸¾ä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">void</span>Â <span class="hljs-title">test</span>()</span> {
Â  Â Â <span class="hljs-built_in">int</span>Â a =Â <span class="hljs-number">10</span>;
Â  Â Â __blockÂ <span class="hljs-built_in">int</span>Â b =Â <span class="hljs-number">10</span>;

Â  Â Â <span class="hljs-keyword">void</span>Â (^blk)(<span class="hljs-keyword">void</span>) = ^{
Â  Â  Â  Â Â NSLog(<span class="hljs-string">@"a = %d"</span>, a);
Â  Â  Â  Â Â b +=Â <span class="hljs-number">1</span>;
Â  Â Â };
    
    blk();
}
</code></pre>
<p>ç¼–è¯‘åçš„ç®€åŒ–ç»“æœï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">__main_block_impl_0</span> {
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">__block_impl</span> impl;  <span class="hljs-comment">// block åŸºç¡€ä¿¡æ¯ï¼ˆisaã€FuncPtr ç­‰ï¼‰</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">__main_block_desc_0</span>* Desc;  <span class="hljs-comment">// ç»‘å®š impl.descriptor æŒ‡é’ˆ</span>
    
    <span class="hljs-comment">/// è‡ªåŠ¨æ•è·å˜é‡</span>
    <span class="hljs-type">int</span> a;  <span class="hljs-comment">// æ•è·åˆ°çš„å˜é‡</span>
    <span class="hljs-keyword">struct</span>Â <span class="hljs-title class_">__Block_byref_b</span>Â *b_byref;  <span class="hljs-comment">// æ•è·åˆ°çš„ __block å˜é‡</span>
};
</code></pre>
<ul>
<li><code>block()</code> è°ƒç”¨å®é™…æ˜¯ <code>impl.FuncPtr()</code>ã€‚</li>
</ul>
<h3 data-id="heading-4"><code>__block</code> ä¿®é¥°ç¬¦</h3>
<p>æ™®é€šçš„å˜é‡æ˜¯æ— æ³•åœ¨é—­åŒ…å†…éƒ¨ä¿®æ”¹çš„ï¼ˆåªè¯»ï¼‰ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹å˜é‡ï¼Œéœ€è¦é€šè¿‡ <code>__block</code> ä¿®é¥°æ¥å…±äº«å†…å­˜ã€‚</p>
<p><code>__block</code> å˜é‡ä¼šè¢«åŒ…è£…æˆä¸€ä¸ªç»“æ„ä½“ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">struct</span>Â <span class="hljs-title class_">__Block_byref_x</span>Â {
Â  Â Â <span class="hljs-type">void</span>Â *__isa;
    __Block_byref_x *__forwarding;  <span class="hljs-comment">// ä¿è¯ block copy åˆ°å †åæŒ‡é’ˆä»æŒ‡å‘æœ€æ–°å€¼</span>
Â  Â Â <span class="hljs-type">int</span>Â __flags;
Â  Â Â <span class="hljs-type">int</span>Â __size;
Â  Â Â <span class="hljs-type">int</span>Â x;Â Â Â <span class="hljs-comment">// å®é™…å­˜å‚¨çš„å€¼</span>

};
</code></pre>
<ul>
<li>
<p>å½“ <strong>block</strong> æ•è· <code>__block</code> å˜é‡æ—¶ï¼Œå¹¶ä¸ä¼šç›´æ¥æ‹·è´å˜é‡ <code>a</code> çš„å€¼ï¼Œè€Œæ˜¯ä¼šæ•è· <code>__Block_byref_x*</code>æŒ‡é’ˆï¼Œæ— è®º <strong>block</strong> åœ¨æ ˆ or å †ä¸Šï¼Œè®¿é—®çš„éƒ½æ˜¯åŒä¸€ä¸ªÂ <code>__Block_byref_x</code>Â â†’ ä¿è¯ä¿®æ”¹åŒæ­¥ã€‚</p>
</li>
<li>
<p><strong><code>__forwarding</code> æŒ‡é’ˆä½œç”¨</strong></p>
<ul>
<li>å½“ <strong>block</strong> ä»æ ˆæ‹·è´åˆ°å †æ—¶ï¼š
<ul>
<li><code>__Block_byref_x</code> æœ¬èº«ä¹Ÿä¼šè¢«æ‹·è´åˆ°å †</li>
<li><code>__forwarding</code> æŒ‡é’ˆæ›´æ–°ä¸ºå †ä¸Šçš„æ–°åœ°å€</li>
</ul>
</li>
<li><strong>block</strong> å†…è®¿é—® x çš„æ–¹å¼ï¼š</li>
</ul>
<pre><code class="hljs language-rust" lang="rust">Block <span class="hljs-punctuation">-&gt;</span> __Block_byref_x <span class="hljs-punctuation">-&gt;</span> forwarding <span class="hljs-punctuation">-&gt;</span> x += <span class="hljs-number">1</span>;
</code></pre>
</li>
</ul>
<h3 data-id="heading-5">block ç¼–è¯‘ç»“æœç¤ºä¾‹</h3>
<p>ä¸¾ä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">void</span>Â <span class="hljs-title">test</span>()</span> {
Â  Â Â <span class="hljs-built_in">int</span>Â a =Â <span class="hljs-number">10</span>;
Â  Â Â __blockÂ <span class="hljs-built_in">int</span>Â b =Â <span class="hljs-number">10</span>;

Â  Â Â <span class="hljs-keyword">void</span>Â (^blk)(<span class="hljs-keyword">void</span>) = ^{
Â  Â  Â  Â Â NSLog(<span class="hljs-string">@"a = %d"</span>, a);
Â  Â  Â  Â Â b +=Â <span class="hljs-number">1</span>;
Â  Â Â };
    
    blk();
}
</code></pre>
<p>ç¼–è¯‘åå…¨éƒ¨çš„å±•å¼€ç»“æœï¼š</p>
<pre><code class="hljs language-perl" lang="perl">//<span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span>
//<span class="hljs-regexp">/ 0ï¸âƒ£__block ä¿®é¥°çš„ b
/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/
structÂ __Block_byref_bÂ {
Â  Â Â voidÂ *__isa;
Â  Â Â structÂ __Block_byref_bÂ *__forwarding;
Â  Â Â intÂ __flags;
Â  Â Â intÂ __size;
Â  Â Â intÂ b;Â Â /</span><span class="hljs-regexp">/ å®é™…å€¼
};

/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/
/</span><span class="hljs-regexp">//</span> <span class="hljs-number">1</span>ï¸âƒ£Block ç»“æ„ä½“
//<span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span>
struct __main_block_impl_<span class="hljs-number">0</span> {
    struct __block_impl impl;  <span class="hljs-regexp">//</span> block åŸºç¡€ä¿¡æ¯ï¼ˆisaã€FuncPtr ç­‰ï¼‰
    struct __main_block_desc_<span class="hljs-number">0</span>* Desc;  <span class="hljs-regexp">//</span> ç»‘å®š impl.descriptor æŒ‡é’ˆ
    
    //<span class="hljs-regexp">/ è‡ªåŠ¨æ•è·å˜é‡
    int a;  /</span><span class="hljs-regexp">/ æ•è·åˆ°çš„å˜é‡
    structÂ __Block_byref_bÂ *b_byref;  /</span><span class="hljs-regexp">/ æ•è·åˆ°çš„ __block å˜é‡
};

/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/
/</span><span class="hljs-regexp">//</span> <span class="hljs-number">2</span>ï¸âƒ£_block_impl å±•å¼€
//<span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span>
structÂ __block_implÂ {
Â  Â Â voidÂ *isa;Â  Â  Â Â <span class="hljs-regexp">//</span> æŒ‡å‘ __NSStackBlock_<span class="hljs-number">_</span>/__NSMallocBlock_<span class="hljs-number">_</span>/__NSGlobalBlock_<span class="hljs-number">_</span>
Â  Â Â <span class="hljs-keyword">int</span>Â flags;Â  Â  Â Â <span class="hljs-regexp">//</span> æ ‡å¿—ä½ï¼Œæ¯”å¦‚æ˜¯å¦æ˜¯ __blockã€æ˜¯å¦æ•è·å¯¹è±¡
Â  Â Â <span class="hljs-keyword">int</span>Â reserved;Â Â Â <span class="hljs-regexp">//</span> ä¿ç•™å­—æ®µ
Â  Â Â voidÂ (*invoke)(voidÂ *, ...);Â <span class="hljs-regexp">//</span> block çš„æ‰§è¡Œå‡½æ•°æŒ‡é’ˆ
Â  Â Â structÂ __block_descriptorÂ *descriptor;Â <span class="hljs-regexp">//</span> æè¿°ä¿¡æ¯ï¼ˆsize, copy, disposeï¼‰

};

<span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span>
//<span class="hljs-regexp">/ 3ï¸âƒ£__block_descriptor å±•å¼€
/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/
structÂ __block_descriptorÂ {
Â  Â Â unsignedÂ longÂ reserved;Â Â  Â  Â  Â  Â  Â  Â  Â     Â Â /</span><span class="hljs-regexp">/ ä¿ç•™å­—æ®µ
Â  Â Â unsignedÂ longÂ size;Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â     Â Â /</span><span class="hljs-regexp">/ block æ€»å¤§å°ï¼ˆimpl + æ•è·å˜é‡ï¼‰
Â  Â Â voidÂ (*copy_helper)(voidÂ *dst,Â voidÂ *src);Â Â Â /</span><span class="hljs-regexp">/ copy æ—¶è°ƒç”¨ï¼Œå¤„ç†å¯¹è±¡ /</span> __block
Â  Â Â voidÂ (*dispose_helper)(voidÂ *src);Â Â  Â  Â  Â  Â Â <span class="hljs-regexp">//</span> é‡Šæ”¾ block æ—¶è°ƒç”¨

};

<span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span>
//<span class="hljs-regexp">/ 4ï¸âƒ£__main_block_desc_0 å±•å¼€
/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/
structÂ __main_block_desc_0Â {
Â  Â Â unsignedÂ longÂ reserved;
Â  Â Â unsignedÂ longÂ size;
Â  Â Â voidÂ (*copy_helper)(voidÂ *dst,Â voidÂ *src);
Â  Â Â voidÂ (*dispose_helper)(voidÂ *src);
};

/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/
/</span><span class="hljs-regexp">//</span> <span class="hljs-number">5</span>ï¸âƒ£block æ‰§è¡Œå‡½æ•°ä¼ªä»£ç 
//<span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span>
voidÂ __main_block_invoke(structÂ __main_block_impl_<span class="hljs-number">0</span> *blk) {
    <span class="hljs-regexp">//</span> a æ˜¯æŒ‰å€¼æ‹·è´
Â  Â Â <span class="hljs-keyword">int</span>Â a = blk-&gt;a;
Â  Â Â <span class="hljs-keyword">printf</span>(<span class="hljs-string">"a = %d\n"</span>, a);

Â  Â Â <span class="hljs-regexp">//</span> b æ˜¯ __block å˜é‡ï¼Œé€šè¿‡ forwarding ä¿®æ”¹
Â  Â Â structÂ __Block_byref_bÂ *bÂ = blk-&gt;b_byref-&gt;forwarding;
Â  Â Â b-&gt;b +=Â <span class="hljs-number">1</span>;
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¢è¯•å®˜ï¼šå¤§æ¨¡å‹ä¸­çš„å¹»è§‰æœ¬è´¨åŸå› æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•é€šè¿‡è®­ç»ƒæˆ–æ¨ç†æ‰‹æ®µæŠ‘åˆ¶ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7579832186880065586</link>    <guid>https://juejin.cn/post/7579832186880065586</guid>    <pubDate>2025-12-04T11:34:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579832186880065586" data-draft-id="7579798332778151945" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¢è¯•å®˜ï¼šå¤§æ¨¡å‹ä¸­çš„å¹»è§‰æœ¬è´¨åŸå› æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•é€šè¿‡è®­ç»ƒæˆ–æ¨ç†æ‰‹æ®µæŠ‘åˆ¶ï¼Ÿ"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2025-12-04T11:34:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="coting"/> <meta itemprop="url" content="https://juejin.cn/user/933911964427818"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¢è¯•å®˜ï¼šå¤§æ¨¡å‹ä¸­çš„å¹»è§‰æœ¬è´¨åŸå› æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•é€šè¿‡è®­ç»ƒæˆ–æ¨ç†æ‰‹æ®µæŠ‘åˆ¶ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/933911964427818/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    coting
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T11:34:22.000Z" title="Thu Dec 04 2025 11:34:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>é¢è¯•å®˜ï¼š<strong>ä½ è§‰å¾—å¤§æ¨¡å‹çš„å¹»è§‰ï¼ˆHallucinationï¼‰æ˜¯æ€ä¹ˆäº§ç”Ÿçš„ï¼Ÿèƒ½ä¸èƒ½ä»åŸç†ä¸Šè®²è®²ï¼Ÿé‚£æˆ‘ä»¬åˆè¯¥å¦‚ä½•å»æŠ‘åˆ¶ï¼Ÿ</strong></p>
<p>åˆ«å°çœ‹è¿™é—®é¢˜ï¼Œå‡ ä¹æ‰€æœ‰å¤§æ¨¡å‹éƒ½è¢«å¹»è§‰å›°æ‰°â€”â€”ä» ChatGPT åˆ°å¤šæ¨¡æ€æ¨¡å‹ï¼Œæ²¡æœ‰ä¸€ä¸ªèƒ½é€ƒå¾—äº†ã€‚</p>
<p>æ‰€æœ‰ç›¸å…³æºç ç¤ºä¾‹ã€æµç¨‹å›¾ã€æ¨¡å‹é…ç½®ä¸çŸ¥è¯†åº“æ„å»ºæŠ€å·§ï¼Œæˆ‘ä¹Ÿå°†æŒç»­æ›´æ–°åœ¨Githubï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Faicoting%2FAIHub" target="_blank" title="https://github.com/aicoting/AIHub" ref="nofollow noopener noreferrer"><strong>AIHub</strong></a>ï¼Œæ¬¢è¿å…³æ³¨æ”¶è—ï¼</p>
<h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯å¹»è§‰ï¼Ÿ</h2>
<p>åœ¨å¤§æ¨¡å‹è¯­å¢ƒä¸‹ï¼Œâ€œå¹»è§‰â€æŒ‡çš„æ˜¯<strong>æ¨¡å‹ç”Ÿæˆçš„å†…å®¹è™½ç„¶è¯­è¨€ä¸Šè¿è´¯ã€é€»è¾‘é€šé¡ºï¼Œä½†ä¸äº‹å®ä¸ç¬¦ã€‚</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/517cc3e7f7e14959ba68f4083c1eb554~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765452862&amp;x-signature=uCE7%2FO1oE2oRcttj9%2F3Xii2WFyQ%3D" alt="" loading="lazy"/></p>
<p>æ¯”å¦‚ï¼š</p>
<ul>
<li>æ¨¡å‹ç¼–é€ ä¸å­˜åœ¨çš„è®ºæ–‡ï¼›</li>
<li>æ¨¡å‹å‡­ç©ºè™šæ„æ•°æ®ã€ä»£ç ï¼›</li>
<li>æ¨¡å‹å›ç­”é—®é¢˜æ—¶â€œè‡ªä¿¡åœ°èƒ¡è¯´å…«é“â€ã€‚</li>
</ul>
<p>æœ¬è´¨ä¸Šï¼Œè¿™æ˜¯ä¸€ç§<strong>æ¨¡å‹ç”Ÿæˆåç¦»çœŸå®è¯­ä¹‰ç©ºé—´</strong>çš„ç°è±¡ã€‚</p>
<h2 data-id="heading-1">äºŒã€å¹»è§‰çš„æœ¬è´¨</h2>
<p>è¦ç†è§£å¹»è§‰ï¼Œå¾—å…ˆå›åˆ°æœ€æœ¬è´¨çš„äº‹å®ï¼š</p>
<p>å¤§æ¨¡å‹ä¸æ˜¯çŸ¥è¯†ç³»ç»Ÿï¼Œè€Œæ˜¯<strong>æ¡ä»¶æ¦‚ç‡ç”Ÿæˆå™¨</strong>ã€‚</p>
<p>åœ¨è‡ªå›å½’æ¡†æ¶ä¸‹ï¼Œè¯­è¨€æ¨¡å‹çš„ç›®æ ‡æ˜¯ï¼š<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/740b3ca256c04315980d3bd2b3cf580e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765452862&amp;x-signature=fp0593Py5UQVC%2FLl8AObOzSN3FM%3D" alt="image" loading="lazy"/></p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¨¡å‹åªå­¦åˆ°äº†â€œä¸‹ä¸€ä¸ªè¯çš„æ¦‚ç‡åˆ†å¸ƒâ€ï¼Œå®ƒå¹¶ä¸çœŸæ­£â€œçŸ¥é“â€äº‹å®æ˜¯å¦çœŸå®ã€‚</p>
<p>æ‰€ä»¥ï¼Œå½“è¯­å¢ƒä¸å……åˆ†ã€åˆ†å¸ƒå¤–æ ·æœ¬å‡ºç°ã€æˆ–æ¦‚ç‡æ··ä¹±æ—¶ï¼Œæ¨¡å‹å°±å¯èƒ½é€‰æ‹©ä¸€ä¸ª<strong>è¯­ä¹‰ä¸Šåˆç†ä½†äº‹å®é”™è¯¯</strong>çš„è¯ã€‚</p>
<p>è¿™ï¼Œå°±æ˜¯å¹»è§‰çš„èµ·ç‚¹ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€ä»ä¸‰å±‚è§†è§’çœ‹å¹»è§‰äº§ç”Ÿçš„æœºåˆ¶</h2>
<h3 data-id="heading-3">è¯­è¨€å±‚é¢ï¼šè®­ç»ƒç›®æ ‡ä¸çœŸå®æ€§é”™ä½</h3>
<p>è¯­è¨€æ¨¡å‹çš„ç›®æ ‡å‡½æ•°æ˜¯æœ€å¤§åŒ–ä¼¼ç„¶ï¼ˆMLEï¼‰ï¼š<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/836e6ed952bb4ddab7cdf12b06101381~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765452862&amp;x-signature=ZAdgxIjTXiqwn9zWBOhJU%2Fvetk8%3D" alt="image" loading="lazy"/></p>
<p>é—®é¢˜æ˜¯ï¼š</p>
<ul>
<li>å®ƒå­¦ä¹ çš„æ˜¯â€œè¡¨è¾¾æ¦‚ç‡â€ï¼Œä¸æ˜¯â€œäº‹å®æ­£ç¡®æ€§â€ï¼›</li>
<li>é«˜ä¼¼ç„¶çš„å¥å­å¾€å¾€æ˜¯â€œå¬èµ·æ¥åˆç†â€çš„å¥å­ï¼›</li>
<li>æ‰€ä»¥æ¨¡å‹ä¼šä¼˜å…ˆè¾“å‡ºè¯­æ³•è¿è´¯çš„å†…å®¹ï¼Œè€ŒéçœŸå®å†…å®¹ã€‚</li>
</ul>
<p>è¯­è¨€æ¨¡å‹è¿½æ±‚çš„æ˜¯<strong>æµç•…æ€§</strong>ï¼Œä¸æ˜¯<strong>çœŸå®æ€§</strong>ã€‚</p>
<h3 data-id="heading-4">è¯­ä¹‰å±‚é¢ï¼šçŸ¥è¯†è¡¨ç¤ºçš„ä¸ç²¾ç¡®æ€§</h3>
<p>å¤§æ¨¡å‹çš„çŸ¥è¯†æ˜¯é€šè¿‡<strong>åˆ†å¸ƒå¼å‘é‡è¡¨ç¤º</strong>ï¼ˆembeddingï¼‰éšå¼å­˜å‚¨çš„ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c7b9548dbfaa4b73a4c06eb80ff955bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765452862&amp;x-signature=N3RT%2BCkleZ1%2FkpOTyhzYW2ZwIig%3D" alt="" loading="lazy"/><br/>
å½“çŸ¥è¯†å…³è”ä¸æ¸…æˆ–ç›¸ä¼¼æ¦‚å¿µæ··å æ—¶ï¼Œå°±ä¼šäº§ç”Ÿâ€œä¼ªè”æƒ³â€ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<p>â€œçˆ±å› æ–¯å¦æå‡ºäº†ç›¸å¯¹è®ºâ€<br/>
â€œç‰›é¡¿æå‡ºäº†ä¸‡æœ‰å¼•åŠ›â€<br/>
æ¨¡å‹å¯èƒ½å­¦åˆ°â€œç‰©ç†å­¦å®¶ + æå‡º + ç†è®ºâ€è¿™ç§ç»Ÿè®¡æ¨¡æ¿ï¼Œäºæ˜¯å½“ä½ é—®â€œçˆ±è¿ªç”Ÿæå‡ºäº†ä»€ä¹ˆç†è®ºï¼Ÿâ€æ—¶ï¼Œå®ƒå°±å¾ˆå¯èƒ½â€œç¼–â€ä¸€ä¸ªã€‚</p>
<p>è¿™ç±»å¹»è§‰æ˜¯<strong>è¡¨ç¤ºç©ºé—´æ··å </strong>çš„ç»“æœã€‚</p>
<h3 data-id="heading-5">æ¨ç†å±‚é¢ï¼šé‡‡æ ·ä¸è§£ç è¿‡ç¨‹çš„åå·®</h3>
<p>ç”Ÿæˆæ—¶ï¼Œå¤§æ¨¡å‹å¹¶ä¸æ˜¯æ¯æ¬¡éƒ½å–æœ€é«˜æ¦‚ç‡è¯ï¼Œè€Œæ˜¯æ ¹æ®ç­–ç•¥é‡‡æ ·ï¼š</p>
<ul>
<li><strong>Greedy Search</strong>ï¼šå®¹æ˜“é™·å…¥å±€éƒ¨æ¨¡å¼ï¼›</li>
<li><strong>Top-k / Top-p Sampling</strong>ï¼šå¯èƒ½é€‰åˆ°â€œè¯­è¨€ä¸Šåˆç†ä½†äº‹å®ä¸å¯¹â€çš„è¯ï¼›</li>
<li><strong>Temperature è¿‡é«˜</strong>ï¼šè¾“å‡ºéšæœºæ€§å¢åŠ ï¼Œå¹»è§‰æ¦‚ç‡ä¸Šå‡ã€‚</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿æ¨¡å‹æœ¬èº«æ¦‚ç‡åˆ†å¸ƒæ²¡é—®é¢˜ï¼Œ<strong>æ¨ç†ç­–ç•¥ä¹Ÿå¯èƒ½äººä¸ºæ”¾å¤§å¹»è§‰ã€‚</strong></p>
<h2 data-id="heading-6">å››ã€ä»è®­ç»ƒè§’åº¦å¦‚ä½•æŠ‘åˆ¶å¹»è§‰ï¼Ÿ</h2>
<p>æŠ‘åˆ¶å¹»è§‰çš„æ ¸å¿ƒæ€æƒ³æ˜¯è®©æ¨¡å‹ä¸åªå­¦ä¹ â€˜è¯­è¨€çš„åˆç†æ€§â€™ï¼Œè€Œè¦å­¦ä¹ â€˜äº‹å®çš„æ­£ç¡®æ€§â€™ã€‚</p>
<p>å¸¸è§è®­ç»ƒå±‚é¢çš„è§£å†³æ€è·¯</p>
<h3 data-id="heading-7">1. å¢å¼ºçŸ¥è¯†ç›‘ç£ï¼ˆKnowledge Groundingï¼‰</h3>
<p>åœ¨é¢„è®­ç»ƒæˆ–å¾®è°ƒé˜¶æ®µå¼•å…¥å¤–éƒ¨çŸ¥è¯†åº“ï¼ˆå¦‚ Wikipediaã€Wikidataã€æ£€ç´¢æ¨¡å—ï¼‰ï¼Œè®©æ¨¡å‹çš„ç”Ÿæˆ<strong>æœ‰äº‹å®æ”¯æ’‘</strong>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e5ecec431404036922bbadd51fc7b1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765452862&amp;x-signature=%2BgMe9BA%2FL4uU2YYLBUPI6OqR7qs%3D" alt="" loading="lazy"/></p>
<p>å…¸å‹åšæ³•ï¼š</p>
<ul>
<li>Retrieval-Augmented Generation (RAG)æ¨¡å‹å…ˆæ£€ç´¢çŸ¥è¯† â†’ å†æ ¹æ®æ£€ç´¢å†…å®¹ç”Ÿæˆï¼›</li>
<li><strong>Atlas, REALM, RETRO</strong> ç­‰æ¶æ„ï¼›</li>
<li><strong>å¤šæ¨¡æ€ Grounding</strong>ï¼šè®©è¯­è¨€ä¸è§†è§‰ã€è¡¨æ ¼ç­‰ä¿¡æ¯ç»‘å®šã€‚</li>
</ul>
<p>çŸ¥è¯†ç›‘ç£å¯ä»¥æœ‰æ•ˆé™ä½äº‹å®æ€§å¹»è§‰ï¼Œä½†æ˜¯æ£€ç´¢è´¨é‡å†³å®šä¸Šé™ã€‚</p>
<h3 data-id="heading-8">2. æŒ‡ä»¤å¯¹é½ï¼ˆInstruction Tuning + RLHFï¼‰</h3>
<p>RLHFï¼ˆReinforcement Learning from Human Feedbackï¼‰æœ¬è´¨ä¸Šå°±æ˜¯è®©æ¨¡å‹å­¦ä¼šâ€œäººè®¤ä¸ºå¯¹çš„å›ç­”æ–¹å¼â€ã€‚</p>
<p>æµç¨‹ï¼š</p>
<ol>
<li>ç”¨äººç±»åé¦ˆè®­ç»ƒå¥–åŠ±æ¨¡å‹ï¼›</li>
<li>ç”¨ PPO ç­‰ç®—æ³•è®©è¯­è¨€æ¨¡å‹ç”Ÿæˆæ›´â€œç¬¦åˆäººæ„â€çš„å†…å®¹ï¼›</li>
<li>å¥–åŠ±æ¨¡å‹ä¼šæƒ©ç½šâ€œè‡ªä¿¡èƒ¡è¯´â€çš„è¾“å‡ºã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/25b8c77682b94d919f1fb63697204b33~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765452862&amp;x-signature=IYs6189o8npK3ZHTeq4qE257bRc%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸€æ­¥å…¶å®ç›¸å½“äº<strong>äº‹å®æ€§ä¸é£æ ¼æ€§çš„è½¯çº¦æŸèåˆ</strong>ã€‚ä½† RLHF å¹¶ä¸èƒ½æ¶ˆç­å¹»è§‰ï¼Œåªæ˜¯è®©å®ƒ<strong>æ›´ä¸å®¹æ˜“è¯´é”™</strong>ã€‚</p>
<h3 data-id="heading-9">3. å¯¹æ¯”å­¦ä¹ ï¼ˆContrastive Fine-tuningï¼‰</h3>
<p>é€šè¿‡æˆå¯¹æ ·æœ¬ï¼ˆæ­£ç¡® vs è™šæ„ï¼‰è¿›è¡Œä¼˜åŒ–ï¼Œè®©æ¨¡å‹å­¦ä¼šåŒºåˆ†çœŸä¼ªã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a9cbe4d9d32b4ed9a1dc84f556762103~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765452862&amp;x-signature=1FMs3mP1MpLw4NdPPmfuBpW3Ngw%3D" alt="" loading="lazy"/><br/>
ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-plain" lang="plain">Input: çˆ±å› æ–¯å¦æå‡ºäº†ä»€ä¹ˆç†è®ºï¼Ÿ
Good: ç›¸å¯¹è®ºã€‚
Bad: é‡å­åŠ›å­¦ã€‚
</code></pre>
<p>æ¨¡å‹é€šè¿‡å¯¹æ¯”å­¦ä¹ ä¼˜åŒ–éšç©ºé—´ï¼Œä½¿â€œæ­£ç¡®è¾“å‡ºâ€é è¿‘ä¸Šä¸‹æ–‡å‘é‡ã€‚</p>
<h3 data-id="heading-10">4. çŸ¥è¯†ç¼–è¾‘ä¸æŒç»­å­¦ä¹ </h3>
<p>å½“æ¨¡å‹å­¦é”™äº‹å®æ—¶ï¼Œå¯ä»¥é€šè¿‡ï¼š</p>
<ul>
<li>Fine-tune å±€éƒ¨å±‚ï¼›</li>
<li>ä½ç§©é€‚é…ï¼ˆLoRAï¼‰å±€éƒ¨æ›´æ–°ï¼›</li>
<li>å‚æ•°ç¼–è¾‘ï¼ˆROME, MEMITï¼‰ç›´æ¥ä¿®æ”¹å†…éƒ¨æƒé‡ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0eacba3ccfc04e53b23f2773d8a8fc57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765452862&amp;x-signature=B7eD9s0JiaIh%2BN%2BkP1usled0HFg%3D" alt="" loading="lazy"/></p>
<p>è¿™ç§æ–¹å¼ç±»ä¼¼â€œçº é”™è®°å¿†â€ï¼Œè®©æ¨¡å‹åœ¨ä¸é—å¿˜æ—§çŸ¥è¯†çš„å‰æä¸‹ä¿®æ­£ç‰¹å®šå¹»è§‰æºã€‚</p>
<h2 data-id="heading-11">äº”ã€ä»æ¨ç†è§’åº¦å¦‚ä½•æŠ‘åˆ¶å¹»è§‰ï¼Ÿ</h2>
<p>è®­ç»ƒèƒ½â€œå‡å°‘â€ï¼Œæ¨ç†æ‰èƒ½â€œæ§åˆ¶â€ã€‚<br/>
å‡ ç§å·¥ç¨‹ä¸Šå¸¸ç”¨çš„æ¨ç†å±‚é¢æŠ€å·§å¦‚ä¸‹</p>
<h3 data-id="heading-12">1. æ£€ç´¢å¢å¼ºæ¨ç†ï¼ˆRAG, RETROï¼‰</h3>
<p>åœ¨æ¨ç†é˜¶æ®µåŠ¨æ€æ£€ç´¢å¤–éƒ¨ä¿¡æ¯ï¼šæ¨¡å‹ä¸å‡­ç©ºç”Ÿæˆï¼Œè€Œæ˜¯å‚è€ƒäº‹å®å†ç”Ÿæˆã€‚<br/>
ç›¸å½“äºè®©æ¨¡å‹è¾¹æŸ¥èµ„æ–™è¾¹å›ç­”ï¼Œè€Œä¸æ˜¯çç¼–ã€‚</p>
<h3 data-id="heading-13">2. Self-consistency / å¤šæ ·æ€§é‡‡æ ·éªŒè¯</h3>
<p>è®©æ¨¡å‹å¤šæ¬¡ç‹¬ç«‹ç”Ÿæˆç­”æ¡ˆï¼Œç„¶åå¯¹ç»“æœæ±‚ä¸€è‡´æ€§ï¼š</p>
<pre><code class="hljs language-plain" lang="plain">é—®ï¼šå¤ªé˜³ç³»ä¸­æœ€å¤§çš„è¡Œæ˜Ÿæ˜¯ä»€ä¹ˆï¼Ÿ
â†’ ç¬¬1æ¬¡ï¼šæœ¨æ˜Ÿ
â†’ ç¬¬2æ¬¡ï¼šæœ¨æ˜Ÿ
â†’ ç¬¬3æ¬¡ï¼šåœŸæ˜Ÿ
</code></pre>
<p>å¦‚æœç­”æ¡ˆä¸ä¸€è‡´ï¼Œåˆ™è§¦å‘â€œå†ç”Ÿæˆæˆ–æ£€ç´¢â€ã€‚<br/>
è¿™åˆ©ç”¨äº†å¤§æ¨¡å‹è‡ªèº«çš„ç»Ÿè®¡ç¨³å®šæ€§æ¥<strong>è‡ªæˆ‘æ ¡éªŒ</strong>ã€‚</p>
<h3 data-id="heading-14">3. Chain-of-Thought + Faithful Reasoning</h3>
<p>åœ¨æ¨ç†æ—¶è®©æ¨¡å‹<strong>æ˜¾å¼åœ°å†™å‡ºæ¨ç†é“¾æ¡ï¼ˆCoTï¼‰</strong>ï¼ŒæŠŠâ€œç›´æ¥ç”Ÿæˆç»“è®ºâ€æ”¹æˆâ€œå…ˆæ¨ç†ï¼Œå†æ€»ç»“â€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/364dd9f8f51345f7b63b0eff82ed2734~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY290aW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765452862&amp;x-signature=Uy%2FfL%2BjjAo5kotSNV0jWtrVErxY%3D" alt="" loading="lazy"/></p>
<p>è¿™æœ‰ä¸¤ä¸ªå¥½å¤„ï¼š</p>
<ul>
<li>æ¨ç†è·¯å¾„é€æ˜ï¼Œå¯æ£€æµ‹é€»è¾‘é”™è¯¯ï¼›</li>
<li>å‡å°‘â€œè·³æ­¥å¼å¹»è§‰â€ã€‚</li>
</ul>
<p>è¿›ä¸€æ­¥çš„æ”¹è¿›æ˜¯ <strong>Faithful CoT</strong>ï¼šå¼•å¯¼æ¨¡å‹åœ¨æ¯ä¸€æ­¥æ¨ç†ä¸­<strong>å¼•ç”¨çœŸå®ä¾æ®</strong>ï¼ˆå¦‚ RAG + CoTï¼‰ã€‚</p>
<h3 data-id="heading-15">4. æ ¡éªŒå‹è§£ç ï¼ˆVerifier / Critic Modelï¼‰</h3>
<p>è®­ç»ƒä¸€ä¸ªå°æ¨¡å‹æˆ–æ¨¡å—ä¸“é—¨åˆ¤æ–­è¾“å‡ºçš„çœŸå®æ€§ï¼Œç±»ä¼¼äºï¼šâ€œä¸»æ¨¡å‹è´Ÿè´£å†™ï¼Œå‰¯æ¨¡å‹è´Ÿè´£æŒ‘é”™ã€‚â€</p>
<p>ä»£è¡¨æ–¹æ¡ˆæœ‰<strong>G-Evalï¼ˆLLM-based Evaluationï¼‰å’ŒCriticGPT / VerifierGPTã€‚</strong></p>
<h3 data-id="heading-16">5. é™ä½é‡‡æ ·æ¸©åº¦ / è°ƒæ•´ top-p</h3>
<p>æ¨ç†æ—¶å¦‚æœæ¸©åº¦ï¼ˆtemperatureï¼‰å¤ªé«˜ï¼Œæ¨¡å‹æ›´å®¹æ˜“â€œæ¢ç´¢â€ï¼Œå¹»è§‰æ¦‚ç‡éšä¹‹ä¸Šå‡ã€‚<br/>
åœ¨çŸ¥è¯†é—®ç­”æˆ–äº‹å®ä»»åŠ¡ä¸­ï¼Œé€šå¸¸ï¼š</p>
<pre><code class="hljs language-plain" lang="plain">temperature = 0.2 ~ 0.4
top_p = 0.8
</code></pre>
<p>èƒ½æœ‰æ•ˆå‡å°‘å¹»è§‰ã€‚</p>
<p>æ€»ç»“ä¸€ä¸‹ï¼Œå¤§æ¨¡å‹çš„å¹»è§‰ä¸æ˜¯æ’’è°ï¼Œè€Œæ˜¯å®ƒåœ¨<strong>ä¸ç¡®å®šä¸‹ä»ç„¶è¦ç”Ÿæˆâ€œæœ€åƒçœŸçš„â€ç­”æ¡ˆ</strong>ã€‚</p>
<p>å®ƒçš„æ ¹æœ¬åŸå› æ˜¯ï¼š</p>
<ul>
<li>è¯­è¨€å»ºæ¨¡ç›®æ ‡ä¸äº‹å®ç›®æ ‡ä¸ä¸€è‡´ï¼›</li>
<li>å‘é‡ç©ºé—´çŸ¥è¯†æ··å ï¼›</li>
<li>æ¨ç†é‡‡æ ·å¸¦æ¥éšæœºåå·®ã€‚</li>
</ul>
<p>è§£å†³çš„æ ¸å¿ƒæ€æƒ³åˆ™æ˜¯â€œè®©æ¨¡å‹æœ‰ä¾æ®åœ°è¯´è¯â€ï¼Œä»<strong>æ¦‚ç‡ç”Ÿæˆ</strong>èµ°å‘<strong>äº‹å®å¯¹é½ï¼ˆfaithful generationï¼‰</strong>ã€‚</p>
<p>å…³äºæ·±åº¦å­¦ä¹ å’Œå¤§æ¨¡å‹ç›¸å…³çš„çŸ¥è¯†å’Œå‰æ²¿æŠ€æœ¯æ›´æ–°ï¼Œè¯·å…³æ³¨å…¬ä¼—å· <strong>coting</strong>ï¼</p>
<p><strong>ğŸ“šæ¨èé˜…è¯»</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1962254381677257759" target="_blank" title="https://zhuanlan.zhihu.com/p/1962254381677257759" ref="nofollow noopener noreferrer">é¢è¯•å®˜ï¼šTransformerå¦‚ä½•ä¼˜åŒ–åˆ°çº¿æ€§çº§ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1962929340292502638" target="_blank" title="https://zhuanlan.zhihu.com/p/1962929340292502638" ref="nofollow noopener noreferrer">é¢è¯•å®˜ï¼šæ¨¡å‹çš„é‡åŒ–äº†è§£å—ï¼Ÿè§£é‡Šä¸€ä¸‹éå¯¹ç§°é‡åŒ–ä¸å¯¹ç§°é‡åŒ–</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1962947114230346375" target="_blank" title="https://zhuanlan.zhihu.com/p/1962947114230346375" ref="nofollow noopener noreferrer">é¢è¯•å®˜ï¼šæ¨¡å‹å‰ªæäº†è§£å—ï¼Ÿè§£é‡Šä¸€ä¸‹ç»“æ„åŒ–å‰ªæä¸éç»“æ„åŒ–å‰ªæ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1963373485435917372" target="_blank" title="https://zhuanlan.zhihu.com/p/1963373485435917372" ref="nofollow noopener noreferrer">é¢è¯•å®˜ï¼šä¸ºä»€ä¹ˆ Adam åœ¨éƒ¨åˆ†ä»»åŠ¡ä¸Šä¼šæ¯” SGD æ”¶æ•›æ›´å¿«ï¼Œä½†æ³›åŒ–æ€§æ›´å·®ï¼Ÿå¦‚ä½•æ”¹è¿›ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1963547933044631464" target="_blank" title="https://zhuanlan.zhihu.com/p/1963547933044631464" ref="nofollow noopener noreferrer">é¢è¯•å®˜ï¼šBatchNormã€LayerNormã€GroupNormã€InstanceNorm æœ‰ä»€ä¹ˆæœ¬è´¨åŒºåˆ«ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1964062982347687219" target="_blank" title="https://zhuanlan.zhihu.com/p/1964062982347687219" ref="nofollow noopener noreferrer">é¢è¯•å®˜ï¼šæ·±å±‚ç½‘ç»œæ¢¯åº¦æ¶ˆå¤±çš„æ ¹æœ¬åŸå› æ˜¯ä»€ä¹ˆï¼Ÿé™¤äº† ResNetï¼Œè¿˜æœ‰å“ªäº›æ¶æ„èƒ½æœ‰æ•ˆç¼“è§£ï¼Ÿ</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI Coding å…¥é—¨æ•™ç¨‹ç³»åˆ—ï¼šä¸€ã€åŸºç¡€å·¥å…·è®¤çŸ¥]]></title>    <link>https://juejin.cn/post/7579811819667259444</link>    <guid>https://juejin.cn/post/7579811819667259444</guid>    <pubDate>2025-12-04T14:03:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579811819667259444" data-draft-id="7579808521204236322" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI Coding å…¥é—¨æ•™ç¨‹ç³»åˆ—ï¼šä¸€ã€åŸºç¡€å·¥å…·è®¤çŸ¥"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-04T14:03:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº”å·å‚æˆ¿"/> <meta itemprop="url" content="https://juejin.cn/user/1731066903142492"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI Coding å…¥é—¨æ•™ç¨‹ç³»åˆ—ï¼šä¸€ã€åŸºç¡€å·¥å…·è®¤çŸ¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1731066903142492/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº”å·å‚æˆ¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T14:03:56.000Z" title="Thu Dec 04 2025 14:03:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>æ•™ç¨‹è¯´æ˜</strong>â€‹</h2>
<p>æœ¬ç³»åˆ—æ•™ç¨‹ä»¥<strong>Traeï¼ˆå­—èŠ‚è·³åŠ¨AIåŸç”ŸIDEï¼‰</strong> ä¸ºæ ¸å¿ƒå·¥å…·ï¼Œé¢å‘<strong>ç¼–ç¨‹é›¶åŸºç¡€/åˆçº§å­¦ä¹ è€…</strong>ï¼Œé€šè¿‡ <strong>â€œå·¥å…·è®¤çŸ¥â†’åŸºç¡€æ“ä½œâ†’å®æˆ˜é¡¹ç›®â€</strong> çš„é˜¶æ¢¯å¼è®¾è®¡ï¼Œå¸®åŠ©å­¦ä¹ è€…åœ¨1-2å‘¨å†…æŒæ¡â€œç”¨AIè¾…åŠ©ç¼–ç¨‹â€çš„æ ¸å¿ƒæŠ€èƒ½ã€‚æ•™ç¨‹æ³¨é‡<strong>å®è·µå¯¼å‘</strong>ï¼Œæ¯ç¯‡å‡åŒ…å«â€œæ“ä½œæ­¥éª¤+æ¡ˆä¾‹æ¼”ç¤º+é¿å‘æŒ‡å—â€ï¼Œç¡®ä¿å­¦ä¹ è€…èƒ½å¿«é€Ÿä¸Šæ‰‹å¹¶å®Œæˆå¯è¿è¡Œçš„é¡¹ç›®ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€Traeå·¥å…·åŸºç¡€è®¤çŸ¥</h2>
<p><strong>ç›®æ ‡</strong>ï¼šç†è§£Traeçš„å®šä½ä¸æ ¸å¿ƒä»·å€¼ï¼Œå®Œæˆå®‰è£…é…ç½®ï¼Œç†Ÿæ‚‰ç•Œé¢å¸ƒå±€ã€‚</p>
<h3 data-id="heading-2"><strong>1.1 ä»€ä¹ˆæ˜¯Traeï¼Ÿâ€”â€”AIç¼–ç¨‹çš„â€œè¶…çº§åŠ©æ‰‹â€</strong> â€‹</h3>
<p>Traeæ˜¯å­—èŠ‚è·³åŠ¨2025å¹´æ¨å‡ºçš„<strong>AIåŸç”Ÿé›†æˆå¼€å‘ç¯å¢ƒï¼ˆAI IDEï¼‰</strong> ï¼Œå®šä½ä¸ºâ€œç¼–ç¨‹è€…çš„æ™ºèƒ½åä½œä¼™ä¼´â€ã€‚å®ƒå°†ä¼ ç»Ÿç¼–ç¨‹è½¯ä»¶ï¼ˆå¦‚VS Codeï¼‰ä¸AIåŠ©æ‰‹æ·±åº¦èåˆï¼Œæ ¸å¿ƒä»·å€¼åœ¨äºï¼š</p>
<ul>
<li><strong>é™ä½é—¨æ§›</strong>ï¼šé€šè¿‡è‡ªç„¶è¯­è¨€å¯¹è¯ç”Ÿæˆä»£ç ï¼Œæ— éœ€è®°å¿†å¤æ‚è¯­æ³•ï¼›</li>
<li><strong>æå‡æ•ˆç‡</strong>ï¼šè‡ªåŠ¨è¡¥å…¨ä»£ç ã€ä¿®å¤Bugã€ä¼˜åŒ–é€»è¾‘ï¼Œå‡å°‘é‡å¤åŠ³åŠ¨ï¼›</li>
<li><strong>ä¸­æ–‡å‹å¥½</strong>ï¼šå®Œæ•´æ”¯æŒç®€ä½“ä¸­æ–‡ç•Œé¢ã€ä¸­æ–‡æ³¨é‡Šè§£æä¸æœ¬åœ°åŒ–äº‘æœåŠ¡ã€‚</li>
</ul>
<p><strong>ä¸€å¥è¯æ€»ç»“</strong>ï¼šTrae = ç¼–ç¨‹è½¯ä»¶ + è¶…çº§AIåŠ©æ‰‹ï¼Œè®©ä½ åœ¨ä¸€ä¸ªå·¥å…·é‡Œå®Œæˆâ€œå†™ä»£ç â†’è°ƒä»£ç â†’è¿è¡Œä»£ç â€çš„å…¨æµç¨‹ã€‚</p>
<h3 data-id="heading-3"><strong>1.2 å®‰è£…ä¸é…ç½®ï¼š3æ­¥æå®šï¼Œæ–°æ‰‹æ— å‹åŠ›</strong>â€‹</h3>
<p>æ­¥éª¤1ï¼šä¸‹è½½å®‰è£…åŒ…</p>
<p>è®¿é—®Traeå®˜ç½‘<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.trae.cn%2F%25E3%2580%2582" target="_blank" title="https://www.trae.cn/%E3%80%82" ref="nofollow noopener noreferrer">www.trae.cn/ã€‚</a>
ç‚¹å‡»â€œä¸‹è½½IDEâ€ï¼Œå®˜ç½‘ä¼šè‡ªåŠ¨æ£€æµ‹ä½ çš„æ“ä½œç³»ç»Ÿï¼ˆæ”¯æŒWindowsã€Macã€Linuxï¼‰ï¼Œæä¾›å¯¹åº”å®‰è£…åŒ…ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c2598da43e9442a7b868ce48bfb50a50~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LqU5Y-35Y6C5oi_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765461836&amp;x-signature=Ty0ghSXR9wPPEX5Qy74nCAg5X%2Fo%3D" alt="image.png" loading="lazy"/></p>
<p>æ­¥éª¤2ï¼šå®‰è£…ä¸åˆå§‹è®¾ç½®</p>
<ul>
<li>åŒå‡»å®‰è£…åŒ…ï¼ŒæŒ‰å‘å¯¼æç¤ºå®Œæˆå®‰è£…ï¼ˆé»˜è®¤è·¯å¾„å³å¯ï¼Œæ— éœ€ä¿®æ”¹ï¼‰ï¼›</li>
<li>é¦–æ¬¡å¯åŠ¨æ—¶ï¼Œé€‰æ‹©<strong>ç®€ä½“ä¸­æ–‡</strong>ä½œä¸ºæ˜¾ç¤ºè¯­è¨€ï¼Œä¸»é¢˜é€‰â€œæš—è‰²â€æˆ–â€œäº®è‰²â€ï¼ˆæ ¹æ®ä¸ªäººä¹ æƒ¯ï¼‰ï¼›</li>
<li>è·³è¿‡â€œä»VS Codeå¯¼å…¥é…ç½®â€ï¼ˆæ–°æ‰‹æ— éœ€æŠ˜è…¾ï¼‰ï¼Œç›´æ¥è¿›å…¥ä¸‹ä¸€æ­¥ã€‚</li>
</ul>
<p>æ­¥éª¤3ï¼šç™»å½•ä¸æ¿€æ´»AIæœåŠ¡</p>
<p>ä½¿ç”¨æ‰‹æœºå·æˆ–ç¨€åœŸæ˜é‡‘è´¦å·ç™»å½•ï¼Œå®Œæˆç™»å½•åå³å¯ä½¿ç”¨Traeçš„AIåŠŸèƒ½ï¼ˆå¦‚ä»£ç ç”Ÿæˆã€æ™ºèƒ½é—®ç­”ï¼‰ã€‚</p>
<h3 data-id="heading-4"><strong>1.3 ç•Œé¢å¸ƒå±€ï¼šè®¤è¯†ä½ çš„â€œAIç¼–ç¨‹å·¥ä½œå°â€</strong> â€‹</h3>
<p>Traeçš„ç•Œé¢è®¾è®¡éµå¾ªâ€œæç®€ä¸»ä¹‰â€ï¼Œæ ¸å¿ƒåŒºåŸŸåˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š</p>
<ul>
<li><strong>å·¦ä¾§ï¼šæ–‡ä»¶èµ„æºç®¡ç†å™¨</strong>ï¼šæ˜¾ç¤ºé¡¹ç›®æ–‡ä»¶å¤¹ç»“æ„ï¼Œå¯å³é”®åˆ›å»º/åˆ é™¤æ–‡ä»¶ï¼›</li>
<li><strong>ä¸­é—´ï¼šä»£ç ç¼–è¾‘åŒº</strong>ï¼šç¼–å†™ä»£ç çš„ä¸»åŒºåŸŸï¼Œæ”¯æŒè¯­æ³•é«˜äº®ã€è‡ªåŠ¨ç¼©è¿›ï¼›</li>
<li><strong>å³ä¾§ï¼šAIåŠ©æ‰‹é¢æ¿</strong>ï¼šä¸AIå¯¹è¯çš„æ ¸å¿ƒåŒºåŸŸï¼Œå¯è¾“å…¥éœ€æ±‚ã€æŸ¥çœ‹ç”Ÿæˆçš„ä»£ç ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c342424810134f44957512b006952ee8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LqU5Y-35Y6C5oi_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765461836&amp;x-signature=r4b4wX43eYx7mMYfXskiJ9NUPOg%3D" alt="image.png" loading="lazy"/></p>
<p><strong>æ–°æ‰‹æç¤º</strong>ï¼šé¦–æ¬¡æ‰“å¼€Traeæ—¶ï¼Œå¯ç‚¹å‡»â€œæ–°å»ºé¡¹ç›®â€ åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ï¼ˆå¦‚â€œmy-first-ai-projectâ€ï¼‰ï¼Œä½œä¸ºä½ çš„ç¬¬ä¸€ä¸ªç»ƒä¹ é¡¹ç›®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86576ec19c6948e49d4c3b9f75885ba2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LqU5Y-35Y6C5oi_:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765461836&amp;x-signature=jhw46dyp4C7u6quJeIu9TZ6CGng%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React 18å¹¶å‘æ¸²æŸ“å®æˆ˜ï¼šè¿™5ä¸ªæ€§èƒ½é™·é˜±è®©æˆ‘æµªè´¹äº†æ•´æ•´ä¸€å‘¨ï¼]]></title>    <link>https://juejin.cn/post/7579813945601458216</link>    <guid>https://juejin.cn/post/7579813945601458216</guid>    <pubDate>2025-12-05T00:16:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579813945601458216" data-draft-id="7579811819667603508" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React 18å¹¶å‘æ¸²æŸ“å®æˆ˜ï¼šè¿™5ä¸ªæ€§èƒ½é™·é˜±è®©æˆ‘æµªè´¹äº†æ•´æ•´ä¸€å‘¨ï¼"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-05T00:16:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React 18å¹¶å‘æ¸²æŸ“å®æˆ˜ï¼šè¿™5ä¸ªæ€§èƒ½é™·é˜±è®©æˆ‘æµªè´¹äº†æ•´æ•´ä¸€å‘¨ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T00:16:52.000Z" title="Fri Dec 05 2025 00:16:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>React 18å¹¶å‘æ¸²æŸ“å®æˆ˜ï¼šè¿™5ä¸ªæ€§èƒ½é™·é˜±è®©æˆ‘æµªè´¹äº†æ•´æ•´ä¸€å‘¨ï¼</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>React 18çš„å¹¶å‘æ¸²æŸ“ï¼ˆConcurrent Renderingï¼‰æ˜¯è¿‘å¹´æ¥Reactç”Ÿæ€ä¸­æœ€å¼•äººæ³¨ç›®çš„ç‰¹æ€§ä¹‹ä¸€ã€‚å®ƒé€šè¿‡å¼•å…¥å¯ä¸­æ–­çš„æ¸²æŸ“æœºåˆ¶ã€è‡ªåŠ¨æ‰¹å¤„ç†ï¼ˆAutomatic Batchingï¼‰å’Œè¿‡æ¸¡æ›´æ–°ï¼ˆTransitionsï¼‰ç­‰èƒ½åŠ›ï¼Œæ˜¾è‘—æå‡äº†åº”ç”¨çš„å“åº”æ€§å’Œç”¨æˆ·ä½“éªŒã€‚ç„¶è€Œï¼Œåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¿™äº›æ–°ç‰¹æ€§ä¹Ÿå¸¦æ¥äº†ä¸å°‘éšè—çš„æ€§èƒ½é™·é˜±ã€‚</p>
<p>åœ¨æœ€è¿‘çš„ä¸€ä¸ªé«˜æ€§èƒ½ä»ªè¡¨ç›˜é¡¹ç›®ä¸­ï¼Œæˆ‘èŠ±äº†æ•´æ•´ä¸€å‘¨æ—¶é—´æ’æŸ¥å’Œä¼˜åŒ–å› å¹¶å‘æ¸²æŸ“å¯¼è‡´çš„æ€§èƒ½é—®é¢˜ã€‚æœ¬æ–‡å°†åˆ†äº«æˆ‘åœ¨å®æˆ˜ä¸­é‡åˆ°çš„5ä¸ªå…³é”®æ€§èƒ½é™·é˜±ï¼Œä»¥åŠå¦‚ä½•é¿å…å®ƒä»¬ã€‚å¦‚æœä½ æ­£åœ¨æˆ–è®¡åˆ’å‡çº§åˆ°React 18ï¼Œè¿™äº›ç»éªŒå¯èƒ½ä¼šä¸ºä½ èŠ‚çœå¤§é‡æ—¶é—´ï¼</p>
<hr/>
<h2 data-id="heading-2">ä¸»ä½“</h2>
<h3 data-id="heading-3">1. <strong>æ»¥ç”¨<code>startTransition</code>å¯¼è‡´çš„æ¸²æŸ“é£æš´</strong></h3>
<p>React 18å¼•å…¥äº†<code>startTransition</code>APIï¼Œç”¨äºå°†éç´§æ€¥æ›´æ–°æ ‡è®°ä¸ºâ€œè¿‡æ¸¡â€ï¼Œä»è€Œé¿å…é˜»å¡ç”¨æˆ·äº¤äº’ã€‚ç„¶è€Œï¼Œè¿‡åº¦ä½¿ç”¨<code>startTransition</code>å¯èƒ½å¯¼è‡´æ„å¤–çš„æ€§èƒ½é—®é¢˜ã€‚</p>
<h4 data-id="heading-4">é—®é¢˜å¤ç°</h4>
<p>åœ¨æˆ‘çš„é¡¹ç›®ä¸­ï¼Œä¸€ä¸ªå®æ—¶æ•°æ®å±•ç¤ºç»„ä»¶æ¯ç§’é’Ÿä¼šæ¥æ”¶å¤šæ¬¡æ•°æ®æ›´æ–°ã€‚ä¸ºäº†â€œä¼˜åŒ–â€æ€§èƒ½ï¼Œæˆ‘å°†æ‰€æœ‰æ•°æ®æ›´æ–°éƒ½åŒ…è£¹åœ¨<code>startTransition</code>ä¸­ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">handleDataUpdate</span>(<span class="hljs-params">newData</span>) {
  <span class="hljs-title function_">startTransition</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">setData</span>(newData);
  });
}
</code></pre>
<p>ç»“æœå‘ç°ï¼Œç»„ä»¶çš„æ¸²æŸ“é¢‘ç‡åè€Œæ›´é«˜äº†ï¼ç”±äºè¿‡æ¸¡æ›´æ–°æ˜¯å¯ä¸­æ–­çš„ï¼ŒReactå¯èƒ½ä¼šå¤šæ¬¡å°è¯•æ¸²æŸ“åŒä¸€æ‰¹æ•°æ®ï¼Œå¯¼è‡´ä¸å¿…è¦çš„è®¡ç®—å’Œé‡ç»˜ã€‚</p>
<h4 data-id="heading-5">è§£å†³æ–¹æ¡ˆ</h4>
<ul>
<li><strong>é€‰æ‹©æ€§ä½¿ç”¨è¿‡æ¸¡</strong>ï¼šä»…å¯¹çœŸæ­£éç´§æ€¥çš„æ›´æ–°ï¼ˆå¦‚ç”¨æˆ·è¾“å…¥æ—¶çš„æœç´¢ç»“æœï¼‰ä½¿ç”¨<code>startTransition</code>ã€‚</li>
<li><strong>ç»“åˆé˜²æŠ–/èŠ‚æµ</strong>ï¼šé«˜é¢‘æ•°æ®æ›´æ–°åº”å…ˆé€šè¿‡é˜²æŠ–æˆ–èŠ‚æµæ§åˆ¶é¢‘ç‡ï¼Œå†è§¦å‘çŠ¶æ€å˜æ›´ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-6">2. <strong>è‡ªåŠ¨æ‰¹å¤„ç†çš„å‰¯ä½œç”¨æœªè¢«æ­£ç¡®å¤„ç†</strong></h3>
<p>React 18é»˜è®¤å¯ç”¨äº†è‡ªåŠ¨æ‰¹å¤„ç†ï¼ˆAutomatic Batchingï¼‰ï¼Œå³åœ¨äº‹ä»¶å¤„ç†å™¨ã€Promiseç­‰ä¸Šä¸‹æ–‡ä¸­å°†å¤šä¸ªçŠ¶æ€æ›´æ–°åˆå¹¶ä¸ºå•ä¸€æ¸²æŸ“ã€‚è¿™ä¸€ç‰¹æ€§è™½ç„¶å‡å°‘äº†ä¸å¿…è¦çš„æ¸²æŸ“æ¬¡æ•°ï¼Œä½†ä¹Ÿå¯èƒ½æ©ç›–å‰¯ä½œç”¨çš„é—®é¢˜ã€‚</p>
<h4 data-id="heading-7">é—®é¢˜å¤ç°</h4>
<p>ä»¥ä¸‹ä»£ç åœ¨React 17ä¸­ä¼šè§¦å‘ä¸¤æ¬¡æ¸²æŸ“ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">const</span> [flag, setFlag] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleClick</span>(<span class="hljs-params"/>) {
  <span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> c + <span class="hljs-number">1</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count); <span class="hljs-comment">// Logsæ—§å€¼</span>
  <span class="hljs-title function_">setFlag</span>(<span class="hljs-function"><span class="hljs-params">f</span> =&gt;</span> !f);
}
</code></pre>
<p>ä½†åœ¨React 18ä¸­åªä¼šè§¦å‘ä¸€æ¬¡æ¸²æŸ“ã€‚å¦‚æœå¼€å‘è€…ä¾èµ–ä¸­é—´çŠ¶æ€ï¼ˆå¦‚<code>console.log(count)</code>ï¼‰ï¼Œå¯èƒ½ä¼šå¾—åˆ°ä¸ç¬¦åˆé¢„æœŸçš„ç»“æœã€‚</p>
<h4 data-id="heading-8">è§£å†³æ–¹æ¡ˆ</h4>
<ul>
<li><strong>æ˜¾å¼æ‹†åˆ†æ‰¹å¤„ç†</strong>ï¼šä½¿ç”¨<code>flushSync</code>å¼ºåˆ¶ç«‹å³æ‰§è¡Œéƒ¨åˆ†æ›´æ–°ï¼š</li>
</ul>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { flushSync } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>;

<span class="hljs-title function_">flushSync</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">setCount</span>(<span class="hljs-function"><span class="hljs-params">c</span> =&gt;</span> c + <span class="hljs-number">1</span>);
});
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count); <span class="hljs-comment">// Now logsæ–°å€¼</span>
</code></pre>
<ul>
<li><strong>é¿å…ä¾èµ–ä¸­é—´çŠ¶æ€</strong>ï¼šé‡æ„é€»è¾‘ä»¥ç¡®ä¿ä¸ä¾èµ–æ‰¹å¤„ç†ä¸­çš„ä¸­é—´å€¼ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-9">3. <strong>Suspenseä¸æ‡’åŠ è½½ç»„ä»¶çš„é‡å¤æŒ‚è½½é—®é¢˜</strong></h3>
<p>å¹¶å‘æ¸²æŸ“ä¸‹ï¼ŒSuspenseçš„è¡Œä¸ºæ›´åŠ åŠ¨æ€ï¼šå½“å­ç»„ä»¶æœªå‡†å¤‡å¥½æ—¶ï¼ŒReactä¼šå…ˆæ˜¾ç¤ºfallback UIï¼›ä¸€æ—¦èµ„æºåŠ è½½å®Œæˆï¼Œå†â€œæ— ç¼â€æ›¿æ¢å†…å®¹ã€‚ç„¶è€Œåœ¨å®é™…åœºæ™¯ä¸­ï¼Œâ€œæ— ç¼â€å¯èƒ½å˜æˆâ€œåå¤æ¨ªè·³â€ã€‚</p>
<h4 data-id="heading-10">é—®é¢˜å¤ç°</h4>
<p>ä»¥ä¸‹ä»£ç åœ¨ä½¿ç”¨åŠ¨æ€å¯¼å…¥æ—¶å¯èƒ½å‡ºç°é—ªçƒï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx">&lt;<span class="hljs-title class_">Suspense</span> fallback={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Loader</span> /&gt;</span></span>}&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LazyComponent</span> /&gt;</span></span>
&lt;/<span class="hljs-title class_">Suspense</span>&gt;
</code></pre>
<p>å¦‚æœç½‘ç»œä¸ç¨³å®šæˆ–èµ„æºè¾ƒå¤§ï¼Œç»„ä»¶å¯èƒ½åœ¨åŠ è½½å®Œæˆå‰è¢«å¤šæ¬¡æŒ‚è½½å’Œå¸è½½ï¼ˆå°¤å…¶æ˜¯åœ¨å¿«é€Ÿå¯¼èˆªçš„åœºæ™¯ï¼‰ã€‚è¿™ä¸ä»…å½±å“ç”¨æˆ·ä½“éªŒè¿˜ä¼šå¢åŠ å†…å­˜å¼€é”€ï¼</p>
<p>####Â è§£å†³æ–¹æ¡ˆÂ Â 
-Â <strong>é¢„åŠ è½½å…³é”®èµ„æº</strong>:Â Â é€šè¿‡æå‰åŠ è½½ç»„ä»¶å‡å°‘Suspenseåˆ‡æ¢é¢‘ç‡:Â Â </p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span>Â <span class="hljs-title class_">LazyComponent</span>Â =Â <span class="hljs-title function_">lazy</span>(<span class="hljs-function">()Â =&gt;</span>Â <span class="hljs-keyword">import</span>(<span class="hljs-string">'./LazyComponent'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">module</span>Â =&gt;</span>Â {Â 
Â Â <span class="hljs-comment">//Â é¢„åŠ è½½é€»è¾‘Â Â </span>
Â Â <span class="hljs-title function_">preloadDependencies</span>();Â 
Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-variable language_">module</span>;Â 
}));Â 
<span class="hljs-string">``</span><span class="hljs-string">`Â Â 
- **åˆå¹¶Suspenseè¾¹ç•Œ**:Â Â å‡å°‘åµŒå¥—å±‚çº§ä»¥é¿å…é¢‘ç¹åˆ‡æ¢ã€‚

---

###4.**useDeferredValueä¸è¾“å…¥å»¶è¿Ÿå¯¼è‡´çš„é™ˆæ—§çŠ¶æ€**

useDeferredValueå…è®¸æˆ‘ä»¬å»¶è¿Ÿæ´¾ç”ŸçŠ¶æ€çš„æ›´æ–°ä»¥ä¼˜å…ˆå¤„ç†ç”¨æˆ·è¾“å…¥â€”â€”å¬èµ·æ¥å¾ˆç¾å¥½ï¼Ÿä½†å¦‚æœå¤„ç†ä¸å½“ä¹Ÿå¯èƒ½å¼•å‘bugï¼

####é—®é¢˜å¤ç°

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæœç´¢æ¡†+ç»“æœåˆ—è¡¨:

</span></code></pre>
<p>const[query,setQuery]=useState('');
const deferredQuery=useDeferredValue(query);</p>

```
<p>å½“ç”¨æˆ·å¿«é€Ÿè¾“å…¥"hello"æ—¶ï¼š
1.queryä¼šç«‹å³å˜ä¸º"h"-&gt;"he"-&gt;..."hello"
2.deferredQueryå¯èƒ½ä»åœç•™åœ¨è¾ƒæ—§å€¼å¦‚"hel"</p>
<p>æ­¤æ—¶è‹¥SearchResultså†…éƒ¨æœ‰ä¾èµ–äºqueryçš„å‰¯ä½œç”¨(å¦‚APIè°ƒç”¨)ï¼Œå°±å¯èƒ½åŸºäºé™ˆæ—§æ•°æ®æ‰§è¡Œ!</p>
<p>####è§£å†³æ–¹æ¡ˆ</p>
<p>-<strong>é…åˆtransitionsä½¿ç”¨</strong>:Â </p>
<pre><code class="hljs language-scss" lang="scss">const<span class="hljs-selector-attr">[query,setQuery]</span>=<span class="hljs-built_in">useState</span>('');
const deferredQuery=<span class="hljs-built_in">useDeferredValue</span>(query);

<span class="hljs-comment">//åªæœ‰æœ€ç»ˆå€¼ä¼šè§¦å‘é«˜å¼€é”€æ“ä½œ</span>
<span class="hljs-built_in">startTransition</span>(()=&gt;{
 Â  <span class="hljs-built_in">runExpensiveOperation</span>(deferredQuery);
});
</code></pre>
<p>-<strong>æ·»åŠ å–æ¶ˆæœºåˆ¶</strong>:ä¸­æ­¢ä»åœ¨è¿›è¡Œä¸­çš„é™ˆæ—§è¯·æ±‚ã€‚</p>
<hr/>
<p>###5.<strong>å¹¶å‘æ¨¡å¼ä¸‹ç¬¬ä¸‰æ–¹åº“çš„ç”Ÿå‘½å‘¨æœŸå†²çª</strong></p>
<p>è®¸å¤šæµè¡Œåº“(å¦‚D3.jsã€Three.js)ç›´æ¥æ“ä½œDOMå¹¶å‡è®¾å¯¹ç»„ä»¶ç”Ÿå‘½å‘¨æœŸæœ‰å®Œå…¨æ§åˆ¶â€”â€”è¿™ä¸å¹¶å‘æ¨¡å¼çš„å¯ä¸­æ–­ç‰¹æ€§ç›¸å†²çª!</p>
<p>####é—®é¢˜å¤ç°</p>
<p>åœ¨ä»ªè¡¨ç›˜é¡¹ç›®ä¸­æˆ‘ä½¿ç”¨äº†D3ç»˜åˆ¶å›¾è¡¨:</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">useEffect</span>(()=&gt;{
 Â  const chart=d3<span class="hljs-selector-class">.select</span>(ref.current)
 Â  Â  <span class="hljs-selector-class">.append</span>('svg')<span class="hljs-comment">//ç›´æ¥æ“ä½œDOM...</span>
},<span class="hljs-selector-attr">[]</span>);
</code></pre>
<p>ä½†åœ¨ä¸¥æ ¼æ¨¡å¼+å¹¶å‘æ¸²æŸ“ä¸‹:
1.Reactå¯èƒ½åœ¨æäº¤é˜¶æ®µå‰å¤šæ¬¡è°ƒç”¨effect
2.D3ä¼šé‡å¤åˆ›å»ºSVGå…ƒç´ å¯¼è‡´å†…å­˜æ³„æ¼!</p>
<p>####è§£å†³æ–¹æ¡ˆ</p>
<p>-<strong>ç¦ç”¨ä¸¥æ ¼æ¨¡å¼</strong>(ä¸æ¨è)
-<strong>å°è£…å‘½ä»¤å¼åº“</strong>:é€šè¿‡ref+cleanupç¡®ä¿å®‰å…¨:</p>
<pre><code class="hljs language-scss" lang="scss">function <span class="hljs-built_in">useD3Chart</span>(){
 const ref=<span class="hljs-built_in">useRef</span>();

 <span class="hljs-built_in">useEffect</span>(()=&gt;{
 Â  const chart=<span class="hljs-built_in">createChart</span>(ref.current);<span class="hljs-comment">//å°è£…åˆ›å»ºé€»è¾‘</span>
 Â  <span class="hljs-built_in">return</span>()=&gt;chart<span class="hljs-selector-class">.destroy</span>();<span class="hljs-comment">//å¿…é¡»æ¸…ç†!</span>
 },<span class="hljs-selector-attr">[]</span>);

 return ref;
}
</code></pre>
<hr/>
<p>##æ€»ç»“</p>
<p>React18çš„å¹¶å‘ç‰¹æ€§å¼€å¯äº†å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„æ–°æ—¶ä»£â€”â€”ä½†ä»»ä½•å¼ºå¤§å·¥å…·éƒ½éœ€è¦æ­£ç¡®ä½¿ç”¨æ‰èƒ½å‘æŒ¥ä»·å€¼!æœ¬æ–‡åˆ†äº«çš„è¿™äº›é™·é˜±åŒ…æ‹¬:</p>
<p>1.startTransitionæ»¥ç”¨å¼•å‘çš„å†—ä½™è®¡ç®—Â 
2.è‡ªåŠ¨æ‰¹å¤„ç†æ©ç›–çš„å‰¯ä½œç”¨ä¾èµ–Â 
3.Suspenseè¾¹ç•Œç®¡ç†ä¸å–„å¯¼è‡´çš„é—ªå±Â 
4.useDeferredValueä¸é™ˆæ—§çŠ¶æ€çš„çŸ›ç›¾Â 
5.ç¬¬ä¸‰æ–¹åº“ä¸å¹¶å‘ç”Ÿå‘½å‘¨æœŸçš„å†²çªÂ </p>
<p>è§£å†³è¿™äº›é—®é¢˜éœ€è¦:
âœ”ï¸æ·±å…¥ç†è§£å¹¶å‘åŸç†è€Œéç®€å•å¥—ç”¨APIÂ 
âœ”ï¸ä¸¥è°¨æµ‹è¯•å„ç§è¾¹ç•Œæ¡ä»¶(ç‰¹åˆ«æ˜¯å¿«é€Ÿäº¤äº’åœºæ™¯)Â 
âœ”ï¸å¿…è¦æ—¶å›é€€åˆ°åŒæ­¥ç­–ç•¥ä¿è¯ç¨³å®šæ€§Â </p>
<p>å¸Œæœ›è¿™ç¯‡å®æˆ˜æ€»ç»“èƒ½å¸®åŠ©ä½ å°‘èµ°å¼¯è·¯!å¦‚æœä½ é‡åˆ°è¿‡å…¶ä»–æœ‰è¶£çš„å¹¶å‘é™·é˜±æ¬¢è¿ç•™è¨€è®¨è®º~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯é¢è¯•é¢˜-JavaScripté«˜çº§ç¯‡]]></title>    <link>https://juejin.cn/post/7579813925996970025</link>    <guid>https://juejin.cn/post/7579813925996970025</guid>    <pubDate>2025-12-05T00:16:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579813925996970025" data-draft-id="7578820431018311695" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯é¢è¯•é¢˜-JavaScripté«˜çº§ç¯‡"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-05T00:16:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="EB_Coder"/> <meta itemprop="url" content="https://juejin.cn/user/3228641967213214"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯é¢è¯•é¢˜-JavaScripté«˜çº§ç¯‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3228641967213214/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    EB_Coder
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T00:16:46.000Z" title="Fri Dec 05 2025 00:16:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ä»¥ä¸‹ä¸ºJavaScripté«˜çº§ç¯‡é¢è¯•è€ƒå¯Ÿç‚¹æ€»ç»“ï¼Œå…·ä½“çŸ¥è¯†ç‚¹ä¸ä¼šå¤ªè¯¦ç»†ï¼Œä¸»è¦æ¢³ç†é¢è¯•æ ¸å¿ƒè€ƒå¯Ÿç‚¹ï¼Œä¸ºé¢è¯•åšå‡†å¤‡ã€‚é«˜çº§JavaScriptå·¥ç¨‹å¸ˆçš„é¢è¯•ä¸å†å±€é™äºAPIçš„ä½¿ç”¨æˆ–å­¤ç«‹çš„çŸ¥è¯†ç‚¹ï¼Œè€Œæ˜¯èšç„¦äºå¯¹è¯­è¨€ã€å¼•æ“ã€ç”Ÿæ€ä»¥åŠè½¯ä»¶å·¥ç¨‹æ€æƒ³çš„ç»¼åˆç†è§£ä¸æŒæ§èƒ½åŠ›ã€‚</p>
</blockquote>
<ul>
<li><a href="https://juejin.cn/post/7578705123209625643" target="_blank" title="https://juejin.cn/post/7578705123209625643">2025å‰ç«¯é¢è¯•é¢˜-JSåŸºç¡€ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7579154364959342611" target="_blank" title="https://juejin.cn/post/7579154364959342611">2025å‰ç«¯é¢è¯•é¢˜-JSä¸­çº§ç¯‡</a></li>
<li><a href="https://juejin.cn/spost/7530179511728930856" target="_blank" title="https://juejin.cn/spost/7530179511728930856">2025å‰ç«¯é¢è¯•é¢˜-TSç†è®ºç¯‡</a></li>
<li><a href="https://juejin.cn/post/7533826195352829988" target="_blank" title="https://juejin.cn/post/7533826195352829988">2025å‰ç«¯é¢è¯•é¢˜-TSå®æˆ˜ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7503111373468893193" target="_blank" title="https://juejin.cn/post/7503111373468893193">2025å‰ç«¯é¢è¯•é¢˜-Vue3åŸºç¡€ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7511568225987051555" target="_blank" title="https://juejin.cn/post/7511568225987051555">2025å‰ç«¯é¢è¯•é¢˜-Vue3è¿›é˜¶ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7503811658198286388" target="_blank" title="https://juejin.cn/post/7503811658198286388">2025å‰ç«¯é¢è¯•é¢˜-ReactåŸºç¡€ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7504545616841965583" target="_blank" title="https://juejin.cn/post/7504545616841965583">2025å‰ç«¯é¢è¯•é¢˜-Reactè¿›é˜¶ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7504926961627054099" target="_blank" title="https://juejin.cn/post/7504926961627054099">2025å‰ç«¯é¢è¯•é¢˜-Reacté«˜é˜¶ç¯‡</a></li>
</ul>
<h2 data-id="heading-0">ä¸€ã€ V8å¼•æ“å·¥ä½œåŸç†ä¸åƒåœ¾å›æ”¶ (GC)</h2>
<p>ç†è§£JavaScriptçš„æ‰§è¡Œç¯å¢ƒæ˜¯é«˜çº§ä¼˜åŒ–çš„å‰æã€‚</p>
<h3 data-id="heading-1"><strong>V8å¼•æ“æ ¸å¿ƒæµç¨‹</strong></h3>
<ol>
<li>
<p><strong>è§£æ (Parsing)</strong> : V8å°†JavaScriptæºä»£ç è§£ææˆ<strong>æŠ½è±¡è¯­æ³•æ ‘ (AST)</strong> ã€‚</p>
</li>
<li>
<p><strong>è§£é‡Š (Interpretation)</strong> : <strong>Ignition</strong> (V8çš„è§£é‡Šå™¨) å°†ASTè½¬æ¢æˆå­—èŠ‚ç å¹¶æ‰§è¡Œã€‚åŒæ—¶ï¼ŒIgnitionä¼šæ”¶é›†åˆ†æä¿¡æ¯ï¼Œç”¨äºåç»­çš„ä¼˜åŒ–ã€‚</p>
</li>
<li>
<p><strong>ç¼–è¯‘ (Compilation)</strong> : å¯¹äºè¢«é¢‘ç¹æ‰§è¡Œçš„ä»£ç ï¼ˆçƒ­ç‚¹ä»£ç ï¼‰ï¼Œ<strong>TurboFan</strong> (V8çš„ä¼˜åŒ–ç¼–è¯‘å™¨) ä¼šä»‹å…¥ï¼Œåˆ©ç”¨åˆ†æä¿¡æ¯å°†å­—èŠ‚ç ç¼–è¯‘æˆé«˜åº¦ä¼˜åŒ–çš„æœºå™¨ç ï¼Œä»¥æå‡æ‰§è¡Œæ•ˆç‡ã€‚è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸º<strong>JIT (Just-In-Time) ç¼–è¯‘</strong>ã€‚å¦‚æœä¼˜åŒ–çš„å‡è®¾å¤±è´¥ï¼ˆå¦‚å‡½æ•°å‚æ•°ç±»å‹æ”¹å˜ï¼‰ï¼Œä¼šè¿›è¡Œ<strong>å»ä¼˜åŒ– (Deoptimization)</strong> ï¼Œå›é€€åˆ°å­—èŠ‚ç æ‰§è¡Œã€‚</p>
</li>
</ol>
<h3 data-id="heading-2"><strong>åƒåœ¾å›æ”¶ (Garbage Collection)</strong></h3>
<p>V8é‡‡ç”¨<strong>åˆ†ä»£å›æ”¶ (Generational Collection)<strong>çš„ç­–ç•¥ï¼Œå°†å †å†…å­˜åˆ†ä¸º</strong>æ–°ç”Ÿä»£ (New Generation)<strong>å’Œ</strong>è€ç”Ÿä»£ (Old Generation)</strong> ã€‚</p>
<h4 data-id="heading-3"><strong>æ–°ç”Ÿä»£ (Scavengerç®—æ³•)</strong></h4>
<ul>
<li>ç©ºé—´å°ï¼Œå­˜æ´»å¯¹è±¡å°‘ã€‚é‡‡ç”¨<strong>Scavenger</strong>ç®—æ³•ï¼Œå°†ç©ºé—´ä¸€åˆ†ä¸ºäºŒï¼ˆFrom-Space å’Œ To-Spaceï¼‰ã€‚</li>
<li>å›æ”¶æ—¶ï¼Œå°†From-Spaceä¸­çš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°To-Spaceï¼Œç„¶åæ¸…ç©ºFrom-Spaceã€‚æœ€åï¼ŒFrom-Spaceå’ŒTo-Spaceè§’è‰²äº’æ¢ã€‚</li>
<li>å¯¹è±¡è‹¥ç»å†å¤šè½®å›æ”¶ä»å­˜æ´»ï¼Œåˆ™è¢«**æ™‹å‡ (Promotion)**åˆ°è€ç”Ÿä»£ã€‚</li>
</ul>
<h4 data-id="heading-4"><strong>è€ç”Ÿä»£</strong></h4>
<ul>
<li>
<p>ç©ºé—´å¤§ï¼Œå­˜æ´»å¯¹è±¡å¤šã€‚é‡‡ç”¨<strong>æ ‡è®°-æ¸…é™¤</strong>ç®—æ³•ã€‚</p>
</li>
<li>
<p><strong>æ ‡è®°é˜¶æ®µ</strong>: ä»æ ¹å¯¹è±¡ï¼ˆå¦‚å…¨å±€å¯¹è±¡ï¼‰å¼€å§‹ï¼Œéå†æ‰€æœ‰å¯è¾¾å¯¹è±¡å¹¶æ‰“ä¸Šæ ‡è®°ã€‚</p>
</li>
<li>
<p><strong>æ¸…é™¤é˜¶æ®µ</strong>: æ¸…é™¤éæ ‡è®°å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ã€‚</p>
</li>
<li>
<p><strong>æ•´ç†é˜¶æ®µ</strong> : ä¸ºè§£å†³å†…å­˜ç¢ç‰‡åŒ–é—®é¢˜ï¼Œåœ¨æ¸…é™¤åï¼Œä¼šå°†æ‰€æœ‰å­˜æ´»å¯¹è±¡å‘ä¸€ç«¯ç§»åŠ¨ï¼Œå½¢æˆè¿ç»­çš„å†…å­˜ç©ºé—´ã€‚</p>
</li>
</ul>
<h4 data-id="heading-5"><strong>ä»£ç ç¤ºä¾‹ (å¯¼è‡´å†…å­˜æ³„æ¼çš„åœºæ™¯):</strong></h4>
<p>é«˜çº§å¼€å‘è€…éœ€è¦èƒ½å¤Ÿè¯†åˆ«å¹¶è§£é‡Šå†…å­˜æ³„æ¼ã€‚é—­åŒ…å¼•ç”¨äº†å·²åˆ†ç¦»çš„DOMèŠ‚ç‚¹æ˜¯å…¸å‹æ¡ˆä¾‹ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createLeakingElement</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'container'</span>);
  <span class="hljs-keyword">const</span> detachedElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
  detachedElement.<span class="hljs-property">textContent</span> = <span class="hljs-string">'This is a potentially leaking element.'</span>;
  container.<span class="hljs-title function_">appendChild</span>(detachedElement);

  <span class="hljs-comment">// å…³é”®ï¼šä¸€ä¸ªå¤–éƒ¨å¯è®¿é—®çš„å‡½æ•°ï¼Œé€šè¿‡é—­åŒ…æŒæœ‰äº†å¯¹ detachedElement çš„å¼•ç”¨</span>
  <span class="hljs-keyword">const</span> leakingClosure = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å³ä½¿ detachedElement ä»DOMæ ‘ä¸­ç§»é™¤ï¼Œåªè¦ leakingClosure å­˜åœ¨ï¼Œ</span>
    <span class="hljs-comment">// detachedElement å°±ä¸ä¼šè¢«GCå›æ”¶ã€‚</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(detachedElement.<span class="hljs-property">textContent</span>);
  };

  <span class="hljs-comment">// ä»DOMä¸­ç§»é™¤å…ƒç´ </span>
  container.<span class="hljs-title function_">removeChild</span>(detachedElement);

  <span class="hljs-comment">// è¿”å›è¿™ä¸ªé—­åŒ…</span>
  <span class="hljs-keyword">return</span> leakingClosure;
}

<span class="hljs-comment">// globalLeaker ç°åœ¨æŒæœ‰äº†å¯¹ detachedElement çš„é—´æ¥å¼•ç”¨</span>
<span class="hljs-comment">// å³ä½¿å®ƒåœ¨DOMä¸­å·²ä¸å¯è§ï¼Œå®ƒä¾ç„¶å­˜åœ¨äºå†…å­˜ä¸­</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-property">globalLeaker</span> = <span class="hljs-title function_">createLeakingElement</span>();

<span class="hljs-comment">// åªè¦ window.globalLeaker ä¸è¢«è®¾ä¸º nullï¼Œè¿™å—å†…å­˜å°±æ°¸è¿œæ— æ³•è¢«å›æ”¶</span>
</code></pre>
<h2 data-id="heading-6">äºŒã€ äº‹ä»¶å¾ªç¯ (Event Loop)</h2>
<p>é«˜çº§é¢è¯•ä¼šæ·±å…¥åˆ°Node.jsç¯å¢ƒï¼Œè€ƒå¯Ÿå¯¹Event Loopå„é˜¶æ®µçš„ç†è§£ã€‚</p>
<ul>
<li>
<p><strong>æµè§ˆå™¨ vs. Node.js</strong>: ä¸¤è€…æ¨¡å‹ç›¸ä¼¼ï¼Œä½†Node.jsçš„äº‹ä»¶å¾ªç¯æœ‰æ›´æ˜ç¡®çš„é˜¶æ®µåˆ’åˆ†ã€‚</p>
</li>
<li>
<p><strong>Node.js äº‹ä»¶å¾ªç¯çš„å…­ä¸ªé˜¶æ®µ</strong>:</p>
<ol>
<li><strong>timers</strong>: æ‰§è¡Œ <code>setTimeout()</code> å’Œ <code>setInterval()</code> çš„å›è°ƒã€‚</li>
<li><strong>pending callbacks</strong>: æ‰§è¡Œä¸Šä¸€è½®å¾ªç¯ä¸­å»¶è¿Ÿåˆ°æœ¬è½®æ‰§è¡Œçš„I/Oå›è°ƒã€‚</li>
<li><strong>idle, prepare</strong>: ä»…å†…éƒ¨ä½¿ç”¨ã€‚</li>
<li><strong>poll</strong>: æ ¸å¿ƒé˜¶æ®µã€‚æ£€ç´¢æ–°çš„I/Oäº‹ä»¶ï¼›æ‰§è¡Œä¸I/Oç›¸å…³çš„å›è°ƒã€‚å¦‚æœé˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œä¼šéå†æ‰§è¡Œï¼›å¦‚æœä¸ºç©ºï¼Œä¼šåœ¨æ­¤é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°æœ‰æ–°çš„I/Oäº‹ä»¶æˆ–åˆ°è¾¾ <code>timers</code> è®¾å®šçš„é˜ˆå€¼ã€‚</li>
<li><strong>check</strong>: æ‰§è¡Œ <code>setImmediate()</code> çš„å›è°ƒã€‚</li>
<li><strong>close callbacks</strong>: æ‰§è¡Œå¦‚ <code>socket.on('close', ...)</code> çš„å›è°ƒã€‚</li>
</ol>
</li>
<li>
<p><strong><code>process.nextTick()</code> ä¸å¾®ä»»åŠ¡ (Micro-task)</strong> :</p>
<ul>
<li><code>process.nextTick()</code> æœ‰è‡ªå·±ç‹¬ç«‹çš„é˜Ÿåˆ—ï¼Œå…¶ä¼˜å…ˆçº§<strong>é«˜äº</strong>æ‰€æœ‰å¾®ä»»åŠ¡ã€‚</li>
<li>åœ¨ä¸€ä¸ªé˜¶æ®µæ‰§è¡Œå®Œæ¯•åï¼Œäº‹ä»¶å¾ªç¯ä¼š<strong>ç«‹å³</strong>æ¸…ç©º <code>nextTick</code> é˜Ÿåˆ—ï¼Œç„¶åæ‰æ¸…ç©ºå¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¹‹åæ‰è¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µã€‚</li>
</ul>
</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹ (Node.jsç¯å¢ƒä¸‹):</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'1. Script Start'</span>);

<span class="hljs-comment">// Timers é˜¶æ®µ</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'7. setTimeout'</span>);
}, <span class="hljs-number">0</span>);

<span class="hljs-comment">// Check é˜¶æ®µ</span>
<span class="hljs-title function_">setImmediate</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'8. setImmediate'</span>);
});

<span class="hljs-comment">// Micro-task</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'5. Promise.then'</span>);
});

<span class="hljs-comment">// process.nextTick é˜Ÿåˆ— (æœ€é«˜ä¼˜å…ˆçº§)</span>
process.<span class="hljs-title function_">nextTick</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'4. process.nextTick'</span>);
});

<span class="hljs-comment">// I/O æ“ä½œï¼Œå…¶å›è°ƒå°†åœ¨ Poll é˜¶æ®µæ‰§è¡Œ</span>
fs.<span class="hljs-title function_">readFile</span>(__filename, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'6. I/O (readFile) callback'</span>);

  <span class="hljs-comment">// I/Oå›è°ƒå†…éƒ¨çš„è°ƒåº¦</span>
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'11. I/O -&gt; setTimeout'</span>), <span class="hljs-number">0</span>);
  <span class="hljs-title function_">setImmediate</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'9. I/O -&gt; setImmediate'</span>));
  process.<span class="hljs-title function_">nextTick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'10. I/O -&gt; nextTick'</span>));
});

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'2. Script End'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'3. Poll phase may start here...'</span>);

<span class="hljs-comment">// ç†è®ºè¾“å‡ºé¡ºåº:</span>
<span class="hljs-comment">// 1. Script Start</span>
<span class="hljs-comment">// 2. Script End</span>
<span class="hljs-comment">// 3. Poll phase may start here...</span>
<span class="hljs-comment">// 4. process.nextTick</span>
<span class="hljs-comment">// 5. Promise.then</span>
<span class="hljs-comment">// 6. I/O (readFile) callback</span>
<span class="hljs-comment">// 10. I/O -&gt; nextTick</span>
<span class="hljs-comment">// 9. I/O -&gt; setImmediate</span>
<span class="hljs-comment">// 7. setTimeout</span>
<span class="hljs-comment">// 8. setImmediate</span>
<span class="hljs-comment">// 11. I/O -&gt; setTimeout</span>
<span class="hljs-comment">// (æ³¨æ„ï¼š9, 7, 8, 11 çš„ç¡®åˆ‡é¡ºåºå¯èƒ½å› I/Oè€—æ—¶å’Œç³»ç»Ÿè°ƒåº¦è€Œæœ‰ç»†å¾®å˜åŒ–ï¼Œä½†åŸºæœ¬è§„å¾‹å¦‚æ­¤)</span>
</code></pre>
<h2 data-id="heading-7">ä¸‰ã€ é«˜çº§æ€§èƒ½ä¼˜åŒ–</h2>
<h3 data-id="heading-8"><strong>Tree Shaking (æ‘‡æ ‘ä¼˜åŒ–)</strong></h3>
<h4 data-id="heading-9"><strong>åŸç†</strong></h4>
<ul>
<li>ä¾èµ–ES Modules (<code>import</code>/<code>export</code>) çš„é™æ€ç»“æ„ï¼Œåœ¨ç¼–è¯‘æ—¶åˆ†æä»£ç ï¼Œç§»é™¤æœªè¢«å®é™…å¼•ç”¨çš„â€œæ­»ä»£ç â€(dead-code)ã€‚</li>
</ul>
<h4 data-id="heading-10"><strong>å®è·µ</strong></h4>
<ul>
<li>Webpack, Rollupç­‰ç°ä»£æ‰“åŒ…å·¥å…·åœ¨ç”Ÿäº§æ¨¡å¼ä¸‹é»˜è®¤å¼€å¯ã€‚å¼€å‘è€…éœ€ä¿è¯ä»£ç éµå¾ªESMè§„èŒƒï¼Œå¹¶é¿å…æœ‰å‰¯ä½œç”¨çš„æ¨¡å—å¯¼å…¥ã€‚</li>
</ul>
<h3 data-id="heading-11"><strong>Code Splitting (ä»£ç åˆ†å‰²)</strong></h3>
<h4 data-id="heading-12"><strong>ç›®çš„</strong></h4>
<ul>
<li>å°†å·¨å¤§çš„å•ä½“bundleåˆ†å‰²æˆå¤šä¸ªå°å—(chunks)ï¼ŒæŒ‰éœ€åŠ è½½ï¼Œä»¥å‡å°é¦–å±åŠ è½½ä½“ç§¯ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚</li>
</ul>
<h4 data-id="heading-13"><strong>ç­–ç•¥</strong></h4>
<ol>
<li>
<p><strong>æŒ‰è·¯ç”±åˆ†å‰²</strong>: æ¯ä¸ªé¡µé¢æˆ–è·¯ç”±å¯¹åº”ä¸€ä¸ªchunkã€‚</p>
</li>
<li>
<p><strong>æŒ‰ç»„ä»¶åˆ†å‰²</strong>: å¯¹äºéé¦–å±ã€æˆ–éœ€è¦äº¤äº’æ‰å‡ºç°çš„å¤§å‹ç»„ä»¶ï¼ˆå¦‚å¼¹çª—ã€å›¾è¡¨ï¼‰è¿›è¡Œæ‡’åŠ è½½ã€‚</p>
</li>
<li>
<p><strong>å…¬å…±åº“åˆ†ç¦» (Vendor Splitting)</strong> : å°†ä¸å¸¸å˜åŠ¨çš„ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚React, Lodashï¼‰æ‰“åŒ…æˆç‹¬ç«‹çš„vendor chunkï¼Œåˆ©ç”¨æµè§ˆå™¨ç¼“å­˜ã€‚</p>
</li>
</ol>
<h3 data-id="heading-14"><strong>åˆ©ç”¨æµè§ˆå™¨æ¸²æŸ“è·¯å¾„</strong></h3>
<ul>
<li>
<p><strong>å…³é”®æ¸²æŸ“è·¯å¾„</strong> : ä¼˜åŒ–CSSåŠ è½½ï¼ˆå†…è”å…³é”®CSSï¼‰ã€å‡å°‘é˜»å¡æ¸²æŸ“çš„è„šæœ¬ã€ä½¿ç”¨ <code>async</code>/<code>defer</code>ã€‚</p>
</li>
<li>
<p><strong>ç¡¬ä»¶åŠ é€Ÿ</strong>: å°½é‡ä½¿ç”¨ <code>transform</code> å’Œ <code>opacity</code> å±æ€§è¿›è¡ŒåŠ¨ç”»ï¼Œå®ƒä»¬èƒ½è¢«æå‡åˆ°å•ç‹¬çš„åˆæˆå±‚(Compositor Layer)ï¼Œç”±GPUå¤„ç†ï¼Œé¿å…è§¦å‘é‡æ’(Reflow)å’Œé‡ç»˜(Repaint)ã€‚</p>
</li>
</ul>
<h3 data-id="heading-15"><strong>ä»£ç ç¤ºä¾‹ (Reactä¸­çš„ä»£ç åˆ†å‰²)</strong></h3>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { <span class="hljs-title class_">Suspense</span>, lazy } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// ä½¿ç”¨ React.lazy å’ŒåŠ¨æ€ import() æ¥å®ç°ç»„ä»¶çš„æ‡’åŠ è½½</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">HeavyComponent</span> = <span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./components/HeavyComponent'</span>));
<span class="hljs-keyword">const</span> <span class="hljs-title class_">AnotherLazyComponent</span> = <span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./components/AnotherLazyComponent'</span>));

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [showHeavy, setShowHeavy] = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>My App<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setShowHeavy(true)}&gt;Load Heavy Component<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {/* 
        Suspense ç»„ä»¶ç”¨äºåœ¨æ‡’åŠ è½½ç»„ä»¶ä¸‹è½½å’Œè§£ææœŸé—´ï¼Œæ˜¾ç¤ºä¸€ä¸ªfallback UIã€‚
        åªæœ‰å½“ showHeavy ä¸º true æ—¶ï¼Œæµè§ˆå™¨æ‰ä¼šå»è¯·æ±‚ HeavyComponent.jsã€‚
      */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        {showHeavy &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">HeavyComponent</span> /&gt;</span>}
        
        {/* å‡è®¾è¿™æ˜¯å¦ä¸€ä¸ªéœ€è¦æ‡’åŠ è½½çš„ç»„ä»¶ */}
        {/* <span class="hljs-tag">&lt;<span class="hljs-name">AnotherLazyComponent</span> /&gt;</span> */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h2 data-id="heading-16">å››ã€ å†…å­˜ç®¡ç†ä¸è¯Šæ–­</h2>
<h3 data-id="heading-17"><strong>å†…å­˜æ³„æ¼çš„å¸¸è§åŸå› </strong></h3>
<ol>
<li>
<p><strong>æ„å¤–çš„å…¨å±€å˜é‡</strong>: æœªç»å£°æ˜çš„å˜é‡è¢«èµ‹å€¼ï¼Œæˆä¸ºå…¨å±€å¯¹è±¡çš„å±æ€§ã€‚</p>
</li>
<li>
<p><strong>é—å¿˜çš„å®šæ—¶å™¨æˆ–å›è°ƒ</strong>: <code>setInterval</code> æœªè¢«æ¸…é™¤ï¼Œå…¶å›è°ƒå‡½æ•°åŠå…¶é—­åŒ…ç¯å¢ƒæ— æ³•è¢«å›æ”¶ã€‚</p>
</li>
<li>
<p><strong>åˆ†ç¦»çš„DOMèŠ‚ç‚¹å¼•ç”¨</strong>: å¦‚ç¬¬ä¸€èŠ‚çš„ä»£ç ç¤ºä¾‹ã€‚</p>
</li>
<li>
<p><strong>é—­åŒ…çš„æ»¥ç”¨</strong>: é—­åŒ…ä¼šä½¿å…¶å¤–éƒ¨å‡½æ•°çš„ä½œç”¨åŸŸæŒç»­å­˜åœ¨ï¼Œå¦‚æœä½œç”¨åŸŸä¸­åŒ…å«å¤§é‡æ•°æ®ï¼Œåˆ™å¯èƒ½é€ æˆå†…å­˜å ç”¨è¿‡é«˜ã€‚</p>
</li>
</ol>
<h3 data-id="heading-18"><strong>è¯Šæ–­å·¥å…· (Chrome DevTools)</strong></h3>
<ul>
<li>
<p><strong>Performance Monitor</strong>: å®æ—¶ç›‘æ§CPUä½¿ç”¨ç‡ã€JSå †å¤§å°ã€DOMèŠ‚ç‚¹æ•°ç­‰ã€‚</p>
</li>
<li>
<p><strong>Memory Tab</strong>:</p>
<ul>
<li><strong>Heap Snapshot (å †å¿«ç…§)</strong> : æ‹æ‘„å †å†…å­˜çš„å¿«ç…§ï¼Œç”¨äºåˆ†æå¯¹è±¡åˆ†å¸ƒã€æŸ¥æ‰¾åˆ†ç¦»çš„DOMæ ‘ã€å®šä½å†…å­˜æ³„æ¼ã€‚</li>
<li><strong>Allocation Instrumentation on Timeline</strong>: è®°å½•å†…å­˜åˆ†é…çš„æ—¶é—´çº¿ï¼Œç”¨äºå®šä½æ˜¯å“ªä¸ªå‡½æ•°æˆ–æ“ä½œå¯¼è‡´äº†é¢‘ç¹çš„å†…å­˜åˆ†é…æˆ–å†…å­˜æ¿€å¢ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-19"><strong>ä»£ç ç¤ºä¾‹ (é—å¿˜çš„å®šæ—¶å™¨):</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PulsingDot</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isGrowing</span> = <span class="hljs-literal">true</span>;

    <span class="hljs-comment">// å®šæ—¶å™¨é€šè¿‡é—­åŒ…æŒæœ‰äº†å¯¹ this (PulsingDotå®ä¾‹) çš„å¼•ç”¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">intervalId</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isGrowing</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span> += <span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span> &gt;= <span class="hljs-number">10</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-property">isGrowing</span> = <span class="hljs-literal">false</span>;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span> -= <span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span> &lt;= <span class="hljs-number">0</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-property">isGrowing</span> = <span class="hljs-literal">true</span>;
      }
    }, <span class="hljs-number">100</span>);
  }

  <span class="hljs-comment">// å¿…é¡»æä¾›ä¸€ä¸ªé”€æ¯æ–¹æ³•æ¥æ¸…é™¤å®šæ—¶å™¨</span>
  <span class="hljs-title function_">destroy</span>(<span class="hljs-params"/>) {
    <span class="hljs-built_in">clearInterval</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">intervalId</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'PulsingDot destroyed and interval cleared.'</span>);
  }
}

<span class="hljs-keyword">let</span> dot = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PulsingDot</span>();

<span class="hljs-comment">// å‡è®¾åœ¨æŸä¸ªæ—¶é—´ç‚¹ï¼Œæˆ‘ä»¬ä¸å†éœ€è¦è¿™ä¸ª dot å®ä¾‹</span>
dot = <span class="hljs-literal">null</span>;

<span class="hljs-comment">// é—®é¢˜ï¼šè™½ç„¶ dot å˜é‡è¢«è®¾ä¸º nullï¼Œä½† PulsingDot å®ä¾‹æ— æ³•è¢«å›æ”¶ï¼Œ</span>
<span class="hljs-comment">// å› ä¸º setInterval çš„å›è°ƒå‡½æ•°ä»ç„¶æŒæœ‰å¯¹å®ƒçš„å¼•ç”¨ï¼Œå®šæ—¶å™¨è¿˜åœ¨ä¸åœåœ°è¿è¡Œã€‚</span>
<span class="hljs-comment">// æ­£ç¡®åšæ³•ï¼šåœ¨é”€æ¯å¯¹è±¡å‰ï¼Œè°ƒç”¨ dot.destroy()ã€‚</span>
</code></pre>
<h2 data-id="heading-20">äº”ã€ è½¯ä»¶è®¾è®¡æ¨¡å¼</h2>
<p>é«˜çº§å¼€å‘è€…åº”èƒ½å°†è®¾è®¡æ¨¡å¼æ€æƒ³èå…¥æ—¥å¸¸ç¼–ç ï¼Œä»¥æ„å»ºå¯ç»´æŠ¤ã€å¯æ‰©å±•çš„ç³»ç»Ÿã€‚</p>
<ul>
<li>
<p><strong>å•ä¾‹æ¨¡å¼ (Singleton)</strong> : ç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªå…¨å±€è®¿é—®ç‚¹ã€‚</p>
</li>
<li>
<p><strong>è§‚å¯Ÿè€…æ¨¡å¼ (Observer / Pub/Sub)</strong> : å®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å°†å¾—åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°ã€‚</p>
</li>
<li>
<p><strong>å·¥å‚æ¨¡å¼ (Factory)</strong> : å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚</p>
</li>
<li>
<p><strong>è£…é¥°å™¨æ¨¡å¼ (Decorator)</strong> : åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚</p>
</li>
<li>
<p><strong>ä»£ç†æ¨¡å¼ (Proxy)</strong> : ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚</p>
</li>
</ul>
<p><strong>ä»£ç ç¤ºä¾‹ (è§‚å¯Ÿè€…æ¨¡å¼/å‘å¸ƒ-è®¢é˜…):</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">EventBus</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span> = {};
  }

  <span class="hljs-comment">// è®¢é˜…</span>
  <span class="hljs-title function_">on</span>(<span class="hljs-params">eventName, callback</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName]) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName] = [];
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName].<span class="hljs-title function_">push</span>(callback);
  }

  <span class="hljs-comment">// å–æ¶ˆè®¢é˜…</span>
  <span class="hljs-title function_">off</span>(<span class="hljs-params">eventName, callback</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName]) <span class="hljs-keyword">return</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName].<span class="hljs-title function_">filter</span>(
      <span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> listener !== callback
    );
  }

  <span class="hljs-comment">// å‘å¸ƒ</span>
  <span class="hljs-title function_">emit</span>(<span class="hljs-params">eventName, ...args</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName]) <span class="hljs-keyword">return</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>[eventName].<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-title function_">listener</span>(...args);
      } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Error in listener for event "<span class="hljs-subst">${eventName}</span>":`</span>, e);
      }
    });
  }
}

<span class="hljs-comment">// --- ä½¿ç”¨åœºæ™¯ ---</span>
<span class="hljs-keyword">const</span> bus = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventBus</span>();

<span class="hljs-keyword">function</span> <span class="hljs-title function_">onUserLogin</span>(<span class="hljs-params">userData</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Analytics Service: User logged in'</span>, userData.<span class="hljs-property">name</span>);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">updateNavbar</span>(<span class="hljs-params">userData</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'UI Service: Updating navbar for'</span>, userData.<span class="hljs-property">name</span>);
}

bus.<span class="hljs-title function_">on</span>(<span class="hljs-string">'user:login'</span>, onUserLogin);
bus.<span class="hljs-title function_">on</span>(<span class="hljs-string">'user:login'</span>, updateNavbar);

<span class="hljs-comment">// æŸå¤„ç™»å½•æˆåŠŸå...</span>
bus.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'user:login'</span>, { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Mickey'</span> });

<span class="hljs-comment">// ç”¨æˆ·é€€å‡ºæ—¶ï¼Œå¯ä»¥å–æ¶ˆè®¢é˜…</span>
<span class="hljs-comment">// bus.off('user:login', onUserLogin);</span>
</code></pre>
<h2 data-id="heading-21">å…­ã€ æ¨¡å—åŒ–ä¸å·¥ç¨‹åŒ–</h2>
<h3 data-id="heading-22"><strong>æ¨¡å—åŒ–æ–¹æ¡ˆæ¼”è¿›</strong></h3>
<p>ä»IIFEã€CommonJS (<code>require</code>/<code>module.exports</code>)ã€AMD (<code>define</code>/<code>require</code>) åˆ° <strong>ES Modules (<code>import</code>/<code>export</code>)</strong> ã€‚é«˜çº§å¼€å‘è€…éœ€ç†è§£å®ƒä»¬çš„å·®å¼‚åŠé€‚ç”¨åœºæ™¯ã€‚</p>
<h3 data-id="heading-23"><strong>æ„å»ºå·¥å…·</strong></h3>
<h4 data-id="heading-24"><strong>Webpack</strong></h4>
<p>ä¸€ä¸ªå¼ºå¤§çš„ã€é«˜åº¦å¯é…ç½®çš„æ¨¡å—æ‰“åŒ…å™¨ã€‚æ ¸å¿ƒæ¦‚å¿µï¼š<strong>Entry</strong>, <strong>Output</strong>, <strong>Loaders</strong> (è½¬æ¢éJSæ¨¡å—), <strong>Plugins</strong> (æ‰§è¡Œæ›´å¹¿æ³›çš„ä»»åŠ¡ï¼Œå¦‚æ‰“åŒ…ä¼˜åŒ–ã€èµ„æºç®¡ç†), <strong>Mode</strong>ã€‚</p>
<h4 data-id="heading-25"><strong>Vite</strong></h4>
<p>æ–°ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·ã€‚åˆ©ç”¨æµè§ˆå™¨åŸç”ŸESMæ”¯æŒï¼Œåœ¨å¼€å‘ç¯å¢ƒä¸‹å®ç°æé€Ÿçš„å†·å¯åŠ¨å’Œçƒ­æ›´æ–° (HMR)ã€‚ç”Ÿäº§ç¯å¢ƒåˆ™ä½¿ç”¨Rollupè¿›è¡Œæ‰“åŒ…ã€‚</p>
<h4 data-id="heading-26"><strong>Monorepo</strong></h4>
<p>åœ¨å•ä¸€ä»£ç ä»“åº“ä¸­ç®¡ç†å¤šä¸ªé¡¹ç›®/åŒ…çš„ç­–ç•¥ã€‚å·¥å…·ï¼šLerna, Nx, Turborepoã€‚</p>
<h3 data-id="heading-27"><strong>ä»£ç ç¤ºä¾‹ (ä¸€ä¸ªåŸºç¡€çš„ <code>webpack.config.js</code>):</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>);

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-comment">// æ¨¡å¼ï¼š'development' æˆ– 'production'</span>
  <span class="hljs-attr">mode</span>: <span class="hljs-string">'development'</span>,

  <span class="hljs-comment">// å…¥å£æ–‡ä»¶</span>
  <span class="hljs-attr">entry</span>: <span class="hljs-string">'./src/index.js'</span>,

  <span class="hljs-comment">// è¾“å‡ºé…ç½®</span>
  <span class="hljs-attr">output</span>: {
    <span class="hljs-attr">filename</span>: <span class="hljs-string">'bundle.[contenthash].js'</span>, <span class="hljs-comment">// contenthash ç”¨äºç¼“å­˜ä¼˜åŒ–</span>
    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'dist'</span>),
    <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// åœ¨ç”Ÿæˆæ–‡ä»¶ä¹‹å‰æ¸…ç©º output ç›®å½•</span>
  },

  <span class="hljs-comment">// æ¨¡å—å¤„ç†è§„åˆ™</span>
  <span class="hljs-attr">module</span>: {
    <span class="hljs-attr">rules</span>: [
      {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.js$/</span>,
        <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>,
        <span class="hljs-attr">use</span>: {
          <span class="hljs-comment">// ä½¿ç”¨ babel-loader æ¥è½¬æ¢ ES6+ è¯­æ³•</span>
          <span class="hljs-attr">loader</span>: <span class="hljs-string">'babel-loader'</span>,
          <span class="hljs-attr">options</span>: {
            <span class="hljs-attr">presets</span>: [<span class="hljs-string">'@babel/preset-env'</span>, <span class="hljs-string">'@babel/preset-react'</span>]
          }
        }
      },
      {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.css$/</span>,
        <span class="hljs-comment">// loader çš„æ‰§è¡Œé¡ºåºæ˜¯ä»å³åˆ°å·¦</span>
        <span class="hljs-attr">use</span>: [<span class="hljs-string">'style-loader'</span>, <span class="hljs-string">'css-loader'</span>]
      }
    ]
  },

  <span class="hljs-comment">// æ’ä»¶é…ç½®</span>
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-comment">// è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª HTML æ–‡ä»¶ï¼Œå¹¶æ³¨å…¥æ‰“åŒ…åçš„ JS</span>
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>({
      <span class="hljs-attr">template</span>: <span class="hljs-string">'./src/index.html'</span>
    })
  ],

  <span class="hljs-comment">// å¼€å‘æœåŠ¡å™¨é…ç½®</span>
  <span class="hljs-attr">devServer</span>: {
    <span class="hljs-attr">static</span>: <span class="hljs-string">'./dist'</span>,
    <span class="hljs-attr">hot</span>: <span class="hljs-literal">true</span>,
  },
  
  <span class="hljs-comment">// Source Map é…ç½®ï¼Œç”¨äºè°ƒè¯•</span>
  <span class="hljs-attr">devtool</span>: <span class="hljs-string">'eval-source-map'</span>,
};
</code></pre>
<h2 data-id="heading-28">ä¸ƒã€ Webå®‰å…¨</h2>
<h3 data-id="heading-29"><strong>XSS (Cross-Site Scripting)</strong></h3>
<p>æ”»å‡»è€…å°†æ¶æ„è„šæœ¬æ³¨å…¥åˆ°ç½‘é¡µä¸­ï¼Œå…¶ä»–ç”¨æˆ·æµè§ˆæ—¶æ‰§è¡Œã€‚</p>
<h4 data-id="heading-30"><strong>ç±»å‹</strong></h4>
<ul>
<li>å‚¨å­˜å‹ï¼ˆ<code>Stored XSS</code>ï¼‰</li>
<li>åå°„å‹ï¼ˆ<code>Reflected XSS</code>ï¼‰</li>
<li>DOMå‹ï¼ˆ<code>DOM-based XSS</code>ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-31"><strong>é˜²å¾¡</strong></h4>
<ol>
<li>
<p><strong>ç»ä¸ä¿¡ä»»ä»»ä½•ç”¨æˆ·è¾“å…¥</strong>ã€‚</p>
</li>
<li>
<p><strong>è¾“å‡ºç¼–ç /è½¬ä¹‰</strong>: å¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨æ¸²æŸ“åˆ°é¡µé¢å‰è¿›è¡ŒHTMLå®ä½“è½¬ä¹‰ã€‚ç°ä»£æ¡†æ¶ï¼ˆå¦‚React, Vueï¼‰é»˜è®¤è¿›è¡Œæ­¤æ“ä½œã€‚</p>
</li>
<li>
<p><strong>ä½¿ç”¨ <code>textContent</code> ä»£æ›¿ <code>innerHTML</code></strong>ã€‚</p>
</li>
<li>
<p><strong>Content Security Policy (CSP)</strong> : é€šè¿‡HTTPå¤´ï¼Œä¸¥æ ¼é™åˆ¶é¡µé¢å¯ä»¥åŠ è½½çš„èµ„æºæ¥æºã€‚</p>
</li>
</ol>
<h3 data-id="heading-32"><strong>CSRF (Cross-Site Request Forgery)</strong></h3>
<p>æ”»å‡»è€…è¯±å¯¼å·²ç™»å½•ç”¨æˆ·åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ï¼Œå‘å…¶å·²è®¤è¯çš„Webåº”ç”¨å‘é€ä¸€ä¸ªä¼ªé€ çš„è¯·æ±‚ï¼ˆå¦‚è½¬è´¦ã€ä¿®æ”¹å¯†ç ï¼‰ã€‚</p>
<h4 data-id="heading-33"><strong>é˜²å¾¡</strong></h4>
<ol>
<li>
<p><strong>Anti-CSRF Token</strong>: æœåŠ¡å™¨ä¸ºæ¯ä¸ªç”¨æˆ·ä¼šè¯ç”Ÿæˆä¸€ä¸ªéšæœºTokenï¼Œè¦æ±‚æ‰€æœ‰çŠ¶æ€å˜æ›´çš„è¯·æ±‚ï¼ˆPOST, PUT, DELETEï¼‰éƒ½å¿…é¡»æºå¸¦æ­¤Tokenã€‚</p>
</li>
<li>
<p><strong>SameSite Cookie å±æ€§</strong>: å°†Cookieè®¾ç½®ä¸º <code>Strict</code> æˆ– <code>Lax</code>ï¼Œå¯ä»¥é˜»æ­¢æµè§ˆå™¨åœ¨è·¨ç«™è¯·æ±‚ä¸­å‘é€Cookieã€‚<code>SameSite=Strict</code> æ˜¯æœ€å¼ºçš„é˜²å¾¡ã€‚</p>
</li>
<li>
<p><strong>æ£€æŸ¥ Referer å¤´</strong>: éªŒè¯è¯·æ±‚çš„æ¥æºï¼Œä½†æ­¤æ–¹æ³•å¯è¢«ä¼ªé€ ã€‚</p>
</li>
</ol>
<h3 data-id="heading-34"><strong>ä»£ç ç¤ºä¾‹ (XSSé˜²å¾¡):</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> userInput = <span class="hljs-string">'&lt;img src="invalid" onerror="alert('</span><span class="hljs-variable constant_">XSS</span> <span class="hljs-title class_">Attack</span>!<span class="hljs-string">')"&gt;'</span>;

<span class="hljs-comment">// é”™è¯¯çš„æ–¹å¼ï¼šç›´æ¥ä½¿ç”¨ innerHTML</span>
<span class="hljs-keyword">const</span> vulnerableDiv = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'vulnerable'</span>);
<span class="hljs-comment">// vulnerableDiv.innerHTML = userInput; // è¿™å°†æ‰§è¡Œ onerror ä¸­çš„æ¶æ„è„šæœ¬</span>

<span class="hljs-comment">// æ­£ç¡®çš„æ–¹å¼ï¼šä½¿ç”¨ textContentï¼Œæµè§ˆå™¨ä¼šå°†å…¶ä½œä¸ºçº¯æ–‡æœ¬å¤„ç†</span>
<span class="hljs-keyword">const</span> secureDiv = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'secure'</span>);
secureDiv.<span class="hljs-property">textContent</span> = userInput; <span class="hljs-comment">// é¡µé¢å°†æ˜¾ç¤ºå­—ç¬¦ä¸² "&lt;img..." è€Œéå›¾ç‰‡</span>
</code></pre>
<h2 data-id="heading-35">å…«ã€ æ¡†æ¶åŸç† (ä»¥Reactä¸ºä¾‹)</h2>
<h3 data-id="heading-36"><strong>Virtual DOM (VDOM)</strong></h3>
<ul>
<li>
<p>ä¸€ä¸ªä»¥JavaScriptå¯¹è±¡å½¢å¼å­˜åœ¨çš„ã€å¯¹çœŸå®DOMçš„æŠ½è±¡è¡¨ç¤ºã€‚</p>
</li>
<li>
<p><strong>å·¥ä½œæµ</strong>:</p>
</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">    graph TD
    A[çŠ¶æ€å˜æ›´] --&gt; B(é‡æ–°æ¸²æŸ“ç”Ÿæˆæ–°çš„VDOM)
    B --&gt; C(æ–°æ—§VDOMè¿›è¡Œ&lt;br/&gt;Diffingå·®å¼‚æ¯”è¾ƒ)
    C --&gt; D(è®¡ç®—å‡ºæœ€å°åŒ–çš„å˜æ›´é›†);
    D --&gt; E(å°†å˜æ›´æ‰¹é‡æ›´æ–°&lt;br/&gt;åˆ°çœŸå®DOM);
</code></pre>
<h3 data-id="heading-37"><strong>Reconciliation (åè°ƒ) ä¸ Diffing ç®—æ³•</strong></h3>
<h4 data-id="heading-38"><strong>Diffingç­–ç•¥</strong></h4>
<ol>
<li>
<p><strong>Tree Diff</strong>: åªå¯¹åŒå±‚çº§çš„èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒï¼Œè·¨å±‚çº§çš„ç§»åŠ¨ä¼šè§†ä¸ºèŠ‚ç‚¹çš„é”€æ¯å’Œé‡å»ºã€‚</p>
</li>
<li>
<p><strong>Component Diff</strong>: å¦‚æœç»„ä»¶ç±»å‹ä¸åŒï¼Œç›´æ¥é”€æ¯æ—§ç»„ä»¶ï¼Œåˆ›å»ºæ–°ç»„ä»¶ï¼›å¦‚æœç±»å‹ç›¸åŒï¼Œåˆ™æ›´æ–°å…¶å±æ€§ã€‚</p>
</li>
<li>
<p><strong>Element Diff</strong>: å¯¹äºåŒå±‚çº§çš„ä¸€ç»„å­èŠ‚ç‚¹ï¼Œé€šè¿‡ <code>key</code> å±æ€§è¿›è¡Œä¼˜åŒ–ã€‚<code>key</code> å¸®åŠ©Reactè¯†åˆ«å“ªäº›å…ƒç´ æ˜¯ç¨³å®šçš„ã€å“ªäº›æ˜¯æ–°å¢æˆ–åˆ é™¤çš„ï¼Œä»è€Œå®ç°é«˜æ•ˆçš„ç§»åŠ¨å’Œå¤ç”¨ï¼Œè€Œä¸æ˜¯åŸåœ°é”€æ¯é‡å»ºã€‚</p>
</li>
</ol>
<h4 data-id="heading-39"><strong>ä»£ç ç¤ºä¾‹ (<code>key</code>çš„é‡è¦æ€§)</strong></h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// åœºæ™¯ï¼šåœ¨ä¸€ä¸ªåˆ—è¡¨çš„å¼€å¤´æ’å…¥ä¸€ä¸ªæ–°å…ƒç´ </span>

<span class="hljs-comment">// --- ä¸æ¨èï¼šä½¿ç”¨ index ä½œä¸º key ---</span>
<span class="hljs-comment">// å½“åœ¨å¼€å¤´æ’å…¥ 'grape' æ—¶ï¼Œåˆ—è¡¨å˜ä¸º ['grape', 'apple', 'banana']</span>
<span class="hljs-comment">// React çœ‹åˆ°ï¼š</span>
<span class="hljs-comment">// - key=0 çš„å…ƒç´ ä» 'apple' å˜ä¸º 'grape' (æ›´æ–°)</span>
<span class="hljs-comment">// - key=1 çš„å…ƒç´ ä» 'banana' å˜ä¸º 'apple' (æ›´æ–°)</span>
<span class="hljs-comment">// - æ–°å¢ä¸€ä¸ª key=2 çš„å…ƒç´  'banana' (æ–°å¢)</span>
<span class="hljs-comment">// è¿™å¯¼è‡´äº†å¤§é‡ä¸å¿…è¦çš„DOMæ›´æ–°ã€‚</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">BadList</span> = (<span class="hljs-params">{ items }</span>) =&gt; (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>{items.map((item, index) =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span>&gt;</span>{item}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>)}<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span>
);

<span class="hljs-comment">// --- æ¨èï¼šä½¿ç”¨ç¨³å®šä¸”å”¯ä¸€çš„IDä½œä¸º key ---</span>
<span class="hljs-comment">// å½“åœ¨å¼€å¤´æ’å…¥ {id: 3, text: 'grape'} æ—¶</span>
<span class="hljs-comment">// React çœ‹åˆ°ï¼š</span>
<span class="hljs-comment">// - key=1 ('apple') å’Œ key=2 ('banana') çš„å…ƒç´ ä»ç„¶å­˜åœ¨ï¼Œåªéœ€ç§»åŠ¨ä½ç½®</span>
<span class="hljs-comment">// - æ–°å¢ä¸€ä¸ª key=3 çš„å…ƒç´  'grape'</span>
<span class="hljs-comment">// è¿™åªä¼šå¯¼è‡´ä¸€æ¬¡æ–°å¢æ“ä½œå’Œä¸¤æ¬¡ç§»åŠ¨æ“ä½œï¼Œæ•ˆç‡æé«˜ã€‚</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">GoodList</span> = (<span class="hljs-params">{ items }</span>) =&gt; (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>{items.map(item =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>&gt;</span>{item.text}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>)}<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span>
);
</code></pre>
<h2 data-id="heading-40">ä¹ã€ TypeScript</h2>
<h3 data-id="heading-41"><strong>æ ¸å¿ƒä»·å€¼</strong></h3>
<ul>
<li>ä¸ºJavaScriptå¸¦æ¥<strong>é™æ€ç±»å‹ç³»ç»Ÿ</strong></li>
<li>åœ¨ç¼–è¯‘é˜¶æ®µå‘ç°æ½œåœ¨é”™è¯¯</li>
<li>æå‡ä»£ç çš„å¯ç»´æŠ¤æ€§ã€å¯è¯»æ€§å’Œå¤§å‹é¡¹ç›®çš„å¥å£®æ€§ã€‚</li>
</ul>
<h3 data-id="heading-42"><strong>é«˜çº§ç±»å‹</strong></h3>
<ul>
<li>
<p><strong>æ³›å‹ (Generics)</strong> : åˆ›å»ºå¯é‡ç”¨çš„ã€ç±»å‹å®‰å…¨çš„ç»„ä»¶æˆ–å‡½æ•°ã€‚</p>
</li>
<li>
<p><strong>æ¡ä»¶ç±»å‹ (Conditional Types)</strong> : <code>T extends U ? X : Y</code>ï¼Œä½¿ç±»å‹å¯ä»¥æ ¹æ®æ¡ä»¶å˜åŒ–ã€‚</p>
</li>
<li>
<p><strong>æ˜ å°„ç±»å‹ (Mapped Types)</strong> : <code>[K in keyof T]: ...</code>ï¼ŒåŸºäºä¸€ä¸ªç°æœ‰ç±»å‹åˆ›å»ºæ–°ç±»å‹ã€‚</p>
</li>
<li>
<p><strong>å·¥å…·ç±»å‹ (Utility Types)</strong> : <code>Partial&lt;T&gt;</code>, <code>Required&lt;T&gt;</code>, <code>Readonly&lt;T&gt;</code>, <code>Pick&lt;T, K&gt;</code>, <code>Omit&lt;T, K&gt;</code> ç­‰ï¼Œå¯¹ç±»å‹è¿›è¡Œè½¬æ¢å’Œæ“ä½œã€‚</p>
</li>
</ul>
<h3 data-id="heading-43"><strong>ä»£ç ç¤ºä¾‹ (æ³›å‹ä¸æ¡ä»¶ç±»å‹)</strong></h3>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// æ³›å‹å‡½æ•°ï¼šç¡®ä¿è¾“å…¥å’Œè¾“å‡ºç±»å‹ä¸€è‡´</span>
<span class="hljs-keyword">function</span> identity&lt;T&gt;(<span class="hljs-attr">arg</span>: T): T {
  <span class="hljs-keyword">return</span> arg;
}
<span class="hljs-keyword">let</span> output = identity&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">"myString"</span>); <span class="hljs-comment">// output ç±»å‹ä¸º string</span>

<span class="hljs-comment">// æ³›å‹æ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">GenericRepository</span>&lt;T&gt; {
  <span class="hljs-title function_">findById</span>(<span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Promise</span>&lt;T | <span class="hljs-literal">null</span>&gt;;
  <span class="hljs-title function_">findAll</span>(): <span class="hljs-title class_">Promise</span>&lt;T[]&gt;;
  <span class="hljs-title function_">save</span>(<span class="hljs-attr">entity</span>: T): <span class="hljs-title class_">Promise</span>&lt;T&gt;;
}
<span class="hljs-comment">// class UserRepository implements GenericRepository&lt;User&gt; { ... }</span>

<span class="hljs-comment">// æ¡ä»¶ç±»å‹ï¼šä»ä¸€ä¸ªç±»å‹ä¸­æå–ç‰¹å®šç±»å‹çš„å±æ€§å</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">FunctionPropertyNames</span>&lt;T&gt; = {
  [K <span class="hljs-keyword">in</span> keyof T]: T[K] <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Function</span> ? K : <span class="hljs-built_in">never</span>;
}[keyof T];

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Part</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-title function_">updatePart</span>(<span class="hljs-attr">newName</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">void</span>;
  <span class="hljs-title function_">getPartName</span>(): <span class="hljs-built_in">string</span>;
}

<span class="hljs-comment">// Type 'FunctionNames' will be "updatePart" | "getPartName"</span>
<span class="hljs-keyword">type</span> <span class="hljs-title class_">FunctionNames</span> = <span class="hljs-title class_">FunctionPropertyNames</span>&lt;<span class="hljs-title class_">Part</span>&gt;;
</code></pre>
<h2 data-id="heading-44">åã€ Node.jsä¸æœåŠ¡å™¨ç«¯</h2>
<p>Node.jsä¸ä»…æ˜¯â€œèƒ½åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œçš„JavaScriptâ€ï¼Œæ›´æ˜¯ä¸€ä¸ªåŸºäºäº‹ä»¶é©±åŠ¨ã€éé˜»å¡I/Oæ¨¡å‹çš„å¼ºå¤§è¿è¡Œæ—¶ç¯å¢ƒã€‚å¯¹å…¶æ ¸å¿ƒåŸç†ã€ç”Ÿæ€ç³»ç»ŸåŠæœ€ä½³å®è·µçš„æŒæ¡ï¼Œæ˜¯æ„å»ºé«˜æ€§èƒ½ã€é«˜å¹¶å‘ç½‘ç»œåº”ç”¨çš„åŸºç¡€ã€‚</p>
<h3 data-id="heading-45"><strong>1. Node.js æ ¸å¿ƒæ¨¡å‹</strong></h3>
<h4 data-id="heading-46"><strong>äº‹ä»¶é©±åŠ¨ &amp; éé˜»å¡I/O</strong></h4>
<ul>
<li>
<p>è¿™æ˜¯Node.jsæ€§èƒ½çš„åŸºçŸ³ã€‚ä¸ä¼ ç»Ÿçš„æ¯ä¸ªè¯·æ±‚ç‹¬å ä¸€ä¸ªçº¿ç¨‹çš„æ¨¡å‹ä¸åŒï¼ŒNode.jsåœ¨å•ä¸ªä¸»çº¿ç¨‹ä¸Šè¿è¡Œäº‹ä»¶å¾ªç¯ã€‚</p>
</li>
<li>
<p>å½“é‡åˆ°I/Oæ“ä½œï¼ˆå¦‚æ•°æ®åº“æŸ¥è¯¢ã€æ–‡ä»¶è¯»å†™ã€ç½‘ç»œè¯·æ±‚ï¼‰æ—¶ï¼ŒNode.jsä¸ä¼šç­‰å¾…å…¶å®Œæˆï¼Œè€Œæ˜¯å°†æ“ä½œå’Œå›è°ƒå‡½æ•°äº¤ç»™åº•å±‚ç³»ç»Ÿï¼ˆå¦‚libuvåº“ï¼‰ï¼Œç„¶åç»§ç»­å¤„ç†äº‹ä»¶é˜Ÿåˆ—ä¸­çš„å…¶ä»–äº‹ä»¶ã€‚</p>
</li>
<li>
<p>å½“I/Oæ“ä½œå®Œæˆåï¼Œå…¶å›è°ƒå‡½æ•°ä¼šè¢«æ”¾å›äº‹ä»¶é˜Ÿåˆ—ï¼Œç­‰å¾…äº‹ä»¶å¾ªç¯çš„ä¸‹ä¸€æ¬¡è½®è¯¢æ¥æ‰§è¡Œã€‚</p>
</li>
</ul>
<h5 data-id="heading-47"><strong>é€‚ç”¨åœºæ™¯</strong></h5>
<ul>
<li>è¿™ç§æ¨¡å‹ä½¿å¾—Node.jsæå…¶é€‚åˆå¤„ç†å¤§é‡å¹¶å‘è¿æ¥çš„<strong>I/Oå¯†é›†å‹</strong>åº”ç”¨ï¼Œå¦‚å®æ—¶èŠå¤©æœåŠ¡ã€APIç½‘å…³ã€å¾®æœåŠ¡ç­‰ã€‚</li>
</ul>
<p>ä½†å®ƒå¤©ç„¶ä¸é€‚åˆ<strong>CPUå¯†é›†å‹</strong>ä»»åŠ¡ï¼Œå› ä¸ºé•¿æ—¶é—´çš„è®¡ç®—ä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œå¯¼è‡´æ•´ä¸ªåº”ç”¨æ— å“åº”ã€‚</p>
<h3 data-id="heading-48"><strong>2. Webæ¡†æ¶ï¼šExpress &amp; Koa</strong></h3>
<p>è™½ç„¶Node.jså†…ç½®äº†<code>http</code>æ¨¡å—ï¼Œä½†ç›´æ¥ä½¿ç”¨å®ƒæ¥æ„å»ºå¤æ‚çš„Webåº”ç”¨æ˜¯ç¹çä¸”ä½æ•ˆçš„ã€‚Webæ¡†æ¶æä¾›äº†è·¯ç”±ã€ä¸­é—´ä»¶ã€æ¨¡æ¿å¼•æ“é›†æˆç­‰é«˜çº§æŠ½è±¡ã€‚</p>
<h4 data-id="heading-49"><strong>Express</strong></h4>
<p>äº‹å®ä¸Šçš„è¡Œä¸šæ ‡å‡†ï¼Œä»¥å…¶ç¨³å®šã€çµæ´»å’Œåºå¤§çš„ç¤¾åŒºç”Ÿæ€è€Œè‘—ç§°ã€‚å…¶æ ¸å¿ƒæ˜¯<strong>ä¸­é—´ä»¶(Middleware)</strong> æ¦‚å¿µâ€”â€”ä¸€ç³»åˆ—æŒ‰é¡ºåºå¤„ç†è¯·æ±‚çš„å‡½æ•°ã€‚</p>
<h4 data-id="heading-50"><strong>Koa</strong></h4>
<p>ç”±ExpressåŸç­äººé©¬æ‰“é€ ï¼Œè¢«è§†ä¸ºä¸‹ä¸€ä»£Node.js Webæ¡†æ¶ã€‚Koaçš„æ ¸å¿ƒæ˜¯åˆ©ç”¨<code>async/await</code>è¯­æ³•ï¼Œé€šè¿‡<strong>æ´‹è‘±æ¨¡å‹ (Onion Model)</strong> æ¥ç»„ç»‡ä¸­é—´ä»¶ï¼Œä½¿å¾—å¼‚æ­¥æµç¨‹æ§åˆ¶æ›´ä¸ºä¼˜é›…å’Œç›´è§‚ã€‚</p>
<h4 data-id="heading-51"><strong>ä»£ç ç¤ºä¾‹ (Expressä¸­é—´ä»¶ä¸è·¯ç”±)</strong></h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();

<span class="hljs-comment">// 1. åº”ç”¨çº§ä¸­é—´ä»¶ï¼šæ—¥å¿—è®°å½•å™¨</span>
<span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶ï¼Œä¼šè®°å½•æ¯ä¸ªè¯·æ±‚çš„æ–¹æ³•ã€URLå’Œæ—¶é—´æˆ³ã€‚</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> now = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">${now}</span>] <span class="hljs-subst">${req.method}</span> <span class="hljs-subst">${req.originalUrl}</span>`</span>);
  <span class="hljs-title function_">next</span>(); <span class="hljs-comment">// å…³é”®ï¼šè°ƒç”¨ next() å°†æ§åˆ¶æƒä¼ é€’ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶æˆ–è·¯ç”±å¤„ç†å™¨</span>
});

<span class="hljs-comment">// 2. å†…ç½®ä¸­é—´ä»¶ï¼šç”¨äºè§£æJSONæ ¼å¼çš„è¯·æ±‚ä½“</span>
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>());

<span class="hljs-comment">// 3. è·¯ç”±å¤„ç†å™¨</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">'Welcome to the homepage!'</span>);
});

app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/users'</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  <span class="hljs-comment">// req.body æ˜¯ç”± express.json() ä¸­é—´ä»¶å¤„ç†åå¾—åˆ°çš„</span>
  <span class="hljs-keyword">const</span> newUser = req.<span class="hljs-property">body</span>;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Creating new user:'</span>, newUser);
  <span class="hljs-comment">// ... åœ¨è¿™é‡Œæ‰§è¡Œæ•°æ®åº“æ’å…¥ç­‰æ“ä½œ ...</span>
  res.<span class="hljs-title function_">status</span>(<span class="hljs-number">201</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">id</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(), ...newUser });
});

<span class="hljs-comment">// 4. é”™è¯¯å¤„ç†ä¸­é—´ä»¶ (ç‰¹æ®Šçš„4ä¸ªå‚æ•°)</span>
<span class="hljs-comment">// åº”è¯¥æ”¾åœ¨æ‰€æœ‰ app.use() å’Œè·¯ç”±è°ƒç”¨çš„æœ€å</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">err, req, res, next</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err.<span class="hljs-property">stack</span>);
  res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">'Something broke!'</span>);
});

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PORT</span> = <span class="hljs-number">3000</span>;
app.<span class="hljs-title function_">listen</span>(<span class="hljs-variable constant_">PORT</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Server is running on http://localhost:<span class="hljs-subst">${PORT}</span>`</span>);
});
</code></pre>
<h3 data-id="heading-52"><strong>3. Streams (æµ)</strong></h3>
<p>Streamæ˜¯Node.jsä¸­å¤„ç†æµå¼æ•°æ®çš„æŠ½è±¡æ¥å£ã€‚åœ¨å¤„ç†å¤§æ–‡ä»¶æˆ–å¤§é‡ç½‘ç»œæ•°æ®æ—¶ï¼Œä¸€æ¬¡æ€§å°†æ‰€æœ‰æ•°æ®è¯»å…¥å†…å­˜æ˜¯ä½æ•ˆä¸”å±é™©çš„ï¼ˆå¯èƒ½å¯¼è‡´å†…å­˜æº¢å‡ºï¼‰ã€‚Streamå…è®¸æˆ‘ä»¬ä»¥å°å—(chunks)çš„æ–¹å¼ã€è¾¹è¯»å–è¾¹å¤„ç†æ•°æ®ã€‚</p>
<h4 data-id="heading-53"><strong>å››ç§åŸºæœ¬ç±»å‹</strong></h4>
<ol>
<li>
<p><strong>Readable</strong>: å¯ä¾›è¯»å–æ•°æ®çš„æµ (å¦‚ <code>fs.createReadStream</code>)ã€‚</p>
</li>
<li>
<p><strong>Writable</strong>: å¯ä¾›å†™å…¥æ•°æ®çš„æµ (å¦‚ <code>fs.createWriteStream</code>, <code>http.ServerResponse</code>)ã€‚</p>
</li>
<li>
<p><strong>Duplex</strong>: æ—¢å¯è¯»åˆå¯å†™çš„æµ (å¦‚ <code>net.Socket</code>)ã€‚</p>
</li>
<li>
<p><strong>Transform</strong>: åœ¨è¯»å†™è¿‡ç¨‹ä¸­å¯ä»¥ä¿®æ”¹æˆ–è½¬æ¢æ•°æ®çš„Duplexæµ (å¦‚ <code>zlib.createGzip</code>)ã€‚</p>
</li>
</ol>
<h4 data-id="heading-54"><strong><code>pipe()</code>æ–¹æ³•</strong></h4>
<ul>
<li>æ˜¯è¿æ¥æµçš„æœ€ç®€å•æ–¹å¼ï¼Œå®ƒä¼šè‡ªåŠ¨å¤„ç†æ•°æ®ä»Readableæµåˆ°Writableæµçš„ä¼ è¾“ï¼Œå¹¶èƒ½å¦¥å–„å¤„ç†<strong>èƒŒå‹ (Back-pressure)</strong> é—®é¢˜ï¼ˆå³å†™å…¥é€Ÿåº¦è·Ÿä¸ä¸Šè¯»å–é€Ÿåº¦æ—¶ï¼Œè‡ªåŠ¨æš‚åœè¯»å–ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-55"><strong>ä»£ç ç¤ºä¾‹ (é«˜æ•ˆçš„æ–‡ä»¶æœåŠ¡å™¨):</strong></h4>
<p>ä»¥ä¸‹ä»£ç ä½¿ç”¨æµé«˜æ•ˆåœ°æä¾›ä¸€ä¸ªå¤§æ–‡ä»¶çš„ä¸‹è½½ï¼Œè€Œæ— éœ€å°†æ•´ä¸ªæ–‡ä»¶åŠ è½½åˆ°æœåŠ¡å™¨å†…å­˜ä¸­ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">'http'</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  <span class="hljs-comment">// å‡è®¾æˆ‘ä»¬è¦æä¾›ä¸€ä¸ªåä¸º 'large-video.mp4' çš„æ–‡ä»¶ä¸‹è½½</span>
  <span class="hljs-keyword">const</span> filePath = path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">'large-video.mp4'</span>);

  <span class="hljs-comment">// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>
  fs.<span class="hljs-title function_">stat</span>(filePath, <span class="hljs-function">(<span class="hljs-params">err, stats</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (err) {
      res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">404</span>, { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'text/plain'</span> });
      <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">end</span>(<span class="hljs-string">'File not found.'</span>);
    }

    <span class="hljs-comment">// è®¾ç½®å“åº”å¤´</span>
    res.<span class="hljs-title function_">writeHead</span>(<span class="hljs-number">200</span>, {
      <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'video/mp4'</span>,
      <span class="hljs-string">'Content-Length'</span>: stats.<span class="hljs-property">size</span>
    });

    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªå¯è¯»æµ</span>
    <span class="hljs-keyword">const</span> readStream = fs.<span class="hljs-title function_">createReadStream</span>(filePath);

    <span class="hljs-comment">// å…³é”®ï¼šä½¿ç”¨ pipe() å°†æ–‡ä»¶æµç›´æ¥å¯¼å…¥åˆ°HTTPå“åº”æµ(res)</span>
    <span class="hljs-comment">// Node.js ä¼šè‡ªåŠ¨å¤„ç†æ•°æ®åˆ†å—ã€å‘é€ä»¥åŠèƒŒå‹æ§åˆ¶ã€‚</span>
    <span class="hljs-comment">// è¿™æ˜¯ä¸€ç§æå…¶é«˜æ•ˆä¸”å†…å­˜å‹å¥½çš„æ–¹å¼ã€‚</span>
    readStream.<span class="hljs-title function_">pipe</span>(res);

    <span class="hljs-comment">// ç›‘å¬é”™è¯¯äº‹ä»¶</span>
    readStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">streamErr</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Stream Error:'</span>, streamErr);
      res.<span class="hljs-title function_">end</span>(); <span class="hljs-comment">// å‘ç”Ÿé”™è¯¯æ—¶å…³é—­è¿æ¥</span>
    });
  });
});

server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'File server listening on port 3000'</span>);
});
</code></pre>
<h3 data-id="heading-56"><strong>4. Child Processes (å­è¿›ç¨‹)</strong></h3>
<p>ä¸ºäº†è§£å†³CPUå¯†é›†å‹ä»»åŠ¡é˜»å¡ä¸»çº¿ç¨‹çš„é—®é¢˜ï¼ŒNode.jsæä¾›äº†<code>child_process</code>æ¨¡å—ï¼Œå…è®¸åˆ›å»ºå­è¿›ç¨‹æ¥æ‰§è¡Œè¿™äº›ä»»åŠ¡ã€‚</p>
<ul>
<li>
<p><strong><code>spawn()</code></strong> : å¯åŠ¨ä¸€ä¸ªæ–°è¿›ç¨‹ï¼Œä»¥æµçš„æ–¹å¼è¿›è¡ŒI/Oï¼Œé€‚åˆå¤„ç†å¤§é‡æ•°æ®ã€‚</p>
</li>
<li>
<p><strong><code>exec()</code></strong> : å¯åŠ¨ä¸€ä¸ªshellæ¥æ‰§è¡Œå‘½ä»¤ï¼Œå°†stdout/stderrç¼“å­˜èµ·æ¥ï¼Œåœ¨è¿›ç¨‹ç»“æŸæ—¶é€šè¿‡å›è°ƒä¸€æ¬¡æ€§è¿”å›ã€‚æœ‰å¤§å°é™åˆ¶ï¼Œé€‚åˆæ‰§è¡Œç®€å•çš„shellå‘½ä»¤ã€‚</p>
</li>
<li>
<p><strong><code>fork()</code></strong> : <code>spawn()</code>çš„ä¸€ä¸ªç‰¹æ®Šå˜ä½“ï¼Œä¸“é—¨ç”¨äºåˆ›å»ºæ–°çš„Node.jsè¿›ç¨‹ã€‚çˆ¶å­è¿›ç¨‹ä¹‹é—´ä¼šå»ºç«‹ä¸€ä¸ªIPC (Inter-Process Communication) é€šé“ï¼Œå…è®¸é€šè¿‡<code>.send()</code>å’Œ<code>.on('message', ...)</code>æ¥æ”¶å‘æ¶ˆæ¯ã€‚</p>
</li>
</ul>
<h4 data-id="heading-57"><strong>ä»£ç ç¤ºä¾‹ (ä½¿ç”¨<code>fork</code>å¤„ç†CPUå¯†é›†å‹è®¡ç®—):</strong></h4>
<p>å‡è®¾æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸€ä¸ªè€—æ—¶çš„æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—ã€‚</p>
<p><strong><code>parent.js</code> (ä¸»è¿›ç¨‹)</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> { fork } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'child_process'</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Main process started.'</span>);

<span class="hljs-keyword">const</span> child = <span class="hljs-title function_">fork</span>(<span class="hljs-string">'./child.js'</span>); <span class="hljs-comment">// å¯åŠ¨å­è¿›ç¨‹</span>

<span class="hljs-keyword">const</span> numberToCompute = <span class="hljs-number">45</span>; <span class="hljs-comment">// ä¸€ä¸ªä¼šå¯¼è‡´æ˜¾è‘—è®¡ç®—è€—æ—¶çš„æ•°å­—</span>

<span class="hljs-comment">// ç›‘å¬å­è¿›ç¨‹å‘å›çš„æ¶ˆæ¯</span>
child.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Main process received result from child: Fibonacci(<span class="hljs-subst">${numberToCompute}</span>) = <span class="hljs-subst">${message.result}</span>`</span>);
});

<span class="hljs-comment">// å‘å­è¿›ç¨‹å‘é€ä»»åŠ¡</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Main process sending task to child: compute Fibonacci(<span class="hljs-subst">${numberToCompute}</span>).`</span>);
child.<span class="hljs-title function_">send</span>({ <span class="hljs-attr">number</span>: numberToCompute });

<span class="hljs-comment">// ä¸»è¿›ç¨‹å¯ä»¥ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œä¸ä¼šè¢«è®¡ç®—é˜»å¡</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Main process continues to do other work...'</span>);
</code></pre>
<p><strong><code>child.js</code> (å­è¿›ç¨‹)</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">fibonacci</span>(<span class="hljs-params">n</span>) {
  <span class="hljs-keyword">if</span> (n &lt;= <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> n;
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">fibonacci</span>(n - <span class="hljs-number">1</span>) + <span class="hljs-title function_">fibonacci</span>(n - <span class="hljs-number">2</span>);
}

<span class="hljs-comment">// ç›‘å¬çˆ¶è¿›ç¨‹å‘æ¥çš„æ¶ˆæ¯</span>
process.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Child process received task from parent:'</span>, message);
  <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">fibonacci</span>(message.<span class="hljs-property">number</span>);

  <span class="hljs-comment">// è®¡ç®—å®Œæˆåï¼Œé€šè¿‡IPCé€šé“å°†ç»“æœå‘é€å›çˆ¶è¿›ç¨‹</span>
  process.<span class="hljs-title function_">send</span>({ result });

  <span class="hljs-comment">// å­è¿›ç¨‹å®Œæˆä»»åŠ¡åå¯ä»¥è‡ªè¡Œé€€å‡º</span>
  process.<span class="hljs-title function_">exit</span>();
});
</code></pre>
<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒNode.jsåº”ç”¨èƒ½å¤Ÿå……åˆ†åˆ©ç”¨å¤šæ ¸CPUèµ„æºï¼Œå°†è®¡ç®—å¯†é›†å‹ä»»åŠ¡ offload åˆ°å­è¿›ç¨‹ï¼ŒåŒæ—¶ä¿æŒä¸»çº¿ç¨‹çš„å“åº”æ€§ï¼Œä»¥å¤„ç†é«˜å¹¶å‘çš„I/Oè¯·æ±‚ã€‚</p>
<h4 data-id="heading-58">ç»“è¯­</h4>
<blockquote>
<p>ä»¥ä¸Šæ˜¯JSé«˜çº§ç¯‡é¢è¯•è€ƒå¯Ÿç‚¹çš„å†…å®¹ï¼Œå¦‚æœ‰é”™è¯¯æ¬¢è¿è¯„è®ºåŒºæŒ‡æ­£ã€‚</p>
</blockquote>
<ul>
<li><a href="https://juejin.cn/post/7578705123209625643" target="_blank" title="https://juejin.cn/post/7578705123209625643">2025å‰ç«¯é¢è¯•é¢˜-JSåŸºç¡€ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7579154364959342611" target="_blank" title="https://juejin.cn/post/7579154364959342611">2025å‰ç«¯é¢è¯•é¢˜-JSä¸­çº§ç¯‡</a></li>
<li><a href="https://juejin.cn/spost/7530179511728930856" target="_blank" title="https://juejin.cn/spost/7530179511728930856">2025å‰ç«¯é¢è¯•é¢˜-TSç†è®ºç¯‡</a></li>
<li><a href="https://juejin.cn/post/7533826195352829988" target="_blank" title="https://juejin.cn/post/7533826195352829988">2025å‰ç«¯é¢è¯•é¢˜-TSå®æˆ˜ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7503111373468893193" target="_blank" title="https://juejin.cn/post/7503111373468893193">2025å‰ç«¯é¢è¯•é¢˜-Vue3åŸºç¡€ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7511568225987051555" target="_blank" title="https://juejin.cn/post/7511568225987051555">2025å‰ç«¯é¢è¯•é¢˜-Vue3è¿›é˜¶ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7503811658198286388" target="_blank" title="https://juejin.cn/post/7503811658198286388">2025å‰ç«¯é¢è¯•é¢˜-ReactåŸºç¡€ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7504545616841965583" target="_blank" title="https://juejin.cn/post/7504545616841965583">2025å‰ç«¯é¢è¯•é¢˜-Reactè¿›é˜¶ç¯‡</a></li>
<li><a href="https://juejin.cn/post/7504926961627054099" target="_blank" title="https://juejin.cn/post/7504926961627054099">2025å‰ç«¯é¢è¯•é¢˜-Reacté«˜é˜¶ç¯‡</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€URPã€‘Unity[å†…ç½®Shader]ç²’å­éå…‰ç…§ParticlesUnlit]]></title>    <link>https://juejin.cn/post/7579904059524562970</link>    <guid>https://juejin.cn/post/7579904059524562970</guid>    <pubDate>2025-12-05T00:23:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579904059524562970" data-draft-id="7579889969985159219" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€URPã€‘Unity[å†…ç½®Shader]ç²’å­éå…‰ç…§ParticlesUnlit"/> <meta itemprop="keywords" content="æ¸¸æˆå¼€å‘,å›¾å½¢å­¦,Unity3D"/> <meta itemprop="datePublished" content="2025-12-05T00:23:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SmalBox"/> <meta itemprop="url" content="https://juejin.cn/user/2218166695237532"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€URPã€‘Unity[å†…ç½®Shader]ç²’å­éå…‰ç…§ParticlesUnlit
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2218166695237532/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SmalBox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T00:23:49.000Z" title="Fri Dec 05 2025 00:23:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13021255.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13021255%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13021255&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong></p>
</blockquote>
<h2 data-id="heading-0"><strong>ä½œç”¨ä¸åŸç†</strong></h2>
<p>ParticlesUnlitæ˜¯Unityé€šç”¨æ¸²æŸ“ç®¡çº¿(URP)ä¸­ä¸“ä¸ºç²’å­ç³»ç»Ÿè®¾è®¡çš„æ— å…‰ç…§ç€è‰²å™¨ï¼Œæ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li>â€Œ<strong>æ— å…‰ç…§è®¡ç®—</strong>â€Œï¼šè·³è¿‡å¤æ‚å…‰ç…§æ¨¡å‹ï¼Œä»…é€šè¿‡çº¹ç†å’Œé¡¶ç‚¹é¢œè‰²å®ç°é«˜æ•ˆæ¸²æŸ“ï¼Œé€‚åˆç«ç„°ã€çƒŸé›¾ç­‰ç‰¹æ•ˆã€‚</li>
<li>â€Œ<strong>æ··åˆæ¨¡å¼æ§åˆ¶</strong>â€Œï¼šæ”¯æŒAdditiveï¼ˆäº®åº¦å åŠ ï¼‰ã€Multiplyï¼ˆé¢œè‰²ç›¸ä¹˜ï¼‰ç­‰æ··åˆæ–¹å¼ï¼Œé€‚åº”ä¸åŒç²’å­æ•ˆæœéœ€æ±‚ã€‚</li>
<li>â€Œ<strong>æ€§èƒ½ä¼˜åŒ–</strong>â€Œï¼šé’ˆå¯¹ç§»åŠ¨è®¾å¤‡ä¼˜åŒ–ï¼Œå‡å°‘GPUè®¡ç®—è´Ÿæ‹…ã€‚</li>
<li>â€Œ<strong>ç²’å­ä¸“ç”¨åŠŸèƒ½</strong>â€Œï¼šæ”¯æŒç¿»é¡µåŠ¨ç”»(Flipbook)ã€è½¯ç²’å­(Soft Particles)å’Œç›¸æœºæ·¡å…¥æ·¡å‡º(Camera Fading)ç­‰ç‰¹æ€§ã€‚</li>
</ul>
<p>å…¶åŸç†åŸºäºé¡¶ç‚¹/ç‰‡å…ƒç€è‰²å™¨æ¶æ„ï¼Œé€šè¿‡ShaderLabè¯­è¨€ç»„ç»‡æ¸²æŸ“æµç¨‹ï¼Œåˆ©ç”¨GPUå¹¶è¡Œè®¡ç®—å¤„ç†ç²’å­æ•°æ®ã€‚</p>
<h2 data-id="heading-1"><strong>å‘å±•å†å²</strong></h2>
<ul>
<li>â€Œ<strong>Unity 5.xæ—¶æœŸ</strong>â€Œï¼šé¦–æ¬¡å¼•å…¥æ ‡å‡†ç²’å­ç€è‰²å™¨ï¼ŒåŒºåˆ†äºé€šç”¨Standard Shaderã€‚</li>
<li>â€Œ<strong>2019å¹´URPå‘å¸ƒ</strong>â€Œï¼šé‡æ„ä¸ºURPä¸“ç”¨ç‰ˆæœ¬ï¼Œæ•´åˆè®¡ç®—ç€è‰²å™¨æ”¯æŒï¼Œä¼˜åŒ–CommandBufferè°ƒåº¦ã€‚</li>
<li>â€Œ<strong>2020å¹´è‡³ä»Š</strong>â€Œï¼šæŒç»­å¢å¼ºåŠŸèƒ½ï¼Œå¦‚æ·±åº¦çº¹ç†äº¤äº’ã€OrthographicæŠ•å½±æ”¯æŒç­‰ã€‚</li>
</ul>
<h2 data-id="heading-2"><strong>å…·ä½“ä½¿ç”¨ç¤ºä¾‹</strong></h2>
<pre><code class="hljs language-c" lang="c">shader
Shader <span class="hljs-string">"Universal Render Pipeline/Particles/Unlit"</span>
{
    Properties {
        _BaseMap(<span class="hljs-string">"Base Texture"</span>, <span class="hljs-number">2</span>D) = <span class="hljs-string">"white"</span> {}
        [HDR] _BaseColor(<span class="hljs-string">"Base Color"</span>, Color) = (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)
        _BlendMode(<span class="hljs-string">"Blend Mode"</span>, Float) = <span class="hljs-number">0</span> <span class="hljs-comment">// 0=Alpha, 1=Additive</span>
    }
    SubShader {
        Tags { <span class="hljs-string">"RenderType"</span>=<span class="hljs-string">"Transparent"</span> <span class="hljs-string">"Queue"</span>=<span class="hljs-string">"Transparent"</span> }
        Blend SrcAlpha OneMinusSrcAlpha
        Pass {
            HLSLPROGRAM
            <span class="hljs-meta">#<span class="hljs-keyword">pragma</span> vertex vert</span>
            <span class="hljs-meta">#<span class="hljs-keyword">pragma</span> fragment frag</span>
            <span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"Packages/com.unity.render-pipelines.universal/ShaderLibrary/Core.hlsl"</span></span>
            <span class="hljs-comment">// é¡¶ç‚¹/ç‰‡å…ƒç€è‰²å™¨å®ç°...</span>
            ENDHLSL
        }
    }
}
</code></pre>
<p>åº”ç”¨åœºæ™¯ï¼šåˆ›å»ºç«ç„°ç²’å­æ—¶ï¼Œè®¾ç½®Blend Modeä¸ºAdditiveï¼Œä½¿ç”¨HDRé¢œè‰²å¢å¼ºå‘å…‰æ•ˆæœã€‚</p>
<h3 data-id="heading-3"><strong>ç«ç„°/çƒŸé›¾æ•ˆæœ</strong></h3>
<ul>
<li>â€Œ<strong>æè´¨è®¾ç½®</strong>â€Œï¼šä½¿ç”¨é€æ˜æ··åˆæ¨¡å¼ï¼ˆBlending Modeé€‰æ‹©Alphaæˆ–Additiveï¼‰ï¼Œå¹¶åŠ è½½å¸¦æœ‰é€æ˜åº¦æ¸å˜çš„ç«ç„°è´´å›¾ã€‚</li>
<li>â€Œ<strong>é¢œè‰²æ§åˆ¶</strong>â€Œï¼šé€šè¿‡Color Modeå±æ€§å åŠ ç²’å­é¢œè‰²ä¸æè´¨é¢œè‰²ï¼Œä¾‹å¦‚é€‰æ‹©Additiveæ¨¡å¼å¢å¼ºäº®åº¦ã€‚</li>
<li>â€Œ<strong>é¡¶ç‚¹æ‰°åŠ¨</strong>â€Œï¼šåœ¨Shaderä¸­æ·»åŠ å™ªå£°èŠ‚ç‚¹æ‰°åŠ¨é¡¶ç‚¹åæ ‡ï¼Œæ¨¡æ‹Ÿç«ç„°åŠ¨æ€æ‰­æ›²ã€‚å®ç°ç¤ºä¾‹ï¼šåˆ›å»ºTransparentæè´¨ï¼ŒShaderé€‰URP/Particles/Unlitï¼Œè´´å›¾ä½¿ç”¨Alphaæ¸å˜çš„ç«ç„°çº¹ç†ï¼Œå¼€å¯Additiveæ··åˆã€‚</li>
</ul>
<h3 data-id="heading-4"><strong>é—ªç”µ/èƒ½é‡æŸæ•ˆæœ</strong></h3>
<ul>
<li>â€Œ<strong>æ‹–å°¾ä¸å™ªå£°</strong>â€Œï¼šå¯ç”¨Trailå’ŒNoiseæ¨¡å—ï¼Œè®¾ç½®é«˜é¢‘å™ªå£°å‚æ•°æ¨¡æ‹Ÿé—ªç”µåˆ†æ”¯ã€‚</li>
<li>â€Œ<strong>åŠ¨æ€å˜ç»†</strong>â€Œï¼šå‹¾é€‰Size over Lifetimeï¼Œæ›²çº¿è®¾ä¸º1åˆ°0ä½¿æœ«ç«¯é€æ¸æ¶ˆå¤±ã€‚</li>
<li>â€Œ<strong>é«˜äº®æè´¨</strong>â€Œï¼šä½¿ç”¨Unlit Transparent Shaderï¼Œæè´¨äº®åº¦å€¼è¶…è¿‡1ä»¥è§¦å‘Bloomå…‰æ™•ã€‚å®ç°ç¤ºä¾‹ï¼šç²’å­ç³»ç»Ÿå¯ç”¨Trailï¼Œæè´¨Shaderè®¾ä¸ºURP/Particles/Unlitï¼Œè´´å›¾ä¸ºçª„æ¸å˜æ¡çº¹ã€‚</li>
</ul>
<h3 data-id="heading-5"><strong>å¡é€šé£æ ¼ç²’å­</strong></h3>
<ul>
<li>â€Œ<strong>Rampè´´å›¾</strong>â€Œï¼šé€šè¿‡ç¨‹åºç”Ÿæˆæ¸å˜çº¹ç†æ§åˆ¶æ¼«åå°„é¢œè‰²åˆ†å±‚ï¼Œå®ç°é£æ ¼åŒ–ç€è‰²ã€‚</li>
<li>â€Œ<strong>ç¡¬è¾¹è£å‰ª</strong>â€Œï¼šå¯ç”¨Alpha Clippingå¹¶è®¾ç½®Thresholdï¼Œå®ç°å¡é€šåŒ–ç¡¬è¾¹ç¼˜ã€‚å®ç°ç¤ºä¾‹ï¼šä½¿ç”¨è„šæœ¬åŠ¨æ€ç”ŸæˆRampè´´å›¾ï¼ŒShaderä¸­é‡‡æ ·è´´å›¾æ§åˆ¶ç²’å­é¢œè‰²è¿‡æ¸¡ã€‚</li>
</ul>
<h3 data-id="heading-6"><strong>æ¶ˆè/æº¶è§£æ•ˆæœ</strong></h3>
<ul>
<li>â€Œ<strong>é¡¶ç‚¹è£å‰ª</strong>â€Œï¼šåŸºäºé¡¶ç‚¹Yåæ ‡ä¸é˜ˆå€¼æ¯”è¾ƒï¼Œé€šè¿‡Alpha Clipä¸¢å¼ƒåƒç´ ã€‚</li>
<li>â€Œ<strong>è¾¹ç¼˜å™ªå£°</strong>â€Œï¼šå åŠ Simple Noiseæ‰°åŠ¨è£å‰ªè¾¹ç•Œï¼Œå¢å¼ºé¢—ç²’æ„Ÿã€‚</li>
<li>â€Œ<strong>åŠ¨æ€æ··åˆ</strong>â€Œï¼šä½¿ç”¨æ»‘å—æ§åˆ¶æº¶è§£è¿›åº¦ï¼Œæ··åˆåŸå§‹é¢œè‰²ä¸è¾¹ç¼˜é«˜å…‰è‰²ã€‚å®ç°ç¤ºä¾‹ï¼šShader Graphä¸­è¿æ¥PositionèŠ‚ç‚¹Yåˆ†é‡ä¸StepèŠ‚ç‚¹ï¼Œé©±åŠ¨Alpha Clipå’Œé¢œè‰²æ··åˆã€‚</li>
</ul>
<h3 data-id="heading-7"><strong>é€šç”¨é…ç½®è¦ç‚¹</strong></h3>
<ul>
<li>â€Œ<strong>æ¸²æŸ“é¢</strong>â€Œï¼šæ ¹æ®éœ€æ±‚é€‰æ‹©Front Faceï¼ˆé»˜è®¤ï¼‰æˆ–Bothï¼ˆå¦‚æ ‘å¶ï¼‰ã€‚</li>
<li>â€Œ<strong>æ€§èƒ½ä¼˜åŒ–</strong>â€Œï¼šé¿å…è¿‡åº¦ä½¿ç”¨ç²’å­æ•°é‡ï¼Œä¼˜å…ˆé€šè¿‡æè´¨å’ŒShaderå¢å¼ºè¡¨ç°åŠ›ã€‚</li>
</ul>
<p>ä»¥ä¸Šæ•ˆæœå‡éœ€ç»“åˆParticle Systemç»„ä»¶è°ƒæ•´å‘å°„å‚æ•°ï¼ˆå¦‚å½¢çŠ¶ã€é€Ÿåº¦ï¼‰ä»¥å®ç°å®Œæ•´åŠ¨æ€ã€‚</p>
<h2 data-id="heading-8"><strong>Shader Graphåº”ç”¨ç¤ºä¾‹</strong></h2>
<ul>
<li>
<p>â€Œ<strong>åˆ›å»ºèŠ‚ç‚¹æµç¨‹</strong>â€Œï¼š</p>
<ul>
<li>æ·»åŠ Texture SampleèŠ‚ç‚¹è¯»å–ç²’å­è´´å›¾</li>
<li>ä½¿ç”¨Vertex ColorèŠ‚ç‚¹æ··åˆç²’å­é¢œè‰²</li>
<li>é€šè¿‡BlendèŠ‚ç‚¹æ§åˆ¶æ··åˆæ¨¡å¼ã€‚</li>
</ul>
</li>
<li>
<p>â€Œ<strong>å…³é”®èŠ‚ç‚¹é…ç½®</strong>â€Œï¼š</p>
<ul>
<li>[Particle Vertex Color] â†’ [Multiply] â† [Texture Sample]
â†“
[Blend] â†’ [Output]</li>
</ul>
<p>é€šè¿‡FlipbookèŠ‚ç‚¹å®ç°åºåˆ—å¸§åŠ¨ç”»ï¼Œé…åˆTimeèŠ‚ç‚¹æ§åˆ¶æ’­æ”¾é€Ÿåº¦ã€‚</p>
</li>
</ul>
<h2 data-id="heading-9"><strong>æ³¨æ„äº‹é¡¹</strong></h2>
<ul>
<li>ç§»åŠ¨ç«¯éœ€ç¦ç”¨Soft Particlesä»¥æå‡æ€§èƒ½ã€‚</li>
<li>æ­£äº¤ç›¸æœºéœ€ç‰¹æ®Šå¤„ç†æ·±åº¦æ¯”è¾ƒé€»è¾‘ã€‚</li>
<li>URPç‰ˆæœ¬å·®å¼‚å¯èƒ½å¯¼è‡´å‚æ•°å‘½åå˜åŒ–ï¼ˆå¦‚_BaseMapæ›¿ä»£_MainTexï¼‰</li>
</ul>
<hr/>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13021255.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13021255%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13021255.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13021255&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€ä»UnityURPå¼€å§‹æ¢ç´¢æ¸¸æˆæ¸²æŸ“ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong>
ï¼ˆæ¬¢è¿<em>ç‚¹èµç•™è¨€</em>æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å…¨ç½‘æœ€é€šä¿—æ˜“æ‡‚DeepSeek-Math-V2ä¸DeepSeek-V3.2æ ¸å¿ƒçŸ¥è¯†ç‚¹è§£æ]]></title>    <link>https://juejin.cn/post/7579849892613373988</link>    <guid>https://juejin.cn/post/7579849892613373988</guid>    <pubDate>2025-12-05T00:34:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579849892613373988" data-draft-id="7578968420043554879" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…¨ç½‘æœ€é€šä¿—æ˜“æ‡‚DeepSeek-Math-V2ä¸DeepSeek-V3.2æ ¸å¿ƒçŸ¥è¯†ç‚¹è§£æ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,DeepSeek,Agent"/> <meta itemprop="datePublished" content="2025-12-05T00:34:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æ¨¡å‹çœŸå¥½ç©"/> <meta itemprop="url" content="https://juejin.cn/user/3140624091453053"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…¨ç½‘æœ€é€šä¿—æ˜“æ‡‚DeepSeek-Math-V2ä¸DeepSeek-V3.2æ ¸å¿ƒçŸ¥è¯†ç‚¹è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3140624091453053/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æ¨¡å‹çœŸå¥½ç©
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T00:34:08.000Z" title="Fri Dec 05 2025 00:34:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ç¬”è€…æ–‡ç«  <a href="https://juejin.cn/post/7555687221233631278" target="_blank" title="https://juejin.cn/post/7555687221233631278">æ¶æ„å¤§çªç ´! DeepSeek-V3.2å‘å¸ƒï¼Œäº”åˆ†é’Ÿé€Ÿé€šDeepSeek-V3.2æ ¸å¿ƒç‰¹æ€§</a>ä¸ºå¤§å®¶ç³»ç»Ÿå‰–æäº†<strong>DeepSeek-V3.2</strong> å®éªŒç‰ˆçš„æ ¸å¿ƒç‰¹æ€§ï¼Œå¹¶é‡ç‚¹è§£è¯»äº†å…¶å¼€åˆ›æ€§æå‡ºçš„ä¸€é¡¹å…¨æ–°çš„æŠ€æœ¯ <strong>DeepSeek Sparse Attention</strong>ï¼ˆDeepSeekç¨€ç–æ³¨æ„åŠ›æœºåˆ¶ï¼‰ï¼Œç®€ç§°<strong>DSA</strong>ã€‚</p>
<p>ä¸¤ä¸ªæœˆåï¼Œ2025å¹´12æœˆ1æ—¥ DeepSeek-V3.2 æ­£å¼ç‰ˆé‡ç£…å‘å¸ƒï¼Œè¯¥ç‰ˆæœ¬åœ¨å®éªŒç‰ˆçš„åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥å¼•å…¥äº†<strong>å¯æ‰©å±•çš„GRPOè®­ç»ƒæ¡†æ¶</strong>ï¼Œå¹¶ç»“åˆ<strong>å¤§è§„æ¨¡åˆæˆAgentä»»åŠ¡æ•°æ®é›†</strong>ï¼Œé€šè¿‡æµ·é‡å¼ºåŒ–å­¦ä¹ åè®­ç»ƒï¼Œä½¿æ¨¡å‹æ€§èƒ½å®ç°å…¨é¢çªç ´ã€‚å…¶åœ¨æ•°å­¦ã€ç¼–ç¨‹åŠæ™ºèƒ½ä½“èƒ½åŠ›ç­‰æ–¹é¢çš„è¡¨ç°å‡æ˜¾è‘—é¢†å…ˆï¼Œå·²è·»èº«å…¨çƒé¡¶å°–å¤§æ¨¡å‹çš„ç¬¬ä¸€æ¢¯é˜Ÿã€‚</p>
<p>è€Œå°±åœ¨ä¸ä¹…ä¹‹å‰ï¼ŒDeepSeekè¿˜æ¨å‡ºäº†<strong>DeepSeek-Math-V2</strong>ã€‚è¯¥æ¨¡å‹é‡‡ç”¨äº†ä¸€ç§å…¨æ–°çš„è®­ç»ƒèŒƒå¼ï¼Œé€šè¿‡â€œå·¦å³äº’æã€è‡ªæˆ‘è¿­ä»£â€çš„æ–¹å¼æŒç»­è¿›åŒ–ï¼Œåœ¨CNMLï¼ˆä¸­å›½å…¨å›½é«˜ä¸­æ•°å­¦è”èµ›ï¼‰å’Œæ™®ç‰¹å—æ•°å­¦ç«èµ›ä¸­è¡¨ç°å“è¶Šï¼Œæˆç»©ç”šè‡³è¶…è¶Šäº†GPT-5-Thinkingç­‰ä¸€ç³»åˆ—å¼ºç«å“ã€‚</p>
<p>è¿‘æœŸDeepSeekè¿™ä¸¤å¤§åŠ¨ä½œå¯è°“éœ‡æ’¼äººå¿ƒï¼Œè®©å›½å†…å¤§æ¨¡å‹ç ”ç©¶è€…å€æ„Ÿéª„å‚²ã€‚ä½œä¸ºçˆ±å›½å¤§æ¨¡å‹åšä¸»ï¼Œç¬”è€…è‡ªç„¶ä¹Ÿæ˜¯è¦ç ”ç©¶ä¸€ä¸‹è¿™ä¸¤ä¸ªæ¨¡å‹çš„æ ¸å¿ƒæ€æƒ³ï¼Œä¸å°‘äººåæ˜ DeepSeek-Math-V2å’ŒDeepSeek-V3.2è®ºæ–‡ç¯‡å¹…è¾ƒé•¿ï¼Œé˜…è¯»å›°éš¾ã€‚æœ¬æœŸåˆ†äº«ç¬”è€…å°±ä½¿ç”¨é€šä¿—æ˜“æ‡‚çš„è¯­è¨€å¯¹DeepSeek-Math-V2ä¸DeepSeek-V3.2æ­£å¼ç‰ˆçš„æ ¸å¿ƒè®¾è®¡æ€æƒ³ä¸å…³é”®æŠ€æœ¯è¿›è¡Œæ·±å…¥è§£è¯»ï¼ŒåŠ›æ±‚æ¸…æ™°ç³»ç»Ÿåœ°å‘ˆç°å…¶åˆ›æ–°ä¹‹å¤„ä¸æŠ€æœ¯è„‰ç»œï¼Œæœ¬ç¯‡å†…å®¹å‚è€ƒäº†ç§˜å¡”æœç´¢å’ŒBç«™AI UPä¸»è§†é¢‘åˆ†æå¹¶è‡ªæˆ‘ç†è§£ï¼Œå¤§å®¶å¤šå¤šæŒ‡æ•™~</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d277ce1e1744a02ae5bc185bb8f1f98~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765499647&amp;x-signature=4cEfUyrE7Y5njYcH7dp%2FoBQ2h4I%3D" alt="0.png" loading="lazy"/></p>
<h2 data-id="heading-1">ä¸€ã€DeepSeek-Math-V2ï¼šåŸºäºâ€œè‡ªæˆ‘åšå¼ˆâ€çš„æ•°å­¦æ¨ç†çªç ´</h2>
<p>å¦‚æœä¸€ä¸ªäººæ—¢æ˜¯è¿åŠ¨å‘˜ã€åŒæ—¶è¿˜æ˜¯è£åˆ¤ã€å¹¶ä¸”è¿˜æ˜¯è´Ÿè´£ç›‘ç£è£åˆ¤çš„è£åˆ¤ï¼ˆå¥—å¨ƒï¼‰ï¼Œå¹¶æœ€ç»ˆåœ¨è¿™ç§å·¦å³äº’æçš„å¾ªç¯ä¸­ä¸æ–­çªç ´èƒ½åŠ›æé™ï¼Œè¿™å¬èµ·æ¥ä¼¼ä¹æ˜¯ä¸€ç§æœªæ¥çš„äººç±»è¿›åŒ–èŒƒå¼ã€‚å¦‚ä»Šï¼ŒDeepSeek-Math-V2 æ¨¡å‹ç‡å…ˆå°†è¿™ä¸€æ„æƒ³å˜ä¸ºç°å®ã€‚å®ƒæå‡ºçš„<strong>è‡ªéªŒè¯æ•°å­¦æ¨ç†è®­ç»ƒæ³•</strong>ï¼Œé€šè¿‡è®©æ¨¡å‹â€œä¸€äººåˆ†é¥°ä¸‰è§’â€ï¼Œåœ¨è‡ªæˆ‘åšå¼ˆä¸­å®ç°äº†èƒ½åŠ›çš„æ— é™è¿›åŒ–ã€‚</p>
<p>å‡­å€Ÿè¿™ä¸€åˆ›æ–°è®­ç»ƒèŒƒå¼ï¼ŒDeepSeek-Math-V2çš„æ•°å­¦èƒ½åŠ›ä¸€è·¯é£å‡ã€‚åœ¨CNMLä¸­å›½å…¨å›½é«˜ä¸­æ•°å­¦è”èµ›çº§èµ›é¢˜ä¸Šï¼Œå¾—åˆ†ç¢¾å‹GPT-5æ¨¡å‹çš„Thinking-Highæ¨¡å¼ï¼Œåœ¨åŒ—ç¾æ°å‡ºå¤§å­¦ç”Ÿæ•°å­¦ç«èµ›ï¼Œæ™®ç‰¹å—æ•°å­¦ç«èµ›ä¸­ï¼ŒDeepSeek-Math-V2è§£å†³äº†12 é“é¢˜ç›®ä¸­çš„ 11 é“ï¼Œå–å¾—è¿‘ä¹æ»¡åˆ†çš„æˆç»©ï¼Œç”šè‡³è¶…è¶Šäº†ä»»ä½•äººç±»å‚èµ›è€…çš„å†å²æœ€é«˜åˆ†ï¼ˆ90åˆ†ï¼‰ã€‚</p>
<p>åœ¨è°·æ­ŒDeepMindæå‡ºçš„<strong>IMP-ProofBench</strong>æ•°æ®é›†ä¸Šï¼ŒDeepSeek-Math-V2åŒæ ·å–å¾—é‡‘ç‰Œçº§åˆ«æˆç»©ï¼Œå¤§å¹…é¢†å…ˆGemini Deep Thinkæ¨¡å‹ã€‚ Gemini DeepThinkæ¨¡å‹æ˜¯Gemini 3æ¨¡å‹çš„å¼ºåŒ–ç‰ˆï¼Œè¿˜åœ¨æµ‹è¯•é˜¶æ®µã€‚åè§‚DeepSeek-Math-V2 ç»§ç»­ç§‰æŒç€å¼€æºç­–ç•¥ã€‚</p>
<p>Mathæ¨¡å‹ä¸€è´¯è¢«è§†ä½œä¸‹ä¸€ä»£é€šç”¨æ¨¡å‹çš„åºç« ï¼Œé¥æƒ³DeepSeek-R1å°±æ˜¯ä½¿ç”¨äº†DeepSeek-Math-V1çš„GRPOç®—æ³•ï¼Œé‚£ç°åœ¨DeepSeek-Math-V2æå‡ºçš„<strong>è‡ªéªŒè¯è®­ç»ƒæ–¹æ³•</strong>æ˜¯å¦å°†æˆä¸ºæœªæ¥DeepSeek-R2è®­ç»ƒçš„åŸºçŸ³å‘¢ï¼Ÿ</p>
<h3 data-id="heading-2">1.1 æ ¸å¿ƒæ¶æ„ï¼šç”Ÿæˆå™¨ã€éªŒè¯å™¨å’Œå…ƒéªŒè¯å™¨ â€œä¸‰ä½ä¸€ä½“â€</h3>
<p>DeepSeekè®¤ä¸ºç›®å‰é˜»ç¢å¤§æ¨¡å‹æ™ºåŠ›è¿›ä¸€æ­¥å‘å±•çš„æ ¸å¿ƒå› ç´ åœ¨äºï¼šè®­ç»ƒæ¨¡å‹çš„è¿‡ç¨‹ä¸­è¿‡äºå¼ºè°ƒè®©æ¨¡å‹ç”Ÿæˆæ­£ç¡®çš„ç­”æ¡ˆï¼Œè€Œå¿½è§†ç­”æ¡ˆèƒŒåçš„æ¨ç†æˆ–è€…æ€è€ƒè¿‡ç¨‹æ˜¯å¦æ­£ç¡®ã€‚ä¸€ä¸ªå…¸å‹çš„ç°è±¡æ˜¯å¤§æ¨¡å‹å¯ä»¥åœ¨AIMEç­‰æœ‰æ ‡å‡†ç­”æ¡ˆçš„æ•°å­¦ç«èµ›ä¸­å–å¾—é«˜åˆ†ï¼Œä½†ä¸€æ—¦é¢å¯¹æ•°å­¦è¯æ˜é—®é¢˜ï¼Œå›ç­”å°±å˜å¾—ä¸€å¡Œç³Šæ¶‚ã€‚DeepSeekå›¢é˜Ÿåˆ†æè¾“å‡ºæ­£ç¡®ç­”æ¡ˆå¹¶ä¸æ„å‘³ç€æ¨¡å‹çš„æ¨å¯¼ä¹Ÿæ­£ç¡®ã€‚è¦æƒ³å¼ºåŒ–å¤§æ¨¡å‹çš„æ¨å¯¼èƒ½åŠ›ï¼Œå°±è¦ç”¨æ•°å­¦è¯æ˜é¢˜æ¥è®­ç»ƒå¤§æ¨¡å‹äº†ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2a1138bd8464467d9176bea62c367792~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765499647&amp;x-signature=pmTWj3XnIWseS%2BUzpnwN819e43s%3D" alt="11.png" loading="lazy"/></p>
<p>ç„¶è€Œï¼Œå¦‚ä½•è¯„åˆ¤æ¨¡å‹å¯¹è¯æ˜é¢˜çš„è¾“å‡ºè´¨é‡å¥½åå‘¢ï¼ŸDeepSeek çš„è§£å†³æ–¹æ¡ˆæ˜¯æ„å»ºä¸€ä¸ªÂ <strong>è‡ªæˆ‘åšå¼ˆã€è‡ªä¸»å­¦ä¹ </strong>Â çš„è¿›åŒ–ç³»ç»Ÿã€‚è¯¥ç³»ç»ŸåŒ…å«ä¸‰ä¸ªæ¨¡å‹ï¼Œæ„æˆäº†ä¸€ä¸ªâ€œä¸‰ä½ä¸€ä½“â€çš„ååŒæ¶æ„ï¼š</p>
<ol>
<li><strong>ç”Ÿæˆå™¨</strong>ï¼šæ‰®æ¼”â€œå­¦ç”Ÿâ€è§’è‰²ï¼Œè´Ÿè´£è§£ç­”æ•°å­¦è¯æ˜é¢˜ï¼Œç”Ÿæˆå…·ä½“çš„è§£é¢˜è¿‡ç¨‹ã€‚</li>
<li><strong>éªŒè¯å™¨</strong>ï¼šæ‰®æ¼”â€œè€å¸ˆâ€è§’è‰²ï¼Œè´Ÿè´£è¯„ä¼°ç”Ÿæˆå™¨è§£é¢˜è¿‡ç¨‹çš„å¥½åï¼Œå¹¶ç»™å‡ºè¯„åˆ†ä¸è¯„è¯­ã€‚</li>
<li><strong>å…ƒéªŒè¯å™¨</strong>ï¼šæ‰®æ¼”â€œæ ¡é•¿â€è§’è‰²ï¼Œè´Ÿè´£è¯„ä¼°éªŒè¯å™¨è¯„åˆ†ä¸è¯„è¯­çš„åˆç†æ€§ï¼Œç¡®ä¿â€œè€å¸ˆâ€çš„è¯„åˆ¤æ ‡å‡†æ˜¯å¯é çš„ã€‚</li>
</ol>
<p>è¿™ä¸€æ¶æ„å¦‚åŒä¸€ä¸ªèƒ½å¤Ÿè‡ªæˆ‘è¿›åŒ–çš„å¾®å‹æ•™è‚²ç”Ÿæ€ç³»ç»Ÿï¼Œé€šè¿‡ä¸‰ä¸ªè§’è‰²çš„ç›¸äº’ç›‘ç£ä¸åšå¼ˆï¼Œæ¨åŠ¨æ•´ä½“æ¨ç†èƒ½åŠ›çš„èºæ—‹ä¸Šå‡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60d2fd52bba541e39ae61d2fef6edacc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765499647&amp;x-signature=smmny8226VZAWE4u2wtpieCKis8%3D" alt="12.png" loading="lazy"/></p>
<h3 data-id="heading-3">1.2 è®­ç»ƒæµç¨‹ï¼šä»â€œä¸“å®¶å¼•å¯¼â€åˆ°â€œå®Œå…¨è‡ªè¿›åŒ–â€</h3>
<p>DeepSeek-Math-V2 çš„è®­ç»ƒåˆ†ä¸ºä¸¤ä¸ªä¸»è¦é˜¶æ®µï¼š<strong>å†·å¯åŠ¨ï¼ˆæœ‰ç›‘ç£ï¼‰é˜¶æ®µ</strong>Â ä¸Â <strong>è¿­ä»£è®­ç»ƒï¼ˆè‡ªè¿›åŒ–ï¼‰é˜¶æ®µ</strong>ã€‚</p>
<h3 data-id="heading-4">1.2.1 å†·å¯åŠ¨é˜¶æ®µï¼šæ„å»ºåˆå§‹èƒ½åŠ›åŸºåº§</h3>
<p>å†·å¯åŠ¨é˜¶æ®µDeepSeekå‡†å¤‡äº†17000å¤šæ¡æ•°æ®ï¼Œæ¯æ¡æ•°æ®åŒ…å«äº†æ•°å­¦è¯æ˜é¢˜ã€è§£é¢˜è¿‡ç¨‹å’Œäººç±»ä¸“å®¶å¯¹äºè§£é¢˜è¿‡ç¨‹çš„è¯„åˆ†ï¼Œè¯„åˆ†åˆ†ä¸º3æ¡£ï¼Œåˆ†åˆ«æ˜¯0åˆ†ã€0.5åˆ†å’Œ1åˆ†ã€‚å†·å¯åŠ¨é˜¶æ®µçš„ç›®æ ‡æ˜¯åœ¨å°‘é‡äººç±»ä¸“å®¶æ•°æ®çš„å¼•å¯¼ä¸‹ï¼Œä¸ºä¸‰ä¸ªè§’è‰²èµ‹äºˆåˆå§‹çš„ä¸“ä¸šèƒ½åŠ›ã€‚åˆå§‹çš„ç”Ÿæˆå™¨ã€éªŒè¯å™¨å’Œå…ƒéªŒè¯å™¨æœ€å¼€å§‹éƒ½æ˜¯DeepSeek-V3.2æ¨¡å‹çš„ä¸€ä¸ªå¾®è°ƒç‰ˆæœ¬ã€‚</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šè®­ç»ƒâ€œè€å¸ˆâ€ï¼ˆéªŒè¯å™¨ï¼‰</strong><br/>
åœ¨è¿™ä¸‰ä¸ªæ¨¡å‹çš„ååŒç³»ç»Ÿä¸­ï¼Œæœ€é‡è¦çš„æ˜¯éªŒè¯å™¨ï¼Œåªæœ‰é«˜æ°´å¹³è€å¸ˆæ‰èƒ½æ•™å‡ºé«˜æ°´å¹³å­¦ç”Ÿã€‚é¦–å…ˆï¼Œé€šè¿‡GRPOç®—æ³•è®©éªŒè¯å™¨å­¦ä¼šå¯¹ä¸åŒç±»å‹é¢˜ç›®è¿›è¡Œæ‰“åˆ†ï¼Œå¹¶ä¸”å’ŒR1æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ç±»ä¼¼ï¼Œåœ¨éªŒè¯å™¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šè®¾ç½®æ ¼å¼å¥–åŠ±ä½¿éªŒè¯å™¨ç”Ÿæˆæ¯ä¸ªæ•°å­¦è¯æ˜è¿‡ç¨‹çš„è¯„ä»·æ–‡æœ¬ï¼Œç›¸å½“äºè®©éªŒè¯å™¨å­¦ä¼šå†™è§£é¢˜è¯„åˆ†çš„è¯„è¯­ï¼Œä¹Ÿå°±æ˜¯è§£é¢˜è¯„åˆ†çš„æ€è€ƒé“¾ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/39a082e69a5b472b8125883e8e91c5a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765499647&amp;x-signature=d1BxNvFBLaWkAxAEUEtH4CfCmxg%3D" alt="13.png" loading="lazy"/></p>
<p><strong>ç¬¬äºŒæ­¥ï¼šè®­ç»ƒâ€œæ ¡é•¿â€ï¼ˆå…ƒéªŒè¯å™¨ï¼‰</strong></p>
<p>ä¹‹æ‰€ä»¥è¦æ­å»ºè¿™ä¸‰ä¸ªæ¨¡å‹çš„è®­ç»ƒç³»ç»Ÿæ˜¯å¸Œæœ›æ¨¡å‹é¿å…å¥—ç­”æ¡ˆè€Œèƒ¡ç¼–ä¹±é€ æ€è€ƒè¿‡ç¨‹ï¼ŒåŒæ ·é—®é¢˜ä¹Ÿä¼šå‡ºç°åœ¨éªŒè¯å™¨çš„è®­ç»ƒä¸­ï¼ŒéªŒè¯å™¨åˆè®­åï¼Œå¯èƒ½ä¸ºäº†è¿åˆè¯„åˆ†è€Œç¼–é€ ä¸é è°±çš„è¯„è¯­ã€‚</p>
<p>ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒDeepSeekå…ˆå‡†å¤‡äº†ä¸€äº›æµ‹è¯•é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¾“å…¥äº†ä¸€äº›æ•°å­¦è¯æ˜é¢˜å’Œè¯æ˜è¿‡ç¨‹ï¼Œè®©éªŒè¯å™¨æ‰“åˆ†å¹¶ç»™å‡ºè¯„åˆ†æ–‡æœ¬ï¼Œç„¶åè®©äººç±»ä¸“å®¶å¯¹éªŒè¯å™¨ç»™å‡ºçš„ç»“æœå®¡æ ¸è¯„åˆ†ï¼ŒåŒæ ·æ˜¯0åˆ†ï¼Œ0.5åˆ†ï¼Œ1åˆ†ï¼Œç”¨äºåˆ¤æ–­éªŒè¯å™¨çš„è¯„ä»·æ˜¯å¦é è°±ã€‚ä½†äººç±»ä¸å¯èƒ½æ— ä¼‘æ­¢çš„é™ªè·‘ã€‚DeepSeekæ­¤æ—¶å°±å¼€å¯äº†å¥—å¨ƒæ¨¡å¼ï¼Œè®­ç»ƒäº†ä¸€ä¸ªä¸“é—¨ç”¨äº<strong>è¯„ä¼°éªŒè¯å™¨çš„éªŒè¯å™¨</strong>å¯¹éªŒè¯å™¨çš„è¯„è¯­æ‰“åˆ†ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„å…ƒéªŒè¯å™¨ã€‚</p>
<p>å’ŒéªŒè¯å™¨è®­ç»ƒæµç¨‹é«˜åº¦ç±»ä¼¼ï¼Œå…ƒéªŒè¯å™¨çš„è®­ç»ƒåŒæ ·æ˜¯é‡‡ç”¨GRPOç®—æ³•ä»£å…¥æ•°å­¦é¢˜+è§£é¢˜è¿‡ç¨‹+éªŒè¯å™¨å¯¹è§£é¢˜è¿‡ç¨‹çš„è¯„è¯­ï¼Œå¼ºåŒ–å­¦ä¹ ç›®æ ‡æ˜¯è®©å…ƒéªŒè¯å™¨å­¦ä¼šå¯¹éªŒè¯å™¨è¯„è¯­è¿›è¡Œæ‰“åˆ†ï¼Œé€šè¿‡è®¾ç½®æ ¼å¼å¥–åŠ±ä½¿å…¶ç”Ÿæˆå¯¹éªŒè¯å™¨è¯„è¯­çš„è¯„è¯­ï¼Œç›´è§‚è¡¨è¿°å°±æ˜¯æ ¡é•¿åˆ¤æ–­è€å¸ˆæ”¹å·å­çš„æ€è·¯æœ‰æ²¡æœ‰é—®é¢˜ã€‚</p>
<p>å½“ç„¶è¿™æ—¶å€™æœ‰åŒå­¦å°±ä¼šç–‘é—®ï¼Œé‚£è¿™ä¸ªå¯¹éªŒè¯å™¨è¯„åˆ†çš„å…ƒéªŒè¯å™¨æ˜¯ä¸æ˜¯ä¹Ÿéœ€è¦è¢«ç›‘ç£ï¼Œè¿™æ ·å±‚å±‚å¥—å¨ƒå•¥æ—¶å€™æ˜¯ä¸ªå¤´ï¼Ÿè¿™é‡ŒDeepSeekè®¤ä¸ºæ²¡æœ‰å¿…è¦åµŒå¥—äº†ï¼Œç°åœ¨å·²ç»åµŒå¥—äº†ä¸‰å±‚äº†ï¼Œä½œä¸ºæœ€é¡¶å±‚çš„å…ƒå­¦ä¹ å™¨ï¼Œå®ƒçš„ä»»åŠ¡å…¶å®æ˜¯è¶Šæ¥è¶Šè½»äº†ã€‚æ¯•ç«Ÿæ ¡é•¿ä¸ç”¨ä¸Šè¯¾ï¼Œåªéœ€è¦ç®¡ç®¡è€å¸ˆå°±å¯ä»¥äº†ã€‚å› æ­¤DeepSeekå‘ç°å¯¹äºå…ƒå­¦ä¹ å™¨æ¥è¯´å¾€å¾€è®­ç»ƒä¸€è½®å°±èƒ½è·å¾—å¾ˆé«˜çš„å‡†ç¡®ç‡ã€‚å½“å…ƒéªŒè¯å™¨å®Œæˆè¿™è½®è®­ç»ƒåï¼ŒDeepSeekç«‹é©¬ä½¿ç”¨å…ƒéªŒè¯å™¨å¯¹éªŒè¯å™¨è¿›è¡Œå†æ¬¡è®­ç»ƒï¼Œä»¥å…ƒéªŒè¯å™¨çš„è¾“å‡ºç»“æœä½œä¸ºå¥–åŠ±ä¿¡å·ï¼Œè®­ç»ƒå¾—åˆ°ä¸€ä¸ªå¢å¼ºç‰ˆçš„éªŒè¯å™¨ï¼Œè¿›ä¸€æ­¥æå‡äº†éªŒè¯å™¨èƒ½åŠ›ã€‚</p>
<p>(è¿™é‡Œæ’ä¸ªé¢˜å¤–è¯ï¼Œæ„Ÿè§‰è®¡ç®—æœºé¢†åŸŸå¹¸è¿æ•°å­—é™¤äº†2å°±æ˜¯3äº†ï¼Œ3ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„æ•°å­—ï¼Œä¾‹å¦‚3æ¬¡æ¡æ‰‹ï¼Œè¿™ä¹ˆä¸€çœ‹è‹è”çš„3è¿›åˆ¶è®¡ç®—æœºæ˜¯ä¸æ˜¯ä¹Ÿå¾ˆæœ‰æå¤´)</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/28a1742839124e3baf494767b3ac8fec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765499647&amp;x-signature=AGFBxPe80lDk260mtGFojjs0rIE%3D" alt="14.png" loading="lazy"/></p>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šè€å¸ˆ(éªŒè¯å™¨)æŒ‡å¯¼å­¦ç”Ÿ(ç”Ÿæˆå™¨)</strong></p>
<p>æ¥ä¸‹æ¥å°±ä»¥å¢å¼ºç‰ˆéªŒè¯å™¨çš„è¯„åˆ¤æ ‡å‡†ä½œä¸ºå¥–åŠ±ä¿¡å·ï¼Œä½¿ç”¨ GRPO ç®—æ³•è®­ç»ƒç”Ÿæˆå™¨ã€‚ä½†æ¯”è¾ƒç‰¹æ®Šçš„æ˜¯ï¼Œç”Ÿæˆå™¨ç”Ÿæˆçš„å†…å®¹ä¸ä»…ä»…æ˜¯è¯æ˜è¿‡ç¨‹ï¼Œè¿˜è¦è¾“å‡ºä¸€æ®µå¯¹è¯æ˜è¿‡ç¨‹çš„è‡ªæˆ‘è¯„ä»·ï¼Œç›¸å½“äºè‡ªå·±ç»™è‡ªå·±å†™ä¸€æ®µè¯„è¯­ã€‚éªŒè¯å™¨åœ¨å¯¹ç”Ÿæˆå™¨è¿›è¡Œè¯„ä¼°æ—¶ä¹Ÿæ˜¯é€šè¿‡ä¸¤ä¸ªæ–¹é¢ï¼Œä¸€ä¸ªæ–¹é¢æ˜¯åˆ¤æ–­è¯æ˜è¿‡ç¨‹æ˜¯å¦æ­£ç¡®ï¼Œå¦ä¸€æ–¹é¢æ˜¯å…ƒéªŒè¯å™¨å’ŒéªŒè¯å™¨åŒæ—¶å‚ä¸è¯„åˆ†ï¼ŒéªŒè¯å™¨å¯¹ç”Ÿæˆå™¨ç”Ÿæˆçš„è¯æ˜è¿‡ç¨‹è¯„åˆ†ï¼Œå…ƒéªŒè¯å™¨å¯¹ç”Ÿæˆå™¨ç”Ÿæˆçš„è‡ªæˆ‘è¯„ä»·è¯„åˆ†ã€‚ç„¶åå°†è§£é¢˜è¿‡ç¨‹æ­£ç¡®æ€§å’Œè‡ªæˆ‘è¯„ä»·åˆç†æ€§ä»¥3ï¼š1çš„æ¯”ä¾‹åŠ æƒè·å¾—å¥–åŠ±ä¿¡å·ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21f0bc17d4e446199eeed7511bafab99~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765499647&amp;x-signature=zuYoVgODFtRMMQZxNB6woiPMeEg%3D" alt="15.png" loading="lazy"/></p>
<p>æ€»ç»“ä»¥ä¸Šè¿‡ç¨‹å°±æ˜¯ï¼šå…ˆç»ƒè€å¸ˆï¼Œå†ç»ƒæ ¡é•¿ï¼Œæ ¡é•¿è°ƒæ•™è€å¸ˆï¼Œè€å¸ˆå’Œæ ¡é•¿ä¸€èµ·è°ƒæ•™å­¦ç”Ÿçš„å››æ­¥èµ°æˆ˜ç•¥ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d23a3c68f41241e2ba72a653cf3d9788~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765499647&amp;x-signature=9ObjeJozPODw%2B%2FCk9Ti1Xur4O44%3D" alt="16.png" loading="lazy"/></p>
<p><strong>ç¬¬å››æ­¥ï¼šèƒ½åŠ›èåˆä¸å·©å›ºï¼ˆRFTç®—æ³•ï¼‰</strong></p>
<p>å†·å¯åŠ¨çš„æœ€åä¸€æ­¥æ˜¯Â <strong>RFTï¼ˆRejection Fine-Tuningï¼Œæ‹’ç»é‡‡æ ·å¾®è°ƒï¼‰</strong> ï¼Œè¿™æ˜¯ä¸€ä¸ªç”»é¾™ç‚¹ç›çš„è®¾è®¡ã€‚å…¶æ ¸å¿ƒç›®çš„æ˜¯å°†ä¸‰ä¸ªè§’è‰²åœ¨å¼ºåŒ–å­¦ä¹ æ¢ç´¢ä¸­ç§¯ç´¯çš„â€œæ»¡åˆ†ç»éªŒâ€èåˆåˆ°ä¸€ä¸ªå•ä¸€æ¨¡å‹ä¸­ï¼Œå½¢æˆä¸€ä¸ªå…·å¤‡åšé¢˜ã€æ”¹é¢˜ã€ç£å¯¼ä¸‰é‡èƒ½åŠ›çš„Â <strong>å…¨èƒ½åŸºåº§æ¨¡å‹</strong>ï¼Œä¸ºåç»­çš„è‡ªè¿›åŒ–å¾ªç¯æ‰“ä¸‹åšå®åŸºç¡€ã€‚ç»è¿‡éªŒè¯ï¼Œåˆå¹¶åçš„æ¨¡å‹åœ¨åšé¢˜ã€æ”¹é¢˜å’Œç›‘ç£èƒ½åŠ›ä¸Šéƒ½æœ‰æå‡ã€‚</p>
<p>RFTçš„å…·ä½“åˆå¹¶æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>ç¬¬ä¸€æ­¥ï¼Œå¯¹æ•°æ®é›†è¿›è¡Œè‡ªåŠ¨åŒ–æ ‡æ³¨ï¼Œè¿™é‡Œå†æ¬¡å°†ä¸“å®¶æ•°æ®é›†ä»£å…¥åˆ°ç”Ÿæˆå™¨ä¸­ï¼Œç”Ÿæˆå™¨ä¼šåˆ›å»ºä¸€ä¸ªè¯æ˜è¿‡ç¨‹+è‡ªæˆ‘è¯„è¯­ï¼ŒåŒæ—¶è®©éªŒè¯å™¨å¯¹æ¯ä¸€æ¡è¯æ˜ç»“æœéƒ½åˆ›å»ºnä¸ªç‹¬ç«‹çš„è¯„åˆ†å’Œè¯„è¯­ã€‚ç„¶ååªè¦åœ¨nä¸ªè¯„åˆ†ä¸­å­˜åœ¨0.5åˆ†æˆ–è€…0åˆ†è¿™ç§å·®è¯„ï¼Œç³»ç»Ÿå°±è‡ªåŠ¨è®©å…ƒéªŒè¯å™¨å¯¹æ¯ä¸€æ¡å·®è¯„è¿›è¡Œmæ¬¡çš„ç‹¬ç«‹éªŒè¯ï¼Œåªè¦è¶…è¿‡åŠæ•°çš„å…ƒéªŒè¯å™¨è§‰å¾—éªŒè¯å™¨çš„å·®è¯„æ˜¯å¯¹çš„ï¼Œé‚£ä¹ˆå°±è®¤å®šæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å·®è¯„ã€‚è€Œå¦‚æœå¯¹ä¸€ä¸ªè§£é¢˜è¿‡ç¨‹ä¸­æœ‰3æ¬¡ï¼ˆå¯ä»¥äººå·¥è®¾ç½®ï¼‰çš„å·®è¯„ï¼Œåˆ™æœ¬æ¬¡è¯æ˜ç»™äºˆ0åˆ†æˆ–0.5åˆ†ï¼Œåä¹‹ç»™äºˆ1åˆ†ã€‚è¿™äº›ä¸åˆ°1åˆ†çš„æ•°æ®è¢«ç§°ä¸º<strong>é‡‡æ ·æ•°æ®</strong>ï¼Œè€Œæ»¡åˆ†æ•°æ®è¢«ç§°ä¸º<strong>æ‹’ç»é‡‡æ ·æ•°æ®</strong>ã€‚æ¥ä¸‹æ¥å°†æ‹’ç»é‡‡æ ·æ•°æ®ä»£å…¥å¯¹éªŒè¯å™¨æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œè¿™ä¸ªè‡ªåŠ¨æŒ‘é€‰æ•°æ®çš„è¿‡ç¨‹å°±è¢«ç§°ä¸ºè‡ªåŠ¨åŒ–æ ‡æ³¨ã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f3e3791e00b494d89d66977b07066dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765499647&amp;x-signature=%2BRKNbgoy%2B0iOgKtKHyKH0Tko1b4%3D" alt="18.png" loading="lazy"/></p>
<ol start="2">
<li>
<p>ç¬¬äºŒæ­¥å¸¦å…¥æ‹’ç»é‡‡æ ·æ•°æ®æ¥è¿›è¡Œæœ‰ç›‘ç£å¾®è°ƒç®—æ³•ï¼Œè¿™ä¸€æ­¥çš„æœ¬è´¨æ˜¯è®©æ¨¡å‹æŠŠå¼ºåŒ–å­¦ä¹ ä¸­åšå¯¹çš„é¢˜å½»åº•è®°ä½ï¼Œç›¸å½“äºå·©å›ºå…ˆå‰ç»éªŒã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œå¯¹èåˆæ¨¡å‹è®­ç»ƒçš„æ•°æ®è¢«åˆ†ä¸ºä¸‰ç±»ï¼šä¸€ç±»æ˜¯ç”±éªŒè¯å™¨äº§ç”Ÿçš„1åˆ†æ•°æ®ï¼Œè¾“å…¥æ˜¯æ•°å­¦é¢˜+è¯æ˜è¿‡ç¨‹+è‡ªæˆ‘è¯„ä»·ï¼Œè€Œè¾“å‡ºæ˜¯è€å¸ˆè¯„ä»·+è¯„åˆ†ï¼Œç¬¬äºŒç±»æ˜¯ç”±ç”Ÿæˆå™¨äº§ç”Ÿçš„1åˆ†æ•°æ®ï¼Œè¾“å…¥æ˜¯æ•°å­¦é¢˜ï¼Œè¾“å‡ºæ˜¯è¯æ˜è¿‡ç¨‹+è‡ªæˆ‘è¯„ä»·ï¼Œç¬¬ä¸‰ç±»æ˜¯ç”±å…ƒéªŒè¯å™¨äº§ç”Ÿçš„1åˆ†æ•°æ®ï¼Œè¾“å…¥æ—¶æ•°å­¦é¢˜+è¯æ˜è¿‡ç¨‹+è€å¸ˆè¯„ä»·ï¼Œè¾“å‡ºæ˜¯å¯¹è€å¸ˆè¯„ä»·çš„è¯„ä»·+è€å¸ˆè¯„ä»·è´¨é‡æ‰“åˆ†è¯„åˆ†ï¼Œè¿™ç§æ··åˆæ•°æ®é›†çš„æ„æˆä½¿å¾—ç”Ÿæˆå™¨åŒæ—¶å…·å¤‡ç­”é¢˜ã€æ”¹é¢˜å’Œç£å¯¼ä¸‰ç§æ¨¡å¼ï¼Œå˜æˆä¸‰åˆä¸€çš„å¤§æ¨¡å‹ã€‚ä¸æ­¤åŒæ—¶è¯¥æ¨¡å‹å°±æˆä¸ºäº†ä¸‹ä¸€æ­¥éª¤çš„åŸºåº§æ¨¡å‹ã€‚</p>
<p>è¿™ä¸ªè®­ç»ƒæ€è·¯ç†è§£èµ·æ¥éå¸¸ç®€å•ï¼Œæœ¯ä¸šæœ‰ä¸“æ”»ï¼Œå¼ºåŒ–å­¦ä¹ çš„æ¢ç´¢è¿‡ç¨‹å¾€å¾€è®©ç”Ÿæˆèƒ½åŠ›å’ŒéªŒè¯èƒ½åŠ›åœ¨å‚æ•°ç©ºé—´ä¸Šæ¸è¡Œæ¸è¿œï¼Œè€Œé€šè¿‡RFTæˆ‘ä»¬å°†ä¸¤è€…åœ¨æ¢ç´¢ä¸­ç§¯ç´¯çš„â€œæ»¡åˆ†ç»éªŒâ€ç†”å…¥ä¸€ä¸ªæ¨¡å‹ä¸­ï¼Œè¿™æ ·ä¸ä»…é¿å…äº†ç»´æŠ¤å¤šä¸ªæ¨¡å‹çš„å‰²è£‚ï¼Œä¹Ÿè®©ä¸‹ä¸€è½®è¿­ä»£æ¨¡å‹çš„å‡ºä¸–æ¨¡å‹ç›´æ¥ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œç§°ä¸ºä¸€ä¸ªåŒæ—¶å…·å¤‡æœ€å¼ºåšé¢˜èƒ½åŠ›å’Œæœ€å¼ºæ”¹é¢˜èƒ½åŠ›çš„â€œå…¨èƒ½åŸºåº§â€ï¼Œåˆ°æ­¤æ¨¡å‹å†·å¯åŠ¨é˜¶æ®µå°±å®Œæˆäº†ã€‚</p>
</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4e9c5b0c3e4142feb8cf22e873c0a3c7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765499647&amp;x-signature=HwCsyW66ZzxWlCr7SopWHVGdksc%3D" alt="19.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/174551dda08142829b50a1f2c6ba90e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765499647&amp;x-signature=PJGjEx9AWAj8p97w7ZkOhy1hqcM%3D" alt="20.png" loading="lazy"/></p>
<h4 data-id="heading-5">1.2.2 è¿­ä»£è®­ç»ƒé˜¶æ®µï¼šå¼€å¯å…¨è‡ªåŠ¨è‡ªè¿›åŒ–å¾ªç¯</h4>
<p>å†·å¯åŠ¨é˜¶æ®µå®Œæˆåï¼Œç³»ç»Ÿä¾¿è¿›å…¥å¯å®Œå…¨è„±ç¦»äººç±»æ ‡æ³¨çš„Â <strong>è‡ªè¿›åŒ–å¾ªç¯</strong>ã€‚</p>
<ol>
<li><strong>è‡ªåŠ¨åŒ–æ•°æ®ç”Ÿäº§ä¸æ ‡æ³¨</strong>ï¼šå°†æ–°çš„ã€æ— æ ‡ç­¾çš„æ•°å­¦é—®é¢˜è¾“å…¥ç³»ç»Ÿï¼Œå¤ç”¨å†·å¯åŠ¨é˜¶æ®µçš„è‡ªåŠ¨åŒ–æ ‡æ³¨æµç¨‹ï¼ˆç”Ÿæˆå™¨ç”Ÿæˆ â†’ éªŒè¯å™¨Næ¬¡è¯„åˆ† â†’ å…ƒéªŒè¯å™¨Mæ¬¡éªŒè¯ï¼‰ï¼Œäº§å‡ºä¸€æ‰¹å¸¦æœ‰è´¨é‡æ ‡ç­¾ï¼ˆ0/0.5/1åˆ†ï¼‰çš„æ–°æ•°æ®ã€‚</li>
<li><strong>è®­ç»ƒâ€œè€å¸ˆâ€</strong> ï¼šåˆ©ç”¨æ–°äº§å‡ºçš„å…¨é‡æ•°æ®ï¼ˆåŒ…å«æ­£ä¾‹å’Œåä¾‹ï¼‰å¯¹éªŒè¯å™¨è¿›è¡Œ GRPO è®­ç»ƒï¼Œæå‡å…¶é‰´åˆ«èƒ½åŠ›ã€‚</li>
<li><strong>è®­ç»ƒâ€œå­¦ç”Ÿâ€</strong> ï¼šç”¨å¢å¼ºåçš„éªŒè¯å™¨ä½œä¸ºè£åˆ¤ï¼Œå¯¹ç”Ÿæˆå™¨è¿›è¡Œ GRPO è®­ç»ƒï¼Œä½¿å…¶ç”Ÿæˆæ›´ä¼˜çš„è§£é¢˜æ–¹æ¡ˆã€‚</li>
<li><strong>æ–°ä¸€è½®èåˆ</strong>ï¼šæ”¶é›†æœ¬è½®å¾ªç¯ä¸­äº§ç”Ÿçš„æ‰€æœ‰é«˜è´¨é‡ï¼ˆ1åˆ†ï¼‰æ•°æ®ï¼Œå†æ¬¡é€šè¿‡ RFT ç®—æ³•å¯¹åŸºåº§æ¨¡å‹è¿›è¡Œå¾®è°ƒï¼Œç”Ÿæˆèƒ½åŠ›æ›´å¼ºçš„Â <strong>æ–°ä¸€ä»£ä¸‰åˆä¸€æ¨¡å‹</strong>ã€‚</li>
</ol>
<p>æ­¤è¿‡ç¨‹å‘¨è€Œå¤å§‹ï¼Œå½¢æˆä¸€ä¸ªÂ <strong>å®Œå…¨è‡ªä¸»çš„â€œå·¦å³äº’æâ€è¿›åŒ–é—­ç¯</strong>ï¼Œå³Â <strong>è‡ªéªŒè¯æ•°å­¦æ¨ç†è®­ç»ƒæ³•</strong>ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¯¥ç®—æ³•ä¾èµ–æµ·é‡çš„æ¨¡å‹è°ƒç”¨ä»¥ç”Ÿæˆä¼˜è´¨è®­ç»ƒæ•°æ®ã€‚è€Œ DeepSeek-V3.2 æ‰€é‡‡ç”¨çš„Â <strong>DSAï¼ˆç¨€ç–æ³¨æ„åŠ›ï¼‰æœºåˆ¶</strong>ï¼Œå·²å°†æ¨¡å‹è°ƒç”¨æˆæœ¬é™ä½äº†Â <strong>30%-70%</strong> ã€‚ä»è¿™ä¸ªè§’åº¦çœ‹ï¼Œè‡ªéªŒè¯æ•°å­¦æ¨ç†è®­ç»ƒæ³•å ªç§° DeepSeek ä¸ºè‡ªèº«æŠ€æœ¯æ ˆé‡èº«å®šåˆ¶çš„â€œç‹ç‰Œè®­ç»ƒæ³•â€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/022cf50eb4b04f89a7e62f52b3f37660~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765499647&amp;x-signature=mlsKswleSIYZ7dBivatwyqRa3iI%3D" alt="21.png" loading="lazy"/></p>
<h2 data-id="heading-6">äºŒã€DeepSeek-V3.2ï¼šæŠ€æœ¯è‡ªä¸»åˆ›æ–°ä¸‹çš„å¼€æºç ´å±€è€…</h2>
<p>ä¸Šé¢å†…å®¹è¯¦ç»†è®²è¿°äº†DeepSeek-Math-V2çš„è®­ç»ƒæ ¸å¿ƒç®—æ³•ï¼Œä½†DeepSeekæ¢ç´¢çš„è„šæ­¥ä»æœªåœæ­¢ï¼Œ12æœˆ1æ—¥ï¼ŒDeepSeek-V3.2è¯ç”Ÿäº†ã€‚
åœ¨OpenAIã€Claudeã€Geminiå‡ ä¹ç»Ÿæ²»æ•´ä¸ªå¤§æ¨¡å‹æŠ€æœ¯é¢†åŸŸçš„ä»Šå¤©ï¼ŒDeepSeek-V3.2æ¨¡å‹çš„å¼€æºæ— ç–‘æ˜¯ä¸ºä¸­å›½å¤§æ¨¡å‹ç”šè‡³æ•´ä¸ªå¼€æºå¤§æ¨¡å‹ç•Œæ³¨å…¥äº†ä¸€é’ˆå¼ºå¿ƒå‰‚ï¼Œè®©å¤§å®¶çœŸæ­£çœ‹åˆ°äº†æŠ€æœ¯åˆ›æ–°å¸¦æ¥çš„å¤§æ¨¡å‹æ€§èƒ½é©å‘½ã€‚</p>
<p>11æœˆ20æ—¥ï¼Œè·¨æ—¶ä»£çš„Gemini 3.0 æ¨ªç©ºå‡ºä¸–ï¼ˆå…³äºGemini 3.0 çš„ä»‹ç»å¯çœ‹ç¬”è€…æ–‡ç«  <a href="https://juejin.cn/post/7574615024293429274" target="_blank" title="https://juejin.cn/post/7574615024293429274">Gemini3.0æ·±åº¦è§£æï¼Œå®ƒåœ¨é‡æ–°å®šä¹‰æ™ºèƒ½ï¼Œä¼šæ˜¯å‰ç«¯å·¥ç¨‹å¸ˆå™©æ¢¦å—ï¼Ÿ</a>å‡­å€Ÿå…¶å¼ºå¤§çš„ç»¼åˆæ€§èƒ½å’Œç¼–ç¨‹èƒ½åŠ›ä»¥ä¸€å·±ä¹‹åŠ›å°†å¤§æ¨¡å‹æŠ€æœ¯åº”ç”¨æ¨å‘ä¸‹ä¸€é˜¶æ®µã€‚å¤§å®¶åœ¨å…´å¥‹ä¹‹ä½™æ—©å·²ç„¦æ€¥ç­‰å¾…å›½äº§DeepSeekæ–°æ¨¡å‹ä½•æ—¶æ‰èƒ½é—®ä¸–ï¼Œè¦å¦‚ä½•åº”æˆ˜ï¼è€Œä¸åˆ°ä¸¤å‘¨DeepSeekå°±ç«‹é©¬å‘Šè¯‰å¤§å®¶ï¼Œâ€œä»–å¼ºä»»ä»–å¼ºï¼Œè€å­æœ‰é”‹èŠ’â€ã€‚è™½ç„¶æ²¡æœ‰æµ·å¤–åœ¨çº¿å¤§æ¨¡å‹æ·±åšçš„æŠ€æœ¯ç§¯ç´¯ã€æµ·é‡åŸå§‹æ•°æ®ï¼Œä½†DeepSeekä»ç„¶é€šè¿‡è‡ªä¸»æŠ€æœ¯åˆ›æ–°ï¼Œç”šè‡³é€šè¿‡ä¿æŒæ›´å¿«çš„åˆ›æ–°é€Ÿåº¦ä¸å›½å¤–å¤§æ¨¡å‹å‚å•†ä¸€å†³é«˜ä¸‹ï¼Œè¿™éš¾é“ä¸å°±æ˜¯ä¸­å›½çš„â€œä¾ â€ä¹‰ç²¾ç¥ã€‚</p>
<h3 data-id="heading-7">2.1 DeepSeek-V3.2è¿›åŒ–è·¯çº¿</h3>
<p>DeepSeek-V3.2 çš„æˆåŠŸå¹¶éä¸€è¹´è€Œå°±ï¼Œå®ƒå»ºç«‹åœ¨ä¸€æ¡æ¸…æ™°çš„æ¼”è¿›è·¯çº¿ä¸Šï¼š</p>
<ol>
<li><strong>8æœˆä¸‹æ—¬</strong>ï¼šå‘å¸ƒ<a href="https://juejin.cn/post/7540131264356597799" target="_blank" title="https://juejin.cn/post/7540131264356597799"> V3.1 æ¨¡å‹</a>ï¼Œå¼•å…¥<strong>æ··åˆæ¨ç†æ¶æ„</strong>ï¼ŒR1 æ—¶ä»£å®£å‘Šç»“æŸã€‚</li>
<li><strong>9æœˆåº•</strong>ï¼šå‘å¸ƒ <a href="https://juejin.cn/post/7555687221233631278" target="_blank" title="https://juejin.cn/post/7555687221233631278">V3.2-EXP å®éªŒç‰ˆ</a>ï¼Œæå‡ºé©å‘½æ€§çš„Â <strong>DeepSeek ç¨€ç–æ³¨æ„åŠ›æœºåˆ¶</strong>ï¼Œæ¨¡å‹è°ƒç”¨æˆæœ¬éª¤é™Â <strong>50%</strong> ã€‚</li>
<li><strong>11æœˆåº•</strong>ï¼šæ¨å‡ºÂ <strong>DeepSeek-Math-V2</strong>ï¼Œå¼€åˆ›Â <strong>è‡ªéªŒè¯æ•°å­¦æ¨ç†è®­ç»ƒæ³•</strong>ï¼Œä»¥â€œå·¦å³äº’æâ€èŒƒå¼å¤§å¹…æå‡æ•°å­¦èƒ½åŠ›ã€‚</li>
</ol>
<p>æ­£æ˜¯è¿™ä¸€ç³»åˆ—åšå®çš„æŠ€æœ¯ç§¯æ·€ï¼Œä¸ºÂ <strong>2025å¹´12æœˆ1æ—¥å‘å¸ƒçš„ DeepSeek-V3.2 æ­£å¼ç‰ˆ</strong>Â æä¾›äº†ä¸ Gemini 3.0 ç­‰é¡¶å°–æ¨¡å‹ä¸€è¾ƒé«˜ä¸‹çš„èµ„æœ¬ã€‚æ­£å¼ç‰ˆä¸ä»…æ•´åˆäº†å‰è¿°æ‰€æœ‰æŠ€æœ¯åˆ›æ–°ï¼Œæ›´å¼€åˆ›æ€§åœ°æå‡ºäº†ä¸‰å¤§æ ¸å¿ƒçªç ´ï¼š</p>
<ul>
<li><strong>å¯æ‰©å±•çš„GRPOè®­ç»ƒæ¡†æ¶</strong>ï¼šä¸ºå¼ºåŒ–å­¦ä¹ åè®­ç»ƒæä¾›äº†æ›´ç¨³å®šã€é«˜æ•ˆçš„æ¶æ„åŸºç¡€ã€‚</li>
<li><strong>æ— åKLä¼°è®¡ä¸Off-Policyåºåˆ—æ©ç æŠ€æœ¯</strong>ï¼šæœ‰æ•ˆè§£å†³äº†GRPOåœ¨é•¿å‘¨æœŸè®­ç»ƒä¸­å¸¸è§çš„ç¨³å®šæ€§é—®é¢˜ã€‚</li>
<li><strong>å¤§è§„æ¨¡åˆæˆAgentä»»åŠ¡æ•°æ®é›†åˆ›å»ºæµæ°´çº¿</strong>ï¼šåŠ¨ç”¨äº†è¶…è¿‡Â <strong>1800ä¸ªæ™ºèƒ½ä½“</strong>Â ä¸Â <strong>85ä¸‡ç»„æç¤ºè¯</strong>ï¼Œæ„å»ºå‡ºæµ·é‡ã€é«˜è´¨é‡çš„Agentè®­ç»ƒæ•°æ®ã€‚</li>
</ul>
<p>æœ€ç»ˆï¼Œå‡­å€Ÿè¿œè¶…é¢„è®­ç»ƒæ•°æ®é‡çš„<strong>è¶…å¤§è§„æ¨¡å¼ºåŒ–å­¦ä¹ åè®­ç»ƒ</strong>ï¼ˆè§„æ¨¡è¶…è¿‡é¢„è®­ç»ƒçš„10å€ä»¥ä¸Šï¼‰ï¼ŒDeepSeek-V3.2 å®ç°äº†æ€§èƒ½æé™çš„çªç ´ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c2188424310d449398ef911bf738542c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765499647&amp;x-signature=1WUc%2Flx9XrrCPrbPOfQ9eKxffEE%3D" alt="3.png" loading="lazy"/></p>
<h3 data-id="heading-8">2.2 DeepSeek-V3.2æ¨¡å‹æ¦‚è§ˆï¼šåŒæ¨¡å‹å¼€æºä¸æ€§èƒ½å®šä½</h3>
<p>æœ¬æ¬¡DeepSeekå…±å¼€æºäº†ä¸¤æ¬¾æ¨¡å‹ï¼š</p>
<ul>
<li><strong>DeepSeek-V3.2</strong>ï¼šé€šç”¨ä¸»åŠ›æ¨¡å‹ã€‚</li>
<li><strong>DeepSeek-V3.2-Speciale</strong>ï¼šä¸“æ³¨äºé•¿é“¾å¤æ‚é—®é¢˜æ±‚è§£çš„å®éªŒæ€§æ¨¡å‹ã€‚</li>
</ul>
<p>æ ¹æ®å®˜æ–¹ç»™å‡ºçš„æ•°æ®,DeepSeek-V3.2åœ¨ç¼–ç¨‹ã€æ•°å­¦ã€Agenté¢†åŸŸå‡è¾¾åˆ°äº†GPT-5æ¨¡å‹çš„æ°´å‡†ï¼Œæ˜¯å¼€æºç•Œçš„No.1ã€‚ æ®å¾ˆå¤šåšä¸»å®é™…è¯„æµ‹åé¦ˆï¼ŒDeepSeek-V3.2åœ¨ç¼–ç¨‹èƒ½åŠ›æ¯”ä¸Šä¸€ä»£æœ‰å¾ˆå¤§æå‡ï¼Œä¸ä»…æ€è€ƒé“¾æ›´åŠ ç®€å•æ¸…æ™°ï¼Œè€Œä¸”ç¼–ç¨‹æ„æ„¿æå‡æ˜æ˜¾ï¼Œä¸€æ¬¡æ€§ç¼–å†™ä¸Šåƒè¡Œä»£ç æ—©å·²æ˜¯å®¶å¸¸ä¾¿é¥­ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef9e5d9d9ed0491eaa3835f435d98bed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765499647&amp;x-signature=ZL4pcu3FZk7W4YMV3eVm%2FKCjs%2F0%3D" alt="4.png" loading="lazy"/></p>
<p>è™½ç„¶ç›¸æ¯”äºç›®å‰ç¬¬ä¸€æ¢¯é˜Ÿçš„Gemini3 Proå’ŒClaude4.5 Sonnetè¿˜æœ‰10%å·¦å³çš„æ€§èƒ½å·®è·ã€‚æ­¤å¤–ï¼Œæ¨¡å‹å±•ç°äº†å¼ºå¤§çš„å…¼å®¹æ€§ï¼Œå…¶â€œæ€è€ƒæ¨¡å¼â€å·²å¢åŠ å¯¹Â <strong>Claude Code</strong>Â è½¯ä»¶çš„åŸç”Ÿæ”¯æŒï¼ˆéœ€å°†æ¨¡å‹åæ”¹ä¸ºÂ <code>deepseek-reasoner</code>ï¼‰ã€‚ä½†éœ€æ³¨æ„ï¼Œå¯¹äº Clineã€RooCode ç­‰ä½¿ç”¨éæ ‡å‡†å·¥å…·è°ƒç”¨çš„ç»„ä»¶ï¼Œå®˜æ–¹å»ºè®®ä»ä½¿ç”¨â€œéæ€è€ƒæ¨¡å¼â€ä»¥è·å¾—æœ€ä½³å…¼å®¹æ€§ã€‚</p>
<h3 data-id="heading-9">2.3 DeepSeek-V3.2æ ¸å¿ƒçªç ´ï¼šAgentæ€§èƒ½è·¨è¶Šæå‡</h3>
<p>è¿™æ¬¡DeepSeek-V3.2æ¨¡å‹æœ€ä»¤äººç©ç›®çš„å°±æ˜¯Agentæ€§èƒ½çš„å·¨å¤§æå‡ï¼Œå’ŒGemini3, Claude 4.5ç­‰æ¨¡å‹çš„å·®è·å·²ç»ä¸åˆ°5%, å¹¶ä¸”deepseeké¦–æ¬¡å¼•å…¥â€œ<strong>æ€è€ƒæ¨¡å¼ä¸‹å·¥å…·è°ƒç”¨</strong>â€çš„åŠŸèƒ½ï¼Œå…è®¸æ¨¡å‹åœ¨å•è½®ä»»åŠ¡è°ƒç”¨è¿‡ç¨‹ä¿æŒå¤šæ­¥å·¥å…·è°ƒç”¨æ€ç»´é“¾è®°å¿†ï¼Œä¹Ÿå°±æ˜¯åƒäººä¸€æ ·è¾¹æ€è€ƒè¾¹è°ƒç”¨å·¥å…·ï¼Œä»è€Œå¤§å¹…æå‡å¤šæ­¥è°ƒç”¨å·¥å…·çš„å‰åä¸€è‡´æ€§ï¼Œæ˜¾è‘—æå‡æ¨¡å‹Agentæ€§èƒ½ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f834cc542ac453ba9d237f3f3243888~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765499647&amp;x-signature=mPt6%2BimEuCQsPC%2B0F%2FVHmDTaHoU%3D" alt="5.png" loading="lazy"/></p>
<h3 data-id="heading-10">2.4 DeepSeek-V3.2-Specialeï¼šæè‡´çš„å®éªŒæ¢ç´¢</h3>
<p>é™¤äº†DeepSeek-V3.2ä¹‹å¤–ï¼Œæœ¬æ¬¡DeepSeekè¿˜åŒæ­¥å¼€æºäº†ä¸€æ¬¾å®éªŒæ€§è´¨çš„æ¨¡å‹ï¼ŒDeepSeek-V3.2-Specialeã€‚</p>
<p>å’ŒDeepSeek-V3.2ä¸åŒï¼ŒSpecialeæ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­é‡‡ç”¨äº†çº¯æ¨ç†æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œå¹¶ä¸”æ”¾å®½äº†æ™®é€šæ¨¡å‹éƒ½ä¼šæœ‰çš„æ¨ç†é•¿åº¦æƒ©ç½šæœºåˆ¶ï¼Œä½¿å¾—Specialeæ›´åŠ æ“…é•¿é€šè¿‡é•¿æ€è€ƒæ¥è§£å†³é—®é¢˜ï¼ŒåŒæ—¶è¿˜å¼•å…¥äº†DeepSeek-Math-V2çš„è‡ªéªŒè¯æ•°å­¦æ¨ç†è®­ç»ƒæ³•ï¼Œå€ŸåŠ©å·¦å³äº’ææ¥çªç ´æ•°å­¦èƒ½åŠ›æé™ã€‚</p>
<p>æ ¹æ®è¯„æµ‹ç»“æœæ¥çœ‹ï¼ŒDeepSeek-V3.2-Specialeæ¨¡å‹åœ¨å„ä¸»æµè¯„æµ‹æ•°æ®é›†ä¸Šï¼Œæ— è®ºæ˜¯æ•°å­¦ã€ç¼–ç¨‹è¿˜æ˜¯HLEã€Agentæ€§èƒ½ç­‰å„ä¸ªæ–¹é¢ï¼Œå‡è¾¾åˆ°äº†Gemini 3.0 Proçš„æ°´å¹³ï¼Œå¹¶ä¸”ç›®å‰Specialeæ¨¡å‹æƒé‡ä¹ŸåŒæ­¥å¼€æºï¼Œ</p>
<p>å¦‚æœè¦è°ƒç”¨specialeçš„api, è¿˜éœ€è¦æ›´æ¢å¦‚ä¸‹å›¾æ‰€ç¤ºçš„base_url. è™½ç„¶ç»è¿‡å®æµ‹Specialeæ¨¡å‹ç¡®å®å¾ˆå¼ºï¼Œå¯¹äºè¾“å…¥çš„å¤æ‚æ•°å­¦ç¼–ç¨‹é—®é¢˜å‡èƒ½è§£å†³ï¼Œä½†å¤§å®¶è¿˜è¦æ³¨æ„Specialeæ¨¡å‹ç›®å‰å¤„äºå®éªŒé˜¶æ®µï¼Œåªèƒ½ç”¨äºè§£å†³å¤æ‚æ•°å­¦ç¼–ç¨‹é—®é¢˜ï¼Œæ— æ³•å¾ˆå¥½åº”å¯¹æ™®é€šå¯¹è¯é—®é¢˜ï¼Œå®˜æ–¹é™å®šè¯¥æ¨¡å‹ä¸12æœˆ15æ—¥APIæ­£å¼ä¸‹çº¿ï¼Œä½†è°åˆèƒ½çŸ¥é“è¿™æ˜¯ä¸æ˜¯é¢„ç¤ºç€ä¸‹ä¸€ä»£specialeæ¨¡å‹å·²ç»åœ¨è®­ç»ƒä¹‹ä¸­äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6062bcb8a64845c1831d945bfbcd358e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765499647&amp;x-signature=O60se1QZkFBDwTZzkGheERF6HkI%3D" alt="7.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/74e235ca0bd24c7eb9a3d52070461331~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5qih5Z6L55yf5aW9546p:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765499647&amp;x-signature=Q3BxE97yqaQ4nCGFhEjVKHWYyIM%3D" alt="8.png" loading="lazy"/></p>
<h2 data-id="heading-11">ä¸‰ã€æ€»ç»“å±•æœ›</h2>
<p>2025å¹´çš„å²æœ«å›æœ›ï¼Œä½œä¸ºå›½äº§å¤§æ¨¡å‹çš„æ°å‡ºä»£è¡¨ï¼ŒDeepSeekåœ¨è¿‡å»ä¸€å¹´ä¸­å®Œæˆäº†ä¸€åœºä»¤äººæƒŠå¹çš„æŠ€æœ¯è·ƒè¿ã€‚ä»æ¶æ„åˆ›æ–°åˆ°è®­ç»ƒèŒƒå¼çªç ´ï¼Œä»å¼€æºç”Ÿæ€å»ºè®¾åˆ°é¡¶å°–æ€§èƒ½å¯¹æ ‡ï¼Œå®ƒçš„æ¯ä¸€æ­¥éƒ½åšå®è€Œæ¸…æ™°ã€‚æœ¬æ–‡å¯¹Â <strong>DeepSeek-Math-V2</strong>Â ä¸Â <strong>DeepSeek-V3.2</strong>Â çš„è§£è¯»ï¼Œä¹Ÿæ­£æ˜¯è¿™ä¸€å¹´æ¥è¿½è¸ªä¸è§è¯å…¶æŠ€æœ¯è¿›åŒ–çš„ä¸€ä¸ªç¼©å½±ã€‚</p>
<p>ç¬”è€…çš„æ–‡ç« è¿½éšäº†ä¸€æ•´å¹´DeepSeekçš„æ›´æ–°è½¨è¿¹ä¸è§£è¯»ï¼Œä¸ä»…ä»…åªä¸ºå¤§å®¶ä»‹ç»äº†DeepSeekæ¨¡å‹çš„æœ€æ–°æŠ€æœ¯ï¼Œçœ‹ç€DeepSeekä¸€æ­¥ä¸€æ­¥æˆé•¿ä¸ºä¸–ç•Œä¹‹å·…ï¼Œæ›´å¸Œæœ›é€šè¿‡ç¬”è€…å¾®åšçš„åŠªåŠ›ï¼Œä¸ºå¤§å®¶ç§‘æ™®å¤§æ¨¡å‹çš„åŸºç¡€çŸ¥è¯†ã€‚</p>
<p>æœªæ¥æ—¶ä»£å¤§æ¨¡å‹ä¸€å®šä¼šæ˜¯æœ€åŸºç¡€çš„è®¾æ–½ï¼Œå’Œç°åœ¨çš„PCï¼Œæ‰‹æœºä¸€æ ·ï¼Œåœ¨å½“å‰ä¸­ç¾AIè§’åŠ›çš„å…³é”®é˜¶æ®µï¼Œå¤§å®¶è°æ›´æ‹¥æŠ±AIè°å°±æŒæ¡æœªæ¥ã€‚ç¬”è€…å‘¼åå¹¶æœŸå¾…ï¼šç»™äºˆåƒDeepSeekè¿™æ ·åšæŒæŠ€æœ¯çªç ´ä¸å¼€æºå¼€æ”¾çš„å›½äº§æ¨¡å‹<strong>æ›´å¤šçš„å…³æ³¨ã€ä½¿ç”¨ä¸åé¦ˆ</strong>ã€‚æ¯ä¸€æ¬¡è®¨è®ºã€æ¯ä¸€è¡Œä»£ç ã€æ¯ä¸€ä¸ªåŸºäºå…¶æ„å»ºçš„åº”ç”¨ï¼Œéƒ½æ˜¯åœ¨ä¸ºè¿™ç‰‡æŠ€æœ¯åœŸå£¤å¢æ·»å…»åˆ†ã€‚ä¼—äººçš„æ”¯æŒï¼Œå°†æ˜¯æ‰€æœ‰åˆ›æ–°è€…æœ€åšå®çš„åç›¾ï¼Œè¶³ä»¥è®©ä¸­å›½ç«™ä¸Šä¸–ç•ŒAIä¹‹å·…ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å…¶å®Creatoré‡Œé¢è¿™ä¸ªè£å‰ªä»£ç çš„åŠŸèƒ½å¾ˆå¥½ç”¨ï¼Œå»ºè®®è¯•è¯•]]></title>    <link>https://juejin.cn/post/7579871631096496154</link>    <guid>https://juejin.cn/post/7579871631096496154</guid>    <pubDate>2025-12-05T00:44:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579871631096496154" data-draft-id="7579889969985208371" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…¶å®Creatoré‡Œé¢è¿™ä¸ªè£å‰ªä»£ç çš„åŠŸèƒ½å¾ˆå¥½ç”¨ï¼Œå»ºè®®è¯•è¯•"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-05T00:44:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº¿å…ƒç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/1972988307323236"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…¶å®Creatoré‡Œé¢è¿™ä¸ªè£å‰ªä»£ç çš„åŠŸèƒ½å¾ˆå¥½ç”¨ï¼Œå»ºè®®è¯•è¯•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972988307323236/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº¿å…ƒç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T00:44:49.000Z" title="Fri Dec 05 2025 00:44:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ç‚¹å‡»ä¸Šæ–¹äº¿å…ƒç¨‹åºå‘˜+å…³æ³¨å’Œâ˜…æ˜Ÿæ ‡</p>
<h2 data-id="heading-0">å¼•è¨€</h2>
<p><strong>å“ˆå–½å¤§å®¶å¥½</strong>ï¼Œæ— è®ºæ˜¯ä¸ªäººçš„å°æ¸¸æˆé¡¹ç›®è¿˜æ˜¯å…¬å¸çš„å•†ä¸šæ¸¸æˆé¡¹ç›®ï¼Œé€šå¸¸éƒ½ä¼šè¿›è¡Œå¤šå¹³å°åˆ†å‘ã€‚</p>
<p><strong>ä¾‹å¦‚</strong>ä¸ªäººå°æ¸¸æˆå¯ä»¥ä¸Šæ¶å¾®ä¿¡å°æ¸¸æˆã€æŠ–éŸ³å°æ¸¸æˆï¼Œå…¬å¸çš„å•†ä¸šæ¸¸æˆé™¤äº†å¯ä»¥ä¸Šæ¶å‰é¢ä¸¤ä¸ªå¹³å°å¤–ï¼Œè¿˜å¯ä»¥ä¸Šæ¶æ¸ é“(OVå)ã€<code>AppStore</code>ç­‰ç­‰ã€‚</p>
<p><strong>æ¸¸æˆ</strong>è¦ä¸Šæ¶ä¸åŒçš„å¹³å°ï¼Œæ„å‘³ç€è¦æ¥å…¥ä¸åŒçš„<code>SDK</code>ï¼Œç‰¹åˆ«åœ¨æ¸¸æˆå¿«è¦ä¸è¡Œçš„æ—¶å€™ï¼Œå°è¯•æ›´å¤šå¹³å°(btã€0.1ç­‰ç­‰)ï¼Œä¹…è€Œä¹…ä¹‹ï¼Œå¯¹æ¥ä¸åŒå¹³å°/æ¸ é“çš„ä»£ç ä¼šè¶Šæ¥è¶Šå¤šã€‚</p>
<p><strong>äº‹å®ä¸Š</strong>ï¼ŒæŸä¸ªå¹³å°/æ¸ é“çš„æ¥å…¥ä»£ç ï¼Œåªæœ‰å¯¹åº”çš„é‚£ä»½ä»£ç æ‰ä¼šæœ‰ç”¨ï¼Œå…¶ä»–çš„éƒ½æ˜¯å¤šä½™çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠŠå¤šä½™çš„ä»£ç æ ¹æ®ä¸åŒçš„å¹³å°è¿›è¡Œè£å‰ªã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/390dfe45f05c453f8d96ee2218fc2243~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=NfhvtvampPqf5gzRFnIDMfwefoU%3D" alt="" loading="lazy"/></p>
<p><strong>ä¸Šé¢</strong>æ˜¯éš”å£<code>Unity</code>é€šè¿‡å®å®šä¹‰çš„æ–¹å¼ï¼Œå¯¹ä»£ç è¿›è¡Œè£å‰ªï¼Œé’ˆå¯¹ä¸åŒçš„å¹³å°ã€ç‰ˆæœ¬å†™ä¸åŒçš„ä»£ç è¿›è¡Œå…¼å®¹ã€‚å…¶å®åœ¨<code>Creator</code>é‡Œé¢ä¹Ÿæœ‰çš„ï¼Œå¾ˆå¤šäººéƒ½ä¸çŸ¥é“ã€‚</p>
<p><strong>è¨€å½’æ­£ä¼ </strong>ï¼Œæœ¬æœŸå¸¦å¤§å®¶ä¸€èµ·æ¥çœ‹çœ‹ï¼Œå¦‚ä½•åœ¨<code>Cocos</code>æ¸¸æˆå¼€å‘ä¸­ï¼Œ<strong>è‡ªå®šä¹‰æ’ä»¶æ ¹æ®ä¸åŒå¹³å°åˆ©ç”¨å®å®šä¹‰è£å‰ªä»£ç </strong>ã€‚</p>
<p><strong>æœ¬æ–‡æºå·¥ç¨‹å¯åœ¨æ–‡æœ«è·å–ï¼Œå°ä¼™ä¼´ä»¬è‡ªè¡Œå‰å¾€ã€‚</strong></p>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯å®å®šä¹‰ï¼Ÿ</h2>
<p><strong>ç›¸ä¿¡</strong>å°ä¼™ä¼´ä»¬åˆšæ¥è§¦ç¼–ç¨‹æ—¶ï¼Œå­¦è¿‡<code>Cè¯­è¨€</code>çš„éƒ½äº†è§£å®å®šä¹‰ï¼š</p>
<blockquote>
<p><strong>å®å®šä¹‰</strong>ï¼ˆmacroï¼‰æ˜¯ç¼–ç¨‹è¯­è¨€ä¸­ä¸€ç§é¢„å¤„ç†æœºåˆ¶ã€‚</p>
</blockquote>
<p><strong>ä¾‹å¦‚</strong><code>#define ï¼› ;</code>(ä¸¾ä¸ªä¾‹å­æ´»è·ƒä¸‹æ°”æ°›ï¼Œè¿™æ ·å†™æ˜¯ä¸å¯¹çš„)ï¼Œæ­£ç¡®çš„ç”¨æ³•å¦‚ä¸‹<code>#define MAX(a,b) ((a)&gt;(b)?(a):(b))</code>ï¼Œå°†æ¯”è¾ƒå¤§å°çš„æ–¹æ³•ç”¨<code>MAX</code>ä»£æ›¿ã€‚</p>
<p><strong>ä¸å®å®šä¹‰å¯†åˆ‡ç›¸å…³çš„æ˜¯æ¡ä»¶ç¼–è¯‘ã€‚</strong></p>
<h2 data-id="heading-2">ä»€ä¹ˆæ˜¯æ¡ä»¶ç¼–è¯‘ï¼Ÿ</h2>
<blockquote>
<p><strong>æ¡ä»¶ç¼–è¯‘</strong>æ˜¯æ ¹æ®é¢„å®šä¹‰çš„æ¡ä»¶ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µé€‰æ‹©æ€§åœ°åŒ…å«æˆ–æ’é™¤ä¸€éƒ¨åˆ†æºä»£ç ã€‚ç¼–è¯‘å™¨åªä¼šç¼–è¯‘é‚£äº›æ»¡è¶³æ¡ä»¶çš„ä»£ç å—ï¼Œè€Œå¿½ç•¥ä¸æ»¡è¶³æ¡ä»¶çš„éƒ¨åˆ†ã€‚</p>
<p><strong>æ¡ä»¶ç¼–è¯‘</strong>éœ€è¦åŸºäºæŸäº›â€œæ¡ä»¶â€æ¥åšå†³å®šï¼Œè¿™äº›æ¡ä»¶é€šå¸¸å°±æ˜¯æ˜¯å¦å®šä¹‰äº†æŸä¸ªå®ï¼Œæˆ–è€…å®çš„å€¼æ˜¯ä»€ä¹ˆã€‚</p>
</blockquote>
<p><strong>é€šä¿—åœ°ç†è§£</strong>å°±æ˜¯ï¼Œä¸ç¬¦åˆå®å®šä¹‰å†…çš„ä»£ç ï¼Œä¼šåœ¨ç¼–è¯‘å"åˆ æ‰"ã€‚</p>
<p><strong>ä¾‹å¦‚</strong><code>Cè¯­è¨€</code>ä¸­æ ¹æ®ä¸åŒæ“ä½œç³»ç»Ÿè¾“å‡ºä¸åŒçš„å†…å®¹ã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> _WIN32</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Running on Windows.\n"</span>);
<span class="hljs-meta">#<span class="hljs-keyword">elif</span> __linux__</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Running on Linux.\n"</span>);
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
</code></pre>
<p><strong>åˆå¦‚</strong><code>Unity</code>ä¸­çš„è‡ªå¸¦çš„ç¼–è¾‘å™¨ã€ä¸åŒå¹³å°çš„å®ã€‚</p>
<pre><code class="hljs language-c#" lang="c#">
<span class="hljs-meta">#<span class="hljs-keyword">if</span> UNITY_EDITOR</span>
    <span class="hljs-comment">// Unity ç¼–è¾‘å™¨å†…è¿è¡Œ</span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">if</span> UNITY_IOS</span>
    <span class="hljs-comment">// iOS å¹³å°</span>
<span class="hljs-meta">#<span class="hljs-keyword">elif</span> UNITY_ANDROID</span>
    <span class="hljs-comment">// Android å¹³å°</span>
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
</code></pre>
<p><strong>é‚£Creatorå‘¢ï¼Ÿ</strong></p>
<h2 data-id="heading-3">Creatorä¸­çš„å®å®šä¹‰</h2>
<p><strong>Creator</strong>ä¸­çš„å®å®šä¹‰å¯ä»¥é€šè¿‡èœå•<code>é¡¹ç›®-&gt;é¡¹ç›®è®¾ç½®-&gt;å®é…ç½®</code>æ‰“å¼€é¢æ¿è¿›è¡Œç¼–è¾‘(<code>CRUD</code>)ã€‚</p>
<p><strong>å¦‚å›¾</strong>æˆ‘ä»¬å®šä¹‰äº†<code>ANDROID</code>ã€<code>DEBUG</code>ã€<code>LOG</code>ä¸‰ä¸ªå®ï¼Œæ‰“é’©åè¡¨ç¤ºè¯¥å®ç”Ÿæ•ˆï¼Œæ ¹æ®å®é™…è¦æ±‚æ‰“é’©å³å¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3cf01d5d576d48beb4415f6e6b6b8552~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=FrUxHmzHXTZPQ%2BbLK9jL2lZHfIw%3D" alt="" loading="lazy"/></p>
<p><strong>ä½¿ç”¨æ–¹æ³•</strong>å¦‚ä¸‹:</p>
<ul>
<li>
<p>é€šè¿‡<code>import { ANDROID, LOG, DEBUG } from 'cc/userland/macro';</code>
å¼•å…¥å¯¹åº”çš„å®ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e80737a0a3794508bb3177395519220a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=gwI9t%2Be%2FkjCHe5KZambWgIm8KRM%3D" alt="" loading="lazy"/></p>
</li>
<li>
<p>é€šè¿‡å¸¸è§„çš„<code>if</code>ã€<code>else</code>åˆ¤æ–­å³å¯ï¼Œç¼–è¯‘ååªä¼šä¿ç•™ç¬¦åˆæ¡ä»¶åˆ†æ”¯å†…çš„ä»£ç ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1239e8d017e4b148904732b4c04f09b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=J0Ftr%2FLrCGcGTh2%2F4tInGMvGEK8%3D" alt="" loading="lazy"/></p>
</li>
</ul>
<h2 data-id="heading-4">è‡ªå®šä¹‰æ’ä»¶è£å‰ªä»£ç å®ä¾‹</h2>
<p><strong>è¦å®ç°</strong>åœ¨ä¸åŒçš„å¹³å°ï¼Œæ¿€æ´»ä¸åŒçš„å®ï¼Œä¿ç•™æŒ‡å®šçš„ä»£ç ï¼Œæˆ‘ä»¬éœ€è¦åŠ¨æ€åœ°æ”¹å˜å®çš„å€¼ã€‚</p>
<p><strong>å®ä¾‹</strong>é€šè¿‡è‡ªå®šä¹‰æ’ä»¶æ¥å®ç°ã€‚</p>
<h3 data-id="heading-5">1.åˆ›å»ºæ’ä»¶</h3>
<p><strong>é¦–å…ˆ</strong>è¦åˆ›å»ºæˆ‘ä»¬çš„æ’ä»¶ï¼Œé€šè¿‡èœå•<code>æ‰©å±•-&gt;åˆ›å»ºæ‰©å±•</code>æ‰“å¼€æ‰©å±•åˆ›å»ºé¢æ¿,é€‰æ‹©æ„å»ºæ’ä»¶ï¼Œå¹¶ä¸”é€šè¿‡æ‰©å±•ç®¡ç†å™¨å¯ç”¨æ’ä»¶ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f041837ec30848cb9d860785153405f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=KUvEbQevxuhNJxXQfypVJEFtyDk%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-6">2.æ‰©å±•æ„å»ºé¢æ¿</h3>
<p><strong>åœ¨</strong><code>builder.ts</code>ä¸­ï¼Œåˆ é™¤ä¸éœ€è¦çš„ä»£ç ï¼Œæ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰å®çš„è¾“å…¥æ¡†ï¼Œç”¨äºä¸åŒçš„å¹³å°è¾“å…¥æŒ‡å®šçš„å®ï¼Œç”¨<code>;</code>éš”å¼€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18c96657181a44dfad7f2c359db8ce36~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=HfxAwAmJUG1PEJoo6%2BUM29ycUS0%3D" alt="" loading="lazy"/></p>
<p><strong>æ•ˆæœå¦‚ä¸‹</strong>ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de107665f66448afaafa1af360823a2b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=x18AvwyMmziRmckaNVHxgFrFOm4%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">3.æ’ä»¶æ•´ä½“æµç¨‹</h3>
<blockquote>
<p><code>å¼€å§‹â€”&gt;æ„å»ºå‰è§£æé¢æ¿è¾“å…¥çš„å®-&gt;è¯»å–å·²æœ‰å®é…ç½®-&gt;ä¿®æ”¹æ¿€æ´»å¯¹åº”çš„å®-&gt;ä¿å­˜æ–°çš„å®é…ç½®-&gt;æ„å»º-&gt;æ„å»ºåæ¢å¤å¯¹åº”çš„å®-&gt;ç»“æŸ</code></p>
</blockquote>
<ul>
<li>
<p><strong>æ„å»ºå‰å¤„ç†</strong>ï¼šåœ¨<code>onBeforeBuild</code>ä¸­è¿›è¡Œæ„å»ºå‰å¤„ç†ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b48b6e52da648db9c80857341e2238b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=iForhCGiHkBzhCFpjN0NzMg%2B67E%3D" alt="" loading="lazy"/></p>
</li>
<li>
<p><strong>è§£æè¾“å…¥çš„å®</strong>ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c25ab0c304374a31aeafe628b66f94ae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=wwETSIxw611QZFtciaPwR3rcZVQ%3D" alt="" loading="lazy"/></p>
</li>
<li>
<p><strong>è¯»å–å·²æœ‰å®é…ç½®</strong>ï¼Œé…ç½®åœ¨æ–‡ä»¶<code>settings\v2\packages\engine.json</code>ï¼Œé€šè¿‡<code>fs</code>æ¨¡å—è¯»å–å†…å®¹ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/537311452fbf48718bd3cfd7364c1802~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=rVmjFlD8fp8K5pU3xaqJ7Yzw4rI%3D" alt="" loading="lazy"/></p>
</li>
<li>
<p><strong>å†…å®¹</strong>åœ¨<code>macroCustom</code>å­—æ®µä¸­ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6cc2c25604d946b1a682525607c9f717~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=XC3rMvoV208qiSMkcvIGyp5TJ64%3D" alt="" loading="lazy"/></p>
</li>
<li>
<p><strong>ä¿®æ”¹æ¿€æ´»å¯¹åº”çš„å®</strong>ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/798cab0f06454997bf12b55af249745e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=htrtsek8EiZ0a6ouM6b7SGetFOQ%3D" alt="" loading="lazy"/></p>
</li>
<li>
<p><strong>ä¿å­˜æ–°çš„å®é…ç½®</strong>:é€šè¿‡<code>await Editor.Message.request('project', 'set-config', 'engine', 'macroCustom', engineConfig.macroCustom);</code>æ¶ˆæ¯è¿›è¡Œä¿å­˜ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d21205d21fe4e8e875617402d779b15~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=6ZQAktBbqElL50WrHAyEpHEUCoU%3D" alt="" loading="lazy"/></p>
</li>
<li>
<p><strong>æ„å»ºåæ¢å¤å®é…ç½®</strong>ï¼šä¸ºäº†é¿å…æ„å»ºåå®å½±å“äº†å…¶ä»–å¹³å°ï¼Œæˆ‘ä»¬éœ€è¦å°†å¯¹åº”çš„å®è¿›è¡Œæ¢å¤ï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ab446330d845485583aff2baa14dffd1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=%2BCMPXWbodqWFWngouifZN6xzSSE%3D" alt="" loading="lazy"/></p>
</li>
</ul>
<h3 data-id="heading-8">4.æ•ˆæœæ¼”ç¤º</h3>
<p><strong>åœ¨æ’ä»¶ç›®å½•</strong>ï¼Œå®‰è£…ä¾èµ–<code>npm install</code>å’Œæ„å»ºæ’ä»¶<code>npm run build</code>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ce419c5873e04fbd8b6ee7d93f07f326~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=secfgyHYUb%2BdIUR3zUuvFNfrTm4%3D" alt="" loading="lazy"/></p>
<p><strong>æ–°å»º</strong><code>android</code>å¹³å°ï¼Œè‡ªå®šä¹‰å®ä¸­è¾“å…¥<code>ANDROID;DEBUG;LOG</code>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e93a6392bd04600b63c80f3fc2d38a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=bnfplmLH%2FZMXTeB7SZV11y1Nohw%3D" alt="" loading="lazy"/></p>
<p><strong>æ–°å»º</strong><code>web</code>å¹³å°ï¼Œè‡ªå®šä¹‰å®ä¸­è¾“å…¥<code>DEBUG;LOG</code>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71dee0b18db24ee8a3d7ea204a4591a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=JcoMkZRRKWaunnwNexnaDsxcnZo%3D" alt="" loading="lazy"/></p>
<p><strong>åˆ†åˆ«</strong>è¿›è¡Œæ„å»ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/749ff8539e534434a0281462453ca8ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=IdK3Mrk3EcxKrWHHMn9N%2Bwu%2FJPI%3D" alt="" loading="lazy"/></p>
<p><strong>æ„å»ºå®Œ</strong>å¯ä»¥çœ‹åˆ°ï¼Œåªä¿ç•™äº†å¯¹åº”å®å†…çš„ä»£ç ï¼Œ<code>ifã€elseéƒ½å‰”é™¤äº†</code>ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/38232a69c16d4339830d84d5b206f012~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=Wb3sywNP81J9nGCnZICnUvTGo1g%3D" alt="" loading="lazy"/>
<strong>android</strong>:
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3400bec18bf4d4c8b25608cf3e9cc73~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=a3TPOfFwPP9R3n9%2F1O7DWpbRIX0%3D" alt="" loading="lazy"/>
<strong>web</strong>:
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/198d41852af044d0bb00601d4f313d05~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500288&amp;x-signature=t0RTGd%2BwmfIDfTCWTL9XLFXKvwI%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-9">ç»“è¯­</h2>
<p><strong>Creator</strong>é‡Œé¢è¿™ä¸ªè£å‰ªä»£ç çš„åŠŸèƒ½çœŸçš„å¾ˆå¥½ç”¨ã€‚</p>
<p><strong>å°ä¼™ä¼´ä»¬</strong>è§‰å¾—å¦‚ä½•å‘¢ï¼Ÿ</p>
<p><strong>æœ¬æœŸå®Œæ•´ç¤ºä¾‹å·¥ç¨‹</strong>å¯ä»¥é€šè¿‡<a href="https://link.juejin.cn?target=https%3A%2F%2Fweidian.com%2Fitem.html%3FitemID%3D7626130648" target="_blank" title="https://weidian.com/item.html?itemID=7626130648" ref="nofollow noopener noreferrer">é˜…è¯»åŸæ–‡</a>è·å–ï¼Œè¿™ä¸ä»…æ˜¯çŸ¥è¯†çš„è·å–ï¼Œæ›´æ˜¯å¯¹ç¬”è€…çš„æ”¯æŒå’Œè®¤å¯ï¼Œæ„Ÿè°¢æ”¯æŒï¼</p>
<p><strong>æˆ‘æ˜¯"äº¿å…ƒç¨‹åºå‘˜"ï¼Œä¸€ä½æœ‰ç€8å¹´æ¸¸æˆè¡Œä¸šç»éªŒçš„ä¸»ç¨‹ã€‚åœ¨æ¸¸æˆå¼€å‘ä¸­ï¼Œå¸Œæœ›èƒ½ç»™åˆ°æ‚¨å¸®åŠ©, ä¹Ÿå¸Œæœ›é€šè¿‡æ‚¨èƒ½å¸®åŠ©åˆ°å¤§å®¶ã€‚</strong></p>
<p>AD:ç¬”è€…çº¿ä¸Šçš„å°æ¸¸æˆã€Šæ‰“èºä¸é—¯å…³ã€‹ã€Šè´ªåƒè›‡æŒæœºç»å…¸ã€‹ã€Šé‡åŠ›è¿·å®«çƒã€‹ã€Šå¡«è‰²ä¹‹æ—…ã€‹ã€Šæ–¹å—æŒæœºç»å…¸ã€‹å¤§å®¶å¯ä»¥è‡ªè¡Œç‚¹å‡»æœç´¢ä½“éªŒã€‚</p>
<p>å®ä¸ç›¸ç’ï¼Œæƒ³è¦ä¸ª<strong>èµ</strong>å’Œ<strong>çˆ±å¿ƒ</strong>ï¼è¯·æŠŠè¯¥æ–‡ç« <strong>åˆ†äº«</strong>ç»™ä½ è§‰å¾—æœ‰éœ€è¦çš„å…¶ä»–å°ä¼™ä¼´ã€‚è°¢è°¢ï¼</p>
<p>æ¨èä¸“æ ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fmp%2Fappmsgalbum%3F__biz%3DMzg5NTY2MjIzMg%3D%3D%26action%3Dgetalbum%26album_id%3D3175880857546129410%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg5NTY2MjIzMg==&amp;action=getalbum&amp;album_id=3175880857546129410#wechat_redirect" ref="nofollow noopener noreferrer">çŸ¥è¯†ä»˜è´¹ä¸“æ </a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzg5NTY2MjIzMg%3D%3D%26mid%3D2247487282%26idx%3D1%26sn%3De3cb8ab6f5c0d5f804d5c29e2e90b9ad%26chksm%3Dc00daec5f77a27d33933e877464d8cde24c4c947d3755f5e8262c634634617e7c26de3953a54%26token%3D336413522%26lang%3Dzh_CN%23rd" target="_blank" title="https://mp.weixin.qq.com/s?__biz=Mzg5NTY2MjIzMg==&amp;mid=2247487282&amp;idx=1&amp;sn=e3cb8ab6f5c0d5f804d5c29e2e90b9ad&amp;chksm=c00daec5f77a27d33933e877464d8cde24c4c947d3755f5e8262c634634617e7c26de3953a54&amp;token=336413522&amp;lang=zh_CN#rd" ref="nofollow noopener noreferrer">ä½ çŸ¥é“å’Œä¸çŸ¥é“çš„å¾®ä¿¡å°æ¸¸æˆå¸¸ç”¨APIæ•´ç†ï¼Œèµ¶ç´§æ”¶è—ç”¨èµ·æ¥~</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fmp%2Fappmsgalbum%3F__biz%3DMzg5NTY2MjIzMg%3D%3D%26action%3Dgetalbum%26album_id%3D3207702867494305797%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg5NTY2MjIzMg==&amp;action=getalbum&amp;album_id=3207702867494305797#wechat_redirect" ref="nofollow noopener noreferrer">100ä¸ªCocoså®ä¾‹</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fmp%2Fappmsgalbum%3F__biz%3DMzg5NTY2MjIzMg%3D%3D%26action%3Dgetalbum%26album_id%3D3073771187570999299%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg5NTY2MjIzMg==&amp;action=getalbum&amp;album_id=3073771187570999299#wechat_redirect" ref="nofollow noopener noreferrer">8å¹´ä¸»ç¨‹æ‰‹æŠŠæ‰‹æ‰“é€ Cocosç‹¬ç«‹æ¸¸æˆå¼€å‘æ¡†æ¶</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fmp%2Fappmsgalbum%3F__biz%3DMzg5NTY2MjIzMg%3D%3D%26action%3Dgetalbum%26album_id%3D3121583619634626562%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=Mzg5NTY2MjIzMg==&amp;action=getalbum&amp;album_id=3121583619634626562#wechat_redirect" ref="nofollow noopener noreferrer">å’Œ8å¹´æ¸¸æˆä¸»ç¨‹ä¸€èµ·å­¦ä¹ è®¾è®¡æ¨¡å¼</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fmp%2Fappmsgalbum%3Faction%3Dgetalbum%26__biz%3DMzg5NTY2MjIzMg%3D%3D%26scene%3D1%26album_id%3D3038883468588089350%26count%3D3%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/mp/appmsgalbum?action=getalbum&amp;__biz=Mzg5NTY2MjIzMg==&amp;scene=1&amp;album_id=3038883468588089350&amp;count=3#wechat_redirect" ref="nofollow noopener noreferrer">ä»é›¶å¼€å§‹å¼€å‘è´ªåƒè›‡å°æ¸¸æˆåˆ°ä¸Šçº¿ç³»åˆ—</a></p>
<p>ç‚¹å‡»ä¸‹æ–¹ç°è‰²æŒ‰é’®+å…³æ³¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Trilium Notesï¼šæ„å»ºä¸ªäººçŸ¥è¯†åº“çš„å¼€æºç¥å™¨]]></title>    <link>https://juejin.cn/post/7579906040536596526</link>    <guid>https://juejin.cn/post/7579906040536596526</guid>    <pubDate>2025-12-05T00:44:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579906040536596526" data-draft-id="7579906040536580142" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Trilium Notesï¼šæ„å»ºä¸ªäººçŸ¥è¯†åº“çš„å¼€æºç¥å™¨"/> <meta itemprop="keywords" content="å¼€æº"/> <meta itemprop="datePublished" content="2025-12-05T00:44:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¿®å·±xj"/> <meta itemprop="url" content="https://juejin.cn/user/2641475936724142"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Trilium Notesï¼šæ„å»ºä¸ªäººçŸ¥è¯†åº“çš„å¼€æºç¥å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2641475936724142/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¿®å·±xj
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T00:44:15.000Z" title="Fri Dec 05 2025 00:44:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ä¿¡æ¯çˆ†ç‚¸çš„æ—¶ä»£ï¼Œæˆ‘ä»¬æ¯å¤©éƒ½åœ¨æ¥è§¦æµ·é‡çš„ä¿¡æ¯ï¼šé˜…è¯»çš„æ–‡ç« ã€çªå‘çš„çµæ„Ÿã€é¡¹ç›®ç¬”è®°ã€ä»£ç ç‰‡æ®µã€ä¼šè®®è®°å½•â€¦â€¦è¿™äº›çŸ¥è¯†ç¢ç‰‡æ•£è½åœ¨å„å¤„â€”â€”æ‰‹æœºå¤‡å¿˜å½•ã€å¾®ä¿¡æ”¶è—ã€æµè§ˆå™¨ä¹¦ç­¾ã€å„ç§ç¬”è®°åº”ç”¨ã€‚æ—¶é—´ä¸€é•¿ï¼Œè¦ä¹ˆå¿˜è®°å­˜æ”¾åœ¨å“ªé‡Œï¼Œè¦ä¹ˆæ— æ³•æœ‰æ•ˆå…³è”å’Œç»„ç»‡ã€‚</p>
<p>ä»Šå¤©æˆ‘è¦ä»‹ç»çš„å¼€æºé¡¹ç›® Trilium Notesï¼Œæ­£æ˜¯ä¸ºè§£å†³è¿™ä¸€é—®é¢˜è€Œç”Ÿçš„å¼ºå¤§å·¥å…·ã€‚å®ƒä¸ä»…æ˜¯ä¸€ä¸ªç¬”è®°åº”ç”¨ï¼Œæ›´æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¸ªäººçŸ¥è¯†ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒæ ‘çŠ¶ç»“æ„ç»„ç»‡ã€å¼ºå¤§çš„æœç´¢ã€è„šæœ¬è‡ªåŠ¨åŒ–ã€è·¨å¹³å°åŒæ­¥ç­‰é«˜çº§åŠŸèƒ½ï¼Œè€Œä¸”å®Œå…¨å¼€æºã€å…è´¹ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/649bf775c68c474ca78bfffe69000cef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=iz4UcYZ6ssYwpUkxW%2FkMYSelvbw%3D" alt="ScreenShot_2025-12-05_080242_969.png" loading="lazy"/></p>
<p>ScreenShot_2025-12-05_080242_969.png</p>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯ Trilium Notesï¼Ÿ</h2>
<p>Trilium Notes æ˜¯ä¸€æ¬¾åˆ†å±‚çº§çš„ç¬”è®°åº”ç”¨ï¼Œä¸“æ³¨äºæ„å»ºå¤§è§„æ¨¡çš„ä¸ªäººçŸ¥è¯†åº“ã€‚å®ƒé‡‡ç”¨æ ‘çŠ¶ç»“æ„ç»„ç»‡ç¬”è®°ï¼Œæ”¯æŒç¬”è®°å…‹éš†ï¼ˆä¸€ä¸ªç¬”è®°å¯ä»¥åœ¨æ ‘ä¸­çš„å¤šä¸ªä½ç½®å­˜åœ¨ï¼‰ï¼Œæä¾›äº†ä¸°å¯Œçš„ç¼–è¾‘åŠŸèƒ½å’Œå¼ºå¤§çš„æ‰©å±•èƒ½åŠ›ã€‚</p>
<p>è¯¥é¡¹ç›®å·²ç»åœ¨githubæ‹¥æœ‰ 33.3k star</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/818040934bc74ca4b8b5688dce5de851~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=dHIoH1cq%2B63UXidayTqp%2F%2B%2BMV9A%3D" alt="_20251205_071151.png" loading="lazy"/></p>
<p>_20251205_071151.png</p>
<p>githubåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTriliumNext%2FTrilium" target="_blank" title="https://github.com/TriliumNext/Trilium" ref="nofollow noopener noreferrer">github.com/TriliumNextâ€¦</a></p>
<p>å®˜ç½‘åœ°å€ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Ftriliumnotes.org%2F" target="_blank" title="https://triliumnotes.org/" ref="nofollow noopener noreferrer">triliumnotes.org/</a></p>
<h3 data-id="heading-1">æ ¸å¿ƒç‰¹ç‚¹ä¸€è§ˆï¼š</h3>
<ul>
<li><strong>æ ‘çŠ¶ç¬”è®°ç»“æ„</strong>ï¼šåƒæ–‡ä»¶ç³»ç»Ÿä¸€æ ·ç»„ç»‡ä½ çš„çŸ¥è¯†</li>
<li><strong>å¯Œæ–‡æœ¬ä¸ Markdown</strong>ï¼šæ”¯æŒè¡¨æ ¼ã€å›¾ç‰‡ã€æ•°å­¦å…¬å¼</li>
<li><strong>ä»£ç ç¬”è®°</strong>ï¼šè¯­æ³•é«˜äº®ï¼Œé€‚åˆç¨‹åºå‘˜</li>
<li><strong>ç‰ˆæœ¬æ§åˆ¶</strong>ï¼šå®Œæ•´çš„ç¬”è®°ä¿®è®¢å†å²</li>
<li><strong>å±æ€§ç³»ç»Ÿ</strong>ï¼šé€šè¿‡æ ‡ç­¾ã€å…³ç³»ç­‰å…ƒæ•°æ®ç»„ç»‡ç¬”è®°</li>
<li><strong>è„šæœ¬æ”¯æŒ</strong>ï¼šJavaScript è„šæœ¬å®ç°è‡ªåŠ¨åŒ–</li>
<li><strong>åŠ å¯†ç¬”è®°</strong>ï¼šå•ç¬”è®°çº§åˆ«çš„åŠ å¯†ä¿æŠ¤</li>
<li><strong>æ€ç»´å¯¼å›¾ã€ç»˜å›¾ã€åœ°å›¾</strong>ï¼šå¤šç§å¯è§†åŒ–å·¥å…·</li>
<li><strong>REST API</strong>ï¼šæ”¯æŒå¤–éƒ¨é›†æˆå’Œè‡ªåŠ¨åŒ–</li>
<li><strong>ç§»åŠ¨ç«¯ä¼˜åŒ–</strong>ï¼šå“åº”å¼è®¾è®¡ï¼Œæ”¯æŒæ‰‹æœºå’Œå¹³æ¿</li>
<li><strong>åŒæ­¥åŠŸèƒ½</strong>ï¼šè‡ªå»ºæœåŠ¡å™¨æˆ–å¤šè®¾å¤‡åŒæ­¥</li>
</ul>
<h2 data-id="heading-2">éƒ¨ç½²</h2>
<h3 data-id="heading-3">windowsæ¡Œé¢ç«¯å®‰è£…ï¼ˆæœ€ç®€å•ï¼‰</h3>
<p>åœ¨github æˆ–è€…å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…ç›´æ¥å®‰è£…</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a01ee96db2524d21ae921aadf0770ce6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=rq2H7jGqUXZ8iOKZ9%2FQ5ZvMs27s%3D" alt="ScreenShot_2025-12-05_071836_166.png" loading="lazy"/></p>
<p>ScreenShot_2025-12-05_071836_166.png</p>
<h3 data-id="heading-4">Docker éƒ¨ç½²ï¼ˆæœåŠ¡å™¨ä½¿ç”¨ï¼‰</h3>
<p>æˆ‘ä½¿ç”¨çš„æ˜¯docker-composeéƒ¨ç½²çš„æ–¹å¼ï¼Œä»¥ä¸‹æ˜¯éƒ¨ç½²æ­¥éª¤</p>
<p>åœ¨linuxä¸Šåˆ›å»ºéƒ¨ç½²ç›®å½•<code>trilium</code>,åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºdocker-compose.ymlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-symbol">services:</span>
  <span class="hljs-symbol">trilium:</span>
    <span class="hljs-symbol">image:</span> triliumnext/<span class="hljs-symbol">trilium:</span>latest
    <span class="hljs-symbol">restart:</span> <span class="hljs-keyword">unless</span>-stopped
    <span class="hljs-symbol">ports:</span>
      - <span class="hljs-string">'8020:8080'</span>
    <span class="hljs-symbol">volumes:</span>
      - ./trilium-<span class="hljs-symbol">data:</span>/home/node/trilium-data
      - <span class="hljs-regexp">/etc/timezone</span><span class="hljs-symbol">:/etc/timezone</span><span class="hljs-symbol">:ro</span>
      - <span class="hljs-regexp">/etc/localtime</span><span class="hljs-symbol">:/etc/localtime</span><span class="hljs-symbol">:ro</span>
</code></pre>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨</p>
<pre><code class="hljs">docker-compose up -d
</code></pre>
<p>åˆ°æ­¤ï¼Œæ²¡æœ‰é—®é¢˜çš„è¯æˆ‘ä»¬æœåŠ¡å°±å·²ç»éƒ¨ç½²å®Œæˆäº†</p>
<h2 data-id="heading-5">ä½¿ç”¨</h2>
<h3 data-id="heading-6">è®¾ç½®å¯†ç </h3>
<p>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æˆ‘ä»¬éƒ¨ç½²æœåŠ¡çš„åœ°å€ï¼Œé¦–æ¬¡ä½¿ç”¨çš„è¯éœ€è¦è®¾ç½®å¯†ç ï¼Œéœ€è¦è®°ä½æ­¤å¯†ç ï¼Œå¦‚æœä¸¢å¤±çš„è¯æ˜¯æ‰¾ä¸å›æ¥çš„</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2a1f813e4445496ca50803b41760a0e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=d4lO%2BnBQm2pdO5%2BQaf6nE%2B7nB9g%3D" alt="ScreenShot_2025-12-05_072459_009.png" loading="lazy"/></p>
<p>ScreenShot_2025-12-05_072459_009.png</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a97043cf9444cec865f36239fd32eec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=CBJ4eh3FMzjdtCI1XoistPXuIqg%3D" alt="ScreenShot_2025-12-05_072516_871.png" loading="lazy"/></p>
<p>ScreenShot_2025-12-05_072516_871.png</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/53ac61dd380e4bf48c9369a73eecbf6d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=98FAPkRj4tekTpUWjLpoM83bGmQ%3D" alt="ScreenShot_2025-12-05_072530_546.png" loading="lazy"/></p>
<p>ScreenShot_2025-12-05_072530_546.png</p>
<p>ç™»å½•ä¹‹åå°±æ˜¯è¿™ä¸ªæ ·å­</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b98562610884f44b59dd22afa9a74e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=OHfKo4Ht5n%2FIUvXGmYz1IqKkVIM%3D" alt="ScreenShot_2025-12-05_073110_570.png" loading="lazy"/></p>
<p>ScreenShot_2025-12-05_073110_570.png</p>
<h3 data-id="heading-7">è®¾ç½®è¯­è¨€</h3>
<p>ç³»ç»Ÿé»˜è®¤æ˜¯è‹±æ–‡çš„ï¼Œéœ€è¦å…ˆè®¾ç½®ä¸ºä¸­æ–‡</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee713af4029f4c30859708ecb4a83dec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=fRRZnRf6oFhAGXytJy6TP5CSp0g%3D" alt="ScreenShot_2025-12-05_073310_268.png" loading="lazy"/></p>
<p>ScreenShot_2025-12-05_073310_268.png</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/751dc1daf652457898b30d52af718996~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=f2eHwkPabH4gi3Hqek%2BiW4WBdPQ%3D" alt="ScreenShot_2025-12-05_073321_769.png" loading="lazy"/></p>
<p>ScreenShot_2025-12-05_073321_769.png</p>
<h3 data-id="heading-8">æ–°å¢ç¬”è®°</h3>
<p>æˆ‘ä»¬å¯ä»¥åœ¨å·¦ä¾§æ–‡æ¡£æ ‘ä¸‹æ·»åŠ æ–‡æ¡£ï¼Œæ”¯æŒç±»å‹æ¯”è¾ƒå¤šï¼Œ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b9664a5ca344996a00da164a8cd8828~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=bE8k93z3qI3qGfeN%2FiJLaLywj1w%3D" alt="ScreenShot_2025-12-05_073901_361.png" loading="lazy"/></p>
<p>ScreenShot_2025-12-05_073901_361.png</p>
<p>è¿™äº›ç±»å‹ä¸­å¦‚ <code>Meimaidå›¾</code>ã€<code>æ€ç»´å¯¼å›¾</code>ã€<code>ç¬”è®°åœ°å›¾</code>ã€<code>åˆ—è¡¨è§†å›¾</code>ã€<code>ç½‘æ ¼è§†å›¾</code>ã€<code>æ—¥å†</code>ã€<code>è¡¨æ ¼</code>ã€<code>åœ°ç†åœ°å›¾</code>ã€<code>çœ‹æ¿</code>ã€<code>æ¼”ç¤º</code> è¿™äº›åŠŸèƒ½çš„æ”¯æŒè¿˜æ˜¯å¾ˆæœ‰ç‰¹ç‚¹çš„,æˆ‘ä»¬å°±ä¸åœ¨æ­¤ä¸€ä¸€åšå±•ç¤ºäº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b47478cd60024a4c81849b7151fc1ed4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=paidPpXZtaJk0fLZJFvrdwiHghE%3D" alt="ScreenShot_2025-12-05_075152_724.png" loading="lazy"/> <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23f826e621c14d2b8723aed8b78dfc9f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=t8j9%2Bafr5WFiOhlwLhiSA45%2B9bM%3D" alt="ScreenShot_2025-12-05_075203_673.png" loading="lazy"/> <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bbd95374b7144ab381f9e4d67eec1423~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=NmcqXMY6U7GwzIMxczW5DKCSBvo%3D" alt="ScreenShot_2025-12-05_075217_004.png" loading="lazy"/> <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/78449caf998945a9983babac79fa5ee3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=eV4gqQHDLV1ORijraJWDplLV8H8%3D" alt="ScreenShot_2025-12-05_075225_887.png" loading="lazy"/> <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f17b601dcb904e40b2cc2a101c3b9215~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=7cXxeZVHGE1bCJOp4K36z2zzEMw%3D" alt="ScreenShot_2025-12-05_075241_789.png" loading="lazy"/> <img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b2e81e4dacb4fb7ab0f41afffe7ca0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=QzRIJUz9e1Rll7Pchhe4jKsOX5U%3D" alt="ScreenShot_2025-12-05_075249_239.png" loading="lazy"/></p>
<h3 data-id="heading-9">markdowm æ”¯æŒ</h3>
<p>è¿™ä¸ªæ–‡æ¡£ç³»ç»Ÿæœ€å¤§çš„ç¼ºç‚¹å°±æ˜¯ä¸ç›´æ¥æ”¯æŒmarkdown ç¼–è¾‘å™¨ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨markdownæ ¼å¼å†™ç¬”è®°çš„è¯å¾—ç°åœ¨å¤–éƒ¨ç¼–è¯‘å™¨ä¸­å†™å¥½ï¼Œé€šè¿‡markdownå¯¼å…¥ å¯¼å…¥åˆ°ç¬”è®°ä¸­</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aabe076298294834b2987d14572e0557~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765500254&amp;x-signature=Pk3VpFbxEvktTJTCJd%2FEGc%2BmClE%3D" alt="ScreenShot_2025-12-05_074742_688.png" loading="lazy"/></p>
<p>ScreenShot_2025-12-05_074742_688.png</p>
<h2 data-id="heading-10">é€‚ç”¨åœºæ™¯</h2>
<ul>
<li><strong>ä¸ªäººçŸ¥è¯†ç®¡ç†</strong>ï¼šæ„å»ºç¬¬äºŒå¤§è„‘</li>
<li><strong>å­¦ä¹ ç¬”è®°</strong>ï¼šè¯¾ç¨‹ã€è¯»ä¹¦ç¬”è®°æ•´ç†</li>
<li><strong>é¡¹ç›®æ–‡æ¡£</strong>ï¼šä»£ç ã€è®¾è®¡ã€æ–‡æ¡£ä¸€ä½“åŒ–</li>
<li><strong>ç ”ç©¶è®°å½•</strong>ï¼šæ–‡çŒ®ã€å®éªŒæ•°æ®ç®¡ç†</li>
<li><strong>åˆ›æ„å†™ä½œ</strong>ï¼šå°è¯´ã€å‰§æœ¬å¤§çº²</li>
</ul>
<h2 data-id="heading-11">ç»“è¯­</h2>
<p>Trilium Notes ä¸ä»…ä»…æ˜¯ä¸€ä¸ªç¬”è®°åº”ç”¨ï¼Œå®ƒæ˜¯ä¸€ä¸ª<strong>æ€ç»´çš„å¤–æ¥ç¡¬ç›˜</strong>ï¼Œä¸€ä¸ª<strong>çŸ¥è¯†çš„æ“ä½œç³»ç»Ÿ</strong>ã€‚åœ¨æ•°æ®éšç§æ—¥ç›Šé‡è¦çš„ä»Šå¤©ï¼Œæ‹¥æœ‰ä¸€ä¸ªå®Œå…¨è‡ªæˆ‘æŒæ§çš„çŸ¥è¯†ç®¡ç†ç³»ç»Ÿï¼Œæ—¢æ˜¯æŠ€æœ¯ä¸Šçš„é€‰æ‹©ï¼Œä¹Ÿæ˜¯ç†å¿µä¸Šçš„åšæŒã€‚</p>
<p>æ— è®ºä½ æ˜¯å­¦ç”Ÿã€ç ”ç©¶è€…ã€å¼€å‘è€…ï¼Œè¿˜æ˜¯ç»ˆèº«å­¦ä¹ è€…ï¼ŒTrilium éƒ½èƒ½ä¸ºä½ æä¾›ä¸€ä¸ªå¼ºå¤§è€Œçµæ´»çš„çŸ¥è¯†ç®¡ç†å¹³å°ã€‚æœ€é‡è¦çš„æ˜¯â€”â€”å®ƒå®Œå…¨å…è´¹ï¼Œå®Œå…¨å¼€æºã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[C++ ç±»å‹è½¬æ¢ï¼šæ—§é£æ ¼ä¸å››ç§æ–°é£æ ¼è¯¦è§£]]></title>    <link>https://juejin.cn/post/7579872561674928137</link>    <guid>https://juejin.cn/post/7579872561674928137</guid>    <pubDate>2025-12-05T00:51:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579872561674928137" data-draft-id="7579871631096545306" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="C++ ç±»å‹è½¬æ¢ï¼šæ—§é£æ ¼ä¸å››ç§æ–°é£æ ¼è¯¦è§£"/> <meta itemprop="keywords" content="åç«¯,C++"/> <meta itemprop="datePublished" content="2025-12-05T00:51:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å–µä¸ªå’ª"/> <meta itemprop="url" content="https://juejin.cn/user/1350630784901262"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            C++ ç±»å‹è½¬æ¢ï¼šæ—§é£æ ¼ä¸å››ç§æ–°é£æ ¼è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1350630784901262/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å–µä¸ªå’ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T00:51:36.000Z" title="Fri Dec 05 2025 00:51:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">C++ ç±»å‹è½¬æ¢ï¼šæ—§é£æ ¼ä¸å››ç§æ–°é£æ ¼è¯¦è§£</h2>
<p>åœ¨ C++ ç¼–ç¨‹ä¸­ï¼Œç±»å‹è½¬æ¢æ˜¯è¿æ¥ä¸åŒæ•°æ®ç±»å‹çš„é‡è¦æ‰‹æ®µã€‚C++ åŒæ—¶æ”¯æŒå…¼å®¹ C è¯­è¨€çš„æ—§é£æ ¼å¼ºåˆ¶è½¬å‹ï¼Œä»¥åŠé’ˆå¯¹ç‰¹å®šåœºæ™¯è®¾è®¡çš„å››ç§æ–°é£æ ¼å¼ºåˆ¶è½¬å‹ï¼Œåè€…åœ¨å¯è¯»æ€§ã€å®‰å…¨æ€§å’Œè§„èŒƒæ€§ä¸Šæ›´å…·ä¼˜åŠ¿ã€‚æœ¬æ–‡å°†è¯¦ç»†è§£æå„ç±»è½¬æ¢çš„è¯­æ³•ã€ç”¨é€”åŠæ ¸å¿ƒå·®å¼‚ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€æ—§é£æ ¼ï¼ˆC-styleï¼‰å¼ºåˆ¶è½¬å‹</h3>
<p>C é£æ ¼å¼ºåˆ¶è½¬å‹åŒ…å«ä¸¤ç§è¯­æ³•å½¢å¼ï¼Œæœ¬è´¨åŠŸèƒ½å®Œå…¨ä¸€è‡´ï¼Œä»…æ‹¬å·ä½ç½®ä¸åŒï¼š</p>
<ul>
<li>æ ¼å¼ 1ï¼š<code>(T) expression</code>ï¼ˆå°†è¡¨è¾¾å¼è½¬æ¢ä¸º <code>T</code> ç±»å‹ï¼‰</li>
<li>æ ¼å¼ 2ï¼š<code>T(expression)</code>ï¼ˆå‡½æ•°å¼è¯­æ³•ï¼Œæ•ˆæœåŒä¸Šï¼‰</li>
</ul>
<p>è¿™ç±»è½¬æ¢ç®€æ´ä½†ç¼ºä¹é’ˆå¯¹æ€§ï¼Œæ—¢å¯ä»¥ç”¨äºåŸºç¡€ç±»å‹è½¬æ¢ï¼Œä¹Ÿèƒ½ç”¨äºæŒ‡é’ˆã€å¸¸é‡å±æ€§ç­‰å¤æ‚åœºæ™¯ï¼Œå¯¼è‡´ç±»å‹ç³»ç»Ÿè¢«ç ´åçš„ä½ç½®éš¾ä»¥æ’æŸ¥ï¼Œç¼–è¯‘å™¨ä¹Ÿæ— æ³•æä¾›é”™è¯¯è¯Šæ–­ï¼Œä»…åœ¨å…¼å®¹æ—§ä»£ç æ—¶å»ºè®®ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-2">äºŒã€C++ æ–°é£æ ¼å››ç§å¼ºåˆ¶è½¬å‹</h3>
<p>C++ å¼•å…¥çš„å››ç§æ–°é£æ ¼è½¬æ¢ï¼Œæ¯ç§éƒ½æœ‰æ˜ç¡®çš„é€‚ç”¨åœºæ™¯ï¼Œèƒ½ç²¾å‡†çº¦æŸè½¬æ¢è¡Œä¸ºï¼Œæå‡ä»£ç å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œæ˜¯ç°ä»£ C++ å¼€å‘çš„é¦–é€‰ã€‚</p>
<h4 data-id="heading-3">1. dynamic_castï¼šå®‰å…¨çš„å‘ä¸‹è½¬å‹</h4>
<ul>
<li>è¯­æ³•ï¼š<code>dynamic_cast&lt;T*&gt;(expression)</code></li>
<li>æ ¸å¿ƒç”¨é€”ï¼š<strong>ä»…ç”¨äºç»§æ‰¿ä½“ç³»ä¸­çš„ç±»å‹è½¬æ¢</strong>ï¼Œå°¤å…¶é€‚åˆ â€œå‘ä¸‹è½¬å‹â€ï¼ˆåŸºç±»æŒ‡é’ˆ / å¼•ç”¨è½¬æ¢ä¸ºæ´¾ç”Ÿç±»æŒ‡é’ˆ / å¼•ç”¨ï¼‰ï¼Œæ˜¯å”¯ä¸€èƒ½ä¿è¯ç±»å‹å®‰å…¨çš„è½¬å‹æ–¹å¼ã€‚</li>
<li>å…³é”®ç‰¹æ€§ï¼š
<ul>
<li>ä¾èµ–è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯ï¼ˆ<code>RTTI</code>ï¼‰ï¼Œä¼šæ£€æŸ¥è½¬æ¢çš„åˆæ³•æ€§ï¼šè‹¥åŸºç±»æŒ‡é’ˆå®é™…æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œè½¬æ¢æˆåŠŸå¹¶è¿”å›æœ‰æ•ˆæŒ‡é’ˆï¼›è‹¥æŒ‡å‘åŸºç±»å¯¹è±¡æˆ–ç©ºæŒ‡é’ˆï¼Œè¿”å›ç©ºæŒ‡é’ˆï¼ˆæŒ‡é’ˆç±»å‹ï¼‰æˆ–æŠ›å‡ºå¼‚å¸¸ï¼ˆå¼•ç”¨ç±»å‹ï¼‰ã€‚</li>
<li>æ˜¯å”¯ä¸€<strong>ä¸èƒ½ç”¨æ—§é£æ ¼è¯­æ³•æ›¿ä»£</strong>çš„è½¬æ¢ï¼Œä¹Ÿæ˜¯å”¯ä¸€æœ‰æ˜¾è‘—è¿è¡Œæ—¶ä»£ä»·çš„è½¬æ¢ï¼ˆå› è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-4">2. static_castï¼šé€šç”¨å‹æ˜¾å¼è½¬æ¢</h4>
<ul>
<li>è¯­æ³•ï¼š<code>static_cast&lt;T&gt;(expression)</code></li>
<li>æ ¸å¿ƒç”¨é€”ï¼šè¦†ç›–å¤§éƒ¨åˆ† â€œåˆç†çš„æ˜¾å¼è½¬æ¢â€ åœºæ™¯ï¼Œæœ€æ¥è¿‘æ—§é£æ ¼è½¬æ¢ä½†æ›´å…·çº¦æŸæ€§ï¼š
<ul>
<li>åŸºç¡€ç±»å‹çš„éšå¼è½¬æ¢åå‘æ“ä½œï¼ˆå¦‚ <code>void*</code> è½¬å…·ä½“ç±»å‹æŒ‡é’ˆã€<code>int</code> è½¬ <code>double</code>ï¼‰ï¼›</li>
<li>ç»§æ‰¿ä½“ç³»ä¸­çš„ â€œå‘ä¸Šè½¬å‹â€ï¼ˆæ´¾ç”Ÿç±»æŒ‡é’ˆè½¬åŸºç±»æŒ‡é’ˆï¼Œå¤©ç„¶å®‰å…¨ï¼Œæ— éœ€å¼ºåˆ¶è½¬æ¢ä½†å¯æ˜¾å¼ä½¿ç”¨ï¼‰ï¼›</li>
<li>é const å¯¹è±¡è½¬ const å¯¹è±¡ï¼ˆconst å¢å¼ºï¼‰ã€‚</li>
</ul>
</li>
<li>å…³é”®ç‰¹æ€§ï¼š
<ul>
<li>ç¼–è¯‘æ—¶å®Œæˆè½¬æ¢ï¼Œæ— è¿è¡Œæ—¶å¼€é”€ï¼Œä»…è¿›è¡Œè¯­æ³•å±‚é¢çš„æ£€æµ‹ï¼ˆå¦‚æŒ‡é’ˆè¶Šç•Œè®¡ç®—ï¼‰ï¼Œä¸éªŒè¯å®é™…ç±»å‹ã€‚</li>
<li>å±€é™æ€§ï¼šæ— æ³•æ¶ˆé™¤å¯¹è±¡çš„å¸¸é‡æ€§ï¼ˆéœ€ç”¨ <code>const_cast</code>ï¼‰ï¼Œå‘ä¸‹è½¬å‹æ—¶ä¸åšç±»å‹æ£€æŸ¥ï¼Œä¾èµ–ç¨‹åºå‘˜ç¡®ä¿è½¬æ¢åˆæ³•æ€§ï¼Œå­˜åœ¨å®‰å…¨é£é™©ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-5">3. const_castï¼šæ¶ˆé™¤å¸¸é‡æ€§ä¸“ç”¨</h4>
<ul>
<li>è¯­æ³•ï¼š<code>const_cast&lt;T*&gt;(expression)</code></li>
<li>æ ¸å¿ƒç”¨é€”ï¼š<strong>å”¯ä¸€èƒ½ä¿®æ”¹å¯¹è±¡å¸¸é‡å±æ€§çš„è½¬æ¢</strong>ï¼Œä»…ç”¨äºç§»é™¤æˆ–æ·»åŠ å˜é‡çš„ <code>const</code>/<code>volatile</code> é™å®šç¬¦ã€‚</li>
<li>å…³é”®ç‰¹æ€§ï¼š
<ul>
<li>è½¬æ¢ç›®æ ‡å¿…é¡»æ˜¯æŒ‡é’ˆã€å¼•ç”¨æˆ–æˆå‘˜æŒ‡é’ˆç±»å‹ï¼Œä¸èƒ½ç›´æ¥è½¬æ¢å¯¹è±¡æœ¬èº«ã€‚</li>
<li>ä»…æ”¹å˜ç±»å‹çš„å¸¸é‡å±æ€§ï¼Œä¸æ”¹å˜å¯¹è±¡çš„å®é™…ç±»å‹æˆ–å€¼ï¼šè‹¥åŸå§‹å¯¹è±¡æœ¬èº«æ˜¯ const ç±»å‹ï¼ˆå¦‚ <code>const int a = 10</code>ï¼‰ï¼Œé€šè¿‡ const_cast ç§»é™¤å¸¸é‡æ€§åä¿®æ”¹å¯¹è±¡ï¼Œè¡Œä¸ºæœªå®šä¹‰ï¼›è‹¥å¯¹è±¡æœ¬è´¨æ˜¯é constï¼ˆå¦‚ <code>int b = 20; const int* p = &amp;b</code>ï¼‰ï¼Œåˆ™å¯å®‰å…¨ä¿®æ”¹ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-6">4. reinterpret_castï¼šåº•å±‚æ¯”ç‰¹çº§è½¬æ¢</h4>
<ul>
<li>è¯­æ³•ï¼š<code>reinterpret_cast&lt;T&gt;(expression)</code></li>
<li>æ ¸å¿ƒç”¨é€”ï¼šåº•å±‚ç±»å‹çš„ â€œé‡æ–°è§£é‡Šâ€ï¼Œä»…å¤åˆ¶å¯¹è±¡çš„æ¯”ç‰¹æ¨¡å‹ï¼Œä¸è¿›è¡Œä»»ä½•äºŒè¿›åˆ¶è½¬æ¢æˆ–ç±»å‹æ ¡éªŒï¼Œé€‚ç”¨äºæç‰¹æ®Šçš„åº•å±‚ç¼–ç¨‹åœºæ™¯ã€‚</li>
<li>å…³é”®ç‰¹æ€§ï¼š
<ul>
<li>è½¬æ¢ç»“æœä¾èµ–ç¼–è¯‘å™¨å®ç°ï¼Œä¸å¯ç§»æ¤ï¼Œæ˜¯æœ€å±é™©çš„è½¬æ¢æ–¹å¼ï¼ˆå¦‚æŒ‡é’ˆè½¬æ•´æ•°ã€ä¸åŒç±»å‹æŒ‡é’ˆäº’è½¬ï¼‰ã€‚</li>
<li>ä»…ç”¨äº â€œå°†ç±»å‹æ˜ å°„å›åŸæœ‰ç±»å‹â€ çš„åœºæ™¯ï¼šä¾‹å¦‚å°†æŒ‡é’ˆå­˜å‚¨ä¸ºæ•´æ•°åï¼Œéœ€é€šè¿‡ç›¸åŒè½¬æ¢è¿˜åŸä¸ºåŸæŒ‡é’ˆç±»å‹ï¼Œå¦åˆ™ä¼šå¯¼è‡´å†…å­˜è®¿é—®é”™è¯¯ã€‚</li>
<li>ç¤ºä¾‹ï¼š<code>int n = 9; double d = reinterpret_cast&lt;double&amp;&gt;(n);</code>ï¼Œd çš„å€¼æ˜¯æ— æ•ˆçš„ â€”â€” å› ä¸ºå®ƒç›´æ¥å¤åˆ¶äº† int çš„æ¯”ç‰¹ä½ï¼Œæœªéµå¾ª double çš„äºŒè¿›åˆ¶å­˜å‚¨è§„åˆ™ï¼Œè€Œ <code>static_cast&lt;double&gt;(n)</code> ä¼šæ­£ç¡®è½¬æ¢ä¸º <code>9.0</code>ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-7">ä¸‰ã€æ ¸å¿ƒè½¬æ¢å¯¹æ¯”ï¼šæ˜ç¡®é€‚ç”¨è¾¹ç•Œ</h3>
<h4 data-id="heading-8">1. dynamic_cast vs static_castï¼ˆç»§æ‰¿ä½“ç³»è½¬æ¢ï¼‰</h4>
<p>å‡è®¾æœ‰ç»§æ‰¿å…³ç³» <code>class D : public B</code>ï¼Œå¯¹åŸºç±»æŒ‡é’ˆ <code>B* pb</code> è¿›è¡Œå¦‚ä¸‹è½¬æ¢ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">f</span><span class="hljs-params">(B* pb)</span> </span>{
  D* pd1 = <span class="hljs-built_in">dynamic_cast</span>&lt;D*&gt;(pb); <span class="hljs-comment">// å®‰å…¨è½¬å‹</span>
  D* pd2 = <span class="hljs-built_in">static_cast</span>&lt;D*&gt;(pb);  <span class="hljs-comment">// ä¸å®‰å…¨è½¬å‹</span>
}
</code></pre>
<ul>
<li>è‹¥ <code>pb</code> æŒ‡å‘ <code>D</code> ç±»å¯¹è±¡æˆ–ä¸ºç©ºï¼šä¸¤è€…è½¬æ¢ç»“æœä¸€è‡´ï¼Œå‡è¿”å›æœ‰æ•ˆæŒ‡é’ˆæˆ–ç©ºæŒ‡é’ˆï¼›</li>
<li>è‹¥ <code>pb</code> æŒ‡å‘ <code>B</code> ç±»å¯¹è±¡ï¼ˆé <code>D</code> ç±»ï¼‰ï¼š<code>dynamic_cast</code> æ£€æµ‹åˆ°ç±»å‹ä¸åŒ¹é…ï¼Œè¿”å›ç©ºæŒ‡é’ˆï¼›<code>static_cast</code> ç›´æ¥è¿”å› â€œå‡è®¾ä¸º <code>D</code> ç±»å¯¹è±¡â€ çš„æŒ‡é’ˆï¼Œåç»­è®¿é—®æ´¾ç”Ÿç±»æˆå‘˜ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚</li>
</ul>
<p>ç»“è®ºï¼šç»§æ‰¿ä½“ç³»å‘ä¸‹è½¬å‹ä¼˜å…ˆç”¨ <code>dynamic_cast</code>ï¼ˆå®‰å…¨ï¼‰ï¼Œå·²çŸ¥è½¬æ¢åˆæ³•æ—¶å¯â½¤ <code>static_cast</code>ï¼ˆé«˜æ•ˆï¼‰ã€‚</p>
<h4 data-id="heading-9">2. static_cast vs reinterpret_castï¼ˆåŸºç¡€ç±»å‹ / æŒ‡é’ˆè½¬æ¢ï¼‰</h4>
<ul>
<li>è½¬æ¢æœ¬è´¨ï¼š<code>static_cast</code> ä¼šæ ¹æ®ç±»å‹è§„åˆ™è¿›è¡ŒäºŒè¿›åˆ¶è½¬æ¢ï¼ˆå¦‚ int è½¬ double è¡¥å…¨æ¯”ç‰¹ä½ï¼‰ï¼Œ<code>reinterpret_cast</code> ä»…åŸæ ·å¤åˆ¶æ¯”ç‰¹ä½ï¼›</li>
<li>é€‚ç”¨åœºæ™¯ï¼š<code>static_cast</code> ç”¨äº â€œé€»è¾‘ä¸Šå…¼å®¹â€ çš„ç±»å‹è½¬æ¢ï¼ˆå¦‚æ•°å€¼ç±»å‹ã€ä¸Šä¸‹è½¬å‹ï¼‰ï¼Œ<code>reinterpret_cast</code> ä»…ç”¨äºåº•å±‚æ¯”ç‰¹çº§æ“ä½œï¼ˆå¦‚æŒ‡é’ˆä¸æ•´æ•°äº’è½¬ï¼‰ï¼›</li>
<li>å®‰å…¨æ€§ï¼š<code>static_cast</code> ä»…åœ¨è½¬æ¢è§„åˆ™å†…å®‰å…¨ï¼Œ<code>reinterpret_cast</code> å®Œå…¨ä¾èµ–ç¨‹åºå‘˜æ§åˆ¶ï¼Œè¯¯ç”¨ä¼šç›´æ¥ç ´åå†…å­˜å®‰å…¨ã€‚</li>
</ul>
<h3 data-id="heading-10">å››ã€æ€»ç»“ï¼šè½¬æ¢é€‰æ‹©ä¼˜å…ˆçº§</h3>
<ol>
<li>ä¼˜å…ˆä½¿ç”¨ç¼–è¯‘å™¨éšå¼è½¬æ¢ï¼ˆ<strong>æ— éœ€æ˜¾å¼å£°æ˜ï¼Œæœ€å®‰å…¨</strong>ï¼‰ï¼›</li>
<li>éœ€æ˜¾å¼è½¬æ¢æ—¶ï¼Œæ ¹æ®åœºæ™¯é€‰æ‹©æ–°é£æ ¼è½¬æ¢ï¼š
<ul>
<li>ç»§æ‰¿ä½“ç³»å‘ä¸‹è½¬å‹ â†’ <code>dynamic_cast</code>ï¼ˆ<strong>å®‰å…¨ä¼˜å…ˆ</strong>ï¼‰ï¼›</li>
<li>åŸºç¡€ç±»å‹è½¬æ¢ã€å‘ä¸Šè½¬å‹ â†’ <code>static_cast</code>ï¼ˆ<strong>é€šç”¨é«˜æ•ˆ</strong>ï¼‰ï¼›</li>
<li>éœ€ä¿®æ”¹å¸¸é‡å±æ€§ â†’ <code>const_cast</code>ï¼ˆ<strong>ä»…é™éæœ¬è´¨ <code>const</code> å¯¹è±¡</strong>ï¼‰ï¼›</li>
<li>åº•å±‚æ¯”ç‰¹çº§æ“ä½œ â†’ <code>reinterpret_cast</code>ï¼ˆ<em><strong>è°¨æ…ä½¿ç”¨ï¼Œä»…é™åº•å±‚ä»£ç </strong></em>ï¼‰ï¼›</li>
</ul>
</li>
<li>é¿å…ä½¿ç”¨æ—§é£æ ¼è½¬æ¢ï¼Œä»…åœ¨å…¼å®¹ C ä»£ç æ—¶ä¾‹å¤–ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸šåŠ¡å¦‚ä½•å¯¹æ¥é£æ§å†³ç­–ï¼Œå®æ—¶/å¼‚æ­¥ï¼Œç»“æœåŒæ­¥]]></title>    <link>https://juejin.cn/post/7579893536105037830</link>    <guid>https://juejin.cn/post/7579893536105037830</guid>    <pubDate>2025-12-05T01:00:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579893536105037830" data-draft-id="7579819594271211558" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸šåŠ¡å¦‚ä½•å¯¹æ¥é£æ§å†³ç­–ï¼Œå®æ—¶/å¼‚æ­¥ï¼Œç»“æœåŒæ­¥"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-05T01:00:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ— å¥ˆä½•æ¨"/> <meta itemprop="url" content="https://juejin.cn/user/72987223006237"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸šåŠ¡å¦‚ä½•å¯¹æ¥é£æ§å†³ç­–ï¼Œå®æ—¶/å¼‚æ­¥ï¼Œç»“æœåŒæ­¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/72987223006237/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ— å¥ˆä½•æ¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T01:00:40.000Z" title="Fri Dec 05 2025 01:00:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é—®é¢˜</h2>
<p>åœ¨é£æ§ç³»ç»Ÿçš„è®¾è®¡ä¸å®è·µä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸¤éš¾ï¼š</p>
<ul>
<li><strong>äº‹ä¸­</strong>ï¼šéœ€è¦å¿«é€Ÿã€å®æ—¶å†³ç­–ï¼Œä¿è¯ä½å»¶è¿Ÿã€‚</li>
<li><strong>äº‹å</strong>ï¼šéœ€è¦å®Œæ•´çš„æ•°æ®é—­ç¯ï¼Œç”¨äºåˆ†æå’Œæ¨¡å‹ä¼˜åŒ–ã€‚</li>
</ul>
<p>åœ¨è½åœ°æ—¶ä¼šé‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼š</p>
<ul>
<li><strong>äº‹å‰å’Œäº‹åæ•°æ®å‡ ä¹å®Œå…¨ä¸€è‡´</strong>ï¼ŒåŸç³»ç»Ÿä¸å¾—ä¸é‡å¤ç»„è£…ä¸€ä»½æ•°æ®å‘ç»™é£æ§ï¼Œé€ æˆå¤§é‡å†—ä½™ã€‚</li>
<li><strong>é£æ§ç³»ç»Ÿåªåšäº†å†³ç­–ï¼Œå´ä¸çŸ¥é“æœ€ç»ˆç»“æœ</strong>ï¼Œæ— æ³•é—­ç¯ä¼˜åŒ–ç­–ç•¥ã€‚</li>
<li><strong>æŒ‘æˆ˜éªŒè¯ï¼ˆäººè„¸ / çŸ­ä¿¡ / æ»‘å—ï¼‰</strong> æ¶‰åŠè·¨é˜¶æ®µçŠ¶æ€ä¿æŒï¼Œä¸€æ—¦æ–­é“¾ï¼Œå°±ä¼šå¯¼è‡´æ•°æ®ç¼ºå¤±å’Œå®‰å…¨æ¼æ´ã€‚</li>
</ul>
<p>åœ¨å‰æ–‡ä¹Ÿå†™è¿‡ç›¸å…³çš„ï¼Œä½†æ˜¯éšç€è®¤è¯†åŠ æ·±å’Œå®è·µç»éªŒåŠ å¼ºï¼Œæ„Ÿå—å’Œç†è§£ä¹Ÿä¸å¤ªç›¸åŒçš„ã€‚</p>
<h2 data-id="heading-1">å†³ç­–æµç¨‹</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fwnhyang%2FcoolGuard" target="_blank" title="https://github.com/wnhyang/coolGuard" ref="nofollow noopener noreferrer">github.com/wnhyang/cooâ€¦</a></p>
<p>æœ¬ç¯‡æ–‡ç« è®¨è®ºçš„å‰æéƒ½æ˜¯æ­¤é¡¹ç›®ï¼Œè€Œä¸”æ›´å¤šæ˜¯é—­æºåˆ†æ”¯ï¼Œè¯·è°…è§£ã€‚</p>
<p>ç°åœ¨çš„å†³ç­–æµç¨‹å¤§è‡´æ˜¯è¿™æ ·çš„ï¼Œä¹‹å‰è®²è¿‡æ¯æœ‰ä¸€ä¸ªæ¥å…¥é…ç½®ï¼Œå°±å¯¹åº”äº†ä¸‰ä¸ªæ¥å£ï¼Œåˆ†åˆ«æ˜¯<code>/{code}/sync</code>ï¼ˆåŒæ­¥å®æ—¶å†³ç­–æ•°æ®æ¥å…¥ï¼‰ã€<code>/{code}/async</code>ï¼ˆå¼‚æ­¥ï¼Œéå†³ç­–ç±»æ•°æ®æ¥å…¥ï¼ŒåŒ…å«åŒæ­¥çš„ç»“æœé€šçŸ¥ï¼‰</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ccc7ff28d0434990a060e31ee3829240~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5peg5aWI5L2V5p2o:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501240&amp;x-signature=3JY7AxNJDukR44uIwX938F%2Fn2DE%3D" alt="" loading="lazy"/></p>
<p>è¯¦ç»†çš„å°±ä¸å±•å¼€äº†ï¼Œå…³é”®æ˜¯ä¸šåŠ¡å¦‚ä½•å¯¹æ¥ï¼Ÿ</p>
<h2 data-id="heading-2">ä¸šåŠ¡æ¥å…¥</h2>
<p>é¦–å…ˆå¾—ç†è§£ä¸šåŠ¡æ¥å…¥é£æ§çš„æ˜¯ä»€ä¹ˆï¼Ÿé€šå¸¸æ¥è¯´ä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡æµç¨‹éƒ½ä¸æ˜¯é‚£ä¹ˆç®€å•ï¼Œæ ¹æ®è‡ªå·±çš„éœ€æ±‚å†³å®šè¦æ¥å…¥é£æ§çš„ç‚¹ã€‚</p>
<p>æ¯”å¦‚ï¼Œä¸€ä¸ªä¸šåŠ¡TX0000ï¼Œæƒ³è¦æ¥å…¥é£æ§å†³ç­–ï¼Œæœ¬èº«TX0000æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡ï¼Œç°åœ¨è¦æ¥å…¥é£æ§å†³ç­–ã€‚</p>
<h3 data-id="heading-3">æ‹†åˆ†</h3>
<p>æ‹†åˆ†ä¹Ÿå°±æ˜¯åˆ†æ­¥ï¼Œå¦‚æ‹†åˆ†æˆTX0000_1å’ŒTX0000_2åˆ†åˆ«è¡¨ç¤ºå†³ç­–å‰åï¼Œå½“ç„¶è¿™åªæ˜¯é’ˆå¯¹æ¥å…¥é£æ§å†³ç­–ï¼Œæœ¬èº«å¯¹äºä¸šåŠ¡ç³»ç»Ÿè¿˜æ˜¯ä¸€ä¸ªå®Œæ•´çš„ã€‚</p>
<p>åœ¨é£æ§è®°å½•ä¸­å¯¹åº”çš„æ˜¯ä¸¤æ¡</p>


























<table><thead><tr><th>äº‹ä»¶ID</th><th>å­—æ®µ</th><th>æŒ‡æ ‡</th><th>å†³ç­–è®°å½•</th><th>ç­‰</th></tr></thead><tbody><tr><td>1000001</td><td>ã€‚ã€‚ã€‚</td><td>ã€‚ã€‚ã€‚</td><td>ã€‚ã€‚ã€‚</td><td>ã€‚ã€‚ã€‚</td></tr><tr><td>1000002</td><td>ã€‚ã€‚ã€‚</td><td>ã€‚ã€‚ã€‚</td><td>ã€‚ã€‚ã€‚</td><td>ã€‚ã€‚ã€‚</td></tr></tbody></table>
<p>å…³é”®æµç¨‹ï¼š</p>
<p>1ã€ä¸šåŠ¡ç³»ç»Ÿé€šè¿‡syncå°†å®Œæ•´æ•°æ®æ¥å…¥é£æ§</p>
<p>2ã€é£æ§è¿›è¡Œå®æ—¶å†³ç­–ï¼Œè¿”å›å†³ç­–ç»“æœå’Œé£æ§äº‹ä»¶ID</p>
<p>3ã€ä¸šåŠ¡ç³»ç»Ÿå¤„ç†å†³ç­–ç»“æœï¼ˆè¿™é‡Œçœå»éƒ¨åˆ†ï¼‰</p>
<p>4ã€ä¸šåŠ¡ç³»ç»Ÿé€šè¿‡asyncåŒæ­¥ç»“æœï¼Œä¾ç„¶åŒ…å«å®Œæ•´æ•°æ®</p>
<p>5ã€é£æ§è®¡ç®—äº‹åæŒ‡æ ‡ï¼ŒåŒæ ·ç”Ÿæˆäº‹ä»¶ID</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eac9a1e6fc8d41e2b642026e84071375~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5peg5aWI5L2V5p2o:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501240&amp;x-signature=x3Bj6%2FboIFy3p0SN13PmeNy0N0s%3D" alt="" loading="lazy"/></p>
<p>è¿™é‡Œæˆ‘ä»¬ä¸¾ä¸¤ä¸ªæŒ‡æ ‡çš„ä¾‹å­</p>
<p>1ã€7å¤©å†…åŒä¸€è®¾å¤‡IDå‘èµ·ä¸šåŠ¡TX0000çš„æ•°é‡ï¼Œå¦‚ä¸‹</p>
<p>å› ä¸ºæ˜¯å‘èµ·ï¼Œæ‰€ä»¥è¿™é‡Œé…ç½®çš„TX0000_1ï¼Œè¡¨ç¤ºåªæ˜¯è¦åšè¿™ä¸ªä¸šåŠ¡ï¼Œæ˜¯å¦å®Œæˆè¿˜æ˜¯çœ‹TX0000_2çš„æƒ…å†µã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/debcfe19ff0241b5a620d55de84cfd47~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5peg5aWI5L2V5p2o:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501240&amp;x-signature=68ffOH1TzPqsfeGbhQhXWIM8PDA%3D" alt="" loading="lazy"/></p>
<p>2ã€7å¤©å†…ç»Ÿä¸€è®¾å¤‡å®Œæˆä¸šåŠ¡TX0000çš„æ•°é‡ï¼Œå¦‚ä¸‹</p>
<p>å› ä¸ºæ˜¯å®Œæˆï¼Œæ‰€ä»¥é…ç½®çš„æ˜¯TX0000_2ä¸”ç»“æœéœ€è¦æ˜¯æˆåŠŸçš„ã€‚è¿™ä¸ªç»“æœå¯ä»¥æ˜¯é£æ§å†³ç­–åŠ å¼ºéªŒè¯çš„æˆåŠŸå¤±è´¥ä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸ä¸šåŠ¡æµç¨‹çš„ä»»ä½•æˆåŠŸå¤±è´¥ï¼Œå¯†ç é”™è¯¯ã€ä¸‹æ¸¸è¶…æ—¶ç­‰ç­‰ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4dde50100354485a92c5bbfac2b7283a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5peg5aWI5L2V5p2o:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501240&amp;x-signature=ePGUTJSEwRCau8rr51LyQlPI9Kw%3D" alt="" loading="lazy"/></p>
<p>è¿™é‡Œä½¿ç”¨äº†â€œäº‹ä»¶ç»“æœâ€ä½œä¸ºç»“æœå­—æ®µï¼Œè¿™ä¸ªéšæ„æ€ä¹ˆå®šä¹‰éƒ½è¡Œï¼Œçº¦å®šå¥½å°±è¡Œï¼Œä¹Ÿå¯ä»¥æ˜¯æ­¥éª¤1ã€2ã€3ï¼Œéƒ½è¡Œã€‚</p>
<h3 data-id="heading-4">ä¸æ‹†åˆ†</h3>
<p>å¦‚æœæ˜¯ä¸æ‹†åˆ†ï¼Œé‚£ä¹ˆå°±ä¿ç•™TX0000æ¥å…¥é£æ§å†³ç­–</p>
<p>åœ¨é£æ§è®°å½•ä¸­å¯¹åº”çš„æ˜¯ä¸€æ¡</p>



















<table><thead><tr><th>äº‹ä»¶ID</th><th>å­—æ®µ</th><th>æŒ‡æ ‡</th><th>å†³ç­–è®°å½•</th><th>ç­‰</th></tr></thead><tbody><tr><td>1000003</td><td>ã€‚ã€‚ã€‚+</td><td>ã€‚ã€‚ã€‚+</td><td>ã€‚ã€‚ã€‚</td><td>ã€‚ã€‚ã€‚</td></tr></tbody></table>
<p>å…³é”®æµç¨‹ï¼š</p>
<p>1ã€ä¸šåŠ¡ç³»ç»Ÿé€šè¿‡syncå°†å®Œæ•´æ•°æ®æ¥å…¥é£æ§</p>
<p>2ã€é£æ§è¿›è¡Œå®æ—¶å†³ç­–ï¼Œè¿”å›å†³ç­–ç»“æœå’Œé£æ§äº‹ä»¶ID</p>
<p>3ã€ä¸šåŠ¡ç³»ç»Ÿå¤„ç†å†³ç­–ç»“æœï¼ˆè¿™é‡Œçœå»éƒ¨åˆ†ï¼‰</p>
<p>4ã€ä¸šåŠ¡ç³»ç»Ÿé€šè¿‡asyncåŒæ­¥ç»“æœï¼ˆéœ€è¦åŒ…å«é£æ§äº‹ä»¶IDï¼‰</p>
<p>5ã€é£æ§æ ¹æ®äº‹ä»¶IDç¡®è®¤æ˜¯å¦ç»“æœåŒæ­¥ï¼Œè¡¥å……æ›´æ–°æ•°æ®ï¼Œè®¡ç®—äº‹åæŒ‡æ ‡</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46370c42747b49b8ace90f06b3898802~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5peg5aWI5L2V5p2o:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501240&amp;x-signature=F5vBg%2FDy76H4HZfIcJpTNJaf6m4%3D" alt="" loading="lazy"/></p>
<p>å¯¹æ¯”äºä¸Šï¼Œè¿˜æ˜¯è¿™ä¸¤ä¸ªæŒ‡æ ‡</p>
<p>1ã€7å¤©å†…åŒä¸€è®¾å¤‡IDå‘èµ·ä¸šåŠ¡TX0000çš„æ•°é‡</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/28493a8c18b44c78971caade6fcf4442~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5peg5aWI5L2V5p2o:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501240&amp;x-signature=r2W2EfDJvBsgHd4IuHQtD7uiEZ0%3D" alt="" loading="lazy"/></p>
<p>éœ€è¦æ³¨æ„è¿™é‡Œé¢å¤–é…ç½®äº†äº‹ä»¶ç»“æœä¸ºç©ºçš„æ¡ä»¶ï¼Œè¿™æ ·å¤„ç†æ˜¯å› ä¸ºï¼Œä½œä¸ºç»“æœåŒæ­¥ï¼Œä¼šé€šè¿‡äº‹ä»¶IDè¡¥å……ä¹‹å‰çš„æ•°æ®ï¼Œè¡¥å……åçš„æ•°æ®ä¼šä½œä¸ºä¸€æ¬¡ç‹¬ç«‹çš„æŒ‡æ ‡è®¡ç®—ï¼ŒæŒ‡æ ‡è®¡ç®—å¹¶æ²¡æœ‰äº‹åç»“æœçš„åŒºåˆ†ï¼Œæœ‰å¯èƒ½ä¼šé‡å¤è®¡ç®—ï¼Œæ‰€ä»¥æ¡ä»¶ä¸Šå°±éœ€è¦æœ‰åŒºåˆ«ã€‚</p>
<p>è¿˜æ˜¯ä»ä¾‹å­è¯´æ˜</p>
<p>aã€å†³ç­–æ—¶TX0000ï¼Œå®Œæ•´æ•°æ®ï¼ŒæŒ‡æ ‡è®¡ç®—ï¼Œå®æ—¶å†³ç­–</p>
<p>bã€TX0000çš„ç»“æœåŒæ­¥ï¼Œè¡¥å……ä¸Šå®Œæ•´æ•°æ®ï¼ŒæŒ‡æ ‡è®¡ç®—</p>
<p>æœ¬èº«è¿™æ˜¯åŒä¸€ä¸šåŠ¡çš„ä¸åŒé˜¶æ®µï¼Œå¦‚æœä¸åŠ ä»¥åŒºåˆ†ï¼Œä¼šè¢«è®¤ä¸ºæ˜¯ä¸åŒçš„ä¸¤ç¬”äº‹ä»¶è®¡ç®—ä¸¤æ¬¡ï¼ˆè™½ç„¶é¡¹ç›®ä½¿ç”¨äº†zsetå¹¶ä¸”ä½¿ç”¨äº‹ä»¶IDä½œä¸ºmemberçš„æ¨¡ç‰ˆï¼Œç†è®ºä¸Šä¸ä¼šå‡ºç°é‡å¤è®¡ç®—ï¼Œä½†æ˜¯é…ç½®ä¸Šä½“ç°ä¼šç›´æ¥çœå»è¿™éƒ¨åˆ†è®¡ç®—æµç¨‹ï¼Œä»è€ŒèŠ‚çœèµ„æºï¼‰ã€‚</p>
<p>2ã€7å¤©å†…ç»Ÿä¸€è®¾å¤‡å®Œæˆä¸šåŠ¡TX0000çš„æ•°é‡</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4fd21a29c0148c58c31e7099e1cfdf8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5peg5aWI5L2V5p2o:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501240&amp;x-signature=Ihvc04Lmis4Z4hLIz9PO5JvkIcU%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">å·®åˆ«</h3>
<p>æœ€åå†æ€»ç»“ä¸€ä¸‹åŒºåˆ«</p>
<p>æ‹†åˆ†ï¼šå°±æ˜¯æŠŠä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡ä¸»åŠ¨æ‹†åˆ†å¼€</p>
<ul>
<li>ä¼˜ç‚¹ï¼šæ¸…æ™°ï¼Œé£æ§é…ç½®ã€è®¡ç®—ç®€å•</li>
<li>ç¼ºç‚¹ï¼šéœ€è¦é‡å¤ä¸Šé€æ•°æ®</li>
</ul>
<p>ä¸æ‹†åˆ†ï¼šä¿ç•™å®Œæ•´ä¸šåŠ¡æ•°æ®ä¸€ä½“</p>
<ul>
<li>ä¼˜ç‚¹ï¼šæ•°æ®ä¸€ä½“ï¼Œæ›´è´´åˆå®é™…ä¸šåŠ¡</li>
<li>ç¼ºç‚¹ï¼šé£æ§å¤„ç†å¤æ‚ï¼Œå°¤å…¶æ˜¯è¡¥æ•°æ®ï¼Œé‡å¤è®¡ç®—ä¸Š</li>
</ul>
<p>å¦å¤–ï¼Œå¦‚æœè¦åšå†å²æ•°æ®é‡è·‘ï¼Œåˆæ˜¯ä¸€å¤§å¾ˆå…³é”®çš„é—®é¢˜ã€‚</p>
<p>å‰é¢è¯´è¿‡çš„å¦‚æœæ˜¯æ‹†åˆ†ï¼Œé‚£ä¹ˆå¯¹åº”è®°å½•å°±æ˜¯ä¸¤æ¡ï¼Œå¦‚æœæ˜¯ä¸æ‹†åˆ†å¯¹åº”è®°å½•å°±æ˜¯ä¸€æ¡ï¼Œç³»ç»Ÿæ˜¯å¦èƒ½ä¿è¯é‡è·‘å†å²æ•°æ®ä»ç„¶ä¿è¯æ­£ç¡®çš„è®¡ç®—ï¼Œè¿™å…¶å®æ˜¯æœ‰ç‚¹æµè®¡ç®—å’Œæ‰¹è®¡ç®—çš„æ„æ€äº†ã€‚</p>
<p>ç›®å‰ç³»ç»Ÿå¯¹äºä¸¤ç§æ¨¡å¼éƒ½æ˜¯æ”¯æŒçš„ï¼š</p>
<p>1ã€æƒ³è¦æ¥å…¥é£æ§ï¼Œä½†æ˜¯åªæ˜¯æƒ³åšäº‹åæŒ‡æ ‡è®¡ç®—ï¼Œå‘<code>/async</code>æ¥å£ï¼Œéœ€è¦å®Œæ•´çš„æ•°æ®ï¼Œå› ä¸ºä¸å­˜åœ¨æ•°æ®è¡¥å……ï¼Œåªä¼šä¾èµ–æœ¬æ¬¡æ•°æ®è®¡ç®—</p>
<p>2ã€æƒ³è¦æ¥å…¥é£æ§å†³ç­–ï¼Œéœ€è¦å®æ—¶åŒæ­¥å“åº”ï¼Œå‘<code>/sync</code>æ¥å£ï¼Œéœ€è¦å®Œæ•´æ•°æ®ï¼Œéå¸¸æ¨èç»“æœåŒæ­¥å‘<code>/async</code>æ¥å£ï¼Œæ­¤æ—¶åªéœ€è¦è¡¥å……æ•°æ®å³å¯</p>
<p>3ã€å¦å¤–è¿˜æœ‰ä¼šè¯è±å…åŠŸèƒ½ï¼Œå‰é¢ä¹Ÿè®²è¿‡äº†ï¼Œç®€å•è®²å°±æ˜¯åŒä¸€ä¼šè¯ä¸­é«˜çº§åˆ«çš„éªŒè¯é€šè¿‡ï¼Œå°±ä¸ç»™ä½äºè¿™ä¸ªçº§åˆ«çš„å†³ç­–äº†ï¼Œå¯é€‰ã€‚</p>
<h2 data-id="heading-6">å°ç»“</h2>
<p>æœ€ååºŸè¯ä¸€ä¸‹ï¼Œæ¯æ¬¡ä»æœ‰æƒ³æ³•åˆ°å®è·µï¼Œéƒ½ä¸æ˜¯é‚£ä¹ˆä¸€å¸†é£é¡ºçš„è¿‡ç¨‹ï¼Œå…¶ä¸­ä¹Ÿæœ‰å¾ˆå¤šæŒ£æ‰ï¼Œæ–¹æ¡ˆè®¾è®¡ï¼Œé‡æ¥ï¼Œæ¨ç¿»è¿‡å»ã€‚ã€‚ã€‚ä¸é‚£ä¹ˆå®¹æ˜“ã€‚</p>
<p>æˆ‘ç°åœ¨å·¥ä½œæ¨¡å¼ä¹Ÿå°±è¿™æ ·ï¼Œå¦‚ä¸‹å›¾ï¼Œä¸¤åˆ—</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8cda04a05ce9416283c02178f2ddc9c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5peg5aWI5L2V5p2o:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501240&amp;x-signature=oVEsflYIUK0w2abtVzM5VqpbUm4%3D" alt="" loading="lazy"/></p>
<p>å·¦åˆ—ï¼šç±»ä¼¼äºä»£åŠï¼Œæ¯å®Œæˆä¸€é¡¹åï¼Œå°†å…¶å‹¾æ‰ï¼Œä½†æ˜¯é¦–æ¬¡å‹¾æ‰å¹¶ä¸åˆ é™¤ï¼Œè€Œæ˜¯ä¿ç•™ä¸€æ®µæ—¶é—´ï¼Œå…·ä½“åˆ é™¤çš„æ—¶é—´å–å†³äºä¸‹æ¬¡ä»€ä¹ˆæ—¶å€™çœ‹åˆ°ï¼Œå¦‚æœè¿˜èƒ½å›æƒ³èµ·æ¥å¹¶ç¡®è®¤ç¡®å®æ˜¯å®Œæˆäº†ï¼Œé‚£ä¹ˆå°±åˆ é™¤ï¼Œå¦‚æœå›æƒ³ä¸èµ·æ¥å°±å†æ£€æŸ¥ä¸€ä¸‹ï¼Œç¡®è®¤æ˜¯å¦çœŸçš„å®Œæˆäº†ã€‚</p>
<p>å³åˆ—ï¼šè§„åˆ’ä¸­çš„å¯èƒ½ä¸æ˜¯æœ€è¿‘ä¸€æ®µæ—¶é—´è¦åšçš„ï¼Œè€Œä¸”ä¸€äº›ä¹Ÿåªæ˜¯ä¸´æ—¶çš„æƒ³æ³•ï¼Œå¾ˆæœ‰å¯èƒ½å…¶å®åé¢æ˜¯ä¸è¦åšçš„ï¼Œæ‰€ä»¥å®ƒå»å‘æœ‰ï¼Œ1ã€ä¸éœ€è¦çš„ï¼Œé‚£ä¹ˆå°±ä¼šåˆ é™¤æ‰ï¼›2ã€ç¡®å®éœ€è¦ï¼Œä½†æ˜¯å½“ä¸‹è¿˜æœ‰æ›´é‡è¦çš„ï¼Œæ”¾ç€ä¸åŠ¨ï¼›3ã€å¾ˆç´§æ€¥ï¼Œæœ€è¿‘è¦åšæ‰ï¼Œé‚£ä¹ˆå°±ç§»åŠ¨åˆ°å·¦åˆ—ã€‚</p>
<p>å¦å¤–ï¼Œä¸€äº›ç‰¹åˆ«çš„æ–‡ç« è®°å½•ä¸€ä¸‹ï¼Œå‘å‡ºæ¥æˆ–è€…æ•´ç†åˆ°ç³»ç»Ÿæ–‡æ¡£é‡Œã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ•°æ®ç»“æ„â€”â€”æ ‘]]></title>    <link>https://juejin.cn/post/7579889969985306675</link>    <guid>https://juejin.cn/post/7579889969985306675</guid>    <pubDate>2025-12-05T01:01:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579889969985306675" data-draft-id="7577663384423153715" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ•°æ®ç»“æ„â€”â€”æ ‘"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-05T01:01:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SevenCoding"/> <meta itemprop="url" content="https://juejin.cn/user/3261615728242467"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ•°æ®ç»“æ„â€”â€”æ ‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3261615728242467/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SevenCoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-05T01:01:50.000Z" title="Fri Dec 05 2025 01:01:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»47åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°</h2>
<p>æ ‘å°±æ˜¯ä¸€ç§ç±»ä¼¼ç°å®ç”Ÿæ´»ä¸­çš„æ ‘çš„æ•°æ®ç»“æ„ï¼ˆå€’ç½®çš„æ ‘ï¼‰ã€‚ä»»ä½•ä¸€é¢—éç©ºæ ‘åªæœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ã€‚</p>
<p>æ ‘çš„å®šä¹‰ï¼šæ ‘æ˜¯â¼€ç§æ•°æ®ç»“æ„ï¼Œå®ƒæ˜¯ç”±n(nâ‰¥1)ä¸ªæœ‰é™èŠ‚ç‚¹ç»„æˆâ¼€ä¸ªå…·æœ‰å±‚æ¬¡å…³ç³»çš„é›†åˆã€‚æŠŠå®ƒå«åšâ€œæ ‘â€æ˜¯å› ä¸ºå®ƒçœ‹èµ·æ¥åƒâ¼€æ£µå€’æŒ‚çš„æ ‘ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯æ ¹æœä¸Šï¼Œâ½½å¶æœä¸‹çš„ã€‚</p>
<p>ä¸€æ£µæ ‘å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<ol>
<li>æ¯ä¸ªèŠ‚ç‚¹æœ‰é›¶ä¸ªæˆ–å¤šä¸ªâ¼¦èŠ‚ç‚¹</li>
<li>æ²¡æœ‰â½—èŠ‚ç‚¹çš„èŠ‚ç‚¹ç§°ä¸ºæ ¹èŠ‚ç‚¹</li>
<li>æ¯â¼€ä¸ªâ¾®æ ¹èŠ‚ç‚¹æœ‰ä¸”åªæœ‰â¼€ä¸ªâ½—èŠ‚ç‚¹</li>
<li>é™¤äº†æ ¹èŠ‚ç‚¹å¤–ï¼Œæ¯ä¸ªâ¼¦èŠ‚ç‚¹å¯ä»¥åˆ†ä¸ºå¤šä¸ªä¸ç›¸äº¤çš„â¼¦æ ‘</li>
<li>ä¸€æ£µæ ‘ä¸­çš„ä»»æ„ä¸¤ä¸ªç»“ç‚¹æœ‰ä¸”ä»…æœ‰å”¯ä¸€çš„ä¸€æ¡è·¯å¾„è¿é€šã€‚</li>
<li>ä¸€æ£µæ ‘å¦‚æœæœ‰ n ä¸ªç»“ç‚¹ï¼Œé‚£ä¹ˆå®ƒä¸€å®šæ°å¥½æœ‰ n-1 æ¡è¾¹ã€‚</li>
<li>ä¸€æ£µæ ‘ä¸åŒ…å«å›è·¯ã€‚</li>
</ol>
<p>ä¸‹å›¾å°±æ˜¯ä¸€é¢—æ ‘ï¼Œå¹¶ä¸”æ˜¯ä¸€é¢—äºŒå‰æ ‘ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dfad49603f9341f19dd5ae8728b85bb2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501310&amp;x-signature=M4J1PkcN2dopMEPAktiU3OuL7oE%3D" alt="" loading="lazy"/></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œé€šè¿‡ä¸Šé¢è¿™å¼ å›¾è¯´æ˜ä¸€ä¸‹æ ‘ä¸­çš„å¸¸ç”¨æ¦‚å¿µï¼š</p>
<ul>
<li><strong>èŠ‚ç‚¹</strong>ï¼šæ ‘ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½å¯ä»¥ç»Ÿç§°ä¸ºèŠ‚ç‚¹ã€‚</li>
<li><strong>èŠ‚ç‚¹çš„åº¦</strong>ï¼šâ¼€ä¸ªèŠ‚ç‚¹å«æœ‰çš„â¼¦æ ‘çš„ä¸ªæ•°ç§°ä¸ºè¯¥èŠ‚ç‚¹çš„åº¦</li>
<li><strong>æ ‘çš„åº¦</strong>ï¼šâ¼€æ£µæ ‘ä¸­ï¼Œæœ€â¼¤çš„èŠ‚ç‚¹åº¦ç§°ä¸ºæ ‘çš„åº¦ï¼›</li>
<li><strong>å¶èŠ‚ç‚¹æˆ–ç»ˆç«¯èŠ‚ç‚¹</strong>ï¼šåº¦ä¸ºé›¶çš„èŠ‚ç‚¹ï¼›</li>
<li><strong>â¾®ç»ˆç«¯èŠ‚ç‚¹æˆ–åˆ†â½€èŠ‚ç‚¹</strong>ï¼šåº¦ä¸ä¸ºé›¶çš„èŠ‚ç‚¹ï¼›</li>
<li><strong>æ ¹èŠ‚ç‚¹</strong>ï¼šé¡¶å±‚èŠ‚ç‚¹æˆ–è€…è¯´æ²¡æœ‰çˆ¶èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚ä¸Šå›¾ä¸­ A èŠ‚ç‚¹å°±æ˜¯æ ¹èŠ‚ç‚¹ã€‚</li>
<li><strong>çˆ¶èŠ‚ç‚¹</strong>ï¼šè‹¥ä¸€ä¸ªèŠ‚ç‚¹å«æœ‰å­èŠ‚ç‚¹ï¼Œåˆ™è¿™ä¸ªèŠ‚ç‚¹ç§°ä¸ºå…¶å­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ã€‚ä¸Šå›¾ä¸­çš„ B èŠ‚ç‚¹æ˜¯ D èŠ‚ç‚¹ã€E èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ã€‚</li>
<li><strong>å­èŠ‚ç‚¹</strong>ï¼šä¸€ä¸ªèŠ‚ç‚¹å«æœ‰çš„å­æ ‘çš„æ ¹èŠ‚ç‚¹ç§°ä¸ºè¯¥èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ã€‚ä¸Šå›¾ä¸­ D èŠ‚ç‚¹ã€E èŠ‚ç‚¹æ˜¯ B èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ã€‚</li>
<li><strong>å…„å¼ŸèŠ‚ç‚¹</strong>ï¼šå…·æœ‰ç›¸åŒçˆ¶èŠ‚ç‚¹çš„èŠ‚ç‚¹äº’ç§°ä¸ºå…„å¼ŸèŠ‚ç‚¹ã€‚ä¸Šå›¾ä¸­ D èŠ‚ç‚¹ã€E èŠ‚ç‚¹çš„å…±åŒçˆ¶èŠ‚ç‚¹æ˜¯ B èŠ‚ç‚¹ï¼Œæ•… D å’Œ E ä¸ºå…„å¼ŸèŠ‚ç‚¹ã€‚</li>
<li><strong>å¶å­èŠ‚ç‚¹</strong>ï¼šæ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚ä¸Šå›¾ä¸­çš„ Dã€Fã€Hã€I éƒ½æ˜¯å¶å­èŠ‚ç‚¹ã€‚</li>
<li><strong>èŠ‚ç‚¹çš„é«˜åº¦</strong>ï¼šè¯¥èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„æœ€é•¿è·¯å¾„æ‰€åŒ…å«çš„è¾¹æ•°ã€‚</li>
<li><strong>èŠ‚ç‚¹çš„æ·±åº¦</strong>ï¼šæ ¹èŠ‚ç‚¹åˆ°è¯¥èŠ‚ç‚¹çš„è·¯å¾„æ‰€åŒ…å«çš„è¾¹æ•°</li>
<li><strong>èŠ‚ç‚¹çš„å±‚æ•°</strong>ï¼šèŠ‚ç‚¹çš„æ·±åº¦+1ã€‚</li>
<li><strong>æ ‘çš„é«˜åº¦</strong>ï¼šæ ¹èŠ‚ç‚¹çš„é«˜åº¦ã€‚</li>
</ul>
<blockquote>
<p>å…³äºæ ‘çš„æ·±åº¦å’Œé«˜åº¦çš„å®šä¹‰å¯ä»¥çœ‹ stackoverflow ä¸Šçš„è¿™ä¸ªé—®é¢˜ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F2603692%2Fwhat-is-the-difference-between-tree-depth-and-height" target="_blank" title="https://stackoverflow.com/questions/2603692/what-is-the-difference-between-tree-depth-and-height" ref="nofollow noopener noreferrer">What is the difference between tree depth and height?</a> ã€‚</p>
</blockquote>
<h2 data-id="heading-1">äºŒå‰æ ‘çš„å­˜å‚¨</h2>
<p>äºŒå‰æ ‘çš„å­˜å‚¨ä¸»è¦åˆ†ä¸º <strong>é“¾å¼å­˜å‚¨</strong> å’Œ <strong>é¡ºåºå­˜å‚¨</strong> ä¸¤ç§ï¼š</p>
<h3 data-id="heading-2">é“¾å¼å­˜å‚¨</h3>
<p>å’Œé“¾è¡¨ç±»ä¼¼ï¼ŒäºŒå‰æ ‘çš„é“¾å¼å­˜å‚¨ä¾é æŒ‡é’ˆå°†å„ä¸ªèŠ‚ç‚¹ä¸²è”èµ·æ¥ï¼Œä¸éœ€è¦è¿ç»­çš„å­˜å‚¨ç©ºé—´ã€‚</p>
<p>æ¯ä¸ªèŠ‚ç‚¹åŒ…æ‹¬ä¸‰ä¸ªå±æ€§ï¼š</p>
<ul>
<li>æ•°æ® dataã€‚data ä¸ä¸€å®šæ˜¯å•ä¸€çš„æ•°æ®ï¼Œæ ¹æ®ä¸åŒæƒ…å†µï¼Œå¯ä»¥æ˜¯å¤šä¸ªå…·æœ‰ä¸åŒç±»å‹çš„æ•°æ®ã€‚</li>
<li>å·¦èŠ‚ç‚¹æŒ‡é’ˆ left</li>
<li>å³èŠ‚ç‚¹æŒ‡é’ˆ rightã€‚</li>
</ul>
<p>å¯æ˜¯ JAVA æ²¡æœ‰æŒ‡é’ˆå•Šï¼</p>
<p>é‚£å°±ç›´æ¥å¼•ç”¨å¯¹è±¡å‘—ï¼ˆåˆ«é—®æˆ‘å¯¹è±¡å“ªé‡Œæ‰¾ï¼‰</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0830b36950a34d9096dceb716300b8ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501310&amp;x-signature=TOOYlXXjRuQClH8dFtXxYTaN7gI%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">é¡ºåºå­˜å‚¨</h3>
<p>é¡ºåºå­˜å‚¨å°±æ˜¯åˆ©ç”¨æ•°ç»„è¿›è¡Œå­˜å‚¨ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªä½ç½®ä»…å­˜å‚¨èŠ‚ç‚¹çš„ dataï¼Œä¸å­˜å‚¨å·¦å³å­èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œå­èŠ‚ç‚¹çš„ç´¢å¼•é€šè¿‡æ•°ç»„ä¸‹æ ‡å®Œæˆã€‚æ ¹ç»“ç‚¹çš„åºå·ä¸º 1ï¼Œå¯¹äºæ¯ä¸ªèŠ‚ç‚¹ Nodeï¼Œå‡è®¾å®ƒå­˜å‚¨åœ¨æ•°ç»„ä¸­ä¸‹æ ‡ä¸º i çš„ä½ç½®ï¼Œé‚£ä¹ˆå®ƒçš„å·¦å­èŠ‚ç‚¹å°±å­˜å‚¨åœ¨ 2i çš„ä½ç½®ï¼Œå®ƒçš„å³å­èŠ‚ç‚¹å­˜å‚¨åœ¨ä¸‹æ ‡ä¸º 2i+1 çš„ä½ç½®ã€‚</p>
<p>ä¸€æ£µå®Œå…¨äºŒå‰æ ‘çš„æ•°ç»„é¡ºåºå­˜å‚¨å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4e76fa2e5c2d4d458d707979d1a628d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501310&amp;x-signature=UuIDVneRwB6P8xPMNI1OcKkv5Ik%3D" alt="" loading="lazy"/></p>
<p>å¤§å®¶å¯ä»¥è¯•ç€å¡«å†™ä¸€ä¸‹å­˜å‚¨å¦‚ä¸‹äºŒå‰æ ‘çš„æ•°ç»„ï¼Œæ¯”è¾ƒä¸€ä¸‹å’Œå®Œå…¨äºŒå‰æ ‘çš„é¡ºåºå­˜å‚¨æœ‰ä½•åŒºåˆ«ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7982d4048f77499bbb0be5e0b4631398~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501310&amp;x-signature=2fziytlE4AD3n%2FpwFuRxs0oBwug%3D" alt="" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæˆ‘ä»¬è¦å­˜å‚¨çš„äºŒå‰æ ‘ä¸æ˜¯å®Œå…¨äºŒå‰æ ‘ï¼Œåœ¨æ•°ç»„ä¸­å°±ä¼šå‡ºç°ç©ºéš™ï¼Œå¯¼è‡´å†…å­˜åˆ©ç”¨ç‡é™ä½</p>
<h2 data-id="heading-4">äºŒå‰æ ‘çš„éå†</h2>
<h3 data-id="heading-5">é€’å½’éå†</h3>
<h4 data-id="heading-6">å…ˆåºéå†</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b415e3edc8b45258e5d7406d8ea0d40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501310&amp;x-signature=LHmeGTd9HOV1hsaF8PH16ZVZKbo%3D" alt="" loading="lazy"/></p>
<p>äºŒå‰æ ‘çš„å…ˆåºéå†ï¼Œå°±æ˜¯å…ˆè¾“å‡ºæ ¹ç»“ç‚¹ï¼Œå†éå†å·¦å­æ ‘ï¼Œæœ€åéå†å³å­æ ‘ï¼Œéå†å·¦å­æ ‘å’Œå³å­æ ‘çš„æ—¶å€™ï¼ŒåŒæ ·éµå¾ªå…ˆåºéå†çš„è§„åˆ™ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€’å½’å®ç°å…ˆåºéå†ã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">preOrder</span><span class="hljs-params">(TreeNode root)</span>{
	<span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>){
		<span class="hljs-keyword">return</span>;
	}
	system.out.println(root.data);
	preOrder(root.left);
	preOrder(root.right);
}
</code></pre>
<h4 data-id="heading-7">ä¸­åºéå†</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5fb87ac552bb4fdabba60eacc7913fe2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501310&amp;x-signature=%2BEQBp%2BUIEZHqRIE4Q3I33Td9zCw%3D" alt="" loading="lazy"/></p>
<p>äºŒå‰æ ‘çš„ä¸­åºéå†ï¼Œå°±æ˜¯å…ˆé€’å½’ä¸­åºéå†å·¦å­æ ‘ï¼Œå†è¾“å‡ºæ ¹ç»“ç‚¹çš„å€¼ï¼Œå†é€’å½’ä¸­åºéå†å³å­æ ‘ï¼Œå¤§å®¶å¯ä»¥æƒ³è±¡æˆä¸€å·´æŒæŠŠæ ‘å‹æ‰ï¼Œçˆ¶ç»“ç‚¹è¢«æ‹åˆ°äº†å·¦å­èŠ‚ç‚¹å’Œå³å­èŠ‚ç‚¹çš„ä¸­é—´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c2ced18690bd4fc6ba1b516b8148df44~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501310&amp;x-signature=ASd2h2qYOj0WYuoiH8NLKb6qLtU%3D" alt="" loading="lazy"/></p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">inOrder</span><span class="hljs-params">(TreeNode root)</span>{
	<span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>){
		<span class="hljs-keyword">return</span>;
	}
	inOrder(root.left);
	system.out.println(root.data);
	inOrder(root.right);
}
</code></pre>
<h4 data-id="heading-8">ååºéå†</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ee71fcebbc8486ca62a75fd70055ad0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501310&amp;x-signature=zkgrsktS%2BLQpQiGEyaQx4H%2B8NaM%3D" alt="" loading="lazy"/></p>
<p>äºŒå‰æ ‘çš„ååºéå†ï¼Œå°±æ˜¯å…ˆé€’å½’ååºéå†å·¦å­æ ‘ï¼Œå†é€’å½’ååºéå†å³å­æ ‘ï¼Œæœ€åè¾“å‡ºæ ¹ç»“ç‚¹çš„å€¼</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">postOrder</span><span class="hljs-params">(TreeNode root)</span>{
	<span class="hljs-keyword">if</span>(root == <span class="hljs-literal">null</span>){
		<span class="hljs-keyword">return</span>;
	}
 postOrder(root.left);
	postOrder(root.right);
	system.out.println(root.data);
}
</code></pre>
<h3 data-id="heading-9">å±‚åºéå†</h3>
<p>å±‚åºéå†å±äºè¿­ä»£éå†ï¼Œä¹Ÿæ¯”è¾ƒç®€å•</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1b37aed5fcc47d1a1b3f2d8d31baa40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501310&amp;x-signature=KtZfu8vIqyMxh9wtqn44vpRVyT0%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-10">å‰åºéå†</h4>
<p>å‰åºéå†æ˜¯ä¸­å·¦å³ï¼Œæ¯æ¬¡å…ˆå¤„ç†çš„æ˜¯ä¸­é—´èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå…ˆå°†æ ¹èŠ‚ç‚¹æ”¾å…¥æ ˆä¸­ï¼Œç„¶åå°†å³å­©å­åŠ å…¥æ ˆï¼Œå†åŠ å…¥å·¦å­©å­ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å‰åºéå†é¡ºåºï¼šä¸­-å·¦-å³ï¼Œå…¥æ ˆé¡ºåºï¼šä¸­-å³-å·¦</span>
    <span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title function_">preorderTraversal</span><span class="hljs-params">(TreeNode root)</span> {
        List&lt;Integer&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>){
            <span class="hljs-keyword">return</span> result;
        }
        Stack&lt;TreeNode&gt; stack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stack</span>&lt;&gt;();
        stack.push(root);
        <span class="hljs-keyword">while</span> (!stack.isEmpty()){
            <span class="hljs-type">TreeNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> stack.pop();
            result.add(node.val);
            <span class="hljs-keyword">if</span> (node.right != <span class="hljs-literal">null</span>){
                stack.push(node.right);
            }
            <span class="hljs-keyword">if</span> (node.left != <span class="hljs-literal">null</span>){
                stack.push(node.left);
            }
        }
        <span class="hljs-keyword">return</span> result;
    }
</code></pre>
<h4 data-id="heading-11">ä¸­åºéå†</h4>
<p>åˆšåˆšåœ¨è¿›è¡Œå‰åºéå†è¿­ä»£çš„è¿‡ç¨‹ä¸­ï¼Œå…¶å®æœ‰ä¸¤ä¸ªæ“ä½œï¼š</p>
<ol>
<li><strong>å¤„ç†ï¼šå°†å…ƒç´ æ”¾è¿›resultæ•°ç»„ä¸­</strong></li>
<li><strong>è®¿é—®ï¼šéå†èŠ‚ç‚¹</strong></li>
</ol>
<p>å‰åºéå†çš„é¡ºåºæ˜¯ä¸­å·¦å³ï¼Œå…ˆè®¿é—®çš„å…ƒç´ æ˜¯ä¸­é—´èŠ‚ç‚¹ï¼Œè¦å¤„ç†çš„å…ƒç´ ä¹Ÿæ˜¯ä¸­é—´èŠ‚ç‚¹ï¼Œ<strong>å› ä¸ºè¦è®¿é—®çš„å…ƒç´ å’Œè¦å¤„ç†çš„å…ƒç´ é¡ºåºæ˜¯ä¸€è‡´çš„ï¼Œéƒ½æ˜¯ä¸­é—´èŠ‚ç‚¹</strong>ï¼Œæ‰€ä»¥åˆšåˆšèƒ½å†™å‡ºç›¸å¯¹ç®€æ´çš„ä»£ç </p>
<p>é‚£ä¹ˆå†çœ‹çœ‹ä¸­åºéå†ï¼Œä¸­åºéå†æ˜¯å·¦ä¸­å³ï¼Œå…ˆè®¿é—®çš„æ˜¯äºŒå‰æ ‘é¡¶éƒ¨çš„èŠ‚ç‚¹ï¼Œç„¶åä¸€å±‚ä¸€å±‚å‘ä¸‹è®¿é—®ï¼Œç›´åˆ°åˆ°è¾¾æ ‘å·¦é¢çš„æœ€åº•éƒ¨ï¼Œå†å¼€å§‹å¤„ç†èŠ‚ç‚¹ï¼ˆä¹Ÿå°±æ˜¯åœ¨æŠŠèŠ‚ç‚¹çš„æ•°å€¼æ”¾è¿›resultæ•°ç»„ä¸­ï¼‰ï¼Œè¿™å°±é€ æˆäº†<strong>å¤„ç†é¡ºåºå’Œè®¿é—®é¡ºåºæ˜¯ä¸ä¸€è‡´çš„ã€‚</strong></p>
<p>é‚£ä¹ˆ<strong>åœ¨ä½¿ç”¨è¿­ä»£æ³•å†™ä¸­åºéå†ï¼Œå°±éœ€è¦å€Ÿç”¨æŒ‡é’ˆçš„éå†æ¥å¸®åŠ©è®¿é—®èŠ‚ç‚¹ï¼Œæ ˆåˆ™ç”¨æ¥å¤„ç†èŠ‚ç‚¹ä¸Šçš„å…ƒç´ ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¸­åºéå†é¡ºåº: å·¦-ä¸­-å³ å…¥æ ˆé¡ºåºï¼š å·¦-å³</span>
    <span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title function_">inorderTraversal</span><span class="hljs-params">(TreeNode root)</span> {
        List&lt;Integer&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>){
            <span class="hljs-keyword">return</span> result;
        }
        Stack&lt;TreeNode&gt; stack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stack</span>&lt;&gt;();
        <span class="hljs-type">TreeNode</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> root;
        <span class="hljs-keyword">while</span> (cur != <span class="hljs-literal">null</span> || !stack.isEmpty()){
           <span class="hljs-keyword">if</span> (cur != <span class="hljs-literal">null</span>){
               stack.push(cur);
               cur = cur.left;
           }<span class="hljs-keyword">else</span>{
               cur = stack.pop();
               result.add(cur.val);
               cur = cur.right;
           }
        }
        <span class="hljs-keyword">return</span> result;
    }
</code></pre>
<h4 data-id="heading-12">ååºéå†</h4>
<p>åç»­éå†æ˜¯å·¦å³ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦è°ƒæ•´ä¸€ä¸‹å…ˆåºéå†çš„ä»£ç é¡ºåºï¼Œå°±å˜æˆä¸­å³å·¦çš„éå†é¡ºåºï¼Œç„¶ååœ¨åè½¬resultæ•°ç»„ï¼Œè¾“å‡ºçš„ç»“æœé¡ºåºå°±æ˜¯å·¦å³ä¸­äº†</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ååºéå†é¡ºåº å·¦-å³-ä¸­ å…¥æ ˆé¡ºåºï¼šä¸­-å·¦-å³ å‡ºæ ˆé¡ºåºï¼šä¸­-å³-å·¦ï¼Œ æœ€åç¿»è½¬ç»“æœ</span>
    <span class="hljs-keyword">public</span> List&lt;Integer&gt; <span class="hljs-title function_">postorderTraversal</span><span class="hljs-params">(TreeNode root)</span> {
        List&lt;Integer&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>){
            <span class="hljs-keyword">return</span> result;
        }
        Stack&lt;TreeNode&gt; stack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stack</span>&lt;&gt;();
        stack.push(root);
        <span class="hljs-keyword">while</span> (!stack.isEmpty()){
            <span class="hljs-type">TreeNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> stack.pop();
            result.add(node.val);
            <span class="hljs-keyword">if</span> (node.left != <span class="hljs-literal">null</span>){
                stack.push(node.left);
            }
            <span class="hljs-keyword">if</span> (node.right != <span class="hljs-literal">null</span>){
                stack.push(node.right);
            }
        }
        Collections.reverse(result);
        <span class="hljs-keyword">return</span> result;
    }
</code></pre>
<h2 data-id="heading-13">äºŒå‰æ ‘çš„åˆ†ç±»</h2>
<p><strong>äºŒå‰æ ‘</strong>ï¼ˆBinary treeï¼‰æ˜¯æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šåªæœ‰ä¸¤ä¸ªåˆ†æ”¯ï¼ˆå³ä¸å­˜åœ¨åˆ†æ”¯åº¦å¤§äº 2 çš„èŠ‚ç‚¹ï¼‰çš„æ ‘ç»“æ„ã€‚</p>
<p><strong>äºŒå‰æ ‘</strong> çš„åˆ†æ”¯é€šå¸¸è¢«ç§°ä½œâ€œ<strong>å·¦å­æ ‘</strong>â€æˆ–â€œ<strong>å³å­æ ‘</strong>â€ã€‚å¹¶ä¸”ï¼Œ<strong>äºŒå‰æ ‘</strong> çš„åˆ†æ”¯å…·æœ‰å·¦å³æ¬¡åºï¼Œä¸èƒ½éšæ„é¢ å€’ã€‚</p>
<p><strong>äºŒå‰æ ‘</strong> çš„ç¬¬ i å±‚è‡³å¤šæ‹¥æœ‰ <code>2^(i-1)</code> ä¸ªèŠ‚ç‚¹ï¼Œæ·±åº¦ä¸º k çš„äºŒå‰æ ‘è‡³å¤šæ€»å…±æœ‰ <code>2^(k+1)-1</code> ä¸ªèŠ‚ç‚¹ï¼ˆæ»¡äºŒå‰æ ‘çš„æƒ…å†µï¼‰ï¼Œè‡³å°‘æœ‰ <code>2^(k)</code> ä¸ªèŠ‚ç‚¹ï¼ˆå…³äºèŠ‚ç‚¹çš„æ·±åº¦çš„å®šä¹‰å›½å†…äº‰è®®æ¯”è¾ƒå¤šï¼Œæˆ‘ä¸ªäººæ¯”è¾ƒè®¤å¯ç»´åŸºç™¾ç§‘å¯¹<a href="https://link.juejin.cn?target=https%3A%2F%2Fzh.wikipedia.org%2Fwiki%2F%25E6%25A0%2591_(%25E6%2595%25B0%25E6%258D%25AE%25E7%25BB%2593%25E6%259E%2584)%23%2F%25E6%259C%25AF%25E8%25AF%25AD" target="_blank" title="https://zh.wikipedia.org/wiki/%E6%A0%91_(%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84)#/%E6%9C%AF%E8%AF%AD" ref="nofollow noopener noreferrer">èŠ‚ç‚¹æ·±åº¦çš„å®šä¹‰</a>ï¼‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6e2eac7a75847d2b1419fcbd41c2e24~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501310&amp;x-signature=dENIrN00Q0Ly5Z1phlE3JiOVRyc%3D" alt="" loading="lazy"/></p>
<p>â¼†å‰æ ‘åœ¨Java ä¸­è¡¨ç¤ºï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TreeLinkNode</span> {
	<span class="hljs-type">int</span> val;
	<span class="hljs-type">TreeLinkNode</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
	<span class="hljs-type">TreeLinkNode</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
	<span class="hljs-type">TreeLinkNode</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
	
	TreeLinkNode(<span class="hljs-type">int</span> val) {
		<span class="hljs-built_in">this</span>.val = val;
	}
}
</code></pre>
<h3 data-id="heading-14">æ»¡äºŒå‰æ ‘</h3>
<p>ä¸€ä¸ªäºŒå‰æ ‘ï¼Œå¦‚æœæ¯ä¸€ä¸ªå±‚çš„ç»“ç‚¹æ•°éƒ½è¾¾åˆ°æœ€å¤§å€¼ï¼Œåˆ™è¿™ä¸ªäºŒå‰æ ‘å°±æ˜¯ <strong>æ»¡äºŒå‰æ ‘</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªäºŒå‰æ ‘çš„å±‚æ•°ä¸º Kï¼Œä¸”ç»“ç‚¹æ€»æ•°æ˜¯(2^k) -1 ï¼Œåˆ™å®ƒå°±æ˜¯ <strong>æ»¡äºŒå‰æ ‘</strong>ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6bcc884f2b544c499c2290fc36910d13~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501310&amp;x-signature=l4%2Bs%2FVTR7GpReTLPftjrDWOhayY%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-15">å®Œå…¨äºŒå‰æ ‘</h3>
<p>é™¤æœ€åä¸€å±‚å¤–ï¼Œè‹¥å…¶ä½™å±‚éƒ½æ˜¯æ»¡çš„ï¼Œå¹¶ä¸”æœ€åä¸€å±‚æˆ–è€…æ˜¯æ»¡çš„ï¼Œæˆ–è€…æ˜¯åœ¨å³è¾¹ç¼ºå°‘è¿ç»­è‹¥å¹²èŠ‚ç‚¹ï¼Œåˆ™è¿™ä¸ªäºŒå‰æ ‘å°±æ˜¯ <strong>å®Œå…¨äºŒå‰æ ‘</strong> ã€‚</p>
<p>å¤§å®¶å¯ä»¥æƒ³è±¡ä¸ºä¸€æ£µæ ‘ä»æ ¹ç»“ç‚¹å¼€å§‹æ‰©å±•ï¼Œæ‰©å±•å®Œå·¦å­èŠ‚ç‚¹æ‰èƒ½å¼€å§‹æ‰©å±•å³å­èŠ‚ç‚¹ï¼Œæ¯æ‰©å±•å®Œä¸€å±‚ï¼Œæ‰èƒ½ç»§ç»­æ‰©å±•ä¸‹ä¸€å±‚ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4bb2c6a3bd6445479f9236c31d7ef252~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501310&amp;x-signature=GopYV1y8FjDbX7PzwsWWp3IrXa4%3D" alt="" loading="lazy"/></p>
<p>å®Œå…¨äºŒå‰æ ‘æœ‰ä¸€ä¸ªå¾ˆå¥½çš„æ€§è´¨ï¼š<strong>çˆ¶ç»“ç‚¹å’Œå­èŠ‚ç‚¹çš„åºå·æœ‰ç€å¯¹åº”å…³ç³»ã€‚</strong></p>
<p>ç»†å¿ƒçš„å°ä¼™ä¼´å¯èƒ½å‘ç°äº†ï¼Œå½“æ ¹èŠ‚ç‚¹çš„å€¼ä¸º 1 çš„æƒ…å†µä¸‹ï¼Œè‹¥çˆ¶ç»“ç‚¹çš„åºå·æ˜¯ iï¼Œé‚£ä¹ˆå·¦å­èŠ‚ç‚¹çš„åºå·å°±æ˜¯ 2iï¼Œå³å­èŠ‚ç‚¹çš„åºå·æ˜¯ 2i+1ã€‚è¿™ä¸ªæ€§è´¨ä½¿å¾—å®Œå…¨äºŒå‰æ ‘åˆ©ç”¨æ•°ç»„å­˜å‚¨æ—¶å¯ä»¥æå¤§åœ°èŠ‚çœç©ºé—´ï¼Œä»¥åŠåˆ©ç”¨åºå·æ‰¾åˆ°æŸä¸ªèŠ‚ç‚¹çš„çˆ¶ç»“ç‚¹å’Œå­èŠ‚ç‚¹ï¼Œåç»­äºŒå‰æ ‘çš„å­˜å‚¨ä¼šè¯¦ç»†ä»‹ç»ã€‚</p>
<p>è‹¥æœ€åº•å±‚ä¸ºç¬¬ h å±‚ï¼ˆhä»1å¼€å§‹ï¼‰ï¼Œåˆ™è¯¥å±‚åŒ…å« 1~ 2^(h-1) ä¸ªèŠ‚ç‚¹ã€‚</p>
<h3 data-id="heading-16">äºŒå‰æœç´¢æ ‘</h3>
<p>å‰é¢ä»‹ç»çš„æ ‘ï¼Œéƒ½æ²¡æœ‰æ•°å€¼çš„ï¼Œè€ŒäºŒå‰æœç´¢æ ‘æ˜¯æœ‰æ•°å€¼çš„äº†ï¼Œ<strong>äºŒå‰æœç´¢æ ‘æ˜¯ä¸€ä¸ªæœ‰åºæ ‘</strong>ã€‚</p>
<ul>
<li>è‹¥å®ƒçš„å·¦å­æ ‘ä¸ç©ºï¼Œåˆ™å·¦å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å°äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ï¼›</li>
<li>è‹¥å®ƒçš„å³å­æ ‘ä¸ç©ºï¼Œåˆ™å³å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å¤§äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ï¼›</li>
<li>å®ƒçš„å·¦ã€å³å­æ ‘ä¹Ÿåˆ†åˆ«ä¸ºäºŒå‰æ’åºæ ‘</li>
</ul>
<p>ä¸‹é¢è¿™ä¸¤æ£µæ ‘éƒ½æ˜¯æœç´¢æ ‘</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/49c8434b8f7d43fb841b0cec0f9f539c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501310&amp;x-signature=%2FxQFsGFSxU%2FcyVhUD9NFAezZbgI%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-17">å¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼ˆAVLæ ‘ï¼‰</h3>
<p><strong>å¹³è¡¡äºŒå‰æ ‘</strong> æ˜¯ä¸€æ£µäºŒå‰æ’åºæ ‘ï¼Œä¸”å…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š</p>
<ol>
<li>å¯ä»¥æ˜¯ä¸€æ£µç©ºæ ‘</li>
<li>å¦‚æœä¸æ˜¯ç©ºæ ‘ï¼Œå®ƒçš„å·¦å³ä¸¤ä¸ªå­æ ‘çš„é«˜åº¦å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡ 1ï¼Œå¹¶ä¸”å·¦å³ä¸¤ä¸ªå­æ ‘éƒ½æ˜¯ä¸€æ£µå¹³è¡¡äºŒå‰æ ‘ã€‚</li>
</ol>
<p>å¹³è¡¡äºŒå‰æ ‘çš„å¸¸ç”¨å®ç°æ–¹æ³•æœ‰ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.seven97.top%2Fjava%2Fcollection%2F03-map2-treeset-treemap.html%23%25E7%25BA%25A2%25E9%25BB%2591%25E6%25A0%2591" target="_blank" title="https://www.seven97.top/java/collection/03-map2-treeset-treemap.html#%E7%BA%A2%E9%BB%91%E6%A0%91" ref="nofollow noopener noreferrer"><strong>çº¢é»‘æ ‘</strong></a>ã€<strong>æ›¿ç½ªç¾Šæ ‘</strong>ã€<strong>åŠ æƒå¹³è¡¡æ ‘</strong>ã€<strong>ä¼¸å±•æ ‘</strong> ç­‰ã€‚</p>
<p>åœ¨ç»™å¤§å®¶å±•ç¤ºå¹³è¡¡äºŒå‰æ ‘ä¹‹å‰ï¼Œå…ˆç»™å¤§å®¶çœ‹ä¸€æ£µæ ‘ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24260d12b65d4f9687b57d0339391bfc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501310&amp;x-signature=hce8oUFHzamY7Hj64dYnjMuuoSQ%3D" alt="" loading="lazy"/></p>
<p><strong>ä½ ç®¡è¿™ç©æ„å„¿å«æ ‘ï¼Ÿï¼Ÿï¼Ÿ</strong></p>
<p>æ²¡é”™ï¼Œè¿™ç©æ„å„¿è¿˜çœŸå«æ ‘ï¼Œåªä¸è¿‡è¿™æ£µæ ‘å·²ç»é€€åŒ–ä¸ºä¸€ä¸ªé“¾è¡¨äº†ï¼Œæˆ‘ä»¬ç®¡å®ƒå« <strong>æ–œæ ‘</strong>ã€‚</p>
<p><strong>å¦‚æœè¿™æ ·ï¼Œé‚£æˆ‘ä¸ºå•¥ä¸ç›´æ¥ç”¨é“¾è¡¨å‘¢?</strong></p>
<p>è°è¯´ä¸æ˜¯å‘¢ï¼Ÿ</p>
<p>äºŒå‰æ ‘ç›¸æ¯”äºé“¾è¡¨ï¼Œç”±äºçˆ¶å­èŠ‚ç‚¹ä»¥åŠå…„å¼ŸèŠ‚ç‚¹ä¹‹é—´å¾€å¾€å…·æœ‰æŸç§ç‰¹æ®Šçš„å…³ç³»ï¼Œè¿™ç§å…³ç³»ä½¿å¾—æˆ‘ä»¬åœ¨æ ‘ä¸­å¯¹æ•°æ®è¿›è¡Œ<strong>æœç´¢</strong>å’Œ<strong>ä¿®æ”¹</strong>æ—¶ï¼Œç›¸å¯¹äºé“¾è¡¨æ›´åŠ å¿«æ·ä¾¿åˆ©ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœäºŒå‰æ ‘é€€åŒ–ä¸ºä¸€ä¸ªé“¾è¡¨äº†ï¼Œé‚£ä¹ˆé‚£ä¹ˆæ ‘æ‰€å…·æœ‰çš„ä¼˜ç§€æ€§è´¨å°±éš¾ä»¥è¡¨ç°å‡ºæ¥ï¼Œæ•ˆç‡ä¹Ÿä¼šå¤§æ‰“æŠ˜ï¼Œä¸ºäº†é¿å…è¿™æ ·çš„æƒ…å†µï¼Œæˆ‘ä»¬å¸Œæœ›æ¯ä¸ªåš â€œå®¶é•¿â€ï¼ˆçˆ¶ç»“ç‚¹ï¼‰ çš„ï¼Œéƒ½ <strong>ä¸€ç¢—æ°´ç«¯å¹³</strong>ï¼Œåˆ†ç»™å·¦å„¿å­å’Œåˆ†ç»™å³å„¿å­çš„å°½å¯èƒ½ä¸€æ ·å¤šï¼Œç›¸å·®æœ€å¤šä¸è¶…è¿‡ä¸€å±‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c9eacfe3fc54d9289eaf865dcc61928~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2V2ZW5Db2Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765501310&amp;x-signature=j2EJQowWH3fF%2FaNVFY%2FAlOTB1Ng%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-18">åŸºæœ¬æ“ä½œ</h4>
<ul>
<li>
<p>æŸ¥æ‰¾å…ƒç´ </p>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ï¼šO(log n)</li>
<li>æ–¹æ³•ï¼šä¸æ™®é€šäºŒå‰æœç´¢æ ‘ç›¸åŒ</li>
</ul>
</li>
<li>
<p>æ’å…¥å…ƒç´ </p>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ï¼šO(log n)</li>
<li>æ­¥éª¤ï¼š
<ol>
<li>æ‰§è¡Œæ ‡å‡†äºŒå‰æœç´¢æ ‘æ’å…¥</li>
<li>æ›´æ–°å—å½±å“èŠ‚ç‚¹çš„é«˜åº¦</li>
<li>è®¡ç®—å¹³è¡¡å› å­</li>
<li>å¦‚å¤±è¡¡ï¼Œæ‰§è¡Œæ—‹è½¬æ“ä½œæ¢å¤å¹³è¡¡</li>
</ol>
</li>
</ul>
</li>
<li>
<p>åˆ é™¤å…ƒç´ </p>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ï¼šO(log n)</li>
<li>æ­¥éª¤ï¼š
<ol>
<li>æ‰§è¡Œæ ‡å‡†äºŒå‰æœç´¢æ ‘åˆ é™¤</li>
<li>æ›´æ–°å—å½±å“èŠ‚ç‚¹çš„é«˜åº¦</li>
<li>è®¡ç®—å¹³è¡¡å› å­</li>
<li>å¦‚å¤±è¡¡ï¼Œæ‰§è¡Œæ—‹è½¬æ“ä½œæ¢å¤å¹³è¡¡</li>
</ol>
</li>
</ul>
</li>
<li>
<p>æ—‹è½¬æ“ä½œ</p>
<ul>
<li>å·¦æ—‹ï¼ˆLLï¼‰ï¼šé’ˆå¯¹å³å­æ ‘é«˜äºå·¦å­æ ‘è¿‡å¤š</li>
<li>å³æ—‹ï¼ˆRRï¼‰ï¼šé’ˆå¯¹å·¦å­æ ‘é«˜äºå³å­æ ‘è¿‡å¤š</li>
<li>å·¦å³æ—‹ï¼ˆLRï¼‰ï¼šå…ˆå¯¹å·¦å­æ ‘è¿›è¡Œå·¦æ—‹ï¼Œå†å¯¹èŠ‚ç‚¹è¿›è¡Œå³æ—‹</li>
<li>å³å·¦æ—‹ï¼ˆRLï¼‰ï¼šå…ˆå¯¹å³å­æ ‘è¿›è¡Œå³æ—‹ï¼Œå†å¯¹èŠ‚ç‚¹è¿›è¡Œå·¦æ—‹</li>
</ul>
</li>
</ul>
<h4 data-id="heading-19">åŸºç¡€å®ç°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * AVLæ ‘çš„Javaå®ç°
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AVLTree</span> {
    <span class="hljs-comment">// æ ‘èŠ‚ç‚¹å®šä¹‰</span>
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> {
        <span class="hljs-type">int</span> key;        <span class="hljs-comment">// èŠ‚ç‚¹å€¼</span>
        Node left;      <span class="hljs-comment">// å·¦å­èŠ‚ç‚¹</span>
        Node right;     <span class="hljs-comment">// å³å­èŠ‚ç‚¹</span>
        <span class="hljs-type">int</span> height;     <span class="hljs-comment">// èŠ‚ç‚¹é«˜åº¦</span>
        
        Node(<span class="hljs-type">int</span> key) {
            <span class="hljs-built_in">this</span>.key = key;
            <span class="hljs-built_in">this</span>.height = <span class="hljs-number">1</span>; <span class="hljs-comment">// æ–°èŠ‚ç‚¹é«˜åº¦åˆå§‹ä¸º1</span>
        }
    }
    
    Node root; <span class="hljs-comment">// æ ¹èŠ‚ç‚¹</span>
    
    <span class="hljs-comment">// è·å–èŠ‚ç‚¹é«˜åº¦ï¼Œç©ºèŠ‚ç‚¹é«˜åº¦ä¸º0</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">height</span><span class="hljs-params">(Node node)</span> {
        <span class="hljs-keyword">if</span> (node == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        }
        <span class="hljs-keyword">return</span> node.height;
    }
    
    <span class="hljs-comment">// è·å–èŠ‚ç‚¹çš„å¹³è¡¡å› å­</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getBalanceFactor</span><span class="hljs-params">(Node node)</span> {
        <span class="hljs-keyword">if</span> (node == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        }
        <span class="hljs-keyword">return</span> height(node.left) - height(node.right);
    }
    
    <span class="hljs-comment">// æ›´æ–°èŠ‚ç‚¹é«˜åº¦</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateHeight</span><span class="hljs-params">(Node node)</span> {
        <span class="hljs-keyword">if</span> (node == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span>;
        }
        node.height = Math.max(height(node.left), height(node.right)) + <span class="hljs-number">1</span>;
    }
    
    <span class="hljs-comment">// å³æ—‹è½¬ï¼ˆå¤„ç†å·¦å·¦æƒ…å†µï¼‰</span>
    <span class="hljs-keyword">private</span> Node <span class="hljs-title function_">rotateRight</span><span class="hljs-params">(Node y)</span> {
        <span class="hljs-type">Node</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> y.left;
        <span class="hljs-type">Node</span> <span class="hljs-variable">T2</span> <span class="hljs-operator">=</span> x.right;
        
        <span class="hljs-comment">// æ‰§è¡Œæ—‹è½¬</span>
        x.right = y;
        y.left = T2;
        
        <span class="hljs-comment">// æ›´æ–°é«˜åº¦</span>
        updateHeight(y);
        updateHeight(x);
        
        <span class="hljs-keyword">return</span> x; <span class="hljs-comment">// è¿”å›æ–°çš„æ ¹èŠ‚ç‚¹</span>
    }
    
    <span class="hljs-comment">// å·¦æ—‹è½¬ï¼ˆå¤„ç†å³å³æƒ…å†µï¼‰</span>
    <span class="hljs-keyword">private</span> Node <span class="hljs-title function_">rotateLeft</span><span class="hljs-params">(Node x)</span> {
        <span class="hljs-type">Node</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> x.right;
        <span class="hljs-type">Node</span> <span class="hljs-variable">T2</span> <span class="hljs-operator">=</span> y.left;
        
        <span class="hljs-comment">// æ‰§è¡Œæ—‹è½¬</span>
        y.left = x;
        x.right = T2;
        
        <span class="hljs-comment">// æ›´æ–°é«˜åº¦</span>
        updateHeight(x);
        updateHeight(y);
        
        <span class="hljs-keyword">return</span> y; <span class="hljs-comment">// è¿”å›æ–°çš„æ ¹èŠ‚ç‚¹</span>
    }
    
    <span class="hljs-comment">// æ’å…¥èŠ‚ç‚¹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-type">int</span> key)</span> {
        root = insertNode(root, key);
    }
    
    <span class="hljs-keyword">private</span> Node <span class="hljs-title function_">insertNode</span><span class="hljs-params">(Node node, <span class="hljs-type">int</span> key)</span> {
        <span class="hljs-comment">// 1. æ‰§è¡Œæ ‡å‡†BSTæ’å…¥</span>
        <span class="hljs-keyword">if</span> (node == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(key);
        }
        
        <span class="hljs-keyword">if</span> (key &lt; node.key) {
            node.left = insertNode(node.left, key);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key &gt; node.key) {
            node.right = insertNode(node.right, key);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// ç›¸åŒé”®å€¼ä¸åšå¤„ç†ï¼Œæˆ–æ ¹æ®éœ€æ±‚æ›´æ–°èŠ‚ç‚¹</span>
            <span class="hljs-keyword">return</span> node;
        }
        
        <span class="hljs-comment">// 2. æ›´æ–°èŠ‚ç‚¹é«˜åº¦</span>
        updateHeight(node);
        
        <span class="hljs-comment">// 3. è·å–å¹³è¡¡å› å­</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">balance</span> <span class="hljs-operator">=</span> getBalanceFactor(node);
        
        <span class="hljs-comment">// 4. å¦‚æœèŠ‚ç‚¹å¤±è¡¡ï¼Œè¿›è¡Œæ—‹è½¬è°ƒæ•´</span>
        
        <span class="hljs-comment">// å·¦å·¦æƒ…å†µ - å³æ—‹</span>
        <span class="hljs-keyword">if</span> (balance &gt; <span class="hljs-number">1</span> &amp;&amp; getBalanceFactor(node.left) &gt;= <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> rotateRight(node);
        }
        
        <span class="hljs-comment">// å³å³æƒ…å†µ - å·¦æ—‹</span>
        <span class="hljs-keyword">if</span> (balance &lt; -<span class="hljs-number">1</span> &amp;&amp; getBalanceFactor(node.right) &lt;= <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> rotateLeft(node);
        }
        
        <span class="hljs-comment">// å·¦å³æƒ…å†µ - å·¦å³åŒæ—‹</span>
        <span class="hljs-keyword">if</span> (balance &gt; <span class="hljs-number">1</span> &amp;&amp; getBalanceFactor(node.left) &lt; <span class="hljs-number">0</span>) {
            node.left = rotateLeft(node.left);
            <span class="hljs-keyword">return</span> rotateRight(node);
        }
        
        <span class="hljs-comment">// å³å·¦æƒ…å†µ - å³å·¦åŒæ—‹</span>
        <span class="hljs-keyword">if</span> (balance &lt; -<span class="hljs-number">1</span> &amp;&amp; getBalanceFactor(node.right) &gt; <span class="hljs-number">0</span>) {
            node.right = rotateRight(node.right);
            <span class="hljs-keyword">return</span> rotateLeft(node);
        }
        
        <span class="hljs-comment">// è¿”å›æœªå˜åŒ–çš„èŠ‚ç‚¹å¼•ç”¨</span>
        <span class="hljs-keyword">return</span> node;
    }
    
    <span class="hljs-comment">// æŸ¥æ‰¾æœ€å°å€¼èŠ‚ç‚¹</span>
    <span class="hljs-keyword">private</span> Node <span class="hljs-title function_">findMinNode</span><span class="hljs-params">(Node node)</span> {
        <span class="hljs-type">Node</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> node;
        <span class="hljs-keyword">while</span> (current.left != <span class="hljs-literal">null</span>) {
            current = current.left;
        }
        <span class="hljs-keyword">return</span> current;
    }
    
    <span class="hljs-comment">// åˆ é™¤èŠ‚ç‚¹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(<span class="hljs-type">int</span> key)</span> {
        root = deleteNode(root, key);
    }
    
    <span class="hljs-keyword">private</span> Node <span class="hljs-title function_">deleteNode</span><span class="hljs-params">(Node root, <span class="hljs-type">int</span> key)</span> {
        <span class="hljs-comment">// 1. æ‰§è¡Œæ ‡å‡†BSTåˆ é™¤</span>
        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> root;
        }
        
        <span class="hljs-keyword">if</span> (key &lt; root.key) {
            root.left = deleteNode(root.left, key);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key &gt; root.key) {
            root.right = deleteNode(root.right, key);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// æ‰¾åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹</span>
            
            <span class="hljs-comment">// æƒ…å†µ1ï¼šå¶å­èŠ‚ç‚¹æˆ–åªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹</span>
            <span class="hljs-keyword">if</span> (root.left == <span class="hljs-literal">null</span> || root.right == <span class="hljs-literal">null</span>) {
                <span class="hljs-type">Node</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> (root.left != <span class="hljs-literal">null</span>) ? root.left : root.right;
                
                <span class="hljs-comment">// æ²¡æœ‰å­èŠ‚ç‚¹</span>
                <span class="hljs-keyword">if</span> (temp == <span class="hljs-literal">null</span>) {
                    root = <span class="hljs-literal">null</span>;
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-comment">// ä¸€ä¸ªå­èŠ‚ç‚¹</span>
                    root = temp;
                }
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// æƒ…å†µ2ï¼šæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹</span>
                <span class="hljs-comment">// æ‰¾åˆ°å³å­æ ‘çš„æœ€å°èŠ‚ç‚¹ï¼ˆä¸­åºåç»§ï¼‰</span>
                <span class="hljs-type">Node</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> findMinNode(root.right);
                
                <span class="hljs-comment">// å¤åˆ¶ä¸­åºåç»§çš„å€¼åˆ°å½“å‰èŠ‚ç‚¹</span>
                root.key = temp.key;
                
                <span class="hljs-comment">// åˆ é™¤ä¸­åºåç»§</span>
                root.right = deleteNode(root.right, temp.key);
            }
        }
        
        <span class="hljs-comment">// å¦‚æœæ ‘åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ é™¤åç›´æ¥è¿”å›</span>
        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> root;
        }
        
        <span class="hljs-comment">// 2. æ›´æ–°é«˜åº¦</span>
        updateHeight(root);
        
        <span class="hljs-comment">// 3. è·å–å¹³è¡¡å› å­</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">balance</span> <span class="hljs-operator">=</span> getBalanceFactor(root);
        
        <span class="hljs-comment">// 4. è¿›è¡Œæ—‹è½¬æ“ä½œä¿æŒå¹³è¡¡</span>
        
        <span class="hljs-comment">// å·¦å·¦æƒ…å†µ</span>
        <span class="hljs-keyword">if</span> (balance &gt; <span class="hljs-number">1</span> &amp;&amp; getBalanceFactor(root.left) &gt;= <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> rotateRight(root);
        }
        
        <span class="hljs-comment">// å·¦å³æƒ…å†µ</span>
        <span class="hljs-keyword">if</span> (balance &gt; <span class="hljs-number">1</span> &amp;&amp; getBalanceFactor(root.left) &lt; <span class="hljs-number">0</span>) {
            root.left = rotateLeft(root.left);
            <span class="hljs-keyword">return</span> rotateRight(root);
        }
        
        <span class="hljs-comment">// å³å³æƒ…å†µ</span>
        <span class="hljs-keyword">if</span> (balance &lt; -<span class="hljs-number">1</span> &amp;&amp; getBalanceFactor(root.right) &lt;= <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> rotateLeft(root);
        }
        
        <span class="hljs-comment">// å³å·¦æƒ…å†µ</span>
        <span class="hljs-keyword">if</span> (balance &lt; -<span class="hljs-number">1</span> &amp;&amp; getBalanceFactor(root.right) &gt; <span class="hljs-number">0</span>) {
            root.right = rotateRight(root.right);
            <span class="hljs-keyword">return</span> rotateLeft(root);
        }
        
        <span class="hljs-keyword">return</span> root;
    }
    
    <span class="hljs-comment">// æŸ¥æ‰¾èŠ‚ç‚¹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">search</span><span class="hljs-params">(<span class="hljs-type">int</span> key)</span> {
        <span class="hljs-keyword">return</span> searchNode(root, key);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">searchNode</span><span class="hljs-params">(Node root, <span class="hljs-type">int</span> key)</span> {
        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        
        <span class="hljs-keyword">if</span> (key == root.key) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        
        <span class="hljs-keyword">if</span> (key &lt; root.key) {
            <span class="hljs-keyword">return</span> searchNode(root.left, key);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> searchNode(root.right, key);
        }
    }
}
</code></pre>
<h4 data-id="heading-20">ä¼˜ç‚¹</h4>
<ol>
<li>æŸ¥æ‰¾æ•ˆç‡é«˜ï¼šä¿è¯O(log n)çš„æŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤æ“ä½œæ—¶é—´å¤æ‚åº¦</li>
<li>è‡ªå¹³è¡¡ï¼šè‡ªåŠ¨è°ƒæ•´æ ‘çš„ç»“æ„ï¼Œé˜²æ­¢æœ€åæƒ…å†µå‡ºç°</li>
<li>ç¨³å®šæ€§ï¼šæ‰€æœ‰æ“ä½œéƒ½æœ‰ç¨³å®šçš„æ€§èƒ½è¡¨ç°</li>
<li>å¯é¢„æµ‹æ€§ï¼šæ ‘é«˜è¢«ä¸¥æ ¼é™åˆ¶ï¼Œä¾¿äºåˆ†ææ€§èƒ½</li>
</ol>
<h4 data-id="heading-21">ç¼ºç‚¹</h4>
<ol>
<li>å®ç°å¤æ‚ï¼šç›¸æ¯”æ™®é€šäºŒå‰æœç´¢æ ‘ï¼Œå®ç°å¤æ‚åº¦é«˜</li>
<li>é¢å¤–ç©ºé—´ï¼šæ¯ä¸ªèŠ‚ç‚¹éœ€è¦å­˜å‚¨é«˜åº¦ä¿¡æ¯</li>
<li>æ—‹è½¬å¼€é”€ï¼šæ’å…¥åˆ é™¤è¿‡ç¨‹ä¸­çš„æ—‹è½¬æ“ä½œå¢åŠ äº†é¢å¤–è®¡ç®—å¼€é”€</li>
<li>é¢‘ç¹å¹³è¡¡è°ƒæ•´ï¼šå¯¹äºé«˜é¢‘æ’å…¥åˆ é™¤çš„åœºæ™¯ï¼Œé¢‘ç¹çš„å¹³è¡¡è°ƒæ•´å¯èƒ½å½±å“æ€§èƒ½</li>
</ol>
<h4 data-id="heading-22">åº”ç”¨åœºæ™¯</h4>
<p>AVLæ ‘æ˜¯æœ€æ—©è¢«å‘æ˜çš„è‡ªå¹³è¡¡äºŒå‰æœç´¢æ ‘ä¹‹ä¸€ï¼Œé€‚ç”¨äºè®¸å¤šéœ€è¦é«˜æ•ˆæŸ¥æ‰¾å’Œç»´æŒæ•°æ®æœ‰åºæ€§çš„åœºæ™¯ã€‚</p>
<p>æ¯”å¦‚å†…å­˜ç®¡ç†å™¨ç»å¸¸ä½¿ç”¨AVLæ ‘è·Ÿè¸ªå†…å­˜å—çš„åˆ†é…ä¸é‡Šæ”¾ã€‚</p>
<p>åœ¨éœ€è¦é¢‘ç¹æ‰§è¡ŒèŒƒå›´æŸ¥è¯¢çš„åº”ç”¨ä¸­ï¼ŒAVLæ ‘ä¹Ÿæ¯”è¾ƒé€‚ç”¨ï¼Œå¸¸ç”¨äºå®ç°åŒºé—´æŸ¥è¯¢åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-23">ç›¸å…³çš„ LeetCode çƒ­é—¨é¢˜ç›®</h4>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.com%2Fproblems%2Fvalidate-binary-search-tree%2F" target="_blank" title="https://leetcode.com/problems/validate-binary-search-tree/" ref="nofollow noopener noreferrer">98. éªŒè¯äºŒå‰æœç´¢æ ‘</a>Â - è¦æ±‚éªŒè¯ä¸€ä¸ªç»™å®šçš„äºŒå‰æ ‘æ˜¯å¦æ˜¯æœ‰æ•ˆçš„äºŒå‰æœç´¢æ ‘ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.com%2Fproblems%2Fsearch-in-a-binary-search-tree%2F" target="_blank" title="https://leetcode.com/problems/search-in-a-binary-search-tree/" ref="nofollow noopener noreferrer">700. äºŒå‰æœç´¢æ ‘ä¸­çš„æœç´¢</a>Â - åœ¨äºŒå‰æœç´¢æ ‘ä¸­æŸ¥æ‰¾æŒ‡å®šå€¼çš„èŠ‚ç‚¹ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.com%2Fproblems%2Finsert-into-a-binary-search-tree%2F" target="_blank" title="https://leetcode.com/problems/insert-into-a-binary-search-tree/" ref="nofollow noopener noreferrer">701. äºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œ</a>Â - åœ¨ä¸ç ´åäºŒå‰æœç´¢æ ‘æ€§è´¨çš„å‰æä¸‹æ’å…¥æ–°èŠ‚ç‚¹ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.com%2Fproblems%2Fdelete-node-in-a-bst%2F" target="_blank" title="https://leetcode.com/problems/delete-node-in-a-bst/" ref="nofollow noopener noreferrer">450. åˆ é™¤äºŒå‰æœç´¢æ ‘ä¸­çš„èŠ‚ç‚¹</a>Â - å®ç°äºŒå‰æœç´¢æ ‘çš„åˆ é™¤æ“ä½œã€‚</li>
</ol>
<h2 data-id="heading-24">æ‰©å±•ï¼šå…¶å®ƒæ ‘å½¢ç»“æ„</h2>
<h3 data-id="heading-25">äºŒå‰å †</h3>
<p>äºŒå‰å †æ˜¯ä¸€ç§ç‰¹æ®Šçš„å®Œå…¨äºŒå‰æ ‘ï¼Œå¸¸ç”¨äºå®ç°ä¼˜å…ˆé˜Ÿåˆ—ã€‚æœ€å°å †çš„æ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å°äºæˆ–ç­‰äºå…¶å­èŠ‚ç‚¹çš„å€¼ï¼Œæœ€å¤§å †çš„æ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å¤§äºæˆ–ç­‰äºå…¶å­èŠ‚ç‚¹çš„å€¼ã€‚äºŒå‰å †æ”¯æŒé«˜æ•ˆçš„æ’å…¥ã€åˆ é™¤æœ€å€¼å’Œæ„å»ºæ“ä½œã€‚</p>
<p>äºŒå‰å †æ˜¯ä¸€ç§ç‰¹æ®Šçš„å®Œå…¨äºŒå‰æ ‘æ•°æ®ç»“æ„ï¼Œå®ƒæ»¡è¶³å †å±æ€§ã€‚å®Œå…¨äºŒå‰æ ‘æ˜¯æŒ‡é™¤äº†æœ€åä¸€å±‚å¤–ï¼Œå…¶ä»–å±‚çš„èŠ‚ç‚¹éƒ½æ˜¯æ»¡çš„ï¼Œè€Œæœ€åä¸€å±‚çš„èŠ‚ç‚¹éƒ½é å·¦æ’åˆ—ã€‚äºŒå‰å †ä¸»è¦æœ‰ä¸¤ç§ç±»å‹ï¼š</p>
<ul>
<li>æœ€å¤§å †ï¼šæ¯ä¸ªçˆ¶èŠ‚ç‚¹çš„å€¼éƒ½å¤§äºæˆ–ç­‰äºå…¶å­èŠ‚ç‚¹çš„å€¼</li>
<li>æœ€å°å †ï¼šæ¯ä¸ªçˆ¶èŠ‚ç‚¹çš„å€¼éƒ½å°äºæˆ–ç­‰äºå…¶å­èŠ‚ç‚¹çš„å€¼</li>
</ul>
<p>äºŒå‰å †çš„è¿™ç§ç‰¹æ®Šç»“æ„ä½¿å¾—å®ƒå¯ä»¥é«˜æ•ˆåœ°æ‰¾åˆ°æœ€å¤§å€¼æˆ–æœ€å°å€¼ï¼Œæ‰€ä»¥ä¹Ÿå¸¸è¢«ç”¨æ¥å®ç°ä¼˜å…ˆé˜Ÿåˆ—ã€‚</p>
<p>äºŒå‰å †çš„æ ¸å¿ƒç‰¹æ€§å¦‚ä¸‹ï¼š</p>
<ol>
<li>å®Œå…¨äºŒå‰æ ‘ç»“æ„ï¼šé™¤æœ€åº•å±‚å¤–ï¼Œæ¯å±‚éƒ½å¡«æ»¡ï¼Œä¸”æœ€åº•å±‚ä»å·¦åˆ°å³å¡«å……</li>
<li>å †åºæ€§è´¨ï¼š
<ul>
<li>æœ€å¤§å †ï¼šçˆ¶èŠ‚ç‚¹å€¼ â‰¥ å­èŠ‚ç‚¹å€¼</li>
<li>æœ€å°å †ï¼šçˆ¶èŠ‚ç‚¹å€¼ â‰¤ å­èŠ‚ç‚¹å€¼</li>
</ul>
</li>
<li>é«˜æ•ˆçš„é¡¶éƒ¨å…ƒç´ è®¿é—®ï¼šå¯ä»¥åœ¨O(1)æ—¶é—´å†…è·å–æœ€å¤§/æœ€å°å…ƒç´ </li>
<li>æ•°ç»„è¡¨ç¤ºï¼šè™½ç„¶æ¦‚å¿µä¸Šæ˜¯æ ‘ç»“æ„ï¼Œä½†é€šå¸¸ç”¨æ•°ç»„å®ç°ï¼Œè¿™æ ·å¯ä»¥èŠ‚çœæŒ‡é’ˆå¼€é”€å¹¶æé«˜å†…å­˜å±€éƒ¨æ€§</li>
</ol>
<h4 data-id="heading-26">åŸºæœ¬æ“ä½œ</h4>
<ul>
<li>
<p>æ’å…¥å…ƒç´ ï¼ˆInsertï¼‰</p>
<ul>
<li>é¦–å…ˆå°†æ–°å…ƒç´ æ·»åŠ åˆ°å †çš„æœ«å°¾</li>
<li>ç„¶åé€šè¿‡"ä¸Šæµ®"æ“ä½œè°ƒæ•´å †ï¼Œç›´åˆ°æ»¡è¶³å †æ€§è´¨</li>
</ul>
</li>
<li>
<p>åˆ é™¤é¡¶éƒ¨å…ƒç´ ï¼ˆExtract-Max/Minï¼‰ï¼šç§»é™¤å¹¶è¿”å›å †é¡¶å…ƒç´ ï¼ˆæœ€å¤§/æœ€å°å€¼ï¼‰</p>
<ul>
<li>å–å‡ºå †é¡¶å…ƒç´ </li>
<li>å°†å †çš„æœ€åä¸€ä¸ªå…ƒç´ ç§»åˆ°å †é¡¶</li>
<li>é€šè¿‡"ä¸‹æ²‰"æ“ä½œè°ƒæ•´å †ï¼Œç›´åˆ°æ»¡è¶³å †æ€§è´¨</li>
</ul>
</li>
<li>
<p>ä¸Šæµ®ï¼ˆHeapify-Upï¼‰ï¼šå°†ä¸€ä¸ªå…ƒç´ å‘ä¸Šç§»åŠ¨åˆ°åˆé€‚ä½ç½®çš„è¿‡ç¨‹</p>
<ul>
<li>æ¯”è¾ƒå½“å‰å…ƒç´ ä¸å…¶çˆ¶èŠ‚ç‚¹</li>
<li>å¦‚æœä¸æ»¡è¶³å †æ€§è´¨ï¼Œåˆ™äº¤æ¢å®ƒä»¬</li>
<li>é‡å¤æ­¤è¿‡ç¨‹ç›´åˆ°æ»¡è¶³å †æ€§è´¨</li>
</ul>
</li>
<li>
<p>ä¸‹æ²‰ï¼ˆHeapify-Downï¼‰ï¼šå°†ä¸€ä¸ªå…ƒç´ å‘ä¸‹ç§»åŠ¨åˆ°åˆé€‚ä½ç½®çš„è¿‡ç¨‹</p>
<ul>
<li>æ¯”è¾ƒå½“å‰å…ƒç´ ä¸å…¶æœ€å¤§ï¼ˆæˆ–æœ€å°ï¼‰çš„å­èŠ‚ç‚¹</li>
<li>å¦‚æœä¸æ»¡è¶³å †æ€§è´¨ï¼Œåˆ™äº¤æ¢å®ƒä»¬</li>
<li>é‡å¤æ­¤è¿‡ç¨‹ç›´åˆ°æ»¡è¶³å †æ€§è´¨</li>
</ul>
</li>
</ul>
<h4 data-id="heading-27">åŸºç¡€å®ç°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MinHeap</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span>[] heap;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> size;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> capacity;

    <span class="hljs-comment">// æ„é€ å‡½æ•°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MinHeap</span><span class="hljs-params">(<span class="hljs-type">int</span> capacity)</span> {
        <span class="hljs-built_in">this</span>.capacity = capacity;
        <span class="hljs-built_in">this</span>.size = <span class="hljs-number">0</span>;
        <span class="hljs-built_in">this</span>.heap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[capacity];
    }

    <span class="hljs-comment">// è·å–çˆ¶èŠ‚ç‚¹ç´¢å¼•</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">parent</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span> {
        <span class="hljs-keyword">return</span> (i - <span class="hljs-number">1</span>) / <span class="hljs-number">2</span>;
    }

    <span class="hljs-comment">// è·å–å·¦å­èŠ‚ç‚¹ç´¢å¼•</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">leftChild</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * i + <span class="hljs-number">1</span>;
    }

    <span class="hljs-comment">// è·å–å³å­èŠ‚ç‚¹ç´¢å¼•</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">rightChild</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * i + <span class="hljs-number">2</span>;
    }

    <span class="hljs-comment">// äº¤æ¢ä¸¤ä¸ªèŠ‚ç‚¹</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">swap</span><span class="hljs-params">(<span class="hljs-type">int</span> i, <span class="hljs-type">int</span> j)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> heap[i];
        heap[i] = heap[j];
        heap[j] = temp;
    }

    <span class="hljs-comment">// æ’å…¥å…ƒç´ </span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-type">int</span> key)</span> {
        <span class="hljs-keyword">if</span> (size == capacity) {
            System.out.println(<span class="hljs-string">"å †å·²æ»¡ï¼Œæ— æ³•æ’å…¥"</span>);
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-comment">// å…ˆå°†æ–°å…ƒç´ æ’å…¥åˆ°å †çš„æœ«å°¾</span>
        heap[size] = key;
        <span class="hljs-type">int</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> size;
        size++;

        <span class="hljs-comment">// ä¸Šæµ®æ“ä½œï¼šå°†å…ƒç´ å‘ä¸Šç§»åŠ¨åˆ°åˆé€‚ä½ç½®</span>
        <span class="hljs-keyword">while</span> (current &gt; <span class="hljs-number">0</span> &amp;&amp; heap[current] &lt; heap[parent(current)]) {
            swap(current, parent(current));
            current = parent(current);
        }
    }

    <span class="hljs-comment">// è·å–æœ€å°å…ƒç´ ï¼ˆä¸åˆ é™¤ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">peek</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (size &lt;= <span class="hljs-number">0</span>) {
            System.out.println(<span class="hljs-string">"å †ä¸ºç©º"</span>);
            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
        }
        <span class="hljs-keyword">return</span> heap[<span class="hljs-number">0</span>];
    }

    <span class="hljs-comment">// åˆ é™¤å¹¶è¿”å›æœ€å°å…ƒç´ </span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">extractMin</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (size &lt;= <span class="hljs-number">0</span>) {
            System.out.println(<span class="hljs-string">"å †ä¸ºç©º"</span>);
            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;
        }
        <span class="hljs-keyword">if</span> (size == <span class="hljs-number">1</span>) {
            size--;
            <span class="hljs-keyword">return</span> heap[<span class="hljs-number">0</span>];
        }

        <span class="hljs-comment">// å­˜å‚¨æ ¹èŠ‚ç‚¹ï¼ˆæœ€å°å€¼ï¼‰</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">root</span> <span class="hljs-operator">=</span> heap[<span class="hljs-number">0</span>];
        
        <span class="hljs-comment">// å°†æœ€åä¸€ä¸ªå…ƒç´ æ”¾åˆ°æ ¹ä½ç½®</span>
        heap[<span class="hljs-number">0</span>] = heap[size - <span class="hljs-number">1</span>];
        size--;
        
        <span class="hljs-comment">// ä¸‹æ²‰æ“ä½œï¼šå°†æ ¹å…ƒç´ å‘ä¸‹ç§»åŠ¨åˆ°åˆé€‚ä½ç½®</span>
        heapifyDown(<span class="hljs-number">0</span>);

        <span class="hljs-keyword">return</span> root;
    }

    <span class="hljs-comment">// ä¸‹æ²‰æ“ä½œ</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">heapifyDown</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">smallest</span> <span class="hljs-operator">=</span> i;
        <span class="hljs-type">int</span> <span class="hljs-variable">left</span> <span class="hljs-operator">=</span> leftChild(i);
        <span class="hljs-type">int</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> rightChild(i);

        <span class="hljs-comment">// æ‰¾å‡ºå½“å‰èŠ‚ç‚¹ã€å·¦å­èŠ‚ç‚¹å’Œå³å­èŠ‚ç‚¹ä¸­çš„æœ€å°å€¼</span>
        <span class="hljs-keyword">if</span> (left &lt; size &amp;&amp; heap[left] &lt; heap[smallest]) {
            smallest = left;
        }

        <span class="hljs-keyword">if</span> (right &lt; size &amp;&amp; heap[right] &lt; heap[smallest]) {
            smallest = right;
        }

        <span class="hljs-comment">// å¦‚æœæœ€å°å€¼ä¸æ˜¯å½“å‰èŠ‚ç‚¹ï¼Œåˆ™äº¤æ¢å¹¶ç»§ç»­ä¸‹æ²‰</span>
        <span class="hljs-keyword">if</span> (smallest != i) {
            swap(i, smallest);
            heapifyDown(smallest);
        }
    }

    <span class="hljs-comment">// æ‰“å°å †</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">printHeap</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; size; i++) {
            System.out.print(heap[i] + <span class="hljs-string">" "</span>);
        }
        System.out.println();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">MinHeap</span> <span class="hljs-variable">minHeap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MinHeap</span>(<span class="hljs-number">10</span>);
        
        minHeap.insert(<span class="hljs-number">5</span>);
        minHeap.insert(<span class="hljs-number">3</span>);
        minHeap.insert(<span class="hljs-number">8</span>);
        minHeap.insert(<span class="hljs-number">1</span>);
        minHeap.insert(<span class="hljs-number">10</span>);
        
        System.out.println(<span class="hljs-string">"æ„å»ºçš„å †ï¼š"</span>);
        minHeap.printHeap();
        
        System.out.println(<span class="hljs-string">"æœ€å°å…ƒç´ ï¼š"</span> + minHeap.peek());
        
        System.out.println(<span class="hljs-string">"æå–æœ€å°å…ƒç´ ï¼š"</span> + minHeap.extractMin());
        System.out.println(<span class="hljs-string">"æå–åçš„å †ï¼š"</span>);
        minHeap.printHeap();
    }
}
</code></pre>
<h4 data-id="heading-28">ä¼˜ç‚¹</h4>
<ol>
<li>é«˜æ•ˆçš„ä¼˜å…ˆçº§æ“ä½œï¼šO(1) æ—¶é—´å¤æ‚åº¦æŸ¥æ‰¾æœ€å¤§/æœ€å°å…ƒç´ </li>
<li>ç›¸å¯¹è¾ƒå¿«çš„æ’å…¥å’Œåˆ é™¤ï¼šO(log n) æ—¶é—´å¤æ‚åº¦</li>
<li>ç©ºé—´æ•ˆç‡é«˜ï¼šæ•°ç»„å®ç°ä¸éœ€è¦é¢å¤–çš„æŒ‡é’ˆå¼€é”€</li>
<li>å®ç°ç®€å•ï¼šç›¸æ¯”å…¶ä»–é«˜çº§æ•°æ®ç»“æ„ï¼ŒäºŒå‰å †å®ç°ç›¸å¯¹ç®€å•</li>
<li>å†…å­˜å±€éƒ¨æ€§å¥½ï¼šè¿ç»­å†…å­˜å­˜å‚¨æé«˜ç¼“å­˜å‘½ä¸­ç‡</li>
</ol>
<h4 data-id="heading-29">ç¼ºç‚¹</h4>
<ol>
<li>æœ‰é™çš„æ“ä½œé›†ï¼šåªæ”¯æŒæŸ¥æ‰¾æœ€å€¼ï¼Œä¸æ”¯æŒé«˜æ•ˆçš„æœç´¢ã€åˆ é™¤ä»»æ„å…ƒç´ ç­‰æ“ä½œ</li>
<li>ä¸æ”¯æŒå¿«é€Ÿåˆå¹¶ï¼šåˆå¹¶ä¸¤ä¸ªå †çš„æ“ä½œè¾ƒä¸ºå¤æ‚</li>
<li>ä¸ç¨³å®šæ€§ï¼šç›¸åŒä¼˜å…ˆçº§çš„å…ƒç´ ï¼Œå…¶ç›¸å¯¹é¡ºåºå¯èƒ½æ”¹å˜</li>
<li>å¯¹ç¼“å­˜ä¸å‹å¥½çš„è®¿é—®æ¨¡å¼ï¼šç‰¹åˆ«æ˜¯åœ¨å †è¾ƒå¤§æ—¶ï¼Œçˆ¶å­èŠ‚ç‚¹é—´çš„è·³è·ƒè®¿é—®å¯èƒ½å¯¼è‡´ç¼“å­˜æœªå‘½ä¸­</li>
</ol>
<h4 data-id="heading-30">åº”ç”¨åœºæ™¯</h4>
<p>äºŒå‰å †å¹¿æ³›åº”ç”¨äºå„ç§ç®—æ³•å’Œç³»ç»Ÿä¸­ï¼š</p>
<ol>
<li>ä¼˜å…ˆé˜Ÿåˆ—å®ç°ï¼šå½“éœ€è¦é¢‘ç¹è·å–æœ€å¤§æˆ–æœ€å°å…ƒç´ æ—¶ï¼ŒäºŒå‰å †æ˜¯æœ€å¸¸ç”¨çš„æ•°æ®ç»“æ„ã€‚æ“ä½œç³»ç»Ÿä¸­çš„è¿›ç¨‹è°ƒåº¦ã€ç½‘ç»œè·¯ç”±ç®—æ³•éƒ½ä¼šä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—æ¥ç¡®å®šä¸‹ä¸€ä¸ªå¤„ç†çš„ä»»åŠ¡ã€‚</li>
<li>æ’åºç®—æ³•ï¼šå †æ’åºåˆ©ç”¨äºŒå‰å †çš„ç‰¹æ€§ï¼Œèƒ½å¤Ÿä»¥O(n log n)çš„æ—¶é—´å¤æ‚åº¦å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œä¸”ç©ºé—´å¤æ‚åº¦ä¸ºO(1)ï¼Œé€‚åˆå¤§æ•°æ®æ’åºã€‚</li>
<li>å›¾ç®—æ³•ï¼šè®¸å¤šå›¾ç®—æ³•å¦‚Dijkstraæœ€çŸ­è·¯å¾„ã€Primæœ€å°ç”Ÿæˆæ ‘ç®—æ³•éƒ½ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—æ¥é€‰æ‹©ä¸‹ä¸€ä¸ªå¤„ç†çš„èŠ‚ç‚¹ï¼ŒäºŒå‰å †æ˜¯å…¶é«˜æ•ˆå®ç°ã€‚</li>
<li>ä¸­ä½æ•°å’Œç™¾åˆ†ä½æ•°è®¡ç®—ï¼šé€šè¿‡ç»´æŠ¤ä¸¤ä¸ªå †ï¼ˆæœ€å¤§å †å’Œæœ€å°å †ï¼‰ï¼Œå¯ä»¥é«˜æ•ˆåœ°è·Ÿè¸ªæ•°æ®æµçš„ä¸­ä½æ•°å’Œå…¶ä»–ç»Ÿè®¡å€¼ã€‚</li>
<li>äº‹ä»¶æ¨¡æ‹Ÿï¼šåœ¨ç¦»æ•£äº‹ä»¶æ¨¡æ‹Ÿä¸­ï¼Œäº‹ä»¶æŒ‰æ—¶é—´é¡ºåºå¤„ç†ï¼Œä¼˜å…ˆé˜Ÿåˆ—å¯ä»¥ç¡®ä¿æŒ‰æ­£ç¡®é¡ºåºå¤„ç†äº‹ä»¶ã€‚</li>
<li>æ•°æ®æµå¤„ç†ï¼šåœ¨å¤„ç†å¤§é‡æ•°æ®æµæ—¶ï¼Œå¦‚æœåªéœ€è¦å…³æ³¨"æœ€é‡è¦"çš„kä¸ªå…ƒç´ ï¼Œå¯ä»¥ç»´æŠ¤ä¸€ä¸ªå¤§å°ä¸ºkçš„å †ã€‚</li>
</ol>
<h4 data-id="heading-31">Javaæ ‡å‡†åº“ä¸­çš„å †å®ç°</h4>
<p>Java æä¾›äº† <code>PriorityQueue</code> ç±»ï¼Œå®ƒåŸºäºäºŒå‰å †å®ç°ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.PriorityQueue;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PriorityQueueExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// é»˜è®¤æ˜¯æœ€å°å †</span>
        PriorityQueue&lt;Integer&gt; minHeap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;();
        
        <span class="hljs-comment">// æ·»åŠ å…ƒç´ </span>
        minHeap.add(<span class="hljs-number">5</span>);
        minHeap.add(<span class="hljs-number">3</span>);
        minHeap.add(<span class="hljs-number">8</span>);
        minHeap.add(<span class="hljs-number">1</span>);
        minHeap.add(<span class="hljs-number">10</span>);
        
        System.out.println(<span class="hljs-string">"ä¼˜å…ˆé˜Ÿåˆ—å†…å®¹ï¼š"</span> + minHeap);
        System.out.println(<span class="hljs-string">"æœ€å°å…ƒç´ ï¼š"</span> + minHeap.peek());
        
        System.out.println(<span class="hljs-string">"æå–æœ€å°å…ƒç´ ï¼š"</span> + minHeap.poll());
        System.out.println(<span class="hljs-string">"æå–åçš„ä¼˜å…ˆé˜Ÿåˆ—ï¼š"</span> + minHeap);
        
        <span class="hljs-comment">// åˆ›å»ºæœ€å¤§å †ï¼ˆé€šè¿‡è‡ªå®šä¹‰æ¯”è¾ƒå™¨ï¼‰</span>
        PriorityQueue&lt;Integer&gt; maxHeap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;((a, b) -&gt; b - a);
        
        maxHeap.add(<span class="hljs-number">5</span>);
        maxHeap.add(<span class="hljs-number">3</span>);
        maxHeap.add(<span class="hljs-number">8</span>);
        maxHeap.add(<span class="hljs-number">1</span>);
        maxHeap.add(<span class="hljs-number">10</span>);
        
        System.out.println(<span class="hljs-string">"æœ€å¤§å †å†…å®¹ï¼š"</span> + maxHeap);
        System.out.println(<span class="hljs-string">"æœ€å¤§å…ƒç´ ï¼š"</span> + maxHeap.peek());
    }
}
</code></pre>
<p>è¯¦æƒ…å¯ä»¥çœ‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.seven97.top%2Fjava%2Fcollection%2F02-collection3-priorityqueue.html" target="_blank" title="https://www.seven97.top/java/collection/02-collection3-priorityqueue.html" ref="nofollow noopener noreferrer">PriorityQueue</a></p>
<h4 data-id="heading-32">å †çš„å˜ç§</h4>
<p>é™¤äº†åŸºæœ¬çš„äºŒå‰å †ï¼Œè¿˜æœ‰å‡ ç§é‡è¦çš„å †å˜ç§ï¼š</p>
<ol>
<li>då‰å †ï¼ˆd-ary Heapï¼‰ï¼šæ¯ä¸ªèŠ‚ç‚¹æœ€å¤šæœ‰dä¸ªå­èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯2ä¸ªã€‚å¢åŠ då€¼å¯ä»¥å‡å°‘å †çš„é«˜åº¦ï¼Œåœ¨æŸäº›åº”ç”¨ä¸­å¯ä»¥æé«˜æ€§èƒ½ã€‚</li>
<li>æ–æ³¢é‚£å¥‘å †ï¼ˆFibonacci Heapï¼‰ï¼šä¸€ç§æ›´å¤æ‚çš„å †ç»“æ„ï¼Œæä¾›äº†æ›´é«˜æ•ˆçš„åˆå¹¶æ“ä½œå’Œæ‘Šé”€æ—¶é—´å¤æ‚åº¦ã€‚è®¸å¤šé«˜çº§å›¾ç®—æ³•ä½¿ç”¨æ–æ³¢é‚£å¥‘å †æ¥æé«˜æ€§èƒ½ã€‚</li>
<li>å·¦åæ ‘ï¼ˆLeftist Heapï¼‰ï¼šä¸€ç§æ”¯æŒé«˜æ•ˆåˆå¹¶æ“ä½œçš„å †ï¼Œå¸¸ç”¨äºå¹¶è¡Œè®¡ç®—å’Œåˆ†å¸ƒå¼ç³»ç»Ÿã€‚</li>
<li>é…å¯¹å †ï¼ˆPairing Heapï¼‰ï¼šç»“æ„ç®€å•ä½†æ€§èƒ½ä¼˜å¼‚çš„å †å®ç°ï¼Œç‰¹åˆ«é€‚åˆéœ€è¦é¢‘ç¹åˆå¹¶å’Œå‡å°é”®å€¼çš„åº”ç”¨ã€‚</li>
</ol>
<h4 data-id="heading-33">ç›¸å…³çš„ LeetCode çƒ­é—¨é¢˜ç›®</h4>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fmerge-k-sorted-lists%2F" target="_blank" title="https://leetcode.cn/problems/merge-k-sorted-lists/" ref="nofollow noopener noreferrer">23. åˆå¹¶Kä¸ªæ’åºé“¾è¡¨</a>Â - ä½¿ç”¨æœ€å°å †æ¥é«˜æ•ˆåˆå¹¶å¤šä¸ªæœ‰åºé“¾è¡¨ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Ftop-k-frequent-elements%2F" target="_blank" title="https://leetcode.cn/problems/top-k-frequent-elements/" ref="nofollow noopener noreferrer">347. å‰ K ä¸ªé«˜é¢‘å…ƒç´ </a>Â - ä½¿ç”¨å †æ¥æ‰¾å‡ºæ•°ç»„ä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„Kä¸ªå…ƒç´ ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Ffind-median-from-data-stream%2F" target="_blank" title="https://leetcode.cn/problems/find-median-from-data-stream/" ref="nofollow noopener noreferrer">295. æ•°æ®æµçš„ä¸­ä½æ•°</a>Â - ä½¿ç”¨ä¸€ä¸ªæœ€å¤§å †å’Œä¸€ä¸ªæœ€å°å †æ¥è·Ÿè¸ªæ•°æ®æµçš„ä¸­ä½æ•°ã€‚</li>
</ol>
<h3 data-id="heading-34">Bæ ‘</h3>
<p>Bæ ‘æ˜¯ä¸€ç§è‡ªå¹³è¡¡çš„å¤šè·¯æœç´¢æ ‘ï¼Œå®ƒæ˜¯äºŒå‰æœç´¢æ ‘çš„æ‰©å±•ï¼Œä¸“ä¸ºç£ç›˜æˆ–å…¶ä»–å¤–éƒ¨å­˜å‚¨è®¾å¤‡è®¾è®¡ã€‚Bæ ‘çš„æ¯ä¸ªèŠ‚ç‚¹æ‹¥æœ‰æ›´å¤šçš„å­èŠ‚ç‚¹ï¼Œè¿™ä½¿æ ‘çš„é«˜åº¦æ›´ä½ï¼Œå‡å°‘è®¿é—®ç£ç›˜çš„æ¬¡æ•°ã€‚</p>
<p>Bæ ‘ä¸­çš„å‡ ä¸ªå…³é”®æ¦‚å¿µï¼š</p>
<ul>
<li>é˜¶ï¼ˆOrderï¼‰ï¼šå®šä¹‰äº†ä¸€ä¸ªBæ ‘èŠ‚ç‚¹æœ€å¤šå¯ä»¥æœ‰å¤šå°‘ä¸ªå­èŠ‚ç‚¹ã€‚å…·æœ‰é˜¶ä¸ºmçš„Bæ ‘ä¹Ÿç§°ä¸ºmé˜¶Bæ ‘ã€‚</li>
<li>å†…éƒ¨èŠ‚ç‚¹ï¼ˆInternal Nodeï¼‰ï¼šé™¤æ ¹èŠ‚ç‚¹å’Œå¶èŠ‚ç‚¹å¤–çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚</li>
<li>å¶èŠ‚ç‚¹ï¼ˆLeaf Nodeï¼‰ï¼šæ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚</li>
<li>é”®ï¼ˆKeyï¼‰ï¼šå­˜å‚¨åœ¨èŠ‚ç‚¹ä¸­çš„å€¼ï¼Œç”¨äºæŒ‡å¯¼æœç´¢è¿‡ç¨‹ã€‚</li>
<li>å­èŠ‚ç‚¹ï¼ˆChildï¼‰ï¼šèŠ‚ç‚¹çš„ç›´æ¥åä»£ã€‚</li>
</ul>
<p>ä¸€ä¸ªé˜¶ä¸ºmçš„Bæ ‘æ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼š</p>
<ol>
<li>æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šæœ‰mä¸ªå­èŠ‚ç‚¹</li>
<li>é™¤äº†æ ¹èŠ‚ç‚¹å’Œå¶èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹è‡³å°‘æœ‰âŒˆm/2âŒ‰ä¸ªå­èŠ‚ç‚¹</li>
<li>å¦‚æœæ ¹èŠ‚ç‚¹ä¸æ˜¯å¶èŠ‚ç‚¹ï¼Œåˆ™è‡³å°‘æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹</li>
<li>æ‰€æœ‰å¶èŠ‚ç‚¹éƒ½åœ¨åŒä¸€å±‚</li>
<li>å…·æœ‰kä¸ªå­èŠ‚ç‚¹çš„éå¶èŠ‚ç‚¹åŒ…å«k-1ä¸ªé”®</li>
</ol>
<p>Bæ ‘æ ¸å¿ƒç‰¹æ€§ï¼š</p>
<ol>
<li>è‡ªå¹³è¡¡æ€§ï¼šBæ ‘é€šè¿‡åˆ†è£‚å’Œåˆå¹¶æ“ä½œä¿æŒå¹³è¡¡ï¼Œç¡®ä¿æ‰€æœ‰æ“ä½œçš„å¯¹æ•°æ—¶é—´å¤æ‚åº¦ã€‚</li>
<li>å¤šè·¯åˆ†æ”¯ï¼šæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªå­èŠ‚ç‚¹ï¼Œè€Œä¸ä»…ä»…æ˜¯äºŒå‰æ ‘çš„ä¸¤ä¸ªï¼Œè¿™é™ä½äº†æ ‘çš„é«˜åº¦ã€‚</li>
<li>æœ‰åºç‰¹æ€§ï¼šBæ ‘ä¸­çš„é”®æ˜¯æœ‰åºå­˜å‚¨çš„ï¼Œä½¿å¾—æœç´¢ã€æ’å…¥å’Œåˆ é™¤æ“ä½œé«˜æ•ˆã€‚</li>
<li>é€‚åˆå¤–éƒ¨å­˜å‚¨ï¼šBæ ‘çš„è®¾è®¡æ˜¯ä¸ºäº†æœ€å°åŒ–ç£ç›˜è®¿é—®æ¬¡æ•°ï¼Œç‰¹åˆ«é€‚åˆå¤„ç†å¤§é‡æ•°æ®æ—¶ã€‚</li>
<li>åˆ†å—å­˜å‚¨ï¼šé”®å’ŒæŒ‡é’ˆç»„ç»‡åœ¨å—ä¸­ï¼Œè¿™ç§ç»“æ„ä¸ç£ç›˜é¡µé¢æˆ–æ•°æ®å—çš„ç‰©ç†ç‰¹æ€§åŒ¹é…ã€‚</li>
</ol>
<h4 data-id="heading-35">åŸºæœ¬æ“ä½œ</h4>
<ul>
<li>
<p>æœç´¢æ“ä½œï¼šæœç´¢Bæ ‘ä¸­çš„é”®ä¸æœç´¢äºŒå‰æœç´¢æ ‘ç±»ä¼¼ï¼Œä½†éœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸­éå†å¤šä¸ªé”®</p>
<ul>
<li>ä»æ ¹èŠ‚ç‚¹å¼€å§‹</li>
<li>åœ¨å½“å‰èŠ‚ç‚¹å†…éƒ¨æŒ‰é¡ºåºæŸ¥æ‰¾ç›®æ ‡é”®</li>
<li>å¦‚æœæ‰¾åˆ°ï¼Œè¿”å›ç»“æœ</li>
<li>å¦‚æœæœªæ‰¾åˆ°ä¸”èŠ‚ç‚¹æ˜¯å¶èŠ‚ç‚¹ï¼Œåˆ™é”®ä¸å­˜åœ¨</li>
<li>å¦åˆ™ï¼Œæ ¹æ®é”®çš„å¤§å°é€‰æ‹©åˆé€‚çš„å­æ ‘ç»§ç»­æœç´¢</li>
</ul>
</li>
<li>
<p>æ’å…¥æ“ä½œ</p>
<ul>
<li>æ‰¾åˆ°åˆé€‚çš„å¶èŠ‚ç‚¹ä½ç½®</li>
<li>å°†é”®æ’å…¥åˆ°å¶èŠ‚ç‚¹ä¸­</li>
<li>å¦‚æœæ’å…¥å¯¼è‡´èŠ‚ç‚¹è¶…å‡ºæœ€å¤§å®¹é‡ï¼Œåˆ™åˆ†è£‚èŠ‚ç‚¹ï¼š
<ul>
<li>é€‰æ‹©ä¸­é—´é”®</li>
<li>å°†ä¸­é—´é”®ä¸Šç§»åˆ°çˆ¶èŠ‚ç‚¹</li>
<li>å°†åŸèŠ‚ç‚¹åˆ†ä¸ºä¸¤ä¸ªèŠ‚ç‚¹</li>
<li>å¦‚æœçˆ¶èŠ‚ç‚¹ä¹Ÿè¶…å‡ºå®¹é‡ï¼Œåˆ™ç»§ç»­å‘ä¸Šåˆ†è£‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p>åˆ é™¤æ“ä½œ</p>
<ul>
<li>æ‰¾åˆ°åŒ…å«è¦åˆ é™¤é”®çš„èŠ‚ç‚¹</li>
<li>å¦‚æœèŠ‚ç‚¹æ˜¯å¶èŠ‚ç‚¹ï¼Œç›´æ¥åˆ é™¤</li>
<li>å¦‚æœèŠ‚ç‚¹æ˜¯å†…éƒ¨èŠ‚ç‚¹ï¼Œç”¨å‰é©±æˆ–åç»§æ›¿æ¢è¦åˆ é™¤çš„é”®</li>
<li>å¦‚æœåˆ é™¤å¯¼è‡´èŠ‚ç‚¹é”®æ•°é‡å°‘äºæœ€å°è¦æ±‚ï¼š
<ul>
<li>å°è¯•ä»å…„å¼ŸèŠ‚ç‚¹å€Ÿä¸€ä¸ªé”®</li>
<li>å¦‚æœæ— æ³•å€Ÿç”¨ï¼Œåˆ™åˆå¹¶èŠ‚ç‚¹</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 data-id="heading-36">ä¼˜ç‚¹</h4>
<ol>
<li>å‡å°‘ç£ç›˜è®¿é—®ï¼šBæ ‘çš„é«˜åº¦é€šå¸¸å¾ˆä½ï¼Œå³ä½¿å­˜å‚¨å¤§é‡æ•°æ®ä¹Ÿåªéœ€è¦å°‘é‡ç£ç›˜è®¿é—®ã€‚</li>
<li>é€‚åˆå¤§æ•°æ®é‡ï¼šå› ä¸ºæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥åŒ…å«å¤šä¸ªé”®ï¼ŒBæ ‘å¯ä»¥æœ‰æ•ˆåœ°å­˜å‚¨å’Œæ£€ç´¢å¤§é‡æ•°æ®ã€‚</li>
<li>å¹³è¡¡æ€§ä¿è¯ï¼šBæ ‘å§‹ç»ˆä¿æŒå¹³è¡¡ï¼Œæ²¡æœ‰æœ€åæƒ…å†µæ€§èƒ½ä¸‹é™çš„é—®é¢˜ã€‚</li>
<li>é«˜æ•ˆçš„èŒƒå›´æŸ¥è¯¢ï¼šç”±äºé”®æ˜¯æœ‰åºçš„ï¼ŒBæ ‘æ”¯æŒé«˜æ•ˆçš„èŒƒå›´æŸ¥è¯¢æ“ä½œã€‚</li>
<li>é€‚åˆå¤–éƒ¨å­˜å‚¨ï¼šBæ ‘çš„ç»“æ„éå¸¸é€‚åˆç£ç›˜ç­‰å¤–éƒ¨å­˜å‚¨ç³»ç»Ÿï¼Œä½¿å…¶æˆä¸ºæ•°æ®åº“ç´¢å¼•çš„ç†æƒ³é€‰æ‹©ã€‚</li>
</ol>
<h4 data-id="heading-37">ç¼ºç‚¹</h4>
<ol>
<li>å®ç°å¤æ‚ï¼šä¸äºŒå‰æ ‘ç›¸æ¯”ï¼ŒBæ ‘çš„å®ç°æ›´ä¸ºå¤æ‚ï¼Œç‰¹åˆ«æ˜¯åˆ é™¤æ“ä½œã€‚</li>
<li>ç©ºé—´åˆ©ç”¨ç‡ï¼šBæ ‘èŠ‚ç‚¹å¯èƒ½æœªè¢«å®Œå…¨å¡«å……ï¼Œå¯¼è‡´ä¸€å®šç¨‹åº¦çš„ç©ºé—´æµªè´¹ã€‚</li>
<li>ä¸é€‚åˆå†…å­˜æ“ä½œï¼šå¯¹äºå®Œå…¨åœ¨å†…å­˜ä¸­çš„æ•°æ®ç»“æ„ï¼ŒBæ ‘çš„ä¼˜åŠ¿ä¸æ˜æ˜¾ï¼Œå¯èƒ½æ¯”å…¶ä»–å¹³è¡¡æ ‘ï¼ˆå¦‚çº¢é»‘æ ‘ï¼‰æ•ˆç‡ä½ã€‚</li>
<li>æ›´æ–°å¼€é”€ï¼šæ’å…¥å’Œåˆ é™¤æ“ä½œå¯èƒ½å¯¼è‡´çº§è”çš„èŠ‚ç‚¹åˆ†è£‚æˆ–åˆå¹¶ï¼Œå¢åŠ äº†æ“ä½œçš„å¤æ‚æ€§ã€‚</li>
</ol>
<h4 data-id="heading-38">åº”ç”¨åœºæ™¯</h4>
<p>æ•°æ®åº“ç³»ç»Ÿæ˜¯Bæ ‘æœ€ä¸»è¦çš„åº”ç”¨é¢†åŸŸã€‚å‡ ä¹æ‰€æœ‰ä¸»æµå…³ç³»æ•°æ®åº“éƒ½ä½¿ç”¨Bæ ‘æˆ–å…¶å˜ç§æ¥å®ç°ç´¢å¼•ã€‚æ•°æ®åº“å¼•æ“é€šè¿‡Bæ ‘ç´¢å¼•å¯ä»¥å¿«é€Ÿå®šä½åˆ°æ•°æ®æ‰€åœ¨çš„é¡µé¢ï¼Œæå¤§æå‡æŸ¥è¯¢æ€§èƒ½ã€‚ä¾‹å¦‚ï¼ŒMySQLçš„InnoDBå­˜å‚¨å¼•æ“ä½¿ç”¨B+æ ‘ï¼ˆBæ ‘çš„å˜ç§ï¼‰æ¥æ„å»ºå…¶ç´¢å¼•ç»“æ„ã€‚</p>
<p>æ–‡ä»¶ç³»ç»Ÿä¹Ÿå¹¿æ³›é‡‡ç”¨Bæ ‘æ¥ç»„ç»‡æ–‡ä»¶å’Œç›®å½•ã€‚å¦‚NTFSã€HFS+ç­‰æ–‡ä»¶ç³»ç»Ÿéƒ½ä½¿ç”¨Bæ ‘æˆ–å…¶å˜ç§æ¥ç®¡ç†æ–‡ä»¶åˆ†é…è¡¨å’Œç›®å½•ç»“æ„ï¼Œæœ‰æ•ˆåœ°æ”¯æŒå¤§å‹å­˜å‚¨ç³»ç»Ÿä¸­çš„æ–‡ä»¶æ£€ç´¢ã€‚</p>
<p>æ—¶é—´åºåˆ—æ•°æ®åº“æˆ–åœ°ç†ä¿¡æ¯ç³»ç»Ÿä¸­ï¼Œç»å¸¸éœ€è¦æ£€ç´¢ç‰¹å®šèŒƒå›´å†…çš„æ•°æ®ç‚¹ï¼ŒBæ ‘çš„æœ‰åºç‰¹æ€§ä½¿è¿™ç±»æ“ä½œå˜å¾—é«˜æ•ˆã€‚</p>
<p>é”®å€¼å­˜å‚¨ç³»ç»Ÿå¦‚Redisã€LevelDBç­‰ä¹Ÿå€Ÿé‰´äº†Bæ ‘çš„è®¾è®¡ç†å¿µã€‚è™½ç„¶å®ƒä»¬å¯èƒ½ä½¿ç”¨äº†ä¸åŒçš„å˜ç§æˆ–æ··åˆç»“æ„ï¼Œä½†åŸºæœ¬æ€æƒ³æºè‡ªBæ ‘çš„é«˜æ•ˆæŸ¥æ‰¾å’ŒèŒƒå›´æ“ä½œç‰¹æ€§ã€‚</p>
<h4 data-id="heading-39">Bæ ‘çš„å˜ç§</h4>
<p>B+æ ‘æ˜¯Bæ ‘çš„ä¸€ä¸ªé‡è¦å˜ç§ï¼Œå®ƒåœ¨æ•°æ®åº“ç³»ç»Ÿä¸­æ›´ä¸ºå¸¸ç”¨ï¼š</p>
<ul>
<li>æ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨å¶èŠ‚ç‚¹</li>
<li>å†…éƒ¨èŠ‚ç‚¹ä»…åŒ…å«é”®ï¼Œä¸åŒ…å«æ•°æ®</li>
<li>å¶èŠ‚ç‚¹é€šè¿‡é“¾è¡¨è¿æ¥ï¼Œæ”¯æŒæ›´é«˜æ•ˆçš„é¡ºåºè®¿é—®</li>
<li>é€‚åˆèŒƒå›´æŸ¥è¯¢å’Œé¡ºåºæ‰«æ</li>
</ul>
<p>B* æ ‘å¯¹Bæ ‘è¿›è¡Œäº†è¿›ä¸€æ­¥ä¼˜åŒ–ï¼š</p>
<ul>
<li>éæ ¹èŠ‚ç‚¹è‡³å°‘2/3æ»¡ï¼ˆè€Œä¸æ˜¯1/2ï¼‰</li>
<li>åœ¨èŠ‚ç‚¹åˆ†è£‚å‰å…ˆå°è¯•ä¸å…„å¼ŸèŠ‚ç‚¹é‡æ–°åˆ†é…</li>
<li>åˆ†è£‚æ—¶æ¶‰åŠä¸¤ä¸ªèŠ‚ç‚¹å˜ä¸ºä¸‰ä¸ªèŠ‚ç‚¹</li>
<li>æé«˜äº†ç©ºé—´åˆ©ç”¨ç‡</li>
</ul>
<h3 data-id="heading-40">B+æ ‘</h3>
<p>B+æ ‘æ˜¯ä¸€ç§å¹³è¡¡æ ‘æ•°æ®ç»“æ„ï¼Œæ˜¯Bæ ‘çš„å˜ç§ï¼Œè¢«å¹¿æ³›åº”ç”¨äºæ•°æ®åº“ç´¢å¼•å’Œæ–‡ä»¶ç³»ç»Ÿä¸­ã€‚B+æ ‘ä¿æŒæ•°æ®æœ‰åºï¼Œè€Œä¸”èƒ½å¤Ÿé«˜æ•ˆåœ°è¿›è¡ŒæŸ¥æ‰¾ã€é¡ºåºè®¿é—®ã€æ’å…¥å’Œåˆ é™¤æ“ä½œã€‚</p>
<p>B+æ ‘çš„ä¸»è¦ç»„æˆéƒ¨åˆ†åŒ…æ‹¬ï¼š</p>
<ul>
<li>èŠ‚ç‚¹ï¼šB+æ ‘ä¸­çš„åŸºæœ¬å•å…ƒï¼Œåˆ†ä¸ºå†…éƒ¨èŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹</li>
<li>å†…éƒ¨èŠ‚ç‚¹ï¼šåªå­˜å‚¨é”®å€¼å’ŒæŒ‡å‘å­èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œä¸å­˜å‚¨æ•°æ®</li>
<li>å¶å­èŠ‚ç‚¹ï¼šå­˜å‚¨é”®å€¼å’ŒçœŸå®æ•°æ®ï¼ˆæˆ–æŒ‡å‘æ•°æ®çš„æŒ‡é’ˆï¼‰</li>
<li>é˜¶æ•°ï¼ˆorderï¼‰ï¼šè¡¨ç¤ºä¸€ä¸ªèŠ‚ç‚¹æœ€å¤šå¯ä»¥æœ‰å¤šå°‘ä¸ªå­èŠ‚ç‚¹ï¼Œé€šå¸¸ç”¨mè¡¨ç¤º</li>
<li>é“¾è¡¨ï¼šæ‰€æœ‰å¶å­èŠ‚ç‚¹å½¢æˆä¸€ä¸ªæœ‰åºé“¾è¡¨ï¼Œæ–¹ä¾¿èŒƒå›´æŸ¥è¯¢</li>
</ul>
<p>B+æ ‘æ ¸å¿ƒç‰¹æ€§</p>
<ol>
<li>æ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ä¸Šï¼šå†…éƒ¨èŠ‚ç‚¹åªå­˜å‚¨é”®å€¼å’ŒæŒ‡é’ˆï¼Œä¸å­˜å‚¨å®é™…æ•°æ®</li>
<li>æ‰€æœ‰å¶å­èŠ‚ç‚¹é€šè¿‡æŒ‡é’ˆè¿æ¥æˆæœ‰åºé“¾è¡¨ï¼šä¾¿äºèŒƒå›´æŸ¥è¯¢å’Œé¡ºåºéå†</li>
<li>å¹³è¡¡æ ‘ç»“æ„ï¼šæ‰€æœ‰å¶å­èŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹çš„è·ç¦»ç›¸åŒ</li>
<li>é«˜æ‰‡å‡ºæ€§ï¼ˆHigh Fan-outï¼‰ï¼šæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥åŒ…å«å¤šä¸ªé”®å€¼å’ŒæŒ‡é’ˆï¼Œå‡å°‘æ ‘çš„é«˜åº¦</li>
<li>è‡ªå¹³è¡¡ï¼šåœ¨æ’å…¥å’Œåˆ é™¤æ“ä½œåè‡ªåŠ¨è°ƒæ•´ä»¥ä¿æŒå¹³è¡¡</li>
</ol>
<h4 data-id="heading-41">åŸºæœ¬æ“ä½œ</h4>
<ul>
<li>
<p>æŸ¥æ‰¾æ“ä½œ</p>
<ol>
<li>ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œæ ¹æ®é”®å€¼æ¯”è¾ƒç¡®å®šåº”è¯¥æŸ¥æ‰¾å“ªä¸ªå­èŠ‚ç‚¹</li>
<li>é€’å½’å‘ä¸‹æŸ¥æ‰¾ï¼Œç›´åˆ°åˆ°è¾¾å¶å­èŠ‚ç‚¹</li>
<li>åœ¨å¶å­èŠ‚ç‚¹ä¸­æŸ¥æ‰¾ç›®æ ‡æ•°æ®</li>
</ol>
</li>
<li>
<p>æ’å…¥æ“ä½œ</p>
<ol>
<li>æ‰¾åˆ°åº”æ’å…¥çš„å¶å­èŠ‚ç‚¹</li>
<li>å°†æ•°æ®æ’å…¥åˆ°è¯¥å¶å­èŠ‚ç‚¹</li>
<li>å¦‚æœå¶å­èŠ‚ç‚¹æº¢å‡ºï¼ˆè¶…è¿‡æœ€å¤§å®¹é‡ï¼‰ï¼š
<ul>
<li>åˆ†è£‚èŠ‚ç‚¹ä¸ºä¸¤éƒ¨åˆ†</li>
<li>é€‰æ‹©ä¸€ä¸ªé”®å€¼ä¸Šå‡åˆ°çˆ¶èŠ‚ç‚¹</li>
<li>å¦‚æœ‰å¿…è¦ï¼Œé€’å½’å‘ä¸Šåˆ†è£‚</li>
</ul>
</li>
</ol>
</li>
<li>
<p>åˆ é™¤æ“ä½œ</p>
<ol>
<li>æ‰¾åˆ°åŒ…å«ç›®æ ‡æ•°æ®çš„å¶å­èŠ‚ç‚¹</li>
<li>ä»å¶å­èŠ‚ç‚¹ä¸­åˆ é™¤æ•°æ®</li>
<li>å¦‚æœèŠ‚ç‚¹ä¸‹æº¢ï¼ˆä½äºæœ€å°å®¹é‡è¦æ±‚ï¼‰ï¼š
<ul>
<li>å°è¯•ä»ç›¸é‚»èŠ‚ç‚¹å€Ÿç”¨æ•°æ®</li>
<li>å¦‚æœæ— æ³•å€Ÿç”¨ï¼Œåˆ™åˆå¹¶èŠ‚ç‚¹</li>
<li>å¦‚æœ‰å¿…è¦ï¼Œé€’å½’å‘ä¸Šè°ƒæ•´</li>
</ul>
</li>
</ol>
</li>
</ul>
<h4 data-id="heading-42">ä¼˜ç‚¹</h4>
<ol>
<li>é«˜æ•ˆçš„èŒƒå›´æŸ¥è¯¢ï¼šå¶å­èŠ‚ç‚¹æ„æˆé“¾è¡¨ï¼Œå¯ä»¥å¿«é€Ÿè¿›è¡ŒèŒƒå›´æŸ¥è¯¢</li>
<li>æ›´å°‘çš„IOæ“ä½œï¼šé«˜æ‰‡å‡ºæ€§ä½¿æ ‘é«˜åº¦è¾ƒä½ï¼Œå‡å°‘ç£ç›˜è®¿é—®æ¬¡æ•°</li>
<li>é€‚åˆå¤–éƒ¨å­˜å‚¨ï¼šèŠ‚ç‚¹å¯ä»¥æ˜ å°„åˆ°ç£ç›˜å—ï¼Œä¼˜åŒ–ç£ç›˜IO</li>
<li>åŠ¨æ€å¹³è¡¡ï¼šæ’å…¥åˆ é™¤åè‡ªåŠ¨ç»´æŒå¹³è¡¡çŠ¶æ€</li>
<li>è¾ƒå¤§çš„åˆ†æ”¯å› å­ï¼šæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥å­˜å‚¨æ›´å¤šé”®å€¼ï¼Œå‡å°‘æ ‘çš„é«˜åº¦</li>
</ol>
<h4 data-id="heading-43">ç¼ºç‚¹</h4>
<ol>
<li>å®ç°å¤æ‚ï¼šç›¸æ¯”ç®€å•çš„æ ‘ç»“æ„ï¼Œå®ç°è¾ƒä¸ºå¤æ‚</li>
<li>ä¿®æ”¹å¼€é”€å¤§ï¼šæ’å…¥å’Œåˆ é™¤æ“ä½œå¯èƒ½å¯¼è‡´èŠ‚ç‚¹åˆ†è£‚æˆ–åˆå¹¶ï¼Œçº§è”å½±å“å¤šä¸ªèŠ‚ç‚¹</li>
<li>ç©ºé—´åˆ©ç”¨ç‡ï¼šå†…éƒ¨èŠ‚ç‚¹ä¸å­˜å‚¨æ•°æ®ï¼Œå¯èƒ½å¯¼è‡´ç©ºé—´åˆ©ç”¨ç‡ä¸å¦‚å…¶ä»–ç»“æ„</li>
<li>ä¸é€‚åˆé¢‘ç¹æ›´æ–°çš„åœºæ™¯ï¼šé¢‘ç¹çš„æ’å…¥åˆ é™¤æ“ä½œä¼šå¯¼è‡´é¢‘ç¹çš„æ ‘ç»“æ„è°ƒæ•´</li>
</ol>
<h4 data-id="heading-44">åº”ç”¨åœºæ™¯</h4>
<p>B+æ ‘åœ¨æ•°æ®åº“ç³»ç»Ÿå’Œæ–‡ä»¶ç³»ç»Ÿä¸­å¾—åˆ°äº†å¹¿æ³›åº”ç”¨ã€‚åœ¨æ•°æ®åº“é¢†åŸŸï¼Œå‡ ä¹æ‰€æœ‰ä¸»æµå…³ç³»å‹æ•°æ®åº“çš„ç´¢å¼•ç»“æ„éƒ½é‡‡ç”¨äº†B+æ ‘æˆ–å…¶å˜ç§ã€‚MySQLçš„InnoDBå­˜å‚¨å¼•æ“ä½¿ç”¨B+æ ‘ä½œä¸ºå…¶ä¸»è¦ç´¢å¼•ç»“æ„ï¼Œé€šè¿‡å°†æ•°æ®æŒ‰ä¸»é”®é¡ºåºç»„ç»‡åœ¨å¶å­èŠ‚ç‚¹ä¸­ï¼Œå®ç°äº†é«˜æ•ˆçš„æŸ¥è¯¢å’ŒèŒƒå›´æ‰«ææ“ä½œã€‚</p>
<p>åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼ŒB+æ ‘è¢«ç”¨äºç®¡ç†æ–‡ä»¶çš„ç›®å½•ç»“æ„å’Œç´¢å¼•ï¼Œæ¯”å¦‚NTFSã€ext4ç­‰ç°ä»£æ–‡ä»¶ç³»ç»Ÿã€‚ç”±äºB+æ ‘èƒ½å¤Ÿé«˜æ•ˆåœ°å¤„ç†å¤§é‡æ•°æ®ï¼ŒåŒæ—¶ä¿æŒè¾ƒä½çš„æ ‘é«˜åº¦ï¼Œä½¿æ–‡ä»¶ç³»ç»Ÿèƒ½å¤Ÿå¿«é€Ÿå®šä½å’Œè®¿é—®æ–‡ä»¶ã€‚</p>
<p>B+æ ‘è¿˜è¢«å¹¿æ³›åº”ç”¨äºåœ°ç†ä¿¡æ¯ç³»ç»Ÿ(GIS)ä¸­çš„ç©ºé—´ç´¢å¼•ï¼Œå¿«é€ŸæŸ¥æ‰¾ç‰¹å®šåœ°ç†åŒºåŸŸå†…çš„å¯¹è±¡ã€‚</p>
<h3 data-id="heading-45">Trieæ ‘</h3>
<p>Trieæ ‘ï¼Œä¹Ÿç§°ä¸ºå‰ç¼€æ ‘æˆ–å­—å…¸æ ‘ï¼Œæ˜¯ä¸€ç§æ ‘å½¢æ•°æ®ç»“æ„ï¼Œä¸“é—¨ç”¨äºé«˜æ•ˆå­˜å‚¨å’Œæ£€ç´¢å­—ç¬¦ä¸²é›†åˆã€‚Trieè¿™ä¸ªåå­—æ¥æºäº"retrieval"ï¼ˆæ£€ç´¢ï¼‰ä¸€è¯ï¼Œåæ˜ äº†å®ƒçš„ä¸»è¦ç”¨é€”ã€‚</p>
<p>åœ¨Trieæ ‘ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªå­—ç¬¦ï¼Œä»æ ¹èŠ‚ç‚¹åˆ°æŸä¸€èŠ‚ç‚¹çš„è·¯å¾„ä¸Šç»è¿‡çš„å­—ç¬¦è¿æ¥èµ·æ¥ï¼Œå°±æ˜¯è¯¥èŠ‚ç‚¹å¯¹åº”çš„å­—ç¬¦ä¸²ã€‚Trieæ ‘çš„å…³é”®ç‰¹ç‚¹æ˜¯ï¼Œæ‰€æœ‰æ‹¥æœ‰ç›¸åŒå‰ç¼€çš„å­—ç¬¦ä¸²ï¼Œåœ¨æ ‘ä¸­å…±äº«è¿™ä¸ªå‰ç¼€çš„å­˜å‚¨ç©ºé—´ã€‚</p>
<p>Trieæ ‘æ ¸å¿ƒç‰¹æ€§</p>
<ol>
<li>å‰ç¼€å…±äº«: å…·æœ‰ç›¸åŒå‰ç¼€çš„å­—ç¬¦ä¸²åœ¨Trieæ ‘ä¸­å…±äº«å­˜å‚¨ç©ºé—´ï¼Œå¤§å¤§èŠ‚çœäº†å†…å­˜</li>
<li>å¿«é€ŸæŸ¥æ‰¾: æŸ¥æ‰¾ä¸€ä¸ªé•¿åº¦ä¸ºkçš„å­—ç¬¦ä¸²çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(k)ï¼Œä¸Trieæ ‘ä¸­å­˜å‚¨çš„å­—ç¬¦ä¸²æ€»æ•°æ— å…³</li>
<li>è¯æ±‡å…³è”: é€šè¿‡å‰ç¼€å¯ä»¥è½»æ¾æ‰¾åˆ°æ‰€æœ‰å…·æœ‰è¯¥å‰ç¼€çš„å•è¯</li>
<li>æœ‰åºæ€§: Trieæ ‘å¤©ç„¶åœ°ä¿æŒäº†å­—å…¸åº</li>
</ol>
<h4 data-id="heading-46">åŸºæœ¬æ“ä½œ</h4>
<p>Trieæ ‘æ”¯æŒä»¥ä¸‹åŸºæœ¬æ“ä½œï¼š</p>
<ol>
<li>æ’å…¥(Insert): å°†ä¸€ä¸ªå­—ç¬¦ä¸²æ·»åŠ åˆ°Trieæ ‘ä¸­</li>
<li>æŸ¥æ‰¾(Search): æ£€æŸ¥ä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦ä¸²æ˜¯å¦å­˜åœ¨äºTrieæ ‘ä¸­</li>
<li>å‰ç¼€æŸ¥æ‰¾(StartsWith): æ£€æŸ¥Trieæ ‘ä¸­æ˜¯å¦æœ‰ä»¥ç»™å®šå‰ç¼€å¼€å¤´çš„å­—ç¬¦ä¸²</li>
<li>åˆ é™¤(Delete): ä»Trieæ ‘ä¸­åˆ é™¤ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆç›¸å¯¹å¤æ‚ï¼‰</li>
</ol>
<h4 data-id="heading-47">åŸºç¡€å®ç°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Trie</span> {
    <span class="hljs-keyword">private</span> TrieNode root;

    <span class="hljs-comment">// Trieæ ‘çš„èŠ‚ç‚¹ç»“æ„</span>
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">TrieNode</span> {
        <span class="hljs-comment">// å­èŠ‚ç‚¹ï¼Œä½¿ç”¨æ•°ç»„å®ç°ï¼ˆå‡è®¾åªåŒ…å«å°å†™å­—æ¯a-zï¼‰</span>
        <span class="hljs-keyword">private</span> TrieNode[] children;
        <span class="hljs-comment">// æ ‡è®°è¯¥èŠ‚ç‚¹æ˜¯å¦ä¸ºæŸä¸ªå•è¯çš„ç»“å°¾</span>
        <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> isEndOfWord;

        <span class="hljs-keyword">public</span> <span class="hljs-title function_">TrieNode</span><span class="hljs-params">()</span> {
            children = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TrieNode</span>[<span class="hljs-number">26</span>]; <span class="hljs-comment">// 26ä¸ªè‹±æ–‡å­—æ¯</span>
            isEndOfWord = <span class="hljs-literal">false</span>;
        }
    }

    <span class="hljs-comment">/** åˆå§‹åŒ–Trieæ ‘ */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Trie</span><span class="hljs-params">()</span> {
        root = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TrieNode</span>();
    }
    
    <span class="hljs-comment">/** å‘Trieæ ‘ä¸­æ’å…¥å•è¯ */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(String word)</span> {
        <span class="hljs-type">TrieNode</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> root;
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; word.length(); i++) {
            <span class="hljs-type">char</span> <span class="hljs-variable">ch</span> <span class="hljs-operator">=</span> word.charAt(i);
            <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> ch - <span class="hljs-string">'a'</span>; <span class="hljs-comment">// å°†å­—ç¬¦è½¬æ¢ä¸ºç´¢å¼•</span>
            
            <span class="hljs-comment">// å¦‚æœå½“å‰å­—ç¬¦çš„èŠ‚ç‚¹ä¸å­˜åœ¨ï¼Œåˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹</span>
            <span class="hljs-keyword">if</span> (current.children[index] == <span class="hljs-literal">null</span>) {
                current.children[index] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TrieNode</span>();
            }
            
            <span class="hljs-comment">// ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span>
            current = current.children[index];
        }
        
        <span class="hljs-comment">// æ ‡è®°å•è¯ç»“æŸ</span>
        current.isEndOfWord = <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-comment">/** æŸ¥æ‰¾Trieæ ‘ä¸­æ˜¯å¦å­˜åœ¨å®Œæ•´å•è¯ */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">search</span><span class="hljs-params">(String word)</span> {
        <span class="hljs-type">TrieNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> searchPrefix(word);
        
        <span class="hljs-comment">// èŠ‚ç‚¹å­˜åœ¨ä¸”æ˜¯å•è¯ç»“å°¾</span>
        <span class="hljs-keyword">return</span> node != <span class="hljs-literal">null</span> &amp;&amp; node.isEndOfWord;
    }
    
    <span class="hljs-comment">/** æŸ¥æ‰¾Trieæ ‘ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šå‰ç¼€ */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">startsWith</span><span class="hljs-params">(String prefix)</span> {
        <span class="hljs-comment">// åªéœ€è¦èŠ‚ç‚¹å­˜åœ¨å³å¯</span>
        <span class="hljs-keyword">return</span> searchPrefix(prefix) != <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-comment">/** æŸ¥æ‰¾å‰ç¼€å¯¹åº”çš„èŠ‚ç‚¹ */</span>
    <span class="hljs-keyword">private</span> TrieNode <span class="hljs-title function_">searchPrefix</span><span class="hljs-params">(String prefix)</span> {
        <span class="hljs-type">TrieNode</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> root;
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; prefix.length(); i++) {
            <span class="hljs-type">char</span> <span class="hljs-variable">ch</span> <span class="hljs-operator">=</span> prefix.charAt(i);
            <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> ch - <span class="hljs-string">'a'</span>;
            
            <span class="hljs-comment">// å¦‚æœå½“å‰å­—ç¬¦çš„èŠ‚ç‚¹ä¸å­˜åœ¨ï¼Œè¿”å›null</span>
            <span class="hljs-keyword">if</span> (current.children[index] == <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
            }
            
            current = current.children[index];
        }
        
        <span class="hljs-keyword">return</span> current;
    }
    
    <span class="hljs-comment">/** ä»Trieæ ‘ä¸­åˆ é™¤å•è¯ï¼ˆè¾ƒå¤æ‚çš„æ“ä½œï¼‰ */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(String word)</span> {
        delete(root, word, <span class="hljs-number">0</span>);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">delete</span><span class="hljs-params">(TrieNode current, String word, <span class="hljs-type">int</span> index)</span> {
        <span class="hljs-comment">// å·²ç»å¤„ç†å®Œæ‰€æœ‰å­—ç¬¦</span>
        <span class="hljs-keyword">if</span> (index == word.length()) {
            <span class="hljs-comment">// å¦‚æœä¸æ˜¯å•è¯ç»“å°¾ï¼Œå•è¯ä¸å­˜åœ¨</span>
            <span class="hljs-keyword">if</span> (!current.isEndOfWord) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
            
            <span class="hljs-comment">// å–æ¶ˆæ ‡è®°å•è¯ç»“å°¾</span>
            current.isEndOfWord = <span class="hljs-literal">false</span>;
            
            <span class="hljs-comment">// å¦‚æœèŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œå¯ä»¥åˆ é™¤</span>
            <span class="hljs-keyword">return</span> hasNoChildren(current);
        }
        
        <span class="hljs-type">char</span> <span class="hljs-variable">ch</span> <span class="hljs-operator">=</span> word.charAt(index);
        <span class="hljs-type">int</span> <span class="hljs-variable">childIndex</span> <span class="hljs-operator">=</span> ch - <span class="hljs-string">'a'</span>;
        <span class="hljs-type">TrieNode</span> <span class="hljs-variable">child</span> <span class="hljs-operator">=</span> current.children[childIndex];
        
        <span class="hljs-comment">// å¦‚æœå­—ç¬¦å¯¹åº”çš„èŠ‚ç‚¹ä¸å­˜åœ¨ï¼Œå•è¯ä¸å­˜åœ¨</span>
        <span class="hljs-keyword">if</span> (child == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        
        <span class="hljs-comment">// é€’å½’åˆ é™¤å­èŠ‚ç‚¹</span>
        <span class="hljs-type">boolean</span> <span class="hljs-variable">shouldDeleteChild</span> <span class="hljs-operator">=</span> delete(child, word, index + <span class="hljs-number">1</span>);
        
        <span class="hljs-comment">// å¦‚æœå­èŠ‚ç‚¹åº”è¯¥è¢«åˆ é™¤</span>
        <span class="hljs-keyword">if</span> (shouldDeleteChild) {
            current.children[childIndex] = <span class="hljs-literal">null</span>;
            
            <span class="hljs-comment">// å¦‚æœå½“å‰èŠ‚ç‚¹ä¸æ˜¯å•è¯ç»“å°¾ä¸”æ²¡æœ‰å…¶ä»–å­èŠ‚ç‚¹ï¼Œåˆ™å®ƒä¹Ÿå¯ä»¥è¢«åˆ é™¤</span>
            <span class="hljs-keyword">return</span> !current.isEndOfWord &amp;&amp; hasNoChildren(current);
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNoChildren</span><span class="hljs-params">(TrieNode node)</span> {
        <span class="hljs-keyword">for</span> (TrieNode child : node.children) {
            <span class="hljs-keyword">if</span> (child != <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
}
</code></pre>
<h4 data-id="heading-48">ä¼˜ç‚¹</h4>
<ol>
<li>é«˜æ•ˆçš„å­—ç¬¦ä¸²æ£€ç´¢ï¼šæŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸å­—ç¬¦ä¸²é•¿åº¦æˆæ­£æ¯”(O(k))ï¼Œè€Œä¸å­˜å‚¨çš„å­—ç¬¦ä¸²æ€»æ•°æ— å…³</li>
<li>èŠ‚çœç©ºé—´ï¼šé€šè¿‡å…±äº«å‰ç¼€ï¼Œå‡å°‘äº†é‡å¤å­˜å‚¨</li>
<li>æ”¯æŒæŒ‰å­—å…¸åºéå†ï¼šå¯ä»¥æ–¹ä¾¿åœ°æŒ‰å­—å…¸åºè¾“å‡ºæ‰€æœ‰å­—ç¬¦ä¸²</li>
<li>å‰ç¼€åŒ¹é…é«˜æ•ˆï¼šç‰¹åˆ«é€‚åˆå‰ç¼€æŸ¥è¯¢å’Œè‡ªåŠ¨è¡¥å…¨åŠŸèƒ½</li>
</ol>
<h4 data-id="heading-49">ç¼ºç‚¹</h4>
<ol>
<li>å†…å­˜æ¶ˆè€—ï¼šå¯¹äºä¸å…±äº«å‰ç¼€çš„å­—ç¬¦ä¸²é›†åˆï¼ŒTrieæ ‘å¯èƒ½æ¶ˆè€—å¤§é‡å†…å­˜</li>
<li>ç©ºé—´å¤æ‚åº¦é«˜ï¼šæ¯ä¸ªèŠ‚ç‚¹éœ€è¦å­˜å‚¨æ‰€æœ‰å¯èƒ½å­—ç¬¦çš„å¼•ç”¨ï¼ˆå¦‚ä¸Šä¾‹ä¸­æ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨26ä¸ªå­èŠ‚ç‚¹å¼•ç”¨ï¼‰</li>
<li>ä¸é€‚åˆå•æ¬¡æŸ¥è¯¢ï¼šå¦‚æœåªéœ€è¦è¿›è¡Œå•æ¬¡çš„ç²¾ç¡®å­—ç¬¦ä¸²æŸ¥è¯¢ï¼Œå“ˆå¸Œè¡¨å¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©</li>
<li>å®ç°è¾ƒä¸ºå¤æ‚ï¼šç‰¹åˆ«æ˜¯åˆ é™¤æ“ä½œï¼Œéœ€è¦é¢å¤–çš„é€»è¾‘æ¥å¤„ç†èŠ‚ç‚¹çš„æ¸…ç†</li>
</ol>
<h4 data-id="heading-50">åº”ç”¨åœºæ™¯</h4>
<ul>
<li>è‡ªåŠ¨è¡¥å…¨å’Œæ‹¼å†™æ£€æŸ¥ï¼šå½“ç”¨æˆ·åœ¨æœç´¢æ¡†ä¸­è¾“å…¥æ—¶ï¼ŒTrieæ ‘å¯ä»¥å¿«é€Ÿæ‰¾åˆ°æ‰€æœ‰ä»¥å½“å‰è¾“å…¥ä¸ºå‰ç¼€çš„å•è¯ï¼Œæä¾›æ™ºèƒ½æç¤ºã€‚è¾“å…¥æ³•å’Œæ–‡æœ¬ç¼–è¾‘å™¨é€šå¸¸åˆ©ç”¨è¿™ä¸€ç‰¹æ€§å®ç°å•è¯è¡¥å…¨åŠŸèƒ½ã€‚</li>
<li>IPè·¯ç”±è¡¨ï¼šç½‘ç»œè·¯ç”±å™¨ä½¿ç”¨ç±»ä¼¼Trieçš„ç»“æ„æ¥å­˜å‚¨IPåœ°å€ï¼Œå®ç°é«˜æ•ˆçš„æœ€é•¿å‰ç¼€åŒ¹é…ã€‚</li>
<li>å­—å…¸å’Œè¯æ±‡è¡¨ï¼šç”µå­å­—å…¸åº”ç”¨å¯ä»¥ä½¿ç”¨Trieæ ‘æ¥å­˜å‚¨è¯æ±‡ï¼Œæ”¯æŒå¿«é€ŸæŸ¥æ‰¾å’Œå‰ç¼€æœç´¢ã€‚</li>
<li>æ–‡æœ¬åˆ†æï¼šåœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä¸­ï¼ŒTrieæ ‘å¯ä»¥ç”¨äºå•è¯é¢‘ç‡ç»Ÿè®¡ã€å…³é”®è¯æå–ç­‰ä»»åŠ¡ã€‚</li>
<li>ç”µè¯å·ç ç°¿ï¼šé€šè®¯å½•åº”ç”¨å¯ä»¥ä½¿ç”¨Trieæ ‘æ¥å­˜å‚¨è”ç³»äººä¿¡æ¯ï¼Œæ”¯æŒæŒ‰å·ç å‰ç¼€æœç´¢ã€‚</li>
</ul>
<h4 data-id="heading-51">ç›¸å…³çš„LeetCodeçƒ­é—¨é¢˜ç›®</h4>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fimplement-trie-prefix-tree%2F" target="_blank" title="https://leetcode.cn/problems/implement-trie-prefix-tree/" ref="nofollow noopener noreferrer">208. å®ç° Trie (å‰ç¼€æ ‘)</a>Â - åŸºç¡€é¢˜ï¼Œè¦æ±‚å®ç°Trieæ ‘çš„åŸºæœ¬æ“ä½œã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fdesign-add-and-search-words-data-structure%2F" target="_blank" title="https://leetcode.cn/problems/design-add-and-search-words-data-structure/" ref="nofollow noopener noreferrer">211. æ·»åŠ ä¸æœç´¢å•è¯ - æ•°æ®ç»“æ„è®¾è®¡</a>Â - åœ¨åŸºæœ¬Trieçš„åŸºç¡€ä¸Šå¢åŠ äº†é€šé…ç¬¦åŒ¹é…åŠŸèƒ½ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fword-search-ii%2F" target="_blank" title="https://leetcode.cn/problems/word-search-ii/" ref="nofollow noopener noreferrer">212. å•è¯æœç´¢ II</a>Â - ä½¿ç”¨Trieæ ‘ä¼˜åŒ–åœ¨äºŒç»´å­—ç¬¦ç½‘æ ¼ä¸­æœç´¢å•è¯çš„è¿‡ç¨‹ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Freplace-words%2F" target="_blank" title="https://leetcode.cn/problems/replace-words/" ref="nofollow noopener noreferrer">648. å•è¯æ›¿æ¢</a>Â - ä½¿ç”¨Trieæ ‘æŸ¥æ‰¾è¯æ ¹å¹¶æ›¿æ¢å•è¯ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fstream-of-characters%2F" target="_blank" title="https://leetcode.cn/problems/stream-of-characters/" ref="nofollow noopener noreferrer">1032. å­—ç¬¦æµ</a>Â - è®¾è®¡ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œæ”¯æŒå¯¹å­—ç¬¦æµçš„æŸ¥è¯¢ï¼Œåˆ¤æ–­æœ€è¿‘æ·»åŠ çš„å­—ç¬¦æ˜¯å¦å½¢æˆäº†ç»™å®šå•è¯é›†åˆä¸­çš„æŸä¸ªå•è¯çš„åç¼€ã€‚</li>
</ol>
<h3 data-id="heading-52">æ ‘çŠ¶æ•°ç»„</h3>
<p>æ ‘çŠ¶æ•°ç»„ï¼ˆBinary Indexed Treeï¼‰ï¼Œä¹Ÿç§°ä¸ºFenwick Treeï¼Œæ˜¯ä¸€ç§æ”¯æŒé«˜æ•ˆçš„å‰ç¼€å’Œè®¡ç®—å’Œå•ç‚¹æ›´æ–°çš„æ•°æ®ç»“æ„ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨äºŒè¿›åˆ¶çš„æ€§è´¨æ¥ç»´æŠ¤æ•°æ®é—´çš„å±‚çº§å…³ç³»ï¼Œä»è€Œåœ¨O(log n)çš„æ—¶é—´å†…å®ŒæˆæŸ¥è¯¢å’Œæ›´æ–°æ“ä½œã€‚</p>
<p>æ ‘çŠ¶æ•°ç»„çš„å…³é”®æ¦‚å¿µæ˜¯"çˆ¶å­å…³ç³»"ï¼Œè¿™ç§å…³ç³»æ˜¯é€šè¿‡äºŒè¿›åˆ¶è¡¨ç¤ºä¸­çš„æœ€ä½ä½1æ¥ç¡®å®šçš„ã€‚å¯¹äºä»»æ„ä¸€ä¸ªèŠ‚ç‚¹iï¼Œå®ƒçš„çˆ¶èŠ‚ç‚¹æ˜¯i + (i &amp; -i)ï¼Œå®ƒçš„å­èŠ‚ç‚¹æ˜¯i - (i &amp; -i)ã€‚</p>
<ul>
<li>i &amp; -i è¡¨è¾¾å¼è®¡ç®—çš„æ˜¯içš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­çš„æœ€ä½ä½1å¯¹åº”çš„å€¼</li>
<li>ä¾‹å¦‚ï¼š6çš„äºŒè¿›åˆ¶æ˜¯110ï¼Œ6&amp;(-6) = 6&amp;(010) = 2</li>
</ul>
<p>æ ‘çŠ¶æ•°ç»„é€šå¸¸ä½¿ç”¨ä¸€ä¸ªä¸€ç»´æ•°ç»„è¡¨ç¤ºï¼Œé‡‡ç”¨1-indexedï¼ˆå³ä»ç´¢å¼•1å¼€å§‹å­˜å‚¨æœ‰æ•ˆæ•°æ®ï¼‰çš„æ–¹å¼ï¼š</p>
<ul>
<li>BIT[i]å­˜å‚¨äº†åŸå§‹æ•°ç»„ä¸­æŸä¸ªåŒºé—´çš„å’Œ</li>
<li>æ¯ä¸ªBIT[i]è´Ÿè´£ç®¡ç†çš„åŒºé—´é•¿åº¦ç”±i &amp; -iå†³å®š</li>
<li>ä¾‹å¦‚ï¼ŒBIT[6]ç®¡ç†çš„åŒºé—´é•¿åº¦æ˜¯2ï¼ŒåŒ…å«åŸå§‹æ•°ç»„ä¸­çš„A[5]å’ŒA[6]</li>
</ul>
<h4 data-id="heading-53">åŸºæœ¬æ“ä½œ</h4>
<ul>
<li>æ›´æ–°æ“ä½œï¼ˆupdateï¼‰ï¼šæ›´æ–°åŸå§‹æ•°ç»„ä¸­ç´¢å¼•içš„å€¼æ—¶ï¼Œéœ€è¦æ›´æ–°æ ‘çŠ¶æ•°ç»„ä¸­æ‰€æœ‰åŒ…å«è¯¥ç´¢å¼•çš„èŠ‚ç‚¹ã€‚
<ol>
<li>ä»ç´¢å¼•iå¼€å§‹</li>
<li>ä¸æ–­åœ°åŠ ä¸Ši &amp; -iï¼Œç›´åˆ°è¶…å‡ºæ•°ç»„èŒƒå›´</li>
<li>åœ¨æ¯ä¸€æ­¥éƒ½æ›´æ–°å¯¹åº”çš„æ ‘çŠ¶æ•°ç»„å€¼</li>
</ol>
</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">int</span> i, <span class="hljs-type">int</span> delta)</span> {
    i = i + <span class="hljs-number">1</span>; <span class="hljs-comment">// è½¬ä¸º1-basedç´¢å¼•</span>
    <span class="hljs-keyword">while</span> (i &lt;= n) {
        bit[i] += delta;
        i += i &amp; -i; <span class="hljs-comment">// ç§»åŠ¨åˆ°çˆ¶èŠ‚ç‚¹</span>
    }
}
</code></pre>
<ul>
<li>æŸ¥è¯¢å‰ç¼€å’Œï¼ˆqueryï¼‰:æŸ¥è¯¢ä»1åˆ°içš„æ‰€æœ‰å…ƒç´ çš„å’Œã€‚
<ol>
<li>ä»ç´¢å¼•iå¼€å§‹</li>
<li>ä¸æ–­åœ°å‡å»i &amp; -iï¼Œç›´åˆ°iå˜ä¸º0</li>
<li>åœ¨æ¯ä¸€æ­¥éƒ½ç´¯åŠ å¯¹åº”çš„æ ‘çŠ¶æ•°ç»„å€¼</li>
</ol>
</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">query</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span> {
    i = i + <span class="hljs-number">1</span>; <span class="hljs-comment">// è½¬ä¸º1-basedç´¢å¼•</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (i &gt; <span class="hljs-number">0</span>) {
        sum += bit[i];
        i -= i &amp; -i; <span class="hljs-comment">// ç§»åŠ¨åˆ°å‰ä¸€ä¸ªèŠ‚ç‚¹</span>
    }
    <span class="hljs-keyword">return</span> sum;
}
</code></pre>
<p>æ—¶é—´å¤æ‚åº¦ï¼š</p>
<ul>
<li>åˆå§‹åŒ–ï¼šO(n log n)</li>
<li>å•ç‚¹æ›´æ–°ï¼šO(log n)</li>
<li>å‰ç¼€å’ŒæŸ¥è¯¢ï¼šO(log n)</li>
<li>åŒºé—´æŸ¥è¯¢ï¼šO(log n)</li>
</ul>
<h4 data-id="heading-54">åº”ç”¨åœºæ™¯</h4>
<p>æ ‘çŠ¶æ•°ç»„åœ¨ä»¥ä¸‹åœºæ™¯ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼š</p>
<ol>
<li><strong>é¢‘ç¹çš„åŒºé—´æŸ¥è¯¢å’Œå•ç‚¹æ›´æ–°</strong>ï¼šå¦‚æœéœ€è¦ç»å¸¸è®¡ç®—å‰ç¼€å’Œå¹¶ä¸”æ•°ç»„ä¸­çš„å€¼ä¼šé¢‘ç¹å˜åŒ–ï¼Œæ ‘çŠ¶æ•°ç»„æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚</li>
<li><strong>è®¡æ•°åº”ç”¨</strong>ï¼šå¦‚é€†åºå¯¹è®¡æ•°ã€åŒºé—´ç»Ÿè®¡ç­‰ã€‚</li>
<li><strong>2D/å¤šç»´å‰ç¼€å’Œ</strong>ï¼šæ ‘çŠ¶æ•°ç»„å¯ä»¥å¾ˆå®¹æ˜“åœ°æ‰©å±•åˆ°å¤šç»´ç©ºé—´ï¼Œå¤„ç†äºŒç»´ç”šè‡³å¤šç»´çš„å‰ç¼€å’ŒæŸ¥è¯¢ã€‚</li>
<li><strong>åŠ¨æ€æ’åç»Ÿè®¡</strong>ï¼šé€šè¿‡æ ‘çŠ¶æ•°ç»„å¯ä»¥ç»´æŠ¤ä¸€ä¸ªåŠ¨æ€çš„æ’åç»Ÿè®¡ã€‚</li>
</ol>
<h4 data-id="heading-55">æ ‘çŠ¶æ•°ç»„çš„ä¼˜åŠ¿</h4>
<ul>
<li><strong>å®ç°ç®€å•</strong>ï¼šç›¸æ¯”äºçº¿æ®µæ ‘ï¼Œæ ‘çŠ¶æ•°ç»„çš„ä»£ç æ›´åŠ ç®€æ´ã€‚</li>
<li><strong>å¸¸æ•°å› å­å°</strong>ï¼šåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ ‘çŠ¶æ•°ç»„é€šå¸¸æ¯”çº¿æ®µæ ‘æ›´å¿«ï¼Œå› ä¸ºå®ƒçš„å¸¸æ•°å› å­æ›´å°ã€‚</li>
<li><strong>ç©ºé—´æ•ˆç‡é«˜</strong>ï¼šæ ‘çŠ¶æ•°ç»„åªéœ€è¦ä¸åŸå§‹æ•°ç»„ç›¸åŒå¤§å°çš„ç©ºé—´ã€‚</li>
</ul>
<h4 data-id="heading-56">åŒºé—´æ›´æ–°</h4>
<p>é€šè¿‡å·®åˆ†æ•°ç»„æŠ€æœ¯ï¼Œæ ‘çŠ¶æ•°ç»„å¯ä»¥æ”¯æŒåŒºé—´æ›´æ–°ï¼Œä½†æŸ¥è¯¢å˜ä¸ºå•ç‚¹æŸ¥è¯¢ï¼Œè¿™æ ·å°±èƒ½åœ¨O(log n)æ—¶é—´å†…å®ŒæˆåŒºé—´æ›´æ–°æ“ä½œã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åˆ›å»ºæ ‘çŠ¶æ•°ç»„ï¼ˆå‡è®¾å·²å®ç°BinaryIndexedTreeç±»ï¼‰</span>
<span class="hljs-type">BinaryIndexedTree</span> <span class="hljs-variable">bit</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BinaryIndexedTree</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]{<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>});

<span class="hljs-comment">// æŸ¥è¯¢å‰ç¼€å’Œ</span>
System.out.println(<span class="hljs-string">"query(2): "</span> + bit.query(<span class="hljs-number">2</span>)); <span class="hljs-comment">// ç´¢å¼•0åˆ°2çš„å’Œ: 2+1+4=7</span>

<span class="hljs-comment">// æ›´æ–°å…ƒç´ å€¼</span>
bit.update(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">// å°†ç´¢å¼•1çš„å…ƒç´ å¢åŠ 2</span>
System.out.println(<span class="hljs-string">"query(2): "</span> + bit.query(<span class="hljs-number">2</span>)); <span class="hljs-comment">// ç°åœ¨ç´¢å¼•0åˆ°2çš„å’Œ: 2+(1+2)+4=9</span>

<span class="hljs-comment">// åŒºé—´æŸ¥è¯¢</span>
System.out.println(<span class="hljs-string">"rangeQuery(1, 3): "</span> + bit.rangeQuery(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)); <span class="hljs-comment">// ç´¢å¼•1åˆ°3çš„å’Œ: (1+2)+4+3=10</span>
</code></pre>
<h3 data-id="heading-57">çº¿æ®µæ ‘</h3>
<p>çº¿æ®µæ ‘ï¼ˆSegment Treeï¼‰æ˜¯ä¸€ç§é«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼Œä¸“é—¨ç”¨äºè§£å†³åŒºé—´æŸ¥è¯¢å’ŒåŒºé—´ä¿®æ”¹é—®é¢˜ã€‚ä¸æ ‘çŠ¶æ•°ç»„ç›¸æ¯”ï¼Œçº¿æ®µæ ‘åŠŸèƒ½æ›´åŠ å¼ºå¤§ï¼Œå¯ä»¥æ”¯æŒæ›´å¤šç§ç±»çš„åŒºé—´æ“ä½œã€‚</p>
<p>çº¿æ®µæ ‘çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡åˆ†æ²»æ³•å°†ä¸€ä¸ªåŒºé—´åˆ’åˆ†ä¸ºå¤šä¸ªå­åŒºé—´ï¼Œå¹¶ç”¨æ ‘çš„å½¢å¼ç»„ç»‡è¿™äº›åŒºé—´çš„ä¿¡æ¯ã€‚åœ¨è¿™æ£µæ ‘ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªåŒºé—´ï¼Œæ ¹èŠ‚ç‚¹ä»£è¡¨æ•´ä¸ªæ•°ç»„åŒºé—´ï¼Œå¶å­èŠ‚ç‚¹ä»£è¡¨å•ä¸ªå…ƒç´ ã€‚</p>
<p>æ ¸å¿ƒæ¦‚å¿µè§£é‡Šï¼š</p>
<ul>
<li>åŒºé—´æŸ¥è¯¢ï¼šæŸ¥è¯¢æ•°ç»„ä¸­æŸä¸ªåŒºé—´çš„èšåˆä¿¡æ¯ï¼ˆå¦‚åŒºé—´å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼ç­‰ï¼‰</li>
<li>åŒºé—´ä¿®æ”¹ï¼šä¿®æ”¹æ•°ç»„ä¸­æŸä¸ªåŒºé—´å†…æ‰€æœ‰å…ƒç´ çš„å€¼</li>
<li>æ‡’æƒ°æ ‡è®°ï¼ˆLazy Propagationï¼‰ï¼šå»¶è¿Ÿæ›´æ–°ç­–ç•¥ï¼Œç”¨äºæé«˜åŒºé—´ä¿®æ”¹çš„æ•ˆç‡</li>
<li>æ ‘èŠ‚ç‚¹ï¼šæ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨å…¶å¯¹åº”åŒºé—´çš„ä¿¡æ¯ï¼Œå¦‚åŒºé—´å’Œã€æœ€å¤§å€¼ç­‰</li>
</ul>
<p>çº¿æ®µæ ‘æ ¸å¿ƒç‰¹æ€§ï¼š</p>
<ol>
<li>çµæ´»çš„åŒºé—´æ“ä½œï¼šæ”¯æŒå„ç§åŒºé—´æŸ¥è¯¢ï¼ˆå’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼ã€å¼‚æˆ–å’Œç­‰ï¼‰å’ŒåŒºé—´ä¿®æ”¹</li>
<li>é«˜æ•ˆçš„æ—¶é—´å¤æ‚åº¦ï¼šæŸ¥è¯¢å’Œä¿®æ”¹çš„æ—¶é—´å¤æ‚åº¦å‡ä¸ºO(log n)</li>
<li>å¼ºå¤§çš„æ‰©å±•æ€§ï¼šå¯ä»¥æ ¹æ®éœ€æ±‚è‡ªå®šä¹‰åŒºé—´æ“ä½œçš„ç±»å‹</li>
<li>é€‚åº”åŠ¨æ€å˜åŒ–ï¼šèƒ½å¤Ÿå¤„ç†æ•°ç»„å†…å®¹é¢‘ç¹å˜åŒ–çš„æƒ…å†µ</li>
</ol>
<h4 data-id="heading-58">çº¿æ®µæ ‘çš„å·¥ä½œåŸç†</h4>
<p>çº¿æ®µæ ‘çš„ç»“æ„ï¼š</p>
<p>çº¿æ®µæ ‘æ˜¯ä¸€æ£µå®Œå…¨äºŒå‰æ ‘ï¼Œå…¶ä¸­ï¼š</p>
<ul>
<li>æ ¹èŠ‚ç‚¹ä»£è¡¨æ•´ä¸ªæ•°ç»„åŒºé—´[0, n-1]</li>
<li>æ¯ä¸ªéå¶èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ä»£è¡¨åŒºé—´çš„å·¦åŠéƒ¨åˆ†ï¼Œå³å­èŠ‚ç‚¹ä»£è¡¨å³åŠéƒ¨åˆ†</li>
<li>å¶å­èŠ‚ç‚¹ä»£è¡¨å•ä¸ªå…ƒç´ ï¼ˆé•¿åº¦ä¸º1çš„åŒºé—´ï¼‰</li>
</ul>
<p>æ‡’æƒ°æ ‡è®°ï¼ˆLazy Propagationï¼‰ï¼š</p>
<p>æ‡’æƒ°æ ‡è®°æ˜¯ä¸€ç§ä¼˜åŒ–æŠ€æœ¯ï¼Œç”¨äºå»¶è¿ŸåŒºé—´ä¿®æ”¹çš„ä¼ æ’­ã€‚å½“ä¸€ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹éƒ½éœ€è¦è¢«ä¿®æ”¹æ—¶ï¼Œæˆ‘ä»¬ä¸ç«‹å³ä¿®æ”¹è¿™äº›å­èŠ‚ç‚¹ï¼Œè€Œæ˜¯åœ¨èŠ‚ç‚¹ä¸Šæ ‡è®°ä¿®æ”¹ä¿¡æ¯ï¼Œåªæœ‰åœ¨éœ€è¦è®¿é—®å­èŠ‚ç‚¹æ—¶æ‰å°†ä¿®æ”¹ä¸‹æ¨ï¼Œæé«˜åŒºé—´ä¿®æ”¹çš„æ•ˆç‡ã€‚</p>
<h4 data-id="heading-59">åŸºæœ¬æ“ä½œ</h4>
<ol>
<li>æ„å»ºï¼ˆbuildï¼‰ï¼šæ ¹æ®åˆå§‹æ•°ç»„æ„å»ºçº¿æ®µæ ‘</li>
<li>åŒºé—´æŸ¥è¯¢ï¼ˆqueryï¼‰ï¼šæŸ¥è¯¢æŸä¸ªåŒºé—´çš„èšåˆä¿¡æ¯</li>
<li>å•ç‚¹ä¿®æ”¹ï¼ˆupdateï¼‰ï¼šä¿®æ”¹å•ä¸ªå…ƒç´ çš„å€¼</li>
<li>åŒºé—´ä¿®æ”¹ï¼ˆupdateRangeï¼‰ï¼šä¿®æ”¹ä¸€æ®µåŒºé—´å†…æ‰€æœ‰å…ƒç´ çš„å€¼ï¼ˆé€šå¸¸ä½¿ç”¨æ‡’æƒ°æ ‡è®°å®ç°ï¼‰</li>
</ol>
<h4 data-id="heading-60">åŸºç¡€å®ç°</h4>
<p>ä¸‹é¢æ˜¯çº¿æ®µæ ‘çš„åŸºç¡€å®ç°ï¼ˆä»¥åŒºé—´å’Œä¸ºä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SegmentTree</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span>[] tree;   <span class="hljs-comment">// å­˜å‚¨çº¿æ®µæ ‘èŠ‚ç‚¹</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span>[] lazy;   <span class="hljs-comment">// æ‡’æƒ°æ ‡è®°</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span>[] nums;   <span class="hljs-comment">// åŸå§‹æ•°ç»„çš„å‰¯æœ¬</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> n;        <span class="hljs-comment">// åŸå§‹æ•°ç»„é•¿åº¦</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SegmentTree</span><span class="hljs-params">(<span class="hljs-type">int</span>[] array)</span> {
        n = array.length;
        <span class="hljs-comment">// çº¿æ®µæ ‘æ•°ç»„å¤§å°ä¸€èˆ¬ä¸ºåŸæ•°ç»„å¤§å°çš„4å€</span>
        tree = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">4</span> * n];
        lazy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">4</span> * n];
        nums = array.clone();
        build(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, n - <span class="hljs-number">1</span>);
    }
    
    <span class="hljs-comment">// æ„å»ºçº¿æ®µæ ‘</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">build</span><span class="hljs-params">(<span class="hljs-type">int</span> node, <span class="hljs-type">int</span> start, <span class="hljs-type">int</span> end)</span> {
        <span class="hljs-keyword">if</span> (start == end) {
            <span class="hljs-comment">// å¶å­èŠ‚ç‚¹ï¼Œå­˜å‚¨å•ä¸ªå…ƒç´ </span>
            tree[node] = nums[start];
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> (start + end) / <span class="hljs-number">2</span>;
        <span class="hljs-type">int</span> <span class="hljs-variable">leftNode</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span> * node + <span class="hljs-number">1</span>;
        <span class="hljs-type">int</span> <span class="hljs-variable">rightNode</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span> * node + <span class="hljs-number">2</span>;
        
        <span class="hljs-comment">// é€’å½’æ„å»ºå·¦å³å­æ ‘</span>
        build(leftNode, start, mid);
        build(rightNode, mid + <span class="hljs-number">1</span>, end);
        
        <span class="hljs-comment">// åˆå¹¶å­èŠ‚ç‚¹çš„ä¿¡æ¯</span>
        tree[node] = tree[leftNode] + tree[rightNode];
    }
    
    <span class="hljs-comment">// å•ç‚¹ä¿®æ”¹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">int</span> index, <span class="hljs-type">int</span> val)</span> {
        <span class="hljs-comment">// è®¡ç®—ä¸åŸå€¼çš„å·®å€¼</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">diff</span> <span class="hljs-operator">=</span> val - nums[index];
        nums[index] = val;
        updateSingle(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, n - <span class="hljs-number">1</span>, index, diff);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateSingle</span><span class="hljs-params">(<span class="hljs-type">int</span> node, <span class="hljs-type">int</span> start, <span class="hljs-type">int</span> end, <span class="hljs-type">int</span> index, <span class="hljs-type">int</span> diff)</span> {
        <span class="hljs-comment">// æ£€æŸ¥ç´¢å¼•æ˜¯å¦åœ¨å½“å‰èŠ‚ç‚¹èŒƒå›´å†…</span>
        <span class="hljs-keyword">if</span> (index &lt; start || index &gt; end) {
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// æ›´æ–°å½“å‰èŠ‚ç‚¹çš„å€¼</span>
        tree[node] += diff;
        
        <span class="hljs-keyword">if</span> (start != end) {
            <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> (start + end) / <span class="hljs-number">2</span>;
            <span class="hljs-type">int</span> <span class="hljs-variable">leftNode</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span> * node + <span class="hljs-number">1</span>;
            <span class="hljs-type">int</span> <span class="hljs-variable">rightNode</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span> * node + <span class="hljs-number">2</span>;
            
            <span class="hljs-comment">// é€’å½’æ›´æ–°å­èŠ‚ç‚¹</span>
            updateSingle(leftNode, start, mid, index, diff);
            updateSingle(rightNode, mid + <span class="hljs-number">1</span>, end, index, diff);
        }
    }
    
    <span class="hljs-comment">// åŒºé—´æŸ¥è¯¢</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">query</span><span class="hljs-params">(<span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right)</span> {
        <span class="hljs-keyword">return</span> queryRange(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, n - <span class="hljs-number">1</span>, left, right);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">queryRange</span><span class="hljs-params">(<span class="hljs-type">int</span> node, <span class="hljs-type">int</span> start, <span class="hljs-type">int</span> end, <span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right)</span> {
        <span class="hljs-comment">// å¦‚æœå½“å‰èŠ‚ç‚¹çš„åŒºé—´å®Œå…¨åœ¨æŸ¥è¯¢åŒºé—´å¤–</span>
        <span class="hljs-keyword">if</span> (right &lt; start || left &gt; end) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        }
        
        <span class="hljs-comment">// å¦‚æœå½“å‰èŠ‚ç‚¹çš„åŒºé—´å®Œå…¨åœ¨æŸ¥è¯¢åŒºé—´å†…</span>
        <span class="hljs-keyword">if</span> (left &lt;= start &amp;&amp; end &lt;= right) {
            <span class="hljs-keyword">return</span> tree[node];
        }
        
        <span class="hljs-comment">// å¤„ç†æ‡’æƒ°æ ‡è®°</span>
        <span class="hljs-keyword">if</span> (lazy[node] != <span class="hljs-number">0</span>) {
            tree[node] += (end - start + <span class="hljs-number">1</span>) * lazy[node];
            
            <span class="hljs-keyword">if</span> (start != end) {
                lazy[<span class="hljs-number">2</span> * node + <span class="hljs-number">1</span>] += lazy[node];
                lazy[<span class="hljs-number">2</span> * node + <span class="hljs-number">2</span>] += lazy[node];
            }
            
            lazy[node] = <span class="hljs-number">0</span>;
        }
        
        <span class="hljs-comment">// æŸ¥è¯¢èŒƒå›´éƒ¨åˆ†è¦†ç›–å½“å‰èŠ‚ç‚¹çš„åŒºé—´ï¼Œéœ€è¦åˆ†åˆ«æŸ¥è¯¢å·¦å³å­èŠ‚ç‚¹</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> (start + end) / <span class="hljs-number">2</span>;
        <span class="hljs-type">int</span> <span class="hljs-variable">leftSum</span> <span class="hljs-operator">=</span> queryRange(<span class="hljs-number">2</span> * node + <span class="hljs-number">1</span>, start, mid, left, right);
        <span class="hljs-type">int</span> <span class="hljs-variable">rightSum</span> <span class="hljs-operator">=</span> queryRange(<span class="hljs-number">2</span> * node + <span class="hljs-number">2</span>, mid + <span class="hljs-number">1</span>, end, left, right);
        
        <span class="hljs-keyword">return</span> leftSum + rightSum;
    }
    
    <span class="hljs-comment">// åŒºé—´ä¿®æ”¹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateRange</span><span class="hljs-params">(<span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right, <span class="hljs-type">int</span> val)</span> {
        updateRangeTree(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, n - <span class="hljs-number">1</span>, left, right, val);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateRangeTree</span><span class="hljs-params">(<span class="hljs-type">int</span> node, <span class="hljs-type">int</span> start, <span class="hljs-type">int</span> end, <span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right, <span class="hljs-type">int</span> val)</span> {
        <span class="hljs-comment">// å¤„ç†å½“å‰èŠ‚ç‚¹çš„æ‡’æƒ°æ ‡è®°</span>
        <span class="hljs-keyword">if</span> (lazy[node] != <span class="hljs-number">0</span>) {
            tree[node] += (end - start + <span class="hljs-number">1</span>) * lazy[node];
            
            <span class="hljs-keyword">if</span> (start != end) {
                lazy[<span class="hljs-number">2</span> * node + <span class="hljs-number">1</span>] += lazy[node];
                lazy[<span class="hljs-number">2</span> * node + <span class="hljs-number">2</span>] += lazy[node];
            }
            
            lazy[node] = <span class="hljs-number">0</span>;
        }
        
        <span class="hljs-comment">// å¦‚æœå½“å‰èŠ‚ç‚¹çš„åŒºé—´å®Œå…¨åœ¨ä¿®æ”¹åŒºé—´å¤–</span>
        <span class="hljs-keyword">if</span> (right &lt; start || left &gt; end) {
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// å¦‚æœå½“å‰èŠ‚ç‚¹çš„åŒºé—´å®Œå…¨åœ¨ä¿®æ”¹åŒºé—´å†…</span>
        <span class="hljs-keyword">if</span> (left &lt;= start &amp;&amp; end &lt;= right) {
            tree[node] += (end - start + <span class="hljs-number">1</span>) * val;
            
            <span class="hljs-keyword">if</span> (start != end) {
                lazy[<span class="hljs-number">2</span> * node + <span class="hljs-number">1</span>] += val;
                lazy[<span class="hljs-number">2</span> * node + <span class="hljs-number">2</span>] += val;
            }
            
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// ä¿®æ”¹èŒƒå›´éƒ¨åˆ†è¦†ç›–å½“å‰èŠ‚ç‚¹çš„åŒºé—´ï¼Œéœ€è¦åˆ†åˆ«ä¿®æ”¹å·¦å³å­èŠ‚ç‚¹</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> (start + end) / <span class="hljs-number">2</span>;
        updateRangeTree(<span class="hljs-number">2</span> * node + <span class="hljs-number">1</span>, start, mid, left, right, val);
        updateRangeTree(<span class="hljs-number">2</span> * node + <span class="hljs-number">2</span>, mid + <span class="hljs-number">1</span>, end, left, right, val);
        
        <span class="hljs-comment">// æ›´æ–°å½“å‰èŠ‚ç‚¹çš„å€¼</span>
        tree[node] = tree[<span class="hljs-number">2</span> * node + <span class="hljs-number">1</span>] + tree[<span class="hljs-number">2</span> * node + <span class="hljs-number">2</span>];
    }
}
</code></pre>
<h4 data-id="heading-61">ä¼˜ç‚¹</h4>
<ol>
<li>åŠŸèƒ½å¼ºå¤§ï¼šæ”¯æŒå¤šç§åŒºé—´æ“ä½œï¼ŒåŒ…æ‹¬åŒºé—´æ±‚å’Œã€æœ€å¤§å€¼ã€æœ€å°å€¼ç­‰</li>
<li>æ“ä½œçµæ´»ï¼šåŒæ—¶æ”¯æŒåŒºé—´æŸ¥è¯¢å’ŒåŒºé—´ä¿®æ”¹</li>
<li>æ—¶é—´æ•ˆç‡é«˜ï¼šæ‰€æœ‰æ“ä½œçš„æ—¶é—´å¤æ‚åº¦å‡ä¸ºO(log n)</li>
<li>å¯æ‰©å±•æ€§å¥½ï¼šå¯ä»¥æ ¹æ®å…·ä½“é—®é¢˜è‡ªå®šä¹‰èŠ‚ç‚¹å­˜å‚¨çš„ä¿¡æ¯å’Œæ“ä½œæ–¹å¼</li>
</ol>
<h4 data-id="heading-62">ç¼ºç‚¹</h4>
<ol>
<li>å†…å­˜æ¶ˆè€—è¾ƒå¤§ï¼šéœ€è¦é¢å¤–çš„å†…å­˜æ¥å­˜å‚¨çº¿æ®µæ ‘ç»“æ„ï¼Œé€šå¸¸ä¸ºåŸæ•°ç»„å¤§å°çš„4å€</li>
<li>ä»£ç å®ç°å¤æ‚ï¼šç›¸æ¯”å…¶ä»–æ•°æ®ç»“æ„ï¼ˆå¦‚æ ‘çŠ¶æ•°ç»„ï¼‰ï¼Œå®ç°å’Œè°ƒè¯•æ›´åŠ å¤æ‚</li>
<li>å¸¸æ•°å› å­è¾ƒå¤§ï¼šè™½ç„¶æ—¶é—´å¤æ‚åº¦æ˜¯O(log n)ï¼Œä½†å®é™…è¿è¡Œæ—¶é—´å¯èƒ½æ¯”æ ‘çŠ¶æ•°ç»„ç­‰ç»“æ„ç•¥é•¿</li>
</ol>
<h4 data-id="heading-63">åº”ç”¨åœºæ™¯</h4>
<p>çº¿æ®µæ ‘åœ¨è®¸å¤šå®é™…é—®é¢˜ä¸­æœ‰å¹¿æ³›åº”ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦åŒæ—¶æ”¯æŒåŒºé—´æŸ¥è¯¢å’ŒåŒºé—´ä¿®æ”¹çš„æƒ…å†µä¸‹ï¼š</p>
<ol>
<li>èŒƒå›´æ£€ç´¢ç³»ç»Ÿï¼šåœ¨æ•°æ®åº“å’Œä¿¡æ¯æ£€ç´¢ç³»ç»Ÿä¸­ï¼Œçº¿æ®µæ ‘å¯ç”¨äºå¿«é€ŸæŸ¥è¯¢æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„æ•°æ®èŒƒå›´ã€‚ä¾‹å¦‚ï¼Œåœ¨æ—¶é—´åºåˆ—æ•°æ®åº“ä¸­ï¼Œå¿«é€ŸæŸ¥æ‰¾æŸä¸€æ—¶é—´æ®µå†…çš„æœ€å¤§/æœ€å°å€¼æˆ–å¹³å‡å€¼ã€‚</li>
<li>å›¾åƒå¤„ç†ï¼šåœ¨å¤„ç†å¤§å‹å›¾åƒæ•°æ®æ—¶ï¼Œçº¿æ®µæ ‘å¯ç”¨äºå¿«é€Ÿè®¡ç®—å›¾åƒæŸä¸€åŒºåŸŸçš„ç»Ÿè®¡ä¿¡æ¯æˆ–å®ç°åŒºåŸŸæ€§çš„å›¾åƒç¼–è¾‘æ“ä½œã€‚</li>
<li>è®¡ç®—å‡ ä½•ï¼šåœ¨å¤„ç†äºŒç»´ç©ºé—´ä¸­çš„ç‚¹ã€çº¿æˆ–çŸ©å½¢ç­‰å‡ ä½•å¯¹è±¡æ—¶ï¼Œçº¿æ®µæ ‘å¯ä»¥é«˜æ•ˆåœ°è§£å†³åŒºé—´æŸ¥è¯¢é—®é¢˜ï¼Œå¦‚æ‰¾å‡ºä¸ç»™å®šåŒºåŸŸç›¸äº¤çš„æ‰€æœ‰å¯¹è±¡ã€‚</li>
<li>åœ¨çº¿ç®—æ³•ç«èµ›ï¼šçº¿æ®µæ ‘æ˜¯è§£å†³åŠ¨æ€èŒƒå›´æŸ¥è¯¢é—®é¢˜çš„æ ‡å‡†å·¥å…·ï¼Œå¦‚åŒºé—´æœ€å¤§å€¼ã€åŒºé—´å’Œç­‰é—®é¢˜ã€‚</li>
<li>æ¸¸æˆå¼€å‘ï¼šåœ¨å¤§å‹å¤šäººåœ¨çº¿æ¸¸æˆä¸­ï¼Œçº¿æ®µæ ‘å¯ç”¨äºåœ°å›¾æ•°æ®çš„ç®¡ç†å’Œå¿«é€ŸæŸ¥è¯¢ï¼Œå¦‚æ‰¾å‡ºæŸåŒºåŸŸå†…çš„æ‰€æœ‰æ¸¸æˆå¯¹è±¡ã€‚</li>
</ol>
<h4 data-id="heading-64">åŠ¨æ€çº¿æ®µæ ‘</h4>
<p>å½“åŒºé—´èŒƒå›´éå¸¸å¤§ï¼Œä½†å®é™…æœ‰å€¼çš„ç‚¹æ¯”è¾ƒç¨€ç–æ—¶ï¼Œå¯ä»¥ä½¿ç”¨åŠ¨æ€çº¿æ®µæ ‘ï¼ˆé€šå¸¸ä½¿ç”¨æŒ‡é’ˆå®ç°ï¼‰æ¥èŠ‚çœç©ºé—´ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicSegmentTree</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> {
        <span class="hljs-type">int</span> val;      <span class="hljs-comment">// èŠ‚ç‚¹å€¼</span>
        <span class="hljs-type">int</span> lazy;     <span class="hljs-comment">// æ‡’æƒ°æ ‡è®°</span>
        Node left;    <span class="hljs-comment">// å·¦å­èŠ‚ç‚¹</span>
        Node right;   <span class="hljs-comment">// å³å­èŠ‚ç‚¹</span>
        <span class="hljs-type">int</span> start;    <span class="hljs-comment">// åŒºé—´èµ·ç‚¹</span>
        <span class="hljs-type">int</span> end;      <span class="hljs-comment">// åŒºé—´ç»ˆç‚¹</span>
        
        Node(<span class="hljs-type">int</span> start, <span class="hljs-type">int</span> end) {
            <span class="hljs-built_in">this</span>.start = start;
            <span class="hljs-built_in">this</span>.end = end;
            <span class="hljs-built_in">this</span>.val = <span class="hljs-number">0</span>;
            <span class="hljs-built_in">this</span>.lazy = <span class="hljs-number">0</span>;
        }
    }
    
    <span class="hljs-keyword">private</span> Node root;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DynamicSegmentTree</span><span class="hljs-params">(<span class="hljs-type">int</span> start, <span class="hljs-type">int</span> end)</span> {
        root = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(start, end);
    }
    
    <span class="hljs-comment">// åŒºé—´æ›´æ–°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right, <span class="hljs-type">int</span> val)</span> {
        update(root, left, right, val);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(Node node, <span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right, <span class="hljs-type">int</span> val)</span> {
        <span class="hljs-comment">// å¦‚æœåŒºé—´å®Œå…¨åœ¨æ›´æ–°èŒƒå›´å¤–</span>
        <span class="hljs-keyword">if</span> (node.end &lt; left || node.start &gt; right) {
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// å¦‚æœåŒºé—´å®Œå…¨åœ¨æ›´æ–°èŒƒå›´å†…</span>
        <span class="hljs-keyword">if</span> (node.start &gt;= left &amp;&amp; node.end &lt;= right) {
            node.val += (node.end - node.start + <span class="hljs-number">1</span>) * val;
            <span class="hljs-keyword">if</span> (node.start != node.end) {
                node.lazy += val;
            }
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// ä¸‹æ¨æ‡’æƒ°æ ‡è®°</span>
        pushDown(node);
        
        <span class="hljs-comment">// æ›´æ–°å·¦å³å­èŠ‚ç‚¹</span>
        <span class="hljs-keyword">if</span> (node.left != <span class="hljs-literal">null</span>) {
            update(node.left, left, right, val);
        }
        <span class="hljs-keyword">if</span> (node.right != <span class="hljs-literal">null</span>) {
            update(node.right, left, right, val);
        }
        
        <span class="hljs-comment">// æ›´æ–°å½“å‰èŠ‚ç‚¹çš„å€¼</span>
        node.val = (node.left != <span class="hljs-literal">null</span> ? node.left.val : <span class="hljs-number">0</span>) + 
                   (node.right != <span class="hljs-literal">null</span> ? node.right.val : <span class="hljs-number">0</span>);
    }
    
    <span class="hljs-comment">// åŒºé—´æŸ¥è¯¢</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">query</span><span class="hljs-params">(<span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right)</span> {
        <span class="hljs-keyword">return</span> query(root, left, right);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">query</span><span class="hljs-params">(Node node, <span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right)</span> {
        <span class="hljs-comment">// å¦‚æœåŒºé—´å®Œå…¨åœ¨æŸ¥è¯¢èŒƒå›´å¤–</span>
        <span class="hljs-keyword">if</span> (node.end &lt; left || node.start &gt; right) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        }
        
        <span class="hljs-comment">// å¦‚æœåŒºé—´å®Œå…¨åœ¨æŸ¥è¯¢èŒƒå›´å†…</span>
        <span class="hljs-keyword">if</span> (node.start &gt;= left &amp;&amp; node.end &lt;= right) {
            <span class="hljs-keyword">return</span> node.val;
        }
        
        <span class="hljs-comment">// ä¸‹æ¨æ‡’æƒ°æ ‡è®°</span>
        pushDown(node);
        
        <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (node.left != <span class="hljs-literal">null</span>) {
            sum += query(node.left, left, right);
        }
        <span class="hljs-keyword">if</span> (node.right != <span class="hljs-literal">null</span>) {
            sum += query(node.right, left, right);
        }
        
        <span class="hljs-keyword">return</span> sum;
    }
    
    <span class="hljs-comment">// ä¸‹æ¨æ‡’æƒ°æ ‡è®°</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pushDown</span><span class="hljs-params">(Node node)</span> {
        <span class="hljs-keyword">if</span> (node.lazy == <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> (node.start + node.end) / <span class="hljs-number">2</span>;
        
        <span class="hljs-comment">// åˆ›å»ºå·¦å­èŠ‚ç‚¹ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰</span>
        <span class="hljs-keyword">if</span> (node.left == <span class="hljs-literal">null</span>) {
            node.left = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(node.start, mid);
        }
        
        <span class="hljs-comment">// åˆ›å»ºå³å­èŠ‚ç‚¹ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰</span>
        <span class="hljs-keyword">if</span> (node.right == <span class="hljs-literal">null</span>) {
            node.right = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(mid + <span class="hljs-number">1</span>, node.end);
        }
        
        <span class="hljs-comment">// æ›´æ–°å­èŠ‚ç‚¹çš„å€¼å’Œæ‡’æƒ°æ ‡è®°</span>
        node.left.val += (node.left.end - node.left.start + <span class="hljs-number">1</span>) * node.lazy;
        node.right.val += (node.right.end - node.right.start + <span class="hljs-number">1</span>) * node.lazy;
        
        <span class="hljs-keyword">if</span> (node.left.start != node.left.end) {
            node.left.lazy += node.lazy;
        }
        <span class="hljs-keyword">if</span> (node.right.start != node.right.end) {
            node.right.lazy += node.lazy;
        }
        
        <span class="hljs-comment">// æ¸…é™¤å½“å‰èŠ‚ç‚¹çš„æ‡’æƒ°æ ‡è®°</span>
        node.lazy = <span class="hljs-number">0</span>;
    }
}
</code></pre>
<h4 data-id="heading-65">å¯æŒä¹…åŒ–çº¿æ®µæ ‘ï¼ˆPersistent Segment Treeï¼‰</h4>
<p>å¯æŒä¹…åŒ–çº¿æ®µæ ‘æ˜¯çº¿æ®µæ ‘çš„ä¸€ç§å˜ä½“ï¼Œå®ƒå¯ä»¥ä¿å­˜å†å²ç‰ˆæœ¬ï¼Œå…è®¸æŸ¥è¯¢ä»»æ„å†å²çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PersistentSegmentTree</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> {
        <span class="hljs-type">int</span> val;      <span class="hljs-comment">// èŠ‚ç‚¹å€¼</span>
        Node left;    <span class="hljs-comment">// å·¦å­èŠ‚ç‚¹</span>
        Node right;   <span class="hljs-comment">// å³å­èŠ‚ç‚¹</span>
        
        Node(<span class="hljs-type">int</span> val) {
            <span class="hljs-built_in">this</span>.val = val;
            <span class="hljs-built_in">this</span>.left = <span class="hljs-literal">null</span>;
            <span class="hljs-built_in">this</span>.right = <span class="hljs-literal">null</span>;
        }
        
        Node(Node other) {
            <span class="hljs-built_in">this</span>.val = other.val;
            <span class="hljs-built_in">this</span>.left = other.left;
            <span class="hljs-built_in">this</span>.right = other.right;
        }
    }
    
    <span class="hljs-keyword">private</span> Node[] roots;  <span class="hljs-comment">// å­˜å‚¨å†å²ç‰ˆæœ¬çš„æ ¹èŠ‚ç‚¹</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> n;         <span class="hljs-comment">// æ•°ç»„å¤§å°</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> versionCount; <span class="hljs-comment">// ç‰ˆæœ¬æ•°é‡</span>
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">PersistentSegmentTree</span><span class="hljs-params">(<span class="hljs-type">int</span>[] array, <span class="hljs-type">int</span> maxVersions)</span> {
        n = array.length;
        roots = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>[maxVersions];
        versionCount = <span class="hljs-number">0</span>;
        
        <span class="hljs-comment">// æ„å»ºåˆå§‹ç‰ˆæœ¬</span>
        roots[versionCount++] = build(<span class="hljs-number">0</span>, n - <span class="hljs-number">1</span>, array);
    }
    
    <span class="hljs-comment">// æ„å»ºçº¿æ®µæ ‘</span>
    <span class="hljs-keyword">private</span> Node <span class="hljs-title function_">build</span><span class="hljs-params">(<span class="hljs-type">int</span> start, <span class="hljs-type">int</span> end, <span class="hljs-type">int</span>[] array)</span> {
        <span class="hljs-keyword">if</span> (start == end) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(array[start]);
        }
        
        <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> (start + end) / <span class="hljs-number">2</span>;
        <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(<span class="hljs-number">0</span>);
        node.left = build(start, mid, array);
        node.right = build(mid + <span class="hljs-number">1</span>, end, array);
        node.val = node.left.val + node.right.val;
        
        <span class="hljs-keyword">return</span> node;
    }
    
    <span class="hljs-comment">// åˆ›å»ºæ–°ç‰ˆæœ¬å¹¶æ›´æ–°å•ä¸ªå…ƒç´ </span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">int</span> index, <span class="hljs-type">int</span> val)</span> {
        roots[versionCount] = update(roots[versionCount - <span class="hljs-number">1</span>], <span class="hljs-number">0</span>, n - <span class="hljs-number">1</span>, index, val);
        versionCount++;
    }
    
    <span class="hljs-keyword">private</span> Node <span class="hljs-title function_">update</span><span class="hljs-params">(Node node, <span class="hljs-type">int</span> start, <span class="hljs-type">int</span> end, <span class="hljs-type">int</span> index, <span class="hljs-type">int</span> val)</span> {
        <span class="hljs-keyword">if</span> (index &lt; start || index &gt; end) {
            <span class="hljs-keyword">return</span> node;
        }
        
        <span class="hljs-comment">// åˆ›å»ºæ–°èŠ‚ç‚¹ï¼ˆè·¯å¾„å¤åˆ¶ï¼‰</span>
        <span class="hljs-type">Node</span> <span class="hljs-variable">newNode</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(node);
        
        <span class="hljs-keyword">if</span> (start == end) {
            newNode.val = val;
            <span class="hljs-keyword">return</span> newNode;
        }
        
        <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> (start + end) / <span class="hljs-number">2</span>;
        <span class="hljs-keyword">if</span> (index &lt;= mid) {
            newNode.left = update(node.left, start, mid, index, val);
        } <span class="hljs-keyword">else</span> {
            newNode.right = update(node.right, mid + <span class="hljs-number">1</span>, end, index, val);
        }
        
        newNode.val = newNode.left.val + newNode.right.val;
        <span class="hljs-keyword">return</span> newNode;
    }
    
    <span class="hljs-comment">// æŸ¥è¯¢ç‰¹å®šç‰ˆæœ¬çš„åŒºé—´å’Œ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">query</span><span class="hljs-params">(<span class="hljs-type">int</span> version, <span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right)</span> {
        <span class="hljs-keyword">if</span> (version &gt;= versionCount) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"ç‰ˆæœ¬ä¸å­˜åœ¨"</span>);
        }
        <span class="hljs-keyword">return</span> query(roots[version], <span class="hljs-number">0</span>, n - <span class="hljs-number">1</span>, left, right);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">query</span><span class="hljs-params">(Node node, <span class="hljs-type">int</span> start, <span class="hljs-type">int</span> end, <span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right)</span> {
        <span class="hljs-keyword">if</span> (right &lt; start || left &gt; end) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        }
        
        <span class="hljs-keyword">if</span> (left &lt;= start &amp;&amp; end &lt;= right) {
            <span class="hljs-keyword">return</span> node.val;
        }
        
        <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> (start + end) / <span class="hljs-number">2</span>;
        <span class="hljs-keyword">return</span> query(node.left, start, mid, left, right) + 
               query(node.right, mid + <span class="hljs-number">1</span>, end, left, right);
    }
}
</code></pre>
<h4 data-id="heading-66">ç›¸å…³LeetCodeçƒ­é—¨é¢˜ç›®</h4>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Frange-sum-query-mutable%2F" target="_blank" title="https://leetcode.cn/problems/range-sum-query-mutable/" ref="nofollow noopener noreferrer">307. åŒºåŸŸå’Œæ£€ç´¢ - æ•°ç»„å¯ä¿®æ”¹</a>ï¼šè®¾è®¡ä¸€ä¸ªæ”¯æŒåŒºé—´å’ŒæŸ¥è¯¢å’Œå•ç‚¹ä¿®æ”¹çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥ä½¿ç”¨çº¿æ®µæ ‘é«˜æ•ˆè§£å†³ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Ffalling-squares%2F" target="_blank" title="https://leetcode.cn/problems/falling-squares/" ref="nofollow noopener noreferrer">699. æ‰è½çš„æ–¹å—</a>ï¼šä½¿ç”¨çº¿æ®µæ ‘æ¥è·Ÿè¸ªåŒºé—´çš„æœ€å¤§é«˜åº¦ï¼Œè§£å†³æ–¹å—å †å é—®é¢˜ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Frange-module%2F" target="_blank" title="https://leetcode.cn/problems/range-module/" ref="nofollow noopener noreferrer">715. Rangeæ¨¡å—</a>ï¼šå®ç°ä¸€ä¸ªæ•°æ®ç»“æ„æ¥ç®¡ç†åŒºé—´çš„æ·»åŠ ã€åˆ é™¤å’ŒæŸ¥è¯¢ï¼Œçº¿æ®µæ ‘æ˜¯ç†æƒ³çš„è§£å†³æ–¹æ¡ˆã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fthe-skyline-problem%2F" target="_blank" title="https://leetcode.cn/problems/the-skyline-problem/" ref="nofollow noopener noreferrer">218. å¤©é™…çº¿é—®é¢˜</a>ï¼šä½¿ç”¨çº¿æ®µæ ‘æ¥å¤„ç†å»ºç­‘ç‰©çš„é«˜åº¦ä¿¡æ¯ï¼Œæ±‚è§£åŸå¸‚å¤©é™…çº¿ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fonline-majority-element-in-subarray%2F" target="_blank" title="https://leetcode.cn/problems/online-majority-element-in-subarray/" ref="nofollow noopener noreferrer">1157. å­æ•°ç»„ä¸­å ç»å¤§å¤šæ•°çš„å…ƒç´ </a>ï¼šä½¿ç”¨çº¿æ®µæ ‘ç»“åˆåˆ†æ²»æ€æƒ³è§£å†³åŒºé—´ä¼—æ•°æŸ¥è¯¢é—®é¢˜ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å€ŸåŠ©RemoteComposeå¼€å‘åŠ¨æ€åŒ–é¡µé¢]]></title>    <link>https://juejin.cn/post/7579813925996757033</link>    <guid>https://juejin.cn/post/7579813925996757033</guid>    <pubDate>2025-12-04T16:30:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579813925996757033" data-draft-id="7579846685070934070" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å€ŸåŠ©RemoteComposeå¼€å‘åŠ¨æ€åŒ–é¡µé¢"/> <meta itemprop="keywords" content="Kotlin,Android,Android Jetpack"/> <meta itemprop="datePublished" content="2025-12-04T16:30:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨€æœ‰çŒ¿è¯‰"/> <meta itemprop="url" content="https://juejin.cn/user/2788017216685784"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å€ŸåŠ©RemoteComposeå¼€å‘åŠ¨æ€åŒ–é¡µé¢
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2788017216685784/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨€æœ‰çŒ¿è¯‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T16:30:24.000Z" title="Thu Dec 04 2025 16:30:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»21åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¯‘è‡ªã€ŒRemoteCompose: Another Paradigm for Server-Driven UI in Jetpack Composeã€ï¼ŒåŸæ–‡é“¾æ¥<a href="https://link.juejin.cn?target=https%3A%2F%2Fproandroiddev.com%2Fremotecompose-another-paradigm-for-server-driven-ui-in-jetpack-compose-92186619ba8f" target="_blank" title="https://proandroiddev.com/remotecompose-another-paradigm-for-server-driven-ui-in-jetpack-compose-92186619ba8f" ref="nofollow noopener noreferrer">proandroiddev.com/remotecompoâ€¦</a>ï¼Œç”±Jaewoong Eumå‘å¸ƒäº2025å¹´11æœˆ29æ—¥ã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5d2b6664b564b5c9a7071e4c16baf1e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iA5pyJ54y_6K-J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1765470623&amp;x-signature=SyJGoGKruGr3xj3tL56bJw9KnEs%3D" alt="remote_compose.webp" loading="lazy"/></p>
<p>æ„å»ºåŠ¨æ€ç”¨æˆ·ç•Œé¢ä¸€ç›´æ˜¯ Android å¼€å‘ä¸­çš„ä¸€é¡¹æ ¹æœ¬æ€§æŒ‘æˆ˜ã€‚ä¼ ç»Ÿæ–¹æ³•è¦æ±‚æ¯æ¬¡ UI éœ€è¦æ›´æ”¹æ—¶éƒ½å¿…é¡»é‡æ–°ç¼–è¯‘å’Œé‡æ–°éƒ¨ç½²æ•´ä¸ªåº”ç”¨ç¨‹åºï¼Œè¿™ç»™ A/B æµ‹è¯•ã€åŠŸèƒ½å¼€å…³å’Œå®æ—¶å†…å®¹æ›´æ–°å¸¦æ¥äº†æå¤§çš„ä¸ä¾¿ã€‚</p>
<p>è¯•æƒ³ä¸€ä¸‹ï¼Œä½ çš„è¥é”€å›¢é˜Ÿæƒ³è¦æµ‹è¯•ä¸€ä¸ªæ–°çš„ç»“è´¦æŒ‰é’®è®¾è®¡ï¼šåœ¨ä¼ ç»Ÿæ¨¡å¼ä¸‹ï¼Œè¿™ç§ç®€å•çš„æ›´æ”¹éœ€è¦å¼€å‘äººå‘˜èŠ±è´¹æ—¶é—´ã€è¿›è¡Œä»£ç å®¡æŸ¥ã€QA æµ‹è¯•ã€æäº¤åˆ°åº”ç”¨å•†åº—ï¼Œä»¥åŠç­‰å¾…æ•°å‘¨æ‰èƒ½è·å¾—ç”¨æˆ·é‡‡çº³ã€‚RemoteCompose çš„å‡ºç°ä¸ºè§£å†³è¿™ä¸€é—®é¢˜æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„æ–¹æ¡ˆï¼Œå®ƒä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿåœ¨è¿è¡Œæ—¶åˆ›å»ºã€ä¼ è¾“å’Œæ¸²æŸ“ Jetpack Compose UI å¸ƒå±€ï¼Œè€Œæ— éœ€é‡æ–°ç¼–è¯‘ã€‚</p>
<p>æœ¬æ–‡å°†æ¢è®¨ RemoteCompose çš„æ¦‚å¿µï¼Œç†è§£å…¶æ ¸å¿ƒæ¶æ„ï¼Œå¹¶æ¢ç´¢å®ƒå¦‚ä½•ä¸º Jetpack Compose çš„åŠ¨æ€é¡µé¢è®¾è®¡å¸¦æ¥è¯¸å¤šä¼˜åŠ¿ã€‚æœ¬æ–‡å¹¶éåº“çš„ä½¿ç”¨æ•™ç¨‹ï¼Œè€Œæ˜¯ç€é‡æ¢è®¨å®ƒæ‰€ä»£è¡¨çš„ Android UI å¼€å‘èŒƒå¼è½¬å˜ã€‚</p>
<h3 data-id="heading-0"><strong>é›†æˆä¸ä¾èµ–</strong></h3>
<p>åœ¨æ·±å…¥æ¢è®¨æ¦‚å¿µä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£å¦‚ä½•å°† RemoteCompose æ·»åŠ åˆ°ä½ çš„é¡¹ç›®ä¸­ã€‚å¯¹äºè¿è¡Œåœ¨ JVM ä¸Šä¸”ä¸ä¾èµ– Android çš„æœåŠ¡å™¨å’Œåç«¯ï¼š</p>
<pre><code class="hljs language-groovy" lang="groovy">// settings.gradle
repositories {
  maven {
    url = uri("https://androidx.dev/snapshots/builds/14511716/artifacts/repository")
  }
}

// JVM server - no Android dependencies
dependencies {
    implementation("androidx.compose.remote:remote-core:1.0.0-SNAPSHOT")
    implementation("androidx.compose.remote:remote-creation-compose:1.0.0-SNAPSHOT")
}

// Compose-based app
dependencies {
    implementation("androidx.compose.remote:remote-player-compose:1.0.0-SNAPSHOT")
    implementation("androidx.compose.remote:remote-tooling-preview:1.0.0-SNAPSHOT")
}

// View-based app
dependencies {
    implementation("androidx.compose.remote:remote-player-view:1.0.0-SNAPSHOT")
}
</code></pre>
<p>è¯·æ³¨æ„ï¼ŒRemoteCompose ä»åœ¨ç”± AndroidX å›¢é˜Ÿå¼€å‘ä¸­ï¼Œå°šæœªæ­£å¼å‘å¸ƒï¼›å®ƒä»…å¯é€šè¿‡ AndroidX å¿«ç…§ Maven ä»“åº“è·å–ã€‚</p>
<h3 data-id="heading-1">ç†è§£æ ¸å¿ƒæŠ½è±¡</h3>
<p>RemoteCompose çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œå®ƒæ”¯æŒ Compose UI ç»„ä»¶çš„è¿œç¨‹æ¸²æŸ“ã€‚å®ƒä¸ä¼ ç»Ÿ UI æ–¹æ³•çš„åŒºåˆ«åœ¨äºå®ƒéµå¾ªä¸¤ä¸ªåŸºæœ¬åŸåˆ™ï¼šå£°æ˜å¼æ–‡æ¡£åºåˆ—åŒ–å’Œå¹³å°æ— å…³æ¸²æŸ“ã€‚è¿™äº›ä¸ä»…ä»…æ˜¯æŠ€æœ¯ç‰¹æ€§ï¼›è¿™äº›æ¶æ„å†³ç­–ä»æ ¹æœ¬ä¸Šæ”¹å˜äº†ä½ å¯¹ UI éƒ¨ç½²çš„æ€è€ƒæ–¹å¼ã€‚</p>
<p><strong>å£°æ˜å¼æ–‡æ¡£åºåˆ—åŒ–</strong></p>
<p>å£°æ˜å¼æ–‡æ¡£åºåˆ—åŒ–æ„å‘³ç€ä½ å¯ä»¥å°†ä»»ä½• Jetpack Compose å¸ƒå±€æ•è·ä¸ºç´§å‡‘çš„åºåˆ—åŒ–æ ¼å¼ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆå¯¹ UI è¿›è¡Œâ€œæˆªå›¾â€ï¼Œåªä¸è¿‡ä½ æ•è·çš„ä¸æ˜¯åƒç´ ï¼Œè€Œæ˜¯å®é™…çš„ç»˜å›¾æŒ‡ä»¤ã€‚è¿™ä¸ªæ•è·çš„æ–‡æ¡£åŒ…å«äº†é‡å»º UI æ‰€éœ€çš„ä¸€åˆ‡ï¼šå½¢çŠ¶ã€é¢œè‰²ã€æ–‡æœ¬ã€å›¾åƒã€åŠ¨ç”»ï¼Œç”šè‡³è¿˜æœ‰äº¤äº’å¼è§¦æ‘¸åŒºåŸŸã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// On the server or creation side</span>
<span class="hljs-keyword">val</span> document = captureRemoteDocument(
    context = context,
    creationDisplayInfo = displayInfo,
    profile = profile
) {
    RemoteColumn(modifier = RemoteModifier.fillMaxSize()) {
        RemoteText(<span class="hljs-string">"Dynamic Content"</span>)
        RemoteButton(onClick = { <span class="hljs-comment">/* action */</span> }) {
            RemoteText(<span class="hljs-string">"Click Me"</span>)
        }
    }
}
</code></pre>
<p>ç»“æœå¦‚ä½•ï¼Ÿä¸€ä¸ªå¯ä»¥é€šè¿‡ç½‘ç»œå‘é€çš„å­—èŠ‚æ•°ç»„ã€‚è¿™ç§æ–¹æ³•çš„å…³é”®åœ¨äºï¼Œåˆ›å»ºç«¯ç¼–å†™çš„æ˜¯æ ‡å‡†çš„ Compose ä»£ç ã€‚æ— éœ€å­¦ä¹ æ–°çš„ DSLï¼Œæ— éœ€ç»´æŠ¤ JSON æ¨¡å¼ï¼Œä¹Ÿæ— éœ€æŒæ¡æ¨¡æ¿è¯­è¨€ã€‚åªè¦å¯ä»¥ç”¨ Compose ç¼–å†™ï¼Œå°±å¯ä»¥ç”¨ RemoteCompose æ•è·ã€‚</p>
<p>ä½ å¯ä»¥æ•è·ä¸€ä¸ªæ™®é€šçš„ Compose ä»£ç ï¼Œå®ƒä¼šæ•è·ç»˜åˆ¶è°ƒç”¨ï¼ˆè¿™äº›è°ƒç”¨éå¸¸é™æ€ï¼‰ã€‚æ›´å¸¸è§çš„æƒ…å†µæ˜¯ï¼Œä½ åº”è¯¥æ‹¥æœ‰é•œåƒ Compose çš„ Remote* ä¸“ç”¨ APIï¼Œè¿™äº› API ä¸“ä¸ºåºåˆ—åŒ–å’Œè¿œç¨‹æ’­æ”¾è€Œè®¾è®¡ï¼Œä¾‹å¦‚ <code>RemoteColumn</code>ã€<code>RemoteButton</code>ã€<code>RemoteText</code> ç­‰ã€‚</p>
<p><strong>å¹³å°æ— å…³æ¸²æŸ“</strong></p>
<p>å¹³å°æ— å…³æ¸²æŸ“æ„å‘³ç€æ•è·çš„æ–‡æ¡£å¯ä»¥é€šè¿‡ç½‘ç»œä¼ è¾“ï¼Œå¹¶åœ¨ä»»ä½• Android è®¾å¤‡ä¸Šæ¸²æŸ“ï¼Œè€Œæ— éœ€åŸå§‹çš„ Compose ä»£ç ã€‚å®¢æˆ·ç«¯è®¾å¤‡ä¸éœ€è¦ä½ çš„å¯ç»„åˆå‡½æ•°ã€è§†å›¾æ¨¡å‹æˆ–ä¸šåŠ¡é€»è¾‘â€”â€”å®ƒåªéœ€è¦æ–‡æ¡£å­—èŠ‚å’Œä¸€ä¸ªæ’­æ”¾å™¨ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// On the client or player side</span>
RemoteDocumentPlayer(
    document = remoteDocument.document,
    documentWidth = windowInfo.containerSize.width,
    documentHeight = windowInfo.containerSize.height,
    onAction = { actionId, value -&gt;
        <span class="hljs-comment">// Handle user interactions</span>
    }
)
</code></pre>
<p>è¿™äº›ç‰¹æ€§å¹¶éä»…ä»…æ˜¯ä¸ºäº†æ–¹ä¾¿ï¼›å®ƒä»¬æ˜¯æ¶æ„çº¦æŸï¼Œèƒ½å¤ŸçœŸæ­£å®ç° UI å®šä¹‰ä¸éƒ¨ç½²çš„è§£è€¦ã€‚æ–‡æ¡£æ ¼å¼ä¸ä»…åŒ…å«é™æ€å¸ƒå±€ï¼Œè¿˜åŒ…å«çŠ¶æ€ã€åŠ¨ç”»å’Œäº¤äº’ï¼Œä»è€Œå®Œæ•´åœ°å‘ˆç°äº† UI ä½“éªŒã€‚</p>
<p><strong>â€‹â€‹æ–¹æ³•æ¯”è¾ƒï¼šä¸ºä»€ä¹ˆä¸é€‰æ‹© JSON æˆ– WebViewï¼Ÿ</strong></p>
<p>åœ¨æ·±å…¥æ¢è®¨ä¹‹å‰ï¼Œæˆ‘ä»¬æœ‰å¿…è¦äº†è§£ RemoteCompose ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ç§æ–¹æ³•è€Œä¸æ˜¯å…¶ä»–æ–¹æ¡ˆã€‚</p>
<p>åŸºäº JSON çš„æœåŠ¡å™¨ç«¯ UIï¼Œä¾‹å¦‚ Airbnb çš„ Epoxy æˆ– Shopify çš„æ–¹æ³•ï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ªæ˜ å°„åˆ°åŸç”Ÿç»„ä»¶çš„æ¨¡å¼ã€‚è¿™ç§æ–¹æ³•é€‚ç”¨äºç»“æ„åŒ–å†…å®¹ï¼Œä½†éš¾ä»¥å¤„ç†å¤æ‚çš„åŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœã€è‡ªå®šä¹‰ç»˜å›¾å’Œå›¾å½¢ã€å¸¦æœ‰å†…è”æ ·å¼çš„å¯Œæ–‡æœ¬ä»¥åŠæ¸å˜å’Œé˜´å½±ç­‰è§†è§‰æ•ˆæœã€‚</p>
<p>WebView æä¾›äº†å…¨é¢çš„çµæ´»æ€§ï¼Œä½†ç”±äºå…¶ç‹¬ç«‹çš„æ¸²æŸ“è¿‡ç¨‹ï¼Œä¼šå¸¦æ¥æ€§èƒ½å¼€é”€ï¼›æ­¤å¤–ï¼ŒWeb æ ·å¼ä¸åŸç”Ÿè®¾è®¡åœ¨å¤–è§‚å’Œä½“éªŒä¸Šå­˜åœ¨ä¸ä¸€è‡´ï¼›æ¯ä¸ª WebView éƒ½ä¼šå ç”¨å¤§é‡èµ„æºï¼Œé€ æˆå†…å­˜å‹åŠ›ï¼›è§¦æ‘¸å¤„ç†ä¹Ÿè¾ƒä¸ºå¤æ‚ï¼Œå®¹æ˜“å‡ºç°æ‰‹åŠ¿å†²çªã€‚</p>
<p>RemoteCompose å¦è¾Ÿè¹Šå¾„ï¼šæ•è· Compose å®é™…æ‰§è¡Œçš„ç»˜åˆ¶æ“ä½œã€‚è¿™æ„å‘³ç€ï¼Œä½ å¯ä»¥ä½¿ç”¨ Compose æ„å»ºçš„ä»»ä½• UIï¼ŒåŒ…æ‹¬è‡ªå®šä¹‰ Canvas ç»˜åˆ¶ã€å¤æ‚åŠ¨ç”»å’Œ Material Design ç»„ä»¶ï¼Œéƒ½å¯ä»¥è¢«æ•è·å¹¶ä»¥åŸç”Ÿæ€§èƒ½è¿œç¨‹é‡æ”¾ã€‚</p>
<h3 data-id="heading-2"><strong>åŸºäºæ–‡æ¡£çš„æ¶æ„ï¼šåˆ›å»ºä¸å›æ”¾</strong></h3>
<p>RemoteCompose çš„æ¶æ„å›´ç»•ç€ä¸¤ä¸ªé˜¶æ®µçš„æ¸…æ™°åˆ†ç¦»è€Œæ„å»ºï¼šæ–‡æ¡£åˆ›å»ºå’Œæ–‡æ¡£å›æ”¾ã€‚ç†è§£è¿™ç§åˆ†ç¦»æ˜¯ç†è§£æ¡†æ¶å¼ºå¤§åŠŸèƒ½çš„å…³é”®ã€‚</p>
<p><strong>æ–‡æ¡£åˆ›å»ºï¼šå°† UI ä½œä¸ºæ•°æ®æ•è·</strong></p>
<p>åˆ›å»ºé˜¶æ®µå°† Compose UI ä»£ç è½¬æ¢ä¸ºåºåˆ—åŒ–æ–‡æ¡£ã€‚è¿™æ˜¯é€šè¿‡æ•è·æœºåˆ¶å®ç°çš„ï¼Œè¯¥æœºåˆ¶ä¼šåœ¨ Canvas å±‚ï¼ˆAndroid æ¸²æŸ“ç®¡çº¿çš„æœ€åº•å±‚ï¼‰æ‹¦æˆªç»˜åˆ¶æ“ä½œã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span> Content
        â†“
RemoteComposeCreationState (Tracks state and modifiers)
        â†“
CaptureComposeView (Virtual Display - no <span class="hljs-keyword">actual</span> screen needed)
        â†“
RecordingCanvas (Intercepts every draw call)
        â†“
Operations (<span class="hljs-number">93</span>+ operation types covering all drawing primitives)
        â†“
RemoteComposeBuffer (Efficient binary serialization)
        â†“
ByteArray (Network-ready, typically <span class="hljs-number">10</span>-100KB <span class="hljs-keyword">for</span> complex UIs)
</code></pre>
<p>åˆ›å»ºç«¯æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„ Compose é›†æˆå±‚ã€‚ä½ åªéœ€ç¼–å†™æ ‡å‡†çš„ <code>@Composable</code> å‡½æ•°ï¼Œæ¡†æ¶å³å¯æ•è·æ‰€æœ‰å†…å®¹ï¼šå¸ƒå±€å±‚çº§ã€ä¿®é¥°ç¬¦ã€æ–‡æœ¬æ ·å¼ã€å›¾åƒã€åŠ¨ç”»ï¼Œç”šè‡³è§¦æ‘¸å¤„ç†ç¨‹åºã€‚</p>
<p>å…¶ç‹¬ç‰¹ä¹‹å¤„åœ¨äºï¼Œæ•è·çš„æ–‡æ¡£æ˜¯è‡ªåŒ…å«çš„ã€‚å®ƒåŒ…å«å½¢çŠ¶ã€é¢œè‰²ã€æ¸å˜å’Œé˜´å½±ç­‰è§†è§‰å…ƒç´ ï¼Œä»¥åŠå¸¦æœ‰å­—ç¬¦ä¸²ã€å­—ä½“ã€å¤§å°å’Œæ ·å¼çš„æ–‡æœ¬ã€‚å›¾åƒå¯ä»¥åµŒå…¥ä¸ºä½å›¾æˆ– URL ä»¥å®ç°å»¶è¿ŸåŠ è½½ã€‚å¸ƒå±€ä¿¡æ¯æ¶µç›–å¤§å°ã€ä½ç½®ã€å†…è¾¹è·å’Œå¯¹é½æ–¹å¼ã€‚äº¤äº’å®šä¹‰äº†è§¦æ‘¸åŒºåŸŸã€ç‚¹å‡»å¤„ç†ç¨‹åºå’Œå‘½åæ“ä½œã€‚çŠ¶æ€å˜é‡å¯ä»¥åœ¨è¿è¡Œæ—¶æ›´æ–°ï¼ŒåŠ¨ç”»åˆ™é€šè¿‡åŸºäºæ—¶é—´çš„è¿åŠ¨è¡¨è¾¾å¼æ¥è¡¨è¾¾ã€‚</p>
<p>æ¥æ”¶æ–¹æ— éœ€è®¿é—®ä½ çš„ä»£ç åº“ï¼Œåªéœ€è®¿é—®æ–‡æ¡£å­—èŠ‚å³å¯ã€‚è¿™ä¸å…¶ä»–æœåŠ¡å™¨é©±åŠ¨çš„ UI æ–¹æ³•æœ‰ç€æœ¬è´¨åŒºåˆ«ï¼Œåœ¨å…¶ä»–æ–¹æ³•ä¸­ï¼Œå®¢æˆ·ç«¯éœ€è¦ç†è§£æ¶æ„æˆ–æ‹¥æœ‰é¢„æ„å»ºçš„ç»„ä»¶ã€‚</p>
<p><strong>æ–‡æ¡£æ’­æ”¾ï¼šæ— éœ€ç¼–è¯‘å³å¯æ¸²æŸ“</strong></p>
<p>æ’­æ”¾é˜¶æ®µæ¥æ”¶åºåˆ—åŒ–çš„æ–‡æ¡£å¹¶å°†å…¶æ¸²æŸ“åˆ°å±å¹•ä¸Šã€‚æ’­æ”¾å™¨ä¼šéå†ä¸€ç³»åˆ—æ“ä½œï¼Œå¯¹ Canvas æ‰§è¡Œæ¯ä¸ªæ“ä½œã€‚å…¶æ¦‚å¿µç±»ä¼¼äºè§†é¢‘æ’­æ”¾å™¨è§£ç å¸§çš„æ–¹å¼ï¼Œåªä¸è¿‡æˆ‘ä»¬è§£ç çš„æ˜¯ç»˜å›¾æŒ‡ä»¤è€Œä¸æ˜¯åƒç´ ã€‚</p>
<p>RemoteCompose æä¾›ä¸¤ç§æ¸²æŸ“åç«¯ä»¥æ»¡è¶³ä¸åŒçš„æ¶æ„éœ€æ±‚ã€‚åŸºäº Compose çš„æ’­æ”¾å™¨æ¨èç”¨äºç°ä»£åº”ç”¨ç¨‹åºï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">DynamicScreen</span><span class="hljs-params">(document: <span class="hljs-type">CoreDocument</span>)</span></span> {
    RemoteDocumentPlayer(
        document = document,
        documentWidth = screenWidth,
        documentHeight = screenHeight,
        modifier = Modifier.fillMaxSize(),
        onNamedAction = { name, value, stateUpdater -&gt;
            <span class="hljs-comment">// Handle named actions from the document</span>
            <span class="hljs-keyword">when</span> (name) {
                <span class="hljs-string">"addToCart"</span> -&gt; cartManager.addItem(value)
                <span class="hljs-string">"navigate"</span> -&gt; navController.navigate(value)
                <span class="hljs-string">"trackEvent"</span> -&gt; analytics.logEvent(value)
            }
        },
        bitmapLoader = rememberBitmapLoader()  <span class="hljs-comment">// For lazy image loading</span>
    )
}
</code></pre>
<p>åŸºäº Compose çš„æ’­æ”¾å™¨å¯ä»¥è‡ªç„¶åœ°ä¸ä½ ç°æœ‰çš„ Compose UI é›†æˆã€‚å®ƒæ˜¯ä¸€ä¸ªå¯ç»„åˆçš„å‡½æ•°ï¼Œä½ å¯ä»¥å°†å…¶æ”¾ç½®åœ¨ç»„åˆå±‚çº§ç»“æ„ä¸­çš„ä»»ä½•ä½ç½®ï¼Œå¹¶åƒå…¶ä»–å¯ç»„åˆå‡½æ•°ä¸€æ ·å¯¹å…¶åº”ç”¨ä¿®é¥°ç¬¦å’ŒåŠ¨ç”»ã€‚</p>
<p>ä¸ºäº†ä¸ç°æœ‰çš„ View å±‚çº§ç»“æ„å…¼å®¹ï¼Œæˆ‘ä»¬è¿˜æä¾›äº†ä¸€ä¸ªåŸºäº View çš„æ’­æ”¾å™¨ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LegacyActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> player: RemoteComposePlayer

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        player = RemoteComposePlayer(<span class="hljs-keyword">this</span>)
        setContentView(player)

        <span class="hljs-comment">// Load document from network</span>
        lifecycleScope.launch {
            <span class="hljs-keyword">val</span> bytes = api.fetchDocument(<span class="hljs-string">"home-screen"</span>)
            player.setDocument(bytes)
        }

        player.onNamedAction { name, value, stateUpdater -&gt;
            <span class="hljs-comment">// Handle actions</span>
        }
    }
}
</code></pre>
<p>ä¸¤ç§æ’­æ”¾å™¨æä¾›ç›¸åŒçš„æ¸²æŸ“ä¿çœŸåº¦ï¼›é€‰æ‹©å“ªç§å–å†³äºä½ çš„åº”ç”¨ç¨‹åºæ¶æ„ã€‚å¦‚æœä½ å®Œå…¨ä½¿ç”¨ Composeï¼Œè¯·ä½¿ç”¨å¯ç»„åˆæ’­æ”¾å™¨ã€‚å¦‚æœä½ æ˜¯ä» Views è¿ç§»è¿‡æ¥çš„ï¼Œæˆ–è€…å°†å…¶åµŒå…¥åˆ° View å±‚çº§ç»“æ„ä¸­ï¼Œè¯·ä½¿ç”¨åŸºäº View çš„æ’­æ”¾å™¨ã€‚</p>
<h3 data-id="heading-3"><strong>æ“ä½œæ¨¡å‹ï¼šä¸€å¥—å…¨é¢çš„ç»˜å›¾è¯æ±‡è¡¨</strong></h3>
<p>RemoteCompose çš„ä¼˜åŠ¿åœ¨äºå…¶å…¨é¢çš„æ“ä½œæ¨¡å‹ã€‚è¯¥æ¡†æ¶å®šä¹‰äº† 93 ç§ä»¥ä¸Šçš„ä¸åŒæ“ä½œï¼Œæ¶µç›–äº† UI æ¸²æŸ“çš„æ–¹æ–¹é¢é¢ã€‚è¿™å¹¶ééšæ„è®¾å®šçš„æ•°å­—ï¼Œè€Œæ˜¯è¡¨è¾¾ä»»ä½• Canvas ç»˜å›¾æ“ä½œæ‰€éœ€çš„å®Œæ•´è¯æ±‡è¡¨ã€‚</p>
<p><strong>æ“ä½œçš„é‡è¦æ€§</strong></p>
<p>ä¼ ç»Ÿçš„æœåŠ¡å™¨é©±åŠ¨å‹ UI å‘é€çš„æ˜¯é«˜çº§ç»„ä»¶æè¿°ï¼šâ€œæ¸²æŸ“ä¸€ä¸ªå¸¦æœ‰æ–‡æœ¬â€˜æäº¤â€™çš„æŒ‰é’®â€ã€‚å®¢æˆ·ç«¯å¿…é¡»è§£æè¿™äº›æè¿°å¹¶å°†å…¶æ˜ å°„åˆ°åŸç”Ÿç»„ä»¶ã€‚è¿™å¯¼è‡´æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´ç´§å¯†è€¦åˆï¼›åŒæ–¹å¿…é¡»å°±â€œæŒ‰é’®â€çš„å®šä¹‰åŠå…¶è¡Œä¸ºè¾¾æˆä¸€è‡´ã€‚</p>
<p>RemoteCompose åˆ™åœ¨æ›´åº•å±‚è¿è¡Œï¼šå®ƒä¸å‘é€â€œæ¸²æŸ“ä¸€ä¸ªæŒ‰é’®â€è¿™æ ·çš„æè¿°ï¼Œè€Œæ˜¯å‘é€å®é™…çš„ç»˜å›¾æŒ‡ä»¤ï¼šâ€œåœ¨è¿™äº›åæ ‡å¤„ç»˜åˆ¶ä¸€ä¸ªå¸¦æœ‰è¿™ç§é¢œè‰²çš„åœ†è§’çŸ©å½¢ï¼Œç„¶ååœ¨è¿™ä¸ªä½ç½®ç»˜åˆ¶å¸¦æœ‰è¿™ç§å­—ä½“çš„æ–‡æœ¬â€˜æäº¤â€™â€ã€‚å®¢æˆ·ç«¯æ— éœ€äº†è§£â€œæŒ‰é’®â€çš„å®šä¹‰ï¼›å®ƒåªéœ€æ‰§è¡Œç»˜å›¾æ“ä½œå³å¯ã€‚</p>
<p>è¿™ç§åº•å±‚æ–¹æ³•æ„ä¹‰æ·±è¿œã€‚ç”±äºæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯æ— éœ€å°±ç»„ä»¶å®šä¹‰è¾¾æˆä¸€è‡´ï¼Œå› æ­¤æ— éœ€è¿›è¡Œæ¨¡å¼åŒæ­¥ã€‚ç”±äº Compose ä¸­æ‰€æœ‰å¯èƒ½çš„è§†è§‰æ•ˆæœå‡å¯æ•è·ï¼Œå› æ­¤èƒ½å¤Ÿå®Œæ•´ä¿ç•™è§†è§‰ä¿çœŸåº¦ã€‚ç”±äºæ–°çš„è§†è§‰è®¾è®¡å¯åœ¨æ—§å®¢æˆ·ç«¯ä¸Šè¿è¡Œï¼ˆå®ƒä»¬åªæ˜¯ä¸åŒçš„ç»˜åˆ¶æ“ä½œï¼‰ï¼Œå› æ­¤å†…ç½®äº†å‘å‰å…¼å®¹æ€§ã€‚è‡ªå®šä¹‰ç»„ä»¶æ— éœ€æ³¨å†Œå³å¯è‡ªåŠ¨è¿è¡Œã€‚</p>
<p><strong>ç»˜åˆ¶æ“ä½œ</strong></p>
<p>ç»˜åˆ¶æ“ä½œæ•è· Canvas ç»˜åˆ¶è°ƒç”¨ï¼Œè¿™æ˜¯ 2D å›¾å½¢çš„åŸºæœ¬å›¾å…ƒã€‚è¿™äº›å›¾å…ƒåŒ…æ‹¬ï¼šç”¨äºæŒ‰é’®ã€å¡ç‰‡å’ŒèƒŒæ™¯çš„çŸ©å½¢çš„ <code>DRAW_RECT</code>ï¼›ç”¨äºå¸¦æœ‰åœ†è§’çš„ Material æ›²é¢çš„ <code>DRAW_ROUND_RECT</code>ï¼›ç”¨äºå¤´åƒå’ŒæŒ‡ç¤ºå™¨çš„ <code>DRAW_CIRCLE</code>ï¼›ç”¨äºæ¸²æŸ“å¸¦æœ‰å®Œæ•´æ ·å¼çš„æ–‡æœ¬çš„ <code>DRAW_TEXT</code>ï¼›ç”¨äºæ²¿æ›²çº¿ç»˜åˆ¶æ–‡æœ¬çš„ <code>DRAW_TEXT_ON_PATH</code>ï¼›ä»¥åŠç”¨äºå›¾åƒçš„ <code>DRAW_BITMAP</code>ã€‚ <code>DRAW_TWEEN_PATH</code> ç”¨äºåŠ¨ç”»è·¯å¾„å˜å½¢ï¼Œç­‰ç­‰ã€‚</p>
<p>æ¯ä¸ªæ“ä½œéƒ½åŒ…å«æ‰§è¡Œå®ƒæ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ï¼šåæ ‡ã€é¢œè‰²ã€ç»˜åˆ¶æ ·å¼ä»¥åŠå¯¹æ–‡æ¡£ä¸­å…¶ä»–ä½ç½®å­˜å‚¨çš„æ•°æ®ï¼ˆä¾‹å¦‚æ–‡æœ¬å­—ç¬¦ä¸²æˆ–ä½å›¾ï¼‰çš„å¼•ç”¨ã€‚</p>
<p><strong>å¸ƒå±€æ“ä½œ</strong></p>
<p>å¸ƒå±€æ“ä½œå®šä¹‰ç»„ä»¶å±‚æ¬¡ç»“æ„å’Œç©ºé—´å…³ç³»ã€‚<code>Component</code> æ“ä½œå£°æ˜ä¸€ä¸ªå¸ƒå±€ç»„ä»¶ï¼Œè€Œ <code>Container</code> æ“ä½œåˆ›å»ºä¸€ä¸ªç±»ä¼¼äº <code>Column</code> æˆ– <code>Row</code> çš„å®¹å™¨ï¼Œ<code>ContainerEnd</code> æ“ä½œåˆ™å…³é—­å®ƒã€‚<code>LoopOperation</code> æ“ä½œç”¨äºå¾ªç¯åˆ—è¡¨å†…å®¹ã€‚<code>Modifier</code> åŒ…æ‹¬ç”¨äºèƒŒæ™¯é¢œè‰²å’Œå¯ç»˜åˆ¶å¯¹è±¡çš„ <code>BackgroundModifier</code>ã€ç”¨äºè¾¹æ¡†æ ·å¼çš„ <code>BorderModifier</code>ã€ç”¨äºå†…éƒ¨é—´è·çš„ <code>PaddingModifier</code> ä»¥åŠç”¨äºè§¦æ‘¸å¤„ç†çš„ <code>ClickModifier</code>ã€‚</p>
<p>å®¹å™¨æ¨¡å‹é‡‡ç”¨æ¨é€/å¼¹å‡ºæœºåˆ¶ã€‚å½“æ’­æ”¾å™¨é‡åˆ° <code>Container</code> æ“ä½œæ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¸ƒå±€ä¸Šä¸‹æ–‡ã€‚æ‰€æœ‰åç»­æ“ä½œéƒ½å°†åœ¨è¯¥ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œç›´åˆ° <code>ContainerEnd</code> æ“ä½œå°†å…¶å¼¹å‡ºã€‚è¿™ä¸ Compose çš„å¸ƒå±€ç³»ç»Ÿçš„å·¥ä½œæ–¹å¼ç±»ä¼¼ã€‚</p>
<p><strong>çŠ¶æ€å’Œè¡¨è¾¾å¼æ“ä½œ</strong></p>
<p>çŠ¶æ€æ“ä½œæ”¯æŒè¿è¡Œæ—¶å¯æ›´æ”¹çš„åŠ¨æ€å€¼ã€‚<code>NamedVariable</code> å£°æ˜ä¸€ä¸ªå‘½åçš„çŠ¶æ€å˜é‡ã€‚<code>ColorAttribute</code> æä¾›å¯è‡ªå®šä¹‰ä¸»é¢˜çš„é¢œè‰²ã€‚<code>TimeAttribute</code> å¼•ç”¨åŠ¨ç”»æ—¶é—´ã€‚<code>FloatExpression</code> å’Œ <code>IntegerExpression</code> æ¯å¸§è®¡ç®—æ•°å­¦è¡¨è¾¾å¼ã€‚<code>ConditionalOp</code> æ”¯æŒåŸºäºçŠ¶æ€çš„æ¡ä»¶æ¸²æŸ“ã€‚</p>
<p>è¡¨è¾¾å¼ç³»ç»ŸåŠŸèƒ½å¼ºå¤§ã€‚ä½ å¯ä»¥åµŒå…¥å…¬å¼ï¼Œè€Œä¸æ˜¯é™æ€å€¼ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// These expressions are evaluated every frame</span>
<span class="hljs-keyword">val</span> opacity = FloatExpression(<span class="hljs-string">"sin(time * 2) * 0.5 + 0.5"</span>)  <span class="hljs-comment">// Pulsing effect</span>
<span class="hljs-keyword">val</span> rotation = FloatExpression(<span class="hljs-string">"time * 90 % 360"</span>)

<span class="hljs-comment">// Continuous rotation</span>
<span class="hljs-keyword">val</span> position = FloatExpression(<span class="hljs-string">"lerp(0, 100, time / 2)"</span>)

<span class="hljs-comment">// Linear interpolation</span>
</code></pre>
<p>è¿™ä½¿å¾—å®Œå…¨åœ¨æ–‡æ¡£ä¸­å®šä¹‰ä¸°å¯Œçš„åŠ¨ç”»æˆä¸ºå¯èƒ½â€”â€”æ— éœ€å®¢æˆ·ç«¯åŠ¨ç”»ä»£ç ã€‚
â€‹â€‹
<strong>äº¤äº’æ“ä½œ</strong></p>
<p>äº¤äº’æ“ä½œå¤„ç†ç”¨æˆ·è¾“å…¥ã€‚<code>TouchOperation</code> å®šä¹‰è§¦æ‘¸åŒºåŸŸï¼Œè€Œ <code>CLICK_AREA</code> å¤„ç†ç®€å•çš„ç‚¹å‡»æ“ä½œã€‚<code>ParticlesCreate</code> åˆå§‹åŒ–ç²’å­ç³»ç»Ÿï¼Œ<code>ParticlesLoop</code> é©±åŠ¨ç²’å­åŠ¨ç”»ã€‚</p>
<p>è§¦æ‘¸æ“ä½œæ³¨å†Œå¸¦æœ‰å‘½åæ“ä½œçš„çŸ©å½¢åŒºåŸŸã€‚å½“ç”¨æˆ·ç‚¹å‡»æŸä¸ªåŒºåŸŸæ—¶ï¼Œæ’­æ”¾å™¨ä¼šè§¦å‘ç›¸åº”çš„æ“ä½œï¼Œå®¿ä¸»åº”ç”¨ç¨‹åºä¼šé€šè¿‡å›è°ƒå‡½æ•°æ¥å¤„ç†è¿™äº›æ“ä½œã€‚è¿™ç§è®¾è®¡æ—¢ä¿æŒäº†æ–‡æ¡£æ ¼å¼çš„ç®€æ´æ€§ï¼Œåˆå®ç°äº†ä¸°å¯Œçš„äº¤äº’åŠŸèƒ½ã€‚</p>
<h3 data-id="heading-4">åŠ¨æ€å±å¹•è®¾è®¡çš„ä¼˜åŠ¿</h3>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡å¸¸è§åº”ç”¨åœºæ™¯ä¸­çš„çœŸå®æ¡ˆä¾‹ï¼Œæ¥æ¢è®¨ RemoteCompose ä¸ºåŠ¨æ€å±å¹•è®¾è®¡å¸¦æ¥çš„åˆ‡å®ä¼˜åŠ¿ã€‚</p>
<p><strong>æœåŠ¡å™¨é©±åŠ¨ UIï¼Œæ€§èƒ½æ¯«ä¸å¦¥å</strong></p>
<p>ä¼ ç»Ÿçš„æœåŠ¡å™¨é©±åŠ¨ UI æ–¹æ³•éœ€è¦æƒè¡¡å–èˆã€‚åŸºäº JSON çš„å¸ƒå±€è¡¨è¾¾èƒ½åŠ›æœ‰é™ï¼Œæ— æ³•å®ç°å¤æ‚çš„åŠ¨ç”»æˆ–è‡ªå®šä¹‰ç»˜åˆ¶ã€‚WebView ä¼šå¸¦æ¥æ€§èƒ½å¼€é”€ã€å¤–è§‚ä¸ä¸€è‡´ä»¥åŠæ›´é«˜çš„å†…å­˜å ç”¨ã€‚è‡ªå®šä¹‰ DSL åˆ™ä¼šå¢åŠ ç»´æŠ¤è´Ÿæ‹…ã€å­¦ä¹ æ›²çº¿ï¼Œå¹¶ä¸”å¯¹é¢„å®šä¹‰ç»„ä»¶æœ‰æ‰€é™åˆ¶ã€‚</p>
<p>RemoteCompose æä¾›äº†ç¬¬ä¸‰æ¡è·¯å¾„ï¼šä»æœåŠ¡å™¨å®šä¹‰çš„å¸ƒå±€è¿›è¡ŒåŸç”Ÿ Compose æ¸²æŸ“ã€‚ä½ æ—¢èƒ½å……åˆ†åˆ©ç”¨ Compose æ¸²æŸ“å¼•æ“çš„å¼ºå¤§åŠŸèƒ½ï¼Œåˆèƒ½äº«å—æœåŠ¡å™¨é©±åŠ¨å†…å®¹çš„çµæ´»æ€§ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä¸€ä¸ªç”µå•†åº”ç”¨éœ€è¦é¢‘ç¹æ›´æ–°äº§å“å¡ç‰‡ã€æ·»åŠ æ–°çš„å¾½ç« æ ·å¼ã€ä¿ƒé”€å åŠ å±‚æˆ–å­£èŠ‚æ€§ä¸»é¢˜ã€‚å€ŸåŠ© RemoteComposeï¼ŒæœåŠ¡å™¨ç«¯å…è®¸è¥é”€å›¢é˜Ÿæ— éœ€å‘å¸ƒåº”ç”¨å³å¯æ›´æ–°å¡ç‰‡è®¾è®¡ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Server-side: We can update card designs without app release</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">ProductCard</span><span class="hljs-params">(product: <span class="hljs-type">Product</span>)</span></span> {
    Card(
        modifier = RemoteModifier
            .fillMaxWidth()
            .clickable { namedAction(<span class="hljs-string">"viewProduct"</span>, product.id) }
    ) {
        Box {
            <span class="hljs-comment">// Product image with gradient overlay</span>
            AsyncImage(
                url = product.imageUrl,
                modifier = RemoteModifier.fillMaxWidth().aspectRatio(<span class="hljs-number">1.5f</span>)
            )

            <span class="hljs-comment">// Promotional badge - can be A/B tested server-side</span>
            <span class="hljs-keyword">if</span> (product.hasPromotion) {
                PromotionalBadge(
                    text = product.promotionText,
                    modifier = RemoteModifier.align(Alignment.TopEnd)
                )
            }

            <span class="hljs-comment">// Price with sale styling</span>
            PriceTag(
                originalPrice = product.originalPrice,
                salePrice = product.salePrice,
                modifier = RemoteModifier.align(Alignment.BottomStart)
            )
        }
    }
}
</code></pre>
<p>å®¢æˆ·ç«¯åªéœ€æ¸²æŸ“æœåŠ¡å™¨å‘é€çš„å†…å®¹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Client-side: Just renders whatever the server sends</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">ProductGrid</span><span class="hljs-params">(viewModel: <span class="hljs-type">ProductViewModel</span>)</span></span> {
    <span class="hljs-keyword">val</span> documents <span class="hljs-keyword">by</span> viewModel.productDocuments.collectAsState()

    LazyVerticalGrid(columns = GridCells.Fixed(<span class="hljs-number">2</span>)) {
        items(documents) { document -&gt;
            RemoteDocumentPlayer(
                document = document,
                onNamedAction = { name, value, _ -&gt;
                    <span class="hljs-keyword">if</span> (name == <span class="hljs-string">"viewProduct"</span>) {
                        navController.navigate(<span class="hljs-string">"product/<span class="hljs-variable">$value</span>"</span>)
                    }
                }
            )
        }
    }
}
</code></pre>
<p>ç°åœ¨ï¼Œä½ çš„å›¢é˜Ÿæ— éœ€å‘å¸ƒä»»ä½•åº”ç”¨å³å¯æ›´æ–°äº§å“å¡ç‰‡è®¾è®¡ï¼Œæ›´æ”¹å¾½ç« é¢œè‰²ã€æ·»åŠ åŠ¨ç”»å’Œé‡æ–°æ’åˆ—å…ƒç´ ã€‚ç”±äºå®ƒæ˜¯åŸç”Ÿåº”ç”¨ï¼Œé€šè¿‡ Compose çš„å®é™…ç»˜åˆ¶ç®¡é“æ¸²æŸ“ï¼Œå› æ­¤ UI çš„å¤–è§‚å’Œä½“éªŒä¸åŸç”Ÿåº”ç”¨æ— å¼‚ã€‚</p>
<h3 data-id="heading-5">å¤§è§„æ¨¡ A/B æµ‹è¯•</h3>
<p>ä¼ ç»Ÿçš„ A/B æµ‹è¯• UI å˜ä½“éœ€è¦åœ¨åº”ç”¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­å®ç°æ‰€æœ‰å˜ä½“ï¼Œä¸ºæ¯ä¸ªå˜ä½“åˆ›å»ºåŠŸèƒ½æ ‡å¿—ï¼Œå‘å¸ƒåŒ…å«æ‰€æœ‰å˜ä½“çš„åº”ç”¨ï¼Œç„¶åç­‰å¾…ç”¨æˆ·é‡‡ç”¨åå†è¡¡é‡ç»“æœã€‚ä»æ„æ€åˆ°è·å¾—æ•°æ®ï¼Œè¿™ä¸ªè¿‡ç¨‹é€šå¸¸éœ€è¦ 2-4 å‘¨ã€‚</p>
<p>å€ŸåŠ© RemoteComposeï¼Œä½ æ— éœ€éƒ¨ç½²ä»»ä½•å®¢æˆ·ç«¯å³å¯æµ‹è¯• UI å˜ä½“ã€‚å‡è®¾ä¸€ä¸ªç”µå•†å›¢é˜Ÿæƒ³è¦æµ‹è¯•å•é¡µç»“è´¦æµç¨‹æ˜¯å¦æ¯”å¤šæ­¥éª¤å‘å¯¼è½¬åŒ–ç‡æ›´é«˜ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Server-side: Two completely different checkout experiences</span>
<span class="hljs-keyword">object</span> CheckoutExperiments {

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getCheckoutDocument</span><span class="hljs-params">(user: <span class="hljs-type">User</span>, cart: <span class="hljs-type">Cart</span>)</span></span>: ByteArray {
        <span class="hljs-keyword">val</span> variant = experimentService.getVariant(user.id, <span class="hljs-string">"checkout-flow"</span>)

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">when</span> (variant) {
            <span class="hljs-string">"single-page"</span> -&gt; captureSinglePageCheckout(cart)
            <span class="hljs-string">"multi-step"</span> -&gt; captureMultiStepCheckout(cart)
            <span class="hljs-string">"express"</span> -&gt; captureExpressCheckout(cart)  <span class="hljs-comment">// New variant added without app update</span>
            <span class="hljs-keyword">else</span> -&gt; captureSinglePageCheckout(cart)
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">captureSinglePageCheckout</span><span class="hljs-params">(cart: <span class="hljs-type">Cart</span>)</span></span>: ByteArray {
        <span class="hljs-keyword">return</span> captureRemoteDocument(context, displayInfo, profile) {
            SinglePageCheckout(
                cart = cart,
                onPlaceOrder = { namedAction(<span class="hljs-string">"placeOrder"</span>, cart.id) },
                onUpdateQuantity = { itemId, qty -&gt;
                    namedAction(<span class="hljs-string">"updateQuantity"</span>, <span class="hljs-string">"<span class="hljs-variable">$itemId</span>:<span class="hljs-variable">$qty</span>"</span>)
                }
            )
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">captureMultiStepCheckout</span><span class="hljs-params">(cart: <span class="hljs-type">Cart</span>)</span></span>: ByteArray {
        <span class="hljs-keyword">return</span> captureRemoteDocument(context, displayInfo, profile) {
            MultiStepCheckout(
                cart = cart,
                steps = listOf(<span class="hljs-string">"Shipping"</span>, <span class="hljs-string">"Payment"</span>, <span class="hljs-string">"Review"</span>),
                onComplete = { namedAction(<span class="hljs-string">"placeOrder"</span>, cart.id) }
            )
        }
    }
}
</code></pre>
<p>å®¢æˆ·ç«¯å®Œå…¨ä¸çŸ¥é“æ˜¾ç¤ºçš„æ˜¯å“ªä¸ªç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Client-side: Completely agnostic to which variant is shown</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">CheckoutScreen</span><span class="hljs-params">(viewModel: <span class="hljs-type">CheckoutViewModel</span>)</span></span> {
    <span class="hljs-keyword">val</span> document <span class="hljs-keyword">by</span> viewModel.checkoutDocument.collectAsState()

    document?.let { doc -&gt;
        RemoteDocumentPlayer(
            document = doc,
            onNamedAction = { name, value, stateUpdater -&gt;
                <span class="hljs-keyword">when</span> (name) {
                    <span class="hljs-string">"placeOrder"</span> -&gt; viewModel.placeOrder(value)
                    <span class="hljs-string">"updateQuantity"</span> -&gt; {
                        <span class="hljs-keyword">val</span> (itemId, qty) = value.split(<span class="hljs-string">":"</span>)
                        viewModel.updateQuantity(itemId, qty.toInt())
                    }
                }
            }
        )
    }
}
</code></pre>
<p>ç»“æœå³æ—¶ä¸”å®æ—¶ï¼Œè¿™æ„å‘³ç€æ— éœ€ç­‰å¾…åº”ç”¨å•†åº—å®¡æ ¸æˆ–ç”¨æˆ·åé¦ˆã€‚ä½ ç”šè‡³å¯ä»¥æ·»åŠ å…¨æ–°çš„ç‰ˆæœ¬ï¼Œä¾‹å¦‚â€œå¿«é€Ÿç»“è´¦â€ï¼Œè€Œæ— éœ€å¯¹å®¢æˆ·ç«¯è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚å®éªŒä¼šæŒç»­è¿è¡Œï¼Œç›´åˆ°è·å¾—ç»Ÿè®¡å­¦æ„ä¹‰ä¸Šçš„æ˜¾è‘—æ€§ï¼Œç„¶åå°†è·èƒœç‰ˆæœ¬æ¨å¹¿åˆ°æ‰€æœ‰ç”¨æˆ·ï¼ŒåŒæ ·æ— éœ€å‘å¸ƒæ–°åº”ç”¨ã€‚</p>
<h3 data-id="heading-6">å®æ—¶å†…å®¹æ›´æ–°</h3>
<p>å†…å®¹å¯†é›†å‹åº”ç”¨å¸¸å¸¸éœ€è¦åœ¨åŸç”Ÿæ€§èƒ½å’Œå†…å®¹æ–°é²œåº¦ä¹‹é—´å¯»æ±‚å¹³è¡¡ã€‚ä»¥æ–°é—»åº”ç”¨ä¸ºä¾‹ï¼šæ–‡ç« éœ€è¦ä¸°å¯Œçš„æ ¼å¼ã€åµŒå…¥å¼åª’ä½“å’Œäº¤äº’å…ƒç´ ï¼Œä½†åŒæ—¶ä¹Ÿéœ€è¦éšç€æ–°é—»äº‹ä»¶çš„è¿›å±•å®æ—¶æ›´æ–°ã€‚</p>
<p>ä¸€å®¶æŠ¥é“é‡å¤§äº‹ä»¶çš„æ–°é—»æœºæ„éœ€è¦å®æ—¶æ›´æ–°æ–‡ç« å¸ƒå±€ã€‚ç¼–è¾‘å›¢é˜Ÿå¯ä»¥æ ¹æ®æ–°é—»äº‹ä»¶çš„è¿›å±•è°ƒæ•´å¸ƒå±€ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Server-side: Editorial team can update layout as story develops</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ArticleLayoutService</span> {

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getArticleDocument</span><span class="hljs-params">(article: <span class="hljs-type">Article</span>)</span></span>: ByteArray {
        <span class="hljs-keyword">return</span> captureRemoteDocument(context, displayInfo, profile) {
            ArticleLayout(article)
        }
    }

    <span class="hljs-meta">@Composable</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">ArticleLayout</span><span class="hljs-params">(article: <span class="hljs-type">Article</span>)</span></span> {
        Column(modifier = RemoteModifier.fillMaxSize().padding(<span class="hljs-number">16.</span>dp)) {
            <span class="hljs-comment">// Breaking news banner - can be added/removed instantly</span>
            <span class="hljs-keyword">if</span> (article.isBreaking) {
                BreakingNewsBanner(
                    modifier = RemoteModifier.fillMaxWidth()
                )
            }

            <span class="hljs-comment">// Headline with dynamic styling</span>
            Text(
                text = article.headline,
                style = <span class="hljs-keyword">if</span> (article.isBreaking) {
                    HeadlineStyle.Breaking
                } <span class="hljs-keyword">else</span> {
                    HeadlineStyle.Standard
                }
            )

            <span class="hljs-comment">// Live updates indicator</span>
            <span class="hljs-keyword">if</span> (article.hasLiveUpdates) {
                LiveUpdatesIndicator(
                    lastUpdate = article.lastUpdate,
                    modifier = RemoteModifier.clickable {
                        namedAction(<span class="hljs-string">"refreshArticle"</span>, article.id)
                    }
                )
            }

            <span class="hljs-comment">// Rich content blocks - can include any Compose UI</span>
            article.contentBlocks.forEach { block -&gt;
                <span class="hljs-keyword">when</span> (block) {
                    <span class="hljs-keyword">is</span> TextBlock -&gt; ArticleText(block)
                    <span class="hljs-keyword">is</span> ImageBlock -&gt; ArticleImage(block)
                    <span class="hljs-keyword">is</span> VideoBlock -&gt; VideoEmbed(block)
                    <span class="hljs-keyword">is</span> LiveBlogBlock -&gt; LiveBlogTimeline(block)
                    <span class="hljs-keyword">is</span> InteractiveChartBlock -&gt; DataVisualization(block)
                    <span class="hljs-keyword">is</span> PullQuoteBlock -&gt; PullQuote(block)
                }
            }

            <span class="hljs-comment">// Related articles - layout can be A/B tested</span>
            RelatedArticles(
                articles = article.relatedArticles,
                onArticleClick = { namedAction(<span class="hljs-string">"openArticle"</span>, it.id) }
            )
        }
    }
}
</code></pre>
<p>å®¢æˆ·ç«¯åªéœ€æ¸²æŸ“æœåŠ¡å™¨æä¾›çš„ä»»ä½•å¸ƒå±€ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Client-side: Renders whatever layout the server sends</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">ArticleScreen</span><span class="hljs-params">(articleId: <span class="hljs-type">String</span>, viewModel: <span class="hljs-type">ArticleViewModel</span>)</span></span> {
    <span class="hljs-keyword">val</span> document <span class="hljs-keyword">by</span> viewModel.articleDocument.collectAsState()
    <span class="hljs-keyword">val</span> refreshing <span class="hljs-keyword">by</span> viewModel.isRefreshing.collectAsState()

    SwipeRefresh(
        state = rememberSwipeRefreshState(refreshing),
        onRefresh = { viewModel.refresh() }
    ) {
        document?.let { doc -&gt;
            RemoteDocumentPlayer(
                document = doc,
                onNamedAction = { name, value, _ -&gt;
                    <span class="hljs-keyword">when</span> (name) {
                        <span class="hljs-string">"openArticle"</span> -&gt; navController.navigate(<span class="hljs-string">"article/<span class="hljs-variable">$value</span>"</span>)
                        <span class="hljs-string">"refreshArticle"</span> -&gt; viewModel.refresh()
                        <span class="hljs-string">"playVideo"</span> -&gt; videoPlayer.play(value)
                    }
                }
            )
        }
    }
}
</code></pre>
<p>ä½ çš„å›¢é˜Ÿæ— éœ€ä¿®æ”¹åº”ç”¨å³å¯æ›´æ–°æ–‡ç« å¸ƒå±€ï¼Œæ·»åŠ å®æ—¶åšå®¢æ—¶é—´çº¿ã€åµŒå…¥äº¤äº’å¼å›¾è¡¨å’Œæ›´æ”¹å­—ä½“ã€‚å½“æ–°é—»äº‹ä»¶æœ‰è¿›å±•æ—¶ï¼Œä»–ä»¬å¯ä»¥ç«‹å³åœ¨æ‰€æœ‰ç›¸å…³æ–‡ç« ä¸Šæ·»åŠ â€œçªå‘æ–°é—»â€æ¨ªå¹…ã€‚</p>
<h3 data-id="heading-7">é¿å…ä»£ç è†¨èƒ€çš„åŠŸèƒ½æ ‡å¿—</h3>
<p>ä¼ ç»Ÿçš„åŠŸèƒ½æ ‡å¿—éœ€è¦å°†æ‰€æœ‰å˜ä½“éƒ½åŒ…å«åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Traditional approach - all code ships, even unused variations</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">HomeScreen</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">when</span> {
        featureFlags.newHomeV3 -&gt; NewHomeLayoutV3()  <span class="hljs-comment">// Ships always</span>
        featureFlags.newHomeV2 -&gt; NewHomeLayoutV2()  <span class="hljs-comment">// Ships always</span>
        <span class="hljs-keyword">else</span> -&gt; OldHomeLayout()

        <span class="hljs-comment">// Ships always</span>
    }
}
</code></pre>
<p>è¿™ä¼šå¸¦æ¥å‡ ä¸ªé—®é¢˜ã€‚äºŒè¿›åˆ¶æ–‡ä»¶ä¼šå› ä¸ºåŒ…å«æ‰€æœ‰å˜ä½“è€Œå¢åŠ åº”ç”¨ç¨‹åºçš„å¤§å°ã€‚å³ä½¿æœªä½¿ç”¨ï¼Œä¹Ÿä¼šåŒ…å«æ— ç”¨ä»£ç ã€‚å½“åŠŸèƒ½æ ‡å¿—é…ç½®é”™è¯¯æ—¶ï¼Œå¯èƒ½ä¼šæš´éœ²æœªå‘å¸ƒçš„åŠŸèƒ½ï¼Œä»è€Œå¸¦æ¥å®‰å…¨é£é™©ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ—§çš„å˜ä½“ä¸æ–­ç´¯ç§¯ï¼Œå¯¼è‡´æŠ€æœ¯å€ºåŠ¡ä¸æ–­å¢åŠ ã€‚</p>
<p>ä½¿ç”¨ RemoteComposeï¼Œåªä¼šä¼ è¾“å½“å‰æ¿€æ´»çš„å˜ä½“ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Server-side: Only the active variation exists on the server</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">HomeScreenService</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getHomeDocument</span><span class="hljs-params">(user: <span class="hljs-type">User</span>)</span></span>: ByteArray {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">when</span> (featureFlags.getHomeVariant(user)) {
            <span class="hljs-string">"v3"</span> -&gt; captureHomeV3(user)
            <span class="hljs-string">"v2"</span> -&gt; captureHomeV2(user)
            <span class="hljs-keyword">else</span> -&gt; captureHomeDefault(user)
        }
    }
}

<span class="hljs-comment">// Client-side: No conditional code, no dead code</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">HomeScreen</span><span class="hljs-params">(document: <span class="hljs-type">CoreDocument</span>)</span></span> {
    RemoteDocumentPlayer(document = document)
    <span class="hljs-comment">// That's it. No feature flags, no conditionals.</span>
}
</code></pre>
<p>è¿™æ¶ˆé™¤äº†äºŒè¿›åˆ¶æ–‡ä»¶è†¨èƒ€ï¼Œå› ä¸ºä¸ä¼šä¼ è¾“æ—§çš„å˜ä½“ï¼›ç”±äºåªå­˜åœ¨æœåŠ¡å™¨ç«¯ä»£ç ï¼Œå› æ­¤æ¶ˆé™¤äº†æ— ç”¨ä»£ç ï¼›å¹¶ä¸”ç”±äºé…ç½®é”™è¯¯åªä¼šæ˜¾ç¤ºä¸åŒçš„ UI è€Œä¸æ˜¯æœªå‘å¸ƒçš„ä»£ç ï¼Œå› æ­¤é™ä½äº†å®‰å…¨é£é™©ã€‚</p>
<p>è®¾æƒ³ä¸€ä¸ªç¤¾äº¤åª’ä½“åº”ç”¨æ­£åœ¨é€æ­¥é‡æ–°è®¾è®¡å…¶ä¿¡æ¯æµï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Server-side: Complete control over who sees what</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">FeedLayoutService</span> {

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getFeedDocument</span><span class="hljs-params">(user: <span class="hljs-type">User</span>, posts: <span class="hljs-type">List</span>&lt;<span class="hljs-type">Post</span>&gt;)</span></span>: ByteArray {
        <span class="hljs-keyword">val</span> variant = rolloutService.getFeedVariant(user)

        <span class="hljs-keyword">return</span> captureRemoteDocument(context, displayInfo, profile) {
            <span class="hljs-keyword">when</span> (variant) {
                FeedVariant.NEW_DESIGN -&gt; NewFeedLayout(posts)
                FeedVariant.NEW_DESIGN_COMPACT -&gt; NewFeedCompactLayout(posts)
                FeedVariant.CLASSIC -&gt; ClassicFeedLayout(posts)
            }
        }
    }
}

<span class="hljs-comment">// Rollout service controls the percentage</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RolloutService</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getFeedVariant</span><span class="hljs-params">(user: <span class="hljs-type">User</span>)</span></span>: FeedVariant {
        <span class="hljs-comment">// 5% get new design, 5% get compact variant, 90% get classic</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">when</span> {
            user.id.hashCode() % <span class="hljs-number">100</span> &lt; <span class="hljs-number">5</span> -&gt; FeedVariant.NEW_DESIGN
            user.id.hashCode() % <span class="hljs-number">100</span> &lt; <span class="hljs-number">10</span> -&gt; FeedVariant.NEW_DESIGN_COMPACT
            <span class="hljs-keyword">else</span> -&gt; FeedVariant.CLASSIC
        }
    }

    <span class="hljs-comment">// Instant rollback if issues are detected</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">emergencyRollback</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// All users immediately get classic layout</span>
        <span class="hljs-comment">// No app update needed</span>
    }
}
</code></pre>
<p>å¦‚æœæ–°è®¾è®¡å¯¼è‡´é—®é¢˜ï¼ˆä¾‹å¦‚å´©æºƒã€ç”¨æˆ·äº’åŠ¨åº¦ä¸‹é™æˆ–ç”¨æˆ·æŠ•è¯‰ï¼‰ï¼Œå¯ä»¥ç«‹å³å›æ»šã€‚åªéœ€æ›´æ”¹æœåŠ¡å™¨é…ç½®å³å¯ã€‚æ— éœ€ç´§æ€¥å‘å¸ƒåº”ç”¨ã€‚</p>
<h3 data-id="heading-8">è·¨å¹³å°ä¸€è‡´æ€§</h3>
<p>RemoteCompose çš„æ–‡æ¡£æ ¼å¼ä¸å¹³å°æ— å…³ã€‚åŒä¸€æ–‡æ¡£å¯ä»¥åœ¨æ‰‹æœºã€å¹³æ¿ç”µè„‘ã€æŠ˜å å±è®¾å¤‡å’Œ Wear OS è®¾å¤‡ä¸Šæ¸²æŸ“ï¼Œå¹¶ç”±ç›¸åº”çš„å¹³å°æ’­æ”¾å™¨è´Ÿè´£æ¸²æŸ“ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">Creation (Server/Backend)  
    â†“  
RemoteComposeBuffer (Platform-independent binary format)  
    â†“  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  
â”‚

â”‚
â†“

â†“

â†“

â†“
Android Phone

Android Tablet

Foldable Device

Wear OS
(Compose Player) (Compose Player)  (Compose Player)   (Wear Player)
</code></pre>
<p>å‡è®¾ä¸€æ¬¾å¥èº«åº”ç”¨åœ¨æ‰‹æœºå’Œæ‰‹è¡¨åº”ç”¨ä¸Šéƒ½æ˜¾ç¤ºé”»ç‚¼æ€»ç»“ã€‚ç›¸åŒçš„æ•°æ®ä¼šé’ˆå¯¹ä¸åŒçš„è®¾å¤‡å°ºå¯¸è¿›è¡Œä¼˜åŒ–ï¼Œå‘ˆç°ä¸åŒçš„å†…å®¹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Server-side: Same data, different presentations</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">WorkoutSummaryService</span> {

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getPhoneDocument</span><span class="hljs-params">(workout: <span class="hljs-type">Workout</span>)</span></span>: ByteArray {
        <span class="hljs-keyword">return</span> captureRemoteDocument(context, phoneDisplayInfo, profile) {
            PhoneWorkoutSummary(workout)  <span class="hljs-comment">// Full detailed view</span>
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getWatchDocument</span><span class="hljs-params">(workout: <span class="hljs-type">Workout</span>)</span></span>: ByteArray {
        <span class="hljs-keyword">return</span> captureRemoteDocument(context, watchDisplayInfo, profile) {
            WatchWorkoutSummary(workout)  <span class="hljs-comment">// Glanceable summary</span>
        }
    }

    <span class="hljs-meta">@Composable</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">PhoneWorkoutSummary</span><span class="hljs-params">(workout: <span class="hljs-type">Workout</span>)</span></span> {
        Column {
            WorkoutHeader(workout)
            HeartRateChart(workout.heartRateData)
            PaceChart(workout.paceData)
            SplitsTable(workout.splits)
            MapView(workout.route)
            ShareButton { namedAction(<span class="hljs-string">"share"</span>, workout.id) }
        }
    }

    <span class="hljs-meta">@Composable</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">WatchWorkoutSummary</span><span class="hljs-params">(workout: <span class="hljs-type">Workout</span>)</span></span> {
        <span class="hljs-comment">// Optimized for small screen</span>
        Column(modifier = RemoteModifier.fillMaxSize()) {
            Text(workout.type, style = WatchTypography.Title)
            Row {
                StatBox(<span class="hljs-string">"Duration"</span>, workout.duration)
                StatBox(<span class="hljs-string">"Distance"</span>, workout.distance)
            }
            MiniHeartRateIndicator(workout.avgHeartRate)
        }
    }
}
</code></pre>
<p>ä¸¤æ¬¾è®¾å¤‡éƒ½æ˜¾ç¤ºé”»ç‚¼æ•°æ®ï¼Œä½†å¸ƒå±€é’ˆå¯¹å„è‡ªçš„è®¾å¤‡å°ºå¯¸è¿›è¡Œäº†ä¼˜åŒ–ã€‚ä»»ä¸€å¸ƒå±€çš„æ›´æ–°éƒ½ä¼šç«‹å³ç”Ÿæ•ˆï¼Œæ— éœ€åœ¨ä»»ä¸€å¹³å°ä¸Šæ›´æ–°åº”ç”¨ã€‚</p>
<h3 data-id="heading-9">ç¼©çŸ­å‘å¸ƒå‘¨æœŸ</h3>
<p>æœ€æ˜¾è‘—çš„ä¼˜åŠ¿åœ¨äºè¿è¥å±‚é¢ï¼šUI æ›´æ”¹ä¸å†éœ€è¦å‘å¸ƒåº”ç”¨ã€‚è€ƒè™‘ä¸€ä¸‹ç®€å• UI è°ƒæ•´çš„å¼€å‘å‘¨æœŸã€‚</p>
<p>ä¼ ç»Ÿæ–¹æ³•å¤§çº¦éœ€è¦ä¸¤åˆ°å››å‘¨ã€‚ç¬¬ä¸€å¤©å’Œç¬¬äºŒå¤©æ˜¯å¼€å‘äººå‘˜å®ç°ã€‚ç¬¬ä¸‰å¤©å’Œç¬¬å››å¤©ç”¨äºä»£ç å®¡æŸ¥å’Œä¿®æ”¹ã€‚ç¬¬äº”å¤©åˆ°ç¬¬ä¸ƒå¤©ç”¨äºè´¨é‡ä¿è¯æµ‹è¯•ã€‚ç¬¬å…«å¤©å’Œç¬¬ä¹å¤©å¤„ç†å‘å¸ƒå‡†å¤‡å’Œåº”ç”¨å•†åº—æäº¤ã€‚ç¬¬åå¤©åˆ°ç¬¬åå››å¤©ï¼šç­‰å¾…åº”ç”¨å•†åº—å®¡æ ¸ã€‚ç¬¬åäº”å¤©åˆ°ç¬¬ä¸‰åå¤©ç”¨æˆ·é€æ­¥é‡‡ç”¨ï¼Œé€šå¸¸ä¸¤å‘¨å†…ä¼šæœ‰ 50% åˆ° 70% çš„ç”¨æˆ·æ›´æ–°ã€‚å¤§å¤šæ•°ç”¨æˆ·åœ¨ä¸¤åˆ°å››å‘¨å†…ä¸ä¼šçœ‹åˆ°å˜åŒ–ã€‚</p>
<p>RemoteCompose æ–¹æ³•åªéœ€ä¸€åˆ°ä¸¤å¤©å³å¯å®Œæˆã€‚ç¬¬ä¸€å¤©å’Œç¬¬äºŒå¤©æ˜¯å¼€å‘äººå‘˜åœ¨æœåŠ¡å™¨ç«¯å®ç°ã€‚éƒ¨ç½²åªéœ€å‡ åˆ†é’Ÿã€‚æ‰€æœ‰ç”¨æˆ·éƒ½èƒ½ç«‹å³çœ‹åˆ°å˜åŒ–ã€‚</p>
<p>è¿™ç§é€Ÿåº¦ä¼˜åŠ¿å¯¹äºèŠ‚å‡æ—¥ä¿ƒé”€æ´»åŠ¨è‡³å…³é‡è¦ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦åœ¨å½“å¤©éƒ¨ç½²å­£èŠ‚æ€§ä¸»é¢˜ï¼›å¯¹äºæœåŠ¡ä¸­æ–­çš„ç´§æ€¥æ¶ˆæ¯ï¼Œä½ å¯ä»¥å³æ—¶æ›´æ–° UIï¼›å¯¹äºå¿«é€Ÿè¿­ä»£ï¼Œä½ å¯ä»¥å¿«é€Ÿæµ‹è¯•æƒ³æ³•å¹¶å¿«é€Ÿå¤±è´¥ï¼›å¯¹äºç«äº‰å“åº”ï¼Œä½ å¯ä»¥ä»¥å°æ—¶è€Œä¸æ˜¯å‡ å‘¨çš„æ—¶é—´å¯¹å¸‚åœºå˜åŒ–åšå‡ºååº”ã€‚</p>
<p>ä»¥ä¸€ä¸ªå‡†å¤‡è¿æ¥é»‘è‰²æ˜ŸæœŸäº”çš„ç”µå•†åº”ç”¨ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Traditional approach: Ship all variations weeks in advance</span>
<span class="hljs-comment">// Problem: All promotional code ships weeks early</span>
<span class="hljs-comment">// Risk: Date logic bugs could show promotions early</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">HomeScreen</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> today = LocalDate.now()
    <span class="hljs-keyword">when</span> {
        today == BlackFriday -&gt; BlackFridayHome()

        <span class="hljs-comment">// Must ship by Oct 15</span>
        today <span class="hljs-keyword">in</span> BlackFridayWeek -&gt; BlackFridayWeekHome()   <span class="hljs-comment">// Must ship by Oct 15</span>
        today == CyberMonday -&gt; CyberMondayHome()

        <span class="hljs-comment">// Must ship by Oct 15</span>
        <span class="hljs-keyword">else</span> -&gt; RegularHome()
    }
}

<span class="hljs-comment">// Remote approach: Deploy each promotion on the exact day</span>
<span class="hljs-comment">// Benefit: Each promotion deploys on the exact minute needed</span>
<span class="hljs-comment">// Flexibility: Can react to competitor moves in real-time</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">HomeScreenService</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getHomeDocument</span><span class="hljs-params">(user: <span class="hljs-type">User</span>)</span></span>: ByteArray {
        <span class="hljs-keyword">val</span> promotion = promotionService.getCurrentPromotion()

        <span class="hljs-keyword">return</span> captureRemoteDocument(context, displayInfo, profile) {
            <span class="hljs-keyword">when</span> (promotion) {
                <span class="hljs-keyword">is</span> BlackFridayPromotion -&gt; BlackFridayHome(promotion)
                <span class="hljs-keyword">is</span> CyberMondayPromotion -&gt; CyberMondayHome(promotion)
                <span class="hljs-keyword">is</span> FlashSale -&gt; FlashSaleHome(promotion)  <span class="hljs-comment">// Can add new types anytime</span>
                <span class="hljs-keyword">else</span> -&gt; RegularHome()
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-10">çŠ¶æ€ç®¡ç†ï¼šè¶…è¶Šé™æ€å¸ƒå±€</h3>
<p>RemoteCompose ä¸ä»…é™äºé™æ€å¸ƒå±€ã€‚è¯¥æ¡†æ¶åŒ…å«ä¸€ä¸ªçŠ¶æ€ç®¡ç†ç³»ç»Ÿï¼Œå¯ä»¥å®ç°äº¤äº’å¼ã€åŠ¨æ€çš„ UIã€‚</p>
<p><strong>è¿œç¨‹çŠ¶æ€å˜é‡</strong></p>
<p>çŠ¶æ€å¯ä»¥åµŒå…¥æ–‡æ¡£ä¸­ï¼Œå¹¶ç”±å®¢æˆ·ç«¯æ›´æ–°ã€‚è¿™ä½¿å¾—è¡¨å•ã€è®¡æ•°å™¨ã€åˆ‡æ¢å¼€å…³å’Œå…¶ä»–äº¤äº’å…ƒç´ æˆä¸ºå¯èƒ½ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Creation side: Define interactive widget</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">QuantitySelector</span><span class="hljs-params">(initialQuantity: <span class="hljs-type">Int</span>)</span></span> {
    <span class="hljs-keyword">var</span> quantity <span class="hljs-keyword">by</span> rememberRemoteState(<span class="hljs-string">"quantity"</span>, initialQuantity)

    Row(
        modifier = RemoteModifier.fillMaxWidth(),
        horizontalArrangement = Arrangement.SpaceBetween
    ) {
        IconButton(
            onClick = {
                <span class="hljs-keyword">if</span> (quantity &gt; <span class="hljs-number">1</span>) {
                    quantity--
                    namedAction(<span class="hljs-string">"quantityChanged"</span>, quantity.toString())
                }
            }
        ) {
            Icon(Icons.Minus)
        }

        Text(
            text = quantity.toString(),
            style = MaterialTheme.typography.headlineMedium
        )

        IconButton(
            onClick = {
                quantity++
                namedAction(<span class="hljs-string">"quantityChanged"</span>, quantity.toString())
            }
        ) {
            Icon(Icons.Plus)
        }
    }
}
</code></pre>
<p>æ’­æ”¾å™¨ç«¯é€šè¿‡æ“ä½œå›è°ƒå¤„ç†çŠ¶æ€æ›´æ–°ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Player side: Handle state updates</span>
RemoteDocumentPlayer(
    document = document,
    onNamedAction = { name, value, stateUpdater -&gt;
        <span class="hljs-keyword">when</span> (name) {
            <span class="hljs-string">"quantityChanged"</span> -&gt; {
                <span class="hljs-comment">// Update cart</span>
                cartManager.setQuantity(itemId, value.toInt())

                <span class="hljs-comment">// Optionally update remote state directly</span>
                stateUpdater.updateState { state -&gt;
                    state[<span class="hljs-string">"quantity"</span>] = RcInt(value.toInt())
                }
            }
        }
    }
)
</code></pre>
<p><strong>åŠ¨ç”»æ—¶é—´è·Ÿè¸ª</strong></p>
<p>æ’­æ”¾å™¨è·Ÿè¸ªåŠ¨ç”»æ—¶é—´å¹¶å°†å…¶ä¼ é€’ç»™æ–‡æ¡£ï¼Œä»è€Œæ— éœ€ä»»ä½•å®¢æˆ·ç«¯åŠ¨ç”»ä»£ç å³å¯å®ç°åŸºäºæ—¶é—´çš„åŠ¨ç”»ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Server side: Define animated elements</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">PulsingNotificationBadge</span><span class="hljs-params">(count: <span class="hljs-type">Int</span>)</span></span> {
    <span class="hljs-comment">// Scale pulses between 0.9 and 1.1 over 1 second</span>
    <span class="hljs-keyword">val</span> scale = FloatExpression(<span class="hljs-string">"0.9 + 0.2 * sin(time * 6.28)"</span>)

    <span class="hljs-comment">// Opacity pulses between 0.7 and 1.0</span>
    <span class="hljs-keyword">val</span> opacity = FloatExpression(<span class="hljs-string">"0.7 + 0.3 * sin(time * 6.28)"</span>)

    Box(
        modifier = RemoteModifier
            .scale(scale)
            .alpha(opacity)
            .background(Color.Red, CircleShape)
            .size(<span class="hljs-number">24.</span>dp)
    ) {
        Text(
            text = count.toString(),
            color = Color.White,
            modifier = RemoteModifier.align(Alignment.Center)
        )
    }
}

<span class="hljs-comment">// The player automatically:</span>
<span class="hljs-comment">// 1. Tracks elapsed time since document load</span>
<span class="hljs-comment">// 2. Evaluates expressions each frame</span>
<span class="hljs-comment">// 3. Updates visual properties</span>
<span class="hljs-comment">// No client animation code needed</span>
</code></pre>
<p>è¿™ä½¿å¾—å®Œå…¨åœ¨æ–‡æ¡£æ ¼å¼ä¸­å®šä¹‰çš„æµç•…ã€é«˜æ€§èƒ½åŠ¨ç”»æˆä¸ºå¯èƒ½ã€‚è¡¨è¾¾å¼æ”¯æŒè¯¸å¦‚ <code>sin</code>ã€<code>cos</code>ã€<code>lerp</code> å’Œ <code>clamp</code> ä¹‹ç±»çš„æ•°å­¦å‡½æ•°ï¼Œä»¥åŠç®—æœ¯è¿ç®—ç¬¦å’Œå˜é‡å¼•ç”¨ã€‚</p>
<p><strong>åŒå‘é€šä¿¡</strong></p>
<p>æ“ä½œç³»ç»Ÿæ”¯æŒæ–‡æ¡£ä¸å®¿ä¸»åº”ç”¨ä¹‹é—´çš„åŒå‘é€šä¿¡ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Document triggers actions for various purposes</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">ProductDetailPage</span><span class="hljs-params">(product: <span class="hljs-type">Product</span>)</span></span> {
    Column {
        <span class="hljs-comment">// Analytics tracking</span>
        LaunchedEffect(<span class="hljs-built_in">Unit</span>) {
            namedAction(<span class="hljs-string">"analytics"</span>, <span class="hljs-string">"product_viewed:<span class="hljs-subst">${product.id}</span>"</span>)
        }

        ProductImage(product.imageUrl)

        <span class="hljs-comment">// Navigation action</span>
        TextButton(onClick = { namedAction(<span class="hljs-string">"navigate"</span>, <span class="hljs-string">"/reviews/<span class="hljs-subst">${product.id}</span>"</span>) }) {
            Text(<span class="hljs-string">"See all reviews"</span>)
        }

        <span class="hljs-comment">// Cart action with data</span>
        Button(onClick = { namedAction(<span class="hljs-string">"addToCart"</span>, product.id) }) {
            Text(<span class="hljs-string">"Add to Cart"</span>)
        }

        <span class="hljs-comment">// State update action</span>
        <span class="hljs-keyword">var</span> isFavorite <span class="hljs-keyword">by</span> rememberRemoteState(<span class="hljs-string">"favorite"</span>, product.isFavorite)
        IconButton(
            onClick = {
                isFavorite = !isFavorite
                namedAction(<span class="hljs-string">"toggleFavorite"</span>, <span class="hljs-string">"<span class="hljs-subst">${product.id}</span>:<span class="hljs-variable">$isFavorite</span>"</span>)
            }
        ) {
            Icon(<span class="hljs-keyword">if</span> (isFavorite) Icons.Filled.Favorite <span class="hljs-keyword">else</span> Icons.Outlined.Favorite)
        }
    }
}
</code></pre>
<p>å®¿ä¸»åº”ç”¨ç»Ÿä¸€å¤„ç†æ‰€æœ‰æ“ä½œï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Host app handles all actions uniformly</span>
RemoteDocumentPlayer(
    document = document,
    onNamedAction = { name, value, stateUpdater -&gt;
        <span class="hljs-keyword">when</span> (name) {
            <span class="hljs-string">"analytics"</span> -&gt; {
                <span class="hljs-keyword">val</span> (event, id) = value.split(<span class="hljs-string">":"</span>)
                analytics.logEvent(event, mapOf(<span class="hljs-string">"productId"</span> to id))
            }
            <span class="hljs-string">"navigate"</span> -&gt; navController.navigate(value)
            <span class="hljs-string">"addToCart"</span> -&gt; {
                cartManager.add(value)
                <span class="hljs-comment">// Update UI to show confirmation</span>
                stateUpdater.updateState { state -&gt;
                    state[<span class="hljs-string">"cartCount"</span>] = RcInt((state[<span class="hljs-string">"cartCount"</span>] <span class="hljs-keyword">as</span>? RcInt)?.value?.plus(<span class="hljs-number">1</span>) ?: <span class="hljs-number">1</span>)
                }
            }
            <span class="hljs-string">"toggleFavorite"</span> -&gt; {
                <span class="hljs-keyword">val</span> (id, isFavorite) = value.split(<span class="hljs-string">":"</span>)
                favoritesManager.setFavorite(id, isFavorite.toBoolean())
            }
        }
    }
)
</code></pre>
<p>è¿™ç§åŒå‘é€šä¿¡æ„å‘³ç€è¿œç¨‹æ–‡æ¡£å¯ä»¥å®Œå…¨é›†æˆåˆ°ä½ åº”ç”¨çš„å¯¼èˆªã€åˆ†æã€çŠ¶æ€ç®¡ç†å’Œä¸šåŠ¡é€»è¾‘ä¸­ï¼Œè€Œæ–‡æ¡£æœ¬èº«æ— éœ€äº†è§£ä½ çš„å…·ä½“å®ç°ã€‚</p>
<h3 data-id="heading-11"><strong>å®é™…åº”ç”¨æ¶æ„æ¨¡å¼</strong></h3>
<p>è®©æˆ‘ä»¬æ¥æ¢è®¨ä¸€ä¸‹ RemoteCompose å¦‚ä½•èå…¥å®é™…åº”ç”¨æ¶æ„ã€‚</p>
<p><strong>æ¨¡å¼ 1ï¼šæ··åˆæ¶æ„ï¼ˆæ¨èï¼‰</strong></p>
<p>å¤§å¤šæ•°åº”ç”¨éƒ½èƒ½ä»æ··åˆæ¶æ„ä¸­è·ç›Šï¼šå…³é”®é¡µé¢ä½¿ç”¨æœ¬åœ° Compose ä»£ç æ„å»ºï¼Œè€ŒåŠ¨æ€å†…å®¹åŒºåŸŸåˆ™ä½¿ç”¨ RemoteComposeã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Navigation: Local Compose (fast, reliable)</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">AppNavigation</span><span class="hljs-params">()</span></span> {
    NavHost(navController, startDestination = <span class="hljs-string">"home"</span>) {
        composable(<span class="hljs-string">"home"</span>) { HomeScreen() }
        composable(<span class="hljs-string">"product/{id}"</span>) { ProductScreen(it.arguments?.getString(<span class="hljs-string">"id"</span>)) }
        composable(<span class="hljs-string">"cart"</span>) { CartScreen() }
        composable(<span class="hljs-string">"checkout"</span>) { CheckoutScreen() }
    }
}

<span class="hljs-comment">// Home screen: Remote (marketing can update freely)</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">HomeScreen</span><span class="hljs-params">(viewModel: <span class="hljs-type">HomeViewModel</span> = hiltViewModel()</span></span>) {
    <span class="hljs-keyword">val</span> document <span class="hljs-keyword">by</span> viewModel.homeDocument.collectAsState()

    <span class="hljs-keyword">when</span> (<span class="hljs-keyword">val</span> state = document) {
        <span class="hljs-keyword">is</span> Loading -&gt; LoadingIndicator()
        <span class="hljs-keyword">is</span> Success -&gt; RemoteDocumentPlayer(
            document = state.document,
            onNamedAction = { name, value, _ -&gt; handleAction(name, value) }
        )
        <span class="hljs-keyword">is</span> Error -&gt; LocalFallbackHome()  <span class="hljs-comment">// Graceful degradation</span>
    }
}

<span class="hljs-comment">// Product screen: Hybrid (shell is local, content is remote)</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">ProductScreen</span><span class="hljs-params">(productId: <span class="hljs-type">String</span>, viewModel: <span class="hljs-type">ProductViewModel</span> = hiltViewModel()</span></span>) {
    <span class="hljs-keyword">val</span> product <span class="hljs-keyword">by</span> viewModel.product.collectAsState()
    <span class="hljs-keyword">val</span> contentDocument <span class="hljs-keyword">by</span> viewModel.contentDocument.collectAsState()

    Scaffold(
        topBar = { ProductTopBar(product) },  <span class="hljs-comment">// Local: consistent navigation</span>
        bottomBar = { AddToCartBar(product) } <span class="hljs-comment">// Local: critical purchase flow</span>
    ) { padding -&gt;
        <span class="hljs-comment">// Remote: Rich product content, can be A/B tested</span>
        contentDocument?.let { doc -&gt;
            RemoteDocumentPlayer(
                document = doc,
                modifier = Modifier.padding(padding)
            )
        }
    }
}
</code></pre>
<p><strong>æ¨¡å¼ 2ï¼šæ–‡æ¡£ç¼“å­˜ä»¥å®ç°ç¦»çº¿æ”¯æŒ</strong></p>
<p>è¿œç¨‹æ–‡æ¡£å¯ä»¥ç¼“å­˜ä»¥ä¾›ç¦»çº¿è®¿é—®ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DocumentRepository</span> <span class="hljs-meta">@Inject</span> <span class="hljs-keyword">constructor</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> api: DocumentApi,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> cache: DocumentCache,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> connectivity: ConnectivityManager
) {
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getDocument</span><span class="hljs-params">(key: <span class="hljs-type">String</span>)</span></span>: CoreDocument {
        <span class="hljs-comment">// Try cache first</span>
        cache.<span class="hljs-keyword">get</span>(key)?.let { cached -&gt;
            <span class="hljs-comment">// Return cached immediately, refresh in background</span>
            refreshInBackground(key)
            <span class="hljs-keyword">return</span> cached
        }

        <span class="hljs-comment">// No cache, must fetch</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (connectivity.isConnected) {
            fetchAndCache(key)
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> OfflineException(<span class="hljs-string">"No cached document and no connectivity"</span>)
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchAndCache</span><span class="hljs-params">(key: <span class="hljs-type">String</span>)</span></span>: CoreDocument {
        <span class="hljs-keyword">val</span> bytes = api.fetchDocument(key)
        <span class="hljs-keyword">val</span> document = RemoteComposeBuffer.deserialize(bytes)
        cache.store(key, document, ttl = <span class="hljs-number">1.</span>hours)
        <span class="hljs-keyword">return</span> document
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">refreshInBackground</span><span class="hljs-params">(key: <span class="hljs-type">String</span>)</span></span> {
        scope.launch {
            <span class="hljs-keyword">try</span> {
                fetchAndCache(key)
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                <span class="hljs-comment">// Silent failure, cached version is still valid</span>
                Log.w(TAG, <span class="hljs-string">"Background refresh failed"</span>, e)
            }
        }
    }
}
</code></pre>
<p><strong>æ¨¡å¼ 3ï¼šæ–‡æ¡£é¢„åŠ è½½ä»¥å®ç°æµç•…å¯¼èˆª</strong></p>
<p>é¢„åŠ è½½ç”¨æˆ·å¯èƒ½è®¿é—®çš„é¡µé¢çš„æ–‡æ¡£ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DocumentPreloader</span> <span class="hljs-meta">@Inject</span> <span class="hljs-keyword">constructor</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> repository: DocumentRepository
) {
    <span class="hljs-comment">// Preload when user enters a screen</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">preloadForScreen</span><span class="hljs-params">(screen: <span class="hljs-type">Screen</span>)</span></span> {
        <span class="hljs-keyword">val</span> keysToPreload = <span class="hljs-keyword">when</span> (screen) {
            <span class="hljs-keyword">is</span> HomeScreen -&gt; listOf(<span class="hljs-string">"featured"</span>, <span class="hljs-string">"categories"</span>, <span class="hljs-string">"promotions"</span>)
            <span class="hljs-keyword">is</span> CategoryScreen -&gt; screen.subcategories.map { <span class="hljs-string">"category_<span class="hljs-subst">${it.id}</span>"</span> }
            <span class="hljs-keyword">is</span> ProductScreen -&gt; listOf(<span class="hljs-string">"reviews_<span class="hljs-subst">${screen.productId}</span>"</span>, <span class="hljs-string">"related_<span class="hljs-subst">${screen.productId}</span>"</span>)
            <span class="hljs-keyword">else</span> -&gt; emptyList()
        }

        keysToPreload.forEach { key -&gt;
            scope.launch {
                <span class="hljs-keyword">try</span> {
                    repository.getDocument(key)  <span class="hljs-comment">// Caches for later</span>
                } <span class="hljs-keyword">catch</span> (e: Exception) {
                    <span class="hljs-comment">// Preload failure is not critical</span>
                }
            }
        }
    }
}

<span class="hljs-comment">// Usage in navigation</span>
navController.addOnDestinationChangedListener { _, destination, arguments -&gt;
    preloader.preloadForScreen(destination.toScreen(arguments))
}
</code></pre>
<h3 data-id="heading-12"><strong>ç»“è®º</strong></h3>
<p>RemoteCompose ä»£è¡¨äº†æˆ‘ä»¬å¯¹ Android UI å¼€å‘æ€ç»´æ–¹å¼çš„ä¸€æ¬¡èŒƒå¼è½¬å˜ã€‚é€šè¿‡å°† Compose å¸ƒå±€è½¬æ¢ä¸ºå¯ç§»æ¤æ–‡æ¡£æ ¼å¼ï¼ŒRemoteCompose å®ç°äº†æœåŠ¡å™¨é©±åŠ¨çš„ UIã€å³æ—¶ A/B æµ‹è¯•ã€å®æ—¶å†…å®¹æ›´æ–°å’Œè·¨å¹³å°ä¸€è‡´æ€§ï¼ŒåŒæ—¶ä¿æŒäº†åŸç”Ÿæ¸²æŸ“æ€§èƒ½ã€‚</p>
<p>è¯¥æ¡†æ¶æ‹¥æœ‰åŒ…å« 93 ç§ä»¥ä¸Šæ“ä½œçš„å…¨é¢æ“ä½œæ¨¡å‹ï¼Œå……åˆ†å±•ç°äº† Compose çš„è¡¨è¾¾èƒ½åŠ›ï¼ŒåŒ…æ‹¬åŠ¨ç”»ã€çŠ¶æ€å’Œäº¤äº’ã€‚åˆ›å»ºå’Œæ’­æ”¾çš„åˆ†ç¦»ä½¿å¾—éƒ¨ç½²æ¶æ„æ›´åŠ çµæ´»ï¼šåœ¨åç«¯ç”Ÿæˆå…·æœ‰å®Œæ•´ Compose è¡¨è¾¾èƒ½åŠ›çš„æ–‡æ¡£ï¼Œé€šè¿‡ç°æœ‰åŸºç¡€æ¶æ„åˆ†å‘ï¼Œå¹¶åœ¨ä»»ä½• Android è®¾å¤‡ä¸Šè¿›è¡ŒåŸç”Ÿæ¸²æŸ“ã€‚</p>
<p>å…³é”®åœ¨äºæ‰¾åˆ°åˆé€‚çš„å¹³è¡¡ç‚¹ï¼šå¯¹äºåŠ¨æ€ã€é¢‘ç¹å˜åŒ–çš„å†…å®¹åŒºåŸŸï¼Œä½¿ç”¨ RemoteComposeï¼›åŒæ—¶å°†å…³é”®æµç¨‹ä¿ç•™åœ¨æœ¬åœ° Compose ä»£ç ä¸­ã€‚è¿™ç§æ··åˆæ–¹æ³•åœ¨éœ€è¦çµæ´»æ€§çš„åœ°æ–¹æä¾›æœåŠ¡å™¨é©±åŠ¨ UI çš„ä¼˜åŠ¿ï¼Œåœ¨éœ€è¦å¯é æ€§çš„åœ°æ–¹æä¾›ç¼–è¯‘ä»£ç çš„ä¼˜åŠ¿ã€‚</p>
<p>æ— è®ºä½ æ˜¯æ„å»ºéœ€è¦é¢‘ç¹æ›´æ–°å¸ƒå±€çš„å†…å®¹å¯†é›†å‹åº”ç”¨ã€éœ€è¦å¿«é€Ÿ A/B æµ‹è¯•çš„ç”µå­å•†åŠ¡å¹³å°ï¼Œè¿˜æ˜¯éœ€è¦å¿«é€Ÿè¿­ä»£çš„ä¼ä¸šçº§å·¥å…·ï¼ŒRemoteCompose éƒ½èƒ½ä¸ºçœŸæ­£åŠ¨æ€çš„ UI æä¾›æ¶æ„åŸºç¡€ã€‚è¯¥æ¡†æ¶å¤„ç†äº†åºåˆ—åŒ–ã€ä¼ è¾“å’Œæ¸²æŸ“çš„å¤æ‚æ€§ï¼Œå› æ­¤ä½ å¯ä»¥ä¸“æ³¨äºè®¾è®¡å“è¶Šçš„ç”¨æˆ·ä½“éªŒã€‚</p>
<p>ä½ å¯ä»¥è§‚çœ‹ä»–ä»¬æœ€è¿‘å…³äº<a href="https://link.juejin.cn?target=https%3A%2F%2Fspeakerdeck.com%2Fcamaelon%2Fintroducing-remotecompose-break-your-ui-out-of-the-app-sandbox" target="_blank" title="https://speakerdeck.com/camaelon/introducing-remotecompose-break-your-ui-out-of-the-app-sandbox" ref="nofollow noopener noreferrer">RemoteCompose ç®€ä»‹ï¼šå°†ä½ çš„ UI ä»åº”ç”¨ç¨‹åºæ²™ç›’ä¸­è§£æ”¾å‡ºæ¥</a>çš„æ¼”è®²ã€‚</p>
<blockquote>
<p>æ¬¢è¿æœç´¢å¹¶å…³æ³¨ <em>å…¬ä¼—å·<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fmp%2Fqrcode%3Fscene%3D10000004%26size%3D512%26__biz%3DMzU1MDg0NDczNA%3D%3D%26mid%3D2247484417%26idx%3D1%26sn%3D60c15f0d3c4be75e37748c2472a74102" target="_blank" title="https://mp.weixin.qq.com/mp/qrcode?scene=10000004&amp;size=512&amp;__biz=MzU1MDg0NDczNA==&amp;mid=2247484417&amp;idx=1&amp;sn=60c15f0d3c4be75e37748c2472a74102" ref="nofollow noopener noreferrer">ã€Œç¨€æœ‰çŒ¿è¯‰ã€</a></em> è·å–æ›´å¤šçš„ä¼˜è´¨æ–‡ç« ï¼</p>
<p>ä¿æŠ¤åŸåˆ›ï¼Œè¯·å‹¿è½¬è½½ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Redisï¼ˆ164ï¼‰å¦‚ä½•ä½¿ç”¨Rediså®ç°æ’è¡Œæ¦œï¼Ÿ]]></title>    <link>https://juejin.cn/post/7579889969985077299</link>    <guid>https://juejin.cn/post/7579889969985077299</guid>    <pubDate>2025-12-04T22:53:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7579889969985077299" data-draft-id="7579832417748746291" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redisï¼ˆ164ï¼‰å¦‚ä½•ä½¿ç”¨Rediså®ç°æ’è¡Œæ¦œï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-04T22:53:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redisï¼ˆ164ï¼‰å¦‚ä½•ä½¿ç”¨Rediså®ç°æ’è¡Œæ¦œï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-04T22:53:39.000Z" title="Thu Dec 04 2025 22:53:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½¿ç”¨Rediså®ç°æ’è¡Œæ¦œæ˜¯ä¸€ç§å¸¸è§çš„åº”ç”¨åœºæ™¯ï¼ŒRedisçš„Sorted Setï¼ˆæœ‰åºé›†åˆï¼‰æ•°æ®ç»“æ„éå¸¸é€‚åˆç”¨äºè¿™ç§åœºæ™¯ã€‚Sorted Setèƒ½å¤Ÿæ ¹æ®æˆå‘˜çš„åˆ†æ•°è¿›è¡Œæ’åºï¼Œå¹¶ä¸”æä¾›äº†ä¸€ç³»åˆ—å‘½ä»¤æ¥æ“ä½œå’ŒæŸ¥è¯¢æ•°æ®ã€‚</p>
<h3 data-id="heading-0">1. åŸºæœ¬æ¦‚å¿µ</h3>
<p>Redisçš„Sorted Setæ˜¯ä¸€ç§å¸¦æœ‰åˆ†æ•°çš„é›†åˆï¼Œæ¯ä¸ªæˆå‘˜éƒ½æœ‰ä¸€ä¸ªå…³è”çš„åˆ†æ•°ï¼ŒRedisæ ¹æ®åˆ†æ•°å¯¹æˆå‘˜è¿›è¡Œæ’åºã€‚Sorted Setä¸­çš„æˆå‘˜æ˜¯å”¯ä¸€çš„ï¼Œä½†åˆ†æ•°å¯ä»¥é‡å¤ã€‚</p>
<h3 data-id="heading-1">2. å®ç°æ­¥éª¤</h3>
<h4 data-id="heading-2">2.1 æ·»åŠ æˆå‘˜å’Œåˆ†æ•°åˆ°æ’è¡Œæ¦œ</h4>
<p>å¯ä»¥ä½¿ç”¨<code>ZADD</code>å‘½ä»¤å°†æˆå‘˜å’Œåˆ†æ•°æ·»åŠ åˆ°Sorted Setä¸­ã€‚å¦‚æœæˆå‘˜å·²ç»å­˜åœ¨ï¼Œå°†æ›´æ–°å…¶åˆ†æ•°ã€‚</p>
<h4 data-id="heading-3">2.2 è·å–æ’è¡Œæ¦œçš„æ’å</h4>
<p>å¯ä»¥ä½¿ç”¨<code>ZRANK</code>å‘½ä»¤è¿”å›æˆå‘˜åœ¨æ’è¡Œæ¦œä¸­çš„æ’åï¼ˆä»0å¼€å§‹ï¼‰ã€‚</p>
<h4 data-id="heading-4">2.3 è·å–æ’è¡Œæ¦œä¸­çš„æˆå‘˜åŠå…¶åˆ†æ•°</h4>
<p>å¯ä»¥ä½¿ç”¨<code>ZRANGE</code>å‘½ä»¤è·å–æ’è¡Œæ¦œä¸­çš„æˆå‘˜ï¼Œå¹¶ä½¿ç”¨<code>WITHSCORES</code>é€‰é¡¹è·å–åˆ†æ•°ã€‚</p>
<h4 data-id="heading-5">2.4 è·å–æˆå‘˜çš„åˆ†æ•°</h4>
<p>å¯ä»¥ä½¿ç”¨<code>ZSCORE</code>å‘½ä»¤è·å–æˆå‘˜çš„åˆ†æ•°ã€‚</p>
<h4 data-id="heading-6">2.5 åˆ é™¤æˆå‘˜</h4>
<p>å¯ä»¥ä½¿ç”¨<code>ZREM</code>å‘½ä»¤ä»æ’è¡Œæ¦œä¸­åˆ é™¤æˆå‘˜ã€‚</p>
<h3 data-id="heading-7">3. ä»£ç ç¤ºä¾‹</h3>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªè¯¦ç»†çš„Javaä»£ç ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨Jedisåº“å®ç°ä¸€ä¸ªç®€å•çš„æ’è¡Œæ¦œã€‚</p>
<h4 data-id="heading-8">3.1 å¼•å…¥ä¾èµ–</h4>
<p>åœ¨Mavené¡¹ç›®ä¸­æ·»åŠ Jedisä¾èµ–ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>redis.clients<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jedis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h4 data-id="heading-9">3.2 æ·»åŠ æˆå‘˜åŠå…¶åˆ†æ•°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisLeaderboardAdd</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è¿æ¥åˆ°æœ¬åœ°çš„RedisæœåŠ¡</span>
        <span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>);

        <span class="hljs-type">String</span> <span class="hljs-variable">leaderboardKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"leaderboard"</span>;

        <span class="hljs-comment">// æ·»åŠ æˆå‘˜åŠå…¶åˆ†æ•°</span>
        jedis.zadd(leaderboardKey, <span class="hljs-number">100</span>, <span class="hljs-string">"user1"</span>);
        jedis.zadd(leaderboardKey, <span class="hljs-number">200</span>, <span class="hljs-string">"user2"</span>);
        jedis.zadd(leaderboardKey, <span class="hljs-number">150</span>, <span class="hljs-string">"user3"</span>);

        System.out.println(<span class="hljs-string">"Members added to leaderboard"</span>);

        jedis.close();
    }
}
</code></pre>
<h4 data-id="heading-10">3.3 è·å–æˆå‘˜çš„æ’å</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisLeaderboardRank</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è¿æ¥åˆ°æœ¬åœ°çš„RedisæœåŠ¡</span>
        <span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>);

        <span class="hljs-type">String</span> <span class="hljs-variable">leaderboardKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"leaderboard"</span>;
        <span class="hljs-type">String</span> <span class="hljs-variable">member</span> <span class="hljs-operator">=</span> <span class="hljs-string">"user1"</span>;

        <span class="hljs-comment">// è·å–æˆå‘˜çš„æ’åï¼ˆä»0å¼€å§‹ï¼‰</span>
        <span class="hljs-type">Long</span> <span class="hljs-variable">rank</span> <span class="hljs-operator">=</span> jedis.zrank(leaderboardKey, member);
        System.out.println(<span class="hljs-string">"Rank of "</span> + member + <span class="hljs-string">": "</span> + rank);

        jedis.close();
    }
}
</code></pre>
<h4 data-id="heading-11">3.4 è·å–æ’è¡Œæ¦œä¸­çš„æˆå‘˜åŠå…¶åˆ†æ•°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;
<span class="hljs-keyword">import</span> redis.clients.jedis.Tuple;

<span class="hljs-keyword">import</span> java.util.Set;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisLeaderboardGet</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è¿æ¥åˆ°æœ¬åœ°çš„RedisæœåŠ¡</span>
        <span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>);

        <span class="hljs-type">String</span> <span class="hljs-variable">leaderboardKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"leaderboard"</span>;

        <span class="hljs-comment">// è·å–æ’è¡Œæ¦œä¸­çš„æˆå‘˜åŠå…¶åˆ†æ•°</span>
        Set&lt;Tuple&gt; leaderboard = jedis.zrangeWithScores(leaderboardKey, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>);
        <span class="hljs-keyword">for</span> (Tuple tuple : leaderboard) {
            System.out.println(<span class="hljs-string">"Member: "</span> + tuple.getElement() + <span class="hljs-string">", Score: "</span> + tuple.getScore());
        }

        jedis.close();
    }
}
</code></pre>
<h4 data-id="heading-12">3.5 è·å–æˆå‘˜çš„åˆ†æ•°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisLeaderboardScore</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è¿æ¥åˆ°æœ¬åœ°çš„RedisæœåŠ¡</span>
        <span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>);

        <span class="hljs-type">String</span> <span class="hljs-variable">leaderboardKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"leaderboard"</span>;
        <span class="hljs-type">String</span> <span class="hljs-variable">member</span> <span class="hljs-operator">=</span> <span class="hljs-string">"user1"</span>;

        <span class="hljs-comment">// è·å–æˆå‘˜çš„åˆ†æ•°</span>
        <span class="hljs-type">Double</span> <span class="hljs-variable">score</span> <span class="hljs-operator">=</span> jedis.zscore(leaderboardKey, member);
        System.out.println(<span class="hljs-string">"Score of "</span> + member + <span class="hljs-string">": "</span> + score);

        jedis.close();
    }
}
</code></pre>
<h4 data-id="heading-13">3.6 åˆ é™¤æˆå‘˜</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisLeaderboardRemove</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è¿æ¥åˆ°æœ¬åœ°çš„RedisæœåŠ¡</span>
        <span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>);

        <span class="hljs-type">String</span> <span class="hljs-variable">leaderboardKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"leaderboard"</span>;
        <span class="hljs-type">String</span> <span class="hljs-variable">member</span> <span class="hljs-operator">=</span> <span class="hljs-string">"user1"</span>;

        <span class="hljs-comment">// åˆ é™¤æˆå‘˜</span>
        jedis.zrem(leaderboardKey, member);
        System.out.println(<span class="hljs-string">"Member "</span> + member + <span class="hljs-string">" removed from leaderboard"</span>);

        jedis.close();
    }
}
</code></pre>
<h3 data-id="heading-14">4. é«˜çº§æ“ä½œ</h3>
<p>é™¤äº†åŸºæœ¬æ“ä½œå¤–ï¼ŒRedisçš„Sorted Setè¿˜æ”¯æŒå¾ˆå¤šé«˜çº§åŠŸèƒ½ï¼Œä¾‹å¦‚æŒ‰åˆ†æ•°èŒƒå›´æŸ¥è¯¢ã€æŒ‰æ’åèŒƒå›´æŸ¥è¯¢ã€è·å–æ’è¡Œæ¦œçš„æˆå‘˜æ•°é‡ç­‰ã€‚</p>
<h4 data-id="heading-15">4.1 è·å–åˆ†æ•°åœ¨æŸä¸ªèŒƒå›´å†…çš„æˆå‘˜</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;
<span class="hljs-keyword">import</span> redis.clients.jedis.Tuple;

<span class="hljs-keyword">import</span> java.util.Set;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisLeaderboardRangeByScore</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è¿æ¥åˆ°æœ¬åœ°çš„RedisæœåŠ¡</span>
        <span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>);

        <span class="hljs-type">String</span> <span class="hljs-variable">leaderboardKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"leaderboard"</span>;

        <span class="hljs-comment">// è·å–åˆ†æ•°åœ¨100åˆ°200ä¹‹é—´çš„æˆå‘˜</span>
        Set&lt;Tuple&gt; leaderboard = jedis.zrangeByScoreWithScores(leaderboardKey, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>);
        <span class="hljs-keyword">for</span> (Tuple tuple : leaderboard) {
            System.out.println(<span class="hljs-string">"Member: "</span> + tuple.getElement() + <span class="hljs-string">", Score: "</span> + tuple.getScore());
        }

        jedis.close();
    }
}
</code></pre>
<h4 data-id="heading-16">4.2 è·å–æŸä¸ªæ’åèŒƒå›´å†…çš„æˆå‘˜</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> redis.clients.jedis.Jedis;
<span class="hljs-keyword">import</span> redis.clients.jedis.Tuple;

<span class="hljs-keyword">import</span> java.util.Set;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisLeaderboardRangeByRank</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è¿æ¥åˆ°æœ¬åœ°çš„RedisæœåŠ¡</span>
        <span class="hljs-type">Jedis</span> <span class="hljs-variable">jedis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">"localhost"</span>);

        <span class="hljs-type">String</span> <span class="hljs-variable">leaderboardKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"leaderboard"</span>;

        <span class="hljs-comment">// è·å–æ’ååœ¨0åˆ°1ä¹‹é—´çš„æˆå‘˜</span>
        Set&lt;Tuple&gt; leaderboard = jedis.zrangeWithScores(leaderboardKey, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
        <span class="hljs-keyword">for</span> (Tuple tuple : leaderboard) {
            System.out.println(<span class="hljs-string">"Member: "</span> + tuple.getElement() + <span class="hljs-string">", Score: "</span> + tuple.getScore());
        }

        jedis.close();
    }
}
</code></pre>
<h3 data-id="heading-17">æ€»ç»“</h3>
<p>é€šè¿‡ä½¿ç”¨Redisçš„Sorted Setæ•°æ®ç»“æ„ï¼Œå¯ä»¥éå¸¸å®¹æ˜“åœ°å®ç°ä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„æ’è¡Œæ¦œã€‚ä¸Šè¿°ä»£ç ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•åœ¨Javaä¸­ä½¿ç”¨Jedisåº“æ¥æ“ä½œRediså®ç°æ’è¡Œæ¦œï¼ŒåŒ…æ‹¬æ·»åŠ æˆå‘˜ã€è·å–æ’åã€è·å–æˆå‘˜åŠå…¶åˆ†æ•°ã€åˆ é™¤æˆå‘˜ç­‰æ“ä½œï¼Œä»¥åŠä¸€äº›é«˜çº§åŠŸèƒ½å¦‚æŒ‰åˆ†æ•°èŒƒå›´å’Œæ’åèŒƒå›´è·å–æˆå‘˜ã€‚æ ¹æ®å®é™…éœ€æ±‚ï¼Œå¯ä»¥çµæ´»åº”ç”¨è¿™äº›å‘½ä»¤æ¥å®ç°ä¸åŒçš„æ’è¡Œæ¦œåŠŸèƒ½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>