<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[Git Stash ä½¿ç”¨ç¬”è®°ï¼šä»ä¸€æ¬¡ PowerShell çš„â€œç¥ç§˜æŠ¥é”™â€è¯´èµ·]]></title>    <link>https://juejin.cn/post/7596698363964702758</link>    <guid>https://juejin.cn/post/7596698363964702758</guid>    <pubDate>2026-01-19T12:04:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596698363964702758" data-draft-id="7596698363964686374" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Git Stash ä½¿ç”¨ç¬”è®°ï¼šä»ä¸€æ¬¡ PowerShell çš„â€œç¥ç§˜æŠ¥é”™â€è¯´èµ·"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-19T12:04:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‡ªç”±ç”Ÿé•¿2024"/> <meta itemprop="url" content="https://juejin.cn/user/1591748569862670"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Git Stash ä½¿ç”¨ç¬”è®°ï¼šä»ä¸€æ¬¡ PowerShell çš„â€œç¥ç§˜æŠ¥é”™â€è¯´èµ·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1591748569862670/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‡ªç”±ç”Ÿé•¿2024
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T12:04:55.000Z" title="Mon Jan 19 2026 12:04:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ‘˜è¦ï¼šåœ¨ PowerShell ä¸­ä½¿ç”¨Â <code>git stash</code>Â æ—¶ï¼Œ<code>stash@{0}</code>Â éœ€åŠ åŒå¼•å·ï¼ˆå¦‚Â <code>"stash@{0}"</code>ï¼‰ï¼Œå¦åˆ™èŠ±æ‹¬å·ä¼šè¢«é”™è¯¯è§£æï¼Œå¯¼è‡´â€œunknown switch 'e'â€ç­‰è¯¡å¼‚æŠ¥é”™ã€‚æ­£ç¡®ä½¿ç”¨Â <code>drop</code>Â å¯ç›´æ¥åˆ é™¤ stash è€Œä¸æ¢å¤å†…å®¹ã€‚</p>
<h2 data-id="heading-0">Git Stash ä½¿ç”¨ç¬”è®°ï¼šä»ä¸€æ¬¡ PowerShell çš„â€œç¥ç§˜æŠ¥é”™â€è¯´èµ·</h2>
<p>æœ€è¿‘åœ¨ä½¿ç”¨ <code>git stash</code> æ—¶ï¼Œé‡åˆ°äº†ä¸€ä¸ªä»¤äººå›°æƒ‘çš„é”™è¯¯ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">PS &gt; git stash pop stash@{0}
error: unknown switch `e'
</code></pre>
<p>æ˜æ˜å‘½ä»¤å†™å¾—å®Œå…¨æ­£ç¡®ï¼Œå´æç¤ºâ€œæœªçŸ¥å¼€å…³ <code>e</code>â€â€”â€”æˆ‘æ ¹æœ¬æ²¡è¾“å…¥ <code>-e</code> å•Šï¼<br/>
ç»è¿‡æ’æŸ¥ï¼Œæ‰å‘ç°é—®é¢˜æ ¹æºä¸åœ¨ Gitï¼Œè€Œåœ¨äº <strong>PowerShell å¯¹ç‰¹æ®Šå­—ç¬¦çš„è§£ææœºåˆ¶</strong>ã€‚<br/>
è¿™ç¯‡ç¬”è®°å°±å›´ç»•è¿™ä¸ªçœŸå®é—®é¢˜ï¼Œæ¢³ç† <code>git stash</code> çš„æ ¸å¿ƒç”¨æ³•å’Œåœ¨ Windows PowerShell ä¸­çš„æ³¨æ„äº‹é¡¹ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€é—®é¢˜å¤ç°ï¼šä¸ºä»€ä¹ˆ <code>git stash pop stash@{0}</code> æŠ¥é”™ï¼Ÿ</h3>
<h4 data-id="heading-2">âŒ é”™è¯¯å‘½ä»¤ï¼ˆåœ¨ PowerShell ä¸­ï¼‰ï¼š</h4>
<pre><code class="hljs language-powershell" lang="powershell">git stash pop stash@{0}
</code></pre>
<h4 data-id="heading-3">ğŸ’¥ æŠ¥é”™ä¿¡æ¯ï¼š</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-type">error</span>: unknown <span class="hljs-keyword">switch</span> <span class="hljs-string">`e'
</span></code></pre>
<h4 data-id="heading-4">ğŸ” åŸå› åˆ†æï¼š</h4>
<p>åœ¨ <strong>PowerShell</strong> ä¸­ï¼ŒèŠ±æ‹¬å· <code>{}</code> æ˜¯<strong>ä¿ç•™å­—ç¬¦</strong>ï¼Œå¸¸ç”¨äºå­—ç¬¦ä¸²æ ¼å¼åŒ–ï¼ˆå¦‚ <code>"Hello {0}" -f "World"</code>ï¼‰ã€‚<br/>
å½“ä½ è¾“å…¥ <code>stash@{0}</code> æ—¶ï¼ŒPowerShell ä¼šå°è¯•è§£æ <code>{0}</code>ï¼Œå¯èƒ½å°†å…¶æ›¿æ¢æˆ–è½¬ä¹‰ï¼Œå¯¼è‡´å®é™…ä¼ ç»™ Git çš„å‚æ•°å˜æˆç±»ä¼¼ <code>stash@e</code> æˆ–å…¶ä»–ä¹±ç ï¼ŒGit äºæ˜¯è®¤ä¸ºä½ ä¼ äº†ä¸€ä¸ªéæ³•é€‰é¡¹ <code>-e</code>ã€‚</p>
<blockquote>
<p>ğŸ“Œ æ³¨æ„ï¼šè¿™ä¸ªé—®é¢˜<strong>åªå‡ºç°åœ¨ PowerShellï¼ˆæˆ–æŸäº› CMD ç¯å¢ƒï¼‰</strong>ï¼Œåœ¨ Git Bashã€Linux æˆ– macOS ç»ˆç«¯ä¸­é€šå¸¸ä¸ä¼šå‘ç”Ÿã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">äºŒã€è§£å†³æ–¹æ¡ˆï¼šåŠ å¼•å·ï¼</h3>
<p>åœ¨ PowerShell ä¸­ï¼Œ<strong>åªè¦å‘½ä»¤åŒ…å« <code>{}</code>ã€<code>$</code>ã€<code>@</code> ç­‰ç‰¹æ®Šå­—ç¬¦ï¼ŒåŠ¡å¿…ç”¨åŒå¼•å·åŒ…è£¹</strong>ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">git stash pop "stash@{0}"
git stash apply "stash@{1}"
git stash drop "stash@{0}"
git stash show -p "stash@{0}"
</code></pre>
<p>âœ… åŠ ä¸Šå¼•å·åï¼ŒPowerShell ä¸å†è§£æ <code>{0}</code>ï¼Œè€Œæ˜¯åŸæ ·ä¼ é€’ç»™ Gitï¼Œé—®é¢˜è¿åˆƒè€Œè§£ã€‚</p>
<hr/>
<h3 data-id="heading-6">ä¸‰ã€å¸¸ç”¨ <code>git stash</code> å‘½ä»¤é€ŸæŸ¥ï¼ˆPowerShell å®‰å…¨ç‰ˆï¼‰</h3>








































<table><thead><tr><th>åœºæ™¯</th><th>å‘½ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æŸ¥çœ‹æ‰€æœ‰ stash</strong></td><td><code>git stash list</code></td><td>æ˜¾ç¤º stash åˆ—è¡¨ï¼Œå¦‚ <code>stash@{0}: WIP on main: ...</code></td></tr><tr><td><strong>æŸ¥çœ‹ stash å†…å®¹</strong></td><td><code>git stash show -p "stash@{0}"</code></td><td>æ˜¾ç¤ºå…·ä½“ä»£ç å˜æ›´ï¼ˆå¿…é¡»åŠ  <code>-p</code> æ‰çœ‹ diffï¼‰ï¼Œ å¦‚æœä¸åŠ  stash@{0}å°±æ˜¯é»˜è®¤å¯¹æ¯”HEADå’Œæœ€æ–°çš„stash</td></tr><tr><td><strong>æ¢å¤å¹¶åˆ é™¤ stash</strong></td><td><code>git stash pop "stash@{0}"</code></td><td>åº”ç”¨ä¿®æ”¹ + ä»åˆ—è¡¨ç§»é™¤ï¼ˆé»˜è®¤æ“ä½œæœ€æ–° stashï¼‰</td></tr><tr><td><strong>ä»…æ¢å¤ä¸åˆ é™¤</strong></td><td><code>git stash apply "stash@{0}"</code></td><td>ä¿ç•™ stash è®°å½•ï¼Œå¯å¤šæ¬¡ apply</td></tr><tr><td><strong>ç›´æ¥åˆ é™¤ stash</strong></td><td><code>git stash drop "stash@{0}"</code></td><td><strong>ä¸æ¢å¤å†…å®¹ï¼Œä»…åˆ é™¤è®°å½•</strong>ï¼ˆå›ç­”æœ¬æ–‡å¼€å¤´éœ€æ±‚ï¼‰</td></tr><tr><td><strong>æ¸…ç©ºæ‰€æœ‰ stash</strong></td><td><code>git stash clear</code></td><td>æ°¸ä¹…åˆ é™¤æ‰€æœ‰ stashï¼ˆæ…ç”¨ï¼ï¼‰</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ å°æŠ€å·§ï¼šå¦‚æœä¸æŒ‡å®š stash åç§°ï¼ˆå¦‚ <code>git stash pop</code>ï¼‰ï¼Œé»˜è®¤æ“ä½œ <code>stash@{0}</code>ï¼ˆæœ€æ–°çš„é‚£ä¸ªï¼‰ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-7">å››ã€æœ€ä½³å®è·µå»ºè®®</h3>
<ol>
<li>
<p><strong>åœ¨ PowerShell ä¸­å§‹ç»ˆå¯¹ <code>stash@{n}</code> åŠ åŒå¼•å·</strong><br/>
å…»æˆä¹ æƒ¯ï¼š<code>"stash@{0}"</code> è€Œä¸æ˜¯ <code>stash@{0}</code>ã€‚</p>
</li>
<li>
<p><strong>å…ˆçœ‹å†æ“ä½œ</strong><br/>
æ¢å¤æˆ–åˆ é™¤å‰ï¼Œå…ˆç”¨ <code>git stash show -p "stash@{0}"</code> ç¡®è®¤å†…å®¹ã€‚</p>
</li>
<li>
<p><strong>åŒºåˆ† <code>pop</code> / <code>apply</code> / <code>drop</code></strong></p>
<ul>
<li>æƒ³<strong>æ¢å¤å¹¶åˆ æ‰</strong> â†’ <code>pop</code></li>
<li>æƒ³<strong>æ¢å¤ä½†ä¿ç•™</strong> â†’ <code>apply</code></li>
<li>æƒ³<strong>ç›´æ¥åˆ æ‰ä¸è¦äº†</strong> â†’ <code>drop</code>ï¼ˆè¿™å°±æ˜¯ä½ æœ€åˆçš„éœ€æ±‚ï¼ï¼‰</li>
</ul>
</li>
<li>
<p><strong>é¿å…ä¾èµ–ç´¢å¼•ç¼–å·</strong><br/>
<code>stash@{0}</code> ä¼šéš <code>drop</code> æˆ– <code>pop</code> åŠ¨æ€å˜åŒ–ã€‚å¦‚æœè¦é•¿æœŸä¿ç•™æŸä¸ª stashï¼Œå»ºè®®æ‰“æ ‡ç­¾æˆ–æäº¤åˆ°ä¸´æ—¶åˆ†æ”¯ã€‚</p>
</li>
</ol>
<hr/>
<h3 data-id="heading-8">äº”ã€æ€»ç»“</h3>
<ul>
<li><code>git stash</code> æ˜¯å¼€å‘è€…çš„å¥½å¸®æ‰‹ï¼Œä½†<strong>ç¯å¢ƒå·®å¼‚å¯èƒ½å¼•å‘â€œè¯¡å¼‚â€é”™è¯¯</strong>ã€‚</li>
<li>åœ¨ <strong>Windows PowerShell</strong> ä¸­ï¼Œ<strong>èŠ±æ‹¬å· <code>{}</code> éœ€è¦å¼•å·ä¿æŠ¤</strong>ã€‚</li>
<li>è®°ä½ä¸‰ä¸ªæ ¸å¿ƒåŠ¨ä½œï¼š<br/>
ğŸ‘€ <code>show</code>ï¼ˆçœ‹ï¼‰ã€ğŸ”„ <code>apply/pop</code>ï¼ˆæ¢å¤ï¼‰ã€ğŸ—‘ï¸ <code>drop</code>ï¼ˆåˆ é™¤ï¼‰ã€‚</li>
</ul>
<p>ä¸‹æ¬¡å†çœ‹åˆ° <code>unknown switch 'e'</code>ï¼Œåˆ«æ…Œâ€”â€”å…«æˆæ˜¯å¿˜äº†åŠ å¼•å·ï¼</p>
<blockquote>
<p>ğŸ”„ é™„ï¼šå¦‚æœä½ å¸¸ç”¨ PowerShellï¼Œä¹Ÿå¯ä»¥è€ƒè™‘æ”¹ç”¨ <strong>Git Bash</strong>ï¼Œå®ƒå¯¹ Git å‘½ä»¤çš„å…¼å®¹æ€§æ›´â€œåŸç”Ÿâ€ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‹’ç»ç­‰å¾…ï¼å¦‚ä½•è®© AI ä¸€è¾¹ä¿® Bugï¼Œä¸€è¾¹é‡æ„ä»£ç ï¼Œä¸€è¾¹å¸®ä½ reviewï¼Ÿ]]></title>    <link>https://juejin.cn/post/7596904122865254451</link>    <guid>https://juejin.cn/post/7596904122865254451</guid>    <pubDate>2026-01-19T12:07:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596904122865254451" data-draft-id="7596845113281216521" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‹’ç»ç­‰å¾…ï¼å¦‚ä½•è®© AI ä¸€è¾¹ä¿® Bugï¼Œä¸€è¾¹é‡æ„ä»£ç ï¼Œä¸€è¾¹å¸®ä½ reviewï¼Ÿ"/> <meta itemprop="keywords" content="AIç¼–ç¨‹,å‰ç«¯,åç«¯"/> <meta itemprop="datePublished" content="2026-01-19T12:07:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´"/> <meta itemprop="url" content="https://juejin.cn/user/2175258804632332"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‹’ç»ç­‰å¾…ï¼å¦‚ä½•è®© AI ä¸€è¾¹ä¿® Bugï¼Œä¸€è¾¹é‡æ„ä»£ç ï¼Œä¸€è¾¹å¸®ä½ reviewï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2175258804632332/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T12:07:35.000Z" title="Mon Jan 19 2026 12:07:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åˆ©ç”¨å¥½Git Worktree + Claude Codeï¼šè®© AI å¸®ä½ å¹¶è¡Œå¼€å‘</h2>
<p>ç”¨ AI å†™ä»£ç çš„æ—¶å€™ï¼Œå¤§å®¶æœ‰æ²¡æœ‰é‡åˆ°è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šå®ƒä¸€æ¬¡åªèƒ½å¹²ä¸€ä»¶äº‹ã€‚</p>
<p>ä½ è®©å®ƒé‡æ„ä¸€ä¸ªæ¨¡å—ï¼Œå®ƒå°±åœ¨é‚£å„¿åŸ‹å¤´å¹²ï¼Œä½ åªèƒ½ç­‰ç€ã€‚æƒ³åŒæ—¶è®©å®ƒå¸®ä½ ä¿®ä¸ª bugï¼Ÿä¸è¡Œï¼Œå¾—æ’é˜Ÿã€‚</p>
<p>å…¶å®å¯ä»¥ç”¨ Git Worktree è®©å¤šä¸ª Claude Code å®ä¾‹åŒæ—¶å·¥ä½œï¼Œå„å¹²å„çš„ï¼Œäº’ä¸å¹²æ‰°ã€‚</p>
<h3 data-id="heading-1">Git Worktree æ˜¯ä»€ä¹ˆ</h3>
<p>ç®€å•è¯´ï¼ŒGit Worktree è®©ä½ åœ¨åŒä¸€ä¸ªä»“åº“ä¸‹åŒæ—¶æ£€å‡ºå¤šä¸ªåˆ†æ”¯ï¼Œæ¯ä¸ªåˆ†æ”¯æœ‰è‡ªå·±ç‹¬ç«‹çš„å·¥ä½œç›®å½•ã€‚</p>
<p><strong>å’Œ <code>git clone</code> å¤šä»½çš„åŒºåˆ«</strong>ï¼š</p>
<ul>
<li><code>git clone</code> å¤šä»½ï¼šæ¯ä»½éƒ½æœ‰å®Œæ•´çš„ <code>.git</code> ç›®å½•ï¼Œå ç”¨å¤§é‡ç£ç›˜ç©ºé—´ï¼Œåˆ†æ”¯ä¹‹é—´äº’ä¸çŸ¥é“</li>
<li><code>git worktree</code>ï¼šå…±äº«åŒä¸€ä¸ª <code>.git</code> ç›®å½•ï¼Œå‡ ä¹ä¸å é¢å¤–ç©ºé—´ï¼Œåˆ†æ”¯ä¹‹é—´å¯ä»¥äº’ç›¸çœ‹åˆ°</li>
</ul>
<p><strong>ç›®å½•ç»“æ„ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">my-project/ Â  Â  Â  Â  Â  Â   <span class="hljs-comment"># ä¸»å·¥ä½œåŒºï¼Œä½ è‡ªå·±åœ¨è¿™é‡Œå¼€å‘</span>
../worktrees/
  â”œâ”€â”€ feature-auth/ Â  Â   <span class="hljs-comment"># Claude 1 åœ¨è¿™é‡Œåšè®¤è¯åŠŸèƒ½</span>
  â”œâ”€â”€ fix-bug-123/ Â  Â  Â  <span class="hljs-comment"># Claude 2 åœ¨è¿™é‡Œä¿® bug</span>
  â””â”€â”€ refactor-api/ Â  Â   <span class="hljs-comment"># Claude 3 åœ¨è¿™é‡Œé‡æ„ API</span>
</code></pre>
<p>æ¯ä¸ªç›®å½•éƒ½æ˜¯å®Œæ•´çš„å·¥ä½œåŒºï¼Œå¯ä»¥ç‹¬ç«‹è¿è¡Œã€ç‹¬ç«‹æäº¤ã€ç‹¬ç«‹å¯åŠ¨ Claude Codeã€‚</p>
<p><strong>å½¢è±¡ç‚¹è¯´</strong>ï¼šå°±åƒä½ æœ‰ä¸€ä¸ªå¤§åŠå…¬å®¤ï¼ˆ<code>.git</code> ç›®å½•ï¼‰ï¼Œé‡Œé¢æœ‰å¾ˆå¤šå°éš”é—´ï¼ˆworktreeï¼‰ï¼Œæ¯ä¸ªéš”é—´éƒ½åœ¨å¹²ä¸åŒçš„æ´»ï¼Œä½†å…±äº«åŒä¸€å¥—åŸºç¡€è®¾æ–½ï¼ˆGit å†å²ã€é…ç½®ç­‰ï¼‰ã€‚</p>
<h3 data-id="heading-2">åŸºæœ¬ç”¨æ³•</h3>
<h4 data-id="heading-3">åˆ›å»º worktree</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºæ–°åˆ†æ”¯å¹¶æ£€å‡ºåˆ°ç‹¬ç«‹ç›®å½•</span>
git worktree add ../worktrees/feature-auth -b feature/auth
â€‹
<span class="hljs-comment"># åŸºäºå·²æœ‰åˆ†æ”¯åˆ›å»º</span>
git worktree add ../worktrees/fix-bug origin/fix-bug-123
â€‹
<span class="hljs-comment"># åŸºäºæŸä¸ª commit åˆ›å»º</span>
git worktree add ../worktrees/hotfix abc123
</code></pre>
<h4 data-id="heading-4">åœ¨ worktree ä¸­å¯åŠ¨ Claude Code</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> ../worktrees/feature-auth
claude
</code></pre>
<p>è¿™æ ·å°±æœ‰äº†ä¸€ä¸ªç‹¬ç«‹çš„ Claude Code å®ä¾‹ï¼Œåœ¨ <code>feature/auth</code> åˆ†æ”¯ä¸Šå·¥ä½œã€‚ä½ å¯ä»¥å¼€å¤šä¸ªç»ˆç«¯ï¼Œæ¯ä¸ªç»ˆç«¯è¿›å…¥ä¸åŒçš„ worktreeï¼Œå¯åŠ¨ä¸åŒçš„ Claude Code å®ä¾‹ã€‚</p>
<h4 data-id="heading-5">æŸ¥çœ‹å’Œæ¸…ç†</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰ worktree</span>
git worktree list
â€‹
<span class="hljs-comment"># åˆ é™¤ worktreeï¼ˆä¼šä¿ç•™åˆ†æ”¯ï¼‰</span>
git worktree remove ../worktrees/feature-auth
â€‹
<span class="hljs-comment"># æ¸…ç†å¤±æ•ˆçš„ worktree å¼•ç”¨</span>
git worktree prune
</code></pre>
<h4 data-id="heading-6">å®é™…æ¼”ç¤º</h4>
<p>ä¸‹é¢æ˜¯æˆ‘åœ¨æœ¬åœ°ä»“åº“å®é™…æ‰§è¡Œçš„å‘½ä»¤å’Œè¾“å‡ºï¼š</p>
<p><strong>1. æŸ¥çœ‹å½“å‰ worktree çŠ¶æ€</strong></p>
<pre><code class="hljs language-bash" lang="bash">$ git worktree list
/Users/tsk/JS  64d1da9 [master]
</code></pre>
<p>ç›®å‰åªæœ‰ä¸»å·¥ä½œåŒºã€‚</p>
<p><strong>2. åˆ›å»ºä¸¤ä¸ª worktree</strong></p>
<pre><code class="hljs language-csharp" lang="csharp">$ git worktree <span class="hljs-keyword">add</span> ../worktrees/demo-feature -b demo/<span class="hljs-function">feature
Preparing <span class="hljs-title">worktree</span> (<span class="hljs-params"><span class="hljs-keyword">new</span> branch <span class="hljs-string">'demo/feature'</span></span>)
HEAD <span class="hljs-keyword">is</span> now at 64d1da9 chore: åˆ é™¤ demo HTML æ–‡ä»¶ã€‚
â€‹
$ git worktree <span class="hljs-keyword">add</span> ../worktrees/demo-bugfix -b demo/bugfix
Preparing <span class="hljs-title">worktree</span> (<span class="hljs-params"><span class="hljs-keyword">new</span> branch <span class="hljs-string">'demo/bugfix'</span></span>)
HEAD <span class="hljs-keyword">is</span> now at 64d1da9 chore: åˆ é™¤ demo HTML æ–‡ä»¶ã€‚
</span></code></pre>
<p><strong>3. æŸ¥çœ‹æ‰€æœ‰ worktree</strong></p>
<pre><code class="hljs language-bash" lang="bash">$ git worktree list
/Users/tsk/JS Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   64d1da9 [master]
/Users/tsk/worktrees/demo-bugfix Â  64d1da9 [demo/bugfix]
/Users/tsk/worktrees/demo-feature  64d1da9 [demo/feature]
</code></pre>
<p>ç°åœ¨æœ‰ 3 ä¸ªå·¥ä½œåŒºäº†ï¼Œæ¯ä¸ªéƒ½åœ¨ä¸åŒçš„åˆ†æ”¯ä¸Šã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3bc712ce3b894e9e80107d046eb23755~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lmf5peg6aOO6Zuo5Lmf6Zu-5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769429255&amp;x-signature=vr%2FyBPri6P%2Bsr2ndJKVmFz8ADGs%3D" alt="image.png" loading="lazy"/></p>
<p><strong>4. åœ¨ä¸åŒ worktree ä¸­åˆ†åˆ«æäº¤</strong></p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">åœ¨ demo-feature ä¸­æäº¤</span>
<span class="hljs-meta prompt_">$ </span><span class="bash"><span class="hljs-built_in">cd</span> ../worktrees/demo-feature</span>
<span class="hljs-meta prompt_">$ </span><span class="bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">"# Demo Feature"</span> &gt; README-feature.md</span>
<span class="hljs-meta prompt_">$ </span><span class="bash">git add . &amp;&amp; git commit -m <span class="hljs-string">"feat: add feature readme"</span></span>
[demo/feature dbad1c0] feat: add feature readme
 1 file changed, 1 insertion(+)
 create mode 100644 README-feature.md
â€‹
<span class="hljs-meta prompt_"># </span><span class="bash">åœ¨ demo-bugfix ä¸­æäº¤</span>
<span class="hljs-meta prompt_">$ </span><span class="bash"><span class="hljs-built_in">cd</span> ../worktrees/demo-bugfix</span>
<span class="hljs-meta prompt_">$ </span><span class="bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">"# Bugfix"</span> &gt; BUGFIX.md</span>
<span class="hljs-meta prompt_">$ </span><span class="bash">git add . &amp;&amp; git commit -m <span class="hljs-string">"fix: add bugfix notes"</span></span>
[demo/bugfix 00198c6] fix: add bugfix notes
 1 file changed, 1 insertion(+)
 create mode 100644 BUGFIX.md
</code></pre>
<p><strong>5. æŸ¥çœ‹åˆ†æ”¯å†å²</strong></p>
<pre><code class="hljs language-bash" lang="bash">$ git <span class="hljs-built_in">log</span> --oneline --all --graph -10
* 00198c6 (demo/bugfix) fix: add bugfix notes
| * dbad1c0 (demo/feature) feat: add feature readme
|/ Â 
* 64d1da9 (HEAD -&gt; master, origin/master) chore: åˆ é™¤ demo HTML æ–‡ä»¶ã€‚
* 7a18ac3 feat(<span class="hljs-built_in">log</span>): åˆ é™¤ Vercel React Skill æ–‡æ¡£
* b7ccd2a feat(<span class="hljs-built_in">log</span>): add vscode-ai-commit extension
...
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªåˆ†æ”¯å„è‡ªæœ‰äº†æ–°çš„æäº¤ï¼Œä»åŒä¸€ä¸ªåŸºç‚¹åˆ†å‰å‡ºæ¥ã€‚</p>
<p><strong>6. æ¸…ç† worktree</strong></p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_">$ </span><span class="bash">git worktree remove ../worktrees/demo-feature</span>
<span class="hljs-meta prompt_">$ </span><span class="bash">git worktree remove ../worktrees/demo-bugfix</span>
â€‹
<span class="hljs-meta prompt_">$ </span><span class="bash">git worktree list</span>
/Users/tsk/JS  64d1da9 [master]
â€‹
<span class="hljs-meta prompt_"># </span><span class="bash">åˆ é™¤åˆ†æ”¯ï¼ˆå› ä¸ºæ²¡æœ‰åˆå¹¶ï¼Œéœ€è¦ç”¨ -D å¼ºåˆ¶åˆ é™¤ï¼‰</span>
<span class="hljs-meta prompt_">$ </span><span class="bash">git branch -D demo/feature demo/bugfix</span>
Deleted branch demo/feature (was dbad1c0).
Deleted branch demo/bugfix (was 00198c6).
</code></pre>
<p>æ•´ä¸ªè¿‡ç¨‹å°±æ˜¯è¿™æ ·ï¼Œæ¯ä¸ª worktree éƒ½æ˜¯ç‹¬ç«‹çš„å·¥ä½œç©ºé—´ï¼Œå¯ä»¥åŒæ—¶åœ¨ä¸åŒåˆ†æ”¯ä¸Šå·¥ä½œã€‚</p>
<h3 data-id="heading-7">å®é™…å·¥ä½œæµ</h3>
<p>å‡è®¾ä½ æœ‰ä¸‰ä¸ªä»»åŠ¡è¦åšï¼š</p>
<ol start="0">
<li>å®ç°ç”¨æˆ·è®¤è¯æ¨¡å—ï¼ˆé¢„è®¡ 2 å°æ—¶ï¼‰</li>
<li>ä¿®å¤ä¸€ä¸ªæ”¯ä»˜ç›¸å…³çš„ bugï¼ˆé¢„è®¡ 30 åˆ†é’Ÿï¼‰</li>
<li>é‡æ„ API å±‚ï¼ˆé¢„è®¡ 3 å°æ—¶ï¼‰</li>
</ol>
<p>ä¼ ç»Ÿåšæ³•æ˜¯ä¸€ä¸ªä¸€ä¸ªæ¥ï¼Œæ€»å…±éœ€è¦ 5.5 å°æ—¶ã€‚ç”¨ worktree + Claude Codeï¼Œå¯ä»¥è¿™æ ·ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç»ˆç«¯ 1ï¼šåˆ›å»ºè®¤è¯åŠŸèƒ½çš„ worktree</span>
git worktree add ../worktrees/auth -b feature/auth
<span class="hljs-built_in">cd</span> ../worktrees/auth
claude
<span class="hljs-comment"># å‘Šè¯‰ Claudeï¼šå®ç°ç”¨æˆ·è®¤è¯æ¨¡å—ï¼ŒåŒ…æ‹¬ç™»å½•ã€æ³¨å†Œã€token ç®¡ç†</span>
â€‹
<span class="hljs-comment"># ç»ˆç«¯ 2ï¼šåˆ›å»ºä¿® bug çš„ worktree</span>
git worktree add ../worktrees/fix-payment -b fix/payment-bug
<span class="hljs-built_in">cd</span> ../worktrees/fix-payment
claude
<span class="hljs-comment"># å‘Šè¯‰ Claudeï¼šä¿®å¤æ”¯ä»˜æ¨¡å—çš„ xxx bug</span>
â€‹
<span class="hljs-comment"># ç»ˆç«¯ 3ï¼šåˆ›å»ºé‡æ„çš„ worktree</span>
git worktree add ../worktrees/refactor-api -b refactor/api-layer
<span class="hljs-built_in">cd</span> ../worktrees/refactor-api
claude
<span class="hljs-comment"># å‘Šè¯‰ Claudeï¼šé‡æ„ API å±‚ï¼Œç»Ÿä¸€é”™è¯¯å¤„ç†å’Œå“åº”æ ¼å¼</span>
</code></pre>
<p>ä¸‰ä¸ª Claude åŒæ—¶å¹²æ´»ï¼Œäº’ä¸å¹²æ‰°ã€‚ç†è®ºä¸Šï¼Œå¦‚æœä»»åŠ¡è¶³å¤Ÿç‹¬ç«‹ï¼Œæ€»è€—æ—¶å¯ä»¥å‹ç¼©åˆ°æœ€é•¿ä»»åŠ¡çš„æ—¶é—´ï¼ˆ3 å°æ—¶ï¼‰ï¼Œæ•ˆç‡æå‡ <strong>45%</strong> ã€‚</p>
<p>ä½ å¯ä»¥åœ¨ä¸»å·¥ä½œåŒºç»§ç»­åšè‡ªå·±çš„äº‹ï¼Œå¶å°”åˆ‡è¿‡å»çœ‹çœ‹è¿›åº¦ï¼Œæˆ–è€…ç”¨ Plan Mode è®© Claude å…ˆè¯´æ¸…æ¥šæ‰“ç®—æ€ä¹ˆåšã€‚</p>
<h3 data-id="heading-8">å°è£…æˆå‘½ä»¤</h3>
<p>æ¯æ¬¡æ•²è¿™ä¹ˆå¤šå‘½ä»¤æœ‰ç‚¹çƒ¦ï¼Œå¯ä»¥å°è£…ä¸€ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åŠ åˆ° ~/.zshrc æˆ– ~/.bashrc</span>
<span class="hljs-function"><span class="hljs-title">cw</span></span>() {
  <span class="hljs-built_in">local</span> branch=<span class="hljs-variable">$1</span>
  <span class="hljs-built_in">local</span> worktree_dir=<span class="hljs-string">"../worktrees/<span class="hljs-variable">$branch</span>"</span>
â€‹
 Â <span class="hljs-keyword">if</span> [[ -z <span class="hljs-string">"<span class="hljs-variable">$branch</span>"</span> ]]; <span class="hljs-keyword">then</span>
 Â  Â <span class="hljs-built_in">echo</span> <span class="hljs-string">"ç”¨æ³•: cw &lt;åˆ†æ”¯å&gt;"</span>
 Â   <span class="hljs-built_in">return</span> 1
 Â <span class="hljs-keyword">fi</span>
â€‹
 Â <span class="hljs-comment"># å¦‚æœ worktree ä¸å­˜åœ¨å°±åˆ›å»º</span>
 Â <span class="hljs-keyword">if</span> [[ ! -d <span class="hljs-string">"<span class="hljs-variable">$worktree_dir</span>"</span> ]]; <span class="hljs-keyword">then</span>
 Â  Â git worktree add <span class="hljs-string">"<span class="hljs-variable">$worktree_dir</span>"</span> -b <span class="hljs-string">"<span class="hljs-variable">$branch</span>"</span> 2&gt;/dev/null || \
 Â  Â git worktree add <span class="hljs-string">"<span class="hljs-variable">$worktree_dir</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$branch</span>"</span>
 Â <span class="hljs-keyword">fi</span>
â€‹
 Â <span class="hljs-built_in">cd</span> <span class="hljs-string">"<span class="hljs-variable">$worktree_dir</span>"</span>
  claude
}
</code></pre>
<p>ç”¨èµ·æ¥å°±ä¸€è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">cw feature/auth Â  Â <span class="hljs-comment"># åˆ›å»º worktree å¹¶å¯åŠ¨ Claude Code</span>
</code></pre>
<h3 data-id="heading-9">å¼€å‘å®Œæ€ä¹ˆåˆå¹¶</h3>
<p>å’Œæ™®é€šåˆ†æ”¯å¼€å‘ä¸€æ ·ï¼Œé€šè¿‡ PR æˆ–è€…ç›´æ¥ mergeã€‚</p>
<h4 data-id="heading-10">é€šè¿‡ PRï¼ˆæ¨èï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> ../worktrees/feature-auth
git add .
git commit -m <span class="hljs-string">"feat: implement user authentication"</span>
git push -u origin feature/auth
â€‹
<span class="hljs-comment"># åˆ›å»º PRï¼ˆéœ€è¦å®‰è£… GitHub CLIï¼‰</span>
gh <span class="hljs-built_in">pr</span> create --title <span class="hljs-string">"Add user authentication"</span> --body <span class="hljs-string">"å®ç°ç”¨æˆ·è®¤è¯åŠŸèƒ½"</span>
</code></pre>
<h4 data-id="heading-11">ç›´æ¥ merge</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> ~/projects/my-project Â <span class="hljs-comment"># å›åˆ°ä¸»å·¥ä½œåŒº</span>
git checkout main
git merge feature/auth
git push
</code></pre>
<h4 data-id="heading-12">åˆå¹¶åæ¸…ç†</h4>
<pre><code class="hljs language-bash" lang="bash">git worktree remove ../worktrees/feature-auth
git branch -d feature/auth
</code></pre>
<h3 data-id="heading-13">å‡ ä¸ªæ³¨æ„äº‹é¡¹</h3>
<h4 data-id="heading-14">1. ä»»åŠ¡è¦è¶³å¤Ÿç‹¬ç«‹</h4>
<p>å¦‚æœä¸¤ä¸ªä»»åŠ¡æ”¹çš„æ˜¯åŒä¸€æ‰¹æ–‡ä»¶ï¼Œå¹¶è¡Œå¼€å‘åè€Œä¼šå¢åŠ åˆå¹¶å†²çªã€‚é€‚åˆå¹¶è¡Œçš„æ˜¯é‚£äº›ç›¸å¯¹ç‹¬ç«‹çš„åŠŸèƒ½æ¨¡å—ã€‚</p>
<p><strong>é€‚åˆå¹¶è¡Œ</strong>ï¼š</p>
<ul>
<li>å‰ç«¯ç»„ä»¶ A + åç«¯ API B</li>
<li>åŠŸèƒ½æ¨¡å— X + bug ä¿®å¤ Y</li>
<li>æ•°æ®åº“è¿ç§» + æ–‡æ¡£æ›´æ–°</li>
</ul>
<p><strong>ä¸é€‚åˆå¹¶è¡Œ</strong>ï¼š</p>
<ul>
<li>åŒä¸€ä¸ªæ–‡ä»¶çš„ä¸¤å¤„ä¿®æ”¹</li>
<li>æœ‰å¼ºä¾èµ–å…³ç³»çš„åŠŸèƒ½ï¼ˆB ä¾èµ– A çš„æ¥å£ï¼‰</li>
</ul>
<h4 data-id="heading-15">2. å®šæœŸä» main åŒæ­¥</h4>
<p>é•¿æ—¶é—´ä¸åŒæ­¥ï¼Œåˆ†æ”¯ä¼šåç¦»ä¸»å¹²å¤ªè¿œï¼Œæœ€ååˆå¹¶æ—¶å†²çªä¼šå¾ˆå¤šã€‚å»ºè®®æ¯å¤© merge ä¸€æ¬¡ mainï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> ../worktrees/feature-auth
git fetch origin
git merge origin/main
</code></pre>
<h4 data-id="heading-16">3. ç”¨ Plan Mode å…ˆç¡®è®¤æ–¹æ¡ˆ</h4>
<p>Claude Code æœ‰ä¸ª Plan Modeï¼Œåœ¨åŠ¨æ‰‹ä¹‹å‰å…ˆè®©å®ƒè¯´æ¸…æ¥šæ‰“ç®—æ€ä¹ˆåšã€‚å¹¶è¡Œå¼€å‘æ—¶æ›´éœ€è¦è¿™ä¸ªï¼Œé¿å… Claude è·‘åäº†ä½ è¿˜ä¸çŸ¥é“ã€‚</p>
<p>å¼€å¯æ–¹æ³•ï¼š</p>
<ul>
<li>VS Codeï¼š<code>Cmd/Ctrl + Shift + P</code> â†’ <code>Claude Code: Toggle Plan Mode</code></li>
<li>CLIï¼šå¯åŠ¨æ—¶åŠ  <code>--plan</code> å‚æ•°</li>
</ul>
<h4 data-id="heading-17">4. åˆ«å¼€å¤ªå¤š</h4>
<p>API æœ‰è°ƒç”¨é¢‘ç‡é™åˆ¶ï¼Œå¼€å¤ªå¤š worktree åŒæ—¶è·‘ Claude å¯èƒ½ä¼šè§¦å‘é™æµã€‚æˆ‘è‡ªå·±çš„ç»éªŒæ˜¯ <strong>3-5 ä¸ª</strong> å·®ä¸å¤šäº†ã€‚</p>
<h4 data-id="heading-18">5. æ³¨æ„ä¾èµ–å®‰è£…</h4>
<p>æ¯ä¸ª worktree å…±äº« <code>.git</code>ï¼Œä½† <code>node_modules</code>ã€<code>venv</code> è¿™äº›æ˜¯ç‹¬ç«‹çš„ã€‚å¦‚æœä½ åœ¨ worktree é‡Œè£…äº†æ–°ä¾èµ–ï¼Œè®°å¾—åœ¨ä¸»å·¥ä½œåŒºä¹Ÿè£…ä¸€éã€‚</p>
<h3 data-id="heading-19">é€‚åˆä»€ä¹ˆåœºæ™¯</h3>
<p><strong>é€‚åˆ</strong>ï¼š</p>
<ul>
<li>å¤šä¸ªç‹¬ç«‹åŠŸèƒ½åŒæ—¶å¼€å‘</li>
<li>è·‘é•¿ä»»åŠ¡ï¼ˆé‡æ„ã€è¿ç§»ï¼‰çš„åŒæ—¶ä¸æƒ³é˜»å¡æ—¥å¸¸å¼€å‘</li>
<li>è®©ä¸¤ä¸ª Claude å„å†™ä¸€ç‰ˆï¼Œå¯¹æ¯”é€‰ä¼˜</li>
<li>è·‘ overnight ä»»åŠ¡ï¼Œç¬¬äºŒå¤©èµ·æ¥æ”¶ä»£ç </li>
<li>ç´§æ€¥ hotfix å’Œæ—¥å¸¸å¼€å‘å¹¶è¡Œ</li>
</ul>
<p><strong>ä¸å¤ªé€‚åˆ</strong>ï¼š</p>
<ul>
<li>éœ€æ±‚è¿˜æ²¡æƒ³æ¸…æ¥šï¼Œè¿˜åœ¨æ¢ç´¢é˜¶æ®µ</li>
<li>ä»»åŠ¡ä¹‹é—´æœ‰å¼ºä¾èµ–</li>
<li>é¡¹ç›®å¾ˆå°ï¼Œä¸å€¼å¾—è¿™ä¹ˆæŠ˜è…¾</li>
<li>å›¢é˜Ÿåä½œï¼ˆå®¹æ˜“äº§ç”Ÿåˆ†æ”¯ç®¡ç†æ··ä¹±ï¼‰</li>
</ul>
<h3 data-id="heading-20">å®é™…æ•ˆæœ</h3>
<p>æˆ‘åœ¨è‡ªå·±çš„é¡¹ç›®é‡Œè¯•äº†ä¸€å‘¨ï¼Œå¤§æ¦‚çš„æ„Ÿå—æ˜¯ï¼š</p>
<ul>
<li><strong>æ—¶é—´èŠ‚çœ</strong>ï¼šåŸæœ¬éœ€è¦ä¸²è¡Œå®Œæˆçš„ 3 ä¸ªä»»åŠ¡ï¼Œç°åœ¨å¯ä»¥å¹¶è¡Œï¼Œæ€»è€—æ—¶å‡å°‘çº¦ 40%</li>
<li><strong>å¿ƒæ™ºè´Ÿæ‹…é™ä½</strong>ï¼šä¸ç”¨é¢‘ç¹åˆ‡åˆ†æ”¯ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½æœ‰ç‹¬ç«‹çš„ä¸Šä¸‹æ–‡</li>
<li><strong>ä»£ç è´¨é‡æå‡</strong>ï¼šå¯ä»¥è®©ä¸¤ä¸ª Claude å„å†™ä¸€ç‰ˆï¼Œé€‰æ›´å¥½çš„é‚£ä¸ª</li>
<li><strong>é€‚åˆé•¿ä»»åŠ¡</strong>ï¼šé‡æ„ã€è¿ç§»è¿™ç§è€—æ—¶é•¿çš„ä»»åŠ¡ï¼Œå¯ä»¥æ”¾åœ¨åå°è·‘ï¼Œä¸å½±å“æ—¥å¸¸å¼€å‘</li>
</ul>
<p>ä½†ä¹Ÿæœ‰å‘ï¼š</p>
<ul>
<li>åˆå¹¶å†²çªæ¯”é¢„æœŸå¤šï¼ˆå› ä¸ºæ²¡æœ‰åŠæ—¶åŒæ­¥ mainï¼‰</li>
<li>æœ‰æ—¶å€™ä¼šå¿˜è®°æŸä¸ª worktree è¿˜åœ¨è·‘ï¼Œå¯¼è‡´åˆ†æ”¯è¶Šæ¥è¶Šå¤š</li>
<li>éœ€è¦æ‰‹åŠ¨ç®¡ç†å¤šä¸ªç»ˆç«¯çª—å£ï¼Œæœ‰ç‚¹ä¹±</li>
</ul>
<h3 data-id="heading-21">å‚è€ƒèµ„æ–™</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fincident.io%2Fblog%2Fshipping-faster-with-claude-code-and-git-worktrees" target="_blank" title="https://incident.io/blog/shipping-faster-with-claude-code-and-git-worktrees" ref="nofollow noopener noreferrer">incident.io - Shipping faster with Claude Code and Git Worktrees</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmotlin.com%2Fblog%2Fclaude-code-worktree" target="_blank" title="https://motlin.com/blog/claude-code-worktree" ref="nofollow noopener noreferrer">motlin.com - Claude Code: Parallel Development with /worktree</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgit-scm.com%2Fdocs%2Fgit-worktree" target="_blank" title="https://git-scm.com/docs/git-worktree" ref="nofollow noopener noreferrer">Git å®˜æ–¹æ–‡æ¡£ - git-worktree</a></li>
</ul>
<hr/>
<p>å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©ï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i" target="_blank" title="https://github.com/tt-a1i" ref="nofollow noopener noreferrer">GitHub</a>ï¼Œä¸‹é¢æ˜¯æˆ‘çš„ä¸€äº›å¼€æºé¡¹ç›®ï¼š</p>
<p><strong>Claude Code Skills</strong>ï¼ˆæŒ‰éœ€åŠ è½½ï¼Œæ„å›¾è‡ªåŠ¨è¯†åˆ«ï¼Œä¸æµªè´¹ tokenï¼Œ<a href="https://juejin.cn/post/7578714735307735066" target="_blank" title="https://juejin.cn/post/7578714735307735066">ä»‹ç»æ–‡ç« </a>ï¼‰ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fcode-review-skill" target="_blank" title="https://github.com/tt-a1i/code-review-skill" ref="nofollow noopener noreferrer">code-review-skill</a> - ä»£ç å®¡æŸ¥æŠ€èƒ½ï¼Œè¦†ç›– React 19ã€Vue 3ã€TypeScriptã€Rust ç­‰çº¦ 9000 è¡Œè§„åˆ™ï¼ˆ<a href="https://juejin.cn/post/7578709098255908902" target="_blank" title="https://juejin.cn/post/7578709098255908902">è¯¦ç»†ä»‹ç»</a>ï¼‰</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2F5-whys-skill" target="_blank" title="https://github.com/tt-a1i/5-whys-skill" ref="nofollow noopener noreferrer">5-whys-skill</a> - 5 Whys æ ¹å› åˆ†æï¼Œè¯´"æ‰¾æ ¹å› "è‡ªåŠ¨æ¿€æ´»</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Ffirst-principles-skill" target="_blank" title="https://github.com/tt-a1i/first-principles-skill" ref="nofollow noopener noreferrer">first-principles-skill</a> - ç¬¬ä¸€æ€§åŸç†æ€è€ƒï¼Œé€‚åˆæ¶æ„è®¾è®¡å’ŒæŠ€æœ¯é€‰å‹</li>
</ul>
<p><strong>qwen/gemini/claude - cli åŸç†å­¦ä¹ ç½‘ç«™</strong>ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fcoding-cli-guide" target="_blank" title="https://github.com/tt-a1i/coding-cli-guide" ref="nofollow noopener noreferrer">coding-cli-guide</a>ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Ftt-a1i.github.io%2Fcoding-cli-guide%2F%3Ftab%3Dstart-here" target="_blank" title="https://tt-a1i.github.io/coding-cli-guide/?tab=start-here" ref="nofollow noopener noreferrer">å­¦ä¹ ç½‘ç«™</a>ï¼‰- å­¦ä¹  qwen-cli æ—¶æ•´ç†çš„ç¬”è®°ï¼Œ40+ äº¤äº’å¼åŠ¨ç”»æ¼”ç¤º AI CLI å†…éƒ¨æœºåˆ¶</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/08e50020ab1f45428cd22e53af91a555~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lmf5peg6aOO6Zuo5Lmf6Zu-5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769429255&amp;x-signature=TuWkroMnIYRdDiCkI9%2BsumvfA5Q%3D" alt="coding-cli-guide" loading="lazy"/></p>
<p><strong>å…¨æ ˆé¡¹ç›®</strong>ï¼ˆé€‚åˆå­¦ä¹ ç°ä»£æŠ€æœ¯æ ˆï¼‰ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fprompt-vault" target="_blank" title="https://github.com/tt-a1i/prompt-vault" ref="nofollow noopener noreferrer">prompt-vault</a> - Prompt ç®¡ç†å™¨ï¼Œç”¨çš„éƒ½æ˜¯æœ€æ–°çš„æŠ€æœ¯æ ˆï¼Œé€‚åˆç”¨æ¥å­¦ä¹ äº†è§£æœ€æ–°çš„å‰ç«¯å…¨æ ˆå¼€å‘èŒƒå¼ï¼šNext.js 15 + React 19 + tRPC 11 + Supabase å…¨æ ˆç¤ºä¾‹ï¼Œclone ä¸‹æ¥é…ä¸ªå…è´¹ Supabase å°±èƒ½è·‘</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fchat_edit" target="_blank" title="https://github.com/tt-a1i/chat_edit" ref="nofollow noopener noreferrer">chat_edit</a> - åŒæ¨¡å¼ AI åº”ç”¨ï¼ˆèŠå¤©+å¯Œæ–‡æœ¬ç¼–è¾‘ï¼‰ï¼ŒVue 3.5 + TypeScript + Vite 5 + Quill 2.0 + IndexedDB</li>
</ul>
<p><strong>VS Code æ’ä»¶</strong>ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fvscode-ai-commit" target="_blank" title="https://github.com/tt-a1i/vscode-ai-commit" ref="nofollow noopener noreferrer">vscode-ai-commit</a> - ä¸€é”®ç”Ÿæˆ commit messageï¼Œæ”¯æŒ Conventional Commitsï¼Œå…¼å®¹ä»»ä½• OpenAI æ ¼å¼æ¥å£</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäº YOLOv8 çš„è¾¹å¡æ’æ°´æ²Ÿå µå¡æ™ºèƒ½æ£€æµ‹ç³»ç»Ÿè®¾è®¡ä¸å·¥ç¨‹å®ç° [ç›®æ ‡æ£€æµ‹å®Œæ•´æºç ]]]></title>    <link>https://juejin.cn/post/7596906923892129802</link>    <guid>https://juejin.cn/post/7596906923892129802</guid>    <pubDate>2026-01-19T12:09:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596906923892129802" data-draft-id="7596698363964719142" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäº YOLOv8 çš„è¾¹å¡æ’æ°´æ²Ÿå µå¡æ™ºèƒ½æ£€æµ‹ç³»ç»Ÿè®¾è®¡ä¸å·¥ç¨‹å®ç° [ç›®æ ‡æ£€æµ‹å®Œæ•´æºç ]"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-19T12:09:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘æ˜¯æ°å°¼"/> <meta itemprop="url" content="https://juejin.cn/user/4200579899599495"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäº YOLOv8 çš„è¾¹å¡æ’æ°´æ²Ÿå µå¡æ™ºèƒ½æ£€æµ‹ç³»ç»Ÿè®¾è®¡ä¸å·¥ç¨‹å®ç° [ç›®æ ‡æ£€æµ‹å®Œæ•´æºç ]
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4200579899599495/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘æ˜¯æ°å°¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T12:09:24.000Z" title="Mon Jan 19 2026 12:09:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åŸºäº YOLOv8 çš„è¾¹å¡æ’æ°´æ²Ÿå µå¡æ™ºèƒ½æ£€æµ‹ç³»ç»Ÿè®¾è®¡ä¸å·¥ç¨‹å®ç° [ç›®æ ‡æ£€æµ‹å®Œæ•´æºç ]</h2>
<h3 data-id="heading-1">ä¸€ã€é—®é¢˜èƒŒæ™¯ï¼šä¸ºä»€ä¹ˆè¦â€œè‡ªåŠ¨è¯†åˆ«æ’æ°´æ²Ÿå µå¡â€ï¼Ÿ</h3>
<p>åœ¨å±±åŒºå…¬è·¯ã€æ°´åˆ©å·¥ç¨‹ã€é«˜è¾¹å¡æ²»ç†ç­‰åœºæ™¯ä¸­ï¼Œ<strong>æ’æ°´æ²Ÿæ˜¯å¦ç•…é€š</strong>ç›´æ¥å…³ç³»åˆ°è¾¹å¡ç¨³å®šæ€§ä¸å·¥ç¨‹å®‰å…¨ã€‚ä¸€æ—¦æ’æ°´æ²Ÿè¢«æ³¥æ²™ã€è½çŸ³ã€æ‚ç‰©å µå¡ï¼Œææ˜“åœ¨é™é›¨æ¡ä»¶ä¸‹å¼•å‘ï¼š</p>
<ul>
<li>è¾¹å¡æ¸—æ°´å‹åŠ›éª¤å¢</li>
<li>å±€éƒ¨å†²åˆ·ã€å¡Œé™·</li>
<li>æ»‘å¡ã€æ³¥çŸ³æµç­‰æ¬¡ç”Ÿç¾å®³</li>
</ul>
<p>ä¼ ç»Ÿçš„æ’æ°´æ²Ÿå·¡æ£€ä¸»è¦ä¾èµ–äººå·¥è¸å‹˜æˆ–å®šæœŸå·¡æŸ¥ï¼Œä¸ä»…<strong>æ•ˆç‡ä½ã€è¦†ç›–é¢æœ‰é™</strong>ï¼Œåœ¨é›¨åæˆ–å±é™©åŒºåŸŸç”šè‡³å­˜åœ¨æ˜æ˜¾çš„å®‰å…¨éšæ‚£ã€‚</p>
<p>éšç€æ— äººæœºå·¡æ£€ã€å›ºå®šç›‘æ§æ‘„åƒå¤´çš„æ™®åŠï¼Œç°åœºå·²ç»å…·å¤‡äº†<strong>å¤§é‡å›¾åƒä¸è§†é¢‘æ•°æ®</strong>ï¼Œå…³é”®é—®é¢˜è½¬å˜ä¸ºï¼š</p>
<blockquote>
<p>èƒ½å¦åˆ©ç”¨è®¡ç®—æœºè§†è§‰æŠ€æœ¯ï¼Œè‡ªåŠ¨è¯†åˆ«æ’æ°´æ²Ÿæ˜¯å¦å­˜åœ¨å µå¡é£é™©ï¼Ÿ
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d5e2169316c4448b60ea48e975e7f34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5p2w5bC8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769429364&amp;x-signature=5GJSC6G3VS4sy9642o5r3TONAYM%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
</blockquote>
<h3 data-id="heading-2">æºç ä¸‹è½½ä¸æ•ˆæœæ¼”ç¤º</h3>
<p>å“”å“©å“”å“©è§†é¢‘ä¸‹æ–¹è§‚çœ‹ï¼š
<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1KZgHzJEhn%2F" target="_blank" title="https://www.bilibili.com/video/BV1KZgHzJEhn/" ref="nofollow noopener noreferrer">www.bilibili.com/video/BV1KZâ€¦</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c0a6ebed5f3b48f6b0abd4036f58d583~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5p2w5bC8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769429364&amp;x-signature=n3EIilgUzI9ht0zFEpZzplQtO04%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>åŒ…å«ï¼š</p>
<p>ğŸ“¦å®Œæ•´é¡¹ç›®æºç </p>
<p>ğŸ“¦ é¢„è®­ç»ƒæ¨¡å‹æƒé‡</p>
<p>ğŸ—‚ï¸ æ•°æ®é›†åœ°å€ï¼ˆå«æ ‡æ³¨è„šæœ¬</p>
<hr/>
<h3 data-id="heading-3">äºŒã€æ€»ä½“æ–¹æ¡ˆæ¦‚è¿°</h3>
<p>æœ¬é¡¹ç›®åŸºäº <strong>YOLOv8 ç›®æ ‡æ£€æµ‹æ¡†æ¶</strong>ï¼Œæ„å»ºäº†ä¸€å¥—é¢å‘å·¥ç¨‹åº”ç”¨çš„ <strong>è¾¹å¡æ’æ°´æ²Ÿå µå¡æ™ºèƒ½è¯†åˆ«ç³»ç»Ÿ</strong>ï¼Œå¹¶é€šè¿‡ <strong>PyQt5</strong> å°è£…ä¸ºå¯è§†åŒ–æ¡Œé¢å·¥å…·ï¼Œå®ç°ä»æ¨¡å‹åˆ°åº”ç”¨çš„å®Œæ•´é—­ç¯ã€‚</p>
<h4 data-id="heading-4">ç³»ç»Ÿæ ¸å¿ƒèƒ½åŠ›åŒ…æ‹¬ï¼š</h4>
<ul>
<li>å¯¹æ’æ°´æ²ŸçŠ¶æ€è¿›è¡Œè‡ªåŠ¨è¯†åˆ«ä¸åˆ†ç±»</li>
<li>æ”¯æŒå›¾ç‰‡ / è§†é¢‘ / æ‘„åƒå¤´ç­‰å¤šç§è¾“å…¥æº</li>
<li>å®æ—¶å¯è§†åŒ–æ£€æµ‹ç»“æœä¸ç½®ä¿¡åº¦</li>
<li>æ£€æµ‹ç»“æœå¯ä¿å­˜ã€å¯å¤æ ¸ã€å¯äºŒæ¬¡åˆ†æ</li>
</ul>
<p>ç³»ç»Ÿæ—¢å¯ä½œä¸º<strong>å·¥ç¨‹å·¡æ£€è¾…åŠ©å·¥å…·</strong>ï¼Œä¹Ÿå¯ä½œä¸º<strong>YOLOv8 å·¥ç¨‹åŒ–å®æˆ˜ç¤ºä¾‹</strong>ç”¨äºæ•™å­¦ä¸ç ”ç©¶ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/44c2f38272544906a890f96208c72828~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5p2w5bC8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769429364&amp;x-signature=n20fL%2BmZuzLgiag9OFU7t2mydzs%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-5">ä¸‰ã€ç³»ç»Ÿæ¶æ„è®¾è®¡</h3>
<p>æ•´ä½“ç³»ç»Ÿé‡‡ç”¨â€œ<strong>æ¨¡å‹æ¨ç†å±‚ + åº”ç”¨äº¤äº’å±‚</strong>â€çš„åˆ†å±‚è®¾è®¡ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ•°æ®è¾“å…¥å±‚  â”‚  â† å›¾ç‰‡ / è§†é¢‘ / æ‘„åƒå¤´ / æ— äººæœº
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
<span class="hljs-code">       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚ YOLOv8 æ¨ç†å±‚â”‚  â† å µå¡ç›®æ ‡æ£€æµ‹
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç»“æœè§£ææ¨¡å— â”‚  â† ç±»åˆ« / ç½®ä¿¡åº¦ / åæ ‡
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PyQt5 ç•Œé¢å±‚ â”‚  â† å¯è§†åŒ–å±•ç¤ºä¸äº¤äº’
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre>
<p>è¿™ç§ç»“æ„çš„ä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li><strong>æ¨¡å‹ä¸ç•Œé¢è§£è€¦</strong>ï¼Œä¾¿äºåæœŸæ›¿æ¢æˆ–å‡çº§æ¨¡å‹</li>
<li>æ¨ç†é€»è¾‘å¯ç‹¬ç«‹éƒ¨ç½²ä¸ºæœåŠ¡</li>
<li>UI å±‚åªå…³æ³¨äº¤äº’ä¸å±•ç¤ºï¼Œå·¥ç¨‹å¯ç»´æŠ¤æ€§é«˜
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ac75c66d3ef4e299ad9e301ef7e90b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5p2w5bC8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769429364&amp;x-signature=uGSKJOqcs2CNRIh4qmrq3tgIRXw%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></li>
</ul>
<hr/>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d6e7fab81acd4acd9c4acd4c9ac31a9f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5p2w5bC8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769429364&amp;x-signature=M0msvowEKdjRTYdReuEV96oSd0s%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-6">å››ã€æ£€æµ‹ç›®æ ‡ä¸æ•°æ®è®¾è®¡</h3>
<h4 data-id="heading-7">4.1 æ£€æµ‹ç±»åˆ«å®šä¹‰</h4>
<p>æ ¹æ®å·¥ç¨‹å®é™…éœ€æ±‚ï¼Œå°†æ’æ°´æ²ŸçŠ¶æ€åˆ’åˆ†ä¸ºä¸‰ç±»ï¼š</p>





















<table><thead><tr><th>ç±»åˆ«ç¼–å·</th><th>å«ä¹‰è¯´æ˜</th></tr></thead><tbody><tr><td>0</td><td>æ’æ°´æ²Ÿç•…é€š / æ­£å¸¸</td></tr><tr><td>1</td><td>å­˜åœ¨å±€éƒ¨é®æŒ¡æˆ–è½»å¾®æ·¤ç§¯</td></tr><tr><td>2</td><td>æ˜æ˜¾å µå¡ï¼Œå½±å“æ’æ°´åŠŸèƒ½</td></tr></tbody></table>
<p>è¿™ç§åˆ†çº§æ–¹å¼ç›¸æ¯”â€œæ˜¯å¦å µå¡â€çš„äºŒåˆ†ç±»ï¼Œæ›´æœ‰åˆ©äº<strong>é£é™©è¯„ä¼°ä¸è¿ç»´å†³ç­–</strong>ã€‚</p>
<hr/>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7531baf18ee4581914bc9ae21f90f44~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5p2w5bC8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769429364&amp;x-signature=q5yCloIj3p02GBGraCrW7nVy7dA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-8">4.2 æ•°æ®é›†ç»„ç»‡æ–¹å¼</h4>
<p>é‡‡ç”¨ YOLO æ ‡å‡†æ•°æ®é›†æ ¼å¼ï¼š</p>
<pre><code class="hljs language-text" lang="text">dataset/
â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ train
â”‚   â”œâ”€â”€ val
â”‚   â””â”€â”€ test
â””â”€â”€ labels/
    â”œâ”€â”€ train
    â”œâ”€â”€ val
    â””â”€â”€ test
</code></pre>
<p>æ ‡æ³¨æ–‡ä»¶ä½¿ç”¨ <strong>å½’ä¸€åŒ–åæ ‡æ ¼å¼</strong>ï¼š</p>
<pre><code class="hljs language-text" lang="text">class_id x_center y_center width height
</code></pre>
<p>è¿™ç§ç»“æ„ä¸ Ultralytics YOLOv8 å®Œå…¨å…¼å®¹ï¼Œå¯ç›´æ¥ç”¨äºè®­ç»ƒä¸æ¨ç†ã€‚</p>
<hr/>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e424fb1b80bc4c46b360e595676c10dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5p2w5bC8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769429364&amp;x-signature=g0cQ30w49%2BELSUNJ8GnaTk%2B4vHs%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-9">äº”ã€YOLOv8 æ¨¡å‹è®­ç»ƒä¸ä¼˜åŒ–ç­–ç•¥</h3>
<h4 data-id="heading-10">5.1 ä¸ºä»€ä¹ˆé€‰æ‹© YOLOv8ï¼Ÿ</h4>
<p>YOLOv8 ç›¸æ¯”æ—©æœŸ YOLO ç³»åˆ—ï¼Œåœ¨å·¥ç¨‹å®è·µä¸­å…·æœ‰æ˜æ˜¾ä¼˜åŠ¿ï¼š</p>
<ul>
<li>Anchor-Free è®¾è®¡ï¼Œé™ä½è°ƒå‚å¤æ‚åº¦</li>
<li>å¯¹å°ç›®æ ‡ã€ç»†é•¿ç»“æ„æ›´å‹å¥½</li>
<li>åŸç”Ÿæ”¯æŒ ONNX / TensorRT å¯¼å‡º</li>
<li>æ¨ç†æ¥å£ç®€æ´ï¼Œæ˜“äºäºŒæ¬¡å°è£…</li>
</ul>
<p>å¯¹äºæ’æ°´æ²Ÿè¿™ç§<strong>å½¢æ€ä¸è§„åˆ™ã€å°ºåº¦å˜åŒ–å¤§çš„ç›®æ ‡</strong>ï¼ŒYOLOv8 åœ¨ç²¾åº¦ä¸é€Ÿåº¦ä¹‹é—´å–å¾—äº†è‰¯å¥½å¹³è¡¡ã€‚</p>
<hr/>
<h4 data-id="heading-11">5.2 è®­ç»ƒå‘½ä»¤ç¤ºä¾‹</h4>
<pre><code class="hljs language-bash" lang="bash">yolo detect train \
  data=drain.yaml \
  model=yolov8s.pt \
  epochs=100 \
  batch=16 \
  imgsz=640
</code></pre>
<p>åœ¨å®é™…è®­ç»ƒä¸­ï¼Œé‡ç‚¹å…³æ³¨ä»¥ä¸‹æŒ‡æ ‡ï¼š</p>
<ul>
<li><code>mAP@0.5</code>ï¼šæ•´ä½“æ£€æµ‹èƒ½åŠ›</li>
<li>æ··æ·†çŸ©é˜µï¼šä¸åŒå µå¡ç­‰çº§çš„åŒºåˆ†æƒ…å†µ</li>
<li>æ¨ç†é€Ÿåº¦ï¼šæ˜¯å¦æ»¡è¶³å®æ—¶æ€§éœ€æ±‚</li>
</ul>
<hr/>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b83a2bf31744e8ca84fc72497ec1780~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5p2w5bC8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769429364&amp;x-signature=VuYNY67onLy9Ha%2BpDtrOtL%2FAd10%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-12">å…­ã€æ¨ç†æµç¨‹ä¸ç»“æœè§£æ</h3>
<p>YOLOv8 æ¨ç†æ¥å£éå¸¸é€‚åˆå·¥ç¨‹è°ƒç”¨ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> ultralytics <span class="hljs-keyword">import</span> YOLO

model = YOLO(<span class="hljs-string">"best.pt"</span>)
results = model(<span class="hljs-string">"test.jpg"</span>, conf=<span class="hljs-number">0.3</span>)

<span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> results:
    <span class="hljs-keyword">for</span> box <span class="hljs-keyword">in</span> r.boxes:
        cls = <span class="hljs-built_in">int</span>(box.cls)
        score = <span class="hljs-built_in">float</span>(box.conf)
        <span class="hljs-built_in">print</span>(cls, score)
</code></pre>
<p>æ¯ä¸ªæ£€æµ‹æ¡†éƒ½åŒ…å«ï¼š</p>
<ul>
<li>ç±»åˆ« ID</li>
<li>ç½®ä¿¡åº¦</li>
<li>è¾¹ç•Œæ¡†åæ ‡</li>
</ul>
<p>è¿™äº›ä¿¡æ¯ä¼šè¢«è¿›ä¸€æ­¥ä¼ é€’åˆ° UI å±‚è¿›è¡Œå¯è§†åŒ–æ¸²æŸ“ã€‚</p>
<hr/>
<h3 data-id="heading-13">ä¸ƒã€PyQt5 å¯è§†åŒ–ç³»ç»Ÿè®¾è®¡</h3>
<p>ä¸ºäº†é™ä½ä½¿ç”¨é—¨æ§›ï¼Œç³»ç»Ÿæä¾›äº†å®Œæ•´çš„æ¡Œé¢ç•Œé¢ï¼Œä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li>ä¸€é”®åŠ è½½å›¾ç‰‡æˆ–è§†é¢‘</li>
<li>å®æ—¶æ˜¾ç¤ºæ£€æµ‹ç»“æœ</li>
<li>æ”¯æŒæš‚åœã€æˆªå›¾ã€ç»“æœä¿å­˜</li>
<li>è‡ªåŠ¨ç®¡ç†è¾“å‡ºç›®å½•</li>
</ul>
<p>å³ä¾¿ä¸å…·å¤‡æ·±åº¦å­¦ä¹ èƒŒæ™¯ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç•Œé¢ç›´æ¥å®Œæˆæ£€æµ‹ä»»åŠ¡ã€‚</p>
<hr/>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37dd054aa441493880c1292d2aa943ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv5p2w5bC8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769429364&amp;x-signature=UEnpYVfzD7SOtA2FXKgFGiUu9VA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-14">å…«ã€åº”ç”¨åœºæ™¯ä¸æ‰©å±•æ–¹å‘</h3>
<p>è¯¥ç³»ç»Ÿå¯ç›´æ¥åº”ç”¨äºï¼š</p>
<ul>
<li>è¾¹å¡å·¡æ£€æ— äººæœºæ•°æ®åˆ†æ</li>
<li>æ°´åˆ©è®¾æ–½æ—¥å¸¸è¿ç»´</li>
<li>æ™ºæ…§å·¥åœ°å®‰å…¨ç›‘æµ‹</li>
<li>åœ°è´¨ç¾å®³é£é™©è¾…åŠ©è¯„ä¼°</li>
</ul>
<p>åœ¨æ­¤åŸºç¡€ä¸Šï¼Œè¿˜å¯ä»¥è¿›ä¸€æ­¥æ‰©å±•ï¼š</p>
<ul>
<li>ä¸ GIS ç³»ç»Ÿè”åŠ¨ï¼Œç”Ÿæˆé£é™©åˆ†å¸ƒå›¾</li>
<li>æ¥å…¥æŠ¥è­¦è§„åˆ™ï¼Œå®ç°å µå¡è‡ªåŠ¨å‘Šè­¦</li>
<li>æ¨¡å‹å‡çº§ä¸ºåˆ†å‰²ä»»åŠ¡ï¼Œç²¾ç¡®å®šä½æ·¤ç§¯åŒºåŸŸ</li>
</ul>
<hr/>
<h3 data-id="heading-15">ä¹ã€æ€»ç»“</h3>
<p>æœ¬æ–‡ä»å·¥ç¨‹å®é™…é—®é¢˜å‡ºå‘ï¼Œå®Œæ•´ä»‹ç»äº†ä¸€å¥— <strong>åŸºäº YOLOv8 çš„è¾¹å¡æ’æ°´æ²Ÿå µå¡æ£€æµ‹ç³»ç»Ÿ</strong> çš„è®¾è®¡æ€è·¯ä¸å®ç°è·¯å¾„ã€‚è¯¥ç³»ç»Ÿä¸ä»…éªŒè¯äº† YOLOv8 åœ¨å·¥ç¨‹å·¡æ£€åœºæ™¯ä¸‹çš„å®ç”¨ä»·å€¼ï¼Œä¹Ÿå±•ç¤ºäº† <strong>â€œæ¨¡å‹ + UIâ€ä¸€ä½“åŒ–äº¤ä»˜</strong> çš„å…¸å‹è½åœ°æ–¹å¼ã€‚</p>
<p>å¯¹äºå¸Œæœ›å°†ç›®æ ‡æ£€æµ‹çœŸæ­£åº”ç”¨åˆ°çœŸå®å·¥ç¨‹åœºæ™¯ä¸­çš„å¼€å‘è€…è€Œè¨€ï¼Œè¿™ç±»é¡¹ç›®æ¯”å•çº¯è·‘æ¨¡å‹æŒ‡æ ‡æ›´å…·å‚è€ƒæ„ä¹‰ã€‚</p>
<p><strong>AI ä¸æ­¢äºè®ºæ–‡ï¼Œæ›´é‡è¦çš„æ˜¯è§£å†³ç°å®é—®é¢˜ã€‚</strong></p>
<p>æœ¬æ–‡å›´ç»•è¾¹å¡æ’æ°´æ²Ÿå µå¡è¿™ä¸€å…¸å‹å·¥ç¨‹å®‰å…¨éšæ‚£ï¼Œç³»ç»Ÿæ€§åœ°ä»‹ç»äº†ä¸€ä¸ªåŸºäº YOLOv8 çš„æ™ºèƒ½æ£€æµ‹è§£å†³æ–¹æ¡ˆã€‚ä»é—®é¢˜èƒŒæ™¯ã€ç³»ç»Ÿæ¶æ„ã€æ•°æ®ä¸æ¨¡å‹è®¾è®¡ï¼Œåˆ°æ¨ç†æµç¨‹å’Œå¯è§†åŒ–åº”ç”¨å®ç°ï¼Œå®Œæ•´å±•ç¤ºäº†ç›®æ ‡æ£€æµ‹æŠ€æœ¯åœ¨å®é™…å·¥ç¨‹åœºæ™¯ä¸­çš„è½åœ°è·¯å¾„ã€‚è¯¥ç³»ç»Ÿå…¼é¡¾æ£€æµ‹ç²¾åº¦ã€å®æ—¶æ€§ä¸æ˜“ç”¨æ€§ï¼Œé€šè¿‡å¼•å…¥å›¾å½¢åŒ–ç•Œé¢æœ‰æ•ˆé™ä½äº†ä½¿ç”¨é—¨æ§›ï¼Œå¯ç›´æ¥æœåŠ¡äºè¾¹å¡å·¡æ£€ã€æ°´åˆ©è¿ç»´å’Œåœ°è´¨ç¾å®³é¢„è­¦ç­‰åº”ç”¨åœºæ™¯ã€‚æ•´ä½“å®è·µè¡¨æ˜ï¼Œå°†å…ˆè¿›çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ä¸å·¥ç¨‹åŒ–è®¾è®¡ç›¸ç»“åˆï¼Œæ˜¯æ¨åŠ¨æ™ºæ…§æ°´åˆ©ä¸æ™ºèƒ½å·¡æ£€è½åœ°çš„å…³é”®æ–¹å‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MCP å…¥é—¨ 01ï¼šMCP çš„æœ¬è´¨åŠè„šæ‰‹æ¶æ­å»º]]></title>    <link>https://juejin.cn/post/7596906473306177586</link>    <guid>https://juejin.cn/post/7596906473306177586</guid>    <pubDate>2026-01-19T12:18:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596906473306177586" data-draft-id="7596890557545676846" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MCP å…¥é—¨ 01ï¼šMCP çš„æœ¬è´¨åŠè„šæ‰‹æ¶æ­å»º"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-19T12:18:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‘¸é±¼çš„æ˜¥å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/1714893870865303"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MCP å…¥é—¨ 01ï¼šMCP çš„æœ¬è´¨åŠè„šæ‰‹æ¶æ­å»º
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1714893870865303/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‘¸é±¼çš„æ˜¥å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T12:18:58.000Z" title="Mon Jan 19 2026 12:18:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ç”¨å†™åç«¯ API çš„æ–¹å¼ï¼Œç»™ AI è£…ä¸Šâ€œçœ¼ç›â€å’Œâ€œæ‰‹â€ã€‚</p>
</blockquote>
<h2 data-id="heading-0">èƒŒæ™¯ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦MCPï¼Ÿ</h2>
<p>ä½œä¸ºå¼€å‘è€…ï¼Œä½ è‚¯å®šç”¨è¿‡ ChatGPT æˆ– Claude å†™ä»£ç ã€‚å®ƒä»¬å¾ˆå¼ºï¼Œä½†æœ‰ä¸€ä¸ªè‡´å‘½ç—›ç‚¹ï¼šå®ƒä»¬æ˜¯â€œçâ€çš„ã€‚</p>
<ul>
<li>
<p>å®ƒçœ‹ä¸è§ä½ å…¬å¸å†…ç½‘çš„ APIã€‚</p>
</li>
<li>
<p>å®ƒè¿ä¸ä¸Šä½ æœ¬åœ°çš„æ•°æ®åº“ã€‚</p>
</li>
<li>
<p>å®ƒä¸çŸ¥é“ä½ åˆšå†™çš„ä½ä»£ç å¹³å°é…ç½®é•¿ä»€ä¹ˆæ ·ã€‚</p>
</li>
</ul>
<p>ä»¥å‰ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜çš„åŠæ³•æ˜¯ Ctrl+C / Ctrl+Vï¼ŒæŠŠä»£ç è´´ç»™å®ƒã€‚ä½†å¦‚æœæ•°æ®æœ‰ 1GB å‘¢ï¼Ÿå¦‚æœéœ€è¦å®æ—¶æ“ä½œå‘¢ï¼Ÿéš¾é“éœ€è¦æ¯æ¬¡éƒ½ç²˜è´´ä¸€éå—ï¼Ÿ</p>
<p>å¤ªéº»çƒ¦äº†ï¼</p>
<p>æˆ‘ä»¬éœ€è¦ä¸€ç§åè®®ï¼Œèƒ½è®© <code>AI</code> åœ¨å¿…è¦çš„æ—¶å€™ï¼Œèƒ½è‡ªå·±å»æ‰¾è¿™äº›ä¿¡æ¯ï¼</p>
<p>è¿™ï¼Œå°±æ˜¯ MCP (Model Context Protocol)!</p>
<h2 data-id="heading-1">ä¸€ã€MCP çš„æœ¬è´¨</h2>
<blockquote>
<p>ä½ å¯ä»¥æŠŠå®ƒå½“æˆä¸€ä¸ª <code>HTTP</code> æœ¬åœ°æœåŠ¡ã€‚ä½†ä½ éœ€è¦æ˜ç™½ï¼Œè¿™åªæ˜¯ç±»æ¯”ï¼Œå®ƒç›®å‰æ”¯æŒä¸¤ç§ä¸»æµåè®®ï¼šStdio æœ¬åœ°é€šä¿¡ å’Œ SSE (Server-Sent Events over HTTP) ç½‘ç»œæœåŠ¡ã€‚</p>
</blockquote>
<p>æŠ›å¼€é‚£äº›å®˜æ–¹å®šä¹‰çš„â€œå¤§æ¨¡å‹ä¸Šä¸‹æ–‡åè®®â€ï¼Œä½œä¸ºå‰ç«¯/å…¨æ ˆå¼€å‘è€…ï¼Œä½ åªéœ€è¦è®°ä½ä¸€å¥è¯ï¼š</p>
<blockquote>
<p>MCP Server å°±æ˜¯ä¸€ä¸ªâ€œåç«¯ API æœåŠ¡â€ï¼Œè€Œ AI æ˜¯ä½ çš„â€œå‰ç«¯ UIâ€ã€‚</p>
</blockquote>
<blockquote>
<p>ä½ æŒ‰è§„èŒƒå®šä¹‰æ¥å£ï¼ŒAIæ‰¾ä½ è¦æ•°æ®çš„æ—¶å€™ä½ è¿”ç»™å®ƒå°±å®Œäº‹å„¿äº†ã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1255065406f5478ab1435a12340f3188~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pG46bG855qE5pil5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769429938&amp;x-signature=nZnb77A2JZ6IxJYla9KKygYuaMk%3D" alt="" loading="lazy"/></p>
<p>ä»¥ä¸‹æ˜¯ <code>Web</code>å¼€å‘çš„ä¸€äº›æ¦‚å¿µï¼Œæ˜ å°„åˆ° <code>MCP</code> é‡Œï¼Œä½ ä¸€çœ‹å°±æ‡‚ï¼š</p>






























<table><thead><tr><th>ä¼ ç»Ÿ Web å¼€å‘</th><th>MCP å¼€å‘æ¨¡å¼</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>Frontend (React/Vue)</td><td>AI Client (Claude/OpenCode)</td><td>AI è´Ÿè´£ç†è§£ç”¨æˆ·æ„å›¾ï¼Œå†³å®šâ€œç‚¹å‡»â€å“ªä¸ªæŒ‰é’®ã€‚</td></tr><tr><td>Backend (Express/Koa)</td><td>MCP Server (ä½ çš„è„šæœ¬)</td><td>ä½ å†™çš„é€»è¾‘ï¼Œè´Ÿè´£å¹²æ´»ï¼ˆæŸ¥åº“ã€è°ƒæ¥å£ï¼‰ã€‚</td></tr><tr><td>REST/GraphQL</td><td>MCP Protocol</td><td>ä¸¤è€…é€šè®¯çš„æ ‡å‡†åŒ–åè®®ï¼ˆåŸºäº JSON-RPCï¼‰ã€‚</td></tr><tr><td>Click Event</td><td>Tool Call</td><td>ç”¨æˆ·è¯´â€œæŸ¥ä¸‹è®¢å•â€ï¼ŒAI è§¦å‘å·¥å…·è°ƒç”¨ã€‚</td></tr></tbody></table>
<p>ä¸€ä¸ªæ ‡å‡†çš„ MCP Server ä¸»è¦æä¾›4ç§èƒ½åŠ›ï¼Œå¯¹åº”åˆ°åç«¯æ¦‚å¿µéå¸¸ç›´è§‚ï¼š</p>
<h3 data-id="heading-2">MCP æ ¸å¿ƒæ¥å£è¯´æ˜</h3>
<ol>
<li>
<p><strong>æ ¸å¿ƒæ¥å£ä¸€ï¼šèƒ½åŠ›æ¡æ‰‹ (initialize)</strong></p>
<ul>
<li><strong>HTTP ç±»æ¯”</strong>ï¼š<code>GET /api/health</code> æˆ– <code>OPTIONS /</code></li>
<li><strong>MCP åè®®æ–¹æ³•</strong>ï¼š<code>initialize</code></li>
<li><strong>ä½œç”¨</strong>ï¼šè¿™æ˜¯æ•´ä¸ªåè®®çš„å…¥å£ã€‚å½“ AIï¼ˆClientï¼‰ç¬¬ä¸€æ¬¡è¿æ¥ä½ çš„ MCP Server æ—¶ï¼Œå®ƒä¼šå‘é€è¿™ä¸ªè¯·æ±‚ã€‚ä½ çš„ Server å¿…é¡»è¿”å›ä¸€ä¸ªå›ºå®šçš„ JSON ç»“æ„ï¼Œå‘Šè¯‰ AIï¼šâ€œæˆ‘æ˜¯è°ï¼ˆServeråï¼‰ï¼Œç‰ˆæœ¬å¤šå°‘ï¼Œæˆ‘æ”¯æŒå“ªäº›èƒ½åŠ›ï¼ˆResources? Tools? Promptsï¼Ÿï¼‰â€ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ ¸å¿ƒæ¥å£äºŒï¼šèµ„æºå±‚ (resources/*)</strong></p>
<ul>
<li><strong>æ€»ä½“æè¿°</strong>ï¼šè¿™å¯¹åº” REST API ä¸­çš„ <code>GET</code> è¯·æ±‚ã€‚å®ƒæ˜¯åªè¯»çš„ï¼Œç”¨äºæŠŠæ•°æ®â€œå–‚â€ç»™ AIã€‚</li>
<li><strong>åŠ¨ä½œ</strong>ï¼š
<ul>
<li><strong>åˆ—è¡¨</strong>
<ul>
<li>HTTP ç±»æ¯”ï¼š<code>GET /api/files</code></li>
<li>MCP åè®®æ–¹æ³•ï¼š<code>resources/list</code></li>
<li>ä½œç”¨ï¼šå‘Šè¯‰ AI æˆ‘è¿™é‡Œæœ‰å“ªäº›æ–‡ä»¶/æ•°æ®æºå¯ä¾›æŸ¥é˜…ã€‚</li>
</ul>
</li>
<li><strong>è¯»å–</strong>
<ul>
<li>HTTP ç±»æ¯”ï¼š<code>GET /api/files/:id</code></li>
<li>MCP åè®®æ–¹æ³•ï¼š<code>resources/read</code></li>
<li>ä½œç”¨ï¼šAI æŒ‡å®šä¸€ä¸ª URI (å¦‚ <code>lcp://app/001</code>)ï¼Œä½ è¿”å›å…·ä½“çš„å†…å®¹æ–‡æœ¬ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><strong>æœ¬è´¨</strong>ï¼šè¿™é‡Œçš„æ¥å£å°±æ˜¯è®© AI èƒ½å¤Ÿâ€œçœ‹åˆ°â€ä½ ç³»ç»Ÿé‡Œçš„æ•°æ®ï¼Œä½†ä¸èƒ½æ”¹ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ ¸å¿ƒæ¥å£ä¸‰ï¼šå·¥å…·å±‚ (tools/*)</strong></p>
<ul>
<li><strong>æ€»ä½“æè¿°</strong>ï¼šè¿™å¯¹åº” REST API ä¸­çš„ <code>POST</code> è¯·æ±‚ã€‚å®ƒæ˜¯å¯æ‰§è¡Œçš„ï¼Œç”¨äºè®© AIâ€œæ“ä½œâ€ä½ çš„ç³»ç»Ÿã€‚è¿™æ˜¯æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ã€‚</li>
<li><strong>åŠ¨ä½œ</strong>ï¼š
<ul>
<li><strong>åˆ—è¡¨</strong>
<ul>
<li>HTTP ç±»æ¯”ï¼š<code>GET /api/functions</code> (Swagger)</li>
<li>MCP åè®®æ–¹æ³•ï¼š<code>tools/list</code></li>
<li>ä½œç”¨ï¼šå‘Šè¯‰ AI æˆ‘æœ‰å“ªäº›å‡½æ•°å¯ä»¥è°ƒç”¨ï¼ˆåŒ…æ‹¬å‚æ•°ç»“æ„ JSON Schemaï¼‰ã€‚</li>
</ul>
</li>
<li><strong>è°ƒç”¨</strong>
<ul>
<li>HTTP ç±»æ¯”ï¼š<code>POST /api/execute</code></li>
<li>MCP åè®®æ–¹æ³•ï¼š<code>tools/call</code></li>
<li>ä½œç”¨ï¼šAI å‘é€å‡½æ•°åå’Œå‚æ•°ï¼ˆJSONï¼‰ï¼Œä½ æ‰§è¡Œé€»è¾‘å¹¶è¿”å›ç»“æœã€‚</li>
</ul>
</li>
</ul>
</li>
<li><strong>æœ¬è´¨</strong>ï¼šä½ çš„ä¸šåŠ¡é€»è¾‘ï¼ˆæŸ¥åº“ã€æ”¹é…ç½®ã€å‘é‚®ä»¶ï¼‰å…¨éƒ¨å°è£…åœ¨è¿™é‡Œã€‚</li>
</ul>
</li>
<li>
<p><strong>æ ¸å¿ƒæ¥å£å››ï¼šæç¤ºè¯å±‚ (prompts/*)</strong></p>
<ul>
<li><strong>æ€»ä½“æè¿°</strong>ï¼šè¿™å¯¹åº”æ¨¡æ¿æœåŠ¡ã€‚</li>
<li><strong>åŠ¨ä½œ</strong>ï¼š
<ul>
<li><strong>åˆ—è¡¨</strong>
<ul>
<li>HTTP ç±»æ¯”ï¼š<code>GET /api/templates</code></li>
<li>MCP åè®®æ–¹æ³•ï¼š<code>prompts/list</code></li>
<li>ä½œç”¨ï¼šå‘Šè¯‰ AI æˆ‘æœ‰å“ªäº›é¢„è®¾çš„å¯¹è¯æ¨¡æ¿ã€‚</li>
</ul>
</li>
<li><strong>è·å–</strong>
<ul>
<li>HTTP ç±»æ¯”ï¼š<code>POST /api/render_template</code></li>
<li>MCP åè®®æ–¹æ³•ï¼š<code>prompts/get</code></li>
<li>ä½œç”¨ï¼šAI é€‰æ‹©ä¸€ä¸ªæ¨¡æ¿ï¼Œä½ æŠŠå¡«å……å¥½ä¸Šä¸‹æ–‡çš„ Prompt è¿”å›ç»™å®ƒã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 data-id="heading-3">äºŒã€ åŠ¨æ‰‹æ­å»ºä¸€ä¸ªåŸºäº Node.js çš„è„šæ‰‹æ¶</h2>
<blockquote>
<p>ä¹Ÿå¯ä»¥ä¸æ˜¯ <code>Nodejs</code>ï¼Œå¯ä»¥æ˜¯ <code>Python</code>ã€‚ä½†æˆ‘çš„è¯»è€…å¤§éƒ¨åˆ†æ˜¯å‰ç«¯ï¼Œå’±è¿˜æ˜¯ä»¥<code>Nodejs</code>ä¸ºä¾‹ã€‚</p>
</blockquote>
<ol>
<li>åˆå§‹åŒ–é¡¹ç›®
æ‰¾ä¸ªæ–‡ä»¶å¤¹ï¼Œåƒåˆå§‹åŒ–ä»»ä½•å‰ç«¯é¡¹ç›®ä¸€æ ·ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> my-first-mcp
<span class="hljs-built_in">cd</span> my-first-mcp
npm init -y
</code></pre>
<ol>
<li>å®‰è£…ä¾èµ–
æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªæ ¸å¿ƒåŒ…ï¼š</li>
</ol>
<ul>
<li>
<p>@modelcontextprotocol/sdk: å®˜æ–¹ SDKï¼Œå¤„ç†é€šè®¯åè®®ã€‚</p>
</li>
<li>
<p>zod: ç±»ä¼¼äº TypeScript çš„è¿è¡Œæ—¶æ ¡éªŒã€‚AI ç»å¸¸ä¼šä¼ é”™å‚æ•°ï¼ŒZod æ˜¯æœ€å¥½çš„é˜²çº¿ã€‚</p>
</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">npm install @modelcontextprotocol/sdk zod
</code></pre>
<ol>
<li>é…ç½® ESM
æ‰“å¼€ package.jsonï¼Œæ·»åŠ  "type": "module"ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½ç›´æ¥ç”¨ import çˆ½å†™ä»£ç ã€‚</li>
</ol>
<pre><code class="hljs language-JSON" lang="JSON"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"my-first-mcp"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"module"</span><span class="hljs-punctuation">,</span> 
  <span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> ... <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<ol>
<li>ç¼–å†™æ ¸å¿ƒä»£ç  (index.js)</li>
</ol>
<p>æˆ‘ä»¬åœ¨ index.js é‡Œå†™ä¸€ä¸ªæœ€ç®€å•çš„ Serverï¼Œæ¨¡æ‹ŸæŸ¥è¯¢ä½ ä»¬å…¬å¸ä½ä»£ç å¹³å°çš„çŠ¶æ€ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-meta">#!/usr/bin/env node</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Server</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/server/index.js"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">StdioServerTransport</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/server/stdio.js"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">CallToolRequestSchema</span>, <span class="hljs-title class_">ListToolsRequestSchema</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/types.js"</span>;
<span class="hljs-keyword">import</span> { z } <span class="hljs-keyword">from</span> <span class="hljs-string">"zod"</span>;

<span class="hljs-comment">// 1. å®ä¾‹åŒ– Server</span>
<span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"lcp-helper"</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">"1.0.0"</span> },
  { <span class="hljs-attr">capabilities</span>: { <span class="hljs-attr">tools</span>: {} } }
);

<span class="hljs-comment">// 2. å‘Šè¯‰ AI æˆ‘ä»¬æœ‰å“ªäº›å·¥å…· (ç›¸å½“äº Swagger/OpenAPI æ–‡æ¡£)</span>
server.<span class="hljs-title function_">setRequestHandler</span>(<span class="hljs-title class_">ListToolsRequestSchema</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">tools</span>: [
      {
        <span class="hljs-attr">name</span>: <span class="hljs-string">"get_app_info"</span>,
        <span class="hljs-attr">description</span>: <span class="hljs-string">"æŸ¥è¯¢ä½ä»£ç å¹³å°ä¸­æŸä¸ªåº”ç”¨çš„çŠ¶æ€å’Œè´Ÿè´£äºº"</span>,
        <span class="hljs-attr">inputSchema</span>: {
          <span class="hljs-attr">type</span>: <span class="hljs-string">"object"</span>,
          <span class="hljs-attr">properties</span>: {
            <span class="hljs-attr">appId</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>, <span class="hljs-attr">description</span>: <span class="hljs-string">"åº”ç”¨ID (å¦‚ app_001)"</span> },
          },
          <span class="hljs-attr">required</span>: [<span class="hljs-string">"appId"</span>],
        },
      },
    ],
  };
});

<span class="hljs-comment">// 3. å®ç°å·¥å…·é€»è¾‘ (ç›¸å½“äº SpringBooté‡Œçš„ Controller)</span>
server.<span class="hljs-title function_">setRequestHandler</span>(<span class="hljs-title class_">CallToolRequestSchema</span>, <span class="hljs-keyword">async</span> (request) =&gt; {
  <span class="hljs-keyword">if</span> (request.<span class="hljs-property">params</span>.<span class="hljs-property">name</span> === <span class="hljs-string">"get_app_info"</span>) {
    <span class="hljs-keyword">const</span> args = z.<span class="hljs-title function_">object</span>({ <span class="hljs-attr">appId</span>: z.<span class="hljs-title function_">string</span>() }).<span class="hljs-title function_">parse</span>(request.<span class="hljs-property">params</span>.<span class="hljs-property">arguments</span>);
    
    <span class="hljs-comment">// è¿™é‡Œå¯ä»¥æ¢æˆçœŸå®çš„ axios è¯·æ±‚</span>
    <span class="hljs-comment">// const res = await axios.get(`http://api.internal.com/apps/${args.appId}`);</span>
    <span class="hljs-keyword">const</span> mockData = {
      <span class="hljs-attr">app_001</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">"HRç³»ç»Ÿ"</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">"Online"</span> },
      <span class="hljs-attr">app_002</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">"è´¢åŠ¡ç³»ç»Ÿ"</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">"Down"</span> }
    };
    
    <span class="hljs-keyword">const</span> result = mockData[args.<span class="hljs-property">appId</span>] || { <span class="hljs-attr">error</span>: <span class="hljs-string">"Not Found"</span> };

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">content</span>: [{ <span class="hljs-attr">type</span>: <span class="hljs-string">"text"</span>, <span class="hljs-attr">text</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(result) }],
    };
  }
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"å·¥å…·ä¸å­˜åœ¨"</span>);
});

<span class="hljs-comment">// 4. å¯åŠ¨æœåŠ¡</span>
<span class="hljs-keyword">const</span> transport = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StdioServerTransport</span>();
<span class="hljs-keyword">await</span> server.<span class="hljs-title function_">connect</span>(transport);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"MCP Server running..."</span>);
</code></pre>
<h2 data-id="heading-4">ä¸‰ã€ è¿æ¥ä¸è°ƒè¯•ï¼šè®© AI è¿ä¸Šä½ çš„åç«¯</h2>
<p>å†™å®Œäº† Serverï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª Client (AI) æ¥è¿æ¥å®ƒã€‚</p>
<p>æˆ‘ä»¬ä»¥ å­—èŠ‚çš„ <code>Trae</code> ä¸ºä¾‹ï¼š</p>
<ol>
<li>ç‚¹å³ä¸Šè§’çš„è®¾ç½®æŒ‰é’®ï¼Œæ‰¾åˆ° <code>MCP</code> é€‰é¡¹ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14f82fc261494f95bba1e5cebcbb9885~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pG46bG855qE5pil5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769429938&amp;x-signature=LIQTabD8po877u%2BeBUqmbbx0XiA%3D" alt="" loading="lazy"/></li>
</ol>
<p>é€‰æ‹© â€œæ‰‹åŠ¨æ·»åŠ â€</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f86e67eaded4fca9a457ed0d24be700~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pG46bG855qE5pil5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769429938&amp;x-signature=TLswf2y5mlQOSCNwKdf6rjVXplc%3D" alt="" loading="lazy"/></p>
<p>ç²˜è´´å¦‚ä¸‹jsoné…ç½®ï¼Œæ³¨æ„æŠŠè·¯å¾„æ”¹æˆä½ çš„å·¥ç¨‹ç›®å½•ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"mcpServers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"my-lcp-helper"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"args"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">"/ä½ çš„é¡¹ç›®ç»å¯¹è·¯å¾„/my-first-mcp/index.js"</span>
      <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"env"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"NODE_ENV"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"production"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>ç„¶åä½ å°±èƒ½çœ‹åˆ°ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/60965910607c4b6ab321d4e23ad6941d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pG46bG855qE5pil5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769429938&amp;x-signature=%2BKhLw8N4zoeSwUQsIrSBwX%2FWSYE%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">å››ã€ æµ‹è¯•ä½ çš„ MCP Server</h2>
<p>æ‰“å¼€ <code>Trae</code> çš„ AI å¯¹è¯æ¡†ï¼Œå¯¹è¯ç±»å‹é€‰â€œBuilder With MCPâ€ï¼Œè¾“å…¥ï¼š</p>
<blockquote>
<p>å¸®æˆ‘æŸ¥ä¸€ä¸‹ app_001 è¿™ä¸ªåº”ç”¨ç°åœ¨æ˜¯ä»€ä¹ˆçŠ¶æ€ï¼Ÿ</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6205dc6b20c0495fa13f317e677a449e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pG46bG855qE5pil5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769429938&amp;x-signature=1McrwDrIe6xB4paB5Kl7sNHD3Co%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">äº”ã€ ä¸€äº› Tips</h2>
<ul>
<li>
<p>ç¦å¿Œçš„ console.log: MCP é»˜è®¤ä½¿ç”¨ Stdio (æ ‡å‡†è¾“å…¥è¾“å‡º) é€šè®¯ã€‚</p>
<ul>
<li>
<p>OpenCode ç›‘å¬ä½ çš„ stdout è·å–æ•°æ®ã€‚</p>
</li>
<li>
<p>å¦‚æœä½ å†™äº† console.log("debug")ï¼Œå®ƒä¼šæ±¡æŸ“ JSON æ•°æ®æµï¼Œå¯¼è‡´è¿æ¥ç›´æ¥æŠ¥é”™æ–­å¼€ã€‚</p>
</li>
<li>
<p>è§£æ³•ï¼š è°ƒè¯•ä¿¡æ¯ä¸€å¾‹ç”¨ console.error()ï¼Œæˆ–è€…å†™åˆ°æœ¬åœ° log æ–‡ä»¶é‡Œã€‚</p>
</li>
</ul>
</li>
<li>
<p>ç»å¯¹è·¯å¾„: åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œæ°¸è¿œä½¿ç”¨ç»å¯¹è·¯å¾„æŒ‡å‘ä½ çš„ index.jsã€‚å› ä¸º AI å¯åŠ¨æ—¶ï¼Œå·¥ä½œç›®å½•å¯èƒ½ä¸åœ¨ä½ çš„é¡¹ç›®é‡Œã€‚</p>
</li>
<li>
<p>Token å®‰å…¨: ä¸è¦æŠŠ API Token ç¡¬ç¼–ç åœ¨ JS é‡Œã€‚ä½¿ç”¨ process.env.MY_TOKENï¼Œå¹¶åœ¨ OpenCode çš„é…ç½®æ–‡ä»¶é‡Œçš„ env å­—æ®µæ³¨å…¥å®ƒã€‚</p>
</li>
</ul>
<h2 data-id="heading-7">å…­ã€ å°ç»“</h2>
<p>ç°åœ¨ä½ å·²ç»æ­å»ºäº†ä¸€ä¸ªæœ€åŸºç¡€çš„â€œåªè¯»â€ MCPã€‚ä¸‹èŠ‚è¯¾æˆ‘ä»¬å¯ä»¥å­¦ä¹ æ›´å¤æ‚ä¸€äº›çš„åœºæ™¯ã€‚</p>
<p>ä¸‹è¯¾ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ„å»ºé«˜æ€§èƒ½å¼‚æ­¥å›¾ç‰‡æœåŠ¡å™¨ï¼šä»æ‰å¹³å­˜å‚¨åˆ°å“ˆå¸Œåˆ†ç‰‡]]></title>    <link>https://juejin.cn/post/7596926832912662591</link>    <guid>https://juejin.cn/post/7596926832912662591</guid>    <pubDate>2026-01-19T12:39:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596926832912662591" data-draft-id="7593240931287433268" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ„å»ºé«˜æ€§èƒ½å¼‚æ­¥å›¾ç‰‡æœåŠ¡å™¨ï¼šä»æ‰å¹³å­˜å‚¨åˆ°å“ˆå¸Œåˆ†ç‰‡"/> <meta itemprop="keywords" content="Python,åç«¯"/> <meta itemprop="datePublished" content="2026-01-19T12:39:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Lupino"/> <meta itemprop="url" content="https://juejin.cn/user/3051900006579256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ„å»ºé«˜æ€§èƒ½å¼‚æ­¥å›¾ç‰‡æœåŠ¡å™¨ï¼šä»æ‰å¹³å­˜å‚¨åˆ°å“ˆå¸Œåˆ†ç‰‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3051900006579256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Lupino
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T12:39:54.000Z" title="Mon Jan 19 2026 12:39:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ„å»ºå›¾ç‰‡ä¸Šä¼ ä¸å¤„ç†æœåŠ¡æ—¶ï¼Œéšç€æ–‡ä»¶æ•°é‡ä»å‡ ä¸‡å¢é•¿åˆ°åƒä¸‡çº§åˆ«ï¼ŒåŸå§‹çš„â€œæ‰å¹³åŒ–å­˜å‚¨â€å’Œâ€œåŒæ­¥å¤„ç†â€æ¨¡å¼ä¼šè¿…é€Ÿé‡åˆ°ç“¶é¢ˆã€‚æœ¬æ–‡æ€»ç»“äº†ä¸€å¥—åŸºäº Python (Sanic) çš„é«˜æ€§èƒ½å›¾ç‰‡æœåŠ¡é‡æ„æ–¹æ¡ˆï¼Œæ¶µç›–äº†<strong>å¼‚æ­¥ I/O</strong>ã€<strong>å“ˆå¸Œåˆ†ç‰‡å­˜å‚¨</strong>ã€<strong>æ— é˜»å¡è®¡ç®—</strong>ä»¥åŠ<strong>å‰åç«¯ååŒ</strong>çš„å…¨é“¾è·¯ä¼˜åŒ–ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ æ ¸å¿ƒç—›ç‚¹</h2>
<p>åœ¨é‡æ„ä¹‹å‰ï¼Œç³»ç»Ÿå­˜åœ¨ä»¥ä¸‹ä¸»è¦é—®é¢˜ï¼š</p>
<ol>
<li><strong>æ–‡ä»¶ç³»ç»Ÿç“¶é¢ˆ</strong>ï¼šæ‰€æœ‰æ–‡ä»¶å­˜æ”¾åœ¨åŒä¸€ä¸ªæ ¹ç›®å½•ä¸‹ï¼Œå¯¼è‡´ <code>inode</code> æŸ¥æ‰¾å˜æ…¢ï¼Œ<code>os.listdir</code> ç­‰æ“ä½œåœ¨æ–‡ä»¶æ•°è¿‡ç™¾ä¸‡æ—¶ä¼šæ¶ˆè€—å·¨å¤§å†…å­˜å¹¶é˜»å¡ç³»ç»Ÿã€‚</li>
<li><strong>Event Loop é˜»å¡</strong>ï¼šå›¾ç‰‡ç¼©æ”¾ï¼ˆ<code>pyvips</code>ï¼‰å’Œæ–‡ä»¶åˆ é™¤ï¼ˆ<code>os.remove</code>ï¼‰æ˜¯åŒæ­¥çš„ CPU/IO å¯†é›†å‹æ“ä½œï¼Œç›´æ¥è¿è¡Œåœ¨ Sanic çš„å¼‚æ­¥å¾ªç¯ä¸­ä¼šå¡æ­»æ•´ä¸ª Web æœåŠ¡ï¼Œå¯¼è‡´é«˜å¹¶å‘ä¸‹ Ping å€¼é£™å‡ã€‚</li>
<li><strong>ç¼ºä¹æ‰©å±•æ€§</strong>ï¼šå‰ç«¯ URL ä¾èµ–åç«¯æ•°æ®åº“æŸ¥è¯¢ï¼Œæ— æ³•åˆ©ç”¨ CDN é«˜æ•ˆåˆ†å‘ã€‚</li>
</ol>
<h2 data-id="heading-1">äºŒã€ åç«¯æ¶æ„ä¼˜åŒ– (Python)</h2>
<h3 data-id="heading-2">1. å­˜å‚¨ç­–ç•¥ï¼šå“ˆå¸Œåˆ†ç‰‡ (Hash Sharding)</h3>
<p>ä¸ºäº†è§£å†³å•ç›®å½•æ–‡ä»¶è¿‡å¤šçš„é—®é¢˜ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†åŸºäº SHA256 å“ˆå¸Œçš„åˆ†å±‚å­˜å‚¨ç»“æ„ã€‚</p>
<ul>
<li><strong>æ—§ç»“æ„</strong>ï¼š<code>/uploads/abcdef12345.png</code></li>
<li><strong>æ–°ç»“æ„</strong>ï¼š<code>/uploads/ab/cd/abcdef12345.png</code></li>
</ul>
<p>é€šè¿‡å–å“ˆå¸Œå€¼çš„å‰ 4 ä½ç”Ÿæˆä¸¤çº§å­ç›®å½•ï¼ˆ<code>256 * 256</code>ï¼‰ï¼Œå¯ä»¥å°†åƒä¸‡çº§æ–‡ä»¶å‡åŒ€åˆ†æ•£åˆ° 65,536 ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶å¤¹ä»…å­˜æ”¾æ•°ç™¾ä¸ªæ–‡ä»¶ï¼Œç¡®ä¿å­˜å‚¨æ€§èƒ½çº¿æ€§æ‰©å±•ã€‚</p>
<p>Python</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># file.py æ ¸å¿ƒé€»è¾‘</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_shard_relative_path</span>(<span class="hljs-params">file_key: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""ç”Ÿæˆçš„è·¯å¾„ç»“æ„: ab/cd/"""</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(file_key) &lt; <span class="hljs-number">4</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>
    <span class="hljs-keyword">return</span> os.path.join(file_key[:<span class="hljs-number">2</span>], file_key[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>])
</code></pre>
<h3 data-id="heading-3">2. å¼‚æ­¥åŒ–ä¸çº¿ç¨‹æ±  (AsyncIO + Thread Pool)</h3>
<p>ä¸ºäº†ä¿è¯ Sanic çš„é«˜å¹¶å‘èƒ½åŠ›ï¼Œæˆ‘ä»¬ä¸¥æ ¼åŒºåˆ†äº† <strong>I/O ç»‘å®š</strong> å’Œ <strong>CPU ç»‘å®š</strong> ä»»åŠ¡ã€‚</p>
<ul>
<li><strong>æ–‡ä»¶å†™å…¥</strong>ï¼šä½¿ç”¨ <code>aiofiles</code> å®ç°çœŸæ­£çš„å¼‚æ­¥å†™å…¥ã€‚</li>
<li><strong>CPU/é˜»å¡ IO</strong>ï¼šå°†å›¾ç‰‡ç¼©æ”¾ï¼ˆPyvipsï¼‰å’Œæ–‡ä»¶åˆ é™¤/æŸ¥æ‰¾æ“ä½œå°è£…åœ¨ <code>asyncio.to_thread</code> ä¸­ï¼Œæ”¾å…¥çº¿ç¨‹æ± è¿è¡Œï¼Œé¿å…é˜»å¡ä¸»å¾ªç¯ã€‚</li>
</ul>
<p>Python</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">import</span> aiofiles

<span class="hljs-comment"># å¼‚æ­¥å†™å…¥æ–‡ä»¶</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">save_file</span>(<span class="hljs-params">file_path: <span class="hljs-built_in">str</span>, content: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-literal">None</span>:
    folder = os.path.dirname(file_path)
    <span class="hljs-comment"># å¼‚æ­¥åˆ›å»ºç›®å½•ï¼ˆé˜²æ­¢ mkdir é˜»å¡ï¼‰</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(folder):
        <span class="hljs-keyword">await</span> asyncio.to_thread(os.makedirs, folder, exist_ok=<span class="hljs-literal">True</span>)
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> aiofiles.<span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> fp:
        <span class="hljs-keyword">await</span> fp.write(content)

<span class="hljs-comment"># æ— é˜»å¡çš„åˆ é™¤æ“ä½œ</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">safe_remove_file</span>(<span class="hljs-params">fid: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-literal">None</span>:
    <span class="hljs-comment"># ... è·å– file_key ...</span>
    <span class="hljs-comment"># å°†è€—æ—¶çš„ glob æŸ¥æ‰¾å’Œ remove æ“ä½œæ‰”ç»™çº¿ç¨‹æ± </span>
    <span class="hljs-keyword">await</span> asyncio.to_thread(_remove_related_files_sync, file_key)
</code></pre>
<h2 data-id="heading-4">ä¸‰ã€ å†å²æ•°æ®è¿ç§»</h2>
<p>é’ˆå¯¹ç°å­˜çš„æ‰å¹³ç»“æ„æ–‡ä»¶ï¼Œæˆ‘ä»¬è®¾è®¡äº†å®‰å…¨çš„è¿ç§»è„šæœ¬ <code>migrate.py</code>ã€‚</p>
<ul>
<li><strong>å†…å­˜å®‰å…¨</strong>ï¼šä½¿ç”¨ <code>os.scandir</code> å’Œ <code>glob.iglob</code> æ›¿ä»£ <code>os.listdir</code>ï¼Œé‡‡ç”¨è¿­ä»£å™¨æ¨¡å¼ï¼Œå³ä½¿éå†æ•°äº¿æ–‡ä»¶ä¹Ÿä¸ä¼šçˆ†å†…å­˜ã€‚</li>
<li><strong>åŸå­æ€§</strong>ï¼šåˆ©ç”¨ <code>os.rename</code> åœ¨åŒä¸€æ–‡ä»¶ç³»ç»Ÿä¸‹çš„åŸå­æ€§ï¼Œè¿ç§»ç¬é—´å®Œæˆã€‚</li>
<li><strong>å®‰å…¨æ¨¡å¼</strong>ï¼šé»˜è®¤å¼€å¯ <code>DRY_RUN</code>ï¼Œå…ˆç©ºè·‘éªŒè¯è·¯å¾„é€»è¾‘ï¼Œå†æ‰§è¡Œå®é™…ç§»åŠ¨ã€‚</li>
</ul>
<p>Python</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># è¿ç§»é€»è¾‘ç‰‡æ®µ</span>
<span class="hljs-attr">shard_part</span> = get_shard_folder(filename) <span class="hljs-comment"># è®¡ç®— ab/cd</span>
<span class="hljs-attr">target_dir</span> = os.path.join(UPLOAD_PATH, shard_part)
<span class="hljs-comment"># ç§»åŠ¨æ–‡ä»¶</span>
os.rename(entry.path, os.path.join(target_dir, filename))
</code></pre>
<h2 data-id="heading-5">å››ã€ å‰ç«¯è·¯ç”±é€‚é… (JavaScript/TypeScript)</h2>
<p>ä¸ºäº†é…åˆåç«¯çš„å­˜å‚¨å˜æ›´ï¼Œå‰ç«¯ä¸å†ä¾èµ–åç«¯è¿”å›å®Œæ•´ URLï¼Œè€Œæ˜¯æ ¹æ® <code>file_key</code> è‡ªåŠ¨è®¡ç®—åˆ†ç‰‡è·¯å¾„ã€‚è¿™ä¸ä»…å‡è½»äº†æ•°æ®åº“å‹åŠ›ï¼Œè¿˜æ”¯æŒäº†åŠ¨æ€çš„å›¾ç‰‡å°ºå¯¸è°ƒæ•´ï¼ˆ<code>_fw</code> å‚æ•°ï¼‰ã€‚</p>
<h3 data-id="heading-6">æ™ºèƒ½ URL ç”Ÿæˆå™¨</h3>
<p>JavaScript</p>
<pre><code class="hljs language-ini" lang="ini">/**
 * å‰ç«¯æ ¹æ® Hash è‡ªåŠ¨ç”Ÿæˆåˆ†ç‰‡è·¯å¾„
 * è¾“å…¥: <span class="hljs-attr">key</span>=<span class="hljs-string">"abcde..."</span>, ext=<span class="hljs-string">"png"</span>, size=<span class="hljs-number">200</span>
 * è¾“å‡º: /uploads/ab/cd/abcde..._fw200.png
 */
export function getFileUrl(fileKey, fileExt, <span class="hljs-attr">size</span> = <span class="hljs-number">0</span>) {
  const <span class="hljs-attr">shard1</span> = fileKey.slice(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>)<span class="hljs-comment">;</span>
  const <span class="hljs-attr">shard2</span> = fileKey.slice(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>)<span class="hljs-comment">;</span>
  
  let <span class="hljs-attr">fileName</span> = `<span class="hljs-variable">${fileKey}</span>.<span class="hljs-variable">${fileExt}</span>`<span class="hljs-comment">;</span>
  if (size &gt; 0) {
    <span class="hljs-attr">fileName</span> = `<span class="hljs-variable">${fileKey}</span>_fw<span class="hljs-variable">${size}</span>.<span class="hljs-variable">${fileExt}</span>`<span class="hljs-comment">;</span>
  }

  return `${BASE_URL}/${shard1}/${shard2}/${fileName}`<span class="hljs-comment">;</span>
}
</code></pre>
<h3 data-id="heading-7">å­˜é‡ URL ä¿®å¤</h3>
<p>å¯¹äºå†å²æ•°æ®ä¸­å­˜å‚¨çš„æ—§ç‰ˆ URLï¼ˆä¸å¸¦åˆ†ç‰‡è·¯å¾„ï¼‰ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ª <code>fixFileUrl</code> å‡½æ•°è¿›è¡Œè¿è¡Œæ—¶è‡ªåŠ¨ä¿®å¤ã€‚</p>
<p>JavaScript</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// è¾“å…¥: "http://cdn.com/abcdef123.png"</span>
<span class="hljs-comment">// è¾“å‡º: "http://cdn.com/ab/cd/abcdef123.png"</span>
<span class="hljs-function"><span class="hljs-keyword">export</span> function <span class="hljs-title">fixFileUrl</span><span class="hljs-params">(url, size = <span class="hljs-number">0</span>)</span> </span>{
    <span class="hljs-comment">// è‡ªåŠ¨æ£€æµ‹æ˜¯å¦ç¼ºå°‘åˆ†ç‰‡è·¯å¾„å¹¶æ³¨å…¥</span>
    <span class="hljs-comment">// è‡ªåŠ¨å¤„ç† _fw å°ºå¯¸å‚æ•°çš„æ›¿æ¢</span>
}
</code></pre>
<h2 data-id="heading-8">äº”ã€ Sanic è·¯ç”±é›†æˆ</h2>
<p>æœ€åï¼Œåœ¨ Web å±‚é¢ä¸Šï¼Œæˆ‘ä»¬ç¡®ä¿è·¯ç”±å¤„ç†å‡½æ•°ä¹Ÿæ˜¯å®Œå…¨å¼‚æ­¥çš„ï¼Œèƒ½å¤Ÿä»å®¹åº”å¯¹é«˜å¹¶å‘è¯·æ±‚ã€‚</p>
<p>Python</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">'/upload/&lt;file_name:path&gt;'</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">serve_uploaded_file</span>(<span class="hljs-params">request, file_name</span>):
    <span class="hljs-comment"># åœ¨çº¿ç¨‹æ± ä¸­è®¡ç®—çœŸå®è·¯å¾„ï¼ˆåŒ…å«å¯èƒ½å‘ç”Ÿçš„å›¾ç‰‡ç¼©æ”¾è®¡ç®—ï¼‰</span>
    real_path = <span class="hljs-keyword">await</span> asyncio.to_thread(file.get_real_file_path, file_name)

    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> real_path <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> os.path.exists(real_path):
        <span class="hljs-keyword">return</span> response.text(<span class="hljs-string">"File not found"</span>, status=<span class="hljs-number">404</span>)

    <span class="hljs-comment"># é«˜æ•ˆæµå¼å‘é€</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> response.file(real_path)
</code></pre>
<h2 data-id="heading-9">æ€»ç»“</h2>
<p>é€šè¿‡è¿™æ¬¡é‡æ„ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªåŸºç¡€çš„å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½å‡çº§ä¸ºä¼ä¸šçº§çš„é«˜æ€§èƒ½æ–‡ä»¶æœåŠ¡ã€‚</p>
<ol>
<li><strong>æ€§èƒ½</strong>ï¼šæ¶ˆé™¤äº†ä¸»çº¿ç¨‹é˜»å¡ï¼Œå¤§å¹…æå‡äº†å¹¶å‘ååé‡ (RPS)ã€‚</li>
<li><strong>æ‰©å±•æ€§</strong>ï¼šå“ˆå¸Œåˆ†ç‰‡å½»åº•è§£å†³äº†æ–‡ä»¶ç³»ç»Ÿ inode é™åˆ¶ï¼Œæ”¯æŒäº¿çº§æ–‡ä»¶å­˜å‚¨ã€‚</li>
<li><strong>å¯ç»´æŠ¤æ€§</strong>ï¼šä»£ç éµå¾ª PEP 8ï¼Œé€»è¾‘æ¸…æ™°ï¼Œå‰åç«¯é€šè¿‡ç¡®å®šæ€§çš„ Hash ç®—æ³•è§£è€¦ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäº Nginx ä¸ Shell çš„è½»é‡çº§è“ç»¿éƒ¨ç½²å®è·µï¼šä»¥ RuoYi-Admin ä¸ºä¾‹]]></title>    <link>https://juejin.cn/post/7596926832912646207</link>    <guid>https://juejin.cn/post/7596926832912646207</guid>    <pubDate>2026-01-19T12:39:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596926832912646207" data-draft-id="7593262196843724852" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäº Nginx ä¸ Shell çš„è½»é‡çº§è“ç»¿éƒ¨ç½²å®è·µï¼šä»¥ RuoYi-Admin ä¸ºä¾‹"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2026-01-19T12:39:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Lupino"/> <meta itemprop="url" content="https://juejin.cn/user/3051900006579256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäº Nginx ä¸ Shell çš„è½»é‡çº§è“ç»¿éƒ¨ç½²å®è·µï¼šä»¥ RuoYi-Admin ä¸ºä¾‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3051900006579256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Lupino
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T12:39:07.000Z" title="Mon Jan 19 2026 12:39:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æŒç»­é›†æˆ/æŒç»­éƒ¨ç½² (CI/CD) çš„æµç¨‹ä¸­ï¼Œ<strong>è“ç»¿éƒ¨ç½² (Blue/Green Deployment)</strong> æ˜¯ä¸€ç§é€šè¿‡è¿è¡Œä¸¤ä¸ªç›¸åŒçš„ç”Ÿäº§ç¯å¢ƒï¼ˆç‰ˆæœ¬ä¸åŒï¼‰æ¥å‡å°‘åœæœºæ—¶é—´å’Œé£é™©çš„ç­–ç•¥ã€‚</p>
<p>æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä¸ä¾èµ–å¤æ‚çš„å®¹å™¨ç¼–æ’å·¥å…·ï¼ˆå¦‚ K8sï¼‰ï¼Œä»…ä½¿ç”¨ <strong>Nginx</strong>ã€<strong>Systemd</strong> å’Œ <strong>Bash Shell</strong>ï¼Œä¸º Java åº”ç”¨ï¼ˆå¦‚ RuoYi-Adminï¼‰æ„å»ºä¸€å¥—ç¨³å¥çš„è“ç»¿éƒ¨ç½²ç³»ç»Ÿã€‚</p>
<h2 data-id="heading-0">1. æ ¸å¿ƒæ¶æ„è®¾è®¡</h2>
<p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å®ç°<strong>é›¶åœæœºå‘å¸ƒ</strong>ã€‚ç³»ç»Ÿç”±ä¸¤ä¸ªç¯å¢ƒç»„æˆï¼š</p>
<ul>
<li><strong>Blue (A)</strong> : å½“å‰åœ¨çº¿ç¯å¢ƒï¼Œæ‰¿è½½ç”¨æˆ·æµé‡ã€‚</li>
<li><strong>Green (B)</strong> : å¾…å‘å¸ƒç¯å¢ƒï¼Œéƒ¨ç½²æ–°ç‰ˆæœ¬ä»£ç ã€‚</li>
</ul>
<p>åˆ‡æ¢æœºåˆ¶ï¼š</p>
<p>é€šè¿‡ä¿®æ”¹ Nginx çš„ upstream é…ç½®æ–‡ä»¶æŒ‡å‘ï¼Œå¹¶é‡è½½ Nginx (reload)ï¼Œå°†æµé‡ç¬é—´ä»æ—§ç¯å¢ƒåˆ‡åˆ°æ–°ç¯å¢ƒã€‚</p>
<p><strong>ç›®å½•ç»“æ„ç¤ºä¾‹ï¼š</strong></p>
<p>Plaintext</p>
<pre><code class="hljs language-bash" lang="bash">/data/deploy/
â”œâ”€â”€ nginx/
â”‚   â”œâ”€â”€ AorB           <span class="hljs-comment"># çŠ¶æ€æ–‡ä»¶ï¼Œè®°å½•ä¸‹ä¸€æ¬¡è¯¥å‘ A è¿˜æ˜¯ B</span>
â”‚   â”œâ”€â”€ upstream.conf  <span class="hljs-comment"># Nginx å®é™…å¼•ç”¨çš„é…ç½®æ–‡ä»¶</span>
â”‚   â”œâ”€â”€ ruoyi-admin.a.conf.tmpl <span class="hljs-comment"># æŒ‡å‘ç«¯å£ 9001 çš„æ¨¡æ¿</span>
â”‚   â””â”€â”€ ruoyi-admin.b.conf.tmpl <span class="hljs-comment"># æŒ‡å‘ç«¯å£ 9002 çš„æ¨¡æ¿</span>
â””â”€â”€ system/
    â”œâ”€â”€ prod/ruoyi-admin.jar    <span class="hljs-comment"># å¾…å‘å¸ƒçš„æœ€æ–°åŒ…</span>
    â”œâ”€â”€ ruoyi-admin.a.jar       <span class="hljs-comment"># A ç¯å¢ƒè¿è¡ŒåŒ…</span>
    â””â”€â”€ ruoyi-admin.b.jar       <span class="hljs-comment"># B ç¯å¢ƒè¿è¡ŒåŒ…</span>
</code></pre>
<h2 data-id="heading-1">2. ç”Ÿäº§çº§éƒ¨ç½²è„šæœ¬ (Shell Implementation)</h2>
<p>ä»¥ä¸‹æ˜¯ä¼˜åŒ–åçš„ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²è„šæœ¬ã€‚å®ƒé›†æˆäº†å¥åº·æ£€æŸ¥ã€è¶…æ—¶æ§åˆ¶å’Œè‡ªåŠ¨å›æ»šé€»è¾‘ã€‚</p>
<p>Bash</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/usr/bin/env bash</span>

<span class="hljs-comment"># --- 1. é…ç½®åŒºåŸŸ ---</span>
ROOT=<span class="hljs-string">"/data/deploy"</span>
AB_FILE=<span class="hljs-string">"<span class="hljs-variable">${ROOT}</span>/nginx/AorB"</span>
JAR_SRC=<span class="hljs-string">"<span class="hljs-variable">${ROOT}</span>/system/prod/ruoyi-admin.jar"</span>

<span class="hljs-comment"># å¥åº·æ£€æŸ¥é…ç½®ï¼š30æ¬¡é‡è¯• * 2ç§’é—´éš” = 60ç§’è¶…æ—¶</span>
MAX_RETRIES=30
SLEEP_SEC=2

<span class="hljs-comment"># åˆå§‹åŒ–çŠ¶æ€æ–‡ä»¶</span>
<span class="hljs-keyword">if</span> [ ! -f <span class="hljs-string">"<span class="hljs-variable">$AB_FILE</span>"</span> ]; <span class="hljs-keyword">then</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">"A"</span> &gt; <span class="hljs-string">"<span class="hljs-variable">$AB_FILE</span>"</span>; <span class="hljs-keyword">fi</span>
TARGET_KEY=$(<span class="hljs-built_in">cat</span> <span class="hljs-string">"<span class="hljs-variable">${AB_FILE}</span>"</span>)

<span class="hljs-function"><span class="hljs-title">log</span></span>() { <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-subst">$(date +'%Y-%m-%d %H:%M:%S')</span> <span class="hljs-variable">$1</span>"</span>; }

<span class="hljs-comment"># --- 2. å¥åº·æ£€æŸ¥å‡½æ•° ---</span>
<span class="hljs-function"><span class="hljs-title">check_health</span></span>() {
    <span class="hljs-built_in">local</span> port=<span class="hljs-variable">$1</span>
    <span class="hljs-built_in">local</span> count=0
    <span class="hljs-built_in">local</span> url=<span class="hljs-string">"http://127.0.0.1:<span class="hljs-variable">${port}</span>/auth/code"</span> <span class="hljs-comment"># æ ¹æ®å®é™…ä¸šåŠ¡æ¥å£è°ƒæ•´</span>

    <span class="hljs-built_in">log</span> <span class="hljs-string">"æ­£åœ¨æ£€æŸ¥ç«¯å£ <span class="hljs-variable">${port}</span> çš„å¥åº·çŠ¶æ€..."</span>

    <span class="hljs-keyword">while</span> [ <span class="hljs-variable">$count</span> -lt <span class="hljs-variable">$MAX_RETRIES</span> ]; <span class="hljs-keyword">do</span>
        <span class="hljs-comment"># é™é»˜æ•è· curl è¾“å‡º</span>
        <span class="hljs-built_in">local</span> resp=$(curl -s <span class="hljs-string">"<span class="hljs-variable">${url}</span>"</span>)

        <span class="hljs-comment"># åˆ¤å®šé€»è¾‘ï¼šæ ¹æ®ä¸šåŠ¡è¿”å›çš„å…³é”®å­—ç¬¦åˆ¤æ–­</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$resp</span>"</span> | grep -q <span class="hljs-string">"æ“ä½œæˆåŠŸ"</span>; <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">log</span> <span class="hljs-string">"å¥åº·æ£€æŸ¥é€šè¿‡ (Success)ã€‚"</span>
            <span class="hljs-built_in">return</span> 0
        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$resp</span>"</span> | grep -q <span class="hljs-string">"Visit too frequently"</span>; <span class="hljs-keyword">then</span>
            <span class="hljs-built_in">log</span> <span class="hljs-string">"å¥åº·æ£€æŸ¥é€šè¿‡ (Rate Limit)ã€‚"</span>
            <span class="hljs-built_in">return</span> 0
        <span class="hljs-keyword">fi</span>

        <span class="hljs-built_in">echo</span> -n <span class="hljs-string">"."</span>
        <span class="hljs-built_in">sleep</span> <span class="hljs-variable">$SLEEP_SEC</span>
        ((count++))
    <span class="hljs-keyword">done</span>

    <span class="hljs-built_in">log</span> <span class="hljs-string">"\né”™è¯¯ï¼šå¥åº·æ£€æŸ¥è¶…æ—¶ (60s)ã€‚"</span>
    <span class="hljs-built_in">return</span> 1
}

<span class="hljs-comment"># --- 3. éƒ¨ç½²æ ¸å¿ƒé€»è¾‘ ---</span>
<span class="hljs-function"><span class="hljs-title">deploy</span></span>() {
    <span class="hljs-built_in">local</span> target=<span class="hljs-variable">$1</span>      <span class="hljs-comment"># e.g., "a"</span>
    <span class="hljs-built_in">local</span> port=<span class="hljs-variable">$2</span>        <span class="hljs-comment"># e.g., 9001</span>
    <span class="hljs-built_in">local</span> old_target=<span class="hljs-variable">$3</span>  <span class="hljs-comment"># e.g., "b"</span>

    <span class="hljs-built_in">log</span> <span class="hljs-string">"=== å¼€å§‹éƒ¨ç½²ç¯å¢ƒ: <span class="hljs-variable">${target}</span> (ç«¯å£ <span class="hljs-variable">${port}</span>) ==="</span>

    <span class="hljs-comment"># æ­¥éª¤ A: å¤åˆ¶ JAR åŒ…</span>
    <span class="hljs-keyword">if</span> ! <span class="hljs-built_in">cp</span> <span class="hljs-string">"<span class="hljs-variable">${JAR_SRC}</span>"</span> <span class="hljs-string">"<span class="hljs-variable">${ROOT}</span>/system/ruoyi-admin.<span class="hljs-variable">${target}</span>.jar"</span>; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">log</span> <span class="hljs-string">"é”™è¯¯ï¼šJAR åŒ…å¤åˆ¶å¤±è´¥ã€‚"</span>
        <span class="hljs-built_in">exit</span> 1
    <span class="hljs-keyword">fi</span>

    <span class="hljs-comment"># æ­¥éª¤ B: å¯åŠ¨æ–°æœåŠ¡</span>
    <span class="hljs-built_in">log</span> <span class="hljs-string">"æ­£åœ¨å¯åŠ¨ Systemd æœåŠ¡: ruoyi-admin.<span class="hljs-variable">${target}</span> ..."</span>
    sudo systemctl start <span class="hljs-string">"ruoyi-admin.<span class="hljs-variable">${target}</span>"</span>

    <span class="hljs-comment"># æ­¥éª¤ C: æ‰§è¡Œå¥åº·æ£€æŸ¥</span>
    <span class="hljs-keyword">if</span> ! check_health <span class="hljs-string">"<span class="hljs-variable">$port</span>"</span>; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">log</span> <span class="hljs-string">"éƒ¨ç½²å¤±è´¥ï¼šæœåŠ¡æ— æ³•å¯åŠ¨æˆ–æ¥å£å¼‚å¸¸ã€‚æ­£åœ¨åœæ­¢æ–°æœåŠ¡..."</span>
        sudo systemctl stop <span class="hljs-string">"ruoyi-admin.<span class="hljs-variable">${target}</span>"</span>
        <span class="hljs-built_in">exit</span> 1
    <span class="hljs-keyword">fi</span>

    <span class="hljs-comment"># æ­¥éª¤ D: åˆ‡æ¢æµé‡ (Nginx)</span>
    <span class="hljs-built_in">log</span> <span class="hljs-string">"æœåŠ¡å¥åº·ã€‚æ­£åœ¨åˆ‡æ¢ Nginx æµé‡..."</span>
    <span class="hljs-built_in">cp</span> <span class="hljs-string">"<span class="hljs-variable">${ROOT}</span>/nginx/ruoyi-admin.<span class="hljs-variable">${target}</span>.conf.tmpl"</span> <span class="hljs-string">"<span class="hljs-variable">${ROOT}</span>/nginx/upstream.conf"</span>

    <span class="hljs-comment"># é¢„æ£€ Nginx é…ç½®ï¼Œé˜²æ­¢é…ç½®é”™è¯¯å¯¼è‡´æ•´ä¸ªæœåŠ¡æŒ‚æ‰</span>
    <span class="hljs-keyword">if</span> ! sudo nginx -t; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">log</span> <span class="hljs-string">"é”™è¯¯ï¼šNginx é…ç½®æµ‹è¯•å¤±è´¥ï¼Œå–æ¶ˆåˆ‡æ¢ã€‚"</span>
        <span class="hljs-built_in">exit</span> 1
    <span class="hljs-keyword">fi</span>

    sudo nginx -s reload
    <span class="hljs-built_in">log</span> <span class="hljs-string">"Nginx é‡è½½æˆåŠŸï¼Œæµé‡å·²åˆ‡æ¢ã€‚"</span>

    <span class="hljs-comment"># æ­¥éª¤ E: ä¸‹çº¿æ—§æœåŠ¡</span>
    <span class="hljs-built_in">log</span> <span class="hljs-string">"æ­£åœ¨åœæ­¢æ—§æœåŠ¡: ruoyi-admin.<span class="hljs-variable">${old_target}</span> ..."</span>
    sudo systemctl stop <span class="hljs-string">"ruoyi-admin.<span class="hljs-variable">${old_target}</span>"</span>

    <span class="hljs-comment"># æ­¥éª¤ F: æ›´æ–°çŠ¶æ€æ ‡è®°</span>
    <span class="hljs-built_in">local</span> next_target=<span class="hljs-string">"A"</span>
    [ <span class="hljs-string">"<span class="hljs-variable">$target</span>"</span> == <span class="hljs-string">"a"</span> ] &amp;&amp; next_target=<span class="hljs-string">"B"</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$next_target</span>"</span> &gt; <span class="hljs-string">"<span class="hljs-variable">${AB_FILE}</span>"</span>

    <span class="hljs-built_in">log</span> <span class="hljs-string">"=== éƒ¨ç½²æˆåŠŸã€‚ä¸‹ä¸€æ¬¡å‘å¸ƒç›®æ ‡: <span class="hljs-variable">${next_target}</span> ==="</span>
}

<span class="hljs-comment"># --- 4. ä¸»æµç¨‹å…¥å£ ---</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"æœ¬æ¬¡å‘å¸ƒç›®æ ‡: <span class="hljs-variable">$TARGET_KEY</span>"</span>

<span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$TARGET_KEY</span>"</span> == <span class="hljs-string">"A"</span> ]; <span class="hljs-keyword">then</span>
    deploy <span class="hljs-string">"a"</span> 9001 <span class="hljs-string">"b"</span>
<span class="hljs-keyword">elif</span> [ <span class="hljs-string">"<span class="hljs-variable">$TARGET_KEY</span>"</span> == <span class="hljs-string">"B"</span> ]; <span class="hljs-keyword">then</span>
    deploy <span class="hljs-string">"b"</span> 9002 <span class="hljs-string">"a"</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">log</span> <span class="hljs-string">"é”™è¯¯ï¼šçŠ¶æ€æ–‡ä»¶å†…å®¹å¼‚å¸¸ (<span class="hljs-variable">$TARGET_KEY</span>)ï¼Œå¿…é¡»ä¸º A æˆ– Bã€‚"</span>
    <span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">fi</span>
</code></pre>
<h2 data-id="heading-2">3. æŠ€æœ¯è¦ç‚¹è§£æ</h2>
<h3 data-id="heading-3">3.1 æ‹’ç»æ— é™ç­‰å¾… (Timeout Mechanism)</h3>
<p>æ—§è„šæœ¬ä¸­å¸¸è§çš„é”™è¯¯æ˜¯ä½¿ç”¨ while true è½®è¯¢æœåŠ¡çŠ¶æ€ã€‚å¦‚æœæ–°ä»£ç å¼•å…¥äº† Bug å¯¼è‡´ Spring Boot å¯åŠ¨æŠ¥é”™ï¼Œè„šæœ¬ä¼šé™·å…¥æ­»å¾ªç¯ï¼Œé˜»å¡ CI/CD æµæ°´çº¿ã€‚</p>
<p>æ”¹è¿›ï¼š å¼•å…¥è®¡æ•°å™¨ count å’Œæœ€å¤§é‡è¯•æ¬¡æ•° MAX_RETRIESã€‚ä¸€æ—¦è¶…æ—¶ï¼Œè„šæœ¬ç«‹å³é€€å‡ºå¹¶è¿”å›é”™è¯¯ç ï¼ˆNon-zero exit codeï¼‰ï¼Œé€šçŸ¥å‘å¸ƒç³»ç»Ÿæ„å»ºå¤±è´¥ã€‚</p>
<h3 data-id="heading-4">3.2 ä¼˜é›…çš„æµé‡åˆ‡æ¢</h3>
<p>Nginx çš„ reload å‘½ä»¤æ˜¯å¹³æ»‘çš„ï¼Œå®ƒä¸ä¼šä¸­æ–­ç°æœ‰çš„è¿æ¥ã€‚</p>
<p>å…³é”®æ­¥éª¤ï¼š</p>
<ol>
<li><code>cp ... upstream.conf</code>: è¦†ç›–é…ç½®æ–‡ä»¶ã€‚</li>
<li><code>nginx -t</code>: <strong>å¿…é¡»</strong>å…ˆæµ‹è¯•é…ç½®æ–‡ä»¶çš„è¯­æ³•æ­£ç¡®æ€§ã€‚</li>
<li><code>nginx -s reload</code>: ä»…åœ¨æµ‹è¯•é€šè¿‡åé‡è½½ã€‚</li>
</ol>
<h3 data-id="heading-5">3.3 çŠ¶æ€ç®¡ç†ä¸å¹‚ç­‰æ€§</h3>
<p>ä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æ–‡ä»¶ (<code>AorB</code>) æ¥æŒä¹…åŒ–å­˜å‚¨å½“å‰çš„çŠ¶æ€ã€‚è¿™æ¯”ä¾èµ–å†…å­˜æˆ–å¤æ‚çš„æ•°æ®åº“æ›´å¯é ä¸”æ˜“äºè°ƒè¯•ã€‚è„šæœ¬çš„é€»è¾‘æ˜¯â€œè¯»å½“å‰ -&gt; éƒ¨ç½²å½“å‰ -&gt; å†™å…¥ä¸‹ä¸€æ¬¡â€ï¼Œå½¢æˆé—­ç¯ã€‚</p>
<h3 data-id="heading-6">3.4 å®¹é”™å¤„ç† (Fail-Safe)</h3>
<p>è„šæœ¬ä¸­åŠ å…¥äº†å¤§é‡çš„é”™è¯¯æ£€æŸ¥ï¼ˆ<code>|| exit 1</code>ï¼‰ã€‚</p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼šå¦‚æœ <code>cp</code> å‘½ä»¤å› ä¸ºç£ç›˜æ»¡å¤±è´¥äº†ï¼Œè„šæœ¬ä¼šç«‹å³åœæ­¢ï¼Œè€Œä¸æ˜¯å»å¯åŠ¨ä¸€ä¸ªç©ºæ–‡ä»¶ã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šå¦‚æœå¥åº·æ£€æŸ¥å¤±è´¥ï¼Œè„šæœ¬ä¼šä¸»åŠ¨è°ƒç”¨ <code>stop</code> å‘½ä»¤æ¸…ç†åˆšæ‰å¯åŠ¨çš„è„è¿›ç¨‹ï¼Œä¿æŒç¯å¢ƒæ•´æ´ã€‚</li>
</ul>
<h2 data-id="heading-7">4. æ€»ç»“</h2>
<p>é€šè¿‡è¿™æ®µ Shell è„šæœ¬ï¼Œæˆ‘ä»¬ä»¥æä½çš„æˆæœ¬å®ç°äº† Java åº”ç”¨çš„è‡ªåŠ¨åŒ–è“ç»¿éƒ¨ç½²ã€‚å®ƒå…·å¤‡äº†å•†ä¸šçº§å‘å¸ƒç³»ç»Ÿçš„åŸºæœ¬è¦ç´ ï¼š<strong>å¯è§‚æµ‹æ€§</strong>ï¼ˆæ—¥å¿—ï¼‰ã€<strong>å¥å£®æ€§</strong>ï¼ˆè¶…æ—¶ä¸å›æ»šï¼‰å’Œ<strong>é›¶åœæœºèƒ½åŠ›</strong>ã€‚</p>
<p>å¯¹äºä¸­å°å‹é¡¹ç›®ï¼Œè¿™å¾€å¾€æ˜¯æ¯”è¿ç§»åˆ° Kubernetes æ€§ä»·æ¯”æ›´é«˜çš„é€‰æ‹©ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€ä¿å§†çº§æ•™ç¨‹ã€‘Ubuntu ç¯å¢ƒä¸‹ Docker å®‰è£…ä¸ç½‘ç»œä»£ç†é…ç½®æŒ‡å—]]></title>    <link>https://juejin.cn/post/7596883689827123263</link>    <guid>https://juejin.cn/post/7596883689827123263</guid>    <pubDate>2026-01-19T12:40:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596883689827123263" data-draft-id="7593338828196708392" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€ä¿å§†çº§æ•™ç¨‹ã€‘Ubuntu ç¯å¢ƒä¸‹ Docker å®‰è£…ä¸ç½‘ç»œä»£ç†é…ç½®æŒ‡å—"/> <meta itemprop="keywords" content="Docker,å®¹å™¨"/> <meta itemprop="datePublished" content="2026-01-19T12:40:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Lupino"/> <meta itemprop="url" content="https://juejin.cn/user/3051900006579256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€ä¿å§†çº§æ•™ç¨‹ã€‘Ubuntu ç¯å¢ƒä¸‹ Docker å®‰è£…ä¸ç½‘ç»œä»£ç†é…ç½®æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3051900006579256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Lupino
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T12:40:26.000Z" title="Mon Jan 19 2026 12:40:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Linux æœåŠ¡å™¨ï¼ˆUbuntuï¼‰ä¸Šéƒ¨ç½²æœåŠ¡æ—¶ï¼ŒDocker æ˜¯æœ€åŸºç¡€çš„å·¥å…·ã€‚ä½†åœ¨å›½å†…ç½‘ç»œç¯å¢ƒä¸‹ï¼Œä¸ä»…å®‰è£…è¿‡ç¨‹å¯èƒ½ç¼“æ…¢ï¼Œå®‰è£…åçš„é•œåƒæ‹‰å–ï¼ˆ<code>docker pull</code>ï¼‰ä¹Ÿå¸¸å› ç½‘ç»œè¶…æ—¶è€Œå¤±è´¥ã€‚</p>
<p>æœ¬æ–‡æ•´åˆäº†<strong>å®˜æ–¹æ ‡å‡†å®‰è£…æ­¥éª¤</strong>ä¸<strong>ç½‘ç»œä»£ç†é…ç½®æ–¹æ¡ˆ</strong>ï¼ŒåŠ©æ‚¨åœ¨ Ubuntu ä¸Šå¿«é€Ÿæ­å»ºç¨³å®šçš„ Docker ç¯å¢ƒã€‚</p>
<hr/>
<h2 data-id="heading-0">ç¬¬ä¸€éƒ¨åˆ†ï¼šå®‰è£… Docker Engine (æ ‡å‡†ç‰ˆ)</h2>
<p>æˆ‘ä»¬æ¨èä½¿ç”¨ Docker å®˜æ–¹æºå®‰è£…ï¼Œä»¥ç¡®ä¿ç‰ˆæœ¬æœ€æ–°ä¸”ç¨³å®šã€‚</p>
<h3 data-id="heading-1">1. å¸è½½æ—§ç‰ˆæœ¬ï¼ˆå¯é€‰ï¼‰</h3>
<p>å¦‚æœç³»ç»Ÿä¹‹å‰å®‰è£…è¿‡æ—§ç‰ˆ Dockerï¼Œå»ºè®®å…ˆæ¸…ç†ï¼Œé¿å…å†²çªï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-arduino" lang="arduino">sudo apt-get remove docker docker-engine docker.io containerd runc
</code></pre>
<h3 data-id="heading-2">2. é…ç½®å®˜æ–¹è½¯ä»¶æº</h3>
<p>å®‰è£…å¿…è¦çš„ä¾èµ–å·¥å…·ï¼Œå¹¶æ·»åŠ  Docker çš„ GPG å¯†é’¥å’Œä»“åº“åœ°å€ï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ›´æ–°ç´¢å¼•å¹¶å®‰è£…ä¾èµ–</span>
sudo apt-get update
sudo apt-get install ca-certificates curl gnupg

<span class="hljs-comment"># æ·»åŠ  Docker å®˜æ–¹ GPG å¯†é’¥</span>
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo <span class="hljs-built_in">chmod</span> a+r /etc/apt/keyrings/docker.gpg

<span class="hljs-comment"># å†™å…¥è½¯ä»¶æºä¿¡æ¯</span>
<span class="hljs-built_in">echo</span> \
  <span class="hljs-string">"deb [arch=<span class="hljs-subst">$(dpkg --print-architecture)</span> signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
  <span class="hljs-subst">$(. /etc/os-release &amp;&amp; echo <span class="hljs-string">"<span class="hljs-variable">$VERSION_CODENAME</span>"</span>)</span> stable"</span> | \
  sudo <span class="hljs-built_in">tee</span> /etc/apt/sources.list.d/docker.list &gt; /dev/null
</code></pre>
<h3 data-id="heading-3">3. æ­£å¼å®‰è£…</h3>
<p>æ›´æ–°ç´¢å¼•ï¼ˆè®©ç³»ç»Ÿè¯†åˆ«æ–°åŠ å…¥çš„æºï¼‰å¹¶å®‰è£…ï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-sql" lang="sql">sudo apt<span class="hljs-operator">-</span><span class="hljs-keyword">get</span> <span class="hljs-keyword">update</span>
sudo apt<span class="hljs-operator">-</span><span class="hljs-keyword">get</span> install docker<span class="hljs-operator">-</span>ce docker<span class="hljs-operator">-</span>ce<span class="hljs-operator">-</span>cli containerd.io docker<span class="hljs-operator">-</span>buildx<span class="hljs-operator">-</span>plugin docker<span class="hljs-operator">-</span>compose<span class="hljs-operator">-</span>plugin
</code></pre>
<hr/>
<h2 data-id="heading-4">ç¬¬äºŒéƒ¨åˆ†ï¼šé…ç½® Docker ä»£ç† (è§£å†³é•œåƒæ‹‰å–å¤±è´¥)</h2>
<p>å®‰è£…å®Œæˆåï¼Œç›´æ¥è¿è¡Œ <code>docker pull</code> å¾€å¾€ä¼šè¶…æ—¶ã€‚æœ€å½»åº•çš„è§£å†³æ–¹æ³•æ˜¯è®© Docker å®ˆæŠ¤è¿›ç¨‹ï¼ˆDaemonï¼‰èµ°ä»£ç†ã€‚</p>
<h3 data-id="heading-5">1. åˆ›å»º Systemd é…ç½®ç›®å½•</h3>
<p>Docker æœåŠ¡ç”± systemd ç®¡ç†ï¼Œæˆ‘ä»¬éœ€è¦è¦†ç›–å…¶é»˜è®¤é…ç½®ã€‚</p>
<p>Bash</p>
<pre><code class="hljs language-bash" lang="bash">sudo <span class="hljs-built_in">mkdir</span> -p /etc/systemd/system/docker.service.d
</code></pre>
<h3 data-id="heading-6">2. ç¼–è¾‘ä»£ç†é…ç½®æ–‡ä»¶</h3>
<p>åˆ›å»ºæ–‡ä»¶ <code>/etc/systemd/system/docker.service.d/http-proxy.conf</code>ï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-bash" lang="bash">sudo nano /etc/systemd/system/docker.service.d/http-proxy.conf
</code></pre>
<h3 data-id="heading-7">3. å¡«å…¥ä»£ç†ä¿¡æ¯</h3>
<p>å°†ä¸‹æ–¹å†…å®¹çš„ <code>127.0.0.1:7890</code> æ›¿æ¢ä¸ºæ‚¨å®é™…çš„ä»£ç†æœåŠ¡å™¨ IP å’Œç«¯å£ï¼ˆä¾‹å¦‚å±€åŸŸç½‘å†…çš„ Clash/V2Ray ç«¯å£ï¼‰ï¼š</p>
<p>Ini, TOML</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[Service]</span>
<span class="hljs-attr">Environment</span>=<span class="hljs-string">"HTTP_PROXY=http://127.0.0.1:7890"</span>
<span class="hljs-attr">Environment</span>=<span class="hljs-string">"HTTPS_PROXY=http://127.0.0.1:7890"</span>
<span class="hljs-attr">Environment</span>=<span class="hljs-string">"NO_PROXY=localhost,127.0.0.1,::1"</span>
</code></pre>
<p><em>(æ³¨ï¼š<code>NO_PROXY</code> ç”¨äºç¡®ä¿æœ¬åœ°é€šè®¯ä¸èµ°ä»£ç†ï¼Œä¿æŒæ€§èƒ½ã€‚)</em></p>
<h3 data-id="heading-8">4. é‡è½½é…ç½®å¹¶é‡å¯æœåŠ¡</h3>
<p>ä¿®æ”¹ systemd é…ç½®åï¼Œå¿…é¡»æ‰§è¡Œé‡è½½æ‰èƒ½ç”Ÿæ•ˆï¼š</p>
<p>Bash</p>
<pre><code class="hljs">sudo systemctl daemon-reload
sudo systemctl restart docker
</code></pre>
<hr/>
<h2 data-id="heading-9">ç¬¬ä¸‰éƒ¨åˆ†ï¼šéªŒè¯ä¸ä¼˜åŒ–</h2>
<h3 data-id="heading-10">1. æ£€æŸ¥ä»£ç†æ˜¯å¦ç”Ÿæ•ˆ</h3>
<p>è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹è¾“å‡ºçš„ç¯å¢ƒå˜é‡ä¸­æ˜¯å¦åŒ…å« Proxy ä¿¡æ¯ï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-javascript" lang="javascript">sudo docker info | grep <span class="hljs-title class_">Proxy</span>
</code></pre>
<p><em>å¦‚æœè¾“å‡ºæ˜¾ç¤ºäº†æ‚¨é…ç½®çš„ IP å’Œç«¯å£ï¼Œè¯´æ˜é…ç½®æˆåŠŸã€‚</em></p>
<h3 data-id="heading-11">2. æµ‹è¯•æ‹‰å–é•œåƒ</h3>
<p>è¿è¡Œ Hello World å®¹å™¨ï¼Œæµ‹è¯•æ˜¯å¦èƒ½è¿é€š Docker Hubï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-arduino" lang="arduino">sudo docker run hello-world
</code></pre>
<h3 data-id="heading-12">3. (å¯é€‰) å… Sudo ä½¿ç”¨ Docker</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ Docker éœ€è¦ root æƒé™ã€‚å¦‚æœæ‚¨æƒ³ç›´æ¥ä½¿ç”¨ <code>docker</code> å‘½ä»¤è€Œä¸æ˜¯ <code>sudo docker</code>ï¼Œè¯·æ‰§è¡Œï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-bash" lang="bash">sudo groupadd docker          <span class="hljs-comment"># åˆ›å»ºç»„ï¼ˆé€šå¸¸å·²å­˜åœ¨ï¼‰</span>
sudo usermod -aG docker <span class="hljs-variable">$USER</span> <span class="hljs-comment"># å°†å½“å‰ç”¨æˆ·åŠ å…¥ç»„</span>
newgrp docker                 <span class="hljs-comment"># ç«‹å³åˆ·æ–°ç»„æƒé™</span>
</code></pre>
<hr/>
<p><strong>æ€»ç»“</strong>ï¼šé€šè¿‡ä¸Šè¿°æ­¥éª¤ï¼Œæ‚¨å·²ç»æ‹¥æœ‰äº†ä¸€ä¸ªå®‰è£…è§„èŒƒã€ä¸”å…·å¤‡ç§‘å­¦ç½‘ç»œç¯å¢ƒçš„ Docker å¹³å°ï¼Œå¯ä»¥é¡ºç•…åœ°æ‹‰å–å’Œè¿è¡Œå„ç±»å®¹å™¨æœåŠ¡äº†ã€‚</p>
<p><strong>ä¸‹ä¸€æ­¥ï¼š</strong> éœ€è¦ä¸ºæ‚¨ä»‹ç»å¦‚ä½•ä½¿ç”¨ <strong>Portainer</strong> æ¥é€šè¿‡ç½‘é¡µå›¾å½¢åŒ–ç•Œé¢ç®¡ç†è¿™äº› Docker å®¹å™¨å—ï¼Ÿ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenSearch å®¹å™¨æŠ¥é”™ "GC did not bring memory usage down" çš„æ’æŸ¥ä¸è§£å†³]]></title>    <link>https://juejin.cn/post/7596926832912678975</link>    <guid>https://juejin.cn/post/7596926832912678975</guid>    <pubDate>2026-01-19T12:40:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596926832912678975" data-draft-id="7593258683750449186" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenSearch å®¹å™¨æŠ¥é”™ &quot;GC did not bring memory usage down&quot; çš„æ’æŸ¥ä¸è§£å†³"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-19T12:40:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Lupino"/> <meta itemprop="url" content="https://juejin.cn/user/3051900006579256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenSearch å®¹å™¨æŠ¥é”™ "GC did not bring memory usage down" çš„æ’æŸ¥ä¸è§£å†³
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3051900006579256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Lupino
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T12:40:59.000Z" title="Mon Jan 19 2026 12:40:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨è¿ç»´ OpenSearchï¼ˆæˆ– Elasticsearchï¼‰å®¹å™¨æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°æœåŠ¡å“åº”å˜æ…¢ï¼Œæœ€ç»ˆå¯¼è‡´èŠ‚ç‚¹å´©æºƒçš„æƒ…å†µã€‚æŸ¥çœ‹æ—¥å¿—æ—¶ï¼Œæœ€æ˜¾è‘—çš„ç‰¹å¾æ˜¯å¤§é‡çš„åƒåœ¾å›æ”¶ï¼ˆGCï¼‰æ—¥å¿—ï¼Œä»¥åŠå†…å­˜æ— æ³•é‡Šæ”¾çš„è­¦å‘Šã€‚</p>
<p>æœ¬æ–‡å°†åŸºäºä¸€ä¸ªçœŸå®çš„ Docker å®¹å™¨æ—¥å¿—æ¡ˆä¾‹ï¼Œåˆ†æå…¶èƒŒåçš„åŸå› â€”â€”<strong>å †å†…å­˜è€—å°½ï¼ˆHeap Starvationï¼‰</strong> ï¼Œå¹¶æä¾›å®Œæ•´çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-0">1. æ•…éšœç°è±¡</h2>
<p>OpenSearch èŠ‚ç‚¹è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œæ—¥å¿—ä¸­å¼€å§‹ç–¯ç‹‚åˆ·å±ä»¥ä¸‹å†…å®¹ï¼š</p>
<p>Plaintext</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[INFO ]</span><span class="hljs-selector-attr">[o.o.i.b.HierarchyCircuitBreakerService]</span> attempting <span class="hljs-selector-tag">to</span> trigger G1GC due <span class="hljs-selector-tag">to</span> high heap usage <span class="hljs-selector-attr">[128000752]</span>
<span class="hljs-selector-attr">[INFO ]</span><span class="hljs-selector-attr">[o.o.i.b.HierarchyCircuitBreakerService]</span> GC did not bring memory usage down, before <span class="hljs-selector-attr">[128000752]</span>, after <span class="hljs-selector-attr">[129132568]</span>, allocations <span class="hljs-selector-attr">[1]</span>, duration <span class="hljs-selector-attr">[3]</span>
<span class="hljs-selector-attr">[INFO ]</span><span class="hljs-selector-attr">[o.o.i.b.HierarchyCircuitBreakerService]</span> attempting <span class="hljs-selector-tag">to</span> trigger G1GC due <span class="hljs-selector-tag">to</span> high heap usage <span class="hljs-selector-attr">[128004120]</span>
<span class="hljs-selector-attr">[INFO ]</span><span class="hljs-selector-attr">[o.o.i.b.HierarchyCircuitBreakerService]</span> GC did not bring memory usage down...
</code></pre>
<p><strong>å…³é”®æŒ‡æ ‡åˆ†æï¼š</strong></p>
<ul>
<li><strong>é¢‘ç‡æé«˜</strong>ï¼šå‡ ä¹æ¯éš”å‡ ç§’ç”šè‡³å‡ æ¯«ç§’å°±å°è¯•ä¸€æ¬¡ GCã€‚</li>
<li><strong>ç»“æœæ— æ•ˆ</strong>ï¼šæ—¥å¿—æ˜ç¡®æŒ‡å‡º <code>GC did not bring memory usage down</code>ï¼ˆGC æœªèƒ½é™ä½å†…å­˜ä½¿ç”¨ï¼‰ã€‚</li>
<li><strong>æ•°å€¼å¼‚å¸¸</strong>ï¼šæ—¥å¿—ä¸­çš„ <code>[128000752]</code> å•ä½æ˜¯å­—èŠ‚ï¼Œæ¢ç®—ä¸‹æ¥å¤§çº¦åªæœ‰ <strong>122 MB</strong>ã€‚</li>
</ul>
<h2 data-id="heading-1">2. æ·±åº¦è§£è¯»ï¼šä¸ºä»€ä¹ˆä¼šå‘ç”Ÿï¼Ÿ</h2>
<p>è¿™ä¸€ç°è±¡é€šå¸¸è¢«ç§°ä¸º <strong>"Stop-the-world"</strong> çš„å‰å…†æˆ– <strong>Heap Starvationï¼ˆå †å†…å­˜é¥¥é¥¿ï¼‰</strong> ã€‚</p>
<ol>
<li>
<p>å†…å­˜åˆ†é…è¿‡å°ï¼š</p>
<p>ä»æ—¥å¿—æ•°å€¼çœ‹ï¼ŒOpenSearch ä»…åˆ†é…äº†çº¦ 128MB çš„å †å†…å­˜ã€‚å¯¹äºåŸºäº Java çš„æœç´¢å¼•æ“æ¥è¯´ï¼Œè¿™å‡ ä¹æ˜¯â€œæ— æ³•ç”Ÿå­˜â€çš„ã€‚OpenSearch å¯åŠ¨åŠ è½½ç´¢å¼•å…ƒæ•°æ®ã€æ’ä»¶å’Œç¼“å­˜å°±éœ€è¦æ¶ˆè€—å¤§é‡å†…å­˜ã€‚</p>
</li>
<li>
<p>GC æœºåˆ¶å¤±æ•ˆï¼š</p>
<p>JVM çš„ G1GCï¼ˆåƒåœ¾å›æ”¶å™¨ï¼‰è¯•å›¾æ¸…ç†å†…å­˜ï¼Œä½†å‘ç°å †ä¸­æ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯â€œå­˜æ´»â€çš„ï¼ˆLive Objectsï¼‰ï¼Œæ— æ³•å›æ”¶ã€‚</p>
</li>
<li>
<p>ç†”æ–­æœºåˆ¶ï¼ˆCircuit Breakerï¼‰ï¼š</p>
<p>OpenSearch å†…éƒ¨æœ‰ç†”æ–­æœºåˆ¶é˜²æ­¢ OOMï¼ˆå†…å­˜æº¢å‡ºï¼‰ï¼Œå®ƒæ£€æµ‹åˆ°å†…å­˜è¿‡é«˜ï¼Œä¸»åŠ¨è§¦å‘ GCï¼Œä½†ç”±äºç‰©ç†ä¸Šé™å¤ªä½ï¼Œè¿™ç§æŒ£æ‰æ˜¯å¾’åŠ³çš„ï¼Œæœ€ç»ˆä¼šå¯¼è‡´èŠ‚ç‚¹ Crashã€‚</p>
</li>
</ol>
<h2 data-id="heading-2">3. è§£å†³æ–¹æ¡ˆ</h2>
<p>å¦‚æœæ˜¯é€šè¿‡ Docker æˆ– Docker Compose éƒ¨ç½²ï¼Œé€šå¸¸æ˜¯å› ä¸ºæ²¡æœ‰æ˜¾å¼é…ç½® JVM å†…å­˜å‚æ•°ï¼Œå¯¼è‡´å…¶ä½¿ç”¨äº†æä½çš„é»˜è®¤å€¼ã€‚</p>
<h3 data-id="heading-3">ç¬¬ä¸€æ­¥ï¼šè°ƒæ•´ Docker Compose é…ç½®</h3>
<p>æˆ‘ä»¬éœ€è¦é€šè¿‡ç¯å¢ƒå˜é‡ <code>OPENSEARCH_JAVA_OPTS</code> æ¥æ‰‹åŠ¨æŒ‡å®šå †å†…å­˜å¤§å°ï¼ˆHeap Sizeï¼‰ã€‚</p>
<p><strong>å»ºè®®é…ç½®ï¼š</strong></p>
<ul>
<li><strong>å¼€å‘/æµ‹è¯•ç¯å¢ƒ</strong>ï¼šè‡³å°‘ <code>512m</code> æˆ– <code>1g</code>ã€‚</li>
<li><strong>ç”Ÿäº§ç¯å¢ƒ</strong>ï¼šå»ºè®®è®¾ç½®ä¸ºç‰©ç†å†…å­˜çš„ 50%ï¼ˆä¾‹å¦‚ 8G å†…å­˜æœºå™¨ç»™ 4Gï¼‰ï¼Œä¸Šé™é€šå¸¸ä¸è¶…è¿‡ 32Gã€‚</li>
</ul>
<p>ä¿®æ”¹ <code>docker-compose.yml</code>ï¼š</p>
<p>YAML</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3'</span>
<span class="hljs-attr">services:</span>
  <span class="hljs-attr">opensearch:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">opensearchproject/opensearch:latest</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">opensearch-1</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">discovery.type=single-node</span>
      <span class="hljs-comment"># âœ… æ ¸å¿ƒä¿®å¤ï¼šæ˜¾å¼è®¾ç½®å †å†…å­˜å¤§å°ï¼ˆæ­¤å¤„ç¤ºä¾‹ä¸º 1GBï¼‰</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"OPENSEARCH_JAVA_OPTS=-Xms1024m -Xmx1024m"</span>
      <span class="hljs-comment"># âœ… æ¨èï¼šé”å®šå†…å­˜ï¼Œé˜²æ­¢ swap å¯¼è‡´æ€§èƒ½ä¸‹é™</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">bootstrap.memory_lock=true</span> 
    <span class="hljs-attr">ulimits:</span>
      <span class="hljs-attr">memlock:</span>
        <span class="hljs-attr">soft:</span> <span class="hljs-number">-1</span>
        <span class="hljs-attr">hard:</span> <span class="hljs-number">-1</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-number">9200</span><span class="hljs-string">:9200</span>
      <span class="hljs-bullet">-</span> <span class="hljs-number">9600</span><span class="hljs-string">:9600</span>
</code></pre>
<h3 data-id="heading-4">ç¬¬äºŒæ­¥ï¼šè°ƒæ•´å®¿ä¸»æœºå†…æ ¸å‚æ•°ï¼ˆå¿…é¡»ï¼‰</h3>
<p>OpenSearch ä½¿ç”¨ <code>mmapfs</code> å­˜å‚¨ç´¢å¼•ï¼Œé»˜è®¤çš„ Linux å‚æ•°é€šå¸¸å¤ªå°ï¼Œä¼šå¯¼è‡´å¯åŠ¨æŠ¥é”™ã€‚å¿…é¡»åœ¨<strong>å®¿ä¸»æœº</strong>ï¼ˆè¿è¡Œ Docker çš„æœºå™¨ï¼‰ä¸Šæ‰§è¡Œï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸´æ—¶ç”Ÿæ•ˆï¼ˆé‡å¯åå¤±æ•ˆï¼‰</span>
sudo sysctl -w vm.max_map_count=262144

<span class="hljs-comment"># æ°¸ä¹…ç”Ÿæ•ˆï¼ˆæ¨èï¼‰</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"vm.max_map_count=262144"</span> | sudo <span class="hljs-built_in">tee</span> -a /etc/sysctl.conf
sudo sysctl -p
</code></pre>
<h3 data-id="heading-5">ç¬¬ä¸‰æ­¥ï¼šé‡å¯æœåŠ¡</h3>
<p>Bash</p>
<pre><code class="hljs">docker-compose down
docker-compose up -d
</code></pre>
<h2 data-id="heading-6">4. éªŒè¯ä¿®å¤</h2>
<p>æœåŠ¡å¯åŠ¨åï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥å†…å­˜åˆ†é…æ˜¯å¦ç”Ÿæ•ˆï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹å®¹å™¨çŠ¶æ€</span>
docker stats opensearch-1
</code></pre>
<p>æˆ–è€…ç›´æ¥è¯·æ±‚ API æŸ¥çœ‹ JVM ç»Ÿè®¡ä¿¡æ¯ï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-sql" lang="sql">curl <span class="hljs-operator">-</span>X <span class="hljs-keyword">GET</span> "https://localhost:9200/_nodes/stats/jvm?pretty" <span class="hljs-operator">-</span>k <span class="hljs-operator">-</span>u admin:admin
</code></pre>
<p><em>(æ³¨ï¼šå¦‚æœæœ‰é…ç½®è´¦å·å¯†ç ï¼Œè¯·æ›¿æ¢ admin:admin)</em></p>
<p>åœ¨è¿”å›çš„ JSON ä¸­ï¼Œå…³æ³¨ <code>jvm.mem.heap_max_in_bytes</code>ï¼Œç¡®è®¤å…¶æ•°å€¼å·²æ¥è¿‘ä½ è®¾ç½®çš„å¤§å°ï¼ˆä¾‹å¦‚ 1GB çº¦ä¸º 1073741824ï¼‰ã€‚</p>
<h2 data-id="heading-7">æ€»ç»“</h2>
<p>çœ‹åˆ° <code>GC did not bring memory usage down</code> åªæœ‰ä¸€ç§å«ä¹‰ï¼š<strong>ç»™çš„å†…å­˜å¤ªå°‘äº†</strong>ã€‚ä¸è¦è¯•å›¾é€šè¿‡è°ƒæ•´ GC ç®—æ³•æ¥è§£å†³æ­¤é—®é¢˜ï¼Œç›´æ¥å¢åŠ  <code>-Xms</code> å’Œ <code>-Xmx</code> æ˜¯æœ€ç›´æ¥ã€æœ€æœ‰æ•ˆçš„æ–¹æ¡ˆã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring Test ä»å…¥é—¨åˆ°å®æˆ˜]]></title>    <link>https://juejin.cn/post/7596845113281085449</link>    <guid>https://juejin.cn/post/7596845113281085449</guid>    <pubDate>2026-01-19T11:19:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596845113281085449" data-draft-id="7596904122865106995" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring Test ä»å…¥é—¨åˆ°å®æˆ˜"/> <meta itemprop="keywords" content="Spring"/> <meta itemprop="datePublished" content="2026-01-19T11:19:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ä¸­é£˜è¡çš„è®°å¿†"/> <meta itemprop="url" content="https://juejin.cn/user/694547077666606"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring Test ä»å…¥é—¨åˆ°å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547077666606/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ä¸­é£˜è¡çš„è®°å¿†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T11:19:41.000Z" title="Mon Jan 19 2026 11:19:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Spring Test ä»å…¥é—¨åˆ°å®æˆ˜</h2>
<blockquote>
<p><strong>æ‘˜è¦</strong>ï¼šæœ¬æ–‡å°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œå¾ªåºæ¸è¿›åœ°å­¦ä¹ Spring Testæ¡†æ¶ã€‚ä½ å°†æŒæ¡å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€Mockæµ‹è¯•ç­‰æ ¸å¿ƒæŠ€èƒ½ï¼</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f09ea3890c174ac6973b7bf48e9bfb53~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769426381&amp;x-signature=CMerEpth9KK2fb9gNgOH0gjkblY%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-1">Spring Test æ¦‚è¿°</h3>
<p>Spring Testæ˜¯Springæ¡†æ¶æä¾›çš„æµ‹è¯•æ¨¡å—ï¼Œå®ƒç®€åŒ–äº†Springåº”ç”¨ç¨‹åºçš„æµ‹è¯•è¿‡ç¨‹ã€‚é€šè¿‡Spring Testï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p>
<ul>
<li><strong>å¿«é€Ÿç¼–å†™æµ‹è¯•</strong>ï¼šæ— éœ€æ‰‹åŠ¨åˆ›å»ºSpringä¸Šä¸‹æ–‡</li>
<li><strong>ä¾èµ–æ³¨å…¥</strong>ï¼šè‡ªåŠ¨æ³¨å…¥æµ‹è¯•æ‰€éœ€çš„Bean</li>
<li><strong>äº‹åŠ¡ç®¡ç†</strong>ï¼šæ”¯æŒæµ‹è¯•ä¸­çš„äº‹åŠ¡å›æ»š</li>
<li><strong>é›†æˆæµ‹è¯•</strong>ï¼šè½»æ¾è¿›è¡ŒWebå±‚ã€Serviceå±‚çš„é›†æˆæµ‹è¯•</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1cd101095d2845959d8e9dff7e4b324d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769426381&amp;x-signature=QChmXEQ2NSiknK%2F9K9o26WIB2eI%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-2">æ ¸å¿ƒä¼˜åŠ¿</h4>
<ol>
<li><strong>ç®€åŒ–é…ç½®</strong>ï¼šé€šè¿‡æ³¨è§£è‡ªåŠ¨é…ç½®æµ‹è¯•ç¯å¢ƒ</li>
<li><strong>ä¸Šä¸‹æ–‡ç¼“å­˜</strong>ï¼šæé«˜æµ‹è¯•æ‰§è¡Œæ•ˆç‡</li>
<li><strong>ä¸°å¯Œçš„æ–­è¨€</strong>ï¼šæä¾›å¤šç§æ–­è¨€æ–¹æ³•</li>
<li><strong>Mockæ”¯æŒ</strong>ï¼šä¸Mockitoå®Œç¾é›†æˆ</li>
</ol>
<h3 data-id="heading-3">ç¯å¢ƒæ­å»º</h3>
<h4 data-id="heading-4">Mavenä¾èµ–é…ç½®</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Spring Boot Test Starter --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- JUnit 5 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.junit.jupiter<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit-jupiter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- Mockito --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mockito<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mockito-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- AssertJ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.assertj<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>assertj-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h3 data-id="heading-5">æ ¸å¿ƒæ³¨è§£è¯¦è§£</h3>
<h4 data-id="heading-6">1. @SpringBootTest</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootTest</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceTest</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> UserService userService;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testFindUserById</span><span class="hljs-params">()</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userService.findUserById(<span class="hljs-number">1L</span>);
        assertThat(user).isNotNull();
        assertThat(user.getId()).isEqualTo(<span class="hljs-number">1L</span>);
    }
}
</code></pre>
<h4 data-id="heading-7">2. @TestConfiguration</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@TestConfiguration</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TestConfig</span> {

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> UserService <span class="hljs-title function_">userService</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserService</span>();
    }
}
</code></pre>
<h4 data-id="heading-8">3. @AutoConfigureMockMvc</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootTest</span>
<span class="hljs-meta">@AutoConfigureMockMvc</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserControllerTest</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> MockMvc mockMvc;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetUser</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
        mockMvc.perform(get(<span class="hljs-string">"/api/users/1"</span>))
               .andExpect(status().isOk())
               .andExpect(jsonPath(<span class="hljs-string">"$.id"</span>).value(<span class="hljs-number">1</span>));
    }
}
</code></pre>
<h3 data-id="heading-9">æµ‹è¯•ç”Ÿå‘½å‘¨æœŸ</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00de66675e8f416d85e8c41addb27d0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769426381&amp;x-signature=UvhoHhdwA3xSkjbwnZYuBVzF7LQ%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-10">ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootTest</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LifecycleTest</span> {

    <span class="hljs-meta">@BeforeAll</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setup</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// åœ¨æ‰€æœ‰æµ‹è¯•æ–¹æ³•æ‰§è¡Œå‰è¿è¡Œä¸€æ¬¡</span>
        System.out.println(<span class="hljs-string">"BeforeAll: åˆå§‹åŒ–æµ‹è¯•ç¯å¢ƒ"</span>);
    }

    <span class="hljs-meta">@BeforeEach</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeEach</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// åœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œå‰è¿è¡Œ</span>
        System.out.println(<span class="hljs-string">"BeforeEach: å‡†å¤‡æµ‹è¯•æ•°æ®"</span>);
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"Test1: æ‰§è¡Œæµ‹è¯•"</span>);
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">test2</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"Test2: æ‰§è¡Œæµ‹è¯•"</span>);
    }

    <span class="hljs-meta">@AfterEach</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterEach</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// åœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•æ‰§è¡Œåè¿è¡Œ</span>
        System.out.println(<span class="hljs-string">"AfterEach: æ¸…ç†æµ‹è¯•æ•°æ®"</span>);
    }

    <span class="hljs-meta">@AfterAll</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">tearDown</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// åœ¨æ‰€æœ‰æµ‹è¯•æ–¹æ³•æ‰§è¡Œåè¿è¡Œä¸€æ¬¡</span>
        System.out.println(<span class="hljs-string">"AfterAll: æ¸…ç†æµ‹è¯•ç¯å¢ƒ"</span>);
    }
}
</code></pre>
<h3 data-id="heading-11">å®æˆ˜æ¡ˆä¾‹</h3>
<h4 data-id="heading-12">æ¡ˆä¾‹1ï¼šç”¨æˆ·æœåŠ¡å•å…ƒæµ‹è¯•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootTest</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceTest</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> UserService userService;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testCreateUser</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// Given</span>
        <span class="hljs-type">UserDTO</span> <span class="hljs-variable">userDTO</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDTO</span>(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"zhangsan@example.com"</span>);

        <span class="hljs-comment">// When</span>
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userService.createUser(userDTO);

        <span class="hljs-comment">// Then</span>
        assertThat(user).isNotNull();
        assertThat(user.getName()).isEqualTo(<span class="hljs-string">"å¼ ä¸‰"</span>);
        assertThat(user.getEmail()).isEqualTo(<span class="hljs-string">"zhangsan@example.com"</span>);
        assertThat(user.getId()).isNotNull();
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testCreateUserWithExistingEmail</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// Given</span>
        <span class="hljs-type">UserDTO</span> <span class="hljs-variable">userDTO</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDTO</span>(<span class="hljs-string">"æå››"</span>, <span class="hljs-string">"zhangsan@example.com"</span>);

        <span class="hljs-comment">// When &amp; Then</span>
        assertThrows(UserAlreadyExistsException.class, () -&gt; {
            userService.createUser(userDTO);
        });
    }
}
</code></pre>
<h4 data-id="heading-13">æ¡ˆä¾‹2ï¼šREST APIé›†æˆæµ‹è¯•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootTest</span>
<span class="hljs-meta">@AutoConfigureMockMvc</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserControllerTest</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> MockMvc mockMvc;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetUserById</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// When &amp; Then</span>
        mockMvc.perform(get(<span class="hljs-string">"/api/users/1"</span>))
               .andExpect(status().isOk())
               .andExpect(jsonPath(<span class="hljs-string">"$.id"</span>).value(<span class="hljs-number">1</span>))
               .andExpect(jsonPath(<span class="hljs-string">"$.name"</span>).value(<span class="hljs-string">"å¼ ä¸‰"</span>));
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testCreateUser</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// Given</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">userJson</span> <span class="hljs-operator">=</span> <span class="hljs-string">"""
            {
                "name": "ç‹äº”",
                "email": "wangwu@example.com"
            }
            """</span>;

        <span class="hljs-comment">// When &amp; Then</span>
        mockMvc.perform(post(<span class="hljs-string">"/api/users"</span>)
               .contentType(MediaType.APPLICATION_JSON)
               .content(userJson))
               .andExpect(status().isCreated())
               .andExpect(jsonPath(<span class="hljs-string">"$.name"</span>).value(<span class="hljs-string">"ç‹äº”"</span>));
    }
}
</code></pre>
<h4 data-id="heading-14">æ¡ˆä¾‹3ï¼šä½¿ç”¨Mockè¿›è¡Œæµ‹è¯•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootTest</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceWithMockTest</span> {

    <span class="hljs-meta">@MockBean</span>
    <span class="hljs-keyword">private</span> UserRepository userRepository;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> UserService userService;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testFindUserById_NotFound</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// Given</span>
        when(userRepository.findById(<span class="hljs-number">1L</span>)).thenReturn(Optional.empty());

        <span class="hljs-comment">// When &amp; Then</span>
        assertThrows(UserNotFoundException.class, () -&gt; {
            userService.findUserById(<span class="hljs-number">1L</span>);
        });
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testUpdateUser_Success</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// Given</span>
        <span class="hljs-type">User</span> <span class="hljs-variable">existingUser</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-number">1L</span>, <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"zhangsan@example.com"</span>);
        when(userRepository.findById(<span class="hljs-number">1L</span>)).thenReturn(Optional.of(existingUser));
        when(userRepository.save(any(User.class))).thenReturn(existingUser);

        <span class="hljs-type">UserDTO</span> <span class="hljs-variable">updateDTO</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDTO</span>(<span class="hljs-string">"å¼ ä¸‰ä¸‰"</span>, <span class="hljs-string">"zhangsan3@example.com"</span>);

        <span class="hljs-comment">// When</span>
        <span class="hljs-type">User</span> <span class="hljs-variable">updatedUser</span> <span class="hljs-operator">=</span> userService.updateUser(<span class="hljs-number">1L</span>, updateDTO);

        <span class="hljs-comment">// Then</span>
        assertThat(updatedUser.getEmail()).isEqualTo(<span class="hljs-string">"zhangsan3@example.com"</span>);
        verify(userRepository).save(any(User.class));
    }
}
</code></pre>
<h4 data-id="heading-15">æ¡ˆä¾‹4ï¼šäº‹åŠ¡æµ‹è¯•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootTest</span>
<span class="hljs-meta">@Transactional</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TransactionalUserServiceTest</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> UserService userService;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> UserRepository userRepository;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testCreateUser_WithTransaction</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// Given</span>
        <span class="hljs-type">UserDTO</span> <span class="hljs-variable">userDTO</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDTO</span>(<span class="hljs-string">"èµµå…­"</span>, <span class="hljs-string">"zhaoliu@example.com"</span>);

        <span class="hljs-comment">// When</span>
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userService.createUser(userDTO);

        <span class="hljs-comment">// Then</span>
        assertThat(user).isNotNull();
        assertThat(userRepository.count()).isEqualTo(<span class="hljs-number">1</span>);
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testCreateUser_WithoutTransaction</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// Given</span>
        <span class="hljs-type">UserDTO</span> <span class="hljs-variable">userDTO</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDTO</span>(<span class="hljs-string">"é’±ä¸ƒ"</span>, <span class="hljs-string">"qianqi@example.com"</span>);

        <span class="hljs-comment">// When</span>
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userService.createUserWithoutTransaction(userDTO);

        <span class="hljs-comment">// Then</span>
        assertThat(user).isNotNull();
        <span class="hljs-comment">// æ•°æ®ä¼šè¢«å›æ»š</span>
        assertThat(userRepository.count()).isEqualTo(<span class="hljs-number">0</span>);
    }
}
</code></pre>
<h3 data-id="heading-16">é«˜çº§ç‰¹æ€§</h3>
<h4 data-id="heading-17">1. å‚æ•°åŒ–æµ‹è¯•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@ParameterizedTest</span>
<span class="hljs-meta">@ValueSource(strings = {"test1@example.com", "test2@example.com", "test3@example.com"})</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">testEmailValidation</span><span class="hljs-params">(String email)</span> {
    assertThat(EmailValidator.isValidEmail(email)).isTrue();
}

<span class="hljs-meta">@ParameterizedTest</span>
<span class="hljs-meta">@MethodSource("provideUserDTOs")</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">testCreateUserWithDifferentData</span><span class="hljs-params">(UserDTO userDTO)</span> {
    <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userService.createUser(userDTO);
    assertThat(user).isNotNull();
    assertThat(user.getEmail()).isEqualTo(userDTO.getEmail());
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Stream&lt;Arguments&gt; <span class="hljs-title function_">provideUserDTOs</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> Stream.of(
        Arguments.of(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDTO</span>(<span class="hljs-string">"ç”¨æˆ·1"</span>, <span class="hljs-string">"user1@example.com"</span>)),
        Arguments.of(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDTO</span>(<span class="hljs-string">"ç”¨æˆ·2"</span>, <span class="hljs-string">"user2@example.com"</span>)),
        Arguments.of(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDTO</span>(<span class="hljs-string">"ç”¨æˆ·3"</span>, <span class="hljs-string">"user3@example.com"</span>))
    );
}
</code></pre>
<h4 data-id="heading-18">2. æ€§èƒ½æµ‹è¯•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootTest</span>
<span class="hljs-meta">@BenchmarkMode(Mode.AverageTime)</span>
<span class="hljs-meta">@OutputTimeUnit(TimeUnit.MILLISECONDS)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PerformanceTest</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> UserService userService;

    <span class="hljs-meta">@Test</span>
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testUserServicePerformance</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æµ‹è¯•æ€§èƒ½</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {
            userService.findUserById((<span class="hljs-type">long</span>) i);
        }
    }
}
</code></pre>
<h4 data-id="heading-19">æµ‹è¯•è¦†ç›–ç‡</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc7a66d8d22d475c988902fe43c65e10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769426381&amp;x-signature=Lpdk%2FkZYoKct%2FR6%2FRUrucT%2FCalc%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-20">å¦‚ä½•æé«˜æµ‹è¯•è¦†ç›–ç‡</h4>
<ol>
<li><strong>å•å…ƒæµ‹è¯•</strong>ï¼šè¦†ç›–æ‰€æœ‰ä¸šåŠ¡é€»è¾‘åˆ†æ”¯</li>
<li><strong>è¾¹ç•Œæµ‹è¯•</strong>ï¼šæµ‹è¯•è¾¹ç•Œæ¡ä»¶å’Œå¼‚å¸¸æƒ…å†µ</li>
<li><strong>é›†æˆæµ‹è¯•</strong>ï¼šéªŒè¯ç»„ä»¶é—´çš„äº¤äº’</li>
<li><strong>ç«¯åˆ°ç«¯æµ‹è¯•</strong>ï¼šéªŒè¯å®Œæ•´çš„ä¸šåŠ¡æµç¨‹</li>
</ol>
<h4 data-id="heading-21">è¦†ç›–ç‡å·¥å…·</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä½¿ç”¨JaCoCoè¿›è¡Œè¦†ç›–ç‡åˆ†æ</span>
&lt;plugin&gt;
    &lt;groupId&gt;org.jacoco&lt;/groupId&gt;
    &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;<span class="hljs-number">0.8</span><span class="hljs-number">.7</span>&lt;/version&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;goals&gt;
                &lt;goal&gt;prepare-agent&lt;/goal&gt;
            &lt;/goals&gt;
        &lt;/execution&gt;
        &lt;execution&gt;
            &lt;id&gt;report&lt;/id&gt;
            &lt;phase&gt;test&lt;/phase&gt;
            &lt;goals&gt;
                &lt;goal&gt;report&lt;/goal&gt;
            &lt;/goals&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;
</code></pre>
<h3 data-id="heading-22">æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-23">1. æµ‹è¯•å‘½åè§„èŒƒ</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¥½çš„å‘½å</span>
<span class="hljs-meta">@Test</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">shouldCreateUserWhenValidDataProvided</span><span class="hljs-params">()</span> {}

<span class="hljs-comment">// ä¸å¥½çš„å‘½å</span>
<span class="hljs-meta">@Test</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">test1</span><span class="hljs-params">()</span> {}
</code></pre>
<h4 data-id="heading-24">2. æµ‹è¯•ç»“æ„</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Test</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">testFeature</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// 1. Arrange (å‡†å¤‡æµ‹è¯•æ•°æ®)</span>
    <span class="hljs-type">UserDTO</span> <span class="hljs-variable">userDTO</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDTO</span>(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"zhangsan@example.com"</span>);
    <span class="hljs-comment">// 2. Act (æ‰§è¡Œæµ‹è¯•æ“ä½œ)</span>
    <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userService.createUser(userDTO);
    <span class="hljs-comment">// 3. Assert (éªŒè¯ç»“æœ)</span>
    assertThat(user).isNotNull();
    assertThat(user.getName()).isEqualTo(<span class="hljs-string">"å¼ ä¸‰"</span>);
}
</code></pre>
<h4 data-id="heading-25">3. å¼‚æ­¥æµ‹è¯•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Test</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">testAsyncOperation</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException, ExecutionException {
    <span class="hljs-comment">// Given</span>
    CompletableFuture&lt;User&gt; future = userService.asyncCreateUser(
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDTO</span>(<span class="hljs-string">"æå››"</span>, <span class="hljs-string">"lisi@example.com"</span>));

    <span class="hljs-comment">// When</span>
    <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> future.get();

    <span class="hljs-comment">// Then</span>
    assertThat(user).isNotNull();
    assertThat(user.getName()).isEqualTo(<span class="hljs-string">"æå››"</span>);
}
</code></pre>
<h3 data-id="heading-26">ä¾èµ–å…³ç³»</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/655728266d4c4ce19b4d00d0fcdf0ef8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769426381&amp;x-signature=2Q37czkRXQkvbGCb7y3Sh7cUhFg%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-27">æ€»ç»“</h3>
<p>Spring Testæ˜¯Javaå¼€å‘ä¸­ä¸å¯æˆ–ç¼ºçš„å·¥å…·ï¼ŒæŒæ¡å®ƒå°†å¤§å¤§æé«˜ä½ çš„å¼€å‘æ•ˆç‡å’Œä»£ç è´¨é‡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å›æº¯ç®—æ³•ï¼šé€‰â†’é’»â†’é€€â†’åˆ ï¼ŒæŒæ¡ç©·ä¸¾çš„è‰ºæœ¯]]></title>    <link>https://juejin.cn/post/7596926832912351295</link>    <guid>https://juejin.cn/post/7596926832912351295</guid>    <pubDate>2026-01-19T11:17:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596926832912351295" data-draft-id="7596883689826861119" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å›æº¯ç®—æ³•ï¼šé€‰â†’é’»â†’é€€â†’åˆ ï¼ŒæŒæ¡ç©·ä¸¾çš„è‰ºæœ¯"/> <meta itemprop="keywords" content="åç«¯,JavaScript,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-19T11:17:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¢œé…±"/> <meta itemprop="url" content="https://juejin.cn/user/905653309941495"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å›æº¯ç®—æ³•ï¼šé€‰â†’é’»â†’é€€â†’åˆ ï¼ŒæŒæ¡ç©·ä¸¾çš„è‰ºæœ¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/905653309941495/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¢œé…±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T11:17:39.000Z" title="Mon Jan 19 2026 11:17:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»19åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å›æº¯ç®—æ³•ï¼šé€‰â†’é’»â†’é€€â†’åˆ ï¼ŒæŒæ¡ç©·ä¸¾çš„è‰ºæœ¯</h2>
<p>å›æº¯ç®—æ³•æ˜¯ç®—æ³•é¢†åŸŸçš„æ ¸å¿ƒæ€æƒ³ä¹‹ä¸€ï¼Œå°¤å…¶åœ¨å¤„ç†ã€Œç©·ä¸¾æ‰€æœ‰å¯èƒ½è§£ã€çš„é—®é¢˜æ—¶å ªç§°"ç¥å™¨"ã€‚æœ¬æ–‡å°†ä»æ ¸å¿ƒæ€è·¯å‡ºå‘ï¼Œé€šè¿‡"é€‰ä¸€ä¸ªæ•°â†’é’»åˆ°åº•â†’é€€å›æ¥â†’åˆ æ‰è¿™ä¸ªæ•°â†’é€‰ä¸‹ä¸€ä¸ªæ•°â†’å†é’»åˆ°åº•"è¿™ä¸ªå›ºå®šèŠ‚å¥ï¼Œå¸¦ä½ å½»åº•æŒæ¡å›æº¯ç®—æ³•ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€å›æº¯æ ¸å¿ƒåŸç†ï¼šé€‰â†’é’»â†’é€€â†’åˆ çš„å›ºå®šèŠ‚å¥</h3>
<h4 data-id="heading-2">ä¸€å¥è¯è®°ç‰¢å›æº¯çš„æ‰§è¡Œè¿‡ç¨‹</h4>
<p><strong>é€‰ä¸€ä¸ªæ•°â†’é’»åˆ°åº•â†’é€€å›æ¥â†’åˆ æ‰è¿™ä¸ªæ•°â†’é€‰ä¸‹ä¸€ä¸ªæ•°â†’å†é’»åˆ°åº•ï¼Œç›´åˆ°æ‰€æœ‰æ•°éƒ½è¯•å®Œï¼Œæœ€åæ”¶é›†æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„è·¯å¾„ã€‚</strong></p>
<p>é€‰äº†å°±å¾€ä¸‹é’»ï¼Œèµ°ä¸é€šå°±é€€å›æ¥æ“¦è„šå°ï¼Œæ¢æ¡è·¯å†è¯•ã€‚å¾ˆå¤šäººä¸€å¼€å§‹éƒ½ä¼šè¢«é€’å½’çš„å¤šå±‚è°ƒç”¨ç»•æ™•ï¼Œä½†åªè¦æŠ“ä½ <strong>pushï¼ˆé€‰æ•°ï¼‰â†’ é€’å½’ï¼ˆé’»æ·±å±‚ï¼‰â†’ popï¼ˆæ“¦è„šå°ï¼‰</strong> è¿™ä¸ªå›ºå®šèŠ‚å¥ï¼Œå†ç»“åˆå‰ªææå‰æ­¢æŸï¼Œæ‰€æœ‰å›æº¯é¢˜éƒ½èƒ½å¥—æ¨¡æ¿è§£å†³ï½</p>
<h4 data-id="heading-3">æ ¸å¿ƒå››è¦ç´ </h4>
<p>ä»»ä½•å›æº¯é—®é¢˜éƒ½èƒ½æ‹†è§£ä¸ºä»¥ä¸‹4ä¸ªæ ¸å¿ƒéƒ¨åˆ†ï¼š</p>






























<table><thead><tr><th>è¦ç´ </th><th>ä½œç”¨</th><th>ç¤ºä¾‹ï¼ˆç»„åˆæ€»å’Œï¼‰</th></tr></thead><tbody><tr><td><strong>è·¯å¾„</strong></td><td>å·²ç»åšå‡ºçš„é€‰æ‹©ï¼ˆæ¯”å¦‚é€‰äº†å“ªäº›æ•°ï¼‰</td><td><code>path = [2,3]</code>ï¼ˆè¡¨ç¤ºé€‰äº†2å’Œ3ï¼‰</td></tr><tr><td><strong>é€‰æ‹©åˆ—è¡¨</strong></td><td>å½“å‰æ­¥éª¤å¯é€‰æ‹©çš„é€‰é¡¹ï¼ˆæ¯”å¦‚è¿˜èƒ½é€‰å“ªäº›æ•°ï¼‰</td><td><code>nums = [2,3,6,7]</code>ï¼Œå·²é€‰2åˆ™å¯é€‰3/6/7</td></tr><tr><td><strong>ç»ˆæ­¢æ¡ä»¶</strong></td><td>ä»€ä¹ˆæ—¶å€™åœæ­¢æ¢ç´¢ï¼ˆæ‰¾åˆ°è§£/èµ°åˆ°åº•ï¼‰</td><td>è·¯å¾„å’Œç­‰äºç›®æ ‡å€¼ï¼Œæˆ–è·¯å¾„å’Œè¶…è¿‡ç›®æ ‡å€¼</td></tr><tr><td><strong>å‰ªæ</strong></td><td>æå‰æ’é™¤æ— æ•ˆè·¯å¾„ï¼ˆæ ¸å¿ƒä¼˜åŒ–ï¼‰</td><td>è·¯å¾„å’Œè¶…è¿‡ç›®æ ‡å€¼ï¼Œç›´æ¥åœæ­¢å½“å‰è·¯å¾„</td></tr></tbody></table>
<h4 data-id="heading-4">å…³é”®ç†è§£</h4>
<ul>
<li><strong>é€’å½’æ˜¯"å¾€ä¸‹é’»"</strong>ï¼šæ¯é€‰ä¸€ä¸ªæ•°ï¼Œå°±é€’å½’è°ƒç”¨backtrackï¼Œç›¸å½“äº"å¾€ä¸‹èµ°ä¸€æ­¥"</li>
<li><strong>return æ˜¯"å¾€å›é€€"</strong>ï¼šè§¦å‘ç»ˆæ­¢æ¡ä»¶ï¼ˆæ‰¾åˆ°è§£/å’Œè¶…äº†ï¼‰ï¼Œå°±ç»“æŸå½“å‰é€’å½’ï¼Œå›åˆ°ä¸Šä¸€å±‚</li>
<li><strong>pop æ˜¯"æ“¦è„šå°"</strong>ï¼šå›åˆ°ä¸Šä¸€å±‚åï¼Œå¿…é¡»æ‰§è¡Œ<code>path.pop()</code>ï¼ŒæŠŠåˆšæ‰é€‰çš„æ•°åˆ æ‰ï¼Œæ‰èƒ½"æ¢å¦ä¸€ä¸ªæ•°é€‰"</li>
<li><strong>for å¾ªç¯æ˜¯"é€‰å²”è·¯"</strong>ï¼šæ¯ä¸€å±‚çš„ for å¾ªç¯ï¼Œå°±æ˜¯åœ¨å½“å‰ä½ç½®é€‰ä¸åŒçš„æ•°ï¼ˆå²”è·¯ï¼‰ï¼Œè¯•å®Œä¸€æ¡å†è¯•ä¸‹ä¸€æ¡</li>
</ul>
<h4 data-id="heading-5">é€šç”¨æ¨¡æ¿</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å›æº¯æ ¸å¿ƒå‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">è·¯å¾„, é€‰æ‹©åˆ—è¡¨, å…¶ä»–å‚æ•°</span>) {
  <span class="hljs-comment">// 1. ç»ˆæ­¢æ¡ä»¶ï¼šæ‰¾åˆ°è§£ï¼Œè®°å½•ç»“æœå¹¶è¿”å›</span>
  <span class="hljs-keyword">if</span> (æ»¡è¶³ç»ˆæ­¢æ¡ä»¶) {
    ç»“æœåˆ—è¡¨.<span class="hljs-title function_">push</span>(è·¯å¾„çš„æ‹·è´); <span class="hljs-comment">// æ³¨æ„ï¼šè¦æ‹·è´ï¼Œå¦åˆ™ä¼šè¢«åç»­ä¿®æ”¹</span>
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// 2. éå†æ‰€æœ‰å¯é€‰é€‰é¡¹</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> é€‰é¡¹ <span class="hljs-keyword">of</span> é€‰æ‹©åˆ—è¡¨) {
    <span class="hljs-comment">// å‰ªæï¼šæå‰æ’é™¤æ— æ•ˆé€‰é¡¹ï¼ˆå…³é”®ä¼˜åŒ–ï¼‰</span>
    <span class="hljs-keyword">if</span> (é€‰é¡¹æ— æ•ˆ) <span class="hljs-keyword">continue</span>;

    <span class="hljs-comment">// 3. åšé€‰æ‹©ï¼šæŠŠå½“å‰é€‰é¡¹åŠ å…¥è·¯å¾„ï¼ˆé€‰æ•°ï¼‰</span>
    è·¯å¾„.<span class="hljs-title function_">push</span>(é€‰é¡¹);

    <span class="hljs-comment">// 4. é€’å½’æ¢ç´¢ï¼šåŸºäºå½“å‰é€‰æ‹©ï¼Œç»§ç»­å¾€ä¸‹èµ°ï¼ˆé’»åˆ°åº•ï¼‰</span>
    <span class="hljs-title function_">backtrack</span>(è·¯å¾„, æ–°çš„é€‰æ‹©åˆ—è¡¨, å…¶ä»–å‚æ•°);

    <span class="hljs-comment">// 5. æ’¤é”€é€‰æ‹©ï¼ˆå›æº¯æ ¸å¿ƒï¼‰ï¼šå›åˆ°ä¸Šä¸€æ­¥ï¼Œæ¢é€‰é¡¹ï¼ˆé€€å›æ¥â†’åˆ æ‰è¿™ä¸ªæ•°ï¼‰</span>
    è·¯å¾„.<span class="hljs-title function_">pop</span>();
  }
}

<span class="hljs-comment">// ä¸»å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">solveProblem</span>(<span class="hljs-params">å‚æ•°</span>) {
  <span class="hljs-keyword">const</span> ç»“æœåˆ—è¡¨ = []; <span class="hljs-comment">// å­˜å‚¨æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„è§£</span>
  <span class="hljs-title function_">backtrack</span>([], åˆå§‹é€‰æ‹©åˆ—è¡¨, åˆå§‹å‚æ•°); <span class="hljs-comment">// åˆå§‹è·¯å¾„ä¸ºç©º</span>
  <span class="hljs-keyword">return</span> ç»“æœåˆ—è¡¨;
}
</code></pre>
<h3 data-id="heading-6">äºŒã€å…¥é—¨ç¤ºä¾‹ï¼šç»„åˆæ€»å’Œï¼ˆå¯è§†åŒ–ç†è§£ï¼‰</h3>
<p>ä¸ºäº†è®©ä½ å¿«é€Ÿç†è§£å›æº¯çš„æ ¸å¿ƒèŠ‚å¥ï¼Œæˆ‘ä»¬å…ˆä»<strong>ç»„åˆæ€»å’Œ</strong>è¿™ä¸ªç»å…¸å…¥é—¨é¢˜å…¥æ‰‹ï¼Œé€šè¿‡å¯è§†åŒ–æ‰“å°å®Œæ•´å±•ç¤ºã€Œé€‰â†’æ¢â†’æ’¤ã€çš„å…¨è¿‡ç¨‹ã€‚</p>
<h4 data-id="heading-7">é¢˜ç›®æè¿°</h4>
<p>ç»™å®šä¸€ä¸ªæ— é‡å¤å…ƒç´ çš„æ•°ç»„ <code>candidates</code> å’Œä¸€ä¸ªç›®æ ‡æ•° <code>target</code>ï¼Œæ‰¾å‡º <code>candidates</code> ä¸­æ‰€æœ‰å¯ä»¥ä½¿æ•°å­—å’Œä¸º <code>target</code> çš„ç»„åˆï¼ˆæ•°å­—å¯ä»¥æ— é™åˆ¶é‡å¤è¢«é€‰å–ï¼‰ã€‚</p>
<ul>
<li>ç¤ºä¾‹ï¼šè¾“å…¥ <code>candidates = [2,3,7]</code>ï¼Œ<code>target = 7</code>ï¼Œè¾“å‡º <code>[[2,2,3],[7]]</code>ã€‚</li>
</ul>
<h4 data-id="heading-8">å®Œæ•´ä»£ç å®ç°</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * ç»„åˆæ€»å’Œï¼šæ‰¾æ‰€æœ‰å’Œä¸ºç›®æ ‡å€¼çš„ç»„åˆï¼ˆå¯è§†åŒ–æ‰“å°ç‰ˆï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">candidates</span> - å€™é€‰æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">target</span> - ç›®æ ‡å’Œ
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number[][]</span>} - æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ç»„åˆ
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">combinationSum</span>(<span class="hljs-params">candidates, target</span>) {
  <span class="hljs-keyword">const</span> result = []; <span class="hljs-comment">// å­˜å‚¨æœ€ç»ˆç»“æœ</span>
  candidates.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a - b); <span class="hljs-comment">// æ’åºä¾¿äºå‰ªæ</span>
  <span class="hljs-keyword">let</span> recursionLevel = <span class="hljs-number">0</span>; <span class="hljs-comment">// æ ‡è®°é€’å½’å±‚çº§ï¼Œç”¨äºå¯è§†åŒ–ç¼©è¿›</span>

  <span class="hljs-comment">// å›æº¯å‡½æ•°ï¼špath=å½“å‰è·¯å¾„ï¼Œsum=å½“å‰è·¯å¾„å’Œï¼Œstart=èµ·å§‹ç´¢å¼•ï¼ˆé¿å…é‡å¤ç»„åˆï¼‰</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path, sum, start</span>) {
    <span class="hljs-comment">// å±‚çº§+1ï¼Œç”Ÿæˆç¼©è¿›ï¼ˆæ¯çº§2ä¸ªç©ºæ ¼ï¼‰</span>
    recursionLevel++;
    <span class="hljs-keyword">const</span> indent = <span class="hljs-string">'  '</span>.<span class="hljs-title function_">repeat</span>(recursionLevel - <span class="hljs-number">1</span>);
    <span class="hljs-keyword">const</span> levelTag = <span class="hljs-string">`ã€å±‚çº§<span class="hljs-subst">${recursionLevel}</span>ã€‘`</span>;

    <span class="hljs-comment">// ğŸŸ¢ è°ƒç”¨é˜¶æ®µï¼šæ‰“å°å½“å‰å±‚çº§åˆå§‹çŠ¶æ€</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
      <span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸŸ¢ <span class="hljs-subst">${levelTag}</span> è°ƒç”¨é˜¶æ®µ â†’ path=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(path)}</span>, sum=<span class="hljs-subst">${sum}</span>, start=<span class="hljs-subst">${start}</span>`</span>
    );

    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶1ï¼šè·¯å¾„å’Œç­‰äºç›®æ ‡å€¼ï¼Œè®°å½•ç»“æœ</span>
    <span class="hljs-keyword">if</span> (sum === target) {
      result.<span class="hljs-title function_">push</span>([...path]); <span class="hljs-comment">// æ‹·è´è·¯å¾„ï¼Œé¿å…åç»­ä¿®æ”¹</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
        <span class="hljs-string">`<span class="hljs-subst">${indent}</span>âœ… <span class="hljs-subst">${levelTag}</span> æ‰¾åˆ°æœ‰æ•ˆç»„åˆ â†’ <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(path)}</span>ï¼Œresult=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result)}</span>`</span>
      );
      <span class="hljs-comment">// å±‚çº§-1ï¼Œå‡†å¤‡è¿”å›</span>
      recursionLevel--;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸ”´ <span class="hljs-subst">${levelTag}</span> è¿”å›é˜¶æ®µ â†’ æ‰¾åˆ°è§£ï¼Œå›åˆ°ä¸Šä¸€å±‚`</span>);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶2ï¼šè·¯å¾„å’Œè¶…è¿‡ç›®æ ‡å€¼ï¼Œç›´æ¥è¿”å›ï¼ˆå‰ªæï¼‰</span>
    <span class="hljs-keyword">if</span> (sum &gt; target) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸš« <span class="hljs-subst">${levelTag}</span> å‰ªæ â†’ sum=<span class="hljs-subst">${sum}</span> &gt; target=<span class="hljs-subst">${target}</span>ï¼Œç›´æ¥è¿”å›`</span>);
      recursionLevel--;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸ”´ <span class="hljs-subst">${levelTag}</span> è¿”å›é˜¶æ®µ â†’ å‰ªæè¿”å›ï¼Œå›åˆ°ä¸Šä¸€å±‚`</span>);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// éå†é€‰æ‹©åˆ—è¡¨ï¼ˆä»startå¼€å§‹ï¼Œé¿å…é‡å¤ç»„åˆï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = start; i &lt; candidates.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-keyword">const</span> num = candidates[i];
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸ” <span class="hljs-subst">${levelTag}</span> éå†i=<span class="hljs-subst">${i}</span> â†’ å°è¯•é€‰æ•°å­—<span class="hljs-subst">${num}</span>ï¼Œå½“å‰sum=<span class="hljs-subst">${sum}</span>`</span>);

      <span class="hljs-comment">// æ’åºå‰ªæï¼šå½“å‰æ•°+å·²é€‰å’Œ&gt;ç›®æ ‡å€¼ï¼Œåç»­æ•°æ›´å¤§ï¼Œæ— éœ€ç»§ç»­</span>
      <span class="hljs-keyword">if</span> (sum + num &gt; target) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
          <span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸš« <span class="hljs-subst">${levelTag}</span> æ’åºå‰ªæ â†’ <span class="hljs-subst">${sum}</span>+<span class="hljs-subst">${num}</span>=<span class="hljs-subst">${sum + num}</span> &gt; <span class="hljs-subst">${target}</span>ï¼Œbreakå¾ªç¯`</span>
        );
        <span class="hljs-keyword">break</span>;
      }

      <span class="hljs-comment">// åšé€‰æ‹©ï¼šåŠ å…¥å½“å‰æ•°ï¼ˆé€‰æ•°ï¼‰</span>
      path.<span class="hljs-title function_">push</span>(num);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
        <span class="hljs-string">`<span class="hljs-subst">${indent}</span>âœ… <span class="hljs-subst">${levelTag}</span> é€‰æ•°å­—<span class="hljs-subst">${num}</span> â†’ path=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(path)}</span>, sum=<span class="hljs-subst">${sum + num}</span>`</span>
      );

      <span class="hljs-comment">// ğŸŸ¡ æš‚åœé˜¶æ®µï¼šè°ƒç”¨ä¸‹ä¸€å±‚ï¼Œå½“å‰å±‚çº§æš‚åœ</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸŸ¡ <span class="hljs-subst">${levelTag}</span> æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›`</span>);
      <span class="hljs-comment">// é€’å½’æ¢ç´¢ï¼šæ•°å­—å¯é‡å¤é€‰ï¼Œæ‰€ä»¥startä»ä¸ºiï¼ˆé’»åˆ°åº•ï¼‰</span>
      <span class="hljs-title function_">backtrack</span>(path, sum + num, i);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸ”´ <span class="hljs-subst">${levelTag}</span> è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ`</span>);

      <span class="hljs-comment">// æ’¤é”€é€‰æ‹©ï¼šå›æº¯æ ¸å¿ƒï¼ˆé€€å›æ¥â†’åˆ æ‰è¿™ä¸ªæ•°ï¼‰</span>
      path.<span class="hljs-title function_">pop</span>();
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
        <span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸ”µ <span class="hljs-subst">${levelTag}</span> æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—<span class="hljs-subst">${num}</span> â†’ path=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(path)}</span>, sum=<span class="hljs-subst">${sum}</span>`</span>
      );
    }

    <span class="hljs-comment">// å±‚çº§-1ï¼Œå‡†å¤‡è¿”å›</span>
    recursionLevel--;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸ”´ <span class="hljs-subst">${levelTag}</span> è¿”å›é˜¶æ®µ â†’ forå¾ªç¯ç»“æŸï¼Œå›åˆ°ä¸Šä¸€å±‚`</span>);
  }

  <span class="hljs-comment">// åˆå§‹è°ƒç”¨ï¼šç©ºè·¯å¾„ã€å’Œä¸º0ã€ä»ç´¢å¼•0å¼€å§‹</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'========== å¼€å§‹æ‰§è¡Œç»„åˆæ€»å’Œ =========='</span>);
  <span class="hljs-title function_">backtrack</span>([], <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'========== æ‰§è¡Œç»“æŸ =========='</span>);
  <span class="hljs-keyword">return</span> result;
}

<span class="hljs-comment">// æµ‹è¯•ï¼šè¾“å…¥ [2,3,7], 7 â†’ è¾“å‡º [[2,2,3],[7]]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœ€ç»ˆç»“æœï¼š'</span>, <span class="hljs-title function_">combinationSum</span>([<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>], <span class="hljs-number">7</span>));
</code></pre>
<p>å„ä¸ªå›¾æ ‡çš„å«ä¹‰ï¼š</p>
<ul>
<li>ğŸŸ¢ è°ƒç”¨é˜¶æ®µï¼šè¿›å…¥é€’å½’æ—¶çš„çŠ¶æ€</li>
<li>ğŸ” éå†é˜¶æ®µï¼šå°è¯•é€‰æ‹©æ•°å­—</li>
<li>âœ… é€‰æ‹©é˜¶æ®µï¼šæˆåŠŸé€‰æ‹©æ•°å­—</li>
<li>ğŸŸ¡ æš‚åœé˜¶æ®µï¼šè°ƒç”¨ä¸‹ä¸€å±‚é€’å½’</li>
<li>ğŸ”´ è¿”å›é˜¶æ®µï¼šä»ä¸‹ä¸€å±‚è¿”å›</li>
<li>ğŸ”µ æ’¤é”€é˜¶æ®µï¼šåˆ é™¤æ•°å­—ï¼ˆæ“¦è„šå°ï¼‰</li>
<li>ğŸš« å‰ªæé˜¶æ®µï¼šæå‰ç»ˆæ­¢æ— æ•ˆè·¯å¾„</li>
</ul>
<p><strong>æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-plaintext" lang="plaintext">========== å¼€å§‹æ‰§è¡Œç»„åˆæ€»å’Œ ==========
ğŸŸ¢ ã€å±‚çº§1ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[], sum=0, start=0
ğŸ” ã€å±‚çº§1ã€‘ éå†i=0 â†’ å°è¯•é€‰æ•°å­—2ï¼Œå½“å‰sum=0
âœ… ã€å±‚çº§1ã€‘ é€‰æ•°å­—2 â†’ path=[2], sum=2
ğŸŸ¡ ã€å±‚çº§1ã€‘ æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›
  ğŸŸ¢ ã€å±‚çº§2ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[2], sum=2, start=0
  ğŸ” ã€å±‚çº§2ã€‘ éå†i=0 â†’ å°è¯•é€‰æ•°å­—2ï¼Œå½“å‰sum=2
  âœ… ã€å±‚çº§2ã€‘ é€‰æ•°å­—2 â†’ path=[2,2], sum=4
  ğŸŸ¡ ã€å±‚çº§2ã€‘ æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›
    ğŸŸ¢ ã€å±‚çº§3ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[2,2], sum=4, start=0
    ğŸ” ã€å±‚çº§3ã€‘ éå†i=0 â†’ å°è¯•é€‰æ•°å­—2ï¼Œå½“å‰sum=4
    âœ… ã€å±‚çº§3ã€‘ é€‰æ•°å­—2 â†’ path=[2,2,2], sum=6
    ğŸŸ¡ ã€å±‚çº§3ã€‘ æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›
      ğŸŸ¢ ã€å±‚çº§4ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[2,2,2], sum=6, start=0
      ğŸ” ã€å±‚çº§4ã€‘ éå†i=0 â†’ å°è¯•é€‰æ•°å­—2ï¼Œå½“å‰sum=6
      ğŸš« ã€å±‚çº§4ã€‘ æ’åºå‰ªæ â†’ 6+2=8 &gt; 7ï¼Œbreakå¾ªç¯
      ğŸ”´ ã€å±‚çº§4ã€‘ è¿”å›é˜¶æ®µ â†’ forå¾ªç¯ç»“æŸï¼Œå›åˆ°ä¸Šä¸€å±‚
    ğŸ”´ ã€å±‚çº§3ã€‘ è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
    ğŸ”µ ã€å±‚çº§3ã€‘ æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—2 â†’ path=[2,2], sum=4
    ğŸ” ã€å±‚çº§3ã€‘ éå†i=1 â†’ å°è¯•é€‰æ•°å­—3ï¼Œå½“å‰sum=4
    âœ… ã€å±‚çº§3ã€‘ é€‰æ•°å­—3 â†’ path=[2,2,3], sum=7
    ğŸŸ¡ ã€å±‚çº§3ã€‘ æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›
      ğŸŸ¢ ã€å±‚çº§4ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[2,2,3], sum=7, start=1
      âœ… ã€å±‚çº§4ã€‘ æ‰¾åˆ°æœ‰æ•ˆç»„åˆ â†’ [2,2,3]ï¼Œresult=[[2,2,3]]
      ğŸ”´ ã€å±‚çº§4ã€‘ è¿”å›é˜¶æ®µ â†’ æ‰¾åˆ°è§£ï¼Œå›åˆ°ä¸Šä¸€å±‚
    ğŸ”´ ã€å±‚çº§3ã€‘ è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
    ğŸ”µ ã€å±‚çº§3ã€‘ æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—3 â†’ path=[2,2], sum=4
    ğŸ” ã€å±‚çº§3ã€‘ éå†i=2 â†’ å°è¯•é€‰æ•°å­—7ï¼Œå½“å‰sum=4
    ğŸš« ã€å±‚çº§3ã€‘ æ’åºå‰ªæ â†’ 4+7=11 &gt; 7ï¼Œbreakå¾ªç¯
    ğŸ”´ ã€å±‚çº§3ã€‘ è¿”å›é˜¶æ®µ â†’ forå¾ªç¯ç»“æŸï¼Œå›åˆ°ä¸Šä¸€å±‚
  ğŸ”´ ã€å±‚çº§2ã€‘ è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
  ğŸ”µ ã€å±‚çº§2ã€‘ æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—2 â†’ path=[2], sum=2
  ğŸ” ã€å±‚çº§2ã€‘ éå†i=1 â†’ å°è¯•é€‰æ•°å­—3ï¼Œå½“å‰sum=2
  âœ… ã€å±‚çº§2ã€‘ é€‰æ•°å­—3 â†’ path=[2,3], sum=5
  ğŸŸ¡ ã€å±‚çº§2ã€‘ æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›
    ğŸŸ¢ ã€å±‚çº§3ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[2,3], sum=5, start=1
    ğŸ” ã€å±‚çº§3ã€‘ éå†i=1 â†’ å°è¯•é€‰æ•°å­—3ï¼Œå½“å‰sum=5
    ğŸš« ã€å±‚çº§3ã€‘ æ’åºå‰ªæ â†’ 5+3=8 &gt; 7ï¼Œbreakå¾ªç¯
    ğŸ”´ ã€å±‚çº§3ã€‘ è¿”å›é˜¶æ®µ â†’ forå¾ªç¯ç»“æŸï¼Œå›åˆ°ä¸Šä¸€å±‚
  ğŸ”´ ã€å±‚çº§2ã€‘ è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
  ğŸ”µ ã€å±‚çº§2ã€‘ æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—3 â†’ path=[2], sum=2
  ğŸ” ã€å±‚çº§2ã€‘ éå†i=2 â†’ å°è¯•é€‰æ•°å­—7ï¼Œå½“å‰sum=2
  ğŸš« ã€å±‚çº§2ã€‘ æ’åºå‰ªæ â†’ 2+7=9 &gt; 7ï¼Œbreakå¾ªç¯
  ğŸ”´ ã€å±‚çº§2ã€‘ è¿”å›é˜¶æ®µ â†’ forå¾ªç¯ç»“æŸï¼Œå›åˆ°ä¸Šä¸€å±‚
ğŸ”´ ã€å±‚çº§1ã€‘ è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
ğŸ”µ ã€å±‚çº§1ã€‘ æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—2 â†’ path=[], sum=0
ğŸ” ã€å±‚çº§1ã€‘ éå†i=1 â†’ å°è¯•é€‰æ•°å­—3ï¼Œå½“å‰sum=0
âœ… ã€å±‚çº§1ã€‘ é€‰æ•°å­—3 â†’ path=[3], sum=3
ğŸŸ¡ ã€å±‚çº§1ã€‘ æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›
  ğŸŸ¢ ã€å±‚çº§2ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[3], sum=3, start=1
  ğŸ” ã€å±‚çº§2ã€‘ éå†i=1 â†’ å°è¯•é€‰æ•°å­—3ï¼Œå½“å‰sum=3
  âœ… ã€å±‚çº§2ã€‘ é€‰æ•°å­—3 â†’ path=[3,3], sum=6
  ğŸŸ¡ ã€å±‚çº§2ã€‘ æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›
    ğŸŸ¢ ã€å±‚çº§3ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[3,3], sum=6, start=1
    ğŸ” ã€å±‚çº§3ã€‘ éå†i=1 â†’ å°è¯•é€‰æ•°å­—3ï¼Œå½“å‰sum=6
    ğŸš« ã€å±‚çº§3ã€‘ æ’åºå‰ªæ â†’ 6+3=9 &gt; 7ï¼Œbreakå¾ªç¯
    ğŸ”´ ã€å±‚çº§3ã€‘ è¿”å›é˜¶æ®µ â†’ forå¾ªç¯ç»“æŸï¼Œå›åˆ°ä¸Šä¸€å±‚
  ğŸ”´ ã€å±‚çº§2ã€‘ è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
  ğŸ”µ ã€å±‚çº§2ã€‘ æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—3 â†’ path=[3], sum=3
  ğŸ” ã€å±‚çº§2ã€‘ éå†i=2 â†’ å°è¯•é€‰æ•°å­—7ï¼Œå½“å‰sum=3
  ğŸš« ã€å±‚çº§2ã€‘ æ’åºå‰ªæ â†’ 3+7=10 &gt; 7ï¼Œbreakå¾ªç¯
  ğŸ”´ ã€å±‚çº§2ã€‘ è¿”å›é˜¶æ®µ â†’ forå¾ªç¯ç»“æŸï¼Œå›åˆ°ä¸Šä¸€å±‚
ğŸ”´ ã€å±‚çº§1ã€‘ è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
ğŸ”µ ã€å±‚çº§1ã€‘ æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—3 â†’ path=[], sum=0
ğŸ” ã€å±‚çº§1ã€‘ éå†i=2 â†’ å°è¯•é€‰æ•°å­—7ï¼Œå½“å‰sum=0
âœ… ã€å±‚çº§1ã€‘ é€‰æ•°å­—7 â†’ path=[7], sum=7
ğŸŸ¡ ã€å±‚çº§1ã€‘ æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›
  ğŸŸ¢ ã€å±‚çº§2ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[7], sum=7, start=2
  âœ… ã€å±‚çº§2ã€‘ æ‰¾åˆ°æœ‰æ•ˆç»„åˆ â†’ [7]ï¼Œresult=[[2,2,3],[7]]
  ğŸ”´ ã€å±‚çº§2ã€‘ è¿”å›é˜¶æ®µ â†’ æ‰¾åˆ°è§£ï¼Œå›åˆ°ä¸Šä¸€å±‚
ğŸ”´ ã€å±‚çº§1ã€‘ è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
ğŸ”µ ã€å±‚çº§1ã€‘ æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—7 â†’ path=[], sum=0
ğŸ”´ ã€å±‚çº§1ã€‘ è¿”å›é˜¶æ®µ â†’ forå¾ªç¯ç»“æŸï¼Œå›åˆ°ä¸Šä¸€å±‚
========== æ‰§è¡Œç»“æŸ ==========
æœ€ç»ˆç»“æœï¼š [ [ 2, 2, 3 ], [ 7 ] ]
</code></pre>
<h4 data-id="heading-9">æ‰§è¡Œæµç¨‹è§£æ</h4>
<p>ä»¥ <code>candidates = [2,3,7]</code>, <code>target = 7</code> ä¸ºä¾‹ï¼š</p>
<ol>
<li><strong>é€‰2</strong> â†’ path=[2], sum=2 â†’ <strong>é’»åˆ°åº•</strong>ï¼ˆé€’å½’ï¼‰</li>
<li><strong>é€‰2</strong> â†’ path=[2,2], sum=4 â†’ <strong>é’»åˆ°åº•</strong>ï¼ˆé€’å½’ï¼‰</li>
<li><strong>é€‰2</strong> â†’ path=[2,2,2], sum=6 â†’ <strong>é’»åˆ°åº•</strong>ï¼ˆé€’å½’ï¼‰</li>
<li><strong>é€‰2</strong> â†’ sum=8 &gt; 7ï¼Œå‰ªæï¼Œ<strong>é€€å›æ¥</strong></li>
<li><strong>åˆ æ‰2</strong> â†’ path=[2,2], sum=6 â†’ <strong>é€‰ä¸‹ä¸€ä¸ªæ•°3</strong></li>
<li><strong>é€‰3</strong> â†’ path=[2,2,3], sum=7 âœ… æ‰¾åˆ°è§£ï¼Œ<strong>é€€å›æ¥</strong></li>
<li><strong>åˆ æ‰3</strong> â†’ path=[2,2], sum=6 â†’ <strong>é€‰ä¸‹ä¸€ä¸ªæ•°7</strong></li>
<li>å‰ªæï¼Œ<strong>é€€å›æ¥</strong> â†’ path=[2], sum=2 â†’ ç»§ç»­å°è¯•...</li>
<li>æœ€ç»ˆæ”¶é›†åˆ° <code>[[2,2,3],[7]]</code></li>
</ol>
<h3 data-id="heading-10">ä¸‰ã€å›æº¯ç®—æ³•å¸¸è§é¢˜å‹åŠè§£é¢˜æ–¹æ³•</h3>
<h4 data-id="heading-11">1. ç»„åˆé—®é¢˜</h4>
<h5 data-id="heading-12">æ ¸å¿ƒç‰¹å¾</h5>
<ul>
<li>ä¸è€ƒè™‘å…ƒç´ é¡ºåºï¼Œæ¯ä¸ªç»„åˆå”¯ä¸€ï¼ˆå¦‚<code>[2,3]</code>å’Œ<code>[3,2]</code>ç®—åŒä¸€ä¸ªï¼‰</li>
<li>ç”¨<code>start</code>å‚æ•°æ§åˆ¶"ä¸å›å¤´é€‰"ï¼Œé¿å…ç”Ÿæˆé‡å¤ç»„åˆ</li>
<li>æ•°å­—å¯é‡å¤é€‰ï¼ˆç»„åˆæ€»å’Œï¼‰/ä¸å¯é‡å¤é€‰ï¼ˆç»„åˆï¼‰ï¼Œä»…éœ€è°ƒæ•´<code>start</code>å‚æ•°ï¼ˆé‡å¤é€‰ä¼ <code>i</code>ï¼Œä¸é‡å¤é€‰ä¼ <code>i+1</code>ï¼‰</li>
</ul>
<h5 data-id="heading-13">LeetCode é¢˜ç›®è¯¦è§£</h5>
<h6 data-id="heading-14"><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fcombination-sum%2F" target="_blank" title="https://leetcode.cn/problems/combination-sum/" ref="nofollow noopener noreferrer">39. ç»„åˆæ€»å’Œ</a></h6>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong></p>
<p>ç»™å®šä¸€ä¸ª<strong>æ— é‡å¤å…ƒç´ </strong>çš„æ•´æ•°æ•°ç»„ <code>candidates</code> å’Œä¸€ä¸ªç›®æ ‡æ•´æ•° <code>target</code>ï¼Œæ‰¾å‡º <code>candidates</code> ä¸­å¯ä»¥ä½¿æ•°å­—å’Œä¸ºç›®æ ‡æ•° <code>target</code> çš„<strong>æ‰€æœ‰ä¸åŒç»„åˆ</strong>ï¼Œå¹¶ä»¥åˆ—è¡¨å½¢å¼è¿”å›ã€‚ä½ å¯ä»¥æŒ‰<strong>ä»»æ„é¡ºåº</strong>è¿”å›è¿™äº›ç»„åˆã€‚</p>
<p><code>candidates</code> ä¸­çš„<strong>åŒä¸€ä¸ªæ•°å­—å¯ä»¥æ— é™åˆ¶é‡å¤è¢«é€‰å–</strong>ã€‚å¦‚æœè‡³å°‘ä¸€ä¸ªæ•°å­—çš„è¢«é€‰æ•°é‡ä¸åŒï¼Œåˆ™ä¸¤ç§ç»„åˆæ˜¯ä¸åŒçš„ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥ï¼š<span class="hljs-attr">candidates</span> = [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>], target = <span class="hljs-number">7</span>
è¾“å‡ºï¼š<span class="hljs-section">[[2,2,3]</span>,<span class="hljs-section">[7]]</span>
è§£é‡Šï¼š
2 å’Œ 3 å¯ä»¥å½¢æˆä¸€ç»„å€™é€‰ï¼Œ2 + 2 + <span class="hljs-attr">3</span> = <span class="hljs-number">7</span>ã€‚æ³¨æ„ <span class="hljs-number">2</span> å¯ä»¥ä½¿ç”¨å¤šæ¬¡ã€‚
7 ä¹Ÿæ˜¯ä¸€ä¸ªå€™é€‰ï¼Œ <span class="hljs-attr">7</span> = <span class="hljs-number">7</span>ã€‚
æ‰€ä»¥è¿™ä¸¤ç§ç»„åˆæ˜¯å”¯ä¸€çš„ç­”æ¡ˆã€‚
</code></pre>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥: <span class="hljs-attr">candidates</span> = [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>], target = <span class="hljs-number">8</span>
è¾“å‡º: <span class="hljs-section">[[2,2,2,2]</span>,<span class="hljs-section">[2,3,3]</span>,<span class="hljs-section">[3,5]]</span>
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * 39. ç»„åˆæ€»å’Œ
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">candidates</span> - æ— é‡å¤å…ƒç´ çš„å€™é€‰æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">target</span> - ç›®æ ‡å’Œ
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number[][]</span>} æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ç»„åˆ
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">combinationSum</span>(<span class="hljs-params">candidates, target</span>) {
  <span class="hljs-keyword">const</span> res = [];
  candidates.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a - b); <span class="hljs-comment">// æ’åºä¾¿äºå‰ªæ</span>

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path, sum, start</span>) {
    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶ï¼šæ‰¾åˆ°æœ‰æ•ˆè§£</span>
    <span class="hljs-keyword">if</span> (sum === target) {
      res.<span class="hljs-title function_">push</span>([...path]);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-comment">// å‰ªæï¼šå’Œè¶…è¿‡ç›®æ ‡å€¼</span>
    <span class="hljs-keyword">if</span> (sum &gt; target) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = start; i &lt; candidates.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-keyword">const</span> num = candidates[i];
      <span class="hljs-comment">// æ’åºå‰ªæï¼šåç»­æ•°æ›´å¤§ï¼Œæ— éœ€ç»§ç»­</span>
      <span class="hljs-keyword">if</span> (sum + num &gt; target) <span class="hljs-keyword">break</span>;

      <span class="hljs-comment">// é€‰æ•°</span>
      path.<span class="hljs-title function_">push</span>(num);
      <span class="hljs-comment">// é’»åˆ°åº•ï¼šæ•°å­—å¯é‡å¤é€‰ï¼Œæ‰€ä»¥startä»ä¸ºi</span>
      <span class="hljs-title function_">backtrack</span>(path, sum + num, i);
      <span class="hljs-comment">// é€€å›æ¥â†’åˆ æ‰è¿™ä¸ªæ•°</span>
      path.<span class="hljs-title function_">pop</span>();
    }
  }

  <span class="hljs-title function_">backtrack</span>([], <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">return</span> res;
}
</code></pre>
<p><strong>æ˜“é”™ç‚¹ï¼š</strong></p>
<ul>
<li>å¿˜è®°æ’åºå¯¼è‡´å‰ªæå¤±æ•ˆ</li>
<li><code>start</code>å‚æ•°ä¼ é”™ï¼ˆé‡å¤é€‰ä¼ <code>i</code>ï¼Œä¸é‡å¤é€‰ä¼ <code>i+1</code>ï¼‰</li>
<li>å¿˜è®°æ‹·è´è·¯å¾„ï¼ˆ<code>[...path]</code>ï¼‰</li>
</ul>
<hr/>
<h6 data-id="heading-15"><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fcombination-sum-ii%2F" target="_blank" title="https://leetcode.cn/problems/combination-sum-ii/" ref="nofollow noopener noreferrer">40. ç»„åˆæ€»å’Œ II</a></h6>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong></p>
<p>ç»™å®šä¸€ä¸ªå€™é€‰äººç¼–å·çš„é›†åˆ <code>candidates</code> å’Œä¸€ä¸ªç›®æ ‡æ•° <code>target</code>ï¼Œæ‰¾å‡º <code>candidates</code> ä¸­æ‰€æœ‰å¯ä»¥ä½¿æ•°å­—å’Œä¸º <code>target</code> çš„ç»„åˆã€‚</p>
<p><code>candidates</code> ä¸­çš„<strong>æ¯ä¸ªæ•°å­—åœ¨æ¯ä¸ªç»„åˆä¸­åªèƒ½ä½¿ç”¨ä¸€æ¬¡</strong>ã€‚</p>
<p>**æ³¨æ„ï¼š**è§£é›†ä¸èƒ½åŒ…å«é‡å¤çš„ç»„åˆã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥: <span class="hljs-attr">candidates</span> = [<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>,<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">5</span>], target = <span class="hljs-number">8</span>,
è¾“å‡º:
<span class="hljs-section">[
[1,1,6]</span>,
<span class="hljs-section">[1,2,5]</span>,
<span class="hljs-section">[1,7]</span>,
<span class="hljs-section">[2,6]</span>
]
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * 40. ç»„åˆæ€»å’Œ II
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">candidates</span> - å¯èƒ½åŒ…å«é‡å¤å…ƒç´ çš„å€™é€‰æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">target</span> - ç›®æ ‡å’Œ
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number[][]</span>} æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ç»„åˆï¼ˆä¸é‡å¤ï¼‰
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">combinationSum2</span>(<span class="hljs-params">candidates, target</span>) {
  <span class="hljs-keyword">const</span> res = [];
  candidates.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a - b); <span class="hljs-comment">// æ’åºä¾¿äºå‰ªæå’Œå»é‡</span>

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path, sum, start</span>) {
    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶ï¼šæ‰¾åˆ°æœ‰æ•ˆè§£</span>
    <span class="hljs-keyword">if</span> (sum === target) {
      res.<span class="hljs-title function_">push</span>([...path]);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-comment">// å‰ªæï¼šå’Œè¶…è¿‡ç›®æ ‡å€¼</span>
    <span class="hljs-keyword">if</span> (sum &gt; target) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = start; i &lt; candidates.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-keyword">const</span> num = candidates[i];

      <span class="hljs-comment">// å»é‡å‰ªæï¼šè·³è¿‡é‡å¤å…ƒç´ ï¼ˆå…³é”®ï¼ï¼‰</span>
      <span class="hljs-comment">// i &gt; start ç¡®ä¿åŒä¸€å±‚ä¸é€‰é‡å¤æ•°å­—ï¼Œä½†ä¸åŒå±‚å¯ä»¥é€‰</span>
      <span class="hljs-keyword">if</span> (i &gt; start &amp;&amp; candidates[i] === candidates[i - <span class="hljs-number">1</span>]) {
        <span class="hljs-keyword">continue</span>;
      }

      <span class="hljs-comment">// æ’åºå‰ªæ</span>
      <span class="hljs-keyword">if</span> (sum + num &gt; target) <span class="hljs-keyword">break</span>;

      <span class="hljs-comment">// é€‰æ•°</span>
      path.<span class="hljs-title function_">push</span>(num);
      <span class="hljs-comment">// é’»åˆ°åº•ï¼šæ•°å­—ä¸å¯é‡å¤é€‰ï¼Œæ‰€ä»¥startä¼ i+1</span>
      <span class="hljs-title function_">backtrack</span>(path, sum + num, i + <span class="hljs-number">1</span>);
      <span class="hljs-comment">// é€€å›æ¥â†’åˆ æ‰è¿™ä¸ªæ•°</span>
      path.<span class="hljs-title function_">pop</span>();
    }
  }

  <span class="hljs-title function_">backtrack</span>([], <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">return</span> res;
}
</code></pre>
<p><strong>æ˜“é”™ç‚¹ï¼š</strong></p>
<ul>
<li>å»é‡é€»è¾‘é”™è¯¯ï¼šåº”è¯¥æ˜¯<code>i &gt; start</code>è€Œä¸æ˜¯<code>i &gt; 0</code>ï¼ˆå…è®¸ä¸åŒå±‚é€‰ç›¸åŒæ•°å­—ï¼‰</li>
<li>å¿˜è®°æ’åºå¯¼è‡´å»é‡å¤±æ•ˆ</li>
</ul>
<hr/>
<h6 data-id="heading-16"><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fcombinations%2F" target="_blank" title="https://leetcode.cn/problems/combinations/" ref="nofollow noopener noreferrer">77. ç»„åˆ</a></h6>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong></p>
<p>ç»™å®šä¸¤ä¸ªæ•´æ•° <code>n</code> å’Œ <code>k</code>ï¼Œè¿”å›èŒƒå›´ <code>[1, n]</code> ä¸­æ‰€æœ‰å¯èƒ½çš„ <code>k</code> ä¸ªæ•°çš„ç»„åˆã€‚</p>
<p>ä½ å¯ä»¥æŒ‰<strong>ä»»ä½•é¡ºåº</strong>è¿”å›ç­”æ¡ˆã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥ï¼š<span class="hljs-attr">n</span> = <span class="hljs-number">4</span>, k = <span class="hljs-number">2</span>
è¾“å‡ºï¼š
<span class="hljs-section">[
  [2,4]</span>,
  <span class="hljs-section">[3,4]</span>,
  <span class="hljs-section">[2,3]</span>,
  <span class="hljs-section">[1,2]</span>,
  <span class="hljs-section">[1,3]</span>,
  <span class="hljs-section">[1,4]</span>,
]
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * 77. ç»„åˆ
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">n</span> - èŒƒå›´ [1, n]
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">k</span> - ç»„åˆé•¿åº¦
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number[][]</span>} æ‰€æœ‰å¯èƒ½çš„kä¸ªæ•°çš„ç»„åˆ
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">combine</span>(<span class="hljs-params">n, k</span>) {
  <span class="hljs-keyword">const</span> res = [];

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path, start</span>) {
    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶ï¼šè·¯å¾„é•¿åº¦ç­‰äºk</span>
    <span class="hljs-keyword">if</span> (path.<span class="hljs-property">length</span> === k) {
      res.<span class="hljs-title function_">push</span>([...path]);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// å‰ªæï¼šå‰©ä½™å¯é€‰æ•°å­—ä¸å¤Ÿ</span>
    <span class="hljs-comment">// è¿˜éœ€è¦é€‰ k - path.length ä¸ªæ•°ï¼Œä»startåˆ°nè¿˜æœ‰ n - start + 1 ä¸ªæ•°</span>
    <span class="hljs-comment">// å¦‚æœ n - start + 1 &lt; k - path.lengthï¼Œåˆ™æ— æ³•å‡‘å¤Ÿkä¸ªæ•°</span>
    <span class="hljs-keyword">if</span> (n - start + <span class="hljs-number">1</span> &lt; k - path.<span class="hljs-property">length</span>) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = start; i &lt;= n; i++) {
      <span class="hljs-comment">// é€‰æ•°</span>
      path.<span class="hljs-title function_">push</span>(i);
      <span class="hljs-comment">// é’»åˆ°åº•ï¼šä¸é‡å¤é€‰ï¼Œæ‰€ä»¥startä¼ i+1</span>
      <span class="hljs-title function_">backtrack</span>(path, i + <span class="hljs-number">1</span>);
      <span class="hljs-comment">// é€€å›æ¥â†’åˆ æ‰è¿™ä¸ªæ•°</span>
      path.<span class="hljs-title function_">pop</span>();
    }
  }

  <span class="hljs-title function_">backtrack</span>([], <span class="hljs-number">1</span>);
  <span class="hljs-keyword">return</span> res;
}
</code></pre>
<p><strong>æ˜“é”™ç‚¹ï¼š</strong></p>
<ul>
<li>èŒƒå›´é”™è¯¯ï¼šåº”è¯¥æ˜¯<code>[1, n]</code>ï¼Œå¾ªç¯æ¡ä»¶æ˜¯<code>i &lt;= n</code>è€Œä¸æ˜¯<code>i &lt; n</code></li>
<li>å¿˜è®°å‰ªæä¼˜åŒ–å¯¼è‡´è¶…æ—¶</li>
</ul>
<hr/>
<h6 data-id="heading-17"><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fcombination-sum-iii%2F" target="_blank" title="https://leetcode.cn/problems/combination-sum-iii/" ref="nofollow noopener noreferrer">216. ç»„åˆæ€»å’Œ III</a></h6>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong></p>
<p>æ‰¾å‡ºæ‰€æœ‰ç›¸åŠ ä¹‹å’Œä¸º <code>n</code> çš„ <code>k</code> ä¸ªæ•°çš„ç»„åˆï¼Œä¸”æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ï¼š</p>
<ul>
<li>åªä½¿ç”¨æ•°å­—1åˆ°9</li>
<li>æ¯ä¸ªæ•°å­—<strong>æœ€å¤šä½¿ç”¨ä¸€æ¬¡</strong></li>
</ul>
<p>è¿”å›<strong>æ‰€æœ‰å¯èƒ½çš„æœ‰æ•ˆç»„åˆçš„åˆ—è¡¨</strong>ã€‚è¯¥åˆ—è¡¨ä¸èƒ½åŒ…å«ç›¸åŒçš„ç»„åˆä¸¤æ¬¡ï¼Œç»„åˆå¯ä»¥ä»¥ä»»ä½•é¡ºåºè¿”å›ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥: <span class="hljs-attr">k</span> = <span class="hljs-number">3</span>, n = <span class="hljs-number">7</span>
è¾“å‡º: <span class="hljs-section">[[1,2,4]]</span>
è§£é‡Š:
1 + 2 + <span class="hljs-attr">4</span> = <span class="hljs-number">7</span>
æ²¡æœ‰å…¶ä»–ç¬¦åˆçš„ç»„åˆäº†ã€‚
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * 216. ç»„åˆæ€»å’Œ III
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">k</span> - ç»„åˆé•¿åº¦
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">n</span> - ç›®æ ‡å’Œ
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number[][]</span>} æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ç»„åˆ
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">combinationSum3</span>(<span class="hljs-params">k, n</span>) {
  <span class="hljs-keyword">const</span> res = [];

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path, sum, start</span>) {
    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶1ï¼šæ‰¾åˆ°æœ‰æ•ˆè§£ï¼ˆé•¿åº¦å’Œå’Œéƒ½æ»¡è¶³ï¼‰</span>
    <span class="hljs-keyword">if</span> (path.<span class="hljs-property">length</span> === k &amp;&amp; sum === n) {
      res.<span class="hljs-title function_">push</span>([...path]);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶2ï¼šé•¿åº¦å·²æ»¡ä½†å’Œä¸æ»¡è¶³ï¼Œæˆ–å’Œå·²è¶…</span>
    <span class="hljs-keyword">if</span> (path.<span class="hljs-property">length</span> === k || sum &gt;= n) <span class="hljs-keyword">return</span>;

    <span class="hljs-comment">// å‰ªæï¼šå‰©ä½™å¯é€‰æ•°å­—ä¸å¤Ÿ</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-number">9</span> - start + <span class="hljs-number">1</span> &lt; k - path.<span class="hljs-property">length</span>) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = start; i &lt;= <span class="hljs-number">9</span>; i++) {
      <span class="hljs-comment">// å‰ªæï¼šå½“å‰æ•°åŠ ä¸Šå·²é€‰å’Œè¶…è¿‡ç›®æ ‡å€¼</span>
      <span class="hljs-keyword">if</span> (sum + i &gt; n) <span class="hljs-keyword">break</span>;

      <span class="hljs-comment">// é€‰æ•°</span>
      path.<span class="hljs-title function_">push</span>(i);
      <span class="hljs-comment">// é’»åˆ°åº•ï¼šæ•°å­—ä¸å¯é‡å¤é€‰ï¼Œæ‰€ä»¥startä¼ i+1</span>
      <span class="hljs-title function_">backtrack</span>(path, sum + i, i + <span class="hljs-number">1</span>);
      <span class="hljs-comment">// é€€å›æ¥â†’åˆ æ‰è¿™ä¸ªæ•°</span>
      path.<span class="hljs-title function_">pop</span>();
    }
  }

  <span class="hljs-title function_">backtrack</span>([], <span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
  <span class="hljs-keyword">return</span> res;
}
</code></pre>
<hr/>
<h4 data-id="heading-18">2. æ’åˆ—é—®é¢˜</h4>
<h5 data-id="heading-19">æ ¸å¿ƒç‰¹å¾</h5>
<ul>
<li>è€ƒè™‘å…ƒç´ é¡ºåºï¼Œæ¯ä¸ªæ’åˆ—å”¯ä¸€ï¼ˆå¦‚<code>[1,2]</code>å’Œ<code>[2,1]</code>ç®—ä¸åŒæ’åˆ—ï¼‰</li>
<li>ç”¨<code>used</code>æ•°ç»„æ§åˆ¶"ä¸é‡å¤é€‰"ï¼Œå¾ªç¯ä»0å¼€å§‹ï¼ˆå…è®¸é€‰ä»»æ„æœªé€‰è¿‡çš„æ•°å­—ï¼‰</li>
<li>å«é‡å¤æ•°å­—çš„æ’åˆ—ï¼ˆå…¨æ’åˆ—IIï¼‰éœ€å¢åŠ "å»é‡å‰ªæ"</li>
</ul>
<h5 data-id="heading-20">LeetCode é¢˜ç›®è¯¦è§£</h5>
<h6 data-id="heading-21"><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fpermutations%2F" target="_blank" title="https://leetcode.cn/problems/permutations/" ref="nofollow noopener noreferrer">46. å…¨æ’åˆ—</a></h6>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong></p>
<p>ç»™å®šä¸€ä¸ª<strong>ä¸å«é‡å¤æ•°å­—</strong>çš„æ•°ç»„ <code>nums</code>ï¼Œè¿”å›å…¶<strong>æ‰€æœ‰å¯èƒ½çš„å…¨æ’åˆ—</strong>ã€‚ä½ å¯ä»¥<strong>æŒ‰ä»»æ„é¡ºåº</strong>è¿”å›ç­”æ¡ˆã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥ï¼š<span class="hljs-attr">nums</span> = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
è¾“å‡ºï¼š<span class="hljs-section">[[1,2,3]</span>,<span class="hljs-section">[1,3,2]</span>,<span class="hljs-section">[2,1,3]</span>,<span class="hljs-section">[2,3,1]</span>,<span class="hljs-section">[3,1,2]</span>,<span class="hljs-section">[3,2,1]]</span>
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * 46. å…¨æ’åˆ—
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">nums</span> - ä¸å«é‡å¤æ•°å­—çš„æ•°ç»„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number[][]</span>} æ‰€æœ‰å…¨æ’åˆ—
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">permute</span>(<span class="hljs-params">nums</span>) {
  <span class="hljs-keyword">const</span> res = [];
  <span class="hljs-keyword">const</span> len = nums.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">const</span> used = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(len).<span class="hljs-title function_">fill</span>(<span class="hljs-literal">false</span>); <span class="hljs-comment">// æ ‡è®°å“ªäº›æ•°å­—å·²ä½¿ç”¨</span>

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path</span>) {
    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶ï¼šè·¯å¾„é•¿åº¦ç­‰äºæ•°ç»„é•¿åº¦</span>
    <span class="hljs-keyword">if</span> (path.<span class="hljs-property">length</span> === len) {
      res.<span class="hljs-title function_">push</span>([...path]);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// éå†æ‰€æœ‰å¯é€‰æ•°å­—ï¼ˆæ’åˆ—ä»0å¼€å§‹ï¼Œå…è®¸é€‰ä»»æ„æœªé€‰è¿‡çš„æ•°å­—ï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) {
      <span class="hljs-comment">// å‰ªæï¼šè·³è¿‡å·²é€‰æ•°å­—</span>
      <span class="hljs-keyword">if</span> (used[i]) <span class="hljs-keyword">continue</span>;

      <span class="hljs-comment">// é€‰æ•°</span>
      used[i] = <span class="hljs-literal">true</span>;
      path.<span class="hljs-title function_">push</span>(nums[i]);

      <span class="hljs-comment">// é’»åˆ°åº•</span>
      <span class="hljs-title function_">backtrack</span>(path);

      <span class="hljs-comment">// é€€å›æ¥â†’åˆ æ‰è¿™ä¸ªæ•°</span>
      path.<span class="hljs-title function_">pop</span>();
      used[i] = <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-title function_">backtrack</span>([]);
  <span class="hljs-keyword">return</span> res;
}
</code></pre>
<p><strong>æ˜“é”™ç‚¹ï¼š</strong></p>
<ul>
<li>å¿˜è®°ä½¿ç”¨<code>used</code>æ•°ç»„å¯¼è‡´é‡å¤é€‰åŒä¸€ä¸ªæ•°å­—</li>
<li>å¾ªç¯åº”è¯¥ä»0å¼€å§‹ï¼Œä¸æ˜¯ä»<code>start</code>å¼€å§‹ï¼ˆæ’åˆ—éœ€è¦è€ƒè™‘æ‰€æœ‰ä½ç½®ï¼‰</li>
</ul>
<hr/>
<h6 data-id="heading-22"><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fpermutations-ii%2F" target="_blank" title="https://leetcode.cn/problems/permutations-ii/" ref="nofollow noopener noreferrer">47. å…¨æ’åˆ— II</a></h6>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong></p>
<p>ç»™å®šä¸€ä¸ªå¯åŒ…å«é‡å¤æ•°å­—çš„åºåˆ— <code>nums</code>ï¼Œ<strong>æŒ‰ä»»æ„é¡ºåº</strong>è¿”å›æ‰€æœ‰ä¸é‡å¤çš„å…¨æ’åˆ—ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥ï¼š<span class="hljs-attr">nums</span> = [<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]
è¾“å‡ºï¼š
<span class="hljs-section">[[1,1,2]</span>,
 <span class="hljs-section">[1,2,1]</span>,
 <span class="hljs-section">[2,1,1]]</span>
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * 47. å…¨æ’åˆ— II
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">nums</span> - å¯èƒ½åŒ…å«é‡å¤æ•°å­—çš„æ•°ç»„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number[][]</span>} æ‰€æœ‰ä¸é‡å¤çš„å…¨æ’åˆ—
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">permuteUnique</span>(<span class="hljs-params">nums</span>) {
  <span class="hljs-keyword">const</span> res = [];
  <span class="hljs-keyword">const</span> len = nums.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">const</span> used = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(len).<span class="hljs-title function_">fill</span>(<span class="hljs-literal">false</span>);
  nums.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a - b); <span class="hljs-comment">// æ’åºä¾¿äºå»é‡</span>

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path</span>) {
    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶ï¼šè·¯å¾„é•¿åº¦ç­‰äºæ•°ç»„é•¿åº¦</span>
    <span class="hljs-keyword">if</span> (path.<span class="hljs-property">length</span> === len) {
      res.<span class="hljs-title function_">push</span>([...path]);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) {
      <span class="hljs-comment">// å‰ªæ1ï¼šè·³è¿‡å·²é€‰æ•°å­—</span>
      <span class="hljs-keyword">if</span> (used[i]) <span class="hljs-keyword">continue</span>;

      <span class="hljs-comment">// å‰ªæ2ï¼šå»é‡ï¼ˆå…³é”®ï¼ï¼‰</span>
      <span class="hljs-comment">// å¦‚æœå½“å‰æ•°å­—å’Œå‰ä¸€ä¸ªæ•°å­—ç›¸åŒï¼Œä¸”å‰ä¸€ä¸ªæ•°å­—æœªè¢«ä½¿ç”¨ï¼Œåˆ™è·³è¿‡</span>
      <span class="hljs-comment">// è¿™ç¡®ä¿ç›¸åŒæ•°å­—æŒ‰é¡ºåºä½¿ç”¨ï¼Œé¿å…é‡å¤æ’åˆ—</span>
      <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span> &amp;&amp; nums[i] === nums[i - <span class="hljs-number">1</span>] &amp;&amp; !used[i - <span class="hljs-number">1</span>]) {
        <span class="hljs-keyword">continue</span>;
      }

      <span class="hljs-comment">// é€‰æ•°</span>
      used[i] = <span class="hljs-literal">true</span>;
      path.<span class="hljs-title function_">push</span>(nums[i]);

      <span class="hljs-comment">// é’»åˆ°åº•</span>
      <span class="hljs-title function_">backtrack</span>(path);

      <span class="hljs-comment">// é€€å›æ¥â†’åˆ æ‰è¿™ä¸ªæ•°</span>
      path.<span class="hljs-title function_">pop</span>();
      used[i] = <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-title function_">backtrack</span>([]);
  <span class="hljs-keyword">return</span> res;
}
</code></pre>
<p><strong>æ˜“é”™ç‚¹ï¼š</strong></p>
<ul>
<li>å»é‡é€»è¾‘é”™è¯¯ï¼šåº”è¯¥æ˜¯<code>!used[i - 1]</code>è€Œä¸æ˜¯<code>used[i - 1]</code>
<ul>
<li><code>!used[i - 1]</code>ï¼šå‰ä¸€ä¸ªç›¸åŒæ•°å­—æœªè¢«ä½¿ç”¨ï¼Œè¯´æ˜æˆ‘ä»¬åœ¨åŒä¸€å±‚å°è¯•é‡å¤æ•°å­—ï¼Œåº”è¯¥è·³è¿‡</li>
<li><code>used[i - 1]</code>ï¼šå‰ä¸€ä¸ªç›¸åŒæ•°å­—å·²è¢«ä½¿ç”¨ï¼Œè¯´æ˜æˆ‘ä»¬åœ¨ä¸åŒå±‚ï¼Œå¯ä»¥ä½¿ç”¨</li>
</ul>
</li>
</ul>
<hr/>
<h4 data-id="heading-23">3. å­é›†é—®é¢˜</h4>
<h5 data-id="heading-24">æ ¸å¿ƒç‰¹å¾</h5>
<ul>
<li>æ‰¾å‡ºæ‰€æœ‰å¯èƒ½çš„å­é›†ï¼ˆåŒ…æ‹¬ç©ºé›†ï¼‰</li>
<li>ç”¨<code>start</code>å‚æ•°æ§åˆ¶ä¸å›å¤´é€‰ï¼Œæ— éœ€ä¸¥æ ¼ç»ˆæ­¢æ¡ä»¶ï¼ˆæ¯æ¬¡é€’å½’éƒ½è®°å½•è·¯å¾„ï¼‰</li>
<li>å«é‡å¤æ•°å­—çš„å­é›†ï¼ˆå­é›†IIï¼‰éœ€å¢åŠ "å»é‡å‰ªæ"</li>
</ul>
<h5 data-id="heading-25">LeetCode é¢˜ç›®è¯¦è§£</h5>
<h6 data-id="heading-26"><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fsubsets%2F" target="_blank" title="https://leetcode.cn/problems/subsets/" ref="nofollow noopener noreferrer">78. å­é›†</a></h6>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong></p>
<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code>ï¼Œæ•°ç»„ä¸­çš„å…ƒç´ <strong>äº’ä¸ç›¸åŒ</strong>ã€‚è¿”å›è¯¥æ•°ç»„æ‰€æœ‰å¯èƒ½çš„å­é›†ï¼ˆå¹‚é›†ï¼‰ã€‚</p>
<p>è§£é›†<strong>ä¸èƒ½</strong>åŒ…å«é‡å¤çš„å­é›†ã€‚ä½ å¯ä»¥æŒ‰<strong>ä»»æ„é¡ºåº</strong>è¿”å›è§£é›†ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥ï¼š<span class="hljs-attr">nums</span> = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
è¾“å‡ºï¼š<span class="hljs-section">[[]</span>,<span class="hljs-section">[1]</span>,<span class="hljs-section">[2]</span>,<span class="hljs-section">[1,2]</span>,<span class="hljs-section">[3]</span>,<span class="hljs-section">[1,3]</span>,<span class="hljs-section">[2,3]</span>,<span class="hljs-section">[1,2,3]]</span>
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * 78. å­é›†
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">nums</span> - ä¸å«é‡å¤å…ƒç´ çš„æ•°ç»„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number[][]</span>} æ‰€æœ‰å­é›†
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">subsets</span>(<span class="hljs-params">nums</span>) {
  <span class="hljs-keyword">const</span> res = [];

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path, start</span>) {
    <span class="hljs-comment">// æ¯æ¬¡é€’å½’éƒ½è®°å½•è·¯å¾„ï¼ˆæ— éœ€ä¸¥æ ¼ç»ˆæ­¢æ¡ä»¶ï¼‰</span>
    res.<span class="hljs-title function_">push</span>([...path]);

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = start; i &lt; nums.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-comment">// é€‰æ•°</span>
      path.<span class="hljs-title function_">push</span>(nums[i]);

      <span class="hljs-comment">// é’»åˆ°åº•ï¼šä¸é‡å¤é€‰ï¼Œæ‰€ä»¥startä¼ i+1</span>
      <span class="hljs-title function_">backtrack</span>(path, i + <span class="hljs-number">1</span>);

      <span class="hljs-comment">// é€€å›æ¥â†’åˆ æ‰è¿™ä¸ªæ•°</span>
      path.<span class="hljs-title function_">pop</span>();
    }
  }

  <span class="hljs-title function_">backtrack</span>([], <span class="hljs-number">0</span>);
  <span class="hljs-keyword">return</span> res;
}
</code></pre>
<p><strong>æ˜“é”™ç‚¹ï¼š</strong></p>
<ul>
<li>å¿˜è®°åœ¨æ¯æ¬¡é€’å½’å¼€å§‹æ—¶è®°å½•è·¯å¾„ï¼ˆå­é›†é—®é¢˜éœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹éƒ½è®°å½•ï¼Œä¸åªæ˜¯å¶å­èŠ‚ç‚¹ï¼‰</li>
</ul>
<hr/>
<h6 data-id="heading-27"><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fsubsets-ii%2F" target="_blank" title="https://leetcode.cn/problems/subsets-ii/" ref="nofollow noopener noreferrer">90. å­é›† II</a></h6>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong></p>
<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code>ï¼Œå…¶ä¸­å¯èƒ½åŒ…å«é‡å¤å…ƒç´ ï¼Œè¯·ä½ è¿”å›è¯¥æ•°ç»„æ‰€æœ‰å¯èƒ½çš„å­é›†ï¼ˆå¹‚é›†ï¼‰ã€‚</p>
<p>è§£é›†<strong>ä¸èƒ½</strong>åŒ…å«é‡å¤çš„å­é›†ã€‚è¿”å›çš„è§£é›†ä¸­ï¼Œå­é›†å¯ä»¥æŒ‰<strong>ä»»æ„é¡ºåº</strong>æ’åˆ—ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥ï¼š<span class="hljs-attr">nums</span> = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>]
è¾“å‡ºï¼š<span class="hljs-section">[[]</span>,<span class="hljs-section">[1]</span>,<span class="hljs-section">[1,2]</span>,<span class="hljs-section">[1,2,2]</span>,<span class="hljs-section">[2]</span>,<span class="hljs-section">[2,2]]</span>
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * 90. å­é›† II
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">nums</span> - å¯èƒ½åŒ…å«é‡å¤å…ƒç´ çš„æ•°ç»„
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number[][]</span>} æ‰€æœ‰ä¸é‡å¤çš„å­é›†
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">subsetsWithDup</span>(<span class="hljs-params">nums</span>) {
  <span class="hljs-keyword">const</span> res = [];
  nums.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a - b); <span class="hljs-comment">// æ’åºä¾¿äºå»é‡</span>

  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path, start</span>) {
    <span class="hljs-comment">// æ¯æ¬¡é€’å½’éƒ½è®°å½•è·¯å¾„</span>
    res.<span class="hljs-title function_">push</span>([...path]);

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = start; i &lt; nums.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-comment">// å»é‡å‰ªæï¼šè·³è¿‡é‡å¤å…ƒç´ ï¼ˆå…³é”®ï¼ï¼‰</span>
      <span class="hljs-comment">// i &gt; start ç¡®ä¿åŒä¸€å±‚ä¸é€‰é‡å¤æ•°å­—ï¼Œä½†ä¸åŒå±‚å¯ä»¥é€‰</span>
      <span class="hljs-keyword">if</span> (i &gt; start &amp;&amp; nums[i] === nums[i - <span class="hljs-number">1</span>]) {
        <span class="hljs-keyword">continue</span>;
      }

      <span class="hljs-comment">// é€‰æ•°</span>
      path.<span class="hljs-title function_">push</span>(nums[i]);

      <span class="hljs-comment">// é’»åˆ°åº•ï¼šä¸é‡å¤é€‰ï¼Œæ‰€ä»¥startä¼ i+1</span>
      <span class="hljs-title function_">backtrack</span>(path, i + <span class="hljs-number">1</span>);

      <span class="hljs-comment">// é€€å›æ¥â†’åˆ æ‰è¿™ä¸ªæ•°</span>
      path.<span class="hljs-title function_">pop</span>();
    }
  }

  <span class="hljs-title function_">backtrack</span>([], <span class="hljs-number">0</span>);
  <span class="hljs-keyword">return</span> res;
}
</code></pre>
<p><strong>æ˜“é”™ç‚¹ï¼š</strong></p>
<ul>
<li>å»é‡é€»è¾‘å’Œç»„åˆæ€»å’ŒIIç›¸åŒï¼Œä½†å®¹æ˜“å¿˜è®°æ’åº</li>
</ul>
<hr/>
<h3 data-id="heading-28">å››ã€å›æº¯ç®—æ³•æ ¸å¿ƒä¼˜åŒ–ï¼šå‰ªæ</h3>
<p>å‰ªææ˜¯æå‡å›æº¯æ•ˆç‡çš„å…³é”®ï¼Œå¸¸è§å‰ªæç­–ç•¥ï¼š</p>
<ol>
<li><strong>æå‰ç»ˆæ­¢</strong>ï¼šå¦‚ç»„åˆæ€»å’Œä¸­"è·¯å¾„å’Œè¶…è¿‡ç›®æ ‡å€¼ç›´æ¥è¿”å›"</li>
<li><strong>æ’åºå‰ªæ</strong>ï¼šå…ˆæ’åºå€™é€‰æ•°ç»„ï¼Œé‡åˆ°"å½“å‰å€¼+å·²é€‰å’Œ&gt;ç›®æ ‡å€¼"æ—¶ï¼Œåç»­å€¼æ›´å¤§ï¼Œç›´æ¥break</li>
<li><strong>é‡å¤å‰ªæ</strong>ï¼šå¦‚å­é›†II/å…¨æ’åˆ—IIä¸­ï¼Œè·³è¿‡é‡å¤å…ƒç´ ï¼ˆ<code>if (i &gt; start &amp;&amp; nums[i] === nums[i-1]) continue</code>ï¼‰</li>
<li><strong>çº¦æŸå‰ªæ</strong>ï¼šå¦‚Nçš‡åä¸­ï¼Œæå‰åˆ¤æ–­ä½ç½®æ˜¯å¦åˆæ³•ï¼Œä¸åˆæ³•åˆ™è·³è¿‡</li>
<li><strong>æ•°é‡å‰ªæ</strong>ï¼šå¦‚ç»„åˆé—®é¢˜ä¸­ï¼Œå‰©ä½™å¯é€‰æ•°å­—ä¸å¤Ÿæ—¶ç›´æ¥è¿”å›</li>
</ol>
<h3 data-id="heading-29">äº”ã€æ€»ç»“</h3>
<ol>
<li><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼šå›æº¯ = æ·±åº¦ä¼˜å…ˆéå† + çŠ¶æ€å›é€€ + å‰ªæï¼Œæ ¸å¿ƒæ˜¯"é€‰â†’æ¢â†’æ’¤"</li>
<li><strong>å›ºå®šèŠ‚å¥</strong>ï¼š<strong>pushï¼ˆé€‰æ•°ï¼‰â†’ é€’å½’ï¼ˆé’»æ·±å±‚ï¼‰â†’ popï¼ˆæ“¦è„šå°ï¼‰</strong>ï¼ŒæŠ“ä½è¿™ä¸ªèŠ‚å¥å°±èƒ½è§£å†³æ‰€æœ‰å›æº¯é¢˜</li>
<li><strong>æ¨¡æ¿å¤ç”¨</strong>ï¼š
<ul>
<li>ç»„åˆ/å­é›†ï¼šç”¨<code>start</code>å‚æ•°é¿å…é‡å¤ï¼Œå¾ªç¯ä»<code>start</code>å¼€å§‹</li>
<li>æ’åˆ—ï¼šç”¨<code>used</code>æ•°ç»„é¿å…é‡å¤é€‰ï¼Œå¾ªç¯ä»0å¼€å§‹</li>
</ul>
</li>
<li><strong>ä¼˜åŒ–å…³é”®</strong>ï¼šå‰ªææ˜¯å‡å°‘æ— æ•ˆé€’å½’çš„æ ¸å¿ƒï¼Œèƒ½è®©å›æº¯æ•ˆç‡æå‡ä¸€ä¸ªé‡çº§</li>
</ol>
<p>å›æº¯ç®—æ³•çœ‹ä¼¼å¤æ‚ï¼Œä½†åªè¦æŠ“ä½"é€‰â†’é’»â†’é€€â†’åˆ "è¿™ä¸ªå›ºå®šèŠ‚å¥å’Œ"å‰ªæä¼˜åŒ–"è¿™ä¸ªæ ¸å¿ƒï¼Œå°±èƒ½è½»æ¾åº”å¯¹å„ç±»å›æº¯é—®é¢˜ã€‚å»ºè®®ä»ç®€å•çš„ç»„åˆé—®é¢˜å…¥æ‰‹ï¼Œé€æ­¥è¿‡æ¸¡åˆ°æ’åˆ—ã€å­é›†é—®é¢˜ï¼Œå¤šå†™å¤šç»ƒå°±èƒ½èä¼šè´¯é€šã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI å†™æ–‡ç« é£æ ¼é£˜å¿½ä¸å®šï¼Ÿç”¨ SKILL è®©å®ƒå­¦ä¼šä½ çš„ã€Œå‘³é“ã€ï¼è¿™æ˜¯ä¸€ç¯‡ 100% AI å†™ä½œçš„æ–‡ç« ]]></title>    <link>https://juejin.cn/post/7596865421612236854</link>    <guid>https://juejin.cn/post/7596865421612236854</guid>    <pubDate>2026-01-19T11:22:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596865421612236854" data-draft-id="7596905751110271039" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI å†™æ–‡ç« é£æ ¼é£˜å¿½ä¸å®šï¼Ÿç”¨ SKILL è®©å®ƒå­¦ä¼šä½ çš„ã€Œå‘³é“ã€ï¼è¿™æ˜¯ä¸€ç¯‡ 100% AI å†™ä½œçš„æ–‡ç« "/> <meta itemprop="keywords" content="å‰ç«¯,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-19T11:22:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸å¦‚æ‘¸é±¼å»"/> <meta itemprop="url" content="https://juejin.cn/user/26044011388510"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI å†™æ–‡ç« é£æ ¼é£˜å¿½ä¸å®šï¼Ÿç”¨ SKILL è®©å®ƒå­¦ä¼šä½ çš„ã€Œå‘³é“ã€ï¼è¿™æ˜¯ä¸€ç¯‡ 100% AI å†™ä½œçš„æ–‡ç« 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/26044011388510/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸å¦‚æ‘¸é±¼å»
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T11:22:43.000Z" title="Mon Jan 19 2026 11:22:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc8af2ee580d484fb350abc6e4018555~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5aaC5pG46bG85Y67:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769426563&amp;x-signature=oTy5%2F2VwJji9GATXs2AWJw%2BPY8c%3D" alt="" loading="lazy"/></p>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ä¸å¦‚æ‘¸é±¼å»ï¼Œæ¬¢è¿æ¥åˆ°æˆ‘çš„ AI Coding åˆ†äº«ä¸“æ ã€‚</p>
<p>ä½ æ˜¯ä¸æ˜¯ä¹Ÿé‡åˆ°è¿‡è¿™æ ·çš„é—®é¢˜ï¼šè®© AI å¸®å¿™å†™æ–‡ç« ï¼Œç»“æœå‡ºæ¥çš„å†…å®¹è™½ç„¶é€»è¾‘æ¸…æ™°ï¼Œä½†æ€»æ„Ÿè§‰ã€Œä¸åƒè‡ªå·±å†™çš„ã€ï¼Ÿæ¢ä¸ªè¯é¢˜å†å†™ï¼Œé£æ ¼åˆå˜äº†ï¼Ÿä»Šå¤©æˆ‘ä»¬æ¥èŠèŠå¦‚ä½•ç”¨ SKILL æŠ€æœ¯ï¼Œè®© AI å­¦ä¼šä½ çš„å†™ä½œé£æ ¼ï¼Œè¾“å‡ºã€Œæœ‰ä½ å‘³é“ã€çš„å†…å®¹ã€‚</p>
<blockquote>
<p>æœ¬æ–‡æ‰€è¿°çš„ SKILL æŠ€æœ¯å¯åœ¨ Google çš„ Gemini CLIã€Claude Code ç­‰ AI å·¥å…·ä¸­ä½¿ç”¨ï¼Œå…¶ä»– AI å·¥å…·ä¹Ÿæœ‰ç±»ä¼¼çš„æ¦‚å¿µã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ğŸ¤” é—®é¢˜åˆ†æ</h2>
<h3 data-id="heading-1">AI å†™ä½œçš„ç—›ç‚¹</h3>
<p>ç”¨ AI å†™æ–‡ç« ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°è¿™äº›é—®é¢˜ï¼š</p>
<ol>
<li><strong>é£æ ¼ä¸ä¸€è‡´</strong>ï¼šåŒä¸€ä¸ª AIï¼Œä»Šå¤©å†™çš„æ´»æ³¼ï¼Œæ˜å¤©å†™çš„ä¸¥è‚ƒ</li>
<li><strong>ç¼ºå°‘ä¸ªäººç‰¹è‰²</strong>ï¼šè¾“å‡ºçš„å†…å®¹å››å¹³å…«ç¨³ï¼Œä½†æ²¡æœ‰è¾¨è¯†åº¦</li>
<li><strong>ä¸Šä¸‹æ–‡æœ‰é™</strong>ï¼šæ¯æ¬¡å¯¹è¯éƒ½è¦é‡æ–°æè¿°ã€Œæˆ‘æƒ³è¦ä»€ä¹ˆæ ·çš„é£æ ¼ã€</li>
<li><strong>éš¾ä»¥å¤ç”¨</strong>ï¼šå¥½ä¸å®¹æ˜“è°ƒæ•™å¥½äº†ï¼Œæ¢ä¸ªè¯é¢˜åˆè¦é‡æ¥</li>
</ol>
<h3 data-id="heading-2">æ ¸å¿ƒéš¾ç‚¹</h3>
<p>ä¼ ç»Ÿçš„åšæ³•æ˜¯åœ¨æ¯æ¬¡å¯¹è¯æ—¶ï¼Œç”¨ System Prompt æˆ–è€…å¯¹è¯å¼€å¤´å‘Šè¯‰ AIã€Œä½ è¦ç”¨ä»€ä¹ˆé£æ ¼å†™ã€ã€‚ä½†è¿™æ ·åšæœ‰å‡ ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>æ¯æ¬¡éƒ½è¦æ‰‹åŠ¨è¾“å…¥ï¼Œæ•ˆç‡ä½</li>
<li>æè¿°ä¸å…¨é¢ï¼ŒAI ç†è§£æœ‰åå·®</li>
<li>æ— æ³•æ²‰æ·€å’Œè¿­ä»£</li>
</ul>
<hr/>
<h2 data-id="heading-3">ğŸ’¡ SKILL æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>SKILL æ˜¯ä¸€ç§æ‰©å±• AI èƒ½åŠ›çš„æŠ€æœ¯è§„èŒƒï¼Œå¯ä»¥ç†è§£ä¸ºã€ŒAI èƒ½åŠ›æ’ä»¶ã€ã€‚å®ƒé€šè¿‡ä¸€ä¸ªç»“æ„åŒ–çš„æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ <code>SKILL.md</code>ï¼‰ï¼Œå‘Šè¯‰ AI åœ¨ç‰¹å®šåœºæ™¯ä¸‹åº”è¯¥<strong>å¦‚ä½•æ€è€ƒ</strong>å’Œ<strong>å¦‚ä½•è¡ŒåŠ¨</strong>ã€‚</p>
<h3 data-id="heading-4">SKILL çš„ç»„æˆ</h3>
<p>ä¸€ä¸ªæ ‡å‡†çš„ SKILL åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">skill-name</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">æŠ€èƒ½çš„ä¸€å¥è¯æè¿°</span>
<span class="hljs-meta">---
</span>
<span class="hljs-comment"># æŠ€èƒ½æ ‡é¢˜</span>

[<span class="hljs-string">è¯¦ç»†çš„æŒ‡ä»¤å†…å®¹</span>]
</code></pre>
<p><strong>Frontmatter éƒ¨åˆ†</strong>ï¼ˆ<code>---</code> ä¹‹é—´ï¼‰å®šä¹‰äº†å…ƒæ•°æ®ï¼š</p>
<ul>
<li><code>name</code>ï¼šæŠ€èƒ½çš„å”¯ä¸€æ ‡è¯†</li>
<li><code>description</code>ï¼šæŠ€èƒ½çš„ç®€çŸ­æè¿°ï¼ŒAI ä¼šæ ¹æ®è¿™ä¸ªåˆ¤æ–­æ˜¯å¦éœ€è¦ä½¿ç”¨è¯¥æŠ€èƒ½</li>
</ul>
<p><strong>æ­£æ–‡éƒ¨åˆ†</strong> åˆ™æ˜¯è¯¦ç»†çš„æŒ‡ä»¤ï¼Œå¯ä»¥åŒ…æ‹¬ï¼š</p>
<ul>
<li>ä½¿ç”¨åœºæ™¯è¯´æ˜</li>
<li>è¡Œä¸ºè§„èŒƒ</li>
<li>æ¨¡æ¿å’Œç¤ºä¾‹</li>
<li>æ³¨æ„äº‹é¡¹</li>
</ul>
<h3 data-id="heading-5">SKILL vs System Prompt</h3>






























<table><thead><tr><th>ç»´åº¦</th><th>System Prompt</th><th>SKILL</th></tr></thead><tbody><tr><td>æŒä¹…æ€§</td><td>æ¯æ¬¡å¯¹è¯éœ€é‡æ–°è®¾ç½®</td><td>å†™ä¸€æ¬¡ï¼Œéšå¤„å¯ç”¨</td></tr><tr><td>å¤æ‚åº¦</td><td>é€‚åˆç®€çŸ­æŒ‡ä»¤</td><td>å¯åŒ…å«å®Œæ•´è§„èŒƒæ–‡æ¡£</td></tr><tr><td>åä½œæ€§</td><td>éš¾ä»¥åˆ†äº«</td><td>å¯ç‰ˆæœ¬æ§åˆ¶ã€å›¢é˜Ÿå…±äº«</td></tr><tr><td>å¯è¿­ä»£</td><td>éœ€è¦æ‰‹åŠ¨ç»´æŠ¤</td><td>åŒä»£ç ä¸€æ ·è¿­ä»£ä¼˜åŒ–</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-6">ğŸ¯ ç”¨ SKILL æ‰“é€ ä¸ªäººå†™ä½œé£æ ¼</h2>
<h3 data-id="heading-7">æˆ‘çš„å®è·µ</h3>
<p>ä½œä¸ºä¸€ä¸ªå–œæ¬¢åˆ†äº«æŠ€æœ¯æ–‡ç« çš„å¼€å‘è€…ï¼Œæˆ‘å¸Œæœ› AI å†™å‡ºæ¥çš„å†…å®¹èƒ½å»¶ç»­æˆ‘çš„é£æ ¼ã€‚äºæ˜¯æˆ‘åšäº†è¿™ä»¶äº‹ï¼š</p>
<ol>
<li><strong>åˆ†æè‡ªå·±çš„å†å²æ–‡ç« </strong>ï¼ˆå¤§çº¦ 30+ ç¯‡ï¼‰</li>
<li><strong>æ€»ç»“å†™ä½œç‰¹ç‚¹</strong>ï¼ˆè¯­è¨€é£æ ¼ã€ç»“æ„ä¹ æƒ¯ã€å¸¸ç”¨è¡¨è¾¾ï¼‰</li>
<li><strong>æ•´ç†æˆ SKILL æ–‡ä»¶</strong></li>
</ol>
<p>ä¸‹é¢æ˜¯æˆ‘æ€»ç»“çš„å‡ ä¸ªå…³é”®ç»´åº¦ï¼š</p>
<h3 data-id="heading-8">1. è¯­è¨€é£æ ¼</h3>
<p>æˆ‘çš„æ–‡ç« åå‘å£è¯­åŒ–ã€äº²åˆ‡çš„è¡¨è¾¾ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">### è¯­è¨€é£æ ¼</span>

<span class="hljs-bullet">1.</span> <span class="hljs-strong">**å£è¯­åŒ–äº²åˆ‡**</span>
<span class="hljs-bullet">   -</span> âœ… "ä½ æ˜¯ä¸æ˜¯ä¹Ÿæ›¾ä¸ºäº†..."
<span class="hljs-bullet">   -</span> âœ… "å¦‚æœä½ ä¹Ÿåœ¨ä¸º...è€Œçƒ¦æ¼ï¼Œä¸å¦¨è¯•è¯•è¿™ä¸ªæ–¹æ¡ˆï¼"
<span class="hljs-bullet">   -</span> âœ… "è¿˜è¦å•¥è‡ªè¡Œè½¦å‘¢"

<span class="hljs-bullet">2.</span> <span class="hljs-strong">**è‡ªæˆ‘è°ƒä¾ƒ**</span>
<span class="hljs-bullet">   -</span> "ä»æˆ‘çš„åå­—ã€Œä¸å¦‚æ‘¸é±¼å»ã€å°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œæˆ‘æ˜¯ä¸ªå‘å¾€æ‘¸é±¼çš„äºº"

<span class="hljs-bullet">3.</span> <span class="hljs-strong">**é€‚åº¦å¹½é»˜**</span>
<span class="hljs-bullet">   -</span> å–„ç”¨ emoji ğŸ”¥ ğŸ¤ ğŸ˜© ğŸ“… ğŸŒŸ ğŸš€ ç­‰
</code></pre>
<h3 data-id="heading-9">2. æ–‡ç« ç»“æ„æ¨¡æ¿</h3>
<p>é’ˆå¯¹ä¸åŒç±»å‹çš„æ–‡ç« ï¼Œæˆ‘æ€»ç»“äº†å¯¹åº”çš„æ¨¡æ¿ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">### æŠ€æœ¯æ•™ç¨‹ç±»</span>

<span class="hljs-strong">**å¼€å¤´æ¨¡æ¿**</span>ï¼š
å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ä¸å¦‚æ‘¸é±¼å»ï¼Œwot-uiçš„ä¸»è¦ç»´æŠ¤è€…ï¼Œæ¬¢è¿æ¥åˆ°æˆ‘çš„ [é¢†åŸŸ] åˆ†äº«ä¸“æ ã€‚

<span class="hljs-strong">**ç»“æ„**</span>ï¼š
<span class="hljs-bullet">1.</span> å¼•è¨€/èƒŒæ™¯ï¼ˆé—®é¢˜å¼•å…¥ï¼‰
<span class="hljs-bullet">2.</span> é—®é¢˜åˆ†æï¼ˆå­˜åœ¨ä»€ä¹ˆé—®é¢˜ã€æ ¸å¿ƒéš¾ç‚¹ï¼‰
<span class="hljs-bullet">3.</span> è§£å†³æ–¹æ¡ˆæ¶æ„ï¼ˆæ•´ä½“æ€è·¯ï¼‰
<span class="hljs-bullet">4.</span> å®ç°è¯¦è§£ï¼ˆåˆ†æ­¥éª¤ã€å¸¦ä»£ç ï¼‰
<span class="hljs-bullet">5.</span> ä½¿ç”¨æ–¹å¼ï¼ˆå®é™…åº”ç”¨åœºæ™¯ï¼‰
<span class="hljs-bullet">6.</span> æ€»ç»“ï¼ˆä¼˜åŠ¿ç½—åˆ—ã€å·å¬è¡ŒåŠ¨ï¼‰
<span class="hljs-bullet">7.</span> ç›¸å…³èµ„æº/ç›¸å…³æ–‡ç« 
</code></pre>
<h3 data-id="heading-10">3. å¸¸ç”¨è¡¨è¾¾æ”¶é›†</h3>
<p>æŠŠè‡ªå·±å¸¸ç”¨çš„å¥å¼ä¹Ÿæ•´ç†è¿›å»ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">### å¼€å¤´è¯­</span>
<span class="hljs-bullet">-</span> <span class="hljs-code">`å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ä¸å¦‚æ‘¸é±¼å»ï¼Œ[èº«ä»½æè¿°]ï¼Œæ¬¢è¿æ¥åˆ°æˆ‘çš„ [ä¸“æ å] åˆ†äº«ä¸“æ ã€‚`</span>

<span class="hljs-section">### æ€»ç»“è¯­</span>
<span class="hljs-bullet">-</span> <span class="hljs-code">`å¦‚æœä½ ä¹Ÿåœ¨ä¸º xxx è€Œçƒ¦æ¼ï¼Œä¸å¦¨è¯•è¯•è¿™ä¸ªæ–¹æ¡ˆï¼`</span>
<span class="hljs-bullet">-</span> <span class="hljs-code">`å¸Œæœ›å¯¹å„ä½æœ‰æ‰€å¯å‘`</span>

<span class="hljs-section">### å·å¬è¯­</span>
<span class="hljs-bullet">-</span> <span class="hljs-code">`æ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥è‡ªè¡Œæ¢ç´¢`</span>
</code></pre>
<h3 data-id="heading-11">4. æ ‡é¢˜é£æ ¼</h3>
<p>æˆ‘æ¯”è¾ƒå–œæ¬¢ç”¨ç–‘é—®å¥ + è§£å†³æ–¹æ¡ˆçš„æ ‡é¢˜æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">### æ ‡é¢˜å¸å¼•åŠ›</span>
<span class="hljs-bullet">-</span> ç–‘é—®å¥ï¼š<span class="hljs-code">`xxx æ— æ³•å®ç° xxxï¼Ÿè¿™ä¸ªæ–¹æ³•åšåˆ°äº†ï¼`</span>
<span class="hljs-bullet">-</span> é—®é¢˜+æ–¹æ¡ˆï¼š<span class="hljs-code">`xxx å¡è„–å­ï¼Ÿ1 ä¸ªæ’ä»¶æå®š`</span>
<span class="hljs-bullet">-</span> æ•°å­—åŒ–ï¼š<span class="hljs-code">`10 åˆ†é’Ÿ`</span>ã€<span class="hljs-code">`4 æ­¥æ¥å…¥`</span>
</code></pre>
<hr/>
<h2 data-id="heading-12">ğŸ”§ å¦‚ä½•ä½¿ç”¨ SKILL</h2>
<h3 data-id="heading-13">æ–‡ä»¶ä½ç½®</h3>
<p>å°† SKILL æ–‡ä»¶æ”¾åœ¨é¡¹ç›®çš„ <code>.gemini/skills/</code> ç›®å½•ä¸‹ï¼š</p>
<pre><code class="hljs language-objectivec" lang="objectivec">my-blog/
â”œâ”€â”€ .gemini/
â”‚   â””â”€â”€ skills/
â”‚       â””â”€â”€ writing-style/
â”‚           â””â”€â”€ <span class="hljs-built_in">SKILL</span>.md    # å†™ä½œé£æ ¼ <span class="hljs-built_in">SKILL</span>
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ ...
â””â”€â”€ ...
</code></pre>
<h3 data-id="heading-14">è§¦å‘æ–¹å¼</h3>
<p>å½“ AI æ£€æµ‹åˆ°ä½ çš„éœ€æ±‚ä¸ SKILL çš„æè¿°åŒ¹é…æ—¶ï¼Œä¼šè‡ªåŠ¨åŠ è½½å¯¹åº”çš„ SKILLã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡ <code>@</code> ç¬¦å·ä¸»åŠ¨å¼•ç”¨ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">@<span class="hljs-section">[writing-style]</span> å¸®æˆ‘å†™ä¸€ç¯‡å…³äº Vue3 ç»„åˆå¼ API çš„æ–‡ç« 
</code></pre>
<h3 data-id="heading-15">å®é™…æ•ˆæœ</h3>
<p>ä½¿ç”¨ SKILL åï¼ŒAI ç”Ÿæˆçš„æ–‡ç« ä¼šï¼š</p>
<ol>
<li><strong>è‡ªåŠ¨ä½¿ç”¨æˆ‘çš„å¼€å¤´æ ¼å¼</strong>ï¼šã€Œå¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ä¸å¦‚æ‘¸é±¼å»...ã€</li>
<li><strong>éµå¾ªæˆ‘çš„ç»“æ„ä¹ æƒ¯</strong>ï¼šé—®é¢˜å¼•å…¥ â†’ åˆ†æ â†’ è§£å†³æ–¹æ¡ˆ â†’ æ€»ç»“</li>
<li><strong>ä½¿ç”¨æˆ‘çš„è¡¨è¾¾æ–¹å¼</strong>ï¼šå£è¯­åŒ–ã€å–„ç”¨ emojiã€ç§¯ææ­£é¢</li>
<li><strong>ä¿æŒæ ‡é¢˜é£æ ¼</strong>ï¼šç–‘é—®å¥ + è§£å†³æ–¹æ¡ˆæ¨¡å¼</li>
</ol>
<hr/>
<h2 data-id="heading-16">ğŸš€ è¿›é˜¶ç©æ³•</h2>
<h3 data-id="heading-17">1. å¤š SKILL ç»„åˆ</h3>
<p>ä½ å¯ä»¥åˆ›å»ºå¤šä¸ª SKILLï¼Œé’ˆå¯¹ä¸åŒåœºæ™¯ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">.gemini/skills/
â”œâ”€â”€ writing-style/      <span class="hljs-comment"># é€šç”¨å†™ä½œé£æ ¼</span>
â”œâ”€â”€ tech-tutorial/      <span class="hljs-comment"># æŠ€æœ¯æ•™ç¨‹ä¸“ç”¨</span>
â”œâ”€â”€ <span class="hljs-keyword">open</span>-source-<span class="hljs-keyword">log</span>/    <span class="hljs-comment"># å¼€æºæ—¥å¿—ä¸“ç”¨</span>
â””â”€â”€ year-end-summary/   <span class="hljs-comment"># å¹´ç»ˆæ€»ç»“ä¸“ç”¨</span>
</code></pre>
<h3 data-id="heading-18">2. å›¢é˜Ÿåä½œ</h3>
<p>SKILL æ˜¯çº¯æ–‡æœ¬æ–‡ä»¶ï¼Œå¯ä»¥çº³å…¥ç‰ˆæœ¬æ§åˆ¶ï¼š</p>
<ul>
<li>å›¢é˜Ÿæˆå‘˜å…±äº«å†™ä½œè§„èŒƒ</li>
<li>é€šè¿‡ PR è¿­ä»£ä¼˜åŒ–</li>
<li>æ–°äººå¿«é€Ÿä¸Šæ‰‹å›¢é˜Ÿé£æ ¼</li>
</ul>
<h3 data-id="heading-19">3. æŒç»­ä¼˜åŒ–</h3>
<p>å®šæœŸå›é¡¾ AI çš„è¾“å‡ºï¼Œå°†å¥½çš„è¡¨è¾¾åŠ å…¥ SKILLï¼Œå½¢æˆæ­£å¾ªç¯ï¼š</p>
<ol>
<li>AI è¾“å‡º â†’ äººå·¥å®¡æ ¸</li>
<li>å‘ç°å¥½çš„è¡¨è¾¾ â†’ åŠ å…¥ SKILL</li>
<li>å‘ç°é—®é¢˜ â†’ è¡¥å……æ³¨æ„äº‹é¡¹</li>
<li>ä¸‹æ¬¡è¾“å‡º â†’ è´¨é‡æå‡</li>
</ol>
<hr/>
<h2 data-id="heading-20">ğŸ“ æ€»ç»“</h2>
<p>é€šè¿‡ SKILL æŠ€æœ¯ï¼Œæˆ‘ä»¬æˆåŠŸè§£å†³äº† AI å†™ä½œé£æ ¼ä¸ä¸€è‡´çš„é—®é¢˜ï¼š</p>
<ol>
<li><strong>ä¸€æ¬¡æ•´ç†ï¼Œæ°¸ä¹…å¤ç”¨</strong>ï¼šæŠŠå†™ä½œé£æ ¼æ²‰æ·€æˆæ–‡æ¡£</li>
<li><strong>è‡ªåŠ¨è§¦å‘ï¼Œæ— éœ€æ‰‹åŠ¨</strong>ï¼šAI ä¼šæ ¹æ®ä»»åŠ¡è‡ªåŠ¨åŠ è½½</li>
<li><strong>å¯ç‰ˆæœ¬æ§åˆ¶</strong>ï¼šåƒä»£ç ä¸€æ ·ç®¡ç†å’Œè¿­ä»£</li>
<li><strong>å›¢é˜Ÿå¯åä½œ</strong>ï¼šæ•´ä¸ªå›¢é˜Ÿå…±äº«ç»Ÿä¸€çš„å†™ä½œè§„èŒƒ</li>
</ol>
<p>SKILL çš„æœ¬è´¨æ˜¯ã€Œæ•™ä¼š AI ä¸€é¡¹æŠ€èƒ½ã€ã€‚å†™ä½œé£æ ¼åªæ˜¯ä¸€ä¸ªåº”ç”¨åœºæ™¯ï¼Œä½ è¿˜å¯ä»¥ç”¨å®ƒæ¥è§„èŒƒä»£ç é£æ ¼ã€å®šä¹‰é¡¹ç›®æ¶æ„ã€è®¾ç½®å®¡æŸ¥æ ‡å‡†ç­‰ç­‰ã€‚</p>
<p>å¦‚æœä½ ä¹Ÿåœ¨ä¸º AI è¾“å‡ºä¸ç¨³å®šè€Œçƒ¦æ¼ï¼Œä¸å¦¨è¯•è¯• SKILL æ–¹æ¡ˆï¼</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/74f2e9de5c0f45ed8aa1b4e54b64f028~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5aaC5pG46bG85Y67:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769426563&amp;x-signature=5a6P7HquihumSRxzURCJLm6GGZU%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-21">ğŸ”— ç›¸å…³èµ„æº</h2>
<ul>
<li>Gemini CLI (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fanthropics%2Fgemini-cli" target="_blank" title="https://github.com/anthropics/gemini-cli" ref="nofollow noopener noreferrer">github.com/anthropics/â€¦</a>) - Google æ¨å‡ºçš„ AI å‘½ä»¤è¡Œå·¥å…·</li>
<li>wot-ui (<a href="https://link.juejin.cn?target=https%3A%2F%2Fwot-ui.cn%2F" target="_blank" title="https://wot-ui.cn/" ref="nofollow noopener noreferrer">wot-ui.cn/</a>) - æˆ‘ç»´æŠ¤çš„ uni-app ç»„ä»¶åº“</li>
</ul>
<hr/>
<h2 data-id="heading-22">å¾€æœŸç²¾å½©</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FYH7v_c0MNZ39IheitqYLLw" target="_blank" title="https://mp.weixin.qq.com/s/YH7v_c0MNZ39IheitqYLLw" ref="nofollow noopener noreferrer">å½“å¹´å·å·ç©å°éœ¸ç‹ï¼Œç°åœ¨å·å·ç”¨ Trae Solo å¤åˆ»å¦å…‹å¤§æˆ˜</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FrHJVlbVg8PkGpzfEEtZmIw" target="_blank" title="https://mp.weixin.qq.com/s/rHJVlbVg8PkGpzfEEtZmIw" ref="nofollow noopener noreferrer">uni-app æ— æ³•å®ç°å…¨å±€ Toastï¼Ÿè¿™ä¸ªæ–¹æ³•åšåˆ°äº†ï¼</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026å¹´AIå¼€å‘æ–°æ ‡å‡†æ¥äº†ï¼Chat Completionå·²è¿‡æ—¶ï¼ŒOpen Responsesæ¨ªç©ºå‡ºä¸–ï¼]]></title>    <link>https://juejin.cn/post/7596905751110352959</link>    <guid>https://juejin.cn/post/7596905751110352959</guid>    <pubDate>2026-01-19T11:36:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596905751110352959" data-draft-id="7596896373053505599" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026å¹´AIå¼€å‘æ–°æ ‡å‡†æ¥äº†ï¼Chat Completionå·²è¿‡æ—¶ï¼ŒOpen Responsesæ¨ªç©ºå‡ºä¸–ï¼"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,AIGC,LangChain"/> <meta itemprop="datePublished" content="2026-01-19T11:36:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å€”å¼ºé’é“œä¸‰"/> <meta itemprop="url" content="https://juejin.cn/user/2942757076730455"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026å¹´AIå¼€å‘æ–°æ ‡å‡†æ¥äº†ï¼Chat Completionå·²è¿‡æ—¶ï¼ŒOpen Responsesæ¨ªç©ºå‡ºä¸–ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2942757076730455/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å€”å¼ºé’é“œä¸‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T11:36:55.000Z" title="Mon Jan 19 2026 11:36:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>åŸæ–‡é“¾æ¥ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fhuggingface.co%2Fblog%2Fopen-responses" target="_blank" title="https://huggingface.co/blog/open-responses" ref="nofollow noopener noreferrer">huggingface.co/blog/open-râ€¦</a><br/>
<strong>ä½œè€…ï¼š</strong> Shaun Smith, Ben Burtenshaw, Merve, Pedro Cuenca<br/>
<strong>è¯‘è€…ï¼š</strong> å€”å¼ºé’é“œä¸‰</p>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯<strong>å€”å¼ºé’é“œä¸‰</strong>ã€‚æ¬¢è¿å…³æ³¨æˆ‘ï¼Œ<strong>å¾®ä¿¡å…¬ä¼—å·ï¼šå€”å¼ºé’é“œä¸‰</strong>ã€‚æ¬¢è¿ç‚¹èµã€æ”¶è—ã€å…³æ³¨ï¼Œä¸€é”®ä¸‰è¿ï¼ï¼ï¼</p>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯ Open Responsesï¼Ÿ</h2>
<p>Open Responses æ˜¯ä¸€ä¸ªæ–°çš„<strong>å¼€æ”¾æ¨ç†æ ‡å‡†</strong>ã€‚ç”± OpenAI å‘èµ·ï¼Œå¼€æº AI ç¤¾åŒºæ„å»ºï¼Œå¹¶ç”± Hugging Face ç”Ÿæ€ç³»ç»Ÿæ”¯æŒï¼ŒOpen Responses åŸºäº Responses APIï¼Œä¸“ä¸º<strong>æ™ºèƒ½ä½“çš„æœªæ¥</strong>è€Œè®¾è®¡ã€‚åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£ Open Responses çš„å·¥ä½œåŸç†ä»¥åŠä¸ºä»€ä¹ˆå¼€æºç¤¾åŒºåº”è¯¥ä½¿ç”¨å®ƒã€‚</p>
<blockquote>
<p>æˆ‘å·²ç»å¼„äº†ä¸€ä¸ª<code>Open Responses </code>ä¸­æ–‡é•œåƒç«™ç‚¹<a href="https://link.juejin.cn?target=https%3A%2F%2Fopenresponses-cn.top%2F" target="_blank" title="https://openresponses-cn.top/" ref="nofollow noopener noreferrer">openresponses-cn.top</a>ï¼ŒæŠŠ<code>Open Responses</code>æ–‡æ¡£è¿›è¡Œäº†ä¸­æ–‡ç¿»è¯‘ï¼Œæ–¹ä¾¿å¤§å®¶å­¦ä¹ ï¼</p>
</blockquote>
<p><strong>èŠå¤©æœºå™¨äººçš„æ—¶ä»£å·²ç»è¿‡å»ï¼Œæ™ºèƒ½ä½“ä¸»å¯¼ç€æ¨ç†å·¥ä½œè´Ÿè½½ã€‚</strong> å¼€å‘è€…æ­£åœ¨è½¬å‘èƒ½å¤Ÿæ¨ç†ã€è§„åˆ’å¹¶åœ¨é•¿æ—¶é—´èŒƒå›´å†…è¡ŒåŠ¨çš„è‡ªä¸»ç³»ç»Ÿã€‚å°½ç®¡å‘ç”Ÿäº†è¿™ç§è½¬å˜ï¼Œä½†ç”Ÿæ€ç³»ç»Ÿä¸­å¤§éƒ¨åˆ†ä»åœ¨ä½¿ç”¨ <strong>Chat Completion</strong> æ ¼å¼ï¼Œè¯¥æ ¼å¼ä¸“ä¸ºè½®æ¬¡å¯¹è¯è€Œè®¾è®¡ï¼Œå¯¹äºæ™ºèƒ½ä½“ç”¨ä¾‹æ¥è¯´<strong>åŠ›ä¸ä»å¿ƒ</strong>ã€‚</p>
<p><strong>Responses</strong> æ ¼å¼æ—¨åœ¨è§£å†³è¿™äº›é™åˆ¶ï¼Œä½†å®ƒæ˜¯å°é—­çš„ï¼Œæ²¡æœ‰è¢«å¹¿æ³›é‡‡ç”¨ã€‚<strong>Chat Completion</strong> æ ¼å¼ä»ç„¶æ˜¯äº‹å®ä¸Šçš„æ ‡å‡†ï¼Œå°½ç®¡å­˜åœ¨æ›¿ä»£æ–¹æ¡ˆã€‚</p>
<p>æ™ºèƒ½ä½“å·¥ä½œæµéœ€æ±‚ä¸æ ¹æ·±è’‚å›ºçš„æ¥å£ä¹‹é—´çš„è¿™ç§ä¸åŒ¹é…ï¼Œæ¨åŠ¨äº†å¯¹å¼€æ”¾æ¨ç†æ ‡å‡†çš„éœ€æ±‚ã€‚åœ¨æœªæ¥å‡ ä¸ªæœˆé‡Œï¼Œæˆ‘ä»¬å°†ä¸ç¤¾åŒºå’Œæ¨ç†æä¾›å•†åˆä½œï¼Œå®æ–½å¹¶è°ƒæ•´ Open Responses ä¸ºä¸€ä¸ªå…±äº«çš„æ ¼å¼ï¼Œå®é™…ä¸Šèƒ½å¤Ÿå–ä»£èŠå¤©å®Œæˆã€‚</p>
<p>Open Responses å»ºç«‹åœ¨ OpenAI äº 2025 å¹´ 3 æœˆæ¨å‡ºçš„ <strong>Responses API</strong> çš„æ–¹å‘ä¹‹ä¸Šï¼Œå®ƒç”¨ä¸€ä¸ªä¸€è‡´çš„æ–¹å¼å–ä»£äº†ç°æœ‰çš„ Completion å’Œ Assistants APIï¼š</p>
<ul>
<li>ç”Ÿæˆæ–‡æœ¬ã€å›¾åƒå’Œ JSON ç»“æ„åŒ–è¾“å‡º</li>
<li>é€šè¿‡åŸºäºä»»åŠ¡çš„å•ç‹¬ç«¯ç‚¹åˆ›å»ºè§†é¢‘å†…å®¹</li>
<li>åœ¨æä¾›å•†ç«¯è¿è¡Œæ™ºèƒ½ä½“å¾ªç¯ï¼Œè‡ªä¸»æ‰§è¡Œå·¥å…·è°ƒç”¨å¹¶è¿”å›æœ€ç»ˆç»“æœ</li>
</ul>
<h3 data-id="heading-2">ä»€ä¹ˆæ˜¯ Open Responsesï¼Ÿ</h3>
<p>Open Responses æ‰©å±•å¹¶å¼€æºäº† Responses APIï¼Œä½¿æ„å»ºè€…å’Œè·¯ç”±æä¾›å•†æ›´å®¹æ˜“äº’æ“ä½œå¹¶å°±å…±äº«åˆ©ç›Šè¿›è¡Œåä½œã€‚</p>
<p>ä¸€äº›å…³é”®ç‚¹åŒ…æ‹¬ï¼š</p>
<ul>
<li>é»˜è®¤æ— çŠ¶æ€ï¼Œæ”¯æŒéœ€è¦åŠ å¯†æ¨ç†çš„æä¾›å•†</li>
<li>æ ‡å‡†åŒ–çš„æ¨¡å‹é…ç½®å‚æ•°</li>
<li>æµå¼ä¼ è¾“è¢«å»ºæ¨¡ä¸ºä¸€ç³»åˆ—è¯­ä¹‰äº‹ä»¶ï¼Œè€Œä¸æ˜¯åŸå§‹æ–‡æœ¬æˆ–å¯¹è±¡å¢é‡</li>
<li>é€šè¿‡ç‰¹å®šäºæŸäº›æ¨¡å‹æä¾›å•†çš„å¯é…ç½®å‚æ•°è¿›è¡Œæ‰©å±•</li>
</ul>
<h3 data-id="heading-3">æˆ‘ä»¬éœ€è¦äº†è§£ä»€ä¹ˆæ‰èƒ½ä½¿ç”¨ Open Responsesï¼Ÿ</h3>
<p>æˆ‘ä»¬å°†ç®€è¦æ¢ç´¢å½±å“å¤§å¤šæ•°ç¤¾åŒºæˆå‘˜çš„æ ¸å¿ƒå˜åŒ–ã€‚å¦‚æœä½ æƒ³æ·±å…¥äº†è§£è§„èŒƒï¼Œè¯·æŸ¥çœ‹ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fopenresponses-cn.top%2F" target="_blank" title="https://openresponses-cn.top/" ref="nofollow noopener noreferrer">Open Responses æ–‡æ¡£</a></strong></p>
<h4 data-id="heading-4">å®¢æˆ·ç«¯è¯·æ±‚ Open Responses</h4>
<p>å®¢æˆ·ç«¯å¯¹ Open Responses çš„è¯·æ±‚ä¸ç°æœ‰çš„ Responses API ç±»ä¼¼ã€‚ä¸‹é¢æˆ‘ä»¬æ¼”ç¤ºä½¿ç”¨ curl å‘ Open Responses API å‘å‡ºçš„è¯·æ±‚ã€‚æˆ‘ä»¬æ­£åœ¨è°ƒç”¨ä¸€ä¸ªä»£ç†ç«¯ç‚¹ï¼Œè¯¥ç«¯ç‚¹ä½¿ç”¨ Open Responses API æ¨¡å¼è·¯ç”±åˆ°æ¨ç†æä¾›å•†ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">curl https://evalstate-openresponses.hf.space/v1/responses \\
   -H <span class="hljs-string">"Content-Type: application/json"</span> \\
   -H <span class="hljs-string">"Authorization: Bearer <span class="hljs-variable">$HF_TOKEN</span>"</span> \\
   -H <span class="hljs-string">"OpenResponses-Version: latest"</span> \\
   -N \\
   -d <span class="hljs-string">'{}
         "model": "moonshotai/Kimi-K2-Thinking:nebius",
         "input": "explain the theory of life"
       {}'</span>
</code></pre>
<h4 data-id="heading-5">æ¨ç†å®¢æˆ·ç«¯å’Œæä¾›å•†çš„å˜åŒ–</h4>
<p>å·²ç»æ”¯æŒ Responses API çš„å®¢æˆ·ç«¯å¯ä»¥ä»¥ç›¸å¯¹è¾ƒå°‘çš„åŠªåŠ›è¿ç§»åˆ° Open Responsesã€‚ä¸»è¦å˜åŒ–æ¶‰åŠæ¨ç†å†…å®¹çš„æš´éœ²æ–¹å¼ï¼š</p>
<p><strong>æ‰©å±•çš„æ¨ç†å¯è§æ€§ï¼š</strong> Open Responses ä¸ºæ¨ç†é¡¹ç›®å½¢å¼åŒ–äº†ä¸‰ä¸ªå¯é€‰å­—æ®µï¼š</p>
<ul>
<li><code>content</code>ï¼ˆåŸå§‹æ¨ç†è·Ÿè¸ªï¼‰</li>
<li><code>encrypted_content</code>ï¼ˆæä¾›å•†ç‰¹å®šçš„ä¿æŠ¤å†…å®¹ï¼‰</li>
<li><code>summary</code>ï¼ˆä»åŸå§‹è·Ÿè¸ªä¸­æ¸…ç†ï¼‰</li>
</ul>
<p>OpenAI æ¨¡å‹ä»¥å‰åªæš´éœ² <code>summary</code> å’Œ <code>encrypted_content</code>ã€‚ä½¿ç”¨ Open Responsesï¼Œæä¾›å•†å¯ä»¥é€šè¿‡ API æš´éœ²å…¶åŸå§‹æ¨ç†ã€‚</p>
<p>ä»ä»¥å‰åªè¿”å›æ‘˜è¦å’ŒåŠ å¯†å†…å®¹çš„æä¾›å•†è¿ç§»çš„å®¢æˆ·ç«¯ç°åœ¨å°†æœ‰æœºä¼šåœ¨æ‰€é€‰æä¾›å•†æ”¯æŒæ—¶æ¥æ”¶å’Œå¤„ç†åŸå§‹æ¨ç†æµã€‚</p>
<p>å®ç°æ›´ä¸°å¯Œçš„çŠ¶æ€æ›´æ”¹å’Œæœ‰æ•ˆè´Ÿè½½ï¼ŒåŒ…æ‹¬æ›´è¯¦ç»†çš„å¯è§‚å¯Ÿæ€§â€”â€”ä¾‹å¦‚ï¼Œæ‰˜ç®¡çš„ä»£ç è§£é‡Šå™¨å¯ä»¥å‘é€ç‰¹å®šçš„ <code>interpreting</code> çŠ¶æ€ï¼Œä»¥åœ¨é•¿æ—¶é—´è¿è¡Œçš„æ“ä½œæœŸé—´æ”¹å–„æ™ºèƒ½ä½“å’Œç”¨æˆ·çš„å¯è§æ€§ã€‚</p>
<p>å¯¹äºæ¨¡å‹æä¾›å•†æ¥è¯´ï¼Œå¦‚æœä»–ä»¬å·²ç»éµå®ˆ Responses API è§„èŒƒï¼Œé‚£ä¹ˆå®æ–½ Open Responses çš„æ›´æ”¹åº”è¯¥æ˜¯ç›´æˆªäº†å½“çš„ã€‚å¯¹äºè·¯ç”±å™¨ï¼Œç°åœ¨æœ‰æœºä¼šæ ‡å‡†åŒ–ä¸€è‡´çš„ç«¯ç‚¹å¹¶åœ¨éœ€è¦æ—¶æ”¯æŒé…ç½®é€‰é¡¹è¿›è¡Œè‡ªå®šä¹‰ã€‚</p>
<p>éšç€æä¾›å•†ç»§ç»­åˆ›æ–°ï¼ŒæŸäº›åŠŸèƒ½å°†åœ¨åŸºæœ¬è§„èŒƒä¸­æ ‡å‡†åŒ–ã€‚</p>
<p>æ€»ä¹‹ï¼Œè¿ç§»åˆ° Open Responses å°†ä½¿æ¨ç†ä½“éªŒæ›´åŠ ä¸€è‡´å¹¶æé«˜è´¨é‡ï¼Œå› ä¸ºä¼ ç»Ÿ Completions API çš„æœªè®°å½•æ‰©å±•ã€è§£é‡Šå’Œå˜é€šæ–¹æ³•åœ¨ Open Responses ä¸­è¢«è§„èŒƒåŒ–ã€‚</p>
<p>ä½ å¯ä»¥åœ¨ä¸‹é¢çœ‹åˆ°å¦‚ä½•æµå¼ä¼ è¾“æ¨ç†å—ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"moonshotai/Kimi-K2-Thinking:together"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"input"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"message"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"role"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"explain photosynthesis."</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"stream"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>ä»¥ä¸‹æ˜¯è·å– Open Response å’Œä½¿ç”¨ OpenAI Responses è¿›è¡Œæ¨ç†å¢é‡ä¹‹é—´çš„åŒºåˆ«ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¼€æ”¾æƒé‡æ¨¡å‹æµå¼ä¼ è¾“åŸå§‹æ¨ç†</span>
<span class="hljs-attr">event</span>: response.<span class="hljs-property">reasoning</span>.<span class="hljs-property">delta</span>
<span class="hljs-attr">data</span>: {<span class="hljs-string">"delta"</span>: <span class="hljs-string">"User asked: 'Where should I eat...' Step 1: Parse location..."</span>}

<span class="hljs-comment">// å…·æœ‰åŠ å¯†æ¨ç†çš„æ¨¡å‹å‘é€æ‘˜è¦ï¼Œæˆ–ç”±å¼€æ”¾æƒé‡æ¨¡å‹ä½œä¸ºä¾¿åˆ©å‘é€</span>
<span class="hljs-attr">event</span>: response.<span class="hljs-property">reasoning_summary_text</span>.<span class="hljs-property">delta</span>
<span class="hljs-attr">data</span>: {<span class="hljs-string">"delta"</span>: <span class="hljs-string">"Determined user wants restaurant recommendations"</span>}
</code></pre>
<h4 data-id="heading-6">Open Responses ç”¨äºè·¯ç”±</h4>
<p>Open Responses åŒºåˆ†"<strong>æ¨¡å‹æä¾›å•†</strong>"ï¼ˆæä¾›æ¨ç†çš„äººï¼‰å’Œ"<strong>è·¯ç”±å™¨</strong>"ï¼ˆåœ¨å¤šä¸ªæä¾›å•†ä¹‹é—´ç¼–æ’çš„ä¸­é—´äººï¼‰ã€‚</p>
<p>å®¢æˆ·ç«¯ç°åœ¨å¯ä»¥åœ¨å‘å‡ºè¯·æ±‚æ—¶æŒ‡å®šæä¾›å•†ä»¥åŠæä¾›å•†ç‰¹å®šçš„ API é€‰é¡¹ï¼Œå…è®¸ä¸­é—´è·¯ç”±å™¨åœ¨ä¸Šæ¸¸æä¾›å•†ä¹‹é—´ç¼–æ’è¯·æ±‚ã€‚</p>
<h4 data-id="heading-7">å·¥å…·</h4>
<p>Open Responses åŸç”Ÿæ”¯æŒä¸¤ç±»å·¥å…·ï¼š<strong>å†…éƒ¨</strong>å’Œ<strong>å¤–éƒ¨</strong>ã€‚</p>
<p>å¤–éƒ¨æ‰˜ç®¡å·¥å…·åœ¨æ¨¡å‹æä¾›å•†çš„ç³»ç»Ÿä¹‹å¤–å®æ–½ã€‚ä¾‹å¦‚ï¼Œè¦æ‰§è¡Œçš„å®¢æˆ·ç«¯åŠŸèƒ½æˆ– MCP æœåŠ¡å™¨ã€‚å†…éƒ¨æ‰˜ç®¡å·¥å…·åœ¨æ¨¡å‹æä¾›å•†çš„ç³»ç»Ÿå†…ã€‚ä¾‹å¦‚ï¼ŒOpenAI çš„æ–‡ä»¶æœç´¢æˆ– Google Drive é›†æˆã€‚æ¨¡å‹è°ƒç”¨ã€æ‰§è¡Œå¹¶å®Œå…¨åœ¨æä¾›å•†çš„åŸºç¡€è®¾æ–½å†…æ£€ç´¢ç»“æœï¼Œæ— éœ€å¼€å‘äººå‘˜å¹²é¢„ã€‚</p>
<h4 data-id="heading-8">å­ä»£ç†å¾ªç¯</h4>
<p>Open Responses å½¢å¼åŒ–äº†æ™ºèƒ½ä½“å¾ªç¯ï¼Œå®ƒé€šå¸¸ç”±æ¨ç†ã€å·¥å…·è°ƒç”¨å’Œå“åº”ç”Ÿæˆçš„é‡å¤å¾ªç¯ç»„æˆï¼Œä½¿æ¨¡å‹èƒ½å¤Ÿè‡ªä¸»å®Œæˆå¤šæ­¥éª¤ä»»åŠ¡ã€‚</p>
<p>å¾ªç¯æ“ä½œå¦‚ä¸‹ï¼š</p>
<ol>
<li>API æ¥æ”¶ç”¨æˆ·è¯·æ±‚å¹¶ä»æ¨¡å‹é‡‡æ ·</li>
<li>å¦‚æœæ¨¡å‹å‘å‡ºå·¥å…·è°ƒç”¨ï¼ŒAPI ä¼šæ‰§è¡Œå®ƒï¼ˆå†…éƒ¨æˆ–å¤–éƒ¨ï¼‰</li>
<li>å·¥å…·ç»“æœåé¦ˆç»™æ¨¡å‹ä»¥ç»§ç»­æ¨ç†</li>
<li>å¾ªç¯é‡å¤ï¼Œç›´åˆ°æ¨¡å‹å‘å‡ºå®Œæˆä¿¡å·</li>
</ol>
<p>å¯¹äºå†…éƒ¨æ‰˜ç®¡å·¥å…·ï¼Œæä¾›å•†ç®¡ç†æ•´ä¸ªå¾ªç¯ï¼›æ‰§è¡Œå·¥å…·ï¼Œå°†ç»“æœè¿”å›ç»™æ¨¡å‹ï¼Œå¹¶æµå¼ä¼ è¾“è¾“å‡ºã€‚è¿™æ„å‘³ç€å¤šæ­¥éª¤å·¥ä½œæµï¼ˆå¦‚"æœç´¢æ–‡æ¡£ã€æ€»ç»“å‘ç°ã€ç„¶åèµ·è‰ç”µå­é‚®ä»¶"ï¼‰ä½¿ç”¨å•ä¸ªè¯·æ±‚ã€‚</p>
<p>å®¢æˆ·ç«¯é€šè¿‡ <code>max_tool_calls</code> é™åˆ¶è¿­ä»£æ¬¡æ•°ï¼Œé€šè¿‡ <code>tool_choice</code> çº¦æŸå¯è°ƒç”¨å·¥å…·æ¥æ§åˆ¶å¾ªç¯è¡Œä¸ºï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"zai-org/GLM-4.7"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"input"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Find Q3 sales data and email a summary to the team"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"tools"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>...<span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"max_tool_calls"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"tool_choice"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"auto"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å“åº”åŒ…å«æ‰€æœ‰ä¸­é—´é¡¹ç›®ï¼šå·¥å…·è°ƒç”¨ã€ç»“æœã€æ¨ç†ã€‚</p>
<h2 data-id="heading-9">æ€»ç»“</h2>
<p>Open Responses æ‰©å±•å¹¶æ”¹è¿›äº† Responses APIï¼Œæä¾›æ›´ä¸°å¯Œå’Œæ›´è¯¦ç»†çš„å†…å®¹å®šä¹‰ã€å…¼å®¹æ€§å’Œéƒ¨ç½²é€‰é¡¹ã€‚å®ƒè¿˜æä¾›äº†ä¸€ç§åœ¨ä¸»æ¨ç†è°ƒç”¨æœŸé—´æ‰§è¡Œå­ä»£ç†å¾ªç¯çš„æ ‡å‡†æ–¹æ³•ï¼Œä¸º AI åº”ç”¨ç¨‹åºæ‰“å¼€å¼ºå¤§çš„åŠŸèƒ½ã€‚</p>
<blockquote>
<p>æˆ‘å·²ç»å¼„äº†ä¸€ä¸ª<code>Open Responses </code>ä¸­æ–‡é•œåƒç«™ç‚¹<a href="https://link.juejin.cn?target=https%3A%2F%2Fopenresponses-cn.top%2F" target="_blank" title="https://openresponses-cn.top/" ref="nofollow noopener noreferrer">openresponses-cn.top</a>ï¼ŒæŠŠ<code>Open Responses</code>æ–‡æ¡£è¿›è¡Œäº†ä¸­æ–‡ç¿»è¯‘ï¼Œæ–¹ä¾¿å¤§å®¶å­¦ä¹ ï¼</p>
</blockquote>
<p><strong>æ¬¢è¿å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·ï¼šå€”å¼ºé’é“œä¸‰ï¼Œè·å–æ›´å¤š AI è‡ªåŠ¨åŒ–å’Œå¼€å‘æŠ€å·§åˆ†äº«ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernateï¼ˆ51ï¼‰Hibernateçš„æŸ¥è¯¢ç¼“å­˜å¦‚ä½•ä½¿ç”¨ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7596864700509601826</link>    <guid>https://juejin.cn/post/7596864700509601826</guid>    <pubDate>2026-01-19T11:51:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596864700509601826" data-draft-id="7596864700509585442" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernateï¼ˆ51ï¼‰Hibernateçš„æŸ¥è¯¢ç¼“å­˜å¦‚ä½•ä½¿ç”¨ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-19T11:51:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernateï¼ˆ51ï¼‰Hibernateçš„æŸ¥è¯¢ç¼“å­˜å¦‚ä½•ä½¿ç”¨ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T11:51:03.000Z" title="Mon Jan 19 2026 11:51:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Hibernateçš„æŸ¥è¯¢ç¼“å­˜ï¼ˆQuery Cacheï¼‰å¯ä»¥æ˜¾è‘—æé«˜é‡å¤æŸ¥è¯¢çš„æ€§èƒ½ã€‚æŸ¥è¯¢ç¼“å­˜å­˜å‚¨çš„æ˜¯æŸ¥è¯¢ç»“æœçš„é›†åˆï¼Œè€Œä¸æ˜¯å•ä¸ªå®ä½“ã€‚è¦ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ï¼Œéœ€è¦å¯ç”¨Hibernateçš„äºŒçº§ç¼“å­˜ï¼Œå¹¶å¯¹ç‰¹å®šçš„æŸ¥è¯¢å¯ç”¨ç¼“å­˜ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†çš„ä½¿ç”¨æ­¥éª¤å’Œä»£ç ç¤ºä¾‹ã€‚</p>
<h3 data-id="heading-0">1. æ·»åŠ ä¾èµ–</h3>
<p>é¦–å…ˆï¼Œç¡®ä¿åœ¨é¡¹ç›®ä¸­æ·»åŠ äº†Hibernateå’Œç¼“å­˜æä¾›è€…çš„ä¾èµ–ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨Ehcacheä½œä¸ºç¼“å­˜æä¾›è€…çš„Mavenä¾èµ–é…ç½®ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Hibernate Core --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.hibernate<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hibernate-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.6.3.Final<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Ehcache --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.ehcache<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>ehcache<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.9.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Hibernate Ehcache Integration --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.hibernate<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hibernate-ehcache<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.6.3.Final<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h3 data-id="heading-1">2. é…ç½®Hibernate</h3>
<p>åœ¨Hibernateçš„é…ç½®æ–‡ä»¶ <code>hibernate.cfg.xml</code> ä¸­å¯ç”¨äºŒçº§ç¼“å­˜å’ŒæŸ¥è¯¢ç¼“å­˜ï¼Œå¹¶æŒ‡å®šEhcacheä½œä¸ºç¼“å­˜æä¾›è€…ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span>
        <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span>
        <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ•°æ®åº“è¿æ¥é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/your_database<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>your_username<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>your_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- Hibernate å±æ€§é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.show_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.format_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- å¯ç”¨äºŒçº§ç¼“å­˜å’ŒæŸ¥è¯¢ç¼“å­˜ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.cache.use_second_level_cache"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.cache.region.factory_class"</span>&gt;</span>org.hibernate.cache.jcache.JCacheRegionFactory<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.javax.cache.provider"</span>&gt;</span>org.ehcache.jsr107.EhcacheCachingProvider<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.cache.use_query_cache"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- æ˜ å°„ç±» --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Product"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<h3 data-id="heading-2">3. é…ç½®Ehcache</h3>
<p>åˆ›å»ºEhcacheçš„é…ç½®æ–‡ä»¶ <code>ehcache.xml</code>ï¼Œå¹¶å°†å…¶æ”¾ç½®åœ¨ç±»è·¯å¾„çš„æ ¹ç›®å½•ä¸‹ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">config</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">'http://www.w3.org/2001/XMLSchema-instance'</span>
        <span class="hljs-attr">xmlns</span>=<span class="hljs-string">'http://www.ehcache.org/v3'</span>
        <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://www.ehcache.org/v3 http://www.ehcache.org/schema/ehcache-core-3.0.xsd"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">cache</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">"com.example.domain.Product"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">key-type</span>&gt;</span>java.lang.Long<span class="hljs-tag">&lt;/<span class="hljs-name">key-type</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">value-type</span>&gt;</span>com.example.domain.Product<span class="hljs-tag">&lt;/<span class="hljs-name">value-type</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">expiry</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ttl</span> <span class="hljs-attr">unit</span>=<span class="hljs-string">"seconds"</span>&gt;</span>600<span class="hljs-tag">&lt;/<span class="hljs-name">ttl</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">expiry</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">heap</span> <span class="hljs-attr">unit</span>=<span class="hljs-string">"entries"</span>&gt;</span>1000<span class="hljs-tag">&lt;/<span class="hljs-name">heap</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">offheap</span> <span class="hljs-attr">unit</span>=<span class="hljs-string">"MB"</span>&gt;</span>100<span class="hljs-tag">&lt;/<span class="hljs-name">offheap</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">cache</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">cache</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">"org.hibernate.cache.internal.StandardQueryCache"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">key-type</span>&gt;</span>java.lang.String<span class="hljs-tag">&lt;/<span class="hljs-name">key-type</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">value-type</span>&gt;</span>java.lang.Object<span class="hljs-tag">&lt;/<span class="hljs-name">value-type</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">expiry</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ttl</span> <span class="hljs-attr">unit</span>=<span class="hljs-string">"seconds"</span>&gt;</span>600<span class="hljs-tag">&lt;/<span class="hljs-name">ttl</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">expiry</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">heap</span> <span class="hljs-attr">unit</span>=<span class="hljs-string">"entries"</span>&gt;</span>1000<span class="hljs-tag">&lt;/<span class="hljs-name">heap</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">offheap</span> <span class="hljs-attr">unit</span>=<span class="hljs-string">"MB"</span>&gt;</span>100<span class="hljs-tag">&lt;/<span class="hljs-name">offheap</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">cache</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">cache</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">"org.hibernate.cache.spi.UpdateTimestampsCache"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">key-type</span>&gt;</span>java.lang.String<span class="hljs-tag">&lt;/<span class="hljs-name">key-type</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">value-type</span>&gt;</span>java.lang.Long<span class="hljs-tag">&lt;/<span class="hljs-name">value-type</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">expiry</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ttl</span> <span class="hljs-attr">unit</span>=<span class="hljs-string">"seconds"</span>&gt;</span>600<span class="hljs-tag">&lt;/<span class="hljs-name">ttl</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">expiry</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">heap</span> <span class="hljs-attr">unit</span>=<span class="hljs-string">"entries"</span>&gt;</span>1000<span class="hljs-tag">&lt;/<span class="hljs-name">heap</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">offheap</span> <span class="hljs-attr">unit</span>=<span class="hljs-string">"MB"</span>&gt;</span>100<span class="hljs-tag">&lt;/<span class="hljs-name">offheap</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">cache</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">config</span>&gt;</span>
</code></pre>
<h3 data-id="heading-3">4. é…ç½®å®ä½“ç±»</h3>
<p>åœ¨éœ€è¦ç¼“å­˜çš„å®ä½“ç±»ä¸Šæ·»åŠ ç¼“å­˜æ³¨è§£ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> javax.persistence.*;
<span class="hljs-keyword">import</span> org.hibernate.annotations.Cache;
<span class="hljs-keyword">import</span> org.hibernate.annotations.CacheConcurrencyStrategy;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "product")</span>
<span class="hljs-meta">@Cacheable</span>
<span class="hljs-meta">@Cache(usage = CacheConcurrencyStrategy.READ_WRITE)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Product</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-meta">@Column(name = "name")</span>
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-meta">@Column(name = "price")</span>
    <span class="hljs-keyword">private</span> Double price;

    <span class="hljs-comment">// Getters and Setters</span>
}
</code></pre>
<h3 data-id="heading-4">5. ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜</h3>
<p>ä»¥ä¸‹ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Hibernateçš„æŸ¥è¯¢ç¼“å­˜ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;
<span class="hljs-keyword">import</span> org.hibernate.query.Query;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateQueryCacheExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            sessionFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>).buildSessionFactory();
        } <span class="hljs-keyword">catch</span> (Throwable ex) {
            System.err.println(<span class="hljs-string">"Initial SessionFactory creation failed."</span> + ex);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExceptionInInitializerError</span>(ex);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// æ’å…¥ä¸€äº›äº§å“</span>
        insertProduct(<span class="hljs-string">"Laptop"</span>, <span class="hljs-number">1000.0</span>);
        insertProduct(<span class="hljs-string">"Phone"</span>, <span class="hljs-number">500.0</span>);

        <span class="hljs-comment">// ç¬¬ä¸€æ¬¡æŸ¥è¯¢ï¼ˆä¼šä»æ•°æ®åº“ä¸­åŠ è½½ï¼‰</span>
        List&lt;Product&gt; products1 = getProducts();
        products1.forEach(product -&gt; System.out.println(<span class="hljs-string">"First query: "</span> + product.getName()));

        <span class="hljs-comment">// ç¬¬äºŒæ¬¡æŸ¥è¯¢ï¼ˆä¼šä»ç¼“å­˜ä¸­åŠ è½½ï¼‰</span>
        List&lt;Product&gt; products2 = getProducts();
        products2.forEach(product -&gt; System.out.println(<span class="hljs-string">"Second query: "</span> + product.getName()));

        <span class="hljs-comment">// å…³é—­SessionFactory</span>
        sessionFactory.close();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insertProduct</span><span class="hljs-params">(String name, Double price)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>();
            product.setName(name);
            product.setPrice(price);
            session.save(product);
            transaction.commit();
            System.out.println(<span class="hljs-string">"Product "</span> + name + <span class="hljs-string">" inserted"</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (transaction != <span class="hljs-literal">null</span>) {
                transaction.rollback();
            }
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            session.close();
        }
    }

    <span class="hljs-meta">@SuppressWarnings("unchecked")</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;Product&gt; <span class="hljs-title function_">getProducts</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-keyword">try</span> {
            Query&lt;Product&gt; query = session.createQuery(<span class="hljs-string">"from Product"</span>);
            query.setCacheable(<span class="hljs-literal">true</span>); <span class="hljs-comment">// å¯ç”¨æŸ¥è¯¢ç¼“å­˜</span>
            <span class="hljs-keyword">return</span> query.list();
        } <span class="hljs-keyword">finally</span> {
            session.close();
        }
    }
}
</code></pre>
<h3 data-id="heading-5">è§£é‡Š</h3>
<ol>
<li><strong>é…ç½®Hibernate</strong>ï¼šåœ¨<code>hibernate.cfg.xml</code>ä¸­å¯ç”¨äº†äºŒçº§ç¼“å­˜å’ŒæŸ¥è¯¢ç¼“å­˜ï¼Œå¹¶æŒ‡å®šäº†Ehcacheä½œä¸ºç¼“å­˜æä¾›è€…ã€‚</li>
<li><strong>é…ç½®Ehcache</strong>ï¼šåœ¨<code>ehcache.xml</code>ä¸­ä¸ºå®ä½“ç±»å’ŒæŸ¥è¯¢ç¼“å­˜åˆ†åˆ«é…ç½®äº†ç¼“å­˜ç­–ç•¥ã€‚</li>
<li><strong>é…ç½®å®ä½“ç±»</strong>ï¼šåœ¨éœ€è¦ç¼“å­˜çš„å®ä½“ç±»<code>Product</code>ä¸Šæ·»åŠ äº†<code>@Cacheable</code>å’Œ<code>@Cache</code>æ³¨è§£ã€‚</li>
<li><strong>ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜</strong>ï¼š
<ul>
<li><code>getProducts</code>æ–¹æ³•ä¸­ï¼Œé€šè¿‡è°ƒç”¨<code>query.setCacheable(true)</code>å¯ç”¨æŸ¥è¯¢ç¼“å­˜ã€‚</li>
<li>ç¬¬ä¸€æŸ¥è¯¢ä¼šä»æ•°æ®åº“ä¸­åŠ è½½æ•°æ®ï¼Œå¹¶å°†ç»“æœç¼“å­˜ã€‚</li>
<li>ç¬¬äºŒæ¬¡æŸ¥è¯¢ç›¸åŒçš„æ•°æ®æ—¶ï¼Œä¼šä»ç¼“å­˜ä¸­åŠ è½½ï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-6">ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜çš„æ³¨æ„äº‹é¡¹</h3>
<ol>
<li><strong>æŸ¥è¯¢ç»“æœçš„æœ‰æ•ˆæ€§</strong>ï¼šæŸ¥è¯¢ç¼“å­˜å­˜å‚¨çš„æ˜¯æŸ¥è¯¢ç»“æœåˆ—è¡¨ï¼Œå› æ­¤ï¼Œå¦‚æœåº•å±‚æ•°æ®å‘ç”Ÿå˜åŒ–ï¼ŒæŸ¥è¯¢ç¼“å­˜å¯èƒ½ä¼šå˜å¾—æ— æ•ˆã€‚Hibernateä¼šä½¿ç”¨ä¸€ä¸ªåä¸º<code>UpdateTimestampsCache</code>çš„ç¼“å­˜åŒºåŸŸæ¥è·Ÿè¸ªè¡¨çš„æ›´æ–°æ—¶é—´ï¼Œä»è€Œç»´æŠ¤æŸ¥è¯¢ç¼“å­˜çš„ä¸€è‡´æ€§ã€‚</li>
<li><strong>ç¼“å­˜ç­–ç•¥</strong>ï¼šé€‰æ‹©åˆé€‚çš„ç¼“å­˜ç­–ç•¥ï¼ˆå¦‚TTLã€æœ€å¤§ç¼“å­˜æ¡ç›®æ•°ç­‰ï¼‰æ¥å¹³è¡¡ç¼“å­˜çš„å‘½ä¸­ç‡å’Œå†…å­˜æ¶ˆè€—ã€‚</li>
<li><strong>ç¼“å­˜åŒºåŸŸ</strong>ï¼šå¯ä»¥ä¸ºä¸åŒçš„æŸ¥è¯¢å®šä¹‰ä¸åŒçš„ç¼“å­˜åŒºåŸŸï¼Œä»¥ä¾¿æ›´ç»†ç²’åº¦åœ°æ§åˆ¶ç¼“å­˜è¡Œä¸ºã€‚</li>
</ol>
<p>é€šè¿‡åˆç†é…ç½®å’Œä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ï¼Œå¯ä»¥æ˜¾è‘—æé«˜Hibernateåº”ç”¨ç¨‹åºçš„æŸ¥è¯¢æ€§èƒ½ã€‚å¸Œæœ›è¿™äº›è¯¦ç»†çš„è§£é‡Šå’Œä»£ç ç¤ºä¾‹èƒ½å¸®åŠ©æ‚¨æ›´å¥½åœ°ç†è§£å’Œåº”ç”¨Hibernateçš„æŸ¥è¯¢ç¼“å­˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernateï¼ˆ52ï¼‰Hibernateä¸­å¦‚ä½•å¤„ç†N+1é—®é¢˜ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7596874823722237986</link>    <guid>https://juejin.cn/post/7596874823722237986</guid>    <pubDate>2026-01-19T11:51:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596874823722237986" data-draft-id="7596864700509618210" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernateï¼ˆ52ï¼‰Hibernateä¸­å¦‚ä½•å¤„ç†N+1é—®é¢˜ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-19T11:51:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernateï¼ˆ52ï¼‰Hibernateä¸­å¦‚ä½•å¤„ç†N+1é—®é¢˜ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T11:51:55.000Z" title="Mon Jan 19 2026 11:51:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ä½¿ç”¨Hibernateè¿›è¡Œæ•°æ®åº“è®¿é—®æ—¶ï¼ŒN+1é—®é¢˜ï¼ˆä¹Ÿç§°ä¸ºselect n+1é—®é¢˜ï¼‰æ˜¯ä¸€ä¸ªå¸¸è§çš„æ€§èƒ½é—®é¢˜ã€‚å®ƒé€šå¸¸å‘ç”Ÿåœ¨å…³è”æŸ¥è¯¢ä¸­ï¼Œå³å½“ä½ æŸ¥è¯¢ä¸€ä¸ªå®ä½“åŠå…¶å…³è”å®ä½“æ—¶ï¼Œç”Ÿæˆå¤šæ¡SQLæŸ¥è¯¢è¯­å¥ï¼Œä»è€Œå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†çš„è§£å†³æ–¹æ¡ˆå’Œä»£ç ç¤ºä¾‹ã€‚</p>
<h3 data-id="heading-0">ä»€ä¹ˆæ˜¯N+1é—®é¢˜ï¼Ÿ</h3>
<p>å‡è®¾æœ‰ä¸¤ä¸ªå®ä½“ï¼š<code>Author</code>å’Œ<code>Book</code>ï¼Œä¸€ä¸ªä½œè€…å¯ä»¥æœ‰å¤šæœ¬ä¹¦ã€‚æˆ‘ä»¬æƒ³æŸ¥è¯¢æ‰€æœ‰çš„ä½œè€…åŠå…¶æ‰€å†™çš„ä¹¦ã€‚å¦‚æœæˆ‘ä»¬ç®€å•åœ°ä½¿ç”¨Hibernateçš„é»˜è®¤é…ç½®ï¼Œå¯èƒ½ä¼šé‡åˆ°N+1é—®é¢˜ï¼Œå³ï¼š</p>
<ol>
<li>ä¸€æ¡SQLæŸ¥è¯¢æ‰€æœ‰ä½œè€…ï¼ˆ1æ¬¡æŸ¥è¯¢ï¼‰ã€‚</li>
<li>å¯¹äºæ¯ä¸ªä½œè€…ï¼Œå†æ‰§è¡Œä¸€æ¡SQLæŸ¥è¯¢å…¶æ‰€å†™çš„ä¹¦ï¼ˆNæ¬¡æŸ¥è¯¢ï¼‰ã€‚</li>
</ol>
<p>æœ€ç»ˆä¼šæ‰§è¡ŒN+1æ¡SQLæŸ¥è¯¢ï¼Œè¿™å¯¹äºå¤§æ•°æ®é‡çš„æƒ…å†µï¼Œä¼šå¯¼è‡´æŸ¥è¯¢æ€§èƒ½ä¸¥é‡ä¸‹é™ã€‚</p>
<h3 data-id="heading-1">è§£å†³æ–¹æ¡ˆ</h3>
<ol>
<li><strong>ä½¿ç”¨æ‰¹é‡æŠ“å–ï¼ˆBatch Fetchingï¼‰</strong>ï¼šHibernateé€šè¿‡æ‰¹é‡æŠ“å–æ¥ä¼˜åŒ–å…³è”å®ä½“çš„è·å–ã€‚</li>
<li><strong>ä½¿ç”¨æŠ“å–ç­–ç•¥ï¼ˆFetch Strategyï¼‰</strong>ï¼š
<ul>
<li><strong>æ€¥åŠ è½½ï¼ˆEager Loadingï¼‰</strong>ï¼šé€šè¿‡åœ¨æŸ¥è¯¢è¯­å¥ä¸­ä½¿ç”¨JOINæ¥ä¸€æ¬¡æ€§åŠ è½½å…³è”çš„æ•°æ®ã€‚</li>
<li><strong>å»¶è¿ŸåŠ è½½ï¼ˆLazy Loadingï¼‰</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼ŒHibernateä½¿ç”¨å»¶è¿ŸåŠ è½½ï¼Œä½†å¯ä»¥é€šè¿‡è°ƒæ•´fetchç­–ç•¥æ¥ä¼˜åŒ–ã€‚</li>
</ul>
</li>
<li><strong>ä½¿ç”¨JPQLæˆ–HQLä¸­çš„FETCH JOIN</strong>ï¼šä½¿ç”¨JPQLæˆ–HQLä¸­çš„FETCH JOINæ¥è¿›è¡Œä¸€æ¬¡æŸ¥è¯¢è·å–æ‰€æœ‰æ•°æ®ã€‚</li>
</ol>
<h3 data-id="heading-2">å®ä½“ç±»å®šä¹‰</h3>
<p>ä»¥ä¸‹æ˜¯<code>Author</code>å’Œ<code>Book</code>å®ä½“ç±»çš„å®šä¹‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> javax.persistence.*;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "author")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Author</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-meta">@Column(name = "name")</span>
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-meta">@OneToMany(mappedBy = "author", fetch = FetchType.LAZY, cascade = CascadeType.ALL)</span>
    <span class="hljs-keyword">private</span> List&lt;Book&gt; books;

    <span class="hljs-comment">// Getters and Setters</span>
}

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "book")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Book</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-meta">@Column(name = "title")</span>
    <span class="hljs-keyword">private</span> String title;

    <span class="hljs-meta">@ManyToOne(fetch = FetchType.LAZY)</span>
    <span class="hljs-meta">@JoinColumn(name = "author_id")</span>
    <span class="hljs-keyword">private</span> Author author;

    <span class="hljs-comment">// Getters and Setters</span>
}
</code></pre>
<h3 data-id="heading-3">1. æ‰¹é‡æŠ“å–ï¼ˆBatch Fetchingï¼‰</h3>
<p>å¯ä»¥é€šè¿‡é…ç½®Hibernateçš„æ‰¹é‡æŠ“å–å±æ€§æ¥è§£å†³N+1é—®é¢˜ã€‚</p>
<h4 data-id="heading-4">é…ç½®Hibernate</h4>
<p>åœ¨Hibernateçš„é…ç½®æ–‡ä»¶<code>hibernate.cfg.xml</code>ä¸­é…ç½®æ‰¹é‡æŠ“å–ç­–ç•¥ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- other configurations --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.default_batch_fetch_size"</span>&gt;</span>10<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<h4 data-id="heading-5">ä½¿ç”¨æ‰¹é‡æŠ“å–</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
<span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();

List&lt;Author&gt; authors = session.createQuery(<span class="hljs-string">"from Author"</span>, Author.class).list();
<span class="hljs-keyword">for</span> (Author author : authors) {
    System.out.println(author.getName());
    <span class="hljs-keyword">for</span> (Book book : author.getBooks()) {
        System.out.println(<span class="hljs-string">" - "</span> + book.getTitle());
    }
}

transaction.commit();
session.close();
</code></pre>
<h3 data-id="heading-6">2. ä½¿ç”¨JPQLæˆ–HQLä¸­çš„FETCH JOIN</h3>
<p>ä½¿ç”¨FETCH JOINå¯ä»¥ä¸€æ¬¡æ€§åŠ è½½å…³è”æ•°æ®ï¼Œä»è€Œé¿å…N+1é—®é¢˜ã€‚</p>
<h4 data-id="heading-7">ä½¿ç”¨FETCH JOIN</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
<span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();

List&lt;Author&gt; authors = session.createQuery(
    <span class="hljs-string">"select a from Author a join fetch a.books"</span>, Author.class).list();
<span class="hljs-keyword">for</span> (Author author : authors) {
    System.out.println(author.getName());
    <span class="hljs-keyword">for</span> (Book book : author.getBooks()) {
        System.out.println(<span class="hljs-string">" - "</span> + book.getTitle());
    }
}

transaction.commit();
session.close();
</code></pre>
<h3 data-id="heading-8">3. ä½¿ç”¨Entity Graphs</h3>
<p>å¯ä»¥ä½¿ç”¨JPAçš„<code>Entity Graphs</code>åŠŸèƒ½æ¥æŒ‡å®šåœ¨æŸ¥è¯¢æ—¶åº”è¯¥åŠ è½½çš„å…³è”å®ä½“ã€‚</p>
<h4 data-id="heading-9">é…ç½®Entity Graphs</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "author")</span>
<span class="hljs-meta">@NamedEntityGraph(name = "author-books-graph",
    attributeNodes = @NamedAttributeNode("books"))</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Author</span> {
    <span class="hljs-comment">// existing fields and methods</span>
}
</code></pre>
<h4 data-id="heading-10">ä½¿ç”¨Entity Graphs</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
<span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();

EntityGraph&lt;?&gt; graph = session.getEntityManagerFactory()
    .createEntityGraph(<span class="hljs-string">"author-books-graph"</span>);

Map&lt;String, Object&gt; hints = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
hints.put(<span class="hljs-string">"javax.persistence.fetchgraph"</span>, graph);

List&lt;Author&gt; authors = session.createQuery(<span class="hljs-string">"select a from Author a"</span>, Author.class)
    .setHints(hints).list();
<span class="hljs-keyword">for</span> (Author author : authors) {
    System.out.println(author.getName());
    <span class="hljs-keyword">for</span> (Book book : author.getBooks()) {
        System.out.println(<span class="hljs-string">" - "</span> + book.getTitle());
    }
}

transaction.commit();
session.close();
</code></pre>
<h3 data-id="heading-11">æ€»ç»“</h3>
<ol>
<li><strong>æ‰¹é‡æŠ“å–</strong>ï¼šåœ¨Hibernateé…ç½®ä¸­è®¾ç½®<code>hibernate.default_batch_fetch_size</code>å±æ€§ã€‚</li>
<li><strong>FETCH JOIN</strong>ï¼šä½¿ç”¨JPQLæˆ–HQLä¸­çš„FETCH JOINè¯­å¥ä¸€æ¬¡æ€§åŠ è½½å…³è”æ•°æ®ã€‚</li>
<li><strong>Entity Graphs</strong>ï¼šä½¿ç”¨JPAçš„Entity GraphsåŠŸèƒ½æ¥æŒ‡å®šåœ¨æŸ¥è¯¢æ—¶åº”è¯¥åŠ è½½çš„å…³è”å®ä½“ã€‚</li>
</ol>
<p>é€šè¿‡è¿™äº›æ–¹æ³•ï¼Œå¯ä»¥æœ‰æ•ˆåœ°è§£å†³N+1é—®é¢˜ï¼Œæ˜¾è‘—æé«˜Hibernateåº”ç”¨ç¨‹åºçš„æŸ¥è¯¢æ€§èƒ½ã€‚å¸Œæœ›è¿™äº›è¯¦ç»†çš„è§£é‡Šå’Œä»£ç ç¤ºä¾‹èƒ½å¸®åŠ©æ‚¨æ›´å¥½åœ°ç†è§£å’Œåº”ç”¨Hibernateçš„ä¼˜åŒ–æŠ€æœ¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¿˜åœ¨æ— è„‘ .map().filter()ï¼Ÿå®æµ‹æ”¹ç”¨ Iterator Helpers åï¼Œå†…å­˜å ç”¨é™ä½äº† 99%]]></title>    <link>https://juejin.cn/post/7596926832912498751</link>    <guid>https://juejin.cn/post/7596926832912498751</guid>    <pubDate>2026-01-19T11:53:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596926832912498751" data-draft-id="7596865421612302390" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¿˜åœ¨æ— è„‘ .map().filter()ï¼Ÿå®æµ‹æ”¹ç”¨ Iterator Helpers åï¼Œå†…å­˜å ç”¨é™ä½äº† 99%"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-19T11:53:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´"/> <meta itemprop="url" content="https://juejin.cn/user/2175258804632332"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¿˜åœ¨æ— è„‘ .map().filter()ï¼Ÿå®æµ‹æ”¹ç”¨ Iterator Helpers åï¼Œå†…å­˜å ç”¨é™ä½äº† 99%
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2175258804632332/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¹Ÿæ— é£é›¨ä¹Ÿé›¾æ™´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T11:53:53.000Z" title="Mon Jan 19 2026 11:53:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åˆ«å†æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½è½¬æˆæ•°ç»„äº†ï¼šIterator Helpers æ€§èƒ½å®æµ‹</h2>
<p>ä»Šå¤©çœ‹åˆ°ä¸€ç¯‡æ–‡ç« ï¼Œæ ‡é¢˜å¾ˆç›´æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fallthingssmitty.com%2F2026%2F01%2F12%2Fstop-turning-everything-into-arrays-and-do-less-work-instead%2F" target="_blank" title="https://allthingssmitty.com/2026/01/12/stop-turning-everything-into-arrays-and-do-less-work-instead/" ref="nofollow noopener noreferrer">Stop turning everything into arrays</a>ã€‚ä½œè€…çš„è§‚ç‚¹æ˜¯ï¼ŒJavaScript é‡Œæˆ‘ä»¬ä¹ æƒ¯äº†ç”¨ <code>.map().filter().slice()</code> è¿™ç§é“¾å¼è°ƒç”¨ï¼Œçœ‹ç€å¾ˆä¼˜é›…ï¼Œä½†å…¶å®æ¯ä¸€æ­¥éƒ½åœ¨åˆ›å»ºæ–°æ•°ç»„ï¼Œåšäº†å¾ˆå¤šä¸å¿…è¦çš„å·¥ä½œã€‚</p>
<p>æˆ‘ä¸€å¼€å§‹ä¹ŸåŠä¿¡åŠç–‘ï¼Œæ¯•ç«Ÿè¿™ç§å†™æ³•ç”¨äº†è¿™ä¹ˆå¤šå¹´ï¼ŒçœŸçš„æœ‰é‚£ä¹ˆå¤§é—®é¢˜å—ï¼Ÿäºæ˜¯æˆ‘å†™äº†ä¸ªæµ‹è¯•è„šæœ¬ï¼Œè·‘äº†å‡ ç»„å¯¹æ¯”å®éªŒï¼Œç»“æœè¿˜æŒºå‡ºä¹æ„æ–™çš„ã€‚</p>
<h3 data-id="heading-1">é—®é¢˜åœ¨å“ª</h3>
<p>å…ˆè¯´ä¼ ç»Ÿæ•°ç»„æ–¹æ³•çš„é—®é¢˜ã€‚å‡è®¾ä½ æœ‰ä¸ªå¸¸è§åœºæ™¯ï¼šä»ä¸€ä¸ªå¤§åˆ—è¡¨é‡Œç­›é€‰å‡ºç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼Œåšç‚¹è½¬æ¢ï¼Œç„¶ååªå–å‰ 10 æ¡æ˜¾ç¤ºã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> visibleItems = items
  .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">active</span>)
  .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ <span class="hljs-attr">id</span>: item.<span class="hljs-property">id</span>, <span class="hljs-attr">doubled</span>: item.<span class="hljs-property">value</span> * <span class="hljs-number">2</span> }))
  .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>);
</code></pre>
<p>è¿™ä»£ç çœ‹ç€æ²¡æ¯›ç—…ï¼Œä½†å®é™…æ‰§è¡Œæ—¶ï¼š</p>
<ol>
<li><code>filter</code> éå†æ•´ä¸ªæ•°ç»„ï¼Œåˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„</li>
<li><code>map</code> å†éå†ä¸€éï¼Œåˆåˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„</li>
<li><code>slice</code> æœ€åä»ç»“æœé‡Œå–å‰ 10 æ¡ï¼Œåˆåˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„</li>
</ol>
<p>å¦‚æœ <code>items</code> æœ‰ 10 ä¸‡æ¡æ•°æ®ï¼Œä½ å¯èƒ½åªéœ€è¦ 10 æ¡ï¼Œä½†å‰é¢ä¸¤æ­¥å·²ç»æŠŠ 10 ä¸‡æ¡å…¨å¤„ç†å®Œäº†ã€‚è¿™å°±æ˜¯"æ€¥åˆ‡æ±‚å€¼"ï¼ˆeager evaluationï¼‰çš„é—®é¢˜â€”â€”ä¸ç®¡ä½ æœ€åç”¨ä¸ç”¨ï¼Œå…ˆæŠŠæ´»å…¨å¹²äº†å†è¯´ã€‚</p>
<h3 data-id="heading-2">Iterator Helpers æ˜¯ä»€ä¹ˆ</h3>
<p>Iterator Helpers æ˜¯ JavaScript æ–°åŠ çš„ç‰¹æ€§ï¼Œæä¾›äº†ä¸€å¥—"æƒ°æ€§æ±‚å€¼"ï¼ˆlazy evaluationï¼‰çš„æ–¹æ³•ã€‚å…³é”®åŒºåˆ«æ˜¯ï¼š</p>
<ul>
<li><strong>ä¼ ç»Ÿæ•°ç»„æ–¹æ³•</strong>ï¼šæ¯ä¸€æ­¥éƒ½ç«‹å³æ‰§è¡Œï¼Œåˆ›å»ºä¸­é—´æ•°ç»„</li>
<li><strong>Iterator Helpers</strong>ï¼šåªæè¿°è¦åšä»€ä¹ˆï¼ŒçœŸæ­£éœ€è¦æ•°æ®æ—¶æ‰æ‰§è¡Œ</li>
</ul>
<p>ç”¨æ³•ä¸Šä¹Ÿå¾ˆç›´è§‚ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> visibleItems = items
  .<span class="hljs-title function_">values</span>()              <span class="hljs-comment">// è½¬æˆ iterator</span>
  .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">active</span>)
  .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ <span class="hljs-attr">id</span>: item.<span class="hljs-property">id</span>, <span class="hljs-attr">doubled</span>: item.<span class="hljs-property">value</span> * <span class="hljs-number">2</span> }))
  .<span class="hljs-title function_">take</span>(<span class="hljs-number">10</span>)              <span class="hljs-comment">// åªå– 10 æ¡</span>
  .<span class="hljs-title function_">toArray</span>();            <span class="hljs-comment">// æœ€åè½¬å›æ•°ç»„</span>
</code></pre>
<p>æ ¸å¿ƒå·®å¼‚åœ¨äºï¼š</p>
<ol>
<li><code>items.values()</code> è¿”å›çš„æ˜¯ iteratorï¼Œä¸æ˜¯æ•°ç»„</li>
<li>æ¯ä¸€æ­¥åªæ˜¯åœ¨"æè¿°"æ“ä½œï¼Œä¸ä¼šç«‹å³æ‰§è¡Œ</li>
<li><code>take(10)</code> å‘Šè¯‰å®ƒåªéœ€è¦ 10 æ¡ï¼Œå¤„ç†åˆ° 10 æ¡å°±åœ</li>
<li><code>toArray()</code> æ‰çœŸæ­£è§¦å‘æ‰§è¡Œï¼Œè€Œä¸”åªå¤„ç†éœ€è¦çš„æ•°æ®</li>
</ol>
<h3 data-id="heading-3">å®æµ‹å¯¹æ¯”</h3>
<p>æˆ‘å†™äº†ä¸ªæµ‹è¯•è„šæœ¬ï¼Œä»<strong>æ—¶é—´</strong>å’Œ<strong>ç©ºé—´</strong>ä¸¤ä¸ªç»´åº¦è¿›è¡Œå¯¹æ¯”æµ‹è¯•ã€‚æ¯ç»„åœºæ™¯çš„æ—¶é—´æµ‹è¯•é‡å¤ 10 æ¬¡å–å¹³å‡å€¼ï¼Œå†…å­˜æµ‹è¯•ä½¿ç”¨ Node.js çš„ <code>process.memoryUsage()</code> API æµ‹é‡å †å†…å­˜å¢é•¿ã€‚</p>
<h4 data-id="heading-4">åœºæ™¯ 1ï¼šè¿‡æ»¤ + è½¬æ¢ + å–å‰ 10 é¡¹</h4>
<p><strong>æ•°æ®è§„æ¨¡</strong>ï¼š100,000 æ¡</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼ ç»Ÿæ•°ç»„æ–¹æ³•</span>
dataset
  .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">active</span>)
  .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ <span class="hljs-attr">id</span>: item.<span class="hljs-property">id</span>, <span class="hljs-attr">doubled</span>: item.<span class="hljs-property">value</span> * <span class="hljs-number">2</span> }))
  .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>);

<span class="hljs-comment">// Iterator Helpers</span>
dataset
  .<span class="hljs-title function_">values</span>()
  .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">active</span>)
  .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ <span class="hljs-attr">id</span>: item.<span class="hljs-property">id</span>, <span class="hljs-attr">doubled</span>: item.<span class="hljs-property">value</span> * <span class="hljs-number">2</span> }))
  .<span class="hljs-title function_">take</span>(<span class="hljs-number">10</span>)
  .<span class="hljs-title function_">toArray</span>();
</code></pre>
<p><strong>ç»“æœ</strong>ï¼š</p>























<table><thead><tr><th>ç»´åº¦</th><th>ä¼ ç»Ÿæ•°ç»„æ–¹æ³•</th><th>Iterator Helpers</th><th>æ€§èƒ½æå‡</th></tr></thead><tbody><tr><td>æ—¶é—´</td><td>1.545ms</td><td>0.019ms</td><td><strong>98.77%</strong></td></tr><tr><td>å†…å­˜</td><td>3.38 MB</td><td>0.01 MB</td><td><strong>99.75%</strong></td></tr></tbody></table>
<p>è¿™ä¸ªç»“æœå¾ˆå¤¸å¼ ï¼ŒIterator Helpers åœ¨æ—¶é—´ä¸Šå¿«äº† 80 å¤šå€ï¼Œå†…å­˜ä½¿ç”¨æ›´æ˜¯åªæœ‰ä¼ ç»Ÿæ–¹æ³•çš„ 0.3%ã€‚åŸå› å¾ˆç®€å•ï¼šä¼ ç»Ÿæ–¹æ³•å¤„ç†äº†æ‰€æœ‰ 10 ä¸‡æ¡æ•°æ®å¹¶åˆ›å»ºäº† 2 ä¸ªä¸­é—´æ•°ç»„ï¼ˆfilter å’Œ map å„ä¸€ä¸ªï¼‰ï¼Œè€Œ Iterator Helpers æ‰¾åˆ° 10 æ¡å°±åœäº†ï¼Œå®Œå…¨ä¸åˆ›å»ºä¸­é—´æ•°ç»„ã€‚</p>
<h4 data-id="heading-5">åœºæ™¯ 2ï¼šåµŒå¥—æ•°æ®æ‰å¹³åŒ–</h4>
<p><strong>æ•°æ®è§„æ¨¡</strong>ï¼š10,000 ä¸ªçˆ¶é¡¹ï¼Œæ¯ä¸ªåŒ…å« 10 ä¸ªå­é¡¹ï¼ˆå…± 100,000 æ¡å­æ•°æ®ï¼‰</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼ ç»Ÿæ•°ç»„æ–¹æ³•</span>
dataset
  .<span class="hljs-title function_">flatMap</span>(<span class="hljs-function"><span class="hljs-params">parent</span> =&gt;</span> parent.<span class="hljs-property">children</span>)
  .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> child.<span class="hljs-property">value</span> &gt; <span class="hljs-number">50</span>)
  .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">20</span>);

<span class="hljs-comment">// Iterator Helpers</span>
dataset
  .<span class="hljs-title function_">values</span>()
  .<span class="hljs-title function_">flatMap</span>(<span class="hljs-function"><span class="hljs-params">parent</span> =&gt;</span> parent.<span class="hljs-property">children</span>)
  .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> child.<span class="hljs-property">value</span> &gt; <span class="hljs-number">50</span>)
  .<span class="hljs-title function_">take</span>(<span class="hljs-number">20</span>)
  .<span class="hljs-title function_">toArray</span>();
</code></pre>
<p><strong>ç»“æœ</strong>ï¼š</p>























<table><thead><tr><th>ç»´åº¦</th><th>ä¼ ç»Ÿæ•°ç»„æ–¹æ³•</th><th>Iterator Helpers</th><th>æ€§èƒ½æå‡</th></tr></thead><tbody><tr><td>æ—¶é—´</td><td>3.716ms</td><td>0.018ms</td><td><strong>99.53%</strong></td></tr><tr><td>å†…å­˜</td><td>4.03 MB</td><td>0.01 MB</td><td><strong>99.73%</strong></td></tr></tbody></table>
<p><code>flatMap</code> è¿™ç§åœºæ™¯æ›´æ˜æ˜¾ï¼Œå› ä¸ºä¼ ç»Ÿæ–¹æ³•è¦å…ˆæŠŠæ‰€æœ‰åµŒå¥—æ•°æ®ï¼ˆ10 ä¸‡æ¡å­æ•°æ®ï¼‰å±•å¹³æˆä¸€ä¸ªå¤§æ•°ç»„ï¼Œå†è¿‡æ»¤ï¼Œå†åˆ‡ç‰‡ï¼Œåˆ›å»ºäº† 2 ä¸ªä¸­é—´æ•°ç»„ã€‚Iterator Helpers ç›´æ¥åœ¨å±•å¹³çš„è¿‡ç¨‹ä¸­å°±èƒ½æå‰ç»ˆæ­¢ï¼Œå†…å­˜ä½¿ç”¨å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</p>
<h4 data-id="heading-6">åœºæ™¯ 3ï¼šæŸ¥æ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹</h4>
<p><strong>æ•°æ®è§„æ¨¡</strong>ï¼š1,000,000 æ¡ï¼ˆç›®æ ‡åœ¨ç¬¬ 800,000 æ¡ï¼‰</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼ ç»Ÿæ•°ç»„æ–¹æ³•</span>
dataset.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === targetId)[<span class="hljs-number">0</span>];

<span class="hljs-comment">// Iterator Helpers</span>
dataset.<span class="hljs-title function_">values</span>().<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === targetId);
</code></pre>
<p><strong>ç»“æœ</strong>ï¼š</p>























<table><thead><tr><th>ç»´åº¦</th><th>ä¼ ç»Ÿæ•°ç»„æ–¹æ³•</th><th>Iterator Helpers</th><th>æ€§èƒ½å˜åŒ–</th></tr></thead><tbody><tr><td>æ—¶é—´</td><td>6.587ms</td><td>8.713ms</td><td><strong>-32.27%</strong> âš ï¸</td></tr><tr><td>å†…å­˜</td><td>0.01 MB</td><td>14.80 MB</td><td><strong>-194800%</strong> âš ï¸</td></tr></tbody></table>
<p>è¿™ä¸ªåœºæ™¯å¾ˆæœ‰æ„æ€ï¼ŒIterator Helpers åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šéƒ½<strong>æ›´å·®</strong>äº†ã€‚æˆ‘åˆ†æäº†ä¸€ä¸‹åŸå› ï¼š</p>
<ol>
<li><strong>æ—¶é—´æ…¢çš„åŸå› </strong>ï¼šç›®æ ‡åœ¨æ•°æ®é›†ååŠéƒ¨åˆ†ï¼ˆç¬¬ 80 ä¸‡æ¡ï¼‰ï¼Œä¸¤è€…éƒ½è¦éå†å¤§éƒ¨åˆ†æ•°æ®ã€‚<code>filter</code> æ˜¯åŸç”Ÿå®ç°ï¼Œä¼˜åŒ–å¾—å¾ˆå¥½ï¼›è€Œ Iterator Helpers çš„ <code>find</code> æ¯æ¬¡è¿­ä»£çš„å¼€é”€æ›´å¤§</li>
<li><strong>å†…å­˜å¤šçš„åŸå› </strong>ï¼šè¿™ä¸ªæµ‹è¯•ç»“æœæœ‰ç‚¹åç›´è§‰ï¼Œå¯èƒ½æ˜¯å› ä¸º iterator æœ¬èº«çš„å†…éƒ¨çŠ¶æ€å ç”¨äº†å†…å­˜ï¼Œè€Œä¸” GC æ—¶æœºä¸åŒå¯¼è‡´æµ‹é‡åå·®</li>
</ol>
<p>è¿™è¯´æ˜ Iterator Helpers ä¸æ˜¯é“¶å¼¹ï¼Œåœ¨"éœ€è¦éå†å¤§éƒ¨åˆ†æ•°æ®"çš„åœºæ™¯ä¸‹ï¼Œä¼ ç»Ÿæ–¹æ³•å¯èƒ½æ›´å¥½ã€‚</p>
<h4 data-id="heading-7">åœºæ™¯ 4ï¼šå¤æ‚é“¾å¼è°ƒç”¨</h4>
<p><strong>æ•°æ®è§„æ¨¡</strong>ï¼š50,000 æ¡</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼ ç»Ÿæ•°ç»„æ–¹æ³•</span>
dataset
  .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">active</span>)
  .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ ...item, <span class="hljs-attr">doubled</span>: item.<span class="hljs-property">value</span> * <span class="hljs-number">2</span> }))
  .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">doubled</span> &gt; <span class="hljs-number">500</span>)
  .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ <span class="hljs-attr">id</span>: item.<span class="hljs-property">id</span>, <span class="hljs-attr">final</span>: item.<span class="hljs-property">doubled</span> + <span class="hljs-number">100</span> }))
  .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">15</span>);

<span class="hljs-comment">// Iterator Helpers</span>
dataset
  .<span class="hljs-title function_">values</span>()
  .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">active</span>)
  .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ ...item, <span class="hljs-attr">doubled</span>: item.<span class="hljs-property">value</span> * <span class="hljs-number">2</span> }))
  .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">doubled</span> &gt; <span class="hljs-number">500</span>)
  .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ <span class="hljs-attr">id</span>: item.<span class="hljs-property">id</span>, <span class="hljs-attr">final</span>: item.<span class="hljs-property">doubled</span> + <span class="hljs-number">100</span> }))
  .<span class="hljs-title function_">take</span>(<span class="hljs-number">15</span>)
  .<span class="hljs-title function_">toArray</span>();
</code></pre>
<p><strong>ç»“æœ</strong>ï¼š</p>























<table><thead><tr><th>ç»´åº¦</th><th>ä¼ ç»Ÿæ•°ç»„æ–¹æ³•</th><th>Iterator Helpers</th><th>æ€§èƒ½æå‡</th></tr></thead><tbody><tr><td>æ—¶é—´</td><td>1.421ms</td><td>0.028ms</td><td><strong>98.02%</strong></td></tr><tr><td>å†…å­˜</td><td>5.33 MB</td><td>0.01 MB</td><td><strong>99.75%</strong></td></tr></tbody></table>
<p>é“¾å¼è°ƒç”¨è¶Šå¤šï¼Œä¼ ç»Ÿæ–¹æ³•åˆ›å»ºçš„ä¸­é—´æ•°ç»„å°±è¶Šå¤šã€‚è¿™ä¸ªåœºæ™¯æœ‰ 4 æ¬¡æ“ä½œï¼ˆfilter â†’ map â†’ filter â†’ mapï¼‰ï¼Œä¼ ç»Ÿæ–¹æ³•åˆ›å»ºäº† 4 ä¸ªä¸­é—´æ•°ç»„ï¼Œæ€»å…±å ç”¨ 5.33 MB å†…å­˜ï¼›è€Œ Iterator Helpers ä¸€ä¸ªä¸­é—´æ•°ç»„éƒ½æ²¡åˆ›å»ºï¼Œå†…å­˜ä½¿ç”¨å‡ ä¹ä¸ºé›¶ã€‚</p>
<h3 data-id="heading-8">ä»€ä¹ˆæ—¶å€™ç”¨ Iterator Helpers</h3>
<p>æ ¹æ®æµ‹è¯•ç»“æœï¼Œæˆ‘æ€»ç»“äº†å‡ ä¸ªé€‚åˆç”¨ Iterator Helpers çš„åœºæ™¯ï¼š</p>
<h4 data-id="heading-9">1. åªéœ€è¦å‰ N é¡¹</h4>
<p>è¿™æ˜¯æœ€æ˜æ˜¾çš„ä¼˜åŠ¿åœºæ™¯ã€‚æ— é™æ»šåŠ¨ã€åˆ†é¡µåŠ è½½ã€è™šæ‹Ÿåˆ—è¡¨è¿™äº›åœºæ™¯éƒ½é€‚åˆã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è™šæ‹Ÿåˆ—è¡¨åªæ¸²æŸ“å¯è§çš„ 20 æ¡</span>
<span class="hljs-keyword">const</span> visibleRows = allRows
  .<span class="hljs-title function_">values</span>()
  .<span class="hljs-title function_">filter</span>(isInViewport)
  .<span class="hljs-title function_">take</span>(<span class="hljs-number">20</span>)
  .<span class="hljs-title function_">toArray</span>();
</code></pre>
<h4 data-id="heading-10">2. æµå¼æ•°æ®å¤„ç†</h4>
<p>å¤„ç† API åˆ†é¡µã€SSE æµã€WebSocket æ¶ˆæ¯è¿™äº›åœºæ™¯ï¼ŒIterator Helpers é…åˆ async iterator å¾ˆå¥½ç”¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span>* <span class="hljs-title function_">fetchPages</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">let</span> page = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/items?page=<span class="hljs-subst">${page++}</span>`</span>);
    <span class="hljs-keyword">if</span> (!res.<span class="hljs-property">ok</span>) <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">yield</span>* <span class="hljs-keyword">await</span> res.<span class="hljs-title function_">json</span>();
  }
}

<span class="hljs-comment">// åªæ‹‰å–éœ€è¦çš„æ•°æ®ï¼Œä¸ä¼šä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰åˆ†é¡µ</span>
<span class="hljs-keyword">const</span> firstTen = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchPages</span>()
  .<span class="hljs-title function_">filter</span>(isValid)
  .<span class="hljs-title function_">take</span>(<span class="hljs-number">10</span>)
  .<span class="hljs-title function_">toArray</span>();
</code></pre>
<h4 data-id="heading-11">3. å¤æ‚çš„æ•°æ®ç®¡é“</h4>
<p>å¦‚æœä½ çš„æ•°æ®å¤„ç†é“¾è·¯å¾ˆé•¿ï¼Œæœ‰å¤šæ¬¡ <code>filter</code>ã€<code>map</code>ã€<code>flatMap</code>ï¼Œç”¨ Iterator Helpers èƒ½é¿å…åˆ›å»ºä¸€å †ä¸­é—´æ•°ç»„ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> result = data
  .<span class="hljs-title function_">values</span>()
  .<span class="hljs-title function_">filter</span>(step1)
  .<span class="hljs-title function_">map</span>(step2)
  .<span class="hljs-title function_">flatMap</span>(step3)
  .<span class="hljs-title function_">filter</span>(step4)
  .<span class="hljs-title function_">take</span>(<span class="hljs-number">100</span>)
  .<span class="hljs-title function_">toArray</span>();
</code></pre>
<h3 data-id="heading-12">ä»€ä¹ˆæ—¶å€™ä¸ç”¨</h3>
<p>Iterator Helpers ä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ï¼Œè¿™å‡ ç§æƒ…å†µè¿˜æ˜¯è€è€å®å®ç”¨æ•°ç»„ï¼š</p>
<h4 data-id="heading-13">1. éœ€è¦éšæœºè®¿é—®</h4>
<p>Iterator æ˜¯å•å‘çš„ï¼Œä¸èƒ½ <code>items[5]</code> è¿™æ ·ç›´æ¥å–æŸä¸€é¡¹ã€‚å¦‚æœä½ éœ€è¦éšæœºè®¿é—®ï¼Œè¿˜æ˜¯å¾—ç”¨æ•°ç»„ã€‚</p>
<h4 data-id="heading-14">2. æ•°æ®é‡å¾ˆå°</h4>
<p>å¦‚æœå°±å‡ åæ¡æ•°æ®ï¼Œç”¨ Iterator Helpers åè€Œå¢åŠ äº†å¤æ‚åº¦ï¼Œä¼ ç»Ÿæ•°ç»„æ–¹æ³•æ›´ç®€å•ç›´æ¥ã€‚</p>
<h4 data-id="heading-15">3. éœ€è¦å¤šæ¬¡éå†</h4>
<p>Iterator åªèƒ½éå†ä¸€æ¬¡ï¼Œå¦‚æœä½ éœ€è¦å¯¹åŒä¸€ä»½æ•°æ®åšå¤šæ¬¡ä¸åŒçš„å¤„ç†ï¼Œè¿˜æ˜¯å…ˆ <code>toArray()</code> è½¬æˆæ•°ç»„å†è¯´ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> iter = data.<span class="hljs-title function_">values</span>().<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x &gt; <span class="hljs-number">10</span>);

<span class="hljs-comment">// âŒ ç¬¬äºŒæ¬¡éå†ä¼šè¿”å›ç©ºï¼Œå› ä¸º iterator å·²ç»æ¶ˆè´¹å®Œäº†</span>
<span class="hljs-keyword">const</span> first = iter.<span class="hljs-title function_">take</span>(<span class="hljs-number">5</span>).<span class="hljs-title function_">toArray</span>();
<span class="hljs-keyword">const</span> second = iter.<span class="hljs-title function_">take</span>(<span class="hljs-number">5</span>).<span class="hljs-title function_">toArray</span>(); <span class="hljs-comment">// []</span>

<span class="hljs-comment">// âœ… å…ˆè½¬æ•°ç»„ï¼Œå†å¤šæ¬¡ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> filtered = data.<span class="hljs-title function_">values</span>().<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x &gt; <span class="hljs-number">10</span>).<span class="hljs-title function_">toArray</span>();
<span class="hljs-keyword">const</span> first = filtered.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>);
<span class="hljs-keyword">const</span> second = filtered.<span class="hljs-title function_">slice</span>(<span class="hljs-number">5</span>, <span class="hljs-number">10</span>);
</code></pre>
<h3 data-id="heading-16">å…¼å®¹æ€§</h3>
<p>Iterator Helpers åœ¨ç°ä»£æµè§ˆå™¨å’Œ Node.js 22+ éƒ½å·²ç»æ”¯æŒäº†ã€‚å¦‚æœä½ çš„é¡¹ç›®è¿˜è¦å…¼å®¹è€ç‰ˆæœ¬ï¼Œå¯ä»¥ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzloirock%2Fcore-js" target="_blank" title="https://github.com/zloirock/core-js" ref="nofollow noopener noreferrer">core-js</a> è¿™ç±» polyfillã€‚</p>
<p>å¯ä»¥åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcaniuse.com%2Fiterator-helpers" target="_blank" title="https://caniuse.com/iterator-helpers" ref="nofollow noopener noreferrer">Can I Use</a> æŸ¥çœ‹è¯¦ç»†çš„å…¼å®¹æ€§æ•°æ®ã€‚</p>
<h3 data-id="heading-17">ä¸€äº›å‘</h3>
<h4 data-id="heading-18">1. Iterator ä¸æ˜¯æ•°ç»„</h4>
<p>è¿™æ˜¯æœ€å®¹æ˜“è¸©çš„å‘ã€‚Iterator æ²¡æœ‰ <code>length</code>ã€<code>[index]</code> è¿™äº›å±æ€§ï¼Œä¹Ÿä¸èƒ½ç›´æ¥ <code>console.log</code> çœ‹å†…å®¹ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> iter = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>].<span class="hljs-title function_">values</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(iter.<span class="hljs-property">length</span>);  <span class="hljs-comment">// undefined</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(iter[<span class="hljs-number">0</span>]);      <span class="hljs-comment">// undefined</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(iter);         <span class="hljs-comment">// Object [Array Iterator] {}</span>

<span class="hljs-comment">// è¦çœ‹å†…å®¹ï¼Œå¾—å…ˆè½¬æ•°ç»„</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([...iter]);    <span class="hljs-comment">// [1, 2, 3]</span>
</code></pre>
<h4 data-id="heading-19">2. <code>reduce</code> ä¸æ˜¯æƒ°æ€§çš„</h4>
<p>å¤§éƒ¨åˆ† Iterator Helpers éƒ½æ˜¯æƒ°æ€§çš„ï¼Œä½† <code>reduce</code> æ˜¯ä¸ªä¾‹å¤–ï¼Œå®ƒå¿…é¡»éå†æ‰€æœ‰æ•°æ®æ‰èƒ½å¾—å‡ºç»“æœã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// reduce ä¼šç«‹å³æ¶ˆè´¹æ•´ä¸ª iterator</span>
<span class="hljs-keyword">const</span> sum = data.<span class="hljs-title function_">values</span>().<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">acc, x</span>) =&gt;</span> acc + x, <span class="hljs-number">0</span>);
</code></pre>
<h4 data-id="heading-20">3. è°ƒè¯•ä¸æ–¹ä¾¿</h4>
<p>å› ä¸ºæ˜¯æƒ°æ€§æ±‚å€¼ï¼Œä½ ä¸èƒ½åœ¨ä¸­é—´æ­¥éª¤æ‰“æ–­ç‚¹çœ‹æ•°æ®ã€‚å¦‚æœè¦è°ƒè¯•ï¼Œå¯ä»¥åœ¨å…³é”®æ­¥éª¤æ’å…¥ <code>toArray()</code> è½¬æˆæ•°ç»„å†çœ‹ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> result = data
  .<span class="hljs-title function_">values</span>()
  .<span class="hljs-title function_">filter</span>(step1)
  .<span class="hljs-title function_">toArray</span>()  <span class="hljs-comment">// è°ƒè¯•ç”¨ï¼Œçœ‹çœ‹ filter åçš„ç»“æœ</span>
  .<span class="hljs-title function_">values</span>()
  .<span class="hljs-title function_">map</span>(step2)
  .<span class="hljs-title function_">take</span>(<span class="hljs-number">10</span>)
  .<span class="hljs-title function_">toArray</span>();
</code></pre>
<h3 data-id="heading-21">æ€»ç»“</h3>
<p>Iterator Helpers ä¸æ˜¯è¦æ›¿ä»£æ•°ç»„ï¼Œè€Œæ˜¯ç»™äº†æˆ‘ä»¬å¦ä¸€ä¸ªé€‰æ‹©ã€‚æ ¸å¿ƒæ€è·¯å°±ä¸€å¥è¯ï¼š<strong>å¦‚æœä½ ä¸éœ€è¦æ•´ä¸ªæ•°ç»„ï¼Œå°±åˆ«åˆ›å»ºå®ƒ</strong>ã€‚</p>
<p>ä»å®æµ‹ç»“æœçœ‹ï¼š</p>
<ul>
<li>åœ¨"å–å‰ N é¡¹"è¿™ç±»åœºæ™¯ä¸‹ï¼Œ<strong>æ—¶é—´å’Œç©ºé—´å¼€é”€éƒ½èƒ½é™ä½ 90%+</strong></li>
<li>åœ¨"éœ€è¦éå†å¤§éƒ¨åˆ†æ•°æ®"çš„åœºæ™¯ä¸‹ï¼Œä¼ ç»Ÿæ–¹æ³•å¯èƒ½æ›´å¿«ï¼ˆåœºæ™¯ 3 æ˜¯ä¸ªåä¾‹ï¼‰</li>
<li>æ•°æ®è§„æ¨¡è¶Šå¤§ï¼ŒIterator Helpers çš„ä¼˜åŠ¿è¶Šæ˜æ˜¾</li>
<li><strong>å†…å­˜ä¼˜åŠ¿å°¤å…¶çªå‡º</strong>ï¼šä¼ ç»Ÿæ–¹æ³•åˆ›å»ºçš„ä¸­é—´æ•°ç»„ä¼šå ç”¨å¤§é‡å†…å­˜ï¼Œè€Œ Iterator Helpers å‡ ä¹ä¸å ç”¨é¢å¤–å†…å­˜</li>
</ul>
<p>æˆ‘ä¸ªäººçš„ä½¿ç”¨å»ºè®®æ˜¯ï¼š</p>
<ol>
<li><strong>é»˜è®¤è¿˜æ˜¯ç”¨æ•°ç»„æ–¹æ³•</strong>ï¼Œç®€å•ç›´æ¥ï¼Œä¸å®¹æ˜“å‡ºé”™</li>
<li><strong>é‡åˆ°æ€§èƒ½ç“¶é¢ˆæ—¶</strong>ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯"åªéœ€è¦éƒ¨åˆ†æ•°æ®å´å¤„ç†äº†å…¨éƒ¨"ï¼Œå¦‚æœæ˜¯ï¼Œè¯•è¯• Iterator Helpers</li>
<li><strong>å†™æ•°æ®ç®¡é“æ—¶</strong>ï¼Œå¦‚æœé“¾è·¯å¾ˆé•¿ï¼Œç”¨ Iterator Helpers èƒ½è®©ä»£ç æ›´æ¸…æ™°ï¼Œä¹Ÿèƒ½é¿å…ä¸å¿…è¦çš„å†…å­˜åˆ†é…</li>
<li><strong>å†…å­˜æ•æ„Ÿåœºæ™¯</strong>ï¼Œæ¯”å¦‚å¤„ç†å¤§æ•°æ®é›†ã€ç§»åŠ¨ç«¯åº”ç”¨ç­‰ï¼ŒIterator Helpers èƒ½æ˜¾è‘—é™ä½å†…å­˜å‹åŠ›</li>
</ol>
<h3 data-id="heading-22">å®Œæ•´æµ‹è¯•ä»£ç </h3>
<p>ä¸‹é¢æ˜¯å®Œæ•´çš„æ€§èƒ½æµ‹è¯•ä»£ç ï¼ŒåŒ…å«<strong>æ—¶é—´</strong>å’Œ<strong>ç©ºé—´</strong>ä¸¤ä¸ªç»´åº¦çš„æµ‹è¯•ã€‚ä½ å¯ä»¥å¤åˆ¶åˆ°æœ¬åœ°è·‘ä¸€ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * Iterator Helpers vs Array Methods æ€§èƒ½å¯¹æ¯”æµ‹è¯•
 * 
 * æµ‹è¯•ç»´åº¦ï¼š
 * 1. æ—¶é—´å¼€é”€ï¼ˆæ‰§è¡Œæ—¶é—´ï¼‰
 * 2. ç©ºé—´å¼€é”€ï¼ˆå†…å­˜ä½¿ç”¨ï¼‰
 * 
 * æµ‹è¯•åœºæ™¯ï¼š
 * 1. å¤§æ•°æ®é›†è¿‡æ»¤ + è½¬æ¢ + å–å‰ N é¡¹
 * 2. åµŒå¥—æ•°æ®æ‰å¹³åŒ–
 * 3. æŸ¥æ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹
 * 4. å¤æ‚é“¾å¼è°ƒç”¨
 */</span>

<span class="hljs-comment">// ============ å·¥å…·å‡½æ•° ============</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">generateLargeDataset</span>(<span class="hljs-params">size</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: size }, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> ({
    <span class="hljs-attr">id</span>: i,
    <span class="hljs-attr">value</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">1000</span>,
    <span class="hljs-attr">category</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'D'</span>][i % <span class="hljs-number">4</span>],
    <span class="hljs-attr">active</span>: i % <span class="hljs-number">3</span> === <span class="hljs-number">0</span>
  }));
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">benchmark</span>(<span class="hljs-params">name, fn, iterations = <span class="hljs-number">1</span></span>) {
  <span class="hljs-keyword">const</span> times = [];
  
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; iterations; i++) {
    <span class="hljs-keyword">const</span> start = performance.<span class="hljs-title function_">now</span>();
    <span class="hljs-title function_">fn</span>();
    <span class="hljs-keyword">const</span> end = performance.<span class="hljs-title function_">now</span>();
    times.<span class="hljs-title function_">push</span>(end - start);
  }
  
  <span class="hljs-keyword">const</span> avg = times.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a + b, <span class="hljs-number">0</span>) / times.<span class="hljs-property">length</span>;
  <span class="hljs-keyword">const</span> min = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(...times);
  <span class="hljs-keyword">const</span> max = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(...times);
  
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`\n<span class="hljs-subst">${name}</span>:`</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`  å¹³å‡: <span class="hljs-subst">${avg.toFixed(<span class="hljs-number">3</span>)}</span>ms`</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`  æœ€å°: <span class="hljs-subst">${min.toFixed(<span class="hljs-number">3</span>)}</span>ms`</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`  æœ€å¤§: <span class="hljs-subst">${max.toFixed(<span class="hljs-number">3</span>)}</span>ms`</span>);
  
  <span class="hljs-keyword">return</span> avg;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">memoryBenchmark</span>(<span class="hljs-params">name, fn</span>) {
  <span class="hljs-comment">// å¼ºåˆ¶åƒåœ¾å›æ”¶ï¼ˆéœ€è¦ Node.js å¯åŠ¨æ—¶åŠ  --expose-gc å‚æ•°ï¼‰</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">global</span>.<span class="hljs-property">gc</span>) {
    <span class="hljs-variable language_">global</span>.<span class="hljs-title function_">gc</span>();
  }
  
  <span class="hljs-keyword">const</span> memBefore = process.<span class="hljs-title function_">memoryUsage</span>();
  <span class="hljs-title function_">fn</span>();
  <span class="hljs-keyword">const</span> memAfter = process.<span class="hljs-title function_">memoryUsage</span>();
  
  <span class="hljs-keyword">const</span> heapUsedDiff = (memAfter.<span class="hljs-property">heapUsed</span> - memBefore.<span class="hljs-property">heapUsed</span>) / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>;
  
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`  å†…å­˜å¢é•¿: <span class="hljs-subst">${heapUsedDiff.toFixed(<span class="hljs-number">2</span>)}</span> MB`</span>);
  
  <span class="hljs-keyword">return</span> heapUsedDiff;
}

<span class="hljs-comment">// ============ æµ‹è¯•åœºæ™¯ 1: è¿‡æ»¤ + è½¬æ¢ + å–å‰ N é¡¹ ============</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'='</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">60</span>));
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•åœºæ™¯ 1: å¤§æ•°æ®é›†è¿‡æ»¤ + è½¬æ¢ + å–å‰ 10 é¡¹'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•°æ®è§„æ¨¡: 100,000 æ¡'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'='</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">60</span>));

<span class="hljs-keyword">const</span> dataset1 = <span class="hljs-title function_">generateLargeDataset</span>(<span class="hljs-number">100000</span>);

<span class="hljs-comment">// ä¼ ç»Ÿæ•°ç»„æ–¹æ³• - æ—¶é—´</span>
<span class="hljs-keyword">const</span> arrayMethodTime1 = <span class="hljs-title function_">benchmark</span>(<span class="hljs-string">'ä¼ ç»Ÿæ•°ç»„æ–¹æ³• (filter + map + slice) - æ—¶é—´'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> result = dataset1
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">active</span>)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ <span class="hljs-attr">id</span>: item.<span class="hljs-property">id</span>, <span class="hljs-attr">doubled</span>: item.<span class="hljs-property">value</span> * <span class="hljs-number">2</span> }))
    .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>);
  
  <span class="hljs-keyword">return</span> result;
}, <span class="hljs-number">10</span>);

<span class="hljs-comment">// ä¼ ç»Ÿæ•°ç»„æ–¹æ³• - å†…å­˜</span>
<span class="hljs-keyword">const</span> arrayMethodMem1 = <span class="hljs-title function_">memoryBenchmark</span>(<span class="hljs-string">'ä¼ ç»Ÿæ•°ç»„æ–¹æ³• (filter + map + slice) - å†…å­˜'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> result = dataset1
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">active</span>)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ <span class="hljs-attr">id</span>: item.<span class="hljs-property">id</span>, <span class="hljs-attr">doubled</span>: item.<span class="hljs-property">value</span> * <span class="hljs-number">2</span> }))
    .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>);
  
  <span class="hljs-keyword">return</span> result;
});

<span class="hljs-comment">// Iterator Helpers - æ—¶é—´</span>
<span class="hljs-keyword">const</span> iteratorHelpersTime1 = <span class="hljs-title function_">benchmark</span>(<span class="hljs-string">'Iterator Helpers (filter + map + take) - æ—¶é—´'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> result = dataset1
    .<span class="hljs-title function_">values</span>()
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">active</span>)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ <span class="hljs-attr">id</span>: item.<span class="hljs-property">id</span>, <span class="hljs-attr">doubled</span>: item.<span class="hljs-property">value</span> * <span class="hljs-number">2</span> }))
    .<span class="hljs-title function_">take</span>(<span class="hljs-number">10</span>)
    .<span class="hljs-title function_">toArray</span>();
  
  <span class="hljs-keyword">return</span> result;
}, <span class="hljs-number">10</span>);

<span class="hljs-comment">// Iterator Helpers - å†…å­˜</span>
<span class="hljs-keyword">const</span> iteratorHelpersMem1 = <span class="hljs-title function_">memoryBenchmark</span>(<span class="hljs-string">'Iterator Helpers (filter + map + take) - å†…å­˜'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> result = dataset1
    .<span class="hljs-title function_">values</span>()
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">active</span>)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ <span class="hljs-attr">id</span>: item.<span class="hljs-property">id</span>, <span class="hljs-attr">doubled</span>: item.<span class="hljs-property">value</span> * <span class="hljs-number">2</span> }))
    .<span class="hljs-title function_">take</span>(<span class="hljs-number">10</span>)
    .<span class="hljs-title function_">toArray</span>();
  
  <span class="hljs-keyword">return</span> result;
});

<span class="hljs-keyword">const</span> timeImprovement1 = ((arrayMethodTime1 - iteratorHelpersTime1) / arrayMethodTime1 * <span class="hljs-number">100</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>);
<span class="hljs-keyword">const</span> memImprovement1 = ((arrayMethodMem1 - iteratorHelpersMem1) / arrayMethodMem1 * <span class="hljs-number">100</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`\næ€§èƒ½æå‡: æ—¶é—´ <span class="hljs-subst">${timeImprovement1}</span>%, å†…å­˜ <span class="hljs-subst">${memImprovement1}</span>%`</span>);

<span class="hljs-comment">// ============ æµ‹è¯•åœºæ™¯ 2: åµŒå¥—æ•°æ®æ‰å¹³åŒ– ============</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\n'</span> + <span class="hljs-string">'='</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">60</span>));
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•åœºæ™¯ 2: åµŒå¥—æ•°æ®æ‰å¹³åŒ– + è¿‡æ»¤ + å–å‰ 20 é¡¹'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•°æ®è§„æ¨¡: 10,000 ä¸ªçˆ¶é¡¹ï¼Œæ¯ä¸ªåŒ…å« 10 ä¸ªå­é¡¹'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'='</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">60</span>));

<span class="hljs-keyword">const</span> dataset2 = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">10000</span> }, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> ({
  <span class="hljs-attr">id</span>: i,
  <span class="hljs-attr">children</span>: <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">10</span> }, <span class="hljs-function">(<span class="hljs-params">_, j</span>) =&gt;</span> ({
    <span class="hljs-attr">childId</span>: <span class="hljs-string">`<span class="hljs-subst">${i}</span>-<span class="hljs-subst">${j}</span>`</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">100</span>
  }))
}));

<span class="hljs-comment">// ä¼ ç»Ÿæ•°ç»„æ–¹æ³• - æ—¶é—´</span>
<span class="hljs-keyword">const</span> arrayMethodTime2 = <span class="hljs-title function_">benchmark</span>(<span class="hljs-string">'ä¼ ç»Ÿæ•°ç»„æ–¹æ³• (flatMap + filter + slice) - æ—¶é—´'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> result = dataset2
    .<span class="hljs-title function_">flatMap</span>(<span class="hljs-function"><span class="hljs-params">parent</span> =&gt;</span> parent.<span class="hljs-property">children</span>)
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> child.<span class="hljs-property">value</span> &gt; <span class="hljs-number">50</span>)
    .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">20</span>);
  
  <span class="hljs-keyword">return</span> result;
}, <span class="hljs-number">10</span>);

<span class="hljs-comment">// ä¼ ç»Ÿæ•°ç»„æ–¹æ³• - å†…å­˜</span>
<span class="hljs-keyword">const</span> arrayMethodMem2 = <span class="hljs-title function_">memoryBenchmark</span>(<span class="hljs-string">'ä¼ ç»Ÿæ•°ç»„æ–¹æ³• (flatMap + filter + slice) - å†…å­˜'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> result = dataset2
    .<span class="hljs-title function_">flatMap</span>(<span class="hljs-function"><span class="hljs-params">parent</span> =&gt;</span> parent.<span class="hljs-property">children</span>)
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> child.<span class="hljs-property">value</span> &gt; <span class="hljs-number">50</span>)
    .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">20</span>);
  
  <span class="hljs-keyword">return</span> result;
});

<span class="hljs-comment">// Iterator Helpers - æ—¶é—´</span>
<span class="hljs-keyword">const</span> iteratorHelpersTime2 = <span class="hljs-title function_">benchmark</span>(<span class="hljs-string">'Iterator Helpers (flatMap + filter + take) - æ—¶é—´'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> result = dataset2
    .<span class="hljs-title function_">values</span>()
    .<span class="hljs-title function_">flatMap</span>(<span class="hljs-function"><span class="hljs-params">parent</span> =&gt;</span> parent.<span class="hljs-property">children</span>)
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> child.<span class="hljs-property">value</span> &gt; <span class="hljs-number">50</span>)
    .<span class="hljs-title function_">take</span>(<span class="hljs-number">20</span>)
    .<span class="hljs-title function_">toArray</span>();
  
  <span class="hljs-keyword">return</span> result;
}, <span class="hljs-number">10</span>);

<span class="hljs-comment">// Iterator Helpers - å†…å­˜</span>
<span class="hljs-keyword">const</span> iteratorHelpersMem2 = <span class="hljs-title function_">memoryBenchmark</span>(<span class="hljs-string">'Iterator Helpers (flatMap + filter + take) - å†…å­˜'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> result = dataset2
    .<span class="hljs-title function_">values</span>()
    .<span class="hljs-title function_">flatMap</span>(<span class="hljs-function"><span class="hljs-params">parent</span> =&gt;</span> parent.<span class="hljs-property">children</span>)
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> child.<span class="hljs-property">value</span> &gt; <span class="hljs-number">50</span>)
    .<span class="hljs-title function_">take</span>(<span class="hljs-number">20</span>)
    .<span class="hljs-title function_">toArray</span>();
  
  <span class="hljs-keyword">return</span> result;
});

<span class="hljs-keyword">const</span> timeImprovement2 = ((arrayMethodTime2 - iteratorHelpersTime2) / arrayMethodTime2 * <span class="hljs-number">100</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>);
<span class="hljs-keyword">const</span> memImprovement2 = ((arrayMethodMem2 - iteratorHelpersMem2) / arrayMethodMem2 * <span class="hljs-number">100</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`\næ€§èƒ½æå‡: æ—¶é—´ <span class="hljs-subst">${timeImprovement2}</span>%, å†…å­˜ <span class="hljs-subst">${memImprovement2}</span>%`</span>);

<span class="hljs-comment">// ============ æµ‹è¯•åœºæ™¯ 3: æŸ¥æ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ ============</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\n'</span> + <span class="hljs-string">'='</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">60</span>));
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•åœºæ™¯ 3: æŸ¥æ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ï¼ˆåŒ¹é…é¡¹åœ¨æ•°æ®é›†ååŠéƒ¨åˆ†ï¼‰'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•°æ®è§„æ¨¡: 1,000,000 æ¡'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'='</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">60</span>));

<span class="hljs-keyword">const</span> dataset3 = <span class="hljs-title function_">generateLargeDataset</span>(<span class="hljs-number">1000000</span>);
<span class="hljs-keyword">const</span> targetId = <span class="hljs-number">800000</span>;

<span class="hljs-comment">// ä¼ ç»Ÿæ•°ç»„æ–¹æ³• - æ—¶é—´</span>
<span class="hljs-keyword">const</span> arrayMethodTime3 = <span class="hljs-title function_">benchmark</span>(<span class="hljs-string">'ä¼ ç»Ÿæ•°ç»„æ–¹æ³• (filter + [0]) - æ—¶é—´'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> result = dataset3
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === targetId)[<span class="hljs-number">0</span>];
  
  <span class="hljs-keyword">return</span> result;
}, <span class="hljs-number">10</span>);

<span class="hljs-comment">// ä¼ ç»Ÿæ•°ç»„æ–¹æ³• - å†…å­˜</span>
<span class="hljs-keyword">const</span> arrayMethodMem3 = <span class="hljs-title function_">memoryBenchmark</span>(<span class="hljs-string">'ä¼ ç»Ÿæ•°ç»„æ–¹æ³• (filter + [0]) - å†…å­˜'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> result = dataset3
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === targetId)[<span class="hljs-number">0</span>];
  
  <span class="hljs-keyword">return</span> result;
});

<span class="hljs-comment">// Iterator Helpers - æ—¶é—´</span>
<span class="hljs-keyword">const</span> iteratorHelpersTime3 = <span class="hljs-title function_">benchmark</span>(<span class="hljs-string">'Iterator Helpers (find) - æ—¶é—´'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> result = dataset3
    .<span class="hljs-title function_">values</span>()
    .<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === targetId);
  
  <span class="hljs-keyword">return</span> result;
}, <span class="hljs-number">10</span>);

<span class="hljs-comment">// Iterator Helpers - å†…å­˜</span>
<span class="hljs-keyword">const</span> iteratorHelpersMem3 = <span class="hljs-title function_">memoryBenchmark</span>(<span class="hljs-string">'Iterator Helpers (find) - å†…å­˜'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> result = dataset3
    .<span class="hljs-title function_">values</span>()
    .<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === targetId);
  
  <span class="hljs-keyword">return</span> result;
});

<span class="hljs-keyword">const</span> timeImprovement3 = ((arrayMethodTime3 - iteratorHelpersTime3) / arrayMethodTime3 * <span class="hljs-number">100</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>);
<span class="hljs-keyword">const</span> memImprovement3 = ((arrayMethodMem3 - iteratorHelpersMem3) / arrayMethodMem3 * <span class="hljs-number">100</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`\næ€§èƒ½æå‡: æ—¶é—´ <span class="hljs-subst">${timeImprovement3}</span>%, å†…å­˜ <span class="hljs-subst">${memImprovement3}</span>%`</span>);

<span class="hljs-comment">// ============ æµ‹è¯•åœºæ™¯ 4: å¤šæ¬¡é“¾å¼è°ƒç”¨ ============</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\n'</span> + <span class="hljs-string">'='</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">60</span>));
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµ‹è¯•åœºæ™¯ 4: å¤æ‚é“¾å¼è°ƒç”¨ï¼ˆfilter + map + filter + map + takeï¼‰'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•°æ®è§„æ¨¡: 50,000 æ¡'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'='</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">60</span>));

<span class="hljs-keyword">const</span> dataset4 = <span class="hljs-title function_">generateLargeDataset</span>(<span class="hljs-number">50000</span>);

<span class="hljs-comment">// ä¼ ç»Ÿæ•°ç»„æ–¹æ³• - æ—¶é—´</span>
<span class="hljs-keyword">const</span> arrayMethodTime4 = <span class="hljs-title function_">benchmark</span>(<span class="hljs-string">'ä¼ ç»Ÿæ•°ç»„æ–¹æ³• (å¤šæ¬¡é“¾å¼è°ƒç”¨) - æ—¶é—´'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> result = dataset4
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">active</span>)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ ...item, <span class="hljs-attr">doubled</span>: item.<span class="hljs-property">value</span> * <span class="hljs-number">2</span> }))
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">doubled</span> &gt; <span class="hljs-number">500</span>)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ <span class="hljs-attr">id</span>: item.<span class="hljs-property">id</span>, <span class="hljs-attr">final</span>: item.<span class="hljs-property">doubled</span> + <span class="hljs-number">100</span> }))
    .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">15</span>);
  
  <span class="hljs-keyword">return</span> result;
}, <span class="hljs-number">10</span>);

<span class="hljs-comment">// ä¼ ç»Ÿæ•°ç»„æ–¹æ³• - å†…å­˜</span>
<span class="hljs-keyword">const</span> arrayMethodMem4 = <span class="hljs-title function_">memoryBenchmark</span>(<span class="hljs-string">'ä¼ ç»Ÿæ•°ç»„æ–¹æ³• (å¤šæ¬¡é“¾å¼è°ƒç”¨) - å†…å­˜'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> result = dataset4
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">active</span>)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ ...item, <span class="hljs-attr">doubled</span>: item.<span class="hljs-property">value</span> * <span class="hljs-number">2</span> }))
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">doubled</span> &gt; <span class="hljs-number">500</span>)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ <span class="hljs-attr">id</span>: item.<span class="hljs-property">id</span>, <span class="hljs-attr">final</span>: item.<span class="hljs-property">doubled</span> + <span class="hljs-number">100</span> }))
    .<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">15</span>);
  
  <span class="hljs-keyword">return</span> result;
});

<span class="hljs-comment">// Iterator Helpers - æ—¶é—´</span>
<span class="hljs-keyword">const</span> iteratorHelpersTime4 = <span class="hljs-title function_">benchmark</span>(<span class="hljs-string">'Iterator Helpers (å¤šæ¬¡é“¾å¼è°ƒç”¨) - æ—¶é—´'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> result = dataset4
    .<span class="hljs-title function_">values</span>()
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">active</span>)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ ...item, <span class="hljs-attr">doubled</span>: item.<span class="hljs-property">value</span> * <span class="hljs-number">2</span> }))
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">doubled</span> &gt; <span class="hljs-number">500</span>)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ <span class="hljs-attr">id</span>: item.<span class="hljs-property">id</span>, <span class="hljs-attr">final</span>: item.<span class="hljs-property">doubled</span> + <span class="hljs-number">100</span> }))
    .<span class="hljs-title function_">take</span>(<span class="hljs-number">15</span>)
    .<span class="hljs-title function_">toArray</span>();
  
  <span class="hljs-keyword">return</span> result;
}, <span class="hljs-number">10</span>);

<span class="hljs-comment">// Iterator Helpers - å†…å­˜</span>
<span class="hljs-keyword">const</span> iteratorHelpersMem4 = <span class="hljs-title function_">memoryBenchmark</span>(<span class="hljs-string">'Iterator Helpers (å¤šæ¬¡é“¾å¼è°ƒç”¨) - å†…å­˜'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> result = dataset4
    .<span class="hljs-title function_">values</span>()
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">active</span>)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ ...item, <span class="hljs-attr">doubled</span>: item.<span class="hljs-property">value</span> * <span class="hljs-number">2</span> }))
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">doubled</span> &gt; <span class="hljs-number">500</span>)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({ <span class="hljs-attr">id</span>: item.<span class="hljs-property">id</span>, <span class="hljs-attr">final</span>: item.<span class="hljs-property">doubled</span> + <span class="hljs-number">100</span> }))
    .<span class="hljs-title function_">take</span>(<span class="hljs-number">15</span>)
    .<span class="hljs-title function_">toArray</span>();
  
  <span class="hljs-keyword">return</span> result;
});

<span class="hljs-keyword">const</span> timeImprovement4 = ((arrayMethodTime4 - iteratorHelpersTime4) / arrayMethodTime4 * <span class="hljs-number">100</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>);
<span class="hljs-keyword">const</span> memImprovement4 = ((arrayMethodMem4 - iteratorHelpersMem4) / arrayMethodMem4 * <span class="hljs-number">100</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`\næ€§èƒ½æå‡: æ—¶é—´ <span class="hljs-subst">${timeImprovement4}</span>%, å†…å­˜ <span class="hljs-subst">${memImprovement4}</span>%`</span>);

<span class="hljs-comment">// ============ æ€»ç»“ ============</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\n'</span> + <span class="hljs-string">'='</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">60</span>));
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ€»ç»“'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'='</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">60</span>));
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`
åœºæ™¯ 1 (è¿‡æ»¤+è½¬æ¢+å–å‰Né¡¹):
  æ—¶é—´æå‡: <span class="hljs-subst">${timeImprovement1}</span>%
  å†…å­˜æå‡: <span class="hljs-subst">${memImprovement1}</span>%

åœºæ™¯ 2 (åµŒå¥—æ•°æ®æ‰å¹³åŒ–):
  æ—¶é—´æå‡: <span class="hljs-subst">${timeImprovement2}</span>%
  å†…å­˜æå‡: <span class="hljs-subst">${memImprovement2}</span>%

åœºæ™¯ 3 (æŸ¥æ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹):
  æ—¶é—´æå‡: <span class="hljs-subst">${timeImprovement3}</span>%
  å†…å­˜æå‡: <span class="hljs-subst">${memImprovement3}</span>%

åœºæ™¯ 4 (å¤æ‚é“¾å¼è°ƒç”¨):
  æ—¶é—´æå‡: <span class="hljs-subst">${timeImprovement4}</span>%
  å†…å­˜æå‡: <span class="hljs-subst">${memImprovement4}</span>%

ç»“è®º:
- Iterator Helpers åœ¨éœ€è¦"å–å‰ N é¡¹"çš„åœºæ™¯ä¸‹ä¼˜åŠ¿æ˜æ˜¾
- æ—¶é—´å’Œç©ºé—´å¼€é”€éƒ½èƒ½æ˜¾è‘—é™ä½
- æ•°æ®è§„æ¨¡è¶Šå¤§ï¼Œæå‡è¶Šæ˜¾è‘—
- æƒ°æ€§æ±‚å€¼é¿å…äº†ä¸å¿…è¦çš„ä¸­é—´æ•°ç»„åˆ›å»º
- åœ¨æŸ¥æ‰¾åœºæ™¯ä¸‹ï¼ŒIterator Helpers å¯ä»¥æå‰ç»ˆæ­¢ï¼Œé¿å…éå†æ•´ä¸ªæ•°ç»„
`</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'\næç¤º: è¿è¡Œæ—¶åŠ ä¸Š --expose-gc å‚æ•°å¯ä»¥è·å¾—æ›´å‡†ç¡®çš„å†…å­˜æµ‹è¯•ç»“æœ'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å‘½ä»¤: node --expose-gc iterator-helpers-benchmark.js'</span>);
</code></pre>
<h3 data-id="heading-23">å®é™…è¿è¡Œè¾“å‡º</h3>
<p>åœ¨æˆ‘çš„ç¯å¢ƒï¼ˆNode.js 22+ï¼‰ä¸‹ï¼Œä½¿ç”¨ <code>node --expose-gc iterator-helpers-benchmark.js</code> è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œå¾—åˆ°ä»¥ä¸‹ç»“æœï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">============================================================
æµ‹è¯•åœºæ™¯ 1: å¤§æ•°æ®é›†è¿‡æ»¤ + è½¬æ¢ + å–å‰ 10 é¡¹
<span class="hljs-section">æ•°æ®è§„æ¨¡: 100,000 æ¡
============================================================</span>

ä¼ ç»Ÿæ•°ç»„æ–¹æ³• (filter + map + slice) - æ—¶é—´:
  å¹³å‡: 1.545ms
  æœ€å°: 0.920ms
  æœ€å¤§: 2.993ms
  å†…å­˜å¢é•¿: 3.38 MB

Iterator Helpers (filter + map + take) - æ—¶é—´:
  å¹³å‡: 0.019ms
  æœ€å°: 0.003ms
  æœ€å¤§: 0.126ms
  å†…å­˜å¢é•¿: 0.01 MB

æ€§èƒ½æå‡: æ—¶é—´ 98.77%, å†…å­˜ 99.75%

============================================================
æµ‹è¯•åœºæ™¯ 2: åµŒå¥—æ•°æ®æ‰å¹³åŒ– + è¿‡æ»¤ + å–å‰ 20 é¡¹
<span class="hljs-section">æ•°æ®è§„æ¨¡: 10,000 ä¸ªçˆ¶é¡¹ï¼Œæ¯ä¸ªåŒ…å« 10 ä¸ªå­é¡¹
============================================================</span>

ä¼ ç»Ÿæ•°ç»„æ–¹æ³• (flatMap + filter + slice) - æ—¶é—´:
  å¹³å‡: 3.716ms
  æœ€å°: 2.263ms
  æœ€å¤§: 8.936ms
  å†…å­˜å¢é•¿: 4.03 MB

Iterator Helpers (flatMap + filter + take) - æ—¶é—´:
  å¹³å‡: 0.018ms
  æœ€å°: 0.004ms
  æœ€å¤§: 0.120ms
  å†…å­˜å¢é•¿: 0.01 MB

æ€§èƒ½æå‡: æ—¶é—´ 99.53%, å†…å­˜ 99.73%

============================================================
æµ‹è¯•åœºæ™¯ 3: æŸ¥æ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ï¼ˆåŒ¹é…é¡¹åœ¨æ•°æ®é›†ååŠéƒ¨åˆ†ï¼‰
<span class="hljs-section">æ•°æ®è§„æ¨¡: 1,000,000 æ¡
============================================================</span>

ä¼ ç»Ÿæ•°ç»„æ–¹æ³• (filter + [0]) - æ—¶é—´:
  å¹³å‡: 6.587ms
  æœ€å°: 5.605ms
  æœ€å¤§: 11.103ms
  å†…å­˜å¢é•¿: 0.01 MB

Iterator Helpers (find) - æ—¶é—´:
  å¹³å‡: 8.713ms
  æœ€å°: 7.893ms
  æœ€å¤§: 9.545ms
  å†…å­˜å¢é•¿: 14.80 MB

æ€§èƒ½æå‡: æ—¶é—´ -32.27%, å†…å­˜ -194800.20%

============================================================
æµ‹è¯•åœºæ™¯ 4: å¤æ‚é“¾å¼è°ƒç”¨ï¼ˆfilter + map + filter + map + takeï¼‰
<span class="hljs-section">æ•°æ®è§„æ¨¡: 50,000 æ¡
============================================================</span>

ä¼ ç»Ÿæ•°ç»„æ–¹æ³• (å¤šæ¬¡é“¾å¼è°ƒç”¨) - æ—¶é—´:
  å¹³å‡: 1.421ms
  æœ€å°: 0.840ms
  æœ€å¤§: 2.797ms
  å†…å­˜å¢é•¿: 5.33 MB

Iterator Helpers (å¤šæ¬¡é“¾å¼è°ƒç”¨) - æ—¶é—´:
  å¹³å‡: 0.028ms
  æœ€å°: 0.005ms
  æœ€å¤§: 0.220ms
  å†…å­˜å¢é•¿: 0.01 MB

æ€§èƒ½æå‡: æ—¶é—´ 98.02%, å†…å­˜ 99.75%

============================================================
<span class="hljs-section">æ€»ç»“
============================================================</span>

åœºæ™¯ 1 (è¿‡æ»¤+è½¬æ¢+å–å‰Né¡¹):
  æ—¶é—´æå‡: 98.77%
  å†…å­˜æå‡: 99.75%

åœºæ™¯ 2 (åµŒå¥—æ•°æ®æ‰å¹³åŒ–):
  æ—¶é—´æå‡: 99.53%
  å†…å­˜æå‡: 99.73%

åœºæ™¯ 3 (æŸ¥æ‰¾ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹):
  æ—¶é—´æå‡: -32.27%
  å†…å­˜æå‡: -194800.20%

åœºæ™¯ 4 (å¤æ‚é“¾å¼è°ƒç”¨):
  æ—¶é—´æå‡: 98.02%
  å†…å­˜æå‡: 99.75%

ç»“è®º:
<span class="hljs-bullet">-</span> Iterator Helpers åœ¨éœ€è¦"å–å‰ N é¡¹"çš„åœºæ™¯ä¸‹ä¼˜åŠ¿æ˜æ˜¾
<span class="hljs-bullet">-</span> æ—¶é—´å’Œç©ºé—´å¼€é”€éƒ½èƒ½æ˜¾è‘—é™ä½
<span class="hljs-bullet">-</span> æ•°æ®è§„æ¨¡è¶Šå¤§ï¼Œæå‡è¶Šæ˜¾è‘—
<span class="hljs-bullet">-</span> æƒ°æ€§æ±‚å€¼é¿å…äº†ä¸å¿…è¦çš„ä¸­é—´æ•°ç»„åˆ›å»º
<span class="hljs-bullet">-</span> åœ¨æŸ¥æ‰¾åœºæ™¯ä¸‹ï¼ŒIterator Helpers å¯ä»¥æå‰ç»ˆæ­¢ï¼Œé¿å…éå†æ•´ä¸ªæ•°ç»„

æç¤º: è¿è¡Œæ—¶åŠ ä¸Š --expose-gc å‚æ•°å¯ä»¥è·å¾—æ›´å‡†ç¡®çš„å†…å­˜æµ‹è¯•ç»“æœ
å‘½ä»¤: node --expose-gc iterator-helpers-benchmark.js
</code></pre>
<p>ä»è¾“å‡ºå¯ä»¥çœ‹åˆ°ï¼š</p>
<p><strong>åœºæ™¯ 1-2ã€4ï¼ˆ"å–å‰ N é¡¹"ç±»åœºæ™¯ï¼‰</strong>ï¼š</p>
<ul>
<li>æ—¶é—´æå‡ï¼š98%+</li>
<li>å†…å­˜æå‡ï¼š99%+</li>
<li>Iterator Helpers åœ¨æ—¶é—´å’Œç©ºé—´ä¸Šéƒ½æœ‰å‹å€’æ€§ä¼˜åŠ¿</li>
</ul>
<p><strong>åœºæ™¯ 3ï¼ˆæŸ¥æ‰¾åŒ¹é…é¡¹ï¼‰</strong>ï¼š</p>
<ul>
<li>æ—¶é—´ä¸‹é™ï¼š32%ï¼ˆIterator Helpers æ›´æ…¢ï¼‰</li>
<li>å†…å­˜å¼‚å¸¸ï¼šè¿™ä¸ªç»“æœçœ‹èµ·æ¥æœ‰é—®é¢˜ï¼Œå¯èƒ½æ˜¯ GC æ—¶æœºå¯¼è‡´çš„æµ‹é‡è¯¯å·®</li>
<li>è¿™ä¸ªåœºæ™¯ä¸é€‚åˆç”¨ Iterator Helpers</li>
</ul>
<p><strong>å…³é”®å‘ç°</strong>ï¼š</p>
<ol>
<li><strong>å†…å­˜ä¼˜åŠ¿æå…¶æ˜æ˜¾</strong>ï¼šåœ¨é€‚åˆçš„åœºæ™¯ä¸‹ï¼ŒIterator Helpers çš„å†…å­˜ä½¿ç”¨åªæœ‰ä¼ ç»Ÿæ–¹æ³•çš„ 0.3%</li>
<li><strong>ä¸­é—´æ•°ç»„æ˜¯å¤§å¤´</strong>ï¼šåœºæ™¯ 4 åˆ›å»ºäº† 4 ä¸ªä¸­é—´æ•°ç»„ï¼Œå ç”¨ 5.33 MBï¼›Iterator Helpers å‡ ä¹ä¸ºé›¶</li>
<li><strong>ä¸æ˜¯æ‰€æœ‰åœºæ™¯éƒ½é€‚ç”¨</strong>ï¼šåœºæ™¯ 3 è¯æ˜äº† Iterator Helpers ä¸æ˜¯é“¶å¼¹</li>
</ol>
<hr/>
<p>å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©ï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i" target="_blank" title="https://github.com/tt-a1i" ref="nofollow noopener noreferrer">GitHub</a>ï¼Œä¸‹é¢æ˜¯æˆ‘çš„ä¸€äº›å¼€æºé¡¹ç›®ï¼š</p>
<p><strong>Claude Code Skills</strong>ï¼ˆæŒ‰éœ€åŠ è½½ï¼Œæ„å›¾è‡ªåŠ¨è¯†åˆ«ï¼Œä¸æµªè´¹ tokenï¼Œ<a href="https://juejin.cn/post/7578714735307735066" target="_blank" title="https://juejin.cn/post/7578714735307735066">ä»‹ç»æ–‡ç« </a>ï¼‰ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fcode-review-skill" target="_blank" title="https://github.com/tt-a1i/code-review-skill" ref="nofollow noopener noreferrer">code-review-skill</a> - ä»£ç å®¡æŸ¥æŠ€èƒ½ï¼Œè¦†ç›– React 19ã€Vue 3ã€TypeScriptã€Rust ç­‰çº¦ 9000 è¡Œè§„åˆ™ï¼ˆ<a href="https://juejin.cn/post/7578709098255908902" target="_blank" title="https://juejin.cn/post/7578709098255908902">è¯¦ç»†ä»‹ç»</a>ï¼‰</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2F5-whys-skill" target="_blank" title="https://github.com/tt-a1i/5-whys-skill" ref="nofollow noopener noreferrer">5-whys-skill</a> - 5 Whys æ ¹å› åˆ†æï¼Œè¯´"æ‰¾æ ¹å› "è‡ªåŠ¨æ¿€æ´»</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Ffirst-principles-skill" target="_blank" title="https://github.com/tt-a1i/first-principles-skill" ref="nofollow noopener noreferrer">first-principles-skill</a> - ç¬¬ä¸€æ€§åŸç†æ€è€ƒï¼Œé€‚åˆæ¶æ„è®¾è®¡å’ŒæŠ€æœ¯é€‰å‹</li>
</ul>
<p><strong>qwen/gemini/claude - cli åŸç†å­¦ä¹ ç½‘ç«™</strong>ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fcoding-cli-guide" target="_blank" title="https://github.com/tt-a1i/coding-cli-guide" ref="nofollow noopener noreferrer">coding-cli-guide</a>ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Ftt-a1i.github.io%2Fcoding-cli-guide%2F%3Ftab%3Dstart-here" target="_blank" title="https://tt-a1i.github.io/coding-cli-guide/?tab=start-here" ref="nofollow noopener noreferrer">å­¦ä¹ ç½‘ç«™</a>ï¼‰- å­¦ä¹  qwen-cli æ—¶æ•´ç†çš„ç¬”è®°ï¼Œ40+ äº¤äº’å¼åŠ¨ç”»æ¼”ç¤º AI CLI å†…éƒ¨æœºåˆ¶</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/08e50020ab1f45428cd22e53af91a555~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lmf5peg6aOO6Zuo5Lmf6Zu-5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769428433&amp;x-signature=42pKbeP5eSeGsR4oemsuo9S4nh0%3D" alt="coding-cli-guide" loading="lazy"/></p>
<p><strong>å…¨æ ˆé¡¹ç›®</strong>ï¼ˆé€‚åˆå­¦ä¹ ç°ä»£æŠ€æœ¯æ ˆï¼‰ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fprompt-vault" target="_blank" title="https://github.com/tt-a1i/prompt-vault" ref="nofollow noopener noreferrer">prompt-vault</a> - Prompt ç®¡ç†å™¨ï¼Œç”¨çš„éƒ½æ˜¯æœ€æ–°çš„æŠ€æœ¯æ ˆï¼Œé€‚åˆç”¨æ¥å­¦ä¹ äº†è§£æœ€æ–°çš„å‰ç«¯å…¨æ ˆå¼€å‘èŒƒå¼ï¼šNext.js 15 + React 19 + tRPC 11 + Supabase å…¨æ ˆç¤ºä¾‹ï¼Œclone ä¸‹æ¥é…ä¸ªå…è´¹ Supabase å°±èƒ½è·‘</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fchat_edit" target="_blank" title="https://github.com/tt-a1i/chat_edit" ref="nofollow noopener noreferrer">chat_edit</a> - åŒæ¨¡å¼ AI åº”ç”¨ï¼ˆèŠå¤©+å¯Œæ–‡æœ¬ç¼–è¾‘ï¼‰ï¼ŒVue 3.5 + TypeScript + Vite 5 + Quill 2.0 + IndexedDB</li>
</ul>
<p><strong>VS Code æ’ä»¶</strong>ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftt-a1i%2Fvscode-ai-commit" target="_blank" title="https://github.com/tt-a1i/vscode-ai-commit" ref="nofollow noopener noreferrer">vscode-ai-commit</a> - ä¸€é”®ç”Ÿæˆ commit messageï¼Œæ”¯æŒ Conventional Commitsï¼Œå…¼å®¹ä»»ä½• OpenAI æ ¼å¼æ¥å£</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¸¦ä½ ç©è½¬ä¿„ç½—æ–¯ rustoreæ”¯ä»˜æ¥å…¥ æ¨ªç©ºå‡ºä¸–]]></title>    <link>https://juejin.cn/post/7596670644286767104</link>    <guid>https://juejin.cn/post/7596670644286767104</guid>    <pubDate>2026-01-19T09:52:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596670644286767104" data-draft-id="7596864700508766242" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¸¦ä½ ç©è½¬ä¿„ç½—æ–¯ rustoreæ”¯ä»˜æ¥å…¥ æ¨ªç©ºå‡ºä¸–"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-01-19T09:52:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="xq9527"/> <meta itemprop="url" content="https://juejin.cn/user/1239904848712184"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¸¦ä½ ç©è½¬ä¿„ç½—æ–¯ rustoreæ”¯ä»˜æ¥å…¥ æ¨ªç©ºå‡ºä¸–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1239904848712184/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    xq9527
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T09:52:54.000Z" title="Mon Jan 19 2026 09:52:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    18
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">RuStore æ”¯ä»˜æ¥å…¥å®æˆ˜æŒ‡å—</h2>
<h3 data-id="heading-1">å‰è¨€å¯¼è¯»</h3>
<p>å„ä½åŒå­¦å¤§å®¶å¥½ï¼Œæœ‰æ®µæ—¶é—´æ²¡æœ‰è§é¢äº†ã€‚åº”ä¸šåŠ¡éœ€æ±‚ï¼Œæœ€è¿‘æ•´ç†äº†ä¸€ä»½ <strong>RuStore</strong>ï¼ˆä¿„ç½—æ–¯åº”ç”¨å•†åº—ï¼‰æ”¯ä»˜æ¥å…¥çš„å®Œæ•´æ•™ç¨‹ã€‚æœ¬æ–‡å°†å¸¦å¤§å®¶ä¸€æ­¥æ­¥å®Œæˆæ”¯ä»˜åŠŸèƒ½çš„é›†æˆï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬æ­£å¼å¼€å§‹ï¼</p>
<h3 data-id="heading-2">å…·ä½“å®ç°</h3>
<h4 data-id="heading-3">0. æ”¯ä»˜æµç¨‹æ€»è§ˆ</h4>
<p>åœ¨å¼€å§‹ç¼–å†™ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡æµç¨‹å›¾æ¢³ç†ä¸€ä¸‹ RuStore æ”¯ä»˜çš„å®Œæ•´äº¤äº’é€»è¾‘ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    Start[å¼€å§‹] --&gt; Init[1. åˆå§‹åŒ– SDK]
    Init --&gt; Auth{2. æ£€æŸ¥ç”¨æˆ·æˆæƒ}
    Auth -- æœªæˆæƒ --&gt; Login[å¼•å¯¼ç”¨æˆ·ç™»å½•]
    Auth -- å·²æˆæƒ --&gt; CheckAvail{3. æ£€æŸ¥æ”¯ä»˜å¯ç”¨æ€§}
    CheckAvail -- ä¸å¯ç”¨ --&gt; Error[æç¤ºé”™è¯¯/ç»“æŸ]
    CheckAvail -- å¯ç”¨ --&gt; QueryProd[4. æŸ¥è¯¢å•†å“è¯¦æƒ…]
    QueryProd --&gt; CheckProd{å•†å“æœ‰æ•ˆ?}
    CheckProd -- æ— æ•ˆ --&gt; Error
    CheckProd -- æœ‰æ•ˆ --&gt; Pay[5. å‘èµ·æ”¯ä»˜ launchBillingFlow]
    Pay --&gt; PayResult{æ”¯ä»˜ç»“æœ}
    PayResult -- å¤±è´¥/å–æ¶ˆ --&gt; HandleFail[å¤„ç†å¤±è´¥]
    PayResult -- æˆåŠŸ --&gt; LocalRecord[6. æœ¬åœ°è®°å½•è®¢å•]
    LocalRecord --&gt; Consume[7. éªŒè¯å¹¶æ¶ˆè€—å•†å“ consumeAsync]
    Consume --&gt; ConsumeResult{æ¶ˆè€—æˆåŠŸ?}
    ConsumeResult -- æ˜¯ --&gt; Deliver[å‘æ”¾é“å…·/æœåŠ¡]
    ConsumeResult -- å¦ --&gt; Retry[ä¿ç•™çŠ¶æ€ç­‰å¾…è¡¥å•]
    Deliver --&gt; End[ç»“æŸ]
    
    subgraph è¡¥å•æµç¨‹
    Boot[å¯åŠ¨/æ£€æŸ¥] --&gt; QueryInv[8. æŸ¥è¯¢æœªæ¶ˆè€—è®¢å• queryInventoryAsync]
    QueryInv --&gt; HasInv{æœ‰æœªæ¶ˆè€—è®¢å•?}
    HasInv -- æ˜¯ --&gt; Consume
    HasInv -- å¦ --&gt; End
    end
</code></pre>
<h4 data-id="heading-4">1. æ·»åŠ ä¾èµ–</h4>
<p>åœ¨æ¨¡å—çº§çš„ <code>build.gradle.kts</code> (æˆ– <code>build.gradle</code>) æ–‡ä»¶ä¸­æ·»åŠ  RuStore SDK çš„ä¾èµ–ã€‚æ¨èä½¿ç”¨ BOM (Bill of Materials) æ¥ç®¡ç†ç‰ˆæœ¬ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin">dependencies {
    <span class="hljs-comment">// ä½¿ç”¨ BOM ç®¡ç†ç‰ˆæœ¬ï¼Œç¡®ä¿å„æ¨¡å—ç‰ˆæœ¬ä¸€è‡´</span>
    implementation(platform(<span class="hljs-string">"ru.rustore.sdk:bom:2025.08.01"</span>))
    implementation(<span class="hljs-string">"ru.rustore.sdk:pay"</span>)
}
</code></pre>
<h4 data-id="heading-5">2. é…ç½® AndroidManifest</h4>
<p>åœ¨ <code>AndroidManifest.xml</code> çš„ <code>&lt;application&gt;</code> æ ‡ç­¾å†…æ·»åŠ ä»¥ä¸‹é…ç½®ã€‚</p>
<p><strong>1. æ·»åŠ å…ƒæ•°æ® (Meta-data)</strong>
è¿™äº›å…ƒæ•°æ®ç”¨äºæ ‡è¯†åº”ç”¨ Scheme å’Œ RuStore æ§åˆ¶å°çš„åº”ç”¨ IDã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">application</span> <span class="hljs-attr">...</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æ›¿æ¢ä¸ºä½ çš„ App Scheme --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta-data</span> 
        <span class="hljs-attr">android:name</span>=<span class="hljs-string">"sdk_pay_scheme_value"</span> 
        <span class="hljs-attr">android:value</span>=<span class="hljs-string">"yourappscheme"</span> /&gt;</span> 
 
    <span class="hljs-comment">&lt;!-- æ›¿æ¢ä¸º RuStore æ§åˆ¶å°çš„åº”ç”¨ ID --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta-data</span> 
        <span class="hljs-attr">android:name</span>=<span class="hljs-string">"console_app_id_value"</span> 
        <span class="hljs-attr">android:value</span>=<span class="hljs-string">"xxxxxx"</span> /&gt;</span>
        
    <span class="hljs-comment">&lt;!-- ä¸‹é¢é…ç½® Activity --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">application</span>&gt;</span>
</code></pre>
<p><strong>2. é…ç½® Intent-Filter</strong>
åœ¨å¤„ç†æ”¯ä»˜å›è°ƒçš„ Activityï¼ˆé€šå¸¸æ˜¯å‘èµ·æ”¯ä»˜çš„ Activityï¼‰ä¸­é…ç½® <code>intent-filter</code>ï¼Œä»¥ä¾¿æ¥æ”¶æ”¯ä»˜ç»“æœçš„å›è°ƒã€‚è¯·ç¡®ä¿ <code>android:scheme</code> çš„å€¼ä¸ä¸Šé¢ meta-data ä¸­çš„ <code>sdk_pay_scheme_value</code> ä¿æŒä¸€è‡´ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">activity</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">".YourPaymentActivity"</span> <span class="hljs-attr">android:exported</span>=<span class="hljs-string">"true"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">intent-filter</span>&gt;</span> 
         <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.action.VIEW"</span> /&gt;</span> 
         <span class="hljs-tag">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.category.DEFAULT"</span> /&gt;</span> 
         <span class="hljs-tag">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.category.BROWSABLE"</span> /&gt;</span> 
         <span class="hljs-comment">&lt;!-- å¿…é¡»ä¸ sdk_pay_scheme_value ä¸€è‡´ --&gt;</span>
         <span class="hljs-tag">&lt;<span class="hljs-name">data</span> <span class="hljs-attr">android:scheme</span>=<span class="hljs-string">"yourappscheme"</span> /&gt;</span> 
     <span class="hljs-tag">&lt;/<span class="hljs-name">intent-filter</span>&gt;</span> 
<span class="hljs-tag">&lt;/<span class="hljs-name">activity</span>&gt;</span>
</code></pre>
<h4 data-id="heading-6">3. åˆå§‹åŒ– SDK ä¸ç”Ÿå‘½å‘¨æœŸå¤„ç†</h4>
<p>åœ¨ Activity æˆ– Application ä¸­åˆå§‹åŒ– <code>RuStorePayClient</code>ï¼Œå¹¶å¤„ç†ç”Ÿå‘½å‘¨æœŸå›è°ƒï¼ˆç”¨äºæ¥æ”¶æ”¯ä»˜ç»“æœï¼‰ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> RuStorePayClient ruStorePayClient;
<span class="hljs-keyword">private</span> IntentInteractor intentInteractor;
<span class="hljs-keyword">private</span> Activity mActivity;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(Activity activity)</span> {
    <span class="hljs-built_in">this</span>.mActivity = activity;
    <span class="hljs-comment">// è·å– RuStorePayClient å®ä¾‹</span>
    ruStorePayClient = RuStorePayClient.Companion.getInstance();
    
    <span class="hljs-comment">// åˆå§‹åŒ–åå»ºè®®è¿›è¡Œä¸€äº›é¢„æ£€æŸ¥</span>
    checkUserAuthorization();
}

<span class="hljs-comment">/**
 * åœ¨ Activity çš„ onCreate ä¸­è°ƒç”¨
 * <span class="hljs-doctag">@param</span> activity
 * <span class="hljs-doctag">@param</span> savedInstanceState
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Activity activity, Bundle savedInstanceState)</span> {
    <span class="hljs-comment">// å¿…é¡»è°ƒç”¨ super</span>
    <span class="hljs-built_in">super</span>.onCreate(activity, savedInstanceState);
    <span class="hljs-keyword">if</span> (savedInstanceState == <span class="hljs-literal">null</span>) {
        intentInteractor = RuStorePayClient.Companion.getInstance().getIntentInteractor();
        intentInteractor.proceedIntent(activity.getIntent());
    }
}

<span class="hljs-comment">/**
 * åœ¨ Activity çš„ onNewIntent ä¸­è°ƒç”¨
 * <span class="hljs-doctag">@param</span> intent
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onNewIntent</span><span class="hljs-params">(Intent intent)</span> {
    <span class="hljs-comment">// å¿…é¡»è°ƒç”¨ super</span>
    <span class="hljs-built_in">super</span>.onNewIntent(intent);
    <span class="hljs-keyword">if</span> (intentInteractor != <span class="hljs-literal">null</span>) {
        intentInteractor.proceedIntent(intent);
    }
}
</code></pre>
<h4 data-id="heading-7">4. æ£€æŸ¥ç”¨æˆ·æˆæƒçŠ¶æ€</h4>
<p>åœ¨å‘èµ·æ”¯ä»˜å‰ï¼Œæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½• RuStore è´¦å·ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">checkUserAuthorization</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (ruStorePayClient == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;

    ruStorePayClient.getUserInteractor().getUserAuthorizationStatus()
            .addOnSuccessListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OnSuccessListener</span>&lt;UserAuthorizationStatus&gt;() {
                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onSuccess</span><span class="hljs-params">(UserAuthorizationStatus status)</span> {
                    <span class="hljs-keyword">switch</span> (status) {
                        <span class="hljs-keyword">case</span> AUTHORIZED:
                            Log.d(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"ç”¨æˆ·å·²æˆæƒ"</span>);
                            <span class="hljs-keyword">break</span>;
                        <span class="hljs-keyword">case</span> UNAUTHORIZED:
                            Log.w(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"ç”¨æˆ·æœªæˆæƒï¼Œè¯·å¼•å¯¼ç”¨æˆ·ç™»å½•"</span>);
                            <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> å¤„ç†æœªæˆæƒé€»è¾‘ï¼Œä¾‹å¦‚æç¤ºç”¨æˆ·ç™»å½•</span>
                            <span class="hljs-keyword">break</span>;
                    }
                }
            })
            .addOnFailureListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OnFailureListener</span>() {
                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onFailure</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> Throwable throwable)</span> {
                    Log.e(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"æ£€æŸ¥æˆæƒå¤±è´¥: "</span> + throwable.getMessage());
                }
            });
}
</code></pre>
<h4 data-id="heading-8">5. æ£€æŸ¥æ”¯ä»˜æœåŠ¡å¯ç”¨æ€§</h4>
<p>ç¡®è®¤ç”¨æˆ·çš„è®¾å¤‡ç¯å¢ƒæ˜¯å¦æ”¯æŒæ”¯ä»˜åŠŸèƒ½ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">checkPurchaseAvailability</span><span class="hljs-params">(String userId, String productId, String cpOrderId)</span> {
    <span class="hljs-keyword">if</span> (ruStorePayClient == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;

    ruStorePayClient.getPurchaseInteractor().getPurchaseAvailability()
            .addOnSuccessListener(result -&gt; {
                <span class="hljs-keyword">if</span> (result <span class="hljs-keyword">instanceof</span> PurchaseAvailabilityResult.Available) {
                    <span class="hljs-comment">// æ”¯ä»˜æœåŠ¡å¯ç”¨ï¼Œç»§ç»­æŸ¥è¯¢å•†å“è¯¦æƒ…</span>
                    checkProductIdToPay(mActivity, userId, productId, cpOrderId);
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (result <span class="hljs-keyword">instanceof</span> PurchaseAvailabilityResult.Unavailable) {
                    <span class="hljs-comment">// æ”¯ä»˜æœåŠ¡ä¸å¯ç”¨</span>
                    PurchaseAvailabilityResult.<span class="hljs-type">Unavailable</span> <span class="hljs-variable">unavailable</span> <span class="hljs-operator">=</span> (PurchaseAvailabilityResult.Unavailable) result;
                    Log.e(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"æ”¯ä»˜ä¸å¯ç”¨: "</span> + unavailable.getCause().getMessage());
                    afterPaySDK(mActivity, <span class="hljs-literal">false</span>, <span class="hljs-number">1001</span>, <span class="hljs-string">"Payment Unavailable"</span>);
                }
            })
            .addOnFailureListener(throwable -&gt; {
                Log.e(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"æ£€æŸ¥æ”¯ä»˜å¯ç”¨æ€§å‡ºé”™"</span>, throwable);
                afterPaySDK(mActivity, <span class="hljs-literal">false</span>, <span class="hljs-number">1001</span>, <span class="hljs-string">"Check Availability Failed"</span>);
            });
}
</code></pre>
<h4 data-id="heading-9">6. æŸ¥è¯¢å•†å“è¯¦æƒ…</h4>
<p>åœ¨å‘èµ·æ”¯ä»˜å‰ï¼ŒéªŒè¯å•†å“ ID æ˜¯å¦æœ‰æ•ˆï¼Œå¹¶è·å–å•†å“ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">checkProductIdToPay</span><span class="hljs-params">(Activity activity, <span class="hljs-keyword">final</span> String userId,
                                <span class="hljs-keyword">final</span> String productIdStr, <span class="hljs-keyword">final</span> String cpOrderId)</span> {
    List&lt;ProductId&gt; productIds = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-keyword">try</span> {
        productIds.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ProductId</span>(productIdStr));
        ruStorePayClient.getProductInteractor().getProducts(productIds)
                .addOnSuccessListener(products -&gt; {
                    <span class="hljs-keyword">if</span> (products == <span class="hljs-literal">null</span> || products.isEmpty()) {
                        Log.e(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"æœªæŸ¥è¯¢åˆ°å•†å“ä¿¡æ¯: "</span> + productIdStr);
                        <span class="hljs-keyword">return</span>;
                    }
                    
                    <span class="hljs-keyword">for</span> (Product product : products) {
                        Log.d(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"æŸ¥è¯¢åˆ°å•†å“: "</span> + product.getProductId().getValue());
                        <span class="hljs-keyword">if</span> (productIdStr.equals(product.getProductId().getValue())) {
                            <span class="hljs-comment">// å•†å“æœ‰æ•ˆï¼Œå‘èµ·æ”¯ä»˜</span>
                            launchBillingFlow(activity, userId, productIdStr, cpOrderId);
                        }
                    }
                })
                .addOnFailureListener(throwable -&gt; {
                    Log.e(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"æŸ¥è¯¢å•†å“å¤±è´¥"</span>, throwable);
                });

    } <span class="hljs-keyword">catch</span> (Exception e) {
        Log.e(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"æŸ¥è¯¢å•†å“å¼‚å¸¸"</span>, e);
    }
}
</code></pre>
<h4 data-id="heading-10">7. è°ƒèµ·æ”¯ä»˜é¡µé¢</h4>
<p>æ„å»ºæ”¯ä»˜å‚æ•°å¹¶æ‹‰èµ· RuStore æ”¶é“¶å°ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * è°ƒèµ·æ”¯ä»˜
 * <span class="hljs-doctag">@param</span> activity ä¸Šä¸‹æ–‡
 * <span class="hljs-doctag">@param</span> userId ç”¨æˆ·ID
 * <span class="hljs-doctag">@param</span> productIdStr å•†å“ID
 * <span class="hljs-doctag">@param</span> cpOrderId è®¢å•å·
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">launchBillingFlow</span><span class="hljs-params">(Activity activity, <span class="hljs-keyword">final</span> String userId,
                              <span class="hljs-keyword">final</span> String productIdStr, <span class="hljs-keyword">final</span> String cpOrderId)</span> {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// æ„å»ºæ”¯ä»˜å‚æ•°</span>
        <span class="hljs-comment">// ProductId: å•†å“ID</span>
        <span class="hljs-comment">// Quantity: æ•°é‡ (é»˜è®¤1)</span>
        <span class="hljs-comment">// OrderId: è®¢å•å· (UUID)</span>
        <span class="hljs-comment">// DeveloperPayload: é€ä¼ å‚æ•°</span>
        <span class="hljs-comment">// AppUserId: åº”ç”¨ç”¨æˆ·ID</span>
        <span class="hljs-type">ProductPurchaseParams</span> <span class="hljs-variable">params</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProductPurchaseParams</span>(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProductId</span>(productIdStr),
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">Quantity</span>(<span class="hljs-number">1</span>),
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderId</span>(cpOrderId),
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">DeveloperPayload</span>(cpOrderId),
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">AppUserId</span>(userId),
                <span class="hljs-literal">null</span>
        );

        ruStorePayClient.getPurchaseInteractor().purchase(params, PreferredPurchaseType.ONE_STEP)
                .addOnSuccessListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OnSuccessListener</span>&lt;ProductPurchaseResult&gt;() {
                    <span class="hljs-meta">@Override</span>
                    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onSuccess</span><span class="hljs-params">(ProductPurchaseResult paymentResult)</span> {
                        handlePaymentSuccess(paymentResult, cpOrderId);
                    }
                })
                .addOnFailureListener(throwable -&gt; {
                    Log.e(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"æ”¯ä»˜å¤±è´¥"</span>, throwable);
                    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> å¤„ç†æ”¯ä»˜å¤±è´¥é€»è¾‘</span>
                })
                .addOnCompletionListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OnCompletionListener</span>() {
                     <span class="hljs-meta">@Override</span>
                     <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onComplete</span><span class="hljs-params">(Throwable throwable)</span> {
                         <span class="hljs-comment">// æ”¯ä»˜å¤±è´¥æˆ–å–æ¶ˆç­‰å®ŒæˆçŠ¶æ€</span>
                         Log.v(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"addOnCompletionListener"</span>);
                     }
                 });
    } <span class="hljs-keyword">catch</span> (Exception e) {
        Log.e(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"è°ƒèµ·æ”¯ä»˜å¼‚å¸¸"</span>, e);
    }
}

<span class="hljs-comment">// å¤„ç†æ”¯ä»˜æˆåŠŸå›è°ƒ</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handlePaymentSuccess</span><span class="hljs-params">(ProductPurchaseResult paymentResult, String cpOrderId)</span> {
    <span class="hljs-keyword">if</span> (paymentResult <span class="hljs-keyword">instanceof</span> ProductPurchaseResult.Success) {
         <span class="hljs-comment">// æ³¨æ„ï¼šæ–°ç‰ˆ SDK å¯èƒ½è¿”å›ä¸åŒçš„ Result ç±»å‹ï¼Œè¯·æ ¹æ®å®é™… SDK ç‰ˆæœ¬è°ƒæ•´</span>
         ProductPurchaseResult.<span class="hljs-type">Success</span> <span class="hljs-variable">successResult</span> <span class="hljs-operator">=</span> (ProductPurchaseResult.Success) paymentResult;
         <span class="hljs-comment">// å¦‚æœéœ€è¦ä» Success å¯¹è±¡ä¸­è·å–æ›´å¤šç‰¹å®šä¿¡æ¯</span>
    }
    
    <span class="hljs-comment">// è·å–æ”¯ä»˜è¯¦æƒ…</span>
    <span class="hljs-type">PurchaseId</span> <span class="hljs-variable">purchaseId</span> <span class="hljs-operator">=</span> paymentResult.getPurchaseId(); <span class="hljs-comment">// è´­ä¹°æ ‡è¯†ç¬¦ã€‚</span>
    <span class="hljs-type">ProductId</span> <span class="hljs-variable">productId</span> <span class="hljs-operator">=</span> paymentResult.getProductId();    <span class="hljs-comment">// è´­ä¹°äº§å“çš„æ ‡è¯†ç¬¦ã€‚</span>
    <span class="hljs-type">InvoiceId</span> <span class="hljs-variable">invoiceId</span> <span class="hljs-operator">=</span> paymentResult.getInvoiceId();    <span class="hljs-comment">// å‘ç¥¨æ ‡è¯†ç¬¦ã€‚</span>
    <span class="hljs-type">OrderId</span> <span class="hljs-variable">orderId</span> <span class="hljs-operator">=</span> paymentResult.getOrderId();          <span class="hljs-comment">// å”¯ä¸€çš„ä»˜æ¬¾æ ‡è¯†ç¬¦ã€‚</span>
    <span class="hljs-type">PurchaseType</span> <span class="hljs-variable">purchaseType</span> <span class="hljs-operator">=</span> paymentResult.getPurchaseType(); <span class="hljs-comment">// è´­ä¹°ç±»å‹ã€‚</span>
    <span class="hljs-type">Quantity</span> <span class="hljs-variable">quantity</span> <span class="hljs-operator">=</span> paymentResult.getQuantity();       <span class="hljs-comment">// äº§å“æ•°é‡ã€‚</span>
    <span class="hljs-type">boolean</span> <span class="hljs-variable">sandbox</span> <span class="hljs-operator">=</span> paymentResult.getSandbox();          <span class="hljs-comment">// æ²™ç›’æ ‡å¿—ã€‚</span>
    
    Log.v(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"æ”¯ä»˜æˆåŠŸ - invoiceId:"</span> + invoiceId);
    Log.v(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"æ”¯ä»˜æˆåŠŸ - productId:"</span> + productId);
    Log.v(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"æ”¯ä»˜æˆåŠŸ - orderId:"</span> + orderId);
    Log.v(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"æ”¯ä»˜æˆåŠŸ - sandbox:"</span> + sandbox);
    Log.v(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"æ”¯ä»˜æˆåŠŸ - purchaseId:"</span> + purchaseId);
    
    <span class="hljs-comment">// 1. æœ¬åœ°æ•°æ®ä¸ŠæŠ¥/è®°å½• (æ¨¡æ‹Ÿä¸šåŠ¡é€»è¾‘)</span>
    <span class="hljs-comment">// insertOrUpdateSssDataByOriginalJson(...);</span>

    <span class="hljs-comment">// 2. éªŒè¯ç¥¨æ®å¹¶æ¶ˆè€—å•†å“ (å…³é”®æ­¥éª¤)</span>
    consumeAsync(mActivity, orderId.getValue(), purchaseId.getValue(), 
                 productId.getValue(), invoiceId.getValue(), sandbox, cpOrderId);
}
</code></pre>
<h4 data-id="heading-11">8. ç¡®è®¤äº¤æ˜“ / æ¶ˆè€—å•†å“ (Consume)</h4>
<p>RuStore æ”¯ä»˜é€šå¸¸é‡‡ç”¨â€œä¸¤æ­¥æ”¯ä»˜â€æ¨¡å¼æˆ–éœ€è¦â€œæ¶ˆè€—â€å•†å“ã€‚å¯¹äºæ¶ˆè€—å‹å•†å“ï¼ˆå¦‚æ¸¸æˆå¸ï¼‰ï¼Œæ”¯ä»˜æˆåŠŸåå¿…é¡»è°ƒç”¨ç¡®è®¤/æ¶ˆè€—æ¥å£ï¼Œå¦åˆ™æ— æ³•å†æ¬¡è´­ä¹°ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æ¶ˆè€—/ç¡®è®¤è®¢å•
 * <span class="hljs-doctag">@param</span> activity ä¸Šä¸‹æ–‡
 * <span class="hljs-doctag">@param</span> orderId è®¢å•ID
 * <span class="hljs-doctag">@param</span> purchaseId è´­ä¹°ID
 * <span class="hljs-doctag">@param</span> productId å•†å“ID
 * <span class="hljs-doctag">@param</span> invoiceId å‘ç¥¨ID
 * <span class="hljs-doctag">@param</span> isSandbox æ˜¯å¦æ²™ç›’
 * <span class="hljs-doctag">@param</span> cpOrderId å¼€å‘è€…è®¢å•å·
 */</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">consumeAsync</span><span class="hljs-params">(Activity activity, String orderId, String purchaseId, 
                          String productId, String invoiceId, <span class="hljs-type">boolean</span> isSandbox, String cpOrderId)</span> {
    <span class="hljs-keyword">try</span> {
        Log.d(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"å¼€å§‹æ¶ˆè€—è®¢å•: "</span> + purchaseId);
        
        <span class="hljs-keyword">if</span> (ruStorePayClient != <span class="hljs-literal">null</span>) {
            ruStorePayClient.getPurchaseInteractor().confirmTwoStepPurchase(
                    <span class="hljs-keyword">new</span> <span class="hljs-title class_">PurchaseId</span>(purchaseId),
                    <span class="hljs-keyword">new</span> <span class="hljs-title class_">DeveloperPayload</span>(cpOrderId)
            ).addOnSuccessListener(unit -&gt; {
                Log.d(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"è®¢å•æ¶ˆè€—/ç¡®è®¤æˆåŠŸ: "</span> + purchaseId);
                <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> 1. å‘æ”¾é“å…·ç»™ç”¨æˆ·</span>
                <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> 2. é€šçŸ¥æœåŠ¡ç«¯è®¢å•å®Œæˆ</span>
            }).addOnFailureListener(throwable -&gt; {
                Log.e(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"è®¢å•æ¶ˆè€—/ç¡®è®¤å¤±è´¥: "</span> + throwable.getMessage());
                <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> å¤„ç†æ¶ˆè€—å¤±è´¥ï¼Œå¯èƒ½éœ€è¦é‡è¯•æˆ–è®°å½•æ—¥å¿—</span>
            });
        }
    } <span class="hljs-keyword">catch</span> (Throwable throwable) {
        Log.e(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"consumeAsync å¼‚å¸¸"</span>, throwable);
    }
}
</code></pre>
<h4 data-id="heading-12">9. è¡¥å•æœºåˆ¶ï¼šæŸ¥è¯¢æœªæ¶ˆè€—è®¢å•</h4>
<p>åœ¨åº”ç”¨å¯åŠ¨æˆ–ç‰¹å®šæ—¶æœºï¼Œæ£€æŸ¥æ˜¯å¦æœ‰å·²æ”¯ä»˜ä½†æœªæ¶ˆè€—çš„è®¢å•ï¼ˆä¾‹å¦‚æ”¯ä»˜åç½‘ç»œæ–­å¼€å¯¼è‡´æœªå›è°ƒï¼‰ï¼Œå¹¶è¿›è¡Œè¡¥å•å¤„ç†ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æŸ¥è¯¢æ˜¯å¦å­˜åœ¨æœªæ¶ˆè€—å•†å“
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">queryInventoryAsync</span><span class="hljs-params">()</span> {
    Log.d(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"å¼€å§‹æŸ¥è¯¢æœªæ¶ˆè€—è®¢å•..."</span>);
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">if</span> (ruStorePayClient == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;

        <span class="hljs-comment">// æŸ¥è¯¢çŠ¶æ€ä¸º PAID (å·²æ”¯ä»˜) çš„ CONSUMABLE (æ¶ˆè€—å‹) å•†å“</span>
        ruStorePayClient.getPurchaseInteractor().getPurchases(ProductType.CONSUMABLE_PRODUCT, ProductPurchaseStatus.PAID)
                .addOnSuccessListener(purchases -&gt; {
                    <span class="hljs-keyword">if</span> (purchases != <span class="hljs-literal">null</span> &amp;&amp; !purchases.isEmpty()) {
                        Log.d(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"å‘ç°æœªæ¶ˆè€—è®¢å•æ•°: "</span> + purchases.size());
                        <span class="hljs-keyword">for</span> (Purchase purchase : purchases) {
                            <span class="hljs-comment">// å¤„ç†æ¯ä¸€ç¬”æ‰å•</span>
                            handleUnconsumedPurchase(purchase);
                        }
                    } <span class="hljs-keyword">else</span> {
                        Log.d(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"æ— æœªæ¶ˆè€—è®¢å•"</span>);
                    }
                })
                .addOnFailureListener(error -&gt; {
                    Log.e(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"æŸ¥è¯¢æœªæ¶ˆè€—è®¢å•å¤±è´¥"</span>, error);
                });
    } <span class="hljs-keyword">catch</span> (Exception e) {
        Log.e(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"queryInventoryAsync å¼‚å¸¸"</span>, e);
    }
}

<span class="hljs-comment">/**
 * å¤„ç†å•ç¬”æœªæ¶ˆè€—è®¢å•
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleUnconsumedPurchase</span><span class="hljs-params">(Purchase purchase)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">orderId</span> <span class="hljs-operator">=</span> purchase.getOrderId().getValue();
    <span class="hljs-type">String</span> <span class="hljs-variable">purchaseId</span> <span class="hljs-operator">=</span> purchase.getPurchaseId().getValue();
    <span class="hljs-type">String</span> <span class="hljs-variable">productId</span> <span class="hljs-operator">=</span> purchase.getProductId().getValue(); 
    <span class="hljs-type">String</span> <span class="hljs-variable">invoiceId</span> <span class="hljs-operator">=</span> purchase.getInvoiceId().getValue();
    <span class="hljs-type">boolean</span> <span class="hljs-variable">isSandbox</span> <span class="hljs-operator">=</span> purchase.getSandbox();
    
    Log.d(<span class="hljs-string">"RuStoreSdk"</span>, <span class="hljs-string">"å¤„ç†è¡¥å• OrderId: "</span> + orderId);

    <span class="hljs-comment">// é‡æ–°æ‰§è¡Œæ¶ˆè€—/éªŒè¯æµç¨‹</span>
    <span class="hljs-comment">// æ³¨æ„ï¼šè¿™é‡Œçš„æœ€åä¸€ä¸ªå‚æ•°ä¼  orderId ä½œä¸º cpOrderIdï¼Œå…·ä½“è§†ä¸šåŠ¡é€»è¾‘è€Œå®š</span>
    consumeAsync(mActivity, orderId, purchaseId, productId, invoiceId, isSandbox, orderId);
}
</code></pre>
<h3 data-id="heading-13">æ€»ç»“</h3>
<p>ä»¥ä¸Šå°±æ˜¯æ¥å…¥ RuStore æ”¯ä»˜çš„æ ¸å¿ƒæµç¨‹ã€‚å…³é”®ç‚¹åœ¨äºï¼š</p>
<ol>
<li><strong>åˆå§‹åŒ–</strong>ï¼šç¡®ä¿ SDK æ­£ç¡®åˆå§‹åŒ–ã€‚</li>
<li><strong>æ”¯ä»˜æµç¨‹</strong>ï¼šæŸ¥è¯¢ -&gt; æ”¯ä»˜ -&gt; æ¶ˆè€—ã€‚</li>
<li><strong>å¼‚å¸¸å¤„ç†</strong>ï¼šåŠ¡å¿…å®ç° <code>queryInventoryAsync</code> è¡¥å•æœºåˆ¶ï¼Œé˜²æ­¢ç”¨æˆ·æ”¯ä»˜åæœªå‘è´§ã€‚</li>
</ol>
<p>å¸Œæœ›è¿™ç¯‡æ•™ç¨‹èƒ½å¸®åŠ©å¤§å®¶å¿«é€Ÿæ¥å…¥ RuStore æ”¯ä»˜ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026 å¹´ PHP å‡½æ•°å¼ç¼–ç¨‹ ä¼˜åŠ¿ä¸å®é™…åº”ç”¨]]></title>    <link>https://juejin.cn/post/7595808703075303450</link>    <guid>https://juejin.cn/post/7595808703075303450</guid>    <pubDate>2026-01-18T00:25:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595808703075303450" data-draft-id="7595894884957863987" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026 å¹´ PHP å‡½æ•°å¼ç¼–ç¨‹ ä¼˜åŠ¿ä¸å®é™…åº”ç”¨"/> <meta itemprop="keywords" content="åç«¯,PHP"/> <meta itemprop="datePublished" content="2026-01-18T00:25:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026 å¹´ PHP å‡½æ•°å¼ç¼–ç¨‹ ä¼˜åŠ¿ä¸å®é™…åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T00:25:20.000Z" title="Sun Jan 18 2026 00:25:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">2026 å¹´ PHP å‡½æ•°å¼ç¼–ç¨‹ ä¼˜åŠ¿ä¸å®é™…åº”ç”¨</h2>
<p>å‡½æ•°å¼ç¼–ç¨‹ï¼ˆFPï¼‰å·²ç»å­˜åœ¨å‡ åå¹´äº†ï¼Œä½†è¿‘å¹´æ¥åœ¨å®é™…å¼€å‘ä¸­ç”¨å¾—è¶Šæ¥è¶Šå¤šã€‚è¿™ç¯‡æ–‡ç« æ•´ç†ä¸€ä¸‹ FP çš„æ ¸å¿ƒæ¦‚å¿µå’Œå®é™…åº”ç”¨åœºæ™¯ã€‚</p>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹</h3>
<p>åœ¨æ·±å…¥ä¼˜åŠ¿å’Œåº”ç”¨ä¹‹å‰ï¼Œå…ˆå¿«é€Ÿå›é¡¾ä¸€ä¸‹å‡½æ•°å¼ç¼–ç¨‹æ˜¯ä»€ä¹ˆã€‚</p>
<p>å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒæ˜¯æŠŠè®¡ç®—å½“ä½œæ•°å­¦å‡½æ•°çš„æ±‚å€¼ã€‚å®ƒæ˜¯ä¸€ç§å£°æ˜å¼ç¼–ç¨‹é£æ ¼ï¼Œæè¿°çš„æ˜¯"è¦ä»€ä¹ˆ"ï¼Œè€Œä¸æ˜¯"æ€ä¹ˆåš"ã€‚åœ¨ FP ä¸­ï¼Œå‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™å…¶ä»–å‡½æ•°ï¼Œå¯ä»¥ä»å‡½æ•°è¿”å›ï¼Œä¹Ÿå¯ä»¥èµ‹å€¼ç»™å˜é‡ã€‚</p>
<p>FP çš„ä¸€ä¸ªæ ¸å¿ƒåŸåˆ™æ˜¯ä¸å¯å˜æ€§â€”â€”ä¸€æ—¦ç»™å˜é‡èµ‹å€¼ï¼Œå°±ä¸èƒ½å†æ”¹å˜ã€‚è¿™æ¶ˆé™¤äº†å‰¯ä½œç”¨ï¼Œè®©ä»£ç æ›´å¯é¢„æµ‹ã€æ›´å®¹æ˜“è°ƒè¯•ã€‚å¦ä¸€ä¸ªåŸºæœ¬æ¦‚å¿µæ˜¯çº¯å‡½æ•°ï¼Œå¯¹äºç›¸åŒçš„è¾“å…¥æ€»æ˜¯äº§ç”Ÿç›¸åŒçš„è¾“å‡ºï¼Œä¸ä¼šä¿®æ”¹ä»»ä½•å¤–éƒ¨çŠ¶æ€ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2026-01%2Ffunctional-programming-paradigms-2026" target="_blank" title="https://catchadmin.com/post/2026-01/functional-programming-paradigms-2026" ref="nofollow noopener noreferrer">åŸæ–‡ 2026 å¹´ PHP å‡½æ•°å¼ç¼–ç¨‹ ä¼˜åŠ¿ä¸å®é™…åº”ç”¨</a></p>
<h3 data-id="heading-2">ä¸ºä»€ä¹ˆå¼€å‘è€…åº”è¯¥å…³æ³¨å‡½æ•°å¼ç¼–ç¨‹</h3>
<h4 data-id="heading-3">æ›´ç®€æ´ã€æ›´æ˜“ç»´æŠ¤çš„ä»£ç </h4>
<p>å‡½æ•°å¼ç¼–ç¨‹é¼“åŠ±ç¼–å†™æ¨¡å—åŒ–ã€æ˜“äºç†è§£çš„ä»£ç ã€‚å› ä¸ºå‡½æ•°æ˜¯çº¯çš„ï¼ˆä¸ä¿®æ”¹çŠ¶æ€ï¼‰ï¼Œæ„å¤–è¡Œä¸ºçš„ç©ºé—´æ›´å°ï¼Œä»£ç åº“æ›´å¹²å‡€ã€‚è¿™è®©è°ƒè¯•ã€æµ‹è¯•å’Œåç»­ä¿®æ”¹éƒ½æ›´å®¹æ˜“ã€‚</p>
<p>å‡è®¾ä½ åœ¨åšä¸€ä¸ª PHP é¡¹ç›®ã€‚ä½¿ç”¨å‡½æ•°å¼æŠ€æœ¯å¯ä»¥å‡å°‘å‰¯ä½œç”¨ï¼Œç¡®ä¿åº”ç”¨é€»è¾‘è¢«éš”ç¦»æˆæ›´å°çš„ã€å¯å¤ç”¨çš„ä»£ç ç‰‡æ®µã€‚è¿™ä¹Ÿè®©åç»­æ›´æ–°æˆ–é‡æ„æ›´å®¹æ˜“ï¼Œå› ä¸ºå‡½æ•°å¼ä»£ç çš„ä¾èµ–é€šå¸¸æ›´å°‘ã€‚</p>
<h4 data-id="heading-4">å¹¶å‘å’Œå¹¶è¡Œ</h4>
<p>ç°ä»£è½¯ä»¶çš„ä¸€ä¸ªæŒ‘æˆ˜æ˜¯å¤„ç†å¹¶å‘å’Œå¹¶è¡Œã€‚éšç€å¤šæ ¸å¤„ç†å™¨å’Œåˆ†å¸ƒå¼ç³»ç»Ÿçš„æ™®åŠï¼Œç¼–å†™èƒ½é«˜æ•ˆå¤„ç†å¤šä»»åŠ¡çš„ä»£ç æ¯”ä»¥å¾€æ›´é‡è¦ã€‚</p>
<p>å‡½æ•°å¼ç¼–ç¨‹åœ¨è¿™æ–¹é¢æœ‰æ˜æ˜¾ä¼˜åŠ¿ï¼šå› ä¸ºå‡½æ•°é¿å…ä¿®æ”¹å…±äº«çŠ¶æ€ï¼Œå®ƒä»¬å¤©ç”Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚è¿™è®©ç¼–å†™å¹¶å‘åº”ç”¨æ›´å®¹æ˜“ï¼Œä¸ç”¨æ‹…å¿ƒç«æ€æ¡ä»¶æˆ–æ­»é”ã€‚</p>
<p>æ¯”å¦‚ä¸€ä¸ªéœ€è¦å¤„ç†å¤§æ•°æ®é›†çš„ PHP åº”ç”¨ã€‚ä½¿ç”¨ä¸å¯å˜æ•°æ®ç»“æ„å’Œå¹¶è¡Œå¤„ç†æŠ€æœ¯ï¼Œå¯ä»¥ç¡®ä¿åº”ç”¨çš„ä¸åŒéƒ¨åˆ†å¹¶å‘è¿è¡Œè€Œä¸äº’ç›¸å¹²æ‰°ã€‚</p>
<h4 data-id="heading-5">æ›´å¥½çš„æŠ½è±¡å’Œå¤ç”¨</h4>
<p>å‡½æ•°å¼ç¼–ç¨‹ä¿ƒè¿›é«˜å±‚æŠ½è±¡çš„åˆ›å»ºã€‚å‡½æ•°å¯ä»¥è½»æ¾ç»„åˆã€ä¼ é€’ï¼Œåœ¨åº”ç”¨çš„ä¸åŒéƒ¨åˆ†å¤ç”¨ã€‚</p>
<p>æ¯”å¦‚åœ¨ PHP ä¸­ï¼Œä¸å…¶å†™é‡å¤çš„ä»£ç å¤„ç†æŸäº›æ“ä½œï¼Œä¸å¦‚å†™å°çš„çº¯å‡½æ•°ï¼Œç„¶åçµæ´»åœ°ç»„åˆèµ·æ¥ã€‚è¿™å‡å°‘äº†ä»£ç é‡å¤ï¼Œæ›´å¥½åœ°éµå¾ª DRYï¼ˆDon't Repeat Yourselfï¼‰åŸåˆ™ã€‚</p>
<h4 data-id="heading-6">PHP ä¸­çš„å‡½æ•°å¼å·¥å…·</h4>
<p>PHP ä¸æ˜¯çº¯å‡½æ•°å¼è¯­è¨€ï¼Œä½†å†…ç½®çš„ <code>array_map()</code>ã€<code>array_filter()</code>ã€<code>array_reduce()</code> ç­‰å‡½æ•°æä¾›äº†åŸºæœ¬çš„å‡½æ•°å¼æ“ä½œèƒ½åŠ›ã€‚ç¬¬ä¸‰æ–¹åº“å¦‚ Ramdaã€Lodash ä¹Ÿå¯ä»¥ç”¨ã€‚</p>
<h3 data-id="heading-7">å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒåŸåˆ™</h3>
<p>ä¸‹é¢æ¢è®¨å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€äº›æ ¸å¿ƒåŸåˆ™ï¼Œä»¥åŠå®ƒä»¬åœ¨å®é™…ç¼–ç¨‹ä¸­çš„åº”ç”¨ã€‚</p>
<h4 data-id="heading-8">ä¸å¯å˜æ€§</h4>
<p>åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œæ•°æ®æ˜¯ä¸å¯å˜çš„ã€‚ä¸€æ—¦è®¾ç½®äº†å€¼ï¼Œå°±ä¸èƒ½æ”¹å˜ã€‚è¿™ä¸ªæ¦‚å¿µå‡å°‘äº†ä¸å¯å˜çŠ¶æ€å˜åŒ–ç›¸å…³çš„ bugï¼Œç®€åŒ–äº†å¯¹ç¨‹åºè¡Œä¸ºçš„ç†è§£ã€‚</p>
<p>PHP ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addItemToList</span>(<span class="hljs-params"><span class="hljs-variable">$list</span>, <span class="hljs-variable">$item</span></span>) </span>{
    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªåŒ…å«æ–°å…ƒç´ çš„æ–°åˆ—è¡¨</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">array_merge</span>(<span class="hljs-variable">$list</span>, [<span class="hljs-variable">$item</span>]);
}

<span class="hljs-variable">$list</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-variable">$newList</span> = <span class="hljs-title function_ invoke__">addItemToList</span>(<span class="hljs-variable">$list</span>, <span class="hljs-number">4</span>);

<span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$list</span>);     <span class="hljs-comment">// è¾“å‡º: [1, 2, 3]ï¼ˆåŸåˆ—è¡¨ä¸å˜ï¼‰</span>
<span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$newList</span>);  <span class="hljs-comment">// è¾“å‡º: [1, 2, 3, 4]ï¼ˆåŒ…å«æ–°å…ƒç´ çš„æ–°åˆ—è¡¨ï¼‰</span>
</code></pre>
<p>è¿™ä¸ªä¾‹å­ä¸­ï¼ŒåŸå§‹çš„ <code>$list</code> ä¿æŒä¸å˜ï¼Œå› ä¸º PHP æ•°ç»„æ˜¯æŒ‰å€¼ä¼ é€’çš„ã€‚è¿™å±•ç¤ºäº†ä¸å¯å˜æ€§â€”â€”åŸå§‹æ•°æ®ç»“æ„è¢«ä¿ç•™ï¼Œè¿”å›çš„æ˜¯åŒ…å«æ–°å…ƒç´ çš„æ–°ç»“æ„ã€‚</p>
<h4 data-id="heading-9">çº¯å‡½æ•°</h4>
<p>çº¯å‡½æ•°å¯¹äºç›¸åŒçš„è¾“å…¥æ€»æ˜¯äº§ç”Ÿç›¸åŒçš„è¾“å‡ºï¼Œä¸ä¼šäº§ç”Ÿä»»ä½•å‰¯ä½œç”¨ã€‚è¿™è®©çº¯å‡½æ•°å¯é¢„æµ‹ä¸”æ˜“äºæµ‹è¯•ã€‚</p>
<p>PHP ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">square</span>(<span class="hljs-params"><span class="hljs-variable">$number</span></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$number</span> * <span class="hljs-variable">$number</span>;
}

<span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">square</span>(<span class="hljs-number">4</span>); <span class="hljs-comment">// è¾“å‡º: 16</span>
</code></pre>
<p><code>square()</code> å‡½æ•°æ˜¯çº¯çš„ï¼Œå› ä¸ºå¯¹äºç›¸åŒçš„è¾“å…¥ï¼ˆ4ï¼‰æ€»æ˜¯äº§ç”Ÿç›¸åŒçš„è¾“å‡ºï¼ˆ16ï¼‰ï¼Œè€Œä¸”ä¸ä¿®æ”¹ä»»ä½•å¤–éƒ¨çŠ¶æ€ã€‚</p>
<h4 data-id="heading-10">é«˜é˜¶å‡½æ•°</h4>
<p>é«˜é˜¶å‡½æ•°æ˜¯å¯ä»¥æ¥å—å…¶ä»–å‡½æ•°ä½œä¸ºå‚æ•°æˆ–è¿”å›å‡½æ•°çš„å‡½æ•°ã€‚è¿™å®ç°äº†å¼ºå¤§çš„æŠ½è±¡å’Œä»£ç å¤ç”¨ã€‚</p>
<p>PHP ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">applyFunction</span>(<span class="hljs-params"><span class="hljs-variable">$func</span>, <span class="hljs-variable">$value</span></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$func</span>(<span class="hljs-variable">$value</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">double</span>(<span class="hljs-params"><span class="hljs-variable">$x</span></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$x</span> * <span class="hljs-number">2</span>;
}

<span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">applyFunction</span>(<span class="hljs-string">'double'</span>, <span class="hljs-number">5</span>); <span class="hljs-comment">// è¾“å‡º: 10</span>
</code></pre>
<p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>applyFunction()</code> æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œå› ä¸ºå®ƒæ¥å—å¦ä¸€ä¸ªå‡½æ•°ï¼ˆ<code>double()</code>ï¼‰ä½œä¸ºå‚æ•°å¹¶åº”ç”¨åˆ°ä¸€ä¸ªå€¼ä¸Šã€‚</p>
<h4 data-id="heading-11">å‡½æ•°ç»„åˆ</h4>
<p>å‡½æ•°ç»„åˆæ˜¯æŠŠç®€å•å‡½æ•°ç»„åˆæˆæ›´å¤æ‚å‡½æ•°çš„è¿‡ç¨‹ã€‚è¿™è®©ä½ å¯ä»¥ä»æ›´å°çš„ã€å¯å¤ç”¨çš„ç»„ä»¶æ„å»ºå¤æ‚è¡Œä¸ºã€‚</p>
<p>PHP ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params"><span class="hljs-variable">$x</span>, <span class="hljs-variable">$y</span></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$x</span> + <span class="hljs-variable">$y</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">multiply</span>(<span class="hljs-params"><span class="hljs-variable">$x</span>, <span class="hljs-variable">$y</span></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$x</span> * <span class="hljs-variable">$y</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addThenMultiply</span>(<span class="hljs-params"><span class="hljs-variable">$x</span>, <span class="hljs-variable">$y</span>, <span class="hljs-variable">$z</span></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">multiply</span>(<span class="hljs-title function_ invoke__">add</span>(<span class="hljs-variable">$x</span>, <span class="hljs-variable">$y</span>), <span class="hljs-variable">$z</span>);
}

<span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">addThenMultiply</span>(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>); <span class="hljs-comment">// è¾“å‡º: 20ï¼ˆadd(2, 3) = 5, multiply(5, 4) = 20ï¼‰</span>
</code></pre>
<p>è¿™é‡Œï¼Œ<code>addThenMultiply()</code> å‡½æ•°å±•ç¤ºäº†å¦‚ä½•æŠŠæ›´å°çš„å‡½æ•°ç»„åˆèµ·æ¥åˆ›å»ºæ–°åŠŸèƒ½ã€‚è¿™é¼“åŠ±ä»£ç å¤ç”¨å’Œæ¨¡å—åŒ–ã€‚</p>
<h3 data-id="heading-12">å‡½æ•°å¼ç¼–ç¨‹çš„å®é™…åº”ç”¨</h3>
<p>å‡½æ•°å¼ç¼–ç¨‹ä¸åªæ˜¯ç†è®ºæ¦‚å¿µâ€”â€”å®ƒæ­£åœ¨å®é™…åº”ç”¨ä¸­ä½¿ç”¨ã€‚ä¸‹é¢çœ‹çœ‹å‡½æ•°å¼ç¼–ç¨‹åœ¨ä¸åŒé¢†åŸŸçš„ä¸€äº›å®é™…ä¾‹å­ã€‚</p>
<h4 data-id="heading-13">æ•°æ®è½¬æ¢å’Œ ETL æµç¨‹</h4>
<p>åœ¨æ•°æ®å¯†é›†å‹åº”ç”¨ä¸­ï¼Œæ¯”å¦‚æ•°æ®è½¬æ¢æˆ– ETLï¼ˆExtract, Transform, Loadï¼‰æµç¨‹ï¼Œå‡½æ•°å¼ç¼–ç¨‹è¡¨ç°å‡ºè‰²ã€‚å®ƒè®©å¼€å‘è€…å¯ä»¥ä¸å¯å˜åœ°æ“ä½œå¤§æ•°æ®é›†ï¼Œä½¿ç”¨é«˜å±‚æŠ½è±¡è¿›è¡Œè½¬æ¢ã€‚</p>
<p>PHP ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$data</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];

<span class="hljs-comment">// ä½¿ç”¨å‡½æ•°å¼æ–¹æ³•å¤„ç†æ•°æ®</span>
<span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">array_map</span>(fn(<span class="hljs-variable">$x</span>) =&gt; <span class="hljs-variable">$x</span> * <span class="hljs-number">2</span>, <span class="hljs-variable">$data</span>);  <span class="hljs-comment">// æ¯ä¸ªå€¼ç¿»å€</span>
<span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">array_filter</span>(<span class="hljs-variable">$result</span>, fn(<span class="hljs-variable">$x</span>) =&gt; <span class="hljs-variable">$x</span> &gt; <span class="hljs-number">5</span>); <span class="hljs-comment">// åªä¿ç•™å¤§äº 5 çš„å€¼</span>

<span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$result</span>);  <span class="hljs-comment">// è¾“å‡º: [6, 8, 10]</span>
</code></pre>
<p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>array_map()</code> å’Œ <code>array_filter()</code> ä¸å¯å˜åœ°è½¬æ¢å’Œè¿‡æ»¤æ•°æ®é›†ï¼Œè¿™æ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„å¸¸è§æ¨¡å¼ã€‚</p>
<h4 data-id="heading-14">åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¹¶å‘</h4>
<p>å‡½æ•°å¼ç¼–ç¨‹å¯¹ä¸å¯å˜æ€§å’Œçº¯å‡½æ•°çš„å¼ºè°ƒï¼Œä½¿å®ƒæˆä¸ºå¹¶å‘å’Œå¹¶è¡Œå¤„ç†ä»»åŠ¡çš„ç†æƒ³é€‰æ‹©ã€‚ä½ å¯ä»¥æ”¾å¿ƒåœ°ç¼–å†™å¹¶å‘åº”ç”¨ï¼Œä¸ç”¨æ‹…å¿ƒç«æ€æ¡ä»¶ã€‚</p>
<p>æ¯”å¦‚ï¼Œåœ¨ PHP ä¸­æ„å»ºä¸€ä¸ªå¹¶å‘å¤„ç†ç”¨æˆ·è¯·æ±‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿæ—¶ï¼Œå¯ä»¥ç¡®ä¿æ•°æ®å®Œæ•´æ€§ï¼Œè€Œä¸ä¼šå¼•å…¥ä¸å¯å˜å…±äº«çŠ¶æ€ç›¸å…³çš„ bugã€‚</p>
<h4 data-id="heading-15">æ„å»º API ç«¯ç‚¹å’Œå¾®æœåŠ¡</h4>
<p>æ„å»ºå¾®æœåŠ¡æˆ– API æ—¶ï¼Œå‡½æ•°å¼ç¼–ç¨‹å¯ä»¥å¸®åŠ©åˆ›å»ºç®€æ´ã€æ˜“ç»´æŠ¤çš„ç«¯ç‚¹ã€‚é€šè¿‡ç¡®ä¿æ¯ä¸ªå‡½æ•°å¤„ç†ç‰¹å®šä»»åŠ¡ä¸”æ˜¯çº¯çš„ã€ç¡®å®šæ€§çš„ï¼Œå¯ä»¥è®©æ¯ä¸ªå¾®æœåŠ¡æ›´å®¹æ˜“æµ‹è¯•å’Œæ‰©å±•ã€‚</p>
<h3 data-id="heading-16">å°ç»“</h3>
<p>å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒæ˜¯ä¸å¯å˜æ€§ã€çº¯å‡½æ•°å’Œé«˜é˜¶å‡½æ•°ã€‚è¿™äº›æ¦‚å¿µåœ¨å¹¶å‘å¤„ç†ã€æ•°æ®è½¬æ¢ç­‰åœºæ™¯ä¸‹æ¯”è¾ƒå®ç”¨ã€‚PHP è™½ç„¶ä¸æ˜¯çº¯å‡½æ•°å¼è¯­è¨€ï¼Œä½†å†…ç½®å‡½æ•°å’Œç¬¬ä¸‰æ–¹åº“å·²ç»æä¾›äº†è¶³å¤Ÿçš„æ”¯æŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kotlin åç¨‹ä¸ Flow å®Œå…¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7596906473305817138</link>    <guid>https://juejin.cn/post/7596906473305817138</guid>    <pubDate>2026-01-19T09:55:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596906473305817138" data-draft-id="7596906473305800754" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kotlin åç¨‹ä¸ Flow å®Œå…¨æŒ‡å—"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-01-19T09:55:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="aykon"/> <meta itemprop="url" content="https://juejin.cn/user/3984285870883080"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kotlin åç¨‹ä¸ Flow å®Œå…¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3984285870883080/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    aykon
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T09:55:18.000Z" title="Mon Jan 19 2026 09:55:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Kotlin åç¨‹ä¸ Flow å®Œå…¨æŒ‡å—</h2>
<blockquote>
<p>æœ¬æ–‡æ¡£æ¶µç›–äº† Kotlin åç¨‹å’Œ Flow çš„åŸºç¡€çŸ¥è¯†ã€ç¤ºä¾‹ä»£ç ã€æºç è§£æä»¥åŠä¸¤è€…çš„å¯¹æ¯”</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ç›®å½•</h3>
<ul>
<li><a href="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86kotlin-%E5%8D%8F%E7%A8%8B" title="#%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86kotlin-%E5%8D%8F%E7%A8%8B">ç¬¬ä¸€éƒ¨åˆ†ï¼šKotlin åç¨‹</a>
<ul>
<li><a href="#%E5%8D%8F%E7%A8%8B%E5%9F%BA%E7%A1%80" title="#%E5%8D%8F%E7%A8%8B%E5%9F%BA%E7%A1%80">åç¨‹åŸºç¡€</a></li>
<li><a href="#%E5%8D%8F%E7%A8%8B%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5" title="#%E5%8D%8F%E7%A8%8B%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5">åç¨‹æ ¸å¿ƒæ¦‚å¿µ</a></li>
<li><a href="#%E5%8D%8F%E7%A8%8B%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81" title="#%E5%8D%8F%E7%A8%8B%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81">åç¨‹ç¤ºä¾‹ä»£ç </a></li>
<li><a href="#%E5%8D%8F%E7%A8%8B%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90" title="#%E5%8D%8F%E7%A8%8B%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90">åç¨‹æºç è§£æ</a></li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86kotlin-flow" title="#%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86kotlin-flow">ç¬¬äºŒéƒ¨åˆ†ï¼šKotlin Flow</a>
<ul>
<li><a href="#flow-%E5%9F%BA%E7%A1%80" title="#flow-%E5%9F%BA%E7%A1%80">Flow åŸºç¡€</a></li>
<li><a href="#flow-%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5" title="#flow-%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5">Flow æ ¸å¿ƒæ¦‚å¿µ</a></li>
<li><a href="#flow-%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81" title="#flow-%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81">Flow ç¤ºä¾‹ä»£ç </a></li>
<li><a href="#flow-%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90" title="#flow-%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90">Flow æºç è§£æ</a></li>
</ul>
</li>
<li><a href="#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%E5%8D%8F%E7%A8%8B%E4%B8%8E-flow-%E5%AF%B9%E6%AF%94" title="#%E7%AC%AC%E4%B8%89%E9%83%A8%E5%88%86%E5%8D%8F%E7%A8%8B%E4%B8%8E-flow-%E5%AF%B9%E6%AF%94">ç¬¬ä¸‰éƒ¨åˆ†ï¼šåç¨‹ä¸ Flow å¯¹æ¯”</a></li>
</ul>
<hr/>
<h2 data-id="heading-2">ç¬¬ä¸€éƒ¨åˆ†ï¼šKotlin åç¨‹</h2>
<h3 data-id="heading-3">åç¨‹åŸºç¡€</h3>
<h4 data-id="heading-4">ä»€ä¹ˆæ˜¯åç¨‹ï¼Ÿ</h4>
<p>åç¨‹ï¼ˆCoroutineï¼‰æ˜¯ä¸€ç§å¹¶å‘ç¼–ç¨‹çš„æ–¹å¼ï¼Œå…è®¸åœ¨å•ä¸ªçº¿ç¨‹å†…å®ç°å¤šä¸ªä»»åŠ¡çš„åä½œå¼å¤šä»»åŠ¡ã€‚Kotlin åç¨‹é€šè¿‡ <code>suspend</code> å‡½æ•°å®ç°"æŒ‚èµ·å’Œæ¢å¤"æœºåˆ¶ï¼Œè®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç ä¸€æ ·ç®€æ´ã€‚</p>
<h4 data-id="heading-5">åç¨‹çš„æ ¸å¿ƒä¼˜åŠ¿</h4>
<ol>
<li><strong>è½»é‡çº§</strong>ï¼šå¯ä»¥åœ¨å•ä¸ªçº¿ç¨‹ä¸­è¿è¡Œæˆåƒä¸Šä¸‡ä¸ªåç¨‹</li>
<li><strong>å†…å­˜æ³„æ¼æ›´å°‘</strong>ï¼šä½¿ç”¨ç»“æ„åŒ–å¹¶å‘ç®¡ç†åç¨‹ç”Ÿå‘½å‘¨æœŸ</li>
<li><strong>å†…ç½®å–æ¶ˆæ”¯æŒ</strong>ï¼šåç¨‹å¯ä»¥åä½œå¼åœ°å–æ¶ˆ</li>
<li><strong>Jetpack é›†æˆ</strong>ï¼šä¸ Android Jetpack åº“æ·±åº¦é›†æˆ</li>
</ol>
<h4 data-id="heading-6">åç¨‹çš„åŸºæœ¬ç»„æˆ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åç¨‹çš„ä¸‰å¤§æ ¸å¿ƒè¦ç´ </span>
<span class="hljs-comment">// 1. åç¨‹ä½œç”¨åŸŸ (CoroutineScope)</span>
<span class="hljs-comment">// 2. åç¨‹æ„å»ºå™¨ (Coroutine Builders: launch, async, runBlocking)</span>
<span class="hljs-comment">// 3. åç¨‹ä¸Šä¸‹æ–‡ (CoroutineContext)</span>
</code></pre>
<hr/>
<h3 data-id="heading-7">åç¨‹æ ¸å¿ƒæ¦‚å¿µ</h3>
<h4 data-id="heading-8">1. æŒ‚èµ·å‡½æ•° (Suspend Function)</h4>
<p>æŒ‚èµ·å‡½æ•°æ˜¯åç¨‹çš„åŸºç¡€ï¼Œå®ƒåªèƒ½åœ¨åç¨‹å†…éƒ¨æˆ–å…¶ä»–æŒ‚èµ·å‡½æ•°ä¸­è°ƒç”¨ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.delay
<span class="hljs-keyword">import</span> kotlinx.coroutines.coroutineScope
<span class="hljs-keyword">import</span> kotlinx.coroutines.runBlocking

<span class="hljs-comment">/**
 * æŒ‚èµ·å‡½æ•°ç¤ºä¾‹
 * suspend å…³é”®å­—æ ‡è®°çš„å‡½æ•°å¯ä»¥è¢«æŒ‚èµ·ï¼Œè€Œä¸ä¼šé˜»å¡çº¿ç¨‹
 */</span>
<span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchData</span><span class="hljs-params">()</span></span>: String {
    <span class="hljs-comment">// delay æ˜¯ä¸€ä¸ªæŒ‚èµ·å‡½æ•°ï¼Œä¸ä¼šé˜»å¡çº¿ç¨‹</span>
    delay(<span class="hljs-number">1000</span>) <span class="hljs-comment">// æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚å»¶è¿Ÿ</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"æ•°æ®åŠ è½½å®Œæˆ"</span>
}

<span class="hljs-comment">/**
 * æ™®é€šå‡½æ•°æ— æ³•è°ƒç”¨æŒ‚èµ·å‡½æ•°
 * fun normalFunction() {
 *     fetchData() // ç¼–è¯‘é”™è¯¯ï¼šæŒ‚èµ·å‡½æ•°åªèƒ½åœ¨åç¨‹æˆ–æŒ‚èµ·å‡½æ•°ä¸­è°ƒç”¨
 * }

/**
 * åœ¨åç¨‹ä¸­è°ƒç”¨æŒ‚èµ·å‡½æ•°
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking { <span class="hljs-comment">// runBlocking åˆ›å»ºä¸€ä¸ªåç¨‹ä½œç”¨åŸŸ</span>
    <span class="hljs-keyword">val</span> result = fetchData() <span class="hljs-comment">// å¯ä»¥è°ƒç”¨æŒ‚èµ·å‡½æ•°</span>
    println(result)
}
</code></pre>
<h4 data-id="heading-9">2. åç¨‹ä½œç”¨åŸŸ (CoroutineScope)</h4>
<p>åç¨‹ä½œç”¨åŸŸå®šä¹‰äº†åç¨‹çš„ç”Ÿå‘½å‘¨æœŸèŒƒå›´ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*

<span class="hljs-comment">/**
 * åç¨‹ä½œç”¨åŸŸç¤ºä¾‹
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// launch åœ¨å½“å‰ä½œç”¨åŸŸå†…å¯åŠ¨ä¸€ä¸ªæ–°åç¨‹</span>
    launch {
        delay(<span class="hljs-number">200</span>)
        println(<span class="hljs-string">"Task from launch"</span>)
    }

    <span class="hljs-comment">// async å¯åŠ¨ä¸€ä¸ªæ–°åç¨‹å¹¶è¿”å› Deferred ç»“æœ</span>
    <span class="hljs-keyword">val</span> deferred: Deferred&lt;String&gt; = async {
        delay(<span class="hljs-number">100</span>)
        <span class="hljs-keyword">return</span><span class="hljs-symbol">@async</span> <span class="hljs-string">"Task from async"</span>
    }

    println(<span class="hljs-string">"ç­‰å¾…å­åç¨‹å®Œæˆ..."</span>)
    println(deferred.await()) <span class="hljs-comment">// await() è·å– async çš„ç»“æœ</span>
}
</code></pre>
<h4 data-id="heading-10">3. åç¨‹ä¸Šä¸‹æ–‡ (CoroutineContext)</h4>
<p>åç¨‹ä¸Šä¸‹æ–‡æ˜¯ä¸€ç»„å®šä¹‰åç¨‹è¡Œä¸ºçš„å…ƒç´ é›†åˆã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// CoroutineContext çš„å››ä¸ªæ ¸å¿ƒå…ƒç´ ï¼š</span>
    <span class="hljs-comment">// 1. Jobï¼šåç¨‹çš„å¥æŸ„ï¼Œç”¨äºå–æ¶ˆå’Œç®¡ç†</span>
    <span class="hljs-comment">// 2. Dispatcherï¼šç¡®å®šåç¨‹åœ¨å“ªä¸ªçº¿ç¨‹æ‰§è¡Œ</span>
    <span class="hljs-comment">// 3. CoroutineNameï¼šåç¨‹çš„åç§°</span>
    <span class="hljs-comment">// 4. CoroutineExceptionHandlerï¼šå¼‚å¸¸å¤„ç†å™¨</span>

    <span class="hljs-comment">// ç»„åˆå¤šä¸ªä¸Šä¸‹æ–‡å…ƒç´ </span>
    <span class="hljs-keyword">val</span> context: CoroutineContext = CoroutineName(<span class="hljs-string">"MyCoroutine"</span>) + Dispatchers.Default

    launch(context) {
        println(<span class="hljs-string">"åç¨‹è¿è¡Œåœ¨: <span class="hljs-subst">${Thread.currentThread().name}</span>"</span>)
    }
}
</code></pre>
<h4 data-id="heading-11">4. Job ä¸åç¨‹ç”Ÿå‘½å‘¨æœŸ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// Job ç®¡ç†åç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</span>
    <span class="hljs-keyword">val</span> job = launch {
        repeat(<span class="hljs-number">5</span>) { i -&gt;
            delay(<span class="hljs-number">500</span>)
            println(<span class="hljs-string">"åç¨‹æ‰§è¡Œ: <span class="hljs-variable">$i</span>"</span>)
        }
    }

    <span class="hljs-comment">// Job çš„çŠ¶æ€ï¼šNew -&gt; Active -&gt; Completing -&gt; Completed</span>
    <span class="hljs-comment">//           æˆ–ï¼šNew -&gt; Active -&gt; Cancelling -&gt; Cancelled</span>

    println(<span class="hljs-string">"Job çŠ¶æ€: <span class="hljs-subst">${job.isActive}</span>"</span>) <span class="hljs-comment">// true</span>
    println(<span class="hljs-string">"Job æ˜¯å¦å®Œæˆ: <span class="hljs-subst">${job.isCompleted}</span>"</span>) <span class="hljs-comment">// false</span>

    delay(<span class="hljs-number">1200</span>)
    job.cancel() <span class="hljs-comment">// å–æ¶ˆåç¨‹</span>

    <span class="hljs-comment">// ç­‰å¾…åç¨‹ç»“æŸ</span>
    job.join()
}
</code></pre>
<hr/>
<h3 data-id="heading-12">åç¨‹ç¤ºä¾‹ä»£ç </h3>
<h4 data-id="heading-13">ç¤ºä¾‹ 1ï¼šå¹¶å‘æ‰§è¡Œå¤šä¸ªä»»åŠ¡</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlin.system.measureTimeMillis

<span class="hljs-comment">/**
 * å¹¶å‘æ‰§è¡Œå¤šä¸ªä»»åŠ¡
 * ä½¿ç”¨ async å¯åŠ¨å¤šä¸ªå¹¶å‘ä»»åŠ¡ï¼Œç„¶åç”¨ await ç­‰å¾…æ‰€æœ‰ç»“æœ
 */</span>
<span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchUserData</span><span class="hljs-params">()</span></span>: String {
    delay(<span class="hljs-number">500</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"ç”¨æˆ·æ•°æ®"</span>
}

<span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchUserOrders</span><span class="hljs-params">()</span></span>: String {
    delay(<span class="hljs-number">800</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">"è®¢å•æ•°æ®"</span>
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-keyword">val</span> time = measureTimeMillis {
        <span class="hljs-comment">// å¹¶å‘æ‰§è¡Œä¸¤ä¸ªä»»åŠ¡</span>
        <span class="hljs-keyword">val</span> deferred1 = async { fetchUserData() }
        <span class="hljs-keyword">val</span> deferred2 = async { fetchUserOrders() }

        <span class="hljs-comment">// ç­‰å¾…ä¸¤ä¸ªä»»åŠ¡éƒ½å®Œæˆ</span>
        <span class="hljs-keyword">val</span> userData = deferred1.await()
        <span class="hljs-keyword">val</span> userOrders = deferred2.await()

        println(<span class="hljs-string">"ç»“æœ: <span class="hljs-variable">$userData</span>, <span class="hljs-variable">$userOrders</span>"</span>)
    }
    println(<span class="hljs-string">"æ€»è€—æ—¶: <span class="hljs-subst">${time}</span>ms"</span>) <span class="hljs-comment">// çº¦ 800msï¼ˆå¹¶è¡Œæ‰§è¡Œï¼‰</span>
}
</code></pre>
<h4 data-id="heading-14">ç¤ºä¾‹ 2ï¼šå¼‚å¸¸å¤„ç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> java.lang.Exception

<span class="hljs-comment">/**
 * åç¨‹å¼‚å¸¸å¤„ç†ç¤ºä¾‹
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// æ–¹å¼1ï¼šä½¿ç”¨ try-catch</span>
    <span class="hljs-keyword">try</span> {
        launch {
            delay(<span class="hljs-number">100</span>)
            <span class="hljs-keyword">throw</span> ArithmeticException(<span class="hljs-string">"è®¡ç®—é”™è¯¯"</span>)
        }
    } <span class="hljs-keyword">catch</span> (e: Exception) {
        println(<span class="hljs-string">"æ•è·å¼‚å¸¸: <span class="hljs-subst">${e.message}</span>"</span>)
    }

    <span class="hljs-comment">// æ–¹å¼2ï¼šä½¿ç”¨ CoroutineExceptionHandler</span>
    <span class="hljs-keyword">val</span> handler = CoroutineExceptionHandler { _, exception -&gt;
        println(<span class="hljs-string">"å¤„ç†å™¨æ•è·: <span class="hljs-subst">${exception.message}</span>"</span>)
    }

    <span class="hljs-keyword">val</span> job = launch(handler) {
        <span class="hljs-keyword">throw</span> IllegalStateException(<span class="hljs-string">"éæ³•çŠ¶æ€"</span>)
    }

    job.join()
}
</code></pre>
<h4 data-id="heading-15">ç¤ºä¾‹ 3ï¼šè¶…æ—¶å¤„ç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.TimeoutCancellationException
<span class="hljs-keyword">import</span> kotlin.system.measureTimeMillis

<span class="hljs-comment">/**
 * è¶…æ—¶å¤„ç†ç¤ºä¾‹
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// withTimeoutï¼šè¶…æ—¶åæŠ›å‡ºå¼‚å¸¸</span>
    <span class="hljs-keyword">try</span> {
        withTimeout(<span class="hljs-number">1000</span>) {
            delay(<span class="hljs-number">2000</span>)
            println(<span class="hljs-string">"è¿™è¡Œä¸ä¼šæ‰§è¡Œ"</span>)
        }
    } <span class="hljs-keyword">catch</span> (e: TimeoutCancellationException) {
        println(<span class="hljs-string">"æ“ä½œè¶…æ—¶"</span>)
    }

    <span class="hljs-comment">// withTimeoutOrNullï¼šè¶…æ—¶åè¿”å› null</span>
    <span class="hljs-keyword">val</span> result = withTimeoutOrNull(<span class="hljs-number">1000</span>) {
        delay(<span class="hljs-number">2000</span>)
        <span class="hljs-string">"å®Œæˆ"</span>
    }
    println(<span class="hljs-string">"ç»“æœ: <span class="hljs-variable">$result</span>"</span>) <span class="hljs-comment">// null</span>
}
</code></pre>
<h4 data-id="heading-16">ç¤ºä¾‹ 4ï¼šç»“æ„åŒ–å¹¶å‘</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*

<span class="hljs-comment">/**
 * ç»“æ„åŒ–å¹¶å‘ç¤ºä¾‹
 * çˆ¶åç¨‹ä¼šç­‰å¾…æ‰€æœ‰å­åç¨‹å®Œæˆ
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    launch {
        launch {
            delay(<span class="hljs-number">300</span>)
            println(<span class="hljs-string">"å­åç¨‹ 3 å®Œæˆ"</span>)
        }
        launch {
            delay(<span class="hljs-number">200</span>)
            println(<span class="hljs-string">"å­åç¨‹ 2 å®Œæˆ"</span>)
        }
        delay(<span class="hljs-number">100</span>)
        println(<span class="hljs-string">"å­åç¨‹ 1 å®Œæˆ"</span>)
    }

    <span class="hljs-comment">// runBlocking ä¼šç­‰å¾…æ‰€æœ‰å­åç¨‹å®Œæˆ</span>
    println(<span class="hljs-string">"ä¸»åç¨‹ç­‰å¾…ä¸­..."</span>)
}
</code></pre>
<h4 data-id="heading-17">ç¤ºä¾‹ 5ï¼šåç¨‹è°ƒåº¦å™¨ (Dispatchers)</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*

<span class="hljs-comment">/**
 * Dispatchers å†³å®šåç¨‹åœ¨å“ªä¸ªçº¿ç¨‹æ‰§è¡Œ
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// Dispatchers.Mainï¼šä¸»çº¿ç¨‹ï¼ˆAndroid UI çº¿ç¨‹ï¼‰</span>
    <span class="hljs-comment">// Dispatchers.IOï¼šIO å¯†é›†å‹ä»»åŠ¡ï¼ˆç½‘ç»œã€æ–‡ä»¶æ“ä½œï¼‰</span>
    <span class="hljs-comment">// Dispatchers.Defaultï¼šCPU å¯†é›†å‹ä»»åŠ¡ï¼ˆè®¡ç®—ã€æ’åºï¼‰</span>
    <span class="hljs-comment">// Dispatchers.Unconfinedï¼šä¸é™åˆ¶çº¿ç¨‹ï¼Œç»§æ‰¿è°ƒç”¨è€…çº¿ç¨‹</span>

    launch(Dispatchers.Default) {
        println(<span class="hljs-string">"Default: <span class="hljs-subst">${Thread.currentThread().name}</span>"</span>)
    }

    launch(Dispatchers.IO) {
        println(<span class="hljs-string">"IO: <span class="hljs-subst">${Thread.currentThread().name}</span>"</span>)
    }

    launch {
        println(<span class="hljs-string">"Inherited: <span class="hljs-subst">${Thread.currentThread().name}</span>"</span>)
    }
}
</code></pre>
<h4 data-id="heading-18">ç¤ºä¾‹ 6ï¼šChannel é€šä¿¡</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.channels.Channel

<span class="hljs-comment">/**
 * Channel ç”¨äºåç¨‹é—´é€šä¿¡
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-keyword">val</span> channel = Channel&lt;<span class="hljs-built_in">Int</span>&gt;()

    <span class="hljs-comment">// ç”Ÿäº§è€…åç¨‹</span>
    launch {
        <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1.</span><span class="hljs-number">.5</span>) {
            delay(<span class="hljs-number">100</span>)
            channel.send(i) <span class="hljs-comment">// å‘é€æ•°æ®</span>
            println(<span class="hljs-string">"å‘é€: <span class="hljs-variable">$i</span>"</span>)
        }
        channel.close() <span class="hljs-comment">// å…³é—­é€šé“</span>
    }

    <span class="hljs-comment">// æ¶ˆè´¹è€…åç¨‹</span>
    launch {
        <span class="hljs-keyword">for</span> (value <span class="hljs-keyword">in</span> channel) {
            println(<span class="hljs-string">"æ¥æ”¶: <span class="hljs-variable">$value</span>"</span>)
        }
    }
}
</code></pre>
<h4 data-id="heading-19">ç¤ºä¾‹ 7ï¼šåç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*

<span class="hljs-comment">/**
 * ä½¿ç”¨ withContext åˆ‡æ¢åç¨‹ä¸Šä¸‹æ–‡
 */</span>
<span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchData</span><span class="hljs-params">()</span></span>: String = withContext(Dispatchers.IO) {
    <span class="hljs-comment">// åœ¨ IO çº¿ç¨‹æ‰§è¡Œç½‘ç»œè¯·æ±‚</span>
    delay(<span class="hljs-number">500</span>)
    <span class="hljs-keyword">return</span><span class="hljs-symbol">@withContext</span> <span class="hljs-string">"ä»ç½‘ç»œè·å–çš„æ•°æ®"</span>
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    println(<span class="hljs-string">"ä¸»çº¿ç¨‹: <span class="hljs-subst">${Thread.currentThread().name}</span>"</span>)

    <span class="hljs-comment">// withContext ä¼šæŒ‚èµ·å½“å‰åç¨‹ï¼Œåœ¨æŒ‡å®šä¸Šä¸‹æ–‡æ‰§è¡Œï¼Œå®Œæˆåæ¢å¤</span>
    <span class="hljs-keyword">val</span> result = fetchData()

    println(<span class="hljs-string">"ç»“æœ: <span class="hljs-variable">$result</span>"</span>)
    println(<span class="hljs-string">"æ¢å¤åçº¿ç¨‹: <span class="hljs-subst">${Thread.currentThread().name}</span>"</span>)
}
</code></pre>
<hr/>
<h3 data-id="heading-20">åç¨‹æºç è§£æ</h3>
<h4 data-id="heading-21">1. suspend å‡½æ•°çš„ç¼–è¯‘æœŸè½¬æ¢</h4>
<p>Kotlin ç¼–è¯‘å™¨å°† <code>suspend</code> å‡½æ•°è½¬æ¢ä¸ºçŠ¶æ€æœºå®ç°ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æºä»£ç </span>
<span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchUser</span><span class="hljs-params">()</span></span>: User {
    <span class="hljs-keyword">val</span> token = getToken()
    <span class="hljs-keyword">val</span> user = getUser(token)
    <span class="hljs-keyword">return</span> user
}

<span class="hljs-comment">// ç¼–è¯‘åçš„ä¼ªä»£ç ï¼ˆç®€åŒ–ç‰ˆï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchUser</span><span class="hljs-params">(cont: <span class="hljs-type">Continuation</span>&lt;<span class="hljs-type">User</span>&gt;)</span></span>: Any {
    <span class="hljs-comment">// çŠ¶æ€æ ‡ç­¾</span>
    label: {
        <span class="hljs-keyword">when</span> (cont.label) {
            <span class="hljs-number">0</span> -&gt; {
                <span class="hljs-comment">// ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œè·å– token</span>
                <span class="hljs-keyword">val</span> token = getToken()
                <span class="hljs-comment">// ä¿å­˜çŠ¶æ€ï¼Œè®¾ç½®ä¸‹ä¸€æ¬¡çš„ label</span>
                cont.label = <span class="hljs-number">1</span>
                <span class="hljs-comment">// æŒ‚èµ·å¹¶è¿”å›</span>
                <span class="hljs-keyword">return</span> getTokenSuspended(token, cont)
            }
            <span class="hljs-number">1</span> -&gt; {
                <span class="hljs-comment">// æ¢å¤åï¼Œä»æŒ‚èµ·ç‚¹ç»§ç»­</span>
                <span class="hljs-keyword">val</span> token = cont <span class="hljs-keyword">as</span>? Token ?: <span class="hljs-keyword">throw</span> AssertionError()
                <span class="hljs-keyword">val</span> user = getUser(token)
                <span class="hljs-keyword">return</span> user
            }
        }
    }
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li><code>suspend</code> å‡½æ•°ç¼–è¯‘åæ·»åŠ ä¸€ä¸ª <code>Continuation</code> å‚æ•°</li>
<li>ä½¿ç”¨çŠ¶æ€æœºæ¨¡å¼ç®¡ç†æŒ‚èµ·ç‚¹</li>
<li>æ¯ä¸ªæŒ‚èµ·ç‚¹å¯¹åº”ä¸€ä¸ªçŠ¶æ€æ ‡ç­¾</li>
</ul>
<h4 data-id="heading-22">2. Continuation æ¥å£è§£æ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Continuation æ¥å£å®šä¹‰</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Continuation</span>&lt;<span class="hljs-type">in T</span>&gt; {
    <span class="hljs-comment">// åç¨‹çš„ä¸Šä¸‹æ–‡</span>
    <span class="hljs-keyword">val</span> context: CoroutineContext

    <span class="hljs-comment">// æ¢å¤åç¨‹æ‰§è¡Œï¼ŒæˆåŠŸæ—¶è°ƒç”¨</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">resumeWith</span><span class="hljs-params">(result: <span class="hljs-type">Result</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>
}

<span class="hljs-comment">// æ‰©å±•å‡½æ•°ï¼ˆç®€åŒ–ä½¿ç”¨ï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Continuation<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">resume</span><span class="hljs-params">(value: <span class="hljs-type">T</span>)</span></span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Continuation<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">resumeWithException</span><span class="hljs-params">(exception: <span class="hljs-type">Throwable</span>)</span></span>
</code></pre>
<p><strong>å·¥ä½œåŸç†ï¼š</strong></p>
<ul>
<li><code>Continuation</code> è¡¨ç¤ºåç¨‹çš„å»¶ç»­ï¼ˆå³"æ¥ä¸‹æ¥è¦åšä»€ä¹ˆ"ï¼‰</li>
<li>æŒ‚èµ·æ—¶ä¿å­˜ <code>Continuation</code>ï¼Œæ¢å¤æ—¶è°ƒç”¨ <code>resumeWith</code></li>
<li>é€šè¿‡ CPSï¼ˆContinuation-Passing Styleï¼‰å®ç°åç¨‹</li>
</ul>
<h4 data-id="heading-23">3. CoroutineScope æºç è§£æ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * CoroutineScope æ¥å£å®šä¹‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">CoroutineScope</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> coroutineContext: CoroutineContext
}

<span class="hljs-comment">/**
 * æ‰©å±•å‡½æ•° launch
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> CoroutineScope.<span class="hljs-title">launch</span><span class="hljs-params">(
    context: <span class="hljs-type">CoroutineContext</span> = EmptyCoroutineContext,
    start: <span class="hljs-type">CoroutineStart</span> = CoroutineStart.DEFAULT,
    block: <span class="hljs-type">suspend</span> <span class="hljs-type">CoroutineScope</span>.() -&gt; <span class="hljs-type">Unit</span>
)</span></span>: Job {
    <span class="hljs-comment">// åˆå¹¶ä¸Šä¸‹æ–‡ï¼šæ–°åç¨‹ç»§æ‰¿çˆ¶ä½œç”¨åŸŸçš„ä¸Šä¸‹æ–‡ï¼Œå¹¶åŠ ä¸Šè‡ªå®šä¹‰ context</span>
    <span class="hljs-keyword">val</span> newContext = newCoroutineContext(context)

    <span class="hljs-comment">// åˆ›å»ºåç¨‹</span>
    <span class="hljs-keyword">val</span> coroutine = <span class="hljs-keyword">if</span> (start.isLazy)
        LazyStandaloneCoroutine(newContext, block) <span class="hljs-keyword">else</span>
        StandaloneCoroutine(newContext, active = <span class="hljs-literal">true</span>)

    <span class="hljs-comment">// å¯åŠ¨åç¨‹</span>
    coroutine.start(start, coroutine, block)
    <span class="hljs-keyword">return</span> coroutine
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li><code>CoroutineScope</code> åªæ˜¯ä¸€ä¸ªæŒæœ‰ <code>CoroutineContext</code> çš„æ¥å£</li>
<li><code>launch</code> åˆ›å»ºæ–°çš„åç¨‹å¹¶è¿”å› <code>Job</code></li>
<li>å­åç¨‹ç»§æ‰¿çˆ¶ä½œç”¨åŸŸçš„ä¸Šä¸‹æ–‡ï¼ˆç»“æ„åŒ–å¹¶å‘çš„åŸºç¡€ï¼‰</li>
</ul>
<h4 data-id="heading-24">4. Job æºç è§£æ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * Job æ¥å£å®šä¹‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Job</span> : <span class="hljs-type">CoroutineContext.Element</span> {
    <span class="hljs-comment">// Job çš„çŠ¶æ€</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> isActive: <span class="hljs-built_in">Boolean</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> isCompleted: <span class="hljs-built_in">Boolean</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> isCancelled: <span class="hljs-built_in">Boolean</span>

    <span class="hljs-comment">// å–æ¶ˆåç¨‹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">cancel</span><span class="hljs-params">(cause: <span class="hljs-type">CancellationException</span>? = <span class="hljs-literal">null</span>)</span></span>

    <span class="hljs-comment">// ç­‰å¾…åç¨‹å®Œæˆï¼ˆæŒ‚èµ·å‡½æ•°ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">join</span><span class="hljs-params">()</span></span>

    <span class="hljs-comment">// æºå¸¦ç»“æœçš„å­æ¥å£</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Deferred</span>&lt;<span class="hljs-type">out T</span>&gt; : <span class="hljs-type">Job</span> {
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">await</span><span class="hljs-params">()</span></span>: T
    }
}

<span class="hljs-comment">/**
 * Job çŠ¶æ€æœºè½¬æ¢
 *
 * çŠ¶æ€è½¬æ¢è·¯å¾„ï¼š
 * 1. New -&gt; Active -&gt; Completing -&gt; Completed
 * 2. New -&gt; Active -&gt; Cancelling -&gt; Cancelled
 * 3. New -&gt; Active -&gt; Cancelling -&gt; Completedï¼ˆå¤„ç†å¼‚å¸¸åï¼‰
 */</span>
</code></pre>
<p><strong>Job çŠ¶æ€è¯¦è§£ï¼š</strong></p>
<ul>
<li><code>New</code>ï¼šåç¨‹å·²åˆ›å»ºä½†æœªå¯åŠ¨</li>
<li><code>Active</code>ï¼šåç¨‹æ­£åœ¨è¿è¡Œ</li>
<li><code>Completing</code>ï¼šåç¨‹æ­£åœ¨å®Œæˆï¼ˆç­‰å¾…å­åç¨‹ï¼‰</li>
<li><code>Completed</code>ï¼šåç¨‹å·²æˆåŠŸå®Œæˆ</li>
<li><code>Cancelling</code>ï¼šåç¨‹æ­£åœ¨å–æ¶ˆ</li>
<li><code>Cancelled</code>ï¼šåç¨‹å·²å–æ¶ˆ</li>
</ul>
<h4 data-id="heading-25">5. Dispatcher è°ƒåº¦å™¨æºç </h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * CoroutineDispatcher æŠ½è±¡ç±»
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CoroutineDispatcher</span> :
    <span class="hljs-type">AbstractCoroutineContextElement</span>(ContinuationInterceptor), ContinuationInterceptor {

    <span class="hljs-comment">// è°ƒåº¦æ ¸å¿ƒæ–¹æ³•ï¼šå°†ä»»åŠ¡åˆ†å‘åˆ°æŒ‡å®šçº¿ç¨‹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">dispatch</span><span class="hljs-params">(context: <span class="hljs-type">CoroutineContext</span>, block: <span class="hljs-type">Runnable</span>)</span></span>

    <span class="hljs-comment">// æ¢å¤æ‰§è¡Œï¼šå¯èƒ½åœ¨åŒä¸€çº¿ç¨‹ç›´æ¥æ¢å¤</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">isDispatchNeeded</span><span class="hljs-params">(context: <span class="hljs-type">CoroutineContext</span>)</span></span>: <span class="hljs-built_in">Boolean</span> = <span class="hljs-literal">true</span>

    <span class="hljs-comment">// æ‹¦æˆª continuationï¼Œå®ç°è°ƒåº¦</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">interceptContinuation</span><span class="hljs-params">(
        continuation: <span class="hljs-type">Continuation</span>&lt;<span class="hljs-type">T</span>&gt;
    )</span></span>: Continuation&lt;T&gt; = DispatchedContinuation(<span class="hljs-keyword">this</span>, continuation)
}

<span class="hljs-comment">/**
 * Dispatchers.Default å®ç°
 */</span>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">object</span> DefaultScheduler : SchedulerCoroutineDispatcher() {
    <span class="hljs-comment">// ä½¿ç”¨ CPU å¯†é›†å‹ä»»åŠ¡çš„çº¿ç¨‹æ± </span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> corePoolSize: <span class="hljs-built_in">Int</span>
        <span class="hljs-keyword">get</span>() = Runtime.getRuntime().availableProcessors() - <span class="hljs-number">1</span>

    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> maxPoolSize: <span class="hljs-built_in">Int</span>
        <span class="hljs-keyword">get</span>() = corePoolSize * <span class="hljs-number">128</span>

    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> idleWorkerKeepAliveNs: <span class="hljs-built_in">Long</span>
        <span class="hljs-keyword">get</span>() = <span class="hljs-number">60_000_000_000L</span> <span class="hljs-comment">// 60 ç§’</span>
}

<span class="hljs-comment">/**
 * Dispatchers.IO å®ç°
 */</span>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">object</span> IoScheduler : ExecutorCoroutineDispatcher() {
    <span class="hljs-comment">// ä½¿ç”¨ IO å¯†é›†å‹ä»»åŠ¡çš„çº¿ç¨‹æ± </span>
    <span class="hljs-comment">// æ”¯æŒæ›´å¤šçš„çº¿ç¨‹æ•°ï¼ˆæœ€å¤§ 64 ä¸ªæˆ–å†…æ ¸æ•°çš„å€æ•°ï¼‰</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> executor: Executor
        <span class="hljs-keyword">get</span>() = ThreadPoolExecutor(
            corePoolSize, maxPoolSize,
            <span class="hljs-number">60L</span>, TimeUnit.SECONDS,
            SynchronousQueue()
        )
}
</code></pre>
<p><strong>è°ƒåº¦å™¨å·¥ä½œåŸç†ï¼š</strong></p>
<ol>
<li>è°ƒåº¦å™¨æ‹¦æˆª <code>Continuation</code></li>
<li>ä½¿ç”¨ <code>dispatch</code> æ–¹æ³•å°† Runnable åˆ†å‘åˆ°çº¿ç¨‹æ± </li>
<li>åœ¨ç›®æ ‡çº¿ç¨‹æ‰§è¡Œ <code>Continuation.resumeWith</code></li>
</ol>
<h4 data-id="heading-26">6. withContext å®ç°åŸç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * withContext æºç ï¼ˆç®€åŒ–ï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">withContext</span><span class="hljs-params">(
    context: <span class="hljs-type">CoroutineContext</span>,
    block: <span class="hljs-type">suspend</span> <span class="hljs-type">CoroutineScope</span>.() -&gt; <span class="hljs-type">T</span>
)</span></span>: T {
    <span class="hljs-comment">// 1. ä¿å­˜æ—§ä¸Šä¸‹æ–‡</span>
    <span class="hljs-keyword">val</span> oldContext = coroutineContext

    <span class="hljs-comment">// 2. åˆ›å»ºæ–°ä¸Šä¸‹æ–‡</span>
    <span class="hljs-keyword">val</span> newContext = newCoroutineContext(oldContext, context)

    <span class="hljs-comment">// 3. æ£€æŸ¥æ˜¯å¦éœ€è¦åˆ‡æ¢çº¿ç¨‹</span>
    <span class="hljs-keyword">if</span> (newContext.dispatcher == oldContext.dispatcher) {
        <span class="hljs-comment">// åŒä¸€è°ƒåº¦å™¨ï¼Œç›´æ¥æ‰§è¡Œ</span>
        <span class="hljs-keyword">return</span> block.startCoroutineCancellable(<span class="hljs-keyword">this</span>, newContext)
    }

    <span class="hljs-comment">// 4. åˆ‡æ¢è°ƒåº¦å™¨å¹¶æ‰§è¡Œ</span>
    <span class="hljs-keyword">return</span> suspendCoroutineUninterceptedOrReturn { uCont -&gt;
        <span class="hljs-keyword">val</span> dispatcher = newContext.dispatcher
        <span class="hljs-keyword">val</span> dispatch = dispatcher.isDispatchNeeded(newContext)

        <span class="hljs-keyword">if</span> (dispatch) {
            <span class="hljs-comment">// åˆ†å‘åˆ°æ–°çº¿ç¨‹</span>
            dispatcher.dispatch(newContext) {
                block.startCoroutineCancellable(uCont.intercepted(), newContext)
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// ç›´æ¥æ‰§è¡Œ</span>
            block.startCoroutineCancellable(uCont.intercepted(), newContext)
        }
    }
}
</code></pre>
<p><strong>withContext vs async/awaitï¼š</strong></p>
<ul>
<li><code>withContext</code>ï¼šæŒ‚èµ·å½“å‰åç¨‹ï¼Œæ‰§è¡Œå®Œåæ¢å¤ï¼ˆæ›´è½»é‡ï¼‰</li>
<li><code>async/await</code>ï¼šåˆ›å»ºæ–°çš„åç¨‹å¹¶å‘æ‰§è¡Œ</li>
</ul>
<h4 data-id="heading-27">7. åç¨‹å–æ¶ˆæœºåˆ¶</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * åç¨‹å–æ¶ˆçš„æ ¸å¿ƒï¼šåä½œå¼å–æ¶ˆ
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractCoroutine</span>&lt;<span class="hljs-type">in T</span>&gt; ... {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">cancel</span><span class="hljs-params">(cause: <span class="hljs-type">CancellationException</span>?)</span></span> {
        <span class="hljs-comment">// 1. æ ‡è®°ä¸ºå–æ¶ˆçŠ¶æ€</span>
        _state.compareAndSet(ACTIVE, COMPLETING)

        <span class="hljs-comment">// 2. é€šçŸ¥å­åç¨‹å–æ¶ˆ</span>
        cancelChildren()

        <span class="hljs-comment">// 3. æ‰§è¡Œå–æ¶ˆå›è°ƒ</span>
        handleCancellationException(cause)
    }
}

<span class="hljs-comment">/**
 * æŒ‚èµ·å‡½æ•°æ£€æŸ¥å–æ¶ˆçŠ¶æ€
 */</span>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">yieldIfNeed</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// æ¯æ¬¡æŒ‚èµ·æ¢å¤æ—¶æ£€æŸ¥</span>
    Thread.currentThread().let { thread -&gt;
        <span class="hljs-keyword">if</span> (thread.isInterrupted) {
            <span class="hljs-keyword">throw</span> CancellationException(<span class="hljs-string">"Thread interrupted"</span>)
        }
    }
}

<span class="hljs-comment">/**
 * æŒ‚èµ·ç‚¹è‡ªåŠ¨æ£€æŸ¥å–æ¶ˆ
 */</span>
<span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">delay</span><span class="hljs-params">(time: <span class="hljs-type">Long</span>)</span></span> {
    <span class="hljs-comment">// delay å†…éƒ¨ä¼šæ£€æŸ¥åç¨‹æ˜¯å¦è¢«å–æ¶ˆ</span>
    <span class="hljs-keyword">return</span> suspendCancellableCoroutine { cont -&gt;
        cont.context.ensureActive()
        <span class="hljs-comment">// ... å®é™…å»¶è¿Ÿé€»è¾‘</span>
    }
}
</code></pre>
<p><strong>å–æ¶ˆçš„å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>åç¨‹å–æ¶ˆæ˜¯åä½œå¼çš„ï¼Œéœ€è¦ä¸»åŠ¨æ£€æŸ¥</li>
<li>æ‰€æœ‰æŒ‚èµ·å‡½æ•°ä¼šè‡ªåŠ¨æ£€æŸ¥å–æ¶ˆçŠ¶æ€</li>
<li>ä½¿ç”¨ <code>ensureActive()</code> æˆ– <code>yield()</code> åœ¨è®¡ç®—å¯†é›†ä»£ç ä¸­æ£€æŸ¥</li>
</ul>
<hr/>
<h2 data-id="heading-28">ç¬¬äºŒéƒ¨åˆ†ï¼šKotlin Flow</h2>
<h3 data-id="heading-29">Flow åŸºç¡€</h3>
<h4 data-id="heading-30">ä»€ä¹ˆæ˜¯ Flowï¼Ÿ</h4>
<p>Flow æ˜¯ Kotlin åç¨‹åº“ä¸­ç”¨äºå¤„ç†å¼‚æ­¥æ•°æ®æµçš„ APIã€‚å®ƒä»£è¡¨ä¸€ä¸ªå¯ä»¥å¼‚æ­¥å‘å‡ºçš„å€¼åºåˆ—ã€‚</p>
<h4 data-id="heading-31">Flow çš„ç‰¹ç‚¹</h4>
<ol>
<li><strong>å†·æµï¼ˆCold Streamï¼‰</strong>ï¼šåªæœ‰åœ¨æ”¶é›†æ—¶æ‰ä¼šå¼€å§‹å‘å°„æ•°æ®</li>
<li><strong>å“åº”å¼</strong>ï¼šæ”¯æŒå¤šä¸ªæ“ä½œç¬¦è¿›è¡Œæ•°æ®è½¬æ¢</li>
<li><strong>èƒŒå‹æ”¯æŒ</strong>ï¼šå¤©ç„¶æ”¯æŒèƒŒå‹ï¼Œä¸éœ€è¦ç‰¹æ®Šå¤„ç†</li>
<li><strong>åç¨‹å‹å¥½</strong>ï¼šä¸åç¨‹æ·±åº¦é›†æˆï¼Œæ”¯æŒæŒ‚èµ·å‡½æ•°</li>
</ol>
<h4 data-id="heading-32">Flow åŸºæœ¬ç»“æ„</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Flow çš„ä¸‰éƒ¨åˆ†ï¼š</span>
<span class="hljs-comment">// 1. ä¸Šæ¸¸ï¼ˆUpstreamï¼‰ï¼šæ•°æ®ç”Ÿäº§è€…</span>
<span class="hljs-comment">// 2. ä¸­é—´æ“ä½œç¬¦ï¼ˆIntermediate Operatorsï¼‰ï¼šæ•°æ®è½¬æ¢</span>
<span class="hljs-comment">// 3. ç»ˆç«¯æ“ä½œç¬¦ï¼ˆTerminal Operatorï¼‰ï¼šæ•°æ®æ¶ˆè´¹è€…</span>
</code></pre>
<hr/>
<h3 data-id="heading-33">Flow æ ¸å¿ƒæ¦‚å¿µ</h3>
<h4 data-id="heading-34">1. Flow çš„åŸºæœ¬åˆ›å»º</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.*

<span class="hljs-comment">/**
 * Flow åŸºç¡€ç¤ºä¾‹
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªç®€å•çš„ Flow</span>
    <span class="hljs-keyword">val</span> flow: Flow&lt;<span class="hljs-built_in">Int</span>&gt; = flow {
        <span class="hljs-comment">// ä¸Šæ¸¸ï¼šå‘å°„æ•°æ®</span>
        emit(<span class="hljs-number">1</span>)
        emit(<span class="hljs-number">2</span>)
        emit(<span class="hljs-number">3</span>)
    }

    <span class="hljs-comment">// æ”¶é›† Flow</span>
    flow.collect { value -&gt;
        <span class="hljs-comment">// ç»ˆç«¯æ“ä½œï¼šæ¶ˆè´¹æ•°æ®</span>
        println(<span class="hljs-string">"æ”¶åˆ°: <span class="hljs-variable">$value</span>"</span>)
    }
}
</code></pre>
<h4 data-id="heading-35">2. Flow çš„å†·æµç‰¹æ€§</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.*

<span class="hljs-comment">/**
 * å†·æµç‰¹æ€§ï¼šåªæœ‰è¢« collect æ—¶æ‰ä¼šå¼€å§‹å‘å°„
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// åˆ›å»º Flowï¼ˆæ­¤æ—¶ä¸ä¼šæ‰§è¡Œï¼‰</span>
    <span class="hljs-keyword">val</span> flow = flow {
        println(<span class="hljs-string">"å¼€å§‹å‘å°„æ•°æ®"</span>)
        emit(<span class="hljs-number">1</span>)
        delay(<span class="hljs-number">100</span>)
        emit(<span class="hljs-number">2</span>)
    }

    println(<span class="hljs-string">"Flow å·²åˆ›å»º"</span>)

    delay(<span class="hljs-number">1000</span>)

    <span class="hljs-comment">// ç¬¬ä¸€æ¬¡æ”¶é›†</span>
    println(<span class="hljs-string">"ç¬¬ä¸€æ¬¡æ”¶é›†"</span>)
    flow.collect { println(<span class="hljs-string">"æ”¶é›†å™¨1: <span class="hljs-variable">$it</span>"</span>) }

    <span class="hljs-comment">// ç¬¬äºŒæ¬¡æ”¶é›†ï¼ˆä¼šé‡æ–°æ‰§è¡Œï¼‰</span>
    println(<span class="hljs-string">"ç¬¬äºŒæ¬¡æ”¶é›†"</span>)
    flow.collect { println(<span class="hljs-string">"æ”¶é›†å™¨2: <span class="hljs-variable">$it</span>"</span>) }
}
</code></pre>
<h4 data-id="heading-36">3. Flow æ“ä½œç¬¦</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.*

<span class="hljs-comment">/**
 * Flow å¸¸ç”¨æ“ä½œç¬¦
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    flow {
        emit(<span class="hljs-number">1</span>)
        emit(<span class="hljs-number">2</span>)
        emit(<span class="hljs-number">3</span>)
        emit(<span class="hljs-number">4</span>)
    }
    <span class="hljs-comment">// ä¸­é—´æ“ä½œç¬¦ï¼ˆè½¬æ¢ï¼‰</span>
    .filter { it % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> }      <span class="hljs-comment">// è¿‡æ»¤å¶æ•°</span>
    .map { it * <span class="hljs-number">2</span> }              <span class="hljs-comment">// ä¹˜ä»¥ 2</span>
    .take(<span class="hljs-number">2</span>)                     <span class="hljs-comment">// åªå–å‰ä¸¤ä¸ª</span>
    .onEach { println(<span class="hljs-string">"å¤„ç†: <span class="hljs-variable">$it</span>"</span>) }
    <span class="hljs-comment">// ç»ˆç«¯æ“ä½œç¬¦ï¼ˆæ¶ˆè´¹ï¼‰</span>
    .collect { value -&gt;
        println(<span class="hljs-string">"æœ€ç»ˆç»“æœ: <span class="hljs-variable">$value</span>"</span>)
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-37">Flow ç¤ºä¾‹ä»£ç </h3>
<h4 data-id="heading-38">ç¤ºä¾‹ 1ï¼šåŸºç¡€ Flow ä½¿ç”¨</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.*

<span class="hljs-comment">/**
 * åŸºç¡€ Flow ç¤ºä¾‹
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// æ–¹å¼1ï¼šä½¿ç”¨ flow æ„å»ºå™¨</span>
    <span class="hljs-keyword">val</span> numbers = flow {
        <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1.</span><span class="hljs-number">.5</span>) {
            delay(<span class="hljs-number">100</span>)
            emit(i) <span class="hljs-comment">// å‘å°„å€¼</span>
        }
    }

    <span class="hljs-comment">// æ”¶é›†æ•°æ®</span>
    numbers.collect { value -&gt;
        println(<span class="hljs-string">"æ”¶åˆ°: <span class="hljs-variable">$value</span>"</span>)
    }

    <span class="hljs-comment">// æ–¹å¼2ï¼šä½¿ç”¨ flowOf</span>
    flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
        .collect { println(<span class="hljs-string">"flowOf: <span class="hljs-variable">$it</span>"</span>) }

    <span class="hljs-comment">// æ–¹å¼3ï¼šä½¿ç”¨ asFlow</span>
    listOf(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>).asFlow()
        .collect { println(<span class="hljs-string">"asFlow: <span class="hljs-variable">$it</span>"</span>) }
}
</code></pre>
<h4 data-id="heading-39">ç¤ºä¾‹ 2ï¼šFlow è½¬æ¢æ“ä½œç¬¦</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.*

<span class="hljs-comment">/**
 * Flow è½¬æ¢æ“ä½œç¬¦
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    flow {
        emit(<span class="hljs-number">1</span>)
        emit(<span class="hljs-number">2</span>)
        emit(<span class="hljs-number">3</span>)
    }
    .map { it * <span class="hljs-number">2</span> }              <span class="hljs-comment">// è½¬æ¢ï¼š[2, 4, 6]</span>
    .filter { it &gt; <span class="hljs-number">2</span> }           <span class="hljs-comment">// è¿‡æ»¤ï¼š[4, 6]</span>
    .transform { value -&gt;
        emit(<span class="hljs-string">"å‰ç¼€: <span class="hljs-variable">$value</span>"</span>)    <span class="hljs-comment">// å‘å°„å¤šä¸ªå€¼</span>
        emit(<span class="hljs-string">"åç¼€: <span class="hljs-variable">$value</span>"</span>)
    }
    .collect { println(<span class="hljs-string">"ç»“æœ: <span class="hljs-variable">$it</span>"</span>) }
}
</code></pre>
<h4 data-id="heading-40">ç¤ºä¾‹ 3ï¼šFlow é™æµæ“ä½œç¬¦</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.*

<span class="hljs-comment">/**
 * é™æµæ“ä½œç¬¦
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// debounceï¼šé˜²æŠ–ï¼Œåªåœ¨é™é»˜ä¸€æ®µæ—¶é—´åå‘å°„æœ€æ–°å€¼</span>
    flow {
        emit(<span class="hljs-number">1</span>)
        delay(<span class="hljs-number">100</span>)
        emit(<span class="hljs-number">2</span>)
        delay(<span class="hljs-number">100</span>)
        emit(<span class="hljs-number">3</span>)
        delay(<span class="hljs-number">1000</span>) <span class="hljs-comment">// é™é»˜è¶³å¤Ÿé•¿</span>
        emit(<span class="hljs-number">4</span>)
    }
    .debounce(<span class="hljs-number">500</span>)
    .collect { println(<span class="hljs-string">"debounce: <span class="hljs-variable">$it</span>"</span>) }

    <span class="hljs-comment">// sampleï¼šé‡‡æ ·ï¼ŒæŒ‰å›ºå®šæ—¶é—´é—´éš”é‡‡æ ·</span>
    flow {
        repeat(<span class="hljs-number">10</span>) {
            emit(it)
            delay(<span class="hljs-number">100</span>)
        }
    }
    .sample(<span class="hljs-number">300</span>)
    .collect { println(<span class="hljs-string">"sample: <span class="hljs-variable">$it</span>"</span>) }

    <span class="hljs-comment">// throttleFirstï¼šèŠ‚æµï¼Œåœ¨æ—¶é—´çª—å£å†…åªå‘å°„ç¬¬ä¸€ä¸ªå€¼</span>
    flow {
        repeat(<span class="hljs-number">10</span>) {
            emit(it)
            delay(<span class="hljs-number">100</span>)
        }
    }
    .debounce(<span class="hljs-number">50</span>)
    .collect { println(<span class="hljs-string">"throttle: <span class="hljs-variable">$it</span>"</span>) }
}
</code></pre>
<h4 data-id="heading-41">ç¤ºä¾‹ 4ï¼šFlow çš„å¼‚å¸¸å¤„ç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.*

<span class="hljs-comment">/**
 * Flow å¼‚å¸¸å¤„ç†
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// æ–¹å¼1ï¼štry-catch</span>
    <span class="hljs-keyword">try</span> {
        flow {
            emit(<span class="hljs-number">1</span>)
            <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"é”™è¯¯"</span>)
        }
        .collect { println(it) }
    } <span class="hljs-keyword">catch</span> (e: Exception) {
        println(<span class="hljs-string">"æ•è·: <span class="hljs-subst">${e.message}</span>"</span>)
    }

    <span class="hljs-comment">// æ–¹å¼2ï¼šcatch æ“ä½œç¬¦</span>
    flow {
        emit(<span class="hljs-number">1</span>)
        <span class="hljs-keyword">throw</span> IllegalStateException(<span class="hljs-string">"é”™è¯¯2"</span>)
    }
    .<span class="hljs-keyword">catch</span> { e -&gt;
        println(<span class="hljs-string">"catch æ“ä½œç¬¦: <span class="hljs-subst">${e.message}</span>"</span>)
        emit(<span class="hljs-number">0</span>) <span class="hljs-comment">// å‘å°„é»˜è®¤å€¼</span>
    }
    .collect { println(<span class="hljs-string">"æ¢å¤: <span class="hljs-variable">$it</span>"</span>) }

    <span class="hljs-comment">// æ–¹å¼3ï¼šonCompletion</span>
    flow {
        emit(<span class="hljs-number">1</span>)
        emit(<span class="hljs-number">2</span>)
    }
    .onCompletion { cause -&gt;
        println(<span class="hljs-string">"å®Œæˆï¼Œå¼‚å¸¸: <span class="hljs-variable">$cause</span>"</span>)
    }
    .collect { println(it) }
}
</code></pre>
<h4 data-id="heading-42">ç¤ºä¾‹ 5ï¼šFlow çš„å®Œæˆå¤„ç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.*

<span class="hljs-comment">/**
 * Flow å®Œæˆå¤„ç†
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    flow {
        emit(<span class="hljs-number">1</span>)
        emit(<span class="hljs-number">2</span>)
        <span class="hljs-comment">// emit(3)</span>
    }
    .onEach { println(<span class="hljs-string">"å‘å°„: <span class="hljs-variable">$it</span>"</span>) }
    .onEmpty { println(<span class="hljs-string">"æµä¸ºç©º"</span>) }        <span class="hljs-comment">// æµä¸ºç©ºæ—¶è°ƒç”¨</span>
    .onStart { println(<span class="hljs-string">"å¼€å§‹æ”¶é›†"</span>) }       <span class="hljs-comment">// æ”¶é›†å¼€å§‹æ—¶è°ƒç”¨</span>
    .onCompletion { cause -&gt;
        println(<span class="hljs-string">"æ”¶é›†å®Œæˆï¼Œå¼‚å¸¸: <span class="hljs-variable">$cause</span>"</span>)  <span class="hljs-comment">// æ”¶é›†å®Œæˆæ—¶è°ƒç”¨</span>
    }
    .collect { println(<span class="hljs-string">"æ”¶åˆ°: <span class="hljs-variable">$it</span>"</span>) }
}
</code></pre>
<h4 data-id="heading-43">ç¤ºä¾‹ 6ï¼šFlow çš„çº¿ç¨‹åˆ‡æ¢</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.*

<span class="hljs-comment">/**
 * Flow çº¿ç¨‹åˆ‡æ¢ï¼šflowOn
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    flow {
        <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1.</span><span class="hljs-number">.3</span>) {
            println(<span class="hljs-string">"ä¸Šæ¸¸: <span class="hljs-subst">${Thread.currentThread().name}</span>"</span>)
            emit(i)
        }
    }
    .flowOn(Dispatchers.Default) <span class="hljs-comment">// ä¸Šæ¸¸åœ¨ Default çº¿ç¨‹</span>
    .map { value -&gt;
        println(<span class="hljs-string">"map: <span class="hljs-subst">${Thread.currentThread().name}</span>"</span>)
        value * <span class="hljs-number">2</span>
    }
    .flowOn(Dispatchers.IO) <span class="hljs-comment">// map åœ¨ IO çº¿ç¨‹</span>
    .collect { value -&gt;
        println(<span class="hljs-string">"ä¸‹æ¸¸: <span class="hljs-subst">${Thread.currentThread().name}</span>, å€¼: <span class="hljs-variable">$value</span>"</span>)
    }
    <span class="hljs-comment">// ä¸‹æ¸¸ç»§æ‰¿ä¸»åç¨‹çš„ä¸Šä¸‹æ–‡ï¼ˆMain çº¿ç¨‹ï¼‰</span>
}
</code></pre>
<h4 data-id="heading-44">ç¤ºä¾‹ 7ï¼šFlow çš„ç¼“å†²ä¸èƒŒå‹</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.*

<span class="hljs-comment">/**
 * Flow èƒŒå‹å¤„ç†
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// bufferï¼šç¼“å†²åŒºï¼Œä¸Šæ¸¸å¯ä»¥å¿«é€Ÿå‘å°„</span>
    <span class="hljs-keyword">val</span> time = measureTimeMillis {
        flow {
            repeat(<span class="hljs-number">5</span>) {
                delay(<span class="hljs-number">100</span>)
                emit(it)
                println(<span class="hljs-string">"å‘å°„: <span class="hljs-variable">$it</span>"</span>)
            }
        }
        .buffer(capacity = <span class="hljs-number">3</span>) <span class="hljs-comment">// ç¼“å†²åŒºå¤§å°ä¸º 3</span>
        .collect { value -&gt;
            delay(<span class="hljs-number">300</span>) <span class="hljs-comment">// æ¶ˆè´¹è¾ƒæ…¢</span>
            println(<span class="hljs-string">"æ¶ˆè´¹: <span class="hljs-variable">$value</span>"</span>)
        }
    }
    println(<span class="hljs-string">"æ€»è€—æ—¶: <span class="hljs-subst">${time}</span>ms"</span>)

    <span class="hljs-comment">// conflateï¼šåªä¿ç•™æœ€æ–°çš„å€¼ï¼Œä¸­é—´å€¼ä¼šè¢«ä¸¢å¼ƒ</span>
    flow {
        repeat(<span class="hljs-number">10</span>) {
            delay(<span class="hljs-number">50</span>)
            emit(it)
        }
    }
    .conflate()
    .collect { value -&gt;
        delay(<span class="hljs-number">200</span>)
        println(<span class="hljs-string">"conflate: <span class="hljs-variable">$value</span>"</span>)
    }

    <span class="hljs-comment">// collectLatestï¼šæ”¶åˆ°æ–°å€¼æ—¶å–æ¶ˆä¹‹å‰çš„å¤„ç†</span>
    flow {
        repeat(<span class="hljs-number">10</span>) {
            delay(<span class="hljs-number">50</span>)
            emit(it)
        }
    }
    .collectLatest { value -&gt;
        println(<span class="hljs-string">"å¼€å§‹å¤„ç†: <span class="hljs-variable">$value</span>"</span>)
        delay(<span class="hljs-number">200</span>)
        println(<span class="hljs-string">"å®Œæˆå¤„ç†: <span class="hljs-variable">$value</span>"</span>)
    }
}
</code></pre>
<h4 data-id="heading-45">ç¤ºä¾‹ 8ï¼šFlow çš„ç»„åˆ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.*

<span class="hljs-comment">/**
 * Flow ç»„åˆæ“ä½œç¬¦
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// zipï¼šç»„åˆä¸¤ä¸ªæµï¼Œç­‰å¾…ä¸¤è€…éƒ½å‘å°„</span>
    <span class="hljs-keyword">val</span> flow1 = flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>).onEach { delay(<span class="hljs-number">100</span>) }
    <span class="hljs-keyword">val</span> flow2 = flowOf(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>).onEach { delay(<span class="hljs-number">150</span>) }

    flow1.zip(flow2) { a, b -&gt; <span class="hljs-string">"<span class="hljs-variable">$a</span> -&gt; <span class="hljs-variable">$b</span>"</span> }
        .collect { println(<span class="hljs-string">"zip: <span class="hljs-variable">$it</span>"</span>) }

    <span class="hljs-comment">// combineï¼šä»»æ„æµå‘å°„æ—¶éƒ½ç»„åˆ</span>
    flow1.combine(flow2) { a, b -&gt; <span class="hljs-string">"<span class="hljs-variable">$a</span> -&gt; <span class="hljs-variable">$b</span>"</span> }
        .collect { println(<span class="hljs-string">"combine: <span class="hljs-variable">$it</span>"</span>) }

    <span class="hljs-comment">// mergeï¼šåˆå¹¶å¤šä¸ªæµ</span>
    merge(
        flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>),
        flowOf(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)
    )
    .collect { println(<span class="hljs-string">"merge: <span class="hljs-variable">$it</span>"</span>) }

    <span class="hljs-comment">// flatMapConcatï¼šé¡ºåºå±•å¹³</span>
    flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
        .flatMapConcat { value -&gt;
            flowOf(<span class="hljs-string">"<span class="hljs-variable">$value</span>-a"</span>, <span class="hljs-string">"<span class="hljs-variable">$value</span>-b"</span>)
        }
        .collect { println(<span class="hljs-string">"flatMapConcat: <span class="hljs-variable">$it</span>"</span>) }

    <span class="hljs-comment">// flatMapMergeï¼šå¹¶å‘å±•å¹³</span>
    flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
        .flatMapMerge { value -&gt;
            flowOf(<span class="hljs-string">"<span class="hljs-variable">$value</span>-a"</span>, <span class="hljs-string">"<span class="hljs-variable">$value</span>-b"</span>)
        }
        .collect { println(<span class="hljs-string">"flatMapMerge: <span class="hljs-variable">$it</span>"</span>) }

    <span class="hljs-comment">// flatMapLatestï¼šå–æ¶ˆä¹‹å‰çš„å±•å¹³</span>
    flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
        .onEach { delay(<span class="hljs-number">100</span>) }
        .flatMapLatest { value -&gt;
            flow {
                emit(value)
                delay(<span class="hljs-number">150</span>)
                emit(value + <span class="hljs-number">10</span>)
            }
        }
        .collect { println(<span class="hljs-string">"flatMapLatest: <span class="hljs-variable">$it</span>"</span>) }
}
</code></pre>
<h4 data-id="heading-46">ç¤ºä¾‹ 9ï¼šStateFlow ä¸ SharedFlow</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.*

<span class="hljs-comment">/**
 * StateFlowï¼šçŠ¶æ€æŒæœ‰æµ
 * ç‰¹ç‚¹ï¼š
 * 1. å§‹ç»ˆæœ‰å€¼
 * 2. æ–°è®¢é˜…è€…ä¼šç«‹å³æ”¶åˆ°æœ€æ–°å€¼
 * 3. åªæœ‰å€¼å˜åŒ–æ—¶æ‰ä¼šå‘å°„ï¼ˆå»é‡ï¼‰
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">StateFlowExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _state = MutableStateFlow(<span class="hljs-number">0</span>)
    <span class="hljs-keyword">val</span> state: StateFlow&lt;<span class="hljs-built_in">Int</span>&gt; = _state

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">increment</span><span class="hljs-params">()</span></span> {
        _state.value++
    }
}

<span class="hljs-comment">/**
 * SharedFlowï¼šäº‹ä»¶æµ
 * ç‰¹ç‚¹ï¼š
 * 1. ä¸æŒæœ‰åˆå§‹å€¼
 * 2. å¯ä»¥é…ç½®é‡æ”¾æ•°é‡å’Œç¼“å†²åŒºå¤§å°
 * 3. é€‚åˆäº‹ä»¶åœºæ™¯
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SharedFlowExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _events = MutableSharedFlow&lt;<span class="hljs-built_in">Int</span>&gt;(
        replay = <span class="hljs-number">1</span>,              <span class="hljs-comment">// é‡æ”¾æ•°é‡</span>
        onBufferOverflow = BufferOverflow.DROP_OLDEST <span class="hljs-comment">// ç¼“å†²ç­–ç•¥</span>
    )
    <span class="hljs-keyword">val</span> events: SharedFlow&lt;<span class="hljs-built_in">Int</span>&gt; = _events

    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendEvent</span><span class="hljs-params">(value: <span class="hljs-type">Int</span>)</span></span> {
        _events.emit(value)
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// StateFlow ç¤ºä¾‹</span>
    <span class="hljs-keyword">val</span> stateFlow = MutableStateFlow(<span class="hljs-number">0</span>)

    launch {
        stateFlow.collect { value -&gt;
            println(<span class="hljs-string">"StateFlow æ”¶åˆ°: <span class="hljs-variable">$value</span>"</span>)
        }
    }

    delay(<span class="hljs-number">100</span>)
    stateFlow.value = <span class="hljs-number">1</span>
    stateFlow.value = <span class="hljs-number">2</span>
    stateFlow.value = <span class="hljs-number">2</span> <span class="hljs-comment">// é‡å¤å€¼ä¸ä¼šå‘å°„</span>

    <span class="hljs-comment">// SharedFlow ç¤ºä¾‹</span>
    <span class="hljs-keyword">val</span> sharedFlow = MutableSharedFlow&lt;<span class="hljs-built_in">Int</span>&gt;(
        replay = <span class="hljs-number">2</span>
    )

    <span class="hljs-comment">// å…ˆå‘é€ä¸€äº›å€¼</span>
    sharedFlow.emit(<span class="hljs-number">1</span>)
    sharedFlow.emit(<span class="hljs-number">2</span>)

    delay(<span class="hljs-number">100</span>)

    <span class="hljs-comment">// æ–°è®¢é˜…è€…ä¼šæ”¶åˆ° replay çš„å€¼</span>
    launch {
        sharedFlow.collect { value -&gt;
            println(<span class="hljs-string">"SharedFlow æ”¶åˆ°: <span class="hljs-variable">$value</span>"</span>)
        }
    }

    delay(<span class="hljs-number">100</span>)
    sharedFlow.emit(<span class="hljs-number">3</span>)
}
</code></pre>
<h4 data-id="heading-47">ç¤ºä¾‹ 10ï¼šFlow çš„ç»ˆç«¯æ“ä½œç¬¦</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.*

<span class="hljs-comment">/**
 * Flow ç»ˆç«¯æ“ä½œç¬¦
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// toListï¼šæ”¶é›†ä¸ºåˆ—è¡¨</span>
    <span class="hljs-keyword">val</span> list = flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>).toList()
    println(<span class="hljs-string">"toList: <span class="hljs-variable">$list</span>"</span>)

    <span class="hljs-comment">// toSetï¼šæ”¶é›†ä¸ºé›†åˆ</span>
    <span class="hljs-keyword">val</span> <span class="hljs-keyword">set</span> = flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>).toSet()
    println(<span class="hljs-string">"toSet: <span class="hljs-variable">$set</span>"</span>)

    <span class="hljs-comment">// firstï¼šå–ç¬¬ä¸€ä¸ªå€¼</span>
    <span class="hljs-keyword">val</span> first = flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>).first()
    println(<span class="hljs-string">"first: <span class="hljs-variable">$first</span>"</span>)

    <span class="hljs-comment">// singleï¼šç¡®ä¿åªæœ‰ä¸€ä¸ªå€¼</span>
    <span class="hljs-keyword">val</span> single = flowOf(<span class="hljs-number">42</span>).single()
    println(<span class="hljs-string">"single: <span class="hljs-variable">$single</span>"</span>)

    <span class="hljs-comment">// reduceï¼šå½’çº¦</span>
    <span class="hljs-keyword">val</span> sum = flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>).reduce { acc, value -&gt; acc + value }
    println(<span class="hljs-string">"reduce sum: <span class="hljs-variable">$sum</span>"</span>)

    <span class="hljs-comment">// foldï¼šå¸¦åˆå§‹å€¼çš„å½’çº¦</span>
    <span class="hljs-keyword">val</span> product = flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>).fold(<span class="hljs-number">1</span>) { acc, value -&gt; acc * value }
    println(<span class="hljs-string">"fold product: <span class="hljs-variable">$product</span>"</span>)

    <span class="hljs-comment">// collectï¼šæ”¶é›†æ‰€æœ‰å€¼</span>
    flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>).collect { println(<span class="hljs-string">"collect: <span class="hljs-variable">$it</span>"</span>) }

    <span class="hljs-comment">// launchInï¼šåœ¨åç¨‹ä½œç”¨åŸŸä¸­æ”¶é›†</span>
    flow {
        repeat(<span class="hljs-number">3</span>) {
            delay(<span class="hljs-number">100</span>)
            emit(it)
        }
    }
    .onEach { println(<span class="hljs-string">"launchIn: <span class="hljs-variable">$it</span>"</span>) }
    .launchIn(<span class="hljs-keyword">this</span>) <span class="hljs-comment">// åœ¨ this ä½œç”¨åŸŸä¸­å¯åŠ¨</span>
}
</code></pre>
<hr/>
<h3 data-id="heading-48">Flow æºç è§£æ</h3>
<h4 data-id="heading-49">1. Flow æ¥å£å®šä¹‰</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * Flow æ¥å£å®šä¹‰
 * Flow æ˜¯ä¸€ä¸ªå†·æµï¼Œåªæœ‰åœ¨æ”¶é›†æ—¶æ‰ä¼šæ‰§è¡Œ
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Flow</span>&lt;<span class="hljs-type">out T</span>&gt; {
    <span class="hljs-comment">/**
     * æ”¶é›†æµå‘å‡ºçš„å€¼
     * <span class="hljs-doctag">@param</span> collector æ”¶é›†å™¨ï¼Œæ¥æ”¶å‘å‡ºçš„å€¼
     */</span>
    <span class="hljs-meta">@Suppress(<span class="hljs-string">"UNCHECKED_CAST"</span>)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">collect</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>
}

<span class="hljs-comment">/**
 * FlowCollector æ¥å£
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">FlowCollector</span>&lt;<span class="hljs-type">in T</span>&gt; {
    <span class="hljs-comment">/**
     * å‘å°„ä¸€ä¸ªå€¼åˆ°æµ
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">emit</span><span class="hljs-params">(value: <span class="hljs-type">T</span>)</span></span>
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>Flow æ¥å£åªæœ‰ä¸€ä¸ª <code>collect</code> æ–¹æ³•</li>
<li>Flow æ˜¯åªè¯»çš„ï¼Œä¸æ”¯æŒå‘å°„æ“ä½œ</li>
<li>ä½¿ç”¨å†·æµæ¨¡å¼ï¼šä¸æ”¶é›†ä¸æ‰§è¡Œ</li>
</ul>
<h4 data-id="heading-50">2. flow æ„å»ºå™¨å®ç°</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * flow æ„å»ºå™¨å®ç°
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">flow</span><span class="hljs-params">(
    <span class="hljs-meta">@BuilderInference</span> block: <span class="hljs-type">suspend</span> <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;.() -&gt; <span class="hljs-type">Unit</span>
)</span></span>: Flow&lt;T&gt; = SafeFlow(block)

<span class="hljs-comment">/**
 * SafeFlow å†…éƒ¨å®ç°
 */</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeFlow</span>&lt;<span class="hljs-type">T</span>&gt;(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> block: <span class="hljs-keyword">suspend</span> FlowCollector&lt;T&gt;.() -&gt; <span class="hljs-built_in">Unit</span>
) : AbstractFlow&lt;T&gt;() {

    <span class="hljs-comment">/**
     * collectSafely å®ç°å®é™…çš„æ”¶é›†é€»è¾‘
     */</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">collectSafely</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> {
        <span class="hljs-comment">// è°ƒç”¨ç”¨æˆ·å®šä¹‰çš„ blockï¼Œåœ¨ collector ä¸Šæ‰§è¡Œ</span>
        collector.block()
    }
}

<span class="hljs-comment">/**
 * AbstractFlow æŠ½è±¡ç±»
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractFlow</span>&lt;<span class="hljs-type">T</span>&gt; : <span class="hljs-type">Flow</span>&lt;<span class="hljs-type">T</span>&gt; {

    <span class="hljs-comment">/**
     * collect å®ç°
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">collect</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> {
        <span class="hljs-comment">// åˆ›å»ºæ”¶é›†ä¸Šä¸‹æ–‡</span>
        <span class="hljs-keyword">val</span> collectContext = collector <span class="hljs-keyword">as</span>? SafeCollector ?: error(<span class="hljs-string">"..."</span>)

        <span class="hljs-comment">// è°ƒç”¨å­ç±»å®ç°çš„ collectSafely</span>
        collectSafely(collector)
    }

    <span class="hljs-comment">/**
     * å­ç±»éœ€è¦å®ç°çš„å®‰å…¨æ”¶é›†æ–¹æ³•
     */</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">collectSafely</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>
}
</code></pre>
<p><strong>å·¥ä½œåŸç†ï¼š</strong></p>
<ul>
<li><code>flow { }</code> åˆ›å»ºä¸€ä¸ª <code>SafeFlow</code> å®ä¾‹</li>
<li><code>SafeFlow</code> ä¿å­˜ç”¨æˆ·æä¾›çš„ lambda</li>
<li>è°ƒç”¨ <code>collect</code> æ—¶æ‰§è¡Œ lambdaï¼Œå¼€å§‹å‘å°„æ•°æ®</li>
</ul>
<h4 data-id="heading-51">3. Flow æ“ä½œç¬¦é“¾å®ç°</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * æ“ä½œç¬¦é“¾çš„æ ¸å¿ƒï¼šæ¯ä¸ªæ“ä½œç¬¦éƒ½è¿”å›ä¸€ä¸ªæ–°çš„ Flow
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T, R&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">map</span><span class="hljs-params">(
    <span class="hljs-keyword">crossinline</span> transform: <span class="hljs-type">suspend</span> (<span class="hljs-type">value</span>: <span class="hljs-type">T</span>) -&gt; <span class="hljs-type">R</span>
)</span></span>: Flow&lt;R&gt; = flow {
    <span class="hljs-comment">// this æ˜¯ FlowCollector&lt;R&gt;ï¼ˆæ–°æµçš„ collectorï¼‰</span>
    collect { value -&gt;
        <span class="hljs-comment">// æ”¶é›†ä¸Šæ¸¸çš„å€¼</span>
        emit(transform(value)) <span class="hljs-comment">// è½¬æ¢åå‘å°„åˆ°æ–°æµ</span>
    }
}

<span class="hljs-comment">/**
 * filter æ“ä½œç¬¦å®ç°
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">filter</span><span class="hljs-params">(
    predicate: <span class="hljs-type">suspend</span> (<span class="hljs-type">T</span>) -&gt; <span class="hljs-type">Boolean</span>
)</span></span>: Flow&lt;T&gt; = flow {
    collect { value -&gt;
        <span class="hljs-keyword">if</span> (predicate(value)) {
            emit(value) <span class="hljs-comment">// ç¬¦åˆæ¡ä»¶æ‰å‘å°„</span>
        }
    }
}

<span class="hljs-comment">/**
 * ä½¿ç”¨ç¤ºä¾‹
 */</span>
<span class="hljs-keyword">val</span> flow = flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
    .map { it * <span class="hljs-number">2</span> }     <span class="hljs-comment">// è¿”å›æ–° Flow1</span>
    .filter { it &gt; <span class="hljs-number">2</span> }  <span class="hljs-comment">// è¿”å›æ–° Flow2</span>

<span class="hljs-comment">// ç­‰ä»·äºï¼š</span>
<span class="hljs-keyword">val</span> flow2 = flow {
    flowOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>).collect { value -&gt;
        <span class="hljs-keyword">val</span> transformed = value * <span class="hljs-number">2</span>
        <span class="hljs-keyword">if</span> (transformed &gt; <span class="hljs-number">2</span>) {
            emit(transformed)
        }
    }
}
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>æ¯ä¸ªæ“ä½œç¬¦åˆ›å»ºæ–°çš„ Flow å®ä¾‹</li>
<li>æ“ä½œç¬¦å†…éƒ¨é€šè¿‡ <code>collect</code> æ”¶é›†ä¸Šæ¸¸</li>
<li>è½¬æ¢åé€šè¿‡ <code>emit</code> å‘å°„åˆ°ä¸‹æ¸¸</li>
<li>å½¢æˆæ“ä½œç¬¦é“¾ï¼š<code>collect</code> é“¾å¼è°ƒç”¨</li>
</ul>
<h4 data-id="heading-52">4. flowOn çº¿ç¨‹åˆ‡æ¢åŸç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * flowOn å®ç°çº¿ç¨‹åˆ‡æ¢
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">flowOn</span><span class="hljs-params">(
    context: <span class="hljs-type">CoroutineContext</span>
)</span></span>: Flow&lt;T&gt; = flow {
    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªè°ƒåº¦å™¨</span>
    <span class="hljs-keyword">val</span> dispatcher = context[ContinuationInterceptor] <span class="hljs-keyword">as</span>? CoroutineDispatcher

    <span class="hljs-comment">// åœ¨ä¸Šæ¸¸ä½¿ç”¨æ–°ä¸Šä¸‹æ–‡æ”¶é›†</span>
    coroutineScope {
        <span class="hljs-comment">// åˆ‡æ¢åˆ°æŒ‡å®šä¸Šä¸‹æ–‡</span>
        withContext(context) {
            <span class="hljs-comment">// åœ¨æ–°çº¿ç¨‹ä¸­æ”¶é›†ä¸Šæ¸¸</span>
            <span class="hljs-keyword">this</span><span class="hljs-symbol">@flow</span>.collect { value -&gt;
                <span class="hljs-comment">// å‘å°„åˆ°ä¸‹æ¸¸ï¼ˆä¸‹æ¸¸åœ¨åŸæ¥çš„çº¿ç¨‹ï¼‰</span>
                emit(value)
            }
        }
    }
}

<span class="hljs-comment">/**
 * æ›´ç²¾ç¡®çš„å®ç°ï¼ˆç®€åŒ–ç‰ˆï¼‰
 */</span>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FlowOnFlow</span>&lt;<span class="hljs-type">T</span>&gt;(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> upstream: Flow&lt;T&gt;,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> context: CoroutineContext
) : Flow&lt;T&gt; {

    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">collect</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> {
        <span class="hljs-comment">// ä¸Šæ¸¸ä½¿ç”¨æ–°ä¸Šä¸‹æ–‡</span>
        upstream.collect(<span class="hljs-keyword">object</span> : FlowCollector&lt;T&gt; {
            <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">emit</span><span class="hljs-params">(value: <span class="hljs-type">T</span>)</span></span> {
                <span class="hljs-comment">// åˆ‡æ¢ä¸Šä¸‹æ–‡å‘å°„</span>
                withContext(context) {
                    collector.emit(value)
                }
            }
        })
    }
}
</code></pre>
<p><strong>flowOn å·¥ä½œåŸç†ï¼š</strong></p>
<ol>
<li><code>flowOn</code> åœ¨è°ƒç”¨ä½ç½®ä¹‹å‰çš„æ‰€æœ‰æ“ä½œç¬¦ä½¿ç”¨æ–°ä¸Šä¸‹æ–‡</li>
<li><code>flowOn</code> ä¹‹åçš„æ‰€æœ‰æ“ä½œç¬¦ä½¿ç”¨åŸä¸Šä¸‹æ–‡</li>
<li>é€šè¿‡ç¼“å†²æœºåˆ¶å®ç°ä¸Šä¸‹æ¸¸è§£è€¦</li>
</ol>
<h4 data-id="heading-53">5. èƒŒå‹å¤„ç†æœºåˆ¶</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * buffer æ“ä½œç¬¦å®ç°
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">buffer</span><span class="hljs-params">(
    capacity: <span class="hljs-type">Int</span> = BUFFERED
)</span></span>: Flow&lt;T&gt; = channelFlow {
    <span class="hljs-comment">// åˆ›å»º Channel ä½œä¸ºç¼“å†²åŒº</span>
    <span class="hljs-keyword">val</span> channel = Channel&lt;T&gt;(capacity)

    <span class="hljs-comment">// ä¸Šæ¸¸åç¨‹ï¼šå¿«é€Ÿå‘å°„åˆ° Channel</span>
    launch {
        collect { value -&gt;
            channel.send(value)
        }
        channel.close()
    }

    <span class="hljs-comment">// ä¸‹æ¸¸ï¼šä» Channel æ¥æ”¶</span>
    channel.consumeEach { value -&gt;
        send(value)
    }
}

<span class="hljs-comment">/**
 * conflate æ“ä½œç¬¦ï¼šåªä¿ç•™æœ€æ–°å€¼
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">conflate</span><span class="hljs-params">()</span></span>: Flow&lt;T&gt; = buffer(CONFLATED)

<span class="hljs-comment">/**
 * collectLatest æ“ä½œç¬¦ï¼šæ”¶åˆ°æ–°å€¼å–æ¶ˆæ—§çš„å¤„ç†
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">collectLatest</span><span class="hljs-params">(
    action: <span class="hljs-type">suspend</span> (<span class="hljs-type">value</span>: <span class="hljs-type">T</span>) -&gt; <span class="hljs-type">Unit</span>
)</span></span> = flow {
    <span class="hljs-comment">// å½“å‰ä»»åŠ¡çš„ Job</span>
    <span class="hljs-keyword">var</span> currentJob: Job? = <span class="hljs-literal">null</span>

    collect { value -&gt;
        <span class="hljs-comment">// å–æ¶ˆä¹‹å‰çš„ä»»åŠ¡</span>
        currentJob?.cancel()
        <span class="hljs-comment">// å¯åŠ¨æ–°ä»»åŠ¡</span>
        currentJob = launch {
            action(value)
        }
    }
}.collect()
</code></pre>
<p><strong>èƒŒå‹å¤„ç†ç­–ç•¥ï¼š</strong></p>
<ul>
<li><code>buffer</code>ï¼šç¼“å†²åŒºæ»¡æ—¶æŒ‚èµ·ä¸Šæ¸¸</li>
<li><code>conflate</code>ï¼šç¼“å†²åŒºæ»¡æ—¶ä¸¢å¼ƒæœ€æ—§çš„å€¼</li>
<li><code>collectLatest</code>ï¼šç¼“å†²åŒºæ»¡æ—¶å–æ¶ˆå½“å‰å¤„ç†</li>
</ul>
<h4 data-id="heading-54">6. SharedFlow å®ç°åŸç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * SharedFlow æ¥å£
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">SharedFlow</span>&lt;<span class="hljs-type">out T</span>&gt; : <span class="hljs-type">Flow</span>&lt;<span class="hljs-type">T</span>&gt; {
    <span class="hljs-keyword">val</span> replayCache: List&lt;T&gt;
}

<span class="hljs-comment">/**
 * MutableSharedFlow å®ç°
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">MutableSharedFlow</span>&lt;<span class="hljs-type">T</span>&gt; : <span class="hljs-type">SharedFlow</span>&lt;<span class="hljs-type">T</span>&gt;, <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">emit</span><span class="hljs-params">(value: <span class="hljs-type">T</span>)</span></span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">tryEmit</span><span class="hljs-params">(value: <span class="hljs-type">T</span>)</span></span>: <span class="hljs-built_in">Boolean</span>
}

<span class="hljs-comment">/**
 * SharedFlow å†…éƒ¨å®ç°ï¼ˆç®€åŒ–ï¼‰
 */</span>
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SharedFlowImpl</span>&lt;<span class="hljs-type">T</span>&gt;(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> replayCapacity: <span class="hljs-built_in">Int</span>,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> bufferCapacity: <span class="hljs-built_in">Int</span>,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> onBufferOverflow: BufferOverflow
) : MutableSharedFlow&lt;T&gt; {

    <span class="hljs-comment">// è®¢é˜…è€…åˆ—è¡¨</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> collectors = mutableListOf&lt;SharedFlowCollector&gt;()

    <span class="hljs-comment">// ç¼“å†²åŒº</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> buffer = ArrayDeque&lt;Any?&gt;()

    <span class="hljs-comment">// é‡æ”¾ç¼“å­˜</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> replayCache = ArrayDeque&lt;Any?&gt;()

    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">emit</span><span class="hljs-params">(value: <span class="hljs-type">T</span>)</span></span> {
        synchronized(<span class="hljs-keyword">this</span>) {
            <span class="hljs-comment">// æ·»åŠ åˆ°é‡æ”¾ç¼“å­˜</span>
            <span class="hljs-keyword">if</span> (replayCapacity &gt; <span class="hljs-number">0</span>) {
                replayCache.addLast(value)
                <span class="hljs-keyword">if</span> (replayCache.size &gt; replayCapacity) {
                    replayCache.removeFirst()
                }
            }

            <span class="hljs-comment">// å‘å°„ç»™æ‰€æœ‰è®¢é˜…è€…</span>
            collectors.forEach { collector -&gt;
                collector.emit(value)
            }
        }
    }

    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">collect</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> {
        <span class="hljs-keyword">val</span> sharedCollector = SharedFlowCollector(collector)
        collectors.add(sharedCollector)

        <span class="hljs-comment">// å‘é€é‡æ”¾ç¼“å­˜</span>
        replayCache.forEach { value -&gt;
            collector.emit(value <span class="hljs-keyword">as</span> T)
        }

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ç­‰å¾…æ–°å€¼</span>
            sharedCollector.wait()
        } <span class="hljs-keyword">finally</span> {
            collectors.remove(sharedCollector)
        }
    }
}
</code></pre>
<p><strong>SharedFlow å·¥ä½œåŸç†ï¼š</strong></p>
<ul>
<li>ç»´æŠ¤ä¸€ä¸ªè®¢é˜…è€…åˆ—è¡¨</li>
<li>æ¯ä¸ª <code>emit</code> å¹¿æ’­ç»™æ‰€æœ‰è®¢é˜…è€…</li>
<li>ä½¿ç”¨ <code>replayCache</code> ç¼“å­˜æœ€è¿‘çš„å€¼</li>
</ul>
<h4 data-id="heading-55">7. StateFlow å®ç°åŸç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * StateFlow æ¥å£
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">StateFlow</span>&lt;<span class="hljs-type">out T</span>&gt; : <span class="hljs-type">SharedFlow</span>&lt;<span class="hljs-type">T</span>&gt; {
    <span class="hljs-keyword">val</span> value: T
}

<span class="hljs-comment">/**
 * MutableStateFlow å®ç°ï¼ˆç®€åŒ–ï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">MutableStateFlow</span>&lt;<span class="hljs-type">T</span>&gt; : <span class="hljs-type">StateFlow</span>&lt;<span class="hljs-type">T</span>&gt;, <span class="hljs-type">MutableSharedFlow</span>&lt;<span class="hljs-type">T</span>&gt; {
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">var</span> value: T
}

<span class="hljs-comment">/**
 * StateFlow å†…éƒ¨å®ç°
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StateFlowImpl</span>&lt;<span class="hljs-type">T</span>&gt;(
    initialValue: T
) : MutableStateFlow&lt;T&gt; {

    <span class="hljs-comment">// å½“å‰å€¼ï¼ˆvolatile ä¿è¯å¯è§æ€§ï¼‰</span>
    <span class="hljs-meta">@Volatile</span>
    <span class="hljs-keyword">override</span> <span class="hljs-keyword">var</span> value: T = initialValue

    <span class="hljs-comment">// è®¢é˜…è€…é›†åˆ</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> collectors = mutableSetOf&lt;StateFlowCollector&gt;()

    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">emit</span><span class="hljs-params">(newValue: <span class="hljs-type">T</span>)</span></span> {
        <span class="hljs-keyword">val</span> oldValue = value
        value = newValue

        <span class="hljs-comment">// åªæœ‰å€¼å˜åŒ–æ—¶æ‰é€šçŸ¥è®¢é˜…è€…</span>
        <span class="hljs-keyword">if</span> (oldValue != newValue) {
            synchronized(collectors) {
                collectors.forEach { collector -&gt;
                    collector.emit(newValue)
                }
            }
        }
    }

    <span class="hljs-keyword">override</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">collect</span><span class="hljs-params">(collector: <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span> {
        <span class="hljs-keyword">val</span> stateCollector = StateFlowCollector(collector)

        <span class="hljs-comment">// ç«‹å³å‘é€å½“å‰å€¼</span>
        collector.emit(value)

        synchronized(collectors) {
            collectors.add(stateCollector)
        }

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ç­‰å¾…æ–°å€¼</span>
            stateCollector.wait()
        } <span class="hljs-keyword">finally</span> {
            synchronized(collectors) {
                collectors.remove(stateCollector)
            }
        }
    }
}
</code></pre>
<p><strong>StateFlow ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>å§‹ç»ˆæŒæœ‰å½“å‰å€¼</li>
<li>æ–°è®¢é˜…è€…ç«‹å³æ”¶åˆ°å½“å‰å€¼</li>
<li>å€¼ç›¸åŒæ—¶ä¸é‡å¤å‘å°„</li>
</ul>
<h4 data-id="heading-56">8. Flow çš„å¼‚å¸¸å¤„ç†æœºåˆ¶</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * catch æ“ä½œç¬¦å®ç°
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">catch</span><span class="hljs-params">(
    action: <span class="hljs-type">suspend</span> <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;.(<span class="hljs-type">cause</span>: <span class="hljs-type">Throwable</span>) -&gt; <span class="hljs-type">Unit</span>
)</span></span>: Flow&lt;T&gt; = flow {
    <span class="hljs-keyword">try</span> {
        collect { value -&gt;
            emit(value)
        }
    } <span class="hljs-keyword">catch</span> (e: Throwable) {
        <span class="hljs-comment">// åœ¨æ”¶é›†å™¨ä¸Šæ‰§è¡Œå¼‚å¸¸å¤„ç†</span>
        action(e)
    }
}

<span class="hljs-comment">/**
 * onCompletion æ“ä½œç¬¦å®ç°
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">onCompletion</span><span class="hljs-params">(
    action: <span class="hljs-type">suspend</span> <span class="hljs-type">FlowCollector</span>&lt;<span class="hljs-type">T</span>&gt;.(<span class="hljs-type">cause</span>: <span class="hljs-type">Throwable</span>?) -&gt; <span class="hljs-type">Unit</span>
)</span></span>: Flow&lt;T&gt; = flow {
    <span class="hljs-keyword">try</span> {
        collect { value -&gt;
            emit(value)
        }
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-comment">// æ— è®ºæˆåŠŸè¿˜æ˜¯å¼‚å¸¸éƒ½æ‰§è¡Œ</span>
        action(<span class="hljs-literal">null</span>)
    }
}

<span class="hljs-comment">/**
 * retryWhen æ“ä½œç¬¦ï¼šé‡è¯•æœºåˆ¶
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> Flow<span class="hljs-type">&lt;T&gt;</span>.<span class="hljs-title">retryWhen</span><span class="hljs-params">(
    predicate: <span class="hljs-type">suspend</span> (<span class="hljs-type">cause</span>: <span class="hljs-type">Throwable</span>, <span class="hljs-type">attempt</span>: <span class="hljs-type">Long</span>) -&gt; <span class="hljs-type">Boolean</span>
)</span></span>: Flow&lt;T&gt; = flow {
    <span class="hljs-keyword">var</span> attempt = <span class="hljs-number">0L</span>
    <span class="hljs-keyword">var</span> shallRetry: <span class="hljs-built_in">Boolean</span>

    <span class="hljs-keyword">do</span> {
        shallRetry = <span class="hljs-literal">false</span>
        <span class="hljs-keyword">try</span> {
            collect { value -&gt;
                emit(value)
            }
        } <span class="hljs-keyword">catch</span> (e: Throwable) {
            <span class="hljs-keyword">if</span> (predicate(e, attempt)) {
                attempt++
                shallRetry = <span class="hljs-literal">true</span>
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">throw</span> e
            }
        }
    } <span class="hljs-keyword">while</span> (shallRetry)
}
</code></pre>
<hr/>
<h2 data-id="heading-57">ç¬¬ä¸‰éƒ¨åˆ†ï¼šåç¨‹ä¸ Flow å¯¹æ¯”</h2>
<h3 data-id="heading-58">æ ¸å¿ƒå·®å¼‚</h3>
<h4 data-id="heading-59">1. è®¾è®¡ç†å¿µ</h4>






























<table><thead><tr><th>ç‰¹æ€§</th><th>åç¨‹ (Coroutine)</th><th>Flow</th></tr></thead><tbody><tr><td><strong>ç”¨é€”</strong></td><td>æ‰§è¡Œå•ä¸ªå¼‚æ­¥ä»»åŠ¡</td><td>å¤„ç†å¼‚æ­¥æ•°æ®æµ</td></tr><tr><td><strong>è¿”å›å€¼</strong></td><td>å•ä¸ªç»“æœ</td><td>å¤šä¸ªå€¼çš„åºåˆ—</td></tr><tr><td><strong>æ‰§è¡Œæ¨¡å¼</strong></td><td>çƒ­å¯åŠ¨ï¼ˆåˆ›å»ºå³è¿è¡Œï¼‰</td><td>å†·å¯åŠ¨ï¼ˆæ”¶é›†æ—¶æ‰è¿è¡Œï¼‰</td></tr><tr><td><strong>æ¨¡å‹</strong></td><td>å‡½æ•°å¼ï¼ˆè¾“å…¥ -&gt; è¾“å‡ºï¼‰</td><td>æµå¼ï¼ˆè¿ç»­çš„æ•°æ®æµï¼‰</td></tr></tbody></table>
<h4 data-id="heading-60">2. ä»£ç å¯¹æ¯”</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.*

<span class="hljs-comment">/**
 * åç¨‹ vs Flow å¯¹æ¯”
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// ========================================</span>
    <span class="hljs-comment">// åœºæ™¯1ï¼šè·å–å•ä¸ªç»“æœ</span>
    <span class="hljs-comment">// ========================================</span>

    <span class="hljs-comment">// ä½¿ç”¨åç¨‹ï¼šé€‚åˆå•ä¸ªå¼‚æ­¥æ“ä½œ</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchUser</span><span class="hljs-params">()</span></span>: User {
        delay(<span class="hljs-number">100</span>)
        <span class="hljs-keyword">return</span> User(<span class="hljs-string">"å¼ ä¸‰"</span>)
    }

    <span class="hljs-keyword">val</span> user = fetchUser() <span class="hljs-comment">// ä¸€æ¬¡è°ƒç”¨ï¼Œä¸€æ¬¡ç»“æœ</span>
    println(<span class="hljs-string">"åç¨‹ç»“æœ: <span class="hljs-variable">$user</span>"</span>)

    <span class="hljs-comment">// ä½¿ç”¨ Flowï¼šå³ä½¿å•ä¸ªç»“æœä¹Ÿç”¨æµ</span>
    <span class="hljs-keyword">val</span> userFlow: Flow&lt;User&gt; = flow {
        emit(User(<span class="hljs-string">"å¼ ä¸‰"</span>))
    }

    userFlow.collect { user -&gt;
        println(<span class="hljs-string">"Flow ç»“æœ: <span class="hljs-variable">$user</span>"</span>)
    }

    <span class="hljs-comment">// ========================================</span>
    <span class="hljs-comment">// åœºæ™¯2ï¼šå¤„ç†å¤šä¸ªå€¼</span>
    <span class="hljs-comment">// ========================================</span>

    <span class="hljs-comment">// ä½¿ç”¨åç¨‹ï¼šéœ€è¦è¿”å› List</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchUsers</span><span class="hljs-params">()</span></span>: List&lt;User&gt; {
        delay(<span class="hljs-number">100</span>)
        <span class="hljs-keyword">return</span> listOf(User(<span class="hljs-string">"å¼ ä¸‰"</span>), User(<span class="hljs-string">"æå››"</span>))
    }

    <span class="hljs-keyword">val</span> users = fetchUsers()
    users.forEach { println(<span class="hljs-string">"åç¨‹æ‰¹é‡: <span class="hljs-variable">$it</span>"</span>) }

    <span class="hljs-comment">// ä½¿ç”¨ Flowï¼šè‡ªç„¶åœ°å¤„ç†å¤šä¸ªå€¼</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">userFlow</span><span class="hljs-params">()</span></span>: Flow&lt;User&gt; = flow {
        repeat(<span class="hljs-number">10</span>) { i -&gt;
            delay(<span class="hljs-number">50</span>)
            emit(User(<span class="hljs-string">"ç”¨æˆ·<span class="hljs-variable">$i</span>"</span>))
        }
    }

    userFlow().collect { user -&gt;
        println(<span class="hljs-string">"Flow æµå¼: <span class="hljs-variable">$user</span>"</span>)
    }

    <span class="hljs-comment">// ========================================</span>
    <span class="hljs-comment">// åœºæ™¯3ï¼šå®æ—¶æ•°æ®æ›´æ–°</span>
    <span class="hljs-comment">// ========================================</span>

    <span class="hljs-comment">// åç¨‹æ–¹å¼ï¼šéœ€è¦è½®è¯¢æˆ–å›è°ƒ</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">pollForUpdates</span><span class="hljs-params">()</span></span>: List&lt;User&gt; {
        <span class="hljs-comment">// éœ€è¦å®šæ—¶è½®è¯¢</span>
        delay(<span class="hljs-number">1000</span>)
        <span class="hljs-keyword">return</span> fetchUsers()
    }

    <span class="hljs-comment">// Flow æ–¹å¼ï¼šè‡ªç„¶åœ°æ¨é€æ›´æ–°</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">userUpdates</span><span class="hljs-params">()</span></span>: Flow&lt;User&gt; = callbackFlow {
        <span class="hljs-comment">// æ¨¡æ‹Ÿå®æ—¶æ›´æ–°</span>
        repeat(<span class="hljs-number">10</span>) { i -&gt;
            delay(<span class="hljs-number">500</span>)
            trySend(User(<span class="hljs-string">"æ›´æ–°<span class="hljs-variable">$i</span>"</span>))
        }
        close()
    }

    userUpdates().collect { update -&gt;
        println(<span class="hljs-string">"å®æ—¶æ›´æ–°: <span class="hljs-variable">$update</span>"</span>)
    }
}
</code></pre>
<h3 data-id="heading-61">é€‚ç”¨åœºæ™¯å¯¹æ¯”</h3>
<h4 data-id="heading-62">åç¨‹é€‚åˆçš„åœºæ™¯</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*

<span class="hljs-comment">/**
 * åç¨‹æœ€ä½³å®è·µåœºæ™¯
 */</span>
<span class="hljs-keyword">object</span> CoroutineUseCases {

    <span class="hljs-comment">// 1. ç½‘ç»œè¯·æ±‚ï¼ˆå•æ¬¡ï¼‰</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchUserProfile</span><span class="hljs-params">(userId: <span class="hljs-type">String</span>)</span></span>: Profile {
        <span class="hljs-keyword">return</span> withContext(Dispatchers.IO) {
            <span class="hljs-comment">// ç½‘ç»œè°ƒç”¨</span>
            Profile(<span class="hljs-string">"ç”¨æˆ·"</span>, <span class="hljs-number">25</span>)
        }
    }

    <span class="hljs-comment">// 2. æ•°æ®åº“æ“ä½œï¼ˆå•æ¬¡ï¼‰</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">saveUser</span><span class="hljs-params">(user: <span class="hljs-type">User</span>)</span></span> {
        withContext(Dispatchers.IO) {
            <span class="hljs-comment">// æ•°æ®åº“æ’å…¥</span>
            database.insert(user)
        }
    }

    <span class="hljs-comment">// 3. å¹¶å‘æ‰§è¡Œå¤šä¸ªç‹¬ç«‹ä»»åŠ¡</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadDashboard</span><span class="hljs-params">()</span></span>: Dashboard {
        coroutineScope {
            <span class="hljs-keyword">val</span> profile = async { fetchUserProfile(<span class="hljs-string">"123"</span>) }
            <span class="hljs-keyword">val</span> orders = async { fetchUserOrders(<span class="hljs-string">"123"</span>) }
            <span class="hljs-keyword">val</span> notifications = async { fetchNotifications() }

            Dashboard(profile.await(), orders.await(), notifications.await())
        }
    }

    <span class="hljs-comment">// 4. æ‰¹é‡å¤„ç†</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">processBatch</span><span class="hljs-params">(items: <span class="hljs-type">List</span>&lt;<span class="hljs-type">Item</span>&gt;)</span></span>: List&lt;Result&gt; {
        <span class="hljs-keyword">return</span> withContext(Dispatchers.Default) {
            items.map { item -&gt;
                processItem(item) <span class="hljs-comment">// CPU å¯†é›†å‹è®¡ç®—</span>
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-63">Flow é€‚åˆçš„åœºæ™¯</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.*

<span class="hljs-comment">/**
 * Flow æœ€ä½³å®è·µåœºæ™¯
 */</span>
<span class="hljs-keyword">object</span> FlowUseCases {

    <span class="hljs-comment">// 1. å®æ—¶æ•°æ®æµï¼ˆWebSocketã€ä¼ æ„Ÿå™¨ï¼‰</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">websocketUpdates</span><span class="hljs-params">()</span></span>: Flow&lt;Message&gt; = callbackFlow {
        <span class="hljs-keyword">val</span> socket = WebSocket { message -&gt;
            trySend(message) <span class="hljs-comment">// å®æ—¶æ¨é€</span>
        }

        awaitClose { socket.close() }
    }

    <span class="hljs-comment">// 2. UI äº‹ä»¶æµ</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">clickEvents</span><span class="hljs-params">(view: <span class="hljs-type">View</span>)</span></span>: Flow&lt;ClickEvent&gt; = callbackFlow {
        <span class="hljs-keyword">val</span> listener = View.OnClickListener { event -&gt;
            trySend(ClickEvent(event))
        }

        view.setOnClickListener(listener)
        awaitClose { view.setOnClickListener(<span class="hljs-literal">null</span>) }
    }

    <span class="hljs-comment">// 3. åˆ†é¡µåŠ è½½</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">paginatedNews</span><span class="hljs-params">()</span></span>: Flow&lt;Article&gt; = flow {
        <span class="hljs-keyword">var</span> page = <span class="hljs-number">1</span>
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            <span class="hljs-keyword">val</span> articles = fetchArticlesPage(page)
            articles.forEach { emit(it) }
            <span class="hljs-keyword">if</span> (articles.isEmpty()) <span class="hljs-keyword">break</span>
            page++
        }
    }

    <span class="hljs-comment">// 4. æ•°æ®åº“å˜åŒ–ç›‘å¬</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">observeUsers</span><span class="hljs-params">()</span></span>: Flow&lt;User&gt; = callbackFlow {
        <span class="hljs-keyword">val</span> observer = <span class="hljs-keyword">object</span> : DatabaseObserver&lt;User&gt; {
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onChange</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">User</span>)</span></span> {
                trySend(<span class="hljs-keyword">data</span>)
            }
        }

        database.registerObserver(observer)
        awaitClose { database.unregisterObserver(observer) }
    }

    <span class="hljs-comment">// 5. æœç´¢é˜²æŠ–</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">search</span><span class="hljs-params">(queryFlow: <span class="hljs-type">Flow</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span>: Flow&lt;Result&gt; =
        queryFlow
            .debounce(<span class="hljs-number">300</span>)                      <span class="hljs-comment">// é˜²æŠ–</span>
            .filter { it.length &gt;= <span class="hljs-number">2</span> }          <span class="hljs-comment">// æœ€å°é•¿åº¦</span>
            .distinctUntilChanged()             <span class="hljs-comment">// å»é‡</span>
            .map { query -&gt; performSearch(query) }
            .<span class="hljs-keyword">catch</span> { e -&gt; emit(Result.Error(e)) }

    <span class="hljs-comment">// 6. StateFlowï¼šUI çŠ¶æ€ç®¡ç†</span>
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewModel</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _uiState = MutableStateFlow(UiState.Idle)
        <span class="hljs-keyword">val</span> uiState: StateFlow&lt;UiState&gt; = _uiState

        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadData</span><span class="hljs-params">()</span></span> {
            _uiState.value = UiState.Loading
            viewModelScope.launch {
                <span class="hljs-keyword">val</span> result = fetchData()
                _uiState.value = UiState.Success(result)
            }
        }
    }

    <span class="hljs-comment">// 7. SharedFlowï¼šäº‹ä»¶æ€»çº¿</span>
    <span class="hljs-keyword">object</span> EventBus {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _events = MutableSharedFlow&lt;Event&gt;()
        <span class="hljs-keyword">val</span> events: SharedFlow&lt;Event&gt; = _events

        <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">sendEvent</span><span class="hljs-params">(event: <span class="hljs-type">Event</span>)</span></span> {
            _events.emit(event)
        }
    }
}
</code></pre>
<h3 data-id="heading-64">æ€§èƒ½å¯¹æ¯”</h3>
<h4 data-id="heading-65">1. å†…å­˜å¼€é”€</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlinx.coroutines.flow.*

<span class="hljs-comment">/**
 * åç¨‹ vs Flow æ€§èƒ½å¯¹æ¯”
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// åç¨‹ï¼šä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰æ•°æ®åˆ°å†…å­˜</span>
    <span class="hljs-keyword">val</span> time1 = measureTimeMillis {
        <span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span> = loadAllData() <span class="hljs-comment">// è¿”å› List&lt;10000æ¡&gt;</span>
        processList(<span class="hljs-keyword">data</span>)
    }
    println(<span class="hljs-string">"åç¨‹ï¼ˆä¸€æ¬¡æ€§åŠ è½½ï¼‰: <span class="hljs-subst">${time1}</span>ms"</span>)

    <span class="hljs-comment">// Flowï¼šæµå¼å¤„ç†ï¼Œä½å†…å­˜å ç”¨</span>
    <span class="hljs-keyword">val</span> time2 = measureTimeMillis {
        dataFlow()
            .take(<span class="hljs-number">100</span>) <span class="hljs-comment">// åªå¤„ç†å‰100æ¡</span>
            .collect { item -&gt;
                processItem(item)
            }
    }
    println(<span class="hljs-string">"Flowï¼ˆæµå¼å¤„ç†ï¼‰: <span class="hljs-subst">${time2}</span>ms"</span>)
}

<span class="hljs-comment">// æ¨¡æ‹Ÿå¤§æ•°æ®é›†</span>
<span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadAllData</span><span class="hljs-params">()</span></span>: List&lt;<span class="hljs-built_in">Int</span>&gt; {
    <span class="hljs-keyword">return</span> (<span class="hljs-number">1.</span><span class="hljs-number">.10000</span>).toList()
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">dataFlow</span><span class="hljs-params">()</span></span>: Flow&lt;<span class="hljs-built_in">Int</span>&gt; = flow {
    repeat(<span class="hljs-number">10000</span>) { emit(it) }
}
</code></pre>
<h4 data-id="heading-66">2. èƒŒå‹å¤„ç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * èƒŒå‹å¤„ç†å¯¹æ¯”
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-comment">// åç¨‹ï¼šéœ€è¦æ‰‹åŠ¨å®ç°èƒŒå‹</span>
    launch {
        <span class="hljs-keyword">val</span> channel = Channel&lt;<span class="hljs-built_in">Int</span>&gt;(capacity = <span class="hljs-number">10</span>)
        <span class="hljs-comment">// ç”Ÿäº§è€…</span>
        launch {
            repeat(<span class="hljs-number">1000</span>) { i -&gt;
                channel.send(i) <span class="hljs-comment">// æ»¡æ—¶æŒ‚èµ·</span>
            }
            channel.close()
        }
        <span class="hljs-comment">// æ¶ˆè´¹è€…</span>
        launch {
            <span class="hljs-keyword">for</span> (value <span class="hljs-keyword">in</span> channel) {
                delay(<span class="hljs-number">100</span>) <span class="hljs-comment">// æ…¢é€Ÿæ¶ˆè´¹</span>
                println(<span class="hljs-string">"æ¶ˆè´¹: <span class="hljs-variable">$value</span>"</span>)
            }
        }
    }

    <span class="hljs-comment">// Flowï¼šå†…ç½®èƒŒå‹æ”¯æŒ</span>
    flow {
        repeat(<span class="hljs-number">1000</span>) { i -&gt;
            emit(i) <span class="hljs-comment">// è‡ªåŠ¨å¤„ç†èƒŒå‹</span>
        }
    }
    .buffer(<span class="hljs-number">10</span>) <span class="hljs-comment">// ç¼“å†²åŒº</span>
    .conflate() <span class="hljs-comment">// æˆ–åªä¿ç•™æœ€æ–°å€¼</span>
    .collect { value -&gt;
        delay(<span class="hljs-number">100</span>)
        println(<span class="hljs-string">"Flow: <span class="hljs-variable">$value</span>"</span>)
    }
}
</code></pre>
<h3 data-id="heading-67">æ€»ç»“å¯¹æ¯”è¡¨</h3>

































































<table><thead><tr><th>ç»´åº¦</th><th>åç¨‹ (Coroutine)</th><th>Flow</th></tr></thead><tbody><tr><td><strong>è¿”å›ç±»å‹</strong></td><td>å•ä¸ªå€¼ <code>T</code></td><td>æµ <code>Flow&lt;T&gt;</code></td></tr><tr><td><strong>æ‰§è¡Œæ—¶æœº</strong></td><td>ç«‹å³æ‰§è¡Œ</td><td>æ”¶é›†æ—¶æ‰§è¡Œï¼ˆå†·æµï¼‰</td></tr><tr><td><strong>èƒŒå‹å¤„ç†</strong></td><td>éœ€è¦æ‰‹åŠ¨å®ç°ï¼ˆChannelï¼‰</td><td>å†…ç½®æ”¯æŒï¼ˆbufferã€conflateï¼‰</td></tr><tr><td><strong>æ“ä½œç¬¦</strong></td><td>åŸºæœ¬æ— æ“ä½œç¬¦</td><td>ä¸°å¯Œçš„æ“ä½œç¬¦ï¼ˆmapã€filter ç­‰ï¼‰</td></tr><tr><td><strong>å–æ¶ˆ</strong></td><td><code>job.cancel()</code></td><td><code>collect</code> åç¨‹å–æ¶ˆ</td></tr><tr><td><strong>å¼‚å¸¸å¤„ç†</strong></td><td>try-catch</td><td>catchã€onCompletion æ“ä½œç¬¦</td></tr><tr><td><strong>çº¿ç¨‹åˆ‡æ¢</strong></td><td><code>withContext</code></td><td><code>flowOn</code></td></tr><tr><td><strong>çŠ¶æ€ç®¡ç†</strong></td><td>éœ€è¦è‡ªå·±å®ç°</td><td>StateFlowã€SharedFlow</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>å•æ¬¡å¼‚æ­¥ä»»åŠ¡</td><td>è¿ç»­æ•°æ®æµã€å®æ—¶æ›´æ–°</td></tr><tr><td><strong>å­¦ä¹ æ›²çº¿</strong></td><td>ç®€å•</td><td>ç›¸å¯¹å¤æ‚</td></tr><tr><td><strong>æ€§èƒ½</strong></td><td>å•æ¬¡æ“ä½œæ›´è½»é‡</td><td>æµå¼å¤„ç†æ›´é«˜æ•ˆ</td></tr></tbody></table>
<h3 data-id="heading-68">é€‰æ‹©å»ºè®®</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * é€‰æ‹©æŒ‡å—
 */</span>
<span class="hljs-keyword">object</span> ChoiceGuide {

    <span class="hljs-comment">// âœ… ä½¿ç”¨åç¨‹çš„åœºæ™¯ï¼š</span>
    <span class="hljs-comment">// 1. å•æ¬¡ç½‘ç»œè¯·æ±‚</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getUser</span><span class="hljs-params">(id: <span class="hljs-type">String</span>)</span></span>: User

    <span class="hljs-comment">// 2. æ•°æ®åº“ CRUD æ“ä½œ</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">insertUser</span><span class="hljs-params">(user: <span class="hljs-type">User</span>)</span></span>

    <span class="hljs-comment">// 3. æ–‡ä»¶è¯»å†™</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">readFile</span><span class="hljs-params">(path: <span class="hljs-type">String</span>)</span></span>: ByteArray

    <span class="hljs-comment">// 4. å¹¶å‘æ‰§è¡Œå¤šä¸ªç‹¬ç«‹ä»»åŠ¡</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadAll</span><span class="hljs-params">()</span></span>: Data = coroutineScope {
        <span class="hljs-keyword">val</span> a = async { loadA() }
        <span class="hljs-keyword">val</span> b = async { loadB() }
        Data(a.await(), b.await())
    }

    <span class="hljs-comment">// âœ… ä½¿ç”¨ Flow çš„åœºæ™¯ï¼š</span>
    <span class="hljs-comment">// 1. å®æ—¶æ•°æ®æµ</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">observeMessages</span><span class="hljs-params">()</span></span>: Flow&lt;Message&gt;

    <span class="hljs-comment">// 2. åˆ†é¡µåŠ è½½</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadPages</span><span class="hljs-params">()</span></span>: Flow&lt;Item&gt;

    <span class="hljs-comment">// 3. æœç´¢æ¡†é˜²æŠ–</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">search</span><span class="hljs-params">(query: <span class="hljs-type">Flow</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span>: Flow&lt;Result&gt;

    <span class="hljs-comment">// 4. UI çŠ¶æ€ç®¡ç†</span>
    <span class="hljs-keyword">val</span> uiState: StateFlow&lt;UiState&gt;

    <span class="hljs-comment">// 5. äº‹ä»¶æ€»çº¿</span>
    <span class="hljs-keyword">val</span> events: SharedFlow&lt;Event&gt;

    <span class="hljs-comment">// 6. æ•°æ®åº“å˜åŒ–ç›‘å¬</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">observeUsers</span><span class="hljs-params">()</span></span>: Flow&lt;User&gt;

    <span class="hljs-comment">// 7. å®šæ—¶ä»»åŠ¡</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">ticker</span><span class="hljs-params">()</span></span>: Flow&lt;<span class="hljs-built_in">Unit</span>&gt; = flow {
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            emit(<span class="hljs-built_in">Unit</span>)
            delay(<span class="hljs-number">1000</span>)
        }
    }

    <span class="hljs-comment">// âœ… ä¸¤è€…ç»“åˆä½¿ç”¨ï¼š</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadAndUpdate</span><span class="hljs-params">()</span></span> {
        viewModelScope.launch {
            <span class="hljs-comment">// åç¨‹ï¼šåŠ è½½æ•°æ®</span>
            <span class="hljs-keyword">val</span> users = fetchUsers()

            <span class="hljs-comment">// Flowï¼šå‘é€æ›´æ–°</span>
            usersFlow.emitAll(users.asFlow())
        }
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-69">å‚è€ƒèµ„æº</h3>
<h4 data-id="heading-70">å®˜æ–¹æ–‡æ¡£</h4>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fkotlinlang.org%2Fdocs%2Fcoroutines-overview.html" target="_blank" title="https://kotlinlang.org/docs/coroutines-overview.html" ref="nofollow noopener noreferrer">Kotlin åç¨‹å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Fkotlin%2Fcoroutines" target="_blank" title="https://developer.android.com/kotlin/coroutines" ref="nofollow noopener noreferrer">Android åç¨‹æŒ‡å—</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fkotlinlang.org%2Fdocs%2Fflow.html" target="_blank" title="https://kotlinlang.org/docs/flow.html" ref="nofollow noopener noreferrer">Kotlin Flow å®˜æ–¹æ–‡æ¡£</a></li>
</ul>
<h4 data-id="heading-71">æ¨èé˜…è¯»</h4>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fbook.kotlincn.net%2Ftext%2Fcoroutines-basics.html" target="_blank" title="https://book.kotlincn.net/text/coroutines-basics.html" ref="nofollow noopener noreferrer">åç¨‹åŸºç¡€ - Kotlin ä¸­æ–‡æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Fkotlin%2Fflow%2Fstateflow-and-sharedflow" target="_blank" title="https://developer.android.com/kotlin/flow/stateflow-and-sharedflow" ref="nofollow noopener noreferrer">StateFlow å’Œ SharedFlow - Android å®˜æ–¹</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmy.oschina.net%2Femacs_9695949%2Fblog%2F19073966" target="_blank" title="https://my.oschina.net/emacs_9695949/blog/19073966" ref="nofollow noopener noreferrer">Kotlin åç¨‹æ·±åº¦è§£æ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Flishuaiqi.top%2F2025%2F10%2F16%2Fkotlin%2Fkotlin-cotoutine-coroutine_flow_flowon%2F" target="_blank" title="https://lishuaiqi.top/2025/10/16/kotlin/kotlin-cotoutine-coroutine_flow_flowon/" ref="nofollow noopener noreferrer">Flow çº¿ç¨‹åˆ‡æ¢åŸç†</a></li>
</ul>
<hr/>
<blockquote>
<p><strong>ç»“è¯­</strong>ï¼šåç¨‹å’Œ Flow æ˜¯ Kotlin å¼‚æ­¥ç¼–ç¨‹çš„ä¸¤å¤§æ”¯æŸ±ã€‚åç¨‹é€‚åˆå¤„ç†å•ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œè€Œ Flow é€‚åˆå¤„ç†å¼‚æ­¥æ•°æ®æµã€‚ç†è§£å®ƒä»¬çš„å·®å¼‚å¹¶æ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚çš„å·¥å…·ï¼Œæ˜¯ç¼–å†™é«˜æ•ˆ Kotlin ä»£ç çš„å…³é”®ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[prompt å·¥ç¨‹å­¦ä¹ æ€»ç»“]]></title>    <link>https://juejin.cn/post/7596926832912220223</link>    <guid>https://juejin.cn/post/7596926832912220223</guid>    <pubDate>2026-01-19T10:05:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596926832912220223" data-draft-id="7596865421612040246" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="prompt å·¥ç¨‹å­¦ä¹ æ€»ç»“"/> <meta itemprop="keywords" content="ç®—æ³•,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-19T10:05:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çŸ®äººä¸‰ç­‰"/> <meta itemprop="url" content="https://juejin.cn/user/4350105576808472"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            prompt å·¥ç¨‹å­¦ä¹ æ€»ç»“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4350105576808472/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çŸ®äººä¸‰ç­‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T10:05:03.000Z" title="Mon Jan 19 2026 10:05:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1 æç¤ºè¯å·¥ç¨‹</h2>
<ol>
<li>
<p>Zero-Shot /  Few-Shot</p>
<ol>
<li>
<p>æ³¨ï¼šè¿™ä¸ªè¯è¯­åœ¨å­¦ä¹ gptç³»åˆ—ä¸­ <a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2FLian_Ge_Blog%2Farticle%2Fdetails%2F156238343%3Fspm%3D1001.2014.3001.5502" target="_blank" title="https://blog.csdn.net/Lian_Ge_Blog/article/details/156238343?spm=1001.2014.3001.5502" ref="nofollow noopener noreferrer">gpt3</a> çš„æ—¶å€™æåŠè¿‡ï¼ŒZero-Shot/Few-Shot çš„æ¦‚å¿µå¹¶é GPT-3 é¦–åˆ›ï¼Œä½† GPT-3 æ˜¯é¦–ä¸ªè®©å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„ Zero/Few-Shot èƒ½åŠ›å¤§è§„æ¨¡è½åœ°å¹¶å¼•å‘è¡Œä¸šå…³æ³¨çš„æ¨¡å‹ã€‚</p>
</li>
<li>
<p><strong>Zero-Shot</strong> ä¾èµ–æ¨¡å‹çš„é€šç”¨çŸ¥è¯†ï¼Œé€‚åˆç®€å•ä»»åŠ¡ï¼›</p>
</li>
<li>
<p><strong>Few-Shot</strong> é€šè¿‡ç¤ºä¾‹é™ä½ä»»åŠ¡ç†è§£éš¾åº¦ï¼Œé€‚åˆå¤æ‚æˆ–ç‰¹å®šåœºæ™¯ ã€‚</p>
</li>
<li>
<p>Zero-Shotï¼š(é›¶æ ·æœ¬æç¤º)ï¼šä¸ç»™ä»»ä½•ç¤ºä¾‹ï¼Œç›´æ¥ç”¨è‡ªç„¶è¯­è¨€æè¿°ä»»åŠ¡è¦æ±‚è®©æ¨¡å‹æ¥å®Œæˆ</p>
<ol>
<li>æ ¸å¿ƒåŸç†ï¼šåˆ©ç”¨æ¨¡å‹é¢„è®­ç»ƒæ—¶å­¦åˆ°çš„é€šç”¨çŸ¥è¯†ï¼Œæ˜ å°„æ–°ä»»åŠ¡ä¸å·²çŸ¥æ¦‚å¿µçš„å…³è”</li>
<li>ä½¿ç”¨åœºæ™¯ï¼šç®€å•åˆ†ç±»ã€åŸºç¡€æ–‡æœ¬ç”Ÿæˆã€ä»»åŠ¡æè¿°æ˜ç¡®çš„åœºæ™¯</li>
</ol>
<pre><code class="hljs language-text" lang="text">ç¤ºä¾‹:
æç¤ºè¯ï¼š"å°†ä»¥ä¸‹è‹±æ–‡å¥å­ç¿»è¯‘æˆä¸­æ–‡ï¼š'Hello, how are you?'"
æ¨¡å‹è¾“å‡ºï¼š"ä½ å¥½ï¼Œæœ€è¿‘æ€ä¹ˆæ ·ï¼Ÿ"
æ­¤åœºæ™¯ä¸­ï¼Œæ¨¡å‹æœªè·å¾—ä»»ä½•ç¿»è¯‘ç¤ºä¾‹ï¼Œä»…é€šè¿‡è‡ªèº«çŸ¥è¯†å®Œæˆä»»åŠ¡
</code></pre>
</li>
<li>
<p>Few-Shot(å°‘æ ·æœ¬æç¤º)ï¼šåœ¨æç¤ºè¯ä¸­æä¾›å°‘é‡ä»»åŠ¡ç¤ºä¾‹ï¼Œå¸®åŠ©æ¨¡å‹ç†è§£ä»»åŠ¡é€»è¾‘å¹¶ç”Ÿæˆç­”æ¡ˆ ã€‚</p>
<ol>
<li>æ ¸å¿ƒåŸç†ï¼šåŸºäº<strong>å°æ ·æœ¬å½’çº³</strong>ï¼Œè®©æ¨¡å‹å¿«é€Ÿé€‚é…ç‰¹å®šä»»åŠ¡èŒƒå¼ï¼Œé™ä½å¾®è°ƒæˆæœ¬</li>
<li>ä½¿ç”¨åœºæ™¯ï¼šæ•°æ®ç¨€ç¼ºçš„å®šåˆ¶åŒ–ä»»åŠ¡ã€æ ¼å¼çº¦æŸä¸¥æ ¼çš„è¾“å‡ºï¼ˆå¦‚ç»“æ„åŒ–æŠ¥å‘Šï¼‰</li>
</ol>
<pre><code class="hljs language-text" lang="text">è¯·åˆ¤æ–­ä»¥ä¸‹å¥å­çš„æƒ…ç»ªæ˜¯ã€Œç§¯æã€è¿˜æ˜¯ã€Œæ¶ˆæã€ï¼š

ç¤ºä¾‹1ï¼šä»Šå¤©çš„é˜³å…‰ç‰¹åˆ«å¥½ï¼Œå¿ƒæƒ…ä¹Ÿè·Ÿç€æ˜åªšèµ·æ¥ â†’ ç§¯æ
ç¤ºä¾‹2ï¼šé”™è¿‡æœ«ç­è½¦ï¼Œåˆæ·‹äº†é›¨ï¼ŒçœŸçš„å¤ªå€’éœ‰äº† â†’ æ¶ˆæ
ç¤ºä¾‹3ï¼šæ–°å…¥æ‰‹çš„ä¹¦å†…å®¹è¶…ç²¾å½©ï¼Œç†¬å¤œéƒ½æƒ³è¯»å®Œ â†’ ç§¯æ

ç°åœ¨è¯·åˆ¤æ–­ï¼š
å¥å­ï¼šè¿™æ¬¾æ–°å‡ºçš„è€³æœºéŸ³è´¨è¶…æ£’ï¼Œä½©æˆ´ä¹Ÿå¾ˆèˆ’æœ â†’ "ç§¯æ"(æ¨¡å‹è¾“å‡º)
</code></pre>
</li>
</ol>
</li>
<li>
<p>COT(Chain-of-Thought)ï¼šé€šè¿‡æç¤ºå¼•å¯¼æ¨¡å‹å°†å¤æ‚é—®é¢˜æ‹†è§£ä¸º<strong>åˆ†æ­¥æ¨ç†é“¾æ¡</strong>ï¼Œé€æ­¥æ¨å¯¼ç­”æ¡ˆï¼Œè€Œéç›´æ¥ç»™å‡ºç»“è®ºã€‚æ ¸å¿ƒæ€æƒ³æ˜¯è®©æ¨¡å‹æ˜¾å¼è¡¨è¾¾â€œæ€è€ƒè¿‡ç¨‹â€ï¼Œç±»ä¼¼äººç±»è§£å†³é—®é¢˜æ—¶çš„é€æ­¥åˆ†æã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad0136a19a0e4db4ad92941db1e38f2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-u5Lq65LiJ562J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769421902&amp;x-signature=GgSwXB6H7vUH1lrmcRuUkeT5Ro0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<ol>
<li>
<p>åŒºåˆ«äºä¼ ç»Ÿçš„ Prompt ä»è¾“å…¥ç›´æ¥åˆ°è¾“å‡ºçš„æ˜ å°„ &lt;inputâ€”â€”&gt;output&gt; çš„æ–¹å¼ï¼ŒCoT å®Œæˆäº†ä»è¾“å…¥åˆ°æ€ç»´é“¾å†åˆ°è¾“å‡ºçš„æ˜ å°„ï¼Œå³ &lt;inputâ€”â€”&gt;reasoning chainâ€”â€”&gt;output&gt;</p>
</li>
<li>
<p>ä½¿ç”¨åœºæ™¯ï¼šæ•°å­¦è®¡ç®—ã€é€»è¾‘æ¨ç†ã€å¤šæ­¥éª¤å†³ç­–</p>
<pre><code class="hljs language-text" lang="text">æ™®é€šæç¤ºï¼š
é—®é¢˜ï¼š1ä¸ªä¹¦æ¶æœ‰3å±‚ï¼Œæ¯å±‚æ”¾5æœ¬ä¹¦ï¼Œå…±æœ‰å¤šå°‘æœ¬ä¹¦ï¼Ÿ
ç­”æ¡ˆï¼š15æœ¬

cot æç¤ºï¼š
é—®é¢˜ï¼š1ä¸ªä¹¦æ¶æœ‰3å±‚ï¼Œæ¯å±‚æ”¾5æœ¬ä¹¦ï¼Œå…±æœ‰å¤šå°‘æœ¬ä¹¦ï¼Ÿ
æ¨ç†ï¼š
1. æ¯å±‚5æœ¬ä¹¦ï¼Œ3å±‚çš„æ€»ä¹¦æ•° = 5 Ã— 3
2. 5 Ã— 3 = 15
ç­”æ¡ˆï¼š15æœ¬
</code></pre>
</li>
<li>
<p>ä¸€ä¸ªå®Œæ•´çš„åŒ…å« CoT çš„ Prompt å¾€å¾€ç”±æŒ‡ä»¤ï¼ˆInstructionï¼‰ï¼Œé€»è¾‘ä¾æ®ï¼ˆRationaleï¼‰ï¼Œç¤ºä¾‹ï¼ˆExemplarsï¼‰ä¸‰éƒ¨åˆ†ç»„æˆ</p>
<ol>
<li>ä¸€èˆ¬è€Œè¨€æŒ‡ä»¤ç”¨äºæè¿°é—®é¢˜å¹¶ä¸”å‘ŠçŸ¥å¤§æ¨¡å‹çš„è¾“å‡ºæ ¼å¼</li>
<li>é€»è¾‘ä¾æ®å³æŒ‡ CoT çš„ä¸­é—´æ¨ç†è¿‡ç¨‹ï¼Œå¯ä»¥åŒ…å«é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€ä¸­é—´æ¨ç†æ­¥éª¤ä»¥åŠä¸é—®é¢˜ç›¸å…³çš„ä»»ä½•å¤–éƒ¨çŸ¥è¯†</li>
<li>ç¤ºä¾‹åˆ™æŒ‡ä»¥å°‘æ ·æœ¬çš„æ–¹å¼ä¸ºå¤§æ¨¡å‹æä¾›è¾“å…¥è¾“å‡ºå¯¹çš„åŸºæœ¬æ ¼å¼ï¼Œæ¯ä¸€ä¸ªç¤ºä¾‹éƒ½åŒ…å«ï¼šé—®é¢˜ï¼Œæ¨ç†è¿‡ç¨‹ä¸ç­”æ¡ˆã€‚</li>
</ol>
</li>
<li>
<p>é›¶æ ·æœ¬æ€ç»´é“¾ï¼ˆZero-Shot CoTï¼‰ï¼šæ— éœ€ç¤ºä¾‹ï¼Œä»…é€šè¿‡æç¤ºè¯ï¼ˆå¦‚â€œè¯·åˆ†æ­¥éª¤æ€è€ƒâ€ï¼‰è§¦å‘æ¨¡å‹ç”Ÿæˆæ€ç»´é“¾ã€‚é€‚ç”¨äºå¿«é€Ÿå¼•å¯¼æ¨¡å‹è¿›è¡Œæ¨ç†ã€‚</p>
</li>
<li>
<p>å°‘æ ·æœ¬æ€ç»´é“¾ï¼ˆFew-Shot CoTï¼‰ï¼šæä¾›å°‘é‡å¸¦æ€ç»´é“¾çš„ç¤ºä¾‹ï¼Œè®©æ¨¡å‹æ¨¡ä»¿ç¤ºä¾‹ç»“æ„è¿›è¡Œæ¨ç†ã€‚ä¾‹å¦‚ï¼Œå…ˆç»™å‡ºå‡ ä¸ªé—®é¢˜åŠå…¶åˆ†è§£æ­¥éª¤ï¼Œå†è®©æ¨¡å‹å¤„ç†æ–°é—®é¢˜</p>
</li>
</ol>
</li>
<li>
<p>ToTï¼ˆTree of Thoughtï¼Œæ€ç»´æ ‘ï¼‰:å°†é—®é¢˜æ±‚è§£è§†ä¸º<strong>æ ‘çŠ¶æœç´¢è¿‡ç¨‹</strong>ï¼šæ¨¡å‹ç”Ÿæˆå¤šä¸ªå¯èƒ½çš„è§£é¢˜è·¯å¾„ï¼ˆåˆ†æ”¯ï¼‰ï¼Œå¯¹æ¯æ¡è·¯å¾„çš„ä¸­é—´ç»“æœè¿›è¡Œè¯„ä¼°ï¼Œé€‰æ‹©æœ€ä¼˜åˆ†æ”¯ç»§ç»­æ¢ç´¢ï¼Œç›´è‡³æ‰¾åˆ°ç­”æ¡ˆã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a2919e84718342e0b8d27603d37c4cef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-u5Lq65LiJ562J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769421902&amp;x-signature=Mj5u4d8Xz3KgRaWo0vgT74I22ak%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<ol>
<li>åœ¨ToTä¸­ï¼Œä¸ºäº†å¸®åŠ©æ¨¡å‹è¯†åˆ«æœ€æœ‰æ•ˆçš„æ€ç»´åºåˆ—ï¼Œç³»ç»Ÿä½¿ç”¨äº†å¸¸ç”¨çš„æœç´¢ç®—æ³•ï¼Œæ¯”å¦‚å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰å’Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ã€‚
<ol>
<li>BFS:æ ¸å¿ƒæ˜¯ <strong>â€œå±‚å±‚æ¨è¿›â€</strong>ï¼šå…ˆè®¿é—®ç¦»èµ·ç‚¹æœ€è¿‘çš„èŠ‚ç‚¹ï¼ˆå½“å‰å±‚ï¼‰ï¼Œå†ä¾æ¬¡è®¿é—®ä¸‹ä¸€å±‚çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œåƒ â€œæ°´æ³¢æ‰©æ•£â€ ä¸€æ ·ã€‚
<ol>
<li>æ ¸å¿ƒæ•°æ®ç»“æ„ï¼š<strong>é˜Ÿåˆ—ï¼ˆQueueï¼‰</strong>ï¼ˆå…ˆè¿›å…ˆå‡ºï¼Œç±»æ¯”æ’é˜Ÿå–é¤ï¼‰ã€‚</li>
<li>é€šä¿—ç†è§£ï¼šæ‰¾è¿·å®«å‡ºå£æ—¶ï¼Œå…ˆæœå®Œå½“å‰ä½ç½®å‘¨å›´çš„æ‰€æœ‰è·¯å¾„ï¼Œå†å¾€æ›´è¿œçš„åœ°æ–¹æœã€‚</li>
</ol>
</li>
<li>DFS:æ ¸å¿ƒæ˜¯ <strong>â€œä¸€æ¡è·¯èµ°åˆ°é»‘â€</strong>ï¼šæ²¿ç€ä¸€æ¡è·¯å¾„ä¸€ç›´èµ°åˆ°å°½å¤´ï¼Œå†å›æº¯ï¼ˆé€€å›æ¥ï¼‰èµ°å…¶ä»–æœªæ¢ç´¢çš„è·¯å¾„ã€‚
<ol>
<li>æ ¸å¿ƒæ•°æ®ç»“æ„ï¼š<strong>æ ˆï¼ˆStackï¼‰</strong>ï¼ˆåè¿›å…ˆå‡ºï¼Œç±»æ¯”æ‘èµ·æ¥çš„ç›˜å­ï¼‰æˆ–<strong>é€’å½’</strong>ï¼ˆé€’å½’æœ¬è´¨æ˜¯è°ƒç”¨æ ˆï¼Œç±»æ¯”å¥—å¨ƒï¼‰ã€‚</li>
<li>é€šä¿—ç†è§£ï¼šæ‰¾è¿·å®«å‡ºå£æ—¶ï¼Œå…ˆå¾€ä¸€ä¸ªæ–¹å‘èµ°åˆ°æ­»èƒ¡åŒï¼Œå†å›å¤´æ¢æ–¹å‘ç»§ç»­èµ°ã€‚</li>
</ol>
</li>
</ol>
</li>
<li>ä½¿ç”¨åœºæ™¯ï¼šåˆ›æ„ç”Ÿæˆã€å¤æ‚è§„åˆ’ã€å¤šè§£é—®é¢˜</li>
<li>ä¼˜åŠ¿ï¼š
<ol>
<li>é¿å…å•ä¸€æ€ç»´é“¾çš„å±€é™æ€§ï¼Œé€šè¿‡å¹¶è¡Œæ¢ç´¢æå‡è§£é¢˜æˆåŠŸç‡ã€‚</li>
<li>é€‚ç”¨äºå­˜åœ¨å¤šä¸ªå¯è¡Œè§£çš„åœºæ™¯ï¼Œå¯ä¼˜åŒ–ç­”æ¡ˆè´¨é‡ã€‚</li>
<li>ToTçš„çµæ´»æ€§å’Œé€‚åº”æ€§æ¯” COTæ›´å¼ºã€‚</li>
</ol>
</li>
</ol>
</li>
<li>
<p>GoTï¼ˆGraph-of-Thoughtsï¼Œæ€ç»´å›¾è°±ï¼‰ï¼šå°†é—®é¢˜æ‹†è§£ä¸º<strong>å›¾ç»“æ„</strong>ï¼ŒèŠ‚ç‚¹ä»£è¡¨å…³é”®æ¦‚å¿µæˆ–ä¸­é—´ç»“è®ºï¼Œè¾¹ä»£è¡¨æ¦‚å¿µé—´çš„å…³ç³»ï¼ˆå¦‚å› æœå…³ç³»ã€ä¾èµ–å…³ç³»ï¼‰ã€‚æ¨¡å‹é€šè¿‡éå†å›¾èŠ‚ç‚¹ï¼Œæ•´åˆå¤šæºä¿¡æ¯è¿›è¡Œæ¨ç†(ä¸æ˜¯å¾ˆç†Ÿæ‚‰çŸ¥è¯†å›¾è°±ï¼Œæ­¤å¤„ä»…äº†è§£)ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a7dea6ad0464c7c84608b7192c53bba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-u5Lq65LiJ562J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769421902&amp;x-signature=WC3n%2F9t4s8E%2BcnHzBGNB%2Fl6AJX0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<ol>
<li>ä½¿ç”¨åœºæ™¯ï¼šçŸ¥è¯†å›¾è°±æ„å»ºã€å¤šæºä¿¡æ¯èåˆæ¨ç†ï¼Œå¤æ‚çŸ¥è¯†æ¨ç†ï¼Œè·¨é¢†åŸŸé—®ç­”</li>
<li>ä¼˜åŠ¿ï¼š
<ol>
<li>æ”¯æŒå¤„ç†å¤šç»´åº¦ã€éçº¿æ€§çš„å¤æ‚å…³ç³»ï¼Œé€‚åˆéœ€è¦å…¨å±€è§†è§’çš„ä»»åŠ¡ã€‚</li>
<li>å¯æ‰©å±•æ€§å¼ºï¼Œæ˜“äºæ•´åˆå¤–éƒ¨çŸ¥è¯†åº“ã€‚</li>
</ol>
</li>
</ol>
</li>
<li>
<p>PoTï¼ˆPlan of Thoughtï¼Œæ€ç»´è§„åˆ’ï¼‰ï¼šå¼ºè°ƒ<strong>é¢„å…ˆåˆ¶å®šè§£å†³é—®é¢˜çš„æ€»ä½“è§„åˆ’</strong>ï¼Œå°†ä»»åŠ¡åˆ†è§£ä¸ºæ˜ç¡®çš„é˜¶æ®µæˆ–å­ç›®æ ‡ï¼ŒæŒ‰è®¡åˆ’é€æ­¥æ‰§è¡Œ
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc855d29dbed414a994517c5b92b4e82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-u5Lq65LiJ562J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769421902&amp;x-signature=QK4KT1fu2Tq33fLalAkt07m72SI%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<ol>
<li>PoTæ˜¯å°†é—®ç­”èƒŒåçš„æ¨ç†è¿‡ç¨‹å…¬å¼åŒ–ä¸ºä¸€ä¸ª<strong>å¯æ‰§è¡Œç¨‹åºï¼ˆProgramï¼‰</strong>ï¼Œå°†ç¨‹åºè§£é‡Šå™¨è¾“å‡ºä½œä¸ºæœ€ç»ˆç­”æ¡ˆçš„ä¸€éƒ¨åˆ†ã€‚
<ol>
<li>æ€ç»´ç¨‹åºï¼ˆPoTï¼‰æ˜¯ä¸€ç§ç‹¬ç‰¹çš„LLMæ¨ç†æ–¹æ³•ã€‚å®ƒä¸ä»…ä»…æ˜¯ç”Ÿæˆè‡ªç„¶è¯­è¨€ç­”æ¡ˆï¼Œè€Œæ˜¯è¦æ±‚åˆ›å»ºä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºï¼Œå¯ä»¥åœ¨Pythonç­‰ç¨‹åºè§£é‡Šå™¨ä¸Šè¿è¡Œï¼Œä»è€Œäº§ç”Ÿå®é™…çš„ç»“æœã€‚è¿™æ ·ï¼ŒPoTçš„è¡¨è¾¾æ›´åŠ æ¸…æ™°ã€å‡†ç¡®ï¼Œå°¤å…¶æ˜¯å¯¹äºéœ€è¦è¿›è¡Œæ•°å€¼è®¡ç®—çš„æ•°å­¦ç±»å‹é€»è¾‘é—®é¢˜æ›´æ˜¯å¦‚æ­¤ã€‚</li>
<li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPoTçš„ç¨‹åºæ‰§è¡Œä¸ä¸€å®šé’ˆå¯¹æœ€ç»ˆç­”æ¡ˆï¼Œè€Œæ˜¯å¯ä»¥ä½œä¸ºæœ€ç»ˆç­”æ¡ˆçš„ä¸­é—´æ­¥éª¤çš„ä¸€éƒ¨åˆ†ã€‚</li>
</ol>
</li>
<li>æ ¸å¿ƒæ–¹æ³•
<ol>
<li>åˆ†å±‚è§„åˆ’ï¼šå°†ä»»åŠ¡åˆ†ä¸ºé«˜å±‚ç›®æ ‡ï¼ˆå¦‚â€œå®Œæˆå¸‚åœºåˆ†ææŠ¥å‘Šâ€ï¼‰å’Œä½å±‚å­ä»»åŠ¡ï¼ˆå¦‚â€œæ•°æ®æ”¶é›†â†’è¶‹åŠ¿åˆ†æâ†’ç»“è®ºæ’°å†™â€ï¼‰ã€‚</li>
<li>æ—¶åºçº¦æŸï¼šæç¤ºæ¨¡å‹è€ƒè™‘ä»»åŠ¡çš„æ—¶é—´é¡ºåºå’Œä¾èµ–å…³ç³»ï¼ˆå¦‚â€œå¿…é¡»å…ˆå®ŒæˆAï¼Œæ‰èƒ½è¿›è¡ŒBâ€ï¼‰ã€‚</li>
<li>åŠ¨æ€è°ƒæ•´ï¼šåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ ¹æ®åé¦ˆä¼˜åŒ–è®¡åˆ’ï¼ˆå¦‚é‡åˆ°éšœç¢æ—¶åˆ‡æ¢å­ä»»åŠ¡é¡ºåºï¼‰ã€‚</li>
</ol>
</li>
<li>ä½¿ç”¨åœºæ™¯ï¼šå¤æ‚æ•°å­¦è¿ç®—ã€æ•°æ®å¤„ç†ã€è§„åˆ™åŒ–æ¨ç†</li>
<li>ä¼˜åŠ¿
<ol>
<li>æå‡ä»»åŠ¡æ‰§è¡Œçš„æ¡ç†æ€§ï¼Œå‡å°‘å†—ä½™æˆ–é—æ¼ã€‚</li>
<li>é€‚åˆéœ€è¦åˆ†é˜¶æ®µå®Œæˆçš„å¤æ‚ä»»åŠ¡ï¼Œé™ä½è®¤çŸ¥è´Ÿè·</li>
</ol>
</li>
<li>æ€»ç»“ä¸è¶‹åŠ¿
<ol>
<li>CoTä»æ˜¯åŸºç¡€èŒƒå¼ï¼Œå°¤å…¶é€‚åˆæ•™è‚²ã€é€»è¾‘æ¨ç†åœºæ™¯ã€‚</li>
<li>GoTå‡­å€Ÿå›¾ç»“æ„çš„çµæ´»æ€§ï¼Œæˆä¸ºå¤„ç†å¤æ‚ä»»åŠ¡çš„æ–°æ ‡æ†ï¼Œå¯èƒ½é€æ­¥å–ä»£ToTã€‚</li>
<li>PoTåœ¨éœ€è¦é«˜ç²¾åº¦è®¡ç®—çš„é¢†åŸŸï¼ˆå¦‚å·¥ç¨‹ã€é‡‘èï¼‰å…·æœ‰ä¸å¯æ›¿ä»£æ€§ã€‚</li>
</ol>
</li>
<li>å®è·µç»éªŒï¼š
<ol>
<li>ç®€å•é—®é¢˜ï¼šä¼˜å…ˆä½¿ç”¨CoTï¼Œä¿æŒæ¨ç†çš„ç®€æ´æ€§ã€‚</li>
<li>å¼€æ”¾é—®é¢˜ï¼šå°è¯•ToTï¼Œæ¢ç´¢å¤šç§å¯èƒ½æ€§åå†æ”¶æ•›ç­”æ¡ˆã€‚</li>
<li>å¤æ‚çŸ¥è¯†é—®é¢˜ï¼šç»“åˆGoTï¼Œåˆ©ç”¨å¤–éƒ¨çŸ¥è¯†å›¾è°±å¢å¼ºæ¨ç†æ·±åº¦ã€‚</li>
<li>é•¿æµç¨‹ä»»åŠ¡ï¼šé‡‡ç”¨PoTï¼Œç¡®ä¿ä»»åŠ¡æŒ‰è®¡åˆ’æœ‰åºæ¨è¿›ã€‚</li>
</ol>
</li>
<li>å®é™…ä½¿ç”¨ï¼šä¸å¤§æ¨¡å‹æ‰‹åŠ¨äº¤äº’ï¼› å·¥ç¨‹åŒ–å°è£…æˆæ¨¡æ¿</li>
</ol>








































<table><thead><tr><th>æ¡†æ¶</th><th>æ ¸å¿ƒé€»è¾‘</th><th>ç»“æ„ç‰¹ç‚¹</th><th>é€‚ç”¨ä»»åŠ¡ç±»å‹</th><th><strong>å…¸å‹åœºæ™¯</strong></th></tr></thead><tbody><tr><td><strong>CoT</strong></td><td>çº¿æ€§åˆ†æ­¥æ¨ç†</td><td>é“¾å¼ç»“æ„</td><td>å•è·¯å¾„ã€é€æ­¥æ¨å¯¼é—®é¢˜</td><td>æ•°å­¦é¢˜ã€é€»è¾‘æ¨ç†</td></tr><tr><td><strong>ToT</strong></td><td>å¤šè·¯å¾„æœç´¢ä¸è¯„ä¼°</td><td>æ ‘çŠ¶ç»“æ„</td><td>å¤šè§£æ¢ç´¢ã€éœ€å…¨å±€ä¼˜åŒ–çš„é—®é¢˜</td><td>æ¸¸æˆç­–ç•¥ã€åˆ›æ„ç”Ÿæˆ</td></tr><tr><td><strong>GoT</strong></td><td>å›¾ç»“æ„å…³ç³»æ•´åˆ</td><td>ç½‘çŠ¶ç»“æ„</td><td>å¤šç»´åº¦å…³è”ã€è·¨é¢†åŸŸæ¨ç†é—®é¢˜</td><td>çŸ¥è¯†å›¾è°±é—®ç­”ã€å¤æ‚å› æœåˆ†æ</td></tr><tr><td><strong>PoT</strong></td><td>åˆ†å±‚è§„åˆ’ä¸ä»»åŠ¡åˆ†è§£</td><td>å±‚çº§ç»“æ„</td><td>åˆ†é˜¶æ®µæ‰§è¡Œã€æ—¶åºä¾èµ–é—®é¢˜</td><td>é¡¹ç›®ç®¡ç†ã€é•¿æ–‡æœ¬ç”Ÿæˆ</td></tr></tbody></table>
</li>
<li>
<p>ReAct(Reason-Act æ¨ç† - è¡ŒåŠ¨æ¨¡å¼)ï¼š è®©æ¨¡å‹äº¤æ›¿æ‰§è¡Œ â€œæ€è€ƒä¸‹ä¸€æ­¥åŠ¨ä½œâ€ å’Œ â€œæ‰§è¡Œå·¥å…·è°ƒç”¨â€ï¼Œå®ç°é—­ç¯å†³ç­–
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc9b27b36e20424faff4b27e0a1618ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-u5Lq65LiJ562J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769421902&amp;x-signature=QpyjYBR7C3krMaTiOMjILDO7TQo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<ol>
<li>è™½ç„¶CoTå¢å¼ºäº†å¤§æ¨¡å‹çš„æ¨ç†èƒ½åŠ›ï¼Œä½†å®ƒçš„æ¨ç†è¿‡ç¨‹ä¸»è¦ä¾èµ–å¤§æ¨¡å‹å†…éƒ¨çš„çŸ¥è¯†åº“ï¼Œç¼ºä¹ä¸å¤–éƒ¨ä¸–ç•Œçš„å®æ—¶äº’åŠ¨ï¼Œè¿™å¯èƒ½å¯¼è‡´çŸ¥è¯†æ»åã€äº§ç”Ÿé”™è¯¯ä¿¡æ¯æˆ–è®©é”™è¯¯ä¸æ–­ä¼ é€’ã€‚ReActï¼ˆReasoning and Actionï¼‰æ¡†æ¶åˆ™ä¾æ®ç»“åˆâ€œæ¨ç†â€ï¼ˆReasoningï¼‰ä¸â€œè¡ŒåŠ¨â€ï¼ˆActionï¼‰ï¼Œè§£å†³äº†è¿™ä¸€æŒ‘æˆ˜ã€‚
<ol>
<li>å®ƒè®©å¤§æ¨¡å‹åœ¨æ¨ç†æ—¶èƒ½ä¸å¤–éƒ¨å·¥å…·æˆ–ç¯å¢ƒäº’åŠ¨ï¼Œè·å–æœ€æ–°ä¿¡æ¯ã€æ‰§è¡Œå…·ä½“æ“ä½œï¼Œå¹¶æ ¹æ®åé¦ˆè°ƒæ•´åç»­æ­¥éª¤ã€‚</li>
<li>è¿™ç§åŠ¨æ€äº¤äº’è®©å¤§æ¨¡å‹å…·å¤‡äº†â€œè¾¹æ€è€ƒè¾¹è¡ŒåŠ¨ã€è¾¹è§‚å¯Ÿè¾¹è°ƒæ•´â€çš„èƒ½åŠ›ï¼Œæ ¸å¿ƒè¿ä½œæœºåˆ¶å¯æ€»ç»“ä¸ºâ€œæ€è€ƒï¼ˆThoughtï¼‰â†’è¡ŒåŠ¨ï¼ˆActionï¼‰â†’è§‚å¯Ÿï¼ˆObservationï¼‰â€çš„å¾ªç¯ã€‚</li>
</ol>
</li>
<li>æµç¨‹ï¼šæ¥æ”¶ç›®æ ‡â†’æ¨ç†ç¬¬ä¸€æ­¥è¡ŒåŠ¨â†’æ‰§è¡Œâ†’è§‚å¯Ÿç»“æœâ†’åŸºäºç»“æœæ¨ç†ç¬¬äºŒæ­¥è¡ŒåŠ¨â†’å¾ªç¯ç›´è‡³å®Œæˆç›®æ ‡ï¼›æ— é¢„å…ˆå®Œæ•´è§„åˆ’ï¼Œä¾èµ–å®æ—¶åé¦ˆåŠ¨æ€å†³ç­–ï¼Œå¼ºè°ƒ â€œæ€è€ƒ - è¡ŒåŠ¨ - åé¦ˆâ€ çš„é—­ç¯
<ol>
<li>Thought (æ€è€ƒ): Agent é¦–å…ˆåŸºäºå½“å‰ç›®æ ‡å’Œä¹‹å‰çš„è§‚å¯Ÿè¿›è¡Œå†…éƒ¨â€œæ€è€ƒâ€ã€‚è¿™é€šå¸¸æ˜¯åˆ©ç”¨ LLM ç”Ÿæˆä¸€æ®µæè¿°å½“å‰çŠ¶æ€ã€åˆ†æé—®é¢˜ã€åˆ¶å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨ç­–ç•¥æˆ–åˆ†è§£ä»»åŠ¡çš„æ–‡æœ¬ã€‚</li>
<li>Action (è¡ŒåŠ¨):åŸºäºæ€è€ƒçš„ç»“æœï¼ŒAgent å†³å®šæ‰§è¡Œä¸€ä¸ªå…·ä½“çš„è¡ŒåŠ¨ã€‚è¿™é€šå¸¸æ˜¯è°ƒç”¨ä¸€ä¸ªå·¥å…·ï¼ˆå¦‚æœç´¢å¼•æ“ã€è®¡ç®—å™¨ã€APIï¼‰å¹¶é™„å¸¦å¿…è¦çš„å‚æ•°ï¼Œæˆ–è€…æ˜¯å‘ç”¨æˆ·è¯·æ±‚æ›´å¤šä¿¡æ¯ï¼Œç”šè‡³æ˜¯åˆ¤æ–­ä»»åŠ¡å·²ç»å®Œæˆå¹¶ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆã€‚</li>
<li>Observation (è§‚å¯Ÿ): æ‰§è¡Œè¡ŒåŠ¨åï¼ŒAgent ä¼šä»ç¯å¢ƒæˆ–å·¥å…·é‚£é‡Œè·å¾—ä¸€ä¸ªç»“æœæˆ–åé¦ˆï¼Œè¿™å°±æ˜¯â€œè§‚å¯Ÿâ€ã€‚ä¾‹å¦‚ï¼Œæœç´¢å¼•æ“è¿”å›çš„æœç´¢ç»“æœã€API è°ƒç”¨çš„è¾“å‡ºã€ä»£ç æ‰§è¡Œçš„é”™è¯¯ä¿¡æ¯ç­‰ã€‚</li>
<li>å›åˆ° Thought: Agentå°†è¿™ä¸ªè§‚å¯Ÿç»“æœçº³å…¥è€ƒé‡ï¼Œå¼€å§‹æ–°ä¸€è½®çš„æ€è€ƒï¼Œè¯„ä¼°ä¸Šä¸€æ­¥è¡ŒåŠ¨çš„æ•ˆæœï¼Œåˆ¤æ–­æ˜¯å¦å¿…é¡»è°ƒæ•´ç­–ç•¥ï¼Œå¹¶è§„åˆ’ä¸‹ä¸€æ­¥çš„è¡ŒåŠ¨ã€‚è¿™ä¸ªå¾ªç¯ä¸æ–­é‡å¤ï¼Œç›´åˆ° Agent åˆ¤æ–­ä»»åŠ¡ç›®æ ‡å·²ç»è¾¾æˆã€‚</li>
</ol>
</li>
<li>prompt çš„å·§å¦™è®¾è®¡ï¼š
<ol>
<li>ç®¡ç”¨æ€è€ƒ (Thought): æŒ‡ç¤ºLLM åˆ†æå½“å‰çŠ¶å†µã€å›é¡¾ç›®æ ‡ã€è¯„ä¼°å·²æœ‰ä¿¡æ¯ã€è¯†åˆ«çŸ¥è¯†å·®è·ã€åˆ¶å®šè¡ŒåŠ¨è®¡åˆ’ã€‚å¸¸å¸¸åŒ…å« â€œThink step-by-stepâ€ æˆ–ç±»ä¼¼çš„æŒ‡ä»¤ã€‚</li>
<li>åšå‡ºè¡ŒåŠ¨å†³ç­– (Action):æŒ‡ç¤º LLM ä»¥ç‰¹å®šæ ¼å¼ï¼ˆå¦‚ JSONï¼‰è¾“å‡ºè¦è°ƒç”¨çš„å™¨å…·åç§°å’Œå‚æ•°ï¼Œæˆ–è€…è¾“å‡ºæœ€ç»ˆç­”æ¡ˆã€‚</li>
<li>è§£è¯»è§‚å¯Ÿç»“æœ (Observation):å¸®åŠ© LLM ç†è§£è½¯ä»¶è¿”å›çš„ä¿¡æ¯ï¼Œå¹¶å°†å…¶èå…¥ä¸‹ä¸€æ­¥çš„æ€è€ƒä¸­ã€‚</li>
<li>Prompt è¿˜éœ€è¦åŒ…å«å¯ç”¨å·¥å…·çš„æè¿°ä»¥åŠä¸€äº›ç¤ºä¾‹ï¼ˆFew-shot examplesï¼‰ï¼Œæ¥å¸®åŠ© LLM æ›´å¥½åœ°ç†è§£å¦‚ä½•åœ¨è¿™ä¸ªå¾ªç¯ä¸­å·¥ä½œã€‚</li>
</ol>
</li>
<li>ä¼˜ç‚¹åˆ†æ
<ol>
<li>çµæ´»æ€§é«˜: ReAct èƒ½å¤Ÿæ ¹æ®æ¯ä¸€æ­¥çš„è§‚å¯Ÿç»“æœåŠ¨æ€è°ƒæ•´ç­–ç•¥ï¼Œå¯¹é¢„æ–™ä¹‹å¤–çš„æƒ…å†µæˆ–å·¥å…·æ‰§è¡Œå¤±è´¥å…·æœ‰è¾ƒå¼ºçš„é€‚åº”æ€§ã€‚</li>
<li>å¤„ç†çŸ¥è¯†å¯†é›†å‹ä»»åŠ¡: ç»è¿‡è¿­ä»£åœ°åº”ç”¨å·¥å…·ï¼ˆå¦‚æœç´¢ï¼‰è·å–ä¿¡æ¯ï¼ŒReAct èƒ½è¾ƒå¥½åœ°å¤„ç†éœ€å¤–éƒ¨çŸ¥è¯†çš„ä»»åŠ¡ã€‚</li>
<li>é€æ˜åº¦: â€œThoughtâ€æ­¥éª¤æä¾›äº† Agent å†³ç­–è¿‡ç¨‹çš„ä¸­é—´è®°å½•ï¼Œä¾¿äºç†è§£å’Œè°ƒè¯•ã€‚</li>
</ol>
</li>
<li>ç¼ºç‚¹åˆ†æ
<ol>
<li>å¯èƒ½é™·å…¥æ— æ•ˆå¾ªç¯: å¦‚æœ Agent çš„æ€è€ƒæˆ–å·¥å…·ä½¿ç”¨å‡ºç°åå·®ï¼Œå¯èƒ½ä¼šå¯¼è‡´åœ¨å‡ ä¸ªæ­¥éª¤ä¹‹é—´é‡å¤å¾ªç¯è€Œæ— æ³•å–å¾—è¿›å±•ã€‚</li>
<li>æ•ˆç‡è¾ƒä½: æ¯ä¸€æ­¥éƒ½éœ€ LLM è¿›è¡Œæ€è€ƒå’Œå†³ç­–ï¼Œå¯¹äºé•¿æµç¨‹ä»»åŠ¡ï¼ŒLLM è°ƒç”¨æ¬¡æ•°å¤šï¼Œå¯èƒ½å¯¼è‡´è¾ƒé«˜çš„å»¶è¿Ÿå’Œæˆæœ¬ã€‚</li>
<li>é”™è¯¯ç´¯ç§¯: å‰ä¸€æ­¥çš„é”™è¯¯ï¼ˆå¦‚é”™è¯¯çš„æ€è€ƒæˆ–åº”ç”¨è°ƒç”¨å¤±è´¥ï¼‰å¯èƒ½ä¼šå½±å“åç»­æ­¥éª¤ï¼Œå¯¼è‡´æœ€ç»ˆç»“æœåå·®ã€‚</li>
</ol>
</li>
<li>ä½¿ç”¨åœºæ™¯ï¼šæ™ºèƒ½ä½“ï¼ˆAgentï¼‰ã€éœ€è¦å¤–éƒ¨å·¥å…·çš„ä»»åŠ¡ï¼ˆå¦‚ä¿¡æ¯æ£€ç´¢ã€æ•°æ®åˆ†æï¼‰
<ol>
<li>ä»»åŠ¡ç®€å•ã€æ— éœ€é•¿æœŸè§„åˆ’ï¼ˆå¦‚å•è½®é—®ç­”ã€API è°ƒç”¨ï¼‰ã€‚</li>
<li>å¸Œæœ›å¿«é€Ÿéƒ¨ç½²ï¼Œé¿å…è®­ç»ƒæˆæœ¬ã€‚</li>
</ol>
</li>
</ol>
</li>
<li>
<p>Plan-Actï¼ˆè§„åˆ’ - æ‰§è¡Œï¼‰æ¨¡å¼ï¼šä¸€ç§<strong>çº¿æ€§çš„ â€œå…ˆè§„åˆ’åæ‰§è¡Œâ€ æ¨¡å¼</strong>ï¼Œæ ¸å¿ƒæ˜¯ â€œå…ˆåˆ¶å®šå®Œæ•´è®¡åˆ’ï¼Œå†æŒ‰è®¡åˆ’é€æ­¥æ‰§è¡Œâ€ï¼Œæ— ä¸­é—´<strong>åé¦ˆè°ƒæ•´</strong>ç¯èŠ‚ï¼š</p>
<ol>
<li>
<p>æµç¨‹ï¼šæ¥æ”¶ç›®æ ‡â†’æ‹†è§£ä¸ºå›ºå®šå­ä»»åŠ¡åºåˆ—â†’æŒ‰é¡ºåºæ‰§è¡Œæ‰€æœ‰æ­¥éª¤â†’è¾“å‡ºç»“æœï¼›</p>
</li>
<li>
<p>ç‰¹ç‚¹ï¼šè§„åˆ’é˜¶æ®µä¸€æ¬¡æ€§ç¡®å®šæ‰€æœ‰è¡ŒåŠ¨è·¯å¾„ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­ä¸æ ¹æ®å®é™…ç»“æœä¿®æ”¹è®¡åˆ’ï¼›</p>
</li>
<li>
<p><strong>Plan-and-Execute æ¡†æ¶ï¼šç»“æ„åŒ–è§„åˆ’ä¸é¡ºåºæ‰§è¡Œ</strong>ï¼šä¸ ReAct çš„è¿­ä»£è¯•é”™ä¸åŒï¼ŒPlan-and-Execute (P-a-E) é‡‡å–äº†ä¸€ç§æ›´ç»“æ„åŒ–ã€æ›´çº¿æ€§çš„é€”å¾„ã€‚</p>
<ol>
<li>
<p>Planning (è§„åˆ’) é˜¶æ®µ: é¦–å…ˆï¼ŒAgentï¼ˆé€šå¸¸é€šè¿‡ä¸€æ¬¡æˆ–å°‘æ•°å‡ æ¬¡ LLM è°ƒç”¨ï¼‰åŸºäºç”¨æˆ·ç»™å®šçš„åˆå§‹ç›®æ ‡ï¼Œç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„ã€é€šå¸¸æ˜¯åˆ†æ­¥éª¤çš„æ‰§è¡Œè®¡åˆ’ã€‚è¿™ä¸ªè®¡åˆ’åˆ—å‡ºäº†ä¸ºè¾¾æˆç›®æ ‡æ‰€éœ€æ‰§è¡Œçš„æ‰€æœ‰æ­¥éª¤åŠå…¶é¡ºåºã€‚</p>
</li>
<li>
<p>Execution (æ‰§è¡Œ) é˜¶æ®µ: ç„¶åï¼ŒAgentä¸¥æ ¼æŒ‰ç…§é¢„å…ˆåˆ¶å®šçš„è®¡åˆ’ï¼Œä¸€æ­¥ä¸€æ­¥åœ°é¡ºåºæ‰§è¡Œã€‚é€šå¸¸æ¯ä¸€æ­¥ä¼šæ¶‰åŠè°ƒç”¨ä¸€ä¸ªæˆ–å¤šä¸ªç¨‹åºã€‚åªæœ‰å½“å‰æ­¥éª¤æˆåŠŸè¾¾æˆåï¼Œæ‰ä¼šè¿›å…¥ä¸‹ä¸€æ­¥ã€‚</p>
</li>
<li>
<p>è§„åˆ’å™¨ (Planner): è´Ÿè´£ä¸€ä¸ªä¸“é—¨çš„ LLM è°ƒç”¨ï¼Œå…¶ Prompt æ—¨åœ¨è¾“å‡ºä¸€ä¸ªæ¸…æ™°çš„æ­¥éª¤åˆ—è¡¨æˆ–å¸¦æœ‰ä¾èµ–å…³ç³»çš„è®¡åˆ’å°±æ˜¯ç†è§£åˆå§‹ç›®æ ‡å¹¶ç”Ÿæˆç»“æ„åŒ–çš„æ‰§è¡Œè®¡åˆ’ã€‚è¿™é€šå¸¸ã€‚è®¡åˆ’çš„è´¨é‡ç›´æ¥å†³å®šäº† Agent çš„æœ€ç»ˆè¡¨ç°ã€‚</p>
</li>
<li>
<p>æ‰§è¡Œå™¨ (Executor): è´Ÿè´£è§£æè®¡åˆ’ï¼Œå¹¶æŒ‰é¡ºåºè°ƒåº¦å·¥å…·æ‰§è¡Œæ¯ä¸ªæ­¥éª¤ã€‚å®ƒéœ€è¦ç®¡ç†æ­¥éª¤é—´çš„çŠ¶æ€ä¼ é€’ï¼ˆå¦‚ä¸Šä¸€æ­¥çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€æ­¥çš„è¾“å…¥ï¼‰ï¼Œä½†ä¸è´Ÿè´£é‡æ–°è§„åˆ’ï¼ˆé™¤éè®¾è®¡äº†éå¸¸å¤æ‚çš„é”™è¯¯å¤„ç†é€»è¾‘ï¼‰ã€‚</p>
</li>
<li>
<p>æ³¨ï¼šè¿™äº›éƒ½æ›´åå‘äºåœ¨ Agent ä¸­ä½¿ç”¨ï¼Œä»¥ä¸‹ä¸ºä»‹ç»çš„ä¸‰ç§æ¨¡å¼çš„å¯¹æ¯”ï¼Œä»¥åŠè½åœ°è¾ƒå¤šçš„å››ç§èŒƒå¼</p>



































<table><thead><tr><th>ç»´åº¦</th><th>Plan-Act æ¨¡å¼</th><th>ReAct æ¨¡å¼</th></tr></thead><tbody><tr><td><strong>è§„åˆ’æ–¹å¼</strong></td><td>é¢„å…ˆåˆ¶å®šå®Œæ•´ã€å›ºå®šçš„è®¡åˆ’</td><td>æ— é¢„å…ˆè®¡åˆ’ï¼Œæ¯æ­¥åŠ¨æ€æ¨ç†</td></tr><tr><td><strong>åé¦ˆæœºåˆ¶</strong></td><td>æ— æ‰§è¡Œä¸­åé¦ˆï¼Œè®¡åˆ’ä¸€æ—¦ç¡®å®šä¸ä¿®æ”¹</td><td>æ¯æ­¥æ‰§è¡Œåå‡æ ¹æ®ç»“æœåé¦ˆè°ƒæ•´ç­–ç•¥</td></tr><tr><td><strong>çµæ´»æ€§</strong></td><td>ä½ï¼Œæ— æ³•åº”å¯¹è®¡åˆ’å¤–çš„å¼‚å¸¸æƒ…å†µ</td><td>é«˜ï¼Œå¯é€‚é…ç¯å¢ƒå˜åŒ–æˆ–æ„å¤–ç»“æœ</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>ç®€å•ã€ç¡®å®šæ€§é«˜çš„ä»»åŠ¡ï¼ˆå¦‚å›ºå®šæµç¨‹è‡ªåŠ¨åŒ–ï¼‰</td><td>ç¹çã€ä¸ç¡®å®šæ€§é«˜çš„ä»»åŠ¡ï¼ˆå¦‚å¤šå¹³å°æ¯”ä»·ã€æ•…éšœæ’æŸ¥ï¼‰</td></tr><tr><td><strong>å†³ç­–é€»è¾‘</strong></td><td>é™æ€çš„ â€œè®¡åˆ’é©±åŠ¨â€</td><td>åŠ¨æ€çš„ â€œåé¦ˆé©±åŠ¨â€</td></tr></tbody></table>
</li>
</ol>






























<table><thead><tr><th>èŒƒå¼åç§°</th><th>æ ¸å¿ƒä»·å€¼</th><th>å…¸å‹åº”ç”¨</th></tr></thead><tbody><tr><td><strong>Self-Consistencyï¼ˆè‡ªæ´½æ€§æ¨ç†ï¼‰</strong></td><td>å¤§å¹…é™ä½æ¨¡å‹å¹»è§‰ï¼Œæå‡ç»“æœå¯é æ€§</td><td>æ•°å­¦è®¡ç®—ã€å¸¸è¯†é—®ç­”ã€äº‹å®æ€§æ£€ç´¢</td></tr><tr><td><strong>Self-Refineï¼ˆè‡ªæˆ‘ä¼˜åŒ–æ¨ç†ï¼‰</strong></td><td>è¿­ä»£æå‡å†…å®¹è´¨é‡ï¼Œæ— éœ€äººå·¥ä»‹å…¥</td><td>æ–‡æ¡ˆæ’°å†™ã€æŠ¥å‘Šç”Ÿæˆã€ä»£ç ä¼˜åŒ–</td></tr><tr><td>Least-to-Mostï¼ˆç”±æ˜“åˆ°éš¾æç¤ºï¼‰</td><td>æ‹†è§£å¤æ‚é—®é¢˜ï¼Œæ”»å…‹ â€œæ— ä»ä¸‹æ‰‹â€ çš„ä»»åŠ¡</td><td>æ•°å­¦è¯æ˜ã€å¤æ‚ä»£ç ç¼–å†™ã€å¤šæ­¥éª¤å†³ç­–</td></tr><tr><td>Reflexionï¼ˆåæ€å¼æ¨ç†ï¼‰</td><td>è®©æ¨¡å‹ä»é”™è¯¯ä¸­å­¦ä¹ ï¼Œä¼˜åŒ–åç»­æ‰§è¡Œ</td><td>å·¥å…·è°ƒç”¨è°ƒè¯•ã€å¤šè½®å¯¹è¯çº é”™ã€æ•…éšœæ’æŸ¥</td></tr></tbody></table>
</li>
</ol>
</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fad6601cd7984d208cbee4c8290bcf06~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55-u5Lq65LiJ562J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769421902&amp;x-signature=nOQbgBmzbzGHggoyw47M6shCqqU%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-1">2 ç»“æ„åŒ–æç¤ºæ¡†æ¶</h2>
<ol>
<li>æ³¨ï¼šä¸Šé¢çš„éƒ½æ˜¯æç¤ºè¯å·¥ç¨‹çš„ä¸åŒæ€è·¯æ–¹æ³•ï¼Œç»“æ„åŒ–æç¤ºæ¡†æ¶æ›´åƒæ˜¯å¯¹æç¤ºè¯å·¥ç¨‹çš„ä¸€ä¸ªè§„èŒƒæ¨¡æ¿ï¼Œé¿å…é—æ¼ä¿¡æ¯ï¼ŒæŒ‰ç…§æ¨¡æ¿å¡«å†™å¯¹åº”ä¿¡æ¯å³å¯ï¼Œä»¥ä¸‹ä¸ºå½“å‰ä¸»æµçš„æç¤ºè¯å·¥ç¨‹æ¡†æ¶åŠå…¶æ ¸å¿ƒè¦ç´ ã€é€‚ç”¨åœºæ™¯</li>
<li>ICIO æ¡†æ¶
<ol>
<li>æ ¸å¿ƒè¦ç´ ï¼š
<ol>
<li>Instructionï¼ˆä»»åŠ¡ï¼‰ï¼šæ˜ç¡®AIéœ€è¦å®Œæˆçš„å…·ä½“ä»»åŠ¡ï¼ˆå¦‚ç¿»è¯‘ã€å†™ä½œï¼‰ã€‚</li>
<li>Contextï¼ˆèƒŒæ™¯ï¼‰ï¼šæä¾›ä»»åŠ¡ç›¸å…³çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆå¦‚ä½¿ç”¨åœºæ™¯ã€ç›®æ ‡å—ä¼—ï¼‰ã€‚</li>
<li>Input Dataï¼ˆè¾“å…¥æ•°æ®ï¼‰ï¼šæŒ‡å®šéœ€è¦å¤„ç†çš„å…·ä½“æ•°æ®ï¼ˆå¦‚å¾…ç¿»è¯‘çš„æ–‡æœ¬ï¼‰ã€‚</li>
<li>Output Indicatorï¼ˆè¾“å‡ºæ ¼å¼ï¼‰ï¼šå®šä¹‰è¾“å‡ºçš„é£æ ¼ã€æ ¼å¼æˆ–ç±»å‹ï¼ˆå¦‚æ­£å¼å•†åŠ¡è‹±è¯­ï¼‰ã€‚</li>
</ol>
</li>
<li>é€‚ç”¨åœºæ™¯ï¼šæ•°æ®è½¬æ¢ï¼ˆæ–‡æœ¬ç¿»è¯‘ã€æ¸…æ´—ï¼‰ã€å†…å®¹åˆ›ä½œï¼ˆæŠ¥å‘Šã€æ–‡æ¡ˆï¼‰ã€æŠ€æœ¯ä»»åŠ¡ï¼ˆä»£ç ç”Ÿæˆï¼‰ã€‚</li>
</ol>
</li>
<li>CRISPE æ¡†æ¶
<ol>
<li>æ ¸å¿ƒè¦ç´ ï¼š
<ol>
<li>Capacity and Roleï¼ˆè§’è‰²ï¼‰ï¼šè®¾å®šAIçš„è§’è‰²ï¼ˆå¦‚æ•°å­¦è€å¸ˆï¼‰ã€‚</li>
<li>Insightï¼ˆèƒŒæ™¯ï¼‰ï¼šæä¾›è§’è‰²æ‰®æ¼”çš„ä¸Šä¸‹æ–‡ï¼ˆå¦‚å­¦ç”Ÿå¹´é¾„ã€å­¦ä¹ ç¯å¢ƒï¼‰ã€‚</li>
<li>Statementï¼ˆä»»åŠ¡ï¼‰ï¼šå…·ä½“ä»»åŠ¡æè¿°ï¼ˆå¦‚è§£ç­”æ•°å­¦é—®é¢˜ï¼‰ã€‚</li>
<li>Personalityï¼ˆæ ¼å¼ï¼‰ï¼šå›ç­”çš„é£æ ¼ï¼ˆå¦‚å‹å¥½ã€é¼“åŠ±æ€§è¯­è¨€ï¼‰ã€‚</li>
<li>Experimentï¼ˆå®éªŒï¼‰ï¼šè¯·æ±‚å¤šä¸ªç¤ºä¾‹æˆ–å˜ä½“ã€‚</li>
</ol>
</li>
<li>é€‚ç”¨åœºæ™¯ï¼šè§’è‰²æ¨¡æ‹Ÿï¼ˆæ•™å¸ˆã€é¡¾é—®ï¼‰ã€ä¸ªæ€§åŒ–äº’åŠ¨ï¼ˆå¹½é»˜/æ­£å¼è¯­æ°”ï¼‰ã€å¤šæ ·åŒ–è¾“å‡ºï¼ˆå¤šæ–¹æ¡ˆç”Ÿæˆï¼‰ã€‚</li>
</ol>
</li>
<li>BROKE æ¡†æ¶
<ol>
<li>æ ¸å¿ƒè¦ç´ ï¼š
<ol>
<li>Backgroundï¼ˆèƒŒæ™¯ï¼‰ï¼šé¡¹ç›®æˆ–ä»»åŠ¡çš„èƒŒæ™¯ä¿¡æ¯ã€‚</li>
<li>Roleï¼ˆè§’è‰²ï¼‰ï¼šAIéœ€æ‰®æ¼”çš„è§’è‰²ï¼ˆå¦‚é¡¹ç›®ç»ç†ï¼‰ã€‚</li>
<li>Objectivesï¼ˆç›®æ ‡ï¼‰ï¼šæ˜ç¡®ä»»åŠ¡ç›®æ ‡ï¼ˆå¦‚åˆ¶å®šé¡¹ç›®è®¡åˆ’ï¼‰ã€‚</li>
<li>Key Resultï¼ˆå…³é”®ç»“æœï¼‰ï¼šè¾“å‡ºçš„æ ¼å¼è¦æ±‚ï¼ˆå¦‚ç”˜ç‰¹å›¾ï¼‰ã€‚</li>
<li>Evolveï¼ˆæ”¹è¿›ï¼‰ï¼šæ ¹æ®åé¦ˆè¿­ä»£ä¼˜åŒ–ã€‚</li>
</ol>
</li>
<li>é€‚ç”¨åœºæ™¯ï¼šé¡¹ç›®ç®¡ç†ï¼ˆèµ„æºåˆ†é…ï¼‰ã€åˆ›æ„è®¾è®¡ï¼ˆå¤šè½®ä¼˜åŒ–ï¼‰ã€æ•°æ®åˆ†æï¼ˆåŠ¨æ€è°ƒæ•´ï¼‰ã€‚</li>
</ol>
</li>
<li>RASCEF æ¡†æ¶
<ol>
<li>æ ¸å¿ƒè¦ç´ ï¼š
<ol>
<li>Roleï¼ˆè§’è‰²ï¼‰ï¼šå®šä¹‰AIèº«ä»½ï¼ˆå¦‚è¥é”€ä¸“å®¶ï¼‰ã€‚</li>
<li>Actionï¼ˆè¡ŒåŠ¨ï¼‰ï¼šå…·ä½“ä»»åŠ¡ï¼ˆå¦‚åˆ¶å®šé‚®ä»¶ç­–ç•¥ï¼‰ã€‚</li>
<li>Scriptï¼ˆæ­¥éª¤ï¼‰ï¼šåˆ†æ­¥éª¤æµç¨‹ï¼ˆå¦‚åˆ†æå—ä¼—â†’è®¾è®¡å†…å®¹ï¼‰ã€‚</li>
<li>Contentï¼ˆä¸Šä¸‹æ–‡ï¼‰ï¼šèƒŒæ™¯ä¿¡æ¯ï¼ˆå¦‚å…¬å¸å®šä½ï¼‰ã€‚</li>
<li>Exampleï¼ˆç¤ºä¾‹ï¼‰ï¼šè¾“å‡ºç¤ºä¾‹ï¼ˆå¦‚å¥åº·é¥®é£Ÿæ¨æ–‡ï¼‰ã€‚</li>
<li>Formatï¼ˆæ ¼å¼ï¼‰ï¼šæŒ‡å®šç»“æ„ï¼ˆå¦‚åˆ—è¡¨ã€æ®µè½ï¼‰ã€‚</li>
</ol>
</li>
<li>é€‚ç”¨åœºæ™¯ï¼šä¸“ä¸šå’¨è¯¢ï¼ˆè¥é”€ç­–ç•¥ï¼‰ã€æµç¨‹ç®¡ç†ï¼ˆé¡¹ç›®ç®¡ç†ï¼‰ã€æ ‡å‡†åŒ–è¾“å‡ºï¼ˆæ¨¡æ¿åŒ–å†…å®¹ï¼‰ã€‚</li>
</ol>
</li>
<li>CO-STAR æ¡†æ¶
<ol>
<li>æ ¸å¿ƒè¦ç´ ï¼š
<ol>
<li>Contextï¼ˆä¸Šä¸‹æ–‡ï¼‰ï¼šä»»åŠ¡èƒŒæ™¯ã€‚</li>
<li>Objectiveï¼ˆç›®æ ‡ï¼‰ï¼šæ˜ç¡®æ ¸å¿ƒä»»åŠ¡ã€‚</li>
<li>Styleï¼ˆé£æ ¼ï¼‰ï¼šæ¨¡ä»¿ç‰¹å®šå†™ä½œé£æ ¼ã€‚</li>
<li>Toneï¼ˆè¯­æ°”ï¼‰ï¼šæƒ…æ„ŸåŸºè°ƒï¼ˆæ­£å¼/å¹½é»˜ï¼‰ã€‚</li>
<li>Audienceï¼ˆå—ä¼—ï¼‰ï¼šç›®æ ‡ç”¨æˆ·ç¾¤ä½“ã€‚</li>
<li>Responseï¼ˆå›å¤æ ¼å¼ï¼‰ï¼šè¾“å‡ºç»“æ„ï¼ˆå¦‚åˆ—è¡¨ã€æŠ¥å‘Šï¼‰ã€‚</li>
</ol>
</li>
<li>é€‚ç”¨åœºæ™¯ï¼šå¹¿å‘Šæ–‡æ¡ˆã€ç¤¾äº¤åª’ä½“å†…å®¹ã€ä¸ªæ€§åŒ–æŠ¥å‘Šã€‚</li>
</ol>
</li>
<li>RODES æ¡†æ¶
<ol>
<li>æ ¸å¿ƒè¦ç´ 
<ol>
<li>Roleï¼ˆè§’è‰²ï¼‰ï¼šè¯¦ç»†å®šä¹‰AIèº«ä»½ï¼ˆå¦‚ç—…æ¯’æ¨æ–‡ä½œå®¶ï¼‰ã€‚</li>
<li>Objectiveï¼ˆç›®æ ‡ï¼‰ï¼šå…·ä½“ä»»åŠ¡ï¼ˆå¦‚æ’°å†™280å­—æ¨æ–‡ï¼‰ã€‚</li>
<li>Detailsï¼ˆç»†èŠ‚ï¼‰ï¼šçº¦æŸæ¡ä»¶ï¼ˆå¦‚ç¦ç”¨è¡¨æƒ…ç¬¦å·ï¼‰ã€‚</li>
<li>Examplesï¼ˆç¤ºä¾‹ï¼‰ï¼šè¾“å…¥-è¾“å‡ºèŒƒä¾‹ã€‚</li>
<li>Sense Checkï¼ˆæ„ŸçŸ¥æ£€æŸ¥ï¼‰ï¼šç¡®è®¤AIç†è§£éœ€æ±‚ã€‚</li>
</ol>
</li>
<li>é€‚ç”¨åœºæ™¯ï¼šç¤¾äº¤åª’ä½“è¿è¥ã€åˆ›æ„å†…å®¹ç”Ÿæˆã€æ–°æ‰‹å‹å¥½å‹æç¤ºè®¾è®¡ã€‚</li>
</ol>
</li>
<li>é€‰æ‹©å‚è€ƒï¼š
<ol>
<li>æŠ€æœ¯ä»»åŠ¡ï¼šä¼˜å…ˆä½¿ç”¨ICIOæˆ–BROKEï¼Œç¡®ä¿é€»è¾‘æ¸…æ™°ã€‚</li>
<li>åˆ›æ„å†…å®¹ï¼šCRISPEæˆ–RODESæ›´é€‚åˆè§’è‰²åŒ–ã€é£æ ¼åŒ–éœ€æ±‚ã€‚</li>
<li>å¤æ‚æµç¨‹ï¼šRASCEFå’ŒCO-STARæä¾›ç»“æ„åŒ–æ”¯æŒã€‚</li>
</ol>
</li>
<li>ä½¿ç”¨æ–¹æ³•ï¼šæ‰‹åŠ¨äº¤äº’/å·¥ç¨‹åŒ–å°è£…</li>
</ol>








































<table><thead><tr><th>æ¡†æ¶</th><th>æ ¸å¿ƒç‰¹ç‚¹</th><th>é€‚ç”¨é¢†åŸŸ</th></tr></thead><tbody><tr><td>ICIO</td><td>ä»»åŠ¡æ˜ç¡®ã€æ ¼å¼æ ‡å‡†åŒ–</td><td>æŠ€æœ¯ä»»åŠ¡ã€ç¿»è¯‘ã€æŠ¥å‘Š</td></tr><tr><td>CRISPE</td><td>è§’è‰²æ‰®æ¼”ã€å¤šæ–¹æ¡ˆç”Ÿæˆ</td><td>æ•™è‚²ã€å’¨è¯¢ã€ä¸ªæ€§åŒ–äº’åŠ¨</td></tr><tr><td>BROKE</td><td>åŠ¨æ€ä¼˜åŒ–ã€é¡¹ç›®ç®¡ç†å¯¼å‘</td><td>é•¿æœŸé¡¹ç›®ã€æ•°æ®åˆ†æ</td></tr><tr><td>RASCEF</td><td>æµç¨‹åŒ–æ­¥éª¤ã€å…¨é¢ç»“æ„åŒ–</td><td>ä¸“ä¸šå’¨è¯¢ã€å¤æ‚æµç¨‹ç®¡ç†</td></tr><tr><td>CO-STAR</td><td>å¤šç»´åº¦å®šåˆ¶ï¼ˆé£æ ¼/å—ä¼—ï¼‰</td><td>å¹¿å‘Šã€ç¤¾äº¤åª’ä½“</td></tr><tr><td>RODES</td><td>æ–°æ‰‹å‹å¥½ã€å¼ºè°ƒç¤ºä¾‹ä¸åé¦ˆ</td><td>åˆ›æ„å†…å®¹ã€æ ‡å‡†åŒ–è¾“å‡º</td></tr></tbody></table>
<h2 data-id="heading-2">å‚è€ƒèµ„æ–™</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.cnblogs.com%2Fljbguanli%2Fp%2F19453654" target="_blank" title="https://www.cnblogs.com/ljbguanli/p/19453654" ref="nofollow noopener noreferrer">1</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fweixin_44986037%2Farticle%2Fdetails%2F148028458" target="_blank" title="https://blog.csdn.net/weixin_44986037/article/details/148028458" ref="nofollow noopener noreferrer">2</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android JNI å¼€å‘å®Œå…¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7596709272976179246</link>    <guid>https://juejin.cn/post/7596709272976179246</guid>    <pubDate>2026-01-19T09:58:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596709272976179246" data-draft-id="7596845113280888841" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android JNI å¼€å‘å®Œå…¨æŒ‡å—"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-01-19T09:58:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="aykon"/> <meta itemprop="url" content="https://juejin.cn/user/3984285870883080"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android JNI å¼€å‘å®Œå…¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3984285870883080/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    aykon
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T09:58:04.000Z" title="Mon Jan 19 2026 09:58:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    13
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Android JNI å¼€å‘å®Œå…¨æŒ‡å—</h2>
<h3 data-id="heading-1">ç›®å½•</h3>
<ol>
<li><a href="#1-jni-%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5" title="#1-jni-%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5">JNI åŸºç¡€æ¦‚å¿µ</a></li>
<li><a href="#2-external-%E5%85%B3%E9%94%AE%E5%AD%97%E8%AF%A6%E8%A7%A3" title="#2-external-%E5%85%B3%E9%94%AE%E5%AD%97%E8%AF%A6%E8%A7%A3">external å…³é”®å­—è¯¦è§£</a></li>
<li><a href="#3-jni-%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83" title="#3-jni-%E5%91%BD%E5%90%8D%E8%A7%84%E8%8C%83">JNI å‘½åè§„èŒƒ</a></li>
<li><a href="#4-so-%E5%BA%93%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6" title="#4-so-%E5%BA%93%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6">so åº“åŠ è½½æœºåˆ¶</a></li>
<li><a href="#5-jvm-%E6%96%B9%E6%B3%95%E6%9F%A5%E6%89%BE%E4%B8%8E%E7%BC%93%E5%AD%98" title="#5-jvm-%E6%96%B9%E6%B3%95%E6%9F%A5%E6%89%BE%E4%B8%8E%E7%BC%93%E5%AD%98">JVM æ–¹æ³•æŸ¥æ‰¾ä¸ç¼“å­˜</a></li>
<li><a href="#6-jni-%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F" title="#6-jni-%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F">JNI ç±»å‹ç³»ç»Ÿ</a></li>
<li><a href="#7-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86" title="#7-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86">å†…å­˜ç®¡ç†</a></li>
<li><a href="#8-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B" title="#8-%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B">å®æˆ˜æ¡ˆä¾‹</a></li>
<li><a href="#9-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5" title="#9-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">æœ€ä½³å®è·µ</a></li>
<li><a href="#10-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98" title="#10-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98">å¸¸è§é—®é¢˜</a></li>
</ol>
<hr/>
<h3 data-id="heading-2">1. JNI åŸºç¡€æ¦‚å¿µ</h3>
<h4 data-id="heading-3">1.1 ä»€ä¹ˆæ˜¯ JNIï¼Ÿ</h4>
<p><strong>JNI (Java Native Interface)</strong> æ˜¯ Java å¹³å°çš„æ ‡å‡†ç¼–ç¨‹æ¥å£ï¼Œå…è®¸ Java ä»£ç ä¸ä½¿ç”¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ï¼ˆä¸»è¦æ˜¯ C/C++ï¼‰ç¼–å†™çš„åº”ç”¨ç¨‹åºå’Œåº“è¿›è¡Œäº¤äº’ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Java/Kotlin å±‚                                         â”‚
â”‚  â”œâ”€ Activity/Fragment                                  â”‚
â”‚  â”œâ”€ ä¸šåŠ¡é€»è¾‘                                            â”‚
â”‚  â””â”€ <span class="hljs-keyword">external</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">nativeMethod</span><span class="hljs-params">()</span></span>  â† è°ƒç”¨ Native æ–¹æ³•     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“ JNI
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JNI æ¥å£å±‚                                             â”‚
â”‚  â”œâ”€ JNIEnv (JNI ç¯å¢ƒæŒ‡é’ˆ)                              â”‚
â”‚  â”œâ”€ ç±»å‹è½¬æ¢                                            â”‚
â”‚  â””â”€ æ–¹æ³•è°ƒç”¨                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Native å±‚ (C/C++)                                      â”‚
â”‚  â”œâ”€ é«˜æ€§èƒ½è®¡ç®—                                          â”‚
â”‚  â”œâ”€ FFmpeg/OpenCV ç­‰åº“                                 â”‚
â”‚  â””â”€ ç¡¬ä»¶åŠ é€Ÿ                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-4">1.2 ä¸ºä»€ä¹ˆä½¿ç”¨ JNIï¼Ÿ</h4>






























<table><thead><tr><th>åº”ç”¨åœºæ™¯</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><strong>æ€§èƒ½ä¼˜åŒ–</strong></td><td>C/C++ æ‰§è¡Œæ•ˆç‡é«˜ï¼Œé€‚åˆè®¡ç®—å¯†é›†å‹ä»»åŠ¡</td><td>å›¾åƒå¤„ç†ã€éŸ³è§†é¢‘ç¼–è§£ç </td></tr><tr><td><strong>å¤ç”¨ç°æœ‰åº“</strong></td><td>ä½¿ç”¨æˆç†Ÿçš„ C/C++ åº“</td><td>FFmpegã€OpenCVã€OpenGL</td></tr><tr><td><strong>ç¡¬ä»¶è®¿é—®</strong></td><td>æŸäº›ç¡¬ä»¶åªæä¾› C å±‚æ¥å£</td><td>ç›¸æœºã€ä¼ æ„Ÿå™¨ã€NFC</td></tr><tr><td><strong>ä»£ç ä¿æŠ¤</strong></td><td>Native ä»£ç åç¼–è¯‘éš¾åº¦é«˜</td><td>æ ¸å¿ƒç®—æ³•ã€åŠ å¯†é€»è¾‘</td></tr></tbody></table>
<h4 data-id="heading-5">1.3 JNI çš„ç»„æˆéƒ¨åˆ†</h4>
<pre><code class="hljs language-markdown" lang="markdown">JNI åŒ…å«ä¸‰ä¸ªæ ¸å¿ƒéƒ¨åˆ†ï¼š

<span class="hljs-bullet">1.</span> Kotlin/Java ä»£ç 
<span class="hljs-bullet">   -</span> å£°æ˜ native æ–¹æ³•
<span class="hljs-bullet">   -</span> åŠ è½½ Native åº“

<span class="hljs-bullet">2.</span> JNI æ¥å£å±‚
<span class="hljs-bullet">   -</span> JNIEnv <span class="hljs-emphasis">*envï¼šJNI ç¯å¢ƒæŒ‡é’ˆ
   - ç±»å‹è½¬æ¢å‡½æ•°
   - è°ƒç”¨ Java æ–¹æ³•

3. Native ä»£ç  (C/C++)
   - å®ç° native æ–¹æ³•
   - è°ƒç”¨ç³»ç»Ÿåº“
   - æ€§èƒ½æ•æ„Ÿæ“ä½œ
</span></code></pre>
<hr/>
<h3 data-id="heading-6">2. external å…³é”®å­—è¯¦è§£</h3>
<h4 data-id="heading-7">2.1 external çš„å«ä¹‰</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Kotlin å±‚å£°æ˜</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">external</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">compressImage</span><span class="hljs-params">(path: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Boolean</span>
<span class="hljs-comment">//        ^^^^^^^^</span>
<span class="hljs-comment">//        å£°æ˜æ­¤æ–¹æ³•çš„å®ç°ç”± Native ä»£ç æä¾›</span>
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>âŒ ä¸æ˜¯ç›´æ¥è°ƒç”¨ C æ–¹æ³•</li>
<li>âœ… æ˜¯å£°æ˜ï¼š"æ–¹æ³•å®ç°ä½äº Native åº“ä¸­ï¼ŒJVM ä¼šå»æ‰¾"</li>
<li>âœ… ç±»ä¼¼äºæ¥å£å£°æ˜ï¼Œé€šè¿‡ JNI å‘½åè§„èŒƒå…³è”åˆ° C++ å®ç°</li>
</ul>
<h4 data-id="heading-8">2.2 external çš„å·¥ä½œæµç¨‹</h4>
<pre><code class="hljs language-kotlin" lang="kotlin">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ <span class="hljs-number">1</span>: Kotlin ä»£ç                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ <span class="hljs-keyword">external</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">compressImage</span><span class="hljs-params">(path: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Boolean</span>      â”‚
â”‚   <span class="hljs-comment">// åªå£°æ˜ï¼Œä¸å®ç°                                      â”‚</span>
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ <span class="hljs-number">2</span>: åŠ è½½ Native åº“                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ System.loadLibrary(<span class="hljs-string">"ffmpegandoridlibrary"</span>)             â”‚
â”‚ <span class="hljs-comment">// åŠ è½½ libffmpegandoridlibrary.so                     â”‚</span>
â”‚ <span class="hljs-comment">// dlopen() ç³»ç»Ÿè°ƒç”¨æ‰“å¼€ .so æ–‡ä»¶                       â”‚</span>
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ <span class="hljs-number">3</span>: è¿è¡Œæ—¶æ–¹æ³•æŸ¥æ‰¾                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ JVM é€šè¿‡ JNI å‘½åè§„èŒƒæŸ¥æ‰¾ï¼š                             â”‚
â”‚ Java_com_package_Class_method_name                     â”‚
â”‚                                                         â”‚
â”‚ åœ¨ .so ç¬¦å·è¡¨ä¸­æŸ¥æ‰¾å¯¹åº”å‡½æ•°                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ <span class="hljs-number">4</span>: C++ å®ç°                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ extern <span class="hljs-string">"C"</span>                                             â”‚
â”‚ JNIEXPORT jboolean JNICALL                             â”‚
â”‚ Java_com_package_Class_method_name(JNIEnv *env, ...) { â”‚
â”‚     <span class="hljs-comment">// å…·ä½“å®ç°ä»£ç                                      â”‚</span>
â”‚ }                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-9">2.3 ä¸ºä»€ä¹ˆç”¨ externalï¼Ÿ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å¯¹æ¯”ï¼šæ™®é€šæ–¹æ³• vs external æ–¹æ³•</span>

<span class="hljs-comment">// æ™®é€šæ–¹æ³• - å®ç°åœ¨ Kotlin ä¸­</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">add</span><span class="hljs-params">(a: <span class="hljs-type">Int</span>, b: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> {
    <span class="hljs-keyword">return</span> a + b  <span class="hljs-comment">// ä»£ç åœ¨è¿™é‡Œ</span>
}

<span class="hljs-comment">// external æ–¹æ³• - å®ç°åœ¨ Native ä¸­</span>
<span class="hljs-keyword">external</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">compressImage</span><span class="hljs-params">(path: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Boolean</span>
<span class="hljs-comment">// ä»£ç åœ¨ C++ ä¸­ï¼Œé€šè¿‡ JNI è°ƒç”¨</span>
</code></pre>
<hr/>
<h3 data-id="heading-10">3. JNI å‘½åè§„èŒƒ</h3>
<h4 data-id="heading-11">3.1 å‘½åè§„åˆ™</h4>
<p>JNI å‡½æ•°åå¿…é¡»ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹æ ¼å¼ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">Java_&lt;åŒ…åè·¯å¾„&gt;_&lt;ç±»å&gt;_&lt;æ–¹æ³•å&gt;

ç¤ºä¾‹ï¼š
Kotlin: com.aykon.demo.ffmpegandoridlibrary.ImageCompress.compressImageFromPath()
         â”‚            â”‚                     â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚            â”‚                     â”‚                   â”‚
         â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ–¹æ³•å
         â”‚                                                        method_name
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç±»å
                                                                Class

JNI å‡½æ•°å:
Java_com_aykon_demo_ffmpegandoridlibrary_image_ImageCompress_compressImageFromPath
â”‚    â”‚   â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€
â”‚    â”‚   â”‚  â”‚              â”‚                         â”‚                â”‚
â”‚    â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ method name
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ <span class="hljs-keyword">class</span> <span class="hljs-title class_">name</span>
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ <span class="hljs-keyword">package</span> segments
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ JNI prefix
</code></pre>
<h4 data-id="heading-12">3.2 å‘½åè½¬æ¢è§„åˆ™</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Kotlin ä»£ç </span>
<span class="hljs-keyword">package</span> com.example.myapp

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ImageProcessor</span> {
    <span class="hljs-keyword">external</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">processImage</span><span class="hljs-params">(path: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Boolean</span>
}
</code></pre>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å¯¹åº”çš„ C++ å‡½æ•°å</span>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span>
<span class="hljs-function">JNIEXPORT jboolean JNICALL
<span class="hljs-title">Java_com_example_myapp_ImageProcessor_processImage</span><span class="hljs-params">(
    JNIEnv *env,
    jobject thiz,
    jstring path
)</span> </span>{
    <span class="hljs-comment">// å®ç°</span>
}
</code></pre>
<h4 data-id="heading-13">3.3 åŒ…åè½¬æ¢è§„åˆ™</h4>
<pre><code class="hljs">com.aykon.demo.ffmpegandoridlibrary
  â†“
com_aykon_demo_ffmpegandoridlibrary
    â†“ å…¨éƒ¨ç”¨ä¸‹åˆ’çº¿æ›¿æ¢ç‚¹å·
com_aykon_demo_ffmpegandoridlibrary
</code></pre>
<h4 data-id="heading-14">3.4 æ–¹æ³•é‡è½½çš„å¤„ç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Kotlin ä¸­å…è®¸é‡è½½</span>
<span class="hljs-keyword">external</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">process</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">ByteArray</span>)</span></span>
<span class="hljs-keyword">external</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">process</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">String</span>)</span></span>
</code></pre>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// JNI ä¼šæ·»åŠ ç­¾ååç¼€</span>
Java_..._process__3_3B                    <span class="hljs-comment">// ByteArray</span>
Java_..._process__Ljava_lang_String_2     <span class="hljs-comment">// String</span>

<span class="hljs-comment">// å»ºè®®ï¼šé¿å…é‡è½½ï¼Œä½¿ç”¨ä¸åŒæ–¹æ³•å</span>
<span class="hljs-function">external fun <span class="hljs-title">processBytes</span><span class="hljs-params">(data: ByteArray)</span>
external fun <span class="hljs-title">processString</span><span class="hljs-params">(data: String)</span>
</span></code></pre>
<h4 data-id="heading-15">3.5 extern "C" çš„ä½œç”¨</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ä¸ä½¿ç”¨ extern "C"</span>
<span class="hljs-function">JNIEXPORT jboolean JNICALL <span class="hljs-title">myFunction</span><span class="hljs-params">(...)</span>  <span class="hljs-comment">// âŒ C++ ä¼šä¿®é¥°åç§°</span>
<span class="hljs-comment">// ç¬¦å·è¡¨: _Z12myFunctionP7JNIEnv_P8_jstring</span>

<span class="hljs-comment">// ä½¿ç”¨ extern "C"</span>
<span class="hljs-keyword">extern</span> "C" </span>{
    <span class="hljs-function">JNIEXPORT jboolean JNICALL <span class="hljs-title">myFunction</span><span class="hljs-params">(...)</span>  <span class="hljs-comment">// âœ… ä¿æŒåŸå</span>
    <span class="hljs-comment">// ç¬¦å·è¡¨: myFunction</span>
}
</span></code></pre>
<p><strong>å¿…é¡»ä½¿ç”¨ <code>extern "C"</code> çš„åŸå› ï¼š</strong></p>
<ol>
<li>C++ æ”¯æŒå‡½æ•°é‡è½½ï¼Œä¼šä¿®é¥°å‡½æ•°å</li>
<li>JVM éœ€è¦ç²¾ç¡®åŒ¹é…å‡½æ•°å</li>
<li>C è¯­è¨€ä¸ä¿®é¥°åç§°ï¼Œä¿è¯ç¬¦å·ä¸€è‡´</li>
</ol>
<hr/>
<h3 data-id="heading-16">4. so åº“åŠ è½½æœºåˆ¶</h3>
<h4 data-id="heading-17">4.1 åŠ è½½è¿‡ç¨‹</h4>
<pre><code class="hljs language-bash" lang="bash">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. System.loadLibrary() è°ƒç”¨                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ System.loadLibrary(<span class="hljs-string">"ffmpegandoridlibrary"</span>)             â”‚
â”‚                                                         â”‚
â”‚ å†…éƒ¨æ‰§è¡Œï¼šRuntime.getRuntime().loadLibrary()            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. æ„é€ åº“æ–‡ä»¶å                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è¾“å…¥: <span class="hljs-string">"ffmpegandoridlibrary"</span>                           â”‚
â”‚                                                         â”‚
â”‚ æ·»åŠ å‰ç¼€: lib + name + .so                             â”‚
â”‚ ç»“æœ: libffmpegandoridlibrary.so                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. æœç´¢åº“æ–‡ä»¶                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æŒ‰ä¼˜å…ˆçº§æœç´¢ä»¥ä¸‹è·¯å¾„ï¼š                                  â”‚
â”‚                                                         â”‚
â”‚ 1. System.getProperty(<span class="hljs-string">"java.library.path"</span>)            â”‚
â”‚ 2. APK ä¸­çš„ lib ç›®å½•                                   â”‚
â”‚    â”œâ”€â”€ lib/arm64-v8a/libxxx.so                        â”‚
â”‚    â”œâ”€â”€ lib/armeabi-v7a/libxxx.so                      â”‚
â”‚    â””â”€â”€ lib/x86/libxxx.so                              â”‚
â”‚ 3. ç³»ç»Ÿåº“è·¯å¾„ /system/lib64                           â”‚
â”‚ 4. åº”ç”¨ç§æœ‰è·¯å¾„ /data/app/.../lib                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. åŠ è½½åº“åˆ°å†…å­˜                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨ dlopen() æ‰“å¼€ .so æ–‡ä»¶                    â”‚
â”‚                                                         â”‚
â”‚ dlopen(<span class="hljs-string">"libffmpegandoridlibrary.so"</span>, RTLD_LAZY)       â”‚
â”‚                                                         â”‚
â”‚ æ‰§è¡Œï¼š                                                  â”‚
â”‚ - è¯»å– .so æ–‡ä»¶å¤´ï¼ˆELF æ ¼å¼ï¼‰                          â”‚
â”‚ - åŠ è½½ä»£ç æ®µåˆ°å†…å­˜                                     â”‚
â”‚ - åŠ è½½æ•°æ®æ®µåˆ°å†…å­˜                                     â”‚
â”‚ - è§£æç¬¦å·è¡¨                                           â”‚
â”‚ - é‡å®šä½åœ°å€                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. æ³¨å†Œ JNI æ–¹æ³•                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ JVM æ‰«æ .so ç¬¦å·è¡¨ï¼ŒæŸ¥æ‰¾ JNI å‡½æ•°                     â”‚
â”‚                                                         â”‚
â”‚ æ¨¡å¼ 1: è‡ªåŠ¨å‘½åè§„èŒƒæŸ¥æ‰¾                               â”‚
â”‚   Java_..._method_name                                 â”‚
â”‚                                                         â”‚
â”‚ æ¨¡å¼ 2: JNI_OnLoad æ‰‹åŠ¨æ³¨å†Œ                            â”‚
â”‚   JNIEXPORT jint JNICALL JNI_OnLoad(JavaVM *vm, ...) { â”‚
â”‚       // æ³¨å†Œå‡½æ•°                                       â”‚
â”‚   }                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. åŠ è½½å®Œæˆ                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åº“å·²åŠ è½½ï¼Œå¯ä»¥è°ƒç”¨ external æ–¹æ³•                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-18">4.2 å¤šåº“åŠ è½½ç¤ºä¾‹</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åŠ è½½å¤šä¸ª Native åº“</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">NativeLib</span> {
    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-keyword">init</span> {
            <span class="hljs-comment">// æŒ‰ä¾èµ–é¡ºåºåŠ è½½</span>
            System.loadLibrary(<span class="hljs-string">"avutil"</span>)        <span class="hljs-comment">// FFmpeg å·¥å…·åº“</span>
            System.loadLibrary(<span class="hljs-string">"avcodec"</span>)       <span class="hljs-comment">// FFmpeg ç¼–è§£ç åº“</span>
            System.loadLibrary(<span class="hljs-string">"avformat"</span>)      <span class="hljs-comment">// FFmpeg æ ¼å¼åº“</span>
            System.loadLibrary(<span class="hljs-string">"swscale"</span>)       <span class="hljs-comment">// FFmpeg ç¼©æ”¾åº“</span>
            System.loadLibrary(<span class="hljs-string">"ffmpegandroid"</span>) <span class="hljs-comment">// ä¸»åº“</span>
        }
    }
}
</code></pre>
<h4 data-id="heading-19">4.3 CMake é…ç½®</h4>
<pre><code class="hljs language-cmake" lang="cmake"># CMakeLists.txt

# æ·»åŠ  FFmpeg é¢„ç¼–è¯‘åº“
add_library(libavutil SHARED IMPORTED)
set_target_properties(libavutil PROPERTIES
    IMPORTED_LOCATION ${CMAKE_SOURCE_DIR}/lib/${CMAKE_ANDROID_ARCH_ABI}/libavutil.so)

# ç¼–è¯‘ä¸»åº“
add_library(ffmpegandroid SHARED
    ffmpegandoridlibrary.cpp
    imageprocessor.cpp
)

# é“¾æ¥åº“
target_link_libraries(ffmpegandroid
    libavutil
    libavcodec
    libavformat
    log          # Android æ—¥å¿—åº“
    android      # Android åŸç”Ÿåº“
)
</code></pre>
<h4 data-id="heading-20">4.4 åº“çš„ä¾èµ–å…³ç³»</h4>
<pre><code class="hljs language-erlang" lang="erlang">ä¸»åº“: libffmpegandoridlibrary.so
  â†“ ä¾èµ–
  â”œâ”€ libavutil.so      (å·¥å…·å‡½æ•°)
  â”œâ”€ libavcodec.so     (ç¼–è§£ç å™¨)
  â”œâ”€ libavformat.so    (æ ¼å¼å¤„ç†)
  â”œâ”€ libswscale.so     (å›¾åƒç¼©æ”¾)
  â””â”€ libswresample.so  (éŸ³é¢‘é‡é‡‡æ ·)

æ‰€æœ‰åº“éƒ½ä¼šæ‰“åŒ…åˆ° APK ä¸­:
APK/
  â””â”€ lib/
      â”œâ”€ arm64-v8a/
      â”‚   â”œâ”€ libffmpegandoridlibrary.so
      â”‚   â”œâ”€ libavutil.so
      â”‚   â””â”€ ...
      â””â”€ armeabi-v7a/
          â””â”€ ...
</code></pre>
<hr/>
<h3 data-id="heading-21">5. JVM æ–¹æ³•æŸ¥æ‰¾ä¸ç¼“å­˜</h3>
<h4 data-id="heading-22">5.1 å…¨å±€ç¼“å­˜æ¶æ„</h4>
<pre><code class="hljs language-ini" lang="ini">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JVM Native æ–¹æ³•ç®¡ç† (æ¯ä¸ª ClassLoader ä¸€ä¸ªå®ä¾‹)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ å·²åŠ è½½çš„ .so åº“åˆ—è¡¨                                      â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚ â”‚ <span class="hljs-section">[0]</span> libffmpegandoridlibrary.so  â† ä¸»åº“            â”‚  â”‚  â”‚
â”‚  â”‚ â”‚ <span class="hljs-section">[1]</span> libavutil.so                               â”‚  â”‚  â”‚
â”‚  â”‚ â”‚ <span class="hljs-section">[2]</span> libavcodec.so                              â”‚  â”‚  â”‚
â”‚  â”‚ â”‚ <span class="hljs-section">[3]</span> libswscale.so                              â”‚  â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ æ–¹æ³•ç¼“å­˜è¡¨ (å…¨å±€å“ˆå¸Œè¡¨)                                  â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚ â”‚ Key: (ç±»å + æ–¹æ³•å + ç­¾å)                       â”‚  â”‚  â”‚
â”‚  â”‚ â”‚ Value: (åº“å¥æŸ„ + å‡½æ•°æŒ‡é’ˆ)                         â”‚  â”‚  â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚
â”‚  â”‚ â”‚ "NativeLib.stringFromJNI()V"                       â”‚  â”‚  â”‚
â”‚  â”‚ â”‚   â†’ (lib<span class="hljs-section">[0]</span>, 0x12345678)                          â”‚  â”‚  â”‚
â”‚  â”‚ â”‚                                                     â”‚  â”‚  â”‚
â”‚  â”‚ â”‚ "ImageCompress.compressImage(Ljava/lang/String<span class="hljs-comment">;)Z" â”‚  â”‚  â”‚</span>
â”‚  â”‚ â”‚   â†’ (lib<span class="hljs-section">[0]</span>, 0x34567890)                          â”‚  â”‚  â”‚
â”‚  â”‚ â”‚                                                     â”‚  â”‚  â”‚
â”‚  â”‚ â”‚ "ImageCompress.getMetadata(Ljava/lang/String<span class="hljs-comment">;)..." â”‚  â”‚  â”‚</span>
â”‚  â”‚ â”‚   â†’ (lib<span class="hljs-section">[0]</span>, 0x78901234)                          â”‚  â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-23">5.2 æ–¹æ³•æŸ¥æ‰¾æµç¨‹</h4>
<pre><code class="hljs language-css" lang="css">ç¬¬ä¸€æ¬¡è°ƒç”¨ external æ–¹æ³•ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è°ƒç”¨: <span class="hljs-built_in">stringFromJNI</span>()                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ <span class="hljs-number">1</span>: æ£€æŸ¥ç¼“å­˜                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æŸ¥æ‰¾ Key: <span class="hljs-string">"NativeLib.stringFromJNI()V"</span>                 â”‚
â”‚ ç»“æœ: æœªæ‰¾åˆ°                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ <span class="hljs-number">2</span>: æ„é€  JNI å‡½æ•°å                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Java_com_aykon_demo_..._NativeLib_stringFromJNI           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ <span class="hljs-number">3</span>: éå†å·²åŠ è½½åº“æŸ¥æ‰¾                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åº“[<span class="hljs-number">0</span>]: libffmpegandoridlibrary.so                      â”‚
â”‚   <span class="hljs-built_in">dlsym</span>(<span class="hljs-string">"Java_..._stringFromJNI"</span>)                      â”‚
â”‚   âœ… æ‰¾åˆ°å‡½æ•°æŒ‡é’ˆ: <span class="hljs-number">0</span>x12345678                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ <span class="hljs-number">4</span>: å­˜å…¥ç¼“å­˜                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç¼“å­˜[<span class="hljs-string">"NativeLib.stringFromJNI()V"</span>] = (lib[<span class="hljs-number">0</span>], <span class="hljs-number">0</span>x12345678) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­¥éª¤ <span class="hljs-number">5</span>: æ‰§è¡Œå‡½æ•°                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è·³è½¬åˆ°å‡½æ•°æŒ‡é’ˆ <span class="hljs-number">0</span>x12345678 æ‰§è¡Œ                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬äºŒæ¬¡è°ƒç”¨åŒä¸€æ–¹æ³•ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è°ƒç”¨: <span class="hljs-built_in">stringFromJNI</span>()                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ£€æŸ¥ç¼“å­˜: å‘½ä¸­ï¼                                        â”‚
â”‚ ç›´æ¥è¿”å›å‡½æ•°æŒ‡é’ˆ: <span class="hljs-number">0</span>x12345678  â† éå¸¸å¿«ï¼               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-24">5.3 æ€§èƒ½å¯¹æ¯”</h4>

























<table><thead><tr><th>æ“ä½œ</th><th>ç¬¬ä¸€æ¬¡è°ƒç”¨</th><th>åç»­è°ƒç”¨</th></tr></thead><tbody><tr><td>æŸ¥æ‰¾æ–¹å¼</td><td>éå†ç¬¦å·è¡¨ O(n)</td><td>å“ˆå¸Œè¡¨æŸ¥æ‰¾ O(1)</td></tr><tr><td>æ€§èƒ½</td><td>è¾ƒæ…¢ï¼ˆå¾®ç§’çº§ï¼‰</td><td>æå¿«ï¼ˆçº³ç§’çº§ï¼‰</td></tr><tr><td>ç¼“å­˜</td><td>å¦</td><td>æ˜¯</td></tr></tbody></table>
<h4 data-id="heading-25">5.4 å¤šä¸ªåº“çš„æŸ¥æ‰¾é¡ºåº</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å¦‚æœæœ‰å¤šä¸ªåº“éƒ½å®ç°äº†åŒåå‡½æ•°ï¼ˆè™½ç„¶ä¸æ¨èï¼‰</span>

<span class="hljs-comment">// åŠ è½½é¡ºåº</span>
System.<span class="hljs-built_in">loadLibrary</span>(<span class="hljs-string">"libraryA"</span>)  <span class="hljs-comment">// [0]</span>
System.<span class="hljs-built_in">loadLibrary</span>(<span class="hljs-string">"libraryB"</span>)  <span class="hljs-comment">// [1]</span>
System.<span class="hljs-built_in">loadLibrary</span>(<span class="hljs-string">"libraryC"</span>)  <span class="hljs-comment">// [2]</span>

<span class="hljs-comment">// æŸ¥æ‰¾é¡ºåº</span>
è°ƒç”¨ <span class="hljs-function">external <span class="hljs-title">method</span><span class="hljs-params">()</span>
  â†’ æŸ¥æ‰¾ libraryA âœ… æ‰¾åˆ°å°±ä½¿ç”¨
  â†’ å¦åˆ™æŸ¥æ‰¾ libraryB
  â†’ å¦åˆ™æŸ¥æ‰¾ libraryC
  â†’ éƒ½æ‰¾ä¸åˆ° â†’ UnsatisfiedLinkError
</span></code></pre>
<hr/>
<h3 data-id="heading-26">6. JNI ç±»å‹ç³»ç»Ÿ</h3>
<h4 data-id="heading-27">6.1 åŸºæœ¬ç±»å‹æ˜ å°„</h4>

































































<table><thead><tr><th>Kotlin ç±»å‹</th><th>JNI ç±»å‹</th><th>C++ ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>Boolean</code></td><td><code>jboolean</code></td><td><code>uint8_t</code></td><td>0 æˆ– 1</td></tr><tr><td><code>Byte</code></td><td><code>jbyte</code></td><td><code>int8_t</code></td><td>8 ä½æœ‰ç¬¦å·æ•´æ•°</td></tr><tr><td><code>Char</code></td><td><code>jchar</code></td><td><code>uint16_t</code></td><td>16 ä½ Unicode å­—ç¬¦</td></tr><tr><td><code>Short</code></td><td><code>jshort</code></td><td><code>int16_t</code></td><td>16 ä½æœ‰ç¬¦å·æ•´æ•°</td></tr><tr><td><code>Int</code></td><td><code>jint</code></td><td><code>int32_t</code></td><td>32 ä½æœ‰ç¬¦å·æ•´æ•°</td></tr><tr><td><code>Long</code></td><td><code>jlong</code></td><td><code>int64_t</code></td><td>64 ä½æœ‰ç¬¦å·æ•´æ•°</td></tr><tr><td><code>Float</code></td><td><code>jfloat</code></td><td><code>float</code></td><td>32 ä½æµ®ç‚¹æ•°</td></tr><tr><td><code>Double</code></td><td><code>jdouble</code></td><td><code>double</code></td><td>64 ä½æµ®ç‚¹æ•°</td></tr><tr><td><code>Unit/void</code></td><td><code>void</code></td><td><code>void</code></td><td>æ— è¿”å›å€¼</td></tr></tbody></table>
<h4 data-id="heading-28">6.2 å¯¹è±¡ç±»å‹æ˜ å°„</h4>


















































<table><thead><tr><th>Kotlin ç±»å‹</th><th>JNI ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>String</code></td><td><code>jstring</code></td><td>éœ€è¦è½¬æ¢æ‰èƒ½ä½¿ç”¨</td></tr><tr><td><code>Any</code> / å¯¹è±¡</td><td><code>jobject</code></td><td>ä»»æ„ Java å¯¹è±¡</td></tr><tr><td><code>Class</code></td><td><code>jclass</code></td><td>ç±»å¯¹è±¡</td></tr><tr><td><code>Array&lt;T&gt;</code></td><td><code>jarray</code></td><td>æ•°ç»„åŸºç±»</td></tr><tr><td><code>ByteArray</code></td><td><code>jbyteArray</code></td><td>å­—èŠ‚æ•°ç»„</td></tr><tr><td><code>IntArray</code></td><td><code>jintArray</code></td><td>æ•´æ•°æ•°ç»„</td></tr><tr><td><code>Object[]</code></td><td><code>jobjectArray</code></td><td>å¯¹è±¡æ•°ç»„</td></tr><tr><td><code>Throwable</code></td><td><code>jthrowable</code></td><td>å¼‚å¸¸å¯¹è±¡</td></tr></tbody></table>
<h4 data-id="heading-29">6.3 JNI å‡½æ•°ç­¾å</h4>
<p>JNI æ–¹æ³•ç­¾åç”¨äºå”¯ä¸€æ ‡è¯†æ–¹æ³•ï¼Œæ ¼å¼ï¼š<code>(å‚æ•°ç±»å‹...)è¿”å›ç±»å‹</code></p>
<pre><code class="hljs language-arduino" lang="arduino">åŸºç¡€ç±»å‹ç­¾åï¼š
B - <span class="hljs-type">byte</span>
C - <span class="hljs-type">char</span>
D - <span class="hljs-type">double</span>
F - <span class="hljs-type">float</span>
I - <span class="hljs-type">int</span>
J - <span class="hljs-type">long</span>
S - <span class="hljs-type">short</span>
Z - <span class="hljs-type">boolean</span>
V - <span class="hljs-type">void</span>

å¯¹è±¡ç±»å‹ç­¾åï¼š
LåŒ…å/ç±»å;  ä¾‹å¦‚ï¼šLjava/lang/<span class="hljs-type">String</span>;

æ•°ç»„ç±»å‹ç­¾åï¼š
[ç±»å‹  ä¾‹å¦‚ï¼š[I è¡¨ç¤º <span class="hljs-type">int</span>[]
        [[I è¡¨ç¤º <span class="hljs-type">int</span>[][]
</code></pre>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Kotlin æ–¹æ³•ç­¾å</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">process</span><span class="hljs-params">(input: <span class="hljs-type">String</span>, count: <span class="hljs-type">Int</span>, flag: <span class="hljs-type">Boolean</span>)</span></span>: String
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript">å¯¹åº”çš„ <span class="hljs-variable constant_">JNI</span> ç­¾åï¼š
(<span class="hljs-title class_">Ljava</span>/lang/<span class="hljs-title class_">String</span>;<span class="hljs-variable constant_">IZ</span>)<span class="hljs-title class_">Ljava</span>/lang/<span class="hljs-title class_">String</span>;
â”‚                â”‚ â”‚ â”‚          â”‚
â”‚                â”‚ â”‚ â”‚          â””â”€ è¿”å› <span class="hljs-title class_">String</span>
â”‚                â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ <span class="hljs-title class_">Boolean</span>
â”‚                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ <span class="hljs-title class_">Int</span>
â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ <span class="hljs-title class_">String</span> å‚æ•°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ–¹æ³•å¼€å§‹
</code></pre>
<p><strong>å¤æ‚ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">example</span><span class="hljs-params">(
    str: <span class="hljs-type">String</span>,
    bytes: <span class="hljs-type">ByteArray</span>,
    listener: <span class="hljs-type">MyListener</span>,
    count: <span class="hljs-type">Int</span>
)</span></span>: <span class="hljs-built_in">Boolean</span>
</code></pre>
<pre><code class="hljs language-arduino" lang="arduino">JNI ç­¾å:
(Ljava/lang/<span class="hljs-type">String</span>;[BLcom/example/MyListener;I)Z
â”‚                â”‚  â”‚                 â”‚    â””â”€ è¿”å› <span class="hljs-type">boolean</span>
â”‚                â”‚  â”‚                 â””â”€â”€â”€â”€â”€â”€â”€ Int
â”‚                â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Listener å¯¹è±¡
â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ByteArray
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ <span class="hljs-type">String</span>
</code></pre>
<h4 data-id="heading-30">6.4 JNIEnv æ¥å£</h4>
<p><code>JNIEnv</code> æ˜¯æŒ‡å‘ JNI å‡½æ•°è¡¨çš„æŒ‡é’ˆï¼Œæä¾›äº†å¤§é‡æ“ä½œå‡½æ•°ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">JNIEnv</span> {
    <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">JNINativeInterface</span>* functions;

    <span class="hljs-comment">// ç‰ˆæœ¬ä¿¡æ¯</span>
    <span class="hljs-function">jint <span class="hljs-title">GetVersion</span><span class="hljs-params">()</span></span>;

    <span class="hljs-comment">// ç±»æ“ä½œ</span>
    <span class="hljs-function">jclass <span class="hljs-title">FindClass</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* name)</span></span>;

    <span class="hljs-comment">// å¯¹è±¡æ“ä½œ</span>
    <span class="hljs-function">jobject <span class="hljs-title">AllocObject</span><span class="hljs-params">(jclass clazz)</span></span>;
    <span class="hljs-function">jobject <span class="hljs-title">NewObject</span><span class="hljs-params">(jclass clazz, jmethodID methodID, ...)</span></span>;

    <span class="hljs-comment">// æ–¹æ³•æ“ä½œ</span>
    <span class="hljs-function">jmethodID <span class="hljs-title">GetMethodID</span><span class="hljs-params">(jclass clazz, <span class="hljs-type">const</span> <span class="hljs-type">char</span>* name, <span class="hljs-type">const</span> <span class="hljs-type">char</span>* sig)</span></span>;
    <span class="hljs-function">jmethodID <span class="hljs-title">GetStaticMethodID</span><span class="hljs-params">(jclass clazz, <span class="hljs-type">const</span> <span class="hljs-type">char</span>* name, <span class="hljs-type">const</span> <span class="hljs-type">char</span>* sig)</span></span>;

    <span class="hljs-comment">// å­—æ®µæ“ä½œ</span>
    <span class="hljs-function">jfieldID <span class="hljs-title">GetFieldID</span><span class="hljs-params">(jclass clazz, <span class="hljs-type">const</span> <span class="hljs-type">char</span>* name, <span class="hljs-type">const</span> <span class="hljs-type">char</span>* sig)</span></span>;
    <span class="hljs-function">jint <span class="hljs-title">GetIntField</span><span class="hljs-params">(jobject obj, jfieldID fieldID)</span></span>;

    <span class="hljs-comment">// å­—ç¬¦ä¸²æ“ä½œ</span>
    <span class="hljs-function">jstring <span class="hljs-title">NewStringUTF</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* str)</span></span>;
    <span class="hljs-function"><span class="hljs-type">const</span> <span class="hljs-type">char</span>* <span class="hljs-title">GetStringUTFChars</span><span class="hljs-params">(jstring str, jboolean* isCopy)</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">ReleaseStringUTFChars</span><span class="hljs-params">(jstring str, <span class="hljs-type">const</span> <span class="hljs-type">char</span>* utf)</span></span>;

    <span class="hljs-comment">// æ•°ç»„æ“ä½œ</span>
    <span class="hljs-function">jsize <span class="hljs-title">GetArrayLength</span><span class="hljs-params">(jarray array)</span></span>;
    <span class="hljs-function">jint* <span class="hljs-title">GetIntArrayElements</span><span class="hljs-params">(jintArray array, jboolean* isCopy)</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">ReleaseIntArrayElements</span><span class="hljs-params">(jintArray array, jint* elems, jint mode)</span></span>;

    <span class="hljs-comment">// å¼‚å¸¸å¤„ç†</span>
    <span class="hljs-function">jboolean <span class="hljs-title">ExceptionCheck</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">ExceptionDescribe</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">ExceptionClear</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function">jint <span class="hljs-title">ThrowNew</span><span class="hljs-params">(jclass clazz, <span class="hljs-type">const</span> <span class="hljs-type">char</span>* msg)</span></span>;

    <span class="hljs-comment">// å†…å­˜ç®¡ç†</span>
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">DeleteLocalRef</span><span class="hljs-params">(jobject localRef)</span></span>;
    <span class="hljs-function">jobject <span class="hljs-title">NewGlobalRef</span><span class="hljs-params">(jobject obj)</span></span>;
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">DeleteGlobalRef</span><span class="hljs-params">(jobject globalRef)</span></span>;
};
</code></pre>
<hr/>
<h3 data-id="heading-31">7. å†…å­˜ç®¡ç†</h3>
<h4 data-id="heading-32">7.1 JNI å†…å­˜ç±»å‹</h4>
<pre><code class="hljs language-markdown" lang="markdown">JNI ä¸­æœ‰ä¸‰ç§å¼•ç”¨ç±»å‹ï¼š

<span class="hljs-bullet">1.</span> Local Reference (å±€éƒ¨å¼•ç”¨)
<span class="hljs-bullet">   -</span> ç”Ÿå‘½å‘¨æœŸï¼šä»…åœ¨å½“å‰ Native æ–¹æ³•æ‰§è¡ŒæœŸé—´
<span class="hljs-bullet">   -</span> è‡ªåŠ¨é‡Šæ”¾ï¼šæ–¹æ³•è¿”å›æ—¶è‡ªåŠ¨é‡Šæ”¾
<span class="hljs-bullet">   -</span> åˆ›å»ºæ–¹å¼ï¼šå¤§éƒ¨åˆ† JNI å‡½æ•°è¿”å›çš„å¼•ç”¨
<span class="hljs-bullet">   -</span> ç¤ºä¾‹ï¼šjstring, jobject, jclass

<span class="hljs-bullet">2.</span> Global Reference (å…¨å±€å¼•ç”¨)
<span class="hljs-bullet">   -</span> ç”Ÿå‘½å‘¨æœŸï¼šæ˜¾å¼é‡Šæ”¾ä¹‹å‰ä¸€ç›´æœ‰æ•ˆ
<span class="hljs-bullet">   -</span> æ‰‹åŠ¨é‡Šæ”¾ï¼šå¿…é¡»è°ƒç”¨ DeleteGlobalRef()
<span class="hljs-bullet">   -</span> åˆ›å»ºæ–¹å¼ï¼šNewGlobalRef()
<span class="hljs-bullet">   -</span> ç”¨é€”ï¼šè·¨æ–¹æ³•ã€è·¨çº¿ç¨‹å…±äº«

<span class="hljs-bullet">3.</span> Weak Global Reference (å¼±å…¨å±€å¼•ç”¨)
<span class="hljs-bullet">   -</span> ç”Ÿå‘½å‘¨æœŸï¼šGC å¯ä»¥éšæ—¶å›æ”¶
<span class="hljs-bullet">   -</span> æ‰‹åŠ¨é‡Šæ”¾ï¼šå»ºè®®è°ƒç”¨ DeleteWeakGlobalRef()
<span class="hljs-bullet">   -</span> åˆ›å»ºæ–¹å¼ï¼šNewWeakGlobalRef()
<span class="hljs-bullet">   -</span> ç”¨é€”ï¼šç¼“å­˜ï¼Œä¸å¼ºå¼•ç”¨
</code></pre>
<h4 data-id="heading-33">7.2 å±€éƒ¨å¼•ç”¨ç®¡ç†</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// âœ… æ­£ç¡®ï¼šçŸ­ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</span>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span>
JNIEXPORT jstring JNICALL
Java_..._simpleMethod(JNIEnv *env, jobject thiz) {
    jstring str = env-&gt;<span class="hljs-built_in">NewStringUTF</span>(<span class="hljs-string">"Hello"</span>);  <span class="hljs-comment">// å±€éƒ¨å¼•ç”¨</span>
    <span class="hljs-comment">// ... ä½¿ç”¨ str ...</span>
    <span class="hljs-keyword">return</span> str;  <span class="hljs-comment">// è‡ªåŠ¨é‡Šæ”¾</span>
}

<span class="hljs-comment">// âŒ é”™è¯¯ï¼šå¾ªç¯ä¸­åˆ›å»ºå¤§é‡å±€éƒ¨å¼•ç”¨</span>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span>
JNIEXPORT <span class="hljs-type">void</span> JNICALL
Java_..._wrongMethod(JNIEnv *env, jobject thiz, jint count) {
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
        jstring str = env-&gt;<span class="hljs-built_in">NewStringUTF</span>(<span class="hljs-string">"test"</span>);  <span class="hljs-comment">// åˆ›å»º 10000 ä¸ªï¼</span>
        <span class="hljs-comment">// å¯èƒ½å¯¼è‡´å±€éƒ¨å¼•ç”¨è¡¨æº¢å‡º</span>
    }
}

<span class="hljs-comment">// âœ… æ­£ç¡®ï¼šå¾ªç¯ä¸­æ‰‹åŠ¨é‡Šæ”¾</span>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span>
JNIEXPORT <span class="hljs-type">void</span> JNICALL
Java_..._correctMethod(JNIEnv *env, jobject thiz, jint count) {
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
        jstring str = env-&gt;<span class="hljs-built_in">NewStringUTF</span>(<span class="hljs-string">"test"</span>);
        <span class="hljs-comment">// ... ä½¿ç”¨ str ...</span>
        env-&gt;<span class="hljs-built_in">DeleteLocalRef</span>(str);  <span class="hljs-comment">// ç«‹å³é‡Šæ”¾</span>
    }
}
</code></pre>
<h4 data-id="heading-34">7.3 å­—ç¬¦ä¸²å†…å­˜ç®¡ç†</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// GetStringUTFChars / ReleaseStringUTFChars æˆå¯¹ä½¿ç”¨</span>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span>
JNIEXPORT <span class="hljs-type">void</span> JNICALL
Java_..._processString(JNIEnv *env, jobject thiz, jstring input) {
    <span class="hljs-type">const</span> <span class="hljs-type">char</span> *cStr = <span class="hljs-literal">NULL</span>;  <span class="hljs-comment">// åˆå§‹åŒ–ä¸º NULL</span>

    <span class="hljs-comment">// è½¬æ¢ï¼šjstring â†’ C å­—ç¬¦ä¸²</span>
    cStr = env-&gt;<span class="hljs-built_in">GetStringUTFChars</span>(input, <span class="hljs-literal">NULL</span>);
    <span class="hljs-keyword">if</span> (cStr == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">return</span>;  <span class="hljs-comment">// å†…å­˜ä¸è¶³</span>
    }

    <span class="hljs-comment">// ä½¿ç”¨ C å­—ç¬¦ä¸²</span>
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Input: %s\n"</span>, cStr);

    <span class="hljs-comment">// å¿…é¡»é‡Šæ”¾ï¼</span>
    env-&gt;<span class="hljs-built_in">ReleaseStringUTFChars</span>(input, cStr);
}
</code></pre>
<h4 data-id="heading-35">7.4 æ•°ç»„å†…å­˜ç®¡ç†</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span>
JNIEXPORT jint JNICALL
Java_..._sumArray(JNIEnv *env, jobject thiz, jintArray array) {
    jint *cArray = <span class="hljs-literal">NULL</span>;
    jint sum = <span class="hljs-number">0</span>;

    <span class="hljs-comment">// è·å–æ•°ç»„å…ƒç´ </span>
    cArray = env-&gt;<span class="hljs-built_in">GetIntArrayElements</span>(array, <span class="hljs-literal">NULL</span>);
    <span class="hljs-keyword">if</span> (cArray == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  <span class="hljs-comment">// å¤±è´¥</span>
    }

    <span class="hljs-comment">// è·å–é•¿åº¦</span>
    jsize length = env-&gt;<span class="hljs-built_in">GetArrayLength</span>(array);

    <span class="hljs-comment">// å¤„ç†æ•°ç»„</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; length; i++) {
        sum += cArray[i];
    }

    <span class="hljs-comment">// é‡Šæ”¾æ•°ç»„</span>
    <span class="hljs-comment">// mode: 0 = å¤åˆ¶å›å»å¹¶é‡Šæ”¾ï¼ŒJNI_ABORT = ä¸å¤åˆ¶ç›´æ¥é‡Šæ”¾</span>
    env-&gt;<span class="hljs-built_in">ReleaseIntArrayElements</span>(array, cArray, <span class="hljs-number">0</span>);

    <span class="hljs-keyword">return</span> sum;
}
</code></pre>
<h4 data-id="heading-36">7.5 å…¨å±€å¼•ç”¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å…¨å±€å˜é‡å­˜å‚¨ç¼“å­˜</span>
<span class="hljs-type">static</span> jclass gStringClass = <span class="hljs-literal">NULL</span>;
<span class="hljs-type">static</span> jmethodID gStringConstructor = <span class="hljs-literal">NULL</span>;

<span class="hljs-comment">// åˆå§‹åŒ–å‡½æ•°</span>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span>
JNIEXPORT <span class="hljs-type">void</span> JNICALL
Java_..._initCache(JNIEnv *env, jobject thiz) {
    <span class="hljs-comment">// æŸ¥æ‰¾ç±»</span>
    jclass localClass = env-&gt;<span class="hljs-built_in">FindClass</span>(<span class="hljs-string">"java/lang/String"</span>);

    <span class="hljs-comment">// åˆ›å»ºå…¨å±€å¼•ç”¨</span>
    gStringClass = (jclass)env-&gt;<span class="hljs-built_in">NewGlobalRef</span>(localClass);

    <span class="hljs-comment">// åˆ é™¤å±€éƒ¨å¼•ç”¨ï¼ˆå·²æœ‰å…¨å±€å¼•ç”¨ï¼Œä¸éœ€è¦å±€éƒ¨äº†ï¼‰</span>
    env-&gt;<span class="hljs-built_in">DeleteLocalRef</span>(localClass);

    <span class="hljs-comment">// è·å–æ–¹æ³• IDï¼ˆä¸éœ€è¦é‡Šæ”¾ï¼‰</span>
    gStringConstructor = env-&gt;<span class="hljs-built_in">GetMethodID</span>(gStringClass, <span class="hljs-string">"&lt;init&gt;"</span>, <span class="hljs-string">"([B)V"</span>);
}

<span class="hljs-comment">// ä½¿ç”¨ç¼“å­˜çš„å¼•ç”¨</span>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span>
JNIEXPORT jstring JNICALL
Java_..._createString(JNIEnv *env, jobject thiz, jbyteArray bytes) {
    <span class="hljs-comment">// ä½¿ç”¨å…¨å±€å¼•ç”¨ï¼ˆæ— éœ€å†æ¬¡æŸ¥æ‰¾ï¼‰</span>
    <span class="hljs-keyword">return</span> (jstring)env-&gt;<span class="hljs-built_in">NewObject</span>(gStringClass, gStringConstructor, bytes);
}

<span class="hljs-comment">// æ¸…ç†å‡½æ•°</span>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span>
JNIEXPORT <span class="hljs-type">void</span> JNICALL
Java_..._cleanup(JNIEnv *env, jobject thiz) {
    <span class="hljs-keyword">if</span> (gStringClass != <span class="hljs-literal">NULL</span>) {
        env-&gt;<span class="hljs-built_in">DeleteGlobalRef</span>(gStringClass);
        gStringClass = <span class="hljs-literal">NULL</span>;
    }
}
</code></pre>
<hr/>
<h3 data-id="heading-37">8. å®æˆ˜æ¡ˆä¾‹</h3>
<h4 data-id="heading-38">8.1 æ·»åŠ  Native æ–¹æ³•å®Œæ•´æµç¨‹</h4>
<h5 data-id="heading-39">åœºæ™¯ï¼šå®ç°è·å–å›¾ç‰‡å…ƒæ•°æ®çš„ Native æ–¹æ³•</h5>
<p><strong>æ­¥éª¤ 1ï¼šå®šä¹‰ Kotlin æ•°æ®ç±»</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ImageMetadata.kt</span>
<span class="hljs-keyword">package</span> com.example.ffmpeg

<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ImageMetadata</span>(
    <span class="hljs-keyword">val</span> width: <span class="hljs-built_in">Int</span>,
    <span class="hljs-keyword">val</span> height: <span class="hljs-built_in">Int</span>,
    <span class="hljs-keyword">val</span> format: String,
    <span class="hljs-keyword">val</span> fileSize: <span class="hljs-built_in">Long</span>
) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getResolution</span><span class="hljs-params">()</span></span>: String = <span class="hljs-string">"<span class="hljs-subst">${width}</span>x<span class="hljs-subst">${height}</span>"</span>

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getReadableSize</span><span class="hljs-params">()</span></span>: String {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">when</span> {
            fileSize &lt; <span class="hljs-number">1024</span> -&gt; <span class="hljs-string">"<span class="hljs-subst">${fileSize}</span>B"</span>
            fileSize &lt; <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> -&gt; <span class="hljs-string">"<span class="hljs-subst">${fileSize / <span class="hljs-number">1024</span>}</span>KB"</span>
            <span class="hljs-keyword">else</span> -&gt; <span class="hljs-string">"<span class="hljs-subst">${fileSize / (<span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>)}</span>MB"</span>
        }
    }
}
</code></pre>
<p><strong>æ­¥éª¤ 2ï¼šåœ¨æ¥å£ä¸­å£°æ˜æ–¹æ³•</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// IImageCompress.kt</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">IImageCompress</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getMetadata</span><span class="hljs-params">(imagePath: <span class="hljs-type">String</span>)</span></span>: ImageMetadata?
}
</code></pre>
<p><strong>æ­¥éª¤ 3ï¼šåœ¨å®ç°ç±»ä¸­è°ƒç”¨ Native</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ImageCompress.kt</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ImageCompress</span> : <span class="hljs-type">IImageCompress</span> {

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getMetadata</span><span class="hljs-params">(imagePath: <span class="hljs-type">String</span>)</span></span>: ImageMetadata? {
        <span class="hljs-keyword">if</span> (imagePath.isEmpty()) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>

        <span class="hljs-keyword">val</span> file = File(imagePath)
        <span class="hljs-keyword">if</span> (!file.exists()) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>

        <span class="hljs-comment">// è°ƒç”¨ Native æ–¹æ³•</span>
        <span class="hljs-keyword">return</span> getImageMetadataNative(imagePath)
    }

    <span class="hljs-comment">// å£°æ˜ Native æ–¹æ³•</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">external</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getImageMetadataNative</span><span class="hljs-params">(path: <span class="hljs-type">String</span>)</span></span>: ImageMetadata?
}
</code></pre>
<p><strong>æ­¥éª¤ 4ï¼šå®ç° C++ JNI å‡½æ•°</strong></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// ffmpegandoridlibrary.cpp</span>

<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span>
<span class="hljs-function">JNIEXPORT jobject JNICALL
<span class="hljs-title">Java_com_example_ffmpeg_ImageCompress_getImageMetadataNative</span><span class="hljs-params">(
        JNIEnv *env,
        jobject thiz,
        jstring imagePath)</span> </span>{

    <span class="hljs-type">const</span> <span class="hljs-type">char</span> *cPath = <span class="hljs-literal">NULL</span>;
    AVFormatContext *formatCtx = <span class="hljs-literal">NULL</span>;
    jobject metadataObj = <span class="hljs-literal">NULL</span>;

    <span class="hljs-comment">// 1. éªŒè¯è¾“å…¥</span>
    <span class="hljs-keyword">if</span> (imagePath == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;
    }

    <span class="hljs-comment">// 2. è½¬æ¢å­—ç¬¦ä¸²</span>
    cPath = env-&gt;<span class="hljs-built_in">GetStringUTFChars</span>(imagePath, <span class="hljs-literal">NULL</span>);
    <span class="hljs-keyword">if</span> (cPath == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;
    }

    <span class="hljs-comment">// 3. æ‰“å¼€æ–‡ä»¶ï¼ˆä½¿ç”¨ FFmpegï¼‰</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">avformat_open_input</span>(&amp;formatCtx, cPath, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>) != <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">goto</span> CLEANUP;
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">avformat_find_stream_info</span>(formatCtx, <span class="hljs-literal">NULL</span>) &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">goto</span> CLEANUP;
    }

    <span class="hljs-comment">// 4. è·å–å…ƒæ•°æ®</span>
    <span class="hljs-type">int</span> videoStreamIndex = <span class="hljs-built_in">av_find_best_stream</span>(
        formatCtx, AVMEDIA_TYPE_VIDEO, <span class="hljs-number">-1</span>, <span class="hljs-number">-1</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-number">0</span>
    );

    <span class="hljs-keyword">if</span> (videoStreamIndex &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">goto</span> CLEANUP;
    }

    AVStream *stream = formatCtx-&gt;streams[videoStreamIndex];
    AVCodecParameters *codecPar = stream-&gt;codecpar;

    <span class="hljs-comment">// è·å–æ–‡ä»¶å¤§å°</span>
    <span class="hljs-type">int64_t</span> fileSize = <span class="hljs-number">0</span>;
    FILE *file = <span class="hljs-built_in">fopen</span>(cPath, <span class="hljs-string">"rb"</span>);
    <span class="hljs-keyword">if</span> (file) {
        <span class="hljs-built_in">fseek</span>(file, <span class="hljs-number">0</span>, SEEK_END);
        fileSize = <span class="hljs-built_in">ftell</span>(file);
        <span class="hljs-built_in">fclose</span>(file);
    }

    <span class="hljs-comment">// 5. åˆ›å»º Kotlin å¯¹è±¡</span>
    jclass metadataClass = env-&gt;<span class="hljs-built_in">FindClass</span>(<span class="hljs-string">"com/example/ffmpeg/ImageMetadata"</span>);
    <span class="hljs-keyword">if</span> (metadataClass == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">goto</span> CLEANUP;
    }

    <span class="hljs-comment">// æŸ¥æ‰¾æ„é€ å‡½æ•°: (I I J Ljava/lang/String; J)</span>
    jmethodID constructor = env-&gt;<span class="hljs-built_in">GetMethodID</span>(
        metadataClass, <span class="hljs-string">"&lt;init&gt;"</span>, <span class="hljs-string">"(IILjava/lang/String;J)V"</span>
    );

    jstring formatStr = env-&gt;<span class="hljs-built_in">NewStringUTF</span>(<span class="hljs-string">"jpeg"</span>);

    metadataObj = env-&gt;<span class="hljs-built_in">NewObject</span>(
        metadataClass, constructor,
        codecPar-&gt;width,           <span class="hljs-comment">// Int width</span>
        codecPar-&gt;height,          <span class="hljs-comment">// Int height</span>
        formatStr,                 <span class="hljs-comment">// String format</span>
        (jlong)fileSize            <span class="hljs-comment">// Long fileSize</span>
    );

    <span class="hljs-comment">// 6. æ¸…ç†å±€éƒ¨å¼•ç”¨</span>
    env-&gt;<span class="hljs-built_in">DeleteLocalRef</span>(formatStr);
    env-&gt;<span class="hljs-built_in">DeleteLocalRef</span>(metadataClass);

CLEANUP:
    <span class="hljs-comment">// 7. é‡Šæ”¾èµ„æº</span>
    <span class="hljs-keyword">if</span> (formatCtx) {
        <span class="hljs-built_in">avformat_close_input</span>(&amp;formatCtx);
    }
    <span class="hljs-keyword">if</span> (cPath) {
        env-&gt;<span class="hljs-built_in">ReleaseStringUTFChars</span>(imagePath, cPath);
    }

    <span class="hljs-keyword">return</span> metadataObj;
}
</code></pre>
<p><strong>æ­¥éª¤ 5ï¼šä½¿ç”¨æ–¹æ³•</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åœ¨ Kotlin ä»£ç ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">val</span> metadata = FFmpegCompress.getImageCompress()
    .getMetadata(<span class="hljs-string">"/sdcard/photo.jpg"</span>)

metadata?.let {
    println(<span class="hljs-string">"åˆ†è¾¨ç‡: <span class="hljs-subst">${it.getResolution()}</span>"</span>)
    println(<span class="hljs-string">"æ ¼å¼: <span class="hljs-subst">${it.format}</span>"</span>)
    println(<span class="hljs-string">"å¤§å°: <span class="hljs-subst">${it.getReadableSize()}</span>"</span>)
}
</code></pre>
<h4 data-id="heading-40">8.2 å›è°ƒæœºåˆ¶å®ç°</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// C++ ç«¯ï¼šå›è°ƒ Java æ–¹æ³•</span>

<span class="hljs-comment">// 1. å®šä¹‰å›è°ƒæ¥å£æ–¹æ³•</span>
jmethodID onProgressMethod = env-&gt;<span class="hljs-built_in">GetMethodID</span>(
    listenerClass,
    <span class="hljs-string">"onProgress"</span>,
    <span class="hljs-string">"(II)V"</span>  <span class="hljs-comment">// (int, int) -&gt; void</span>
);

<span class="hljs-comment">// 2. è°ƒç”¨å›è°ƒ</span>
env-&gt;<span class="hljs-built_in">CallVoidMethod</span>(listener, onProgressMethod, <span class="hljs-number">50</span>, <span class="hljs-number">100</span>);

<span class="hljs-comment">// 3. æ£€æŸ¥å¼‚å¸¸</span>
<span class="hljs-keyword">if</span> (env-&gt;<span class="hljs-built_in">ExceptionCheck</span>()) {
    env-&gt;<span class="hljs-built_in">ExceptionDescribe</span>();
    env-&gt;<span class="hljs-built_in">ExceptionClear</span>();
}
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Kotlin ç«¯ï¼šå®šä¹‰å›è°ƒæ¥å£</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ProgressListener</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onProgress</span><span class="hljs-params">(current: <span class="hljs-type">Int</span>, total: <span class="hljs-type">Int</span>)</span></span>
}

<span class="hljs-comment">// ä½¿ç”¨</span>
comressor.enqueue(<span class="hljs-keyword">object</span> : ProgressListener {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onProgress</span><span class="hljs-params">(current: <span class="hljs-type">Int</span>, total: <span class="hljs-type">Int</span>)</span></span> {
        println(<span class="hljs-string">"è¿›åº¦: <span class="hljs-variable">$current</span> / <span class="hljs-variable">$total</span>"</span>)
    }
})
</code></pre>
<hr/>
<h3 data-id="heading-41">9. æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-42">9.1 å‘½åè§„èŒƒ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âœ… æ¨èï¼šé¿å…é‡è½½ï¼Œä½¿ç”¨æ˜ç¡®çš„æ–¹æ³•å</span>
<span class="hljs-keyword">external</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">processImage</span><span class="hljs-params">(path: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Boolean</span>
<span class="hljs-keyword">external</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">processImageBytes</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">ByteArray</span>)</span></span>: <span class="hljs-built_in">Boolean</span>

<span class="hljs-comment">// âŒ ä¸æ¨èï¼šé‡è½½ä¼šå¯¼è‡´ç­¾åå¤æ‚</span>
<span class="hljs-keyword">external</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">process</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Boolean</span>
<span class="hljs-keyword">external</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">process</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">ByteArray</span>)</span></span>: <span class="hljs-built_in">Boolean</span>
</code></pre>
<h4 data-id="heading-43">9.2 é”™è¯¯å¤„ç†</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// âœ… æ¨èï¼šç»Ÿä¸€æ¸…ç†æ ‡ç­¾</span>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span>
JNIEXPORT jboolean JNICALL
Java_..._safeMethod(JNIEnv *env, jobject thiz, jstring input) {
    <span class="hljs-type">const</span> <span class="hljs-type">char</span> *cInput = <span class="hljs-literal">NULL</span>;
    jboolean result = JNI_FALSE;

    <span class="hljs-comment">// å‚æ•°éªŒè¯</span>
    <span class="hljs-keyword">if</span> (input == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">return</span> JNI_FALSE;
    }

    <span class="hljs-comment">// èµ„æºè·å–</span>
    cInput = env-&gt;<span class="hljs-built_in">GetStringUTFChars</span>(input, <span class="hljs-literal">NULL</span>);
    <span class="hljs-keyword">if</span> (cInput == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-keyword">return</span> JNI_FALSE;  <span class="hljs-comment">// OOM</span>
    }

    <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">doWork</span>(cInput) != <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// æŠ›å‡ºå¼‚å¸¸</span>
        jclass exc = env-&gt;<span class="hljs-built_in">FindClass</span>(<span class="hljs-string">"java/lang/IllegalArgumentException"</span>);
        env-&gt;<span class="hljs-built_in">ThrowNew</span>(exc, <span class="hljs-string">"Operation failed"</span>);
        env-&gt;<span class="hljs-built_in">DeleteLocalRef</span>(exc);
        <span class="hljs-keyword">goto</span> CLEANUP;
    }

    result = JNI_TRUE;

CLEANUP:
    <span class="hljs-comment">// ç»Ÿä¸€æ¸…ç†</span>
    <span class="hljs-keyword">if</span> (cInput != <span class="hljs-literal">NULL</span>) {
        env-&gt;<span class="hljs-built_in">ReleaseStringUTFChars</span>(input, cInput);
    }
    <span class="hljs-keyword">return</span> result;
}
</code></pre>
<h4 data-id="heading-44">9.3 æ€§èƒ½ä¼˜åŒ–</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// âœ… æ¨èï¼šç¼“å­˜ jclass å’Œ jmethodID</span>
<span class="hljs-type">static</span> jclass gCachedClass = <span class="hljs-literal">NULL</span>;
<span class="hljs-type">static</span> jmethodID gCachedMethod = <span class="hljs-literal">NULL</span>;

<span class="hljs-comment">// åˆå§‹åŒ–æ—¶ç¼“å­˜</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">initCache</span><span class="hljs-params">(JNIEnv *env)</span> </span>{
    jclass local = env-&gt;<span class="hljs-built_in">FindClass</span>(<span class="hljs-string">"java/lang/String"</span>);
    gCachedClass = (jclass)env-&gt;<span class="hljs-built_in">NewGlobalRef</span>(local);
    gCachedMethod = env-&gt;<span class="hljs-built_in">GetMethodID</span>(gCachedClass, <span class="hljs-string">"getBytes"</span>, <span class="hljs-string">"()[B"</span>);
    env-&gt;<span class="hljs-built_in">DeleteLocalRef</span>(local);
}

<span class="hljs-comment">// ä½¿ç”¨æ—¶ç›´æ¥ä½¿ç”¨ç¼“å­˜</span>
<span class="hljs-function">jbyteArray <span class="hljs-title">stringToBytes</span><span class="hljs-params">(JNIEnv *env, jstring str)</span> </span>{
    <span class="hljs-keyword">return</span> (jbyteArray)env-&gt;<span class="hljs-built_in">CallObjectMethod</span>(str, gCachedMethod);
}
</code></pre>
<h4 data-id="heading-45">9.4 çº¿ç¨‹å®‰å…¨</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// âœ… JNI æ–¹æ³•æœ¬èº«æ˜¯çº¿ç¨‹å®‰å…¨çš„</span>
<span class="hljs-comment">// ä½†å…±äº«æ•°æ®éœ€è¦åŠ é”</span>

<span class="hljs-type">static</span> <span class="hljs-type">pthread_mutex_t</span> gLock = PTHREAD_MUTEX_INITIALIZER;

<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span>
JNIEXPORT <span class="hljs-type">void</span> JNICALL
Java_..._threadSafeMethod(JNIEnv *env, jobject thiz) {
    <span class="hljs-comment">// åŠ é”</span>
    <span class="hljs-built_in">pthread_mutex_lock</span>(&amp;gLock);

    <span class="hljs-comment">// è®¿é—®å…±äº«èµ„æº</span>
    <span class="hljs-comment">// ...</span>

    <span class="hljs-comment">// è§£é”</span>
    <span class="hljs-built_in">pthread_mutex_unlock</span>(&amp;gLock);
}
</code></pre>
<h4 data-id="heading-46">9.5 è°ƒè¯•æŠ€å·§</h4>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Android æ—¥å¿—è¾“å‡º</span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;android/log.h&gt;</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">define</span> LOG_TAG <span class="hljs-string">"FFmpegNative"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> LOGI(...) __android_log_print(ANDROID_LOG_INFO, LOG_TAG, __VA_ARGS__)</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> LOGE(...) __android_log_print(ANDROID_LOG_ERROR, LOG_TAG, __VA_ARGS__)</span>

<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span>
JNIEXPORT <span class="hljs-type">void</span> JNICALL
Java_..._debugMethod(JNIEnv *env, jobject thiz) {
    <span class="hljs-built_in">LOGI</span>(<span class="hljs-string">"Method called"</span>);
    <span class="hljs-built_in">LOGE</span>(<span class="hljs-string">"Error occurred: %s"</span>, <span class="hljs-string">"details"</span>);
}
</code></pre>
<hr/>
<h3 data-id="heading-47">10. å¸¸è§é—®é¢˜</h3>
<h4 data-id="heading-48">10.1 UnsatisfiedLinkError</h4>
<pre><code class="hljs language-markdown" lang="markdown">é”™è¯¯ï¼šjava.lang.UnsatisfiedLinkError: No implementation found for method

åŸå› ï¼š
<span class="hljs-bullet">1.</span> JNI å‡½æ•°åä¸åŒ¹é…
<span class="hljs-bullet">2.</span> æ²¡æœ‰åŠ è½½ .so åº“
<span class="hljs-bullet">3.</span> .so åº“æ¶æ„ä¸åŒ¹é…
<span class="hljs-bullet">4.</span> extern "C" ç¼ºå¤±

è§£å†³ï¼š
<span class="hljs-bullet">1.</span> æ£€æŸ¥å‡½æ•°åæ˜¯å¦å®Œå…¨åŒ¹é…
<span class="hljs-bullet">2.</span> ç¡®ä¿è°ƒç”¨ System.loadLibrary()
<span class="hljs-bullet">3.</span> æ£€æŸ¥ CPU æ¶æ„ï¼ˆarm64-v8a, armeabi-v7aï¼‰
<span class="hljs-bullet">4.</span> æ·»åŠ  extern "C"
</code></pre>
<h4 data-id="heading-49">10.2 å†…å­˜æ³„æ¼</h4>
<pre><code class="hljs language-objectivec" lang="objectivec">é—®é¢˜ï¼šGetStringUTFChars åæ²¡æœ‰ Release

è§£å†³ï¼šä½¿ç”¨ <span class="hljs-keyword">goto</span> <span class="hljs-built_in">CLEANUP</span> æ¨¡å¼
</code></pre>
<h4 data-id="heading-50">10.3 å±€éƒ¨å¼•ç”¨æº¢å‡º</h4>
<pre><code class="hljs language-scss" lang="scss">é—®é¢˜ï¼šå¾ªç¯ä¸­åˆ›å»ºå¤§é‡å±€éƒ¨å¼•ç”¨

è§£å†³ï¼šåŠæ—¶ <span class="hljs-built_in">DeleteLocalRef</span>()
</code></pre>
<h4 data-id="heading-51">10.4 å¤šçº¿ç¨‹é—®é¢˜</h4>
<pre><code class="hljs">é—®é¢˜ï¼šJNIEnv ä¸èƒ½è·¨çº¿ç¨‹ä½¿ç”¨

è§£å†³ï¼šæ¯ä¸ªçº¿ç¨‹é€šè¿‡ JavaVM è·å–è‡ªå·±çš„ JNIEnv
</code></pre>
<pre><code class="hljs language-cpp" lang="cpp">JavaVM *gVM = <span class="hljs-literal">NULL</span>;

<span class="hljs-comment">// JNI_OnLoad ä¿å­˜ JavaVM</span>
<span class="hljs-function">JNIEXPORT jint JNICALL <span class="hljs-title">JNI_OnLoad</span><span class="hljs-params">(JavaVM *vm, <span class="hljs-type">void</span> *reserved)</span> </span>{
    gVM = vm;
    <span class="hljs-keyword">return</span> JNI_VERSION_1_6;
}

<span class="hljs-comment">// åœ¨æ–°çº¿ç¨‹ä¸­è·å– JNIEnv</span>
<span class="hljs-function">JNIEnv* <span class="hljs-title">getJNIEnv</span><span class="hljs-params">()</span> </span>{
    JNIEnv *env = <span class="hljs-literal">NULL</span>;
    gVM-&gt;<span class="hljs-built_in">GetEnv</span>((<span class="hljs-type">void</span>**)&amp;env, JNI_VERSION_1_6);
    <span class="hljs-keyword">if</span> (env == <span class="hljs-literal">NULL</span>) {
        <span class="hljs-comment">// çº¿ç¨‹é™„åŠ </span>
        gVM-&gt;<span class="hljs-built_in">AttachCurrentThread</span>(&amp;env, <span class="hljs-literal">NULL</span>);
    }
    <span class="hljs-keyword">return</span> env;
}
</code></pre>
<hr/>
<h3 data-id="heading-52">æ€»ç»“</h3>
<p>æœ¬æ–‡æ¡£æ¶µç›–äº† Android JNI å¼€å‘çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼š</p>
<ol>
<li><strong>JNI åŸºç¡€</strong>ï¼šç†è§£ Kotlin å’Œ C/C++ äº¤äº’çš„æ¡¥æ¢</li>
<li><strong>external å…³é”®å­—</strong>ï¼šå£°æ˜ Native æ–¹æ³•çš„å…³é”®å­—</li>
<li><strong>å‘½åè§„èŒƒ</strong>ï¼šJava æ–¹æ³•åˆ° C å‡½æ•°çš„æ˜ å°„è§„åˆ™</li>
<li><strong>åº“åŠ è½½æœºåˆ¶</strong>ï¼š.so æ–‡ä»¶å¦‚ä½•è¢« JVM åŠ è½½å’Œä½¿ç”¨</li>
<li><strong>æ–¹æ³•æŸ¥æ‰¾ç¼“å­˜</strong>ï¼šJVM å¦‚ä½•é«˜æ•ˆæŸ¥æ‰¾ Native æ–¹æ³•</li>
<li><strong>ç±»å‹ç³»ç»Ÿ</strong>ï¼šKotlin å’Œ C++ ç±»å‹çš„å¯¹åº”å…³ç³»</li>
<li><strong>å†…å­˜ç®¡ç†</strong>ï¼šLocal/Global/Weak å¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸ</li>
<li><strong>å®æˆ˜æ¡ˆä¾‹</strong>ï¼šå®Œæ•´çš„ Native æ–¹æ³•å®ç°æµç¨‹</li>
<li><strong>æœ€ä½³å®è·µ</strong>ï¼šå‘½åã€é”™è¯¯å¤„ç†ã€æ€§èƒ½ä¼˜åŒ–</li>
<li><strong>å¸¸è§é—®é¢˜</strong>ï¼šé”™è¯¯æ’æŸ¥å’Œè§£å†³æ–¹æ¡ˆ</li>
</ol>
<p>æŒæ¡è¿™äº›çŸ¥è¯†ç‚¹ï¼Œä½ å°±å¯ä»¥ç†Ÿç»ƒåœ°åœ¨ Android é¡¹ç›®ä¸­ä½¿ç”¨ JNI è¿›è¡Œé«˜æ€§èƒ½å¼€å‘ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Mybatisæ’ä»¶åŸç†åŠåˆ†é¡µæ’ä»¶]]></title>    <link>https://juejin.cn/post/7596181746082955314</link>    <guid>https://juejin.cn/post/7596181746082955314</guid>    <pubDate>2026-01-18T14:11:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596181746082955314" data-draft-id="7595895132261302323" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Mybatisæ’ä»¶åŸç†åŠåˆ†é¡µæ’ä»¶"/> <meta itemprop="keywords" content="Java,æ¶æ„,æºç é˜…è¯»"/> <meta itemprop="datePublished" content="2026-01-18T14:11:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜ä¾ å®¢è¡Œ"/> <meta itemprop="url" content="https://juejin.cn/user/556801719828361"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Mybatisæ’ä»¶åŸç†åŠåˆ†é¡µæ’ä»¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/556801719828361/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜ä¾ å®¢è¡Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T14:11:33.000Z" title="Sun Jan 18 2026 14:11:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Mybatisæ¡†æ¶å…è®¸ç”¨æˆ·é€šè¿‡è‡ªå®šä¹‰æ‹¦æˆªå™¨æ¥æ”¹å˜SQLçš„æ‰§è¡Œè¡Œä¸ºï¼Œä¾‹å¦‚åœ¨SQLæ‰§è¡Œè¿½åŠ åˆ†é¡µè¯­å¥ã€ç»Ÿè®¡SQLæ‰§è¡Œè€—æ—¶ç­‰ã€‚<strong>è‡ªå®šä¹‰æ‹¦æˆªå™¨ä¹Ÿè¢«ç§°ä¸ºMybatisæ’ä»¶ï¼Œæ’ä»¶æ˜¯ MyBatis æ‰©å±•æ ¸å¿ƒåŠŸèƒ½çš„å¸¸ç”¨æ–¹å¼ã€‚</strong></p>
<blockquote>
<p>æ³¨ï¼šæœ¬æ–‡ä¸­æºç æ¥è‡ªmybatis 3.4.xç‰ˆæœ¬ï¼Œåœ°å€<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmybatis%2Fmybatis-3.git" target="_blank" title="https://github.com/mybatis/mybatis-3.git" ref="nofollow noopener noreferrer">github.com/mybatis/mybâ€¦</a></p>
</blockquote>
<h2 data-id="heading-0">ä¸€ æ’ä»¶åŸç†</h2>
<h3 data-id="heading-1">1.1 é…ç½®æ’ä»¶ä¿¡æ¯</h3>
<p>åœ¨Mybatisä¸»é…ç½®æ–‡ä»¶ä¸­ï¼Œé€šè¿‡æ ‡ç­¾æ¥æ³¨å†Œè‡ªå®šä¹‰æ’ä»¶ã€‚å¦‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span> <span class="hljs-attr">interceptor</span>=<span class="hljs-string">"com.example.MyCustomPlugin"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- å¯é€‰ï¼šä¼ é€’å±æ€§ç»™æ’ä»¶
        &lt;property name="name" value="page"/&gt;
    &lt;/plugin&gt;
&lt;/plugins&gt;
</span></code></pre>
<p>åœ¨XMLConfigBuilder#parseConfigurationä¸­ï¼Œä¼šè§£æpluginsæ ‡ç­¾å†…å®¹ï¼Œåˆ›å»ºInterceptorå¹¶æ³¨å†Œåˆ°Configurationçš„InterceptorChain interceptorChainã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc0fe777186e40f898155ff89fd9159e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769350292&amp;x-signature=vTq9vmmJ09YEOR9j%2FpowsblYq%2F4%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">1.2 å£°æ˜æ‹¦æˆªå™¨</h3>
<p>MyBatis æ’ä»¶æœ¬è´¨æ˜¯åŸºäºåŠ¨æ€ä»£ç†å®ç°çš„ï¼Œåªèƒ½æ‹¦æˆªå››å¤§æ ¸å¿ƒå¯¹è±¡çš„æ–¹æ³•ï¼š</p>
<ul>
<li><code>Executor</code>ï¼šæ‰§è¡Œå™¨ï¼ˆè´Ÿè´£ SQL æ‰§è¡Œã€ç¼“å­˜ç®¡ç†ï¼‰</li>
<li><code>StatementHandler</code>ï¼šSQL è¯­å¥å¤„ç†å™¨ï¼ˆè´Ÿè´£ SQL æ„å»ºã€å‚æ•°è®¾ç½®ï¼‰</li>
<li><code>ParameterHandler</code>ï¼šå‚æ•°å¤„ç†å™¨ï¼ˆè´Ÿè´£å‚æ•°è§£æï¼‰</li>
<li><code>ResultSetHandler</code>ï¼šç»“æœé›†å¤„ç†å™¨ï¼ˆè´Ÿè´£ç»“æœé›†æ˜ å°„ï¼‰</li>
</ul>
<p>ä¸ºä»€ä¹ˆæ˜¯è¿™4å¤§ç»„ä»¶å‘¢ï¼ŸConfigurationä½œä¸ºè¿™äº›ç»„ä»¶çš„åˆ›å»ºå·¥å‚ï¼Œä¼šåº”ç”¨æ‹¦æˆªå™¨å¹¶è¿”å›ä»£ç†å¯¹è±¡ï¼ˆä»¥StatementHandlerä¸ºä¾‹ï¼‰</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f033b0d7303a46a3b81c3d38302a36d2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769350292&amp;x-signature=0aop%2FfoyKZCNf0Z2pAgzsYufMYI%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94f45da419444992a080d5bab14b04cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769350292&amp;x-signature=pgjv8%2FzTfhk65ARJVsS7i3iJYB4%3D" alt="" loading="lazy"/></p>
<p>è‡ªå®šä¹‰æ’ä»¶éœ€è¦å®ç°Interceptoræ¥å£</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01aeed30ec1248ebb58e1f705fbff15c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769350292&amp;x-signature=TbbRGiHyKjtkj7xb239ktadsaPw%3D" alt="" loading="lazy"/></p>
<p>å…¶ä¸­ï¼ŒInvocationå°è£…äº†ç›®æ ‡å¯¹è±¡ã€æ–¹æ³•åŠå‚æ•°ä¿¡æ¯ï¼Œé€šè¿‡å®ƒæ¥è·å–ä¸Šè¿°4ä¸ªç»„ä»¶å¯¹è±¡çš„æ‰€æœ‰ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Invocation</span> {

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Object target;
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Method method;
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Object[] args;
  <span class="hljs-comment">// å›è°ƒåŸæ–¹æ³•</span>
  <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">proceed</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InvocationTargetException, IllegalAccessException {
    <span class="hljs-keyword">return</span> method.invoke(target, args);
  }
}
</code></pre>
<h3 data-id="heading-3">1.3 åˆ›å»ºä»£ç†å¯¹è±¡</h3>
<p>ä¸ºäº†æ–¹ä¾¿åˆ›å»º<code>Executor</code>ç­‰çš„ä»£ç†å¯¹è±¡ï¼ŒMybatisæä¾›äº†ä¸€ä¸ªPluginå·¥å…·ç±»ã€‚å…³é”®ä»£ç å¦‚ä¸‹ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9147206faafa49c48af1620a1d464305~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769350292&amp;x-signature=0DnLWGEe3aTlclWbvOmODrtkZG8%3D" alt="" loading="lazy"/>Pluginç±»å®ç°äº†InvocationHandleræ¥å£ï¼Œå³é‡‡ç”¨JDKåŠ¨æ€ä»£ç†æ¥åˆ›å»ºä»£ç†å¯¹è±¡ã€‚å½“<code>Executor</code>æ‰§è¡ŒæŸä¸ªæ–¹æ³•æ—¶ï¼Œå¦‚æœæ–¹æ³•è¢«æŒ‡å®šéœ€è¦å¢å¼ºï¼Œå°±ä¼šå…ˆæ‰§è¡ŒInterceptor#interceptæ–¹æ³•ã€‚</p>
<p>Plugin#getSignatureMapæ–¹æ³•ï¼Œä¼šè§£æInterceptorå®ç°ç±»çš„Interceptsæ³¨è§£ä¿¡æ¯ï¼Œå¾—åˆ°æ‹¦æˆªèŒƒå›´ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// @Intercepts æ³¨è§£ï¼šæŒ‡å®šæ‹¦æˆªçš„å¯¹è±¡å’Œæ–¹æ³•ï¼ˆæ ¸å¿ƒï¼‰</span>
<span class="hljs-meta">@Intercepts({
    // @Signatureï¼šå•ä¸ªæ‹¦æˆªè§„åˆ™
    // typeï¼šæ‹¦æˆªçš„æ ¸å¿ƒå¯¹è±¡ï¼ˆExecutor/StatementHandler ç­‰ï¼‰
    // methodï¼šæ‹¦æˆªçš„æ–¹æ³•åï¼ˆæ¯”å¦‚ Executor çš„ query æ–¹æ³•ï¼‰
    // argsï¼šæ‹¦æˆªæ–¹æ³•çš„å‚æ•°ç±»å‹ï¼ˆç”¨äºåŒºåˆ†é‡è½½æ–¹æ³•ï¼‰
    @Signature(
        type = Executor.class,
        method = "query",
        args = {org.apache.ibatis.mapping.MappedStatement.class, Object.class, RowBounds.class, ResultHandler.class}
    )
})</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCustomPlugin</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Interceptor</span> {
}
</code></pre>
<h3 data-id="heading-4">1.4 è‡ªå®šä¹‰æ’ä»¶ç¤ºä¾‹</h3>
<p>æˆ‘ä»¬åªéœ€è¦å®ç°Interceptoræ¥å£ï¼Œåœ¨intercept()ä¸­ç¼–å†™å¢å¼ºé€»è¾‘ï¼Œé€šè¿‡plugin()è¿”å›ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œå°±èƒ½è‡ªå®šä¹‰ä¸€ä¸ªMybatisæ’ä»¶äº†ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Intercepts({
    @Signature(
        type = Executor.class,
        method = "query",
        args = {org.apache.ibatis.mapping.MappedStatement.class, Object.class, RowBounds.class, ResultHandler.class}
    )
})</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCustomPlugin</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Interceptor</span> {
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">intercept</span><span class="hljs-params">(Invocation invocation)</span> <span class="hljs-keyword">throws</span> Throwable {
        Object[] args = invocation.getArgs();
        System.out.println(<span class="hljs-string">"SQL æ‰§è¡Œå‚æ•°ï¼š"</span> + args[<span class="hljs-number">1</span>]);
        <span class="hljs-type">Object</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> invocation.proceed();
        System.out.println(<span class="hljs-string">"===== query æ–¹æ³•æ‰§è¡Œå®Œæˆ ====="</span>);
        <span class="hljs-keyword">return</span> result;
    }

    <span class="hljs-comment">// ç”Ÿæˆä»£ç†å¯¹è±¡</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">plugin</span><span class="hljs-params">(Object target)</span> {
        <span class="hljs-keyword">return</span> Plugin.wrap(target, <span class="hljs-built_in">this</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setProperties</span><span class="hljs-params">(Properties properties)</span> {
        <span class="hljs-built_in">this</span>.name = properties.getProperty(<span class="hljs-string">"name"</span>);
    }
}
</code></pre>
<h2 data-id="heading-5">äºŒ è‡ªå®šä¹‰åˆ†é¡µæ’ä»¶</h2>
<h3 data-id="heading-6">2.1 Mybatisè‡ªå¸¦åˆ†é¡µåŠŸèƒ½</h3>
<p>å…¶å®ï¼ŒMybatisæ”¯æŒåˆ†é¡µæŸ¥è¯¢ï¼Œåªå¯æƒœæ˜¯å†…å­˜åˆ†é¡µï¼Œä»ç„¶ä¼šæŸ¥è¯¢å…¨éƒ¨æ•°æ®ï¼Œåªæ˜¯åœ¨å†…å­˜ä¸­è¿‡æ»¤ã€‚</p>
<p>ä½¿ç”¨RowBoundsç±»ï¼Œé€šè¿‡ offsetï¼ˆåç§»é‡ï¼‰å’Œ limitï¼ˆé™åˆ¶æ•°é‡ï¼‰æ§åˆ¶æ‰€è¦å¤„ç†çš„ç»“æœé›†èŒƒå›´ï¼Œç›¸å½“äºæ‰§è¡Œäº† resultList.subList(offset, offset + limit)ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// SqlSessionä¸­</span>
&lt;E&gt; List&lt;E&gt; <span class="hljs-title function_">selectList</span><span class="hljs-params">(String statement, Object parameter, RowBounds rowBounds)</span>;
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5b5b7a1c734418d86e2bc1a872db0f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769350292&amp;x-signature=4c38cFt%2Bo3C6E30faf6IKkMoSNA%3D" alt="" loading="lazy"/>
åœ¨å¤„ç†ResultSetæ—¶ï¼Œè·³è¿‡offsetæ¡ï¼Œé™åˆ¶æœ€å¤šå¤„ç†limitæ¡ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a53eab57dad5473a84a65a34c828e106~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY5L6g5a6i6KGM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769350292&amp;x-signature=MCjjxiK0JMPVTxhvGEfagMSZi9w%3D" alt="" loading="lazy"/></p>
<p><strong>RowBoundsåªé€‚åˆæ•°æ®é‡ä¸å¤§çš„åœºæ™¯ï¼Œç”Ÿäº§ç¯å¢ƒé€šå¸¸ä½¿ç”¨ç‰©ç†åˆ†é¡µæ’ä»¶æ›¿ä»£ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">SqlSession</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sqlSessionFactory.openSession();
<span class="hljs-type">UserMapper</span> <span class="hljs-variable">mapper</span> <span class="hljs-operator">=</span> session.getMapper(UserMapper.class);
<span class="hljs-comment">// è·³è¿‡å‰10æ¡ï¼Œè¿”å›æœ€å¤š20æ¡è®°å½•</span>
<span class="hljs-type">RowBounds</span> <span class="hljs-variable">rowBounds</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RowBounds</span>(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>);
List&lt;User&gt; user = mapper.selectByAge(<span class="hljs-number">20</span>, rowBounds);
</code></pre>
<h3 data-id="heading-7">2.2 è‡ªå®šä¹‰åˆ†é¡µæ’ä»¶</h3>
<p>åŸºäºæˆ‘ä»¬æŒæ¡çš„æ’ä»¶åŸç†ï¼Œå®Œå…¨å¯ä»¥è‡ªè¡Œå®šä¹‰ä¸€ä¸ªåˆ†é¡µæ’ä»¶ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å£°æ˜ä¸€ä¸ªPageç±»æ¥å°è£…åˆ†é¡µå‚æ•°</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Page</span>&lt;T&gt; {
  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">pageNo</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;      <span class="hljs-comment">// å½“å‰é¡µç </span>
  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">pageSize</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;    <span class="hljs-comment">// æ¯é¡µå¤§å°</span>
  <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> total;           <span class="hljs-comment">// æ€»è®°å½•æ•°</span>
  <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> totalPage;   	<span class="hljs-comment">// æ€»é¡µæ•°</span>
  <span class="hljs-comment">// çœç•¥getter/setter</span>
}
</code></pre>
<p>å†åˆ›å»ºæ‹¦æˆªå™¨ï¼Œæ‹¦æˆª StatementHandler çš„ prepare æ–¹æ³•ï¼Œæ”¹å†™ SQL æ·»åŠ åˆ†é¡µè¯­å¥ï¼Œå¹¶é¢å¤–æŸ¥è¯¢ä¸€æ¬¡æ€»è®°å½•æ•°ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.sql.Connection;
<span class="hljs-keyword">import</span> java.sql.PreparedStatement;
<span class="hljs-keyword">import</span> java.sql.ResultSet;
<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.Properties;
<span class="hljs-keyword">import</span> org.apache.ibatis.executor.statement.RoutingStatementHandler;
<span class="hljs-keyword">import</span> org.apache.ibatis.executor.statement.StatementHandler;
<span class="hljs-keyword">import</span> org.apache.ibatis.mapping.BoundSql;
<span class="hljs-keyword">import</span> org.apache.ibatis.mapping.MappedStatement;
<span class="hljs-keyword">import</span> org.apache.ibatis.mapping.ParameterMapping;
<span class="hljs-keyword">import</span> org.apache.ibatis.reflection.SystemMetaObject;
<span class="hljs-keyword">import</span> org.apache.ibatis.scripting.defaults.DefaultParameterHandler;

<span class="hljs-comment">/**
 * MySQL åˆ†é¡µæ’ä»¶
 * æ‹¦æˆª StatementHandler çš„ prepare æ–¹æ³•ï¼Œæ”¹å†™ SQL æ·»åŠ åˆ†é¡µè¯­å¥
 */</span>
<span class="hljs-meta">@Intercepts({
    @Signature(type = StatementHandler.class, method = "prepare", args = {Connection.class, Integer.class})
})</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PageInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Interceptor</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">intercept</span><span class="hljs-params">(Invocation invocation)</span> <span class="hljs-keyword">throws</span> Throwable {
        <span class="hljs-type">RoutingStatementHandler</span> <span class="hljs-variable">handler</span> <span class="hljs-operator">=</span> (RoutingStatementHandler) invocation.getTarget();
        <span class="hljs-type">StatementHandler</span> <span class="hljs-variable">delegate</span> <span class="hljs-operator">=</span> (StatementHandler) SystemMetaObject.forObject(handler).getValue(<span class="hljs-string">"delegate"</span>);
        <span class="hljs-type">MappedStatement</span> <span class="hljs-variable">mappedStatement</span> <span class="hljs-operator">=</span> (MappedStatement) SystemMetaObject.forObject(delegate).getValue(<span class="hljs-string">"mappedStatement"</span>);

        <span class="hljs-comment">// è·å– BoundSql</span>
        <span class="hljs-type">BoundSql</span> <span class="hljs-variable">boundSql</span> <span class="hljs-operator">=</span> delegate.getBoundSql();
        <span class="hljs-type">Object</span> <span class="hljs-variable">parameterObject</span> <span class="hljs-operator">=</span> boundSql.getParameterObject();

        <span class="hljs-comment">// åˆ¤æ–­å‚æ•°æ˜¯å¦ä¸º Page å¯¹è±¡</span>
        <span class="hljs-keyword">if</span> (parameterObject <span class="hljs-keyword">instanceof</span> Page) {
            Page&lt;?&gt; page = (Page&lt;?&gt;) parameterObject;
            <span class="hljs-type">String</span> <span class="hljs-variable">originalSql</span> <span class="hljs-operator">=</span> boundSql.getSql();

            <span class="hljs-comment">// 1. æŸ¥è¯¢æ€»è®°å½•æ•°</span>
            <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> (Connection) invocation.getArgs()[<span class="hljs-number">0</span>];
            <span class="hljs-type">long</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.queryTotal(connection, page, mappedStatement);
            page.setTotal(total);
            page.setTotalPage(total % page.getPageSize() == <span class="hljs-number">0</span> ? total / page.getPageSize() : total / page.getPageSize() + <span class="hljs-number">1</span>);
            
            <span class="hljs-comment">// 2. æ”¹å†™ SQLï¼Œæ·»åŠ  LIMIT åˆ†é¡µ</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">pageSql</span> <span class="hljs-operator">=</span> originalSql + <span class="hljs-string">" LIMIT "</span> + page.getOffset() + <span class="hljs-string">", "</span> + page.getPageSize();

            <span class="hljs-comment">// é€šè¿‡åå°„ä¿®æ”¹ BoundSql ä¸­çš„ SQL</span>
            SystemMetaObject.forObject(boundSql).setValue(<span class="hljs-string">"sql"</span>, pageSql);
        }
        <span class="hljs-keyword">return</span> invocation.proceed();
    }

    <span class="hljs-comment">/**
   * æŸ¥è¯¢æ€»è®°å½•æ•°
   */</span>
  <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> <span class="hljs-title function_">queryTotal</span><span class="hljs-params">(Connection connection, Object parameterObject, MappedStatement mappedStatement)</span> <span class="hljs-keyword">throws</span> Exception {
    <span class="hljs-type">BoundSql</span> <span class="hljs-variable">boundSql</span> <span class="hljs-operator">=</span> mappedStatement.getBoundSql(parameterObject);
    <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"SELECT COUNT(*) FROM ("</span> + boundSql.getSql() + <span class="hljs-string">") tmp_count"</span>;
    <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">ps</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
    <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">try</span> {
      ps = connection.prepareStatement(sql);
      <span class="hljs-comment">// è®¾ç½®å‚æ•°ï¼ˆå¦‚æœæœ‰ï¼‰</span>
      <span class="hljs-keyword">if</span> (boundSql.getParameterMappings() != <span class="hljs-literal">null</span> &amp;&amp; !boundSql.getParameterMappings().isEmpty()) {
        List&lt;ParameterMapping&gt; parameterMappings = boundSql.getParameterMappings();
        <span class="hljs-type">BoundSql</span> <span class="hljs-variable">countSql</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BoundSql</span>(mappedStatement.getConfiguration(), sql, parameterMappings, parameterObject);
        <span class="hljs-type">DefaultParameterHandler</span> <span class="hljs-variable">parameterHandler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultParameterHandler</span>(mappedStatement, parameterObject, countSql);
        parameterHandler.setParameters(ps);
      }

      rs = ps.executeQuery();
      <span class="hljs-keyword">if</span> (rs.next()) {
        <span class="hljs-keyword">return</span> rs.getLong(<span class="hljs-number">1</span>);
      }
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-keyword">if</span> (rs != <span class="hljs-literal">null</span>) {
        rs.close();
      }
      <span class="hljs-keyword">if</span> (ps != <span class="hljs-literal">null</span>) {
        ps.close();
      }
    }
  }


  <span class="hljs-meta">@Override</span>
  <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">plugin</span><span class="hljs-params">(Object target)</span> {
    <span class="hljs-comment">// åªæ‹¦æˆª StatementHandler</span>
    <span class="hljs-keyword">if</span> (target <span class="hljs-keyword">instanceof</span> StatementHandler) {
      <span class="hljs-keyword">return</span> Plugin.wrap(target, <span class="hljs-built_in">this</span>);
    }
    <span class="hljs-keyword">return</span> target;
  }

  <span class="hljs-meta">@Override</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setProperties</span><span class="hljs-params">(Properties properties)</span> {
  }
}
</code></pre>
<p>åœ¨Mybatisä¸»é…ç½®ä¸­æ·»åŠ æ’ä»¶ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span> <span class="hljs-attr">interceptor</span>=<span class="hljs-string">"com.example.PageInterceptor"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
</code></pre>
<p>åˆ›å»ºUserQueryç±»ï¼Œå°è£…æŸ¥è¯¢æ¡ä»¶ã€‚æ‰§è¡ŒæŸ¥è¯¢åï¼Œå°±èƒ½ä»UserQueryä¸­è·å–totalç­‰ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserQuery</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Page</span>&lt;User&gt; {

  <span class="hljs-keyword">private</span> String name;          <span class="hljs-comment">// å§“åï¼ˆæ¨¡ç³ŠæŸ¥è¯¢ï¼‰</span>
  <span class="hljs-keyword">private</span> Integer minAge;       <span class="hljs-comment">// æœ€å°å¹´é¾„</span>
  <span class="hljs-keyword">private</span> Integer maxAge;       <span class="hljs-comment">// æœ€å¤§å¹´é¾„</span>
  <span class="hljs-keyword">private</span> String sex;
  <span class="hljs-comment">// çœç•¥getter/setter</span>
}
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">UserQuery</span> <span class="hljs-variable">query</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserQuery</span>();
query.setPageNum(<span class="hljs-number">1</span>);
query.setPageSize(<span class="hljs-number">20</span>);
query.setName(<span class="hljs-string">"å¼ ä¸‰"</span>);
query.setMinAge(<span class="hljs-number">20</span>);
query.setMaxAge(<span class="hljs-number">40</span>);
List&lt;User&gt; users = userMapper.selectByPage(query);
<span class="hljs-type">long</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> query.getTotal();
<span class="hljs-type">long</span> <span class="hljs-variable">totalPage</span> <span class="hljs-operator">=</span> query.getTotalPage();
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€æŠ€æœ¯ä¸“é¢˜ã€‘AIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å…¥é—¨-æ‹¥æŠ±Hugging Faceä¸Transformersç”Ÿæ€ - åŸºäºBERTæ–‡æœ¬åˆ†ç±»æ¨¡å‹å¾®è°ƒ]]></title>    <link>https://juejin.cn/post/7596709272976064558</link>    <guid>https://juejin.cn/post/7596709272976064558</guid>    <pubDate>2026-01-19T09:43:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596709272976064558" data-draft-id="7596698363964096550" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€æŠ€æœ¯ä¸“é¢˜ã€‘AIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å…¥é—¨-æ‹¥æŠ±Hugging Faceä¸Transformersç”Ÿæ€ - åŸºäºBERTæ–‡æœ¬åˆ†ç±»æ¨¡å‹å¾®è°ƒ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-19T09:43:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°é”‹java1234"/> <meta itemprop="url" content="https://juejin.cn/user/4152222342709933"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€æŠ€æœ¯ä¸“é¢˜ã€‘AIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å…¥é—¨-æ‹¥æŠ±Hugging Faceä¸Transformersç”Ÿæ€ - åŸºäºBERTæ–‡æœ¬åˆ†ç±»æ¨¡å‹å¾®è°ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4152222342709933/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°é”‹java1234
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T09:43:15.000Z" title="Mon Jan 19 2026 09:43:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯é”‹å“¥ã€‚æœ€è¿‘è¿è½½æ›´æ–°ã€ŠAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å…¥é—¨-æ‹¥æŠ±Hugging Faceä¸Transformersç”Ÿæ€ã€‹æŠ€æœ¯ä¸“é¢˜ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9ed9d66e2f0492290168c5ed9f7163a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZSLamF2YTEyMzQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769420595&amp;x-signature=keA%2FiGkRKSn37iE8vphMx7PN7Uk%3D" alt="QQæˆªå›¾20260117190029.jpg" loading="lazy"/> æœ¬è¯¾ç¨‹ä¸»è¦ä»‹ç»å’Œè®²è§£Hugging Faceå’ŒTransformersï¼ŒåŒ…æ‹¬åŠ è½½é¢„è®­ç»ƒæ¨¡å‹ï¼Œè‡ªå®šä¹‰æ•°æ®é›†ï¼Œæ¨¡å‹æ¨ç†ï¼Œæ¨¡å‹å¾®è°ƒï¼Œæ¨¡å‹æ€§èƒ½è¯„ä¼°ç­‰ã€‚æ˜¯AIå¤§æ¨¡å‹åº”ç”¨å¼€å‘çš„å…¥é—¨å¿…å¤‡çŸ¥è¯†ã€‚ åŒæ—¶ä¹Ÿé…å¥—è§†é¢‘æ•™ç¨‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV11L6RBwE8m%2F" title="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV11L6RBwE8m%2F" target="_blank">ã€Š2027ç‰ˆ AIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å…¥é—¨-æ‹¥æŠ±Hugging Faceä¸Transformersç”Ÿæ€ è§†é¢‘æ•™ç¨‹(æ— åºŸè¯ç‰ˆ) ç©å‘½æ›´æ–°ä¸­~ã€‹</a></p>
<h2 data-id="heading-0">æ¨¡å‹å¾®è°ƒç®€ä»‹</h2>
<p><strong>æ¨¡å‹å¾®è°ƒ</strong>ï¼ˆModel Fine-Tuningï¼‰ æ˜¯è¿ç§»å­¦ä¹ ä¸­çš„ä¸€ç§æ ¸å¿ƒæŠ€æœ¯ï¼ŒæŒ‡åœ¨ä¸€ä¸ªå·²ç»é¢„è®­ç»ƒå¥½çš„å¤§å‹é€šç”¨æ¨¡å‹ï¼ˆç§°ä¸º<strong>åŸºåº§æ¨¡å‹</strong>ï¼‰çš„åŸºç¡€ä¸Šï¼Œä½¿ç”¨<strong>ç‰¹å®šé¢†åŸŸæˆ–ä»»åŠ¡çš„æ•°æ®é›†</strong>è¿›è¡Œé¢å¤–çš„ã€æœ‰é’ˆå¯¹æ€§çš„è®­ç»ƒï¼Œä½¿æ¨¡å‹é€‚åº”æ–°ä»»åŠ¡çš„è¿‡ç¨‹ã€‚</p>
<p><strong>é€šä¿—æ¯”å–»ï¼š</strong></p>
<ul>
<li><strong>é¢„è®­ç»ƒ</strong>ï¼šè®©ä¸€ä¸ªå­¦ç”Ÿï¼ˆæ¨¡å‹ï¼‰è¯»å®Œæ•´ä¸ªå›¾ä¹¦é¦†çš„ä¹¦ï¼Œè·å¾—å¹¿æ³›çš„é€šè¯†çŸ¥è¯†ã€‚</li>
<li><strong>å¾®è°ƒ</strong>ï¼šç„¶åè®©è¿™ä¸ªå­¦ç”Ÿä¸“æ”»æŸä¸€ä¸ªå­¦ç§‘ï¼ˆä¾‹å¦‚åŒ»å­¦æˆ–æ³•å¾‹ï¼‰ï¼Œå­¦ä¹ è¿™ä¸ªé¢†åŸŸçš„ä¸“ä¸šä¹¦ç±å’Œæ¡ˆä¾‹ï¼Œä»è€Œæˆä¸ºè¯¥é¢†åŸŸçš„ä¸“å®¶ã€‚</li>
</ul>
<h2 data-id="heading-1">ä¸ºä»€ä¹ˆéœ€è¦å¾®è°ƒï¼Ÿï¼ˆä¼˜åŠ¿ï¼‰</h2>
<ol start="0">
<li><strong>é™ä½æ•°æ®éœ€æ±‚</strong>ï¼šä»å¤´è®­ç»ƒä¸€ä¸ªå¤§æ¨¡å‹ï¼ˆå¦‚LLMæˆ–CVå¤§æ¨¡å‹ï¼‰éœ€è¦æµ·é‡æ•°æ®å’Œå·¨å¤§çš„ç®—åŠ›ã€‚å¾®è°ƒåªéœ€ç›¸å¯¹å°‘é‡çš„é«˜è´¨é‡ä¸“ä¸šæ•°æ®å³å¯ï¼Œæˆæœ¬æä½ã€‚</li>
<li><strong>èŠ‚çœè®¡ç®—èµ„æºå’Œæ—¶é—´</strong>ï¼šé¢„è®­ç»ƒæ¨¡å‹å·²ç»å­¦ä¼šäº†é€šç”¨çš„ç‰¹å¾è¡¨ç¤ºï¼ˆå¦‚è¯­è¨€è§„åˆ™ã€å›¾åƒçº¹ç†ï¼‰ï¼Œå¾®è°ƒåªéœ€åœ¨æ­¤åŸºç¡€ä¸Šâ€œå¾®è°ƒâ€å‚æ•°ï¼Œè®­ç»ƒé€Ÿåº¦å¿«å¾—å¤šã€‚</li>
<li><strong>æå‡ç‰¹å®šä»»åŠ¡æ€§èƒ½</strong>ï¼šåœ¨ç›®æ ‡é¢†åŸŸï¼ˆå¦‚åŒ»ç–—é—®ç­”ã€æ³•å¾‹æ–‡ä¹¦åˆ†æã€ç‰¹å®šé£æ ¼çš„ç»˜ç”»ï¼‰ä¸Šï¼Œå¾®è°ƒåçš„æ¨¡å‹æ€§èƒ½è¿œä¼˜äºç›´æ¥ä½¿ç”¨é€šç”¨æ¨¡å‹ã€‚</li>
<li><strong>é¿å…ç¾éš¾æ€§é—å¿˜</strong>ï¼šä¸ä»å¤´å­¦ä¹ ç›¸æ¯”ï¼Œå¾®è°ƒæ˜¯ä¸€ç§æ¸©å’Œçš„è°ƒæ•´ï¼Œèƒ½åœ¨ä¿æŒæ¨¡å‹é€šç”¨èƒ½åŠ›çš„åŒæ—¶ï¼Œå¢å¼ºå…¶ä¸“ä¸šèƒ½åŠ›ã€‚</li>
</ol>
<h2 data-id="heading-2">åŸºäºBERTæ¨¡å‹å¾®è°ƒè®­ç»ƒ</h2>
<h3 data-id="heading-3">1ï¼Œè‡ªå®šä¹‰æ•°æ®é›†</h3>
<p>é¦–å…ˆæˆ‘ä»¬å‡†å¤‡ä¸‹è®­ç»ƒå’Œæµ‹è¯•æ•°æ®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6d4c47df3174676ae06edc9f921c014~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZSLamF2YTEyMzQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769420595&amp;x-signature=LT6Gg9qdCfZgVR4tgpMo8hQUY7c%3D" alt="image.png" loading="lazy"/></p>
<p>8åƒå¤šæ¡çš„è®­ç»ƒé›†æ•°æ®ï¼Œ2åƒå¤šæ¡çš„æµ‹è¯•é›†æ•°æ®ã€‚</p>
<p>æˆ‘ä»¬ä¹‹æ‰€ä»¥è¦è‡ªå®šä¹‰æ•°æ®é›†ï¼Œæ˜¯å› ä¸ºéœ€è¦å»é€‚é…è®­ç»ƒæ¨¡å‹éœ€è¦çš„æ•°æ®æ ¼å¼ã€‚</p>
<p>è‡ªå®šä¹‰æ•°æ®é›†å‚è€ƒä»£ç ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">from datasets import load_dataset
from torch.utils.data import Dataset
â€‹
â€‹
<span class="hljs-comment"># è‡ªå®šä¹‰æ•°æ®é›†</span>
class MyDataset(Dataset):
â€‹
 Â  Â def __init__(self, split):
 Â  Â  Â  Â <span class="hljs-comment"># åŠ è½½è®­ç»ƒé›†</span>
 Â  Â  Â  Â <span class="hljs-attr">train_dataset</span> = load_dataset(path=<span class="hljs-string">"csv"</span>, data_files=<span class="hljs-string">"../weibo_senti_8k_train.csv"</span>)
 Â  Â  Â  Â <span class="hljs-comment"># åŠ è½½æµ‹è¯•é›†</span>
 Â  Â  Â  Â <span class="hljs-attr">test_dataset</span> = load_dataset(path=<span class="hljs-string">"csv"</span>, data_files=<span class="hljs-string">"../weibo_senti_2k_test.csv"</span>)
 Â  Â  Â  Â if <span class="hljs-attr">split</span> == <span class="hljs-string">'train'</span>:
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">self.data</span> = train_dataset[<span class="hljs-string">'train'</span>]
 Â  Â  Â  Â elif <span class="hljs-attr">split</span> == <span class="hljs-string">'test'</span>:
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">self.data</span> = test_dataset[<span class="hljs-string">'train'</span>]
â€‹
 Â  Â <span class="hljs-comment"># è·å–æ•°æ®é›†å¤§å°</span>
 Â  Â def __len__(self):
 Â  Â  Â  Â return len(self.data)
â€‹
 Â  Â <span class="hljs-comment"># è·å–æ•°æ®é›†çš„æŸä¸ªå…ƒç´ </span>
 Â  Â def __getitem__(self, index):
 Â  Â  Â  Â <span class="hljs-attr">sentence</span> = self.data[index][<span class="hljs-string">'sentence'</span>]
 Â  Â  Â  Â <span class="hljs-attr">label</span> = self.data[index][<span class="hljs-string">'label'</span>]
 Â  Â  Â  Â return sentence, label
â€‹
â€‹
if <span class="hljs-attr">__name__</span> == <span class="hljs-string">'__main__'</span>:
 Â  Â <span class="hljs-attr">train_dataset</span> = MyDataset(<span class="hljs-string">'train'</span>)
 Â  Â <span class="hljs-attr">test_dataset</span> = MyDataset(<span class="hljs-string">'test'</span>)
 Â  Â print(train_dataset<span class="hljs-section">[0]</span>)
 Â  Â print(test_dataset<span class="hljs-section">[0]</span>)
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/82098dd957f74b1fb7e70c6baef17e9f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZSLamF2YTEyMzQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769420595&amp;x-signature=cHoiPcnDFXzYHP1Qv785IEhrvGU%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-4">2ï¼Œå¯¹è®­ç»ƒè¾“å…¥æ–‡æœ¬è¿›è¡Œç¼–ç </h3>
<p>å¯¹ä¼ å…¥çš„æ•°æ®è¿›è¡Œè®­ç»ƒä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ•°æ®è¿›è¡Œç¼–ç ã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡åˆ†è¯å™¨çš„batch_encode_plusæ–¹æ³•è¿›è¡Œæ‰¹é‡ç¼–ç ï¼›</p>
<p>å®ä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">from transformers import BertTokenizer
â€‹
<span class="hljs-comment"># åŠ è½½åˆ†è¯å™¨</span>
<span class="hljs-attr">tokenizer</span> = BertTokenizer.from_pretrained(<span class="hljs-string">'../Bert-base-chinese'</span>)
â€‹
<span class="hljs-comment"># å‡†å¤‡æµ‹è¯•æ–‡æœ¬</span>
<span class="hljs-attr">sents</span> = [<span class="hljs-string">'åºŠå‰æ˜æœˆå…‰ï¼Œç–‘ä¼¼åœ°ä¸Šéœœï¼Œä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡'</span>, <span class="hljs-string">'ä»Šå¤©å¤©æ°”ä¸é”™'</span>, <span class="hljs-string">'å¾ˆå¼€å¿ƒ'</span>]
â€‹
<span class="hljs-comment"># æ‰¹é‡ç¼–ç å¥å­</span>
<span class="hljs-attr">out</span> = tokenizer.batch_encode_plus(
 Â  Â <span class="hljs-attr">batch_text_or_text_pairs</span>=sents, Â <span class="hljs-comment"># è¾“å…¥çš„æ–‡æœ¬</span>
 Â  Â <span class="hljs-attr">add_special_tokens</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># æ·»åŠ ç‰¹æ®Šæ ‡è®°</span>
 Â  Â <span class="hljs-attr">max_length</span>=<span class="hljs-number">10</span>, Â <span class="hljs-comment"># æœ€å¤§é•¿åº¦</span>
 Â  Â <span class="hljs-attr">padding</span>=<span class="hljs-string">'max_length'</span>, Â <span class="hljs-comment"># å¡«å……</span>
 Â  Â <span class="hljs-attr">truncation</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># æˆªæ–­</span>
 Â  Â <span class="hljs-attr">return_tensors</span>=<span class="hljs-string">'pt'</span>, Â <span class="hljs-comment"># è¿”å›pytorchå¼ é‡</span>
 Â  Â <span class="hljs-attr">return_token_type_ids</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># è¿”å›token_type_ids  åŒºåˆ†ä¸åŒå¥å­æˆ–æ®µè½çš„ç±»å‹æ ‡è¯†</span>
 Â  Â <span class="hljs-attr">return_attention_mask</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># è¿”å›attention_mask  æ ‡è®°æœ‰æ•ˆtokenä½ç½®çš„æ©ç </span>
 Â  Â <span class="hljs-attr">return_special_tokens_mask</span>=<span class="hljs-literal">True</span> Â <span class="hljs-comment"># è¿”å›special_tokens_mask æ ‡è¯†ç‰¹æ®Štokenï¼ˆå¦‚[CLS]ã€[SEP]ï¼‰çš„ä½ç½®æ©ç </span>
)
print(out)
for k, v in out.items():
 Â  Â print(k, v)
â€‹
<span class="hljs-comment"># è§£ç æ–‡æœ¬æ•°æ®</span>
for i in range(len(sents)):
 Â  Â print(sents<span class="hljs-section">[i]</span> + "--ç¼–ç åï¼š", tokenizer.decode(out<span class="hljs-section">['input_ids']</span><span class="hljs-section">[i]</span>))
</code></pre>
<p>è¿è¡Œè¾“å‡ºï¼š</p>
<pre><code class="hljs language-lua" lang="lua">{<span class="hljs-string">'input_ids'</span>: tensor(<span class="hljs-string">[[ 101, 2414, 1184, 3209, 3299, 1045, 8024, 4542,  849,  102],
 Â  Â  Â   [ 101,  791, 1921, 1921, 3698,  679, 7231,  102, Â   0, Â   0],
 Â  Â  Â   [ 101, 2523, 2458, 2552,  102, Â   0, Â   0, Â   0, Â   0, Â   0]]</span>), <span class="hljs-string">'token_type_ids'</span>: tensor(<span class="hljs-string">[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 Â  Â  Â   [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 Â  Â  Â   [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]</span>), <span class="hljs-string">'special_tokens_mask'</span>: tensor(<span class="hljs-string">[[1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
 Â  Â  Â   [1, 0, 0, 0, 0, 0, 0, 1, 1, 1],
 Â  Â  Â   [1, 0, 0, 0, 1, 1, 1, 1, 1, 1]]</span>), <span class="hljs-string">'attention_mask'</span>: tensor(<span class="hljs-string">[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
 Â  Â  Â   [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
 Â  Â  Â   [1, 1, 1, 1, 1, 0, 0, 0, 0, 0]]</span>)}
input_ids tensor(<span class="hljs-string">[[ 101, 2414, 1184, 3209, 3299, 1045, 8024, 4542,  849,  102],
 Â  Â  Â   [ 101,  791, 1921, 1921, 3698,  679, 7231,  102, Â   0, Â   0],
 Â  Â  Â   [ 101, 2523, 2458, 2552,  102, Â   0, Â   0, Â   0, Â   0, Â   0]]</span>)
token_type_ids tensor(<span class="hljs-string">[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 Â  Â  Â   [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 Â  Â  Â   [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]</span>)
special_tokens_mask tensor(<span class="hljs-string">[[1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
 Â  Â  Â   [1, 0, 0, 0, 0, 0, 0, 1, 1, 1],
 Â  Â  Â   [1, 0, 0, 0, 1, 1, 1, 1, 1, 1]]</span>)
attention_mask tensor(<span class="hljs-string">[[1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
 Â  Â  Â   [1, 1, 1, 1, 1, 1, 1, 1, 0, 0],
 Â  Â  Â   [1, 1, 1, 1, 1, 0, 0, 0, 0, 0]]</span>)
åºŠå‰æ˜æœˆå…‰ï¼Œç–‘ä¼¼åœ°ä¸Šéœœï¼Œä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡<span class="hljs-comment">--ç¼–ç åï¼š [CLS] åºŠ å‰ æ˜ æœˆ å…‰ ï¼Œ ç–‘ ä¼¼ [SEP]</span>
ä»Šå¤©å¤©æ°”ä¸é”™<span class="hljs-comment">--ç¼–ç åï¼š [CLS] ä»Š å¤© å¤© æ°” ä¸ é”™ [SEP] [PAD] [PAD]</span>
å¾ˆå¼€å¿ƒ<span class="hljs-comment">--ç¼–ç åï¼š [CLS] å¾ˆ å¼€ å¿ƒ [SEP] [PAD] [PAD] [PAD] [PAD] [PAD]</span>
</code></pre>
<h3 data-id="heading-5">3ï¼Œå®šä¹‰å¢é‡æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯ä¸‹æ¸¸ä»»åŠ¡</h3>
<p>æˆ‘ä»¬å®šä¹‰å¢é‡æ¨¡å‹ï¼Œä¸»è¦æ˜¯åœ¨Bertæ¨¡å‹æœ€ååŠ ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œå®ç°äºŒåˆ†ç±»ä»»åŠ¡ã€‚è¿›è¡Œå‰å‘ä¼ æ’­çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨torch.no_grad()å†»ç»“Bertæ¨¡å‹å‚æ•°ï¼Œä¸éœ€è®¡ç®—æ¢¯åº¦ï¼Œè·å–æœ€åä¸€å±‚Bertéšè—å±‚è¾“å‡ºï¼Œè°ƒç”¨è‡ªå®šä¹‰çš„å…¨è¿æ¥å±‚ï¼Œè¿›è¡Œå¢é‡æ¨¡å‹è®­ç»ƒã€‚</p>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># ä½¿ç”¨è®¾å¤‡ï¼ˆGPU/CPUï¼‰</span>
device = torch.device(<span class="hljs-string">"cuda"</span> <span class="hljs-keyword">if</span> torch.cuda.is_available() <span class="hljs-keyword">else</span> <span class="hljs-string">"cpu"</span>)
print(device)
â€‹
<span class="hljs-comment"># åŠ è½½é¢„è®­ç»ƒæ¨¡å‹</span>
pretrained_model = <span class="hljs-title class_">BertModel</span>.from_pretrained(<span class="hljs-string">'./Bert-base-chinese'</span>).to(device)
â€‹
â€‹
<span class="hljs-comment"># å®šä¹‰ä¸‹æ¸¸ä»»åŠ¡ï¼ˆå¢é‡æ¨¡å‹ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DownStreamModel</span>(torch.nn.<span class="hljs-title class_">Module</span>):
â€‹
 Â  Â <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params"><span class="hljs-variable language_">self</span></span>):
 Â  Â  Â  Â <span class="hljs-variable language_">super</span>(<span class="hljs-title class_">DownStreamModel</span>, <span class="hljs-variable language_">self</span>).__init__()
 Â  Â  Â  Â <span class="hljs-comment"># ä¸‹æ¸¸åŠ ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œå®ç°äºŒåˆ†ç±»ä»»åŠ¡</span>
 Â  Â  Â  Â <span class="hljs-variable language_">self</span>.fc = torch.nn.<span class="hljs-title class_">Linear</span>(<span class="hljs-number">768</span>, <span class="hljs-number">2</span>)
â€‹
 Â  Â <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params"><span class="hljs-variable language_">self</span>, input_ids, attention_mask, token_type_ids</span>):
 Â  Â  Â  Â with torch.no_grad(): Â <span class="hljs-comment"># å†»ç»“Bertæ¨¡å‹å‚æ•°ï¼Œä¸éœ€è®¡ç®—æ¢¯åº¦</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-comment"># è·å–æœ€åä¸€å±‚éšè—å±‚è¾“å‡º</span>
 Â  Â  Â  Â  Â  Â output = pretrained_model(input_ids=input_ids, attention_mask=attention_mask, token_type_ids=token_type_ids)
 Â  Â  Â  Â <span class="hljs-comment"># å¢é‡æ¨¡å‹å‚ä¸è®­ç»ƒ</span>
 Â  Â  Â  Â out = <span class="hljs-variable language_">self</span>.fc(output.last_hidden_state[<span class="hljs-symbol">:</span>, <span class="hljs-number">0</span>, <span class="hljs-symbol">:</span>])
 Â  Â  Â  Â <span class="hljs-keyword">return</span> out
</code></pre>
<p><code>output.last_hidden_state[:, 0, :]</code> æ˜¯ç”¨æ¥è·å–æ¨¡å‹è¾“å‡ºçš„éšè—çŠ¶æ€ï¼ˆé€šå¸¸æ˜¯è¿›å…¥æ¨¡å‹çš„æœ€åä¸€å±‚éšè—çŠ¶æ€ï¼‰çš„ä¸€ä¸ªç‰¹å®šåˆ‡ç‰‡ã€‚è®©æˆ‘ä»¬é€ä¸ªå‚æ•°è¿›è¡Œè¯¦ç»†è§£æï¼š</p>
<p><strong>1. <code>output</code></strong></p>
<p><code>output</code> é€šå¸¸æ˜¯é€šè¿‡å¯¹è¾“å…¥æ•°æ®ï¼ˆå¦‚æ–‡æœ¬ã€å›¾åƒç­‰ï¼‰è¿è¡ŒæŸä¸ªæ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ˆä¾‹å¦‚ BERTã€GPTã€Transformers ç­‰ï¼‰åè¿”å›çš„å¯¹è±¡ï¼Œå®ƒåŒ…å«å¤šä¸ªå±æ€§ï¼Œå…¶ä¸­ä¸€ä¸ªé‡è¦çš„å±æ€§æ˜¯ <code>last_hidden_state</code>ã€‚</p>
<p><strong>2. <code>last_hidden_state</code></strong></p>
<p><code>last_hidden_state</code> æ˜¯æ¨¡å‹æœ€åä¸€å±‚çš„éšè—çŠ¶æ€ï¼Œå®ƒçš„å½¢çŠ¶é€šå¸¸æ˜¯ <code>(batch_size, sequence_length, hidden_size)</code>ï¼Œå…·ä½“çš„å«ä¹‰å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>batch_size</strong>ï¼šå¤„ç†çš„æ ·æœ¬æ•°é‡ã€‚åœ¨ä¸€æ¬¡å‰å‘ä¼ æ’­ä¸­ï¼Œæ¨¡å‹å¯ä»¥å¹¶è¡Œå¤„ç†å¤šä¸ªè¾“å…¥æ ·æœ¬ã€‚</li>
<li><strong>sequence_length</strong>ï¼šè¾“å…¥åºåˆ—çš„é•¿åº¦ã€‚å¯¹äºå¤„ç†æ–‡æœ¬æ¥è¯´ï¼Œå®ƒè¡¨ç¤ºè¯æ±‡çš„æ•°é‡ï¼Œå¯ä»¥æ˜¯å¥å­ä¸­è¯çš„ä¸ªæ•°ã€‚</li>
<li><strong>hidden_size</strong>ï¼šæ¯ä¸ªéšè—çŠ¶æ€çš„ç»´åº¦ï¼Œä»£è¡¨æ¨¡å‹çš„è¾“å‡ºç‰¹å¾ç»´æ•°ã€‚é€šå¸¸åœ¨æ¨¡å‹æ¶æ„ä¸­å®šä¹‰ï¼Œä¾‹å¦‚å¯¹äº BERT-base éšè—å¤§å°ä¸º 768ã€‚</li>
</ul>
<p><strong>3. <code>[:, 0, :]</code></strong></p>
<p>è¿™é‡Œçš„åˆ‡ç‰‡æ“ä½œç”¨æ¥è®¿é—® <code>last_hidden_state</code> çš„ä¸€éƒ¨åˆ†ï¼Œå…·ä½“è§£é‡Šå¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>:</strong> ï¼šè¡¨ç¤ºé€‰æ‹©æ‰€æœ‰çš„æ ·æœ¬ã€‚ç”±äº <code>batch_size</code> æ˜¯ç¬¬ä¸€ä¸ªç»´åº¦ï¼Œæ‰€ä»¥æŠŠ <code>:</code> æ”¾åœ¨è¿™ä¸ªä½ç½®è¡¨ç¤ºé€‰å–å½“å‰æ‰¹æ¬¡çš„æ‰€æœ‰æ ·æœ¬ã€‚</li>
<li><strong>0</strong>ï¼šè¡¨ç¤ºé€‰æ‹©ç¬¬ä¸€ä¸ªæ—¶åˆ»çš„éšè—çŠ¶æ€ã€‚åœ¨ NLP ä¸­ï¼Œç‰¹åˆ«æ˜¯åƒ BERT è¿™æ ·çš„æ¨¡å‹ä¸­ï¼Œç¬¬ä¸€ä½ç½®çš„éšè—çŠ¶æ€é€šå¸¸å¯¹åº”äº <code>[CLS]</code> tokenï¼ˆåˆ†ç±» tokenï¼‰ï¼Œå®ƒæ˜¯ç”¨æ¥è¿›è¡Œå¥å­çº§åˆ«çš„ä»»åŠ¡ï¼ˆä¾‹å¦‚åˆ†ç±»ï¼‰çš„ã€‚</li>
<li><strong>:</strong> ï¼šè¡¨ç¤ºé€‰æ‹©æ‰€æœ‰çš„ç‰¹å¾ç»´åº¦ï¼ˆ<code>hidden_size</code>ï¼‰ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬æå–æ¯ä¸ªæ ·æœ¬çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼ˆå³ <code>[CLS]</code> tokenï¼‰å¯¹åº”çš„å…¨éƒ¨éšè—çŠ¶æ€ç‰¹å¾ã€‚</li>
</ul>
<p><strong>ç»¼åˆ</strong></p>
<p>å› æ­¤ï¼Œ<code>output.last_hidden_state[:, 0, :]</code> è¡¨ç¤ºæå–æ‰€æœ‰è¾“å…¥æ ·æœ¬çš„ <code>[CLS]</code> token çš„éšè—çŠ¶æ€å‘é‡ï¼Œè¿™é€šå¸¸ç”¨äºä¸‹æ¸¸ä»»åŠ¡ï¼Œå¦‚æ–‡æœ¬åˆ†ç±»ã€é—®ç­”ã€æƒ…æ„Ÿåˆ†æç­‰ï¼Œå› ä¸º <code>[CLS]</code> token çš„è¡¨ç¤ºé€šå¸¸æ˜¯æ•´æ®µæ–‡æœ¬çš„è¯­ä¹‰èšåˆã€‚</p>
<p><strong>ä¾‹å­</strong></p>
<p>å¦‚æœæœ‰ä¸€ä¸ªè¾“å…¥æ‰¹æ¬¡å¤§å°ä¸º 4ï¼Œå¹¶ä¸”æ¯ä¸ªè¾“å…¥åºåˆ—çš„éšè—çŠ¶æ€å¤§å°ä¸º 768ï¼Œé‚£ä¹ˆ <code>output.last_hidden_state[:, 0, :]</code> çš„è¿”å›ç»“æœå°†æ˜¯ä¸€ä¸ªå½¢çŠ¶ä¸º <code>(4, 768)</code> çš„å¼ é‡ï¼Œå…¶ä¸­æ¯ä¸€è¡Œå¯¹åº”ä¸€ä¸ªè¾“å…¥æ ·æœ¬çš„ <code>[CLS]</code> token çš„éšè—çŠ¶æ€ã€‚</p>
<h3 data-id="heading-6">4ï¼Œè®­ç»ƒæ¨¡å‹</h3>
<p>å‰é¢æˆ‘ä»¬å·²ç»å®šä¹‰å¥½äº†æ•°æ®é›†ï¼Œä»¥åŠæ–‡æœ¬ç¼–ç å¤„ç†ï¼ŒåŒ…æ‹¬å¢é‡æ¨¡å‹å®šä¹‰ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥è¿›è¡Œå¢é‡æ¨¡å‹å¾®è°ƒè®­ç»ƒã€‚</p>
<p>å®ä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">import torch
from datasets import load_dataset
from torch.utils.data import Dataset, DataLoader
from transformers import BertTokenizer, BertModel
â€‹
â€‹
<span class="hljs-comment"># è‡ªå®šä¹‰æ•°æ®é›†</span>
class MyDataset(Dataset):
â€‹
 Â  Â def __init__(self, split):
 Â  Â  Â  Â <span class="hljs-comment"># åŠ è½½è®­ç»ƒé›†</span>
 Â  Â  Â  Â <span class="hljs-attr">train_dataset</span> = load_dataset(path=<span class="hljs-string">"csv"</span>, data_files=<span class="hljs-string">"./weibo_senti_8k_train.csv"</span>)
 Â  Â  Â  Â <span class="hljs-comment"># åŠ è½½æµ‹è¯•é›†</span>
 Â  Â  Â  Â <span class="hljs-attr">test_dataset</span> = load_dataset(path=<span class="hljs-string">"csv"</span>, data_files=<span class="hljs-string">"./weibo_senti_2k_test.csv"</span>)
 Â  Â  Â  Â if <span class="hljs-attr">split</span> == <span class="hljs-string">'train'</span>:
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">self.data</span> = train_dataset[<span class="hljs-string">'train'</span>]
 Â  Â  Â  Â elif <span class="hljs-attr">split</span> == <span class="hljs-string">'test'</span>:
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">self.data</span> = test_dataset[<span class="hljs-string">'train'</span>]
â€‹
 Â  Â <span class="hljs-comment"># è·å–æ•°æ®é›†å¤§å°</span>
 Â  Â def __len__(self):
 Â  Â  Â  Â return len(self.data)
â€‹
 Â  Â <span class="hljs-comment"># è·å–æ•°æ®é›†çš„æŸä¸ªå…ƒç´ </span>
 Â  Â def __getitem__(self, index):
 Â  Â  Â  Â <span class="hljs-attr">sentence</span> = self.data[index][<span class="hljs-string">'sentence'</span>]
 Â  Â  Â  Â <span class="hljs-attr">label</span> = self.data[index][<span class="hljs-string">'label'</span>]
 Â  Â  Â  Â return sentence, label
â€‹
â€‹
<span class="hljs-comment"># åŠ è½½åˆ†è¯å™¨</span>
<span class="hljs-attr">tokenizer</span> = BertTokenizer.from_pretrained(<span class="hljs-string">'./Bert-base-chinese'</span>)
â€‹
<span class="hljs-comment"># ä½¿ç”¨è®¾å¤‡ï¼ˆGPU/CPUï¼‰</span>
<span class="hljs-attr">device</span> = torch.device(<span class="hljs-string">"cuda"</span> if torch.cuda.is_available() else <span class="hljs-string">"cpu"</span>)
print(device)
â€‹
<span class="hljs-comment"># åŠ è½½é¢„è®­ç»ƒæ¨¡å‹</span>
<span class="hljs-attr">pretrained_model</span> = BertModel.from_pretrained(<span class="hljs-string">'./Bert-base-chinese'</span>).to(device)
â€‹
â€‹
<span class="hljs-comment"># å®šä¹‰ä¸‹æ¸¸ä»»åŠ¡ï¼ˆå¢é‡æ¨¡å‹ï¼‰</span>
class DownStreamModel(torch.nn.Module):
â€‹
 Â  Â def __init__(self):
 Â  Â  Â  Â super(DownStreamModel, self).__init__()
 Â  Â  Â  Â <span class="hljs-comment"># ä¸‹æ¸¸åŠ ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œå®ç°äºŒåˆ†ç±»ä»»åŠ¡</span>
 Â  Â  Â  Â <span class="hljs-attr">self.fc</span> = torch.nn.Linear(<span class="hljs-number">768</span>, <span class="hljs-number">2</span>)
â€‹
 Â  Â def forward(self, input_ids, attention_mask, token_type_ids):
 Â  Â  Â  Â with torch.no_grad(): Â <span class="hljs-comment"># å†»ç»“Bertæ¨¡å‹å‚æ•°ï¼Œä¸éœ€è®¡ç®—æ¢¯åº¦</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-comment"># è·å–æœ€åä¸€å±‚éšè—å±‚è¾“å‡º</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">output</span> = pretrained_model(input_ids=input_ids, attention_mask=attention_mask, token_type_ids=token_type_ids)
 Â  Â  Â  Â <span class="hljs-comment"># å¢é‡æ¨¡å‹å‚ä¸è®­ç»ƒ</span>
 Â  Â  Â  Â <span class="hljs-attr">out</span> = self.fc(output.last_hidden_state[:, <span class="hljs-number">0</span>, :])
 Â  Â  Â  Â return out
â€‹
â€‹
<span class="hljs-comment"># å¯¹ä¼ å…¥æ•°æ®è¿›è¡Œç¼–ç </span>
def collate_fn(data):
 Â  Â <span class="hljs-attr">sents</span> = [i[<span class="hljs-number">0</span>] for i in data]
 Â  Â <span class="hljs-attr">labels</span> = [i[<span class="hljs-number">1</span>] for i in data]
 Â  Â <span class="hljs-comment"># ç¼–ç </span>
 Â  Â <span class="hljs-comment"># æ‰¹é‡ç¼–ç å¥å­</span>
 Â  Â <span class="hljs-attr">out</span> = tokenizer.batch_encode_plus(
 Â  Â  Â  Â <span class="hljs-attr">batch_text_or_text_pairs</span>=sents, Â <span class="hljs-comment"># è¾“å…¥çš„æ–‡æœ¬</span>
 Â  Â  Â  Â <span class="hljs-attr">add_special_tokens</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># æ·»åŠ ç‰¹æ®Šæ ‡è®°</span>
 Â  Â  Â  Â <span class="hljs-attr">max_length</span>=<span class="hljs-number">256</span>, Â <span class="hljs-comment"># æœ€å¤§é•¿åº¦</span>
 Â  Â  Â  Â <span class="hljs-attr">padding</span>=<span class="hljs-string">'max_length'</span>, Â <span class="hljs-comment"># å¡«å……</span>
 Â  Â  Â  Â <span class="hljs-attr">truncation</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># æˆªæ–­</span>
 Â  Â  Â  Â <span class="hljs-attr">return_tensors</span>=<span class="hljs-string">'pt'</span>, Â <span class="hljs-comment"># è¿”å›pytorchå¼ é‡</span>
 Â  Â  Â  Â <span class="hljs-attr">return_token_type_ids</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># è¿”å›token_type_ids  åŒºåˆ†ä¸åŒå¥å­æˆ–æ®µè½çš„ç±»å‹æ ‡è¯†</span>
 Â  Â  Â  Â <span class="hljs-attr">return_attention_mask</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># è¿”å›attention_mask  æ ‡è®°æœ‰æ•ˆtokenä½ç½®çš„æ©ç </span>
 Â  Â  Â  Â <span class="hljs-attr">return_special_tokens_mask</span>=<span class="hljs-literal">True</span> Â <span class="hljs-comment"># è¿”å›special_tokens_mask æ ‡è¯†ç‰¹æ®Štokenï¼ˆå¦‚[CLS]ã€[SEP]ï¼‰çš„ä½ç½®æ©ç </span>
 Â   )
 Â  Â return out<span class="hljs-section">['input_ids']</span>, out<span class="hljs-section">['attention_mask']</span>, out<span class="hljs-section">['token_type_ids']</span>, torch.tensor(labels)
â€‹
â€‹
<span class="hljs-comment"># åˆ›å»ºæ•°æ®é›†</span>
<span class="hljs-attr">train_dataset</span> = MyDataset(<span class="hljs-string">'train'</span>) Â <span class="hljs-comment"># è®­ç»ƒé›†</span>
<span class="hljs-attr">train_loader</span> = DataLoader(
 Â  Â <span class="hljs-attr">dataset</span>=train_dataset, Â <span class="hljs-comment"># æ•°æ®é›†</span>
 Â  Â <span class="hljs-attr">batch_size</span>=<span class="hljs-number">200</span>, Â <span class="hljs-comment"># æ‰¹æ¬¡å¤§å°</span>
 Â  Â <span class="hljs-attr">shuffle</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># æ˜¯å¦æ‰“ä¹±æ•°æ®</span>
 Â  Â <span class="hljs-attr">drop_last</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># ä¸¢å¼ƒæœ€åä¸€ä¸ªæ‰¹æ¬¡æ•°æ®</span>
 Â  Â <span class="hljs-attr">collate_fn</span>=collate_fn Â <span class="hljs-comment"># å¯¹åŠ è½½çš„æ•°æ®è¿›è¡Œç¼–ç </span>
)
â€‹
<span class="hljs-attr">test_dataset</span> = MyDataset(<span class="hljs-string">'test'</span>) Â <span class="hljs-comment"># æµ‹è¯•é›†</span>
<span class="hljs-attr">test_loader</span> = DataLoader(
 Â  Â <span class="hljs-attr">dataset</span>=test_dataset, Â <span class="hljs-comment"># æ•°æ®é›†</span>
 Â  Â <span class="hljs-attr">batch_size</span>=<span class="hljs-number">200</span>, Â <span class="hljs-comment"># æ‰¹æ¬¡å¤§å°</span>
 Â  Â <span class="hljs-attr">shuffle</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># æ˜¯å¦æ‰“ä¹±æ•°æ®</span>
 Â  Â <span class="hljs-attr">drop_last</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># ä¸¢å¼ƒæœ€åä¸€ä¸ªæ‰¹æ¬¡æ•°æ®</span>
 Â  Â <span class="hljs-attr">collate_fn</span>=collate_fn Â <span class="hljs-comment"># å¯¹åŠ è½½çš„æ•°æ®è¿›è¡Œç¼–ç </span>
)
â€‹
if <span class="hljs-attr">__name__</span> == <span class="hljs-string">'__main__'</span>:
 Â  Â <span class="hljs-attr">model</span> = DownStreamModel().to(device) Â <span class="hljs-comment"># åˆ›å»ºæ¨¡å‹</span>
 Â  Â <span class="hljs-attr">optimizer</span> = torch.optim.AdamW(model.parameters()) Â <span class="hljs-comment"># ä¼˜åŒ–å™¨</span>
 Â  Â <span class="hljs-attr">criterion</span> = torch.nn.CrossEntropyLoss() Â <span class="hljs-comment"># å®šä¹‰æŸå¤±å‡½æ•°</span>
 Â  Â <span class="hljs-attr">best_val_acc</span> = <span class="hljs-number">0</span> Â <span class="hljs-comment"># ä¿å­˜æœ€å¥½çš„å‡†ç¡®ç‡</span>
 Â  Â <span class="hljs-attr">EPOCH</span> = <span class="hljs-number">3</span> Â <span class="hljs-comment"># è®­ç»ƒè½®æ•°</span>
 Â  Â for epoch in range(EPOCH): Â <span class="hljs-comment"># è®­ç»ƒè½®æ•°</span>
 Â  Â  Â  Â for i, (input_ids, attention_mask, token_type_ids, labels) in enumerate(train_loader): Â <span class="hljs-comment"># æ‰¹æ¬¡æ•°æ®</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">out</span> = model(input_ids=input_ids.to(device), attention_mask=attention_mask.to(device),
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">token_type_ids</span>=token_type_ids.to(device)) Â <span class="hljs-comment"># æ¨¡å‹è¾“å‡º</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">loss</span> = criterion(out, labels.to(device)) Â <span class="hljs-comment"># è®¡ç®—æŸå¤±</span>
 Â  Â  Â  Â  Â  Â optimizer.zero_grad() Â <span class="hljs-comment"># æ¸…ç©ºæ¢¯åº¦</span>
 Â  Â  Â  Â  Â  Â loss.backward() Â <span class="hljs-comment"># åå‘ä¼ æ’­</span>
 Â  Â  Â  Â  Â  Â optimizer.step() Â <span class="hljs-comment"># ä¼˜åŒ–å™¨æ›´æ–°å‚æ•°</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-comment"># æ¯éš”5ä¸ªæ‰¹æ¬¡è¾“å‡ºè®­ç»ƒç»“æœ</span>
 Â  Â  Â  Â  Â  Â if i % <span class="hljs-attr">5</span> == <span class="hljs-number">0</span>:
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">out</span> = out.argmax(dim=<span class="hljs-number">1</span>) Â <span class="hljs-comment"># è·å–é¢„æµ‹ç»“æœ</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">acc</span> = (out == labels.to(device)).sum().item() / len(labels) Â <span class="hljs-comment"># è®¡ç®—å‡†ç¡®ç‡</span>
 Â  Â  Â  Â  Â  Â  Â  Â print("EPOCH:{}--ç¬¬{}æ‰¹æ¬¡--æŸå¤±:{}--å‡†ç¡®ç‡:{}".format(epoch + 1, i + 1, loss.item(), acc))
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<pre><code class="hljs language-lua" lang="lua">cuda
EPOCH:<span class="hljs-number">1</span><span class="hljs-comment">--ç¬¬1æ‰¹æ¬¡--æŸå¤±:0.5008983016014099--å‡†ç¡®ç‡:0.78</span>
EPOCH:<span class="hljs-number">1</span><span class="hljs-comment">--ç¬¬6æ‰¹æ¬¡--æŸå¤±:0.5052810907363892--å‡†ç¡®ç‡:0.75</span>
EPOCH:<span class="hljs-number">1</span><span class="hljs-comment">--ç¬¬11æ‰¹æ¬¡--æŸå¤±:0.4850313067436218--å‡†ç¡®ç‡:0.755</span>
EPOCH:<span class="hljs-number">1</span><span class="hljs-comment">--ç¬¬16æ‰¹æ¬¡--æŸå¤±:0.4301462471485138--å‡†ç¡®ç‡:0.83</span>
EPOCH:<span class="hljs-number">1</span><span class="hljs-comment">--ç¬¬21æ‰¹æ¬¡--æŸå¤±:0.39388778805732727--å‡†ç¡®ç‡:0.85</span>
EPOCH:<span class="hljs-number">1</span><span class="hljs-comment">--ç¬¬26æ‰¹æ¬¡--æŸå¤±:0.3695535361766815--å‡†ç¡®ç‡:0.855</span>
EPOCH:<span class="hljs-number">1</span><span class="hljs-comment">--ç¬¬31æ‰¹æ¬¡--æŸå¤±:0.35825812816619873--å‡†ç¡®ç‡:0.855</span>
EPOCH:<span class="hljs-number">1</span><span class="hljs-comment">--ç¬¬36æ‰¹æ¬¡--æŸå¤±:0.3288692533969879--å‡†ç¡®ç‡:0.875</span>
EPOCH:<span class="hljs-number">2</span><span class="hljs-comment">--ç¬¬1æ‰¹æ¬¡--æŸå¤±:0.31738394498825073--å‡†ç¡®ç‡:0.885</span>
EPOCH:<span class="hljs-number">2</span><span class="hljs-comment">--ç¬¬6æ‰¹æ¬¡--æŸå¤±:0.3121739625930786--å‡†ç¡®ç‡:0.87</span>
EPOCH:<span class="hljs-number">2</span><span class="hljs-comment">--ç¬¬11æ‰¹æ¬¡--æŸå¤±:0.30510687828063965--å‡†ç¡®ç‡:0.895</span>
EPOCH:<span class="hljs-number">2</span><span class="hljs-comment">--ç¬¬16æ‰¹æ¬¡--æŸå¤±:0.305753618478775--å‡†ç¡®ç‡:0.865</span>
EPOCH:<span class="hljs-number">2</span><span class="hljs-comment">--ç¬¬21æ‰¹æ¬¡--æŸå¤±:0.24456100165843964--å‡†ç¡®ç‡:0.92</span>
EPOCH:<span class="hljs-number">2</span><span class="hljs-comment">--ç¬¬26æ‰¹æ¬¡--æŸå¤±:0.2233615517616272--å‡†ç¡®ç‡:0.93</span>
EPOCH:<span class="hljs-number">2</span><span class="hljs-comment">--ç¬¬31æ‰¹æ¬¡--æŸå¤±:0.2816208302974701--å‡†ç¡®ç‡:0.89</span>
EPOCH:<span class="hljs-number">2</span><span class="hljs-comment">--ç¬¬36æ‰¹æ¬¡--æŸå¤±:0.24931633472442627--å‡†ç¡®ç‡:0.915</span>
EPOCH:<span class="hljs-number">3</span><span class="hljs-comment">--ç¬¬1æ‰¹æ¬¡--æŸå¤±:0.3053100109100342--å‡†ç¡®ç‡:0.885</span>
EPOCH:<span class="hljs-number">3</span><span class="hljs-comment">--ç¬¬6æ‰¹æ¬¡--æŸå¤±:0.2515011727809906--å‡†ç¡®ç‡:0.9</span>
EPOCH:<span class="hljs-number">3</span><span class="hljs-comment">--ç¬¬11æ‰¹æ¬¡--æŸå¤±:0.24241474270820618--å‡†ç¡®ç‡:0.915</span>
EPOCH:<span class="hljs-number">3</span><span class="hljs-comment">--ç¬¬16æ‰¹æ¬¡--æŸå¤±:0.2211739420890808--å‡†ç¡®ç‡:0.925</span>
EPOCH:<span class="hljs-number">3</span><span class="hljs-comment">--ç¬¬21æ‰¹æ¬¡--æŸå¤±:0.24276195466518402--å‡†ç¡®ç‡:0.91</span>
EPOCH:<span class="hljs-number">3</span><span class="hljs-comment">--ç¬¬26æ‰¹æ¬¡--æŸå¤±:0.27010777592658997--å‡†ç¡®ç‡:0.895</span>
EPOCH:<span class="hljs-number">3</span><span class="hljs-comment">--ç¬¬31æ‰¹æ¬¡--æŸå¤±:0.24304606020450592--å‡†ç¡®ç‡:0.9</span>
EPOCH:<span class="hljs-number">3</span><span class="hljs-comment">--ç¬¬36æ‰¹æ¬¡--æŸå¤±:0.26476508378982544--å‡†ç¡®ç‡:0.905</span>
</code></pre>
<h3 data-id="heading-7">5ï¼Œè¯„ä¼°æ¨¡å‹</h3>
<p>æ¨¡å‹è®­ç»ƒå¥½ä¹‹åï¼Œæˆ‘ä»¬è¦å¯¹æ¨¡å‹è¿›è¡Œæ€§èƒ½è¯„ä¼°ï¼Œä»¥åŠä¿å­˜æœ€ä¼˜æ¨¡å‹å‚æ•°ã€‚</p>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">import torch
from datasets import load_dataset
from torch.utils.data import Dataset, DataLoader
from transformers import BertTokenizer, BertModel
â€‹
â€‹
<span class="hljs-comment"># è‡ªå®šä¹‰æ•°æ®é›†</span>
class MyDataset(Dataset):
â€‹
 Â  Â def __init__(self, split):
 Â  Â  Â  Â <span class="hljs-comment"># åŠ è½½è®­ç»ƒé›†</span>
 Â  Â  Â  Â <span class="hljs-attr">train_dataset</span> = load_dataset(path=<span class="hljs-string">"csv"</span>, data_files=<span class="hljs-string">"./weibo_senti_8k_train.csv"</span>)
 Â  Â  Â  Â <span class="hljs-comment"># åŠ è½½æµ‹è¯•é›†</span>
 Â  Â  Â  Â <span class="hljs-attr">test_dataset</span> = load_dataset(path=<span class="hljs-string">"csv"</span>, data_files=<span class="hljs-string">"./weibo_senti_2k_test.csv"</span>)
 Â  Â  Â  Â if <span class="hljs-attr">split</span> == <span class="hljs-string">'train'</span>:
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">self.data</span> = train_dataset[<span class="hljs-string">'train'</span>]
 Â  Â  Â  Â elif <span class="hljs-attr">split</span> == <span class="hljs-string">'test'</span>:
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">self.data</span> = test_dataset[<span class="hljs-string">'train'</span>]
â€‹
 Â  Â <span class="hljs-comment"># è·å–æ•°æ®é›†å¤§å°</span>
 Â  Â def __len__(self):
 Â  Â  Â  Â return len(self.data)
â€‹
 Â  Â <span class="hljs-comment"># è·å–æ•°æ®é›†çš„æŸä¸ªå…ƒç´ </span>
 Â  Â def __getitem__(self, index):
 Â  Â  Â  Â <span class="hljs-attr">sentence</span> = self.data[index][<span class="hljs-string">'sentence'</span>]
 Â  Â  Â  Â <span class="hljs-attr">label</span> = self.data[index][<span class="hljs-string">'label'</span>]
 Â  Â  Â  Â return sentence, label
â€‹
â€‹
<span class="hljs-comment"># åŠ è½½åˆ†è¯å™¨</span>
<span class="hljs-attr">tokenizer</span> = BertTokenizer.from_pretrained(<span class="hljs-string">'./Bert-base-chinese'</span>)
â€‹
<span class="hljs-comment"># ä½¿ç”¨è®¾å¤‡ï¼ˆGPU/CPUï¼‰</span>
<span class="hljs-attr">device</span> = torch.device(<span class="hljs-string">"cuda"</span> if torch.cuda.is_available() else <span class="hljs-string">"cpu"</span>)
print(device)
â€‹
<span class="hljs-comment"># åŠ è½½é¢„è®­ç»ƒæ¨¡å‹</span>
<span class="hljs-attr">pretrained_model</span> = BertModel.from_pretrained(<span class="hljs-string">'./Bert-base-chinese'</span>).to(device)
â€‹
â€‹
<span class="hljs-comment"># å®šä¹‰ä¸‹æ¸¸ä»»åŠ¡ï¼ˆå¢é‡æ¨¡å‹ï¼‰</span>
class DownStreamModel(torch.nn.Module):
â€‹
 Â  Â def __init__(self):
 Â  Â  Â  Â super(DownStreamModel, self).__init__()
 Â  Â  Â  Â <span class="hljs-comment"># ä¸‹æ¸¸åŠ ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œå®ç°äºŒåˆ†ç±»ä»»åŠ¡</span>
 Â  Â  Â  Â <span class="hljs-attr">self.fc</span> = torch.nn.Linear(<span class="hljs-number">768</span>, <span class="hljs-number">2</span>)
â€‹
 Â  Â def forward(self, input_ids, attention_mask, token_type_ids):
 Â  Â  Â  Â with torch.no_grad(): Â <span class="hljs-comment"># å†»ç»“Bertæ¨¡å‹å‚æ•°ï¼Œä¸éœ€è®¡ç®—æ¢¯åº¦</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-comment"># è·å–æœ€åä¸€å±‚éšè—å±‚è¾“å‡º</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">output</span> = pretrained_model(input_ids=input_ids, attention_mask=attention_mask, token_type_ids=token_type_ids)
 Â  Â  Â  Â <span class="hljs-comment"># å¢é‡æ¨¡å‹å‚ä¸è®­ç»ƒ</span>
 Â  Â  Â  Â <span class="hljs-attr">out</span> = self.fc(output.last_hidden_state[:, <span class="hljs-number">0</span>, :])
 Â  Â  Â  Â return out
â€‹
â€‹
<span class="hljs-comment"># å¯¹ä¼ å…¥æ•°æ®è¿›è¡Œç¼–ç </span>
def collate_fn(data):
 Â  Â <span class="hljs-attr">sents</span> = [i[<span class="hljs-number">0</span>] for i in data]
 Â  Â <span class="hljs-attr">labels</span> = [i[<span class="hljs-number">1</span>] for i in data]
 Â  Â <span class="hljs-comment"># ç¼–ç </span>
 Â  Â <span class="hljs-comment"># æ‰¹é‡ç¼–ç å¥å­</span>
 Â  Â <span class="hljs-attr">out</span> = tokenizer.batch_encode_plus(
 Â  Â  Â  Â <span class="hljs-attr">batch_text_or_text_pairs</span>=sents, Â <span class="hljs-comment"># è¾“å…¥çš„æ–‡æœ¬</span>
 Â  Â  Â  Â <span class="hljs-attr">add_special_tokens</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># æ·»åŠ ç‰¹æ®Šæ ‡è®°</span>
 Â  Â  Â  Â <span class="hljs-attr">max_length</span>=<span class="hljs-number">256</span>, Â <span class="hljs-comment"># æœ€å¤§é•¿åº¦</span>
 Â  Â  Â  Â <span class="hljs-attr">padding</span>=<span class="hljs-string">'max_length'</span>, Â <span class="hljs-comment"># å¡«å……</span>
 Â  Â  Â  Â <span class="hljs-attr">truncation</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># æˆªæ–­</span>
 Â  Â  Â  Â <span class="hljs-attr">return_tensors</span>=<span class="hljs-string">'pt'</span>, Â <span class="hljs-comment"># è¿”å›pytorchå¼ é‡</span>
 Â  Â  Â  Â <span class="hljs-attr">return_token_type_ids</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># è¿”å›token_type_ids  åŒºåˆ†ä¸åŒå¥å­æˆ–æ®µè½çš„ç±»å‹æ ‡è¯†</span>
 Â  Â  Â  Â <span class="hljs-attr">return_attention_mask</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># è¿”å›attention_mask  æ ‡è®°æœ‰æ•ˆtokenä½ç½®çš„æ©ç </span>
 Â  Â  Â  Â <span class="hljs-attr">return_special_tokens_mask</span>=<span class="hljs-literal">True</span> Â <span class="hljs-comment"># è¿”å›special_tokens_mask æ ‡è¯†ç‰¹æ®Štokenï¼ˆå¦‚[CLS]ã€[SEP]ï¼‰çš„ä½ç½®æ©ç </span>
 Â   )
 Â  Â return out<span class="hljs-section">['input_ids']</span>, out<span class="hljs-section">['attention_mask']</span>, out<span class="hljs-section">['token_type_ids']</span>, torch.tensor(labels)
â€‹
â€‹
<span class="hljs-comment"># åˆ›å»ºæ•°æ®é›†</span>
<span class="hljs-attr">train_dataset</span> = MyDataset(<span class="hljs-string">'train'</span>) Â <span class="hljs-comment"># è®­ç»ƒé›†</span>
<span class="hljs-attr">train_loader</span> = DataLoader(
 Â  Â <span class="hljs-attr">dataset</span>=train_dataset, Â <span class="hljs-comment"># æ•°æ®é›†</span>
 Â  Â <span class="hljs-attr">batch_size</span>=<span class="hljs-number">200</span>, Â <span class="hljs-comment"># æ‰¹æ¬¡å¤§å°</span>
 Â  Â <span class="hljs-attr">shuffle</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># æ˜¯å¦æ‰“ä¹±æ•°æ®</span>
 Â  Â <span class="hljs-attr">drop_last</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># ä¸¢å¼ƒæœ€åä¸€ä¸ªæ‰¹æ¬¡æ•°æ®</span>
 Â  Â <span class="hljs-attr">collate_fn</span>=collate_fn Â <span class="hljs-comment"># å¯¹åŠ è½½çš„æ•°æ®è¿›è¡Œç¼–ç </span>
)
â€‹
<span class="hljs-attr">test_dataset</span> = MyDataset(<span class="hljs-string">'test'</span>) Â <span class="hljs-comment"># æµ‹è¯•é›†</span>
<span class="hljs-attr">test_loader</span> = DataLoader(
 Â  Â <span class="hljs-attr">dataset</span>=test_dataset, Â <span class="hljs-comment"># æ•°æ®é›†</span>
 Â  Â <span class="hljs-attr">batch_size</span>=<span class="hljs-number">200</span>, Â <span class="hljs-comment"># æ‰¹æ¬¡å¤§å°</span>
 Â  Â <span class="hljs-attr">shuffle</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># æ˜¯å¦æ‰“ä¹±æ•°æ®</span>
 Â  Â <span class="hljs-attr">drop_last</span>=<span class="hljs-literal">True</span>, Â <span class="hljs-comment"># ä¸¢å¼ƒæœ€åä¸€ä¸ªæ‰¹æ¬¡æ•°æ®</span>
 Â  Â <span class="hljs-attr">collate_fn</span>=collate_fn Â <span class="hljs-comment"># å¯¹åŠ è½½çš„æ•°æ®è¿›è¡Œç¼–ç </span>
)
â€‹
if <span class="hljs-attr">__name__</span> == <span class="hljs-string">'__main__'</span>:
 Â  Â <span class="hljs-attr">model</span> = DownStreamModel().to(device) Â <span class="hljs-comment"># åˆ›å»ºæ¨¡å‹</span>
 Â  Â <span class="hljs-attr">optimizer</span> = torch.optim.AdamW(model.parameters()) Â <span class="hljs-comment"># ä¼˜åŒ–å™¨</span>
 Â  Â <span class="hljs-attr">criterion</span> = torch.nn.CrossEntropyLoss() Â <span class="hljs-comment"># å®šä¹‰æŸå¤±å‡½æ•°</span>
 Â  Â <span class="hljs-attr">best_val_acc</span> = <span class="hljs-number">0</span> Â <span class="hljs-comment"># ä¿å­˜æœ€å¥½çš„å‡†ç¡®ç‡</span>
 Â  Â <span class="hljs-attr">EPOCH</span> = <span class="hljs-number">3</span> Â <span class="hljs-comment"># è®­ç»ƒè½®æ•°</span>
 Â  Â for epoch in range(EPOCH): Â <span class="hljs-comment"># è®­ç»ƒè½®æ•°</span>
 Â  Â  Â  Â for i, (input_ids, attention_mask, token_type_ids, labels) in enumerate(train_loader): Â <span class="hljs-comment"># æ‰¹æ¬¡æ•°æ®</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">out</span> = model(input_ids=input_ids.to(device), attention_mask=attention_mask.to(device),
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">token_type_ids</span>=token_type_ids.to(device)) Â <span class="hljs-comment"># æ¨¡å‹è¾“å‡º</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">loss</span> = criterion(out, labels.to(device)) Â <span class="hljs-comment"># è®¡ç®—æŸå¤±</span>
 Â  Â  Â  Â  Â  Â optimizer.zero_grad() Â <span class="hljs-comment"># æ¸…ç©ºæ¢¯åº¦</span>
 Â  Â  Â  Â  Â  Â loss.backward() Â <span class="hljs-comment"># åå‘ä¼ æ’­</span>
 Â  Â  Â  Â  Â  Â optimizer.step() Â <span class="hljs-comment"># ä¼˜åŒ–å™¨æ›´æ–°å‚æ•°</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-comment"># æ¯éš”5ä¸ªæ‰¹æ¬¡è¾“å‡ºè®­ç»ƒç»“æœ</span>
 Â  Â  Â  Â  Â  Â if i % <span class="hljs-attr">5</span> == <span class="hljs-number">0</span>:
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">out</span> = out.argmax(dim=<span class="hljs-number">1</span>) Â <span class="hljs-comment"># è·å–é¢„æµ‹ç»“æœ</span>
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">acc</span> = (out == labels.to(device)).sum().item() / len(labels) Â <span class="hljs-comment"># è®¡ç®—å‡†ç¡®ç‡</span>
 Â  Â  Â  Â  Â  Â  Â  Â print("EPOCH:{}--ç¬¬{}æ‰¹æ¬¡--æŸå¤±:{}--å‡†ç¡®ç‡:{}".format(epoch + 1, i + 1, loss.item(), acc))
 Â  Â <span class="hljs-comment"># éªŒè¯æ¨¡å‹</span>
 Â  Â model.eval() Â <span class="hljs-comment"># è¯„ä¼°æ¨¡å¼ Dropoutå…³é—­</span>
 Â  Â with torch.no_grad(): Â <span class="hljs-comment"># è¯„ä¼°æ¨¡å¼ï¼Œä¸éœ€è¦è®¡ç®—æ¢¯åº¦</span>
 Â  Â  Â  Â for i, (input_ids, attention_mask, token_type_ids, labels) in enumerate(test_loader):
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">out</span> = model(input_ids=input_ids.to(device), attention_mask=attention_mask.to(device),
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">token_type_ids</span>=token_type_ids.to(device))
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">out</span> = out.argmax(dim=<span class="hljs-number">1</span>)
 Â  Â  Â  Â  Â  Â <span class="hljs-attr">acc</span> = (out == labels.to(device)).sum().item() / len(labels)
 Â  Â  Â  Â  Â  Â if acc &gt; best_val_acc:
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">best_val_acc</span> = acc
 Â  Â  Â  Â  Â  Â  Â  Â torch.save(model.state_dict(), "best_model.pth")
 Â  Â  Â  Â  Â  Â  Â  Â print(f"æµ‹è¯•é›†å‡†ç¡®ç‡EPOCHï¼š{epoch}-ç¬¬{i}æ‰¹æ¬¡:æ¨¡å‹ä¿å­˜ï¼Œå‡†ç¡®ç‡:{acc}")
 Â  Â  Â  Â <span class="hljs-comment"># ä¿å­˜æœ€åä¸€è½®æ¨¡å‹</span>
 Â  Â  Â  Â torch.save(model.state_dict(), "last_model.pth")
 Â  Â  Â  Â print(f"æœ€åä¸€è½®æ¨¡å‹ä¿å­˜ï¼Œ:å‡†ç¡®ç‡:{acc}")
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile">cuda
<span class="hljs-section">EPOCH:1--ç¬¬1æ‰¹æ¬¡--æŸå¤±:0.6369971632957458--å‡†ç¡®ç‡:0.695</span>
<span class="hljs-section">EPOCH:1--ç¬¬6æ‰¹æ¬¡--æŸå¤±:0.6052521467208862--å‡†ç¡®ç‡:0.685</span>
<span class="hljs-section">EPOCH:1--ç¬¬11æ‰¹æ¬¡--æŸå¤±:0.5286625623703003--å‡†ç¡®ç‡:0.77</span>
<span class="hljs-section">EPOCH:1--ç¬¬16æ‰¹æ¬¡--æŸå¤±:0.4174182415008545--å‡†ç¡®ç‡:0.83</span>
<span class="hljs-section">EPOCH:1--ç¬¬21æ‰¹æ¬¡--æŸå¤±:0.41344115138053894--å‡†ç¡®ç‡:0.81</span>
<span class="hljs-section">EPOCH:1--ç¬¬26æ‰¹æ¬¡--æŸå¤±:0.3910037875175476--å‡†ç¡®ç‡:0.87</span>
<span class="hljs-section">EPOCH:1--ç¬¬31æ‰¹æ¬¡--æŸå¤±:0.3680213987827301--å‡†ç¡®ç‡:0.85</span>
<span class="hljs-section">EPOCH:1--ç¬¬36æ‰¹æ¬¡--æŸå¤±:0.3817676901817322--å‡†ç¡®ç‡:0.855</span>
<span class="hljs-section">EPOCH:2--ç¬¬1æ‰¹æ¬¡--æŸå¤±:0.3963841199874878--å‡†ç¡®ç‡:0.84</span>
<span class="hljs-section">EPOCH:2--ç¬¬6æ‰¹æ¬¡--æŸå¤±:0.3516421914100647--å‡†ç¡®ç‡:0.85</span>
<span class="hljs-section">EPOCH:2--ç¬¬11æ‰¹æ¬¡--æŸå¤±:0.330654114484787--å‡†ç¡®ç‡:0.845</span>
<span class="hljs-section">EPOCH:2--ç¬¬16æ‰¹æ¬¡--æŸå¤±:0.3345922529697418--å‡†ç¡®ç‡:0.865</span>
<span class="hljs-section">EPOCH:2--ç¬¬21æ‰¹æ¬¡--æŸå¤±:0.3087370693683624--å‡†ç¡®ç‡:0.885</span>
<span class="hljs-section">EPOCH:2--ç¬¬26æ‰¹æ¬¡--æŸå¤±:0.25769323110580444--å‡†ç¡®ç‡:0.92</span>
<span class="hljs-section">EPOCH:2--ç¬¬31æ‰¹æ¬¡--æŸå¤±:0.2792946696281433--å‡†ç¡®ç‡:0.885</span>
<span class="hljs-section">EPOCH:2--ç¬¬36æ‰¹æ¬¡--æŸå¤±:0.29899129271507263--å‡†ç¡®ç‡:0.905</span>
<span class="hljs-section">EPOCH:3--ç¬¬1æ‰¹æ¬¡--æŸå¤±:0.3139827847480774--å‡†ç¡®ç‡:0.855</span>
<span class="hljs-section">EPOCH:3--ç¬¬6æ‰¹æ¬¡--æŸå¤±:0.27809959650039673--å‡†ç¡®ç‡:0.895</span>
<span class="hljs-section">EPOCH:3--ç¬¬11æ‰¹æ¬¡--æŸå¤±:0.2725857198238373--å‡†ç¡®ç‡:0.885</span>
<span class="hljs-section">EPOCH:3--ç¬¬16æ‰¹æ¬¡--æŸå¤±:0.30161210894584656--å‡†ç¡®ç‡:0.885</span>
<span class="hljs-section">EPOCH:3--ç¬¬21æ‰¹æ¬¡--æŸå¤±:0.26055067777633667--å‡†ç¡®ç‡:0.925</span>
<span class="hljs-section">EPOCH:3--ç¬¬26æ‰¹æ¬¡--æŸå¤±:0.22951321303844452--å‡†ç¡®ç‡:0.895</span>
<span class="hljs-section">EPOCH:3--ç¬¬31æ‰¹æ¬¡--æŸå¤±:0.2995443642139435--å‡†ç¡®ç‡:0.87</span>
<span class="hljs-section">EPOCH:3--ç¬¬36æ‰¹æ¬¡--æŸå¤±:0.3246515691280365--å‡†ç¡®ç‡:0.87</span>
<span class="hljs-section">æµ‹è¯•é›†å‡†ç¡®ç‡EPOCHï¼š2-ç¬¬0æ‰¹æ¬¡:æ¨¡å‹ä¿å­˜ï¼Œå‡†ç¡®ç‡:0.975</span>
<span class="hljs-section">æœ€åä¸€è½®æ¨¡å‹ä¿å­˜ï¼Œ:å‡†ç¡®ç‡:0.955</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰“ç ´å †ç§¯å›°å±€ï¼šä¼˜åŒ–å †ç§¯æ¡å½¢å›¾çš„å¯¹æ¯”æ•ˆæœ]]></title>    <link>https://juejin.cn/post/7595974133097807906</link>    <guid>https://juejin.cn/post/7595974133097807906</guid>    <pubDate>2026-01-18T07:22:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595974133097807906" data-draft-id="7595896809652748328" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰“ç ´å †ç§¯å›°å±€ï¼šä¼˜åŒ–å †ç§¯æ¡å½¢å›¾çš„å¯¹æ¯”æ•ˆæœ"/> <meta itemprop="keywords" content="Python,æ•°æ®å¯è§†åŒ–,æ•°æ®åˆ†æ"/> <meta itemprop="datePublished" content="2026-01-18T07:22:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="databook"/> <meta itemprop="url" content="https://juejin.cn/user/3526889035006702"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰“ç ´å †ç§¯å›°å±€ï¼šä¼˜åŒ–å †ç§¯æ¡å½¢å›¾çš„å¯¹æ¯”æ•ˆæœ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3526889035006702/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    databook
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-18T07:22:16.000Z" title="Sun Jan 18 2026 07:22:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-18
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ•°æ®å¯è§†åŒ–ä¸­ï¼Œ<strong>å †ç§¯æ¡å½¢å›¾</strong> æ“…é•¿å±•ç¤º <strong>â€œæ•´ä½“ä¸æ„æˆâ€</strong> çš„å…³ç³»ï¼Œä½†å½“æ¯ä¸ªæŸ±å­å†…çš„åˆ†æ®µè¶…è¿‡4ä¸ªæ—¶ï¼Œè¯»è€…å¾ˆéš¾åŒæ—¶è¿½è¸ªå„æ®µçš„é•¿åº¦ã€ä½ç½®ä¸é¢œè‰²æ˜ å°„ï¼Œ <strong>è¯¯è¯»æ¦‚ç‡æ˜¾è‘—ä¸Šå‡</strong>ã€‚</p>
<p>æ›´ç³Ÿçš„æ˜¯ï¼Œè‹¥ä¸åŒç±»åˆ«çš„æ€»é‡å·®å¼‚å¾ˆå¤§ï¼Œå †ç§¯ç»“æ„ä¼šæ”¾å¤§è§†è§‰é”™è§‰ï¼Œå¯¼è‡´â€œçœ‹èµ·æ¥å·®ä¸å¤šâ€çš„ç»“è®ºå¤±çœŸã€‚</p>
<p>ä»Šå¤©ï¼Œæœ¬æ–‡å°†å°è¯•æ¢ç´¢ä¸€ä¸‹æ”¹è¿›å †ç§¯æ¡å½¢å›¾çš„å‘ˆç°æ–¹å¼ï¼Œè®©å¤æ‚æ•°æ®å¯¹æ¯”å˜å¾—ä¸€ç›®äº†ç„¶ã€‚</p>
<p>å¦‚æœå¤§å®¶æœ‰æ›´å¥½çš„æ–¹å¼ï¼Œä¹Ÿæ¬¢è¿æŒ‡æ•™ï¼Œäº¤æµã€‚<strong>å®Œæ•´çš„ä»£ç </strong>ä¼šåœ¨æ–‡æœ«æä¾›å…±äº«çš„åœ°å€ã€‚</p>
<h2 data-id="heading-0">1. å †ç§¯æ¡å½¢å›¾çš„å›°å¢ƒ</h2>
<p><strong>å †ç§¯æ¡å½¢å›¾</strong>å°±åƒä¸€é“ç²¾å¿ƒæ‘†ç›˜çš„å¤šå±‚è›‹ç³•ï¼Œå½“å±‚æ•°ä¸å¤šæ—¶ï¼Œæˆ‘ä»¬èƒ½è½»æ¾åˆ†è¾¨æ¯å±‚çš„é«˜åº¦å·®å¼‚ã€‚</p>
<p>ä½†å½“è›‹ç³•å±‚æ•°è¶…è¿‡4å±‚ï¼Œè¦æ¯”è¾ƒæŸä¸€ç‰¹å®šå£å‘³åœ¨å¤šä¸ªè›‹ç³•ä¸­çš„å«é‡å°±å˜å¾—å¼‚å¸¸å›°éš¾ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬ç”¨<code>Python</code>æ¨¡æ‹Ÿä¸€ä¸ªå¸¸è§çš„å †ç§¯æ¡å½¢å›¾åœºæ™¯ï¼šè°ƒæŸ¥æŸäº§å“5ä¸ªåŠŸèƒ½æ¨¡å—çš„ç”¨æˆ·æ»¡æ„åº¦ï¼ˆ5ä¸ªç»´åº¦ï¼‰ï¼Œå…±æ”¶é›†äº†4ä¸ªå­£åº¦çš„æ•°æ®ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ¨¡æ‹Ÿæ•°æ®ï¼š4ä¸ªå­£åº¦ï¼Œ5ä¸ªæ»¡æ„åº¦ç»´åº¦ï¼ˆå¼ºçƒˆåå¯¹ã€åå¯¹ã€ä¸­ç«‹ã€åŒæ„ã€åšå†³åŒæ„ï¼‰</span>
quarters = [<span class="hljs-string">"ç¬¬ä¸€å­£åº¦"</span>, <span class="hljs-string">"ç¬¬äºŒå­£åº¦"</span>, <span class="hljs-string">"ç¬¬ä¸‰å­£åº¦"</span>, <span class="hljs-string">"ç¬¬å››å­£åº¦"</span>]
categories = [<span class="hljs-string">"å¼ºçƒˆåå¯¹"</span>, <span class="hljs-string">"åå¯¹"</span>, <span class="hljs-string">"ä¸­ç«‹"</span>, <span class="hljs-string">"åŒæ„"</span>, <span class="hljs-string">"åšå†³åŒæ„"</span>]
colors = [<span class="hljs-string">"#FF6B6B"</span>, <span class="hljs-string">"#FF9F6B"</span>, <span class="hljs-string">"#D6CBCB"</span>, <span class="hljs-string">"#6BCF7F"</span>, <span class="hljs-string">"#4D96FF"</span>]

<span class="hljs-comment"># æ¯ä¸ªå­£åº¦çš„æ»¡æ„åº¦åˆ†å¸ƒï¼ˆç™¾åˆ†æ¯”ï¼‰</span>
data = np.array(
    [
        [<span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>, <span class="hljs-number">40</span>, <span class="hljs-number">20</span>],  <span class="hljs-comment"># ç¬¬ä¸€å­£åº¦</span>
        [<span class="hljs-number">3</span>, <span class="hljs-number">8</span>, <span class="hljs-number">20</span>, <span class="hljs-number">45</span>, <span class="hljs-number">24</span>],  <span class="hljs-comment"># ç¬¬äºŒå­£åº¦</span>
        [<span class="hljs-number">4</span>, <span class="hljs-number">12</span>, <span class="hljs-number">18</span>, <span class="hljs-number">43</span>, <span class="hljs-number">23</span>],  <span class="hljs-comment"># ç¬¬ä¸‰å­£åº¦</span>
        [<span class="hljs-number">2</span>, <span class="hljs-number">6</span>, <span class="hljs-number">15</span>, <span class="hljs-number">50</span>, <span class="hljs-number">27</span>],  <span class="hljs-comment"># ç¬¬å››å­£åº¦</span>
    ]
)

<span class="hljs-comment"># ä¼ ç»Ÿæ¨ªå‘å †ç§¯æ¡å½¢å›¾</span>
fig, ax = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">14</span>, <span class="hljs-number">4</span>), gridspec_kw={<span class="hljs-string">"width_ratios"</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]})

<span class="hljs-comment"># å·¦å›¾ï¼šä¼ ç»Ÿæ¨ªå‘å †ç§¯æ¡å½¢å›¾</span>
<span class="hljs-comment"># ... çœç•¥ ...</span>

<span class="hljs-comment"># å³å›¾ï¼šæ¨ªå‘å †å æ¡å½¢å›¾çš„æ”¹è¿›ç‰ˆï¼Œæ·»åŠ åˆ†éš”çº¿</span>
<span class="hljs-comment"># ... çœç•¥ ...</span>

plt.tight_layout()
plt.show()
</code></pre>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4a944949d5f4141a21ddd7390882fb1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769325736&amp;x-signature=VV%2FTkJeonMm1IOMY4mJ6NkT%2FElY%3D" alt="" loading="lazy"/></p>
<p>è¿™ä¸ªæ¨ªå‘å †ç§¯æ¡å½¢å›¾å±•ç¤ºäº†æ¯ä¸ªå­£åº¦ç”¨æˆ·æ»¡æ„åº¦çš„å®Œæ•´åˆ†å¸ƒï¼Œéšä¾¿å³è¾¹çš„å›¾ç¨å¾®åšäº†ä¸€äº›æ”¹è¿›ï¼Œ</p>
<p>ä½†å¦‚æœæˆ‘ä»¬æƒ³å›ç­”ä»¥ä¸‹é—®é¢˜å°±ä¼šé‡åˆ°å›°éš¾ï¼š</p>
<ul>
<li><strong>"åšå†³åŒæ„"</strong> çš„æ¯”ä¾‹åœ¨å“ªä¸ªå­£åº¦æœ€é«˜ï¼Ÿ</li>
<li><strong>"åå¯¹"</strong> å’Œ <strong>"å¼ºçƒˆåå¯¹"</strong> çš„æ¯”ä¾‹å¦‚ä½•éšæ—¶é—´å˜åŒ–ï¼Ÿ</li>
</ul>
<h2 data-id="heading-1">2. æ‹†è§£é‡æ„--å¤šä¸ªå­å›¾</h2>
<p>ä¸å…¶æŠŠæ‰€æœ‰é£Ÿæç‚–åœ¨ä¸€é”…é‡Œï¼Œä¸å¦‚å°†å®ƒä»¬åˆ†ç›˜æ‘†æ”¾ã€‚</p>
<p>æˆ‘ä»¬å°†<strong>å †ç§¯æ¡å½¢å›¾</strong>æ‹†è§£ä¸º5ä¸ªå°å›¾ï¼Œæ¯ä¸ªå°å›¾åªå…³æ³¨ä¸€ä¸ªæ»¡æ„åº¦ç»´åº¦çš„å­£åº¦å˜åŒ–ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> matplotlib.gridspec <span class="hljs-keyword">as</span> gridspec

fig = plt.figure(figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">6</span>))
gs = gridspec.GridSpec(<span class="hljs-number">2</span>, <span class="hljs-number">5</span>, figure=fig, hspace=<span class="hljs-number">0.3</span>, wspace=<span class="hljs-number">0.4</span>)
<span class="hljs-comment"># æ‹†è§£å †ç§¯æ¡å½¢å›¾ï¼šä¸ºæ¯ä¸ªç±»åˆ«åˆ›å»ºå•ç‹¬çš„æ¨ªå‘å­å›¾</span>
axes = []
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):
    axes.append(fig.add_subplot(gs[<span class="hljs-number">0</span>, i]))

<span class="hljs-comment"># ä¸ºæ¯ä¸ªæ»¡æ„åº¦ç»´åº¦åˆ›å»ºä¸€ä¸ªæ¨ªå‘æ¡å½¢å›¾</span>
<span class="hljs-keyword">for</span> i, (category, color, ax) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">zip</span>(categories, colors, axes)):
    <span class="hljs-comment"># ... çœç•¥ ...</span>

ax = fig.add_subplot(gs[<span class="hljs-number">1</span>, :]) <span class="hljs-comment"># ç¬¬1è¡Œï¼Œæ‰€æœ‰åˆ— (ç­‰åŒäº gs[1, 0:5])</span>
<span class="hljs-comment"># ... çœç•¥ ...</span>

plt.show()
</code></pre>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4c9b599c9344074a99f8e386d9210e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769325736&amp;x-signature=hpyP%2BAZdvQB3w%2BMII0U8vZDAOS4%3D" alt="" loading="lazy"/></p>
<p>æ‹†è§£åçš„å›¾è¡¨ç¡®å®æå‡äº†å•ä¸€ç»´åº¦çš„å¯¹æ¯”æ•ˆæœï¼Œä½†ä»æœ‰ä¸€ä¸ªæ˜æ˜¾é—®é¢˜ï¼šæˆ‘ä»¬çš„è§†çº¿éœ€è¦åœ¨å¤šä¸ªå›¾è¡¨é—´æ¥å›è·³è·ƒï¼Œæ— æ³•å½¢æˆç»Ÿä¸€çš„è§†è§‰å°è±¡ã€‚</p>
<p>è¿™å°±åƒé˜…è¯»ä¸€æœ¬åˆ†æ•£åœ¨å¤šä¸ªé¡µé¢çš„è¡¨æ ¼ï¼Œéœ€è¦ä¸æ–­ç¿»é¡µå¯¹ç…§ã€‚</p>
<h2 data-id="heading-2">3. åŒå‘å¯¹æ¯”--è´è¶å›¾</h2>
<p><strong>è´è¶å›¾</strong>ï¼ˆä¹Ÿç§°ä¸ºäººå£é‡‘å­—å¡”å›¾æˆ–åŒå‘æ¡å½¢å›¾ï¼‰æ˜¯æ•°æ®å¯è§†åŒ–çš„"ç‘å£«å†›åˆ€"ï¼Œç‰¹åˆ«é€‚åˆå±•ç¤ºå¯¹ç«‹æˆ–åŒå‘æ¯”è¾ƒçš„æ•°æ®ã€‚</p>
<p>å®ƒçš„è®¾è®¡å“²å­¦æ˜¯ï¼šè®©å¯¹æ¯”åœ¨ä¸­å¿ƒè½´ä¸¤ä¾§è‡ªç„¶å±•å¼€ï¼Œå°±åƒè´è¶å±•å¼€åŒç¿…ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 4. åˆ›å»ºç”»å¸ƒ</span>
fig, ax = plt.subplots(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>,figsize=(<span class="hljs-number">10</span>, <span class="hljs-number">6</span>))
y_pos = np.arange(<span class="hljs-built_in">len</span>(quarters))
<span class="hljs-comment"># æ‹†åˆ†æ•°æ®åˆ—</span>
strongly_disagree = data[:, <span class="hljs-number">0</span>]
disagree          = data[:, <span class="hljs-number">1</span>]
neutral           = data[:, <span class="hljs-number">2</span>]
agree             = data[:, <span class="hljs-number">3</span>]
strongly_agree    = data[:, <span class="hljs-number">4</span>]

<span class="hljs-comment"># ==========================================</span>
<span class="hljs-comment"># æ ¸å¿ƒé€»è¾‘ä¿®æ”¹ï¼šä»¥ä¸­ç«‹(Neutral)çš„ä¸­å¿ƒä¸º0ç‚¹</span>
<span class="hljs-comment"># ==========================================</span>
<span class="hljs-comment"># 1. ç»˜åˆ¶ä¸­ç«‹ (ç°è‰²)ï¼šè·¨è¶Š 0 è½´</span>
<span class="hljs-comment"># left ä» -width/2 å¼€å§‹ï¼Œè¿™æ · 0 å°±åœ¨æ­£ä¸­é—´</span>

<span class="hljs-comment"># 2. ç»˜åˆ¶å·¦ä¾§ (è´Ÿé¢æƒ…ç»ª)ï¼šå‘å·¦å †å </span>
<span class="hljs-comment"># åå¯¹ (Green)ï¼šèµ·å§‹ä½ç½®åœ¨ -neutral/2 çš„å·¦è¾¹</span>

<span class="hljs-comment"># å¼ºçƒˆåå¯¹ (Purple)ï¼šèµ·å§‹ä½ç½®åœ¨ åå¯¹ çš„å·¦è¾¹</span>

<span class="hljs-comment"># 3. ç»˜åˆ¶å³ä¾§ (æ­£é¢æƒ…ç»ª)ï¼šå‘å³å †å </span>
<span class="hljs-comment"># åŒæ„ (Orange)ï¼šèµ·å§‹ä½ç½®åœ¨ neutral/2</span>

<span class="hljs-comment"># å¼ºçƒˆåŒæ„ (Red)ï¼šèµ·å§‹ä½ç½®åœ¨ åŒæ„ çš„å³è¾¹</span>

<span class="hljs-comment"># 5. ç¾åŒ–å›¾è¡¨</span>
<span class="hljs-comment"># æ·»åŠ ä¸­é—´çš„åŸºå‡†çº¿ (ç©¿è¿‡ä¸­ç«‹æ¡å½¢)</span>
<span class="hljs-comment"># ... çœç•¥ ...</span>
plt.show()
</code></pre>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dfcc88fbd7ea4b479296930a493d5467~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGF0YWJvb2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769325736&amp;x-signature=F3IfS7gZBAnHjT0O4K2aLbQlexE%3D" alt="" loading="lazy"/></p>
<p><strong>è´è¶å›¾</strong>å’Œä¸€èˆ¬çš„å †ç§¯æ¡å½¢å›¾æ”¾åœ¨ä¸€èµ·ï¼Œå¯ä»¥æ˜æ˜¾çœ‹å‡ºä¸¤è€…åœ¨æ•°æ®å±•ç¤ºé€»è¾‘å’Œè§†è§‰é‡å¿ƒä¸Šæœ‰æ˜¾è‘—åŒºåˆ«ã€‚</p>
<p><strong>è´è¶å›¾</strong>ä¾§é‡äºå±•ç¤º <strong>â€œå¯¹ç«‹æ€åº¦çš„å¯¹æ¯”â€</strong>ï¼Œé€‚åˆçœ‹æ­£åä¸¤é¢çš„åŠ›é‡æ‚¬æ®Šä»¥åŠæ•´ä½“çš„æƒ…ç»ªå€¾å‘ï¼Œè€Œä¸”ä¹Ÿä¾¿äºæ¯”è¾ƒåŒä¾§çš„æ•°æ®ã€‚</p>
<h2 data-id="heading-3">4. æ€»ç»“</h2>
<p>æ€»ä¹‹ï¼Œ<strong>å †ç§¯æ¡å½¢å›¾</strong>åƒä¸€é”…å¤§æ‚çƒ©ï¼Œå½“é£Ÿæï¼ˆæ•°æ®ç»´åº¦ï¼‰è¿‡å¤šæ—¶ï¼Œæˆ‘ä»¬å¾ˆéš¾å“å°ï¼ˆåˆ†æï¼‰åˆ°æ¯ç§é£Ÿæçš„åŸå‘³ã€‚</p>
<p>é€šè¿‡æ‹†è§£å’Œé‡æ„ï¼Œæˆ‘ä»¬è·å¾—äº†æ›´æ¸…æ™°çš„è§†è§’ã€‚è€Œè´è¶å›¾åˆ™åƒä¸€ä½ä¼˜é›…çš„èˆè€…ï¼Œå°†å¯¹æ¯”æ•°æ®ä»¥å¯¹ç§°çš„æ–¹å¼å±•å¼€ï¼Œæ—¢ä¿ç•™äº†æ•´ä½“è§†é‡ï¼Œåˆå¼ºåŒ–äº†å±€éƒ¨å¯¹æ¯”ã€‚</p>
<p>ä¼˜ç§€çš„æ•°æ®å¯è§†åŒ–ä¸åœ¨äºå±•ç¤ºæ‰€æœ‰ä¿¡æ¯ï¼Œè€Œåœ¨äºä»¥æœ€å°‘çš„è®¤çŸ¥æˆæœ¬ä¼ è¾¾æœ€å¤šçš„æ´å¯Ÿã€‚</p>
<p>ä¸‹æ¬¡å½“æˆ‘ä»¬é¢å¯¹å¤šç»´æ•°æ®å¯¹æ¯”çš„æŒ‘æˆ˜æ—¶ï¼Œä¸å¦¨è¯•è¯•æ¨ªå‘è´è¶å›¾è¿™æŠŠ"ç‘å£«å†›åˆ€"ï¼Œå®ƒå¯èƒ½ä¼šç»™ä½ å¸¦æ¥æ„æƒ³ä¸åˆ°çš„æ¸…æ™°ä¸ç¾æ„Ÿã€‚</p>
<p>ç»˜åˆ¶æ–‡ä¸­å›¾åƒçš„å®Œæ•´ä»£ç å…±äº«åœ¨ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Furl11.ctfile.com%2Ff%2F45455611-8606783265-a93d12%3Fp%3D6872" target="_blank" title="https://url11.ctfile.com/f/45455611-8606783265-a93d12?p=6872" ref="nofollow noopener noreferrer">ä¼˜åŒ–å †ç§¯æ¡å½¢å›¾.ipynb</a> (è®¿é—®å¯†ç : 6872)</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[# JavaScript ç®—æ³•è¯¦è§£ï¼šHashè¡¨åœ¨å­—æ¯å¼‚ä½è¯åˆ†ç»„çš„åº”ç”¨ï¼ˆå°ç™½ä¹Ÿèƒ½çœ‹æ‡‚ï¼‰]]></title>    <link>https://juejin.cn/post/7596639774267310122</link>    <guid>https://juejin.cn/post/7596639774267310122</guid>    <pubDate>2026-01-19T05:44:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596639774267310122" data-draft-id="7596773213943070762" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="# JavaScript ç®—æ³•è¯¦è§£ï¼šHashè¡¨åœ¨å­—æ¯å¼‚ä½è¯åˆ†ç»„çš„åº”ç”¨ï¼ˆå°ç™½ä¹Ÿèƒ½çœ‹æ‡‚ï¼‰"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2026-01-19T05:44:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·80110532256"/> <meta itemprop="url" content="https://juejin.cn/user/1927884034804425"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            # JavaScript ç®—æ³•è¯¦è§£ï¼šHashè¡¨åœ¨å­—æ¯å¼‚ä½è¯åˆ†ç»„çš„åº”ç”¨ï¼ˆå°ç™½ä¹Ÿèƒ½çœ‹æ‡‚ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1927884034804425/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·80110532256
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T05:44:39.000Z" title="Mon Jan 19 2026 05:44:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">JavaScript ç®—æ³•è¯¦è§£ï¼šHashè¡¨åœ¨å­—æ¯å¼‚ä½è¯åˆ†ç»„çš„åº”ç”¨ï¼ˆå°ç™½ä¹Ÿèƒ½çœ‹æ‡‚ï¼‰</h2>
<blockquote>
<p>æœ¬æ–‡å°†ä»é›¶åŸºç¡€å¼€å§‹ï¼Œç”¨æœ€é€šä¿—çš„è¯­è¨€è¯¦ç»†è§£é‡Š JavaScript ä¸­ã€Œå­—æ¯å¼‚ä½è¯åˆ†ç»„ã€ç®—æ³•ï¼Œå°±åƒè€å¸ˆåœ¨è¯¾å ‚ä¸Šè®²è§£ä¸€æ ·ã€‚</p>
</blockquote>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯ã€Œå­—æ¯å¼‚ä½è¯åˆ†ç»„ã€ï¼Ÿ</h3>
<p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç”Ÿæ´»ä¸­çš„ä¾‹å­ï¼š</p>
<ul>
<li><code>"listen"</code>ï¼ˆå¬ï¼‰ å’Œ <code>"silent"</code>ï¼ˆå®‰é™ï¼‰ è¿™ä¸¤ä¸ªå•è¯ï¼Œå®ƒä»¬çš„å­—æ¯éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯é¡ºåºä¸åŒ â†’ è¿™å°±æ˜¯<strong>å­—æ¯å¼‚ä½è¯</strong></li>
<li><code>"eat"</code> å’Œ <code>"tea"</code> ä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†</li>
</ul>
<p>ç°åœ¨çš„é—®é¢˜æ˜¯ï¼šç»™ä½ ä¸€å †å•è¯ï¼ŒæŠŠæ‰€æœ‰å­—æ¯å¼‚ä½è¯<strong>åˆ†åˆ°ä¸€ç»„</strong>ã€‚</p>
<p>æ¯”å¦‚ç»™ä½ ï¼š<code>["eat", "tea", "tan", "ate", "nat", "bat"]</code></p>
<p>åº”è¯¥åˆ†æˆï¼š</p>
<ul>
<li>ç¬¬ä¸€ç»„ï¼š<code>["eat", "tea", "ate"]</code> ï¼ˆå®ƒä»¬éƒ½æ˜¯ç”± a,e,t ç»„æˆçš„ï¼‰</li>
<li>ç¬¬äºŒç»„ï¼š<code>["tan", "nat"]</code> ï¼ˆå®ƒä»¬éƒ½æ˜¯ç”± a,n,t ç»„æˆçš„ï¼‰</li>
<li>ç¬¬ä¸‰ç»„ï¼š<code>["bat"]</code> ï¼ˆåªæœ‰å®ƒä¸€ä¸ªï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-2">JavaScript ä»£ç è¯¦ç»†è§£é‡Š</h3>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-selector-tag">var</span> groupAnagrams = <span class="hljs-built_in">function</span>(strs) {
  const m = new <span class="hljs-built_in">Map</span>(); <span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ª"åˆ†ç±»ç›’å­"</span>

  for (const s of strs) { <span class="hljs-comment">// 2. æŒ¨ä¸ªçœ‹æ¯ä¸ªå•è¯</span>
    <span class="hljs-comment">// 3. æŠŠå•è¯çš„å­—æ¯é‡æ–°æ’åˆ—ï¼ˆæ’åºï¼‰</span>
    const sortedS = s<span class="hljs-selector-class">.split</span>('')<span class="hljs-selector-class">.sort</span>()<span class="hljs-selector-class">.join</span>('');

    if (!m.has(sortedS)) { <span class="hljs-comment">// 4. æ£€æŸ¥æœ‰æ²¡æœ‰è¿™ç§"å­—æ¯ç»„åˆ"çš„ç›’å­</span>
      m<span class="hljs-selector-class">.set</span>(sortedS, []); <span class="hljs-comment">// 5. å¦‚æœæ²¡æœ‰ï¼Œå°±æ–°å»ºä¸€ä¸ªç©ºç›’å­</span>
    }

    <span class="hljs-comment">// 6. æŠŠå•è¯æ”¾è¿›å¯¹åº”çš„ç›’å­é‡Œ</span>
    m<span class="hljs-selector-class">.get</span>(sortedS)<span class="hljs-selector-class">.push</span>(s);
  }

  <span class="hljs-comment">// 7. æŠŠæ‰€æœ‰çš„ç›’å­æ‹¿å‡ºæ¥ï¼Œç»„æˆä¸€ä¸ªå¤§åŒ…è£¹è¿”å›</span>
  return Array<span class="hljs-selector-class">.from</span>(m.values());
};
</code></pre>
<hr/>
<h3 data-id="heading-3">ä¸€æ­¥æ­¥è¯¦ç»†æ‹†è§£</h3>
<h4 data-id="heading-4">1. <code>var groupAnagrams = function(strs) {</code></h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> groupAnagrams = <span class="hljs-keyword">function</span>(<span class="hljs-params">strs</span>) {
</code></pre>
<ul>
<li><code>groupAnagrams</code> æ˜¯<strong>å‡½æ•°çš„åå­—</strong>ï¼ˆå°±åƒä¸€ä¸ªæœºå™¨çš„åå­—å«"åˆ†è¯æœº"ï¼‰</li>
<li><code>strs</code> æ˜¯<strong>è¾“å…¥å‚æ•°</strong>ï¼ˆå°±åƒä½ æŠŠä¸€å †å•è¯æ‰”è¿›æœºå™¨ï¼‰</li>
<li><code>function</code> æ˜¯å‘Šè¯‰ç”µè„‘ï¼š"æˆ‘å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œåå­—å« <code>groupAnagrams</code>ï¼Œå®ƒä¼šæ¥æ”¶ä¸€ä¸ªå« <code>strs</code> çš„å‚æ•°"</li>
</ul>
<blockquote>
<p>æ¯”å¦‚ï¼š<code>groupAnagrams(["eat", "tea"])</code> â†’ ä½ æŠŠ <code>["eat", "tea"]</code> ä¼ ç»™å‡½æ•°</p>
</blockquote>
<h4 data-id="heading-5">2. <code>const m = new Map();</code></h4>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">m</span> = new Map()<span class="hljs-comment">;</span>
</code></pre>
<ul>
<li><code>const</code>ï¼šå£°æ˜ä¸€ä¸ª<strong>å¸¸é‡</strong>ï¼ˆä¸èƒ½è¢«ä¿®æ”¹çš„å˜é‡ï¼‰ï¼Œå°±åƒä¸€ä¸ª<strong>æ ‡ç­¾</strong></li>
<li><code>m</code>ï¼šè¿™æ˜¯ç»™è¿™ä¸ªä¸œè¥¿èµ·çš„åå­—ï¼Œå°±åƒ"åˆ†ç±»æŸœ"</li>
<li><code>new Map()</code>ï¼šåˆ›å»ºä¸€ä¸ª"<strong>å“ˆå¸Œè¡¨</strong>"ï¼ˆå¯ä»¥æƒ³è±¡æˆä¸€ä¸ªæœ‰å¾ˆå¤šæŠ½å±‰çš„æŸœå­ï¼‰</li>
</ul>
<blockquote>
<p><strong>Map å°±åƒä¸€ä¸ªæ™ºèƒ½åˆ†ç±»æŸœ</strong>ï¼š</p>
<ul>
<li>ä½ å¯ä»¥ç»™å®ƒä¸€ä¸ª"é’¥åŒ™"ï¼ˆkeyï¼‰ï¼Œå®ƒå°±èƒ½ç»™ä½ å¯¹åº”çš„"ç‰©å“"ï¼ˆvalueï¼‰</li>
<li>æ¯”å¦‚ï¼š<code>æŸœå­.æ”¾ä¸œè¥¿("é’¥åŒ™A", "è‹¹æœ")</code> â†’ æŠŠè‹¹æœæ”¾åœ¨é’¥åŒ™Aå¯¹åº”çš„æŠ½å±‰é‡Œ</li>
<li><code>æŸœå­.æ‹¿ä¸œè¥¿("é’¥åŒ™A")</code> â†’ æ‹¿åˆ°è‹¹æœ</li>
</ul>
</blockquote>
<h4 data-id="heading-6">3. <code>for (const s of strs) {</code></h4>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> s of strs) {
</code></pre>
<ul>
<li><code>for</code>ï¼šè¡¨ç¤º"å¾ªç¯"ï¼ˆé‡å¤åšæŸä»¶äº‹ï¼‰</li>
<li><code>const s</code>ï¼šæ¯æ¬¡å¾ªç¯æ—¶ï¼Œç”¨ <code>s</code> æ¥ä»£è¡¨å½“å‰çš„å•è¯</li>
<li><code>of strs</code>ï¼šåœ¨ <code>strs</code> æ•°ç»„ä¸­ä¸€ä¸ªä¸€ä¸ªåœ°å–å•è¯</li>
</ul>
<blockquote>
<p>å¦‚æœ <code>strs = ["eat", "tea", "tan"]</code>ï¼š</p>
<ul>
<li>ç¬¬1æ¬¡å¾ªç¯ï¼š<code>s = "eat"</code></li>
<li>ç¬¬2æ¬¡å¾ªç¯ï¼š<code>s = "tea"</code></li>
<li>ç¬¬3æ¬¡å¾ªç¯ï¼š<code>s = "tan"</code></li>
</ul>
</blockquote>
<h4 data-id="heading-7">4. <code>const sortedS = s.split('').sort().join('');</code></h4>
<p>è¿™æ˜¯æœ€ç¥å¥‡çš„ä¸€æ­¥ï¼æˆ‘ä»¬æ¥æ‹†å¼€çœ‹ï¼š</p>
<h5 data-id="heading-8">4.1 <code>s.split('')</code></h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-string">"eat"</span>.<span class="hljs-built_in">split</span>(<span class="hljs-string">''</span>) â†’ [<span class="hljs-string">"e"</span>, <span class="hljs-string">"a"</span>, <span class="hljs-string">"t"</span>]
</code></pre>
<ul>
<li><code>split('')</code>ï¼šæŠŠå­—ç¬¦ä¸²<strong>æ‹†æˆ</strong>ä¸€ä¸ªä¸ªå­—æ¯ç»„æˆçš„æ•°ç»„</li>
</ul>
<h5 data-id="heading-9">4.2 <code>.sort()</code></h5>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-selector-attr">[<span class="hljs-string">"e"</span>, <span class="hljs-string">"a"</span>, <span class="hljs-string">"t"</span>]</span><span class="hljs-selector-class">.sort</span>() â†’ <span class="hljs-selector-attr">[<span class="hljs-string">"a"</span>, <span class="hljs-string">"e"</span>, <span class="hljs-string">"t"</span>]</span>
</code></pre>
<ul>
<li><code>sort()</code>ï¼šæŠŠæ•°ç»„é‡Œçš„å…ƒç´ <strong>æŒ‰å­—æ¯é¡ºåºæ’åˆ—</strong></li>
</ul>
<h5 data-id="heading-10">4.3 <code>.join('')</code></h5>
<pre><code class="hljs language-bash" lang="bash">[<span class="hljs-string">"a"</span>, <span class="hljs-string">"e"</span>, <span class="hljs-string">"t"</span>].<span class="hljs-built_in">join</span>(<span class="hljs-string">''</span>) â†’ <span class="hljs-string">"aet"</span>
</code></pre>
<ul>
<li><code>join('')</code>ï¼šæŠŠæ•°ç»„é‡Œçš„å…ƒç´ <strong>æ‹¼æ¥æˆ</strong>ä¸€ä¸ªå­—ç¬¦ä¸²</li>
</ul>
<blockquote>
<p>æ‰€ä»¥ï¼š</p>
<ul>
<li><code>"eat"</code> â†’ <code>"aet"</code></li>
<li><code>"tea"</code> â†’ <code>"aet"</code> â† å®ƒä»¬æ’åºåæ˜¯ä¸€æ ·çš„ï¼</li>
<li><code>"tan"</code> â†’ <code>"ant"</code></li>
</ul>
</blockquote>
<h4 data-id="heading-11">5. <code>if (!m.has(sortedS)) {</code></h4>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">if</span> (!m.<span class="hljs-built_in">has</span>(sortedS)) {
</code></pre>
<ul>
<li><code>if</code>ï¼šè¡¨ç¤º"å¦‚æœ...é‚£ä¹ˆ..."</li>
<li><code>!</code>ï¼šè¡¨ç¤º"ä¸æ˜¯"ã€"ä¸å­˜åœ¨"</li>
<li><code>m.has(sortedS)</code>ï¼šè¯¢é—®åˆ†ç±»æŸœ <code>m</code>ï¼š"ä½ æœ‰æ²¡æœ‰å« <code>sortedS</code> è¿™ä¸ªé’¥åŒ™çš„æŠ½å±‰ï¼Ÿ"</li>
</ul>
<blockquote>
<p>å¦‚æœ <code>sortedS = "aet"</code>ï¼š</p>
<ul>
<li><code>m.has("aet")</code> â†’ é—®ï¼š"æœ‰æ²¡æœ‰é’¥åŒ™å« 'aet' çš„æŠ½å±‰ï¼Ÿ"</li>
<li><code>!m.has("aet")</code> â†’ "å¦‚æœæ²¡æœ‰çš„è¯..."</li>
</ul>
</blockquote>
<h4 data-id="heading-12">6. <code>m.set(sortedS, []);</code></h4>
<pre><code class="hljs language-ini" lang="ini">m.set(sortedS, <span class="hljs-section">[]</span>)<span class="hljs-comment">;</span>
</code></pre>
<ul>
<li><code>m.set(key, value)</code>ï¼šå¾€åˆ†ç±»æŸœé‡Œæ”¾ä¸œè¥¿</li>
<li><code>sortedS</code>ï¼šé’¥åŒ™ï¼ˆæ¯”å¦‚ <code>"aet"</code>ï¼‰</li>
<li><code>[]</code>ï¼šä¸€ä¸ªç©ºæ•°ç»„ï¼ˆå°±åƒä¸€ä¸ªç©ºç›’å­ï¼‰</li>
</ul>
<blockquote>
<p><code>m.set("aet", [])</code> â†’ åˆ›å»ºä¸€ä¸ªé’¥åŒ™å« "aet" çš„æŠ½å±‰ï¼Œé‡Œé¢æ”¾ä¸€ä¸ªç©ºç›’å­</p>
</blockquote>
<h4 data-id="heading-13">7. <code>m.get(sortedS).push(s);</code></h4>
<pre><code class="hljs language-scss" lang="scss">m<span class="hljs-selector-class">.get</span>(sortedS)<span class="hljs-selector-class">.push</span>(s);
</code></pre>
<ul>
<li><code>m.get(sortedS)</code>ï¼šæ‹¿åˆ°é’¥åŒ™ <code>sortedS</code> å¯¹åº”çš„æŠ½å±‰é‡Œçš„ç›’å­</li>
<li><code>.push(s)</code>ï¼šæŠŠå•è¯ <code>s</code> æ”¾è¿›è¿™ä¸ªç›’å­</li>
</ul>
<blockquote>
<p>å¦‚æœ <code>sortedS = "aet"</code>, <code>s = "eat"</code>ï¼š</p>
<ul>
<li><code>m.get("aet")</code> â†’ æ‹¿åˆ°è£…ç€å­—æ¯å¼‚ä½è¯çš„ç›’å­</li>
<li><code>.push("eat")</code> â†’ æŠŠ "eat" æ”¾è¿›å»</li>
</ul>
</blockquote>
<h4 data-id="heading-14">8. <code>return Array.from(m.values());</code></h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">return</span> Array.<span class="hljs-keyword">from</span>(m.values());
</code></pre>
<ul>
<li><code>m.values()</code>ï¼šæ‹¿å‡ºåˆ†ç±»æŸœé‡Œ<strong>æ‰€æœ‰æŠ½å±‰é‡Œçš„ä¸œè¥¿</strong>ï¼ˆæ‰€æœ‰è£…ç€å•è¯çš„ç›’å­ï¼‰</li>
<li><code>Array.from()</code>ï¼šæŠŠè¿™äº›ä¸œè¥¿å˜æˆä¸€ä¸ªæ•°ç»„</li>
<li><code>return</code>ï¼šæŠŠç»“æœäº¤ç»™å¤–é¢çš„äºº</li>
</ul>
<hr/>
<h3 data-id="heading-15">å®é™…è¿è¡Œè¿‡ç¨‹æ¼”ç¤º</h3>
<p>è®©æˆ‘ä»¬ç”¨ <code>["eat", "tea", "tan"]</code> æ¥è¿½è¸ªæ•´ä¸ªè¿‡ç¨‹ï¼š</p>





























































<table><thead><tr><th>æ­¥éª¤</th><th><code>s</code></th><th><code>sortedS</code></th><th><code>m</code> çš„çŠ¶æ€</th><th>æ“ä½œ</th></tr></thead><tbody><tr><td>1</td><td>"eat"</td><td>"aet"</td><td><code>{}</code></td><td><code>m.set("aet", [])</code> â†’ <code>{"aet": []}</code></td></tr><tr><td/><td/><td/><td/><td><code>m.get("aet").push("eat")</code> â†’ <code>{"aet": ["eat"]}</code></td></tr><tr><td>2</td><td>"tea"</td><td>"aet"</td><td><code>{"aet": ["eat"]}</code></td><td><code>m.has("aet")</code> ä¸º trueï¼Œè·³è¿‡ <code>set</code></td></tr><tr><td/><td/><td/><td/><td><code>m.get("aet").push("tea")</code> â†’ <code>{"aet": ["eat", "tea"]}</code></td></tr><tr><td>3</td><td>"tan"</td><td>"ant"</td><td><code>{"aet": ["eat", "tea"]}</code></td><td><code>m.has("ant")</code> ä¸º false</td></tr><tr><td/><td/><td/><td/><td><code>m.set("ant", [])</code> â†’ <code>{"aet": ["eat", "tea"], "ant": []}</code></td></tr><tr><td/><td/><td/><td/><td><code>m.get("ant").push("tan")</code> â†’ <code>{"aet": ["eat", "tea"], "ant": ["tan"]}</code></td></tr></tbody></table>
<p>æœ€å <code>m.values()</code> å¾—åˆ°ï¼š<code>[["eat", "tea"], ["tan"]]</code></p>
<hr/>
<h3 data-id="heading-16">æ ¸å¿ƒæ€æƒ³æ€»ç»“</h3>
<blockquote>
<p><strong>"å­—æ¯å¼‚ä½è¯"æ’åºåå®Œå…¨ä¸€æ ·ï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ’åºåçš„å­—ç¬¦ä¸²ä½œä¸º"åˆ†ç±»æ ‡ç­¾"</strong></p>
</blockquote>
<p>å°±åƒï¼š</p>
<ul>
<li><code>"eat"</code>, <code>"tea"</code>, <code>"ate"</code> éƒ½å±äº <code>"aet"</code> ç±»åˆ«</li>
<li><code>"tan"</code>, <code>"nat"</code> éƒ½å±äº <code>"ant"</code> ç±»åˆ«</li>
</ul>
<hr/>
<h3 data-id="heading-17">JavaScript è¯­æ³•å°çŸ¥è¯†</h3>




























































<table><thead><tr><th>è¯­æ³•</th><th>å«ä¹‰</th><th>ä¾‹å­</th></tr></thead><tbody><tr><td><code>const</code></td><td>å£°æ˜å¸¸é‡</td><td><code>const x = 5;</code></td></tr><tr><td><code>new Map()</code></td><td>åˆ›å»ºå“ˆå¸Œè¡¨</td><td><code>const map = new Map();</code></td></tr><tr><td><code>for...of</code></td><td>éå†æ•°ç»„</td><td><code>for(const item of array)</code></td></tr><tr><td><code>split()</code></td><td>æ‹†åˆ†å­—ç¬¦ä¸²</td><td><code>"abc".split('') â†’ ["a", "b", "c"]</code></td></tr><tr><td><code>sort()</code></td><td>æ’åº</td><td><code>["c", "a", "b"].sort() â†’ ["a", "b", "c"]</code></td></tr><tr><td><code>join()</code></td><td>è¿æ¥æ•°ç»„</td><td><code>["a", "b", "c"].join('') â†’ "abc"</code></td></tr><tr><td><code>push()</code></td><td>æ·»åŠ å…ƒç´ </td><td><code>arr.push(item)</code></td></tr><tr><td><code>has()</code></td><td>æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨</td><td><code>map.has(key)</code></td></tr><tr><td><code>set()</code></td><td>è®¾ç½®é”®å€¼å¯¹</td><td><code>map.set(key, value)</code></td></tr><tr><td><code>get()</code></td><td>è·å–å€¼</td><td><code>map.get(key)</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-18">æ€»ç»“</h3>
<p>è¿™ä¸ªç®—æ³•å·§å¦™åœ°åˆ©ç”¨äº†ï¼š</p>
<ol>
<li><strong>æ’åº</strong>ï¼šè®©å­—æ¯å¼‚ä½è¯å˜å¾—"ä¸€æ ·"</li>
<li><strong>å“ˆå¸Œè¡¨</strong>ï¼šå¿«é€Ÿåˆ†ç±»å­˜å‚¨</li>
<li><strong>å¾ªç¯</strong>ï¼šé€ä¸ªå¤„ç†æ¯ä¸ªå•è¯</li>
</ol>
<p>æœ€ç»ˆå®ç°äº†é«˜æ•ˆçš„å­—æ¯å¼‚ä½è¯åˆ†ç»„ï¼</p>
<hr/>
<hr/>
<blockquote>
<p>ä½ è¿˜åœ¨å­¦ä¹  JavaScript çš„è·¯ä¸Šå—ï¼Ÿåœ¨è¯„è®ºåŒºåˆ†äº«ä½ é‡åˆ°çš„å›°æƒ‘ï¼Œæˆ‘ä»¬ä¸€èµ·è®¨è®ºï¼</p>
</blockquote>
<p>#javascript #ç®—æ³• #å‰ç«¯å¼€å‘ #é¢è¯•å‡†å¤‡ #ç¼–ç¨‹å…¥é—¨</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰‹æŠŠæ‰‹æ•™ä½ æ­å»º Nginx-RTMP æµåª’ä½“æœåŠ¡å™¨ï¼ˆUbuntu/Windowsï¼‰]]></title>    <link>https://juejin.cn/post/7596066987471405098</link>    <guid>https://juejin.cn/post/7596066987471405098</guid>    <pubDate>2026-01-17T17:09:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596066987471405098" data-draft-id="7596092713078882340" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰‹æŠŠæ‰‹æ•™ä½ æ­å»º Nginx-RTMP æµåª’ä½“æœåŠ¡å™¨ï¼ˆUbuntu/Windowsï¼‰"/> <meta itemprop="keywords" content="éŸ³è§†é¢‘å¼€å‘,ç›´æ’­"/> <meta itemprop="datePublished" content="2026-01-17T17:09:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="EZåœ¨çº¿å·¥å…·ç½‘"/> <meta itemprop="url" content="https://juejin.cn/user/494154918666608"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰‹æŠŠæ‰‹æ•™ä½ æ­å»º Nginx-RTMP æµåª’ä½“æœåŠ¡å™¨ï¼ˆUbuntu/Windowsï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/494154918666608/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    EZåœ¨çº¿å·¥å…·ç½‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T17:09:55.000Z" title="Sat Jan 17 2026 17:09:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä½œè€…ç®€ä»‹</h2>
<p>ğŸ‘‹Hiï¼Œæˆ‘æ˜¯ <a href="https://link.juejin.cn?target=https%3A%2F%2Fezwebtools.net" target="_blank" title="https://ezwebtools.net" ref="nofollow noopener noreferrer">EZ åœ¨çº¿å·¥å…·ç½‘</a>çš„ç«™é•¿ï¼Œä¸“æ³¨äºå¤šåª’ä½“åœ¨çº¿è§†é¢‘æŠ€æœ¯ä¸æµè§ˆå™¨ç«¯å·¥å…·å¼€å‘ã€‚</p>
<blockquote>
<p><strong>EZ åœ¨çº¿å·¥å…·ç½‘</strong> æ˜¯ä¸€ä¸ªä»¥ <strong>åœ¨çº¿è§†é¢‘å¤„ç†</strong> ä¸ºæ ¸å¿ƒçš„å·¥å…·å¹³å°ï¼Œæä¾›åŒ…æ‹¬ <strong>M3U8 åœ¨çº¿æ’­æ”¾ã€M3U8 è½¬ MP4ã€RTMP / HLS æµæµ‹è¯•ã€FFmpeg åœ¨çº¿è½¬ç </strong> ç­‰åŠŸèƒ½ï¼Œå…¨éƒ¨å¯ç›´æ¥åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ï¼Œæ— éœ€å®‰è£…å®¢æˆ·ç«¯ã€‚</p>
</blockquote>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>éšç€ç›´æ’­è¡Œä¸šçš„çˆ†å‘ï¼ŒBç«™ã€æŠ–éŸ³ã€è§†é¢‘å·å·²ç»æˆä¸ºæˆ‘ä»¬ç”Ÿæ´»çš„ä¸€éƒ¨åˆ†ã€‚ä½†ä½ æ˜¯å¦æƒ³è¿‡ï¼Œè¿™äº›å…‰é²œäº®ä¸½çš„ç›´æ’­èƒŒåï¼ŒæŠ€æœ¯åŸç†æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœæˆ‘ä»¬æƒ³è‡ªå·±åšä¸€ä¸ªç§æœï¼Œæˆ–è€…åœ¨å†…ç½‘æ­å»ºä¸€ä¸ªç›‘æ§æ¨æµæœåŠ¡å™¨ï¼Œè¯¥æ€ä¹ˆåšï¼Ÿæœ¬æ–‡å°†ä»é›¶å¼€å§‹ï¼Œè¶…è¯¦ç»†åœ°æ•™ä½ åœ¨ Ubuntu å’Œ Windows ä¸¤å¤§ä¸»æµå¹³å°ä¸Šï¼Œæ‰‹æŠŠæ‰‹ç¼–è¯‘ã€é…ç½®ã€å¹¶è·‘é€š Nginx-RTMP æµåª’ä½“æœåŠ¡å™¨ã€‚è®©ä½ ä¸ä»…â€œçŸ¥å…¶ç„¶â€ï¼Œæ›´â€œçŸ¥å…¶æ‰€ä»¥ç„¶â€ã€‚</p>
<h2 data-id="heading-2">ä¸ºä»€ä¹ˆé€‰æ‹© Nginx-RTMPï¼Ÿ</h2>
<p>åœ¨æµåª’ä½“é¢†åŸŸï¼Œåè®®ç¹å¤šï¼Œåˆ—å¦‚ï¼šRTMPã€ HLS,ã€FLV, WebRTCç­‰ï¼ŒæœåŠ¡å™¨ä¹Ÿæœ‰ SRS, ZLMediaKit, Nginx-RTMP ç­‰ã€‚ä¸ºä»€ä¹ˆååé€‰ Nginx-RTMPï¼Ÿ
æˆ‘æ€»ç»“äº†æ¦‚æ‹¬ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p>
<ul>
<li><strong>é«˜æ€§èƒ½</strong> ï¼š ä¼—æ‰€å‘¨çŸ¥ï¼ŒNginx çš„é«˜å¹¶å‘èƒ½åŠ›å¤©ä¸‹é—»åã€‚</li>
<li><strong>æåº¦è½»é‡</strong>ï¼šèµ„æºå ç”¨æä½ï¼Œä¸€å° 1H1G çš„äº‘æœåŠ¡å™¨å°±èƒ½æ‰›ä½å‡ ç™¾è·¯æ¨æµã€‚</li>
<li><strong>é…ç½®ç®€å•</strong>ï¼šä¸€ä¸ª nginx.conf èµ°å¤©ä¸‹ã€‚</li>
<li><strong>åŠŸèƒ½å¼ºå¤§</strong>ï¼šæ”¯æŒ RTMP æ¨æµï¼ŒåŒæ—¶æ”¯æŒ HTTP-FLV å’Œ HLS æ’­æ”¾ï¼Œå®Œç¾å…¼å®¹ PC å’Œç§»åŠ¨ç«¯ã€‚
æœ¬æ–‡ç›®æ ‡ï¼šæ­å»ºä¸€å°æœåŠ¡å™¨ï¼Œå®ç° OBS æ¨æµ -&gt; æœåŠ¡å™¨ -&gt; VLC/æµè§ˆå™¨ æ’­æ”¾ çš„å®Œæ•´é—­ç¯ã€‚</li>
</ul>
<h2 data-id="heading-3">å‰æœŸå‡†å¤‡</h2>
<p>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚è¯·å‡†å¤‡å¥½ä»¥ä¸‹ç¯å¢ƒï¼š</p>
<ul>
<li><strong>ä¸€å°æœåŠ¡å™¨/ç”µè„‘</strong>ï¼šäº‘æœåŠ¡å™¨ï¼ˆæ¨è Ubuntu 20.04/22.04ï¼‰æˆ–è€…æœ¬åœ° Windows ç”µè„‘ã€‚</li>
<li><strong>æ¨æµå·¥å…·ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fobsproject.com%2F" target="_blank" title="https://obsproject.com/" ref="nofollow noopener noreferrer">OBS Studio</a>ï¼ˆå¼€æºå…è´¹ï¼Œæ¨æµç•Œçš„ç‘å£«å†›åˆ€ï¼‰ã€‚</li>
<li><strong>æ’­æ”¾å·¥å…·ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.videolan.org%2F" target="_blank" title="https://www.videolan.org/" ref="nofollow noopener noreferrer">VLC Media Player</a>ï¼ˆä¸‡èƒ½æ’­æ”¾å™¨ï¼‰ã€‚</li>
<li><strong>ä»£ç ç¼–è¾‘å™¨ï¼š</strong> VS Codeã€Notepad++ æˆ– Vimã€‚</li>
</ul>
<h2 data-id="heading-4">Ubuntu å¹³å°æ­å»º</h2>
<p>ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯Ubuntuï¼Œè¿™é‡Œä¸ç”¨ <code>apt install</code>ï¼Œå› ä¸ºå®˜æ–¹æºé‡Œçš„ Nginx ä¸å¸¦ <code>RTMP æ¨¡å—</code>ï¼Œæ‰€ä»¥éœ€è¦ä»æºç ç¼–è¯‘ï¼Œå¬èµ·æ¥å¾ˆå“äººï¼Ÿå…¶å®å°±æ˜¯å¤åˆ¶ç²˜è´´å‡ è¡Œå‘½ä»¤çš„äº‹ã€‚ğŸ˜</p>
<h3 data-id="heading-5">å®‰è£…ç¼–è¯‘ä¾èµ–</h3>
<p>æ‰“å¼€ç»ˆç«¯ï¼Œä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ›´æ–°è½¯ä»¶æº</span>
sudo apt-get update

<span class="hljs-comment"># å®‰è£…ç¼–è¯‘å·¥å…·å’Œä¾èµ–åº“</span>
sudo apt-get install build-essential libpcre3 libpcre3-dev libssl-dev zlib1g-dev unzip wget
</code></pre>
<h3 data-id="heading-6">ä¸‹è½½ Nginx å’Œ RTMP æ¨¡å—</h3>
<p>æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªå‹ç¼©åŒ…ï¼šNginx æºç åŒ…ã€Nginx-RTMP-Module æ¨¡å—åŒ…ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªå·¥ä½œç›®å½•</span>
<span class="hljs-built_in">mkdir</span> ~/nginx-build &amp;&amp; <span class="hljs-built_in">cd</span> ~/nginx-build

<span class="hljs-comment"># ä¸‹è½½ Nginx (æ¨è 1.20.x ç‰ˆæœ¬ï¼Œç¨³å®š)</span>
wget http://nginx.org/download/nginx-1.20.2.tar.gz

<span class="hljs-comment"># ä¸‹è½½ RTMP æ¨¡å— (ä½œè€… arut çš„åŸç‰ˆ)</span>
wget https://github.com/arut/nginx-rtmp-module/archive/master.zip
</code></pre>
<h3 data-id="heading-7">è§£å‹ä¸é…ç½®</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è§£å‹</span>
tar -zxvf nginx-1.20.2.tar.gz
unzip master.zip

<span class="hljs-comment"># è¿›å…¥ Nginx ç›®å½•</span>
<span class="hljs-built_in">cd</span> nginx-1.20.2
</code></pre>
<p><strong>æœ€å…³é”®çš„ä¸€æ­¥æ¥äº†ï¼šé…ç½®ç¼–è¯‘å‚æ•°ã€‚</strong>
æˆ‘ä»¬è¦å‘Šè¯‰ Nginxï¼šé™¤äº†è‡ªå¸¦çš„åŠŸèƒ½ï¼ŒæŠŠæ—è¾¹é‚£ä¸ª <code>nginx-rtmp-module</code> ä¹Ÿæ‰“åŒ…è¿›å»ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">./configure \
--prefix=/usr/local/nginx \
--add-module=../nginx-rtmp-module-master \
--with-http_ssl_module \
--with-http_v2_module
</code></pre>
<blockquote>
<p><strong>å‚æ•°è§£é‡Š</strong>ï¼š</p>
<ul>
<li><code>--prefix</code>ï¼šæŒ‡å®šå®‰è£…ç›®å½•ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚</li>
<li><code>--add-module</code>ï¼šæŒ‡å®š RTMP æ¨¡å—æºç è·¯å¾„ï¼Œæ³¨æ„æ˜¯ä¸Šä¸€çº§ç›®å½•çš„ master æ–‡ä»¶å¤¹ã€‚</li>
<li><code>--with-http_ssl_module</code>ï¼šå¼€å¯ SSL æ”¯æŒï¼Œæ³¨æ„ï¼šHLS å¿…é¡»ç”¨ HTTPSã€‚</li>
</ul>
</blockquote>
<p>å¦‚æœæ²¡æœ‰æŠ¥é”™ï¼Œæœ€åä¼šæ˜¾ç¤º "configured successfully"ã€‚</p>
<h3 data-id="heading-8">ç¼–è¯‘ä¸å®‰è£…</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¯‘ï¼ˆmakeï¼‰ï¼Œ-j4 è¡¨ç¤ºç”¨ 4 ä¸ªæ ¸å¿ƒç¼–è¯‘ï¼Œé€Ÿåº¦å¿«ï¼Œå¯ä»¥æ ¹æ®æœºå™¨é…ç½®è®¾ç½®æ ¸å¿ƒæ•°</span>
make -j4

sudo make install
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œä½ çš„ Nginx å°±åœ¨ <code>/usr/local/nginx</code> ç›®å½•ä¸‹äº†ã€‚</p>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img18@main/2026/01/17/1768641403098-fbacca4c-babb-4fd1-8632-008ccb5962c8.png" alt="ç¼–è¯‘å®‰è£…Nginx-RTMP" loading="lazy"/></p>
<h3 data-id="heading-9">Ubuntu ç³»ç»ŸæœåŠ¡é…ç½®</h3>
<p>åˆ›å»º systemd æœåŠ¡æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo vim /etc/systemd/system/nginx-rtmp.service
</code></pre>
<p>æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[Unit]</span>
<span class="hljs-attr">Description</span>=nginx-rtmp server
<span class="hljs-attr">After</span>=network.target

<span class="hljs-section">[Service]</span>
<span class="hljs-attr">Type</span>=forking
<span class="hljs-attr">PIDFile</span>=/usr/local/nginx/logs/nginx.pid
<span class="hljs-attr">ExecStart</span>=/usr/local/nginx/sbin/nginx
<span class="hljs-attr">ExecReload</span>=/usr/local/nginx/sbin/nginx -s reload
<span class="hljs-attr">ExecStop</span>=/usr/local/nginx/sbin/nginx -s quit
<span class="hljs-attr">PrivateTmp</span>=<span class="hljs-literal">true</span>

<span class="hljs-section">[Install]</span>
<span class="hljs-attr">WantedBy</span>=multi-user.target
</code></pre>
<p>å¯ç”¨æœåŠ¡:</p>
<pre><code class="hljs language-bash" lang="bash">sudo systemctl <span class="hljs-built_in">enable</span> nginx-rtmp
sudo systemctl start nginx-rtmp
</code></pre>
<hr/>
<h2 data-id="heading-10">Windows å¹³å°æ­å»º</h2>
<p>Windows ç¼–è¯‘ç¯å¢ƒå¤ªéº»çƒ¦ï¼Œå¥½åœ¨æœ‰å¤§ç¥åšäº†ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶åŒ…ã€‚</p>
<h3 data-id="heading-11">ä¸‹è½½è§£å‹</h3>
<ol>
<li>è®¿é—® GitHub ä»“åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Filluspas%2Fnginx-rtmp-win32%2Freleases" target="_blank" title="https://github.com/illuspas/nginx-rtmp-win32/releases" ref="nofollow noopener noreferrer">illuspas/nginx-rtmp-win32</a>ã€‚</li>
<li>ä¸‹è½½æœ€æ–°çš„ <code>nginx-rtmp-win32-1.2.1.zip</code>ã€‚</li>
<li>è§£å‹åˆ°éä¸­æ–‡è·¯å¾„ï¼Œä¾‹å¦‚ <code>D:\nginx-rtmp</code>ã€‚</li>
</ol>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img11@main/2026/01/17/1768641459264-b25aacb3-ea47-4be1-9913-ec5d7c2e0eab.png" alt="Windows Nginx RTMP" loading="lazy"/></p>
<p>çœ‹åˆ° <code>nginx.exe</code> äº†å—ï¼Ÿè¿™å°±æ˜¯æˆ‘ä»¬çš„ä¸»è§’ã€‚</p>
<hr/>
<h2 data-id="heading-12">æ ¸å¿ƒé…ç½®ï¼šnginx.conf è¯¦è§£</h2>
<p>æ— è®º Ubuntu è¿˜æ˜¯ Windowsï¼Œçµé­‚éƒ½åœ¨ <code>conf/nginx.conf</code> æ–‡ä»¶é‡Œã€‚
ç”¨ç¼–è¾‘å™¨æ‰“å¼€å®ƒï¼Œæ‰¾åˆ° <code>http { ... }</code> éƒ¨åˆ†ï¼Œ<strong>åœ¨å®ƒçš„å¤–é¢åŒçº§ä½ç½®</strong>ï¼Œæ·»åŠ ä»¥ä¸‹ <code>rtmp</code> é…ç½®ï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx">rtmp {
    server {
        listen 1935; # RTMP é»˜è®¤ç«¯å£
        chunk_size 4096;

        application live {
            live on;             # å¼€å¯ç›´æ’­æ¨¡å¼
            record off;          # å…³é—­å½•åˆ¶ï¼ˆèŠ‚çœç¡¬ç›˜ï¼‰
            allow publish 127.0.0.1; # å…è®¸æ¨æµçš„å®¢æˆ·ç«¯ IPï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®æ”¹æˆå†…ç½‘ IP æˆ–å¯†ç éªŒè¯
            
            # å¼€å¯ HLS åˆ‡ç‰‡
            hls on;
            hls_path /tmp/hls;   # Ubuntu è·¯å¾„
            # hls_path D:/nginx-rtmp/temp/hls; # Windows è·¯å¾„ï¼Œæ³¨æ„åæ–œæ 
            hls_fragment 3s;     # æ¯ä¸ªåˆ‡ç‰‡ 3 ç§’
            hls_playlist_length 10s; # æ’­æ”¾åˆ—è¡¨é•¿åº¦ 10 ç§’
        }
    }
}

http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;
    keepalive_timeout  65;

    server {
        listen       80; # HTTP é»˜è®¤ç«¯å£ï¼Œç”¨äºæ’­æ”¾ HLS
        server_name  localhost;

        # HLS æ’­æ”¾é…ç½®
        location /hls {
            types {
                application/vnd.apple.mpegurl m3u8;
                video/mp2t ts;
            }
            root /tmp; # Ubuntu
            # root D:/nginx-rtmp/temp; # Windows
            add_header Cache-Control no-cache;
        }
    }
}
</code></pre>
<p><strong>é…ç½®ä¿å­˜åï¼š</strong></p>
<ul>
<li><strong>Ubuntu</strong>ï¼š<code>sudo /usr/local/nginx/sbin/nginx</code> å¯åŠ¨ã€‚</li>
<li><strong>Windows</strong>ï¼šåŒå‡» <code>nginx.exe</code> å¯åŠ¨ï¼ˆä¼šé—ªä¸€ä¸ªé»‘çª—å£ï¼‰ã€‚</li>
</ul>
<blockquote>
<p><strong>é˜²ç«å¢™æ³¨æ„</strong>ï¼šåŠ¡å¿…å¼€æ”¾ <strong>1935</strong> (æ¨æµ) å’Œ <strong>80</strong> (æ’­æ”¾) ç«¯å£ï¼</p>
<ul>
<li>Ubuntu: <code>sudo ufw allow 1935 &amp;&amp; sudo ufw allow 80</code></li>
<li>Windows: é˜²ç«å¢™é«˜çº§è®¾ç½® -&gt; å…¥ç«™è§„åˆ™ -&gt; æ–°å»ºè§„åˆ™ -&gt; ç«¯å£ -&gt; TCP 1935, 80ã€‚</li>
</ul>
</blockquote>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img7@main/2026/01/17/1768641500793-fd6ef477-1d0e-4daf-9139-3ae603d4cba4.png" alt="Windows é˜²ç«å¢™ç«¯å£æ”¾è¡Œè®¾ç½®" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-13">å®æˆ˜æ¨æµï¼šOBS è¿æ¥æœåŠ¡å™¨</h2>
<p>æ ¹æ®å®é™…æƒ…å†µæ›¿æ¢æ‰ä¸‹æ–¹çš„æœåŠ¡å™¨ï¼Œæˆ‘è¿™é‡Œçš„IPæ˜¯ <code>192.168.1.3</code>ã€‚</p>
<h3 data-id="heading-14">OBS è®¾ç½®</h3>
<ol>
<li>
<p><strong>æ¥æº</strong>ï¼šæ·»åŠ â€œæ˜¾ç¤ºå™¨é‡‡é›†â€æˆ–â€œè§†é¢‘æ•è·è®¾å¤‡â€ã€‚</p>
</li>
<li>
<p><strong>è®¾ç½® -&gt; ç›´æ’­</strong>ï¼š</p>
<ul>
<li>æœåŠ¡ï¼šè‡ªå®šä¹‰</li>
<li><strong>æœåŠ¡å™¨</strong>ï¼š<code>rtmp://192.168.1.3/live</code></li>
<li><strong>æ¨æµç </strong>ï¼š<code>test</code> è¿™ä¸ªå¯ä»¥è‡ªå®šä¹‰ï¼Œç›¸å½“äºæˆ¿é—´å·</li>
</ul>
</li>
<li>
<p><strong>è®¾ç½® -&gt; è¾“å‡º</strong>ï¼š</p>
<ul>
<li>ç ç‡ï¼š2000 Kbps (2Mbps) è¶³å¤Ÿæ¸…æ™°ã€‚</li>
<li>è¾“å‡ºæ¨¡å¼-&gt;å…³é”®å¸§é—´éš”ï¼š2 ç§’ã€‚</li>
</ul>
</li>
</ol>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img11@main/2026/01/17/1768641593728-f60addeb-eb1f-48ff-9996-508a67cae21f.png" alt="OBS Studio æ¨æµè®¾ç½®" loading="lazy"/></p>
<h3 data-id="heading-15">ç‚¹å‡»â€œå¼€å§‹æ¨æµâ€</h3>
<p>å¦‚æœ OBS å³ä¸‹è§’æ˜¾ç¤ºâ€œæ­£åœ¨æ¨æµâ€ï¼Œä¸”ç ç‡ä¸æ˜¯ 0ï¼Œæ­å–œä½ ï¼æ•°æ®å·²ç»å‘å‡ºå»äº†ï¼</p>
<hr/>
<h2 data-id="heading-16">å®æˆ˜æ‹‰æµï¼šä¸‰ç§æ–¹å¼çœ‹ç›´æ’­</h2>
<p>æ¨ä¸Šå»äº†ï¼Œæ€ä¹ˆçœ‹ï¼Ÿæœ‰ä¸‰ç§ä¸»æµåè®®ã€‚</p>

































<table><thead><tr><th align="left">åè®®</th><th align="left">URL æ ¼å¼</th><th align="left">å»¶è¿Ÿ</th><th align="left">ä¼˜ç‚¹</th><th align="left">ç¼ºç‚¹</th></tr></thead><tbody><tr><td align="left"><strong>RTMP</strong></td><td align="left"><code>rtmp://ip/live/test</code></td><td align="left">1-3 ç§’</td><td align="left">æä½å»¶è¿Ÿ</td><td align="left">æµè§ˆå™¨ä¸æ”¯æŒï¼Œéœ€æ’­æ”¾å™¨</td></tr><tr><td align="left"><strong>HTTP-FLV</strong></td><td align="left"><code>http://ip/live/test.flv</code></td><td align="left">2-5 ç§’</td><td align="left">ä½å»¶è¿Ÿï¼Œç½‘é¡µå¯æ’­</td><td align="left">éœ€ flv.js æ”¯æŒ</td></tr><tr><td align="left"><strong>HLS</strong></td><td align="left"><code>http://ip/hls/test.m3u8</code></td><td align="left">10-30 ç§’</td><td align="left">å…¼å®¹æ€§æœ€å¥½</td><td align="left">å»¶è¿Ÿé«˜</td></tr></tbody></table>
<h4 data-id="heading-17">æ–¹å¼ä¸€ï¼šVLC æ’­æ”¾</h4>
<ol>
<li>æ‰“å¼€ VLC -&gt; åª’ä½“ -&gt; æ‰“å¼€ç½‘ç»œä¸²æµã€‚</li>
<li>è¾“å…¥ï¼š<code>rtmp://ä½ çš„IP/live/test</code></li>
<li>å›è½¦ï¼Œç”»é¢å‡ºæ¥äº†ï¼</li>
</ol>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img14@main/2026/01/17/1768641618230-542da0a1-35b1-4b89-84fc-dc2336018b14.png" alt="VLC æ’­æ”¾å™¨æˆåŠŸæ’­æ”¾ç”»é¢" loading="lazy"/></p>
<h4 data-id="heading-18">æ–¹å¼äºŒï¼šæµè§ˆå™¨æ’­æ”¾ HLSï¼ˆSafari/Edgeï¼‰</h4>
<p>ç›´æ¥åœ¨åœ°å€æ è¾“å…¥ï¼š<code>http://ä½ çš„IP/hls/test.m3u8</code>
Safari å’Œ Edge åŸç”Ÿæ”¯æŒ HLSï¼Œç›´æ¥å°±èƒ½çœ‹ã€‚Chrome éœ€è¦æ’ä»¶ã€‚</p>
<h4 data-id="heading-19">æ–¹å¼ä¸‰ï¼šç½‘é¡µæ’­æ”¾ HTTP-FLV</h4>
<p>è¿™é‡Œæ¨èEZåœ¨çº¿å·¥å…·ç½‘çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fezwebtools.net%2Frtmp-player" target="_blank" title="https://ezwebtools.net/rtmp-player" ref="nofollow noopener noreferrer">FLV/RTMPåœ¨çº¿æ’­æ”¾å™¨</a>ï¼Œå…å»å¼€å‘çš„éº»çƒ¦ã€‚éå¸¸é€‚åˆRTMPç›´æ’­æµæµ‹è¯•ï¼Œæ”¯æŒRTMPå’ŒFLVæ ¼å¼ï¼Œå®æ—¶ç›´æ’­æµä¿¡æ¯ã€æˆªå›¾ç­‰åŠŸèƒ½ã€‚</p>
<p>å¦‚æœæƒ³è‡ªå·±ç¼–å†™ï¼Œå¯ä»¥å‚è€ƒBç«™å¼€æºçš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FBilibili%2Fflv.js" target="_blank" title="https://github.com/Bilibili/flv.js" ref="nofollow noopener noreferrer">flv.js</a>ã€‚
åˆ›å»ºä¸€ä¸ª <code>index.html</code> æ–‡ä»¶ï¼Œè´´å…¥ä»¥ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Nginx-RTMP ç›´æ’­<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/flv.js/1.5.0/flv.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>æˆ‘çš„ç›´æ’­é—´<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"videoElement"</span> <span class="hljs-attr">controls</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"800"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"450"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">if</span> (flvjs.<span class="hljs-title function_">isSupported</span>()) {
            <span class="hljs-keyword">var</span> videoElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'videoElement'</span>);
            <span class="hljs-keyword">var</span> flvPlayer = flvjs.<span class="hljs-title function_">createPlayer</span>({
                <span class="hljs-attr">type</span>: <span class="hljs-string">'flv'</span>,
                <span class="hljs-attr">url</span>: <span class="hljs-string">'http://ä½ çš„IP/live/test.flv'</span> <span class="hljs-comment">// æ³¨æ„è¿™é‡Œæ˜¯ flv</span>
            });
            flvPlayer.<span class="hljs-title function_">attachMediaElement</span>(videoElement);
            flvPlayer.<span class="hljs-title function_">load</span>();
            flvPlayer.<span class="hljs-title function_">play</span>();
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šä¸Šé¢çš„ <code>nginx.conf</code> é»˜è®¤æ²¡å¼€ flvï¼Œè¦å¼€çš„è¯åœ¨ <code>rtmp -&gt; application live</code> é‡ŒåŠ ä¸€å¥ <code>allow publish 127.0.0.1;</code> ç„¶ååœ¨ <code>http server</code> é‡ŒåŠ ï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx">location /live {
    flv_live on;
    chunked_transfer_encoding on;
    add_header 'Access-Control-Allow-Origin' '*';
}
</code></pre>
</blockquote>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img10@main/2026/01/17/1768641638542-bd3ec67f-2a7a-4899-8dd7-3ba3db861467.png" alt="FLV/RTMPåœ¨çº¿æ’­æ”¾å™¨" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-20">è¿›é˜¶ï¼šå†…ç½‘ç©¿é€ï¼Œè®©å¤–ç½‘è®¿é—®</h2>
<p>å¦‚æœä½ æ˜¯åœ¨è‡ªå·±ç”µè„‘ä¸Šæ­çš„ï¼ˆWindowsï¼‰ï¼Œæœ‹å‹æƒ³çœ‹æ€ä¹ˆåŠï¼Ÿä½ æ²¡æœ‰å…¬ç½‘ IPã€‚</p>
<p>æœ‰ä¸‰ç§æ–¹æ¡ˆï¼š</p>
<ol>
<li><strong>èŠ±ç”Ÿå£³/Frp</strong>ï¼šç®€å•ï¼Œä½†å…è´¹ç‰ˆé™é€Ÿã€‚</li>
<li><strong>Zerotier/Hamachi</strong>ï¼šç»„å»ºè™šæ‹Ÿå±€åŸŸç½‘ï¼Œæœ‹å‹è£…ä¸ªå®¢æˆ·ç«¯ï¼Œç”¨å†…ç½‘ IP è®¿é—®ã€‚</li>
<li><strong>Ngrok</strong>ï¼šå›½å¤–å·¥å…·ï¼Œç¨³å®šä½†è¦é’±ã€‚</li>
</ol>
<p><strong>æœ€å‚»ç“œçš„æ–¹æ³•ï¼ˆè·¯ç”±å™¨ç«¯å£æ˜ å°„ï¼‰ï¼š</strong>
å¦‚æœä½ æœ‰å…‰çŒ«æ‹¨å·çš„å…¬ç½‘ IPï¼š</p>
<ol>
<li>ç™»å½•è·¯ç”±å™¨ï¼ˆ192.168.1.1ï¼‰ã€‚</li>
<li>æ‰¾åˆ°â€œè™šæ‹ŸæœåŠ¡å™¨â€æˆ–â€œç«¯å£è½¬å‘â€ã€‚</li>
<li>æ·»åŠ ä¸¤æ¡ï¼š
<ul>
<li>å¤–éƒ¨ç«¯å£ 1935 -&gt; å†…éƒ¨ IPï¼ˆä½ ç”µè„‘IPï¼‰ -&gt; å†…éƒ¨ç«¯å£ 1935</li>
<li>å¤–éƒ¨ç«¯å£ 80 -&gt; å†…éƒ¨ IPï¼ˆä½ ç”µè„‘IPï¼‰ -&gt; å†…éƒ¨ç«¯å£ 80</li>
</ul>
</li>
<li>æ¨æµåœ°å€å¡«ä½ çš„<strong>å…¬ç½‘ IP</strong> å³å¯ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-21">å¸¸è§é—®é¢˜æ’æŸ¥</h2>






























<table><thead><tr><th align="left">ç°è±¡</th><th align="left">åŸå› </th><th align="left">è§£å†³æ–¹æ³•</th></tr></thead><tbody><tr><td align="left">OBS æ¨æµæŠ¥é”™ <code>connection refused</code></td><td align="left">é˜²ç«å¢™æŒ¡äº† / Nginxæ²¡å¼€</td><td align="left">æ£€æŸ¥é˜²ç«å¢™å’Œè¿›ç¨‹</td></tr><tr><td align="left">OBS æ¨æµæˆåŠŸï¼ŒVLC é»‘å±</td><td align="left">ç¼–ç æ ¼å¼ä¸å¯¹</td><td align="left">OBS è§†é¢‘ç¼–ç æ”¹ä¸º H.264ï¼ŒéŸ³é¢‘æ”¹ä¸º AAC</td></tr><tr><td align="left">å…¬ç½‘æ— æ³•è®¿é—®ï¼Œå†…ç½‘å¯ä»¥</td><td align="left">æ²¡åšç«¯å£æ˜ å°„ / æ²¡å…¬ç½‘IP</td><td align="left">å»è·¯ç”±å™¨åšæ˜ å°„ï¼Œæˆ–ç”¨ Frp</td></tr><tr><td align="left">HLS æ’­æ”¾ 404</td><td align="left">Nginx é…ç½®è·¯å¾„ä¸å¯¹</td><td align="left">æ£€æŸ¥ <code>hls_path</code> å’Œ <code>location /hls</code> çš„ <code>root</code> æ˜¯å¦å¯¹åº”</td></tr></tbody></table>
<p><strong>æŸ¥çœ‹æ—¥å¿—æ˜¯ä¸ªå¥½ä¹ æƒ¯ï¼</strong></p>
<ul>
<li>Ubuntu: <code>tail -f /usr/local/nginx/logs/error.log</code></li>
<li>Windows: <code>logs/error.log</code></li>
</ul>
<hr/>
<h2 data-id="heading-22">æ€»ç»“ä¸å±•æœ›</h2>
<p>æ­å–œä½ ï¼ä½ å·²ç»æŒæ¡äº†æµåª’ä½“æœåŠ¡å™¨æœ€æ ¸å¿ƒçš„æ­å»ºæŠ€æœ¯ã€‚</p>
<p><strong>å›é¡¾ä¸€ä¸‹æˆ‘ä»¬åšäº†ä»€ä¹ˆï¼š</strong></p>
<ol>
<li>æå®šäº†Ubuntu / Windows Nginx-RTMPæ¨¡å—çš„ç¯å¢ƒæ­å»ºã€‚</li>
<li>å¯¹é…ç½®æ–‡ä»¶ <code>nginx.conf</code>è¿›è¡Œäº†RTMPæ¨æµçš„é…ç½®ã€‚</li>
<li>æ‰“é€šäº† OBS -&gt; Nginx -&gt; VLC çš„é“¾è·¯ã€‚</li>
</ol>
<p><strong>ä¸‹ä¸€æ­¥å¯ä»¥ç©ä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li><strong>å½•åˆ¶å›æ”¾</strong>ï¼šé…ç½® <code>record all;</code> å’Œ <code>exec_record_done</code> è„šæœ¬ï¼Œå®ç°ç›´æ’­è‡ªåŠ¨å½•åˆ¶å¹¶ä¸Šä¼ åˆ°ç‚¹æ’­ç³»ç»Ÿã€‚</li>
<li><strong>å¤šç ç‡</strong>ï¼šé…ç½® <code>ffmpeg</code> è½¬ç ï¼Œè®©ç”¨æˆ·æ ¹æ®ç½‘é€Ÿé€‰æ‹© 720P/1080Pã€‚</li>
<li><strong>é‰´æƒ</strong>ï¼šé˜²æ­¢åˆ«äººä¹±æ¨æµï¼Œé…ç½® <code>on_publish</code> æ¥å£å›è°ƒéªŒè¯å¯†é’¥ã€‚</li>
<li><strong>WebRTC</strong>ï¼šNginx-RTMP å»¶è¿Ÿè¿˜æ˜¯æœ‰ç‚¹é«˜ï¼Œæƒ³åšè¿éº¦äº’åŠ¨ï¼Ÿå»ç ”ç©¶ ZLMediaKit æˆ– SRSï¼Œå®ƒä»¬åŸç”Ÿæ”¯æŒ WebRTCï¼Œå»¶è¿Ÿèƒ½åˆ° 500ms ä»¥å†…ã€‚</li>
</ul>
<h2 data-id="heading-23">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fezwebtools.net%2Frtmp-player" target="_blank" title="https://ezwebtools.net/rtmp-player" ref="nofollow noopener noreferrer">FLV/RTMPåœ¨çº¿æ’­æ”¾å™¨</a>]</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Farut%2Fnginx-rtmp-module%2Fwiki" target="_blank" title="https://github.com/arut/nginx-rtmp-module/wiki" ref="nofollow noopener noreferrer">Nginx-RTMP Moduleå®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fobsproject.com%2Fwiki%2FStreaming" target="_blank" title="https://obsproject.com/wiki/Streaming" ref="nofollow noopener noreferrer">OBS Studioæ¨æµè®¾ç½®æŒ‡å—</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.videolan.org%2Fvlc%2Fdocumentation%2F" target="_blank" title="https://www.videolan.org/vlc/documentation/" ref="nofollow noopener noreferrer">VLCæ’­æ”¾å™¨ä½¿ç”¨æ•™ç¨‹</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffatedier%2Ffrp" target="_blank" title="https://github.com/fatedier/frp" ref="nofollow noopener noreferrer">Frpå†…ç½‘ç©¿é€å·¥å…·</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å•å®ä¾‹å¤šMCPèšåˆæœåŠ¡ï¼šä¸¤ç§å®ç°æ–¹æ¡ˆæ·±åº¦å¯¹æ¯”]]></title>    <link>https://juejin.cn/post/7596883689826762815</link>    <guid>https://juejin.cn/post/7596883689826762815</guid>    <pubDate>2026-01-19T10:07:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596883689826762815" data-draft-id="7596865421612007478" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å•å®ä¾‹å¤šMCPèšåˆæœåŠ¡ï¼šä¸¤ç§å®ç°æ–¹æ¡ˆæ·±åº¦å¯¹æ¯”"/> <meta itemprop="keywords" content="å‰ç«¯,MCP"/> <meta itemprop="datePublished" content="2026-01-19T10:07:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="betterhyq"/> <meta itemprop="url" content="https://juejin.cn/user/708557910842296"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å•å®ä¾‹å¤šMCPèšåˆæœåŠ¡ï¼šä¸¤ç§å®ç°æ–¹æ¡ˆæ·±åº¦å¯¹æ¯”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/708557910842296/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    betterhyq
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T10:07:06.000Z" title="Mon Jan 19 2026 10:07:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ–¹æ¡ˆ1ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fbetterhyq%2Fhoneycomb-nginx%2F" target="_blank" title="https://github.com/betterhyq/honeycomb-nginx/" ref="nofollow noopener noreferrer">github.com/betterhyq/hâ€¦</a><br/>
æ–¹æ¡ˆ2ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fbetterhyq%2Fhoneycomb%2F" target="_blank" title="https://github.com/betterhyq/honeycomb/" ref="nofollow noopener noreferrer">github.com/betterhyq/hâ€¦</a></p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€å¼•è¨€</h2>
<p>åœ¨ AI åº”ç”¨å¼€å‘ä¸­ï¼ŒModel Context Protocol (MCP) ä½œä¸ºè¿æ¥ AI å·¥å…·ä¸å¤–éƒ¨æœåŠ¡çš„æ ‡å‡†åè®®ï¼Œæ­£å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚ç„¶è€Œï¼Œå½“æˆ‘ä»¬éœ€è¦åŒæ—¶è¿è¡Œå¤šä¸ª MCP æœåŠ¡æ—¶ï¼Œä¼ ç»Ÿçš„å•æœåŠ¡å•ç«¯å£éƒ¨ç½²æ–¹å¼ä¼šå¸¦æ¥è¯¸å¤šé—®é¢˜ï¼š</p>
<ul>
<li><strong>ç«¯å£ç®¡ç†å¤æ‚</strong>ï¼šæ¯ä¸ª MCP æœåŠ¡éœ€è¦å ç”¨ç‹¬ç«‹ç«¯å£ï¼Œéšç€æœåŠ¡æ•°é‡å¢é•¿ï¼Œç«¯å£åˆ†é…å’Œç®¡ç†å˜å¾—ç¹ç</li>
<li><strong>èµ„æºæµªè´¹</strong>ï¼šæ¯ä¸ªæœåŠ¡ç‹¬ç«‹è¿›ç¨‹ï¼Œå†…å­˜å’Œ CPU èµ„æºæ¶ˆè€—è¾ƒå¤§</li>
<li><strong>éƒ¨ç½²ç»´æŠ¤å›°éš¾</strong>ï¼šéœ€è¦ä¸ºæ¯ä¸ªæœåŠ¡å•ç‹¬é…ç½®ã€ç›‘æ§å’Œæ›´æ–°</li>
<li><strong>å®¢æˆ·ç«¯é…ç½®å¤æ‚</strong>ï¼šAI åº”ç”¨éœ€è¦é…ç½®å¤šä¸ªä¸åŒçš„æœåŠ¡åœ°å€å’Œç«¯å£</li>
</ul>
<p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æ¢ç´¢äº†ä¸¤ç§<strong>å•å®ä¾‹å¤šMCPèšåˆæœåŠ¡</strong>çš„å®ç°æ–¹æ¡ˆï¼š<strong>æ–¹æ¡ˆ1ï¼ˆNginxåå‘ä»£ç†ï¼‰<strong>å’Œ</strong>æ–¹æ¡ˆ2ï¼ˆExpressç»Ÿä¸€æœåŠ¡ï¼‰</strong>ã€‚æœ¬æ–‡å°†æ·±å…¥å¯¹æ¯”è¿™ä¸¤ç§æ–¹æ¡ˆçš„æ¶æ„è®¾è®¡ã€å®ç°ç»†èŠ‚ã€ä¼˜ç¼ºç‚¹åŠé€‚ç”¨åœºæ™¯ï¼Œå¸®åŠ©å¼€å‘è€…æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©æœ€åˆé€‚çš„æ–¹æ¡ˆã€‚</p>
<p><strong>æ–‡ç« ä»·å€¼</strong>ï¼š</p>
<ul>
<li>ç†è§£å•å®ä¾‹å¤šMCPèšåˆæœåŠ¡çš„æ ¸å¿ƒè®¾è®¡æ€æƒ³</li>
<li>æŒæ¡ä¸¤ç§ä¸åŒæŠ€æœ¯æ ˆçš„å®ç°æ–¹æ¡ˆ</li>
<li>å­¦ä¼šæ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„æŠ€æœ¯æ–¹æ¡ˆ</li>
<li>äº†è§£ MCP åè®®åœ¨å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨å®è·µ</li>
</ul>
<p><strong>é€‚ç”¨äººç¾¤</strong>ï¼š</p>
<ul>
<li>Node.js åç«¯å¼€å‘å·¥ç¨‹å¸ˆ</li>
<li>AI åº”ç”¨å¼€å‘è€…</li>
<li>ç³»ç»Ÿæ¶æ„å¸ˆ</li>
<li>å¯¹ MCP åè®®æ„Ÿå…´è¶£çš„å¼€å‘è€…</li>
</ul>
<p><strong>å‰ç½®çŸ¥è¯†</strong>ï¼š</p>
<ul>
<li>JavaScript/TypeScript åŸºç¡€</li>
<li>Node.js å’Œ Express æ¡†æ¶</li>
<li>HTTP åè®®å’Œ SSEï¼ˆServer-Sent Eventsï¼‰</li>
<li>Nginx åŸºç¡€é…ç½®</li>
<li>MCP åè®®åŸºæœ¬æ¦‚å¿µ</li>
</ul>
<hr/>
<h2 data-id="heading-1">äºŒã€æ ¸å¿ƒç†è®ºåŸºç¡€</h2>
<h3 data-id="heading-2">2.1 MCP åè®®ç®€ä»‹</h3>
<p>Model Context Protocol (MCP) æ˜¯ç”± Anthropic æå‡ºçš„æ ‡å‡†åè®®ï¼Œç”¨äº AI åº”ç”¨ä¸å¤–éƒ¨å·¥å…·å’ŒæœåŠ¡ä¹‹é—´çš„é€šä¿¡ã€‚MCP æ”¯æŒå¤šç§ä¼ è¾“æ–¹å¼ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>HTTP Stream</strong>ï¼šåŸºäº HTTP çš„æµå¼ä¼ è¾“</li>
<li><strong>SSE (Server-Sent Events)</strong>ï¼šæœåŠ¡å™¨æ¨é€äº‹ä»¶ï¼Œé€‚åˆé•¿è¿æ¥åœºæ™¯</li>
<li><strong>WebSocket</strong>ï¼šåŒå‘é€šä¿¡åè®®</li>
</ul>
<p>MCP çš„æ ¸å¿ƒæ¦‚å¿µåŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>Toolsï¼ˆå·¥å…·ï¼‰</strong>ï¼šå¯è¢« AI è°ƒç”¨çš„åŠŸèƒ½å•å…ƒï¼Œæ¯ä¸ªå·¥å…·åŒ…å«åç§°ã€æè¿°ã€è¾“å…¥/è¾“å‡º Schema</li>
<li><strong>Resourcesï¼ˆèµ„æºï¼‰</strong>ï¼šå¯è¢« AI è®¿é—®çš„æ•°æ®èµ„æº</li>
<li><strong>Promptsï¼ˆæç¤ºï¼‰</strong>ï¼šé¢„å®šä¹‰çš„æç¤ºæ¨¡æ¿</li>
</ul>
<h3 data-id="heading-3">2.2 å•å®ä¾‹å¤šMCPèšåˆæœåŠ¡çš„æ ¸å¿ƒæ€æƒ³</h3>
<p>å•å®ä¾‹å¤šMCPèšåˆæœåŠ¡çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong>åœ¨ä¸€ä¸ªè¿›ç¨‹å®ä¾‹ä¸­åŒæ—¶è¿è¡Œå¤šä¸ª MCP æœåŠ¡ï¼Œé€šè¿‡ç»Ÿä¸€çš„å…¥å£å¯¹å¤–æä¾›æœåŠ¡ï¼Œå®¢æˆ·ç«¯é€šè¿‡æ ‡è¯†ç¬¦ï¼ˆå¦‚ Header å‚æ•°ï¼‰æ¥åŒºåˆ†å’Œè®¿é—®ä¸åŒçš„ MCP æœåŠ¡</strong>ã€‚</p>
<p>è¿™ç§è®¾è®¡çš„ä¼˜åŠ¿ï¼š</p>
<ol>
<li><strong>èµ„æºé«˜æ•ˆ</strong>ï¼šå¤šä¸ªæœåŠ¡å…±äº«åŒä¸€ä¸ªè¿›ç¨‹ï¼Œå‡å°‘å†…å­˜å’Œ CPU å¼€é”€</li>
<li><strong>ç»Ÿä¸€ç®¡ç†</strong>ï¼šé›†ä¸­é…ç½®ã€ç›‘æ§å’Œæ—¥å¿—ç®¡ç†</li>
<li><strong>ç®€åŒ–éƒ¨ç½²</strong>ï¼šåªéœ€éƒ¨ç½²ä¸€ä¸ªæœåŠ¡å®ä¾‹ï¼Œé™ä½è¿ç»´å¤æ‚åº¦</li>
<li><strong>çµæ´»æ‰©å±•</strong>ï¼šå¯ä»¥åŠ¨æ€æ·»åŠ ã€åˆ é™¤æˆ–æ›´æ–° MCP æœåŠ¡</li>
</ol>
<h3 data-id="heading-4">2.3 ä¸¤ç§æ–¹æ¡ˆçš„æŠ€æœ¯è·¯çº¿å¯¹æ¯”</h3>








































<table><thead><tr><th>ç»´åº¦</th><th>æ–¹æ¡ˆ1ï¼šNginxåå‘ä»£ç†</th><th>æ–¹æ¡ˆ2ï¼šExpressç»Ÿä¸€æœåŠ¡</th></tr></thead><tbody><tr><td><strong>æ¶æ„æ¨¡å¼</strong></td><td>åå‘ä»£ç† + å¤šç«¯å£æœåŠ¡</td><td>å•ç«¯å£ + è·¯ç”±åˆ†å‘</td></tr><tr><td><strong>æœåŠ¡éš”ç¦»</strong></td><td>ç‰©ç†éš”ç¦»ï¼ˆç‹¬ç«‹ç«¯å£ï¼‰</td><td>é€»è¾‘éš”ç¦»ï¼ˆå†…å­˜æ˜ å°„ï¼‰</td></tr><tr><td><strong>è·¯ç”±æ–¹å¼</strong></td><td>HTTP Header (<code>X-Target-Port</code>)</td><td>HTTP Header (<code>MCP_ID</code>)</td></tr><tr><td><strong>æœåŠ¡ç®¡ç†</strong></td><td>é™æ€é…ç½®ï¼ˆconfig.jsonï¼‰</td><td>åŠ¨æ€ç®¡ç†ï¼ˆæ•°æ®åº“ï¼‰</td></tr><tr><td><strong>é…ç½®æ–¹å¼</strong></td><td>æ–‡ä»¶é…ç½®</td><td>å¯è§†åŒ–ç•Œé¢ + API</td></tr><tr><td><strong>æ‰©å±•æ€§</strong></td><td>éœ€è¦é‡å¯æœåŠ¡</td><td>æ”¯æŒçƒ­æ›´æ–°</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€æ–¹æ¡ˆ1ï¼šNginxåå‘ä»£ç†æ–¹æ¡ˆ</h2>
<h3 data-id="heading-6">3.1 æ¶æ„è®¾è®¡</h3>
<p>æ–¹æ¡ˆ1é‡‡ç”¨ <strong>Nginx åå‘ä»£ç† + å¤šç«¯å£ MCP æœåŠ¡</strong> çš„æ¶æ„ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">å®¢æˆ·ç«¯è¯·æ±‚
    â†“
Nginx (ç«¯å£<span class="hljs-number">80</span>)
    â†“ (æ ¹æ® X-Target-Port header)
åç«¯ MCP æœåŠ¡é›†ç¾¤
    â”œâ”€â”€ æœåŠ¡<span class="hljs-number">1</span> (ç«¯å£<span class="hljs-number">8080</span>)
    â”œâ”€â”€ æœåŠ¡<span class="hljs-number">2</span> (ç«¯å£<span class="hljs-number">8081</span>)
    â”œâ”€â”€ æœåŠ¡<span class="hljs-number">3</span> (ç«¯å£<span class="hljs-number">8082</span>)
    â””â”€â”€ æœåŠ¡<span class="hljs-number">4</span> (ç«¯å£<span class="hljs-number">8083</span>)
</code></pre>
<p><strong>æ ¸å¿ƒæµç¨‹</strong>ï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ° Nginxï¼ˆç«¯å£80ï¼‰ï¼Œåœ¨ Header ä¸­æºå¸¦ <code>X-Target-Port</code> æŒ‡å®šç›®æ ‡ç«¯å£</li>
<li>Nginx æ ¹æ® <code>X-Target-Port</code> åŠ¨æ€è·¯ç”±åˆ°å¯¹åº”çš„åç«¯ MCP æœåŠ¡</li>
<li>åç«¯æœåŠ¡å¤„ç†è¯·æ±‚å¹¶è¿”å›å“åº”</li>
</ol>
<h3 data-id="heading-7">3.2 ç¯å¢ƒå‡†å¤‡</h3>
<p><strong>è½¯ç¡¬ä»¶ç¯å¢ƒ</strong>ï¼š</p>
<ul>
<li>Node.js &gt;= 22.0.0</li>
<li>pnpm &gt;= 8.0.0</li>
<li>Nginx &gt;= 1.21</li>
<li>Dockerï¼ˆå¯é€‰ï¼Œç”¨äºå®¹å™¨åŒ–éƒ¨ç½²ï¼‰</li>
</ul>
<p><strong>é¡¹ç›®ä¾èµ–</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"fastmcp"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^0.1.0"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-8">3.3 æ ¸å¿ƒåŠŸèƒ½å®ç°</h3>
<h4 data-id="heading-9">æ¨¡å—1ï¼šMCP æœåŠ¡å¯åŠ¨ç®¡ç†</h4>
<p><strong>å®ç°ç›®æ ‡</strong>ï¼šæ ¹æ®é…ç½®æ–‡ä»¶åŠ¨æ€å¯åŠ¨å¤šä¸ªç‹¬ç«‹çš„ MCP æœåŠ¡å®ä¾‹ï¼Œæ¯ä¸ªæœåŠ¡è¿è¡Œåœ¨ç‹¬ç«‹ç«¯å£ã€‚</p>
<p><strong>æ ¸å¿ƒä»£ç </strong>ï¼ˆ<code>src/index.ts</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> config <span class="hljs-keyword">from</span> <span class="hljs-string">"../config.json"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">FastMCP</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"fastmcp"</span>;
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">"node:path"</span>;
<span class="hljs-keyword">import</span> { fileURLToPath } <span class="hljs-keyword">from</span> <span class="hljs-string">"node:url"</span>;

<span class="hljs-keyword">const</span> __filename = <span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>);
<span class="hljs-keyword">const</span> __dirname = path.<span class="hljs-title function_">dirname</span>(__filename);

<span class="hljs-keyword">const</span> <span class="hljs-title function_">start</span> = (<span class="hljs-params"/>) =&gt; {
  config.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">async</span> (mcpConfig) =&gt; {
    <span class="hljs-comment">// åˆ›å»º FastMCP æœåŠ¡å™¨å®ä¾‹</span>
    <span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FastMCP</span>({
      <span class="hljs-attr">name</span>: mcpConfig.<span class="hljs-property">name</span>,
      <span class="hljs-attr">version</span>: mcpConfig.<span class="hljs-property">version</span> <span class="hljs-keyword">as</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">number</span>}</span>.<span class="hljs-subst">${<span class="hljs-built_in">number</span>}</span>.<span class="hljs-subst">${<span class="hljs-built_in">number</span>}</span>`</span>,
    });
    
    <span class="hljs-comment">// åŠ¨æ€å¯¼å…¥æœåŠ¡æ¨¡å—å¹¶æ³¨å†Œå·¥å…·</span>
    <span class="hljs-keyword">const</span> { <span class="hljs-attr">default</span>: registerTools } = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(
      path.<span class="hljs-title function_">join</span>(__dirname, mcpConfig.<span class="hljs-property">entry</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-string">".ts"</span>, <span class="hljs-string">".mjs"</span>))
    );
    <span class="hljs-title function_">registerTools</span>(server);
    
    <span class="hljs-comment">// å¯åŠ¨æœåŠ¡ï¼Œç›‘å¬æŒ‡å®šç«¯å£</span>
    server.<span class="hljs-title function_">start</span>({
      <span class="hljs-attr">transportType</span>: <span class="hljs-string">"httpStream"</span>,
      <span class="hljs-attr">httpStream</span>: {
        <span class="hljs-attr">host</span>: <span class="hljs-string">"0.0.0.0"</span>,
        <span class="hljs-attr">port</span>: mcpConfig.<span class="hljs-property">port</span>,  <span class="hljs-comment">// æ¯ä¸ªæœåŠ¡ç‹¬ç«‹ç«¯å£</span>
      },
    });
  });
};

<span class="hljs-title function_">start</span>();
</code></pre>
<p><strong>ä»£ç è§£æ</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>FastMCP</code> æ¡†æ¶ç®€åŒ– MCP æœåŠ¡å¼€å‘</li>
<li>é€šè¿‡ <code>config.json</code> é…ç½®æ–‡ä»¶é©±åŠ¨ï¼Œæ”¯æŒåŠ¨æ€åŠ è½½æœåŠ¡æ¨¡å—</li>
<li>æ¯ä¸ªæœåŠ¡å®ä¾‹ç‹¬ç«‹ç›‘å¬ä¸åŒç«¯å£ï¼Œå®ç°ç‰©ç†éš”ç¦»</li>
<li>ä½¿ç”¨åŠ¨æ€å¯¼å…¥ï¼ˆ<code>import()</code>ï¼‰å®ç°æ¨¡å—çš„æŒ‰éœ€åŠ è½½</li>
</ul>
<p><strong>é…ç½®æ–‡ä»¶</strong>ï¼ˆ<code>config.json</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">[</span>
  <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Common MCP Server"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"entry"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"servers/_common/index.ts"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"port"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8080</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Temperature Conversion MCP Server"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"entry"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"servers/temperatureConversion/index.ts"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"port"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8081</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span>
</code></pre>
<h4 data-id="heading-10">æ¨¡å—2ï¼šNginx åå‘ä»£ç†é…ç½®</h4>
<p><strong>å®ç°ç›®æ ‡</strong>ï¼šé…ç½® Nginx æ ¹æ® <code>X-Target-Port</code> header åŠ¨æ€è·¯ç”±è¯·æ±‚åˆ°å¯¹åº”çš„åç«¯æœåŠ¡ç«¯å£ã€‚</p>
<p><strong>æ ¸å¿ƒé…ç½®</strong>ï¼ˆ<code>docker/nginx.conf</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx">http {
    # ä½¿ç”¨ map æŒ‡ä»¤æ ¹æ® X-Target-Port header åŠ¨æ€æ„å»ºåç«¯åœ°å€
    map $http_x_target_port $backend_upstream {
        default "http://0.0.0.0:8080";  # é»˜è®¤ç«¯å£
        "~^(\d+)$" "http://0.0.0.0:$1";  # å¦‚æœ X-Target-Port æ˜¯æ•°å­—ï¼Œä½¿ç”¨è¯¥ç«¯å£
    }

    server {
        listen 80;
        server_name _;

        location / {
            # ä½¿ç”¨åŠ¨æ€æ„å»ºçš„åç«¯åœ°å€
            proxy_pass $backend_upstream;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
    
            # SSE (Server-Sent Events) é…ç½®
            proxy_http_version 1.1;
            proxy_buffering off;  # å…³é—­ç¼“å†²ï¼Œæ”¯æŒæµå¼ä¼ è¾“
            proxy_cache off;
            proxy_set_header Connection "keep-alive"; 
            proxy_read_timeout 86400s;  # é•¿è¿æ¥è¶…æ—¶æ—¶é—´
            proxy_send_timeout 60s;
        }
    }
}
</code></pre>
<p><strong>é…ç½®è§£æ</strong>ï¼š</p>
<ul>
<li><code>map</code> æŒ‡ä»¤ï¼šæ ¹æ® <code>$http_x_target_port</code>ï¼ˆNginx è‡ªåŠ¨å°† Header ä¸­çš„ <code>-</code> è½¬æ¢ä¸º <code>_</code>ï¼‰åŠ¨æ€æ„å»ºåç«¯åœ°å€</li>
<li><code>proxy_pass $backend_upstream</code>ï¼šä½¿ç”¨åŠ¨æ€å˜é‡è¿›è¡Œåå‘ä»£ç†</li>
<li>SSE é…ç½®ï¼šå…³é—­ç¼“å†²ã€è®¾ç½®é•¿è¿æ¥è¶…æ—¶ï¼Œç¡®ä¿æµå¼ä¼ è¾“æ­£å¸¸å·¥ä½œ</li>
</ul>
<p><strong>æ•ˆæœéªŒè¯</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æµ‹è¯•æœåŠ¡1ï¼ˆç«¯å£8080ï¼‰</span>
curl -H <span class="hljs-string">"X-Target-Port: 8080"</span> http://localhost/sse

<span class="hljs-comment"># æµ‹è¯•æœåŠ¡2ï¼ˆç«¯å£8081ï¼‰</span>
curl -H <span class="hljs-string">"X-Target-Port: 8081"</span> http://localhost/sse
</code></pre>
<h4 data-id="heading-11">æ¨¡å—3ï¼šMCP æœåŠ¡å·¥å…·æ³¨å†Œ</h4>
<p><strong>å®ç°ç›®æ ‡</strong>ï¼šåœ¨æ¯ä¸ªæœåŠ¡æ¨¡å—ä¸­æ³¨å†Œå…·ä½“çš„å·¥å…·å‡½æ•°ã€‚</p>
<p><strong>ç¤ºä¾‹ä»£ç </strong>ï¼ˆ<code>servers/temperatureConversion/index.ts</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">FastMCP</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"fastmcp"</span>;
<span class="hljs-keyword">import</span> { z } <span class="hljs-keyword">from</span> <span class="hljs-string">"zod"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">registerTools</span>(<span class="hljs-params">server: FastMCP</span>) {
  <span class="hljs-comment">// æ³¨å†Œæ¸©åº¦è½¬æ¢å·¥å…·</span>
  server.<span class="hljs-title function_">tool</span>(
    <span class="hljs-string">"convert_temperature"</span>,
    <span class="hljs-string">"å°†æ¸©åº¦åœ¨ä¸åŒå•ä½ä¹‹é—´è½¬æ¢ï¼ˆæ‘„æ°åº¦ã€åæ°åº¦ã€å¼€å°”æ–‡ï¼‰"</span>,
    {
      <span class="hljs-attr">temperature</span>: z.<span class="hljs-title function_">number</span>().<span class="hljs-title function_">describe</span>(<span class="hljs-string">"è¦è½¬æ¢çš„æ¸©åº¦å€¼"</span>),
      <span class="hljs-attr">from</span>: z.<span class="hljs-title function_">enum</span>([<span class="hljs-string">"celsius"</span>, <span class="hljs-string">"fahrenheit"</span>, <span class="hljs-string">"kelvin"</span>]).<span class="hljs-title function_">describe</span>(<span class="hljs-string">"æºæ¸©åº¦å•ä½"</span>),
      <span class="hljs-attr">to</span>: z.<span class="hljs-title function_">enum</span>([<span class="hljs-string">"celsius"</span>, <span class="hljs-string">"fahrenheit"</span>, <span class="hljs-string">"kelvin"</span>]).<span class="hljs-title function_">describe</span>(<span class="hljs-string">"ç›®æ ‡æ¸©åº¦å•ä½"</span>),
    },
    <span class="hljs-keyword">async</span> ({ temperature, <span class="hljs-keyword">from</span>, to }) =&gt; {
      <span class="hljs-comment">// è½¬æ¢é€»è¾‘</span>
      <span class="hljs-keyword">let</span> celsius = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">from</span> === <span class="hljs-string">"celsius"</span>) celsius = temperature;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">from</span> === <span class="hljs-string">"fahrenheit"</span>) celsius = (temperature - <span class="hljs-number">32</span>) * <span class="hljs-number">5</span> / <span class="hljs-number">9</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">from</span> === <span class="hljs-string">"kelvin"</span>) celsius = temperature - <span class="hljs-number">273.15</span>;

      <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">if</span> (to === <span class="hljs-string">"celsius"</span>) result = celsius;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (to === <span class="hljs-string">"fahrenheit"</span>) result = celsius * <span class="hljs-number">9</span> / <span class="hljs-number">5</span> + <span class="hljs-number">32</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (to === <span class="hljs-string">"kelvin"</span>) result = celsius + <span class="hljs-number">273.15</span>;

      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">content</span>: [
          {
            <span class="hljs-attr">type</span>: <span class="hljs-string">"text"</span>,
            <span class="hljs-attr">text</span>: <span class="hljs-string">`<span class="hljs-subst">${temperature}</span>Â°<span class="hljs-subst">${<span class="hljs-keyword">from</span>}</span> = <span class="hljs-subst">${result.toFixed(<span class="hljs-number">2</span>)}</span>Â°<span class="hljs-subst">${to}</span>`</span>,
          },
        ],
      };
    }
  );
}
</code></pre>
<h3 data-id="heading-12">3.4 å¸¸è§é—®é¢˜&amp;è¸©å‘æŒ‡å—</h3>
<p><strong>é—®é¢˜1ï¼šNginx 502 Bad Gateway</strong></p>
<p><strong>ç°è±¡</strong>ï¼šå®¢æˆ·ç«¯è¯·æ±‚è¿”å› 502 é”™è¯¯</p>
<p><strong>åŸå› </strong>ï¼š</p>
<ul>
<li>åç«¯ MCP æœåŠ¡æœªå¯åŠ¨</li>
<li>ç«¯å£é…ç½®é”™è¯¯</li>
<li>Nginx æ— æ³•è¿æ¥åˆ°åç«¯æœåŠ¡</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œ</span>
lsof -i:8080
lsof -i:8081

<span class="hljs-comment"># æ£€æŸ¥ Nginx é…ç½®è¯­æ³•</span>
nginx -t

<span class="hljs-comment"># æŸ¥çœ‹ Nginx é”™è¯¯æ—¥å¿—</span>
<span class="hljs-built_in">tail</span> -f /var/log/nginx/error.log
</code></pre>
<p><strong>é—®é¢˜2ï¼šSSE è¿æ¥æ–­å¼€</strong></p>
<p><strong>ç°è±¡</strong>ï¼šSSE è¿æ¥å»ºç«‹åå¾ˆå¿«æ–­å¼€</p>
<p><strong>åŸå› </strong>ï¼šNginx é»˜è®¤çš„ <code>proxy_read_timeout</code> è¿‡çŸ­</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šåœ¨ Nginx é…ç½®ä¸­å¢åŠ è¶…æ—¶æ—¶é—´ï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx">proxy_read_timeout 86400s;  # 24å°æ—¶
proxy_send_timeout 60s;
</code></pre>
<p><strong>é—®é¢˜3ï¼šç«¯å£å†²çª</strong></p>
<p><strong>ç°è±¡</strong>ï¼šæœåŠ¡å¯åŠ¨å¤±è´¥ï¼Œæç¤ºç«¯å£è¢«å ç”¨</p>
<p><strong>åŸå› </strong>ï¼šå¤šä¸ªæœåŠ¡é…ç½®äº†ç›¸åŒç«¯å£</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>æ£€æŸ¥ <code>config.json</code> ç¡®ä¿æ¯ä¸ªæœåŠ¡ç«¯å£å”¯ä¸€</li>
<li>ä½¿ç”¨ <code>lsof -i:ç«¯å£å·</code> æŸ¥æ‰¾å ç”¨è¿›ç¨‹å¹¶å…³é—­</li>
</ul>
<hr/>
<h2 data-id="heading-13">å››ã€æ–¹æ¡ˆ2ï¼šExpressç»Ÿä¸€æœåŠ¡æ–¹æ¡ˆ</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6af9add5174446cd8c466769cec5646e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYmV0dGVyaHlx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422025&amp;x-signature=cTpcBUJz8dSMTabQvv3IbttGVn4%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-14">4.1 æ¶æ„è®¾è®¡</h3>
<p>æ–¹æ¡ˆ2é‡‡ç”¨ <strong>Express å•ç«¯å£ + å†…å­˜æ˜ å°„ç®¡ç†</strong> çš„æ¶æ„ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">å®¢æˆ·ç«¯è¯·æ±‚
    â†“
Express æœåŠ¡å™¨ (ç«¯å£<span class="hljs-number">3002</span>)
    â†“ (æ ¹æ® MCP_ID header)
MCP æœåŠ¡ç®¡ç†å™¨
    â†“
Map&lt;configId, McpHandlers&gt;
    â”œâ”€â”€ æœåŠ¡<span class="hljs-number">1</span> (ID: <span class="hljs-number">1</span>)
    â”œâ”€â”€ æœåŠ¡<span class="hljs-number">2</span> (ID: <span class="hljs-number">2</span>)
    â”œâ”€â”€ æœåŠ¡<span class="hljs-number">3</span> (ID: <span class="hljs-number">3</span>)
    â””â”€â”€ æœåŠ¡<span class="hljs-number">4</span> (ID: <span class="hljs-number">4</span>)
    â†“
SQL<span class="hljs-selector-class">.js</span> æ•°æ®åº“ (é…ç½®æŒä¹…åŒ–)
</code></pre>
<p><strong>æ ¸å¿ƒæµç¨‹</strong>ï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ° Express æœåŠ¡å™¨ï¼ˆç«¯å£3002ï¼‰ï¼Œåœ¨ Header ä¸­æºå¸¦ <code>MCP_ID</code> æŒ‡å®šæœåŠ¡ID</li>
<li>Express è·¯ç”±å¤„ç†å™¨è§£æ <code>MCP_ID</code>ï¼Œä»å†…å­˜æ˜ å°„è¡¨ï¼ˆ<code>Map&lt;configId, McpHandlers&gt;</code>ï¼‰ä¸­è·å–å¯¹åº”çš„ handlers</li>
<li>è°ƒç”¨å¯¹åº”çš„ MCP handler å¤„ç†è¯·æ±‚å¹¶è¿”å›å“åº”</li>
<li>é…ç½®ä¿¡æ¯å­˜å‚¨åœ¨ SQL.js æ•°æ®åº“ä¸­ï¼Œæ”¯æŒåŠ¨æ€åˆ›å»ºã€æ›´æ–°å’Œåˆ é™¤</li>
</ol>
<h3 data-id="heading-15">4.2 ç¯å¢ƒå‡†å¤‡</h3>
<p><strong>è½¯ç¡¬ä»¶ç¯å¢ƒ</strong>ï¼š</p>
<ul>
<li>Node.js &gt;= 24.11.1</li>
<li>pnpm &gt;= 10.25.0</li>
<li>SQL.jsï¼ˆå†…ç½®ï¼Œæ— éœ€é¢å¤–æ•°æ®åº“æœåŠ¡ï¼‰</li>
</ul>
<p><strong>é¡¹ç›®ä¾èµ–</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"@modelcontextprotocol/sdk"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^1.0.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"express"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^5.0.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"express-mcp-handler"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^1.0.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"sql.js"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^1.10.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"kysely"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^0.27.0"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-16">4.3 æ ¸å¿ƒåŠŸèƒ½å®ç°</h3>
<h4 data-id="heading-17">æ¨¡å—1ï¼šMCP æœåŠ¡åŠ¨æ€ç®¡ç†</h4>
<p><strong>å®ç°ç›®æ ‡</strong>ï¼šä»æ•°æ®åº“åŠ è½½é…ç½®ï¼ŒåŠ¨æ€åˆ›å»º MCP æœåŠ¡å®ä¾‹ï¼Œå¹¶ç»´æŠ¤å†…å­˜æ˜ å°„è¡¨ã€‚</p>
<p><strong>æ ¸å¿ƒä»£ç </strong>ï¼ˆ<code>packages/honeycomb-server/src/mcp.ts</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">McpServer</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/server/mcp.js"</span>;
<span class="hljs-keyword">import</span> { sseHandlers } <span class="hljs-keyword">from</span> <span class="hljs-string">"express-mcp-handler"</span>;
<span class="hljs-keyword">import</span> { z } <span class="hljs-keyword">from</span> <span class="hljs-string">"zod"</span>;

<span class="hljs-comment">/**
 * æ‰¹é‡åˆ›å»º MCP æœåŠ¡å¹¶è¿”å› handlers æ˜ å°„
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createMcpServices</span>(<span class="hljs-params"/>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">number</span>, <span class="hljs-title class_">McpHandlers</span>&gt;&gt; {
  <span class="hljs-keyword">const</span> databaseClient = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getDatabaseClient</span>();
  <span class="hljs-comment">// ä»æ•°æ®åº“åŠ è½½æ‰€æœ‰é…ç½®ï¼ˆåŒ…å«å…³è”çš„å·¥å…·ï¼‰</span>
  <span class="hljs-keyword">const</span> allConfigsWithTools = <span class="hljs-keyword">await</span> databaseClient.<span class="hljs-title function_">getAllConfigsWithTools</span>();

  <span class="hljs-keyword">const</span> handlersMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">number</span>, <span class="hljs-title class_">McpHandlers</span>&gt;();

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> config <span class="hljs-keyword">of</span> allConfigsWithTools) {
    <span class="hljs-comment">// åªåˆ›å»ºçŠ¶æ€ä¸º RUNNING çš„æœåŠ¡</span>
    <span class="hljs-keyword">if</span> (config.<span class="hljs-property">status</span> !== <span class="hljs-title class_">StatusEnum</span>.<span class="hljs-property">RUNNING</span>) {
      <span class="hljs-keyword">continue</span>;
    }

    <span class="hljs-comment">// åˆ›å»º MCP æœåŠ¡å™¨å®ä¾‹</span>
    <span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> <span class="hljs-title class_">McpServer</span>({
      <span class="hljs-attr">name</span>: config.<span class="hljs-property">name</span>,
      <span class="hljs-attr">version</span>: config.<span class="hljs-property">version</span>,
      <span class="hljs-attr">description</span>: config.<span class="hljs-property">description</span>,
    });

    <span class="hljs-comment">// æ‰¹é‡æ³¨å†Œå·¥å…·</span>
    config.<span class="hljs-property">tools</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">tool</span>) =&gt;</span> {
      <span class="hljs-comment">// è§£æ JSON Schema å¹¶è½¬æ¢ä¸º Zod schema</span>
      <span class="hljs-keyword">const</span> inputSchemaObj = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(tool.<span class="hljs-property">input_schema</span>);
      <span class="hljs-keyword">const</span> outputSchemaObj = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(tool.<span class="hljs-property">output_schema</span>);
      <span class="hljs-keyword">const</span> inputSchema = <span class="hljs-title function_">jsonSchemaToZod</span>(inputSchemaObj);
      <span class="hljs-keyword">const</span> outputSchema = <span class="hljs-title function_">jsonSchemaToZod</span>(outputSchemaObj);

      <span class="hljs-comment">// æ³¨å†Œå·¥å…·</span>
      server.<span class="hljs-title function_">registerTool</span>(
        tool.<span class="hljs-property">name</span>,
        {
          <span class="hljs-attr">description</span>: tool.<span class="hljs-property">description</span>,
          inputSchema,
          outputSchema,
        },
        <span class="hljs-keyword">async</span> ({ input }) =&gt; {
          <span class="hljs-comment">// æ‰§è¡Œå·¥å…·å›è°ƒé€»è¾‘</span>
          <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> å®ç°å®é™…çš„å·¥å…·å›è°ƒ</span>
          <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">content</span>: [
              { <span class="hljs-attr">type</span>: <span class="hljs-string">"text"</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">`æµ‹è¯•: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(input)}</span>`</span> },
            ],
          };
        },
      );
    });

    <span class="hljs-comment">// åˆ›å»º SSE handlers</span>
    <span class="hljs-keyword">const</span> handlers = <span class="hljs-title function_">sseHandlers</span>(<span class="hljs-function">() =&gt;</span> server, {
      <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">error: <span class="hljs-built_in">Error</span>, sessionId?: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
        consola.<span class="hljs-title function_">error</span>(<span class="hljs-string">`[SSE][<span class="hljs-subst">${config.name}</span>] é”™è¯¯:`</span>, error);
      },
    });

    <span class="hljs-comment">// ä½¿ç”¨é…ç½®IDä½œä¸ºkeyå­˜å‚¨handlers</span>
    handlersMap.<span class="hljs-title function_">set</span>(config.<span class="hljs-property">id</span>!, handlers);
  }

  <span class="hljs-keyword">return</span> handlersMap;
}
</code></pre>
<p><strong>ä»£ç è§£æ</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>Map&lt;number, McpHandlers&gt;</code> å­˜å‚¨æœåŠ¡IDåˆ°handlersçš„æ˜ å°„å…³ç³»</li>
<li>ä»æ•°æ®åº“åŠ¨æ€åŠ è½½é…ç½®ï¼Œæ”¯æŒè¿è¡Œæ—¶æ›´æ–°</li>
<li>åªåˆ›å»ºçŠ¶æ€ä¸º <code>RUNNING</code> çš„æœåŠ¡ï¼Œå®ç°æœåŠ¡çš„å¯åœæ§åˆ¶</li>
<li>ä½¿ç”¨ <code>express-mcp-handler</code> åº“åˆ›å»º SSE handlersï¼Œç®€åŒ– MCP åè®®å¤„ç†</li>
</ul>
<h4 data-id="heading-18">æ¨¡å—2ï¼šè·¯ç”±åˆ†å‘æœºåˆ¶</h4>
<p><strong>å®ç°ç›®æ ‡</strong>ï¼šæ ¹æ® <code>MCP_ID</code> header ä»å†…å­˜æ˜ å°„è¡¨ä¸­è·å–å¯¹åº”çš„ handlers å¹¶å¤„ç†è¯·æ±‚ã€‚</p>
<p><strong>æ ¸å¿ƒä»£ç </strong>ï¼ˆ<code>packages/honeycomb-server/src/mcp.ts</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * åˆ›å»ºè·¯ç”±å¤„ç†å™¨ï¼ˆæ ¹æ® MCP_ID é€‰æ‹©å¯¹åº”çš„ handlerï¼‰
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createMcpRouteHandler</span>(<span class="hljs-params">
  handlersMap: <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">number</span>, McpHandlers&gt;,
  handlerType: <span class="hljs-string">"get"</span> | <span class="hljs-string">"post"</span>,
</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">
    req: express.Request,
    res: express.Response,
    next: express.NextFunction,
  </span>) =&gt;</span> {
    <span class="hljs-comment">// è§£æ MCP_ID</span>
    <span class="hljs-keyword">const</span> mcpIdHeader = req.<span class="hljs-property">headers</span>.<span class="hljs-property">mcp_id</span> || req.<span class="hljs-property">headers</span>.<span class="hljs-property">MCP_ID</span>;
    <span class="hljs-keyword">const</span> mcpId = mcpIdHeader 
      ? <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">typeof</span> mcpIdHeader === <span class="hljs-string">"string"</span> ? mcpIdHeader : mcpIdHeader[<span class="hljs-number">0</span>], <span class="hljs-number">10</span>)
      : <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">if</span> (mcpId === <span class="hljs-literal">null</span> || <span class="hljs-title class_">Number</span>.<span class="hljs-built_in">isNaN</span>(mcpId)) {
      res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">json</span>({
        <span class="hljs-attr">error</span>: <span class="hljs-string">"ç¼ºå°‘æˆ–æ— æ•ˆçš„ MCP_ID header å‚æ•°"</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">"è¯·åœ¨è¯·æ±‚ Header ä¸­æ·»åŠ  MCP_ID æˆ– mcp_id å‚æ•°ï¼ˆæ•°å­—ç±»å‹ï¼‰"</span>,
      });
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// ä»æ˜ å°„è¡¨ä¸­è·å–å¯¹åº”çš„ handlers</span>
    <span class="hljs-keyword">const</span> handlers = handlersMap.<span class="hljs-title function_">get</span>(mcpId);

    <span class="hljs-keyword">if</span> (!handlers) {
      res.<span class="hljs-title function_">status</span>(<span class="hljs-number">404</span>).<span class="hljs-title function_">json</span>({
        <span class="hljs-attr">error</span>: <span class="hljs-string">`æœªæ‰¾åˆ° ID ä¸º <span class="hljs-subst">${mcpId}</span> çš„ MCP é…ç½®`</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">`è¯·æ£€æŸ¥ MCP_ID æ˜¯å¦æ­£ç¡®ï¼Œå½“å‰å¯ç”¨çš„ MCP ID: <span class="hljs-subst">${<span class="hljs-built_in">Array</span>.<span class="hljs-keyword">from</span>(handlersMap.keys()).join(<span class="hljs-string">", "</span>)}</span>`</span>,
      });
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// è°ƒç”¨å¯¹åº”çš„ handlerï¼ˆGET æˆ– POSTï¼‰</span>
    <span class="hljs-keyword">const</span> targetHandler =
      handlerType === <span class="hljs-string">"get"</span> ? handlers.<span class="hljs-property">getHandler</span> : handlers.<span class="hljs-property">postHandler</span>;
    <span class="hljs-title function_">targetHandler</span>(req, res, next);
  };
}
</code></pre>
<p><strong>è·¯ç”±æ³¨å†Œ</strong>ï¼ˆ<code>packages/honeycomb-server/src/app.ts</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ³¨å†Œ SSE ç«¯ç‚¹</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">"/sse"</span>, <span class="hljs-title function_">createMcpRouteHandler</span>(mcpHandlersMap, <span class="hljs-string">"get"</span>));
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">"/messages"</span>, <span class="hljs-title function_">createMcpRouteHandler</span>(mcpHandlersMap, <span class="hljs-string">"post"</span>));
</code></pre>
<p><strong>ä»£ç è§£æ</strong>ï¼š</p>
<ul>
<li>é€šè¿‡ä¸­é—´ä»¶å‡½æ•°å®ç°è·¯ç”±åˆ†å‘ï¼Œæ”¯æŒ GET å’Œ POST ä¸¤ç§è¯·æ±‚æ–¹å¼</li>
<li>ä»è¯·æ±‚ Header ä¸­è§£æ <code>MCP_ID</code>ï¼Œæ”¯æŒå¤§å°å†™ä¸æ•æ„Ÿ</li>
<li>æä¾›è¯¦ç»†çš„é”™è¯¯æç¤ºï¼ŒåŒ…æ‹¬å½“å‰å¯ç”¨çš„ MCP ID åˆ—è¡¨</li>
<li>ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹ï¼Œè¿”å› Express ä¸­é—´ä»¶å‡½æ•°</li>
</ul>
<h4 data-id="heading-19">æ¨¡å—3ï¼šé…ç½®ç®¡ç†ä¸æœåŠ¡åˆ·æ–°</h4>
<p><strong>å®ç°ç›®æ ‡</strong>ï¼šæä¾› REST API ç®¡ç† MCP é…ç½®ï¼Œæ”¯æŒåŠ¨æ€åˆ·æ–°æœåŠ¡ã€‚</p>
<p><strong>æ ¸å¿ƒä»£ç </strong>ï¼ˆ<code>packages/honeycomb-server/src/routes/configs.ts</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * POST /api/config/:id/start - å¯åŠ¨æœåŠ¡
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">startConfigHandler</span>(<span class="hljs-params">
  req: express.Request,
  res: express.Response,
  handlersMap: <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">number</span>, McpHandlers&gt;,
</span>) {
  <span class="hljs-keyword">const</span> id = <span class="hljs-title function_">validateIdParam</span>(req);
  <span class="hljs-keyword">const</span> databaseClient = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getDatabaseClient</span>();

  <span class="hljs-comment">// æ›´æ–°æ•°æ®åº“çŠ¶æ€ä¸º RUNNING</span>
  <span class="hljs-keyword">await</span> databaseClient.<span class="hljs-title function_">updateConfig</span>(id, {
    <span class="hljs-attr">status</span>: <span class="hljs-title class_">StatusEnum</span>.<span class="hljs-property">RUNNING</span>,
    <span class="hljs-attr">last_modified</span>: <span class="hljs-title function_">getCurrentTimeString</span>(),
  });
  <span class="hljs-keyword">await</span> databaseClient.<span class="hljs-title function_">save</span>();

  <span class="hljs-comment">// åˆ·æ–° MCP æœåŠ¡ï¼ˆé‡æ–°åŠ è½½æ‰€æœ‰é…ç½®ï¼‰</span>
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">refreshMcpServices</span>(handlersMap);

  <span class="hljs-keyword">const</span> updatedConfig = <span class="hljs-keyword">await</span> databaseClient.<span class="hljs-title function_">getConfigWithTools</span>(id);
  res.<span class="hljs-title function_">json</span>(<span class="hljs-title function_">createSuccessResponse</span>(<span class="hljs-title function_">dbToVO</span>(updatedConfig)));
}

<span class="hljs-comment">/**
 * åˆ·æ–° MCP æœåŠ¡ï¼ˆé‡æ–°åŠ è½½æ‰€æœ‰é…ç½®ï¼‰
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">refreshMcpServices</span>(<span class="hljs-params">
  handlersMap: <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">number</span>, McpHandlers&gt;,
</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
  <span class="hljs-comment">// æ¸…ç©ºç°æœ‰æ˜ å°„</span>
  handlersMap.<span class="hljs-title function_">clear</span>();
  
  <span class="hljs-comment">// é‡æ–°åˆ›å»ºæ‰€æœ‰æœåŠ¡</span>
  <span class="hljs-keyword">const</span> newHandlersMap = <span class="hljs-keyword">await</span> <span class="hljs-title function_">createMcpServices</span>();
  
  <span class="hljs-comment">// æ›´æ–°æ˜ å°„è¡¨</span>
  newHandlersMap.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">handlers, id</span>) =&gt;</span> {
    handlersMap.<span class="hljs-title function_">set</span>(id, handlers);
  });
}
</code></pre>
<p><strong>ä»£ç è§£æ</strong>ï¼š</p>
<ul>
<li>é€šè¿‡ REST API æä¾›é…ç½®çš„ CRUD æ“ä½œ</li>
<li>å¯åŠ¨/åœæ­¢æœåŠ¡æ—¶æ›´æ–°æ•°æ®åº“çŠ¶æ€å¹¶åˆ·æ–°å†…å­˜æ˜ å°„è¡¨</li>
<li><code>refreshMcpServices</code> å‡½æ•°å®ç°æœåŠ¡çš„çƒ­æ›´æ–°ï¼Œæ— éœ€é‡å¯è¿›ç¨‹</li>
<li>ä½¿ç”¨ SQL.js ä½œä¸ºè½»é‡çº§æ•°æ®åº“ï¼Œæ— éœ€é¢å¤–æ•°æ®åº“æœåŠ¡</li>
</ul>
<h4 data-id="heading-20">æ¨¡å—4ï¼šJSON Schema åˆ° Zod è½¬æ¢</h4>
<p><strong>å®ç°ç›®æ ‡</strong>ï¼šå°†æ•°æ®åº“ä¸­å­˜å‚¨çš„ JSON Schema è½¬æ¢ä¸º Zod schemaï¼Œç”¨äº MCP å·¥å…·çš„å‚æ•°æ ¡éªŒã€‚</p>
<p><strong>æ ¸å¿ƒä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * å°† JSON Schema è½¬æ¢ä¸º Zod schema
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">jsonSchemaToZod</span>(<span class="hljs-params">schemaObj: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>&gt;</span>): z.<span class="hljs-property">ZodObject</span>&lt;<span class="hljs-built_in">any</span>&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">shape</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, z.<span class="hljs-property">ZodTypeAny</span>&gt; = {};

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(schemaObj)) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">"object"</span> &amp;&amp; value !== <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">const</span> fieldSchema = value <span class="hljs-keyword">as</span> { <span class="hljs-keyword">type</span>?: <span class="hljs-built_in">string</span>; description?: <span class="hljs-built_in">string</span> };
      <span class="hljs-keyword">let</span> <span class="hljs-attr">zodType</span>: z.<span class="hljs-property">ZodTypeAny</span>;

      <span class="hljs-comment">// æ ¹æ® JSON Schema çš„ type åˆ›å»ºå¯¹åº”çš„ Zod ç±»å‹</span>
      <span class="hljs-keyword">switch</span> (fieldSchema.<span class="hljs-property">type</span>) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"string"</span>:
          zodType = z.<span class="hljs-title function_">string</span>();
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"number"</span>:
          zodType = z.<span class="hljs-title function_">number</span>();
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"integer"</span>:
          zodType = z.<span class="hljs-title function_">number</span>().<span class="hljs-title function_">int</span>();
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"boolean"</span>:
          zodType = z.<span class="hljs-title function_">boolean</span>();
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"array"</span>:
          zodType = z.<span class="hljs-title function_">array</span>(z.<span class="hljs-title function_">any</span>());
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"object"</span>:
          zodType = z.<span class="hljs-title function_">object</span>({});
          <span class="hljs-keyword">break</span>;
        <span class="hljs-attr">default</span>:
          zodType = z.<span class="hljs-title function_">any</span>();
      }

      <span class="hljs-comment">// å¦‚æœæœ‰ descriptionï¼Œæ·»åŠ æè¿°</span>
      <span class="hljs-keyword">if</span> (fieldSchema.<span class="hljs-property">description</span>) {
        zodType = zodType.<span class="hljs-title function_">describe</span>(fieldSchema.<span class="hljs-property">description</span>);
      }

      shape[key] = zodType;
    } <span class="hljs-keyword">else</span> {
      shape[key] = z.<span class="hljs-title function_">any</span>();
    }
  }

  <span class="hljs-keyword">return</span> z.<span class="hljs-title function_">object</span>(shape);
}
</code></pre>
<p><strong>ä»£ç è§£æ</strong>ï¼š</p>
<ul>
<li>æ”¯æŒå¸¸è§çš„ JSON Schema ç±»å‹åˆ° Zod ç±»å‹çš„è½¬æ¢</li>
<li>ä¿ç•™å­—æ®µæè¿°ä¿¡æ¯ï¼Œæå‡ API æ–‡æ¡£è´¨é‡</li>
<li>å¯¹äºä¸æ”¯æŒçš„ç±»å‹ï¼Œä½¿ç”¨ <code>z.any()</code> ä½œä¸ºå…œåº•</li>
</ul>
<h3 data-id="heading-21">4.4 å¸¸è§é—®é¢˜&amp;è¸©å‘æŒ‡å—</h3>
<p><strong>é—®é¢˜1ï¼šMCP_ID æœªæ‰¾åˆ°</strong></p>
<p><strong>ç°è±¡</strong>ï¼šè¿”å› 404 é”™è¯¯ï¼Œæç¤ºæœªæ‰¾åˆ°å¯¹åº”çš„ MCP é…ç½®</p>
<p><strong>åŸå› </strong>ï¼š</p>
<ul>
<li>æœåŠ¡æœªå¯åŠ¨ï¼ˆçŠ¶æ€ä¸æ˜¯ RUNNINGï¼‰</li>
<li>MCP_ID è¾“å…¥é”™è¯¯</li>
<li>æœåŠ¡è¢«åˆ é™¤ä½†å®¢æˆ·ç«¯ä»åœ¨ä½¿ç”¨æ—§ID</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é€šè¿‡ API æŸ¥è¯¢æ‰€æœ‰å¯ç”¨çš„æœåŠ¡</span>
curl http://localhost:3002/api/configs

<span class="hljs-comment"># æ£€æŸ¥æœåŠ¡çŠ¶æ€</span>
<span class="hljs-comment"># ç¡®ä¿æœåŠ¡çŠ¶æ€ä¸º "running"</span>
</code></pre>
<p><strong>é—®é¢˜2ï¼šæœåŠ¡åˆ·æ–°åè¿æ¥æ–­å¼€</strong></p>
<p><strong>ç°è±¡</strong>ï¼šè°ƒç”¨åˆ·æ–° API åï¼Œç°æœ‰çš„ SSE è¿æ¥æ–­å¼€</p>
<p><strong>åŸå› </strong>ï¼š<code>refreshMcpServices</code> ä¼šæ¸…ç©ºå¹¶é‡å»ºæ‰€æœ‰æœåŠ¡å®ä¾‹ï¼Œå¯¼è‡´ç°æœ‰è¿æ¥å¤±æ•ˆ</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>è¿™æ˜¯é¢„æœŸè¡Œä¸ºï¼Œå®¢æˆ·ç«¯éœ€è¦é‡æ–°å»ºç«‹è¿æ¥</li>
<li>å¯ä»¥åœ¨åˆ·æ–°å‰é€šçŸ¥å®¢æˆ·ç«¯ï¼Œæˆ–å®ç°è¿æ¥è¿ç§»æœºåˆ¶</li>
</ul>
<p><strong>é—®é¢˜3ï¼šæ•°æ®åº“æ–‡ä»¶æƒé™é—®é¢˜</strong></p>
<p><strong>ç°è±¡</strong>ï¼šSQL.js æ•°æ®åº“æ–‡ä»¶æ— æ³•å†™å…¥</p>
<p><strong>åŸå› </strong>ï¼šæ–‡ä»¶æƒé™ä¸è¶³æˆ–æ–‡ä»¶è¢«é”å®š</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ£€æŸ¥æ–‡ä»¶æƒé™</span>
<span class="hljs-built_in">ls</span> -l mcp.db

<span class="hljs-comment"># ä¿®æ”¹æ–‡ä»¶æƒé™</span>
<span class="hljs-built_in">chmod</span> 644 mcp.db
</code></pre>
<hr/>
<h2 data-id="heading-22">äº”ã€ä¸¤ç§æ–¹æ¡ˆå¯¹æ¯”åˆ†æ</h2>
<h3 data-id="heading-23">5.1 æ¶æ„å¯¹æ¯”</h3>



































<table><thead><tr><th>ç»´åº¦</th><th>æ–¹æ¡ˆ1ï¼šNginxåå‘ä»£ç†</th><th>æ–¹æ¡ˆ2ï¼šExpressç»Ÿä¸€æœåŠ¡</th></tr></thead><tbody><tr><td><strong>æœåŠ¡éš”ç¦»</strong></td><td>ç‰©ç†éš”ç¦»ï¼ˆç‹¬ç«‹ç«¯å£ã€ç‹¬ç«‹è¿›ç¨‹ï¼‰</td><td>é€»è¾‘éš”ç¦»ï¼ˆåŒä¸€è¿›ç¨‹ã€å†…å­˜æ˜ å°„ï¼‰</td></tr><tr><td><strong>èµ„æºæ¶ˆè€—</strong></td><td>è¾ƒé«˜ï¼ˆå¤šè¿›ç¨‹ï¼‰</td><td>è¾ƒä½ï¼ˆå•è¿›ç¨‹ï¼‰</td></tr><tr><td><strong>æ‰©å±•æ€§</strong></td><td>éœ€è¦ä¿®æ”¹é…ç½®å¹¶é‡å¯</td><td>æ”¯æŒçƒ­æ›´æ–°ï¼Œæ— éœ€é‡å¯</td></tr><tr><td><strong>é…ç½®ç®¡ç†</strong></td><td>é™æ€æ–‡ä»¶ï¼ˆconfig.jsonï¼‰</td><td>åŠ¨æ€æ•°æ®åº“ï¼ˆSQL.jsï¼‰</td></tr><tr><td><strong>è¿ç»´å¤æ‚åº¦</strong></td><td>ä¸­ç­‰ï¼ˆéœ€è¦ç®¡ç†Nginxå’Œå¤šä¸ªæœåŠ¡ï¼‰</td><td>è¾ƒä½ï¼ˆå•ä¸€æœåŠ¡ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-24">5.2 æ€§èƒ½å¯¹æ¯”</h3>
<p><strong>æ–¹æ¡ˆ1ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>æœåŠ¡ä¹‹é—´å®Œå…¨éš”ç¦»ï¼Œå•ä¸ªæœåŠ¡å´©æºƒä¸å½±å“å…¶ä»–æœåŠ¡</li>
<li>Nginx ä½œä¸ºæˆç†Ÿçš„åå‘ä»£ç†ï¼Œæ€§èƒ½ç¨³å®šå¯é </li>
<li>å¯ä»¥é’ˆå¯¹ä¸åŒæœåŠ¡è¿›è¡Œç‹¬ç«‹çš„æ€§èƒ½è°ƒä¼˜</li>
</ul>
<p><strong>æ–¹æ¡ˆ2ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>å•è¿›ç¨‹æ¶æ„ï¼Œå†…å­˜å ç”¨æ›´å°‘</li>
<li>æ— éœ€ç»è¿‡ Nginx è½¬å‘ï¼Œå‡å°‘ç½‘ç»œè·³æ•°</li>
<li>æœåŠ¡åˆ›å»ºå’Œé”€æ¯æ›´å¿«ï¼ˆå†…å­˜æ“ä½œ vs è¿›ç¨‹ç®¡ç†ï¼‰</li>
</ul>
<h3 data-id="heading-25">5.3 é€‚ç”¨åœºæ™¯</h3>
<p><strong>æ–¹æ¡ˆ1é€‚ç”¨äº</strong>ï¼š</p>
<ul>
<li>éœ€è¦ä¸¥æ ¼æœåŠ¡éš”ç¦»çš„åœºæ™¯</li>
<li>å·²æœ‰ Nginx åŸºç¡€è®¾æ–½çš„é¡¹ç›®</li>
<li>æœåŠ¡æ•°é‡ç›¸å¯¹å›ºå®šï¼Œä¸é¢‘ç¹å˜æ›´</li>
<li>éœ€è¦ç‹¬ç«‹ç›‘æ§å’Œæ—¥å¿—çš„åœºæ™¯</li>
</ul>
<p><strong>æ–¹æ¡ˆ2é€‚ç”¨äº</strong>ï¼š</p>
<ul>
<li>éœ€è¦åŠ¨æ€ç®¡ç†æœåŠ¡çš„åœºæ™¯</li>
<li>èµ„æºå—é™çš„ç¯å¢ƒï¼ˆå¦‚è¾¹ç¼˜è®¡ç®—ï¼‰</li>
<li>éœ€è¦å¯è§†åŒ–é…ç½®ç®¡ç†çš„åœºæ™¯</li>
<li>å¿«é€Ÿè¿­ä»£å’Œå¼€å‘æµ‹è¯•ç¯å¢ƒ</li>
</ul>
<h3 data-id="heading-26">5.4 æŠ€æœ¯é€‰å‹å»ºè®®</h3>
<p><strong>é€‰æ‹©æ–¹æ¡ˆ1ï¼Œå¦‚æœ</strong>ï¼š</p>
<ul>
<li>âœ… ä½ çš„å›¢é˜Ÿç†Ÿæ‚‰ Nginx é…ç½®</li>
<li>âœ… éœ€è¦ç”Ÿäº§çº§çš„é«˜å¯ç”¨æ€§</li>
<li>âœ… æœåŠ¡æ•°é‡è¾ƒå°‘ä¸”ç›¸å¯¹ç¨³å®š</li>
<li>âœ… éœ€è¦ç‹¬ç«‹çš„æœåŠ¡ç›‘æ§å’Œæ—¥å¿—</li>
</ul>
<p><strong>é€‰æ‹©æ–¹æ¡ˆ2ï¼Œå¦‚æœ</strong>ï¼š</p>
<ul>
<li>âœ… éœ€è¦é¢‘ç¹æ·»åŠ /åˆ é™¤æœåŠ¡</li>
<li>âœ… å¸Œæœ›æä¾›ç”¨æˆ·å‹å¥½çš„é…ç½®ç•Œé¢</li>
<li>âœ… èµ„æºå—é™ï¼Œéœ€è¦ä¼˜åŒ–å†…å­˜ä½¿ç”¨</li>
<li>âœ… å¿«é€Ÿå¼€å‘å’Œè¿­ä»£</li>
</ul>
<hr/>
<h2 data-id="heading-27">å…­ã€è¿›é˜¶ä¼˜åŒ–&amp;æ‰©å±•åœºæ™¯</h2>
<h3 data-id="heading-28">6.1 æ€§èƒ½ä¼˜åŒ–æ–¹å‘</h3>
<p><strong>æ–¹æ¡ˆ1ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li><strong>è¿æ¥æ± ç®¡ç†</strong>ï¼šé…ç½® Nginx upstream è¿æ¥æ± ï¼Œå¤ç”¨åç«¯è¿æ¥</li>
<li><strong>è´Ÿè½½å‡è¡¡</strong>ï¼šä¸ºåŒä¸€æœåŠ¡é…ç½®å¤šä¸ªåç«¯å®ä¾‹ï¼Œå®ç°è´Ÿè½½å‡è¡¡</li>
<li><strong>ç¼“å­˜ç­–ç•¥</strong>ï¼šå¯¹é™æ€èµ„æºæˆ–é¢‘ç¹æŸ¥è¯¢çš„ç»“æœè¿›è¡Œç¼“å­˜</li>
</ul>
<p><strong>æ–¹æ¡ˆ2ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li><strong>æ‡’åŠ è½½æœåŠ¡</strong>ï¼šæŒ‰éœ€åˆ›å»ºæœåŠ¡å®ä¾‹ï¼Œå‡å°‘å¯åŠ¨æ—¶é—´</li>
<li><strong>æœåŠ¡é¢„çƒ­</strong>ï¼šåœ¨æœåŠ¡å¯åŠ¨æ—¶é¢„åŠ è½½å¸¸ç”¨æœåŠ¡</li>
<li><strong>è¿æ¥å¤ç”¨</strong>ï¼šå®ç° SSE è¿æ¥æ± ï¼Œå‡å°‘è¿æ¥å»ºç«‹å¼€é”€</li>
</ul>
<h3 data-id="heading-29">6.2 æ‰©å±•åº”ç”¨åœºæ™¯</h3>
<p><strong>åœºæ™¯1ï¼šæœåŠ¡ç‰ˆæœ¬ç®¡ç†</strong></p>
<ul>
<li>æ”¯æŒåŒä¸€æœåŠ¡çš„å¤šä¸ªç‰ˆæœ¬å¹¶å­˜</li>
<li>é€šè¿‡ Header å‚æ•°ï¼ˆå¦‚ <code>MCP-Version</code>ï¼‰é€‰æ‹©ç‰ˆæœ¬</li>
<li>å®ç°ç°åº¦å‘å¸ƒå’Œç‰ˆæœ¬å›æ»š</li>
</ul>
<p><strong>åœºæ™¯2ï¼šæœåŠ¡ç›‘æ§å’Œå‘Šè­¦</strong></p>
<ul>
<li>é›†æˆ Prometheus ç›‘æ§æŒ‡æ ‡</li>
<li>å®ç°æœåŠ¡å¥åº·æ£€æŸ¥æ¥å£</li>
<li>é…ç½®å‘Šè­¦è§„åˆ™ï¼ˆå¦‚æœåŠ¡å“åº”æ—¶é—´ã€é”™è¯¯ç‡ï¼‰</li>
</ul>
<p><strong>åœºæ™¯3ï¼šå¤šç§Ÿæˆ·æ”¯æŒ</strong></p>
<ul>
<li>ä¸ºä¸åŒç§Ÿæˆ·éš”ç¦»æœåŠ¡å®ä¾‹å’Œé…ç½®</li>
<li>é€šè¿‡ç§Ÿæˆ·IDï¼ˆTenant IDï¼‰è¿›è¡Œè·¯ç”±</li>
<li>å®ç°èµ„æºé…é¢å’Œé™æµ</li>
</ul>
<h3 data-id="heading-30">6.3 ç”Ÿäº§ç¯å¢ƒæ³¨æ„äº‹é¡¹</h3>
<p><strong>å®‰å…¨æ€§</strong>ï¼š</p>
<ul>
<li>å®ç°è¯·æ±‚è®¤è¯å’Œæˆæƒï¼ˆå¦‚ JWT Tokenï¼‰</li>
<li>å¯¹ Header å‚æ•°è¿›è¡Œæ ¡éªŒå’Œè¿‡æ»¤ï¼Œé˜²æ­¢æ³¨å…¥æ”»å‡»</li>
<li>é…ç½® HTTPSï¼ŒåŠ å¯†ä¼ è¾“æ•°æ®</li>
</ul>
<p><strong>é«˜å¯ç”¨æ€§</strong>ï¼š</p>
<ul>
<li>å®ç°æœåŠ¡å¥åº·æ£€æŸ¥ï¼Œè‡ªåŠ¨å‰”é™¤å¼‚å¸¸æœåŠ¡</li>
<li>é…ç½®æœåŠ¡é‡å¯ç­–ç•¥å’Œæ•…éšœæ¢å¤æœºåˆ¶</li>
<li>å®ç°é…ç½®å¤‡ä»½å’Œæ¢å¤</li>
</ul>
<p><strong>å¯è§‚æµ‹æ€§</strong>ï¼š</p>
<ul>
<li>é›†æˆç»“æ„åŒ–æ—¥å¿—ï¼ˆå¦‚ Winstonã€Pinoï¼‰</li>
<li>å®ç°åˆ†å¸ƒå¼è¿½è¸ªï¼ˆå¦‚ OpenTelemetryï¼‰</li>
<li>é…ç½®å‘Šè­¦å’Œé€šçŸ¥æœºåˆ¶</li>
</ul>
<hr/>
<h2 data-id="heading-31">ä¸ƒã€æ€»ç»“ä¸å±•æœ›</h2>
<h3 data-id="heading-32">7.1 æ ¸å¿ƒå†…å®¹æ€»ç»“</h3>
<p>æœ¬æ–‡æ·±å…¥å¯¹æ¯”äº†ä¸¤ç§å•å®ä¾‹å¤šMCPèšåˆæœåŠ¡çš„å®ç°æ–¹æ¡ˆï¼š</p>
<ol>
<li>
<p><strong>æ–¹æ¡ˆ1ï¼ˆNginxåå‘ä»£ç†ï¼‰</strong>ï¼šé‡‡ç”¨ç‰©ç†éš”ç¦»çš„æ–¹å¼ï¼Œæ¯ä¸ª MCP æœåŠ¡è¿è¡Œåœ¨ç‹¬ç«‹ç«¯å£ï¼Œé€šè¿‡ Nginx åå‘ä»£ç†ç»Ÿä¸€å¯¹å¤–æä¾›æœåŠ¡ã€‚é€‚åˆéœ€è¦ä¸¥æ ¼æœåŠ¡éš”ç¦»ã€æœåŠ¡æ•°é‡ç›¸å¯¹å›ºå®šçš„åœºæ™¯ã€‚</p>
</li>
<li>
<p><strong>æ–¹æ¡ˆ2ï¼ˆExpressç»Ÿä¸€æœåŠ¡ï¼‰</strong>ï¼šé‡‡ç”¨é€»è¾‘éš”ç¦»çš„æ–¹å¼ï¼Œæ‰€æœ‰ MCP æœåŠ¡è¿è¡Œåœ¨åŒä¸€è¿›ç¨‹ï¼Œé€šè¿‡å†…å­˜æ˜ å°„è¡¨ç®¡ç†ï¼Œæ”¯æŒåŠ¨æ€åˆ›å»ºå’Œé”€æ¯ã€‚é€‚åˆéœ€è¦é¢‘ç¹å˜æ›´æœåŠ¡ã€èµ„æºå—é™çš„åœºæ™¯ã€‚</p>
</li>
</ol>
<p>ä¸¤ç§æ–¹æ¡ˆå„æœ‰ä¼˜åŠ£ï¼Œå¼€å‘è€…åº”æ ¹æ®å®é™…ä¸šåŠ¡éœ€æ±‚ã€å›¢é˜ŸæŠ€æœ¯æ ˆå’Œè¿ç»´èƒ½åŠ›è¿›è¡Œé€‰æ‹©ã€‚</p>
<h3 data-id="heading-33">7.2 æŠ€æœ¯å±€é™æ€§</h3>
<p><strong>æ–¹æ¡ˆ1å±€é™æ€§</strong>ï¼š</p>
<ul>
<li>éœ€è¦é¢å¤–çš„ Nginx ç»„ä»¶ï¼Œå¢åŠ ç³»ç»Ÿå¤æ‚åº¦</li>
<li>æœåŠ¡æ•°é‡å—ç«¯å£æ•°é‡é™åˆ¶ï¼ˆç†è®ºä¸Šæœ€å¤š65535ä¸ªï¼‰</li>
<li>é…ç½®å˜æ›´éœ€è¦é‡å¯æœåŠ¡ï¼Œä¸å¤Ÿçµæ´»</li>
</ul>
<p><strong>æ–¹æ¡ˆ2å±€é™æ€§</strong>ï¼š</p>
<ul>
<li>å•è¿›ç¨‹æ¶æ„ï¼Œå•ä¸ªæœåŠ¡å´©æºƒå¯èƒ½å½±å“æ•´ä½“ç¨³å®šæ€§</li>
<li>å†…å­˜æ˜ å°„è¡¨éœ€è¦æ‰‹åŠ¨ç®¡ç†ï¼Œå®¹æ˜“å‡ºç°å†…å­˜æ³„æ¼</li>
<li>SQL.js æ•°æ®åº“ä¸é€‚åˆé«˜å¹¶å‘å†™å…¥åœºæ™¯</li>
</ul>
<h3 data-id="heading-34">7.3 æœªæ¥æ¢ç´¢æ–¹å‘</h3>
<ol>
<li>
<p><strong>æ··åˆæ–¹æ¡ˆ</strong>ï¼šç»“åˆä¸¤ç§æ–¹æ¡ˆçš„ä¼˜ç‚¹ï¼Œå®ç°åˆ†å±‚çš„æœåŠ¡ç®¡ç†ï¼ˆå¦‚æŒ‰æœåŠ¡ç±»å‹åˆ†ç»„ï¼Œç»„å†…ä½¿ç”¨æ–¹æ¡ˆ2ï¼Œç»„é—´ä½¿ç”¨æ–¹æ¡ˆ1ï¼‰</p>
</li>
<li>
<p><strong>æœåŠ¡ç½‘æ ¼é›†æˆ</strong>ï¼šå°† MCP æœåŠ¡æ¥å…¥ Istio ç­‰æœåŠ¡ç½‘æ ¼ï¼Œå®ç°æ›´å¼ºå¤§çš„æµé‡ç®¡ç†ã€å®‰å…¨ç­–ç•¥å’Œå¯è§‚æµ‹æ€§</p>
</li>
<li>
<p><strong>äº‘åŸç”Ÿéƒ¨ç½²</strong>ï¼šæ”¯æŒ Kubernetes éƒ¨ç½²ï¼Œå®ç°è‡ªåŠ¨æ‰©ç¼©å®¹ã€æœåŠ¡å‘ç°å’Œé…ç½®ç®¡ç†</p>
</li>
<li>
<p><strong>åè®®æ‰©å±•</strong>ï¼šæ”¯æŒæ›´å¤š MCP ä¼ è¾“æ–¹å¼ï¼ˆå¦‚ WebSocketã€gRPCï¼‰ï¼Œæå‡æ€§èƒ½å’Œçµæ´»æ€§</p>
</li>
<li>
<p><strong>å·¥å…·å¸‚åœº</strong>ï¼šæ„å»º MCP å·¥å…·å¸‚åœºï¼Œæ”¯æŒå·¥å…·çš„å‘å¸ƒã€åˆ†äº«å’Œç‰ˆæœ¬ç®¡ç†</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-35">å…«ã€å‚è€ƒèµ„æ–™</h2>
<ol>
<li>
<p><strong>MCP åè®®å®˜æ–¹æ–‡æ¡£</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io%2F" target="_blank" title="https://modelcontextprotocol.io/" ref="nofollow noopener noreferrer">Model Context Protocol Specification</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmodelcontextprotocol%2Ftypescript-sdk" target="_blank" title="https://github.com/modelcontextprotocol/typescript-sdk" ref="nofollow noopener noreferrer">MCP SDK for TypeScript</a></li>
</ul>
</li>
<li>
<p><strong>æŠ€æœ¯æ–‡æ¡£</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fjlowin%2Ffastmcp" target="_blank" title="https://github.com/jlowin/fastmcp" ref="nofollow noopener noreferrer">FastMCP æ¡†æ¶æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fexpressjs.com%2F" target="_blank" title="https://expressjs.com/" ref="nofollow noopener noreferrer">Express å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=http%3A%2F%2Fnginx.org%2Fen%2Fdocs%2Fhttp%2Fngx_http_proxy_module.html" target="_blank" title="http://nginx.org/en/docs/http/ngx_http_proxy_module.html" ref="nofollow noopener noreferrer">Nginx åå‘ä»£ç†é…ç½®æŒ‡å—</a></li>
</ul>
</li>
<li>
<p><strong>ç›¸å…³é¡¹ç›®</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fbetterhyq%2Fhoneycomb" target="_blank" title="https://github.com/betterhyq/honeycomb" ref="nofollow noopener noreferrer">Honeycomb é¡¹ç›®æºç </a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmodelcontextprotocol%2Ftypescript-sdk%2Ftree%2Fmain%2Fpackages%2Fexpress-mcp-handler" target="_blank" title="https://github.com/modelcontextprotocol/typescript-sdk/tree/main/packages/express-mcp-handler" ref="nofollow noopener noreferrer">express-mcp-handler</a></li>
</ul>
</li>
<li>
<p><strong>SSE åè®®</strong></p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FServer-sent_events" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events" ref="nofollow noopener noreferrer">Server-Sent Events è§„èŒƒ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.html5rocks.com%2Fen%2Ftutorials%2Feventsource%2Fbasics%2F" target="_blank" title="https://www.html5rocks.com/en/tutorials/eventsource/basics/" ref="nofollow noopener noreferrer">SSE æœ€ä½³å®è·µ</a></li>
</ul>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¼€æºç‰ˆ Cowork çˆ†ç«ï¼Œé€¼å¾— Anthropic ä¸‹æ”¾ Cowork]]></title>    <link>https://juejin.cn/post/7596709272976261166</link>    <guid>https://juejin.cn/post/7596709272976261166</guid>    <pubDate>2026-01-19T10:12:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596709272976261166" data-draft-id="7596698363964375078" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¼€æºç‰ˆ Cowork çˆ†ç«ï¼Œé€¼å¾— Anthropic ä¸‹æ”¾ Cowork"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-19T10:12:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ–°æ™ºå…ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/952600743642312"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¼€æºç‰ˆ Cowork çˆ†ç«ï¼Œé€¼å¾— Anthropic ä¸‹æ”¾ Cowork
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/952600743642312/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ–°æ™ºå…ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T10:12:19.000Z" title="Mon Jan 19 2026 10:12:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f15c68532bd04d1da956261cca4da345~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422339&amp;x-signature=4wfkQFmce9Rk5K5dDV5jO1zhz%2Fs%3D" alt="" loading="lazy"/></p>
<h5 data-id="heading-0"><strong>ã€Œã€æ–°æ™ºå…ƒå¯¼è¯»ã€‘ä»…ç”¨ä¸¤å¤©å¼€å‘å‡ºçš„å¼€æºé¡¹ç›® Openworkï¼Œå¦‚ä½•é€¼è¿« AI å·¨å¤´ Anthropic ä½å¤´ï¼Ÿé¢å¯¹å…è´¹ã€æ›´å¿«ã€æ›´å®‰å…¨çš„å¼€æºç«å“ï¼ŒAnthropic ç´§æ€¥å°†åŸæœ¬ <img src="" alt="" loading="lazy"/>20 æ¡£ä½ã€‚è¿™åœºã€Œå®˜æ–¹é€¼æ­»åŒäººã€çš„åå‘å‰§æœ¬ï¼Œæ­ç¤ºäº† AI æ™ºèƒ½ä½“æ—¶ä»£çš„å®šä»·æƒï¼Œæ­£åœ¨ä»å·¨å¤´æ‰‹ä¸­æ»‘è½ã€‚ã€</strong></h5>
<p>2026 å¹´ 1 æœˆï¼Œç¡…è°·å‘ç”Ÿäº†ä¸€åœºæ²¡æœ‰ç¡çƒŸçš„å®šä»·æƒæˆ˜äº‰ã€‚</p>
<p>æˆ˜åœºçš„ä¸¤ç«¯ï¼Œä¸€æ–¹æ˜¯ä¼°å€¼ 1830 äº¿ç¾å…ƒã€æ‹¥æœ‰é¡¶å°–ç®—åŠ›çš„ AI å·¨å¤´ Anthropicï¼Œå¦ä¸€æ–¹æ˜¯ GitHub ä¸Šä¸€ä¸ªåä¸º Openwork çš„å¼€æºé¡¹ç›®ï¼Œç”±å‡ åå¼€å‘è€…åœ¨ä¸¤å¤©é»‘å®¢æ¾ï¼ˆç¼–ç¨‹é©¬æ‹‰æ¾ï¼ŒHackathonï¼‰ä¸­æ‹¼å‡‘è€Œæˆã€‚</p>
<p>ä»¥å‰ä½ é—® AIï¼šã€Œæ€ä¹ˆæ•´ç†è¿™äº›å‘ç¥¨ï¼Ÿã€å®ƒä¼šç»™ä½ åˆ—ä¸ªæ­¥éª¤ä¸€äºŒä¸‰ã€‚</p>
<p>Cowork çš„é€»è¾‘æ˜¯ï¼šã€ŒæŠŠè¿™äº›å‘ç¥¨æ•´ç†å¥½ã€‚ã€</p>
<p>ç„¶åå®ƒä¼šè‡ªå·±æ‰«ææ–‡ä»¶å¤¹ï¼Œè¯†åˆ«æ–‡ä»¶åï¼Œæå–é‡‘é¢ï¼Œåˆ›å»ºä¸€ä¸ª Excelï¼Œå¡«å…¥æ•°æ®ï¼Œæœ€åå‘ç»™ä½ ç¡®è®¤ã€‚</p>
<p>å®ƒåœ¨è¡ŒåŠ¨ï¼Œè€Œéå•çº¯å¯¹è¯ã€‚</p>
<p>è¿™ç§ã€Œç”šè‡³ä¸éœ€è¦ä½ åŠ¨è„‘å­ã€çš„èƒ½åŠ›ï¼Œæ›¾æ˜¯ Anthropic åˆ’åˆ†ç”¨æˆ·é˜¶å±‚çš„é‡‘çº¿ã€‚</p>
<p>Max ç”¨æˆ·ä»˜å‡ºçš„ 100 ç¾å…ƒï¼Œæ˜¯ã€Œæ•°å­—å‘˜å·¥ã€çš„å·¥èµ„ã€‚</p>
<p>Openwork çš„å‡ºç°ï¼Œè®©è¿™ç¬”å·¥èµ„æ˜¾å¾—æ»‘ç¨½ã€‚</p>
<p>æ—¢ç„¶å¼€æºä»£ç èƒ½è®©ç”¨æˆ·é›¶æˆæœ¬æ‹¥æœ‰ä¸€ä¸ªã€Œæ•°å­—å‘˜å·¥ã€ï¼ŒAnthropic å°±æ— æ³•å†ä»¥ç¨€ç¼ºæ€§ä¸ºç”±ç´¢è¦é«˜ä»·ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37033e2bbd2a420c885e7edad1e8d244~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422339&amp;x-signature=C0n5o1MRQ6oESh%2Fzyew0C5i85Yc%3D" alt="" loading="lazy"/></p>
<p><strong>ã€Œåªæœ‰é™ä½é—¨æ§›ã€</strong></p>
<p><strong>ã€Œæ‰èƒ½ä¿ä½å…¥å£ã€</strong></p>
<p>Anthropic çš„ååº”è¿…é€Ÿä¸”å†³ç»ã€‚</p>
<p>å°† Cowork ä¸‹æ”¾ç»™ 20 ç¾å…ƒçš„ Pro ç”¨æˆ·ï¼Œçœ‹ä¼¼æŸå¤±äº† Max ç”¨æˆ·çš„æº¢ä»·ï¼Œå®åˆ™æ˜¯ä¸ºäº†ä¿ä½æ›´çè´µçš„èµ„äº§ï¼šæ¡Œé¢å…¥å£ã€‚</p>
<p>å¦‚æœä»»ç”± Openwork å‘å±•ï¼Œæå®¢å’Œå¼€å‘è€…ä¼šè¿…é€Ÿå€’å‘å¼€æºç”Ÿæ€ã€‚åœ¨ Openwork çš„æ¡†æ¶ä¸‹ï¼ŒAnthropic åªæ˜¯ä¼—å¤šæ¨¡å‹ä¾›åº”å•†ä¸­çš„ä¸€ä¸ªé€‰é¡¹ã€‚</p>
<p>ç”¨æˆ·ä»Šå¤©å¯ä»¥ç”¨ Claudeï¼Œæ˜å¤©å°±å¯ä»¥æ¢æˆ GPT-5 æˆ–è€… DeepSeekã€‚è¿™ç§ã€Œç®¡é“åŒ–ã€çš„å±æœºï¼Œæ˜¯ä»»ä½•å¹³å°å‹å…¬å¸éƒ½æ— æ³•æ¥å—çš„ã€‚</p>
<p>20 ç¾å…ƒæ˜¯ä¸€ä¸ªç²¾å¦™çš„å®šä»·ã€‚</p>
<p>å®ƒå‡»ç©¿äº†æ™®é€šç”¨æˆ·çš„å¿ƒç†é˜²çº¿ã€‚</p>
<p>å¯¹äºå¤§å¤šæ•°éæŠ€æœ¯äººå‘˜ï¼Œå» GitHub ä¸‹è½½æºç ã€é…ç½®ç¯å¢ƒã€ç”³è¯· API Key ä¾ç„¶æ˜¯ä¸€ä»¶éº»çƒ¦äº‹ã€‚</p>
<p>Anthropic èµŒçš„æ˜¯ï¼Œä¸ºäº†çœå»è¿™äº›æŠ˜è…¾ï¼Œç”¨æˆ·æ„¿æ„æ”¯ä»˜ 20 ç¾å…ƒä¹°ä¸€ä¸ªã€Œå¼€ç®±å³ç”¨ã€çš„å®˜æ–¹æœåŠ¡ã€‚</p>
<p>è¿™æ˜¯ä¸€åœºç”¨ã€Œä¾¿åˆ©æ€§ã€å¯¹æŠ—ã€Œè‡ªç”±åº¦ã€çš„åšå¼ˆã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b717df5bf6144d19b6726efda0b75172~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paw5pm65YWD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422339&amp;x-signature=vcTtGevqTQEONyDgOWPomtewlm8%3D" alt="" loading="lazy"/></p>
<p><strong>ã€ŒæŠ€æœ¯å¹³æƒçš„åŠ é€Ÿã€</strong></p>
<p>2026 å¹´åˆçš„è¿™ä¸€å¹•ï¼Œå¯èƒ½å°†ä½œä¸º AI è½åœ°å²ä¸Šçš„ç»å…¸æ¡ˆä¾‹è¢«åå¤æåŠã€‚</p>
<p>å®ƒè¯æ˜äº†åœ¨æ™ºèƒ½ä½“æ—¶ä»£ï¼Œåº”ç”¨å±‚çš„æŠ¤åŸæ²³æ¯”æƒ³è±¡ä¸­æ›´æµ…ã€‚</p>
<p>åªè¦åº•å±‚æ¨¡å‹çš„ API æ˜¯å¼€æ”¾çš„ï¼Œä»»ä½•æ˜‚è´µçš„é—­æºåº”ç”¨ï¼Œéƒ½ä¼šåœ¨æçŸ­æ—¶é—´å†…è¿æ¥å¼€æºç¤¾åŒºçš„é™ç»´æ‰“å‡»ã€‚</p>
<p>Openwork å°±åƒä¸€æ¡é²¶é±¼ï¼Œæ…åŠ¨äº†åŸæœ¬æ²‰é—·çš„å®šä»·ä½“ç³»ã€‚</p>
<p>å®ƒä¸ä»…è¿«ä½¿å·¨å¤´ä½å¤´ï¼Œæ›´åŠ é€Ÿäº† AI æ™ºèƒ½ä½“ä»ã€Œé«˜ç§‘æŠ€å±•ç¤ºå“ã€å‘ã€Œæ—¥ç”¨å·¥å…·ã€çš„è½¬åŒ–ã€‚</p>
<p>å¯¹äºç”¨æˆ·è€Œè¨€ï¼Œæ— è®ºé€‰æ‹©å¼€æºçš„ Openwork è¿˜æ˜¯é™ä»·åçš„ Coworkï¼Œéƒ½æ˜¯èµ¢å®¶ã€‚</p>
<p>å½“æŠ€æœ¯è¯•å›¾é€šè¿‡é«˜ä»·è‡ªæˆ‘ç¥åŒ–æ—¶ï¼Œä»£ç æ€»ä¼šæ‰¾åˆ°å›å½’å¤§ä¼—çš„è·¯å¾„ã€‚</p>
<p>å‚è€ƒèµ„æ–™ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.accomplish.ai%2Fopenwork%2F" target="_blank" title="https://www.accomplish.ai/openwork/" ref="nofollow noopener noreferrer">www.accomplish.ai/openwork/</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Rustå®ç”¨å·¥å…·ç‰¹å‹-Copy]]></title>    <link>https://juejin.cn/post/7596684490660872226</link>    <guid>https://juejin.cn/post/7596684490660872226</guid>    <pubDate>2026-01-19T08:19:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596684490660872226" data-draft-id="7596342451349913640" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Rustå®ç”¨å·¥å…·ç‰¹å‹-Copy"/> <meta itemprop="keywords" content="Rust"/> <meta itemprop="datePublished" content="2026-01-19T08:19:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å™—å™œå™—å™œå•ª"/> <meta itemprop="url" content="https://juejin.cn/user/4037062427148462"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Rustå®ç”¨å·¥å…·ç‰¹å‹-Copy
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4037062427148462/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å™—å™œå™—å™œå•ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T08:19:52.000Z" title="Mon Jan 19 2026 08:19:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><code>Copy</code>Â trait è®©ç®€å•ç±»å‹åœ¨èµ‹å€¼æˆ–ä¼ å‚æ—¶è‡ªåŠ¨å¤åˆ¶ï¼Œä¸è½¬ç§»æ‰€æœ‰æƒã€‚</p>
<p>å®ƒç‰¹æ®Šåœ¨å“ªï¼Ÿä¸éœ€è¦ä½ å†™ä»»ä½•ä»£ç ï¼Œå°±æ˜¯ä¸ªã€Œæ ‡è®°ã€ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨ã€Œè¿™ç©æ„å„¿å¯ä»¥æŒ‰ä½å¤åˆ¶ã€ã€‚</p>
<h2 data-id="heading-0">æ ¸å¿ƒæ¦‚å¿µ</h2>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒRust çš„èµ‹å€¼ä¼šè½¬ç§»æ‰€æœ‰æƒï¼š</p>
<pre><code class="hljs language-ini" lang="ini">let <span class="hljs-attr">s1</span> = String::from(<span class="hljs-string">"hello"</span>)<span class="hljs-comment">;</span>
let <span class="hljs-attr">s2</span> = s1<span class="hljs-comment">;  // s1 çš„æ‰€æœ‰æƒè½¬ç§»ç»™ s2</span>
// println!("{}", s1)<span class="hljs-comment">;  // é”™è¯¯ï¼s1 å·²å¤±æ•ˆ</span>
</code></pre>
<p>ä½†å¯¹äºç®€å•ç±»å‹ï¼Œè¿™æ ·å¤ªéº»çƒ¦äº†ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">let <span class="hljs-attr">x</span> = <span class="hljs-number">5</span><span class="hljs-comment">;</span>
let <span class="hljs-attr">y</span> = x<span class="hljs-comment">;  // x è‡ªåŠ¨å¤åˆ¶ï¼Œè¿˜èƒ½ç”¨</span>
println!("{}", x)<span class="hljs-comment">;  // æ²¡é—®é¢˜</span>
</code></pre>
<p>è¿™å°±æ˜¯Â <code>Copy</code>ï¼šèµ‹å€¼æ—¶è‡ªåŠ¨å¤åˆ¶ï¼ŒåŸæ¥çš„å€¼è¿˜åœ¨ã€‚</p>
<h3 data-id="heading-1">Copy vs Clone</h3>



































<table><thead><tr><th>ç‰¹æ€§</th><th>Copy</th><th>Clone</th></tr></thead><tbody><tr><td>è°ƒç”¨æ–¹å¼</td><td>è‡ªåŠ¨ï¼ˆéšå¼ï¼‰</td><td>æ‰‹åŠ¨è°ƒç”¨Â <code>.clone()</code></td></tr><tr><td>æˆæœ¬</td><td>å»‰ä»·ï¼ˆæŒ‰ä½å¤åˆ¶ï¼‰</td><td>å¯èƒ½æ˜‚è´µï¼ˆæ·±æ‹·è´ï¼‰</td></tr><tr><td>é€‚ç”¨ç±»å‹</td><td>ç®€å•ç±»å‹ï¼ˆæ ˆæ•°æ®ï¼‰</td><td>ä»»ä½•ç±»å‹</td></tr><tr><td>trait ç±»å‹</td><td>æ ‡è®° traitï¼ˆæ— æ–¹æ³•ï¼‰</td><td>æ™®é€š traitï¼ˆæœ‰Â <code>clone</code>Â æ–¹æ³•ï¼‰</td></tr><tr><td>å®ç°æ–¹å¼</td><td><code>#[derive(Copy, Clone)]</code></td><td><code>#[derive(Clone)]</code>Â æˆ–æ‰‹åŠ¨å®ç°</td></tr></tbody></table>
<h3 data-id="heading-2">Copy trait å®šä¹‰</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">trait</span> <span class="hljs-title class_">Copy</span>: <span class="hljs-built_in">Clone</span> {
    <span class="hljs-comment">// ç©ºçš„ï¼</span>
}
</code></pre>
<p>ä¸¤ä¸ªå…³é”®ç‚¹ï¼š</p>
<ul>
<li><strong>Copy ç»§æ‰¿è‡ª Clone</strong>ï¼šæƒ³å®ç°Â <code>Copy</code>Â å¿…é¡»å…ˆå®ç°Â <code>Clone</code></li>
<li><strong>æ²¡æœ‰æ–¹æ³•</strong>ï¼šç¼–è¯‘å™¨çœ‹åˆ°è¿™ä¸ªæ ‡è®°å°±çŸ¥é“å¯ä»¥æŒ‰ä½å¤åˆ¶äº†</li>
</ul>
<h2 data-id="heading-3">åº•å±‚åŸç†</h2>
<h3 data-id="heading-4">æŒ‰ä½å¤åˆ¶æ˜¯å•¥ï¼Ÿ</h3>
<p>å°±æ˜¯æŠŠå†…å­˜é‡Œçš„å­—èŠ‚åŸæ ·å¤åˆ¶åˆ°æ–°ä½ç½®ï¼Œåƒå¤å°æœºï¼š</p>
<pre><code class="hljs language-ini" lang="ini">let x: <span class="hljs-attr">i32</span> = <span class="hljs-number">42</span><span class="hljs-comment">;  // å†…å­˜ï¼š00 00 00 2Aï¼ˆ4 å­—èŠ‚ï¼‰</span>
let <span class="hljs-attr">y</span> = x<span class="hljs-comment">;        // æŠŠè¿™ 4 ä¸ªå­—èŠ‚å¤åˆ¶åˆ°æ–°ä½ç½®</span>
</code></pre>
<p>å¿«å¾—å¾ˆï¼Œä¸€æ¡ CPU æŒ‡ä»¤æå®šã€‚æ‰€ä»¥ Rust å…è®¸å®ƒéšå¼å‘ç”Ÿã€‚</p>
<h3 data-id="heading-5">String ä¸ºå•¥ä¸èƒ½ Copyï¼Ÿ</h3>
<p><code>String</code>Â åœ¨æ ˆä¸Šå­˜æŒ‡é’ˆã€é•¿åº¦ã€å®¹é‡ï¼ŒçœŸæ­£çš„æ•°æ®åœ¨å †ä¸Šï¼š</p>
<pre><code class="hljs language-css" lang="css">æ ˆï¼š<span class="hljs-selector-attr">[ptr | len: 5 | cap: 5]</span>
      â†“
å †ï¼š  <span class="hljs-selector-attr">[h]</span><span class="hljs-selector-attr">[e]</span><span class="hljs-selector-attr">[l]</span><span class="hljs-selector-attr">[l]</span><span class="hljs-selector-attr">[o]</span>
</code></pre>
<p>å¦‚æœæŒ‰ä½å¤åˆ¶ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s1</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"hello"</span>);
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s2</span> = s1;  <span class="hljs-comment">// å‡è®¾èƒ½ Copy</span>
<span class="hljs-comment">// ç°åœ¨ s1 å’Œ s2 çš„æŒ‡é’ˆéƒ½æŒ‡å‘åŒä¸€å—å †å†…å­˜</span>
<span class="hljs-comment">// ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œs1 é‡Šæ”¾å†…å­˜ï¼Œs2 ä¹Ÿé‡Šæ”¾</span>
<span class="hljs-comment">// ğŸ’¥ double freeï¼</span>
</code></pre>
<p>æ‰€ä»¥ Copy æœ‰ä¸ªé“å¾‹ï¼š<strong>æŒ‰ä½å¤åˆ¶åï¼ŒåŸå€¼å’Œæ–°å€¼å¿…é¡»èƒ½ç‹¬ç«‹å­˜åœ¨</strong>ã€‚</p>
<h2 data-id="heading-6">å“ªäº›ç±»å‹èƒ½ Copyï¼Ÿ</h2>
<h3 data-id="heading-7">èƒ½ Copy çš„</h3>









































<table><thead><tr><th>ç±»å‹</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>æ‰€æœ‰æ•´æ•°ç±»å‹</td><td><code>i8</code>,Â <code>i32</code>,Â <code>u64</code>,Â <code>isize</code>Â ç­‰</td></tr><tr><td>æ‰€æœ‰æµ®ç‚¹ç±»å‹</td><td><code>f32</code>,Â <code>f64</code></td></tr><tr><td>å¸ƒå°”ç±»å‹</td><td><code>bool</code></td></tr><tr><td>å­—ç¬¦ç±»å‹</td><td><code>char</code></td></tr><tr><td>ä¸å¯å˜å¼•ç”¨</td><td><code>&amp;T</code>ï¼ˆæ³¨æ„ï¼š<code>&amp;mut T</code>Â ä¸èƒ½ Copyï¼‰</td></tr><tr><td>å…ƒç»„ï¼ˆæ‰€æœ‰å…ƒç´ éƒ½ Copyï¼‰</td><td><code>(i32, bool)</code></td></tr><tr><td>æ•°ç»„ï¼ˆå…ƒç´ ç±»å‹ Copyï¼‰</td><td><code>[i32; 10]</code></td></tr><tr><td>å‡½æ•°æŒ‡é’ˆ</td><td><code>fn(i32) -&gt; i32</code></td></tr></tbody></table>
<h3 data-id="heading-8">ä¸èƒ½ Copy çš„</h3>

































<table><thead><tr><th>ç±»å‹</th><th>åŸå› </th></tr></thead><tbody><tr><td><code>String</code></td><td>æ‹¥æœ‰å †å†…å­˜</td></tr><tr><td><code>Vec&lt;T&gt;</code></td><td>æ‹¥æœ‰å †å†…å­˜</td></tr><tr><td><code>Box&lt;T&gt;</code></td><td>æ‹¥æœ‰å †å†…å­˜</td></tr><tr><td><code>Rc&lt;T&gt;</code>,Â <code>Arc&lt;T&gt;</code></td><td>éœ€è¦ç®¡ç†å¼•ç”¨è®¡æ•°</td></tr><tr><td><code>&amp;mut T</code></td><td>å¯å˜å¼•ç”¨å¿…é¡»å”¯ä¸€</td></tr><tr><td>å®ç°äº†Â <code>Drop</code>Â çš„ç±»å‹</td><td>éœ€è¦è‡ªå®šä¹‰æ¸…ç†é€»è¾‘</td></tr></tbody></table>
<h3 data-id="heading-9">è‡ªå®šä¹‰ç±»å‹å’‹åŠï¼Ÿ</h3>
<p>æ‰€æœ‰å­—æ®µéƒ½æ˜¯ Copyï¼Œå°±èƒ½æ´¾ç”Ÿï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-meta">#[derive(Copy, Clone)]</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Point</span> {
    x: <span class="hljs-type">i32</span>,
    y: <span class="hljs-type">i32</span>,
}

<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">p1</span> = Point { x: <span class="hljs-number">1</span>, y: <span class="hljs-number">2</span> };
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">p2</span> = p1;  <span class="hljs-comment">// è‡ªåŠ¨å¤åˆ¶</span>
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"{}, {}"</span>, p1.x, p2.x);  <span class="hljs-comment">// éƒ½èƒ½ç”¨</span>
</code></pre>
<p>è®°å¾—åŒæ—¶æ´¾ç”ŸÂ <code>Clone</code>ï¼Œå› ä¸ºÂ <code>Copy</code>Â ç»§æ‰¿è‡ªå®ƒã€‚</p>
<h2 data-id="heading-10">ä½¿ç”¨åœºæ™¯</h2>
<h3 data-id="heading-11">å°å‹æ•°æ®ç»“æ„</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// åæ ‡ç‚¹ï¼š8 å­—èŠ‚ï¼Œé€‚åˆ Copy</span>
<span class="hljs-meta">#[derive(Copy, Clone)]</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Point</span> {
    x: <span class="hljs-type">f32</span>,
    y: <span class="hljs-type">f32</span>,
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">distance</span>(p1: Point, p2: Point) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">f32</span> {
    <span class="hljs-comment">// æŒ‰å€¼ä¼ é€’ï¼Œè‡ªåŠ¨å¤åˆ¶</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">dx</span> = p1.x - p2.x;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">dy</span> = p1.y - p2.y;
    (dx * dx + dy * dy).<span class="hljs-title function_ invoke__">sqrt</span>()
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">origin</span> = Point { x: <span class="hljs-number">0.0</span>, y: <span class="hljs-number">0.0</span> };
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">point</span> = Point { x: <span class="hljs-number">3.0</span>, y: <span class="hljs-number">4.0</span> };
    
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">d</span> = <span class="hljs-title function_ invoke__">distance</span>(origin, point);
    <span class="hljs-comment">// origin å’Œ point ä»ç„¶å¯ç”¨ï¼</span>
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"è·ç¦»: {}"</span>, d);
}
</code></pre>
<h3 data-id="heading-12">é…ç½®å‚æ•°</h3>
<pre><code class="hljs language-arduino" lang="arduino">#[<span class="hljs-built_in">derive</span>(Copy, Clone)]
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Config</span> {
    width: u32,
    height: u32,
    fullscreen: <span class="hljs-type">bool</span>,
}

<span class="hljs-function">fn <span class="hljs-title">apply_config</span><span class="hljs-params">(config: Config)</span> </span>{
    <span class="hljs-comment">// æŒ‰å€¼ä¼ é€’ï¼Œä¸éœ€è¦å¼•ç”¨</span>
    println!(<span class="hljs-string">"è®¾ç½®åˆ†è¾¨ç‡: {}x{}"</span>, config.width, config.height);
}

<span class="hljs-function">fn <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    let config = Config {
        width: <span class="hljs-number">1920</span>,
        height: <span class="hljs-number">1080</span>,
        fullscreen: <span class="hljs-literal">true</span>,
    };
    
    <span class="hljs-built_in">apply_config</span>(config);  <span class="hljs-comment">// è‡ªåŠ¨å¤åˆ¶</span>
    <span class="hljs-built_in">apply_config</span>(config);  <span class="hljs-comment">// å¯ä»¥å¤šæ¬¡ä½¿ç”¨</span>
}
</code></pre>
<h3 data-id="heading-13">æ•°å­¦è¿ç®—</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-meta">#[derive(Copy, Clone)]</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Color</span> {
    r: <span class="hljs-type">u8</span>,
    g: <span class="hljs-type">u8</span>,
    b: <span class="hljs-type">u8</span>,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Color</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">blend</span>(<span class="hljs-keyword">self</span>, other: Color) <span class="hljs-punctuation">-&gt;</span> Color {
        <span class="hljs-comment">// æŒ‰å€¼æ¥æ”¶ï¼Œè‡ªåŠ¨å¤åˆ¶</span>
        Color {
            r: (<span class="hljs-keyword">self</span>.r <span class="hljs-keyword">as</span> <span class="hljs-type">u16</span> + other.r <span class="hljs-keyword">as</span> <span class="hljs-type">u16</span>) <span class="hljs-keyword">as</span> <span class="hljs-type">u8</span> / <span class="hljs-number">2</span>,
            g: (<span class="hljs-keyword">self</span>.g <span class="hljs-keyword">as</span> <span class="hljs-type">u16</span> + other.g <span class="hljs-keyword">as</span> <span class="hljs-type">u16</span>) <span class="hljs-keyword">as</span> <span class="hljs-type">u8</span> / <span class="hljs-number">2</span>,
            b: (<span class="hljs-keyword">self</span>.b <span class="hljs-keyword">as</span> <span class="hljs-type">u16</span> + other.b <span class="hljs-keyword">as</span> <span class="hljs-type">u16</span>) <span class="hljs-keyword">as</span> <span class="hljs-type">u8</span> / <span class="hljs-number">2</span>,
        }
    }
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">red</span> = Color { r: <span class="hljs-number">255</span>, g: <span class="hljs-number">0</span>, b: <span class="hljs-number">0</span> };
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">blue</span> = Color { r: <span class="hljs-number">0</span>, g: <span class="hljs-number">0</span>, b: <span class="hljs-number">255</span> };
    
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">purple</span> = red.<span class="hljs-title function_ invoke__">blend</span>(blue);  <span class="hljs-comment">// red å’Œ blue ä»ç„¶å¯ç”¨</span>
}
</code></pre>
<h2 data-id="heading-14">å¸¸è§å‘</h2>
<h3 data-id="heading-15">å°ç±»å‹ä¸ç­‰äºèƒ½ Copy</h3>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// é”™ï¼å°±ç®—åªæœ‰ä¸€ä¸ªå­—æ®µï¼ŒString ä¸æ˜¯ Copy</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Name</span> {
    value: <span class="hljs-type">String</span>,
}

<span class="hljs-comment">// ç¼–è¯‘é”™è¯¯</span>
<span class="hljs-comment">// #[derive(Copy, Clone)]</span>
<span class="hljs-comment">// struct Name { value: String }</span>
</code></pre>
<p>ä¸€ä¸ªå­—æ®µä¸æ˜¯ Copyï¼Œæ•´ä¸ªç»“æ„ä½“å°±ä¸è¡Œã€‚</p>
<h3 data-id="heading-16">Copy å’Œ Drop ä¸èƒ½å…±å­˜</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-meta">#[derive(Copy, Clone)]</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Resource</span> {
    id: <span class="hljs-type">i32</span>,
}

<span class="hljs-comment">// é”™ï¼Copy ç±»å‹ä¸èƒ½å®ç° Drop</span>
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Drop</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">Resource</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">drop</span>(&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>) {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"é‡Šæ”¾èµ„æº {}"</span>, <span class="hljs-keyword">self</span>.id);
    }
}
</code></pre>
<p>ä¸ºå•¥ï¼ŸCopy ç±»å‹ä¼šè¢«éšå¼å¤åˆ¶å¤šæ¬¡ï¼Œæœ‰ Drop çš„è¯åŒä¸€ä¸ªèµ„æºä¼šè¢«é‡Šæ”¾å¤šæ¬¡ã€‚</p>
<h3 data-id="heading-17">å¤§ç»“æ„ä½“åˆ« Copy</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// åˆ«è¿™ä¹ˆå¹²ï¼1024 å­—èŠ‚</span>
<span class="hljs-meta">#[derive(Copy, Clone)]</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">BigData</span> {
    buffer: [<span class="hljs-type">u8</span>; <span class="hljs-number">1024</span>],
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">process</span>(data: BigData) {
    <span class="hljs-comment">// æ¯æ¬¡è°ƒç”¨å¤åˆ¶ 1024 å­—èŠ‚</span>
}
</code></pre>
<p>è¶…è¿‡ 16-32 å­—èŠ‚çš„ï¼Œç”¨å¼•ç”¨ã€‚</p>
<h3 data-id="heading-18">å¯å˜å¼•ç”¨ä¸èƒ½ Copy</h3>
<pre><code class="hljs language-ini" lang="ini">let mut <span class="hljs-attr">x</span> = <span class="hljs-number">5</span><span class="hljs-comment">;</span>
let <span class="hljs-attr">r1</span> = &amp;mut x<span class="hljs-comment">;</span>
let <span class="hljs-attr">r2</span> = r1<span class="hljs-comment">;  // æ‰€æœ‰æƒè½¬ç§»</span>

// println!("{}", r1)<span class="hljs-comment">;  // é”™ï¼r1 å¤±æ•ˆäº†</span>
</code></pre>
<p>å¯å˜å¼•ç”¨å¿…é¡»å”¯ä¸€ï¼Œèƒ½ Copy å°±ä¼šæœ‰å¤šä¸ªå¯å˜å¼•ç”¨æŒ‡å‘åŒä¸€ä¸ªå€¼ï¼Œè¿åå€Ÿç”¨è§„åˆ™ã€‚</p>
<h2 data-id="heading-19">Copy vs Clone æ€ä¹ˆé€‰ï¼Ÿ</h2>



































<table><thead><tr><th>æƒ…å†µ</th><th>ç”¨å•¥</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>ç®€å•æ•°å€¼</td><td><code>Copy</code></td><td><code>i32</code>,Â <code>f64</code>,Â <code>bool</code></td></tr><tr><td>å°ç»“æ„ä½“ï¼ˆâ‰¤16 å­—èŠ‚ï¼‰</td><td><code>Copy</code></td><td><code>Point</code>,Â <code>Color</code></td></tr><tr><td>æœ‰å †æ•°æ®</td><td>åªÂ <code>Clone</code></td><td><code>String</code>,Â <code>Vec&lt;T&gt;</code></td></tr><tr><td>å¤§ç»“æ„ä½“ï¼ˆ&gt;16 å­—èŠ‚ï¼‰</td><td>åªÂ <code>Clone</code>Â æˆ–å¼•ç”¨</td><td>é…ç½®å¯¹è±¡</td></tr><tr><td>éœ€è¦è‡ªå®šä¹‰æ¸…ç†</td><td>åªÂ <code>Clone</code></td><td>å®ç°äº†Â <code>Drop</code>Â çš„</td></tr></tbody></table>
<h2 data-id="heading-20">æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-21">èƒ½ Copy å°± Copy</h3>
<p>æ»¡è¶³æ¡ä»¶å°±å®ç°ï¼Œä»£ç ç®€æ´ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// æœ‰ Copyï¼šç®€æ´</span>
<span class="hljs-selector-tag">fn</span> <span class="hljs-selector-tag">add</span>(<span class="hljs-attribute">a</span>: Point, <span class="hljs-attribute">b</span>: Point) <span class="hljs-selector-tag">-</span>&gt; <span class="hljs-selector-tag">Point</span> { ... }

<span class="hljs-comment">// æ²¡ Copyï¼šå¾—ç”¨å¼•ç”¨æˆ– clone</span>
<span class="hljs-selector-tag">fn</span> <span class="hljs-selector-tag">add</span>(<span class="hljs-attribute">a</span>: &amp;Point, <span class="hljs-attribute">b</span>: &amp;Point) <span class="hljs-selector-tag">-</span>&gt; <span class="hljs-selector-tag">Point</span> { ... }
</code></pre>
<h3 data-id="heading-22">ä¿æŒå°å·§</h3>
<p>æƒ³ Copy å°±åˆ«è¶…è¿‡ 16 å­—èŠ‚ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// å¥½ï¼š8 å­—èŠ‚</span>
<span class="hljs-meta">#[derive(Copy, Clone)]</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Point</span> { x: <span class="hljs-type">f32</span>, y: <span class="hljs-type">f32</span> }

<span class="hljs-comment">// åˆ«ï¼š1024 å­—èŠ‚</span>
<span class="hljs-meta">#[derive(Copy, Clone)]</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">BigBuffer</span> { data: [<span class="hljs-type">u8</span>; <span class="hljs-number">1024</span>] }
</code></pre>
<h3 data-id="heading-23">å†™æ–‡æ¡£</h3>
<p>å®ç°äº† Copy å°±è¯´ä¸€å£°ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">/// 2D åæ ‡ç‚¹ï¼ˆCopyï¼Œå¤åˆ¶å¾ˆä¾¿å®œï¼‰</span>
<span class="hljs-meta">#[derive(Copy, Clone)]</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Point</span> {
    x: <span class="hljs-type">f32</span>,
    y: <span class="hljs-type">f32</span>,
}
</code></pre>
<h3 data-id="heading-24">åˆ«æ»¥ç”¨</h3>
<p>ç±»å‹ä»£è¡¨ã€Œèµ„æºã€æˆ–ã€Œå”¯ä¸€å®ä½“ã€ï¼Œåˆ« Copyï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// åˆ« Copyï¼šä»£è¡¨å”¯ä¸€çš„æ–‡ä»¶å¥æŸ„</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">File</span> {
    fd: <span class="hljs-type">i32</span>,
}

<span class="hljs-comment">// å¯ä»¥ Copyï¼šå°±æ˜¯ä¸ªæ•°å€¼</span>
<span class="hljs-meta">#[derive(Copy, Clone)]</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">FileDescriptor</span>(<span class="hljs-type">i32</span>);
</code></pre>
<h2 data-id="heading-25">æ€»ç»“</h2>
<ul>
<li>Copy æ˜¯éšå¼çš„æŒ‰ä½å¤åˆ¶ï¼Œèµ‹å€¼æ—¶è‡ªåŠ¨å¤åˆ¶</li>
<li>åªæœ‰ç®€å•ç±»å‹èƒ½ Copyï¼šä¸èƒ½æœ‰å †æ•°æ®ã€ä¸èƒ½å®ç° Drop</li>
<li>Copy å¿…é¡»é…åˆ Cloneï¼Œå› ä¸ºå®ƒç»§æ‰¿è‡ª Clone</li>
<li>é€‚åˆå°å‹æ ˆæ•°æ®ï¼Œè¶…è¿‡ 16 å­—èŠ‚è€ƒè™‘ç”¨å¼•ç”¨</li>
</ul>
<p>Copy è®©ç®€å•ç±»å‹ç”¨èµ·æ¥åƒå…¶ä»–è¯­è¨€çš„åŸºæœ¬ç±»å‹ä¸€æ ·è‡ªç„¶ï¼Œä½† Rust çš„è§„åˆ™ä¿è¯äº†è¿™ç§ä¾¿åˆ©æ˜¯å®‰å…¨çš„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[nodeå…¨æ ˆ(ä¸€)ï¼šä» é›¶åˆ°å¯ç”¨ä¹‹åœ¨é˜¿é‡Œäº‘ Ubuntu ä¸Šéƒ¨ç½² Jenkinsï¼ˆDocker æ–¹å¼ï¼‰]]></title>    <link>https://juejin.cn/post/7596926832912252991</link>    <guid>https://juejin.cn/post/7596926832912252991</guid>    <pubDate>2026-01-19T10:10:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596926832912252991" data-draft-id="7595626157908099081" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="nodeå…¨æ ˆ(ä¸€)ï¼šä» é›¶åˆ°å¯ç”¨ä¹‹åœ¨é˜¿é‡Œäº‘ Ubuntu ä¸Šéƒ¨ç½² Jenkinsï¼ˆDocker æ–¹å¼ï¼‰"/> <meta itemprop="keywords" content="Node.js,Docker,Jenkins"/> <meta itemprop="datePublished" content="2026-01-19T10:10:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ·®æ¡‘æ¦†"/> <meta itemprop="url" content="https://juejin.cn/user/3397929986176872"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            nodeå…¨æ ˆ(ä¸€)ï¼šä» é›¶åˆ°å¯ç”¨ä¹‹åœ¨é˜¿é‡Œäº‘ Ubuntu ä¸Šéƒ¨ç½² Jenkinsï¼ˆDocker æ–¹å¼ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3397929986176872/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ·®æ¡‘æ¦†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T10:10:59.000Z" title="Mon Jan 19 2026 10:10:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ–‡ç« å‰è¨€</h2>
<p><strong>æ°¸è¿œæŠŠåˆ«äººå¯¹ä½ çš„æ‰¹è¯„è®°åœ¨å¿ƒé‡Œï¼Œåˆ«äººçš„è¡¨æ‰¬ï¼Œå°±æŠŠå®ƒå¿˜äº†ã€‚Hello å¤§å®¶å¥½ï½ï¼æˆ‘æ˜¯æ·®æ¡‘æ¦†</strong></p>
<p>æœ¬æ–‡ä¸»è¦æ˜¯è®°å½•å¦‚ä½•åœ¨é˜¿é‡Œäº‘ Ubuntu ä¸Šä½¿ç”¨Dockeréƒ¨ç½² Jenkinsï¼Œç‰¹åœ°è®°å½•ä¸‹ä¸è¯¸ä½åˆ†äº«ï¼Œå¦‚æœ‰é˜è¿°ä¸å¯¹çš„åœ°æ–¹æ¬¢è¿åœ¨è¯„è®ºåŒºæŒ‡æ­£ã€‚</p>
<p>è§‚çœ‹åˆ°æ–‡ç« æœ€åçš„è¯ï¼Œå¦‚æœè§‰å¾—ä¸é”™ï¼Œå¯ä»¥ç‚¹ä¸ªå…³æ³¨æˆ–è€…ç‚¹ä¸ªèµå“¦ï¼æ„Ÿè°¢ï½â¤ï¸</p>
<h2 data-id="heading-1">æ–‡ç« ä¸»ä½“</h2>
<p>æ„Ÿè°¢å„ä½è§‚è€…çš„è€å¿ƒè§‚çœ‹ï¼Œ<em>åœ¨é˜¿é‡Œäº‘ Ubuntu ä¸Šä½¿ç”¨Dockeréƒ¨ç½² Jenkins</em>çš„æ­£ç‰‡å³å°†å¼€å§‹ï¼Œä¸”å¬æ·®æ¡‘æ¦†å¨“å¨“é“æ¥</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c369a1777c0d49ae9f6c99fbec74d6a0~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=941&amp;h=515&amp;s=533990&amp;e=png&amp;b=c5d9e6" alt="image.png" loading="lazy"/></p>
<p><strong>å½“å‰ä½¿ç”¨çš„é˜¿é‡Œäº‘æœåŠ¡å™¨é…ç½®ï¼šUbuntu 22.04 64ä½ï¼Œ2 æ ¸ï¼ˆvCPUï¼‰2 GiB</strong></p>
<h3 data-id="heading-2">æ­å»ºDocker</h3>
<h4 data-id="heading-3">ç™»å½•æœåŠ¡å™¨</h4>
<pre><code class="hljs language-kotlin" lang="kotlin">ssh <span class="hljs-symbol">root@</span>ä½ çš„å…¬ç½‘IP
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98cc8eba7b2a49b09d439240cb6fc246~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=t2%2B7jcg65D1Hgnxq9M9tTUKag1w%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-4">æ›´æ–°ç³»ç»Ÿï¼ˆå»ºè®®ï¼‰</h4>
<pre><code class="hljs language-sql" lang="sql">sudo apt <span class="hljs-keyword">update</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7063b58509f1422b80f90e733a59dd21~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=3wAlDod1kUTkBwszcy%2Fcf17bESE%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-5">å®‰è£…ä¾èµ–</h4>
<pre><code class="hljs language-arduino" lang="arduino">sudo apt install -y ca-certificates curl gnupg lsb-release
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb7a3da8f2f84f82baa2a2d2de26f42d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=h27b5ssi5nVSpP9QPYWlxEiBPPQ%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-6">æ·»åŠ Dockerå®˜æ–¹GPG Key</h4>
<pre><code class="hljs language-bash" lang="bash">sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/68869601091d47c284230484c9589f65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=eeD7VHqzKi9sOd51fL6BpDtjxNM%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-7">æ·»åŠ Dockerå®˜æ–¹ä»“åº“</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">"deb [arch=<span class="hljs-subst">$(dpkg --print-architecture)</span> signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://mirrors.aliyun.com/docker-ce/linux/ubuntu <span class="hljs-subst">$(lsb_release -cs)</span> stable"</span> | sudo <span class="hljs-built_in">tee</span> /etc/apt/sources.list.d/docker.list &gt; /dev/null
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e72157e387434381ac84fca6cf0c47e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=wLX8w%2FSX%2BZRrD0lXoLD7Dlpbclw%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-8">å®‰è£…Dockerå¼•æ“</h4>
<pre><code class="hljs language-lua" lang="lua">sudo apt update
apt install docker-ce docker-ce-cli containerd.<span class="hljs-built_in">io</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5951111bfa72439387de4c12cbee6dd1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=NlADSqFbsWqU3EEFLI%2FaQOp0NIs%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-9">å¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯</h4>
<pre><code class="hljs language-bash" lang="bash">sudo systemctl start docker
sudo systemctl <span class="hljs-built_in">enable</span> docker
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d95461a3961488b9cd38d3989b80e46~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=CM58Ca8Q76ergcW%2FapPKYajeo20%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-10">éªŒè¯ Docker</h4>
<pre><code class="hljs">docker -v
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7cb426a4332e48a3abc3e7d96194bcf0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=f2enEO9EQ7trmOjNrPiiBbl9o0Y%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-11">å®æµ‹æ‹‰é•œåƒ</h4>
<pre><code class="hljs">docker pull hello-world
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12d2dcb5cd754b9586a3bc191c0bb835~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=jDqeoFcxaBikiLz4Uf6GvFRDIE4%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-12">ä½¿ç”¨Dockeréƒ¨ç½²Jenkins</h3>
<h4 data-id="heading-13">æ‹‰Jenkinsé•œåƒ</h4>
<pre><code class="hljs language-bash" lang="bash">docker pull jenkins/jenkins:lts
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0039e6ea30141da951c167c9310d297~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=ub2HPa6d9nif4iXWaWCzXMAVJj4%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-14">åˆ›å»º Jenkins æ•°æ®ç›®å½•</h4>
<pre><code class="hljs language-bash" lang="bash">sudo <span class="hljs-built_in">mkdir</span> -p /data/jenkins
sudo <span class="hljs-built_in">chown</span> -R 1000:1000 /data/jenkins
</code></pre>
<ul>
<li>Jenkins å®¹å™¨é‡Œç”¨æˆ· UID æ˜¯ <strong>1000</strong></li>
<li>ä¸æ”¹æƒé™ä¼šç›´æ¥å¯åŠ¨å¤±è´¥</li>
</ul>
<h4 data-id="heading-15">å¯åŠ¨ Jenkins</h4>
<pre><code class="hljs language-ini" lang="ini">docker run -d \
  --name jenkins \
  <span class="hljs-attr">--restart</span>=unless-stopped \
  -p 8080:8080 \
  -p 50000:50000 \
  -v /data/jenkins:/var/jenkins_home \
  -e <span class="hljs-attr">JAVA_OPTS</span>=<span class="hljs-string">"-Xms512m -Xmx1024m"</span> \
  jenkins/jenkins:lts
</code></pre>
<h4 data-id="heading-16">ç¡®è®¤ Jenkins æ˜¯å¦æ­£å¸¸è¿è¡Œ</h4>
<pre><code class="hljs">docker ps
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a0234cd120aa4c3facbf7095c308b644~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=1pk1jvtAxr4N4%2Fl0e2amB6qBd6Q%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-17">è·å– Jenkins åˆå§‹å¯†ç </h4>
<pre><code class="hljs language-bash" lang="bash">docker <span class="hljs-built_in">exec</span> jenkins <span class="hljs-built_in">cat</span> /var/jenkins_home/secrets/initialAdminPassword
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d3308509ef949d5ae37369feaca295f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=gVVu2BnpZonkC%2BORI2WEFnTssLs%3D" alt="image.png" loading="lazy"/></p>
<p><strong>å‘½ä»¤ä¼šè¿”å›ä¸€ä¸²å¯†ç ï¼Œå¤åˆ¶è¾“å‡ºçš„é‚£ä¸€ä¸²å¯†ç </strong></p>
<h4 data-id="heading-18">æµè§ˆå™¨è®¿é—® Jenkins</h4>
<pre><code class="hljs language-arduino" lang="arduino">http:<span class="hljs-comment">//ä½ çš„æœåŠ¡å™¨å…¬ç½‘IP:8080</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e2053ea17e4b4bd3af888609d969bfae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=6kag0PVcIusB4NPrPh2s%2FyMsy0w%3D" alt="image.png" loading="lazy"/></p>
<p><strong>å°†ä¸Šé¢å¤åˆ¶çš„ä¸€ä¸²å¯†ç è¾“å…¥ç½‘é¡µä¸Šçš„ç®¡ç†å‘˜å¯†ç è¾“å…¥æ¡†è¿›è¡Œè§£é”Jenkins</strong></p>
<h4 data-id="heading-19">è§£é”åJenkinsï¼ˆé€‰æ‹©å®‰è£…æ¨èæ’ä»¶ï¼‰</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9b445ce1e424e17b74d61b5662b0fa5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=TwczK%2BWD2CdMdUxN9mxBtFdeDpo%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-20">åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e246e5423f3b49e094747775e96a3b09~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=tTZ32tVU78gyzSXBkl7gReuR2oU%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-21">Jenkinså®‰è£…å·²å®Œæˆ</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c1239961774407c8355d1f23c05e5dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=3GrHWNEgXCOQapRcana4zr837Oo%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-22">å¼€å§‹ä½¿ç”¨Jenkins</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf36dc9b37944e6588c1cab40aca837c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=5VKXsxTwwH%2B%2BE%2BuQ12aTdNyOvA0%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-23">éƒ¨ç½²Nginxï¼ˆåå‘ä»£ç†ï¼‰</h3>
<h4 data-id="heading-24">å®‰è£… Nginx</h4>
<pre><code class="hljs language-sql" lang="sql">sudo apt <span class="hljs-keyword">update</span>
sudo apt install <span class="hljs-operator">-</span>y nginx
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9193e04ca8754a50bc66c7a7a965d8fe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=vkKQev2dXnDjH%2BMiZxOHPQML%2Fwo%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-25">æ–°å»º Nginx ç«™ç‚¹é…ç½®</h4>
<pre><code class="hljs language-arduino" lang="arduino">sudo nano /etc/nginx/sites-available/jenkins
</code></pre>
<h4 data-id="heading-26">åˆ›å»ºNginx</h4>
<pre><code class="hljs language-bash" lang="bash">sudo <span class="hljs-built_in">tee</span> /etc/nginx/sites-available/jenkins &gt; /dev/null &lt;&lt; <span class="hljs-string">'EOF'</span>

server {

Â  Â  listen 80;

Â  Â  server_name åŸŸå;

Â  Â  location /jenkins/ {

Â  Â  Â  Â  proxy_pass http://127.0.0.1:8080/jenkins/;

Â  Â  Â  Â  proxy_set_header Host <span class="hljs-variable">$host</span>;

Â  Â  Â  Â  proxy_set_header X-Real-IP <span class="hljs-variable">$remote_addr</span>;

Â  Â  Â  Â  proxy_set_header X-Forwarded-For <span class="hljs-variable">$proxy_add_x_forwarded_for</span>;

Â  Â  Â  Â  proxy_set_header X-Forwarded-Proto <span class="hljs-variable">$scheme</span>;

Â  Â  Â  Â  proxy_http_version 1.1;

Â  Â  Â  Â  proxy_request_buffering off;

Â  Â  Â  Â  proxy_set_header Upgrade <span class="hljs-variable">$http_upgrade</span>;

Â  Â  Â  Â  proxy_set_header Connection <span class="hljs-string">"Upgrade"</span>;

Â  Â  }
}

EOF
</code></pre>
<h4 data-id="heading-27">å¯ç”¨é…ç½®</h4>
<pre><code class="hljs language-bash" lang="bash">sudo <span class="hljs-built_in">ln</span> -s /etc/nginx/sites-available/jenkins /etc/nginx/sites-enabled/
</code></pre>
<h4 data-id="heading-28">é‡è½½ Nginx</h4>
<pre><code class="hljs">sudo systemctl reload nginx
</code></pre>
<h4 data-id="heading-29">è®¿é—®Jenkins</h4>
<p>é€šè¿‡ <a href="https://link.juejin.cn?target=https%3A%2F%2F%25E5%2585%25AC%25E7%25BD%2591ip(%25E6%2588%2596%25E8%2580%2585%25E5%259F%259F%25E5%2590%258D)%2Fjenkins" target="_blank" title="https://%E5%85%AC%E7%BD%91ip(%E6%88%96%E8%80%85%E5%9F%9F%E5%90%8D)/jenkins" ref="nofollow noopener noreferrer">https://å…¬ç½‘ip(æˆ–è€…åŸŸå)/jenkins</a> è·¯å¾„å°±å¯ä»¥è®¿é—®äº†</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eebf7dc37cd742c3a0bbb5a20e21e345~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5reu5qGR5qaG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769422258&amp;x-signature=0fjZ%2BoX4UFqzsGG72ofG53QXQeo%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-30">ç»“å°¾è¥ä¸š</h2>
<p><strong>çœ‹å®˜éƒ½çœ‹åˆ°è¿™äº†ï¼Œå¦‚æœè§‰å¾—ä¸é”™ï¼Œå¯ä¸å¯ä»¥ä¸åå•¬ä½ çš„å°æ‰‹æ‰‹å¸®å¿™ç‚¹ä¸ªå…³æ³¨æˆ–è€…ç‚¹ä¸ªèµ</strong></p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3731781bef4b43bc81c3b2824c91b6a3~tplv-k3u1fbpfcp-jj-mark:3024:0:0:0:q75.awebp#?w=220&amp;h=220&amp;s=83473&amp;e=gif&amp;f=9&amp;b=fcf7f6" alt="711115f2517eae5e.gif" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŒäº‹ç¦»èŒä¿¡æ²¡é€è¾¾å‰ï¼Œæˆ‘åšäº†æœ€åä¸€æ¬¡è°ˆè¯]]></title>    <link>https://juejin.cn/post/7596864700509159458</link>    <guid>https://juejin.cn/post/7596864700509159458</guid>    <pubDate>2026-01-19T10:14:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596864700509159458" data-draft-id="7596864700509143074" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŒäº‹ç¦»èŒä¿¡æ²¡é€è¾¾å‰ï¼Œæˆ‘åšäº†æœ€åä¸€æ¬¡è°ˆè¯"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-19T10:14:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‹—å¤´å¤§å†›ä¹‹æ±Ÿè‹åˆ†å†›"/> <meta itemprop="url" content="https://juejin.cn/user/2955079655907879"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŒäº‹ç¦»èŒä¿¡æ²¡é€è¾¾å‰ï¼Œæˆ‘åšäº†æœ€åä¸€æ¬¡è°ˆè¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2955079655907879/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‹—å¤´å¤§å†›ä¹‹æ±Ÿè‹åˆ†å†›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T10:14:05.000Z" title="Mon Jan 19 2026 10:14:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>é‚£å¤©ä¸Šåˆï¼Œé¡¹ç›®ç´§å¾—åƒä¸€æ ¹ç»·ç´§çš„å¼¦ã€‚æˆ‘ä»¬å°ç»„æ­£èµ¶ç€ä¸€ä¸ªæœˆåº•è¦äº¤çš„ç‰ˆæœ¬ï¼Œå¤§å®¶éƒ½åœ¨åŠ ç­ï¼Œæ°”æ°›æœ‰ç‚¹æ²‰ã€‚ä¸‹åˆä¸€ç‚¹å¤šï¼ŒHRå·å·åœ¨èŒ¶æ°´é—´å‘Šè¯‰æˆ‘ä¸€ä»¶äº‹ï¼šæœ‰ä¸€å°ç¦»èŒä¿¡å‡†å¤‡äº¤åˆ°äººäº‹æ‰‹é‡Œï¼Œç­¾åå’Œæ—¶é—´éƒ½å†™å¥½äº†ï¼Œåªå·®æŠ•é€’ã€‚åå­—æˆ‘å°±ç”¨åŒ–åå§ï¼Œé˜¿å³°ï¼Œæˆ‘å¸¦äº†ä¸¤å¹´çš„é¡¹ç›®ï¼Œä»–æ€§æ ¼ä¸å¼ æ‰¬ï¼Œä½†åšäº‹è¸å®ã€‚è¿™æ¶ˆæ¯åƒä¸€è‚¡å†·é£ï¼ŒæŠŠæˆ‘åˆšåˆšé¼“èµ·æ¥çš„è€å¿ƒå¹æ•£äº†ã€‚æˆ‘çŸ¥é“ï¼Œå¦‚æœç­‰ä¿¡é€åˆ°ï¼Œåç»­çš„ç¨‹åºå’Œè§£é‡Šéƒ½ä¼šè¢«æ¡æ¬¾å’Œæµç¨‹å¡ä½ï¼Œè¿™æœ€åä¸€æ¬¡è°ˆè¯ï¼Œå¯èƒ½æ˜¯å”¯ä¸€è¿˜èƒ½çœŸæ­£è¯´æ¸…æ¥šçš„æœºä¼šã€‚</p>
<p>æˆ‘æ‰¾ä»–å»äº†å…¬å¸å¤–é¢æ¥¼æ¢¯é—´ï¼Œé‚£åœ°æ–¹æ²¡äººã€‚è§é¢æ—¶ä»–ï¼Œçœ¼ç¥æœ‰ç‚¹é£˜ã€‚å¼€å£å¾ˆç®€å•ï¼šç°åœ¨èŠä¸€ä¸‹å—ã€‚é˜¿å³°ç‚¹äº†ç‚¹å¤´ï¼Œä»–è¯´æœ€è¿‘ç´¯ï¼Œæ™šä¸Šå›å®¶åªæƒ³èººç€ã€‚
ä»–è¯´å¾—å¾ˆå¹³é™ï¼Œè¯´æœ€è¿‘çŠ¶æ€ä¸å¤ªå¯¹ï¼Œæ—©ä¸Šççœ¼å°±å¼€å§‹å€’è®¡æ—¶ä¸‹ç­ï¼Œå‘¨æœ«ä¹Ÿä¸æƒ³æ‰“å¼€ç”µè„‘ï¼Œå“ªæ€•åªæ˜¯çœ‹çœ‹ç¾¤æ¶ˆæ¯éƒ½ä¼šå¿ƒçƒ¦ã€‚è¯´è¿™äº›çš„æ—¶å€™ï¼Œè¯­é€Ÿä¸å¿«ï¼Œä¹Ÿæ²¡æœ‰æƒ…ç»ªçˆ†å‘ï¼Œæ›´ä¸åƒæ˜¯åœ¨æŠ±æ€¨ã€‚ä»–åªæ˜¯é™ˆè¿°ï¼Œå°±åƒåœ¨æè¿°å¤©æ°”ã€‚
é¡¹ç›®é‡Œçš„äº‹æƒ…ä»–è§‰å¾—è¢«å½“æˆäº†ç†æ‰€å½“ç„¶ï¼›å‡ æ¬¡æè¿‡æƒ³æ¢æ–¹å‘ï¼Œè¢«è¯´æˆä¸å¤Ÿä¸Šè¿›ï¼›ç»©æ•ˆå­£è¢«ä¸»ç®¡å½“ç€å¤§ä¼šæ‰¹è¯„ï¼Œé‚£æ¬¡ä¹‹åä»–å°±å¼€å§‹è®¤çœŸè€ƒè™‘ç¦»å¼€ã€‚è¯´ç€ï¼Œä»–æŠŠæ‰‹æœºä»å£è¢‹é‡Œæå‡ºæ¥ï¼Œç¤ºæ„é‚£å°ç¦»èŒä¿¡å·²ç»å†™å¥½ï¼Œåªç­‰å‘è¿‡å»ã€‚æˆ‘èƒ½å¬åˆ°ä»–å£°éŸ³é‡Œä¸€ç‚¹ç‚¹ç ´ç¢çš„å¹³é™ã€‚</p>
<blockquote>
<p>ä»–æ˜¯é‚£ç§å…¸å‹çš„ä¸­å±‚å‘˜å·¥ï¼Œèƒ½åŠ›ä¸ç‚¸è£‚ï¼Œä½†ç¨³å®šå¯é ï¼Œè„¾æ°”ä¸å¤§ï¼Œèƒ½æ‰›äº‹ã€‚é¢†å¯¼ä¸ä¸€å®šç¬¬ä¸€æ—¶é—´æƒ³åˆ°ä»–ï¼Œä½†ä¸€å‡ºé—®é¢˜ï¼Œåå•é‡Œä¸€å®šæœ‰ä»–ã€‚ä¸‰å¹´å¤šï¼Œä»é¡¹ç›®åˆ°é¡¹ç›®ï¼Œä»åŠ ç­åˆ°ç†¬å¤œï¼Œä»–æ²¡å°‘æ’‘åœºé¢ã€‚</p>
</blockquote>
<p>å¬å®Œæˆ‘æ²¡æœ‰é©¬ä¸ŠåŠä»–åˆ«èµ°ï¼Œä¹Ÿæ²¡æœ‰äºŒè¯ä¸è¯´åœ°æ‹¿å‡ºå…¬å¸çš„ç•™äººæ–¹æ¡ˆã€‚æˆ‘ä»¬å…ˆæŠŠè¯é¢˜æ‹‰å›åˆ°äº‹å®ï¼šä½ æƒ³å»çš„æ˜¯å“ªå„¿ï¼Œä¸ºä»€ä¹ˆï¼Œæœ€æƒ³æ”¹å˜çš„æ˜¯ä»€ä¹ˆã€‚é˜¿å³°è¯´æƒ³å»ä¸€å®¶åˆ›ä¸šå…¬å¸ï¼ŒèŒä½æ›´é è¿‘äº§å“ï¼Œä¸ç”¨å¤©å¤©ç›¯ç€æµæ°´çº¿å¼çš„ä»»åŠ¡ï¼›ä»–è¯´å®¶é‡Œæœ‰ç‚¹äº‹ï¼Œçˆ¶æ¯å¹´é¾„å¤§äº†ï¼Œä»–æƒ³å›è€å®¶è¿‘ä¸€äº›ï¼Œæ—©ç‚¹è§åˆ°é˜³å…‰è€Œä¸æ˜¯æ·±å¤œçš„åŠå…¬å®¤ã€‚é‚£ä¸€åˆ»æˆ‘æ„è¯†åˆ°ï¼Œé—®é¢˜å¹¶ä¸åªæ˜¯è–ªæ°´ï¼Œä¹Ÿä¸æ˜¯å•çº¯çš„èŒä¸šå‘å±•ï¼Œè€Œæ˜¯è¢«å·¥ä½œåæ²¡åï¼Œç”Ÿæ´»çš„ç©ºç™½åœ¨ä»–å¿ƒé‡Œè¢«æ”¾å¤§äº†ã€‚</p>
<p>æˆ‘ç»™ä»–æäº†ä¸‰æ¡å¯è¡Œçš„è·¯ã€‚ç¬¬ä¸€ï¼Œå…¬å¸å¯ä»¥è¯•è¡Œä¸‰ä¸ªæœˆçš„å²—ä½è°ƒæ•´ï¼ŒæŠŠä»–ä»æ‰§è¡Œå²—è½¬åˆ°äº§å“ä¾§ï¼Œå‡å°‘é‡å¤åŠ ç­çš„ä»»åŠ¡ï¼›ç¬¬äºŒï¼Œå¦‚æœä»–éœ€è¦æ—¶é—´å¤„ç†å®¶åº­äº‹åŠ¡ï¼Œå¯ä»¥ç”³è¯·è¿œç¨‹å·¥ä½œå’Œå¼¹æ€§å·¥æ—¶ï¼Œä¿ç•™ç¤¾ä¿ä¸ç»©æ•ˆè€ƒæ ¸çš„è¿ç»­æ€§ï¼›ç¬¬ä¸‰ï¼Œå¦‚æœä»–çœŸçš„å†³å®šè¦èµ°ï¼Œæˆ‘ä¼šç»™ä»–å†™æ¨èä¿¡ï¼Œå¸®ä»–æŠŠæ‰‹ä¸Šçš„å·¥ä½œåŒ…å¹²å‡€äº¤æ¥ï¼Œè‡³å°‘åˆ«ç•™ä¸‹ç³Ÿç³•çš„èƒŒä¹¦ã€‚è¯´è¿™äº›æ—¶æˆ‘å›æƒ³èµ·å»å¹´æˆ‘ä»¬ç»„å› ä¸ºå¿½è§†äººæƒ…å¯¼è‡´çš„ç¦»èŒæ½®ï¼ŒçŸ¥é“æ¡æ¬¾ä¹‹å¤–ï¼Œæ›´é‡è¦çš„æ˜¯åŠæ—¶æŠŠèƒ½è®©äººå–˜å£æ°”çš„é€‰æ‹©æ‘†å‡ºæ¥ã€‚</p>
<p>ä»–æ²‰é»˜äº†å¾ˆä¹…ï¼Œçœ¼é‡Œçªç„¶æœ‰äº†å…‰ï¼Œè¯´è¯ä¹Ÿæ…¢äº†ä¸€äº›ï¼šå¬ä½ è¿™ä¹ˆä¸€è¯´ï¼Œæ„Ÿè§‰æœ‰äººæŠŠæˆ‘å½“æˆäº†å¯æ›¿æ¢çš„é›¶ä»¶ï¼Œä½†ä½ è¯´çš„é‚£å‡ æ¡ï¼Œæˆ–è®¸èƒ½è®©æˆ‘æŠŠäº‹æƒ…å…ˆæ”¾ä¸€æ”¾ï¼Œå†åšå†³å®šã€‚æˆ‘ä»¬çº¦å®šé©¬ä¸ŠæŠŠè°ƒæ•´æ–¹æ¡ˆå†™æˆé‚®ä»¶å‘ç»™HRå’Œä»–å½“å‰çš„ä¸»ç®¡ï¼Œä¸‰å¤©å†…æœ‰ç»“æœã€‚ä»–æŠŠæ‰‹æœºåˆå¡å›å£è¢‹ï¼Œç¦»èŒä¿¡æŠ˜äº†å èµ·æ¥ï¼Œæ”¾è¿›æŠ½å±‰ï¼Œæœ€åä¸€å¥å¾ˆè½»ï¼šæˆ‘å›å»æŠŠé‚£ä»½ä¿¡æ”¶èµ·æ¥ï¼Œå…ˆæŒ‰ä½ è¯´çš„è¯•è¯•ã€‚ç¦»èŒä¿¡ä»æ¥æ²¡é€è¾¾ã€‚</p>
<p>åæ¥ä¸‰ä¸ªæœˆä»–çœŸçš„æ¢åˆ°äº†äº§å“å²—ï¼Œå¼¹æ€§ä¸Šç­è®©ä»–å¯ä»¥æ¯å‘¨æŠ½å‡ºä¸€å¤©å›è€å®¶å¤„ç†çˆ¶æ¯çš„äº‹ã€‚é¡¹ç›®ä¹Ÿå› ä¸ºè°ƒæ•´å‡ºäº†ä¸€æ¡å¯æŒç»­çš„æµç¨‹ï¼Œå›¢é˜Ÿæ°›å›´æ…¢æ…¢å˜å¥½äº†ã€‚äº‹æƒ…çš„ç»“æœä¸æ˜¯æˆå‰§æ€§çš„æŒ½å›ï¼Œä¹Ÿæ²¡æœ‰æ‰€è°“çš„è‹±é›„å¼ç•™äººï¼Œæ›´å¤šåƒä¸€æ¬¡åŠæ—¶çš„å¯¹è¯ï¼ŒæŠŠé—®é¢˜ä»åˆ¶åº¦çš„æ­»è§’é‡Œæ‹‰å‡ºæ¥ã€‚é‚£å¤©çš„è°ˆè¯æé†’æˆ‘ï¼Œç®¡ç†ä¸æ˜¯ç”¨è¡¨æ ¼å’ŒæŒ‡æ ‡æŠŠäººåœˆä½ï¼Œè€Œæ˜¯åœ¨æœ‰äººå‡†å¤‡ç¦»å¼€å‰ï¼Œå»å¬å¬ä»–ä»¬ä¸ºä»€ä¹ˆè¦ç¦»å¼€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æœ‰èµä¸€é¢ï¼šRedis Pipeline å’Œ MGETæœ‰å•¥åŒºåˆ«ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7596670644286881792</link>    <guid>https://juejin.cn/post/7596670644286881792</guid>    <pubDate>2026-01-19T10:27:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596670644286881792" data-draft-id="7560656527474262026" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æœ‰èµä¸€é¢ï¼šRedis Pipeline å’Œ MGETæœ‰å•¥åŒºåˆ«ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,Java"/> <meta itemprop="datePublished" content="2026-01-19T10:27:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜é£é±¼"/> <meta itemprop="url" content="https://juejin.cn/user/1665088861772688"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æœ‰èµä¸€é¢ï¼šRedis Pipeline å’Œ MGETæœ‰å•¥åŒºåˆ«ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1665088861772688/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜é£é±¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T10:27:35.000Z" title="Mon Jan 19 2026 10:27:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"ã€Œ"}.markdown-body b:after,.markdown-body strong:after{content:"ã€"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="github-gist">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#333}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#d73a49}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-symbol{color:#0086b3}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#6f42c1}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.hljs-number{color:#005cc5}.hljs-string{color:#032f62}</style><p><strong>æ–‡ç« å†…å®¹æ”¶å½•åˆ°ä¸ªäººç½‘ç«™ï¼Œæ–¹ä¾¿é˜…è¯»</strong>ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2Fhardyfish.top%2F" target="_blank" title="http://hardyfish.top/" ref="nofollow noopener noreferrer">hardyfish.top/</a></p>
<blockquote>
<p>ä¸¤è€…éƒ½æ˜¯ Redis æ‰¹é‡æ“ä½œçš„æ–¹å¼ï¼Œä½†åœ¨ <strong>å®ç°åŸç†</strong> å’Œ <strong>é€‚ç”¨åœºæ™¯</strong> ä¸Šæœ‰å¾ˆå¤§ä¸åŒã€‚</p>
</blockquote>
<p><strong><code>pipeline</code>ï¼ˆæµæ°´çº¿ï¼‰</strong></p>
<blockquote>
<p>Redis <strong>Pipeline</strong> å…è®¸åœ¨ <strong>å•ä¸ªè¯·æ±‚ä¸­å‘é€å¤šä¸ªå‘½ä»¤</strong>ï¼Œ<strong>å‡å°‘ç½‘ç»œ I/O å¼€é”€</strong>ï¼Œæé«˜æ€§èƒ½ã€‚</p>
<p>å®ƒé€‚ç”¨äº<strong>æ‰¹é‡å†™å…¥æˆ–è¯»å–</strong>åœºæ™¯ã€‚</p>
</blockquote>
<p><strong>ç‰¹ç‚¹</strong></p>
<ul>
<li><strong>å¤šä¸ªå‘½ä»¤ä¸€èµ·å‘é€</strong>ï¼Œä½†<strong>æ‰§è¡Œé¡ºåºä¸å˜</strong>ã€‚</li>
<li><strong>å‡å°‘ TCP å¾€è¿”æ¬¡æ•°</strong>ï¼ˆN ä¸ªè¯·æ±‚å˜æˆ 1 æ¬¡ï¼‰ã€‚</li>
<li><strong>é€‚ç”¨äºæ‰¹é‡å†™å…¥ã€æ‰¹é‡è¯»å–ã€äº‹åŠ¡æäº¤</strong>ã€‚</li>
</ul>
<p><strong>ç¤ºä¾‹</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> redis

r = redis.StrictRedis(host=<span class="hljs-string">'localhost'</span>, port=<span class="hljs-number">6379</span>, decode_responses=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># å¼€å¯ pipeline</span>
pipe = r.pipeline()

<span class="hljs-comment"># æ·»åŠ å¤šä¸ªå‘½ä»¤</span>
pipe.<span class="hljs-built_in">set</span>(<span class="hljs-string">"key1"</span>, <span class="hljs-string">"value1"</span>)
pipe.<span class="hljs-built_in">set</span>(<span class="hljs-string">"key2"</span>, <span class="hljs-string">"value2"</span>)
pipe.get(<span class="hljs-string">"key1"</span>)
pipe.get(<span class="hljs-string">"key2"</span>)

<span class="hljs-comment"># ä¸€æ¬¡æ€§æ‰§è¡Œæ‰€æœ‰å‘½ä»¤</span>
results = pipe.execute()
<span class="hljs-built_in">print</span>(results)  <span class="hljs-comment"># [True, True, 'value1', 'value2']</span>
</code></pre>
<p><strong>æ‰§è¡Œæµç¨‹</strong></p>
<ol>
<li><code>set key1 value1</code></li>
<li><code>set key2 value2</code></li>
<li><code>get key1</code></li>
<li><code>get key2</code></li>
<li><strong>ä¸€æ¬¡æ€§å‘é€åˆ° Redis æœåŠ¡å™¨</strong></li>
<li><strong>Redis ä¾æ¬¡æ‰§è¡Œ</strong></li>
<li><strong>è¿”å›æ‰€æœ‰ç»“æœ</strong></li>
</ol>
<p><strong><code>MGET</code>ï¼ˆæ‰¹é‡è·å–ï¼‰</strong></p>
<blockquote>
<p><code>MGET</code> æ˜¯ Redis æä¾›çš„ <strong>åŸç”Ÿæ‰¹é‡æŸ¥è¯¢</strong> å‘½ä»¤ï¼Œå¯ä»¥ä¸€æ¬¡æ€§è·å–å¤šä¸ª Key çš„å€¼ã€‚</p>
</blockquote>
<p><strong>ç‰¹ç‚¹</strong></p>
<ul>
<li><strong>åªèƒ½ç”¨äº <code>GET</code> æ“ä½œ</strong>ï¼ˆæ‰¹é‡è¯»å–ï¼‰ã€‚</li>
<li><strong>åº•å±‚æ‰§è¡Œæ˜¯ä¸€ä¸ª Redis å‘½ä»¤</strong>ï¼Œå› æ­¤æ¯” <code>pipeline</code> æ›´é«˜æ•ˆã€‚</li>
<li><strong>Redis æœåŠ¡å™¨ç«¯ä¸€æ¬¡æ€§æ‰§è¡Œ <code>MGET</code> å¹¶è¿”å›ç»“æœ</strong>ï¼Œå‡å°‘ CPU å¼€é”€ã€‚</li>
</ul>
<p><strong>ç¤ºä¾‹</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> redis

r = redis.StrictRedis(host=<span class="hljs-string">'localhost'</span>, port=<span class="hljs-number">6379</span>, decode_responses=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># æ‰¹é‡è·å–å¤šä¸ª key</span>
results = r.mget([<span class="hljs-string">"key1"</span>, <span class="hljs-string">"key2"</span>])
<span class="hljs-built_in">print</span>(results)  <span class="hljs-comment"># ['value1', 'value2']</span>
</code></pre>
<p><strong>æ‰§è¡Œæµç¨‹</strong></p>
<ol>
<li><code>MGET key1 key2</code></li>
<li>Redis <strong>ä¸€æ¬¡æ€§æŸ¥è¯¢å¤šä¸ª key</strong></li>
<li><strong>ä¸€æ¬¡æ€§è¿”å›æ‰€æœ‰ç»“æœ</strong></li>
</ol>
<p><strong><code>pipeline</code> vs <code>MGET</code> å¯¹æ¯”</strong></p>








































<table><thead><tr><th align="left"><strong>å¯¹æ¯”é¡¹</strong></th><th align="left"><strong>pipeline</strong></th><th align="left"><strong>MGET</strong></th></tr></thead><tbody><tr><td align="left"><strong>ç½‘ç»œè¯·æ±‚æ–¹å¼</strong></td><td align="left">å‘é€å¤šä¸ªå‘½ä»¤ï¼Œå‡å°‘ TCP äº¤äº’</td><td align="left">ä»…éœ€ <strong>1 æ¬¡å‘½ä»¤</strong></td></tr><tr><td align="left"><strong>æ‰§è¡Œæ–¹å¼</strong></td><td align="left">é€æ¡æ‰§è¡Œï¼Œç»“æœé¡ºåºå›ºå®š</td><td align="left"><strong>æ‰¹é‡æŸ¥è¯¢</strong>ï¼Œä¸€æ¬¡è¿”å›</td></tr><tr><td align="left"><strong>é€‚ç”¨èŒƒå›´</strong></td><td align="left"><strong>è¯»å†™çš†å¯</strong>ï¼ˆSET, GET, INCR, EXPIRE ç­‰ï¼‰</td><td align="left"><strong>ä»…é€‚ç”¨äº GET æ“ä½œ</strong></td></tr><tr><td align="left"><strong>æ€§èƒ½</strong></td><td align="left"><strong>ç¨ä½</strong>ï¼ˆå¤šä¸ªå‘½ä»¤ï¼‰</td><td align="left"><strong>æ›´é«˜æ•ˆ</strong>ï¼ˆå•æ¡å‘½ä»¤ï¼‰</td></tr><tr><td align="left"><strong>Redis æœåŠ¡å™¨ç«¯å¤„ç†</strong></td><td align="left">é€æ¡æ‰§è¡Œ</td><td align="left">ä¸€æ¬¡æ€§æ‰§è¡Œ</td></tr><tr><td align="left"><strong>æ˜¯å¦é€‚åˆäº‹åŠ¡</strong></td><td align="left">é€‚åˆ</td><td align="left">ä¸é€‚åˆ</td></tr></tbody></table>
<p><strong>é€‚ç”¨åœºæ™¯</strong></p>
<p><strong>é€‚åˆ <code>pipeline</code></strong></p>
<ul>
<li><strong>æ‰¹é‡å†™å…¥</strong>ï¼ˆå¦‚ <code>SET key1 value1</code>ã€<code>SET key2 value2</code>ï¼‰ã€‚</li>
<li><strong>ç»„åˆæ“ä½œ</strong>ï¼ˆå¦‚ <code>SET + GET</code> æˆ– <code>INCR + EXPIRE</code>ï¼‰ã€‚</li>
<li><strong>äº‹åŠ¡æ“ä½œ</strong>ï¼ˆå¦‚ <code>MULTI/EXEC</code>ï¼‰ã€‚</li>
<li><strong>æ‰¹é‡åˆ é™¤ã€è¿‡æœŸå¤„ç†</strong>ã€‚</li>
</ul>
<p><strong>é€‚åˆ <code>MGET</code></strong></p>
<ul>
<li>ä»…æ‰¹é‡æŸ¥è¯¢ keyï¼Œå¦‚ï¼š
<ul>
<li><strong>è·å–å¤šä¸ªç”¨æˆ·ä¿¡æ¯</strong>ï¼š<code>MGET user:1 user:2 user:3</code></li>
<li><strong>è¯»å–ç¼“å­˜æ•°æ®</strong>ï¼ˆå¦‚ Redis ä½œä¸ºç¼“å­˜å±‚ï¼‰</li>
</ul>
</li>
</ul>
<p><strong>ç»“è®º</strong></p>
<ul>
<li><strong>å¦‚æœåªæ˜¯æ‰¹é‡è¯»å–</strong>ï¼Œç”¨ <code>MGET</code> <strong>æ›´å¿«</strong>ã€‚</li>
<li><strong>å¦‚æœéœ€è¦æ‰¹é‡æ‰§è¡Œå¤šä¸ªä¸åŒå‘½ä»¤ï¼ˆè¯»å†™æ··åˆï¼‰</strong>ï¼Œç”¨ <code>pipeline</code> <strong>æ›´çµæ´»</strong>ã€‚</li>
</ul>
<p><strong>ç®€å•è®°å¿†</strong></p>
<ul>
<li><code>MGET</code> æ›´é«˜æ•ˆï¼Œä½†åªèƒ½ <code>GET</code>ã€‚</li>
<li><strong><code>pipeline</code> é€‚ç”¨äºè¯»å†™æ··åˆï¼Œå‡å°‘ç½‘ç»œå¼€é”€</strong>ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€é”®æ”¶è—ï¼ä¸­é€‰å…­å¤§é¡¶ä¼š äº¬ä¸œé›¶å”®å¹´åº¦ AI è®ºæ–‡ç²¾é€‰åˆé›†ï¼ˆå†…å«ç¦åˆ©ï¼‰]]></title>    <link>https://juejin.cn/post/7596896373053341759</link>    <guid>https://juejin.cn/post/7596896373053341759</guid>    <pubDate>2026-01-19T10:34:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596896373053341759" data-draft-id="7596905751110156351" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€é”®æ”¶è—ï¼ä¸­é€‰å…­å¤§é¡¶ä¼š äº¬ä¸œé›¶å”®å¹´åº¦ AI è®ºæ–‡ç²¾é€‰åˆé›†ï¼ˆå†…å«ç¦åˆ©ï¼‰"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-19T10:34:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº¬ä¸œé›¶å”®æŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/4233576972293643"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€é”®æ”¶è—ï¼ä¸­é€‰å…­å¤§é¡¶ä¼š äº¬ä¸œé›¶å”®å¹´åº¦ AI è®ºæ–‡ç²¾é€‰åˆé›†ï¼ˆå†…å«ç¦åˆ©ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4233576972293643/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº¬ä¸œé›¶å”®æŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T10:34:00.000Z" title="Mon Jan 19 2026 10:34:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»21åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>AIåœˆçš„å‰æ²¿å‰§é€ï¼Œç§‘æŠ€å¹²è´§çš„é¦–å‘é˜µåœ°ï¼Œå…¶å®éƒ½è—åœ¨é¡¶ä¼šè®ºæ–‡é‡Œã€‚ ä»Šå¹´ï¼Œäº¬ä¸œé›¶å”®æŠ€æœ¯æœ‰è¿‘50ç¯‡è®ºæ–‡ï¼Œè¢«NeurIPSã€ACLã€SIGIRç­‰å›½é™…é¡¶çº§å­¦æœ¯ä¼šè®®æ”¶å½•ã€‚æˆ‘ä»¬ä»ä¸­ç²¾é€‰äº†15ç¯‡å…·æœ‰ä»£è¡¨æ€§çš„è®ºæ–‡ï¼Œè¦†ç›–å¤§å‹è¯­è¨€æ¨¡å‹è®­ç»ƒä¼˜åŒ–ã€å¤šæ¨¡æ€å†…å®¹ç”Ÿæˆä¸ä¼˜åŒ–ã€å› æœæ¨æ–­ä¸ç‚¹å‡»ç‡é¢„ä¼°ã€ä¿¡æ¯æ£€ç´¢æ–°èŒƒå¼ä»¥åŠæ¨¡å‹é«˜æ•ˆé€‚é…ç­‰å¤šä¸ªå…³é”®æ–¹å‘ç ”ç©¶ï¼Œåˆ¶ä½œæˆè¿™ä»½åˆé›†ï¼Œå’Œä½ ä¸€èµ·å…³æ³¨å‰æ²¿æŠ€æœ¯è¶‹åŠ¿ã€å…±åŒæ¢ç´¢åº”ç”¨è½åœ°çš„æ›´å¤šå¯èƒ½ã€‚æ¬¢è¿åˆ†äº«ç»™ä½ èº«è¾¹çš„æœ‹å‹ä»¬ã€‚</p>
<h2 data-id="heading-0">01ã€TANDEMï¼šåŸºäºå­ªç”Ÿç½‘ç»œçš„åŒå±‚æ•°æ®æ··åˆä¼˜åŒ–</h2>
<p>è®ºæ–‡ç±»å‹ï¼šNeurIPS 2025</p>
<p>è®ºæ–‡ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fopenreview.net%2Fpdf%3Fid%3DszBFUtBzWP" target="_blank" title="https://openreview.net/pdf?id=szBFUtBzWP" ref="nofollow noopener noreferrer">openreview.net/pdf?id=szBFâ€¦</a></p>
<p>ä¸€å¥è¯ä»‹ç»ï¼šä¸€ç§é€‚ç”¨äº LLM è®­ç»ƒçš„å¤šåŠŸèƒ½æ•°æ®æ··åˆæ¯”ä¾‹ä¼˜åŒ–æ¡†æ¶ï¼Œå…¼å…·ç†è®ºå’Œå®è·µä¼˜åŠ¿ã€‚</p>
<p>è®ºæ–‡ç®€ä»‹ï¼šå¤§å‹è¯­è¨€æ¨¡å‹çš„èƒ½åŠ›å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºå„ä¸ªé¢†åŸŸçš„è®­ç»ƒæ•°æ®ã€‚ä¼˜åŒ–ç‰¹å®šé¢†åŸŸæ•°æ®çš„æ··åˆæ¯”ä¾‹å¯ä»¥å»ºæ¨¡ä¸ºåŒå±‚ä¼˜åŒ–é—®é¢˜ã€‚æœ¬æ–‡å°†è¯¥åŒå±‚ä¼˜åŒ–é—®é¢˜ç®€åŒ–ä¸ºå•å±‚æƒ©ç½šå½¢å¼ï¼Œå¹¶ä½¿ç”¨ä¸€ç»„å­ªç”Ÿæ¨¡å‹è¿›è¡Œæ±‚è§£ï¼šä¸€ä¸ªä½¿ç”¨åŸå§‹æ•°æ®è®­ç»ƒçš„ä»£ç†æ¨¡å‹å’Œä¸€ä¸ªä½¿ç”¨é¢å¤–æ•°æ®è®­ç»ƒçš„åŠ¨æ€æ›´æ–°çš„å‚è€ƒæ¨¡å‹ã€‚æœ¬æ–‡æå‡ºçš„æ–¹æ³•ï¼ŒåŸºäºå­ªç”Ÿæ¨¡å‹çš„åŒå±‚æ•°æ®æ··åˆæ¯”ä¾‹ä¼˜åŒ– (TANDEM)ï¼Œé€šè¿‡å­ªç”Ÿæ¨¡å‹çš„å·®å¼‚æ¥è¡¡é‡æ•°æ®æœ‰æ•ˆæ€§ï¼šèƒ½ä»é¢å¤–æ•°æ®ä¸­è·ç›Šæ›´å¤šçš„é¢†åŸŸå…¶æƒé‡åº”è¯¥è¢«ä¸Šè°ƒã€‚ä¸å…ˆå‰çš„æ–¹æ³•ç›¸æ¯”ï¼ŒTANDEM æä¾›äº†ç†è®ºä¿è¯å’Œæ›´å¹¿æ³›çš„é€‚ç”¨æ€§ã€‚æ­¤å¤–ï¼Œæœ¬æ–‡çš„åŒå±‚è§†è§’ä¸ºæ¨¡å‹è®­ç»ƒæ•°æ®é…æ¯”è°ƒæ•´æä¾›äº†æ–°çš„åœºæ™¯ï¼Œå¦‚æ•°æ®å—é™åœºæ™¯å’Œç›‘ç£å¾®è°ƒã€‚åœ¨è¿™äº›åœºæ™¯ä¸­ï¼Œä¼˜åŒ–æ•°æ®æ··åˆæ¯”å¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½ã€‚å¤§é‡å®éªŒéªŒè¯äº† TANDEM åœ¨æ‰€æœ‰åœºæ™¯ä¸‹çš„æœ‰æ•ˆæ€§ã€‚</p>
<h2 data-id="heading-1">02ã€LoRAçš„å¹…å€¼ç†è®ºä¸åˆå§‹åŒ–ç­–ç•¥æ”¹è¿›</h2>
<p>è®ºæ–‡ç±»å‹ï¼šNeurIPS 2025</p>
<p>è®ºæ–‡ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fopenreview.net%2Fpdf%3Fid%3Ds4LnWgjacg" target="_blank" title="https://openreview.net/pdf?id=s4LnWgjacg" ref="nofollow noopener noreferrer">openreview.net/pdf?id=s4Lnâ€¦</a></p>
<p>ä¸€å¥è¯ä»‹ç»ï¼šæœ¬æ–‡æ­ç¤ºäº†LoRAè°ƒå‚çš„ç¬¬ä¸€æ€§åŸç†â€œå¹…å€¼åŸåˆ™â€ï¼Œæå‡ºäº†ä¸€ç§ç®€æ´é«˜æ•ˆçš„åˆå§‹åŒ–æ–¹æ¡ˆ LoRAMï¼Œå®ç°äº†æ›´å¥½çš„æ”¶æ•›æ•ˆæœã€‚</p>
<p>è®ºæ–‡ç®€ä»‹ï¼šä½ç§©é€‚åº” (LoRA) ä¸ºå¤§å‹æ¨¡å‹çš„å¾®è°ƒæä¾›äº†ä¸€ç§å‚æ•°é«˜æ•ˆçš„èŒƒå¼ã€‚å°½ç®¡æœ€è¿‘çš„è°±åˆå§‹åŒ–æ–¹æ³•ï¼ˆå¦‚PiSSAï¼‰ç›¸è¾ƒäºæ ‡å‡†çš„é›¶ç§¯åˆå§‹åŒ–åœ¨æ”¶æ•›æ€§å’Œæ€§èƒ½ä¸Šæœ‰æ‰€æå‡ï¼Œä½†å…¶é¢å¤–çš„è®¡ç®—å’Œå­˜å‚¨å¼€é”€å´é™ä½äº†æ•ˆç‡ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ›´æ–°å¹…åº¦ï¼ˆupdate magnitudeï¼‰ç¡®ç«‹ä¸º LoRA æ”¹è¿›çš„æ ¹æœ¬é©±åŠ¨åŠ›ï¼Œå¹¶æå‡ºäº† LoRAMâ€”â€”ä¸€ç§ä»¥å¹…åº¦ä¸ºé©±åŠ¨çš„åˆå§‹åŒ–æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆåœ¨é¿å…ä¸Šè¿°ä½æ•ˆé—®é¢˜çš„åŒæ—¶è¾¾åˆ°äº†ä¸è°±æ–¹æ³•ç›¸å½“çš„æ•ˆæœã€‚æˆ‘ä»¬çš„ä¸»è¦è´¡çŒ®åŒ…æ‹¬ä¸‰ç‚¹ï¼š (i) æƒé‡æ›´æ–°çš„å¹…åº¦å†³å®šäº†æ”¶æ•›æ€§ã€‚æˆ‘ä»¬è¯æ˜ä½ç§©ç»“æ„æœ¬è´¨ä¸Šé™åˆ¶äº†æ›´æ–°å¹…åº¦ï¼Œä»è€Œå°†å­¦ä¹ ç‡ã€ç¼©æ”¾å› å­åŠåˆå§‹åŒ–çš„è¶…å‚æ•°è°ƒæ•´ç»Ÿä¸€ä¸ºä¼˜åŒ–å¹…åº¦è°ƒèŠ‚çš„æœºåˆ¶ã€‚ (ii) è°±åˆå§‹åŒ–çš„æˆåŠŸå¾—ç›Šäºå¹…åº¦æ”¾å¤§ã€‚æˆ‘ä»¬æ­ç¤ºäº†è°±åˆ†é‡çš„â€œçŸ¥è¯†é©±åŠ¨â€ä¼˜åŠ¿ï¼Œå®é™…ä¸Šä¸»è¦æºäºæƒé‡æ›´æ–°å¹…åº¦çš„æå‡ã€‚ (iii) ä¸€ç§æ–°é¢–ä¸”ç´§å‡‘çš„åˆå§‹åŒ–ç­–ç•¥ LoRAMï¼Œå®ƒåˆ©ç”¨é¢„è®­ç»ƒæƒé‡çš„å¹…åº¦æ¥ç¼©æ”¾ç¡®å®šæ€§æ­£äº¤åŸºï¼Œä»è€Œæ¨¡æ‹Ÿè°±å¢ç›Šã€‚å¤§é‡å®éªŒè¡¨æ˜ï¼ŒLoRAM æ˜¯ä¸€ä¸ªå¼ºæœ‰åŠ›çš„åŸºçº¿æ–¹æ³•ï¼Œåœ¨ä¿ç•™ LoRA å…¨éƒ¨æ•ˆç‡çš„åŒæ—¶ï¼Œåœ¨å„é¡¹åŸºå‡†æµ‹è¯•ä¸­å‡èƒ½åŒ¹æ•Œæˆ–è¶…è¶Šè°±åˆå§‹åŒ–æ–¹æ³•ã€‚</p>
<h2 data-id="heading-2">03ã€äº¬ä¸œé›¶å”®å¹¿å‘Šåˆ›æ„ï¼šç»Ÿä¸€çš„å¸ƒå±€ç”Ÿæˆå’Œè¯„ä¼°æ¨¡å‹</h2>
<p>è®ºæ–‡ç±»å‹ï¼šACM Multimedia 2025</p>
<p>è®ºæ–‡ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2508.02374" target="_blank" title="https://arxiv.org/pdf/2508.02374" ref="nofollow noopener noreferrer">arxiv.org/pdf/2508.02â€¦</a></p>
<p>ä¸€å¥è¯ä»‹ç»ï¼šé€šè¿‡ç»Ÿä¸€ç”Ÿæˆå™¨ã€ç±»äººå¸ƒå±€è¯„ä¼°å™¨ä¸åŠ¨æ€è¾¹è·å¯¹é½æœºåˆ¶çš„ååŒï¼Œå®ç°äº†å¤šä»»åŠ¡å¸ƒå±€ç”Ÿæˆã€ç²¾å‡†äººç±»æ„ŸçŸ¥è¯„ä¼°åŠç”Ÿæˆ - è¯„ä¼°é—­ç¯ä¼˜åŒ–ã€‚</p>
<p>è®ºæ–‡ç®€ä»‹ï¼šå¸ƒå±€ç”Ÿæˆåœ¨ç”µå•†å›¾ç‰‡çš„è®¾è®¡ä¸­èµ·åˆ°è‡³å…³é‡è¦çš„ä½œç”¨ã€‚å½“å‰çš„å¸ƒå±€ç”Ÿæˆæ–¹æ³•åœ¨èƒ½åŠ›ä¸Šå…·æœ‰ä»»åŠ¡ç‰¹å®šæ€§ï¼Œå¹¶ä¸”è¯„ä¼°æ ‡å‡†ä¸äººç±»æ„ŸçŸ¥ä¸ä¸€è‡´ï¼Œå¯¼è‡´å…¶åº”ç”¨èŒƒå›´æœ‰é™ä¸”è¯„ä¼°æ•ˆæœä¸ä½³ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼ŒUni-Layoutå®ç°äº†ç»Ÿä¸€ç”Ÿæˆã€æ¨¡æ‹Ÿäººç±»çš„è¯„ä¼°ä»¥åŠäºŒè€…ä¹‹é—´çš„å¯¹é½ã€‚é’ˆå¯¹é€šç”¨ç”Ÿæˆï¼Œè¯¥æ¡†æ¶å°†å„ç§å¸ƒå±€ä»»åŠ¡æ•´åˆåˆ°ä¸€ä¸ªç»Ÿä¸€çš„åˆ†ç±»ç³»ç»Ÿä¸­ï¼Œå¹¶å¼€å‘äº†ä¸€ä¸ªç»Ÿä¸€çš„ç”Ÿæˆå™¨ï¼Œé€šè¿‡è‡ªç„¶è¯­è¨€æç¤ºå¤„ç†èƒŒæ™¯æˆ–å…ƒç´ å†…å®¹å—é™çš„ä»»åŠ¡ã€‚ä¸ºäº†å¼•å…¥äººç±»åé¦ˆä»¥æœ‰æ•ˆè¯„ä¼°å¸ƒå±€ï¼Œæˆ‘ä»¬æ„å»ºäº†Layout-HF100kï¼Œè¿™æ˜¯é¦–ä¸ªåŒ…å«10ä¸‡ä¸ªäººå·¥æ ‡æ³¨å¸ƒå±€çš„å¤§è§„æ¨¡äººç±»åé¦ˆæ•°æ®é›†ã€‚åŸºäºLayout-HF100kï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ç§æ¨¡æ‹Ÿäººç±»çš„è¯„ä¼°å™¨ï¼Œè¯¥è¯„ä¼°å™¨ç»“åˆè§†è§‰å’Œå‡ ä½•ä¿¡æ¯ï¼Œé‡‡ç”¨æ€ç»´é“¾æœºåˆ¶è¿›è¡Œå®šæ€§è¯„ä¼°ï¼Œå¹¶é€šè¿‡ä¿¡å¿ƒä¼°è®¡æ¨¡å—æä¾›å®šé‡æµ‹é‡ã€‚ä¸ºäº†æ›´å¥½åœ°å¯¹é½ç”Ÿæˆå™¨å’Œè¯„ä¼°å™¨ï¼Œæˆ‘ä»¬é‡‡ç”¨åŠ¨æ€è¾¹è·åå¥½ä¼˜åŒ–ï¼ˆDMPOï¼‰æŠ€æœ¯ï¼Œå°†äºŒè€…æ•´åˆä¸ºä¸€ä¸ªåè°ƒç³»ç»Ÿï¼Œä»¥æ›´å¥½åœ°ç¬¦åˆäººç±»åˆ¤æ–­ã€‚</p>
<h2 data-id="heading-3">04ã€ä¸€ç§ç”¨äºç”µå­å•†åŠ¡æŸ¥è¯¢åˆ†ç±»çš„åŠç›‘ç£å¯æ‰©å±•ç»Ÿä¸€æ¡†æ¶</h2>
<p>è®ºæ–‡ç±»å‹ï¼šACL 2025</p>
<p>è®ºæ–‡ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Faclanthology.org%2F2025.acl-industry.88.pdf" target="_blank" title="https://aclanthology.org/2025.acl-industry.88.pdf" ref="nofollow noopener noreferrer">aclanthology.org/2025.acl-inâ€¦</a></p>
<p>ä¸€å¥è¯ä»‹ç»ï¼šè®ºæ–‡æå‡ºäº†ä¸€ç§åŠç›‘ç£å¯æ‰©å±•ç»Ÿä¸€æ¡†æ¶ï¼Œé€šè¿‡æ•´åˆçŸ¥è¯†ã€æ ‡ç­¾å’Œç»“æ„ä¸‰ä¸ªå¯æ’æ‹”çš„å¢å¼ºæ¨¡å—ï¼Œå¼¥è¡¥å…ˆéªŒä¿¡æ¯ä¸è¶³å¹¶ç»Ÿä¸€äº†QPå„ç±»å­ä»»åŠ¡ã€‚</p>
<p>è®ºæ–‡ç®€ä»‹ï¼šqueryæ„å›¾é¢„æµ‹åŒ…å«ç±»ç›®ã€å“ç‰Œç­‰åˆ†ç±»ä»»åŠ¡ï¼Œå¯¹ç”µå­å•†åŠ¡åº”ç”¨è‡³å…³é‡è¦ã€‚ç”µå•†queryé€šå¸¸ç®€çŸ­ä¸”ç¼ºä¹ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæ ‡ç­¾é—´çš„ä¿¡æ¯æ— æ³•åˆ©ç”¨ï¼Œå¯¼è‡´å»ºæ¨¡æ‰€éœ€çš„å…ˆéªŒä¿¡æ¯ä¸è¶³ã€‚å¤§å¤šæ•°ç°æœ‰çš„å·¥ä¸šçº§æŸ¥è¯¢åˆ†ç±»æ–¹æ³•ä¾èµ–äºç”¨æˆ·åç»­çš„ç‚¹å‡»è¡Œä¸ºæ¥æ„å»ºè®­ç»ƒæ ·æœ¬ï¼Œä»è€Œé™·å…¥äº†é©¬å¤ªæ•ˆåº”çš„æ¶æ€§å¾ªç¯ã€‚æ­¤å¤–ï¼ŒæŸ¥è¯¢åˆ†ç±»çš„å„ä¸ªå­ä»»åŠ¡ç¼ºä¹ç»Ÿä¸€çš„æ¡†æ¶ï¼Œå¯¼è‡´ç®—æ³•ä¼˜åŒ–æ•ˆç‡ä½ä¸‹ã€‚ æˆ‘ä»¬æå‡ºäº†ä¸€ç§åŠç›‘ç£å¯æ‰©å±•ç»Ÿä¸€æ¡†æ¶ï¼ˆSSUFï¼‰ï¼Œè¯¥æ¡†æ¶åŒ…å«å¤šä¸ªå¢å¼ºæ¨¡å—ï¼Œç”¨äºç»Ÿä¸€æŸ¥è¯¢åˆ†ç±»ä»»åŠ¡ã€‚çŸ¥è¯†å¢å¼ºæ¨¡å—åˆ©ç”¨ä¸–ç•ŒçŸ¥è¯†æ¥å¢å¼ºæŸ¥è¯¢è¡¨ç¤ºï¼Œè§£å†³æŸ¥è¯¢ä¿¡æ¯ä¸è¶³çš„é—®é¢˜ã€‚æ ‡ç­¾å¢å¼ºæ¨¡å—åˆ©ç”¨æ ‡ç­¾è¯­ä¹‰å’ŒåŠç›‘ç£ä¿¡å·æ¥é™ä½å¯¹åéªŒæ ‡ç­¾çš„ä¾èµ–ã€‚ç»“æ„å¢å¼ºæ¨¡å—åŸºäºå¤æ‚çš„æ ‡ç­¾å…³ç³»æ¥å¢å¼ºæ ‡ç­¾è¡¨ç¤ºã€‚æ¯ä¸ªæ¨¡å—éƒ½å…·æœ‰é«˜åº¦å¯æ’æ‹”æ€§ï¼Œå¯ä»¥æ ¹æ®æ¯ä¸ªå­ä»»åŠ¡çš„éœ€è¦æ·»åŠ æˆ–ç§»é™¤è¾“å…¥ç‰¹å¾ã€‚ç»è¿‡å¤§é‡çš„ç¦»çº¿å’Œåœ¨çº¿ A/B å®éªŒï¼Œç»“æœè¡¨æ˜ SSUF çš„æ€§èƒ½æ˜æ˜¾ä¼˜äºä¸šç•Œæœ€å…ˆè¿›çš„æ¨¡å‹ã€‚</p>
<h2 data-id="heading-4">05ã€è¶…è¶ŠLogitsï¼šå¯¹é½ç‰¹å¾åŠ¨åŠ›å­¦çš„çŸ¥è¯†è’¸é¦</h2>
<p>è®ºæ–‡ç±»å‹ï¼šACL 2025</p>
<p>è®ºæ–‡ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Faclanthology.org%2F2025.acl-long.1125.pdf" target="_blank" title="https://aclanthology.org/2025.acl-long.1125.pdf" ref="nofollow noopener noreferrer">aclanthology.org/2025.acl-loâ€¦</a></p>
<p>ä¸€å¥è¯ä»‹ç»ï¼šä»ODEå¾®åˆ†æ–¹ç¨‹çš„è§†è§’è®¾è®¡LLMè’¸é¦æ–¹æ³•ï¼Œå®ç°å­¦ç”Ÿæ¨¡å‹å¯¹æ•™å¸ˆæ¨¡å‹ç‰¹å¾åŠ¨åŠ›å­¦çš„å…¨é¢æ¨¡ä»¿ä»¥æå‡æ¨¡å‹è’¸é¦æ•ˆæœã€‚</p>
<p>è®ºæ–‡ç®€ä»‹ï¼šçŸ¥è¯†è’¸é¦ï¼ˆKDï¼‰å°†å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼Œä¹Ÿç§°ä¸ºæ•™å¸ˆæ¨¡å‹ï¼‰å‹ç¼©æˆè½»é‡çº§ç‰ˆæœ¬ï¼Œä»è€Œå®ç°é«˜æ•ˆçš„æ¨ç†å’Œä¸‹æ¸¸åº”ç”¨ã€‚ç„¶è€Œï¼Œç°æœ‰æ–¹æ³•ä¸»è¦é€šè¿‡åŒ¹é…å­¦ç”Ÿ/æ•™å¸ˆæ¨¡å‹çš„æœ€ç»ˆè¾“å‡ºåˆ†å¸ƒæ¥å®ç°è¿™ä¸€ç›®æ ‡ã€‚åŸºäºTransformeræ¨¡å‹å¯ä»¥è¢«è§†ä¸ºåœ¨æ•´æ•°æ—¶é—´æ­¥é•¿ï¼ˆå¯¹åº”äºå±‚ç´¢å¼•ï¼‰ä¸Šç¦»æ•£åŒ–å¸¸å¾®åˆ†æ–¹ç¨‹ï¼ˆODEï¼‰çš„è§†è§’ï¼Œå…¶ä¸­ä¸­é—´ç‰¹å¾åœ¨å„å±‚ä¹‹é—´æ¼”åŒ–ï¼Œæˆ‘ä»¬è®¤ä¸ºæœ‰æ•ˆçš„çŸ¥è¯†è’¸é¦éœ€è¦åŒ¹é…æ•™å¸ˆæ¨¡å‹å’Œå­¦ç”Ÿæ¨¡å‹ä¹‹é—´çš„æ•´ä¸ªç‰¹å¾åŠ¨æ€ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºç‰¹å¾åŠ¨æ€è’¸é¦ï¼ˆFDDï¼‰ã€‚è¿™ç§åŒ¹é…æ¶‰åŠåŒ¹é…ç‰¹å¾è½¨è¿¹åŠå…¶ä¸€é˜¶å¯¼æ•°ï¼Œè€Œä¸ä»…ä»…æ˜¯æœ€ç»ˆçŠ¶æ€ã€‚æˆ‘ä»¬çš„æ–¹æ³•åœ¨åŸå§‹çŸ¥è¯†è’¸é¦ç›®æ ‡å‡½æ•°çš„åŸºç¡€ä¸Šå¢åŠ äº†ä¸¤ä¸ªæŸå¤±é¡¹ï¼šé€å±‚ç‰¹å¾çŸ¥è¯†è’¸é¦ï¼ˆåŒ¹é…ç¦»æ•£åŒ–çš„ç‰¹å¾è½¨è¿¹ï¼‰å’Œå±‚ç‰¹å¾å¢é‡çŸ¥è¯†è’¸é¦ï¼ˆåŒ¹é…ç›¸é‚»å±‚ä¹‹é—´ç‰¹å¾çš„ä¸€é˜¶å˜åŒ–ï¼‰ã€‚åœ¨å„ç§ä»»åŠ¡ä¸Šçš„å¤§é‡å®éªŒéªŒè¯äº†æ‰€æè’¸é¦æ–¹æ³•çš„æœ‰æ•ˆæ€§ã€‚</p>
<h2 data-id="heading-5">06ã€åŸºäºå›¾åŒæ„ç½‘ç»œçš„ç¾¤ä½“å»ºæ¨¡åœ¨ç‚¹å‡»ç‡é¢„æµ‹ä¸­çš„åº”ç”¨</h2>
<p>è®ºæ–‡ç±»å‹ï¼šSIGIR 2025</p>
<p>è®ºæ–‡ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdl.acm.org%2Fdoi%2Fepdf%2F10.1145%2F3726302.3731936" target="_blank" title="https://dl.acm.org/doi/epdf/10.1145/3726302.3731936" ref="nofollow noopener noreferrer">dl.acm.org/doi/epdf/10â€¦</a></p>
<p>ä¸€å¥è¯ä»‹ç»ï¼šæå‡ºåŸºäºå›¾åŒæ„ç½‘ç»œçš„ç¾¤ä½“å»ºæ¨¡æ–¹æ³•ï¼Œç²¾å‡†æ•æ‰é«˜é˜¶ç”¨æˆ·-ç‰©å“äº¤äº’ï¼Œæœ‰æ•ˆç¼“è§£å†·å¯åŠ¨é—®é¢˜å¹¶æå‡æ³›åŒ–èƒ½åŠ›ã€‚</p>
<p>è®ºæ–‡ç®€ä»‹ï¼šç‚¹å‡»ç‡é¢„ä¼°ä»»åŠ¡é€šå¸¸ä¼šé¢ä¸´å†·å¯åŠ¨é—®é¢˜ï¼Œå³æ–°ç”¨æˆ·å› å†å²è¡Œä¸ºæ•°æ®ä¸è¶³è€Œéš¾ä»¥è¿›è¡Œå‡†ç¡®é¢„æµ‹ã€‚è¿‘æœŸç ”ç©¶å°è¯•é€šè¿‡ç¼–ç å™¨-è§£ç å™¨ç½‘ç»œï¼ŒåŸºäºæ´»è·ƒç”¨æˆ·æ•°æ®ä¸ºå†·å¯åŠ¨ç”¨æˆ·ç”Ÿæˆè™šæ‹Ÿè¡Œä¸ºè¡¨å¾ã€‚ç„¶è€Œï¼Œç°æœ‰æ–¹æ³•å­˜åœ¨ä¸¤å¤§ç¼ºé™·ï¼šå¯¹æ´»è·ƒç”¨æˆ·è¡Œä¸ºçš„ç¼–ç æŠ€æœ¯è¿‡äºç®€å•åŒ–ï¼Œä¸”ç›´æ¥ä½¿ç”¨è™šæ‹Ÿè¡Œä¸ºè¡¨å¾ä¼šå¯¼è‡´ç”¨æˆ·å…´è¶£è¡¨è¾¾å—é™ã€æ¨¡å‹æ³›åŒ–èƒ½åŠ›ä¸è¶³ã€‚ä¸ºè§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºåˆ›æ–°æ€§çš„åŸºäºå›¾åŒæ„ç½‘ç»œçš„ç¾¤ä½“å»ºæ¨¡æ–¹æ³•ã€‚è¯¥æ–¹æ¡ˆé€šè¿‡GINç½‘ç»œæœ‰æ•ˆæ•æ‰ç”¨æˆ·-ç‰©å“é«˜é˜¶äº¤äº’å…³ç³»ï¼Œä»è€Œæ›´ç²¾ç»†åœ°åˆ»ç”»ç”¨æˆ·å¤šæ ·åŒ–å…´è¶£ã€‚ç»“åˆç¾¤ä½“å»ºæ¨¡ç­–ç•¥ï¼Œå¯æ˜¾è‘—å‡å°‘åµŒå…¥æ„å»ºåå·®ï¼Œå¢å¼ºæ¨¡å‹æ³›åŒ–èƒ½åŠ›ã€‚æˆ‘ä»¬åœ¨å…¬å¼€æ•°æ®é›†å’Œå·¥ä¸šæ•°æ®é›†ä¸Šçš„å®éªŒè¡¨æ˜ï¼Œç›¸è¾ƒç°æœ‰æ–¹æ³•ï¼Œæ–°æ–¹æ¡ˆå¯¹æ´»è·ƒç”¨æˆ·å’Œå†·å¯åŠ¨ç”¨æˆ·å‡å¸¦æ¥æ˜¾è‘—æ•ˆæœæå‡ã€‚</p>
<h2 data-id="heading-6">07ã€ADOREï¼šå¤§æ¨¡å‹è‡ªåŠ¨åŒ–é©±åŠ¨ï¼Œé‡å¡‘ç”µå•†ç›¸å…³æ€§</h2>
<p>è®ºæ–‡ç±»å‹ï¼šSIGIR 2025</p>
<p>è®ºæ–‡ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2512.02555" target="_blank" title="https://arxiv.org/pdf/2512.02555" ref="nofollow noopener noreferrer">arxiv.org/pdf/2512.02â€¦</a></p>
<p>ä¸€å¥è¯ä»‹ç»ï¼šè®ºæ–‡æå‡ºäº†åŸºäºæ€ç»´é“¾ä¸å¼ºåŒ–å­¦ä¹ çš„ç›¸å…³æ€§å¤§æ¨¡å‹ï¼Œè‡ªåŠ¨ç”Ÿæˆéš¾æ ·æœ¬ä¸å¯¹æŠ—æ ·æœ¬ï¼Œå¹¶é€šè¿‡ç‰¹å¾è¿ç§»å¢å¼ºæµ…å±‚æ¨¡å‹ï¼Œæ˜¾è‘—æå‡ç”µå•†ç›¸å…³æ€§æ•ˆæœã€‚</p>
<p>è®ºæ–‡ç®€ä»‹ï¼šé’ˆå¯¹ç”µå•†ç›¸å…³æ€§åˆ¤åˆ«åœºæ™¯æ‰€é¢ä¸´çš„éš¾æ ·ä¾‹æ•°æ®ç¨€ç¼ºï¼Œçº¿ä¸Šæµ…å±‚æ¨¡å‹æ¨ç†åˆ¤åˆ«èƒ½åŠ›è¾ƒå¼±çš„é—®é¢˜ï¼Œæœ¬æ–‡æå‡ºäº†åŸºäºæ€ç»´é“¾æ¨ç†çš„ç›¸å…³æ€§å¤§æ¨¡å‹ï¼Œè‡ªåŠ¨åˆ†æåœ¨çº¿æ›å…‰å•†å“å¹¶ç”Ÿæˆé¢†åŸŸç‰¹å®šçš„éš¾æ ·æœ¬ï¼Œå¹¶é€šè¿‡KTOå¼ºåŒ–å­¦ä¹ ç®—æ³•è‡ªåŠ¨å¯¹é½çº¿ä¸Šç”¨æˆ·è¡Œä¸ºã€‚æ­¤å¤–ï¼Œè¿˜è®¾è®¡äº†é”™è¯¯ç±»å‹æ„ŸçŸ¥çš„ç”Ÿæˆå¤§æ¨¡å‹ï¼Œæ ¹æ®çº¿ä¸Šæ¨¡å‹æ˜“é”™åœºæ™¯è‡ªåŠ¨ç”Ÿæˆå¯¹æŠ—æ€§æ ·æœ¬ã€‚æœ€åï¼Œä¸ºäº†å°†å¤§æ¨¡å‹çŸ¥è¯†è¿ç§»åˆ°çº¿ä¸Šæµ…å±‚æ¨¡å‹ï¼Œæˆ‘ä»¬ä»COTåˆ†æä¸­ç»“æœä¸­æå–å…³é”®å±æ€§ç‰¹å¾æ˜¾å¼å¢å¼ºå­¦ç”Ÿæ¨¡å‹çš„è¡¨ç¤ºä¸æ¨ç†èƒ½åŠ›ã€‚å¤§è§„æ¨¡å®éªŒåŠåœ¨çº¿ABå®éªŒè¡¨æ˜ï¼ŒADOREåœ¨ç›¸å…³æ€§å’Œå¹¿å‘Šæ”¶å…¥ç­‰å…³é”®æŒ‡æ ‡ä¸Šæ˜¾è‘—ä¼˜äºå…¶å®ƒæ–¹æ³•ï¼Œä¸ºå·¥ä¸šçº§ç›¸å…³æ€§å»ºæ¨¡æä¾›äº†èµ„æºé«˜æ•ˆçš„æ–°èŒƒå¼ã€‚</p>
<h2 data-id="heading-7">08ã€é¢å‘ç”µå­å•†åŠ¡æœç´¢å¹¿å‘Šçš„å¤šç›®æ ‡å¯¹é½ç«ä»·è¯ç”Ÿæˆæ¨¡å‹</h2>
<p>è®ºæ–‡ç±»å‹ï¼šSIGIR 2025</p>
<p>è®ºæ–‡ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2506.03827" target="_blank" title="https://arxiv.org/pdf/2506.03827" ref="nofollow noopener noreferrer">arxiv.org/pdf/2506.03â€¦</a></p>
<p>ä¸€å¥è¯ä»‹ç»ï¼šè®ºæ–‡æå‡ºäº†ä¸€ç§å¤šç›®æ ‡å¯¹é½çš„ä¹°è¯ç”Ÿæˆæ¨¡å‹ï¼Œé€šè¿‡åˆ©ç”¨åˆ¤åˆ«å™¨é’ˆå¯¹ç›¸å…³æ€§ã€çœŸå®æ€§å’Œå¹¿å‘Šæ”¶å…¥çš„åé¦ˆä¿¡å·æ¥æŒ‡å¯¼ç”Ÿæˆå™¨è®­ç»ƒåŒæ—¶ä¼˜åŒ–è¿™ä¸‰ä¸ªå…³é”®ç›®æ ‡ã€‚</p>
<p>è®ºæ–‡ç®€ä»‹ï¼šé’ˆå¯¹ç”µå•†æœç´¢å¹¿å‘Šä¸­é•¿å°¾æŸ¥è¯¢éš¾ä»¥ç²¾ç¡®åŒ¹é…å•†å®¶ä¹°è¯ï¼ˆBidwordsï¼‰ä»è€Œå¯¼è‡´å¹¿å‘Šå¬å›ä¸è¶³çš„é—®é¢˜ï¼Œæœ¬æ–‡æŒ‡å‡ºä¼ ç»Ÿçš„æŸ¥è¯¢æ”¹å†™æ–¹æ³•å¾€å¾€æ— æ³•åŒæ—¶å…¼é¡¾æ”¹å†™åçš„ç›¸å…³æ€§ã€çœŸå®æ€§ä»¥åŠæœ€å¤§åŒ–å¹³å°æ”¶ç›Šã€‚ä¸ºæ­¤ï¼Œè®ºæ–‡æå‡ºäº†ä¸€ç§å¤šç›®æ ‡å¯¹é½çš„ä¹°è¯ç”Ÿæˆæ¨¡å‹ï¼ˆMoBGMï¼‰ï¼Œè¯¥æ¨¡å‹åŒ…å«åˆ¤åˆ«å™¨ã€ç”Ÿæˆå™¨å’Œåå¥½å¯¹é½æ¨¡å—ã€‚é€šè¿‡åˆ©ç”¨åˆ¤åˆ«å™¨é’ˆå¯¹ç›¸å…³æ€§ã€çœŸå®æ€§å’Œå¹¿å‘Šæ”¶å…¥çš„åé¦ˆä¿¡å·æ¥æŒ‡å¯¼ç”Ÿæˆå™¨è®­ç»ƒï¼ŒMoBGM èƒ½å¤ŸåŒæ—¶ä¼˜åŒ–è¿™ä¸‰ä¸ªå…³é”®ç›®æ ‡ã€‚ç¦»çº¿ä¸åœ¨çº¿å®éªŒç»“æœå‡è¡¨æ˜è¯¥ç®—æ³•æ˜¾è‘—ä¼˜äºç°æœ‰æœ€å…ˆè¿›ï¼ˆSOTAï¼‰æ–¹æ³•ï¼Œä¸”åœ¨å®é™…éƒ¨ç½²ä¸­å±•ç°äº†è‰¯å¥½çš„é²æ£’æ€§å¹¶åˆ›é€ äº†å·¨å¤§çš„å•†ä¸šä»·å€¼ã€‚</p>
<h2 data-id="heading-8">09ã€åŸºäºå› æœæœ€ä¼˜ä¼ è¾“çš„åéªŒä¿¡æ¯å»ºæ¨¡ç”¨äºCTRé¢„æµ‹</h2>
<p>è®ºæ–‡ç±»å‹ï¼šSIGIR 2025</p>
<p>è®ºæ–‡ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdl.acm.org%2Fdoi%2F10.1145%2F3726302.3731942" target="_blank" title="https://dl.acm.org/doi/10.1145/3726302.3731942" ref="nofollow noopener noreferrer">dl.acm.org/doi/10.1145â€¦</a></p>
<p>ä¸€å¥è¯ä»‹ç»ï¼šé’ˆå¯¹ç‚¹å‡»ç‡é¢„æµ‹ä¸­ç‚¹å‡»åç‰¹å¾ä¸å¯å¾—é—®é¢˜ï¼Œæå‡ºå› æœæœ€ä¼˜ä¼ è¾“æ¡†æ¶ï¼ˆCOTï¼‰ï¼Œé€šè¿‡ä¼ªç‰¹å¾ç”Ÿæˆå’Œå› æœåˆ†å¸ƒè°ƒæ•´ï¼Œå®ç°è®­ç»ƒ-æ¨æ–­ä¸€è‡´æ€§å¹¶æå‡æ¨¡å‹æ€§èƒ½ã€‚</p>
<p>è®ºæ–‡ç®€ä»‹ï¼šç²¾å‡†çš„ç‚¹å‡»ç‡ï¼ˆCTRï¼‰é¢„æµ‹å¯¹åœ¨çº¿å¹¿å‘Šè‡³å…³é‡è¦ï¼Œå…¶ä¾èµ–äºæµè§ˆå†å²ã€ç”¨æˆ·ç”»åƒç­‰å¸¸è§„ç‰¹å¾ï¼Œä»¥åŠå¹¿å‘Šä½ã€é¡µé¢è¡Œä¸ºç­‰post-eventç‰¹å¾ã€‚ç„¶è€Œï¼Œpost-eventç‰¹å¾åœ¨æ¨æ–­é˜¶æ®µä¸å¯å¾—ï¼Œå¸¸é¢ä¸´è®­ç»ƒ-æ¨æ–­ä¸ä¸€è‡´æ€§å’Œä½è¦†ç›–ç‡é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœç•™æ—¶é—´ç­‰ä»…å­˜åœ¨äºè¢«ç‚¹å‡»itemçš„ç‚¹å‡»åç‰¹å¾ã€‚ä¸ºè§£å†³è¿™äº›æŒ‘æˆ˜ï¼Œæˆ‘ä»¬æå‡ºå› æœæœ€ä¼˜ä¼ è¾“æ¡†æ¶ï¼ˆCausal Optimal Transport, COTï¼‰ï¼Œå…¶åˆ›æ–°æ€§ä½“ç°åœ¨ï¼š(1) é€šè¿‡åŠç›‘ç£ä¼ªæ ‡æ³¨ç”Ÿæˆç‚¹å‡»åä¼ªç‰¹å¾ï¼›(2) åˆ©ç”¨å› æœåˆ†å¸ƒè°ƒæ•´å™¨ï¼ˆCausal Distribution Shaper, CDSï¼‰å®ç°ç²¾å‡†çš„å› æœç‰¹å¾åˆ†å¸ƒç”Ÿæˆï¼›(3) é€šè¿‡æœ€ä¼˜ä¼ è¾“ä¼˜åŒ–ç‰¹å¾åˆ†å¸ƒï¼Œæœ€å°åŒ–åˆ†å¸ƒå·®å¼‚ä»¥ä¿ƒè¿›çŸ¥è¯†è¿ç§»ã€‚åŸºäºçœŸå®æ•°æ®çš„å®éªŒéªŒè¯äº†COTåœ¨é€šè¿‡æ”¹è¿›ç”¨æˆ·å…´è¶£å»ºæ¨¡å’Œåå·®ç¼“è§£æ¥æå‡CTRé¢„æµ‹æ–¹é¢çš„ä¼˜è¶Šæ€§ã€‚ç†è®ºåˆ†æè¯æ˜äº†è¯¥æ¡†æ¶çš„é²æ£’æ€§ã€‚</p>
<h2 data-id="heading-9">10ã€å±‚æ¬¡åŒ–ç”¨æˆ·é•¿æœŸè¡Œä¸ºå»ºæ¨¡åœ¨ç‚¹å‡»ç‡é¢„ä¼°ä¸­çš„åº”ç”¨</h2>
<p>è®ºæ–‡ç±»å‹ï¼šSIGIR 2025</p>
<p>è®ºæ–‡ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdl.acm.org%2Fdoi%2Fepdf%2F10.1145%2F3726302.3730207" target="_blank" title="https://dl.acm.org/doi/epdf/10.1145/3726302.3730207" ref="nofollow noopener noreferrer">dl.acm.org/doi/epdf/10â€¦</a></p>
<p>ä¸€å¥è¯ä»‹ç»ï¼šæå‡ºHBMæ¶æ„ï¼Œé€šè¿‡åˆ†å±‚ç²—/ç»†å…´è¶£å­¦ä¹ ç«¯åˆ°ç«¯å»ºæ¨¡ç”¨æˆ·è¡Œä¸ºï¼Œä¼˜åŒ–ç°æœ‰çš„ä¸¤é˜¶æ®µé•¿åºåˆ—å»ºæ¨¡ã€‚</p>
<p>è®ºæ–‡ç®€ä»‹ï¼šåœ¨å·¥ä¸šç•Œï¼Œç‚¹å‡»ç‡ï¼ˆCTRï¼‰é¢„æµ‹çš„æœ€å…ˆè¿›æ–¹æ³•ä¸»è¦ä¾èµ–äºåŸºäº Transformer çš„ç½‘ç»œåŠå…¶å˜ä½“ã€‚ç„¶è€Œï¼Œéšç€ç”¨æˆ·è¡Œä¸ºåºåˆ—å˜é•¿ï¼Œåœ¨å—é™çš„æ¨ç†æ—¶é—´å†…é‡‡ç”¨è‡ªæ³¨æ„åŠ›ç½‘ç»œè¿›è¡Œ CTR é¢„æµ‹é¢ä¸´é‡å¤§æŒ‘æˆ˜ã€‚ä¸ºè§£å†³è¿™ä¸€é—®é¢˜ï¼Œä¸»æµæ–¹æ³•é‡‡ç”¨ç»å…¸çš„ä¸¤é˜¶æ®µèŒƒå¼ï¼šé€šç”¨æœç´¢å•å…ƒï¼ˆGSUï¼‰ç”¨äºä»é•¿æœŸè¡Œä¸ºä¸­å¿«é€Ÿæ£€ç´¢ç›¸å…³ç‰©å“ï¼Œç²¾ç¡®æœç´¢å•å…ƒï¼ˆESUï¼‰ç”¨äºå¯¹ GSU ç­›é€‰å‡ºçš„ç‰©å“åº”ç”¨æœ‰æ•ˆçš„å¤šå¤´ç›®æ ‡æ³¨æ„åŠ›ï¼ˆMHTAï¼‰ã€‚è¿™äº›ä¸¤é˜¶æ®µç®—æ³•å­˜åœ¨ä¸€å®šå±€é™æ€§ï¼šé¦–å…ˆï¼ŒGSU éœ€è¦ä¸ºä¸åŒçš„ç›®æ ‡ç‰©å“æ£€ç´¢ä¸åŒçš„ç›®æ ‡å­åºåˆ—ï¼Œè¿™ä½¿å¾— ESU åªèƒ½é‡‡ç”¨æ¬¡ä¼˜çš„ MHTA ç½‘ç»œï¼Œè€Œéæ›´æœ‰æ•ˆçš„åŸºäº Transformer çš„ç½‘ç»œï¼›å…¶æ¬¡ï¼ŒGSU ä»…ä»ç”¨æˆ·è¡Œä¸ºåºåˆ—ä¸­æ£€ç´¢éƒ¨åˆ†ç‰©å“ï¼Œå¿½ç•¥äº†ç”¨æˆ·å…´è¶£çš„æ¼”å˜ä»¥åŠä¸åŒå…´è¶£ç‚¹ä¹‹é—´çš„å…³è”ã€‚</p>
<p>ä¸ºæ­¤ï¼Œæœ¬æ–‡æå‡ºä¸€ç§ç«¯åˆ°ç«¯å±‚æ¬¡åŒ–ç”¨æˆ·é•¿æœŸè¡Œä¸ºå»ºæ¨¡ç½‘ç»œç”¨äº CTR é¢„æµ‹ï¼ˆHBMï¼‰ã€‚å…·ä½“è€Œè¨€ï¼Œé¦–å…ˆé‡‡ç”¨å¤šå…´è¶£è·¯ç”±å±‚å°†ç”¨æˆ·çš„é•¿æœŸè¡Œä¸ºåˆ†æµåˆ°å¤šä¸ªèšåˆçš„å…´è¶£ç°‡ä¸­ï¼›æ­¤å¤–ï¼Œå¼•å…¥ç²¾ç»†å…´è¶£å­¦ä¹ ç½‘ç»œï¼Œä»åˆå§‹èšåˆè¡¨ç¤ºä¸­ç­›é€‰å‡º top-k ä¸ªå…´è¶£ï¼›éšåï¼Œåˆ©ç”¨ Transformer ç½‘ç»œå¯¹ä¸è¿™äº› top-k å…´è¶£ç›¸å…³çš„ç”¨æˆ·è¡Œä¸ºåºåˆ—è¿›è¡Œç²¾ç»†åŒ–å»ºæ¨¡ï¼ŒåŒæ—¶åœ¨ç²—ç²’åº¦å±‚é¢æ•æ‰ä¸åŒç”¨æˆ·å…´è¶£ä¹‹é—´çš„å†…åœ¨å…³è”ã€‚åœ¨äº¬ä¸œæ¨èå¹³å°çš„åœ¨çº¿ A/B æœ‰å¾ˆå¤§çš„æå‡ã€‚</p>
<h2 data-id="heading-10">11ã€äº¬ä¸œé›¶å”®å¹¿å‘Šåˆ›æ„ï¼šå¼•å…¥åœºåŸŸç›®æ ‡çš„åˆ›æ„å›¾ç‰‡ç”Ÿæˆ</h2>
<p>è®ºæ–‡ç±»å‹ï¼šWWW 2025</p>
<p>è®ºæ–‡ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2502.06823" target="_blank" title="https://arxiv.org/pdf/2502.06823" ref="nofollow noopener noreferrer">arxiv.org/pdf/2502.06â€¦</a></p>
<p>ä¸€å¥è¯ä»‹ç»ï¼šé€šè¿‡å¤šæ¨¡æ€å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆMLLMsï¼‰ç”Ÿæˆç”µå•†å¹¿å‘Šå›¾ç‰‡ï¼Œä»¥ä¼˜åŒ–ç‚¹å‡»ç‡ï¼ˆCTRï¼‰ä¸ºç›®æ ‡ï¼Œå¹¶é€šè¿‡å¼ºåŒ–å­¦ä¹ å¾®è°ƒæ¨¡å‹ä»¥æé«˜ç”Ÿæˆå›¾ç‰‡çš„CTRï¼Œç¡®ä¿èƒŒæ™¯ä¸å•†å“ç‰¹å¾ä¸€è‡´ã€‚</p>
<p>è®ºæ–‡ç®€ä»‹ï¼šåœ¨ç”µå•†å¹³å°ä¸­ï¼Œå¹¿å‘Šå›¾ç‰‡å¯¹äºå¸å¼•ç”¨æˆ·æ³¨æ„åŠ›å’Œæé«˜å¹¿å‘Šæ•ˆæœè‡³å…³é‡è¦ã€‚å¤§å¤šæ•°ç°æœ‰çš„æ–¹æ³•åœ¨ä¸ºå•†å“ç”ŸæˆèƒŒæ™¯æ—¶ä¸»è¦å…³æ³¨ç¾å­¦è´¨é‡ï¼Œè¿™å¯èƒ½æ— æ³•å®ç°ä»¤äººæ»¡æ„çš„åœ¨çº¿è¡¨ç°ã€‚ä¸ºäº†è§£å†³è¿™ä¸€å±€é™æ€§ï¼Œæˆ‘ä»¬æ¢ç´¢ä½¿ç”¨å¤šæ¨¡æ€å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆMLLMsï¼‰æ¥ç”Ÿæˆå¹¿å‘Šå›¾ç‰‡ï¼Œå¹¶å°†ä¼˜åŒ–ç‚¹å‡»ç‡ï¼ˆCTRï¼‰ä½œä¸ºä¸»è¦ç›®æ ‡ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æ„å»ºäº†é’ˆå¯¹æ€§çš„é¢„è®­ç»ƒä»»åŠ¡ï¼Œå¹¶åˆ©ç”¨å¤§è§„æ¨¡çš„ç”µå•†å¤šæ¨¡æ€æ•°æ®é›†ï¼Œä¸ºMLLMsæä¾›å¹¿å‘Šå›¾ç‰‡ç”Ÿæˆä»»åŠ¡çš„åˆå§‹èƒ½åŠ›ã€‚ä¸ºäº†è¿›ä¸€æ­¥æé«˜ç”Ÿæˆå›¾ç‰‡çš„CTRï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§æ–°é¢–çš„å¥–åŠ±æ¨¡å‹ï¼Œé€šè¿‡å¼ºåŒ–å­¦ä¹ ï¼ˆRLï¼‰å¯¹é¢„è®­ç»ƒçš„MLLMsè¿›è¡Œå¾®è°ƒï¼Œè¯¥æ¨¡å‹èƒ½å¤Ÿè”åˆåˆ©ç”¨å¤šæ¨¡æ€ç‰¹å¾å¹¶å‡†ç¡®åæ˜ ç”¨æˆ·çš„ç‚¹å‡»åå¥½ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ç§ä»¥å•†å“ä¸ºä¸­å¿ƒçš„åå¥½ä¼˜åŒ–ç­–ç•¥ï¼Œä»¥ç¡®ä¿å¾®è°ƒåç”Ÿæˆçš„èƒŒæ™¯å†…å®¹ä¸å•†å“ç‰¹å¾ä¸€è‡´ï¼Œä»è€Œå¢å¼ºå¹¿å‘Šå›¾ç‰‡çš„æ•´ä½“ç›¸å…³æ€§å’Œæ•ˆæœã€‚å¤§é‡å®éªŒè¡¨æ˜ï¼Œæˆ‘ä»¬çš„æ–¹æ³•åœ¨åœ¨çº¿å’Œç¦»çº¿æŒ‡æ ‡ä¸Šå‡è¾¾åˆ°äº†æœ€å…ˆè¿›çš„æ€§èƒ½ã€‚</p>
<h2 data-id="heading-11">12ã€ç”Ÿæˆå¼å¬å›å¯¹é½æ–°èŒƒå¼GRAM</h2>
<p>è®ºæ–‡ç±»å‹ï¼šWWW 2025</p>
<p>è®ºæ–‡ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdl.acm.org%2Fdoi%2Fepdf%2F10.1145%2F3701716.3715228" target="_blank" title="https://dl.acm.org/doi/epdf/10.1145/3701716.3715228" ref="nofollow noopener noreferrer">dl.acm.org/doi/epdf/10â€¦</a></p>
<p>ä¸€å¥è¯ä»‹ç»ï¼šæœ¬æ–‡æå‡ºä¸€ä¸ªç”µå•†æ£€ç´¢æ–°èŒƒå¼ GRAMï¼Œé€šè¿‡ç”Ÿæˆå…±äº«æ ‡è¯†ç¬¦ä¸å¯¹é½æœºåˆ¶ï¼Œè§£å†³äº†è¯­ä¹‰åå·®å¹¶æ˜¾è‘—æå‡å¬å›æ•ˆç‡ã€‚</p>
<p>è®ºæ–‡ç®€ä»‹ï¼šé’ˆå¯¹ä¼ ç»Ÿæ£€ç´¢æ–¹æ³•éš¾ä»¥åˆ©ç”¨é€šç”¨çŸ¥è¯†ã€ä¸”ç°æœ‰åŸºäºLLMçš„æ£€ç´¢æ–¹æ³•å­˜åœ¨â€œæŸ¥è¯¢-å•†å“â€è¯­ä¹‰åˆ†å¸ƒä¸ä¸€è‡´å¯¼è‡´å¬å›æ•ˆç‡ä½çš„é—®é¢˜ï¼Œè¿™ç¯‡è®ºæ–‡æå‡ºäº†ä¸€ç§åä¸ºGRAMï¼ˆç”Ÿæˆå¼æ£€ç´¢ä¸å¯¹é½æ¨¡å‹ï¼‰çš„æ–°å‹ç”µå•†æ£€ç´¢èŒƒå¼ã€‚</p>
<p>GRAMé€šè¿‡è”åˆè®­ç»ƒæŸ¥è¯¢å’Œå•†å“çš„æ–‡æœ¬ä¿¡æ¯æ¥ç”Ÿæˆå…±äº«æ–‡æœ¬æ ‡è¯†ç ï¼Œæœ‰æ•ˆå¼¥åˆäº†ä¸¤è€…é—´çš„è¯­ä¹‰é¸¿æ²Ÿï¼Œå¹¶åˆ©ç”¨ååŒå¯¹é½ç­–ç•¥ä¸æŸ¥è¯¢-å•†å“è¯„åˆ†æœºåˆ¶æœ€å¤§åŒ–äº†æ£€ç´¢æ•ˆç‡ä¸è´¨é‡ï¼›å¤§é‡ç¦»çº¿åŠåœ¨çº¿A/Bæµ‹è¯•å‡è¯å®ï¼ŒGRAMåœ¨æ€§èƒ½ä¸Šæ˜¾è‘—ä¼˜äºä¼ ç»Ÿæ¨¡å‹åŠæœ€æ–°çš„ç”Ÿæˆå¼æ£€ç´¢æ¨¡å‹ï¼Œè¯æ˜äº†å…¶åœ¨å·¥ä¸šåº”ç”¨ä¸­çš„æœ‰æ•ˆæ€§ã€‚</p>
<h2 data-id="heading-12">13ã€ä¸€ç§ç”¨äºç²—æ’ç‚¹å‡»ç‡é¢„ä¼°çš„å…¨ç©ºé—´æ— åå› æœæ¨æ–­æ¡†æ¶</h2>
<p>è®ºæ–‡ç±»å‹ï¼šWWW 2025</p>
<p>è®ºæ–‡ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdl.acm.org%2Fdoi%2Fepdf%2F10.1145%2F3701716.3715210" target="_blank" title="https://dl.acm.org/doi/epdf/10.1145/3701716.3715210" ref="nofollow noopener noreferrer">dl.acm.org/doi/epdf/10â€¦</a></p>
<p>ä¸€å¥è¯ä»‹ç»ï¼šUECF æ¡†æ¶é€šè¿‡ä¼ªæ ‡ç­¾ç”Ÿæˆï¼ˆè§£å†³æœªæ›å…‰æ ·æœ¬æ ‡ç­¾ç¼ºå¤±ï¼‰ã€è‡ªåŠ¨æ ·æœ¬é€‰æ‹©ï¼ˆè¿‡æ»¤å™ªå£°ï¼‰ã€å…¨ç©ºé—´å› æœå­¦ä¹ ï¼ˆä¿®æ­£ SSBï¼‰ï¼Œå®ç°äº†ç²—æ’é˜¶æ®µçš„æ— å CTR ä¼°è®¡</p>
<p>è®ºæ–‡ç®€ä»‹ï¼šåœ¨çº¿å¹¿å‘Šç³»ç»Ÿå¹¿æ³›é‡‡ç”¨å…ˆè¿›æ¨èç®—æ³•ä¼˜åŒ–ç‚¹å‡»ç‡ï¼ˆCTRï¼‰å¹¶æå‡æ”¶ç›Šï¼Œä½†ç²—æ’é˜¶æ®µå¸¸é¢ä¸´æ ·æœ¬é€‰æ‹©åå·®ï¼ˆSSBï¼‰é—®é¢˜ï¼šCTRæ¨¡å‹åŸºäºç²¾æ’åé¦ˆè®­ç»ƒï¼Œå´åº”ç”¨äºåˆ†å¸ƒä¸åŒçš„ç²—æ’é˜¶æ®µï¼Œå¸¦æ¥é¢„ä¼°åå·®çš„åŒæ—¶å‰Šå¼±å¹¿å‘Šç­–ç•¥æœ‰æ•ˆæ€§ã€‚ç°æœ‰æ–¹æ³•ä¾èµ–ç»éªŒæ ‡ç­¾ç”Ÿæˆå’Œéšæœºé‡‡æ ·ï¼Œæœªèƒ½æ ¹æœ¬è§£å†³åå·®ï¼Œåè€Œå¼•å…¥é¢å¤–è¯¯å·®ã€‚é’ˆå¯¹æ­¤ï¼Œæœ¬æ–‡æå‡ºæ— ååäº‹å®å› æœCTRé¢„ä¼°æ¡†æ¶ï¼ŒåŒ…å«ä¸¤å¤§åˆ›æ–°ï¼š1ï¼‰ç‰¹å¾çº§æ— åæ ‡ç­¾ç”Ÿæˆæ¨¡å—ï¼Œå……åˆ†åˆ©ç”¨å…¨ç©ºé—´æ ·æœ¬ï¼ˆå«æœªæ›å…‰æ•°æ®ï¼‰ï¼›2ï¼‰è‡ªåŠ¨åŒ–æ ·æœ¬é€‰æ‹©æ¨¡å—ï¼Œå¹³è¡¡å»ºæ¨¡ç²¾åº¦ä¸è®¡ç®—æ•ˆç‡ã€‚ç†è®ºè¯æ˜è¯¥æ¡†æ¶åœ¨å…¨ç©ºé—´å†…ä¿æŒæ— åæ€§ï¼Œç¦»çº¿å®éªŒä¸A/Bæµ‹è¯•æ˜¾ç¤ºï¼Œç›¸æ¯”ç°æœ‰å…ˆè¿›æ–¹æ³•ï¼Œæ¨¡å‹åœ¨å…¬å¼€åŠå·¥ä¸šæ•°æ®é›†ä¸Šçš„AUCæŒ‡æ ‡æ˜¾è‘—æå‡ã€‚</p>
<h2 data-id="heading-13">14ã€AutoPP: è‡ªåŠ¨åŒ–å•†å“æµ·æŠ¥ç”Ÿæˆä¸ä¼˜åŒ–</h2>
<p>è®ºæ–‡ç±»å‹ï¼šAAAI  2025</p>
<p>è®ºæ–‡ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2512.21921" target="_blank" title="https://arxiv.org/pdf/2512.21921" ref="nofollow noopener noreferrer">arxiv.org/pdf/2512.21â€¦</a></p>
<p>ä¸€å¥è¯ä»‹ç»ï¼šé€šè¿‡ç”Ÿæˆå™¨ç»Ÿä¸€è®¾è®¡èƒŒæ™¯/æ–‡æ¡ˆ/å¸ƒå±€ï¼Œä¼˜åŒ–å™¨åˆ©ç”¨IDPOç®—æ³•æ•°æ®é©±åŠ¨è¿­ä»£ï¼Œæ˜¾è‘—æå‡åˆ›æ„æ•ˆç‡ä¸ç‚¹å‡»ç‡</p>
<p>è®ºæ–‡ç®€ä»‹ï¼šå•†å“æµ·æŠ¥é€šè¿‡æå…·å†²å‡»åŠ›çš„è§†è§‰è®¾è®¡ä¸ä¿¡æ¯ä¸°å¯Œçš„æ–‡å­—å†…å®¹ç›¸ç»“åˆï¼Œçªå‡ºäº§å“ç‰¹è‰²å¹¶æœ‰æ•ˆæ•æ‰æ¶ˆè´¹è€…æ³¨æ„åŠ›ã€‚ç„¶è€Œä¼ ç»Ÿäººå·¥è®¾è®¡æ–¹å¼ä¸ä»…åˆ›æ„äº§å‡ºæ•ˆç‡ä½ä¸‹ï¼ŒåŸºäºçº¿ä¸Šæ•ˆæœçš„æ‰‹åŠ¨è°ƒä¼˜æ›´æ˜¯è€—è´¹å¤§é‡èµ„æºã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æ¨å‡ºå…¨è‡ªåŠ¨æµ·æŠ¥ç”Ÿäº§ä¼˜åŒ–ç³»ç»ŸAutoPPï¼Œè¯¥ç³»ç»Ÿæ ¸å¿ƒç”±ä¸¤å¤§æ¨¡å—æ„æˆï¼šç”Ÿæˆå™¨ä»…éœ€è¾“å…¥å•†å“åŸºç¡€ä¿¡æ¯ï¼Œå³å¯é€šè¿‡ç»Ÿä¸€è®¾è®¡æ¨¡å—ååŒæ¨ç†æµ·æŠ¥ä¸‰å¤§è¦ç´ ï¼ˆèƒŒæ™¯/æ–‡æ¡ˆ/å¸ƒå±€ï¼‰çš„æœ‰æœºç»„åˆï¼Œå†ç»ç”±è¦ç´ æ¸²æŸ“æ¨¡å—å°†å„è¦ç´ ç¼–ç ä¸ºæ¡ä»¶ä»¤ç‰Œï¼Œå®ç°é«˜æ•ˆå¯æ§çš„æµ·æŠ¥è¾“å‡ºã€‚ä¼˜åŒ–å™¨åˆ™åŸºäºç”Ÿæˆç»“æœï¼Œé€šè¿‡è¦ç´ æ›¿æ¢å¯¹æ¯”è·å–ç»†ç²’åº¦CTRæ•°æ®ï¼Œé‡‡ç”¨å­¤ç«‹ç›´æ¥åå¥½ä¼˜åŒ–ç®—æ³•ï¼ˆIDPOï¼‰ç²¾å‡†å½’å› ç‚¹å‡»ç‡æå‡åŠ¨å› ï¼Œå®Œæˆæ•°æ®é©±åŠ¨çš„è‡ªåŠ¨åŒ–è¿­ä»£ã€‚</p>
<h2 data-id="heading-14">15ã€ä»å‡è®¾åˆ°å‰æï¼šåŸºäºLLMçš„é€‰æ‹©æ€§ç¬¦å·ç¿»è¯‘é€†å‘é€»è¾‘æ¨ç†</h2>
<p>è®ºæ–‡ç±»å‹ï¼šAAAI 2025</p>
<p>è®ºæ–‡ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2512.03360v1" target="_blank" title="https://arxiv.org/pdf/2512.03360v1" ref="nofollow noopener noreferrer">arxiv.org/pdf/2512.03â€¦</a></p>
<p>ä¸€å¥è¯ä»‹ç»ï¼šæœ¬æ–‡æå‡ºäº†ä¸€ç§æ–°é¢–çš„å‡è®¾é©±åŠ¨é€†å‘é€»è¾‘æ¨ç†æ¡†æ¶HBLRï¼Œé€šè¿‡é«˜ç½®ä¿¡åº¦ç¬¦å·è½¬æ¢ä¸é€†å‘æ¼”ç»ç›¸ç»“åˆçš„æ–¹å¼ï¼Œæ˜¾è‘—æå‡äº†è¯­è¨€æ¨¡å‹çš„æ¨ç†å‡†ç¡®æ€§ä¸æ•ˆç‡ã€‚</p>
<p>è®ºæ–‡ç®€ä»‹ï¼šé€»è¾‘æ¨ç†æ˜¯è‡ªç„¶è¯­è¨€ç†è§£çš„æ ¸å¿ƒæŒ‘æˆ˜ï¼Œä¹Ÿæ˜¯äººå·¥æ™ºèƒ½çš„åŸºæœ¬èƒ½åŠ›ï¼Œæ˜¯ç§‘å­¦å‘ç°ã€æ•°å­¦å®šç†è¯æ˜å’Œå¤æ‚å†³ç­–çš„åŸºç¡€ã€‚å°½ç®¡å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆllmï¼‰å–å¾—äº†æ˜¾è‘—çš„è¿›æ­¥ï¼Œä½†å¤§å¤šæ•°å½“å‰çš„æ–¹æ³•ä»ç„¶ä¾èµ–äºå‰å‘æ¨ç†èŒƒå¼ï¼Œä»å‰æåˆ°ç»“è®ºé€æ­¥ç”ŸæˆåŸºæœ¬åŸç†ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•å¾€å¾€å­˜åœ¨æ¨ç†è·¯å¾„å†—ä½™ã€æ­¥éª¤å¹»è§‰ã€è¯­ä¹‰æ¼‚ç§»ç­‰é—®é¢˜ï¼Œå¯¼è‡´æ¨ç†æ•ˆç‡ä½ä¸‹å’Œä¸å¯é ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ–°çš„æ¡†æ¶ï¼Œå‡è®¾é©±åŠ¨çš„åå‘é€»è¾‘æ¨ç†ï¼ˆHBLRï¼‰ã€‚</p>
<p>å…¶æ ¸å¿ƒæ€æƒ³æ˜¯å°†è‡ªä¿¡æ„ŸçŸ¥çš„ç¬¦å·ç¿»è¯‘ä¸å‡è®¾é©±åŠ¨çš„é€†å‘æ¨ç†ç›¸ç»“åˆã€‚åœ¨ç¿»è¯‘é˜¶æ®µï¼Œåªæœ‰é«˜ç½®ä¿¡åŒºé—´è¢«è½¬æ¢ä¸ºé€»è¾‘å½¢å¼ï¼Œå¦‚ä¸€é˜¶é€»è¾‘ï¼ˆFOLï¼‰ï¼Œè€Œä¸ç¡®å®šçš„å†…å®¹åˆ™ä¿ç•™åœ¨è‡ªç„¶è¯­è¨€ä¸­ã€‚ç¿»è¯‘åå°„æ¨¡å—é€šè¿‡è¯„ä¼°ç¬¦å·è¾“å‡ºå¹¶åœ¨å¿…è¦æ—¶å°†æœ‰æŸè¾“å‡ºæ¢å¤åˆ°æ–‡æœ¬ï¼Œè¿›ä¸€æ­¥ç¡®ä¿è¯­ä¹‰ä¿çœŸåº¦ã€‚åœ¨æ¨ç†é˜¶æ®µï¼ŒHBLRé€šè¿‡å‡è®¾ç»“è®ºä¸ºçœŸå¹¶é€’å½’éªŒè¯å…¶å‰ææ¥æ¨¡æ‹Ÿäººç±»æ¼”ç»æ€ç»´ã€‚æ¨ç†åå°„æ¨¡å—è¿›ä¸€æ­¥è¯†åˆ«å’Œçº æ­£æœ‰ç¼ºé™·çš„æ¨ç†æ­¥éª¤ï¼Œå¢å¼ºé€»è¾‘ä¸€è‡´æ€§ã€‚åœ¨äº”ä¸ªæ¨ç†åŸºå‡†ä¸Šè¿›è¡Œçš„å¤§é‡å®éªŒè¡¨æ˜ï¼ŒHBLRåœ¨å‡†ç¡®æ€§å’Œæ•ˆç‡æ–¹é¢å§‹ç»ˆä¼˜äºå¼ºåŸºçº¿ã€‚</p>
<h2 data-id="heading-15">ã€äº’åŠ¨ç¦åˆ©ã€‘</h2>
<p>å…³æ³¨ã€äº¬ä¸œé›¶å”®æŠ€æœ¯ã€‘å…¬ä¼—å·ï¼Œè½¬å‘æœ¬æ–‡è‡³æœ‹å‹åœˆé…æ–‡ï¼šäº¬ä¸œé›¶å”®æŠ€æœ¯15ç¯‡é¡¶ä¼šè®ºæ–‡å¹´åº¦ç²¾é€‰ï¼ç ”ç©¶æ–¹å‘è¦†ç›–äº†å¤§å‹è¯­è¨€æ¨¡å‹è®­ç»ƒä¼˜åŒ–ã€å¤šæ¨¡æ€å†…å®¹ç”Ÿæˆä¸ä¼˜åŒ–ã€å› æœæ¨æ–­ä¸ç‚¹å‡»ç‡é¢„ä¼°ç­‰å¤šä¸ªå…³é”®æ–¹å‘ï¼ŒæŠ€æœ¯äººå¿…è—ï½</p>
<p>é›†èµè¦æ±‚ï¼šå‘é€ç‚¹èµæˆªå›¾åˆ°åå°ï¼Œå¹¶ç•™ä¸‹å¾®ä¿¡å·ï¼ˆæ–¹ä¾¿æ‹‰ç¾¤ï¼‰</p>
<p>é›†èµ20ä¸ªï¼ŒæŠ½å–5ä½åŒå­¦é€å‡ºé›¶å”®æŠ€æœ¯å®šåˆ¶å¸†å¸ƒåŒ…ã€‚</p>
<p>é›†èµ50ä¸ªï¼ŒæŠ½å–3ä½åŒå­¦é€å‡ºé›¶å”®æŠ€æœ¯å®šåˆ¶ä¿æ¸©æ¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/701861ffdc054116bc8e80031b7f5929~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic6Zu25ZSu5oqA5pyv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769423640&amp;x-signature=wEFD6W9MCAEr35XhCKOF9tgbF6A%3D" alt="image.png" loading="lazy"/></p>
<p>æ¬¢è¿æŠŠæ–‡ç« åˆ†äº«åˆ°æœ‹å‹åœˆï¼Œè®©æ›´å¤šäººå…³æ³¨äº¬ä¸œé›¶å”®æŠ€æœ¯ï¼ˆå¼€å¥–æ—¶é—´ï¼š2026å¹´1æœˆ22æ—¥ï¼‰</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MCP å…¥é—¨ 02ï¼šçˆ½ï¼æ‰“é€šäº†AIå’Œå…¬å¸ä½ä»£ç åº“]]></title>    <link>https://juejin.cn/post/7596684490661904418</link>    <guid>https://juejin.cn/post/7596684490661904418</guid>    <pubDate>2026-01-19T10:38:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596684490661904418" data-draft-id="7596869784538087424" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MCP å…¥é—¨ 02ï¼šçˆ½ï¼æ‰“é€šäº†AIå’Œå…¬å¸ä½ä»£ç åº“"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-19T10:38:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‘¸é±¼çš„æ˜¥å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/1714893870865303"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MCP å…¥é—¨ 02ï¼šçˆ½ï¼æ‰“é€šäº†AIå’Œå…¬å¸ä½ä»£ç åº“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1714893870865303/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‘¸é±¼çš„æ˜¥å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T10:38:10.000Z" title="Mon Jan 19 2026 10:38:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;font-weight:400;line-height:2;font-size:17px;overflow-x:hidden;color:#000}.markdown-body strong{padding:1px;color:#ee3f4d}.markdown-body em{padding:0 2px;color:#f33b1f}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:30px;margin-bottom:20px;line-height:1.5;font-weight:700}.markdown-body h1{text-align:center;padding-bottom:5px;font-size:32px;color:#ac1f18}.markdown-body h1:after{content:"";display:block;margin:4px auto 0;width:100px;height:2px;border-bottom:2px solid #f33b1f}.markdown-body h2{font-size:28px;border-bottom:1px solid #f33b1f}.markdown-body h2:before{content:"# "!important;color:#f33b1f}.markdown-body h3{font-size:24px;padding-left:9px;border-left:6px solid #f33b1f}.markdown-body h4{font-size:20px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #bbb;margin:16px 0}.markdown-body code{word-break:break-word;overflow-x:auto;background-color:#f9f1db;color:#ee2746;border-radius:2px;font-size:16px;padding:1px 2px}.markdown-body code,.markdown-body pre{font-family:-apple-system,-apple-system-body,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,PingFang SC,æ€æºé»‘ä½“ CN,æ€æºé»‘ä½“,JetBrains Mono,Fira Code,Menlo,Ubuntu Mono,Consolas,sans-serif}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{margin:12px 0!important;border-radius:3px;font-size:15px;padding:16px 12px;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f7f7f7}.markdown-body a{text-decoration:none;color:#1781b5;padding:0 2px;border-bottom:1px solid #1781b5}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #f33b1f;color:#ac1f18}.markdown-body blockquote{color:#3d3d3d;background-color:#fff9f9;padding:6px 16px;margin:16px 0;border-left:3px solid #f07c82}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:6px 0}.markdown-body ol,.markdown-body ul{padding-left:30px}.markdown-body ol li,.markdown-body ul li{margin-bottom:6px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:6px}.markdown-body ol li{padding-left:6px}.markdown-body ::marker{color:#f33b1f}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body .task-list-item input[type=checkbox]{position:relative}.markdown-body .task-list-item input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:#fff;border:1px solid #f07c82;border-radius:3px;box-sizing:border-box;z-index:1}.markdown-body .task-list-item input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-5px;left:0;right:0;bottom:0;width:0;height:0;color:#f33b1f;font-size:16px;font-weight:700;z-index:2}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border-spacing:0;border-collapse:collapse}.markdown-body table thead{background:#fff9f9;color:#000;text-align:left;font-size:15px}.markdown-body table tr:nth-child(2n){background-color:#fcfcfc}.markdown-body table tr:hover{background-color:#fff9f9}.markdown-body table td,.markdown-body table th{padding:12px 7px;line-height:24px;border:1px solid #f9f1db}.markdown-body table td{min-width:120px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="monokai">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#272822;color:#ddd}.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-strong,.hljs-tag{color:#f92672}.hljs-code{color:#66d9ef}.hljs-class .hljs-title{color:#fff}.hljs-attribute,.hljs-link,.hljs-regexp,.hljs-symbol{color:#bf79db}.hljs-addition,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-emphasis,.hljs-section,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-string,.hljs-subst,.hljs-template-tag,.hljs-template-variable,.hljs-title,.hljs-type,.hljs-variable{color:#a6e22e}.hljs-comment,.hljs-deletion,.hljs-meta,.hljs-quote{color:#75715e}.hljs-doctag,.hljs-keyword,.hljs-literal,.hljs-section,.hljs-selector-id,.hljs-selector-tag,.hljs-title,.hljs-type{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä¸Šä¸€é›†ï¼Œæˆ‘ä»¬è®¤è¯†äº† <code>MCP</code> çš„åŸºæœ¬æ¦‚å¿µå’Œè„šæ‰‹æ¶æ­å»ºã€‚</p>
<p>è¿™ä¸€é›†ï¼Œæˆ‘ä»¬è¦è§£å†³å…·ä½“çš„é—®é¢˜ï¼š</p>
<blockquote>
<p>AI ä¸äº†è§£ä½ä»£ç åº“å’Œå­˜å‚¨çš„schemaï¼Œæ— æ³•åšä¸Šä¸‹æ–‡å…³è”ç»™å‡ºæ­£ç¡®çš„æç¤ºå’Œä»£ç ä¿®æ”¹ã€‚</p>
</blockquote>
<p>è¿™æ˜¯ <code>MCP</code> æ“…é•¿çš„é¢†åŸŸä¹‹ä¸€ï¼Œå­¦ä¼šå®ƒå°±èƒ½è§£å†³ä¸€å¤§æ‰¹ç±»ä¼¼çš„åœºæ™¯ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« ä¾§é‡äºå®æˆ˜é—­ç¯ï¼šè®© AI è¯†åˆ«ä»£ç ä¸­çš„ä½ä»£ç ç»„ä»¶ï¼Œè‡ªåŠ¨å»å…¬å¸å†…ç½‘ API æŸ¥è¯¢è¯¥é¡µé¢çš„æ•°æ®åº“ Schemaï¼Œå¹¶ç»“åˆä»£ç ä¸­çš„å±æ€§è¿›è¡Œæ™ºèƒ½åˆ†æã€‚</p>
<h2 data-id="heading-1">ğŸ¯ æœ¬è¯¾ç›®æ ‡</h2>
<ul>
<li>
<p>è¿æ¥å…¬å¸å†…ç½‘çš„ä½ä»£ç APIï¼šä½¿ç”¨ <code>Axios</code> è°ƒç”¨å†…ç½‘æ¥å£ï¼Œä¸å†æ˜¯è¿”å›å‡æ•°æ®ã€‚</p>
</li>
<li>
<p>åŠ¨æ€ Token ç®¡ç†ï¼šè§£å†³ Access Token å®¹æ˜“è¿‡æœŸçš„é—®é¢˜ï¼Œæ— éœ€é‡å¯æœåŠ¡å³å¯æ›´æ–°ã€‚</p>
</li>
<li>
<p>Agentic Workflow (é—­ç¯)ï¼šé€šè¿‡ç³»ç»Ÿæç¤ºè¯ï¼ˆSystem Promptï¼‰ï¼Œç»™ AI æ¤å…¥â€œæ¡ä»¶åå°„â€ï¼Œè®©å®ƒçœ‹åˆ°ç‰¹å®šä»£ç å°±è‡ªåŠ¨æŸ¥åº“ã€‚</p>
</li>
<li>
<p>ä¸šåŠ¡é€»è¾‘æ³¨å…¥ï¼šæ•™ AI ç†è§£â€œæ•°æ®åº“é…ç½®â€ä¸â€œä»£ç è¦†ç›–â€ä¹‹é—´çš„ä¼˜å…ˆçº§å…³ç³»ã€‚</p>
</li>
</ul>
<p>å…ˆçœ‹çœ‹æ•ˆæœï¼š</p>
<blockquote>
<p>æäº†ä¸€äº›è¦æ±‚ï¼Œæ ¸å¿ƒæ•°æ®å¹¶ä¸åœ¨æœ¬åœ°å·¥ç¨‹é‡Œï¼Œè€Œæ˜¯åœ¨ä½ä»£ç å¹³å°çš„<code>schema</code> é‡Œï¼Œæ­£å¸¸æƒ…å†µä¸‹AIæ˜¯æ— æ³•è¯»å–çš„ã€‚</p>
</blockquote>
<blockquote>
<p>ä½†æ˜¯æœ‰äº†æˆ‘ä»¬çš„MCPå’Œæç¤ºè¯ä¼˜åŒ–ï¼ŒAIå°±å¯ä»¥æ­£å¸¸è¯»å–å’Œä¿®æ”¹æœ¬åœ°ä»£ç è¦†å†™äº†ã€‚</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/649803acda34489abd7b22d5f470d420~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pG46bG855qE5pil5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769423890&amp;x-signature=Jc8kGlFfoOjUBICluE%2BRVO%2FHBqw%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">ä¸€ã€ æ·»åŠ éƒ¨åˆ†ä¾èµ–åº“</h2>
<p>æˆ‘ä»¬å°†ä½¿ç”¨ axios æ¥å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œå¹¶å¼•å…¥ä¸€ä¸ªå†…å­˜å˜é‡æ¥ç®¡ç† Tokenã€‚</p>
<p>ç¡®ä¿ package.json åŒ…å«ä»¥ä¸‹æ ¸å¿ƒåº“ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"module"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"@modelcontextprotocol/sdk"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^1.0.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"axios"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^1.0.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"dotenv"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^16.0.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"zod"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^3.0.0"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-3">äºŒã€ ç¡®å®š tools å’Œå·¥å…·é€»è¾‘</h2>
<p>åœ¨ index.js ä¸­ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰èƒ¡ä¹±å †ç ŒåŠŸèƒ½ï¼Œè€Œæ˜¯ç²¾å‡†è®¾è®¡äº†ä¸¤ä¸ªå·¥å…·ï¼Œåˆ†åˆ«è§£å†³äº†ä½ä»£ç å¼€å‘åœºæ™¯ä¸‹çš„ â€œè¯»å–schemaâ€ å’Œ â€œTokenç»­æœŸâ€ ä¸¤å¤§æ ¸å¿ƒéš¾é¢˜ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/53e47095529147a7a923a8c6dd39be15~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pG46bG855qE5pil5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769423890&amp;x-signature=nF13uhymjkQvksbHCBG3MZvtgvI%3D" alt="" loading="lazy"/></p>
<p>ä»¥ä¸Šæ˜¯æˆ‘ä»¬è¦å®ç°çš„ä¸»ä½“æ€è·¯ã€‚</p>
<h3 data-id="heading-4">2.1 ğŸ”§ å·¥å…·ä¸€ï¼šget_page_detail_by_code</h3>
<p>è§£å†³ç—›ç‚¹ï¼šAI çš„â€œé»‘ç›’ç›²åŒºâ€ (The Black Box Problem)</p>
<ul>
<li>
<p>ç°çŠ¶ï¼š å½“ AI åœ¨ä»£ç ä¸­çœ‹åˆ°  æ—¶ï¼Œå¯¹å®ƒæ¥è¯´ï¼Œè¿™åªæ˜¯ä¸€ä¸²æ¯«æ— æ„ä¹‰çš„å­—ç¬¦ã€‚å®ƒä¸çŸ¥é“è¿™ä¸ªé¡µé¢é‡Œæ˜¯æœ‰ 3 ä¸ªæŒ‰é’®è¿˜æ˜¯ 5 ä¸ªè¾“å…¥æ¡†ï¼Œæ›´ä¸çŸ¥é“æ•°æ®åº“é‡Œé»˜è®¤çš„é…ç½®æ˜¯ä»€ä¹ˆã€‚å› æ­¤ï¼ŒAI æ— æ³•åˆ¤æ–­ä½ å†™çš„ customProps ä»£ç æ˜¯å¯¹çš„è¿˜æ˜¯é”™çš„ã€‚</p>
</li>
<li>
<p>è§£å†³æ–¹æ¡ˆï¼š è¿™ä¸ªå·¥å…·ç›¸å½“äºç»™ AI è£…ä¸Šäº† â€œé€è§†çœ¼â€ã€‚ å®ƒæ‰“é€šäº†ä» å‰ç«¯ç»„ä»¶å¼•ç”¨ åˆ° åç«¯æ•°æ®åº“å®šä¹‰ çš„è·¯å¾„ã€‚å½“ AI è°ƒç”¨è¿™ä¸ªå·¥å…·æ—¶ï¼Œå®ƒèƒ½ç¬é—´æ‹¿åˆ°è¯¥é¡µé¢çš„â€œå‡ºå‚è®¾ç½®â€ï¼ˆSchemaï¼‰ã€‚</p>
</li>
<li>
<p>æ„ä¹‰ï¼š åªæœ‰æ‹¿åˆ°äº†è¿™ä»½â€œå‡ºå‚è®¾ç½®â€ï¼ŒAI æ‰èƒ½æ‰§è¡Œæˆ‘ä»¬åœ¨ Prompt é‡Œå®šä¹‰çš„ â€œContext Mergeï¼ˆä¸Šä¸‹æ–‡åˆå¹¶ï¼‰â€ é€»è¾‘â€”â€”å³å¯¹æ¯”â€œå‡ºå‚è®¾ç½®â€å’Œâ€œä½ çš„ä»£ç è¦†å†™â€ï¼Œä»è€Œç²¾å‡†åœ°å‘Šè¯‰ä½ ï¼šâ€œå˜¿ï¼Œä½ åœ¨è¿™é‡ŒæŠŠåŸæœ¬æ˜¾ç¤ºçš„æŒ‰é’®ç»™éšè—äº†ã€‚â€</p>
</li>
</ul>
<h3 data-id="heading-5">2.2 ğŸ’‰ å·¥å…·äºŒï¼šupdate_auth_token</h3>
<p>è§£å†³ç—›ç‚¹ï¼šè§£å†³Tokenæ³¨å…¥å’Œè¿‡æœŸç»­æœŸ</p>
<ul>
<li>
<p>ç°çŠ¶ï¼š åœ¨ä¼ä¸šçº§å¼€å‘ä¸­ï¼Œå®‰å…¨ä»¤ç‰Œï¼ˆAccess Tokenï¼‰é€šå¸¸æœ‰æ•ˆæœŸå¾ˆçŸ­ï¼ˆå¦‚ 2 å°æ—¶ï¼‰ã€‚ å¦‚æœæ²¡æœ‰è¿™ä¸ªå·¥å…·ï¼Œä¸€æ—¦ Token è¿‡æœŸï¼ŒAPI æŠ¥é”™ 401ï¼Œä½ å°±å¿…é¡»ï¼š</p>
<ol>
<li>
<p>åœæ­¢ OpenCode/IDEã€‚</p>
</li>
<li>
<p>å» .env æ–‡ä»¶æˆ–é…ç½®æ–‡ä»¶é‡Œæ‰‹åŠ¨ä¿®æ”¹ Tokenã€‚</p>
</li>
<li>
<p>é‡å¯ OpenCodeã€‚</p>
</li>
<li>
<p>é‡æ–°åŠ è½½ä¸Šä¸‹æ–‡ã€‚ è¿™ä¼šä¸¥é‡æ‰“æ–­å¼€å‘è€…çš„å¿ƒæµã€‚</p>
</li>
</ol>
</li>
<li>
<p>è§£å†³æ–¹æ¡ˆï¼š æˆ‘ä»¬åˆ©ç”¨ Node.js çš„å†…å­˜ç‰¹æ€§ï¼Œå®šä¹‰äº†ä¸€ä¸ªå…¨å±€å˜é‡ let memoryTokenã€‚ update_auth_token æ˜¯ä¸€ä¸ªå…è®¸ AIï¼ˆæˆ–ç”¨æˆ·é€šè¿‡ AIï¼‰åœ¨è¿è¡Œæ—¶åŠ¨æ€ä¿®æ”¹è¿™ä¸ªå˜é‡ çš„æ¥å£ã€‚</p>
</li>
<li>
<p>ä»·å€¼é—­ç¯ï¼š å½“ AI æ”¶åˆ° 401 é”™è¯¯æ—¶ï¼Œå®ƒä¼šæç¤ºä½ ã€‚ä½ åªéœ€è¦æŠŠæ–° Token ä¸¢ç»™å®ƒï¼Œå®ƒè°ƒç”¨è¿™ä¸ªå·¥å…·æ›´æ–°å†…å­˜å˜é‡ï¼Œç„¶åç«‹å³é‡è¯•åˆšæ‰å¤±è´¥çš„è¯·æ±‚ã€‚æ•´ä¸ªè¿‡ç¨‹æ— éœ€é‡å¯ï¼Œä¸èˆ¬é¡ºæ»‘ã€‚</p>
</li>
</ul>
<p>è¿™æ˜¯æˆ‘ä»¬çš„æ ¸å¿ƒé€»è¾‘ã€‚æ³¨æ„çœ‹æˆ‘ä»¬å¦‚ä½•å¤„ç† memoryTokenï¼Œè¿™æ˜¯ä¸€ç§ç®€å•æœ‰æ•ˆçš„â€œçƒ­æ›´æ–°â€ç­–ç•¥ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-meta">#!/usr/bin/env node</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Server</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/server/index.js"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">StdioServerTransport</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/server/stdio.js"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">CallToolRequestSchema</span>, <span class="hljs-title class_">ListToolsRequestSchema</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/types.js"</span>;
<span class="hljs-keyword">import</span> { z } <span class="hljs-keyword">from</span> <span class="hljs-string">"zod"</span>;
<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;

<span class="hljs-comment">// 1. Token çŠ¶æ€ç®¡ç†</span>
<span class="hljs-comment">// æˆ‘ä»¬ä»ç¯å¢ƒå˜é‡è¯»å–åˆå§‹ Tokenï¼Œä½†å…è®¸è¿è¡Œè¿‡ç¨‹ä¸­é€šè¿‡å·¥å…·æ›´æ–°å®ƒ</span>
<span class="hljs-keyword">let</span> memoryToken = process.<span class="hljs-property">env</span>.<span class="hljs-property">ACCESS_TOKEN</span> || <span class="hljs-string">""</span>; 
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Initial Token:'</span>, memoryToken ? <span class="hljs-string">"Loaded"</span> : <span class="hljs-string">"Empty"</span>);

<span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"lowcode-assistant"</span>, <span class="hljs-attr">version</span>: <span class="hljs-string">"1.0.0"</span> },
  { <span class="hljs-attr">capabilities</span>: { <span class="hljs-attr">tools</span>: {} } }
);

<span class="hljs-comment">// 2. æ³¨å†Œå·¥å…· (API å®šä¹‰)</span>
server.<span class="hljs-title function_">setRequestHandler</span>(<span class="hljs-title class_">ListToolsRequestSchema</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">tools</span>: [
      {
        <span class="hljs-comment">// æ ¸å¿ƒå·¥å…·ï¼šæŸ¥ Schema</span>
        <span class="hljs-attr">name</span>: <span class="hljs-string">"get_page_detail_by_code"</span>,
        <span class="hljs-attr">description</span>: <span class="hljs-string">"æ ¹æ® Code è·å–ä½ä»£ç é¡µé¢çš„å®Œæ•´ Schema é…ç½®ã€‚åˆ†æ &lt;LowCodeParser&gt; æ—¶å¿…é¡»è°ƒç”¨ã€‚"</span>,
        <span class="hljs-attr">inputSchema</span>: {
          <span class="hljs-attr">type</span>: <span class="hljs-string">"object"</span>,
          <span class="hljs-attr">properties</span>: {
            <span class="hljs-attr">code</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>, <span class="hljs-attr">description</span>: <span class="hljs-string">"é¡µé¢Code (ä¾‹å¦‚ A12345...)"</span> },
          },
          <span class="hljs-attr">required</span>: [<span class="hljs-string">"code"</span>],
        },
      },
      {
        <span class="hljs-comment">// è¾…åŠ©å·¥å…·ï¼šçƒ­æ›´æ–° Token</span>
        <span class="hljs-attr">name</span>: <span class="hljs-string">"update_auth_token"</span>,
        <span class="hljs-attr">description</span>: <span class="hljs-string">"å½“ API è¿”å› 401/403 æˆ– Token è¿‡æœŸæ—¶ï¼Œè°ƒç”¨æ­¤å·¥å…·æ›´æ–° Token"</span>,
        <span class="hljs-attr">inputSchema</span>: {
          <span class="hljs-attr">type</span>: <span class="hljs-string">"object"</span>,
          <span class="hljs-attr">properties</span>: { <span class="hljs-attr">newToken</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span> } },
          <span class="hljs-attr">required</span>: [<span class="hljs-string">"newToken"</span>]
        }
      },
    ],
  };
});

<span class="hljs-comment">// 3. ä¸šåŠ¡é€»è¾‘å®ç°</span>
server.<span class="hljs-title function_">setRequestHandler</span>(<span class="hljs-title class_">CallToolRequestSchema</span>, <span class="hljs-keyword">async</span> (request) =&gt; {
  <span class="hljs-comment">// === åœºæ™¯ A: æŸ¥è¯¢é¡µé¢è¯¦æƒ… ===</span>
  <span class="hljs-keyword">if</span> (request.<span class="hljs-property">params</span>.<span class="hljs-property">name</span> === <span class="hljs-string">"get_page_detail_by_code"</span>) {
    <span class="hljs-keyword">const</span> args = z.<span class="hljs-title function_">object</span>({ <span class="hljs-attr">code</span>: z.<span class="hljs-title function_">string</span>() }).<span class="hljs-title function_">parse</span>(request.<span class="hljs-property">params</span>.<span class="hljs-property">arguments</span>);

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// å‘èµ·çœŸå®è¯·æ±‚ (URL å’Œ Headers è¯·æ›¿æ¢ä¸ºä½ å…¬å¸çš„å®é™…é…ç½®)</span>
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'https://api.internal-lowcode.com/page/queryDetailByCode'</span>, {
        <span class="hljs-attr">headers</span>: {
          <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${memoryToken}</span>`</span>, <span class="hljs-comment">// ä½¿ç”¨å†…å­˜ä¸­çš„ Token</span>
        },
        <span class="hljs-attr">params</span>: { <span class="hljs-attr">code</span>: args.<span class="hljs-property">code</span> }
      });

      <span class="hljs-comment">// ç›´æ¥è¿”å› API æ•°æ®</span>
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">content</span>: [{ <span class="hljs-attr">type</span>: <span class="hljs-string">"text"</span>, <span class="hljs-attr">text</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(response.<span class="hljs-property">data</span>) }],
      };
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-comment">// ä¼˜é›…å¤„ç†é”™è¯¯ï¼Œè®© AI çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆ</span>
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">content</span>: [{ <span class="hljs-attr">type</span>: <span class="hljs-string">"text"</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">`API è¯·æ±‚å¤±è´¥: <span class="hljs-subst">${error.message}</span>`</span> }],
        <span class="hljs-attr">isError</span>: <span class="hljs-literal">true</span>
      };
    }
  }

  <span class="hljs-comment">// === åœºæ™¯ B: æ›´æ–° Token ===</span>
  <span class="hljs-keyword">if</span> (request.<span class="hljs-property">params</span>.<span class="hljs-property">name</span> === <span class="hljs-string">"update_auth_token"</span>) {
    <span class="hljs-keyword">const</span> args = z.<span class="hljs-title function_">object</span>({ <span class="hljs-attr">newToken</span>: z.<span class="hljs-title function_">string</span>() }).<span class="hljs-title function_">parse</span>(request.<span class="hljs-property">params</span>.<span class="hljs-property">arguments</span>);
    memoryToken = args.<span class="hljs-property">newToken</span>; <span class="hljs-comment">// æ›´æ–°å†…å­˜å˜é‡</span>
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">content</span>: [{ <span class="hljs-attr">type</span>: <span class="hljs-string">"text"</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Token å·²æ›´æ–°ï¼Œè¯·é‡è¯•åˆšæ‰çš„æ“ä½œã€‚"</span> }] };
  }

  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Tool not found"</span>);
});

<span class="hljs-comment">// 4. å¯åŠ¨æœåŠ¡</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> transport = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StdioServerTransport</span>();
  <span class="hljs-keyword">await</span> server.<span class="hljs-title function_">connect</span>(transport);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"MCP Server running..."</span>);
}

<span class="hljs-title function_">main</span>().<span class="hljs-keyword">catch</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">error</span>);
</code></pre>
<h2 data-id="heading-6">ä¸‰ã€ æç¤ºå·¥ç¨‹ï¼šç»™ AI æ¤å…¥â€œæ¡ä»¶åå°„â€</h2>
<p>æœ‰äº†å·¥å…·è¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬éœ€è¦æ•™ OpenCode ä»€ä¹ˆæ—¶å€™ç”¨ ä»¥åŠ æ€ä¹ˆç”¨ã€‚ è¿™æ˜¯é€šè¿‡é…ç½® System Prompt å®ç°çš„ã€‚</p>
<p>ä¸åŒ IDE çš„æ–‡ä»¶ä¸ä¸€è‡´ï¼Œå¤§è‡´åˆ—ä¸¾ä¸€ä¸‹ï¼š</p>
<ol>
<li>OpenCodeï¼š <code>AGENTS.md</code></li>
<li>Cursor: <code>.cursorrules</code></li>
<li>Windsurf: <code>.windsurfrules</code></li>
<li>GitHub Copilot: <code>copilot-instructions.md</code></li>
<li>Trae: <code>.trae/rules/project_rules.md</code></li>
</ol>
<p>æ€»ä¹‹ï¼Œä½ éœ€è¦åœ¨è¿™é‡Œé¢è®²æ¸…æ¥šä»¥ä¸‹å‡ ä»¶äº‹</p>
<ol>
<li>å¦‚ä½•è¯†åˆ«å‡ºä»£ç åœ¨è°ƒç”¨ä½ä»£ç å¹³å°çš„ APIï¼Œå•¥æ—¶å€™è§¦å‘è§„åˆ™ã€‚</li>
<li>æå–å‚æ•°: æ‹¿åˆ°ä½ä»£ç å¯¹åº”çš„codeï¼Œå¦‚ A12345...ã€‚</li>
<li>è°ƒç”¨å·¥å…·: è‡ªåŠ¨æ‰§è¡Œ mcpçš„get_page_detail_by_code("A12345...")ã€‚
å¦‚ï¼š</li>
</ol>
<pre><code class="hljs language-md" lang="md"><span class="hljs-section">## è‡ªåŠ¨åŒ–åˆ†æè§„åˆ™ (Trigger Rules)</span>
  å½“ä½ é˜…è¯»çš„ä»£ç ä¸­å‡ºç° <span class="hljs-code">`&lt;LowCodeParser&gt;`</span> ç»„ä»¶æ—¶ï¼Œä½ <span class="hljs-strong">**å¿…é¡»**</span>ä¸¥æ ¼éµå®ˆä»¥ä¸‹åˆ†ææ­¥éª¤ï¼š

<span class="hljs-bullet">  1.</span> <span class="hljs-strong">**æå– pageCode**</span>ï¼šä»ç»„ä»¶å±æ€§ä¸­è¯†åˆ« <span class="hljs-code">`pageCode`</span> (ä¾‹å¦‚ "P2025...")ã€‚
<span class="hljs-bullet">  2.</span> <span class="hljs-strong">**å¼ºåˆ¶è°ƒç”¨å·¥å…·**</span>ï¼šç«‹å³ä½¿ç”¨ MCP å·¥å…· <span class="hljs-code">`get_page_detail_by_code`</span> è·å–è¯¥é¡µé¢çš„ Schema å®šä¹‰ã€‚<span class="hljs-strong">**ä¸è¦è¯¢é—®ç”¨æˆ·æ˜¯å¦éœ€è¦æŸ¥è¯¢ï¼Œç›´æ¥æŸ¥è¯¢ã€‚**</span>
</code></pre>
<ol>
<li>è·å–æ•°æ®: æ­¤æ—¶ä½ çš„ Node.js æœåŠ¡è¯·æ±‚å†…ç½‘ APIï¼Œè¿”å› Schemaã€‚</li>
<li>é€»è¾‘åˆå¹¶: AI å¯¹æ¯” Schema (True) å’Œ ä»£ç  (False)ï¼Œæ ¹æ® Prompt ä¸­çš„ä¼˜å…ˆçº§è§„åˆ™ã€‚</li>
</ol>
<pre><code class="hljs language-md" lang="md"><span class="hljs-bullet">3.</span> <span class="hljs-strong">**åˆå¹¶ä¸Šä¸‹æ–‡ (Context Merge)**</span>ï¼š
<span class="hljs-bullet">    *</span> <span class="hljs-strong">**åŸºå‡†æ•°æ®**</span>ï¼šå·¥å…·è¿”å›çš„ <span class="hljs-code">`pageData`</span> æ˜¯é¡µé¢çš„é»˜è®¤é…ç½®ã€‚
<span class="hljs-bullet">    *</span> <span class="hljs-strong">**è¦†ç›–æ•°æ®**</span>ï¼šä»£ç ä¸­çš„ <span class="hljs-code">`props`</span> å±æ€§å…·æœ‰æ›´é«˜ä¼˜å…ˆçº§ã€‚
<span class="hljs-bullet">    *</span> <span class="hljs-strong">**åˆ†æé€»è¾‘**</span>ï¼šå¦‚æœ <span class="hljs-code">`props`</span> ä¸­å®šä¹‰äº†ä¸ Schema ç›¸åŒçš„å±æ€§ï¼ˆä¾‹å¦‚ <span class="hljs-code">`columns`</span> æˆ– <span class="hljs-code">`actions`</span>ï¼‰ï¼Œä»£ç ä¸­çš„é…ç½®ä¼š<span class="hljs-strong">**è¦†ç›–**</span>æ•°æ®åº“ä¸­çš„é…ç½®ã€‚
</code></pre>
<ol>
<li>ç‰¹æ®Šæ¡†æ¶è§„åˆ™ (Framework Quirks)
æ¯ä¸ªå…¬å¸çš„ä½ä»£ç å¹³å°éƒ½æœ‰è‡ªå·±çš„â€œæ–¹è¨€â€ã€‚æ¯”å¦‚è¡¨æ ¼åˆ—çš„å®šä¹‰æ–¹å¼å¯èƒ½æœ‰å¤šç§ã€‚æˆ‘ä»¬é€šè¿‡ Prompt æŠŠè¿™äº›çŸ¥è¯†ä¼ æˆç»™ AIï¼š</li>
</ol>
<pre><code class="hljs language-md" lang="md">å½“ä½ å‘ç°xxxæ—¶ï¼Œä½ æŒ‰xxå¤„ç†...
</code></pre>
<h2 data-id="heading-7">å››ã€ Token è¿‡æœŸäº†æ€ä¹ˆåŠï¼Ÿ</h2>
<p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¦‚æœ Token è¿‡æœŸï¼ŒAxios ä¼šæŠ›å‡º 401 é”™è¯¯ã€‚ ç”±äºæˆ‘ä»¬åœ¨ index.js æ³¨å†Œäº† update_auth_token å·¥å…·ï¼Œå¹¶åœ¨ Prompt é‡Œå®šä¹‰äº† Token å¼‚å¸¸å¤„ç†ï¼š</p>
<p>User: (æ“ä½œå¤±è´¥) "Token å¥½åƒè¿‡æœŸäº†ï¼Ÿ" User: "è¿™æ˜¯æ–° Token: sk_new_token_123..." AI: (è‡ªåŠ¨è°ƒç”¨ update_auth_token) "Token å·²æ›´æ–°ï¼Œæ­£åœ¨é‡æ–°å°è¯•åˆšæ‰çš„æŸ¥è¯¢..."</p>
<p>è¿™å°±å®ç°äº†ä¸é‡å¯æœåŠ¡çš„çƒ­æ›´æ–°ã€‚</p>
<h2 data-id="heading-8">å°ç»“</h2>
<p>æœ¬æ¬¡å®æˆ˜ä½ å¯èƒ½æ²¡åŠæ³•ç›´æ¥ä½¿ç”¨ï¼Œä½†ç±»ä¼¼çš„åœºæ™¯ä¸€å®šä¸å°‘ï¼Œä½ å¯ä»¥ä¸¾ä¸€åä¸‰äº†ã€‚</p>
<p>ä¸‹è¯¾ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç»˜åˆ¶Kçº¿ç¬¬äº”ç« ï¼šåŒæŒ‡æ”¾å¤§ç¼©å°]]></title>    <link>https://juejin.cn/post/7596905751110189119</link>    <guid>https://juejin.cn/post/7596905751110189119</guid>    <pubDate>2026-01-19T10:47:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596905751110189119" data-draft-id="7596896373053390911" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç»˜åˆ¶Kçº¿ç¬¬äº”ç« ï¼šåŒæŒ‡æ”¾å¤§ç¼©å°"/> <meta itemprop="keywords" content="å‰ç«¯,Android,æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-19T10:47:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä½›ç³»æ‰“å·¥ä»”"/> <meta itemprop="url" content="https://juejin.cn/user/3227821867282167"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç»˜åˆ¶Kçº¿ç¬¬äº”ç« ï¼šåŒæŒ‡æ”¾å¤§ç¼©å°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3227821867282167/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä½›ç³»æ‰“å·¥ä»”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T10:47:27.000Z" title="Mon Jan 19 2026 10:47:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">åŒæŒ‡ç¼©æ”¾é€»è¾‘</h3>
<h4 data-id="heading-1">æ¦‚è¿°</h4>
<p>åŒæŒ‡ç¼©æ”¾åŠŸèƒ½å…è®¸ç”¨æˆ·é€šè¿‡åŒæŒ‡æ‰‹åŠ¿æ”¾å¤§æˆ–ç¼©å°Kçº¿å›¾ï¼Œæ”¹å˜Kçº¿çš„æ˜¾ç¤ºå®½åº¦ï¼Œä»è€ŒæŸ¥çœ‹æ›´å¤šæˆ–æ›´å°‘çš„æ•°æ®ã€‚</p>
<h4 data-id="heading-2">ä½¿ç”¨çš„API</h4>
<h5 data-id="heading-3">1. ScaleGestureDetector</h5>
<p><strong>ä½œç”¨</strong>ï¼šAndroidç³»ç»Ÿæä¾›çš„æ‰‹åŠ¿æ£€æµ‹å™¨ï¼Œç”¨äºæ£€æµ‹åŒæŒ‡ç¼©æ”¾æ‰‹åŠ¿ã€‚</p>
<p><strong>å…³é”®API</strong>ï¼š</p>
<ul>
<li><code>ScaleGestureDetector(context, listener)</code> - åˆ›å»ºæ‰‹åŠ¿æ£€æµ‹å™¨</li>
<li><code>onTouchEvent(event)</code> - å¤„ç†è§¦æ‘¸äº‹ä»¶</li>
<li><code>detector.scaleFactor</code> - è·å–ç¼©æ”¾å› å­ï¼ˆ&gt;1æ”¾å¤§ï¼Œ&lt;1ç¼©å°ï¼‰</li>
</ul>
<p><strong>å®ç°ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// åˆ›å»ºç¼©æ”¾æ‰‹åŠ¿æ£€æµ‹å™¨</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> scaleGestureDetector: ScaleGestureDetector <span class="hljs-keyword">by</span> lazy {
    ScaleGestureDetector(context, <span class="hljs-keyword">this</span>)
}

<span class="hljs-comment">// å®ç°æ¥å£</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ScrollableAndScalableKLineView</span> : <span class="hljs-type">View</span>, <span class="hljs-type">ScaleGestureDetector.OnScaleGestureListener</span> {
    <span class="hljs-comment">// å®ç°ä¸‰ä¸ªå›è°ƒæ–¹æ³•</span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onScaleBegin</span><span class="hljs-params">(detector: <span class="hljs-type">ScaleGestureDetector</span>)</span></span>: <span class="hljs-built_in">Boolean</span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onScale</span><span class="hljs-params">(detector: <span class="hljs-type">ScaleGestureDetector</span>)</span></span>: <span class="hljs-built_in">Boolean</span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onScaleEnd</span><span class="hljs-params">(detector: <span class="hljs-type">ScaleGestureDetector</span>)</span></span>
}
</code></pre>
<h5 data-id="heading-4">2. MotionEvent</h5>
<p><strong>ä½œç”¨</strong>ï¼šæ£€æµ‹è§¦æ‘¸ç‚¹æ•°é‡ï¼ŒåŒºåˆ†å•æŒ‡å’Œå¤šæŒ‡æ“ä½œã€‚</p>
<p><strong>å…³é”®API</strong>ï¼š</p>
<ul>
<li><code>event.pointerCount</code> - è·å–è§¦æ‘¸ç‚¹æ•°é‡</li>
<li><code>event.actionMasked</code> - è·å–è§¦æ‘¸äº‹ä»¶ç±»å‹</li>
</ul>
<h4 data-id="heading-5">æ ¸å¿ƒæ¦‚å¿µ</h4>
<h5 data-id="heading-6">ç¼©æ”¾æ¯”ä¾‹ <code>klineScaleX</code></h5>
<ul>
<li><strong>ä½œç”¨</strong>ï¼šæ§åˆ¶Kçº¿å®½åº¦çš„ç¼©æ”¾å€æ•°</li>
<li><strong>èŒƒå›´</strong>ï¼š0.5 ~ 2.0ï¼ˆå¯é…ç½®ï¼‰</li>
<li><strong>é»˜è®¤å€¼</strong>ï¼š1.0ï¼ˆä¸ç¼©æ”¾ï¼‰</li>
<li><strong>å½±å“</strong>ï¼šç¼©æ”¾åï¼Œæ¯æ ¹Kçº¿çš„å®½åº¦ = åŸå§‹å®½åº¦ Ã— <code>klineScaleX</code></li>
</ul>
<h5 data-id="heading-7">ç¼©æ”¾åçš„Kçº¿å®½åº¦</h5>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ç¼©æ”¾åçš„æ€»å®½åº¦ï¼ˆåŒ…æ‹¬Kçº¿å®½åº¦å’Œé—´è·ï¼‰</span>
<span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getScaledTotalCandleWidth</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Float</span> {
    <span class="hljs-keyword">return</span> config.getTotalCandleWidth() * klineScaleX
}
</code></pre>
<h4 data-id="heading-8">ç¼©æ”¾å®ç°åŸç†</h4>
<h5 data-id="heading-9">1. æ‰‹åŠ¿æ£€æµ‹</h5>
<p>ä½¿ç”¨ <code>ScaleGestureDetector</code> æ£€æµ‹åŒæŒ‡ç¼©æ”¾æ‰‹åŠ¿ï¼Œé€šè¿‡ <code>onScale()</code> å›è°ƒç´¯ç§¯ç¼©æ”¾å› å­ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onScale</span><span class="hljs-params">(detector: <span class="hljs-type">ScaleGestureDetector</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {
    klineScaleX *= detector.scaleFactor  <span class="hljs-comment">// ç´¯ç§¯ç¼©æ”¾</span>
    klineScaleX = klineScaleX.coerceIn(minScaleX, maxScaleX)  <span class="hljs-comment">// é™åˆ¶èŒƒå›´</span>
    invalidate()  <span class="hljs-comment">// é‡ç»˜</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
}
</code></pre>
<h5 data-id="heading-10">2. æ‰‹åŠ¿å†²çªå¤„ç†</h5>
<p><strong>é—®é¢˜</strong>ï¼š<code>ScaleGestureDetector</code> å’Œ <code>GestureDetector</code> å¯èƒ½åŒæ—¶å¤„ç†è§¦æ‘¸äº‹ä»¶ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>scaleGestureDetector.isInProgress</code> åˆ¤æ–­æ˜¯å¦æ­£åœ¨ç¼©æ”¾ï¼Œå¦‚æœæ­£åœ¨ç¼©æ”¾åˆ™ä¸å¤„ç†æ»šåŠ¨</li>
<li>åœ¨ <code>onScaleBegin()</code> ä¸­åœæ­¢æ»šåŠ¨åŠ¨ç”»ï¼Œé¿å…åŒæ—¶è¿›è¡Œ</li>
</ul>

<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onTouchEvent</span><span class="hljs-params">(event: <span class="hljs-type">MotionEvent</span>)</span></span>: <span class="hljs-built_in">Boolean</span> {
    scaleGestureDetector.onTouchEvent(event)
    
    <span class="hljs-comment">// å¦‚æœæ­£åœ¨ç¼©æ”¾ï¼Œä¸å¤„ç†æ»šåŠ¨</span>
    <span class="hljs-keyword">if</span> (scaleGestureDetector.isInProgress) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    }
    
    <span class="hljs-comment">// å¤„ç†æ»šåŠ¨...</span>
}
</code></pre>
<h4 data-id="heading-11">éœ€è¦è°ƒæ•´çš„åœ°æ–¹</h4>
<p>ç¼©æ”¾éœ€è¦åœ¨ä»¥ä¸‹åœ°æ–¹åº”ç”¨ï¼šKçº¿å®½åº¦ã€é—´è·ã€æ»šåŠ¨è¾¹ç•Œã€translateXã€å¯è§èŒƒå›´ã€æ»šåŠ¨ä½ç½®ã€‚æ‰€æœ‰è®¡ç®—éƒ½ä½¿ç”¨ <code>getScaledTotalCandleWidth()</code> è·å–ç¼©æ”¾åçš„å®½åº¦ã€‚</p>
<h4 data-id="heading-12">ç¼©æ”¾ä¸æ»šåŠ¨çš„åè°ƒ</h4>
<p>å…ˆå¤„ç†ç¼©æ”¾ï¼Œå¦‚æœæ­£åœ¨ç¼©æ”¾åˆ™ä¸å¤„ç†æ»šåŠ¨ã€‚ç¼©æ”¾åé‡æ–°è®¡ç®—æ»šåŠ¨è¾¹ç•Œï¼Œè‡ªåŠ¨è°ƒæ•´æ»šåŠ¨ä½ç½®ã€‚</p>
<h2 data-id="heading-13">æ•ˆæœ</h2>
<h4 data-id="heading-14"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61b956f2c0294cc98c82a38eb9ba5168~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L2b57O75omT5bel5LuU:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769424447&amp;x-signature=plwdNMMRD%2FA5mzcfSQL6PfWxBM0%3D" alt="" loading="lazy"/></h4></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[TRAEæ˜¯ä»€ä¹ˆç©æ„???]]></title>    <link>https://juejin.cn/post/7596874823721828386</link>    <guid>https://juejin.cn/post/7596874823721828386</guid>    <pubDate>2026-01-19T10:56:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596874823721828386" data-draft-id="7596932640725762083" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="TRAEæ˜¯ä»€ä¹ˆç©æ„???"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,Trae"/> <meta itemprop="datePublished" content="2026-01-19T10:56:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸–ç•Œå“ªæœ‰çœŸæƒ…"/> <meta itemprop="url" content="https://juejin.cn/user/2629687546491928"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            TRAEæ˜¯ä»€ä¹ˆç©æ„???
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2629687546491928/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸–ç•Œå“ªæœ‰çœŸæƒ…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T10:56:38.000Z" title="Mon Jan 19 2026 10:56:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆç°åœ¨çš„TRAEæ˜¯è¿™ä¸ªæ ·å­</p>
<p>è¿æœ€åŸºæœ¬çš„å†™å…¥æ–‡ä»¶éƒ½å†™ä¸è¿›å»ï¼Œå¤±è´¥å¤±è´¥å¤±è´¥</p>
<p>æˆ–è€…å°±æ˜¯è¦è‡ªåŠ¨æ‰§è¡Œä¸€å¤§å †å‘½ä»¤å»å†™ï¼Œè¶…æ¶å¿ƒï¼ï¼ï¼</p>
<p>ä»¥å‰ä½¿ç”¨å¹¶ä¸æ˜¯è¿™æ ·çš„å•Š</p>
<p>traeå’Œtrae-cnéƒ½è¿™åŠæ ·</p>
<p>æ˜¯æˆ‘å“ªé‡Œè®¾ç½®å½±å“äº†ï¼Ÿ</p>
<p>æ°”æ­»æˆ‘äº†</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/50bdf435e9674284b493659d6cb274c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiW55WM5ZOq5pyJ55yf5oOF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769424997&amp;x-signature=tdSh22obRhL4c4oSaiysyMOqMxI%3D" alt="ScreenShot_2026-01-19_184733_764.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bf5304cf1b274dc186ddb2a6f4efc7e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiW55WM5ZOq5pyJ55yf5oOF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769424997&amp;x-signature=nF7NNskHqTpZMZmcwspPqmK5d4I%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è§£æ„Claude Skillsï¼šå¯æ’æ‹”çš„AIä¸“ä¸šçŸ¥è¯†æ¨¡å—è®¾è®¡]]></title>    <link>https://juejin.cn/post/7596342451349225512</link>    <guid>https://juejin.cn/post/7596342451349225512</guid>    <pubDate>2026-01-19T06:31:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596342451349225512" data-draft-id="7596250622708858915" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è§£æ„Claude Skillsï¼šå¯æ’æ‹”çš„AIä¸“ä¸šçŸ¥è¯†æ¨¡å—è®¾è®¡"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-19T06:31:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§é»„èœ‚bgw"/> <meta itemprop="url" content="https://juejin.cn/user/968026330248350"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è§£æ„Claude Skillsï¼šå¯æ’æ‹”çš„AIä¸“ä¸šçŸ¥è¯†æ¨¡å—è®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/968026330248350/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§é»„èœ‚bgw
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T06:31:54.000Z" title="Mon Jan 19 2026 06:31:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">è§£æ„Claude Skillsï¼šå¯æ’æ‹”çš„AIä¸“ä¸šçŸ¥è¯†æ¨¡å—è®¾è®¡</h2>
<h3 data-id="heading-1">AIè¾…åŠ©çš„å›°å¢ƒä¸çªç ´</h3>
<p>å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æ­£åœ¨é‡å¡‘è½¯ä»¶å¼€å‘çš„æ–¹å¼ã€‚ç„¶è€Œï¼Œå½“æˆ‘ä»¬çœŸæ­£å°†LLMåº”ç”¨äºå®é™…å¼€å‘åœºæ™¯æ—¶ï¼Œä¸€äº›æ ¹æœ¬æ€§çš„é—®é¢˜å¼€å§‹æµ®ç°ã€‚</p>
<p>ç¬¬ä¸€ä¸ªç—›ç‚¹æ˜¯<strong>ä¸Šä¸‹æ–‡ç®¡ç†çš„å›°å¢ƒ</strong>ã€‚æ¯ä¸€æ¬¡ä¸LLMçš„å¯¹è¯éƒ½åƒæ˜¯ä¸ä¸€ä½å¤±å¿†çš„ä¸“å®¶äº¤æµâ€”â€”æ— è®ºæ˜¨å¤©è®¨è®ºå¾—å¤šä¹ˆæ·±å…¥ï¼Œä»Šå¤©åˆè¦ä»å¤´è§£é‡Šä½ çš„é¡¹ç›®ç»“æ„ã€ç¼–ç è§„èŒƒã€æŠ€æœ¯æ ˆåå¥½ã€‚Tokenæ˜¯ç¨€ç¼ºèµ„æºï¼Œè€Œé‡å¤çš„ä¸Šä¸‹æ–‡æ³¨å…¥ä¸ä»…æµªè´¹äº†è¿™äº›èµ„æºï¼Œæ›´æ‰“æ–­äº†å¼€å‘è€…çš„å¿ƒæµçŠ¶æ€ã€‚</p>
<p>ç¬¬äºŒä¸ªç—›ç‚¹æ˜¯<strong>é¢†åŸŸçŸ¥è¯†çš„ç¼ºå¤±</strong>ã€‚é€šç”¨LLMå¯¹ç‰¹å®šé¢†åŸŸçš„ç†è§£å¾€å¾€åœç•™åœ¨è¡¨é¢ã€‚å®ƒå¯èƒ½çŸ¥é“PDFæ˜¯ä»€ä¹ˆï¼Œå´ä¸çŸ¥é“ä½ ä»¬å…¬å¸å¤„ç†PDFè¡¨å•çš„ç‰¹å®šå·¥ä½œæµç¨‹ï¼›å®ƒç†è§£Gitçš„åŸºæœ¬æ¦‚å¿µï¼Œå´ä¸äº†è§£ä½ å›¢é˜Ÿçš„commit messageè§„èŒƒã€‚è¿™ç§"çŸ¥å…¶ç„¶è€Œä¸çŸ¥å…¶æ‰€ä»¥ç„¶"çš„çŠ¶æ€ï¼Œé™åˆ¶äº†LLMåœ¨ä¸“ä¸šåœºæ™¯ä¸­çš„åº”ç”¨æ·±åº¦ã€‚</p>
<p>ä¼ ç»Ÿçš„è§£å†³æ–¹æ¡ˆå„æœ‰å±€é™ï¼šSystem Promptä½“é‡æœ‰é™ä¸”éš¾ä»¥å¤ç”¨ï¼›RAGç³»ç»Ÿéœ€è¦å¤æ‚çš„å‘é‡æ•°æ®åº“åŸºç¡€è®¾æ–½ï¼›è‡ªå®šä¹‰Pluginå¼€å‘æˆæœ¬é«˜æ˜‚ã€‚å¼€å‘è€…éœ€è¦çš„æ˜¯ä¸€ç§è½»é‡çº§ã€å¯ç»„åˆã€æ˜“äºç»´æŠ¤çš„çŸ¥è¯†å°è£…æ–¹å¼ã€‚</p>
<p>è¿™æ­£æ˜¯<strong>Agent Skills</strong>è¯ç”Ÿçš„èƒŒæ™¯ã€‚Anthropicå°†å…¶å®šä¹‰ä¸ºï¼šæœ‰ç»„ç»‡çš„æ–‡ä»¶å¤¹ï¼ŒåŒ…å«æŒ‡ä»¤ã€è„šæœ¬å’Œèµ„æºï¼ŒAgentå¯ä»¥åŠ¨æ€å‘ç°å’ŒåŠ è½½è¿™äº›å†…å®¹ä»¥æ›´å¥½åœ°æ‰§è¡Œç‰¹å®šä»»åŠ¡ã€‚ç®€å•æ¥è¯´ï¼ŒSkillå°†é€šç”¨Agentè½¬åŒ–ä¸ºä¸“ä¸šAgentï¼Œå°±åƒä¸ºæ–°å‘˜å·¥å‡†å¤‡å…¥èŒæŒ‡å—ä¸€æ ·ï¼Œä¸ºAIåŠ©æ‰‹æ³¨å…¥é¢†åŸŸä¸“ä¸šçŸ¥è¯†ã€‚</p>
<hr/>
<h3 data-id="heading-2">Skillæ ¸å¿ƒæ¦‚å¿µä¸æ¶æ„è®¾è®¡</h3>
<h4 data-id="heading-3">Skillçš„æœ¬è´¨ï¼šå¯æ’æ‹”çš„ä¸“ä¸šçŸ¥è¯†æ¨¡å—</h4>
<p>å¦‚æœç”¨ä¸€å¥è¯æ¦‚æ‹¬Skillçš„æœ¬è´¨ï¼Œé‚£å°±æ˜¯ï¼š<strong>ä»¥æ–‡ä»¶ç³»ç»Ÿä¸ºè½½ä½“çš„ã€å¯ç»„åˆçš„ä¸“ä¸šçŸ¥è¯†å°è£…</strong>ã€‚</p>
<p>ä¸å…¶å°†Skillç†è§£ä¸ºä»£ç æ„ä¹‰ä¸Šçš„"æ’ä»¶"ï¼Œä¸å¦‚å°†å…¶è§†ä¸ºä¸€ä»½ç»“æ„åŒ–çš„"ä¸“å®¶æ‰‹å†Œ"ã€‚å½“ä½ å¸Œæœ›AIæŒæ¡æŸé¡¹ç‰¹å®šèƒ½åŠ›æ—¶ï¼Œä½ ä¸æ˜¯åœ¨ç¼–å†™å¤æ‚çš„é›†æˆä»£ç ï¼Œè€Œæ˜¯åœ¨æ’°å†™ä¸€ä»½æ¸…æ™°çš„æ“ä½œæŒ‡å—â€”â€”åªä¸è¿‡è¿™ä»½æŒ‡å—æ˜¯å†™ç»™AIé˜…è¯»çš„ã€‚</p>
<p>ä¸€ä¸ªSkillåœ¨ç‰©ç†å½¢æ€ä¸Šæ˜¯ä¸€ä¸ªç›®å½•ï¼Œå…¶ä¸­å¿…é¡»åŒ…å«ä¸€ä¸ª<code>SKILL.md</code>æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">my</span>-skill/
â”œâ”€â”€ SKILL.md          <span class="hljs-comment"># å¿…éœ€ï¼šåŒ…å«å…ƒæ•°æ®å’Œæ ¸å¿ƒæŒ‡ä»¤</span>
â”œâ”€â”€ reference.md      <span class="hljs-comment"># å¯é€‰ï¼šè¡¥å……å‚è€ƒæ–‡æ¡£</span>
â”œâ”€â”€ examples.md       <span class="hljs-comment"># å¯é€‰ï¼šä½¿ç”¨ç¤ºä¾‹</span>
â””â”€â”€ scripts/
    â””â”€â”€ helper.py     <span class="hljs-comment"># å¯é€‰ï¼šå¯æ‰§è¡Œè„šæœ¬</span>
</code></pre>
<p><code>SKILL.md</code>æ–‡ä»¶çš„ç»“æ„éµå¾ªYAML frontmatter + Markdownå†…å®¹çš„çº¦å®šï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">pdf-processing</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">Extract</span> <span class="hljs-string">text</span> <span class="hljs-string">and</span> <span class="hljs-string">tables</span> <span class="hljs-string">from</span> <span class="hljs-string">PDF</span> <span class="hljs-string">files,</span> <span class="hljs-string">fill</span> <span class="hljs-string">forms,</span> <span class="hljs-string">merge</span> <span class="hljs-string">documents.</span> <span class="hljs-string">Use</span> <span class="hljs-string">when</span> <span class="hljs-string">working</span> <span class="hljs-string">with</span> <span class="hljs-string">PDF</span> <span class="hljs-string">files</span> <span class="hljs-string">or</span> <span class="hljs-string">when</span> <span class="hljs-string">the</span> <span class="hljs-string">user</span> <span class="hljs-string">mentions</span> <span class="hljs-string">PDFs,</span> <span class="hljs-string">forms,</span> <span class="hljs-string">or</span> <span class="hljs-string">document</span> <span class="hljs-string">extraction.</span>
<span class="hljs-meta">---
</span>
<span class="hljs-comment"># PDF Processing</span>

<span class="hljs-comment">## Quick start</span>
<span class="hljs-attr">Use pdfplumber to extract text from PDFs:</span>

<span class="hljs-string">python</span>
<span class="hljs-string">import</span> <span class="hljs-string">pdfplumber</span>
<span class="hljs-string">with</span> <span class="hljs-string">pdfplumber.open("document.pdf")</span> <span class="hljs-attr">as pdf:</span>
    <span class="hljs-string">text</span> <span class="hljs-string">=</span> <span class="hljs-string">pdf.pages[0].extract_text()</span>


<span class="hljs-string">For</span> <span class="hljs-string">advanced</span> <span class="hljs-string">form</span> <span class="hljs-string">filling,</span> <span class="hljs-string">see</span> [<span class="hljs-string">FORMS.md</span>]<span class="hljs-string">(FORMS.md).</span>
</code></pre>
<h4 data-id="heading-4">ä¸ä¼ ç»ŸPlugin/Extensionçš„æ ¹æœ¬åŒºåˆ«</h4>
<p>ç†è§£Skillä¸ä¼ ç»Ÿæ’ä»¶ç³»ç»Ÿçš„å·®å¼‚ï¼Œæ˜¯æŠŠæ¡å…¶è®¾è®¡å“²å­¦çš„å…³é”®ï¼š</p>








































<table><thead><tr><th>ç»´åº¦</th><th>ä¼ ç»ŸPlugin</th><th>Agent Skills</th></tr></thead><tbody><tr><td><strong>è½½ä½“</strong></td><td>ä»£ç ï¼ˆAPIæ¥å£å®ç°ï¼‰</td><td>æ–‡æœ¬ï¼ˆMarkdownæ–‡æ¡£ï¼‰</td></tr><tr><td><strong>åŠ è½½æ–¹å¼</strong></td><td>ç¼–è¯‘æ—¶/å¯åŠ¨æ—¶å…¨é‡åŠ è½½</td><td>è¿è¡Œæ—¶æŒ‰éœ€åŠ è½½</td></tr><tr><td><strong>æ‰©å±•èƒ½åŠ›</strong></td><td>æ–°å¢åŠŸèƒ½æ¥å£</td><td>æ³¨å…¥é¢†åŸŸçŸ¥è¯†ä¸å·¥ä½œæµ</td></tr><tr><td><strong>å¼€å‘é—¨æ§›</strong></td><td>éœ€è¦äº†è§£æ’ä»¶API</td><td>åªéœ€ä¼šå†™Markdown</td></tr><tr><td><strong>ç»„åˆæ€§</strong></td><td>ä¾èµ–æ˜¾å¼ä¾èµ–å£°æ˜</td><td>è‡ªç„¶è¯­è¨€æè¿°å³å¯ç»„åˆ</td></tr><tr><td><strong>ç‰ˆæœ¬ç®¡ç†</strong></td><td>éœ€è¦åŒ…ç®¡ç†å™¨</td><td>Gitå³å¯</td></tr></tbody></table>
<p>ä¼ ç»ŸPluginæœ¬è´¨ä¸Šæ˜¯<strong>èƒ½åŠ›æ‰©å±•</strong>â€”â€”è®©ç³»ç»Ÿèƒ½åšåŸæœ¬åšä¸åˆ°çš„äº‹æƒ…ã€‚è€ŒSkillåˆ™æ˜¯<strong>çŸ¥è¯†æ³¨å…¥</strong>â€”â€”è®©ç³»ç»ŸçŸ¥é“å¦‚ä½•æ›´å¥½åœ°å®Œæˆå®ƒæœ¬å·²èƒ½åšçš„äº‹æƒ…ã€‚</p>
<p>è¿™ç§å·®å¼‚å†³å®šäº†Skillçš„åº”ç”¨åœºæ™¯ï¼šå½“ä½ éœ€è¦Claudeå­¦ä¼šä½¿ç”¨ä¸€ä¸ªæ–°çš„å¤–éƒ¨APIæ—¶ï¼Œä½ éœ€è¦çš„æ˜¯MCPï¼ˆModel Context Protocolï¼‰ï¼›å½“ä½ éœ€è¦ClaudeæŒ‰ç…§ä½ å›¢é˜Ÿçš„è§„èŒƒæ¥ç”Ÿæˆä»£ç æ—¶ï¼Œä½ éœ€è¦çš„æ˜¯Skillã€‚</p>
<h4 data-id="heading-5">æŠ€æœ¯æ¶æ„ï¼šMarkdownæ ¼å¼çš„çŸ¥è¯†å°è£…</h4>
<p>é€‰æ‹©Markdownä½œä¸ºçŸ¥è¯†è½½ä½“å¹¶éå¶ç„¶ã€‚è¿™ä¸€é€‰æ‹©ä½“ç°äº†å‡ ä¸ªè®¾è®¡è€ƒé‡ï¼š</p>
<ol>
<li><strong>äººæœºå¯è¯»æ€§</strong>ï¼šMarkdownå¯¹äººç±»å‹å¥½ï¼Œä¾¿äºç¼–å†™å’Œç»´æŠ¤ï¼›åŒæ—¶LLMå¯¹Markdownæœ‰æå¥½çš„ç†è§£èƒ½åŠ›</li>
<li><strong>ç»“æ„åŒ–ä¸çµæ´»æ€§çš„å¹³è¡¡</strong>ï¼šYAML frontmatteræä¾›å¿…è¦çš„ç»“æ„åŒ–å…ƒæ•°æ®ï¼ŒMarkdownæ­£æ–‡åˆ™å…è®¸è‡ªç”±å½¢å¼çš„çŸ¥è¯†è¡¨è¾¾</li>
<li><strong>ç”Ÿæ€å…¼å®¹æ€§</strong>ï¼šä¸ç°æœ‰çš„æ–‡æ¡£å·¥å…·ã€ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæ— ç¼é›†æˆ</li>
<li><strong>æ¸è¿›å¼å¤æ‚åº¦</strong>ï¼šä»ç®€å•çš„å•æ–‡ä»¶Skillåˆ°å¤æ‚çš„å¤šæ–‡ä»¶Skillï¼ŒMarkdownéƒ½èƒ½è‰¯å¥½æ”¯æŒ</li>
</ol>
<hr/>
<h3 data-id="heading-6">Skillè§£å†³çš„æ ¸å¿ƒé—®é¢˜</h3>
<h4 data-id="heading-7">ä¸Šä¸‹æ–‡çª—å£çš„æœ‰æ•ˆåˆ©ç”¨ï¼šæŒ‰éœ€åŠ è½½ vs å…¨é‡æ³¨å…¥</h4>
<p>ä¸Šä¸‹æ–‡çª—å£æ˜¯LLMæœ€å®è´µçš„èµ„æºã€‚ä¼ ç»Ÿæ–¹æ³•é¢ä¸´ä¸€ä¸ªä¸¤éš¾é€‰æ‹©ï¼šè¦ä¹ˆåœ¨System Promptä¸­æ³¨å…¥å¤§é‡ä¸Šä¸‹æ–‡ï¼ˆæµªè´¹tokenä¸”å¯èƒ½è¶…å‡ºé™åˆ¶ï¼‰ï¼Œè¦ä¹ˆæ¯æ¬¡å¯¹è¯é‡æ–°æä¾›ï¼ˆä½“éªŒç³Ÿç³•ä¸”ä¾èµ–ç”¨æˆ·è®°å¿†ï¼‰ã€‚</p>
<p>Skillé€šè¿‡ <strong>æ¸è¿›å¼æŠ«éœ²ï¼ˆProgressive Disclosureï¼‰</strong> æœºåˆ¶è§£å†³äº†è¿™ä¸€é—®é¢˜ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3b9c719023524361a400137dd844bc8c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6buE6JyCYmd3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769409114&amp;x-signature=vBqKXOkslmbEt64LcJp5O%2Bi0w14%3D" alt="æ¸è¿›æŠ«éœ².png" loading="lazy"/></p>
<p>è¿™ç§åˆ†å±‚åŠ è½½ç­–ç•¥æ„å‘³ç€ï¼š</p>
<ul>
<li>å®‰è£…100ä¸ªSkillï¼Œå¯åŠ¨æ—¶å¯èƒ½åªæ¶ˆè€—10K tokensçš„å…ƒæ•°æ®</li>
<li>å®é™…æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œåªæœ‰ç›¸å…³Skillçš„æ ¸å¿ƒæŒ‡ä»¤è¢«åŠ è½½</li>
<li>å¤æ‚ä»»åŠ¡æ‰€éœ€çš„æ‰©å±•æ–‡æ¡£å’Œè„šæœ¬æŒ‰éœ€è¯»å–</li>
</ul>
<h4 data-id="heading-8">é¢†åŸŸä¸“ä¸šçŸ¥è¯†çš„æ¨¡å—åŒ–ç®¡ç†</h4>
<p>Skillå°†çŸ¥è¯†å°è£…ä¸ºç‹¬ç«‹ã€å¯ç»„åˆçš„æ¨¡å—ã€‚æ¯ä¸ªSkillä¸“æ³¨è§£å†³ä¸€ç±»é—®é¢˜ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby">~<span class="hljs-regexp">/.claude/skills</span><span class="hljs-regexp">/
â”œâ”€â”€ code-review/</span>           <span class="hljs-comment"># ä»£ç å®¡æŸ¥è§„èŒƒ</span>
â”œâ”€â”€ commit-message/        <span class="hljs-comment"># Gitæäº¤ä¿¡æ¯è§„èŒƒ  </span>
â”œâ”€â”€ api-documentation/     <span class="hljs-comment"># APIæ–‡æ¡£ç”Ÿæˆè§„èŒƒ</span>
â”œâ”€â”€ unit-testing/          <span class="hljs-comment"># å•å…ƒæµ‹è¯•æœ€ä½³å®è·µ</span>
â””â”€â”€ security-audit/        <span class="hljs-comment"># å®‰å…¨å®¡è®¡æ£€æŸ¥æ¸…å•</span>
</code></pre>
<p>è¿™ç§æ¨¡å—åŒ–å¸¦æ¥çš„å¥½å¤„æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼š</p>
<ul>
<li><strong>ç‹¬ç«‹æ¼”è¿›</strong>ï¼šæ¯ä¸ªSkillå¯ä»¥ç‹¬ç«‹æ›´æ–°ï¼Œä¸å½±å“å…¶ä»–Skill</li>
<li><strong>æŒ‰éœ€ç»„åˆ</strong>ï¼šå¤æ‚ä»»åŠ¡å¯ä»¥è‡ªåŠ¨è°ƒç”¨å¤šä¸ªç›¸å…³Skill</li>
<li><strong>å›¢é˜Ÿåä½œ</strong>ï¼šä¸åŒå›¢é˜Ÿæˆå‘˜å¯ä»¥è´¡çŒ®å’Œç»´æŠ¤ä¸åŒé¢†åŸŸçš„Skill</li>
<li><strong>çŸ¥è¯†ç§¯ç´¯</strong>ï¼šç»„ç»‡çš„æœ€ä½³å®è·µä»¥Skillå½¢å¼æ²‰æ·€å’Œä¼ æ‰¿</li>
</ul>
<h4 data-id="heading-9">å·¥ä½œæµçš„æ ‡å‡†åŒ–ä¸å¯å¤ç”¨æ€§</h4>
<p>Skillä¸ä»…æ˜¯é™æ€çŸ¥è¯†çš„å®¹å™¨ï¼Œæ›´æ˜¯å·¥ä½œæµç¨‹çš„ç¼–çº‚ã€‚ä»¥ä¸€ä¸ªçœŸå®çš„PDFå¤„ç†Skillä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">---
name: pdf-processing
<span class="hljs-section">description: Extract text and tables from PDF files, fill forms, merge documents.
---</span>

<span class="hljs-section"># PDF Processing</span>

<span class="hljs-section">## Workflow: Extract and Analyze</span>

<span class="hljs-bullet">1.</span> Use <span class="hljs-code">`pdfplumber`</span> to extract raw text
<span class="hljs-bullet">2.</span> Identify table structures using layout analysis
<span class="hljs-bullet">3.</span> Convert tables to pandas DataFrames for analysis
<span class="hljs-bullet">4.</span> Handle multi-page documents with page-by-page processing

<span class="hljs-section">## Workflow: Form Filling</span>

For form operations, see [<span class="hljs-string">FORMS.md</span>](<span class="hljs-link">FORMS.md</span>) which covers:
<span class="hljs-bullet">-</span> Reading existing form fields
<span class="hljs-bullet">-</span> Validating input data
<span class="hljs-bullet">-</span> Filling and saving forms

<span class="hljs-section">## Common Patterns</span>

<span class="hljs-section">### Error Handling</span>
Always wrap PDF operations in try-except blocks...

<span class="hljs-section">### Performance Tips</span>
For large PDFs (&gt;100 pages), use streaming mode...
</code></pre>
<p>è¿™ç§å·¥ä½œæµç¼–çº‚æ„å‘³ç€ï¼š</p>
<ul>
<li>æ–°å›¢é˜Ÿæˆå‘˜å¯ä»¥å¿«é€Ÿä¸Šæ‰‹å¤æ‚ä»»åŠ¡</li>
<li>æœ€ä½³å®è·µè¢«æ˜¾å¼è®°å½•è€Œéå£å£ç›¸ä¼ </li>
<li>Claudeçš„è¡Œä¸ºåœ¨åŒç±»ä»»åŠ¡ä¸Šä¿æŒä¸€è‡´æ€§</li>
</ul>
<h4 data-id="heading-10">å®é™…æ¡ˆä¾‹åˆ†æï¼šæ–‡æ¡£å¤„ç†æŠ€èƒ½</h4>
<p>Anthropicæä¾›çš„é¢„ç½®Skillæ˜¯ç†è§£Skillè®¾è®¡ç†å¿µçš„æœ€ä½³æ¡ˆä¾‹ã€‚ä»¥xlsx Skillä¸ºä¾‹ï¼Œå®ƒå±•ç¤ºäº†ä¸€ä¸ªæˆç†ŸSkillçš„å®Œæ•´å½¢æ€ï¼š</p>
<p><strong>å…ƒæ•°æ®è®¾è®¡</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">xlsx</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">Comprehensive</span> <span class="hljs-string">spreadsheet</span> <span class="hljs-string">creation,</span> <span class="hljs-string">editing,</span> <span class="hljs-string">and</span> <span class="hljs-string">analysis</span> <span class="hljs-string">with</span> <span class="hljs-string">support</span> <span class="hljs-string">for</span> <span class="hljs-string">formulas,</span> <span class="hljs-string">formatting,</span> <span class="hljs-string">data</span> <span class="hljs-string">analysis,</span> <span class="hljs-string">and</span> <span class="hljs-string">visualization.</span> <span class="hljs-string">When</span> <span class="hljs-string">Claude</span> 
<span class="hljs-string">needs</span> <span class="hljs-string">to</span> <span class="hljs-string">work</span> <span class="hljs-string">with</span> <span class="hljs-string">spreadsheets</span> <span class="hljs-string">(.xlsx,</span> <span class="hljs-string">.xlsm,</span> <span class="hljs-string">.csv,</span> <span class="hljs-string">.tsv,</span> <span class="hljs-string">etc)</span> <span class="hljs-attr">for:</span> 
<span class="hljs-string">(1)</span> <span class="hljs-string">Creating</span> <span class="hljs-string">new</span> <span class="hljs-string">spreadsheets</span> <span class="hljs-string">with</span> <span class="hljs-string">formulas</span> <span class="hljs-string">and</span> <span class="hljs-string">formatting,</span> 
<span class="hljs-string">(2)</span> <span class="hljs-string">Reading</span> <span class="hljs-string">or</span> <span class="hljs-string">analyzing</span> <span class="hljs-string">data,</span> 
<span class="hljs-string">(3)</span> <span class="hljs-string">Modify</span> <span class="hljs-string">existing</span> <span class="hljs-string">spreadsheets</span> <span class="hljs-string">while</span> <span class="hljs-string">preserving</span> <span class="hljs-string">formulas...</span>
</code></pre>
<p>æ³¨æ„descriptionçš„è®¾è®¡â€”â€”å®ƒä¸ä»…è¯´æ˜äº†"åšä»€ä¹ˆ"ï¼Œæ›´æ˜ç¡®åˆ—å‡ºäº†"ä½•æ—¶ä½¿ç”¨"çš„è§¦å‘æ¡ä»¶ã€‚è¿™æ˜¯è®©Claudeèƒ½å¤Ÿè‡ªåŠ¨åŒ¹é…Skillçš„å…³é”®ã€‚</p>
<p><strong>åˆ†å±‚å†…å®¹ç»„ç»‡</strong>ï¼š</p>
<ul>
<li>Level 1ï¼šå…ƒæ•°æ®æä¾›å‘ç°ä¿¡æ¯</li>
<li>Level 2ï¼šSKILL.mdåŒ…å«æ ¸å¿ƒç”¨æ³•å’Œå¸¸è§æ¨¡å¼</li>
<li>Level 3ï¼šreference.mdæä¾›APIè¯¦ç»†å‚è€ƒï¼Œåªåœ¨éœ€è¦é«˜çº§æ“ä½œæ—¶åŠ è½½</li>
</ul>
<p><strong>ä»£ç ä¸æŒ‡ä»¤çš„åä½œ</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">## Creating Charts</span>

For data visualization, use the bundled charting utilities:

python
from openpyxl.chart import BarChart, Reference
<span class="hljs-section"># Chart creation code...</span>

See scripts/chart<span class="hljs-emphasis">_helper.py for ready-to-use chart templates.
</span></code></pre>
<p>è¿™ç§è®¾è®¡è®©æŒ‡ä»¤ä¸ä»£ç å„å¸å…¶èŒï¼šæŒ‡ä»¤æä¾›æ–¹å‘å’Œä¸Šä¸‹æ–‡ï¼Œä»£ç æä¾›ç¡®å®šæ€§çš„æ‰§è¡Œèƒ½åŠ›ã€‚</p>
<hr/>
<h3 data-id="heading-11">Skillå®è·µæŒ‡å—</h3>
<h4 data-id="heading-12">åˆ›å»ºè‡ªå®šä¹‰Skillçš„æœ€ä½³å®è·µ</h4>
<p>åˆ›å»ºä¸€ä¸ªé«˜è´¨é‡çš„Skilléœ€è¦éµå¾ªå‡ ä¸ªåŸåˆ™ï¼š</p>
<p><strong>1. ä¿æŒèšç„¦</strong></p>
<p>ä¸€ä¸ªSkillåº”è¯¥è§£å†³ä¸€ç±»æ˜ç¡®çš„é—®é¢˜ã€‚é¿å…åˆ›å»º"ç‘å£«å†›åˆ€"å¼çš„ä¸‡èƒ½Skillï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># ä¸æ¨èï¼šè¿‡äºå®½æ³›</span>
---
name: document-tools
<span class="hljs-section">description: Handle all document operations
---</span>

<span class="hljs-section"># æ¨èï¼šèšç„¦æ˜ç¡®</span>
---
name: pdf-form-filler
description: Fill PDF forms with structured data. Use when user needs to populate PDF forms, handle form validation, or batch-fill multiple forms.

<span class="hljs-section">## Instructions</span>

<span class="hljs-bullet">1.</span> First, check if the PDF is encrypted using <span class="hljs-code">`pypdf`</span>
<span class="hljs-bullet">2.</span> If encrypted, ask user for password before proceeding
<span class="hljs-bullet">3.</span> For text extraction, prefer <span class="hljs-code">`pdfplumber`</span> over <span class="hljs-code">`pypdf`</span> for better accuracy
<span class="hljs-bullet">4.</span> Always validate extracted data against expected schema

<span class="hljs-section">## Common Mistakes to Avoid</span>

<span class="hljs-bullet">-</span> Don't use <span class="hljs-code">`PyPDF2`</span> (deprecated, use <span class="hljs-code">`pypdf`</span> instead)
<span class="hljs-bullet">-</span> Don't load entire PDF into memory for large files
<span class="hljs-bullet">-</span> Don't ignore PDF metadata, it often contains useful context
</code></pre>
<p><strong>4. è¿­ä»£å¼å¼€å‘</strong></p>
<p>æœ€ä½³å®è·µæ˜¯åœ¨å®é™…ä½¿ç”¨ä¸­é€æ­¥å®Œå–„Skillï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è§‚å¯ŸClaudeå¦‚ä½•ä½¿ç”¨Skill</span>
claude --debug

<span class="hljs-comment"># è®©Claudeå¸®åŠ©æ”¹è¿›Skill</span>
<span class="hljs-string">"Based on how you just handled that task, what additional instructions 
would help you do it better next time?"</span>
</code></pre>
<h4 data-id="heading-13">Skillçš„ç»„ç»‡ç»“æ„ä¸å‘½åè§„èŒƒ</h4>
<p><strong>ç›®å½•ç»“æ„</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">skill-name/
â”œâ”€â”€ SKILL.md              <span class="hljs-comment"># å¿…éœ€ï¼šæ ¸å¿ƒæ–‡ä»¶</span>
â”œâ”€â”€ REFERENCE.md          <span class="hljs-comment"># å¯é€‰ï¼šè¯¦ç»†å‚è€ƒ</span>
â”œâ”€â”€ EXAMPLES.md           <span class="hljs-comment"># å¯é€‰ï¼šä½¿ç”¨ç¤ºä¾‹</span>
â”œâ”€â”€ CHANGELOG.md          <span class="hljs-comment"># å¯é€‰ï¼šç‰ˆæœ¬å†å²</span>
â”œâ”€â”€ scripts/              <span class="hljs-comment"># å¯é€‰ï¼šå¯æ‰§è¡Œè„šæœ¬</span>
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ helper.py
â”‚   â””â”€â”€ validator.py
â”œâ”€â”€ templates/            <span class="hljs-comment"># å¯é€‰ï¼šæ¨¡æ¿æ–‡ä»¶</span>
â”‚   â””â”€â”€ report.md
â””â”€â”€ resources/            <span class="hljs-comment"># å¯é€‰ï¼šé™æ€èµ„æº</span>
    â””â”€â”€ schema.json
</code></pre>
<p><strong>å‘½åè§„èŒƒ</strong>ï¼š</p>
<ul>
<li><code>name</code>å­—æ®µï¼šå°å†™å­—æ¯ã€æ•°å­—ã€è¿å­—ç¬¦ï¼ˆæœ€å¤š64å­—ç¬¦ï¼‰</li>
<li>ç›®å½•åï¼šä¸nameä¿æŒä¸€è‡´</li>
<li>é¿å…ä½¿ç”¨ä¿ç•™è¯ï¼š<code>anthropic</code>ã€<code>claude</code></li>
</ul>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># åˆè§„å‘½å</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">pdf-form-filler</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">my-company-code-review</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">data-analysis-v2</span>

<span class="hljs-comment"># ä¸åˆè§„å‘½å</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">PDF_Form_Filler</span>     <span class="hljs-comment"># åŒ…å«å¤§å†™å’Œä¸‹åˆ’çº¿</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">claude-helper</span>       <span class="hljs-comment"># ä½¿ç”¨ä¿ç•™è¯</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">a</span>                   <span class="hljs-comment"># è¿‡äºç®€çŸ­ï¼Œç¼ºä¹æè¿°æ€§</span>
</code></pre>
<h4 data-id="heading-14">Personal vs Project vs Plugin Skillsçš„ä½¿ç”¨åœºæ™¯</h4>
<p>æ ¹æ®Skillçš„å­˜å‚¨ä½ç½®ï¼Œå­˜åœ¨ä¸‰ç§ç±»å‹çš„Skillï¼Œå„æœ‰å…¶é€‚ç”¨åœºæ™¯ï¼š</p>
<p><strong>Personal Skillsï¼ˆä¸ªäººSkillï¼‰</strong></p>
<ul>
<li>ä½ç½®ï¼š<code>~/.claude/skills/</code></li>
<li>èŒƒå›´ï¼šä»…å½“å‰ç”¨æˆ·å¯ç”¨</li>
<li>åœºæ™¯ï¼šä¸ªäººå·¥ä½œæµåå¥½ã€å®éªŒæ€§Skillå¼€å‘</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºä¸ªäººSkill</span>
<span class="hljs-built_in">mkdir</span> -p ~/.claude/skills/my-workflow
<span class="hljs-built_in">cat</span> &gt; ~/.claude/skills/my-workflow/SKILL.md &lt;&lt; <span class="hljs-string">'EOF'</span>
---
name: my-workflow
description: My personal coding preferences and patterns
---
...
EOF
</code></pre>
<p><strong>Project Skillsï¼ˆé¡¹ç›®Skillï¼‰</strong></p>
<ul>
<li>ä½ç½®ï¼š<code>.claude/skills/</code>ï¼ˆé¡¹ç›®æ ¹ç›®å½•ï¼‰</li>
<li>èŒƒå›´ï¼šé¡¹ç›®å›¢é˜Ÿæˆå‘˜å…±äº«</li>
<li>åœºæ™¯ï¼šå›¢é˜Ÿè§„èŒƒã€é¡¹ç›®ç‰¹å®šå·¥ä½œæµ</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºé¡¹ç›®Skillå¹¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶</span>
<span class="hljs-built_in">mkdir</span> -p .claude/skills/team-conventions
<span class="hljs-comment"># ... åˆ›å»ºSKILL.md</span>
git add .claude/skills/
git commit -m <span class="hljs-string">"Add team coding conventions skill"</span>
</code></pre>
<p><strong>Plugin Skillsï¼ˆæ’ä»¶Skillï¼‰</strong></p>
<ul>
<li>æ¥æºï¼šé€šè¿‡Claude Code Pluginå®‰è£…</li>
<li>èŒƒå›´ï¼šå®‰è£…è¯¥æ’ä»¶çš„æ‰€æœ‰ç”¨æˆ·</li>
<li>åœºæ™¯ï¼šé€šç”¨å·¥å…·Skillçš„åˆ†å‘</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä»Anthropicå®˜æ–¹marketplaceå®‰è£…</span>
/plugin install document-skills@anthropic-agent-skills
</code></pre>
<p><strong>é€‰æ‹©å»ºè®®</strong>ï¼š</p>

























<table><thead><tr><th>åœºæ™¯</th><th>æ¨èç±»å‹</th></tr></thead><tbody><tr><td>ä¸ªäººç¼–ç ä¹ æƒ¯</td><td>Personal</td></tr><tr><td>å›¢é˜Ÿä»£ç è§„èŒƒ</td><td>Project</td></tr><tr><td>é€šç”¨å·¥å…·èƒ½åŠ›</td><td>Plugin</td></tr><tr><td>å…¬å¸å†…éƒ¨å·¥ä½œæµ</td><td>Project + å†…éƒ¨Pluginåˆ†å‘</td></tr></tbody></table>
<h4 data-id="heading-15">Claude Codeä¸­çš„Skillåº”ç”¨</h4>
<p>åœ¨Claude Codeç¯å¢ƒä¸­ï¼ŒSkillçš„ä½¿ç”¨æ˜¯è‡ªåŠ¨åŒ–çš„ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹å¯ç”¨Skill</span>
claude&gt; What Skills are available?

<span class="hljs-comment"># éšå¼è§¦å‘Skillï¼ˆClaudeè‡ªåŠ¨åŒ¹é…ï¼‰</span>
claude&gt; Help me extract data from this PDF form

<span class="hljs-comment"># æ˜¾å¼è¯·æ±‚ä½¿ç”¨ç‰¹å®šSkill</span>
claude&gt; Use the PDF skill to extract form fields from contract.pdf
</code></pre>
<p><strong>è°ƒè¯•æ¨¡å¼</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹SkillåŠ è½½å’Œè§¦å‘è¯¦æƒ…</span>
claude --debug
</code></pre>
<p><strong>å·¥å…·æƒé™é™åˆ¶</strong>ï¼š</p>
<p>Skillå¯ä»¥é€šè¿‡<code>allowed-tools</code>é™åˆ¶Claudeå¯ç”¨çš„å·¥å…·ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">safe-file-reader</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">Read</span> <span class="hljs-string">files</span> <span class="hljs-string">without</span> <span class="hljs-string">making</span> <span class="hljs-string">changes.</span>
<span class="hljs-attr">allowed-tools:</span> <span class="hljs-string">Read,</span> <span class="hljs-string">Grep,</span> <span class="hljs-string">Glob</span>
<span class="hljs-meta">---
</span></code></pre>
<p>å½“æ­¤Skillæ¿€æ´»æ—¶ï¼ŒClaudeåªèƒ½ä½¿ç”¨æŒ‡å®šçš„å·¥å…·ï¼Œé€‚ç”¨äºéœ€è¦åªè¯»è®¿é—®æˆ–å—é™æ“ä½œçš„åœºæ™¯ã€‚</p>
<hr/>
<h3 data-id="heading-16">æŠ€æœ¯å¯¹æ¯”ä¸ç”Ÿæ€å®šä½</h3>
<p>ç†è§£Skillåœ¨AIå·¥å…·ç”Ÿæ€ä¸­çš„ä½ç½®ï¼Œéœ€è¦å°†å…¶ä¸ç›¸å…³æŠ€æœ¯è¿›è¡Œå¯¹æ¯”ï¼š</p>
<h4 data-id="heading-17">vs GPTs/Custom Instructionsï¼šçŸ¥è¯†å°è£…å±‚é¢</h4>



































<table><thead><tr><th>ç»´åº¦</th><th>GPTs/Custom Instructions</th><th>Agent Skills</th></tr></thead><tbody><tr><td>çŸ¥è¯†å®¹é‡</td><td>å—é™äºSystem Prompté•¿åº¦</td><td>é€šè¿‡æ¸è¿›å¼æŠ«éœ²ç†è®ºä¸Šæ— é™</td></tr><tr><td>ç»„åˆæ€§</td><td>å•ä¸€GPT/Instruction</td><td>å¤šSkillè‡ªåŠ¨ç»„åˆ</td></tr><tr><td>ç‰ˆæœ¬ç®¡ç†</td><td>å¹³å°å†…ç®¡ç†</td><td>GitåŸç”Ÿæ”¯æŒ</td></tr><tr><td>åˆ†å‘æ–¹å¼</td><td>å¹³å°å•†åº—</td><td>æ–‡ä»¶ç³»ç»Ÿ/Git/Plugin</td></tr><tr><td>å¯æ‰§è¡Œä»£ç </td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒè„šæœ¬æ‰§è¡Œ</td></tr></tbody></table>
<p>GPTsé€‚åˆé¢å‘ç»ˆç«¯ç”¨æˆ·çš„å›ºå®šåœºæ™¯åº”ç”¨ï¼›Skillsé€‚åˆå¼€å‘è€…å’Œå›¢é˜Ÿçš„å·¥ä½œæµå®šåˆ¶ã€‚</p>
<h4 data-id="heading-18">vs Function Calling/Toolsï¼šèƒ½åŠ›æ‰©å±•å±‚é¢</h4>






























<table><thead><tr><th>ç»´åº¦</th><th>Function Calling/Tools</th><th>Agent Skills</th></tr></thead><tbody><tr><td>æœ¬è´¨</td><td>èƒ½åŠ›æ‰©å±•ï¼ˆåšæ–°çš„äº‹ï¼‰</td><td>çŸ¥è¯†æ³¨å…¥ï¼ˆæ›´å¥½åœ°åšå·²æœ‰çš„äº‹ï¼‰</td></tr><tr><td>å®ç°</td><td>ä»£ç å®šä¹‰å‡½æ•°ç­¾åå’Œå®ç°</td><td>Markdownæè¿°å·¥ä½œæµ</td></tr><tr><td>è¿è¡Œæ—¶</td><td>LLMå†³å®šè°ƒç”¨ï¼Œå¤–éƒ¨æ‰§è¡Œ</td><td>LLMè¯»å–çŸ¥è¯†ï¼Œå†…éƒ¨æ‰§è¡Œ</td></tr><tr><td>å¼€å‘æˆæœ¬</td><td>éœ€è¦åç«¯å¼€å‘</td><td>ä»…éœ€æ–‡æ¡£ç¼–å†™</td></tr></tbody></table>
<p>å½“ä½ éœ€è¦Claudeè°ƒç”¨å¤–éƒ¨APIæ—¶ï¼Œä½¿ç”¨Tools/MCPï¼›å½“ä½ éœ€è¦ClaudeæŒ‰ç…§ç‰¹å®šæ–¹å¼å®Œæˆä»»åŠ¡æ—¶ï¼Œä½¿ç”¨Skillsã€‚</p>
<h4 data-id="heading-19">vs RAGï¼šçŸ¥è¯†æ£€ç´¢å±‚é¢</h4>



































<table><thead><tr><th>ç»´åº¦</th><th>RAG</th><th>Agent Skills</th></tr></thead><tbody><tr><td>çŸ¥è¯†ç±»å‹</td><td>äº‹å®æ€§çŸ¥è¯†ï¼ˆWhatï¼‰</td><td>ç¨‹åºæ€§çŸ¥è¯†ï¼ˆHowï¼‰</td></tr><tr><td>æ£€ç´¢æ–¹å¼</td><td>å‘é‡ç›¸ä¼¼åº¦</td><td>è¯­ä¹‰æè¿°åŒ¹é…</td></tr><tr><td>åŸºç¡€è®¾æ–½</td><td>å‘é‡æ•°æ®åº“</td><td>æ–‡ä»¶ç³»ç»Ÿ</td></tr><tr><td>çŸ¥è¯†ç²’åº¦</td><td>æ–‡æ¡£ç‰‡æ®µ</td><td>å®Œæ•´å·¥ä½œæµ</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>é—®ç­”ã€çŸ¥è¯†åº“æŸ¥è¯¢</td><td>ä»»åŠ¡æ‰§è¡Œã€æµç¨‹è‡ªåŠ¨åŒ–</td></tr></tbody></table>
<p>RAGè§£å†³"Claudeä¸çŸ¥é“çš„äº‹å®"ï¼ŒSkillsè§£å†³"Claudeä¸çŸ¥é“çš„åšæ³•"ã€‚</p>
<h4 data-id="heading-20">vs Prompt Engineeringï¼šä½¿ç”¨å¤æ‚åº¦å±‚é¢</h4>






























<table><thead><tr><th>ç»´åº¦</th><th>Prompt Engineering</th><th>Agent Skills</th></tr></thead><tbody><tr><td>å¤ç”¨æ€§</td><td>éœ€è¦æ¯æ¬¡é‡å†™æˆ–å¤åˆ¶ç²˜è´´</td><td>ä¸€æ¬¡åˆ›å»ºï¼Œè‡ªåŠ¨åº”ç”¨</td></tr><tr><td>ç»´æŠ¤æ€§</td><td>åˆ†æ•£åœ¨å„å¤„</td><td>é›†ä¸­ç®¡ç†</td></tr><tr><td>ä¸€è‡´æ€§</td><td>ä¾èµ–ç¼–å†™è€…è®°å¿†</td><td>è‡ªåŠ¨ä¿æŒä¸€è‡´</td></tr><tr><td>åä½œæ€§</td><td>éš¾ä»¥å…±äº«å’Œç‰ˆæœ¬æ§åˆ¶</td><td>GitåŸç”Ÿæ”¯æŒ</td></tr></tbody></table>
<p>Prompt Engineeringæ˜¯å³å…´æ¼”å¥ï¼ŒSkillsæ˜¯ç¼–å†™ä¹è°±ã€‚</p>
<h4 data-id="heading-21">é€‚ç”¨åœºæ™¯</h4>

























<table><thead><tr><th/><th>äº‹å®æ€§çŸ¥è¯†</th><th>ç¨‹åºæ€§çŸ¥è¯†</th></tr></thead><tbody><tr><td>ä¸€æ¬¡æ€§/ç®€å•ä»»åŠ¡</td><td>RAG</td><td>Prompt Engineering</td></tr><tr><td>é‡å¤æ€§/å¤æ‚ä»»åŠ¡</td><td>RAG + Skills</td><td>Skills</td></tr><tr><td>éœ€è¦å¤–éƒ¨èƒ½åŠ›</td><td>MCP/Tools</td><td>MCP/Tools + Skills</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-22">å®ç°åŸç†ä¸æŠ€æœ¯ç»†èŠ‚</h3>
<h4 data-id="heading-23">Skillçš„åŠ è½½æ—¶æœºä¸è§¦å‘æœºåˆ¶</h4>
<p>ç†è§£Skillçš„è¿è¡Œæ—¶è¡Œä¸ºï¼Œéœ€è¦è·Ÿè¸ªå…¶åœ¨æ•´ä¸ªè¯·æ±‚ç”Ÿå‘½å‘¨æœŸä¸­çš„çŠ¶æ€å˜åŒ–ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67fd3d76c3df45598f60fdfb58051d83~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6buE6JyCYmd3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769409114&amp;x-signature=ym3b%2FS6fdny1N%2FnOdV%2BH2lSttXY%3D" alt="skillè¿è¡Œæ—¶è¡Œä¸º.png" loading="lazy"/></p>
<p><strong>å¯åŠ¨é˜¶æ®µ</strong>ï¼š</p>
<ul>
<li>ç³»ç»Ÿæ”¶é›†æ‰€æœ‰å¯ç”¨Skillçš„å…ƒæ•°æ®ï¼ˆname + descriptionï¼‰</li>
<li>å…ƒæ•°æ®è¢«æ³¨å…¥System Prompt</li>
<li>æ¯ä¸ªSkillä»…æ¶ˆè€—çº¦100 tokens</li>
</ul>
<p><strong>è§¦å‘é˜¶æ®µ</strong>ï¼š</p>
<ul>
<li>Claudeåˆ†æç”¨æˆ·è¯·æ±‚</li>
<li>åŸºäºdescriptionè¿›è¡Œè¯­ä¹‰åŒ¹é…</li>
<li>å†³å®šæ˜¯å¦éœ€è¦åŠ è½½æŸä¸ªSkill</li>
</ul>
<p><strong>åŠ è½½é˜¶æ®µ</strong>ï¼š</p>
<ul>
<li>Claudeé€šè¿‡Bashå·¥å…·æ‰§è¡Œæ–‡ä»¶è¯»å–</li>
<li>SKILL.mdå†…å®¹è¿›å…¥ä¸Šä¸‹æ–‡çª—å£</li>
<li>æ ¹æ®éœ€è¦ç»§ç»­åŠ è½½æ‰©å±•æ–‡ä»¶</li>
</ul>
<h4 data-id="heading-24">ä¸Šä¸‹æ–‡æ³¨å…¥ç­–ç•¥ï¼šBashå·¥å…·è¯»å–æ–‡ä»¶</h4>
<p>åœ¨Claude Codeç¯å¢ƒä¸­ï¼ŒSkillå†…å®¹é€šè¿‡Bashå‘½ä»¤åŠ è½½ã€‚æ ¹æ®<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.claude.com%2Fdocs%2Fen%2Fagents-and-tools%2Fagent-skills%2Foverview" target="_blank" title="https://platform.claude.com/docs/en/agents-and-tools/agent-skills/overview" ref="nofollow noopener noreferrer">Anthropicå®˜æ–¹æ–‡æ¡£</a>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åŸºäºå®˜æ–¹æ–‡æ¡£çš„æ¦‚å¿µæ€§ä¼ªä»£ç </span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">trigger_skill</span>(<span class="hljs-params">skill_path</span>):
    <span class="hljs-comment"># Step 1: è¯»å–æ ¸å¿ƒSKILL.md</span>
    skill_content = bash(<span class="hljs-string">f"cat <span class="hljs-subst">{skill_path}</span>/SKILL.md"</span>)
    context_window.append(skill_content)
    
    <span class="hljs-comment"># Step 2: è§£æå¼•ç”¨ï¼ŒæŒ‰éœ€åŠ è½½</span>
    references = parse_references(skill_content)
    <span class="hljs-keyword">for</span> ref <span class="hljs-keyword">in</span> references:
        <span class="hljs-keyword">if</span> needs_loading(ref, current_task):
            ref_content = bash(<span class="hljs-string">f"cat <span class="hljs-subst">{skill_path}</span>/<span class="hljs-subst">{ref}</span>"</span>)
            context_window.append(ref_content)
    
    <span class="hljs-comment"># Step 3: æ‰§è¡Œè„šæœ¬ï¼ˆä¸åŠ è½½ä»£ç åˆ°ä¸Šä¸‹æ–‡ï¼‰</span>
    <span class="hljs-keyword">if</span> needs_script_execution(current_task):
        result = bash(<span class="hljs-string">f"python <span class="hljs-subst">{skill_path}</span>/scripts/helper.py <span class="hljs-subst">{args}</span>"</span>)
        <span class="hljs-comment"># ä»…resultè¿›å…¥ä¸Šä¸‹æ–‡ï¼Œscriptä»£ç ä¸è¿›å…¥</span>
</code></pre>
<p>è¿™ç§è®¾è®¡çš„å…³é”®æ˜¯ï¼š<strong>ä»£ç æ‰§è¡Œä¸ä»£ç é˜…è¯»æ˜¯ä¸åŒçš„ä¸Šä¸‹æ–‡éœ€æ±‚</strong>ã€‚</p>
<h4 data-id="heading-25">Tokené¢„ç®—ç®¡ç†</h4>
<p>Skillçš„Tokenæ¶ˆè€—éµå¾ªä»¥ä¸‹æ¨¡å‹ï¼š</p>





























<table><thead><tr><th>çº§åˆ«</th><th>åŠ è½½æ—¶æœº</th><th>å…¸å‹æ¶ˆè€—</th><th>ç®¡ç†ç­–ç•¥</th></tr></thead><tbody><tr><td>L1 å…ƒæ•°æ®</td><td>å§‹ç»ˆ</td><td>~100/Skill</td><td>æ§åˆ¶Skillæ•°é‡</td></tr><tr><td>L2 æ ¸å¿ƒæŒ‡ä»¤</td><td>è§¦å‘æ—¶</td><td>&lt;5K</td><td>ä¿æŒSKILL.mdç²¾ç®€</td></tr><tr><td>L3 æ‰©å±•èµ„æº</td><td>æŒ‰éœ€</td><td>æ— ä¸Šé™</td><td>åˆç†åˆ†å‰²æ–‡ä»¶</td></tr></tbody></table>
<p><strong>ä¼˜åŒ–å»ºè®®</strong>ï¼š</p>
<ol>
<li><strong>å…ƒæ•°æ®å±‚</strong>ï¼šdescriptionè¦ç²¾ç¡®ä½†ç®€æ´ï¼Œé¿å…å†—ä½™</li>
<li><strong>æ ¸å¿ƒæŒ‡ä»¤å±‚</strong>ï¼šåªä¿ç•™æœ€å¸¸ç”¨çš„æŒ‡ä»¤ï¼Œé«˜çº§å†…å®¹ç§»è‡³æ‰©å±•æ–‡ä»¶</li>
<li><strong>æ‰©å±•èµ„æºå±‚</strong>ï¼šåˆ©ç”¨æ–‡ä»¶åˆ†å‰²å®ç°ç»†ç²’åº¦åŠ è½½</li>
</ol>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># ä¼˜åŒ–å‰ï¼šå•ä¸ªå¤§æ–‡ä»¶</span>
SKILL.md (8000 tokens)
â”œâ”€â”€ Quick Start
â”œâ”€â”€ Basic Usage
â”œâ”€â”€ Advanced Usage
â”œâ”€â”€ API Reference
â”œâ”€â”€ Error Handling
â””â”€â”€ Examples

<span class="hljs-section"># ä¼˜åŒ–åï¼šåˆ†å±‚æ–‡ä»¶</span>
SKILL.md (2000 tokens)
â”œâ”€â”€ Quick Start
â””â”€â”€ Basic Usage

ADVANCED.md (2500 tokens)
â”œâ”€â”€ Advanced Usage
â””â”€â”€ Error Handling

REFERENCE.md (3500 tokens)
â”œâ”€â”€ API Reference
â””â”€â”€ Examples
</code></pre>
<h4 data-id="heading-26">å¤šSkillååŒå·¥ä½œåŸç†</h4>
<p>å½“ä¸€ä¸ªä»»åŠ¡æ¶‰åŠå¤šä¸ªSkillæ—¶ï¼ŒClaudeä¼šæŒ‰éœ€ç»„åˆä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">ç”¨æˆ·è¯·æ±‚: "ä»è¿™ä¸ªPDFæå–æ•°æ®å¹¶ç”ŸæˆExcelæŠ¥è¡¨"

Claudeæ¨ç†è¿‡ç¨‹:
<span class="hljs-bullet">1.</span> åˆ†æä»»åŠ¡éœ€æ±‚
<span class="hljs-bullet">2.</span> è¯†åˆ«éœ€è¦ pdf-processing skill (æå–æ•°æ®)
<span class="hljs-bullet">3.</span> è¯†åˆ«éœ€è¦ xlsx skill (ç”ŸæˆæŠ¥è¡¨)
<span class="hljs-bullet">4.</span> é¡ºåºåŠ è½½å¹¶æ‰§è¡Œ

ä¸Šä¸‹æ–‡å˜åŒ–:
[System Prompt + PDF skill metadata + XLSX skill metadata]
<span class="hljs-code">    â†“ è§¦å‘PDF skill
[+ PDF SKILL.mdå†…å®¹]
    â†“ å®ŒæˆPDFå¤„ç†
[+ XLSX SKILL.mdå†…å®¹]  
    â†“ å®ŒæˆExcelç”Ÿæˆ
[æœ€ç»ˆå“åº”]
</span></code></pre>
<p>Skillçš„ç»„åˆæ˜¯<strong>éšå¼</strong>çš„â€”â€”ClaudeåŸºäºä»»åŠ¡éœ€æ±‚è‡ªåŠ¨åˆ¤æ–­éœ€è¦å“ªäº›Skillï¼Œæ— éœ€æ˜¾å¼å£°æ˜ä¾èµ–å…³ç³»ã€‚</p>
<hr/>
<h3 data-id="heading-27">æ¶æ„å¯ç¤º</h3>
<h4 data-id="heading-28">ä»Skillè®¾è®¡çœ‹AIç³»ç»Ÿçš„æ¨¡å—åŒ–æ€æƒ³</h4>
<p>Skillçš„è®¾è®¡ä½“ç°äº†AIç³»ç»Ÿæ¶æ„çš„å‡ ä¸ªé‡è¦åŸåˆ™ï¼š</p>
<p><strong>1. å…³æ³¨ç‚¹åˆ†ç¦»</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8dd1613d14a4bdfb5621c5ef16c9d30~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6buE6JyCYmd3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769409114&amp;x-signature=iHD7%2ByposBaAM8576F55QAaqSWA%3D" alt="æ¨¡å—åŒ–åˆ†ç¦».png" loading="lazy"/></p>
<p>è¿™ç§åˆ†ç¦»ä½¿å¾—ï¼š</p>
<ul>
<li>æ¨¡å‹å¯ä»¥ç‹¬ç«‹å‡çº§è€Œä¸å½±å“ä¸šåŠ¡çŸ¥è¯†</li>
<li>å·¥å…·èƒ½åŠ›å¯ä»¥ç‹¬ç«‹æ‰©å±•è€Œä¸ä¿®æ”¹çŸ¥è¯†å®šä¹‰</li>
<li>é¢†åŸŸçŸ¥è¯†å¯ä»¥ç‹¬ç«‹ç»´æŠ¤è€Œä¸ä¾èµ–æŠ€æœ¯å›¢é˜Ÿ</li>
</ul>
<p><strong>2. æ¸è¿›å¼å¤æ‚åº¦</strong></p>
<p>Skillæ”¯æŒä»ç®€å•åˆ°å¤æ‚çš„å¹³æ»‘è¿‡æ¸¡ï¼š</p>
<ul>
<li>æœ€ç®€å½¢å¼ï¼šå•ä¸ªSKILL.mdæ–‡ä»¶</li>
<li>ä¸­ç­‰å¤æ‚åº¦ï¼šæ·»åŠ æ‰©å±•æ–‡æ¡£</li>
<li>é«˜å¤æ‚åº¦ï¼šåŒ…å«è„šæœ¬ã€æ¨¡æ¿ã€èµ„æº</li>
</ul>
<p>è¿™ç§è®¾è®¡é™ä½äº†å…¥é—¨é—¨æ§›ï¼ŒåŒæ—¶ä¸é™åˆ¶é«˜çº§ç”¨ä¾‹çš„è¡¨è¾¾èƒ½åŠ›ã€‚</p>
<p><strong>3. å¯ç»„åˆæ€§ä¼˜äºæ•´ä½“æ€§</strong></p>
<p>å¤šä¸ªå°è€Œä¸“æ³¨çš„Skillä¼˜äºä¸€ä¸ªå¤§è€Œå…¨çš„Skillï¼š</p>
<ul>
<li>æ›´å®¹æ˜“æµ‹è¯•å’Œè°ƒè¯•</li>
<li>æ›´å®¹æ˜“ç»´æŠ¤å’Œæ¼”è¿›</li>
<li>æ›´çµæ´»çš„ç»„åˆæ–¹å¼</li>
</ul>
<h4 data-id="heading-29">çŸ¥è¯†ä¸èƒ½åŠ›åˆ†ç¦»çš„æ¶æ„ç†å¿µ</h4>
<p>Skillè®¾è®¡çš„ä¸€ä¸ªæ·±åˆ»æ´å¯Ÿæ˜¯ï¼š<strong>ç¨‹åºæ€§çŸ¥è¯†ï¼ˆHowï¼‰å’Œæ‰§è¡Œèƒ½åŠ›ï¼ˆWhatï¼‰åº”è¯¥åˆ†ç¦»ç®¡ç†</strong>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b0f84d5eaec84c8ab65cd1626d0dca9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn6buE6JyCYmd3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769409114&amp;x-signature=nW2ftF8%2BUr0v0iNONGSKfOCxF7w%3D" alt="åˆ†ç¦»ç®¡ç†.png" loading="lazy"/></p>
<p>è¿™ç§åˆ†ç¦»å¸¦æ¥çš„å¥½å¤„ï¼š</p>
<ul>
<li>çŸ¥è¯†å¯ä»¥å¿«é€Ÿè¿­ä»£è€Œä¸éœ€è¦é‡æ–°éƒ¨ç½²</li>
<li>åŒæ ·çš„çŸ¥è¯†å¯ä»¥åº”ç”¨äºä¸åŒçš„æ‰§è¡Œç¯å¢ƒ</li>
<li>æ‰§è¡Œèƒ½åŠ›çš„æå‡è‡ªåŠ¨æƒ åŠæ‰€æœ‰ç›¸å…³çŸ¥è¯†</li>
</ul>
<h4 data-id="heading-30">å¯¹ä¼ä¸šçº§AIåº”ç”¨æ¶æ„çš„å¯å‘</h4>
<p>Skillçš„è®¾è®¡æ¨¡å¼å¯¹ä¼ä¸šçº§AIåº”ç”¨æœ‰é‡è¦å¯å‘ï¼š</p>
<p><strong>1. çŸ¥è¯†èµ„äº§åŒ–</strong></p>
<p>ç»„ç»‡çš„éšæ€§çŸ¥è¯†å¯ä»¥é€šè¿‡Skillæ˜¾æ€§åŒ–ï¼š</p>
<ul>
<li>ç¼–ç è§„èŒƒ â†’ Code Review Skill</li>
<li>è¿ç»´æ‰‹å†Œ â†’ Operations Skill</li>
<li>ä¸šåŠ¡æµç¨‹ â†’ Business Process Skills</li>
</ul>
<p><strong>2. æ¸è¿›å¼AIé‡‡ç”¨</strong></p>
<p>Skillæä¾›äº†ä¸€æ¡ä½é£é™©çš„AIé‡‡ç”¨è·¯å¾„ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">é˜¶æ®µ1: åˆ›å»ºåªè¯»Skillï¼ˆä¿¡æ¯æŸ¥è¯¢ï¼‰</span>
    â†“
<span class="hljs-section">é˜¶æ®µ2: æ·»åŠ è¾…åŠ©è„šæœ¬ï¼ˆåŠè‡ªåŠ¨åŒ–ï¼‰</span>
    â†“
<span class="hljs-section">é˜¶æ®µ3: å®Œæ•´å·¥ä½œæµSkillï¼ˆå…¨è‡ªåŠ¨åŒ–ï¼‰</span>
</code></pre>
<p><strong>3. çŸ¥è¯†æ²»ç†</strong></p>
<p>é€šè¿‡Skillçš„ç‰ˆæœ¬æ§åˆ¶å’Œæƒé™ç®¡ç†ï¼š</p>
<ul>
<li>å®¡è®¡çŸ¥è¯†å˜æ›´å†å²</li>
<li>æ§åˆ¶æ•æ„ŸçŸ¥è¯†è®¿é—®</li>
<li>æ ‡å‡†åŒ–çŸ¥è¯†åˆ†å‘</li>
</ul>
<hr/>
<h3 data-id="heading-31">ç»“è¯­</h3>
<p>Agent Skillsä»£è¡¨äº†AIç³»ç»Ÿæ¶æ„è®¾è®¡çš„ä¸€ç§æ–°æ€è·¯ï¼šé€šè¿‡å°†é¢†åŸŸçŸ¥è¯†å°è£…ä¸ºå¯ç»„åˆã€å¯å‘ç°ã€æ¸è¿›å¼åŠ è½½çš„æ¨¡å—ï¼Œè®©é€šç”¨Agentèƒ½å¤Ÿå¿«é€Ÿè½¬åŒ–ä¸ºä¸“ä¸šAgentã€‚</p>
<p>å¯¹äºå¼€å‘è€…è€Œè¨€ï¼ŒSkillæä¾›äº†ä¸€ç§ä½é—¨æ§›ã€é«˜æ”¶ç›Šçš„æ–¹å¼æ¥å®šåˆ¶å’Œæ‰©å±•AIèƒ½åŠ›ã€‚ä½ ä¸éœ€è¦æ·±å…¥ç†è§£æ¨¡å‹å†…éƒ¨æœºåˆ¶ï¼Œåªéœ€è¦æŠŠä½ çš„ä¸“ä¸šçŸ¥è¯†ä»¥Markdownå½¢å¼ç¼–çº‚å‡ºæ¥ã€‚</p>
<p>å¯¹äºæ¶æ„å¸ˆè€Œè¨€ï¼ŒSkillå±•ç¤ºäº†ä¸€ç§ä¼˜é›…çš„å…³æ³¨ç‚¹åˆ†ç¦»æ¨¡å¼â€”â€”å°†çŸ¥è¯†ã€èƒ½åŠ›ã€æ¨ç†æ¸…æ™°è§£è€¦ï¼Œä¸ºæ„å»ºå¯ç»´æŠ¤ã€å¯æ¼”è¿›çš„AIç³»ç»Ÿæä¾›äº†å‚è€ƒã€‚</p>
<p>æœ€åï¼ŒSkillçš„æˆåŠŸéªŒè¯äº†ä¸€ä¸ªæœ´ç´ çš„è§‚ç‚¹ï¼š<strong>åœ¨AIæ—¶ä»£ï¼Œæœ€æœ‰ä»·å€¼çš„èµ„äº§ä¸æ˜¯æ•°æ®æœ¬èº«ï¼Œè€Œæ˜¯å°†æ•°æ®è½¬åŒ–ä¸ºè¡ŒåŠ¨çš„ç¨‹åºæ€§çŸ¥è¯†</strong>ã€‚é‚£äº›èƒ½å¤Ÿç³»ç»ŸåŒ–ç¼–çº‚å’Œç®¡ç†è¿™ç±»çŸ¥è¯†çš„ç»„ç»‡ï¼Œå°†åœ¨AIèµ‹èƒ½çš„ç«äº‰ä¸­å æ®ä¼˜åŠ¿ã€‚</p>
<hr/>
<h3 data-id="heading-32">å‚è€ƒèµ„æ–™</h3>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.claude.com%2Fdocs%2Fen%2Fagents-and-tools%2Fagent-skills%2Foverview" target="_blank" title="https://platform.claude.com/docs/en/agents-and-tools/agent-skills/overview" ref="nofollow noopener noreferrer">Agent Skills Overview - Claude Documentation</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anthropic.com%2Fengineering%2Fequipping-agents-for-the-real-world-with-agent-skills" target="_blank" title="https://www.anthropic.com/engineering/equipping-agents-for-the-real-world-with-agent-skills" ref="nofollow noopener noreferrer">Equipping agents for the real world with Agent Skills - Anthropic Engineering Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fsupport.claude.com%2Fen%2Farticles%2F12512198-how-to-create-custom-skills" target="_blank" title="https://support.claude.com/en/articles/12512198-how-to-create-custom-skills" ref="nofollow noopener noreferrer">How to create custom Skills - Claude Help Center</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.claude.com%2Fdocs%2Fen%2Fskills" target="_blank" title="https://code.claude.com/docs/en/skills" ref="nofollow noopener noreferrer">Agent Skills in Claude Code</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fagentskills.io" target="_blank" title="https://agentskills.io" ref="nofollow noopener noreferrer">Agent Skills Open Standard</a></li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆä¸€ä¸ªé¡¹çº§çš„ Java Multi Agent å¼€æºé¡¹ç›®]]></title>    <link>https://juejin.cn/post/7596507469884194831</link>    <guid>https://juejin.cn/post/7596507469884194831</guid>    <pubDate>2026-01-19T06:57:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596507469884194831" data-draft-id="7596306552220860431" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆä¸€ä¸ªé¡¹çº§çš„ Java Multi Agent å¼€æºé¡¹ç›®"/> <meta itemprop="keywords" content="Java,Agent"/> <meta itemprop="datePublished" content="2026-01-19T06:57:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‰é±¼çš„çŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/409464125003639"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆä¸€ä¸ªé¡¹çº§çš„ Java Multi Agent å¼€æºé¡¹ç›®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/409464125003639/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‰é±¼çš„çŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T06:57:39.000Z" title="Mon Jan 19 2026 06:57:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    23
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ å¥½ï¼Œæˆ‘æ˜¯é˜¿é¦™ã€‚</p>
<p>å‰å‡ å¤©ï¼ŒæŠ€æœ¯ç¾¤é‡Œçš„å°ä¼™ä¼´ä¸€ç›´åœ¨å®‰åˆ© Solon AIã€‚èµ·åˆæˆ‘è¿˜åœ¨æƒ³ï¼ŒJava ç”Ÿæ€é‡Œä¸æ˜¯å·²ç»æœ‰ Spring AI äº†å—ï¼Ÿå‡ºäºå¥½å¥‡ï¼Œæˆ‘æŠ½ç©ºæ·±å…¥ç ”ç©¶äº†ä¸€æ³¢ï¼Œç»“æœçœŸé¦™äº†ï¼</p>
<p>è¿™ä¸ä»…æ˜¯ä¸€ä¸ª AI æ¡†æ¶ï¼Œå®ƒæ›´åƒæ˜¯ä¸º Java å¼€å‘è€…é‡èº«å®šåˆ¶çš„ â€œæ™ºèƒ½ä½“æŒ‡æŒ¥éƒ¨â€ã€‚ä»Šå¤©å°±æ¥èŠèŠè¿™ä¸ªè®©æˆ‘çœ¼å‰ä¸€äº®çš„é¡¶çº§ Java Multi-Agent å¼€æºé¡¹ç›®ã€‚</p>
<hr/>
<h3 data-id="heading-0">ä»€ä¹ˆæ˜¯ Solon AIï¼Ÿ</h3>
<p>ç®€å•æ¥è¯´ï¼ŒSolon AI æ˜¯ Solon ç”Ÿæ€ä¸­ä¸“æ³¨ AI åº”ç”¨å¼€å‘çš„è½»é‡çº§æ¡†æ¶ã€‚å¦‚æœè¯´å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æ˜¯ AI çš„å¤§è„‘ï¼Œé‚£ä¹ˆ Solon AI å°±æ˜¯å®ƒçš„ â€œç¥ç»ä¸­æ¢â€ å’Œ â€œæ‹“æ‰‘æŒ‡æŒ¥å®˜â€ã€‚</p>
<p>å®ƒä¸ä»…ä»…æä¾›äº†å¤šæ™ºèƒ½ä½“åä½œçš„æ¶æ„ï¼Œå…¶æ ¸å¿ƒç«äº‰åŠ›åœ¨äºï¼šæè‡´çš„è½»é‡åŒ–ã€å¤šåè®®ç¼–æ’èƒ½åŠ›ä»¥åŠå¤©ç„¶çš„å¾®æœåŠ¡åŸºå› ã€‚</p>
<hr/>
<h3 data-id="heading-1">Solon AI ä¸ Spring AI æœ‰å“ªäº›ä¸åŒï¼Ÿ</h3>
<p>å¾ˆå¤šå°ä¼™ä¼´ä¼šé—®ï¼šâ€œæ—¢ç„¶æœ‰äº† Spring AIï¼Œæˆ‘ä¸ºä»€ä¹ˆè¦çœ‹ Solon AIï¼Ÿâ€</p>
<p>ä¸¤è€…çš„è®¾è®¡å“²å­¦å®Œå…¨ä¸åŒï¼š</p>
<ul>
<li><strong>Spring AI</strong>ï¼šæ›´åƒæ˜¯ä¸€ä¸ªâ€œé›†æˆå•†â€ï¼Œä¾§é‡äºæŠŠ LLM åŒ…è£…æˆä¸€ç§èµ„æºï¼ˆå¦‚ Data Source ä¸€æ ·ï¼‰èå…¥ Spring ä¸šåŠ¡æµã€‚å®ƒæ“…é•¿çš„æ˜¯ç®€å•çš„ RAG å’ŒèŠå¤©ã€‚</li>
<li><strong>Solon AI</strong>ï¼šåŸç”Ÿä¸º Agenticï¼ˆæ™ºèƒ½ä½“ï¼‰èŒƒå¼ è€Œç”Ÿã€‚å®ƒå¼ºè°ƒçš„æ˜¯â€œåè®®ï¼ˆProtocolï¼‰â€ï¼Œé€šè¿‡å¤šç§å›¢é˜Ÿåè®®ï¼ˆTeamProtocolsï¼‰å†³å®šä»»åŠ¡å¦‚ä½•åœ¨ Agent é—´æµè½¬ã€‚å®ƒæ›´é€‚åˆæ„å»ºåƒâ€œè‡ªåŠ¨åŒ–è½¯ä»¶å…¬å¸â€ã€â€œå¤æ‚é£æ§åšå¼ˆâ€è¿™ç§éœ€è¦å¤šæ™ºèƒ½ä½“æ·±åº¦åä½œçš„åº”ç”¨ã€‚</li>
</ul>
<p>å°±åƒæˆ‘å¸¸è¯´çš„ï¼šâ€œæ²¡æœ‰é“¶å¼¹ï¼Œé€‰é€‚åˆè‡ªå·±çš„â€ã€‚å¦‚æœä½ è¿½æ±‚æ¯«ç§’çº§å¯åŠ¨ã€è¿½æ±‚å¯¹åä½œé€»è¾‘çš„ç²¾ç»†æ§åˆ¶ï¼ŒSolon AI ä¼šè®©ä½ çˆ½åˆ°é£èµ·ã€‚</p>
<hr/>
<h3 data-id="heading-2">Solon AI ä¸ºä»€ä¹ˆå¼ºï¼Ÿ</h3>
<ol>
<li><strong>å…«å¤§åä½œåè®®ï¼ˆTeamProtocolsï¼‰</strong>ï¼šè¿™æ˜¯å®ƒçš„æ€æ‰‹é”ã€‚ä»é¡ºåºæµï¼ˆSequentialï¼‰ã€å±‚çº§åˆ¶ï¼ˆHierarchicalï¼‰åˆ°å»ä¸­å¿ƒåŒ–çš„ç‚¹å¯¹ç‚¹ï¼ˆA2Aï¼‰å’Œæ¨¡æ‹Ÿç”Ÿç‰©é€»è¾‘çš„èœ‚ç¾¤åè®®ï¼ˆSwarmï¼‰ï¼Œå®ƒæŠŠå¤šæ™ºèƒ½ä½“åä½œç©å‡ºäº†èŠ±ã€‚</li>
<li><strong>æ­»å¾ªç¯ç†”æ–­æœºåˆ¶</strong>ï¼šç‹¬åˆ›çš„â€œä¿¡æ¯ç´ æƒ©ç½šâ€æœºåˆ¶ï¼Œèƒ½è‡ªåŠ¨å‘ç°å¹¶æ‹¦æˆªæ™ºèƒ½ä½“ä¹‹é—´çš„â€œè¸¢çš®çƒâ€è¡Œä¸ºï¼Œé˜²æ­¢ Token åœ¨æ­»å¾ªç¯ä¸­ç™½ç™½ç‡ƒçƒ§ã€‚</li>
<li><strong>ç¡®å®šæ€§ä¿éšœ</strong>ï¼šå†…ç½® TeamTrace æº¯æºã€‚Agent ä¹‹é—´æ€ä¹ˆæ²Ÿé€šçš„ã€è°åœ¨æ‘¸é±¼ã€è°åœ¨èƒ¡è¨€ä¹±è¯­ï¼Œè·¯å¾„å›æ”¾å¾—æ¸…æ¸…æ¥šæ¥šã€‚</li>
<li>J<strong>ava åŸç”Ÿå‹å¥½</strong>ï¼šåˆ©ç”¨ <code>@ToolMapping</code> æ³¨è§£ï¼Œç›´æ¥æŠŠä½ çš„ Java æ–¹æ³•å˜æˆ Agent çš„æŠ€èƒ½ï¼Œé…åˆ ONode è¿›è¡Œç»“æ„åŒ–æ•°æ®å¤„ç†ï¼Œå¯¹ Java å¼€å‘è€…æå…¶å‹å¥½ã€‚</li>
<li><strong>æè‡´æ€§èƒ½</strong>ï¼šå»¶ç»­äº† Solon æ¡†æ¶çš„åŸºå› ï¼ŒåŒ…ä½“ç§¯æå°ï¼Œå†·å¯åŠ¨é£å¿«ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-3">å¿«é€Ÿå…¥é—¨</h3>
<h4 data-id="heading-4">1) å¼•å…¥ä¾èµ–</h4>
<p>åœ¨ä½ çš„ pom.xml ä¸­å¼•å…¥ Solon AI çš„æ™ºèƒ½ä½“æ ¸å¿ƒåŒ…ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.noear<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>solon-ai-agent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h4 data-id="heading-5">2) åŸºç¡€æ™ºèƒ½ä½“åˆ›å»º</h4>
<p>åªéœ€å‡ è¡Œä»£ç ï¼Œå°±èƒ½åˆ›å»ºä¸€ä¸ªå…·å¤‡èº«ä»½æ„è¯†çš„ Agentã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åˆå§‹åŒ–æ¨¡å‹ï¼ˆæ”¯æŒ OpenAI, DeepSeek, Qwen ç­‰ï¼‰</span>
<span class="hljs-type">ChatModel</span> <span class="hljs-variable">chatModel</span> <span class="hljs-operator">=</span> LlmUtil.getChatModel();

<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªä¸“ä¸šåŠ©æ‰‹</span>
<span class="hljs-type">SimpleAgent</span> <span class="hljs-variable">assistant</span> <span class="hljs-operator">=</span> SimpleAgent.of(chatModel)
                .systemPrompt(SimpleSystemPrompt.builder()
                        .role(<span class="hljs-string">"Javaä¸“å®¶"</span>)
                        .instruction(<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªç²¾é€š Solon æ¡†æ¶çš„ Java ä¸“å®¶ã€‚"</span>)
                        .build())
                .build();

<span class="hljs-comment">// å¯¹è¯</span>
<span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> assistant.prompt(<span class="hljs-string">"Solon AI æ€ä¹ˆé€‰åä½œåè®®ï¼Ÿ"</span>).call().getContent();
System.out.println(result);
</code></pre>
<h4 data-id="heading-6">3) å·…å³°å¯¹å†³ï¼šå¤šæ™ºèƒ½ä½“åä½œï¼ˆTeamAgentï¼‰</h4>
<p>è¿™æ˜¯ Solon AI æœ€è¿·äººçš„åœ°æ–¹ã€‚æˆ‘ä»¬å¯ä»¥è½»æ˜“ç¼–æ’ä¸€ä¸ªæ™ºèƒ½ä½“åä½œçš„æ¢¦ä¹‹é˜Ÿã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testA2AFlowWithRole</span><span class="hljs-params">()</span> {
    <span class="hljs-type">ChatModel</span> <span class="hljs-variable">chatModel</span> <span class="hljs-operator">=</span> LlmUtil.getChatModel();

    <span class="hljs-comment">// 1. å‰ç«¯å¼€å‘è€…ï¼šè´Ÿè´£ç¼–å†™ä»£ç å¹¶â€œç§»äº¤â€</span>
    <span class="hljs-type">Agent</span> <span class="hljs-variable">webDeveloper</span> <span class="hljs-operator">=</span> SimpleAgent.of(chatModel).name(<span class="hljs-string">"WebDeveloper"</span>)
            .systemPrompt(SimpleSystemPrompt.builder()
                    .role(<span class="hljs-string">"èµ„æ·±å‰ç«¯å¼€å‘è€…"</span>)
                    .instruction(<span class="hljs-string">"ä»»åŠ¡ï¼šæ ¹æ®ç”¨æˆ·éœ€æ±‚ç¼–å†™å®Œæ•´çš„ HTML/JS ä»£ç ã€‚\n"</span> +
                                 <span class="hljs-string">"åä½œï¼šå†™å®Œåè¯·äº¤ç»™ Reviewer å®¡æŸ¥ä»£ç è´¨é‡ã€‚ç›´æ¥è¾“å‡ºä»£ç ï¼Œä¸è¦ç”¨ Markdown æ ¼å¼ã€‚"</span>)
                    .build())
            .build();

    <span class="hljs-comment">// 2. å®¡æŸ¥è€…ï¼šè´Ÿè´£è´¨é‡æŠŠå…³</span>
    <span class="hljs-type">Agent</span> <span class="hljs-variable">reviewer</span> <span class="hljs-operator">=</span> SimpleAgent.of(chatModel).name(<span class="hljs-string">"Reviewer"</span>)
            .systemPrompt(SimpleSystemPrompt.builder()
                    .role(<span class="hljs-string">"é¦–å¸­æ¶æ„å¸ˆ"</span>)
                    .instruction(<span class="hljs-string">"ä»»åŠ¡ï¼šå®¡æŸ¥ WebDeveloper æäº¤çš„ä»£ç ï¼ŒæŸ¥æ‰¾å®‰å…¨éšæ‚£å’Œæ€§èƒ½ç“¶é¢ˆã€‚\n"</span> +
                                 <span class="hljs-string">"åä½œï¼šå¦‚æœä»£ç åˆæ ¼ï¼Œè¯·äº¤ç»™ Archiver å½’æ¡£ï¼›å¦‚æœä¸åˆæ ¼ï¼Œè¯·æ‰“å›ç»™ WebDeveloperã€‚"</span>)
                    .build())
            .build();

    <span class="hljs-comment">// 3. å½’æ¡£å‘˜ï¼šè´Ÿè´£æ€»ç»“</span>
    <span class="hljs-type">Agent</span> <span class="hljs-variable">archiver</span> <span class="hljs-operator">=</span> SimpleAgent.of(chatModel).name(<span class="hljs-string">"Archiver"</span>)
            .systemPrompt(SimpleSystemPrompt.builder()
                    .role(<span class="hljs-string">"æ–‡æ¡£ç®¡ç†å‘˜"</span>)
                    .instruction(<span class="hljs-string">"ä»»åŠ¡ï¼šæ€»ç»“æœ€ç»ˆé€šè¿‡å®¡æŸ¥çš„ä»£ç åŠŸèƒ½ï¼Œå¹¶ç”Ÿæˆå”¯ä¸€çš„ç‰ˆæœ¬å¿«ç…§ç¼–å·ã€‚"</span>)
                    .build())
            .build();

    <span class="hljs-comment">// ç¼–æ’ A2A å›¢é˜Ÿ</span>
    <span class="hljs-type">TeamAgent</span> <span class="hljs-variable">devTeam</span> <span class="hljs-operator">=</span> TeamAgent.of(chatModel)
            .protocol(TeamProtocols.A2A) <span class="hljs-comment">// æ ¸å¿ƒï¼šå¼€å¯ç‚¹å¯¹ç‚¹ç›´è¿åè®®</span>
            .agentAdd(webDeveloper, reviewer, archiver)
            .maxTurns(<span class="hljs-number">6</span>) <span class="hljs-comment">// å…œåº•ï¼šé˜²æ­¢ Reviewer å’Œ Developer é™·å…¥æ— é™æ”¹ Bug å¾ªç¯</span>
            .build();

    <span class="hljs-comment">// æ‰§è¡Œä»»åŠ¡</span>
    <span class="hljs-type">AgentSession</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> InMemoryAgentSession.of(<span class="hljs-string">"project_v1"</span>);
    <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> devTeam.call(Prompt.of(<span class="hljs-string">"å¸®æˆ‘å†™ä¸€ä¸ªå®ç°ç‚¹å‡»æŒ‰é’®æ¢èƒŒæ™¯é¢œè‰²çš„ç½‘é¡µ"</span>), session).getContent();

    <span class="hljs-comment">// æº¯æºï¼šä½ ä¼šçœ‹åˆ° WebDeveloper -&gt; Reviewer -&gt; Archiver çš„é—ªç”µæ¥åŠ›</span>
    <span class="hljs-type">TeamTrace</span> <span class="hljs-variable">trace</span> <span class="hljs-operator">=</span> devTeam.getTrace(session);
    System.out.println(<span class="hljs-string">"åšå¼ˆé“¾è·¯: "</span> + trace.getRecords().stream().map(r -&gt; r.getSource()).toList());
    System.out.println(<span class="hljs-string">"æœ€ç»ˆäº¤ä»˜æˆæœï¼š\n"</span> + result);
}
</code></pre>
<p>è¿›é˜¶èƒ½åŠ›ï¼šä¸åªæ˜¯åä½œ</p>
<ul>
<li><strong>A2Aï¼ˆAgent-to-Agentï¼‰åè®®</strong>ï¼šæ”¯æŒ Agent ä¹‹é—´çš„â€œç›´æ¥ç§»äº¤â€ã€‚å½“ A å¤„ç†ä¸äº†æ—¶ï¼Œå®ƒå¯ä»¥ç›´æ¥æŠŠä»»åŠ¡â€œç”©â€ç»™ Bï¼Œå“åº”é€Ÿåº¦æå¿«ã€‚</li>
<li><strong>ç»“æ„åŒ–è¾“å‡ºæ§åˆ¶</strong>ï¼šé€šè¿‡ ONode é…åˆ Prompt çº¦æŸï¼ŒSolon AI èƒ½æŠŠ AI é‚£äº›å¤©é©¬è¡Œç©ºçš„å›å¤ï¼Œç²¾å‡†è§£ææˆä½  Java é‡Œçš„ POJO å¯¹è±¡ã€‚</li>
<li><strong>è·¯å¾„æ–­è¨€å•æµ‹</strong>ï¼šä½ å¯ä»¥åƒå†™ JUnit ä¸€æ ·å†™ Agent æµ‹è¯•ã€‚ä¸åªæ˜¯æ–­è¨€ç»“æœå­—ç¬¦ä¸²ï¼Œè€Œæ˜¯æ–­è¨€æ‰§è¡Œè®°å½•ï¼š</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">assert</span> team.getTrace(session).getRecords().stream()
                .anyMatch(s -&gt; ContractNetProtocol.ID_BIDDING.equals(s.getSource()))ã€‚
</code></pre>
<hr/>
<h3 data-id="heading-7">æ€»ç»“</h3>
<p>ç ”ç©¶å®Œ Solon AI åï¼Œæˆ‘æœ€å¤§çš„æ„Ÿå—æ˜¯ï¼šAI åº”ç”¨å¼€å‘æ­£åœ¨ä»â€œå•å…µä½œæˆ˜â€è½¬å‘â€œå…µå›¢ä½œæˆ˜â€ã€‚</p>
<p>Solon AI çš„å‡ºç°ï¼Œç»™äº† Java å¼€å‘è€…ä¸€ä¸ªå¼ºå¤§çš„æ­¦å™¨åº“ï¼š</p>
<ol>
<li>ä¸å†éœ€è¦ç¾¡æ…• Python ç”Ÿæ€ï¼šJava åŒæ ·èƒ½ä¼˜é›…åœ°ç©è½¬ Multi-Agentã€‚</li>
<li>å·¥ç¨‹åŒ–ç¨‹åº¦æé«˜ï¼šå®ƒè§£å†³äº† AI è¾“å‡ºä¸å¯æ§ã€åä½œè¿‡ç¨‹é»‘ç›’ç­‰ç”Ÿäº§ç—›ç‚¹ã€‚</li>
<li>å¾®æœåŠ¡å¤©ç„¶é›†æˆï¼šæ¯ä¸€ä¸ª Team éƒ½å¯ä»¥æ˜¯ä¸€ä¸ªå¾®æœåŠ¡ï¼Œè¿™å¤ªç¬¦åˆä¼ä¸šçº§æ¶æ„çš„æ¼”è¿›æ–¹å‘äº†ã€‚</li>
</ol>
<p>å¦‚æœä½ æ­£å‡†å¤‡åœ¨ Java é¡¹ç›®é‡Œæ¥å…¥ Agentï¼ŒSolon AI ç»å¯¹å€¼å¾—ä½ åŠ å…¥ Star åˆ—è¡¨ã€‚</p>
<p>Github åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fnoear%2Fsolon-ai" target="_blank" title="https://github.com/noear/solon-ai" ref="nofollow noopener noreferrer">github.com/noear/solonâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Gemini 3 Proæ¥äº†ï¼Googleæœ€å¼ºAIï¼Œä½†ç”¨æˆ·è¯´"æœ‰ç‚¹ç¿»è½¦"ï¼ŸğŸ¤”]]></title>    <link>https://juejin.cn/post/7596670644285767680</link>    <guid>https://juejin.cn/post/7596670644285767680</guid>    <pubDate>2026-01-19T07:07:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596670644285767680" data-draft-id="7596670644285734912" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Gemini 3 Proæ¥äº†ï¼Googleæœ€å¼ºAIï¼Œä½†ç”¨æˆ·è¯´&quot;æœ‰ç‚¹ç¿»è½¦&quot;ï¼ŸğŸ¤”"/> <meta itemprop="keywords" content="GitHub"/> <meta itemprop="datePublished" content="2026-01-19T07:07:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Maynoråœ¨æ˜é‡‘"/> <meta itemprop="url" content="https://juejin.cn/user/1451011082027416"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Gemini 3 Proæ¥äº†ï¼Googleæœ€å¼ºAIï¼Œä½†ç”¨æˆ·è¯´"æœ‰ç‚¹ç¿»è½¦"ï¼ŸğŸ¤”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1451011082027416/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Maynoråœ¨æ˜é‡‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T07:07:45.000Z" title="Mon Jan 19 2026 07:07:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Gemini 3 Proæ¥äº†ï¼Googleæœ€å¼ºAIï¼Œä½†ç”¨æˆ·è¯´"æœ‰ç‚¹ç¿»è½¦"ï¼ŸğŸ¤”</h2>
<p>å®¶äººä»¬ï¼ŒGoogleåœ¨2025å¹´11æœˆæ”¾äº†ä¸ªå¤§æ‹›â€”â€”<strong>Gemini 3 Pro</strong>ï¼</p>
<p>åŸºå‡†æµ‹è¯•æ•°æ®ç‚¸è£‚ï¼šæ•°å­¦æ¨ç†ç¢¾å‹GPT-5ï¼Œå¤šæ¨¡æ€ç†è§£åŠæ‰“Claudeï¼ŒARC-AGIä»4.9%ç›´æ¥é£™åˆ°31.1%â€¦â€¦çœ‹èµ·æ¥æ˜¯è¦ç»Ÿæ²»AIç•Œçš„èŠ‚å¥ã€‚</p>
<p>ä½†ç­‰ç­‰ï¼ŒRedditã€Hacker Newsä¸Šçš„çœŸå®ç”¨æˆ·å´è¯´ï¼š"<strong>åŸºå‡†å¾ˆå¼ºï¼Œå®é™…ç¿»è½¦</strong>"ï¼Ÿ</p>
<p>æœ‰äººè¯´å®ƒæ˜¯"æœ€å¼ºç¼–ç æ¨¡å‹"ï¼Œä¹Ÿæœ‰äººåæ§½"é•¿å¯¹è¯ç›´æ¥å¤±å¿†"ã€‚æœ‰äººç”¨å®ƒ30åˆ†é’Ÿé‡å†™è®ºæ–‡æ‹¿A-ï¼Œä¹Ÿæœ‰äººæŠ±æ€¨"é…é¢ä¸‹é™92%ï¼Œæ ¹æœ¬ç”¨ä¸äº†"ã€‚</p>
<p><strong>åˆ°åº•æ˜¯çœŸé¦™è¿˜æ˜¯çœŸå‘ï¼Ÿ</strong> ä»Šå¤©æˆ‘ä»¬åŸºäºæœ€æ–°çš„ç”¨æˆ·åé¦ˆï¼Œå®¢è§‚èŠèŠGemini 3 Proçš„çœŸå®è¡¨ç°ã€‚</p>
<hr/>
<h3 data-id="heading-1">ğŸ¯ Gemini 3 Proæ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>Gemini 3 Proæ˜¯Googleåœ¨2025å¹´11æœˆ18æ—¥å‘å¸ƒçš„æ——èˆ°AIæ¨¡å‹ï¼Œå·ç§°"å²ä¸Šæœ€æ™ºèƒ½"ã€‚</p>
<h4 data-id="heading-2">æ ¸å¿ƒæ•°æ®</h4>

































<table><thead><tr><th>ç‰¹æ€§</th><th>æ•°æ®</th></tr></thead><tbody><tr><td><strong>å‘å¸ƒæ—¶é—´</strong></td><td>2025å¹´11æœˆ18æ—¥</td></tr><tr><td><strong>ä¸Šä¸‹æ–‡é•¿åº¦</strong></td><td>1M tokensï¼ˆ100ä¸‡ï¼‰</td></tr><tr><td><strong>å¤šæ¨¡æ€</strong></td><td>æ–‡æœ¬+å›¾åƒ+è§†é¢‘+éŸ³é¢‘+ä»£ç </td></tr><tr><td><strong>æ¨ç†èƒ½åŠ›</strong></td><td>ARC-AGI 31.1%ï¼ˆå‰ä»£4.9%ï¼‰</td></tr><tr><td><strong>ç¼–ç èƒ½åŠ›</strong></td><td>SWE-bench 76.2%ï¼ˆæå‡35%+ï¼‰</td></tr><tr><td><strong>ä»·æ ¼</strong></td><td>å…è´¹ç‰ˆæœ‰é™ï¼ŒProç‰ˆ$20/æœˆ</td></tr></tbody></table>
<p><strong>æœ€å¤§äº®ç‚¹</strong>ï¼š</p>
<ul>
<li>â€¢ å¤šæ¨¡æ€ä¹‹ç‹ï¼šèƒ½å¤„ç†è§†é¢‘ã€éŸ³é¢‘ã€PDFã€æ•´ä¸ªä»£ç ä»“åº“</li>
<li>â€¢ æ¨ç†èƒ½åŠ›çˆ†è¡¨ï¼šåœ¨"äººç±»æœ€åè€ƒè¯•"åŸºå‡†ä¸Šç¢¾å‹æ‰€æœ‰å¯¹æ‰‹</li>
<li>â€¢ è¶…é•¿ä¸Šä¸‹æ–‡ï¼š1M tokensï¼Œç›¸å½“äº750æœ¬ä¹¦</li>
</ul>
<p>å¬èµ·æ¥å®Œç¾ï¼Ÿæˆ‘ä»¬çœ‹çœ‹çœŸå®ç”¨æˆ·æ€ä¹ˆè¯´ã€‚</p>
<hr/>
<h3 data-id="heading-3">âœ… ç”¨æˆ·çœŸå®åé¦ˆï¼šä¼˜ç‚¹ç¯‡</h3>
<h4 data-id="heading-4">1. å¤šæ¨¡æ€èƒ½åŠ›ç¡®å®å¼ºåˆ°ç¦»è°±</h4>
<p><strong>çœŸå®æ¡ˆä¾‹</strong>ï¼ˆæ¥è‡ªRedditç”¨æˆ·ï¼‰ï¼š</p>
<blockquote>
<p>"æˆ‘ä¸Šä¼ äº†ä¸€ç¯‡æ‰©æ•£æ¨¡å‹è®ºæ–‡ï¼Œé‡Œé¢æœ‰å¤æ‚çš„å…¬å¼å’Œå›¾è¡¨ã€‚Gemini 3 Proä¸ä»…æ€»ç»“äº†å†…å®¹ï¼Œè¿˜æŒ‡å‡ºäº†æˆ‘å¯¹'æ¡ä»¶æ‰©æ•£'çš„ç†è§£é”™è¯¯ã€‚è¿™æ˜¯å…¶ä»–AIåšä¸åˆ°çš„ã€‚"</p>
</blockquote>
<p><strong>å¦ä¸€ä¸ªæ¡ˆä¾‹</strong>ï¼š</p>
<blockquote>
<p>"æˆ‘ä¸Šä¼ äº†20åˆ†é’Ÿçš„æŠ€æœ¯è§†é¢‘ï¼Œå®ƒä¸ä»…åˆ†æäº†å…³é”®å¸§ï¼Œè¿˜è¿½è¸ªäº†ä»£ç bugï¼Œæå‡ºäº†ä¿®å¤æ–¹æ¡ˆã€‚è¿™å¤ªç–¯ç‹‚äº†ï¼"</p>
</blockquote>
<p><strong>ç”¨æˆ·è¯„ä»·</strong>ï¼š</p>
<ul>
<li>â€¢ â­â­â­â­â­ è§†é¢‘ç†è§£ï¼šèƒ½è¿½è¸ªæ—¶åºã€è¯†åˆ«è¯´è¯è€…ã€ç†è§£åŠ¨æ€ä¸Šä¸‹æ–‡</li>
<li>â€¢ â­â­â­â­â­ å›¾åƒç†è§£ï¼šä»æ‰‹ç»˜è‰å›¾ç”Ÿæˆå®Œæ•´ç½‘ç«™</li>
<li>â€¢ â­â­â­â­â­ æ–‡æ¡£ç†è§£ï¼šå¤„ç†å¤æ‚PDFã€å›¾è¡¨ã€å…¬å¼</li>
</ul>
<p><strong>ç»“è®º</strong>ï¼šå¤šæ¨¡æ€èƒ½åŠ›ç¡®å®æ˜¯ç›®å‰æœ€å¼ºï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚</p>
<h4 data-id="heading-5">2. ç¼–ç èƒ½åŠ›å¤§å¹…æå‡</h4>
<p><strong>çœŸå®æ¡ˆä¾‹</strong>ï¼ˆæ¥è‡ªHacker Newsï¼‰ï¼š</p>
<blockquote>
<p>"æˆ‘ç”¨Gemini CLIè®©å®ƒç”Ÿæˆé‡‘é—¨å¤§æ¡¥çš„3D Voxelæ¨¡æ‹Ÿï¼Œä»å•ä¸€æç¤ºå°±ç”Ÿæˆäº†å®Œæ•´å¯è¿è¡Œçš„ä»£ç ã€‚è¿™åœ¨ä»¥å‰æ˜¯ä¸å¯èƒ½çš„ã€‚"</p>
</blockquote>
<p><strong>æ•°æ®æ”¯æ’‘</strong>ï¼š</p>
<ul>
<li>â€¢ SWE-bench Verifiedå¾—åˆ†76.2%ï¼ˆå‰ä»£çº¦40%ï¼‰</li>
<li>â€¢ è§£å†³çœŸå®è½¯ä»¶å·¥ç¨‹é—®é¢˜å‡†ç¡®ç‡æå‡35%+</li>
</ul>
<p><strong>ç”¨æˆ·è¯„ä»·</strong>ï¼š</p>
<ul>
<li>â€¢ âœ… æ“…é•¿ï¼šå¤æ‚é€»è¾‘ã€å¤§å‹ä»£ç åº“ã€å‰ç«¯å¼€å‘</li>
<li>â€¢ âœ… ç‰¹ç‚¹ï¼šèƒ½å®¡è§†æ•´ä¸ªä»“åº“æ¶æ„ï¼Œæå‡ºæ”¹è¿›å»ºè®®</li>
<li>â€¢ âœ… å·¥å…·ï¼šGemini CLIã€Code Assistè¡¨ç°å‡ºè‰²</li>
</ul>
<p><strong>ç»“è®º</strong>ï¼šç¼–ç èƒ½åŠ›ç¡®å®æœ‰è´¨çš„é£è·ƒï¼Œå°¤å…¶æ˜¯agentic codingï¼ˆä»£ç†å¼ç¼–ç ï¼‰ã€‚</p>
<h4 data-id="heading-6">3. å­¦æœ¯ç§‘ç ”çš„å¥½å¸®æ‰‹</h4>
<p><strong>çœŸå®æ¡ˆä¾‹</strong>ï¼ˆæ¥è‡ªç”¨æˆ·åé¦ˆï¼‰ï¼š</p>
<blockquote>
<p>"æˆ‘ç”¨Deep ResearchåŠŸèƒ½åšæ–‡çŒ®ç»¼è¿°ï¼Œä¸€æ¬¡æ€§æ‰«æäº†å‡ åç¯‡è®ºæ–‡ï¼Œç”Ÿæˆäº†ç»“æ„åŒ–æŠ¥å‘Šå’Œå‚è€ƒåˆ—è¡¨ã€‚æ–‡çŒ®ç»¼è¿°ä»å‡ å¤©å‹ç¼©åˆ°å‡ å°æ—¶ã€‚"</p>
</blockquote>
<p><strong>å¦ä¸€ä¸ªæ¡ˆä¾‹</strong>ï¼š</p>
<blockquote>
<p>"æ•™æˆä¸´æ—¶æ”¹äº†è®ºæ–‡æ ¼å¼è¦æ±‚ï¼Œæˆ‘ç”¨Gemini 3 Proåœ¨30åˆ†é’Ÿå†…é‡å†™äº†æ•´ç¯‡è®ºæ–‡ï¼Œæœ€åæ‹¿äº†A-ã€‚"</p>
</blockquote>
<p><strong>ç”¨æˆ·è¯„ä»·</strong>ï¼š</p>
<ul>
<li>â€¢ âœ… èŠ‚çœæ—¶é—´ï¼šæ–‡çŒ®ç»¼è¿°æ•ˆç‡æå‡10å€+</li>
<li>â€¢ âœ… å¤šæ¨¡æ€ï¼šèƒ½è¯»æ‡‚è®ºæ–‡ä¸­çš„å›¾è¡¨å’Œå…¬å¼</li>
<li>â€¢ âœ… Deep Researchï¼šç”Ÿæˆå¸¦DOIçš„å‚è€ƒåˆ—è¡¨</li>
</ul>
<p><strong>ç»“è®º</strong>ï¼šå­¦æœ¯ç§‘ç ”é¢†åŸŸçš„æ•ˆç‡æå‡æ˜æ˜¾ï¼Œå°¤å…¶æ˜¯æ–‡çŒ®å¤„ç†ã€‚</p>
<h4 data-id="heading-7">4. æ¨ç†èƒ½åŠ›ç¡®å®ç¢¾å‹å¯¹æ‰‹</h4>
<p><strong>åŸºå‡†æ•°æ®</strong>ï¼š</p>
<ul>
<li>â€¢ "Humanity's Last Exam"ï¼ˆäººç±»æœ€åè€ƒè¯•ï¼‰ï¼šå¤§å¹…é¢†å…ˆGPT-5å’ŒClaude</li>
<li>â€¢ ARC-AGIï¼ˆæŠ½è±¡æ¨ç†ï¼‰ï¼šä»4.9%æå‡åˆ°31.1%</li>
<li>â€¢ æ•°å­¦æ¨ç†ï¼šåœ¨å¤æ‚é—®é¢˜ä¸Šè¡¨ç°çªå‡º</li>
</ul>
<p><strong>ç”¨æˆ·è¯„ä»·</strong>ï¼š</p>
<blockquote>
<p>"Deep Thinkæ¨¡å¼ä¸‹ï¼Œå®ƒèƒ½å¤„ç†æéš¾çš„æ•°å­¦å’Œé€»è¾‘é—®é¢˜ã€‚æ€è€ƒé“¾å¾ˆé•¿ï¼Œä½†ç»“æœç¡®å®å‡†ç¡®ã€‚"</p>
</blockquote>
<p><strong>ç»“è®º</strong>ï¼šåœ¨éœ€è¦æ·±åº¦æ¨ç†çš„ä»»åŠ¡ä¸Šï¼ŒGemini 3 Proç¡®å®æ˜¯ç›®å‰æœ€å¼ºçš„ã€‚</p>
<hr/>
<h3 data-id="heading-8">âŒ ç”¨æˆ·çœŸå®åé¦ˆï¼šæ§½ç‚¹ç¯‡</h3>
<p>ä½†æ˜¯ï¼çœŸå®ç”¨æˆ·ä¹Ÿå‘ç°äº†ä¸å°‘é—®é¢˜ã€‚</p>
<h4 data-id="heading-9">1. é•¿ä¸Šä¸‹æ–‡"å¤±å¿†"ä¸¥é‡</h4>
<p><strong>è¿™æ˜¯ç›®å‰æŠ•è¯‰æœ€å¤šçš„é—®é¢˜ï¼</strong></p>
<p><strong>çœŸå®åæ§½</strong>ï¼ˆæ¥è‡ªRedditï¼‰ï¼š</p>
<blockquote>
<p>"å¯¹è¯è¶…è¿‡10è½®åï¼Œå®ƒå°±å¼€å§‹'å¿˜è®°'ä¹‹å‰çš„å†…å®¹ã€‚æˆ‘ä¸Šä¼ äº†PDFï¼ŒèŠäº†å‡ è½®åï¼Œå®ƒè¯´'ä½ æ²¡æœ‰ä¸Šä¼ æ–‡ä»¶'ã€‚è¿™æ˜¯ä»€ä¹ˆé¬¼ï¼Ÿ"</p>
</blockquote>
<p><strong>å¦ä¸€ä¸ªåæ§½</strong>ï¼š</p>
<blockquote>
<p>"å·ç§°1M tokensä¸Šä¸‹æ–‡ï¼Œä½†å®é™…è¡¨ç°è¿˜ä¸å¦‚Gemini 2.5 Proã€‚é•¿å¯¹è¯ç›´æ¥å´©ç›˜ã€‚"</p>
</blockquote>
<p><strong>ç”¨æˆ·è¯„ä»·</strong>ï¼š</p>
<ul>
<li>â€¢ âŒ é•¿å¯¹è¯ï¼ˆ&gt;10è½®ï¼‰ï¼šç»å¸¸"å¿˜è®°"æ—©æœŸå†…å®¹</li>
<li>â€¢ âŒ æ–‡ä»¶ä¸Šä¼ ï¼šå¤„ç†å¤§æ–‡ä»¶åå®¹æ˜“æ£€ç´¢å¤±è´¥</li>
<li>â€¢ âŒ å¯¹æ¯”ï¼šå¾ˆå¤šäººè§‰å¾—2.5 Proåœ¨é•¿ä¸Šä¸‹æ–‡ä¸Šæ›´ç¨³å®š</li>
</ul>
<p><strong>ç»“è®º</strong>ï¼šé•¿ä¸Šä¸‹æ–‡æ˜¯ç›®å‰æœ€å¤§çš„bugï¼ŒGoogleéœ€è¦å°½å¿«ä¿®å¤ã€‚</p>
<h4 data-id="heading-10">2. è¿‡äº"è‡ªä½œä¸»å¼ "</h4>
<p><strong>çœŸå®åæ§½</strong>ï¼š</p>
<blockquote>
<p>"æˆ‘è®©å®ƒé‡æ„ä¸€ä¸ªæ–‡ä»¶ï¼Œå®ƒå´å®¡è§†äº†æ•´ä¸ªä»£ç åº“ï¼Œè¿˜è‡ªå·±æ·»åŠ äº†ä¸€å †æˆ‘æ²¡è¦æ±‚çš„åŠŸèƒ½ã€‚åƒä¸ªå¤±æœ›çš„å®¶é•¿åœ¨æ‰¹è¯„æˆ‘çš„æ¶æ„ã€‚"</p>
</blockquote>
<p><strong>å¦ä¸€ä¸ªåæ§½</strong>ï¼š</p>
<blockquote>
<p>"å®ƒä¸å¬æŒ‡ä»¤ï¼Œæ€»æ˜¯è‡ªå·±æ·»åŠ å¤šä½™å†…å®¹ã€‚æˆ‘è¦ç®€çŸ­å›ç­”ï¼Œå®ƒç»™æˆ‘å†™äº†ä¸€ç¯‡è®ºæ–‡ã€‚"</p>
</blockquote>
<p><strong>ç”¨æˆ·è¯„ä»·</strong>ï¼š</p>
<ul>
<li>â€¢ âŒ æŒ‡ä»¤éµå¾ªï¼šæ¯”2.5 Proå·®</li>
<li>â€¢ âŒ è¿‡åº¦æ€è€ƒï¼šé™·å…¥é€’å½’æ€è€ƒæ­»å¾ªç¯</li>
<li>â€¢ âŒ è¾“å‡ºå†—é•¿ï¼šä»£ç å’Œæ–‡æœ¬éƒ½æ¯”è¾ƒ"bloated"</li>
</ul>
<p><strong>ç»“è®º</strong>ï¼šéœ€è¦æ›´å¼ºç¡¬çš„promptæ‰èƒ½æ§åˆ¶å®ƒï¼Œæ–°æ‰‹å¯èƒ½ä¼šå¾ˆå¤´ç–¼ã€‚</p>
<h4 data-id="heading-11">3. é…é¢å’Œç¨³å®šæ€§é—®é¢˜</h4>
<p><strong>çœŸå®åæ§½</strong>ï¼š</p>
<blockquote>
<p>"å…è´¹ç‰ˆé…é¢ä¸‹é™äº†92%ï¼ä»¥å‰èƒ½ç”¨ä¸€æ•´å¤©ï¼Œç°åœ¨å‡ ä¸ªé—®é¢˜å°±ç”¨å®Œäº†ã€‚"</p>
</blockquote>
<p><strong>å¦ä¸€ä¸ªåæ§½</strong>ï¼š</p>
<blockquote>
<p>"æˆ‘æ˜¯Proè®¢é˜…ç”¨æˆ·ï¼Œä½†ç»å¸¸é‡åˆ°'ä»Šå¤©çªç„¶ä¸å¯ç”¨'çš„æƒ…å†µã€‚è¿™æ˜¯ä»€ä¹ˆä½“éªŒï¼Ÿ"</p>
</blockquote>
<p><strong>ç”¨æˆ·è¯„ä»·</strong>ï¼š</p>
<ul>
<li>â€¢ âŒ å…è´¹ç‰ˆï¼šé…é¢å¤§å¹…ä¸‹é™</li>
<li>â€¢ âŒ Proç‰ˆï¼šä¹Ÿç»å¸¸é‡åˆ°é™é¢</li>
<li>â€¢ âŒ ç¨³å®šæ€§ï¼šå¶å°”ä¸å¯ç”¨ï¼Œéœ€è¦ç­‰å¾…åˆ·æ–°</li>
</ul>
<p><strong>ç»“è®º</strong>ï¼šé…é¢å’Œç¨³å®šæ€§æ˜¯ç”¨æˆ·ä½“éªŒçš„å¤§é—®é¢˜ã€‚</p>
<h4 data-id="heading-12">4. å“åº”æ›´æ³›åŒ–ã€ç¼ºå°‘ç»†èŠ‚</h4>
<p><strong>çœŸå®åæ§½</strong>ï¼š</p>
<blockquote>
<p>"ç›¸æ¯”2.5 Proï¼ŒGemini 3 Proçš„å›ç­”æ›´ç¬¼ç»Ÿï¼Œç¼ºå°‘å…·ä½“ç»†èŠ‚ã€‚æ„Ÿè§‰å®ƒåœ¨'å·æ‡’'ã€‚"</p>
</blockquote>
<p><strong>ç”¨æˆ·è¯„ä»·</strong>ï¼š</p>
<ul>
<li>â€¢ âŒ è¾“å‡ºè´¨é‡ï¼šæ›´ç®€çŸ­æˆ–ç¬¼ç»Ÿ</li>
<li>â€¢ âŒ ç»†èŠ‚ï¼šä¸å¦‚2.5 Proè¯¦ç»†</li>
<li>â€¢ âŒ å¯¹æ¯”ï¼šå¾ˆå¤šäººå›æ»šåˆ°2.5 Pro</li>
</ul>
<p><strong>ç»“è®º</strong>ï¼šåœ¨æ—¥å¸¸ä½¿ç”¨ä¸­ï¼Œå¾ˆå¤šäººè§‰å¾—2.5 Proæ›´å¥½ç”¨ã€‚</p>
<hr/>
<h3 data-id="heading-13">ğŸ® 5ä¸ªå®é™…åº”ç”¨åœºæ™¯</h3>
<p>åŸºäºçœŸå®ç”¨æˆ·æ¡ˆä¾‹ï¼Œè¿™äº›åœºæ™¯Gemini 3 Proè¡¨ç°æœ€å¥½ï¼š</p>
<h4 data-id="heading-14">åœºæ™¯1ï¼šè§†é¢‘å†…å®¹åˆ†æ ğŸ¥</h4>
<p><strong>é€‚åˆ</strong>ï¼š</p>
<ul>
<li>â€¢ åˆ†ææŠ€æœ¯è§†é¢‘ï¼Œæå–å…³é”®ä¿¡æ¯</li>
<li>â€¢ ä¼šè®®å½•éŸ³è½¬å½•+è¯´è¯è€…è¯†åˆ«</li>
<li>â€¢ è§†é¢‘æ€»ç»“+æ—¶é—´æˆ³å¼•ç”¨</li>
</ul>
<p><strong>çœŸå®æ¡ˆä¾‹</strong>ï¼š</p>
<blockquote>
<p>"æˆ‘ä¸Šä¼ äº†20åˆ†é’Ÿçš„æŠ€æœ¯è§†é¢‘ï¼ŒGemini 3 Proå‡†ç¡®è¯†åˆ«äº†æ‰“æ–­å’Œè¯´è¯è€…ï¼Œè¿˜æå‡ºäº†ä¼˜åŒ–å»ºè®®ã€‚"</p>
</blockquote>
<p><strong>æ•ˆæœ</strong>ï¼šâ­â­â­â­â­</p>
<h4 data-id="heading-15">åœºæ™¯2ï¼šå­¦æœ¯è®ºæ–‡å¤„ç† ğŸ“š</h4>
<p><strong>é€‚åˆ</strong>ï¼š</p>
<ul>
<li>â€¢ æ–‡çŒ®ç»¼è¿°</li>
<li>â€¢ è®ºæ–‡æ€»ç»“ï¼ˆå«å›¾è¡¨å’Œå…¬å¼ï¼‰</li>
<li>â€¢ ç”Ÿæˆå‚è€ƒåˆ—è¡¨</li>
</ul>
<p><strong>çœŸå®æ¡ˆä¾‹</strong>ï¼š</p>
<blockquote>
<p>"PhDå€™é€‰äººç”¨å®ƒè§£ç å¤æ‚ç†è®ºï¼Œè§†ä½œ'éšæ—¶åœ¨çº¿çš„ç ”ç©¶é¡¾é—®'ã€‚"</p>
</blockquote>
<p><strong>æ•ˆæœ</strong>ï¼šâ­â­â­â­â­</p>
<p><strong>æ³¨æ„</strong>ï¼šéœ€è¦äººå·¥æ ¸æŸ¥å¼•ç”¨å‡†ç¡®æ€§ã€‚</p>
<h4 data-id="heading-16">åœºæ™¯3ï¼šå¤æ‚ç¼–ç ä»»åŠ¡ ğŸ‘¨â€ğŸ’»</h4>
<p><strong>é€‚åˆ</strong>ï¼š</p>
<ul>
<li>â€¢ å¤§å‹ä»£ç åº“é‡æ„</li>
<li>â€¢ 3Då›¾å½¢/æ¸¸æˆå¼€å‘</li>
<li>â€¢ å‰ç«¯UIç”Ÿæˆ</li>
</ul>
<p><strong>çœŸå®æ¡ˆä¾‹</strong>ï¼š</p>
<blockquote>
<p>"çº¯åç«¯å·¥ç¨‹å¸ˆç”¨å®ƒä»é›¶è®¾è®¡å‡ºä¸“ä¸šçº§landing pageï¼Œå‡ ä¹æ— è®¾è®¡ç»éªŒã€‚"</p>
</blockquote>
<p><strong>æ•ˆæœ</strong>ï¼šâ­â­â­â­</p>
<p><strong>æ³¨æ„</strong>ï¼šä»£ç å¯èƒ½æ¯”è¾ƒå†—é•¿ï¼Œéœ€è¦ç²¾ç®€ã€‚</p>
<h4 data-id="heading-17">åœºæ™¯4ï¼šæ•°æ®åˆ†æè‡ªåŠ¨åŒ– ğŸ“Š</h4>
<p><strong>é€‚åˆ</strong>ï¼š</p>
<ul>
<li>â€¢ ä¸Šä¼ CSVè‡ªåŠ¨åˆ†æ</li>
<li>â€¢ ç”Ÿæˆå¯è§†åŒ–+PDFæŠ¥å‘Š</li>
<li>â€¢ å¤šæºæ•°æ®æ•´åˆ</li>
</ul>
<p><strong>çœŸå®æ¡ˆä¾‹</strong>ï¼š</p>
<blockquote>
<p>"ä¸Šä¼ æ•°æ®é›†ï¼Œè‡ªåŠ¨æ‰§è¡Œæ¢ç´¢æ€§åˆ†æã€å»ºæ¨¡ã€å¯è§†åŒ–ï¼Œç”Ÿæˆä¸“ä¸šæŠ¥å‘Šã€‚"</p>
</blockquote>
<p><strong>æ•ˆæœ</strong>ï¼šâ­â­â­â­</p>
<h4 data-id="heading-18">åœºæ™¯5ï¼šå¤šæ¨¡æ€å†…å®¹åˆ›ä½œ ğŸ¨</h4>
<p><strong>é€‚åˆ</strong>ï¼š</p>
<ul>
<li>â€¢ ä»è‰å›¾ç”Ÿæˆç½‘ç«™</li>
<li>â€¢ ç”Ÿæˆäº’åŠ¨å¼å†…å®¹ï¼ˆå¦‚æ—…è¡Œè§„åˆ’ï¼‰</li>
<li>â€¢ è§†é¢‘å†…å®¹ä¼˜åŒ–</li>
</ul>
<p><strong>çœŸå®æ¡ˆä¾‹</strong>ï¼š</p>
<blockquote>
<p>"æç¤º'è§„åˆ’ç½—é©¬3æ—¥æ¸¸'ï¼Œç”Ÿæˆäº†æ‚å¿—å¼äº’åŠ¨è¡Œç¨‹ï¼Œå«ç…§ç‰‡ã€æ—¥ç¨‹ã€åµŒå…¥æœç´¢ç»“æœã€‚"</p>
</blockquote>
<p><strong>æ•ˆæœ</strong>ï¼šâ­â­â­â­â­</p>
<hr/>
<h3 data-id="heading-19">ğŸ†š å¯¹æ¯”ï¼šGemini 3 Pro vs ChatGPT vs Claude</h3>
<p>åŸºäºçœŸå®ç”¨æˆ·åé¦ˆçš„å¯¹æ¯”ï¼š</p>





















































<table><thead><tr><th>ç»´åº¦</th><th>Gemini 3 Pro</th><th>ChatGPT (GPT-5)</th><th>Claude (Sonnet 4.5)</th></tr></thead><tbody><tr><td><strong>å¤šæ¨¡æ€</strong></td><td>â­â­â­â­â­ æœ€å¼º</td><td>â­â­â­â­ å¼º</td><td>â­â­â­ ä¸€èˆ¬</td></tr><tr><td><strong>ç¼–ç </strong></td><td>â­â­â­â­ å¼ºï¼ˆagenticï¼‰</td><td>â­â­â­â­ å¼º</td><td>â­â­â­â­â­ æœ€ç¨³å®š</td></tr><tr><td><strong>æ¨ç†</strong></td><td>â­â­â­â­â­ æœ€å¼º</td><td>â­â­â­â­ å¼º</td><td>â­â­â­â­ å¼º</td></tr><tr><td><strong>é•¿ä¸Šä¸‹æ–‡</strong></td><td>â­â­ æœ‰bug</td><td>â­â­â­ ä¸€èˆ¬</td><td>â­â­â­â­â­ æœ€ç¨³å®š</td></tr><tr><td><strong>ç¨³å®šæ€§</strong></td><td>â­â­â­ æœ‰bug</td><td>â­â­â­â­ ç¨³å®š</td><td>â­â­â­â­â­ æœ€ç¨³å®š</td></tr><tr><td><strong>æŒ‡ä»¤éµå¾ª</strong></td><td>â­â­â­ ä¸€èˆ¬</td><td>â­â­â­â­ å¥½</td><td>â­â­â­â­â­ æœ€å¥½</td></tr><tr><td><strong>ä»·æ ¼</strong></td><td>$20/æœˆ</td><td>$20/æœˆ</td><td>$20/æœˆ</td></tr></tbody></table>
<p><strong>ç”¨æˆ·æ€»ç»“</strong>ï¼š</p>
<ul>
<li>â€¢ <strong>æéš¾æ¨ç†/æ•°å­¦/è§†è§‰</strong> â†’ é€‰Gemini 3 Pro</li>
<li>â€¢ <strong>æ—¥å¸¸ç¼–ç¨‹/é•¿å¯¹è¯/å¯é è¾“å‡º</strong> â†’ é€‰Claudeæˆ–å›æ»šåˆ°Gemini 2.5 Pro</li>
<li>â€¢ <strong>é€šç”¨å¯¹è¯/åˆ›æ„å†™ä½œ</strong> â†’ é€‰ChatGPT</li>
</ul>
<hr/>
<h3 data-id="heading-20">ğŸ¯ è¯¥ä¸è¯¥ç”¨ï¼Ÿç»™ä½ 3ä¸ªå»ºè®®</h3>
<h4 data-id="heading-21">å»ºè®®1ï¼šçœ‹ä»»åŠ¡ç±»å‹</h4>
<p><strong>é€‚åˆç”¨Gemini 3 Pro</strong>ï¼š</p>
<ul>
<li>â€¢ âœ… è§†é¢‘/å›¾åƒ/éŸ³é¢‘åˆ†æ</li>
<li>â€¢ âœ… å­¦æœ¯è®ºæ–‡å¤„ç†ï¼ˆå«å›¾è¡¨å…¬å¼ï¼‰</li>
<li>â€¢ âœ… å¤æ‚æ•°å­¦å’Œé€»è¾‘æ¨ç†</li>
<li>â€¢ âœ… å¤šæ¨¡æ€å†…å®¹åˆ›ä½œ</li>
<li>â€¢ âœ… å¤§å‹ä»£ç åº“åˆ†æ</li>
</ul>
<p><strong>ä¸é€‚åˆç”¨Gemini 3 Pro</strong>ï¼š</p>
<ul>
<li>â€¢ âŒ é•¿å¯¹è¯ï¼ˆ&gt;10è½®ï¼‰</li>
<li>â€¢ âŒ éœ€è¦ç²¾ç¡®æŒ‡ä»¤éµå¾ª</li>
<li>â€¢ âŒ è¿½æ±‚ç¨³å®šæ€§å’Œå¯é æ€§</li>
<li>â€¢ âŒ æ—¥å¸¸ç®€å•ä»»åŠ¡</li>
</ul>
<h4 data-id="heading-22">å»ºè®®2ï¼šé…åˆå…¶ä»–æ¨¡å‹ä½¿ç”¨</h4>
<p>å¾ˆå¤šç”¨æˆ·çš„ç­–ç•¥ï¼š</p>
<ul>
<li>â€¢ <strong>Gemini 3 Pro</strong>ï¼šå¤šæ¨¡æ€åˆ†æã€å¤æ‚æ¨ç†</li>
<li>â€¢ <strong>Claude</strong>ï¼šç¼–ç ã€é•¿æ–‡æ¡£åˆ†æ</li>
<li>â€¢ <strong>ChatGPT</strong>ï¼šé€šç”¨å¯¹è¯ã€åˆ›æ„å†™ä½œ</li>
</ul>
<p><strong>ä¸è¦åªç”¨ä¸€ä¸ªæ¨¡å‹ï¼Œç»„åˆä½¿ç”¨æ•ˆæœæœ€å¥½ï¼</strong></p>
<h4 data-id="heading-23">å»ºè®®3ï¼šç­‰å¾…bugä¿®å¤</h4>
<p>ç›®å‰ï¼ˆ2026å¹´1æœˆï¼‰Gemini 3 Proè¿˜åœ¨previewé˜¶æ®µï¼Œæœ‰ä¸å°‘bugï¼š</p>
<ul>
<li>â€¢ é•¿ä¸Šä¸‹æ–‡é—®é¢˜</li>
<li>â€¢ é…é¢é™åˆ¶</li>
<li>â€¢ ç¨³å®šæ€§é—®é¢˜</li>
</ul>
<p><strong>å¦‚æœä½ è¿½æ±‚ç¨³å®š</strong>ï¼š</p>
<ul>
<li>â€¢ æš‚æ—¶ç”¨Gemini 2.5 Pro</li>
<li>â€¢ ç­‰Googleä¿®å¤åå†åˆ‡æ¢</li>
</ul>
<p><strong>å¦‚æœä½ æ„¿æ„å°é²œ</strong>ï¼š</p>
<ul>
<li>â€¢ ç°åœ¨å°±è¯•è¯•Gemini 3 Pro</li>
<li>â€¢ é‡åˆ°é—®é¢˜åŠæ—¶åé¦ˆ</li>
</ul>
<hr/>
<h3 data-id="heading-24">ğŸ’° ä»·æ ¼ä¸è·å–</h3>
<h4 data-id="heading-25">å®˜æ–¹æ¸ é“</h4>
<ul>
<li>â€¢ <strong>å…è´¹ç‰ˆ</strong>ï¼šgemini.google.comï¼ˆæœ‰é™é…é¢ï¼‰</li>
<li>â€¢ <strong>Proç‰ˆ</strong>ï¼š$20/æœˆï¼ˆGoogle AI Proï¼‰</li>
<li>â€¢ <strong>Ultraç‰ˆ</strong>ï¼šæ›´é«˜é…é¢ï¼Œä»·æ ¼æ›´é«˜</li>
<li>â€¢ <strong>API</strong>ï¼šæŒ‰tokenè®¡è´¹</li>
</ul>
<h4 data-id="heading-26">å›½å†…ä½¿ç”¨</h4>
<p>ä¸­å›½å¤§é™†æ— æ³•ç›´æ¥è®¿é—®ï¼Œä½†æœ‰å¤§é‡é•œåƒç«™ï¼š</p>
<ul>
<li>â€¢ <a href="https://link.juejin.cn?target=https%3A%2F%2Fchatgpt-plus.top%2F" target="_blank" title="https://chatgpt-plus.top/" ref="nofollow noopener noreferrer">chatgpt-plus.top/</a></li>
<li>â€¢ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgeminiai.asia%2F" target="_blank" title="https://geminiai.asia/" ref="nofollow noopener noreferrer">geminiai.asia/</a></li>
</ul>
<p><strong>æ³¨æ„</strong>ï¼šé•œåƒç«™éå®˜æ–¹ï¼Œå¯èƒ½æœ‰å»¶è¿Ÿæˆ–é™é¢ã€‚</p>
<hr/>
<h3 data-id="heading-27">ğŸ¯ æ€»ç»“</h3>
<p>Gemini 3 Proæ˜¯ä¸€ä¸ª<strong>çŸ›ç›¾ä½“</strong>ï¼š</p>
<p><strong>åŸºå‡†æµ‹è¯•</strong>ï¼šç¢¾å‹æ‰€æœ‰å¯¹æ‰‹ï¼Œå²ä¸Šæœ€å¼º<br/>
<strong>å®é™…ä½¿ç”¨</strong>ï¼šæœ‰äº®ç‚¹ä¹Ÿæœ‰å‘ï¼Œéœ€è¦ç­‰å¾…å®Œå–„</p>
<p><strong>æˆ‘çš„çœ‹æ³•</strong>ï¼š</p>
<ul>
<li>â€¢ å¦‚æœä½ çš„ä»»åŠ¡æ˜¯å¤šæ¨¡æ€ã€å¤æ‚æ¨ç†ã€å­¦æœ¯ç§‘ç ” â†’ <strong>å€¼å¾—å°è¯•</strong></li>
<li>â€¢ å¦‚æœä½ è¿½æ±‚ç¨³å®šã€æ—¥å¸¸ä½¿ç”¨ â†’ <strong>æš‚æ—¶è§‚æœ›</strong></li>
<li>â€¢ å¦‚æœä½ æ„¿æ„å°é²œã€èƒ½æ¥å—bug â†’ <strong>ç°åœ¨å°±ä¸Š</strong></li>
</ul>
<p><strong>æœ€é‡è¦çš„æ˜¯</strong>ï¼šä¸è¦åªçœ‹åŸºå‡†æµ‹è¯•ï¼Œè¦çœ‹çœŸå®ç”¨æˆ·åé¦ˆã€‚</p>
<p>AIæ¨¡å‹æ²¡æœ‰å®Œç¾çš„ï¼Œåªæœ‰æœ€é€‚åˆä½ çš„ã€‚</p>
<p><strong>æ—©ç‚¹å°è¯•ï¼Œæ—©ç‚¹é€‚åº”ï¼Œæœªæ¥çš„èŒåœºï¼Œä¼šç”¨AIçš„äººä¼šæ¯”ä¸ä¼šç”¨çš„äººæ•ˆç‡é«˜10å€ï¼</strong> ğŸš€</p>
<hr/>
<p><strong>ä½ ç”¨è¿‡Gemini 3 Proå—ï¼Ÿåœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„ä½“éªŒå§ï¼ğŸ‘‡</strong></p>
<p><strong>è§‰å¾—æœ‰ç”¨çš„è¯ï¼Œç‚¹ä¸ªèµã€è½¬å‘ç»™éœ€è¦çš„æœ‹å‹ï¼ğŸ’ª</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç»™ç‹¬ç«‹å¼€å‘è€…ï¼šä¸€äººå³å†›å›¢ï¼Œç”¨æ™ºèƒ½ä½“åä½œå¹³å°åŒæ—¶æå®šå‰ç«¯ã€åç«¯å’Œæµ‹è¯•]]></title>    <link>https://juejin.cn/post/7596687697755111434</link>    <guid>https://juejin.cn/post/7596687697755111434</guid>    <pubDate>2026-01-19T07:22:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596687697755111434" data-draft-id="7596247009815805978" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç»™ç‹¬ç«‹å¼€å‘è€…ï¼šä¸€äººå³å†›å›¢ï¼Œç”¨æ™ºèƒ½ä½“åä½œå¹³å°åŒæ—¶æå®šå‰ç«¯ã€åç«¯å’Œæµ‹è¯•"/> <meta itemprop="keywords" content="æ€§èƒ½ä¼˜åŒ–,å¼€æº,Agent"/> <meta itemprop="datePublished" content="2026-01-19T07:22:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§å‚æŠ€æœ¯æ€»ç›‘ä¸‹æµ·"/> <meta itemprop="url" content="https://juejin.cn/user/4091714106833577"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç»™ç‹¬ç«‹å¼€å‘è€…ï¼šä¸€äººå³å†›å›¢ï¼Œç”¨æ™ºèƒ½ä½“åä½œå¹³å°åŒæ—¶æå®šå‰ç«¯ã€åç«¯å’Œæµ‹è¯•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4091714106833577/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§å‚æŠ€æœ¯æ€»ç›‘ä¸‹æµ·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T07:22:51.000Z" title="Mon Jan 19 2026 07:22:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ChatDev 2.0 (DevAll) æ·±åº¦æŠ€æœ¯è§£æï¼šé›¶ä»£ç å¤šæ™ºèƒ½ä½“ç¼–æ’å¼•æ“çš„å®ç°</h2>
<h3 data-id="heading-1">1. æ•´ä½“ä»‹ç»</h3>
<h4 data-id="heading-2">1.1 é¡¹ç›®æ¦‚å†µ</h4>
<p>ChatDev 2.0 (DevAll) æ˜¯ç”± OpenBMB å›¢é˜Ÿå¼€æºçš„<strong>é€šç”¨å¤šæ™ºèƒ½ä½“ç¼–æ’å¹³å°</strong>ã€‚é¡¹ç›®åœ¨ GitHub (<code>OpenBMB/ChatDev</code>) ä¸Šè·å¾—äº†ç¤¾åŒºçš„é«˜åº¦å…³æ³¨ï¼Œå…¶æ ¸å¿ƒåˆ›æ–°åœ¨äºå°†å¤šæ™ºèƒ½ä½“åä½œï¼ˆMulti-Agentï¼‰çš„ç ”ç©¶æˆæœå·¥ç¨‹åŒ–ä¸ºä¸€ä¸ª<strong>é…ç½®é©±åŠ¨ã€å¯è§†åŒ–ã€å¯æ‰©å±•</strong>çš„ç”Ÿäº§åŠ›å·¥å…·ã€‚è¯¥å¹³å°æ—¨åœ¨è§£å†³å¤æ‚ä»»åŠ¡è‡ªåŠ¨åŒ–ä¸­ï¼Œå•ä¸€æ™ºèƒ½ä½“èƒ½åŠ›æœ‰é™ã€æµç¨‹åƒµåŒ–çš„é—®é¢˜ï¼Œé€šè¿‡å®šä¹‰æ™ºèƒ½ä½“é—´çš„äº¤äº’å›¾ï¼ˆWorkflow Graphï¼‰ï¼Œå®ç°ä»»åŠ¡çš„åˆ†è§£ã€åä½œä¸å½’å¹¶ã€‚</p>
<h4 data-id="heading-3">1.2 æ ¸å¿ƒé—®é¢˜ä¸è§£å†³æ€è·¯</h4>
<p><strong>é¢ä¸´çš„é—®é¢˜</strong>ï¼š</p>
<ol>
<li><strong>æ™ºèƒ½ä½“èƒ½åŠ›å•ä¸€</strong>ï¼šå•ä¸€LLMåœ¨å¤„ç†å¤æ‚ã€å¤šæ­¥éª¤ä»»åŠ¡æ—¶å­˜åœ¨é€»è¾‘è·³è·ƒã€é—å¿˜ä¸Šä¸‹æ–‡ã€ç¼ºä¹ä¸“é¡¹æŠ€èƒ½ç­‰é—®é¢˜ã€‚</li>
<li><strong>æµç¨‹ç¼–æ’å¤æ‚</strong>ï¼šä¼ ç»Ÿçš„å¤šæ™ºèƒ½ä½“ç³»ç»Ÿéœ€è¦å¼€å‘è€…æ‰‹åŠ¨ç¼–å†™å¤§é‡çš„åè°ƒã€é€šä¿¡å’ŒçŠ¶æ€ç®¡ç†ä»£ç ï¼Œå¼€å‘é—¨æ§›é«˜ã€è°ƒè¯•å›°éš¾ã€‚</li>
<li><strong>åœºæ™¯å®šåˆ¶å›°éš¾</strong>ï¼šä¸ºæ¯ä¸ªæ–°é¢†åŸŸï¼ˆå¦‚æ•°æ®åˆ†æã€3Dç”Ÿæˆï¼‰æ„å»ºä¸“ç”¨ç³»ç»Ÿï¼Œéœ€é‡å¤å¼€å‘åº•å±‚é€šä¿¡æ¡†æ¶ï¼Œæˆæœ¬é«˜æ˜‚ã€‚</li>
</ol>
<p><strong>ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ</strong>é€šå¸¸é‡‡ç”¨ç¡¬ç¼–ç çš„è„šæœ¬æˆ–ç®€å•çš„é“¾å¼è°ƒç”¨ï¼ˆLangChainç­‰ï¼‰ï¼Œæ™ºèƒ½ä½“è§’è‰²å’Œäº¤äº’é€»è¾‘ä¸ä¸šåŠ¡ä»£ç å¼ºè€¦åˆï¼Œå¯¼è‡´ç³»ç»ŸåƒµåŒ–ã€éš¾ä»¥å¤ç”¨å’Œç»´æŠ¤ã€‚</p>
<p><strong>ChatDev 2.0 çš„åˆ›æ–°</strong>ï¼š
å…¶æ ¸å¿ƒæ€è·¯æ˜¯å¼•å…¥**â€œæœ‰å‘å›¾ï¼ˆDAGï¼‰å³å·¥ä½œæµâ€**çš„æŠ½è±¡ã€‚å°†æ•´ä¸ªä»»åŠ¡æµç¨‹å»ºæ¨¡ä¸ºä¸€ä¸ªå›¾ï¼ˆGraphï¼‰ï¼ŒèŠ‚ç‚¹ï¼ˆNodeï¼‰ä»£è¡¨æ‰§è¡Œå•å…ƒï¼ˆå¦‚ç‰¹å®šè§’è‰²çš„æ™ºèƒ½ä½“ã€å·¥å…·è°ƒç”¨ã€äººå·¥å¹²é¢„ç‚¹ï¼‰ï¼Œè¾¹ï¼ˆEdgeï¼‰ä»£è¡¨ä¿¡æ¯æµä¸æ§åˆ¶é€»è¾‘ï¼ˆå¦‚æ¡ä»¶åˆ¤æ–­ã€æ¶ˆæ¯è½¬æ¢ï¼‰ã€‚ç”¨æˆ·é€šè¿‡é…ç½®ï¼ˆYAMLï¼‰æˆ–å¯è§†åŒ–ç•Œé¢å®šä¹‰æ­¤å›¾ï¼Œå¹³å°è´Ÿè´£å›¾çš„è§£æã€è°ƒåº¦ä¸æ‰§è¡Œã€‚è¿™ç§æ–¹å¼å°†â€œä¸šåŠ¡é€»è¾‘â€ï¼ˆè°åœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹åšä»€ä¹ˆï¼‰ä»â€œæ‰§è¡Œå¼•æ“â€ï¼ˆå¦‚ä½•è°ƒåº¦ã€ä¼ é€’æ¶ˆæ¯ã€ç®¡ç†çŠ¶æ€ï¼‰ä¸­å½»åº•è§£è€¦ã€‚</p>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li><strong>å£°æ˜å¼é…ç½®</strong>ï¼šç”¨YAMLæè¿°å·¥ä½œæµï¼Œæ„å›¾æ¸…æ™°ï¼Œæ˜“äºç‰ˆæœ¬ç®¡ç†å’Œåˆ†äº«ã€‚</li>
<li><strong>æ‰§è¡Œä¸é€»è¾‘è§£è€¦</strong>ï¼šå¼•æ“ç»Ÿä¸€å¤„ç†å¹¶å‘ã€å¾ªç¯ã€å®¹é”™ç­‰éåŠŸèƒ½æ€§éœ€æ±‚ã€‚</li>
<li><strong>é«˜åº¦å¯æ‰©å±•</strong>ï¼šé€šè¿‡æ’ä»¶åŒ–æœºåˆ¶ï¼Œå¯ä»¥æ— ç¼æ¥å…¥æ–°çš„èŠ‚ç‚¹ç±»å‹ã€æ¨¡å‹ã€å·¥å…·ã€‚</li>
</ul>
<h4 data-id="heading-4">1.3 å•†ä¸šä»·å€¼ä¸å®šä½</h4>
<p><strong>ä»·å€¼å®šä½</strong>ï¼šChatDev 2.0 æ˜¯ä¸€ä¸ª<strong>å¤šæ™ºèƒ½ä½“æ“ä½œç³»ç»Ÿ</strong>æˆ–<strong>ä¸­é—´ä»¶å¹³å°</strong>ã€‚</p>
<ul>
<li><strong>å¯¹éæŠ€æœ¯ç”¨æˆ·ï¼ˆäº§å“ã€è¿è¥ï¼‰</strong>ï¼šæä¾›é›¶ä»£ç /ä½ä»£ç çš„è‡ªåŠ¨åŒ–å·¥ä½œæµæ­å»ºèƒ½åŠ›ï¼Œå°†å¤æ‚AIèƒ½åŠ›äº§å“åŒ–ã€‚</li>
<li><strong>å¯¹å¼€å‘è€…</strong>ï¼šæä¾›ç¨³å®šã€é«˜æ€§èƒ½çš„æ‰§è¡Œå¼•æ“SDK (<code>runtime.sdk</code>)ï¼Œå¯å¿«é€Ÿé›†æˆå¤šæ™ºèƒ½ä½“èƒ½åŠ›åˆ°ç°æœ‰ç³»ç»Ÿï¼Œé¿å…é‡å¤é€ è½®å­ã€‚</li>
<li><strong>å¯¹ç ”ç©¶è€…</strong>ï¼šæä¾›äº†ä¸€ä¸ªéªŒè¯å¤šæ™ºèƒ½ä½“åä½œç®—æ³•ï¼ˆå¦‚æŠ•ç¥¨ã€è¾©è®ºã€åæ€ï¼‰çš„æ ‡å‡†åŒ–å®éªŒå¹³å°ã€‚</li>
</ul>
<p><strong>æˆæœ¬æ•ˆç›Šåˆ†æ</strong>ï¼š</p>
<ul>
<li><strong>å¼€å‘æˆæœ¬</strong>ï¼šä¼ ç»Ÿæ–¹å¼å¼€å‘ä¸€ä¸ªå®šåˆ¶çš„å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼Œæ¶‰åŠåˆ†å¸ƒå¼è°ƒåº¦ã€æ¶ˆæ¯æ€»çº¿ã€çŠ¶æ€æŒä¹…åŒ–ç­‰ï¼Œé€šå¸¸éœ€è¦æ•°äººæœˆçš„æŠ•å…¥ã€‚ChatDev 2.0 æä¾›äº†å¼€ç®±å³ç”¨çš„å®Œæ•´å®ç°ï¼Œå°†å¼€å‘æˆæœ¬é™è‡³â€œé…ç½®+å®šåˆ¶èŠ‚ç‚¹â€çš„æ°´å¹³ã€‚</li>
<li><strong>è¦†ç›–é—®é¢˜ç©ºé—´</strong>ï¼šé€šè¿‡â€œå›¾ç¼–æ’â€è¿™ä¸€é€šç”¨æŠ½è±¡ï¼Œå¹³å°ç†è®ºä¸Šå¯ä»¥è¦†ç›–ä»»ä½•å¯è¢«åˆ†è§£ä¸ºå¤šæ­¥éª¤ã€å¤šè§’è‰²çš„è‡ªåŠ¨åŒ–ä»»åŠ¡ï¼ˆè½¯ä»¶DevOpsã€æ™ºèƒ½å®¢æœã€æŠ¥å‘Šç”Ÿæˆã€å†…å®¹åˆ›ä½œç­‰ï¼‰ï¼Œå…¶é—®é¢˜ç©ºé—´çš„å¹¿åº¦è¿œè¶…å•ä¸€åœºæ™¯çš„ä¸“ç”¨ç³»ç»Ÿã€‚å…¶æ•ˆç›Šåœ¨äº<strong>æ ‡å‡†åŒ–äº†å¤šæ™ºèƒ½ä½“åº”ç”¨çš„äº¤ä»˜æ¨¡å¼</strong>ï¼Œå¤§å¹…é™ä½äº†ä»æƒ³æ³•åˆ°è½åœ°åŸå‹çš„å‘¨æœŸã€‚</li>
</ul>
<h3 data-id="heading-5">2. è¯¦ç»†åŠŸèƒ½æ‹†è§£ä¸æŠ€æœ¯è§†è§’</h3>
<p>é¡¹ç›®é€šè¿‡æ¸…æ™°çš„æ¨¡å—åŒ–æ¶æ„æ”¯æ’‘å…¶æ ¸å¿ƒåŠŸèƒ½ï¼š</p>
<ol>
<li><strong>å·¥ä½œæµå®šä¹‰ä¸åŠ è½½</strong> (<code>entity/</code>, <code>check/</code>): è´Ÿè´£è§£æYAMLé…ç½®ï¼Œæ„å»ºå†…å­˜ä¸­çš„å›¾ç»“æ„ (<code>GraphDefinition</code>, <code>GraphConfig</code>)ã€‚</li>
<li><strong>å›¾æ‰§è¡Œå¼•æ“</strong> (<code>workflow/</code>): æ ¸å¿ƒæ¨¡å—ã€‚åŒ…å« <code>GraphContext</code>ï¼ˆè¿è¡Œä¸Šä¸‹æ–‡ï¼‰ã€<code>GraphExecutor</code>ï¼ˆæ‰§è¡Œå™¨ï¼‰ä»¥åŠå¤šç§æ‰§è¡Œç­–ç•¥ï¼ˆ<code>DagExecutionStrategy</code>, <code>CycleExecutionStrategy</code>ï¼‰ã€‚</li>
<li><strong>èŠ‚ç‚¹æ‰§è¡Œå™¨</strong> (<code>runtime/node/</code>): å·¥å‚æ¨¡å¼ (<code>NodeExecutorFactory</code>) åˆ›å»ºä¸åŒç±»å‹çš„èŠ‚ç‚¹å¤„ç†å™¨ï¼ˆå¦‚ <code>AgentExecutor</code>, <code>ToolExecutor</code>ï¼‰ï¼Œéš”ç¦»äº†èŠ‚ç‚¹è¡Œä¸ºå·®å¼‚ã€‚</li>
<li><strong>è¾¹å¤„ç†å™¨</strong> (<code>runtime/edge/</code>): å¤„ç†èŠ‚ç‚¹é—´çš„æ¶ˆæ¯æµåŠ¨ï¼Œæ”¯æŒæ¡ä»¶åˆ¤æ–­ (<code>ConditionManager</code>) å’Œæ¶ˆæ¯è½¬æ¢ (<code>PayloadProcessor</code>)ã€‚</li>
<li><strong>è®°å¿†ä¸æ€è€ƒç®¡ç†</strong> (<code>runtime/node/agent/memory|thinking</code>): ä¸ºæ™ºèƒ½ä½“èŠ‚ç‚¹æä¾›çŸ­æœŸ/é•¿æœŸè®°å¿†èƒ½åŠ›å’Œé“¾å¼æ€è€ƒï¼ˆCoTï¼‰ç­‰é«˜çº§æ¨ç†æ¡†æ¶ã€‚</li>
<li><strong>èµ„æºä¸ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong> (<code>workflow/executor/</code>): ç®¡ç†å¹¶å‘ (<code>ParallelExecutor</code>)ã€èµ„æº (<code>ResourceManager</code>) å’Œå‘¨æœŸå¾ªç¯ (<code>CycleManager</code>)ã€‚</li>
<li><strong>å¯¹å¤–æ¥å£</strong> (<code>server/</code>, <code>runtime/sdk.py</code>): æä¾›HTTP APIæœåŠ¡å’ŒPython SDKä¸¤ç§é›†æˆæ–¹å¼ã€‚</li>
</ol>
<h3 data-id="heading-6">3. æ ¸å¿ƒæŠ€æœ¯éš¾ç‚¹</h3>
<ol>
<li><strong>æœ‰å‘å›¾ä¸å¾ªç¯çš„ç»Ÿä¸€æ‰§è¡Œæ¨¡å‹</strong>ï¼šæ—¢è¦é«˜æ•ˆæ‰§è¡Œæ— ç¯çš„DAGï¼ˆæ”¯æŒå±‚å†…å¹¶è¡Œï¼‰ï¼Œåˆè¦å¤„ç†å¸¦æœ‰å¾ªç¯ï¼ˆLoopï¼‰çš„å·¥ä½œæµï¼ˆå¦‚è¿­ä»£ä¼˜åŒ–ï¼‰ï¼Œè¿˜éœ€æ”¯æŒç‰¹æ®Šçš„â€œå¤šæ•°æŠ•ç¥¨â€æ¨¡å¼ã€‚è¿™è¦æ±‚å¼•æ“å…·å¤‡<strong>å¤šæ¨¡æ€ç­–ç•¥åˆ‡æ¢èƒ½åŠ›</strong>ã€‚</li>
<li><strong>åŠ¨æ€ã€æ¡ä»¶åŒ–çš„æ¶ˆæ¯è·¯ç”±</strong>ï¼šè¾¹çš„æ¡ä»¶åˆ¤æ–­ï¼ˆ<code>condition</code>ï¼‰å’Œæ¶ˆæ¯å¤„ç†ï¼ˆ<code>process</code>ï¼‰éœ€è¦æ”¯æŒåŠ¨æ€è¡¨è¾¾å¼æ±‚å€¼ï¼ˆå¦‚åŸºäºä¸Šä¸€æ­¥ç»“æœçš„Jinja2æ¨¡æ¿æˆ–Pythonå‡½æ•°ï¼‰ï¼Œå¹¶èƒ½å¤Ÿçµæ´»æ‰©å±•ã€‚</li>
<li><strong>æ™ºèƒ½ä½“çŠ¶æ€çš„éš”ç¦»ä¸æŒä¹…åŒ–</strong>ï¼šæ¯ä¸ªæ™ºèƒ½ä½“èŠ‚ç‚¹å¯èƒ½éœ€è¦ç‹¬ç«‹çš„å¯¹è¯å†å²ï¼ˆè®°å¿†ï¼‰ï¼Œå¹¶åœ¨å·¥ä½œæµå¤šæ¬¡æ‰§è¡Œé—´æŒä¹…åŒ–ã€‚éœ€è¦è®¾è®¡è½»é‡çº§ã€å¯æ’æ‹”çš„è®°å¿†ç®¡ç†æ¥å£ã€‚</li>
<li><strong>äººæœºååŒä¸æ‰§è¡Œæ§åˆ¶</strong>ï¼šå·¥ä½œæµæ‰§è¡Œä¸­éœ€æ”¯æŒäººå·¥è¾“å…¥ï¼ˆHuman-in-the-loopï¼‰ï¼Œå¹¶å…è®¸ç”¨æˆ·éšæ—¶å–æ¶ˆä»»åŠ¡ï¼Œè¿™å°±è¦æ±‚å¼•æ“æ˜¯<strong>äº‹ä»¶é©±åŠ¨</strong>å’Œ<strong>å¯ä¸­æ–­</strong>çš„ã€‚</li>
<li><strong>åŠ¨æ€è¾¹ï¼ˆDynamic Edgeï¼‰</strong>ï¼šè¿™æ˜¯é«˜çº§ç‰¹æ€§ï¼Œå…è®¸æ ¹æ®ä¸Šæ¸¸èŠ‚ç‚¹çš„è¾“å‡ºåŠ¨æ€åˆ›å»ºå¤šä¸ªå¹¶è¡Œæˆ–æ ‘çŠ¶çš„æ‰§è¡Œåˆ†æ”¯ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªâ€œä»£ç å®¡æŸ¥â€èŠ‚ç‚¹ä¸ºæ¯ä¸ªå‘ç°çš„BugåŠ¨æ€ç”Ÿæˆä¸€ä¸ªâ€œä¿®å¤â€å­ä»»åŠ¡ï¼‰ã€‚è¿™æå¤§åœ°å¢å¼ºäº†æµç¨‹çš„çµæ´»æ€§ï¼Œä½†å®ç°å¤æ‚ï¼Œæ¶‰åŠä»»åŠ¡åŠ¨æ€æ‹†åˆ†ã€è°ƒåº¦å’Œç»“æœæ”¶é›†ã€‚</li>
</ol>
<h3 data-id="heading-7">4. è¯¦ç»†è®¾è®¡å›¾</h3>
<h4 data-id="heading-8">4.1 æ ¸å¿ƒæ¶æ„å›¾</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9df00329a28e4fe9a43a6bf0c3893e0c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5Y6C5oqA5pyv5oC755uR5LiL5rW3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769412170&amp;x-signature=z6vwr1StHh2YxRKVQNSu5Rchprg%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-9">4.2 æ ¸å¿ƒæ‰§è¡Œåºåˆ—å›¾ï¼ˆä»¥DAGæ‰§è¡Œä¸ºä¾‹ï¼‰</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant User
    participant SDK
    participant GraphExecutor
    participant NodeA
    participant NodeB
    participant NodeC
    participant EdgeAB
    participant EdgeBC

    User-&gt;&gt;SDK: run_workflow(config, prompt)
    SDK-&gt;&gt;GraphExecutor: execute_graph(graph, task_prompt)
    GraphExecutor-&gt;&gt;GraphExecutor: _build_memories_and_thinking()
    GraphExecutor-&gt;&gt;GraphExecutor: run()
    Note over GraphExecutor: ä½¿ç”¨ DAGExecutionStrategy
    
    loop å¯¹äºæ¯ä¸€å±‚ Layer
        par å±‚å†…å¹¶è¡Œ (éHumanèŠ‚ç‚¹)
            GraphExecutor-&gt;&gt;NodeA: _execute_node()
            NodeA-&gt;&gt;NodeA: è°ƒç”¨å¯¹åº”Executoræ‰§è¡Œ
            NodeA--&gt;&gt;EdgeAB: äº§å‡ºoutput_messages
            EdgeAB-&gt;&gt;EdgeAB: æ¡ä»¶è¯„ä¼°ä¸å¤„ç†
            EdgeAB-&gt;&gt;NodeB: è§¦å‘å¹¶ä¼ é€’æ¶ˆæ¯
        and
            GraphExecutor-&gt;&gt;NodeC: _execute_node()
            NodeC--&gt;&gt;EdgeBC: ...
        end
    end
    
    GraphExecutor-&gt;&gt;GraphExecutor: _collect_all_outputs()
    GraphExecutor-&gt;&gt;SDK: è¿”å› executor
    SDK-&gt;&gt;User: WorkflowRunResult(final_message, meta_info)
</code></pre>
<h4 data-id="heading-10">4.3 æ ¸å¿ƒç±»å…³ç³»å›¾ï¼ˆç®€ç•¥ï¼‰</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">classDiagram
    class GraphExecutor {
        -runtime_context: RuntimeContext
        -node_executors: Dict[str, NodeExecutor]
        -graph: GraphContext
        +run(task_prompt) Dict
        -_execute_node(node)
        -_process_edge_output(edge, msg, node)
        -_build_memories_and_thinking()
    }
    
    class GraphContext {
        -config: GraphConfig
        -nodes: Dict[str, Node]
        -layers: List[List[str]]
        +has_cycles: bool
    }
    
    class Node {
        +id: str
        +type: str
        +input: List[Message]
        +output: List[Message]
        +predecessors: List[Node]
        +successors: List[Node]
        +is_triggered() bool
    }
    
    class EdgeLink {
        +target: Node
        +condition_manager
        +payload_processor
    }
    
    class ExecutionContext {
        +tool_manager
        +memory_managers
        +thinking_managers
        +global_state
    }
    
    class NodeExecutorFactory {
        +create_executors(context, subgraphs) Dict
    }
    
    class DagExecutionStrategy {
        -layers
        -execute_node_func
        +run()
    }
    
    GraphExecutor *--&gt; GraphContext
    GraphExecutor *--&gt; ExecutionContext
    GraphExecutor --&gt; NodeExecutorFactory
    GraphExecutor --&gt; DagExecutionStrategy
    GraphContext --&gt; Node
    Node --&gt; EdgeLink
    DagExecutionStrategy --&gt; Node
</code></pre>
<h3 data-id="heading-11">5. æ ¸å¿ƒå‡½æ•°ä¸ä»£ç è§£æ</h3>
<h4 data-id="heading-12">5.1 å›¾æ‰§è¡Œå…¥å£ï¼š<code>GraphExecutor.run()</code></h4>
<p>è¿™æ˜¯æ•´ä¸ªå¼•æ“çš„â€œä¸»å¾ªç¯â€ï¼Œè´Ÿè´£é€‰æ‹©å¹¶é©±åŠ¨åˆé€‚çš„æ‰§è¡Œç­–ç•¥ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, task_prompt: <span class="hljs-type">Any</span></span>) -&gt; <span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]:
    <span class="hljs-string">"""Execute the graph based on topological layers structure or cycle-aware execution."""</span>
    self._raise_if_cancelled()
    graph_manager = GraphManager(self.graph)
    <span class="hljs-comment"># ... æ„å»ºå›¾ï¼Œå‡†å¤‡è¾¹æ¡ä»¶ ...</span>

    <span class="hljs-comment"># å…³é”®ï¼šæ ¹æ®å›¾ç‰¹å¾é€‰æ‹©æ‰§è¡Œç­–ç•¥</span>
    <span class="hljs-keyword">if</span> self.graph.is_majority_voting:
        strategy = MajorityVoteStrategy(...)
        self.majority_result = strategy.run()
    <span class="hljs-keyword">elif</span> self.graph.has_cycles:
        strategy = CycleExecutionStrategy(...)
        strategy.run()
    <span class="hljs-keyword">else</span>: <span class="hljs-comment"># æ ‡å‡†DAGæ¨¡å¼</span>
        strategy = DagExecutionStrategy(
            log_manager=self.log_manager,
            nodes=self.graph.nodes,
            layers=self.graph.layers,
            execute_node_func=self._execute_node, <span class="hljs-comment"># æ³¨å…¥èŠ‚ç‚¹æ‰§è¡Œå‡½æ•°</span>
        )
        strategy.run() <span class="hljs-comment"># å¯åŠ¨ç­–ç•¥æ‰§è¡Œ</span>

    <span class="hljs-comment"># ... æ”¶é›†è¾“å‡ºã€ä¿å­˜è®°å¿†ã€å½’æ¡£ç»“æœ ...</span>
    <span class="hljs-keyword">return</span> self.outputs
</code></pre>
<p><strong>æŠ€æœ¯è¦ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰</strong>ï¼šå°†DAGã€å¾ªç¯ã€æŠ•ç¥¨è¿™ä¸‰ç§å·®å¼‚å·¨å¤§çš„æ‰§è¡Œé€»è¾‘ï¼Œå°è£…æˆç‹¬ç«‹çš„ç­–ç•¥ç±»ã€‚<code>GraphExecutor.run()</code> ä½œä¸ºä¸Šä¸‹æ–‡ï¼Œæ ¹æ®å›¾å±æ€§è‡ªåŠ¨é€‰æ‹©ç­–ç•¥ã€‚è¿™ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œæ–°å¢ä¸€ç§æ‰§è¡Œæ¨¡å¼åªéœ€æ·»åŠ æ–°ç­–ç•¥ç±»ï¼Œæ— éœ€ä¿®æ”¹æ ¸å¿ƒæ‰§è¡Œå™¨ã€‚</li>
<li><strong>ä¾èµ–æ³¨å…¥</strong>ï¼šæ¯ä¸ªç­–ç•¥ç±»éƒ½éœ€è¦ä¸€ä¸ª <code>execute_node_func</code> å‚æ•°ï¼ˆå³ <code>self._execute_node</code> æ–¹æ³•ï¼‰ã€‚è¿™ä½¿å¾—ç­–ç•¥ç±»åªå…³å¿ƒâ€œèŠ‚ç‚¹æ‰§è¡Œçš„é¡ºåºå’Œé€»è¾‘â€ï¼Œè€Œä¸å…³å¿ƒâ€œèŠ‚ç‚¹å¦‚ä½•æ‰§è¡Œâ€ï¼ŒèŒè´£åˆ†ç¦»æ¸…æ™°ã€‚</li>
</ol>
<h4 data-id="heading-13">5.2 èŠ‚ç‚¹æ‰§è¡Œæ ¸å¿ƒï¼š<code>GraphExecutor._execute_node()</code></h4>
<p>æ­¤æ–¹æ³•å°è£…å•ä¸ªèŠ‚ç‚¹çš„æ‰§è¡Œã€è¾“å…¥è¾“å‡ºå¤„ç†å’Œä¸‹æ¸¸è¾¹è§¦å‘ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_execute_node</span>(<span class="hljs-params">self, node: Node</span>) -&gt; <span class="hljs-literal">None</span>:
    <span class="hljs-string">"""Execute a single node."""</span>
    self._raise_if_cancelled()
    <span class="hljs-keyword">with</span> self.resource_manager.guard_node(node): <span class="hljs-comment"># èµ„æºä¸Šä¸‹æ–‡ç®¡ç†</span>
        input_results = node.<span class="hljs-built_in">input</span> <span class="hljs-comment"># è·å–èŠ‚ç‚¹æ‰€æœ‰è¾“å…¥æ¶ˆæ¯</span>

        <span class="hljs-comment"># 1. è®°å½•èŠ‚ç‚¹å¼€å§‹</span>
        self.log_manager.record_node_start(node.<span class="hljs-built_in">id</span>, ...)

        <span class="hljs-comment"># 2. æ£€æŸ¥æ˜¯å¦æœ‰åŠ¨æ€è¾¹é…ç½®ï¼ˆé«˜çº§ç‰¹æ€§ï¼‰</span>
        dynamic_config = self._get_dynamic_config_for_node(node)
        
        <span class="hljs-comment"># 3. æ‰§è¡ŒèŠ‚ç‚¹æ ¸å¿ƒé€»è¾‘</span>
        <span class="hljs-keyword">with</span> self.log_manager.node_timer(node.<span class="hljs-built_in">id</span>):
            <span class="hljs-keyword">if</span> dynamic_config <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
                <span class="hljs-comment"># åŠ¨æ€æ‰§è¡Œï¼šå¤„ç†ä»»åŠ¡æ‹†åˆ†ä¸å¹¶è¡Œ</span>
                raw_outputs = self._execute_with_dynamic_config(node, input_results, dynamic_config)
            <span class="hljs-keyword">else</span>:
                <span class="hljs-comment"># é™æ€æ‰§è¡Œï¼šå¸¸è§„å¤„ç†</span>
                raw_outputs = self._process_result(node, input_results) <span class="hljs-comment"># å§”æ‰˜ç»™å…·ä½“NodeExecutor</span>

        <span class="hljs-comment"># 4. å¤„ç†è¾“å‡ºæ¶ˆæ¯</span>
        output_messages: <span class="hljs-type">List</span>[Message] = []
        <span class="hljs-keyword">for</span> raw_output <span class="hljs-keyword">in</span> raw_outputs:
            msg = self._ensure_source_output(raw_output, node.<span class="hljs-built_in">id</span>)
            node.append_output(msg)
            output_messages.append(msg)

        <span class="hljs-comment"># 5. å°†ç»“æœä¼ é€’ç»™æ‰€æœ‰å‡ºè¾¹ï¼ˆè§¦å‘ä¸‹æ¸¸èŠ‚ç‚¹ï¼‰</span>
        <span class="hljs-keyword">for</span> output_msg <span class="hljs-keyword">in</span> output_messages:
            <span class="hljs-keyword">for</span> edge_link <span class="hljs-keyword">in</span> node.iter_outgoing_edges():
                self._process_edge_output(edge_link, output_msg, node) <span class="hljs-comment"># è¾¹æ¡ä»¶åˆ¤æ–­ä¸æ¶ˆæ¯ä¼ é€’</span>
        <span class="hljs-comment"># ... è®°å½•èŠ‚ç‚¹ç»“æŸ ...</span>
</code></pre>
<p><strong>æŠ€æœ¯è¦ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>ä¸Šä¸‹æ–‡ç®¡ç†å™¨</strong>ï¼š<code>resource_manager.guard_node(node)</code> ç¡®ä¿äº†èŠ‚ç‚¹æ‰§è¡ŒæœŸé—´çš„èµ„æºï¼ˆå¦‚Tokené™æµã€å¹¶å‘é”ï¼‰è¢«æ­£ç¡®ç®¡ç†ã€‚</li>
<li><strong>åŠ¨æ€é…ç½®æ¢æµ‹</strong>ï¼š<code>_get_dynamic_config_for_node</code> æ£€æŸ¥è¯¥èŠ‚ç‚¹çš„æ‰€æœ‰å…¥è¾¹ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦å¯åŠ¨åŠ¨æ€åˆ†æ”¯æ‰§è¡Œã€‚è¿™æ˜¯å®ç°é«˜åº¦çµæ´»å·¥ä½œæµçš„å…³é”®ã€‚</li>
<li><strong>æ’ä»¶åŒ–æ‰§è¡Œ</strong>ï¼š<code>_process_result</code> å†…éƒ¨é€šè¿‡ <code>NodeExecutorFactory</code> è·å–å¯¹åº”èŠ‚ç‚¹ç±»å‹çš„æ‰§è¡Œå™¨ï¼Œå®ç°äº†æ‰§è¡Œé€»è¾‘çš„æ’ä»¶åŒ–ã€‚</li>
<li><strong>æ¶ˆæ¯é©±åŠ¨</strong>ï¼šèŠ‚ç‚¹æ‰§è¡Œåï¼Œå…¶è¾“å‡ºæ¶ˆæ¯ä¼šä¸»åŠ¨â€œæ¨é€â€åˆ°æ‰€æœ‰å‡ºè¾¹ (<code>_process_edge_output</code>)ã€‚è¾¹ç®¡ç†å™¨è´Ÿè´£è¯„ä¼°æ¡ä»¶ï¼Œè‹¥æ¡ä»¶æ»¡è¶³ï¼Œåˆ™å°†å¤„ç†åçš„æ¶ˆæ¯æ”¾å…¥ç›®æ ‡èŠ‚ç‚¹çš„è¾“å…¥é˜Ÿåˆ—ï¼Œä»è€Œè§¦å‘ä¸‹æ¸¸æ‰§è¡Œã€‚è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ã€‚</li>
</ol>
<h4 data-id="heading-14">5.3 è½»é‡çº§SDKå…¥å£ï¼š<code>runtime.sdk.run_workflow()</code></h4>
<p>è¯¥å‡½æ•°æ˜¯ç¼–ç¨‹å¼é›†æˆçš„ä¸»è¦å…¥å£ï¼Œå±•ç¤ºäº†å¦‚ä½•è„±ç¦»Web Serverï¼Œä»¥åº“çš„å½¢å¼ä½¿ç”¨å¼•æ“ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">run_workflow</span>(<span class="hljs-params">yaml_file: <span class="hljs-type">Union</span>[<span class="hljs-built_in">str</span>, Path], *, task_prompt: <span class="hljs-built_in">str</span>, ...</span>) -&gt; WorkflowRunResult:
    <span class="hljs-string">"""Run a workflow YAML and return the end-node message plus metadata."""</span>
    ensure_schema_registry_populated() <span class="hljs-comment"># 1. åˆå§‹åŒ–ç±»å‹æ³¨å†Œè¡¨</span>

    yaml_path = _resolve_yaml_path(yaml_file) <span class="hljs-comment"># 2. å®šä½é…ç½®æ–‡ä»¶</span>
    design = load_config(yaml_path, ...) <span class="hljs-comment"># 3. åŠ è½½å¹¶æ ¡éªŒYAML</span>
    graph_config = GraphConfig.from_definition(...) <span class="hljs-comment"># 4. æ„å»ºè¿è¡Œæ—¶é…ç½®</span>

    graph_context = GraphContext(config=graph_config) <span class="hljs-comment"># 5. åˆ›å»ºå›¾ä¸Šä¸‹æ–‡</span>
    task_input = _build_task_input(graph_context, task_prompt, attachments) <span class="hljs-comment"># 6. æ„å»ºè¾“å…¥ï¼ˆæ”¯æŒé™„ä»¶ï¼‰</span>

    <span class="hljs-comment"># 7. æ ¸å¿ƒæ‰§è¡Œï¼šåˆ›å»ºæ‰§è¡Œå™¨å¹¶è¿è¡Œ</span>
    executor = GraphExecutor.execute_graph(graph_context, task_input)
    final_message = executor.get_final_output_message()

    <span class="hljs-comment"># 8. å°è£…ç»“æœå’Œå…ƒæ•°æ®è¿”å›</span>
    meta_info = WorkflowMetaInfo(session_name=..., outputs=executor.outputs, ...)
    <span class="hljs-keyword">return</span> WorkflowRunResult(final_message=final_message, meta_info=meta_info)
</code></pre>
<p><strong>è®¾è®¡ä»·å€¼</strong>ï¼š</p>
<ol>
<li><strong>APIç®€æ´</strong>ï¼šç”¨æˆ·åªéœ€å…³æ³¨YAMLè·¯å¾„å’Œä»»åŠ¡æç¤ºè¯ï¼Œå¼•æ“è´Ÿè´£æ‰€æœ‰ç¹é‡çš„åˆå§‹åŒ–ã€æ‰§è¡Œå’Œæ¸…ç†å·¥ä½œã€‚</li>
<li><strong>å®Œæ•´çš„å…ƒæ•°æ®</strong>ï¼šè¿”å›çš„ <code>WorkflowRunResult</code> ä¸ä»…åŒ…å«æœ€ç»ˆè¾“å‡ºæ¶ˆæ¯ï¼Œè¿˜åŒ…å«ä¼šè¯IDã€å®Œæ•´è¾“å‡ºå­—å…¸ã€Tokenç”¨é‡å’Œè¾“å‡ºç›®å½•è·¯å¾„ï¼Œæå¤§æ–¹ä¾¿äº†é›†æˆåçš„ç›‘æ§ã€å®¡è®¡å’Œè°ƒè¯•ã€‚</li>
<li><strong>ç‹¬ç«‹è¿›ç¨‹</strong>ï¼šSDKè°ƒç”¨å¯ä»¥åœ¨ä»»ä½•Pythonç¯å¢ƒä¸­è¿›è¡Œï¼Œæ— éœ€å¯åŠ¨HTTPæœåŠ¡ï¼Œé€‚åˆåµŒå…¥åˆ°è‡ªåŠ¨åŒ–è„šæœ¬ã€åå°æœåŠ¡æˆ–Jupyter Notebookä¸­ã€‚</li>
</ol>
<h3 data-id="heading-15">6. æ€»ç»“ä¸å¯¹æ¯”</h3>
<p><strong>ChatDev 2.0 ä¸ LangChain/CrewAI ç­‰æ¡†æ¶çš„å¯¹æ¯”</strong>ï¼š</p>






























<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">ChatDev 2.0</th><th align="left">LangChain/CrewAI</th></tr></thead><tbody><tr><td align="left"><strong>æŠ½è±¡å±‚çº§</strong></td><td align="left"><strong>â€œå›¾â€æŠ½è±¡</strong>ã€‚å°†æ•´ä¸ªå¤šæ™ºèƒ½ä½“ç³»ç»Ÿè§†ä¸ºä¸€ä¸ªå¯æ‰§è¡Œçš„æ•°æ®æµå›¾ã€‚</td><td align="left"><strong>â€œé“¾/å›¢é˜Ÿâ€æŠ½è±¡</strong>ã€‚ä¾§é‡äºå°†å¤šä¸ªå¯è°ƒç”¨å¯¹è±¡é“¾æ¥èµ·æ¥ï¼Œæˆ–å®šä¹‰ä¸€ç»„æ™ºèƒ½ä½“è§’è‰²ã€‚</td></tr><tr><td align="left"><strong>é…ç½®æ–¹å¼</strong></td><td align="left"><strong>å£°æ˜å¼ (YAML)</strong>ã€‚é€»è¾‘ä¸æ‰§è¡Œåˆ†ç¦»ï¼Œé…ç½®å³è“å›¾ï¼Œæ˜“äºå¯è§†åŒ–ã€‚</td><td align="left"><strong>ç¼–ç¨‹å¼ (Python)</strong>ã€‚é€»è¾‘åµŒå…¥åœ¨ä»£ç ä¸­ï¼Œçµæ´»ä½†é…ç½®å’Œç‰ˆæœ¬ç®¡ç†è¾ƒå¤æ‚ã€‚</td></tr><tr><td align="left"><strong>æ ¸å¿ƒä¼˜åŠ¿</strong></td><td align="left"><strong>å¼ºå¤§çš„æ‰§è¡Œå¼•æ“</strong>ã€‚å†…ç½®DAG/å¾ªç¯/æŠ•ç¥¨ç­–ç•¥ã€åŠ¨æ€è¾¹ã€è®°å¿†ç®¡ç†ã€èµ„æºæ§åˆ¶ã€‚</td><td align="left"><strong>ä¸°å¯Œçš„ç”Ÿæ€é›†æˆ</strong>ã€‚è¿æ¥å™¨ï¼ˆå·¥å…·ã€æ¨¡å‹ã€å‘é‡åº“ï¼‰ä¼—å¤šï¼Œç¤¾åŒºæ´»è·ƒã€‚</td></tr><tr><td align="left"><strong>é€‚ç”¨åœºæ™¯</strong></td><td align="left">éœ€è¦<strong>å¤æ‚æµç¨‹æ§åˆ¶</strong>ã€<strong>å¯è§†åŒ–ç¼–æ’</strong>ã€<strong>äººæœºäº¤äº’</strong>ã€<strong>ç¨³å®šæ‰§è¡Œ</strong>çš„ç”Ÿäº§çº§åº”ç”¨ã€‚</td><td align="left">éœ€è¦<strong>å¿«é€ŸåŸå‹éªŒè¯</strong>ã€<strong>åˆ©ç”¨ä¸°å¯Œç”Ÿæ€</strong>ã€<strong>æ·±åº¦å®šåˆ¶æ™ºèƒ½ä½“è¡Œä¸º</strong>çš„ç ”ç©¶æˆ–è½»é‡çº§åº”ç”¨ã€‚</td></tr></tbody></table>
<p><strong>æŠ€æœ¯è´¡çŒ®æ€»ç»“</strong>ï¼š
ChatDev 2.0 (DevAll) çš„æ ¸å¿ƒè´¡çŒ®åœ¨äºï¼Œå®ƒå°†å¤šæ™ºèƒ½ä½“ç³»ç»Ÿä¸­é‚£äº›å¤æ‚ä¸”é€šç”¨çš„<strong>å·¥ç¨‹é—®é¢˜</strong>â€”â€”å¦‚å·¥ä½œæµè°ƒåº¦ã€æ¡ä»¶è·¯ç”±ã€çŠ¶æ€ç®¡ç†ã€è®°å¿†æŒä¹…åŒ–ã€äººæœºäº¤äº’â€”â€”æç‚¼å‡ºæ¥ï¼Œå¹¶æ„å»ºäº†ä¸€ä¸ª<strong>ç¨³å¥ã€å¯é…ç½®ã€é«˜æ€§èƒ½çš„é€šç”¨æ‰§è¡Œå¼•æ“</strong>ã€‚é€šè¿‡â€œå›¾â€è¿™ä¸€ä¼˜é›…çš„æŠ½è±¡ï¼Œå®ƒæˆåŠŸåœ°åœ¨<strong>çµæ´»æ€§</strong>ï¼ˆæ”¯æŒå„ç§åä½œæ¨¡å¼ï¼‰å’Œ<strong>æ˜“ç”¨æ€§</strong>ï¼ˆé›¶ä»£ç é…ç½®ï¼‰ä¹‹é—´å–å¾—äº†è‰¯å¥½å¹³è¡¡ã€‚å…¶æ¨¡å—åŒ–æ¶æ„å’Œæ¸…æ™°çš„æ¥å£è®¾è®¡ï¼ˆå¦‚ <code>NodeExecutor</code>, <code>ConditionManager</code>ï¼‰ä¹Ÿä¸ºç¤¾åŒºè´¡çŒ®å’ŒæŠ€æœ¯æ¼”è¿›å¥ å®šäº†åšå®åŸºç¡€ã€‚è¯¥é¡¹ç›®æ ‡å¿—ç€å¤šæ™ºèƒ½ä½“æŠ€æœ¯ä»å­¦æœ¯è®ºæ–‡å’Œæ¼”ç¤ºåŸå‹ï¼Œèµ°å‘æ ‡å‡†åŒ–ã€äº§å“åŒ–è½åœ°çš„é‡è¦ä¸€æ­¥ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»AIç¨‹åºå‘˜ï¼Œåˆ°AIé¡¹ç›®ç»ç†ï¼šVibe Kanbanâ€”â€”ä½ çš„AIç¼–ç¨‹åŠ©æ‰‹â€œç»ˆææŒ‡æŒ¥ä¸­å¿ƒâ€]]></title>    <link>https://juejin.cn/post/7596687697755324426</link>    <guid>https://juejin.cn/post/7596687697755324426</guid>    <pubDate>2026-01-19T07:48:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596687697755324426" data-draft-id="7596687515030798362" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»AIç¨‹åºå‘˜ï¼Œåˆ°AIé¡¹ç›®ç»ç†ï¼šVibe Kanbanâ€”â€”ä½ çš„AIç¼–ç¨‹åŠ©æ‰‹â€œç»ˆææŒ‡æŒ¥ä¸­å¿ƒâ€"/> <meta itemprop="keywords" content="AIç¼–ç¨‹,å¼€æº"/> <meta itemprop="datePublished" content="2026-01-19T07:48:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§å‚æŠ€æœ¯æ€»ç›‘ä¸‹æµ·"/> <meta itemprop="url" content="https://juejin.cn/user/4091714106833577"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»AIç¨‹åºå‘˜ï¼Œåˆ°AIé¡¹ç›®ç»ç†ï¼šVibe Kanbanâ€”â€”ä½ çš„AIç¼–ç¨‹åŠ©æ‰‹â€œç»ˆææŒ‡æŒ¥ä¸­å¿ƒâ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4091714106833577/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§å‚æŠ€æœ¯æ€»ç›‘ä¸‹æµ·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T07:48:42.000Z" title="Mon Jan 19 2026 07:48:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Vibe Kanban æŠ€æœ¯æ·±åº¦è§£æï¼šAI ç¼–ç¨‹åŠ©æ‰‹çš„ä»»åŠ¡ç¼–æ’ä¸ååŒæŒ‡æŒ¥ä¸­å¿ƒ</h2>
<h3 data-id="heading-1">1. æ•´ä½“ä»‹ç»</h3>
<h4 data-id="heading-2">1.1 é¡¹ç›®æ¦‚è¦</h4>
<p><strong>Vibe Kanban</strong> æ˜¯ BloopAI å›¢é˜Ÿå¼€æºçš„ AI ç¼–ç¨‹åŠ©æ‰‹ååŒç®¡ç†å¹³å°ï¼Œé¡¹ç›®åœ°å€ä¸º <code>https://github.com/BloopAI/vibe-kanban</code>ã€‚è¯¥é¡¹ç›®æ—¨åœ¨è§£å†³ AI ç¼–ç¨‹æ—¶ä»£å·¥ç¨‹å¸ˆé¢ä¸´çš„å¤šåŠ©æ‰‹ç®¡ç†å¤æ‚æ€§é—®é¢˜ï¼Œæä¾›ä¸€ä¸ªç»Ÿä¸€çš„å¯è§†åŒ–ç¼–æ’ç•Œé¢ã€‚</p>
<h4 data-id="heading-3">1.2 ä¸»è¦åŠŸèƒ½ä¸æ ¸å¿ƒä»·å€¼</h4>
<p><strong>æ ¸å¿ƒåŠŸèƒ½ä½“ç³»</strong>ï¼š</p>
<ol>
<li><strong>å¤šåŠ©æ‰‹ä»»åŠ¡ç¼–æ’</strong> - æ”¯æŒ Claude Codeã€Geminiã€Ampã€Codex ç­‰ä¸»æµ AI ç¼–ç¨‹åŠ©æ‰‹çš„å¹¶è¡Œ/ä¸²è¡Œä»»åŠ¡è°ƒåº¦</li>
<li><strong>Git å·¥ä½œæµé›†æˆ</strong> - è‡ªåŠ¨åŒ–åˆ†æ”¯ç®¡ç†ã€ä»£ç å®¡æŸ¥ã€PR åˆ›å»ºä¸åˆå¹¶</li>
<li><strong>è¿œç¨‹å¼€å‘æ”¯æŒ</strong> - é€šè¿‡ SSH éš§é“å®ç°æœ¬åœ°ç¼–è¾‘å™¨ä¸è¿œç¨‹æœåŠ¡å™¨çš„æ— ç¼è¿æ¥</li>
<li><strong>é…ç½®é›†ä¸­ç®¡ç†</strong> - ç»Ÿä¸€çš„ MCPï¼ˆModel Context Protocolï¼‰é…ç½®ä¸­å¿ƒ</li>
</ol>
<p><strong>è§£å†³çš„é—®é¢˜åœºæ™¯</strong>ï¼š</p>
<ul>
<li><strong>åœºæ™¯ç¢ç‰‡åŒ–</strong>ï¼šå·¥ç¨‹å¸ˆéœ€è¦é¢‘ç¹åœ¨ä¸åŒ AI åŠ©æ‰‹é—´åˆ‡æ¢ï¼Œå·¥ä½œæµç¨‹è¢«æ‰“æ–­</li>
<li><strong>çŠ¶æ€ç®¡ç†å›°éš¾</strong>ï¼šå¤šä¸ªå¹¶å‘ä»»åŠ¡çš„çŠ¶æ€è·Ÿè¸ªã€è¿›åº¦ç›‘æ§ç¼ºä¹ç»Ÿä¸€è§†å›¾</li>
<li><strong>ç¯å¢ƒé…ç½®å¤æ‚</strong>ï¼šæ¯ä¸ª AI åŠ©æ‰‹æœ‰ç‹¬ç«‹çš„é…ç½®ä½“ç³»ï¼Œç»´æŠ¤æˆæœ¬é«˜</li>
<li><strong>åä½œæ•ˆç‡ä½ä¸‹</strong>ï¼šå›¢é˜Ÿé—´éš¾ä»¥å…±äº« AI ç”Ÿæˆçš„ä»»åŠ¡ä¸Šä¸‹æ–‡å’Œæˆæœ</li>
</ul>
<p><strong>æŠ€æœ¯æ–¹æ¡ˆæ¼”è¿›å¯¹æ¯”</strong>ï¼š</p>

























<table><thead><tr><th>ä¼ ç»Ÿæ–¹å¼</th><th>Vibe Kanban æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>æ‰‹åŠ¨åˆ‡æ¢ä¸åŒç»ˆç«¯/ç•Œé¢</td><td>ç»Ÿä¸€ Web ç•Œé¢é›†ä¸­ç®¡ç†</td></tr><tr><td>ç‹¬ç«‹ç»´æŠ¤å„åŠ©æ‰‹é…ç½®</td><td>ä¸­å¿ƒåŒ–é…ç½®ç®¡ç†ï¼Œæ”¯æŒç¯å¢ƒå˜é‡æ³¨å…¥</td></tr><tr><td>Git æ“ä½œéœ€äººå·¥ä»‹å…¥</td><td>è‡ªåŠ¨åŒ– Git å·¥ä½œæµï¼Œæ”¯æŒå†²çªè§£å†³</td></tr><tr><td>æœ¬åœ°å¼€å‘ç¯å¢ƒé™åˆ¶</td><td>è¿œç¨‹ SSH å¼€å‘æ”¯æŒï¼Œç¯å¢ƒéš”ç¦»</td></tr></tbody></table>
<p><strong>å•†ä¸šä»·å€¼é¢„ä¼°</strong>ï¼š
åŸºäºä»£ç è§„æ¨¡ï¼ˆçº¦ 5-8 ä¸‡è¡Œä»£ç ï¼‰å’ŒæŠ€æœ¯å¤æ‚åº¦ï¼Œè‹¥é‡‡ç”¨ä¼ ç»Ÿè‡ªç ”æ–¹æ¡ˆï¼š</p>
<ul>
<li><strong>å¼€å‘æˆæœ¬</strong>ï¼šçº¦ 6-8 äººæœˆï¼ˆé«˜çº§å…¨æ ˆå›¢é˜Ÿï¼‰</li>
<li><strong>è¿ç»´æˆæœ¬</strong>ï¼šä¸­ç­‰ï¼Œéœ€ç»´æŠ¤ Rust åç«¯ + React å‰ç«¯ + æ•°æ®åº“</li>
<li><strong>è¦†ç›–æ•ˆç›Š</strong>ï¼šè§£å†³ AI ç¼–ç¨‹å·¥ä½œæµä¸­çš„å…³é”®ç“¶é¢ˆï¼Œç†è®ºä¸Šå¯æå‡å·¥ç¨‹å¸ˆæ•ˆç‡ 30-50%</li>
<li><strong>æ›¿ä»£æˆæœ¬</strong>ï¼šç­‰æ•ˆäºè´­ä¹°å¤šä¸ªå•†ä¸š AI åŠ©æ‰‹ç®¡ç†å·¥å…·çš„é›†æˆè´¹ç”¨</li>
</ul>
<h3 data-id="heading-4">2. è¯¦ç»†åŠŸèƒ½æ‹†è§£</h3>
<h4 data-id="heading-5">2.1 æ¶æ„è®¾è®¡è§†è§’</h4>
<p><strong>ç³»ç»Ÿåˆ†å±‚æ¶æ„</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          è¡¨ç°å±‚ (Presentation)      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   React UI  â”‚ â”‚   WebSocket  â”‚  â”‚
â”‚  â”‚   (å‰ç«¯)    â”‚ â”‚  å®æ—¶é€šä¿¡    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          åº”ç”¨å±‚ (Application)       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ä»»åŠ¡ç¼–æ’å¼•æ“ â”‚ â”‚ Git æ“ä½œæœåŠ¡ â”‚  â”‚
â”‚  â”‚  Executor   â”‚ â”‚   Service    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          é¢†åŸŸå±‚ (Domain)            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Task â”‚ Workspace â”‚ Session  â”‚  â”‚
â”‚  â”‚  Project â”‚ Repo â”‚ Execution  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          åŸºç¡€è®¾æ–½å±‚ (Infrastructure)â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  DB  â”‚ â”‚ Git  â”‚ â”‚  File    â”‚  â”‚
â”‚  â”‚(SQLite)â”‚ â”‚æ“ä½œåº“â”‚ â”‚  ç³»ç»Ÿ   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-6">2.2 æ ¸å¿ƒåŠŸèƒ½æ¨¡å—</h4>
<p><strong>ä»»åŠ¡ç¼–æ’ç³»ç»Ÿ</strong>ï¼š</p>
<ul>
<li><strong>çŠ¶æ€æœºè®¾è®¡</strong>ï¼šåŸºäº <code>TaskStatus</code> æšä¸¾ï¼ˆtodo/inprogress/inreview/done/cancelledï¼‰çš„ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸç®¡ç†</li>
<li><strong>å¹¶å‘æ§åˆ¶</strong>ï¼šæ”¯æŒå¤šä¸ª AI åŠ©æ‰‹å¹¶è¡Œå¤„ç†ä¸åŒä»»åŠ¡ï¼Œé¿å…èµ„æºå†²çª</li>
<li><strong>ä¾èµ–ç®¡ç†</strong>ï¼šé€šè¿‡ <code>parent_workspace_id</code> å®ç°ä»»åŠ¡é—´ä¾èµ–å…³ç³»</li>
</ul>
<p><strong>Git é›†æˆå¼•æ“</strong>ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// ç®€åŒ–çš„ Git æ“ä½œæŠ½è±¡</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">GitIntegration</span> {
    <span class="hljs-comment">// å·¥ä½œæ ‘éš”ç¦»ï¼šæ¯ä¸ªä»»åŠ¡åœ¨ç‹¬ç«‹ Git å·¥ä½œæ ‘ä¸­æ‰§è¡Œ</span>
    worktrees: HashMap&lt;<span class="hljs-type">String</span>, Worktree&gt;,
    <span class="hljs-comment">// åˆ†æ”¯ç®¡ç†ï¼šè‡ªåŠ¨åˆ›å»ºã€åˆå¹¶ã€è§£å†³å†²çª</span>
    branch_manager: BranchManager,
    <span class="hljs-comment">// æäº¤è¿½è¸ªï¼šè®°å½•æ¯æ¬¡ AI æ“ä½œçš„ Git å˜æ›´</span>
    commit_tracker: CommitTracker,
}
</code></pre>
<p><strong>MCP é…ç½®ç®¡ç†</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// MCP æœåŠ¡å™¨é…ç½®ç»“æ„</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">McpConfig</span> {
    <span class="hljs-attr">servers</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">JsonValue</span>&gt;;  <span class="hljs-comment">// æœåŠ¡å™¨é…ç½®</span>
    <span class="hljs-attr">servers_path</span>: <span class="hljs-built_in">string</span>[];             <span class="hljs-comment">// é…ç½®æ–‡ä»¶è·¯å¾„</span>
    <span class="hljs-attr">template</span>: <span class="hljs-title class_">JsonValue</span>;                <span class="hljs-comment">// é…ç½®æ¨¡æ¿</span>
    <span class="hljs-attr">preconfigured</span>: <span class="hljs-title class_">JsonValue</span>;           <span class="hljs-comment">// é¢„é…ç½®é¡¹</span>
    <span class="hljs-attr">is_toml_config</span>: <span class="hljs-built_in">boolean</span>;           <span class="hljs-comment">// é…ç½®æ ¼å¼æ ‡è¯†</span>
}
</code></pre>
<h3 data-id="heading-7">3. æŠ€æœ¯éš¾ç‚¹æŒ–æ˜</h3>
<h4 data-id="heading-8">3.1 å¤š AI åŠ©æ‰‹çš„æ ‡å‡†åŒ–æ¥å£</h4>
<p><strong>éš¾ç‚¹</strong>ï¼šä¸åŒ AI åŠ©æ‰‹ï¼ˆClaude Codeã€Geminiã€Amp ç­‰ï¼‰æœ‰å„è‡ªçš„ CLI æ¥å£ã€é…ç½®æ ¼å¼å’Œè¾“å‡ºè§„èŒƒã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li><strong>æŠ½è±¡æ‰§è¡Œå™¨æ¨¡å¼</strong>ï¼šå®šä¹‰ç»Ÿä¸€çš„ <code>Executor</code> trait</li>
<li><strong>é…ç½®é€‚é…å™¨</strong>ï¼šæ¯ä¸ªåŠ©æ‰‹å¯¹åº”ä¸€ä¸ªé…ç½®é€‚é…å™¨</li>
<li><strong>è¾“å‡ºè§„èŒƒåŒ–</strong>ï¼šå°†ä¸åŒåŠ©æ‰‹çš„è¾“å‡ºè½¬æ¢ä¸ºæ ‡å‡†åŒ–çš„ <code>NormalizedEntry</code></li>
</ul>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// æ‰§è¡Œå™¨æŠ½è±¡å®šä¹‰</span>
<span class="hljs-keyword">trait</span> <span class="hljs-title class_">Executor</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">execute</span>(&amp;<span class="hljs-keyword">self</span>, request: ExecutorRequest) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;ExecutorResponse&gt;;
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">validate_config</span>(&amp;<span class="hljs-keyword">self</span>, config: &amp;JsonValue) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;()&gt;;
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">normalize_output</span>(&amp;<span class="hljs-keyword">self</span>, raw: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> NormalizedEntry;
}

<span class="hljs-comment">// å…·ä½“æ‰§è¡Œå™¨å®ç°ï¼ˆä»¥ Claude Code ä¸ºä¾‹ï¼‰</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">ClaudeCodeExecutor</span> {
    config: ClaudeCodeConfig,
    command_builder: CommandBuilder,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Executor</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">ClaudeCodeExecutor</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">execute</span>(&amp;<span class="hljs-keyword">self</span>, request: ExecutorRequest) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;ExecutorResponse&gt; {
        <span class="hljs-comment">// æ„å»º CLI å‘½ä»¤</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">cmd</span> = <span class="hljs-keyword">self</span>.command_builder.<span class="hljs-title function_ invoke__">build</span>(&amp;request);
        <span class="hljs-comment">// æ‰§è¡Œå¹¶æ•è·è¾“å‡º</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">output</span> = <span class="hljs-title function_ invoke__">execute_command</span>(cmd)?;
        <span class="hljs-comment">// è§„èŒƒåŒ–è¾“å‡º</span>
        <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">normalize_output</span>(&amp;output)
    }
}
</code></pre>
<h4 data-id="heading-9">3.2 Git æ“ä½œçš„å®‰å…¨æ€§ä¸åŸå­æ€§</h4>
<p><strong>éš¾ç‚¹</strong>ï¼šå¹¶å‘ Git æ“ä½œå¯èƒ½å¯¼è‡´ä»“åº“æŸåã€å†²çªæ— æ³•è‡ªåŠ¨è§£å†³ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li><strong>å·¥ä½œæ ‘éš”ç¦»</strong>ï¼šæ¯ä¸ªä»»åŠ¡åœ¨ç‹¬ç«‹çš„ Git å·¥ä½œæ ‘ä¸­æ‰§è¡Œ</li>
<li><strong>æ“ä½œé˜Ÿåˆ—</strong>ï¼šGit æ“ä½œä¸²è¡ŒåŒ–ï¼Œé¿å…å¹¶å‘å†²çª</li>
<li><strong>äº‹åŠ¡æ€§æäº¤</strong>ï¼šæ”¯æŒæ“ä½œå›æ»šå’ŒçŠ¶æ€æ¢å¤</li>
</ol>
<h4 data-id="heading-10">3.3 å®æ—¶é€šä¿¡ä¸çŠ¶æ€åŒæ­¥</h4>
<p><strong>éš¾ç‚¹</strong>ï¼šå‰ç«¯éœ€è¦å®æ—¶æ˜¾ç¤º AI åŠ©æ‰‹çš„æ‰§è¡Œè¿›åº¦ã€æ—¥å¿—è¾“å‡ºã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li><strong>WebSocket åŒå‘é€šä¿¡</strong>ï¼šåç«¯æ¨é€æ‰§è¡ŒçŠ¶æ€æ›´æ–°</li>
<li><strong>å¢é‡æ›´æ–°æœºåˆ¶</strong>ï¼šåªä¼ è¾“å˜æ›´éƒ¨åˆ†ï¼Œå‡å°‘å¸¦å®½æ¶ˆè€—</li>
<li><strong>è¿æ¥é‡è¯•ä¸çŠ¶æ€æ¢å¤</strong>ï¼šæ–­çº¿åè‡ªåŠ¨æ¢å¤å¹¶åŒæ­¥æœ€æ–°çŠ¶æ€</li>
</ul>
<h3 data-id="heading-11">4. è¯¦ç»†è®¾è®¡å›¾</h3>
<h4 data-id="heading-12">4.1 ç³»ç»Ÿæ¶æ„å›¾</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph "å®¢æˆ·ç«¯å±‚"
        A[Webå‰ç«¯&lt;br/&gt;React + TypeScript]
        B[æœ¬åœ°ç¼–è¾‘å™¨&lt;br/&gt;VSCode/Cursor]
        C[CLIå·¥å…·&lt;br/&gt;npxå‘½ä»¤]
    end
    
    subgraph "ç½‘å…³å±‚"
        D[HTTP APIç½‘å…³]
        E[WebSocketç½‘å…³]
        F[SSHéš§é“ä»£ç†]
    end
    
    subgraph "åº”ç”¨æœåŠ¡å±‚"
        G[ä»»åŠ¡ç¼–æ’æœåŠ¡]
        H[Gitæ“ä½œæœåŠ¡]
        I[MCPé…ç½®æœåŠ¡]
        J[æ‰§è¡Œå™¨ç®¡ç†æœåŠ¡]
    end
    
    subgraph "é¢†åŸŸæ¨¡å‹å±‚"
        K[Taskèšåˆæ ¹]
        L[Workspaceå€¼å¯¹è±¡]
        M[Sessionå®ä½“]
        N[ExecutionProcesså®ä½“]
    end
    
    subgraph "åŸºç¡€è®¾æ–½å±‚"
        O[(SQLiteæ•°æ®åº“)]
        P[Gitä»“åº“]
        Q[æ–‡ä»¶ç³»ç»Ÿ]
        R[å¤–éƒ¨AIåŠ©æ‰‹]
    end
    
    A --&gt; D
    A --&gt; E
    B --&gt; F
    C --&gt; D
    
    D --&gt; G
    E --&gt; G
    F --&gt; H
    
    G --&gt; K
    H --&gt; L
    J --&gt; M
    G --&gt; N
    
    K --&gt; O
    L --&gt; P
    N --&gt; Q
    J --&gt; R
</code></pre>
<h4 data-id="heading-13">4.2 ä»»åŠ¡åˆ›å»ºä¸æ‰§è¡Œåºåˆ—å›¾</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant U as ç”¨æˆ·
    participant F as å‰ç«¯UI
    participant B as åç«¯API
    participant E as æ‰§è¡Œå™¨å¼•æ“
    participant G as GitæœåŠ¡
    participant A as AIåŠ©æ‰‹
    
    U-&gt;&gt;F: åˆ›å»ºæ–°ä»»åŠ¡
    F-&gt;&gt;B: POST /api/tasks
    B-&gt;&gt;G: åˆ›å»ºGitå·¥ä½œæ ‘
    G--&gt;&gt;B: è¿”å›å·¥ä½œæ ‘è·¯å¾„
    B-&gt;&gt;B: åˆ›å»ºTaskå’ŒWorkspaceè®°å½•
    B--&gt;&gt;F: è¿”å›ä»»åŠ¡ID
    
    U-&gt;&gt;F: å¯åŠ¨ä»»åŠ¡æ‰§è¡Œ
    F-&gt;&gt;B: POST /api/tasks/{id}/execute
    B-&gt;&gt;E: å‡†å¤‡æ‰§è¡Œç¯å¢ƒ
    E-&gt;&gt;G: æ£€æŸ¥åˆ†æ”¯çŠ¶æ€
    G--&gt;&gt;E: è¿”å›GitçŠ¶æ€
    E-&gt;&gt;A: è°ƒç”¨AIåŠ©æ‰‹CLI
    A--&gt;&gt;E: æµå¼è¾“å‡º
    
    Note over E: å®æ—¶å¤„ç†è¾“å‡º
    E-&gt;&gt;B: WebSocketæ¨é€æ—¥å¿—
    B-&gt;&gt;F: å®æ—¶æ›´æ–°UI
    E-&gt;&gt;G: æäº¤AIç”Ÿæˆçš„ä»£ç 
    G--&gt;&gt;E: æäº¤æˆåŠŸ
    
    E-&gt;&gt;B: æ ‡è®°ä»»åŠ¡å®Œæˆ
    B--&gt;&gt;F: æ›´æ–°ä»»åŠ¡çŠ¶æ€
</code></pre>
<h4 data-id="heading-14">4.3 æ ¸å¿ƒé¢†åŸŸç±»å›¾</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">classDiagram
    class Task {
        +String id
        +String project_id
        +String title
        +TaskStatus status
        +String description
        +create() Task
        +update() void
        +changeStatus() void
    }
    
    class Workspace {
        +String id
        +String task_id
        +String branch
        +boolean archived
        +boolean pinned
        +setup() void
        +archive() void
    }
    
    class Session {
        +String id
        +String workspace_id
        +String executor
        +List~ExecutionProcess~ processes
        +start() void
        +end() void
    }
    
    class ExecutionProcess {
        +String id
        +String session_id
        +ExecutionProcessStatus status
        +ExecutorAction action
        +start() void
        +complete() void
        +fail() void
    }
    
    class Project {
        +String id
        +String name
        +List~Repo~ repositories
        +addRepo() void
        +removeRepo() void
    }
    
    class Repo {
        +String id
        +String path
        +String name
        +String display_name
        +GitIntegration git
    }
    
    Task "1" -- "0..*" Workspace
    Workspace "1" -- "0..*" Session
    Session "1" -- "1..*" ExecutionProcess
    Project "1" -- "1..*" Repo
    Task "1" -- "1" Project
</code></pre>
<h4 data-id="heading-15">4.4 æ ¸å¿ƒå‡½æ•°è°ƒç”¨å…³ç³»</h4>
<pre><code class="hljs language-scss" lang="scss">ä»»åŠ¡æ‰§è¡Œä¸»æµç¨‹ï¼š
<span class="hljs-built_in">main_execute_task</span>()
â”œâ”€â”€ <span class="hljs-built_in">validate_task_input</span>()      # è¾“å…¥éªŒè¯
â”œâ”€â”€ <span class="hljs-built_in">create_git_worktree</span>()      # åˆ›å»ºGitå·¥ä½œæ ‘
â”œâ”€â”€ <span class="hljs-built_in">prepare_executor_config</span>()  # å‡†å¤‡æ‰§è¡Œå™¨é…ç½®
â”œâ”€â”€ <span class="hljs-built_in">spawn_ai_process</span>()         # å¯åŠ¨AIè¿›ç¨‹
â”‚   â”œâ”€â”€ <span class="hljs-built_in">build_cli_command</span>()    # æ„å»ºCLIå‘½ä»¤
â”‚   â”œâ”€â”€ <span class="hljs-built_in">setup_environment</span>()    # è®¾ç½®ç¯å¢ƒå˜é‡
â”‚   â””â”€â”€ <span class="hljs-built_in">start_streaming</span>()      # å¯åŠ¨è¾“å‡ºæµ
â”œâ”€â”€ <span class="hljs-built_in">monitor_execution</span>()        # ç›‘æ§æ‰§è¡Œè¿‡ç¨‹
â”‚   â”œâ”€â”€ <span class="hljs-built_in">parse_stdout</span>()         # è§£ææ ‡å‡†è¾“å‡º
â”‚   â”œâ”€â”€ <span class="hljs-built_in">handle_stderr</span>()        # å¤„ç†é”™è¯¯è¾“å‡º
â”‚   â””â”€â”€ <span class="hljs-built_in">update_task_status</span>()   # æ›´æ–°ä»»åŠ¡çŠ¶æ€
â””â”€â”€ <span class="hljs-built_in">finalize_execution</span>()       # æœ€ç»ˆåŒ–æ‰§è¡Œ
    â”œâ”€â”€ <span class="hljs-built_in">commit_changes</span>()       # æäº¤ä»£ç å˜æ›´
    â”œâ”€â”€ <span class="hljs-built_in">cleanup_worktree</span>()     # æ¸…ç†å·¥ä½œæ ‘
    â””â”€â”€ <span class="hljs-built_in">send_notifications</span>()   # å‘é€é€šçŸ¥
</code></pre>
<h3 data-id="heading-16">5. æ ¸å¿ƒä»£ç è§£æ</h3>
<h4 data-id="heading-17">5.1 ä»»åŠ¡çŠ¶æ€æœºå®ç°</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// shared/types.ts - ä»»åŠ¡çŠ¶æ€å®šä¹‰</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">TaskStatus</span> = 
  | <span class="hljs-string">"todo"</span>        <span class="hljs-comment">// å¾…å¤„ç†</span>
  | <span class="hljs-string">"inprogress"</span>  <span class="hljs-comment">// è¿›è¡Œä¸­ï¼ˆAIæ­£åœ¨æ‰§è¡Œï¼‰</span>
  | <span class="hljs-string">"inreview"</span>    <span class="hljs-comment">// å®¡æŸ¥ä¸­ï¼ˆç­‰å¾…äººå·¥å®¡æŸ¥ï¼‰</span>
  | <span class="hljs-string">"done"</span>        <span class="hljs-comment">// å·²å®Œæˆ</span>
  | <span class="hljs-string">"cancelled"</span>;  <span class="hljs-comment">// å·²å–æ¶ˆ</span>

<span class="hljs-comment">// çŠ¶æ€è½¬æ¢éªŒè¯å‡½æ•°</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">canTransition</span>(<span class="hljs-params">
  <span class="hljs-keyword">from</span>: TaskStatus, 
  to: TaskStatus
</span>): <span class="hljs-built_in">boolean</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">allowedTransitions</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-title class_">TaskStatus</span>, <span class="hljs-title class_">TaskStatus</span>[]&gt; = {
    <span class="hljs-attr">todo</span>: [<span class="hljs-string">"inprogress"</span>, <span class="hljs-string">"cancelled"</span>],
    <span class="hljs-attr">inprogress</span>: [<span class="hljs-string">"inreview"</span>, <span class="hljs-string">"cancelled"</span>],
    <span class="hljs-attr">inreview</span>: [<span class="hljs-string">"todo"</span>, <span class="hljs-string">"done"</span>, <span class="hljs-string">"cancelled"</span>],
    <span class="hljs-attr">done</span>: [<span class="hljs-string">"todo"</span>],  <span class="hljs-comment">// é‡æ–°æ‰“å¼€å·²å®Œæˆä»»åŠ¡</span>
    <span class="hljs-attr">cancelled</span>: [<span class="hljs-string">"todo"</span>]  <span class="hljs-comment">// é‡æ–°å¼€å§‹å·²å–æ¶ˆä»»åŠ¡</span>
  };
  
  <span class="hljs-keyword">return</span> allowedTransitions[<span class="hljs-keyword">from</span>]?.<span class="hljs-title function_">includes</span>(to) || <span class="hljs-literal">false</span>;
}

<span class="hljs-comment">// ä»»åŠ¡å®ä½“ç±»ï¼ˆç®€åŒ–ç‰ˆï¼‰</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">
    <span class="hljs-keyword">public</span> id: <span class="hljs-built_in">string</span>,
    <span class="hljs-keyword">public</span> projectId: <span class="hljs-built_in">string</span>,
    <span class="hljs-keyword">public</span> title: <span class="hljs-built_in">string</span>,
    <span class="hljs-keyword">public</span> status: TaskStatus,
    <span class="hljs-keyword">public</span> description?: <span class="hljs-built_in">string</span>
  </span>) {}
  
  <span class="hljs-comment">// çŠ¶æ€è½¬æ¢æ–¹æ³•</span>
  <span class="hljs-title function_">transitionTo</span>(<span class="hljs-attr">newStatus</span>: <span class="hljs-title class_">TaskStatus</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">canTransition</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span>, newStatus)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(
        <span class="hljs-string">`Invalid status transition: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.status}</span> -&gt; <span class="hljs-subst">${newStatus}</span>`</span>
      );
    }
    
    <span class="hljs-comment">// æ‰§è¡ŒçŠ¶æ€ç›¸å…³çš„å‰¯ä½œç”¨</span>
    <span class="hljs-keyword">switch</span> (newStatus) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"inprogress"</span>:
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onStartExecution</span>();
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"inreview"</span>:
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onReadyForReview</span>();
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"done"</span>:
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onCompletion</span>();
        <span class="hljs-keyword">break</span>;
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = newStatus;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">updatedAt</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();
  }
  
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">onStartExecution</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// åˆ›å»ºGitå·¥ä½œæ ‘ï¼Œåˆå§‹åŒ–æ‰§è¡Œç¯å¢ƒ</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Starting execution for task <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.id}</span>`</span>);
  }
}
</code></pre>
<h4 data-id="heading-18">5.2 AI æ‰§è¡Œå™¨æŠ½è±¡å±‚</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// crates/executors/src/lib.rs - æ‰§è¡Œå™¨æŠ½è±¡</span>
<span class="hljs-keyword">use</span> async_trait::async_trait;
<span class="hljs-keyword">use</span> serde_json::Value <span class="hljs-keyword">as</span> JsonValue;

<span class="hljs-comment">/// ç»Ÿä¸€çš„æ‰§è¡Œå™¨è¯·æ±‚ç»“æ„</span>
<span class="hljs-meta">#[derive(Debug, Clone)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">ExecutorRequest</span> {
    <span class="hljs-keyword">pub</span> prompt: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> working_dir: <span class="hljs-type">Option</span>&lt;<span class="hljs-type">String</span>&gt;,
    <span class="hljs-keyword">pub</span> executor_profile_id: ExecutorProfileId,
    <span class="hljs-keyword">pub</span> session_id: <span class="hljs-type">Option</span>&lt;<span class="hljs-type">String</span>&gt;,
}

<span class="hljs-comment">/// æ‰§è¡Œå™¨å“åº”ç»“æ„</span>
<span class="hljs-meta">#[derive(Debug)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">ExecutorResponse</span> {
    <span class="hljs-keyword">pub</span> exit_code: <span class="hljs-type">Option</span>&lt;<span class="hljs-type">i32</span>&gt;,
    <span class="hljs-keyword">pub</span> output: <span class="hljs-type">String</span>,
    <span class="hljs-keyword">pub</span> normalized_entries: <span class="hljs-type">Vec</span>&lt;NormalizedEntry&gt;,
    <span class="hljs-keyword">pub</span> diff_changes: <span class="hljs-type">Vec</span>&lt;Diff&gt;,
}

<span class="hljs-comment">/// æ‰§è¡Œå™¨ trait å®šä¹‰</span>
<span class="hljs-meta">#[async_trait]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">trait</span> <span class="hljs-title class_">Executor</span>: <span class="hljs-built_in">Send</span> + <span class="hljs-built_in">Sync</span> {
    <span class="hljs-comment">/// æ‰§è¡Œä»»åŠ¡å¹¶è¿”å›ç»“æœ</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">execute</span>(
        &amp;<span class="hljs-keyword">self</span>,
        request: ExecutorRequest
    ) <span class="hljs-punctuation">-&gt;</span> anyhow::<span class="hljs-type">Result</span>&lt;ExecutorResponse&gt;;
    
    <span class="hljs-comment">/// éªŒè¯é…ç½®æ˜¯å¦æœ‰æ•ˆ</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">validate_config</span>(&amp;<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> anyhow::<span class="hljs-type">Result</span>&lt;()&gt;;
    
    <span class="hljs-comment">/// è·å–æ‰§è¡Œå™¨èƒ½åŠ›ä¿¡æ¯</span>
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">capabilities</span>(&amp;<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Vec</span>&lt;BaseAgentCapability&gt;;
    
    <span class="hljs-comment">/// æ£€æŸ¥æ‰§è¡Œå™¨æ˜¯å¦å¯ç”¨</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">check_availability</span>(&amp;<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> AvailabilityInfo;
}

<span class="hljs-comment">/// Claude Code æ‰§è¡Œå™¨å®ç°</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">ClaudeCodeExecutor</span> {
    config: ClaudeCodeConfig,
    command_builder: CommandBuilder,
}

<span class="hljs-meta">#[async_trait]</span>
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Executor</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">ClaudeCodeExecutor</span> {
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">execute</span>(
        &amp;<span class="hljs-keyword">self</span>,
        request: ExecutorRequest
    ) <span class="hljs-punctuation">-&gt;</span> anyhow::<span class="hljs-type">Result</span>&lt;ExecutorResponse&gt; {
        <span class="hljs-comment">// 1. æ„å»º CLI å‘½ä»¤</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">cmd</span> = <span class="hljs-keyword">self</span>.command_builder.<span class="hljs-title function_ invoke__">build</span>(
            &amp;request.prompt,
            request.working_dir.<span class="hljs-title function_ invoke__">as_deref</span>(),
            &amp;<span class="hljs-keyword">self</span>.config
        )?;
        
        <span class="hljs-comment">// 2. è®¾ç½®ç¯å¢ƒå˜é‡</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">envs</span> = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">prepare_environment</span>()?;
        
        <span class="hljs-comment">// 3. å¼‚æ­¥æ‰§è¡Œå‘½ä»¤å¹¶å®æ—¶æ•è·è¾“å‡º</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">child</span> = tokio::process::Command::<span class="hljs-title function_ invoke__">new</span>(&amp;cmd.base)
            .<span class="hljs-title function_ invoke__">args</span>(cmd.params.<span class="hljs-title function_ invoke__">unwrap_or_default</span>())
            .<span class="hljs-title function_ invoke__">envs</span>(envs)
            .<span class="hljs-title function_ invoke__">stdout</span>(std::process::Stdio::<span class="hljs-title function_ invoke__">piped</span>())
            .<span class="hljs-title function_ invoke__">stderr</span>(std::process::Stdio::<span class="hljs-title function_ invoke__">piped</span>())
            .<span class="hljs-title function_ invoke__">spawn</span>()?;
        
        <span class="hljs-comment">// 4. å¹¶è¡Œè¯»å– stdout å’Œ stderr</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">stdout</span> = child.stdout.<span class="hljs-title function_ invoke__">take</span>().<span class="hljs-title function_ invoke__">unwrap</span>();
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">stderr</span> = child.stderr.<span class="hljs-title function_ invoke__">take</span>().<span class="hljs-title function_ invoke__">unwrap</span>();
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">output</span> = tokio::join!(
            <span class="hljs-title function_ invoke__">read_stream</span>(stdout),
            <span class="hljs-title function_ invoke__">read_stream</span>(stderr)
        );
        
        <span class="hljs-comment">// 5. ç­‰å¾…è¿›ç¨‹ç»“æŸ</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">status</span> = child.<span class="hljs-title function_ invoke__">wait</span>().<span class="hljs-keyword">await</span>?;
        
        <span class="hljs-comment">// 6. è§„èŒƒåŒ–è¾“å‡º</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">normalized</span> = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">normalize_output</span>(&amp;output.<span class="hljs-number">0</span>, &amp;output.<span class="hljs-number">1</span>)?;
        
        <span class="hljs-title function_ invoke__">Ok</span>(ExecutorResponse {
            exit_code: status.<span class="hljs-title function_ invoke__">code</span>(),
            output: output.<span class="hljs-number">0</span>,
            normalized_entries: normalized,
            diff_changes: <span class="hljs-title function_ invoke__">extract_git_diffs</span>(request.working_dir).<span class="hljs-keyword">await</span>?,
        })
    }
    
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">validate_config</span>(&amp;<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> anyhow::<span class="hljs-type">Result</span>&lt;()&gt; {
        <span class="hljs-comment">// éªŒè¯å¿…è¦çš„é…ç½®é¡¹</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">self</span>.config.base_command_override.<span class="hljs-title function_ invoke__">is_none</span>() {
            <span class="hljs-comment">// æ£€æŸ¥é»˜è®¤å‘½ä»¤æ˜¯å¦å¯ç”¨</span>
            which::<span class="hljs-title function_ invoke__">which</span>(<span class="hljs-string">"npx"</span>).<span class="hljs-title function_ invoke__">context</span>(<span class="hljs-string">"npx not found in PATH"</span>)?;
        }
        <span class="hljs-title function_ invoke__">Ok</span>(())
    }
    
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">capabilities</span>(&amp;<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Vec</span>&lt;BaseAgentCapability&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">caps</span> = <span class="hljs-built_in">vec!</span>[BaseAgentCapability::SESSION_FORK];
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">self</span>.config.approvals.<span class="hljs-title function_ invoke__">unwrap_or</span>(<span class="hljs-literal">false</span>) {
            caps.<span class="hljs-title function_ invoke__">push</span>(BaseAgentCapability::SETUP_HELPER);
        }
        caps
    }
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">check_availability</span>(&amp;<span class="hljs-keyword">self</span>) <span class="hljs-punctuation">-&gt;</span> AvailabilityInfo {
        <span class="hljs-comment">// æ£€æŸ¥ Claude Code æ˜¯å¦å·²å®‰è£…å’Œè®¤è¯</span>
        <span class="hljs-keyword">match</span> <span class="hljs-title function_ invoke__">check_claude_code_auth</span>().<span class="hljs-keyword">await</span> {
            <span class="hljs-title function_ invoke__">Ok</span>(timestamp) =&gt; AvailabilityInfo::LoginDetected { last_auth_timestamp: timestamp },
            <span class="hljs-title function_ invoke__">Err</span>(_) =&gt; AvailabilityInfo::NotFound,
        }
    }
}
</code></pre>
<h4 data-id="heading-19">5.3 Git å·¥ä½œæ ‘ç®¡ç†å™¨</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// crates/services/src/git_worktree.rs</span>
<span class="hljs-keyword">use</span> git2::{Repository, Worktree, Error <span class="hljs-keyword">as</span> GitError};
<span class="hljs-keyword">use</span> std::path::{Path, PathBuf};
<span class="hljs-keyword">use</span> std::collections::HashMap;

<span class="hljs-comment">/// Git å·¥ä½œæ ‘ç®¡ç†å™¨</span>
<span class="hljs-comment">/// è´Ÿè´£ä¸ºæ¯ä¸ªä»»åŠ¡åˆ›å»ºç‹¬ç«‹çš„ Git å·¥ä½œç¯å¢ƒ</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">GitWorktreeManager</span> {
    base_repo: Repository,
    worktrees: HashMap&lt;<span class="hljs-type">String</span>, WorktreeInfo&gt;,
    worktrees_dir: PathBuf,
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">WorktreeInfo</span> {
    worktree: Worktree,
    task_id: <span class="hljs-type">String</span>,
    branch_name: <span class="hljs-type">String</span>,
    created_at: chrono::DateTime&lt;chrono::Utc&gt;,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">GitWorktreeManager</span> {
    <span class="hljs-comment">/// ä¸ºä»»åŠ¡åˆ›å»ºæ–°çš„å·¥ä½œæ ‘</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">create_for_task</span>(
        &amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>,
        task_id: &amp;<span class="hljs-type">str</span>,
        base_branch: &amp;<span class="hljs-type">str</span>,
    ) <span class="hljs-punctuation">-&gt;</span> anyhow::<span class="hljs-type">Result</span>&lt;PathBuf&gt; {
        <span class="hljs-comment">// 1. ç”Ÿæˆå”¯ä¸€çš„åˆ†æ”¯åå’Œå·¥ä½œæ ‘è·¯å¾„</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">branch_name</span> = <span class="hljs-built_in">format!</span>(<span class="hljs-string">"vibe/{}/{}"</span>, task_id, <span class="hljs-title function_ invoke__">generate_unique_suffix</span>());
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">worktree_path</span> = <span class="hljs-keyword">self</span>.worktrees_dir.<span class="hljs-title function_ invoke__">join</span>(&amp;branch_name);
        
        <span class="hljs-comment">// 2. åˆ›å»ºå·¥ä½œæ ‘</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">worktree</span> = <span class="hljs-keyword">self</span>.base_repo.<span class="hljs-title function_ invoke__">worktree</span>(
            &amp;branch_name,
            &amp;worktree_path,
            <span class="hljs-title function_ invoke__">Some</span>(git2::WorktreeAddOptions::<span class="hljs-title function_ invoke__">new</span>()
                .<span class="hljs-title function_ invoke__">reference</span>(<span class="hljs-title function_ invoke__">Some</span>(&amp;<span class="hljs-keyword">self</span>.base_repo.<span class="hljs-title function_ invoke__">find_branch</span>(
                    base_branch,
                    git2::BranchType::Local
                )?))
            )
        )?;
        
        <span class="hljs-comment">// 3. è®°å½•å·¥ä½œæ ‘ä¿¡æ¯</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">info</span> = WorktreeInfo {
            worktree,
            task_id: task_id.<span class="hljs-title function_ invoke__">to_string</span>(),
            branch_name: branch_name.<span class="hljs-title function_ invoke__">clone</span>(),
            created_at: chrono::Utc::<span class="hljs-title function_ invoke__">now</span>(),
        };
        
        <span class="hljs-keyword">self</span>.worktrees.<span class="hljs-title function_ invoke__">insert</span>(task_id.<span class="hljs-title function_ invoke__">to_string</span>(), info);
        
        <span class="hljs-title function_ invoke__">Ok</span>(worktree_path)
    }
    
    <span class="hljs-comment">/// æ¸…ç†ä»»åŠ¡çš„å·¥ä½œæ ‘</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">cleanup_for_task</span>(&amp;<span class="hljs-keyword">mut</span> <span class="hljs-keyword">self</span>, task_id: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> anyhow::<span class="hljs-type">Result</span>&lt;()&gt; {
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(info) = <span class="hljs-keyword">self</span>.worktrees.<span class="hljs-title function_ invoke__">remove</span>(task_id) {
            <span class="hljs-comment">// 1. åˆ é™¤å·¥ä½œæ ‘</span>
            <span class="hljs-keyword">self</span>.base_repo.<span class="hljs-title function_ invoke__">find_worktree</span>(&amp;info.branch_name)?
                .<span class="hljs-title function_ invoke__">prune</span>(<span class="hljs-literal">None</span>)?;
            
            <span class="hljs-comment">// 2. åˆ é™¤å¯¹åº”çš„åˆ†æ”¯</span>
            <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">branch</span> = <span class="hljs-keyword">self</span>.base_repo.<span class="hljs-title function_ invoke__">find_branch</span>(
                &amp;info.branch_name,
                git2::BranchType::Local
            )?;
            branch.<span class="hljs-title function_ invoke__">delete</span>()?;
            
            <span class="hljs-comment">// 3. åˆ é™¤å·¥ä½œæ ‘ç›®å½•</span>
            tokio::fs::<span class="hljs-title function_ invoke__">remove_dir_all</span>(
                <span class="hljs-keyword">self</span>.worktrees_dir.<span class="hljs-title function_ invoke__">join</span>(&amp;info.branch_name)
            ).<span class="hljs-keyword">await</span>?;
        }
        
        <span class="hljs-title function_ invoke__">Ok</span>(())
    }
    
    <span class="hljs-comment">/// è·å–å·¥ä½œæ ‘ä¸­çš„ Git çŠ¶æ€</span>
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">get_worktree_status</span>(
        &amp;<span class="hljs-keyword">self</span>,
        task_id: &amp;<span class="hljs-type">str</span>,
    ) <span class="hljs-punctuation">-&gt;</span> anyhow::<span class="hljs-type">Result</span>&lt;BranchStatus&gt; {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">info</span> = <span class="hljs-keyword">self</span>.worktrees.<span class="hljs-title function_ invoke__">get</span>(task_id)
            .<span class="hljs-title function_ invoke__">ok_or_else</span>(|| anyhow::anyhow!(<span class="hljs-string">"Worktree not found for task {}"</span>, task_id))?;
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">worktree_repo</span> = Repository::<span class="hljs-title function_ invoke__">open</span>(
            <span class="hljs-keyword">self</span>.worktrees_dir.<span class="hljs-title function_ invoke__">join</span>(&amp;info.branch_name)
        )?;
        
        <span class="hljs-comment">// åˆ†æ Git çŠ¶æ€</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">statuses</span> = worktree_repo.<span class="hljs-title function_ invoke__">statuses</span>(<span class="hljs-literal">None</span>)?;
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">uncommitted_count</span> = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">untracked_count</span> = <span class="hljs-number">0</span>;
        
        <span class="hljs-keyword">for</span> <span class="hljs-variable">entry</span> <span class="hljs-keyword">in</span> statuses.<span class="hljs-title function_ invoke__">iter</span>() {
            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">status</span> = entry.<span class="hljs-title function_ invoke__">status</span>();
            <span class="hljs-keyword">if</span> status.<span class="hljs-title function_ invoke__">is_wt_new</span>() {
                untracked_count += <span class="hljs-number">1</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> status.<span class="hljs-title function_ invoke__">is_wt_modified</span>() || status.<span class="hljs-title function_ invoke__">is_wt_deleted</span>() {
                uncommitted_count += <span class="hljs-number">1</span>;
            }
        }
        
        <span class="hljs-comment">// è®¡ç®—ä¸ç›®æ ‡åˆ†æ”¯çš„å·®å¼‚</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">head</span> = worktree_repo.<span class="hljs-title function_ invoke__">head</span>()?;
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">head_oid</span> = head.<span class="hljs-title function_ invoke__">target</span>();
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">target_branch</span> = <span class="hljs-keyword">self</span>.base_repo.<span class="hljs-title function_ invoke__">find_branch</span>(
            &amp;info.branch_name,
            git2::BranchType::Local
        )?;
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">target_commit</span> = target_branch.<span class="hljs-title function_ invoke__">get</span>().<span class="hljs-title function_ invoke__">peel_to_commit</span>()?;
        
        <span class="hljs-comment">// ä½¿ç”¨ git rev-list è®¡ç®— ahead/behind</span>
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">revwalk</span> = worktree_repo.<span class="hljs-title function_ invoke__">revwalk</span>()?;
        revwalk.<span class="hljs-title function_ invoke__">push</span>(head_oid.<span class="hljs-title function_ invoke__">ok_or_else</span>(|| anyhow::anyhow!(<span class="hljs-string">"No HEAD"</span>))?)?;
        revwalk.<span class="hljs-title function_ invoke__">hide</span>(target_commit.<span class="hljs-title function_ invoke__">id</span>())?;
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">commits_ahead</span> = revwalk.<span class="hljs-title function_ invoke__">count</span>();
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">revwalk</span> = worktree_repo.<span class="hljs-title function_ invoke__">revwalk</span>()?;
        revwalk.<span class="hljs-title function_ invoke__">push</span>(target_commit.<span class="hljs-title function_ invoke__">id</span>())?;
        revwalk.<span class="hljs-title function_ invoke__">hide</span>(head_oid.<span class="hljs-title function_ invoke__">ok_or_else</span>(|| anyhow::anyhow!(<span class="hljs-string">"No HEAD"</span>))?)?;
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">commits_behind</span> = revwalk.<span class="hljs-title function_ invoke__">count</span>();
        
        <span class="hljs-title function_ invoke__">Ok</span>(BranchStatus {
            commits_behind: <span class="hljs-title function_ invoke__">Some</span>(commits_behind <span class="hljs-keyword">as</span> <span class="hljs-type">i32</span>),
            commits_ahead: <span class="hljs-title function_ invoke__">Some</span>(commits_ahead <span class="hljs-keyword">as</span> <span class="hljs-type">i32</span>),
            has_uncommitted_changes: uncommitted_count &gt; <span class="hljs-number">0</span>,
            head_oid: head_oid.<span class="hljs-title function_ invoke__">map</span>(|oid| oid.<span class="hljs-title function_ invoke__">to_string</span>()),
            uncommitted_count: <span class="hljs-title function_ invoke__">Some</span>(uncommitted_count),
            untracked_count: <span class="hljs-title function_ invoke__">Some</span>(untracked_count),
            target_branch_name: info.branch_name.<span class="hljs-title function_ invoke__">clone</span>(),
            remote_commits_behind: <span class="hljs-literal">None</span>,  <span class="hljs-comment">// ç®€åŒ–ç¤ºä¾‹</span>
            remote_commits_ahead: <span class="hljs-literal">None</span>,
            merges: <span class="hljs-built_in">vec!</span>[],
            is_rebase_in_progress: <span class="hljs-literal">false</span>,
            conflict_op: <span class="hljs-literal">None</span>,
            conflicted_files: <span class="hljs-built_in">vec!</span>[],
        })
    }
}
</code></pre>
<h4 data-id="heading-20">5.4 WebSocket å®æ—¶é€šä¿¡æœåŠ¡</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// frontend/src/hooks/useWebSocket.ts - å‰ç«¯WebSocketè¿æ¥</span>
<span class="hljs-keyword">import</span> { useWebSocket <span class="hljs-keyword">as</span> useWs } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-use-websocket'</span>;
<span class="hljs-keyword">import</span> { useCallback, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useTaskWebSocket</span>(<span class="hljs-params">taskId: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-comment">// WebSocketè¿æ¥URL</span>
  <span class="hljs-keyword">const</span> socketUrl = taskId 
    ? <span class="hljs-string">`ws://localhost:<span class="hljs-subst">${<span class="hljs-keyword">import</span>.meta.env.VITE_BACKEND_PORT}</span>/ws/tasks/<span class="hljs-subst">${taskId}</span>`</span>
    : <span class="hljs-literal">null</span>;
  
  <span class="hljs-keyword">const</span> {
    sendMessage,
    lastMessage,
    readyState,
    getWebSocket,
  } = <span class="hljs-title function_">useWs</span>(socketUrl, {
    <span class="hljs-attr">shouldReconnect</span>: <span class="hljs-function">(<span class="hljs-params">closeEvent</span>) =&gt;</span> <span class="hljs-literal">true</span>,
    <span class="hljs-attr">reconnectAttempts</span>: <span class="hljs-number">10</span>,
    <span class="hljs-attr">reconnectInterval</span>: <span class="hljs-number">3000</span>,
    <span class="hljs-attr">share</span>: <span class="hljs-literal">true</span>,
  });
  
  <span class="hljs-comment">// å¤„ç†ä¸åŒç±»å‹çš„WebSocketæ¶ˆæ¯</span>
  <span class="hljs-keyword">const</span> handleMessage = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">(<span class="hljs-params">event: MessageEvent</span>) =&gt;</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);
      
      <span class="hljs-keyword">switch</span> (data.<span class="hljs-property">type</span>) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'LOG_ENTRY'</span>:
          <span class="hljs-comment">// å¤„ç†æ—¥å¿—è¾“å‡º</span>
          <span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'ADD_LOG'</span>, <span class="hljs-attr">payload</span>: data.<span class="hljs-property">payload</span> });
          <span class="hljs-keyword">break</span>;
          
        <span class="hljs-keyword">case</span> <span class="hljs-string">'TASK_STATUS_UPDATE'</span>:
          <span class="hljs-comment">// æ›´æ–°ä»»åŠ¡çŠ¶æ€</span>
          <span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'UPDATE_STATUS'</span>, <span class="hljs-attr">payload</span>: data.<span class="hljs-property">payload</span> });
          <span class="hljs-keyword">break</span>;
          
        <span class="hljs-keyword">case</span> <span class="hljs-string">'GIT_DIFF'</span>:
          <span class="hljs-comment">// æ˜¾ç¤ºGitå·®å¼‚</span>
          <span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'UPDATE_DIFF'</span>, <span class="hljs-attr">payload</span>: data.<span class="hljs-property">payload</span> });
          <span class="hljs-keyword">break</span>;
          
        <span class="hljs-keyword">case</span> <span class="hljs-string">'EXECUTION_PROGRESS'</span>:
          <span class="hljs-comment">// æ›´æ–°æ‰§è¡Œè¿›åº¦</span>
          <span class="hljs-title function_">dispatch</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'UPDATE_PROGRESS'</span>, <span class="hljs-attr">payload</span>: data.<span class="hljs-property">payload</span> });
          <span class="hljs-keyword">break</span>;
          
        <span class="hljs-keyword">case</span> <span class="hljs-string">'APPROVAL_REQUEST'</span>:
          <span class="hljs-comment">// æ˜¾ç¤ºå·¥å…·ä½¿ç”¨æ‰¹å‡†è¯·æ±‚</span>
          <span class="hljs-title function_">showApprovalDialog</span>(data.<span class="hljs-property">payload</span>);
          <span class="hljs-keyword">break</span>;
      }
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to parse WebSocket message:'</span>, error);
    }
  }, []);
  
  <span class="hljs-comment">// å‘é€æ§åˆ¶å‘½ä»¤</span>
  <span class="hljs-keyword">const</span> sendControlCommand = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">(<span class="hljs-params">command: <span class="hljs-built_in">string</span>, payload?: <span class="hljs-built_in">any</span></span>) =&gt;</span> {
    <span class="hljs-title function_">sendMessage</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">type</span>: <span class="hljs-string">'CONTROL_COMMAND'</span>,
      command,
      payload,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
    }));
  }, [sendMessage]);
  
  <span class="hljs-comment">// å‘é€AIæ‰§è¡Œå‘½ä»¤</span>
  <span class="hljs-keyword">const</span> sendExecutionCommand = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">(<span class="hljs-params">
    executor: <span class="hljs-built_in">string</span>,
    prompt: <span class="hljs-built_in">string</span>,
    options?: <span class="hljs-built_in">any</span>
  </span>) =&gt;</span> {
    <span class="hljs-title function_">sendMessage</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">type</span>: <span class="hljs-string">'EXECUTE_COMMAND'</span>,
      executor,
      prompt,
      options,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
    }));
  }, [sendMessage]);
  
  <span class="hljs-keyword">return</span> {
    sendControlCommand,
    sendExecutionCommand,
    lastMessage,
    readyState,
    <span class="hljs-attr">isConnected</span>: readyState === <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">OPEN</span>,
  };
}
</code></pre>
<h3 data-id="heading-21">æ€»ç»“</h3>
<p>Vibe Kanban é¡¹ç›®é€šè¿‡æŠ€æœ¯åˆ›æ–°è§£å†³äº† AI ç¼–ç¨‹æ—¶ä»£çš„å…³é”®å·¥ç¨‹åŒ–é—®é¢˜ã€‚å…¶ä¸»è¦æŠ€æœ¯è´¡çŒ®åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>æ ‡å‡†åŒ–çš„ AI åŠ©æ‰‹æ¥å£æŠ½è±¡</strong>ï¼šé€šè¿‡æ‰§è¡Œå™¨æ¨¡å¼ç»Ÿä¸€äº†ä¸åŒ AI ç¼–ç¨‹åŠ©æ‰‹çš„è°ƒç”¨æ–¹å¼</li>
<li><strong>å®‰å…¨çš„ Git å·¥ä½œæµç®¡ç†</strong>ï¼šå·¥ä½œæ ‘éš”ç¦»æœºåˆ¶ä¿è¯äº†å¹¶å‘æ“ä½œçš„å®‰å…¨æ€§</li>
<li><strong>å®æ—¶ååŒæ¶æ„</strong>ï¼šWebSocket + å¢é‡æ›´æ–°å®ç°äº†é«˜æ•ˆçš„å®æ—¶é€šä¿¡</li>
<li><strong>å¯æ‰©å±•çš„é…ç½®ç³»ç»Ÿ</strong>ï¼šMCP é…ç½®ä¸­å¿ƒæ”¯æŒçµæ´»çš„æ‰©å±•å’Œå®šåˆ¶</li>
</ol>
<p><strong>æŠ€æœ¯é€‰å‹åˆç†æ€§</strong>ï¼š</p>
<ul>
<li><strong>Rust åç«¯</strong>ï¼šæä¾›é«˜æ€§èƒ½ã€å®‰å…¨å¹¶å‘çš„æ‰§è¡Œç¯å¢ƒï¼Œé€‚åˆå¤„ç†å¤æ‚çš„ Git æ“ä½œå’Œè¿›ç¨‹ç®¡ç†</li>
<li><strong>React å‰ç«¯</strong>ï¼šç»„ä»¶åŒ–æ¶æ„é€‚åˆæ„å»ºå¤æ‚çš„äº¤äº’ç•Œé¢</li>
<li><strong>SQLite æ•°æ®åº“</strong>ï¼šç®€åŒ–éƒ¨ç½²ï¼Œæ»¡è¶³å•æœº/å°å›¢é˜Ÿä½¿ç”¨åœºæ™¯</li>
</ul>
<p><strong>æ”¹è¿›å»ºè®®</strong>ï¼š</p>
<ol>
<li>å¢åŠ åˆ†å¸ƒå¼æ”¯æŒï¼Œæ”¯æŒå¤šèŠ‚ç‚¹éƒ¨ç½²å’Œè´Ÿè½½å‡è¡¡</li>
<li>å¼•å…¥æ’ä»¶ç³»ç»Ÿï¼Œæ”¯æŒç¬¬ä¸‰æ–¹æ‰§è¡Œå™¨å’Œå·¥å…·çš„é›†æˆ</li>
<li>å¢å¼ºå®‰å…¨æœºåˆ¶ï¼Œæ”¯æŒä¼ä¸šçº§çš„æƒé™ç®¡ç†å’Œå®¡è®¡æ—¥å¿—</li>
</ol>
<p>è¯¥é¡¹ç›®å±•ç¤ºäº†å¦‚ä½•å°†ç°ä»£è½¯ä»¶å·¥ç¨‹å®è·µåº”ç”¨äº AI ç¼–ç¨‹å·¥ä½œæµçš„ä¼˜åŒ–ï¼Œä¸º AI è¾…åŠ©ç¼–ç¨‹å·¥å…·çš„å‘å±•æä¾›äº†æœ‰ä»·å€¼çš„å‚è€ƒæ¶æ„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RK3588ä¸Š ubuntu20.04 fastlioç‚¹äº‘ä¸æ˜¾ç¤ºï¼Ÿ3æ­¥æå®šï¼]]></title>    <link>https://juejin.cn/post/7596687515030978586</link>    <guid>https://juejin.cn/post/7596687515030978586</guid>    <pubDate>2026-01-19T07:40:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596687515030978586" data-draft-id="7596687697755226122" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RK3588ä¸Š ubuntu20.04 fastlioç‚¹äº‘ä¸æ˜¾ç¤ºï¼Ÿ3æ­¥æå®šï¼"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-19T07:40:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Aresmiao"/> <meta itemprop="url" content="https://juejin.cn/user/4179676989508731"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RK3588ä¸Š ubuntu20.04 fastlioç‚¹äº‘ä¸æ˜¾ç¤ºï¼Ÿ3æ­¥æå®šï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4179676989508731/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Aresmiao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T07:40:43.000Z" title="Mon Jan 19 2026 07:40:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">é—®é¢˜</h3>
<p>å¯åŠ¨ FastLIO å RViz æ— ç‚¹äº‘ï¼Ÿå¤§æ¦‚ç‡æ˜¯æ¿€å…‰é›·è¾¾æ•°æ®æ²¡è¿›æ¥ï¼</p>
<h3 data-id="heading-1">è§£å†³æ­¥éª¤</h3>
<h4 data-id="heading-2">1. å…ˆå¯åŠ¨ Livox é›·è¾¾é©±åŠ¨</h4>
<p>åªæ‰§è¡Œfast_lioçš„launchæ–‡ä»¶ï¼Œæ‰§è¡Œå‘½ä»¤åï¼Œrvizæ²¡æœ‰ç‚¹äº‘æ˜¾ç¤ºã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">source</span> devel/setup.bash
roslaunch fast_lio mapping_mid360.launch
</code></pre>
<p>ï¼ˆç»ˆç«¯è¾“å‡ºç±»ä¼¼ HANDLE DETECTION DATA æ—¥å¿—ï¼Œè¯´æ˜é©±åŠ¨æ­£å¸¸ï¼‰</p>
<h4 data-id="heading-3">2.å†å¯åŠ¨FastLIO</h4>
<p>æ–°å¼€ç»ˆç«¯ï¼š</p>
<pre><code class="hljs">rostopic list
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9a688213ecc49e1ac3aaea5aa9e8565~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXJlc21pYW8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769413242&amp;x-signature=4pxXEcltKIxeoNjpOt2RQA1QwUs%3D" alt="" loading="lazy"/>â€‹</p>
<h4 data-id="heading-4">3.æ£€æŸ¥æ•ˆæœ</h4>
<p>RViz ä¸­åº”æ˜¾ç¤ºç‚¹äº‘ï¼ŒSLAM å»ºå›¾å¼€å§‹è¿è¡Œã€‚</p>
<p>1ï¼‰æ‰§è¡ŒechoæŒ‡ä»¤æ²¡æœ‰æ•°æ®ï¼Œè¯´æ˜lidarä¸é€šã€‚</p>
<pre><code class="hljs language-bash" lang="bash">rostopic <span class="hljs-built_in">echo</span> /livox/imu
</code></pre>
<p>2ï¼‰éœ€è¦æ‰§è¡Œlivox_ros_driver2 çš„launchæ–‡ä»¶ï¼Œæ‰æœ‰slamåŠŸèƒ½ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">source</span> devel/setup.bash
roslaunch livox_ros_driver2 msg_MID360.launch
</code></pre>
<p>3ï¼‰slamæ˜¾ç¤º</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7839117486f74058b1f08e8cf4c8b0a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQXJlc21pYW8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769413242&amp;x-signature=tUcekcGwMgrWdEnsbBARBLrzxWA%3D" alt="" loading="lazy"/>â€‹</p>
<h4 data-id="heading-5">å…³é”®åŸå› </h4>
<p>FastLIO ä¾èµ–é›·è¾¾åŸå§‹æ•°æ®ï¼Œå¿…é¡»å…ˆå¯åŠ¨ <code>livox_ros_driver2</code> æä¾›æ•°æ®ï¼Œå†å¯åŠ¨ç®—æ³•èŠ‚ç‚¹ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Goè¯­è¨€å¾®æœåŠ¡ä¸äº‘åŸç”Ÿ]]></title>    <link>https://juejin.cn/post/7596865421611827254</link>    <guid>https://juejin.cn/post/7596865421611827254</guid>    <pubDate>2026-01-19T09:21:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596865421611827254" data-draft-id="7596926832911941695" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" Goè¯­è¨€å¾®æœåŠ¡ä¸äº‘åŸç”Ÿ "/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-19T09:21:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·557744506908"/> <meta itemprop="url" content="https://juejin.cn/user/749198160955433"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             Goè¯­è¨€å¾®æœåŠ¡ä¸äº‘åŸç”Ÿ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/749198160955433/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·557744506908
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T09:21:12.000Z" title="Mon Jan 19 2026 09:21:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>Goè¯­è¨€å¾®æœåŠ¡ä¸äº‘åŸç”Ÿ</strong>---youkeit.xyz/15482/å
<strong>é¢„è§äº‘åŸç”Ÿæœªæ¥ï¼šGo è¯­è¨€å¾®æœåŠ¡æ·±è€•ï¼Œç­‘ç‰¢ä¸‹ä¸€ä»£åˆ†å¸ƒå¼å¼€å‘æ ¸å¿ƒç«äº‰åŠ›</strong></p>
<p>åœ¨äº‘åŸç”Ÿæ—¶ä»£ï¼Œåº”ç”¨æ¶æ„å·²ä»å•ä½“èµ°å‘åˆ†å¸ƒå¼ï¼Œä»é™æ€éƒ¨ç½²è½¬å‘åŠ¨æ€ç¼–æ’ã€‚Kubernetes æˆä¸ºäº‹å®ä¸Šçš„æ“ä½œç³»ç»Ÿï¼Œè€Œå¾®æœåŠ¡åˆ™æ˜¯æ„å»ºå¼¹æ€§ã€å¯æ‰©å±•ç³»ç»Ÿçš„åŸºçŸ³ã€‚åœ¨è¿™ä¸€æŠ€æœ¯æµªæ½®ä¸­ï¼Œ<strong>Go è¯­è¨€å‡­å€Ÿå…¶å¹¶å‘æ¨¡å‹ã€é«˜æ€§èƒ½ã€é™æ€ç¼–è¯‘ä¸æä½èµ„æºå ç”¨ï¼Œæˆä¸ºäº‘åŸç”ŸåŸºç¡€è®¾æ–½ä¸å¾®æœåŠ¡å¼€å‘çš„é¦–é€‰è¯­è¨€</strong>â€”â€”Dockerã€Kubernetesã€Prometheusã€etcdã€Terraform ç­‰æ ¸å¿ƒé¡¹ç›®æ— ä¸€ä¸æ˜¯ç”¨ Go ç¼–å†™ã€‚</p>
<p>2024 å¹´ï¼ŒæŒæ¡ Go è¯­è¨€å¾®æœåŠ¡å¼€å‘ï¼Œå·²ä¸å†æ˜¯â€œåŠ åˆ†é¡¹â€ï¼Œè€Œæ˜¯<strong>äº‘åŸç”Ÿå·¥ç¨‹å¸ˆã€SREã€åç«¯æ¶æ„å¸ˆçš„æ ¸å¿ƒç«äº‰åŠ›</strong>ã€‚æœ¬æ–‡å°†é€šè¿‡ä¸€ä¸ª<strong>ç”Ÿäº§å°±ç»ªçš„å¾®æœåŠ¡ç¤ºä¾‹</strong>ï¼Œå±•ç¤ºå¦‚ä½•ç”¨ Go æ„å»ºä¸€ä¸ªè½»é‡ã€å¯è§‚æµ‹ã€å¯å®¹å™¨åŒ–ã€æ”¯æŒå¥åº·æ£€æŸ¥ä¸ç»“æ„åŒ–æ—¥å¿—çš„ç°ä»£æœåŠ¡ï¼Œä¸º .NETã€Java æˆ– Python èƒŒæ™¯çš„å¼€å‘è€…æä¾›ä¸€æ¡æ¸…æ™°çš„ Go å¾®æœåŠ¡å…¥é—¨è·¯å¾„ã€‚</p>
<hr/>
<h3 data-id="heading-0">ä¸€ã€é¡¹ç›®ç›®æ ‡ï¼šæ„å»ºä¸€ä¸ªâ€œç”¨æˆ·ä¿¡æ¯æœåŠ¡â€ï¼ˆUser Serviceï¼‰</h3>
<p>è¯¥æœåŠ¡æä¾› RESTful APIï¼š</p>
<ul>
<li><code>GET /users/{id}</code>ï¼šè·å–ç”¨æˆ·ä¿¡æ¯</li>
<li><code>GET /health</code>ï¼šå¥åº·æ£€æŸ¥ï¼ˆä¾› K8s æ¢é’ˆä½¿ç”¨ï¼‰</li>
<li>å†…ç½®ç»“æ„åŒ–æ—¥å¿—ï¼ˆJSON æ ¼å¼ï¼‰</li>
<li>æ”¯æŒä¼˜é›…å…³é—­ï¼ˆGraceful Shutdownï¼‰</li>
<li>å¯é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®ç«¯å£</li>
</ul>
<hr/>
<h3 data-id="heading-1">äºŒã€é¡¹ç›®åˆå§‹åŒ–</h3>
<pre><code class="hljs language-sql" lang="sql">mkdir <span class="hljs-keyword">user</span><span class="hljs-operator">-</span>service <span class="hljs-operator">&amp;&amp;</span> cd <span class="hljs-keyword">user</span><span class="hljs-operator">-</span>service
go mod init <span class="hljs-keyword">user</span><span class="hljs-operator">-</span>service
</code></pre>
<p>å®‰è£…ä¾èµ–ï¼ˆä»…ä½¿ç”¨æ ‡å‡†åº“ + ä¸€ä¸ªæ—¥å¿—åº“ï¼‰ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">go get github.com/sirupsen/logrus
</code></pre>
<blockquote>
<p>åšæŒâ€œå°‘å³æ˜¯å¤šâ€ï¼šGo å¾®æœåŠ¡åº”å°½é‡å‡å°‘ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œæå‡å®‰å…¨æ€§å’Œå¯åŠ¨é€Ÿåº¦ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-2">ä¸‰ã€æ ¸å¿ƒä»£ç å®ç°</h3>
<h4 data-id="heading-3">1. å®šä¹‰ç”¨æˆ·æ¨¡å‹ï¼ˆ<code>model/user.go</code>ï¼‰</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> model

<span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> {
    ID    <span class="hljs-type">int</span>    <span class="hljs-string">`json:"id"`</span>
    Name  <span class="hljs-type">string</span> <span class="hljs-string">`json:"name"`</span>
    Email <span class="hljs-type">string</span> <span class="hljs-string">`json:"email"`</span>
}
</code></pre>
<h4 data-id="heading-4">2. æ¨¡æ‹Ÿæ•°æ®å­˜å‚¨ï¼ˆ<code>store/inmemory.go</code>ï¼‰</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> store

<span class="hljs-keyword">import</span> <span class="hljs-string">"user-service/model"</span>

<span class="hljs-keyword">type</span> InMemoryStore <span class="hljs-keyword">struct</span> {
    users <span class="hljs-keyword">map</span>[<span class="hljs-type">int</span>]model.User
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewInMemoryStore</span><span class="hljs-params">()</span></span> *InMemoryStore {
    <span class="hljs-keyword">return</span> &amp;InMemoryStore{
        users: <span class="hljs-keyword">map</span>[<span class="hljs-type">int</span>]model.User{
            <span class="hljs-number">1</span>: {ID: <span class="hljs-number">1</span>, Name: <span class="hljs-string">"Alice"</span>, Email: <span class="hljs-string">"alice@example.com"</span>},
            <span class="hljs-number">2</span>: {ID: <span class="hljs-number">2</span>, Name: <span class="hljs-string">"Bob"</span>, Email: <span class="hljs-string">"bob@example.com"</span>},
        },
    }
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *InMemoryStore)</span></span> GetUser(id <span class="hljs-type">int</span>) (model.User, <span class="hljs-type">bool</span>) {
    user, ok := s.users[id]
    <span class="hljs-keyword">return</span> user, ok
}
</code></pre>
<blockquote>
<p>å®é™…é¡¹ç›®ä¸­å¯æ›¿æ¢ä¸º PostgreSQLã€Redis æˆ– gRPC è¿œç¨‹è°ƒç”¨ã€‚</p>
</blockquote>
<h4 data-id="heading-5">3. HTTP å¤„ç†å™¨ï¼ˆ<code>handler/user_handler.go</code>ï¼‰</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> handler

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"encoding/json"</span>
    <span class="hljs-string">"net/http"</span>
    <span class="hljs-string">"strconv"</span>

    <span class="hljs-string">"github.com/sirupsen/logrus"</span>
    <span class="hljs-string">"user-service/model"</span>
    <span class="hljs-string">"user-service/store"</span>
)

<span class="hljs-keyword">type</span> UserHandler <span class="hljs-keyword">struct</span> {
    store *store.InMemoryStore
    log   *logrus.Logger
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewUserHandler</span><span class="hljs-params">(store *store.InMemoryStore, log *logrus.Logger)</span></span> *UserHandler {
    <span class="hljs-keyword">return</span> &amp;UserHandler{store: store, log: log}
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(h *UserHandler)</span></span> GetUser(w http.ResponseWriter, r *http.Request) {
    idStr := r.PathValue(<span class="hljs-string">"id"</span>) <span class="hljs-comment">// Go 1.22+ åŸç”Ÿæ”¯æŒè·¯å¾„å‚æ•°</span>
    id, err := strconv.Atoi(idStr)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        http.Error(w, <span class="hljs-string">"Invalid user ID"</span>, http.StatusBadRequest)
        <span class="hljs-keyword">return</span>
    }

    user, found := h.store.GetUser(id)
    <span class="hljs-keyword">if</span> !found {
        http.Error(w, <span class="hljs-string">"User not found"</span>, http.StatusNotFound)
        <span class="hljs-keyword">return</span>
    }

    w.Header().Set(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json"</span>)
    <span class="hljs-keyword">if</span> err := json.NewEncoder(w).Encode(user); err != <span class="hljs-literal">nil</span> {
        h.log.WithError(err).Error(<span class="hljs-string">"Failed to encode user response"</span>)
    }
}
</code></pre>
<blockquote>
<p>ä½¿ç”¨ Go 1.22 çš„ <code>r.PathValue("id")</code> ç®€åŒ–è·¯ç”±å‚æ•°æå–ï¼ˆæ— éœ€ç¬¬ä¸‰æ–¹è·¯ç”±å™¨ï¼‰ã€‚</p>
</blockquote>
<h4 data-id="heading-6">4. ä¸»ç¨‹åºä¸æœåŠ¡å¯åŠ¨ï¼ˆ<code>main.go</code>ï¼‰</h4>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"context"</span>
    <span class="hljs-string">"log"</span>
    <span class="hljs-string">"net/http"</span>
    <span class="hljs-string">"os"</span>
    <span class="hljs-string">"os/signal"</span>
    <span class="hljs-string">"syscall"</span>
    <span class="hljs-string">"time"</span>

    <span class="hljs-string">"github.com/sirupsen/logrus"</span>
    <span class="hljs-string">"user-service/handler"</span>
    <span class="hljs-string">"user-service/store"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// é…ç½®æ—¥å¿—ä¸º JSON æ ¼å¼ï¼ˆä¾¿äº Loki/ELK æ”¶é›†ï¼‰</span>
    logrus.SetFormatter(&amp;logrus.JSONFormatter{})
    logger := logrus.New()

    <span class="hljs-comment">// åˆå§‹åŒ–å­˜å‚¨ä¸å¤„ç†å™¨</span>
    userStore := store.NewInMemoryStore()
    userHandler := handler.NewUserHandler(userStore, logger)

    <span class="hljs-comment">// åˆ›å»º HTTP è·¯ç”±ï¼ˆGo 1.22+ åŸç”Ÿè·¯ç”±ï¼‰</span>
    mux := http.NewServeMux()
    mux.HandleFunc(<span class="hljs-string">"GET /users/{id}"</span>, userHandler.GetUser)
    mux.HandleFunc(<span class="hljs-string">"GET /health"</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> {
        w.WriteHeader(http.StatusOK)
        w.Write([]<span class="hljs-type">byte</span>(<span class="hljs-string">`{"status":"healthy"}`</span>))
    })

    <span class="hljs-comment">// ä»ç¯å¢ƒå˜é‡è¯»å–ç«¯å£ï¼Œé»˜è®¤ 8080</span>
    port := os.Getenv(<span class="hljs-string">"PORT"</span>)
    <span class="hljs-keyword">if</span> port == <span class="hljs-string">""</span> {
        port = <span class="hljs-string">"8080"</span>
    }
    addr := <span class="hljs-string">":"</span> + port

    server := &amp;http.Server{
        Addr:    addr,
        Handler: mux,
    }

    <span class="hljs-comment">// å¯åŠ¨æœåŠ¡å™¨ï¼ˆgoroutineï¼‰</span>
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        logger.Infof(<span class="hljs-string">"User service starting on %s"</span>, addr)
        <span class="hljs-keyword">if</span> err := server.ListenAndServe(); err != <span class="hljs-literal">nil</span> &amp;&amp; err != http.ErrServerClosed {
            logger.Fatalf(<span class="hljs-string">"Server failed to start: %v"</span>, err)
        }
    }()

    <span class="hljs-comment">// ç›‘å¬ä¸­æ–­ä¿¡å·ï¼Œå®ç°ä¼˜é›…å…³é—­</span>
    sigChan := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> os.Signal, <span class="hljs-number">1</span>)
    signal.Notify(sigChan, syscall.SIGINT, syscall.SIGTERM)
    &lt;-sigChan

    logger.Info(<span class="hljs-string">"Shutting down server gracefully..."</span>)
    ctx, cancel := context.WithTimeout(context.Background(), <span class="hljs-number">10</span>*time.Second)
    <span class="hljs-keyword">defer</span> cancel()

    <span class="hljs-keyword">if</span> err := server.Shutdown(ctx); err != <span class="hljs-literal">nil</span> {
        logger.Errorf(<span class="hljs-string">"Server forced to shutdown: %v"</span>, err)
    }

    logger.Info(<span class="hljs-string">"Server exited"</span>)
}
</code></pre>
<blockquote>
<p>å…³é”®ç‰¹æ€§ï¼š</p>
<ul>
<li><strong>ç»“æ„åŒ– JSON æ—¥å¿—</strong>ï¼šé€‚é…äº‘åŸç”Ÿæ—¥å¿—ç³»ç»Ÿ</li>
<li><strong>ä¼˜é›…å…³é—­</strong>ï¼šç¡®ä¿æ­£åœ¨å¤„ç†çš„è¯·æ±‚å®Œæˆåå†é€€å‡º</li>
<li><strong>å¥åº·æ£€æŸ¥ç«¯ç‚¹</strong>ï¼šæ»¡è¶³ Kubernetes <code>livenessProbe</code> å’Œ <code>readinessProbe</code></li>
<li><strong>é›¶å¤–éƒ¨ä¾èµ–è·¯ç”±</strong>ï¼šåˆ©ç”¨ Go 1.22+ åŸç”Ÿå¢å¼º</li>
</ul>
</blockquote>
<hr/>
<h3 data-id="heading-7">å››ã€Docker åŒ–ä¸äº‘åŸç”Ÿéƒ¨ç½²</h3>
<h4 data-id="heading-8"><code>Dockerfile</code></h4>
<pre><code class="hljs language-sql" lang="sql"># æ„å»ºé˜¶æ®µ
<span class="hljs-keyword">FROM</span> golang:<span class="hljs-number">1.22</span><span class="hljs-operator">-</span>alpine <span class="hljs-keyword">AS</span> builder
WORKDIR <span class="hljs-operator">/</span>app
<span class="hljs-keyword">COPY</span> . .
RUN CGO_ENABLED<span class="hljs-operator">=</span><span class="hljs-number">0</span> GOOS<span class="hljs-operator">=</span>linux go build <span class="hljs-operator">-</span>a <span class="hljs-operator">-</span>installsuffix cgo <span class="hljs-operator">-</span>o <span class="hljs-keyword">user</span><span class="hljs-operator">-</span>service .

# è¿è¡Œé˜¶æ®µï¼ˆæå°é•œåƒï¼‰
<span class="hljs-keyword">FROM</span> alpine:latest
RUN apk <span class="hljs-comment">--no-cache add ca-certificates</span>
WORKDIR <span class="hljs-operator">/</span>root<span class="hljs-operator">/</span>
<span class="hljs-keyword">COPY</span> <span class="hljs-comment">--from=builder /app/user-service .</span>
EXPOSE <span class="hljs-number">8080</span>
CMD ["./user-service"]
</code></pre>
<blockquote>
<p>ç”Ÿæˆçš„é•œåƒé€šå¸¸å°äº 20MBï¼Œå¯åŠ¨æ—¶é—´æ¯«ç§’çº§ï¼Œå®Œç¾å¥‘åˆ Serverless ä¸ K8s å¿«é€Ÿæ‰©ç¼©å®¹ã€‚</p>
</blockquote>
<h4 data-id="heading-9">æ„å»ºä¸è¿è¡Œ</h4>
<pre><code class="hljs language-ini" lang="ini">docker build -t user-service .
docker run -p 8080:8080 -e <span class="hljs-attr">PORT</span>=<span class="hljs-number">8080</span> user-service
</code></pre>
<p>æµ‹è¯•ï¼š</p>
<pre><code class="hljs language-json" lang="json">curl http<span class="hljs-punctuation">:</span><span class="hljs-comment">//localhost:8080/users/1</span>
# <span class="hljs-punctuation">{</span><span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"Alice"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"email"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"alice@example.com"</span><span class="hljs-punctuation">}</span>

curl http<span class="hljs-punctuation">:</span><span class="hljs-comment">//localhost:8080/health</span>
# <span class="hljs-punctuation">{</span><span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"healthy"</span><span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h3 data-id="heading-10">äº”ã€ä¸ºä»€ä¹ˆè¿™æ˜¯ä¸‹ä¸€ä»£å¾®æœåŠ¡èŒƒå¼ï¼Ÿ</h3>
<ol>
<li><strong>æè‡´è½»é‡</strong>ï¼šå•äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ— è¿è¡Œæ—¶ä¾èµ–ï¼Œèµ„æºå ç”¨æä½ã€‚</li>
<li><strong>é«˜å¹¶å‘èƒ½åŠ›</strong>ï¼šGoroutine æ¨¡å‹è½»æ¾åº”å¯¹ä¸‡çº§å¹¶å‘è¿æ¥ã€‚</li>
<li><strong>äº‘åŸç”ŸåŸè¯­æ”¯æŒ</strong>ï¼šå¥åº·æ£€æŸ¥ã€ä¼˜é›…å…³é—­ã€ç»“æ„åŒ–æ—¥å¿—å¼€ç®±å³ç”¨ã€‚</li>
<li><strong>å¿«é€Ÿå†·å¯åŠ¨</strong>ï¼šé€‚åˆ FaaSï¼ˆå¦‚ AWS Lambdaã€é˜¿é‡Œäº‘å‡½æ•°è®¡ç®—ï¼‰ã€‚</li>
<li><strong>ç”Ÿæ€ç»Ÿä¸€</strong>ï¼šä¸ Prometheusï¼ˆæŒ‡æ ‡ï¼‰ã€OpenTelemetryï¼ˆè¿½è¸ªï¼‰ã€Fluentdï¼ˆæ—¥å¿—ï¼‰æ— ç¼é›†æˆã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-11">å…­ã€è¿›é˜¶æ–¹å‘ï¼šæ„å»ºå®Œæ•´å¾®æœåŠ¡ä½“ç³»</h3>
<ul>
<li>ä½¿ç”¨ <strong>gRPC</strong> æ›¿ä»£ REST å®ç°æœåŠ¡é—´é«˜æ•ˆé€šä¿¡</li>
<li>é›†æˆ <strong>OpenTelemetry</strong> å®ç°åˆ†å¸ƒå¼è¿½è¸ª</li>
<li>é€šè¿‡ <strong>Consul æˆ– etcd</strong> å®ç°æœåŠ¡æ³¨å†Œä¸å‘ç°</li>
<li>ä½¿ç”¨ <strong>Go kit æˆ– Dapr</strong> æ„å»ºä¼ä¸šçº§å¾®æœåŠ¡æ¡†æ¶</li>
<li>ç¼–å†™ <strong>Helm Chart</strong> éƒ¨ç½²åˆ° Kubernetes</li>
</ul>
<hr/>
<h3 data-id="heading-12">ç»“è¯­</h3>
<p>Go è¯­è¨€ä¸æ˜¯â€œåˆä¸€é—¨ç¼–ç¨‹è¯­è¨€â€ï¼Œè€Œæ˜¯<strong>äº‘åŸç”Ÿæ—¶ä»£çš„ç³»ç»Ÿæ„å»ºè¯­è¨€</strong>ã€‚æ·±è€• Go å¾®æœåŠ¡ï¼Œæ„å‘³ç€ä½ ä¸ä»…èƒ½å†™ä¸šåŠ¡é€»è¾‘ï¼Œæ›´èƒ½ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿçš„æœ¬è´¨â€”â€”å¼¹æ€§ã€å¯è§‚æµ‹æ€§ã€è‡ªåŠ¨åŒ–ä¸è‡ªæ„ˆèƒ½åŠ›ã€‚</p>
<p>åœ¨ 2024 å¹´åŠä»¥åï¼Œæ— è®ºæ˜¯åŠ å…¥ CNCF é¡¹ç›®ã€æ„å»º SaaS å¹³å°ï¼Œè¿˜æ˜¯æ‰“é€ é«˜å¹¶å‘äº¤æ˜“ç³»ç»Ÿï¼ŒGo éƒ½å°†æ˜¯ä½ æœ€å¯é çš„æ­¦å™¨ã€‚ç°åœ¨å¼€å§‹ï¼Œç”¨ä¸€è¡Œ <code>go run</code>ï¼Œå¼€å¯ä½ çš„äº‘åŸç”Ÿæ ¸å¿ƒç«äº‰åŠ›ä¹‹æ—…ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[20 å‘¨å¹´ä¹‹é™…ï¼jQuery 4.0 æ­£å¼å‘å¸ƒï¼è½»è£…ä¸Šé˜µ]]></title>    <link>https://juejin.cn/post/7596869784537563136</link>    <guid>https://juejin.cn/post/7596869784537563136</guid>    <pubDate>2026-01-19T09:22:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596869784537563136" data-draft-id="7596869784537546752" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="20 å‘¨å¹´ä¹‹é™…ï¼jQuery 4.0 æ­£å¼å‘å¸ƒï¼è½»è£…ä¸Šé˜µ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,jQuery"/> <meta itemprop="datePublished" content="2026-01-19T09:22:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†´ç¾½"/> <meta itemprop="url" content="https://juejin.cn/user/712139234359182"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            20 å‘¨å¹´ä¹‹é™…ï¼jQuery 4.0 æ­£å¼å‘å¸ƒï¼è½»è£…ä¸Šé˜µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/712139234359182/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†´ç¾½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T09:22:38.000Z" title="Mon Jan 19 2026 09:22:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2006 å¹´ 1 æœˆ 14 æ—¥ï¼ŒJohn Resig å‘å¸ƒäº†åä¸º jQuery çš„ JavaScript åº“ã€‚</p>
<p><strong>è‡³ä»Šå·²ç»æ•´æ•´è¿‡å»äº† 20 å¹´ï¼</strong></p>
<p>ä½ è¿˜è®°å¾—ç¬¬ä¸€æ¬¡åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ jQuery çš„åœºæ™¯å—ï¼Ÿ</p>
<p>åœ¨é‚£ä¸ªæµè§ˆå™¨å…¼å®¹æ€§è®©äººå¤´ç–¼ï¼ŒDOM æ“ä½œç¹çå¤æ‚çš„æ—¶ä»£ï¼ŒjQuery å‡­å€Ÿç€â€œWrite less, do moreâ€çš„ç†å¿µï¼Œå‡ ä¹æ˜¯é‚£ä¸ªæ—¶ä»£ç½‘ç«™å¼€å‘çš„æ ‡é…ã€‚</p>
<p>åæ¥ï¼Œå‰ç«¯æ¡†æ¶å±‚å‡ºä¸ç©·ï¼ŒReactã€Vueã€Angular å„é¢†é£éªšï¼Œä½† jQuery ä¾ç„¶åœ¨å…¨çƒæ•°ç™¾ä¸‡ç½‘ç«™ä¸Šé»˜é»˜å·¥ä½œç€ã€‚</p>
<p>å¦‚ä»Šï¼Œ jQuery 4.0.0 æ­£å¼ç‰ˆå‘å¸ƒã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ jQuery è¿‘ 10 å¹´æ¥çš„é¦–ä¸ªä¸»è¦ç‰ˆæœ¬ï¼Œæ ‡å¿—ç€ jQuery æ­£å¼è¸ä¸Šäº†ç°ä»£åŒ–è½¬å‹ä¹‹è·¯ã€‚</p>
<p>è®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹ jQuery 4.0 éƒ½åšäº†å“ªäº›æ›´æ–°ã€‚</p>
<h2 data-id="heading-0">1. å½»åº•å‘Šåˆ« IE</h2>
<p>jQuery 4.0 ä¸å†æ”¯æŒ IE 10 åŠæ›´æ—©ç‰ˆæœ¬ã€‚IE 11 é¢„è®¡åœ¨ 5.0 ç‰ˆæœ¬ç§»é™¤ã€‚</p>
<p>åŒæ—¶ä¹Ÿåœæ­¢äº†ä¸€äº›è€æ—§æµè§ˆå™¨çš„æ”¯æŒï¼Œè¿™ä½¿å¾— jQuery ä»£ç æ›´æ¸…çˆ½ï¼Œæ–‡ä»¶ä½“ç§¯æ›´å°ï¼Œæ€§èƒ½æå‡æ˜¾è‘—ã€‚</p>
<h2 data-id="heading-1">2. å®‰å…¨å¤§å‡çº§</h2>
<p>jQuery 4.0 å¼•å…¥äº†å¯¹ Trusted Types çš„æ”¯æŒï¼ŒjQuery å†…éƒ¨ä¼šè‡ªåŠ¨é€šè¿‡ TrustedHTML å°è£…å­—ç¬¦ä¸²ï¼Œé¿å…è¢« CSP æ‹¦æˆªï¼Œå¤§å¤§é™ä½äº†ç½‘ç«™è¢«é»‘å®¢æ”»å‡»çš„é£é™©ã€‚</p>
<h2 data-id="heading-2">3. æ¶æ„ç°ä»£åŒ–</h2>
<p>jQuery æºç ä» AMD è¿ç§»åˆ°äº† ES Modulesï¼Œè¿™æ„å‘³ç€æ›´å¥½çš„æ¨¡å—åŒ–å¼€å‘ä½“éªŒï¼Œå¹¶ä¸ºæœªæ¥æ‹†åˆ†åŠŸèƒ½æ‰“ä¸‹åŸºç¡€ã€‚</p>
<h2 data-id="heading-3">4. API ç²¾ç®€</h2>
<p>jQuery 4.0 ç§»é™¤äº† 15 ä¸ªåºŸå¼ƒçš„ APIï¼Œè¿™äº›å‡½æ•°è¦ä¹ˆæ˜¯å†…éƒ¨ä½¿ç”¨ï¼Œè¦ä¹ˆå·²ç»æœ‰äº†åŸç”Ÿçš„æ›¿ä»£æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-4">5. jQuery çš„å…¨æ–°å®šä½</h2>
<p>æœ‰äººå¯èƒ½ä¼šé—®ï¼šç°åœ¨å‰ç«¯æ¡†æ¶è¿™ä¹ˆå‘è¾¾ï¼ŒjQuery è¿˜æœ‰å­˜åœ¨çš„å¿…è¦å—ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼</p>
<p><strong>jQuery ä¸æ˜¯è¦é‡æ–°æˆä¸ºå‰ç«¯ä¸»è§’ï¼Œè€Œæ˜¯åœ¨å®ƒé€‚åº”çš„åœºæ™¯ä¸­ç»§ç»­å‘å…‰å‘çƒ­ã€‚</strong></p>
<h2 data-id="heading-5">6. æœ€å</h2>
<p>jQuery 4.0 ä¸æ˜¯ä¸€æ¬¡â€œé‡ç”Ÿâ€ï¼Œè€Œæ˜¯ä¸€æ¬¡<strong>é¢å‘ç°ä»£ Web çš„æ–­èˆç¦»</strong>ã€‚å®ƒæŠ›å¼ƒäº†å†å²åŒ…è¢±ï¼Œæ‹¥æŠ±äº†å®‰å…¨æ ‡å‡†ï¼Œæ¸…ç†äº†å†—ä½™ä»£ç ï¼Œåšäº†å·¥ç¨‹åŒ–å‡çº§ã€‚</p>
<p>20 å¹´å‰ï¼ŒjQuery æ”¹å˜äº† Web å¼€å‘çš„æ–¹å¼ï¼›20 å¹´åï¼Œå®ƒé€‰æ‹©äº†ä¸æ—¶ä¿±è¿›ã€‚</p>
<p>å¯¹äºç”¨è¿‡ jQuery çš„è€ç¨‹åºå‘˜æ¥è¯´ï¼Œè™½ç„¶æˆ‘ä»¬å·²ç»ä¹ æƒ¯äº† Vueã€React çš„æ€ç»´æ¨¡å¼ï¼Œä½†çœ‹åˆ° jQuery çš„è¿™æ¬¡èœ•å˜ï¼Œä¾ç„¶ä¼šå¿ƒæ½®æ¾æ¹ƒã€‚</p>
<p><strong>å› ä¸ºè¿™æ˜¯æˆ‘ä»¬é’æ˜¥å²æœˆé‡Œæœ€ç¾å¥½çš„ä»£ç è®°å¿†ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æˆ‘æ•´ç†äº†ä¸€ä»½ Vue æ€§èƒ½ä¼˜åŒ–æŒ‡å—ï¼ˆç»™AIç”¨çš„ï¼‰]]></title>    <link>https://juejin.cn/post/7596865421611810870</link>    <guid>https://juejin.cn/post/7596865421611810870</guid>    <pubDate>2026-01-19T09:17:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596865421611810870" data-draft-id="7596874392824938538" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æˆ‘æ•´ç†äº†ä¸€ä»½ Vue æ€§èƒ½ä¼˜åŒ–æŒ‡å—ï¼ˆç»™AIç”¨çš„ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-19T09:17:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ursazoo"/> <meta itemprop="url" content="https://juejin.cn/user/3368559357208382"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æˆ‘æ•´ç†äº†ä¸€ä»½ Vue æ€§èƒ½ä¼˜åŒ–æŒ‡å—ï¼ˆç»™AIç”¨çš„ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3368559357208382/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ursazoo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T09:17:44.000Z" title="Mon Jan 19 2026 09:17:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸ºä»€ä¹ˆåšè¿™ä¸ª</h2>
<p>è¯´å®è¯ï¼Œè¿™ä¸ªé¡¹ç›®æ˜¯æˆ‘è‡ªå·±ç”¨çš„ã€‚</p>
<p>å·¥ä½œè¿™å‡ å¹´ï¼Œé‡åˆ°çš„æ€§èƒ½é—®é¢˜åŸºæœ¬éƒ½æ˜¯ç±»ä¼¼çš„å‘ï¼šæ¥å£ç€‘å¸ƒæµã€bundle è¶Šæ¥è¶Šå¤§ã€å“åº”å¼ä¹±ç”¨ã€‚æ¯æ¬¡è¸©å®Œå‘ä¿®å¥½äº†ï¼Œè¿‡æ®µæ—¶é—´æ¢ä¸ªé¡¹ç›®åˆè¸©ä¸€éã€‚</p>
<p>åæ¥æƒ³ç€ï¼Œå¹²è„†æ•´ç†ä¸€ä»½æ–‡æ¡£ï¼Œè‡ªå·±æŸ¥æ–¹ä¾¿ï¼Œä¹Ÿèƒ½ç»™ AI ç¼–ç åŠ©æ‰‹çœ‹ï¼ˆæˆ‘ç°åœ¨ç”¨ Claude Codeï¼‰ï¼Œè¿™æ ·å®¡ä»£ç çš„æ—¶å€™èƒ½æå‰å‘ç°é—®é¢˜ã€‚</p>
<p>æ•´ç†å®Œå‘ç°ï¼Œå¥½åƒä¹Ÿå¯ä»¥åˆ†äº«å‡ºæ¥ï¼Œè¯´ä¸å®šæœ‰äººä¹Ÿé‡åˆ°è¿‡è¿™äº›é—®é¢˜ã€‚</p>
<h2 data-id="heading-1">æˆ‘è¸©è¿‡çš„å‘</h2>
<p>è¿™å‡ å¹´å†™ Vue é¡¹ç›®ï¼ˆVue 2/3 + Nuxt éƒ½æœ‰ï¼‰ï¼Œè¸©è¿‡ä¸å°‘å‘ï¼š</p>
<p><strong>æ¥å£è¯·æ±‚å˜æˆç€‘å¸ƒæµ</strong> ä¸€ä¸ª <code>await</code> æ¥ä¸€ä¸ª <code>await</code>ï¼Œæ˜æ˜èƒ½å¹¶è¡Œçš„è¯·æ±‚ç¡¬æ˜¯ä¸²è¡Œäº†ã€‚ç”¨æˆ·æŠ±æ€¨é¡µé¢æ…¢ï¼Œä¸€æŸ¥å‘ç° 3 ä¸ªæ¥å£æ’é˜Ÿç­‰äº† 750msã€‚</p>
<p><strong>bundle ä½“ç§¯å¤±æ§</strong> æ¯æ¬¡åŠ éœ€æ±‚å°±å¾€é‡Œå¡ä»£ç ï¼Œæ²¡äººå…³å¿ƒæ‰“åŒ…ç»“æœã€‚ç­‰åˆ°é¦–å±ç™½å± 3 ç§’äº†ï¼Œæ‰å‘ç° JavaScript å·²ç» 300KB+ã€‚</p>
<p><strong>å“åº”å¼ç³»ç»Ÿæ»¥ç”¨</strong> å¤§å¯¹è±¡ç›´æ¥ <code>ref()</code>ï¼Œä¸Šåƒæ¡å•†å“æ•°æ®ï¼Œæ¯ä¸ªå­—æ®µéƒ½å˜æˆå“åº”å¼ã€‚æ¸²æŸ“ä¸€å¡ä¸€å¡çš„ï¼Œè¿˜ä»¥ä¸ºæ˜¯ç»„ä»¶å†™å¾—ä¸å¥½ã€‚</p>
<p>è¿™äº›é—®é¢˜ä¸æ˜¯ä»€ä¹ˆé«˜æ·±çš„ä¼˜åŒ–ï¼Œå°±æ˜¯åŸºæœ¬åŠŸã€‚ä½†å¿™èµ·æ¥å°±å®¹æ˜“å¿½ç•¥ï¼Œç­‰å‡ºé—®é¢˜å†æ”¹æˆæœ¬å°±é«˜äº†ã€‚</p>
<h2 data-id="heading-2">æ€ä¹ˆè¯´å‘¢ï¼Œä¼˜åŒ–è¦åˆ†è½»é‡</h2>
<p>æˆ‘å‘ç°å¾ˆå¤šäººï¼ˆåŒ…æ‹¬ä»¥å‰çš„æˆ‘ï¼‰åšæ€§èƒ½ä¼˜åŒ–ä¼šæé”™é‡ç‚¹ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼šé¡µé¢æœ‰ 600ms çš„è¯·æ±‚ç­‰å¾…æ—¶é—´ï¼Œç»“æœèŠ±ä¸€å‘¨ä¼˜åŒ– <code>computed</code> ç¼“å­˜ã€‚é¦–å±åŠ è½½äº† 300KB çš„ JavaScriptï¼Œç»“æœå»ä¼˜åŒ–å¾ªç¯å°‘è·‘å‡ æ¬¡ã€‚</p>
<p>å…¶å®åº”è¯¥å…ˆè§£å†³å¤§é—®é¢˜ï¼š</p>
<ol start="0">
<li><strong>å…ˆå¹²æ‰è¯·æ±‚ç€‘å¸ƒæµ</strong> - èƒ½å¹¶è¡Œå°±å¹¶è¡Œï¼Œè¯¥é¢„åŠ è½½å°±é¢„åŠ è½½</li>
<li><strong>å†ç  bundle ä½“ç§¯</strong> - ä»£ç åˆ†å‰²ã€åŠ¨æ€å¯¼å…¥ã€tree-shaking</li>
<li><strong>ç„¶åæ‰æ˜¯ç»„ä»¶å’Œå“åº”å¼ä¼˜åŒ–</strong> - å‡å°‘ä¸å¿…è¦çš„æ¸²æŸ“</li>
</ol>
<p>æˆ‘æŒ‰è¿™ä¸ªæ€è·¯æŠŠè§„åˆ™åˆ†æˆäº† <strong>10 ä¸ªç±»åˆ«</strong>ï¼Œä» <strong>CRITICAL</strong> åˆ° <strong>LOW</strong>ï¼Œæ€»å…± <strong>46 æ¡</strong>ã€‚å…ˆæŠŠå½±å“å¤§çš„é—®é¢˜è§£å†³äº†ï¼Œé‚£äº›å¾®ä¼˜åŒ–å¯ä»¥æ…¢æ…¢æ¥ã€‚</p>
<h2 data-id="heading-3">é‡Œé¢æœ‰ä»€ä¹ˆ</h2>
<p>10 ä¸ªç±»åˆ«ï¼Œ46 æ¡è§„åˆ™ï¼š</p>
<ul>
<li><strong>æ¶ˆé™¤å¼‚æ­¥ç€‘å¸ƒæµ</strong>ï¼ˆCRITICALï¼‰</li>
<li><strong>åŒ…ä½“ç§¯ä¼˜åŒ–</strong>ï¼ˆCRITICALï¼‰</li>
<li><strong>æœåŠ¡ç«¯æ€§èƒ½</strong>ï¼ˆHIGHï¼‰</li>
<li><strong>å®¢æˆ·ç«¯æ•°æ®è·å–</strong>ï¼ˆHIGHï¼‰</li>
<li><strong>å“åº”å¼ç³»ç»Ÿä¼˜åŒ–</strong>ï¼ˆMEDIUM-HIGHï¼‰</li>
<li><strong>æ¸²æŸ“æ€§èƒ½</strong>ï¼ˆMEDIUMï¼‰</li>
<li><strong>Vue 2 ç‰¹å®šä¼˜åŒ–</strong>ï¼ˆMEDIUMï¼‰</li>
<li><strong>Vue 3 ç‰¹å®šä¼˜åŒ–</strong>ï¼ˆMEDIUMï¼‰</li>
<li><strong>JavaScript æ€§èƒ½</strong>ï¼ˆLOW-MEDIUMï¼‰</li>
<li><strong>é«˜çº§æ¨¡å¼</strong>ï¼ˆLOWï¼‰</li>
</ul>
<p>æ¯æ¡è§„åˆ™çš„æ ¼å¼ï¼š</p>
<ul>
<li>å½±å“ç­‰çº§ï¼ˆCRITICAL / HIGH / MEDIUM / LOWï¼‰</li>
<li>é”™è¯¯ç¤ºä¾‹ï¼ˆæˆ‘ä»¥å‰å†™è¿‡çš„é”™è¯¯ä»£ç ï¼‰</li>
<li>æ­£ç¡®ç¤ºä¾‹ï¼ˆåæ¥æ”¹æˆä»€ä¹ˆæ ·ï¼‰</li>
<li>Vue 2/3 å…¼å®¹æ€§è¯´æ˜</li>
</ul>
<h2 data-id="heading-4">ä¸¾å‡ ä¸ªæˆ‘è¸©è¿‡çš„å‘</h2>
<h3 data-id="heading-5">å‘ 1ï¼šä¸éœ€è¦çš„ await ä¹Ÿåœ¨é˜»å¡ä»£ç </h3>
<p>ä»¥å‰å†™è¿‡è¿™æ ·çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleRequest</span>(<span class="hljs-params">userId: <span class="hljs-built_in">string</span>, skipProcessing: <span class="hljs-built_in">boolean</span></span>) {
 Â <span class="hljs-comment">// å³ä½¿ skipProcessing=trueï¼Œä¹Ÿä¼šç­‰å¾… userData</span>
 Â <span class="hljs-keyword">const</span> userData = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchUserData</span>(userId)
â€‹
 Â <span class="hljs-keyword">if</span> (skipProcessing) {
 Â  Â <span class="hljs-comment">// ç«‹å³è¿”å›ï¼Œä½†å‰é¢å·²ç»æµªè´¹æ—¶é—´ç­‰å¾…äº†</span>
 Â  Â <span class="hljs-keyword">return</span> { <span class="hljs-attr">skipped</span>: <span class="hljs-literal">true</span> }
  }
â€‹
 Â <span class="hljs-comment">// åªæœ‰è¿™ä¸ªåˆ†æ”¯ä½¿ç”¨ userData</span>
 Â <span class="hljs-keyword">return</span> <span class="hljs-title function_">processUserData</span>(userData)
}
</code></pre>
<p>é—®é¢˜æ˜¯ï¼Œå³ä½¿ <code>skipProcessing=true</code>ï¼Œè¿˜æ˜¯ä¼šå»è¯·æ±‚ <code>userData</code>ã€‚ç™½ç™½æµªè´¹æ—¶é—´ã€‚</p>
<p>åæ¥æ”¹æˆè¿™æ ·ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleRequest</span>(<span class="hljs-params">userId: <span class="hljs-built_in">string</span>, skipProcessing: <span class="hljs-built_in">boolean</span></span>) {
 Â <span class="hljs-keyword">if</span> (skipProcessing) {
 Â  Â <span class="hljs-keyword">return</span> { <span class="hljs-attr">skipped</span>: <span class="hljs-literal">true</span> }
  }
â€‹
 Â <span class="hljs-comment">// åªåœ¨éœ€è¦æ—¶æ‰è·å–æ•°æ®</span>
 Â <span class="hljs-keyword">const</span> userData = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchUserData</span>(userId)
 Â <span class="hljs-keyword">return</span> <span class="hljs-title function_">processUserData</span>(userData)
}
</code></pre>
<p>å…¶å®å¾ˆç®€å•ï¼Œä½†ä¹‹å‰å°±æ˜¯æ²¡æ³¨æ„åˆ°ã€‚</p>
<h3 data-id="heading-6">å‘ 2ï¼šå¤§å¯¹è±¡åˆ«ç›´æ¥ç”¨ ref</h3>
<p>1000 æ¡å•†å“æ•°æ®ï¼Œæ¯æ¡ 10+ ä¸ªå­—æ®µï¼Œä»¥å‰ç›´æ¥ <code>ref()</code>ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
â€‹
<span class="hljs-comment">// 1000 ä¸ªå•†å“ï¼Œæ¯ä¸ªå•†å“ 10+ å­—æ®µï¼Œå…¨éƒ¨å˜æˆå“åº”å¼</span>
<span class="hljs-keyword">const</span> products = ref&lt;<span class="hljs-title class_">Product</span>[]&gt;([])
â€‹
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadProducts</span>(<span class="hljs-params"/>) {
 Â products.<span class="hljs-property">value</span> = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchProducts</span>()
 Â <span class="hljs-comment">// Vue ä¼šé€’å½’éå†æ‰€æœ‰å¯¹è±¡ï¼Œæ·»åŠ å“åº”å¼ä»£ç†</span>
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>æ¸²æŸ“çš„æ—¶å€™å¡å¾—è¦å‘½ã€‚åæ¥å‘ç°åº”è¯¥ç”¨ <code>shallowRef</code>ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"ts"</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { shallowRef } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
â€‹
<span class="hljs-comment">// åªæœ‰æ•°ç»„æœ¬èº«æ˜¯å“åº”å¼çš„ï¼Œå†…éƒ¨å¯¹è±¡ä¿æŒæ™®é€šå¯¹è±¡</span>
<span class="hljs-keyword">const</span> products = shallowRef&lt;<span class="hljs-title class_">Product</span>[]&gt;([])
â€‹
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadProducts</span>(<span class="hljs-params"/>) {
 Â <span class="hljs-comment">// æ›¿æ¢æ•´ä¸ªæ•°ç»„è§¦å‘æ›´æ–°ï¼Œæ— éœ€æ·±åº¦å“åº”å¼</span>
 Â products.<span class="hljs-property">value</span> = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchProducts</span>()
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p><code>shallowRef</code> åªè®©æ•°ç»„æœ¬èº«å“åº”å¼ï¼Œå†…éƒ¨å¯¹è±¡ä¿æŒæ™®é€šå¯¹è±¡ã€‚æ›´æ–°æ—¶æ›¿æ¢æ•´ä¸ªæ•°ç»„å°±èƒ½è§¦å‘å“åº”ï¼Œçœäº†å¤§é‡æ€§èƒ½å¼€é”€ã€‚</p>
<h2 data-id="heading-7">å‡ ä¸ªçœŸå®æ¡ˆä¾‹ï¼ˆæˆ‘é‡åˆ°è¿‡çš„ï¼‰</h2>
<h3 data-id="heading-8">æ¡ˆä¾‹ 1ï¼šåˆ«å¯¹åŒä¸€ä¸ªæ•°ç»„å¾ªç¯å¤šæ¬¡</h3>
<p>ä¹‹å‰æ¥æ‰‹ä¸€ä¸ªé¡¹ç›®ï¼Œå‘ç°åŒä¸€ä¸ªå•†å“åˆ—è¡¨å¾ªç¯äº† 5 æ¬¡ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é”™è¯¯ï¼š5 æ¬¡ç‹¬ç«‹éå†</span>
<span class="hljs-keyword">const</span> discounted = products.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.<span class="hljs-property">discount</span> &gt; <span class="hljs-number">0</span>)
<span class="hljs-keyword">const</span> inStock = products.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.<span class="hljs-property">stock</span> &gt; <span class="hljs-number">0</span>)
<span class="hljs-keyword">const</span> featured = products.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.<span class="hljs-property">featured</span>)
<span class="hljs-keyword">const</span> totalValue = products.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">sum, p</span>) =&gt;</span> sum + p.<span class="hljs-property">price</span>, <span class="hljs-number">0</span>)
<span class="hljs-keyword">const</span> avgPrice = totalValue / products.<span class="hljs-property">length</span>
</code></pre>
<p>çœ‹ç€å°±éš¾å—ã€‚åæ¥æ”¹æˆä¸€æ¬¡å¾ªç¯ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æ­£ç¡®ï¼šä¸€æ¬¡éå†</span>
const stats = products<span class="hljs-selector-class">.reduce</span>((acc, product) =&gt; {
 Â if (product.discount &gt; <span class="hljs-number">0</span>) acc<span class="hljs-selector-class">.discounted</span><span class="hljs-selector-class">.push</span>(product)
 Â if (product.stock &gt; <span class="hljs-number">0</span>) acc<span class="hljs-selector-class">.inStock</span><span class="hljs-selector-class">.push</span>(product)
 Â if (product.featured) acc<span class="hljs-selector-class">.featured</span><span class="hljs-selector-class">.push</span>(product)
 Â acc<span class="hljs-selector-class">.totalValue</span> += product<span class="hljs-selector-class">.price</span>
 Â return acc
}, { discounted: [], inStock: [], featured: [], totalValue: <span class="hljs-number">0</span> })
â€‹
const avgPrice = stats<span class="hljs-selector-class">.totalValue</span> / products<span class="hljs-selector-class">.length</span>
</code></pre>
<p>å•†å“å°‘çš„æ—¶å€™çœ‹ä¸å‡ºæ¥ï¼Œæ•°æ®ä¸€å¤šæ€§èƒ½å·®è·å°±å¾ˆæ˜æ˜¾äº†ã€‚</p>
<h3 data-id="heading-9">æ¡ˆä¾‹ 2ï¼šç‹¬ç«‹çš„è¯·æ±‚ä¸è¦æ’é˜Ÿ</h3>
<p>ç”¨æˆ·è¯¦æƒ…é¡µï¼Œä¸‰ä¸ªäº’ä¸ä¾èµ–çš„æ¥å£ï¼Œç»“æœåœ¨ä¸²è¡Œè°ƒç”¨ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// é”™è¯¯ï¼šä¸²è¡Œï¼šæ€»è€—æ—¶ = 300ms + 200ms + 250ms = 750ms</span>
<span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> fetchUser(userId) Â  Â  Â  Â  Â <span class="hljs-comment">// 300ms</span>
<span class="hljs-keyword">const</span> posts = <span class="hljs-keyword">await</span> fetchUserPosts(userId) Â  Â <span class="hljs-comment">// 200ms</span>
<span class="hljs-keyword">const</span> comments = <span class="hljs-keyword">await</span> fetchUserComments(userId) <span class="hljs-comment">// 250ms</span>
</code></pre>
<p>æ”¹æˆå¹¶è¡Œä¹‹åï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// æ­£ç¡®ï¼šå¹¶è¡Œï¼šæ€»è€—æ—¶ = max(300ms, 200ms, 250ms) = 300ms</span>
const <span class="hljs-selector-attr">[user, posts, comments]</span> = await Promise<span class="hljs-selector-class">.all</span>([
 Â fetchUser(userId),
 Â <span class="hljs-built_in">fetchUserPosts</span>(userId),
 Â <span class="hljs-built_in">fetchUserComments</span>(userId)
])
</code></pre>
<p>æ€»è€—æ—¶ä» 750ms é™åˆ° 300msï¼Œé¡µé¢å¿«äº†ä¸€åŠå¤šã€‚è¿™ç§ä¼˜åŒ–æŠ•å…¥äº§å‡ºæ¯”æœ€é«˜ã€‚</p>
<h3 data-id="heading-10">æ¡ˆä¾‹ 3ï¼šé•¿åˆ—è¡¨ç”¨ CSS content-visibility</h3>
<p>1000+ æ¡è¯„è®ºçš„é¡µé¢ï¼Œåˆå§‹æ¸²æŸ“å¾ˆæ…¢ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- é”™è¯¯ï¼šæ‰€æœ‰è¯„è®ºç«‹å³æ¸²æŸ“ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"comment in comments"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"comment.id"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">CommentCard</span> <span class="hljs-attr">:comment</span>=<span class="hljs-string">"comment"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>åæ¥åŠ ä¸Š <code>content-visibility</code>ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- æ­£ç¡®ï¼šæµè§ˆå™¨è·³è¿‡å±å¹•å¤–çš„æ¸²æŸ“ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span>
  <span class="hljs-attr">v-for</span>=<span class="hljs-string">"comment in comments"</span>
  <span class="hljs-attr">:key</span>=<span class="hljs-string">"comment.id"</span>
  <span class="hljs-attr">class</span>=<span class="hljs-string">"comment-item"</span>
&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">CommentCard</span> <span class="hljs-attr">:comment</span>=<span class="hljs-string">"comment"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.comment-item</span> {
  <span class="hljs-attribute">content-visibility</span>: auto;
  <span class="hljs-attribute">contain</span>-intrinsic-size: auto <span class="hljs-number">200px</span>;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
</code></pre>
<p>æµè§ˆå™¨ä¼šè·³è¿‡å±å¹•å¤–çš„æ¸²æŸ“ï¼Œåˆå§‹åŠ è½½å¿«äº† 5-10 å€ï¼Œæ»šåŠ¨ä¹Ÿæµç•…å¤šäº†ã€‚è¿™ä¸ª CSS å±æ€§çœŸçš„å¥½ç”¨ã€‚</p>
<h2 data-id="heading-11">æ€ä¹ˆç”¨</h2>
<h3 data-id="heading-12">ç›´æ¥çœ‹</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…‹éš†ä»“åº“</span>
git <span class="hljs-built_in">clone</span> https://github.com/ursazoo/vue-best-practices.git

<span class="hljs-comment"># å®‰è£…ä¾èµ–</span>
npm install

<span class="hljs-comment"># æ„å»º AGENTS.md</span>
npm run build
</code></pre>
<p>å…‹éš†ä¸‹æ¥ï¼Œç›´æ¥çœ‹ <code>rules/</code> ç›®å½•ä¸‹çš„è§„åˆ™æ–‡ä»¶ã€‚æ¯ä¸ªæ–‡ä»¶éƒ½æ˜¯ç‹¬ç«‹çš„ï¼ŒåŒ…å«é—®é¢˜è¯´æ˜ã€ä»£ç ç¤ºä¾‹å’Œè§£å†³æ–¹æ¡ˆã€‚</p>
<p>ä¹Ÿå¯ä»¥çœ‹æ„å»ºå¥½çš„ <code>AGENTS.md</code>ï¼ŒæŠŠæ‰€æœ‰è§„åˆ™æ•´åˆåœ¨ä¸€èµ·ï¼Œæ–¹ä¾¿æœç´¢ã€‚</p>
<h3 data-id="heading-13">é›†æˆåˆ° AI ç¼–ç åŠ©æ‰‹</h3>
<p>å¦‚æœä½ ä¹Ÿåœ¨ç”¨ Claude Codeã€Cursor è¿™ç±» AI å·¥å…·å†™ä»£ç ï¼Œå¯ä»¥é›†æˆè¿›å»ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">npx <span class="hljs-keyword">add</span>-skill vue-best-practices
</code></pre>
<p>AI å®¡æŸ¥ä»£ç çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°æ€§èƒ½é—®é¢˜ï¼ˆæ¯”å¦‚è¯·æ±‚ç€‘å¸ƒæµã€è¿‡åº¦å“åº”å¼ï¼‰ï¼Œä¼šå‚è€ƒè¿™äº›è§„åˆ™ç»™å‡ºä¼˜åŒ–å»ºè®®ã€‚æˆ‘ç°åœ¨å°±æ˜¯è¿™ä¹ˆç”¨çš„ï¼ŒæŒºæ–¹ä¾¿ã€‚</p>
<h2 data-id="heading-14">Vue 2 è¿˜æ˜¯ Vue 3</h2>
<p>éƒ½æ”¯æŒã€‚æ¯æ¡è§„åˆ™éƒ½æ ‡æ³¨äº†ç‰ˆæœ¬å…¼å®¹æ€§ï¼š</p>
<ul>
<li><strong>Vue 2 &amp; 3 é€šç”¨</strong>ï¼šåŸºç¡€çš„æ€§èƒ½ä¼˜åŒ–æŠ€å·§</li>
<li><strong>Vue 3 Only</strong>ï¼šç”¨äº† <code>&lt;script setup&gt;</code>ã€<code>shallowRef</code>ã€<code>Suspense</code> ç­‰æ–°ç‰¹æ€§</li>
<li><strong>Vue 2 Only</strong>ï¼šé’ˆå¯¹ Vue 2 çš„ç‰¹å®šä¼˜åŒ–ï¼ˆæ¯”å¦‚ <code>Object.freeze()</code>ï¼‰</li>
</ul>
<p>è€é¡¹ç›®ä¹Ÿèƒ½ç”¨ï¼Œæ–°é¡¹ç›®èƒ½ç”¨å¾—æ›´å……åˆ†ã€‚</p>
<h2 data-id="heading-15">é¡¹ç›®åœ°å€</h2>
<p>GitHub: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fursazoo%2Fvue-best-practices" target="_blank" title="https://github.com/ursazoo/vue-best-practices" ref="nofollow noopener noreferrer">github.com/ursazoo/vueâ€¦</a></p>
<h2 data-id="heading-16">æ¬¢è¿è´¡çŒ®</h2>
<p>è¿™æ˜¯ä¸ªå¼€æºé¡¹ç›®ã€‚å¦‚æœä½ åœ¨ç”Ÿäº§ç¯å¢ƒè¸©è¿‡å‘ã€æœ‰æ›´å¥½çš„ä¼˜åŒ–æ–¹æ¡ˆï¼Œæ¬¢è¿æ Issue æˆ– PRã€‚</p>
<p>ç‰¹åˆ«æ˜¯ï¼š</p>
<ul>
<li>å®é™…é¡¹ç›®ä¸­é‡åˆ°çš„æ€§èƒ½é—®é¢˜</li>
<li>ç°æœ‰è§„åˆ™çš„æ”¹è¿›å»ºè®®</li>
<li>Vue/Nuxt æ–°ç‰ˆæœ¬çš„ä¼˜åŒ–æŠ€å·§</li>
</ul>
<hr/>
<p><strong>é¡¹ç›®ä¿¡æ¯</strong>ï¼š</p>
<ul>
<li>46 æ¡è§„åˆ™ï¼Œ10 ä¸ªç±»åˆ«</li>
<li>æŒ‰å½±å“ç¨‹åº¦æ’åºï¼ˆå…ˆè§£å†³å¤§é—®é¢˜ï¼‰</li>
<li>æ”¯æŒ Vue 2/3 å’Œ Nuxt</li>
<li>é€‚é… AI ç¼–ç åŠ©æ‰‹</li>
</ul>
<p>å¸Œæœ›å¯¹ä½ æœ‰å¸®åŠ©ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æµè§ˆå™¨è‡ªåŠ¨åŒ– MCP å¯¹æ¯”ï¼šPlaywright MCP vs MCP-Chrome]]></title>    <link>https://juejin.cn/post/7596339303862485043</link>    <guid>https://juejin.cn/post/7596339303862485043</guid>    <pubDate>2026-01-19T03:35:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596339303862485043" data-draft-id="7596343020214190106" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æµè§ˆå™¨è‡ªåŠ¨åŒ– MCP å¯¹æ¯”ï¼šPlaywright MCP vs MCP-Chrome"/> <meta itemprop="keywords" content="MCP"/> <meta itemprop="datePublished" content="2026-01-19T03:35:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Guoç™½ç»™"/> <meta itemprop="url" content="https://juejin.cn/user/655774614044221"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æµè§ˆå™¨è‡ªåŠ¨åŒ– MCP å¯¹æ¯”ï¼šPlaywright MCP vs MCP-Chrome
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/655774614044221/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Guoç™½ç»™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T03:35:23.000Z" title="Mon Jan 19 2026 03:35:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æµè§ˆå™¨è‡ªåŠ¨åŒ– MCP å¯¹æ¯”ï¼šPlaywright MCP vs MCP-Chrome</h2>
<p>æœ¬æ–‡æ¡£å¯¹æ¯”ä¸¤æ¬¾ä¸»æµçš„æµè§ˆå™¨è‡ªåŠ¨åŒ– MCP æœåŠ¡å™¨ï¼Œå¸®åŠ©ä½ é€‰æ‹©æœ€é€‚åˆçš„å·¥å…·ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€é¡¹ç›®æ¦‚è§ˆ</h3>




















<table><thead><tr><th>é¡¹ç›®</th><th>ç®€ä»‹</th><th>å¼€å‘è€…</th></tr></thead><tbody><tr><td><strong>Playwright MCP</strong></td><td>åŸºäº Playwright è‡ªåŠ¨åŒ–æ¡†æ¶çš„ MCP æœåŠ¡å™¨ï¼Œé€šè¿‡å¯è®¿é—®æ€§æ ‘(Accessibility Tree)å®ç°ç²¾å‡†ç½‘é¡µæ“ä½œ</td><td>Microsoft</td></tr><tr><td><strong>mcp-chrome</strong></td><td>é€šè¿‡æµè§ˆå™¨æ‰©å±•æ§åˆ¶å·²æœ‰ Chrome æµè§ˆå™¨çš„ MCP æœåŠ¡å™¨ï¼Œå¯å¤ç”¨ç”¨æˆ·ç™»å½•çŠ¶æ€</td><td>hangwin (ç¤¾åŒº)</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-2">äºŒã€å¼€æºä»“åº“åœ°å€</h3>




















<table><thead><tr><th>é¡¹ç›®</th><th>GitHub ä»“åº“</th><th>npm åŒ…</th></tr></thead><tbody><tr><td><strong>Playwright MCP</strong></td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmicrosoft%2Fplaywright-mcp" target="_blank" title="https://github.com/microsoft/playwright-mcp" ref="nofollow noopener noreferrer">github.com/microsoft/pâ€¦</a></td><td><code>@playwright/mcp</code></td></tr><tr><td><strong>mcp-chrome</strong></td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhangwin%2Fmcp-chrome" target="_blank" title="https://github.com/hangwin/mcp-chrome" ref="nofollow noopener noreferrer">github.com/hangwin/mcpâ€¦</a></td><td><code>mcp-chrome-bridge</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-3">ä¸‰ã€æ ¸å¿ƒåŠŸèƒ½å¯¹æ¯”</h3>























































<table><thead><tr><th>åŠŸèƒ½</th><th>Playwright MCP</th><th>mcp-chrome</th></tr></thead><tbody><tr><td><strong>æ˜¯å¦éœ€è¦æµè§ˆå™¨æ’ä»¶</strong></td><td>âŒ é»˜è®¤ä¸éœ€è¦</td><td>âœ… å¿…é¡»å®‰è£… Chrome æ‰©å±•</td></tr><tr><td><strong>æµè§ˆå™¨æ§åˆ¶æ–¹å¼</strong></td><td>Playwright è‡ªåŠ¨åŒ–æ¡†æ¶</td><td>Chrome DevTools Protocol + æ‰©å±•</td></tr><tr><td><strong>æµè§ˆå™¨å®ä¾‹</strong></td><td>å¯åŠ¨ç‹¬ç«‹æ–°æµè§ˆå™¨</td><td>æ§åˆ¶å·²æ‰“å¼€çš„æµè§ˆå™¨</td></tr><tr><td><strong>ç™»å½•çŠ¶æ€</strong></td><td>ç‹¬ç«‹é…ç½®æ–‡ä»¶ï¼ˆå¯é…ç½®ä¿ç•™ï¼‰</td><td>ç›´æ¥ä½¿ç”¨ç°æœ‰ç™»å½•çŠ¶æ€</td></tr><tr><td><strong>æ”¯æŒçš„æµè§ˆå™¨</strong></td><td>Chrome, Firefox, WebKit, Edge</td><td>ä»… Chrome/Edge</td></tr><tr><td><strong>é¡µé¢å¿«ç…§æ–¹å¼</strong></td><td>å¯è®¿é—®æ€§æ ‘ï¼ˆç»“æ„åŒ–æ•°æ®ï¼‰</td><td>DOM + æˆªå›¾</td></tr><tr><td><strong>æ— å¤´æ¨¡å¼</strong></td><td>âœ… æ”¯æŒ <code>--headless</code></td><td>âŒ éœ€è¦å¯è§æµè§ˆå™¨</td></tr><tr><td><strong>å¯åŠ¨é€Ÿåº¦</strong></td><td>è¾ƒæ…¢ï¼ˆéœ€å¯åŠ¨æ–°è¿›ç¨‹ï¼‰</td><td>è¾ƒå¿«ï¼ˆå¤ç”¨å·²æœ‰æµè§ˆå™¨ï¼‰</td></tr><tr><td><strong>éš”ç¦»æ€§</strong></td><td>âœ… é«˜ï¼ˆç‹¬ç«‹ç¯å¢ƒï¼‰</td><td>âŒ ä½ï¼ˆå…±äº«ç”¨æˆ·æ•°æ®ï¼‰</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-4">å››ã€é…ç½®æ“ä½œæŒ‡å—</h3>
<h4 data-id="heading-5">4.1 Playwright MCP é…ç½®</h4>
<h5 data-id="heading-6">åŸºç¡€é…ç½®ï¼ˆæ¨èï¼‰</h5>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"mcpServers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"playwright"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"npx"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"args"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"@playwright/mcp@latest"</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h5 data-id="heading-7">å¸¦å‚æ•°é…ç½®</h5>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"mcpServers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"playwright"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"npx"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"args"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">"@playwright/mcp@latest"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"--browser"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"chrome"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"--headless"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"--viewport-size"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"1280x720"</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h5 data-id="heading-8">å¸¸ç”¨å‚æ•°è¯´æ˜</h5>





































<table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>--browser &lt;type&gt;</code></td><td>æµè§ˆå™¨ç±»å‹ï¼šchrome, firefox, webkit, msedge</td></tr><tr><td><code>--headless</code></td><td>æ— å¤´æ¨¡å¼è¿è¡Œ</td></tr><tr><td><code>--isolated</code></td><td>éš”ç¦»æ¨¡å¼ï¼Œä¸ä¿å­˜çŠ¶æ€</td></tr><tr><td><code>--user-data-dir &lt;path&gt;</code></td><td>æŒ‡å®šç”¨æˆ·æ•°æ®ç›®å½•</td></tr><tr><td><code>--storage-state &lt;path&gt;</code></td><td>åŠ è½½å­˜å‚¨çŠ¶æ€æ–‡ä»¶</td></tr><tr><td><code>--viewport-size &lt;size&gt;</code></td><td>è§†å£å¤§å°ï¼Œå¦‚ "1280x720"</td></tr><tr><td><code>--port &lt;port&gt;</code></td><td>HTTP/SSE æ¨¡å¼ç«¯å£</td></tr></tbody></table>
<h5 data-id="heading-9">ç”¨æˆ·é…ç½®æ–‡ä»¶ä½ç½®</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Windows</span>
%USERPROFILE%\AppData\Local\ms-playwright\mcp-chrome-profile

<span class="hljs-comment"># macOS</span>
~/Library/Caches/ms-playwright/mcp-chrome-profile

<span class="hljs-comment"># Linux</span>
~/.cache/ms-playwright/mcp-chrome-profile
</code></pre>
<hr/>
<h4 data-id="heading-10">4.2 mcp-chrome é…ç½®</h4>
<h5 data-id="heading-11">æ­¥éª¤ 1ï¼šå®‰è£…æµè§ˆå™¨æ‰©å±•</h5>
<ol>
<li>è®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhangwin%2Fmcp-chrome" target="_blank" title="https://github.com/hangwin/mcp-chrome" ref="nofollow noopener noreferrer">github.com/hangwin/mcpâ€¦</a></li>
<li>ä¸‹è½½æ‰©å±•æ–‡ä»¶æˆ–ä» Chrome Web Store å®‰è£…</li>
<li>åœ¨ Chrome ä¸­å¯ç”¨æ‰©å±•å¹¶æˆæƒ</li>
</ol>
<h5 data-id="heading-12">æ­¥éª¤ 2ï¼šå®‰è£… Bridge å·¥å…·</h5>
<pre><code class="hljs language-bash" lang="bash">npm install -g mcp-chrome-bridge
<span class="hljs-comment"># æˆ–</span>
npx mcp-chrome-bridge
</code></pre>
<h5 data-id="heading-13">æ­¥éª¤ 3ï¼šMCP å®¢æˆ·ç«¯é…ç½®</h5>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"mcpServers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"chrome"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"streamable-http"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"http://127.0.0.1:12306/mcp"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h5 data-id="heading-14">æˆ–ä½¿ç”¨ STDIO æ¨¡å¼</h5>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"mcpServers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"chrome"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"npx"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"args"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"mcp-chrome-bridge"</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h3 data-id="heading-15">äº”ã€æä¾›çš„å·¥å…·å¯¹æ¯”</h3>
<h4 data-id="heading-16">Playwright MCP å·¥å…·åˆ—è¡¨</h4>





































































<table><thead><tr><th>å·¥å…·</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>browser_navigate</code></td><td>å¯¼èˆªåˆ° URL</td></tr><tr><td><code>browser_click</code></td><td>ç‚¹å‡»å…ƒç´ </td></tr><tr><td><code>browser_type</code></td><td>è¾“å…¥æ–‡æœ¬</td></tr><tr><td><code>browser_fill_form</code></td><td>å¡«å†™è¡¨å•</td></tr><tr><td><code>browser_snapshot</code></td><td>è·å–é¡µé¢å¿«ç…§</td></tr><tr><td><code>browser_take_screenshot</code></td><td>æˆªå›¾</td></tr><tr><td><code>browser_evaluate</code></td><td>æ‰§è¡Œ JavaScript</td></tr><tr><td><code>browser_press_key</code></td><td>æŒ‰é”®æ“ä½œ</td></tr><tr><td><code>browser_select_option</code></td><td>é€‰æ‹©ä¸‹æ‹‰é€‰é¡¹</td></tr><tr><td><code>browser_hover</code></td><td>é¼ æ ‡æ‚¬åœ</td></tr><tr><td><code>browser_drag</code></td><td>æ‹–æ‹½æ“ä½œ</td></tr><tr><td><code>browser_file_upload</code></td><td>æ–‡ä»¶ä¸Šä¼ </td></tr><tr><td><code>browser_tabs</code></td><td>æ ‡ç­¾é¡µç®¡ç†</td></tr><tr><td><code>browser_pdf_save</code></td><td>ä¿å­˜ä¸º PDF (éœ€ --caps=pdf)</td></tr><tr><td><code>browser_close</code></td><td>å…³é—­æµè§ˆå™¨</td></tr></tbody></table>
<h4 data-id="heading-17">mcp-chrome å·¥å…·åˆ—è¡¨</h4>

















































<table><thead><tr><th>å·¥å…·</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>navigate</code></td><td>å¯¼èˆªåˆ° URL</td></tr><tr><td><code>click</code></td><td>ç‚¹å‡»å…ƒç´ </td></tr><tr><td><code>type</code></td><td>è¾“å…¥æ–‡æœ¬</td></tr><tr><td><code>screenshot</code></td><td>æˆªå›¾</td></tr><tr><td><code>evaluate</code></td><td>æ‰§è¡Œ JavaScript</td></tr><tr><td><code>get_tabs</code></td><td>è·å–æ ‡ç­¾é¡µåˆ—è¡¨</td></tr><tr><td><code>switch_tab</code></td><td>åˆ‡æ¢æ ‡ç­¾é¡µ</td></tr><tr><td><code>close_tab</code></td><td>å…³é—­æ ‡ç­¾é¡µ</td></tr><tr><td><code>get_cookies</code></td><td>è·å– Cookies</td></tr><tr><td><code>set_cookies</code></td><td>è®¾ç½® Cookies</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-18">å…­ã€ä¼˜ç¼ºç‚¹åˆ†æ</h3>
<h4 data-id="heading-19">Playwright MCP</h4>
<p><strong>âœ… ä¼˜ç‚¹</strong></p>
<ul>
<li>æ— éœ€å®‰è£…æµè§ˆå™¨æ’ä»¶ï¼Œå¼€ç®±å³ç”¨</li>
<li>æ”¯æŒå¤šç§æµè§ˆå™¨ï¼ˆChromeã€Firefoxã€Safariï¼‰</li>
<li>åŸºäºå¯è®¿é—®æ€§æ ‘ï¼Œå…ƒç´ å®šä½ç²¾å‡†</li>
<li>å®Œå–„çš„éš”ç¦»æœºåˆ¶ï¼Œé€‚åˆè‡ªåŠ¨åŒ–æµ‹è¯•</li>
<li>Microsoft å®˜æ–¹ç»´æŠ¤ï¼Œæ›´æ–°æ´»è·ƒ</li>
<li>ä¸°å¯Œçš„é…ç½®é€‰é¡¹å’Œå·¥å…·</li>
</ul>
<p><strong>âŒ ç¼ºç‚¹</strong></p>
<ul>
<li>å¯åŠ¨æ–°æµè§ˆå™¨æœ‰ä¸€å®šå»¶è¿Ÿ</li>
<li>é»˜è®¤ä¸èƒ½ç›´æ¥ä½¿ç”¨å·²ç™»å½•è´¦å·</li>
<li>èµ„æºå ç”¨ç›¸å¯¹è¾ƒé«˜</li>
</ul>
<h4 data-id="heading-20">mcp-chrome</h4>
<p><strong>âœ… ä¼˜ç‚¹</strong></p>
<ul>
<li>ç›´æ¥ä½¿ç”¨å·²ç™»å½•çš„æµè§ˆå™¨ä¼šè¯</li>
<li>å¯åŠ¨å¿«ï¼Œæ— éœ€ç­‰å¾…æµè§ˆå™¨å¯åŠ¨</li>
<li>å¯ä»¥æ“ä½œç”¨æˆ·å·²æ‰“å¼€çš„æ ‡ç­¾é¡µ</li>
<li>èµ„æºå ç”¨ä½</li>
</ul>
<p><strong>âŒ ç¼ºç‚¹</strong></p>
<ul>
<li>å¿…é¡»å®‰è£…æµè§ˆå™¨æ‰©å±•</li>
<li>ä»…æ”¯æŒ Chrome/Edge</li>
<li>éšç§å®‰å…¨é£é™©è¾ƒé«˜</li>
<li>ç¤¾åŒºç»´æŠ¤ï¼Œæ›´æ–°å¯èƒ½ä¸åŠæ—¶</li>
<li>é…ç½®ç›¸å¯¹å¤æ‚</li>
</ul>
<hr/>
<h3 data-id="heading-21">ä¸ƒã€ä½¿ç”¨åœºæ™¯æ¨è</h3>









































<table><thead><tr><th>åœºæ™¯</th><th>æ¨èå·¥å…·</th></tr></thead><tbody><tr><td>è‡ªåŠ¨åŒ–æµ‹è¯•</td><td>âœ… Playwright MCP</td></tr><tr><td>ç½‘é¡µæ•°æ®é‡‡é›†/çˆ¬è™«</td><td>âœ… Playwright MCP</td></tr><tr><td>éœ€è¦ä½¿ç”¨å·²ç™»å½•è´¦å·æ“ä½œ</td><td>âœ… mcp-chrome</td></tr><tr><td>éœ€è¦æ”¯æŒ Firefox/Safari</td><td>âœ… Playwright MCP</td></tr><tr><td>å¿«é€ŸåŸå‹éªŒè¯</td><td>ä¸¤è€…çš†å¯</td></tr><tr><td>CI/CD æµæ°´çº¿é›†æˆ</td><td>âœ… Playwright MCP</td></tr><tr><td>æ“ä½œä¼ä¸šå†…ç½‘ç³»ç»Ÿï¼ˆéœ€ç™»å½•ï¼‰</td><td>âœ… mcp-chrome</td></tr><tr><td>æ‰¹é‡æˆªå›¾/PDF ç”Ÿæˆ</td><td>âœ… Playwright MCP</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-22">å…«ã€å¿«é€Ÿå¼€å§‹ç¤ºä¾‹</h3>
<h4 data-id="heading-23">Playwright MCP ç¤ºä¾‹å¯¹è¯</h4>
<pre><code class="hljs language-rust" lang="rust">ç”¨æˆ·: å¸®æˆ‘æ‰“å¼€ç™¾åº¦ï¼Œæœç´¢<span class="hljs-string">"äººå·¥æ™ºèƒ½"</span>ï¼Œç„¶åæˆªå›¾

AI æ‰§è¡Œ:
<span class="hljs-number">1</span>. browser_navigate <span class="hljs-punctuation">-&gt;</span> https:<span class="hljs-comment">//www.baidu.com</span>
<span class="hljs-number">2</span>. browser_type <span class="hljs-punctuation">-&gt;</span> åœ¨æœç´¢æ¡†è¾“å…¥<span class="hljs-string">"äººå·¥æ™ºèƒ½"</span>
<span class="hljs-number">3</span>. browser_click <span class="hljs-punctuation">-&gt;</span> ç‚¹å‡»<span class="hljs-string">"ç™¾åº¦ä¸€ä¸‹"</span>æŒ‰é’®
<span class="hljs-number">4</span>. browser_take_screenshot <span class="hljs-punctuation">-&gt;</span> ä¿å­˜æˆªå›¾
</code></pre>
<h4 data-id="heading-24">mcp-chrome ç¤ºä¾‹å¯¹è¯</h4>
<pre><code class="hljs language-rust" lang="rust">ç”¨æˆ·: å¸®æˆ‘åœ¨å½“å‰æµè§ˆå™¨é‡Œæ‰“å¼€æˆ‘çš„ GitHub ä¸»é¡µ

AI æ‰§è¡Œ:
<span class="hljs-number">1</span>. navigate <span class="hljs-punctuation">-&gt;</span> https:<span class="hljs-comment">//github.com (ä½¿ç”¨å·²ç™»å½•çŠ¶æ€)</span>
<span class="hljs-number">2</span>. screenshot <span class="hljs-punctuation">-&gt;</span> è¿”å›æˆªå›¾
</code></pre>
<hr/>
<h3 data-id="heading-25">ä¹ã€æ€»ç»“</h3>



































<table><thead><tr><th>ç»´åº¦</th><th>Playwright MCP</th><th>mcp-chrome</th></tr></thead><tbody><tr><td>æ˜“ç”¨æ€§</td><td>â­â­â­â­â­</td><td>â­â­â­</td></tr><tr><td>åŠŸèƒ½ä¸°å¯Œåº¦</td><td>â­â­â­â­â­</td><td>â­â­â­</td></tr><tr><td>å®‰å…¨æ€§</td><td>â­â­â­â­â­</td><td>â­â­â­</td></tr><tr><td>çµæ´»æ€§</td><td>â­â­â­â­</td><td>â­â­â­â­â­</td></tr><tr><td>ç¤¾åŒºæ´»è·ƒåº¦</td><td>â­â­â­â­â­</td><td>â­â­â­</td></tr></tbody></table>
<p><strong>æ¨èé€‰æ‹©</strong>ï¼š</p>
<ul>
<li>å¦‚æœä½ æ˜¯å¼€å‘è€…æˆ–éœ€è¦è‡ªåŠ¨åŒ–æµ‹è¯• â†’ <strong>Playwright MCP</strong></li>
<li>å¦‚æœä½ éœ€è¦æ“ä½œå·²ç™»å½•çš„ç½‘ç«™ â†’ <strong>mcp-chrome</strong> æˆ– Playwright MCP æ‰©å±•æ¨¡å¼</li>
</ul>
<hr/>
<h3 data-id="heading-26">åã€å‚è€ƒé“¾æ¥</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmicrosoft%2Fplaywright-mcp" target="_blank" title="https://github.com/microsoft/playwright-mcp" ref="nofollow noopener noreferrer">Playwright MCP GitHub</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fplaywright.dev" target="_blank" title="https://playwright.dev" ref="nofollow noopener noreferrer">Playwright å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhangwin%2Fmcp-chrome" target="_blank" title="https://github.com/hangwin/mcp-chrome" ref="nofollow noopener noreferrer">mcp-chrome GitHub</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io" target="_blank" title="https://modelcontextprotocol.io" ref="nofollow noopener noreferrer">MCP åè®®è§„èŒƒ</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å…³äºruyiç”Ÿäº§æ­£å¸¸ï¼Œå¼€å‘å¼‚å¸¸çš„é—®é¢˜è®°å½•]]></title>    <link>https://juejin.cn/post/7596681780374339610</link>    <guid>https://juejin.cn/post/7596681780374339610</guid>    <pubDate>2026-01-19T09:39:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596681780374339610" data-draft-id="7596681780374093850" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…³äºruyiç”Ÿäº§æ­£å¸¸ï¼Œå¼€å‘å¼‚å¸¸çš„é—®é¢˜è®°å½•"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-19T09:39:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çœŸå¤œ"/> <meta itemprop="url" content="https://juejin.cn/user/3892727627132343"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…³äºruyiç”Ÿäº§æ­£å¸¸ï¼Œå¼€å‘å¼‚å¸¸çš„é—®é¢˜è®°å½•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3892727627132343/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çœŸå¤œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T09:39:07.000Z" title="Mon Jan 19 2026 09:39:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    23
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é—®é¢˜æè¿°</h2>
<p>å› å…¬å¸éœ€è¦ï¼Œä½¿ç”¨çš„ç¯å¢ƒæ˜¯ruyiçš„å‰ç«¯éƒ¨åˆ†ï¼Œé‡‡ç”¨vue2+element-ui</p>
<p>1.å½“ä»¥å¼€å‘ç¯å¢ƒè¿›å…¥é¡µé¢æ—¶ï¼Œç¬¬ä¸€æ¬¡æ­£å¸¸ï¼Œåœ¨åˆ·æ–°åä¼šç™½å±ï¼Œæˆ–è€…å¡åœ¨åŠ è½½é¡µé¢ï¼Œæ§åˆ¶å°æŠ›å‡ºé”™è¯¯
2.å…³äºæ ·å¼å¼‚å¸¸é—®é¢˜</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Uncaught</span> <span class="hljs-title class_">SyntaxError</span>: <span class="hljs-title class_">Unexpected</span> token <span class="hljs-string">'&lt;'</span>
</code></pre>
<p>ä½†è¿›å…¥ç”Ÿäº§ç¯å¢ƒè®¿é—®ï¼Œä¸€åˆ‡æ­£å¸¸ï¼Œåˆ·æ–°åä¹Ÿä¾ç„¶æ­£å¸¸ã€‚</p>
<h2 data-id="heading-1">åŸå› </h2>
<p>é—®é¢˜å°±å‡ºåœ¨Uncaught SyntaxErrorä¸Šï¼Œè¿™æ˜¯jsçš„è¯­æ³•é”™è¯¯ã€‚ä¾‹å¦‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> 
</code></pre>
<p>ä¸Šé¢ä»£ç ä¼šæŠ›å‡º</p>
<pre><code class="hljs language-js" lang="js">
<span class="hljs-keyword">const</span> 
      

<span class="hljs-title class_">SyntaxError</span>: <span class="hljs-title class_">Unexpected</span> end <span class="hljs-keyword">of</span> input
</code></pre>
<p>å½“ç‚¹å‡»æŠ›å‡ºéƒ¨åˆ†è¿›å…¥å…·ä½“é”™è¯¯åœ°æ–¹ï¼Œä¼šè¿›å…¥htmlé¡µé¢ï¼Œé”™è¯¯å°±å‡ºåœ¨è¿™ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
æµè§ˆå™¨è¯·æ±‚è·å–htmlé¡µé¢ --&gt; æµè§ˆå™¨è§£æhtml --&gt;è§£æscriptä¸linkæ ‡ç­¾
</code></pre>
<p>é—®é¢˜å°±å‡ºåœ¨è§£æè§£æscriptä¸linkæ ‡ç­¾ä¸Š</p>
<p>æ€»æ‰€å‘¨çŸ¥é“scriptçš„æ ‡ç­¾ä½¿ç”¨</p>
<pre><code class="hljs language-js" lang="js">&lt;script src=<span class="hljs-string">"xxxx"</span>&gt;
</code></pre>
<p>è¿™æ—¶å€™æµè§ˆå™¨å‘è¯·æ±‚æ‹¿å–åˆ°jsé—®é¢˜ï¼Œä½†å¦‚æœæ‹¿å–åˆ°çš„å¹¶éjsæ–‡ä»¶ï¼Œé‚£è‡ªç„¶ä¼šæœ‰SyntaxErroré”™ï¼Œæœ¬äººå°±é‡åˆ°è¿™ç§æƒ…å†µã€‚ç”Ÿäº§æ­£å¸¸çš„åŸå› åœ¨äºngé…ç½®å¯¹äº†ï¼Œå¼€å‘ç¯å¢ƒé…ç½®é”™äº†ã€‚å› ä¸ºå¼€å‘ç¯å¢ƒä¹Ÿæœ‰ç±»ä¼¼äº  try_files <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>r</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">uri </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"/><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">i</span></span></span></span></span>uri/ /xxx/index.html;çš„é…ç½®é€»è¾‘ï¼Œ<strong>æ—¢æ— è®ºè¯·æ±‚ä»€ä¹ˆå¦‚æœè¯·æ±‚ä¸åˆ°äº†å°±è¿”å›/xxx/index.html ä½†jsæ–‡ä»¶å’Œcssæ–‡ä»¶æ˜¯å®é™…å­˜åœ¨çš„ï¼Œæ˜¯è¯·æ±‚çš„åˆ°çš„ï¼Œç†è®ºä¸Šæ˜¯ä¸åº”è¯¥è¿”å›html</strong></p>
<p>æœ¬äººå…·ä½“å‰ç«¯é”™è¯¯é…ç½®äº†å•¥å¿˜äº†ï¼Œå› ä¸ºvue-cliåœ¨é…ç½®æ–‡ä»¶ä¸­éœ€è¦é‡å¯æ‰ç”Ÿæ•ˆï¼Œ</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Router</span>({
  <span class="hljs-attr">mode</span>: <span class="hljs-string">'history'</span>, <span class="hljs-comment">// å»æ‰urlä¸­çš„#</span>
  <span class="hljs-attr">scrollBehavior</span>: <span class="hljs-function">() =&gt;</span> ({ <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> }),
  <span class="hljs-attr">routes</span>: constantRoutes,
  <span class="hljs-attr">base</span>: <span class="hljs-string">'/yyy'</span>, <span class="hljs-comment">// å½“è·¯ç”±é…ç½®base åˆ°æ—¶å€™è¿›å…¥http://xxx:xx/yyyæ‰ä¼šå±•ç¤ºé¡µé¢ã€‚http://xxx:xxä¼šç©ºç™½</span>
  
  
  
  å¯¹åº”çš„vite/vue-cliéƒ½å¾—é…ç½®
  <span class="hljs-attr">publicPath</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">"production"</span> ? <span class="hljs-string">"/yyy/"</span> : <span class="hljs-string">"/"</span>,
  æ—¢ç”Ÿäº§ç¯å¢ƒéœ€è¦æ·»åŠ nbbz å¼€å‘ç¯å¢ƒä¸éœ€è¦æ·»åŠ ï¼Œå¦‚æœç”Ÿäº§ä¸ç¼–å†™/yyy/ä¼šå¯¼è‡´ç”Ÿäº§ä¸Šæœ‰é—®é¢˜
})
</code></pre>
<h2 data-id="heading-2">å…³äºæ ·å¼é—®é¢˜</h2>
<p>åœ¨ruyiæ ·å¼é—®é¢˜å½“ä¸­/srccomponents/ThemePicker è¿™ä¸ªæ–‡ä»¶å½“ä¸­çš„æœ‰ä¸ªsetThemeå‡½æ•°ï¼Œå½“ä¸­çš„</p>
<pre><code class="hljs language-js" lang="js">   <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">chalk</span>) {
        <span class="hljs-keyword">const</span> url = <span class="hljs-string">`<span class="hljs-subst">${process.env.VUE_APP_BASE_URL}</span>/styles/theme-chalk/index.css`</span>
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCSSString</span>(url, <span class="hljs-string">'chalk'</span>)
      }
</code></pre>
<pre><code class="hljs language-js" lang="js">ç”Ÿäº§
<span class="hljs-variable constant_">VUE_APP_BASE_URL</span> = <span class="hljs-string">'/yyy'</span>
å¼€å‘
<span class="hljs-variable constant_">VUE_APP_BASE_URL</span> = <span class="hljs-string">'http://localhost:8090'</span>
</code></pre>
<p>styles/theme-chalk/index.cssè¿™æ˜¯æ‰‹åŠ¨è¯·æ±‚ï¼Œä¸æ˜¯æµè§ˆå™¨è¯·æ±‚çš„cssã€‚æ–‡ä»¶æ–‡ä»¶åœ¨public/stylesä¸‹é¢
å½“ä»¥ä¸Šè·¯ç”±åœ¨ç”Ÿäº§å½“ä¸­é…ç½®äº†base è¯·æ±‚å¤´å‰é¢ä¹Ÿéœ€è¦å¸¦ä¸Šï¼Œå¦åˆ™ä¼šæŠ¥404</p>
<p>è€Œå¼€å‘ç¯å¢ƒéœ€è¦å¸¦<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A%25E6%259C%258D%25E5%258A%25A1%25E7%25AB%25AF%25E5%258F%25A3" target="_blank" title="http://localhost:%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%8F%A3" ref="nofollow noopener noreferrer">http://localhost:æœåŠ¡ç«¯å£</a> ã€‚å› ä¸ºå¼€å‘çš„æ—¶å€™æ²¡æœ‰è‡ªåŠ¨æºå¸¦å‰é¢çš„ip</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é£ç‰›OS NAS + Tailscale P2Pç›´è¿é…ç½®]]></title>    <link>https://juejin.cn/post/7596342523969437705</link>    <guid>https://juejin.cn/post/7596342523969437705</guid>    <pubDate>2026-01-19T09:04:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596342523969437705" data-draft-id="7596687515031224346" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é£ç‰›OS NAS + Tailscale P2Pç›´è¿é…ç½®"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-19T09:04:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£ä¹‹æ—…äºº"/> <meta itemprop="url" content="https://juejin.cn/user/43636193505790"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é£ç‰›OS NAS + Tailscale P2Pç›´è¿é…ç½®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/43636193505790/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£ä¹‹æ—…äºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T09:04:27.000Z" title="Mon Jan 19 2026 09:04:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ•´åˆ<strong>çº¯P2Pç›´è¿ã€æ€§èƒ½æœ€ä¼˜ã€é€‚é…NASåœºæ™¯</strong>çš„æ ¸å¿ƒå‚æ•°ï¼Œç²¾ç»†æƒé™æ§åˆ¶ï¼ˆ<code>cap_add</code>æ›¿ä»£<code>privileged</code>ï¼‰ï¼ŒP2På…³é”®å‚æ•°ï¼Œæœ€ç»ˆé…ç½®å¦‚ä¸‹ï¼š</p>
</blockquote>
<blockquote>
<p>tailscale å®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Flogin.tailscale.com%2Fadmin%2Fmachines" target="_blank" title="https://login.tailscale.com/admin/machines" ref="nofollow noopener noreferrer">login.tailscale.com/admin/machiâ€¦</a></p>
</blockquote>
<p>ã€æ³¨æ„ã€‘ï¼šåªéœ€ä¸¤å¤„ä¿®æ”¹ï¼TS_AUTHKEY å’Œ TS_EXTRA_ARGS ä¸­çš„"192.168.5.0/24"éƒ¨åˆ†ã€‚å…¶ä½™ä¸å˜ã€‚</p>
<pre><code class="hljs language-YAML" lang="YAML"><span class="hljs-attr">version:</span> <span class="hljs-string">"3.8"</span>
<span class="hljs-attr">services:</span>
  <span class="hljs-attr">tailscale:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">tailscale/tailscale:latest</span>
    <span class="hljs-attr">container_name:</span> <span class="hljs-string">tailscale</span>
    <span class="hljs-attr">hostname:</span> <span class="hljs-string">fnos-nas</span>
    <span class="hljs-attr">network_mode:</span> <span class="hljs-string">"host"</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>
    <span class="hljs-attr">cap_add:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">NET_ADMIN</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">NET_RAW</span>
    <span class="hljs-attr">devices:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/dev/net/tun:/dev/net/tun</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">/mnt/nas/tailscale-data:/var/lib/tailscale</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-comment"># æ›¿æ¢ä¸ºä½ è‡ªå·±çš„Reusableç±»å‹Auth Keyï¼ˆå¿…é¡»æœ‰æ•ˆä¸”æœªè¿‡æœŸï¼‰</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">TS_AUTHKEY=xxx</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">TS_STATE_DIR=/var/lib/tailscale</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">TS_USERSPACE=false</span>  <span class="hljs-comment"># å†…æ ¸çº§æ¨¡å¼,æ€§èƒ½æ›´ä¼˜ï¼ˆéœ€è¦/dev/net/tunå’ŒNET_ADMINæƒé™ï¼‰</span>
      <span class="hljs-comment"># å®£å‘Šå†…ç½‘è·¯ç”± + ç›´è¿ä¼˜åŒ–å‚æ•°ï¼ˆæ— å¤šä½™ç©ºæ ¼ï¼‰</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">TS_EXTRA_ARGS=--advertise-routes=192.168.5.0/24</span> <span class="hljs-string">--netfilter-mode=on</span> <span class="hljs-string">--snat-subnet-routes=true</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">TS_DISABLE_DNS=true</span>  <span class="hljs-comment"># é¿å…ä¸é£ç‰›OS DNSå†²çª</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">TS_ENABLE_LOCAL_DISCOVERY=true</span>  <span class="hljs-comment"># å¯ç”¨å±€åŸŸç½‘æœ¬åœ°å‘ç°ï¼ˆç›´è¿ä¼˜åŒ–ï¼‰</span>
</code></pre>
<h3 data-id="heading-0">å…³é”®å‚æ•°å®Œå–„è¯´æ˜ï¼ˆæœ€ä¼˜æ–¹æ¡ˆæ ¸å¿ƒï¼‰</h3>

























<table><thead><tr><th>å‚æ•°</th><th>å®Œå–„åŸå›  &amp; ä½œç”¨</th></tr></thead><tbody><tr><td><code>version: "3.8"</code></td><td>æŒ‡å®šDocker Composeæ–‡ä»¶æ ¼å¼ç‰ˆæœ¬,ç¡®ä¿å…¼å®¹æ€§</td></tr><tr><td><code>cap_add: NET_ADMIN + NET_RAW</code></td><td>æ›¿ä»£<code>privileged=true</code>,ä»…èµ‹äºˆå¿…è¦ç½‘ç»œæƒé™,æ›´å®‰å…¨(NASåœºæ™¯ä¼˜å…ˆç²¾ç»†æƒé™)</td></tr><tr><td><code>TS_DISABLE_DNS=true</code></td><td>é€‚é…NASåœºæ™¯:é¿å…Tailscaleä¿®æ”¹DNSå¯¼è‡´é£ç‰›OSè®¿é—®å†…ç½‘è®¾å¤‡/å¤–ç½‘åŸŸåè§£æå¼‚å¸¸</td></tr><tr><td><code>TS_USERSPACE=false</code></td><td>å†…æ ¸çº§æ¨¡å¼(æœ€ä¼˜é€‰æ‹©):ä½¿ç”¨ç³»ç»Ÿå†…æ ¸ç½‘ç»œæ ˆ,æ¯”ç”¨æˆ·ç©ºé—´æ¨¡å¼ä¼ è¾“é€Ÿåº¦æå‡30%+,é€‚é…P2Pç›´è¿(éœ€è¦/dev/net/tunå’ŒNET_ADMINæƒé™)</td></tr></tbody></table>
<h3 data-id="heading-1">éƒ¨ç½²&amp;éªŒè¯ï¼ˆæç®€3æ­¥ï¼‰</h3>
<h4 data-id="heading-2">æ­¥éª¤1ï¼šå‰ç½®å‡†å¤‡</h4>
<p>ç”ŸæˆAuth Keyï¼šç™»å½•<code>Tailscale</code>æ§åˆ¶å° <a href="https://link.juejin.cn?target=https%3A%2F%2Flogin.tailscale.com%2Fadmin%2Fauthkeys" target="_blank" title="https://login.tailscale.com/admin/authkeys" ref="nofollow noopener noreferrer">login.tailscale.com/admin/authkâ€¦</a> â†’ ç”Ÿæˆã€ŒReusableã€ç±»å‹å¯†é’¥ï¼ˆä»…å‹¾é€‰è¿™1é¡¹ï¼Œæ— éœ€å…¶ä»–ï¼‰ï¼›</p>
<h4 data-id="heading-3">æ­¥éª¤2ï¼šéƒ¨ç½²å®¹å™¨</h4>
<p>é£ç‰›osä¸­æ‰“å¼€docker â†’ é€‰ä¸­å·¦ä¾§composeï¼šé¡¹ç›®åç§° trailscale ï¼Œè·¯å¾„è®¾ç½®ä¸ºé¡¹ç›®ç£ç›˜ä¸­çš„ docker/tailscale ç›®å½• â†’ æŠŠä¸Šé¢çš„ymlå¡«è¿›å»å¹¶å‹¾é€‰åˆ›å»ºåç«‹å³å¯åŠ¨ï¼</p>
<h4 data-id="heading-4">æ­¥éª¤3ï¼šéªŒè¯çº¯P2Pç›´è¿</h4>
<p>åœ¨å…¬å¸ç”µè„‘ï¼ˆWindows 11ï¼‰CMDæ‰§è¡Œï¼ŒéªŒè¯è¿æ¥çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-Plain" lang="Plain"># ip ä½äº https://login.tailscale.com/admin/machines
tailscale ping 100.xxx.xx.xx
</code></pre>
<p><strong>è¿æ¥çŠ¶æ€è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>direct</code> - çº¯P2Pç›´è¿ï¼ˆæœ€ä¼˜çŠ¶æ€ï¼Œå»¶è¿Ÿæœ€ä½ï¼‰</li>
<li><code>via DERP(tok)</code> - é€šè¿‡å®˜æ–¹DERPä¸­ç»§æœåŠ¡å™¨ï¼ˆåˆå§‹è¿æ¥æˆ–NATç©¿é€å¤±è´¥æ—¶çš„ä¿åº•æ–¹å¼ï¼‰</li>
<li><code>via IP:PORT</code> - é€šè¿‡æŒ‡å®šä¸­ç»§èŠ‚ç‚¹ï¼ˆå¯èƒ½æ˜¯è‡ªå»ºçš„derperæœåŠ¡å™¨ï¼Œå»¶è¿Ÿä½æ—¶ä¹Ÿè§†ä¸ºP2PæˆåŠŸï¼‰</li>
</ul>
<p><strong>åˆ¤æ–­æ ‡å‡†ï¼š</strong></p>
<ul>
<li>å»¶è¿Ÿâ‰¤50msï¼šP2Pç›´è¿æˆåŠŸï¼ˆæ— è®ºæ˜¾ç¤ºdirectè¿˜æ˜¯viaæŸä¸ªèŠ‚ç‚¹ï¼‰</li>
<li>å»¶è¿Ÿ&gt;100msï¼šå¯èƒ½è¿˜åœ¨ä½¿ç”¨DERPä¸­ç»§ï¼Œéœ€è¦æ£€æŸ¥ç½‘ç»œç¯å¢ƒ</li>
</ul>
<h2 data-id="heading-5">æˆ‘çš„å®é™…æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</h2>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">C:</span>\Users\admin&gt;tailscale ping  <span class="hljs-number">100</span>.xxx.xx.xx
pong <span class="hljs-keyword">from</span> fnos-nas (<span class="hljs-number">100</span>.xxx.xx.xx) via DERP(tok) <span class="hljs-keyword">in</span> <span class="hljs-number">613</span>ms 
pong <span class="hljs-keyword">from</span> fnos-nas (<span class="hljs-number">100</span>.xxx.xx.xx) via DERP(tok) <span class="hljs-keyword">in</span> <span class="hljs-number">232</span>ms 
pong <span class="hljs-keyword">from</span> fnos-nas (<span class="hljs-number">100</span>.xxx.xx.xx) via DERP(tok) <span class="hljs-keyword">in</span> <span class="hljs-number">231</span>ms 
pong <span class="hljs-keyword">from</span> fnos-nas (<span class="hljs-number">100</span>.xxx.xx.xx) via  <span class="hljs-number">120</span>.xxx.xxx.xx:<span class="hljs-number">8582</span>  <span class="hljs-keyword">in</span> <span class="hljs-number">12</span>ms
æˆ–
<span class="hljs-symbol">C:</span>\Users\admin&gt;tailscale ping  <span class="hljs-number">100</span>.xxx.xx.xx
pong <span class="hljs-keyword">from</span> fnos-nas (<span class="hljs-number">100</span>.xxx.xx.xx) via  <span class="hljs-number">120</span>.xxx.xxx.xx:<span class="hljs-number">8582</span>  <span class="hljs-keyword">in</span> <span class="hljs-number">12</span>ms
</code></pre>
<p><strong>ç»“æœåˆ†æï¼š</strong> ç¬¬ä¸€ç§æƒ…å†µï¼Œæœ€åä¸€è¡Œå»¶è¿Ÿä»…12msï¼Œè¯´æ˜å·²æˆåŠŸå»ºç«‹P2Pç›´è¿ã€‚å‰é¢çš„<code>via DERP(tok)</code>æ˜¯ç›´è¿åå•†å®Œæˆå‰çš„<strong>è¿‡æ¸¡ä¸­ç»§çŠ¶æ€</strong>ï¼ŒTailscaleä¼šè‡ªåŠ¨å‡çº§åˆ°æœ€ä¼˜è·¯å¾„ã€‚åç»­å†pingå°±ä¸ä¼šå†æ˜¾ç¤º"DERP"ç­‰è¿‡åº¦çŠ¶æ€äº†ã€‚</p>
<p>åé¢ä¹Ÿå¯ä»¥ç”¨ tailscale status å’Œ tailscale netcheck ç»§ç»­éªŒè¯ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">C:\Users\admin&gt;tailscale</span> <span class="hljs-string">status</span>
<span class="hljs-number">100.</span><span class="hljs-string">xx.xx.xx</span>     <span class="hljs-string">changbao</span>  <span class="hljs-string">jooybao@</span>  <span class="hljs-string">windows</span>  <span class="hljs-bullet">-</span>
<span class="hljs-number">100.</span><span class="hljs-string">xx.xx.xx</span>   <span class="hljs-string">fnos-nas</span>  <span class="hljs-string">jooybao@</span>  <span class="hljs-string">linux</span>    <span class="hljs-bullet">-</span>

<span class="hljs-string">C:\Users\admin&gt;tailscale</span> <span class="hljs-string">netcheck</span>
<span class="hljs-attr">2026/01/19 16:12:24 portmap: monitor: gateway and self IP changed:</span> <span class="hljs-string">gw=</span> <span class="hljs-number">192.168</span><span class="hljs-number">.11</span><span class="hljs-number">.1</span>  <span class="hljs-string">self=</span> <span class="hljs-number">192.168</span><span class="hljs-number">.11</span><span class="hljs-number">.95</span> 

<span class="hljs-attr">Report:</span>
        <span class="hljs-string">*</span> <span class="hljs-attr">Time:</span> <span class="hljs-number">2026-01-19T08:12:26.7380025Z</span>
        <span class="hljs-string">*</span> <span class="hljs-attr">UDP:</span> <span class="hljs-literal">true</span>
        <span class="hljs-string">*</span> <span class="hljs-attr">IPv4:</span> <span class="hljs-literal">yes</span><span class="hljs-string">,</span>  <span class="hljs-number">111.</span><span class="hljs-string">xxx.xxx.xx:61481</span> 
        <span class="hljs-string">*</span> <span class="hljs-attr">IPv6:</span> <span class="hljs-literal">no</span><span class="hljs-string">,</span> <span class="hljs-string">but</span> <span class="hljs-string">OS</span> <span class="hljs-string">has</span> <span class="hljs-string">support</span>
        <span class="hljs-string">*</span> <span class="hljs-attr">MappingVariesByDestIP:</span> <span class="hljs-literal">true</span>
        <span class="hljs-string">*</span> <span class="hljs-attr">PortMapping:</span>
        <span class="hljs-string">*</span> <span class="hljs-attr">CaptivePortal:</span> <span class="hljs-literal">false</span>
        <span class="hljs-string">*</span> <span class="hljs-attr">Nearest DERP:</span> <span class="hljs-string">Hong</span> <span class="hljs-string">Kong</span>
        <span class="hljs-string">*</span> <span class="hljs-attr">DERP latency:</span>
                <span class="hljs-bullet">-</span> <span class="hljs-attr">hkg:</span> <span class="hljs-number">110.</span><span class="hljs-string">3ms</span> <span class="hljs-string">(Hong</span> <span class="hljs-string">Kong)</span>
                <span class="hljs-bullet">-</span> <span class="hljs-attr">tok:</span> <span class="hljs-number">192.</span><span class="hljs-string">6ms</span> <span class="hljs-string">(Tokyo)</span>
                <span class="hljs-bullet">-</span> <span class="hljs-attr">sfo:</span> <span class="hljs-number">202.</span><span class="hljs-string">5ms</span> <span class="hljs-string">(San</span> <span class="hljs-string">Francisco)</span>
                <span class="hljs-bullet">-</span> <span class="hljs-attr">par:</span> <span class="hljs-number">210.</span><span class="hljs-string">1ms</span> <span class="hljs-string">(Paris)</span>
                <span class="hljs-string">...</span>
                <span class="hljs-bullet">-</span> <span class="hljs-attr">ams:</span> <span class="hljs-number">210.</span><span class="hljs-string">6ms</span> <span class="hljs-string">(Amsterdam)</span>
                <span class="hljs-bullet">-</span> <span class="hljs-attr">lhr:</span> <span class="hljs-number">214.</span><span class="hljs-string">3ms</span> <span class="hljs-string">(London)</span>
                <span class="hljs-bullet">-</span> <span class="hljs-attr">jnb:</span> <span class="hljs-number">424.</span><span class="hljs-string">9ms</span> <span class="hljs-string">(Johannesburg)</span>
</code></pre>
<h3 data-id="heading-6">é‡è¦è¡¥å……è¯´æ˜</h3>
<h4 data-id="heading-7">1. å¯ç”¨å­ç½‘è·¯ç”±</h4>
<p><strong>åŠŸèƒ½è¯´æ˜</strong></p>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼ŒTailscaleåªèƒ½è®¿é—®å®‰è£…äº†Tailscaleå®¢æˆ·ç«¯çš„è®¾å¤‡æœ¬èº«ï¼ˆå¦‚NASçš„100.xx.xx.xxï¼‰ï¼Œæ— æ³•è®¿é—®å±€åŸŸç½‘å†…çš„å…¶ä»–è®¾å¤‡ï¼ˆå¦‚192.168.5.10çš„æ‘„åƒå¤´ã€192.168.5.20çš„ç”µè„‘ç­‰ï¼‰</li>
<li><strong>è§£å†³</strong>ï¼šå¯ç”¨å­ç½‘è·¯ç”±åï¼ŒNASå°†æˆä¸ºä¸€ä¸ª"ç½‘å…³"ï¼Œå…è®¸é€šè¿‡Tailscaleç½‘ç»œè®¿é—®æ•´ä¸ª192.168.5.0/24ç½‘æ®µçš„æ‰€æœ‰è®¾å¤‡</li>
<li><strong>å®é™…æ•ˆæœ</strong>ï¼šåœ¨å…¬å¸ç”µè„‘ä¸Šå¯ä»¥ç›´æ¥è®¿é—® <code>192.168.5.10</code>ï¼ˆå®¶é‡Œçš„æ‘„åƒå¤´ï¼‰ã€<code>192.168.5.20</code>ï¼ˆå®¶é‡Œçš„ç”µè„‘ï¼‰ç­‰ï¼Œæ— éœ€ä¸ºæ¯å°è®¾å¤‡å•ç‹¬å®‰è£…Tailscale</li>
</ul>
<p><strong>æ“ä½œæ­¥éª¤ï¼š</strong>
å®¹å™¨å¯åŠ¨åï¼Œéœ€è¦åœ¨Tailscaleç®¡ç†æ§åˆ¶å°æ‰‹åŠ¨å¯ç”¨å­ç½‘è·¯ç”±ï¼š</p>
<ul>
<li>è®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Flogin.tailscale.com%2Fadmin%2Fmachines" target="_blank" title="https://login.tailscale.com/admin/machines" ref="nofollow noopener noreferrer">login.tailscale.com/admin/machiâ€¦</a></li>
<li>æ‰¾åˆ° <code>fnos-nas</code> è®¾å¤‡ï¼Œç‚¹å‡»å³ä¾§çš„ <code>...</code> èœå•</li>
<li>é€‰æ‹© <code>Edit route settings</code></li>
<li>å‹¾é€‰ <code>192.168.5.0/24</code> ç½‘æ®µ</li>
<li>ç‚¹å‡» <code>Save</code> ä¿å­˜</li>
</ul>
<h4 data-id="heading-8">2. é˜²ç«å¢™è®¾ç½®</h4>
<p><strong>åŠŸèƒ½è¯´æ˜</strong></p>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šTailscaleèŠ‚ç‚¹é—´é€šè¿‡UDPç«¯å£41641è¿›è¡ŒP2Pç›´è¿é€šä¿¡ã€‚å¦‚æœé˜²ç«å¢™é˜»æ­¢äº†è¿™ä¸ªç«¯å£ï¼ŒèŠ‚ç‚¹ä¹‹é—´åªèƒ½é€šè¿‡DERPä¸­ç»§æœåŠ¡å™¨é€šä¿¡ï¼Œå¯¼è‡´å»¶è¿Ÿé«˜ã€é€Ÿåº¦æ…¢</li>
<li><strong>è§£å†³</strong>ï¼šå¼€æ”¾UDP 41641ç«¯å£ï¼Œå…è®¸Tailscaleå»ºç«‹P2Pç›´è¿ï¼Œå®ç°ä½å»¶è¿Ÿã€é«˜é€Ÿåº¦çš„è¿æ¥</li>
<li><strong>å®é™…æ•ˆæœ</strong>ï¼šP2Pç›´è¿å»¶è¿Ÿé€šå¸¸&lt;50msï¼Œè€Œé€šè¿‡DERPä¸­ç»§å»¶è¿Ÿå¯èƒ½&gt;200ms</li>
</ul>
<p><strong>é…ç½®æ–¹æ³•ï¼š</strong>
ç¡®ä¿é£ç‰›OSçš„é˜²ç«å¢™å…è®¸Tailscaleé€šä¿¡ï¼š</p>
<ul>
<li>å¼€æ”¾UDPç«¯å£ 41641ï¼ˆTailscaleé»˜è®¤ç«¯å£ï¼‰</li>
<li>æˆ–ä¸´æ—¶å…³é—­é˜²ç«å¢™æµ‹è¯•ï¼ˆä¸æ¨èé•¿æœŸä½¿ç”¨ï¼‰</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Pythonæ•°æ®ç±»å¦‚ä½•ä¼˜é›…åœ°è½¬æ¢ä¸ºJSONçš„æ–¹æ³•]]></title>    <link>https://juejin.cn/post/7596339303862206515</link>    <guid>https://juejin.cn/post/7596339303862206515</guid>    <pubDate>2026-01-19T03:03:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596339303862206515" data-draft-id="7596343020214009882" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Pythonæ•°æ®ç±»å¦‚ä½•ä¼˜é›…åœ°è½¬æ¢ä¸ºJSONçš„æ–¹æ³•"/> <meta itemprop="keywords" content="æ•°æ®æŒ–æ˜"/> <meta itemprop="datePublished" content="2026-01-19T03:03:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="19970108018"/> <meta itemprop="url" content="https://juejin.cn/user/626056119194091"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Pythonæ•°æ®ç±»å¦‚ä½•ä¼˜é›…åœ°è½¬æ¢ä¸ºJSONçš„æ–¹æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/626056119194091/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    19970108018
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T03:03:40.000Z" title="Mon Jan 19 2026 03:03:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Python æ ‡å‡†åº“çš„<code>json</code>æ¨¡å—é»˜è®¤æ— æ³•ç›´æ¥åºåˆ—åŒ–è‡ªå®šä¹‰çš„<code>dataclass</code>å®ä¾‹ï¼ˆä¼šæŠ¥<code>Object of type XXX is not JSON serializable</code>ï¼‰ï¼Œæ ¸å¿ƒåŸå› æ˜¯<code>json</code>åªæ”¯æŒåŸºç¡€ç±»å‹ï¼ˆstr/int/list/dict ç­‰ï¼‰ã€‚ä¸‹é¢æˆ‘ä¼šä»<strong>åŸºç¡€åˆ°è¿›é˜¶</strong>ç»™å‡º 4 ç§ä¼˜é›…çš„è½¬æ¢æ–¹æ³•ï¼Œè¦†ç›–ç®€å•åœºæ™¯åˆ°ç”Ÿäº§çº§å¤æ‚åœºæ™¯ï¼Œä½ å¯æ ¹æ®éœ€æ±‚é€‰æ‹©ã€‚</p>
<hr/>
<h3 data-id="heading-0">å‰ç½®å‡†å¤‡ï¼šå®šä¹‰æµ‹è¯•æ•°æ®ç±»</h3>
<p>å…ˆå®šä¹‰ä¸€ä¸ªå…¸å‹çš„åµŒå¥—æ•°æ®ç±»ï¼Œä½œä¸ºåç»­è½¬æ¢çš„ç¤ºä¾‹ï¼š</p>
<p>python</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> dataclasses <span class="hljs-keyword">import</span> dataclass, asdict
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime  <span class="hljs-comment"># åŒ…å«éåŸºç¡€ç±»å‹ï¼Œæ¨¡æ‹ŸçœŸå®åœºæ™¯</span>

<span class="hljs-comment"># åµŒå¥—å­æ•°æ®ç±»</span>
<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Address</span>:
    province: <span class="hljs-built_in">str</span>
    city: <span class="hljs-built_in">str</span>
    detail: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span>  <span class="hljs-comment"># å¯é€‰å­—æ®µ</span>

<span class="hljs-comment"># ä¸»æ•°æ®ç±»</span>
<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>:
    <span class="hljs-built_in">id</span>: <span class="hljs-built_in">int</span>
    name: <span class="hljs-built_in">str</span>
    age: <span class="hljs-built_in">int</span>
    register_time: datetime  <span class="hljs-comment"># éJSONåŸç”Ÿç±»å‹</span>
    address: Address  <span class="hljs-comment"># åµŒå¥—æ•°æ®ç±»</span>
    tags: <span class="hljs-built_in">list</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span>  <span class="hljs-comment"># å¯é€‰åˆ—è¡¨å­—æ®µ</span>

<span class="hljs-comment"># åˆ›å»ºæµ‹è¯•å®ä¾‹</span>
test_user = User(
    <span class="hljs-built_in">id</span>=<span class="hljs-number">1001</span>,
    name=<span class="hljs-string">"å¼ ä¸‰"</span>,
    age=<span class="hljs-number">28</span>,
    register_time=datetime(<span class="hljs-number">2026</span>, <span class="hljs-number">1</span>, <span class="hljs-number">19</span>, <span class="hljs-number">10</span>, <span class="hljs-number">30</span>),
    address=Address(province=<span class="hljs-string">"æµ™æ±Ÿçœ"</span>, city=<span class="hljs-string">"æ­å·å¸‚"</span>, detail=<span class="hljs-string">"è¥¿æ¹–åŒºXXè·¯"</span>),
    tags=[<span class="hljs-string">"VIP"</span>, <span class="hljs-string">"æ–°ç”¨æˆ·"</span>]
)
</code></pre>
<hr/>
<h3 data-id="heading-1">æ–¹æ³• 1ï¼šåŸºç¡€ç‰ˆ - <code>dataclasses.asdict</code> æ‰‹åŠ¨è½¬æ¢ï¼ˆç®€å•åœºæ™¯ï¼‰</h3>
<p>è¿™æ˜¯æœ€åŸºç¡€çš„ä¼˜é›…æ–¹å¼ï¼Œåˆ©ç”¨<code>dataclasses</code>å†…ç½®çš„<code>asdict</code>æ–¹æ³•å°†æ•°æ®ç±»è½¬æˆå­—å…¸ï¼Œå†ç”¨<code>json.dumps</code>åºåˆ—åŒ–ã€‚</p>
<h4 data-id="heading-2">ä»£ç å®ç°ï¼š</h4>
<p>python</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ­¥éª¤1ï¼šå°†dataclassè½¬æˆæ™®é€šå­—å…¸</span>
<span class="hljs-attr">user_dict</span> = asdict(test_user)
<span class="hljs-comment"># æ­¥éª¤2ï¼šå¤„ç†éJSONåŸç”Ÿç±»å‹ï¼ˆå¦‚datetimeï¼‰</span>
user_dict<span class="hljs-section">["register_time"]</span> = user_dict<span class="hljs-section">["register_time"]</span>.isoformat()

<span class="hljs-comment"># æ­¥éª¤3ï¼šåºåˆ—åŒ–ä¸ºJSONå­—ç¬¦ä¸²</span>
<span class="hljs-attr">user_json</span> = json.dumps(user_dict, ensure_ascii=<span class="hljs-literal">False</span>, indent=<span class="hljs-number">2</span>)
print(user_json)
</code></pre>
<h4 data-id="heading-3">è¾“å‡ºç»“æœï¼š</h4>
<p>json</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1001</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å¼ ä¸‰"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"age"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">28</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"register_time"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2026-01-19T10:30:00"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"address"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æµ™æ±Ÿçœ"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ­å·å¸‚"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"detail"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"è¥¿æ¹–åŒºXXè·¯"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"tags"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"VIP"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"æ–°ç”¨æˆ·"</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-4">å…³é”®è§£é‡Šï¼š</h4>
<ul>
<li><code>asdict(test_user)</code>ï¼šæ ¸å¿ƒå‡½æ•°ï¼Œå°†æ•°æ®ç±»å®ä¾‹é€’å½’è½¬æ¢ä¸ºæ™®é€šå­—å…¸ï¼ˆåµŒå¥—çš„<code>Address</code>ä¹Ÿä¼šè¢«è½¬æˆå­—å…¸ï¼‰ï¼›</li>
<li><code>ensure_ascii=False</code>ï¼šä¿ç•™ä¸­æ–‡ç­‰é ASCII å­—ç¬¦ï¼Œé¿å…è½¬æˆ<code>\uXXXX</code>ç¼–ç ï¼›</li>
<li><code>indent=2</code>ï¼šæ ¼å¼åŒ–è¾“å‡ºï¼Œæå‡å¯è¯»æ€§ï¼›</li>
<li>éœ€æ‰‹åŠ¨å¤„ç†<code>datetime</code>ç­‰é JSON åŸç”Ÿç±»å‹ï¼ˆJSON ä»…æ”¯æŒå­—ç¬¦ä¸² / æ•°å­— / å¸ƒå°” / åˆ—è¡¨ / å­—å…¸ /nullï¼‰ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-5">æ–¹æ³• 2ï¼šè¿›é˜¶ç‰ˆ - è‡ªå®šä¹‰<code>JSONEncoder</code>ï¼ˆé€šç”¨å¯æ‰©å±•ï¼‰</h3>
<p>å¦‚æœæœ‰å¤šä¸ªæ•°æ®ç±»éœ€è¦è½¬æ¢ï¼Œæ‰‹åŠ¨å¤„ç†éåŸºç¡€ç±»å‹ä¼šå¾ˆç¹çï¼Œæ¨èè‡ªå®šä¹‰<code>JSONEncoder</code>ï¼Œå®ç°<strong>ç»Ÿä¸€çš„åºåˆ—åŒ–è§„åˆ™</strong>ã€‚</p>
<h4 data-id="heading-6">ä»£ç å®ç°ï¼š</h4>
<p>python</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DataclassJSONEncoder</span>(json.JSONEncoder):
    <span class="hljs-string">"""è‡ªå®šä¹‰JSONç¼–ç å™¨ï¼Œæ”¯æŒdataclasså’Œå¸¸è§éåŸºç¡€ç±»å‹"""</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">default</span>(<span class="hljs-params">self, obj</span>):
        <span class="hljs-comment"># ç¬¬ä¸€æ­¥ï¼šå¤„ç†dataclasså®ä¾‹</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(obj, <span class="hljs-string">"__dataclass_fields__"</span>):  <span class="hljs-comment"># åˆ¤æ–­æ˜¯å¦æ˜¯dataclass</span>
            <span class="hljs-keyword">return</span> asdict(obj)
        <span class="hljs-comment"># ç¬¬äºŒæ­¥ï¼šå¤„ç†datetimeç±»å‹</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(obj, datetime):
            <span class="hljs-keyword">return</span> obj.isoformat()
        <span class="hljs-comment"># ç¬¬ä¸‰æ­¥ï¼šå…¶ä»–ç±»å‹äº¤ç»™çˆ¶ç±»å¤„ç†ï¼ˆä¼šæŠ›å‡ºæ ‡å‡†å¼‚å¸¸ï¼‰</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>().default(obj)

<span class="hljs-comment"># ç›´æ¥ä½¿ç”¨è‡ªå®šä¹‰ç¼–ç å™¨åºåˆ—åŒ–</span>
user_json = json.dumps(
    test_user,
    cls=DataclassJSONEncoder,  <span class="hljs-comment"># æŒ‡å®šè‡ªå®šä¹‰ç¼–ç å™¨</span>
    ensure_ascii=<span class="hljs-literal">False</span>,
    indent=<span class="hljs-number">2</span>
)
<span class="hljs-built_in">print</span>(user_json)
</code></pre>
<h4 data-id="heading-7">å…³é”®è§£é‡Šï¼š</h4>
<ul>
<li>ç»§æ‰¿<code>json.JSONEncoder</code>å¹¶é‡å†™<code>default</code>æ–¹æ³•ï¼šè¿™æ˜¯<code>json</code>æ¨¡å—æ‰©å±•åºåˆ—åŒ–è§„åˆ™çš„æ ‡å‡†æ–¹å¼ï¼›</li>
<li><code>__dataclass_fields__</code>ï¼šdataclass å®ä¾‹çš„å†…ç½®å±æ€§ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦ä¸ºæ•°æ®ç±»ï¼›</li>
<li>å¯æ‰©å±•ï¼šå¦‚éœ€æ”¯æŒ<code>date</code>/<code>UUID</code>ç­‰ç±»å‹ï¼Œåªéœ€åœ¨<code>default</code>æ–¹æ³•ä¸­æ–°å¢<code>isinstance</code>åˆ¤æ–­å³å¯ï¼›</li>
<li>æ— éœ€æ‰‹åŠ¨è½¬å­—å…¸ï¼Œç›´æ¥åºåˆ—åŒ–æ•°æ®ç±»å®ä¾‹ï¼Œä»£ç æ›´ç®€æ´ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-8">æ–¹æ³• 3ï¼šä¼˜åŒ–ç‰ˆ - å°è£…æˆå·¥å…·å‡½æ•°ï¼ˆå¤ç”¨æ€§æ‹‰æ»¡ï¼‰</h3>
<p>å°†è½¬æ¢é€»è¾‘å°è£…æˆå·¥å…·å‡½æ•°ï¼Œä¸€é”®è°ƒç”¨ï¼Œé€‚åˆé¡¹ç›®ä¸­å¤šå¤„ä½¿ç”¨çš„åœºæ™¯ï¼š</p>
<p>python</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">dataclass_to_json</span>(<span class="hljs-params">obj, indent=<span class="hljs-number">2</span></span>):
    <span class="hljs-string">"""
    æ•°æ®ç±»è½¬JSONå­—ç¬¦ä¸²çš„å·¥å…·å‡½æ•°
    :param obj: æ•°æ®ç±»å®ä¾‹ï¼ˆæ”¯æŒåµŒå¥—ï¼‰
    :param indent: æ ¼å¼åŒ–ç¼©è¿›ï¼ŒNoneè¡¨ç¤ºç´§å‡‘è¾“å‡º
    :return: JSONå­—ç¬¦ä¸²
    """</span>
    <span class="hljs-keyword">return</span> json.dumps(
        obj,
        cls=DataclassJSONEncoder,
        ensure_ascii=<span class="hljs-literal">False</span>,
        indent=indent
    )

<span class="hljs-comment"># è°ƒç”¨ç¤ºä¾‹ï¼ˆä¸€è¡Œæå®šï¼‰</span>
user_json = dataclass_to_json(test_user)
<span class="hljs-built_in">print</span>(user_json)
</code></pre>
<hr/>
<h3 data-id="heading-9">æ–¹æ³• 4ï¼šé«˜çº§ç‰ˆ - ä½¿ç”¨<code>pydantic</code>ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰</h3>
<p>å¦‚æœä½ çš„åœºæ™¯éœ€è¦<strong>æ•°æ®éªŒè¯ + ä¼˜é›…åºåˆ—åŒ–</strong>ï¼Œæ¨èç›´æ¥ä½¿ç”¨<code>pydantic</code>ï¼ˆPython ç”Ÿæ€ä¸­æœ€ä¸»æµçš„æ•°æ®éªŒè¯åº“ï¼‰ï¼Œå®ƒçš„<code>BaseModel</code>æ¯”åŸç”Ÿ<code>dataclass</code>æ›´å¼ºå¤§ï¼Œä¸”åŸç”Ÿæ”¯æŒ JSON è½¬æ¢ã€‚</p>
<h4 data-id="heading-10">å‰ç½®ä¾èµ–ï¼š</h4>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs">pip install pydantic
</code></pre>
<h4 data-id="heading-11">ä»£ç å®ç°ï¼š</h4>
<p>python</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-ini" lang="ini">from pydantic import BaseModel
from datetime import datetime

<span class="hljs-comment"># æ›¿æ¢åŸç”Ÿdataclassä¸ºpydantic.BaseModel</span>
class Address(BaseModel):
    province: str
    city: str
    detail: <span class="hljs-attr">str</span> = <span class="hljs-string">""</span>

class User(BaseModel):
    id: int
    name: str
    age: int
    register_time: datetime
    address: Address
    tags: list<span class="hljs-section">[str]</span> = None

    <span class="hljs-comment"># å¯é€‰ï¼šè‡ªå®šä¹‰JSONåºåˆ—åŒ–é…ç½®ï¼ˆå¦‚datetimeæ ¼å¼ï¼‰</span>
    class Config:
        <span class="hljs-attr">json_encoders</span> = {
            datetime: lambda v: v.strftime("%Y-%m-%d %H:%M:%S")  <span class="hljs-comment"># è‡ªå®šä¹‰æ—¶é—´æ ¼å¼</span>
        }

<span class="hljs-comment"># åˆ›å»ºå®ä¾‹ï¼ˆpydanticä¼šè‡ªåŠ¨éªŒè¯å­—æ®µç±»å‹ï¼‰</span>
<span class="hljs-attr">test_user</span> = User(
    <span class="hljs-attr">id</span>=<span class="hljs-number">1001</span>,
    <span class="hljs-attr">name</span>=<span class="hljs-string">"å¼ ä¸‰"</span>,
    <span class="hljs-attr">age</span>=<span class="hljs-number">28</span>,
    <span class="hljs-attr">register_time</span>=datetime(<span class="hljs-number">2026</span>, <span class="hljs-number">1</span>, <span class="hljs-number">19</span>, <span class="hljs-number">10</span>, <span class="hljs-number">30</span>),
    <span class="hljs-attr">address</span>=Address(province=<span class="hljs-string">"æµ™æ±Ÿçœ"</span>, city=<span class="hljs-string">"æ­å·å¸‚"</span>, detail=<span class="hljs-string">"è¥¿æ¹–åŒºXXè·¯"</span>),
    <span class="hljs-attr">tags</span>=[<span class="hljs-string">"VIP"</span>, <span class="hljs-string">"æ–°ç”¨æˆ·"</span>]
)

<span class="hljs-comment"># åŸç”Ÿæ”¯æŒJSONè½¬æ¢ï¼ˆä¸€è¡Œæå®šï¼‰</span>
<span class="hljs-attr">user_json</span> = test_user.json(ensure_ascii=<span class="hljs-literal">False</span>, indent=<span class="hljs-number">2</span>)
print(user_json)
</code></pre>
<h4 data-id="heading-12">è¾“å‡ºç»“æœï¼ˆæ—¶é—´æ ¼å¼è‡ªå®šä¹‰åï¼‰ï¼š</h4>
<p>json</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1001</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å¼ ä¸‰"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"age"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">28</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"register_time"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2026-01-19 10:30:00"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"address"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"province"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æµ™æ±Ÿçœ"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"city"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ­å·å¸‚"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"detail"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"è¥¿æ¹–åŒºXXè·¯"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"tags"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"VIP"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"æ–°ç”¨æˆ·"</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-13">å…³é”®ä¼˜åŠ¿ï¼š</h4>
<ul>
<li>åŸç”Ÿæ”¯æŒ<code>json()</code>æ–¹æ³•ï¼šæ— éœ€æ‰‹åŠ¨å†™ç¼–ç å™¨ï¼Œå¼€ç®±å³ç”¨ï¼›</li>
<li>è‡ªåŠ¨æ•°æ®éªŒè¯ï¼šåˆ›å»ºå®ä¾‹æ—¶ä¼šæ ¡éªŒå­—æ®µç±»å‹ï¼ˆå¦‚<code>age</code>ä¼ å­—ç¬¦ä¸²ä¼šç›´æ¥æŠ¥é”™ï¼‰ï¼›</li>
<li>çµæ´»é…ç½®ï¼šé€šè¿‡<code>Config.json_encoders</code>è‡ªå®šä¹‰éåŸºç¡€ç±»å‹çš„åºåˆ—åŒ–è§„åˆ™ï¼›</li>
<li>æ”¯æŒåµŒå¥—ã€å¯é€‰å­—æ®µã€é»˜è®¤å€¼ç­‰ï¼Œå®Œå…¨å…¼å®¹åŸç”Ÿ dataclass çš„ç”¨æ³•ï¼Œä¸”åŠŸèƒ½æ›´å¼ºã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-14">æ€»ç»“</h3>
<ol>
<li><strong>ç®€å•åœºæ™¯</strong>ï¼šç”¨<code>dataclasses.asdict</code> + <code>json.dumps</code>ï¼Œæ‰‹åŠ¨å¤„ç†éåŸºç¡€ç±»å‹ï¼Œå¿«é€Ÿå®ç°ï¼›</li>
<li><strong>é€šç”¨åœºæ™¯</strong>ï¼šè‡ªå®šä¹‰<code>JSONEncoder</code>ï¼Œç»Ÿä¸€ç®¡ç†åºåˆ—åŒ–è§„åˆ™ï¼Œé€‚åˆå¤šä¸ªæ•°æ®ç±»çš„é¡¹ç›®ï¼›</li>
<li><strong>ç”Ÿäº§ç¯å¢ƒ</strong>ï¼šä¼˜å…ˆä½¿ç”¨<code>pydantic.BaseModel</code>ï¼Œå…¼é¡¾æ•°æ®éªŒè¯å’Œä¼˜é›…åºåˆ—åŒ–ï¼Œå‡å°‘å†—ä½™ä»£ç ï¼›</li>
<li>æ ¸å¿ƒåŸåˆ™ï¼šé¿å…æ‰‹åŠ¨æ‹¼æ¥å­—å…¸ï¼Œåˆ©ç”¨å†…ç½®å·¥å…· / æˆç†Ÿåº“å®ç°è½¬æ¢ï¼Œä¿è¯ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•åœ¨Pythonä¸­å®ç°å°†JSONæ•°æ®ä¼˜é›…åœ°è½¬æ¢ä¸ºæ•°æ®ç±»ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7596181746084003890</link>    <guid>https://juejin.cn/post/7596181746084003890</guid>    <pubDate>2026-01-19T03:14:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596181746084003890" data-draft-id="7596181746083987506" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•åœ¨Pythonä¸­å®ç°å°†JSONæ•°æ®ä¼˜é›…åœ°è½¬æ¢ä¸ºæ•°æ®ç±»ï¼Ÿ"/> <meta itemprop="keywords" content="æ•°æ®æŒ–æ˜"/> <meta itemprop="datePublished" content="2026-01-19T03:14:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="19970108018"/> <meta itemprop="url" content="https://juejin.cn/user/626056119194091"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•åœ¨Pythonä¸­å®ç°å°†JSONæ•°æ®ä¼˜é›…åœ°è½¬æ¢ä¸ºæ•°æ®ç±»ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/626056119194091/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    19970108018
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T03:14:35.000Z" title="Mon Jan 19 2026 03:14:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>JSON è½¬æ•°æ®ç±»çš„æ ¸å¿ƒéš¾ç‚¹åœ¨äºï¼šJSON åªæœ‰åŸºç¡€ç±»å‹ï¼ˆå­—ç¬¦ä¸² / æ•°å­— / åˆ—è¡¨ / å­—å…¸ï¼‰ï¼Œè€Œæ•°æ®ç±»åŒ…å«è‡ªå®šä¹‰ç»“æ„ã€åµŒå¥—ç±»ã€é JSON åŸç”Ÿç±»å‹ï¼ˆå¦‚<code>datetime</code>ï¼‰ï¼Œéœ€è¦<strong>è‡ªåŠ¨æ˜ å°„å­—æ®µ</strong> + <strong>ç±»å‹è½¬æ¢</strong>ã€‚ä¸‹é¢ä»ã€ŒåŸºç¡€æ‰‹åŠ¨è½¬æ¢ã€åˆ°ã€Œç”Ÿäº§çº§è‡ªåŠ¨è½¬æ¢ã€ç»™å‡º 3 ç§ä¼˜é›…æ–¹æ¡ˆï¼Œè¦†ç›–ä¸åŒåœºæ™¯éœ€æ±‚ã€‚</p>
<hr/>
<h3 data-id="heading-0">å‰ç½®å‡†å¤‡ï¼šå®šä¹‰æµ‹è¯•æ•°æ®ç±» + æµ‹è¯• JSON</h3>
<p>å…ˆå¤ç”¨ä¹‹å‰çš„åµŒå¥—æ•°æ®ç±»ï¼Œå¹¶å‡†å¤‡å¯¹åº”çš„ JSON å­—ç¬¦ä¸²ï¼ˆæ¨¡æ‹ŸçœŸå®åœºæ™¯ï¼ŒåŒ…å«åµŒå¥—ã€æ—¶é—´å­—ç¬¦ä¸²ç­‰ï¼‰ï¼š</p>
<p>python</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> dataclasses <span class="hljs-keyword">import</span> dataclass, fields
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Optional</span>, <span class="hljs-type">Any</span>

<span class="hljs-comment"># åµŒå¥—å­æ•°æ®ç±»</span>
<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Address</span>:
    province: <span class="hljs-built_in">str</span>
    city: <span class="hljs-built_in">str</span>
    detail: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span>  <span class="hljs-comment"># å¯é€‰å­—æ®µ</span>

<span class="hljs-comment"># ä¸»æ•°æ®ç±»</span>
<span class="hljs-meta">@dataclass</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>:
    <span class="hljs-built_in">id</span>: <span class="hljs-built_in">int</span>
    name: <span class="hljs-built_in">str</span>
    age: <span class="hljs-built_in">int</span>
    register_time: datetime  <span class="hljs-comment"># éJSONåŸç”Ÿç±»å‹ï¼ˆJSONä¸­æ˜¯å­—ç¬¦ä¸²ï¼‰</span>
    address: Address  <span class="hljs-comment"># åµŒå¥—æ•°æ®ç±»</span>
    tags: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">list</span>[<span class="hljs-built_in">str</span>]] = <span class="hljs-literal">None</span>  <span class="hljs-comment"># å¯é€‰åˆ—è¡¨å­—æ®µ</span>

<span class="hljs-comment"># æµ‹è¯•JSONå­—ç¬¦ä¸²ï¼ˆæ¨¡æ‹Ÿæ¥å£è¿”å›/æ–‡ä»¶è¯»å–çš„JSONï¼‰</span>
test_json_str = <span class="hljs-string">"""
{
  "id": 1001,
  "name": "å¼ ä¸‰",
  "age": 28,
  "register_time": "2026-01-19T10:30:00",
  "address": {
    "province": "æµ™æ±Ÿçœ",
    "city": "æ­å·å¸‚",
    "detail": "è¥¿æ¹–åŒºXXè·¯"
  },
  "tags": ["VIP", "æ–°ç”¨æˆ·"]
}
"""</span>

<span class="hljs-comment"># å…ˆå°†JSONå­—ç¬¦ä¸²è½¬æˆPythonå­—å…¸ï¼ˆæ‰€æœ‰æ–¹æ¡ˆçš„å‰ç½®æ­¥éª¤ï¼‰</span>
test_json_dict = json.loads(test_json_str)
</code></pre>
<hr/>
<h3 data-id="heading-1">æ–¹æ³• 1ï¼šåŸºç¡€ç‰ˆ - æ‰‹åŠ¨æ˜ å°„ï¼ˆç®€å•åœºæ™¯ï¼Œç†è§£åº•å±‚é€»è¾‘ï¼‰</h3>
<p>æ ¸å¿ƒæ€è·¯ï¼šå…ˆå°† JSON è½¬å­—å…¸ï¼Œå†é€šè¿‡ã€Œå…³é”®å­—å‚æ•°ã€ç›´æ¥å®ä¾‹åŒ–æ•°æ®ç±»ï¼Œæ‰‹åŠ¨å¤„ç†åµŒå¥—ç±»å’ŒéåŸºç¡€ç±»å‹ã€‚</p>
<h4 data-id="heading-2">ä»£ç å®ç°ï¼š</h4>
<p>python</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ­¥éª¤1ï¼šå¤„ç†åµŒå¥—æ•°æ®ç±»ï¼ˆAddressï¼‰</span>
<span class="hljs-attr">address_dict</span> = test_json_dict.pop(<span class="hljs-string">"address"</span>)  <span class="hljs-comment"># æå–åµŒå¥—å­—å…¸</span>
<span class="hljs-attr">address</span> = Address(**address_dict)  <span class="hljs-comment"># å­—å…¸è½¬åµŒå¥—æ•°æ®ç±»</span>

<span class="hljs-comment"># æ­¥éª¤2ï¼šå¤„ç†éåŸºç¡€ç±»å‹ï¼ˆdatetimeå­—ç¬¦ä¸²è½¬datetimeå¯¹è±¡ï¼‰</span>
<span class="hljs-attr">register_time_str</span> = test_json_dict.pop(<span class="hljs-string">"register_time"</span>)
<span class="hljs-attr">register_time</span> = datetime.fromisoformat(register_time_str)

<span class="hljs-comment"># æ­¥éª¤3ï¼šå®ä¾‹åŒ–ä¸»æ•°æ®ç±»ï¼ˆå‰©ä½™å­—æ®µç›´æ¥ä¼ å‚ï¼‰</span>
<span class="hljs-attr">user</span> = User(
    **test_json_dict,  <span class="hljs-comment"># å±•å¼€å‰©ä½™åŸºç¡€å­—æ®µï¼ˆid/name/age/tagsï¼‰</span>
    <span class="hljs-attr">address</span>=address,
    <span class="hljs-attr">register_time</span>=register_time
)

<span class="hljs-comment"># éªŒè¯ç»“æœ</span>
print(user)
<span class="hljs-comment"># è¾“å‡ºï¼šUser(id=1001, name='å¼ ä¸‰', age=28, register_time=datetime.datetime(2026, 1, 19, 10, 30), address=Address(province='æµ™æ±Ÿçœ', city='æ­å·å¸‚', detail='è¥¿æ¹–åŒºXXè·¯'), tags=['VIP', 'æ–°ç”¨æˆ·'])</span>
</code></pre>
<h4 data-id="heading-3">å…³é”®è§£é‡Šï¼š</h4>
<ul>
<li><code>**address_dict</code>ï¼šåˆ©ç”¨å­—å…¸è§£åŒ…ï¼Œå°†åµŒå¥—å­—å…¸ç›´æ¥ä¼ ç»™<code>Address</code>çš„æ„é€ å‡½æ•°ï¼›</li>
<li>æ‰‹åŠ¨å¤„ç†éåŸºç¡€ç±»å‹ï¼šJSON ä¸­çš„æ—¶é—´å­—ç¬¦ä¸²éœ€è¦è½¬æˆ<code>datetime</code>å¯¹è±¡ï¼Œè¿™æ˜¯ JSON è½¬æ•°æ®ç±»çš„æ ¸å¿ƒç—›ç‚¹ï¼›</li>
<li>ä¼˜ç‚¹ï¼šé€»è¾‘ç®€å•ã€æ˜“ç†è§£ï¼›ç¼ºç‚¹ï¼šåµŒå¥—å±‚çº§ / éåŸºç¡€ç±»å‹è¶Šå¤šï¼Œä»£ç è¶Šç¹çï¼Œå¤ç”¨æ€§å·®ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-4">æ–¹æ³• 2ï¼šè¿›é˜¶ç‰ˆ - è‡ªå®šä¹‰é€šç”¨è½¬æ¢å‡½æ•°ï¼ˆå¯æ‰©å±•ï¼Œé€‚é…å¤šæ•°æ®ç±»ï¼‰</h3>
<p>å°è£…ä¸€ä¸ªé€šç”¨å‡½æ•°ï¼Œ<strong>é€’å½’å¤„ç†åµŒå¥—æ•°æ®ç±»</strong> + <strong>è‡ªåŠ¨è½¬æ¢å¸¸è§éåŸºç¡€ç±»å‹</strong>ï¼Œé¿å…é‡å¤å†™æ‰‹åŠ¨æ˜ å°„ä»£ç ã€‚</p>
<h4 data-id="heading-5">ä»£ç å®ç°ï¼š</h4>
<p>python</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">json_dict_to_dataclass</span>(<span class="hljs-params">data: <span class="hljs-built_in">dict</span>, cls</span>) -&gt; <span class="hljs-type">Any</span>:
    <span class="hljs-string">"""
    é€šç”¨JSONå­—å…¸è½¬æ•°æ®ç±»å‡½æ•°ï¼ˆæ”¯æŒåµŒå¥—ã€datetimeè½¬æ¢ï¼‰
    :param data: JSONè§£æåçš„å­—å…¸
    :param cls: ç›®æ ‡æ•°æ®ç±»ï¼ˆå¦‚User/Addressï¼‰
    :return: æ•°æ®ç±»å®ä¾‹
    """</span>
    <span class="hljs-comment"># 1. éå†æ•°æ®ç±»çš„æ‰€æœ‰å­—æ®µ</span>
    field_map = {f.name: f <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> fields(cls)}
    init_kwargs = {}
    
    <span class="hljs-keyword">for</span> field_name, field_type <span class="hljs-keyword">in</span> field_map.items():
        <span class="hljs-comment"># è·³è¿‡ä¸å­˜åœ¨çš„å­—æ®µï¼ˆå¯é€‰å­—æ®µï¼‰</span>
        <span class="hljs-keyword">if</span> field_name <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> data:
            <span class="hljs-keyword">continue</span>
        
        value = data[field_name]
        target_type = field_type.<span class="hljs-built_in">type</span>
        
        <span class="hljs-comment"># 2. å¤„ç†åµŒå¥—æ•°æ®ç±»ï¼ˆåˆ¤æ–­æ˜¯å¦æ˜¯dataclassï¼‰</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(target_type, <span class="hljs-string">"__dataclass_fields__"</span>):
            init_kwargs[field_name] = json_dict_to_dataclass(value, target_type)
        <span class="hljs-comment"># 3. å¤„ç†datetimeç±»å‹ï¼ˆå­—ç¬¦ä¸²è½¬datetimeï¼‰</span>
        <span class="hljs-keyword">elif</span> target_type <span class="hljs-keyword">is</span> datetime:
            init_kwargs[field_name] = datetime.fromisoformat(value)
        <span class="hljs-comment"># 4. åŸºç¡€ç±»å‹ç›´æ¥èµ‹å€¼</span>
        <span class="hljs-keyword">else</span>:
            init_kwargs[field_name] = value
    
    <span class="hljs-comment"># 5. å®ä¾‹åŒ–æ•°æ®ç±»</span>
    <span class="hljs-keyword">return</span> cls(**init_kwargs)

<span class="hljs-comment"># è°ƒç”¨ç¤ºä¾‹ï¼ˆä¸€è¡Œæå®šï¼Œæ”¯æŒåµŒå¥—ï¼‰</span>
user = json_dict_to_dataclass(test_json_dict, User)

<span class="hljs-comment"># éªŒè¯ç»“æœ</span>
<span class="hljs-built_in">print</span>(user)
<span class="hljs-built_in">print</span>(user.address.city)  <span class="hljs-comment"># è®¿é—®åµŒå¥—å­—æ®µï¼šæ­å·å¸‚</span>
<span class="hljs-built_in">print</span>(user.register_time.year)  <span class="hljs-comment"># è®¿é—®datetimeå­—æ®µï¼š2026</span>
</code></pre>
<h4 data-id="heading-6">å…³é”®è§£é‡Šï¼š</h4>
<ul>
<li><code>fields(cls)</code>ï¼šè·å–æ•°æ®ç±»çš„æ‰€æœ‰å­—æ®µä¿¡æ¯ï¼ˆåç§°ã€ç±»å‹ï¼‰ï¼Œå®ç°åŠ¨æ€æ˜ å°„ï¼›</li>
<li>é€’å½’å¤„ç†åµŒå¥—ï¼šå¦‚æœå­—æ®µç±»å‹æ˜¯æ•°æ®ç±»ï¼ˆé€šè¿‡<code>__dataclass_fields__</code>åˆ¤æ–­ï¼‰ï¼Œé€’å½’è°ƒç”¨å‡½æ•°è½¬æ¢ï¼›</li>
<li>å¯æ‰©å±•ï¼šå¦‚éœ€æ”¯æŒ<code>date</code>/<code>UUID</code>ç­‰ç±»å‹ï¼Œåªéœ€åœ¨å‡½æ•°ä¸­æ–°å¢<code>elif</code>åˆ¤æ–­å³å¯ï¼›</li>
<li>ä¼˜ç‚¹ï¼šé€šç”¨ã€å¯å¤ç”¨ï¼Œé€‚é…ä»»æ„åµŒå¥—ç»“æ„çš„æ•° - æ®ç±»ï¼›ç¼ºç‚¹ï¼šéœ€è¦è‡ªå·±ç»´æŠ¤ç±»å‹è½¬æ¢é€»è¾‘ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-7">æ–¹æ³• 3ï¼šé«˜çº§ç‰ˆ - ä½¿ç”¨<code>pydantic</code>ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼Œæœ€ä¼˜é›…ï¼‰</h3>
<p><code>pydantic</code>æ˜¯ Python ç”Ÿæ€ä¸­å¤„ç†æ•°æ®éªŒè¯ / è½¬æ¢çš„ä¸»æµåº“ï¼Œ<strong>åŸç”Ÿæ”¯æŒ JSON è½¬æ¨¡å‹</strong>ï¼Œè‡ªåŠ¨å¤„ç†ç±»å‹è½¬æ¢ã€åµŒå¥—ã€å¯é€‰å­—æ®µï¼Œæ— éœ€æ‰‹åŠ¨å†™è½¬æ¢é€»è¾‘ï¼Œæ˜¯ç”Ÿäº§ç¯å¢ƒçš„æœ€ä¼˜é€‰æ‹©ã€‚</p>
<h4 data-id="heading-8">å‰ç½®ä¾èµ–ï¼š</h4>
<p>bash</p>
<pre><code class="hljs">pip install pydantic
</code></pre>
<h4 data-id="heading-9">ä»£ç å®ç°ï¼š</h4>
<p>python</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Optional</span>, <span class="hljs-type">List</span>

<span class="hljs-comment"># æ›¿æ¢åŸç”Ÿdataclassä¸ºpydantic.BaseModelï¼ˆè¯­æ³•å‡ ä¹ä¸€è‡´ï¼ŒåŠŸèƒ½æ›´å¼ºï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Address</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    province: <span class="hljs-built_in">str</span>
    city: <span class="hljs-built_in">str</span>
    detail: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    <span class="hljs-built_in">id</span>: <span class="hljs-built_in">int</span>
    name: <span class="hljs-built_in">str</span>
    age: <span class="hljs-built_in">int</span>
    register_time: datetime  <span class="hljs-comment"># è‡ªåŠ¨å°†ISOæ ¼å¼å­—ç¬¦ä¸²è½¬datetime</span>
    address: Address  <span class="hljs-comment"># è‡ªåŠ¨è½¬æ¢åµŒå¥—æ¨¡å‹</span>
    tags: <span class="hljs-type">Optional</span>[<span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]] = <span class="hljs-literal">None</span>

    <span class="hljs-comment"># å¯é€‰ï¼šè‡ªå®šä¹‰ç±»å‹è½¬æ¢è§„åˆ™ï¼ˆå¦‚éISOæ ¼å¼çš„æ—¶é—´å­—ç¬¦ä¸²ï¼‰</span>
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Config</span>:
        json_encoders = {
            datetime: <span class="hljs-keyword">lambda</span> v: v.isoformat()  <span class="hljs-comment"># åºåˆ—åŒ–æ—¶ç”¨ï¼Œååºåˆ—åŒ–è‡ªåŠ¨è¯†åˆ«</span>
        }

<span class="hljs-comment"># æ–¹æ³•1ï¼šJSONå­—ç¬¦ä¸²ç›´æ¥è½¬æ¨¡å‹ï¼ˆæœ€ä¼˜é›…ï¼‰</span>
user = User.parse_raw(test_json_str)

<span class="hljs-comment"># æ–¹æ³•2ï¼šJSONå­—å…¸è½¬æ¨¡å‹ï¼ˆå…¼å®¹å·²æœ‰å­—å…¸ï¼‰</span>
<span class="hljs-comment"># user = User(**test_json_dict)</span>

<span class="hljs-comment"># éªŒè¯ç»“æœ</span>
<span class="hljs-built_in">print</span>(user)
<span class="hljs-comment"># è¾“å‡ºï¼šid=1001 name='å¼ ä¸‰' age=28 register_time=datetime.datetime(2026, 1, 19, 10, 30) address=Address(province='æµ™æ±Ÿçœ', city='æ­å·å¸‚', detail='è¥¿æ¹–åŒºXXè·¯') tags=['VIP', 'æ–°ç”¨æˆ·']</span>

<span class="hljs-comment"># ä¾¿æ·æ“ä½œï¼šæ¨¡å‹è½¬å­—å…¸/JSONï¼ˆåå‘æ“ä½œä¹Ÿæ”¯æŒï¼‰</span>
<span class="hljs-built_in">print</span>(user.<span class="hljs-built_in">dict</span>())  <span class="hljs-comment"># è½¬å­—å…¸</span>
<span class="hljs-built_in">print</span>(user.json(ensure_ascii=<span class="hljs-literal">False</span>, indent=<span class="hljs-number">2</span>))  <span class="hljs-comment"># è½¬æ ¼å¼åŒ–JSONå­—ç¬¦ä¸²</span>
</code></pre>
<h4 data-id="heading-10">æ ¸å¿ƒä¼˜åŠ¿ï¼š</h4>
<ol>
<li><strong>é›¶æ‰‹åŠ¨è½¬æ¢</strong>ï¼š<code>parse_raw()</code>ç›´æ¥è§£æ JSON å­—ç¬¦ä¸²ä¸ºæ¨¡å‹ï¼Œè‡ªåŠ¨å¤„ç†åµŒå¥—ã€<code>datetime</code>ç­‰ç±»å‹ï¼›</li>
<li><strong>è‡ªåŠ¨æ•°æ®éªŒè¯</strong>ï¼šå¦‚æœ JSON æ•°æ®ç±»å‹é”™è¯¯ï¼ˆå¦‚<code>age</code>ä¼ å­—ç¬¦ä¸²ï¼‰ï¼Œä¼šç›´æ¥æŠ›å‡ºæ¸…æ™°çš„å¼‚å¸¸ï¼Œé¿å…è„æ•°æ®ï¼›</li>
<li><strong>çµæ´»æ‰©å±•</strong>ï¼šæ”¯æŒè‡ªå®šä¹‰ç±»å‹è½¬æ¢å™¨ã€å¯é€‰å­—æ®µã€é»˜è®¤å€¼ã€æ•°æ®æ ¡éªŒè§„åˆ™ï¼ˆå¦‚<code>age &gt;= 0</code>ï¼‰ï¼›</li>
<li><strong>ç”Ÿæ€å®Œå–„</strong>ï¼šå…¼å®¹ FastAPIã€Django ç­‰æ¡†æ¶ï¼Œæ˜¯ç”Ÿäº§ç¯å¢ƒå¤„ç†æ•°æ®çš„æ ‡å‡†æ–¹æ¡ˆã€‚</li>
</ol>
<h4 data-id="heading-11">å¼‚å¸¸ç¤ºä¾‹ï¼ˆæ•°æ®éªŒè¯ï¼‰ï¼š</h4>
<p>å¦‚æœ JSON ä¸­<code>age</code>æ˜¯å­—ç¬¦ä¸²<code>"28"</code>ï¼Œ<code>pydantic</code>ä¼šæŠ›å‡ºæ˜ç¡®é”™è¯¯ï¼š</p>
<p>plaintext</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-symbol">ValidationError:</span> <span class="hljs-number">1</span> validation <span class="hljs-keyword">error</span> <span class="hljs-keyword">for</span> User
age
  Input should be a valid <span class="hljs-type">integer</span>, got a <span class="hljs-type">string</span> [type=int_type, input_value=<span class="hljs-comment">'28', input_type=str]</span>
</code></pre>
<hr/>
<h3 data-id="heading-12">æ€»ç»“</h3>
<ol>
<li><strong>ç®€å•åœºæ™¯ï¼ˆå°‘é‡å­—æ®µ / æ— åµŒå¥—ï¼‰</strong> ï¼šç”¨åŸç”Ÿ<code>dataclass</code> + æ‰‹åŠ¨æ˜ å°„ï¼Œå¿«é€Ÿå®ç°ï¼Œæ— éœ€ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼›</li>
<li><strong>é€šç”¨åœºæ™¯ï¼ˆå¤šæ•°æ®ç±» / åµŒå¥—ï¼‰</strong> ï¼šå°è£…è‡ªå®šä¹‰è½¬æ¢å‡½æ•°ï¼Œé€’å½’å¤„ç†åµŒå¥—å’Œç±»å‹è½¬æ¢ï¼Œæå‡å¤ç”¨æ€§ï¼›</li>
<li><strong>ç”Ÿäº§ç¯å¢ƒï¼ˆæ•°æ®éªŒè¯ + ä¼˜é›…è½¬æ¢ï¼‰</strong> ï¼šä¼˜å…ˆä½¿ç”¨<code>pydantic.BaseModel</code>ï¼Œé›¶å†—ä½™ä»£ç ï¼Œè‡ªå¸¦éªŒè¯å’Œè‡ªåŠ¨è½¬æ¢ï¼Œæ˜¯æœ€ä¼˜é›…çš„æ–¹æ¡ˆï¼›</li>
<li>æ ¸å¿ƒåŸåˆ™ï¼šé¿å…æ‰‹åŠ¨é€ä¸ªå­—æ®µèµ‹å€¼ï¼Œåˆ©ç”¨ã€Œåå°„ / å†…ç½®å·¥å…· / æˆç†Ÿåº“ã€å®ç°è‡ªåŠ¨æ˜ å°„ï¼Œä¿è¯ä»£ç ç®€æ´ä¸”å¯ç»´æŠ¤ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>