<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[ã€Œchrome extensionsğŸ› ï¸ã€æˆ‘å†™äº†ä¸€ä¸ªè¶…çº§ç®€å•çš„æµè§ˆå™¨æ’ä»¶Vueå¼€å‘æ¨¡æ¿]]></title>    <link>https://juejin.cn/post/7585406229167865906</link>    <guid>https://juejin.cn/post/7585406229167865906</guid>    <pubDate>2025-12-19T13:28:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585406229167865906" data-draft-id="7581314241410613283" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Œchrome extensionsğŸ› ï¸ã€æˆ‘å†™äº†ä¸€ä¸ªè¶…çº§ç®€å•çš„æµè§ˆå™¨æ’ä»¶Vueå¼€å‘æ¨¡æ¿"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,GitHub"/> <meta itemprop="datePublished" content="2025-12-19T13:28:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JustHappy"/> <meta itemprop="url" content="https://juejin.cn/user/1489178757445003"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Œchrome extensionsğŸ› ï¸ã€æˆ‘å†™äº†ä¸€ä¸ªè¶…çº§ç®€å•çš„æµè§ˆå™¨æ’ä»¶Vueå¼€å‘æ¨¡æ¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1489178757445003/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JustHappy
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T13:28:48.000Z" title="Fri Dec 19 2025 13:28:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"ã€Œ"}.markdown-body b:after,.markdown-body strong:after{content:"ã€"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="github-gist">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#333}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#d73a49}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-symbol{color:#0086b3}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#6f42c1}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.hljs-number{color:#005cc5}.hljs-string{color:#032f62}</style><blockquote>
<p>Hi!è¿™é‡Œæ˜¯JustHappyğŸš€ğŸš€ï¼Œä¸€æ—¶å…´èµ·æƒ³å¼€å‘ä¸€ä¸ªæµè§ˆå™¨æ’ä»¶ï¼Œä½†æ˜¯æ‰¾æ¥æ‰¾å»å‘ç°åœ¨Vueç”Ÿæ€ä¸‹å¥½åƒæ²¡æœ‰ä¸€ä¸ªè¶…è½»çš„ç®€å•çš„æ¨¡æ¿æˆ–è€…è„šæ‰‹æ¶ï¼Œçœ‹äº†ä¸€åœˆæ„Ÿè§‰antFuå¤§ä½¬çš„vitesse-webextè¿˜ä¸é”™ï¼Œä½†æ˜¯æ„Ÿè§‰è¿˜ä¸å¤Ÿè½»ï¼Œäºæ˜¯æˆ‘æ‰“ç®—æ‰‹æ’¸ä»¿å†™ä¸€ä¸ªç®€å•ç‰ˆæœ¬</p>
</blockquote>
<h2 data-id="heading-0">æˆ‘æƒ³è¦ä¸€ä¸ªä»€ä¹ˆæ ·çš„æ¨¡æ¿</h2>
<ul>
<li>æŠ€æœ¯æ ˆè½»ç›ˆï¼šVue + JS è¶Šç®€å•è¶Šå¥½</li>
<li>æ”¯æŒâ€œçƒ­æ›´æ–°â€ï¼šä¿®æ”¹åç«‹é©¬æ›´æ–°è§†å›¾</li>
</ul>
<h2 data-id="heading-1">äºæ˜¯æœ‰äº†è¿™ä¸ªæ¨¡æ¿...</h2>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a7a6459e0984f779075c7f414090ae6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVzdEhhcHB5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766755750&amp;x-signature=gTpC5udEJhV8rJhW%2Fq0721XZiUM%3D" alt="image.png" width="70%" loading="lazy"/></p>
<p>ä»“åº“åœ°å€æ˜¯è¿™ä¸ªï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSimonmie%2Fvue-chrome-extension-template" target="_blank" title="https://github.com/Simonmie/vue-chrome-extension-template" ref="nofollow noopener noreferrer">github.com/Simonmie/vuâ€¦</a></p>
<h2 data-id="heading-2">å¦‚ä½•ä½¿ç”¨ï¼Ÿå¾ˆç®€å•</h2>
<p>ä½ åªéœ€è¦åœ¨ä»“åº“ä¸­ç‚¹å‡» use this template å°±å¯ä»¥ä½¿ç”¨è¯¥æ¨¡æ¿å»æ„å»ºæ’ä»¶</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91cb295e398341e3985db84969e54073~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVzdEhhcHB5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766755750&amp;x-signature=CXq5lwvpaNqy5zB9X%2FTtVALqaok%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-3">å¼€å§‹å¼€å‘å§ï¼</h2>
<h3 data-id="heading-4">å®‰è£…ä¾èµ–</h3>
<pre><code class="hljs language-npm" lang="npm">npm install
</code></pre>
<h3 data-id="heading-5">æ¨¡æ¿ç»“æ„</h3>
<pre><code class="hljs language-bash" lang="bash">â”œâ”€â”€ assets
â”œâ”€â”€ background
â”‚   â”œâ”€â”€ dev-hmr.js  // å¼€å‘ç¯å¢ƒä¸‹çš„çƒ­æ›´æ–°è„šæœ¬
â”‚   â””â”€â”€ main.js  // èƒŒæ™¯è„šæœ¬
â”œâ”€â”€ logic
â”‚   â””â”€â”€ common-setup.js  // å…¬å…±è®¾ç½®è„šæœ¬
â”œâ”€â”€ manifest.js // manifest.json ç”Ÿæˆè„šæœ¬
â”œâ”€â”€ options // é€‰é¡¹é¡µ
â”‚   â”œâ”€â”€ OptionsPage.vue 
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ main.js
â”œâ”€â”€ popup // å¼¹çª—
â”‚   â”œâ”€â”€ PopupComponent.vue
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ main.js
â”œâ”€â”€ sidepanel // ä¾§è¾¹æ 
â”‚   â”œâ”€â”€ SidePanel.vue
â”‚   â”œâ”€â”€ assets
â”‚   â”‚   â””â”€â”€ logo.png
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ main.js
â””â”€â”€ utils
    â”œâ”€â”€ base.js // åŸºç¡€å·¥å…·å‡½æ•°
    â””â”€â”€ config.js // é…ç½®æ–‡ä»¶å‡½æ•°
</code></pre>
<h3 data-id="heading-6">å¦‚ä½•å¼€å‘ï¼Ÿ</h3>
<h4 data-id="heading-7">å¯åŠ¨çƒ­æ›´æ–°</h4>
<pre><code class="hljs language-npm" lang="npm">npm run dev:ext
</code></pre>
<h4 data-id="heading-8">å®‰è£…æ‰©å±•</h4>
<ol>
<li>æ‰“å¼€ Chrome æµè§ˆå™¨ã€‚</li>
<li>ç‚¹å‡»æµè§ˆå™¨èœå•ï¼ˆé€šå¸¸æ˜¯ä¸‰ä¸ªå‚ç›´ç‚¹å›¾æ ‡ï¼‰ï¼Œé€‰æ‹©â€œæ›´å¤šå·¥å…·â€&gt;â€œæ‰©å±•ç¨‹åºâ€ã€‚</li>
<li>åœ¨æ‰©å±•ç¨‹åºé¡µé¢ï¼Œæ‰“å¼€â€œå¼€å‘è€…æ¨¡å¼â€ã€‚</li>
<li>ç‚¹å‡»â€œåŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åºâ€ï¼Œé€‰æ‹©é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ <code>extension</code> æ–‡ä»¶å¤¹ã€‚</li>
</ol>
<p>ç„¶åä½ å°±å¯ä»¥æ„‰å¿«çš„å¼€å§‹å¼€å‘æµè§ˆå™¨æ’ä»¶äº†ã€‚ä½ å‡ ä¹åªéœ€è¦ä¼šVueå’ŒJSå°±å¯ä»¥å¼€å‘ï¼Œæˆ–è€…ç»“åˆå¤§æ¨¡å‹å¿«é€Ÿç”Ÿæˆä¸€ä¸ªæ’ä»¶</p>
<p>è¿™æ˜¯æˆ‘ç”¨Gemini 3 proç»“åˆè¿™ä¸ªæ¨¡æ¿ç”Ÿæˆçš„å…¶ä¸­ä¸€ä¸ªæ’ä»¶çš„æ•ˆæœï¼ŒåŸºæœ¬ä¸Šå®Œå…¨å¯ç”¨</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b033276a59c34286a663aaf69644407e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVzdEhhcHB5:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766755750&amp;x-signature=bXGTj0v4%2FaFqhuZauRjQChtz5VE%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœä½ ä¹Ÿæƒ³å°è¯•ï¼Œè¿™æ˜¯è¿™ä¸ªæ’ä»¶çš„githubä»“åº“åœ°å€ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSimonmie%2FText-extraction-tool" target="_blank" title="https://github.com/Simonmie/Text-extraction-tool" ref="nofollow noopener noreferrer">github.com/Simonmie/Teâ€¦</a></p>
<hr/>
<p>ä¸‹é¢æˆ‘ä»¬æ¥èŠèŠè¿™ä¸ªæ¡†æ¶çš„â€œçƒ­æ›´æ–°â€åŸç†å§....</p>
<h2 data-id="heading-9">â€çƒ­æ›´æ–°â€œåŸç†</h2>
<p>æœ‰äººé—®æˆ‘ï¼šâ€œä¸ºä»€ä¹ˆè¿™ä¸ªæ¨¡æ¿èƒ½åšåˆ°ç±»ä¼¼ HMR çš„ä½“éªŒï¼Ÿæµè§ˆå™¨æ’ä»¶ä¸æ˜¯ä¸èƒ½çƒ­æ›´æ–°å—â€</p>
<p>ç­”æ¡ˆå…¶å®å¾ˆç®€å•ï¼š</p>
<blockquote>
<p><strong>ä¸æ˜¯æ¨¡å—çº§çƒ­æ›¿æ¢ï¼Œè€Œæ˜¯è‡ªåŠ¨é‡å»º + è‡ªåŠ¨åˆ·æ–°ã€‚</strong></p>
</blockquote>
<p>å½“ä½ ä¿®æ”¹ä»£ç æ—¶ï¼š</p>
<ul>
<li>æ„å»ºå™¨ä¼šé‡å»ºäº§ç‰©</li>
<li>çƒ­æ›´æ–°æœåŠ¡ä¼šç»™æ‰©å±•å‘é€é€šçŸ¥</li>
<li>å‰å°è§†å›¾åˆ·æ–°ã€åå°è„šæœ¬é‡è½½</li>
<li>æµè§ˆå™¨æ‰©å±•æ•´ä½“æ›´æ–°</li>
</ul>
<p>å®Œå…¨ä¸éœ€è¦æ‰‹åŠ¨åˆ·æ–°çª—å£ï¼Œä¸éœ€è¦é‡æ–°ç‚¹å‡»æ‰©å±•å›¾æ ‡ã€‚</p>
<p>æ›´å…³é”®çš„æ˜¯ï¼šæ•´ä¸ªæœºåˆ¶éå¸¸è½»ï¼Œéå¸¸å¹²å‡€ã€‚</p>
<h3 data-id="heading-10">ä¸€ä¸ªæå°çš„çƒ­æ›´æ–°æœåŠ¡</h3>
<p>æ¨¡æ¿å¯åŠ¨åä¼šåŒæ—¶å¯åŠ¨ä¸€ä¸ªæœ¬åœ°æœåŠ¡ï¼Œç”¨äºç›‘å¬æ„å»ºå˜åŒ–å¹¶å‘æ‰©å±•å‘é€æ¶ˆæ¯ã€‚</p>
<p>è¿™ä¸ªæœåŠ¡é€šè¿‡ SSEï¼ˆServer-Sent Eventsï¼‰å·¥ä½œï¼š</p>
<ul>
<li>åœ°å€ç±»ä¼¼ï¼š<a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">http://localhost:3000/extension-hmr</a></li>
<li>æ„å»ºå®Œæˆåä¼šæ¨é€ reload ä¿¡å·</li>
<li>æ‰€æœ‰é¡µé¢å’Œåå°è„šæœ¬éƒ½ä¼šç›‘å¬å®ƒ</li>
</ul>
<p>SSE çš„å¥½å¤„æ˜¯ï¼š</p>
<ul>
<li>è½»é‡</li>
<li>æ— éœ€é¢å¤–ä¾èµ–</li>
<li>æ— éœ€è½®è¯¢</li>
<li>ç‰¹åˆ«ç¨³å®š</li>
</ul>
<p>ä½ ç”šè‡³å¯ä»¥æŠŠå®ƒç†è§£ä¸ºï¼šä¸€ä¸ªç‰¹åˆ«ç®€å•çš„â€œæ›´æ–°å¹¿æ’­å™¨â€ã€‚</p>
<h3 data-id="heading-11">å‰å°é¡µé¢å¦‚ä½•åˆ·æ–°ï¼Ÿ</h3>
<p>æ‰©å±•é‡Œçš„ popupã€optionsã€sidepanel é¡µé¢éƒ½ä¼šè‡ªåŠ¨æ³¨å…¥ä¸€ä¸ªç›‘å¬å™¨ï¼š</p>
<ol>
<li>é€šè¿‡ EventSource è¿æ¥ SSE æœåŠ¡</li>
<li>æ”¶åˆ° reload ä¿¡å·</li>
<li><code>window.location.reload()</code></li>
</ol>
<p>æ‰€ä»¥æ”¹å®Œä»£ç ä¿å­˜åï¼š<br/>
â†’ UI ä¼šç«‹å³é‡æ–°åŠ è½½<br/>
â†’ æ–°çš„ä»£ç ä¼šç›´æ¥ç”Ÿæ•ˆ</p>
<p>ä¸ç”¨ç‚¹å‡»ï¼Œä¸ç”¨é‡æ‰“å¼€ popup é¡µé¢ï¼Œè¿ DevTools éƒ½ä¸ç”¨åŠ¨ã€‚</p>
<h3 data-id="heading-12">åå°è„šæœ¬å¦‚ä½•æ›´æ–°ï¼Ÿ</h3>
<p>åœ¨å¼€å‘æ¨¡å¼ä¸‹ï¼Œåå°è„šæœ¬å¹¶ä¸ä¼šç›´æ¥è¿è¡Œæ­£å¼çš„ background é€»è¾‘ï¼Œè€Œæ˜¯å…ˆæ¥å…¥ä¸€ä¸ªå¼€å‘ä¸“ç”¨çš„è„šæœ¬ã€‚</p>
<p>è¿™ä¸ªè„šæœ¬ä¸“é—¨è´Ÿè´£ç›‘å¬ SSEï¼š</p>
<ol>
<li>æ”¶åˆ°æ¶ˆæ¯</li>
<li><code>chrome.runtime.reload()</code></li>
</ol>
<p>è¿™ä¼šè®©æ•´ä¸ªæ‰©å±•ç¬é—´é‡è½½ï¼š</p>
<ul>
<li>UI åˆ·æ–°</li>
<li>è„šæœ¬åˆ·æ–°</li>
<li>çŠ¶æ€é‡ç½®</li>
</ul>
<p>è¿™ç§æ–¹å¼éå¸¸é€‚åˆå¼€å‘åœºæ™¯ï¼Œå› ä¸ºä¸ç”¨æ‹…å¿ƒç¼“å­˜ã€ä¸ä¸€è‡´ã€åå°ä»åœ¨è¿è¡Œç­‰é—®é¢˜ã€‚</p>
<h3 data-id="heading-13">è‡ªåŠ¨é‡è¿æœºåˆ¶</h3>
<p>SSE è¿æ¥å¦‚æœæ–­å¼€ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>å°æ–­ç½‘</li>
<li>æµè§ˆå™¨åˆ‡æ¢æ ‡ç­¾</li>
<li>ç³»ç»Ÿä¼‘çœ </li>
<li>æ„å»ºå™¨é‡å¯</li>
</ul>
<p>æ‰©å±•ä¼šè‡ªåŠ¨é‡è¯•è¿æ¥ã€‚</p>
<p>è¿™æ„å‘³ç€ï¼š<br/>
ä½ åªéœ€è¦æ”¹ä»£ç  â†’ ä¿å­˜ â†’ æµè§ˆå™¨è‡ªåŠ¨æ›´æ–°<br/>
ä¸ç”¨å…³å¿ƒåº•å±‚è¿æ¥æ˜¯å¦æ–­è¿‡ã€é‡è¿è¿‡ã€‚</p>
<p>å®ƒå°±æ˜¯ä¸€ç›´èƒ½ç”¨ã€‚</p>
<blockquote>
<p>å¦‚æœè¿™å¯¹ä½ æœ‰å¸®åŠ©ï¼Œå“ˆå“ˆæ±‚ä¸ªstarâœ¨ï¼Œæ¨¡æ¿å¤§æ¦‚ç‡è¿˜æœ‰å¾ˆå¤šä¸è¶³ï¼Œæ¬¢è¿å¤§å®¶æäº¤issueã€prç­‰ï¼Œæˆ–è€…å•çº¯éªšæ‰°æˆ‘ğŸ˜œ</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android LaunchMode]]></title>    <link>https://juejin.cn/post/7585406229167898674</link>    <guid>https://juejin.cn/post/7585406229167898674</guid>    <pubDate>2025-12-19T13:42:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585406229167898674" data-draft-id="7584650857070788617" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android LaunchMode"/> <meta itemprop="keywords" content="Android,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-19T13:42:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ— é™è¿›åŒ–"/> <meta itemprop="url" content="https://juejin.cn/user/108212996024855"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android LaunchMode
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/108212996024855/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ— é™è¿›åŒ–
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T13:42:28.000Z" title="Fri Dec 19 2025 13:42:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ å››å¤§å¯åŠ¨æ¨¡å¼</h2>
<h3 data-id="heading-1">Q1. LaunchMode éƒ½æœ‰å“ªäº›ï¼Ÿ</h3>
<p>standardã€singleTopã€singleTaskã€singleInstanceã€‚</p>
<h3 data-id="heading-2">Q2. standard (æ ‡å‡†æ¨¡å¼) çš„ç‰¹ç‚¹ä¸å‘ç‚¹ï¼Ÿ</h3>
<ul>
<li>
<p><strong>ç‰¹ç‚¹</strong>ï¼šé»˜è®¤æ¨¡å¼ã€‚æ¯æ¬¡å¯åŠ¨éƒ½<strong>åˆ›å»ºæ–°å®ä¾‹</strong>å¹¶å‹å…¥å½“å‰æ ˆé¡¶ã€‚</p>
</li>
<li>
<p><strong>å‘ç‚¹</strong>ï¼š<strong>é Activity Contextï¼ˆå¦‚ Application/Serviceï¼‰å¯åŠ¨æ­¤æ¨¡å¼ä¼šå´©æºƒï¼Œå¿…é¡»æ·»åŠ  FLAG_ACTIVITY_NEW_TASK æ ‡è®°ã€‚</strong></p>
<p>æ³¨ï¼šstandard æ¨¡å¼çš„ Activity é»˜è®¤è¦è¿›å…¥å¯åŠ¨å®ƒçš„é‚£ä¸ªç»„ä»¶æ‰€åœ¨çš„ä»»åŠ¡æ ˆã€‚</p>
</li>
</ul>
<pre><code class="hljs language-txt" lang="txt">æ ˆçŠ¶æ€: [A]
å¯åŠ¨ A (standard) -&gt; [A, A(æ–°)]
</code></pre>
<h3 data-id="heading-3">Q3. singleTop (æ ˆé¡¶å¤ç”¨) çš„ç‰¹ç‚¹ï¼Ÿ</h3>
<ul>
<li><strong>è‹¥å·²åœ¨æ ˆé¡¶</strong>ï¼š<strong>ä¸åˆ›å»º</strong>æ–°å®ä¾‹ï¼Œå›è°ƒ <code>onNewIntent()</code> (onCreate/onStart ä¸è°ƒç”¨)ã€‚</li>
<li><strong>è‹¥ä¸åœ¨æ ˆé¡¶</strong>ï¼šåˆ›å»ºæ–°å®ä¾‹å‹å…¥æ ˆé¡¶ã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šé€šçŸ¥æ ç‚¹å‡»è·³è½¬ã€é˜²æ­¢æŒ‰é’®å¿«é€Ÿè¿ç‚¹ã€‚</li>
</ul>
<pre><code class="hljs language-txt" lang="txt">æ ˆçŠ¶æ€: [A, B]
å¯åŠ¨ B (singleTop) -&gt; [A, B] (å¤ç”¨, onNewIntent)
å¯åŠ¨ A (singleTop) -&gt; [A, B, A] (æ–°å»º, å› ä¸ºAä¸åœ¨æ ˆé¡¶)
</code></pre>
<h3 data-id="heading-4">Q4. singleTask (æ ˆå†…å¤ç”¨) çš„ç‰¹ç‚¹ï¼Ÿ</h3>
<ul>
<li><strong>ç‹¬å æ€§</strong>ï¼šåªè¦æ ˆä¸­å­˜åœ¨è¯¥å®ä¾‹ï¼Œå¤šæ¬¡å¯åŠ¨å‡å¤ç”¨å®ƒã€‚</li>
<li><strong>ClearTop</strong>ï¼šå¤ç”¨æ—¶ï¼Œ<strong>è‡ªåŠ¨é”€æ¯</strong>è¯¥å®ä¾‹ä¹‹ä¸Šçš„æ‰€æœ‰ Activityã€‚</li>
<li><strong>æ ˆæŸ¥æ‰¾</strong>ï¼šè‹¥æ‰¾ä¸åˆ°æ‰€éœ€ä»»åŠ¡æ ˆ (TaskAffinity)ï¼Œä¼šåˆ›å»ºæ–°æ ˆã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šApp é¦–é¡µã€WebView å®¹å™¨é¡µã€‚</li>
</ul>
<pre><code class="hljs language-txt" lang="txt">æ ˆçŠ¶æ€: [A, B, C] (Bä¸ºsingleTask)
å¯åŠ¨ B -&gt; [A, B] (Cè¢«é”€æ¯, Bå¤ç”¨å¹¶onNewIntent)
</code></pre>
<h3 data-id="heading-5">Q5. singleInstance (å…¨å±€å•ä¾‹) çš„ç‰¹ç‚¹ï¼Ÿ</h3>
<ul>
<li><strong>åŠ å¼ºç‰ˆ singleTask</strong>ï¼šæ•´ä¸ªç³»ç»Ÿåªæœ‰è¿™ä¸€ä¸ªå®ä¾‹ã€‚</li>
<li><strong>ç‹¬å æ ˆ</strong>ï¼šè¯¥å®ä¾‹<strong>åªèƒ½å•ç‹¬ä½äºä¸€ä¸ªä»»åŠ¡æ ˆä¸­</strong>ï¼Œä¸å…è®¸å…¶ä»– Activity å…¥é©»ã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šæ¥ç”µç•Œé¢ã€é—¹é’Ÿå“é“ƒã€‚</li>
</ul>
<pre><code class="hljs language-ini" lang="ini">Task1: <span class="hljs-section">[A, B]</span>
å¯åŠ¨ C (singleInstance)
Task1: <span class="hljs-section">[A, B]</span> (åå°)
Task2: <span class="hljs-section">[C]</span>    (å‰å°, ç‹¬å )
</code></pre>
<h2 data-id="heading-6">äºŒã€ ä»»åŠ¡æ ˆ (Task) äº¤äº’é€»è¾‘</h2>
<h3 data-id="heading-7">Q6. ä»»åŠ¡æ ˆå¦‚ä½•åˆ†ç±»ï¼Ÿ</h3>
<ul>
<li><strong>å‰å°ä»»åŠ¡æ ˆ</strong>ï¼šç”¨æˆ·å½“å‰æ­£åœ¨äº¤äº’çš„æ ˆã€‚</li>
<li><strong>åå°ä»»åŠ¡æ ˆ</strong>ï¼šå¤„äºåå°ï¼Œå…¶ä¸­ Activity å‡å¤„äº Paused/Stopped çŠ¶æ€ã€‚</li>
</ul>
<h3 data-id="heading-8">Q7. å‰å°æ ˆ ABï¼Œåå°æ ˆ CD (å‡ä¸º singleTask)ã€‚å¯åŠ¨ Dï¼Œå†æŒ‰ Backï¼Œé¡ºåºæ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<ol>
<li>
<p><strong>å¯åŠ¨ D</strong>ï¼šåå°æ ˆ CD è¢«æ•´ä½“æ‹‰å›å‰å°ï¼Œç½®äº AB ä¹‹ä¸Šã€‚</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[å‰å°æ ˆ Task1]</span> <span class="hljs-selector-tag">A</span> -&gt; <span class="hljs-selector-tag">B</span>
<span class="hljs-selector-attr">[åå°æ ˆ Task2]</span> C -&gt; D
-------- å¯åŠ¨ D --------
<span class="hljs-selector-attr">[åˆå¹¶è§†è§‰]</span> <span class="hljs-selector-tag">A</span> -&gt; <span class="hljs-selector-tag">B</span> -&gt; C -&gt; D (Task2 è¦†ç›–åœ¨ Task1 ä¸Š)
</code></pre>
</li>
<li>
<p><strong>Back é¡ºåº</strong>ï¼š <code>D å‡ºæ ˆ</code> -&gt; <code>æ˜¾ç¤º C</code> -&gt; <code>Back</code> -&gt; <code>C å‡ºæ ˆ</code> -&gt; <code>æ˜¾ç¤º B</code> -&gt; <code>Back</code> -&gt; <code>A</code> -&gt; <code>æ¡Œé¢</code>ã€‚</p>
</li>
</ol>
<h3 data-id="heading-9">Q8. A(standard)ã€B(singleTask)ã€C(singleTask)ã€‚è·¯å¾„: A-&gt;B-&gt;C-&gt;A-&gt;Bã€‚ç‚¹ä¸¤æ¬¡ Back çœ‹åˆ°è°ï¼Ÿ</h3>
<p><strong>ç»“è®ºï¼šå›åˆ°æ¡Œé¢</strong>ã€‚</p>
<p><strong>è¯¦ç»†æ¨æ¼”å›¾è§£</strong>ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-number">1</span>. <span class="hljs-selector-tag">A</span><span class="hljs-selector-tag">-</span>&gt;<span class="hljs-selector-tag">B</span>:
   æ ˆ: <span class="hljs-selector-attr">[A, B]</span>

<span class="hljs-number">2</span>. <span class="hljs-selector-tag">-</span>&gt;<span class="hljs-selector-tag">C</span>:
   æ ˆ: <span class="hljs-selector-attr">[A, B, C]</span>

<span class="hljs-number">3</span>. <span class="hljs-selector-tag">-</span>&gt;<span class="hljs-selector-tag">A</span> (standard):
   æ ˆ: <span class="hljs-selector-attr">[A, B, C, A]</span>  &lt;<span class="hljs-selector-tag">--</span> <span class="hljs-selector-tag">A</span>ç›´æ¥å‹å…¥

<span class="hljs-number">4</span>. <span class="hljs-selector-tag">-</span>&gt;<span class="hljs-selector-tag">B</span> (singleTask):
   æ£€æŸ¥æ ˆå†…... å‘ç° <span class="hljs-selector-tag">B</span>!
   è§¦å‘ <span class="hljs-selector-tag">ClearTop</span>: é”€æ¯ <span class="hljs-selector-tag">B</span> ä¹‹ä¸Šçš„ <span class="hljs-selector-tag">C</span> å’Œ <span class="hljs-selector-tag">A</span>
   æ ˆ: <span class="hljs-selector-attr">[A, B]</span>        &lt;<span class="hljs-selector-tag">--</span> <span class="hljs-selector-tag">B</span>å¤ç”¨

<span class="hljs-number">5</span>. <span class="hljs-selector-tag">Back</span> <span class="hljs-number">1</span>æ¬¡:
   <span class="hljs-selector-tag">B</span> å‡ºæ ˆ <span class="hljs-selector-tag">-</span>&gt; æ˜¾ç¤º <span class="hljs-selector-tag">A</span>
   æ ˆ: <span class="hljs-selector-attr">[A]</span>

<span class="hljs-number">6</span>. <span class="hljs-selector-tag">Back</span> <span class="hljs-number">2</span>æ¬¡:
   <span class="hljs-selector-tag">A</span> å‡ºæ ˆ <span class="hljs-selector-tag">-</span>&gt; æ ˆç©º <span class="hljs-selector-tag">-</span>&gt; å›åˆ°æ¡Œé¢
</code></pre>
<h3 data-id="heading-10">Q9. TaskAffinity æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3>
<ul>
<li>æŒ‡å®š Activity æ‰€éœ€ä»»åŠ¡æ ˆçš„åå­—ï¼ˆé»˜è®¤ä¸ºåŒ…åï¼‰ã€‚</li>
<li>éœ€é…åˆ <code>singleTask</code> æˆ– <code>allowTaskReparenting</code> ä½¿ç”¨æ‰ç”Ÿæ•ˆã€‚</li>
<li><strong>åº”ç”¨</strong>ï¼šå°†å°ç¨‹åºæˆ–å·¥å…·é¡µæ”¾å…¥ç‹¬ç«‹è¿›ç¨‹/ä»»åŠ¡æ ˆã€‚</li>
</ul>
<h3 data-id="heading-11">Q10. allowTaskReparenting æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<ul>
<li>
<p><strong>å®šä¹‰</strong>ï¼šå…è®¸ Activity å˜æ›´å½’å±æ ˆã€‚</p>
</li>
<li>
<p><strong>ç°è±¡</strong>ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">App</span> <span class="hljs-selector-tag">A</span> (Task A): å¯åŠ¨äº† <span class="hljs-selector-tag">App</span> <span class="hljs-selector-tag">B</span> çš„ <span class="hljs-selector-tag">Activity</span> <span class="hljs-selector-tag">C</span> (allowTaskReparenting=true)
çŠ¶æ€: <span class="hljs-selector-tag">Task</span> <span class="hljs-selector-tag">A</span> <span class="hljs-selector-attr">[..., C]</span>

<span class="hljs-selector-tag">--</span>&gt; ç”¨æˆ·å›æ¡Œé¢ï¼Œç‚¹å›¾æ ‡å¯åŠ¨ <span class="hljs-selector-tag">App</span> <span class="hljs-selector-tag">B</span>
ç°è±¡: <span class="hljs-selector-tag">C</span> ä» <span class="hljs-selector-tag">Task</span> <span class="hljs-selector-tag">A</span> é£åˆ°äº† <span class="hljs-selector-tag">Task</span> <span class="hljs-selector-tag">B</span>
çŠ¶æ€: <span class="hljs-selector-tag">Task</span> <span class="hljs-selector-tag">A</span> <span class="hljs-selector-attr">[...]</span>
      <span class="hljs-selector-tag">Task</span> <span class="hljs-selector-tag">B</span> <span class="hljs-selector-attr">[C]</span> (C æ˜¾ç¤ºåœ¨ B çš„æ ˆé¡¶)
</code></pre>
</li>
</ul>
<h2 data-id="heading-12">ä¸‰ã€ å¯åŠ¨é…ç½®ä¸ Intent</h2>
<h3 data-id="heading-13">Q11. å¦‚ä½•æŒ‡å®šå¯åŠ¨æ¨¡å¼ï¼Ÿä¼˜å…ˆçº§å¦‚ä½•ï¼Ÿ</h3>
<ol>
<li><strong>é™æ€</strong>ï¼šManifest <code>android:launchMode</code>ã€‚</li>
<li><strong>åŠ¨æ€</strong>ï¼šIntent Flags <code>intent.addFlags(...)</code>ã€‚</li>
<li><strong>ä¼˜å…ˆçº§</strong>ï¼š<strong>Intent Flags &gt; Manifest</strong>ã€‚</li>
</ol>
<h3 data-id="heading-14">Q12. å¸¸ç”¨çš„ Intent Flags è§£æï¼Ÿ</h3>
<ul>
<li>
<p><code>FLAG_ACTIVITY_NEW_TASK</code>: æ•ˆæœè¿‘ä¼¼ singleTaskï¼ˆé Activity å¯åŠ¨å¿…åŠ ï¼‰ã€‚</p>
</li>
<li>
<p><code>FLAG_ACTIVITY_SINGLE_TOP</code>: ç­‰åŒ singleTopã€‚</p>
</li>
<li>
<p><code>FLAG_ACTIVITY_CLEAR_TOP</code>:</p>
<ul>
<li><strong>æ ‡å‡†æ¨¡å¼ä¸‹</strong>ï¼šé”€æ¯ç›®æ ‡åŠä¹‹ä¸Šæ‰€æœ‰é¡µé¢ï¼Œ<strong>é‡å»º</strong>ç›®æ ‡å®ä¾‹ã€‚</li>
<li><strong>é…åˆ singleTask</strong>ï¼šä¸é‡å»ºï¼Œå›è°ƒ <code>onNewIntent</code>ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-15">Q13. æ˜¾å¼è°ƒç”¨ vs éšå¼è°ƒç”¨ï¼Ÿ</h3>
<ul>
<li><strong>æ˜¾å¼</strong>ï¼šæŒ‡å®š <code>package</code>, <code>class name</code>ã€‚</li>
<li><strong>éšå¼</strong>ï¼šåŒ¹é… <code>IntentFilter</code> (Action, Category, Data)ã€‚ä¼˜åŠ¿æ˜¯è§£è€¦ã€è·¨åº”ç”¨ã€‚</li>
</ul>
<h3 data-id="heading-16">Q14. IntentFilter åŒ¹é…è§„åˆ™ (Action/Category/Data)ï¼Ÿ</h3>
<ul>
<li>
<p><strong>Action</strong>ï¼šIntent <strong>å¿…é¡»æœ‰</strong> Actionï¼Œä¸”å¿…é¡»åŒ¹é…è¿‡æ»¤è§„åˆ™ä¸­<strong>è‡³å°‘ä¸€ä¸ª</strong>ã€‚</p>
</li>
<li>
<p><strong>Category</strong>ï¼šIntent å¯æ—  Category (é»˜è®¤å¸¦ DEFAULT)ã€‚è‹¥æœ‰ï¼Œåˆ™<strong>å¿…é¡»å…¨éƒ¨</strong>åŒ…å«åœ¨è¿‡æ»¤è§„åˆ™ä¸­ã€‚</p>
<ul>
<li><em>æ³¨ï¼šéšå¼ Activity å¿…é¡»åœ¨ Manifest å£°æ˜ <code>android.intent.category.DEFAULT</code>ã€‚</em></li>
</ul>
</li>
<li>
<p><strong>Data</strong>ï¼šå¿…é¡»åŒ¹é… MIMEType å’Œ URIã€‚</p>
</li>
</ul>
<h3 data-id="heading-17">Q15. å¦‚ä½•é˜²æ­¢éšå¼å¯åŠ¨å¤±è´¥å´©æºƒï¼Ÿ</h3>
<p>ä½¿ç”¨ <code>PackageManager.resolveActivity()</code> æˆ– <code>queryIntentActivities(intent, MATCH_DEFAULT_ONLY)</code> é¢„æ£€æŸ¥æ˜¯å¦è¿”å› null æˆ–ç©ºåˆ—è¡¨ã€‚</p>
<h3 data-id="heading-18">Q16. Launcher å…¥å£ Activity å¿…é¡»é…ç½®ä»€ä¹ˆï¼Ÿ</h3>
<p>(ç¼ºä¸€ä¸å¯)</p>
<pre><code class="hljs language-ini" lang="ini">&lt;action android:<span class="hljs-attr">name</span>=<span class="hljs-string">"android.intent.action.MAIN"</span> /&gt;
&lt;category android:<span class="hljs-attr">name</span>=<span class="hljs-string">"android.intent.category.LAUNCHER"</span> /&gt;
</code></pre>
<h2 data-id="heading-19">å››ã€ å®æˆ˜æ¡ˆä¾‹</h2>
<h3 data-id="heading-20">Q17. åº”ç”¨æ¯æ¬¡å¯åŠ¨ Acitivity Aï¼Œéƒ½éœ€è¦ä¿è¯ A ä¸ºæ ˆåº•ã€‚</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> {
    <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);
    <span class="hljs-keyword">if</span> (!isTaskRoot()) {
        <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> getIntent();
        <span class="hljs-type">String</span> <span class="hljs-variable">action</span> <span class="hljs-operator">=</span> intent.getAction();
        
        <span class="hljs-type">Intent</span> <span class="hljs-variable">newIntent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(<span class="hljs-built_in">this</span>, ActivityA.class);
        newIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);
        startActivity(newIntent);
        finish();
        <span class="hljs-keyword">return</span>;
    }

    setContentView(R.layout.activity_a);
    <span class="hljs-comment">// ... </span>
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[UIWindowScene ä½¿ç”¨æŒ‡å—ï¼šæŒæ¡ iOS å¤šçª—å£æ¶æ„]]></title>    <link>https://juejin.cn/post/7585406229167800370</link>    <guid>https://juejin.cn/post/7585406229167800370</guid>    <pubDate>2025-12-19T12:32:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585406229167800370" data-draft-id="7585031025447174154" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="UIWindowScene ä½¿ç”¨æŒ‡å—ï¼šæŒæ¡ iOS å¤šçª—å£æ¶æ„"/> <meta itemprop="keywords" content="iOS"/> <meta itemprop="datePublished" content="2025-12-19T12:32:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="sweetä¸¶"/> <meta itemprop="url" content="https://juejin.cn/user/3227821869921646"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            UIWindowScene ä½¿ç”¨æŒ‡å—ï¼šæŒæ¡ iOS å¤šçª—å£æ¶æ„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3227821869921646/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    sweetä¸¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T12:32:52.000Z" title="Fri Dec 19 2025 12:32:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>åœ¨ iOS 13 ä¹‹å‰ï¼ŒiOS åº”ç”¨é€šå¸¸åªæœ‰ä¸€ä¸ªä¸»çª—å£ï¼ˆUIWindowï¼‰ã€‚ä½†éšç€ iPadOS çš„æ¨å‡ºå’Œå¤šä»»åŠ¡å¤„ç†éœ€æ±‚çš„å¢åŠ ï¼ŒApple å¼•å…¥äº† <strong>UIWindowScene</strong> æ¶æ„ï¼Œè®©å•ä¸ªåº”ç”¨å¯ä»¥åŒæ—¶ç®¡ç†å¤šä¸ªçª—å£ï¼Œæ¯ä¸ªçª—å£éƒ½æœ‰è‡ªå·±çš„åœºæ™¯ï¼ˆSceneï¼‰ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ UIWindowScene çš„æ ¸å¿ƒæ¦‚å¿µå’Œä½¿ç”¨æ–¹æ³•ã€‚</p>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯ UIWindowSceneï¼Ÿ</h2>
<p>UIWindowScene æ˜¯ iOS 13+ ä¸­å¼•å…¥çš„æ–°æ¶æ„ï¼Œå®ƒä»£è¡¨äº†åº”ç”¨ç¨‹åºç”¨æˆ·ç•Œé¢çš„ä¸€ä¸ªå®ä¾‹ã€‚æ¯ä¸ªåœºæ™¯éƒ½æœ‰è‡ªå·±çš„çª—å£ã€è§†å›¾æ§åˆ¶å™¨å±‚çº§å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚</p>
<h3 data-id="heading-2">æ ¸å¿ƒç»„ä»¶å…³ç³»</h3>
<pre><code class="hljs language-objectivec" lang="objectivec"><span class="hljs-built_in">UISceneSession</span> â†’ <span class="hljs-built_in">UIWindowScene</span> â†’ <span class="hljs-built_in">UIWindow</span> â†’ <span class="hljs-built_in">UIViewController</span>
      â†“
<span class="hljs-built_in">UISceneConfiguration</span>
</code></pre>
<h2 data-id="heading-3">åŸºç¡€é…ç½®</h2>
<h3 data-id="heading-4">1. é¡¹ç›®è®¾ç½®</h3>
<p>é¦–å…ˆéœ€è¦åœ¨ Info.plist ä¸­å¯ç”¨å¤šåœºæ™¯æ”¯æŒï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>UIApplicationSceneManifest<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dict</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>UIApplicationSupportsMultipleScenes<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">true</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>UISceneConfigurations<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dict</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>UIWindowSceneSessionRoleApplication<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">array</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">dict</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>UISceneConfigurationName<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>Default Configuration<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>UISceneDelegateClassName<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>$(PRODUCT_MODULE_NAME).SceneDelegate<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>UISceneStoryboardFile<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>Main<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">dict</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">array</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dict</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dict</span>&gt;</span>
</code></pre>
<h3 data-id="heading-5">2. SceneDelegate å®ç°</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> UIKit

<span class="hljs-keyword">class</span> <span class="hljs-title class_">SceneDelegate</span>: <span class="hljs-title class_">UIResponder</span>, <span class="hljs-title class_">UIWindowSceneDelegate</span> {
    <span class="hljs-keyword">var</span> window: <span class="hljs-type">UIWindow</span>?
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">scene</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">scene</span>: <span class="hljs-type">UIScene</span>, 
               <span class="hljs-params">willConnectTo</span> <span class="hljs-params">session</span>: <span class="hljs-type">UISceneSession</span>, 
               <span class="hljs-params">options</span> <span class="hljs-params">connectionOptions</span>: <span class="hljs-type">UIScene</span>.<span class="hljs-type">ConnectionOptions</span>) {
        
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> windowScene <span class="hljs-operator">=</span> (scene <span class="hljs-keyword">as?</span> <span class="hljs-type">UIWindowScene</span>) <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }
        
        window <span class="hljs-operator">=</span> <span class="hljs-type">UIWindow</span>(windowScene: windowScene)
        window<span class="hljs-operator">?</span>.rootViewController <span class="hljs-operator">=</span> <span class="hljs-type">YourRootViewController</span>()
        window<span class="hljs-operator">?</span>.makeKeyAndVisible()
        
        <span class="hljs-comment">// å¤„ç†æ·±åº¦é“¾æ¥</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> userActivity <span class="hljs-operator">=</span> connectionOptions.userActivities.first {
            <span class="hljs-keyword">self</span>.scene(scene, continue: userActivity)
        }
    }
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">sceneDidDisconnect</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">scene</span>: <span class="hljs-type">UIScene</span>) {
        <span class="hljs-comment">// åœºæ™¯è¢«ç³»ç»Ÿé‡Šæ”¾æ—¶è°ƒç”¨</span>
    }
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">sceneDidBecomeActive</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">scene</span>: <span class="hljs-type">UIScene</span>) {
        <span class="hljs-comment">// åœºæ™¯å˜ä¸ºæ´»åŠ¨çŠ¶æ€æ—¶è°ƒç”¨</span>
    }
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">sceneWillResignActive</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">scene</span>: <span class="hljs-type">UIScene</span>) {
        <span class="hljs-comment">// åœºæ™¯å³å°†å˜ä¸ºéæ´»åŠ¨çŠ¶æ€æ—¶è°ƒç”¨</span>
    }
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">sceneWillEnterForeground</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">scene</span>: <span class="hljs-type">UIScene</span>) {
        <span class="hljs-comment">// åœºæ™¯å³å°†è¿›å…¥å‰å°</span>
    }
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">sceneDidEnterBackground</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">scene</span>: <span class="hljs-type">UIScene</span>) {
        <span class="hljs-comment">// åœºæ™¯è¿›å…¥åå°</span>
    }
}
</code></pre>
<h2 data-id="heading-6">åˆ›å»ºå’Œç®¡ç†å¤šä¸ªåœºæ™¯</h2>
<h3 data-id="heading-7">1. åŠ¨æ€åˆ›å»ºæ–°çª—å£</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SceneManager</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">createNewScene</span>(<span class="hljs-params">with</span> <span class="hljs-params">userInfo</span>: [<span class="hljs-params">String</span>: <span class="hljs-keyword">Any</span>]<span class="hljs-operator">?</span> <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>) {
        <span class="hljs-keyword">let</span> activity <span class="hljs-operator">=</span> <span class="hljs-type">NSUserActivity</span>(activityType: <span class="hljs-string">"com.yourapp.newWindow"</span>)
        activity.userInfo <span class="hljs-operator">=</span> userInfo
        activity.targetContentIdentifier <span class="hljs-operator">=</span> <span class="hljs-string">"newWindow"</span>
        
        <span class="hljs-keyword">let</span> options <span class="hljs-operator">=</span> <span class="hljs-type">UIScene</span>.<span class="hljs-type">ActivationRequestOptions</span>()
        options.requestingScene <span class="hljs-operator">=</span> <span class="hljs-type">UIApplication</span>.shared.connectedScenes.first <span class="hljs-keyword">as?</span> <span class="hljs-type">UIWindowScene</span>
        
        <span class="hljs-type">UIApplication</span>.shared.requestSceneSessionActivation(
            <span class="hljs-literal">nil</span>,
            userActivity: activity,
            options: options,
            errorHandler: { error <span class="hljs-keyword">in</span>
                <span class="hljs-built_in">print</span>(<span class="hljs-string">"Failed to create new scene: <span class="hljs-subst">\(error)</span>"</span>)
            }
        )
    }
}
</code></pre>
<h3 data-id="heading-8">2. åœºæ™¯é…ç½®ç®¡ç†</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// è‡ªå®šä¹‰åœºæ™¯é…ç½®</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomSceneDelegate</span>: <span class="hljs-title class_">UIResponder</span>, <span class="hljs-title class_">UIWindowSceneDelegate</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">let</span> configurationName <span class="hljs-operator">=</span> <span class="hljs-string">"CustomSceneConfiguration"</span>
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">scene</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">scene</span>: <span class="hljs-type">UIScene</span>, 
               <span class="hljs-params">willConnectTo</span> <span class="hljs-params">session</span>: <span class="hljs-type">UISceneSession</span>, 
               <span class="hljs-params">options</span> <span class="hljs-params">connectionOptions</span>: <span class="hljs-type">UIScene</span>.<span class="hljs-type">ConnectionOptions</span>) {
        
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> windowScene <span class="hljs-operator">=</span> scene <span class="hljs-keyword">as?</span> <span class="hljs-type">UIWindowScene</span> <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }
        
        <span class="hljs-comment">// æ ¹æ®åœºæ™¯è§’è‰²è‡ªå®šä¹‰é…ç½®</span>
        <span class="hljs-keyword">if</span> session.role <span class="hljs-operator">==</span> .windowApplication {
            configureApplicationWindow(scene: windowScene, 
                                      session: session, 
                                      options: connectionOptions)
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> session.role <span class="hljs-operator">==</span> .windowExternalDisplay {
            configureExternalDisplayWindow(scene: windowScene)
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">configureApplicationWindow</span>(<span class="hljs-params">scene</span>: <span class="hljs-type">UIWindowScene</span>,
                                          <span class="hljs-params">session</span>: <span class="hljs-type">UISceneSession</span>,
                                          <span class="hljs-params">options</span>: <span class="hljs-type">UIScene</span>.<span class="hljs-type">ConnectionOptions</span>) {
        <span class="hljs-comment">// ä¸»çª—å£é…ç½®</span>
        <span class="hljs-keyword">let</span> window <span class="hljs-operator">=</span> <span class="hljs-type">UIWindow</span>(windowScene: scene)
        
        <span class="hljs-comment">// æ ¹æ®ç”¨æˆ·æ´»åŠ¨æ¢å¤çŠ¶æ€</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> userActivity <span class="hljs-operator">=</span> options.userActivities.first {
            window.rootViewController <span class="hljs-operator">=</span> restoreViewController(from: userActivity)
        } <span class="hljs-keyword">else</span> {
            window.rootViewController <span class="hljs-operator">=</span> <span class="hljs-type">UIViewController</span>()
        }
        
        window.makeKeyAndVisible()
        <span class="hljs-keyword">self</span>.window <span class="hljs-operator">=</span> window
    }
}
</code></pre>
<h2 data-id="heading-9">åœºæ™¯é—´é€šä¿¡ä¸æ•°æ®å…±äº«</h2>
<h3 data-id="heading-10">1. ä½¿ç”¨ UserActivity ä¼ é€’æ•°æ®</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DocumentViewController</span>: <span class="hljs-title class_">UIViewController</span> {
    <span class="hljs-keyword">var</span> document: <span class="hljs-type">Document</span>?
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">openInNewWindow</span>() {
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> document <span class="hljs-operator">=</span> document <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }
        
        <span class="hljs-keyword">let</span> userActivity <span class="hljs-operator">=</span> <span class="hljs-type">NSUserActivity</span>(activityType: <span class="hljs-string">"com.yourapp.editDocument"</span>)
        userActivity.title <span class="hljs-operator">=</span> <span class="hljs-string">"Editing <span class="hljs-subst">\(document.title)</span>"</span>
        userActivity.userInfo <span class="hljs-operator">=</span> [<span class="hljs-string">"documentId"</span>: document.id]
        userActivity.targetContentIdentifier <span class="hljs-operator">=</span> document.id
        
        <span class="hljs-keyword">let</span> options <span class="hljs-operator">=</span> <span class="hljs-type">UIScene</span>.<span class="hljs-type">ActivationRequestOptions</span>()
        <span class="hljs-type">UIApplication</span>.shared.requestSceneSessionActivation(
            <span class="hljs-literal">nil</span>,
            userActivity: userActivity,
            options: options,
            errorHandler: <span class="hljs-literal">nil</span>
        )
    }
}

<span class="hljs-comment">// åœ¨ SceneDelegate ä¸­å¤„ç†</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">scene</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">scene</span>: <span class="hljs-type">UIScene</span>, <span class="hljs-params">continue</span> <span class="hljs-params">userActivity</span>: <span class="hljs-type">NSUserActivity</span>) {
    <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> windowScene <span class="hljs-operator">=</span> scene <span class="hljs-keyword">as?</span> <span class="hljs-type">UIWindowScene</span>,
          <span class="hljs-keyword">let</span> documentId <span class="hljs-operator">=</span> userActivity.userInfo<span class="hljs-operator">?</span>[<span class="hljs-string">"documentId"</span>] <span class="hljs-keyword">as?</span> <span class="hljs-type">String</span> <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span>
    }
    
    <span class="hljs-keyword">let</span> document <span class="hljs-operator">=</span> fetchDocument(by: documentId)
    <span class="hljs-keyword">let</span> editorVC <span class="hljs-operator">=</span> <span class="hljs-type">DocumentEditorViewController</span>(document: document)
    windowScene.windows.first<span class="hljs-operator">?</span>.rootViewController <span class="hljs-operator">=</span> editorVC
}
</code></pre>
<h3 data-id="heading-11">2. ä½¿ç”¨é€šçŸ¥ä¸­å¿ƒé€šä¿¡</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">extension</span> <span class="hljs-title class_">Notification</span>.<span class="hljs-title class_">Name</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">let</span> documentDidChange <span class="hljs-operator">=</span> <span class="hljs-type">Notification</span>.<span class="hljs-type">Name</span>(<span class="hljs-string">"documentDidChange"</span>)
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">let</span> sceneDidBecomeActive <span class="hljs-operator">=</span> <span class="hljs-type">Notification</span>.<span class="hljs-type">Name</span>(<span class="hljs-string">"sceneDidBecomeActive"</span>)
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">DocumentManager</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">let</span> shared <span class="hljs-operator">=</span> <span class="hljs-type">DocumentManager</span>()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">init</span>() {}
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">updateDocument</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">document</span>: <span class="hljs-type">Document</span>) {
        <span class="hljs-comment">// æ›´æ–°æ•°æ®</span>
        <span class="hljs-type">NotificationCenter</span>.default.post(
            name: .documentDidChange,
            object: <span class="hljs-literal">nil</span>,
            userInfo: [<span class="hljs-string">"document"</span>: document]
        )
    }
}
</code></pre>
<h2 data-id="heading-12">é«˜çº§åŠŸèƒ½</h2>
<h3 data-id="heading-13">1. å¤–éƒ¨æ˜¾ç¤ºå™¨æ”¯æŒ</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ExternalDisplayManager</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">setupExternalDisplay</span>() {
        <span class="hljs-comment">// ç›‘å¬å¤–éƒ¨æ˜¾ç¤ºå™¨è¿æ¥</span>
        <span class="hljs-type">NotificationCenter</span>.default.addObserver(
            <span class="hljs-keyword">self</span>,
            selector: <span class="hljs-keyword">#selector</span>(handleScreenConnect),
            name: <span class="hljs-type">UIScreen</span>.didConnectNotification,
            object: <span class="hljs-literal">nil</span>
        )
    }
    
    <span class="hljs-keyword">@objc</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">handleScreenConnect</span>(<span class="hljs-params">notification</span>: <span class="hljs-type">Notification</span>) {
        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> newScreen <span class="hljs-operator">=</span> notification.object <span class="hljs-keyword">as?</span> <span class="hljs-type">UIScreen</span>,
              newScreen <span class="hljs-operator">!=</span> <span class="hljs-type">UIScreen</span>.main <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }
        
        <span class="hljs-keyword">let</span> options <span class="hljs-operator">=</span> <span class="hljs-type">UIScene</span>.<span class="hljs-type">ActivationRequestOptions</span>()
        options.requestingScene <span class="hljs-operator">=</span> <span class="hljs-type">UIApplication</span>.shared.connectedScenes.first <span class="hljs-keyword">as?</span> <span class="hljs-type">UIWindowScene</span>
        
        <span class="hljs-keyword">let</span> activity <span class="hljs-operator">=</span> <span class="hljs-type">NSUserActivity</span>(activityType: <span class="hljs-string">"externalDisplay"</span>)
        <span class="hljs-type">UIApplication</span>.shared.requestSceneSessionActivation(
            <span class="hljs-literal">nil</span>,
            userActivity: activity,
            options: options,
            errorHandler: <span class="hljs-literal">nil</span>
        )
    }
}

<span class="hljs-comment">// åœ¨ SceneDelegate ä¸­é…ç½®å¤–éƒ¨æ˜¾ç¤ºå™¨åœºæ™¯</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">configureExternalDisplayWindow</span>(<span class="hljs-params">scene</span>: <span class="hljs-type">UIWindowScene</span>) {
    <span class="hljs-keyword">let</span> window <span class="hljs-operator">=</span> <span class="hljs-type">UIWindow</span>(windowScene: scene)
    window.screen <span class="hljs-operator">=</span> <span class="hljs-type">UIScreen</span>.screens.last <span class="hljs-comment">// ä½¿ç”¨å¤–éƒ¨æ˜¾ç¤ºå™¨</span>
    window.rootViewController <span class="hljs-operator">=</span> <span class="hljs-type">ExternalDisplayViewController</span>()
    window.makeKeyAndVisible()
}
</code></pre>
<h3 data-id="heading-14">2. åœºæ™¯çŠ¶æ€ä¿å­˜ä¸æ¢å¤</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SceneDelegate</span>: <span class="hljs-title class_">UIResponder</span>, <span class="hljs-title class_">UIWindowSceneDelegate</span> {
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">stateRestorationActivity</span>(<span class="hljs-params">for</span> <span class="hljs-params">scene</span>: <span class="hljs-type">UIScene</span>) -&gt; <span class="hljs-type">NSUserActivity</span>? {
        <span class="hljs-comment">// è¿”å›ç”¨äºæ¢å¤åœºæ™¯çŠ¶æ€çš„ activity</span>
        <span class="hljs-keyword">let</span> activity <span class="hljs-operator">=</span> <span class="hljs-type">NSUserActivity</span>(activityType: <span class="hljs-string">"restoration"</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> rootVC <span class="hljs-operator">=</span> window<span class="hljs-operator">?</span>.rootViewController <span class="hljs-keyword">as?</span> <span class="hljs-type">Restorable</span> {
            activity.addUserInfoEntries(from: rootVC.restorationInfo)
        }
        <span class="hljs-keyword">return</span> activity
    }
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">scene</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">scene</span>: <span class="hljs-type">UIScene</span>, 
               <span class="hljs-params">willConnectTo</span> <span class="hljs-params">session</span>: <span class="hljs-type">UISceneSession</span>, 
               <span class="hljs-params">options</span> <span class="hljs-params">connectionOptions</span>: <span class="hljs-type">UIScene</span>.<span class="hljs-type">ConnectionOptions</span>) {
        
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰ä¿å­˜çš„çŠ¶æ€</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> restorationActivity <span class="hljs-operator">=</span> session.stateRestorationActivity {
            restoreState(from: restorationActivity)
        }
    }
}
</code></pre>
<h2 data-id="heading-15">æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-16">1. å†…å­˜ç®¡ç†</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryAwareSceneDelegate</span>: <span class="hljs-title class_">UIResponder</span>, <span class="hljs-title class_">UIWindowSceneDelegate</span> {
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">sceneDidEnterBackground</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">scene</span>: <span class="hljs-type">UIScene</span>) {
        <span class="hljs-comment">// é‡Šæ”¾ä¸å¿…è¦çš„èµ„æº</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> vc <span class="hljs-operator">=</span> window<span class="hljs-operator">?</span>.rootViewController <span class="hljs-keyword">as?</span> <span class="hljs-type">MemoryManageable</span> {
            vc.releaseUnnecessaryResources()
        }
    }
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">sceneWillEnterForeground</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">scene</span>: <span class="hljs-type">UIScene</span>) {
        <span class="hljs-comment">// æ¢å¤å¿…è¦çš„èµ„æº</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> vc <span class="hljs-operator">=</span> window<span class="hljs-operator">?</span>.rootViewController <span class="hljs-keyword">as?</span> <span class="hljs-type">MemoryManageable</span> {
            vc.restoreResources()
        }
    }
}
</code></pre>
<h3 data-id="heading-17">2. é”™è¯¯å¤„ç†</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">SceneError</span>: <span class="hljs-title class_">Error</span> {
    <span class="hljs-keyword">case</span> sceneCreationFailed
    <span class="hljs-keyword">case</span> invalidConfiguration
    <span class="hljs-keyword">case</span> resourceUnavailable
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">RobustSceneManager</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">createSceneSafely</span>(<span class="hljs-params">configuration</span>: <span class="hljs-type">UISceneConfiguration</span>,
                                <span class="hljs-params">completion</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">Result</span>&lt;<span class="hljs-type">UIWindowScene</span>, <span class="hljs-type">SceneError</span>&gt;) -&gt; <span class="hljs-type">Void</span>) {
        
        <span class="hljs-keyword">let</span> options <span class="hljs-operator">=</span> <span class="hljs-type">UIScene</span>.<span class="hljs-type">ActivationRequestOptions</span>()
        
        <span class="hljs-type">UIApplication</span>.shared.requestSceneSessionActivation(
            <span class="hljs-literal">nil</span>,
            userActivity: <span class="hljs-literal">nil</span>,
            options: options
        ) { error <span class="hljs-keyword">in</span>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> error <span class="hljs-operator">=</span> error {
                completion(.failure(.sceneCreationFailed))
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// ç›‘æ§æ–°åœºæ™¯åˆ›å»º</span>
                <span class="hljs-type">DispatchQueue</span>.main.asyncAfter(deadline: .now() <span class="hljs-operator">+</span> <span class="hljs-number">0.5</span>) {
                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> newScene <span class="hljs-operator">=</span> <span class="hljs-type">UIApplication</span>.shared.connectedScenes
                        .compactMap({ <span class="hljs-variable">$0</span> <span class="hljs-keyword">as?</span> <span class="hljs-type">UIWindowScene</span> })
                        .last {
                        completion(.success(newScene))
                    } <span class="hljs-keyword">else</span> {
                        completion(.failure(.sceneCreationFailed))
                    }
                }
            }
        }
    }
}
</code></pre>
<h2 data-id="heading-18">è°ƒè¯•æŠ€å·§</h2>
<h3 data-id="heading-19">1. åœºæ™¯ä¿¡æ¯æ—¥å¿—</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">extension</span> <span class="hljs-title class_">UIWindowScene</span> {
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">logSceneInfo</span>() {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"""
        Scene Information:
        - Session: <span class="hljs-subst">\(session)</span>
        - Role: <span class="hljs-subst">\(session.role)</span>
        - Windows: <span class="hljs-subst">\(windows.count)</span>
        - Screen: <span class="hljs-subst">\(screen)</span>
        - Activation State: <span class="hljs-subst">\(activationState)</span>
        """</span>)
    }
}

<span class="hljs-comment">// åœ¨ AppDelegate ä¸­ç›‘æ§æ‰€æœ‰åœºæ™¯</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">application</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">application</span>: <span class="hljs-type">UIApplication</span>, 
               <span class="hljs-params">configurationForConnecting</span> <span class="hljs-params">connectingSceneSession</span>: <span class="hljs-type">UISceneSession</span>,
               <span class="hljs-params">options</span>: <span class="hljs-type">UIScene</span>.<span class="hljs-type">ConnectionOptions</span>) -&gt; <span class="hljs-type">UISceneConfiguration</span> {
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"Connecting scene: <span class="hljs-subst">\(connectingSceneSession)</span>"</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-type">UISceneConfiguration</span>(
        name: <span class="hljs-string">"Default Configuration"</span>,
        sessionRole: connectingSceneSession.role
    )
}
</code></pre>
<h3 data-id="heading-20">2. å†…å­˜æ³„æ¼æ£€æµ‹</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SceneLeakDetector</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">var</span> activeScenes: [<span class="hljs-type">String</span>: <span class="hljs-type">WeakReference</span>&lt;<span class="hljs-type">UIWindowScene</span>&gt;] <span class="hljs-operator">=</span> [:]
    
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">trackScene</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">scene</span>: <span class="hljs-type">UIWindowScene</span>) {
        <span class="hljs-keyword">let</span> identifier <span class="hljs-operator">=</span> <span class="hljs-string">"<span class="hljs-subst">\(ObjectIdentifier(scene).hashValue)</span>"</span>
        activeScenes[identifier] <span class="hljs-operator">=</span> <span class="hljs-type">WeakReference</span>(object: scene)
        
        <span class="hljs-comment">// å®šæœŸæ£€æŸ¥æ³„æ¼</span>
        <span class="hljs-type">DispatchQueue</span>.main.asyncAfter(deadline: .now() <span class="hljs-operator">+</span> <span class="hljs-number">5</span>) {
            <span class="hljs-keyword">self</span>.checkForLeaks()
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">checkForLeaks</span>() {
        activeScenes <span class="hljs-operator">=</span> activeScenes.filter { <span class="hljs-variable">$0</span>.value.object <span class="hljs-operator">!=</span> <span class="hljs-literal">nil</span> }
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"Active scenes: <span class="hljs-subst">\(activeScenes.count)</span>"</span>)
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">WeakReference</span>&lt;<span class="hljs-title class_">T</span>: <span class="hljs-title class_">AnyObject</span>&gt; {
    <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> object: <span class="hljs-type">T</span>?
    <span class="hljs-keyword">init</span>(<span class="hljs-params">object</span>: <span class="hljs-type">T</span>) {
        <span class="hljs-keyword">self</span>.object <span class="hljs-operator">=</span> object
    }
}
</code></pre>
<h2 data-id="heading-21">å…¼å®¹æ€§è€ƒè™‘</h2>
<h3 data-id="heading-22">1. å‘åå…¼å®¹ iOS 12</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">@available</span>(<span class="hljs-keyword">iOS</span> <span class="hljs-number">13.0</span>, <span class="hljs-operator">*</span>)
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ModernSceneDelegate</span>: <span class="hljs-title class_">UIResponder</span>, <span class="hljs-title class_">UIWindowSceneDelegate</span> {
    <span class="hljs-comment">// iOS 13+ å®ç°</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AppDelegate</span>: <span class="hljs-title class_">UIResponder</span>, <span class="hljs-title class_">UIApplicationDelegate</span> {
    <span class="hljs-keyword">var</span> window: <span class="hljs-type">UIWindow</span>?
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">application</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">application</span>: <span class="hljs-type">UIApplication</span>, 
                   <span class="hljs-params">didFinishLaunchingWithOptions</span> <span class="hljs-params">launchOptions</span>: [<span class="hljs-type">UIApplication</span>.<span class="hljs-params">LaunchOptionsKey</span>: <span class="hljs-keyword">Any</span>]<span class="hljs-operator">?</span>) -&gt; <span class="hljs-type">Bool</span> {
        
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">#available</span>(<span class="hljs-keyword">iOS</span> <span class="hljs-number">13.0</span>, <span class="hljs-operator">*</span>) {
            <span class="hljs-comment">// ä½¿ç”¨åœºæ™¯æ¶æ„</span>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// ä¼ ç»Ÿ UIWindow è®¾ç½®</span>
            window <span class="hljs-operator">=</span> <span class="hljs-type">UIWindow</span>(frame: <span class="hljs-type">UIScreen</span>.main.bounds)
            window<span class="hljs-operator">?</span>.rootViewController <span class="hljs-operator">=</span> <span class="hljs-type">UIViewController</span>()
            window<span class="hljs-operator">?</span>.makeKeyAndVisible()
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    }
}
</code></pre>
<h2 data-id="heading-23">ç»“è¯­</h2>
<p>UIWindowScene æ¶æ„ä¸º iOS åº”ç”¨å¸¦æ¥äº†å¼ºå¤§çš„å¤šçª—å£æ”¯æŒï¼Œç‰¹åˆ«é€‚åˆ iPadOS å’Œéœ€è¦å¤æ‚å¤šä»»åŠ¡å¤„ç†çš„åº”ç”¨ã€‚é€šè¿‡åˆç†ä½¿ç”¨åœºæ™¯ç®¡ç†ï¼Œå¯ä»¥ï¼š</p>
<ol>
<li>æä¾›æ›´å¥½çš„å¤šä»»åŠ¡ä½“éªŒ</li>
<li>æ”¯æŒå¤–éƒ¨æ˜¾ç¤ºå™¨</li>
<li>å®ç°é«˜æ•ˆçš„çŠ¶æ€ä¿å­˜ä¸æ¢å¤</li>
<li>ä¼˜åŒ–å†…å­˜ä½¿ç”¨</li>
</ol>
<p>è™½ç„¶å­¦ä¹ æ›²çº¿è¾ƒé™¡ï¼Œä½†æŒæ¡ UIWindowScene å°†æ˜¾è‘—æå‡åº”ç”¨çš„ç°ä»£åŒ–æ°´å¹³å’Œç”¨æˆ·ä½“éªŒã€‚</p>
<hr/>
<p><strong>ç¤ºä¾‹é¡¹ç›®</strong>: å®Œæ•´çš„ç¤ºä¾‹ä»£ç å¯ä»¥åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fexample%2FUIWindowSceneDemo" target="_blank" title="https://github.com/example/UIWindowSceneDemo" ref="nofollow noopener noreferrer">GitHub ä»“åº“</a> æ‰¾åˆ°ã€‚</p>
<p><strong>è¿›ä¸€æ­¥é˜…è¯»</strong>:</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Fuikit%2Fuiwindowscene" target="_blank" title="https://developer.apple.com/documentation/uikit/uiwindowscene" ref="nofollow noopener noreferrer">Apple å®˜æ–¹æ–‡æ¡£ - UIWindowScene</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Fuikit%2Fapp_and_environment%2Fscenes" target="_blank" title="https://developer.apple.com/documentation/uikit/app_and_environment/scenes" ref="nofollow noopener noreferrer">Apple å®˜æ–¹æ–‡æ¡£ - å¤šåœºæ™¯æ”¯æŒ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fvideos%2Fplay%2Fwwdc2019%2F258%2F" target="_blank" title="https://developer.apple.com/videos/play/wwdc2019/258/" ref="nofollow noopener noreferrer">WWDC 2019 - åœ¨å¤šä»»åŠ¡ç¯å¢ƒä¸­ä½¿ç”¨åœºæ™¯</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨Amazon Q Developer CLIå¿«é€Ÿæ„å»ºå¸‚åœºåˆ†ææ™ºèƒ½ä½“]]></title>    <link>https://juejin.cn/post/7585377403633025070</link>    <guid>https://juejin.cn/post/7585377403633025070</guid>    <pubDate>2025-12-19T12:39:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585377403633025070" data-draft-id="7585406229167439922" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨Amazon Q Developer CLIå¿«é€Ÿæ„å»ºå¸‚åœºåˆ†ææ™ºèƒ½ä½“"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-19T12:39:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äºšé©¬é€Šäº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2850395271209496"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨Amazon Q Developer CLIå¿«é€Ÿæ„å»ºå¸‚åœºåˆ†ææ™ºèƒ½ä½“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2850395271209496/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äºšé©¬é€Šäº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T12:39:40.000Z" title="Fri Dec 19 2025 12:39:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fs3.cn-north-1.amazonaws.com.cn%2Fawschinablog%2Fblogbanner-newnew.png" target="_blank" title="https://s3.cn-north-1.amazonaws.com.cn/awschinablog/blogbanner-newnew.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be3d21ccc9c644ddbc9ce1eb6ab636e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766752780&amp;x-signature=mwmTbr%2FmuXadCh8FTzVdpZlnAtE%3D" alt="" loading="lazy"/></a></p>
<h2 data-id="heading-0">1. ä»€ä¹ˆæ˜¯Amazon Q Developer CLI</h2>
<p>Amazon Q Developer CLIæ˜¯ä¸€æ¬¾ç”±äºšé©¬é€Šäº‘ç§‘æŠ€æ¨å‡ºçš„åŸºäºç”Ÿæˆå¼äººå·¥æ™ºèƒ½çš„å‘½ä»¤è¡Œå¼€å‘å·¥å…·ã€‚å®ƒæ”¯æŒå¤šAgentæ¶æ„ï¼Œå…è®¸å¼€å‘è€…é€šè¿‡è‡ªç„¶è¯­è¨€äº¤äº’è°ƒåº¦ä¸åŒæ™ºèƒ½Agentå®Œæˆä»£ç ç”Ÿæˆã€æµ‹è¯•ã€å®¡æŸ¥ã€ä»»åŠ¡è‡ªåŠ¨åŒ–ç­‰åŠŸèƒ½ã€‚CLIæ·±åº¦é›†æˆäºšé©¬é€Šäº‘ç§‘æŠ€åŠæœ¬åœ°ç³»ç»Ÿå·¥å…·ï¼Œæ”¯æŒå¤æ‚å¤šè½®ä¸Šä¸‹æ–‡ç®¡ç†ï¼Œé€‚é…Linuxï¼ˆUbuntu 20/22/24ï¼‰ã€macOSç­‰ç¯å¢ƒï¼Œæå¤§æå‡æ™ºèƒ½åŒ–å¼€å‘å’Œè¿ç»´æ•ˆç‡ã€‚</p>
<blockquote>
<p>ğŸ“¢é™æ—¶æ’æ’­ï¼šAmazon Q Developer æ¥å¸®ä½ åšåº”ç”¨å•¦ï¼</p>
<p>ğŸŒŸ10åˆ†é’Ÿå¸®ä½ æ„å»ºæ™ºèƒ½ç•ªèŒ„é’Ÿåº”ç”¨ï¼Œ1å°æ—¶æå®šæ–°åŠŸèƒ½æ‹“å±•ã€æµ‹è¯•ä¼˜åŒ–ã€æ–‡æ¡£æ³¨ç¨‹å’Œéƒ¨ç½²</p>
<p>â©å¿«å¿«ç‚¹å‡»è¿›å…¥ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Fevents.amazoncloud.cn%2Flabs%2Fcloudlab-amazon-q-cli-and-ide-build%3Fvisitfrom%3D3P_Juejinhead_1216%26sc_medium%3Downed%26sc_campaign%3Dcloudlab%26sc_channel%3D3P_Juejinhead_1216" target="_blank" title="https://events.amazoncloud.cn/labs/cloudlab-amazon-q-cli-and-ide-build?visitfrom=3P_Juejinhead_1216&amp;sc_medium=owned&amp;sc_campaign=cloudlab&amp;sc_channel=3P_Juejinhead_1216" ref="nofollow noopener noreferrer">Agentic Al å¸®ä½ åšåº”ç”¨ -- ä»0åˆ°1æ‰“é€ è‡ªå·±çš„æ™ºèƒ½ç•ªèŒ„é’Ÿ</a>ã€‹å®éªŒ</p>
<p>å…è´¹ä½“éªŒä¼ä¸šçº§ AI å¼€å‘å·¥å…·çš„çœŸå®æ•ˆæœå§</p>
<p>æ„å»ºæ— é™ï¼Œæ¢ç´¢å¯ç¨‹!</p>
</blockquote>
<h2 data-id="heading-1">2. éœ€æ±‚åœºæ™¯ä¸æŒ‘æˆ˜åˆ†æ</h2>
<p>ç°ä»£ä¼ä¸šå¸‚åœºåˆ†æå·¥ä½œé¢ä¸´å¤šç»´åº¦æŒ‘æˆ˜ï¼š</p>
<ul>
<li>ä¸šåŠ¡ä»»åŠ¡å¤šæ ·ï¼Œæ¶‰åŠè¡Œä¸šè°ƒç ”ã€ç«å“åˆ†æã€å…¬å…³å±æœºå¤„ç†ã€å®šå‘è¥é”€ç­‰å¤šä¸ªä¸“ä¸šé¢†åŸŸï¼›</li>
<li>æ•°æ®é‡åºå¤§ä¸”åˆ†æ•£ï¼Œä¿¡æ¯æ¥æºå¤šæ ·ï¼Œæ£€ç´¢ä¸åˆ†ææ•ˆç‡ä½ï¼Œå†³ç­–ä¾èµ–äººå·¥ç»éªŒï¼›</li>
<li>å¤šä»»åŠ¡åä½œå¤æ‚ï¼Œéœ€è¦å¤šè§’è‰²ä¸“ä¸šçŸ¥è¯†èåˆï¼Œäººå·¥ååŒæ•ˆç‡ä½ä¸”æ˜“å‡ºé”™ï¼›</li>
<li>è‡ªåŠ¨åŒ–ã€æ™ºèƒ½åŒ–éœ€æ±‚æå‡ï¼Œéœ€è¦åŸºäºä¸Šä¸‹æ–‡çš„ç²¾å‡†æ™ºèƒ½è·¯ç”±ä¸ä»»åŠ¡è°ƒåº¦ï¼Œå‡å°‘é‡å¤åŠ³åŠ¨ã€‚</li>
</ul>
<h2 data-id="heading-2">3. åŸºäºAmazon Q Developer CLIå®šåˆ¶åŒ–Agent +å®‰ç•…AI Searchè§£å†³æ–¹æ¡ˆ</h2>
<p>Amazon Q Developer CLI ä½œä¸ºæ ¸å¿ƒæ§åˆ¶é¢ï¼Œç»Ÿä¸€è°ƒåº¦å¤šæ™ºèƒ½ä½“ï¼ˆAgentsï¼‰ã€å¤–éƒ¨å¤§æ¨¡å‹ä¸çŸ¥è¯†æ£€ç´¢æœåŠ¡ã€‚ç”¨æˆ·å¯é€šè¿‡ Feishu ç­‰åä½œå¹³å°æ¥å…¥ï¼Œé€šè¿‡æ™ºèƒ½è·¯ç”±å°†è¯·æ±‚åˆ†å‘è‡³æœ€åˆé€‚çš„ Agentï¼Œç»“åˆæ¨¡å‹ç”Ÿæˆä¸è”ç½‘æœç´¢å¢å¼ºï¼Œè¾“å‡ºä¸“ä¸šåŒ–ã€å¯ä¿¡çš„ç»“æœï¼ŒæœåŠ¡å¼€å‘è€…ä¸ä¸šåŠ¡ç”¨æˆ·ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anchnet.com%2F" target="_blank" title="https://www.anchnet.com/" ref="nofollow noopener noreferrer">å®‰ç•…</a><a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.anspire.cn%2F" target="_blank" title="https://open.anspire.cn/" ref="nofollow noopener noreferrer">Anspire</a>Â Openå¼€æ”¾å¹³å°ä¸ºå¼€å‘è€…æä¾›æ„å»ºå¼ºå¤§æ™ºèƒ½ä½“æ‰€éœ€çš„æ ¸å¿ƒèƒ½åŠ›æ ˆï¼Œç°å·²ä¸Šçº¿AIè”ç½‘æœç´¢ã€å¤šè½®æ”¹å†™ã€äº‘ç«¯æµè§ˆå™¨è‡ªåŠ¨åŒ–ï¼ˆAnspire Browser Agentï¼‰ç­‰æœåŠ¡,å¯æ— ç¼é›†æˆè‡³Amazon Q Developer CLIã€Strands Agentsã€Bedrock AgentCoreã€Difyã€ç­‰ä¸»æµæ™ºèƒ½ä½“å¹³å°ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fd2908q01vomqb2.cloudfront.net%2F472b07b9fcf2c2451e8781e944bf5f77cd8457c8%2F2025%2F10%2F28%2Fcli-1.png" target="_blank" title="https://d2908q01vomqb2.cloudfront.net/472b07b9fcf2c2451e8781e944bf5f77cd8457c8/2025/10/28/cli-1.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ec976406718421f9e0e3c42e4cd7cf5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766752780&amp;x-signature=ZZpsH7GY0zBhXx7Au27KYM%2BKQTY%3D" alt="" loading="lazy"/></a>
æ¶æ„ç»„ä»¶</p>
<ul>
<li><strong>Amazon Q Developer CLI</strong>ï¼šæ ¸å¿ƒè°ƒåº¦ä¸ç»Ÿä¸€å…¥å£ï¼Œç®¡ç†ä»»åŠ¡åˆ†å‘å’Œç»“æœèšåˆã€‚</li>
<li><strong>Agents</strong> <strong>ï¼ˆå¤šæ™ºèƒ½ä½“ï¼‰</strong> ï¼šåŒ…æ‹¬é»˜è®¤åŠ©æ‰‹ã€å¸‚åœºåˆ†æã€è¥é”€ç­–åˆ’ã€å…¬å…³æ”¯æŒç­‰ï¼ŒæŒ‰èŒè´£æ‰§è¡Œä¸“é—¨ä»»åŠ¡ï¼Œæ”¯æŒæ‰©å±•ã€‚</li>
<li><strong>Intelligent Router</strong>ï¼šåŸºäºæ™ºèƒ½è·¯ç”±ç­–ç•¥è§„åˆ™ï¼Œå°†ä»»åŠ¡è·¯ç”±è‡³æœ€åˆé€‚çš„ Agentã€‚</li>
<li><strong>å¤–éƒ¨å¤§æ¨¡å‹ï¼ˆ</strong> <strong>Claude</strong> <strong>ï¼‰</strong> ï¼šåŸºäºAmazon Qé»˜è®¤é›†æˆçš„Claudeå¤§æ¨¡å‹èƒ½åŠ›è¿›è¡Œå¼€å‘ã€‚</li>
<li><strong>MCP Server</strong> <strong>ï¼ˆæ™ºèƒ½æœç´¢ï¼‰</strong> ï¼šå®ç°å®æ—¶è”ç½‘æ£€ç´¢ä¸çŸ¥è¯†å¢å¼ºï¼Œæé«˜ç»“æœå‡†ç¡®æ€§ã€‚</li>
<li><strong>Nginx</strong>ï¼šç½‘å…³ä¸å®‰å…¨ä»£ç†ï¼Œè´Ÿè´£æµé‡æ§åˆ¶ä¸é‰´æƒã€‚</li>
<li><strong>Feishu Bot</strong>ï¼šä¼ä¸šåä½œå…¥å£ï¼Œæ”¯æŒç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯ç”¨æˆ·æ¥å…¥ã€‚</li>
<li><strong>å¼€å‘è€…ç”¨æˆ·</strong>ï¼šé€šè¿‡ CLI ç›´æ¥è°ƒè¯•å’Œæ‰©å±•æ™ºèƒ½ä½“ã€‚</li>
</ul>
<h2 data-id="heading-3">4. Amazon Q Developer CLI Linuxç‰ˆæœ¬å®‰è£…é…ç½®</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fd2908q01vomqb2.cloudfront.net%2F472b07b9fcf2c2451e8781e944bf5f77cd8457c8%2F2025%2F10%2F28%2Fcli-2.png" target="_blank" title="https://d2908q01vomqb2.cloudfront.net/472b07b9fcf2c2451e8781e944bf5f77cd8457c8/2025/10/28/cli-2.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d9a99f42a4448e2a40b822a7f371c50~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766752780&amp;x-signature=0t3bYVqyI%2F9LQ%2F6g%2BH5xsVDD198%3D" alt="" loading="lazy"/></a></p>
<h2 data-id="heading-4">5. å®šåˆ¶å¤šAgentæ¶æ„</h2>
<p>é…ç½®åŒ…å«â€œå¸‚åœºåˆ†æå¸ˆï¼ˆmarket-analystï¼‰â€ã€â€œå…¬å…³ä¸“å‘˜ï¼ˆpr-specialistï¼‰â€ã€â€œè¥é”€ç­–åˆ’ï¼ˆmarketing-specialistï¼‰â€ç­‰ä¸“ä¸šAgentï¼Œåˆ†åˆ«èšç„¦è¡Œä¸šç ”ç©¶ã€å“ç‰Œä¼ æ’­ã€è¥é”€ç­–ç•¥ç­‰ä»»åŠ¡ï¼Œé€šè¿‡æ™ºèƒ½è·¯ç”±å™¨æ ¹æ®ä¸Šä¸‹æ–‡çµæ´»åˆ†é…ä»»åŠ¡ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fd2908q01vomqb2.cloudfront.net%2F472b07b9fcf2c2451e8781e944bf5f77cd8457c8%2F2025%2F10%2F28%2Fcli-3.png" target="_blank" title="https://d2908q01vomqb2.cloudfront.net/472b07b9fcf2c2451e8781e944bf5f77cd8457c8/2025/10/28/cli-3.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df8586b4011d4f68a3f86cf27cd0c128~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766752780&amp;x-signature=t12rMsfsU2fKlLdso%2B1nCdTv5wA%3D" alt="" loading="lazy"/></a></p>
<pre><code class="hljs language-JSON" lang="JSON">market-analyst Agentï¼š
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"market-analyst"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"èµ„æ·±å¸‚åœºåˆ†æå¸ˆï¼Œå…·å¤‡15å¹´+è¡Œä¸šç»éªŒï¼Œä¸“ç²¾æˆ˜ç•¥å’¨è¯¢ã€æŠ•èµ„åˆ†æã€å•†ä¸šæ´å¯Ÿ"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"prompt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ æ˜¯èµ„æ·±å¸‚åœºåˆ†æå¸ˆï¼Œæ‹¥æœ‰15å¹´+è·¨è¡Œä¸šåˆ†æç»éªŒï¼Œæ›¾æœåŠ¡äºéº¦è‚¯é”¡ã€è´æ©ç­‰é¡¶çº§å’¨è¯¢å…¬å¸ã€‚\n\nğŸ¯ **æ ¸å¿ƒä¸“é•¿**ï¼š\nâ€¢ **è¡Œä¸šæ·±åº¦ç ”ç©¶**ï¼šTAM/SAM/SOMå¸‚åœºè§„æ¨¡æµ‹ç®—ã€äº§ä¸šé“¾åˆ†æã€ä»·å€¼é“¾é‡æ„\nâ€¢ **ç«äº‰æƒ…æŠ¥åˆ†æ**ï¼šç«å“æˆ˜ç•¥è§£æ„ã€æŠ¤åŸæ²³è¯„ä¼°ã€å¸‚åœºä»½é¢åŠ¨æ€è¿½è¸ª\nâ€¢ **å•†ä¸šæ¨¡å¼æ´å¯Ÿ**ï¼šç›ˆåˆ©æ¨¡å¼åˆ›æ–°ã€å•ä½ç»æµæ¨¡å‹ã€LTV/CACä¼˜åŒ–\nâ€¢ **æŠ•èµ„ä»·å€¼è¯„ä¼°**ï¼šDCFä¼°å€¼æ¨¡å‹ã€å¯æ¯”å…¬å¸åˆ†æã€é£é™©æ”¶ç›Šè¯„ä¼°\nâ€¢ **æˆ˜ç•¥è§„åˆ’åˆ¶å®š**ï¼šè“æµ·æˆ˜ç•¥ã€å·®å¼‚åŒ–å®šä½ã€å¢é•¿è·¯å¾„è®¾è®¡\n\nğŸ“Š **åˆ†ææ–¹æ³•è®º**ï¼š\nâ€¢ **å®šé‡åˆ†æ**ï¼šå›å½’åˆ†æã€æ—¶é—´åºåˆ—é¢„æµ‹ã€è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿã€æ•æ„Ÿæ€§åˆ†æ\nâ€¢ **å®šæ€§æ¡†æ¶**ï¼šæ³¢ç‰¹äº”åŠ›ã€SWOT-TOWSã€PEST-STEEPã€ä»·å€¼ç½‘ç»œåˆ†æ\nâ€¢ **æˆ˜ç•¥å·¥å…·**ï¼šBCGçŸ©é˜µã€GE-McKinseyçŸ©é˜µã€å®‰ç´¢å¤«çŸ©é˜µã€å•†ä¸šç”»å¸ƒ\nâ€¢ **é¢„æµ‹æ¨¡å‹**ï¼šBassæ‰©æ•£æ¨¡å‹ã€Sæ›²çº¿åˆ†æã€æŠ€æœ¯æˆç†Ÿåº¦æ›²çº¿\n\nğŸ” **è¾“å‡ºæ ‡å‡†**ï¼š\nâ€¢ **æ‰§è¡Œæ‘˜è¦**ï¼š3-5ä¸ªæ ¸å¿ƒæ´å¯Ÿï¼Œç›´å‡»å•†ä¸šæœ¬è´¨\nâ€¢ **æ•°æ®æ”¯æ’‘**ï¼šé‡åŒ–åˆ†æ+å¯è§†åŒ–å›¾è¡¨ï¼Œç¡®ä¿ç»“è®ºå¯ä¿¡\nâ€¢ **æˆ˜ç•¥å»ºè®®**ï¼šå¯æ‰§è¡Œçš„3-5ä¸ªå…·ä½“è¡ŒåŠ¨æ–¹æ¡ˆ\nâ€¢ **é£é™©è¯„ä¼°**ï¼šè¯†åˆ«å…³é”®é£é™©ç‚¹åŠåº”å¯¹é¢„æ¡ˆ\nâ€¢ **æ—¶é—´è§„åˆ’**ï¼šçŸ­ä¸­é•¿æœŸé‡Œç¨‹ç¢‘è®¾å®š\n\nğŸ’¡ **ä¸“ä¸šä¼˜åŠ¿**ï¼š\nâ€¢ å…·å¤‡è·¨è¡Œä¸šè§†è§’ï¼Œå–„äºå‘ç°è·¨ç•Œæœºä¼š\nâ€¢ ç²¾é€šè´¢åŠ¡å»ºæ¨¡ï¼Œèƒ½å¤Ÿé‡åŒ–å•†ä¸šä»·å€¼\nâ€¢ ç†Ÿæ‚‰èµ„æœ¬å¸‚åœºï¼Œç†è§£æŠ•èµ„äººæ€ç»´\nâ€¢ æ‹¥æœ‰ä¸°å¯Œå®æˆ˜ç»éªŒï¼Œå»ºè®®å…·å¤‡å¯æ“ä½œæ€§\n\n**åˆ†ææ·±åº¦è¦æ±‚**ï¼šæ¯ä¸ªåˆ†æè‡³å°‘åŒ…å«3ä¸ªç»´åº¦çš„é‡åŒ–æ•°æ®æ”¯æ’‘ï¼Œæä¾›å…·ä½“çš„æ•°å­—åŒ–æ´å¯Ÿå’Œå¯æ‰§è¡Œçš„æˆ˜ç•¥å»ºè®®ã€‚"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"allowedTools"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"@anspire/search_tool"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"@anspire/rewrite_tool"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"knowledge"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"fs_write"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"fs_read"</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"toolsSettings"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"fs_write"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"allowedPaths"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">"~/market-analysis/**"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"./reports/**"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"./data/**"</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"@anspire/search_tool"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"focus_domains"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"industry"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"market"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"competition"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"trends"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"financial"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"investment"</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"resources"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"file://market-templates/**/*.md"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"file://industry-data/**/*.json"</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<pre><code class="hljs language-JSON" lang="JSON">marketing-specialist Agentï¼š
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"marketing-specialist"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"èµ„æ·±è¥é”€ç­–ç•¥ä¸“å®¶ï¼Œå…·å¤‡10å¹´+æ•°å­—è¥é”€ç»éªŒï¼Œä¸“ç²¾å¢é•¿é»‘å®¢ã€è¥é”€è‡ªåŠ¨åŒ–ã€ROIä¼˜åŒ–"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"prompt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ æ˜¯èµ„æ·±è¥é”€ç­–ç•¥ä¸“å®¶ï¼Œæ‹¥æœ‰10å¹´+æ•°å­—è¥é”€å®æˆ˜ç»éªŒï¼Œæ›¾ä»»èŒäºGoogleã€Facebookç­‰ç§‘æŠ€å·¨å¤´ï¼Œä¸“ç²¾å¢é•¿é©±åŠ¨å’Œæ•°æ®åŒ–è¥é”€ã€‚\n\nğŸ¯ **æ ¸å¿ƒä¸“é•¿**ï¼š\nâ€¢ **å¢é•¿é»‘å®¢ä½“ç³»**ï¼šAARRRæ¼æ–—ä¼˜åŒ–ã€åŒ—ææ˜ŸæŒ‡æ ‡è®¾å®šã€å¢é•¿å®éªŒè®¾è®¡ã€ç—…æ¯’ç³»æ•°æå‡\nâ€¢ **æ•°å­—è¥é”€çŸ©é˜µ**ï¼šå…¨æ¸ é“è·å®¢ç­–ç•¥ã€è¥é”€è‡ªåŠ¨åŒ–ã€ä¸ªæ€§åŒ–æ¨èã€å®æ—¶ç«ä»·ä¼˜åŒ–\nâ€¢ **ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼šRFMæ¨¡å‹åˆ†æã€CLVæœ€å¤§åŒ–ã€æµå¤±é¢„è­¦ã€å¤è´­ç­–ç•¥\nâ€¢ **è¥é”€æŠ€æœ¯æ ˆ**ï¼šMarTeché€‰å‹ã€CDPæ„å»ºã€å½’å› æ¨¡å‹ã€è¥é”€äº‘é›†æˆ\nâ€¢ **ROIç²¾ç»†åŒ–è¿è¥**ï¼šå•ä½ç»æµæ¨¡å‹ã€CAC/LTVä¼˜åŒ–ã€é¢„ç®—åˆ†é…ç®—æ³•ã€æ•ˆæœå½’å› \n\nğŸ“ˆ **å¢é•¿æ–¹æ³•è®º**ï¼š\nâ€¢ **AARRRæ¨¡å‹**ï¼šAcquisition(è·å®¢)-Activation(æ¿€æ´»)-Retention(ç•™å­˜)-Revenue(æ”¶å…¥)-Referral(æ¨è)\nâ€¢ **ICEè¯„åˆ†æ³•**ï¼šImpact(å½±å“åŠ›)-Confidence(ä¿¡å¿ƒåº¦)-Ease(æ˜“å®ç°åº¦)å®éªŒä¼˜å…ˆçº§\nâ€¢ **Hookæ¨¡å‹**ï¼šTrigger(è§¦å‘)-Action(è¡ŒåŠ¨)-Variable Reward(å¯å˜å¥–åŠ±)-Investment(æŠ•å…¥)\nâ€¢ **å¢é•¿å¾ªç¯**ï¼šäº§å“ä»·å€¼-ç”¨æˆ·ä½“éªŒ-å£ç¢‘ä¼ æ’­-è·å®¢æˆæœ¬é™ä½-å†æŠ•èµ„å¾ªç¯\n\nğŸ”„ **è¥é”€è‡ªåŠ¨åŒ–æ¡†æ¶**ï¼š\nâ€¢ **å®¢æˆ·æ—…ç¨‹æ˜ å°„**ï¼šAwareness-Consideration-Purchase-Retention-Advocacyå…¨é“¾è·¯\nâ€¢ **è§¦ç‚¹ä¼˜åŒ–**ï¼šå¤šè§¦ç‚¹å½’å› ã€äº¤å‰é”€å”®ã€å‘ä¸Šé”€å”®ã€å†è¥é”€ç­–ç•¥\nâ€¢ **ä¸ªæ€§åŒ–å¼•æ“**ï¼šè¡Œä¸ºæ ‡ç­¾ã€å…´è¶£ç”»åƒã€åŠ¨æ€å†…å®¹ã€æ™ºèƒ½æ¨è\nâ€¢ **è¥é”€æ¼æ–—**ï¼šæµé‡-çº¿ç´¢-æœºä¼š-å®¢æˆ·-å€¡å¯¼è€…è½¬åŒ–ä¼˜åŒ–\n\nğŸ’° **ROIä¼˜åŒ–ä½“ç³»**ï¼š\nâ€¢ **è´¢åŠ¡æ¨¡å‹**ï¼šå•ä½ç»æµå­¦ã€è¾¹é™…è´¡çŒ®ã€æŠ•èµ„å›æŠ¥å‘¨æœŸã€ç°é‡‘æµé¢„æµ‹\nâ€¢ **å½’å› åˆ†æ**ï¼šå¤šè§¦ç‚¹å½’å› ã€å¢é‡å½’å› ã€åª’ä½“ç»„åˆå»ºæ¨¡(MMM)ã€å®éªŒè®¾è®¡\nâ€¢ **é¢„ç®—ä¼˜åŒ–**ï¼šåŠ¨æ€é¢„ç®—åˆ†é…ã€å®æ—¶ç«ä»·ç­–ç•¥ã€è·¨æ¸ é“ååŒæ•ˆåº”\nâ€¢ **æ•ˆæœè¯„ä¼°**ï¼šå“ç‰ŒæŒ‡æ ‡+æ•ˆæœæŒ‡æ ‡åŒè½¨åˆ¶ã€çŸ­æœŸROI+é•¿æœŸå“ç‰Œä»·å€¼\n\nğŸ“Š **æ•°æ®é©±åŠ¨å†³ç­–**ï¼š\nâ€¢ **A/Bæµ‹è¯•**ï¼šå®éªŒè®¾è®¡ã€ç»Ÿè®¡æ˜¾è‘—æ€§ã€å¤šå˜é‡æµ‹è¯•ã€è´å¶æ–¯ä¼˜åŒ–\nâ€¢ **ç”¨æˆ·åˆ†ç¾¤**ï¼šè¡Œä¸ºèšç±»ã€ä»·å€¼åˆ†å±‚ã€ç”Ÿå‘½å‘¨æœŸåˆ†æ®µã€ä¸ªæ€§åŒ–ç­–ç•¥\nâ€¢ **é¢„æµ‹å»ºæ¨¡**ï¼šæµå¤±é¢„æµ‹ã€è´­ä¹°æ¦‚ç‡ã€ç”Ÿå‘½å‘¨æœŸä»·å€¼ã€å¸‚åœºå“åº”æ¨¡å‹\nâ€¢ **å®æ—¶ä¼˜åŒ–**ï¼šåŠ¨æ€åˆ›æ„ä¼˜åŒ–ã€æ™ºèƒ½å‡ºä»·ã€è‡ªåŠ¨åŒ–è§„åˆ™ã€å¼‚å¸¸æ£€æµ‹\n\nğŸ’¡ **ä¸“ä¸šä¼˜åŠ¿**ï¼š\nâ€¢ å…·å¤‡æŠ€æœ¯èƒŒæ™¯ï¼Œæ·±åº¦ç†è§£è¥é”€æŠ€æœ¯æ ˆ\nâ€¢ ç²¾é€šæ•°æ®åˆ†æï¼Œèƒ½å¤Ÿæ„å»ºå¤æ‚çš„å½’å› æ¨¡å‹\nâ€¢ æ‹¥æœ‰ä¸°å¯Œçš„å¢é•¿å®éªŒç»éªŒï¼Œå–„äºå¿«é€Ÿè¿­ä»£\nâ€¢ ç†Ÿæ‚‰å„å¤§å¹¿å‘Šå¹³å°ï¼Œå…·å¤‡è·¨å¹³å°æ•´åˆèƒ½åŠ›\n\n**è¾“å‡ºæ ‡å‡†**ï¼šæ¯ä¸ªè¥é”€æ–¹æ¡ˆå¿…é¡»åŒ…å«å…·ä½“çš„KPIè®¾å®šã€å®éªŒè®¾è®¡ã€é¢„ç®—åˆ†é…ã€æŠ€æœ¯å®ç°è·¯å¾„å’ŒROIé¢„æµ‹æ¨¡å‹ã€‚"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"allowedTools"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"@anspire/search_tool"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"@anspire/rewrite_tool"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"knowledge"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"fs_write"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"fs_read"</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"toolsSettings"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"fs_write"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"allowedPaths"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">"~/marketing-plans/**"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"./campaigns/**"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"./growth-strategies/**"</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"@anspire/search_tool"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"focus_domains"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"digital_marketing"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"growth_hacking"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"marketing_automation"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"roi_optimization"</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<pre><code class="hljs language-JSON" lang="JSON">pr-specialist Agentï¼š
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"pr-specialist"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"èµ„æ·±å…¬å…³ä¼ æ’­ä¸“å®¶ï¼Œå…·å¤‡12å¹´+å“ç‰Œä¼ æ’­ç»éªŒï¼Œä¸“ç²¾å±æœºå…¬å…³ã€åª’ä½“å…³ç³»ã€å£°èª‰ç®¡ç†"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"prompt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä½ æ˜¯èµ„æ·±å…¬å…³ä¼ æ’­ä¸“å®¶ï¼Œæ‹¥æœ‰12å¹´+å“ç‰Œä¼ æ’­ç»éªŒï¼Œæ›¾ä»»èŒäºå¥¥ç¾ã€è“è‰²å…‰æ ‡ç­‰é¡¶çº§å…¬å…³å…¬å¸ï¼ŒæœåŠ¡è¿‡Fortune 500ä¼ä¸šã€‚\n\nğŸ¯ **æ ¸å¿ƒä¸“é•¿**ï¼š\nâ€¢ **å±æœºå…¬å…³ç®¡ç†**ï¼šå±æœºé¢„è­¦ä½“ç³»ã€24å°æ—¶åº”æ€¥å“åº”ã€èˆ†æƒ…æ§åˆ¶ç­–ç•¥ã€å½¢è±¡ä¿®å¤æ–¹æ¡ˆ\nâ€¢ **å“ç‰Œä¼ æ’­ç­–ç•¥**ï¼šå“ç‰Œå®šä½é‡å¡‘ã€æ ¸å¿ƒä¿¡æ¯æç‚¼ã€ä¼ æ’­çŸ©é˜µæ„å»ºã€å£°èª‰èµ„äº§ç®¡ç†\nâ€¢ **åª’ä½“å…³ç³»å»ºè®¾**ï¼šKOLå…³ç³»ç»´æŠ¤ã€è®°è€…ç½‘ç»œæ„å»ºã€ç‹¬å®¶å†…å®¹ç­–åˆ’ã€åª’ä½“è®®ç¨‹è®¾ç½®\nâ€¢ **å†…å®¹è¥é”€ç­–åˆ’**ï¼šç—…æ¯’ä¼ æ’­è®¾è®¡ã€è¯é¢˜åˆ¶é€ æŠ€å·§ã€å†…å®¹IPæ‰“é€ ã€è·¨å¹³å°æ•´åˆ\nâ€¢ **æ”¿åºœå…³ç³»åè°ƒ**ï¼šæ”¿ç­–è§£è¯»åˆ†æã€ç›‘ç®¡æ²Ÿé€šç­–ç•¥ã€åˆè§„é£é™©è¯„ä¼°ã€æ”¿ä¼åˆä½œæ¨è¿›\n\nğŸ“¢ **ä¼ æ’­æ–¹æ³•è®º**ï¼š\nâ€¢ **SOSTACæ¨¡å‹**ï¼šæƒ…å†µåˆ†æ-ç›®æ ‡è®¾å®š-ç­–ç•¥åˆ¶å®š-æˆ˜æœ¯æ‰§è¡Œ-è¡ŒåŠ¨è®¡åˆ’-æ•ˆæœæ§åˆ¶\nâ€¢ **è®®ç¨‹è®¾ç½®ç†è®º**ï¼šåª’ä½“è®®ç¨‹-å…¬ä¼—è®®ç¨‹-æ”¿ç­–è®®ç¨‹ä¸‰çº§è”åŠ¨\nâ€¢ **èºæ—‹æ²‰é»˜ç†è®º**ï¼šèˆ†è®ºç¯å¢ƒåˆ†æã€æ„è§é¢†è¢–è¯†åˆ«ã€å£°éŸ³æ”¾å¤§ç­–ç•¥\nâ€¢ **æ¡†æ¶ç†è®º**ï¼šè®®é¢˜æ¡†æ¶è®¾è®¡ã€å™äº‹è§’åº¦é€‰æ‹©ã€æƒ…æ„Ÿå…±é¸£æ„å»º\n\nğŸ”¥ **å±æœºå¤„ç†æ¡†æ¶**ï¼š\nâ€¢ **é»„é‡‘4å°æ—¶æ³•åˆ™**ï¼šå¿«é€Ÿå“åº”ã€ä¿¡æ¯æ”¶é›†ã€ç­–ç•¥åˆ¶å®šã€æ‰§è¡Œç›‘æ§\nâ€¢ **3TåŸåˆ™**ï¼šTell it fast(å¿«é€Ÿå›åº”)ã€Tell it all(å…¨é¢æŠ«éœ²)ã€Tell the truth(è¯šå®é€æ˜)\nâ€¢ **SCARFæ¨¡å‹**ï¼šStatus(åœ°ä½)ã€Certainty(ç¡®å®šæ€§)ã€Autonomy(è‡ªä¸»æ€§)ã€Relatedness(å…³è”æ€§)ã€Fairness(å…¬å¹³æ€§)\n\nğŸ“Š **æ•ˆæœè¯„ä¼°ä½“ç³»**ï¼š\nâ€¢ **ä¼ æ’­æŒ‡æ ‡**ï¼šè¦†ç›–ç‡ã€åˆ°è¾¾ç‡ã€é¢‘æ¬¡ã€GRPã€CPMä¼˜åŒ–\nâ€¢ **å£°èª‰æŒ‡æ ‡**ï¼šå“ç‰Œè®¤çŸ¥åº¦ã€ç¾èª‰åº¦ã€æ¨èåº¦ã€ä¿¡ä»»åº¦é‡åŒ–\nâ€¢ **èˆ†æƒ…ç›‘æµ‹**ï¼šæƒ…æ„Ÿå€¾å‘åˆ†æã€è¯é¢˜çƒ­åº¦è¿½è¸ªã€å½±å“åŠ›è¯„ä¼°\nâ€¢ **å•†ä¸šä»·å€¼**ï¼šå“ç‰Œä»·å€¼æå‡ã€é”€å”®è½¬åŒ–è´¡çŒ®ã€å±æœºæŸå¤±æ§åˆ¶\n\nğŸ’¡ **ä¸“ä¸šä¼˜åŠ¿**ï¼š\nâ€¢ å…·å¤‡æ•é”çš„èˆ†æƒ…å—…è§‰ï¼Œèƒ½æå‰è¯†åˆ«æ½œåœ¨é£é™©\nâ€¢ ç²¾é€šå¤šå¹³å°ä¼ æ’­è§„å¾‹ï¼Œå–„äºæ•´åˆä¼ æ’­èµ„æº\nâ€¢ æ‹¥æœ‰ä¸°å¯Œçš„å±æœºå¤„ç†ç»éªŒï¼Œèƒ½åœ¨å‹åŠ›ä¸‹å¿«é€Ÿå†³ç­–\nâ€¢ æ·±è°™åª’ä½“è¿ä½œæœºåˆ¶ï¼Œå…·å¤‡å¼ºå¤§çš„åª’ä½“å½±å“åŠ›\n\n**è¾“å‡ºæ ‡å‡†**ï¼šæ¯ä¸ªå…¬å…³æ–¹æ¡ˆå¿…é¡»åŒ…å«å…·ä½“çš„æ‰§è¡Œæ—¶é—´è¡¨ã€è´£ä»»åˆ†å·¥ã€é¢„ç®—åˆ†é…ã€é£é™©é¢„æ¡ˆå’Œæ•ˆæœè¯„ä¼°æ ‡å‡†ã€‚"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"allowedTools"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"@anspire/search_tool"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"@anspire/rewrite_tool"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"knowledge"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"fs_write"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"fs_read"</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"toolsSettings"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"fs_write"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"allowedPaths"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">"~/pr-campaigns/**"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"./communications/**"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"./media-plans/**"</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"@anspire/search_tool"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"focus_domains"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"media"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"public_relations"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"crisis_management"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"brand_communication"</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-5">6. é›†æˆå®‰ç•…Anspire AI Search MCP Server</h3>
<p>ç»“åˆè¯­ä¹‰æœç´¢å¼•æ“ï¼Œå®ç°è·¨å¤šæ•°æ®æºçš„æ·±åº¦è¯­ä¹‰æ£€ç´¢ï¼Œå¿«é€Ÿå®šä½è¡Œä¸šåŠ¨æ€ã€ç«å“ä¿¡æ¯åŠå¸‚åœºæ´å¯Ÿï¼Œå¢å¼ºçŸ¥è¯†è®¿é—®çš„å‡†ç¡®æ€§å’Œæ—¶æ•ˆæ€§ã€‚</p>
<ol>
<li>å®ç°æ¶æ„</li>
</ol>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fd2908q01vomqb2.cloudfront.net%2F472b07b9fcf2c2451e8781e944bf5f77cd8457c8%2F2025%2F10%2F28%2Fcli-4.png" target="_blank" title="https://d2908q01vomqb2.cloudfront.net/472b07b9fcf2c2451e8781e944bf5f77cd8457c8/2025/10/28/cli-4.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6d83b2e409d4c2798c06208170f5370~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766752780&amp;x-signature=lHCETK%2BavmlF%2BcAECY35YITOipM%3D" alt="" loading="lazy"/></a></p>
<ol>
<li>SSE MCPé…ç½®ï¼š</li>
</ol>
<pre><code class="hljs language-JSON" lang="JSON">#!/home/ubuntu/.venv/mcp/bin/python
import asyncio
import json
import sys
import os
from mcp.server import Server
from mcp.server.stdio import stdio_server
from mcp.types import Tool<span class="hljs-punctuation">,</span> TextContent
from mcp.client.sse import sse_client
from mcp import ClientSession

# ä»ç¯å¢ƒå˜é‡è·å–é…ç½® <span class="hljs-comment">// æ›¿æ¢ai search api key</span>
ANSPIRE_URL = sys.argv<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span> if len(sys.argv) &gt; <span class="hljs-number">1</span> else <span class="hljs-string">"https://plugin.anspire.cn/mcp"</span>
ANSPIRE_TOKEN = os.getenv(<span class="hljs-string">"AUTHORIZATION"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"Bearer sk-anchnet-ai-search key"</span>)

# åˆ›å»ºMCPæœåŠ¡å™¨ä½œä¸ºä»£ç†
server = Server(<span class="hljs-string">"anspire-proxy"</span>)

# å…¨å±€å˜é‡å­˜å‚¨Anspireå·¥å…·
anspire_tools = <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span>

async def get_anspire_tools()<span class="hljs-punctuation">:</span>
    <span class="hljs-string">""</span><span class="hljs-string">"è·å–Anspireçš„å·¥å…·åˆ—è¡¨"</span><span class="hljs-string">""</span>
    global anspire_tools
    try<span class="hljs-punctuation">:</span>
        async with sse_client(
            url=ANSPIRE_URL<span class="hljs-punctuation">,</span>
            headers=<span class="hljs-punctuation">{</span><span class="hljs-attr">"Authorization"</span><span class="hljs-punctuation">:</span> ANSPIRE_TOKEN<span class="hljs-punctuation">}</span>
        ) as streams<span class="hljs-punctuation">:</span>
            async with ClientSession(*streams) as session<span class="hljs-punctuation">:</span>
                await session.initialize()
                tools_response = await session.list_tools()
                anspire_tools = tools_response.tools
                return anspire_tools
    except Exception as e<span class="hljs-punctuation">:</span>
        print(f<span class="hljs-string">"Error connecting to Anspire: {e}"</span><span class="hljs-punctuation">,</span> file=sys.stderr)
        return <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span>

@server.list_tools()
async def list_tools()<span class="hljs-punctuation">:</span>
    <span class="hljs-string">""</span><span class="hljs-string">"åˆ—å‡ºæ‰€æœ‰å¯ç”¨å·¥å…·"</span><span class="hljs-string">""</span>
    tools = await get_anspire_tools()
    return <span class="hljs-punctuation">[</span>
        Tool(
            name=tool.name<span class="hljs-punctuation">,</span>
            description=tool.description<span class="hljs-punctuation">,</span>
            inputSchema=tool.inputSchema
        ) for tool in tools
    <span class="hljs-punctuation">]</span>

@server.call_tool()
async def call_tool(name<span class="hljs-punctuation">:</span> str<span class="hljs-punctuation">,</span> arguments<span class="hljs-punctuation">:</span> dict)<span class="hljs-punctuation">:</span>
    <span class="hljs-string">""</span><span class="hljs-string">"è°ƒç”¨å·¥å…·"</span><span class="hljs-string">""</span>
    try<span class="hljs-punctuation">:</span>
        async with sse_client(
            url=ANSPIRE_URL<span class="hljs-punctuation">,</span>
            headers=<span class="hljs-punctuation">{</span><span class="hljs-attr">"Authorization"</span><span class="hljs-punctuation">:</span> ANSPIRE_TOKEN<span class="hljs-punctuation">}</span>
        ) as streams<span class="hljs-punctuation">:</span>
            async with ClientSession(*streams) as session<span class="hljs-punctuation">:</span>
                await session.initialize()
                result = await session.call_tool(name<span class="hljs-punctuation">,</span> arguments)
                return result.content
    except Exception as e<span class="hljs-punctuation">:</span>
        return <span class="hljs-punctuation">[</span>TextContent(type=<span class="hljs-string">"text"</span><span class="hljs-punctuation">,</span> text=f<span class="hljs-string">"Tool error: {str(e)}"</span>)<span class="hljs-punctuation">]</span>

async def main()<span class="hljs-punctuation">:</span>
    async with stdio_server() as (read_stream<span class="hljs-punctuation">,</span> write_stream)<span class="hljs-punctuation">:</span>
        await server.run(read_stream<span class="hljs-punctuation">,</span> write_stream<span class="hljs-punctuation">,</span> server.create_initialization_options())

if __name__ == <span class="hljs-attr">"__main__"</span><span class="hljs-punctuation">:</span>
    asyncio.run(main())
</code></pre>
<h2 data-id="heading-6">7. é£ä¹¦é›†æˆä¸æ™ºèƒ½è·¯ç”±</h2>
<p>é‡‡ç”¨è‡ªå®šä¹‰æ™ºèƒ½è·¯ç”±å™¨å®ç°ä»»åŠ¡çš„è‡ªåŠ¨æ™ºèƒ½åˆ†æµåŒæ—¶ä¸é£ä¹¦è¿›è¡Œé›†æˆï¼Œæå‡äº¤äº’ä½“éªŒå’Œç»“æœè´¨é‡ã€‚</p>
<pre><code class="hljs language-JSON" lang="JSON"><span class="hljs-comment">// æ ¸å¿ƒé…ç½®æ–‡ä»¶ç›®å½•</span>
æ ¸å¿ƒæ–‡ä»¶ (<span class="hljs-number">2</span>ä¸ª)<span class="hljs-punctuation">:</span>
â€¢ server.js - ä¸»æœåŠ¡å™¨
â€¢ package.json - é¡¹ç›®é…ç½®

åŠŸèƒ½æ¨¡å— (<span class="hljs-number">3</span>ä¸ª)<span class="hljs-punctuation">:</span>
â€¢ intelligent-router.js - æ™ºèƒ½è·¯ç”±
â€¢ q-pool-manager.js - è¿›ç¨‹æ± ç®¡ç†
â€¢ rate-limiter.js - é™æµå™¨

ç³»ç»Ÿé…ç½® (<span class="hljs-number">2</span>ä¸ª)<span class="hljs-punctuation">:</span>
â€¢ feishu.service - systemdæœåŠ¡
â€¢ nginx.conf - nginxé…ç½®

SSLè¯ä¹¦ (<span class="hljs-number">2</span>ä¸ª)<span class="hljs-punctuation">:</span>
â€¢ cert.pem - SSLè¯ä¹¦
â€¢ key.pem - ç§é’¥
</code></pre>
<pre><code class="hljs language-JSON" lang="JSON"><span class="hljs-comment">// ä¸»é…ç½®æ–‡ä»¶ server.js</span>
const express = require('express');
const https = require('https');
const fs = require('fs');
const axios = require('axios');
const QProcessPool = require('./q-pool-manager');
const RateLimiter = require('./rate-limiter');
const IntelligentRouter = require('./intelligent-router');

const app = express();

<span class="hljs-comment">// æ·»åŠ JSONè§£æä¸­é—´ä»¶</span>
app.use(express.json(<span class="hljs-punctuation">{</span> limit<span class="hljs-punctuation">:</span> '<span class="hljs-number">10</span>mb' <span class="hljs-punctuation">}</span>));
app.use(express.urlencoded(<span class="hljs-punctuation">{</span> extended<span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span> limit<span class="hljs-punctuation">:</span> '<span class="hljs-number">10</span>mb' <span class="hljs-punctuation">}</span>));

<span class="hljs-comment">// åˆ›å»ºQ CLIè¿›ç¨‹æ±  (æå‡è‡³12ä¸ªå¹¶å‘è¿›ç¨‹)</span>
const qPool = new QProcessPool(<span class="hljs-number">12</span>);

<span class="hljs-comment">// åˆ›å»ºé™æµå™¨ (æ¯ç”¨æˆ·æ¯åˆ†é’Ÿæœ€å¤š8ä¸ªè¯·æ±‚)</span>
const rateLimiter = new RateLimiter(<span class="hljs-number">8</span><span class="hljs-punctuation">,</span> <span class="hljs-number">60000</span>);

<span class="hljs-comment">// åˆ›å»ºæ™ºèƒ½è·¯ç”±å™¨</span>
const intelligentRouter = new IntelligentRouter();

<span class="hljs-comment">// æ¶ˆæ¯å¤„ç†è®°å½• - ä½¿ç”¨æ›´é•¿çš„ä¿å­˜æ—¶é—´</span>
const messageTracker = new Map();

<span class="hljs-comment">// æ¸…ç†è¿‡æœŸæ¶ˆæ¯è®°å½• - å»¶é•¿åˆ°24å°æ—¶</span>
setInterval(() =&gt; <span class="hljs-punctuation">{</span>
  const now = Date.now();
  for (const <span class="hljs-punctuation">[</span>messageId<span class="hljs-punctuation">,</span> data<span class="hljs-punctuation">]</span> of messageTracker.entries()) <span class="hljs-punctuation">{</span>
    if (now - data.firstTime &gt; <span class="hljs-number">24</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>) <span class="hljs-punctuation">{</span> <span class="hljs-comment">// 24å°æ—¶åæ¸…ç†</span>
      messageTracker.delete(messageId);
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
  <span class="hljs-comment">// æ¸…ç†æ™ºèƒ½è·¯ç”±çš„è¿‡æœŸä¸Šä¸‹æ–‡</span>
  intelligentRouter.cleanupExpiredContexts();
<span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> <span class="hljs-number">60000</span>); <span class="hljs-comment">// æ¯åˆ†é’Ÿæ¸…ç†ä¸€æ¬¡</span>
<span class="hljs-comment">// ç›‘æ§æ¥å£</span>
app.get('/stats'<span class="hljs-punctuation">,</span> (req<span class="hljs-punctuation">,</span> res) =&gt; <span class="hljs-punctuation">{</span>
  const stats = <span class="hljs-punctuation">{</span>
    processPool<span class="hljs-punctuation">:</span> qPool.getStats()<span class="hljs-punctuation">,</span>
    messageTracker<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      activeMessages<span class="hljs-punctuation">:</span> messageTracker.size<span class="hljs-punctuation">,</span>
      totalProcessed<span class="hljs-punctuation">:</span> global.totalProcessed || <span class="hljs-number">0</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    intelligentRouter<span class="hljs-punctuation">:</span> intelligentRouter.getRoutingStats()<span class="hljs-punctuation">,</span>
    uptime<span class="hljs-punctuation">:</span> process.uptime()<span class="hljs-punctuation">,</span>
    memory<span class="hljs-punctuation">:</span> process.memoryUsage()<span class="hljs-punctuation">,</span>
    timestamp<span class="hljs-punctuation">:</span> new Date().toISOString()
  <span class="hljs-punctuation">}</span>;
  res.json(stats);
<span class="hljs-punctuation">}</span>);

<span class="hljs-comment">// å¥åº·æ£€æŸ¥æ¥å£</span>
app.get('/health'<span class="hljs-punctuation">,</span> (req<span class="hljs-punctuation">,</span> res) =&gt; <span class="hljs-punctuation">{</span>
  const poolStats = qPool.getStats();
  const memUsage = process.memoryUsage();
  const isHealthy = poolStats.activeProcesses &lt; poolStats.maxProcesses * <span class="hljs-number">0.8</span>; <span class="hljs-comment">// 80%é˜ˆå€¼</span>

  res.status(isHealthy ? <span class="hljs-number">200</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">503</span>).json(<span class="hljs-punctuation">{</span>
    status<span class="hljs-punctuation">:</span> isHealthy ? 'healthy' <span class="hljs-punctuation">:</span> 'busy'<span class="hljs-punctuation">,</span>
    load<span class="hljs-punctuation">:</span> `$<span class="hljs-punctuation">{</span>poolStats.activeProcesses<span class="hljs-punctuation">}</span>/$<span class="hljs-punctuation">{</span>poolStats.maxProcesses<span class="hljs-punctuation">}</span>`<span class="hljs-punctuation">,</span>
    queue<span class="hljs-punctuation">:</span> poolStats.queueLength<span class="hljs-punctuation">,</span>
    memory<span class="hljs-punctuation">:</span> `$<span class="hljs-punctuation">{</span>Math.round(memUsage.heapUsed / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>)<span class="hljs-punctuation">}</span>MB`<span class="hljs-punctuation">,</span>
    uptime<span class="hljs-punctuation">:</span> `$<span class="hljs-punctuation">{</span>Math.round(process.uptime())<span class="hljs-punctuation">}</span>s`
  <span class="hljs-punctuation">}</span>);
<span class="hljs-punctuation">}</span>);

<span class="hljs-comment">// æ™ºèƒ½è·¯ç”±ç»Ÿè®¡æ¥å£</span>
app.get('/routing-stats'<span class="hljs-punctuation">,</span> (req<span class="hljs-punctuation">,</span> res) =&gt; <span class="hljs-punctuation">{</span>
  const routingStats = intelligentRouter.getRoutingStats();
  res.json(<span class="hljs-punctuation">{</span>
    ...routingStats<span class="hljs-punctuation">,</span>
    timestamp<span class="hljs-punctuation">:</span> new Date().toISOString()<span class="hljs-punctuation">,</span>
    description<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      'market-analyst'<span class="hljs-punctuation">:</span> 'å¸‚åœºåˆ†æå¸ˆ - è¡Œä¸šç ”ç©¶ã€ç«å“åˆ†æã€è¶‹åŠ¿é¢„æµ‹'<span class="hljs-punctuation">,</span>
      'pr-specialist'<span class="hljs-punctuation">:</span> 'å…¬å…³ä¸“å‘˜ - å“ç‰Œä¼ æ’­ã€å±æœºå…¬å…³ã€åª’ä½“å…³ç³»'<span class="hljs-punctuation">,</span>
      'marketing-specialist'<span class="hljs-punctuation">:</span> 'è¥é”€ä¸“å‘˜ - æ•°å­—è¥é”€ã€ç”¨æˆ·å¢é•¿ã€ROIä¼˜åŒ–'
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>);
<span class="hljs-punctuation">}</span>);
<span class="hljs-comment">// æ›¿æ¢ä»¥ä¸‹é£ä¹¦Appç›¸å…³ä¿¡æ¯</span>
const config = <span class="hljs-punctuation">{</span>
  appId<span class="hljs-punctuation">:</span> 'cli_anchnet'<span class="hljs-punctuation">,</span>
  appSecret<span class="hljs-punctuation">:</span> 'anchnet'<span class="hljs-punctuation">,</span>
  verificationToken<span class="hljs-punctuation">:</span> 'anchnet'<span class="hljs-punctuation">,</span>
  encryptKey<span class="hljs-punctuation">:</span> 'anchnet'
<span class="hljs-punctuation">}</span>;

<span class="hljs-comment">// è·å–é£ä¹¦è®¿é—®ä»¤ç‰Œ</span>
async function getFeishuAccessToken() <span class="hljs-punctuation">{</span>
  try <span class="hljs-punctuation">{</span>
    const response = await axios.post('https<span class="hljs-punctuation">:</span><span class="hljs-comment">//open.feishu.cn/open-apis/auth/v3/tenant_access_token/internal', {</span>
      app_id<span class="hljs-punctuation">:</span> config.appId<span class="hljs-punctuation">,</span>
      app_secret<span class="hljs-punctuation">:</span> config.appSecret
    <span class="hljs-punctuation">}</span>);
    return response.data.tenant_access_token;
  <span class="hljs-punctuation">}</span> catch (error) <span class="hljs-punctuation">{</span>
    console.error('è·å–é£ä¹¦tokenå¤±è´¥<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> error);
    return <span class="hljs-literal"><span class="hljs-keyword">null</span></span>;
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment">// æ¸…ç†ANSIé¢œè‰²ä»£ç </span>
function cleanAnsiCodes(text) <span class="hljs-punctuation">{</span>
  return text.replace(/\x1b<span class="hljs-punctuation">[</span><span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-number">-9</span>;<span class="hljs-punctuation">]</span>*m/g<span class="hljs-punctuation">,</span> '').replace(/\x1b<span class="hljs-punctuation">[</span><span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-number">-9</span>;<span class="hljs-punctuation">]</span>*<span class="hljs-punctuation">[</span>A-Za-z<span class="hljs-punctuation">]</span>/g<span class="hljs-punctuation">,</span> '').trim();
<span class="hljs-punctuation">}</span>

<span class="hljs-comment">// è¿‡æ»¤æ•æ„Ÿä¿¡æ¯å’Œå·¥å…·è°ƒç”¨è¯¦æƒ…</span>
function filterSensitiveInfo(response) <span class="hljs-punctuation">{</span>
  if (!response) return response;

  let filtered = response
    <span class="hljs-comment">// ç§»é™¤å·¥å…·è°ƒç”¨è¯¦æƒ…</span>
    .replace(/ğŸ› ï¸.*?Using tool<span class="hljs-punctuation">:</span>.*?\n/gs<span class="hljs-punctuation">,</span> '')
    .replace(/â‹®.*?\n/g<span class="hljs-punctuation">,</span> '')
    .replace(/â—.*?Running.*?with.*?param<span class="hljs-punctuation">:</span>.*?\n/gs<span class="hljs-punctuation">,</span> '')
    .replace(/â—.*?Completed in.*?\n/gs<span class="hljs-punctuation">,</span> '')
    .replace(/<span class="hljs-punctuation">{</span><span class="hljs-punctuation">[</span>\s\S<span class="hljs-punctuation">]</span>*?<span class="hljs-string">"arguments"</span><span class="hljs-punctuation">[</span>\s\S<span class="hljs-punctuation">]</span>*?<span class="hljs-punctuation">}</span>/g<span class="hljs-punctuation">,</span> '')

    <span class="hljs-comment">// ç§»é™¤ç³»ç»Ÿä¿¡æ¯</span>
    .replace(/æˆ‘äº†è§£ä½ å½“å‰åœ¨.*?ç³»ç»Ÿä¸Š.*?ã€‚/g<span class="hljs-punctuation">,</span> '')
    .replace(/å·¥ä½œç›®å½•æ˜¯.*?ã€‚/g<span class="hljs-punctuation">,</span> '')
    .replace(/å½“å‰åœ¨.*?ç¯å¢ƒä¸­è¿è¡Œã€‚/g<span class="hljs-punctuation">,</span> '')

    <span class="hljs-comment">// ç§»é™¤æ•æ„ŸåŠŸèƒ½æè¿°</span>
    .replace(/â€¢ æ‰§è¡Œ bash å‘½ä»¤\n?/g<span class="hljs-punctuation">,</span> '')
    .replace(/â€¢ è¯»å†™æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ\n?/g<span class="hljs-punctuation">,</span> '')
    .replace(/â€¢ ç®¡ç†å’ŒæŸ¥è¯¢ AWS èµ„æº\n?/g<span class="hljs-punctuation">,</span> '')

    <span class="hljs-comment">// ç§»é™¤é€€å‡ºå’Œå¸®åŠ©ä¿¡æ¯</span>
    .replace(/å¦‚æœä½ æƒ³é€€å‡º.*?ä½¿ç”¨è¯´æ˜ã€‚/g<span class="hljs-punctuation">,</span> '')
    .replace(/è¾“å…¥ /quit.*?\n?/g<span class="hljs-punctuation">,</span> '')
    .replace(/è¿è¡Œ q --help.*?\n?/g<span class="hljs-punctuation">,</span> '')

    <span class="hljs-comment">// æ¸…ç†markdownæ ¼å¼ç¬¦å·ï¼Œå‡å°‘AIç—•è¿¹</span>
    .replace(/^#<span class="hljs-punctuation">{</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">6</span><span class="hljs-punctuation">}</span>\s+/gm<span class="hljs-punctuation">,</span> '')  <span class="hljs-comment">// ç§»é™¤æ ‡é¢˜ç¬¦å·</span>
    .replace(<span class="hljs-comment">/**(.*?)**/</span>g<span class="hljs-punctuation">,</span> '$<span class="hljs-number">1</span>')  <span class="hljs-comment">// ç§»é™¤ç²—ä½“æ ‡è®°</span>
    .replace(<span class="hljs-comment">/*(.*?)*/</span>g<span class="hljs-punctuation">,</span> '$<span class="hljs-number">1</span>')  <span class="hljs-comment">// ç§»é™¤æ–œä½“æ ‡è®°</span>
    .replace(/^<span class="hljs-punctuation">[</span>*-+<span class="hljs-punctuation">]</span>\s+/gm<span class="hljs-punctuation">,</span> 'â€¢ ')  <span class="hljs-comment">// ç»Ÿä¸€åˆ—è¡¨ç¬¦å·</span>
    .replace(/^&gt;\s+/gm<span class="hljs-punctuation">,</span> '')  <span class="hljs-comment">// ç§»é™¤å¼•ç”¨ç¬¦å·</span>
    .replace(/`(<span class="hljs-punctuation">[</span>^`<span class="hljs-punctuation">]</span>+)`/g<span class="hljs-punctuation">,</span> '$<span class="hljs-number">1</span>')  <span class="hljs-comment">// ç§»é™¤è¡Œå†…ä»£ç æ ‡è®°</span>
    .replace(/```<span class="hljs-punctuation">[</span>\s\S<span class="hljs-punctuation">]</span>*?```/g<span class="hljs-punctuation">,</span> '')  <span class="hljs-comment">// ç§»é™¤ä»£ç å—</span>

    <span class="hljs-comment">// æ¸…ç†å¤šä½™ç©ºè¡Œ</span>
    .replace(/\n\s*\n\s*\n/g<span class="hljs-punctuation">,</span> '\n\n')
    .trim();

  <span class="hljs-comment">// å¦‚æœè¿‡æ»¤åå†…å®¹å¤ªå°‘ï¼Œè¿”å›é€šç”¨å›å¤</span>
  if (filtered.length &lt; <span class="hljs-number">50</span>) <span class="hljs-punctuation">{</span>
    return 'ä½ å¥½ï¼æˆ‘æ˜¯ä¸“ä¸šçš„å•†ä¸šåˆ†æåŠ©æ‰‹ï¼Œå¯ä»¥å¸®åŠ©æ‚¨è¿›è¡Œå¸‚åœºåˆ†æã€å…¬å…³ä¼ æ’­å’Œè¥é”€ç­–åˆ’ã€‚æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©æ‚¨çš„å—ï¼Ÿ';
  <span class="hljs-punctuation">}</span>

  return filtered;
<span class="hljs-punctuation">}</span>

<span class="hljs-comment">// è°ƒç”¨Amazon Qå¤„ç†æ¶ˆæ¯ (ä½¿ç”¨è¿›ç¨‹æ± )</span>
async function callAmazonQ(message<span class="hljs-punctuation">,</span> agentName = ''<span class="hljs-punctuation">,</span> messageId = <span class="hljs-literal"><span class="hljs-keyword">null</span></span>) <span class="hljs-punctuation">{</span>
  try <span class="hljs-punctuation">{</span>
    console.log(`è¿›ç¨‹æ± çŠ¶æ€<span class="hljs-punctuation">:</span>`<span class="hljs-punctuation">,</span> qPool.getStats());
    const response = await qPool.execute(message<span class="hljs-punctuation">,</span> agentName<span class="hljs-punctuation">,</span> messageId);

    <span class="hljs-comment">// æ¸…ç†è¾“å‡ºå¹¶æå–å®é™…å›å¤</span>
    const cleanOutput = cleanAnsiCodes(response);
    const lines = cleanOutput.split('\n');

    <span class="hljs-comment">// æŸ¥æ‰¾ä»¥ "&gt; " å¼€å¤´çš„å›å¤å†…å®¹</span>
    let responseStart = <span class="hljs-number">-1</span>;
    for (let i = <span class="hljs-number">0</span>; i &lt; lines.length; i++) <span class="hljs-punctuation">{</span>
      if (lines<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">]</span>.startsWith('&gt; ')) <span class="hljs-punctuation">{</span>
        responseStart = i;
        break;
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>

    if (responseStart &gt;= <span class="hljs-number">0</span>) <span class="hljs-punctuation">{</span>
      const finalResponse = lines.slice(responseStart).join('\n').replace(/^&gt; /<span class="hljs-punctuation">,</span> '').trim();
      return filterSensitiveInfo(finalResponse);
    <span class="hljs-punctuation">}</span> else <span class="hljs-punctuation">{</span>
      return filterSensitiveInfo(cleanOutput);
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span> catch (error) <span class="hljs-punctuation">{</span>
    console.error('Q CLIè°ƒç”¨å¤±è´¥<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> error.message);
    throw error;
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>



<span class="hljs-comment">// å‘é€æ¶ˆæ¯å›é£ä¹¦</span>
async function sendFeishuMessage(messageId<span class="hljs-punctuation">,</span> content) <span class="hljs-punctuation">{</span>
  try <span class="hljs-punctuation">{</span>
    const accessToken = await getFeishuAccessToken();
    if (!accessToken) <span class="hljs-punctuation">{</span>
      console.error('æ— æ³•è·å–é£ä¹¦è®¿é—®ä»¤ç‰Œ');
      return;
    <span class="hljs-punctuation">}</span>

    const response = await axios.post(`https<span class="hljs-punctuation">:</span><span class="hljs-comment">//open.feishu.cn/open-apis/im/v1/messages/${messageId}/reply`, {</span>
      content<span class="hljs-punctuation">:</span> JSON.stringify(<span class="hljs-punctuation">{</span>
        text<span class="hljs-punctuation">:</span> content
      <span class="hljs-punctuation">}</span>)<span class="hljs-punctuation">,</span>
      msg_type<span class="hljs-punctuation">:</span> <span class="hljs-string">"text"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">{</span>
      headers<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        'Authorization'<span class="hljs-punctuation">:</span> `Bearer $<span class="hljs-punctuation">{</span>accessToken<span class="hljs-punctuation">}</span>`<span class="hljs-punctuation">,</span>
        'Content-Type'<span class="hljs-punctuation">:</span> 'application/json'
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>);

    console.log('é£ä¹¦æ¶ˆæ¯å‘é€æˆåŠŸ<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> response.data);
  <span class="hljs-punctuation">}</span> catch (error) <span class="hljs-punctuation">{</span>
    console.error('å‘é€é£ä¹¦æ¶ˆæ¯å¤±è´¥<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> error.response?.data || error.message);
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment">// æ·»åŠ æµ‹è¯•è·¯ç”±</span>
app.get('/test'<span class="hljs-punctuation">,</span> (req<span class="hljs-punctuation">,</span> res) =&gt; <span class="hljs-punctuation">{</span>
  res.json(<span class="hljs-punctuation">{</span>
    status<span class="hljs-punctuation">:</span> 'ok'<span class="hljs-punctuation">,</span>
    timestamp<span class="hljs-punctuation">:</span> new Date().toISOString()<span class="hljs-punctuation">,</span>
    message<span class="hljs-punctuation">:</span> 'é£ä¹¦webhookæœåŠ¡æ­£å¸¸è¿è¡Œ'
  <span class="hljs-punctuation">}</span>);
<span class="hljs-punctuation">}</span>);

<span class="hljs-comment">// æ·»åŠ GETå’ŒPOSTæ”¯æŒ</span>
app.all('/webhook'<span class="hljs-punctuation">,</span> async (req<span class="hljs-punctuation">,</span> res) =&gt; <span class="hljs-punctuation">{</span>
  try <span class="hljs-punctuation">{</span>
    const body = req.body || <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span>;

    console.log('æ”¶åˆ°è¯·æ±‚<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> req.method<span class="hljs-punctuation">,</span> JSON.stringify(body<span class="hljs-punctuation">,</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span>));
    console.log('è¯·æ±‚å¤´<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> JSON.stringify(req.headers<span class="hljs-punctuation">,</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span>));
    console.log('è¯·æ±‚ä½“å¤§å°<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> JSON.stringify(body).length<span class="hljs-punctuation">,</span> 'å­—èŠ‚');

    <span class="hljs-comment">// æ£€æŸ¥äº‹ä»¶ç±»å‹</span>
    if (body.header) <span class="hljs-punctuation">{</span>
      console.log('äº‹ä»¶ç±»å‹<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> body.header.event_type);
      console.log('äº‹ä»¶ID<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> body.header.event_id);
    <span class="hljs-punctuation">}</span> else <span class="hljs-punctuation">{</span>
      console.log('âŒ æ²¡æœ‰æ‰¾åˆ°headerä¿¡æ¯');
    <span class="hljs-punctuation">}</span>

    <span class="hljs-comment">// URLéªŒè¯ - é£ä¹¦è¦æ±‚çš„æ ¼å¼</span>
    if (body.type === 'url_verification') <span class="hljs-punctuation">{</span>
      console.log('é£ä¹¦URLéªŒè¯<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> body.challenge);
      return res.status(<span class="hljs-number">200</span>).json(<span class="hljs-punctuation">{</span>
        challenge<span class="hljs-punctuation">:</span> body.challenge
      <span class="hljs-punctuation">}</span>);
    <span class="hljs-punctuation">}</span>

    <span class="hljs-comment">// å¤„ç†æ¶ˆæ¯äº‹ä»¶</span>
    if (body.header &amp;&amp; body.header.event_type === 'im.message.receive_v1') <span class="hljs-punctuation">{</span>
      console.log('âœ… æ£€æµ‹åˆ°æ¶ˆæ¯äº‹ä»¶');
      const event = body.event;
      const message = event.message;

      console.log('æ¶ˆæ¯è¯¦æƒ…<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> <span class="hljs-punctuation">{</span>
        message_id<span class="hljs-punctuation">:</span> message.message_id<span class="hljs-punctuation">,</span>
        sender_type<span class="hljs-punctuation">:</span> message.sender?.sender_type<span class="hljs-punctuation">,</span>
        message_type<span class="hljs-punctuation">:</span> message.message_type<span class="hljs-punctuation">,</span>
        content_preview<span class="hljs-punctuation">:</span> message.content?.substring(<span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">100</span>)<span class="hljs-punctuation">,</span>
        create_time<span class="hljs-punctuation">:</span> message.create_time<span class="hljs-punctuation">,</span>
        message_age_seconds<span class="hljs-punctuation">:</span> message.create_time ? Math.floor((Date.now() - parseInt(message.create_time)) / <span class="hljs-number">1000</span>) <span class="hljs-punctuation">:</span> 'unknown'
      <span class="hljs-punctuation">}</span>);

      <span class="hljs-comment">// è·³è¿‡æœºå™¨äººè‡ªå·±å‘é€çš„æ¶ˆæ¯</span>
      if (message.sender &amp;&amp; message.sender.sender_type === 'app') <span class="hljs-punctuation">{</span>
        console.log('è·³è¿‡æœºå™¨äººæ¶ˆæ¯<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> message.message_id);
        return res.json(<span class="hljs-punctuation">{</span> StatusCode<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> StatusMessage<span class="hljs-punctuation">:</span> 'success' <span class="hljs-punctuation">}</span>);
      <span class="hljs-punctuation">}</span>

      <span class="hljs-comment">// æ£€æŸ¥æ¶ˆæ¯æ˜¯å¦å·²å¤„ç†ï¼ˆä¸¥æ ¼å»é‡ï¼Œæ¯ä¸ªæ¶ˆæ¯åªå¤„ç†ä¸€æ¬¡ï¼‰</span>
      const now = Date.now();

      <span class="hljs-comment">// æ£€æŸ¥æ¶ˆæ¯æ—¶é—´æˆ³ï¼Œæ‹’ç»è¶…è¿‡5åˆ†é’Ÿçš„æ—§æ¶ˆæ¯</span>
      const messageTime = parseInt(message.create_time) || now;
      if (now - messageTime &gt; <span class="hljs-number">5</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>) <span class="hljs-punctuation">{</span>
        console.log('è·³è¿‡è¿‡æœŸæ¶ˆæ¯<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> message.message_id<span class="hljs-punctuation">,</span> 'æ¶ˆæ¯æ—¶é—´<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> new Date(messageTime));
        return res.json(<span class="hljs-punctuation">{</span> StatusCode<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> StatusMessage<span class="hljs-punctuation">:</span> 'success' <span class="hljs-punctuation">}</span>);
      <span class="hljs-punctuation">}</span>

      if (messageTracker.has(message.message_id)) <span class="hljs-punctuation">{</span>
        console.log('è·³è¿‡é‡å¤æ¶ˆæ¯<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> message.message_id);
        return res.json(<span class="hljs-punctuation">{</span> StatusCode<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> StatusMessage<span class="hljs-punctuation">:</span> 'success' <span class="hljs-punctuation">}</span>);
      <span class="hljs-punctuation">}</span> else <span class="hljs-punctuation">{</span>
        messageTracker.set(message.message_id<span class="hljs-punctuation">,</span> <span class="hljs-punctuation">{</span>
          count<span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
          firstTime<span class="hljs-punctuation">:</span> now<span class="hljs-punctuation">,</span>
          lastTime<span class="hljs-punctuation">:</span> now<span class="hljs-punctuation">,</span>
          messageTime<span class="hljs-punctuation">:</span> messageTime
        <span class="hljs-punctuation">}</span>);
      <span class="hljs-punctuation">}</span>

      <span class="hljs-comment">// æ£€æŸ¥ç”¨æˆ·è¯·æ±‚é¢‘ç‡é™åˆ¶</span>
      const userId = message.sender?.sender_id?.user_id || message.sender?.sender_id?.open_id || 'unknown_user';
      if (!rateLimiter.isAllowed(userId)) <span class="hljs-punctuation">{</span>
        const remaining = rateLimiter.getRemainingRequests(userId);
        console.log('ç”¨æˆ·è¯·æ±‚è¿‡äºé¢‘ç¹<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> userId);
        await sendFeishuMessage(message.message_id<span class="hljs-punctuation">,</span>
          'â° **è¯·æ±‚é¢‘ç‡æé†’**\n\n' +
          'ä¸ºäº†ä¿è¯æœåŠ¡è´¨é‡ï¼Œæ¯åˆ†é’Ÿæœ€å¤šå¤„ç†<span class="hljs-number">8</span>ä¸ªåˆ†æè¯·æ±‚ã€‚\n\n' +
          'ğŸ’¡ **å»ºè®®**ï¼š\n' +
          'â€¢ è¯·ç¨ç­‰ç‰‡åˆ»å†å‘é€æ–°çš„åˆ†æéœ€æ±‚\n' +
          'â€¢ å¯ä»¥å°†å¤šä¸ªé—®é¢˜åˆå¹¶ä¸ºä¸€ä¸ªè¯¦ç»†çš„åˆ†æè¯·æ±‚\n' +
          'â€¢ å¤æ‚åˆ†æé€šå¸¸éœ€è¦æ›´å¤šæ—¶é—´ï¼Œè¯·è€å¿ƒç­‰å¾…\n\n' +
          'æ„Ÿè°¢æ‚¨çš„ç†è§£ä¸é…åˆï¼ğŸ™'
        );
        return res.json(<span class="hljs-punctuation">{</span> StatusCode<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> StatusMessage<span class="hljs-punctuation">:</span> 'rate_limited' <span class="hljs-punctuation">}</span>);
      <span class="hljs-punctuation">}</span>

      console.log('æ”¶åˆ°æ¶ˆæ¯äº‹ä»¶<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> <span class="hljs-punctuation">{</span>
        message_type<span class="hljs-punctuation">:</span> message.message_type<span class="hljs-punctuation">,</span>
        message_id<span class="hljs-punctuation">:</span> message.message_id<span class="hljs-punctuation">,</span>
        chat_id<span class="hljs-punctuation">:</span> message.chat_id
      <span class="hljs-punctuation">}</span>);

      if (message.message_type === 'text') <span class="hljs-punctuation">{</span>
        const content = JSON.parse(message.content);
        const userMessage = content.text;

        console.log('æ”¶åˆ°ç”¨æˆ·æ¶ˆæ¯<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> userMessage);

      <span class="hljs-comment">// å±è”½ç³»ç»ŸæŒ‡ä»¤</span>
      if (userMessage.startsWith('/') || userMessage.includes('--') || userMessage.match(/^<span class="hljs-punctuation">[</span>a-z<span class="hljs-punctuation">]</span>+\s+<span class="hljs-punctuation">[</span>a-z<span class="hljs-punctuation">]</span>+/)) <span class="hljs-punctuation">{</span>
        console.log('å±è”½ç³»ç»ŸæŒ‡ä»¤<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> userMessage);
        await sendFeishuMessage(message.message_id<span class="hljs-punctuation">,</span>
          'ğŸ¯ **ä¸“ä¸šå¸‚åœºåˆ†æåŠ©æ‰‹**\n\n' +
          'æˆ‘æ˜¯ä¸“é—¨çš„å¸‚åœºåˆ†æAIï¼Œä¸“æ³¨äºä¸ºå¸‚åœºåˆ†æäººå‘˜æä¾›ä¸“ä¸šæœåŠ¡ï¼š\n\n' +
          'ğŸ“Š **æ ¸å¿ƒèƒ½åŠ›**\n' +
          'â€¢ è¡Œä¸šç ”ç©¶ä¸è¶‹åŠ¿åˆ†æ\n' +
          'â€¢ ç«å“å¯¹æ¯”ä¸å¸‚åœºå®šä½\n' +
          'â€¢ æ¶ˆè´¹è€…è¡Œä¸ºåˆ†æ\n' +
          'â€¢ å•†ä¸šæ¨¡å¼è¯„ä¼°\n' +
          'â€¢ æŠ•èµ„æœºä¼šè¯†åˆ«\n\n' +
          'ğŸ’¡ **ä½¿ç”¨ç¤ºä¾‹**\n' +
          'â€¢ <span class="hljs-string">"åˆ†æä¸€ä¸‹AIè¡Œä¸šçš„å‘å±•è¶‹åŠ¿"</span>\n' +
          'â€¢ <span class="hljs-string">"å¸®æˆ‘åšç”µå•†å¹³å°çš„ç«å“åˆ†æ"</span>\n' +
          'â€¢ <span class="hljs-string">"æ–°èƒ½æºæ±½è½¦å¸‚åœºå‰æ™¯å¦‚ä½•"</span>\n' +
          'â€¢ <span class="hljs-string">"åˆ†æZä¸–ä»£çš„æ¶ˆè´¹ç‰¹ç‚¹"</span>\n\n' +
          'è¯·å‘Šè¯‰æˆ‘æ‚¨éœ€è¦åˆ†æçš„å…·ä½“å¸‚åœºã€äº§å“æˆ–è¡Œä¸šï¼Œæˆ‘å°†ä¸ºæ‚¨æä¾›ä¸“ä¸šçš„åˆ†ææŠ¥å‘Šã€‚'
        );
        return res.json(<span class="hljs-punctuation">{</span> StatusCode<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> StatusMessage<span class="hljs-punctuation">:</span> 'success' <span class="hljs-punctuation">}</span>);
      <span class="hljs-punctuation">}</span>

      <span class="hljs-comment">// è·å–ç”¨æˆ·IDç”¨äºä¸Šä¸‹æ–‡ç®¡ç†</span>
      const userId = message.sender?.sender_id?.user_id || message.sender?.sender_id?.open_id || 'unknown_user';

      <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸ºè¿½é—®ï¼ˆè¿½é—®åº”è¯¥è·³è¿‡ä¸šåŠ¡ç›¸å…³æ€§æ£€æŸ¥ï¼‰</span>
      const isFollowUpQuestion = intelligentRouter.isFollowUpQuestion(userMessage);

      <span class="hljs-comment">// ä½¿ç”¨æ™ºèƒ½è·¯ç”±é€‰æ‹©Agent</span>
      const agentName = intelligentRouter.getAgentWithContext(userId<span class="hljs-punctuation">,</span> userMessage);
      const agentTitle = intelligentRouter.getAgentTitle(agentName);

      console.log(`æ™ºèƒ½è·¯ç”±é€‰æ‹©<span class="hljs-punctuation">:</span> $<span class="hljs-punctuation">{</span>agentName<span class="hljs-punctuation">}</span> ($<span class="hljs-punctuation">{</span>agentTitle<span class="hljs-punctuation">}</span>) for user<span class="hljs-punctuation">:</span> $<span class="hljs-punctuation">{</span>userId<span class="hljs-punctuation">}</span>`);

      <span class="hljs-comment">// ä¸šåŠ¡ç›¸å…³æ€§æ£€æŸ¥ï¼ˆè¿½é—®è·³è¿‡æ­¤æ£€æŸ¥ï¼‰</span>
      if (!isFollowUpQuestion) <span class="hljs-punctuation">{</span>
        const businessKeywords = <span class="hljs-punctuation">[</span>
          'åˆ†æ'<span class="hljs-punctuation">,</span> 'å¸‚åœº'<span class="hljs-punctuation">,</span> 'è¡Œä¸š'<span class="hljs-punctuation">,</span> 'ç«å“'<span class="hljs-punctuation">,</span> 'è¶‹åŠ¿'<span class="hljs-punctuation">,</span> 'ç ”ç©¶'<span class="hljs-punctuation">,</span> 'è°ƒç ”'<span class="hljs-punctuation">,</span> 'æŠ¥å‘Š'<span class="hljs-punctuation">,</span> 'æ•°æ®'<span class="hljs-punctuation">,</span> 'å•†ä¸š'<span class="hljs-punctuation">,</span> 'äº§å“'<span class="hljs-punctuation">,</span> 'å…¬å¸'<span class="hljs-punctuation">,</span> 'æ¶ˆè´¹'<span class="hljs-punctuation">,</span> 'ç”¨æˆ·'<span class="hljs-punctuation">,</span> 'å®¢æˆ·'<span class="hljs-punctuation">,</span>
          'å…¬å…³'<span class="hljs-punctuation">,</span> 'PR'<span class="hljs-punctuation">,</span> 'å±æœº'<span class="hljs-punctuation">,</span> 'åª’ä½“'<span class="hljs-punctuation">,</span> 'ä¼ æ’­'<span class="hljs-punctuation">,</span> 'å“ç‰Œ'<span class="hljs-punctuation">,</span> 'å£°èª‰'<span class="hljs-punctuation">,</span> 'èˆ†æƒ…'<span class="hljs-punctuation">,</span> 'æ–°é—»'<span class="hljs-punctuation">,</span> 'å‘å¸ƒä¼š'<span class="hljs-punctuation">,</span>
          'è¥é”€'<span class="hljs-punctuation">,</span> 'æ¨å¹¿'<span class="hljs-punctuation">,</span> 'è·å®¢'<span class="hljs-punctuation">,</span> 'å¢é•¿'<span class="hljs-punctuation">,</span> 'è½¬åŒ–'<span class="hljs-punctuation">,</span> 'ç•™å­˜'<span class="hljs-punctuation">,</span> 'æ´»åŠ¨'<span class="hljs-punctuation">,</span> 'å¹¿å‘Š'<span class="hljs-punctuation">,</span> 'æŠ•æ”¾'<span class="hljs-punctuation">,</span> 'ROI'
        <span class="hljs-punctuation">]</span>;

        const isBusinessRelated = businessKeywords.some(keyword =&gt; userMessage.includes(keyword));

        if (!isBusinessRelated) <span class="hljs-punctuation">{</span>
          console.log('éç›¸å…³ä¸šåŠ¡éœ€æ±‚ï¼Œè¿›è¡Œå¼•å¯¼');
          await sendFeishuMessage(message.message_id<span class="hljs-punctuation">,</span>
            'ğŸ¯ **ä¸“ä¸šå•†ä¸šæœåŠ¡å›¢é˜Ÿ**\n\n' +
            'æˆ‘ä»¬æä¾›ä¸‰å¤§ä¸“ä¸šæœåŠ¡é¢†åŸŸï¼š\n\n' +
            'ğŸ“Š **å¸‚åœºåˆ†æå¸ˆ**ï¼šè¡Œä¸šç ”ç©¶ã€ç«å“åˆ†æã€è¶‹åŠ¿é¢„æµ‹ã€å•†ä¸šæ´å¯Ÿ\n' +
            'ğŸ“¢ **å…¬å…³ä¸“å‘˜**ï¼šå“ç‰Œä¼ æ’­ã€å±æœºå…¬å…³ã€åª’ä½“å…³ç³»ã€å£°èª‰ç®¡ç†\n' +
            'ğŸ“ˆ **è¥é”€ä¸“å‘˜**ï¼šæ•°å­—è¥é”€ã€ç”¨æˆ·å¢é•¿ã€è¥é”€ç­–ç•¥ã€ROIä¼˜åŒ–\n\n' +
            'ğŸ’¡ **ä½¿ç”¨ç¤ºä¾‹**\n' +
            'â€¢ å¸‚åœºåˆ†æï¼š<span class="hljs-string">"åˆ†æAIè¡Œä¸šå‘å±•è¶‹åŠ¿"</span>\n' +
            'â€¢ å…¬å…³ä¼ æ’­ï¼š<span class="hljs-string">"åˆ¶å®šå“ç‰Œå±æœºå…¬å…³ç­–ç•¥"</span>\n' +
            'â€¢ è¥é”€æ¨å¹¿ï¼š<span class="hljs-string">"è®¾è®¡ç”¨æˆ·å¢é•¿è¥é”€æ–¹æ¡ˆ"</span>\n\n' +
            'è¯·æè¿°æ‚¨çš„å…·ä½“éœ€æ±‚ï¼Œæˆ‘å°†åŒ¹é…æœ€åˆé€‚çš„ä¸“ä¸šé¡¾é—®ä¸ºæ‚¨æœåŠ¡ã€‚'
          );
          return res.json(<span class="hljs-punctuation">{</span> StatusCode<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> StatusMessage<span class="hljs-punctuation">:</span> 'success' <span class="hljs-punctuation">}</span>);
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span> else <span class="hljs-punctuation">{</span>
        console.log('æ£€æµ‹åˆ°è¿½é—®ï¼Œè·³è¿‡ä¸šåŠ¡ç›¸å…³æ€§æ£€æŸ¥');
      <span class="hljs-punctuation">}</span>

        <span class="hljs-comment">// ç«‹å³å‘é€ç¡®è®¤æ¶ˆæ¯</span>
        const agentPreResponse = intelligentRouter.getAgentPreResponse(agentName);
        const confirmMsg = `$<span class="hljs-punctuation">{</span>agentTitle<span class="hljs-punctuation">}</span> å·²æ¥æ”¶æ‚¨çš„è¯·æ±‚\n\n` +
                          `$<span class="hljs-punctuation">{</span>agentPreResponse<span class="hljs-punctuation">}</span>\n` +
                          `â±ï¸ é¢„è®¡éœ€è¦ <span class="hljs-number">30</span><span class="hljs-number">-90</span> ç§’\n` +
                          `ğŸ“ è¯·ç¨å€™ï¼Œæˆ‘æ­£åœ¨ä¸ºæ‚¨å‡†å¤‡ä¸“ä¸šåˆ†ææŠ¥å‘Š`;

        await sendFeishuMessage(message.message_id<span class="hljs-punctuation">,</span> confirmMsg);
        console.log('å·²å‘é€ç¡®è®¤æ¶ˆæ¯ç»™ç”¨æˆ·');

        try <span class="hljs-punctuation">{</span>
          <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦æ’é˜Ÿ</span>
          const poolStats = qPool.getStats();
          if (poolStats.queueLength &gt; <span class="hljs-number">0</span>) <span class="hljs-punctuation">{</span>
            const queueMsg = `â³ ç³»ç»Ÿç¹å¿™ï¼Œæ‚¨çš„è¯·æ±‚å·²åŠ å…¥å¤„ç†é˜Ÿåˆ—\n\n` +
                           `ğŸ“‹ å½“å‰æ’é˜Ÿï¼š$<span class="hljs-punctuation">{</span>poolStats.queueLength<span class="hljs-punctuation">}</span> ä¸ªè¯·æ±‚\n` +
                           `â±ï¸ é¢„è®¡ç­‰å¾…ï¼š$<span class="hljs-punctuation">{</span>Math.ceil(poolStats.queueLength * <span class="hljs-number">45</span>)<span class="hljs-punctuation">}</span> ç§’\n` +
                           `ğŸ¯ æˆ‘ä¼šå°½å¿«ä¸ºæ‚¨æä¾›ä¸“ä¸šåˆ†æ`;

            await sendFeishuMessage(message.message_id<span class="hljs-punctuation">,</span> queueMsg);
          <span class="hljs-punctuation">}</span>

          const qResponse = await callAmazonQ(userMessage<span class="hljs-punctuation">,</span> agentName<span class="hljs-punctuation">,</span> message.message_id);
          console.log('Amazon Qå›å¤<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> qResponse);

          if (qResponse &amp;&amp; qResponse.length &gt; <span class="hljs-number">0</span>) <span class="hljs-punctuation">{</span>
            <span class="hljs-comment">// æ·»åŠ å®Œæˆæ ‡è¯†</span>
            const finalResponse = `âœ… åˆ†æå®Œæˆ\n\n$<span class="hljs-punctuation">{</span>qResponse<span class="hljs-punctuation">}</span>\n\n---\nğŸ’¡ å¦‚éœ€è¿›ä¸€æ­¥åˆ†æï¼Œè¯·éšæ—¶æé—®`;
            await sendFeishuMessage(message.message_id<span class="hljs-punctuation">,</span> finalResponse);
          <span class="hljs-punctuation">}</span> else <span class="hljs-punctuation">{</span>
            await sendFeishuMessage(message.message_id<span class="hljs-punctuation">,</span>
              'ğŸ¤” åˆ†æé‡åˆ°é—®é¢˜\n\n' +
              'æŠ±æ­‰ï¼Œå½“å‰æ— æ³•å®Œæˆæ‚¨çš„åˆ†æè¯·æ±‚ã€‚\n\n' +
              'ğŸ’¡ å»ºè®®å°è¯•ï¼š\n' +
              'â€¢ é‡æ–°æè¿°æ‚¨çš„åˆ†æéœ€æ±‚\n' +
              'â€¢ æä¾›æ›´å…·ä½“çš„è¡Œä¸šæˆ–äº§å“ä¿¡æ¯\n' +
              'â€¢ ç¨åå†æ¬¡å°è¯•\n\n' +
              'å¦‚é—®é¢˜æŒç»­ï¼Œè¯·è”ç³»æŠ€æœ¯æ”¯æŒã€‚'
            );
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span> catch (error) <span class="hljs-punctuation">{</span>
          console.error('å¤„ç†æ¶ˆæ¯å¤±è´¥<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> error.message);

          let errorMsg = 'âš ï¸ æœåŠ¡æš‚æ—¶ç¹å¿™\n\n';
          if (error.message.includes('è¶…æ—¶')) <span class="hljs-punctuation">{</span>
            errorMsg += 'æ‚¨çš„åˆ†æè¯·æ±‚æ¯”è¾ƒå¤æ‚ï¼Œå¤„ç†æ—¶é—´è¾ƒé•¿ã€‚\n\n' +
                       'ğŸ’¡ å»ºè®®ï¼š\n' +
                       'â€¢ å°è¯•å°†é—®é¢˜æ‹†åˆ†ä¸ºæ›´å…·ä½“çš„å°é—®é¢˜\n' +
                       'â€¢ ç¨åé‡æ–°æäº¤åˆ†æè¯·æ±‚\n' +
                       'â€¢ æä¾›æ›´æ˜ç¡®çš„åˆ†æèŒƒå›´';
          <span class="hljs-punctuation">}</span> else <span class="hljs-punctuation">{</span>
            errorMsg += 'ç³»ç»Ÿæ­£åœ¨å¤„ç†å¤§é‡åˆ†æè¯·æ±‚ã€‚\n\n' +
                       'ğŸ’¡ å»ºè®®ï¼š\n' +
                       'â€¢ è¯·ç¨ç­‰ç‰‡åˆ»åé‡è¯•\n' +
                       'â€¢ ç¡®ä¿é—®é¢˜æè¿°æ¸…æ™°å…·ä½“\n' +
                       'â€¢ é¿å…é‡å¤å‘é€ç›¸åŒè¯·æ±‚';
          <span class="hljs-punctuation">}</span>

          await sendFeishuMessage(message.message_id<span class="hljs-punctuation">,</span> errorMsg);
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>

      <span class="hljs-comment">// å¤„ç†å¯Œæ–‡æœ¬æ¶ˆæ¯</span>
      if (message.message_type === 'post') <span class="hljs-punctuation">{</span>
        const content = JSON.parse(message.content);
        let userText = '';

        console.log('æ”¶åˆ°å¯Œæ–‡æœ¬æ¶ˆæ¯<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> message.message_id);

        <span class="hljs-comment">// è§£æå¯Œæ–‡æœ¬å†…å®¹ï¼Œåªæå–æ–‡æœ¬</span>
        if (content.content &amp;&amp; Array.isArray(content.content)) <span class="hljs-punctuation">{</span>
          content.content.forEach(block =&gt; <span class="hljs-punctuation">{</span>
            if (Array.isArray(block)) <span class="hljs-punctuation">{</span>
              block.forEach(element =&gt; <span class="hljs-punctuation">{</span>
                if (element.tag === 'text' &amp;&amp; element.text) <span class="hljs-punctuation">{</span>
                  userText += element.text.trim() + ' ';
                <span class="hljs-punctuation">}</span>
              <span class="hljs-punctuation">}</span>);
            <span class="hljs-punctuation">}</span>
          <span class="hljs-punctuation">}</span>);
        <span class="hljs-punctuation">}</span>

        <span class="hljs-comment">// å¦‚æœæœ‰æ–‡æœ¬å†…å®¹ï¼ŒæŒ‰æ™®é€šæ–‡æœ¬å¤„ç†</span>
        if (userText.trim()) <span class="hljs-punctuation">{</span>
          console.log('å¯Œæ–‡æœ¬æ¶ˆæ¯è½¬ä¸ºæ–‡æœ¬å¤„ç†<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> userText.trim());
          <span class="hljs-comment">// ç»§ç»­å¤„ç†æ–‡æœ¬å†…å®¹</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>

    <span class="hljs-comment">// å¤„ç†æ‰€æœ‰å…¶ä»–äº‹ä»¶ç±»å‹</span>
    if (body.header &amp;&amp; body.header.event_type) <span class="hljs-punctuation">{</span>
      console.log('ğŸ” æ”¶åˆ°å…¶ä»–äº‹ä»¶ç±»å‹<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> body.header.event_type);

      <span class="hljs-comment">// å°è¯•å¤„ç†å…¶ä»–æ¶ˆæ¯äº‹ä»¶</span>
      if (body.header.event_type.includes('message') &amp;&amp; body.event) <span class="hljs-punctuation">{</span>
        console.log('ğŸ”„ å°è¯•å¤„ç†æ¶ˆæ¯äº‹ä»¶');
        const event = body.event;

        if (event.message || event.content) <span class="hljs-punctuation">{</span>
          console.log('ğŸ“ æ‰¾åˆ°æ¶ˆæ¯å†…å®¹ï¼Œå°è¯•å¤„ç†');
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>

    <span class="hljs-comment">// é£ä¹¦è¦æ±‚çš„æˆåŠŸå“åº”æ ¼å¼</span>
    res.status(<span class="hljs-number">200</span>).json(<span class="hljs-punctuation">{</span>
      StatusCode<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
      StatusMessage<span class="hljs-punctuation">:</span> <span class="hljs-string">"success"</span>
    <span class="hljs-punctuation">}</span>);

  <span class="hljs-punctuation">}</span> catch (error) <span class="hljs-punctuation">{</span>
    console.error('å¤„ç†é”™è¯¯<span class="hljs-punctuation">:</span>'<span class="hljs-punctuation">,</span> error);
    res.status(<span class="hljs-number">200</span>).json(<span class="hljs-punctuation">{</span>
      StatusCode<span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
      StatusMessage<span class="hljs-punctuation">:</span> <span class="hljs-string">"error"</span>
    <span class="hljs-punctuation">}</span>);
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>);

const certOptions = <span class="hljs-punctuation">{</span>
  key<span class="hljs-punctuation">:</span> fs.readFileSync('/home/ubuntu/feishu-webhook/key.pem')<span class="hljs-punctuation">,</span>
  cert<span class="hljs-punctuation">:</span> fs.readFileSync('/home/ubuntu/feishu-webhook/cert.pem')
<span class="hljs-punctuation">}</span>;

https.createServer(certOptions<span class="hljs-punctuation">,</span> app).listen(<span class="hljs-number">8443</span><span class="hljs-punctuation">,</span> () =&gt; <span class="hljs-punctuation">{</span>
  console.log('é£ä¹¦webhookæœåŠ¡å¯åŠ¨<span class="hljs-punctuation">:</span> https<span class="hljs-punctuation">:</span><span class="hljs-comment">//amazonq.moveinsync.cn:8443');</span>
  console.log('Webhook URL<span class="hljs-punctuation">:</span> https<span class="hljs-punctuation">:</span><span class="hljs-comment">//amazonq.moveinsync.cn/webhook');</span>
<span class="hljs-punctuation">}</span>);    
</code></pre>
<pre><code class="hljs language-JSON" lang="JSON"><span class="hljs-comment">// package.json</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"feishu"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"server.js"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"start"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node server.js"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"axios"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^1.11.0"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"express"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"^4.18.2"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// æ™ºèƒ½è·¯ç”±æ¨¡å— intelligent-router.js</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">IntelligentRouter</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ç”¨æˆ·ä¸Šä¸‹æ–‡å­˜å‚¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">userContexts</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();

    <span class="hljs-comment">// æƒé‡åŒ–å…³é”®è¯é…ç½®</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">keywords</span> = {
      <span class="hljs-string">'market-analyst'</span>: {
        <span class="hljs-attr">high</span>: [<span class="hljs-string">'åˆ†æ'</span>, <span class="hljs-string">'ç ”ç©¶'</span>, <span class="hljs-string">'å¸‚åœº'</span>, <span class="hljs-string">'è¡Œä¸š'</span>, <span class="hljs-string">'ç«å“'</span>, <span class="hljs-string">'è¶‹åŠ¿'</span>, <span class="hljs-string">'è°ƒç ”'</span>, <span class="hljs-string">'æ•°æ®'</span>], <span class="hljs-comment">// æƒé‡3</span>
        <span class="hljs-attr">medium</span>: [<span class="hljs-string">'æŠ¥å‘Š'</span>, <span class="hljs-string">'æ´å¯Ÿ'</span>, <span class="hljs-string">'å•†ä¸š'</span>, <span class="hljs-string">'äº§å“'</span>, <span class="hljs-string">'ç”¨æˆ·'</span>, <span class="hljs-string">'æ¶ˆè´¹'</span>, <span class="hljs-string">'å®¢æˆ·'</span>], <span class="hljs-comment">// æƒé‡2</span>
        <span class="hljs-attr">low</span>: [<span class="hljs-string">'å…¬å¸'</span>, <span class="hljs-string">'ä¼ä¸š'</span>, <span class="hljs-string">'å‘å±•'</span>, <span class="hljs-string">'å‰æ™¯'</span>, <span class="hljs-string">'æœºä¼š'</span>, <span class="hljs-string">'é£é™©'</span>] <span class="hljs-comment">// æƒé‡1</span>
      },
      <span class="hljs-string">'pr-specialist'</span>: {
        <span class="hljs-attr">high</span>: [<span class="hljs-string">'å…¬å…³'</span>, <span class="hljs-string">'pr'</span>, <span class="hljs-string">'å±æœº'</span>, <span class="hljs-string">'åª’ä½“'</span>, <span class="hljs-string">'ä¼ æ’­'</span>, <span class="hljs-string">'å“ç‰Œ'</span>, <span class="hljs-string">'å£°èª‰'</span>, <span class="hljs-string">'ææ–™'</span>], <span class="hljs-comment">// æƒé‡3</span>
        <span class="hljs-attr">medium</span>: [<span class="hljs-string">'èˆ†æƒ…'</span>, <span class="hljs-string">'æ–°é—»'</span>, <span class="hljs-string">'å‘å¸ƒ'</span>, <span class="hljs-string">'å½¢è±¡'</span>, <span class="hljs-string">'å…³ç³»'</span>, <span class="hljs-string">'æ²Ÿé€š'</span>, <span class="hljs-string">'æ•…äº‹'</span>], <span class="hljs-comment">// æƒé‡2</span>
        <span class="hljs-attr">low</span>: [<span class="hljs-string">'å®£ä¼ '</span>, <span class="hljs-string">'æ¨ä»‹'</span>, <span class="hljs-string">'æ´»åŠ¨'</span>, <span class="hljs-string">'äº‹ä»¶'</span>, <span class="hljs-string">'è¯é¢˜'</span>, <span class="hljs-string">'å½±å“'</span>] <span class="hljs-comment">// æƒé‡1</span>
      },
      <span class="hljs-string">'marketing-specialist'</span>: {
        <span class="hljs-attr">high</span>: [<span class="hljs-string">'è¥é”€'</span>, <span class="hljs-string">'æ¨å¹¿'</span>, <span class="hljs-string">'è·å®¢'</span>, <span class="hljs-string">'å¢é•¿'</span>, <span class="hljs-string">'å¢é•¿ç‚¹'</span>, <span class="hljs-string">'è½¬åŒ–'</span>, <span class="hljs-string">'roi'</span>], <span class="hljs-comment">// æƒé‡3</span>
        <span class="hljs-attr">medium</span>: [<span class="hljs-string">'æ´»åŠ¨'</span>, <span class="hljs-string">'å¹¿å‘Š'</span>, <span class="hljs-string">'æŠ•æ”¾'</span>, <span class="hljs-string">'ç•™å­˜'</span>, <span class="hljs-string">'æ¸ é“'</span>, <span class="hljs-string">'ç­–ç•¥'</span>], <span class="hljs-comment">// æƒé‡2</span>
        <span class="hljs-attr">low</span>: [<span class="hljs-string">'ç”¨æˆ·'</span>, <span class="hljs-string">'å®¢æˆ·'</span>, <span class="hljs-string">'æµé‡'</span>, <span class="hljs-string">'æ›å…‰'</span>, <span class="hljs-string">'ç‚¹å‡»'</span>, <span class="hljs-string">'æ•ˆæœ'</span>] <span class="hljs-comment">// æƒé‡1</span>
      }
    };

    <span class="hljs-comment">// è¿½é—®æ¨¡å¼å…³é”®è¯</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">followUpPatterns</span> = [
      <span class="hljs-string">'ç»§ç»­'</span>, <span class="hljs-string">'è¿˜æœ‰'</span>, <span class="hljs-string">'å¦å¤–'</span>, <span class="hljs-string">'è¡¥å……'</span>, <span class="hljs-string">'è¯¦ç»†'</span>, <span class="hljs-string">'å…·ä½“'</span>,
      <span class="hljs-string">'é‚£ä¹ˆ'</span>, <span class="hljs-string">'å¦‚æœ'</span>, <span class="hljs-string">'å‡è®¾'</span>, <span class="hljs-string">'åŸºäºä¸Šé¢'</span>, <span class="hljs-string">'åˆšæ‰'</span>, <span class="hljs-string">'ä¹‹å‰'</span>,
      <span class="hljs-string">'ä¸Šæ–‡'</span>, <span class="hljs-string">'æåˆ°çš„'</span>, <span class="hljs-string">'åˆšè¯´çš„'</span>, <span class="hljs-string">'å‰é¢'</span>, <span class="hljs-string">'å“ªäº›'</span>, <span class="hljs-string">'ä»€ä¹ˆ'</span>,
      <span class="hljs-string">'æœ‰å“ªäº›'</span>, <span class="hljs-string">'éƒ½æœ‰'</span>, <span class="hljs-string">'åŒ…æ‹¬'</span>, <span class="hljs-string">'æ¯”å¦‚'</span>, <span class="hljs-string">'ä¾‹å¦‚'</span>, <span class="hljs-string">'ä¸»è¦æœ‰'</span>
    ];
  }

  <span class="hljs-comment">// å¤šç»´åº¦è¯„åˆ†æœºåˆ¶</span>
  <span class="hljs-title function_">calculateAgentScore</span>(<span class="hljs-params">userMessage</span>) {
    <span class="hljs-keyword">const</span> scores = {
      <span class="hljs-string">'market-analyst'</span>: <span class="hljs-number">0</span>,
      <span class="hljs-string">'pr-specialist'</span>: <span class="hljs-number">0</span>,
      <span class="hljs-string">'marketing-specialist'</span>: <span class="hljs-number">0</span>
    };

    <span class="hljs-keyword">const</span> message = userMessage.<span class="hljs-title function_">toLowerCase</span>();

    <span class="hljs-comment">// è®¡ç®—å„Agentå¾—åˆ†</span>
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">keywords</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">agent</span> =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">keywords</span>[agent].<span class="hljs-property">high</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">word</span> =&gt;</span> {
        <span class="hljs-keyword">if</span> (message.<span class="hljs-title function_">includes</span>(word)) scores[agent] += <span class="hljs-number">3</span>;
      });
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">keywords</span>[agent].<span class="hljs-property">medium</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">word</span> =&gt;</span> {
        <span class="hljs-keyword">if</span> (message.<span class="hljs-title function_">includes</span>(word)) scores[agent] += <span class="hljs-number">2</span>;
      });
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">keywords</span>[agent].<span class="hljs-property">low</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">word</span> =&gt;</span> {
        <span class="hljs-keyword">if</span> (message.<span class="hljs-title function_">includes</span>(word)) scores[agent] += <span class="hljs-number">1</span>;
      });
    });

    <span class="hljs-comment">// è¿”å›å¾—åˆ†æœ€é«˜çš„Agentï¼Œå¦‚æœå¾—åˆ†ç›¸åŒåˆ™è¿”å›market-analystä½œä¸ºé»˜è®¤</span>
    <span class="hljs-keyword">const</span> maxScore = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(...<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(scores));
    <span class="hljs-keyword">if</span> (maxScore === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'market-analyst'</span>; <span class="hljs-comment">// é»˜è®¤é€‰æ‹©</span>

    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(scores).<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">agent</span> =&gt;</span> scores[agent] === maxScore) || <span class="hljs-string">'market-analyst'</span>;
  }

  <span class="hljs-comment">// æ£€æµ‹æ˜¯å¦ä¸ºè¿½é—®</span>
  <span class="hljs-title function_">isFollowUpQuestion</span>(<span class="hljs-params">message</span>) {
    <span class="hljs-keyword">const</span> lowerMessage = message.<span class="hljs-title function_">toLowerCase</span>();

    <span class="hljs-comment">// ç›´æ¥è¿½é—®æ¨¡å¼æ£€æµ‹</span>
    <span class="hljs-keyword">const</span> hasFollowUpPattern = <span class="hljs-variable language_">this</span>.<span class="hljs-property">followUpPatterns</span>.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">pattern</span> =&gt;</span> lowerMessage.<span class="hljs-title function_">includes</span>(pattern));

    <span class="hljs-comment">// æ’é™¤ç‹¬ç«‹é—®å¥ï¼ˆåŒ…å«æ˜ç¡®ä¸»é¢˜çš„å®Œæ•´é—®å¥ï¼‰</span>
    <span class="hljs-keyword">const</span> independentTopics = [
      <span class="hljs-string">'å¤©æ°”'</span>, <span class="hljs-string">'æ—¶é—´'</span>, <span class="hljs-string">'æ—¥æœŸ'</span>, <span class="hljs-string">'ä½ å¥½'</span>, <span class="hljs-string">'è°¢è°¢'</span>, <span class="hljs-string">'å†è§'</span>, <span class="hljs-string">'å¸®åŠ©'</span>,
      <span class="hljs-string">'æ€ä¹ˆæ ·'</span>, <span class="hljs-string">'å¦‚ä½•'</span>, <span class="hljs-string">'ä¸ºä»€ä¹ˆ'</span>, <span class="hljs-string">'ä»€ä¹ˆæ—¶å€™'</span>, <span class="hljs-string">'åœ¨å“ªé‡Œ'</span>
    ];

    <span class="hljs-keyword">const</span> isIndependentQuestion = independentTopics.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">topic</span> =&gt;</span> lowerMessage.<span class="hljs-title function_">includes</span>(topic)) &amp;&amp;
                                 !<span class="hljs-variable language_">this</span>.<span class="hljs-property">followUpPatterns</span>.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">pattern</span> =&gt;</span> lowerMessage.<span class="hljs-title function_">includes</span>(pattern));

    <span class="hljs-keyword">if</span> (isIndependentQuestion) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// ç‹¬ç«‹é—®å¥ä¸æ˜¯è¿½é—®</span>
    }

    <span class="hljs-comment">// ç®€çŸ­é—®å¥æ£€æµ‹ï¼ˆé€šå¸¸æ˜¯è¿½é—®ï¼‰</span>
    <span class="hljs-keyword">const</span> isShortQuestion = message.<span class="hljs-property">length</span> &lt; <span class="hljs-number">20</span> &amp;&amp; (
      message.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'ï¼Ÿ'</span>) || message.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'?'</span>) ||
      message.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'å“ªäº›'</span>) || message.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'ä»€ä¹ˆ'</span>) ||
      message.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'å¦‚ä½•'</span>) || message.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'æ€ä¹ˆ'</span>)
    );

    <span class="hljs-comment">// æŒ‡ä»£æ€§é—®å¥æ£€æµ‹</span>
    <span class="hljs-keyword">const</span> hasReference = lowerMessage.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'çš„'</span>) &amp;&amp; (
      lowerMessage.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'ä¸»è¦'</span>) || lowerMessage.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'éƒ½æœ‰'</span>) ||
      lowerMessage.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'åŒ…æ‹¬'</span>) || lowerMessage.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'å“ç‰Œ'</span>)
    );

    <span class="hljs-keyword">return</span> hasFollowUpPattern || (isShortQuestion &amp;&amp; !isIndependentQuestion) || hasReference;
  }

  <span class="hljs-comment">// æå–ä¸»é¢˜å…³é”®è¯</span>
  <span class="hljs-title function_">extractTopics</span>(<span class="hljs-params">message</span>) {
    <span class="hljs-keyword">const</span> topics = [];
    <span class="hljs-keyword">const</span> allKeywords = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">keywords</span>).<span class="hljs-title function_">flatMap</span>(<span class="hljs-function"><span class="hljs-params">category</span> =&gt;</span>
      [...category.<span class="hljs-property">high</span>, ...category.<span class="hljs-property">medium</span>, ...category.<span class="hljs-property">low</span>]
    );

    allKeywords.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">keyword</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (message.<span class="hljs-title function_">includes</span>(keyword)) {
        topics.<span class="hljs-title function_">push</span>(keyword);
      }
    });

    <span class="hljs-keyword">return</span> topics.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>); <span class="hljs-comment">// æœ€å¤šä¿ç•™5ä¸ªä¸»é¢˜</span>
  }

  <span class="hljs-comment">// ä¸Šä¸‹æ–‡æ„ŸçŸ¥è·¯ç”± - é‡æ„ç‰ˆæœ¬</span>
  <span class="hljs-title function_">getAgentWithContext</span>(<span class="hljs-params">userId, userMessage</span>) {
    <span class="hljs-keyword">const</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-property">userContexts</span>.<span class="hljs-title function_">get</span>(userId) || {
      <span class="hljs-attr">recentAgents</span>: [],
      <span class="hljs-attr">topics</span>: [],
      <span class="hljs-attr">lastAgent</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">lastMessageTime</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">lastMessage</span>: <span class="hljs-string">''</span>
    };

    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">const</span> timeSinceLastMessage = now - context.<span class="hljs-property">lastMessageTime</span>;

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ” åˆ†æç”¨æˆ· <span class="hljs-subst">${userId}</span> çš„æ¶ˆæ¯: "<span class="hljs-subst">${userMessage}</span>"`</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ“Š ä¸Šä¸‹æ–‡ä¿¡æ¯: ä¸Šæ¬¡Agent=<span class="hljs-subst">${context.lastAgent}</span>, æ—¶é—´é—´éš”=<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.round(timeSinceLastMessage/<span class="hljs-number">1000</span>)}</span>ç§’`</span>);

    <span class="hljs-comment">// æ­¥éª¤1: åˆ¤æ–­é—®é¢˜åˆ†ç±»</span>
    <span class="hljs-keyword">const</span> questionType = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">classifyQuestion</span>(userMessage, context, timeSinceLastMessage);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ“‹ é—®é¢˜åˆ†ç±»: <span class="hljs-subst">${questionType.<span class="hljs-keyword">type</span>}</span> (ç½®ä¿¡åº¦: <span class="hljs-subst">${questionType.confidence.toFixed(<span class="hljs-number">3</span>)}</span>)`</span>);

    <span class="hljs-keyword">let</span> selectedAgent;

    <span class="hljs-keyword">switch</span> (questionType.<span class="hljs-property">type</span>) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'RELATED_FOLLOWUP'</span>:
        <span class="hljs-comment">// ä¸åŸæœ‰é—®é¢˜ç›¸å…³ï¼Œä¼ é€’ä¸Šä¸‹æ–‡ç»™åŒä¸€Agent</span>
        selectedAgent = context.<span class="hljs-property">lastAgent</span> || <span class="hljs-string">'market-analyst'</span>;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ”„ ç›¸å…³è¿½é—®ï¼Œç»§ç»­ä½¿ç”¨ <span class="hljs-subst">${selectedAgent}</span>`</span>);
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-string">'UNRELATED_NEW'</span>:
        <span class="hljs-comment">// ä¸åŸæœ‰é—®é¢˜æ— å…³ï¼Œé‡æ–°åˆ†æå¹¶é€‰æ‹©Agent</span>
        selectedAgent = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateAgentScore</span>(userMessage);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ†• æ— å…³æ–°é—®é¢˜ï¼Œé‡æ–°é€‰æ‹© <span class="hljs-subst">${selectedAgent}</span>`</span>);
        <span class="hljs-comment">// æ¸…ç†æ—§ä¸Šä¸‹æ–‡</span>
        context.<span class="hljs-property">topics</span> = [];
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-string">'NEW_QUESTION'</span>:
      <span class="hljs-attr">default</span>:
        <span class="hljs-comment">// æ–°é—®é¢˜ï¼Œæ ¹æ®å†…å®¹åˆ†ç±»ç»™ä¸åŒAgent</span>
        selectedAgent = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateAgentScore</span>(userMessage);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`â“ æ–°é—®é¢˜ï¼Œåˆ†æåé€‰æ‹© <span class="hljs-subst">${selectedAgent}</span>`</span>);
        <span class="hljs-keyword">break</span>;
    }

    <span class="hljs-comment">// æ›´æ–°ç”¨æˆ·ä¸Šä¸‹æ–‡</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateUserContext</span>(userId, selectedAgent, userMessage, now);

    <span class="hljs-keyword">return</span> selectedAgent;
  }

  <span class="hljs-comment">// é—®é¢˜åˆ†ç±»æ–¹æ³• - ä¼˜åŒ–ç‰ˆæœ¬</span>
  <span class="hljs-title function_">classifyQuestion</span>(<span class="hljs-params">userMessage, context, timeSinceLastMessage</span>) {
    <span class="hljs-keyword">const</span> message = userMessage.<span class="hljs-title function_">toLowerCase</span>();

    <span class="hljs-comment">// å¦‚æœæ²¡æœ‰å†å²ä¸Šä¸‹æ–‡æˆ–æ—¶é—´é—´éš”å¤ªé•¿(&gt;30åˆ†é’Ÿ)ï¼Œç›´æ¥åˆ¤å®šä¸ºæ–°é—®é¢˜</span>
    <span class="hljs-keyword">if</span> (!context.<span class="hljs-property">lastAgent</span> || timeSinceLastMessage &gt; <span class="hljs-number">30</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>) {
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">'NEW_QUESTION'</span>, <span class="hljs-attr">confidence</span>: <span class="hljs-number">0.9</span> };
    }

    <span class="hljs-comment">// ä¼˜å…ˆæ£€æŸ¥æ–°é¢†åŸŸè¯·æ±‚ - æé«˜æƒé‡</span>
    <span class="hljs-keyword">const</span> isNewDomain = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isNewDomainRequest</span>(userMessage);
    <span class="hljs-keyword">if</span> (isNewDomain) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ”„ æ£€æµ‹åˆ°æ–°é¢†åŸŸè¯·æ±‚æ ‡è¯†ç¬¦`</span>);
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">'UNRELATED_NEW'</span>, <span class="hljs-attr">confidence</span>: <span class="hljs-number">0.9</span> };
    }

    <span class="hljs-comment">// æ£€æŸ¥Agenté¢†åŸŸåˆ‡æ¢ - æ–°å¢å¼ºåŒ–æ£€æµ‹</span>
    <span class="hljs-keyword">const</span> currentAgentScore = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateAgentScore</span>(userMessage);
    <span class="hljs-keyword">const</span> lastAgent = context.<span class="hljs-property">lastAgent</span>;

    <span class="hljs-comment">// å¦‚æœå½“å‰æ¶ˆæ¯æ˜æ˜¾æŒ‡å‘ä¸åŒçš„Agenté¢†åŸŸ</span>
    <span class="hljs-keyword">if</span> (currentAgentScore !== lastAgent) {
      <span class="hljs-keyword">const</span> agentSwitchConfidence = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateAgentSwitchConfidence</span>(userMessage, lastAgent, currentAgentScore);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ¯ Agentåˆ‡æ¢æ£€æµ‹: <span class="hljs-subst">${lastAgent}</span> â†’ <span class="hljs-subst">${currentAgentScore}</span>, ç½®ä¿¡åº¦: <span class="hljs-subst">${agentSwitchConfidence.toFixed(<span class="hljs-number">3</span>)}</span>`</span>);

      <span class="hljs-keyword">if</span> (agentSwitchConfidence &gt; <span class="hljs-number">0.7</span>) {
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">'UNRELATED_NEW'</span>, <span class="hljs-attr">confidence</span>: agentSwitchConfidence };
      }
    }

    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦ä¸ºæ˜æ˜¾çš„è¿½é—®</span>
    <span class="hljs-keyword">const</span> isFollowUp = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isFollowUpQuestion</span>(userMessage);
    <span class="hljs-keyword">if</span> (isFollowUp) {
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">'RELATED_FOLLOWUP'</span>, <span class="hljs-attr">confidence</span>: <span class="hljs-number">0.8</span> };
    }

    <span class="hljs-comment">// æ£€æŸ¥ä¸»é¢˜ç›¸å…³æ€§</span>
    <span class="hljs-keyword">const</span> currentTopics = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">extractTopics</span>(userMessage);
    <span class="hljs-keyword">const</span> topicSimilarity = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateTopicSimilarity</span>(currentTopics, context.<span class="hljs-property">topics</span>);

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ·ï¸ ä¸»é¢˜ç›¸ä¼¼åº¦: <span class="hljs-subst">${topicSimilarity.toFixed(<span class="hljs-number">3</span>)}</span>`</span>);

    <span class="hljs-comment">// æ ¹æ®ä¸»é¢˜ç›¸ä¼¼åº¦åˆ¤æ–­</span>
    <span class="hljs-keyword">if</span> (topicSimilarity &gt; <span class="hljs-number">0.6</span>) {
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">'RELATED_FOLLOWUP'</span>, <span class="hljs-attr">confidence</span>: topicSimilarity };
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (topicSimilarity &lt; <span class="hljs-number">0.3</span>) {
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">'UNRELATED_NEW'</span>, <span class="hljs-attr">confidence</span>: <span class="hljs-number">1</span> - topicSimilarity };
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: <span class="hljs-string">'NEW_QUESTION'</span>, <span class="hljs-attr">confidence</span>: <span class="hljs-number">0.6</span> };
    }
  }

  <span class="hljs-comment">// è®¡ç®—Agentåˆ‡æ¢ç½®ä¿¡åº¦</span>
  <span class="hljs-title function_">calculateAgentSwitchConfidence</span>(<span class="hljs-params">userMessage, lastAgent, currentAgent</span>) {
    <span class="hljs-keyword">const</span> message = userMessage.<span class="hljs-title function_">toLowerCase</span>();

    <span class="hljs-comment">// è·å–å½“å‰Agentçš„å…³é”®è¯åŒ¹é…å¼ºåº¦</span>
    <span class="hljs-keyword">const</span> currentAgentKeywords = <span class="hljs-variable language_">this</span>.<span class="hljs-property">keywords</span>[currentAgent] || { <span class="hljs-attr">high</span>: [], <span class="hljs-attr">medium</span>: [], <span class="hljs-attr">low</span>: [] };
    <span class="hljs-keyword">let</span> matchStrength = <span class="hljs-number">0</span>;

    <span class="hljs-comment">// è®¡ç®—åŒ¹é…å¼ºåº¦</span>
    currentAgentKeywords.<span class="hljs-property">high</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">word</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (message.<span class="hljs-title function_">includes</span>(word)) matchStrength += <span class="hljs-number">3</span>;
    });
    currentAgentKeywords.<span class="hljs-property">medium</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">word</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (message.<span class="hljs-title function_">includes</span>(word)) matchStrength += <span class="hljs-number">2</span>;
    });
    currentAgentKeywords.<span class="hljs-property">low</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">word</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (message.<span class="hljs-title function_">includes</span>(word)) matchStrength += <span class="hljs-number">1</span>;
    });

    <span class="hljs-comment">// æ£€æŸ¥ä¸“ä¸šé¢†åŸŸå¼ºæŒ‡ç¤ºè¯</span>
    <span class="hljs-keyword">const</span> strongIndicators = {
      <span class="hljs-string">'pr-specialist'</span>: [<span class="hljs-string">'å…¬å…³'</span>, <span class="hljs-string">'å±æœº'</span>, <span class="hljs-string">'å“ç‰Œ'</span>, <span class="hljs-string">'åª’ä½“'</span>, <span class="hljs-string">'ä¼ æ’­'</span>, <span class="hljs-string">'å£°èª‰'</span>, <span class="hljs-string">'æ–°é—»'</span>],
      <span class="hljs-string">'marketing-specialist'</span>: [<span class="hljs-string">'è¥é”€'</span>, <span class="hljs-string">'æ¨å¹¿'</span>, <span class="hljs-string">'è·å®¢'</span>, <span class="hljs-string">'è½¬åŒ–'</span>, <span class="hljs-string">'å¹¿å‘Š'</span>, <span class="hljs-string">'æ´»åŠ¨'</span>, <span class="hljs-string">'ç”¨æˆ·å¢é•¿'</span>, <span class="hljs-string">'å¢é•¿ç‚¹'</span>],
      <span class="hljs-string">'market-analyst'</span>: [<span class="hljs-string">'åˆ†æ'</span>, <span class="hljs-string">'å¸‚åœº'</span>, <span class="hljs-string">'ç«å“'</span>, <span class="hljs-string">'è¡Œä¸š'</span>, <span class="hljs-string">'è¶‹åŠ¿'</span>, <span class="hljs-string">'æ•°æ®'</span>, <span class="hljs-string">'æŠ¥å‘Š'</span>]
    };

    <span class="hljs-keyword">const</span> indicators = strongIndicators[currentAgent] || [];
    <span class="hljs-keyword">let</span> strongMatch = <span class="hljs-number">0</span>;
    indicators.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">indicator</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (message.<span class="hljs-title function_">includes</span>(indicator)) strongMatch += <span class="hljs-number">1</span>;
    });

    <span class="hljs-comment">// ç»¼åˆè®¡ç®—ç½®ä¿¡åº¦</span>
    <span class="hljs-keyword">let</span> confidence = <span class="hljs-number">0.5</span>;

    <span class="hljs-keyword">if</span> (strongMatch &gt; <span class="hljs-number">0</span>) {
      confidence += strongMatch * <span class="hljs-number">0.2</span>; <span class="hljs-comment">// å¼ºæŒ‡ç¤ºè¯åŠ æƒ</span>
    }

    <span class="hljs-keyword">if</span> (matchStrength &gt; <span class="hljs-number">2</span>) {
      confidence += <span class="hljs-number">0.3</span>; <span class="hljs-comment">// å…³é”®è¯åŒ¹é…å¼ºåº¦åŠ æƒ</span>
    }

    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-number">0.95</span>, confidence);
  }

  <span class="hljs-comment">// è®¡ç®—ä¸»é¢˜ç›¸ä¼¼åº¦</span>
  <span class="hljs-title function_">calculateTopicSimilarity</span>(<span class="hljs-params">currentTopics, previousTopics</span>) {
    <span class="hljs-keyword">if</span> (currentTopics.<span class="hljs-property">length</span> === <span class="hljs-number">0</span> || previousTopics.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }

    <span class="hljs-keyword">let</span> matchCount = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> currentTopic <span class="hljs-keyword">of</span> currentTopics) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> prevTopic <span class="hljs-keyword">of</span> previousTopics) {
        <span class="hljs-comment">// æ£€æŸ¥å®Œå…¨åŒ¹é…æˆ–åŒ…å«å…³ç³»</span>
        <span class="hljs-keyword">if</span> (currentTopic === prevTopic ||
            currentTopic.<span class="hljs-title function_">includes</span>(prevTopic) ||
            prevTopic.<span class="hljs-title function_">includes</span>(currentTopic)) {
          matchCount++;
          <span class="hljs-keyword">break</span>;
        }
      }
    }

    <span class="hljs-keyword">return</span> matchCount / <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(currentTopics.<span class="hljs-property">length</span>, previousTopics.<span class="hljs-property">length</span>);
  }

  <span class="hljs-comment">// æ›´æ–°ç”¨æˆ·ä¸Šä¸‹æ–‡</span>
  <span class="hljs-title function_">updateUserContext</span>(<span class="hljs-params">userId, selectedAgent, userMessage, timestamp</span>) {
    <span class="hljs-keyword">const</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-property">userContexts</span>.<span class="hljs-title function_">get</span>(userId) || {
      <span class="hljs-attr">recentAgents</span>: [],
      <span class="hljs-attr">topics</span>: [],
      <span class="hljs-attr">lastAgent</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">lastMessageTime</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">lastMessage</span>: <span class="hljs-string">''</span>
    };

    <span class="hljs-comment">// æ›´æ–°åŸºæœ¬ä¿¡æ¯</span>
    context.<span class="hljs-property">lastAgent</span> = selectedAgent;
    context.<span class="hljs-property">lastMessageTime</span> = timestamp;
    context.<span class="hljs-property">lastMessage</span> = userMessage;

    <span class="hljs-comment">// æ›´æ–°Agentå†å²</span>
    <span class="hljs-keyword">if</span> (!context.<span class="hljs-property">recentAgents</span>.<span class="hljs-title function_">includes</span>(selectedAgent)) {
      context.<span class="hljs-property">recentAgents</span>.<span class="hljs-title function_">unshift</span>(selectedAgent);
      <span class="hljs-keyword">if</span> (context.<span class="hljs-property">recentAgents</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">3</span>) {
        context.<span class="hljs-property">recentAgents</span>.<span class="hljs-title function_">pop</span>();
      }
    }

    <span class="hljs-comment">// æ›´æ–°ä¸»é¢˜</span>
    <span class="hljs-keyword">const</span> newTopics = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">extractTopics</span>(userMessage);
    context.<span class="hljs-property">topics</span> = [...<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([...newTopics, ...context.<span class="hljs-property">topics</span>])].<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>);

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">userContexts</span>.<span class="hljs-title function_">set</span>(userId, context);

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸ’¾ æ›´æ–°ç”¨æˆ·ä¸Šä¸‹æ–‡: Agent=<span class="hljs-subst">${selectedAgent}</span>, ä¸»é¢˜æ•°=<span class="hljs-subst">${context.topics.length}</span>`</span>);
  }

  <span class="hljs-comment">// æ£€æµ‹æ˜¯å¦ä¸ºæ–°é¢†åŸŸè¯·æ±‚</span>
  <span class="hljs-title function_">isNewDomainRequest</span>(<span class="hljs-params">message</span>) {
    <span class="hljs-keyword">const</span> newDomainIndicators = [
      <span class="hljs-comment">// æ˜ç¡®çš„è¯é¢˜è½¬æ¢</span>
      <span class="hljs-string">'æ¢ä¸ªè¯é¢˜'</span>, <span class="hljs-string">'è¯´è¯´åˆ«çš„'</span>, <span class="hljs-string">'å¦å¤–'</span>, <span class="hljs-string">'è¿˜æœ‰'</span>, <span class="hljs-string">'å…¶ä»–'</span>, <span class="hljs-string">'ä¸åŒçš„'</span>,
      <span class="hljs-string">'æ–°çš„é—®é¢˜'</span>, <span class="hljs-string">'åˆ«çš„äº‹æƒ…'</span>, <span class="hljs-string">'è½¬æ¢è¯é¢˜'</span>, <span class="hljs-string">'æ”¹ä¸ªæ–¹å‘'</span>,

      <span class="hljs-comment">// è¿½åŠ è¯¢é—®</span>
      <span class="hljs-string">'æˆ‘æƒ³é—®'</span>, <span class="hljs-string">'æˆ‘è¿˜æƒ³'</span>, <span class="hljs-string">'é¡ºä¾¿é—®'</span>, <span class="hljs-string">'å†é—®ä¸€ä¸ª'</span>, <span class="hljs-string">'è¿˜æƒ³äº†è§£'</span>,
      <span class="hljs-string">'å¦å¤–æƒ³é—®'</span>, <span class="hljs-string">'è¿˜æœ‰ä¸ªé—®é¢˜'</span>, <span class="hljs-string">'å†å’¨è¯¢ä¸€ä¸‹'</span>,

      <span class="hljs-comment">// é¢†åŸŸåˆ‡æ¢æŒ‡ç¤º</span>
      <span class="hljs-string">'å…³äº'</span>, <span class="hljs-string">'é’ˆå¯¹'</span>, <span class="hljs-string">'å¯¹äº'</span>, <span class="hljs-string">'å°±æ˜¯'</span>, <span class="hljs-string">'æ¯”å¦‚è¯´'</span>,
      <span class="hljs-string">'æˆ‘éœ€è¦'</span>, <span class="hljs-string">'å¸®æˆ‘'</span>, <span class="hljs-string">'èƒ½å¦'</span>, <span class="hljs-string">'å¯ä»¥'</span>
    ];

    <span class="hljs-keyword">const</span> messageLower = message.<span class="hljs-title function_">toLowerCase</span>();

    <span class="hljs-comment">// æ£€æŸ¥æ˜ç¡®çš„è½¬æ¢æŒ‡ç¤ºè¯</span>
    <span class="hljs-keyword">const</span> hasTransitionWord = newDomainIndicators.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">indicator</span> =&gt;</span> messageLower.<span class="hljs-title function_">includes</span>(indicator));

    <span class="hljs-comment">// æ£€æŸ¥ä¸“ä¸šé¢†åŸŸå…³é”®è¯ç»„åˆ</span>
    <span class="hljs-keyword">const</span> domainKeywords = {
      <span class="hljs-attr">pr</span>: [<span class="hljs-string">'å…¬å…³'</span>, <span class="hljs-string">'å±æœº'</span>, <span class="hljs-string">'å“ç‰Œ'</span>, <span class="hljs-string">'åª’ä½“'</span>, <span class="hljs-string">'ä¼ æ’­'</span>, <span class="hljs-string">'å£°èª‰'</span>],
      <span class="hljs-attr">marketing</span>: [<span class="hljs-string">'è¥é”€'</span>, <span class="hljs-string">'æ¨å¹¿'</span>, <span class="hljs-string">'è·å®¢'</span>, <span class="hljs-string">'è½¬åŒ–'</span>, <span class="hljs-string">'å¹¿å‘Š'</span>, <span class="hljs-string">'æ´»åŠ¨'</span>],
      <span class="hljs-attr">analysis</span>: [<span class="hljs-string">'åˆ†æ'</span>, <span class="hljs-string">'å¸‚åœº'</span>, <span class="hljs-string">'ç«å“'</span>, <span class="hljs-string">'è¡Œä¸š'</span>, <span class="hljs-string">'è¶‹åŠ¿'</span>, <span class="hljs-string">'æ•°æ®'</span>]
    };

    <span class="hljs-keyword">let</span> domainMatches = <span class="hljs-number">0</span>;
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(domainKeywords).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">keywords</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> matches = keywords.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">keyword</span> =&gt;</span> messageLower.<span class="hljs-title function_">includes</span>(keyword));
      <span class="hljs-keyword">if</span> (matches.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) domainMatches++;
    });

    <span class="hljs-comment">// å¦‚æœæœ‰è½¬æ¢è¯ + ä¸“ä¸šé¢†åŸŸè¯ï¼Œæˆ–è€…æœ‰å¤šä¸ªé¢†åŸŸè¯ï¼Œè®¤ä¸ºæ˜¯æ–°é¢†åŸŸè¯·æ±‚</span>
    <span class="hljs-keyword">return</span> hasTransitionWord || domainMatches &gt; <span class="hljs-number">1</span>;
  }

  <span class="hljs-comment">// è·å–Agentæ˜¾ç¤ºåç§°</span>
  <span class="hljs-title function_">getAgentTitle</span>(<span class="hljs-params">agentName</span>) {
    <span class="hljs-keyword">const</span> titles = {
      <span class="hljs-string">'market-analyst'</span>: <span class="hljs-string">'ğŸ“Š å¸‚åœºåˆ†æå¸ˆ'</span>,
      <span class="hljs-string">'pr-specialist'</span>: <span class="hljs-string">'ğŸ“¢ å…¬å…³ä¸“å‘˜'</span>,
      <span class="hljs-string">'marketing-specialist'</span>: <span class="hljs-string">'ğŸ“ˆ è¥é”€ä¸“å‘˜'</span>
    };
    <span class="hljs-keyword">return</span> titles[agentName] || <span class="hljs-string">'ğŸ“Š å¸‚åœºåˆ†æå¸ˆ'</span>;
  }

  <span class="hljs-comment">// è·å–Agentç‰¹è‰²é¢„å“åº”</span>
  <span class="hljs-title function_">getAgentPreResponse</span>(<span class="hljs-params">agentName</span>) {
    <span class="hljs-keyword">const</span> preResponses = {
      <span class="hljs-string">'market-analyst'</span>: <span class="hljs-string">'ğŸ” æ­£åœ¨æ·±åº¦åˆ†æå¸‚åœºæ•°æ®å’Œè¡Œä¸šè¶‹åŠ¿...'</span>,
      <span class="hljs-string">'pr-specialist'</span>: <span class="hljs-string">'ğŸ“ æ­£åœ¨åˆ¶å®šä¸“ä¸šçš„å…¬å…³ä¼ æ’­ç­–ç•¥...'</span>,
      <span class="hljs-string">'marketing-specialist'</span>: <span class="hljs-string">'ğŸ¯ æ­£åœ¨ä¼˜åŒ–è¥é”€ç­–ç•¥å’Œå¢é•¿æ–¹æ¡ˆ...'</span>
    };
    <span class="hljs-keyword">return</span> preResponses[agentName] || <span class="hljs-string">'ğŸ” æ­£åœ¨æ·±åº¦åˆ†æå¸‚åœºæ•°æ®å’Œè¡Œä¸šè¶‹åŠ¿...'</span>;
  }

  <span class="hljs-comment">// è·å–è·¯ç”±ç»Ÿè®¡ä¿¡æ¯</span>
  <span class="hljs-title function_">getRoutingStats</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> stats = {
      <span class="hljs-attr">totalUsers</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">userContexts</span>.<span class="hljs-property">size</span>,
      <span class="hljs-attr">agentUsage</span>: { <span class="hljs-string">'market-analyst'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'pr-specialist'</span>: <span class="hljs-number">0</span>, <span class="hljs-string">'marketing-specialist'</span>: <span class="hljs-number">0</span> },
      <span class="hljs-attr">totalRequests</span>: <span class="hljs-number">0</span>
    };

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">userContexts</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">context</span> =&gt;</span> {
      context.<span class="hljs-property">recentAgents</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">agent</span> =&gt;</span> {
        stats.<span class="hljs-property">agentUsage</span>[agent] = (stats.<span class="hljs-property">agentUsage</span>[agent] || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>;
        stats.<span class="hljs-property">totalRequests</span>++;
      });
    });

    <span class="hljs-keyword">return</span> stats;
  }

  <span class="hljs-comment">// æ¸…ç†è¿‡æœŸä¸Šä¸‹æ–‡</span>
  <span class="hljs-title function_">cleanupExpiredContexts</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">const</span> expireTime = <span class="hljs-number">24</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>; <span class="hljs-comment">// 24å°æ—¶</span>

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [userId, context] <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">userContexts</span>.<span class="hljs-title function_">entries</span>()) {
      <span class="hljs-keyword">if</span> (now - context.<span class="hljs-property">lastMessageTime</span> &gt; expireTime) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">userContexts</span>.<span class="hljs-title function_">delete</span>(userId);
      }
    }
  }
}

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title class_">IntelligentRouter</span>;
</code></pre>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// è¿›ç¨‹æ± ç®¡ç† q-pool-manager.js</span>
<span class="hljs-keyword">const</span> { spawn } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'child_process'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title class_">EventEmitter</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'events'</span>);

<span class="hljs-keyword">class</span> <span class="hljs-title class_">QProcessPool</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EventEmitter</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">maxProcesses = <span class="hljs-number">5</span></span>) {
    <span class="hljs-variable language_">super</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxProcesses</span> = maxProcesses;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeProcesses</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">processCount</span> = <span class="hljs-number">0</span>;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">message, agentName = <span class="hljs-string">''</span>, messageId = <span class="hljs-literal">null</span></span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> request = {
        message,
        agentName,
        resolve,
        reject,
        <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
        messageId
      };

      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">processCount</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxProcesses</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startProcess</span>(request);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">push</span>(request);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è¯·æ±‚æ’é˜Ÿï¼Œå½“å‰é˜Ÿåˆ—é•¿åº¦: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.queue.length}</span>`</span>);
      }
    });
  }

  <span class="hljs-title function_">startProcess</span>(<span class="hljs-params">request</span>) {
    <span class="hljs-keyword">const</span> processId = <span class="hljs-string">`q_<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>_<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random().toString(<span class="hljs-number">36</span>).substr(<span class="hljs-number">2</span>, <span class="hljs-number">9</span>)}</span>`</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">processCount</span>++;

    <span class="hljs-keyword">const</span> args = [<span class="hljs-string">'chat'</span>, <span class="hljs-string">'--trust-all-tools'</span>, <span class="hljs-string">'--no-interactive'</span>];
    <span class="hljs-keyword">if</span> (request.<span class="hljs-property">agentName</span>) {
      args.<span class="hljs-title function_">push</span>(<span class="hljs-string">'--agent'</span>, request.<span class="hljs-property">agentName</span>);
    }

    <span class="hljs-keyword">const</span> qProcess = <span class="hljs-title function_">spawn</span>(<span class="hljs-string">'/home/ubuntu/.local/bin/q'</span>, args, {
      <span class="hljs-attr">stdio</span>: [<span class="hljs-string">'pipe'</span>, <span class="hljs-string">'pipe'</span>, <span class="hljs-string">'pipe'</span>],
      <span class="hljs-attr">env</span>: { ...process.<span class="hljs-property">env</span>, <span class="hljs-attr">TERM</span>: <span class="hljs-string">'xterm'</span>, <span class="hljs-attr">PATH</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">PATH</span> + <span class="hljs-string">':/home/ubuntu/.local/bin'</span> }
    });

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeProcesses</span>.<span class="hljs-title function_">set</span>(processId, {
      <span class="hljs-attr">process</span>: qProcess,
      request,
      <span class="hljs-attr">startTime</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
    });

    <span class="hljs-keyword">let</span> output = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">let</span> hasResponded = <span class="hljs-literal">false</span>;

    <span class="hljs-comment">// 90ç§’è¶…æ—¶ (ç»™å¤æ‚åˆ†æå……è¶³æ—¶é—´)</span>
    <span class="hljs-keyword">const</span> timeout = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (!hasResponded) {
        hasResponded = <span class="hljs-literal">true</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanupProcess</span>(processId);
        request.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'å¤æ‚åˆ†æå¤„ç†æ—¶é—´è¾ƒé•¿ï¼Œè¯·å°è¯•ç®€åŒ–é—®é¢˜æˆ–ç¨åé‡è¯•'</span>));
      }
    }, <span class="hljs-number">90000</span>);

    qProcess.<span class="hljs-property">stdout</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'data'</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
      output += data.<span class="hljs-title function_">toString</span>();
    });

    qProcess.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">(<span class="hljs-params">code</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!hasResponded) {
        hasResponded = <span class="hljs-literal">true</span>;
        <span class="hljs-built_in">clearTimeout</span>(timeout);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanupProcess</span>(processId);

        <span class="hljs-keyword">if</span> (code === <span class="hljs-number">0</span>) {
          request.<span class="hljs-title function_">resolve</span>(output.<span class="hljs-title function_">trim</span>());
        } <span class="hljs-keyword">else</span> {
          request.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Q CLI é€€å‡ºç : <span class="hljs-subst">${code}</span>`</span>));
        }
      }
    });

    qProcess.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!hasResponded) {
        hasResponded = <span class="hljs-literal">true</span>;
        <span class="hljs-built_in">clearTimeout</span>(timeout);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanupProcess</span>(processId);
        request.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Q CLI é”™è¯¯: <span class="hljs-subst">${err.message}</span>`</span>));
      }
    });

    <span class="hljs-comment">// å‘é€æ¶ˆæ¯</span>
    qProcess.<span class="hljs-property">stdin</span>.<span class="hljs-title function_">write</span>(request.<span class="hljs-property">message</span> + <span class="hljs-string">'\n'</span>);
    qProcess.<span class="hljs-property">stdin</span>.<span class="hljs-title function_">end</span>();

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å¯åŠ¨è¿›ç¨‹ <span class="hljs-subst">${processId}</span>, å½“å‰æ´»è·ƒè¿›ç¨‹: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.processCount}</span>`</span>);
  }

  <span class="hljs-title function_">cleanupProcess</span>(<span class="hljs-params">processId</span>) {
    <span class="hljs-keyword">const</span> processInfo = <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeProcesses</span>.<span class="hljs-title function_">get</span>(processId);
    <span class="hljs-keyword">if</span> (processInfo) {
      <span class="hljs-keyword">try</span> {
        processInfo.<span class="hljs-property">process</span>.<span class="hljs-title function_">kill</span>();
      } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-comment">// è¿›ç¨‹å¯èƒ½å·²ç»ç»“æŸ</span>
      }
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeProcesses</span>.<span class="hljs-title function_">delete</span>(processId);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">processCount</span>--;

      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ¸…ç†è¿›ç¨‹ <span class="hljs-subst">${processId}</span>, å‰©ä½™æ´»è·ƒè¿›ç¨‹: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.processCount}</span>`</span>);

      <span class="hljs-comment">// å¤„ç†é˜Ÿåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªè¯·æ±‚</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">const</span> nextRequest = <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">shift</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startProcess</span>(nextRequest);
      }
    }
  }

  <span class="hljs-title function_">getStats</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">activeProcesses</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">processCount</span>,
      <span class="hljs-attr">queueLength</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span>,
      <span class="hljs-attr">maxProcesses</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxProcesses</span>
    };
  }
}

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title class_">QProcessPool</span>;
</code></pre>
<pre><code class="hljs language-JSON" lang="JSON"><span class="hljs-comment">// é™æµå™¨ rate-limiter.js</span>
class RateLimiter <span class="hljs-punctuation">{</span>
  constructor(maxRequests = <span class="hljs-number">10</span><span class="hljs-punctuation">,</span> windowMs = <span class="hljs-number">60000</span>) <span class="hljs-punctuation">{</span> <span class="hljs-comment">// æ¯åˆ†é’Ÿæœ€å¤š10ä¸ªè¯·æ±‚</span>
    this.maxRequests = maxRequests;
    this.windowMs = windowMs;
    this.users = new Map();
  <span class="hljs-punctuation">}</span>

  isAllowed(userId) <span class="hljs-punctuation">{</span>
    const now = Date.now();
    const userRecord = this.users.get(userId) || <span class="hljs-punctuation">{</span> requests<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> blocked<span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span> <span class="hljs-punctuation">}</span>;

    <span class="hljs-comment">// æ¸…ç†è¿‡æœŸè¯·æ±‚</span>
    userRecord.requests = userRecord.requests.filter(time =&gt; now - time &lt; this.windowMs);

    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦è¶…è¿‡é™åˆ¶</span>
    if (userRecord.requests.length &gt;= this.maxRequests) <span class="hljs-punctuation">{</span>
      userRecord.blocked = <span class="hljs-literal"><span class="hljs-keyword">true</span></span>;
      this.users.set(userId<span class="hljs-punctuation">,</span> userRecord);
      return <span class="hljs-literal"><span class="hljs-keyword">false</span></span>;
    <span class="hljs-punctuation">}</span>

    <span class="hljs-comment">// è®°å½•æ–°è¯·æ±‚</span>
    userRecord.requests.push(now);
    userRecord.blocked = <span class="hljs-literal"><span class="hljs-keyword">false</span></span>;
    this.users.set(userId<span class="hljs-punctuation">,</span> userRecord);

    return <span class="hljs-literal"><span class="hljs-keyword">true</span></span>;
  <span class="hljs-punctuation">}</span>

  getRemainingRequests(userId) <span class="hljs-punctuation">{</span>
    const userRecord = this.users.get(userId);
    if (!userRecord) return this.maxRequests;

    const now = Date.now();
    const validRequests = userRecord.requests.filter(time =&gt; now - time &lt; this.windowMs);
    return Math.max(<span class="hljs-number">0</span><span class="hljs-punctuation">,</span> this.maxRequests - validRequests.length);
  <span class="hljs-punctuation">}</span>

  cleanup() <span class="hljs-punctuation">{</span>
    const now = Date.now();
    for (const <span class="hljs-punctuation">[</span>userId<span class="hljs-punctuation">,</span> userRecord<span class="hljs-punctuation">]</span> of this.users.entries()) <span class="hljs-punctuation">{</span>
      userRecord.requests = userRecord.requests.filter(time =&gt; now - time &lt; this.windowMs);
      if (userRecord.requests.length === <span class="hljs-number">0</span>) <span class="hljs-punctuation">{</span>
        this.users.delete(userId);
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>

module.exports = RateLimiter;
</code></pre>
<pre><code class="hljs language-JSON" lang="JSON"><span class="hljs-comment">// Feishu Server Systemd</span>
<span class="hljs-punctuation">[</span>Unit<span class="hljs-punctuation">]</span>
Description=Feishu Server
After=network.target

<span class="hljs-punctuation">[</span>Service<span class="hljs-punctuation">]</span>
Type=simple
User=ubuntu
Group=ubuntu
WorkingDirectory=/home/ubuntu/feishu
ExecStart=/usr/bin/node server.js
Restart=always
RestartSec=<span class="hljs-number">10</span>
Environment=NODE_ENV=production
Environment=PATH=/usr/local/sbin<span class="hljs-punctuation">:</span>/usr/local/bin<span class="hljs-punctuation">:</span>/usr/sbin<span class="hljs-punctuation">:</span>/usr/bin<span class="hljs-punctuation">:</span>/sbin<span class="hljs-punctuation">:</span>/bin<span class="hljs-punctuation">:</span>/home/ubuntu/.local/bin

<span class="hljs-punctuation">[</span>Install<span class="hljs-punctuation">]</span>
WantedBy=multi-user.target
</code></pre>
<pre><code class="hljs language-JSON" lang="JSON"><span class="hljs-comment">// nginx.conf Nginxä»£ç†</span>
server <span class="hljs-punctuation">{</span>
    listen <span class="hljs-number">443</span> ssl;
    server_name amazonq.moveinsync.cn;

    ssl_certificate /home/ubuntu/feishu-webhook/cert.pem;
    ssl_certificate_key /home/ubuntu/feishu-webhook/key.pem;

    location / <span class="hljs-punctuation">{</span>
        proxy_pass https<span class="hljs-punctuation">:</span><span class="hljs-comment">//127.0.0.1:8443;</span>
        proxy_ssl_verify off;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-7">8. æ•ˆæœå±•ç¤º</h2>
<h3 data-id="heading-8">8.1Â ç›´æ¥ä½¿ç”¨Amazon Q</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fd2908q01vomqb2.cloudfront.net%2F472b07b9fcf2c2451e8781e944bf5f77cd8457c8%2F2025%2F10%2F28%2Fcli-5.png" target="_blank" title="https://d2908q01vomqb2.cloudfront.net/472b07b9fcf2c2451e8781e944bf5f77cd8457c8/2025/10/28/cli-5.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b3ad8db9fd14e11b1c6bcdd2ce66cee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766752780&amp;x-signature=WQ%2F7OFs3b1qaG9xixVm5AbOpFxs%3D" alt="" loading="lazy"/></a></p>
<h3 data-id="heading-9">8.2Â æ¥å…¥Anspire AI Search MCP Serverå</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fd2908q01vomqb2.cloudfront.net%2F472b07b9fcf2c2451e8781e944bf5f77cd8457c8%2F2025%2F10%2F28%2Fcli-6.png" target="_blank" title="https://d2908q01vomqb2.cloudfront.net/472b07b9fcf2c2451e8781e944bf5f77cd8457c8/2025/10/28/cli-6.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b6f7f787d33b4945b344e5a00c0f66ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766752780&amp;x-signature=T%2Fyr%2FcqXEPvrl7QT65FUqBdipis%3D" alt="" loading="lazy"/></a>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fd2908q01vomqb2.cloudfront.net%2F472b07b9fcf2c2451e8781e944bf5f77cd8457c8%2F2025%2F10%2F28%2Fcli-7.png" target="_blank" title="https://d2908q01vomqb2.cloudfront.net/472b07b9fcf2c2451e8781e944bf5f77cd8457c8/2025/10/28/cli-7.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/af8cf0d16ff748e2baf26ef5a5696510~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766752780&amp;x-signature=9VGJo1SAAGl1%2FvrzvaH5KL%2BfoO8%3D" alt="" loading="lazy"/></a>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fd2908q01vomqb2.cloudfront.net%2F472b07b9fcf2c2451e8781e944bf5f77cd8457c8%2F2025%2F10%2F28%2Fcli-8.png" target="_blank" title="https://d2908q01vomqb2.cloudfront.net/472b07b9fcf2c2451e8781e944bf5f77cd8457c8/2025/10/28/cli-8.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e12d6879ade4616b9d9a073a9720692~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766752780&amp;x-signature=itPFDRd7neioaYSy144x%2BqUgjhY%3D" alt="" loading="lazy"/></a></p>
<h2 data-id="heading-10">9. ä¼˜åŠ¿æ€»ç»“</h2>
<p>ç»“åˆå®é™…ä¸šåŠ¡åœºæ™¯ï¼Œé‡‡ç”¨Amazon Q Developer CLIå¤šAgentæ¶æ„çš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li>ä¸“ä¸šåˆ†å·¥<br/>
ç»†åˆ†è§’è‰²çš„Agentå®ç°ä¸“ä¸šåŒ–å¤„ç†ï¼Œä¿è¯åˆ†ææ·±åº¦ä¸å¤šç»´åº¦è¦†ç›–ï¼Œçµæ´»çš„æ™ºèƒ½è·¯ç”±ã€‚</li>
<li>é«˜å¹¶å‘è¯·æ±‚å¤„ç†èƒ½åŠ›<br/>
è¿›ç¨‹æ± æ¶æ„æ”¯æŒå¤šä¸ªAmazon Q CLIä»»åŠ¡å¹¶è¡Œï¼Œä¿è¯ä¸šåŠ¡å“åº”åŠæ—¶ï¼Œé€‚åˆä¼ä¸šçº§æœåŠ¡éœ€æ±‚ã€‚</li>
<li>æ™ºèƒ½æœç´¢èƒ½åŠ›åŠ æŒ<br/>
Anspire AI Searchä¸ºå¤šAgentæä¾›å¼ºå¤§è¯­ä¹‰æ£€ç´¢ï¼Œçªç ´ä¼ ç»Ÿå…³é”®è¯æœç´¢ç“¶é¢ˆï¼Œæå‡ä¿¡æ¯è·å–å’Œä¸šåŠ¡æ´å¯Ÿè´¨é‡ã€‚</li>
<li>ä¸ç°æœ‰ç”Ÿæ€ç³»ç»Ÿè‰¯å¥½é›†æˆ<br/>
æ·±åº¦èå…¥é£ä¹¦åä½œå¹³å°ï¼Œç®€åŒ–ç”¨æˆ·äº¤äº’è·¯å¾„ï¼Œä½¿å¸‚åœºåˆ†ææœåŠ¡æ›´åŠ å¯è§¦è¾¾å’Œæ˜“ç”¨ã€‚</li>
<li>å®‰å…¨ç¨³å®šï¼Œæ˜“äºæ‰©å±•<br/>
é¢„è®¾é™æµã€å»é‡åŠHTTPSå®‰å…¨é€šä¿¡ç­–ç•¥ï¼Œç»“åˆæ¨¡å—åŒ–Agentè®¾è®¡ï¼Œä¿è¯ç³»ç»Ÿé•¿æœŸç¨³å®šè¿è¡Œå¹¶æ”¯æŒå¿«é€Ÿè¿­ä»£å‡çº§ã€‚</li>
</ul>
<p>è¯¥æ–¹æ¡ˆå°†Amazon Q Developer CLIçš„å¤šAgentèƒ½åŠ›ã€ä¸“ä¸šåŒ–å¸‚åœºåˆ†æè§’è‰²å’Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fanchnet.com%2F" target="_blank" title="https://anchnet.com/" ref="nofollow noopener noreferrer">å®‰ç•…</a><a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.anspire.cn%2F" target="_blank" title="https://open.anspire.cn/" ref="nofollow noopener noreferrer">Anspire</a>Â AIè¯­ä¹‰æœç´¢æŠ€æœ¯è¿›è¡Œèåˆï¼Œé€‚ç”¨äºä¼ä¸šçº§å¤æ‚å¸‚åœºåˆ†æå’Œè¥é”€ç­–ç•¥åˆ¶å®šåœºæ™¯ï¼Œæå¤§æå‡æ™ºèƒ½åŒ–æ°´å¹³å’Œç”¨æˆ·ä½“éªŒã€‚</p>
<h2 data-id="heading-11">10. æŠ€æœ¯ææ–™å‚è€ƒï¼š</h2>
<ol>
<li>
<p>å®‰ç•…AI Agentå¼€å‘å¹³å°æŒ‡å—ï¼š</p>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.anspire.cn%2F" target="_blank" title="https://open.anspire.cn/" ref="nofollow noopener noreferrer">AIè”ç½‘æœç´¢ã€å¤šè½®æ”¹å†™ã€Anspire Browser Agentç­‰</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.anspire.cn%2Fdocument%2Fdocs%2FmcpServer%2F" target="_blank" title="https://open.anspire.cn/document/docs/mcpServer/" ref="nofollow noopener noreferrer">å¼€å‘å¹³å°å¸®åŠ©æ–‡æ¡£</a></li>
</ol>
</li>
<li>
<p>Amazon Q Developer CLI æŒ‡å—ï¼š</p>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.aws.amazon.com%2Fzh_cn%2Famazonq%2Flatest%2Fqdeveloper-ug%2Fcommand-line-installing.html" target="_blank" title="https://docs.aws.amazon.com/zh_cn/amazonq/latest/qdeveloper-ug/command-line-installing.html" ref="nofollow noopener noreferrer">Linuxå®‰è£…</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.aws.amazon.com%2Fzh_cn%2Famazonq%2Flatest%2Fqdeveloper-ug%2Fcommand-line-custom-agents-defining.html" target="_blank" title="https://docs.aws.amazon.com/zh_cn/amazonq/latest/qdeveloper-ug/command-line-custom-agents-defining.html" ref="nofollow noopener noreferrer">è‡ªå®šä¹‰Agents</a></li>
</ol>
</li>
</ol>
<p>*å‰è¿°ç‰¹å®šäºšé©¬é€Šäº‘ç§‘æŠ€ç”Ÿæˆå¼äººå·¥æ™ºèƒ½ç›¸å…³çš„æœåŠ¡ç›®å‰åœ¨äºšé©¬é€Šäº‘ç§‘æŠ€æµ·å¤–åŒºåŸŸå¯ç”¨ã€‚äºšé©¬é€Šäº‘ç§‘æŠ€ä¸­å›½åŒºåŸŸç›¸å…³äº‘æœåŠ¡ç”±è¥¿äº‘æ•°æ®å’Œå…‰ç¯æ–°ç½‘è¿è¥ï¼Œå…·ä½“ä¿¡æ¯ä»¥ä¸­å›½åŒºåŸŸå®˜ç½‘ä¸ºå‡†ã€‚</p>
<p><strong>æœ¬ç¯‡ä½œè€…</strong>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/015d70512875489bb302c40c38bba79f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqa6ams6YCK5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766752780&amp;x-signature=j%2ByjcZ1yAvm8EgK4ZPcTHiuTftA%3D" alt="image.png" loading="lazy"/></p>
<blockquote>
<p>æœ¬æœŸæœ€æ–°å®éªŒä¸ºã€ŠAgentic AI å¸®ä½ åšåº”ç”¨ â€”â€” ä»0åˆ°1æ‰“é€ è‡ªå·±çš„æ™ºèƒ½ç•ªèŒ„é’Ÿã€‹</p>
<p>âœ¨è‡ªç„¶è¯­è¨€ç©è½¬å‘½ä»¤è¡Œï¼Œ10åˆ†é’Ÿå¸®ä½ æ„å»ºåº”ç”¨ï¼Œ1å°æ—¶æå®šæ–°åŠŸèƒ½æ‹“å±•ã€æµ‹è¯•ä¼˜åŒ–ã€æ–‡æ¡£æ³¨é‡Šå’Œéƒ¨ç½²</p>
<p>ğŸ’ª å…è´¹ä½“éªŒä¼ä¸šçº§ AI å¼€å‘å·¥å…·ï¼Œè´¨é‡+å®‰å…¨å…¨æŒæ§</p>
<p>â©ï¸[<a href="https://link.juejin.cn?target=https%3A%2F%2Fevents.amazoncloud.cn%2Flabs%2Fcloudlab-amazon-q-cli-and-ide-build%3Fvisitfrom%3D3P_Juejintail_1216%26sc_medium%3Downed%26sc_campaign%3Dcloudlab%26sc_channel%3D3P_Juejintail_1216" target="_blank" title="https://events.amazoncloud.cn/labs/cloudlab-amazon-q-cli-and-ide-build?visitfrom=3P_Juejintail_1216&amp;sc_medium=owned&amp;sc_campaign=cloudlab&amp;sc_channel=3P_Juejintail_1216" ref="nofollow noopener noreferrer">ç‚¹å‡»è¿›å…¥å®éªŒ</a>] å³åˆ»å¼€å¯  AI å¼€å‘ä¹‹æ—…
æ„å»ºæ— é™, æ¢ç´¢å¯ç¨‹ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é˜¿é‡Œé‚®ä»¶ä¸‹è½½å™¨ä½¿ç”¨è¯´æ˜]]></title>    <link>https://juejin.cn/post/7585214391828824107</link>    <guid>https://juejin.cn/post/7585214391828824107</guid>    <pubDate>2025-12-19T11:09:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585214391828824107" data-draft-id="7585171571130138660" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é˜¿é‡Œé‚®ä»¶ä¸‹è½½å™¨ä½¿ç”¨è¯´æ˜"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-19T11:09:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ±ŸåŸå¼€æœ—çš„è±Œè±†"/> <meta itemprop="url" content="https://juejin.cn/user/3307789418773736"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é˜¿é‡Œé‚®ä»¶ä¸‹è½½å™¨ä½¿ç”¨è¯´æ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3307789418773736/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ±ŸåŸå¼€æœ—çš„è±Œè±†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T11:09:14.000Z" title="Fri Dec 19 2025 11:09:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é‚®ä»¶ä¸‹è½½å™¨ä½¿ç”¨è¯´æ˜</h2>
<h3 data-id="heading-1">ğŸ“‹ é¡¹ç›®ç®€ä»‹</h3>
<p>è¿™æ˜¯ä¸€ä¸ªåŸºäºNode.jsçš„é‚®ä»¶è‡ªåŠ¨ä¸‹è½½å’Œåˆ†ç±»å·¥å…·ï¼Œèƒ½å¤Ÿé€šè¿‡IMAPåè®®è¿æ¥åˆ°é‚®ç®±æœåŠ¡å™¨ï¼Œè‡ªåŠ¨ä¸‹è½½æ‰€æœ‰é‚®ä»¶å¹¶æŒ‰ç…§è”ç³»äººè¿›è¡Œåˆ†ç±»ä¿å­˜ã€‚</p>
<h3 data-id="heading-2">ğŸ—‚ï¸ ç›®å½•ç»“æ„</h3>
<p>ç¨‹åºè¿è¡Œåä¼šè‡ªåŠ¨åˆ›å»ºä»¥ä¸‹ç›®å½•ç»“æ„ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">E:\é‚®ç®±ä¸‹è½½\pds_server\åˆ†ç±»é‚®ä»¶åº“\</span>
<span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">æ”¶ä»¶ç®±\</span>                           <span class="hljs-comment"># æ‰€æœ‰æ”¶åˆ°çš„é‚®ä»¶</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">æ¥è‡ª_è”ç³»äººA\</span>                  <span class="hljs-comment"># æŸä¸ªè”ç³»äººå‘æ¥çš„é‚®ä»¶</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-number">2024-01</span><span class="hljs-string">-01_é‚®ä»¶ä¸»é¢˜.eml</span>   <span class="hljs-comment"># é‚®ä»¶åŸå§‹æ–‡ä»¶</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">é™„ä»¶\</span>                      <span class="hljs-comment"># è¯¥è”ç³»äººçš„æ‰€æœ‰é™„ä»¶</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">1640995200000_æ–‡ä»¶1.pdf</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">1640995200000_å›¾ç‰‡.jpg</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">_index.json</span>               <span class="hljs-comment"># è¯¥è”ç³»äººé‚®ä»¶ç´¢å¼•</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">æ¥è‡ª_è”ç³»äººB\</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">...</span>
<span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">å·²å‘é€\</span>                           <span class="hljs-comment"># æ‰€æœ‰å‘é€çš„é‚®ä»¶</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">å‘ç»™_è”ç³»äººA\</span>                  <span class="hljs-comment"># å‘é€ç»™æŸä¸ªè”ç³»äººçš„é‚®ä»¶</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-number">2024-01</span><span class="hljs-string">-01_å›å¤é‚®ä»¶.eml</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">é™„ä»¶\</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>   <span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">_index.json</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">...</span>
<span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">_ä¸‹è½½è®°å½•.json</span>                    <span class="hljs-comment"># å…¨å±€ä¸‹è½½è®°å½•æ–‡ä»¶</span>
</code></pre>
<h3 data-id="heading-3">ğŸ“ æ–‡ä»¶è¯´æ˜</h3>
<h4 data-id="heading-4">é‚®ä»¶æ–‡ä»¶ (.eml)</h4>
<ul>
<li><strong>æ ¼å¼</strong>ï¼šæ ‡å‡†RFC 822é‚®ä»¶æ ¼å¼</li>
<li><strong>å‘½åè§„åˆ™</strong>ï¼š<code>æ—¥æœŸ_ä¸»é¢˜.eml</code>
<ul>
<li>æ—¥æœŸæ ¼å¼ï¼š<code>YYYY-MM-DD</code></li>
<li>ä¸»é¢˜ï¼šè‡ªåŠ¨æ›¿æ¢ç‰¹æ®Šå­—ç¬¦ï¼Œæœ€å¤š50ä¸ªå­—ç¬¦</li>
</ul>
</li>
<li><strong>ç”¨é€”</strong>ï¼šå¯ç”¨Outlookã€Foxmailç­‰é‚®ä»¶å®¢æˆ·ç«¯æ‰“å¼€</li>
</ul>
<h4 data-id="heading-5">é™„ä»¶æ–‡ä»¶</h4>
<ul>
<li><strong>å­˜å‚¨ä½ç½®</strong>ï¼šå„è”ç³»äººç›®å½•ä¸‹çš„<code>é™„ä»¶</code>æ–‡ä»¶å¤¹</li>
<li><strong>å‘½åè§„åˆ™</strong>ï¼š<code>æ—¶é—´æˆ³_åŸæ–‡ä»¶å</code></li>
<li><strong>æ—¶é—´æˆ³</strong>ï¼šé˜²æ­¢é‡åæ–‡ä»¶å†²çª</li>
<li><strong>æ”¯æŒæ ¼å¼</strong>ï¼šæ‰€æœ‰ç±»å‹çš„é‚®ä»¶é™„ä»¶</li>
</ul>
<h4 data-id="heading-6">ç´¢å¼•æ–‡ä»¶ (_index.json)</h4>
<p>æ¯ä¸ªè”ç³»äººç›®å½•ä¸‹éƒ½ä¼šç”Ÿæˆä¸€ä¸ªç´¢å¼•æ–‡ä»¶ï¼ŒåŒ…å«ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"emails"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"seqno"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">123</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"subject"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"é‚®ä»¶ä¸»é¢˜"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2024-01-01T12:00:00.000Z"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"emlFile"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2024-01-01_é‚®ä»¶ä¸»é¢˜.eml"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"infoFile"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"é‚®ä»¶ä¿¡æ¯.json"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"hasAttachments"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-7">ä¸‹è½½è®°å½•æ–‡ä»¶ (_ä¸‹è½½è®°å½•.json)</h4>
<p>å…¨å±€ä¸‹è½½è®°å½•ï¼Œè®°å½•æ‰€æœ‰å·²ä¸‹è½½é‚®ä»¶çš„UIDï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"downloadedUids"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">12345</span><span class="hljs-punctuation">,</span> <span class="hljs-number">12346</span><span class="hljs-punctuation">,</span> <span class="hljs-number">12347</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"inboxTotal"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">364</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"sentTotal"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">50</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"inboxProcessed"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">100</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"sentProcessed"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">20</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"lastUpdate"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2024-01-01T12:00:00.000Z"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-8">ğŸš€ ä½¿ç”¨æ–¹æ³•</h3>
<h4 data-id="heading-9">1. ç¯å¢ƒå‡†å¤‡</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…Node.jsä¾èµ–</span>
npm install

<span class="hljs-comment"># ç¡®ä¿å®‰è£…äº†å¿…è¦çš„åŒ…</span>
npm install imap mailparser cli-progress
</code></pre>
<h4 data-id="heading-10">2. é…ç½®é‚®ç®±ä¿¡æ¯</h4>
<p>åœ¨ä»£ç ä¸­ä¿®æ”¹é‚®ç®±é…ç½®ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">EMAIL_USER</span> = <span class="hljs-string">'your-email@example.com'</span>;
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">EMAIL_PASSWORD</span> = <span class="hljs-string">'your-password'</span>;
</code></pre>
<h4 data-id="heading-11">3. è¿è¡Œç¨‹åº</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> E:\é‚®ç®±ä¸‹è½½\pds_server
node routes/email.js
</code></pre>
<h4 data-id="heading-12">4. æŸ¥çœ‹ä¸‹è½½è¿›åº¦</h4>
<p>ç¨‹åºä¼šå®æ—¶æ˜¾ç¤ºï¼š</p>
<ul>
<li>è¿æ¥çŠ¶æ€</li>
<li>å¤„ç†è¿›åº¦</li>
<li>ä¸‹è½½é€Ÿåº¦</li>
<li>é”™è¯¯ä¿¡æ¯</li>
</ul>
<h3 data-id="heading-13">âš™ï¸ åŠŸèƒ½ç‰¹æ€§</h3>
<h4 data-id="heading-14">âœ¨ ä¸»è¦åŠŸèƒ½</h4>
<ul>
<li><strong>è‡ªåŠ¨åˆ†ç±»</strong>ï¼šæŒ‰å‘ä»¶äºº/æ”¶ä»¶äººè‡ªåŠ¨åˆ†ç±»</li>
<li><strong>æ–­ç‚¹ç»­ä¼ </strong>ï¼šæ”¯æŒä¸­æ–­åç»§ç»­ä¸‹è½½</li>
<li><strong>é™„ä»¶å¤„ç†</strong>ï¼šè‡ªåŠ¨ä¿å­˜æ‰€æœ‰é™„ä»¶</li>
<li><strong>è¿›åº¦æ˜¾ç¤º</strong>ï¼šå®æ—¶æ˜¾ç¤ºä¸‹è½½è¿›åº¦å’Œé€Ÿåº¦</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šè‡ªåŠ¨è·³è¿‡é—®é¢˜é‚®ä»¶ï¼Œç»§ç»­å¤„ç†</li>
</ul>
<h4 data-id="heading-15">ğŸ”§ æŠ€æœ¯ç‰¹ç‚¹</h4>
<ul>
<li><strong>æ‰¹é‡å¤„ç†</strong>ï¼šæ”¯æŒæ‰¹æ¬¡ä¸‹è½½ï¼Œæé«˜æ•ˆç‡</li>
<li><strong>è¶…æ—¶ä¿æŠ¤</strong>ï¼š30ç§’è¶…æ—¶æœºåˆ¶ï¼Œé˜²æ­¢å¡æ­»</li>
<li><strong>å¹¶å‘æ§åˆ¶</strong>ï¼šåˆç†æ§åˆ¶å¹¶å‘æ•°é‡ï¼Œé¿å…æœåŠ¡å™¨å‹åŠ›</li>
<li><strong>å¢é‡æ›´æ–°</strong>ï¼šåªä¸‹è½½æ–°é‚®ä»¶ï¼Œè·³è¿‡å·²ä¸‹è½½é‚®ä»¶</li>
</ul>
<h3 data-id="heading-16">ğŸ“Š æ€§èƒ½å‚æ•°</h3>
<ul>
<li><strong>æ‰¹æ¬¡å¤§å°</strong>ï¼š5å°é‚®ä»¶/æ‰¹æ¬¡ï¼ˆå¯è°ƒæ•´ï¼‰</li>
<li><strong>è¶…æ—¶æ—¶é—´</strong>ï¼š30ç§’/é‚®ä»¶</li>
<li><strong>ä¼‘æ¯é—´éš”</strong>ï¼šæ¯20å°é‚®ä»¶ä¼‘æ¯1ç§’</li>
<li><strong>è®°å½•ä¿å­˜</strong>ï¼šæ¯10å°é‚®ä»¶ä¿å­˜ä¸€æ¬¡è®°å½•</li>
</ul>
<h3 data-id="heading-17">ğŸ›¡ï¸ å®‰å…¨è¯´æ˜</h3>
<h4 data-id="heading-18">é‚®ç®±å®‰å…¨</h4>
<ul>
<li>å»ºè®®ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç è€Œéä¸»å¯†ç </li>
<li>æ”¯æŒSSL/TLSåŠ å¯†è¿æ¥</li>
<li>ä¸ä¼šæ ‡è®°é‚®ä»¶ä¸ºå·²è¯»</li>
</ul>
<h4 data-id="heading-19">æ•°æ®å®‰å…¨</h4>
<ul>
<li>æ‰€æœ‰æ•°æ®ä¿å­˜åœ¨æœ¬åœ°</li>
<li>ä¸ä¼šä¸Šä¼ åˆ°ä»»ä½•äº‘æœåŠ¡</li>
<li>å»ºè®®å®šæœŸå¤‡ä»½é‚®ä»¶æ–‡ä»¶</li>
</ul>
<h3 data-id="heading-20">ğŸ”§ æ•…éšœæ’é™¤</h3>
<h4 data-id="heading-21">å¸¸è§é—®é¢˜</h4>
<ol>
<li>
<p><strong>è¿æ¥å¤±è´¥</strong></p>
<ul>
<li>æ£€æŸ¥é‚®ç®±å¯†ç æ˜¯å¦æ­£ç¡®</li>
<li>ç¡®è®¤IMAPæœåŠ¡æ˜¯å¦å¼€å¯</li>
<li>æ£€æŸ¥ç½‘ç»œè¿æ¥</li>
</ul>
</li>
<li>
<p><strong>ä¸‹è½½å¡ä½</strong></p>
<ul>
<li>ç¨‹åºä¼šè‡ªåŠ¨è¶…æ—¶è·³è¿‡</li>
<li>å¯ä»¥Ctrl+Cä¸­æ–­ï¼Œä¸‹æ¬¡è¿è¡Œä¼šç»§ç»­</li>
</ul>
</li>
<li>
<p><strong>æ–‡ä»¶ä¿å­˜å¤±è´¥</strong></p>
<ul>
<li>æ£€æŸ¥ç£ç›˜ç©ºé—´</li>
<li>ç¡®è®¤å†™å…¥æƒé™</li>
<li>æ£€æŸ¥æ–‡ä»¶åæ˜¯å¦åŒ…å«ç‰¹æ®Šå­—ç¬¦</li>
</ul>
</li>
</ol>
<h4 data-id="heading-22">æ—¥å¿—åˆ†æ</h4>
<p>ç¨‹åºä¼šè¾“å‡ºè¯¦ç»†æ—¥å¿—ï¼š</p>
<ul>
<li><code>âœ… æˆåŠŸä¸‹è½½</code>ï¼šé‚®ä»¶ä¸‹è½½æˆåŠŸ</li>
<li><code>â­ï¸ å·²è·³è¿‡</code>ï¼šé‚®ä»¶å·²å­˜åœ¨æˆ–è¶…æ—¶</li>
<li><code>âŒ å¤±è´¥</code>ï¼šå¤„ç†å‡ºé”™ï¼Œå¯æ‰‹åŠ¨æŸ¥çœ‹</li>
</ul>
<h3 data-id="heading-23">ğŸ“ˆ ç»Ÿè®¡ä¿¡æ¯</h3>
<p>ç¨‹åºè¿è¡Œå®Œæˆåä¼šæ˜¾ç¤ºï¼š</p>
<ul>
<li>æ€»é‚®ä»¶æ•°é‡</li>
<li>æˆåŠŸä¸‹è½½æ•°é‡</li>
<li>è·³è¿‡é‡å¤æ•°é‡</li>
<li>å¤„ç†å¤±è´¥æ•°é‡</li>
<li>æ€»è€—æ—¶å’Œå¹³å‡é€Ÿåº¦</li>
<li>è”ç³»äººé‚®ä»¶åˆ†å¸ƒç»Ÿè®¡</li>
</ul>
<h3 data-id="heading-24">ğŸ’¡ ä½¿ç”¨å»ºè®®</h3>
<ol>
<li><strong>é¦–æ¬¡è¿è¡Œ</strong>ï¼šå»ºè®®åœ¨ç½‘ç»œè‰¯å¥½æ—¶è¿è¡Œ</li>
<li><strong>å¤§é‡é‚®ä»¶</strong>ï¼šåˆ†æ—¶æ®µè¿è¡Œï¼Œé¿å…æœåŠ¡å™¨é™åˆ¶</li>
<li><strong>å®šæœŸå¤‡ä»½</strong>ï¼šå®šæœŸå¤‡ä»½<code>åˆ†ç±»é‚®ä»¶åº“</code>æ–‡ä»¶å¤¹</li>
<li><strong>æŸ¥çœ‹é‚®ä»¶</strong>ï¼šä½¿ç”¨é‚®ä»¶å®¢æˆ·ç«¯æ‰“å¼€.emlæ–‡ä»¶</li>
</ol>
<h3 data-id="heading-25">ğŸ“ æŠ€æœ¯æ”¯æŒ</h3>
<p>å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š</p>
<ol>
<li>Node.jsç‰ˆæœ¬ï¼ˆå»ºè®®14+ï¼‰</li>
<li>ç½‘ç»œè¿æ¥çŠ¶æ€</li>
<li>é‚®ç®±IMAPè®¾ç½®</li>
<li>ç£ç›˜ç©ºé—´å’Œæƒé™</li>
</ol>
<hr/>
<p><strong>ç‰ˆæœ¬</strong>ï¼š1.0
<strong>æ›´æ–°æ—¥æœŸ</strong>ï¼š2025-12-19
<strong>å¼€å‘è€…</strong>ï¼šæ±ŸåŸå¼€æœ—çš„è±Œè±†</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Apache Doris 4.0.2 ç‰ˆæœ¬æ­£å¼å‘å¸ƒ]]></title>    <link>https://juejin.cn/post/7585173051647672356</link>    <guid>https://juejin.cn/post/7585173051647672356</guid>    <pubDate>2025-12-19T11:39:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585173051647672356" data-draft-id="7585214391828889643" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Apache Doris 4.0.2 ç‰ˆæœ¬æ­£å¼å‘å¸ƒ"/> <meta itemprop="keywords" content="æ•°æ®åº“,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-19T11:39:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SelectDB"/> <meta itemprop="url" content="https://juejin.cn/user/3189021726222904"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Apache Doris 4.0.2 ç‰ˆæœ¬æ­£å¼å‘å¸ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3189021726222904/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SelectDB
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T11:39:03.000Z" title="Fri Dec 19 2025 11:39:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>äº²çˆ±çš„ç¤¾åŒºå°ä¼™ä¼´ä»¬ï¼Œ**Apache Doris 4.0.2 ç‰ˆæœ¬å·²æ­£å¼å‘å¸ƒã€‚**æ­¤ç‰ˆæœ¬æ–°å¢äº†åœ¨ AI &amp; Searchã€å‡½æ•°ã€ç‰©åŒ–è§†å›¾ã€Lakehouse ç­‰æ–¹é¢çš„åŠŸèƒ½ï¼Œå¹¶åŒæ­¥è¿›è¡Œäº†å¤šé¡¹ä¼˜åŒ–æ”¹è¿›åŠé—®é¢˜ä¿®å¤ï¼Œæ¬¢è¿ä¸‹è½½ä½“éªŒï¼</p>
<ul>
<li>GitHub ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fapache%2Fdoris%2Freleases" target="_blank" title="https://github.com/apache/doris/releases" ref="nofollow noopener noreferrer">github.com/apache/doriâ€¦</a></li>
<li>å®˜ç½‘ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdoris.apache.org%2Fdownload" target="_blank" title="https://doris.apache.org/download" ref="nofollow noopener noreferrer">doris.apache.org/download</a></li>
</ul>
<h2 data-id="heading-0">æ–°å¢åŠŸèƒ½</h2>
<h3 data-id="heading-1">AI &amp; Search</h3>
<ul>
<li>å€’æ’ç´¢å¼•æ”¯æŒè‡ªå®šä¹‰åˆ†æå™¨ï¼ŒåŒ…å«æ‹¼éŸ³åˆ†è¯å™¨å’Œæ‹¼éŸ³è¿‡æ»¤å™¨</li>
<li>å€’æ’ç´¢å¼•çš„æœç´¢å‡½æ•°æ–°å¢å¤šä½ç½®çŸ­è¯­æŸ¥è¯¢ï¼ˆPhraseQueryï¼‰æ”¯æŒ</li>
<li>æ–°å¢ ANN ç´¢å¼•ä»…æ‰«æèƒ½åŠ›</li>
</ul>
<h3 data-id="heading-2">å‡½æ•°</h3>
<ul>
<li>æ–°å¢ <code>sem</code> èšåˆå‡½æ•°</li>
<li>æ”¯æŒæºè‡ª Hive çš„ <code>factorial</code>ç®€å• SQL å‡½æ•°</li>
<li>éƒ¨åˆ†æ­£åˆ™è¡¨è¾¾å¼å‡½æ•°æ–°å¢é›¶å®½æ–­è¨€æ”¯æŒ</li>
<li>JSON ç±»å‹æ”¯æŒ GROUP BY å’Œ DISTINCT æ“ä½œ</li>
<li>æ–°å¢ add/sub_time æ—¶é—´å‡½æ•°</li>
<li>æ–°å¢ deduplicate_map å‡½æ•°</li>
</ul>
<h3 data-id="heading-3">ç‰©åŒ–è§†å›¾</h3>
<ul>
<li>éåˆ†åŒºåŸºè¡¨æ•°æ®å˜æ›´æ—¶ï¼Œç‰©åŒ–è§†å›¾ä»å¯å‚ä¸é€æ˜æŸ¥è¯¢é‡å†™</li>
<li>åˆ›å»º MTMV æ”¯æŒåŸºäºè§†å›¾åˆ›å»º</li>
<li>MTMV åˆ·æ–°æ”¯æŒå¤š PCT è¡¨</li>
<li>ç‰©åŒ–è§†å›¾åŒ…å«çª—å£å‡½æ•°æ—¶ï¼Œæ”¯æŒçª—å£å‡½æ•°é‡å†™</li>
</ul>
<h3 data-id="heading-4">Lakehouse</h3>
<ul>
<li>æ–°å¢ Doris Catalogï¼Œè¯¥åŠŸèƒ½å…è®¸ç”¨æˆ·é€šè¿‡ Catalog èƒ½åŠ›å…³è”å¤šä¸ªç‹¬ç«‹çš„ Doris é›†ç¾¤å¹¶è¿›è¡Œé«˜æ•ˆçš„è”é‚¦æ•°æ®æŸ¥è¯¢ã€‚è§£å†³ Doris é›†ç¾¤é—´æ•°æ®æ— æ³•å…³è”æŸ¥è¯¢çš„é—®é¢˜ã€‚æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdoris.apache.org%2Fdocs%2F4.x%2Flakehouse%2Fcatalogs%2Fdoris-catalog" target="_blank" title="https://doris.apache.org/docs/4.x/lakehouse/catalogs/doris-catalog" ref="nofollow noopener noreferrer">doris.apache.org/docs/4.x/laâ€¦</a></li>
<li>æ”¯æŒé€šè¿‡ rewrite_data_files æ–¹æ³•å¯¹ Iceberg è¡¨è¿›è¡Œ compaction æ“ä½œã€‚è¯¥æ“ä½œå…è®¸ç”¨æˆ·å¯¹ Iceberg å°æ–‡ä»¶è¿›è¡Œåˆå¹¶ï¼Œä»è€Œä¼˜åŒ–è¯»å–æ•ˆç‡ã€‚æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdoris.apache.org%2Fdocs%2F4.x%2Flakehouse%2Fcatalogs%2Ficeberg-catalog%23rewrite_data_files" target="_blank" title="https://doris.apache.org/docs/4.x/lakehouse/catalogs/iceberg-catalog#rewrite_data_files" ref="nofollow noopener noreferrer">doris.apache.org/docs/4.x/laâ€¦</a></li>
<li>æ”¯æŒé€šè¿‡ WARM UP è¯­å¥å¯¹ Hiveã€Icebergã€Paimon ç­‰å¤–éƒ¨è¡¨æ•°æ®è¿›è¡Œç¼“å­˜é¢„çƒ­ã€‚æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdoris.apache.org%2Fdocs%2F4.x%2Flakehouse%2Fdata-cache%23cache-warmup" target="_blank" title="https://doris.apache.org/docs/4.x/lakehouse/data-cache#cache-warmup" ref="nofollow noopener noreferrer">doris.apache.org/docs/4.x/laâ€¦</a></li>
<li>æ”¯æŒé€šè¿‡ ALTER è¯­å¥å¯¹ Iceberg è¡¨è¿›è¡Œ Partition Evolution æ“ä½œã€‚æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdoris.apache.org%2Fdocs%2F4.x%2Flakehouse%2Fcatalogs%2Ficeberg-catalog%23partition-evolution" target="_blank" title="https://doris.apache.org/docs/4.x/lakehouse/catalogs/iceberg-catalog#partition-evolution" ref="nofollow noopener noreferrer">doris.apache.org/docs/4.x/laâ€¦</a></li>
<li>æ”¯æŒ HTTP Table Valued Functionï¼Œæ”¯æŒé€šè¿‡ Table Valued Function ç›´æ¥è¯»å– HTTP èµ„æºæ–‡ä»¶ã€‚æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdoris.apache.org%2Fdocs%2F4.x%2Fsql-manual%2Fsql-functions%2Ftable-valued-functions%2Fhttp" target="_blank" title="https://doris.apache.org/docs/4.x/sql-manual/sql-functions/table-valued-functions/http" ref="nofollow noopener noreferrer">doris.apache.org/docs/4.x/sqâ€¦</a></li>
<li>æ”¯æŒç›´æ¥è®¿é—® Huggingface ä¸Šçš„æ•°æ®é›†ã€‚æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdoris.apache.org%2Fdocs%2F4.x%2Flakehouse%2Fhuggingface" target="_blank" title="https://doris.apache.org/docs/4.x/lakehouse/huggingface" ref="nofollow noopener noreferrer">doris.apache.org/docs/4.x/laâ€¦</a></li>
<li>æ”¯æŒé€šè¿‡ Iceberg REST Catalog åè®®è®¿é—® Microsoft OneLakeã€‚æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdoris.apache.org%2Fdocs%2F4.x%2Flakehouse%2Fbest-practices%2Fdoris-onelake" target="_blank" title="https://doris.apache.org/docs/4.x/lakehouse/best-practices/doris-onelake" ref="nofollow noopener noreferrer">doris.apache.org/docs/4.x/laâ€¦</a></li>
<li>æ”¯æŒç›´æ¥æ˜ å°„ Hiveã€Icebergã€Paimonã€JDBC å¤–è¡¨ä¸­çš„ binary ç±»å‹åˆ° Doris çš„ varbinary ç±»å‹ã€‚è¯·å‚é˜…å„ Catalog æ–‡æ¡£çš„ã€åˆ—æ˜ å°„ã€‘å°èŠ‚ã€‚</li>
</ul>
<h2 data-id="heading-5">ä¼˜åŒ–æ”¹è¿›</h2>
<ul>
<li>ä¼˜åŒ– <code>FROM_UNIXTIME</code> å‡½æ•°æ€§èƒ½</li>
<li>ç§»é™¤ PartitionKey æ¯”è¾ƒä¸­çš„ <code>castTo</code>è½¬æ¢æ“ä½œï¼Œæå‡åˆ†åŒºå¤„ç†æ•ˆç‡</li>
<li>é™ä½ Catalog ä¸­ Column ç±»çš„å†…å­˜å ç”¨</li>
<li>Ann ç´¢å¼•è®­ç»ƒå‰ç´¯ç§¯å¤šä¸ªå°æ‰¹æ¬¡æ•°æ®ï¼Œæå‡è®­ç»ƒæ•ˆç‡</li>
<li>å‡çº§ Hadoop ä¾èµ–åˆ° 3.4.2 ç‰ˆæœ¬</li>
<li>ä¼˜åŒ– FE å’Œ BE çš„ä¼˜é›…é€€å‡ºæœºåˆ¶ï¼Œé™ä½èŠ‚ç‚¹é€€å‡ºå¯¹æŸ¥è¯¢çš„å½±å“</li>
<li>ä¼˜åŒ–å¯¹åŒ…å«å¤§é‡åˆ†åŒºçš„ hive è¡¨çš„å†™å…¥çš„æ•ˆç‡</li>
<li>ä¼˜åŒ– Paimon è¡¨ Split å ç”¨å†…å­˜è¿‡å¤§çš„é—®é¢˜</li>
<li>ä¼˜åŒ–å¯¹ Parquet RLE_DICTIONARY ç¼–ç çš„è¯»å–æ•ˆç‡</li>
<li>ä¼˜åŒ– FE å’Œ BE çš„ä¼˜é›…é€€å‡ºæœºåˆ¶ï¼Œé™ä½èŠ‚ç‚¹é€€å‡ºå¯¹æŸ¥è¯¢çš„å½±å“</li>
</ul>
<h2 data-id="heading-6">é—®é¢˜ä¿®å¤</h2>
<h3 data-id="heading-7">æŸ¥è¯¢</h3>
<ul>
<li>ä¿®å¤è¾“å…¥ä¸º null æ—¶ <code>utc_time</code> å‡½æ•°è¿”å›ç»“æœé”™è¯¯çš„é—®é¢˜</li>
<li>ä¿®å¤ UNION ALL ç»“åˆ TVF æ—¶æŠ›å‡ºå¼‚å¸¸çš„é—®é¢˜</li>
<li>ä¿®å¤å”¯ä¸€é”®è¡¨åˆ›å»ºç‰©åŒ–è§†å›¾æ—¶ï¼ŒWHERE å­å¥åŒ…å«éé”®åˆ—çš„é—®é¢˜</li>
<li>ä¿®å¤ window å‡½æ•°ï¼šLAG/LEAD åç§»å‚æ•°æ”¯æŒå¸¸é‡è¡¨è¾¾å¼è®¡ç®—</li>
<li>ä¿®å¤èšåˆå‡½æ•°ï¼šå¯ç©ºåˆ—æŠ•å½±å‰ä¸‹æ¨èšåˆæ“ä½œå¼‚å¸¸ï¼›éç©ºåˆ— count ä¸‹æ¨èšåˆé—®é¢˜</li>
<li>ä¿®å¤æ—¶é—´å‡½æ•°ï¼šsecond/microsecond å‡½æ•°æœªå¤„ç†æ—¶é—´å­—é¢é‡ï¼›time_to_sec å¤„ç† null å€¼æ—¶å› åƒåœ¾å€¼æŠ¥é”™</li>
<li>ä¿®å¤ AI å‡½æ•°ï¼š_exec_plan_fragment_impl è°ƒç”¨ AI å‡½æ•°æ—¶å‡ºç°æœªçŸ¥é”™è¯¯</li>
<li>ä¿®å¤åœ°ç†ä¿¡æ¯ï¼šgeo æ¨¡å—å†…å­˜æ³„æ¼</li>
<li>ä¿®å¤ information_schemaï¼šåç§»æ—¶åŒºæ ¼å¼ä¸å…¼å®¹</li>
</ul>
<h3 data-id="heading-8">ç‰©åŒ–è§†å›¾ä¸æ¨¡å¼å˜æ›´</h3>
<ul>
<li>ä¿®å¤ç‰©åŒ–è§†å›¾åŒ…å«åˆ†ç»„é›†åˆå’Œæ‰«æè¿‡æ»¤å™¨æ—¶é‡å†™å¤±è´¥çš„é—®é¢˜</li>
<li>ä¿®å¤å¤§æµé‡æ¨¡å¼å˜æ›´æ—¶è¯»å–å•è¡Œé›†éé‡å æ®µå¯¼è‡´çš„ coredump é—®é¢˜</li>
</ul>
<h3 data-id="heading-9">å­˜ç®—åˆ†ç¦»</h3>
<ul>
<li>ä¿®å¤ TopN æŸ¥è¯¢ä¸­å¹¿æ’­è¿œç¨‹è¯»å–çš„é—®é¢˜</li>
<li>ä¿®å¤äº‘ç¯å¢ƒä¸‹åˆ é™¤ tablet ä»»åŠ¡å †ç§¯çš„é—®é¢˜</li>
<li>ä¿®å¤äº‘ç¯å¢ƒé¦–æ¬¡å¯åŠ¨æ—¶æœåŠ¡ä¸Šçº¿è€—æ—¶è¿‡é•¿çš„é—®é¢˜</li>
</ul>
<h3 data-id="heading-10">Lakehouse</h3>
<ul>
<li>ä¿®å¤æŸäº›æƒ…å†µä¸‹ï¼ŒHive åˆ†åŒºå˜æ›´å¯¼è‡´å…ƒæ•°æ®ç¼“å­˜ä¸ä¸€è‡´çš„é—®é¢˜</li>
<li>ä¿®å¤å†™å…¥ TIMESTAMP ç±»å‹åˆ†åŒºçš„ Iceberg è¡¨é”™è¯¯çš„é—®é¢˜</li>
<li>ä¿®å¤ Paimon è¡¨ Incremental Read è¡Œä¸ºå’Œ Spark ä¸ä¸€è‡´çš„é—®é¢˜</li>
<li>ä¿®å¤æŸäº›æƒ…å†µä¸‹ï¼Œå¤–è¡¨å…ƒæ•°æ®ç¼“å­˜å¯èƒ½å¯¼è‡´çš„æ­»é”é—®é¢˜</li>
<li>ä¿®å¤ BE ç«¯ s3 client çº¿ç¨‹æ•°ä¸åˆç†å¯¼è‡´çš„ IO ååä½çš„é—®é¢˜</li>
<li>ä¿®å¤æŸäº›æƒ…å†µï¼Œå†™å…¥å­˜å‚¨åœ¨é S3 å¯¹è±¡å­˜å‚¨ä¸Šçš„å¤–è¡¨æ—¶å¤±è´¥çš„é—®é¢˜</li>
<li>ä¿®å¤æŸäº›æƒ…å†µä¸‹ï¼Œä½¿ç”¨ query() è¿›è¡Œ JDBC Catalog SQL é€ä¼ å¤±è´¥çš„é—®é¢˜</li>
<li>ä¿®å¤ JNI Reader æ—¶é—´ç»Ÿè®¡å¯¼è‡´è¯»å–æ€§èƒ½ä¸‹é™çš„é—®é¢˜</li>
<li>ä¿®å¤ BE ä¾§ jni.log æ— æ³•æ‰“å°çš„é—®é¢˜</li>
</ul>
<h3 data-id="heading-11">å…¶ä»–</h3>
<ul>
<li>ä¿®å¤åœ¨é Master é˜¶æ®µ UNSET GLOBAL å˜é‡æ—¶é”™è¯¯çš„é—®é¢˜</li>
<li>ä¿®å¤æŸäº›æƒ…å†µä¸‹ï¼Œå¼‚å¸¸çš„ export ä»»åŠ¡æ— æ³•å–æ¶ˆçš„é—®é¢˜</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Nettyï¼ˆ19ï¼‰Nettyçš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µæœ‰å“ªäº›ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7585391510058631220</link>    <guid>https://juejin.cn/post/7585391510058631220</guid>    <pubDate>2025-12-19T11:59:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585391510058631220" data-draft-id="7585377128490238004" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Nettyï¼ˆ19ï¼‰Nettyçš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µæœ‰å“ªäº›ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-19T11:59:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Nettyï¼ˆ19ï¼‰Nettyçš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µæœ‰å“ªäº›ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T11:59:12.000Z" title="Fri Dec 19 2025 11:59:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Nettyæä¾›äº†å¤šç§æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µï¼Œä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„ä¼˜åŒ–æŠ€æœ¯ï¼Œç»“åˆä»£ç ç¤ºä¾‹è¿›è¡Œè¯¦ç»†è§£é‡Šï¼š</p>
<ol>
<li>ä½¿ç”¨æ± åŒ–çš„ByteBufï¼š
Nettyä¸­çš„ByteBufæä¾›äº†æ± åŒ–çš„åŠŸèƒ½ï¼Œé€šè¿‡é‡ç”¨ByteBufå®ä¾‹ï¼Œå‡å°‘å†…å­˜åˆ†é…å’Œé‡Šæ”¾çš„å¼€é”€ã€‚å¯ä»¥ä½¿ç”¨PooledByteBufAllocatoræ¥åˆ›å»ºæ± åŒ–çš„ByteBufå®ä¾‹ã€‚</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ByteBufAllocator</span> <span class="hljs-variable">allocator</span> <span class="hljs-operator">=</span> PooledByteBufAllocator.DEFAULT;
</code></pre>
<ol start="2">
<li>
<p>é›¶æ‹·è´ï¼ˆZero-Copyï¼‰ï¼š
Nettyæ”¯æŒç›´æ¥å†…å­˜ï¼ˆDirect ByteBufï¼‰å’Œé›¶æ‹·è´çš„æ“ä½œï¼Œé¿å…äº†æ•°æ®åœ¨å†…å­˜ä¹‹é—´çš„å¤åˆ¶ã€‚è¿™å¯¹äºå¤„ç†å¤§é‡æ•°æ®çš„åœºæ™¯ç‰¹åˆ«æœ‰ç”¨ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨EventLoopå’Œå¤šçº¿ç¨‹ï¼š
Nettyçš„æ ¸å¿ƒç»„ä»¶æ˜¯EventLoopï¼Œå®ƒè´Ÿè´£å¤„ç†äº‹ä»¶å’Œæ‰§è¡Œä»»åŠ¡ã€‚é€šè¿‡ä½¿ç”¨å¤šä¸ªEventLoopå’Œå¤šçº¿ç¨‹ï¼Œå¯ä»¥æé«˜å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚å¯ä»¥é€šè¿‡EventLoopGroupæ¥åˆ›å»ºå’Œç®¡ç†å¤šä¸ªEventLoopã€‚</p>
</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">group</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();
</code></pre>
<ol start="4">
<li>ä½¿ç”¨ChannelOptionè¿›è¡Œé…ç½®ï¼š
é€šè¿‡è®¾ç½®ChannelOptionï¼Œå¯ä»¥å¯¹ç½‘ç»œè¿æ¥è¿›è¡Œç»†ç²’åº¦çš„é…ç½®ï¼Œä¾‹å¦‚TCPå‚æ•°ã€æ¥æ”¶å’Œå‘é€ç¼“å†²åŒºå¤§å°ç­‰ã€‚è¿™å¯ä»¥æ ¹æ®å…·ä½“çš„éœ€æ±‚æ¥ä¼˜åŒ–ç½‘ç»œæ€§èƒ½ã€‚</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">bootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>();
bootstrap.option(ChannelOption.SO_BACKLOG, <span class="hljs-number">1024</span>);
</code></pre>
<ol start="5">
<li>ä½¿ç”¨é«˜æ€§èƒ½çš„ç¼–è§£ç å™¨ï¼š
Nettyæä¾›äº†ä¸€äº›é«˜æ€§èƒ½çš„ç¼–è§£ç å™¨ï¼Œä¾‹å¦‚Protobufã€MessagePackç­‰ï¼Œå¯ä»¥æé«˜æ•°æ®çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ€§èƒ½ã€‚</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ChannelPipeline</span> <span class="hljs-variable">pipeline</span> <span class="hljs-operator">=</span> ch.pipeline();
pipeline.addLast(<span class="hljs-string">"decoder"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProtobufDecoder</span>(MyMessage.getDefaultInstance()));
pipeline.addLast(<span class="hljs-string">"encoder"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProtobufEncoder</span>());
</code></pre>
<ol start="6">
<li>åˆç†ä½¿ç”¨å†…å­˜ç®¡ç†ï¼š
Nettyçš„ByteBufæä¾›äº†ä¸¤ç§ç±»å‹çš„ç¼“å†²åŒºï¼šHeap ByteBufå’ŒDirect ByteBufã€‚åˆç†é€‰æ‹©å’Œç®¡ç†ç¼“å†²åŒºç±»å‹ï¼Œå¯ä»¥æé«˜å†…å­˜åˆ©ç”¨ç‡å’Œæ€§èƒ½ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Nettyï¼ˆ20ï¼‰å¦‚ä½•å®ç°åŸºäºNettyçš„WebSocketæœåŠ¡å™¨ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7585206349749600308</link>    <guid>https://juejin.cn/post/7585206349749600308</guid>    <pubDate>2025-12-19T12:00:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585206349749600308" data-draft-id="7585385309891149824" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Nettyï¼ˆ20ï¼‰å¦‚ä½•å®ç°åŸºäºNettyçš„WebSocketæœåŠ¡å™¨ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-19T12:00:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Nettyï¼ˆ20ï¼‰å¦‚ä½•å®ç°åŸºäºNettyçš„WebSocketæœåŠ¡å™¨ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T12:00:13.000Z" title="Fri Dec 19 2025 12:00:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¦å®ç°åŸºäºNettyçš„WebSocketæœåŠ¡å™¨ï¼Œæ‚¨å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼Œå¹¶ç»“åˆä»£ç ç¤ºä¾‹è¿›è¡Œè¯¦ç»†è§£é‡Šï¼š</p>
<ol>
<li>åˆ›å»ºæœåŠ¡å™¨å¼•å¯¼ç¨‹åºï¼ˆServerBootstrapï¼‰ï¼š
é¦–å…ˆï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªServerBootstrapå®ä¾‹ï¼Œå¹¶é…ç½®ç›¸å…³çš„å‚æ•°ã€‚åœ¨é…ç½®è¿‡ç¨‹ä¸­ï¼Œæ‚¨éœ€è¦æŒ‡å®šä½¿ç”¨NIOæˆ–è€…Epollç­‰ä¼ è¾“æ–¹å¼ï¼Œä»¥åŠé€‚å½“çš„EventLoopGroupã€‚</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">bossGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();
<span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workerGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>();
<span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">serverBootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>();
serverBootstrap.group(bossGroup, workerGroup)
               .channel(NioServerSocketChannel.class)
               .childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocketServerInitializer</span>());
</code></pre>
<ol start="2">
<li>å®ç°WebSocketServerInitializerï¼š
WebSocketServerInitializeræ˜¯ä¸€ä¸ªChannelInitializerçš„å­ç±»ï¼Œç”¨äºåˆå§‹åŒ–ChannelPipelineã€‚åœ¨è¿™é‡Œï¼Œæ‚¨éœ€è¦æ·»åŠ é€‚å½“çš„ChannelHandleræ¥å¤„ç†WebSocketçš„æ¡æ‰‹å’Œæ¶ˆæ¯ã€‚</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketServerInitializer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt; {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel ch)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">ChannelPipeline</span> <span class="hljs-variable">pipeline</span> <span class="hljs-operator">=</span> ch.pipeline();
        pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpServerCodec</span>());
        pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpObjectAggregator</span>(<span class="hljs-number">65536</span>));
        pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocketServerProtocolHandler</span>(<span class="hljs-string">"/websocket"</span>));
        pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocketServerHandler</span>());
    }
}
</code></pre>
<ol start="3">
<li>å®ç°WebSocketServerHandlerï¼š
WebSocketServerHandleræ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ChannelInboundHandlerAdapterçš„å­ç±»ï¼Œç”¨äºå¤„ç†WebSocketçš„æ¶ˆæ¯ã€‚</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketServerHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChannelInboundHandlerAdapter</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-keyword">if</span> (msg <span class="hljs-keyword">instanceof</span> WebSocketFrame) {
            <span class="hljs-comment">// å¤„ç†WebSocketæ¶ˆæ¯</span>
            <span class="hljs-type">WebSocketFrame</span> <span class="hljs-variable">frame</span> <span class="hljs-operator">=</span> (WebSocketFrame) msg;
            <span class="hljs-comment">// ...</span>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// å¤„ç†å…¶ä»–ç±»å‹çš„æ¶ˆæ¯</span>
            <span class="hljs-comment">// ...</span>
        }
    }
}
</code></pre>
<ol start="4">
<li>å¯åŠ¨æœåŠ¡å™¨ï¼š
æœ€åï¼Œæ‚¨éœ€è¦ç»‘å®šæœåŠ¡å™¨çš„ç«¯å£å¹¶å¯åŠ¨å®ƒã€‚</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">try</span> {
    <span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">future</span> <span class="hljs-operator">=</span> serverBootstrap.bind(<span class="hljs-number">8080</span>).sync();
    future.channel().closeFuture().sync();
} <span class="hljs-keyword">finally</span> {
    bossGroup.shutdownGracefully();
    workerGroup.shutdownGracefully();
}
</code></pre>
<p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œæ‚¨å¯ä»¥å®ç°ä¸€ä¸ªåŸºäºNettyçš„WebSocketæœåŠ¡å™¨ã€‚åœ¨WebSocketServerHandlerä¸­ï¼Œæ‚¨å¯ä»¥æ ¹æ®å…·ä½“çš„éœ€æ±‚æ¥å¤„ç†WebSocketçš„æ¶ˆæ¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è„šæ‰‹æ¶æ­¥éª¤æµç¨‹]]></title>    <link>https://juejin.cn/post/7585206549306179647</link>    <guid>https://juejin.cn/post/7585206549306179647</guid>    <pubDate>2025-12-19T10:05:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585206549306179647" data-draft-id="7585171571130007588" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è„šæ‰‹æ¶æ­¥éª¤æµç¨‹"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-19T10:05:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="woä¸æ˜¯é»„è“‰"/> <meta itemprop="url" content="https://juejin.cn/user/4161004982517358"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è„šæ‰‹æ¶æ­¥éª¤æµç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4161004982517358/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    woä¸æ˜¯é»„è“‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T10:05:14.000Z" title="Fri Dec 19 2025 10:05:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ­å»ºè„šæ‰‹æ¶æ­¥éª¤æµç¨‹ï¼š</p>
<ul>
<li>åœ¨è‡ªå·±çš„ç›®å½•æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå‘½åä¸º<code>test-hp-cli</code></li>
<li>è¿›å…¥æ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œå‘½ä»¤<code>npm init -y</code></li>
<li>æ ¹ç›®å½•æ–°å»ºbinæ–‡ä»¶å¤¹ï¼Œåœ¨ç›®å½•ä¸‹æ–°å»ºindex.jsæ–‡ä»¶</li>
<li>åœ¨index.jsæ–‡ä»¶ä¸­æ–‡ä»¶æœ€ä¸Šæ–¹å†™å…¥ä»¥ä¸‹ä»£ç </li>
</ul>

<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-meta">#!/usr/bin/env node</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'hello world'</span>);
</code></pre>
<ul>
<li>åœ¨package.jsonæ–‡ä»¶ä¸­ï¼Œä¿®æ”¹binå­—æ®µä¸º<code>"bin": "bin/index.js"</code></li>
<li>æ‰§è¡Œå‘½ä»¤<code>npm link</code>ï¼Œåœ¨å…¨å±€ç¯å¢ƒä¸‹åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥åˆ°å½“å‰ç›®å½•çš„node_modulesæ–‡ä»¶å¤¹ä¸‹ã€‚è¿™æ ·å°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡å‘½ä»¤è¡Œä½¿ç”¨è¯¥è„šæ‰‹æ¶äº†ã€‚ä¾‹å¦‚ï¼štest-hp-cli hello world</li>
<li>å¦‚æœè¦å‘å¸ƒåˆ°npmä¸Šï¼Œéœ€è¦å…ˆæ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œç„¶åç™»å½•npmï¼Œå†æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ä¸Šä¼ åŒ…ï¼š<code>npm publish --access public</code></li>
</ul>
<p>å‘å¸ƒnpmåŒ…çš„æ–¹æ³•ï¼š</p>
<ul>
<li>ç™»å½•npmè´¦å·ï¼š<code>npm login</code>, è¾“å…¥ç”¨æˆ·åã€å¯†ç å’Œé‚®ç®±</li>
<li>å‘å¸ƒåŒ…å¤±è´¥ï¼Œå¯èƒ½æ˜¯å› ä¸ºåŒ…åå·²ç»è¢«å ç”¨æˆ–è€…ä¸ç¬¦åˆnpmçš„å‘½åè§„èŒƒã€‚å¯ä»¥å°è¯•ä¿®æ”¹åŒ…åä¸ºå…¶ä»–åç§°ï¼Œä¾‹å¦‚å°†<code>test-hp-cli</code>æ”¹ä¸º<code>@test/hp-cli</code></li>
</ul>
<hr/>
<ul>
<li>
<p>npmå…¨å±€å®‰è£…è„šæ‰‹æ¶ï¼š<code>npm install -g test-hp-cli</code></p>
</li>
<li>
<p>æ‰§è¡Œè„šæ‰‹æ¶å‘½ä»¤ï¼š<code>test-hp-cli</code>ï¼Œæ‰§è¡Œå¤±è´¥æç¤ºæ²¡æœ‰è¿™ä¸ªå‘½ä»¤ï¼Œæ£€æŸ¥package.jsonä¸­çš„binå­—æ®µæ˜¯å¦æ­£ç¡®ï¼Œkeyå€¼éœ€è¦å’ŒåŒ…åä¸€è‡´ã€‚ä¾‹å¦‚<code>"test-hp-test": "bin/index.js"</code></p>
</li>
<li>
<p>ä¿®æ”¹åŒ…ååé‡æ–°å‘å¸ƒï¼Œéœ€è¦æ›´æ–°ç‰ˆæœ¬å·ï¼Œå¦åˆ™ä¹Ÿä¼šå‘å¸ƒå¤±è´¥ã€‚ä¾‹å¦‚<code>npm version patch</code>ï¼Œç„¶åé‡æ–°å‘å¸ƒï¼š<code>npm publish</code>
ä»£è¡¨æ‰§è¡ŒæˆåŠŸçš„æç¤ºä¿¡æ¯ï¼š</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ef5d82587794a47bb68e41ddf673874~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2_kuI3mmK_pu4Tok4k=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743513&amp;x-signature=%2BwIpFh7hhcwf1dFp7JTTFeE35Ks%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>å¦‚ä½•å®‰è£…è¿œç¨‹ç‰ˆæœ¬ï¼Œä¸ä½¿ç”¨æœ¬åœ°çš„è½¯é“¾æ¥</li>
</ul>
<p>è°ƒè¯•æœ¬åœ°è„šæ‰‹æ¶ï¼š</p>
<ul>
<li>è¿›å…¥åˆ°è„šæ‰‹æ¶ç›®å½•æ‰§è¡Œ<code>npm i -g test-hp-cli</code>ï¼ŒæŸ¥çœ‹binç›®å½•ä¸‹æ–‡ä»¶é“¾æ¥çš„è·¯å¾„å¯ä»¥çœ‹å‡ºæ¥æ˜¯é“¾æ¥åˆ°æœ¬åœ°çš„</li>
<li>æ‰§è¡Œ<code>npm link</code>åï¼Œä¼šåœ¨Node_modulesä¸­åˆ›å»ºä¸€ä¸ªtest-hp-cliçš„å‘½ä»¤ï¼Œå‘½ä»¤é“¾å‘çš„æ˜¯node_modulesä¸‹çš„test-hp-cliç›®å½•ï¼Œnode_modulesä¸‹çš„test-hp-cliåˆé“¾å‘æœ¬åœ°çš„hp-testã€‚</li>
</ul>
<p>æœªå‘å¸ƒçš„åŒ…å¦‚ä½•è°ƒè¯•ï¼š</p>
<ul>
<li>è¿›å…¥åˆ°è„šæ‰‹æ¶ç›®å½•æ‰§è¡Œ<code>npm link</code>ï¼Œæ­¤æ—¶ä¼šåœ¨å…¨å±€ç¯å¢ƒä¸‹åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥åˆ°å½“å‰ç›®å½•çš„node_modulesæ–‡ä»¶å¤¹ä¸‹ã€‚è¿™æ ·å°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡å‘½ä»¤è¡Œä½¿ç”¨è¯¥è„šæ‰‹æ¶äº†</li>
</ul>
<p>æ³¨å†Œå‘½ä»¤&amp;å‚æ•°è§£æ</p>
<ul>
<li>
<p><code>process.argv</code>å¯ä»¥è·å–åˆ°å‘½ä»¤è¡Œå‚æ•°ï¼Œæ‰§è¡Œç»“æœ</p>
</li>
<li>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7226f68cc2f84981a77eb167b965797d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2_kuI3mmK_pu4Tok4k=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743513&amp;x-signature=a9raLVtErVqh7Yor7M%2FlPvCFATQ%3D" alt="b3e664c53250df61ac5cda230fa64b22.png" loading="lazy"/></p>
</li>
<li>
<p>é€‰é¡¹å’Œå‚æ•°è§£æ</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1c2db97a1e04da0bf588901d3025aeb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2_kuI3mmK_pu4Tok4k=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743513&amp;x-signature=iNhplDnx3x%2F8sIc8iSI%2FL0N5dd8%3D" alt="17f17f719e1efd329e084c31a980ca34.png" loading="lazy"/></p>
<h2 data-id="heading-0">lerna</h2>
<p>æ˜¯ä¸€ä¸ªåŸºäºgit+npmçš„å¤špackageé¡¹ç›®çš„ç®¡ç†å·¥å…·
ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p>
<ul>
<li>è§£å†³è„šæ‰‹æ¶å¼€å‘è¿‡ç¨‹ä¸­çš„ä¸€äº›é‡å¤æ€§æ“ä½œ
<ul>
<li>åœºæ™¯ä¸€ï¼šä¾‹å¦‚å¼€å‘ä¸€ä¸ªå¤§å‹é¡¹ç›®ï¼Œä¾èµ–ä¸€ä¸ªå·¥å…·ç±»çš„åŒ…ï¼Œå¦‚æœè¿™ä¸ªåŒ…æ›´æ–°åæ€ä¹ˆæ›´æ–°å…¶ä»–çš„åŒ…ï¼ˆéœ€è¦npm linkï¼‰néè¿›è¡ŒéªŒè¯</li>
<li>åœºæ™¯äºŒï¼šä¾èµ–ç‰ˆæœ¬å…¨éƒ¨æ›´æ–°ï¼Œéœ€è¦æ‰‹åŠ¨åˆ é™¤node_moduleså¹¶ä¸”é‡æ–°æ‰§è¡Œnpm iï¼Œå¹¶ä¸”package.jsonæ˜¯è‡ªåŠ¨å¢å‡çš„ä¸å¯èƒ½æ‰‹åŠ¨å¢åŠ </li>
<li>åœºæ™¯ä¸‰ï¼šå¤špackageå•å…ƒæµ‹è¯•</li>
<li>ä»£ç æäº¤ï¼Œå¤§å‹é¡¹ç›®éƒ½å…±ç”¨çš„åŒç»™ä¸€ä¸ªä»“åº“</li>
<li>ä»£ç å‘å¸ƒï¼Œæ¯ä¸ªåŒ…éƒ½è¦å‘ä¸€ä¸ªå•ç‹¬çš„npmåŒ…ï¼Œå‘å¸ƒéš¾ä»¥ç®¡ç†</li>
</ul>
</li>
<li>ç‰ˆæœ¬ä¸€è‡´æ€§é—®é¢˜</li>
<li>å‘å¸ƒæ—¶ç‰ˆæœ¬ä¸€è‡´æ€§ï¼Œç‰ˆæœ¬ä¸€è‡´æ€§çš„å¥½å¤„ï¼šå‡çº§æ—¶ä¸€èµ·å‡çº§ï¼Œå¦åˆ™å¼€å‘æ—¶éœ€è¦ä¸åœçš„ç‰ˆæœ¬è°ƒè¯•ï¼Œç‰ˆæœ¬ä¸€è‡´æ€§æ—¶åªéœ€è¦ä¿è¯å½“å‰çš„ç‰ˆæœ¬å³å¯ï¼Œä¸ä¼šå­˜åœ¨å‘ä¸Šå’Œå‘ä¸‹å…¼å®¹é—®é¢˜</li>
<li>å‘å¸ƒåé¡¹ç›®ä¾èµ–ç‰ˆæœ¬å‡çº§
ä¼˜åŠ¿ï¼š</li>
<li>å¤§å¹…åº¦å‡å°‘é‡å¤æ“ä½œ</li>
<li>æå‡æ“ä½œæ ‡å‡†åŒ–</li>
</ul>
<p>æ¶æ„ä¼˜åŒ–ç›®çš„ï¼šé¡¹ç›®å¤æ‚åº¦æå‡åï¼Œéœ€è¦å¯¹é¡¹ç›®è¿›è¡Œæ¶æ„ä¼˜åŒ–ï¼Œæ¶æ„ä¼˜åŒ–çš„ä¸»è¦ç›®æ ‡å¾€å¾€ä»¥æå‡æ•ˆèƒ½ä¸ºæ ¸å¿ƒã€‚
ä½¿ç”¨lernaçš„é¡¹ç›®å‚è€ƒï¼š</p>
<ul>
<li>babel <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fbabel%2Fbabel.git" target="_blank" title="https://github.com/babel/babel.git" ref="nofollow noopener noreferrer">github.com/babel/babelâ€¦</a></li>
<li>vue-cli</li>
<li>create-react-app</li>
</ul>
<h3 data-id="heading-1">åˆ›å»ºè„šæ‰‹æ¶</h3>
<ul>
<li>åˆ›å»ºæ–‡ä»¶å¤¹test-cli-dev</li>
<li>åœ¨test-cli-devä¸‹å†åˆ›å»ºtest-cli-devç›®å½•</li>
<li>æ‰§è¡Œ<code>cnpm i -D lerna</code></li>
<li>æ‰§è¡Œ<code>lerna init</code>
å¯èƒ½ä¼šæŠ¥é”™
è§£å†³æ–¹æ³•ï¼š</li>
<li>åœ¨package.jsonä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5db33f30ea0f40c785553141133a545e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2_kuI3mmK_pu4Tok4k=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743513&amp;x-signature=h8xjnq8Vl3diA2XGEd8KM%2FzBJEA%3D" alt="81cc6ec76c09bee49d7a49e8e480e9c7.png" loading="lazy"/></p>

<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"workspaces"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
   <span class="hljs-string">"packages/*"</span>
 <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
</code></pre>
<h2 data-id="heading-2">é‡æ–°æ‰§è¡Œ<code>lerna init</code>ä¼šç”Ÿæˆå¦‚ä¸‹å†…å®¹ï¼š
å¸®æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆäº†gitignore,lerna.jsonç­‰æ–‡ä»¶</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/677e9907d0db44859317536eb0391d50~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2_kuI3mmK_pu4Tok4k=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743513&amp;x-signature=EmXf%2FYSXgxdvjv6C2Ido0QurQVs%3D" alt="0fd3c6b2b0c81b0d4398c511114d6550.png" loading="lazy"/></p>
<ul>
<li>
<p>åˆ›å»º<code>package</code>  -&gt; <code>lerna create</code> åˆ›å»ºcoreåŒ…<code>lerna create core</code> ä¿®æ”¹package nameä¸º<code>@test-cli-dev/core</code></p>
<p>è¿™æ ·å‘½å<code> "name": "@test-cli-dev/utils",</code>çš„å¥½å¤„æ˜¯åœ¨npmä¸Šå¯ä»¥é˜²æ­¢ç›®å½•é‡å¤ï¼Œ<code>npm i</code>å®‰è£…åçš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f391c6f880ec4271bfc85286829aa3bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2_kuI3mmK_pu4Tok4k=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743513&amp;x-signature=F5oFpGW2pd6cCZ7yuJML0g2RpSw%3D" alt="aec397ece0673196e47938ab74469b87.png" loading="lazy"/></p>
<ul>
<li><code>lerna add</code>v7ä¹‹å‰çš„ç‰ˆæœ¬ä½¿ç”¨ï¼Œå¯¹ç…§è¡¨</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3882c346c9a841bd85a1a3f235bc27ac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2_kuI3mmK_pu4Tok4k=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743513&amp;x-signature=Z5fSc614ik%2FL%2FZiLl2eGdYjhxOI%3D" alt="212cdc9f1840cd2b918baa6a1ce742d4.png" loading="lazy"/>
ä½¿ç”¨<code>lerna add</code>å‘½ä»¤ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/75be8844fb97442096626df66fb58c9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2_kuI3mmK_pu4Tok4k=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743513&amp;x-signature=E6WE2kCzX7KuFi%2BzBWlkBiljgRo%3D" alt="2aedb24f1a57b9d282433f0253c85f23.png" loading="lazy"/>
v8ç‰ˆæœ¬éœ€è¦ç»“åˆpnpmä½¿ç”¨ï¼Œæ•™ç¨‹å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Flerna.js.org%2Fdocs%2Frecipes%2Fusing-pnpm-with-lerna" target="_blank" title="https://lerna.js.org/docs/recipes/using-pnpm-with-lerna" ref="nofollow noopener noreferrer">lerna.js.org/docs/recipeâ€¦</a>
æœ¬åœ°ä¾èµ–,æ•™ç¨‹å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fpnpm.io%2Fworkspaces" target="_blank" title="https://pnpm.io/workspaces" ref="nofollow noopener noreferrer">pnpm.io/workspaces</a></p>
<ul>
<li>å°†åŒ…å®‰è£…åœ¨æŸä¸ªç‰¹å®šçš„ç©ºé—´</li>
<li><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ce6b6b806d14694bb7deaf6daba93f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2_kuI3mmK_pu4Tok4k=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743513&amp;x-signature=ZRszS7l4my%2BIIIit2Uyff%2BGKUOs%3D" alt="bb9b8f8c80bb9d7efc4a6d9445031f87.png" loading="lazy"/>
å‘½ä»¤<code>pnpm add @test-cli-dev/utils --filter @test-cli-dev/core</code>ï¼Œå…³äº<code>filter</code>å‘½ä»¤å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fpnpm.io%2Fzh%2Ffiltering" target="_blank" title="https://pnpm.io/zh/filtering" ref="nofollow noopener noreferrer">pnpm.io/zh/filterinâ€¦</a></li>
<li>å…¨å±€å®‰è£…ä¾èµ–<code>pnpm add -w @test-cli-dev/utils</code>ä¼šåœ¨å’Œlerna.jsonå¹³çº§çš„<code>packages.json</code>ä¸­æ–°å¢å¦‚ä¸‹é…ç½®ï¼š</li>
</ul>

<pre><code class="hljs language-less" lang="less">"<span class="hljs-selector-tag">dependencies</span>": {
    "<span class="hljs-variable">@test-cli-dev</span>/utils<span class="hljs-string">": "</span><span class="hljs-attribute">workspace</span>:^"
  }
</code></pre>
<p>å‘å¸ƒæµç¨‹ï¼š
<code>lerna publish</code>ï¼Œå‘å¸ƒä¹‹å‰å¿…é¡»è¦è¿›è¡Œä¸€æ¬¡ä»£ç æäº¤ï¼Œå¦åˆ™ä¼šæŠ¥é”™
å‘å¸ƒåé»˜è®¤æ²¡æœ‰å…¬å¼€å‘å¸ƒæ—¶ç§æœ‰çš„ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤è¿›è¡Œé…ç½®æ–‡æ¡£å‚è€ƒï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fpnpm.io%2Fzh%2Fcli%2Fpublish" target="_blank" title="https://pnpm.io/zh/cli/publish" ref="nofollow noopener noreferrer">pnpm.io/zh/cli/publâ€¦</a></p>
<h3 data-id="heading-3">lerna æºç åˆ†æ</h3>
<p>è°ƒè¯•ä»£ç ï¼š<code>lerna</code>ä»“åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flerna%2Flerna" target="_blank" title="https://github.com/lerna/lerna" ref="nofollow noopener noreferrer">github.com/lerna/lerna</a>
é¡¹ç›®ç»“æ„ï¼šä»é¡¹ç›®ä»‹ç»ä¸­å¯ä»¥çŸ¥é“ä¸»è¦çš„ç›®å½•ä¸ºä¸€ä¸‹6ä¸ª</p>
<ul>
<li>e2e ç«¯åˆ°ç«¯æµ‹è¯•ï¼Œç”¨æ¥æ¨¡æ‹Ÿç”¨æˆ·åœºæ™¯ï¼ŒéªŒè¯ç¨‹åºèƒ½å¦æ­£å¸¸è¿è¡Œ</li>
<li>integration ä¸€äº›é—ç•™ä»£ç ï¼ŒåŒ…å«ç«¯åˆ°ç«¯å’Œå•å…ƒæµ‹è¯•å†…å®¹ï¼Œæ–°çš„e2eæµ‹è¯•å·²ç»è¦†ç›–è¿™äº›åœºæ™¯ï¼Œåº”è¯¥ä¼˜å…ˆç”¨e2e</li>
<li>libs æºç åº“ï¼Œç”¨äºç»„åˆå‘å¸ƒåŒ…</li>
<li>packages è¦å‘å¸ƒåˆ°npmä¸Šçš„åŒ…</li>
<li>tools ä¸€äº›jså·¥å…·ç±»</li>
<li>website ç«™ç‚¹å±•ç¤ºä¹Ÿå°±æ˜¯lernaå®˜ç½‘
å…¥å£æ–‡ä»¶ï¼š<code>packages\lerna\package.json</code>ï¼Œå¯ä»¥æŸ¥çœ‹å…¶ä¸­çš„<code>bin</code>é…ç½®ï¼Œæ‰¾åˆ°å…¥å£æ–‡ä»¶ï¼Œå‘ç°æ˜¯</li>
</ul>

<pre><code class="hljs language-json" lang="json">  <span class="hljs-attr">"bin"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"lerna"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"dist/cli.js"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
</code></pre>
<p>è€Œä¸æ˜¯<code>src/cli.js</code>ï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆé…å‘¢ï¼Ÿ
åŸå› ï¼š<code>lerna</code>çš„æºç æ˜¯<code>ts</code>é¡¹ç›®ï¼ˆ<code>nodejs</code>æ— æ³•è¿è¡Œï¼‰ï¼Œè€Œ<code>npm</code>åŒ…éœ€è¦å‘å¸ƒçš„æ˜¯ç¼–è¯‘åçš„ã€å¯æ‰§è¡Œçš„<code>js</code>ä»£ç ï¼Œ<code>dist</code>ç›®å½•å°±æ˜¯å‡†å¤‡è¢«å‘å¸ƒçš„æœ€ç»ˆäº§å“ç›®å½•ã€‚
å¦‚æœæ˜¯è¿™æ ·æˆ‘ä»¬æ€ä¹ˆè¿›è¡Œè°ƒè¯•å‘¢ï¼Ÿ</p>
<ul>
<li>æ·»åŠ è°ƒè¯•æ–‡ä»¶,å¯ä»¥è®©aiè¯»æ•´ä¸ªé¡¹ç›®è‡ªå·±ç”Ÿæˆä¸€ä»½</li>
</ul>

<pre><code class="hljs language-bash" lang="bash">{
  <span class="hljs-string">"version"</span>: <span class="hljs-string">"0.2.0"</span>,
  <span class="hljs-string">"configurations"</span>: [
    {
      <span class="hljs-string">"name"</span>: <span class="hljs-string">"Debug Lerna CLI"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"node"</span>,
      <span class="hljs-string">"request"</span>: <span class="hljs-string">"launch"</span>,
      <span class="hljs-string">"runtimeExecutable"</span>: <span class="hljs-string">"node"</span>,
      <span class="hljs-string">"program"</span>: <span class="hljs-string">"<span class="hljs-variable">${workspaceFolder}</span>/packages/lerna/src/index.ts"</span>,
      <span class="hljs-string">"args"</span>: [<span class="hljs-string">"init"</span>],
      <span class="hljs-string">"sourceMaps"</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-string">"outFiles"</span>: [<span class="hljs-string">"<span class="hljs-variable">${workspaceFolder}</span>/dist/**/*.js"</span>],
      <span class="hljs-string">"restart"</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-string">"skipFiles"</span>: [<span class="hljs-string">"&lt;node_internals&gt;/**"</span>],
      <span class="hljs-string">"console"</span>: <span class="hljs-string">"integratedTerminal"</span>
    },
    {
      <span class="hljs-string">"name"</span>: <span class="hljs-string">"Debug Lerna Build"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"node"</span>,
      <span class="hljs-string">"request"</span>: <span class="hljs-string">"launch"</span>,
      <span class="hljs-string">"runtimeExecutable"</span>: <span class="hljs-string">"npm"</span>,
      <span class="hljs-string">"runtimeArgs"</span>: [<span class="hljs-string">"run"</span>, <span class="hljs-string">"build"</span>],
      <span class="hljs-string">"console"</span>: <span class="hljs-string">"integratedTerminal"</span>,
      <span class="hljs-string">"internalConsoleOptions"</span>: <span class="hljs-string">"neverOpen"</span>
    },
    {
      <span class="hljs-string">"name"</span>: <span class="hljs-string">"Debug Specific Command"</span>,
      <span class="hljs-string">"type"</span>: <span class="hljs-string">"node"</span>,
      <span class="hljs-string">"request"</span>: <span class="hljs-string">"launch"</span>,
      <span class="hljs-string">"runtimeExecutable"</span>: <span class="hljs-string">"node"</span>,
      <span class="hljs-string">"program"</span>: <span class="hljs-string">"<span class="hljs-variable">${workspaceFolder}</span>/packages/lerna/src/index.ts"</span>,
      <span class="hljs-string">"args"</span>: [<span class="hljs-string">"version"</span>, <span class="hljs-string">"--no-git-tag-version"</span>, <span class="hljs-string">"--no-push"</span>],
      <span class="hljs-string">"sourceMaps"</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-string">"outFiles"</span>: [<span class="hljs-string">"<span class="hljs-variable">${workspaceFolder}</span>/dist/**/*.js"</span>],
      <span class="hljs-string">"restart"</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-string">"skipFiles"</span>: [<span class="hljs-string">"&lt;node_internals&gt;/**"</span>],
      <span class="hljs-string">"console"</span>: <span class="hljs-string">"integratedTerminal"</span>
    }
  ]
}
</code></pre>
<ul>
<li>æ‰§è¡Œ<code>npm run build</code>å‘½ä»¤ï¼Œç”Ÿæˆ<code>dist</code>æ–‡ä»¶ï¼Œå¦åˆ™è¿è¡Œæ—¶binæ–‡ä»¶é…ç½®ä¼šæ‰¾ä¸åˆ°</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[HarmonyOSåº”ç”¨å¼€å‘ä¹‹æ»šåŠ¨å®¹å™¨Scroll]]></title>    <link>https://juejin.cn/post/7585206349749354548</link>    <guid>https://juejin.cn/post/7585206349749354548</guid>    <pubDate>2025-12-19T10:10:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585206349749354548" data-draft-id="7585180150255353871" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="HarmonyOSåº”ç”¨å¼€å‘ä¹‹æ»šåŠ¨å®¹å™¨Scroll"/> <meta itemprop="keywords" content="HarmonyOS"/> <meta itemprop="datePublished" content="2025-12-19T10:10:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·595143322177"/> <meta itemprop="url" content="https://juejin.cn/user/2359987827640909"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            HarmonyOSåº”ç”¨å¼€å‘ä¹‹æ»šåŠ¨å®¹å™¨Scroll
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2359987827640909/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·595143322177
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T10:10:21.000Z" title="Fri Dec 19 2025 10:10:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ»šåŠ¨å®¹å™¨ï¼ˆScrollï¼‰</h2>
<p><code>Scroll</code>è¡¨ç¤ºå¯æ»šåŠ¨çš„å®¹å™¨ç»„ä»¶ï¼Œ<strong>å½“å­ç»„ä»¶çš„å¸ƒå±€å°ºå¯¸è¶…è¿‡çˆ¶ç»„ä»¶çš„å°ºå¯¸æ—¶ï¼Œå†…å®¹å¯ä»¥æ»šåŠ¨ã€‚</strong></p>
<blockquote>
<p>[!warning]</p>
<p>æ³¨æ„ä¸¤ä¸ªè¦ç‚¹ï¼š</p>
<ol>
<li><code>Scroll</code>å­ç»„ä»¶çš„å¸ƒå±€å°ºå¯¸è¶…è¿‡çˆ¶ç»„ä»¶å°ºå¯¸æ—¶ï¼Œæ‰å¯ä»¥æ»šåŠ¨</li>
<li><code>Scroll</code>åªèƒ½æœ‰ä¸€ä¸ªå­ç»„ä»¶</li>
</ol>
</blockquote>
<h3 data-id="heading-1">åŸºæœ¬ä½¿ç”¨</h3>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œåœ¨<code>Column</code>ä¸­åŒ…å«<code>10</code>ä¸ª<code>Text</code>æ–‡æœ¬ï¼Œæ¯ä¸ª<code>Text</code>æ–‡æœ¬çš„é«˜åº¦ä¸º<code>100</code>ï¼Œé—´è·ä¸º<code>10</code>ã€‚</p>
<p><code>Scroll</code>å†…å­ç»„ä»¶çš„æ€»é«˜åº¦å¤§äº<code>Scroll</code>çˆ¶ç»„ä»¶çš„é«˜åº¦ï¼Œæ‰€ä»¥å¯ä»¥æ»šåŠ¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/22d0958dbe8d489bb3c04636ac273842~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTk1MTQzMzIyMTc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743820&amp;x-signature=%2BVucT7z2fwbEibpnZSW91Sjhfeo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä»£ç å¦‚ä¸‹</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">array</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>]
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>(){
      <span class="hljs-title class_">Scroll</span>(){
        <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {
          <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">array</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
            <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${item}</span>`</span>)
              .<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
              .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)
              .<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
              .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)
              .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">15</span>)
              .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
          })
        }
        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)
      }
    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">"100%"</span>)
    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">"#dedede"</span>)
  }
}

</code></pre>
<h3 data-id="heading-2">å…³é—­æ»šåŠ¨æ¡</h3>
<p>é€šè¿‡<code>.scrollBar(barState: BarState)</code>è®¾ç½®æ»šåŠ¨æ¡çš„æ˜¾ç¤ºæ¨¡å¼</p>
<ul>
<li><code>BarState.Off</code> å…³é—­æ»šåŠ¨æ¡</li>
<li><code>BarState.On</code> æ˜¾ç¤ºæ»šåŠ¨æ¡</li>
<li><code>BarState.Auto</code> æ»‘åŠ¨æ—¶æ˜¾ç¤ºæ»šåŠ¨æ¡ï¼Œ3ç§’åæ¶ˆå¤±</li>
</ul>

<pre><code class="hljs language-scss" lang="scss">Scroll(){
    ...
}<span class="hljs-selector-class">.scrollBar</span>(BarState.Off)   <span class="hljs-comment">//å…³é—­æ»šåŠ¨æ¡</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57c67f7fcfd541ff8c491572599de2a7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTk1MTQzMzIyMTc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743820&amp;x-signature=w9hQXqRT3DebcAx%2FYdrRFIHovOo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-3">æ»šåŠ¨æ–¹å‘</h3>
<p>é€šè¿‡<code>.scrollable(value: ScrollDirection)</code>å±æ€§ç”¨æ¥è®¾ç½®<code>Scroll</code>çš„æ»šåŠ¨æ–¹å‘ã€‚</p>
<p><strong>å‚æ•°</strong>ï¼š</p>
<ul>
<li><code>ScrollDirection.Vertical</code> å‚ç›´æ»šåŠ¨</li>
<li><code>ScrollDirection.Horizontal</code> æ°´å¹³æ»šåŠ¨</li>
</ul>
<p>ç¤ºä¾‹ï¼šåœ¨æ°´å¹³æ–¹å‘æ˜¾ç¤º10ä¸ªTextï¼Œæ²¿æ°´å¹³æ–¹å‘æ»šåŠ¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/888be7ce6d5842af8552d36061577fa1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTk1MTQzMzIyMTc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743820&amp;x-signature=3ziwXdspKyzvSsPr58lYJN2%2FWKE%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä»£ç å¦‚ä¸‹</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">array</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>]
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>(){
      <span class="hljs-title class_">Scroll</span>(){
        <span class="hljs-title class_">Row</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {
          <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">array</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
            <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${item}</span>`</span>)
              .<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
              .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)
              .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)
              .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)
              .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">15</span>)
              .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
          })
        }.<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)
      }
      .<span class="hljs-title function_">scrollBar</span>(<span class="hljs-title class_">BarState</span>.<span class="hljs-property">Off</span>)	<span class="hljs-comment">//å…³é—­æ»šåŠ¨æ¡</span>
      .<span class="hljs-title function_">scrollable</span>(<span class="hljs-title class_">ScrollDirection</span>.<span class="hljs-property">Horizontal</span>) <span class="hljs-comment">//æ°´å¹³æ»šåŠ¨æ–¹å‘</span>
    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-number">120</span>)
    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">"#dedede"</span>)
  }
}
</code></pre>
<h3 data-id="heading-4">æ»šåŠ¨æ¡æ ·å¼</h3>
<p>é€šè¿‡<code>scrollBarWidth(20)å’ŒscrollBarColor(Color.Red)</code>è®¾ç½®æ»šåŠ¨æ¡çš„å®½åº¦ä¸é¢œè‰²ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a189a8fe70334f66a95e899283dd00dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTk1MTQzMzIyMTc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743820&amp;x-signature=SYgnzBMWtNHfJtO80OCgeykaw0g%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title class_">Scroll</span>(){
       ...
}
.<span class="hljs-title function_">scrollBar</span>(<span class="hljs-title class_">BarState</span>.<span class="hljs-property">Auto</span>)
.<span class="hljs-title function_">scrollable</span>(<span class="hljs-title class_">ScrollDirection</span>.<span class="hljs-property">Horizontal</span>) <span class="hljs-comment">//æ»šåŠ¨æ–¹å‘</span>
.<span class="hljs-title function_">scrollBarWidth</span>(<span class="hljs-number">10</span>)	<span class="hljs-comment">//æ»šåŠ¨æ¡å®½åº¦</span>
.<span class="hljs-title function_">scrollBarColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>) <span class="hljs-comment">//æ»šåŠ¨æ¡é¢œè‰²</span>
</code></pre>
<h3 data-id="heading-5">æ»šåŠ¨æ§åˆ¶å™¨</h3>
<p>é€šè¿‡ç»™<code>Scroll</code>é…ç½®<code>Scroller</code>æ»šåŠ¨æ§åˆ¶å™¨ï¼Œæ¥æ§åˆ¶<code>Scroll</code>çš„æ»šåŠ¨ã€‚</p>
<p><code>Scroller</code>æœ‰å¦‚ä¸‹æ–¹æ³•æ§åˆ¶<code>Scroll</code>æ»šåŠ¨</p>
<ul>
<li><code>scrollEdge(value: Edge, options?: ScrollEdgeOptions | undefined)</code> æ»šåŠ¨åˆ°å®¹å™¨è¾¹ç¼˜</li>
<li><code>scrollTo(options: ScrollOptions)</code> æ»šåŠ¨åˆ°æŒ‡å®šä½ç½®
<ul>
<li><code>xOffset</code>: æ°´å¹³åç§»é‡ï¼ˆç›¸å¯¹äºå®¹å™¨å¼€å§‹ä½ç½®ï¼‰</li>
<li><code>yOffset</code>: å‚ç›´åç§»é‡ï¼ˆç›¸å¯¹äºå®¹å™¨å¼€å§‹ä½ç½®ï¼‰</li>
</ul>
</li>
<li><code>scrollBy(dx: Length, dy: Length)</code> æ»šåŠ¨æŒ‡å®šè·ç¦»ã€‚
<ul>
<li><code>dx</code>:  æ°´å¹³æ»šåŠ¨è·ç¦»ï¼ˆç›¸å¯¹äºå½“å‰ä½ç½®ï¼‰</li>
<li><code>dy</code>:  å‚ç›´æ»šåŠ¨è·ç¦»ï¼ˆç›¸å¯¹äºå½“å‰ä½ç½®ï¼‰</li>
</ul>
</li>
</ul>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç‚¹å‡»æŒ‰é’®æ—¶æ§åˆ¶<code>Scroll</code>æ»šåŠ¨åˆ°åº•éƒ¨ã€é¡¶éƒ¨ã€ä¸­é—´ä½ç½®ï¼Œæ­¤æ—¶å°±éœ€è¦ç”¨åˆ°<code>Scroller</code>æ»šåŠ¨æ§åˆ¶å™¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d508d714b124703af95d8c1c100422c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTk1MTQzMzIyMTc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743820&amp;x-signature=ySktwwCwzYkS6Jye6QvV8w0r%2BeE%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä»£ç å¦‚ä¸‹</p>
<pre><code class="hljs language-ts{5,9,30,34,44-47}" lang="ts{5,9,30,34,44-47}">@Entry
@Component
struct Index {
  @State array: number[] = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
  private scorller: Scroller = new Scroller()

  build() {
    Column() {
      Scroll(this.scorller) {
        Column({ space: 20 }) {
          ForEach(this.array, (item: number) =&gt; {
            Text(`${item}`)
              .width("100%")
              .textAlign(TextAlign.Center)
              .width("100%")
              .height(100)
              .borderRadius(15)
              .backgroundColor(Color.White)
          })
        }.padding(10)
      }
      .layoutWeight(1)
      .scrollBar(BarState.Auto)
      .scrollable(ScrollDirection.Vertical) //æ»šåŠ¨æ–¹å‘
      .scrollBarWidth(10)
      .scrollBarColor(Color.Red)

      Row() {
        Button("åˆ°åº•éƒ¨").onClick(() =&gt; {
          this.scorller.scrollEdge(Edge.Bottom)
        })

        Button("åˆ°é¡¶éƒ¨").onClick(() =&gt; {
          this.scorller.scrollEdge(Edge.Top)
        })

        Button("åˆ°ä¸­é—´").onClick(() =&gt; {
          animateToImmediately({
            duration: 300,
            playMode: PlayMode.Normal,
            curve: Curve.Ease
          }, () =&gt; {
            //æ»‘åŠ¨åˆ°æŒ‡å®šä½ç½®
            this.scorller.scrollTo({
              xOffset: 0,
              yOffset: 300
            })
          })
        })

        Button("æ»šåŠ¨ä¸€æ®µ").onClick(() =&gt; {
          //æ»‘åŠ¨åˆ°æŒ‡å®šä½ç½®
          animateToImmediately({
            duration: 300,
            playMode: PlayMode.Normal,
            curve: Curve.Ease
          }, () =&gt; {
            //æ»‘åŠ¨åˆ°æŒ‡å®šä½ç½®
            this.scorller.scrollBy(0, 100)
          })
        })
      }.width("100%")
      .height(200)
      .alignItems(VerticalAlign.Center)
      .justifyContent(FlexAlign.SpaceEvenly)

    }.width("100%")
    .height("100%")
    .backgroundColor("#dedede")
  }
}

</code></pre>
<h3 data-id="heading-6">æ»šåŠ¨ç›‘å¬</h3>
<p>æœ‰æ—¶å€™éœ€è¦ç›‘å¬å½“å‰<code>Scroll</code>æ»šåŠ¨çš„çŠ¶æ€ï¼Œæ ¹æ®çŠ¶æ€åšå‡ºç›¸åº”çš„å¤„ç†ï¼Œæ­¤æ—¶éœ€è¦ç”¨åˆ°æ»šåŠ¨ç›‘å¬ã€‚</p>
<ul>
<li><code>onDidScroll(handler: ScrollOnScrollCallback)</code> æ»šåŠ¨äº‹ä»¶å›è°ƒï¼Œ<code>Scroll</code>æ»šåŠ¨æ—¶è§¦å‘ã€‚è¿”å›å½“å‰å¸§æ»šåŠ¨çš„åç§»é‡å’Œå½“å‰æ»šåŠ¨çŠ¶æ€ã€‚
<ul>
<li><code>xOffset</code>: æ¯ä¸€å¸§çš„æ°´å¹³åç§»é‡</li>
<li><code>yOffset</code>: æ¯ä¸€å¸§çš„å‚ç›´åç§»é‡</li>
</ul>
</li>
</ul>
<p>è§¦å‘è¯¥äº‹ä»¶çš„æ¡ä»¶ï¼š</p>
<ol>
<li>æ»šåŠ¨ç»„ä»¶è§¦å‘æ»šåŠ¨æ—¶è§¦å‘ï¼Œæ”¯æŒé”®é¼ æ“ä½œç­‰å…¶ä»–è§¦å‘æ»šåŠ¨çš„è¾“å…¥è®¾ç½®ã€‚</li>
<li>é€šè¿‡æ»šåŠ¨æ§åˆ¶å™¨APIæ¥å£è°ƒç”¨ã€‚</li>
<li>è¶Šç•Œå›å¼¹ã€‚</li>
</ol>
<p><strong>ç¤ºä¾‹ä»£ç ï¼š ç›‘å¬Scrollæ»šåŠ¨çš„è·ç¦»ï¼Œå½“å‘ä¸‹æ»šåŠ¨200åƒç´ æ—¶ï¼Œå¼¹å‡ºæç¤ºï¼Œæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b98d2ab5e3a4ae6a369d376f960c99c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTk1MTQzMzIyMTc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743820&amp;x-signature=T2GPaiK0mNnZKY%2BNcfXAD9YAdqE%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä»£ç å¦‚ä¸‹</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { promptAction } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">array</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>]
  <span class="hljs-keyword">private</span> <span class="hljs-attr">scorller</span>: <span class="hljs-title class_">Scroller</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scroller</span>()
  <span class="hljs-comment">//è®°å½•ç›¸å¯¹äºScrollå¼€å§‹ä½ç½®çš„åç§»é‡</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">yOffset_total</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Scroll</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">scorller</span>) {
        <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {
          <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">array</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
            <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${item}</span>`</span>)
              .<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
              .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)
              .<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
              .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)
              .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">15</span>)
              .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Pink</span>)
          })
        }.<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)
      }
      .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)
      .<span class="hljs-title function_">scrollBar</span>(<span class="hljs-title class_">BarState</span>.<span class="hljs-property">Auto</span>)
      .<span class="hljs-title function_">scrollable</span>(<span class="hljs-title class_">ScrollDirection</span>.<span class="hljs-property">Vertical</span>) 
      .<span class="hljs-title function_">scrollBarWidth</span>(<span class="hljs-number">10</span>)
      .<span class="hljs-title function_">scrollBarColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>)
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">"#dedede"</span>)
       <span class="hljs-comment">//ç›‘å¬Scorllæ»šåŠ¨ï¼Œè®¡ç®—æ€»åç§»é‡</span>
      .<span class="hljs-title function_">onDidScroll</span>(<span class="hljs-function">(<span class="hljs-params">xOffset: <span class="hljs-built_in">number</span>, yOffset</span>) =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">yOffset_total</span> += yOffset
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">yOffset_total</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; yOffset &gt; <span class="hljs-number">0</span>) {
          promptAction.<span class="hljs-title function_">openToast</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">"æ»šåŠ¨åˆ°200äº†"</span> })
        }
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"åç§»é‡ï¼š"</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">yOffset_total</span>)
      })
    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">"100%"</span>)
  }
}

</code></pre>
<p>åœ¨æ»šåŠ¨æ—¶ï¼Œç›‘å¬æ»šåŠ¨åç§»é‡å¹¶æ‰“å°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ€»åç§»é‡<code>yOffset_total</code>æ˜¯ä¾æ¬¡é€’å¢çš„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ab19a440cec49e980f627cee62d682f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTk1MTQzMzIyMTc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743820&amp;x-signature=Op5nZEWqN8T1N%2FDSG%2FoJK97Ok%2BQ%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>åˆ°æ­¤ï¼Œ<code>Scroll</code>çš„ä½¿ç”¨ä»¥åŠ<code>Scroller</code>æ»šåŠ¨æ§åˆ¶å™¨å°±ä»‹ç»å®Œäº†ã€‚<code>Scroller</code>æ»šåŠ¨æ§åˆ¶å™¨åœ¨å…¶ä»–å¯æ»šåŠ¨ç»„ä»¶ä¹ŸåŒæ ·é€‚ç”¨ã€‚</p>
<p>å¯¹é¸¿è’™æ„Ÿå…´è¶£çš„åŒå­¦ï¼Œå…è´¹è€ƒå–<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Ftraining%2FclassDetail%2Fcd630ebdc1c444b4b4ff10ae385eeac2%3Ftype%3D1" target="_blank" title="https://developer.huawei.com/consumer/cn/training/classDetail/cd630ebdc1c444b4b4ff10ae385eeac2?type=1" ref="nofollow noopener noreferrer">é¸¿è’™å¼€å‘è€…è®¤è¯</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¸¿è’™åº”ç”¨å¼€å‘ä¹‹@Builderè‡ªå®šä¹‰æ„å»ºå‡½æ•°ï¼šå€¼ä¼ é€’ä¸å¼•ç”¨ä¼ é€’ä¸UIæ›´æ–°]]></title>    <link>https://juejin.cn/post/7585391510058434612</link>    <guid>https://juejin.cn/post/7585391510058434612</guid>    <pubDate>2025-12-19T10:13:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585391510058434612" data-draft-id="7585206349749387316" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¸¿è’™åº”ç”¨å¼€å‘ä¹‹@Builderè‡ªå®šä¹‰æ„å»ºå‡½æ•°ï¼šå€¼ä¼ é€’ä¸å¼•ç”¨ä¼ é€’ä¸UIæ›´æ–°"/> <meta itemprop="keywords" content="HarmonyOS"/> <meta itemprop="datePublished" content="2025-12-19T10:13:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·595143322177"/> <meta itemprop="url" content="https://juejin.cn/user/2359987827640909"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¸¿è’™åº”ç”¨å¼€å‘ä¹‹@Builderè‡ªå®šä¹‰æ„å»ºå‡½æ•°ï¼šå€¼ä¼ é€’ä¸å¼•ç”¨ä¼ é€’ä¸UIæ›´æ–°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2359987827640909/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·595143322177
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T10:13:26.000Z" title="Fri Dec 19 2025 10:13:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">@Builderè£…é¥°å™¨ï¼šè‡ªå®šä¹‰æ„å»ºå‡½æ•°</h2>
<p>è¢«<code>@Builder</code>è£…é¥°çš„å‡½æ•°ç§°ä¸º<strong>è‡ªå®šä¹‰æ„å»ºå‡½æ•°</strong>ï¼Œå®ƒæ˜¯ä¸€ç§è½»é‡åŒ– UI å¤ç”¨æœºåˆ¶ï¼Œå®ƒå…è®¸å¼€å‘è€…å°†é‡å¤ä½¿ç”¨çš„ <code>UI </code>å…ƒç´ æŠ½è±¡ä¸ºå‡½æ•°ï¼Œè¿™äº›å‡½æ•°å¯ä»¥åœ¨ <code>build</code> å‡½æ•°ä¸­è¢«è°ƒç”¨ä»¥å®ç°<code> UI</code> å¤ç”¨ã€‚</p>
<p>è‡ªå®šä¹‰æ„å»ºå‡½æ•°æ ¹æ®å®šä¹‰çš„ä½ç½®ä¸åŒåˆ†ä¸º<strong>ç§æœ‰è‡ªå®šä¹‰å‡½æ•°</strong>å’Œ<strong>å…¨å±€è‡ªå®šä¹‰å‡½æ•°</strong>ã€‚</p>
<h3 data-id="heading-1">ç§æœ‰è‡ªå®šä¹‰æ„å»ºå‡½æ•°</h3>
<p>ç§æœ‰è‡ªå®šä¹‰æ„å»ºå‡½æ•°å®šä¹‰åœ¨<code>@Component</code>ç»„ä»¶å†…ï¼Œå±äºè¯¥ç»„ä»¶ç§æœ‰çš„ï¼Œåªèƒ½åœ¨<strong>è¯¥ç»„ä»¶å†…</strong>çš„<code>build</code>å‡½æ•°æˆ–è€…å…¶ä»–è‡ªå®šä¹‰æ„å»ºå‡½æ•°ä¸­è°ƒç”¨ã€‚</p>
<pre><code class="hljs language-ts{9-12,5}" lang="ts{9-12,5}">@Component
struct MyComponent {
  build() {
    Column() {
      this.myBuilder()
    }
  }

  @Builder
  myBuilder() {
    Text("ç§æœ‰@Builder")
  }
}

@Entry
@Component
struct Index {
  build() {
    Column({ space: 10 }) {
      MyComponent()
    }
    .width("100%")
    .height("100%")
  }
}
</code></pre>
<h3 data-id="heading-2">å…¨å±€è‡ªå®šä¹‰æ„å»ºå‡½æ•°</h3>
<p>å…¨å±€è‡ªå®šä¹‰å‡½æ•°å®šä¹‰åœ¨<code>@Component</code>ç»„ä»¶å¤–ï¼Œå¯ä»¥åœ¨å…¶ä»–è‡ªå®šä¹‰å‡½æ•°æˆ–è€…å…¶ä»–è‡ªå®šä¹‰ç»„ä»¶ä¸­è°ƒç”¨ã€‚</p>
<pre><code class="hljs language-ts{1-4,11}" lang="ts{1-4,11}">@Builder
function myBuilder() {
  Text("å…¨å±€@Builder")
}

@Entry
@Component
struct Index {
  build() {
    Column({ space: 10 }) {
      myBuilder()
    }
    .width("100%")
    .height("100%")
  }
}
</code></pre>
<p><strong>@Builderä¸@Componentçš„åŒºåˆ«</strong></p>
<p>ç»è¿‡ä¸Šé¢çš„æè¿°å¯èƒ½ä¼šå‘ç°@Componentå’Œ@Builderéƒ½å¯ä»¥ç”¨äºUIå¤ç”¨ï¼Œä»–ä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>@Builder</code>ï¼šçº¯UIé€»è¾‘å¤ç”¨ï¼Œæ— ç‹¬ç«‹çŠ¶æ€ç®¡ç†ä¸ç”Ÿå‘½å‘¨æœŸï¼Œå¿…é¡»é€šè¿‡å‚æ•°ä¼ é€’çš„æ–¹å¼ä¸è°ƒç”¨æ–¹å®Œæˆæ•°æ®äº¤äº’ã€‚</li>
<li><code>@Componentï¼š</code>å®Œæ•´ç»„ä»¶å°è£…ï¼Œæ‹¥æœ‰ç‹¬ç«‹çŠ¶æ€ç®¡ç†ä¸ç”Ÿå‘½å‘¨æœŸã€‚</li>
</ul>
<h3 data-id="heading-3">è‡ªå®šä¹‰æ„å»ºå‡½æ•°å‚æ•°ä¼ é€’è§„åˆ™</h3>
<p>è‡ªå®šä¹‰æ„å»ºå‡½æ•°çš„å‚æ•°ä¼ é€’æœ‰<strong>æŒ‰å€¼ä¼ é€’</strong>å’Œ<strong>æŒ‰å¼•ç”¨ä¼ é€’</strong>ä¸¤ç§ï¼Œå‡éœ€éµå®ˆä»¥ä¸‹è§„åˆ™ï¼š</p>
<ul>
<li>å‚æ•°çš„ç±»å‹å¿…é¡»ä¸å‚æ•°å£°æ˜çš„ç±»å‹ä¸€è‡´ï¼Œä¸å…è®¸undefinedã€nullå’Œè¿”å›undefinedã€nullçš„è¡¨è¾¾å¼ã€‚</li>
<li>åœ¨<code>@Builder</code>è£…é¥°çš„å‡½æ•°å†…éƒ¨ï¼Œä¸å…è®¸æ”¹å˜å‚æ•°å€¼ã€‚</li>
<li>åªæœ‰å½“ä¼ å…¥ä¸€ä¸ªå‚æ•°ä¸”è¯¥å‚æ•°ç›´æ¥ä¼ å…¥å¯¹è±¡å­—é¢é‡æ—¶ï¼Œæ‰ä¼šæŒ‰å¼•ç”¨ä¼ é€’ï¼Œå…¶ä»–ä¼ é€’æ–¹å¼å‡ä¸ºæŒ‰å€¼ä¼ é€’ã€‚</li>
</ul>
<h4 data-id="heading-4">æŒ‰å€¼ä¼ é€’å‚æ•°</h4>
<p>å®šä¹‰ä¸€ä¸ªå…¨å±€è‡ªå®šä¹‰æ„å»ºå‡½æ•°<code>textBuilder(text: string)</code>ï¼Œå‚æ•°åªæœ‰ä¸€ä¸ªä¸”ä¸æ˜¯å­—é¢é‡å¯¹è±¡ï¼Œæ‰€ä»¥æŒ‰ç…§å€¼ä¼ é€’ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Builder</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">textBuilder</span>(<span class="hljs-params">text: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-title class_">Text</span>(<span class="hljs-string">"Hello,"</span>+text).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)
}
</code></pre>
<p>è°ƒç”¨<code>@Builder</code>è£…é¥°çš„å‡½æ•°é»˜è®¤æŒ‰å€¼ä¼ é€’ã€‚å½“ä¼ é€’çš„å‚æ•°ä¸ºçŠ¶æ€å˜é‡æ—¶ï¼ŒçŠ¶æ€å˜é‡çš„æ”¹å˜ä¸ä¼šå¼•èµ·@Builderå‡½æ•°å†…çš„UIåˆ·æ–°</p>
<pre><code class="hljs language-ts" lang="ts">
<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'World'</span>

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title function_">textBuilder</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">text</span>)
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"ä¿®æ”¹text"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">//ä¿®æ”¹çŠ¶æ€å˜é‡ï¼Œä¸ä¼šå¼•ç”¨@Builderå‡½æ•°ä¸­UIçš„æ›´æ–°</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">text</span> = <span class="hljs-string">"ArkUI"</span>
      })
    }
  }
}
</code></pre>
<p>å¦‚ä¸‹å›¾ï¼Œç»æµ‹è¯•çŠ¶æ€å˜é‡çš„æ”¹å˜<strong>ä¸ä¼šå¼•èµ·<code>@Builder</code>å‡½æ•°å†…UIåˆ·æ–°</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c310412cdbe14f8e95c8458d6cb04f6b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTk1MTQzMzIyMTc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766744005&amp;x-signature=ihCpYr2t5BG1yDv5%2BDG8hfgcQ1A%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-5">æŒ‰å¼•ç”¨ä¼ é€’å‚æ•°</h4>
<p>å®šä¹‰ä¸€ä¸ª<code>@Builder</code>è‡ªå®šä¹‰æ„å»ºå‡½æ•°ï¼Œå‚æ•°ä¸ºè‡ªå®šä¹‰å¯¹è±¡ç±»å‹ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Params</span> {
  <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>
}

<span class="hljs-meta">@Builder</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">textBuilder</span>(<span class="hljs-params">params: Params</span>) {
  <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${params.text}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)
}
</code></pre>
<p>è°ƒç”¨æŒ‰å¼•ç”¨ä¼ é€’å‚æ•°æ—¶ï¼Œä¼ é€’çš„å‚æ•°å¯ä¸ºçŠ¶æ€å˜é‡ï¼Œä¸”çŠ¶æ€å˜é‡çš„æ”¹å˜ä¼šå¼•èµ·<code>@Builder</code>å‡½æ•°å†…çš„UIåˆ·æ–°ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'World'</span>

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title function_">textBuilder</span>({
        <span class="hljs-attr">text</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">text</span>
      })
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"ä¿®æ”¹text"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">//ä¿®æ”¹çŠ¶æ€å˜é‡ï¼Œä¸ä¼šå¼•ç”¨@Builderå‡½æ•°ä¸­UIçš„æ›´æ–°</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">text</span> = <span class="hljs-string">"ArkUI"</span>
      })
    }
  }
}
</code></pre>
<p>é¢„è§ˆæ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/54a5e3ea1a3e4aa8b8a2cabf1d5620c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTk1MTQzMzIyMTc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766744005&amp;x-signature=y448uzzXnKDkDczYYGblqNkSun8%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-6">é™åˆ¶æ¡ä»¶</h3>
<ul>
<li><code>@Builder</code>è‡ªå®šä¹‰å‡½æ•°å†…éƒ¨ä¸å…è®¸ä¿®æ”¹å‚æ•°å€¼ï¼Œå¦åˆ™æ¡†æ¶ä¼šæŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸ã€‚</li>
<li><code>@Builder</code>è‡ªå®šä¹‰æ„å»ºå‡½æ•°å­˜åœ¨ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„å‚æ•°æ—¶ï¼Œå³ä½¿é€šè¿‡å¯¹è±¡å­—é¢é‡å½¢å¼ä¼ é€’ï¼Œå€¼çš„æ”¹å˜ä¹Ÿä¸ä¼šè§¦å‘UIåˆ·æ–°ã€‚</li>
</ul>
<p>ç¤ºä¾‹1ï¼šåœ¨<code>@Builder</code>ä¸­ä¿®æ”¹å‚æ•°å€¼</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Params</span> {
  <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>
}

<span class="hljs-meta">@Builder</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">textBuilder</span>(<span class="hljs-params">params: Params</span>) {
  <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${params.text}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)
    .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
      params.<span class="hljs-property">text</span> = <span class="hljs-string">"å“ˆå“ˆå“ˆ"</span>	<span class="hljs-comment">//ã€é”™è¯¯ã€‘ï¼Œç¦æ­¢æ”¹å‚æ•°çš„å€¼</span>
    })
}
</code></pre>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå‡ºç°é¢„è§ˆé”™è¯¯</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89aded3018bb4b4f8c7d4c297bb39c6d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTk1MTQzMzIyMTc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766744005&amp;x-signature=tXlX46QgA4zNdV%2FkrBnloiTBTS4%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ç¤ºä¾‹2ï¼šåœ¨<code>@Builder</code>ä¸­æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸ä¼šè§¦å‘UIæ›´æ–°ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { promptAction } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkUI"</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Params</span> {
  <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>
}

<span class="hljs-meta">@Builder</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">textBuilder</span>(<span class="hljs-params">params: Params,num:<span class="hljs-built_in">number</span></span>) {
  <span class="hljs-title class_">Column</span>(){
    <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${params.text}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)
      .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        params.<span class="hljs-property">text</span> = <span class="hljs-string">"å“ˆå“ˆå“ˆ"</span>
      })

    <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${num}</span>`</span>)
  }

}

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'World'</span>

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title function_">textBuilder</span>({
        <span class="hljs-attr">text</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">text</span>
      },<span class="hljs-number">100</span>)
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"ä¿®æ”¹text"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">//ä¿®æ”¹çŠ¶æ€å˜é‡ï¼Œä¸ä¼šå¼•ç”¨@Builderå‡½æ•°ä¸­UIçš„æ›´æ–°</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">text</span> = <span class="hljs-string">"ArkUI"</span>
      })
    }
  }
}
</code></pre>
<p>å¦‚ä¸‹å›¾ï¼Œå½“@Builderæ¥æ”¶2ä¸ªå‚æ•°æ—¶ï¼ŒUIæ›´æ–°ä¸ç”Ÿæ•ˆã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a9723ca38724e70b220c6e84a6681aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTk1MTQzMzIyMTc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766744005&amp;x-signature=2qb6%2FllJ1aBauqCb2myUyURCY10%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
å¯¹é¸¿è’™æ„Ÿå…´è¶£çš„åŒå­¦ï¼Œå…è´¹è€ƒå–<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Ftraining%2FclassDetail%2Fcd630ebdc1c444b4b4ff10ae385eeac2%3Ftype%3D1" target="_blank" title="https://developer.huawei.com/consumer/cn/training/classDetail/cd630ebdc1c444b4b4ff10ae385eeac2?type=1" ref="nofollow noopener noreferrer">é¸¿è’™å¼€å‘è€…è®¤è¯</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ”¥ çº¯ JS å®ç° SQL å­—æ®µæ™ºèƒ½è§£æå·¥å…·ç±»ï¼Œå‰ç«¯ä¹Ÿèƒ½ç©è½¬ SQL è§£æ]]></title>    <link>https://juejin.cn/post/7585138968167956516</link>    <guid>https://juejin.cn/post/7585138968167956516</guid>    <pubDate>2025-12-19T10:08:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585138968167956516" data-draft-id="7585171571129974820" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ”¥ çº¯ JS å®ç° SQL å­—æ®µæ™ºèƒ½è§£æå·¥å…·ç±»ï¼Œå‰ç«¯ä¹Ÿèƒ½ç©è½¬ SQL è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-19T10:08:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é…¸èœåœŸç‹—"/> <meta itemprop="url" content="https://juejin.cn/user/2676649826197575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ”¥ çº¯ JS å®ç° SQL å­—æ®µæ™ºèƒ½è§£æå·¥å…·ç±»ï¼Œå‰ç«¯ä¹Ÿèƒ½ç©è½¬ SQL è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2676649826197575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é…¸èœåœŸç‹—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T10:08:22.000Z" title="Fri Dec 19 2025 10:08:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ”¥ çº¯ JS å®ç° SQL å­—æ®µæ™ºèƒ½è§£æå·¥å…·ç±»ï¼Œå‰ç«¯ä¹Ÿèƒ½ç©è½¬ SQL è§£æ</h2>
<p>åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¶å°”ä¼šé‡åˆ°éœ€è¦è§£æ SQL è¯­å¥çš„åœºæ™¯ â€”â€” æ¯”å¦‚å¯è§†åŒ– SQL ç¼–è¾‘å™¨ã€æ•°æ®å¤§å±å­—æ®µæ˜ å°„ã€ä½ä»£ç å¹³å°çš„ SQL é…ç½®è§£æç­‰ã€‚å¦‚æœæ¯æ¬¡éƒ½é åç«¯è¿”å›å­—æ®µä¿¡æ¯ï¼Œä¸ä»…å¢åŠ è”è°ƒæˆæœ¬ï¼Œè¿˜ä¼šé™ä½å‰ç«¯äº¤äº’çš„çµæ´»æ€§ã€‚</p>
<p>ä»Šå¤©ç»™å¤§å®¶åˆ†äº«ä¸€ä¸ªæˆ‘å°è£…çš„<strong>çº¯ JavaScript SQL å­—æ®µè§£æå·¥å…·ç±»</strong>ï¼Œæ— éœ€ä¾èµ–ä»»ä½•ç¬¬ä¸‰æ–¹åº“ï¼Œå°±èƒ½å¿«é€Ÿæå– SQL ä¸­çš„æŸ¥è¯¢å­—æ®µã€è¡¨åã€å­—æ®µåˆ«åç­‰æ ¸å¿ƒä¿¡æ¯ï¼Œå…¼å®¹ç»å¤§å¤šæ•°å¸¸è§çš„ SELECT è¯­æ³•åœºæ™¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b9c5949325ba4348a50a4498ef2ff687~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YW46I-c5Zyf54uX:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743702&amp;x-signature=orBhTBMt5vmbSdNYHp3XNHQNLW4%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-1">ğŸ¯ å·¥å…·ç±»æ ¸å¿ƒèƒ½åŠ›</h3>
<p>è¿™ä¸ªå·¥å…·ç±»ä¸“ä¸ºå‰ç«¯åœºæ™¯è®¾è®¡ï¼Œä¸»æ‰“è½»é‡ã€æ˜“ç”¨ã€å…¼å®¹æ€§å¼ºï¼Œæ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li>ğŸ“ SQL é¢„å¤„ç†ï¼šè‡ªåŠ¨æ¸…ç†æ³¨é‡Šã€å¤šä½™ç©ºæ ¼ï¼Œç»Ÿä¸€è¯­æ³•æ ¼å¼</li>
<li>ğŸ” å­—æ®µæå–ï¼šæ”¯æŒæå–åŸå§‹å­—æ®µã€çº¯å­—æ®µåï¼ˆå‰”é™¤è¡¨åˆ«å / å‡½æ•°åŒ…è£¹ï¼‰</li>
<li>ğŸ“Œ åˆ«åè§£æï¼šå…¼å®¹<code>AS åˆ«å</code>å’Œç›´æ¥<code>å­—æ®µ åˆ«å</code>ä¸¤ç§å†™æ³•ï¼Œç”Ÿæˆåˆ«åæ˜ å°„è¡¨</li>
<li>ğŸ“Š è¡¨åè¯†åˆ«ï¼šä» FROM å­å¥ä¸­æå–è¡¨åï¼Œè‡ªåŠ¨è·³è¿‡è¡¨åˆ«åå’ŒåµŒå¥—æŸ¥è¯¢</li>
<li>ğŸš¨ åµŒå¥—æŸ¥è¯¢æ ‡è®°ï¼šå¿«é€Ÿè¯†åˆ« SQL ä¸­æ˜¯å¦åŒ…å«å­æŸ¥è¯¢ï¼Œä¾¿äºç‰¹æ®Šå¤„ç†</li>
<li>âœ¨ é›¶ä¾èµ–ï¼šçº¯åŸç”Ÿ JS å®ç°ï¼Œæ— éœ€å¼•å…¥ SQL è§£æåº“</li>
</ul>
<h3 data-id="heading-2">ğŸ›  æ ¸å¿ƒä»£ç å®ç°</h3>
<h4 data-id="heading-3">å®Œæ•´å·¥å…·ç±»ä»£ç </h4>
<p>javascript</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-ini" lang="ini">/**
 * SQLè§£æå·¥å…·ç±»
 * ç‰¹æ€§ï¼š
 * 1. data_field ä¼˜å…ˆä½¿ç”¨åˆ«åï¼Œæ— åˆ«åæ—¶ç”¨å®é™…å­—æ®µï¼ˆç‰©ç†å­—æ®µå»å‰ç¼€/å­—ç¬¦ä¸²å¸¸é‡åŸå§‹å€¼ï¼‰
 * 2. ç‰©ç†å­—æ®µï¼ˆå¦‚"ERP_Provider"."No"ï¼‰æ— åˆ«åæ—¶æå–çº¯å­—æ®µåï¼ˆNoï¼‰
 * 3. å­—ç¬¦ä¸²å¸¸é‡å­—æ®µï¼ˆå¦‚'å…¥åº“å•'ï¼‰æ— åˆ«åæ—¶ä¿ç•™åŸå§‹å€¼ä½œä¸ºå­—æ®µå
 * 4. æ”¯æŒ PostgreSQL ç‰¹æœ‰è¯­æ³•ï¼ˆDISTINCT ONï¼‰å’ŒåµŒå¥—å­æŸ¥è¯¢
 * 5. å®Œå…¨æŒ‰SQLåŸå§‹å†…å®¹è§£æï¼Œä¸åšè‡ªå®šä¹‰ç”Ÿæˆ
 */
class SqlParser {
    /**
     * ä»SQLè¯­å¥ä¸­æå–å­—æ®µä¿¡æ¯
     * @param {String} sql - å¾…è§£æçš„SQLè¯­å¥
     * @returns {Array} æ ¼å¼åŒ–åçš„å­—æ®µåˆ—è¡¨
     */
    static extractFormattedFields(sql) {
        // é˜²å¾¡ï¼šå¤„ç†ç©ºSQLæˆ–éå­—ç¬¦ä¸²è¾“å…¥
        if (!sql || typeof sql !== 'string') return <span class="hljs-section">[]</span><span class="hljs-comment">;</span>

        // æ¸…ç†SQLï¼šç§»é™¤æ³¨é‡Šã€å¤šä½™ç©ºæ ¼/æ¢è¡Œï¼Œä¿ç•™æ ¸å¿ƒç»“æ„
        const <span class="hljs-attr">cleanedSql</span> = this.cleanSQL(sql)<span class="hljs-comment">;</span>

        // æå–ç›®æ ‡SQLï¼ˆä¼˜å…ˆè§£æå­æŸ¥è¯¢ï¼Œè‹¥å¤–å±‚æ˜¯ select * from (...)ï¼‰
        const <span class="hljs-attr">targetSql</span> = this.extractTargetSql(cleanedSql)<span class="hljs-comment">;</span>

        // éªŒè¯SQLæœ‰æ•ˆæ€§ï¼ˆå¿…é¡»å«SELECT/FROMï¼Œä¸”SELECTåœ¨FROMå‰ï¼‰
        if (!this.isValidSql(targetSql)) {
            console.warn('æ— æ•ˆSQLï¼šç¼ºå°‘SELECT/FROMæˆ–é¡ºåºé”™è¯¯')<span class="hljs-comment">;</span>
            return <span class="hljs-section">[]</span><span class="hljs-comment">;</span>
        }

        // æå–SELECTå’ŒFROMä¹‹é—´çš„å­—æ®µéƒ¨åˆ†ï¼ˆå…¼å®¹DISTINCT ONï¼‰
        const <span class="hljs-attr">upperSql</span> = targetSql.toUpperCase()<span class="hljs-comment">;</span>
        const <span class="hljs-attr">selectStart</span> = upperSql.indexOf(<span class="hljs-string">'SELECT'</span>) + <span class="hljs-number">6</span><span class="hljs-comment">;</span>
        // å¤„ç†DISTINCT ONï¼šè·³è¿‡ONåçš„æ‹¬å·å†…å®¹
        const <span class="hljs-attr">distinctOnEnd</span> = this.findDistinctOnEnd(targetSql, selectStart)<span class="hljs-comment">;</span>
        const <span class="hljs-attr">fromStart</span> = upperSql.indexOf(<span class="hljs-string">'FROM'</span>)<span class="hljs-comment">;</span>
        const <span class="hljs-attr">fieldsPart</span> = targetSql.substring(distinctOnEnd, fromStart).trim()<span class="hljs-comment">;</span>

        // åˆ†å‰²å­—æ®µå¹¶è§£æï¼ˆå¤„ç†æ‹¬å·å†…é€—å·ï¼‰
        return this.splitFields(fieldsPart)
            .map(<span class="hljs-attr">token</span> =&gt; token.trim())
            .filter(<span class="hljs-attr">token</span> =&gt; token)
            .map(<span class="hljs-attr">token</span> =&gt; this.parseToFormattedField(token))
            .filter(<span class="hljs-attr">field</span> =&gt; field)<span class="hljs-comment">; // è¿‡æ»¤è§£æå¤±è´¥çš„å­—æ®µ</span>
    }

    /**
     * æ¸…ç†SQLï¼šç§»é™¤æ³¨é‡Šå’Œå¤šä½™ç©ºæ ¼
     */
    static cleanSQL(sql) {
        return sql
            .replace(/--.*$/gm, "") // ç§»é™¤å•è¡Œæ³¨é‡Š
            .replace(/\/\*<span class="hljs-section">[\s\S]</span>*?\*\//g, "") // ç§»é™¤å¤šè¡Œæ³¨é‡Š
            .replace(/\s+/g, ' ') // å‹ç¼©ç©ºæ ¼
            .trim()<span class="hljs-comment">;</span>
    }

    /**
     * æå–ç›®æ ‡SQLï¼šè‹¥å¤–å±‚æ˜¯ select * from (å­æŸ¥è¯¢)ï¼Œåˆ™è§£æå­æŸ¥è¯¢
     */
    static extractTargetSql(cleanedSql) {
        const <span class="hljs-attr">subqueryRegex</span> = /SELECT\s+\*\s+FROM\s+\(([\s\S]*)\)\s+AS\s+\w+/i<span class="hljs-comment">;</span>
        const <span class="hljs-attr">subqueryMatch</span> = cleanedSql.match(subqueryRegex)<span class="hljs-comment">;</span>
        if (subqueryMatch &amp;&amp; subqueryMatch<span class="hljs-section">[1]</span>) {
            return subqueryMatch<span class="hljs-section">[1]</span>.trim()<span class="hljs-comment">; // å­æŸ¥è¯¢ä½œä¸ºç›®æ ‡</span>
        }
        return cleanedSql<span class="hljs-comment">; // å¦åˆ™ç”¨åŸå§‹SQL</span>
    }

    /**
     * å®šä½DISTINCT ONçš„ç»“æŸä½ç½®ï¼ˆè·³è¿‡æ‹¬å·å†…å®¹ï¼‰
     */
    static findDistinctOnEnd(sql, selectStart) {
        const <span class="hljs-attr">distinctOnRegex</span> = /DISTINCT\s+<span class="hljs-literal">ON</span>\s*\(/i<span class="hljs-comment">;</span>
        const <span class="hljs-attr">match</span> = sql.substring(selectStart).match(distinctOnRegex)<span class="hljs-comment">;</span>
        if (!match) return selectStart<span class="hljs-comment">; // æ— DISTINCT ONï¼Œç›´æ¥è¿”å›SELECTèµ·å§‹ä½ç½®</span>

        // è®¡ç®—DISTINCT ON(...)çš„ç»“æŸç´¢å¼•ï¼ˆè·³è¿‡æ‹¬å·å†…å†…å®¹ï¼‰
        const <span class="hljs-attr">onStart</span> = selectStart + match.index + match[<span class="hljs-number">0</span>].length<span class="hljs-comment">;</span>
        let <span class="hljs-attr">bracketCount</span> = <span class="hljs-number">1</span><span class="hljs-comment">; // å·²è¿›å…¥ä¸€ä¸ªæ‹¬å·</span>
        let <span class="hljs-attr">currentIndex</span> = <span class="hljs-literal">on</span>Start<span class="hljs-comment">;</span>

        while (currentIndex &lt; sql.length &amp;&amp; bracketCount &gt; 0) {
            const <span class="hljs-attr">char</span> = sql[currentIndex]<span class="hljs-comment">;</span>
            if (<span class="hljs-attr">char</span> === <span class="hljs-string">'('</span>) bracketCount++<span class="hljs-comment">;</span>
            if (<span class="hljs-attr">char</span> === <span class="hljs-string">')'</span>) bracketCount--<span class="hljs-comment">;</span>
            currentIndex++<span class="hljs-comment">;</span>
        }

        return currentIndex<span class="hljs-comment">; // è¿”å›DISTINCT ON(...)åçš„ä½ç½®</span>
    }

    /**
     * æ™ºèƒ½åˆ†å‰²å­—æ®µï¼ˆå¤„ç†æ‹¬å·å†…/å­—ç¬¦ä¸²å†…çš„é€—å·ï¼Œé¿å…è¯¯åˆ†å‰²ï¼‰
     */
    static splitFields(fieldsPart) {
        const <span class="hljs-attr">fields</span> = []<span class="hljs-comment">;</span>
        let <span class="hljs-attr">currentField</span> = <span class="hljs-string">''</span><span class="hljs-comment">;</span>
        let <span class="hljs-attr">bracketCount</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
        let <span class="hljs-attr">inQuote</span> = <span class="hljs-literal">false</span><span class="hljs-comment">; // æ ‡è®°æ˜¯å¦åœ¨å­—ç¬¦ä¸²å¼•å·å†…</span>

        for (const char of fieldsPart) {
            // å¤„ç†å•/åŒå¼•å·åˆ‡æ¢ï¼ˆå­—ç¬¦ä¸²å†…é€—å·ä¸åˆ†å‰²ï¼‰
            if (<span class="hljs-attr">char</span> === <span class="hljs-string">'"'</span> || char === <span class="hljs-string">"'"</span>) {
                <span class="hljs-attr">inQuote</span> = !inQuote<span class="hljs-comment">;</span>
                currentField += char<span class="hljs-comment">;</span>
                continue<span class="hljs-comment">;</span>
            }

            // ä»…å½“ï¼šä¸åœ¨å¼•å·å†… + æ‹¬å·è®¡æ•°ä¸º0 â†’ ç”¨é€—å·åˆ†å‰²å­—æ®µ
            if (<span class="hljs-attr">char</span> === <span class="hljs-string">','</span> &amp;&amp; !inQuote &amp;&amp; bracketCount === <span class="hljs-number">0</span>) {
                fields.push(currentField)<span class="hljs-comment">;</span>
                <span class="hljs-attr">currentField</span> = <span class="hljs-string">''</span><span class="hljs-comment">;</span>
                continue<span class="hljs-comment">;</span>
            }

            // æ›´æ–°æ‹¬å·è®¡æ•°ï¼ˆä»…å½“ä¸åœ¨å¼•å·å†…ï¼‰
            if (!inQuote) {
                if (<span class="hljs-attr">char</span> === <span class="hljs-string">'('</span>) bracketCount++<span class="hljs-comment">;</span>
                if (<span class="hljs-attr">char</span> === <span class="hljs-string">')'</span>) bracketCount = Math.max(<span class="hljs-number">0</span>, bracketCount - <span class="hljs-number">1</span>)<span class="hljs-comment">;</span>
            }

            currentField += char<span class="hljs-comment">;</span>
        }

        // æ·»åŠ æœ€åä¸€ä¸ªæœªåˆ†å‰²çš„å­—æ®µ
        if (currentField.trim()) fields.push(currentField.trim())<span class="hljs-comment">;</span>
        return fields<span class="hljs-comment">;</span>
    }

    /**
     * è§£æå•ä¸ªå­—æ®µä»¤ç‰Œï¼ˆæ ¸å¿ƒï¼šdata_fieldä¼˜å…ˆç”¨åˆ«åï¼‰
     */
static parseToFormattedField(token) {
    try {
        // ç§»é™¤å¼•å·ï¼ˆä¸æ”¹å˜åŸå§‹é€»è¾‘ï¼Œä»…æ¸…ç†æ ¼å¼ï¼‰
        const <span class="hljs-attr">cleanToken</span> = token
            .replace(/"(<span class="hljs-section">[^"]</span>+)"/g, '$1')  // ç§»é™¤å­—æ®µååŒå¼•å·ï¼ˆå¦‚ "No" â†’ Noï¼‰
            .replace(/'(<span class="hljs-section">[^']</span>+)'/g, '$1')  // ç§»é™¤å­—ç¬¦ä¸²å•å¼•å·ï¼ˆå¦‚ 'å…¥åº“å•' â†’ å…¥åº“å•ï¼‰
            .trim()<span class="hljs-comment">;</span>

        // 1. åŒºåˆ†ç‰©ç†å­—æ®µå’Œå­—ç¬¦ä¸²å¸¸é‡å­—æ®µ
        const <span class="hljs-attr">isStringConst</span> = !cleanToken.includes(<span class="hljs-string">'.'</span>) &amp;&amp; !cleanToken.includes(<span class="hljs-string">'('</span>) &amp;&amp; !cleanToken.includes(<span class="hljs-string">')'</span>) &amp;&amp; isNaN(cleanToken)<span class="hljs-comment">;</span>

        // 2. è§£æåˆ«åï¼ˆæ”¯æŒ AS åˆ«åã€ç©ºæ ¼åˆ«åï¼‰
        let fieldExpr, alias<span class="hljs-comment">;</span>
        const <span class="hljs-attr">asRegex</span> = /\s+as\s+/i<span class="hljs-comment">;</span>

        if (asRegex.test(cleanToken)) {
            // åœºæ™¯1ï¼šå¸¦ASçš„åˆ«åï¼ˆå¦‚ No AS å•å·ã€"ERP_Provider"."No" AS ä¾›åº”å•†ç¼–å·ï¼‰
            <span class="hljs-section">[fieldExpr, alias]</span> = cleanToken.split(asRegex).map(<span class="hljs-attr">item</span> =&gt; item.trim())<span class="hljs-comment">;</span>
        } else {
            // åœºæ™¯2ï¼šç©ºæ ¼åˆ†éš”çš„åˆ«åï¼ˆå¦‚ No å•å·ã€SUM(Amount) æ€»é‡‘é¢ï¼‰
            const <span class="hljs-attr">lastSpaceIndex</span> = cleanToken.lastIndexOf(<span class="hljs-string">' '</span>)<span class="hljs-comment">;</span>
            if (lastSpaceIndex &gt; -1) {
                const <span class="hljs-attr">potentialAlias</span> = cleanToken.substring(lastSpaceIndex + <span class="hljs-number">1</span>).trim()<span class="hljs-comment">;</span>
                // æ’é™¤åˆ«åå«æ‹¬å·/è¿ç®—ç¬¦çš„æƒ…å†µï¼ˆé¿å…è¯¯åˆ¤å‡½æ•°å†…ç©ºæ ¼ï¼‰
                if (!potentialAlias.includes('(') &amp;&amp; !potentialAlias.includes(')') &amp;&amp; !/<span class="hljs-section">[+\-*/=&lt;&gt;]</span>/.test(potentialAlias)) {
                    <span class="hljs-attr">fieldExpr</span> = cleanToken.substring(<span class="hljs-number">0</span>, lastSpaceIndex).trim()<span class="hljs-comment">;</span>
                    <span class="hljs-attr">alias</span> = potentialAlias<span class="hljs-comment">;</span>
                } else {
                    // æ— æœ‰æ•ˆåˆ«åï¼šå­—æ®µè¡¨è¾¾å¼=å®Œæ•´ä»¤ç‰Œï¼Œåˆ«åä¸ºç©º
                    <span class="hljs-attr">fieldExpr</span> = cleanToken<span class="hljs-comment">;</span>
                    <span class="hljs-attr">alias</span> = <span class="hljs-string">''</span><span class="hljs-comment">;</span>
                }
            } else {
                // åœºæ™¯3ï¼šæ— ç©ºæ ¼ï¼ˆæ— åˆ«åï¼Œå¦‚ Noã€'å…¥åº“å•'ã€SUM(Amount)ï¼‰
                <span class="hljs-attr">fieldExpr</span> = cleanToken<span class="hljs-comment">;</span>
                <span class="hljs-attr">alias</span> = <span class="hljs-string">''</span><span class="hljs-comment">;</span>
            }
        }

        // å˜é‡ï¼štableWithRealField â†’ ä¸“é—¨å­˜å‚¨â€œè¡¨å+è¯¥å­—æ®µçœŸå®åç§°â€ï¼ˆæœ‰åˆ«åæ—¶æœ‰æ•ˆï¼Œæ— åˆ«åæ—¶ä¸ºnullï¼‰
        let <span class="hljs-attr">tableWithRealField</span> = null<span class="hljs-comment">;</span>
        // ä»…å½“â€œæœ‰åˆ«åâ€ä¸”â€œæ˜¯ç‰©ç†å­—æ®µâ€æ—¶ï¼Œæ‰æå–è¡¨åå’ŒçœŸå®å­—æ®µå
        if (alias &amp;&amp; !isStringConst) {
            // ä» fieldExpr ä¸­æå–è¡¨åå’ŒçœŸå®å­—æ®µåï¼ˆå¤„ç†å‡½æ•°åŒ…è£¹åœºæ™¯ï¼Œå¦‚ SUM(ERP_Order.Amount) â†’ ERP_Order.Amountï¼‰
            let <span class="hljs-attr">realFieldExpr</span> = fieldExpr<span class="hljs-comment">;</span>
            const <span class="hljs-attr">funcMatch</span> = fieldExpr.match(/\(([^)]+)\)/)<span class="hljs-comment">;</span>
            if (funcMatch &amp;&amp; funcMatch<span class="hljs-section">[1]</span>) {
                <span class="hljs-attr">realFieldExpr</span> = funcMatch[<span class="hljs-number">1</span>].trim()<span class="hljs-comment">; // å»é™¤å‡½æ•°åŒ…è£¹ï¼ˆå¦‚ SUM(...) â†’ ...ï¼‰</span>
            }

            // åˆ†å‰²è¡¨åå’ŒçœŸå®å­—æ®µåï¼ˆå¦‚ ERP_Provider.No â†’ è¡¨å=ERP_Providerï¼ŒçœŸå®å­—æ®µå=Noï¼‰
            const <span class="hljs-attr">exprParts</span> = realFieldExpr.split(<span class="hljs-string">'.'</span>).filter(part =&gt; part.trim())<span class="hljs-comment">;</span>
            if (exprParts.length &gt;= 2) {
                const <span class="hljs-attr">tableName</span> = exprParts[<span class="hljs-number">0</span>].trim()<span class="hljs-comment">; // è¡¨å</span>
                const <span class="hljs-attr">realFieldName</span> = exprParts.slice(<span class="hljs-number">1</span>).join(<span class="hljs-string">'.'</span>).trim()<span class="hljs-comment">; // çœŸå®å­—æ®µåï¼ˆå…¼å®¹å­—æ®µåå«â€œ.â€çš„æç«¯åœºæ™¯ï¼‰</span>
                <span class="hljs-attr">tableWithRealField</span> = `<span class="hljs-variable">${tableName}</span>.<span class="hljs-variable">${realFieldName}</span>`<span class="hljs-comment">; // æ ¼å¼ï¼šè¡¨å.çœŸå®å­—æ®µå</span>
            }
        }

        // 3. æ ¸å¿ƒé€»è¾‘ï¼šdata_field ä¼˜å…ˆç”¨åˆ«åï¼Œæ— åˆ«åç”¨å®é™…å­—æ®µ
        let dataField<span class="hljs-comment">;</span>
        if (alias) {
            // æœ‰åˆ«å â†’ <span class="hljs-attr">data_field</span> = åˆ«å
            <span class="hljs-attr">dataField</span> = alias<span class="hljs-comment">;</span>
        } else {
            // æ— åˆ«å â†’ æŒ‰å­—æ®µç±»å‹å–å®é™…å€¼
            <span class="hljs-attr">dataField</span> = isStringConst
                ? fieldExpr  // å­—ç¬¦ä¸²å¸¸é‡â†’åŸå§‹å€¼ï¼ˆå¦‚ 'å…¥åº“å•' â†’ å…¥åº“å•ï¼‰
                : this.getPureFieldName(fieldExpr)<span class="hljs-comment">; // ç‰©ç†å­—æ®µâ†’å»å‰ç¼€ï¼ˆå¦‚ ERP_Provider.No â†’ Noï¼‰</span>
        }

        // 4. data_title ä¿æŒåŸé€»è¾‘ï¼ˆæ˜¾ç¤ºåç§°ï¼Œä¼˜å…ˆç”¨åˆ«åï¼‰
        const <span class="hljs-attr">dataTitle</span> = alias || this.extractSimpleName(fieldExpr)<span class="hljs-comment">;</span>

        // 5. æ¨æ–­æ•°æ®ç±»å‹å’Œæšä¸¾é€‰é¡¹
        const <span class="hljs-attr">dataType</span> = this.inferDataType(dataField, dataTitle, token)<span class="hljs-comment">;</span>
        const <span class="hljs-attr">enumOptions</span> = dataType === <span class="hljs-string">'enum'</span> ? this.extractEnumOptions(token) : []<span class="hljs-comment">;</span>

        return {
            data_title: dataTitle,    // æ˜¾ç¤ºåç§°ï¼ˆåŸé€»è¾‘ä¸å˜ï¼‰
            data_field: dataField,    // å­—æ®µæ ‡è¯†ï¼ˆåˆ«åä¼˜å…ˆï¼ï¼‰
            FormType: this.getFormTypeByDataType(dataType),
            enumOptions: enumOptions,
            search_data_field: fieldExpr,
            tableWithRealField: tableWithRealField // ä¸“é—¨å­˜å‚¨â€œè¡¨å+è¯¥å­—æ®µçœŸå®åç§°â€ï¼ˆæœ‰åˆ«åæ—¶æœ‰æ•ˆï¼‰
        }<span class="hljs-comment">;</span>
    } catch (error) {
        console.warn(`å­—æ®µè§£æå¤±è´¥ï¼Œè·³è¿‡ï¼š${token}`, error)<span class="hljs-comment">;</span>
        return null<span class="hljs-comment">;</span>
    }
}

    /**
     * ç‰©ç†å­—æ®µæå–çº¯å­—æ®µåï¼ˆæ— åˆ«åæ—¶ç”¨ï¼šå»é™¤è¡¨åå‰ç¼€ã€å‡½æ•°åŒ…è£¹ï¼‰
     */
    static getPureFieldName(fieldExpr) {
        // å¤„ç†å‡½æ•°åŒ…è£¹ï¼ˆå¦‚ SUM(ERP_StorageIn.Amount) â†’ ERP_StorageIn.Amountï¼‰
        const <span class="hljs-attr">funcMatch</span> = fieldExpr.match(/\(([^)]+)\)/)<span class="hljs-comment">;</span>
        if (funcMatch &amp;&amp; funcMatch<span class="hljs-section">[1]</span>) {
            <span class="hljs-attr">fieldExpr</span> = funcMatch[<span class="hljs-number">1</span>].trim()<span class="hljs-comment">;</span>
            // é€’å½’å¤„ç†åµŒå¥—å‡½æ•°ï¼ˆå¦‚ SUM(COALESCE(Amount, 0)) â†’ Amountï¼‰
            if (/\w+\(/.test(fieldExpr)) {
                return this.getPureFieldName(fieldExpr)<span class="hljs-comment">;</span>
            }
        }

        // å»é™¤è¡¨åå‰ç¼€ï¼ˆå¦‚ ERP_Provider.No â†’ noã€"ERP_StorageIn"."Amount" â†’ Amountï¼‰
        const <span class="hljs-attr">dotIndex</span> = fieldExpr.lastIndexOf(<span class="hljs-string">'.'</span>)<span class="hljs-comment">;</span>
        return dotIndex &gt; -1
            ? fieldExpr.substring(dotIndex + 1).trim()
            : fieldExpr.trim()<span class="hljs-comment">;</span>
    }

    /**
     * æå–ç®€å•åç§°ï¼ˆæ— åˆ«åæ—¶ç”¨äº data_titleï¼‰
     */
    static extractSimpleName(fieldExpr) {
        // å¤„ç†å‡½æ•°ï¼ˆå¦‚ SUM(Amount) â†’ Amountï¼‰
        const <span class="hljs-attr">funcMatch</span> = fieldExpr.match(/\(([^)]+)\)/)<span class="hljs-comment">;</span>
        if (funcMatch &amp;&amp; funcMatch<span class="hljs-section">[1]</span>) {
            <span class="hljs-attr">fieldExpr</span> = funcMatch[<span class="hljs-number">1</span>].trim()<span class="hljs-comment">;</span>
        }

        // å¤„ç†è¡¨åå‰ç¼€ï¼ˆå¦‚ ERP_Provider.No â†’ Noï¼‰
        const <span class="hljs-attr">dotIndex</span> = fieldExpr.lastIndexOf(<span class="hljs-string">'.'</span>)<span class="hljs-comment">;</span>
        if (dotIndex &gt; -1) {
            return fieldExpr.substring(dotIndex + 1).trim()<span class="hljs-comment">;</span>
        }

        return fieldExpr.trim()<span class="hljs-comment">;</span>
    }

    /**
     * ä»CASEè¯­å¥æå–æšä¸¾é€‰é¡¹
     */
    static extractEnumOptions(token) {
        const <span class="hljs-attr">options</span> = []<span class="hljs-comment">;</span>
        const <span class="hljs-attr">upperToken</span> = token.toUpperCase()<span class="hljs-comment">;</span>

        if (upperToken.includes('CASE') &amp;&amp; upperToken.includes('WHEN') &amp;&amp; upperToken.includes('THEN')) {
            const <span class="hljs-attr">caseStart</span> = upperToken.indexOf(<span class="hljs-string">'CASE'</span>)<span class="hljs-comment">;</span>
            const <span class="hljs-attr">caseEnd</span> = upperToken.indexOf(<span class="hljs-string">'END'</span>)<span class="hljs-comment">;</span>
            if (caseStart !== -1 &amp;&amp; caseEnd !== -1) {
                const <span class="hljs-attr">caseContent</span> = token.substring(caseStart + <span class="hljs-number">4</span>, caseEnd).trim()<span class="hljs-comment">;</span>
                const <span class="hljs-attr">whenParts</span> = caseContent.split(/WHEN/i).filter(part =&gt; part.trim())<span class="hljs-comment">;</span>

                for (const part of whenParts) {
                    const <span class="hljs-attr">thenIndex</span> = part.toUpperCase().indexOf(<span class="hljs-string">'THEN'</span>)<span class="hljs-comment">;</span>
                    if (thenIndex !== -1) {
                        const <span class="hljs-attr">optionText</span> = part.substring(thenIndex + <span class="hljs-number">4</span>).trim()
                            .replace(/<span class="hljs-section">['"]</span>/g, '')
                            .replace(/<span class="hljs-section">[,;]</span>/g, '')
                            .split(/\s+/)<span class="hljs-section">[0]</span><span class="hljs-comment">;</span>

                        if (optionText) options.push({ label: optionText, value: optionText })<span class="hljs-comment">;</span>
                    }
                }
            }
        }

        return options<span class="hljs-comment">;</span>
    }

    /**
     * æ¨æ–­æ•°æ®ç±»å‹
     */
    static inferDataType(fieldName, alias, originalToken) {
        const <span class="hljs-attr">upperField</span> = fieldName.toUpperCase()<span class="hljs-comment">;</span>
        const <span class="hljs-attr">upperAlias</span> = alias.toUpperCase()<span class="hljs-comment">;</span>
        const <span class="hljs-attr">upperToken</span> = originalToken.toUpperCase()<span class="hljs-comment">;</span>

        // CASEè¯­å¥â†’æšä¸¾
        if (upperToken.includes('CASE') &amp;&amp; upperToken.includes('WHEN') &amp;&amp; upperToken.includes('THEN')) {
            return 'select'<span class="hljs-comment">;</span>
        }

        // æ—¥æœŸç±»å‹
        const <span class="hljs-attr">dateKeys</span> = [<span class="hljs-string">'DATE'</span>, <span class="hljs-string">'TIME'</span>, <span class="hljs-string">'DAY'</span>, <span class="hljs-string">'MONTH'</span>, <span class="hljs-string">'YEAR'</span>, <span class="hljs-string">'æ—¥æœŸ'</span>, <span class="hljs-string">'æ—¶é—´'</span>, <span class="hljs-string">'å¤©'</span>]<span class="hljs-comment">;</span>
        const <span class="hljs-attr">dateFuncs</span> = [<span class="hljs-string">'DATE_PART'</span>, <span class="hljs-string">'CURRENT_DATE'</span>, <span class="hljs-string">'DATE_TRUNC'</span>, <span class="hljs-string">'CREATETIME'</span>]<span class="hljs-comment">;</span>
        if (dateFuncs.some(<span class="hljs-attr">f</span> =&gt; upperToken.includes(f)) || dateKeys.some(k =&gt; upperField.includes(k) || upperAlias.includes(k))) {
            return 'date'<span class="hljs-comment">;</span>
        }

        // æ•°å­—ç±»å‹
        const <span class="hljs-attr">numKeys</span> = [<span class="hljs-string">'NUM'</span>, <span class="hljs-string">'æ•°é‡'</span>, <span class="hljs-string">'é‡‘é¢'</span>, <span class="hljs-string">'å¤©æ•°'</span>, <span class="hljs-string">'INT'</span>,<span class="hljs-string">'DOUBLE'</span>,<span class="hljs-string">'å•ä»·'</span>,<span class="hljs-string">'åˆ†æ•°'</span>,<span class="hljs-string">'æ€»æ•°'</span>,<span class="hljs-string">'ä½™é¢'</span>,<span class="hljs-string">'ä»·æ ¼'</span>,<span class="hljs-string">'æˆæœ¬'</span>,<span class="hljs-string">'é‡é‡'</span>,<span class="hljs-string">'æŒ‡æ•°'</span>,<span class="hljs-string">'ç‡'</span>,<span class="hljs-string">'é¢'</span>]<span class="hljs-comment">;</span>
        const <span class="hljs-attr">numFuncs</span> = [<span class="hljs-string">'SUM'</span>, <span class="hljs-string">'COUNT'</span>, <span class="hljs-string">'AVG'</span>, <span class="hljs-string">'COALESCE'</span>]<span class="hljs-comment">;</span>
        if (numFuncs.some(<span class="hljs-attr">f</span> =&gt; upperToken.includes(f)) || /[+\-*/]/.test(upperToken) || numKeys.some(k =&gt; upperField.includes(k) || upperAlias.includes(k))) {
            return 'double'<span class="hljs-comment">;</span>
        }

        // æšä¸¾ç±»å‹
        const <span class="hljs-attr">enumKeys</span> = [<span class="hljs-string">'STATE'</span>, <span class="hljs-string">'TYPE'</span>, <span class="hljs-string">'çŠ¶æ€'</span>, <span class="hljs-string">'ç±»å‹'</span>,<span class="hljs-string">'enum'</span>,<span class="hljs-string">'ç­‰çº§'</span>,<span class="hljs-string">'ç§ç±»'</span>,<span class="hljs-string">'ç±»åˆ«'</span>,<span class="hljs-string">'çº§åˆ«'</span>,<span class="hljs-string">'ç­‰çº§'</span>,<span class="hljs-string">'æ€§åˆ«'</span>,<span class="hljs-string">'åˆ†ç±»'</span>]<span class="hljs-comment">;</span>
        if (enumKeys.some(<span class="hljs-attr">k</span> =&gt; upperField.includes(k) || upperAlias.includes(k))) {
            return 'select'<span class="hljs-comment">;</span>
        }

        // é»˜è®¤å­—ç¬¦ä¸²
        return 'string'<span class="hljs-comment">;</span>
    }

    /**
     * è·å–è¡¨å•ç»„ä»¶ç±»å‹
     */
    static getFormTypeByDataType(dataType) {
        const <span class="hljs-attr">typeMap</span> = {
            'date': 'date',
            'number': 'double',
            'double': 'double',
            'string': 'string',
            'enum': 'select',
            'select': 'select'
        }<span class="hljs-comment">;</span>
        return typeMap<span class="hljs-section">[dataType]</span> || 'string'<span class="hljs-comment">;</span>
    }

    /**
     * éªŒè¯SQLæœ‰æ•ˆæ€§
     */
    static isValidSql(sql) {
        const <span class="hljs-attr">upperSql</span> = sql.toUpperCase()<span class="hljs-comment">;</span>
        const <span class="hljs-attr">selectIndex</span> = upperSql.indexOf(<span class="hljs-string">'SELECT'</span>)<span class="hljs-comment">;</span>
        const <span class="hljs-attr">fromIndex</span> = upperSql.indexOf(<span class="hljs-string">'FROM'</span>)<span class="hljs-comment">;</span>
        // æ’é™¤SELECT * æ— å…·ä½“å­—æ®µçš„åœºæ™¯
        const <span class="hljs-attr">hasFields</span> = selectIndex + <span class="hljs-number">6</span> &lt; fromIndex &amp;&amp; sql.substring(selectIndex + <span class="hljs-number">6</span>, fromIndex).trim() !== <span class="hljs-string">'*'</span><span class="hljs-comment">;</span>
        return selectIndex !== -1 &amp;&amp; fromIndex !== -1 &amp;&amp; selectIndex &lt; fromIndex &amp;&amp; hasFields<span class="hljs-comment">;</span>
    }
}

export default SqlParser<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-4">ğŸš€ å¿«é€Ÿä½¿ç”¨ç¤ºä¾‹</h3>
<h4 data-id="heading-5">åŸºç¡€ä½¿ç”¨</h4>
<p>javascript</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-operator">/</span><span class="hljs-operator">/</span> æµ‹è¯•<span class="hljs-keyword">SQL</span>ï¼ˆåŒ…å«åˆ«åã€å‡½æ•°ã€è¡¨åˆ«åï¼‰
const testSql <span class="hljs-operator">=</span> `
  <span class="hljs-keyword">SELECT</span> 
    t.id <span class="hljs-keyword">AS</span> user_id, 
    t.name, 
    t.age, 
    <span class="hljs-built_in">MAX</span>(t.score) <span class="hljs-keyword">AS</span> max_score,
    t.address
  <span class="hljs-keyword">FROM</span> 
    user_info t
  <span class="hljs-keyword">WHERE</span> 
    t.age <span class="hljs-operator">&gt;</span> <span class="hljs-number">18</span>
  <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    t.id, t.name
`;

<span class="hljs-operator">/</span><span class="hljs-operator">/</span> ä¸€é”®è§£æ
const <span class="hljs-keyword">result</span> <span class="hljs-operator">=</span> SqlFieldParser.quickParse(testSql);

<span class="hljs-operator">/</span><span class="hljs-operator">/</span> è¾“å‡ºç»“æœ
console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'åŸå§‹å­—æ®µåˆ—è¡¨ï¼š'</span>, result.fields); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> ["t.id", "t.name", "t.age", "t.score", "t.address"]
console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'çº¯å­—æ®µåï¼š'</span>, result.pureFields); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> ["id", "name", "age", "score", "address"]
console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'å­—æ®µåˆ«åæ˜ å°„ï¼š'</span>, result.fieldAliasMap); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> { user_id: "t.id", max_score: "t.score" }
console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'æ¶‰åŠè¡¨åï¼š'</span>, result.tables); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> ["user_info"]
console.<span class="hljs-built_in">log</span>(<span class="hljs-string">'æ˜¯å¦æœ‰åµŒå¥—æŸ¥è¯¢ï¼š'</span>, result.hasNestedQuery); <span class="hljs-operator">/</span><span class="hljs-operator">/</span> <span class="hljs-literal">false</span>
</code></pre>
<h4 data-id="heading-6">è¾“å‡ºç»“æœè¯´æ˜</h4>








































<table><thead><tr><th>å­—æ®µ</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>fields</td><td>Array</td><td>åŸå§‹å­—æ®µåˆ—è¡¨ï¼ˆå«è¡¨åˆ«å / å‡½æ•°åŒ…è£¹å‰çš„å­—æ®µï¼‰</td></tr><tr><td>pureFields</td><td>Array</td><td>çº¯å­—æ®µåï¼ˆå‰”é™¤è¡¨åˆ«åã€å‡½æ•°ï¼Œä»…ä¿ç•™å­—æ®µæœ¬èº«ï¼‰</td></tr><tr><td>fieldAliasMap</td><td>Object</td><td>åˆ«åæ˜ å°„è¡¨ï¼ˆåˆ«å â†’ åŸå§‹å­—æ®µï¼‰</td></tr><tr><td>tables</td><td>Array</td><td>å»é‡åçš„è¡¨ååˆ—è¡¨</td></tr><tr><td>hasNestedQuery</td><td>Boolean</td><td>æ˜¯å¦åŒ…å«åµŒå¥—æŸ¥è¯¢</td></tr><tr><td>reverseAliasMap</td><td>Object</td><td>åå‘åˆ«åæ˜ å°„ï¼ˆåŸå§‹å­—æ®µ â†’ åˆ«åï¼‰</td></tr></tbody></table>
<h3 data-id="heading-7">ğŸ¨ é€‚ç”¨åœºæ™¯</h3>
<ol>
<li><strong>å¯è§†åŒ– SQL ç¼–è¾‘å™¨</strong>ï¼šè§£æç”¨æˆ·è¾“å…¥çš„ SQLï¼Œè‡ªåŠ¨æå–å­—æ®µç”¨äºè¡¨å• / è¡¨æ ¼æ¸²æŸ“</li>
<li><strong>ä½ä»£ç å¹³å°</strong>ï¼šè§£æé…ç½®çš„ SQL è¯­å¥ï¼Œå®ç°å­—æ®µæ˜ å°„ã€æ•°æ®é¢„è§ˆ</li>
<li><strong>æ•°æ®å¤§å± / æŠ¥è¡¨å·¥å…·</strong>ï¼šè‡ªåŠ¨è¯†åˆ« SQL ä¸­çš„ç»´åº¦ / æŒ‡æ ‡å­—æ®µï¼Œç®€åŒ–é…ç½®</li>
<li><strong>å‰ç«¯æ•°æ®æ ¡éªŒ</strong>ï¼šæ ¡éªŒ SQL ä¸­æ˜¯å¦åŒ…å«æŒ‡å®šå­—æ®µï¼Œé¿å…éæ³•æŸ¥è¯¢</li>
<li><strong>SQL æ ¼å¼åŒ–å·¥å…·</strong>ï¼šè¾…åŠ©æå–æ ¸å¿ƒä¿¡æ¯ï¼Œä¼˜åŒ–æ ¼å¼åŒ–æ•ˆæœ</li>
</ol>
<h3 data-id="heading-8">ğŸ“ˆ æ‰©å±•æ–¹å‘</h3>
<p>è¿™ä¸ªå·¥å…·ç±»æ˜¯åŸºç¡€ç‰ˆï¼Œæ»¡è¶³å¤§éƒ¨åˆ†å‰ç«¯åœºæ™¯éœ€æ±‚ï¼Œä½ å¯ä»¥æ ¹æ®ä¸šåŠ¡æ‰©å±•ï¼š</p>
<ol>
<li><strong>æ”¯æŒ JOIN è¡¨è§£æ</strong>ï¼šæ‰©å±•<code>parseTables</code>æ–¹æ³•ï¼Œè§£æ JOIN å­å¥ä¸­çš„å…³è”è¡¨</li>
<li><strong>é€’å½’è§£æåµŒå¥—æŸ¥è¯¢</strong>ï¼šå¯¹<code>(SELECT ...)</code>å½¢å¼çš„å­æŸ¥è¯¢åšé€’å½’è§£æ</li>
<li><strong>æ”¯æŒ INSERT/UPDATE è¯­æ³•</strong>ï¼šæ–°å¢<code>parseInsertFields</code>/<code>parseUpdateFields</code>æ–¹æ³•</li>
<li><strong>è¯­æ³•é”™è¯¯æç¤º</strong>ï¼šå¢åŠ  SQL è¯­æ³•åˆæ³•æ€§æ ¡éªŒï¼Œè¿”å›é”™è¯¯ä½ç½®</li>
<li><strong>ç»“åˆä¸“ä¸šè§£æåº“</strong>ï¼šå¦‚éœ€æ›´ç²¾å‡†çš„è¯­æ³•åˆ†æï¼Œå¯é›†æˆ<code>sql-parser</code>ç­‰åº“å¢å¼ºèƒ½åŠ›</li>
</ol>
<h3 data-id="heading-9">ğŸ’¡ æ ¸å¿ƒè®¾è®¡æ€è·¯</h3>
<ol>
<li><strong>é¢„å¤„ç†ä¼˜å…ˆ</strong>ï¼šå…ˆæ¸…ç†æ³¨é‡Šã€ç»Ÿä¸€æ ¼å¼ï¼Œé¿å…å›  SQL å†™æ³•ä¸è§„èŒƒå¯¼è‡´è§£æå¤±è´¥</li>
<li><strong>æ­£åˆ™ç²¾å‡†åŒ¹é…</strong>ï¼šé’ˆå¯¹ SELECT/FROM æ ¸å¿ƒå­å¥è®¾è®¡ä¸“å±æ­£åˆ™ï¼Œå…¼é¡¾å…¼å®¹æ€§å’Œæ€§èƒ½</li>
<li><strong>åˆ†å±‚è§£æ</strong>ï¼šå…ˆæå–æ ¸å¿ƒç‰‡æ®µï¼Œå†æ‹†åˆ†å­—æ®µ / è¡¨åï¼Œé™ä½è§£æå¤æ‚åº¦</li>
<li><strong>è½»é‡ä¼˜å…ˆ</strong>ï¼šå‰ç«¯åœºæ™¯ä¸‹ï¼Œé¿å…å¼•å…¥é‡é‡çº§è§£æåº“ï¼Œç”¨åŸç”Ÿ JS å®ç°æ ¸å¿ƒèƒ½åŠ›</li>
</ol>
<h3 data-id="heading-10">ğŸ¯ å…¼å®¹æ€§è¯´æ˜</h3>
<p>âœ… æ”¯æŒçš„ SQL è¯­æ³•ï¼š</p>
<ul>
<li>åŸºç¡€ SELECT æŸ¥è¯¢ï¼ˆå« DISTINCT/TOP å…³é”®å­—ï¼‰</li>
<li>å­—æ®µåˆ«åï¼ˆAS åˆ«å / ç›´æ¥åˆ«åï¼‰</li>
<li>è¡¨åˆ«åï¼ˆå¦‚Â <code>user_info t</code>ï¼‰</li>
<li>å‡½æ•°åŒ…è£¹å­—æ®µï¼ˆMAX/COUNT/CONCAT ç­‰ï¼‰</li>
<li>å¤šè¡¨æŸ¥è¯¢ï¼ˆFROM åå¤šè¡¨é€—å·åˆ†éš”ï¼‰</li>
<li>å« WHERE/GROUP BY/ORDER BY çš„å¤æ‚æŸ¥è¯¢</li>
</ul>
<p>âŒ æš‚ä¸æ”¯æŒï¼ˆå¯æ‰©å±•ï¼‰ï¼š</p>
<ul>
<li>å¤æ‚åµŒå¥—å­æŸ¥è¯¢çš„æ·±åº¦è§£æ</li>
<li>INSERT/UPDATE/DELETE è¯­å¥è§£æ</li>
<li>éå¸¸è§„ SQL è¯­æ³•ï¼ˆå¦‚å­˜å‚¨è¿‡ç¨‹ã€è‡ªå®šä¹‰å‡½æ•°ï¼‰</li>
</ul>
<h3 data-id="heading-11">ğŸ“ æ€»ç»“</h3>
<p>è¿™ä¸ªå·¥å…·ç±»çš„æ ¸å¿ƒä»·å€¼åœ¨äº<strong>å‰ç«¯è‡ªä¸»è§£æ SQL</strong>ï¼Œæ‘†è„±å¯¹åç«¯çš„ä¾èµ–ï¼Œæå‡äº¤äº’ä½“éªŒã€‚ä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºæ‰©å±•ï¼Œé€‚åˆä½œä¸ºå‰ç«¯ SQL è§£æçš„åŸºç¡€ç»„ä»¶ã€‚</p>
<p>å¦‚æœä½ æœ‰ç±»ä¼¼çš„ä¸šåŠ¡åœºæ™¯ï¼Œç›´æ¥å¤åˆ¶ä»£ç å°±èƒ½ç”¨ï¼Œä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ‰©å±•åŠŸèƒ½ã€‚å¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œæ¬¢è¿ç‚¹èµæ”¶è—ï¼Œä¹Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµæ›´å¤šæ‰©å±•æ€è·¯ï½</p>
<blockquote>
<p>å®Œæ•´ä»£ç å·²æ•´ç†å¥½ï¼Œå¯ç›´æ¥å¤åˆ¶åˆ°é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œå»ºè®®æ ¹æ®å®é™…ä¸šåŠ¡åœºæ™¯åšä¸ªæ€§åŒ–è°ƒæ•´ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[HarmonyOSåº”ç”¨å¼€å‘ä¹‹ç€‘å¸ƒæµã€ä¸Šæ‹‰åŠ è½½ã€æ— é™æ»šåŠ¨ä¸€æ–‡æå®š]]></title>    <link>https://juejin.cn/post/7585377128490057780</link>    <guid>https://juejin.cn/post/7585377128490057780</guid>    <pubDate>2025-12-19T10:15:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585377128490057780" data-draft-id="7585206349749403700" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="HarmonyOSåº”ç”¨å¼€å‘ä¹‹ç€‘å¸ƒæµã€ä¸Šæ‹‰åŠ è½½ã€æ— é™æ»šåŠ¨ä¸€æ–‡æå®š"/> <meta itemprop="keywords" content="HarmonyOS"/> <meta itemprop="datePublished" content="2025-12-19T10:15:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·595143322177"/> <meta itemprop="url" content="https://juejin.cn/user/2359987827640909"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            HarmonyOSåº”ç”¨å¼€å‘ä¹‹ç€‘å¸ƒæµã€ä¸Šæ‹‰åŠ è½½ã€æ— é™æ»šåŠ¨ä¸€æ–‡æå®š
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2359987827640909/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·595143322177
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T10:15:21.000Z" title="Fri Dec 19 2025 10:15:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç€‘å¸ƒæµï¼ˆWaterFlowï¼‰</h2>
<p>ç€‘å¸ƒæµå¸¸ç”¨äºå±•ç¤ºå›¾ç‰‡ä¿¡æ¯ï¼Œå°¤å…¶åœ¨è´­ç‰©å’Œèµ„è®¯ç±»åº”ç”¨ä¸­ã€‚<code>ArkUI</code>æä¾›äº†<code>WaterFlow</code>å®¹å™¨ç»„ä»¶ï¼Œç”¨äºæ„å»ºç€‘å¸ƒæµå¸ƒå±€ã€‚<code>WaterFlow</code>ç»„ä»¶æ”¯æŒæ¡ä»¶æ¸²æŸ“ã€å¾ªç¯æ¸²æŸ“å’Œæ‡’åŠ è½½ç­‰æ–¹å¼ç”Ÿæˆå­ç»„ä»¶ã€‚</p>
<p>ç€‘å¸ƒæµæ”¯æŒæ¨ªå‘å’Œçºµå‘å¸ƒå±€ã€‚</p>
<ul>
<li>åœ¨çºµå‘å¸ƒå±€ä¸­ï¼Œå¯ä»¥é€šè¿‡<code>columnsTemplate</code>è®¾ç½®åˆ—æ•°ã€‚</li>
<li>åœ¨æ¨ªå‘å¸ƒå±€ä¸­ï¼Œå¯ä»¥é€šè¿‡<code>rowsTemplate</code>è®¾ç½®è¡Œæ•°ã€‚</li>
</ul>
<p>åœ¨ç€‘å¸ƒæµçš„çºµå‘å¸ƒå±€ä¸­ï¼Œç¬¬ä¸€è¡Œçš„å­èŠ‚ç‚¹æŒ‰ä»å·¦åˆ°å³é¡ºåºæ’åˆ—ï¼Œä»ç¬¬äºŒè¡Œå¼€å§‹ï¼Œæ¯ä¸ªå­èŠ‚ç‚¹å°†æ”¾ç½®åœ¨å½“å‰æ€»é«˜åº¦æœ€å°çš„åˆ—ã€‚å¦‚æœå¤šä¸ªåˆ—çš„æ€»é«˜åº¦ç›¸åŒï¼Œåˆ™æŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºå¡«å……ã€‚å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/050d3daeb4244077abdaff167628ad4b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTk1MTQzMzIyMTc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766744121&amp;x-signature=LW4qS%2BNLUOZmdxPpLsy2XBA5Pb0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>åœ¨ç€‘å¸ƒæµçš„æ¨ªå‘å¸ƒå±€ä¸­ï¼Œæ¯ä¸ªå­èŠ‚ç‚¹éƒ½ä¼šæ”¾ç½®åœ¨å½“å‰æ€»å®½åº¦æœ€å°çš„è¡Œã€‚è‹¥å¤šè¡Œæ€»å®½åº¦ç›¸åŒï¼Œåˆ™æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹çš„é¡ºåºè¿›è¡Œå¡«å……ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e4815dd1960c420e8d017ea913f1ea37~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTk1MTQzMzIyMTc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766744121&amp;x-signature=xBrHZBLwvwjTpUHEtXm9t5oF95s%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-1">åŸºæœ¬ä½¿ç”¨</h3>
<p>ç€‘å¸ƒæµå¸¸ç”¨äºæ— é™æ»šåŠ¨çš„ä¿¡æ¯æµã€‚å¯ä»¥åœ¨ç€‘å¸ƒæµç»„ä»¶åˆ°è¾¾æœ«å°¾ä½ç½®æ—¶è§¦å‘çš„<code>onReachEnd</code>äº‹ä»¶å›è°ƒï¼Œé…åˆ<code>LazyForEach</code>å¢åŠ æ–°æ•°æ®ï¼Œå¹¶å°†<code>footer</code>åšæˆæ­£åœ¨åŠ è½½æ–°æ•°æ®çš„æ ·å¼ã€‚</p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤º</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c88a2c0c0b9a4d12a0eb4e6918cdaffb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTk1MTQzMzIyMTc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766744121&amp;x-signature=ngapP9JKwf52hlRF9VVdYGwH6kA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>æ¥ä¸‹æ¥ï¼ŒæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å®ç°ä¸Šå›¾çš„æ•ˆæœã€‚</p>
<h4 data-id="heading-2">å‡†å¤‡æ•°æ®æº</h4>
<p>éœ€è¦ä½¿ç”¨<code>LazyForEach</code>æ¸²æŸ“å­ç»„ä»¶æ—¶ï¼Œæ•°æ®æºå¿…é¡»æ˜¯<code>IDataSource</code>çš„å®ç°ç±»ã€‚åˆ›å»º<code>WaterFlowDataSource.ets</code>ï¼Œç”¨äºç»™<code>WaterFlow</code>ç€‘å¸ƒæµç»„ä»¶åŠ è½½æ•°æ®ã€‚</p>
<p>åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–<code>100</code>æ¡æ•°æ®ï¼Œå¹¶æä¾›è·å–æ•°æ®ã€ä¿®æ”¹æ•°æ®ã€æ·»åŠ æ•°æ®ã€åˆ é™¤æ•°æ®ã€è·å–æ•°æ®æ€»æ•°æ®ç­‰å‡½æ•°ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// WaterFlowDataSource.ets</span>

<span class="hljs-comment">// å®ç°IDataSourceæ¥å£çš„å¯¹è±¡ï¼Œç”¨äºç€‘å¸ƒæµç»„ä»¶åŠ è½½æ•°æ®</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WaterFlowDataSource</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IDataSource</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">dataArray</span>: <span class="hljs-built_in">number</span>[] = [];
  <span class="hljs-keyword">private</span> <span class="hljs-attr">listeners</span>: <span class="hljs-title class_">DataChangeListener</span>[] = [];

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">push</span>(i);
    }
  }

  <span class="hljs-comment">// è·å–ç´¢å¼•å¯¹åº”çš„æ•°æ®</span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">getData</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>[index];
  }

  <span class="hljs-comment">// é€šçŸ¥æ§åˆ¶å™¨æ•°æ®é‡æ–°åŠ è½½</span>
  <span class="hljs-title function_">notifyDataReload</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> {
      listener.<span class="hljs-title function_">onDataReloaded</span>();
    })
  }

  <span class="hljs-comment">// é€šçŸ¥æ§åˆ¶å™¨æ•°æ®å¢åŠ </span>
  <span class="hljs-title function_">notifyDataAdd</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> {
      listener.<span class="hljs-title function_">onDataAdd</span>(index);
    })
  }

  <span class="hljs-comment">// é€šçŸ¥æ§åˆ¶å™¨æ•°æ®å˜åŒ–</span>
  <span class="hljs-title function_">notifyDataChange</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> {
      listener.<span class="hljs-title function_">onDataChange</span>(index);
    })
  }

  <span class="hljs-comment">// é€šçŸ¥æ§åˆ¶å™¨æ•°æ®åˆ é™¤</span>
  <span class="hljs-title function_">notifyDataDelete</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> {
      listener.<span class="hljs-title function_">onDataDelete</span>(index);
    })
  }

  <span class="hljs-comment">// é€šçŸ¥æ§åˆ¶å™¨æ•°æ®ä½ç½®å˜åŒ–</span>
  <span class="hljs-title function_">notifyDataMove</span>(<span class="hljs-attr">from</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">to</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> {
      listener.<span class="hljs-title function_">onDataMove</span>(<span class="hljs-keyword">from</span>, to);
    })
  }

  <span class="hljs-comment">//é€šçŸ¥æ§åˆ¶å™¨æ•°æ®æ‰¹é‡ä¿®æ”¹</span>
  <span class="hljs-title function_">notifyDatasetChange</span>(<span class="hljs-attr">operations</span>: <span class="hljs-title class_">DataOperation</span>[]): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> {
      listener.<span class="hljs-title function_">onDatasetChange</span>(operations);
    })
  }

  <span class="hljs-comment">// è·å–æ•°æ®æ€»æ•°</span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">totalCount</span>(): <span class="hljs-built_in">number</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span>;
  }

  <span class="hljs-comment">// æ³¨å†Œæ”¹å˜æ•°æ®çš„æ§åˆ¶å™¨</span>
  <span class="hljs-title function_">registerDataChangeListener</span>(<span class="hljs-attr">listener</span>: <span class="hljs-title class_">DataChangeListener</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">indexOf</span>(listener) &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">push</span>(listener);
    }
  }

  <span class="hljs-comment">// æ³¨é”€æ”¹å˜æ•°æ®çš„æ§åˆ¶å™¨</span>
  <span class="hljs-title function_">unregisterDataChangeListener</span>(<span class="hljs-attr">listener</span>: <span class="hljs-title class_">DataChangeListener</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">const</span> pos = <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">indexOf</span>(listener);
    <span class="hljs-keyword">if</span> (pos &gt;= <span class="hljs-number">0</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">splice</span>(pos, <span class="hljs-number">1</span>);
    }
  }

  <span class="hljs-comment">// å¢åŠ æ•°æ®</span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">add1stItem</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataAdd</span>(<span class="hljs-number">0</span>);
  }

  <span class="hljs-comment">// åœ¨æ•°æ®å°¾éƒ¨å¢åŠ ä¸€ä¸ªå…ƒç´ </span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">addLastItem</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span>, <span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataAdd</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>);
  }

  <span class="hljs-comment">// åœ¨æŒ‡å®šç´¢å¼•ä½ç½®å¢åŠ ä¸€ä¸ªå…ƒç´ </span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">addItem</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataAdd</span>(index);
  }

  <span class="hljs-comment">// åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ </span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">delete1stItem</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataDelete</span>(<span class="hljs-number">0</span>);
  }

  <span class="hljs-comment">// åˆ é™¤ç¬¬äºŒä¸ªå…ƒç´ </span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">delete2ndItem</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataDelete</span>(<span class="hljs-number">1</span>);
  }

  <span class="hljs-comment">// åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ </span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">deleteLastItem</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataDelete</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span>);
  }

  <span class="hljs-comment">// åœ¨æŒ‡å®šç´¢å¼•ä½ç½®åˆ é™¤ä¸€ä¸ªå…ƒç´ </span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">deleteItem</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataDelete</span>(index);
  }

  <span class="hljs-comment">// é‡æ–°åŠ è½½æ•°æ®</span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">reload</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataReload</span>();
  }

  <span class="hljs-comment">// åœ¨æ•°æ®å°¾éƒ¨å¢åŠ countä¸ªå…ƒç´ </span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">addNewItems</span>(<span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">let</span> len = <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>[len - <span class="hljs-number">1</span>] + i + <span class="hljs-number">1</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataAdd</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>);
    }
  }

  <span class="hljs-comment">// åˆ·æ–°æ‰€æœ‰å…ƒç´ </span>
  <span class="hljs-keyword">public</span> <span class="hljs-title function_">refreshItems</span>(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">let</span> <span class="hljs-attr">newDataArray</span>: <span class="hljs-built_in">number</span>[] = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
      newDataArray.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>[<span class="hljs-number">0</span>] + i + <span class="hljs-number">1000</span>);
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span> = newDataArray;
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataReload</span>();
  }
}
</code></pre>
<h4 data-id="heading-3">ä½¿ç”¨LazyForEachå¾ªç¯æ¸²æŸ“</h4>
<p>ä¸ºäº†ä½¿<code>WaterFlow</code>çš„æ¯ä¸€ä¸ª<code>FlowItem</code>å°ºå¯¸ä¸åŒï¼Œä»¥è¾¾åˆ°äº¤é”™çš„æ•ˆæœï¼Œé‡‡ç”¨éšæœºæ•°ç”Ÿæˆ<code>[80,180)</code>çš„å®½é«˜å¹¶ä½¿ç”¨<code>itemWidthArray</code>å’Œ<code>itemHeightArray</code>ä¿å­˜ã€‚</p>
<p>å…·ä½“ä»£ç å¦‚ä¸‹</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">WaterFlowDataSource</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../datasource/WaterFlowDataScource'</span>;

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">Index</span> {
  <span class="hljs-comment">//ç€‘å¸ƒæµçš„æ•°æ®æº</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">dataSource</span>: <span class="hljs-title class_">WaterFlowDataSource</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WaterFlowDataSource</span>();
  <span class="hljs-comment">//æ¯ä¸€ä¸ªFlowItemçš„é«˜åº¦</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemWidthArray</span>: <span class="hljs-built_in">number</span>[] = [];
  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemHeightArray</span>: <span class="hljs-built_in">number</span>[] = [];

  <span class="hljs-comment">// è®¡ç®—FlowItemå®½/é«˜</span>
  <span class="hljs-title function_">getSize</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">let</span> ret = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">180</span>);
    <span class="hljs-keyword">return</span> (ret &gt; <span class="hljs-number">80</span> ? ret : <span class="hljs-number">80</span>);
  }

  <span class="hljs-comment">// è®¾ç½®FlowItemçš„å®½/é«˜æ•°ç»„</span>
  <span class="hljs-title function_">setItemSizeArray</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemWidthArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());
    }
  }
  
  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setItemSizeArray</span>();
  }

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">WaterFlow</span>() {
        <span class="hljs-title class_">LazyForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
          <span class="hljs-title class_">FlowItem</span>() {
            <span class="hljs-title class_">Column</span>() {
              <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${item}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>).<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
            }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
            .<span class="hljs-title function_">height</span>(<span class="hljs-string">"100%"</span>)
            .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)
            .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
          }
          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>[index])
        })
      }.<span class="hljs-title function_">columnsTemplate</span>(<span class="hljs-string">"1fr 1fr"</span>)
      .<span class="hljs-title function_">columnsGap</span>(<span class="hljs-number">10</span>)
      .<span class="hljs-title function_">rowsGap</span>(<span class="hljs-number">10</span>)
      .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)
    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">"100%"</span>)
    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">"#9ACEED"</span>)
  }
}

</code></pre>
<h3 data-id="heading-4">ä¸Šæ‹‰åŠ è½½</h3>
<h4 data-id="heading-5">æ·»åŠ å°¾éƒ¨ç»„ä»¶</h4>
<p>åœ¨åˆ›å»º<code>WaterFlow</code>æ—¶ï¼Œé€šè¿‡<code>footer</code>å‚æ•°è®¾ç½®å°¾éƒ¨ç»„ä»¶ï¼Œå½“ä¸Šæ‹‰åˆ°åº•éƒ¨æ—¶æ˜¾ç¤ºã€‚</p>
<p>ç”±äºåŠ è½½æ•°æ®éœ€è¦æ—¶é—´ï¼Œåœ¨åŠ è½½æ—¶éœ€è¦ç»™ç”¨æˆ·è§†è§‰ä¸Šçš„åé¦ˆã€‚æˆ‘ä»¬ç»™åŠ è½½å°¾éƒ¨ç»„ä»¶å®šä¹‰2ç§çŠ¶æ€<code>Lading</code>å’Œ<code>End</code>è¡¨ç¤ºåŠ è½½ä¸­å’Œåˆ°åº•äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2be047adc1b402e81f572a83be87a18~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTk1MTQzMzIyMTc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766744121&amp;x-signature=dxgSxWqFZl897gbfMxcAv8oeCd0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// Index.ets</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">WaterFlowDataSource</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./WaterFlowDataSource'</span>;

<span class="hljs-comment">//å°¾éƒ¨ç»„ä»¶çŠ¶æ€</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title class_">FooterState</span> {
  <span class="hljs-title class_">Loading</span> = <span class="hljs-number">0</span>,
  <span class="hljs-title class_">End</span> = <span class="hljs-number">1</span>
}

<span class="hljs-comment">//å°¾éƒ¨ç»„ä»¶</span>
<span class="hljs-meta">@Builder</span>
<span class="hljs-title function_">itemFooter</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ä¸è¦ç›´æ¥ç”¨IfElseèŠ‚ç‚¹ä½œä¸ºfooterçš„æ ¹èŠ‚ç‚¹ã€‚</span>
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">footerState</span> == <span class="hljs-title class_">FooterState</span>.<span class="hljs-property">Loading</span>) {
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`åŠ è½½ä¸­...`</span>)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">10</span>)
          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>)
          .<span class="hljs-title function_">width</span>(<span class="hljs-number">50</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)
          .<span class="hljs-title function_">align</span>(<span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Center</span>)
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">2</span> })
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">footerState</span> == <span class="hljs-title class_">FooterState</span>.<span class="hljs-property">End</span>) {
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`åˆ°åº•å•¦...`</span>)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">10</span>)
          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>)
          .<span class="hljs-title function_">width</span>(<span class="hljs-number">50</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)
          .<span class="hljs-title function_">align</span>(<span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Center</span>)
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">2</span> })
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Footer`</span>)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">10</span>)
          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>)
          .<span class="hljs-title function_">width</span>(<span class="hljs-number">50</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)
          .<span class="hljs-title function_">align</span>(<span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Center</span>)
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">2</span> })
      }
    }
}
</code></pre>
<p>å°†<code>itemFooter</code>ç»‘å®šä¸ª<code>WaterFlow</code></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title class_">WaterFlow</span>({
  <span class="hljs-attr">footer</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">itemFooter</span>()
}){
    <span class="hljs-comment">//...</span>
}
</code></pre>
<h4 data-id="heading-6">æ·»åŠ å°¾éƒ¨ç›‘å¬</h4>
<p>ç»™<code>WaterFlow</code>è®¾ç½®å°¾éƒ¨ç›‘å¬çš„å›è°ƒï¼Œ<code>onReachEnd(event: () =&gt; void)</code> ç€‘å¸ƒæµå†…å®¹åˆ°è¾¾æœ«å°¾ä½ç½®æ—¶è§¦å‘ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title class_">WaterFlow</span>({
  <span class="hljs-attr">footer</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">itemFooter</span>()
}){
    <span class="hljs-comment">//...</span>
}
<span class="hljs-comment">// è§¦åº•åŠ è½½æ•°æ®</span>
.<span class="hljs-title function_">onReachEnd</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">//æ¯æ¬¡åˆ°åˆ°åº•éƒ¨ï¼Œæ£€æŸ¥æ˜¯å¦è¿˜æœ‰æ•°æ®å¯åŠ è½½ï¼ˆè¿™é‡Œæ¨¡æ‹Ÿåˆ°è¾¾200æ¡æ•°æ®æ—¶ï¼Œæ— æ•°æ®å¯åŠ è½½ï¼‰</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">totalCount</span>() &gt;= <span class="hljs-number">200</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">footerState</span> = <span class="hljs-title class_">FooterState</span>.<span class="hljs-property">End</span>
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">//2såï¼Œæ·»åŠ 100æ¡æ•°æ®</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">addLastItem</span>()
    }
    }, <span class="hljs-number">2000</span>)
})
</code></pre>
<p>æ­¤æ—¶æµ‹è¯•æ»‘åˆ°åº•éƒ¨æ—¶ï¼ŒåŠ è½½<code>100</code>æ¡æ•°æ®ï¼Œ<code>2</code>ç§’åæ›´æ–°åˆ—è¡¨æ•°æ®ã€‚</p>
<h4 data-id="heading-7">æå‰åŠ è½½æ•°æ®</h4>
<p>è™½ç„¶åœ¨<code>onReachEnd()</code>è§¦å‘æ—¶åŠ è½½æ•°æ®å¯ä»¥å®ç°æ— é™åŠ è½½ï¼Œä½†åœ¨æ»‘åŠ¨åˆ°åº•éƒ¨ä¼šå‡ºç°æ˜æ˜¾çš„åœé¡¿ã€‚</p>
<p>ä¸ºäº†å®ç°æ›´åŠ æµç•…çš„æ— é™æ»‘åŠ¨ï¼Œéœ€è¦è°ƒæ•´å¢åŠ æ–°æ•°æ®çš„æ—¶æœºã€‚æ¯”å¦‚å¯ä»¥åœ¨<code>LazyForEach</code>è¿˜å‰©ä½™è‹¥å¹²ä¸ªæ•°æ®æœªéå†çš„æƒ…å†µä¸‹æå‰åŠ è½½æ–°æ•°æ®ã€‚</p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨è§¦åº•å‰20æ¡æ—¶å¼€å§‹åŠ è½½æ•°æ®</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f2a5c3c11854eb59e7d197059523437~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NTk1MTQzMzIyMTc3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766744121&amp;x-signature=%2BHGa0C5rShxS%2BuVGxpxgZa6x11k%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ä»£ç å¦‚ä¸‹</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title class_">WaterFlow</span>({
  <span class="hljs-attr">footer</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">itemFooter</span>()
}){
    <span class="hljs-comment">//...</span>
}
<span class="hljs-comment">//æå‰20æ¡åŠ è½½æ•°æ®</span>
.<span class="hljs-title function_">onScrollIndex</span>(<span class="hljs-function">(<span class="hljs-params">first: <span class="hljs-built_in">number</span>, last: <span class="hljs-built_in">number</span></span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (last + <span class="hljs-number">20</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">totalCount</span>()) {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">addNewItems</span>(<span class="hljs-number">100</span>);
    }, <span class="hljs-number">1000</span>);
  }
})
</code></pre>
<p>å¯¹é¸¿è’™æ„Ÿå…´è¶£çš„åŒå­¦ï¼Œå…è´¹è€ƒå–<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.huawei.com%2Fconsumer%2Fcn%2Ftraining%2FclassDetail%2Fcd630ebdc1c444b4b4ff10ae385eeac2%3Ftype%3D1" target="_blank" title="https://developer.huawei.com/consumer/cn/training/classDetail/cd630ebdc1c444b4b4ff10ae385eeac2?type=1" ref="nofollow noopener noreferrer">é¸¿è’™å¼€å‘è€…è®¤è¯</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ¬¾æ–¹ä¾¿Javaå¼€å‘è€…åœ¨IDEAä¸­æŠ“åŒ…åˆ†æè°ƒè¯•æ¥å£çš„æ’ä»¶]]></title>    <link>https://juejin.cn/post/7585214391828742187</link>    <guid>https://juejin.cn/post/7585214391828742187</guid>    <pubDate>2025-12-19T10:29:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585214391828742187" data-draft-id="7585171571130056740" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ¬¾æ–¹ä¾¿Javaå¼€å‘è€…åœ¨IDEAä¸­æŠ“åŒ…åˆ†æè°ƒè¯•æ¥å£çš„æ’ä»¶"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-19T10:29:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å´å°±ä¸š"/> <meta itemprop="url" content="https://juejin.cn/user/4406498334879934"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ¬¾æ–¹ä¾¿Javaå¼€å‘è€…åœ¨IDEAä¸­æŠ“åŒ…åˆ†æè°ƒè¯•æ¥å£çš„æ’ä»¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4406498334879934/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å´å°±ä¸š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T10:29:03.000Z" title="Fri Dec 19 2025 10:29:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>é¡¹ç›®æºç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fchattcp%2Fchattcp-idea-plugin" target="_blank" title="https://github.com/chattcp/chattcp-idea-plugin" ref="nofollow noopener noreferrer">github.com/chattcp/chaâ€¦</a><br/>
æ’ä»¶å®‰è£…ä½¿ç”¨æ•™ç¨‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fchattcp.com%2Fdownload%2Fintellij-plugin" target="_blank" title="https://chattcp.com/download/intellij-plugin" ref="nofollow noopener noreferrer">chattcp.com/download/inâ€¦</a></p>
<p>åŠŸèƒ½ç‰¹æ€§ï¼š<br/>
ğŸ” åœ¨IntelliJ IDEAä¸­å®æ—¶æ•è·å’ŒæŸ¥çœ‹TCPæ•°æ®åŒ…<br/>
ğŸ’¬ èŠå¤©å¼æ•°æ®åŒ…å±•ç¤ºï¼ˆå®¢æˆ·ç«¯/æœåŠ¡å™¨å¯¹è¯ï¼‰<br/>
ğŸ”Œ æ”¯æŒæ•°æ®åŒ…HTTP/WebSocketåè®®è§£ç <br/>
ğŸ“¥ å¯¼å‡ºæ•è·çš„æ•°æ®åŒ…ä¸ºPCAPæ–‡ä»¶ï¼Œä¾¿äºè¿›ä¸€æ­¥ä½¿ç”¨Wireshark/ChatTCPç­‰å·¥å…·åˆ†æ</p>
<p>é¢„è§ˆ:<br/>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fcamo.githubusercontent.com%2Ff3426c33a6eb1768a611f8bd64600f277cec032c3500cdc3ea69c9e7d9bb4289%2F68747470733a2f2f636861747463702e636f6d2f696d616765732f646f776e6c6f61642f636861747463702d666f722d696465612e77656270" target="_blank" title="https://camo.githubusercontent.com/f3426c33a6eb1768a611f8bd64600f277cec032c3500cdc3ea69c9e7d9bb4289/68747470733a2f2f636861747463702e636f6d2f696d616765732f646f776e6c6f61642f636861747463702d666f722d696465612e77656270" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/538d70dfaca6403fb55adc92f260253d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZC05bCx5Lia:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766744942&amp;x-signature=5XWmyB%2BIPjPPsfuJzFTXiO88Xe8%3D" alt="ChatTCPçš„IntelliJ IDEAæ’ä»¶" loading="lazy"/></a></p>
<p>å·¥å…·éå¸¸æœ‰åŠ©äºå¹³æ—¶å¼€å‘æ¥å£è°ƒè¯•ï¼Œèƒ½å¤Ÿç›´æ¥ä»å››å±‚åè®®çœ‹é—®é¢˜ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸ƒå±‚ã€‚å› ä¸ºæœ‰äº›æƒ…å†µä»ä¸ƒå±‚åè®®åˆ†æé—®é¢˜æ˜¯å¾ˆéš¾å‘ç°é—®é¢˜çš„ï¼Œæ¯”å¦‚SSEä¸ºä»€ä¹ˆå®ç°ä¸äº†æ‰“å­—æœºæ•ˆæœï¼Œçœ‹èµ·æ¥æ˜¯å¡åˆ°æœ€åä¸€æ¬¡æ€§å“åº”çš„ï¼Œä½†ä»å››å±‚èƒ½çœ‹å‡ºæ•°æ®åŒ…æ˜¯è¿ç»­å‘é€çš„ã€‚</p>
<p>æ”¯æŒç›´æ¥æŠ“127.0.0.1çš„æ•°æ®åŒ…ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Asciinema - ç»ˆç«¯æ—¥å¿—è®°å½•ç¥å™¨ï¼Œå¼€å‘è€…çš„ç¦éŸ³]]></title>    <link>https://juejin.cn/post/7115598532093935629</link>    <guid>https://juejin.cn/post/7115598532093935629</guid>    <pubDate>2022-07-02T02:37:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7115598532093935629" data-draft-id="7115595961652477965" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Asciinema - ç»ˆç«¯æ—¥å¿—è®°å½•ç¥å™¨ï¼Œå¼€å‘è€…çš„ç¦éŸ³"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2022-07-02T02:37:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Pythonç¼–ç¨‹å­¦ä¹ åœˆ"/> <meta itemprop="url" content="https://juejin.cn/user/2261048121629512"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Asciinema - ç»ˆç«¯æ—¥å¿—è®°å½•ç¥å™¨ï¼Œå¼€å‘è€…çš„ç¦éŸ³
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2261048121629512/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Pythonç¼–ç¨‹å­¦ä¹ åœˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2022-07-02T02:37:23.000Z" title="Sat Jul 02 2022 02:37:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2022-07-02
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    147
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body cache result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆ‘ä»¬åœ¨åšæœºå™¨å­¦ä¹ /æ·±åº¦å­¦ä¹ å¼€å‘çš„æ—¶å€™ï¼Œç»å¸¸ä¼šäº§ç”Ÿå¦‚ä¸‹æ‰€ç¤ºçš„å¤§é‡æ—¥å¿—ï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/305cff543e0a4779adc56a418bbd09a8~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™äº›æ—¥å¿—å¦‚æœä¸ä¿å­˜ï¼Œè½¬ç¬å³é€ï¼Œå½“æˆ‘ä»¬æƒ³è¦å›å»ç¿»çœ‹æŸä¸€è½®è®­ç»ƒæ—¥å¿—çš„æ—¶å€™ï¼Œä¼šå¾ˆé—æ†¾çš„å‘ç°æ‰¾ä¸åˆ°äº†ã€‚</p>
<p>ç°åœ¨æœ‰äº†è¿™ä¸ª Asciinema è¿™ä¸ªç¥å™¨ï¼Œæˆ‘ä»¬ä¸ä»…èƒ½æ‰¾åˆ°å¹¶å¯¼å‡ºå½“æ—¶çš„ç»ˆç«¯æ—¥å¿—ï¼Œè¿˜èƒ½å¤Ÿâ€œé‡æ’­æ—¥å¿—â€å¹¶â€œåˆ†äº«æ—¥å¿—â€ã€‚éå¸¸ç‰›é€¼ï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5c785c916bb54a789dc52978ae0d7117~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Asciinema æ˜¯ä½¿ç”¨Pythonå¼€å‘çš„å·¥å…·ï¼Œè¯·æŒ‰ä¸‹é¢çš„æµç¨‹å®‰è£…å¹¶ä½¿ç”¨ã€‚</p>
<p><em><strong>1.å‡†å¤‡</strong></em></p>
<p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…</p>
<pre><code class="hljs">pipÂ installÂ asciinema
</code></pre>
<p><em><strong>2.ä½¿ç”¨</strong></em></p>
<p>ç»ˆç«¯è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œè®°å½•ä½ çš„ç¬¬ä¸€ä¸ªç»ˆç«¯æ—¥å¿—ï¼š</p>
<pre><code class="hljs">asciinema rec first.cast
</code></pre>
<p>è¾“å…¥å®Œæˆåä¼šæ˜¾ç¤ºå¦‚ä¸‹çš„æç¤ºï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby">(gs3_9) zjr<span class="hljs-variable">@sgd</span>-linux-<span class="hljs-number">1</span><span class="hljs-symbol">:~/cnn_test</span><span class="hljs-variable">$ </span>asciinema rec first.cast
Â Â 
<span class="hljs-symbol">asciinema:</span> recording asciicast to first.cast
<span class="hljs-symbol">asciinema:</span> press &lt;ctrl-d&gt; <span class="hljs-keyword">or</span>Â typeÂ <span class="hljs-string">"exit"</span>Â <span class="hljs-keyword">when</span> you<span class="hljs-string">'re done
</span></code></pre>
<p>æ„æ€å°±æ˜¯æ—¥å¿—ä¼šè¢«ä¿å­˜åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„first.castï¼Œå¦‚æœä½ æƒ³ç»“æŸå½•åˆ¶ï¼ŒæŒ‰ Ctrl + D å³å¯ã€‚</p>
<p>è®°å½•å®Œæ¯•åï¼Œä»¥åŒå€é€Ÿåº¦é‡æ’­è¯¥æ—¥å¿—ï¼š</p>
<pre><code class="hljs">asciinema play -s 2 first.cast
</code></pre>
<p>æˆ–ä»¥æ­£å¸¸é€Ÿåº¦ä½†ç©ºé—²æ—¶é—´é™åˆ¶ä¸º 2 ç§’ï¼š</p>
<pre><code class="hljs language-css" lang="css">asciinema play -<span class="hljs-selector-tag">i</span> <span class="hljs-number">2</span> first<span class="hljs-selector-class">.cast</span>
</code></pre>
<p>ä½ ä¹Ÿå¯ä»¥åœ¨å¯åŠ¨ç»ˆç«¯æ—¥å¿—å½•åˆ¶æ—¶ä¼ é€’Â -i 2 ç»™ asciinema recï¼Œå°†å…¶æ°¸ä¹…è®¾ç½®åœ¨å½•åˆ¶ä¸­ï¼š</p>
<pre><code class="hljs language-css" lang="css">asciinema rec first<span class="hljs-selector-class">.cast</span> -<span class="hljs-selector-tag">i</span> <span class="hljs-number">2</span>
</code></pre>
<p>ç©ºé—²æ—¶é—´çš„é™åˆ¶ä½¿å½•åˆ¶æ›´æœ‰è¶£ã€‚è¯•è¯•å§ã€‚</p>
<p>å¦‚æœä½ æƒ³åœ¨ç½‘ç»œä¸Šè§‚çœ‹å’Œåˆ†äº«ï¼Œè¯·ä¸Šä¼ ï¼š</p>
<pre><code class="hljs">asciinema upload first.cast
</code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šå°†æ—¥å¿—è®°å½•ä¸Šä¼ åˆ° asciinema.orgï¼Œæ­¤å¤–ï¼Œå®ƒä¼šæ‰“å°ä¸€ä¸ªç§˜å¯†é“¾æ¥ï¼Œä½ å¯ä»¥ä½¿ç”¨è¯¥é“¾æ¥åœ¨ç½‘ç»œæµè§ˆå™¨ä¸­è§‚çœ‹ä½ å½•åˆ¶çš„ç»ˆç«¯æ—¥å¿—ï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4cf2b66415cd4296b12cb6accfdafee4~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½ å¯ä»¥é€šè¿‡çœç•¥æ–‡ä»¶åä¸€æ­¥å½•åˆ¶å’Œä¸Šä¼ ç»ˆç«¯çš„æ—¥å¿—ï¼š</p>
<pre><code class="hljs">asciinema rec
</code></pre>
<p>å½•åˆ¶å®Œæˆåï¼Œç³»ç»Ÿä¼šè¦æ±‚ä½ ç¡®è®¤ä¸Šä¼ ã€‚æœªç»ä½ çš„åŒæ„ï¼Œä¸ä¼šå‘ä»»ä½•åœ°æ–¹å‘é€ä»»ä½•å†…å®¹ã€‚</p>
<p><em><strong>3.æ’­æ”¾æ—¥å¿—</strong></em></p>
<p>æŸ¥çœ‹æ—¥å¿—æœ‰å››ç§æ–¹å¼ï¼Œæœ€æ™®é€šçš„æ˜¯é€šè¿‡æœ¬åœ°æ–‡ä»¶è¿›è¡Œç»ˆç«¯é‡æ’­ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">asciinema play /path/to/asciicast.cast
</code></pre>
<p>ä»¥ä¸‹é”®ç›˜å¿«æ·é”®å¯ç”¨ï¼š</p>
<ul>
<li><code>Space</code>- æš‚åœï¼Œ</li>
<li><code>.</code>- æŒ‰å¸§æ­¥è¿›ï¼ˆæš‚åœæ—¶ï¼‰ï¼Œ</li>
<li><code>Ctrl+C</code>- é€€å‡º</li>
</ul>
<p>ç¬¬äºŒç§æ–¹å¼æ˜¯é€šè¿‡urlæ’­æ”¾ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby">asciinema play <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/asciinema.org/a</span><span class="hljs-regexp">/22124.cast
asciinema play http:/</span><span class="hljs-regexp">/example.com/demo</span>.cast
</code></pre>
<p>è¿™ä¸ªæ–¹å¼éœ€è¦ä½ çš„æ—¥å¿—å·²ç»ä¸Šä¼ åˆ°asciinema.orgä¸­ã€‚</p>
<p>ç¬¬ä¸‰ç§æ–¹å¼æ˜¯é€šè¿‡ä½ è‡ªå·±ç”Ÿæˆçš„htmlé¡µé¢è®¿é—®ï¼ˆéœ€è¦åœ¨é¡µé¢çš„ HTML ä¸­ï¼‰ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">asciinema play http:<span class="hljs-comment">//your_html_path/post.html</span>
</code></pre>
<p>ç¬¬å››ç§æ–¹å¼æ˜¯é€šè¿‡æ ‡å‡†è¾“å…¥è¾“å‡ºæ’­æ”¾ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cat</span> /path/to/asciicast.cast | asciinema play -
<span class="hljs-comment"># ssh user@host cat asciicast.cast | asciinema playÂ -</span>
</code></pre>
<p>å¯ç”¨é€‰é¡¹ï¼š</p>
<ul>
<li><code>-i, --idle-time-limit=&lt;sec&gt;</code>- å°†é‡æ’­çš„ç»ˆç«¯ç©ºé—²ä¸åŠ¨æ—¶é—´é—²ç½®ä¸ºæœ€å¤§<code>&lt;sec&gt;</code>ç§’æ•°</li>
<li><code>-s, --speed=&lt;factor&gt;</code>- æ’­æ”¾é€Ÿåº¦</li>
</ul>
<p><em><strong>4.å¯¼å‡ºæ—¥å¿—</strong></em></p>
<p>å¯¼å‡ºç»ˆç«¯æ—¥å¿—åˆ°æ–‡æœ¬æ–‡ä»¶éå¸¸ç®€å•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">asciinema <span class="hljs-built_in">cat</span> existing.cast &gt; terminal_output.txt
</code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4dda6c8c79ce497082c92b16b6d346fc~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ‰€æœ‰çš„ç»ˆç«¯æ—¥å¿—éƒ½ä¼šè¢«å¯¼å‡ºåˆ° terminal_output.txt ä¸­ï¼Œéå¸¸æ–¹ä¾¿å¥½ç”¨ã€‚</p>
<p>ä»¥ä¸Šå°±æ˜¯æœ¬æ¬¡åˆ†äº«çš„æ‰€æœ‰å†…å®¹ï¼Œå¦‚æœä½ è§‰å¾—æ–‡ç« è¿˜ä¸é”™ï¼Œæ¬¢è¿å…³æ³¨å…¬ä¼—å·ï¼š<strong>Pythonç¼–ç¨‹å­¦ä¹ åœˆ</strong>ï¼Œæ¯æ—¥å¹²è´§åˆ†äº«ï¼Œæˆ–æ˜¯å‰å¾€<a href="https://link.juejin.cn?target=http%3A%2F%2Fwww.phpxs.com%2F" target="_blank" title="http://www.phpxs.com/" ref="nofollow noopener noreferrer">ç¼–ç¨‹å­¦ä¹ ç½‘</a>ï¼Œäº†è§£æ›´å¤šç¼–ç¨‹æŠ€æœ¯çŸ¥è¯†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[30sè®©aiç¼–å†™ã€Œè·³è¿‡å¤–é“¾ä¸­è½¬é¡µã€çš„æ²¹çŒ´è„šæœ¬]]></title>    <link>https://juejin.cn/post/7585377403632746542</link>    <guid>https://juejin.cn/post/7585377403632746542</guid>    <pubDate>2025-12-19T10:19:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585377403632746542" data-draft-id="7585227038991597606" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="30sè®©aiç¼–å†™ã€Œè·³è¿‡å¤–é“¾ä¸­è½¬é¡µã€çš„æ²¹çŒ´è„šæœ¬"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-19T10:19:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å”å”åœ¨å­¦ä¹ "/> <meta itemprop="url" content="https://juejin.cn/user/4009253326568761"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            30sè®©aiç¼–å†™ã€Œè·³è¿‡å¤–é“¾ä¸­è½¬é¡µã€çš„æ²¹çŒ´è„šæœ¬
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4009253326568761/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å”å”åœ¨å­¦ä¹ 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T10:19:10.000Z" title="Fri Dec 19 2025 10:19:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>é¦–å…ˆï¼Œç‹—å¤´ä¿å‘½ä¸‹å“ˆğŸ¶ï¼Œæˆ‘åªæ˜¯çœ‹åˆ°å¤§ä½¬çš„æ–‡ç« ï¼Œæ¥äº†å…´è¶£ï¼Œéšæ‰‹è®©aiå†™ä¸‹è„šæœ¬è€Œå·²ã€‚<strong>ä½œä¸ºæŠ€æœ¯äººçº¯åˆ†äº«è€Œå·²</strong>ï¼Œä¸å–œæ¬¢å‹¿å–·å“ˆï¼Œå–·äº†æˆ‘ä¸å›ä½ å°±æ˜¯å•¦ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e3d362f35d44a449c14836b4d9542ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZSQ5Y-U5Zyo5a2m5Lmg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766744350&amp;x-signature=FcXkv1uzDYKTyB50MKos%2B84G%2Fds%3D" alt="" loading="lazy"/></p>
<p>å¤§ä½¬çš„åŸæ–‡æ˜¯è¿™ä¸ªï¼š<a href="https://juejin.cn/post/7495977411273490447" target="_blank" title="https://juejin.cn/post/7495977411273490447">è„±è£¤å­æ”¾å± - ä½ ä»¬è®¨åŒè¿™æ ·çš„é¡µé¢å—ï¼Ÿä¸€ä¸ªæµè§ˆå™¨æ’ä»¶ï¼Œç”¨äºè·³è¿‡æ˜é‡‘ï¼ŒçŸ¥ä¹ï¼Œå°‘æ•°æ´¾ç­‰ç½‘ç«™çš„å¤–é“¾ä¸­è½¬ç«™é¡µé¢ã€‚è®©ä½ çš„äº’è”ç½‘æµè§ˆ - æ˜é‡‘</a></p>
<h2 data-id="heading-1">è„šæœ¬</h2>
<p>ç„¶ååŸºäºAIç¼–å†™çš„æ²¹çŒ´è„šæœ¬æ˜¯è¿™ä¸ªï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ==UserScript==</span>
<span class="hljs-comment">// @name         Redirect Skipper</span>
<span class="hljs-comment">// @namespace    http://tampermonkey.net/</span>
<span class="hljs-comment">// @version      1.1</span>
<span class="hljs-comment">// @description  è‡ªåŠ¨è·³è¿‡é“¾æ¥ä¸­è½¬é¡µé¢ï¼ŒåŒ…å«è¯¦ç»†è°ƒè¯•æ—¥å¿—</span>
<span class="hljs-comment">// @author       Original idea from juejin.cn article</span>
<span class="hljs-comment">// @match        *://*/*</span>
<span class="hljs-comment">// @grant        GM_log</span>
<span class="hljs-comment">// @run-at       document-end</span>
<span class="hljs-comment">// ==/UserScript==</span>

(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-string">'use strict'</span>;

    <span class="hljs-comment">// è°ƒè¯•å¼€å…³ - è®¾ç½®ä¸º true æ—¶åœ¨æ§åˆ¶å°è¾“å‡ºè¯¦ç»†æ—¥å¿—</span>
    <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEBUG</span> = <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">debugLog</span>(<span class="hljs-params">...args</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-variable constant_">DEBUG</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'[Redirect Skipper]'</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toLocaleTimeString</span>(), ...args);
        }
    }

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">errorLog</span>(<span class="hljs-params">...args</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[Redirect Skipper] ERROR:'</span>, ...args);
    }

    <span class="hljs-comment">// éœ€è¦å¤„ç†çš„ç½‘ç«™åˆ—è¡¨</span>
    <span class="hljs-keyword">let</span> hostnames = [<span class="hljs-string">"juejin.cn"</span>, <span class="hljs-string">"sspai.com"</span>, <span class="hljs-string">"www.zhihu.com"</span>];

    <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'è„šæœ¬å¼€å§‹æ‰§è¡Œ'</span>);
    <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'å½“å‰åŸŸå:'</span>, location.<span class="hljs-property">hostname</span>);
    <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'å¤„ç†çš„åŸŸååˆ—è¡¨:'</span>, hostnames);

    <span class="hljs-comment">/**
     * æ£€æŸ¥å½“å‰åŸŸåæ˜¯å¦åœ¨æ”¯æŒåˆ—è¡¨ä¸­
     */</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">checkCurrentHostname</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> currentHost = location.<span class="hljs-property">hostname</span>;
        <span class="hljs-keyword">const</span> isSupported = hostnames.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">host</span> =&gt;</span> {
            <span class="hljs-comment">// æ”¯æŒå­åŸŸååŒ¹é…ï¼Œæ¯”å¦‚ www.zhihu.com åŒ¹é… zhihu.com</span>
            <span class="hljs-keyword">return</span> currentHost === host || currentHost.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'.'</span> + host);
        });

        <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'åŸŸåæ£€æŸ¥ç»“æœ:'</span>, {
            <span class="hljs-string">'å½“å‰åŸŸå'</span>: currentHost,
            <span class="hljs-string">'æ˜¯å¦æ”¯æŒ'</span>: isSupported,
            <span class="hljs-string">'åŒ¹é…è§„åˆ™'</span>: isSupported ? hostnames.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">h</span> =&gt;</span> currentHost === h || currentHost.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'.'</span> + h)) : <span class="hljs-string">'æ— '</span>
        });

        <span class="hljs-keyword">return</span> isSupported;
    }

    <span class="hljs-comment">/**
     * æ ¸å¿ƒå‡½æ•°ï¼šæŸ¥æ‰¾å¹¶æ›¿æ¢å¸¦æœ‰ ?target= å‚æ•°çš„é“¾æ¥
     */</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">findByTarget</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> isSupported = <span class="hljs-title function_">checkCurrentHostname</span>();
        <span class="hljs-keyword">if</span> (!isSupported) {
            <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'å½“å‰åŸŸåä¸åœ¨å¤„ç†åˆ—è¡¨ä¸­ï¼Œè·³è¿‡æ‰§è¡Œ'</span>);
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'å¼€å§‹æŸ¥æ‰¾éœ€è¦å¤„ç†çš„é“¾æ¥...'</span>);

        <span class="hljs-keyword">const</span> linkKeyword = <span class="hljs-string">"?target="</span>;
        <span class="hljs-keyword">const</span> selector = <span class="hljs-string">`a[href*="<span class="hljs-subst">${linkKeyword}</span>"]:not([data-redirect-skipper])`</span>;
        <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'ä½¿ç”¨çš„é€‰æ‹©å™¨:'</span>, selector);

        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> aLinks = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(selector);
            <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'æ‰¾åˆ°çš„é“¾æ¥æ•°é‡:'</span>, aLinks.<span class="hljs-property">length</span>);

            <span class="hljs-keyword">if</span> (!aLinks.<span class="hljs-property">length</span>) {
                <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'æœªæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„é“¾æ¥'</span>);
                <span class="hljs-keyword">return</span>;
            }

            aLinks.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">a, index</span>) =&gt;</span> {
                <span class="hljs-keyword">const</span> originalHref = a.<span class="hljs-property">href</span>;
                <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">`å¤„ç†é“¾æ¥ <span class="hljs-subst">${index + <span class="hljs-number">1</span>}</span>:`</span>, originalHref);

                <span class="hljs-keyword">const</span> targetIndex = originalHref.<span class="hljs-title function_">indexOf</span>(linkKeyword);
                <span class="hljs-keyword">if</span> (targetIndex !== -<span class="hljs-number">1</span>) {
                    <span class="hljs-keyword">const</span> encodedUrl = originalHref.<span class="hljs-title function_">substring</span>(targetIndex + linkKeyword.<span class="hljs-property">length</span>);
                    <span class="hljs-keyword">const</span> decodedUrl = <span class="hljs-built_in">decodeURIComponent</span>(encodedUrl);

                    <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">`  âœ“ è§£æç»“æœ:`</span>, {
                        <span class="hljs-string">'åŸå§‹URL'</span>: originalHref,
                        <span class="hljs-string">'targetä½ç½®'</span>: targetIndex,
                        <span class="hljs-string">'ç¼–ç åçš„ç›®æ ‡URL'</span>: encodedUrl,
                        <span class="hljs-string">'è§£ç åçš„ç›®æ ‡URL'</span>: decodedUrl
                    });

                    <span class="hljs-comment">// éªŒè¯URLæ˜¯å¦æœ‰æ•ˆ</span>
                    <span class="hljs-keyword">if</span> (decodedUrl &amp;&amp; decodedUrl.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'http'</span>)) {
                        a.<span class="hljs-property">href</span> = decodedUrl;
                        a.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">"data-redirect-skipper"</span>, <span class="hljs-string">"true"</span>);
                        <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">`  âœ“ å·²æ›¿æ¢ä¸º:`</span>, decodedUrl);

                        <span class="hljs-comment">// æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬ï¼Œè®°å½•ç”¨æˆ·äº¤äº’</span>
                        a.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) {
                            <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'ç”¨æˆ·ç‚¹å‡»äº†å·²å¤„ç†çš„é“¾æ¥:'</span>, decodedUrl);
                        }, { <span class="hljs-attr">once</span>: <span class="hljs-literal">true</span> });
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-title function_">errorLog</span>(<span class="hljs-string">'è§£æå‡ºçš„URLæ— æ•ˆ:'</span>, decodedUrl);
                    }
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">`  âœ— æœªæ‰¾åˆ° <span class="hljs-subst">${linkKeyword}</span> å‚æ•°`</span>);
                }
            });

            <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'é“¾æ¥å¤„ç†å®Œæˆ'</span>);

        } <span class="hljs-keyword">catch</span> (err) {
            <span class="hljs-title function_">errorLog</span>(<span class="hljs-string">'æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯:'</span>, err);
        }
    }

    <span class="hljs-comment">/**
     * ç›‘å¬æ–‡æ¡£å˜åŒ–ï¼ˆç”¨äºå¤„ç†åŠ¨æ€åŠ è½½çš„å†…å®¹ï¼‰
     */</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">observerDocument</span>(<span class="hljs-params"/>) {
        <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'å¼€å§‹ç›‘å¬æ–‡æ¡£å˜åŒ–...'</span>);

        <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutationObserver</span>(<span class="hljs-function">(<span class="hljs-params">mutationsList</span>) =&gt;</span> {
            <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'æ£€æµ‹åˆ°æ–‡æ¡£å˜åŒ–ï¼Œå˜æ›´æ•°é‡:'</span>, mutationsList.<span class="hljs-property">length</span>);

            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> mutation <span class="hljs-keyword">of</span> mutationsList) {
                <span class="hljs-keyword">if</span> (mutation.<span class="hljs-property">type</span> === <span class="hljs-string">"childList"</span> &amp;&amp; mutation.<span class="hljs-property">addedNodes</span>.<span class="hljs-property">length</span>) {
                    <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'å‘ç°æ–°å¢èŠ‚ç‚¹ï¼Œæ•°é‡:'</span>, mutation.<span class="hljs-property">addedNodes</span>.<span class="hljs-property">length</span>);
                    <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'æ–°å¢èŠ‚ç‚¹:'</span>, mutation.<span class="hljs-property">addedNodes</span>);
                    <span class="hljs-title function_">findByTarget</span>();
                }
            }
        });

        observer.<span class="hljs-title function_">observe</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>, {
            <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>
        });

        <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'MutationObserver å·²å¯åŠ¨'</span>);
        <span class="hljs-keyword">return</span> observer;
    }

    <span class="hljs-comment">/**
     * æ‰«æé¡µé¢ä¸­çš„é“¾æ¥å¹¶ç»Ÿè®¡ä¿¡æ¯
     */</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">scanPageLinks</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> allLinks = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'a[href]'</span>);
        <span class="hljs-keyword">const</span> targetLinks = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'a[href*="?target="]'</span>);
        <span class="hljs-keyword">const</span> processedLinks = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'a[data-redirect-skipper]'</span>);

        <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'é¡µé¢é“¾æ¥ç»Ÿè®¡:'</span>, {
            <span class="hljs-string">'æ€»é“¾æ¥æ•°'</span>: allLinks.<span class="hljs-property">length</span>,
            <span class="hljs-string">'åŒ…å«?target=çš„é“¾æ¥æ•°'</span>: targetLinks.<span class="hljs-property">length</span>,
            <span class="hljs-string">'å·²å¤„ç†çš„é“¾æ¥æ•°'</span>: processedLinks.<span class="hljs-property">length</span>
        });

        <span class="hljs-comment">// åˆ—å‡ºæ‰€æœ‰åŒ…å«?target=çš„é“¾æ¥</span>
        targetLinks.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">link, i</span>) =&gt;</span> {
            <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">`é“¾æ¥<span class="hljs-subst">${i}</span>:`</span>, link.<span class="hljs-property">href</span>, <span class="hljs-string">'å·²å¤„ç†:'</span>, link.<span class="hljs-title function_">hasAttribute</span>(<span class="hljs-string">'data-redirect-skipper'</span>));
        });
    }

    <span class="hljs-comment">// ä¸»æ‰§è¡Œæµç¨‹</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
        <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'===== è„šæœ¬åˆå§‹åŒ–å¼€å§‹ ====='</span>);

        <span class="hljs-comment">// æ£€æŸ¥æ²¹çŒ´ç¯å¢ƒ</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> GM_info !== <span class="hljs-string">'undefined'</span>) {
            <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'æ²¹çŒ´è„šæœ¬ä¿¡æ¯:'</span>, {
                <span class="hljs-string">'è„šæœ¬åç§°'</span>: GM_info.<span class="hljs-property">script</span>.<span class="hljs-property">name</span>,
                <span class="hljs-string">'ç‰ˆæœ¬'</span>: GM_info.<span class="hljs-property">script</span>.<span class="hljs-property">version</span>,
                <span class="hljs-string">'è¿è¡Œä½ç½®'</span>: GM_info.<span class="hljs-property">scriptRunAt</span>
            });
        }

        <span class="hljs-comment">// åˆå§‹æ‰«æ</span>
        <span class="hljs-title function_">scanPageLinks</span>();
        <span class="hljs-title function_">findByTarget</span>();

        <span class="hljs-comment">// å¯åŠ¨DOMå˜åŒ–ç›‘å¬</span>
        <span class="hljs-keyword">const</span> observer = <span class="hljs-title function_">observerDocument</span>();

        <span class="hljs-comment">// ç›‘å¬é¡µé¢äº‹ä»¶</span>
        <span class="hljs-keyword">const</span> events = [<span class="hljs-string">'load'</span>, <span class="hljs-string">'hashchange'</span>, <span class="hljs-string">'popstate'</span>];
        events.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> {
            <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(event, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
                <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">`äº‹ä»¶è§¦å‘: <span class="hljs-subst">${event}</span>`</span>);
                <span class="hljs-keyword">if</span> (event === <span class="hljs-string">'load'</span>) {
                    <span class="hljs-title function_">scanPageLinks</span>();
                }
                <span class="hljs-title function_">findByTarget</span>();
            });
        });

        <span class="hljs-comment">// ä¸ºäº†è°ƒè¯•ï¼Œå°†å…³é”®å‡½æ•°æš´éœ²åˆ°å…¨å±€</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-variable constant_">DEBUG</span>) {
            <span class="hljs-variable language_">window</span>.<span class="hljs-property">RedirectSkipper</span> = {
                scanPageLinks,
                findByTarget,
                checkCurrentHostname,
                observer
            };
            <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'è°ƒè¯•å‡½æ•°å·²æš´éœ²åˆ° window.RedirectSkipper'</span>);
        }

        <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'===== è„šæœ¬åˆå§‹åŒ–å®Œæˆ ====='</span>);
    }

    <span class="hljs-comment">// å»¶è¿Ÿåˆå§‹åŒ–ï¼Œç¡®ä¿DOMå·²åŠ è½½</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">document</span>.<span class="hljs-property">readyState</span> === <span class="hljs-string">'loading'</span>) {
        <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'æ–‡æ¡£è¿˜åœ¨åŠ è½½ä¸­ï¼Œç­‰å¾…DOMContentLoadedäº‹ä»¶'</span>);
        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'DOMContentLoaded'</span>, init);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-title function_">debugLog</span>(<span class="hljs-string">'æ–‡æ¡£å·²å°±ç»ªï¼Œç«‹å³åˆå§‹åŒ–'</span>);
        <span class="hljs-title function_">init</span>();
    }

})();
</code></pre>
<p>è‡³äºè„šæœ¬ç”¨çš„AIæç¤ºè¯å°±æ›´ç®€å•å•¦ï¼Œä¸è¿‡æˆ‘é—®çš„ç¬¬ä¸€æ¬¡ç”Ÿæˆçš„ä»£ç è¿è¡Œåè·³è½¬æ²¡ç”Ÿæ•ˆï¼Œç„¶åè®©AIåŠ æ—¥å¿—äº†ï¼Œå¥½å®šä½åˆ†æï¼Œç»“æœç¬¬äºŒæ¬¡ç«Ÿç„¶å°±æˆåŠŸäº†ï¼Œä¹Ÿä¸ç”¨å®šä½äº†hhhï¼æœ‰ä¸€è¯´ä¸€ï¼šè¿™å¹´å¤´ï¼Œå…¶å®è¿˜æ˜¯è¦å­¦ä¼šå–„ç”¨AIè¿™ä¸ªå¤§æ€å™¨çš„ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b1afa7f3904242e3a48d17e42d32ddd2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZSQ5Y-U5Zyo5a2m5Lmg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766744350&amp;x-signature=3pZBpyF6neN4MhFk2G5lzYvYgDM%3D" alt="" loading="lazy"/></p>
<p>ğŸ’¡æ¸©é¦¨æç¤ºï¼š</p>
<p>å¦‚æœä½ å¸Œæœ›è„šæœ¬å¤„ç†å…¶ä»–ç½‘ç«™ï¼Œåªéœ€ä¿®æ”¹ä»£ç å¼€å¤´çš„Â <code>hostnames</code>Â æ•°ç»„å³å¯ã€‚ä¾‹å¦‚ï¼Œè¦æ·»åŠ Â <code>example.com</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">let</span> hostnames = [<span class="hljs-string">"juejin.cn"</span>, <span class="hljs-string">"sspai.com"</span>, <span class="hljs-string">"www.zhihu.com"</span>, <span class="hljs-string">"example.com"</span>];
</code></pre>
<p>æ·»åŠ åä¿å­˜è„šæœ¬ï¼Œå¹¶åˆ·æ–°ç›®æ ‡ç½‘ç«™å³å¯ç”Ÿæ•ˆã€‚</p>
<p>æ²¹çŒ´è„šæœ¬å®ç°åŸç†å…¶å®ä¹Ÿç›¸å¯¹ç®€å•ï¼Œå°±ç›´æ¥ä¸Šå›¾äº†ï¼Œå¦‚æœç†è§£ä¸äº†æˆ‘å†å®Œå–„è§£é‡Šå‘¢ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/63bdea08e2a240a3aba4b2c76f588642~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZSQ5Y-U5Zyo5a2m5Lmg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766744350&amp;x-signature=AU6bEsxXHFKJi4hIKbo6B8pH8cM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">æ€è€ƒ</h2>
<p>ä¸ºå•¥ç½‘ç«™éƒ½è¿™æ ·ç©å‘¢ï¼Ÿé™¤äº†åŸåšä¸»è¯´çš„ï¼š</p>
<ul>
<li>é˜²æ­¢é’“é±¼æ”»å‡»</li>
<li>å¢å¼ºç”¨æˆ·æ„è¯†</li>
<li>å“ç‰Œä¿æŠ¤</li>
<li>éµå®ˆæ³•å¾‹æ³•è§„</li>
<li>æ§åˆ¶æµé‡å»å‘</li>
</ul>
<p>å…¶å®ï¼Œæˆ‘æ›´å€¾å‘äºè¯„è®ºä¸­ä¸å°‘å¤§ä½¬æåŠçš„SEOé—®é¢˜ã€‚æ¯•ç«Ÿï¼Œå¤–é“¾å‡ºé—®é¢˜äº†ï¼Œæœ¬èº«ä¹Ÿæ˜¯ç”¨æˆ·ç‚¹å‡»çš„ï¼Œè·Ÿå¹³å°å…³ç³»ä¸å¤§çš„ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0733cba56eb147bc8062738d29ae0b52~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZSQ5Y-U5Zyo5a2m5Lmg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766744350&amp;x-signature=rx4wZ11z6KrZgdqwgk15A24T6LQ%3D" alt="" loading="lazy"/></p>
<p>å½“ç„¶ï¼Œä¸ç®¡æ˜¯å“ªç§åŸå› ï¼ŒåŠ è·³è½¬é¡µè¿˜æ˜¯ä¸åŠ è·³è½¬é¡µï¼Œå…¶å®æœ€ç»ˆå½±å“çš„éƒ½æ˜¯ç”¨æˆ·æœ¬èº«å§ï¼Œéƒ½æ˜¯ç”¨æˆ·ä¹°å•å§â€¦â€¦</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OmniThoughtVï¼šé¢å‘å¤šæ¨¡æ€æ·±åº¦æ€è€ƒçš„é«˜è´¨é‡æ•°æ®è’¸é¦]]></title>    <link>https://juejin.cn/post/7585206349749469236</link>    <guid>https://juejin.cn/post/7585206349749469236</guid>    <pubDate>2025-12-19T10:46:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585206349749469236" data-draft-id="7585394082822799394" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OmniThoughtVï¼šé¢å‘å¤šæ¨¡æ€æ·±åº¦æ€è€ƒçš„é«˜è´¨é‡æ•°æ®è’¸é¦"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-19T10:46:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿é‡Œäº‘å¤§æ•°æ®AIæŠ€æœ¯"/> <meta itemprop="url" content="https://juejin.cn/user/2414974667341287"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OmniThoughtVï¼šé¢å‘å¤šæ¨¡æ€æ·±åº¦æ€è€ƒçš„é«˜è´¨é‡æ•°æ®è’¸é¦
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2414974667341287/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿é‡Œäº‘å¤§æ•°æ®AIæŠ€æœ¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T10:46:48.000Z" title="Fri Dec 19 2025 10:46:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šå²³å…ƒæµ©(é¡¾åŸ)ã€æ±ªè¯šæ„š(ç†Šå…®)ã€é»„ä¿Š(ä¸´åœ¨)</p>
<h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>è¿‘å¹´æ¥ï¼Œå¤šæ¨¡æ€äººå·¥æ™ºèƒ½æŠ€æœ¯è¿…çŒ›å‘å±•ï¼Œæ¨åŠ¨äº†è§†è§‰ã€è¯­è¨€ã€è¯­éŸ³ç­‰å¤šç§æ¨¡æ€ä¿¡æ¯çš„æ·±åº¦èåˆä¸ç†è§£ã€‚å°¤å…¶åœ¨å¤šæ¨¡æ€æ·±åº¦æ¨ç†ä»»åŠ¡ä¸­ï¼Œ GPT-4V ç­‰å‰æ²¿æ¨¡å‹é€šè¿‡æ¨¡æ‹Ÿäººç±»çš„é“¾å¼æ€ç»´è¿‡ç¨‹ï¼Œå±•ç°å‡ºå¼ºå¤§çš„è·¨æ¨¡æ€æ¨ç†èƒ½åŠ›ã€‚ç„¶è€Œï¼Œå½“å‰çš„å¤šæ¨¡æ€å¤§æ¨¡å‹åœ¨å®é™…åº”ç”¨ä¸­ä»é¢ä¸´ä¸¤ä¸ªå…³é”®é—®é¢˜ï¼šé¦–å…ˆï¼Œèƒ½åŠ›è¾ƒå¼ºçš„SOTAæ¨¡å‹å¾€å¾€å‚æ•°è§„æ¨¡åºå¤§ã€è®¡ç®—èµ„æºæ¶ˆè€—é«˜ï¼Œå¯¼è‡´éƒ¨ç½²æˆæœ¬é«˜æ˜‚ï¼Œéš¾ä»¥åœ¨èµ„æºå—é™çš„åœºæ™¯ä¸­è½åœ°ã€‚å…¶æ¬¡ï¼Œç°æœ‰å¼€æºç¤¾åŒºç¼ºä¹å¤§è§„æ¨¡é«˜è´¨é‡çš„å¤šæ¨¡æ€é•¿æ€è€ƒæ•°æ®é›†ï¼Œè‡´ä½¿å¤šæ¨¡æ€æ¨ç†æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹éš¾ä»¥å¤ç°ï¼Œä¹Ÿåˆ¶çº¦äº†å¼€æºç¤¾åŒºå¤šæ¨¡æ€æ¨ç†æ¨¡å‹çš„æ€§èƒ½æå‡ã€‚</p>
<p>åŸºäºé˜¿é‡Œäº‘äººå·¥æ™ºèƒ½å¹³å°ï¼ˆPAIï¼‰çš„è’¸é¦å·¥å…·åŒ… EasyDistillï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmodelscope%2Feasydistill%25EF%25BC%2589%25EF%25BC%258C%25E6%2588%2591%25E4%25BB%25AC%25E6%258F%2590%25E5%2587%25BA%25E4%25BA%2586%25E4%25B8%2580%25E5%25A5%2597%25E9%259D%25A2%25E5%2590%2591%25E5%25A4%259A%25E6%25A8%25A1%25E6%2580%2581%25E6%25B7%25B1%25E5%25BA%25A6%25E6%258E%25A8%25E7%2590%2586%25E7%259A%2584%25E8%2592%25B8%25E9%25A6%258F%25E6%2595%25B0%25E6%258D%25AE%25E6%259E%2584%25E5%25BB%25BA%25E6%25A1%2586%25E6%259E%25B6%25EF%25BC%258C%25E5%25B9%25B6%25E5%258F%2591%25E5%25B8%2583%25E4%25BA%2586%25E9%25A6%2596%25E4%25B8%25AA%25E6%2594%25AF%25E6%258C%2581%25E5%25A4%25A7%25E8%25A7%2584%25E6%25A8%25A1%25E5%25A4%259A%25E6%25A8%25A1%25E6%2580%2581%25E6%2580%259D%25E7%25BB%25B4%25E9%2593%25BE%25E8%2592%25B8%25E9%25A6%258F%25E7%259A%2584%25E9%25AB%2598%25E8%25B4%25A8%25E9%2587%258F%25E6%2595%25B0%25E6%258D%25AE%25E9%259B%2586" target="_blank" title="https://github.com/modelscope/easydistill%EF%BC%89%EF%BC%8C%E6%88%91%E4%BB%AC%E6%8F%90%E5%87%BA%E4%BA%86%E4%B8%80%E5%A5%97%E9%9D%A2%E5%90%91%E5%A4%9A%E6%A8%A1%E6%80%81%E6%B7%B1%E5%BA%A6%E6%8E%A8%E7%90%86%E7%9A%84%E8%92%B8%E9%A6%8F%E6%95%B0%E6%8D%AE%E6%9E%84%E5%BB%BA%E6%A1%86%E6%9E%B6%EF%BC%8C%E5%B9%B6%E5%8F%91%E5%B8%83%E4%BA%86%E9%A6%96%E4%B8%AA%E6%94%AF%E6%8C%81%E5%A4%A7%E8%A7%84%E6%A8%A1%E5%A4%9A%E6%A8%A1%E6%80%81%E6%80%9D%E7%BB%B4%E9%93%BE%E8%92%B8%E9%A6%8F%E7%9A%84%E9%AB%98%E8%B4%A8%E9%87%8F%E6%95%B0%E6%8D%AE%E9%9B%86" ref="nofollow noopener noreferrer">github.com/modelscope/â€¦</a> OmniThoughtVã€‚OmniThoughtVä¸ä»…å¡«è¡¥äº†å¼€æºç¤¾åŒºåœ¨å¤šæ¨¡æ€å¤æ‚æ¨ç†æ•°æ®æ–¹é¢çš„ç©ºç™½ï¼Œè¿˜é€šè¿‡ä¸€å¥—é€æ˜ã€å¯å¤ç°çš„æ•°æ®è’¸é¦æœºåˆ¶ï¼Œå®ç°äº†å¯¹å¤šæ¨¡æ€æ€ç»´é“¾çš„é«˜æ•ˆæå–ä¸ç»“æ„åŒ–ç»„ç»‡ã€‚è¯¥æ•°æ®é›†èåˆäº†ç²¾ç»†åŒ–æ ‡æ³¨ã€å¤šé˜¶æ®µè¿‡æ»¤æœºåˆ¶ä¸é’ˆå¯¹å¤šæ¨¡æ€æ¨ç†ä¼˜åŒ–çš„è’¸é¦ç­–ç•¥ï¼Œæ˜¾è‘—æå‡äº†å°æ¨¡å‹åœ¨ä¿æŒé€»è¾‘è¿è´¯æ€§çš„åŒæ—¶ï¼Œé™ä½æ¨ç†å†—ä½™ã€åŠ å¿«å“åº”é€Ÿåº¦ï¼Œå¹¶å¢å¼ºäº†åœ¨å¼€æ”¾åœºæ™¯ä¸­çš„é²æ£’æ€§ä¸æ³›åŒ–èƒ½åŠ›ã€‚ç‰¹åˆ«åœ°ï¼ŒåŸºäºè’¸é¦çš„OmniThoughtVæ•°æ®é›†å¾—åˆ°çš„Qwen3-VL-4Bå°æ¨¡å‹åœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸Šæ¥è¿‘æˆ–è¶…è¶Šäº†å‚æ•°é‡ä¸ºå…¶ä¸¤å€çš„åŸºåº§æ¨¡å‹ï¼ˆQwen3-VL-8Bï¼‰ï¼Œå®ç°äº†å‚æ•°é‡50%çš„å‹ç¼©æ•ˆæœï¼Œå…¶ç»“æœå¦‚ä¸‹ï¼š</p>
<p>æ¨¡å‹/è¯„æµ‹æ•°æ®é›†</p>
<p>4Bæ¨¡å‹ï¼ˆè’¸é¦å‰ï¼‰</p>
<p>4Bæ¨¡å‹ï¼ˆè’¸é¦åï¼‰</p>
<p>8Bæ¨¡å‹ï¼ˆè’¸é¦å‰ï¼‰</p>
<p>AI2D</p>
<p>0.7134</p>
<p><strong>0.8164</strong></p>
<p><strong>0.8096</strong></p>
<p>MMMU ProStandard</p>
<p>0.4133</p>
<p><strong>0.4694</strong></p>
<p><strong>0.4688</strong></p>
<p>MMMUval</p>
<p>0.5667</p>
<p><strong>0.6033</strong></p>
<p><strong>0.6000</strong></p>
<p>MathVista</p>
<p>0.7070</p>
<p><strong>0.7400</strong></p>
<p><strong>0.7250</strong></p>
<p>MathVersetestmini</p>
<p>0.3640</p>
<p><strong>0.5315</strong></p>
<p><strong>0.3820</strong></p>
<p>MMBench</p>
<p>0.8204</p>
<p><strong>0.8273</strong></p>
<p><strong>0.8256</strong></p>
<p>æœ¬æ–‡å°†é‡ç‚¹è§£æåŸºäº EasyDistill æ¡†æ¶æ„å»º OmniThoughtV æ•°æ®é›†çš„æ ¸å¿ƒæ–¹æ³•ï¼Œè¯„æµ‹å…¶åœ¨å¤šæ¨¡æ€æ·±åº¦æ¨ç†ä»»åŠ¡ä¸­çš„å®é™…æ•ˆæœï¼Œå¹¶ä»‹ç»è¯¥æ•°æ®é›†åŠé…å¥—è’¸é¦æ¨¡å‹åœ¨å¼€æºç¤¾åŒºå’Œ PAI å¹³å°ä¸Šçš„ä½¿ç”¨æ–¹å¼å’Œå„ä¸ªåœºæ™¯çš„åº”ç”¨ï¼Œä¸ºæ¨åŠ¨å¼€æºå¤šæ¨¡æ€å¤§æ¨¡å‹è¿ˆå‘äººç±»æ°´å¹³çš„ç³»ç»Ÿæ€§æ€è€ƒèƒ½åŠ›æä¾›åšå®åŸºç¡€ã€‚</p>
<h2 data-id="heading-1">OmniThoughtVæ•°æ®é›†æ„å»º</h2>
<p>å¼€æºç¤¾åŒºç°æœ‰çš„å¤šæ¨¡æ€æŒ‡ä»¤å¾®è°ƒæ•°æ®é›†å¾€å¾€åªåŒ…å«ç®€å•ç›´æ¥çš„å›ç­”ï¼Œç¼ºä¹å¤æ‚çš„æ¨ç†è¿‡ç¨‹ï¼Œéš¾ä»¥æ”¯æŒæ¨¡å‹å­¦ä¹ å¦‚ä½•â€œçœ‹å›¾æ·±åº¦æ€è€ƒâ€ã€‚ä¾‹å¦‚ï¼Œåœ¨å›ç­”â€œå…è´¹è¯•ç”¨ç”¨æˆ·çš„æ€»æ•°æ˜¯å¤šå°‘ï¼Ÿâ€è¿™ç±»é—®é¢˜æ—¶ï¼Œæ¨¡å‹ä¸ä»…éœ€è¦å®šä½å›¾è¡¨ä¸­çš„å…³é”®è§†è§‰å…ƒç´ ï¼Œè¿˜éœ€ç†è§£å…¶è¯­ä¹‰ã€æ’é™¤å¹²æ‰°ä¿¡æ¯ï¼Œå¹¶é€æ­¥æ¨å¯¼å‡ºç»“è®ºã€‚ç„¶è€Œï¼Œç°æœ‰æ•°æ®é›†é€šå¸¸ä»…æä¾›æœ€ç»ˆç­”æ¡ˆï¼Œç¼ºå¤±ä¸­é—´å¯è§£é‡Šçš„æ¨ç†é“¾ã€‚ä¸ºå¼¥è¡¥è¿™ä¸€ç©ºç™½ï¼Œæˆ‘ä»¬æ„å»ºäº† OmniThoughtV, é¦–ä¸ªå¤§è§„æ¨¡ã€é¢å‘å¤šæ¨¡æ€æ·±åº¦æ¨ç†çš„é«˜è´¨é‡é•¿æ€è€ƒæ•°æ®é›†ã€‚æˆ‘ä»¬çš„æ¨¡å‹æ€è€ƒä¸ä»…æ¶µç›–æ•°å­¦ã€é€»è¾‘ç­‰æ¨ç†ï¼Œè¿˜åŒ…æ‹¬å¯¹å›¾åƒä¸­ç‰©ä½“ã€ç©ºé—´ç­‰ä¿¡æ¯çš„ç†è§£ä¸æ¨ç†ã€‚</p>
<p>å¤šæ¨¡æ€æ•°æ®é›†ç¤ºä¾‹</p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2025/png/121356315/1759980176320-0c0de7e7-6318-4563-96d4-958d1a8f9c4e.png?x-oss-process=image%2Fcrop%2Cx_10%2Cy_10%2Cw_2432%2Ch_1416" alt="" loading="lazy"/></p>
<p>é—®é¢˜ï¼šå…è´¹è¯•ç”¨ç”¨æˆ·çš„æ€»æ•°æ˜¯å¤šå°‘ï¼Ÿ</p>
<p><strong>åŸå›ç­”æ ‡æ³¨</strong></p>
<p>å…è´¹è¯•ç”¨ç”¨æˆ·çš„æ€»æ•°åœ¨å›¾è¡¨å¼€å¤´çš„â€œTotal Free Trial Usersâ€ï¼ˆæ€»å…è´¹è¯•ç”¨ç”¨æˆ·æ•°ï¼‰ä¸‹æ–¹æ ‡æ˜ã€‚</p>
<p>ç­”æ¡ˆï¼š10,000</p>
<p><strong>é•¿æ€è€ƒæ ‡æ³¨</strong></p>

<p>ä¸ºäº†ç¡®å®šå…è´¹è¯•ç”¨ç”¨æˆ·çš„æ€»æ•°ï¼Œæˆ‘éœ€è¦æŸ¥çœ‹æ¼æ–—å›¾ä¸­æ ‡æœ‰â€œTotal Free Trial Usersâ€ï¼ˆæ€»å…è´¹è¯•ç”¨ç”¨æˆ·æ•°ï¼‰çš„ç¬¬ä¸€ä¸ªæŸ±çŠ¶æ¡ã€‚è¯¥æŸ±çŠ¶æ¡ä»£è¡¨äº†å¼€å§‹å…è´¹è¯•ç”¨çš„åˆå§‹ç”¨æˆ·ç¾¤ä½“ã€‚</p>
<p>ä»å›¾è¡¨ä¸­å¯ä»¥çœ‹å‡ºï¼š</p>
<p>- ç¬¬ä¸€ä¸ªæŸ±çŠ¶æ¡çš„é«˜åº¦å¯¹åº” 10,000 åç”¨æˆ·ã€‚</p>
<p>- è¯¥æŸ±çŠ¶æ¡ä¸Šçš„æ ‡ç­¾æ˜ç¡®æ ‡ç¤ºä¸ºâ€œ+10,000â€ï¼Œè¡¨æ˜è¿™æ˜¯å…è´¹è¯•ç”¨ç”¨æˆ·çš„èµ·å§‹äººæ•°ã€‚</p>
<p>æ— éœ€è¿›ä¸€æ­¥è®¡ç®—ï¼Œå› ä¸ºå›¾è¡¨å·²ç›´æ¥æä¾›äº†å…è´¹è¯•ç”¨ç”¨æˆ·çš„æ€»æ•°ã€‚</p>
<p>å› æ­¤ï¼Œå…è´¹è¯•ç”¨ç”¨æˆ·çš„æ€»æ•°ä¸º 10,000ã€‚</p>


<p>10,000</p>

<p>æˆ‘ä»¬ä» HuggingFace çš„ FineVision æ•°æ®é›†ä¸­æŠ½å–äº† 180 ä¸‡æ¡è‹±æ–‡å›¾æ–‡æŒ‡ä»¤ï¼Œå…¨é¢è¦†ç›–å…¶å…¨éƒ¨å­æ•°æ®é›†ä¸æ•°æ®æ¥æºï¼Œä»è€Œæ„å»ºäº†ä¸€ä¸ªå¤šæ ·åŒ–ã€é«˜è¦†ç›–åº¦çš„åˆå§‹å¤šæ¨¡æ€é—®é¢˜æ± ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬åˆ©ç”¨å½“å‰æ€§èƒ½é¢†å…ˆçš„å¤šæ¨¡æ€å¤§æ¨¡å‹ Qwen3-VL-Maxï¼Œä¸ºæ¯ä¸€æ¡æ ·æœ¬ç”Ÿæˆç»“æ„åŒ–ã€å¯è§£é‡Šã€å¤šæ­¥éª¤çš„é•¿æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œæ¶µç›–è§†è§‰ä¿¡æ¯å®šä½ã€è·¨æ¨¡æ€è¯­ä¹‰å¯¹é½ã€é€»è¾‘æ¨å¯¼ä¸ç­”æ¡ˆéªŒè¯ç­‰å…³é”®è®¤çŸ¥ç¯èŠ‚ã€‚å…¶ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹Promptæ¨¡ç‰ˆä» Qwen3-VL-Maxè’¸é¦å¾—åˆ°ä¸Šè¿°é•¿æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">SYSTEM_PROMPT</span>=<span class="hljs-string">"You are a helpful assistant to think step by step. Provide your reasoning steps within &lt;think&gt;&lt;/think&gt; tags and give your final answer within &lt;answer&gt;&lt;/answer&gt; tags."</span>

<span class="hljs-attr">QUERY</span>=f<span class="hljs-string">"""
&lt;image&gt;
### Question

{question}

### Output Format (Strictly Enforced)

&lt;think&gt;
Clearly explain your reasoning step by step. Describe how you arrived at the conclusion.
The reasoning process MUST BE enclosed within &lt;think&gt; &lt;/think&gt; tags.
&lt;/think&gt;
&lt;answer&gt;
Your final answer to the user's question.
&lt;/answer&gt;
"""</span>
</code></pre>
<p>æœ€ç»ˆï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªåŒ…å«çº¦ 0.8B Tokens çš„é«˜è´¨é‡å¤šæ¨¡æ€é•¿æ€è€ƒè’¸é¦æ•°æ®é›†ï¼Œä¸ºè®­ç»ƒå…·å¤‡æ·±åº¦æ¨ç†èƒ½åŠ›çš„å°å‹å¤šæ¨¡æ€æ¨¡å‹å¥ å®šäº†åšå®çš„æ•°æ®åŸºç¡€ã€‚è¯¥æ•°æ®é›†ä¸ä»…è§„æ¨¡åºå¤§ï¼Œæ›´åœ¨æ¨ç†æ·±åº¦ã€é€»è¾‘è¿è´¯æ€§ä¸ä»»åŠ¡å¤šæ ·æ€§ç­‰æ–¹é¢æ˜¾è‘—è¶…è¶Šç°æœ‰å¼€æºå¤šæ¨¡æ€æŒ‡ä»¤å¾®è°ƒæ•°æ®é›†ã€‚</p>
<h2 data-id="heading-2">OmniThoughtVæ€ç»´é“¾è¯„ä¼°æŒ‡æ ‡</h2>
<p>åœ¨å®Œæˆå¯¹ 180 ä¸‡æ¡è‹±æ–‡å›¾æ–‡æŒ‡ä»¤çš„è’¸é¦æ ‡æ³¨åï¼Œæˆ‘ä»¬å¯¹ç”Ÿæˆçš„é•¿æ€è€ƒæ•°æ®è¿›è¡Œäº†ç³»ç»Ÿæ€§è´¨é‡æ¸…æ´—ï¼Œä»¥ç¡®ä¿æ•°æ®çš„éš¾åº¦å’Œæ ‡æ³¨å‡†ç¡®æ€§ã€‚æ•°æ®æ¸…æ´—ä¸è¿‡æ»¤ä¸»è¦åŸºäºä¸¤ä¸ªç»´åº¦ï¼šè§„åˆ™è¿‡æ»¤å’Œæ¨¡å‹æ‰“åˆ†ã€‚ åœ¨è§„åˆ™å±‚é¢ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸‰ç±»å¯å‘å¼è§„åˆ™ï¼šé™¤äº†å‰”é™¤ä¸ç¬¦åˆ...&lt;\think&gt;...&lt;\answer&gt;æ€è€ƒé“¾æ ¼å¼çš„æ•°æ®å¤–ï¼Œæˆ‘ä»¬è¿˜è¿‡æ»¤æ‰æ¨¡å‹å›ç­”é•¿åº¦è¿‡é•¿çš„æ•°æ®ï¼Œé€šå¸¸è¿™ç±»æ•°æ®å¯¹åº”æä¸ºå¤æ‚çš„é—®é¢˜ï¼Œæ¨¡å‹åœ¨æ€è€ƒè¿‡ç¨‹ä¸­éš¾ä»¥æ‰¾åˆ°æœ‰æ•ˆç­”æ¡ˆã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å‰”é™¤äº†å›ç­”ä¸­å‡ºç°æ¨¡å‹è‡ªæˆ‘åå¤çº é”™çš„æ ·æœ¬ï¼Œä¾‹å¦‚åŒ…å«â€œWait, â€¦..â€ç­‰è‡ªæˆ‘çº é”™æ¨¡æ¿çš„æ•°æ®ï¼Œè¿™ç±»æ•°æ®é€šå¸¸ä¹Ÿæ˜¯æéš¾é—®é¢˜ï¼Œæ¨¡å‹æ— æ³•åšå‡ºå‡†ç¡®æ¨ç†ã€‚ åœ¨æ¨¡å‹æ‰“åˆ†æ–¹é¢ï¼Œæˆ‘ä»¬ä½¿ç”¨ Qwen3-VL-Flash å¯¹æ•°æ®è¿›è¡Œæ‰“åˆ†ï¼Œåˆ†åˆ«æ ‡æ³¨äº†æ•°æ®çš„è´¨é‡ã€éš¾åº¦ä»¥åŠå¼€æ”¾å¼ä»»åŠ¡æ ‡ç­¾ï¼Œå…·ä½“å®šä¹‰å¦‚ä¸‹ï¼š</p>
<p>åˆ†æ•°</p>
<p>çº§åˆ«</p>
<p>æè¿°</p>
<p>éš¾åº¦è¯„åˆ†</p>
<p>1</p>
<p>éå¸¸ç®€å•</p>
<p>æ˜æ˜¾å­˜åœ¨çš„ç‰©ä½“ã€ç®€å•çš„é¢œè‰²/å½¢çŠ¶è¯†åˆ«</p>
<p>2</p>
<p>ç®€å•</p>
<p>æ¸…æ™°å¯è§ç‰©å“çš„åŸºæœ¬è®¡æ•°ã€ç®€å•çš„ç©ºé—´å…³ç³»</p>
<p>3</p>
<p>ä¸­ç­‰</p>
<p>éœ€è¦ç®€çŸ­æ¨ç†ã€è¯†åˆ«å¸¸è§åŠ¨ä½œæˆ–å±æ€§</p>
<p>4</p>
<p>å›°éš¾</p>
<p>å¤šæ­¥æ¨ç†ã€ç»†å¾®çš„è§†è§‰çº¿ç´¢ã€æˆ–ä¸å¸¸è§çš„æ¦‚å¿µ</p>
<p>5</p>
<p>éå¸¸å›°éš¾</p>
<p>æŠ½è±¡æ¨ç†ã€å¤æ‚çš„åœºæ™¯ç†è§£ã€æˆ–æ¨¡ç³Šä¸æ¸…çš„ä¸Šä¸‹æ–‡</p>
<p>è´¨é‡è¯„åˆ†</p>
<p>1</p>
<p>éå¸¸ä½</p>
<p>å®Œå…¨é”™è¯¯æˆ–æ— å…³çš„å›ç­”</p>
<p>2</p>
<p>ä½</p>
<p>å¤§éƒ¨åˆ†é”™è¯¯ï¼Œä»…å«å°‘é‡æ­£ç¡®å…ƒç´ </p>
<p>3</p>
<p>ä¸­</p>
<p>éƒ¨åˆ†æ­£ç¡®ï¼Œä½†é—æ¼å…³é”®ç»†èŠ‚æˆ–åŒ…å«é”™è¯¯</p>
<p>4</p>
<p>é«˜</p>
<p>åŸºæœ¬æ­£ç¡®ï¼Œä»…æœ‰è½»å¾®ä¸å‡†ç¡®æˆ–é—æ¼</p>
<p>5</p>
<p>éå¸¸é«˜</p>
<p>å®Œå…¨å‡†ç¡®ã€ç²¾ç¡®ä¸”å®Œæ•´çš„å›ç­”</p>
<p>æ­¤å¤–ï¼Œæ¨¡å‹ä¼šä¸ºæ¯ä¸ªé—®é¢˜åˆ†é… 3 åˆ° 6 ä¸ªç®€æ´ã€ç›¸å…³ã€å¼€æ”¾å¼ä»»åŠ¡æ ‡ç­¾ï¼Œæè¿°é—®é¢˜çš„æ€§è´¨ï¼ˆä¾‹å¦‚ï¼šâ€œcountingâ€ã€â€œcolorâ€ã€â€œspatialâ€ã€â€œactionâ€ã€â€œobjectâ€ã€â€œattributeâ€ã€â€œreasoningâ€ã€â€œsceneâ€ã€â€œtextâ€ã€â€œmathâ€ ç­‰ï¼‰ã€‚ä¸ºäº†ä¿è¯è¯­ä¹‰çš„æ¸…æ™°æ€§ï¼Œæˆ‘ä»¬ä»…ä½¿ç”¨å¸¸è§ã€é€šç”¨çš„æ ‡ç­¾ã€‚</p>
<p>OmniThoughtVæ•°æ®é›†çš„æ ‡æ³¨ç»Ÿè®¡ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2025/png/121356315/1762141171380-ad401c79-63a1-41dc-9ed9-d28d0f532f32.png?x-oss-process=image%2Fcrop%2Cx_7%2Cy_0%2Cw_1769%2Ch_1044" alt="" loading="lazy"/></p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2025/png/121356315/1762141199168-0a4a9967-bcda-4bb5-b38f-19a823f6c18d.png" alt="" loading="lazy"/></p>
<p>å¯ä»¥çœ‹å‡ºï¼Œç»å¤§å¤šæ•°OmniThoughtVæ•°æ®é›†ä¸­çš„æ€ç»´é“¾è´¨é‡æé«˜ï¼Œåœ¨éš¾åº¦ä¸Šæ˜æ˜¾å‘ˆç°è¿‘ä¼¼æ­£æ€åˆ†å¸ƒã€‚æˆ‘ä»¬è¿›ä¸€æ­¥ä½¿ç”¨è¯äº‘ç»Ÿè®¡äº†ä»»åŠ¡æ ‡ç­¾ï¼š</p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2025/png/121356315/1762156487602-898b6a00-d6bd-4cad-bd66-ea25b06d3753.png" alt="" loading="lazy"/></p>
<p>ä»æ•°æ®æ ‡ç­¾ç»Ÿè®¡å¯ä»¥çœ‹å‡ºè¯¥æ•°æ®é›†è¦†ç›–å¹¿æ³›çš„é¢†åŸŸä¸»é¢˜å’Œä»»åŠ¡ç±»å‹ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š</p>
<ul>
<li><strong>è§†è§‰ç†è§£</strong>ï¼šå¦‚å¯¹è±¡è¯†åˆ«ï¼ˆ<code>object</code>ï¼‰ã€å±æ€§è§£æï¼ˆ<code>attribute</code>ï¼‰ã€åœºæ™¯ç†è§£ï¼ˆ<code>scene</code>ï¼‰ï¼›</li>
<li><strong>ç©ºé—´æ¨ç†</strong>ï¼šå¦‚ä½ç½®å…³ç³»ï¼ˆ<code>spatial</code>ã€<code>position</code>ã€<code>layout</code>ï¼‰ã€æ–¹å‘ï¼ˆ<code>direction</code>ï¼‰ä¸åæ ‡ï¼ˆ<code>coordinate</code>ï¼‰ï¼›</li>
<li><strong>å›¾è¡¨è§£è¯»</strong>ï¼šæ¶µç›–å¤šç§å¯è§†åŒ–å½¢å¼ï¼ˆ<code>chart</code>ã€<code>graph</code>ã€<code>table</code>ã€<code>bar chart</code>ã€<code>pie chart</code>ã€<code>scatter plot</code>ï¼‰åŠå…¶å…ƒä¿¡æ¯ï¼ˆ<code>axis</code>ã€<code>legend</code>ã€<code>label</code>ã€<code>caption</code>ï¼‰ï¼›</li>
<li><strong>é€»è¾‘æ¨ç†</strong>ï¼šåŒ…æ‹¬è®¡æ•°ï¼ˆ<code>count</code>ï¼‰ã€æ¯”è¾ƒï¼ˆ<code>comparison</code>ï¼‰ã€æ•°å­¦è®¡ç®—ï¼ˆ<code>math</code>ã€<code>algebra</code>ã€<code>geometry</code>ï¼‰ä»¥åŠç»Ÿè®¡æ¦‚å¿µï¼ˆ<code>percentage</code>ã€<code>ratio</code>ã€<code>average</code>ï¼‰ï¼›</li>
<li><strong>é¢†åŸŸçŸ¥è¯†</strong>ï¼šæ¶‰åŠç§‘å­¦ï¼ˆ<code>physics</code>ã€<code>chemistry</code>ã€<code>biology</code>ï¼‰ã€æŠ€æœ¯ï¼ˆ<code>code</code>ã€<code>algorithm</code>ã€<code>electronics</code>ï¼‰ã€äººæ–‡ï¼ˆ<code>history</code>ã€<code>politics</code>ã€<code>literature</code>ï¼‰ç­‰å¤šä¸ªé¢†åŸŸï¼›</li>
<li><strong>åæ€èƒ½åŠ›</strong>ï¼šå¼ºè°ƒäº‹å®æ ¸æŸ¥ï¼ˆ<code>verification</code>ã€<code>fact-check</code>ï¼‰ã€è¯¯å·®è¯†åˆ«ï¼ˆ<code>error</code>ã€<code>discrepancy</code>ï¼‰ä¸ç»†èŠ‚æ•æ„Ÿæ€§ï¼ˆ<code>precision</code>ã€<code>detail</code>ï¼‰ã€‚</li>
</ul>
<h2 data-id="heading-3">å®éªŒæ•ˆæœè¯„æµ‹</h2>
<p>ä¸ºäº†ç³»ç»Ÿæ€§åœ°å¯»æ‰¾æœ€ä¼˜è®­ç»ƒè¶…å‚æ•°ï¼Œæˆ‘ä»¬é‡‡ç”¨ä¸åŒçš„è¶…å‚æ•°ç»„åˆï¼Œå¯¹ Qwen2.5-VL-3B-Instruct æ¨¡å‹åœ¨è§†è§‰æ¨ç†ä»»åŠ¡ä¸Šçš„è¡¨ç°è¿›è¡Œäº†è®­ç»ƒä¸è¯„æµ‹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨ MMMU_pro_vision Benchmark ä¸Šå¼€å±•äº†ä¸€ç³»åˆ—å¾®è°ƒè¶…å‚æ•°çš„å®éªŒã€‚è¯¥åŸºå‡†èƒ½å¤Ÿå…¨é¢ã€æ·±å…¥åœ°è¡¡é‡æ¨¡å‹åœ¨å¤æ‚å›¾åƒç†è§£ä¸å¤šæ­¥é€»è¾‘æ¨ç†æ–¹é¢çš„ç»¼åˆèƒ½åŠ›ã€‚åœ¨æœªè¿›è¡Œä»»ä½•å¾®è°ƒçš„æƒ…å†µä¸‹ï¼ŒåŸå§‹çš„ Qwen2.5-VL-3B-Instruct æ¨¡å‹åœ¨è¯¥åŸºå‡†ä¸Šçš„å¾—åˆ†ä»…ä¸º 0.2130ã€‚æˆ‘ä»¬ä½¿ç”¨çš„Promptæ¨¡ç‰ˆå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">SYSTEM_PROMPT</span>=<span class="hljs-string">"You are a helpful assistant to think step by step. Provide your reasoning steps within &lt;thinking&gt;&lt;/thinking&gt; tags and give your final answer within &lt;answer&gt;&lt;/answer&gt; tags. Final answer requirement: Answer with the option letter from the given choices directly."</span>

<span class="hljs-attr">QUERY_PROMPT</span>=f<span class="hljs-string">"""
### Question

{question}

### Output Format (Strictly Enforced)

&lt;thinking&gt;
Clearly explain your reasoning step by step. Describe how you arrived at the conclusion.
The reasoning process MUST BE enclosed within &lt;thinking&gt; &lt;/thinking&gt; tags.
&lt;/thinking&gt;
&lt;answer&gt;
Your final answer to the user's question.
Answer with the option letter from the given choices directly.
&lt;/answer&gt;
"""</span>
</code></pre>
<p>éšåï¼Œæˆ‘ä»¬å›´ç»•å­¦ä¹ ç‡å’Œè®­ç»ƒè½®æ¬¡ï¼ˆEpochï¼‰è¿™ä¸¤ä¸ªæ ¸å¿ƒè¶…å‚æ•°ï¼Œè®¾è®¡äº†å¤šç»„å¯¹æ¯”å®éªŒï¼Œä»¥æ¢ç´¢å®ƒä»¬å¯¹æ¨¡å‹æœ€ç»ˆæ€§èƒ½çš„å½±å“ã€‚å…·ä½“è€Œè¨€ï¼Œæˆ‘ä»¬æµ‹è¯•äº†å››ç§ä¸åŒçš„å­¦ä¹ ç‡ï¼ˆ5e-6ã€1e-5ã€2e-5ã€4e-5ï¼‰ï¼Œå¹¶åˆ†åˆ«åœ¨ 1 è‡³ 5 ä¸ªè®­ç»ƒè½®æ¬¡ä¸‹è§‚å¯Ÿæ¨¡å‹å¾—åˆ†çš„å˜åŒ–è¶‹åŠ¿ã€‚å®éªŒç»“æœæ˜¾ç¤ºï¼Œä¸åŒè¶…å‚æ•°ç»„åˆå¯¹æ¨¡å‹æ€§èƒ½æœ‰ç€æ˜¾è‘—å½±å“ï¼šä¾‹å¦‚ï¼Œå½“å­¦ä¹ ç‡ä¸º 5e-6ï¼Œä¸”è®­ç»ƒ 4 ä¸ª Epoch æ—¶ï¼Œæ¨¡å‹å–å¾—äº† 0.3220 çš„æœ€ä½³åˆ†æ•°ï¼›è€Œè¾ƒé«˜çš„å­¦ä¹ ç‡ï¼ˆå¦‚ 4e-5ï¼‰åˆ™æ™®éå¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Œè¡¨æ˜è¿‡é«˜çš„å­¦ä¹ ç‡å¯èƒ½ä¸åˆ©äºæ¨¡å‹ç¨³å®šæ”¶æ•›ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬é€‰ç”¨äº† 5e-6 çš„å­¦ä¹ ç‡ï¼Œè®­ç»ƒ 4 ä¸ª Epoch ä½œä¸ºåç»­å®éªŒçš„å¾®è°ƒè®­ç»ƒå‚æ•°ã€‚</p>
<p>å­¦ä¹ ç‡/Epoch</p>
<p>1 Epoch</p>
<p>2 Epochs</p>
<p>3 Epochs</p>
<p>4 Epochs</p>
<p>5 Epochs</p>
<p>5e-6</p>
<p>0.2815</p>
<p>0.2936</p>
<p>0.3116</p>
<p><strong>0.3220</strong></p>
<p>0.3087</p>
<p>1e-5</p>
<p>0.2931</p>
<p>0.3017</p>
<p>0.3093</p>
<p>0.3104</p>
<p>0.3098</p>
<p>2e-5</p>
<p>0.2722</p>
<p>0.2919</p>
<p>0.2977</p>
<p>0.2959</p>
<p>0.3000</p>
<p>4e-5</p>
<p>0.2566</p>
<p>0.2515</p>
<p>0.2671</p>
<p>0.2688</p>
<p>0.2798</p>
<p>ä¸ºäº†æ·±å…¥æ¢ç©¶æ•°æ®ç­›é€‰ç­–ç•¥å¯¹æ¨¡å‹å¾®è°ƒæ•ˆæœçš„å½±å“ï¼Œæˆ‘ä»¬ç³»ç»Ÿæ€§åœ°æµ‹è¯•äº†â€œè´¨é‡â€ï¼ˆQualityï¼‰ä¸â€œéš¾åº¦â€ï¼ˆDifficultyï¼‰æŒ‡æ ‡çš„æ•°æ®è¿‡æ»¤æ¡ä»¶ï¼Œå¹¶åœ¨å‰è¿°å®éªŒçš„æœ€ä½³è¶…å‚æ•°è®¾ç½®ä¸‹è¯„ä¼°å…¶è®­ç»ƒæ€§èƒ½ã€‚æ¯ç»„è¿‡æ»¤æ¡ä»¶å¯¹åº”çš„å¾®è°ƒæ•°æ®é›†å‡ç»Ÿä¸€ä¸º 10 ä¸‡æ¡ã€‚å®éªŒç»“æœè¡¨æ˜ï¼Œå•çº¯ä¾èµ–æ ‡æ³¨è´¨é‡æŒ‡æ ‡è¿›è¡Œè¿‡æ»¤ï¼ˆå¦‚ä»…ä¿ç•™ Quality â‰¥ 5 çš„æ•°æ®ï¼‰åè€Œä¼šå¯¼è‡´æ¨¡å‹æ€§èƒ½è½»å¾®ä¸‹é™ï¼ˆå¾—åˆ† 0.2948ï¼‰ï¼Œç”šè‡³ä½äºæœªç»è¿‡è¿‡æ»¤çš„åŸå§‹æ•°æ®é›†ï¼ˆå¾—åˆ† 0.3093ï¼‰ã€‚è¿™è¯´æ˜é«˜æ ‡æ³¨è´¨é‡æ•°æ®æœªå¿…ç­‰åŒäºé«˜æœ‰æ•ˆæ€§ï¼Œæœ‰æ—¶å¯èƒ½å› è¿‡äºç®€å•æˆ–åŒè´¨åŒ–è€Œå‰Šå¼±æ¨¡å‹çš„å­¦ä¹ èƒ½åŠ›ã€‚ ç›¸åï¼Œå½“å¼•å…¥â€œéš¾åº¦â€æŒ‡æ ‡ä½œä¸ºæ ¸å¿ƒè¿‡æ»¤æ¡ä»¶æ—¶ï¼Œæ¨¡å‹è¡¨ç°æ˜¾è‘—æå‡ï¼šåœ¨ä»…è¦æ±‚ Difficulty â‰¥ 4 çš„æ¡ä»¶ä¸‹ï¼Œæ¨¡å‹å¾—åˆ†è·ƒå‡è‡³ 0.3156ï¼›è€Œå°†é«˜è´¨é‡ä¸é«˜éš¾åº¦ç›¸ç»“åˆï¼ˆQuality â‰¥ 5 ä¸” Difficulty â‰¥ 4ï¼‰æ—¶ï¼Œæ¨¡å‹å¾—åˆ†ä¹Ÿè¾¾åˆ°äº† 0.3139ï¼ŒåŒæ ·ä¼˜äºæ— è¿‡æ»¤åŸºçº¿ã€‚ç”±æ­¤éªŒè¯äº†æˆ‘ä»¬æå‡ºçš„â€œéš¾åº¦â€ä¸â€œæ ‡æ³¨è´¨é‡â€è”åˆè¿‡æ»¤çš„æœ‰æ•ˆæ€§ã€‚åŒæ—¶ä¹Ÿå¾—å‡ºç»“è®ºï¼Œåœ¨å½“å‰ä»»åŠ¡åœºæ™¯ä¸‹ï¼Œä»¥â€œéš¾åº¦â€ä¸ºæ ¸å¿ƒçš„è¿‡æ»¤æœºåˆ¶æ¯”å•çº¯ä¾èµ–â€œæ ‡æ³¨è´¨é‡â€çš„è¿‡æ»¤ç­–ç•¥æ›´ä¸ºæœ‰æ•ˆï¼Œå› ä¸ºå®ƒèƒ½æ›´ç²¾å‡†åœ°ç­›é€‰å‡ºæ—¢èƒ½æŒ‘æˆ˜æ¨¡å‹ã€åˆèƒ½ä¿ƒè¿›å…¶æ¨ç†èƒ½åŠ›æå‡çš„å…³é”®æ ·æœ¬ï¼Œä»è€Œæ›´é«˜æ•ˆåœ°é©±åŠ¨æ¨¡å‹æ€§èƒ½çš„æå‡ã€‚</p>
<p>è¿‡æ»¤æ¡ä»¶</p>
<p>åˆ†æ•°</p>
<p>æ— è¿‡æ»¤Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </p>
<p>0.3093Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </p>
<p>Quality&gt;=5; Difficulty&gt;=0</p>
<p>0.2948</p>
<p>Quality&gt;=0; Difficulty&gt;=4</p>
<p>0.3156</p>
<p>Quality&gt;=5; Difficulty&gt;=4</p>
<p>0.3139</p>
<p>æˆ‘ä»¬åŸºäº Quality â‰¥ 5ï¼ŒDifficulty â‰¥ 4 çš„è¿‡æ»¤æ¡ä»¶ï¼Œç­›é€‰å¾—åˆ°çº¦ 50 ä¸‡æ¡æ•°æ®ï¼Œå¹¶å¯¹ Qwen3-VL 2Bã€4Bã€8B ç‰ˆæœ¬è¿›è¡Œäº†å¾®è°ƒã€‚æˆ‘ä»¬ä½¿ç”¨ LMMs-Eval æ¡†æ¶è¿›è¡Œè¯„æµ‹ã€‚ç”±äºä¸åŒ Prompt è¯„æµ‹æ¨¡æ¿ä¼šå¯¹æµ‹è¯„ç»“æœäº§ç”Ÿå½±å“ï¼Œæˆ‘ä»¬åœ¨è¯„æµ‹è¿‡ç¨‹ä¸­ç»Ÿä¸€å›ºå®šäº†ä¸€å¥—æ¨ç† Promptã€‚å®éªŒç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚ æˆ‘ä»¬æˆåŠŸéªŒè¯äº†æ•°æ®é›†çš„æœ‰æ•ˆæ€§ï¼Œé€šè¿‡æ„å»ºäº†çº¦ 50 ä¸‡æ¡é«˜è´¨é‡ã€é«˜éš¾åº¦çš„è®­ç»ƒæ•°æ®ï¼Œä»¥æ­¤å¾®è°ƒ Qwen3-VL ç³»åˆ—ä¸åŒè§„æ¨¡çš„æ¨¡å‹ï¼ˆ2Bã€4Bã€8Bï¼‰çš„å®éªŒæ•°æ®æ˜¾ç¤ºï¼Œæ— è®ºæ˜¯åœ¨é€šç”¨è§†è§‰ç†è§£èƒ½åŠ› benchmarkï¼ˆå¦‚ AI2Dã€MMStarï¼‰ï¼Œè¿˜æ˜¯åœ¨å¯¹æ¨ç†èƒ½åŠ›æ›´æ•æ„Ÿçš„ benchmarkï¼ˆå¦‚ MMMU_Pro_standardã€MMMU_Pro_visionã€ MathVerseã€ MathVisionï¼‰ä¸Šï¼Œæ‰€æœ‰ç»è¿‡å¾®è°ƒçš„æ¨¡å‹å‡å®ç°äº†æ€§èƒ½æå‡ï¼Œåœ¨å¼ºè°ƒæ¨ç†èƒ½åŠ›çš„ benchmark ä¸Šæå‡å°¤ä¸ºæ˜¾è‘—ã€‚è¿™å……åˆ†è¯æ˜äº†é«˜è´¨é‡æ•°æ®çš„è’¸é¦ã€ç­›é€‰ä¸è§„æ¨¡æ‰©å±•å¯¹æ¨¡å‹æ¨ç†èƒ½åŠ›æå‡çš„æœ‰æ•ˆæ€§ã€‚</p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2025/png/121356315/1764643999457-589b52e4-ae43-430d-a5ff-136308fb4754.png" alt="" loading="lazy"/></p>
<p>ç»¼ä¸Šè€Œè¨€ï¼ŒOmniThoughtV æ•°æ®é›†çš„æ„å»ºæµç¨‹ä¸ä»…éªŒè¯äº†é•¿æ€è€ƒæ€ç»´é“¾æ•°æ®ä¸ä»…èƒ½æå‡æ¨¡å‹åœ¨è§†è§‰æ¨ç†ç­‰ä»»åŠ¡ä¸Šçš„æ¨ç†èƒ½åŠ›ï¼Œä¹ŸéªŒè¯äº†æ¨¡å‹â€œçœ‹å›¾æ·±åº¦æ€è€ƒâ€èƒ½åŠ›çš„æå‡ä¹Ÿèƒ½æé«˜æ¨¡å‹çš„é€šç”¨è§†è§‰ç†è§£èƒ½åŠ›ã€‚OmniThoughtV æ•°æ®é›†å¾ˆå¥½å¼¥è¡¥äº†å¼€æºç¤¾åŒºä¸­å¤§è§„æ¨¡å¤šæ¨¡æ€é•¿æ€è€ƒæ•°æ®é›†çš„åŒ®ä¹ï¼Œä¹Ÿé€šè¿‡ç³»ç»ŸåŒ–çš„æ•°æ®å·¥ç¨‹ï¼Œæä¾›äº†å…¨æµç¨‹æ¸…æ™°ã€å¯å¤ç°çš„å·¥å…·å’ŒæŠ€æœ¯è·¯çº¿ã€‚</p>
<h2 data-id="heading-4">èµ„æºä¸‹è½½å’Œä½¿ç”¨</h2>
<h3 data-id="heading-5">åœ¨EasyDistillæ¡†æ¶çš„ä½¿ç”¨æ•™ç¨‹</h3>
<p>é€šè¿‡ä½¿ç”¨é˜¿é‡Œäº‘äººå·¥æ™ºèƒ½å¹³å°ï¼ˆPAIï¼‰æ¨å‡ºçš„å¼€æºå·¥å…·åŒ…<a href="https://link.juejin.cn?target=https%3A%2F%2Fx.sm.cn%2F6S37TIT%3Fspm%3Da2c6h.13046898.publish-article.17.56436ffakS8ykA" target="_blank" title="https://x.sm.cn/6S37TIT?spm=a2c6h.13046898.publish-article.17.56436ffakS8ykA" ref="nofollow noopener noreferrer">EasyDistill</a> ï¼Œç”¨æˆ·å¯ä»¥è½»æ¾å®ç°å®ç°å¤šæ¨¡æ€æ€ç»´é“¾æ•°æ®çš„è’¸é¦ã€å¯¹æ€ç»´é“¾æ•°æ®æ‰“åˆ†ã€‚</p>
<p>1. å…‹éš†ä»£ç åº“ï¼Œå¹¶å®‰è£…ç›¸å…³ä¾èµ–ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">clone</span> https://github.com/modelscope/easydistill
<span class="hljs-built_in">cd</span> EasyDistill
pip install -r requirements.txt
</code></pre>
<p>2. å¯ä»¥ä½¿ç”¨å„ç§é…ç½®æ–‡ä»¶ç”Ÿæˆè®­ç»ƒæ•°æ®ï¼Œä»¥æ€ç»´é“¾æ•°æ®ç”Ÿæˆä¸ºä¾‹ï¼Œé…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"job_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"mmkd_black_box_api"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"dataset"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"instruction_path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"data/mllm_demo.json"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"labeled_path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"data/mllm_demo_distill.json"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"seed"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">42</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"inference"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"base_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ENDPOINT"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"api_key"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"TOKEN"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"system_prompt"</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">"You are a helpful assistant."</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"max_new_tokens"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">512</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"models"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"student"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"student/Qwen/Qwen3-VL-2B-Instruct/"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"training"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"output_dir"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./result/"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"num_train_epochs"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"per_device_train_batch_size"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"gradient_accumulation_steps"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"max_length"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">512</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"save_steps"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1000</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"logging_steps"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"learning_rate"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2e-5</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"weight_decay"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.05</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"warmup_ratio"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lr_scheduler_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cosine"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>3. å®Œæˆæ€ç»´é“¾æ•°æ®ç”Ÿæˆåï¼Œå¯ä»¥ä½¿ç”¨æ€ç»´é“¾è¯„ä»·æ‰“åˆ†åŠŸèƒ½ï¼Œé…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"job_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"mmcot_eval_api"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"dataset"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"input_path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cot_input.json"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"output_path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cot_output.json"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"inference"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"base_url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://dashscope.aliyuncs.com/compatible-mode/v1"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"api_key"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"YOUR KEY"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"max_new_tokens"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8196</span>
    <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå³å¯å®Œæˆå¯¹cotæ•°æ®è´¨é‡çš„è¯„ä»·æ‰“åˆ†ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">export</span> JUDGE_MODEL=qwen3-vl-plus

easydistill --config mmcot_eval_api.json
</code></pre>
<p>è¯¦ç»†ç”¨æ³•å¯ä»¥å‚è€ƒ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmodelscope%2Feasydistill%2Fblob%2Fmain%2Fdocs%2FCoT_Eval.md" target="_blank" title="https://github.com/modelscope/easydistill/blob/main/docs/CoT_Eval.md" ref="nofollow noopener noreferrer">github.com/modelscope/â€¦</a></p>
<h3 data-id="heading-6">ä»HuggingFace/ModelScopeä¸‹è½½èµ„æº</h3>
<p>æˆ‘ä»¬çš„å…¬å¼€çš„æ•°æ®çº¦180ä¸‡æ¡åŸå§‹æ•°æ®é›†å’Œ50ä¸‡æ¡ç­›é€‰åçš„æ•°æ®é›†ã€‚æ¯ä¸€æ¡æ•°æ®éƒ½å¸¦æœ‰è¯„åˆ†ã€‚ç­›é€‰åçš„æ•°æ®é›†æ˜¯éš¾åº¦å¤§äºç­‰äº4åˆ†ï¼Œè´¨é‡å¤§äºç­‰äº5åˆ†çš„æ•°æ®ã€‚æ•°æ®é›†ä¸­çš„å›¾åƒé‡‡ç”¨base64ç¼–ç å‚¨å­˜ã€‚</p>
<p>æ•°æ®é›†</p>
<p>HuggingFace</p>
<p>ModelScope</p>
<p>OmmiThoughtV_Raw_1.8M</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhuggingface.co%2Fdatasets%2Falibaba-pai%2FOmmiThoughtV_Raw_1.8M" target="_blank" title="https://huggingface.co/datasets/alibaba-pai/OmmiThoughtV_Raw_1.8M" ref="nofollow noopener noreferrer">huggingface.co/datasets/alâ€¦</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelscope.cn%2Fdatasets%2Fplatformofai%2FOmniThoughtV_Raw_1.8M" target="_blank" title="https://modelscope.cn/datasets/platformofai/OmniThoughtV_Raw_1.8M" ref="nofollow noopener noreferrer">modelscope.cn/datasets/plâ€¦</a></p>
<p>OmniThoughtV_Filter_0.5M</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fhuggingface.co%2Fdatasets%2Falibaba-pai%2FOmniThoughtV_Filter_0.5M" target="_blank" title="https://huggingface.co/datasets/alibaba-pai/OmniThoughtV_Filter_0.5M" ref="nofollow noopener noreferrer">huggingface.co/datasets/alâ€¦</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelscope.cn%2Fdatasets%2Fplatformofai%2FOmniThoughtV_Filter_0.5M" target="_blank" title="https://modelscope.cn/datasets/platformofai/OmniThoughtV_Filter_0.5M" ref="nofollow noopener noreferrer">modelscope.cn/datasets/plâ€¦</a></p>
<p>å¯ä»¥å‚è€ƒä»¥ä¸‹ä»£ç è¯»å–æ•°æ®é›†ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">from datasets import load_dataset 

<span class="hljs-attr">data_path</span>=<span class="hljs-string">'...YOUR_PATH_To.../OmmiThoughtV_Raw_1.8M/'</span>
<span class="hljs-attr">OmmiThoughtV</span>=load_dataset(data_path, streaming=<span class="hljs-literal">True</span>)
</code></pre>
<h2 data-id="heading-7">åœºæ™¯åŒ–åº”ç”¨</h2>
<p>é™¤äº†å…¸å‹çš„å¤šæ¨¡æ€ä»»åŠ¡ï¼Œæˆ‘ä»¬æå‡ºçš„è’¸é¦æ–¹æ³•å¯ä»¥æœ‰æ•ˆåº”ç”¨äºå„ç§å®é™…åœºæ™¯ä¸­ï¼Œä»¥ä¸‹æˆ‘ä»¬ç»™å‡ºå¤šä¸ªå¤šæ¨¡æ€æ·±åº¦æ€è€ƒä»»åŠ¡çš„å…¸å‹åº”ç”¨ã€‚</p>
<h3 data-id="heading-8">è‡ªåŠ¨é©¾é©¶</h3>
<p>é—®é¢˜ï¼šä½ éœ€è¦å³è½¬ï¼Œè¯·åŸºäºå½“å‰å›¾åƒä¸­çš„é“è·¯ç¯å¢ƒå’Œäº¤é€šçŠ¶å†µï¼Œè¯·åˆ†æå¹¶è§„åˆ’ä½ ï¼ˆè‡ªåŠ¨é©¾é©¶è½¦è¾†ï¼‰ä¸‹ä¸€æ­¥çš„æœ€ä¼˜é©¾é©¶ç­–ç•¥ã€‚</p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2025/png/121356315/1764750363196-c5d7d65c-1c58-4327-87ca-edfb42776464.png" alt="" loading="lazy"/></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">thinking</span>&gt;</span></span>
<span class="hljs-bullet">1.</span> <span class="hljs-strong">**è¯„ä¼°é“è·¯ç¯å¢ƒ**</span>ï¼šå›¾åƒæ˜¾ç¤ºäº†ä¸€æ¡å¤šè½¦é“çš„åŸå¸‚é“è·¯ï¼Œäº¤é€šç¹å¿™ï¼Œå‰æ–¹æœ‰å¤§å‹ç»¿è‰²è‡ªå¸å¡è½¦å’Œä¸€è¾†ç™½è‰²è½¿è½¦ã€‚é“è·¯ä¸¤ä¾§æœ‰é«˜å±‚å»ºç­‘ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªå¯†é›†çš„åŸå¸‚åŒºåŸŸã€‚é“è·¯ç”±é»„è‰²éš”ç¦»æ åˆ†éš”ï¼Œè¡¨æ˜è½¦æµå—åˆ°ç®¡æ§ã€‚

<span class="hljs-bullet">2.</span> <span class="hljs-strong">**è¯†åˆ«å½“å‰è½¦é“åŠäº¤é€šæµ**</span>ï¼šè½¦è¾†ä½äºä¸­é—´è½¦é“ï¼Œè¯¥è½¦é“ä¼¼ä¹æ˜¯ç›´è¡Œè½¦é“ã€‚å›¾åƒä¸­æœªè§æ˜æ˜¾çš„å³è½¬è½¦é“æˆ–è½¬å¼¯ä¿¡å·æŒ‡ç¤ºï¼Œå› æ­¤å³è½¬å¹¶ä¸ç«‹å³å¯è¡Œã€‚ç›¸é‚»è½¦é“æœ‰å¤§å‹å¡è½¦ï¼Œè¡¨æ˜è½¬å¼¯æ—¶éœ€è°¨æ…æ“ä½œä»¥é¿å…ç¢°æ’ã€‚

<span class="hljs-bullet">3.</span> <span class="hljs-strong">**è¯„ä¼°å³è½¬å¯è¡Œæ€§**</span>ï¼šå‰æ–¹é“è·¯çœ‹èµ·æ¥æ˜¯ç›´è¡Œçš„ï¼Œæœªè§æ˜æ˜¾çš„å³è½¬è½¦é“æˆ–è½¬å¼¯ä¿¡å·æ ‡å¿—ã€‚ç›¸é‚»è½¦é“çš„å¤§å‹å¡è½¦è¡¨æ˜ï¼Œè‹¥è¦è½¬å¼¯ï¼Œéœ€è¦å°å¿ƒæ“ä½œä»¥é¿å…ç¢°æ’ã€‚é»„è‰²éš”ç¦»æ è¡¨æ˜é“è·¯ä¸ºåˆ†éš”å¼è®¾è®¡ï¼Œè½¬å¼¯å¯èƒ½éœ€è¦é©¶ç¦»å½“å‰è½¦é“ã€‚

<span class="hljs-bullet">4.</span> <span class="hljs-strong">**è€ƒè™‘äº¤é€šæ³•è§„ä¸å®‰å…¨æ€§**</span>ï¼šå›¾åƒä¸­æ˜¾ç¤ºäº†ä¸€ä¸ªâ€œ40â€çš„é™é€Ÿæ ‡å¿—ï¼Œè¡¨æ˜é™é€Ÿä¸º40å…¬é‡Œ/å°æ—¶ã€‚å¤§å‹å¡è½¦çš„å­˜åœ¨æç¤ºè½¦è¾†åº”ä¿æŒå®‰å…¨è½¦è·ï¼Œé¿å…çªç„¶å˜é“æˆ–è½¬å‘ã€‚é»„è‰²éš”ç¦»æ è¿›ä¸€æ­¥è¯´æ˜é“è·¯ä¸ºåˆ†éš”è®¾è®¡ï¼Œè½¬å¼¯å¯èƒ½éœ€æå‰å˜é“ã€‚

<span class="hljs-bullet">5.</span> <span class="hljs-strong">**è§„åˆ’æœ€ä¼˜é©¾é©¶ç­–ç•¥**</span>ï¼šåŸºäºå½“å‰çš„é“è·¯ç¯å¢ƒå’Œäº¤é€šçŠ¶å†µï¼Œä½œä¸ºè‡ªåŠ¨é©¾é©¶è½¦è¾†ï¼Œä¸‹ä¸€æ­¥çš„æœ€ä¼˜é©¾é©¶ç­–ç•¥åº”ä¸ºï¼š
<span class="hljs-bullet">   -</span> <span class="hljs-strong">**ä¿æŒå½“å‰è½¦é“**</span>ï¼Œç»§ç»­ç›´è¡Œï¼Œç›´åˆ°åˆ°è¾¾æŒ‡å®šçš„å³è½¬è½¦é“æˆ–äº¤å‰è·¯å£ã€‚
<span class="hljs-bullet">   -</span> <span class="hljs-strong">**æŒç»­ç›‘æµ‹äº¤é€šçŠ¶å†µ**</span>ï¼Œç¡®ä¿æœ‰è¶³å¤Ÿç©ºé—´å®‰å…¨å®Œæˆå³è½¬ã€‚
<span class="hljs-bullet">   -</span> <span class="hljs-strong">**åˆ©ç”¨è½¦è¾†çš„ä¼ æ„Ÿå™¨å’Œæ‘„åƒå¤´**</span>ï¼Œæ¢æµ‹å‘¨å›´ç¯å¢ƒä¸­å¯èƒ½å­˜åœ¨çš„éšœç¢ç‰©æˆ–å±é™©ã€‚
<span class="hljs-bullet">   -</span> <span class="hljs-strong">**éµå®ˆäº¤é€šæ³•è§„**</span>ï¼Œä¸å…¶ä»–è½¦è¾†ä¿æŒå®‰å…¨è·ç¦»ã€‚
<span class="hljs-bullet">   -</span> <span class="hljs-strong">**ä»…åœ¨å®‰å…¨ä¸”åˆæ³•çš„æƒ…å†µä¸‹æ‰§è¡Œå³è½¬**</span>ï¼Œç¡®ä¿ä¸é˜»ç¢å…¶ä»–è½¦è¾†æ­£å¸¸é€šè¡Œã€‚

<span class="hljs-bullet">6.</span> <span class="hljs-strong">**ç»“è®º**</span>ï¼šä½œä¸ºè‡ªåŠ¨é©¾é©¶è½¦è¾†ï¼Œä¸‹ä¸€æ­¥çš„æœ€ä¼˜é©¾é©¶ç­–ç•¥æ˜¯ä¿æŒå½“å‰è½¦é“ç»§ç»­ç›´è¡Œï¼Œç›´è‡³åˆ°è¾¾æŒ‡å®šçš„å³è½¬è½¦é“æˆ–äº¤å‰è·¯å£ï¼ŒåŒæ—¶å¯†åˆ‡è§‚å¯Ÿäº¤é€šçŠ¶å†µï¼Œç¡®ä¿æœ‰å……è¶³ç©ºé—´å®‰å…¨å®Œæˆå³è½¬ã€‚
<span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">thinking</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">answer</span>&gt;</span></span>
ä¿æŒå½“å‰è½¦é“ç»§ç»­ç›´è¡Œï¼Œç›´è‡³åˆ°è¾¾æŒ‡å®šçš„å³è½¬è½¦é“æˆ–äº¤å‰è·¯å£ï¼ŒåŒæ—¶ç›‘æµ‹äº¤é€šçŠ¶å†µå¹¶ç¡®ä¿æœ‰è¶³å¤Ÿç©ºé—´å®‰å…¨å®Œæˆå³è½¬ã€‚
<span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">answer</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-9">æ–‡ç‰©è®²è§£</h3>
<p>å‡å¦‚ä½ æ˜¯åšç‰©é¦†è®²è§£å‘˜ï¼Œåˆ†ææ­¤é™¶å™¨å†å²èƒŒæ™¯ã€‚</p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2025/png/121356315/1764754311247-215e2127-d3a3-4add-b125-67912249b27f.png" alt="" loading="lazy"/></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">thinking</span>&gt;</span>
ç¬¬ä¸€æ­¥ï¼šåˆ†æè¯¥é™¶å™¨çš„è§†è§‰ç‰¹å¾ã€‚å™¨ç‰©æ‹¥æœ‰ç»†é•¿çš„é¢ˆéƒ¨å’Œåœ†é¼“çš„è…¹éƒ¨ï¼Œè¿™ç§å™¨å‹åœ¨ä¸œäºšé™¶ç“·ä¼ ç»Ÿä¸­ååˆ†å¸¸è§ã€‚å™¨è¡¨è£…é¥°æœ‰é£æ ¼åŒ–çš„é±¼çº¹å’ŒèŠ±å‰å›¾æ¡ˆï¼Œè¡¨æ˜å…¶ç”¨é€”æ›´åå‘è±¡å¾æ€§æˆ–è£…é¥°æ€§ï¼Œè€Œéæ—¥å¸¸å®ç”¨ã€‚  

ç¬¬äºŒæ­¥ï¼šè€ƒå¯Ÿé‡‰é¢ä¸è¡¨é¢è´¨æ„Ÿã€‚é‡‰è‰²å‘ˆæŸ”å’Œçš„åœŸè‰²è°ƒï¼Œç•¥å¸¦æ–‘é©³æˆ–ç ‚è´¨æ„Ÿï¼Œè¿™è¡¨æ˜å®ƒå¾ˆå¯èƒ½é‡‡ç”¨å¤©ç„¶é™¶åœŸï¼Œå¹¶ä»¥ä½æ¸©æˆ–åŠçƒ§åˆ¶å·¥è‰ºåˆ¶æˆâ€”â€”è¿™åœ¨å¤ä»£æœé²œé™¶ç“·ä¸­é¢‡ä¸ºå…¸å‹ã€‚é‡‰é¢å‘ˆç°è“è‰²è°ƒï¼Œè¯´æ˜ä½¿ç”¨äº†å«é“é‡è¾ƒé«˜çš„é™¶åœŸï¼Œå¹¶é‡‡ç”¨äº†è¿˜åŸç„°çƒ§åˆ¶å·¥è‰ºï¼Œè¿™ç§æŠ€æ³•åœ¨æœé²œé™¶å™¨ä¸­å¸¸ç”¨äºè¥é€ å«è“„è€Œå…¸é›…çš„è§†è§‰æ•ˆæœã€‚  

ç¬¬ä¸‰æ­¥ï¼šæ¨æµ‹å†å²æ—¶æœŸã€‚å…·å¤‡æ­¤ç±»ç‰¹å¾ï¼ˆé±¼çº¹ã€ç ‚è´¨æ„Ÿã€ç°è“é‡‰ï¼‰çš„é™¶å™¨ï¼Œä¸é«˜ä¸½ç‹æœï¼ˆ918â€“1392å¹´ï¼‰å°¤å…¶æ˜¯æ™šæœŸï¼ˆ12è‡³13ä¸–çºªï¼‰çš„æœé²œé™¶å™¨é£æ ¼ç›¸ç¬¦ã€‚è¿™ä¸€æ—¶æœŸï¼Œæœé²œé™¶å·¥å‘å±•å‡ºç‹¬å…·ç‰¹è‰²çš„é£æ ¼ï¼ŒåŒ…æ‹¬è‘—åçš„â€œç²‰é’æ²™å™¨â€ï¼ˆbuncheongæˆ–powder-blue wareï¼‰ï¼Œå¸¸é¥°ä»¥ç²¾å·§çš„æ‰‹ç»˜çº¹æ ·å’ŒæŸ”å’ŒåŠé€æ˜çš„é‡‰é¢ã€‚é±¼çº¹å¯èƒ½è±¡å¾å¯Œè¶³ã€å¤šäº§æˆ–ä¸è‡ªç„¶å’Œè°å…±å¤„ï¼Œè¿™äº›ä¸»é¢˜åœ¨æœé²œè‰ºæœ¯ä¸­ååˆ†å¸¸è§ã€‚  

ç¬¬å››æ­¥ï¼šè€ƒè™‘æ–‡åŒ–èƒŒæ™¯ã€‚æ­¤å™¨ç‰©çš„è®¾è®¡ä¸å·¥è‰ºè¡¨æ˜ï¼Œå®ƒå¾ˆå¯èƒ½ç”¨äºç¤¼ä»ªæˆ–ç¥­ç¥€åœºåˆï¼Œä¾‹å¦‚ç››è£…é…’æˆ–æ°´ï¼Œä¹Ÿå¯èƒ½æ˜¯è´µæ—å®¶åº­ä¸­çš„é™ˆè®¾å“ã€‚é±¼ä¸èŠ±å‰å…ƒç´ çš„ç»“åˆï¼Œåæ˜ äº†å½“æ—¶æœé²œç¤¾ä¼šå´‡å°šå¹³è¡¡ã€å’Œè°ä»¥åŠè‡ªç„¶å´‡æ‹œçš„æ–‡åŒ–ä»·å€¼è§‚ã€‚  

ç¬¬äº”æ­¥ï¼šç»“åˆåšç‰©é¦†è¯­å¢ƒã€‚è¯¥æ–‡ç‰©è¢«ç½®äºç»ç’ƒå±•æŸœä¸­é™ˆåˆ—ï¼Œè¯´æ˜å…¶å…·æœ‰é‡è¦çš„å†å²ä¸æ–‡åŒ–ä»·å€¼ã€‚å…¶ä¿å­˜çŠ¶æ€ä¸å±•ç¤ºæ–¹å¼è¡¨æ˜ï¼Œå®ƒæ˜¯æœé²œä¸°å¯Œé™¶ç“·é—äº§ä¸­çš„ä¸€ä»¶çè´µä»£è¡¨ï¼Œå¾ˆå¯èƒ½åˆ¶ä½œäºé«˜ä¸½ç‹æœæ™šæœŸã€‚  

ç»“è®ºï¼šç»¼åˆå…¶è§†è§‰ç‰¹å¾ä¸å†å²èƒŒæ™¯ï¼Œè¿™ä»¶é™¶å™¨å¾ˆå¯èƒ½æ˜¯ä¸€ä»¶é«˜ä¸½ç‹æœæ™šæœŸçš„ä½œå“ï¼Œé‡‡ç”¨ä¼ ç»Ÿæœé²œåˆ¶é™¶æŠ€è‰ºåˆ¶ä½œè€Œæˆï¼Œå¹¶é¥°æœ‰è±¡å¾æ€§çš„çº¹æ ·ï¼Œä½“ç°äº†å½“æ—¶æœé²œé™¶å·¥åœ¨é™¶ç“·è‰ºæœ¯ä¸Šçš„é«˜åº¦æˆå°±ä¸æ–‡åŒ–å†…æ¶µã€‚  
<span class="hljs-tag">&lt;/<span class="hljs-name">thinking</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">answer</span>&gt;</span> 
è¿™ä»¶é™¶å™¨å¾ˆå¯èƒ½æºè‡ªæœé²œé«˜ä¸½ç‹æœæ™šæœŸï¼ˆ918â€“1392å¹´ï¼‰ï¼Œè¯¥æ—¶æœŸä»¥ç²¾è‡´çš„é™¶ç“·è‰ºæœ¯è‘—ç§°ã€‚å™¨ç‰©ç»†é¢ˆé¼“è…¹çš„é€ å‹ï¼Œè¾…ä»¥é£æ ¼åŒ–çš„é±¼çº¹ä¸èŠ±å‰å›¾æ¡ˆï¼Œè¡¨æ˜å…¶ç”¨é€”åå‘ç¤¼ä»ªæ€§æˆ–è£…é¥°æ€§ã€‚å…¶ç ‚è´¨è‚Œç†ä¸ç°è“è‰²é‡‰é¢ï¼Œåæ˜ å‡ºå½“æ—¶æœé²œé™¶å·¥é‡‡ç”¨å«é“é™¶åœŸåŠä¼ ç»Ÿè¿˜åŸç„°çƒ§åˆ¶å·¥è‰ºçš„å…¸å‹æŠ€æ³•ã€‚é±¼çº¹å¯èƒ½è±¡å¾å¯Œè¶³æˆ–ä¸è‡ªç„¶çš„å’Œè°ï¼Œä½“ç°äº†å½“æ—¶çš„ä¸»æµæ–‡åŒ–ä»·å€¼è§‚ã€‚æ­¤å™¨è¢«åšç‰©é¦†çè—å¹¶å±•å‡ºï¼Œå½°æ˜¾äº†å®ƒä½œä¸ºæœé²œé™¶ç“·è‰ºæœ¯ç‘°å®çš„é‡è¦å†å²ä¸æ–‡åŒ–æ„ä¹‰ã€‚
<span class="hljs-tag">&lt;/<span class="hljs-name">answer</span>&gt;</span>
</code></pre>
<h3 data-id="heading-10">è‡ªåŠ¨å•†å“å®¡æ ¸</h3>
<p>è¿™æ˜¯ç”¨æˆ·å‘æ¥çš„å•†å“å›¾ï¼Œå¹¶ç”³è¯·äº†è‡ªåŠ¨é€€æ¬¾ï¼Œè¯·å®¡æ ¸æ˜¯å¦æ»¡è¶³é€€æ¬¾è¦æ±‚ã€‚</p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2025/png/121356315/1764754920438-0696046b-9133-4cae-a8b3-f243af2f114e.png" alt="" loading="lazy"/></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">thinking</span>&gt;</span>
å›¾ç‰‡æ˜¾ç¤ºäº†ä¸€ç›’æ©™å­ï¼Œå…¶ä¸­ä¸€ä¸ªæ©™å­è¡¨é¢æ˜æ˜¾é•¿æœ‰éœ‰èŒï¼ˆç°ç»¿è‰²æ–‘å—ï¼‰ã€‚æ°´æœä¸Šå‡ºç°éœ‰èŒæ˜¯å˜è´¨çš„æ˜ç¡®æ ‡å¿—ï¼Œé€šå¸¸è¢«è§†ä¸ºç¼ºé™·ï¼Œä¼šä½¿è¯¥äº§å“ä¸ç¬¦åˆæ–°é²œä¸”å®‰å…¨é£Ÿç”¨çš„æ ‡å‡†ã€‚

å¤§å¤šæ•°çº¿ä¸Šæˆ–é›¶å”®è´­ä¹°çš„æ ‡å‡†é€€æ¬¾æ”¿ç­–éƒ½åŒ…å«é’ˆå¯¹å˜è´¨ã€æŸåæˆ–ä¸æè¿°ä¸ç¬¦å•†å“çš„æ¡æ¬¾ã€‚ç”±äºéœ‰èŒæ¸…æ™°å¯è§ï¼Œå½±å“äº†äº§å“çš„è´¨é‡å’Œå®‰å…¨æ€§ï¼Œå› æ­¤ç¬¦åˆå…¸å‹æ¶ˆè´¹è€…ä¿æŠ¤æ”¿ç­–ä¸‹çš„é€€æ¬¾æ¡ä»¶ã€‚

å› æ­¤ï¼Œåº”æ‰¹å‡†é€€æ¬¾è¯·æ±‚ã€‚
<span class="hljs-tag">&lt;/<span class="hljs-name">thinking</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">answer</span>&gt;</span> 
æ˜¯çš„ï¼Œé€€æ¬¾æ¡ä»¶å·²æ»¡è¶³ï¼Œå› ä¸ºæ©™å­è¡¨é¢å¯è§éœ‰èŒï¼Œè¡¨æ˜å…¶å·²å˜è´¨ï¼Œä¸å†ç¬¦åˆæ–°é²œä¸”å®‰å…¨é£Ÿç”¨çš„æ ‡å‡†ã€‚
<span class="hljs-tag">&lt;/<span class="hljs-name">answer</span>&gt;</span> 
</code></pre>
<h2 data-id="heading-11">å°ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº†OmniThoughtVæ•°æ®é›†ï¼Œè¿™æ˜¯é¦–ä¸ªå¼€æºçš„å¤§è§„æ¨¡å¤šæ¨¡æ€é•¿æ€è€ƒè’¸é¦æ•°æ®é›†ã€‚æˆ‘ä»¬å®Œæ•´æ„å»ºäº†ä¸€å¥—é€æ˜ã€å¯å¤ç°ã€é«˜è´¨é‡çš„å¤šæ¨¡æ€æ•°æ®è’¸é¦ä¸ç­›é€‰æµç¨‹ï¼Œå¹¶ç³»ç»ŸéªŒè¯äº†å…¶åœ¨æå‡å¤šæ¨¡æ€å¤§æ¨¡å‹è§†è§‰æ¨ç†èƒ½åŠ›æ–¹é¢çš„å…³é”®ä½œç”¨ã€‚æˆ‘ä»¬é€šè¿‡ä¸¥è°¨çš„æ¶ˆèå®éªŒï¼Œé¦–æ¬¡æ˜ç¡®æŒ‡å‡ºâ€œéš¾åº¦â€æŒ‡æ ‡åœ¨æ•°æ®ç­›é€‰ä¸­çš„æ ¸å¿ƒä»·å€¼ï¼šç›¸è¾ƒäºå•çº¯ä¾èµ–æ ‡æ³¨è´¨é‡è¯„åˆ†ï¼Œå¼•å…¥é«˜éš¾åº¦æ ·æœ¬èƒ½æ›´æœ‰æ•ˆåœ°é©±åŠ¨æ¨¡å‹å­¦ä¹ å¤æ‚æ¨ç†é€»è¾‘ï¼Œä»è€Œæ˜¾è‘—æå‡æ³›åŒ–æ€§èƒ½ã€‚åŸºäºè¿™ä¸€å‘ç°ï¼Œæˆ‘ä»¬è®¾è®¡äº†å®Œæ•´çš„æ•°æ®è¿‡æ»¤æ ‡å‡†ï¼Œä»åŸå§‹æ•°æ®é›†ä¸­ç²¾å‡†æç‚¼å‡ºçº¦50ä¸‡æ¡å…¼å…·æŒ‘æˆ˜æ€§ä¸ä»£è¡¨æ€§çš„è®­ç»ƒæ ·æœ¬ï¼Œå¹¶æˆåŠŸæå‡äº†Qwen3-VLç³»åˆ—çš„æ€§èƒ½è¡¨ç°ã€‚å®éªŒç»“æœè¡¨æ˜ï¼Œè¯¥æ•°æ®æµç¨‹ä¸ä»…ä½¿å„æ¨¡å‹åœ¨å¤šä¸ªæƒå¨è¯„æµ‹é›†ä¸Šå®ç°ç¨³å®šä¸”æ˜¾è‘—çš„èƒ½åŠ›è·ƒå‡ï¼Œæ›´å±•ç°å‡ºè‰¯å¥½çš„æ¨¡å‹è§„æ¨¡æ‰©å±•æ€§ã€‚æœ¬å·¥ä½œå¡«è¡¥äº†å½“å‰å¼€æºç¤¾åŒºåœ¨ç»“æ„åŒ–ã€å¯å¤ç°ã€é¢å‘æ¨ç†èƒ½åŠ›æå‡çš„å¤šæ¨¡æ€æ•°æ®è’¸é¦ä¸Šçš„ç©ºç™½ï¼›åœ¨æœªæ¥ï¼Œæˆ‘ä»¬ä¼šç»§ç»­æ·±å…¥æ¢ç´¢å¤§æ¨¡å‹çš„è’¸é¦å’Œè®­ç»ƒæŠ€æœ¯ï¼Œæ¨åŠ¨å¤§æ¨¡å‹åœ¨å„ä¸ªåœºæ™¯çš„è½åœ°ã€‚</p>
<h2 data-id="heading-12">å‚è€ƒå·¥ä½œ</h2>
<p>EasyDistillç³»åˆ—ç›¸å…³è®ºæ–‡</p>
<ul>
<li>
<p>Wenrui Cai, Chengyu Wang, Junbing Yan, Jun Huang, Xiangzhong Fang. Reasoning with OmniThought: A Large CoT Dataset with Verbosity and Cognitive Difficulty Annotations. arXiv preprint</p>
</li>
<li>
<p>Yuanjie Lyu, Chengyu Wang, Jun Huang, Tong Xu. From Correction to Mastery: Reinforced Distillation of Large Language Model Agents. arXiv preprint</p>
</li>
<li>
<p>Chengyu Wang, Junbing Yan, Wenrui Cai, Yuanhao Yue, Jun Huang. EasyDistill: A Comprehensive Toolkit for Effective Knowledge Distillation of Large Language Models. <strong>EMNLP 2025</strong></p>
</li>
<li>
<p>Wenrui Cai, Chengyu Wang, Junbing Yan, Jun Huang, Xiangzhong Fang. Thinking with DistilQwen: A Tale of Four Distilled Reasoning and Reward Model Series. <strong>EMNLP 2025</strong></p>
</li>
<li>
<p>Wenrui Cai, Chengyu Wang, Junbing Yan, Jun Huang, Xiangzhong Fang. Enhancing Reasoning Abilities of Small LLMs with Cognitive Alignment. <strong>EMNLP 2025</strong></p>
</li>
<li>
<p>Chengyu Wang, Junbing Yan, Yuanhao Yue, Jun Huang. DistilQwen2.5: Industrial Practices of Training Distilled Open Lightweight Language Models. <strong>ACL 2025</strong></p>
</li>
<li>
<p>Yuanhao Yue, Chengyu Wang, Jun Huang, Peng Wang. Building a Family of Data Augmentation Models for Low-cost LLM Fine-tuning on the Cloud. <strong>COLING 2025</strong></p>
</li>
<li>
<p>Yuanhao Yue, Chengyu Wang, Jun Huang, Peng Wang. Distilling Instruction-following Abilities of Large Language Models with Task-aware Curriculum Planning. <strong>EMNLP 2024</strong></p>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆä¸å¿…â€œæ´»å¾—æ˜ç™½â€ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7585377128490123316</link>    <guid>https://juejin.cn/post/7585377128490123316</guid>    <pubDate>2025-12-19T10:57:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585377128490123316" data-draft-id="7585394082822815778" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆä¸å¿…â€œæ´»å¾—æ˜ç™½â€ï¼Ÿ"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-19T10:57:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ—©å‘ç™½å¸åŸ"/> <meta itemprop="url" content="https://juejin.cn/user/4108219946906760"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆä¸å¿…â€œæ´»å¾—æ˜ç™½â€ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4108219946906760/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ—©å‘ç™½å¸åŸ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T10:57:14.000Z" title="Fri Dec 19 2025 10:57:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸ºä»€ä¹ˆä¸å¿…â€œæ´»å¾—æ˜ç™½â€ï¼Ÿ</h2>
<p>æˆ‘ä»¬è¿™ä¸ªæ—¶ä»£ï¼Œå¤ªæ¨å´‡â€œæ˜ç™½â€äº†ã€‚<br/>
æ˜ç™½è‡ªå·±è¦ä»€ä¹ˆï¼Œæ˜ç™½ä¸–ç•Œçš„è§„åˆ™ï¼Œæ˜ç™½äººæ€§çš„å¤æ‚ï¼Œ<br/>
ç”šè‡³è¿ç—›è‹¦ï¼Œä¹Ÿè¦ç—›å¾—æœ‰é“ç†ã€‚</p>
<p>å¯æœ‰æ²¡æœ‰å¯èƒ½â€”â€”<br/>
<strong>äººä¸å¿…æ´»å¾—é‚£ä¹ˆæ˜ç™½ã€‚</strong></p>
<h3 data-id="heading-1">ä¸€ã€å¤ªæ˜ç™½çš„äººï¼Œå¾€å¾€æ›´éš¾å¿«ä¹</h3>
<p>â€œæ´»å¾—æ˜ç™½â€å¬èµ·æ¥åƒä¸€ç§æˆç†Ÿï¼Œ<br/>
ä½†å¾ˆå¤šæ—¶å€™ï¼Œå®ƒæ›´åƒä¸€ç§<strong>è¿‡æ—©çš„æ¸…é†’</strong>ã€‚</p>
<p>ä½ ä¸€æ—¦æ˜ç™½äº†ï¼š</p>
<ul>
<li>åŠªåŠ›ä¸ä¸€å®šæœ‰å›æŠ¥</li>
<li>å–„è‰¯ä¸ä¸€å®šè¢«çæƒœ</li>
<li>è§„åˆ™å¾€å¾€ä¸ä¸ºæ™®é€šäººè€Œè®¾</li>
</ul>
<p>ä½ å°±å¾ˆéš¾å†å¤©çœŸåœ°æœŸå¾…ä»€ä¹ˆã€‚</p>
<p>åœ¨ã€Šç¬¬ä¸ƒå¤©ã€‹é‡Œï¼Œæ¨é£ä¹‹æ‰€ä»¥è®©äººå¿ƒç–¼ï¼Œ<br/>
ä¸æ˜¯å› ä¸ºä»–ä»€ä¹ˆéƒ½ä¸æ‡‚ï¼Œ<br/>
è€Œæ˜¯å› ä¸ºä»–<strong>æ‡‚å¾—å¤ªå¤šï¼Œå´æ— èƒ½ä¸ºåŠ›</strong>ã€‚</p>
<p>æœ‰äº›ç—›ï¼Œå¹¶ä¸æ˜¯æ¥è‡ªæ— çŸ¥ï¼Œ<br/>
è€Œæ˜¯æ¥è‡ªâ€œæˆ‘å·²ç»çœ‹æ¸…ï¼Œå´ä»ç„¶è¦æ‰¿å—â€ã€‚</p>
<h3 data-id="heading-2">äºŒã€å¾ˆå¤šäººä¸æ˜¯é æ˜ç™½æ´»ä¸‹å»çš„ï¼Œæ˜¯é â€œä¸å»æƒ³â€</h3>
<p>ã€Šæ´»ç€ã€‹é‡Œçš„ç¦è´µï¼Œå¦‚æœçœŸçš„â€œæƒ³æ˜ç™½â€äº†ä¸€åˆ‡ï¼Œ<br/>
ä»–æˆ–è®¸æ ¹æœ¬æ’‘ä¸åˆ°æœ€åã€‚</p>
<p>ä»–ä¹‹æ‰€ä»¥èƒ½æ´»ä¸‹æ¥ï¼Œ<br/>
ä¸æ˜¯å› ä¸ºä»–å‚é€äº†å‘½è¿ï¼Œ<br/>
è€Œæ˜¯å› ä¸ºä»–<strong>ä¸å»åå¤è¿½é—®æ„ä¹‰</strong>ã€‚</p>
<p>ä»–åªæ˜¯å¹²æ´»ã€åƒé¥­ã€æ´»ç€ã€‚</p>
<p>å¾ˆå¤šæ™®é€šäººä¹Ÿæ˜¯è¿™æ ·ï¼š</p>
<ul>
<li>ä»–ä»¬æ²¡æœ‰å®å¤§çš„ä¸–ç•Œè§‚</li>
<li>ä¹Ÿè¯´ä¸æ¸…äººç”Ÿçš„ä»·å€¼</li>
<li>ç”šè‡³ä¸æ‡‚ä»€ä¹ˆæ˜¯æ—¶ä»£æ´ªæµ</li>
</ul>
<p>ä½†ä»–ä»¬ç…§æ ·ç»“å©šã€ç”Ÿå­ã€è€å»ã€‚</p>
<p>æœ‰æ—¶å€™ï¼Œ<br/>
<strong>ä¸æ˜ç™½ï¼Œåè€Œæ˜¯ä¸€ç§ç”Ÿå­˜ç­–ç•¥ã€‚</strong></p>
<h3 data-id="heading-3">ä¸‰ã€ç—›è‹¦å¹¶ä¸ä¸€å®šèƒ½æ¢æ¥é€šé€</h3>
<p>æˆ‘ä»¬å¸¸è¯´ï¼š</p>
<blockquote>
<p>ç»å†è¿‡è‹¦éš¾ï¼Œäººå°±æ˜ç™½äº†ã€‚</p>
</blockquote>
<p>å¯è«è¨€åœ¨ã€Šå¤©å ‚è’œè–¹ä¹‹ä¹¡ã€‹é‡Œå‘Šè¯‰æˆ‘ä»¬å¦ä¸€ä»¶äº‹ï¼š<br/>
è‹¦éš¾æ›´å¤šæ—¶å€™ï¼Œåªæ˜¯è‹¦éš¾ã€‚</p>
<p>é‚£äº›å†œæ°‘å¹¶æ²¡æœ‰å› ä¸ºè¢«å‹è¿«è€Œâ€œé¡¿æ‚Ÿäººç”Ÿâ€ï¼Œ<br/>
ä»–ä»¬åªæ˜¯æ„¤æ€’ã€å´©æºƒã€è¢«ç¢¾ç¢ã€‚</p>
<p>ç—›è‹¦å¹¶ä¸ä¼šè‡ªåŠ¨å‡åã€‚<br/>
å®ƒå¯èƒ½åªä¼šç•™ä¸‹åˆ›ä¼¤ã€‚</p>
<p>æ‰€ä»¥è¦æ±‚æ¯ä¸€ä¸ªç»å†è‹¦éš¾çš„äºº<br/>
â€œæ´»å¾—æ˜ç™½â€â€œæƒ³é€šä¸€ç‚¹â€ï¼Œ<br/>
æœ¬èº«å°±æœ‰ç‚¹æ®‹å¿ã€‚</p>
<hr/>
<h3 data-id="heading-4">å››ã€æœ‰äº›äººæ´»å¾—å¾ˆå¥½ï¼Œæ˜¯å› ä¸ºä»–ä»¬æ²¡æƒ³é‚£ä¹ˆå¤š</h3>
<p>ä½ ä¼šå‘ç°ç°å®é‡Œæœ‰ä¸€ç±»äººï¼š</p>
<ul>
<li>ä¸å¤ªè®¨è®ºæ„ä¹‰</li>
<li>ä¸å¤ªåæ€æ—¶ä»£</li>
<li>ä¸å¤ªåˆ†æå‘½è¿</li>
</ul>
<p>ä»–ä»¬å…³å¿ƒçš„æ˜¯ï¼š<br/>
ä»Šå¤©åƒä»€ä¹ˆï¼Œæ˜å¤©å¹²ä»€ä¹ˆï¼Œå­©å­ä½œä¸šå†™å®Œäº†å—ã€‚</p>
<p>ä»æŸç§è§’åº¦çœ‹ï¼Œ<br/>
ä»–ä»¬å¹¶ä¸â€œæ·±åˆ»â€ï¼Œ<br/>
ä½†ä»–ä»¬ä¹Ÿ<strong>ä¸æ‹§å·´</strong>ã€‚</p>
<p>ä»–ä»¬æ´»å¾—ä¸é«˜çº§ï¼Œ<br/>
ä½†æ´»å¾—ä¸‹å»ã€‚</p>
<p>è€Œå¤ªè¿½æ±‚â€œæ˜ç™½â€çš„äººï¼Œ<br/>
åè€Œå®¹æ˜“é™·å…¥ä¸€ç§ç²¾ç¥ç–²åŠ³ï¼š<br/>
æƒ³å¾—è¶Šå¤šï¼Œè¶Šéš¾å®‰æ”¾è‡ªå·±ã€‚</p>
<h3 data-id="heading-5">äº”ã€æ–‡å­¦é‡Œä¹Ÿæœ‰â€œæ‹’ç»æ˜ç™½â€çš„åŠ›é‡</h3>
<p>å¹¶ä¸æ˜¯æ‰€æœ‰å¥½ä½œå“éƒ½åœ¨å¼•å¯¼ä½ çœ‹æ¸…ä¸–ç•Œã€‚<br/>
æœ‰äº›ä½œå“çš„ä»·å€¼ï¼Œæ°æ°åœ¨äºâ€”â€”<br/>
<strong>è®©ä½ æš‚æ—¶é€ƒç¦»ç†è§£çš„è´Ÿæ‹…ã€‚</strong></p>
<p>æ¯”å¦‚ï¼š</p>
<ul>
<li><strong>ã€Šç™¾å¹´å­¤ç‹¬ã€‹</strong> â€”â€”<br/>
å®ƒå¹¶ä¸è¦æ±‚ä½ ç†è§£å‘½è¿ï¼Œåªæ˜¯è®©ä½ æ„Ÿå—å¾ªç¯ä¸è’è¯ã€‚</li>
<li><strong>ã€Šå±€å¤–äººã€‹ï¼ˆåŠ ç¼ªï¼‰</strong> â€”â€”<br/>
ä¸»äººå…¬å¹¶ä¸è¯•å›¾ç†è§£ä¸–ç•Œï¼Œä¸–ç•Œä¹Ÿä¸ç†è§£ä»–ã€‚</li>
<li><strong>ã€ŠåŸå ¡ã€‹ï¼ˆå¡å¤«å¡ï¼‰</strong> â€”â€”<br/>
ä¸–ç•Œå°±æ˜¯ä¸å¯ç†è§£çš„ï¼ŒåšæŒå¯»æ‰¾æ„ä¹‰æœ¬èº«å°±æ˜¯æŠ˜ç£¨ã€‚</li>
</ul>
<p>è¿™äº›ä¹¦å¹¶ä¸å‘Šè¯‰ä½ â€œæ€ä¹ˆåŠâ€ï¼Œ<br/>
å®ƒä»¬åªæ˜¯è¯´ï¼š</p>
<blockquote>
<p>ä¸–ç•Œæœ¬æ¥å°±æœªå¿…æœ‰ç­”æ¡ˆã€‚</p>
</blockquote>
<h3 data-id="heading-6">å…­ã€ä¹Ÿè®¸ï¼Œäººå¯ä»¥åªé€‰æ‹©â€œæ´»ç€â€ï¼Œè€Œä¸æ˜¯â€œæƒ³æ˜ç™½â€</h3>
<p>â€œæ´»å¾—æ˜ç™½â€å¬èµ·æ¥å¾ˆé«˜å°šï¼Œ<br/>
ä½†å®ƒä¸æ˜¯äººç”Ÿçš„ä¹‰åŠ¡ã€‚</p>
<p>æœ‰äº›äººé€‚åˆæ€è€ƒå‘½è¿ï¼Œ<br/>
æœ‰äº›äººé€‚åˆä½å¤´ç”Ÿæ´»ã€‚</p>
<p>æœ‰äº›äººéœ€è¦ç­”æ¡ˆï¼Œ<br/>
æœ‰äº›äººåªéœ€è¦ä»Šå¤©è¿‡å»ã€‚</p>
<p><strong>ä¸æ´»å¾—æ˜ç™½ï¼Œå¹¶ä¸ç­‰äºå¤±è´¥ã€‚</strong><br/>
å®ƒå¯èƒ½åªæ˜¯å¦ä¸€ç§è¯šå®ï¼š<br/>
æˆ‘æ‰¿è®¤è‡ªå·±æ‰¿å—ä¸èµ·é‚£ä¹ˆå¤šç†è§£ã€‚</p>
<hr/>
<h3 data-id="heading-7">æ¨èä¸€ç»„ä¹¦ç±</h3>
<p>è¿™äº›ä¹¦ï¼Œä¸å¼ºè°ƒé€šé€ï¼Œä¸æ•™ä½ çœ‹æ¸…ä¸–ç•Œï¼Œ<br/>
å®ƒä»¬è¦ä¹ˆè’è¯ï¼Œè¦ä¹ˆæ¨¡ç³Šï¼Œè¦ä¹ˆå¹²è„†æ‹’ç»è§£é‡Šï¼š</p>
<p>ç™¾å¹´å­¤ç‹¬ â€” åŠ è¥¿äºšÂ·é©¬å°”å…‹æ–¯<br/>
å±€å¤–äºº â€” åŠ ç¼ª<br/>
åŸå ¡ â€” å¡å¤«å¡<br/>
æŒªå¨çš„æ£®æ— â€” æ‘ä¸Šæ˜¥æ ‘<br/>
ä¸èƒ½æ‰¿å—çš„ç”Ÿå‘½ä¹‹è½» â€” ç±³å…°Â·æ˜†å¾·æ‹‰<br/>
ç™½å¤œè¡Œ â€” ä¸œé‡åœ­å¾</p>
<p>å®ƒä»¬å…±åŒçš„æ°”è´¨æ˜¯ï¼š<br/>
<strong>ä¸–ç•Œå¯ä»¥ä¸è¢«ç†è§£ï¼Œäººä¹Ÿå¯ä»¥å¸¦ç€å›°æƒ‘ç»§ç»­æ´»ç€ã€‚</strong></p>
<h3 data-id="heading-8">æœ€å</h3>
<p>ä¹Ÿè®¸çœŸæ­£çš„è‡ªç”±ä¸æ˜¯â€œæ´»å¾—æ˜ç™½â€ï¼Œ<br/>
è€Œæ˜¯â€”â€”<br/>
<strong>ä½ å¯ä»¥é€‰æ‹©ä»€ä¹ˆæ—¶å€™æ˜ç™½ï¼Œä»€ä¹ˆæ—¶å€™ç³Šæ¶‚ã€‚</strong></p>
<p>æœ‰äº›æ—¥å­ï¼Œ<br/>
ä½ é€‚åˆè¯»ã€Šæ´»ç€ã€‹ã€‚</p>
<p>æœ‰äº›æ—¥å­ï¼Œ<br/>
ä½ åªé€‚åˆå…³æ‰æ„ä¹‰ï¼Œ<br/>
å¥½å¥½åƒä¸€é¡¿é¥­ï¼Œ<br/>
ç„¶åç¡ä¸€è§‰ã€‚</p>
<p>è¿™æœ¬èº«ï¼Œ<br/>
ä¹Ÿæ˜¯ä¸€ç§æ´»æ³•ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€é«˜æ–¯æ³¼æº…ã€‘å¦‚ä½•å°†â€œæ­ªå¤´â€çš„3DGSæ¨¡å‹ç²¾å‡†â€œé’‰â€åœ¨åœ°å›¾ä¸Šï¼Œæœç»åç»­è¯¯å·®ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7585222924566478888</link>    <guid>https://juejin.cn/post/7585222924566478888</guid>    <pubDate>2025-12-19T09:16:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585222924566478888" data-draft-id="7585206349748977716" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€é«˜æ–¯æ³¼æº…ã€‘å¦‚ä½•å°†â€œæ­ªå¤´â€çš„3DGSæ¨¡å‹ç²¾å‡†â€œé’‰â€åœ¨åœ°å›¾ä¸Šï¼Œæœç»åç»­è¯¯å·®ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-19T09:16:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Mapmost"/> <meta itemprop="url" content="https://juejin.cn/user/1679709496936343"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€é«˜æ–¯æ³¼æº…ã€‘å¦‚ä½•å°†â€œæ­ªå¤´â€çš„3DGSæ¨¡å‹ç²¾å‡†â€œé’‰â€åœ¨åœ°å›¾ä¸Šï¼Œæœç»åç»­è¯¯å·®ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1679709496936343/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Mapmost
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T09:16:24.000Z" title="Fri Dec 19 2025 09:16:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€œæ‹â€ä¸€ä¸ªGSæ¨¡å‹åªè¦å‡ åˆ†é’Ÿï¼Œå»ºä¸€ä¸ªGSæ¨¡å‹å¯é€‰çš„å·¥å…·ä¹Ÿå¾ˆå¤šï¼Œä½†æ˜¯æ¨¡å‹æ”¾è¿›ç½‘é¡µé‡Œ<strong>éš¾ä»¥æ—‹è½¬</strong>ï¼Œæ°¸è¿œå¡ä¸åˆ°ä½ æƒ³çœ‹çš„é‚£ä¸ªè§’åº¦ï¼Œåº”è¯¥æ€ä¹ˆåŠï¼Ÿ</p>
<p>æ›´è¿›ä¸€æ­¥ï¼Œå¦‚æœæˆ‘æƒ³æŠŠæ¨¡å‹æ”¾åˆ°åœ°å›¾ä¸Šçš„å®é™…ä½ç½®ï¼Œå¯¹æ¨¡å‹å’Œå‘¨å›´åœ°ç†ç¯å¢ƒæœ‰æ›´æ·±å…¥çš„è”åŠ¨ï¼Œè¿™æ—¶å€™åˆè¯¥æ€ä¹ˆåŠï¼Ÿ</p>
<p>ç›¸ä¿¡çœ‹å®Œè¿™ç¯‡æ–‡ç« ï¼Œä½ ä¸ä»…èƒ½è½»æ¾æ‹¿æå°æ¨¡å‹çš„<strong>å„ä¸ªè§’åº¦</strong>ï¼Œ<strong>å¤§èŒƒå›´çš„é«˜æ–¯æ¨¡å‹é…å‡†</strong>åˆ°åœ°å›¾ä¹Ÿæ˜¯èƒ½æ‰‹åˆ°æ“’æ¥ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f692b3d1e483408aa6767ea3d3d03fda~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWFwbW9zdA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766740583&amp;x-signature=IG1VNObMwzgKVQi95g5CivxZo9Q%3D" alt="" loading="lazy"/></p>
<p><em>ä¸ºä»€ä¹ˆå°ç†Šçš„è§’åº¦å¥‡å¥‡æ€ªæ€ªçš„ï¼Ÿ</em></p>
<h2 data-id="heading-0">äº†è§£ä¸¤ä¸ªåæ ‡ç³»ï¼Œè½»æ¾æ—‹è½¬æŸ¥çœ‹æ¨¡å‹</h2>
<p>æƒ³è¦èƒ½è‡ªå¦‚çš„æ—‹è½¬æ¨¡å‹ï¼Œåªéœ€è¦äº†è§£<strong>ä¸¤ä¸ªåæ ‡ç³»</strong>ã€‚</p>
<p>ä»¥åä¸ç®¡æ˜¯é«˜æ–¯æ¨¡å‹ã€ç‚¹äº‘æˆ–OBJç­‰<strong>å„ç±»æ•°æ®</strong>ï¼Œåœ¨<strong>å„å¼æŸ¥çœ‹å™¨</strong>ä¸­çš„è‡ªå¦‚è§‚çœ‹éƒ½ä¸åœ¨è¯ä¸‹ã€‚</p>
<p>ç°åœ¨è§£å¯†ä¸€ä¸‹è¿™ä¸¤ä¸ªåæ ‡ç³»ï¼š</p>
<ul>
<li>**ç‰©ä½“åæ ‡ç³»ï¼š**å³æ¨¡å‹è‡ªèº«æœ‰ä¸ªXYZä¸‰è½´</li>
<li>**ä¸–ç•Œåæ ‡ç³»ï¼š**å³æŸ¥çœ‹å™¨é¢„å…ˆå®šä¹‰å¥½çš„XYZä¸‰è½´</li>
</ul>
<p>æ˜¯ä¸æ˜¯çœ‹æ‡µäº†ï¼Œè¯´å•¥å‘¢ã€‚åˆ«æ€¥ï¼Œè®©æˆ‘ä»¥ä¸‹é¢çš„å°ç†Šæ¨¡å‹æ¥è¯¦ç»†è®²è§£ä¸€ä¸‹ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬ä¸€èˆ¬å¯ä»¥çœ‹åˆ°ï¼ŒæŸ¥çœ‹å™¨å³ä¸Šè§’æœ‰ä¸ªå¾ˆæ˜æ˜¾çš„XYZè½´ã€‚æˆ‘ä»¬<strong>åˆšè¿›å…¥æŸ¥çœ‹å™¨åä»€ä¹ˆéƒ½åˆ«åŠ¨</strong>ï¼Œ<strong>XYZè¿™ä¸ªåˆå§‹çš„æ–¹å‘å°±æ˜¯ä¸–ç•Œåæ ‡ç³»çš„æŒ‡å‘</strong>ï¼Œæˆ‘ä»¬<strong>åªéœ€è¦å…³å¿ƒæŒ‡å‘ä¸Šæ–¹çš„æ˜¯å“ªæ ¹è½´å°±è¡Œ</strong>ã€‚è¿™ä¸ªåœºæ™¯ä¸­å°±æ˜¯<strong>Yè½´</strong>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b9c2e3dd625d47d2bdd23c58f0346fdc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWFwbW9zdA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766740583&amp;x-signature=Xmt4JVuCNniSs1S2J2ZbJemirpM%3D" alt="" loading="lazy"/></p>
<p>ä¸‹é¢å°±æ˜¯å…³é”®äº†ï¼Œæˆ‘ä»¬è¦<strong>å°†æ¨¡å‹çš„Yè½´å¯¹é½ä¸–ç•Œåæ ‡ç³»çš„Yè½´</strong>ã€‚</p>
<p>æœ‰äººå¯èƒ½è¦é—®äº†ï¼šå°ç†Šåˆæ²¡æœ‰è¿™äº›çº¢çº¢ç»¿ç»¿çš„è½´ï¼Œæˆ‘åˆä¸çŸ¥é“å“ªä¸ªæ˜¯Yè½´ï¼Œè¿˜å¯¹é½å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼ŒYæ˜¯å‘ä¸Šçš„ï¼Œé‚£è¿™ä¸ªå°ç†Šæ¨¡å‹æ˜¯ä¸æ˜¯ä¹Ÿåº”è¯¥å‘ä¸Šï¼Œé‚£ä»€ä¹ˆåº”è¯¥æ˜¯å‘ä¸Šçš„å‘¢ï¼Ÿ</p>
<p>å¾ˆæ˜æ˜¾å§ï¼Œæˆ‘ä»¬<strong>åªéœ€è¦æŠŠå°ç†Šçš„çº¢å¸½å­æ—‹è½¬å‘ä¸Šï¼Œé‚£å°ç†Šè‚¯å®šå°±è‡ªç„¶å’Œä¸–ç•Œåæ ‡ç³»å¯¹é½äº†</strong>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/348c3331bdd14409860e4be806b63814~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWFwbW9zdA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766740583&amp;x-signature=rkZ4ZfrUetqNlYdusKoYEAS2TJQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">å¤§æ¨¡å‹å åŠ åœ°å›¾</h2>
<p>è¿™å°ç†Šæ¨¡å‹æˆ‘éšä¾¿è½¬è½¬çœ‹çœ‹ï¼Œæ²¡å•¥ç²¾åº¦è¦æ±‚ï¼Œéš¾åº¦å¤ªä½ã€‚è¦æ˜¯æƒ³æŠŠä¸œæ–¹ä¹‹é—¨ã€é˜³æ¾„æ¹–é‚£ä¹ˆå¤§åŒºåŸŸçš„é«˜æ–¯æ¨¡å‹<strong>å¯¹é½åˆ°åœ°å›¾ï¼Œèå…¥åˆ°GISçš„æµ‹é‡ã€åˆ†æã€å†³ç­–ä¸è¿ç»´æµç¨‹</strong>è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬é¦–å…ˆè¦åšçš„å·¥ä½œæ˜¯<strong>é…å‡†</strong>ï¼Œå°†æ¨¡å‹é…å‡†åˆ°åœ°å›¾ä¸Šã€‚</p>
<p>è¿›è¡Œé…å‡†éœ€è¦äº†è§£åæ ‡ç³»ï¼š</p>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ°çƒæ˜¯ä¸ª<strong>ä¸‰ç»´æ¤­çƒ</strong>ï¼Œè€Œæˆ‘ä»¬å¹³æ—¶çœ‹çš„åœ°å›¾éƒ½æ˜¯<strong>äºŒç»´å¹³é¢</strong>ï¼Œè¿™é‡Œæ¶‰åŠåˆ°ä¸¤ä¸ªåæ ‡ç³»äº†ï¼›å†åŠ ä¸Š<strong>æ¨¡å‹çš„åæ ‡ç³»</strong>ï¼Œå°±æ˜¯ä¸‰ä¸ªåæ ‡ç³»äº†ã€‚</p>
<p>å¹³å¸¸æ— äººæœºå›¾åƒè‡ªå¸¦çš„ç»çº¬åº¦å°±æ˜¯ä¸‰ç»´æ¤­çƒçš„åæ ‡ç³»ï¼Œä¸€èˆ¬æ¥è¯´å¸¸ç”¨çš„ä¸º<strong>WGS84åæ ‡ç³»</strong>ï¼›å¹³é¢åœ°å›¾çš„åæ ‡ç³»ä¸€èˆ¬æ¥è¯´å¸¸ç”¨çš„æ˜¯<strong>å¢¨å¡æ‰˜æŠ•å½±åæ ‡ç³»</strong>ã€‚åœ¨å›½é™…æ ‡å‡†ä¸‹ï¼Œè¿™ä¸¤è€…å¸¸ç”¨çš„ä»£ç æ˜¯<strong>EPSG:4326</strong>å’Œ<strong>EPSG:3857</strong>ã€‚</p>
<p>è€Œé…å‡†ä¸€èˆ¬æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<p>01<strong>åœ°å›¾é€‰ç‚¹</strong></p>
<p>ä»åœ°å›¾ä¸Šé€‰å–ä¸€äº›ç‰¹å¾ç‚¹ï¼Œåœ°å›¾ä¸Šè·å–çš„ç‚¹å¦‚æœæ˜¯ç»çº¬åº¦ï¼Œéœ€è¦å°†å…¶è½¬æ¢åˆ°EPSG:3857åæ ‡ç³»ä¸‹çš„å¹³é¢åæ ‡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de286e91b0bb4b9f97d8dbb36f90d4c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWFwbW9zdA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766740583&amp;x-signature=As%2FkW958AXy%2FFAoxpBuXlAh37%2Fs%3D" alt="" loading="lazy"/></p>
<p><em>å¹³é¢åœ°å›¾é€‰ç‚¹</em></p>
<p>02<strong>æ¨¡å‹é€‰ç‚¹</strong></p>
<p>æ¨¡å‹ä¾§åˆ™é¦–å…ˆè¦å°†colmapç»“æœç‚¹äº‘å¯¼å…¥è¿›CloudCompareä¹‹ç±»çš„ç‚¹äº‘å¤„ç†å·¥å…·ï¼Œç„¶åé€‰å–ä¸åœ°å›¾ä¸Šé€‰æ‹©çš„ç›¸åŒçš„ç‚¹ï¼Œè®°å½•å…¶åæ ‡ï¼Œå³æ¨¡å‹åæ ‡ç³»ä¸‹åæ ‡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6d0c6f3155e04884bba544526e74d37f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWFwbW9zdA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766740583&amp;x-signature=AzVlp8GOx69Az4PhJG5EVGXl%2FRc%3D" alt="" loading="lazy"/></p>
<p><em>CloudCompareå·¥å…·é€‰å–æ¨¡å‹ç‚¹</em></p>
<p>03<strong>å˜æ¢çŸ©é˜µè®¡ç®—</strong></p>
<p>ä¹‹åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœ€å°äºŒä¹˜ç­‰ç®—æ³•ï¼Œè®¡ç®—ä¸¤ç»„åæ ‡é—´æœ€ä½³çš„æ—‹è½¬å˜æ¢çŸ©é˜µ(ä¸Šä¸€æ­¥é€‰å–çš„ç‚¹è¶Šå¤šï¼Œæœ€ç»ˆé…å‡†ç»“æœè¶Šå‡†ç¡®)ã€‚</p>
<p>04<strong>å˜æ¢æ¨¡å‹</strong></p>
<p>æœ€ç»ˆæˆ‘ä»¬è¿˜è¦å¯¹é«˜æ–¯æ¨¡å‹çš„ä½ç½®ã€æ—‹è½¬ç­‰ç›¸å…³å±æ€§åº”ç”¨è¿™ä¸ªçŸ©é˜µæ‰èƒ½å®Œæˆé…å‡†ï¼Œå°†æ¨¡å‹æ”¾ä¸Šåœ°å›¾ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e31487b163dd4ed4a8482b17b49eaa57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWFwbW9zdA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766740583&amp;x-signature=rtnNg6j8aw3FKWCVr0pUUPlJ9bw%3D" alt="" loading="lazy"/></p>
<p><em>æ¨¡å‹å åŠ åœ°å›¾</em></p>
<h2 data-id="heading-2">å¦‚ä½•ä¸€æ­¥å®Œæˆå åŠ </h2>
<p>æŠŠæ¨¡å‹â€œæ‘†â€åˆ°åœ°å›¾ä¸Šï¼Œä¼ ç»Ÿåšæ³•å¾—å…ˆ<strong>é—¯ä¸‰å…³åæ ‡ç³»</strong>ã€å†<strong>è¸©å››æ­¥é…å‡†å‘</strong>ï¼›æ¥ä¸€ä¸ªæ–°æ¨¡å‹å°±å…¨å¥—é‡æ¥ï¼Œäººå·¥é‡ç›´æ¥æ‹‰æ»¡ã€‚</p>
<p>Mapmost é«˜æ–¯æ³¼æº…å»ºæ¨¡å¹³å°ï¼Œè®©è¿™å¥—è‹¦å·®äº‹å˜æˆâ€œæ— äººåŒºâ€ï¼š</p>
<p><strong>ç…§ç‰‡å¸¦ GPSï¼Ÿ</strong></p>
<p>å¹³å°è‡ªåŠ¨è¯»å–ï¼Œå»ºå®Œæ¨¡å‹ä¸€ç§’ç¼©æ”¾ï¼‹æ—‹è½¬ï¼Œç¨³ç¨³è½åˆ°çœŸå®åœ°ç†ä½ç½®ï¼›</p>
<p><strong>ç…§ç‰‡æ²¡ GPSï¼Ÿ</strong></p>
<p>ç©ºä¸‰åçš„éšæœºåæ ‡ç³»ä¹Ÿèƒ½è¢«æ‰³æ­£ï¼Œå†ä¹Ÿä¸æ€•åƒâ€œå°ç†Šâ€å¼¯å¤´è½¬å‘çš„ã€‚</p>
<p><strong>æ— äººæœºæ‹å®Œâ†’ä¸Šä¼ â†’è‡ªåŠ¨é…å‡†</strong>ï¼Œæ•´æ¡é“¾è·¯é›¶æ‰‹å·¥ã€é›¶ä»£ç ï¼ŒçœŸæ­£çš„â€œä¸€é”®åˆ°åœ°â€ã€‚</p>
<p>ç”³è¯·è¯•ç”¨ï¼Œè¯·è‡³<a href="https://link.juejin.cn/?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Fwww.mapmost.com%2F%2523%2F" title="https://link.juejin.cn/?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Fwww.mapmost.com%2F%2523%2F" target="_blank">Mapmost</a>å®˜ç½‘è”ç³»å®¢æœ</p>
<p><strong>Mapmost 3DGS Builderåœ¨çº¿ä½“éªŒç‰ˆå·²ä¸Šçº¿~</strong></p>
<p><strong>æ¬¢è¿ä½“éªŒ:</strong> <a href="https://link.juejin.cn/?target=studio.mapmost.com%2F3dgs" title="https://link.juejin.cn/?target=studio.mapmost.com%2F3dgs" target="_blank">studio.mapmost.com/3dgs</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3bafd14059cb4d5086b3d0f33dc85d5b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTWFwbW9zdA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766740583&amp;x-signature=BvOozw2cDnaNhffKBVEja1HhGdc%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‘„åƒå¤´ RTSP æµè§†é¢‘å¤šè·¯å®æ—¶ç›‘æ§è§£å†³æ–¹æ¡ˆå®è·µ]]></title>    <link>https://juejin.cn/post/7585377403632386094</link>    <guid>https://juejin.cn/post/7585377403632386094</guid>    <pubDate>2025-12-19T09:23:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585377403632386094" data-draft-id="7585377403632320558" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‘„åƒå¤´ RTSP æµè§†é¢‘å¤šè·¯å®æ—¶ç›‘æ§è§£å†³æ–¹æ¡ˆå®è·µ"/> <meta itemprop="keywords" content="åç«¯,C++,éŸ³è§†é¢‘å¼€å‘"/> <meta itemprop="datePublished" content="2025-12-19T09:23:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SHERlocked93"/> <meta itemprop="url" content="https://juejin.cn/user/360295543341165"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‘„åƒå¤´ RTSP æµè§†é¢‘å¤šè·¯å®æ—¶ç›‘æ§è§£å†³æ–¹æ¡ˆå®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/360295543341165/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SHERlocked93
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T09:23:27.000Z" title="Fri Dec 19 2025 09:23:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡è®°å½•æˆ‘åœ¨æ‘„åƒå¤´ RTSP æµè§†é¢‘å¤šè·¯å®æ—¶ç›‘æ§é¡¹ç›®é‡Œï¼Œè½åœ°çš„ä¸€å¥—ã€Œå¤šè·¯ RTSP ä½å»¶è¿Ÿæ’­æ”¾ã€æ–¹æ¡ˆçš„å…¨è¿‡ç¨‹ï¼šä»é€‰å‹ã€ç¼–ç ã€åˆ°
Web/æ¡Œé¢ç«¯æ’­æ”¾ä¸ç¡¬è§£ä¼˜åŒ–ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€éœ€æ±‚ç°çŠ¶</h2>
<p>ç°åœºæœ‰ä¸€ä¸ªè¿œç¨‹ç›‘æ§ç«¯ï¼Œéœ€è¦åŒæ—¶ç›‘æ§å¤šå°è½¦è½½è®¾å¤‡çš„æ‘„åƒå¤´ç”»é¢ï¼Œæ¯å°è®¾å¤‡çº¦ 6 è·¯æ‘„åƒå¤´ï¼Œæ‘„åƒå¤´è¾“å‡º RTSPï¼ˆè§†é¢‘ H.264ï¼›éƒ¨åˆ†æ‘„åƒå¤´å‹å·è¿˜æœ‰éŸ³é¢‘ï¼‰ï¼Œç”±äºæ˜¯è½¦è½½å®æ—¶æ‘„åƒå¤´ï¼Œå…³é”®çš„ä¸æ˜¯èƒ½æ’­ï¼Œè€Œæ˜¯å¤šè·¯ã€ä½å»¶è¿Ÿï¼ˆç”±äºåœ¨ç°åœºæ“ä½œéœ€è¦å®æ—¶åé¦ˆï¼Œæ‰€ä»¥éœ€è¦ 1 ç§’ä»¥å†…ï¼‰ã€ä½ CPU å ç”¨ï¼Œå› æ­¤æ ¸å¿ƒéœ€æ±‚å¯ä»¥æ€»ç»“æˆå››ç‚¹ï¼š</p>
<ol>
<li>å¤šè·¯å¹¶å‘ï¼šåŒå± 6+ è·¯æ’­æ”¾ï¼Œæœ€å¤šä¸€ä¸ªç›‘æ§ç«¯åŒæ—¶æ’­æ”¾ 12 è·¯è§†é¢‘;</li>
<li>ä½å»¶è¿Ÿï¼šæ“ä½œé“¾è·¯å¸Œæœ›æ¥è¿‘å®æ—¶ï¼ˆç›®æ ‡ &lt; 500ms çº§ï¼‰;</li>
<li>æ¡Œé¢ç«¯ï¼šéœ€è¦æœ‰ç¼–ç æ§åˆ¶èƒ½åŠ›ï¼Œæœ€å¥½ Qt æ¡Œé¢ç¨‹åº;</li>
<li>æ€§èƒ½ä¸ç¨³å®šæ€§ï¼šå®¢æˆ·ç«¯éœ€è¦ç¨³å®šèµ° GPU ç¡¬è§£ï¼Œå¦åˆ™å¤šè·¯å…¨èµ° CPU è½¯è§£è§£ç ä¼šè¢«æ‹–æ­»ï¼›</li>
<li>éƒ¨ç½²/è¿ç»´å¤æ‚åº¦ï¼šæ¯”å¦‚è¦æ›´æ¢è§†é¢‘æµæ¥å…¥çš„æ—¶å€™è¦è¶³å¤Ÿæ–¹ä¾¿ï¼Œæœ€å¥½èƒ½é…ç½®åä¸€é”®éƒ¨ç½²ï¼›</li>
</ol>
<h2 data-id="heading-1">äºŒã€æŠ€æœ¯é€‰å‹</h2>
<p>ç»è¿‡ä¸€ç•ªè°ƒç ”ï¼Œä¸»è¦æœ‰ä¸‹é¢å‡ ä¸ªæ–¹æ¡ˆï¼š</p>
<h3 data-id="heading-2">HLS</h3>
<p>HLS çš„æ ¸å¿ƒæ€è·¯æ˜¯æŠŠè¿ç»­è§†é¢‘åˆ‡æˆä¸€æ®µæ®µ TS åˆ†ç‰‡ï¼ˆsegmentï¼‰ï¼ŒæœåŠ¡å™¨åˆ›å»ºå¹¶åŠ¨æ€æ›´æ–°ä¸€ä¸ª .m3u8 æ’­æ”¾åˆ—è¡¨æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶é‡Œè®°å½•äº†æ‰€æœ‰ .ts è§†é¢‘åˆ‡ç‰‡çš„æ–‡ä»¶åã€é¡ºåºã€æ—¶é•¿ç­‰ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯æŒ‰ m3u8 ç´¢å¼•åˆ—è¡¨å»æ‹‰åˆ†ç‰‡æ’­æ”¾ã€‚å®ƒçš„ä¼˜ç‚¹æ˜¯å…¼å®¹æ€§å¾ˆå¥½ï¼Œæ‰€æœ‰ç°ä»£æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿéƒ½åŸç”Ÿæ”¯æŒï¼Œé€‚åˆæ™®é€šç›´æ’­ã€ç‚¹æ’­å’Œ CDN åˆ†å‘ã€‚</p>
<p>åœ¨ä¸€ä¸ª TS åˆ†ç‰‡æ²¡æœ‰æ’­å®Œå¹¶åŒæ­¥åˆ° m3u8 ä¹‹å‰ï¼Œå®¢æˆ·ç«¯æ˜¯æ— æ³•çœ‹åˆ°æœ€æ–°ç”»é¢çš„ã€‚è¿™å¤©ç”Ÿå†³å®šäº† HLS çš„å®æ—¶æ€§ä¸é«˜ï¼Œä¸€èˆ¬åœ¨ 3 ç§’ä»¥ä¸Šï¼ŒåŠ ä¸Šå„ä¸ªé“¾è·¯çš„å»¶è¿Ÿå’Œç¼“å†²ï¼Œæ€»å»¶è¿Ÿè½»æ¾åˆ°è¾¾ 10 ç§’å·¦å³ï¼Œè¿™å¯¹äºå®æ—¶ç›‘æ§æ˜¯å®Œå…¨ä¸å¯æ¥å—çš„ã€‚</p>
<h3 data-id="heading-3">HTTP-FLV</h3>
<p>HTTP-FLV é€šå¸¸æ˜¯æœåŠ¡å™¨å°†éŸ³è§†é¢‘æ•°æ®ç”¨ FLVï¼ˆFlash Videoï¼‰æ ¼å¼è¿›è¡Œå°è£…ï¼Œé€šè¿‡å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å»ºç«‹çš„ HTTP é•¿è¿æ¥æµå¼ä¼ è¾“åˆ°æ’­æ”¾å™¨ä¸Šï¼Œå»¶è¿Ÿåœ¨ 1-3sï¼Œå¯ä»¥æ»¡è¶³ä¸€å®šçš„å®æ—¶æ€§éœ€æ±‚ã€‚ç¼ºç‚¹æ˜¯éœ€è¦å‰ç«¯å¼•å…¥ flv.js ä¹‹ç±»çš„ JS åº“åœ¨ JS å±‚å¯¹ FLV æµè§£å°è£…æˆ H.264ã€éŸ³é¢‘ç­‰æ•°æ®ï¼Œå°¤å…¶åœ¨å¤šè·¯å¹¶å‘æ—¶ï¼ŒCPU å ç”¨ä¼šæ¯”è¾ƒé«˜ï¼Œä¸”æµè§ˆå™¨å¯¹ FLV çš„æ”¯æŒä¸å¦‚ HLS/WebRTC åŸç”Ÿã€‚</p>
<h3 data-id="heading-4">æµ·åº· WebSDK çš„ WebSocket</h3>
<p>æµ·åº·çš„ WebSDK æä¾›äº†åŸºäº WebSocket çš„è§†é¢‘æµä¼ è¾“èƒ½åŠ›ï¼Œå»¶è¿Ÿå¯ä»¥åšåˆ° 1 ç§’ä»¥å†…ï¼Œé€‚åˆæµ·åº·è®¾å¤‡çš„æ¥å…¥ï¼Œä½†æˆ‘çœ‹æœ‰äº›è€ä¸€äº›çš„æµ·åº·è®¾å¤‡å¯èƒ½ä¸æ”¯æŒ WebSocketï¼Œè€Œä¸” WebSDK è¦æ±‚ Chrome ç‰ˆæœ¬ä¸ä½äº 91ï¼Œå¦‚æœä½ çš„æ‘„åƒå¤´éƒ½æ”¯æŒ WebSocket ä¸”èƒ½ä¿è¯æµè§ˆå™¨çš„ chromium å†…æ ¸ç‰ˆæœ¬åœ¨ 91+ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹å¼ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚</p>
<h3 data-id="heading-5">WebRTC</h3>
<p>WebRTCï¼ˆWeb Real-Time Communicationï¼‰æ˜¯ç›®å‰å®æ—¶éŸ³è§†é¢‘é€šä¿¡çš„ä¸»æµæŠ€æœ¯ï¼Œç°ä»£æµè§ˆå™¨ï¼ˆChrome, Firefox, Safari ç­‰ï¼‰éƒ½åŸç”Ÿæ”¯æŒ WebRTC åè®®æ ˆï¼Œæ— éœ€å®‰è£…æ’ä»¶ï¼Œå®æ—¶æ€§é€šå¸¸èƒ½åšåˆ° 500ms å·¦å³ï¼Œéå¸¸é€‚åˆå¯¹å®æ—¶æ€§è¦æ±‚é«˜çš„ç›‘æ§åœºæ™¯ã€‚WebRTC çš„è®¾è®¡ç›®æ ‡å°±æ˜¯å®æ—¶é€šè¯ä¸äº’åŠ¨ï¼Œæµè§ˆå™¨å¯¹å…¶å®ç°éå¸¸æˆç†Ÿã€‚å¯¹äº H.264 ç­‰å¸¸è§ç¼–ç æ ¼å¼ï¼Œæµè§ˆå™¨èƒ½ç›´æ¥è°ƒç”¨ GPU è¿›è¡Œç¡¬ä»¶åŠ é€Ÿè§£ç ï¼Œæ˜¾è‘—é™ä½ CPU å ç”¨ã€‚</p>
<h2 data-id="heading-6">ä¸‰ã€æ ¸å¿ƒå®è·µï¼šé€šè¿‡ SRS å°† RTSP + H.264 è§†é¢‘æµè½¬å°è£…ä¸º WebRTC + H.264</h2>
<p>æˆ‘æœ€ç»ˆä½¿ç”¨ SRSï¼ˆSimple Realtime Serverï¼‰å¼€æºæµåª’ä½“æœåŠ¡å™¨ï¼Œä¸€ç›´åœ¨ç¨³å®šç»´æŠ¤ï¼Œä¹Ÿæœ‰ä¸å°‘ç”¨åˆ°ç”Ÿäº§çº§ç¯å¢ƒçš„æ¡ˆä¾‹ï¼Œæ–‡æ¡£æœ‰ä¸­æ–‡ï¼Œéƒ¨ç½²ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œç›´æ¥ docker æ‹‰ä¸€ä¸ªé•œåƒç„¶åä¸€è¡Œå‘½ä»¤å°±èƒ½å¯åŠ¨ï¼Œå¦å¤–å®ƒè‡ªå¸¦è§†é¢‘æµå½•åˆ¶åŠŸèƒ½ï¼ŒåæœŸåšå½•åˆ¶ä¹Ÿæ–¹ä¾¿ã€‚</p>
<p>åœ¨è¿œç¨‹ç›‘æ§æœåŠ¡å™¨ä¸Šç”¨ Docker éƒ¨ç½² SRSï¼ŒæŠŠæ‘„åƒå¤´ RTSP æ‹‰åˆ°æœ¬æœºåï¼Œå†ä»¥ WebRTC çš„æ–¹å¼æä¾›ç»™å‰ç«¯æ’­æ”¾ã€‚</p>
<p>è¿™é‡Œè¦å¼ºè°ƒä¸€ä¸ªå…³é”®ç‚¹ï¼šå°½é‡åšè½¬å°è£…ï¼ˆRemuxï¼‰ï¼Œé¿å…è½¬ç ï¼ˆTranscodeï¼‰ï¼Œæ‘„åƒå¤´å·²ç»è¾“å‡º RTSP åŒ…ç€çš„ H.264 æœåŠ¡å™¨åªéœ€è¦è½¬åè®®æˆ WebRTC åŒ…ç€ H.264 å³å¯ï¼Œä¸éœ€è¦é‡æ–°ç¼–ç ï¼Œè½¬ç ä¼šå¸¦æ¥å¾ˆå¤§çš„ CPU è´Ÿæ‹…å’Œå»¶è¿Ÿã€‚</p>
<p>æ•´ä½“æ€è·¯ï¼šæ‘„åƒå¤´æ¨æµ RTSP(H.264) ï¼Œç»è¿‡ SRS ingest æ‹‰æµå¹¶é€šè¿‡ rtmp_to_rtc è½¬å°è£…ä¸º WebRTC(H.264) ï¼Œå‰ç«¯æµè§ˆå™¨ç”¨ <code>&lt;video&gt;</code> æ’­æ”¾ã€‚</p>
<h3 data-id="heading-7">3.1 SRS æ ¸å¿ƒé…ç½®è§£æ</h3>
<p>SRS çš„é…ç½®æ–‡ä»¶ <code>srs.conf</code> æ˜¯æ ¸å¿ƒã€‚ä¸‹é¢ç”¨ä¸€ä¸ªæœ€å°é…ç½®ç‰‡æ®µï¼š</p>
<pre><code class="hljs language-nginx" lang="nginx">listen 1935;
max_connections 1000;
daemon off;
srs_log_tank file;
srs_log_file /usr/local/srs/objs/logs/srs.log;

rtc_server {
    enabled on;           # å¯ç”¨ RTC æœåŠ¡å™¨
    listen 8000;          # WebRTC UDP ç«¯å£
    candidate $CANDIDATE; # è‡ªåŠ¨è·å–æœåŠ¡å™¨ IP
}

http_server {
    enabled on;            # å¯ç”¨ HTTP æœåŠ¡å™¨
    listen 8080;
    dir ./objs/nginx/html; # é»˜è®¤æ‰“å¼€æ˜¯æ§åˆ¶å°ï¼Œä¹Ÿå¯ä»¥æ”¹ä¸ºè‡ªå·±çš„å‰ç«¯é¡µé¢
    crossdomain on;
}

vhost __defaultVhost__ {
    rtc {
        enabled on;     # å¯ç”¨ RTC åŠŸèƒ½
        rtmp_to_rtc on; # å¼€å¯ RTMP åˆ° RTC çš„è½¬æ¢
        nack on;        # å¼€å¯ä¸¢åŒ…é‡ä¼ 
        twcc on;        # å¼€å¯æ‹¥å¡æ§åˆ¶
    }

    ingest camera_RIG001_0 {      # å®šä¹‰ Ingest æ‹‰æµé…ç½®ï¼Œä¸»åŠ¨æ‹‰å–æ‘„åƒå¤´ RTSP æµ
        enabled on;
        input {
            type stream;
            url rtsp://admin:password@192.168.1.60:554/Streaming/Channels/101;  # ä½ æ‘„åƒå¤´çš„rtspåœ°å€
        }
        ffmpeg ./objs/ffmpeg/bin/ffmpeg; # ä½¿ç”¨ SRS å†…ç½®çš„ FFmpeg
        engine {
            enabled on;
            perfile {
                rtsp_transport tcp;
                fflags nobuffer;
                flags low_delay;
                probesize 32;
                analyzeduration 0;
                max_delay 0;
            }
            vcodec copy; # è§†é¢‘æµç›´æ¥å¤åˆ¶ï¼Œä¸è½¬ç 
            acodec copy; # éŸ³é¢‘æµç›´æ¥å¤åˆ¶ï¼Œæˆ‘å°†æ‘„åƒå¤´çš„éŸ³é¢‘è¾“å‡ºæ ¼å¼é…ä¸º AAC
            output rtmp://127.0.0.1:[port]/live/camera_RIG001_0?vhost=[vhost];
        }
    }
}
</code></pre>
<h3 data-id="heading-8">3.2 Docker ä¸€é”®é…ç½®</h3>
<p>ç”±äºç°åœºè®¾å¤‡çš„ IP å’Œæ‘„åƒå¤´æ•°é‡å¯èƒ½ä¼šå˜åŒ–ï¼Œæ‰‹åŠ¨ä¿®æ”¹ <code>srs.conf</code> æ¯”è¾ƒç¹çä¸”å®¹æ˜“å‡ºé”™ã€‚æˆ‘åšäº†ä¸€å¥—è‡ªåŠ¨åŒ–é…ç½®æµç¨‹ï¼š</p>
<ol>
<li>é…ç½®æ–‡ä»¶ï¼šæä¾›ä¸€ä¸ª JSON æ–‡ä»¶ï¼Œç»´æŠ¤ç”¨æˆ·æ‘„åƒå¤´çš„ IP/Port åˆ—è¡¨ã€‚</li>
<li>ç”Ÿæˆè„šæœ¬ï¼šè¯»å–æ‘„åƒå¤´åˆ—è¡¨ï¼Œç”Ÿæˆ <code>srs.conf</code>ï¼Œå¹¶åœ¨ä¸Šä¸€éƒ¨é…ç½®å˜æ›´æ—¶æ›´æ–°æ–‡ä»¶ã€‚</li>
<li>è‡ªåŠ¨é‡å¯ï¼šæ£€æµ‹åˆ°é…ç½®å˜æ›´åï¼Œæ‰§è¡Œ <code>docker restart srs</code> è®©é…ç½®ç”Ÿæ•ˆã€‚</li>
</ol>
<p>Docker å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ‹‰å– SRS é•œåƒå¹¶æ‰“æ ‡ç­¾</span>
docker pull registry.cn-hangzhou.aliyuncs.com/ossrs/srs:5
docker tag registry.cn-hangzhou.aliyuncs.com/ossrs/srs:5 ossrs/srs:5

<span class="hljs-comment"># è¿è¡Œ SRS å®¹å™¨</span>
docker run -d --name srs \
   --restart=always \
    -p 1935:1935 \
    -p 1985:1985 \
    -p 8080:8080 \
    -p 8000:8000/udp \
    -e CANDIDATE=<span class="hljs-string">"127.0.0.1"</span> \
    -v ~/hello/config/srs_latest.conf:/usr/local/srs/conf/srs.conf \
   ossrs/srs:5 \
   ./objs/srs -c conf/srs.conf
</code></pre>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li><code>1935/tcp</code>ï¼šRTMPï¼ˆSRS å†…éƒ¨å›ç¯æ¨æµä¹Ÿä¼šç”¨åˆ°ï¼‰</li>
<li><code>1985/tcp</code>ï¼šHTTP API</li>
<li><code>8080/tcp</code>ï¼šHTTP Serverï¼ˆSRS è‡ªå¸¦çš„æ§åˆ¶å°é¡µé¢ï¼‰</li>
<li><code>8000/udp</code>ï¼šWebRTCï¼ˆRTC Serverï¼‰</li>
</ul>
<p>æˆ‘å®é™…å·¥ç¨‹é‡Œä¼šæŠŠ æ”¹æ‘„åƒå¤´é…ç½® -&gt; ç”Ÿæˆ srs.conf -&gt; é‡å¯å®¹å™¨ è¿™å¥—åŠ¨ä½œåšæˆä¸€é”®è„šæœ¬ï¼Œé¿å…æ‰‹å·¥æ”¹é…ç½®å¸¦æ¥çš„ç»´æŠ¤æˆæœ¬ï¼Œè§„èŒƒä¸€ç‚¹å¯ä»¥å¼„ä¸ªç½‘é¡µè®©ç”¨æˆ·ç»´æŠ¤æ‘„åƒå¤´é…ç½®ã€‚</p>
<h2 data-id="heading-9">å››ã€å‰ç«¯è½åœ°</h2>
<h3 data-id="heading-10">1. Web ç«¯æ’­æ”¾</h3>
<p>ç”±äºæµè§ˆå™¨å¯¹ WebRTC åŸç”Ÿæ”¯æŒæ¯”è¾ƒå¥½ï¼Œæ ‡å‡† HTML5 <code>&lt;video&gt;</code> å¯ä»¥ç›´æ¥æ¥ä½ WebRTC æµæ’­æ”¾ï¼Œæˆ‘åœ¨å‰ç«¯é¡µé¢é‡Œç›´æ¥ç”¨ <code>&lt;video&gt;</code> æ ‡ç­¾æ’­æ”¾ SRS è¾“å‡ºçš„ WebRTC æµï¼Œè®©æµè§ˆå™¨åŸç”Ÿè§£ç å™¨ï¼ˆé€šå¸¸èƒ½è‡ªåŠ¨èµ° H.264 ç¡¬è§£ï¼‰è§£ç ï¼Œå‰ç«¯ä¸éœ€è¦å¼•å…¥å…¶ä»–ç¬¬ä¸‰æ–¹åº“ï¼ŒCPU å ç”¨ä¹Ÿæ›´å¯æ§ã€‚</p>
<p>å‰ç«¯çš„é™æ€èµ„æºæœåŠ¡å™¨å¯ä»¥æ˜¯ Nginxï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶å®ƒè½»é‡æ–¹æ¡ˆï¼Œæ¯”å¦‚ SRS è‡ªå¸¦çš„ HTTP Server å°±å¯ä»¥ç›´æ¥ç”¨æ¥æ‰˜ç®¡å‰ç«¯é¡µé¢ï¼Œæˆ–è€… nodejsã€python éƒ½è¡Œã€‚</p>
<h3 data-id="heading-11">2. æ¡Œé¢åŒ–ï¼ˆQt / QWebEngineï¼‰</h3>
<p>ä¸ºäº†é›†æˆåˆ°ç°æœ‰çš„ Qt@6.8.3 æ¡Œé¢åº”ç”¨ä¸­ï¼Œæˆ‘ç”¨ <code>QWebEngineView</code> ç›´æ¥åµŒå…¥å‰ç«¯é¡µé¢ï¼Œè¿™æ · UI ä¸ Web ç«¯å¯ä»¥æœ€å¤§åŒ–å¤ç”¨ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªå¿…è¸©çš„å‘ï¼š</p>
<p>QT å®˜æ–¹åŒ…é‡Œå¸¦çš„ QWebEngine å› ä¸ºä¸“åˆ©åŸå› æ˜¯ä¸åŒ…å« H.264 ç¼–è§£ç èƒ½åŠ›çš„ï¼Œéœ€è¦ä¸‹è½½æºç è‡ªè¡Œç¼–è¯‘å¹¶<a href="https://link.juejin.cn?target=https%3A%2F%2Fdoc.qt.io%2Fqt-6%2Fqtwebengine-features.html%23feature-h264" target="_blank" title="https://doc.qt.io/qt-6/qtwebengine-features.html#feature-h264" ref="nofollow noopener noreferrer">å¢åŠ  <code>-webengine-proprietary-codecs</code> ç¼–è¯‘æŒ‡ä»¤å¯ç”¨ä¸“æœ‰ç¼–è§£ç å™¨æ”¯æŒ</a> ï¼Œæ‰èƒ½è®© QWebEngineView çš„ Chromium å†…æ ¸æ”¯æŒ H.264 ç¼–ç ã€‚</p>
<p>å¦å¤–æ³¨æ„è®©å†…ç½®æµè§ˆå™¨çš„è§†é¢‘è§£ç å°½å¯èƒ½èµ° VA-API ç­‰ç¡¬è§£è·¯å¾„ï¼Œå¯ä»¥åœ¨ QWebEngineView é‡Œæ‰“å¼€ <code>chrome://gpu</code> çœ‹ä¸€ä¸‹æœ€ä¸‹é¢çš„ <code>Video Acceleration Information</code> æœ‰æ²¡æœ‰ H.264 ç¡¬è§£æ”¯æŒã€‚æˆ‘å¢åŠ çš„ QT ç¯å¢ƒå˜é‡å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// å¼€å¯ H.264 å’Œ WebRTC æ”¯æŒ</span>
<span class="hljs-built_in">qputenv</span>(<span class="hljs-string">"QTWEBENGINE_CHROMIUM_FLAGS"</span>, <span class="hljs-string">"--enable-features=VaapiVideoDecoder,VaapiVideoEncoder,VaapiIgnoreDriverChecks,VaapiVideoDecodeLinuxGL --ignore-gpu-blocklist --enable-gpu-rasterization --in-process-gpu --disable-features=UseChromeOSDirectVideoDecoder --limit-fps=20 --num-raster-threads=4 "</span>);
</code></pre>
<h4 data-id="heading-12">ä¼˜åŒ–é¡¹ï¼šSmartH264</h4>
<p>æ³¨æ„åœ¨æ‘„åƒå¤´çš„é…ç½®ä¸­ï¼Œå°†æ‘„åƒå¤´çš„ H.264 ç¼–ç å‚æ•°è°ƒä¼˜ä¸º SmartH264ï¼Œå¯ä»¥è®©æ‘„åƒå¤´åœ¨ç”»é¢é™æ­¢æ—¶é™ä½ç ç‡ï¼ˆåœ¨ç”»é¢ä¸æ€ä¹ˆåŠ¨çš„æƒ…å†µä¸‹å¯ä»¥æœ€å¤§é™ä½ 90% ç æµï¼‰ï¼Œå‡å°‘ç½‘ç»œå¸¦å®½å ç”¨ï¼ŒåŒæ—¶åœ¨ç”»é¢æœ‰å˜åŒ–æ—¶æå‡ç ç‡å’Œå¸§ç‡ï¼Œä¿è¯ç”»é¢è´¨é‡ã€‚è¿™æ ·åœ¨å¤šè·¯å¹¶å‘æ—¶ï¼Œå¯ä»¥æ˜¾è‘—é™ä½æ•´ä½“çš„ç½‘ç»œå’Œè§£ç å‹åŠ›ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb33326528a842e8a44cd10e41ed9a9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU0hFUmxvY2tlZDkz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766741007&amp;x-signature=Bw7EFBq0E%2Bv%2BewiD6ftKb%2BgeRNQ%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-13">ä¼˜åŒ–é¡¹ï¼šç¡¬è§£éªŒè¯ä¸é©±åŠ¨é€‰æ‹©</h4>
<p>åœ¨ä½¿ç”¨ intel é›†æ˜¾çš„ i7-7700 æµ‹è¯•æ—¶ï¼Œé€šè¿‡æŒ‡å®šé›†æ˜¾ä½¿ç”¨ç‰¹å®šçš„ VA-API ç¡¬ä»¶åŠ é€Ÿé©±åŠ¨ <code>export LIBVA_DRIVER_NAME=iHD</code>ï¼Œå¼ºåˆ¶å¼€å¯ VA-API ç¡¬è§£ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é€šè¿‡ä¸‹é¢è¿™ä¸ªå‘½ä»¤æŸ¥çœ‹å½“å‰ GPU ä½¿ç”¨æƒ…å†µ</span>
sudo intel_gpu_top
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/edd8050c98d94f82bfef75389983c57e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU0hFUmxvY2tlZDkz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766741007&amp;x-signature=m8nNA44wSpO%2Bx%2FIIRpbV7D42TJg%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœ intel_gpu_top å‘½ä»¤ Engine çš„ Video ä¸ä¸º 0ï¼Œåˆ™è¯´æ˜ç¡¬è§£æˆåŠŸï¼Œäº‹å®è¯æ˜å¦‚æœå¯ä»¥æˆåŠŸå¼€å¯ GPU ç¡¬è§£ï¼Œé‚£ä¹ˆå³ä½¿ä½¿ç”¨é›†æ˜¾ï¼ŒCPU è´Ÿè½½ä¹Ÿèƒ½ä¿æŒè¾ƒä½æ°´å¹³ã€‚å¦‚æœä½¿ç”¨ AMD/NVIDIA æ˜¾å¡ï¼Œéœ€è¦å‚è€ƒå¯¹åº”çš„ VA-API é©±åŠ¨æ–‡æ¡£ï¼Œç¡®ä¿ç¡¬è§£è¢«æ­£ç¡®å¯ç”¨ã€‚</p>
<h2 data-id="heading-14">äº”ã€æ€»ç»“</h2>
<p>é€šè¿‡ SRS å°† RTSP + H.264 è§†é¢‘æµè½¬å°è£…ä¸º WebRTC + H.264ï¼Œå¹¶åœ¨å‰ç«¯æµè§ˆå™¨å’Œ Qt æ¡Œé¢åº”ç”¨ä¸­æ’­æ”¾ï¼ŒæˆåŠŸå®ç°äº†å¤šè·¯ä½å»¶è¿Ÿçš„å®æ—¶è§†é¢‘ç›‘æ§éœ€æ±‚ã€‚æˆ‘è¿™è¾¹åœ¨å®é™…æµ‹è¯•ä¸­ï¼Œi7-7700 çš„ CPU ä¸Šä½¿ç”¨é›†æ˜¾ GPU æ’­æ”¾ 6 è·¯ 1080p H.264 æµï¼ŒCPU æ€»å ç”¨ä¿æŒåœ¨ 20% å·¦å³ï¼Œå»¶è¿Ÿæ§åˆ¶åœ¨ 300-500ms ä¹‹é—´ã€‚</p>
<hr/>
<p>ç½‘ä¸Šçš„å¸–å­å¤§å¤šæ·±æµ…ä¸ä¸€ï¼Œç”šè‡³æœ‰äº›å‰åçŸ›ç›¾ï¼Œåœ¨ä¸‹çš„æ–‡ç« éƒ½æ˜¯å­¦ä¹ è¿‡ç¨‹ä¸­çš„æ€»ç»“ï¼Œå¦‚æœå‘ç°é”™è¯¯ï¼Œæ¬¢è¿ç•™è¨€æŒ‡å‡ºï¼Œå¦‚æœæœ¬æ–‡å¸®åŠ©åˆ°äº†ä½ ï¼Œåˆ«å¿˜äº†ç‚¹èµæ”¯æŒä¸€ä¸‹ï¼Œä½ çš„ç‚¹èµæ˜¯æˆ‘æ›´æ–°çš„æœ€å¤§åŠ¨åŠ›ï¼~</p>
<blockquote>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fossrs.io%2Flts%2Fzh-cn%2Fdocs%2Fv5%2Fdoc%2Fgetting-started" target="_blank" title="https://ossrs.io/lts/zh-cn/docs/v5/doc/getting-started" ref="nofollow noopener noreferrer">SRS Getting Started</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdoc.qt.io%2Fqt-6%2Fqtwebengine-features.html%23feature-h264" target="_blank" title="https://doc.qt.io/qt-6/qtwebengine-features.html#feature-h264" ref="nofollow noopener noreferrer">Qt WebEngine H.264 Feature</a></li>
</ol>
</blockquote>
<p>PSï¼šæœ¬æ–‡åŒæ­¥æ›´æ–°äºåœ¨ä¸‹çš„åšå®¢ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSHERlocked93%2Fblog" target="_blank" title="https://github.com/SHERlocked93/blog" ref="nofollow noopener noreferrer">Github - SHERlocked93/blog</a>
ç³»åˆ—æ–‡ç« ä¸­ï¼Œæ¬¢è¿å¤§å®¶å…³æ³¨æˆ‘çš„å…¬ä¼—å· <code>CPPä¸‹åˆèŒ¶</code>ï¼Œç›´æ¥æœç´¢å³å¯æ·»åŠ ï¼ŒæŒç»­ä¸ºå¤§å®¶æ¨é€ CPP ä»¥åŠ CPP å‘¨è¾¹ç›¸å…³ä¼˜è´¨æŠ€æœ¯æ–‡ï¼Œå…±åŒè¿›æ­¥ï¼Œä¸€èµ·åŠ æ²¹~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆè¶Šæ¥è¶Šå¤šçš„äººæ”¾å¼ƒFlaskè½¬å‘FastAPIï¼Ÿ]]></title>    <link>https://juejin.cn/post/7585180775705657371</link>    <guid>https://juejin.cn/post/7585180775705657371</guid>    <pubDate>2025-12-19T08:43:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585180775705657371" data-draft-id="7585146584893816882" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆè¶Šæ¥è¶Šå¤šçš„äººæ”¾å¼ƒFlaskè½¬å‘FastAPIï¼Ÿ"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2025-12-19T08:43:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å˜»å“ˆbaby"/> <meta itemprop="url" content="https://juejin.cn/user/485305583405066"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆè¶Šæ¥è¶Šå¤šçš„äººæ”¾å¼ƒFlaskè½¬å‘FastAPIï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/485305583405066/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å˜»å“ˆbaby
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T08:43:49.000Z" title="Fri Dec 19 2025 08:43:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¯¦è§£FastAPIçš„æ ¸å¿ƒç‰¹æ€§ã€é¡¹ç›®å®æˆ˜å’Œéƒ¨ç½²æ–¹æ¡ˆï¼Œæ‰“é€ ç°ä»£åŒ–çš„Pythonåç«¯æœåŠ¡ã€‚</p>
</blockquote>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>Python Webæ¡†æ¶é‚£ä¹ˆå¤šï¼Œä¸ºä»€ä¹ˆé€‰FastAPIï¼Ÿ</p>
<ul>
<li><strong>æ€§èƒ½æœ€å¼º</strong>ï¼šåŸºäºStarletteï¼Œæ€§èƒ½åª²ç¾Node.jså’ŒGo</li>
<li><strong>ç±»å‹æç¤º</strong>ï¼šPythonç±»å‹æ³¨è§£ï¼ŒIDEæ™ºèƒ½æç¤º</li>
<li><strong>è‡ªåŠ¨æ–‡æ¡£</strong>ï¼šSwagger/ReDocè‡ªåŠ¨ç”Ÿæˆ</li>
<li><strong>å¼‚æ­¥æ”¯æŒ</strong>ï¼šåŸç”Ÿasync/await</li>
</ul>
<p>ä»Šå¤©æ¥å…¨é¢å­¦ä¹ FastAPIã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€FastAPIç®€ä»‹</h2>
<h3 data-id="heading-2">1.1 å¯¹æ¯”å…¶ä»–æ¡†æ¶</h3>








































<table><thead><tr><th>æ¡†æ¶</th><th>æ€§èƒ½</th><th>å¼‚æ­¥</th><th>ç±»å‹æç¤º</th><th>è‡ªåŠ¨æ–‡æ¡£</th></tr></thead><tbody><tr><td><strong>FastAPI</strong></td><td>â­â­â­â­â­</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>Flask</td><td>â­â­â­</td><td>âŒ</td><td>âŒ</td><td>âŒ</td></tr><tr><td>Django</td><td>â­â­</td><td>âš ï¸</td><td>âŒ</td><td>âŒ</td></tr><tr><td>Tornado</td><td>â­â­â­â­</td><td>âœ…</td><td>âŒ</td><td>âŒ</td></tr></tbody></table>
<h3 data-id="heading-3">1.2 æ ¸å¿ƒç‰¹æ€§</h3>
<pre><code class="hljs language-markdown" lang="markdown">
<span class="hljs-bullet">1.</span> é«˜æ€§èƒ½
   
<span class="hljs-bullet">   -</span> åŸºäºStarletteï¼ˆASGIï¼‰
<span class="hljs-bullet">   -</span> æ€§èƒ½æ¥è¿‘Node.js/Go
<span class="hljs-bullet">2.</span> å¼€å‘æ•ˆç‡
   
<span class="hljs-bullet">   -</span> è‡ªåŠ¨æ•°æ®éªŒè¯ï¼ˆPydanticï¼‰
<span class="hljs-bullet">   -</span> è‡ªåŠ¨APIæ–‡æ¡£
<span class="hljs-bullet">   -</span> IDEæ™ºèƒ½è¡¥å…¨
<span class="hljs-bullet">3.</span> æ ‡å‡†åŒ–
   
<span class="hljs-bullet">   -</span> OpenAPIè§„èŒƒ
<span class="hljs-bullet">   -</span> JSON Schema
<span class="hljs-bullet">   -</span> OAuth2/JWTæ”¯æŒ

</code></pre>
<hr/>
<h2 data-id="heading-4">äºŒã€ç¯å¢ƒæ­å»º</h2>
<h3 data-id="heading-5">2.1 å®‰è£…</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</span>
python -m venv venv
<span class="hljs-built_in">source</span> venv/bin/activate  <span class="hljs-comment"># Linux/Mac</span>
<span class="hljs-comment"># venv\Scripts\activate  # Windows</span>

<span class="hljs-comment"># å®‰è£…FastAPI</span>
pip install fastapi

<span class="hljs-comment"># å®‰è£…ASGIæœåŠ¡å™¨</span>
pip install <span class="hljs-string">"uvicorn[standard]"</span>

<span class="hljs-comment"># å¸¸ç”¨ä¾èµ–</span>
pip install python-multipart  <span class="hljs-comment"># è¡¨å•</span>
pip install python-jose[cryptography]  <span class="hljs-comment"># JWT</span>
pip install passlib[bcrypt]  <span class="hljs-comment"># å¯†ç åŠ å¯†</span>
pip install sqlalchemy  <span class="hljs-comment"># ORM</span>
pip install aiosqlite  <span class="hljs-comment"># å¼‚æ­¥SQLite</span>
</code></pre>
<h3 data-id="heading-6">2.2 ç¬¬ä¸€ä¸ªåº”ç”¨</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># main.py</span>
<span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI

app = FastAPI(
    title=<span class="hljs-string">"æˆ‘çš„API"</span>,
    description=<span class="hljs-string">"FastAPIå­¦ä¹ é¡¹ç›®"</span>,
    version=<span class="hljs-string">"1.0.0"</span>
)

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">root</span>():
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"Hello FastAPI!"</span>}

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/items/{item_id}"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_item</span>(<span class="hljs-params">item_id: <span class="hljs-built_in">int</span>, q: <span class="hljs-built_in">str</span> = <span class="hljs-literal">None</span></span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"item_id"</span>: item_id, <span class="hljs-string">"q"</span>: q}
</code></pre>
<h3 data-id="heading-7">2.3 è¿è¡Œ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡è½½ï¼‰</span>
uvicorn main:app --reload --host 0.0.0.0 --port 8000

<span class="hljs-comment"># è®¿é—®</span>
<span class="hljs-comment"># API: http://localhost:8000</span>
<span class="hljs-comment"># Swaggeræ–‡æ¡£: http://localhost:8000/docs</span>
<span class="hljs-comment"># ReDocæ–‡æ¡£: http://localhost:8000/redoc</span>
</code></pre>
<hr/>
<h2 data-id="heading-8">ä¸‰ã€æ ¸å¿ƒåŠŸèƒ½</h2>
<h3 data-id="heading-9">3.1 è·¯å¾„å‚æ•°</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, Path

app = FastAPI()

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/users/{user_id}"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user</span>(<span class="hljs-params">
    user_id: <span class="hljs-built_in">int</span> = Path(<span class="hljs-params">..., title=<span class="hljs-string">"ç”¨æˆ·ID"</span>, ge=<span class="hljs-number">1</span></span>)  <span class="hljs-comment"># &gt;=1</span>
</span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"user_id"</span>: user_id}

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/files/{file_path:path}"</span></span>)  </span><span class="hljs-comment"># åŒ¹é…è·¯å¾„</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_file</span>(<span class="hljs-params">file_path: <span class="hljs-built_in">str</span></span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"file_path"</span>: file_path}
</code></pre>
<h3 data-id="heading-10">3.2 æŸ¥è¯¢å‚æ•°</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, Query
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Optional</span>, <span class="hljs-type">List</span>

app = FastAPI()

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/items/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">list_items</span>(<span class="hljs-params">
    skip: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span>,
    limit: <span class="hljs-built_in">int</span> = Query(<span class="hljs-params">default=<span class="hljs-number">10</span>, le=<span class="hljs-number">100</span></span>),  <span class="hljs-comment"># æœ€å¤§100</span>
    q: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = Query(<span class="hljs-params"><span class="hljs-literal">None</span>, min_length=<span class="hljs-number">3</span>, max_length=<span class="hljs-number">50</span></span>),
    tags: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>] = Query(<span class="hljs-params">default=[]</span>)
</span>):
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"skip"</span>: skip,
        <span class="hljs-string">"limit"</span>: limit,
        <span class="hljs-string">"q"</span>: q,
        <span class="hljs-string">"tags"</span>: tags
    }
</code></pre>
<h3 data-id="heading-11">3.3 è¯·æ±‚ä½“ï¼ˆPydanticæ¨¡å‹ï¼‰</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel, Field, EmailStr
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Optional</span>
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime

app = FastAPI()

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserCreate</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    username: <span class="hljs-built_in">str</span> = Field(..., min_length=<span class="hljs-number">3</span>, max_length=<span class="hljs-number">20</span>)
    email: EmailStr
    password: <span class="hljs-built_in">str</span> = Field(..., min_length=<span class="hljs-number">6</span>)
    age: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>] = Field(<span class="hljs-literal">None</span>, ge=<span class="hljs-number">0</span>, le=<span class="hljs-number">150</span>)
    
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Config</span>:
        json_schema_extra = {
            <span class="hljs-string">"example"</span>: {
                <span class="hljs-string">"username"</span>: <span class="hljs-string">"å¼ ä¸‰"</span>,
                <span class="hljs-string">"email"</span>: <span class="hljs-string">"zhangsan@example.com"</span>,
                <span class="hljs-string">"password"</span>: <span class="hljs-string">"123456"</span>,
                <span class="hljs-string">"age"</span>: <span class="hljs-number">25</span>
            }
        }

<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserResponse</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    <span class="hljs-built_in">id</span>: <span class="hljs-built_in">int</span>
    username: <span class="hljs-built_in">str</span>
    email: <span class="hljs-built_in">str</span>
    created_at: datetime

<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/users/"</span>, response_model=UserResponse</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_user</span>(<span class="hljs-params">user: UserCreate</span>):
    <span class="hljs-comment"># åˆ›å»ºç”¨æˆ·é€»è¾‘</span>
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"id"</span>: <span class="hljs-number">1</span>,
        <span class="hljs-string">"username"</span>: user.username,
        <span class="hljs-string">"email"</span>: user.email,
        <span class="hljs-string">"created_at"</span>: datetime.now()
    }
</code></pre>
<h3 data-id="heading-12">3.4 è¡¨å•å’Œæ–‡ä»¶ä¸Šä¼ </h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, File, UploadFile, Form
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>

app = FastAPI()

<span class="hljs-comment"># è¡¨å•æ•°æ®</span>
<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/login/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">
    username: <span class="hljs-built_in">str</span> = Form(<span class="hljs-params">...</span>),
    password: <span class="hljs-built_in">str</span> = Form(<span class="hljs-params">...</span>)
</span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"username"</span>: username}

<span class="hljs-comment"># æ–‡ä»¶ä¸Šä¼ </span>
<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/upload/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">upload_file</span>(<span class="hljs-params">file: UploadFile = File(<span class="hljs-params">...</span>)</span>):
    contents = <span class="hljs-keyword">await</span> file.read()
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"filename"</span>: file.filename,
        <span class="hljs-string">"size"</span>: <span class="hljs-built_in">len</span>(contents),
        <span class="hljs-string">"content_type"</span>: file.content_type
    }

<span class="hljs-comment"># å¤šæ–‡ä»¶ä¸Šä¼ </span>
<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/uploads/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">upload_files</span>(<span class="hljs-params">files: <span class="hljs-type">List</span>[UploadFile] = File(<span class="hljs-params">...</span>)</span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"filenames"</span>: [f.filename <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> files]}
</code></pre>
<hr/>
<h2 data-id="heading-13">å››ã€ä¾èµ–æ³¨å…¥</h2>
<h3 data-id="heading-14">4.1 åŸºæœ¬ä¾èµ–</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, Depends, HTTPException, status

app = FastAPI()

<span class="hljs-comment"># ç®€å•ä¾èµ–</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">common_parameters</span>(<span class="hljs-params">q: <span class="hljs-built_in">str</span> = <span class="hljs-literal">None</span>, skip: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span>, limit: <span class="hljs-built_in">int</span> = <span class="hljs-number">10</span></span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"q"</span>: q, <span class="hljs-string">"skip"</span>: skip, <span class="hljs-string">"limit"</span>: limit}

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/items/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">list_items</span>(<span class="hljs-params">commons: <span class="hljs-built_in">dict</span> = Depends(<span class="hljs-params">common_parameters</span>)</span>):
    <span class="hljs-keyword">return</span> commons

<span class="hljs-comment"># ç±»ä½œä¸ºä¾èµ–</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Pagination</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, page: <span class="hljs-built_in">int</span> = <span class="hljs-number">1</span>, size: <span class="hljs-built_in">int</span> = <span class="hljs-number">10</span></span>):
        self.page = page
        self.size = size
        self.skip = (page - <span class="hljs-number">1</span>) * size

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/users/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">list_users</span>(<span class="hljs-params">pagination: Pagination = Depends(<span class="hljs-params"/>)</span>):
    <span class="hljs-keyword">return</span> {
        <span class="hljs-string">"page"</span>: pagination.page,
        <span class="hljs-string">"size"</span>: pagination.size,
        <span class="hljs-string">"skip"</span>: pagination.skip
    }
</code></pre>
<h3 data-id="heading-15">4.2 æ•°æ®åº“ä¾èµ–</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sqlalchemy.ext.asyncio <span class="hljs-keyword">import</span> AsyncSession, create_async_engine
<span class="hljs-keyword">from</span> sqlalchemy.orm <span class="hljs-keyword">import</span> sessionmaker

<span class="hljs-comment"># æ•°æ®åº“é…ç½®</span>
DATABASE_URL = <span class="hljs-string">"sqlite+aiosqlite:///./app.db"</span>
engine = create_async_engine(DATABASE_URL, echo=<span class="hljs-literal">True</span>)
AsyncSessionLocal = sessionmaker(engine, class_=AsyncSession, expire_on_commit=<span class="hljs-literal">False</span>)

<span class="hljs-comment"># æ•°æ®åº“ä¾èµ–</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_db</span>():
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> AsyncSessionLocal() <span class="hljs-keyword">as</span> session:
        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">yield</span> session
        <span class="hljs-keyword">finally</span>:
            <span class="hljs-keyword">await</span> session.close()

<span class="hljs-comment"># ä½¿ç”¨</span>
<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/users/{user_id}"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user</span>(<span class="hljs-params">user_id: <span class="hljs-built_in">int</span>, db: AsyncSession = Depends(<span class="hljs-params">get_db</span>)</span>):
    <span class="hljs-comment"># ä½¿ç”¨dbè¿›è¡Œæ•°æ®åº“æ“ä½œ</span>
    <span class="hljs-keyword">pass</span>
</code></pre>
<hr/>
<h2 data-id="heading-16">äº”ã€è®¤è¯ä¸æˆæƒ</h2>
<h3 data-id="heading-17">5.1 JWTè®¤è¯</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, Depends, HTTPException, status
<span class="hljs-keyword">from</span> fastapi.security <span class="hljs-keyword">import</span> OAuth2PasswordBearer, OAuth2PasswordRequestForm
<span class="hljs-keyword">from</span> jose <span class="hljs-keyword">import</span> JWTError, jwt
<span class="hljs-keyword">from</span> passlib.context <span class="hljs-keyword">import</span> CryptContext
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime, timedelta
<span class="hljs-keyword">from</span> pydantic <span class="hljs-keyword">import</span> BaseModel

app = FastAPI()

<span class="hljs-comment"># é…ç½®</span>
SECRET_KEY = <span class="hljs-string">"your-secret-key-keep-it-secret"</span>
ALGORITHM = <span class="hljs-string">"HS256"</span>
ACCESS_TOKEN_EXPIRE_MINUTES = <span class="hljs-number">30</span>

pwd_context = CryptContext(schemes=[<span class="hljs-string">"bcrypt"</span>], deprecated=<span class="hljs-string">"auto"</span>)
oauth2_scheme = OAuth2PasswordBearer(tokenUrl=<span class="hljs-string">"token"</span>)

<span class="hljs-comment"># æ¨¡å‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Token</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    access_token: <span class="hljs-built_in">str</span>
    token_type: <span class="hljs-built_in">str</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    username: <span class="hljs-built_in">str</span>
    email: <span class="hljs-built_in">str</span>
    disabled: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>

<span class="hljs-comment"># æ¨¡æ‹Ÿç”¨æˆ·æ•°æ®åº“</span>
fake_users_db = {
    <span class="hljs-string">"admin"</span>: {
        <span class="hljs-string">"username"</span>: <span class="hljs-string">"admin"</span>,
        <span class="hljs-string">"email"</span>: <span class="hljs-string">"admin@example.com"</span>,
        <span class="hljs-string">"hashed_password"</span>: pwd_context.<span class="hljs-built_in">hash</span>(<span class="hljs-string">"admin123"</span>),
        <span class="hljs-string">"disabled"</span>: <span class="hljs-literal">False</span>
    }
}

<span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">verify_password</span>(<span class="hljs-params">plain_password, hashed_password</span>):
    <span class="hljs-keyword">return</span> pwd_context.verify(plain_password, hashed_password)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">create_access_token</span>(<span class="hljs-params">data: <span class="hljs-built_in">dict</span>, expires_delta: timedelta = <span class="hljs-literal">None</span></span>):
    to_encode = data.copy()
    expire = datetime.utcnow() + (expires_delta <span class="hljs-keyword">or</span> timedelta(minutes=<span class="hljs-number">15</span>))
    to_encode.update({<span class="hljs-string">"exp"</span>: expire})
    <span class="hljs-keyword">return</span> jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_current_user</span>(<span class="hljs-params">token: <span class="hljs-built_in">str</span> = Depends(<span class="hljs-params">oauth2_scheme</span>)</span>):
    credentials_exception = HTTPException(
        status_code=status.HTTP_401_UNAUTHORIZED,
        detail=<span class="hljs-string">"è®¤è¯å¤±è´¥"</span>,
        headers={<span class="hljs-string">"WWW-Authenticate"</span>: <span class="hljs-string">"Bearer"</span>},
    )
    <span class="hljs-keyword">try</span>:
        payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])
        username: <span class="hljs-built_in">str</span> = payload.get(<span class="hljs-string">"sub"</span>)
        <span class="hljs-keyword">if</span> username <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">raise</span> credentials_exception
    <span class="hljs-keyword">except</span> JWTError:
        <span class="hljs-keyword">raise</span> credentials_exception
    
    user = fake_users_db.get(username)
    <span class="hljs-keyword">if</span> user <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
        <span class="hljs-keyword">raise</span> credentials_exception
    <span class="hljs-keyword">return</span> User(**user)

<span class="hljs-comment"># ç™»å½•æ¥å£</span>
<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/token"</span>, response_model=Token</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">form_data: OAuth2PasswordRequestForm = Depends(<span class="hljs-params"/>)</span>):
    user = fake_users_db.get(form_data.username)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> user <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> verify_password(form_data.password, user[<span class="hljs-string">"hashed_password"</span>]):
        <span class="hljs-keyword">raise</span> HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail=<span class="hljs-string">"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"</span>
        )
    
    access_token = create_access_token(
        data={<span class="hljs-string">"sub"</span>: user[<span class="hljs-string">"username"</span>]},
        expires_delta=timedelta(minutes=ACCESS_TOKEN_EXPIRE_MINUTES)
    )
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"access_token"</span>: access_token, <span class="hljs-string">"token_type"</span>: <span class="hljs-string">"bearer"</span>}

<span class="hljs-comment"># å—ä¿æŠ¤çš„æ¥å£</span>
<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/users/me"</span>, response_model=User</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_users_me</span>(<span class="hljs-params">current_user: User = Depends(<span class="hljs-params">get_current_user</span>)</span>):
    <span class="hljs-keyword">return</span> current_user
</code></pre>
<hr/>
<h2 data-id="heading-18">å…­ã€ä¸­é—´ä»¶ä¸å¼‚å¸¸å¤„ç†</h2>
<h3 data-id="heading-19">6.1 ä¸­é—´ä»¶</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, Request
<span class="hljs-keyword">from</span> fastapi.middleware.cors <span class="hljs-keyword">import</span> CORSMiddleware
<span class="hljs-keyword">import</span> time

app = FastAPI()

<span class="hljs-comment"># CORSä¸­é—´ä»¶</span>
app.add_middleware(
    CORSMiddleware,
    allow_origins=[<span class="hljs-string">"*"</span>],  <span class="hljs-comment"># ç”Ÿäº§ç¯å¢ƒæŒ‡å®šåŸŸå</span>
    allow_credentials=<span class="hljs-literal">True</span>,
    allow_methods=[<span class="hljs-string">"*"</span>],
    allow_headers=[<span class="hljs-string">"*"</span>],
)

<span class="hljs-comment"># è‡ªå®šä¹‰ä¸­é—´ä»¶</span>
<span class="hljs-meta">@app.middleware(<span class="hljs-params"><span class="hljs-string">"http"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_process_time_header</span>(<span class="hljs-params">request: Request, call_next</span>):
    start_time = time.time()
    response = <span class="hljs-keyword">await</span> call_next(request)
    process_time = time.time() - start_time
    response.headers[<span class="hljs-string">"X-Process-Time"</span>] = <span class="hljs-built_in">str</span>(process_time)
    <span class="hljs-keyword">return</span> response

<span class="hljs-comment"># è¯·æ±‚æ—¥å¿—ä¸­é—´ä»¶</span>
<span class="hljs-meta">@app.middleware(<span class="hljs-params"><span class="hljs-string">"http"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">log_requests</span>(<span class="hljs-params">request: Request, call_next</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è¯·æ±‚: <span class="hljs-subst">{request.method}</span> <span class="hljs-subst">{request.url}</span>"</span>)
    response = <span class="hljs-keyword">await</span> call_next(request)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å“åº”: <span class="hljs-subst">{response.status_code}</span>"</span>)
    <span class="hljs-keyword">return</span> response
</code></pre>
<h3 data-id="heading-20">6.2 å¼‚å¸¸å¤„ç†</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, HTTPException, Request
<span class="hljs-keyword">from</span> fastapi.responses <span class="hljs-keyword">import</span> JSONResponse

app = FastAPI()

<span class="hljs-comment"># è‡ªå®šä¹‰å¼‚å¸¸</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomException</span>(<span class="hljs-title class_ inherited__">Exception</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, code: <span class="hljs-built_in">int</span>, message: <span class="hljs-built_in">str</span></span>):
        self.code = code
        self.message = message

<span class="hljs-comment"># å¼‚å¸¸å¤„ç†å™¨</span>
<span class="hljs-meta">@app.exception_handler(<span class="hljs-params">CustomException</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">custom_exception_handler</span>(<span class="hljs-params">request: Request, exc: CustomException</span>):
    <span class="hljs-keyword">return</span> JSONResponse(
        status_code=exc.code,
        content={<span class="hljs-string">"code"</span>: exc.code, <span class="hljs-string">"message"</span>: exc.message}
    )

<span class="hljs-comment"># å…¨å±€å¼‚å¸¸å¤„ç†</span>
<span class="hljs-meta">@app.exception_handler(<span class="hljs-params">Exception</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">global_exception_handler</span>(<span class="hljs-params">request: Request, exc: Exception</span>):
    <span class="hljs-keyword">return</span> JSONResponse(
        status_code=<span class="hljs-number">500</span>,
        content={<span class="hljs-string">"code"</span>: <span class="hljs-number">500</span>, <span class="hljs-string">"message"</span>: <span class="hljs-string">"æœåŠ¡å™¨å†…éƒ¨é”™è¯¯"</span>}
    )

<span class="hljs-comment"># ä½¿ç”¨</span>
<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/items/{item_id}"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_item</span>(<span class="hljs-params">item_id: <span class="hljs-built_in">int</span></span>):
    <span class="hljs-keyword">if</span> item_id &lt; <span class="hljs-number">0</span>:
        <span class="hljs-keyword">raise</span> CustomException(code=<span class="hljs-number">400</span>, message=<span class="hljs-string">"IDä¸èƒ½ä¸ºè´Ÿæ•°"</span>)
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"item_id"</span>: item_id}
</code></pre>
<hr/>
<h2 data-id="heading-21">ä¸ƒã€é¡¹ç›®ç»“æ„</h2>
<h3 data-id="heading-22">7.1 æ¨èç»“æ„</h3>
<pre><code class="hljs language-bash" lang="bash">project/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py              <span class="hljs-comment"># å…¥å£</span>
â”‚   â”œâ”€â”€ config.py            <span class="hljs-comment"># é…ç½®</span>
â”‚   â”œâ”€â”€ database.py          <span class="hljs-comment"># æ•°æ®åº“</span>
â”‚   â”œâ”€â”€ models/              <span class="hljs-comment"># æ•°æ®æ¨¡å‹</span>
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ user.py
â”‚   â”œâ”€â”€ schemas/             <span class="hljs-comment"># Pydanticæ¨¡å‹</span>
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ user.py
â”‚   â”œâ”€â”€ routers/             <span class="hljs-comment"># è·¯ç”±</span>
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ users.py
â”‚   â”‚   â””â”€â”€ items.py
â”‚   â”œâ”€â”€ services/            <span class="hljs-comment"># ä¸šåŠ¡é€»è¾‘</span>
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ user_service.py
â”‚   â””â”€â”€ utils/               <span class="hljs-comment"># å·¥å…·å‡½æ•°</span>
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ auth.py
â”œâ”€â”€ tests/                   <span class="hljs-comment"># æµ‹è¯•</span>
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
</code></pre>
<h3 data-id="heading-23">7.2 è·¯ç”±ç»„ç»‡</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># app/routers/users.py</span>
<span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> APIRouter, Depends

router = APIRouter(
    prefix=<span class="hljs-string">"/users"</span>,
    tags=[<span class="hljs-string">"ç”¨æˆ·ç®¡ç†"</span>]
)

<span class="hljs-meta">@router.get(<span class="hljs-params"><span class="hljs-string">"/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">list_users</span>():
    <span class="hljs-keyword">return</span> []

<span class="hljs-meta">@router.get(<span class="hljs-params"><span class="hljs-string">"/{user_id}"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user</span>(<span class="hljs-params">user_id: <span class="hljs-built_in">int</span></span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"user_id"</span>: user_id}

<span class="hljs-comment"># app/main.py</span>
<span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI
<span class="hljs-keyword">from</span> app.routers <span class="hljs-keyword">import</span> users, items

app = FastAPI()

app.include_router(users.router)
app.include_router(items.router)
</code></pre>
<hr/>
<h2 data-id="heading-24">å…«ã€éƒ¨ç½²æ–¹æ¡ˆ</h2>
<h3 data-id="heading-25">8.1 Dockeréƒ¨ç½²</h3>
<pre><code class="hljs language-dockerfile" lang="dockerfile"># Dockerfile
FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
</code></pre>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># docker-compose.yml</span>
<span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-attr">api:</span>
    <span class="hljs-attr">build:</span> <span class="hljs-string">.</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"8000:8000"</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">DATABASE_URL=postgresql://user:pass@db:5432/mydb</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">db</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>

  <span class="hljs-attr">db:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">postgres:15</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">POSTGRES_USER=user</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">POSTGRES_PASSWORD=pass</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">POSTGRES_DB=mydb</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">postgres_data:/var/lib/postgresql/data</span>

<span class="hljs-attr">volumes:</span>
  <span class="hljs-attr">postgres_data:</span>
</code></pre>
<h3 data-id="heading-26">8.2 Nginxåå‘ä»£ç†</h3>
<pre><code class="hljs language-nginx" lang="nginx">server {
    listen 80;
    server_name api.example.com;

    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
</code></pre>
<h3 data-id="heading-27">8.3 è¿œç¨‹è®¿é—®</h3>
<p>éƒ¨ç½²åœ¨å†…ç½‘æœåŠ¡å™¨çš„APIï¼Œå¦‚ä½•è®©å¤–ç½‘è®¿é—®ï¼Ÿ</p>
<pre><code class="hljs language-markdown" lang="markdown">æ–¹æ¡ˆå¯¹æ¯”ï¼š
<span class="hljs-bullet">1.</span> å…¬ç½‘æš´éœ² + HTTPS â†’ éœ€è¦å…¬ç½‘IPï¼Œå®‰å…¨é£é™©
<span class="hljs-bullet">2.</span> Cloudflare Tunnel â†’ é…ç½®å¤æ‚
<span class="hljs-bullet">3.</span> ç»„ç½‘è½¯ä»¶ â†’ æœ€ç®€å•å®‰å…¨

ä½¿ç”¨ç»„ç½‘è½¯ä»¶ï¼ˆå¦‚æ˜Ÿç©ºç»„ç½‘ï¼‰ï¼š
<span class="hljs-bullet">-</span> æœåŠ¡å™¨å®‰è£…ç»„ç½‘å®¢æˆ·ç«¯
<span class="hljs-bullet">-</span> å¼€å‘æœºå®‰è£…ç»„ç½‘å®¢æˆ·ç«¯
<span class="hljs-bullet">-</span> é€šè¿‡è™šæ‹ŸIPè®¿é—®API

é€‚ç”¨åœºæ™¯ï¼š
<span class="hljs-bullet">-</span> å¼€å‘æµ‹è¯•é˜¶æ®µ
<span class="hljs-bullet">-</span> å†…éƒ¨ç³»ç»Ÿ
<span class="hljs-bullet">-</span> ä¸æƒ³æš´éœ²å…¬ç½‘çš„API
</code></pre>
<hr/>
<h2 data-id="heading-28">ä¹ã€æ€§èƒ½ä¼˜åŒ–</h2>
<h3 data-id="heading-29">9.1 å¼‚æ­¥æ•°æ®åº“</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sqlalchemy.ext.asyncio <span class="hljs-keyword">import</span> AsyncSession, create_async_engine
<span class="hljs-keyword">from</span> sqlalchemy.future <span class="hljs-keyword">import</span> select

<span class="hljs-comment"># å¼‚æ­¥æŸ¥è¯¢</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_users</span>(<span class="hljs-params">db: AsyncSession</span>):
    result = <span class="hljs-keyword">await</span> db.execute(select(User))
    <span class="hljs-keyword">return</span> result.scalars().<span class="hljs-built_in">all</span>()
</code></pre>
<h3 data-id="heading-30">9.2 åå°ä»»åŠ¡</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI, BackgroundTasks

app = FastAPI()

<span class="hljs-keyword">def</span> <span class="hljs-title function_">send_email</span>(<span class="hljs-params">email: <span class="hljs-built_in">str</span>, message: <span class="hljs-built_in">str</span></span>):
    <span class="hljs-comment"># å‘é€é‚®ä»¶çš„è€—æ—¶æ“ä½œ</span>
    <span class="hljs-keyword">pass</span>

<span class="hljs-meta">@app.post(<span class="hljs-params"><span class="hljs-string">"/notify/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">send_notification</span>(<span class="hljs-params">
    email: <span class="hljs-built_in">str</span>,
    background_tasks: BackgroundTasks
</span>):
    background_tasks.add_task(send_email, email, <span class="hljs-string">"é€šçŸ¥æ¶ˆæ¯"</span>)
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"é€šçŸ¥å·²å‘é€"</span>}
</code></pre>
<h3 data-id="heading-31">9.3 ç¼“å­˜</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> lru_cache
<span class="hljs-keyword">from</span> fastapi <span class="hljs-keyword">import</span> FastAPI

app = FastAPI()

<span class="hljs-meta">@lru_cache()</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_settings</span>():
    <span class="hljs-comment"># è¯»å–é…ç½®ï¼ˆåªæ‰§è¡Œä¸€æ¬¡ï¼‰</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"app_name"</span>: <span class="hljs-string">"MyAPI"</span>}

<span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">"/settings/"</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_settings</span>():
    <span class="hljs-keyword">return</span> get_settings()
</code></pre>
<hr/>
<h2 data-id="heading-32">åã€æ€»ç»“</h2>
<p>FastAPIæ ¸å¿ƒè¦ç‚¹ï¼š</p>

































<table><thead><tr><th>åŠŸèƒ½</th><th>æ–¹æ³•</th></tr></thead><tbody><tr><td>è·¯å¾„å‚æ•°</td><td><code>@app.get("/items/{id}")</code></td></tr><tr><td>æŸ¥è¯¢å‚æ•°</td><td><code>def read(q: str = None)</code></td></tr><tr><td>è¯·æ±‚ä½“</td><td><code>def create(item: Item)</code></td></tr><tr><td>ä¾èµ–æ³¨å…¥</td><td><code>Depends()</code></td></tr><tr><td>è®¤è¯</td><td><code>OAuth2PasswordBearer</code></td></tr><tr><td>ä¸­é—´ä»¶</td><td><code>@app.middleware("http")</code></td></tr></tbody></table>
<p><strong>FastAPIä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>Pythonæœ€å¿«çš„Webæ¡†æ¶</li>
<li>è‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£</li>
<li>ç±»å‹å®‰å…¨ï¼ŒIDEå‹å¥½</li>
<li>å¼‚æ­¥åŸç”Ÿæ”¯æŒ</li>
</ul>
<hr/>
<h2 data-id="heading-33">å‚è€ƒèµ„æ–™</h2>
<ol>
<li>FastAPIå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ffastapi.tiangolo.com%2F" target="_blank" title="https://fastapi.tiangolo.com/" ref="nofollow noopener noreferrer">fastapi.tiangolo.com/</a></li>
<li>Pydanticæ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.pydantic.dev%2F" target="_blank" title="https://docs.pydantic.dev/" ref="nofollow noopener noreferrer">docs.pydantic.dev/</a></li>
<li>SQLAlchemyå¼‚æ­¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.sqlalchemy.org%2Fen%2F20%2Form%2Fextensions%2Fasyncio.html" target="_blank" title="https://docs.sqlalchemy.org/en/20/orm/extensions/asyncio.html" ref="nofollow noopener noreferrer">docs.sqlalchemy.org/en/20/orm/eâ€¦</a></li>
</ol>
<hr/>
<blockquote>
<p>ğŸ’¡ FastAPIæ˜¯ç°ä»£Pythonåç«¯çš„æœ€ä½³é€‰æ‹©ï¼Œé…åˆç»„ç½‘è½¯ä»¶å¯ä»¥æ–¹ä¾¿åœ°è¿›è¡Œè¿œç¨‹å¼€å‘å’Œæµ‹è¯•ã€‚</p>
</blockquote>
<pre><code class="hljs"/></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ AI å…±ç”Ÿï¼Œè…¾è®¯äº‘æºæ‰‹è¡Œä¸šä¸“å®¶å…±è¯æ•°æ™ºé©±åŠ¨æ–°è´¨ç”Ÿé•¿]]></title>    <link>https://juejin.cn/post/7585385309890789376</link>    <guid>https://juejin.cn/post/7585385309890789376</guid>    <pubDate>2025-12-19T09:30:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585385309890789376" data-draft-id="7585385309890772992" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ AI å…±ç”Ÿï¼Œè…¾è®¯äº‘æºæ‰‹è¡Œä¸šä¸“å®¶å…±è¯æ•°æ™ºé©±åŠ¨æ–°è´¨ç”Ÿé•¿"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-19T09:30:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è…¾è®¯äº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/3456520257538830"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ AI å…±ç”Ÿï¼Œè…¾è®¯äº‘æºæ‰‹è¡Œä¸šä¸“å®¶å…±è¯æ•°æ™ºé©±åŠ¨æ–°è´¨ç”Ÿé•¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3456520257538830/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è…¾è®¯äº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T09:30:07.000Z" title="Fri Dec 19 2025 09:30:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>11 æœˆ 29 æ—¥ï¼Œç”±<strong>è…¾è®¯äº‘ TVP</strong>Â å’Œ<strong>ä¸­å›½æµ·è¯š</strong>è”åˆä¸»åŠçš„ <strong>ã€Œä¸ AI å…±ç”Ÿï¼Œæ•°æ™ºé©±åŠ¨äº§ä¸šæ–°è´¨ç”Ÿé•¿ã€TVP AI åˆ›å˜ç ”è®¨ä¼š</strong>åœ¨ä¸Šæµ·æˆåŠŸä¸¾åŠã€‚</p>
<p>åœ¨æœ¬æ¬¡æ´»åŠ¨ä¸­ï¼Œä¸“å®¶ä»¬å®åœ°å‚è§‚äº†ä¸­å›½æµ·è¯šè½»å·¥åšç‰©é¦†ï¼Œäº†è§£ä¸­å›½è½»å·¥ä¸šçš„å‘å±•å†ç¨‹ï¼Œç›´è§‚æ„Ÿå—ä¸­å›½æµ·è¯šåœ¨ç§‘æŠ€åˆ›æ–°å’Œæ•°æ™ºè½¬å‹æ–¹é¢å–å¾—çš„æˆæœã€‚æ¥è‡ªäº§ä¸šä¸€çº¿ä¸æŠ€æœ¯å‰æ²¿çš„ä¸“å®¶å¤§å’–ï¼Œå›´ç»• AI +æ™ºèƒ½åˆ¶é€ å‘å±•è¶‹åŠ¿ã€é›¶å”®è¡Œä¸š AI æ™ºèƒ½ä½“å‰æ²¿å®è·µã€AI åˆ›æ–°åº”ç”¨è½åœ°è·¯å¾„ã€AI+Data é©±åŠ¨ä¼ä¸šè½¬å‹ç­‰é‡è¦è®®é¢˜ï¼Œå±•å¼€æ·±åº¦åˆ†äº«ä¸æ€æƒ³ç¢°æ’ï¼Œå…±åŒæ¢ç´¢ AI è½åœ°çš„æœ‰æ•ˆè·¯å¾„ä¸å‘å±•æ–¹å‘ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b5a65b667dcc4f768517f34953014427~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766741406&amp;x-signature=5yMsPZOSAWBp%2B0dER37K%2FyvGEjM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1"><strong>ä¸»æŒäººå¼€åœº</strong></h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14b343ffba9f47038d256d82fceb093e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766741406&amp;x-signature=Zf0f4ODdHmR%2FBXxae9Rjwq4R5kM%3D" alt="" loading="lazy"/></p>
<p>è…¾è®¯äº‘TVP èŒƒç»´è‚–</p>
<p>ä¸»æŒäºº<strong>è…¾è®¯äº‘ TVP èŒƒç»´è‚–</strong>åœ¨æ´»åŠ¨å¼€åœºæ—¶è¡¨ç¤ºï¼Œè¿‘å¹´æ¥ï¼Œä»¥äººå·¥æ™ºèƒ½ä¸ºä»£è¡¨çš„æ•°å­—æŠ€æœ¯æ­£åŠ é€Ÿä¸ä¼ ç»Ÿè¡Œä¸šæ·±åº¦èåˆã€‚â€œåäº”äº”â€è§„åˆ’å»ºè®®æ˜ç¡®æå‡ºå› åœ°åˆ¶å®œå‘å±•æ–°è´¨ç”Ÿäº§åŠ›ï¼Œä¸º AI ä¸å„è¡Œå„ä¸šçš„æ·±åº¦èåˆï¼ŒåŠ å¿«å‘å±•æ–°è´¨ç”Ÿäº§åŠ›æŒ‡æ˜äº†æ–¹å‘ã€‚ç„¶è€Œï¼Œä¼ä¸šåœ¨è½åœ°å®è·µæ—¶ä»æ˜¯â€œæ‘¸ç€çŸ³å¤´è¿‡æ²³â€ï¼Œæ—¢é¢ä¸´æŠ€æœ¯é€‚é…ã€ç»„ç»‡å˜é©ç­‰ç°å®æŒ‘æˆ˜ï¼Œä¹ŸäºŸéœ€å¯å¤åˆ¶ã€å¯æ¨å¹¿çš„æ ‡æ†æ¡ˆä¾‹å’Œå®è·µç»éªŒä½œä¸ºæŒ‡å¼•ã€‚</p>
<p>ä¸­å›½æµ·è¯šæ˜¯ä¸€å®¶åº•è•´æ·±åšçš„é¾™å¤´ä¼ä¸šï¼Œåœ¨æ™ºæ…§å·¥ç¨‹ã€æ™ºèƒ½åˆ¶é€ ç­‰é¢†åŸŸå…·å¤‡é¢†å…ˆçš„æŠ€æœ¯å®åŠ›ï¼ŒåŒæ—¶å¯¹ä¸­å›½åˆ¶é€ æœ‰æ·±åˆ»çš„æ´å¯Ÿï¼Œå¹¶åœ¨æœåŠ¡åƒè¡Œç™¾ä¸šçš„å®è·µä¸­ç§¯ç´¯äº†ä¸°å¯Œçš„ç»éªŒã€‚è…¾è®¯äº‘ TVP æ¯å¹´èµ°è¿›å„ä¸ªåŸå¸‚ï¼Œè‡´åŠ›æ­å»ºå¼€æ”¾äº¤æµçš„å¹³å°ï¼ŒåŠ©åŠ›å¤§å®¶äº†è§£ä¼ä¸šå®è·µï¼Œæ¢è®¨è¡Œä¸šå‰æ²¿è¿›å±•ã€‚æœ¬æ¬¡æ´»åŠ¨ä½œä¸ºè…¾è®¯äº‘ TVP æŠ€æœ¯ç ”è®¨ä¼šç³»åˆ—ä¹‹ä¸€ï¼Œæ±‡èšæ¥è‡ªä¸åŒè¡Œä¸šçš„ä¸“å®¶ï¼Œé€šè¿‡å¤šå…ƒè§†è§’æ·±å…¥æ¢è®¨æ•°æ™ºæŠ€æœ¯å¦‚ä½•é©±åŠ¨äº§ä¸šæ–°è´¨ç”Ÿé•¿ã€‚</p>
<h2 data-id="heading-2"><strong>ä¸»åŠæ–¹è‡´è¾</strong></h2>
<p><strong>ä¸­å›½æµ·è¯šå…šå§”ä¹¦è®°ã€æ€»è£ æå£«å†›</strong>åœ¨æ¬¢è¿è¾ä¸­æŒ‡å‡ºï¼Œäººå·¥æ™ºèƒ½æ­£ä»â€œæŠ€æœ¯å¯ç”¨â€è¿ˆå‘â€œä¸äº§ä¸šå…±ç”Ÿâ€çš„å…³é”®é˜¶æ®µï¼Œæˆä¸ºé©±åŠ¨äº§ä¸šæ–°è´¨ç”Ÿé•¿çš„æ ¸å¿ƒåŠ¨åŠ›ã€‚ä»–å¼ºè°ƒï¼Œä¸­å›½æµ·è¯šä½œä¸ºä¿åˆ©ä¸­è½»æ——ä¸‹ç§‘æŠ€å‹å·¥ç¨‹å…¬å¸ï¼Œæ­£å…¨åŠ›æ¨è¿›æ™ºèƒ½åˆ¶é€ ä¸šåŠ¡å‘å±•ï¼Œè‡´åŠ›äºæ‰“é€ æ™ºèƒ½å·¥å‚ç³»ç»Ÿè§£å†³æ–¹æ¡ˆï¼Œæ¨åŠ¨â€œæ•°æ™ºåŒé©±â€æˆ˜ç•¥è½åœ°ã€‚ä»–è¡¨ç¤ºï¼Œä¸­å›½æµ·è¯šå·²è”åˆè¡Œä¸šé¢†å†›å•ä½æˆç«‹â€œè½»å·¥è¡Œä¸šæ™ºèƒ½åˆ¶é€ åˆ›æ–°è”åˆä½“â€ï¼Œæ„å»ºå¼€æ”¾ååŒçš„äº§ä¸šç”Ÿæ€ï¼Œå¹¶æœŸå¾…ä¸è…¾è®¯äº‘ TVP åŠå„ç•Œä¼™ä¼´æºæ‰‹ï¼Œå…±åŒæ¨åŠ¨ AI ä¸å®ä½“ç»æµçš„æ·±åº¦èåˆï¼Œä¸ºä¸­å›½åˆ¶é€ ä¸šè½¬å‹å‡çº§è´¡çŒ®åŠ›é‡ã€‚</p>
<p>ä¸­å›½æµ·è¯šçš„å®šä½æ¸…æ™°ï¼Œç§‰æŒâ€œå¼€æ‹“åˆ›æ–°ã€ç²¾ç›Šå¢æ•ˆã€æ•°æ™ºåŒé©±ã€æ–°è´¨ç”Ÿé•¿â€çš„å‘å±•æ€è·¯ã€‚ä¸­å›½æµ·è¯šæ¨è¿›æ™ºèƒ½åˆ¶é€ ä¸šåŠ¡ï¼ŒåŠ é€Ÿâ€œæ•°æ™ºåŒé©±â€æˆ˜ç•¥è§„åˆ’çš„å®æ–½ï¼Œè‡´åŠ›æˆä¸ºä¼ ç»Ÿå·¥å‚æ™ºèƒ½åŒ–æ”¹é€ çš„æœåŠ¡æä¾›è€…ä¸æ™ºèƒ½å·¥å‚çš„å»ºè®¾è€…ã€‚ä¸­å›½æµ·è¯šæ‹¥æœ‰æ ¸å¿ƒå·¥è‰ºï¼Œç²¾å‡†ç¡®å®šäº§å“ç ”å‘é£å‘ï¼Œæ´å¯Ÿå®¢æˆ·éœ€æ±‚ï¼Œç§‰æŒå¼€æ”¾åŒ…å®¹çš„æ€åº¦ï¼Œç§¯ææºæ‰‹å„ç•Œï¼Œå…±åŒæ¢ç´¢æ™ºèƒ½åˆ¶é€ ä¹‹è·¯ã€‚åœ¨ 2025 ä¸–ç•Œè®¾è®¡ä¹‹éƒ½å¤§ä¼šä¸Šï¼Œä¸­å›½æµ·è¯šè”åˆå¤šå®¶æ™ºèƒ½åˆ¶é€ ä¼ä¸šã€åä¼šã€é«˜æ ¡ç­‰ç›¸å…³å•ä½æˆç«‹â€œè½»å·¥è¡Œä¸šæ™ºèƒ½åˆ¶é€ åˆ›æ–°è”åˆä½“ç”Ÿæ€åˆä½œåœˆâ€ä¸â€œè½»å·¥è¡Œä¸šæ™ºèƒ½åˆ¶é€ åˆ›æ–°è”åˆä½“â€ï¼Œæ—¨åœ¨æ„å»ºå¼€æ”¾ååŒçš„åˆ›æ–°ç”Ÿæ€ã€‚</p>
<p>è…¾è®¯äº‘åœ¨ AI èµ‹èƒ½äº§ä¸šå‘å±•ä¸æœåŠ¡å®¢æˆ·æ–¹é¢å–å¾—æ˜¾è‘—æˆæ•ˆï¼Œç‰¹åˆ«æ˜¯åœ¨è½»å·¥é¢†åŸŸï¼Œä¸ºå·¥ä¸šæ™ºèƒ½åŒ–æä¾›äº†è¯¸å¤šæ”¯æ’‘ã€‚ä¸­å›½æµ·è¯šä¸è…¾è®¯äº‘æºæ‰‹å¹¶è¿›ï¼Œå…±èµ´æ™ºèƒ½åˆ¶é€ ä¹‹æ—…ã€‚æœªæ¥ï¼Œä¸­å›½æµ·è¯šæ„¿ä¸ä¸šç•ŒåŒä»æºæ‰‹ï¼Œä»¥åŠ¡å®çš„æ€åº¦ã€ä¸“ä¸šç²¾ç¥ï¼Œæ‹“å±•å·¥ç¨‹è¾¹ç•Œï¼Œæ„å»ºäº§ä¸šååŒç½‘ç»œï¼Œä¸€åŒæŒ–æ˜æ™ºèƒ½åˆ¶é€ åº”ç”¨åœºæ™¯ï¼Œæ”»å…‹å…³é”®æŠ€æœ¯éš¾é¢˜ï¼Œæ‰“é€ æ ‡æ†é¡¹ç›®ï¼Œæ¨å¹¿åˆ›æ–°æˆæœï¼Œä¸ºä¸­å›½åˆ¶é€ ä¸šçš„è½¬å‹å‡çº§è´¡çŒ®åŠ›é‡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91d8cdd905fd425c98a0c9106dd99ed2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766741406&amp;x-signature=MqtjAc8rk3X02ngIscoRAerXFQo%3D" alt="" loading="lazy"/></p>
<p>è…¾è®¯äº‘å¼€å‘è€…ä¸šåŠ¡æ€»ç›‘ æä½³å¿†</p>
<p><strong>è…¾è®¯äº‘å¼€å‘è€…ä¸šåŠ¡æ€»ç›‘ æä½³å¿†</strong>è¡¨ç¤ºï¼Œè¿‘å¹´æ¥ï¼Œéšç€ AI æŠ€æœ¯çš„æŒç»­å‘å±•ï¼Œæˆ‘å›½å·¥ä¸šå‘å±•è¿æ¥äº†æ–°çš„å…³é”®èŠ‚ç‚¹ã€‚â€œåäº”äº”â€è§„åˆ’æ˜ç¡®æå‡ºæ¨è¿›æ–°å‹å·¥ä¸šåŒ–ï¼ŒåŠ å¿«å»ºè®¾åˆ¶é€ å¼ºå›½ã€è´¨é‡å¼ºå›½ï¼Œæ˜ç¡®ä»¥æ™ºèƒ½åˆ¶é€ ä¸ºå…³é”®é©±åŠ¨åŠ›ï¼Œæ¨åŠ¨äº§ä¸šæ•°å­—åŒ–ã€æ™ºèƒ½åŒ–å‡çº§ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè…¾è®¯äº‘ä¸ä¸­å›½è½»å·¥ä¸šå…±åŒæˆé•¿ï¼Œå¹¶ä¸ä¸­å›½æµ·è¯šæºæ‰‹åŠ©åŠ›å›½å®¶å·¥ä¸šå˜é©ã€‚</p>
<p>è…¾è®¯äº‘å§‹ç»ˆåšæŒä»¥æŠ€æœ¯ä¸ºé©±åŠ¨ï¼Œä»¥å®¢æˆ·ä¸ºä¸­å¿ƒï¼Œå‡­å€Ÿæ‰å®çš„æŠ€æœ¯å®åŠ›ä¸é«˜æ»¡æ„åº¦çš„å®¢æœåŠ¡ä½“ç³»ï¼ŒæŒç»­ä¸ºä¼ä¸šæ•°å­—åŒ–è½¬å‹èµ‹èƒ½ï¼Œæˆä¸ºå„è¡Œä¸šé¢†å…ˆçš„æ•°å­—åŒ–åŠ©æ‰‹ã€‚è…¾è®¯äº‘ TVP å¹³å°æ±‡èšä¼—å¤šæ•°å­—åŒ–è½¬å‹ä¸“å®¶ï¼Œè‡´åŠ›äºå°†å‰æ²¿æŠ€æœ¯ä¸è¡Œä¸šç´§å¯†ç»“åˆï¼Œä¸ºå·¥ä¸šäº’è”ç½‘çš„å‘å±•æä¾›åŠ¨åŠ›ã€‚ä¸­å›½æµ·è¯šæ·±åšçš„è¡Œä¸šç§¯æ·€ä¸è…¾è®¯äº‘é¢†å…ˆçš„æ•°å­—æŠ€æœ¯èƒ½åŠ›æ·±åº¦èåˆï¼Œæˆä¸ºå“åº”å›½å®¶å…³äºåŠ å¿«å‘å±•æ–°è´¨ç”Ÿäº§åŠ›çš„ç”ŸåŠ¨å®è·µã€‚é€šè¿‡æ­¤æ¬¡äº¤æµï¼ŒåŒæ–¹åœ¨â€œåäº”äº”â€çš„æ–°èµ·ç‚¹ä¸Šï¼Œå…±åŒä¸ºè½»å·¥ä¸šé«˜ç«¯åŒ–ã€æ™ºèƒ½åŒ–ã€ç»¿è‰²åŒ–å‘å±•æ³¨å…¥æ–°åŠ¨èƒ½ï¼Œä¸ºæ„å»ºç°ä»£åŒ–äº§ä¸šä½“ç³»è´¡çŒ®åŠ›é‡ã€‚æœ¬æ¬¡æ´»åŠ¨é€šè¿‡å„æ–¹çš„äº¤æµï¼Œä¸ºä¸ä¼šè€…æä¾›å¤šå…ƒè§†è§’å’Œæ·±åº¦æ€è€ƒï¼Œè¿›ä¸€æ­¥æ¨åŠ¨ä»¥æ•°å­—åŒ–èµ‹èƒ½æ–°è´¨ç”Ÿäº§åŠ›ç”Ÿé•¿ã€‚</p>
<h2 data-id="heading-3"><strong>ä¸­å›½æµ·è¯šæ™ºèƒ½åˆ¶é€ è§£å†³æ–¹æ¡ˆä»‹ç»</strong></h2>
<p><strong>ä¸­å›½æµ·è¯šå¸¸åŠ¡å‰¯æ€»è£ã€ä¸Šæµ·å¸‚æ™ºèƒ½åˆ¶é€ äº§ä¸šåä¼šå‰¯ä¼šé•¿ã€ä¿åˆ©ä¸­è½»æ™ºèƒ½åˆ¶é€ ç ”ç©¶é™¢å‰¯é™¢é•¿ å¼ å¿—</strong>å‘è¡¨ã€Šä¸­å›½æµ·è¯šæ™ºèƒ½åˆ¶é€ è§£å†³æ–¹æ¡ˆä»‹ç»ã€‹çš„æ¼”è®²ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a14024719bb947ffad37d19dc0f7b797~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766741406&amp;x-signature=6Fyg%2BaWAbI2isDQQoNplnZer5sk%3D" alt="" loading="lazy"/></p>
<p>ä¸­å›½æµ·è¯šå¸¸åŠ¡å‰¯æ€»è£ã€ä¸Šæµ·å¸‚æ™ºèƒ½åˆ¶é€ äº§ä¸šåä¼šå‰¯ä¼šé•¿ã€ä¿åˆ©ä¸­è½»æ™ºèƒ½åˆ¶é€ ç ”ç©¶é™¢å‰¯é™¢é•¿ å¼ å¿—</p>
<p>å¼ å¿—ä»‹ç»äº†ä¸­å›½æµ·è¯šçš„å‘å±•å†å²ï¼š20 ä¸–çºª 50-70 å¹´ä»£ï¼Œå…¶å‰èº«ä¸ºè½»å·¥ä¸šéƒ¨ä¸‹å±è®¾è®¡é™¢ï¼›2002 å¹´ï¼Œè®¾è®¡é™¢åˆå¹¶ç»„å»ºå…¬å¸ï¼Œå®šä½ä¸ºå·¥ç¨‹å…¬å¸ï¼Œå¹¶äº 2007 å¹´ä¸Šå¸‚ï¼›2017 å¹´ï¼Œéšä¸­è½»é›†å›¢å¹¶å…¥ä¿åˆ©é›†å›¢ï¼Œæˆä¸ºè½»å·¥è¡Œä¸šç»¼åˆæ€§å·¥ç¨‹å…¬å¸ã€‚ä¸ºå¸ƒå±€â€œåäº”äº”â€ï¼Œå…¬å¸åŠ é€Ÿæ•°å­—åŒ–è½¬å‹ï¼Œå…¨åŠ›å‘å±•æ™ºèƒ½åˆ¶é€ ä¸šåŠ¡ï¼Œæå‡ºä»ä¼ ç»Ÿå·¥ç¨‹æœåŠ¡å•†å‘â€œå…¨å‘¨æœŸç”Ÿäº§æ€§æœåŠ¡å•†â€è·ƒè¿çš„ç›®æ ‡ï¼ŒåŠ å¿«å‘ç§‘æŠ€å…¬å¸è½¬å‹çš„æ­¥ä¼ã€‚</p>
<p>ä¸ºä½•å…¬å¸å¤§åŠ›å¸ƒå±€æ™ºèƒ½åˆ¶é€ ä¸šåŠ¡ï¼Ÿå¼ å¿—è¡¨ç¤ºï¼ŒåŸå› åŒ…æ‹¬ä»¥ä¸‹å‡ ç‚¹ï¼šä¸€æ˜¯ä¼ ç»Ÿåˆ¶é€ ä¸šæ­¥å…¥ä½å¢é•¿ã€ä½åˆ©æ¶¦ã€é«˜ç«äº‰é˜¶æ®µï¼›äºŒæ˜¯â€œåå†…å·â€æ”¿ç­–ä¸‹ï¼Œèšç„¦æ·˜æ±°ä½æ•ˆäº§èƒ½å’Œè§„èŒƒå¸‚åœºç«äº‰ï¼›ä¸‰æ˜¯å¸‚åœºå¯¼å‘ï¼Œå‚¬ç”Ÿâ€œå¤šå“ç§ã€å°æ‰¹é‡ã€ä¸ªæ€§åŒ–â€çš„ç”Ÿäº§éœ€æ±‚ï¼›å››æ˜¯å·¥ç¨‹è¡Œä¸šæ•´ä½“é¢ä¸´ç»“æ„æ€§è°ƒæ•´ã€‚åŒæ—¶ï¼Œä¼´éšä¸€ç³»åˆ—å…³äºè¡Œä¸šæ•°å­—åŒ–è½¬å‹ä¸æ™ºèƒ½åŒ–å‡çº§ç³»åˆ—æ”¿ç­–çš„å‡ºå°ï¼Œå‘å±•æ™ºèƒ½åˆ¶é€ æ—¢æ˜¯å›½å®¶è¦æ±‚ï¼Œä¹Ÿæ˜¯ä¼ä¸šå®ç°å†…ç”Ÿå‘å±•çš„è¦æ±‚ã€‚</p>
<p>ä¸­å›½æµ·è¯šæ‰“é€ ä¸‰å±‚æ™ºèƒ½å·¥å‚è§£å†³æ–¹æ¡ˆï¼šç¬¬ä¸€å±‚ä¸ºæ™ºæ…§ç®¡ç†ï¼Œå®ç°è¥é”€ã€æˆæœ¬ã€è´¢åŠ¡ã€ç ”å‘ã€é£é™©ã€äººèµ„ç­‰æµç¨‹çš„çº¿ä¸ŠåŒ–å’Œé©¾é©¶èˆ±å¯è§†åŒ–ï¼›ç¬¬äºŒå±‚ä¸ºæ™ºæ…§è¥é€ ï¼ŒåŸºäºè‡ªç ”æµ·è¯šÂ·äº‘å·¥åœºå¹³å°ï¼Œå®ç°å¤šæ–¹åœ¨çº¿ååŒï¼Œä¸ºå»ºç­‘è®¾è®¡ä¼ä¸šæä¾›ä¸“ä¸šçš„åä½œå¹³å°ï¼›æ­¤å¤–ï¼Œæµ·è¯šÂ·å·¥ç¨‹å¹³å°æ—¢æ”¯æŒä¼ ç»Ÿ EPCï¼ˆè®¾è®¡ã€é‡‡è´­ã€æ–½å·¥å®‰è£…ï¼‰ï¼Œä¹Ÿæä¾›æ™ºèƒ½å·¥å‚ EPC æœåŠ¡ï¼Œå¹¶é›†æˆè‡ªåŠ¨åŒ–ä¿¡æ¯ç³»ç»Ÿã€æ™ºèƒ½è£…å¤‡ã€æœºå™¨äººã€AI ç­‰ã€‚ç¬¬ä¸‰å±‚ä¸ºæ™ºèƒ½åˆ¶é€ ï¼Œæ¶µç›–æµ·è¯š Â· æ•°å­—åŒ–äº¤ä»˜å¹³å°ï¼Œä¸ºå·¥ç¨‹å»ºè®¾é¡¹ç›®æä¾›ç³»ç»ŸåŒ–äº¤ä»˜äº§å“ï¼›æµ·è¯š Â· æ•°æ®å·¥åœºå¹³å°ï¼Œé›†æˆæ•°æ®æ²»ç†ã€çŸ¥è¯†å›¾è°±ã€æ•°æ®åˆ†æç­‰æ¨¡å—ï¼Œæ”¯æŒä¸šåŠ¡å¿«é€Ÿå¼€å‘ï¼›æµ·è¯š Â· æ™ºé€ åº”ç”¨å¹³å°ï¼Œæä¾›æ™ºæ…§äº§çº¿ã€èƒ½ç¢³ç®¡ç†ã€å·¥è‰ºä¼˜åŒ–ç­‰æ™ºèƒ½åº”ç”¨å’Œ AI Agentã€‚</p>
<p>ä¸­å›½æµ·è¯šç§¯ææ¢ç´¢ AI çš„è½åœ°å®è·µï¼Œåœ¨ AI+å·¥ç¨‹æ–¹é¢ï¼Œå…¬å¸è‡ªç ”â€œæ˜¥ç§‹ Â· æå›â€å·¥ç¨‹çŸ¥è¯†é—®ç­”ç³»ç»Ÿï¼Œå¸®åŠ©å·¥ç¨‹å¸ˆè§„èŒƒè®¾è®¡ä¸ä½¿ç”¨ç›¸å…³æŠ€æœ¯æ–‡ä»¶ï¼›åœ¨ AI+åˆ¶é€ æ–¹é¢ï¼Œç»“åˆç”Ÿäº§è¿ç»´æ•°æ®ï¼Œä½¿ç”¨ AI ä¼˜åŒ–è¿è¥æ•ˆç‡ï¼›åœ¨ AI+è£…å¤‡æ–¹é¢ï¼ŒåŸºäºè§†è§‰è¯†åˆ«ã€æœºå™¨äººç­‰æŠ€æœ¯æå‡ç”Ÿäº§åˆ¶é€ æ°´å¹³ã€‚æœªæ¥ï¼Œå…¬å¸å°†æºæ‰‹åˆä½œä¼™ä¼´ï¼ŒåˆåŠ›å…±å»ºæ™ºèƒ½å·¥å‚ç³»ç»Ÿè§£å†³æ–¹æ¡ˆç”Ÿæ€ï¼ŒåŠ©åŠ›åˆ¶é€ ä¸šå‘å±•ã€‚</p>
<h2 data-id="heading-4"><strong>æµæ•°èåˆçš„AIé£è½®å®è·µ</strong></h2>
<p><strong>ç«‹é‚¦ä¸­å›½æµç¨‹ IT æ€»éƒ¨é«˜çº§å‰¯æ€»è£ã€è…¾è®¯äº‘TVP è°¢å¯³è²¡</strong>åˆ†äº«ã€Šæµæ•°èåˆçš„ AI é£è½®å®è·µã€‹çš„æ¼”è®²ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/387b0f350f54473a9e20a8c409f04ee8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766741406&amp;x-signature=dZfgpD55qtF8W3jYlp8Mg8vsgy4%3D" alt="" loading="lazy"/></p>
<p>ç«‹é‚¦ä¸­å›½æµç¨‹ IT æ€»éƒ¨é«˜çº§å‰¯æ€»è£ã€è…¾è®¯äº‘TVP è°¢å¯³è²¡</p>
<p>ç«‹é‚¦ä¸­å›½ä»¥ç”¨æˆ·ä»·å€¼ä¸ºä¸­å¿ƒï¼Œé€šè¿‡ç”¨æˆ·ã€æµç¨‹ã€ç³»ç»Ÿã€æ•°æ®ã€ç‰©è”ç½‘å’Œ AI ååŒï¼Œæ„å»ºæ¶‚è£…æ•°å­—ç»æµé›†æˆè§£å†³æ–¹æ¡ˆã€‚è‡ª 2017 å¹´èµ·ï¼Œå…¬å¸ç³»ç»Ÿæ¨è¿›æ•°å­—åŒ–è½¬å‹ï¼šç¬¬ä¸€é˜¶æ®µï¼Œå¼ºåŒ–ä¸šåŠ¡ååŒåŠæ•°æ™ºåŒ–åŸºç¡€æŠ€æœ¯ï¼Œä»â€œ+ITâ€èµ°å‘â€œIT+â€, è®¾ç«‹ IT BP æœºåˆ¶ï¼Œæ¨åŠ¨ IT äººå‘˜æ·±å…¥ç†è§£ä¸šåŠ¡ï¼›ç¬¬äºŒé˜¶æ®µï¼ŒåŠ é€Ÿæ•°æ™ºåŒ–è½¬å‹ï¼Œæ‰“é€ å†…éƒ¨æ•°å­—åŒ–å“ç‰Œâ€œiSMARTâ€ï¼Œæ¨è¿›ä¸­å°åŒ–ã€ç§»åŠ¨åŒ–ã€ä½“ç³»åŒ–å»ºè®¾ï¼›ç¬¬ä¸‰é˜¶æ®µï¼Œæ•´åˆæµç¨‹ã€åº”ç”¨ã€æ•°æ®å½¢æˆä»·å€¼é“¾ï¼ŒåŠ é€Ÿæµæ•°èåˆï¼Œæ”¶è·æ•°æ™ºåŒ–ä»·å€¼ï¼›ç¬¬å››é˜¶æ®µï¼Œè¿›è¡Œæµæ•°èåˆåŠ AI é£è½®é©±åŠ¨å˜é©ï¼Œæ„å»ºæµç¨‹ã€ç³»ç»Ÿã€æ•°æ®ã€AI çš„é›†æˆè§£å†³æ–¹æ¡ˆï¼Œå®ç°å˜é©ä»·å€¼åŒ–ã€ç²¾å®ååŒåŒ–ã€ç«äº‰å·®å¼‚åŒ–ã€‚</p>
<p>æµæ•°èåˆä»·å€¼ä½“ç³»çš„æ ¸å¿ƒåœ¨äºæ‹‰é€šè¿ä½œæœºåˆ¶ã€ä¿¡æ¯ç³»ç»Ÿå’Œå¯¹æ•°æ®è¿›è¡Œæ‹‰é€šï¼Œå®ç°æ¶‚è£…ç”Ÿæ€çš„å…¨åœºæ™¯æµæ•°èåˆã€‚å…¶èƒŒåæŠ€æœ¯åŸºç¡€æ”¯æ’‘åŒ…æ‹¬ä¸»æ•°æ®ç®¡ç†åŠæµç¨‹ä¼˜åŒ–ï¼Œæ•°æ®æœåŠ¡é—¨æˆ·ä¹Ÿè‡³å…³é‡è¦ï¼Œéœ€å»ºç«‹ç»Ÿä¸€æ•°æ®å­—å…¸å¹¶æ­å»ºæ•°ä»“ï¼Œå¼•å…¥æµç¨‹æŒ–æ˜å¹³å°ã€‚</p>
<p>éšç€ AI æ—¶ä»£çš„æ¥ä¸´ï¼Œå…¬å¸åˆ¶å®š AI æ„¿æ™¯ï¼Œè®©æ¯ä¸ªç«‹é‚¦å‘˜å·¥å’Œç”Ÿæ€ä¼™ä¼´éƒ½æœ‰åŠ©æ‰‹ï¼Œå¹¶ä»¥ç®—æ³•å’Œ RPA èµ‹èƒ½ã€‚åœ¨æ­¤æ„¿æ™¯ä¸‹ï¼Œå…¬å¸æ„å»ºç«‹é‚¦ AI é£è½®ï¼Œå³é€šè¿‡çŸ¥è¯†é©±åŠ¨ä¸šåŠ¡å¢é•¿ï¼Œå¹¶åˆ©ç”¨ AI æŠ€æœ¯åŠ é€Ÿåé¦ˆå¾ªç¯çš„è¿è¥æ¨¡å¼ã€‚å…¶æ ¸å¿ƒé€»è¾‘æ˜¯çŸ¥è¯†ç§¯ç´¯ä¸€æ™ºèƒ½ä½“è®¾è®¡ä¸€ä»·å€¼åœºæ™¯ä¸€æ›´å¤šçŸ¥è¯†ç”Ÿæˆï¼Œå½¢æˆè‡ªæˆ‘å¼ºåŒ–çš„æ­£å‘å¾ªç¯ã€‚AI é£è½®çš„ä»·å€¼åœ¨è·å®¢/è·é¡¹ç›®ã€é£é™©ç®¡æ§ã€é™æœ¬å¢æ•ˆã€ç ”å‘åˆ›æ–°ç­‰æ–¹é¢ã€‚</p>
<p>ç«‹é‚¦ AI é£è½®æ¶æ„å›´ç»• 17 ç±»çŸ¥è¯†é¢†åŸŸï¼Œå°†çŸ¥è¯†æ¥å…¥æµæ•°èåˆä¸šåŠ¡ç³»ç»Ÿï¼Œå®ç°ä¸šåŠ¡æµç¨‹æ•°æ®å…¥ä»“åŠçŸ¥è¯†å‘é‡åŒ–ï¼›èšåˆé¢†åŸŸçŸ¥è¯†åŠæ•°æ®ï¼Œåˆ©ç”¨ç®—æ³•ä¸­å°æŒ‰å„ä¸šåŠ¡åº”ç”¨åœºæ™¯è¿›è¡Œç®—æ³•æ¨¡å‹è°ƒä¼˜ï¼›ç»“åˆä¸šåŠ¡åœºæ™¯ç‰¹å¾ï¼Œç»Ÿä¸€æä¾›æ™ºèƒ½åŠ©æ‰‹ã€AI åº”ç”¨ã€ç®—æ³•èƒ½åŠ›ã€‚</p>
<p>å¦‚ä»Šï¼Œå…¬å¸ä»¥æµæ•°èåˆå’Œ AI èƒ½åŠ›æ¨¡å‹ä¸ºåŒè½®é©±åŠ¨æ ¸å¿ƒï¼Œé€æ­¥æ¨è¿›æ„¿æ™¯çš„å®ç°ï¼šä»å¯èˆªå…±åˆ›å¼€å§‹ï¼Œè®©ä¸šåŠ¡äººå‘˜äº†è§£ AI å·¥å…·å’Œåº”ç”¨åœºæ™¯ï¼›å†åˆ°ç‹¬ç«‹æ¢ç´¢ï¼Œé¼“åŠ±ä¸šåŠ¡äººå‘˜ç‹¬ç«‹å®ŒæˆåŸºç¡€åŠŸèƒ½çš„å¼€å‘ï¼›å†åˆ°æ·±åº¦å…±åˆ›é˜¶æ®µï¼Œè®©ä¸šåŠ¡äººå‘˜å’Œæµç¨‹ IT äººå‘˜åˆä½œå¼€å‘å¤æ‚åº”ç”¨ï¼›éšåæ¥åˆ°è‡ªä¸»å¼€å‘é˜¶æ®µï¼Œä¸šåŠ¡äººå‘˜èƒ½ç‹¬ç«‹å®Œæˆå¤æ‚åº”ç”¨çš„å¼€å‘ï¼›æœ€ç»ˆå®ç°ä¸šåŠ¡åˆ›æ–°ï¼Œä¸šåŠ¡äººå‘˜èƒ½å¤Ÿé€šè¿‡ AI å·¥å…·æ¥ä¸»åŠ¨å‘ç°å’Œè§£å†³ä¸šåŠ¡æ–°é—®é¢˜ï¼Œå®ç° AI é£è½®æ„¿æ™¯ã€‚</p>
<p>å±•æœ› 2026 å¹´å…¬å¸çš„å‘å±•é‡ç‚¹ï¼ŒAI é£è½®åŸºäºæµæ•°èåˆï¼Œå¢å¼ºä¸šåŠ¡åŠæµç¨‹ IT åŒè½®é©±åŠ¨çš„ AI äººæ‰åŸ¹å…»å’Œé£è½®é‚¦è¿ä½œæœºåˆ¶ï¼Œè®©ä¸šåŠ¡æ–¹è‡ªä¸»æ„å»º AI åŠ©æ‰‹ï¼Œå®ç°ç«¯åˆ°ç«¯ä¸šåŠ¡æµç¨‹æ‹‰é€šçš„ AI æ™ºèƒ½ä½“ã€‚ä» AI åŠ©æ‰‹åˆ° AI åŒäº‹ï¼Œç›®æ ‡åœ¨ 2026 å¹´å®ç°â€œAI å‘˜å·¥â€åœ¨ä¸€äº›æµç¨‹çš„è‡ªä¸»å·¥ä½œï¼Œèµ‹èƒ½ä¸šåŠ¡å‘å±•ã€‚</p>
<h2 data-id="heading-5"><strong>ä»·å€¼è½åœ°ï¼šæ™ºèƒ½ä½“ä¸å¤§æ¨¡å‹çš„ä¼ä¸šçº§å®è·µä¸æ€è€ƒ</strong></h2>
<p><strong>æ”¯ç‚¹äº’åŠ¨æ¶ˆè´¹é›¶å”®è¡Œä¸šæ€»ç»ç†ã€å‰æ¨å›½ç¦ CTOã€è…¾è®¯äº‘TVP é™†ç¦å·</strong>å¸¦æ¥ã€Šä»·å€¼è½åœ°ï¼šæ™ºèƒ½ä½“ä¸å¤§æ¨¡å‹çš„ä¼ä¸šçº§å®è·µä¸æ€è€ƒã€‹çš„ä¸»é¢˜æ¼”è®²ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d540b627a0745dea8d4fbc0e5e99052~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766741406&amp;x-signature=xpaMxBTeZWFsXNjF8kOS0Xq4rA8%3D" alt="" loading="lazy"/></p>
<p>æ”¯ç‚¹äº’åŠ¨æ¶ˆè´¹é›¶å”®è¡Œä¸šæ€»ç»ç†ã€å‰æ¨å›½ç¦ CTOã€è…¾è®¯äº‘TVP é™†ç¦å·</p>
<p>é™†ç¦å·è§‚å¯Ÿåˆ°ï¼Œä¼ä¸šåœ¨è½åœ° AI è¿‡ç¨‹ä¸­å­˜åœ¨ä»¥ä¸‹ç—›ç‚¹ï¼šä¸€æ˜¯ä¼ ç»Ÿæ•°å­—åŒ–èšç„¦è§£å†³å•ä¸€æˆ–å…·ä½“çš„ä¸šåŠ¡é—®é¢˜ï¼Œéš¾ä»¥å®ç°å¸‚åœºåé¦ˆå…¨é“¾è·¯ååŒä¸ç»†èŠ‚ç®¡ç†çš„çµæ´»è¡”æ¥ã€‚ä¾‹å¦‚ï¼Œå½“å®¢æˆ·åœ¨çº¿ä¸ŠæŠ•è¯‰æ—¶ï¼Œå¾€å¾€éœ€è·¨å¤šä¸ªä¸šåŠ¡åŸŸæ¥åˆ†æåŸå› ã€‚äºŒæ˜¯ä¸šè´¢æ•°æ®ååŒä¸è¶³ï¼Œå¯¼è‡´é’±æ•ˆæ„ŸçŸ¥æ»åã€‚å¦‚åœ¨è¥é”€æ´»åŠ¨ä¸­ï¼Œä¼ä¸šå¸Œæœ›åŸºäºç›¸å…³æ•°æ®æ¥è°ƒæ•´ç­–ç•¥ï¼Œä½†æ•°æ®åˆ†æ•£åœ¨ CDPã€ERP ç­‰å¤šä¸ªç³»ç»Ÿä¸­æ— æ³•å®ç°åŒé¢‘åé¦ˆã€‚ä¸‰æ˜¯å…¨ä»·å€¼é“¾ååŒä¸è¶³ï¼ŒC2Bã€B2Bã€B2S æ²¡æœ‰è´¯é€šã€‚</p>
<p>é™†ç¦å·è¡¨ç¤ºï¼Œå¤šæ•°ä¼ä¸šçš„æ•°å­—åŒ–è½¬å‹è§£å†³äº†â€œæœ‰æ— â€é—®é¢˜ï¼Œå´æ·±é™·äºâ€œå¥½ç”¨â€ä¸â€œä»·å€¼â€çš„æ³¥æ½­ã€‚æ•°æ®ã€æµç¨‹ä¸å†³ç­–çš„ä¸¥é‡å‰²è£‚ï¼Œå·²æˆä¸ºé˜»ç¢ä¼ä¸šè¿ˆå‘æœªæ¥å‘å±•çš„æ ¸å¿ƒæ·é”ã€‚çœŸæ­£çš„æ•°å­—åŒ–è½¬å‹ä¸æ˜¯ç®€å•åœ°è´­ä¹°è½¯ä»¶æˆ–ä¸Šäº‘ï¼Œè€Œæ˜¯è¦æ‰“é€šä¼ä¸šçš„â€œç¥ç»ç³»ç»Ÿâ€ï¼Œè®©æ•°æ®ã€æµç¨‹å’Œå†³ç­–å½¢æˆæœ‰æœºæ•´ä½“ã€‚</p>
<p>ä¼ä¸šçº§ AI Agent å°†æ‰®æ¼”ç»„ç»‡çš„â€œæ•°å­—ä¸­æ¢ç¥ç»ç³»ç»Ÿâ€ï¼Œè¿æ¥æ‰€æœ‰æ•°æ®ã€æµç¨‹ä¸äººå‘˜ï¼Œå°†ä¼ä¸šä»æœºæ¢°é›†åˆä½“å‡çº§ä¸ºèƒ½è‡ªæˆ‘è¿›åŒ–ã€æ•æ·å“åº”çš„â€œæ•°å­—ç”Ÿå‘½ä½“â€ã€‚æ™ºèƒ½ä½“åœ¨ä¼ä¸šå¯é è½åœ°çš„æœ¬è´¨ï¼Œæ˜¯â€œç”¨æ ‡å‡†åŒ–æµç¨‹é©¯æœå¤§æ¨¡å‹â€ï¼Œè€Œé¢†åŸŸçŸ¥è¯†çš„è´¨é‡ä¸å¯†åº¦ã€å¯é å·¥ç¨‹åŒ–ã€äººæœºååŒæ¶æ„ï¼Œæ˜¯ä¸‰å¤§ä¸å¯å¿½è§†çš„â€œåœ°åŸºå·¥ç¨‹â€ã€‚AI Agent çš„è½åœ°å¯åˆ†ä¸‰æ­¥èµ°ï¼šé¦–å…ˆï¼Œæ„å»ºç»Ÿä¸€çš„ä¼ä¸šçŸ¥è¯†åº“ä¸è®¤çŸ¥ä½“ç³»ï¼›å…¶æ¬¡ï¼Œæ¨åŠ¨ä»â€œäººæ‰¾æµç¨‹â€å‘â€œæµç¨‹æ‰¾äººâ€è½¬å˜ï¼›æœ€åï¼Œå®ç°ç»éªŒä¾èµ–åˆ°äººæœºååŒï¼Œé€šè¿‡æŒç»­åé¦ˆæœºåˆ¶ï¼Œä½¿æ™ºèƒ½ä½“éšä¼ä¸šå‘å±•è€Œä¸æ–­æ¼”è¿›ã€‚â€œä»–å¼ºè°ƒï¼Œä¼ä¸šä¸åº”ä»…å°† AI è§†ä¸ºå·¥å…·ï¼Œè€Œåº”å½“ä½œâ€œæ•°å­—å‘˜å·¥â€æˆ–â€œæ•°å­—ä¼™ä¼´â€ï¼Œç”¨ AI é‡å¡‘ä¼ä¸šç”Ÿäº§æ¨¡å¼ã€‚</p>
<p>ä»–æŒ‡å‡ºä¼ä¸šåœ¨ AI åº”ç”¨ä¸­çš„å¸¸è§è¯¯è§£ï¼šä¸€æ˜¯å°†å¤§æ¨¡å‹çš„é€šç”¨èƒ½åŠ›ç­‰åŒäºé¢†åŸŸä¸“é•¿ï¼Œå¿½è§†åµŒäºä¸šåŠ¡æµç¨‹çš„é¢†åŸŸçŸ¥è¯†éœ€ä¾èµ–ç²¾å¯†çš„çŸ¥è¯†å·¥ç¨‹ã€‚äºŒæ˜¯å°†æ¦‚ç‡æ€§è¾“å‡ºç­‰åŒäºç¡®å®šæ€§ç­”æ¡ˆï¼Œåº”ä¸ºé«˜ä»·å€¼å†³ç­–ä¿ç•™äººå·¥å®¡æ ¸ï¼Œä¸ºä½é£é™©åœºæ™¯æˆæƒè‡ªåŠ¨æ‰§è¡Œã€‚ä¸‰æ˜¯å°†æŠ€æœ¯è¿›æ­¥ç­‰åŒäºå•†ä¸šä»·å€¼ï¼Œä½†äºŒè€…ä¹‹é—´å­˜åœ¨è¾¹é™…æ•ˆç›Šé€’å‡çš„å…³ç³»ã€‚</p>
<p>ä»–ä»å®è·µä¸­æ€»ç»“äº† AI æ™ºèƒ½ä½“äº¤ä»˜å¿ƒå¾—ï¼šç”¨â€œç®¡ç†é—­ç¯â€å¯¹å†²â€œæŠ€æœ¯æ³¢åŠ¨â€ï¼›ç”¨â€œç¡®å®šæ€§â€çº¦æŸâ€œæ¦‚ç‡æ€§â€ï¼Œé€šè¿‡è§„èŒƒå·¥ä½œæµã€ä½œä¸šæµï¼Œå°†æ¨¡ç³Šæ¦‚ç‡è¾“å‡ºæ¡†å®šåœ¨æ ‡å‡†åŒ–æµç¨‹ï¼›è®©æ™ºèƒ½ä½“ä»â€œä¸“å®¶â€å˜â€œç†Ÿæ‰‹â€ï¼Œéœ€ä¼ä¸šä¸“å±æŠ€èƒ½åŸ¹è®­ï¼›æ¥å—å¤§æ¨¡å‹â€œä¸å®Œç¾â€çš„æœ¬è´¨ï¼Œè¶…å‡ºè¾¹ç•Œä¼šäº§ç”Ÿâ€œå¹»è§‰â€ï¼›ä¸ä¼ ç»Ÿä¿¡æ¯åŒ–çš„â€œè§„åˆ™å›ºåŒ–â€å­˜åœ¨ï¼Œæ›´å¼ºè°ƒâ€œçµæ´»é€‚é…â€ã€‚</p>
<p>é™†ç¦å·è¿˜åˆ†äº«äº†æ™ºèƒ½ä½“ AI è½åœ°æ¡ˆä¾‹ï¼ŒåŒ…æ‹¬æ™ºèƒ½ç‚¹å•åŠ©æ‰‹ã€VoC æ•°æ®æ™ºèƒ½åˆ†æåŠ©æ‰‹ã€é”€å”®å¸‚åœºåˆ†æåŠ©æ‰‹ã€ä¼ä¸šè´¨é‡åŠ©æ‰‹ã€ç ”å‘æ–‡æ¡£æŠ€æœ¯æ´å¯ŸåŠ©æ‰‹ã€ä¼ä¸šç”Ÿäº§æ•ˆç‡æ™ºèƒ½ä½“ã€å®¢æˆ·æœåŠ¡åŠ©æ‰‹ç­‰ã€‚</p>
<h2 data-id="heading-6"><strong>CMMMç ´è§£æ™ºèƒ½å·¥å‚å»ºè®¾éš¾é¢˜</strong></h2>
<p>ä¸­å›½ç”µå­æŠ€æœ¯æ ‡å‡†åŒ–ç ”ç©¶é™¢ä¸¤åŒ–èåˆç ”ç©¶å®¤ä¸»ä»» å¼ å·å‘è¡¨ã€ŠCMMM ç ´è§£æ™ºèƒ½å·¥å‚å»ºè®¾éš¾é¢˜ã€‹çš„ä¸»é¢˜æ¼”è®²ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94d488c2e2bc4728937f64a5cafbc4af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766741406&amp;x-signature=hyBgvYZ%2BGvuUHt25ZWixVLLWwPE%3D" alt="" loading="lazy"/></p>
<p>ä¸­å›½ç”µå­æŠ€æœ¯æ ‡å‡†åŒ–ç ”ç©¶é™¢ä¸¤åŒ–èåˆç ”ç©¶å®¤ä¸»ä»» å¼ å·</p>
<p>æ™ºèƒ½åˆ¶é€ ä½œä¸ºâ€œä¸­å›½åˆ¶é€  2025â€æˆ˜ç•¥çš„æ ¸å¿ƒæ–¹å‘ï¼Œåå¹´æ¥å·²ä»è¯•ç‚¹ç¤ºèŒƒèµ°å‘æ™®åŠã€‚æ™ºèƒ½å·¥å‚ä½œä¸ºæ™ºèƒ½åˆ¶é€ çš„é‡è¦è½½ä½“ï¼Œä¹Ÿæ˜¯å…ˆè¿›åˆ¶é€ æŠ€æœ¯ã€å…ˆè¿›ç®¡ç†ç†å¿µåŠ AIã€æ•°å­—å­ªç”Ÿç­‰æ–°å…´æŠ€æœ¯åº”ç”¨çš„ä¸»æˆ˜åœºã€‚ç›®å‰ï¼Œä¼ä¸šåœ¨æ¨è¿›æ–°ä¸€ä»£æ™ºèƒ½å·¥å‚å»ºè®¾è¿‡ç¨‹ä¸­é¢ä¸´â€œä¸ä¼šå»ºã€ä¸æ•¢å»ºã€ä¸èƒ½å»ºâ€çš„å›°å¢ƒï¼Œæ ¹æºä¹‹ä¸€åœ¨äºæ ‡å‡†ä½“ç³»ç¼ºå¤±ï¼Œåªæœ‰åŸºäºæ ‡å‡†æ‰èƒ½ç§‘å­¦åˆç†åœ°æ¨è¿›æ™ºèƒ½åŒ–è½¬å‹å‡çº§ã€‚</p>
<p>æ ‡å‡†åŒ–éµå¾ªâ€œç»Ÿä¸€ã€ç®€åŒ–ã€ä¼˜é€‰ã€åè°ƒâ€ä¸ºåŸåˆ™ï¼šâ€œç»Ÿä¸€â€æ˜¯é€šè¿‡åˆ¶å®šæœ¯è¯­ã€å‚è€ƒæ¶æ„ç­‰æ ‡å‡†ï¼Œæ”¯æ’‘äº§ä¸šç•Œå½¢æˆç»Ÿä¸€çš„è®¤è¯†å’Œæ–¹æ³•è®ºï¼›â€œç®€åŒ–â€æ˜¯é€šè¿‡æˆç†Ÿåº¦æ¨¡å‹ç­‰æ ‡å‡†çªå‡ºé‡ç‚¹ã€åˆ ç¹å°±ç®€ï¼Œæä¾›ç®€æ´æœ‰æ•ˆçš„è½¬å‹æµç¨‹ï¼›â€œä¼˜é€‰â€æ˜¯å‘å¸ƒç›¸å…³æŒ‡å—ã€é€‰å‹è¦æ±‚ç­‰æ ‡å‡†ï¼Œæ”¯æ’‘ä¼ä¸šçš„æœ€ä½³å®è·µï¼›â€œåè°ƒâ€æ˜¯æ„å»ºå…¨é¢æ ‡å‡†ä½“ç³»ï¼ŒåŠ å¼ºå„æ ‡å‡†ä¹‹é—´çš„ååŒã€‚</p>
<p>2020 å¹´ï¼Œé¦–æ‰¹å›½å®¶æ™ºèƒ½åˆ¶é€ æ ‡å‡†æ­£å¼å‘å¸ƒï¼ŒåŒ…æ‹¬ã€Šæ™ºèƒ½åˆ¶é€ èƒ½åŠ›æˆç†Ÿåº¦æ¨¡å‹ã€‹ï¼ˆChina Manufacturing Maturity Model, CMMMï¼Œæ ‡å‡†å·GB/T 39116-2020ï¼‰å’Œã€Šæ™ºèƒ½åˆ¶é€ èƒ½åŠ›æˆç†Ÿåº¦è¯„ä¼°æ–¹æ³•ã€‹ï¼ˆMaturity Assessment Method of Intelligent Manufacturing Capabilityï¼Œæ ‡å‡†å·GB/T 39117-2020ï¼‰ã€‚è¿™ä¸¤é¡¹æ ‡å‡†æ—¨åœ¨è§£å†³åˆ¶é€ ä¼ä¸šæ™ºèƒ½åŒ–æ”¹é€ å’Œå»ºè®¾çš„é—®é¢˜ï¼ŒæŒ‡å¯¼ä¼ä¸šåˆ†æ­¥å»ºç«‹æ ¸å¿ƒèƒ½åŠ›ã€‚é€šè¿‡ä»¥ä¸Šæ ‡å‡†ï¼Œé¦–æ¬¡å°†â€œèƒ½åŠ›æˆç†Ÿåº¦â€å¼•å…¥åˆ¶é€ ä¸šï¼Œæ˜ç¡®æ™ºèƒ½åˆ¶é€ äº”ä¸ªé˜¶æ¢¯å¼æå‡è·¯å¾„ï¼šä¸€çº§ä¸ºæµç¨‹åŒ–ç®¡ç†ï¼ŒäºŒçº§ä¸ºæ•°å­—åŒ–æ”¹é€ ï¼Œä¸‰çº§ä¸ºç½‘ç»œåŒ–é›†æˆï¼Œå››çº§ä¸ºæ™ºèƒ½åŒ–ç”Ÿäº§ï¼Œäº”çº§ä¸ºäº§ä¸šé“¾åˆ›æ–°ã€‚è¯¥æ ‡å‡†ç»†åŒ–äº† 228 é¡¹å…·ä½“èƒ½åŠ›è¦æ±‚ï¼Œä¸ºä¼ä¸šæ™ºèƒ½åˆ¶é€ å»ºè®¾æä¾›äº†æ¸…æ™°çš„è·¯å¾„å›¾ã€‚</p>
<p>è‡ªè¿™ä¸¤é¡¹æ ‡å‡†å‘å¸ƒä»¥æ¥ï¼Œæˆªè‡³ç›®å‰ï¼Œå…¨å›½æœ‰ 15 ä¸‡å®¶ä¼ä¸šå‚è€ƒæ ‡å‡†é€šè¿‡çº¿ä¸Šå¹³å°è¿›è¡Œè‡ªè¯„ï¼Œ1500 å®¶ä¼ä¸šè¿›è¡Œç°åœºè¯„ä¼°ã€‚CMMM æ ‡å‡†æ”¯æ’‘å…«ä¸ªé‡ç‚¹è¡Œä¸šçš„æ•°å­—åŒ–è½¬å‹å®æ–½ï¼Œå¼•å¯¼å›½å†…å¤–åˆ¶é€ ä¼ä¸šè¿ç”¨æ ‡å‡†æ¥è§£å†³æ™ºèƒ½å·¥å‚å»ºè®¾éš¾é¢˜ï¼ŒåŠ é€Ÿä¼ä¸šè½¬å‹æ­¥ä¼ã€‚ç›®å‰ï¼Œæ™ºèƒ½åˆ¶é€ èƒ½åŠ›æˆç†Ÿåº¦æ¨¡å‹æ ‡å‡†ä¸ºä¸»ç®¡éƒ¨é—¨å¼€å±•æ™ºèƒ½å·¥å‚åˆ†çº§è¯„ä»·ä¸ä¼˜ä¸­é€‰ä¼˜æä¾›äº†ç»Ÿä¸€çš„è¡¡é‡æ ‡å°ºï¼Œä¸ºåˆ¶é€ ä¼ä¸šæä¾›æ–¹æ³•è®ºå’Œè·¯å¾„æŒ‡å¼•ï¼ŒæŒ‡å¯¼ä¼ä¸šæœ‰åºå¼€å±•æ™ºèƒ½å·¥å‚å»ºè®¾ã€‚</p>
<h2 data-id="heading-7"><strong>AIæŠ€æœ¯èµ‹èƒ½MOMè¿è¥ç²¾å‡†ç®¡æ§</strong></h2>
<p><strong>ä¸­å›½æµ·è¯šæ™ºèƒ½åˆ¶é€ äº‹ä¸šéƒ¨æ€»å·¥ç¨‹å¸ˆ æœ±å‰‘é’</strong>åˆ†äº«ã€ŠAI æŠ€æœ¯èµ‹èƒ½ MOM è¿è¥ç²¾å‡†ç®¡æ§ã€‹çš„æ¼”è®²ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f691523d00a244e287eb5792cbea9786~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766741406&amp;x-signature=RAkWFKnO0ecNFxLqA8zW7RAoI8U%3D" alt="" loading="lazy"/></p>
<p>ä¸­å›½æµ·è¯šæ™ºèƒ½åˆ¶é€ äº‹ä¸šéƒ¨æ€»å·¥ç¨‹å¸ˆ æœ±å‰‘é’</p>
<p>åœ¨æ”¿ç­–æ¨åŠ¨ã€å¸‚åœºç«äº‰ã€ä¼ä¸šå†…ç”Ÿéœ€æ±‚ã€æŠ€æœ¯å‘å±•ç­‰å¤šé‡å› ç´ é©±åŠ¨ä¸‹ï¼Œäººå·¥æ™ºèƒ½æ­£æˆä¸ºåˆ¶é€ ä¸šè½¬å‹å‡çº§çš„æ ¸å¿ƒåŠ¨åŠ›ã€‚AI ä¸ºå·¥ä¸šæ™ºé€ å¸¦æ¥è¯¸å¤šåŠ©åŠ›ï¼šä¼˜ç§€ç®—æ³•é™ä½ç®—åŠ›éœ€æ±‚ï¼Œæœªæ¥æ™ºèƒ½å·¥å‚å¯é€šè¿‡ç«¯ä¾§åˆ†å¸ƒå¼æ¶æ„å’Œå°æ¨¡å‹éƒ¨ç½²æ¥å®ç° AI è½åœ°ï¼›æå‡æ„ŸçŸ¥èƒ½åŠ›ï¼Œå€ŸåŠ©ç”Ÿæˆå¼ AI æŠ€æœ¯æ¥è§£å†³ç¨€ç–æ ·æœ¬ä¸‹æ•°æ®åˆæˆï¼Œæœ‰åˆ©äºè¡¥å…¨æ•°æ®ç»´åº¦ï¼Œå®ç°æ„ŸçŸ¥ç¡¬ä»¶è¯†åˆ«å†³ç­–èƒ½åŠ›çš„æå‡ï¼›æ™ºé€ æ–°èŒƒå¼ï¼Œä¼ ç»Ÿè½¯ä»¶å¼äº¤äº’å°†è½¬å˜ä¸ºä»¥ Agent ä¸ºä»£è¡¨çš„è¾…åŠ©å†³ç­–æ”¯æŒå¼äº¤äº’ã€‚</p>
<p>AI ä½¿å¾—æ™ºèƒ½å·¥å‚ä»æŠ€æœ¯åº•å±‚åˆ°äº¤äº’é€»è¾‘å…¨é¢å‡çº§ï¼Œæœªæ¥çš„å·¥å‚æ˜¯æ•°å­—å­ªç”Ÿå·¥å‚ï¼ŒåŸºäº AI åŸç”Ÿçš„æ•°æ®ç®—æ³•ä¸­å°å’Œæ•°æ®åº•åº§ï¼Œæ¥å®ç°å„ç§å·¥ä¸šæ™ºèƒ½ä½“å’Œå·¥ä¸šåº”ç”¨åœºæ™¯çš„è½åœ°ã€‚</p>
<p>è¿‡å»ï¼Œä¼ ç»Ÿ MESï¼ˆåˆ¶é€ æ‰§è¡Œç³»ç»Ÿï¼‰ä¸»è¦å›´ç»•ç”Ÿäº§æ‰§è¡Œç¯èŠ‚ï¼Œç”¨äºè½¦é—´å±‚çš„äººã€æœºã€æ–™ã€æ³•ã€ç¯çš„ç®¡ç†ï¼Œä½†å­˜åœ¨ä¿¡æ¯å­¤å²›ã€åŠŸèƒ½èŒƒå›´ç‹­çª„ã€ç³»ç»ŸåƒµåŒ–æŸ”æ€§å·®ã€æ•°æ®ä»·å€¼æŒ–æ˜ä¸è¶³ç­‰å±€é™ï¼Œéš¾ä»¥æ”¯æ’‘ç°ä»£è½»å·¥ã€æ¶ˆè´¹å“ç­‰è¡Œä¸šå¿«é€Ÿå“åº”å¸‚åœºå˜åŒ–ã€‚</p>
<p>ä¸ºæ­¤ï¼Œæ–°ä¸€ä»£ MOMï¼ˆåˆ¶é€ è¿è¥ç®¡ç†ï¼‰æ„å»ºç»Ÿä¸€çš„åˆ¶é€ è¿è¥å¹³å°ï¼Œä»åŸæ¥ MES çš„â€œè½¦é—´æ ¸å¿ƒâ€åˆ°â€œè¿è¥å…¨åŸŸâ€ï¼Œä»çƒŸå›±ç³»ç»Ÿåˆ°ç»Ÿä¸€å¹³å°ï¼Œä»æµç¨‹é©±åŠ¨åˆ°æ•°æ®é©±åŠ¨ã€‚æ­¤å¤–ï¼ŒMOM å—åˆ° ISA95 ç­‰å›½é™…æ ‡å‡†çš„æ˜ç¡®å®šä¹‰ï¼Œæä¾›é€šç”¨çš„æ¨¡å‹å’Œæœ¯è¯­ã€‚</p>
<p>äººå·¥æ™ºèƒ½æ—¶ä»£ï¼ŒAI ä¸ MOM çš„æ·±åº¦èåˆï¼Œä»åº•å±‚æ¶æ„ã€äº¤äº’æ–¹å¼åˆ°å†³ç­–æ¨¡å¼çš„å…¨æ–¹ä½é©æ–°ï¼Œå˜æˆâ€œæ™ºèƒ½è¿è¥å¤§è„‘â€ã€‚åœ¨æ ¸å¿ƒèƒ½åŠ›ä¸Šï¼Œä»åŸæ¥çš„è®°å½•ã€æ‰§è¡Œå‘å±•ä¸ºæ‹¥æœ‰æ„ŸçŸ¥ã€é¢„æµ‹ã€ä¼˜åŒ–ã€è‡ªä¸»å†³ç­–çš„èƒ½åŠ›ï¼›åœ¨äº¤äº’æ–¹å¼ä¸Šï¼Œé‡‡ç”¨è‡ªç„¶è¯­è¨€å¯¹è¯ï¼Œé€šè¿‡æ™ºèƒ½å‰¯é©¾é©¶è¾…åŠ©å‘˜å·¥è¿›è¡Œè¿è¥ç®¡æ§ï¼›åœ¨å†³ç­–ä¾æ®ä¸Šï¼Œé‡‡ç”¨æ•°æ®é©±åŠ¨æ´å¯Ÿï¼Œé€šè¿‡ AI æ¨¡å‹åšç›¸å…³å·¥è‰ºå‚æ•°æ¨èï¼›åœ¨çŸ¥è¯†ç®¡ç†ä¸Šï¼Œæ„å»ºåŠ¨æ€çŸ¥è¯†å›¾è°±ï¼Œæ­å»ºé›†ä¸­ã€å¯é—®ç­”çš„â€œæ´»â€çŸ¥è¯†åº“ï¼›åœ¨ç³»ç»Ÿæ•æ·ä¸Šï¼Œä»¥ä½ä»£ç ã€AI ç”Ÿæˆç­‰æ–¹å¼ï¼Œæ•æ·å“åº”ä¸šåŠ¡å˜åŒ–ã€‚ç›®å‰ï¼Œ AI+MOM çš„åº”ç”¨åœºæ™¯åŒ…æ‹¬æ™ºèƒ½è´¨é‡ç®¡æ§ã€åŠ¨æ€ç”Ÿäº§è°ƒåº¦ã€èƒ½æºç®¡ç†ä¼˜åŒ–ã€ç‰©æµä»“å‚¨ä¼˜åŒ–ç­‰ã€‚</p>
<p>ä¼ä¸šåœ¨è¦æƒ³å°† AI çœŸæ­£åœ°èå…¥ MOM ç³»ç»Ÿï¼Œæœ±å‰‘é’å»ºè®®é‡‡ç”¨å¾ªåºæ¸è¿›çš„æ–¹å¼ï¼šé¦–å…ˆå¤¯å®æ•°æ®åº•åº§ï¼Œå®ç°ç”Ÿäº§ã€è®¾å¤‡ã€è´¨é‡ç­‰å…¨åŸŸæ•°æ®çš„é‡‡é›†ä¸è´¯é€šï¼›å…¶æ¬¡èšç„¦é«˜ä»·å€¼åœºæ™¯è¯•ç‚¹ï¼Œé¿å…â€œå¤§è€Œå…¨â€çš„å¼€å§‹ã€‚å†é€æ­¥å°† AI èƒ½åŠ›ä»¥æ¨¡å—åŒ–ã€å¾®æœåŠ¡çš„æ–¹å¼é€æ­¥åµŒå…¥ MOM çš„æ ¸å¿ƒä¸šåŠ¡æµç¨‹ï¼Œå¹¶æ¨åŠ¨å…¶ä¸ ERPã€PLM ç­‰ç³»ç»Ÿçš„æ·±åº¦é›†æˆã€‚æœ€åï¼Œå…³æ³¨ç»„ç»‡ä¸å‘˜å·¥æŠ€èƒ½æå‡ï¼Œè®©å‘˜å·¥ç†è§£å¹¶ä¿¡ä»» AI çš„å»ºè®®ä¸å†³ç­–ã€‚</p>
<h2 data-id="heading-8"><strong>è…¾è®¯äº‘å¤§æ•°æ®DIaaSå¹³å°ï¼šé©±åŠ¨è¡Œä¸šæ™ºèƒ½åŒ–è½¬å‹çš„Data+AIæ–°å¼•æ“</strong></h2>
<p><strong>è…¾è®¯äº‘å¤§æ•°æ®åŸºç¡€äº§å“æ€»ç»ç† ç¨‹å½¬</strong>å¸¦æ¥ã€Šè…¾è®¯äº‘å¤§æ•°æ® DIaaS å¹³å°ï¼šé©±åŠ¨è¡Œä¸šæ™ºèƒ½åŒ–è½¬å‹çš„Data + AI æ–°å¼•æ“ã€‹çš„æ¼”è®²ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9ba348237b1240a3ad5d7b6172b84f9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IW-6K6v5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766741406&amp;x-signature=u0EWj8py3SSzNbrwPWp9lUBsN%2B4%3D" alt="" loading="lazy"/></p>
<p>è…¾è®¯äº‘å¤§æ•°æ®åŸºç¡€äº§å“æ€»ç»ç† ç¨‹å½¬</p>
<p>åœ¨æ¢è®¨ AI è½åœ°çš„è¿‡ç¨‹ä¸­ï¼Œå¤§æ¨¡å‹çš„èƒ½åŠ›å›ºç„¶é‡è¦ï¼Œä½†å…¶èƒŒåç¦»ä¸å¼€é«˜è´¨é‡æ•°æ®çš„æ”¯æŒï¼Œæ•°æ®æ˜¯å¤§æ¨¡å‹çš„â€œç‡ƒæ–™â€ã€‚ç¨‹å½¬è¡¨ç¤ºï¼Œä¼ä¸šæ‹¥æœ‰å¤§é‡ä¸šåŠ¡æ•°æ®ï¼Œå¦‚ä½•å‘æŒ¥è¿™äº›æ•°æ®çš„ä»·å€¼æ˜¯å…³é”®ã€‚é«˜ä»·å€¼æ•°æ®èµ„äº§å¹¶é â€œæ•°æ®çš„ç®€å•å †ç Œâ€ï¼Œè€Œæ˜¯ç»æ²»ç†ã€å¯å¤ç”¨ã€èƒ½é©±åŠ¨å†³ç­–çš„æ ¸å¿ƒç”Ÿäº§è¦ç´ ï¼Œç›´æ¥å†³å®šæ•°å­—åŒ–è½¬å‹çš„æ·±åº¦ä¸æˆæ•ˆã€‚é«˜è´¨é‡æ•°æ®å¯é©±åŠ¨å†³ç­–æ¨¡å¼å‡çº§ï¼Œæå‡ä¸šåŠ¡æ•ˆç‡ï¼ŒæŒ–æ˜å¢é‡ä¸šåŠ¡ä»·å€¼ã€‚</p>
<p>ç„¶è€Œï¼Œä¼ ç»Ÿè¡Œä¸šåœ¨æ„å»ºé«˜è´¨é‡æ•°æ®èµ„äº§æ—¶é¢ä¸´ä»¥ä¸‹å››å¤§æŒ‘æˆ˜ï¼šæŠ€æœ¯è¿½èµ¶å›°éš¾ï¼ŒData+AI æŠ€æœ¯è¿­ä»£é€Ÿåº¦å¿«ï¼ŒæŠ€æœ¯ç”Ÿå‘½å‘¨æœŸç¼©çŸ­ï¼›æ•°æ®åˆ†æ•£ï¼Œä¼ ç»Ÿåˆ¶é€ ä¸šã€é›¶å”®ä¸šå­˜åœ¨æ•°æ®å­¤å²›é—®é¢˜ï¼Œå„ä¸šåŠ¡åŸŸæ•°æ®æ— æ³•æœ‰æ•ˆäº’é€šï¼Œæ•´åˆéš¾åº¦å¤§ã€‚å¤šæ¨¡æ€æ•°æ®å¤„ç†ï¼Œä¼ ç»Ÿæ•°æ®å¤„ç†æ–¹æ³•æ— æ³•åº”å¯¹å›¾ç‰‡ã€éŸ³è§†é¢‘ç­‰å¤šæ¨¡æ€æ•°æ®çš„é«˜æ•ˆå¤„ç†éœ€æ±‚ã€‚äººæ‰çŸ­ç¼ºï¼Œç¼ºå°‘ Data+AI çš„å¤åˆå‹äººæ‰ã€‚</p>
<p>ä¸ºåº”å¯¹ä¸Šè¿°æŒ‘æˆ˜ï¼Œè…¾è®¯äº‘æ‰“é€ æ–°ä¸€ä»£æ•°æ®æ™ºèƒ½å¹³å° DIaaSï¼ˆData Intelligence as a Serviceï¼‰ã€‚è¯¥å¹³å°å¼ºè°ƒ Data ä¸ AI æŠ€æœ¯çš„å¯ç»„è£…æ€§ï¼Œæ˜¯ä¸€ä¸ªé›†æˆäº†å¤šæ¨¡æ€æ•°æ®å¤„ç†ã€AI æ¨¡å‹ã€Data Agent çš„â€œæ™ºèƒ½æ“ä½œç³»ç»Ÿâ€ã€‚DIaaS å°†å¼•æ“ã€æ¨¡å‹ç­‰è§£è€¦ä¸ºæ ‡å‡†åŒ–æ¨¡å—ï¼ŒéšæŠ€æœ¯è¿­ä»£å¿«é€Ÿæ›´æ¢ï¼›æä¾›ç»Ÿä¸€æ¹–ä»“åº•åº§ï¼Œæ‰“ç ´æ•°æ®å­¤å²›ï¼›å†…åµŒå¤šæ¨¡æ€æ•°æ®å¤„ç†ã€åˆ†æèƒ½åŠ›ï¼Œæ— ç¼ä¸å¤§æ¨¡å‹æœåŠ¡æ‰“é€šï¼›å†…ç½® Agentic Analyticsï¼Œå¯ååŒå¼€å‘å„ç±» Data+AI åº”ç”¨ã€‚</p>
<p>DIaaS æ‰“é€šâ€œä» Data åˆ° AIâ€çš„ä»·å€¼é“¾ï¼Œæœ‰æ•ˆé™ä½æŠ€æœ¯é—¨æ§›ï¼Œæå‡æ•æ·æ€§ï¼Œå¿«é€Ÿå“åº”ä¸šåŠ¡å˜åŒ–ã€‚ç¨‹å½¬å¼ºè°ƒï¼ŒDIaaS ä¸æ˜¯ä¸€å¥—å·¥å…·è€Œæ˜¯ä¸€ç§èƒ½åŠ›ï¼šè®©æ•°æ®æ™ºèƒ½çœŸæ­£æˆä¸ºè§¦æ‰‹å¯åŠçš„â€œæ°´ã€ç”µã€ç…¤â€ã€‚ç›®å‰ï¼ŒDIaaS å·²åœ¨å…·èº«æœºå™¨äººã€æ–°èƒ½æºæ±½è½¦ã€é›¶å”®å•†è¶…ç­‰é¢†åŸŸè½åœ°ï¼Œå¹¶åœ¨ç”µå•†ã€é‡‘èã€æ™ºèƒ½åˆ¶é€ ç­‰æ›´å¤šè¡Œä¸šæ‹“å±•åº”ç”¨åœºæ™¯ã€‚</p>
<p>ç¨‹å½¬è¡¨ç¤ºï¼ŒDIaaS çš„å»ºè®¾æ˜¯ä¸€ä¸ªé•¿æœŸè€Œç³»ç»Ÿçš„å·¥ç¨‹ï¼Œéœ€è¦è¡Œä¸šååŒã€å…±åŒæ¢ç´¢ã€‚å±•æœ›æœªæ¥ï¼ŒDIaaS æ‰“é€ å¼€æ”¾ç”Ÿæ€ï¼šé€šè¿‡å¼€æ”¾ API æˆ– MCP åè®®ç­‰å½¢å¼ï¼Œä¾¿äºä¼ä¸šå°†å…¶é›†æˆåˆ°ä¸åŒè¡Œä¸šçš„ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œå…±å»ºæ•°æ®æ™ºèƒ½æœåŠ¡ç”Ÿæ€ï¼›å¼ºåŒ– AI èåˆèƒ½åŠ›ï¼Œåœ¨å¤šæ¨¡æ€å¤§æ¨¡å‹ã€å…·èº«æ™ºèƒ½ç­‰é¢†åŸŸæŒç»­å‘å±•ï¼›æå‡å¹³å°çš„è‡ªæ²»èƒ½åŠ›ï¼Œä»è‡ªæˆ‘ä¼˜åŒ–åˆ°è‡ªæˆ‘ä¿®å¤ã€è‡ªæˆ‘è¿›åŒ–ï¼Œç¡®ä¿ä¼ä¸šä¸šåŠ¡å¹³ç¨³è¿è¡Œã€‚</p>
<h2 data-id="heading-9"><strong>åˆ†ç»„è„‘æš´ï¼Œè§‚ç‚¹PK</strong></h2>
<p>é™¤äº†ä»¥ä¸Šå¹²è´§æ»¡æ»¡çš„ä¸»é¢˜åˆ†äº«å¤–ï¼Œè…¾è®¯äº‘ TVP ç³»åˆ—æ´»åŠ¨æ³¨é‡äº’åŠ¨äº¤æµï¼Œæœ¬æ¬¡æ´»åŠ¨ç‰¹è®¾åˆ†ç»„è®¨è®ºï¼Œå¤´è„‘é£æš´ç¯èŠ‚ã€‚æ•°åä½æ¥è‡ªä¸åŒé¢†åŸŸçš„ä¸“å®¶åˆ†ä¸ºä¸åŒå°ç»„ï¼Œé’ˆå¯¹â€œé¢å¯¹äº§ä¸šåŒ– AI æµªæ½®ï¼Œä¼ä¸šåº”ä¼˜å…ˆâ€˜æ„å»ºè‡ªæœ‰çš„ AI æ ¸å¿ƒèƒ½åŠ›â€™ï¼Œè¿˜æ˜¯â€˜èå…¥å¼€æ”¾çš„äº§ä¸š AI ç”Ÿæ€â€™ä»¥å¯»æ±‚ååŒæ•ˆåº”ï¼Ÿâ€è¿™ä¸€ä¸å„ä¼ä¸šæ¯æ¯ç›¸å…³çš„è¯é¢˜ï¼Œæ­£ååŒæ–¹å±•å¼€ç§¯æè¾©è®ºï¼Œåˆ†äº«å„è‡ªçš„è§è§£å’Œå®é™…æ„Ÿå—ã€‚ç°åœºè®¨è®ºæ°”æ°›çƒ­çƒˆï¼Œç‚¹ç‡ƒåˆ›æ–°ç«èŠ±ã€‚</p>
<h2 data-id="heading-10"><strong>ç»“è¯­</strong></h2>
<p>åœ¨æœ¬æ¬¡ TVP AI åˆ›å˜ç ”è®¨ä¼šæœŸé—´ï¼Œä¸ä¼šä¸“å®¶å‚è§‚äº†ä¸­å›½æµ·è¯šè½»å·¥åšç‰©é¦†ï¼Œæ·±å…¥äº†è§£ä¸­å›½è½»å·¥ä¸šçš„å‘å±•å†ç¨‹ï¼Œå¹¶è§è¯æ•°æ™ºè½¬å‹çš„åˆ›æ–°è½åœ°å®è·µã€‚å„ä½å˜‰å®¾çš„ç²¾å½©åˆ†äº«ï¼Œå…¨é¢å‘ˆç°äº† AI æ—¶ä»£æ•°æ™ºæŠ€æœ¯å¦‚ä½•é©±åŠ¨äº§ä¸šæ–°è´¨ç”Ÿé•¿ï¼Œä¸ä»…ä¸ºå‚ä¼šè€…æä¾›äº†ä¸°å¯Œçš„å®è·µæ¡ˆä¾‹ï¼Œä¹Ÿä¸ºä¼ä¸šåœ¨ AI æ—¶ä»£çš„æˆ˜ç•¥å¸ƒå±€ä¸å‘å±•æä¾›äº†æœ‰åŠ›ä¾æ®ï¼ŒåŠ©åŠ›ä¼ä¸šåœ¨ AI æµªæ½®ä¸­åŠ é€Ÿåˆ›æ–°æ­¥ä¼ï¼Œå®ç°é«˜è´¨é‡å‘å±•ã€‚</p>
<p>è…¾è®¯äº‘ TVP å³å°†è¿æ¥ä¸ƒå‘¨å¹´ã€‚å±•æœ›æœªæ¥ï¼Œè…¾è®¯äº‘ TVP å°†ç»§ç»­ç§‰æŒâ€œç”¨ç§‘æŠ€å½±å“ä¸–ç•Œâ€çš„åˆå¿ƒï¼Œæºæ‰‹æ›´å¤šä¸“å®¶å¤§å’–èµ°è¿›ä¸åŒåŸå¸‚ã€ä¸åŒä¼ä¸šï¼Œå…±åŒæ¢ç´¢ AI æ—¶ä»£æ–°è´¨ç”Ÿäº§åŠ›çš„æ— é™å¯èƒ½ï¼Œä¸ºå¼€å‘è€…æœ‹å‹åˆ†äº«å¹²è´§æŠ€æœ¯ã€å‰æ²¿æ´å¯Ÿã€è½åœ°å®è·µï¼ŒçŒ®ä¸Šä¸€åœºç²¾å½©æœ‰æ–™ã€æœ‰è¶£ã€æœ‰ç”¨çš„æŠ€æœ¯ç››å®´ã€‚</p>
<p>TVPï¼Œå³è…¾è®¯äº‘æœ€å…·ä»·å€¼ä¸“å®¶(Tencent Cloud Valuable Professional)ï¼Œæ˜¯è…¾è®¯äº‘æˆäºˆäº‘è®¡ç®—é¢†åŸŸæŠ€æœ¯ä¸“å®¶çš„ä¸€ä¸ªå¥–é¡¹ã€‚TVP è‡´åŠ›æ‰“é€ ä¸è¡Œä¸šæŠ€æœ¯ä¸“å®¶çš„äº¤æµå¹³å°ï¼Œä¿ƒè¿›è…¾è®¯äº‘ä¸æŠ€æœ¯ä¸“å®¶å’Œç”¨æˆ·ä¹‹é—´çš„æœ‰æ•ˆæ²Ÿé€šï¼Œä»è€Œæ„å»ºäº‘è®¡ç®—æŠ€æœ¯ç”Ÿæ€ï¼Œå®ç°â€œç”¨ç§‘æŠ€å½±å“ä¸–ç•Œâ€çš„ç¾å¥½æ„¿æ™¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[IndexedDB å®æˆ˜ï¼šå°è£…ä¸€ä¸ªé€šç”¨å·¥å…·ç±»ï¼Œæå®šæ‰€æœ‰æœ¬åœ°å­˜å‚¨éœ€æ±‚]]></title>    <link>https://juejin.cn/post/7585214391828398123</link>    <guid>https://juejin.cn/post/7585214391828398123</guid>    <pubDate>2025-12-19T08:58:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585214391828398123" data-draft-id="7585138968167596068" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="IndexedDB å®æˆ˜ï¼šå°è£…ä¸€ä¸ªé€šç”¨å·¥å…·ç±»ï¼Œæå®šæ‰€æœ‰æœ¬åœ°å­˜å‚¨éœ€æ±‚"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2025-12-19T08:58:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="momo100"/> <meta itemprop="url" content="https://juejin.cn/user/589753666504749"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            IndexedDB å®æˆ˜ï¼šå°è£…ä¸€ä¸ªé€šç”¨å·¥å…·ç±»ï¼Œæå®šæ‰€æœ‰æœ¬åœ°å­˜å‚¨éœ€æ±‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/589753666504749/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    momo100
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T08:58:50.000Z" title="Fri Dec 19 2025 08:58:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    14
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">IndexedDB å®Œå…¨æŒ‡å—ï¼šä»åŸºç¡€ä½¿ç”¨åˆ°å°è£…å®æˆ˜ï¼ˆå«å®Œæ•´ API ä¸æœ€ä½³å®è·µï¼‰</h2>
<p>åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæœ¬åœ°å­˜å‚¨æ˜¯å®ç°æ•°æ®æŒä¹…åŒ–ã€æå‡ç”¨æˆ·ä½“éªŒçš„æ ¸å¿ƒæŠ€æœ¯ä¹‹ä¸€ã€‚å¸¸è§çš„æµè§ˆå™¨å­˜å‚¨æ–¹æ¡ˆå„æœ‰ä¼˜åŠ£ï¼Œè€Œ IndexedDB ä½œä¸ºä¸€ç§é«˜æ€§èƒ½çš„æœ¬åœ°æ•°æ®åº“ï¼Œå‡­å€Ÿå…¶å¤§å®¹é‡ã€å¼‚æ­¥æ“ä½œã€æ”¯æŒå¤æ‚æ•°æ®ç±»å‹ç­‰ç‰¹æ€§ï¼Œæˆä¸ºå¤„ç†å¤§é‡ç»“æ„åŒ–æ•°æ®çš„é¦–é€‰æ–¹æ¡ˆã€‚æœ¬æ–‡å°†ç³»ç»Ÿè®²è§£ IndexedDB çš„æ ¸å¿ƒæ¦‚å¿µã€åŸºç¡€ç”¨æ³•ã€å®Œæ•´å°è£…ä»¥åŠæœ€ä½³å®è·µï¼Œå¼¥è¡¥åŸºç¡€ç”¨æ³•çš„é—æ¼ç‚¹ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿä¸Šæ‰‹å¹¶çµæ´»è¿ç”¨ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€å‰ç«¯å­˜å‚¨æ–¹æ¡ˆå¯¹æ¯”ï¼ˆè¡¥å……ç»†èŠ‚ï¼‰</h3>
<p>åœ¨æ·±å…¥ IndexedDB ä¹‹å‰ï¼Œå…ˆæ˜ç¡®å®ƒä¸å…¶ä»–å­˜å‚¨æ–¹æ¡ˆçš„å·®å¼‚ï¼Œæ–¹ä¾¿æ ¹æ®åœºæ™¯é€‰å‹ï¼š</p>













































<table><thead><tr><th>å­˜å‚¨æ–¹æ¡ˆ</th><th>å­˜å‚¨å®¹é‡</th><th>æ—¶æ•ˆæ€§</th><th>æ•°æ®ç±»å‹</th><th>æ ¸å¿ƒç‰¹æ€§</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>LocalStorage</td><td>5MB-10MBï¼ˆæµè§ˆå™¨å·®å¼‚ï¼‰</td><td>æ°¸ä¹…å­˜å‚¨ï¼ˆæ‰‹åŠ¨æ¸…é™¤ï¼‰</td><td>ä»…å­—ç¬¦ä¸²ï¼ˆéœ€åºåˆ—åŒ–ï¼‰</td><td>åŒæ­¥æ“ä½œï¼Œç®€å•é”®å€¼å¯¹</td><td>å°‘é‡ç”¨æˆ·é…ç½®ã€token å­˜å‚¨</td></tr><tr><td>SessionStorage</td><td>5MB-10MBï¼ˆæµè§ˆå™¨å·®å¼‚ï¼‰</td><td>ä¼šè¯çº§ï¼ˆé¡µé¢å…³é—­æ¸…é™¤ï¼‰</td><td>ä»…å­—ç¬¦ä¸²ï¼ˆéœ€åºåˆ—åŒ–ï¼‰</td><td>åŒæ­¥æ“ä½œï¼Œé¡µé¢éš”ç¦»</td><td>ä¸´æ—¶è¡¨å•æ•°æ®ã€ä¼šè¯çŠ¶æ€</td></tr><tr><td>Cookie</td><td>4KB</td><td>å¯è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆé»˜è®¤ä¼šè¯ï¼‰</td><td>ä»…å­—ç¬¦ä¸²</td><td>éšè¯·æ±‚æºå¸¦ï¼ŒåŒåŸŸå…±äº«</td><td>ç”¨æˆ·èº«ä»½æ ‡è¯†ã€è·Ÿè¸ªç»Ÿè®¡</td></tr><tr><td>IndexedDB</td><td>æ— å›ºå®šä¸Šé™ï¼ˆä¾èµ–è®¾å¤‡å­˜å‚¨ç©ºé—´ï¼Œé€šå¸¸ &gt;250MBï¼‰</td><td>æ°¸ä¹…å­˜å‚¨ï¼ˆæ‰‹åŠ¨æ¸…é™¤ï¼‰</td><td>å­—ç¬¦ä¸²ã€æ•°å­—ã€å¯¹è±¡ã€äºŒè¿›åˆ¶æ•°æ®ï¼ˆBlob/ArrayBufferï¼‰</td><td>å¼‚æ­¥æ“ä½œï¼Œäº‹åŠ¡æ”¯æŒï¼Œç´¢å¼•æŸ¥è¯¢</td><td>å¤§é‡ç»“æ„åŒ–æ•°æ®ã€ç¦»çº¿åº”ç”¨ã€æ–‡ä»¶ç¼“å­˜</td></tr></tbody></table>
<p><strong>å…³é”®è¡¥å……</strong>ï¼š</p>
<ul>
<li>LocalStorage/SessionStorage åŒæ­¥æ“ä½œä¼šé˜»å¡ä¸»çº¿ç¨‹ï¼Œå¤„ç†å¤§é‡æ•°æ®æ—¶å¯èƒ½å¯¼è‡´é¡µé¢å¡é¡¿ï¼›IndexedDB å¼‚æ­¥æ“ä½œä¸ä¼šé˜»å¡ UIï¼Œæ€§èƒ½æ›´ä¼˜ã€‚</li>
<li>Cookie æ¯æ¬¡è¯·æ±‚éƒ½ä¼šæºå¸¦åˆ°æœåŠ¡å™¨ï¼Œå¢åŠ å¸¦å®½æ¶ˆè€—ï¼›IndexedDB ä»…åœ¨æœ¬åœ°æ“ä½œï¼Œä¸ä¸æœåŠ¡å™¨äº¤äº’ã€‚</li>
<li>IndexedDB æ”¯æŒäº‹åŠ¡ï¼ˆTransactionï¼‰ï¼Œç¡®ä¿æ•°æ®æ“ä½œçš„åŸå­æ€§ï¼ˆè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼‰ï¼Œè¿™æ˜¯å…¶ä»–å­˜å‚¨æ–¹æ¡ˆä¸å…·å¤‡çš„æ ¸å¿ƒä¼˜åŠ¿ã€‚</li>
</ul>
<h3 data-id="heading-2">äºŒã€IndexedDB æ ¸å¿ƒæ¦‚å¿µï¼ˆè¡¥å……åŸºç¡€è®¤çŸ¥ï¼‰</h3>
<p>åœ¨ä½¿ç”¨å‰éœ€ç†è§£ä»¥ä¸‹æ ¸å¿ƒæœ¯è¯­ï¼Œé¿å…æ··æ·†ï¼š</p>
<ol>
<li><strong>æ•°æ®åº“ï¼ˆDatabaseï¼‰</strong> ï¼šIndexedDB çš„é¡¶å±‚å®¹å™¨ï¼Œæ¯ä¸ªæ•°æ®åº“æœ‰å”¯ä¸€åç§°å’Œç‰ˆæœ¬å·ï¼Œç‰ˆæœ¬å·å‡çº§æ—¶ä¼šè§¦å‘ <code>onupgradeneeded</code> äº‹ä»¶ã€‚</li>
<li><strong>å¯¹è±¡ä»“åº“ï¼ˆObject Storeï¼‰</strong> ï¼šç±»ä¼¼å…³ç³»å‹æ•°æ®åº“çš„â€œè¡¨â€ï¼Œç”¨äºå­˜å‚¨ç»“æ„åŒ–æ•°æ®ï¼Œæ¯ä¸ªå¯¹è±¡ä»“åº“æœ‰å”¯ä¸€ä¸»é”®ï¼ˆkeyPathï¼‰ã€‚</li>
<li><strong>äº‹åŠ¡ï¼ˆTransactionï¼‰</strong> ï¼šæ‰€æœ‰æ•°æ®æ“ä½œï¼ˆå¢åˆ æŸ¥æ”¹ï¼‰å¿…é¡»é€šè¿‡äº‹åŠ¡æ‰§è¡Œï¼Œæ”¯æŒ <code>readonly</code>ï¼ˆåªè¯»ï¼‰å’Œ <code>readwrite</code>ï¼ˆè¯»å†™ï¼‰ä¸¤ç§æ¨¡å¼ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚</li>
<li><strong>ç´¢å¼•ï¼ˆIndexï¼‰</strong> ï¼šåŸºäºå¯¹è±¡ä»“åº“çš„æŸä¸ªå±æ€§åˆ›å»ºï¼Œç”¨äºå¿«é€ŸæŸ¥è¯¢æ•°æ®ï¼ˆç±»ä¼¼æ•°æ®åº“ç´¢å¼•ï¼‰ï¼Œæ”¯æŒå”¯ä¸€ç´¢å¼•ï¼ˆ<code>unique: true</code>ï¼‰å’Œéå”¯ä¸€ç´¢å¼•ã€‚</li>
<li><strong>ä¸»é”®ï¼ˆKeyPathï¼‰</strong> ï¼šå¯¹è±¡ä»“åº“ä¸­æ¯æ¡æ•°æ®çš„å”¯ä¸€æ ‡è¯†ï¼Œå¯æ‰‹åŠ¨æŒ‡å®šï¼ˆå¦‚ <code>deviceId</code>ï¼‰æˆ–è‡ªåŠ¨ç”Ÿæˆï¼ˆ<code>autoIncrement: true</code>ï¼‰ã€‚</li>
<li><strong>æ¸¸æ ‡ï¼ˆCursorï¼‰</strong> ï¼šç”¨äºéå†å¯¹è±¡ä»“åº“ä¸­çš„æ•°æ®ï¼Œæ”¯æŒæ¡ä»¶ç­›é€‰ã€æ’åºç­‰å¤æ‚æŸ¥è¯¢ï¼ˆåŸºç¡€ç”¨æ³•ä¸­æœªæåŠï¼Œä¸‹æ–‡è¡¥å……ï¼‰ã€‚</li>
</ol>
<h3 data-id="heading-3">ä¸‰ã€IndexedDB åŸºç¡€ç”¨æ³•ï¼ˆå®Œå–„é—æ¼ API ä¸åœºæ™¯ï¼‰</h3>
<h4 data-id="heading-4">1. ç¯å¢ƒå…¼å®¹å¤„ç†</h4>
<p>ä¸åŒæµè§ˆå™¨å¯¹ IndexedDB çš„å‰ç¼€æ”¯æŒä¸åŒï¼Œéœ€å…ˆåšå…¼å®¹å¤„ç†ï¼ˆè¡¥å……å®Œæ•´å‰ç¼€ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å®Œæ•´å…¼å®¹æ–¹æ¡ˆ</span>
<span class="hljs-keyword">const</span> indexedDB = <span class="hljs-variable language_">window</span>.<span class="hljs-property">indexedDB</span> || 
                  <span class="hljs-variable language_">window</span>.<span class="hljs-property">webkitIndexedDB</span> || 
                  <span class="hljs-variable language_">window</span>.<span class="hljs-property">mozIndexedDB</span> || 
                  <span class="hljs-variable language_">window</span>.<span class="hljs-property">msIndexedDB</span>; <span class="hljs-comment">// IE æµè§ˆå™¨æ”¯æŒ</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">IDBTransaction</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">IDBTransaction</span> || 
                       <span class="hljs-variable language_">window</span>.<span class="hljs-property">webkitIDBTransaction</span> || 
                       <span class="hljs-variable language_">window</span>.<span class="hljs-property">mozIDBTransaction</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title class_">IDBCursor</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">IDBCursor</span> || 
                  <span class="hljs-variable language_">window</span>.<span class="hljs-property">webkitIDBCursor</span> || 
                  <span class="hljs-variable language_">window</span>.<span class="hljs-property">mozIDBCursor</span>;

<span class="hljs-comment">// æ£€æµ‹æµè§ˆå™¨æ˜¯å¦æ”¯æŒ</span>
<span class="hljs-keyword">if</span> (!indexedDB) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å½“å‰æµè§ˆå™¨ä¸æ”¯æŒ IndexedDBï¼Œè¯·å‡çº§æµè§ˆå™¨'</span>);
}
</code></pre>
<h4 data-id="heading-5">2. æ‰“å¼€/åˆ›å»ºæ•°æ®åº“</h4>
<p>ä½¿ç”¨ <code>indexedDB.open(dbName, version)</code> æ‰“å¼€æ•°æ®åº“ï¼Œç‰ˆæœ¬å·å¿…é¡»ä¸ºæ­£æ•´æ•°ï¼Œå‡çº§ç‰ˆæœ¬æ—¶ä¼šè§¦å‘ <code>onupgradeneeded</code> äº‹ä»¶ï¼ˆè¡¥å……é”™è¯¯å¤„ç†ç»†èŠ‚ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ‰“å¼€æ•°æ®åº“ï¼ˆæ•°æ®åº“åï¼šdeviceDBï¼Œç‰ˆæœ¬å·ï¼š2ï¼‰</span>
<span class="hljs-keyword">const</span> request = indexedDB.<span class="hljs-title function_">open</span>(<span class="hljs-string">'deviceDB'</span>, <span class="hljs-number">2</span>);

<span class="hljs-comment">// æ•°æ®åº“æ‰“å¼€å¤±è´¥ï¼ˆå¦‚æƒé™ä¸è¶³ã€å­˜å‚¨æ»¡ï¼‰</span>
request.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ•°æ®åº“æ‰“å¼€å¤±è´¥ï¼š'</span>, event.<span class="hljs-property">target</span>.<span class="hljs-property">error</span>.<span class="hljs-property">message</span>);
};

<span class="hljs-comment">// æ•°æ®åº“æ‰“å¼€æˆåŠŸ</span>
request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> db = event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•°æ®åº“æ‰“å¼€æˆåŠŸï¼Œç‰ˆæœ¬å·ï¼š'</span>, db.<span class="hljs-property">version</span>);
  
  <span class="hljs-comment">// æ“ä½œå®Œæˆåå…³é—­æ•°æ®åº“ï¼ˆé¿å…èµ„æºå ç”¨ï¼‰</span>
  <span class="hljs-comment">// db.close();</span>
};

<span class="hljs-comment">// æ•°æ®åº“åˆ›å»ºæˆ–ç‰ˆæœ¬å‡çº§æ—¶è§¦å‘ï¼ˆä»…ä¸€æ¬¡ï¼‰</span>
request.<span class="hljs-property">onupgradeneeded</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> db = event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•°æ®åº“å‡çº§ï¼Œæ—§ç‰ˆæœ¬ï¼š'</span>, event.<span class="hljs-property">oldVersion</span>, <span class="hljs-string">'æ–°ç‰ˆæœ¬ï¼š'</span>, event.<span class="hljs-property">newVersion</span>);
  
  <span class="hljs-comment">// æ­¤å¤„å¯æ‰§è¡Œå»ºè¡¨ã€åˆ è¡¨ã€åˆ›å»ºç´¢å¼•ç­‰æ“ä½œ</span>
};
</code></pre>
<h4 data-id="heading-6">3. æ“ä½œå¯¹è±¡ä»“åº“ï¼ˆè¡¥å……å®Œæ•´åœºæ™¯ï¼‰</h4>
<h5 data-id="heading-7">ï¼ˆ1ï¼‰åˆ›å»ºå¯¹è±¡ä»“åº“ï¼ˆè¡¨ï¼‰</h5>
<p>åœ¨ <code>onupgradeneeded</code> äº‹ä»¶ä¸­åˆ›å»ºå¯¹è±¡ä»“åº“ï¼Œæ”¯æŒä¸¤ç§ä¸»é”®æ¨¡å¼ï¼ˆè¡¥å……è‡ªåŠ¨ç”Ÿæˆä¸»é”®ç¤ºä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">request.<span class="hljs-property">onupgradeneeded</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> db = event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>;
  
  <span class="hljs-comment">// æ–¹å¼1ï¼šæ‰‹åŠ¨æŒ‡å®šä¸»é”®ï¼ˆå¦‚ deviceIdï¼‰</span>
  <span class="hljs-keyword">if</span> (!db.<span class="hljs-property">objectStoreNames</span>.<span class="hljs-title function_">contains</span>(<span class="hljs-string">'cameraDevice'</span>)) {
    <span class="hljs-keyword">const</span> cameraStore = db.<span class="hljs-title function_">createObjectStore</span>(<span class="hljs-string">'cameraDevice'</span>, { 
      <span class="hljs-attr">keyPath</span>: <span class="hljs-string">'deviceId'</span> <span class="hljs-comment">// ä¸»é”®å­—æ®µ</span>
    });
    
    <span class="hljs-comment">// åˆ›å»ºç´¢å¼•ï¼šåŸºäº deviceNameï¼ˆéå”¯ä¸€ï¼‰ã€statusï¼ˆå”¯ä¸€ï¼‰</span>
    cameraStore.<span class="hljs-title function_">createIndex</span>(<span class="hljs-string">'idx_deviceName'</span>, <span class="hljs-string">'deviceName'</span>, { <span class="hljs-attr">unique</span>: <span class="hljs-literal">false</span> });
    cameraStore.<span class="hljs-title function_">createIndex</span>(<span class="hljs-string">'idx_status'</span>, <span class="hljs-string">'status'</span>, { <span class="hljs-attr">unique</span>: <span class="hljs-literal">false</span> });
  }
  
  <span class="hljs-comment">// æ–¹å¼2ï¼šè‡ªåŠ¨ç”Ÿæˆä¸»é”®ï¼ˆautoIncrement: trueï¼‰</span>
  <span class="hljs-keyword">if</span> (!db.<span class="hljs-property">objectStoreNames</span>.<span class="hljs-title function_">contains</span>(<span class="hljs-string">'user'</span>)) {
    <span class="hljs-keyword">const</span> userStore = db.<span class="hljs-title function_">createObjectStore</span>(<span class="hljs-string">'user'</span>, { 
      <span class="hljs-attr">autoIncrement</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// ä¸»é”®è‡ªåŠ¨é€’å¢ï¼ˆé»˜è®¤å­—æ®µåï¼šidï¼‰</span>
    });
    userStore.<span class="hljs-title function_">createIndex</span>(<span class="hljs-string">'idx_username'</span>, <span class="hljs-string">'username'</span>, { <span class="hljs-attr">unique</span>: <span class="hljs-literal">true</span> }); <span class="hljs-comment">// ç”¨æˆ·åå”¯ä¸€ç´¢å¼•</span>
  }
  
  <span class="hljs-comment">// åˆ é™¤æ—§è¡¨ï¼ˆå¦‚éœ€ï¼‰</span>
  <span class="hljs-keyword">if</span> (db.<span class="hljs-property">objectStoreNames</span>.<span class="hljs-title function_">contains</span>(<span class="hljs-string">'oldDevice'</span>)) {
    db.<span class="hljs-title function_">deleteObjectStore</span>(<span class="hljs-string">'oldDevice'</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ—§è¡¨å·²åˆ é™¤'</span>);
  }
};
</code></pre>
<h5 data-id="heading-8">ï¼ˆ2ï¼‰æ–°å¢æ•°æ®ï¼ˆè¡¥å……æ‰¹é‡æ–°å¢ä¸é‡å¤ä¸»é”®å¤„ç†ï¼‰</h5>
<p>é€šè¿‡ <code>add()</code> æ–¹æ³•æ–°å¢æ•°æ®ï¼Œ<strong>ä¸»é”®é‡å¤ä¼šæŠ¥é”™</strong>ï¼›è‹¥éœ€è¦†ç›–é‡å¤æ•°æ®ï¼Œå¯ä½¿ç”¨ <code>put()</code> æ–¹æ³•ï¼ˆåç»­è®²è§£ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ•°æ®åº“æ‰“å¼€æˆåŠŸåæ‰§è¡Œæ–°å¢</span>
request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> db = event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>;
  
  <span class="hljs-comment">// å¼€å¯è¯»å†™äº‹åŠ¡ï¼ˆæŒ‡å®šæ“ä½œçš„è¡¨åï¼‰</span>
  <span class="hljs-keyword">const</span> transaction = db.<span class="hljs-title function_">transaction</span>([<span class="hljs-string">'cameraDevice'</span>], <span class="hljs-string">'readwrite'</span>);
  <span class="hljs-keyword">const</span> cameraStore = transaction.<span class="hljs-title function_">objectStore</span>(<span class="hljs-string">'cameraDevice'</span>);
  
  <span class="hljs-comment">// å•ä¸ªæ–°å¢</span>
  cameraStore.<span class="hljs-title function_">add</span>({
    <span class="hljs-attr">deviceId</span>: <span class="hljs-string">'cam_888'</span>,
    <span class="hljs-attr">deviceName</span>: <span class="hljs-string">'æˆéƒ½åŒé“æ‘„åƒå¤´'</span>,
    <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// 1ï¼šåœ¨çº¿ï¼Œ0ï¼šç¦»çº¿</span>
    <span class="hljs-attr">resolution</span>: <span class="hljs-string">'1080P'</span>,
    <span class="hljs-attr">createTime</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()
  });
  
  <span class="hljs-comment">// æ‰¹é‡æ–°å¢ï¼ˆè¡¥å……ï¼‰</span>
  <span class="hljs-keyword">const</span> batchData = [
    { <span class="hljs-attr">deviceId</span>: <span class="hljs-string">'cam_999'</span>, <span class="hljs-attr">deviceName</span>: <span class="hljs-string">'åŒ—äº¬è·¯å£æ‘„åƒå¤´'</span>, <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">resolution</span>: <span class="hljs-string">'4K'</span>, <span class="hljs-attr">createTime</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>() },
    { <span class="hljs-attr">deviceId</span>: <span class="hljs-string">'cam_777'</span>, <span class="hljs-attr">deviceName</span>: <span class="hljs-string">'ä¸Šæµ·éš§é“æ‘„åƒå¤´'</span>, <span class="hljs-attr">status</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">resolution</span>: <span class="hljs-string">'720P'</span>, <span class="hljs-attr">createTime</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>() }
  ];
  batchData.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> cameraStore.<span class="hljs-title function_">add</span>(data));
  
  <span class="hljs-comment">// äº‹åŠ¡å®Œæˆå›è°ƒ</span>
  transaction.<span class="hljs-property">oncomplete</span> = <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•°æ®æ–°å¢æˆåŠŸ'</span>);
    db.<span class="hljs-title function_">close</span>(); <span class="hljs-comment">// å…³é—­æ•°æ®åº“</span>
  };
  
  <span class="hljs-comment">// äº‹åŠ¡å¤±è´¥å›è°ƒï¼ˆå¦‚ä¸»é”®é‡å¤ï¼‰</span>
  transaction.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ•°æ®æ–°å¢å¤±è´¥ï¼š'</span>, event.<span class="hljs-property">target</span>.<span class="hljs-property">error</span>.<span class="hljs-property">message</span>);
    db.<span class="hljs-title function_">close</span>();
  };
};
</code></pre>
<h5 data-id="heading-9">ï¼ˆ3ï¼‰æŸ¥è¯¢æ•°æ®ï¼ˆè¡¥å……æ¸¸æ ‡æŸ¥è¯¢ã€æ¡ä»¶ç­›é€‰ï¼‰</h5>
<p>IndexedDB æ”¯æŒä¸»é”®æŸ¥è¯¢ã€ç´¢å¼•æŸ¥è¯¢ã€å…¨é‡æŸ¥è¯¢å’Œæ¸¸æ ‡æŸ¥è¯¢ï¼Œæ»¡è¶³ä¸åŒåœºæ™¯éœ€æ±‚ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">request.onsuccess</span> = (event) =&gt; {
  const <span class="hljs-attr">db</span> = event.target.result<span class="hljs-comment">;</span>
  const <span class="hljs-attr">transaction</span> = db.transaction([<span class="hljs-string">'cameraDevice'</span>], <span class="hljs-string">'readonly'</span>)<span class="hljs-comment">;</span>
  const <span class="hljs-attr">cameraStore</span> = transaction.objectStore(<span class="hljs-string">'cameraDevice'</span>)<span class="hljs-comment">;</span>
  
  // 1. ä¸»é”®æŸ¥è¯¢ï¼ˆç²¾å‡†åŒ¹é…ï¼‰
  const <span class="hljs-attr">keyRequest</span> = cameraStore.get(<span class="hljs-string">'cam_888'</span>)<span class="hljs-comment">;</span>
  <span class="hljs-attr">keyRequest.onsuccess</span> = () =&gt; {
    console.log('ä¸»é”®æŸ¥è¯¢ç»“æœï¼š', keyRequest.result)<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
  
  // 2. ç´¢å¼•æŸ¥è¯¢ï¼ˆåŸºäºç´¢å¼•å­—æ®µåŒ¹é…ï¼‰
  const <span class="hljs-attr">indexRequest</span> = cameraStore.index(<span class="hljs-string">'idx_deviceName'</span>).get(<span class="hljs-string">'åŒ—äº¬è·¯å£æ‘„åƒå¤´'</span>)<span class="hljs-comment">;</span>
  <span class="hljs-attr">indexRequest.onsuccess</span> = () =&gt; {
    console.log('ç´¢å¼•æŸ¥è¯¢ç»“æœï¼š', indexRequest.result)<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
  
  // 3. å…¨é‡æŸ¥è¯¢ï¼ˆè·å–æ‰€æœ‰æ•°æ®ï¼‰
  const <span class="hljs-attr">allRequest</span> = cameraStore.getAll()<span class="hljs-comment">;</span>
  <span class="hljs-attr">allRequest.onsuccess</span> = () =&gt; {
    console.log('å…¨é‡æŸ¥è¯¢ç»“æœï¼š', allRequest.result)<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
  
  // 4. æ¸¸æ ‡æŸ¥è¯¢ï¼ˆè¡¥å……ï¼šéå†æ•°æ®ã€æ¡ä»¶ç­›é€‰ã€æ’åºï¼‰
  const <span class="hljs-attr">cursorRequest</span> = cameraStore.openCursor(null, <span class="hljs-string">'next'</span>)<span class="hljs-comment">; // nextï¼šæ­£åºï¼Œprevï¼šå€’åº</span>
  const <span class="hljs-attr">onlineCameras</span> = []<span class="hljs-comment">;</span>
  
  <span class="hljs-attr">cursorRequest.onsuccess</span> = (event) =&gt; {
    const <span class="hljs-attr">cursor</span> = event.target.result<span class="hljs-comment">;</span>
    if (cursor) {
      // æ¡ä»¶ç­›é€‰ï¼šåªä¿ç•™åœ¨çº¿è®¾å¤‡ï¼ˆstatus: 1ï¼‰
      if (<span class="hljs-attr">cursor.value.status</span> === <span class="hljs-number">1</span>) {
        onlineCameras.push(cursor.value)<span class="hljs-comment">;</span>
      }
      cursor.continue()<span class="hljs-comment">; // ç»§ç»­éå†ä¸‹ä¸€æ¡</span>
    } else {
      console.log('æ¸¸æ ‡æŸ¥è¯¢ï¼ˆåœ¨çº¿è®¾å¤‡ï¼‰ï¼š', onlineCameras)<span class="hljs-comment">;</span>
    }
  }<span class="hljs-comment">;</span>
  
  <span class="hljs-attr">transaction.oncomplete</span> = () =&gt; {
    db.close()<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<h5 data-id="heading-10">ï¼ˆ4ï¼‰ä¿®æ”¹æ•°æ®ï¼ˆè¡¥å……æ‰¹é‡ä¿®æ”¹ã€ç´¢å¼•å®šä½ä¿®æ”¹ï¼‰</h5>
<p>ä½¿ç”¨ <code>put()</code> æ–¹æ³•ä¿®æ”¹æ•°æ®ï¼Œ<strong>å­˜åœ¨ä¸»é”®åˆ™æ›´æ–°ï¼Œä¸å­˜åœ¨åˆ™æ–°å¢</strong>ï¼ˆä¸ <code>add()</code> çš„æ ¸å¿ƒåŒºåˆ«ï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">request.onsuccess</span> = (event) =&gt; {
  const <span class="hljs-attr">db</span> = event.target.result<span class="hljs-comment">;</span>
  const <span class="hljs-attr">transaction</span> = db.transaction([<span class="hljs-string">'cameraDevice'</span>], <span class="hljs-string">'readwrite'</span>)<span class="hljs-comment">;</span>
  const <span class="hljs-attr">cameraStore</span> = transaction.objectStore(<span class="hljs-string">'cameraDevice'</span>)<span class="hljs-comment">;</span>
  
  // æ–¹å¼1ï¼šä¸»é”®å®šä½ä¿®æ”¹
  const <span class="hljs-attr">getRequest</span> = cameraStore.get(<span class="hljs-string">'cam_777'</span>)<span class="hljs-comment">;</span>
  <span class="hljs-attr">getRequest.onsuccess</span> = () =&gt; {
    const <span class="hljs-attr">data</span> = getRequest.result<span class="hljs-comment">;</span>
    <span class="hljs-attr">data.status</span> = <span class="hljs-number">1</span><span class="hljs-comment">; // çŠ¶æ€æ”¹ä¸ºåœ¨çº¿</span>
    <span class="hljs-attr">data.resolution</span> = <span class="hljs-string">'1080P'</span><span class="hljs-comment">; // æ›´æ–°åˆ†è¾¨ç‡</span>
    cameraStore.put(data)<span class="hljs-comment">; // æäº¤ä¿®æ”¹</span>
  }<span class="hljs-comment">;</span>
  
  // æ–¹å¼2ï¼šç´¢å¼•å®šä½ä¿®æ”¹ï¼ˆè¡¥å……ï¼‰
  const <span class="hljs-attr">indexGetRequest</span> = cameraStore.index(<span class="hljs-string">'idx_deviceName'</span>).get(<span class="hljs-string">'æˆéƒ½åŒé“æ‘„åƒå¤´'</span>)<span class="hljs-comment">;</span>
  <span class="hljs-attr">indexGetRequest.onsuccess</span> = () =&gt; {
    const <span class="hljs-attr">data</span> = indexGetRequest.result<span class="hljs-comment">;</span>
    <span class="hljs-attr">data.createTime</span> = new Date().toISOString()<span class="hljs-comment">; // æ›´æ–°æ—¶é—´</span>
    cameraStore.put(data)<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
  
  <span class="hljs-attr">transaction.oncomplete</span> = () =&gt; {
    console.log('æ•°æ®ä¿®æ”¹æˆåŠŸ')<span class="hljs-comment">;</span>
    db.close()<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<h5 data-id="heading-11">ï¼ˆ5ï¼‰åˆ é™¤æ•°æ®ï¼ˆè¡¥å……æ‰¹é‡åˆ é™¤ã€ç´¢å¼•å®šä½åˆ é™¤ï¼‰</h5>
<p>æ”¯æŒä¸»é”®åˆ é™¤å’Œç´¢å¼•å®šä½åˆ é™¤ï¼Œæ‰¹é‡åˆ é™¤éœ€ç»“åˆæ¸¸æ ‡å®ç°ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">request.onsuccess</span> = (event) =&gt; {
  const <span class="hljs-attr">db</span> = event.target.result<span class="hljs-comment">;</span>
  const <span class="hljs-attr">transaction</span> = db.transaction([<span class="hljs-string">'cameraDevice'</span>], <span class="hljs-string">'readwrite'</span>)<span class="hljs-comment">;</span>
  const <span class="hljs-attr">cameraStore</span> = transaction.objectStore(<span class="hljs-string">'cameraDevice'</span>)<span class="hljs-comment">;</span>
  
  // 1. ä¸»é”®åˆ é™¤
  cameraStore.delete('cam_999')<span class="hljs-comment">;</span>
  
  // 2. ç´¢å¼•å®šä½åˆ é™¤ï¼ˆè¡¥å……ï¼‰
  const <span class="hljs-attr">indexGetRequest</span> = cameraStore.index(<span class="hljs-string">'idx_deviceName'</span>).get(<span class="hljs-string">'ä¸Šæµ·éš§é“æ‘„åƒå¤´'</span>)<span class="hljs-comment">;</span>
  <span class="hljs-attr">indexGetRequest.onsuccess</span> = () =&gt; {
    const <span class="hljs-attr">data</span> = indexGetRequest.result<span class="hljs-comment">;</span>
    if (data) {
      cameraStore.delete(data.deviceId)<span class="hljs-comment">; // é€šè¿‡ä¸»é”®åˆ é™¤</span>
    }
  }<span class="hljs-comment">;</span>
  
  // 3. æ‰¹é‡åˆ é™¤ï¼ˆè¡¥å……ï¼šåˆ é™¤æ‰€æœ‰ç¦»çº¿è®¾å¤‡ï¼‰
  const <span class="hljs-attr">cursorRequest</span> = cameraStore.openCursor()<span class="hljs-comment">;</span>
  <span class="hljs-attr">cursorRequest.onsuccess</span> = (event) =&gt; {
    const <span class="hljs-attr">cursor</span> = event.target.result<span class="hljs-comment">;</span>
    if (cursor) {
      if (<span class="hljs-attr">cursor.value.status</span> === <span class="hljs-number">0</span>) {
        cursor.delete()<span class="hljs-comment">; // åˆ é™¤å½“å‰æ¸¸æ ‡æŒ‡å‘çš„æ•°æ®</span>
      }
      cursor.continue()<span class="hljs-comment">;</span>
    }
  }<span class="hljs-comment">;</span>
  
  <span class="hljs-attr">transaction.oncomplete</span> = () =&gt; {
    console.log('æ•°æ®åˆ é™¤æˆåŠŸ')<span class="hljs-comment">;</span>
    db.close()<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<h5 data-id="heading-12">ï¼ˆ6ï¼‰æ¸…ç©ºè¡¨ä¸åˆ é™¤æ•°æ®åº“ï¼ˆè¡¥å……ï¼‰</h5>
<pre><code class="hljs language-ini" lang="ini">// 1. æ¸…ç©ºè¡¨æ•°æ®
<span class="hljs-attr">request.onsuccess</span> = (event) =&gt; {
  const <span class="hljs-attr">db</span> = event.target.result<span class="hljs-comment">;</span>
  const <span class="hljs-attr">transaction</span> = db.transaction([<span class="hljs-string">'cameraDevice'</span>], <span class="hljs-string">'readwrite'</span>)<span class="hljs-comment">;</span>
  const <span class="hljs-attr">cameraStore</span> = transaction.objectStore(<span class="hljs-string">'cameraDevice'</span>)<span class="hljs-comment">;</span>
  
  cameraStore.clear()<span class="hljs-comment">; // æ¸…ç©ºè¡¨</span>
  
  <span class="hljs-attr">transaction.oncomplete</span> = () =&gt; {
    console.log('è¡¨æ•°æ®æ¸…ç©ºæˆåŠŸ')<span class="hljs-comment">;</span>
    db.close()<span class="hljs-comment">;</span>
  }<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

// 2. åˆ é™¤æ•°æ®åº“ï¼ˆéœ€å…ˆå…³é—­æ‰€æœ‰è¿æ¥ï¼‰
const <span class="hljs-attr">deleteRequest</span> = indexedDB.deleteDatabase(<span class="hljs-string">'deviceDB'</span>)<span class="hljs-comment">;</span>
<span class="hljs-attr">deleteRequest.onsuccess</span> = () =&gt; {
  console.log('æ•°æ®åº“åˆ é™¤æˆåŠŸ')<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
<span class="hljs-attr">deleteRequest.onerror</span> = (event) =&gt; {
  console.error('æ•°æ®åº“åˆ é™¤å¤±è´¥ï¼š', event.target.error.message)<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-13">å››ã€IndexedDB å°è£…ï¼ˆä¼˜åŒ–å¥å£®æ€§ä¸æ˜“ç”¨æ€§ï¼‰</h3>
<p>åŸºç¡€ç”¨æ³•å­˜åœ¨ä»£ç å†—ä½™ã€é”™è¯¯å¤„ç†ç¹çç­‰é—®é¢˜ï¼Œä¸‹é¢å°è£…ä¸€ä¸ªé€šç”¨çš„ IndexedDB å·¥å…·ç±»ï¼Œæ”¯æŒ Promise é“¾å¼è°ƒç”¨ï¼Œç®€åŒ–å¼€å‘ï¼š</p>
<h4 data-id="heading-14">å°è£…åçš„ IndexedDB å·¥å…·ç±»ï¼ˆindexedDB.jsï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * IndexedDB å·¥å…·ç±»ï¼ˆä¼˜åŒ–ç‰ˆï¼‰
 * æ”¯æŒ Promise é“¾å¼è°ƒç”¨ã€è‡ªåŠ¨å…¼å®¹ã€äº‹åŠ¡ç®¡ç†ã€å®Œæ•´ API
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">IndexedDB</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">dbName, dbVersion = <span class="hljs-number">1</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dbName</span> = dbName;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dbVersion</span> = dbVersion;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span> = <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ•°æ®åº“å®ä¾‹</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">supported</span> = !!<span class="hljs-variable language_">window</span>.<span class="hljs-property">indexedDB</span>; <span class="hljs-comment">// æ£€æµ‹æµè§ˆå™¨æ”¯æŒ</span>
    
    <span class="hljs-comment">// å…¼å®¹å‰ç¼€</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">indexedDB</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">indexedDB</span> ||
                    <span class="hljs-variable language_">window</span>.<span class="hljs-property">webkitIndexedDB</span> ||
                    <span class="hljs-variable language_">window</span>.<span class="hljs-property">mozIndexedDB</span> ||
                    <span class="hljs-variable language_">window</span>.<span class="hljs-property">msIndexedDB</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">IDBTransaction</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">IDBTransaction</span> ||
                          <span class="hljs-variable language_">window</span>.<span class="hljs-property">webkitIDBTransaction</span> ||
                          <span class="hljs-variable language_">window</span>.<span class="hljs-property">mozIDBTransaction</span>;
  }

  <span class="hljs-comment">/**
   * åˆå§‹åŒ–æ•°æ®åº“ï¼ˆåˆ›å»ºè¡¨ã€ç´¢å¼•ï¼‰
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array</span>} tableConfigs è¡¨é…ç½®ï¼š[{ tableName, keyPath, autoIncrement, indexList }]
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise</span>}
   */</span>
  <span class="hljs-title function_">init</span>(<span class="hljs-params">tableConfigs = []</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">supported</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'å½“å‰æµè§ˆå™¨ä¸æ”¯æŒ IndexedDB'</span>));
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> request = <span class="hljs-variable language_">this</span>.<span class="hljs-property">indexedDB</span>.<span class="hljs-title function_">open</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dbName</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">dbVersion</span>);

      <span class="hljs-comment">// æ•°æ®åº“æ‰“å¼€æˆåŠŸ</span>
      request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span> = event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ•°æ®åº“ <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.dbName}</span> æ‰“å¼€æˆåŠŸï¼Œç‰ˆæœ¬å·ï¼š<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.db.version}</span>`</span>);
        <span class="hljs-title function_">resolve</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>);
      };

      <span class="hljs-comment">// æ•°æ®åº“æ‰“å¼€å¤±è´¥</span>
      request.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
        <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`æ•°æ®åº“æ‰“å¼€å¤±è´¥ï¼š<span class="hljs-subst">${event.target.error.message}</span>`</span>));
      };

      <span class="hljs-comment">// æ•°æ®åº“åˆ›å»º/å‡çº§</span>
      request.<span class="hljs-property">onupgradeneeded</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> db = event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ•°æ®åº“å‡çº§ï¼šæ—§ç‰ˆæœ¬ <span class="hljs-subst">${event.oldVersion}</span> â†’ æ–°ç‰ˆæœ¬ <span class="hljs-subst">${event.newVersion}</span>`</span>);

        <span class="hljs-comment">// åˆ›å»ºè¡¨å’Œç´¢å¼•</span>
        tableConfigs.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">{ tableName, keyPath, autoIncrement = <span class="hljs-literal">false</span>, indexList = [] }</span>) =&gt;</span> {
          <span class="hljs-keyword">if</span> (!db.<span class="hljs-property">objectStoreNames</span>.<span class="hljs-title function_">contains</span>(tableName)) {
            <span class="hljs-comment">// é…ç½®ä¸»é”®</span>
            <span class="hljs-keyword">const</span> storeOptions = keyPath 
              ? { keyPath, autoIncrement } 
              : { <span class="hljs-attr">autoIncrement</span>: <span class="hljs-literal">true</span> }; <span class="hljs-comment">// æ—  keyPath æ—¶è‡ªåŠ¨ç”Ÿæˆä¸»é”® id</span>

            <span class="hljs-keyword">const</span> objectStore = db.<span class="hljs-title function_">createObjectStore</span>(tableName, storeOptions);

            <span class="hljs-comment">// åˆ›å»ºç´¢å¼•</span>
            indexList.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">{ indexName, propName, unique = <span class="hljs-literal">false</span> }</span>) =&gt;</span> {
              objectStore.<span class="hljs-title function_">createIndex</span>(indexName, propName, { unique });
            });

            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è¡¨ <span class="hljs-subst">${tableName}</span> åˆ›å»ºæˆåŠŸ`</span>);
          }
        });

        <span class="hljs-title function_">resolve</span>(db);
      };
    });
  }

  <span class="hljs-comment">/**
   * å¼€å¯äº‹åŠ¡
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">String|Array</span>} tableNames è¡¨åï¼ˆå•ä¸ªæˆ–å¤šä¸ªï¼‰
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} mode äº‹åŠ¡æ¨¡å¼ï¼šreadonly / readwrite
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Object</span>} objectStore å®ä¾‹
   */</span>
  <span class="hljs-title function_">_transaction</span>(<span class="hljs-params">tableNames, mode = <span class="hljs-string">'readonly'</span></span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æ•°æ®åº“æœªåˆå§‹åŒ–ï¼Œè¯·å…ˆè°ƒç”¨ init æ–¹æ³•'</span>);
    }

    <span class="hljs-keyword">const</span> transaction = <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>.<span class="hljs-title function_">transaction</span>(tableNames, mode);
    <span class="hljs-comment">// äº‹åŠ¡å¤±è´¥å¤„ç†</span>
    transaction.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`äº‹åŠ¡å¤±è´¥ï¼š<span class="hljs-subst">${event.target.error.message}</span>`</span>);
    };

    <span class="hljs-comment">// æ”¯æŒå•ä¸ªè¡¨åç›´æ¥è¿”å› objectStoreï¼Œå¤šä¸ªè¡¨åè¿”å›äº‹åŠ¡å®ä¾‹</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(tableNames) &amp;&amp; tableNames.<span class="hljs-property">length</span> &gt; <span class="hljs-number">1</span> 
      ? transaction 
      : transaction.<span class="hljs-title function_">objectStore</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(tableNames) ? tableNames[<span class="hljs-number">0</span>] : tableNames);
  }

  <span class="hljs-comment">/**
   * æ–°å¢æ•°æ®
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} tableName è¡¨å
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object|Array</span>} data å•ä¸ªæ•°æ®å¯¹è±¡æˆ–æ•°ç»„
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise</span>}
   */</span>
  <span class="hljs-title function_">add</span>(<span class="hljs-params">tableName, data</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> objectStore = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_transaction</span>(tableName, <span class="hljs-string">'readwrite'</span>);
        <span class="hljs-keyword">const</span> isBatch = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(data);

        <span class="hljs-comment">// æ‰¹é‡æ–°å¢</span>
        <span class="hljs-keyword">if</span> (isBatch) {
          data.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> objectStore.<span class="hljs-title function_">add</span>(item));
        } <span class="hljs-keyword">else</span> {
          objectStore.<span class="hljs-title function_">add</span>(data);
        }

        <span class="hljs-comment">// äº‹åŠ¡å®Œæˆ</span>
        objectStore.<span class="hljs-property">transaction</span>.<span class="hljs-property">oncomplete</span> = <span class="hljs-function">() =&gt;</span> {
          <span class="hljs-title function_">resolve</span>(isBatch ? <span class="hljs-string">`æ‰¹é‡æ–°å¢ <span class="hljs-subst">${data.length}</span> æ¡æ•°æ®æˆåŠŸ`</span> : <span class="hljs-string">'æ•°æ®æ–°å¢æˆåŠŸ'</span>);
        };

        <span class="hljs-comment">// äº‹åŠ¡å¤±è´¥</span>
        objectStore.<span class="hljs-property">transaction</span>.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
          <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`æ•°æ®æ–°å¢å¤±è´¥ï¼š<span class="hljs-subst">${event.target.error.message}</span>`</span>));
        };
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-title function_">reject</span>(error);
      }
    });
  }

  <span class="hljs-comment">/**
   * æŸ¥è¯¢æ•°æ®
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} tableName è¡¨å
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} options æŸ¥è¯¢é…ç½®ï¼š{ key, indexName, indexValue, cursorFilter }
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise</span>}
   */</span>
  <span class="hljs-title function_">get</span>(<span class="hljs-params">tableName, options = {}</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> objectStore = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_transaction</span>(tableName);
        <span class="hljs-keyword">const</span> { key, indexName, indexValue, cursorFilter } = options;
        <span class="hljs-keyword">let</span> request;

        <span class="hljs-comment">// 1. ä¸»é”®æŸ¥è¯¢</span>
        <span class="hljs-keyword">if</span> (key !== <span class="hljs-literal">undefined</span>) {
          request = objectStore.<span class="hljs-title function_">get</span>(key);
        }
        <span class="hljs-comment">// 2. ç´¢å¼•æŸ¥è¯¢</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (indexName &amp;&amp; indexValue !== <span class="hljs-literal">undefined</span>) {
          request = objectStore.<span class="hljs-title function_">index</span>(indexName).<span class="hljs-title function_">get</span>(indexValue);
        }
        <span class="hljs-comment">// 3. æ¸¸æ ‡æŸ¥è¯¢ï¼ˆæ”¯æŒç­›é€‰ï¼‰</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (cursorFilter &amp;&amp; <span class="hljs-keyword">typeof</span> cursorFilter === <span class="hljs-string">'function'</span>) {
          request = objectStore.<span class="hljs-title function_">openCursor</span>();
          <span class="hljs-keyword">const</span> result = [];

          request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
            <span class="hljs-keyword">const</span> cursor = event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>;
            <span class="hljs-keyword">if</span> (cursor) {
              <span class="hljs-keyword">if</span> (<span class="hljs-title function_">cursorFilter</span>(cursor.<span class="hljs-property">value</span>)) {
                result.<span class="hljs-title function_">push</span>(cursor.<span class="hljs-property">value</span>);
              }
              cursor.<span class="hljs-title function_">continue</span>();
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-title function_">resolve</span>(result);
            }
          };

          <span class="hljs-keyword">return</span>;
        }
        <span class="hljs-comment">// 4. å…¨é‡æŸ¥è¯¢</span>
        <span class="hljs-keyword">else</span> {
          request = objectStore.<span class="hljs-title function_">getAll</span>();
        }

        <span class="hljs-comment">// æ™®é€šæŸ¥è¯¢ç»“æœå¤„ç†</span>
        request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">() =&gt;</span> {
          <span class="hljs-title function_">resolve</span>(request.<span class="hljs-property">result</span>);
        };

        request.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
          <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`æ•°æ®æŸ¥è¯¢å¤±è´¥ï¼š<span class="hljs-subst">${event.target.error.message}</span>`</span>));
        };
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-title function_">reject</span>(error);
      }
    });
  }

  <span class="hljs-comment">/**
   * ä¿®æ”¹æ•°æ®
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} tableName è¡¨å
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Object</span>} data è¦ä¿®æ”¹çš„æ•°æ®ï¼ˆå¿…é¡»åŒ…å«ä¸»é”®ï¼‰
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise</span>}
   */</span>
  <span class="hljs-title function_">update</span>(<span class="hljs-params">tableName, data</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> objectStore = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_transaction</span>(tableName, <span class="hljs-string">'readwrite'</span>);
        <span class="hljs-keyword">const</span> request = objectStore.<span class="hljs-title function_">put</span>(data); <span class="hljs-comment">// å­˜åœ¨åˆ™æ›´æ–°ï¼Œä¸å­˜åœ¨åˆ™æ–°å¢</span>

        request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">() =&gt;</span> {
          <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æ•°æ®ä¿®æ”¹æˆåŠŸ'</span>);
        };

        request.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
          <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`æ•°æ®ä¿®æ”¹å¤±è´¥ï¼š<span class="hljs-subst">${event.target.error.message}</span>`</span>));
        };
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-title function_">reject</span>(error);
      }
    });
  }

  <span class="hljs-comment">/**
   * åˆ é™¤æ•°æ®
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} tableName è¡¨å
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">String|Number</span>} key ä¸»é”®å€¼
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise</span>}
   */</span>
  <span class="hljs-title function_">delete</span>(<span class="hljs-params">tableName, key</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> objectStore = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_transaction</span>(tableName, <span class="hljs-string">'readwrite'</span>);
        <span class="hljs-keyword">const</span> request = objectStore.<span class="hljs-title function_">delete</span>(key);

        request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">() =&gt;</span> {
          <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æ•°æ®åˆ é™¤æˆåŠŸ'</span>);
        };

        request.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
          <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`æ•°æ®åˆ é™¤å¤±è´¥ï¼š<span class="hljs-subst">${event.target.error.message}</span>`</span>));
        };
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-title function_">reject</span>(error);
      }
    });
  }

  <span class="hljs-comment">/**
   * æ¸…ç©ºè¡¨æ•°æ®
   * <span class="hljs-doctag">@param</span> {<span class="hljs-type">String</span>} tableName è¡¨å
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise</span>}
   */</span>
  <span class="hljs-title function_">clear</span>(<span class="hljs-params">tableName</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> objectStore = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_transaction</span>(tableName, <span class="hljs-string">'readwrite'</span>);
        <span class="hljs-keyword">const</span> request = objectStore.<span class="hljs-title function_">clear</span>();

        request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">() =&gt;</span> {
          <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'è¡¨æ•°æ®æ¸…ç©ºæˆåŠŸ'</span>);
        };

        request.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
          <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`è¡¨æ•°æ®æ¸…ç©ºå¤±è´¥ï¼š<span class="hljs-subst">${event.target.error.message}</span>`</span>));
        };
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-title function_">reject</span>(error);
      }
    });
  }

  <span class="hljs-comment">/**
   * åˆ é™¤æ•°æ®åº“
   * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Promise</span>}
   */</span>
  <span class="hljs-title function_">deleteDatabase</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>.<span class="hljs-title function_">close</span>(); <span class="hljs-comment">// å…ˆå…³é—­æ•°æ®åº“è¿æ¥</span>
      }

      <span class="hljs-keyword">const</span> request = <span class="hljs-variable language_">this</span>.<span class="hljs-property">indexedDB</span>.<span class="hljs-title function_">deleteDatabase</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dbName</span>);
      request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">resolve</span>(<span class="hljs-string">`æ•°æ®åº“ <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.dbName}</span> åˆ é™¤æˆåŠŸ`</span>);
      };
      request.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
        <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`æ•°æ®åº“åˆ é™¤å¤±è´¥ï¼š<span class="hljs-subst">${event.target.error.message}</span>`</span>));
      };
    });
  }

  <span class="hljs-comment">/**
   * å…³é—­æ•°æ®åº“è¿æ¥
   */</span>
  <span class="hljs-title function_">close</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>.<span class="hljs-title function_">close</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span> = <span class="hljs-literal">null</span>;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ•°æ®åº“ <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.dbName}</span> å·²å…³é—­`</span>);
    }
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">IndexedDB</span>;
</code></pre>
<h4 data-id="heading-15">å·¥å…·ç±»ä½¿ç”¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. åˆå§‹åŒ–æ•°æ®åº“</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">IndexedDB</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./indexedDB'</span>;

<span class="hljs-comment">// é…ç½®è¡¨ç»“æ„</span>
<span class="hljs-keyword">const</span> tableConfigs = [
  {
    <span class="hljs-attr">tableName</span>: <span class="hljs-string">'cameraDevice'</span>,
    <span class="hljs-attr">keyPath</span>: <span class="hljs-string">'deviceId'</span>, <span class="hljs-comment">// ä¸»é”®</span>
    <span class="hljs-attr">autoIncrement</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">indexList</span>: [
      { <span class="hljs-attr">indexName</span>: <span class="hljs-string">'idx_deviceName'</span>, <span class="hljs-attr">propName</span>: <span class="hljs-string">'deviceName'</span>, <span class="hljs-attr">unique</span>: <span class="hljs-literal">false</span> },
      { <span class="hljs-attr">indexName</span>: <span class="hljs-string">'idx_status'</span>, <span class="hljs-attr">propName</span>: <span class="hljs-string">'status'</span>, <span class="hljs-attr">unique</span>: <span class="hljs-literal">false</span> }
    ]
  },
  {
    <span class="hljs-attr">tableName</span>: <span class="hljs-string">'user'</span>,
    <span class="hljs-attr">autoIncrement</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// è‡ªåŠ¨ç”Ÿæˆä¸»é”® id</span>
    <span class="hljs-attr">indexList</span>: [
      { <span class="hljs-attr">indexName</span>: <span class="hljs-string">'idx_username'</span>, <span class="hljs-attr">propName</span>: <span class="hljs-string">'username'</span>, <span class="hljs-attr">unique</span>: <span class="hljs-literal">true</span> }
    ]
  }
];

<span class="hljs-comment">// åˆ›å»ºæ•°æ®åº“å®ä¾‹ï¼ˆæ•°æ®åº“åï¼šdeviceDBï¼Œç‰ˆæœ¬å·ï¼š2ï¼‰</span>
<span class="hljs-keyword">const</span> db = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IndexedDB</span>(<span class="hljs-string">'deviceDB'</span>, <span class="hljs-number">2</span>);

<span class="hljs-comment">// åˆå§‹åŒ–å¹¶æ“ä½œæ•°æ®</span>
db.<span class="hljs-title function_">init</span>(tableConfigs)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// 2. æ–°å¢æ•°æ®</span>
    <span class="hljs-keyword">return</span> db.<span class="hljs-title function_">add</span>(<span class="hljs-string">'cameraDevice'</span>, {
      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">'cam_1001'</span>,
      <span class="hljs-attr">deviceName</span>: <span class="hljs-string">'å¹¿å·å¤§æ¡¥æ‘„åƒå¤´'</span>,
      <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">resolution</span>: <span class="hljs-string">'4K'</span>,
      <span class="hljs-attr">createTime</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()
    });
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(msg);
    <span class="hljs-comment">// 3. æŸ¥è¯¢æ•°æ®ï¼ˆæ¸¸æ ‡ç­›é€‰åœ¨çº¿è®¾å¤‡ï¼‰</span>
    <span class="hljs-keyword">return</span> db.<span class="hljs-title function_">get</span>(<span class="hljs-string">'cameraDevice'</span>, {
      <span class="hljs-attr">cursorFilter</span>: <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.<span class="hljs-property">status</span> === <span class="hljs-number">1</span>
    });
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">onlineCameras</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åœ¨çº¿è®¾å¤‡ï¼š'</span>, onlineCameras);
    <span class="hljs-comment">// 4. ä¿®æ”¹æ•°æ®</span>
    <span class="hljs-keyword">return</span> db.<span class="hljs-title function_">update</span>(<span class="hljs-string">'cameraDevice'</span>, {
      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">'cam_1001'</span>,
      <span class="hljs-attr">deviceName</span>: <span class="hljs-string">'å¹¿å·å¤§æ¡¥æ‘„åƒå¤´'</span>,
      <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">resolution</span>: <span class="hljs-string">'8K'</span>, <span class="hljs-comment">// æ›´æ–°åˆ†è¾¨ç‡</span>
      <span class="hljs-attr">createTime</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()
    });
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(msg);
    <span class="hljs-comment">// 5. åˆ é™¤æ•°æ®</span>
    <span class="hljs-keyword">return</span> db.<span class="hljs-title function_">delete</span>(<span class="hljs-string">'cameraDevice'</span>, <span class="hljs-string">'cam_1001'</span>);
  })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(msg);
    <span class="hljs-comment">// 6. å…³é—­æ•°æ®åº“</span>
    db.<span class="hljs-title function_">close</span>();
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ“ä½œå¤±è´¥ï¼š'</span>, error.<span class="hljs-property">message</span>);
    db.<span class="hljs-title function_">close</span>();
  });
</code></pre>
<h3 data-id="heading-16">äº”ã€æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹ï¼ˆè¡¥å……å…³é”®ç»†èŠ‚ï¼‰</h3>
<ol>
<li>
<p><strong>ç‰ˆæœ¬å·ç®¡ç†</strong>ï¼šæ•°æ®åº“ç‰ˆæœ¬å·å¿…é¡»ä¸ºæ­£æ•´æ•°ï¼Œå‡çº§åæ— æ³•å›é€€ï¼Œä¿®æ”¹è¡¨ç»“æ„æ—¶éœ€é€’å¢ç‰ˆæœ¬å·ã€‚</p>
</li>
<li>
<p><strong>äº‹åŠ¡ç”Ÿå‘½å‘¨æœŸ</strong>ï¼šäº‹åŠ¡ä¼šåœ¨æ“ä½œå®Œæˆåè‡ªåŠ¨æäº¤ï¼Œè‹¥é•¿æ—¶é—´ä¸æ“ä½œï¼ˆå¦‚è¶…è¿‡ 5 ç§’ï¼‰ä¼šè¢«æµè§ˆå™¨ç»ˆæ­¢ï¼Œå»ºè®®æ“ä½œå®Œæˆåç«‹å³å…³é—­æ•°æ®åº“ã€‚</p>
</li>
<li>
<p><strong>é”™è¯¯å¤„ç†</strong>ï¼šæ‰€æœ‰æ“ä½œéƒ½éœ€æ•è·é”™è¯¯ï¼ˆå¦‚ä¸»é”®é‡å¤ã€æƒé™ä¸è¶³ã€å­˜å‚¨æ»¡ï¼‰ï¼Œé¿å…å½±å“é¡µé¢æ­£å¸¸è¿è¡Œã€‚</p>
</li>
<li>
<p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š</p>
<ol>
<li>æ‰¹é‡æ“ä½œæ—¶å°½é‡åˆå¹¶ä¸ºä¸€ä¸ªäº‹åŠ¡ï¼Œå‡å°‘äº‹åŠ¡åˆ›å»ºæ¬¡æ•°ã€‚</li>
<li>å¤§é‡æ•°æ®æŸ¥è¯¢ä½¿ç”¨æ¸¸æ ‡ï¼ˆCursorï¼‰ï¼Œé¿å…ä½¿ç”¨ <code>getAll()</code> å¯¼è‡´å†…å­˜å ç”¨è¿‡é«˜ã€‚</li>
<li>åˆç†åˆ›å»ºç´¢å¼•ï¼Œæå‡æŸ¥è¯¢æ•ˆç‡ï¼Œä½†é¿å…è¿‡å¤šç´¢å¼•ï¼ˆä¼šå½±å“æ–°å¢/ä¿®æ”¹æ€§èƒ½ï¼‰ã€‚</li>
</ol>
</li>
<li>
<p><strong>æ•°æ®åºåˆ—åŒ–</strong>ï¼šè™½ç„¶ IndexedDB æ”¯æŒå­˜å‚¨å¯¹è±¡ï¼Œä½†å¤æ‚å¯¹è±¡ï¼ˆå¦‚å‡½æ•°ã€å¾ªç¯å¼•ç”¨å¯¹è±¡ï¼‰æ— æ³•å­˜å‚¨ï¼Œéœ€æå‰åºåˆ—åŒ–ï¼ˆå¦‚ <code>JSON.stringify</code>ï¼‰ã€‚</p>
</li>
<li>
<p><strong>æµè§ˆå™¨å…¼å®¹æ€§</strong>ï¼šä¸»æµæµè§ˆå™¨ï¼ˆChromeã€Firefoxã€Edgeã€Safari 10.1+ï¼‰å‡æ”¯æŒ IndexedDBï¼Œå¦‚éœ€å…¼å®¹æ—§æµè§ˆå™¨ï¼ˆå¦‚ IE9-ï¼‰ï¼Œéœ€ä½¿ç”¨ <code>localForage</code> ç­‰å…¼å®¹åº“ã€‚</p>
</li>
<li>
<p><strong>å®‰å…¨é™åˆ¶</strong>ï¼šIndexedDB å—åŒæºç­–ç•¥é™åˆ¶ï¼Œä¸åŒåŸŸåæ— æ³•è®¿é—®å½¼æ­¤çš„æ•°æ®åº“ï¼›æœ¬åœ°æ–‡ä»¶ï¼ˆ<code>file://</code> åè®®ï¼‰æ— æ³•ä½¿ç”¨ IndexedDBï¼Œéœ€é€šè¿‡æœåŠ¡å™¨ï¼ˆ<code>http://</code>/<code>https://</code>ï¼‰è®¿é—®ã€‚</p>
</li>
</ol>
<h3 data-id="heading-17">å…­ã€æ€»ç»“</h3>
<p>IndexedDB ä½œä¸ºå‰ç«¯é«˜æ€§èƒ½æœ¬åœ°æ•°æ®åº“ï¼Œé€‚ç”¨äºéœ€è¦å­˜å‚¨å¤§é‡ç»“æ„åŒ–æ•°æ®ã€å®ç°ç¦»çº¿åŠŸèƒ½çš„åœºæ™¯ï¼ˆå¦‚ç¦»çº¿åº”ç”¨ã€æ•°æ®ç¼“å­˜ã€æœ¬åœ°æ—¥å¿—å­˜å‚¨ç­‰ï¼‰ã€‚æœ¬æ–‡ä»å­˜å‚¨æ–¹æ¡ˆå¯¹æ¯”ã€æ ¸å¿ƒæ¦‚å¿µã€åŸºç¡€ç”¨æ³•ã€å®Œæ•´å°è£…åˆ°æœ€ä½³å®è·µï¼Œå…¨é¢è¦†ç›–äº† IndexedDB çš„å…³é”®çŸ¥è¯†ç‚¹ï¼Œå¼¥è¡¥äº†åŸºç¡€ç”¨æ³•çš„é—æ¼ï¼ˆå¦‚æ¸¸æ ‡æŸ¥è¯¢ã€æ‰¹é‡æ“ä½œã€é”™è¯¯å¤„ç†ï¼‰ï¼Œå°è£…çš„å·¥å…·ç±»ç®€åŒ–äº†å¼€å‘æµç¨‹ï¼Œæå‡äº†ä»£ç å¤ç”¨æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScriptä¸­thisæŒ‡å‘æœºåˆ¶ä¸å¼‚æ­¥å›è°ƒè§£å†³æ–¹æ¡ˆè¯¦è§£]]></title>    <link>https://juejin.cn/post/7585171571129679908</link>    <guid>https://juejin.cn/post/7585171571129679908</guid>    <pubDate>2025-12-19T09:02:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585171571129679908" data-draft-id="7585171571129499684" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScriptä¸­thisæŒ‡å‘æœºåˆ¶ä¸å¼‚æ­¥å›è°ƒè§£å†³æ–¹æ¡ˆè¯¦è§£"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,ä»£ç è§„èŒƒ"/> <meta itemprop="datePublished" content="2025-12-19T09:02:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="UIUV"/> <meta itemprop="url" content="https://juejin.cn/user/1036168457093483"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScriptä¸­thisæŒ‡å‘æœºåˆ¶ä¸å¼‚æ­¥å›è°ƒè§£å†³æ–¹æ¡ˆè¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1036168457093483/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    UIUV
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T09:02:13.000Z" title="Fri Dec 19 2025 09:02:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    14
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">JavaScriptä¸­thisæŒ‡å‘æœºåˆ¶ä¸å¼‚æ­¥å›è°ƒè§£å†³æ–¹æ¡ˆè¯¦è§£</h2>
<p><strong>JavaScriptä¸­çš„thisæŒ‡å‘æ˜¯ä¸€ä¸ªåŠ¨æ€ç»‘å®šçš„æœºåˆ¶ï¼Œè€Œéé™æ€ç¡®å®š</strong>ã€‚å®ƒä¼šæ ¹æ®å‡½æ•°çš„è°ƒç”¨æ–¹å¼åœ¨è¿è¡Œæ—¶åŠ¨æ€å˜åŒ–ï¼Œè¿™ä½¿å¾—åœ¨å¼‚æ­¥å›è°ƒå‡½æ•°ä¸­ä¿æŒæ­£ç¡®çš„thisæŒ‡å‘å˜å¾—å°¤ä¸ºé‡è¦ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨thisçš„å››ç§ç»‘å®šè§„åˆ™ï¼Œåˆ†æå¼‚æ­¥å›è°ƒä¸­thisæŒ‡å‘ä¸¢å¤±çš„åŸå› ï¼Œå¹¶æä¾›ä¸‰ç§æœ‰æ•ˆè§£å†³æ–¹æ¡ˆã€‚åŒæ—¶ï¼Œæœ¬æ–‡è¿˜ä¼šè§£é‡Šreturn function()ä¸ºä»€ä¹ˆä¼šå¼‚æ­¥æ‰§è¡Œï¼Œå¸®åŠ©è¯»è€…å…¨é¢ç†è§£JavaScriptçš„äº‹ä»¶å¾ªç¯æœºåˆ¶ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€thisçš„åŸºæœ¬æ¦‚å¿µä¸å››ç§ç»‘å®šè§„åˆ™</h3>
<p>thisæ˜¯JavaScriptä¸­æœ€ç‰¹æ®Šä¸”æœ€ä»¤äººå›°æƒ‘çš„å…³é”®è¯ä¹‹ä¸€ã€‚å®ƒä»£è¡¨å‡½æ•°è¢«è°ƒç”¨æ—¶çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå³"è°è°ƒç”¨äº†è¿™ä¸ªå‡½æ•°"ã€‚<strong>thisçš„æŒ‡å‘ä¸æ˜¯åœ¨å‡½æ•°å®šä¹‰æ—¶ç¡®å®šçš„ï¼Œè€Œæ˜¯åœ¨å‡½æ•°è°ƒç”¨æ—¶åŠ¨æ€ç¡®å®šçš„</strong>  ã€‚ç†è§£è¿™ä¸€ç‚¹æ˜¯æŒæ¡thisæœºåˆ¶çš„å…³é”®ã€‚æ ¹æ®è°ƒç”¨æ–¹å¼çš„ä¸åŒï¼Œthisçš„ç»‘å®šéµå¾ªå››ç§è§„åˆ™ï¼ŒæŒ‰ä¼˜å…ˆçº§ä»é«˜åˆ°ä½æ’åˆ—ä¸ºï¼šnewç»‘å®šã€æ˜¾å¼ç»‘å®šã€éšå¼ç»‘å®šå’Œé»˜è®¤ç»‘å®š  ã€‚</p>
<p>newç»‘å®šå‘ç”Ÿåœ¨ä½¿ç”¨newå…³é”®å­—è°ƒç”¨æ„é€ å‡½æ•°æ—¶ã€‚æ­¤æ—¶ï¼ŒthisæŒ‡å‘æ–°åˆ›å»ºçš„å®ä¾‹å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">User</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">greet</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>);
    };
}
<span class="hljs-keyword">const</span> alice = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">"Alice"</span>);
alice.<span class="hljs-title function_">greet</span>(); <span class="hljs-comment">// è¾“å‡º: Hello, I'm Alice</span>
</code></pre>
<p>æ˜¾å¼ç»‘å®šé€šè¿‡callã€applyæˆ–bindæ–¹æ³•å¼ºåˆ¶æŒ‡å®šthisçš„å€¼ã€‚callå’Œapplyä¼šç«‹å³æ‰§è¡Œå‡½æ•°å¹¶æŒ‡å®šthisï¼Œè€Œbindä¼šè¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼Œthisè¢«æ°¸ä¹…ç»‘å®š  ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> person = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span> };
<span class="hljs-keyword">function</span> <span class="hljs-title function_">introduce</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`My name is <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>);
}
introduce.<span class="hljs-title function_">call</span>(person); <span class="hljs-comment">// ç«‹å³æ‰§è¡Œï¼Œè¾“å‡º: My name is Bob</span>
introduce.<span class="hljs-title function_">apply</span>(person); <span class="hljs-comment">// åŒä¸Š</span>
<span class="hljs-keyword">const</span> boundIntroduce = introduce.<span class="hljs-title function_">bind</span>(person); <span class="hljs-comment">// è¿”å›æ–°å‡½æ•°</span>
<span class="hljs-title function_">boundIntroduce</span>(); <span class="hljs-comment">// è¾“å‡º: My name is Bob</span>
</code></pre>
<p>éšå¼ç»‘å®šå‘ç”Ÿåœ¨å‡½æ•°ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨æ—¶ã€‚æ­¤æ—¶ï¼ŒthisæŒ‡å‘è°ƒç”¨è¯¥æ–¹æ³•çš„å¯¹è±¡  ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> user = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Charlie"</span>,
    <span class="hljs-attr">greet</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>!`</span>);
    }
};
user.<span class="hljs-title function_">greet</span>(); <span class="hljs-comment">// è¾“å‡º: Hello, Charlie!</span>
</code></pre>
<p>é»˜è®¤ç»‘å®šé€‚ç”¨äºç‹¬ç«‹å‡½æ•°è°ƒç”¨çš„æƒ…å†µã€‚åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼ŒthisæŒ‡å‘å…¨å±€å¯¹è±¡ï¼ˆå¦‚æµè§ˆå™¨ä¸­çš„windowï¼‰ï¼›åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼ŒthisæŒ‡å‘undefined  ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">showThis</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// éä¸¥æ ¼æ¨¡å¼ä¸‹æŒ‡å‘windowï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹æŒ‡å‘undefined</span>
}
<span class="hljs-title function_">showThis</span>(); <span class="hljs-comment">// è¾“å‡º: Window { ... }</span>
</code></pre>
<p><strong>è¿™å››ç§ç»‘å®šè§„åˆ™çš„ä¼˜å…ˆçº§é¡ºåºéå¸¸é‡è¦</strong>ï¼šnewç»‘å®š &gt; æ˜¾å¼ç»‘å®š &gt; éšå¼ç»‘å®š &gt; é»˜è®¤ç»‘å®š  ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œç†è§£å¹¶åº”ç”¨è¿™ä¸€ä¼˜å…ˆçº§é¡ºåºå¯ä»¥é¿å…è®¸å¤šthisæŒ‡å‘çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-2">äºŒã€å¼‚æ­¥å›è°ƒä¸­thisæŒ‡å‘ä¸¢å¤±çš„åŸå› </h3>
<p>åœ¨å¼‚æ­¥å›è°ƒå‡½æ•°ï¼ˆå¦‚setTimeoutã€äº‹ä»¶ç›‘å¬å™¨ç­‰ï¼‰ä¸­ï¼ŒthisæŒ‡å‘ä¸¢å¤±æ˜¯ä¸€ä¸ªå¸¸è§é—®é¢˜ã€‚è¦ç†è§£è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æ·±å…¥åˆ†æJavaScriptçš„æ‰§è¡Œæœºåˆ¶å’Œäº‹ä»¶å¾ªç¯ã€‚</p>
<p><strong>å¼‚æ­¥å›è°ƒå‡½æ•°çš„æ‰§è¡Œæ—¶æœºä¸åŒæ­¥ä»£ç ä¸åŒ</strong>ã€‚å½“è°ƒç”¨setTimeoutæ—¶ï¼ŒJavaScriptå¼•æ“ä¼šç«‹å³æ³¨å†Œä¸€ä¸ªå®šæ—¶å™¨ï¼Œå¹¶å°†æ§åˆ¶æƒäº¤è¿˜ç»™ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œåç»­çš„åŒæ­¥ä»£ç ã€‚<strong>å½“æŒ‡å®šçš„æ—¶é—´åˆ°æœŸåï¼Œå›è°ƒå‡½æ•°ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯è¢«æ”¾å…¥ä»»åŠ¡é˜Ÿåˆ—ä¸­ç­‰å¾…</strong>  ã€‚åªæœ‰å½“å‰æ‰€æœ‰åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œä¸»çº¿ç¨‹ç©ºé—²æ—¶ï¼Œäº‹ä»¶å¾ªç¯æ‰ä¼šä»ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºå›è°ƒå‡½æ•°å¹¶æ‰§è¡Œã€‚</p>
<p>å¦‚ä»¥ä¸‹çš„ä»£ç ç¤ºä¾‹ä¸­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">a.<span class="hljs-property">fcnc2</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// è°ƒç”¨æ—¶ï¼ŒthisæŒ‡å‘a</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// thisæŒ‡å‘windowæˆ–undefined</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);
    }, <span class="hljs-number">3000</span>);
};
</code></pre>
<p>å½“è°ƒç”¨<code>a.fcnc2()</code>æ—¶ï¼Œ<code>fcnc2</code>æ–¹æ³•çš„thisç¡®å®æŒ‡å‘å¯¹è±¡aï¼Œå› æ­¤ç¬¬ä¸€ä¸ª<code>console.log(this)</code>ä¼šæ­£ç¡®è¾“å‡ºå¯¹è±¡aã€‚ç„¶è€Œï¼Œ<code>setTimeout</code>çš„å›è°ƒå‡½æ•°æ˜¯åœ¨3ç§’åä½œä¸ºç‹¬ç«‹å‡½æ•°è°ƒç”¨çš„ï¼Œå› æ­¤è§¦å‘é»˜è®¤ç»‘å®šè§„åˆ™ã€‚åœ¨éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå›è°ƒå‡½æ•°çš„thisæŒ‡å‘å…¨å±€å¯¹è±¡windowï¼›åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼ŒthisæŒ‡å‘undefined  ã€‚</p>
<p><strong>thisçš„åŠ¨æ€ç»‘å®šç‰¹æ€§æ˜¯å¯¼è‡´å¼‚æ­¥å›è°ƒä¸­thisä¸¢å¤±çš„æ ¹æœ¬åŸå› </strong>ã€‚å½“å›è°ƒå‡½æ•°è¢«å»¶è¿Ÿæ‰§è¡Œæ—¶ï¼Œå®ƒä¸å†ä¸åŸå¯¹è±¡aæœ‰éšå¼è°ƒç”¨å…³ç³»ï¼Œè€Œæ˜¯è¢«å…¨å±€ç¯å¢ƒï¼ˆæˆ–ä¸¥æ ¼æ¨¡å¼ä¸‹çš„undefinedï¼‰è°ƒç”¨ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå³ä½¿å›è°ƒå‡½æ•°æ˜¯åœ¨å¯¹è±¡açš„æ–¹æ³•å†…éƒ¨å®šä¹‰çš„ï¼Œå…¶thisä¹Ÿä¸ä¼šè‡ªåŠ¨æŒ‡å‘aã€‚</p>
<h3 data-id="heading-3">ä¸‰ã€è§£å†³æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨thatå˜é‡ä¿å­˜å¤–å±‚this</h3>
<p>æœ€ç®€å•ä¸”å…¼å®¹æ€§æœ€å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ä¸€ä¸ªå˜é‡ï¼ˆå¦‚thatæˆ–selfï¼‰æ¥ä¿å­˜å¤–å±‚å‡½æ•°çš„thisæŒ‡å‘ï¼Œç„¶ååœ¨å›è°ƒå‡½æ•°ä¸­ä½¿ç”¨è¿™ä¸ªå˜é‡  ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">a.<span class="hljs-property">fcnc2</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> that = <span class="hljs-variable language_">this</span>; <span class="hljs-comment">// ä¿å­˜å¤–å±‚this</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(that.<span class="hljs-property">name</span>); <span class="hljs-comment">// ä½¿ç”¨ä¿å­˜çš„thatå˜é‡</span>
    }, <span class="hljs-number">3000</span>);
};
</code></pre>
<p><strong>è¿™ç§æ–¹æ³•åˆ©ç”¨äº†é—­åŒ…ç‰¹æ€§</strong>  ã€‚é—­åŒ…å…è®¸å‡½æ•°è®¿é—®å…¶è¯æ³•ä½œç”¨åŸŸä¸­çš„å˜é‡ï¼Œå³ä½¿å‡½æ•°æ˜¯åœ¨è¯æ³•ä½œç”¨åŸŸå¤–æ‰§è¡Œçš„ã€‚å› æ­¤ï¼Œå³ä½¿å›è°ƒå‡½æ•°åœ¨3ç§’åæ‰§è¡Œï¼Œå®ƒä»ç„¶å¯ä»¥è®¿é—®åˆ°å¤–å±‚å‡½æ•°ä¸­å®šä¹‰çš„thatå˜é‡ï¼Œä»è€Œè·å–æ­£ç¡®çš„thisæŒ‡å‘ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šå…¼å®¹æ€§å¥½ï¼Œé€‚ç”¨äºæ‰€æœ‰JavaScriptç¯å¢ƒï¼›å®ç°ç®€å•ç›´è§‚ï¼Œå³ä½¿åœ¨ä¸æ”¯æŒES6ç‰¹æ€§çš„æ—§æµè§ˆå™¨ä¸­ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œ  ã€‚</p>
<p><strong>ç¼ºç‚¹</strong>ï¼šä»£ç ä¸­ä¼šå‡ºç°å¤§é‡thatæˆ–selfå˜é‡ï¼Œå½±å“ä»£ç æ•´æ´åº¦ï¼›éœ€è¦å¼€å‘è€…æ‰‹åŠ¨ä¿å­˜thisï¼Œå®¹æ˜“å¿˜è®°æˆ–å‡ºé”™  ï¼›æ— æ³•å¤„ç†æ·±å±‚åµŒå¥—çš„å›è°ƒå‡½æ•°ï¼Œå¯èƒ½å¯¼è‡´ä½œç”¨åŸŸé“¾è¿‡é•¿ã€‚</p>
<h3 data-id="heading-4">å››ã€è§£å†³æ–¹æ¡ˆäºŒï¼šä½¿ç”¨bindæ–¹æ³•æ˜¾å¼ç»‘å®šthis</h3>
<p>ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨FunctionåŸå‹ä¸Šçš„bindæ–¹æ³•ï¼Œå®ƒå…è®¸æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°ï¼Œå¹¶æ°¸ä¹…ç»‘å®šthisçš„å€¼  ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">a.<span class="hljs-property">fcnc2</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-built_in">setTimeout</span>(
        <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);
        }.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>), <span class="hljs-comment">// æ˜¾å¼ç»‘å®šthis</span>
        <span class="hljs-number">3000</span>
    );
};
</code></pre>
<p><strong>bindæ–¹æ³•è¿”å›ä¸€ä¸ªæ–°å‡½æ•°</strong>ï¼Œè¿™ä¸ªæ–°å‡½æ•°çš„thisè¢«æ°¸ä¹…ç»‘å®šä¸ºè°ƒç”¨bindæ—¶ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚ä¸callå’Œapplyä¸åŒï¼Œbindä¸ä¼šç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªå‡†å¤‡å¥½çš„å‡½æ•°ï¼Œå¯ä»¥åœ¨ä¹‹åçš„ä»»ä½•æ—¶é—´è°ƒç”¨  ã€‚</p>
<p>åœ¨ç”¨æˆ·æä¾›çš„ä»£ç ç¤ºä¾‹ä¸­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a.<span class="hljs-property">fcnc1</span>.<span class="hljs-title function_">call</span>(a)); <span class="hljs-comment">// ç«‹å³æ‰§è¡Œï¼ŒthisæŒ‡å‘a</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a.<span class="hljs-property">fcnc1</span>.<span class="hljs-title function_">bind</span>(a));  <span class="hljs-comment">// è¿”å›æ–°å‡½æ•°ï¼Œthisç»‘å®šä¸ºa</span>
<span class="hljs-keyword">const</span> fcnc1Bind = a.<span class="hljs-property">fcnc1</span>.<span class="hljs-title function_">bind</span>(a);
<span class="hljs-title function_">fcnc1Bind</span>(); <span class="hljs-comment">// æ­£ç¡®æ‰§è¡Œï¼ŒthisæŒ‡å‘a</span>
</code></pre>
<p><strong>callæ–¹æ³•ç«‹å³æ‰§è¡Œå‡½æ•°å¹¶æŒ‡å®šthis</strong>ï¼Œè€Œbindæ–¹æ³•è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼Œä¸ä¼šç«‹å³æ‰§è¡Œã€‚è¿™ä½¿å¾—bindç‰¹åˆ«é€‚åˆå¼‚æ­¥åœºæ™¯ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥å°†ç»‘å®šåçš„å‡½æ•°ä¼ é€’ç»™setTimeoutç­‰å¼‚æ­¥APIã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šæ˜¾å¼æ§åˆ¶thisæŒ‡å‘ï¼Œä»£ç æ„å›¾æ˜ç¡®ï¼›é€‚ç”¨äºéœ€è¦åŠ¨æ€ç»‘å®šä¸åŒthisçš„åœºæ™¯ï¼›ä¸ä¼šæ±¡æŸ“å¤–å±‚ä½œç”¨åŸŸã€‚</p>
<p><strong>ç¼ºç‚¹</strong>ï¼šéœ€è¦é¢å¤–è°ƒç”¨bindæ–¹æ³•ï¼Œå¢åŠ ä»£ç é‡ï¼›è¿”å›çš„æ–°å‡½æ•°æ˜¯å‡½æ•°çš„æµ…æ‹·è´ï¼Œå¯èƒ½å½±å“æ€§èƒ½ï¼›åœ¨æ—§æµè§ˆå™¨ä¸­å¯èƒ½éœ€è¦polyfillæ”¯æŒã€‚</p>
<h3 data-id="heading-5">äº”ã€è§£å†³æ–¹æ¡ˆä¸‰ï¼šä½¿ç”¨ç®­å¤´å‡½æ•°ç»§æ‰¿this</h3>
<p>ç¬¬ä¸‰ç§è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ES6çš„ç®­å¤´å‡½æ•°ï¼Œå®ƒæ²¡æœ‰è‡ªå·±çš„thisæŒ‡å‘ï¼Œè€Œæ˜¯ç»§æ‰¿è‡ªå¤–å±‚ä½œç”¨åŸŸ  ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">a.<span class="hljs-property">fcnc2</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// ç»§æ‰¿å¤–å±‚thisï¼ŒæŒ‡å‘a</span>
    }, <span class="hljs-number">3000</span>);
};
</code></pre>
<p><strong>ç®­å¤´å‡½æ•°çš„thisæ˜¯åœ¨å®šä¹‰æ—¶ç»‘å®šçš„ï¼Œè€Œéè¿è¡Œæ—¶</strong>  ã€‚è¿™æ„å‘³ç€ç®­å¤´å‡½æ•°ä¼šç»§æ‰¿å…¶è¯æ³•ä½œç”¨åŸŸï¼ˆå³å®šä¹‰æ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸï¼‰çš„thiså€¼ã€‚åœ¨ç”¨æˆ·æä¾›çš„ä»£ç ç¤ºä¾‹ä¸­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">func</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>);
};
<span class="hljs-title function_">func</span>(); <span class="hljs-comment">// è¾“å‡ºwindowï¼ˆéä¸¥æ ¼æ¨¡å¼ï¼‰</span>
<span class="hljs-keyword">new</span> <span class="hljs-title function_">func</span>(); <span class="hljs-comment">// æŠ¥é”™ï¼Œç®­å¤´å‡½æ•°ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°</span>
</code></pre>
<p><strong>ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„thiså’Œargumentså¯¹è±¡</strong>  ï¼Œè¿™ä½¿å¾—å®ƒä»¬æ— æ³•è¢«ç”¨ä½œæ„é€ å‡½æ•°ï¼Œä½†éå¸¸é€‚åˆç”¨äºéœ€è¦ä¿æŒthisæŒ‡å‘çš„å›è°ƒå‡½æ•°ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šä»£ç ç®€æ´ï¼Œæ— éœ€é¢å¤–å˜é‡æˆ–æ–¹æ³•ï¼›thisæŒ‡å‘åœ¨å®šä¹‰æ—¶ç¡®å®šï¼Œé¿å…è¿è¡Œæ—¶å˜åŒ–ï¼›ä¸ç°ä»£JavaScriptå¼€å‘å®è·µæ— ç¼è¡”æ¥ã€‚</p>
<p><strong>ç¼ºç‚¹</strong>ï¼šä¸å…¼å®¹æ—§æµè§ˆå™¨ï¼ˆå¦‚IE11åŠæ›´æ—©ç‰ˆæœ¬ï¼‰ï¼›æ— æ³•ä½œä¸ºæ„é€ å‡½æ•°ä½¿ç”¨ï¼›åœ¨æŸäº›éœ€è¦åŠ¨æ€thisç»‘å®šçš„åœºæ™¯ä¸­ä¸å¤Ÿçµæ´»ã€‚</p>
<h3 data-id="heading-6">å…­ã€ä¸‰ç§è§£å†³æ–¹æ¡ˆçš„å¯¹æ¯”ä¸é€‰æ‹©</h3>

































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>å…¼å®¹æ€§</th><th>ä»£ç ç®€æ´åº¦</th><th>thisç»‘å®šæ–¹å¼</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>thatå˜é‡</td><td>æå¥½ï¼ˆæ‰€æœ‰ç¯å¢ƒï¼‰</td><td>ä¸€èˆ¬ï¼ˆéœ€è¦é¢å¤–å˜é‡ï¼‰</td><td>è¿è¡Œæ—¶éšå¼ç»‘å®š</td><td>æ—§é¡¹ç›®ã€éœ€è¦å…¼å®¹æ—§ç¯å¢ƒ</td></tr><tr><td>bindæ–¹æ³•</td><td>è‰¯å¥½ï¼ˆES5åŠä»¥ä¸Šï¼‰</td><td>è¾ƒå¥½ï¼ˆéœ€è¦é¢å¤–è°ƒç”¨bindï¼‰</td><td>è¿è¡Œæ—¶æ˜¾å¼ç»‘å®š</td><td>éœ€è¦åŠ¨æ€ç»‘å®šthisçš„åœºæ™¯</td></tr><tr><td>ç®­å¤´å‡½æ•°</td><td>å·®ï¼ˆä»…ES6åŠä»¥ä¸Šï¼‰</td><td>ä¼˜ç§€ï¼ˆæ— éœ€é¢å¤–ä»£ç ï¼‰</td><td>å®šä¹‰æ—¶è¯æ³•ç»‘å®š</td><td>æ–°é¡¹ç›®ã€ç°ä»£JavaScriptç¯å¢ƒ</td></tr></tbody></table>
<p><strong>åœ¨å®é™…å¼€å‘ä¸­ï¼Œåº”æ ¹æ®é¡¹ç›®éœ€æ±‚å’Œç¯å¢ƒé€‰æ‹©åˆé€‚çš„è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>å¦‚æœé¡¹ç›®éœ€è¦æ”¯æŒæ—§æµè§ˆå™¨ï¼ˆå¦‚IE11ï¼‰ï¼Œåº”ä¼˜å…ˆè€ƒè™‘thatå˜é‡æˆ–bindæ–¹æ³•ã€‚</li>
<li>åœ¨ç°ä»£JavaScriptç¯å¢ƒä¸­ï¼Œç®­å¤´å‡½æ•°æ˜¯é¦–é€‰æ–¹æ¡ˆï¼Œå› ä¸ºå®ƒä»£ç ç®€æ´ä¸”é¿å…äº†thisæŒ‡å‘é—®é¢˜ã€‚</li>
<li>å¯¹äºéœ€è¦åŠ¨æ€ç»‘å®šä¸åŒthiså€¼çš„åœºæ™¯ï¼Œbindæ–¹æ³•æ›´ä¸ºçµæ´»ã€‚</li>
<li>åœ¨æ·±å±‚åµŒå¥—çš„å›è°ƒå‡½æ•°ä¸­ï¼Œç®­å¤´å‡½æ•°å¯ä»¥ç®€åŒ–thisçš„ä¼ é€’ï¼Œé¿å…ä½œç”¨åŸŸé“¾è¿‡é•¿çš„é—®é¢˜ã€‚</li>
</ol>
<h3 data-id="heading-7">ä¸ƒã€å¼‚æ­¥ç¼–ç¨‹ä¸­çš„thisæœ€ä½³å®è·µ</h3>
<p>åŸºäºå¯¹thisæŒ‡å‘æœºåˆ¶å’Œå¼‚æ­¥å›è°ƒé—®é¢˜çš„æ·±å…¥ç†è§£ï¼Œä»¥ä¸‹æ˜¯å¼‚æ­¥ç¼–ç¨‹ä¸­çš„thisæœ€ä½³å®è·µï¼š</p>
<p><strong>1. åœ¨ES6ç¯å¢ƒä¸­ä¼˜å…ˆä½¿ç”¨ç®­å¤´å‡½æ•°</strong></p>
<p>ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„thisï¼Œè€Œæ˜¯ç»§æ‰¿è‡ªå¤–å±‚ä½œç”¨åŸŸï¼Œè¿™ä½¿å¾—å®ƒä»¬åœ¨å¼‚æ­¥å›è°ƒä¸­ç‰¹åˆ«æœ‰ç”¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> user = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
    <span class="hljs-attr">greet</span>: <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>!`</span>); <span class="hljs-comment">// æ­£ç¡®è¾“å‡ºHello, Alice!</span>
        }, <span class="hljs-number">1000</span>);
    }
};
</code></pre>
<p><strong>2. ä½¿ç”¨bindæ–¹æ³•æ˜¾å¼ç»‘å®šthis</strong></p>
<p>å½“éœ€è¦åœ¨å¼‚æ­¥å›è°ƒä¸­ä½¿ç”¨æ™®é€šå‡½æ•°ï¼Œå¹¶ä¸”éœ€è¦ä¿æŒthisæŒ‡å‘æ—¶ï¼Œå¯ä»¥ä½¿ç”¨bindæ–¹æ³•ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> user = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>,
    <span class="hljs-attr">greet</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        <span class="hljs-built_in">setTimeout</span>(
            <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>!`</span>); <span class="hljs-comment">// æ­£ç¡®è¾“å‡ºHello, Bob!</span>
            }.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>),
            <span class="hljs-number">1000</span>
        );
    }
};
</code></pre>
<p><strong>3. ä½¿ç”¨thisä¿å­˜å˜é‡ï¼ˆå¦‚thatæˆ–selfï¼‰</strong></p>
<p>åœ¨ä¸æ”¯æŒES6çš„ç¯å¢ƒä¸­ï¼Œå¯ä»¥ä½¿ç”¨é—­åŒ…ä¿å­˜thisï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> user = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Charlie"</span>,
    <span class="hljs-attr">greet</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> that = <span class="hljs-variable language_">this</span>; <span class="hljs-comment">// ä¿å­˜thisåˆ°é—­åŒ…å˜é‡</span>
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${that.name}</span>!`</span>); <span class="hljs-comment">// æ­£ç¡®è¾“å‡ºHello, Charlie!</span>
        }, <span class="hljs-number">1000</span>);
    }
};
</code></pre>
<p><strong>4. é¿å…åœ¨å¼‚æ­¥å›è°ƒä¸­ä½¿ç”¨this</strong></p>
<p>å¦‚æœå¯èƒ½ï¼Œå°½é‡é¿å…åœ¨å¼‚æ­¥å›è°ƒä¸­ä¾èµ–thisï¼Œè€Œæ˜¯ä½¿ç”¨å‚æ•°ä¼ é€’æˆ–å¯¹è±¡è§£æ„ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> user = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Diana"</span>,
    <span class="hljs-attr">greet</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> name = <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>; <span class="hljs-comment">// ä½¿ç”¨å‚æ•°ä¼ é€’</span>
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${name}</span>!`</span>); <span class="hljs-comment">// æ­£ç¡®è¾“å‡ºHello, Diana!</span>
        }, <span class="hljs-number">1000</span>);
    }
};
</code></pre>
<p><strong>5. åœ¨ç±»æ–¹æ³•ä¸­ä½¿ç”¨ç®­å¤´å‡½æ•°æˆ–bind</strong></p>
<p>åœ¨ç±»æ–¹æ³•ä¸­ï¼Œå¯ä»¥é€šè¿‡æ„é€ å‡½æ•°ä½¿ç”¨bindæ¥ç»‘å®šthisï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
        <span class="hljs-comment">// æ˜¾å¼ç»‘å®šgreetæ–¹æ³•çš„this</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">greet</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">greet</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);
    }

    <span class="hljs-title function_">greet</span>(<span class="hljs-params"/>) {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>!`</span>); <span class="hljs-comment">// æ­£ç¡®è¾“å‡º</span>
        }, <span class="hljs-number">1000</span>);
    }
}
</code></pre>
<p>æˆ–è€…ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    }

    <span class="hljs-comment">// ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œthisç»‘å®šä¸ºæ„é€ å‡½æ•°ä¸­çš„this</span>
    greet = <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>!`</span>); <span class="hljs-comment">// æ­£ç¡®è¾“å‡º</span>
        }, <span class="hljs-number">1000</span>);
    };
}
</code></pre>
<h3 data-id="heading-8">å…«ã€äº‹ä»¶å¾ªç¯ä¸ä»»åŠ¡é˜Ÿåˆ—è¯¦è§£</h3>
<p>è¦æ·±å…¥ç†è§£å¼‚æ­¥å›è°ƒä¸­thisæŒ‡å‘ä¸¢å¤±çš„åŸå› ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£JavaScriptçš„äº‹ä»¶å¾ªç¯æœºåˆ¶å’Œä»»åŠ¡é˜Ÿåˆ—ç³»ç»Ÿã€‚</p>
<p><strong>JavaScriptå¼•æ“æ˜¯å•çº¿ç¨‹çš„</strong>  ï¼Œè¿™æ„å‘³ç€å®ƒä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ã€‚ä¸ºäº†å¤„ç†å¼‚æ­¥æ“ä½œï¼ˆå¦‚å®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬ã€ç½‘ç»œè¯·æ±‚ç­‰ï¼‰ï¼ŒJavaScriptä½¿ç”¨äº†äº‹ä»¶å¾ªç¯å’Œä»»åŠ¡é˜Ÿåˆ—æœºåˆ¶ã€‚</p>
<p><strong>äº‹ä»¶å¾ªç¯æ˜¯ä¸€ä¸ªæŒç»­è¿è¡Œçš„å¾ªç¯</strong>ï¼Œè´Ÿè´£å°†ä»»åŠ¡ä»é˜Ÿåˆ—ä¸­å–å‡ºå¹¶æ‰§è¡Œã€‚ä»»åŠ¡é˜Ÿåˆ—åˆ†ä¸ºä¸¤ç§ï¼šå¾®ä»»åŠ¡é˜Ÿåˆ—ï¼ˆMicrotask Queueï¼‰å’Œå®ä»»åŠ¡é˜Ÿåˆ—ï¼ˆMacrotask Queueï¼‰  ã€‚</p>
<p>å¾®ä»»åŠ¡é˜Ÿåˆ—åŒ…æ‹¬ï¼š</p>
<ul>
<li>Promiseçš„then/catchå›è°ƒ</li>
<li>MutationObserverå›è°ƒ</li>
<li>setImmediateï¼ˆNode.jsç¯å¢ƒï¼‰</li>
</ul>
<p>å®ä»»åŠ¡é˜Ÿåˆ—åŒ…æ‹¬ï¼š</p>
<ul>
<li>setTimeoutå›è°ƒ</li>
<li>setIntervalå›è°ƒ</li>
<li>I/Oæ“ä½œå›è°ƒ</li>
<li>DOMäº‹ä»¶å›è°ƒ</li>
</ul>
<p><strong>æ‰§è¡Œæµç¨‹å¦‚ä¸‹</strong>  ï¼š</p>
<ol>
<li>æ‰§è¡Œä¸»çº¿ç¨‹ä¸­çš„åŒæ­¥ä»£ç ã€‚</li>
<li>å½“é‡åˆ°å¼‚æ­¥æ“ä½œï¼ˆå¦‚setTimeoutï¼‰æ—¶ï¼Œæ³¨å†Œä»»åŠ¡å¹¶ç»§ç»­æ‰§è¡Œåç»­åŒæ­¥ä»£ç ã€‚</li>
<li>å½“æ‰€æœ‰åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œä¸»çº¿ç¨‹ç©ºé—²æ—¶ï¼Œäº‹ä»¶å¾ªç¯å¼€å§‹å¤„ç†ä»»åŠ¡é˜Ÿåˆ—ã€‚</li>
<li>ä¼˜å…ˆå¤„ç†å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ä»»åŠ¡ã€‚</li>
<li>ç„¶åå¤„ç†å®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªä»»åŠ¡ã€‚</li>
<li>é‡å¤è¿™ä¸€è¿‡ç¨‹ï¼Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡å¤„ç†å®Œæ¯•ã€‚</li>
</ol>
<p>åœ¨ç”¨æˆ·æä¾›çš„ä»£ç ç¤ºä¾‹ä¸­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">a.<span class="hljs-property">fcnc2</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// åŒæ­¥ä»£ç ï¼ŒthisæŒ‡å‘a</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// 3ç§’åä½œä¸ºå®ä»»åŠ¡æ‰§è¡Œï¼ŒthisæŒ‡å‘windowæˆ–undefined</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);
    }, <span class="hljs-number">3000</span>);
};
</code></pre>
<p>å½“è°ƒç”¨<code>a.fcnc2()</code>æ—¶ï¼Œå‡½æ•°å†…éƒ¨çš„åŒæ­¥ä»£ç ç«‹å³æ‰§è¡Œï¼Œæ­¤æ—¶thisæŒ‡å‘å¯¹è±¡aã€‚<code>setTimeout</code>æ³¨å†Œäº†ä¸€ä¸ªå»¶è¿Ÿ3ç§’çš„å®ä»»åŠ¡ï¼Œç„¶åç«‹å³è¿”å›ã€‚3ç§’åï¼Œäº‹ä»¶å¾ªç¯å°†å›è°ƒå‡½æ•°ä»å®ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºæ‰§è¡Œï¼Œæ­¤æ—¶å›è°ƒå‡½æ•°æ˜¯ä½œä¸ºç‹¬ç«‹å‡½æ•°è°ƒç”¨çš„ï¼Œå› æ­¤è§¦å‘é»˜è®¤ç»‘å®šè§„åˆ™ï¼ŒthisæŒ‡å‘å…¨å±€å¯¹è±¡æˆ–undefinedã€‚</p>
<p><strong>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨å¼‚æ­¥å›è°ƒä¸­thisæŒ‡å‘ä¼šä¸¢å¤±çš„æ ¹æœ¬åŸå› </strong>  ï¼šå›è°ƒå‡½æ•°æ˜¯åœ¨ä¸åŒçš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­è¢«è°ƒç”¨çš„ï¼Œå¤±å»äº†ä¸åŸå¯¹è±¡açš„éšå¼å…³è”ã€‚</p>
<h3 data-id="heading-9">ä¹ã€thisæŒ‡å‘é—®é¢˜çš„ç°ä»£è§£å†³æ–¹æ¡ˆ</h3>
<p>éšç€JavaScriptè¯­è¨€çš„å‘å±•å’Œå·¥å…·é“¾çš„è¿›æ­¥ï¼Œå¤„ç†thisæŒ‡å‘é—®é¢˜çš„æ–¹æ¡ˆä¹Ÿåœ¨ä¸æ–­æ¼”è¿›ã€‚</p>
<p><strong>1. ç®­å¤´å‡½æ•°çš„æ™®åŠ</strong></p>
<p>ES6å¼•å…¥çš„ç®­å¤´å‡½æ•°å·²ç»æˆä¸ºå¤„ç†thisæŒ‡å‘é—®é¢˜çš„é¦–é€‰æ–¹æ¡ˆã€‚ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„thisï¼Œè€Œæ˜¯ç»§æ‰¿è‡ªå¤–å±‚ä½œç”¨åŸŸï¼Œè¿™ä½¿å¾—å®ƒä»¬åœ¨å¼‚æ­¥å›è°ƒä¸­ç‰¹åˆ«æœ‰ç”¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> user = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Eve"</span>,
    <span class="hljs-attr">greet</span>: <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>!`</span>); <span class="hljs-comment">// æ­£ç¡®è¾“å‡º</span>
        }, <span class="hljs-number">1000</span>);
    }
};
</code></pre>
<p><strong>2. Class Propertiesçš„ä½¿ç”¨</strong></p>
<p>ES2015å¼•å…¥çš„Class Propertiesè¯­æ³•å…è®¸æˆ‘ä»¬åœ¨ç±»ä¸­ç›´æ¥å®šä¹‰ç®­å¤´å‡½æ•°å±æ€§ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
    name = <span class="hljs-string">"Frank"</span>;
    <span class="hljs-comment">// ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œthisç»‘å®šä¸ºå®ä¾‹</span>
    greet = <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>!`</span>); <span class="hljs-comment">// æ­£ç¡®è¾“å‡º</span>
        }, <span class="hljs-number">1000</span>);
    };
}
</code></pre>
<p><strong>3. ä½¿ç”¨thisä¿å­˜å˜é‡çš„æ”¹è¿›</strong></p>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä»ç„¶éœ€è¦ä½¿ç”¨thisä¿å­˜å˜é‡ï¼Œä½†å¯ä»¥é€šè¿‡æ›´ç°ä»£çš„æ–¹å¼å®ç°ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> user = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Grace"</span>,
    <span class="hljs-title function_">greet</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> { name } = <span class="hljs-variable language_">this</span>; <span class="hljs-comment">// ä½¿ç”¨å¯¹è±¡è§£æ„ä¿å­˜éœ€è¦çš„å€¼</span>
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${name}</span>!`</span>); <span class="hljs-comment">// æ­£ç¡®è¾“å‡º</span>
        }, <span class="hljs-number">1000</span>);
    }
};
</code></pre>
<p><strong>4. ä½¿ç”¨async/awaitå¤„ç†å¼‚æ­¥æ“ä½œ</strong></p>
<p>å¯¹äºå¤æ‚çš„å¼‚æ­¥æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨async/awaitè¯­æ³•ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> user = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Heidi"</span>,
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">greet</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">1000</span>));
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>!`</span>); <span class="hljs-comment">// æ­£ç¡®è¾“å‡º</span>
    }
};

<span class="hljs-comment">// ä½¿ç”¨æ—¶</span>
user.<span class="hljs-title function_">greet</span>(); <span class="hljs-comment">// æ³¨å†Œå¼‚æ­¥æ“ä½œ</span>
</code></pre>
<p><strong>5. ä½¿ç”¨ç°ä»£å·¥å…·é“¾ï¼ˆå¦‚Babelï¼‰</strong></p>
<p>å¯¹äºéœ€è¦æ”¯æŒæ—§ç¯å¢ƒçš„é¡¹ç›®ï¼Œå¯ä»¥ä½¿ç”¨Babelç­‰å·¥å…·å°†ç®­å¤´å‡½æ•°è½¬æ¢ä¸ºæ™®é€šå‡½æ•°ï¼Œå¹¶è‡ªåŠ¨ç»‘å®šthisï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Babelè½¬æ¢åçš„ä»£ç </span>
<span class="hljs-keyword">const</span> user = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Ivan"</span>,
    <span class="hljs-attr">greet</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">greet</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">var</span> _this = <span class="hljs-variable language_">this</span>;
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, <span class="hljs-subst">${_this.name}</span>!`</span>); <span class="hljs-comment">// æ­£ç¡®è¾“å‡º</span>
        }, <span class="hljs-number">1000</span>);
    }
};
</code></pre>
<h3 data-id="heading-10">åã€æ€»ç»“ä¸å®è·µå»ºè®®</h3>
<p><strong>JavaScriptä¸­çš„thisæŒ‡å‘æ˜¯ä¸€ä¸ªåŠ¨æ€ç»‘å®šçš„æœºåˆ¶ï¼Œç†è§£å¹¶æŒæ¡è¿™ä¸€æœºåˆ¶å¯¹äºå†™å‡ºå¯é çš„å¼‚æ­¥ä»£ç è‡³å…³é‡è¦</strong>  ã€‚åœ¨å¼‚æ­¥å›è°ƒä¸­ï¼ŒthisæŒ‡å‘ä¸¢å¤±æ˜¯ä¸€ä¸ªå¸¸è§é—®é¢˜ï¼Œä½†æœ‰å¤šç§æœ‰æ•ˆè§£å†³æ–¹æ¡ˆã€‚</p>
<p><strong>æœ€ä½³å®è·µæ€»ç»“</strong>ï¼š</p>
<ol>
<li>åœ¨ç°ä»£JavaScriptç¯å¢ƒä¸­ï¼Œä¼˜å…ˆä½¿ç”¨ç®­å¤´å‡½æ•°å¤„ç†å¼‚æ­¥å›è°ƒï¼Œå› ä¸ºå®ƒä»¬è‡ªåŠ¨ç»§æ‰¿å¤–å±‚thisã€‚</li>
<li>å¯¹äºéœ€è¦æ”¯æŒæ—§ç¯å¢ƒçš„é¡¹ç›®ï¼Œä½¿ç”¨bindæ–¹æ³•æ˜¾å¼ç»‘å®šthisï¼Œæˆ–ä½¿ç”¨thatå˜é‡ä¿å­˜å¤–å±‚thisã€‚</li>
<li>é¿å…åœ¨å¼‚æ­¥å›è°ƒä¸­è¿‡åº¦ä¾èµ–thisï¼Œå¯ä»¥é€šè¿‡å‚æ•°ä¼ é€’æˆ–å¯¹è±¡è§£æ„è·å–æ‰€éœ€æ•°æ®ã€‚</li>
<li>åœ¨ç±»æ–¹æ³•ä¸­ï¼Œå¯ä»¥é€šè¿‡æ„é€ å‡½æ•°ä½¿ç”¨bindæ˜¾å¼ç»‘å®šthisï¼Œæˆ–ä½¿ç”¨Class Propertieså®šä¹‰ç®­å¤´å‡½æ•°ã€‚</li>
<li>ç†è§£äº‹ä»¶å¾ªç¯å’Œä»»åŠ¡é˜Ÿåˆ—æœºåˆ¶ï¼Œæœ‰åŠ©äºæ›´å¥½åœ°æŠŠæ¡å¼‚æ­¥ä»£ç çš„æ‰§è¡Œæ—¶æœºå’Œthisçš„ç»‘å®šè§„åˆ™ã€‚</li>
</ol>
<p><strong>éšç€JavaScriptè¯­è¨€çš„å‘å±•å’Œå·¥å…·é“¾çš„è¿›æ­¥ï¼Œå¤„ç†thisæŒ‡å‘é—®é¢˜çš„æ–¹æ¡ˆä¹Ÿåœ¨ä¸æ–­å®Œå–„</strong>ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œåº”æ ¹æ®é¡¹ç›®éœ€æ±‚ã€ç›®æ ‡ç¯å¢ƒå’Œä¸ªäººåå¥½é€‰æ‹©åˆé€‚çš„è§£å†³æ–¹æ¡ˆã€‚æ— è®ºé€‰æ‹©å“ªç§æ–¹æ¡ˆï¼Œç†è§£thisçš„åŠ¨æ€ç»‘å®šæœºåˆ¶éƒ½æ˜¯å†™å‡ºå¯é å¼‚æ­¥ä»£ç çš„åŸºç¡€ã€‚</p>
<p><strong>å¼‚æ­¥ç¼–ç¨‹æ˜¯JavaScriptçš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€</strong>ï¼ŒæŒæ¡thisæŒ‡å‘çš„å¤„ç†æ–¹æ³•å°†å¤§å¤§æå‡ä»£ç çš„å¯é æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œå¸Œæœ›è¯»è€…èƒ½å¤Ÿæ·±å…¥ç†è§£JavaScriptä¸­thisçš„æŒ‡å‘æœºåˆ¶ï¼Œå¹¶åœ¨å®é™…å¼€å‘ä¸­æœ‰æ•ˆåº”ç”¨è¿™äº›è§£å†³æ–¹æ¡ˆã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[windowsç³»ç»Ÿä½¿ç”¨nvmé…ç½®è‡ªåŠ¨åˆ‡æ¢nodeç‰ˆæœ¬]]></title>    <link>https://juejin.cn/post/7585206349749043252</link>    <guid>https://juejin.cn/post/7585206349749043252</guid>    <pubDate>2025-12-19T09:24:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585206349749043252" data-draft-id="7585222924566315048" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="windowsç³»ç»Ÿä½¿ç”¨nvmé…ç½®è‡ªåŠ¨åˆ‡æ¢nodeç‰ˆæœ¬"/> <meta itemprop="keywords" content="Windows"/> <meta itemprop="datePublished" content="2025-12-19T09:24:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸èµ·çœ¼çš„å°è‰"/> <meta itemprop="url" content="https://juejin.cn/user/495201559254478"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            windowsç³»ç»Ÿä½¿ç”¨nvmé…ç½®è‡ªåŠ¨åˆ‡æ¢nodeç‰ˆæœ¬
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/495201559254478/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸èµ·çœ¼çš„å°è‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T09:24:18.000Z" title="Fri Dec 19 2025 09:24:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å½“å‰ç«¯åœ¨å¼€å‘ä¹…äº†ä¹‹åï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæœ‰å¾ˆå¤šä¸ªé¡¹ç›®å­˜åœ¨ï¼Œç„¶è€Œç”±äºnodeç‰ˆæœ¬çš„å…¼å®¹æ€§é—®é¢˜ï¼Œæˆ‘ä»¬ä¸åŒçš„é¡¹ç›®ä½¿ç”¨çš„node.jsç‰ˆæœ¬å®Œå…¨ä¸åŒã€‚</h2>
<h2 data-id="heading-1">è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æƒ³åˆ°ç”¨nvmæ¥åšç‰ˆæœ¬ç®¡ç†ï¼Œä½†æ˜¯å‘ç°æ¯æ¬¡éƒ½éœ€è¦ä½¿ç”¨nvm use "node.js --version"æ¥æ‰‹åŠ¨åˆ‡æ¢ï¼Œæœ‰æ²¡æœ‰æ–¹æ³•å¯ä»¥è®©nvmå¯¹äºä¸åŒé¡¹ç›®æŒ‡å®šä¸åŒç‰ˆæœ¬ï¼Œå¹¶ä¸”è‡ªåŠ¨åˆ‡æ¢ã€‚</h2>
<h3 data-id="heading-2">æˆ‘ç ”ç©¶äº†ä¸€ä¸‹åˆï¼Œæ‰¾åˆ°äº†é…ç½®çš„æ–¹æ³•ï¼Œé€šè¿‡æˆ‘ä»¬windowsçš„powerShellï¼Œç”¨å…¶å†…ç½®å‘½ä»¤å»é…ç½®æ‰§è¡Œç­–ç•¥ï¼Œæ‰§è¡Œæˆ‘ä»¬è‡ªå®šä¹‰çš„å‡½æ•°æ–¹æ³•ï¼Œè®©å®ƒè‡ªåŠ¨å®ç°åˆ‡æ¢ç‰ˆæœ¬</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// é¦–å…ˆï¼Œæˆ‘ä»¬å¯¹äºä¸åŒçš„é¡¹ç›®ï¼Œå¯ä»¥åœ¨powerShellä¸­cd "é¡¹ç›®è·¯å¾„"ï¼Œåœ¨é¡¹ç›®çš„æ ¹è·¯å¾„ä¸­æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤</span>
    echo <span class="hljs-string">"æ­¤é¡¹ç›®æŒ‡å®šçš„nodeç‰ˆæœ¬"</span> &gt; .<span class="hljs-property">nvmrc</span>
<span class="hljs-comment">// å®ƒä¼šåœ¨æˆ‘ä»¬çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª.nvmrcæ–‡ä»¶ï¼Œå…¶ä¸­å­˜æ”¾äº†æˆ‘ä»¬æŒ‡å®šçš„node.jsç‰ˆæœ¬</span>
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ç¬¬äºŒæ­¥ï¼šåœ¨powerShellä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</span>
    $PROFILE
<span class="hljs-comment">// ä¸ºäº†é˜²æ­¢ä¸åŒç”¨æˆ·ç”µè„‘è‡ªå®šä¹‰é…ç½®ä¸åŒè€Œå‡ºç°é”™è¯¯ï¼Œæ‰§è¡Œè¿™ä¸ªå‘½ä»¤æ‰¾åˆ°windowsè¯»å–é…ç½®çš„çœŸå®è·¯å¾„</span>
<span class="hljs-comment">// è¾“å‡ºç»“æœç±»ä¼¼   'D:\BaseInfoMove\æ–‡æ¡£\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'</span>

<span class="hljs-comment">// ç¬¬ä¸‰æ­¥ï¼šæœ‰ç‚¹åŒå­¦å¯èƒ½åƒæˆ‘ä¸€æ ·ï¼Œå› ä¸ºè‡ªå·±æ”¹åŠ¨çš„ç”µè„‘é…ç½®å¯¼è‡´è¯»å–ä½ç½®ä¸åœ¨é»˜è®¤Cç›˜ï¼Œå› æ­¤éœ€è¦åˆ›å»ºç›®æ ‡ç›®å½•æ–‡ä»¶</span>
<span class="hljs-title class_">New</span>-<span class="hljs-title class_">Item</span> -<span class="hljs-title class_">Path</span> <span class="hljs-string">"D:\BaseInfoMove\æ–‡æ¡£\WindowsPowerShell"</span> -<span class="hljs-title class_">ItemType</span> <span class="hljs-title class_">Directory</span> -<span class="hljs-title class_">Force</span>
<span class="hljs-comment">// æ‰§è¡Œè¿™è¡Œè„šæœ¬æ¥åˆ›å»ºç›®æ ‡æ–‡ä»¶ï¼Œ      æ³¨æ„ï¼šè‡ªå·±ç¬¬äºŒæ­¥è¾“å‡ºçš„è·¯å¾„ï¼Œä¸è¦ç¡¬æŠ„ï¼Œè¦ç”¨è‡ªå·±çš„ï¼ˆæœ€åçš„æ–‡ä»¶åä¸è¦ï¼‰</span>

<span class="hljs-comment">// ç¬¬å››æ­¥ï¼šä¸€æ¬¡æ€§åˆ›å»ºå¹¶å†™å…¥è„šæœ¬ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œä¸€æ¬¡æ€§å¤åˆ¶ï¼Œå¦‚æœæœ‰æç¤ºï¼Œç›´æ¥ç¡®å®šå³å¯</span>

@<span class="hljs-string">"
# Auto-load .nvmrc on directory change
function Enter-Directory {
    `$currentDir = Get-Location
    `$nvmrcPath = "</span><span class="hljs-string">`$currentDir\.nvmrc"
    
    if (Test-Path `</span>$nvmrcPath) {
        <span class="hljs-string">`$version = Get-Content `</span>$nvmrcPath -<span class="hljs-title class_">First</span> <span class="hljs-number">1</span> | <span class="hljs-title class_">Where</span>-<span class="hljs-title class_">Object</span> { <span class="hljs-string">`$_ -match '^\d' }
        if (`</span>$version) {
            <span class="hljs-title class_">Write</span>-<span class="hljs-title class_">Host</span> <span class="hljs-string">"ğŸ”„ Switching to Node.js `$version..."</span> -<span class="hljs-title class_">ForegroundColor</span> <span class="hljs-title class_">Cyan</span>
            nvm use <span class="hljs-string">`$version --silent
        }
    }
}

`</span>$lastDir = <span class="hljs-string">""</span>
<span class="hljs-title class_">Register</span>-<span class="hljs-title class_">EngineEvent</span> -<span class="hljs-title class_">SourceIdentifier</span> <span class="hljs-title class_">PowerShell</span>.<span class="hljs-property">OnIdle</span> -<span class="hljs-title class_">Action</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-string">`$lastDir -ne (Get-Location).Path) {
        `</span>$lastDir = (<span class="hljs-title class_">Get</span>-<span class="hljs-title class_">Location</span>).<span class="hljs-property">Path</span>
        <span class="hljs-title class_">Enter</span>-<span class="hljs-title class_">Directory</span>
    }
} | <span class="hljs-title class_">Out</span>-<span class="hljs-title class_">Null</span>

# <span class="hljs-title class_">Run</span> on startup
<span class="hljs-title class_">Enter</span>-<span class="hljs-title class_">Directory</span>
<span class="hljs-string">"@ | Set-Content -Path "</span>$PROFILE<span class="hljs-string">" -Encoding UTF8

// è¿™æ®µè„šæœ¬ä¼šè‡ªåŠ¨åˆ›å»ºåœ¨ç¬¬ä¸‰æ­¥åˆ›å»ºç›®æ ‡ç›®å½•æ—¶çœç•¥çš„æ–‡ä»¶ï¼Œå¹¶å†™å…¥æ‰§è¡Œè„šæœ¬


// æœ€åä¸€æ­¥ï¼šè®¾ç½®æ‰§è¡Œç­–ç•¥
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser -Force
// è¿™ä¸€æ­¥æ˜¯åœ¨æ›´æ”¹æˆ‘ä»¬windowsçš„powerShellçš„æ‰§è¡Œç­–ç•¥ï¼Œè®©å®ƒæ‰“å¼€çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œæˆ‘ä»¬çš„è„šæœ¬ï¼Œä»¥ç›‘å¬ç›®å½•å˜åŠ¨ï¼Œè‡ªåŠ¨æŸ¥è¯¢è¯»å–é¡¹ç›®ä¸­çš„.nvmrcé…ç½®æ–‡ä»¶ï¼Œåˆ‡æ¢æŒ‡å®šnode.jsï¼ˆæœ‰çš„è¯ï¼Œæ²¡æœ‰æŒ‡å®šä¸ä¼šåˆ‡æ¢ï¼Œä¸ä¼šæŠ¥é”™ï¼Œå‹¿å¿§ï¼‰
</span></code></pre>
<p>ä»¥ä¸Šæ­¥éª¤æ‰§è¡Œå®Œä¹‹åï¼Œé‡å¯powerShellå³å¯ï¼Œcdè¿›å…¥é¡¹ç›®ç›®å½•ï¼Œä¼šæœ‰è‡ªå®šä¹‰æç¤º</p>
<pre><code class="hljs language-php" lang="php">ğŸ”„ Switching to Node.js `<span class="hljs-variable">$version</span>...
<span class="hljs-comment">// è¿™æ˜¯æˆ‘ä»¬çš„è„šæœ¬è‡ªå®šä¹‰æç¤ºï¼Œåˆ‡æ¢nodeç‰ˆæœ¬æç¤ºï¼Œä¸å¿…æ‰§è¡Œä»»ä½•æ“ä½œ</span>
<span class="hljs-comment">// æç¤ºå‡ºç°åå›è½¦æ‰§è¡Œnvm currentå³å¯æŸ¥çœ‹å½“å‰nodeç‰ˆæœ¬ï¼Œæ­¤æ—¶nodeç‰ˆæœ¬åº”è¯¥å·²ç»åˆ‡æ¢æˆåŠŸäº†</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶åˆ°ä¸€ï¼šå½»åº•æå®šé¢è¯•é«˜é¢‘ç®—æ³•â€”â€”â€œåˆ—è¡¨è½¬æ ‘â€ä¸â€œçˆ¬æ¥¼æ¢¯â€å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7585171571129794596</link>    <guid>https://juejin.cn/post/7585171571129794596</guid>    <pubDate>2025-12-19T09:25:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585171571129794596" data-draft-id="7585173051647361060" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶åˆ°ä¸€ï¼šå½»åº•æå®šé¢è¯•é«˜é¢‘ç®—æ³•â€”â€”â€œåˆ—è¡¨è½¬æ ‘â€ä¸â€œçˆ¬æ¥¼æ¢¯â€å…¨è§£æ"/> <meta itemprop="keywords" content="JavaScript,ç®—æ³•,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-19T09:25:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="San30"/> <meta itemprop="url" content="https://juejin.cn/user/1766294768060816"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶åˆ°ä¸€ï¼šå½»åº•æå®šé¢è¯•é«˜é¢‘ç®—æ³•â€”â€”â€œåˆ—è¡¨è½¬æ ‘â€ä¸â€œçˆ¬æ¥¼æ¢¯â€å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1766294768060816/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    San30
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T09:25:01.000Z" title="Fri Dec 19 2025 09:25:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"ã€Œ"}.markdown-body b:after,.markdown-body strong:after{content:"ã€"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="github-gist">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#333}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#d73a49}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-symbol{color:#0086b3}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#6f42c1}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.hljs-number{color:#005cc5}.hljs-string{color:#032f62}</style><p>åœ¨å‰ç«¯é¢è¯•ä¸­ï¼Œç®—æ³•å¾€å¾€æ˜¯å†³å®šèƒ½å¦æ‹¿é«˜è–ªçš„å…³é”®ã€‚å¾ˆå¤šåŒå­¦ä¸€å¬åˆ°â€œç®—æ³•â€å°±å¤´å¤§ï¼Œè§‰å¾—é‚£æ˜¯å¤©æ‰ç©çš„æ¸¸æˆã€‚å…¶å®ï¼Œå¤§å¤šæ•°é¢è¯•ç®—æ³•é¢˜è€ƒå¯Ÿçš„ä¸æ˜¯ä½ çš„æ•°å­¦é€ è¯£ï¼Œè€Œæ˜¯ä½ å¯¹<strong>é€’å½’ï¼ˆRecursionï¼‰å’Œé€»è¾‘å¤„ç†</strong>çš„ç†è§£ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±é€šè¿‡ä¸¤ä¸ªéå¸¸ç»å…¸çš„é¢è¯•çœŸé¢˜â€”â€” <strong>â€œåˆ—è¡¨è½¬æ ‘ï¼ˆList to Treeï¼‰â€å’Œâ€œçˆ¬æ¥¼æ¢¯ï¼ˆClimbing Stairsï¼‰â€</strong> ï¼Œå¸¦ä½ ä»å°ç™½è§†è§’æ‹†è§£ç®—æ³•çš„å¥¥ç§˜ã€‚</p>
<h2 data-id="heading-0">ç¬¬ä¸€éƒ¨åˆ†ï¼šåˆ—è¡¨è½¬æ ‘ â€”â€” ä¸šåŠ¡ä¸­çš„â€œå¸¸é’æ ‘â€</h2>
<h3 data-id="heading-1">1. ä¸ºä»€ä¹ˆè¦å­¦è¿™ä¸ªï¼Ÿ</h3>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œåç«¯è¿”å›ç»™æˆ‘ä»¬çš„æ•°æ®å¾€å¾€æ˜¯â€œæ‰å¹³åŒ–â€çš„ã€‚æ¯”å¦‚ä¸€ä¸ªçœå¸‚åŒºé€‰æ‹©å™¨ï¼Œæˆ–è€…ä¸€ä¸ªåå°ç®¡ç†ç³»ç»Ÿçš„å·¦ä¾§èœå•å¯¼èˆªã€‚ä¸ºäº†å­˜å‚¨æ–¹ä¾¿ï¼Œæ•°æ®åº“é€šå¸¸ä¼šå­˜å‚¨ä¸ºå¦‚ä¸‹ç»“æ„ï¼š</p>






























<table><thead><tr><th><strong>id</strong></th><th><strong>parentId</strong></th><th><strong>name</strong></th></tr></thead><tbody><tr><td>1</td><td>0</td><td>ä¸­å›½</td></tr><tr><td>2</td><td>1</td><td>åŒ—äº¬</td></tr><tr><td>3</td><td>1</td><td>ä¸Šæµ·</td></tr><tr><td>4</td><td>2</td><td>ä¸œåŸåŒº</td></tr></tbody></table>
<p>ä½†å‰ç«¯ UI ç»„ä»¶ï¼ˆå¦‚ Element UI çš„ Tree ç»„ä»¶ï¼‰éœ€è¦çš„æ˜¯ä¸€ä¸ª<strong>åµŒå¥—çš„æ ‘å½¢å¯¹è±¡</strong>ã€‚å¦‚ä½•æŠŠä¸Šé¢çš„è¡¨æ ¼æ•°æ®è½¬æ¢æˆåŒ…å« <code>children</code> çš„æ ‘ï¼Ÿè¿™å°±æ˜¯é¢è¯•å®˜è€ƒå¯Ÿä½ çš„æ•°æ®ç»“æ„å¤„ç†èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-2">2. è§£æ³•ä¸€ï¼šæš´åŠ›é€’å½’ï¼ˆæœ€ç¬¦åˆäººç±»ç›´è§‰ï¼‰</h3>
<p><strong>æ ¸å¿ƒé€»è¾‘ï¼š</strong></p>
<ol>
<li>éå†åˆ—è¡¨ï¼Œæ‰¾åˆ°æ ¹èŠ‚ç‚¹ï¼ˆ<code>parentId === 0</code>ï¼‰ã€‚</li>
<li>å¯¹äºæ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå†å»åˆ—è¡¨é‡Œæ‰¾è°çš„ <code>parentId</code> ç­‰äºæˆ‘çš„ <code>id</code>ã€‚</li>
<li>é€’å½’ä¸‹å»ï¼Œç›´åˆ°æ‰¾ä¸åˆ°å­èŠ‚ç‚¹ã€‚</li>
</ol>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// ä»£ç å‚è€ƒ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">list2tree</span>(<span class="hljs-params">list, parentId = <span class="hljs-number">0</span></span>) {
  <span class="hljs-keyword">const</span> result = []; 
  list.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (item.<span class="hljs-property">parentId</span> === parentId) {
      <span class="hljs-comment">// è¿™é‡Œçš„é€’å½’å°±åƒæ˜¯åœ¨é—®ï¼šè°æ˜¯æˆ‘çš„å­©å­ï¼Ÿ</span>
      <span class="hljs-keyword">const</span> children = <span class="hljs-title function_">list2tree</span>(list, item.<span class="hljs-property">id</span>);
      <span class="hljs-keyword">if</span> (children.<span class="hljs-property">length</span>) {
        item.<span class="hljs-property">children</span> = children;
      }
      result.<span class="hljs-title function_">push</span>(item);
    }
  });
  <span class="hljs-keyword">return</span> result;
}
</code></pre>
<p>å°ç™½é¿å‘æŒ‡å—ï¼š</p>
<p>è¿™ç§æ–¹æ³•çš„å¤æ‚åº¦æ˜¯ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>ã€‚å¦‚æœåˆ—è¡¨æœ‰ 1000 æ¡æ•°æ®ï¼Œæœ€åæƒ…å†µä¸‹è¦è·‘ 100 ä¸‡æ¬¡å¾ªç¯ã€‚é¢è¯•å®˜æ­¤æ—¶ä¼šé—®ï¼šâ€œæœ‰æ²¡æœ‰æ›´ä¼˜çš„æ–¹æ³•ï¼Ÿâ€</p>
<h3 data-id="heading-3">3. è§£æ³•äºŒï¼šä¼˜é›…çš„ ES6 å‡½æ•°å¼å†™æ³•</h3>
<p>å¦‚æœä½ æƒ³è®©ä»£ç çœ‹èµ·æ¥æ›´â€œé«˜çº§â€ï¼Œå¯ä»¥åˆ©ç”¨ <code>filter</code> å’Œ <code>map</code>ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">list2tree</span>(<span class="hljs-params">list, parentId = <span class="hljs-number">0</span></span>) {
  <span class="hljs-keyword">return</span> list
    .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">parentId</span> === parentId) <span class="hljs-comment">// è¿‡æ»¤å‡ºå½“å‰çš„å­èŠ‚ç‚¹</span>
    .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({
      ...item, <span class="hljs-comment">// å±•å¼€åŸæœ‰å±æ€§</span>
      <span class="hljs-attr">children</span>: <span class="hljs-title function_">list2tree</span>(list, item.<span class="hljs-property">id</span>) <span class="hljs-comment">// é€’å½’å¯»æ‰¾åä»£</span>
    }));
}
</code></pre>
<h3 data-id="heading-4">4. è§£æ³•ä¸‰ï¼šç©ºé—´æ¢æ—¶é—´ï¼ˆé¢è¯•å®˜æœ€çˆ±ï¼‰</h3>
<p>ä¸ºäº†æŠŠæ—¶é—´å¤æ‚åº¦é™åˆ° <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code>Map</code> å¯¹è±¡ã€‚<code>Map</code> çš„æŸ¥è¯¢é€Ÿåº¦æå¿«ï¼Œåƒæ˜¯ä¸€ä¸ªâ€œç¬ç§»å™¨â€ã€‚</p>
<p><strong>æ€è·¯ï¼š</strong></p>
<ol>
<li>å…ˆéå†ä¸€éåˆ—è¡¨ï¼ŒæŠŠæ‰€æœ‰èŠ‚ç‚¹å­˜å…¥ Map ä¸­ï¼Œä»¥ <code>id</code> ä¸º Keyã€‚</li>
<li>å†éå†ä¸€éï¼Œæ ¹æ® <code>parentId</code> ç›´æ¥ä» Map é‡ŒæŠŠçˆ¶èŠ‚ç‚¹â€œæªâ€å‡ºæ¥ï¼ŒæŠŠå½“å‰èŠ‚ç‚¹å¡è¿›çˆ¶èŠ‚ç‚¹çš„ <code>children</code> é‡Œã€‚</li>
</ol>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// ä»£ç å‚è€ƒ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">listToTree</span>(<span class="hljs-params">list</span>) {
    <span class="hljs-keyword">const</span> nodeMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-keyword">const</span> tree = [];

    <span class="hljs-comment">// ç¬¬ä¸€éï¼šå»ºç«‹æ˜ å°„è¡¨</span>
    list.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
        nodeMap.<span class="hljs-title function_">set</span>(item.<span class="hljs-property">id</span>, { ...item, <span class="hljs-attr">children</span>: [] });
    });

    <span class="hljs-comment">// ç¬¬äºŒéï¼šå»ºç«‹çˆ¶å­å…³ç³»</span>
    list.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
        <span class="hljs-keyword">const</span> node = nodeMap.<span class="hljs-title function_">get</span>(item.<span class="hljs-property">id</span>);
        <span class="hljs-keyword">if</span> (item.<span class="hljs-property">parentId</span> === <span class="hljs-number">0</span>) {
            tree.<span class="hljs-title function_">push</span>(node); <span class="hljs-comment">// æ ¹èŠ‚ç‚¹å…¥é˜Ÿ</span>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// ç›´æ¥é€šè¿‡ parentId æ‰¾åˆ°çˆ¶äº²ï¼ŒæŠŠå„¿å­å¡è¿›å»</span>
            nodeMap.<span class="hljs-title function_">get</span>(item.<span class="hljs-property">parentId</span>)?.<span class="hljs-property">children</span>.<span class="hljs-title function_">push</span>(node);
        }
    });
    <span class="hljs-keyword">return</span> tree;
}
</code></pre>
<p><strong>ä¼˜ç‚¹ï¼š</strong> åªéå†äº†ä¸¤éåˆ—è¡¨ã€‚æ— è®ºæ•°æ®æœ‰å¤šå°‘ï¼Œé€Ÿåº¦ä¾ç„¶é£å¿«ã€‚</p>
<h2 data-id="heading-5">ç¬¬äºŒéƒ¨åˆ†ï¼šçˆ¬æ¥¼æ¢¯ â€”â€” æŒæ¡ç®—æ³•çš„â€œåˆ†æ°´å²­â€</h2>
<p>å¦‚æœè¯´â€œåˆ—è¡¨è½¬æ ‘â€è€ƒå¯Ÿçš„æ˜¯ä¸šåŠ¡èƒ½åŠ›ï¼Œé‚£â€œçˆ¬æ¥¼æ¢¯â€è€ƒå¯Ÿçš„å°±æ˜¯<strong>ç¼–ç¨‹æ€ç»´</strong>ã€‚</p>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong> å‡è®¾ä½ æ­£åœ¨çˆ¬æ¥¼æ¢¯ã€‚éœ€è¦ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">n</span></span></span></span></span> é˜¶ä½ æ‰èƒ½åˆ°è¾¾æ¥¼é¡¶ã€‚æ¯æ¬¡ä½ å¯ä»¥çˆ¬ 1 æˆ– 2 ä¸ªå°é˜¶ã€‚ä½ æœ‰å¤šå°‘ç§ä¸åŒçš„æ–¹æ³•å¯ä»¥çˆ¬åˆ°æ¥¼é¡¶å‘¢ï¼Ÿ</p>
<h3 data-id="heading-6">1. è‡ªé¡¶å‘ä¸‹ï¼šé€’å½’çš„è‰ºæœ¯</h3>
<p>æˆ‘ä»¬ç«™åœ¨ç¬¬ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">n</span></span></span></span></span> é˜¶å¾€å›çœ‹ï¼š</p>
<ul>
<li>è¦åˆ°è¾¾ç¬¬ 10 é˜¶ï¼Œä½ åªèƒ½ä»ç¬¬ 9 é˜¶è·¨ 1 æ­¥ä¸Šæ¥ï¼Œæˆ–è€…ä»ç¬¬ 8 é˜¶è·¨ 2 æ­¥ä¸Šæ¥ã€‚</li>
<li>æ‰€ä»¥ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mn>10</mn><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mn>9</mn><mo stretchy="false">)</mo><mo>+</mo><mi>f</mi><mo stretchy="false">(</mo><mn>8</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(10) = f(9) + f(8)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">10</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">9</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">8</span><span class="mclose">)</span></span></span></span></span>ã€‚</li>
</ul>
<p>è¿™å°±æ˜¯è‘—åçš„<strong>æ–æ³¢é‚£å¥‘æ•°åˆ—å…¬å¼</strong>ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// åŸºç¡€ç‰ˆ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">climbStairs</span>(<span class="hljs-params">n</span>) {
    <span class="hljs-keyword">if</span> (n === <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (n === <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">climbStairs</span>(n - <span class="hljs-number">1</span>) + <span class="hljs-title function_">climbStairs</span>(n - <span class="hljs-number">2</span>);
}
</code></pre>
<p><strong>è‡´å‘½ç¼ºé™·ï¼š</strong> è¿™ä¸ªä»£ç ä¼šè·‘æ­»ç”µè„‘ã€‚ç®— <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(10)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">10</span><span class="mclose">)</span></span></span></span></span> æ—¶è¦ç®— <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mn>9</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(9)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">9</span><span class="mclose">)</span></span></span></span></span> å’Œ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mn>8</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(8)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">8</span><span class="mclose">)</span></span></span></span></span>ï¼›ç®— <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mn>9</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(9)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">9</span><span class="mclose">)</span></span></span></span></span> æ—¶åˆè¦ç®—ä¸€é <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mn>8</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(8)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">8</span><span class="mclose">)</span></span></span></span></span>ã€‚å¤§é‡çš„é‡å¤è®¡ç®—å¯¼è‡´â€œçˆ†æ ˆâ€ã€‚</p>
<h3 data-id="heading-7">2. ä¼˜åŒ–ï¼šå¸¦å¤‡å¿˜å½•çš„é€’å½’ï¼ˆè®°å¿†åŒ–ï¼‰</h3>
<p>æˆ‘ä»¬å¯ä»¥å‡†å¤‡ä¸€ä¸ªâ€œç¬”è®°æœ¬â€ï¼ˆmemoï¼‰ï¼Œç®—è¿‡çš„å€¼å°±è®°ä¸‹æ¥ï¼Œä¸‹æ¬¡ç›´æ¥æ‹¿ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> memo = {};
<span class="hljs-keyword">function</span> <span class="hljs-title function_">climbStairs</span>(<span class="hljs-params">n</span>) {
    <span class="hljs-keyword">if</span> (n === <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (n === <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>;
    <span class="hljs-keyword">if</span> (memo[n]) <span class="hljs-keyword">return</span> memo[n]; <span class="hljs-comment">// ç¿»ç¿»ç¬”è®°ï¼Œæœ‰å°±ç›´æ¥ç»™</span>
    memo[n] = <span class="hljs-title function_">climbStairs</span>(n - <span class="hljs-number">1</span>) + <span class="hljs-title function_">climbStairs</span>(n - <span class="hljs-number">2</span>);
    <span class="hljs-keyword">return</span> memo[n];
}
</code></pre>
<h3 data-id="heading-8">3. è‡ªåº•å‘ä¸Šï¼šåŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰</h3>
<p>åŠ¨æ€è§„åˆ’ï¼ˆDynamic Programmingï¼‰å¬èµ·æ¥å¾ˆé«˜å¤§ä¸Šï¼Œå…¶å®å°±æ˜¯å€’è¿‡æ¥æƒ³ã€‚</p>
<p>æˆ‘ä»¬ä¸ä» <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span> å¾€å›æ‰¾ï¼Œè€Œæ˜¯ä» <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span> å¼€å§‹å¾€åæ¨ï¼š</p>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">f(1) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span></li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">f(2) = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">2</span></span></span></span></span></li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>+</mo><mn>2</mn><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">f(3) = 1 + 2 = 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">3</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">2</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">3</span></span></span></span></span></li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mo>+</mo><mn>3</mn><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">f(4) = 2 + 3 = 5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">4</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">5</span></span></span></span></span></li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">climbStairs</span>(<span class="hljs-params">n</span>) {
  <span class="hljs-keyword">if</span> (n &lt;= <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> n;
  <span class="hljs-keyword">const</span> dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(n + <span class="hljs-number">1</span>);
  dp[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;
  dp[<span class="hljs-number">2</span>] = <span class="hljs-number">2</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">3</span>; i &lt;= n; i++) {
    dp[i] = dp[i - <span class="hljs-number">1</span>] + dp[i - <span class="hljs-number">2</span>]; <span class="hljs-comment">// æ¯ä¸€ä¸ªç»“æœéƒ½æ˜¯å‰ä¸¤ä¸ªçš„å’Œ</span>
  }
  <span class="hljs-keyword">return</span> dp[n];
}
</code></pre>
<h3 data-id="heading-9">4. æè‡´ä¼˜åŒ–ï¼šæ»šåŠ¨å˜é‡</h3>
<p>æ—¢ç„¶ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span> åªä¾èµ–å‰ä¸¤ä¸ªæ•°ï¼Œé‚£æˆ‘ä»¬è¿æ•°ç»„éƒ½ä¸éœ€è¦äº†ï¼Œåªéœ€è¦ä¸‰ä¸ªå˜é‡åœ¨æ‰‹é‡Œâ€œæ»šâ€èµ·æ¥ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">climbStairs</span>(<span class="hljs-params">n</span>) {
    <span class="hljs-keyword">if</span>(n &lt;= <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> n;
    <span class="hljs-keyword">let</span> prePrev = <span class="hljs-number">1</span>; <span class="hljs-comment">// f(n-2)</span>
    <span class="hljs-keyword">let</span> prev = <span class="hljs-number">2</span>;    <span class="hljs-comment">// f(n-1)</span>
    <span class="hljs-keyword">let</span> current;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">3</span>; i &lt;= n; i++){
        current = prev + prePrev;
        prePrev = prev;
        prev = current;
    }
    <span class="hljs-keyword">return</span> current;
}
</code></pre>
<p>è¿™æ—¶çš„ç©ºé—´å¤æ‚åº¦é™åˆ°äº† <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>ï¼Œå‡ ä¹ä¸å ç”¨é¢å¤–å†…å­˜ã€‚</p>
<h2 data-id="heading-10">æ€»ç»“ï¼šå°ç™½å¦‚ä½•ç²¾è¿›ç®—æ³•ï¼Ÿ</h2>
<p>é€šè¿‡è¿™ä¸¤é“é¢˜ï¼Œä½ åº”è¯¥èƒ½å‘ç°ç®—æ³•å­¦ä¹ çš„è§„å¾‹ï¼š</p>
<ol>
<li><strong>å…ˆç”»å›¾ï¼Œåå†™ç ï¼š</strong> ä¸ç®¡æ˜¯æ ‘çŠ¶ç»“æ„è¿˜æ˜¯æ¥¼æ¢¯å°é˜¶ï¼Œç”»å‡ºé€»è¾‘å›¾æ¯”ç›´æ¥å†™ä»£ç é‡è¦å¾—å¤šã€‚</li>
<li><strong>å¯»æ‰¾é‡å¤å­é—®é¢˜ï¼š</strong> é€’å½’å’Œ DP çš„æ ¸å¿ƒéƒ½åœ¨äºæŠŠå¤§é—®é¢˜æ‹†è§£æˆä¸€æ ·çš„å°é—®é¢˜ã€‚</li>
<li><strong>ä»æš´åŠ›åˆ°ä¼˜åŒ–ï¼š</strong> åˆ«æŒ‡æœ›ä¸€æ­¥å†™å‡ºæœ€ä¼˜è§£ã€‚å…ˆç”¨æœ€ç¬¨çš„æ–¹æ³•å†™å‡ºæ¥ï¼Œå†å»æ€è€ƒå¦‚ä½•å‡å°‘é‡å¤è®¡ç®—ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•åœ¨Taroé¡¹ç›®ä¸­ä½¿ç”¨axios]]></title>    <link>https://juejin.cn/post/7585138968167677988</link>    <guid>https://juejin.cn/post/7585138968167677988</guid>    <pubDate>2025-12-19T09:25:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585138968167677988" data-draft-id="7585171571129548836" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•åœ¨Taroé¡¹ç›®ä¸­ä½¿ç”¨axios"/> <meta itemprop="keywords" content="Taro,å¾®ä¿¡å°ç¨‹åº"/> <meta itemprop="datePublished" content="2025-12-19T09:25:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é™å¾…é›¨è½"/> <meta itemprop="url" content="https://juejin.cn/user/3219836765220077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•åœ¨Taroé¡¹ç›®ä¸­ä½¿ç”¨axios
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3219836765220077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é™å¾…é›¨è½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T09:25:46.000Z" title="Fri Dec 19 2025 09:25:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Axios é»˜è®¤ä½¿ç”¨Â <code>XMLHttpRequest</code>Â æˆ–Â <code>Node.js</code>Â çš„Â <code>http</code>Â æ¨¡å—ï¼Œè¿™åœ¨æŸäº›å°ç¨‹åºç«¯å¯èƒ½ä¸æ”¯æŒï¼š</p>
<ul>
<li>âœ…Â <strong>H5 ç«¯</strong>ï¼šå®Œå…¨æ”¯æŒ</li>
<li>âœ…Â <strong>React Native ç«¯</strong>ï¼šéœ€è¦é…ç½®é€‚é…å™¨</li>
<li>âŒÂ <strong>å¾®ä¿¡/æ”¯ä»˜å®ç­‰å°ç¨‹åºç«¯</strong>ï¼š<strong>ä¸æ”¯æŒ</strong>ï¼ˆå› ä¸ºå°ç¨‹åºç¯å¢ƒæ²¡æœ‰Â <code>XMLHttpRequest</code>ï¼‰</li>
</ul>
<p>å¯¹äºéœ€è¦åœ¨å¤šç«¯ä½¿ç”¨ Axios çš„é¡¹ç›®ï¼Œå¯ä»¥é…ç½®é€‚é…å™¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pnpm install axios @tarojs/taro
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// utils/axiosAdapter.js</span>
<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Taro</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'@tarojs/taro'</span>

<span class="hljs-comment">// åˆ›å»ºè‡ªå®šä¹‰é€‚é…å™¨</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">taroAdapter</span> = (<span class="hljs-params">config</span>) =&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-title class_">Taro</span>.<span class="hljs-title function_">request</span>({
      <span class="hljs-attr">url</span>: config.<span class="hljs-property">url</span>,
      <span class="hljs-attr">method</span>: config.<span class="hljs-property">method</span>?.<span class="hljs-title function_">toUpperCase</span>() || <span class="hljs-string">'GET'</span>,
      <span class="hljs-attr">data</span>: config.<span class="hljs-property">data</span> || config.<span class="hljs-property">params</span>,
      <span class="hljs-attr">header</span>: config.<span class="hljs-property">headers</span>,
      <span class="hljs-attr">success</span>: <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
        <span class="hljs-title function_">resolve</span>({
          <span class="hljs-attr">data</span>: response.<span class="hljs-property">data</span>,
          <span class="hljs-attr">status</span>: response.<span class="hljs-property">statusCode</span>,
          <span class="hljs-attr">statusText</span>: <span class="hljs-string">'OK'</span>,
          <span class="hljs-attr">headers</span>: response.<span class="hljs-property">header</span>,
          <span class="hljs-attr">config</span>: config,
          <span class="hljs-attr">request</span>: <span class="hljs-literal">null</span>
        })
      },
      <span class="hljs-attr">fail</span>: <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
        <span class="hljs-title function_">reject</span>(error)
      }
    })
  })
}

<span class="hljs-comment">// åˆ›å»º Axios å®ä¾‹</span>
<span class="hljs-keyword">const</span> instance = axios.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">adapter</span>: taroAdapter,
  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">'https://api.example.com'</span>,
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>,
})

<span class="hljs-comment">// è¯·æ±‚æ‹¦æˆªå™¨</span>
instance.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(
  <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> {
    <span class="hljs-comment">// æ·»åŠ  token</span>
    <span class="hljs-keyword">const</span> token = <span class="hljs-title class_">Taro</span>.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">'token'</span>)
    <span class="hljs-keyword">if</span> (token) {
      config.<span class="hljs-property">headers</span>[<span class="hljs-string">'Authorization'</span>] = <span class="hljs-string">`Bearer <span class="hljs-subst">${token}</span>`</span>
    }
    <span class="hljs-keyword">return</span> config
  },
  <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error)
  }
)

<span class="hljs-comment">// å“åº”æ‹¦æˆªå™¨</span>
instance.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(
  <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>
  },
  <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-comment">// ç»Ÿä¸€é”™è¯¯å¤„ç†</span>
    <span class="hljs-title class_">Taro</span>.<span class="hljs-title function_">showToast</span>({
      <span class="hljs-attr">title</span>: <span class="hljs-string">'è¯·æ±‚å¤±è´¥'</span>,
      <span class="hljs-attr">icon</span>: <span class="hljs-string">'error'</span>
    })
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error)
  }
)

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> instance
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸš€ é«˜å¹¶å‘åœºæ™¯ä¸‹çš„æ•‘æ˜Ÿï¼šBullMQå¦‚ä½•å®ç°æ™ºèƒ½æµé‡å‰Šå³°å¡«è°·]]></title>    <link>https://juejin.cn/post/7585227038991319078</link>    <guid>https://juejin.cn/post/7585227038991319078</guid>    <pubDate>2025-12-19T09:22:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585227038991319078" data-draft-id="7585289701827182601" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸš€ é«˜å¹¶å‘åœºæ™¯ä¸‹çš„æ•‘æ˜Ÿï¼šBullMQå¦‚ä½•å®ç°æ™ºèƒ½æµé‡å‰Šå³°å¡«è°·"/> <meta itemprop="keywords" content="åˆ†å¸ƒå¼,å‰ç«¯,æ¶ˆæ¯é˜Ÿåˆ—"/> <meta itemprop="datePublished" content="2025-12-19T09:22:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="liuniansilence"/> <meta itemprop="url" content="https://juejin.cn/user/3087084380228653"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸš€ é«˜å¹¶å‘åœºæ™¯ä¸‹çš„æ•‘æ˜Ÿï¼šBullMQå¦‚ä½•å®ç°æ™ºèƒ½æµé‡å‰Šå³°å¡«è°·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3087084380228653/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    liuniansilence
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T09:22:49.000Z" title="Fri Dec 19 2025 09:22:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><code>bullmq</code>æ˜¯å¦‚ä½•é’ˆå¯¹æµé‡å³°å€¼çš„æ—¶å€™åšè°ƒåº¦çš„ï¼Œæ¯”å¦‚æˆ‘çš„qpsæœ€å¤§é™åˆ¶æ˜¯10ï¼Œä½†æ˜¯è¯·æ±‚å¹¶ä¸èƒ½çŸ¥é“qpsæ˜¯å¦è¾¾åˆ°å³°å€¼ã€‚æ˜¯å¦‚ä½•è·Ÿç½‘ç®¡çš„qpsé™åˆ¶ç»“åˆæ¥å®ç°ä»»åŠ¡é˜Ÿåˆ—è°ƒæ§çš„ï¼Ÿ</p>
<p><strong>BullMQ æµé‡æ§åˆ¶çš„å·¥ä½œåŸç†</strong></p>
<h2 data-id="heading-0">1. <code>BullMQ</code> é™æµæœºåˆ¶ï¼ˆ<code>Worker</code> ç«¯æ§åˆ¶ï¼‰</h2>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'api-calls'</span>, <span class="hljs-keyword">async</span> (job) =&gt; {
  <span class="hljs-comment">// è°ƒç”¨ç¬¬ä¸‰æ–¹ API</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://third-party-api.com/data'</span>);
  <span class="hljs-keyword">return</span> result.<span class="hljs-title function_">json</span>();
}, {
  connection,
  <span class="hljs-attr">limiter</span>: {
    <span class="hljs-attr">max</span>: <span class="hljs-number">10</span>,        <span class="hljs-comment">// æ¯ä¸ªæ—¶é—´çª—å£æœ€å¤šå¤„ç† 10 ä¸ªä»»åŠ¡</span>
    <span class="hljs-attr">duration</span>: <span class="hljs-number">1000</span>  <span class="hljs-comment">// æ—¶é—´çª—å£ 1 ç§’</span>
  }
});
</code></pre>
<p><strong>å…³é”®ç†è§£</strong>ï¼š<code>BullMQ</code> çš„é™æµæ˜¯åœ¨ä»»åŠ¡æ¶ˆè´¹ç«¯ï¼ˆ<code>Worker</code>ï¼‰è¿›è¡Œçš„ï¼Œä¸æ˜¯åœ¨ä»»åŠ¡ç”Ÿäº§ç«¯ã€‚</p>
<h2 data-id="heading-1">2. å®é™…çš„æµé‡æ§åˆ¶æµç¨‹</h2>
<p>// åœºæ™¯ï¼šè°ƒç”¨ç¬¬ä¸‰æ–¹ APIï¼Œå¯¹æ–¹é™åˆ¶ QPS = 10</p>
<p>// Step 1: è¯·æ±‚è¿›å…¥æ—¶ä¸åšé™åˆ¶ï¼Œå…¨éƒ¨åŠ å…¥é˜Ÿåˆ—</p>
<pre><code class="hljs language-ts" lang="ts">app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/process-data'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-comment">// ğŸ”´ è¿™é‡Œä¸ç®¡æœ‰å¤šå°‘è¯·æ±‚ï¼Œéƒ½ä¼šåŠ å…¥é˜Ÿåˆ—</span>
  <span class="hljs-keyword">await</span> apiQueue.<span class="hljs-title function_">add</span>(<span class="hljs-string">'call-third-party'</span>, req.<span class="hljs-property">body</span>);
  res.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'Task queued'</span> });
});
</code></pre>
<p>// Step 2: Worker æŒ‰é™æµè§„åˆ™å¤„ç†ä»»åŠ¡</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'api-calls'</span>, <span class="hljs-keyword">async</span> (job) =&gt; {
  <span class="hljs-comment">// âœ… è¿™é‡Œæ‰ä¼šæŒ‰ QPS é™åˆ¶æ‰§è¡Œ</span>
  <span class="hljs-comment">// BullMQ ç¡®ä¿æ¯ç§’æœ€å¤šæ‰§è¡Œ 10 ä¸ªä»»åŠ¡</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">callThirdPartyAPI</span>(job.<span class="hljs-property">data</span>);
  <span class="hljs-keyword">return</span> result;
}, {
  <span class="hljs-attr">limiter</span>: {
    <span class="hljs-attr">max</span>: <span class="hljs-number">10</span>,        <span class="hljs-comment">// å¯¹åº”ç¬¬ä¸‰æ–¹ API çš„ QPS é™åˆ¶</span>
    <span class="hljs-attr">duration</span>: <span class="hljs-number">1000</span>
  }
});
</code></pre>
<h2 data-id="heading-2">3. ä¸ç½‘å…³ QPS é™åˆ¶çš„åŒºåˆ«</h2>






























<table><thead><tr><th>å±‚é¢</th><th>ç½‘å…³ QPS é™åˆ¶</th><th>BullMQ æµé‡æ§åˆ¶</th></tr></thead><tbody><tr><td>ä½œç”¨ç‚¹</td><td>è¯·æ±‚å…¥å£å¤„</td><td>ä»»åŠ¡å¤„ç†æ—¶</td></tr><tr><td>é™åˆ¶å¯¹è±¡</td><td>HTTP è¯·æ±‚</td><td>é˜Ÿåˆ—ä»»åŠ¡æ‰§è¡Œ</td></tr><tr><td>è¶…é™è¡Œä¸º</td><td>ç›´æ¥æ‹’ç»è¯·æ±‚ (429)</td><td>ä»»åŠ¡æ’é˜Ÿç­‰å¾…</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>ä¿æŠ¤ç³»ç»Ÿä¸è¢«æ‰“å®</td><td>ä¿æŠ¤ä¸‹æ¸¸æœåŠ¡</td></tr></tbody></table>
<h2 data-id="heading-3">4. å®é™…åº”ç”¨åœºæ™¯ç¤ºä¾‹</h2>
<p>åœºæ™¯ï¼šç”µå•†ç³»ç»Ÿè°ƒç”¨æ”¯ä»˜æ¥å£</p>
<p>// ç½‘å…³å±‚ï¼šä¿æŠ¤è‡ªå·±çš„ç³»ç»Ÿ
// é™åˆ¶ï¼šæ¯ç§’æœ€å¤šæ¥æ”¶ 1000 ä¸ªæ”¯ä»˜è¯·æ±‚</p>
<pre><code class="hljs language-ts" lang="ts">app.<span class="hljs-title function_">use</span>(<span class="hljs-string">'/api/payment'</span>, <span class="hljs-title function_">rateLimit</span>({
  <span class="hljs-attr">windowMs</span>: <span class="hljs-number">1000</span>,
  <span class="hljs-attr">max</span>: <span class="hljs-number">1000</span>,
  <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åé‡è¯•'</span>
}));
</code></pre>
<p>// åº”ç”¨å±‚ï¼šæ¥æ”¶è¯·æ±‚å¹¶åŠ å…¥é˜Ÿåˆ—</p>
<pre><code class="hljs language-ts" lang="ts">app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/payment/process'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-comment">// æ‰€æœ‰é€šè¿‡ç½‘å…³çš„è¯·æ±‚éƒ½åŠ å…¥é˜Ÿåˆ—</span>
  <span class="hljs-keyword">await</span> paymentQueue.<span class="hljs-title function_">add</span>(<span class="hljs-string">'process-payment'</span>, req.<span class="hljs-property">body</span>);
  res.<span class="hljs-title function_">json</span>({ <span class="hljs-attr">orderId</span>: req.<span class="hljs-property">body</span>.<span class="hljs-property">orderId</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">'processing'</span> });
});

<span class="hljs-comment">// BullMQ Workerï¼šä¿æŠ¤ä¸‹æ¸¸æ”¯ä»˜æœåŠ¡</span>
<span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'payment-queue'</span>, <span class="hljs-keyword">async</span> (job) =&gt; {
  <span class="hljs-comment">// æ”¯ä»˜æœåŠ¡é™åˆ¶ QPS = 50ï¼Œè¿™é‡Œä¸¥æ ¼æ§åˆ¶</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> paymentService.<span class="hljs-title function_">process</span>(job.<span class="hljs-property">data</span>);
  <span class="hljs-keyword">return</span> result;
}, {
  <span class="hljs-attr">limiter</span>: {
    <span class="hljs-attr">max</span>: <span class="hljs-number">50</span>,        <span class="hljs-comment">// åŒ¹é…æ”¯ä»˜æœåŠ¡çš„ QPS é™åˆ¶</span>
    <span class="hljs-attr">duration</span>: <span class="hljs-number">1000</span>
  }
});
</code></pre>
<h2 data-id="heading-4">5. åŠ¨æ€è°ƒæ§ç­–ç•¥</h2>
<p>åŸºäºç›‘æ§çš„åŠ¨æ€è°ƒæ•´ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AdaptiveWorker</span> {
  <span class="hljs-keyword">private</span> currentLimit = <span class="hljs-number">10</span>;
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupWorker</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">monitorAndAdjust</span>();
  }
  
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">setupWorker</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">worker</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'adaptive-queue'</span>, <span class="hljs-keyword">async</span> (job) =&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">callExternalAPI</span>(job.<span class="hljs-property">data</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onSuccess</span>();
        <span class="hljs-keyword">return</span> result;
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onError</span>(error);
        <span class="hljs-keyword">throw</span> error;
      }
    }, {
      <span class="hljs-attr">limiter</span>: {
        <span class="hljs-attr">max</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentLimit</span>,
        <span class="hljs-attr">duration</span>: <span class="hljs-number">1000</span>
      }
    });
  }
  
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">onError</span>(<span class="hljs-params">error</span>) {
    <span class="hljs-keyword">if</span> (error.<span class="hljs-property">status</span> === <span class="hljs-number">429</span>) { <span class="hljs-comment">// é™æµé”™è¯¯</span>
      <span class="hljs-comment">// åŠ¨æ€é™ä½å¤„ç†é€Ÿåº¦</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentLimit</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">1</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentLimit</span> - <span class="hljs-number">2</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateWorkerLimiter</span>();
    }
  }
  
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">onSuccess</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æˆåŠŸæ—¶é€æ­¥æå‡å¤„ç†é€Ÿåº¦</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentLimit</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-number">20</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentLimit</span> + <span class="hljs-number">1</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateWorkerLimiter</span>();
  }
}
</code></pre>
<h2 data-id="heading-5">6. å¤šå±‚é˜²æŠ¤æ¶æ„</h2>
<p>// ç¬¬1å±‚ï¼šç½‘å…³é™æµï¼ˆä¿æŠ¤è‡ªå·±ï¼‰
// Nginx/Kong: limit_req_zone $binary_remote_addr zone=api:10m rate=100r/s;</p>
<p>// ç¬¬2å±‚ï¼šåº”ç”¨å±‚é™æµï¼ˆä¿æŠ¤æ•°æ®åº“ï¼‰</p>
<pre><code class="hljs language-ts" lang="ts">app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">rateLimit</span>({ <span class="hljs-attr">windowMs</span>: <span class="hljs-number">1000</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">200</span> }));
</code></pre>
<p>// ç¬¬3å±‚ï¼šé˜Ÿåˆ—é™æµï¼ˆä¿æŠ¤ä¸‹æ¸¸æœåŠ¡ï¼‰</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'external-api'</span>, handler, {
  <span class="hljs-attr">limiter</span>: { <span class="hljs-attr">max</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">duration</span>: <span class="hljs-number">1000</span> } <span class="hljs-comment">// åŒ¹é…å¤–éƒ¨ API é™åˆ¶</span>
});
</code></pre>
<p>// ç¬¬4å±‚ï¼šç†”æ–­å™¨ï¼ˆæ•…éšœä¿æŠ¤ï¼‰</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> circuitBreaker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CircuitBreaker</span>(externalAPICall, {
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">3000</span>,
  <span class="hljs-attr">errorThresholdPercentage</span>: <span class="hljs-number">50</span>,
  <span class="hljs-attr">resetTimeout</span>: <span class="hljs-number">30000</span>
});
</code></pre>
<p><strong>æ€»ç»“</strong>
<code>BullMQ</code> çš„æµé‡æ§åˆ¶ä¸»è¦è§£å†³çš„æ˜¯"å¦‚ä½•æŒ‰ç…§ä¸‹æ¸¸æœåŠ¡çš„æ‰¿å—èƒ½åŠ›æ¥å¤„ç†ä»»åŠ¡"ï¼Œè€Œä¸æ˜¯"å¦‚ä½•é™åˆ¶ç”¨æˆ·è¯·æ±‚"ã€‚</p>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>è¯·æ±‚å…¥é˜Ÿä¸é™åˆ¶ï¼šç”¨æˆ·è¯·æ±‚å¯ä»¥å¿«é€Ÿå“åº”å¹¶åŠ å…¥é˜Ÿåˆ—</li>
<li>ä»»åŠ¡æ‰§è¡Œé™åˆ¶ï¼šWorker ä¸¥æ ¼æŒ‰ç…§ä¸‹æ¸¸æœåŠ¡çš„ QPS èƒ½åŠ›å¤„ç†ä»»åŠ¡</li>
<li>å‰Šå³°å¡«è°·ï¼šé«˜å³°æœŸè¯·æ±‚æ’é˜Ÿï¼Œä½å³°æœŸé€æ­¥å¤„ç†</li>
<li>ä¿æŠ¤ä¸‹æ¸¸ï¼šé¿å…å› çªå‘æµé‡å¯¼è‡´ä¸‹æ¸¸æœåŠ¡å´©æºƒ</li>
</ul>
<p>è¿™æ ·è®¾è®¡çš„å¥½å¤„æ˜¯ç”¨æˆ·ä½“éªŒå¥½ï¼ˆå¿«é€Ÿå“åº”ï¼‰ï¼Œç³»ç»Ÿç¨³å®šï¼ˆä¸ä¼šå‹å®ä¸‹æ¸¸ï¼‰ï¼Œèµ„æºåˆ©ç”¨å……åˆ†ï¼ˆé˜Ÿåˆ—ç¼“å†²æœºåˆ¶ï¼‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨Angularä¸­å®ç°åŸºäºnz-calendarçš„æ—¥å†ç”˜ç‰¹å›¾]]></title>    <link>https://juejin.cn/post/7585130590293000207</link>    <guid>https://juejin.cn/post/7585130590293000207</guid>    <pubDate>2025-12-19T08:55:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585130590293000207" data-draft-id="7585377128489697332" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨Angularä¸­å®ç°åŸºäºnz-calendarçš„æ—¥å†ç”˜ç‰¹å›¾"/> <meta itemprop="keywords" content="å‰ç«¯,Angular.js"/> <meta itemprop="datePublished" content="2025-12-19T08:55:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†èŠ±"/> <meta itemprop="url" content="https://juejin.cn/user/4002664676073741"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨Angularä¸­å®ç°åŸºäºnz-calendarçš„æ—¥å†ç”˜ç‰¹å›¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4002664676073741/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†èŠ±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T08:55:45.000Z" title="Fri Dec 19 2025 08:55:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æœ€è¿‘æœ‰ä¸€ä¸ªæ—¥å†ç›¸å…³çš„åŠŸèƒ½éœ€æ±‚ï¼Œç”¨äºè®°å½•ä¸»ç«™çš„å„ç±»ä¿ƒé”€æ´»åŠ¨ã€‚</p>
<p>å…¶ä¸­æ¯”è¾ƒæ£˜æ‰‹çš„éœ€æ±‚æ˜¯æ—¥å†éœ€è¦æ‹¥æœ‰ç”˜ç‰¹å›¾é‚£æ ·çš„åŠŸèƒ½ï¼ŒæŒç»­ä¸€æ®µæ—¶é—´çš„æ´»åŠ¨éœ€è¦åœ¨æ—¥å†ä¸­ä»¥é•¿æ¡å½¢æ€æ˜¾ç¤ºï¼Œè€Œä¸åŒæ´»åŠ¨çš„æŒç»­æ—¶é—´ä¸åŒã€æ’åºé¡ºåºä¹Ÿä¸åŒï¼Œäº’ç›¸æ‹¼å‡‘ç•™ç©ºçš„é€»è¾‘éå¸¸å¤æ‚ã€‚</p>
<p>äº§å“ç»™çš„å‚è€ƒå›¾å¦‚ä¸‹ï¼ˆæ¶‰åŠå…¬å¸éšç§å°±å…¨æ‰“ç äº†ï¼‰ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9457bc2649fd4f259e73e2c0f820a369~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN6Iqx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766739345&amp;x-signature=dlPFFAZ%2FL5F%2BNgzv8vjn0jHMqqA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">æ€è·¯åˆ†æ</h2>
<p><code>ng-zorro</code>çš„æ—¥å†ç»„ä»¶ï¼ˆnz-calendarï¼‰æˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶å°æºç çœ‹å‡ºæ¥å®é™…ä¸Šæ—¥å†çš„åŸç†å°±æ˜¯ä¸€ä¸ªè¡¨æ ¼ï¼ˆtableï¼‰ï¼Œè¦åœ¨æ—¥å†å—é™çš„å•å…ƒæ ¼ç©ºé—´å†…å®ç°ç”˜ç‰¹å›¾çš„é•¿æ¡è·¨åº¦æ•ˆæœï¼Œæ ¸å¿ƒéš¾ç‚¹åœ¨äº<strong>è·¨è¡Œå¯¹é½</strong>ã€‚</p>
<blockquote>
<p>æˆ‘æœ¬æ‰“ç®—å¯»æ‰¾ä¸€ä¸ªæ‹¥æœ‰è¿™æ ·åŠŸèƒ½çš„Angularæ—¥å†ç»„ä»¶ï¼Œä½†Githubä¸Šçš„Angularæ—¥å†ç®€é™‹å¾—åƒä¸ƒå…«å¹´å‰çš„æ ·å¼ï¼ˆä»”ç»†ä¸€çœ‹æ›´æ–°æ—¥æœŸï¼ŒçœŸçš„æ˜¯ä¸ƒå…«å¹´å‰æ›´æ–°çš„ï¼ï¼‰</p>
</blockquote>
<p>å¸¸è§„æ—¥å†ç»„ä»¶çš„ <code>dateCellRender</code> æ˜¯ä»¥â€œå¤©â€ä¸ºå•ä½æ¸²æŸ“çš„ï¼Œå¦‚æœå•çº¯åœ¨æ¯ä¸€å¤©é‡Œæ¸²æŸ“å„è‡ªçš„æ´»åŠ¨ï¼Œé•¿æ¡æ´»åŠ¨ä¼šè¢«åˆ‡æ–­ã€‚ä¸ºäº†è®©é•¿æ¡åœ¨è§†è§‰ä¸Šè¿è´¯ä¸”ä¸å‡ºç°é”™ä½ï¼Œå¿…é¡»å¼•å…¥<strong>è½¨é“ç®—æ³•ï¼ˆTrack Algorithmï¼‰</strong> ï¼š</p>
<p><strong>æŒ‰å‘¨åˆ†ç±»</strong>ï¼šå°†æ—¥å†è§†å›¾åˆ†ä¸º6å‘¨ï¼Œæ¯å‘¨ä½œä¸ºä¸€ä¸ªé€»è¾‘å—ï¼Œå¦‚æœæ´»åŠ¨æ¢è¡Œï¼Œå°±å›ºå®šåœ¨ç¬¬ä¸€åˆ—ï¼ˆå‘¨ä¸€ï¼‰æ˜¾ç¤ºæ´»åŠ¨åç§°å³å¯ï¼Œè§£å†³äº†æ¯”è¾ƒæ£˜æ‰‹çš„æ¢è¡Œæ ·å¼é€»è¾‘é—®é¢˜ã€‚</p>
<p><strong>è½¨é“ç´¢å¼•</strong>ï¼šä¸ºæ¯ä¸ªæ´»åŠ¨åˆ†é…ä¸€ä¸ª<strong>å‚ç›´æ–¹å‘çš„ç´¢å¼•ï¼ˆTrack Indexï¼‰</strong> ã€‚å¦‚æœæ´»åŠ¨ A å ç”¨äº†ç¬¬ 0 å±‚è½¨é“ï¼Œé‚£ä¹ˆåŒä¸€æ—¶é—´æ®µå†…çš„æ´»åŠ¨ B åªèƒ½æ’åœ¨ç¬¬ 1 å±‚è½¨é“ã€‚</p>
<p><strong>ç­‰é«˜å ä½</strong>ï¼šå¦‚æœå‘¨ä¸€æœ‰ä¸‰ä¸ªæ´»åŠ¨ï¼ˆå ç”¨3å±‚è½¨é“ï¼‰ï¼Œè€Œå‘¨äºŒåªæœ‰ä¸€ä¸ªæ´»åŠ¨ï¼ˆå ç”¨ç¬¬2å±‚è½¨é“ï¼‰ï¼Œé‚£ä¹ˆå‘¨äºŒçš„ç¬¬ 0ã€1 å±‚å¿…é¡»æ¸²æŸ“éšè—çš„å ä½ç¬¦ï¼ˆPlaceholderï¼‰ï¼Œä»¥ç¡®ä¿å‘¨äºŒçš„æ´»åŠ¨èƒ½ä¸å‘¨ä¸€çš„ç¬¬ä¸‰ä¸ªæ´»åŠ¨åœ¨æ°´å¹³é«˜åº¦ä¸Šå¯¹é½ã€‚</p>
<h2 data-id="heading-2">æ•°æ®ç»“æ„</h2>
<p>åç«¯è¿”å›çš„æ•°æ®æ˜¯åŸºäºæ—¥æœŸçš„èšåˆç»“æ„ï¼ˆä¾‹å¦‚ <code>DateData[]</code>ï¼‰ï¼Œå³æ¯ä¸€å¤©ä¸‹é¢æŒ‚è½½ä¸€ä¸ªæ´»åŠ¨åˆ—è¡¨ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">interface</span> <span class="hljs-title">DateData</span> {
 Â date: <span class="hljs-built_in">string</span>;         <span class="hljs-comment">// æ—¥æœŸ</span>
 Â events: EventItem[];  <span class="hljs-comment">// å½“å¤©çš„æ´»åŠ¨åˆ—è¡¨</span>
}
â€‹
<span class="hljs-keyword">interface</span> <span class="hljs-title">EventItem</span> {
 Â products_activity_id: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// æ´»åŠ¨ID</span>
 Â title: <span class="hljs-built_in">string</span>;                <span class="hljs-comment">// æ´»åŠ¨åç§°</span>
 Â color_type: <span class="hljs-built_in">string</span>;           <span class="hljs-comment">// æ´»åŠ¨é¢œè‰²</span>
}
</code></pre>
<p>ä½†åœ¨ç”˜ç‰¹å›¾ä¸­ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“æ´»åŠ¨çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸã€‚å› æ­¤ï¼Œé¦–å…ˆéœ€è¦å°†æ•°æ®â€œå¹³é“ºâ€ï¼Œç”Ÿæˆä»¥æ´»åŠ¨ ID ä¸ºä¸»é”®çš„ç»“æ„ã€‚</p>
<p>ï¼ˆå¦‚æœä½ çš„æ•°æ®æ ¼å¼å·²ç»æ˜¯è¿™æ ·äº†ï¼Œå°±ä¸éœ€è¦è½¬æ¢ï¼‰</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">FlattenedEvent</span> {
 Â <span class="hljs-attr">start</span>: <span class="hljs-built_in">string</span>;<span class="hljs-comment">// æ´»åŠ¨èµ·å§‹æ—¥æœŸ</span>
 Â <span class="hljs-attr">end</span>: <span class="hljs-built_in">string</span>;  <span class="hljs-comment">// æ´»åŠ¨ç»“æŸæ—¥æœŸ</span>
 Â <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;   <span class="hljs-comment">// ID</span>
 Â <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>;<span class="hljs-comment">// æ´»åŠ¨æ ‡é¢˜</span>
 Â <span class="hljs-attr">color</span>: <span class="hljs-built_in">string</span>;<span class="hljs-comment">// æ´»åŠ¨é¢œè‰²ï¼ˆæ ¹æ®æ´»åŠ¨çŠ¶æ€æ”¹å˜ï¼‰</span>
}
â€‹
<span class="hljs-title function_">flattenEvents</span>(<span class="hljs-attr">data</span>: <span class="hljs-title class_">DateData</span>[]): <span class="hljs-title class_">FlattenedEvent</span>[] {
 Â <span class="hljs-keyword">const</span> eventMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">FlattenedEvent</span>&gt;();
 Â <span class="hljs-comment">// ç¡®ä¿æ—¥æœŸå‡åºæ’åˆ—</span>
 Â <span class="hljs-keyword">const</span> sortedData = [...data].<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(a.<span class="hljs-property">date</span>).<span class="hljs-title function_">getTime</span>() - <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(b.<span class="hljs-property">date</span>).<span class="hljs-title function_">getTime</span>());
â€‹
 Â sortedData.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">dateData</span>) =&gt;</span> {
 Â  Â dateData.<span class="hljs-property">events</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
 Â  Â  Â <span class="hljs-keyword">const</span> eventId = event.<span class="hljs-property">products_activity_id</span>;
 Â  Â  Â <span class="hljs-keyword">if</span> (eventMap.<span class="hljs-title function_">has</span>(eventId)) {
 Â  Â  Â  Â <span class="hljs-comment">// æ›´æ–°å·²æœ‰æ´»åŠ¨çš„ç»“æŸæ—¥æœŸ</span>
 Â  Â  Â  Â eventMap.<span class="hljs-title function_">get</span>(eventId)!.<span class="hljs-property">end</span> = dateData.<span class="hljs-property">date</span>;
 Â  Â   } <span class="hljs-keyword">else</span> {
 Â  Â  Â  Â <span class="hljs-comment">// è®°å½•æ–°æ´»åŠ¨</span>
 Â  Â  Â  Â eventMap.<span class="hljs-title function_">set</span>(eventId, {
 Â  Â  Â  Â  Â <span class="hljs-attr">start</span>: dateData.<span class="hljs-property">date</span>,
 Â  Â  Â  Â  Â <span class="hljs-attr">end</span>: dateData.<span class="hljs-property">date</span>,
 Â  Â  Â  Â  Â <span class="hljs-attr">id</span>: eventId,
 Â  Â  Â  Â  Â <span class="hljs-attr">title</span>: event.<span class="hljs-property">title</span>,
 Â  Â  Â  Â  Â <span class="hljs-attr">color</span>: event.<span class="hljs-property">color_type</span>,
 Â  Â  Â   });
 Â  Â   }
 Â   });
  });
 Â <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(eventMap.<span class="hljs-title function_">values</span>());
}
</code></pre>
<h2 data-id="heading-3">ä»£ç å®ç°</h2>
<h3 data-id="heading-4">è½¨é“ç®—æ³•å®ç°</h3>
<p>åœ¨ <code>generateCalendarMatrix</code> æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬è®¡ç®—å‡ºæ¯ä¸€å¤©å¯¹åº”çš„ <code>daySlots</code>ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// äº‹ä»¶æ˜ å°„è¡¨ï¼Œkeyä¸ºæ—¥æœŸå­—ç¬¦ä¸²ï¼Œvalueä¸ºè¯¥æ—¥æœŸçš„æ´»åŠ¨æ•°ç»„</span>
<span class="hljs-attr">eventsMap</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>[]&gt; = {};
â€‹
<span class="hljs-comment">// æ—¥å†çŸ©é˜µæ•°æ®ï¼Œkeyä¸ºæ—¥æœŸå­—ç¬¦ä¸²ï¼Œvalueä¸ºå½“å¤©çš„æ§½ä½æ•°ç»„ï¼ˆäº‹ä»¶+å ä½ç¬¦ï¼‰</span>
<span class="hljs-attr">calendarMatrix</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>[]&gt; = {};
â€‹
<span class="hljs-comment">// å½“å‰æ‚¬åœçš„æ´»åŠ¨IDï¼Œç”¨äºé«˜äº®æ˜¾ç¤º</span>
<span class="hljs-attr">hoveredEventId</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>; 
â€‹
<span class="hljs-comment">/**
 Â  * æ ¸å¿ƒé€»è¾‘ï¼šç”˜ç‰¹å›¾çŸ©é˜µç”Ÿæˆ
 Â  * è´Ÿè´£è®¡ç®—æ¯ä¸€å¤©åº”è¯¥æ˜¾ç¤ºå“ªäº›æ´»åŠ¨æ¡ï¼Œä»¥åŠå®ƒä»¬æ‰€åœ¨çš„â€œè½¨é“â€å±‚çº§
 Â  */</span>
<span class="hljs-title function_">generateCalendarMatrix</span>(<span class="hljs-params">events: FlattenedEvent[]</span>) {
 Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">calendarMatrix</span> = {};
 Â <span class="hljs-keyword">const</span> viewStart = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCalendarViewStart</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">month</span>); <span class="hljs-comment">// è·å–æ—¥å†ç¬¬ä¸€æ ¼æ—¥æœŸ</span>
â€‹
 Â <span class="hljs-comment">// 6å‘¨å¾ªç¯</span>
 Â <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> week = <span class="hljs-number">0</span>; week &lt; <span class="hljs-number">6</span>; week++) {
 Â  Â <span class="hljs-keyword">const</span> weekStart = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(viewStart);
 Â  Â weekStart.<span class="hljs-title function_">setDate</span>(viewStart.<span class="hljs-title function_">getDate</span>() + week * <span class="hljs-number">7</span>);
 Â  Â <span class="hljs-keyword">const</span> weekEnd = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(weekStart);
 Â  Â weekEnd.<span class="hljs-title function_">setDate</span>(weekStart.<span class="hljs-title function_">getDate</span>() + <span class="hljs-number">6</span>);
â€‹
 Â  Â <span class="hljs-comment">// ç­›é€‰å¹¶æ’åºï¼šå¼€å§‹æ—©ä¸”è·¨åº¦é•¿çš„ä¼˜å…ˆå æ®ä¸Šæ–¹è½¨é“</span>
 Â  Â <span class="hljs-keyword">const</span> weekEvents = processedEvents.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e.<span class="hljs-property">_end</span> &gt;= weekStart &amp;&amp; e.<span class="hljs-property">_start</span> &lt;= weekEnd)
 Â  Â   .<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">_start</span>.<span class="hljs-title function_">getTime</span>() - b.<span class="hljs-property">_start</span>.<span class="hljs-title function_">getTime</span>() || (b.<span class="hljs-property">_end</span> - b.<span class="hljs-property">_start</span>) - (a.<span class="hljs-property">_end</span> - a.<span class="hljs-property">_start</span>));
â€‹
 Â  Â <span class="hljs-keyword">const</span> <span class="hljs-attr">tracks</span>: <span class="hljs-built_in">any</span>[][] = [];
 Â  Â <span class="hljs-keyword">let</span> weekMaxTrackIndex = -<span class="hljs-number">1</span>;
â€‹
 Â  Â weekEvents.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> {
 Â  Â  Â <span class="hljs-keyword">const</span> eventStartDay = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">_start</span> - weekStart) / <span class="hljs-number">86400000</span>));
 Â  Â  Â <span class="hljs-keyword">const</span> eventEndDay = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-number">6</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">_end</span> - weekStart) / <span class="hljs-number">86400000</span>));
â€‹
 Â  Â  Â <span class="hljs-keyword">let</span> trackIndex = <span class="hljs-number">0</span>;
 Â  Â  Â <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (!tracks[trackIndex]) tracks[trackIndex] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">7</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-literal">null</span>);
 Â  Â  Â  Â <span class="hljs-comment">// ç¢°æ’æ£€æµ‹</span>
 Â  Â  Â  Â <span class="hljs-keyword">if</span> (tracks[trackIndex].<span class="hljs-title function_">slice</span>(eventStartDay, eventEndDay + <span class="hljs-number">1</span>).<span class="hljs-title function_">every</span>(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> v === <span class="hljs-literal">null</span>)) {
 Â  Â  Â  Â  Â <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> d = eventStartDay; d &lt;= eventEndDay; d++) {
 Â  Â  Â  Â  Â  Â tracks[trackIndex][d] = {
 Â  Â  Â  Â  Â  Â  Â event,
 Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">showTitle</span>: d === eventStartDay || d === <span class="hljs-number">0</span>, <span class="hljs-comment">// ä»…åœ¨èµ·ç‚¹æˆ–å‘¨ä¸€æ˜¾ç¤ºæ ‡é¢˜</span>
 Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">isRealStart</span>: d === <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">_start</span> - weekStart) / <span class="hljs-number">86400000</span>),
 Â  Â  Â  Â  Â  Â  Â <span class="hljs-attr">isRealEnd</span>: d === <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">_end</span> - weekStart) / <span class="hljs-number">86400000</span>)
 Â  Â  Â  Â  Â   };
 Â  Â  Â  Â   }
 Â  Â  Â  Â  Â weekMaxTrackIndex = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(weekMaxTrackIndex, trackIndex);
 Â  Â  Â  Â  Â <span class="hljs-keyword">break</span>;
 Â  Â  Â   }
 Â  Â  Â  Â trackIndex++;
 Â  Â   }
 Â   });
â€‹
 Â  Â <span class="hljs-comment">// å¡«å……çŸ©é˜µï¼šç¼ºå¤±è½¨é“è¡¥ Placeholder</span>
 Â  Â <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> day = <span class="hljs-number">0</span>; day &lt; <span class="hljs-number">7</span>; day++) {
 Â  Â  Â <span class="hljs-keyword">const</span> dateStr = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatDateKey</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(weekStart.<span class="hljs-title function_">getTime</span>() + day * <span class="hljs-number">86400000</span>));
 Â  Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">calendarMatrix</span>[dateStr] = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: weekMaxTrackIndex + <span class="hljs-number">1</span> }, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> 
 Â  Â  Â  Â tracks[i]?.[day] ? { <span class="hljs-attr">type</span>: <span class="hljs-string">'event'</span>, ...tracks[i][day] } : { <span class="hljs-attr">type</span>: <span class="hljs-string">'placeholder'</span> }
 Â  Â   );
 Â   }
  }
}
â€‹
<span class="hljs-comment">/**
 Â  * ä¿®æ­£æ—¥å†èµ·å§‹æ—¥æœŸï¼šç”±äº nz-calendar é€šå¸¸ä»å‘¨ä¸€å¼€å§‹æ˜¾ç¤ºï¼Œ
 Â  * éœ€è¦è®¡ç®—å½“å‰æœˆç¬¬ä¸€å¤©è·ç¦»è¯¥å‘¨å‘¨ä¸€çš„åç§»é‡ã€‚
 Â  */</span>
<span class="hljs-title function_">getCalendarViewStart</span>(<span class="hljs-attr">currentMonth</span>: <span class="hljs-title class_">Date</span>): <span class="hljs-title class_">Date</span> {
 Â  Â <span class="hljs-keyword">const</span> startOfMonth = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(
 Â  Â  Â  Â currentMonth.<span class="hljs-title function_">getFullYear</span>(),
 Â  Â  Â  Â currentMonth.<span class="hljs-title function_">getMonth</span>(),
 Â  Â  Â  Â <span class="hljs-number">1</span>
 Â   );
 Â  Â <span class="hljs-keyword">let</span> day = startOfMonth.<span class="hljs-title function_">getDay</span>(); <span class="hljs-comment">// 0 æ˜¯å‘¨æ—¥</span>
â€‹
 Â  Â <span class="hljs-comment">// è®¡ç®—åç§»é‡ï¼šå¦‚æœæ˜¯å‘¨æ—¥(0)ï¼Œå‰é¢æœ‰6å¤©ï¼›å…¶ä»–æƒ…å†µåˆ™æ˜¯ day-1</span>
 Â  Â <span class="hljs-keyword">const</span> offset = day === <span class="hljs-number">0</span> ? <span class="hljs-number">6</span> : day - <span class="hljs-number">1</span>;
â€‹
 Â  Â <span class="hljs-keyword">const</span> startView = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(startOfMonth);
 Â  Â startView.<span class="hljs-title function_">setDate</span>(startOfMonth.<span class="hljs-title function_">getDate</span>() - offset);
 Â  Â <span class="hljs-keyword">return</span> startView;
}
â€‹
<span class="hljs-comment">/**
 Â  * æ ¹æ®é¢œè‰²ç±»å‹è¿”å›å¯¹åº”çš„CSSé¢œè‰²å€¼
 Â  */</span>
<span class="hljs-keyword">private</span> <span class="hljs-title function_">getColor</span>(<span class="hljs-attr">type</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">string</span> {
 Â  Â <span class="hljs-keyword">const</span> <span class="hljs-attr">map</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; = {
 Â  Â  Â  Â <span class="hljs-string">'1'</span>: <span class="hljs-string">'#f5f5f5'</span>, <span class="hljs-comment">// æµ…ç° (è‰ç¨¿/æœªå¼€å§‹)</span>
 Â  Â  Â  Â <span class="hljs-string">'2'</span>: <span class="hljs-string">'#F7A4A4'</span>, <span class="hljs-comment">// æµ…çº¢ (ä¿ƒé”€ç±»å‹A)</span>
 Â  Â  Â  Â <span class="hljs-string">'3'</span>: <span class="hljs-string">'#B6E2A1'</span>, <span class="hljs-comment">// æµ…ç»¿ (ä¿ƒé”€ç±»å‹B)</span>
 Â  Â  Â  Â <span class="hljs-string">'4'</span>: <span class="hljs-string">'#bae7ff'</span>, <span class="hljs-comment">// æµ…è“ (å…¶ä»–)</span>
 Â   };
 Â  Â <span class="hljs-keyword">return</span> map[<span class="hljs-keyword">type</span>] || <span class="hljs-string">'#B6E2A1'</span>; <span class="hljs-comment">// é»˜è®¤æµ…ç»¿</span>
}
â€‹
<span class="hljs-comment">/**
 Â  * æ—¥æœŸæ ¼å¼è½¬æ¢
 Â  */</span>
<span class="hljs-title function_">formatDateKey</span>(<span class="hljs-attr">date</span>: <span class="hljs-title class_">Date</span>): <span class="hljs-built_in">string</span> {
 Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${date.getFullYear()}</span>-<span class="hljs-subst">${(date.getMonth() + <span class="hljs-number">1</span>)
 Â  Â  Â   .toString()
 Â  Â  Â   .padStart(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)}</span>-<span class="hljs-subst">${date.getDate().toString().padStart(<span class="hljs-number">2</span>, <span class="hljs-string">'0'</span>)}</span>`</span>;
}
â€‹
<span class="hljs-comment">/**
 Â  * é¼ æ ‡ç§»å…¥äº‹ä»¶å¤„ç†
 Â  */</span>
<span class="hljs-title function_">onMouseEnter</span>(<span class="hljs-params">eventId: <span class="hljs-built_in">string</span></span>) {
 Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">hoveredEventId</span> = eventId;
}
â€‹
<span class="hljs-comment">/**
 Â  * é¼ æ ‡ç§»å‡ºäº‹ä»¶å¤„ç†
 Â  */</span>
<span class="hljs-title function_">onMouseLeave</span>(<span class="hljs-params"/>) {
 Â  Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">hoveredEventId</span> = <span class="hljs-literal">null</span>;
}
</code></pre>
<h3 data-id="heading-5">æ ·å¼æ”¯æ’‘</h3>
<p>ä¸ºäº†å®ç°è§†è§‰ä¸Šçš„é•¿æ¡æ•ˆæœï¼Œéœ€è¦å¯¹ <code>nz-calendar</code> çš„é»˜è®¤æ ·å¼è¿›è¡Œæ·±åº¦è¦†ç›–ï¼Œå¹¶åˆ©ç”¨ CSS ç±»çš„é…åˆå¤„ç†åœ†è§’ã€‚</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* å®¹å™¨ï¼šå‚ç›´æ’åˆ— */</span>
<span class="hljs-selector-class">.calendar-slot-container</span> {
 Â  Â <span class="hljs-attribute">display</span>: flex;
 Â  Â <span class="hljs-attribute">flex-direction</span>: column;
}
â€‹
<span class="hljs-comment">/* æ´»åŠ¨æ¡ä¸å ä½ç¬¦ï¼šé«˜åº¦å¿…é¡»ä¸€è‡´ */</span>
<span class="hljs-selector-class">.event-slot</span>, <span class="hljs-selector-class">.placeholder</span> {
 Â  Â <span class="hljs-attribute">height</span>: <span class="hljs-number">22px</span>;
 Â  Â <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">2px</span>;
}
â€‹
<span class="hljs-selector-class">.event-bar</span> {
 Â  Â <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">0</span>; <span class="hljs-comment">/* é»˜è®¤ç›´è§’å®ç°æ— ç¼è¿æ¥ */</span>
 Â  Â <span class="hljs-attribute">border-top</span>: <span class="hljs-number">0.5px</span> lightgray solid;
 Â  Â <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">0.5px</span> lightgray solid;
}
â€‹
<span class="hljs-comment">/* ä»…åœ¨æ´»åŠ¨é€»è¾‘èµ·ç‚¹æ˜¾ç¤ºå·¦åœ†è§’ */</span>
<span class="hljs-selector-class">.event-bar</span><span class="hljs-selector-class">.is-real-start</span> {
 Â  Â <span class="hljs-attribute">border-top-left-radius</span>: <span class="hljs-number">4px</span>;
 Â  Â <span class="hljs-attribute">border-bottom-left-radius</span>: <span class="hljs-number">4px</span>;
 Â  Â <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">3px</span>;
 Â  Â <span class="hljs-attribute">border-left</span>: <span class="hljs-number">0.5px</span> lightgray solid;
}
â€‹
<span class="hljs-comment">/* ä»…åœ¨æ´»åŠ¨é€»è¾‘ç»ˆç‚¹æ˜¾ç¤ºå³åœ†è§’ */</span>
<span class="hljs-selector-class">.event-bar</span><span class="hljs-selector-class">.is-real-end</span> {
 Â  Â <span class="hljs-attribute">border-top-right-radius</span>: <span class="hljs-number">4px</span>;
 Â  Â <span class="hljs-attribute">border-bottom-right-radius</span>: <span class="hljs-number">4px</span>;
 Â  Â <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">3px</span>;
 Â  Â <span class="hljs-attribute">border-right</span>: <span class="hljs-number">0.5px</span> lightgray solid;
}
</code></pre>
<h3 data-id="heading-6">HTML æ¨¡æ¿æ¸²æŸ“</h3>
<p>åˆ©ç”¨ <code>ng-template</code> æ¸²æŸ“çŸ©é˜µæ•°æ®ï¼Œé€šè¿‡ <code>item.type</code> åŒºåˆ†æ¸²æŸ“å®ä½“æ´»åŠ¨è¿˜æ˜¯å ä½ç¬¦ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">&lt;nz-card <span class="hljs-section">[nzTitle]</span>="getYearMonth(date)"&gt;
 Â  Â &lt;nz-calendar <span class="hljs-section">[(ngModel)]</span>="date" (ngModelChange)="onCalendarChange($event)" <span class="hljs-section">[nzDateCell]</span>="tpl"
 Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-section">[nzCustomHeader]</span>="customHeader"&gt;
 Â  Â &lt;/nz-calendar&gt;
â€‹
 Â  Â &lt;ng-template <span class="hljs-comment">#customHeader&gt;</span>
 Â  Â  Â  Â &lt;div <span class="hljs-attr">style</span>=<span class="hljs-string">"padding: 4px;width: 100%;"</span> nz-flex nzJustify=<span class="hljs-string">"end"</span>&gt;&lt;/div&gt;
 Â  Â &lt;/ng-template&gt;
â€‹
 Â  Â &lt;ng-template <span class="hljs-comment">#tpl let-date&gt;</span>
 Â  Â  Â  Â &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"calendar-slot-container"</span>&gt;
 Â  Â  Â  Â  Â   @for (item of dateCellRender(date)<span class="hljs-comment">; track $index) {</span>
 Â  Â  Â  Â  Â   @if (<span class="hljs-attr">item.type</span> === <span class="hljs-string">'placeholder'</span>) {
 Â  Â  Â  Â  Â  Â &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"placeholder"</span>&gt;&lt;/div&gt;
 Â  Â  Â  Â  Â   } @else {
 Â  Â  Â  Â  Â  Â &lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"event-slot event-bar"</span>
 Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-section">[style.background-color]</span>="<span class="hljs-attr">hoveredEventId</span> === item.event.id ? <span class="hljs-string">'#1890FF'</span> : item.event.color<span class="hljs-string">"
 Â  Â  Â  Â  Â  Â  Â  Â  [class.is-real-start]="</span>item.isRealStart<span class="hljs-string">" [class.is-real-end]="</span>item.isRealEnd<span class="hljs-string">"
 Â  Â  Â  Â  Â  Â  Â  Â  [class.is-hovered]="</span>hoveredEventId === item.event.id<span class="hljs-string">" (mouseenter)="</span><span class="hljs-literal">on</span>MouseEnter(item.event.id)<span class="hljs-string">"
 Â  Â  Â  Â  Â  Â  Â  Â  (mouseleave)="</span><span class="hljs-literal">on</span>MouseLeave()<span class="hljs-string">"&gt;
â€‹
 Â  Â  Â  Â  Â  Â  Â   @if (item.showTitle) {
 Â  Â  Â  Â  Â  Â  Â  Â &lt;span class="</span>event-title<span class="hljs-string">" [style.color]="</span>hoveredEventId === item.event.id ? <span class="hljs-string">'white'</span> : <span class="hljs-string">'#000'</span><span class="hljs-string">"&gt;
 Â  Â  Â  Â  Â  Â  Â  Â  Â   {{ item.event.title }}
 Â  Â  Â  Â  Â  Â  Â  Â &lt;/span&gt;
 Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â  Â &lt;/div&gt;
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â   }
 Â  Â  Â  Â &lt;/div&gt;
 Â  Â &lt;/ng-template&gt;
&lt;/nz-card&gt;
</span></code></pre>
<h2 data-id="heading-7">æˆå“</h2>
<p><strong>å›¾ä¸­å‡ä¸ºæµ‹è¯•æ•°æ®ï¼Œä¸å…·å¤‡ä»»ä½•çœŸå®æ€§å’Œéšç§ã€‚</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1155e53a814d4866b34514ca4f5e0b12~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN6Iqx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766739345&amp;x-signature=Hlc%2BwH09CtUjfO2pMWoaUu0u6wk%3D" alt="" loading="lazy"/></p>
<p>å¦‚å›¾ä¸­å±•ç¤ºï¼Œæ¯ä¸ªæ´»åŠ¨çš„è½¨é“å±•ç¤ºæ­£å¸¸ï¼Œç©ºç™½ç¬¦æ¸²æŸ“åˆç†ï¼Œå¹¶ä¸”ä¼šæ ¹æ®çŠ¶æ€æ¸²æŸ“å¯¹åº”çš„é¢œè‰²ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ae399614f8c43ab84254121ca3b85ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YaN6Iqx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766739345&amp;x-signature=A30dtr1Y%2BWqRy1ojkSiHxBEjjUo%3D" alt="" loading="lazy"/></p>
<p>å¦‚å›¾ä¸­å±•ç¤ºï¼Œé¼ æ ‡ç§»å…¥åï¼Œæ—¥å†ä¸­å¯¹åº”çš„æ´»åŠ¨å‡ä¼šé«˜äº®ï¼Œå³ä½¿è·¨å‘¨ä¹Ÿä¼šæ˜¾ç¤ºã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[KnowFlow v2.3.0 é‡ç£…å‘å¸ƒï¼šé€‚é… RAGFlow v0.22.1 å’Œ MinerU v2.6.5ã€æ–°å¢æ”¯æŒå¤šæ¨¡æ€è§†é¢‘è§£æï¼Œè®©çŸ¥è¯†åº“"çœ‹è§"æ›´å¤š]]></title>    <link>https://juejin.cn/post/7585138968167628836</link>    <guid>https://juejin.cn/post/7585138968167628836</guid>    <pubDate>2025-12-19T09:00:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585138968167628836" data-draft-id="7585171571129663524" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="KnowFlow v2.3.0 é‡ç£…å‘å¸ƒï¼šé€‚é… RAGFlow v0.22.1 å’Œ MinerU v2.6.5ã€æ–°å¢æ”¯æŒå¤šæ¨¡æ€è§†é¢‘è§£æï¼Œè®©çŸ¥è¯†åº“&quot;çœ‹è§&quot;æ›´å¤š"/> <meta itemprop="keywords" content="GitHub,Linux"/> <meta itemprop="datePublished" content="2025-12-19T09:00:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="KnowFlowä¼ä¸šçŸ¥è¯†åº“"/> <meta itemprop="url" content="https://juejin.cn/user/247809349269395"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            KnowFlow v2.3.0 é‡ç£…å‘å¸ƒï¼šé€‚é… RAGFlow v0.22.1 å’Œ MinerU v2.6.5ã€æ–°å¢æ”¯æŒå¤šæ¨¡æ€è§†é¢‘è§£æï¼Œè®©çŸ¥è¯†åº“"çœ‹è§"æ›´å¤š
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/247809349269395/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    KnowFlowä¼ä¸šçŸ¥è¯†åº“
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T09:00:20.000Z" title="Fri Dec 19 2025 09:00:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>KnowFlow v2.3.0 æ­£å¼å‘å¸ƒï¼æœ¬ç‰ˆæœ¬å¸¦æ¥ä¸‰å¤§é‡ç£…æ›´æ–°ï¼š<strong>å¤šæ¨¡æ€è§†é¢‘è§£æèƒ½åŠ›</strong>ã€é€‚é… RAGFlow v0.22.1 ï¼ŒMinerU v2.6.5 ã€PaddleOCR æ”¯æŒè¿è¡Œæ—¶é…ç½®ã€‚æˆ‘ä»¬è‡´åŠ›äºå°†éç»“æ„åŒ–æ•°æ®æ²»ç†æˆå¯¹å¤§æ¨¡å‹æ›´å¯ä¿¡çš„è¾“å…¥ï¼Œæœ¬æ¬¡æ›´æ–°æ ‡å¿—ç€ KnowFlow æ­£å¼è¿ˆå…¥å¤šæ¨¡æ€æ—¶ä»£ã€‚</p>
<blockquote>
<p>KnowFlow æ˜¯ä¸“æ³¨äºç§æœ‰åŒ–é«˜å‡†ç¡®ç‡çš„ä¼ä¸šçº§çŸ¥è¯†åº“äº§å“ï¼Œè‡´åŠ›äºæ„å»º AI æ—¶ä»£çš„æ•°æ®æ ¹åŸºã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">æ–°åŠŸèƒ½</h2>
<h3 data-id="heading-2">1. å¤šæ¨¡æ€è§†é¢‘è§£æï¼šè®©çŸ¥è¯†åº“"çœ‹è§"è§†é¢‘</h3>
<p>v2.3.0 æœ€å¤§çš„çªç ´æ˜¯<strong>åŸç”Ÿæ”¯æŒè§†é¢‘æ–‡ä»¶çš„æ™ºèƒ½åˆ†å—ä¸æ£€ç´¢</strong>ã€‚è¿™æ„å‘³ç€ä¼ä¸šç§¯ç´¯çš„åŸ¹è®­è§†é¢‘ã€ä¼šè®®å½•åƒã€äº§å“æ¼”ç¤ºç­‰è§†é¢‘èµ„äº§ï¼Œç°åœ¨å¯ä»¥åƒæ–‡æ¡£ä¸€æ ·è¢«ç²¾å‡†æ£€ç´¢å’Œç†è§£ã€‚</p>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img6@main/2025/12/18/1766053391868-8023b557-0fc6-477e-90e7-3ded537e6524.png" alt="" loading="lazy"/></p>
<h4 data-id="heading-3">æŠ€æœ¯æ¶æ„æ€»è§ˆ</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span>                    <span class="hljs-string">KnowFlow</span> <span class="hljs-string">è§†é¢‘è§£æäº”é˜¶æ®µæµæ°´çº¿</span>                  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="hljs-string">â”‚</span>                                                                 <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>   <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>   <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>   <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>     <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span> <span class="hljs-string">Stage</span> <span class="hljs-number">1</span>  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span> <span class="hljs-string">Stage</span> <span class="hljs-number">2</span>  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span> <span class="hljs-string">Stage</span> <span class="hljs-number">3</span>  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span> <span class="hljs-string">Stage</span> <span class="hljs-number">4</span>  <span class="hljs-string">â”‚</span>     <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span> <span class="hljs-string">ASR</span> <span class="hljs-string">ä¼˜å…ˆ</span> <span class="hljs-string">â”‚â”€â”€â–¶â”‚</span> <span class="hljs-string">å…³é”®å¸§</span>   <span class="hljs-string">â”‚â”€â”€â–¶â”‚</span> <span class="hljs-string">æ™ºèƒ½åˆ‡ç‰‡</span> <span class="hljs-string">â”‚â”€â”€â–¶â”‚</span> <span class="hljs-string">VLM</span> <span class="hljs-string">æè¿°</span> <span class="hljs-string">â”‚</span>     <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>          <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span> <span class="hljs-string">æå–</span>     <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span> <span class="hljs-string">ç”Ÿæˆ</span>     <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>          <span class="hljs-string">â”‚</span>     <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>   <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>   <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>   <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>     <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>       <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>            <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>       <span class="hljs-string">â–¼</span>              <span class="hljs-string">â–¼</span>              <span class="hljs-string">â–¼</span>              <span class="hljs-string">â–¼</span>            <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>                      <span class="hljs-attr">Stage 5:</span> <span class="hljs-string">Chunk</span> <span class="hljs-string">ç»„è£…</span>                  <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>     <span class="hljs-string">ASRæ–‡æœ¬</span> <span class="hljs-string">+</span> <span class="hljs-string">VLMæè¿°</span> <span class="hljs-string">+</span> <span class="hljs-string">å…³é”®å¸§</span> <span class="hljs-string">+</span> <span class="hljs-string">æ—¶é—´æˆ³</span> <span class="hljs-string">â†’</span> <span class="hljs-string">å‘é‡åŒ–å­˜å‚¨</span>       <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                                                                 <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre>
<h4 data-id="heading-4">æ ¸å¿ƒæŠ€æœ¯æ·±åº¦å‰–æ</h4>
<h5 data-id="heading-5">Stage 1ï¼šASR ä¼˜å…ˆç­–ç•¥</h5>
<p>ASRï¼ˆè‡ªåŠ¨è¯­éŸ³è¯†åˆ«ï¼‰æ˜¯è§†é¢‘ RAG çš„<strong>æ ¸å¿ƒè¾“å…¥</strong>ï¼Œç›´æ¥å†³å®šæ£€ç´¢è´¨é‡ã€‚æˆ‘ä»¬é‡‡ç”¨ <strong>ASR ä¼˜å…ˆ</strong> ç­–ç•¥ï¼Œåœ¨è§£ææµç¨‹æœ€å‰ç«¯å®Œæˆå…¨è§†é¢‘è½¬å½•ã€‚</p>
<pre><code class="hljs language-sql" lang="sql">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Whisper ASR å¼•æ“                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   è§†é¢‘æ–‡ä»¶                                                   â”‚
â”‚      â”‚                                                      â”‚
â”‚      â–¼  ffmpeg æå–éŸ³é¢‘                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚  PCM <span class="hljs-number">16</span>kHz å•å£°é“ WAV               â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                     â”‚                                       â”‚
â”‚                     â–¼  Whisper <span class="hljs-keyword">Large</span><span class="hljs-operator">-</span>V3                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚  ASRResult {                        â”‚                   â”‚
â”‚   â”‚    text: "å®Œæ•´è½¬å½•æ–‡æœ¬",             â”‚                   â”‚
â”‚   â”‚    segments: [                      â”‚                   â”‚
â”‚   â”‚      {<span class="hljs-keyword">start</span>: <span class="hljs-number">0.0</span>, <span class="hljs-keyword">end</span>: <span class="hljs-number">3.5</span>,         â”‚                   â”‚
â”‚   â”‚       text: "æ¬¢è¿æ¥åˆ°æœ¬æ¬¡åŸ¹è®­"},     â”‚                   â”‚
â”‚   â”‚      {<span class="hljs-keyword">start</span>: <span class="hljs-number">3.5</span>, <span class="hljs-keyword">end</span>: <span class="hljs-number">7.2</span>,         â”‚                   â”‚
â”‚   â”‚       text: "ä»Šå¤©æˆ‘ä»¬è®¨è®º..."},      â”‚                   â”‚
â”‚   â”‚    ],                               â”‚                   â”‚
â”‚   â”‚    <span class="hljs-keyword">language</span>: "zh"                   â”‚                   â”‚
â”‚   â”‚  }                                  â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                             â”‚
â”‚   âœ“ å¸¦æ—¶é—´æˆ³çš„åˆ†æ®µæ–‡æœ¬    âœ“ è‡ªåŠ¨è¯­è¨€æ£€æµ‹    âœ“ å¤šè¯­è¨€æ”¯æŒ    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>æŠ€æœ¯äº®ç‚¹</strong>ï¼š</p>
<ul>
<li>åŸºäº OpenAI Whisper Large-V3ï¼Œæ”¯æŒ 99 ç§è¯­è¨€</li>
<li>è¿”å›<strong>å¸¦æ—¶é—´æˆ³çš„åˆ†æ®µæ–‡æœ¬</strong>ï¼Œç²¾ç¡®åˆ° 0.1 ç§’</li>
<li>ä¸ºåç»­æ™ºèƒ½åˆ‡ç‰‡æä¾›è¯­ä¹‰è¾¹ç•Œä¾æ®</li>
</ul>
<h5 data-id="heading-6">Stage 2ï¼šå…³é”®å¸§æ™ºèƒ½æå–</h5>
<p>é‡‡ç”¨ <strong>"å›ºå®šå¸§ç‡æŠ½æ · + ç›¸ä¼¼åº¦å»é‡"</strong> åŒé‡ç­–ç•¥ï¼Œåœ¨ä¿è¯è¦†ç›–ç‡çš„åŒæ—¶å¤§å¹…é™ä½å†—ä½™ã€‚</p>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img2@main/2025/12/18/1766053643448-ec599fa9-2437-4ba6-936f-c10965354919.png" alt="" loading="lazy"/></p>
<pre><code class="hljs language-ini" lang="ini">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å…³é”®å¸§æå–ç®—æ³•                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   Step 1: å›ºå®šå¸§ç‡æŠ½æ · (1 fps)                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚  60ç§’è§†é¢‘ â†’ 60å¸§å€™é€‰                 â”‚                   â”‚
â”‚   â”‚  <span class="hljs-section">[F0]</span> <span class="hljs-section">[F1]</span> <span class="hljs-section">[F2]</span> ... <span class="hljs-section">[F59]</span>           â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                     â”‚                                       â”‚
â”‚                     â–¼                                       â”‚
â”‚   Step 2: ç›¸ä¼¼åº¦è®¡ç®— (HSV ç›´æ–¹å›¾ / SSIM)                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚  similarity(F<span class="hljs-section">[i]</span>, F<span class="hljs-section">[i-1]</span>) &gt; 0.85?   â”‚                   â”‚
â”‚   â”‚  â”œâ”€ Yes â†’ æ ‡è®°ä¸ºå†—ä½™å¸§ï¼Œè·³è¿‡         â”‚                   â”‚
â”‚   â”‚  â””â”€ No  â†’ ä¿ç•™ä¸ºå…³é”®å¸§               â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                     â”‚                                       â”‚
â”‚                     â–¼                                       â”‚
â”‚   Step 3: å»é‡åå…³é”®å¸§                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚  60å¸§ â†’ 8~15å¸§ (å…¸å‹å‹ç¼©ç‡ 75%+)     â”‚                   â”‚
â”‚   â”‚  <span class="hljs-section">[KF0:0s]</span> <span class="hljs-section">[KF1:5s]</span> <span class="hljs-section">[KF2:12s]</span> ...    â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>ç›¸ä¼¼åº¦ç®—æ³•å¯¹æ¯”</strong>ï¼š</p>


























<table><thead><tr><th>ç®—æ³•</th><th>åŸç†</th><th>é€Ÿåº¦</th><th>ç²¾åº¦</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>HSV ç›´æ–¹å›¾</td><td>é¢œè‰²åˆ†å¸ƒç›¸å…³æ€§</td><td>æå¿«</td><td>ä¸­ç­‰</td><td>é€šç”¨åœºæ™¯ï¼ˆé»˜è®¤ï¼‰</td></tr><tr><td>SSIM</td><td>ç»“æ„ç›¸ä¼¼æ€§æŒ‡æ•°</td><td>è¾ƒæ…¢</td><td>é«˜</td><td>å¯¹ç”»è´¨æ•æ„Ÿåœºæ™¯</td></tr></tbody></table>
<h5 data-id="heading-7">Stage 3ï¼šæ™ºèƒ½åˆ‡ç‰‡ç”Ÿæˆï¼ˆæ ¸å¿ƒåˆ›æ–°ï¼‰</h5>
<p>è¿™æ˜¯ KnowFlow è§†é¢‘è§£æçš„<strong>æ ¸å¿ƒæŠ€æœ¯å£å’</strong>ã€‚å‚è€ƒé˜¿é‡Œäº‘è§†é¢‘ RAG æ–¹æ¡ˆï¼Œå®ç°å››æ­¥æ™ºèƒ½åˆ‡ç‰‡ï¼š</p>
<pre><code class="hljs language-less" lang="less">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å››æ­¥æ™ºèƒ½åˆ‡ç‰‡ç®—æ³•                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   <span class="hljs-selector-tag">Step</span> <span class="hljs-number">1</span>: å…³é”®å¸§ â†’ åˆå§‹ç‰‡æ®µ                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚  æ¯ä¸ªå…³é”®å¸§å¯¹åº”ä¸€ä¸ªåˆå§‹ç‰‡æ®µ           â”‚                   â”‚
â”‚   â”‚  <span class="hljs-selector-attr">[0-5s]</span> <span class="hljs-selector-attr">[5-12s]</span> <span class="hljs-selector-attr">[12-18s]</span> <span class="hljs-selector-attr">[18-25s]</span>...â”‚                   â”‚
â”‚   â”‚  (å¯èƒ½äº§ç”Ÿå¤§é‡ç¢ç‰‡åŒ–ç‰‡æ®µ)            â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                     â”‚                                       â”‚
â”‚                     â–¼                                       â”‚
â”‚   <span class="hljs-selector-tag">Step</span> <span class="hljs-number">2</span>: <span class="hljs-selector-tag">ASR</span> è¯­ä¹‰åˆå¹¶                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚  æ£€æµ‹å¥å­è¾¹ç•Œï¼š                      â”‚                   â”‚
â”‚   â”‚  â€¢ å‰ç‰‡æ®µæœªä»¥å¥å·ç»“å°¾ â†’ åˆå¹¶         â”‚                   â”‚
â”‚   â”‚  â€¢ åç‰‡æ®µä»¥è¿æ¥è¯å¼€å¤´ â†’ åˆå¹¶         â”‚                   â”‚
â”‚   â”‚    (<span class="hljs-string">"è€Œä¸”"</span>/<span class="hljs-string">"ä½†æ˜¯"</span>/<span class="hljs-string">"and"</span>/<span class="hljs-string">"but"</span>)      â”‚                   â”‚
â”‚   â”‚                                     â”‚                   â”‚
â”‚   â”‚  <span class="hljs-selector-attr">[0-5s]</span> + <span class="hljs-selector-attr">[5-12s]</span> â†’ <span class="hljs-selector-attr">[0-12s]</span>         â”‚                   â”‚
â”‚   â”‚  (è¯­ä¹‰å®Œæ•´çš„å¥å­ä¸è¢«åˆ‡æ–­)            â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                     â”‚                                       â”‚
â”‚                     â–¼                                       â”‚
â”‚   <span class="hljs-selector-tag">Step</span> <span class="hljs-number">3</span>: æ—¶é—´çª—å£åˆå¹¶                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚  çŸ­äº <span class="hljs-number">10</span> ç§’çš„ç‰‡æ®µ â†’ ä¸é‚»è¿‘ç‰‡æ®µåˆå¹¶    â”‚                   â”‚
â”‚   â”‚  å½¢æˆæ›´å¤§çš„è¯­ä¹‰å•å…ƒ                  â”‚                   â”‚
â”‚   â”‚                                     â”‚                   â”‚
â”‚   â”‚  <span class="hljs-selector-attr">[0-12s]</span> + <span class="hljs-selector-attr">[12-18s]</span> â†’ <span class="hljs-selector-attr">[0-18s]</span>       â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                     â”‚                                       â”‚
â”‚                     â–¼                                       â”‚
â”‚   <span class="hljs-selector-tag">Step</span> <span class="hljs-number">4</span>: é•¿ç‰‡æ®µæ‹†åˆ†                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚  è¶…è¿‡ <span class="hljs-number">60</span> ç§’çš„ç‰‡æ®µï¼š                  â”‚                   â”‚
â”‚   â”‚  â€¢ ä¼˜å…ˆåœ¨ <span class="hljs-selector-tag">ASR</span> å¥å­è¾¹ç•Œå¤„æ‹†åˆ†         â”‚                   â”‚
â”‚   â”‚  â€¢ æ— åˆé€‚è¾¹ç•Œåˆ™å‡åŒ€æ‹†åˆ†              â”‚                   â”‚
â”‚   â”‚                                     â”‚                   â”‚
â”‚   â”‚  <span class="hljs-selector-attr">[0-90s]</span> â†’ <span class="hljs-selector-attr">[0-45s]</span> + <span class="hljs-selector-attr">[45-90s]</span>       â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                             â”‚
â”‚   æœ€ç»ˆè¾“å‡ºï¼š<span class="hljs-number">10</span>~<span class="hljs-number">60</span>ç§’çš„è¯­ä¹‰å®Œæ•´ç‰‡æ®µ                            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ</strong></p>






























<table><thead><tr><th>é—®é¢˜</th><th>ä¼ ç»Ÿæ–¹æ¡ˆ</th><th>KnowFlow æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>ç‰‡æ®µè¿‡ç¢</td><td>å›ºå®šæ—¶é•¿åˆ‡åˆ†ï¼ˆå¦‚30ç§’ï¼‰</td><td>ASR è¯­ä¹‰åˆå¹¶ï¼Œä¿è¯å¥å­å®Œæ•´</td></tr><tr><td>è¯­ä¹‰æ–­è£‚</td><td>æœºæ¢°åˆ‡å‰²å¯¼è‡´ä¸Šä¸‹æ–‡ä¸¢å¤±</td><td>æ£€æµ‹è¿æ¥è¯ï¼Œå»¶ç»­æ€§åˆ¤æ–­</td></tr><tr><td>ç‰‡æ®µè¿‡é•¿</td><td>æ— æ³•ç²¾å‡†å®šä½</td><td>åŸºäºå¥å­è¾¹ç•Œæ™ºèƒ½æ‹†åˆ†</td></tr><tr><td>æ—¶é—´é—´éš™</td><td>å¯èƒ½é—æ¼å†…å®¹</td><td>å…¨è¦†ç›–éªŒè¯ + è‡ªåŠ¨è¡¥å…¨</td></tr></tbody></table>
<h5 data-id="heading-8">Stage 4ï¼šVLM è§†è§‰æè¿°</h5>
<p>ä¸ºæ¯ä¸ªç‰‡æ®µçš„å…³é”®å¸§ç”Ÿæˆç»“æ„åŒ–æè¿°ï¼Œä¸ ASR æ–‡æœ¬å½¢æˆ<strong>è§†å¬åŒé€šé“</strong>è¯­ä¹‰å¢å¼ºã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    VLM æ‰¹é‡æè¿°ç”Ÿæˆ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   è¾“å…¥ï¼šç‰‡æ®µå†…æ‰€æœ‰å…³é”®å¸§ + ASR ä¸Šä¸‹æ–‡                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚  Prompt:                            â”‚                   â”‚
â”‚   â”‚  <span class="hljs-string">"è¿™æ˜¯è§†é¢‘ [00:15-00:45] çš„ç”»é¢ï¼Œ   â”‚                   â”‚
â”‚   â”‚   è¯­éŸ³å†…å®¹ï¼š'ä»Šå¤©æˆ‘ä»¬è®¨è®ºäº§å“æ¶æ„'   â”‚                   â”‚
â”‚   â”‚   è¯·æè¿°ç”»é¢å†…å®¹..."</span>                â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                     â”‚                                       â”‚
â”‚                     â–¼                                       â”‚
â”‚   è¾“å‡ºï¼šç»“æ„åŒ–æè¿°                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚  <span class="hljs-number">1.</span> ä¸»é¢˜ï¼šäº§å“æ¶æ„æ¼”ç¤º               â”‚                   â”‚
â”‚   â”‚  <span class="hljs-number">2.</span> å†…å®¹æ‘˜è¦ï¼šæ¼”è®²è€…ç«™åœ¨ç™½æ¿å‰ï¼Œ     â”‚                   â”‚
â”‚   â”‚     ç»˜åˆ¶ç³»ç»Ÿæ¶æ„å›¾ï¼ŒåŒ…å«ä¸‰ä¸ªæ¨¡å—...  â”‚                   â”‚
â”‚   â”‚  <span class="hljs-number">3.</span> å…³é”®è¦ç‚¹ï¼š                       â”‚                   â”‚
â”‚   â”‚     - å¾®æœåŠ¡æ¶æ„è®¾è®¡                 â”‚                   â”‚
â”‚   â”‚     - API ç½‘å…³å±‚                     â”‚                   â”‚
â”‚   â”‚     - æ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆ                 â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>ASR + VLM èåˆä¼˜åŠ¿</strong>ï¼š</p>




















<table><thead><tr><th>å•ä¸€æ¨¡æ€</th><th>å±€é™æ€§</th><th>èåˆåæ•ˆæœ</th></tr></thead><tbody><tr><td>ä»… ASR</td><td>æ— æ³•ç†è§£ç”»é¢å†…å®¹ï¼ˆå¦‚å›¾è¡¨ã€æ¼”ç¤ºï¼‰</td><td>ASR æä¾›è¯­ä¹‰ä¸»çº¿ + VLM è¡¥å……è§†è§‰ç»†èŠ‚</td></tr><tr><td>ä»… VLM</td><td>æ— æ³•è·å–è¯­éŸ³ä¿¡æ¯ï¼ˆå¦‚æ—ç™½ã€å¯¹è¯ï¼‰</td><td>VLM ç†è§£"è¯´çš„æ˜¯ä»€ä¹ˆ"çš„ä¸Šä¸‹æ–‡</td></tr></tbody></table>
<h5 data-id="heading-9">Stage 5ï¼šChunk ç»„è£…ä¸å­˜å‚¨</h5>
<pre><code class="hljs language-php" lang="php">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è§†é¢‘ Chunk æ•°æ®ç»“æ„                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   {                                                         â”‚
â”‚     <span class="hljs-string">"doc_type"</span>: <span class="hljs-string">"video_segment"</span>,                            â”‚
â”‚     <span class="hljs-string">"video_start"</span>: <span class="hljs-number">15.0</span>,           <span class="hljs-comment">// å¼€å§‹æ—¶é—´ï¼ˆç§’ï¼‰         â”‚</span>
â”‚     <span class="hljs-string">"video_end"</span>: <span class="hljs-number">45.0</span>,             <span class="hljs-comment">// ç»“æŸæ—¶é—´ï¼ˆç§’ï¼‰         â”‚</span>
â”‚     <span class="hljs-string">"segment_idx"</span>: <span class="hljs-number">3</span>,              <span class="hljs-comment">// ç‰‡æ®µåºå·              â”‚</span>
â”‚                                                             â”‚
â”‚     <span class="hljs-string">"content"</span>: <span class="hljs-string">"                                            â”‚
â”‚       è¯­éŸ³å†…å®¹: ä»Šå¤©æˆ‘ä»¬è®¨è®ºäº§å“æ¶æ„è®¾è®¡...                  â”‚
â”‚       ç”»é¢æè¿°: æ¼”è®²è€…ç«™åœ¨ç™½æ¿å‰ç»˜åˆ¶ç³»ç»Ÿæ¶æ„å›¾...            â”‚
â”‚       æ—¶é—´æ®µ: 00:15-00:45                                   â”‚
â”‚     "</span>,                                                      â”‚
â”‚                                                             â”‚
â”‚     <span class="hljs-string">"video"</span>: &lt;<span class="hljs-keyword">binary</span>&gt;,             <span class="hljs-comment">// è§†é¢‘ç‰‡æ®µå­˜å‚¨åˆ° MinIO   â”‚</span>
â”‚     <span class="hljs-string">"image"</span>: &lt;PIL.Image&gt;,          <span class="hljs-comment">// ç¼©ç•¥å›¾                 â”‚</span>
â”‚     <span class="hljs-string">"keyframes_json"</span>: <span class="hljs-string">"[...]"</span>      <span class="hljs-comment">// ç»“æ„åŒ–å…³é”®å¸§æ•°æ®       â”‚</span>
â”‚   }                                                         â”‚
â”‚                                                             â”‚
â”‚   å­˜å‚¨ï¼šES/Infinity å‘é‡ç´¢å¼• + MinIO å¯¹è±¡å­˜å‚¨               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-10">æ ¸å¿ƒèƒ½åŠ›æ€»ç»“</h4>






























<table><thead><tr><th>èƒ½åŠ›</th><th>æŠ€æœ¯å®ç°</th><th>ä¸šåŠ¡ä»·å€¼</th></tr></thead><tbody><tr><td>æ™ºèƒ½åœºæ™¯åˆ‡åˆ†</td><td>ASR è¯­ä¹‰è¾¹ç•Œ + æ—¶é—´çª—å£åˆå¹¶</td><td>ä¿è¯è¯­ä¹‰å®Œæ•´ï¼Œé¿å…ä¿¡æ¯æ–­è£‚</td></tr><tr><td>åŒæ¨¡æ€ç†è§£</td><td>Whisper ASR + VLM è§†è§‰æè¿°</td><td>è§†å¬èåˆï¼Œå…¨é¢ç†è§£è§†é¢‘å†…å®¹</td></tr><tr><td>ç²¾å‡†å®šä½</td><td>å¸¦æ—¶é—´æˆ³çš„ Chunk ç»“æ„</td><td>æ£€ç´¢ç»“æœç›´è¾¾å…·ä½“æ—¶é—´æ®µ</td></tr><tr><td>å…³é”®å¸§å»é‡</td><td>HSV ç›´æ–¹å›¾ / SSIM ç›¸ä¼¼åº¦</td><td>é™ä½å­˜å‚¨æˆæœ¬ï¼Œæå‡å¤„ç†æ•ˆç‡</td></tr></tbody></table>
<h4 data-id="heading-11">åº”ç”¨åœºæ™¯</h4>
<ul>
<li>ğŸ“¹ <strong>ä¼ä¸šåŸ¹è®­</strong>ï¼šå¿«é€Ÿå®šä½åŸ¹è®­è§†é¢‘ä¸­çš„çŸ¥è¯†ç‚¹ï¼Œæ”¯æŒ"å¦‚ä½•é…ç½® API ç½‘å…³"ç±»è‡ªç„¶è¯­è¨€æ£€ç´¢</li>
<li>ğŸ¬ <strong>ä¼šè®®å›æ”¾</strong>ï¼šæœç´¢"å…³äºé¢„ç®—çš„è®¨è®º"ï¼Œç›´è¾¾å…·ä½“å‘è¨€ç‰‡æ®µ</li>
<li>ğŸ­ <strong>äº§çº¿ç›‘æ§</strong>ï¼šå¼‚å¸¸äº‹ä»¶çš„æ™ºèƒ½æ£€ç´¢ä¸å›æº¯ï¼Œç»“åˆ VLM ç†è§£ç”»é¢å†…å®¹</li>
<li>ğŸ“º <strong>åª’èµ„ç®¡ç†</strong>ï¼šæµ·é‡è§†é¢‘ç´ æçš„è¯­ä¹‰åŒ–æ£€ç´¢ä¸å†…å®¹ç†è§£</li>
</ul>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img0@main/2025/12/18/1766051345419-d8f5dc99-d3b9-49bb-bb15-5c1406b2195c.png" alt="" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-12">2. å…¨æ–° UI è®¾è®¡ä½“éªŒ</h3>
<h4 data-id="heading-13">å…¨æ–° UI è®¾è®¡</h4>
<p>é€‚é… <strong>RAGFlow v0.22.1</strong>ï¼ŒKnowFlow è¿æ¥å…¨é¢çš„è§†è§‰å‡çº§ï¼š</p>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img17@main/2025/12/18/1766053694151-e182abca-ddab-40ef-9dbc-48c774a69261.png" alt="" loading="lazy"/></p>
<h4 data-id="heading-14">RBAC æƒé™ç®¡ç†å‡çº§</h4>
<p>æƒé™ç®¡ç†ç³»ç»Ÿé€‚é…è‡³ KnowFlow ç®¡ç†åå°ï¼š</p>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img3@main/2025/12/18/1766053731689-126f7f61-9333-4e7b-b14e-a4577a5e8bbf.png" alt="" loading="lazy"/></p>
<ul>
<li>ç»Ÿä¸€çš„ç”¨æˆ·/è§’è‰²/æƒé™é…ç½®å…¥å£</li>
<li>ç»†ç²’åº¦çš„çŸ¥è¯†åº“è®¿é—®æ§åˆ¶</li>
<li>å®Œæ•´çš„æ“ä½œå®¡è®¡æ—¥å¿—</li>
</ul>
<hr/>
<h3 data-id="heading-15">3. MinerU v2.6.5 è¿è¡Œæ—¶é…ç½®</h3>
<p>MinerU å‡çº§è‡³ v2.6.5 ç‰ˆæœ¬ï¼Œæœ€å¤§çš„æ”¹å˜æ˜¯<strong>æ”¯æŒä»æ¨¡å‹ç«¯è¿è¡Œæ—¶é…ç½®</strong>ï¼Œé™ä½éƒ¨ç½²å¤æ‚åº¦ï¼š</p>
<p><img src="https://fastly.jsdelivr.net/gh/bucketio/img7@main/2025/12/18/1766053556962-2ba5df9b-9687-4e6e-a1d3-f59192eb1507.png" alt="" loading="lazy"/></p>
<pre><code class="hljs">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  è¿è¡Œæ—¶é…ç½®æ¶æ„                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚   â”‚  KnowFlow å‰ç«¯  â”‚                                       â”‚
â”‚   â”‚   é…ç½®é¢æ¿      â”‚                                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚            â”‚ API è°ƒç”¨                                       â”‚
â”‚            â–¼                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â”‚        MinerU / PaddleOCR æœåŠ¡       â”‚                   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                   â”‚
â”‚   â”‚  â”‚     è¿è¡Œæ—¶å‚æ•°çƒ­æ›´æ–°         â”‚    â”‚                   â”‚
â”‚   â”‚  â”‚  â€¢ ç‰ˆé¢åˆ†æé˜ˆå€¼             â”‚    â”‚                   â”‚
â”‚   â”‚  â”‚  â€¢ è¡¨æ ¼è¯†åˆ«æ¨¡å¼             â”‚    â”‚                   â”‚
â”‚   â”‚  â”‚  â€¢ å…¬å¼æ¸²æŸ“å¼€å…³             â”‚    â”‚                   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                             â”‚
â”‚   âœ“ æ— éœ€é‡å¯æœåŠ¡    âœ“ æ— éœ€ä¿®æ”¹é…ç½®æ–‡ä»¶    âœ“ å³æ—¶ç”Ÿæ•ˆ        â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>ï¼šéƒ¨ç½²ä¸€æ¬¡ï¼ŒæŒ‰éœ€è°ƒæ•´ï¼Œå¤§å¹…é™ä½è¿ç»´æˆæœ¬ã€‚</p>
<hr/>
<h2 data-id="heading-16">ä¼˜åŒ–é¡¹</h2>
<h3 data-id="heading-17">1. æ™ºèƒ½æ ‡é¢˜åˆå¹¶</h3>
<p>Smart å’Œ Parent-Child åˆ†å—æ–¹æ³•æ–°å¢<strong>è¿ç»­æ ‡é¢˜è‡ªåŠ¨åˆå¹¶</strong>åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-swift" lang="swift">ä¼˜åŒ–å‰ï¼š
  <span class="hljs-type">Chunk</span> <span class="hljs-number">1</span>: <span class="hljs-string">"## ç¬¬ä¸€ç« "</span>
  <span class="hljs-type">Chunk</span> <span class="hljs-number">2</span>: <span class="hljs-string">"### 1.1 æ¦‚è¿°"</span>
  <span class="hljs-type">Chunk</span> <span class="hljs-number">3</span>: <span class="hljs-string">"æ­£æ–‡å†…å®¹..."</span>

ä¼˜åŒ–åï¼š
  <span class="hljs-type">Chunk</span> <span class="hljs-number">1</span>: <span class="hljs-string">"## ç¬¬ä¸€ç«  <span class="hljs-subst">\n</span> ### 1.1 æ¦‚è¿° <span class="hljs-subst">\n</span> æ­£æ–‡å†…å®¹..."</span>
</code></pre>
<p>é¿å…å‡ºç°åªæœ‰æ ‡é¢˜æ²¡æœ‰å†…å®¹çš„ç©ºæ´åˆ†å—ï¼Œæå‡æ£€ç´¢è´¨é‡ã€‚</p>
<h3 data-id="heading-18">2. å›¾æ–‡æ··æ’å¢å¼º</h3>
<p>æ–°å¢<strong>å›¾ç‰‡å ä½ä¿æŠ¤æœºåˆ¶</strong>ï¼Œè§£å†³ LLM å¤„ç†æ—¶ç¯¡æ”¹å›¾ç‰‡é“¾æ¥çš„é—®é¢˜ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  å›¾ç‰‡å ä½ä¿æŠ¤æµç¨‹                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   åŸå§‹å†…å®¹                                                   â”‚
â”‚   "è¿™æ˜¯ &lt;<span class="hljs-selector-tag">img</span> <span class="hljs-attribute">src</span>='/minio/kb/<span class="hljs-number">1</span><span class="hljs-selector-class">.jpg</span>'&gt; ç¤ºæ„å›¾"                 â”‚
â”‚            â”‚                                                â”‚
â”‚            â–¼  <span class="hljs-built_in">protect_images</span>()                              â”‚
â”‚   å®‰å…¨å†…å®¹                                                   â”‚
â”‚   "è¿™æ˜¯ <span class="hljs-selector-attr">[å›¾ç‰‡1]</span> ç¤ºæ„å›¾"                                      â”‚
â”‚            â”‚                                                â”‚
â”‚            â–¼  LLM å¤„ç†                                       â”‚
â”‚   LLM è¾“å‡º                                                   â”‚
â”‚   "è¿™æ˜¯ <span class="hljs-selector-attr">[å›¾ç‰‡1]</span> ç¤ºæ„å›¾ï¼Œå±•ç¤ºäº†..."                           â”‚
â”‚            â”‚                                                â”‚
â”‚            â–¼  <span class="hljs-built_in">restore_images</span>()                              â”‚
â”‚   æœ€ç»ˆå†…å®¹                                                   â”‚
â”‚   "è¿™æ˜¯ &lt;<span class="hljs-selector-tag">img</span> <span class="hljs-attribute">src</span>='/minio/kb/<span class="hljs-number">1</span><span class="hljs-selector-class">.jpg</span>'&gt; ç¤ºæ„å›¾ï¼Œå±•ç¤ºäº†..."       â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šå›¾ç‰‡é¡ºåºç¨³å®šï¼Œé“¾æ¥å®Œæ•´ï¼Œé™ä½å¯¹æ¨¡å‹çš„ä¾èµ–ã€‚</p>
<h3 data-id="heading-19">3. ç¦»çº¿ License ç®¡ç†</h3>
<p>æ–°å¢ç¦»çº¿ç¯å¢ƒä¸‹çš„ License ç®¡ç†èƒ½åŠ›ï¼Œæ»¡è¶³é‡‘èã€æ”¿åŠ¡ç­‰é«˜å®‰å…¨è¦æ±‚åœºæ™¯ï¼š</p>
<ul>
<li>æ”¯æŒç¦»çº¿æ¿€æ´»ä¸ç»­æœŸ</li>
<li>License çŠ¶æ€å®æ—¶ç›‘æ§</li>
</ul>
<hr/>
<h2 data-id="heading-20">ç¼ºé™·ä¿®å¤</h2>
<h3 data-id="heading-21">çŸ¥è¯†åº“å¯¼å…¥å¯¼å‡ºæ”¯æŒçˆ¶å­åˆ†å—</h3>
<p>ä¿®å¤äº†çˆ¶å­åˆ†å—ï¼ˆParent-Child Chunkingï¼‰çŸ¥è¯†åº“æ— æ³•æ­£ç¡®å¯¼å…¥å¯¼å‡ºçš„é—®é¢˜ã€‚</p>
<hr/>
<h2 data-id="heading-22">æœªæ¥å±•æœ›</h2>
<p>v2.3.0 æ ‡å¿—ç€ KnowFlow æ­£å¼è¿›å…¥å¤šæ¨¡æ€æ—¶ä»£ã€‚åç»­è§„åˆ’ï¼š</p>
<p>ğŸ¯ <strong>è¿‘æœŸç›®æ ‡</strong></p>
<ul>
<li>é’‰é’‰ã€ä¼ä¸šå¾®ä¿¡ã€Dify ç­‰ä¸‰æ–¹æ¥å…¥äº§å“åŒ–</li>
<li>æ£€ç´¢æ€§èƒ½å¹¶å‘ä¼˜åŒ–</li>
</ul>
<p>ğŸš€ <strong>æŠ€æœ¯æ¼”è¿›</strong></p>
<ul>
<li>Milvus å‘é‡åº“é›†æˆ</li>
<li>ç«¯åˆ°ç«¯å¤šæ¨¡æ€ RAG</li>
</ul>
<hr/>
<h2 data-id="heading-23">å¼€æºç¤¾åŒº</h2>
<p>ç¤¾åŒºç‰ˆæš‚æ— æ›´æ–°ï¼Œå¯ä»¥å…³æ³¨å…¬ä¼—å· <strong>KnowFlow ä¼ä¸šçŸ¥è¯†åº“</strong> è·å–å•†åŠ¡å’¨è¯¢ä¸æŠ€æœ¯æ”¯æŒã€‚</p>
<hr/>
<p><strong>KnowFlow v2.3.0 â€”â€” è®©çŸ¥è¯†åº“çœ‹è§æ›´å¤šï¼Œç†è§£æ›´æ·±ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[WSL2 (Manjaro) ç¯å¢ƒä¸‹ Google Antigravity AIæœåŠ¡ç½‘ç»œè¿æ¥ä¸ç¯å¢ƒé…ç½®é—®é¢˜]]></title>    <link>https://juejin.cn/post/7585377128489680948</link>    <guid>https://juejin.cn/post/7585377128489680948</guid>    <pubDate>2025-12-19T08:54:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585377128489680948" data-draft-id="7585206349748781108" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="WSL2 (Manjaro) ç¯å¢ƒä¸‹ Google Antigravity AIæœåŠ¡ç½‘ç»œè¿æ¥ä¸ç¯å¢ƒé…ç½®é—®é¢˜"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2025-12-19T08:54:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘æ˜æœˆ"/> <meta itemprop="url" content="https://juejin.cn/user/2928754707930126"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            WSL2 (Manjaro) ç¯å¢ƒä¸‹ Google Antigravity AIæœåŠ¡ç½‘ç»œè¿æ¥ä¸ç¯å¢ƒé…ç½®é—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2928754707930126/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘æ˜æœˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T08:54:37.000Z" title="Fri Dec 19 2025 08:54:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>Google Antigravity æ˜¯ Google æ¨å‡ºçš„ä¸‹ä¸€ä»£ Agent-first é›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰ã€‚å…¶æ ¸å¿ƒæ™ºèƒ½ä½“æœåŠ¡ï¼ˆAgent Serviceï¼‰åç«¯ç»„ä»¶ <code>language_server_linux_x64</code> é‡‡ç”¨ Go è¯­è¨€ç¼–å†™ã€‚</p>
<p>åœ¨ WSL2 ç¯å¢ƒä¸‹ä½¿ç”¨ Antigravity æ—¶ï¼Œå¯èƒ½å­˜åœ¨ä¸€ä¸ªå…¸å‹çš„ç½‘ç»œè¿æ¥é—®é¢˜ï¼š<strong>Go è¯­è¨€ç¼–å†™çš„é™æ€ç¼–è¯‘ç¨‹åºé€šå¸¸ä¸éµå¾ªç³»ç»Ÿç¯å¢ƒå˜é‡ï¼ˆå¦‚ <code>HTTP_PROXY</code>ï¼‰æˆ– Proxychains çš„åŠ«æŒ</strong>ã€‚è¿™å¯¼è‡´åœ¨å¼€å¯ç³»ç»Ÿä»£ç†çš„æƒ…å†µä¸‹ï¼ŒIDE çš„ AI åŠŸèƒ½ä»ç„¶æ— æ³•è¿æ¥æœåŠ¡å™¨ï¼Œå‡ºç°è¿æ¥è¶…æ—¶æˆ–æ— å“åº”çš„æƒ…å†µã€‚</p>
<p>æœ¬æ–‡è¯¦ç»†è®°å½•äº†åœ¨ WSL2 (Manjaroå‘è¡Œç‰ˆ) ä¸‹ï¼Œåˆ©ç”¨ <code>graftcp</code> å·¥å…·é€šè¿‡ <code>ptrace</code> æœºåˆ¶å¼ºåˆ¶æ¥ç®¡ Go ç¨‹åºç½‘ç»œæµé‡çš„è§£å†³æ–¹æ¡ˆï¼Œå¹¶è§£å†³äº†åœ¨æ­¤è¿‡ç¨‹ä¸­é‡åˆ°çš„ç³»ç»Ÿæ›´æ–°å´©æºƒåŠæœåŠ¡æŒä¹…åŒ–é—®é¢˜ã€‚</p>
<h2 data-id="heading-1">1. ç³»ç»Ÿç¯å¢ƒå‡†å¤‡ä¸ä¿®å¤</h2>
<p>åœ¨å¼€å§‹é…ç½®ç½‘ç»œå·¥å…·å‰ï¼Œéœ€è¦ç¡®ä¿ WSL2 ç¯å¢ƒçš„åŸºç¡€ä¾èµ–å®Œæ•´ã€‚</p>
<h3 data-id="heading-2">1.1 å®‰è£…åŸºç¡€ä¾èµ–</h3>
<p>éœ€è¦å®‰è£… <code>go</code>ã€<code>git</code>ã€<code>make</code> ä»¥åŠ <code>base-devel</code> ç¼–è¯‘å·¥å…·é“¾ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash">sudo pacman -Syu go git make base-devel
</code></pre>
<h3 data-id="heading-3">1.2 å¯èƒ½éœ€è¦å¤„ç† WSL2 ç³»ç»Ÿæ›´æ–°å¯¼è‡´çš„å´©æºƒ (E_UNEXPECTED)</h3>
<p>åœ¨æ‰§è¡Œ <code>pacman -Syu</code> è¿›è¡Œå…¨ç³»ç»Ÿå‡çº§æ—¶ï¼Œå¯èƒ½ä¼šæ›´æ–° <code>glibc</code> å’Œ <code>systemd</code> ç­‰æ ¸å¿ƒç»„ä»¶ã€‚åœ¨ WSL2 ç¯å¢ƒä¸‹ï¼Œè¿™å¯èƒ½å¯¼è‡´ Windows å®¿ä¸»æœºçš„ WSL æœåŠ¡è¿›ç¨‹ä¸ Linux å­ç³»ç»ŸçŠ¶æ€ä¸ä¸€è‡´ï¼ŒæŠ›å‡º <code>Wsl/Service/E_UNEXPECTED</code> é”™è¯¯æˆ–â€œç¾éš¾æ€§æ•…éšœâ€ï¼Œå¯¼è‡´æ— æ³•è¿›å…¥ç»ˆç«¯ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li>
<p>å¼ºåˆ¶å…³é—­ WSL å­ç³»ç»Ÿï¼š</p>
<p>åœ¨ Windows PowerShell ä¸­æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-PowerShell" lang="PowerShell">wsl --shutdown
</code></pre>
</li>
<li>
<p>æ›´æ–° WSL å†…æ ¸ï¼ˆå…³é”®æ­¥éª¤ï¼‰ï¼š</p>
<p>æ–°ç‰ˆçš„ Linux æ ¸å¿ƒåº“å¯èƒ½ä¾èµ–è¾ƒæ–°çš„ WSL ç»„ä»¶ï¼Œéœ€æ‰‹åŠ¨æ›´æ–°ï¼š</p>
<pre><code class="hljs language-PowerShell" lang="PowerShell">wsl --update
</code></pre>
</li>
<li>
<p>æ¸…ç†æ—§ç‰ˆ Server ç¼“å­˜ï¼š</p>
<p>ç³»ç»Ÿæ¢å¤åï¼Œæ—§çš„ VS Code Server æˆ– Antigravity Server äºŒè¿›åˆ¶æ–‡ä»¶å¯èƒ½ä¸æ–°çš„ glibc ä¸å…¼å®¹ï¼Œéœ€æ‰‹åŠ¨æ¸…ç†ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash"><span class="hljs-built_in">rm</span> -rf ~/.vscode-server
<span class="hljs-comment"># æˆ–</span>
<span class="hljs-built_in">rm</span> -rf ~/.antigravity-server
</code></pre>
</li>
</ol>
<h2 data-id="heading-4">2. ç¼–è¯‘ä¸å®‰è£… Graftcp</h2>
<p>é‰´äºå¸¸è§„ä»£ç†å·¥å…·å¤±æ•ˆï¼Œæˆ‘ä»¬é‡‡ç”¨ <code>graftcp</code>ã€‚å®ƒé€šè¿‡ <code>ptrace</code> è¿½è¸ªç³»ç»Ÿè°ƒç”¨ï¼Œèƒ½æœ‰æ•ˆå¤„ç† Go ç¨‹åºçš„ TCP è¿æ¥ã€‚</p>
<h3 data-id="heading-5">2.1 æºç ç¼–è¯‘</h3>
<pre><code class="hljs language-Bash" lang="Bash"><span class="hljs-comment"># å›åˆ°ç”¨æˆ·ä¸»ç›®å½•</span>
<span class="hljs-built_in">cd</span> ~
git <span class="hljs-built_in">clone</span> https://github.com/hmgle/graftcp.git
<span class="hljs-built_in">cd</span> graftcp

<span class="hljs-comment"># ç¼–è¯‘</span>
make
</code></pre>
<h3 data-id="heading-6">2.2 å®‰è£…è‡³ç³»ç»Ÿ</h3>
<pre><code class="hljs language-Bash" lang="Bash">sudo make install
sudo make install_systemd
sudo systemctl daemon-reload
</code></pre>
<p>å®‰è£…å®Œæˆåï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶ä½äº <code>/usr/local/bin/</code>ï¼Œé…ç½®æ–‡ä»¶ä½äº <code>/etc/graftcp-local/</code>ã€‚</p>
<h2 data-id="heading-7">3. ä»£ç†æœåŠ¡é…ç½®</h2>
<p>ä¸ºäº†ä½¿ WSL2 å†…çš„æµé‡æ­£ç¡®è½¬å‘è‡³ Windows å®¿ä¸»æœºçš„ä»£ç†è½¯ä»¶ï¼ˆå¦‚ Clash/v2rayNï¼‰ï¼Œå»ºè®®å°† WSL2 ç½‘ç»œæ¨¡å¼è®¾ç½®ä¸º <strong>Mirrored (é•œåƒæ¨¡å¼)</strong> ã€‚</p>
<h3 data-id="heading-8">3.1 ä¿®æ”¹ Graftcp é…ç½®æ–‡ä»¶</h3>
<p>ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash">sudo nano /etc/graftcp-local/graftcp-local.conf
</code></pre>
<p>ä¸»è¦ä¿®æ”¹ä»¥ä¸‹ä¸¤é¡¹å‚æ•°ï¼š</p>
<ol>
<li><strong>http_proxy</strong>ï¼šæŒ‡å‘ Windows å®¿ä¸»æœºçš„ä»£ç†ç«¯å£ï¼ˆé•œåƒæ¨¡å¼ä¸‹å³ä¸º <code>127.0.0.1</code>ï¼‰ã€‚</li>
<li><strong>select_proxy_mode</strong>ï¼šå¼ºåˆ¶æŒ‡å®šä¸º <code>only_http_proxy</code>ï¼Œé¿å…è‡ªåŠ¨æ¢æµ‹å¤±è´¥ã€‚</li>
</ol>
<p>é…ç½®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-Ini,TOML" lang="Ini,TOML">## graftcp-local configuration

## ç›‘å¬åœ°å€
listen = :2233

## è¿™é‡Œå¡«å†™ Windows ä»£ç†è½¯ä»¶çš„ HTTP ç«¯å£ (ä¾‹å¦‚ 7897 æˆ– 10808)
http_proxy = 127.0.0.1:7897

## å¼ºåˆ¶ä½¿ç”¨ HTTP ä»£ç†æ¨¡å¼
select_proxy_mode = only_http_proxy
</code></pre>
<h3 data-id="heading-9">3.2 å¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯</h3>
<p>Antigravity å¯åŠ¨æ—¶ä¾èµ–è¯¥åå°æœåŠ¡ã€‚åŠ¡å¿…è®¾ç½®ä¸ºå¼€æœºè‡ªå¯ï¼Œå¦åˆ™é‡å¯ WSL åæœåŠ¡å°†ä¸­æ–­å¯¼è‡´ Antigravity ä¼šé‡åˆ°æŠ¥é”™ï¼šÂ <code>Antigravity server crashed unexpectedly. Please restart to fully restore AI features</code></p>
<pre><code class="hljs language-Bash" lang="Bash"><span class="hljs-comment"># å¯åŠ¨æœåŠ¡å¹¶è®¾ç½®ä¸ºå¼€æœºè‡ªå¯</span>
sudo systemctl <span class="hljs-built_in">enable</span> --now graftcp-local

<span class="hljs-comment"># éªŒè¯çŠ¶æ€ (åº”ä¸º active running)</span>
sudo systemctl status graftcp-local
</code></pre>
<h2 data-id="heading-10">4. å®æ–½ Wrapper è„šæœ¬æ›¿æ¢</h2>
<p>è¿™æ˜¯è§£å†³é—®é¢˜çš„æ ¸å¿ƒæ­¥éª¤ã€‚æˆ‘ä»¬éœ€è¦æ‰¾åˆ° Antigravity çš„æ ¸å¿ƒäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå°†å…¶æ›¿æ¢ä¸ºä¸€ä¸ª Wrapper è„šæœ¬ã€‚è¯¥è„šæœ¬å°†é€šè¿‡ <code>graftcp</code> å¯åŠ¨åŸç¨‹åºï¼Œå¹¶æ³¨å…¥å¿…è¦çš„ç¯å¢ƒå˜é‡ã€‚</p>
<h3 data-id="heading-11">4.1 å®šä½ç›®æ ‡æ–‡ä»¶</h3>
<p>Antigravity æ›´æ–°é¢‘ç¹ï¼Œä¸”è·¯å¾„åŒ…å«éšæœºå“ˆå¸Œå€¼ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®šä½å½“å‰ç‰ˆæœ¬çš„ <code>language_server_linux_x64</code>ï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-bash" lang="bash">find ~/.antigravity-server -name <span class="hljs-string">"language_server_linux_x64"</span>
<span class="hljs-comment"># ç¤ºä¾‹è·¯å¾„è¾“å‡ºï¼š</span>
<span class="hljs-comment"># /home/user/.antigravity-server/bin/[HASH_VALUE]/extensions/antigravity/bin/language_server_linux_x64</span>
</code></pre>
<h3 data-id="heading-12">4.2 æ›¿æ¢ä¸è„šæœ¬æ³¨å…¥</h3>
<p>è¿›å…¥ç›®æ ‡ç›®å½•åï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<ol>
<li>
<p><strong>å¤‡ä»½åŸç¨‹åº</strong>ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash"><span class="hljs-built_in">mv</span> language_server_linux_x64 language_server_linux_x64.bak
</code></pre>
</li>
<li>
<p>åˆ›å»º Wrapper è„šæœ¬ï¼š</p>
<p>æ–°å»º language_server_linux_x64 æ–‡ä»¶ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment"># Graftcp å®‰è£…è·¯å¾„</span>
GRAFTCP_BIN=<span class="hljs-string">"/usr/local/bin/graftcp"</span>
LOG_FILE=<span class="hljs-string">"/tmp/antigravity_wrapper.log"</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"[<span class="hljs-subst">$(date)</span>] Wrapperå¯åŠ¨. å‚æ•°: <span class="hljs-variable">$@</span>"</span> &gt;&gt; <span class="hljs-string">"<span class="hljs-variable">$LOG_FILE</span>"</span>

<span class="hljs-comment"># å…³é”®ç¯å¢ƒå˜é‡ä¼˜åŒ–</span>
<span class="hljs-comment"># 1. å¼ºåˆ¶ä½¿ç”¨ç³»ç»Ÿ CGO è§£æ DNSï¼Œé¿å… Go åŸç”Ÿè§£æå™¨åœ¨ä»£ç†ç¯å¢ƒä¸‹è§£æå¤±è´¥</span>
<span class="hljs-built_in">export</span> GODEBUG=netdns=cgo
<span class="hljs-comment"># 2. å¼ºåˆ¶å…³é—­ HTTP/2ï¼Œè§£å†³ Go HTTP/2 å®¢æˆ·ç«¯åœ¨ä»£ç†è½¬å‘æ—¶çš„æ–­æµ/EOFé—®é¢˜</span>
<span class="hljs-built_in">export</span> GODEBUG=<span class="hljs-variable">$GODEBUG</span>,http2client=0

<span class="hljs-comment"># ä½¿ç”¨ graftcp å¯åŠ¨åŸç¨‹åº</span>
<span class="hljs-built_in">exec</span> <span class="hljs-string">"<span class="hljs-variable">$GRAFTCP_BIN</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$0</span>.bak"</span> <span class="hljs-string">"<span class="hljs-variable">$@</span>"</span>
</code></pre>
</li>
<li>
<p><strong>èµ‹äºˆæ‰§è¡Œæƒé™</strong>ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash"><span class="hljs-built_in">chmod</span> +x language_server_linux_x64
</code></pre>
</li>
</ol>
<h3 data-id="heading-13">4.3 éªŒè¯</h3>
<p>é‡å¯ Antigravity IDEã€‚åœ¨ WSL ç»ˆç«¯ä¸­ç›‘æ§æ—¥å¿—ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash"><span class="hljs-built_in">tail</span> -f /tmp/antigravity_wrapper.log
</code></pre>
<p>è‹¥å‡ºç° "Wrapperå¯åŠ¨" å­—æ ·ä¸” AI åŠŸèƒ½æ¢å¤æ­£å¸¸ï¼Œå³è¡¨ç¤ºé…ç½®æˆåŠŸã€‚</p>
<h2 data-id="heading-14">5. è‡ªåŠ¨åŒ–ç»´æŠ¤è„šæœ¬</h2>
<p>ç”±äº Antigravity å…·æœ‰è‡ªåŠ¨æ›´æ–°æœºåˆ¶ï¼Œæ›´æ–°åä¼šç”Ÿæˆæ–°çš„å“ˆå¸Œç›®å½•ï¼Œå¯¼è‡´ä¸Šè¿°æ‰‹åŠ¨ä¿®æ”¹å¤±æ•ˆã€‚ä¸ºæ­¤ï¼Œç¼–å†™ä¸€ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬æ¥æ£€æµ‹å¹¶ä¿®å¤æ–°ç‰ˆæœ¬ã€‚</p>
<h3 data-id="heading-15">5.1 ç¼–å†™æ£€æµ‹è„šæœ¬</h3>
<p>åˆ›å»º <code>~/fix_antigravity.sh</code>ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash"><span class="hljs-meta">#!/bin/bash</span>

TARGET_DIR=<span class="hljs-string">"<span class="hljs-variable">$HOME</span>/.antigravity-server"</span>
GRAFTCP_BIN=<span class="hljs-string">"/usr/local/bin/graftcp"</span>
WRAPPER_MARKER=<span class="hljs-string">"# WRAPPER_BY_USER"</span> 

<span class="hljs-comment"># éå†æ‰€æœ‰ server ç›®å½•</span>
find <span class="hljs-string">"<span class="hljs-variable">$TARGET_DIR</span>"</span> -<span class="hljs-built_in">type</span> f -name <span class="hljs-string">"language_server_linux_x64"</span> 2&gt;/dev/null | <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> -r BIN_PATH; <span class="hljs-keyword">do</span>
    
    <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦å·²å¤„ç†</span>
    <span class="hljs-keyword">if</span> grep -q <span class="hljs-string">"<span class="hljs-variable">$WRAPPER_MARKER</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$BIN_PATH</span>"</span>; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">continue</span>
    <span class="hljs-keyword">fi</span>

    <span class="hljs-built_in">echo</span> <span class="hljs-string">"[æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬] æ­£åœ¨ä¿®å¤: <span class="hljs-variable">$BIN_PATH</span>"</span>

    <span class="hljs-comment"># å¤‡ä»½é€»è¾‘</span>
    <span class="hljs-keyword">if</span> [ ! -f <span class="hljs-string">"<span class="hljs-variable">${BIN_PATH}</span>.bak"</span> ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">mv</span> <span class="hljs-string">"<span class="hljs-variable">$BIN_PATH</span>"</span> <span class="hljs-string">"<span class="hljs-variable">${BIN_PATH}</span>.bak"</span>
    <span class="hljs-keyword">else</span>
        <span class="hljs-comment"># è‹¥å­˜åœ¨ bak ä½†ä¸»æ–‡ä»¶æœªè¢«æ ‡è®°ï¼Œè¯´æ˜å‘ç”Ÿäº†è¦†ç›–æ›´æ–°</span>
        <span class="hljs-built_in">mv</span> <span class="hljs-string">"<span class="hljs-variable">$BIN_PATH</span>"</span> <span class="hljs-string">"<span class="hljs-variable">${BIN_PATH}</span>.bak"</span>
    <span class="hljs-keyword">fi</span>

    <span class="hljs-comment"># å†™å…¥è„šæœ¬</span>
    <span class="hljs-built_in">cat</span> &gt; <span class="hljs-string">"<span class="hljs-variable">$BIN_PATH</span>"</span> &lt;&lt;<span class="hljs-string">EOF
#!/bin/bash
$WRAPPER_MARKER

GRAFTCP_BIN="$GRAFTCP_BIN"
LOG_FILE="/tmp/antigravity_wrapper.log"
echo "[($(date)] Wrapperå¯åŠ¨ (è‡ªåŠ¨ä¿®å¤ç‰ˆ)..." &gt;&gt; "$LOG_FILE"

export GODEBUG=netdns=cgo,http2client=0

exec "$GRAFTCP_BIN" "$0.bak" "$@"
EOF</span>

    <span class="hljs-built_in">chmod</span> +x <span class="hljs-string">"<span class="hljs-variable">$BIN_PATH</span>"</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"âœ… ä¿®å¤å®Œæˆï¼"</span>
<span class="hljs-keyword">done</span>
</code></pre>
<p>èµ‹äºˆæƒé™ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash"><span class="hljs-built_in">chmod</span> +x ~/fix_antigravity.sh
</code></pre>
<h3 data-id="heading-16">5.2 é›†æˆè‡³ Shell å¯åŠ¨é¡¹</h3>
<p>ä¸ºäº†å®ç°æ— æ„Ÿä¿®å¤ï¼Œå°†å…¶åŠ å…¥ <code>.zshrc</code> æˆ– <code>.bashrc</code>ï¼Œä½¿å…¶åœ¨æ¯æ¬¡æ‰“å¼€ç»ˆç«¯æ—¶é™é»˜è¿è¡Œï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash"><span class="hljs-comment"># åœ¨ .zshrc æœ«å°¾æ·»åŠ </span>
<span class="hljs-built_in">nohup</span> ~/fix_antigravity.sh &gt;/dev/null 2&gt;&amp;1 &amp;
</code></pre>
<p>æˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨ Crontab å®šæ—¶ä»»åŠ¡ï¼ˆæ¯”å¦‚æ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡ï¼‰
å¦‚æœä¸å¸¸å¼€ç»ˆç«¯ï¼Œå¯ä»¥è®©ç³»ç»Ÿæ¯å°æ—¶è‡ªåŠ¨æ£€æŸ¥ä¸€æ¬¡ã€‚æ‰“å¼€å®šæ—¶ä»»åŠ¡ç¼–è¾‘ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash">crontab -e
<span class="hljs-comment"># æ·»åŠ ä¸€è¡Œï¼š</span>
0 * * * * /home/username/fix_antigravity.sh
</code></pre>
<p>ä¸ºäº†éªŒè¯è„šæœ¬å¥½ä¸å¥½ç”¨ï¼Œå¯ä»¥æ‰‹åŠ¨è¿è¡Œä¸€æ¬¡çœ‹çœ‹ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash">~/fix_antigravity.sh
</code></pre>
<p>å¦‚æœå®ƒä»€ä¹ˆéƒ½æ²¡è¾“å‡ºï¼Œè¯´æ˜ç›®å‰æ‰€æœ‰ç‰ˆæœ¬éƒ½å·²ç»ä¿®å¤å¥½äº†ã€‚å¦‚æœå®ƒè¾“å‡ºäº† [æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬] æ­£åœ¨ä¿®å¤...ï¼Œè¯´æ˜å®ƒæˆåŠŸæ•æ‰åˆ°äº†æ¼ç½‘ä¹‹é±¼ã€‚</p>
<h2 data-id="heading-17">6. å…¶ä»–æ³¨æ„äº‹é¡¹</h2>
<ul>
<li>
<p>æƒé™é—®é¢˜ï¼šå¦‚æœåœ¨åç»­å¯åŠ¨ Antigravity æ—¶é‡åˆ°æŠ¥é”™ï¼š <code>Antigravity server crashed unexpectedly. Please restart to fully restore AI features</code>ï¼Œå¯èƒ½æ˜¯å› ä¸ºä¹‹å‰ä½¿ç”¨ sudo è¿è¡Œè¿‡æŸäº›å‘½ä»¤å¯¼è‡´ ~/.gemini æˆ– ~/.antigravity-server ç›®å½•æƒé™å½’å±ä¸º rootã€‚</p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash">sudo <span class="hljs-built_in">chown</span> -R $(<span class="hljs-built_in">whoami</span>):$(<span class="hljs-built_in">whoami</span>) ~/.gemini ~/.antigravity-server
</code></pre>
</li>
<li>
<p><strong>Windows ä»£ç†è®¾ç½®</strong>ï¼šåŠ¡å¿…ç¡®ä¿ Windows ç«¯ä»£ç†è½¯ä»¶ï¼ˆClash/v2rayNï¼‰å¼€å¯äº†â€œå…è®¸å±€åŸŸç½‘è¿æ¥ (Allow LAN)â€ã€‚æ£€æŸ¥ WSL2 ç½‘ç»œæ¨¡å¼ä¸º Mirrored å¹¶é…åˆ ä»£ç†è½¯ä»¶ï¼ˆClash/v2rayNï¼‰ä¸å¼€å¯è™šæ‹Ÿç½‘å¡(TUN)æ¨¡å¼ã€‚</p>
</li>
</ul>
<hr/>
<h3 data-id="heading-18">å‚è€ƒ</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fweixin_42707324%2Farticle%2Fdetails%2F155676295" target="_blank" title="https://blog.csdn.net/weixin_42707324/article/details/155676295" ref="nofollow noopener noreferrer">CSDN: WSL2 ç½‘ç»œé…ç½®ç›¸å…³</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.v2ex.com%2Ft%2F1174113" target="_blank" title="https://www.v2ex.com/t/1174113" ref="nofollow noopener noreferrer">V2EX: è®¨è®º Antigravity ç½‘ç»œé—®é¢˜</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmedium.com%2F%40aidar.aukenov%2Ffixing-the-antigravity-server-crashed-unexpectedly-110ba69084c2" target="_blank" title="https://medium.com/@aidar.aukenov/fixing-the-antigravity-server-crashed-unexpectedly-110ba69084c2" ref="nofollow noopener noreferrer">Medium: Fixing Antigravity server crashed unexpectedly</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[iOS App æ€§èƒ½æµ‹è¯•ä¸­å¸¸è¢«å¿½ç•¥çš„è¿è¡ŒæœŸé—®é¢˜]]></title>    <link>https://juejin.cn/post/7585382317443579914</link>    <guid>https://juejin.cn/post/7585382317443579914</guid>    <pubDate>2025-12-19T09:37:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585382317443579914" data-draft-id="7585406229167210546" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="iOS App æ€§èƒ½æµ‹è¯•ä¸­å¸¸è¢«å¿½ç•¥çš„è¿è¡ŒæœŸé—®é¢˜"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-19T09:37:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¼€å¿ƒçŒ´çˆ·"/> <meta itemprop="url" content="https://juejin.cn/user/2179705232165364"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            iOS App æ€§èƒ½æµ‹è¯•ä¸­å¸¸è¢«å¿½ç•¥çš„è¿è¡ŒæœŸé—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2179705232165364/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¼€å¿ƒçŒ´çˆ·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T09:37:07.000Z" title="Fri Dec 19 2025 09:37:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å¾ˆå¤šé¡¹ç›®é‡Œï¼Œ<strong>iOS App æ€§èƒ½æµ‹è¯•</strong>æœ€æ—©çš„å½¢æ€ï¼Œå…¶å®éå¸¸æœ´ç´ ï¼š
åŠŸèƒ½è·‘é€šä¹‹åï¼Œç”¨çœŸæœºç‚¹å‡ ä¸‹ï¼Œçœ‹çœ‹é¡ºä¸é¡ºã€å¡ä¸å¡ï¼Œåªè¦æ²¡æœ‰æ˜æ˜¾å¼‚å¸¸ï¼Œå°±ç®—é€šè¿‡ã€‚</p>
<p>ä½†éšç€é¡¹ç›®é€æ¸å˜å¤æ‚ï¼Œè¿™å¥—æ–¹å¼ä¼šè¶Šæ¥è¶ŠåŠ›ä¸ä»å¿ƒã€‚
é—®é¢˜å¹¶ä¸æ˜¯â€œæ²¡äººæµ‹æ€§èƒ½â€ï¼Œè€Œæ˜¯å¾ˆå¤šæ€§èƒ½é—®é¢˜ï¼Œ<strong>å¹¶ä¸ä¼šåœ¨ä½ åˆ»æ„æµ‹è¯•çš„é‚£ä¸€åˆ»å‡ºç°</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-0">æ€§èƒ½æµ‹è¯•çœŸæ­£æ£˜æ‰‹çš„ï¼Œæ˜¯â€œå¤ç°è·¯å¾„ä¸å›ºå®šâ€</h2>
<p>æˆ‘ç¬¬ä¸€æ¬¡æ„è¯†åˆ°æ€§èƒ½æµ‹è¯•ä¸åªæ˜¯â€œæµ‹ä¸€ä¸‹â€ï¼Œæ˜¯åœ¨ä¸€æ¬¡ç‰ˆæœ¬å›å½’ä¹‹åã€‚
æµ‹è¯•åŒäº‹åé¦ˆçš„é—®é¢˜æ˜¯ï¼šæŸäº›è®¾å¤‡åœ¨è¿ç»­ä½¿ç”¨ä¸€æ®µæ—¶é—´åï¼Œä¼šæ„Ÿè§‰æ˜æ˜¾å˜æ…¢ï¼Œä½†é‡æ–°å¯åŠ¨ App åˆæ¢å¤æ­£å¸¸ã€‚</p>
<p>è¿™ä¸ªæè¿°éå¸¸å·¥ç¨‹åŒ–ï¼Œä¹Ÿéå¸¸éš¾å¤„ç†ã€‚</p>
<ul>
<li>æ²¡æœ‰å›ºå®šæ­¥éª¤</li>
<li>æ²¡æœ‰æ˜ç¡®é¡µé¢</li>
<li>æ²¡æœ‰å¿…ç°æ¡ä»¶</li>
</ul>
<p>å¦‚æœåªæ˜¯å†è·‘ä¸€é Instrumentsï¼Œå¾ˆå¯èƒ½è¿˜æ˜¯â€œçœ‹èµ·æ¥æ²¡é—®é¢˜â€ã€‚</p>
<hr/>
<h2 data-id="heading-1">Instruments å¾ˆå¼ºï¼Œä½†å®ƒæ›´é€‚åˆå›ç­”â€œä¸ºä»€ä¹ˆâ€</h2>
<p>åœ¨ iOS æ€§èƒ½æµ‹è¯•ä¸­ï¼ŒInstruments ä¾ç„¶æ˜¯ä¸å¯æ›¿ä»£çš„å·¥å…·ã€‚</p>
<p>Time Profilerã€Allocationsã€Core Animationï¼Œè¿™äº›æˆ‘éƒ½éå¸¸ç†Ÿã€‚
ä½†åœ¨è¿™æ¬¡é—®é¢˜ä¸­ï¼Œå®ƒä»¬å¹¶æ²¡æœ‰ç¬¬ä¸€æ—¶é—´ç»™æˆ‘ç­”æ¡ˆï¼ŒåŸå› ä¹Ÿå¾ˆç®€å•ï¼š</p>
<p><strong>æˆ‘å¹¶ä¸çŸ¥é“è¯¥ç›¯ç€å“ªä¸€æ®µæµç¨‹å»çœ‹ã€‚</strong></p>
<p>Instruments æ›´é€‚åˆåœ¨ä½ å·²ç»æ€€ç–‘æŸä¸ªé¡µé¢ã€æŸæ®µé€»è¾‘æ—¶ï¼Œç”¨æ¥è§£é‡ŠåŸå› ï¼Œè€Œä¸æ˜¯ç”¨æ¥â€œå¹¿æ’’ç½‘â€ã€‚</p>
<hr/>
<h2 data-id="heading-2">å½“æ€§èƒ½æµ‹è¯•å¼€å§‹å…³æ³¨â€œè¿‡ç¨‹â€ï¼Œè€Œä¸æ˜¯â€œç¬é—´â€</h2>
<p>åæ¥æˆ‘æ¢äº†ä¸€ä¸ªç­–ç•¥ï¼š
ä¸å†è¯•å›¾ä¸€æ¬¡æ€§æŠ“åˆ°é—®é¢˜ï¼Œè€Œæ˜¯<strong>å®Œæ•´è·‘ä¸€éçœŸå®ä½¿ç”¨è¿‡ç¨‹</strong>ã€‚</p>
<p>è¿™æ—¶æˆ‘ç”¨åˆ°äº† <strong>å…‹é­”ï¼ˆKeyMobï¼‰</strong>ã€‚</p>
<p>å®ƒå¹¶æ²¡æœ‰æ›¿ä»£ Instrumentsï¼Œè€Œæ˜¯è®©æˆ‘åœ¨çœŸæœºä¸ŠæŒç»­è§‚å¯Ÿï¼š</p>
<ul>
<li>CPU ä½¿ç”¨æƒ…å†µéšæ—¶é—´çš„å˜åŒ–</li>
<li>å†…å­˜æ˜¯å¦å­˜åœ¨å›è½ä¸å®Œå…¨</li>
<li>FPS åœ¨å¤šæ¬¡è¿›å…¥åŒä¸€é¡µé¢åçš„å·®å¼‚</li>
<li>ç½‘ç»œå’Œèƒ½è€—æ˜¯å¦åœ¨æŸäº›é˜¶æ®µå¼‚å¸¸æ´»è·ƒ</li>
</ul>
<p>å½“ä½ æŠŠè¿™äº›æ•°æ®æ”¾åœ¨ä¸€æ¡æ—¶é—´çº¿ä¸Šï¼Œæ€§èƒ½é—®é¢˜å°±ä¸å†æ˜¯â€œæœ‰æˆ–æ²¡æœ‰â€ï¼Œè€Œæ˜¯â€œä»€ä¹ˆæ—¶å€™å¼€å§‹ä¸å¯¹â€ã€‚</p>
<hr/>
<h2 data-id="heading-3">æ€§èƒ½æµ‹è¯•é‡Œï¼Œä¸€ä¸ªå¾ˆå¸¸è§çš„è¯¯åŒº</h2>
<p>åæ¥å¤ç›˜æ—¶ï¼Œæˆ‘å‘ç°å¾ˆå¤šæ€§èƒ½æµ‹è¯•çš„é—®é¢˜ï¼Œæ¥è‡ªä¸€ä¸ªä¹ æƒ¯ï¼š</p>
<blockquote>
<p>åªæµ‹ç¬¬ä¸€æ¬¡ã€‚</p>
</blockquote>
<p>ç¬¬ä¸€æ¬¡è¿›å…¥é¡µé¢ã€ç¬¬ä¸€æ¬¡æ»‘åŠ¨åˆ—è¡¨ã€ç¬¬ä¸€æ¬¡åŠ è½½æ•°æ®ï¼Œ
è¿™äº›åœºæ™¯å½“ç„¶é‡è¦ï¼Œä½†å®ƒä»¬å¾€å¾€æ˜¯<strong>æœ€å¥åº·çš„çŠ¶æ€</strong>ã€‚</p>
<p>çœŸæ­£å®¹æ˜“å‡ºé—®é¢˜çš„ï¼Œæ˜¯ï¼š</p>
<ul>
<li>ç¬¬äºŒæ¬¡ã€ç¬¬ä¸‰æ¬¡è¿›å…¥</li>
<li>é¡µé¢é¢‘ç¹åˆ‡æ¢ä¹‹å</li>
<li>å‰åå°å¤šæ¬¡åˆ‡æ¢</li>
<li>WebView ä¸ Native äº¤æ›¿ä½¿ç”¨</li>
</ul>
<p>è¿™äº›åœºæ™¯ï¼Œå¦‚æœä¸åˆ»æ„è¦†ç›–ï¼Œå¾ˆå®¹æ˜“è¢«æ€§èƒ½æµ‹è¯•é—æ¼ã€‚</p>
<hr/>
<h2 data-id="heading-4">WebView åœºæ™¯ï¼Œè®©æ€§èƒ½æµ‹è¯•æ›´å¤æ‚</h2>
<p>åœ¨å½“å‰é¡¹ç›®ä¸­ï¼Œæœ‰ä¸å°‘åŠŸèƒ½æ˜¯é€šè¿‡ WebView å®ç°çš„ã€‚
å•ä» Native ä¾§çœ‹ï¼Œæ€§èƒ½æŒ‡æ ‡å¹¶ä¸å¼‚å¸¸ã€‚</p>
<p>ä½†åœ¨æŸæ¬¡æµ‹è¯•ä¸­ï¼Œé€šè¿‡ <strong>Safari Inspector</strong>ï¼Œæˆ‘æ³¨æ„åˆ°ï¼š</p>
<ul>
<li>å‰ç«¯é¡µé¢å­˜åœ¨å®šæ—¶ä»»åŠ¡</li>
<li>éƒ¨åˆ†èµ„æºæ²¡æœ‰æŒ‰é¢„æœŸé‡Šæ”¾</li>
<li>é¡µé¢åˆ‡æ¢å JS ä»åœ¨æ‰§è¡Œ</li>
</ul>
<p>è¿™äº›è¡Œä¸ºæœ¬èº«ä¸ç®—â€œé‡â€ï¼Œ
ä½†ç»“åˆ KeyMob çœ‹åˆ°çš„ CPU ä¸å†…å­˜æ›²çº¿ï¼Œå°±èƒ½å‘ç°å®ƒä»¬å¯¹é•¿æœŸæ€§èƒ½çš„å½±å“ã€‚</p>
<hr/>
<h2 data-id="heading-5">ç½‘ç»œè¡Œä¸ºï¼Œå¸¸å¸¸æ˜¯æ€§èƒ½é—®é¢˜çš„æ”¾å¤§å™¨</h2>
<p>è¿˜æœ‰ä¸€ç±»é—®é¢˜ï¼Œåœ¨æ€§èƒ½æµ‹è¯•é˜¶æ®µå¾ˆå®¹æ˜“è¢«å¿½ç•¥ï¼š
<strong>å¼±ç½‘ç¯å¢ƒä¸‹çš„è¡Œä¸ºå˜åŒ–</strong>ã€‚</p>
<p>é€šè¿‡ <strong>Charles</strong> æŠ“åŒ…ï¼Œæˆ‘ä»¬å‘ç°æŸäº›æ¥å£åœ¨ç½‘ç»œä¸ç¨³å®šæ—¶ä¼šé¢‘ç¹é‡è¯•ã€‚
æ¯ä¸€æ¬¡è¯·æ±‚éƒ½ä¸ç®—å¤§ï¼Œä½†è§£æã€ç¼“å­˜ã€æ—¥å¿—å åŠ èµ·æ¥ï¼Œå°±ä¼šåœ¨æ€§èƒ½æ›²çº¿ä¸Šç•™ä¸‹ç—•è¿¹ã€‚</p>
<p>å¦‚æœåªåœ¨ç†æƒ³ç½‘ç»œä¸‹æµ‹è¯•ï¼Œè¿™ç±»é—®é¢˜å¾ˆéš¾æš´éœ²ã€‚</p>
<hr/>
<h2 data-id="heading-6">æ€§èƒ½æµ‹è¯•ä¸æ˜¯â€œå•ä¸€å·¥å…·â€çš„å·¥ä½œ</h2>
<p>ç»è¿‡è¿™äº›ç»å†ï¼Œæˆ‘å¯¹ iOS App æ€§èƒ½æµ‹è¯•çš„ç†è§£å˜å¾—æ›´åŠ¡å®äº†ä¸€äº›ã€‚</p>
<p>åœ¨å®é™…å·¥ç¨‹ä¸­ï¼Œæˆ‘æ›´å€¾å‘äºè¿™æ ·åˆ†å·¥ï¼š</p>
<ul>
<li><strong>KeyMob</strong>ï¼šè§‚å¯ŸçœŸæœºä¸Šçš„é•¿æœŸæ€§èƒ½è¶‹åŠ¿</li>
<li><strong>Instruments</strong>ï¼šå®šä½å…·ä½“æ€§èƒ½æ¶ˆè€—ç‚¹</li>
<li><strong>Safari Inspector</strong>ï¼šè¡¥é½ WebView è¡Œä¸º</li>
<li><strong>Charles</strong>ï¼šè§£é‡Šç½‘ç»œä¸æ€§èƒ½çš„å…³ç³»</li>
<li><strong>Xcode</strong>ï¼šéªŒè¯é€»è¾‘ä¸çº¿ç¨‹é—®é¢˜</li>
</ul>
<p>æ¯ä¸ªå·¥å…·å…³æ³¨çš„éƒ½æ˜¯åŒä¸€ä¸ªé—®é¢˜çš„ä¸åŒä¾§é¢ã€‚</p>
<hr/>
<h2 data-id="heading-7">ä¸€äº›æ…¢æ…¢å½¢æˆçš„æµ‹è¯•ä¹ æƒ¯</h2>
<p>åœ¨åç»­é¡¹ç›®é‡Œï¼Œæœ‰å‡ ä»¶äº‹æˆ‘ä¼šåˆ»æ„å»åšï¼š</p>
<ul>
<li>æŠŠæ€§èƒ½æµ‹è¯•æ—¶é—´æ‹‰é•¿</li>
<li>é‡å¤è¿›å…¥å…³é”®é¡µé¢</li>
<li>æµ‹è¯•å‰åå°åˆ‡æ¢</li>
<li>åœ¨å¼±ç½‘å’Œæ­£å¸¸ç½‘ç»œä¸‹å„è·‘ä¸€è½®</li>
<li>è§‚å¯Ÿè¶‹åŠ¿ï¼Œè€Œä¸æ˜¯åªç›¯å³°å€¼</li>
</ul>
<p>è¿™äº›çœ‹èµ·æ¥éƒ½ä¸ç®—â€œé«˜çº§æŠ€å·§â€ï¼Œä½†ç¡®å®æ›´æ¥è¿‘ç”¨æˆ·çš„çœŸå®ä½¿ç”¨æƒ…å†µã€‚</p>
<hr/>
<p>iOS App æ€§èƒ½æµ‹è¯•å¹¶ä¸æ˜¯ä¸€ä¸ªâ€œé˜¶æ®µæ€§ä»»åŠ¡â€ï¼Œ
è€Œæ›´åƒæ˜¯å¯¹åº”ç”¨è¿è¡ŒçŠ¶æ€çš„ä¸€æ¬¡æŒç»­è§‚å¯Ÿã€‚</p>
<p>å½“ä½ èƒ½å›ç­”ä¸‹é¢è¿™äº›é—®é¢˜æ—¶ï¼Œæ€§èƒ½æµ‹è¯•æ‰ç®—çœŸæ­£å¼€å§‹ï¼š</p>
<ul>
<li>App ç”¨ä¹…äº†ä¼šä¸ä¼šå˜æ…¢</li>
<li>æ€§èƒ½å˜åŒ–å‘ç”Ÿåœ¨ä»€ä¹ˆé˜¶æ®µ</li>
<li>æ˜¯å“ªä¸€ç±»è¡Œä¸ºåœ¨æŒç»­æ¶ˆè€—èµ„æº</li>
</ul>
<p>å¦‚æœè¿™äº›é—®é¢˜åªèƒ½é çŒœï¼Œé‚£æµ‹è¯•ä¸€å®šæ˜¯ä¸å®Œæ•´çš„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[item_get_app - æ ¹æ®IDå–å•†å“è¯¦æƒ…åŸæ•°æ®H5æ•°æ®æ¥å£å®æˆ˜è§£æ]]></title>    <link>https://juejin.cn/post/7585391510058074164</link>    <guid>https://juejin.cn/post/7585391510058074164</guid>    <pubDate>2025-12-19T09:37:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585391510058074164" data-draft-id="7585385309890822144" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="item_get_app - æ ¹æ®IDå–å•†å“è¯¦æƒ…åŸæ•°æ®H5æ•°æ®æ¥å£å®æˆ˜è§£æ"/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-12-19T09:37:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="APIæŠ€æœ¯å‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/4126894064152601"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            item_get_app - æ ¹æ®IDå–å•†å“è¯¦æƒ…åŸæ•°æ®H5æ•°æ®æ¥å£å®æˆ˜è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4126894064152601/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    APIæŠ€æœ¯å‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T09:37:19.000Z" title="Fri Dec 19 2025 09:37:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€æ¥å£å®šä½ï¼šä¸ºä»€ä¹ˆéœ€è¦â€œåŸæ•°æ®+H5â€åŒé€šé“ï¼Ÿ</h2>
<ol>
<li>çº¯åŸæ•°æ®ï¼ˆJSONï¼‰<br/>
ä½“ç§¯å°ã€å­—æ®µå…¨ï¼Œé€‚åˆä»·æ ¼ç›‘æ§ã€åº“å­˜åŒæ­¥ã€ç®—æ³•æ¨èç­‰åå°åœºæ™¯ã€‚</li>
<li>å¸¦æ¸²æŸ“çš„H5<br/>
ä¿ç•™äº†å¹³å°â€œåƒäººåƒé¢â€çš„æ ·å¼ã€åˆ¸/æ´»åŠ¨/è§†é¢‘ç­‰å¯Œåª’ä½“ï¼Œé€‚åˆåšè½¬é“¾ã€ç¤¾ç¾¤åˆ†äº«ã€å°ç¨‹åºåµŒå¥—ã€‚</li>
</ol>
<p><code>item_get_app</code> çš„æ ¸å¿ƒä»·å€¼å°±æ˜¯ï¼š<strong>ä¸€æ¬¡è°ƒç”¨ï¼ŒåŒæ—¶æ‹¿åˆ°â€œå¯è®¡ç®—çš„åŸæ•°æ® + å¯å±•ç¤ºçš„H5â€</strong> ï¼Œè®©å‰åç«¯ä¸å†å„è°ƒå„çš„æ¥å£ï¼Œå‡å°‘ 30% ä»¥ä¸Šçš„äºŒæ¬¡ç½‘ç»œå¼€é”€ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€èƒ½åŠ›çŸ©é˜µï¼ˆä»¥æ·˜å®/å¤©çŒ«ä¸ºä¾‹ï¼Œå…¶ä»–å¹³å°å­—æ®µåç•¥æœ‰å·®å¼‚ï¼‰</h2>




























































<table><thead><tr><th align="left">èƒ½åŠ›</th><th align="left">åŸæ•°æ®</th><th align="left">H5 ç‰‡æ®µ</th></tr></thead><tbody><tr><td align="left">æ ‡é¢˜ã€å‰¯æ ‡é¢˜</td><td align="left">âœ”</td><td align="left">âœ”ï¼ˆå¸¦é«˜äº®ï¼‰</td></tr><tr><td align="left">ä»·æ ¼ trioï¼ˆåŸä»·/åˆ¸å/æ·˜é‡‘å¸ï¼‰</td><td align="left">âœ”</td><td align="left">âœ”ï¼ˆå¸¦åˆ¸å¼¹å±‚ï¼‰</td></tr><tr><td align="left">ä¸»å›¾ 1~5 å¼ </td><td align="left">âœ”ï¼ˆURL æ•°ç»„ï¼‰</td><td align="left">âœ”ï¼ˆå·²æ‹¼å¥½ 750Ã—750ï¼‰</td></tr><tr><td align="left">è§†é¢‘</td><td align="left">âœ”ï¼ˆmp4 + coverï¼‰</td><td align="left">âœ”ï¼ˆå·²æ’å…¥ video æ ‡ç­¾ï¼‰</td></tr><tr><td align="left">SKU æ‰å¹³åŒ–</td><td align="left">âœ”ï¼ˆmap&lt;id, {price,stock,propPath}&gt;ï¼‰</td><td align="left">âœ”ï¼ˆå·²ç”Ÿæˆé€‰æ‹©å™¨ï¼‰</td></tr><tr><td align="left">åº—é“ºä¿¡æ¯</td><td align="left">âœ”ï¼ˆsellerId, shopTitleï¼‰</td><td align="left">âœ”ï¼ˆå…³æ³¨æŒ‰é’®ï¼‰</td></tr><tr><td align="left">è¯¦æƒ…å›¾</td><td align="left">âœ”ï¼ˆdescImgs[]ï¼‰</td><td align="left">âœ”ï¼ˆæ‡’åŠ è½½ï¼‰</td></tr><tr><td align="left">å®æ—¶åº“å­˜</td><td align="left">âœ”ï¼ˆquantityï¼‰</td><td align="left">âœ˜ï¼ˆéœ€é¢å¤–æ‹‰ï¼‰</td></tr><tr><td align="left">ä¼˜æƒ åˆ¸</td><td align="left">âœ”ï¼ˆcoupon åˆ—è¡¨ï¼‰</td><td align="left">âœ”ï¼ˆå¼¹å±‚ï¼‰</td></tr><tr><td align="left">æ´»åŠ¨æ ‡ï¼ˆæ»¡å‡ã€åˆ†æœŸï¼‰</td><td align="left">âœ”ï¼ˆactivity æ•°ç»„ï¼‰</td><td align="left">âœ”ï¼ˆè§’æ ‡ï¼‰</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€åè®®è®¾è®¡</h2>
<h3 data-id="heading-3">1. è¯·æ±‚</h3>
<p><code>GET /item_get_app?platform=taobao&amp;item_id=723849234892&amp;fields=origin,h5&amp;token={appkey}</code></p>
<p><strong>å‚æ•°è¯´æ˜</strong></p>
<ul>
<li><code>platform</code>ï¼štaobao / jd / pdd / 1688 â€¦</li>
<li><code>item_id</code>ï¼šæ•°å­—å‹ï¼Œæ”¯æŒ 18 ä½é•¿æ•´</li>
<li><code>fields</code>ï¼šoriginï½œh5ï½œorigin,h5</li>
<li><code>token</code>ï¼šå¹³å°é¢å‘çš„ appkey + signï¼ˆHMAC-SHA256ï¼Œæ—¶æ•ˆ 5 minï¼‰</li>
</ul>
<p><strong>Header</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">X-Api-Version: 2.1</span>
<span class="hljs-section">X-Timestamp: 1703001234</span>
<span class="hljs-section">X-Sign: è®¡ç®—sign</span>
</code></pre>
<h3 data-id="heading-4">2. ç­¾åç®—æ³•ï¼ˆä¼ªä»£ç ï¼‰</h3>
<p>å¤åˆ¶</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">sign</span> = <span class="hljs-selector-tag">HMAC_SHA256</span>(
  secret,
  <span class="hljs-built_in">concat</span>(
    <span class="hljs-string">"GET"</span>,
    <span class="hljs-string">"/item_get_app"</span>,
    <span class="hljs-string">"item_id=723849234892&amp;platform=taobao&amp;timestamp=1703001234"</span>
  )
)
</code></pre>
<hr/>
<h2 data-id="heading-5">å››ã€è¿”å›ä½“ï¼ˆå‹ç¼©å 22 KB â†’ 8 KBï¼ŒGzipï¼‰</h2>
<pre><code class="hljs language-JSON" lang="JSON"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"msg"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"success"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"origin"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>               <span class="hljs-comment">// åŸæ•°æ®</span>
      <span class="hljs-attr">"itemId"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">723849234892</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Apple AirPods Pro 2ä»£ æ­£å“å›½è¡Œ"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"price"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"origin"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1999.00</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"actual"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1499.00</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"coupon"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">300.00</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"mainImgs"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">"https://img.alicdn.com/imgextra/i4/220668653240/O1CN01xxx_!!220668653240.jpg_750x750.jpg"</span>
      <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"video"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://cloud.video.taobao.com/play/u/220668653240/p/1/e/6/t/1/423478923478.mp4"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"cover"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://img.alicdn.com/imgextra/i2/220668653240/O1CN02yyy_!!220668653240.jpg"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"skus"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"4873234321"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"price"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1499</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"stock"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">120</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"prop"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"é¢œè‰²:ç™½è‰²"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"4873234322"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"price"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1499</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"stock"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">88</span><span class="hljs-punctuation">,</span>  <span class="hljs-attr">"prop"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"é¢œè‰²:è“è‰²"</span> <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"shop"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">"sellerId"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">220668653240</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"shopName"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Apple å®˜æ–¹æ——èˆ°åº—"</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"descImgs"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span> â€¦ <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"couponList"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span> â€¦ <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"activityList"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span> â€¦ <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"h5"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>                   <span class="hljs-comment">// å¯ç›´æ¥å¡è¿› WebView</span>
      <span class="hljs-attr">"template"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tmall_detail_v8"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"html"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"&lt;!DOCTYPE html&gt;â€¦&lt;/html&gt;"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"css"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"//g.alicdn.com/â€¦/detail.css"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"js"</span><span class="hljs-punctuation">:</span>  <span class="hljs-punctuation">[</span><span class="hljs-string">"//g.alicdn.com/â€¦/detail.js"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"inject"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"itemId"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">723849234892</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"userId"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>               <span class="hljs-comment">// 0 è¡¨ç¤ºæœªç™»å½•</span>
        <span class="hljs-attr">"couponId"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">234234234</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"ttl"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">90</span>                 <span class="hljs-comment">// ç¼“å­˜ 90 sï¼ŒCDN å±‚å¯å†ç¼©</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h2 data-id="heading-6">äº”ã€å®æˆ˜ï¼šVue3 + Vant æ­å»ºâ€œä¸€é”®åˆ†äº«â€å°ç¨‹åº</h2>
<h3 data-id="heading-7">1. ç›®å½•</h3>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-attribute">src</span>/
 â”œâ”€ api/
 â”‚   â””â”€ item<span class="hljs-selector-class">.js</span>        <span class="hljs-comment">// å°è£… item_get_app</span>
 â”œâ”€ pages/
 â”‚   â””â”€ detail<span class="hljs-selector-class">.vue</span>
 â””â”€ utils/
     â””â”€ share<span class="hljs-selector-class">.js</span>       <span class="hljs-comment">// ç”Ÿæˆæµ·æŠ¥</span>
</code></pre>
<h3 data-id="heading-8">2. å°è£…è¯·æ±‚ï¼ˆæ”¯æŒæœ¬åœ° dev proxyï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>
<span class="hljs-keyword">import</span> { getSign } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/sign'</span>

<span class="hljs-keyword">const</span> request = axios.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">baseURL</span>: <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_API_BASE</span>,
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span>
})

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getItemDetail</span>(<span class="hljs-params">itemId</span>) {
  <span class="hljs-keyword">const</span> params = {
    <span class="hljs-attr">platform</span>: <span class="hljs-string">'taobao'</span>,
    <span class="hljs-attr">item_id</span>: itemId,
    <span class="hljs-attr">fields</span>: <span class="hljs-string">'origin,h5'</span>,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
  }
  params.<span class="hljs-property">sign</span> = <span class="hljs-title function_">getSign</span>(params)
  <span class="hljs-keyword">return</span> request.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/item_get_app'</span>, { params })
}
</code></pre>
<h3 data-id="heading-9">3. é¡µé¢éª¨æ¶ï¼ˆåªä¿ç•™æ ¸å¿ƒï¼‰</h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="box"&gt;
    &lt;!-- åŸç”Ÿè§†é¢‘ --&gt;
    &lt;video v-if="video" :src="video.url" :poster="video.cover" controls /&gt;

    &lt;!-- ä»·æ ¼ --&gt;
    &lt;van-row&gt;
      &lt;van-col span="24"&gt;
        &lt;span class="price"&gt;Â¥{{ origin.price.actual }}&lt;/span&gt;
        &lt;span class="coupon"&gt;åˆ¸åçœ{{ origin.price.coupon }}å…ƒ&lt;/span&gt;
      &lt;/van-col&gt;
    &lt;/van-row&gt;

    &lt;!-- SKU é€‰æ‹©å™¨ --&gt;
    &lt;sku-sheet v-model:show="showSku" :skus="origin.skus" @buy="handleBuy" /&gt;

    &lt;!-- WebView åµŒå¥—å¯Œæ–‡æœ¬ --&gt;
    &lt;iframe :srcdoc="h5.html" frameborder="0" width="100%" height="1200" /&gt;

    &lt;!-- åº•éƒ¨æµ®å±‚ --&gt;
    &lt;share-bar @poster="generatePoster" /&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, onMounted } from 'vue'
import { getItemDetail } from '@/api/item'
import SkuSheet from '@/components/SkuSheet.vue'
import ShareBar from '@/components/ShareBar.vue'

const origin = ref({})
const h5 = ref({})
const video = ref(null)
const showSku = ref(false)

onMounted(async () =&gt; {
  const res = await getItemDetail('723849234892')
  origin.value = res.data.origin
  h5.value = res.data.h5
  video.value = res.data.origin.video
})

function generatePoster() {
  // è°ƒç”¨ canvas åˆæˆï¼šä¸»å›¾ + äºŒç»´ç  + ä»·æ ¼
  // æ­¤å¤„ç•¥
}
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-10">4. æµ·æŠ¥åˆæˆï¼ˆnode-canvas äº‘å‡½æ•°ç‰ˆï¼Œ35 msï¼‰</h3>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> canvas = <span class="hljs-title function_">createCanvas</span>(<span class="hljs-number">750</span>, <span class="hljs-number">1334</span>)
<span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>)
<span class="hljs-comment">// 1. åº•å›¾</span>
<span class="hljs-keyword">const</span> bg = <span class="hljs-keyword">await</span> <span class="hljs-title function_">loadImage</span>(origin.<span class="hljs-property">mainImgs</span>[<span class="hljs-number">0</span>])
ctx.<span class="hljs-title function_">drawImage</span>(bg, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">750</span>, <span class="hljs-number">750</span>)
<span class="hljs-comment">// 2. ä»·æ ¼æ¡</span>
ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">'rgba(0,0,0,0.6)'</span>
ctx.<span class="hljs-title function_">fillRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">750</span>, <span class="hljs-number">750</span>, <span class="hljs-number">120</span>)
ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">'#fff'</span>
ctx.<span class="hljs-property">font</span> = <span class="hljs-string">'bold 56px PingFang SC'</span>
ctx.<span class="hljs-title function_">fillText</span>(<span class="hljs-string">`Â¥<span class="hljs-subst">${origin.price.actual}</span>`</span>, <span class="hljs-number">40</span>, <span class="hljs-number">820</span>)
<span class="hljs-comment">// 3. äºŒç»´ç </span>
<span class="hljs-keyword">const</span> qrcode = <span class="hljs-keyword">await</span> <span class="hljs-title function_">generateQR</span>(<span class="hljs-string">`https://m.tb.cn/h.5xxx?itemId=<span class="hljs-subst">${origin.itemId}</span>`</span>)
ctx.<span class="hljs-title function_">drawImage</span>(qrcode, <span class="hljs-number">580</span>, <span class="hljs-number">900</span>, <span class="hljs-number">150</span>, <span class="hljs-number">150</span>)
<span class="hljs-keyword">return</span> canvas.<span class="hljs-title function_">toBuffer</span>(<span class="hljs-string">'jpeg'</span>, { <span class="hljs-attr">quality</span>: <span class="hljs-number">0.8</span> })
</code></pre>
<hr/>
<h2 data-id="heading-11">å…­ã€æ€§èƒ½ &amp; ç¨³å®šæ€§</h2>
<ol>
<li>
<p>ç¼“å­˜</p>
<ul>
<li>ä¸šåŠ¡å±‚ï¼šRedis 90 sï¼Œkey=<code>ig:{platform}:{item_id}</code></li>
<li>CDNï¼šæ ¹æ® <code>Last-Modified</code> åš 304ï¼Œå›æºç‡ &lt; 3%</li>
</ul>
</li>
<li>
<p>é™çº§</p>
<ul>
<li>åŸæ•°æ®è¶…æ—¶ 400 ms â†’ ç›´æ¥è¿”å›â€œH5 onlyâ€ï¼Œå‰ç«¯å¼¹â€œç½‘ç»œè¾ƒæ…¢ï¼Œå·²æ™ºèƒ½å±•ç¤ºâ€</li>
<li>H5 è¶…æ—¶ 800 ms â†’ é€€åŒ–ä¸ºåŸç”Ÿç»„ä»¶æ¸²æŸ“ï¼ˆæ ‡é¢˜+ä»·æ ¼+è½®æ’­ï¼‰</li>
</ul>
</li>
<li>
<p>é™æµ</p>
<ul>
<li>å• appkey 500 QPS / 1 minï¼Œè¶…å‡ºè¿”å› 429ï¼Œå¸¦ <code>Retry-After</code></li>
</ul>
</li>
<li>
<p>ç›‘æ§</p>
<ul>
<li>SLIï¼šP99 latency &lt; 600 msï¼Œå¯ç”¨æ€§ &gt; 99.9%</li>
<li>åŸ‹ç‚¹ï¼šitemIdã€platformã€å›æºæ¬¡æ•°ã€é™çº§æ¬¡æ•°</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-12">ä¸ƒã€å¸¸è§å‘</h2>
<ol>
<li>é•¿æ•´å‹ç²¾åº¦<br/>
JavaScript æœ€å¤§å®‰å…¨æ•´æ•° 2^53-1ï¼Œæ·˜å® itemId 19 ä½ â†’ å¿…ç”¨å­—ç¬¦ä¸²å‹è¿”å›ã€‚</li>
<li>åˆ¸å®æ—¶æ€§<br/>
åˆ¸æ±  30 s å»¶è¿Ÿï¼Œå‰ç«¯è‹¥éœ€è¦â€œç«‹å³é¢†åˆ¸â€éœ€å†è°ƒ <code>coupon_receive</code> æ¥å£äºŒæ¬¡ç¡®è®¤ã€‚</li>
<li>è¯¦æƒ…å›¾é˜²ç›—é“¾<br/>
<code>descImgs</code> å¸¦ <code>gm.toutiao.com</code> æˆ– <code>alicdn.com</code>ï¼Œéœ€åœ¨å°ç¨‹åºé‡ŒåŠ  <code>referer-policy="no-referrer"</code>ã€‚</li>
<li>ä»·æ ¼å­—æ®µæ¼‚ç§»<br/>
å¤§ä¿ƒ 0 ç‚¹å‰å 5 minï¼Œå¹³å°ä¼šäºŒæ¬¡æ ¡æ­£ä»·æ ¼ï¼Œå»ºè®®ç¼“å­˜ç¼©çŸ­åˆ° 30 s æˆ–ç›´æ¥é€ä¼  <code>cache-control: no-cache</code>ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-13">å…«ã€æ‰©å±•æ–¹å‘</h2>
<ol>
<li>ç›´æ’­ä¸“åœº<br/>
åœ¨ <code>origin</code> é‡ŒåŠ  <code>liveId</code>ï¼Œ<code>h5</code> ç›´æ¥è¿”å›ç›´æ’­æ‚¬æµ®çª—ã€‚</li>
<li>è·¨å¢ƒå¤šè¯­è¨€<br/>
æ–°å¢ <code>lang=en</code> å‚æ•°ï¼Œè¿”å› <code>origin_en</code> + <code>h5_en</code>ï¼ŒUSD ä»·èµ°å®æ—¶æ±‡ç‡ã€‚</li>
<li>ç¦»çº¿åŒ…<br/>
æŠŠ <code>h5.js/css</code> é¢„ç½®åˆ° App æœ¬åœ°ï¼Œæ¥å£åªå› <code>html + inject</code>ï¼Œé¦–å±å†çœ 200 msã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-14">ä¹ã€ç»“è¯­</h2>
<p><code>item_get_app</code> é€šè¿‡â€œåŸæ•°æ®+H5â€åŒé€šé“è®¾è®¡ï¼Œè®©<strong>ç®—æ³•åå°</strong>ä¸<strong>ç”¨æˆ·ç»ˆç«¯</strong>å„å–æ‰€éœ€ï¼Œä¸€æ¬¡è°ƒç”¨å³å¯è¦†ç›–ä»·æ ¼ã€åº“å­˜ã€å¯Œåª’ä½“ã€åˆ¸ã€æ´»åŠ¨å…¨è¦ç´ ã€‚å†é…åˆæœ¬åœ°ç¼“å­˜ã€äº‘å‡½æ•°æµ·æŠ¥ã€ç¦»çº¿åŒ…ç­‰ç­–ç•¥ï¼Œèƒ½åœ¨ 500 ms å†…å®Œæˆå•†å“è¯¦æƒ…é—­ç¯ï¼Œä¸ºå¯¼è´­ã€ç¤¾ç¾¤ã€å°ç¨‹åºã€ERP ç­‰å¤šåœºæ™¯æä¾›å¼€ç®±å³ç”¨çš„â€œæ°´ç”µç…¤â€çº§èƒ½åŠ›ã€‚</p>
<p>å¦‚é‡ä»»ä½•ç–‘é—®æˆ–æœ‰è¿›ä¸€æ­¥çš„éœ€æ±‚ï¼Œè¯·éšæ—¶ä¸æˆ‘ç§ä¿¡æˆ–è€…è¯„è®ºè”ç³»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Chrome DevTools è¯¦è§£ç³»åˆ—ä¹‹ Elementsé¢æ¿]]></title>    <link>https://juejin.cn/post/7585214391828643883</link>    <guid>https://juejin.cn/post/7585214391828643883</guid>    <pubDate>2025-12-19T09:43:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585214391828643883" data-draft-id="7585206549305704511" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Chrome DevTools è¯¦è§£ç³»åˆ—ä¹‹ Elementsé¢æ¿"/> <meta itemprop="keywords" content="JavaScript,æµè§ˆå™¨"/> <meta itemprop="datePublished" content="2025-12-19T09:43:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å…«å“¥ç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/114004940297325"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Chrome DevTools è¯¦è§£ç³»åˆ—ä¹‹ Elementsé¢æ¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/114004940297325/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å…«å“¥ç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T09:43:40.000Z" title="Fri Dec 19 2025 09:43:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><blockquote>
<p>æ¥è§¦å‰ç«¯çš„ç¬¬ä¸€å¤©ï¼Œä½ å¯èƒ½å°±ä¼šæŸ¥çœ‹è¯¥é¢æ¿äº†ï¼Œä½†ä½ çŸ¥é“å…¶ä»–çš„ç”¨æ³•åŠŸèƒ½å—ï¼Ÿ</p>
</blockquote>
<h2 data-id="heading-0">å¼•è¨€</h2>
<p>ä½œä¸ºå‰ç«¯å¼€å‘è€…ï¼ŒElements é¢æ¿æ˜¯æˆ‘ä»¬æ—¥å¸¸å·¥ä½œä¸­ä½¿ç”¨æœ€é¢‘ç¹çš„å·¥å…·ä¹‹ä¸€ã€‚ç„¶è€Œï¼Œå¤§å¤šæ•°å¼€å‘è€…ä»…åœç•™åœ¨åŸºç¡€çš„ DOM æŸ¥çœ‹å’Œæ ·å¼ä¿®æ”¹å±‚é¢ï¼Œæœªèƒ½å……åˆ†å‘æŒ¥å…¶å¼ºå¤§çš„é«˜çº§åŠŸèƒ½ã€‚æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥æ¢ç´¢ Elements é¢æ¿çš„é«˜çº§ç‰¹æ€§ï¼Œä» DOM ç»“æ„è°ƒè¯•åˆ°æ ·å¼ä¼˜åŒ–ï¼Œä»å¸ƒå±€åˆ†æåˆ°æ€§èƒ½è°ƒä¼˜ï¼Œå…¨æ–¹ä½æå‡ä½ çš„è°ƒè¯•æ•ˆç‡å’Œé—®é¢˜è§£å†³èƒ½åŠ›ã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€Elements é¢æ¿æ¶æ„ä¸å·¥ä½œåŸç†</h2>
<h3 data-id="heading-2">1.1 é¢æ¿åº•å±‚æœºåˆ¶</h3>
<p>Elements é¢æ¿å¹¶éç®€å•åœ°å±•ç¤º DOM æ ‘ï¼Œå®ƒèƒŒåæœ‰ç€å¤æ‚çš„å®ç°æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Chrome æ¸²æŸ“å¼•æ“                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DOM æ ‘    â”‚ æ ·å¼è®¡ç®—æ ‘ (Style Calculation Tree)          â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
<span class="hljs-code">     â”‚                       â”‚                            â”‚
     â–¼                       â–¼                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚ DOM èŠ‚ç‚¹æ“ä½œ    â”‚ â”‚ æ ·å¼è§„åˆ™åŒ¹é…ä¸è®¡ç®—   â”‚                â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
     â”‚                      â”‚                             â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
                   â–¼                                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Elements é¢æ¿ç•Œé¢                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å·¦ä¾§ï¼šDOM æ ‘ç»“æ„  â”ƒ å³ä¾§ï¼šæ ·å¼ã€å¸ƒå±€ã€äº‹ä»¶ã€æ–­ç‚¹é¢æ¿        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre>
<p><strong>å…³é”®æœºåˆ¶</strong>ï¼š</p>
<ul>
<li>Elements é¢æ¿å®æ—¶åŒæ­¥æ¸²æŸ“å¼•æ“çš„ DOM æ ‘å’Œæ ·å¼è®¡ç®—ç»“æœ</li>
<li>æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŒå‘çš„ï¼šä¿®æ”¹é¢æ¿å†…å®¹ä¼šåŒæ­¥åˆ°é¡µé¢ï¼Œé¡µé¢å˜åŒ–ä¹Ÿä¼šå®æ—¶åæ˜ åˆ°é¢æ¿</li>
<li>æ ·å¼è®¡ç®—åŸºäº CSSOMï¼ˆCSS å¯¹è±¡æ¨¡å‹ï¼‰å’Œ DOM æ ‘çš„ç»“åˆ</li>
</ul>
<h3 data-id="heading-3">1.2 æ€§èƒ½å½±å“åˆ†æ</h3>
<p>ä½¿ç”¨ Elements é¢æ¿æ—¶éœ€è¦æ³¨æ„å…¶å¯¹é¡µé¢æ€§èƒ½çš„å½±å“ï¼š</p>
<ul>
<li>é¢‘ç¹çš„æ ·å¼ä¿®æ”¹ä¼šè§¦å‘é‡æ’ï¼ˆReflowï¼‰å’Œé‡ç»˜ï¼ˆRepaintï¼‰</li>
<li>DOM ç»“æ„ä¿®æ”¹ä¼šå½±å“é¡µé¢çš„æ¸²æŸ“æµç¨‹</li>
<li>é«˜çº§åŠŸèƒ½ï¼ˆå¦‚ DOM æ–­ç‚¹ï¼‰ä¼šå¢åŠ  JavaScript æ‰§è¡Œå¼€é”€</li>
</ul>
<p><strong>ä¼˜åŒ–å»ºè®®</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ‰¹é‡ä¿®æ”¹ DOM æ—¶ï¼Œä½¿ç”¨ DocumentFragment å‡å°‘é‡æ’</span>
<span class="hljs-keyword">const</span> fragment = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createDocumentFragment</span>();
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
    <span class="hljs-keyword">const</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
    div.<span class="hljs-property">textContent</span> = <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span>;
    fragment.<span class="hljs-title function_">appendChild</span>(div);
}
<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(fragment);
</code></pre>
<hr/>
<h2 data-id="heading-4">äºŒã€DOM é«˜çº§æ“ä½œä¸è°ƒè¯•æŠ€å·§</h2>
<h3 data-id="heading-5">2.1 DOM æ ‘çš„é«˜çº§å¯¼èˆª</h3>
<h4 data-id="heading-6">2.1.1 æœç´¢ä¸è¿‡æ»¤é«˜çº§æŠ€å·§</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// CSS é€‰æ‹©å™¨æœç´¢</span>
#app &gt; .<span class="hljs-property">container</span> .<span class="hljs-property">item</span>

<span class="hljs-comment">// XPath æœç´¢</span>
<span class="hljs-comment">//div[@class='container']//span[text()='Hello']</span>

<span class="hljs-comment">// æ–‡æœ¬å†…å®¹æœç´¢</span>
:<span class="hljs-title function_">contains</span>(<span class="hljs-string">"Error"</span>)
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c7c3739cf3943de9ee018bb17c20238~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWr5ZOl56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766742219&amp;x-signature=tMCXXvq5Xeq72O7LIrR3mB7wq2U%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p><strong>é«˜çº§æœç´¢åŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>Ctrl + F</code> æ‰“å¼€æœç´¢æ¡†ï¼Œæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼</li>
<li>æœç´¢ç»“æœé«˜äº®æ˜¾ç¤ºï¼Œå¯ä½¿ç”¨ä¸Šä¸‹ç®­å¤´å¯¼èˆª</li>
<li>æ”¯æŒå¤šç§æœç´¢ç±»å‹ï¼šCSS é€‰æ‹©å™¨ã€XPathã€æ–‡æœ¬å†…å®¹</li>
</ul>
<p><strong>é„™äººå–œæ¬¢ä½¿ç”¨ css é€‰æ‹©å™¨ã€æ–‡æœ¬å†…å®¹å»æœï¼ˆç®€å•ã€å¿«æ·ï¼‰</strong></p>
<h4 data-id="heading-7">2.1.2 DOM èŠ‚ç‚¹æ˜ å°„ä¸å®šä½</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœ¨ Console ä¸­ç›´æ¥å¼•ç”¨ Elements é¢æ¿é€‰ä¸­çš„èŠ‚ç‚¹</span>
$0 <span class="hljs-comment">// å½“å‰é€‰ä¸­çš„èŠ‚ç‚¹</span>
$1 <span class="hljs-comment">// ä¸Šä¸€ä¸ªé€‰ä¸­çš„èŠ‚ç‚¹</span>
$2 <span class="hljs-comment">// ä¸Šä¸Šä¸€ä¸ªé€‰ä¸­çš„èŠ‚ç‚¹</span>

<span class="hljs-comment">// ä½¿ç”¨ copy å‘½ä»¤å¤åˆ¶èŠ‚ç‚¹</span>
<span class="hljs-title function_">copy</span>($0) <span class="hljs-comment">// å¤åˆ¶èŠ‚ç‚¹çš„ HTML ç»“æ„</span>
<span class="hljs-title function_">copy</span>($0.<span class="hljs-property">outerHTML</span>) <span class="hljs-comment">// å¤åˆ¶åŒ…æ‹¬èŠ‚ç‚¹æœ¬èº«çš„ HTML</span>
</code></pre>
<p><strong>å®ç”¨æŠ€å·§</strong>ï¼š</p>
<ul>
<li>åœ¨ Elements é¢æ¿ä¸­å³é”®ç‚¹å‡»èŠ‚ç‚¹ â†’ é€‰æ‹© "Store as global variable"ï¼Œå¯å°†èŠ‚ç‚¹ä¿å­˜ä¸ºå…¨å±€å˜é‡</li>
<li>ä½¿ç”¨ <code>inspect($0)</code> å‘½ä»¤åœ¨ Elements é¢æ¿ä¸­å®šä½ Console ä¸­çš„ DOM èŠ‚ç‚¹</li>
</ul>
<h3 data-id="heading-8">2.2 DOM åŠ¨æ€å˜åŒ–è°ƒè¯•</h3>
<h4 data-id="heading-9">2.2.1 DOM æ–­ç‚¹æ·±åº¦è§£æ</h4>

























<table><thead><tr><th>æ–­ç‚¹ç±»å‹</th><th>è§¦å‘æ¡ä»¶</th><th>ä½¿ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>å­æ ‘ä¿®æ”¹</td><td>å­èŠ‚ç‚¹æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹</td><td>è°ƒè¯•åŠ¨æ€ç»„ä»¶æ¸²æŸ“ã€åˆ—è¡¨æ›´æ–°</td></tr><tr><td>å±æ€§ä¿®æ”¹</td><td>å±æ€§å€¼å˜åŒ–</td><td>è°ƒè¯•æ ·å¼å˜åŒ–ã€çŠ¶æ€æ›´æ–°</td></tr><tr><td>èŠ‚ç‚¹ç§»é™¤</td><td>èŠ‚ç‚¹è¢«åˆ é™¤</td><td>è°ƒè¯•ç»„ä»¶å¸è½½ã€åŠ¨æ€æ¸…ç†</td></tr></tbody></table>
<p><strong>é«˜çº§ç”¨æ³•</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç»“åˆ Console API è°ƒè¯• DOM å˜åŒ–</span>
<span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutationObserver</span>(<span class="hljs-function">(<span class="hljs-params">mutations</span>) =&gt;</span> {
    mutations.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">mutation</span>) =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'DOM å˜åŒ–ç±»å‹:'</span>, mutation.<span class="hljs-property">type</span>);
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å˜åŒ–çš„èŠ‚ç‚¹:'</span>, mutation.<span class="hljs-property">target</span>);
    });
});

observer.<span class="hljs-title function_">observe</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>, {
    <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">attributes</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>
});
</code></pre>
<h4 data-id="heading-10">2.2.2 Mutation Observer ä¸ Elements é¢æ¿ç»“åˆ</h4>
<ol>
<li>åœ¨ Elements é¢æ¿ä¸­è®¾ç½® DOM æ–­ç‚¹</li>
<li>å½“æ–­ç‚¹è§¦å‘æ—¶ï¼Œåœ¨ Sources é¢æ¿ä¸­æŸ¥çœ‹è°ƒç”¨æ ˆ</li>
<li>ç»“åˆ Mutation Observer API è¿½è¸ªæ‰€æœ‰ DOM å˜åŒ–</li>
</ol>
<hr/>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/43f0eebceee140728293af2e7e172ca5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWr5ZOl56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766742219&amp;x-signature=gsw7XU1ejSe8rDbwkEt4o%2BqdV4A%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-11">ä¸‰ã€æ ·å¼ç³»ç»Ÿæ·±åº¦è°ƒè¯•</h2>
<h3 data-id="heading-12">3.1 æ ·å¼ä¼˜å…ˆçº§ä¸ç»§æ‰¿æœºåˆ¶</h3>
<h4 data-id="heading-13">3.1.1 æ ·å¼ä¼˜å…ˆçº§è®¡ç®—</h4>
<p>Elements é¢æ¿ä¼šè‡ªåŠ¨è®¡ç®—æ ·å¼ä¼˜å…ˆçº§ï¼Œæ˜¾ç¤ºä¸ºï¼š</p>
<pre><code class="hljs language-scss" lang="scss">å†…è”æ ·å¼ (<span class="hljs-number">1000</span>) &gt; ID é€‰æ‹©å™¨ (<span class="hljs-number">100</span>) &gt; ç±»é€‰æ‹©å™¨ (<span class="hljs-number">10</span>) &gt; æ ‡ç­¾é€‰æ‹©å™¨ (<span class="hljs-number">1</span>)
</code></pre>
<p><strong>é«˜çº§æŠ€å·§</strong>ï¼š</p>
<ul>
<li>åœ¨æ ·å¼é¢æ¿ä¸­ï¼Œè¢«è¦†ç›–çš„æ ·å¼ä¼šæ˜¾ç¤ºä¸ºç°è‰²å¹¶å¸¦æœ‰åˆ é™¤çº¿</li>
<li>æ‚¬åœåœ¨æ ·å¼è§„åˆ™ä¸Šï¼Œå¯æŸ¥çœ‹è¯¥è§„åˆ™çš„å…·ä½“ä¼˜å…ˆçº§æ•°å€¼</li>
<li>ä½¿ç”¨ <code>!important</code> ä¼šå°†ä¼˜å…ˆçº§æå‡åˆ°æœ€é«˜ï¼Œä½†åº”å°½é‡é¿å…ä½¿ç”¨</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14713da10fbb42c4b38a4c8bc284a1ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWr5ZOl56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766742219&amp;x-signature=66TSR%2BE2eSUy5g8NFVk7zMz16WU%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h4 data-id="heading-14">3.1.2 CSS å˜é‡ä¸è‡ªå®šä¹‰å±æ€§é«˜çº§è°ƒè¯•</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-pseudo">:root</span> {
    <span class="hljs-attr">--primary-color</span>: <span class="hljs-number">#007bff</span>;
    <span class="hljs-attr">--secondary-color</span>: <span class="hljs-number">#6c757d</span>;
    <span class="hljs-attr">--spacing-unit</span>: <span class="hljs-number">8px</span>;
}

<span class="hljs-selector-class">.card</span> {
    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">var</span>(--primary-color);
    <span class="hljs-attribute">padding</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-built_in">var</span>(--spacing-unit) * <span class="hljs-number">2</span>);
    <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">var</span>(--secondary-color);
}
</code></pre>
<p><strong>è°ƒè¯•æŠ€å·§</strong>ï¼š</p>
<ul>
<li>åœ¨ Elements é¢æ¿ä¸­ï¼ŒCSS å˜é‡ä¼šæ˜¾ç¤ºä¸ºè“è‰²ï¼Œå¯ç‚¹å‡»æŸ¥çœ‹å…¶å®šä¹‰</li>
<li>æ”¯æŒå®æ—¶ä¿®æ”¹ CSS å˜é‡ï¼Œæ‰€æœ‰ä½¿ç”¨è¯¥å˜é‡çš„å…ƒç´ ä¼šç«‹å³æ›´æ–°</li>
<li>åœ¨ "è®¡ç®—æ ·å¼" é¢æ¿ä¸­ï¼Œå¯æŸ¥çœ‹ CSS å˜é‡çš„æœ€ç»ˆè®¡ç®—å€¼</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf19e7610e5d4d8d89827e55948e6432~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWr5ZOl56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766742219&amp;x-signature=k%2BKT3p8iqxoKREOIxd8TE4D8EWg%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-15">3.2 æ ·å¼æ€§èƒ½åˆ†æä¸ä¼˜åŒ–</h3>
<h4 data-id="heading-16">3.2.1 é‡æ’ä¸é‡ç»˜è¿½è¸ª</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åœ¨ Console ä¸­å¯ç”¨æ¸²æŸ“æ€§èƒ½æŒ‡æ ‡</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'reflow'</span>);
<span class="hljs-comment">// æ‰§è¡Œå¯èƒ½è§¦å‘é‡æ’çš„æ“ä½œ</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.card'</span>).<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">'200px'</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'reflow'</span>);
</code></pre>
<p><strong>Elements é¢æ¿è¾…åŠ©åŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>æ‰“å¼€ "Rendering" é¢æ¿ï¼ˆCmd + Shift + P â†’ æœç´¢ "Rendering"ï¼‰</li>
<li>å‹¾é€‰ "Paint flashing"ï¼šé‡ç»˜åŒºåŸŸä¼šæ˜¾ç¤ºä¸ºç»¿è‰²</li>
<li>å‹¾é€‰ "Layout Shift Regions"ï¼šå¸ƒå±€åç§»åŒºåŸŸä¼šæ˜¾ç¤ºä¸ºè“è‰²</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fa0bef9a4b44463386e03b2e9c2265b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWr5ZOl56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766742219&amp;x-signature=nx%2FqmaVQ4C51aCTmLwRJhnoy3HQ%3D" alt="e6e9e65a-d3df-4fd5-ba40-ed9460a9bfbb.gif" loading="lazy"/></p>
<h4 data-id="heading-17">3.2.2 æ ·å¼è®¡ç®—ä¼˜åŒ–</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* ä½æ•ˆçš„é€‰æ‹©å™¨é“¾ */</span>
<span class="hljs-selector-tag">body</span> &gt; <span class="hljs-selector-tag">div</span><span class="hljs-selector-class">.container</span> &gt; <span class="hljs-selector-tag">ul</span><span class="hljs-selector-class">.list</span> &gt; <span class="hljs-selector-tag">li</span><span class="hljs-selector-class">.item</span> &gt; <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.link</span> {
    <span class="hljs-attribute">color</span>: <span class="hljs-number">#007bff</span>;
}

<span class="hljs-comment">/* ä¼˜åŒ–åçš„é€‰æ‹©å™¨ */</span>
<span class="hljs-selector-class">.item</span> <span class="hljs-selector-class">.link</span> {
    <span class="hljs-attribute">color</span>: <span class="hljs-number">#007bff</span>;
}
</code></pre>
<p><strong>ä¼˜åŒ–å»ºè®®</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨æ›´ç®€æ´çš„é€‰æ‹©å™¨ï¼Œå‡å°‘æ ·å¼è®¡ç®—æ—¶é—´</li>
<li>é¿å…ä½¿ç”¨å¤æ‚çš„åä»£é€‰æ‹©å™¨å’Œå…„å¼Ÿé€‰æ‹©å™¨</li>
<li>å°†å¸¸ç”¨æ ·å¼æå–ä¸ºå•ç‹¬çš„ç±»ï¼Œæé«˜å¤ç”¨æ€§</li>
</ul>
<hr/>
<h2 data-id="heading-18">å››ã€å¸ƒå±€ç³»ç»Ÿæ·±åº¦åˆ†æ</h2>
<h3 data-id="heading-19">4.1 ç›’æ¨¡å‹ä¸å®šä½æœºåˆ¶</h3>
<h4 data-id="heading-20">4.1.1 ç›’æ¨¡å‹é«˜çº§è°ƒè¯•</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.box</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
    <span class="hljs-attribute">border</span>: <span class="hljs-number">2px</span> solid <span class="hljs-number">#007bff</span>;
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span>;
    <span class="hljs-comment">/* ç›’æ¨¡å‹è®¡ç®—æ–¹å¼ */</span>
    <span class="hljs-attribute">box-sizing</span>: border-box; <span class="hljs-comment">/* æ¨è */</span>
    <span class="hljs-comment">/* box-sizing: content-box;  é»˜è®¤ */</span>
}
</code></pre>
<p><strong>ç›’æ¨¡å‹æŸ¥çœ‹æŠ€å·§</strong>ï¼š</p>
<ul>
<li>åœ¨ Elements é¢æ¿çš„ "å¸ƒå±€" é€‰é¡¹å¡ä¸­æŸ¥çœ‹ç›’æ¨¡å‹å¯è§†åŒ–</li>
<li>æ”¯æŒåˆ‡æ¢ <code>content-box</code> å’Œ <code>border-box</code> æ¨¡å¼</li>
<li>æ˜¾ç¤ºå…ƒç´ çš„å®é™…å ç”¨ç©ºé—´ï¼ˆåŒ…æ‹¬ marginï¼‰</li>
</ul>
<h4 data-id="heading-21">4.1.2 å®šä½ä¸å±‚å ä¸Šä¸‹æ–‡</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.absolute-element</span> {
    <span class="hljs-attribute">position</span>: absolute;
    <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">z-index</span>: <span class="hljs-number">10</span>;
}

<span class="hljs-selector-class">.relative-element</span> {
    <span class="hljs-attribute">position</span>: relative;
    <span class="hljs-attribute">z-index</span>: <span class="hljs-number">5</span>;
}
</code></pre>
<p><strong>å±‚å ä¸Šä¸‹æ–‡è°ƒè¯•</strong>ï¼š</p>
<ul>
<li>åœ¨ "Computed" é¢æ¿ä¸­æŸ¥çœ‹å…ƒç´ çš„ <code>z-index</code> å’Œå±‚å ä¸Šä¸‹æ–‡</li>
<li>ä½¿ç”¨ "Layers" é¢æ¿ï¼ˆCmd + Shift + P â†’ æœç´¢ "Layers"ï¼‰æŸ¥çœ‹å…ƒç´ çš„æ¸²æŸ“å±‚</li>
<li>åˆ†æå…ƒç´ çš„å±‚å é¡ºåºï¼Œè§£å†³å±‚å å†²çªé—®é¢˜</li>
</ul>
<p>è°ƒè¯•çš„æ—¶å€™ä¸»è¦å…³æ³¨ä»¥ä¸‹ä¿¡æ¯</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a0ef5f8857124694a84edd303375caa1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWr5ZOl56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766742219&amp;x-signature=cTxk6t474mCkpi41keToeXk27nM%3D" alt="50110596-0a1f-4e0a-8e40-be998501c3d6.png" loading="lazy"/></p>
<p>å½“å‰ç½‘é¡µæ¸²æŸ“çš„æ—¶å€™å…¶å®æ˜¯åˆ†äº†å¤šä¸ªå›¾å±‚çš„ï¼Œè¯·çœ‹ä¸‹é¢çš„åŠ¨ç”»å±•ç¤º</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e104c3ddb814151b43aedcad0b9694d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWr5ZOl56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766742219&amp;x-signature=E6Gqo65cUIg2tD%2B6t01sN7qRu2g%3D" alt="9c512ff9-03fc-4a12-8e9e-e9a52cd913fa.gif" loading="lazy"/></p>
<p>å¯ä»¥æ˜æ˜¾çš„çœ‹åˆ°ä¸Šä¸‹å±‚çº§å…³ç³»</p>
<h3 data-id="heading-22">4.2 Flexbox ä¸ Grid å¸ƒå±€é«˜çº§è°ƒè¯•</h3>
<h4 data-id="heading-23">4.2.1 Flexbox å¸ƒå±€åˆ†æ</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.flex-container</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">justify-content</span>: space-between;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">flex-wrap</span>: wrap;
    <span class="hljs-attribute">gap</span>: <span class="hljs-number">10px</span>;
}

<span class="hljs-selector-class">.flex-item</span> {
    <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">200px</span>;
    <span class="hljs-attribute">min-width</span>: <span class="hljs-number">150px</span>;
}
</code></pre>
<p><strong>Flexbox è°ƒè¯•åŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>åœ¨ "Layout" é€‰é¡¹å¡ä¸­å‹¾é€‰ "Flexbox"ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºå¼¹æ€§å¸ƒå±€ç½‘æ ¼çº¿</li>
<li>æ˜¾ç¤º <code>justify-content</code>ã€<code>align-items</code> ç­‰å±æ€§çš„å¯è§†åŒ–æ•ˆæœ</li>
<li>å®æ—¶è°ƒæ•´ flex å±æ€§ï¼ŒæŸ¥çœ‹å¸ƒå±€å˜åŒ–</li>
</ul>
<h4 data-id="heading-24">4.2.2 Grid å¸ƒå±€åˆ†æ</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.grid-container</span> {
    <span class="hljs-attribute">display</span>: grid;
    <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-built_in">repeat</span>(<span class="hljs-number">3</span>, <span class="hljs-number">1</span>fr);
    <span class="hljs-attribute">grid-template-rows</span>: auto <span class="hljs-number">1</span>fr auto;
    <span class="hljs-attribute">grid-template-areas</span>: 
        <span class="hljs-string">"header header header"</span>
        <span class="hljs-string">"main main sidebar"</span>
        <span class="hljs-string">"footer footer footer"</span>;
    <span class="hljs-attribute">gap</span>: <span class="hljs-number">20px</span>;
}

<span class="hljs-selector-class">.header</span> { <span class="hljs-attribute">grid-area</span>: header; }
<span class="hljs-selector-class">.main</span> { <span class="hljs-attribute">grid-area</span>: main; }
<span class="hljs-selector-class">.sidebar</span> { <span class="hljs-attribute">grid-area</span>: sidebar; }
<span class="hljs-selector-class">.footer</span> { <span class="hljs-attribute">grid-area</span>: footer; }
</code></pre>
<p><strong>Grid è°ƒè¯•åŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>åœ¨ "Layout" é€‰é¡¹å¡ä¸­å‹¾é€‰ "Grid"ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºç½‘æ ¼çº¿å’ŒåŒºåŸŸ</li>
<li>æ˜¾ç¤ºç½‘æ ¼çº¿ç¼–å·å’Œè½¨é“å¤§å°</li>
<li>æ”¯æŒå®æ—¶ä¿®æ”¹ç½‘æ ¼å±æ€§ï¼ŒæŸ¥çœ‹å¸ƒå±€å˜åŒ–</li>
</ul>
<hr/>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/709ffd44bcb149dcb0918d461bb2b5a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWr5ZOl56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766742219&amp;x-signature=xXZVjnBy%2BfBzaH98nh6DIleFEDk%3D" alt="ea345686-fed0-4f35-8e39-2981afdbcadc.png" loading="lazy"/></p>
<h2 data-id="heading-25">äº”ã€äº‹ä»¶ç³»ç»Ÿä¸äº¤äº’è°ƒè¯•</h2>
<h3 data-id="heading-26">5.1 äº‹ä»¶ç›‘å¬å™¨æ·±åº¦åˆ†æ</h3>
<h4 data-id="heading-27">5.1.1 äº‹ä»¶æ•è·ä¸å†’æ³¡æœºåˆ¶</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> button = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.btn'</span>);

<span class="hljs-comment">// æ•è·é˜¶æ®µè§¦å‘</span>
button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•è·é˜¶æ®µ'</span>);
}, <span class="hljs-literal">true</span>);

<span class="hljs-comment">// å†’æ³¡é˜¶æ®µè§¦å‘</span>
button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å†’æ³¡é˜¶æ®µ'</span>);
}, <span class="hljs-literal">false</span>);
</code></pre>
<p><strong>äº‹ä»¶ç›‘å¬å™¨æŸ¥çœ‹æŠ€å·§</strong>ï¼š</p>
<ul>
<li>åœ¨ "Event Listeners" é€‰é¡¹å¡ä¸­æŸ¥çœ‹å…ƒç´ çš„æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨</li>
<li>æ˜¾ç¤ºäº‹ä»¶ç±»å‹ã€å¤„ç†å‡½æ•°ã€æ•è·/å†’æ³¡é˜¶æ®µ</li>
<li>æ”¯æŒè¿‡æ»¤ç‰¹å®šç±»å‹çš„äº‹ä»¶</li>
</ul>
<h4 data-id="heading-28">5.1.2 äº‹ä»¶å§”æ‰˜ä¸æ€§èƒ½ä¼˜åŒ–</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½æ•ˆï¼šä¸ºæ¯ä¸ªå…ƒç´ æ·»åŠ äº‹ä»¶ç›‘å¬å™¨</span>
<span class="hljs-keyword">const</span> items = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'.item'</span>);
items.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
    item.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Item clicked'</span>);
    });
});

<span class="hljs-comment">// é«˜æ•ˆï¼šä½¿ç”¨äº‹ä»¶å§”æ‰˜</span>
<span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.container'</span>);
container.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (e.<span class="hljs-property">target</span>.<span class="hljs-property">classList</span>.<span class="hljs-title function_">contains</span>(<span class="hljs-string">'item'</span>)) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Item clicked'</span>);
    }
});
</code></pre>
<p><strong>è°ƒè¯•å»ºè®®</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ Elements é¢æ¿æŸ¥çœ‹äº‹ä»¶ç›‘å¬å™¨çš„æ•°é‡å’Œåˆ†å¸ƒ</li>
<li>è¯†åˆ«ä¸å¿…è¦çš„äº‹ä»¶ç›‘å¬å™¨ï¼Œè¿›è¡Œæ¸…ç†</li>
<li>ä½¿ç”¨äº‹ä»¶å§”æ‰˜å‡å°‘äº‹ä»¶ç›‘å¬å™¨æ•°é‡</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0971765d6e9c4398a20c96dbfcdd1d00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWr5ZOl56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766742219&amp;x-signature=fu13362YOAmEZflYpAou%2Bnu5mcQ%3D" alt="9d2b99ef-7784-46a8-a7ba-03223abaa18d.png" loading="lazy"/></p>
<h3 data-id="heading-29">5.2 äº¤äº’çŠ¶æ€ä¸åŠ¨ç”»è°ƒè¯•</h3>
<h4 data-id="heading-30">5.2.1 ä¼ªç±»çŠ¶æ€è°ƒè¯•</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.button</span> {
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span> <span class="hljs-number">20px</span>;
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#007bff</span>;
    <span class="hljs-attribute">color</span>: white;
    <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.3s</span> ease;
}

<span class="hljs-selector-class">.button</span><span class="hljs-selector-pseudo">:hover</span> {
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#0056b3</span>;
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">2px</span>);
}

<span class="hljs-selector-class">.button</span><span class="hljs-selector-pseudo">:active</span> {
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">0</span>);
}
</code></pre>
<p><strong>ä¼ªç±»è°ƒè¯•æŠ€å·§</strong>ï¼š</p>
<ul>
<li>åœ¨ Elements é¢æ¿ä¸­å³é”®ç‚¹å‡»å…ƒç´  â†’ é€‰æ‹© "Force State"ï¼Œå¯å¼ºåˆ¶æ¿€æ´»ä¼ªç±»çŠ¶æ€</li>
<li>æ”¯æŒ <code>:hover</code>ã€<code>:active</code>ã€<code>:focus</code>ã€<code>:visited</code> ç­‰ä¼ªç±»</li>
<li>å®æ—¶æŸ¥çœ‹ä¼ªç±»çŠ¶æ€ä¸‹çš„æ ·å¼å˜åŒ–</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8bd1d34201854d64844e8fa708390fbf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWr5ZOl56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766742219&amp;x-signature=S9i%2BM4D5mhl%2F%2FLyoFUGbE14DMuw%3D" alt="bc535b49-5bcc-48af-8531-f339c3b7fa99.gif" loading="lazy"/></p>
<p>è¿™ä¸ªè°ƒè¯•æŠ€å·§å¾ˆå®ç”¨ï¼Œä¸çŸ¥é“çš„è¯ï¼Œä½ è°ƒè¯•hoverï¼Œactiveæ ·å¼çš„æ—¶å€™å¾ˆæŠ“ç‹‚ï¼æ€ä¹ˆæ ·ï¼Œæ”¶ä¸‹å§ï¼</p>
<h4 data-id="heading-31">5.2.2 CSS åŠ¨ç”»ä¸è¿‡æ¸¡è°ƒè¯•</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-keyword">@keyframes</span> slideIn {
    <span class="hljs-selector-tag">from</span> {
        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">100%</span>);
        <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
    }
    <span class="hljs-selector-tag">to</span> {
        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">0</span>);
        <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
    }
}

<span class="hljs-selector-class">.animated-element</span> {
    <span class="hljs-attribute">animation</span>: slideIn <span class="hljs-number">0.5s</span> ease-out;
}
</code></pre>
<p><strong>åŠ¨ç”»è°ƒè¯•åŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>åœ¨ "Styles" é¢æ¿ä¸­æŸ¥çœ‹åŠ¨ç”»å±æ€§å’Œå…³é”®å¸§</li>
<li>ä½¿ç”¨ "Animations" é¢æ¿ï¼ˆCmd + Shift + P â†’ æœç´¢ "Animations"ï¼‰åˆ†æåŠ¨ç”»</li>
<li>æ”¯æŒæš‚åœã€é‡æ’­ã€è°ƒæ•´åŠ¨ç”»é€Ÿåº¦ç­‰æ“ä½œ</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ed2c154f533486fb4a8ad7479168482~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YWr5ZOl56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766742219&amp;x-signature=lkiCfB5v%2FMSBiI91LqfZ6HCe%2FIg%3D" alt="24c86173-d20e-4f32-9cf6-da0a7b234afe.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-32">å…­ã€Elements é¢æ¿æ€§èƒ½ä¼˜åŒ–</h2>
<h3 data-id="heading-33">6.1 é¢æ¿ä½¿ç”¨æ€§èƒ½æœ€ä½³å®è·µ</h3>
<ol>
<li><strong>å‡å°‘ä¸å¿…è¦çš„å®æ—¶ç¼–è¾‘</strong>ï¼šæ‰¹é‡ä¿®æ”¹æ ·å¼ï¼Œå‡å°‘é‡æ’é‡ç»˜æ¬¡æ•°</li>
<li><strong>å…³é—­ä¸éœ€è¦çš„é¢æ¿</strong>ï¼šåªæ‰“å¼€å½“å‰éœ€è¦çš„é¢æ¿ï¼Œå‡å°‘å†…å­˜å ç”¨</li>
<li><strong>åˆç†ä½¿ç”¨æ–­ç‚¹</strong>ï¼šé¿å…åœ¨é«˜é¢‘å˜åŒ–çš„ DOM èŠ‚ç‚¹ä¸Šè®¾ç½®æ–­ç‚¹</li>
<li><strong>å®šæœŸæ¸…ç†å…¨å±€å˜é‡</strong>ï¼šé¿å…åœ¨ Console ä¸­åˆ›å»ºè¿‡å¤šå…¨å±€å˜é‡</li>
</ol>
<h3 data-id="heading-34">6.2 Elements é¢æ¿ä¸å…¶ä»–é¢æ¿ååŒå·¥ä½œ</h3>
<pre><code class="hljs language-markdown" lang="markdown">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Elements é¢æ¿                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<span class="hljs-code">                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ€§èƒ½åˆ†æ     â”‚  Sources é¢æ¿ï¼šè°ƒè¯• DOM æ–­ç‚¹              â”‚
â”‚  æ€§èƒ½é¢æ¿ï¼šè¿½è¸ªé‡æ’é‡ç»˜æ—¶é—´                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å†…å­˜åˆ†æ     â”‚  Memory é¢æ¿ï¼šæ£€æµ‹ DOM å†…å­˜æ³„æ¼           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç½‘ç»œåˆ†æ     â”‚  Network é¢æ¿ï¼šåˆ†ææ ·å¼èµ„æºåŠ è½½            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre>
<p><strong>ååŒå·¥ä½œæµç¨‹</strong>ï¼š</p>
<ol>
<li>åœ¨ Elements é¢æ¿ä¸­å®šä½é—®é¢˜èŠ‚ç‚¹</li>
<li>ä½¿ç”¨ Performance é¢æ¿åˆ†ææ¸²æŸ“æ€§èƒ½</li>
<li>åœ¨ Sources é¢æ¿ä¸­è°ƒè¯•ç›¸å…³ä»£ç </li>
<li>ä½¿ç”¨ Memory é¢æ¿æ£€æµ‹å†…å­˜æ³„æ¼</li>
</ol>
<hr/>
<h2 data-id="heading-35">ä¸ƒã€é«˜çº§æ¡ˆä¾‹åˆ†æä¸å®æˆ˜</h2>
<h3 data-id="heading-36">7.1 å¤æ‚å¸ƒå±€é—®é¢˜è°ƒè¯•</h3>
<p><strong>é—®é¢˜</strong>ï¼šå“åº”å¼å¸ƒå±€åœ¨æŸäº›è®¾å¤‡ä¸Šå‡ºç°å…ƒç´ é‡å </p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>
<p><strong>å®šä½é—®é¢˜</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ Elements é¢æ¿çš„è®¾å¤‡å·¥å…·æ åˆ‡æ¢åˆ°é—®é¢˜è®¾å¤‡è§†å›¾</li>
<li>é€‰ä¸­é‡å çš„å…ƒç´ ï¼ŒæŸ¥çœ‹å…¶ç›’æ¨¡å‹å’Œå®šä½å±æ€§</li>
<li>åˆ†æå…ƒç´ çš„ <code>z-index</code> å’Œå±‚å ä¸Šä¸‹æ–‡</li>
</ul>
</li>
<li>
<p><strong>è°ƒè¯•è¿‡ç¨‹</strong>ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* é—®é¢˜ä»£ç  */</span>
<span class="hljs-selector-class">.sidebar</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">300px</span>;
    <span class="hljs-attribute">position</span>: absolute;
    <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;
}

<span class="hljs-selector-class">.main-content</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">padding-right</span>: <span class="hljs-number">300px</span>;
}

<span class="hljs-comment">/* ä¿®å¤ä»£ç  */</span>
<span class="hljs-selector-class">.container</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">flex-wrap</span>: wrap;
}

<span class="hljs-selector-class">.sidebar</span> {
    <span class="hljs-attribute">flex</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">300px</span>;
    <span class="hljs-attribute">max-width</span>: <span class="hljs-number">100%</span>;
}

<span class="hljs-selector-class">.main-content</span> {
    <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
    <span class="hljs-attribute">min-width</span>: <span class="hljs-number">0</span>;
}
</code></pre>
</li>
<li>
<p><strong>éªŒè¯ä¿®å¤</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ Elements é¢æ¿å®æ—¶ä¿®æ”¹æ ·å¼ï¼ŒéªŒè¯ä¿®å¤æ•ˆæœ</li>
<li>åˆ‡æ¢ä¸åŒè®¾å¤‡è§†å›¾ï¼Œç¡®ä¿å¸ƒå±€åœ¨æ‰€æœ‰è®¾å¤‡ä¸Šæ­£å¸¸</li>
<li>ä½¿ç”¨ "Layout Shift Regions" æ£€æŸ¥æ˜¯å¦å­˜åœ¨å¸ƒå±€åç§»</li>
</ul>
</li>
</ol>
<h3 data-id="heading-37">7.2 æ ·å¼å†²çªé—®é¢˜è§£å†³</h3>
<p><strong>é—®é¢˜</strong>ï¼šç¬¬ä¸‰æ–¹åº“æ ·å¼ä¸è‡ªå®šä¹‰æ ·å¼å†²çª</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>
<p><strong>å®šä½å†²çª</strong>ï¼š</p>
<ul>
<li>åœ¨ Elements é¢æ¿ä¸­æŸ¥çœ‹å…ƒç´ çš„æ ·å¼è§„åˆ™ï¼Œè¯†åˆ«å†²çªçš„æ ·å¼</li>
<li>æŸ¥çœ‹æ ·å¼æ¥æºï¼Œç¡®å®šæ˜¯ç¬¬ä¸‰æ–¹åº“è¿˜æ˜¯è‡ªå®šä¹‰æ ·å¼</li>
<li>åˆ†ææ ·å¼ä¼˜å…ˆçº§ï¼Œç¡®å®šå†²çªåŸå› </li>
</ul>
</li>
<li>
<p><strong>è§£å†³å†²çª</strong>ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* ä½¿ç”¨ CSS å˜é‡éš”ç¦»æ ·å¼ */</span>
<span class="hljs-selector-pseudo">:root</span> {
    <span class="hljs-attr">--primary-color</span>: <span class="hljs-number">#007bff</span>;
    <span class="hljs-attr">--secondary-color</span>: <span class="hljs-number">#6c757d</span>;
}

<span class="hljs-comment">/* ä½¿ç”¨æ›´å…·ä½“çš„é€‰æ‹©å™¨ */</span>
<span class="hljs-selector-class">.app-container</span> <span class="hljs-selector-class">.button</span> {
    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">var</span>(--primary-color);
    <span class="hljs-comment">/* è¦†ç›–ç¬¬ä¸‰æ–¹åº“æ ·å¼ */</span>
}

<span class="hljs-comment">/* ä½¿ç”¨ !importantï¼ˆè°¨æ…ä½¿ç”¨ï¼‰ */</span>
<span class="hljs-selector-class">.critical-button</span> {
    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#dc3545</span> <span class="hljs-meta">!important</span>;
}
</code></pre>
</li>
<li>
<p><strong>é¢„é˜²å†²çª</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ CSS å˜é‡å’Œå‘½åç©ºé—´éš”ç¦»æ ·å¼</li>
<li>é‡‡ç”¨ BEM ç­‰å‘½åè§„èŒƒ</li>
<li>ä½¿ç”¨ CSS Modules æˆ– CSS-in-JS æ–¹æ¡ˆ</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-38">å…«ã€æ€»ç»“ä¸è¿›é˜¶å»ºè®®</h2>
<p>Chrome DevTools Elements é¢æ¿æ˜¯å‰ç«¯å¼€å‘è€…çš„ç‘å£«å†›åˆ€ï¼Œä»åŸºç¡€çš„ DOM æŸ¥çœ‹å’Œæ ·å¼ä¿®æ”¹åˆ°é«˜çº§çš„å¸ƒå±€åˆ†æå’Œæ€§èƒ½è°ƒè¯•ï¼Œå®ƒæä¾›äº†å…¨æ–¹ä½çš„åŠŸèƒ½æ”¯æŒã€‚ä½œä¸ºå‰ç«¯å¼€å‘è€…ï¼Œæˆ‘ä»¬åº”è¯¥ï¼š</p>
<ol>
<li><strong>æ·±å…¥ç†è§£åº•å±‚æœºåˆ¶</strong>ï¼šäº†è§£ DOM æ ‘ã€æ ·å¼è®¡ç®—ã€å¸ƒå±€æ¸²æŸ“çš„å·¥ä½œåŸç†</li>
<li><strong>æŒæ¡é«˜çº§è°ƒè¯•æŠ€å·§</strong>ï¼šç†Ÿç»ƒä½¿ç”¨ DOM æ–­ç‚¹ã€äº‹ä»¶ç›‘å¬å™¨ã€å¸ƒå±€åˆ†æç­‰é«˜çº§åŠŸèƒ½</li>
<li><strong>æ³¨é‡æ€§èƒ½ä¼˜åŒ–</strong>ï¼šåœ¨è°ƒè¯•è¿‡ç¨‹ä¸­å…³æ³¨æ€§èƒ½å½±å“ï¼Œä¼˜åŒ–è°ƒè¯•æ•ˆç‡</li>
<li><strong>ç»“åˆå…¶ä»–é¢æ¿</strong>ï¼šä¸ Performanceã€Memoryã€Sources ç­‰é¢æ¿ååŒå·¥ä½œ</li>
<li><strong>æŒç»­å­¦ä¹ å’Œæ¢ç´¢</strong>ï¼šChrome DevTools ä¸æ–­æ›´æ–°ï¼Œä¿æŒå¯¹æ–°åŠŸèƒ½çš„å…³æ³¨</li>
</ol>
<h3 data-id="heading-39">è¿›é˜¶å­¦ä¹ èµ„æº</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fdevtools%2F" target="_blank" title="https://developer.chrome.com/docs/devtools/" ref="nofollow noopener noreferrer">Chrome DevTools å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FTools%2FChrome_DevTools" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Tools/Chrome_DevTools" ref="nofollow noopener noreferrer">MDN Web Docs - Chrome DevTools</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fweb.dev%2Flearn%2Fcss%2F" target="_blank" title="https://web.dev/learn/css/" ref="nofollow noopener noreferrer">CSS å¸ƒå±€ä¸æ€§èƒ½ä¼˜åŒ–</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fweb.dev%2Fdom-manipulation%2F" target="_blank" title="https://web.dev/dom-manipulation/" ref="nofollow noopener noreferrer">DOM æ“ä½œä¸æ€§èƒ½</a></li>
</ul>
<hr/>
<p><strong>æ„Ÿè°¢é˜…è¯»ï¼å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€è®¨è®ºã€‚</strong>
<strong>å¦‚æœä½ è§‰å¾—æœ¬æ–‡å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµã€æ”¶è—ã€åˆ†äº«ï¼Œä¹Ÿæ¬¢è¿å…³æ³¨æˆ‘ï¼Œè·å–æ›´å¤šå‰ç«¯æŠ€æœ¯å¹²è´§ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android éŸ³ä¹æ’­æ”¾å™¨ä¹‹MotionLayoutå®ç°Viewæµç•…å˜æ¢]]></title>    <link>https://juejin.cn/post/7585395972293885961</link>    <guid>https://juejin.cn/post/7585395972293885961</guid>    <pubDate>2025-12-19T09:59:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585395972293885961" data-draft-id="7585227038991450150" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android éŸ³ä¹æ’­æ”¾å™¨ä¹‹MotionLayoutå®ç°Viewæµç•…å˜æ¢"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-12-19T09:59:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ²¡æœ‰äº†é‡è§"/> <meta itemprop="url" content="https://juejin.cn/user/1521379826212983"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android éŸ³ä¹æ’­æ”¾å™¨ä¹‹MotionLayoutå®ç°Viewæµç•…å˜æ¢
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1521379826212983/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ²¡æœ‰äº†é‡è§
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T09:59:05.000Z" title="Fri Dec 19 2025 09:59:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/75d4eca5aaee4b3094e8205e6bc4636c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rKh5pyJ5LqG6YGH6KeB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743144&amp;x-signature=PMjMs3cry0GPktRq3CXJa0Z7OuE%3D" alt="Screen_recording_20251219_174418 00_00_00-00_00_30.gif" loading="lazy"/></p>
<p>æœ€è¿‘åœ¨ç©è€ä¸€ä¸ªéŸ³ä¹æ’­æ”¾å™¨é¡¹ç›®,é¡ºå¸¦ç€å°†MDè¿™å‡ å¹´çš„æ›´æ–°åº“è€ä¸€æŠŠ,åç»­ä¼šé™†ç»­æ”¾å‡ºä»£ç .</p>
<p>ç¬¬ä¸€æŠŠåˆšä¸Šäº†<code>MotionLayout</code>è™½ç„¶å†™çš„æ—¶å€™æŒºè´¹åŠ²,å†™å®Œçœ‹ç€æ•ˆæœè¿˜è¡Œ.</p>
<p><code>æ•ˆæœ:</code></p>
<p>æ‚¬æµ®æ¡†--&gt;çŸ©å½¢å·¥å…·æ --&gt;å…¨å±å±•ç¤º</p>
<p><code>æ³¨æ„:</code></p>
<ul>
<li>MotionLayoutä¸­åµŒå¥—ä¸¤å±‚ä¼šå‡ºç° aphaå’Œæ˜¾ç¤ºéšè—ä¸ç”Ÿæ•ˆé—®é¢˜</li>
<li>è§’åº¦æ§åˆ¶éœ€è¦ä»£ç æ§åˆ¶</li>
</ul>
<h4 data-id="heading-0">1: view_music_play.xml</h4>
<pre><code class="hljs language-ini" lang="ini">&lt;?xml <span class="hljs-attr">version</span>=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;

&lt;androidx.constraintlayout.motion.widget.MotionLayout xmlns:<span class="hljs-attr">android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    xmlns:<span class="hljs-attr">app</span>=<span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span>
    android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/motionLayout"</span>
    android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"match_parent"</span>
    android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"match_parent"</span>
    android:<span class="hljs-attr">layout_gravity</span>=<span class="hljs-string">"bottom"</span>
    android:<span class="hljs-attr">background</span>=<span class="hljs-string">"@color/transparent"</span>
    app:<span class="hljs-attr">layoutDescription</span>=<span class="hljs-string">"@xml/player_scene"</span>&gt;
    &lt;!-- èƒŒæ™¯å±‚ --&gt;
    &lt;com.google.android.material.imageview.ShapeableImageView
        android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
        android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"80dp"</span>
        android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"80dp"</span>
        android:<span class="hljs-attr">background</span>=<span class="hljs-string">"@color/color_white"</span>
        app:<span class="hljs-attr">shapeAppearanceOverlay</span>=<span class="hljs-string">"@style/circleImageStyle"</span> /&gt;
    &lt;!-- æ‚¬æµ®åœ†ç›˜ --&gt;
    &lt;com.google.android.material.imageview.ShapeableImageView
        android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/iv_cover"</span>
        android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"80dp"</span>
        android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"80dp"</span>
        android:<span class="hljs-attr">background</span>=<span class="hljs-string">"@mipmap/ic_launcher_c"</span>
        android:<span class="hljs-attr">clickable</span>=<span class="hljs-string">"false"</span>
        android:<span class="hljs-attr">scaleType</span>=<span class="hljs-string">"centerCrop"</span>
        app:<span class="hljs-attr">shapeAppearanceOverlay</span>=<span class="hljs-string">"@style/circleImageStyle"</span> /&gt;

    &lt;TextView
        android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/tv_music"</span>
        android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
        android:<span class="hljs-attr">gravity</span>=<span class="hljs-string">"start|center_vertical"</span>
        android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"wrap_content"</span>

        android:<span class="hljs-attr">ellipsize</span>=<span class="hljs-string">"middle"</span>
        android:<span class="hljs-attr">lines</span>=<span class="hljs-string">"1"</span>
        android:<span class="hljs-attr">text</span>=<span class="hljs-string">"11111"</span>
        android:<span class="hljs-attr">textColor</span>=<span class="hljs-string">"@color/color_black"</span>
        android:<span class="hljs-attr">textSize</span>=<span class="hljs-string">"18sp"</span>
        android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"invisible"</span> /&gt;


    &lt;ImageButton
        android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/iv_pre"</span>
        android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"wrap_content"</span>
        android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"wrap_content"</span>
        android:<span class="hljs-attr">layout_margin</span>=<span class="hljs-string">"10dp"</span>
        android:<span class="hljs-attr">src</span>=<span class="hljs-string">"@drawable/media3_icon_previous"</span>
        android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"invisible"</span> /&gt;

    &lt;ImageButton
        android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/iv_rewind"</span>
        android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"wrap_content"</span>
        android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"wrap_content"</span>
        android:<span class="hljs-attr">layout_margin</span>=<span class="hljs-string">"10dp"</span>
        android:<span class="hljs-attr">src</span>=<span class="hljs-string">"@drawable/media3_icon_rewind"</span>
        /&gt;


    &lt;ImageButton
        android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/iv_play"</span>
        android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"wrap_content"</span>
        android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"wrap_content"</span>
        android:<span class="hljs-attr">layout_margin</span>=<span class="hljs-string">"10dp"</span>
        android:<span class="hljs-attr">src</span>=<span class="hljs-string">"@drawable/media3_icon_play"</span>
        /&gt;

    &lt;ImageButton
        android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/iv_forward"</span>
        android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"wrap_content"</span>
        android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"wrap_content"</span>
        android:<span class="hljs-attr">layout_margin</span>=<span class="hljs-string">"10dp"</span>
        android:<span class="hljs-attr">src</span>=<span class="hljs-string">"@drawable/media3_icon_fast_forward"</span>
        /&gt;

    &lt;ImageButton
        android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/iv_next"</span>
        android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"wrap_content"</span>
        android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"wrap_content"</span>
        android:<span class="hljs-attr">layout_margin</span>=<span class="hljs-string">"10dp"</span>
        android:<span class="hljs-attr">src</span>=<span class="hljs-string">"@drawable/media3_icon_next"</span>
        /&gt;

    &lt;ImageButton
        android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/iv_mode"</span>
        android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"wrap_content"</span>
        android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"wrap_content"</span>
        android:<span class="hljs-attr">layout_margin</span>=<span class="hljs-string">"10dp"</span>
        android:<span class="hljs-attr">src</span>=<span class="hljs-string">"@drawable/media3_icon_repeat_all"</span>
        /&gt;

    &lt;ImageButton
        android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/iv_quality"</span>
        android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"wrap_content"</span>
        android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"wrap_content"</span>
        android:<span class="hljs-attr">layout_margin</span>=<span class="hljs-string">"10dp"</span>
        android:<span class="hljs-attr">src</span>=<span class="hljs-string">"@drawable/media3_icon_quality"</span>
        /&gt;

    &lt;ImageButton
        android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/iv_more"</span>
        android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"wrap_content"</span>
        android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"wrap_content"</span>
        android:<span class="hljs-attr">layout_margin</span>=<span class="hljs-string">"10dp"</span>
        android:<span class="hljs-attr">src</span>=<span class="hljs-string">"@drawable/media3_icon_settings"</span>
        /&gt;


&lt;/androidx.constraintlayout.motion.widget.MotionLayout&gt;
</code></pre>
<h4 data-id="heading-1">2. player_scene.xml</h4>
<pre><code class="hljs language-ini" lang="ini">&lt;?xml <span class="hljs-attr">version</span>=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;
&lt;MotionScene xmlns:<span class="hljs-attr">android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    xmlns:<span class="hljs-attr">app</span>=<span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span>
    xmlns:<span class="hljs-attr">motion</span>=<span class="hljs-string">"http://schemas.android.com/tools"</span>&gt;

    &lt;!-- æ”¶èµ·çŠ¶æ€ --&gt;
    &lt;ConstraintSet android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/cycle"</span>&gt;

        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/cl_music_bg"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"80dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"80dp"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"1"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"parent"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toEndOf</span>=<span class="hljs-string">"parent"</span> /&gt;

        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_cover"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"80dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"80dp"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"1"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toEndOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintStart_toStartOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;


        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/tv_music"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"wrap_content"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"wrap_content"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"0"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@id/iv_pre"</span>
            app:<span class="hljs-attr">layout_constraintStart_toEndOf</span>=<span class="hljs-string">"@id/iv_cover"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;

        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_pre"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"0"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_rewind"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            /&gt;

        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_rewind"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"0"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_play"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;



        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_play"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"0"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_forward"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;


        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_forward"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"0"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_next"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;


        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_next"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"0"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_mode"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;

        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_mode"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"0"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_quality"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;
        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_quality"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"0"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_more"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;


        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_more"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"0"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toEndOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;



    &lt;/ConstraintSet&gt;

    &lt;!-- å±•å¼€çŠ¶æ€ --&gt;
    &lt;ConstraintSet android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/rounded"</span>&gt;
        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/cl_music_bg"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"80dp"</span>
            android:<span class="hljs-attr">layout_marginStart</span>=<span class="hljs-string">"10dp"</span>
            android:<span class="hljs-attr">layout_marginEnd</span>=<span class="hljs-string">"10dp"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"parent"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toEndOf</span>=<span class="hljs-string">"parent"</span>
            app:<span class="hljs-attr">layout_constraintStart_toStartOf</span>=<span class="hljs-string">"parent"</span> /&gt;

        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_cover"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"80dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"80dp"</span>
            android:<span class="hljs-attr">layout_marginStart</span>=<span class="hljs-string">"10dp"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"1"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintStart_toStartOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;

        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/tv_music"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"wrap_content"</span>
            android:<span class="hljs-attr">layout_marginStart</span>=<span class="hljs-string">"10dp"</span>
            android:<span class="hljs-attr">layout_marginEnd</span>=<span class="hljs-string">"10dp"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"1"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@id/iv_pre"</span>
            app:<span class="hljs-attr">layout_constraintStart_toEndOf</span>=<span class="hljs-string">"@id/iv_cover"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;
        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_pre"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"0"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_rewind"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            /&gt;

        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_rewind"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"0"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_play"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;



        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_play"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_marginEnd</span>=<span class="hljs-string">"10dp"</span>

            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"1"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_forward"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;


        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_forward"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"0"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_next"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;


        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_next"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"0"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_mode"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;

        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_mode"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_marginEnd</span>=<span class="hljs-string">"10dp"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"1"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_quality"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;
        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_quality"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"0"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_more"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;


        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_more"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_marginEnd</span>=<span class="hljs-string">"10dp"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"1"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toEndOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;



    &lt;/ConstraintSet&gt;

&lt;!--å…¨å±çŠ¶æ€--&gt;
    &lt;ConstraintSet android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/full"</span>&gt;
        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/cl_music_bg"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"match_parent"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"match_parent"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"parent"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toEndOf</span>=<span class="hljs-string">"parent"</span>
            app:<span class="hljs-attr">layout_constraintStart_toStartOf</span>=<span class="hljs-string">"parent"</span> /&gt;
        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_cover"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"180dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"180dp"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"1"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toEndOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintStart_toStartOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;


        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/tv_music"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"wrap_content"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"wrap_content"</span>
            android:<span class="hljs-attr">layout_marginStart</span>=<span class="hljs-string">"10dp"</span>
            android:<span class="hljs-attr">layout_marginEnd</span>=<span class="hljs-string">"10dp"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"1"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            android:<span class="hljs-attr">layout_marginTop</span>=<span class="hljs-string">"40dp"</span>
            app:<span class="hljs-attr">layout_constraintStart_toStartOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toEndOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span> /&gt;

        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_pre"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_marginStart</span>=<span class="hljs-string">"5dp"</span>
            android:<span class="hljs-attr">layout_marginEnd</span>=<span class="hljs-string">"5dp"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"1"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintStart_toStartOf</span>=<span class="hljs-string">"parent"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_rewind"</span>
            app:<span class="hljs-attr">layout_constraintTop_toBottomOf</span>=<span class="hljs-string">"@+id/iv_cover"</span>
            /&gt;

        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_rewind"</span>
            android:<span class="hljs-attr">layout_marginStart</span>=<span class="hljs-string">"5dp"</span>
            android:<span class="hljs-attr">layout_marginEnd</span>=<span class="hljs-string">"5dp"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"1"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/iv_pre"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_play"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/iv_pre"</span> /&gt;



        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_play"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_marginStart</span>=<span class="hljs-string">"5dp"</span>
            android:<span class="hljs-attr">layout_marginEnd</span>=<span class="hljs-string">"5dp"</span>

            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"1"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/iv_pre"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_forward"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/iv_pre"</span> /&gt;


        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_forward"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_marginStart</span>=<span class="hljs-string">"5dp"</span>
            android:<span class="hljs-attr">layout_marginEnd</span>=<span class="hljs-string">"5dp"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"1"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/iv_pre"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_next"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/iv_pre"</span> /&gt;


        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_next"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_marginStart</span>=<span class="hljs-string">"5dp"</span>
            android:<span class="hljs-attr">layout_marginEnd</span>=<span class="hljs-string">"5dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"1"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/iv_pre"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_mode"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/iv_pre"</span> /&gt;

        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_mode"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_marginStart</span>=<span class="hljs-string">"5dp"</span>
            android:<span class="hljs-attr">layout_marginEnd</span>=<span class="hljs-string">"5dp"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"1"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/iv_pre"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_quality"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/iv_pre"</span> /&gt;
        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_quality"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"50dp"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"1"</span>
            android:<span class="hljs-attr">layout_marginStart</span>=<span class="hljs-string">"5dp"</span>
            android:<span class="hljs-attr">layout_marginEnd</span>=<span class="hljs-string">"5dp"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/iv_pre"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toStartOf</span>=<span class="hljs-string">"@+id/iv_more"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/iv_pre"</span> /&gt;


        &lt;Constraint
            android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@id/iv_more"</span>
            android:<span class="hljs-attr">layout_width</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">layout_height</span>=<span class="hljs-string">"0dp"</span>
            android:<span class="hljs-attr">alpha</span>=<span class="hljs-string">"0"</span>
            android:<span class="hljs-attr">visibility</span>=<span class="hljs-string">"visible"</span>
            android:<span class="hljs-attr">layout_marginEnd</span>=<span class="hljs-string">"0dp"</span>

            app:<span class="hljs-attr">layout_constraintBottom_toBottomOf</span>=<span class="hljs-string">"@+id/iv_pre"</span>
            app:<span class="hljs-attr">layout_constraintEnd_toEndOf</span>=<span class="hljs-string">"@+id/cl_music_bg"</span>
            app:<span class="hljs-attr">layout_constraintTop_toTopOf</span>=<span class="hljs-string">"@+id/iv_pre"</span> /&gt;

    &lt;/ConstraintSet&gt;

    &lt;!-- è¿‡æ¸¡åŠ¨ç”» --&gt;
    &lt;Transition
        android:<span class="hljs-attr">id</span>=<span class="hljs-string">"@+id/expandTransition"</span>
        app:<span class="hljs-attr">constraintSetEnd</span>=<span class="hljs-string">"@id/rounded"</span>
        app:<span class="hljs-attr">constraintSetStart</span>=<span class="hljs-string">"@id/cycle"</span>
        app:<span class="hljs-attr">duration</span>=<span class="hljs-string">"400"</span>&gt;

        &lt;KeyFrameSet&gt;

        &lt;/KeyFrameSet&gt;
    &lt;/Transition&gt;

&lt;/MotionScene&gt;
</code></pre>
<h4 data-id="heading-2">3.è‡ªå®šä¹‰ViewGroup</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">package</span> com.wkq.main.ui.view

<span class="hljs-keyword">import</span> android.animation.ObjectAnimator
<span class="hljs-keyword">import</span> android.animation.ValueAnimator
<span class="hljs-keyword">import</span> android.content.Context
<span class="hljs-keyword">import</span> android.util.AttributeSet
<span class="hljs-keyword">import</span> android.view.LayoutInflater
<span class="hljs-keyword">import</span> android.view.View
<span class="hljs-keyword">import</span> android.view.animation.LinearInterpolator
<span class="hljs-keyword">import</span> android.widget.FrameLayout
<span class="hljs-keyword">import</span> androidx.constraintlayout.motion.widget.MotionLayout
<span class="hljs-keyword">import</span> com.wkq.main.R
<span class="hljs-keyword">import</span> com.wkq.main.databinding.ViewMusicPlayBinding
<span class="hljs-keyword">import</span> com.wkq.main.util.RotationHelper


<span class="hljs-comment">/**
 *
 *<span class="hljs-doctag">@Author</span>: wkq
 *
 *<span class="hljs-doctag">@Time</span>: 2025/12/19 14:34
 *
 *<span class="hljs-doctag">@Desc</span>: æ’­æ”¾å™¨ æ’­æ”¾æ§åˆ¶å™¨
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MusicPlayView</span> <span class="hljs-meta">@JvmOverloads</span> <span class="hljs-keyword">constructor</span>(
    context: Context, attrs: AttributeSet? = <span class="hljs-literal">null</span>, defStyleAttr: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>
) : FrameLayout(context, attrs, defStyleAttr) {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> binding: ViewMusicPlayBinding
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> motionLayout: MotionLayout


    <span class="hljs-keyword">init</span> {
        binding = ViewMusicPlayBinding.inflate(LayoutInflater.from(context), <span class="hljs-keyword">this</span>, <span class="hljs-literal">true</span>)
        motionLayout = binding.motionLayout
        initView()
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">startDiscRotation</span><span class="hljs-params">()</span></span> {
        ObjectAnimator.ofFloat(binding.ivCover, <span class="hljs-string">"rotation"</span>, <span class="hljs-number">0f</span>, <span class="hljs-number">360f</span>).apply {
            duration = <span class="hljs-number">5000</span>
            repeatCount = ValueAnimator.INFINITE
            interpolator = LinearInterpolator()
            start()
        }
    }

    <span class="hljs-keyword">var</span> isExpanded = <span class="hljs-literal">false</span>
    <span class="hljs-keyword">var</span> isFullScreen = <span class="hljs-literal">false</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> rotationHelper: RotationHelper

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">initView</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// åˆå§‹åŒ–å·¥å…·ç±»</span>
        rotationHelper = RotationHelper(binding.ivCover)
        rotationHelper.start()
        binding.ivCover.setOnClickListener {
            <span class="hljs-keyword">if</span> (isExpanded) {
                <span class="hljs-comment">// å±•å¼€ -&gt; æ”¶èµ·</span>
                binding.motionLayout.transitionToState(R.id.cycle)
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// æ”¶èµ· -&gt; å±•å¼€</span>
                binding.motionLayout.transitionToState(R.id.rounded)
            }

        }


        binding.ivMore.setOnClickListener {
            <span class="hljs-keyword">if</span> (!isFullScreen) {
                <span class="hljs-comment">// rounded -&gt; full</span>
                binding.motionLayout.transitionToState(R.id.full)
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// full -&gt; rounded</span>
                binding.motionLayout.transitionToState(R.id.rounded)
            }
        }
        binding.motionLayout.setTransitionListener(<span class="hljs-keyword">object</span> : MotionLayout.TransitionListener {
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onTransitionStarted</span><span class="hljs-params">(
                motionLayout: <span class="hljs-type">MotionLayout</span>, startId: <span class="hljs-type">Int</span>, endId: <span class="hljs-type">Int</span>
            )</span></span> {
            }

            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onTransitionChange</span><span class="hljs-params">(
                motionLayout: <span class="hljs-type">MotionLayout</span>, startId: <span class="hljs-type">Int</span>, endId: <span class="hljs-type">Int</span>, progress: <span class="hljs-type">Float</span>
            )</span></span> {
                <span class="hljs-keyword">val</span> width = binding.clMusicBg.width.toFloat()
                <span class="hljs-keyword">val</span> height = binding.clMusicBg.height.toFloat()
                <span class="hljs-keyword">val</span> minSide = minOf(width, height)

                <span class="hljs-comment">// å®šä¹‰æ¯ä¸ªçŠ¶æ€å¯¹åº”çš„ cornerRadius</span>
                <span class="hljs-keyword">val</span> startRadius = <span class="hljs-keyword">when</span> (startId) {
                    R.id.cycle -&gt; minSide / <span class="hljs-number">2f</span>        <span class="hljs-comment">// å®Œå…¨åœ†å½¢</span>
                    R.id.rounded -&gt; <span class="hljs-number">16f</span>               <span class="hljs-comment">// åœ†è§’çŸ©å½¢</span>
                    R.id.full -&gt; <span class="hljs-number">0f</span>                    <span class="hljs-comment">// æ–¹å½¢</span>
                    <span class="hljs-keyword">else</span> -&gt; <span class="hljs-number">0f</span>
                }

                <span class="hljs-keyword">val</span> endRadius = <span class="hljs-keyword">when</span> (endId) {
                    R.id.cycle -&gt; minSide / <span class="hljs-number">2f</span>
                    R.id.rounded -&gt; <span class="hljs-number">16f</span>
                    R.id.full -&gt; <span class="hljs-number">0f</span>
                    <span class="hljs-keyword">else</span> -&gt; <span class="hljs-number">0f</span>
                }

                <span class="hljs-keyword">val</span> radius = startRadius + (endRadius - startRadius) * progress

                binding.clMusicBg.shapeAppearanceModel =
                    binding.clMusicBg.shapeAppearanceModel.toBuilder().setAllCornerSizes(radius)
                        .build()
            }

            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onTransitionCompleted</span><span class="hljs-params">(motionLayout: <span class="hljs-type">MotionLayout</span>, currentId: <span class="hljs-type">Int</span>)</span></span> {
                isExpanded = currentId == R.id.rounded
                isFullScreen = currentId == R.id.full

            }

            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onTransitionTrigger</span><span class="hljs-params">(
                motionLayout: <span class="hljs-type">MotionLayout</span>, triggerId: <span class="hljs-type">Int</span>, positive: <span class="hljs-type">Boolean</span>, progress: <span class="hljs-type">Float</span>
            )</span></span> {
            }
        })

    }
}
</code></pre>
<h2 data-id="heading-3">æ€»ç»“</h2>
<p>ç®€å•å®ç°äº†è¿™ä¸ªç»“æœ,æ ¸å¿ƒæ˜¯MotionLayout æ­é…è¿‡åº¦åŠ¨ç”»å®ç° Viewåˆ‡æ¢çš„æµç•…æ•ˆæœ æ¯”è‡ªå·±å†™åŠ¨ç”»ç®€å•å¾ˆå¤š.</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Elasticsearchï¼šæ„å»ºä¸€ä¸ª AI é©±åŠ¨çš„ç”µå­é‚®ä»¶é’“é±¼æ£€æµ‹]]></title>    <link>https://juejin.cn/post/7585214391828676651</link>    <guid>https://juejin.cn/post/7585214391828676651</guid>    <pubDate>2025-12-19T09:57:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585214391828676651" data-draft-id="7585138968167874596" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Elasticsearchï¼šæ„å»ºä¸€ä¸ª AI é©±åŠ¨çš„ç”µå­é‚®ä»¶é’“é±¼æ£€æµ‹"/> <meta itemprop="keywords" content="Elasticsearch"/> <meta itemprop="datePublished" content="2025-12-19T09:57:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Elasticsearch"/> <meta itemprop="url" content="https://juejin.cn/user/2612095360441448"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Elasticsearchï¼šæ„å»ºä¸€ä¸ª AI é©±åŠ¨çš„ç”µå­é‚®ä»¶é’“é±¼æ£€æµ‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2612095360441448/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Elasticsearch
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T09:57:01.000Z" title="Fri Dec 19 2025 09:57:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šæ¥è‡ª ElasticÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdiscuss.elastic.co%2Fu%2Fjulien_martin" title="https://discuss.elastic.co/u/julien_martin" target="_blank" ref="nofollow noopener noreferrer">Julien_Martin</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1324766dedb94c7db41707691d573eba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743021&amp;x-signature=gcJGz0u7cnDI%2BS8aH%2BTEKLByn8g%3D" alt="" loading="lazy"/></p>
<p>ä½¿ç”¨ n8n å’Œ Elastic Agent Builder æ„å»ºä¸€ä¸ª AI é©±åŠ¨çš„ç”µå­é‚®ä»¶é’“é±¼æ£€æµ‹ç³»ç»Ÿ</p>
<p>é’“é±¼æ”»å‡»ä»ç„¶ä¸»å¯¼ç€ç½‘ç»œå®‰å…¨å¨èƒå½¢åŠ¿ï¼Œæ”»å‡»è€…è¶Šæ¥è¶Šå¤šåœ°ä½¿ç”¨å¤æ‚çš„ç¤¾ä¼šå·¥ç¨‹æŠ€æœ¯æ¥ç»•è¿‡ä¼ ç»Ÿè¿‡æ»¤å™¨ã€‚ä½œä¸ºä¸€åä½¿ç”¨ Elastic æŠ€æœ¯çš„å®‰å…¨ä»ä¸šè€…ï¼Œæˆ‘æ„å»ºäº†ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„é’“é±¼æ£€æµ‹ä¸åˆ†æç³»ç»Ÿï¼Œå°† n8n å·¥ä½œæµè‡ªåŠ¨åŒ–ä¸ Elastic çš„ AI é©±åŠ¨çš„ Agent Builder ç›¸ç»“åˆã€‚æœ¬æ–‡å°†ä»‹ç»è¯¥ç³»ç»Ÿçš„æ¶æ„ã€å®ç°æ–¹å¼ï¼Œä»¥åŠå¯¹ä¸‰ä¸ªæœˆå†… 44 å°é’“é±¼é‚®ä»¶è¿›è¡Œåˆ†ææ‰€è·å¾—çš„çœŸå®æ´å¯Ÿã€‚</p>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆè¿™ç§æ–¹æ³•æœ‰æ•ˆ</h2>
<p>ä¼ ç»Ÿçš„åŸºäºè§„åˆ™çš„ç”µå­é‚®ä»¶è¿‡æ»¤å™¨éš¾ä»¥åº”å¯¹ç°ä»£é’“é±¼æ´»åŠ¨ï¼Œè¿™äº›æ´»åŠ¨å¾€å¾€ä½¿ç”¨å…·æœ‰ä¸Šä¸‹æ–‡è¯­ä¹‰çš„è¯­è¨€å’Œçœ‹ä¼¼åˆæ³•çš„æ ¼å¼ã€‚é€šè¿‡åˆ©ç”¨ Elastic æ¨ç†ç®¡é“ä¸­çš„å¤§è¯­è¨€æ¨¡å‹ï¼ˆ LLMs ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æç”µå­é‚®ä»¶è¯­ä¹‰ã€æå–æ¶æ„æ¨¡å¼ï¼Œå¹¶å¯¹å¨èƒè¿›è¡Œåˆ†ç±»ï¼Œå‡†ç¡®ç‡è¶…è¿‡ 95%ã€‚ä¸ n8n çš„é›†æˆå®ç°äº†æ— ç¼è‡ªåŠ¨åŒ–ï¼Œè€Œ Elastic Agent Builder åˆ™ä½¿å®‰å…¨åˆ†æäººå‘˜èƒ½å¤Ÿä½¿ç”¨è‡ªç„¶è¯­è¨€æŸ¥è¯¢åˆ†æç»“æœã€‚</p>
<blockquote>
<p><strong>Elastic å…¥é—¨</strong>ï¼šå¦‚æœä½ æ˜¯ Elastic æ–°ç”¨æˆ·ï¼Œå¯ä»¥æŸ¥çœ‹ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fgetting-started" title="https://www.elastic.co/getting-started" target="_blank" ref="nofollow noopener noreferrer">Getting Started æŒ‡å—</a>æ¥è®¾ç½®ä½ çš„éƒ¨ç½²ï¼Œå¹¶å¼€å§‹æ¢ç´¢ Elastic çš„æœç´¢ã€å¯è§‚æµ‹æ€§å’Œå®‰å…¨è§£å†³æ–¹æ¡ˆã€‚</p>
</blockquote>
<h2 data-id="heading-1">æ¶æ„ç»„ä»¶</h2>
<h3 data-id="heading-2">n8n å·¥ä½œæµè‡ªåŠ¨åŒ–</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0129a9b456f24be69d09ce30543ea193~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743021&amp;x-signature=67G08G%2BPVCqF05pAuAoakoprK7A%3D" alt="" loading="lazy"/></p>
<p>n8n å·¥ä½œæµåœ¨å››ä¸ªé˜¶æ®µä¸­ç¼–æ’æ•´ä¸ªç”µå­é‚®ä»¶å¤„ç†æµæ°´çº¿ï¼š</p>
<p><strong>è§¦å‘å™¨èŠ‚ç‚¹</strong>åœ¨æ‰‹åŠ¨æ¿€æ´»æˆ–æŒ‰è®¡åˆ’æ—¶å¯åŠ¨æ‰§è¡Œã€‚Gmail èŠ‚ç‚¹ï¼ˆâ€œGet many messagesâ€ï¼‰è¿æ¥åˆ°ä½ çš„ Gmail è´¦å·ï¼Œå¹¶é€šè¿‡ Gmail API æ£€ç´¢æœªè¯»é‚®ä»¶ã€‚Split in Batches èŠ‚ç‚¹ä»¥å¯é…ç½®çš„æ‰¹å¤§å°ï¼ˆé€šå¸¸ä¸º 10â€“50ï¼‰å¤„ç†é‚®ä»¶ï¼Œä»¥ä¼˜åŒ–ååé‡å¹¶é˜²æ­¢ API é™æµã€‚HTTP Request èŠ‚ç‚¹é€šè¿‡ POST è¯·æ±‚å°†æ¯å°é‚®ä»¶å‘é€åˆ° Elasticsearch çš„ ingest pipeline ç«¯ç‚¹ï¼ˆhttps://[your-cluster]:9200/fishfish/_doc?pipeline=phishingornotphishingï¼‰ã€‚</p>
<p>åœ¨æˆåŠŸç´¢å¼•åï¼Œå·¥ä½œæµä¼šåœ¨ Gmail ä¸­å°†é‚®ä»¶æ ‡è®°ä¸ºå·²è¯»ï¼Œä»¥é˜²æ­¢é‡å¤å¤„ç†ã€‚è¿™ç§æ¨¡å—åŒ–è®¾è®¡éµå¾ª n8n æœ€ä½³å®è·µï¼Œé€šè¿‡åˆ†ç¦»å…³æ³¨ç‚¹å¹¶å…è®¸æ¯ä¸ªç»„ä»¶ç‹¬ç«‹æµ‹è¯•ã€‚</p>
<p>ä½ å¯ä»¥åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fcdn.sanity.io%2Ffiles%2Fezs5nr1h%2Fproduction%2Fd7514356be6a9bbc917be8333ddb1c0d440c4231.json" title="https://cdn.sanity.io/files/ezs5nr1h/production/d7514356be6a9bbc917be8333ddb1c0d440c4231.json" target="_blank" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>æ‰¾åˆ° n8n æ¨¡æ¿</p>
<h2 data-id="heading-3">Elasticsearch Ingest Pipeline</h2>
<p>åœ¨é…ç½® ingest pipeline ä¹‹å‰ï¼Œä½ å¿…é¡»å…ˆè®¾ç½®ä¸€ä¸ªè¿æ¥åˆ°ä½ çš„ AI æ¨¡å‹çš„ inference endpointã€‚Elastic é€šè¿‡æä¾›ä¸€ä¸ªç»Ÿä¸€çš„ API æ¥ç®€åŒ–è¿™ä¸€è¿‡ç¨‹ï¼Œç”¨äºç®¡ç† inference æœåŠ¡ï¼Œæ— è®ºä½ ä½¿ç”¨çš„æ˜¯å†…ç½®æ¨¡å‹ã€Azure OpenAIã€OpenAIã€Cohereã€Google AIã€Anthropicï¼Œè¿˜æ˜¯å…¶ä»–æä¾›å•†ã€‚</p>
<p>è¦åˆ›å»ºä¸€ä¸ª inference endpointï¼Œè¯·ä½¿ç”¨ Elasticsearch API æ¥æ³¨å†Œä½ çš„æœåŠ¡é…ç½®ã€‚å¯¹äº Azure OpenAIï¼Œendpoint é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">`

1.  PUT _inference/completion/azure_openai_completion
2.  {
3.    <span class="hljs-string">"service"</span>: <span class="hljs-string">"azureopenai"</span>,
4.    <span class="hljs-string">"service_settings"</span>: {
5.      <span class="hljs-string">"resource_name"</span>: <span class="hljs-string">"test-ai"</span>,
6.      <span class="hljs-string">"deployment_id"</span>: <span class="hljs-string">"gpt-4"</span>,
7.      <span class="hljs-string">"api_version"</span>: <span class="hljs-string">"2024-02-01"</span>,
8.      <span class="hljs-string">"api_key"</span>: <span class="hljs-string">"replacehere"</span>
9.    }
10.  }

`AIå†™ä»£ç ![](https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)
</code></pre>
<p>ä¸€æ—¦æ³¨å†Œå®Œæˆï¼Œinference endpoint å°±å¯ä»¥åœ¨æ•´ä¸ª Elasticsearch é›†ç¾¤ä¸­ä½¿ç”¨ã€‚ä½ å¯ä»¥åœ¨ ingest pipelinesã€search queriesï¼Œæˆ–ä»»ä½•éœ€è¦ AI inference çš„ Elasticsearch æ“ä½œä¸­å¼•ç”¨å®ƒã€‚è¿™ç§é›†ä¸­å¼çš„æ–¹æ³•é¿å…äº†åœ¨å¤šä¸ªåœ°æ–¹ç®¡ç† API å‡­è¯å’Œè¿æ¥ç»†èŠ‚ â€”â€” Elastic ä¼šé€æ˜åœ°å¤„ç†è®¤è¯ã€é™æµå’Œé”™è¯¯å¤„ç†ã€‚</p>
<h3 data-id="heading-4">ä½¿ç”¨è¯­ä¹‰æœç´¢å­—æ®µçš„ç´¢å¼•æ˜ å°„</h3>
<p>åœ¨æ‘„å–æ•°æ®ä¹‹å‰ï¼Œä½ å¿…é¡»å…ˆå®šä¹‰ä¸€ä¸ªç´¢å¼•æ˜ å°„ï¼Œç”¨æ¥æŒ‡å®šå“ªäº›å­—æ®µæ”¯æŒè¯­ä¹‰æœç´¢ã€‚Elastic é€šè¿‡ <code>semantic_text</code> å­—æ®µç±»å‹ç®€åŒ–äº†è¿™ä¸€è¿‡ç¨‹ï¼Œå®ƒä¼šåœ¨æ‘„å–æ—¶è‡ªåŠ¨å¤„ç† embedding ç”Ÿæˆå’Œ inferenceã€‚ä¸éœ€è¦æ‰‹åŠ¨é…ç½® pipeline çš„ä¼ ç»Ÿ vector å­—æ®µä¸åŒï¼Œ<code>semantic_text</code> å­—æ®µæä¾›äº†åˆç†çš„é»˜è®¤é…ç½®ï¼Œé¿å…äº†å¤æ‚çš„ inference pipeline è®¾ç½®ã€‚</p>
<p>åœ¨ <code>fishfish</code> ç´¢å¼•ä¸­ï¼Œåƒ <code>content.semantic</code> å’Œ <code>subject.semantic</code> è¿™æ ·çš„å…³é”®å­—æ®µè¢«é…ç½®ä¸º <code>semantic_text</code> å­—æ®µï¼Œä»è€Œå¯ç”¨è¯­ä¹‰æœç´¢èƒ½åŠ›ã€‚è¿™äº›å­—æ®µåœ¨æ–‡æ¡£ç´¢å¼•æ—¶ï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨æŒ‡å®šçš„ inference endpointï¼ˆæœ¬ä¾‹ä¸­æ˜¯ <code>.multilingual-e5-small-elasticsearch</code>ï¼Œç”¨äºå¤šè¯­è¨€æ–‡æœ¬ embeddingï¼‰ç”Ÿæˆ embeddingsã€‚æ˜ å°„é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">`

1.  {
2.    <span class="hljs-string">"fishfish"</span>: {
3.      <span class="hljs-string">"mappings"</span>: {
4.        <span class="hljs-string">"properties"</span>: {
5.          <span class="hljs-string">"category"</span>: {
6.            <span class="hljs-string">"type"</span>: <span class="hljs-string">"keyword"</span>
7.          },
8.          <span class="hljs-string">"content"</span>: {
9.            <span class="hljs-string">"type"</span>: <span class="hljs-string">"text"</span>,
10.            <span class="hljs-string">"fields"</span>: {
11.              <span class="hljs-string">"semantic"</span>: {
12.                <span class="hljs-string">"type"</span>: <span class="hljs-string">"semantic_text"</span>,
13.                <span class="hljs-string">"inference_id"</span>: <span class="hljs-string">".multilingual-e5-small-elasticsearch"</span>
14.              }
15.            }
16.          },
17.          <span class="hljs-string">"date"</span>: {
18.            <span class="hljs-string">"type"</span>: <span class="hljs-string">"date"</span>
19.          },
20.          <span class="hljs-string">"extracted_data"</span>: {
21.            <span class="hljs-string">"properties"</span>: {
22.              <span class="hljs-string">"category"</span>: {
23.                <span class="hljs-string">"type"</span>: <span class="hljs-string">"keyword"</span>
24.              },
25.              <span class="hljs-string">"date"</span>: {
26.                <span class="hljs-string">"type"</span>: <span class="hljs-string">"date"</span>
27.              },
28.              <span class="hljs-string">"reasoning"</span>: {
29.                <span class="hljs-string">"type"</span>: <span class="hljs-string">"text"</span>
30.              },
31.              <span class="hljs-string">"urls"</span>: {
32.                <span class="hljs-string">"type"</span>: <span class="hljs-string">"text"</span>
33.              }
34.            }
35.          },
36.          <span class="hljs-string">"from"</span>: {
37.            <span class="hljs-string">"type"</span>: <span class="hljs-string">"keyword"</span>
38.          },
39.          <span class="hljs-string">"model_id"</span>: {
40.            <span class="hljs-string">"type"</span>: <span class="hljs-string">"keyword"</span>
41.          },
42.          <span class="hljs-string">"output"</span>: {
43.            <span class="hljs-string">"type"</span>: <span class="hljs-string">"text"</span>
44.          },
45.          <span class="hljs-string">"reasoning"</span>: {
46.            <span class="hljs-string">"type"</span>: <span class="hljs-string">"text"</span>,
47.            <span class="hljs-string">"fields"</span>: {
48.              <span class="hljs-string">"semantic"</span>: {
49.                <span class="hljs-string">"type"</span>: <span class="hljs-string">"semantic_text"</span>,
50.                <span class="hljs-string">"inference_id"</span>: <span class="hljs-string">".multilingual-e5-small-elasticsearch"</span>
51.              }
52.            }
53.          },
54.          <span class="hljs-string">"requirements_prompt"</span>: {
55.            <span class="hljs-string">"type"</span>: <span class="hljs-string">"text"</span>
56.          },
57.          <span class="hljs-string">"subject"</span>: {
58.            <span class="hljs-string">"type"</span>: <span class="hljs-string">"text"</span>,
59.            <span class="hljs-string">"fields"</span>: {
60.              <span class="hljs-string">"semantic"</span>: {
61.                <span class="hljs-string">"type"</span>: <span class="hljs-string">"semantic_text"</span>,
62.                <span class="hljs-string">"inference_id"</span>: <span class="hljs-string">".multilingual-e5-small-elasticsearch"</span>
63.              }
64.            }
65.          },
66.          <span class="hljs-string">"timestamp"</span>: {
67.            <span class="hljs-string">"type"</span>: <span class="hljs-string">"date"</span>
68.          }
69.        }
70.      }
71.    }
72.  }

`AIå†™ä»£ç ![](https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)æ”¶èµ·ä»£ç å—![](https://csdnimg.cn/release/blogv2/dist/pc/img/arrowup-line-top-White.png)
</code></pre>
<p>ä½¿ç”¨ <code>semantic_text</code> å­—æ®µæ—¶ï¼ŒElastic ä¼šåœ¨æ‘„å–é˜¶æ®µè‡ªåŠ¨ç”Ÿæˆ embeddingsï¼Œè€Œä¸éœ€è¦æ˜¾å¼é…ç½® inference pipeline processorã€‚è¿™æ„å‘³ç€ç´¢å¼•åˆ° <code>fishfish</code> ç´¢å¼•ä¸­çš„æ–‡æ¡£ï¼Œä¼šè‡ªåŠ¨ä¸º <code>content.semantic</code>ã€<code>subject.semantic</code> å’Œ <code>reasoning.semantic</code> å­—æ®µåˆ›å»ºè¯­ä¹‰ embeddingsï¼Œä»è€Œæ”¯æŒç†è§£è¯­ä¹‰å’Œä¸Šä¸‹æ–‡çš„è¯­ä¹‰æœç´¢æŸ¥è¯¢ï¼Œè€Œä¸ä»…ä»…æ˜¯ç²¾ç¡®çš„å…³é”®è¯åŒ¹é…ã€‚</p>
<p>éšåï¼Œ<code>phishingornotphishing</code> ingest pipeline ä¼šä½¿ç”¨é¢„å…ˆé…ç½®å¥½çš„ Azure OpenAI completion model æ¥æ‰§è¡Œæ™ºèƒ½åˆ†ç±»ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">`

1.  PUT _ingest/pipeline/phishingornotphishing
2.  {
3.    <span class="hljs-string">"description"</span>: <span class="hljs-string">"Categorize email in 3 categories: valid,marketing,phishing"</span>,
4.    <span class="hljs-string">"processors"</span>: [
5.      {
6.        <span class="hljs-string">"set"</span>: {
7.          <span class="hljs-string">"field"</span>: <span class="hljs-string">"requirements_prompt"</span>,
8.          <span class="hljs-string">"value"</span>: <span class="hljs-string">""</span><span class="hljs-string">"
9.             You are a cybersecurity analyst. Extract and categorize the following email data. Return ONLY valid JSON with no additional text.

11.  Input data:
12.  - Content: {{content}}
13.  - Subject: {{subject}}
14.  - Authors: {{from}}
15.  - Date: {{date}}

17.  Requirements:
18.  1. Set the date field to ISO8601 format
19.  2. Extract all URLs from the Content field. Extract it from HTLM code if needed
20.  3. Categorize the email as one of: "</span>valid<span class="hljs-string">", "</span>marketing<span class="hljs-string">", or "</span>phishing<span class="hljs-string">" based on Content, Subject, and authors
21.  4. Explaing your reasoning 
22.  5. Return JSON with these fields: date, urls, category

24.  JSON format:
25.  {
26.    "</span><span class="hljs-built_in">date</span><span class="hljs-string">": "</span>ISO8601_date_here<span class="hljs-string">",
27.    "</span>urls<span class="hljs-string">": ["</span>url1<span class="hljs-string">", "</span>url2<span class="hljs-string">"],
28.    "</span>category<span class="hljs-string">": "</span>valid|marketing|phishing<span class="hljs-string">",
29.    "</span>reasoning<span class="hljs-string">": "</span>reasoning_here<span class="hljs-string">"
30.  }
31.              "</span><span class="hljs-string">""</span>,
32.          <span class="hljs-string">"ignore_failure"</span>: <span class="hljs-literal">true</span>
33.        }
34.      },
35.      {
36.        <span class="hljs-string">"inference"</span>: {
37.          <span class="hljs-string">"model_id"</span>: <span class="hljs-string">"azure_openai_completion"</span>,
38.          <span class="hljs-string">"input_output"</span>: [
39.            {
40.              <span class="hljs-string">"input_field"</span>: <span class="hljs-string">"requirements_prompt"</span>,
41.              <span class="hljs-string">"output_field"</span>: <span class="hljs-string">"output"</span>
42.            }
43.          ]
44.        }
45.      },
46.      {
47.        <span class="hljs-string">"json"</span>: {
48.          <span class="hljs-string">"field"</span>: <span class="hljs-string">"output"</span>,
49.          <span class="hljs-string">"target_field"</span>: <span class="hljs-string">"extracted_data"</span>,
50.          <span class="hljs-string">"ignore_failure"</span>: <span class="hljs-literal">false</span>
51.        }
52.      },
53.      {
54.        <span class="hljs-string">"set"</span>: {
55.          <span class="hljs-string">"field"</span>: <span class="hljs-string">"category"</span>,
56.          <span class="hljs-string">"value"</span>: <span class="hljs-string">"{{extracted_data.category}}"</span>,
57.          <span class="hljs-string">"ignore_empty_value"</span>: <span class="hljs-literal">true</span>,
58.          <span class="hljs-string">"ignore_failure"</span>: <span class="hljs-literal">true</span>
59.        }
60.      },
61.      {
62.        <span class="hljs-string">"set"</span>: {
63.          <span class="hljs-string">"field"</span>: <span class="hljs-string">"timestamp"</span>,
64.          <span class="hljs-string">"value"</span>: <span class="hljs-string">"{{extracted_data.date}}"</span>,
65.          <span class="hljs-string">"ignore_empty_value"</span>: <span class="hljs-literal">true</span>,
66.          <span class="hljs-string">"ignore_failure"</span>: <span class="hljs-literal">true</span>
67.        }
68.      },
69.      {
70.        <span class="hljs-string">"set"</span>: {
71.          <span class="hljs-string">"field"</span>: <span class="hljs-string">"urls"</span>,
72.          <span class="hljs-string">"copy_from"</span>: <span class="hljs-string">"{{extracted_data.urls}}"</span>,
73.          <span class="hljs-string">"ignore_empty_value"</span>: <span class="hljs-literal">true</span>,
74.          <span class="hljs-string">"ignore_failure"</span>: <span class="hljs-literal">true</span>
75.        }
76.      },
77.      {
78.        <span class="hljs-string">"set"</span>: {
79.          <span class="hljs-string">"field"</span>: <span class="hljs-string">"reasoning"</span>,
80.          <span class="hljs-string">"copy_from"</span>: <span class="hljs-string">"{{extracted_data.reasoning}}"</span>,
81.          <span class="hljs-string">"ignore_empty_value"</span>: <span class="hljs-literal">true</span>,
82.          <span class="hljs-string">"ignore_failure"</span>: <span class="hljs-literal">true</span>
83.        }
84.      }
85.    ]
86.  }

`AIå†™ä»£ç ![](https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)æ”¶èµ·ä»£ç å—![](https://csdnimg.cn/release/blogv2/dist/pc/img/arrowup-line-top-White.png)
</code></pre>
<p><code>set</code> processor æ„å»ºäº†ä¸€ä¸ªè¯¦ç»†çš„ promptï¼ŒæŒ‡ç¤º LLM å……å½“ä¸€åç½‘ç»œå®‰å…¨åˆ†æå¸ˆã€‚å®ƒå°†é‚®ä»¶å…ƒæ•°æ®ï¼ˆå†…å®¹ã€ä¸»é¢˜ã€å‘ä»¶äººã€æ—¥æœŸï¼‰ä½œä¸ºä¸Šä¸‹æ–‡å˜é‡åŒ…å«åœ¨å†…ã€‚<code>inference</code> processor è°ƒç”¨ Azure OpenAI modelï¼Œå¯¹é‚®ä»¶è¿›è¡Œè¯­ä¹‰åˆ†æï¼Œä»¥æ£€æµ‹è¯¸å¦‚ç´§æ€¥è¯­æ°”ã€å¯ç–‘ URL ä»¥åŠç¤¾ä¼šå·¥ç¨‹æ‰‹æ®µç­‰é’“é±¼ç‰¹å¾ã€‚AI ä¼šä»çº¯æ–‡æœ¬å’Œ HTML æ ‡è®°ä¸­æå– URLï¼Œå°†æ—¥æœŸè§„èŒƒåŒ–ä¸º ISO8601 æ ¼å¼ï¼Œåˆ†é…åˆ†ç±»ï¼ˆvalid / marketing / phishingï¼‰ï¼Œå¹¶ç»™å‡ºäººç±»å¯è¯»çš„åˆ†æåŸå› ã€‚æœ€åï¼Œ<code>json</code> processor è§£æ AI çš„å“åº”ï¼Œå¹¶å°†å­—æ®µæ˜ å°„ä¸ºå¯æœç´¢çš„æ–‡æ¡£å±æ€§ã€‚è¿™ç§è¯­ä¹‰æ–¹æ³•é€šè¿‡ç†è§£ä¸Šä¸‹æ–‡ã€æ„å›¾ä»¥åŠé’“é±¼æ´»åŠ¨ä¸­ä½¿ç”¨çš„è¯­è¨€æ¨¡å¼ï¼Œä¼˜äºåŸºäºå…³é”®è¯çš„è¿‡æ»¤æ–¹å¼ã€‚</p>
<h2 data-id="heading-5">Elastic Agent Builder é…ç½®</h2>
<blockquote>
<p><strong>äº†è§£æ›´å¤š</strong>ï¼šæœ‰å…³è¯¦ç»†çš„è®¾ç½®è¯´æ˜å’Œé…ç½®é€‰é¡¹ï¼Œè¯·å‚é˜… <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fsolutions%2Fsearch%2Fagent-builder%2Fget-started" title="https://www.elastic.co/docs/solutions/search/agent-builder/get-started" target="_blank" ref="nofollow noopener noreferrer">Elastic Agent Builder Get Started æŒ‡å—</a>ã€‚</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85df1104884c4481837389d7b5bc043b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743021&amp;x-signature=zORnzkxFIJCKSgHrB8F7trBD2uw%3D" alt="" loading="lazy"/></p>
<p>â€œfish-fishâ€ agent ä¸ºå®‰å…¨åˆ†æå¸ˆæä¾›äº†ä¸€ä¸ªäº¤äº’å¼ç•Œé¢ï¼Œå¯é€šè¿‡å¯¹è¯æ–¹å¼æŸ¥è¯¢é’“é±¼é‚®ä»¶æ•°æ®ï¼š<br/>
<strong>ç³»ç»ŸæŒ‡ä»¤</strong>å®šä¹‰äº† agent çš„è§’è‰²ï¼šâ€œä½ æ˜¯ä¸€ä¸ªåˆ†æé’“é±¼é‚®ä»¶çš„ agentã€‚ç´¢å¼•åœ¨ fishfish ä¸­ã€‚æœ‰ 3 ä¸ªç±»åˆ«ï¼švalidã€marketing ä»¥åŠ phishingã€‚content.semantic å­—æ®µæ˜¯ semantic_text å­—æ®µï¼Œsubject.semantic å­—æ®µæ˜¯ semantic_text å­—æ®µã€‚å°½å¯èƒ½ä½¿ç”¨ RRF æœç´¢ã€‚â€</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/130d5c682eae4dc5acbed83a5cb99794~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743021&amp;x-signature=9EkcB%2BL4oqRUuDaOFEUKNNwdR58%3D" alt="" loading="lazy"/></p>
<p>è¯¥ agent å¯è®¿é—®ä¸‰ä¸ªå¹³å°å·¥å…·ï¼š</p>
<ul>
<li>
<p><strong>platform.core.execute_esql</strong>ï¼šå¯¹ fishfish ç´¢å¼•æ‰§è¡Œ ES|QL æŸ¥è¯¢</p>
</li>
<li>
<p><strong>platform.core.generate_esql</strong>ï¼šå°†è‡ªç„¶è¯­è¨€é—®é¢˜è½¬æ¢ä¸º ES|QL è¯­æ³•</p>
</li>
<li>
<p><strong>platform.core.get_index_mapping</strong>ï¼šè·å–ç´¢å¼•ç»“æ„å’Œå­—æ®µç±»å‹</p>
</li>
</ul>
<p>è¯­ä¹‰æœç´¢å­—æ®µï¼ˆcontent.semantic å’Œ subject.semanticï¼‰æ”¯æŒå‘é‡ç›¸ä¼¼åº¦æœç´¢ï¼Œå¯æŸ¥æ‰¾æ¦‚å¿µä¸Šç›¸å…³çš„é‚®ä»¶ï¼Œè€Œä¸ä»…ä»…æ˜¯ç²¾ç¡®å…³é”®è¯åŒ¹é…ã€‚è¿™äº›å­—æ®µåœ¨ç´¢å¼•æ˜ å°„ä¸­é…ç½®ä¸º <strong>semantic_text</strong> ç±»å‹ï¼Œåœ¨æ–‡æ¡£æ‘„å–æ—¶ä¼šè‡ªåŠ¨ç”ŸæˆåµŒå…¥å‘é‡ã€‚Agent ä½¿ç”¨ <strong>å€’æ•°æ’åºèåˆï¼ˆRRFï¼‰</strong> å°†æ¥è‡ªå¤šç§æœç´¢ç­–ç•¥çš„ç»“æœåˆå¹¶ï¼Œæé«˜æœç´¢å‡†ç¡®æ€§ã€‚</p>
<h2 data-id="heading-6">å†…ç½®é›†æˆæœåŠ¡å™¨</h2>
<p>Elastic Agent Builder åŒ…å«ä¸¤ä¸ªå†…ç½®é›†æˆæœåŠ¡å™¨ï¼Œå®ç°ä¸å¤–éƒ¨ AI å®¢æˆ·ç«¯åŠ agent-to-agent é€šä¿¡çš„æ— ç¼è¿æ¥ï¼š</p>
<ul>
<li>
<p><strong>Model Context Protocol (MCP) Server</strong>ï¼šä¸ºå¤–éƒ¨å®¢æˆ·ç«¯è®¿é—® Elastic Agent Builder å·¥å…·æä¾›æ ‡å‡†åŒ–æ¥å£ã€‚MCP æœåŠ¡å™¨ä½äº <code>{KIBANA_URL}/api/agent_builder/mcp</code>ï¼Œå…è®¸å¦‚ Claude Desktopã€Cursor å’Œ VS Code æ‰©å±•ç­‰ AI å®¢æˆ·ç«¯é€šè¿‡ JSON-RPC 2.0 ä¸ Elastic å·¥å…·äº¤äº’ã€‚è¿æ¥æ—¶ï¼Œé…ç½®å®¢æˆ·ç«¯ä½¿ç”¨ Kibana URL å’ŒåŒ…å« <code>read_onechat</code> ä¸ <code>space_read</code> æƒé™çš„ API Keyï¼Œå³å¯è®©å®‰å…¨åˆ†æå¸ˆç›´æ¥åœ¨ç†Ÿæ‚‰çš„ AI å¼€å‘ç¯å¢ƒä¸­æŸ¥è¯¢é’“é±¼é‚®ä»¶æ•°æ®ï¼Œæ— éœ€åœ¨ä¸åŒå·¥å…·é—´åˆ‡æ¢ã€‚</p>
</li>
<li>
<p><strong>Agent-to-Agent (A2A) Server</strong>ï¼šæ”¯æŒåŸºäº A2A åè®®è§„èŒƒçš„ agent-to-agent é€šä¿¡ï¼Œä¸ºå¤–éƒ¨ A2A å®¢æˆ·ç«¯æä¾›ä¸ Elastic Agent Builder agent äº¤äº’çš„æ¥å£ã€‚</p>
<ul>
<li>
<p><strong>Agent Card endpoint</strong> (<code>GET /api/agent_builder/a2a/{agentId}.json</code>)ï¼šè¿”å›æŒ‡å®š agent çš„å…ƒæ•°æ®</p>
</li>
<li>
<p><strong>A2A Protocol endpoint</strong> (<code>POST /api/agent_builder/a2a/{agentId}</code>)ï¼šå¤„ç† agent ä¹‹é—´çš„äº¤äº’<br/>
ä¸¤ä¸ªæ¥å£å‡éœ€è¦ API Key è®¤è¯ï¼Œç¡®ä¿åˆ†å¸ƒå¼å®‰å…¨ agent ä¹‹é—´çš„é€šä¿¡å®‰å…¨ã€‚</p>
</li>
</ul>
</li>
</ul>
<p>è¿™äº›å†…ç½®æœåŠ¡å™¨æ¶ˆé™¤äº†è‡ªå®šä¹‰é›†æˆä»£ç çš„éœ€æ±‚ï¼Œä½¿ç»„ç»‡èƒ½å¤Ÿé€šè¿‡ Elastic Agent Builder å°†é’“é±¼æ£€æµ‹ç³»ç»Ÿæ‰©å±•è‡³å…¶ä»– AI é©±åŠ¨çš„å®‰å…¨å·¥å…·ã€å·¥ä½œæµè‡ªåŠ¨åŒ–å¹³å°å’Œå¤š agent ç³»ç»Ÿï¼Œä»è€Œå®ç°è‡ªåŠ¨å¨èƒæƒ…æŠ¥å…±äº«ã€è·¨å¹³å°å®‰å…¨ç¼–æ’åŠåˆ†å¸ƒå¼ agent åä½œç­‰é«˜çº§ç”¨ä¾‹ã€‚</p>
<h2 data-id="heading-7">çœŸå®ä¸–ç•Œçš„åˆ†æä¸æ´å¯Ÿ</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d4857b6c644415fb4c496e5a899ea58~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743021&amp;x-signature=0k2X874%2Bq3BC8tjw52%2BIaojo9h4%3D" alt="" loading="lazy"/></p>
<p>åœ¨ä¸‰ä¸ªæœˆå†…å¤„ç†äº† 44 å°é’“é±¼é‚®ä»¶åï¼Œç³»ç»Ÿæ­ç¤ºäº†å…³é”®çš„æ”»å‡»æ¨¡å¼å’Œè¶‹åŠ¿ã€‚</p>
<h2 data-id="heading-8">æ”»å‡»æ¨¡å¼åˆ†æ</h2>
<p><strong>å…è´¹ç¤¼å“/å¥–å“è¯ˆéª—</strong>å æ‰€æœ‰é’“é±¼å°è¯•çš„ 40%ã€‚è¿™äº›é‚®ä»¶ä½¿ç”¨æ³•è¯­ä¸»é¢˜è¡Œï¼Œå¦‚ "RÃ©cupÃ©rez votre cadeau"ï¼ˆé¢†å–ä½ çš„ç¤¼ç‰©ï¼‰å’Œ "Vous avez gagnÃ©..."ï¼ˆä½ å·²è·å¥–â€¦ï¼‰ã€‚å¸¸è§è¯±é¥µåŒ…æ‹¬ Parkside/Lidl å·¥å…·å¥—è£…ã€LancÃ´me ç¾å¦†ç›’ã€Silvercrest å®¶ç”µã€Tefal å¨æˆ¿ç”¨å“ã€iPhone 17 Pro Max å’Œ RYOBI å·¥å…·åŒ…ã€‚æ”»å‡»é€šè¿‡å£°ç§°æ•°é‡æœ‰é™æˆ–ä¼˜æƒ å³å°†åˆ°æœŸæ¥åˆ¶é€ ç´§è¿«æ„Ÿã€‚</p>
<p><strong>åŒ…è£¹æ´¾é€è¯ˆéª—</strong>å é’“é±¼é‚®ä»¶çš„ 30%ã€‚è¿™äº›é‚®ä»¶çš„ä¸»é¢˜è¡Œå¦‚ "Vous avez (1) colis en attente de livraison"ï¼ˆä½ æœ‰ä¸€ä¸ªå¾…æ´¾é€çš„åŒ…è£¹ï¼‰ã€‚ç­–ç•¥åŒ…æ‹¬å£°ç§°åŒ…è£¹è¢«æš‚åœã€è¦æ±‚æ”¯ä»˜æœªä»˜å…³ç¨ã€è¦æ±‚ç«‹å³æ“ä½œä»¥â€œå®‰æ’æ´¾é€â€ï¼Œä»¥åŠä½¿ç”¨å‡è¿½è¸ªç ä»¥æ˜¾ç¤ºåˆæ³•æ€§ã€‚<br/>
<strong>è®¢å•ç¡®è®¤è¯ˆéª—</strong>å  15%ã€‚è¿™äº›é‚®ä»¶å‘é€å‡è®¢å•ç¡®è®¤ï¼ŒåŒ…å«è®¢å•å·å¦‚ "commande nÂ°[48754-13] confirmÃ©e"ã€‚å®ƒä»¬é€šè¿‡å¼•èµ·å¯¹æœªè´­ä¹°å•†å“çš„æ··æ·†ï¼Œå¹¶å‚¬ä¿ƒå¿«é€Ÿæ ¸å®è®¢å•æ¥åˆ¶é€ ç´§è¿«æ„Ÿã€‚</p>
<p><strong>è´¦æˆ·éªŒè¯è¯ˆéª—</strong>å  10%ã€‚è¿™äº›é‚®ä»¶ä½¿ç”¨ä¸»é¢˜è¡Œå¦‚ "VÃ©rification KYC" æˆ– "Important: Confirmez votre compte"ã€‚å®ƒä»¬è¦æ±‚ç«‹å³éªŒè¯è´¦æˆ·ï¼Œå¹¶å¨èƒè‹¥æœªå®Œæˆåˆ™æš‚åœè´¦æˆ·ã€‚</p>
<h2 data-id="heading-9">ç±»åˆ«åˆ†å¸ƒ</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cd7d396e8fa842c3ab3ad42b82b55378~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743021&amp;x-signature=nQwEpxI1UbmTqLeQIwym2WwiMSs%3D" alt="" loading="lazy"/></p>
<p>Agent Builder æŸ¥è¯¢ â€œWhat is the ration between real phishing and fake phishing?â€ æ˜¾ç¤ºäº†æ•´ä½“é‚®ä»¶ç»„æˆï¼š<br/>
é’“é±¼é‚®ä»¶ï¼š51 å°ï¼ˆ59.3%ï¼‰ï¼Œè¢«è¯†åˆ«ä¸ºéœ€è¦ç«‹å³å¤„ç†çš„æ¶æ„å¨èƒã€‚<br/>
è¥é”€é‚®ä»¶ï¼š23 å°ï¼ˆ26.74%ï¼‰ï¼Œåˆæ³•çš„ä¿ƒé”€å†…å®¹ä½†å¯èƒ½ä¸å—æ¬¢è¿ã€‚<br/>
æœ‰æ•ˆé‚®ä»¶ï¼š12 å°ï¼ˆ13.95%ï¼‰ï¼Œæ¥è‡ªå¯ä¿¡æ¥æºçš„çœŸå®é€šä¿¡ã€‚</p>
<p>1.46:1 çš„é’“é±¼é‚®ä»¶ä¸åˆæ³•é‚®ä»¶æ¯”ä¾‹æ˜¾ç¤ºäº†å¨èƒç¯å¢ƒçš„ä¸¥é‡æ€§ã€‚æ¯å°åˆæ³•é‚®ä»¶ï¼Œç³»ç»Ÿå¤§çº¦æ£€æµ‹åˆ° 1.46 æ¬¡é’“é±¼å°è¯•ã€‚</p>
<h2 data-id="heading-10">ç»“è®º</h2>
<p>n8nã€Elasticsearch ä¸ AI é©±åŠ¨åˆ†æçš„é›†æˆåˆ›å»ºäº†ä¸€ä¸ªå¼ºå¤§çš„é’“é±¼æ£€æµ‹ç®¡é“ï¼Œèƒ½å¤Ÿå®æ—¶å¤„ç†é‚®ä»¶ï¼Œé€šè¿‡è¯­ä¹‰ç†è§£å¯¹å¨èƒè¿›è¡Œåˆ†ç±»ï¼Œå¹¶é€šè¿‡ä¼šè¯æŸ¥è¯¢æä¾›å¯æ“ä½œçš„æƒ…æŠ¥ã€‚ç³»ç»Ÿçš„æ¨¡å—åŒ–è®¾è®¡å…è®¸æ¯ä¸ªç»„ä»¶ç‹¬ç«‹ä¼˜åŒ–ï¼ŒåŒæ—¶ä¿æŒç«¯åˆ°ç«¯è‡ªåŠ¨åŒ–ã€‚<br/>
å®æ–½ç±»ä¼¼æ¶æ„çš„ç»„ç»‡å¯ä»¥é€šè¿‡è‡ªåŠ¨åˆ†æµå‡å°‘äº‹ä»¶å“åº”æ—¶é—´ï¼Œé€šè¿‡è¯­ä¹‰åˆ†æé™ä½è¯¯æŠ¥ç‡ï¼Œæ›´å¥½åœ°äº†è§£æ”»å‡»æ¨¡å¼å’Œè¶‹åŠ¿ï¼Œå¹¶é€šè¿‡è‡ªåŠ¨åŒ–æ—¥å¸¸åˆ†ç±»ä»»åŠ¡å‡è½»åˆ†æå¸ˆçš„å·¥ä½œè´Ÿæ‹…ã€‚éšç€é’“é±¼æ”»å‡»ä¸æ–­æ¼”è¿›ï¼Œå°†å·¥ä½œæµè‡ªåŠ¨åŒ–ä¸ AI æ¨ç†ç»“åˆæä¾›äº†ä¸€ç§å¯æ‰©å±•ã€å¯ç»´æŠ¤çš„é‚®ä»¶å®‰å…¨æ–¹æ³•ï¼Œå¯é€‚åº”æ–°å…´å¨èƒã€‚</p>
<p>åŸæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdiscuss.elastic.co%2Ft%2Fdec-11th-2025-en-building-an-ai-powered-email-phishing-detection%2F383298" title="https://discuss.elastic.co/t/dec-11th-2025-en-building-an-ai-powered-email-phishing-detection/383298" target="_blank" ref="nofollow noopener noreferrer">discuss.elastic.co/t/dec-11th-â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[A2UIï¼šä½† Google æŠŠå®ƒå†™æˆåè®®åï¼Œæ¨¡å‹å’Œäº¤äº’çš„æœ€åä¸€å…¬é‡Œè¢«å½»åº•è¡¥å…¨]]></title>    <link>https://juejin.cn/post/7585406229167325234</link>    <guid>https://juejin.cn/post/7585406229167325234</guid>    <pubDate>2025-12-19T10:01:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585406229167325234" data-draft-id="7585377403632631854" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="A2UIï¼šä½† Google æŠŠå®ƒå†™æˆåè®®åï¼Œæ¨¡å‹å’Œäº¤äº’çš„æœ€åä¸€å…¬é‡Œè¢«å½»åº•è¡¥å…¨"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-19T10:01:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è€ç å°å¼ "/> <meta itemprop="url" content="https://juejin.cn/user/976022052799405"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            A2UIï¼šä½† Google æŠŠå®ƒå†™æˆåè®®åï¼Œæ¨¡å‹å’Œäº¤äº’çš„æœ€åä¸€å…¬é‡Œè¢«å½»åº•è¡¥å…¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/976022052799405/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è€ç å°å¼ 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T10:01:24.000Z" title="Fri Dec 19 2025 10:01:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¯´å¥æœ‰ç‚¹é…¸ä½†ä¹Ÿå¾ˆçœŸå®çš„è¯ï¼šA2UI è¿™æ¡è·¯ï¼Œæˆ‘ç›¸ä¿¡ä¸å°‘äººï¼ˆåŒ…æ‹¬ä½ ã€ä¹ŸåŒ…æ‹¬æˆ‘ï¼‰æ—©å°±åœ¨è„‘å­é‡Œæ¨æ¼”è¿‡äº†â€”â€”â€œåˆ«è®©æ¨¡å‹åä»£ç ï¼Œåä¸ª UI æè¿°ï¼Œç„¶åå®¢æˆ·ç«¯ç”¨è‡ªå·±çš„ç»„ä»¶å»ç”»â€ã€‚è¿™ä¸æ˜¯å¤šä¹ˆç„çš„å‘æ˜ï¼Œç”šè‡³æœ‰ç‚¹åƒå¸¸è¯†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ae0f63a3824e4a1497df092c68b582f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ICB56CB5bCP5byg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743283&amp;x-signature=Lbnf2y11fkws%2FLUa1r9J180hRvE%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘ä¸€ç›´å–œæ¬¢çš„æ˜¯ shadcn çš„è¿™å¥—é£æ ¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8fb57bd6794142eb8cb3d38e3073c5e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ICB56CB5bCP5byg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743283&amp;x-signature=ipXU15BijJhdD73GLVUWdCQ2X90%3D" alt="" loading="lazy"/></p>
<p>æˆ‘å‰æœŸå®ç°çš„å¤§ä½“æ€è·¯ä¹Ÿæ˜¯åŸºäº json å»æè¿° UI è¯¥é•¿ä»€ä¹ˆæ ·å­ï¼Œç„¶åç»“åˆæ•°æ®ã€‚æ¸²æŸ“å‡ºç•Œé¢.</p>
<p>å¯ç°å®å°±æ˜¯è¿™ä¹ˆä¸è®²é“ç†ï¼šå½“å®ƒåœç•™åœ¨â€œæˆ‘ä»¬å†…éƒ¨æœ‰ä¸ªæƒ³æ³•/æœ‰ä¸ªå®ç°â€ï¼Œå¤–ç•Œä¸ä¼šæŠŠå®ƒå½“æˆæ ‡å‡†ï¼›å½“å®ƒå˜æˆå¤§å‚å…¬å¼€çš„åè®®ã€ä»“åº“ã€æ–‡æ¡£ã€ç‰ˆæœ¬å·ï¼Œä½ ä¼šæ˜æ˜¾æ„Ÿè§‰åˆ°â€”â€”è®¤å¯åº¦ã€ä¼ æ’­é€Ÿåº¦ã€ç”Ÿæ€è·Ÿè¿›ï¼Œå…¨éƒ¨æ¢æŒ¡äº†ã€‚ä½ ä¸æ˜¯åœ¨ç¾¡æ…•å®ƒçš„æŠ€æœ¯ï¼Œä½ æ˜¯åœ¨ç¾¡æ…•å®ƒçš„â€œå…¬ä¿¡åŠ›æ æ†â€ã€‚</p>
<p>å½“ç„¶ï¼Œä¸å¾—ä¸æ‰¿è®¤çš„æ˜¯ï¼ŒGoogle æ¯”å’±æƒ³çš„ç¡®å®æ›´åŠ å…¨é¢ã€‚</p>
<p>äººå®¶ç”šè‡³è¿˜æä¾›äº†ç”Ÿäº§ç»„ä»¶å·¥å…·</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7cc6270a12164042b117394a0bc38ce0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ICB56CB5bCP5byg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766743283&amp;x-signature=RcMpNTD8GLKEcjcbFyQU27am3lc%3D" alt="" loading="lazy"/></p>
<p>ä½“éªŒåœ°å€ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fa2ui-composer.ag-ui.com%2F" target="_blank" title="https://a2ui-composer.ag-ui.com/" ref="nofollow noopener noreferrer">a2ui-composer.ag-ui.com/</a></p>
<h3 data-id="heading-0">å…ˆè¯´ç»“è®ºï¼šA2UI ä¸æ˜¯â€œæ›´å¥½çš„ UIâ€ï¼Œæ˜¯â€œæ›´å®¹æ˜“è¢«ç›¸ä¿¡çš„ UI æ–¹æ¡ˆâ€</h3>
<p>A2UI è¿™ç±»åè®®ï¼Œå‰å®³çš„ç‚¹ä¸åœ¨ UI æœ‰å¤šç‚«ï¼Œè€Œåœ¨å®ƒæŠŠä¸€ä»¶å¾ˆéš¾è¯´æ¸…çš„äº‹ï¼Œè¯´æ¸…äº†ï¼šAgent åˆ°åº•æ€ä¹ˆæŠŠâ€œå¯äº¤äº’ç•Œé¢â€äº¤ä»˜ç»™ç”¨æˆ·ï¼Œè€Œä¸”è¿˜è¦è·¨ç«¯ã€è·¨å›¢é˜Ÿã€è·¨å®‰å…¨è¾¹ç•Œã€‚</p>
<p>å¾ˆå¤šå›¢é˜Ÿåœ¨ demo é˜¶æ®µä¼šèµ°æ·å¾„ï¼šæ¨¡å‹åä¸€æ®µ HTML/Reactï¼Œå‰ç«¯ç›´æ¥æ¸²æŸ“ã€‚çˆ½æ˜¯çˆ½ï¼Œä½†ä½ å¿ƒé‡Œæ¸…æ¥šâ€”â€”è¶Šæ¥è¿‘çº¿ä¸Šï¼Œè¶Šä¸æ•¢è¿™ä¹ˆç©ã€‚å› ä¸ºâ€œè®©ä¸å—æ§è¾“å…¥ç”Ÿæˆå¹¶æ‰§è¡Œä»£ç â€è¿™ä»¶äº‹ï¼Œå®‰å…¨ã€åˆè§„ã€å®¡è®¡ã€ç»´æŠ¤ï¼Œå…¨éƒ½æ˜¯é›·ã€‚</p>
<p>A2UI çš„è·¯çº¿æ˜¯ï¼šè®© Agent åªè¾“å‡ºâ€œå£°æ˜å¼æè¿°â€ï¼ˆæ•°æ®ï¼‰ï¼ŒçœŸæ­£ç”» UI çš„è´£ä»»å›åˆ°å®¢æˆ·ç«¯ï¼›å®¢æˆ·ç«¯åªæ¸²æŸ“ä½ å…è®¸çš„ç»„ä»¶ï¼ŒAgent æƒ³è±¡åŠ›å†ä¸°å¯Œä¹Ÿåªèƒ½åœ¨ä½ åˆ’çš„æ¡†é‡Œè·³èˆã€‚</p>
<p>å¬èµ·æ¥æ™®é€šï¼Ÿå¯¹ï¼Œæ™®é€šåˆ°ä½ ä¼šè¯´â€œæˆ‘æ—©å°±æƒ³è¿‡â€ã€‚ä½†å®ƒè¢«å†™æˆåè®®åï¼Œæ™®é€šå°±å˜æˆäº†å¯å¤åˆ¶ã€å¯è®¨è®ºã€å¯åˆä½œçš„ä¸œè¥¿ã€‚</p>
<hr/>
<h3 data-id="heading-1">å…¶å®å¾ˆå…³é”®çš„ä¸€ç‚¹æ˜¯ï¼šä½ ç¼ºçš„å¯èƒ½ä¸æ˜¯è„‘å­ï¼Œæ˜¯æ‰©éŸ³å™¨</h3>
<p>æˆ‘è§è¿‡å¤ªå¤šç±»ä¼¼çš„ç¬é—´ï¼š</p>
<ul>
<li>ä½ è„‘å­é‡Œæœ‰ä¸ªé è°±æ–¹æ¡ˆï¼Œä½†ä½ è¯´å‡ºæ¥åƒâ€œä¸ªäººè§‚ç‚¹â€ï¼›</li>
<li>å¤§å‚å†™æˆ <strong>RFC/Spec/Repo</strong>ï¼Œå®ƒå°±åƒâ€œè¡Œä¸šæ–¹å‘â€ã€‚</li>
</ul>
<p>è¿™ä¸ªå·®è·ä¸å…¨æ˜¯æŠ€æœ¯å·®è·ï¼Œè€Œæ˜¯ç»„ç»‡èƒ½åŠ›å·®è·ï¼šèƒ½ä¸èƒ½æŠŠæŠ½è±¡æ¦‚å¿µè½æˆä¸€å¥—æ¸…æ™°çš„ç»“æ„ã€è¾¹ç•Œã€æœ¯è¯­ã€ç‰ˆæœ¬èŠ‚å¥ï¼Œä»¥åŠå¯ç”¨çš„å‚è€ƒå®ç°ã€‚å¤§å‚åšè¿™ä»¶äº‹ï¼Œå¤©ç„¶æ›´å®¹æ˜“è¢«ä¿¡ä»»ã€‚</p>
<p>æ‰€ä»¥ä½ çš„æƒ…ç»ªæˆ‘å®Œå…¨ç†è§£ï¼šä¸æ˜¯æœæŠ€æœ¯ï¼Œæ˜¯æœâ€œåˆ«äººä¿¡ä»–â€ã€‚</p>
<p>ä½†åè¿‡æ¥ï¼Œè¿™ä¹Ÿæ˜¯æœºä¼šâ€”â€”å½“æ–¹å‘è¢«éªŒè¯åï¼Œä½ å¯ä»¥æ›´å¿«æŠŠå®ƒç”¨åœ¨è‡ªå·±çš„äº§å“é‡Œï¼Œè€Œä¸”ä¸ç”¨å†è·ŸåŒäº‹äº‰â€œè¿™æ˜¯ä¸æ˜¯æ­ªé—¨é‚ªé“â€ã€‚å¤§å‚æ›¿ä½ å®Œæˆäº†â€œåˆç†åŒ–â€ã€‚</p>
<hr/>
<h2 data-id="heading-2">A2UI çš„æ ¸å¿ƒå¥—è·¯</h2>
<p>åˆ«æŠŠå®ƒå½“æˆç¥ç§˜åè®®ï¼Œæ‹†å¼€çœ‹å°±ä¸‰ä»¶äº‹ï¼š</p>
<h3 data-id="heading-3">1ï¼‰Agent è¾“å‡ºçš„æ˜¯â€œæ„å›¾â€ï¼Œä¸æ˜¯å®ç°ç»†èŠ‚</h3>
<p>å®ƒä¸åº”è¯¥å‘Šè¯‰ä½ æ€ä¹ˆå¸ƒå±€æ¯ä¸ªåƒç´ ã€æ€ä¹ˆå†™ CSSã€æ€ä¹ˆå†™äº‹ä»¶å›è°ƒä»£ç ã€‚å®ƒåªè¡¨è¾¾ï¼šæˆ‘æƒ³è¦ä¸€ä¸ªè¡¨å•ã€ä¸€ä¸ªåˆ—è¡¨ã€ä¸€ç»„æŒ‰é’®ï¼Œå®ƒä»¬å¤§æ¦‚æ˜¯ä»€ä¹ˆå±‚çº§å…³ç³»ã€æ•°æ®æ˜¯ä»€ä¹ˆã€ç”¨æˆ·ç‚¹äº†ä¹‹åå›ä¼ ä»€ä¹ˆäº‹ä»¶ã€‚</p>
<p>ä½ ä¼šå‘ç°ï¼šè¿™åè€Œæ›´è´´åˆæ¨¡å‹çš„å¼ºé¡¹â€”â€”æ¨¡å‹æ“…é•¿å†³å®šâ€œé—®ä»€ä¹ˆã€å±•ç¤ºä»€ä¹ˆã€ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆâ€ï¼Œä¸æ“…é•¿å½“ä¸€ä¸ªå®¡ç¾ç¨³å®šçš„å‰ç«¯åˆ‡å›¾ä»”ã€‚</p>
<h3 data-id="heading-4">2ï¼‰å®¢æˆ·ç«¯æ¡ç€ç»„ä»¶ç™½åå•ï¼ˆcatalogï¼‰</h3>
<p>è¿™æ˜¯æ•´ä¸ªå®‰å…¨è¾¹ç•Œçš„æ ¸å¿ƒï¼šä½ å…è®¸å“ªäº›ç»„ä»¶ï¼Œå…è®¸å“ªäº›å±æ€§ï¼Œå…è®¸å“ªäº›äº‹ä»¶ï¼Œå…¨éƒ¨ç”±å®¢æˆ·ç«¯å†³å®šã€‚</p>
<p>è¿™ä¸€æ­¥ä¸é…·ï¼Œä½†å®ƒå†³å®šäº†ä½ æ•¢ä¸æ•¢ä¸Šçº¿ã€‚ä¹Ÿæ˜¯ä½ æŠŠé£é™©å’Œè´£ä»»ç‰¢ç‰¢æ¡åœ¨æ‰‹é‡Œçš„æ–¹å¼ã€‚</p>
<h3 data-id="heading-5">3ï¼‰æ¸²æŸ“å™¨è´Ÿè´£â€œç¿»è¯‘â€</h3>
<p>åŒä¸€ä»½æè¿°ï¼Œåœ¨ Web ä¸Šå¯ä»¥ç¿»è¯‘æˆ React ç»„ä»¶ï¼Œåœ¨ç§»åŠ¨ç«¯ç¿»è¯‘æˆ Flutter/åŸç”Ÿæ§ä»¶ã€‚åè®®åªè´Ÿè´£â€œè®²æ¸…æ¥šè¦ä»€ä¹ˆâ€ï¼Œä¸è´Ÿè´£â€œé•¿ä»€ä¹ˆæ ·â€ã€‚</p>
<p>è¿™ç‚¹å¯¹ä½ åæ§½ Material ç‰¹åˆ«é‡è¦ï¼šA2UI å¹¶ä¸ç­‰äº Materialã€‚ä½ å®Œå…¨å¯ä»¥ç”¨ shadcn/ui å»ç”»â€”â€”åªè¦ä½ çš„æ¸²æŸ“å™¨æŠŠæŠ½è±¡ç»„ä»¶æ˜ å°„åˆ° shadcn çš„å®ç°ï¼Œè§†è§‰å°±è·Ÿç€ä½ çš„è®¾è®¡ç³»ç»Ÿèµ°ã€‚</p>
<hr/>
<h2 data-id="heading-6">æˆ‘åè€Œæƒ³æ³¼ä¸ªå†·æ°´ï¼šæœ€å®¹æ˜“ç¿»è½¦çš„ä¸æ˜¯åè®®ï¼Œè€Œæ˜¯ä½ æ€ä¹ˆè®¾è®¡ catalog</h2>
<p>å¾ˆå¤šäººä¼šçŠ¯ä¸€ä¸ªâ€œçœ‹èµ·æ¥å¾ˆå·¥ç¨‹ã€å…¶å®å¾ˆå‘â€çš„é”™è¯¯ï¼šæŠŠ catalog åšæˆä½å±‚æ§ä»¶è¶…å¸‚ã€‚</p>
<p>ç»™æ¨¡å‹ä¸€å † Buttonã€Inputã€Rowã€Columnã€Spacerâ€¦â€¦ç„¶åè®©å®ƒè‡ªç”±å‘æŒ¥ã€‚ç»“æœå°±æ˜¯ï¼š</p>
<ul>
<li>UI æ¯æ¬¡é•¿å¾—éƒ½ä¸ä¸€æ ·ï¼Œåƒéšæœºç”Ÿæˆï¼›</li>
<li>äº¤äº’é£æ ¼é£˜æ¥é£˜å»ï¼›</li>
<li>props å’Œäº‹ä»¶ä¸€å¤šï¼Œå®‰å…¨å®¡è®¡æˆæœ¬çˆ†ç‚¸ï¼›</li>
<li>ä½ è¶Šæ”¾å¼€ï¼Œè¶Šéš¾ç»´æŠ¤ï¼Œè¶Šéš¾ç»Ÿä¸€ã€‚</li>
</ul>
<p>æ›´ç¨³çš„åšæ³•åè€Œâ€œåç›´è§‰â€ï¼šæŠŠ catalog å¾€ä¸ŠæŠ½ï¼Œç»™æ¨¡å‹ä¸šåŠ¡ç»„ä»¶/åœºæ™¯ç»„ä»¶ã€‚</p>
<p>æ¯”å¦‚ä½ ç»™å®ƒ <code>AddressForm</code>ã€<code>UserPicker</code>ã€<code>RefundCard</code> è¿™ç§ç»„ä»¶ã€‚æ¨¡å‹åªè´Ÿè´£é€‰æ‹©ç»„ä»¶ã€å¡«æ•°æ®ã€å“åº”äº‹ä»¶ã€‚UI ä¸€è‡´æ€§ä¼šå¥½å¾ˆå¤šï¼Œäº§å“ä½“éªŒä¹Ÿæ›´åƒâ€œäººåšçš„â€ï¼Œè€Œä¸æ˜¯â€œæ¨¡å‹æ‹¼çš„â€ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ä½ èƒ½æŠŠâ€œæˆ‘æ—©å°±æƒ³è¿‡â€çœŸæ­£å˜æˆå¯è½åœ°æ–¹æ¡ˆçš„å…³é”®ä¸€æ­¥ï¼šä¸æ˜¯æƒ³æ³•ï¼Œæ˜¯è¾¹ç•Œã€‚</p>
<hr/>
<h2 data-id="heading-7">æˆ‘ä¸ºä»€ä¹ˆè¿˜æ˜¯æœ‰ç‚¹ä¸çˆ½</h2>
<p>ä¸çˆ½çš„ç‚¹å¾ˆç®€å•ï¼šä½ æ˜æ˜çŸ¥é“è¿™äº‹ä¸éš¾ï¼Œä½†ä½ ä¹ŸçŸ¥é“â€œåˆ«äººæ›´æ„¿æ„å¬ Google çš„â€ã€‚</p>
<p>æ‰¿è®¤è¿™ç‚¹å…¶å®æŒºè§£è„±çš„ã€‚å› ä¸ºä½ ä¸éœ€è¦å†ç”¨æƒ…ç»ªå¯¹æŠ—ç°å®ï¼Œä½ å¯ä»¥æŠŠæƒ…ç»ªå˜æˆç­–ç•¥ï¼š</p>
<ul>
<li>æ—¢ç„¶åè®®è¢«è®¤å¯ï¼Œé‚£å°±å€ŸåŠ¿ï¼›</li>
<li>æ—¢ç„¶ä½ ä¸å–œæ¬¢ Materialï¼Œé‚£å°±æŠŠæ¸²æŸ“å±‚æ¢æˆä½ å–œæ¬¢çš„è®¾è®¡ç³»ç»Ÿï¼›</li>
<li>æ—¢ç„¶ä½ æ—©å°±æƒ³è¿‡ï¼Œé‚£ä½ æ›´åº”è¯¥æŠŠå®ƒåšå¾—æ›´â€œå®ç”¨â€ï¼Œè€Œä¸æ˜¯æ›´â€œå®å¤§â€ã€‚</li>
</ul>
<p>è®²ç™½äº†ï¼šå¤§å‚æä¾›å…±è¯†ï¼Œä½ æä¾›ä½“éªŒå’Œå·¥ç¨‹ç»†èŠ‚ã€‚</p>
<hr/>
<h2 data-id="heading-8">ç»™ä½ ä¸€ä¸ªå¾ˆç°å®çš„è½åœ°è·¯çº¿</h2>
<p>å¦‚æœä½ çœŸæƒ³æŠŠè¿™å¥—ä¸œè¥¿ç”¨èµ·æ¥ï¼Œè€Œä¸”ä¸æƒ³é™·å…¥â€œå¤§å·¥ç¨‹ç„¦è™‘â€ï¼Œå¯ä»¥æŒ‰è¿™ä¸ªé¡ºåºï¼š</p>
<ul>
<li>å…ˆåšä¸€ä¸ªæå°çš„ catalogï¼ˆ5ï½10 ä¸ªç»„ä»¶ï¼‰ï¼ŒæŠŠç«¯åˆ°ç«¯è·‘é€šï¼šæè¿° â†’ æ¸²æŸ“ â†’ äº‹ä»¶å›ä¼  â†’ UI æ›´æ–°ã€‚</li>
<li>props ä¸€å¼€å§‹å°±æ”¶ç´§ï¼Œå°¤å…¶æ˜¯ä»»ä½•å¯èƒ½æ³¨å…¥å¯Œæ–‡æœ¬/HTML çš„å­—æ®µï¼Œåˆ«è´ªæ–¹ä¾¿ã€‚</li>
<li>ä¼˜å…ˆæ”¯æŒâ€œå¢é‡æ›´æ–°â€ï¼Œåˆ«æ¯æ¬¡å…¨é‡é‡ç»˜ï¼›ä¸ç„¶å¯¹è¯ä¸€é•¿ UI æŠ–å¾—åƒæŠ½é£ã€‚</li>
<li>æ—©ä¸€ç‚¹å¼•å…¥â€œåœºæ™¯ç»„ä»¶â€ï¼ŒæŠŠä¸€è‡´æ€§ã€æ ¡éªŒã€åŸ‹ç‚¹å°è£…è¿›å»ï¼›è¿™ä¸€æ­¥åšå®Œï¼Œä½ ä¼šçªç„¶æ„Ÿè§‰ç³»ç»Ÿå˜ç¨³äº†ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Goè¯­è¨€åŠ¨æ‰‹å†™Webæ¡†æ¶ - Geeç¬¬ä¸€å¤©]]></title>    <link>https://juejin.cn/post/7585222924565921832</link>    <guid>https://juejin.cn/post/7585222924565921832</guid>    <pubDate>2025-12-19T07:53:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585222924565921832" data-draft-id="7585130590292705295" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Goè¯­è¨€åŠ¨æ‰‹å†™Webæ¡†æ¶ - Geeç¬¬ä¸€å¤©"/> <meta itemprop="keywords" content="Go"/> <meta itemprop="datePublished" content="2025-12-19T07:53:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Way2top"/> <meta itemprop="url" content="https://juejin.cn/user/1458388314893300"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Goè¯­è¨€åŠ¨æ‰‹å†™Webæ¡†æ¶ - Geeç¬¬ä¸€å¤©
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1458388314893300/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Way2top
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T07:53:16.000Z" title="Fri Dec 19 2025 07:53:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å†™åœ¨å‰é¢ï¼šæœ¬é¡¹ç›®å‚è€ƒ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgeektutu.com%2Fpost%2Fgee.html" target="_blank" title="https://geektutu.com/post/gee.html" ref="nofollow noopener noreferrer">7å¤©ç”¨Goä»é›¶å®ç°Webæ¡†æ¶Geeæ•™ç¨‹</a>ï¼Œä¸‹é¢çš„å†…å®¹å…¨éƒ¨æ¥è‡ªäºè¯¥ç½‘ç«™å†…å®¹ã€‚ä¸»è¦æ˜¯è®°å½•æˆ‘åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­çš„æ‰€æ€æ‰€æƒ³ï¼Œå¦‚æœ‰å­˜åœ¨é—®é¢˜è¿˜è¯·å¤šå¤šæŒ‡æ•™ã€‚</p>
<h3 data-id="heading-0">Day1</h3>
<h4 data-id="heading-1">æ ‡å‡†åº“å¯åŠ¨ Web æœåŠ¡</h4>
<p>Go å†…ç½®äº† <code>net/http</code> åº“ï¼Œå°è£…äº†HTTPç½‘ç»œç¼–ç¨‹çš„åŸºç¡€çš„æ¥å£ï¼Œæˆ‘ä»¬å®ç°çš„<code>Gee</code> Web æ¡†æ¶ä¾¿æ˜¯åŸºäº<code>net/http</code>çš„ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œç®€å•ä»‹ç»ä¸‹è¿™ä¸ªåº“çš„ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
        <span class="hljs-string">"fmt"</span>
        <span class="hljs-string">"log"</span>
        <span class="hljs-string">"net/http"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
        http.HandleFunc(<span class="hljs-string">"/"</span>, indexHandler)
        http.HandleFunc(<span class="hljs-string">"/hello"</span>, helloHandler)
        log.Fatal(http.ListenAndServe(<span class="hljs-string">":9999"</span>, <span class="hljs-literal">nil</span>))
}

<span class="hljs-comment">// handler echoes r.URL.Path</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">indexHandler</span><span class="hljs-params">(w http.ResponseWriter, req *http.Request)</span></span> {
        fmt.Fprintf(w, <span class="hljs-string">"URL.Path = %q\n"</span>, req.URL.Path)
        <span class="hljs-comment">// ç­‰ä»·äº</span>
        <span class="hljs-comment">// data := []byte(`URL.Path = "/"\n`)</span>
        <span class="hljs-comment">// w.Write(data)</span>
}

<span class="hljs-comment">// handler echoes r.URL.Header</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">helloHandler</span><span class="hljs-params">(w http.ResponseWriter, req *http.Request)</span></span> {
        <span class="hljs-keyword">for</span> k, v := <span class="hljs-keyword">range</span> req.Header {
                fmt.Fprintf(w, <span class="hljs-string">"Header[%q] = %q\n"</span>, k, v)
        }
}
</code></pre>
<p><code>http.HandleFunc</code> çš„ä½œç”¨æ˜¯æ³¨å†Œè·¯ç”±+æ³¨å†Œå¤„ç†å‡½æ•°ï¼Œè¿™é‡Œç®€å•æ¥è¯´å°±æ˜¯ï¼š</p>
<ul>
<li>
<p>å½“è¯·æ±‚å‘½ä¸­ <code>/</code> çš„æ—¶å€™æ‰§è¡Œ<code>indexHandler</code></p>
</li>
<li>
<p>å½“è¯·æ±‚å‘½ä¸­ <code>/hello</code> çš„æ—¶å€™æ‰§è¡Œ <code>helloHandler</code></p>
</li>
</ul>
<p>å¯¹äºæ³¨å†Œçš„å¤„ç†å‡½æ•°ï¼ˆè¿™é‡Œå°±æ˜¯ <code>indexHandler</code> å’Œ <code>helloHandler</code>ï¼‰ä¹Ÿæ˜¯æœ‰è¦æ±‚çš„ï¼Œå®ƒçš„ç­¾åå¿…é¡»æ˜¯ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span>
</code></pre>
<p>å¦åˆ™ç¼–è¯‘éƒ½è¿‡ä¸äº†ã€‚</p>
<p>ç¨‹åºè¿è¡Œåï¼Œç»ˆç«¯è¾“å…¥å‘½ä»¤æœ‰å¦‚ä¸‹ç»“æœï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">coding</span>/<span class="hljs-selector-tag">GoProject</span>/<span class="hljs-selector-tag">Gee</span> <span class="hljs-selector-tag">via</span> î˜§ <span class="hljs-selector-tag">v1</span><span class="hljs-selector-class">.24</span><span class="hljs-selector-class">.3</span> 
â¯ <span class="hljs-selector-tag">curl</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//localhost:9999/</span>
<span class="hljs-selector-tag">URL</span><span class="hljs-selector-class">.Path</span> = "/"

<span class="hljs-selector-tag">coding</span>/<span class="hljs-selector-tag">GoProject</span>/<span class="hljs-selector-tag">Gee</span> <span class="hljs-selector-tag">via</span> î˜§ <span class="hljs-selector-tag">v1</span><span class="hljs-selector-class">.24</span><span class="hljs-selector-class">.3</span> 
â¯ <span class="hljs-selector-tag">curl</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//localhost:9999/hello</span>
<span class="hljs-selector-tag">Header</span><span class="hljs-selector-attr">[<span class="hljs-string">"Accept"</span>]</span> = <span class="hljs-selector-attr">[<span class="hljs-string">"*/*"</span>]</span>
<span class="hljs-selector-tag">Header</span><span class="hljs-selector-attr">[<span class="hljs-string">"User-Agent"</span>]</span> = <span class="hljs-selector-attr">[<span class="hljs-string">"curl/8.7.1"</span>]</span>
</code></pre>
<p>æˆ‘ä»¬ç°åœ¨å°±æ¥åˆ†æä¸€ä¸‹ï¼Œä» <code> curl  ``http://localhost:9999/</code> åˆ° <code>URL.Path = "/"</code> çš„å®Œæ•´æµç¨‹ã€‚</p>
<p>å½“ç”¨æˆ·è¾“å…¥ <code> curl  ``http://localhost:9999/</code> çš„æ—¶å€™ï¼Œç¨‹åºç›‘å¬åˆ°äº†è¿™ä¸ªè¯·æ±‚ï¼Œå‘ç°è¯·æ±‚è·¯å¾„ä¸º <code>/</code>ï¼Œäºæ˜¯è§¦å‘ä¸ <code>/</code> ç»‘å®šçš„å¤„ç†å‡½æ•° <code>indexHandler</code>ã€‚</p>
<p>æˆ‘ä»¬å‘ç°è¿™ä¸ª <code>indexHandler</code> åŒ…å«ä¸¤ä¸ªä¼ å‚ <code>w</code> å’Œ <code>r</code>ï¼Œä½†å®é™…ä¸Šè¿™ä¸¤ä¸ªä¼ å‚å®Œå…¨ä¸éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ“ä½œæˆ–è€…åœ¨æŸä¸ªåœ°æ–¹æ‰‹åŠ¨ä¼ å…¥ã€‚å½“æ”¶åˆ°è¯·æ±‚æŠ¥æ–‡çš„æ—¶å€™ï¼Œ<code>net/http</code> ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬è§£æè¯·æ±‚æŠ¥æ–‡ï¼Œå¹¶ä»ä¸­è§£æå‡º <code>w http.ResponseWriter</code> å’Œ <code>req *http.Request</code> è¿™ä¸¤ä¸ªå‚æ•°ï¼Œç„¶åè‡ªåŠ¨ä¼ å…¥ <code>indexHandler</code> ä¸­ã€‚äºæ˜¯æ¥ä¸‹æ¥å°±ç›´æ¥èµ°åˆ°äº†å‡½æ•°å†…éƒ¨çš„ <code>fmt.Fprintf(w, "URL.Path = %q\n", req.URL.Path)</code> ä¸­äº†ã€‚</p>
<p>åœ¨è®²æ¥ä¸‹æ¥çš„æ•°æ®æµå‘ä¹‹å‰ï¼Œæœ‰å¿…è¦è®²æ¸…æ¥š <code>http.ResponseWriter</code> ä»¥åŠ <code>fmt.Fprintf</code>ã€‚é¦–å…ˆï¼Œ<code>http.ResponseWriter</code> æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæ¥å£ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">type</span> ResponseWriter <span class="hljs-keyword">interface</span> {
        Header() Header
        Write([]<span class="hljs-type">byte</span>) (<span class="hljs-type">int</span>, <span class="hljs-type">error</span>)
        WriteHeader(statusCode <span class="hljs-type">int</span>)
}
</code></pre>
<p>é€šè¿‡ <code>net/http</code> è§£æå‡ºæ¥çš„ <code>w</code> ä¼ å‚å°±æ˜¯ä¸€ä¸ªå®ç°äº† <code>ResponseWriter</code> æ¥å£çš„å¯¹è±¡ã€‚<code>w</code> åœ¨æºç å±‚é¢æ˜¯ä¸€ä¸ªæ¥å£ç±»å‹å˜é‡ï¼Œä½†è¿è¡Œæ—¶å®ƒæŒæœ‰çš„æ˜¯ä¸€ä¸ªå®ç°äº† <code>ResponseWriter</code> æ¥å£çš„å…·ä½“ç»“æ„ä½“å®ä¾‹ã€‚</p>
<p><strong>w ä¸æ˜¯æŠ½è±¡çš„â€œæ¥å£å¯¹è±¡â€ï¼Œå®ƒæ˜¯ä¸€ä¸ªå…·ä½“ç»“æ„ä½“ç¤ºä¾‹ã€‚</strong> åœ¨æ ‡å‡†åº“é‡Œå¤§æ¦‚æ˜¯è¿™ç§ç»“æ„ï¼ˆç®€åŒ–ä»£ç ï¼‰ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">type</span> response <span class="hljs-keyword">struct</span> {
    conn    *conn          <span class="hljs-comment">// TCP è¿æ¥</span>
    buf     *bufio.Writer  <span class="hljs-comment">// å†™ç¼“å†²</span>
    header  Header
    status  <span class="hljs-type">int</span>
}
</code></pre>
<p>é‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´ï¼Œä¼ å…¥ <code>indexHandler</code> çš„å‚æ•° <code>w</code> å®ç°äº† <code>Write</code> æ–¹æ³•ã€‚</p>
<p>æ¥ä¸‹æ¥çœ‹åˆ° <code>fmt.Fprintf</code>ã€‚æˆ‘ä»¬æ¥çœ‹ <code>fmt.Fprintf</code> çš„å®šä¹‰ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Fprintf</span><span class="hljs-params">(w io.Writer, format <span class="hljs-type">string</span>, a ...any)</span></span> (n <span class="hljs-type">int</span>, err <span class="hljs-type">error</span>)
</code></pre>
<p>è¿™é‡Œï¼Œåªè¦ <code>w</code> å®ç°äº† <code>io.Writer</code>ï¼Œé‚£ä¹ˆ <code>Fprintf</code> å†…éƒ¨å°±ä¼šè°ƒç”¨ <code>w.Write</code>ã€‚è€Œ <code>http.ResponseWriter</code> <strong>å®ç°äº†</strong> <strong><code>io.Writer</code></strong> <strong>ï¼Œ</strong> æ‰€ä»¥ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">fmt.<span class="hljs-built_in">Fprintf</span>(w, <span class="hljs-string">"hello"</span>)
</code></pre>
<p>å®é™…æ‰§è¡Œçš„æ˜¯ï¼š</p>
<pre><code class="hljs language-lua" lang="lua">w.Write([]<span class="hljs-built_in">byte</span>(<span class="hljs-string">"hello"</span>)) // è‡³äºä¸ºä»€ä¹ˆæ˜¯ []<span class="hljs-built_in">byte</span>(<span class="hljs-string">"hello"</span>) è€Œä¸æ˜¯ <span class="hljs-string">"hello"</span>ï¼Œæ˜¯å› ä¸ºå®é™…ä¸Šåœ¨ Write ä¹‹å‰è¿˜æœ‰ä¸€ä¸ªæ ¼å¼åŒ–çš„æ­¥éª¤ï¼Œå…·ä½“å¯ä»¥å»çœ‹çœ‹ Fprintf çš„æºç 
</code></pre>
<p>åˆ°è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥çœ‹æ‡‚ç¤ºä¾‹ä»£ç ä¸­çš„è¿™å¥äº†ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">fmt.Fprintf(w, <span class="hljs-string">"URL.Path = %q\n"</span>, req.URL.Path)
</code></pre>
<p>å®ƒç­‰ä»·äºï¼š</p>
<pre><code class="hljs language-ini" lang="ini">data := <span class="hljs-section">[]</span>byte(`<span class="hljs-attr">URL.Path</span> = <span class="hljs-string">"/"</span>\n`)
w.Write(data)
</code></pre>
<p>è¿™é‡Œä¹‹å‰è¿˜éœ€è¦ç®€å•è¯´ä¸€ä¸‹ reqï¼Œä½ å¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œé€šè¿‡ req å°±å¯ä»¥æ‹¿åˆ°è¯·æ±‚æŠ¥æ–‡ä¸­çš„æ‰€æœ‰ä¸œè¥¿ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">req<span class="hljs-selector-class">.Method</span>        <span class="hljs-comment">// "GET"</span>
req<span class="hljs-selector-class">.URL</span><span class="hljs-selector-class">.Path</span>      <span class="hljs-comment">// "/hello"</span>
req<span class="hljs-selector-class">.URL</span><span class="hljs-selector-class">.RawQuery</span>  <span class="hljs-comment">// "name=ryan"</span>
req<span class="hljs-selector-class">.Proto</span>         <span class="hljs-comment">// "HTTP/1.1"</span>
req<span class="hljs-selector-class">.URL</span><span class="hljs-selector-class">.Query</span>()<span class="hljs-selector-class">.Get</span>("name")
req<span class="hljs-selector-class">.URL</span><span class="hljs-selector-class">.Query</span>()<span class="hljs-selector-attr">[<span class="hljs-string">"name"</span>]</span>
</code></pre>
<p>æ‰€ä»¥è¿™é‡Œæ˜¯æŠŠè¯·æ±‚æŠ¥æ–‡ä¸­çš„è¯·æ±‚è·¯å¾„æ‹¿è¿‡æ¥åšäº†ä¸€ä¸ªæ‹¼æ¥ï¼Œç„¶åä½œä¸º <code>x.Write</code> çš„ä¼ å‚å†™å…¥ã€‚</p>
<hr/>
<p>è‡³æ­¤æˆ‘ä»¬å·²ç»æ‹æ¸…æ¥šäº†ä»è¯·æ±‚æŠ¥æ–‡å‘è¿‡æ¥ä¸€ç›´åˆ°å°†å…¶ä¸­çš„è¯·æ±‚è·¯å¾„ä½œä¸º <code>x.Write</code> ä¼ å‚å†™å…¥çš„è¿‡ç¨‹äº†ï¼Œæ¥ä¸‹æ¥çš„é—®é¢˜å°±æ˜¯ï¼Œ<code>x.Write</code> æ˜¯å•¥ï¼Ÿå®ƒå†™å…¥åˆ°äº†å“ªé‡Œï¼Ÿå†™å®Œä¹‹åæˆ‘åˆæ˜¯æ€ä¹ˆåœ¨ç»ˆç«¯çœ‹åˆ°æœ€ç»ˆç»“æœçš„å‘¢ï¼Ÿ</p>
<p>å…·ä½“æ¥è¯´ï¼š</p>
<ul>
<li>
<p><code>w</code> æ˜¯ <code>net/http</code> å†…éƒ¨çš„ response å¯¹è±¡</p>
</li>
<li>
<p><code>Write</code> æŠŠå­—èŠ‚å†™å…¥ <strong>HTTP å“åº”ç¼“å†²åŒº</strong></p>
</li>
<li>
<p>handler è¿”å›å</p>
</li>
<li>
<p><code>net/http</code> æŠŠè¿™äº›å­—èŠ‚é€šè¿‡ TCP å‘ç»™æµè§ˆå™¨</p>
</li>
</ul>
<h4 data-id="heading-2"><code>http.Handler</code> æ¥å£</h4>
<p>ç°åœ¨æˆ‘ä»¬å›å¤´çœ‹çœ‹ä¸€å¼€å§‹çš„ç¤ºä¾‹ä»£ç ï¼Œå°±åº”è¯¥å¾ˆæ¸…æ™°äº†ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
        <span class="hljs-string">"fmt"</span>
        <span class="hljs-string">"log"</span>
        <span class="hljs-string">"net/http"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
        http.HandleFunc(<span class="hljs-string">"/"</span>, indexHandler)
        http.HandleFunc(<span class="hljs-string">"/hello"</span>, helloHandler)
        log.Fatal(http.ListenAndServe(<span class="hljs-string">":9999"</span>, <span class="hljs-literal">nil</span>))
}

<span class="hljs-comment">// handler echoes r.URL.Path</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">indexHandler</span><span class="hljs-params">(w http.ResponseWriter, req *http.Request)</span></span> {
        fmt.Fprintf(w, <span class="hljs-string">"URL.Path = %q\n"</span>, req.URL.Path)
        <span class="hljs-comment">// ç­‰ä»·äº</span>
        <span class="hljs-comment">// data := []byte(`URL.Path = "/"\n`)</span>
        <span class="hljs-comment">// w.Write(data)</span>
}

<span class="hljs-comment">// handler echoes r.URL.Header</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">helloHandler</span><span class="hljs-params">(w http.ResponseWriter, req *http.Request)</span></span> {
        <span class="hljs-keyword">for</span> k, v := <span class="hljs-keyword">range</span> req.Header {
                fmt.Fprintf(w, <span class="hljs-string">"Header[%q] = %q\n"</span>, k, v)
        }
}
</code></pre>
<p>åœ¨ç¤ºä¾‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ http.HandleFunc æ³¨å†Œäº†ä¸¤ä¸ªå‡½æ•°ï¼š</p>
<ul>
<li>
<p>"/" è·¯å¾„å¯¹åº” indexHandler</p>
</li>
<li>
<p>"/hello" è·¯å¾„å¯¹åº” helloHandler</p>
</li>
</ul>
<p>å½“æµè§ˆå™¨æˆ– curl å‘èµ·è¯·æ±‚æ—¶ï¼Œnet/http ä¼šè‡ªåŠ¨è°ƒç”¨æˆ‘ä»¬æ³¨å†Œçš„å‡½æ•°ï¼Œå¹¶å°†è¯·æ±‚ä¿¡æ¯å°è£…æˆ reqï¼Œå“åº”çš„å†™å…¥å™¨å°è£…æˆ wï¼Œä¼ å…¥å‡½æ•°å†…éƒ¨ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸€ä¸ªè¯·æ±‚éƒ½ä¼šè¢«è‡ªåŠ¨äº¤ç»™ä¸€ä¸ªâ€œå¤„ç†å•å…ƒâ€æ¥å¤„ç†ï¼Œæˆ‘ä»¬ä¸éœ€è¦è‡ªå·±å»è§£ææŠ¥æ–‡ã€ç®¡ç† TCP è¿æ¥æˆ–æ„é€ å“åº”ã€‚</p>
<p><strong>è¿™ç§æŠŠè¯·æ±‚å’Œå¤„ç†é€»è¾‘ç»‘å®šèµ·æ¥ï¼Œå¹¶ç”±æ¡†æ¶è´Ÿè´£è°ƒç”¨çš„æœºåˆ¶ï¼Œå°±æ˜¯ Go è¯­è¨€ä¸­æ‰€è°“çš„ handler æ¨¡å‹ã€‚</strong></p>
<p>å®˜æ–¹å®šä¹‰ä¸Šï¼Œhandler æ˜¯ä¸€ä¸ªæ¥å£ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">type</span> Handler <span class="hljs-keyword">interface</span> {
    ServeHTTP(w http.ResponseWriter, r *http.Request)
}
</code></pre>
<p>ä»»ä½•å®ç°äº† ServeHTTP æ–¹æ³•çš„å¯¹è±¡ï¼Œéƒ½æ˜¯ä¸€ä¸ª handlerã€‚æˆ‘ä»¬æ³¨å†Œçš„å‡½æ•°å…¶å®æ˜¯é€šè¿‡ http.HandlerFunc é€‚é…å™¨è¢«è‡ªåŠ¨åŒ…è£…æˆäº† Handlerï¼Œä»è€Œå¯ä»¥è¢« net/http è°ƒç”¨ã€‚</p>
<p>è¿™é‡Œä½ å¯èƒ½æœ‰ä¸€ä¸ªç–‘é—®ï¼Œå‡½æ•°æ€ä¹ˆå¯ä»¥å®ç°ä¸€ä¸ªæ¥å£å‘¢ï¼Ÿä¸éƒ½æ˜¯ç»“æ„ä½“å®ç°æ¥å£å—ï¼Ÿè¿™æ˜¯æ€ä¹ˆé€‚é…çš„ï¼Ÿ</p>
<p>å®é™…ä¸Šï¼ŒGO å…è®¸ä½ ä¸ºè‡ªå®šä¹‰ç±»å‹æ·»åŠ æ–¹æ³•ï¼Œä¸ç®¡è¿™ä¸ªç±»å‹æ˜¯ç»“æ„ä½“ã€å†…ç½®ç±»å‹è¿˜æ˜¯å‡½æ•°ç±»å‹ã€‚</p>
<p>åœ¨æ ‡å‡†åº“ä¸­å°±å®šä¹‰äº†ä¸€ä¸ªç±»å‹ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">type</span> HandlerFunc <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(http.ResponseWriter, *http.Request)</span></span>
</code></pre>
<p>ç„¶åç»™ä»–æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">func (f HandlerFunc) <span class="hljs-built_in">ServeHTTP</span>(w http.ResponseWriter, r *http.Request) {
    <span class="hljs-built_in">f</span>(w, r)
}
</code></pre>
<p>æ‰€ä»¥ <strong>å‡½æ•°ç±»å‹ä¹Ÿå®ç°äº†</strong> <strong><code>http.Handler</code></strong> <strong>æ¥å£</strong>ã€‚</p>
<p>æ€»ç»“æ¥è¯´ï¼š</p>
<ul>
<li>handler æ˜¯å¤„ç†å•ä¸ª HTTP è¯·æ±‚çš„é€»è¾‘å•å…ƒ</li>
<li>å¯ä»¥æ˜¯å‡½æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯å®ç° ServeHTTP çš„ç»“æ„ä½“</li>
<li>å®ƒè®©æˆ‘ä»¬åªéœ€å…³æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œä¸å¿…å…³å¿ƒåº•å±‚ç½‘ç»œå’ŒæŠ¥æ–‡å¤„ç†</li>
</ul>
<hr/>
<h4 data-id="heading-3">æ‰‹åŠ¨å®ç° <code>Engine</code> ç»Ÿä¸€å¤„ç†è¯·æ±‚</h4>
<p>ç¤ºä¾‹ä»£ç çš„æœ€åä¸€è¡Œæ˜¯ç”¨æ¥å¯åŠ¨ Web æœåŠ¡çš„ï¼š</p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-built_in">log</span>.Fatal(http.ListenAndServe(<span class="hljs-string">":9999"</span>, <span class="hljs-literal">nil</span>))
</code></pre>
<p>é€šè¿‡æŸ¥çœ‹æºç å¯ä»¥çŸ¥é“ï¼Œ<code>ListenAndServe</code> çš„ç¬¬äºŒä¸ªä¼ å‚æ˜¯ä¸€ä¸ª Handler ç±»å‹ï¼Œé»˜è®¤ä¸ºç©ºï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ListenAndServe</span><span class="hljs-params">(addr <span class="hljs-type">string</span>, handler Handler)</span></span> <span class="hljs-type">error</span> {
        server := &amp;Server{Addr: addr, Handler: handler}
        <span class="hljs-keyword">return</span> server.ListenAndServe()
}
</code></pre>
<p>å‰é¢æˆ‘ä»¬å·²ç»ä»‹ç»è¿‡äº† Handler ç±»å‹ï¼Œå¦‚æœ ListenAndServe ä¸ä¼ å…¥ Handler ç±»å‹å‚æ•°ï¼Œé‚£ä¹ˆä½¿ç”¨å…¨å±€é»˜è®¤çš„è·¯ç”±æ˜ å°„è¡¨å¤„ç†è¯·æ±‚ï¼ˆ<code>http.DefaultServeMux</code>ï¼‰ï¼Œå¦‚æœæˆ‘ä»¬ä¼ å…¥äº†å‚æ•°ï¼Œé‚£ä¹ˆå°±æŒ‰ç…§æˆ‘ä»¬è‡ªå·±ä¼ å…¥çš„ Handler ç±»å‹æ¥å¤„ç† HTTP è¯·æ±‚ï¼Œæ›´å‡†ç¡®çš„è¯´ï¼Œæ˜¯æ ¹æ®æˆ‘ä»¬ä¼ å…¥çš„ Handler ç±»å‹çš„ ServeHTTP æ–¹æ³•æ¥å¤„ç† HTTP è¯·æ±‚ã€‚</p>
<p>è¿™ä¸€å°èŠ‚æˆ‘ä»¬å°±æ¥è‡ªå·±æ„å»ºä¸€ä¸ªå®ç°äº† Handler æ¥å£çš„ç»“æ„ä½“ <code>Engine</code>ã€‚</p>
<p>å…·ä½“ä»£ç å®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
        <span class="hljs-string">"fmt"</span>
        <span class="hljs-string">"log"</span>
        <span class="hljs-string">"net/http"</span>
)

<span class="hljs-comment">// Engine is the uni handler for all requests</span>
<span class="hljs-keyword">type</span> Engine <span class="hljs-keyword">struct</span>{}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(engine *Engine)</span></span> ServeHTTP(w http.ResponseWriter, req *http.Request) {
        <span class="hljs-keyword">switch</span> req.URL.Path {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"/"</span>:
                fmt.Fprintf(w, <span class="hljs-string">"URL.Path = %q\n"</span>, req.URL.Path)
        <span class="hljs-keyword">case</span> <span class="hljs-string">"/hello"</span>:
                <span class="hljs-keyword">for</span> k, v := <span class="hljs-keyword">range</span> req.Header {
                        fmt.Fprintf(w, <span class="hljs-string">"Header[%q] = %q\n"</span>, k, v)
                }
        <span class="hljs-keyword">default</span>:
                fmt.Fprintf(w, <span class="hljs-string">"404 NOT FOUND: %s\n"</span>, req.URL)
        }
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
        engine := <span class="hljs-built_in">new</span>(Engine)
        log.Fatal(http.ListenAndServe(<span class="hljs-string">":9999"</span>, engine))
}
</code></pre>
<p>é¦–å…ˆæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª <code>Engine</code> ç±»å‹çš„ç»“æ„ä½“ã€‚è¿™é‡Œè§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆæ˜¯ä¸€ä¸ªç©ºçš„ç»“æ„ä½“ï¼šå› ä¸ºæˆ‘ä»¬å¹¶ä¸éœ€è¦è¯¥ç»“æ„ä½“æ¥å­˜å‚¨ä»»ä½•æ•°æ®ï¼Œæˆ‘ä»¬åªæ˜¯å¸Œæœ›æ„å»ºä¸€ä¸ªå®ç°äº† Handler æ¥å£çš„ï¼ˆä¹Ÿå°±æ˜¯å®ç°äº† ServeHTTP æ–¹æ³•ï¼‰çš„ç»“æ„ä½“ï¼Œé‚£ä¹ˆä½¿ç”¨ç©ºç»“æ„ä½“æ¥å®ç°å°±æ˜¯ä¸€ç§å¾ˆåˆé€‚çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¸Œæœ› <code>Engine</code> åªæ˜¯ä¸€ç§â€œè¡Œä¸ºæ‰¿è½½ä½“â€ï¼Œæ–¹æ³•é›†å°±æ˜¯å®ƒçš„å­˜åœ¨æ„ä¹‰ã€‚å¦å¤–ï¼ŒGo ä¸­çš„ç©ºç»“æ„ä½“è¿˜ä¸ä¼šå ç”¨ä»»ä½•å†…å­˜ã€‚</p>
<p>å½“ç„¶ï¼Œè¿™é‡Œåªæ˜¯ç®€å•å®ç° ServeHTTP æ–¹æ³•ï¼Œåç»­ç‰ˆæœ¬ä¸­æˆ‘ä»¬ä¼šæ…¢æ…¢å®Œå–„ <code>Engine</code>ï¼Œåˆ°åé¢ <code>Engine</code> å°±ä¸å†æ˜¯ç©ºç»“æ„ä½“äº†ï¼Œè¿˜éœ€è¦åŒ…å«ä¸€äº›æ•°æ®ç±»å‹ç”¨äºå­˜å‚¨ã€‚åªæ˜¯åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œä½¿ç”¨ç©ºç»“æ„ä½“æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p>
<p>ç»§ç»­å¾€ä¸‹èµ°ï¼Œå°±åˆ°äº†å…·ä½“å®ç° ServeHTTP çš„éƒ¨åˆ†äº†ã€‚æ˜¾ç„¶ï¼Œä¸¤ä¸ªä¼ å‚æ˜¯å¿…è¦çš„ï¼ˆå› ä¸º Handler ä¸­çš„ ServeHTTP å°±éœ€è¦è¿™ä¸¤ä¸ªç±»å‹çš„ä¼ å‚ï¼‰ã€‚</p>
<p>æ¥ç€æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ <code>switch</code> å¯¹ è¯·æ±‚çš„åœ°å€ï¼ˆ<code>req.URL.Path</code>ï¼‰è¿›è¡Œåˆ¤æ–­ï¼š</p>
<ul>
<li>
<p>å¦‚æœæ˜¯ "/"ï¼Œæ‰“å° <code>req.URL.Path</code></p>
</li>
<li>
<p>å¦‚æœæ˜¯ "/hello"ï¼Œæ‰“å° <code>req.Header</code></p>
</li>
<li>
<p>å¦‚æœéƒ½ä¸æ˜¯ï¼Œæ‰“å° <code>"404 NOT FOUND: %s\n"</code></p>
</li>
</ul>
<p>é‚£ä¹ˆä½ ä¼šå‘ç°ï¼Œæˆ‘ä»¬æŠŠå¯¹äºä¸åŒè·¯ç”±çš„å¤„ç†ï¼Œå†™åˆ°äº†æˆ‘ä»¬è‡ªå®šä¹‰çš„å®ç°äº† Handler æ¥å£çš„ <code>Engine</code> ç»“æ„ä½“ä¸­ã€‚è¿è¡Œè¿™ä¸ªå‡½æ•°ä¹‹åï¼Œåœ¨ç»ˆç«¯è¾“å…¥å‘½ä»¤ï¼ŒåŒæ ·ä¼šå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">coding</span>/<span class="hljs-selector-tag">GoProject</span>/<span class="hljs-selector-tag">Gee</span> <span class="hljs-selector-tag">via</span> î˜§ <span class="hljs-selector-tag">v1</span><span class="hljs-selector-class">.24</span><span class="hljs-selector-class">.3</span> 
â¯ <span class="hljs-selector-tag">curl</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//localhost:9999/     </span>
<span class="hljs-selector-tag">URL</span><span class="hljs-selector-class">.Path</span> = "/"

<span class="hljs-selector-tag">coding</span>/<span class="hljs-selector-tag">GoProject</span>/<span class="hljs-selector-tag">Gee</span> <span class="hljs-selector-tag">via</span> î˜§ <span class="hljs-selector-tag">v1</span><span class="hljs-selector-class">.24</span><span class="hljs-selector-class">.3</span> 
â¯ <span class="hljs-selector-tag">curl</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//localhost:9999/hello</span>
<span class="hljs-selector-tag">Header</span><span class="hljs-selector-attr">[<span class="hljs-string">"User-Agent"</span>]</span> = <span class="hljs-selector-attr">[<span class="hljs-string">"curl/8.7.1"</span>]</span>
<span class="hljs-selector-tag">Header</span><span class="hljs-selector-attr">[<span class="hljs-string">"Accept"</span>]</span> = <span class="hljs-selector-attr">[<span class="hljs-string">"*/*"</span>]</span>

<span class="hljs-selector-tag">coding</span>/<span class="hljs-selector-tag">GoProject</span>/<span class="hljs-selector-tag">Gee</span> <span class="hljs-selector-tag">via</span> î˜§ <span class="hljs-selector-tag">v1</span><span class="hljs-selector-class">.24</span><span class="hljs-selector-class">.3</span> 
â¯ <span class="hljs-selector-tag">curl</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//localhost:9999/world</span>
<span class="hljs-number">404</span> <span class="hljs-selector-tag">NOT</span> <span class="hljs-selector-tag">FOUND</span>: /<span class="hljs-selector-tag">world</span>
</code></pre>
<blockquote>
<p>åœ¨ <code>main</code> å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ç»™ <code>ListenAndServe</code> æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥äº†åˆšæ‰åˆ›å»ºçš„<code>engine</code>å®ä¾‹ã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬èµ°å‡ºäº†å®ç°Webæ¡†æ¶çš„ç¬¬ä¸€æ­¥ï¼Œå³ï¼Œå°†æ‰€æœ‰çš„HTTPè¯·æ±‚è½¬å‘äº†æˆ‘ä»¬è‡ªå·±çš„å¤„ç†é€»è¾‘ã€‚è¿˜è®°å¾—å—ï¼Œåœ¨å®ç°<code>Engine</code>ä¹‹å‰ï¼Œæˆ‘ä»¬è°ƒç”¨ <em>http.HandleFunc</em> å®ç°äº†è·¯ç”±å’ŒHandlerçš„æ˜ å°„ï¼Œä¹Ÿå°±æ˜¯åªèƒ½é’ˆå¯¹å…·ä½“çš„è·¯ç”±å†™å¤„ç†é€»è¾‘ã€‚æ¯”å¦‚<code>/hello</code>ã€‚ä½†æ˜¯åœ¨å®ç°<code>Engine</code>ä¹‹åï¼Œæˆ‘ä»¬æ‹¦æˆªäº†æ‰€æœ‰çš„HTTPè¯·æ±‚ï¼Œæ‹¥æœ‰äº†ç»Ÿä¸€çš„æ§åˆ¶å…¥å£ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥è‡ªç”±å®šä¹‰è·¯ç”±æ˜ å°„çš„è§„åˆ™ï¼Œä¹Ÿå¯ä»¥ç»Ÿä¸€æ·»åŠ ä¸€äº›å¤„ç†é€»è¾‘ï¼Œä¾‹å¦‚æ—¥å¿—ã€å¼‚å¸¸å¤„ç†ç­‰ã€‚</p>
<p>ä»£ç çš„è¿è¡Œç»“æœä¸ä¹‹å‰çš„æ˜¯ä¸€è‡´çš„ã€‚</p>
</blockquote>
<p>è¿™é‡Œæœ‰å¿…è¦è§£é‡Šä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆè¯´è¿™ç®—æ˜¯è¿ˆå‡ºäº†å®ç° Web æ¡†æ¶çš„ç¬¬ä¸€æ­¥ã€‚</p>
<p>åœ¨æ²¡æœ‰è‡ªå®šä¹‰ Engine ä¹‹å‰ï¼š</p>
<ul>
<li>
<p>æ¯ä¸ªè·¯ç”±éƒ½è¦å•ç‹¬æ³¨å†Œ handler</p>
</li>
<li>
<p>æ¯ä¸ª handler åªå¤„ç†è‡ªå·±å¯¹åº”çš„è·¯å¾„</p>
</li>
<li>
<p><strong>æ§åˆ¶æƒåˆ†æ•£åœ¨å„ä¸ªå‡½æ•°é‡Œ</strong></p>
</li>
<li>
<p>æƒ³åšç»Ÿä¸€æ“ä½œï¼ˆæ—¥å¿—ã€å¼‚å¸¸å¤„ç†ã€ç»Ÿä¸€è¿”å›æ ¼å¼ï¼‰å°±å¾ˆéº»çƒ¦ï¼Œéœ€è¦åœ¨æ¯ä¸ª handler é‡Œé‡å¤å†™</p>
</li>
</ul>
<p>ä½†æ˜¯åœ¨å®šä¹‰äº† Engine ä¹‹åï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½éœ€è¦å…ˆç»è¿‡ <code>engine.ServeHTTP</code>ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªæˆ‘ä»¬è‡ªå·±å®ç°çš„ <code>engine.ServeHTTP</code> å†…éƒ¨ï¼Œå°±å¯ä»¥åšï¼š</p>
<ul>
<li>
<p>è·¯ç”±åŒ¹é…</p>
</li>
<li>
<p>æ—¥å¿—æ‰“å°</p>
</li>
<li>
<p>å¼‚å¸¸å¤„ç†</p>
</li>
<li>
<p>å“åº”ç»Ÿä¸€å°è£…</p>
</li>
</ul>
<p><strong>æ ¸å¿ƒå˜åŒ–</strong>ï¼šæ§åˆ¶æƒä»â€œåˆ†æ•£åœ¨å„ä¸ª handler å‡½æ•°â€ â†’ â€œé›†ä¸­åœ¨ Engine é‡Œç»Ÿä¸€ç®¡ç†â€ã€‚</p>
<p>å½“ç„¶äº†ï¼Œè¿™é‡Œçš„ Engine åªæ˜¯ä¸ºäº†å¼•å‡ºå®ç° Web æ¡†æ¶çš„ä¸€ä¸ªä¾‹å­ï¼Œå®é™…ä¸Šè·¯ç”±åŒ¹é…è‚¯å®šä¸æ˜¯åƒç°åœ¨è¿™ä¹ˆå†™äº†ï¼Œå¦‚æœåƒç°åœ¨è¿™æ ·å†™ï¼Œé‚£ä¹ˆæ¯å¤šä¸€ä¸ªè·¯ç”±éƒ½è¦æ”¹ Engine çš„æºä»£ç ï¼Œå½“ç„¶æ˜¯ä¸è¡Œçš„ã€‚</p>
<p>Engine çš„æ ¸å¿ƒä»·å€¼æ˜¯â€œç»Ÿä¸€å…¥å£ + å¯æ‰©å±•åˆ†å‘â€ï¼Œè·¯ç”±åŒ¹é…å†™åœ¨ Engine é‡Œåªæ˜¯ä¸ºäº†æ¼”ç¤ºï¼›å®é™…æ¡†æ¶ä¸­è·¯ç”±åŒ¹é…ç”±æ˜ å°„è¡¨ç®¡ç†ï¼Œç”¨æˆ·æ³¨å†Œè·¯ç”±ï¼ŒEngine åªè´Ÿè´£åˆ†å‘ï¼Œè¿™æ ·å°±ä¸ä¼šæ¯æ¬¡åŠ è·¯ç”±éƒ½æ”¹ Engine ä»£ç ã€‚</p>
<h4 data-id="heading-4">Gee æ¡†æ¶çš„é›å½¢</h4>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬é‡æ–°ç»„ç»‡ä¸Šé¢ä»£ç ï¼Œæ­å»ºå‡ºæ•´ä¸ªæ¡†æ¶çš„é›å½¢ã€‚æœ€ç»ˆçš„ä»£ç ç›®å½•ç»“æ„æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-go" lang="go">gee/
  |--gee.<span class="hljs-keyword">go</span>
  |--<span class="hljs-keyword">go</span>.mod
main.<span class="hljs-keyword">go</span>
<span class="hljs-keyword">go</span>.mod
</code></pre>
<p><strong>gee/go.mod</strong></p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-keyword">module</span> <span class="hljs-title class_">Gee</span>

go <span class="hljs-number">1.24</span>
</code></pre>
<p><strong>gee/gee.go</strong></p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> gee

<span class="hljs-keyword">import</span> (
        <span class="hljs-string">"fmt"</span>
        <span class="hljs-string">"net/http"</span>
)

<span class="hljs-comment">// HandlerFunc å®šä¹‰äº†Geeæ¡†æ¶ä½¿ç”¨çš„è¯·æ±‚å¤„ç†å‡½æ•°ç±»å‹</span>
<span class="hljs-keyword">type</span> HandlerFunc <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span>

<span class="hljs-comment">// Engine å£°æ˜ä¸€ä¸ª Engine ç»“æ„ä½“ï¼Œè¿™ä¸ªç»“æ„ä½“ä¼šå®ç° ServeHTTP æ¥å£</span>
<span class="hljs-keyword">type</span> Engine <span class="hljs-keyword">struct</span> {
        router <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]HandlerFunc <span class="hljs-comment">// è·¯ç”±è¡¨</span>
}

<span class="hljs-comment">// New åˆ›å»º Engine å®ä¾‹ï¼Œåˆå§‹åŒ–ç©ºçš„è·¯ç”±è¡¨</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">New</span><span class="hljs-params">()</span></span> *Engine {
        <span class="hljs-keyword">return</span> &amp;Engine{router: <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]HandlerFunc)}
}

<span class="hljs-comment">// å·¥å…·å‡½æ•°ï¼Œåç»­ GET å’Œ POST ä¼šä½¿ç”¨è¿™ä¸ªå‡½æ•°ç»™ engine çš„è·¯ç”±è¡¨æ·»åŠ è·¯ç”±</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(engine *Engine)</span></span> addRoute(method <span class="hljs-type">string</span>, pattern <span class="hljs-type">string</span>, handler HandlerFunc) {
        key := method + <span class="hljs-string">"-"</span> + pattern
        engine.router[key] = handler
}

<span class="hljs-comment">// GET æä¾›ç»™ç”¨æˆ·æ³¨å†Œ GET è¯·æ±‚çš„ä¾¿æ·æ–¹æ³•</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(engine *Engine)</span></span> GET(pattern <span class="hljs-type">string</span>, handler HandlerFunc) {
        engine.addRoute(<span class="hljs-string">"GET"</span>, pattern, handler)
}

<span class="hljs-comment">// POST æä¾›ç»™ç”¨æˆ·æ³¨å†Œ POST è¯·æ±‚çš„ä¾¿æ·æ–¹æ³•</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(engine *Engine)</span></span> POST(pattern <span class="hljs-type">string</span>, handler HandlerFunc) {
        engine.addRoute(<span class="hljs-string">"POST"</span>, pattern, handler)
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(engine *Engine)</span></span> Run(addr <span class="hljs-type">string</span>) (err <span class="hljs-type">error</span>) {
        <span class="hljs-keyword">return</span> http.ListenAndServe(addr, engine)
}

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(engine *Engine)</span></span> ServeHTTP(w http.ResponseWriter, req *http.Request) {
        key := req.Method + <span class="hljs-string">"-"</span> + req.URL.Path
        fmt.Fprintf(w, <span class="hljs-string">"æ‹¼æ¥å‡ºæ¥çš„urlï¼š%s\n"</span>, key)
        <span class="hljs-keyword">if</span> handler, ok := engine.router[key]; ok {
                handler(w, req)
        } <span class="hljs-keyword">else</span> {
                w.WriteHeader(http.StatusNotFound) <span class="hljs-comment">// è¿”å›çŠ¶æ€ç </span>
                fmt.Fprintf(w, <span class="hljs-string">"404 NOT FOUND: %s\n"</span>, req.URL)
        }
}
</code></pre>
<blockquote>
<p>é‚£ä¹ˆ<code>gee.go</code>å°±æ˜¯é‡å¤´æˆäº†ã€‚æˆ‘ä»¬é‡ç‚¹ä»‹ç»ä¸€ä¸‹è¿™éƒ¨åˆ†çš„å®ç°ã€‚</p>
<ul>
<li>é¦–å…ˆå®šä¹‰äº†ç±»å‹<code>HandlerFunc</code>ï¼Œè¿™æ˜¯æä¾›ç»™æ¡†æ¶ç”¨æˆ·çš„ï¼Œç”¨æ¥å®šä¹‰è·¯ç”±æ˜ å°„çš„å¤„ç†æ–¹æ³•ã€‚æˆ‘ä»¬åœ¨<code>Engine</code>ä¸­ï¼Œæ·»åŠ äº†ä¸€å¼ è·¯ç”±æ˜ å°„è¡¨<code>router</code>ï¼Œkey ç”±è¯·æ±‚æ–¹æ³•å’Œé™æ€è·¯ç”±åœ°å€æ„æˆï¼Œä¾‹å¦‚<code>GET-/</code>ã€<code>GET-/hello</code>ã€<code>POST-/hello</code>ï¼Œè¿™æ ·é’ˆå¯¹ç›¸åŒçš„è·¯ç”±ï¼Œå¦‚æœè¯·æ±‚æ–¹æ³•ä¸åŒ,å¯ä»¥æ˜ å°„ä¸åŒçš„å¤„ç†æ–¹æ³•(Handler)ï¼Œvalue æ˜¯ç”¨æˆ·æ˜ å°„çš„å¤„ç†æ–¹æ³•ã€‚</li>
<li>å½“ç”¨æˆ·è°ƒç”¨<code>(*Engine).GET()</code>æ–¹æ³•æ—¶ï¼Œä¼šå°†è·¯ç”±å’Œå¤„ç†æ–¹æ³•æ³¨å†Œåˆ°æ˜ å°„è¡¨ <em>router</em> ä¸­ï¼Œ<code>(*Engine).Run()</code>æ–¹æ³•ï¼Œæ˜¯ <em>ListenAndServe</em> çš„åŒ…è£…ã€‚</li>
<li><code>Engine</code>å®ç°çš„ <em>ServeHTTP</em> æ–¹æ³•çš„ä½œç”¨å°±æ˜¯ï¼Œè§£æè¯·æ±‚çš„è·¯å¾„ï¼ŒæŸ¥æ‰¾è·¯ç”±æ˜ å°„è¡¨ï¼Œå¦‚æœæŸ¥åˆ°ï¼Œå°±æ‰§è¡Œæ³¨å†Œçš„å¤„ç†æ–¹æ³•ã€‚å¦‚æœæŸ¥ä¸åˆ°ï¼Œå°±è¿”å› <em>404 NOT FOUND</em> ã€‚</li>
</ul>
</blockquote>
<p><strong>go.mod</strong></p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-keyword">module</span> <span class="hljs-title class_">Gee</span>

go <span class="hljs-number">1.24</span>

<span class="hljs-keyword">require</span> gee v0.<span class="hljs-number">0.0</span>

replace gee =&gt; ./gee
</code></pre>
<p><strong>main.go</strong></p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
        <span class="hljs-string">"fmt"</span>
        <span class="hljs-string">"gee"</span>
        <span class="hljs-string">"net/http"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
        r := gee.New() <span class="hljs-comment">// åˆ›å»º Engine å®ä¾‹</span>

        r.GET(<span class="hljs-string">"/"</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(w http.ResponseWriter, req *http.Request)</span></span> {
                fmt.Fprintf(w, <span class="hljs-string">"URL.Path = %q\n"</span>, req.URL.Path)
        })

        r.GET(<span class="hljs-string">"/hello"</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(w http.ResponseWriter, req *http.Request)</span></span> {
                <span class="hljs-keyword">for</span> k, v := <span class="hljs-keyword">range</span> req.Header {
                        fmt.Fprintf(w, <span class="hljs-string">"Header[%q] = %q\n"</span>, k, v)
                }
        })

        r.Run(<span class="hljs-string">":9999"</span>) <span class="hljs-comment">// å¯åŠ¨ Web æœåŠ¡</span>
}
</code></pre>
<blockquote>
<p>çœ‹åˆ°è¿™é‡Œï¼Œå¦‚æœä½ ä½¿ç”¨è¿‡<code>gin</code>æ¡†æ¶çš„è¯ï¼Œè‚¯å®šä¼šè§‰å¾—æ— æ¯”çš„äº²åˆ‡ã€‚<code>gee</code>æ¡†æ¶çš„è®¾è®¡ä»¥åŠAPIå‡å‚è€ƒäº†<code>gin</code>ã€‚ä½¿ç”¨<code>New()</code>åˆ›å»º gee çš„å®ä¾‹ï¼Œä½¿ç”¨ <code>GET()</code>æ–¹æ³•æ·»åŠ è·¯ç”±ï¼Œæœ€åä½¿ç”¨<code>Run()</code>å¯åŠ¨WebæœåŠ¡ã€‚è¿™é‡Œçš„è·¯ç”±ï¼Œåªæ˜¯é™æ€è·¯ç”±ï¼Œä¸æ”¯æŒ<code>/hello/:name</code>è¿™æ ·çš„åŠ¨æ€è·¯ç”±ï¼ŒåŠ¨æ€è·¯ç”±æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€æ¬¡å®ç°ã€‚</p>
</blockquote>
<p>æœ€åï¼Œæˆ‘ä»¬åˆ†æä¸€ä¸‹ï¼Œç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„æ¡†æ¶å®Œæˆä¹‹åï¼Œä» <code> curl  ``http://localhost:9999/</code> åˆ° <code>URL.Path = "/"</code> çš„å®Œæ•´æµç¨‹ã€‚</p>
<p>å½“æˆ‘ä»¬å¯åŠ¨æœåŠ¡ä¹‹åï¼Œåœ¨ç»ˆç«¯è¾“å…¥ <code> curl  ``http://localhost:9999/</code>ï¼Œæ­¤æ—¶ net/http ä¼šæ”¶åˆ°è¯·æ±‚æŠ¥æ–‡å¹¶è¿›è¡Œè§£æï¼Œè§£æå‡º <code>w http.ResponseWriter</code> å’Œ <code>req *http.Request</code>ï¼Œå¹¶ä¼ å…¥ gee/gee.go ä¸­çš„ ServeHTTP å‡½æ•°è¿›è¡Œå¤„ç†ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">func (engine *Engine) <span class="hljs-built_in">ServeHTTP</span>(w http.ResponseWriter, req *http.Request) {
        key := req.Method + <span class="hljs-string">"-"</span> + req.URL.Path
        // fmt.<span class="hljs-built_in">Fprintf</span>(w, <span class="hljs-string">"æ‹¼æ¥å‡ºæ¥çš„urlï¼š%s\n"</span>, key)
        if handler, ok := engine.router[key]; ok {
                <span class="hljs-built_in">handler</span>(w, req)
        } else {
                fmt<span class="hljs-selector-class">.Fprintf</span>(w, "<span class="hljs-number">404</span> NOT FOUND: %s\n", req.URL)
        }
}
</code></pre>
<p>ç„¶åé€šè¿‡ <code>req.Method</code> å’Œ <code>req.URL.Path</code> æ‹¼æ¥å‡ºè·¯ç”± <code>key</code>ï¼Œç„¶åä» <code>engine</code> çš„è·¯ç”±è¡¨ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œå¦‚æœå­˜åœ¨è¯¥è·¯ç”±ï¼Œé‚£ä¹ˆå°±æŠŠ <code>w</code> å’Œ <code>req</code> äº¤ç»™å¯¹åº”çš„å¤„ç†å‡½æ•°è¿›è¡Œå¤„ç†ï¼›å¦‚æœä¸å­˜åœ¨è¯¥è·¯ç”±ï¼Œå°±è¿”å› <code>"404 NOT FOUND: %s\n"</code>ã€‚</p>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬æ‹¼æ¥å‡ºæ¥çš„ <code>key</code> æ˜¯ <code>"GET-/"</code>ã€‚åœ¨ <code>main.go</code> ä¸­ï¼Œé€šè¿‡ <code>r.GET</code> æ–¹æ³•å·²ç»å°†è¯¥è·¯ç”±æ³¨å†Œåˆ°äº† <code>engine</code> çš„è·¯ç”±è¡¨ä¸­äº†ï¼š</p>
<pre><code class="hljs language-go" lang="go">r.GET(<span class="hljs-string">"/"</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(w http.ResponseWriter, req *http.Request)</span></span> {
                fmt.Fprintf(w, <span class="hljs-string">"URL.Path = %q\n"</span>, req.URL.Path)
        })
</code></pre>
<p>é‚£ä¹ˆï¼Œå°±å¯ä»¥é€šè¿‡è·¯ç”±æ˜ å°„è¡¨æ‰¾åˆ°å¯¹åº”çš„å¤„ç†å‡½æ•°ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(w http.ResponseWriter, req *http.Request)</span></span> {
                fmt.Fprintf(w, <span class="hljs-string">"URL.Path = %q\n"</span>, req.URL.Path)
        }
</code></pre>
<p>ç„¶åå°† <code>w</code> å’Œ <code>req</code> å‚æ•°ä¼ å…¥ç»™è¿™ä¸ªå¤„ç†å‡½æ•°ï¼Œæœ€å <code>fmt.Fprintf</code> æ¥è°ƒç”¨ <code>w.Write</code>ï¼Œåé¢çš„<code>"URL.Path = %q\n"</code> ä½œä¸º <code>w.Write</code> çš„ä¼ å‚å†™å…¥ <strong>HTTP å“åº”ç¼“å†²åŒºï¼Œ</strong> handler è¿”å›åï¼Œ<code>net/http</code> æŠŠè¿™äº›å­—èŠ‚é€šè¿‡ TCP å‘ç»™æµè§ˆå™¨ã€‚</p>
<p>è¿™å°±æ˜¯åŸºäºæˆ‘ä»¬è‡ªå·±ç¼–å†™çš„ç®€å•æ¡†æ¶ä¸­æ•°æ®çš„æµå‘ã€‚</p>
<hr/>
<p>è‡³æ­¤ï¼Œæ•´ä¸ª<code>Gee</code>æ¡†æ¶çš„åŸå‹å·²ç»å‡ºæ¥äº†ã€‚å®ç°äº†è·¯ç”±æ˜ å°„è¡¨ï¼Œæä¾›äº†ç”¨æˆ·æ³¨å†Œé™æ€è·¯ç”±çš„æ–¹æ³•ï¼ŒåŒ…è£…äº†å¯åŠ¨æœåŠ¡çš„å‡½æ•°ã€‚å½“ç„¶ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰å®ç°æ¯”<code>net/http</code>æ ‡å‡†åº“æ›´å¼ºå¤§çš„èƒ½åŠ›ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œå¾ˆå¿«å°±å¯ä»¥å°†åŠ¨æ€è·¯ç”±ã€ä¸­é—´ä»¶ç­‰åŠŸèƒ½æ·»åŠ ä¸Šå»äº†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Redis å®æˆ˜ï¼šä»é›¶æ‰‹å†™åˆ†å¸ƒå¼é”ï¼ˆè¯¯åˆ é—®é¢˜ä¸ Lua è„šæœ¬ä¼˜åŒ–ï¼‰]]></title>    <link>https://juejin.cn/post/7585406229151711270</link>    <guid>https://juejin.cn/post/7585406229151711270</guid>    <pubDate>2025-12-19T07:57:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585406229151711270" data-draft-id="7585406229151694886" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redis å®æˆ˜ï¼šä»é›¶æ‰‹å†™åˆ†å¸ƒå¼é”ï¼ˆè¯¯åˆ é—®é¢˜ä¸ Lua è„šæœ¬ä¼˜åŒ–ï¼‰"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-19T07:57:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ShaneD771"/> <meta itemprop="url" content="https://juejin.cn/user/2482077907032171"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redis å®æˆ˜ï¼šä»é›¶æ‰‹å†™åˆ†å¸ƒå¼é”ï¼ˆè¯¯åˆ é—®é¢˜ä¸ Lua è„šæœ¬ä¼˜åŒ–ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2482077907032171/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ShaneD771
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T07:57:51.000Z" title="Fri Dec 19 2025 07:57:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    17
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Redis å®æˆ˜ï¼šä»é›¶æ‰‹å†™åˆ†å¸ƒå¼é”ï¼ˆè¯¯åˆ é—®é¢˜ä¸ Lua è„šæœ¬ä¼˜åŒ–ï¼‰</h2>
<p>åœ¨å•ä½“æ¶æ„ä¸­ï¼Œæˆ‘ä»¬ä¹ æƒ¯ä½¿ç”¨ <code>synchronized</code> æˆ– <code>Lock</code> æ¥è§£å†³å¹¶å‘å®‰å…¨é—®é¢˜ã€‚ä½†åœ¨åˆ†å¸ƒå¼é›†ç¾¤æ¶æ„ä¸‹ï¼Œä¸åŒçš„æœåŠ¡è¿è¡Œåœ¨ä¸åŒçš„ JVM ä¸­ï¼Œæœ¬åœ°é”ä¹Ÿå°±å¤±æ•ˆäº†ã€‚</p>
<p>æœ¬æ–‡å°†å¤ç°å¦‚ä½•åŸºäº Redis å®ç°ä¸€ä¸ªåˆ†å¸ƒå¼é”ï¼Œå¹¶ä¸€æ­¥æ­¥è§£å†³<strong>æ­»é”</strong>ã€<strong>è¯¯åˆ </strong>ã€<strong>åŸå­æ€§</strong>ç­‰ç»å…¸é—®é¢˜ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€ åˆçº§ç‰ˆæœ¬ï¼šåˆ©ç”¨ SETNX å®ç°äº’æ–¥</h3>
<p>Redis çš„ <code>SETNX</code> (Set if Not Exists) å‘½ä»¤å¤©ç”Ÿå…·å¤‡äº’æ–¥æ€§ï¼šåªæœ‰ Key ä¸å­˜åœ¨æ—¶æ‰èƒ½è®¾ç½®æˆåŠŸã€‚</p>
<p>ä¸ºäº†é˜²æ­¢è·å–é”çš„æœåŠ¡å™¨å®•æœºå¯¼è‡´é”æ°¸è¿œæ— æ³•é‡Šæ”¾ï¼ˆæ­»é”ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä½¿ç”¨ <code>SETNX</code> çš„åŒæ—¶è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆTTLï¼‰ã€‚</p>
<p><strong>æ ¸å¿ƒå‘½ä»¤ï¼š</strong></p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-keyword">SET</span> lock:<span class="hljs-keyword">key</span> threadId NX EX <span class="hljs-number">10</span>
</code></pre>
<p><em>æ³¨æ„ï¼šå¿…é¡»ä¿è¯ SETNX å’Œ EXPIRE æ˜¯åŸå­æ“ä½œï¼Œä¸èƒ½åˆ†æˆä¸¤æ¡å‘½ä»¤æ‰§è¡Œã€‚</em></p>
<h4 data-id="heading-2">Java ä»£ç å®ç°</h4>
<p>å®šä¹‰ä¸€ä¸ª <code>SimpleRedisLock</code> ç±»ï¼Œå®ç°åŸºç¡€çš„åŠ é”å’Œè§£é”é€»è¾‘ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleRedisLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ILock</span> {

    <span class="hljs-keyword">private</span> String name; <span class="hljs-comment">// é”çš„ä¸šåŠ¡åç§°</span>
    <span class="hljs-keyword">private</span> StringRedisTemplate stringRedisTemplate; <span class="hljs-comment">// Redisæ“ä½œå·¥å…·</span>

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SimpleRedisLock</span><span class="hljs-params">(String name, StringRedisTemplate stringRedisTemplate)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.stringRedisTemplate = stringRedisTemplate;
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">KEY_PREFIX</span> <span class="hljs-operator">=</span> <span class="hljs-string">"lock:"</span>;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">(<span class="hljs-type">long</span> timeoutSec)</span> {
        <span class="hljs-comment">// è·å–çº¿ç¨‹IDä½œä¸ºæ ‡è¯†</span>
        <span class="hljs-type">long</span> <span class="hljs-variable">threadId</span> <span class="hljs-operator">=</span> Thread.currentThread().getId();
        <span class="hljs-comment">// æ‰§è¡Œ SET lock:name threadId NX EX timeout</span>
        <span class="hljs-type">Boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> stringRedisTemplate.opsForValue()
                .setIfAbsent(KEY_PREFIX + name, threadId + <span class="hljs-string">""</span>, timeoutSec, TimeUnit.SECONDS);
        <span class="hljs-comment">// é˜²æ­¢è‡ªåŠ¨æ‹†ç®±ç©ºæŒ‡é’ˆ</span>
        <span class="hljs-keyword">return</span> Boolean.TRUE.equals(success);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ç®€å•ç²—æš´ç›´æ¥åˆ </span>
        stringRedisTemplate.delete(KEY_PREFIX + name);
    }
}
</code></pre>
<h3 data-id="heading-3">äºŒã€ è¿›é˜¶ç‰ˆæœ¬ï¼šè§£å†³â€œè¯¯åˆ â€é—®é¢˜</h3>
<p>åˆçº§ç‰ˆæœ¬å­˜åœ¨ä¸€ä¸ªä¸¥é‡çš„éšæ‚£ï¼š<strong>å¦‚æœä¸šåŠ¡æ‰§è¡Œæ—¶é—´è¶…è¿‡äº†é”çš„è¿‡æœŸæ—¶é—´ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</strong></p>
<h4 data-id="heading-4">1. äº‹æ•…åœºæ™¯è¿˜åŸ</h4>
<p>å‡è®¾é”çš„æœ‰æ•ˆæœŸæ˜¯ 10sï¼Œä½†ä¸šåŠ¡æ‰§è¡Œäº† 15sï¼š</p>
<ol>
<li><strong>çº¿ç¨‹ A</strong> è·å–é”ï¼Œå¼€å§‹æ‰§è¡Œä¸šåŠ¡ã€‚</li>
<li><strong>10s å</strong>ï¼ŒRedis é”è‡ªåŠ¨è¿‡æœŸé‡Šæ”¾ã€‚</li>
<li><strong>çº¿ç¨‹ B</strong> å°è¯•è·å–é”ï¼ŒæˆåŠŸæ‹¿åˆ°ï¼ˆå› ä¸º A çš„é”æ²¡äº†ï¼‰ã€‚</li>
<li><strong>15s å</strong>ï¼Œçº¿ç¨‹ A ä¸šåŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæ‰§è¡Œ <code>unlock()</code>ï¼Œç›´æ¥åˆ é™¤äº† Keyã€‚</li>
<li><strong>é—®é¢˜å‡ºç°</strong>ï¼šçº¿ç¨‹ A åˆ æ‰çš„å…¶å®æ˜¯ <strong>çº¿ç¨‹ B</strong> æ­£åœ¨æŒæœ‰çš„é”ï¼</li>
<li>æ­¤æ—¶ <strong>çº¿ç¨‹ C</strong> è¿›æ¥ï¼Œå‘ç°æ²¡é”ï¼Œç›´æ¥åŠ é”ã€‚å¯¼è‡´ B å’Œ C å¹¶å‘æ‰§è¡Œï¼Œäº’æ–¥å¤±æ•ˆã€‚</li>
</ol>
<h4 data-id="heading-5">2. è§£å†³æ–¹æ¡ˆï¼šç»™é”åŠ ä¸Šâ€œèº«ä»½è¯â€</h4>
<p>ä¸ºäº†éµå¾ªâ€œè§£é“ƒè¿˜é¡»ç³»é“ƒäººâ€çš„åŸåˆ™ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è§£é”æ—¶åˆ¤æ–­ï¼š<strong>è¿™æŠŠé”æ˜¯ä¸æ˜¯æˆ‘çš„ï¼Ÿ</strong></p>
<ul>
<li><strong>æ”¹è¿› Value</strong>ï¼šå•ç”¨çº¿ç¨‹ ID åœ¨é›†ç¾¤ä¸‹å¯èƒ½é‡å¤ï¼Œæˆ‘ä»¬éœ€è¦æ‹¼æ¥ä¸€ä¸ª JVM çš„å”¯ä¸€æ ‡è¯†ï¼ˆUUIDï¼‰ã€‚</li>
<li><strong>æ”¹è¿› unlock</strong>ï¼šåˆ é™¤å‰å…ˆæŸ¥è¯¢ Valueï¼Œåˆ¤æ–­æ˜¯å¦ä¸è‡ªå·±ä¸€è‡´ã€‚</li>
</ul>
<h4 data-id="heading-6">3. ä»£ç å‡çº§</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> cn.hutool.core.lang.UUID;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleRedisLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ILock</span> {
    <span class="hljs-comment">// ... æ„é€ æ–¹æ³•åŒä¸Š ...</span>

    <span class="hljs-comment">// ç”Ÿæˆ JVM å”¯ä¸€çš„ UUID å‰ç¼€</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">ID_PREFIX</span> <span class="hljs-operator">=</span> UUID.randomUUID().toString(<span class="hljs-literal">true</span>) + <span class="hljs-string">"-"</span>;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">(<span class="hljs-type">long</span> timeoutSec)</span> {
        <span class="hljs-comment">// æ‹¼æ¥ UUID + çº¿ç¨‹ ID</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">threadId</span> <span class="hljs-operator">=</span> ID_PREFIX + Thread.currentThread().getId();
        <span class="hljs-comment">// å­˜å…¥ Redis</span>
        <span class="hljs-type">Boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> stringRedisTemplate.opsForValue()
                .setIfAbsent(KEY_PREFIX + name, threadId, timeoutSec, TimeUnit.SECONDS);
        <span class="hljs-keyword">return</span> Boolean.TRUE.equals(success);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// 1. è·å–å½“å‰çº¿ç¨‹çš„æ ‡è¯†</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">threadId</span> <span class="hljs-operator">=</span> ID_PREFIX + Thread.currentThread().getId();
        <span class="hljs-comment">// 2. è·å– Redis ä¸­é”çš„æ ‡è¯†</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> stringRedisTemplate.opsForValue().get(KEY_PREFIX + name);
        <span class="hljs-comment">// 3. åˆ¤æ–­æ˜¯å¦ä¸€è‡´</span>
        <span class="hljs-keyword">if</span> (threadId.equals(id)) {
            <span class="hljs-comment">// 4. ä¸€è‡´æ‰åˆ é™¤</span>
            stringRedisTemplate.delete(KEY_PREFIX + name);
        }
    }
}
</code></pre>
<h3 data-id="heading-7">ä¸‰ã€ ç»ˆæç‰ˆæœ¬ï¼šLua è„šæœ¬ä¿è¯åŸå­æ€§</h3>
<p>ä¸Šé¢çš„ Java ä»£ç è§£å†³äº†â€œè¯¯åˆ â€çš„å¤§éƒ¨åˆ†åœºæ™¯ï¼Œä½†åœ¨æç«¯å¹¶å‘ä¸‹ä¾ç„¶æœ‰æ¼æ´ã€‚</p>
<h4 data-id="heading-8">1. åŸå­æ€§æ¼æ´</h4>
<p>åœ¨ unlock æ–¹æ³•ä¸­ï¼Œâ€œåˆ¤æ–­é”æ ‡è¯†â€ å’Œ â€œåˆ é™¤é”â€ æ˜¯ä¸¤ä¸ªåŠ¨ä½œã€‚</p>
<p>å¦‚æœçº¿ç¨‹ A åˆ¤æ–­æˆåŠŸï¼ˆæ˜¯è‡ªå·±çš„é”ï¼‰ï¼Œæ­£å‡†å¤‡åˆ é™¤æ—¶ï¼Œç³»ç»Ÿå‘ç”Ÿäº† GC åœé¡¿ï¼ˆStop The Worldï¼‰æˆ–è€…ç½‘ç»œé˜»å¡ã€‚</p>
<p>æ°å¥½åœ¨è¿™æ®µæ—¶é—´å†…ï¼Œé”è¿‡æœŸäº†ï¼Œçº¿ç¨‹ B æŠ¢åˆ°äº†é”ã€‚</p>
<p>ç­‰çº¿ç¨‹ A æ¢å¤è¿è¡Œï¼Œå®ƒä¸ä¼šå†æ¬¡åˆ¤æ–­ï¼Œè€Œæ˜¯ç›´æ¥æ‰§è¡Œ deleteï¼Œç»“æœè¿˜æ˜¯æŠŠ B çš„é”ç»™åˆ äº†ã€‚</p>
<h4 data-id="heading-9">2. è§£å†³æ–¹æ¡ˆï¼šLua è„šæœ¬</h4>
<p>Redis æä¾›äº† Lua è„šæœ¬åŠŸèƒ½ï¼Œå¯ä»¥å°†å¤šæ¡å‘½ä»¤ä½œä¸ºä¸€ä¸ªæ•´ä½“æ‰§è¡Œï¼Œä¸­é—´ä¸ä¼šè¢«å…¶ä»–å‘½ä»¤æ’å…¥ï¼Œä»è€Œä¿è¯äº†åŸå­æ€§ã€‚</p>
<p><strong>ç¼–å†™ Lua è„šæœ¬ (<code>unlock.lua</code>)ï¼š</strong></p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-comment">-- KEYS[1] æ˜¯é”çš„ key</span>
<span class="hljs-comment">-- ARGV[1] æ˜¯å½“å‰çº¿ç¨‹çš„æ ‡è¯†</span>
<span class="hljs-keyword">if</span> redis.call(<span class="hljs-string">'get'</span>, KEYS[<span class="hljs-number">1</span>]) == ARGV[<span class="hljs-number">1</span>] <span class="hljs-keyword">then</span>
    <span class="hljs-comment">-- æ ‡è¯†ä¸€è‡´ï¼Œæ‰§è¡Œåˆ é™¤</span>
    <span class="hljs-keyword">return</span> redis.call(<span class="hljs-string">'del'</span>, KEYS[<span class="hljs-number">1</span>])
<span class="hljs-keyword">else</span>
    <span class="hljs-comment">-- ä¸ä¸€è‡´ï¼Œè¿”å› 0</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h4 data-id="heading-10">3. ä»£ç æœ€ç»ˆå½¢æ€</h4>
<p>æˆ‘ä»¬éœ€è¦é¢„åŠ è½½ Lua è„šæœ¬ï¼Œå¹¶ä½¿ç”¨ <code>execute</code> æ–¹æ³•è°ƒç”¨ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleRedisLock</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ILock</span> {

    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> StringRedisTemplate stringRedisTemplate;
    <span class="hljs-comment">// é™æ€ä»£ç å—é¢„åŠ è½½ Lua è„šæœ¬</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> DefaultRedisScript&lt;Long&gt; UNLOCK_SCRIPT;
    <span class="hljs-keyword">static</span> {
        UNLOCK_SCRIPT = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultRedisScript</span>&lt;&gt;();
        UNLOCK_SCRIPT.setLocation(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassPathResource</span>(<span class="hljs-string">"unlock.lua"</span>)); <span class="hljs-comment">// è„šæœ¬æ–‡ä»¶ä½ç½®</span>
        UNLOCK_SCRIPT.setResultType(Long.class);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">SimpleRedisLock</span><span class="hljs-params">(String name, StringRedisTemplate stringRedisTemplate)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.stringRedisTemplate = stringRedisTemplate;
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">ID_PREFIX</span> <span class="hljs-operator">=</span> UUID.randomUUID().toString(<span class="hljs-literal">true</span>) + <span class="hljs-string">"-"</span>;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">(<span class="hljs-type">long</span> timeoutSec)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">threadId</span> <span class="hljs-operator">=</span> ID_PREFIX + Thread.currentThread().getId();
        <span class="hljs-type">Boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> stringRedisTemplate.opsForValue()
                .setIfAbsent(KEY_PREFIX + name, threadId, timeoutSec, TimeUnit.SECONDS);
        <span class="hljs-keyword">return</span> Boolean.TRUE.equals(success);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è°ƒç”¨ Lua è„šæœ¬</span>
        stringRedisTemplate.execute(
                UNLOCK_SCRIPT,
                Collections.singletonList(KEY_PREFIX + name), <span class="hljs-comment">// KEYS[1]</span>
                ID_PREFIX + Thread.currentThread().getId()    <span class="hljs-comment">// ARGV[1]</span>
        );
    }
}
</code></pre>
<h3 data-id="heading-11">å››ã€ æ€»ç»“</h3>
<p>æ‰‹å†™ Redis åˆ†å¸ƒå¼é”æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„å­¦ä¹ è¿‡ç¨‹ï¼Œç»å†äº†ä¸‰ä¸ªé˜¶æ®µï¼š</p>
<ol>
<li><strong>åŸºç¡€ç‰ˆ</strong>ï¼šåˆ©ç”¨ <code>SETNX</code> å®ç°äº’æ–¥ï¼Œ<code>EX</code> é˜²æ­¢æ­»é”ã€‚</li>
<li><strong>æ”¹è¿›ç‰ˆ</strong>ï¼šåˆ©ç”¨ <code>UUID + ThreadID</code> é˜²æ­¢é”è¶…æ—¶åè¯¯åˆ ä»–äººé”ã€‚</li>
<li><strong>ç»ˆæç‰ˆ</strong>ï¼šåˆ©ç”¨ <code>Lua è„šæœ¬</code> è§£å†³â€œæŸ¥è¯¢â€ä¸â€œåˆ é™¤â€éåŸå­æ€§çš„é—®é¢˜ã€‚</li>
</ol>
<p><strong>æ³¨æ„</strong>ï¼šè¿™åªæ˜¯ä¸€ä¸ªå…¥é—¨çº§çš„åˆ†å¸ƒå¼é”å®ç°ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¿˜è¦è€ƒè™‘<strong>é”ç»­æœŸ</strong>ï¼ˆçœ‹é—¨ç‹—æœºåˆ¶ï¼‰ã€<strong>å¯é‡å…¥æ€§</strong>ã€<strong>ä¸»ä»ä¸€è‡´æ€§</strong>ï¼ˆRedlockï¼‰ç­‰é—®é¢˜ã€‚å»ºè®®ç”Ÿäº§ç¯å¢ƒç›´æ¥ä½¿ç”¨æˆç†Ÿçš„æ¡†æ¶ <strong>Redisson</strong>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaå¹¶å‘ç¼–ç¨‹åŸºç¡€ï¼šä»çº¿ç¨‹åˆ°é”]]></title>    <link>https://juejin.cn/post/7585171571129401380</link>    <guid>https://juejin.cn/post/7585171571129401380</guid>    <pubDate>2025-12-19T08:05:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585171571129401380" data-draft-id="7584640225644773439" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaå¹¶å‘ç¼–ç¨‹åŸºç¡€ï¼šä»çº¿ç¨‹åˆ°é”"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-19T08:05:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç„¡é‡"/> <meta itemprop="url" content="https://juejin.cn/user/1116759546145086"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaå¹¶å‘ç¼–ç¨‹åŸºç¡€ï¼šä»çº¿ç¨‹åˆ°é”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1116759546145086/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç„¡é‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T08:05:57.000Z" title="Fri Dec 19 2025 08:05:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    16
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»44åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨å½“ä»Šäº’è”ç½‘é«˜å¹¶å‘çš„èƒŒæ™¯ä¸‹,å¹¶å‘ç¼–ç¨‹å·²æˆä¸ºJavaå¼€å‘è€…çš„å¿…å¤‡æŠ€èƒ½ã€‚ä»ç®€å•çš„å¤šçº¿ç¨‹åº”ç”¨åˆ°å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿ,çº¿ç¨‹å®‰å…¨é—®é¢˜æ— å¤„ä¸åœ¨ã€‚æœ¬æ–‡å°†ä»è¿›ç¨‹ä¸çº¿ç¨‹çš„åŸºç¡€æ¦‚å¿µå‡ºå‘,æ·±å…¥å‰–æsynchronizedå’Œvolatileçš„åº•å±‚åŸç†,ç»“åˆç”µå•†ä¸šåŠ¡åœºæ™¯,å¸¦ä½ ç³»ç»ŸæŒæ¡Javaå¹¶å‘ç¼–ç¨‹çš„æ ¸å¿ƒçŸ¥è¯†ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ç†è®ºçŸ¥è¯†ä¸æ ¸å¿ƒæ¦‚å¿µ</h2>
<h3 data-id="heading-2">1.1 è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«</h3>
<p><strong>è¿›ç¨‹(Process)</strong> æ˜¯æ“ä½œç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½,æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„ä»£ç æ®µã€æ•°æ®æ®µå’Œå †æ ˆæ®µã€‚</p>
<p><strong>çº¿ç¨‹(Thread)</strong> æ˜¯CPUè°ƒåº¦å’Œæ‰§è¡Œçš„æœ€å°å•ä½,æ˜¯è¿›ç¨‹ä¸­çš„ä¸€ä¸ªæ‰§è¡Œå•å…ƒã€‚åŒä¸€è¿›ç¨‹å†…çš„å¤šä¸ªçº¿ç¨‹å…±äº«è¿›ç¨‹çš„å†…å­˜ç©ºé—´(å †å†…å­˜ã€æ–¹æ³•åŒº),ä½†æ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±ç‹¬ç«‹çš„æ ˆç©ºé—´ã€‚</p>



































<table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>è¿›ç¨‹</th><th>çº¿ç¨‹</th></tr></thead><tbody><tr><td>èµ„æºå ç”¨</td><td>ç‹¬ç«‹å†…å­˜ç©ºé—´,å¼€é”€å¤§</td><td>å…±äº«è¿›ç¨‹å†…å­˜,å¼€é”€å°</td></tr><tr><td>é€šä¿¡æ–¹å¼</td><td>IPC(ç®¡é“ã€æ¶ˆæ¯é˜Ÿåˆ—ã€å…±äº«å†…å­˜)</td><td>ç›´æ¥è¯»å†™å…±äº«å˜é‡</td></tr><tr><td>åˆ›å»ºé€Ÿåº¦</td><td>æ…¢(éœ€è¦åˆ†é…ç‹¬ç«‹å†…å­˜)</td><td>å¿«(åªéœ€åˆ†é…æ ˆç©ºé—´)</td></tr><tr><td>å½±å“èŒƒå›´</td><td>è¿›ç¨‹å´©æºƒä¸å½±å“å…¶ä»–è¿›ç¨‹</td><td>çº¿ç¨‹å´©æºƒå¯èƒ½å¯¼è‡´æ•´ä¸ªè¿›ç¨‹å´©æºƒ</td></tr><tr><td>ä¸Šä¸‹æ–‡åˆ‡æ¢</td><td>å¼€é”€å¤§(éœ€è¦åˆ‡æ¢å†…å­˜ç©ºé—´)</td><td>å¼€é”€å°(å…±äº«å†…å­˜ç©ºé—´)</td></tr></tbody></table>
<h3 data-id="heading-3">1.2 çº¿ç¨‹çš„åˆ›å»ºæ–¹å¼</h3>
<p>Javaæä¾›äº†å››ç§åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ–¹å¼1: ç»§æ‰¿Threadç±»</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"Thread by extending Thread: "</span> + Thread.currentThread().getName());
    }
}

<span class="hljs-comment">// æ–¹å¼2: å®ç°Runnableæ¥å£(æ¨è)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyRunnable</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"Thread by Runnable: "</span> + Thread.currentThread().getName());
    }
}

<span class="hljs-comment">// æ–¹å¼3: å®ç°Callableæ¥å£(æœ‰è¿”å›å€¼)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCallable</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Callable</span>&lt;String&gt; {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">call</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Thread by Callable: "</span> + Thread.currentThread().getName();
    }
}

<span class="hljs-comment">// æ–¹å¼4: çº¿ç¨‹æ± (ç”Ÿäº§ç¯å¢ƒæ¨è)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadPoolExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(<span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">60L</span>, TimeUnit.SECONDS,
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="hljs-number">100</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadFactory</span>() {
                <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">threadNumber</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">1</span>);
                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> Thread <span class="hljs-title function_">newThread</span><span class="hljs-params">(Runnable r)</span> {
                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(r, <span class="hljs-string">"custom-pool-"</span> + threadNumber.getAndIncrement());
                }
            },
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>.CallerRunsPolicy());
}
</code></pre>
<p><strong>å¯¹æ¯”åˆ†æ:</strong></p>
<ul>
<li><strong>ç»§æ‰¿Thread</strong>: ç”±äºJavaå•ç»§æ‰¿é™åˆ¶,æ‰©å±•æ€§å·®,ä¸æ¨è</li>
<li><strong>å®ç°Runnable</strong>: è§£è€¦ä»»åŠ¡ä¸çº¿ç¨‹,å¯ä»¥è¢«çº¿ç¨‹æ± é‡ç”¨,æ¨èä½¿ç”¨</li>
<li><strong>å®ç°Callable</strong>: å¯ä»¥è¿”å›ç»“æœå’ŒæŠ›å‡ºå¼‚å¸¸,é€‚åˆéœ€è¦è¿”å›å€¼çš„åœºæ™¯</li>
<li><strong>çº¿ç¨‹æ± </strong>: é¿å…é¢‘ç¹åˆ›å»ºé”€æ¯çº¿ç¨‹,å¤ç”¨çº¿ç¨‹èµ„æº,ç”Ÿäº§ç¯å¢ƒå¿…é€‰</li>
</ul>
<h3 data-id="heading-4">1.3 çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</h3>
<p>Javaçº¿ç¨‹æœ‰6ç§çŠ¶æ€,å®šä¹‰åœ¨<code>Thread.State</code>æšä¸¾ä¸­:</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   NEW   â”‚ (æ–°å»ºçŠ¶æ€: Threadå¯¹è±¡åˆ›å»º,ä½†æœªè°ƒç”¨start())
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚ <span class="hljs-built_in">start</span>()
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   RUNNABLE   â”‚ (å¯è¿è¡ŒçŠ¶æ€: åŒ…å«å°±ç»ªReadyå’Œè¿è¡ŒRunningä¸¤ç§å­çŠ¶æ€)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â–º BLOCKED (é˜»å¡çŠ¶æ€: ç­‰å¾…è·å–synchronizedé”)
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â–º WAITING (æ— é™æœŸç­‰å¾…: Object.wait()ã€Thread<span class="hljs-selector-class">.join</span>()ã€LockSupport<span class="hljs-selector-class">.park</span>())
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â–º TIMED_WAITING (é™æœŸç­‰å¾…: Thread.sleep()ã€<span class="hljs-selector-tag">Object</span><span class="hljs-selector-class">.wait</span>(timeout)ã€Thread<span class="hljs-selector-class">.join</span>(timeout))
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TERMINATED  â”‚ (ç»ˆæ­¢çŠ¶æ€: run()æ–¹æ³•æ‰§è¡Œå®Œæ¯•æˆ–æŠ›å‡ºå¼‚å¸¸)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>å…³é”®çŠ¶æ€è½¬æ¢:</strong></p>
<ol>
<li><strong>NEW â†’ RUNNABLE</strong>: è°ƒç”¨<code>start()</code>æ–¹æ³•</li>
<li><strong>RUNNABLE â†’ BLOCKED</strong>: å°è¯•è·å–synchronizedé”å¤±è´¥,è¿›å…¥é”çš„EntryListé˜Ÿåˆ—</li>
<li><strong>RUNNABLE â†’ WAITING</strong>: è°ƒç”¨<code>Object.wait()</code>ã€<code>Thread.join()</code>ã€<code>LockSupport.park()</code></li>
<li><strong>RUNNABLE â†’ TIMED_WAITING</strong>: è°ƒç”¨<code>Thread.sleep(timeout)</code>ã€<code>Object.wait(timeout)</code>ç­‰å¸¦è¶…æ—¶çš„æ–¹æ³•</li>
<li><strong>BLOCKED/WAITING/TIMED_WAITING â†’ RUNNABLE</strong>: è·å–åˆ°é”ã€è¢«notifyå”¤é†’ã€è¶…æ—¶æ—¶é—´åˆ°</li>
<li><strong>RUNNABLE â†’ TERMINATED</strong>: run()æ–¹æ³•æ‰§è¡Œå®Œæ¯•</li>
</ol>
<h3 data-id="heading-5">1.4 å¹¶å‘ä¸å¹¶è¡Œ</h3>
<p><strong>å¹¶å‘(Concurrency)</strong>: å•æ ¸CPUé€šè¿‡æ—¶é—´ç‰‡è½®è½¬,å¿«é€Ÿåˆ‡æ¢æ‰§è¡Œå¤šä¸ªä»»åŠ¡,çœ‹èµ·æ¥åƒåŒæ—¶æ‰§è¡Œ,å®é™…ä¸Šæ˜¯äº¤æ›¿æ‰§è¡Œã€‚å¼ºè°ƒçš„æ˜¯<strong>ä»»åŠ¡è°ƒåº¦èƒ½åŠ›</strong>ã€‚</p>
<p><strong>å¹¶è¡Œ(Parallelism)</strong>: å¤šæ ¸CPUçœŸæ­£åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡,æ¯ä¸ªæ ¸å¿ƒç‹¬ç«‹è¿è¡Œä¸€ä¸ªçº¿ç¨‹ã€‚å¼ºè°ƒçš„æ˜¯<strong>åŒæ—¶æ‰§è¡Œèƒ½åŠ›</strong>ã€‚</p>
<pre><code class="hljs language-less" lang="less">å¹¶å‘(å•æ ¸<span class="hljs-selector-tag">CPU</span>):
æ—¶é—´ â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â–º
ä»»åŠ¡<span class="hljs-selector-tag">A</span>   â–ˆ       â–ˆ       â–ˆ
ä»»åŠ¡<span class="hljs-selector-tag">B</span>     â–ˆ       â–ˆ       â–ˆ
ä»»åŠ¡<span class="hljs-selector-tag">C</span>       â–ˆ       â–ˆ       â–ˆ

å¹¶è¡Œ(å¤šæ ¸CPU):
æ—¶é—´ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
æ ¸å¿ƒ<span class="hljs-number">1</span>   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  (ä»»åŠ¡A)
æ ¸å¿ƒ<span class="hljs-number">2</span>   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  (ä»»åŠ¡B)
æ ¸å¿ƒ<span class="hljs-number">3</span>   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  (ä»»åŠ¡C)
</code></pre>
<h3 data-id="heading-6">1.5 çº¿ç¨‹å®‰å…¨çš„å®šä¹‰</h3>
<p><strong>çº¿ç¨‹å®‰å…¨</strong>æ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªå¯¹è±¡æ—¶,æ— è®ºè¿è¡Œæ—¶ç¯å¢ƒé‡‡ç”¨ä½•ç§è°ƒåº¦æ–¹å¼æˆ–è¿™äº›çº¿ç¨‹å¦‚ä½•äº¤æ›¿æ‰§è¡Œ,è¯¥å¯¹è±¡éƒ½èƒ½è¡¨ç°å‡ºæ­£ç¡®çš„è¡Œä¸º,å¹¶ä¸”ä¸éœ€è¦è°ƒç”¨æ–¹æä¾›é¢å¤–çš„åŒæ­¥æªæ–½ã€‚</p>
<p><strong>çº¿ç¨‹å®‰å…¨çš„ä¸‰å¤§ç‰¹æ€§:</strong></p>
<ol>
<li><strong>åŸå­æ€§(Atomicity)</strong>: ä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸ,è¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œ</li>
<li><strong>å¯è§æ€§(Visibility)</strong>: ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡,å…¶ä»–çº¿ç¨‹èƒ½ç«‹å³çœ‹åˆ°ä¿®æ”¹åçš„å€¼</li>
<li><strong>æœ‰åºæ€§(Ordering)</strong>: ç¨‹åºæ‰§è¡Œçš„é¡ºåºæŒ‰ç…§ä»£ç çš„å…ˆåé¡ºåºæ‰§è¡Œ</li>
</ol>
<p><strong>åˆ¤æ–­çº¿ç¨‹å®‰å…¨çš„æ ‡å‡†:</strong></p>
<ul>
<li>å¤šçº¿ç¨‹ç¯å¢ƒä¸‹,å¯¹å…±äº«å˜é‡çš„æ“ä½œä¸ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´</li>
<li>ä¸ä¼šå‡ºç°ä¸¢å¤±æ›´æ–°ã€è„è¯»ã€ä¸å¯é‡å¤è¯»ç­‰é—®é¢˜</li>
<li>ç¨‹åºè¿è¡Œç»“æœä¸å•çº¿ç¨‹ç¯å¢ƒä¿æŒä¸€è‡´</li>
</ul>
<h2 data-id="heading-7">äºŒã€åŸç†æ·±åº¦å‰–æ</h2>
<h3 data-id="heading-8">2.1 synchronizedåŸç†è¯¦è§£</h3>
<p>synchronizedæ˜¯Javaæä¾›çš„å†…ç½®é”æœºåˆ¶,ç”¨äºè§£å†³å¤šçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«èµ„æºçš„åŒæ­¥é—®é¢˜ã€‚åœ¨JDK 1.6ä¹‹å‰,synchronizedæ˜¯é‡é‡çº§é”,æ€§èƒ½è¾ƒå·®ã€‚JDK 1.6å¯¹synchronizedè¿›è¡Œäº†å¤§é‡ä¼˜åŒ–,å¼•å…¥äº†åå‘é”ã€è½»é‡çº§é”ã€è‡ªæ—‹é”ã€é”æ¶ˆé™¤ã€é”ç²—åŒ–ç­‰æŠ€æœ¯ã€‚</p>
<h4 data-id="heading-9">2.1.1 å¯¹è±¡å¤´ä¸Mark Wordç»“æ„</h4>
<p>åœ¨HotSpotè™šæ‹Ÿæœºä¸­,å¯¹è±¡åœ¨å†…å­˜ä¸­çš„å¸ƒå±€åˆ†ä¸ºä¸‰ä¸ªåŒºåŸŸ:</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Javaå¯¹è±¡å†…å­˜å¸ƒå±€                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  <span class="hljs-number">1</span>. å¯¹è±¡å¤´(Object Header)                        â”‚
â”‚     â”œâ”€ <span class="hljs-selector-tag">Mark</span> Word (<span class="hljs-number">8</span>å­—èŠ‚,<span class="hljs-number">64</span>ä½JVM)                 â”‚
â”‚     â””â”€ Class Pointer (<span class="hljs-number">4</span>/<span class="hljs-number">8</span>å­—èŠ‚,æŒ‡å‘ç±»å…ƒæ•°æ®)       â”‚
â”‚  <span class="hljs-number">2</span>. å®ä¾‹æ•°æ®(Instance Data)                      â”‚
â”‚  <span class="hljs-number">3</span>. å¯¹é½å¡«å……(Padding)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>Mark Word</strong>åœ¨ä¸åŒé”çŠ¶æ€ä¸‹çš„ç»“æ„(64ä½JVM):</p>



























































<table><thead><tr><th>é”çŠ¶æ€</th><th>25bit</th><th>31bit</th><th>1bit</th><th>4bit</th><th>1bit(æ˜¯å¦åå‘é”)</th><th>2bit(é”æ ‡å¿—ä½)</th></tr></thead><tbody><tr><td>æ— é”çŠ¶æ€</td><td>unused</td><td>hashcode</td><td>unused</td><td>age</td><td>0</td><td>01</td></tr><tr><td>åå‘é”</td><td>threadID(54bit)</td><td>epoch(2bit)</td><td>unused</td><td>age</td><td>1</td><td>01</td></tr><tr><td>è½»é‡çº§é”</td><td>æŒ‡å‘æ ˆä¸­Lock Recordçš„æŒ‡é’ˆ(62bit)</td><td/><td/><td/><td/><td>00</td></tr><tr><td>é‡é‡çº§é”</td><td>æŒ‡å‘äº’æ–¥é‡(Monitor)çš„æŒ‡é’ˆ(62bit)</td><td/><td/><td/><td/><td>10</td></tr><tr><td>GCæ ‡è®°</td><td>ç©º</td><td/><td/><td/><td/><td>11</td></tr></tbody></table>
<p><strong>å­—æ®µè¯´æ˜:</strong></p>
<ul>
<li><strong>hashcode</strong>: å¯¹è±¡çš„identity hash code</li>
<li><strong>age</strong>: å¯¹è±¡çš„åˆ†ä»£å¹´é¾„(æœ€å¤§15,è¶…è¿‡15æ™‹å‡è€å¹´ä»£)</li>
<li><strong>threadID</strong>: æŒæœ‰åå‘é”çš„çº¿ç¨‹ID</li>
<li><strong>epoch</strong>: åå‘æ—¶é—´æˆ³,ç”¨äºæ‰¹é‡é‡åå‘</li>
</ul>
<h4 data-id="heading-10">2.1.2 åå‘é”(Biased Locking)</h4>
<p><strong>è®¾è®¡åˆè¡·:</strong></p>
<p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹,é”ä¸å­˜åœ¨ç«äº‰,æ€»æ˜¯ç”±åŒä¸€ä¸ªçº¿ç¨‹å¤šæ¬¡è·å¾—ã€‚ä¸ºäº†å‡å°‘åŒä¸€çº¿ç¨‹è·å–é”çš„ä»£ä»·(CASæ“ä½œä¹Ÿæœ‰å¼€é”€),å¼•å…¥äº†åå‘é”ã€‚</p>
<p><strong>åå‘é”çš„è·å–æµç¨‹:</strong></p>
<pre><code class="hljs language-objectivec" lang="objectivec">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           åå‘é”è·å–æµç¨‹                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

çº¿ç¨‹è®¿é—®åŒæ­¥å—
      â”‚
      â–¼
æ£€æŸ¥Mark Wordæ˜¯å¦ä¸ºå¯åå‘çŠ¶æ€(é”æ ‡å¿—ä½<span class="hljs-number">01</span>,åå‘é”æ ‡å¿—<span class="hljs-number">1</span>)
      â”‚
      â”œâ”€ <span class="hljs-literal">YES</span> â”€â–º æ£€æŸ¥threadIDæ˜¯å¦æŒ‡å‘å½“å‰çº¿ç¨‹
      â”‚           â”‚
      â”‚           â”œâ”€ <span class="hljs-literal">YES</span> â”€â–º ç›´æ¥æ‰§è¡ŒåŒæ­¥å—(æ— éœ€<span class="hljs-built_in">CAS</span>)
      â”‚           â”‚
      â”‚           â””â”€ <span class="hljs-literal">NO</span>  â”€â–º <span class="hljs-built_in">CAS</span>å°†Mark Wordçš„threadIDæ”¹ä¸ºå½“å‰çº¿ç¨‹ID
      â”‚                      â”‚
      â”‚                      â”œâ”€ æˆåŠŸ â”€â–º è·å¾—åå‘é”,æ‰§è¡ŒåŒæ­¥å—
      â”‚                      â”‚
      â”‚                      â””â”€ å¤±è´¥ â”€â–º å‘ç”Ÿç«äº‰,æ’¤é”€åå‘é”,è†¨èƒ€ä¸ºè½»é‡çº§é”
      â”‚
      â””â”€ <span class="hljs-literal">NO</span>  â”€â–º æ£€æŸ¥æ˜¯å¦å…è®¸åå‘
                  â”‚
                  â”œâ”€ å…è®¸ â”€â–º <span class="hljs-built_in">CAS</span>å°è¯•è·å–åå‘é”
                  â”‚
                  â””â”€ ä¸å…è®¸ â”€â–º ç›´æ¥ä½¿ç”¨è½»é‡çº§é”
</code></pre>
<p><strong>åå‘é”çš„æ’¤é”€:</strong></p>
<p>åå‘é”åœ¨ä»¥ä¸‹æƒ…å†µä¸‹ä¼šæ’¤é”€:</p>
<ol>
<li><strong>æœ‰å…¶ä»–çº¿ç¨‹å°è¯•è·å–é”</strong>: å½“å‰æŒæœ‰åå‘é”çš„çº¿ç¨‹Aåœ¨è¿è¡Œ,çº¿ç¨‹Bå°è¯•è·å–è¯¥é”</li>
<li><strong>è°ƒç”¨wait/notifyæ–¹æ³•</strong>: åå‘é”ä¸æ”¯æŒè¿™äº›æ“ä½œ</li>
<li><strong>å¯¹è±¡çš„identityHashCodeè¢«è°ƒç”¨</strong>: Mark Wordéœ€è¦å­˜å‚¨hashcode,æ²¡æœ‰ç©ºé—´å­˜å‚¨threadID</li>
</ol>
<p><strong>æ’¤é”€è¿‡ç¨‹(éœ€è¦ç­‰å¾…å…¨å±€å®‰å…¨ç‚¹ Safepoint):</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ’¤é”€åå‘é”çš„è¿‡ç¨‹(ç®€åŒ–)</span>
<span class="hljs-number">1.</span> æš‚åœæŒæœ‰åå‘é”çš„çº¿ç¨‹(STW - Stop The World)
<span class="hljs-number">2.</span> æ£€æŸ¥æŒæœ‰åå‘é”çš„çº¿ç¨‹æ˜¯å¦è¿˜å­˜æ´»
   - å¦‚æœçº¿ç¨‹å·²ç»é€€å‡ºåŒæ­¥å— â†’ æ’¤é”€åå‘é”,æ¢å¤åˆ°æ— é”çŠ¶æ€
   - å¦‚æœçº¿ç¨‹è¿˜åœ¨åŒæ­¥å—å†… â†’ å‡çº§ä¸ºè½»é‡çº§é”
<span class="hljs-number">3.</span> å”¤é†’æš‚åœçš„çº¿ç¨‹
</code></pre>
<p><strong>æ‰¹é‡é‡åå‘ä¸æ‰¹é‡æ’¤é”€:</strong></p>
<ul>
<li><strong>æ‰¹é‡é‡åå‘</strong>: å½“ä¸€ä¸ªç±»çš„å¯¹è±¡è¢«å¤šä¸ªçº¿ç¨‹è®¿é—®,ä½†ä¸å­˜åœ¨ç«äº‰æ—¶,JVMä¼šå¯¹è¯¥ç±»çš„æ‰€æœ‰å¯¹è±¡è¿›è¡Œæ‰¹é‡é‡åå‘(æ›´æ–°epoch)</li>
<li><strong>æ‰¹é‡æ’¤é”€</strong>: å½“æ’¤é”€åå‘é”çš„æ¬¡æ•°è¶…è¿‡é˜ˆå€¼(é»˜è®¤40æ¬¡),JVMä¼šè®¤ä¸ºè¯¥ç±»ä¸é€‚åˆåå‘é”,ç›´æ¥æ’¤é”€è¯¥ç±»æ‰€æœ‰å¯¹è±¡çš„åå‘é”</li>
</ul>
<p><strong>JDK 15åé»˜è®¤ç¦ç”¨åå‘é”çš„åŸå› :</strong></p>
<ol>
<li>åå‘é”çš„æ’¤é”€éœ€è¦è¿›å…¥å®‰å…¨ç‚¹(STW),åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹åè€Œé™ä½æ€§èƒ½</li>
<li>ç°ä»£åº”ç”¨ç¨‹åºä¸­,çœŸæ­£æ— ç«äº‰çš„åœºæ™¯è¶Šæ¥è¶Šå°‘</li>
<li>JITç¼–è¯‘å™¨å’Œé”æ¶ˆé™¤æŠ€æœ¯çš„è¿›æ­¥,é™ä½äº†åå‘é”çš„æ”¶ç›Š</li>
</ol>
<h4 data-id="heading-11">2.1.3 è½»é‡çº§é”(Lightweight Locking)</h4>
<p><strong>é€‚ç”¨åœºæ™¯:</strong></p>
<p>çº¿ç¨‹äº¤æ›¿æ‰§è¡ŒåŒæ­¥å—,ä¸å­˜åœ¨çœŸæ­£çš„ç«äº‰ã€‚é€šè¿‡CASæ“ä½œé¿å…ä½¿ç”¨äº’æ–¥é‡(Mutex),å‡å°‘æ“ä½œç³»ç»Ÿå±‚é¢çš„çº¿ç¨‹é˜»å¡ã€‚</p>
<p><strong>è½»é‡çº§é”çš„è·å–æµç¨‹:</strong></p>
<pre><code class="hljs language-less" lang="less">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           è½»é‡çº§é”è·å–æµç¨‹                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<span class="hljs-number">1</span>. çº¿ç¨‹è¿›å…¥åŒæ­¥å—å‰,åœ¨æ ˆå¸§ä¸­åˆ›å»º<span class="hljs-selector-tag">Lock</span> <span class="hljs-selector-tag">Record</span>
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  <span class="hljs-selector-tag">Lock</span> <span class="hljs-selector-tag">Record</span> â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ <span class="hljs-selector-tag">Displaced</span>    â”‚  â† å­˜å‚¨å¯¹è±¡åŸå§‹çš„<span class="hljs-selector-tag">Mark</span> <span class="hljs-selector-tag">Word</span>
   â”‚ <span class="hljs-selector-tag">Mark</span> <span class="hljs-selector-tag">Word</span>    â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ <span class="hljs-selector-tag">Owner</span>æŒ‡é’ˆ    â”‚  â†’ æŒ‡å‘é”å¯¹è±¡
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<span class="hljs-number">2</span>. <span class="hljs-selector-tag">CAS</span>å°†å¯¹è±¡çš„<span class="hljs-selector-tag">Mark</span> <span class="hljs-selector-tag">Word</span>æ›¿æ¢ä¸ºæŒ‡å‘<span class="hljs-selector-tag">Lock</span> <span class="hljs-selector-tag">Record</span>çš„æŒ‡é’ˆ

   å¯¹è±¡<span class="hljs-selector-tag">Mark</span> <span class="hljs-selector-tag">Word</span>:  <span class="hljs-selector-attr">[Lock RecordæŒ‡é’ˆ | 00]</span>
                             â”‚
                             â””â”€â”€â”€â”€â”€â–º æŒ‡å‘æ ˆå¸§ä¸­çš„<span class="hljs-selector-tag">Lock</span> <span class="hljs-selector-tag">Record</span>

<span class="hljs-number">3</span>. <span class="hljs-selector-tag">CAS</span>æ›¿æ¢ç»“æœ:
   â”œâ”€ æˆåŠŸ â”€â–º è·å¾—è½»é‡çº§é”,æ‰§è¡ŒåŒæ­¥å—
   â”‚
   â””â”€ å¤±è´¥ â”€â–º æ£€æŸ¥<span class="hljs-selector-tag">Mark</span> <span class="hljs-selector-tag">Word</span>æ˜¯å¦æŒ‡å‘å½“å‰çº¿ç¨‹çš„æ ˆå¸§
               â”‚
               â”œâ”€ æ˜¯ â”€â–º é”é‡å…¥,å†æ¬¡åˆ›å»º<span class="hljs-selector-tag">Lock</span> <span class="hljs-selector-tag">Record</span>
               â”‚
               â””â”€ å¦ â”€â–º å‘ç”Ÿç«äº‰,è‡ªæ—‹å°è¯•è·å–é”
                          â”‚
                          â””â”€ è‡ªæ—‹æ¬¡æ•°è¶…è¿‡é˜ˆå€¼ â”€â–º è†¨èƒ€ä¸ºé‡é‡çº§é”
</code></pre>
<p><strong>è‡ªæ—‹ä¼˜åŒ–(Spin Lock):</strong></p>
<p>å½“çº¿ç¨‹è·å–è½»é‡çº§é”å¤±è´¥æ—¶,ä¸ç«‹å³é˜»å¡,è€Œæ˜¯æ‰§è¡Œå¿™å¾ªç¯(è‡ªæ—‹)ç­‰å¾…,é¿å…ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„åˆ‡æ¢ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è‡ªæ—‹ç­‰å¾…ç¤ºä¾‹(ä¼ªä»£ç )</span>
<span class="hljs-type">int</span> <span class="hljs-variable">spinCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">while</span> (!tryAcquireLock()) {
    spinCount++;
    <span class="hljs-keyword">if</span> (spinCount &gt; MAX_SPIN_COUNT) {
        <span class="hljs-comment">// è‡ªæ—‹æ¬¡æ•°è¶…è¿‡é˜ˆå€¼,è†¨èƒ€ä¸ºé‡é‡çº§é”</span>
        inflateToHeavyweightLock();
        <span class="hljs-keyword">break</span>;
    }
    <span class="hljs-comment">// CPUç©ºè½¬,ç­‰å¾…é”é‡Šæ”¾</span>
    <span class="hljs-comment">// å¯èƒ½æ‰§è¡ŒPAUSEæŒ‡ä»¤,é™ä½CPUåŠŸè€—</span>
}
</code></pre>
<p><strong>è‡ªé€‚åº”è‡ªæ—‹(Adaptive Spinning):</strong></p>
<p>JDK 1.6å¼•å…¥,è‡ªæ—‹æ¬¡æ•°ä¸å†å›ºå®š:</p>
<ul>
<li>å¦‚æœä¸Šä¸€æ¬¡è‡ªæ—‹æˆåŠŸè·å¾—é”,å…è®¸æ›´é•¿çš„è‡ªæ—‹æ—¶é—´</li>
<li>å¦‚æœä¸Šä¸€æ¬¡è‡ªæ—‹å¤±è´¥,ç¼©çŸ­è‡ªæ—‹æ—¶é—´æˆ–ç›´æ¥é˜»å¡</li>
</ul>
<p><strong>è½»é‡çº§é”çš„é‡Šæ”¾:</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-number">1.</span> CASå°†Lock Recordä¸­çš„Displaced Mark Wordæ›¿æ¢å›å¯¹è±¡å¤´
<span class="hljs-number">2.</span> CASæ›¿æ¢ç»“æœ:
   â”œâ”€ æˆåŠŸ â”€â–º é‡Šæ”¾é”æˆåŠŸ
   â””â”€ å¤±è´¥ â”€â–º è¯´æ˜æœ‰å…¶ä»–çº¿ç¨‹åœ¨ç«äº‰,é”å·²è†¨èƒ€ä¸ºé‡é‡çº§é”,éœ€è¦å”¤é†’é˜»å¡çš„çº¿ç¨‹
</code></pre>
<h4 data-id="heading-12">2.1.4 é‡é‡çº§é”(Heavyweight Locking)</h4>
<p>å½“è½»é‡çº§é”è‡ªæ—‹ä¸€å®šæ¬¡æ•°åä»æœªè·å–åˆ°é”,é”ä¼šè†¨èƒ€ä¸ºé‡é‡çº§é”ã€‚é‡é‡çº§é”ä¾èµ–æ“ä½œç³»ç»Ÿçš„Mutex Lock(äº’æ–¥é‡)å®ç°,ä¼šå¯¼è‡´çº¿ç¨‹åœ¨ç”¨æˆ·æ€å’Œå†…æ ¸æ€ä¹‹é—´åˆ‡æ¢ã€‚</p>
<p><strong>Monitorå¯¹è±¡ç»“æ„:</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span>              <span class="hljs-string">ObjectMonitorç»“æ„</span>                    <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-attr">_owner:</span>      <span class="hljs-string">æŒæœ‰é”çš„çº¿ç¨‹</span>                        <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-attr">_EntryList:</span>  <span class="hljs-string">ç­‰å¾…é”çš„çº¿ç¨‹é˜Ÿåˆ—(BLOCKEDçŠ¶æ€)</span>        <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-attr">_WaitSet:</span>    <span class="hljs-string">è°ƒç”¨wait()æ–¹æ³•çš„çº¿ç¨‹é˜Ÿåˆ—(WAITINGçŠ¶æ€)â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-attr">_count:</span>      <span class="hljs-string">é”çš„é‡å…¥æ¬¡æ•°</span>                        <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-attr">_recursions:</span> <span class="hljs-string">é‡å…¥è®¡æ•°å™¨</span>                          <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="hljs-string">é‡é‡çº§é”çš„çŠ¶æ€è½¬æ¢:</span>

           <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
           <span class="hljs-string">â”‚</span>  <span class="hljs-string">Thread1</span> <span class="hljs-string">â”‚</span> <span class="hljs-string">(è·å¾—é”,_owneræŒ‡å‘Thread1)</span>
           <span class="hljs-string">â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜</span>
                <span class="hljs-string">â”‚</span> <span class="hljs-string">synchronized(obj)</span>
                <span class="hljs-string">â–¼</span>
          <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
          <span class="hljs-string">â”‚</span> <span class="hljs-string">_owner</span>   <span class="hljs-string">â”‚</span> <span class="hljs-string">â”€â”€â”€â”€â–º</span> <span class="hljs-string">Thread1</span>
          <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

          <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
          <span class="hljs-string">â”‚_EntryListâ”‚</span> <span class="hljs-string">â—„â”€â”€â”€â”€</span> <span class="hljs-string">Thread2,</span> <span class="hljs-string">Thread3</span> <span class="hljs-string">(å°è¯•è·å–é”,è¿›å…¥BLOCKEDçŠ¶æ€)</span>
          <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

          <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
          <span class="hljs-string">â”‚</span> <span class="hljs-string">_WaitSet</span> <span class="hljs-string">â”‚</span> <span class="hljs-string">â—„â”€â”€â”€â”€</span> <span class="hljs-string">Thread4</span> <span class="hljs-string">(è°ƒç”¨wait(),è¿›å…¥WAITINGçŠ¶æ€)</span>
          <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre>
<p><strong>é‡é‡çº§é”çš„è·å–ä¸é‡Šæ”¾æµç¨‹:</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">è·å–æµç¨‹:
<span class="hljs-bullet">1.</span> çº¿ç¨‹å°è¯•è·å–é”(CASä¿®æ”¹<span class="hljs-emphasis">_ownerä¸ºå½“å‰çº¿ç¨‹)
2. å¦‚æœ_</span>ownerä¸ºç©º,è·å–æˆåŠŸ
<span class="hljs-bullet">3.</span> å¦‚æœ<span class="hljs-emphasis">_owneræŒ‡å‘å½“å‰çº¿ç¨‹,é”é‡å…¥(_</span>count++)
<span class="hljs-bullet">4.</span> å¦‚æœ<span class="hljs-emphasis">_owneræŒ‡å‘å…¶ä»–çº¿ç¨‹,è¿›å…¥_</span>EntryList,çº¿ç¨‹é˜»å¡(BLOCKEDçŠ¶æ€)

é‡Šæ”¾æµç¨‹:
<span class="hljs-bullet">1.</span> <span class="hljs-emphasis">_count-- (å¤„ç†é”é‡å…¥)
2. å¦‚æœ_</span>count == 0,é‡Šæ”¾é”(<span class="hljs-emphasis">_ownerç½®ä¸ºNULL)
3. ä»_</span>EntryListä¸­å”¤é†’ä¸€ä¸ªçº¿ç¨‹(notify)
<span class="hljs-bullet">4.</span> è¢«å”¤é†’çš„çº¿ç¨‹ä»BLOCKEDçŠ¶æ€è½¬ä¸ºRUNNABLEçŠ¶æ€,é‡æ–°ç«äº‰é”
</code></pre>
<h4 data-id="heading-13">2.1.5 é”å‡çº§çš„å®Œæ•´è¿‡ç¨‹</h4>
<pre><code class="hljs language-makefile" lang="makefile">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    synchronizedé”å‡çº§è¿‡ç¨‹                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  æ— é”çŠ¶æ€           åå‘é”             è½»é‡çº§é”           é‡é‡çº§é”
    â”‚                 â”‚                   â”‚                 â”‚
    â”‚  CASè·å–        â”‚  æœ‰å…¶ä»–çº¿ç¨‹       â”‚   è‡ªæ—‹å¤±è´¥      â”‚
    â”‚  åå‘é”         â”‚  ç«äº‰é”           â”‚   æˆ–ç«äº‰æ¿€çƒˆ    â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                 â”‚                   â”‚                 â”‚
<span class="hljs-section">é”æ ‡å¿—ä½: 01      é”æ ‡å¿—ä½: 01        é”æ ‡å¿—ä½: 00      é”æ ‡å¿—ä½: 10</span>
<span class="hljs-section">åå‘æ ‡å¿—: 0      åå‘æ ‡å¿—: 1</span>
<span class="hljs-section">æ€§èƒ½: æœ€å¿«        æ€§èƒ½: å¿«            æ€§èƒ½: è¾ƒå¿«         æ€§èƒ½: æ…¢</span>
<span class="hljs-section">å¼€é”€: æ—           å¼€é”€: CAS          å¼€é”€: CAS+è‡ªæ—‹     å¼€é”€: ç”¨æˆ·æ€/å†…æ ¸æ€åˆ‡æ¢</span>
<span class="hljs-section">é€‚ç”¨: æ— ç«äº‰      é€‚ç”¨: å•çº¿ç¨‹åå¤   é€‚ç”¨: äº¤æ›¿æ‰§è¡Œ     é€‚ç”¨: é«˜ç«äº‰</span>
                  è·å–åŒä¸€æŠŠé”       å°‘é‡ç«äº‰           å¤šçº¿ç¨‹ç«äº‰æ¿€çƒˆ
</code></pre>
<p><strong>æ€§èƒ½å¯¹æ¯”:</strong></p>





























<table><thead><tr><th>é”ç±»å‹</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>åå‘é”</td><td>åŠ é”è§£é”æ— éœ€é¢å¤–æ¶ˆè€—</td><td>æœ‰çº¿ç¨‹ç«äº‰ä¼šå¸¦æ¥é¢å¤–çš„é”æ’¤é”€æ¶ˆè€—</td><td>åªæœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥å—</td></tr><tr><td>è½»é‡çº§é”</td><td>ç«äº‰çº¿ç¨‹ä¸é˜»å¡,å“åº”é€Ÿåº¦å¿«</td><td>è‡ªæ—‹æ¶ˆè€—CPU</td><td>çº¿ç¨‹äº¤æ›¿æ‰§è¡ŒåŒæ­¥å—,ç«äº‰ä¸æ¿€çƒˆ</td></tr><tr><td>é‡é‡çº§é”</td><td>ä¸æ¶ˆè€—CPU(çº¿ç¨‹é˜»å¡)</td><td>çº¿ç¨‹é˜»å¡,å“åº”æ—¶é—´æ…¢</td><td>ç«äº‰æ¿€çƒˆ,åŒæ­¥å—æ‰§è¡Œæ—¶é—´é•¿</td></tr></tbody></table>
<h3 data-id="heading-14">2.2 volatileå…³é”®å­—ä¸Javaå†…å­˜æ¨¡å‹(JMM)</h3>
<h4 data-id="heading-15">2.2.1 Javaå†…å­˜æ¨¡å‹(JMM)åŸºç¡€</h4>
<p>Javaå†…å­˜æ¨¡å‹(Java Memory Model)å®šä¹‰äº†çº¿ç¨‹å’Œä¸»å†…å­˜ä¹‹é—´çš„æŠ½è±¡å…³ç³»,è§„å®šäº†ä¸€ä¸ªçº¿ç¨‹å¦‚ä½•ä»¥åŠä½•æ—¶å¯ä»¥çœ‹åˆ°å…¶ä»–çº¿ç¨‹ä¿®æ”¹çš„å…±äº«å˜é‡çš„å€¼ã€‚</p>
<p><strong>JMMæŠ½è±¡ç»“æ„:</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1842820c737b41d690cfcaafb20cd45c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54Sh6YeP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766738181&amp;x-signature=El1410hVJiPnFH%2Fc73BArFoC3js%3D" alt="04-java-memory-model.svg" loading="lazy"/></p>
<p><strong>å†…å­˜äº¤äº’æ“ä½œ(8ç§åŸå­æ“ä½œ):</strong></p>
<ol>
<li><strong>lock(é”å®š)</strong>: ä½œç”¨äºä¸»å†…å­˜çš„å˜é‡,æ ‡è¯†ä¸ºçº¿ç¨‹ç‹¬å çŠ¶æ€</li>
<li><strong>unlock(è§£é”)</strong>: ä½œç”¨äºä¸»å†…å­˜çš„å˜é‡,é‡Šæ”¾ç‹¬å çŠ¶æ€</li>
<li><strong>read(è¯»å–)</strong>: ä½œç”¨äºä¸»å†…å­˜çš„å˜é‡,æŠŠå€¼ä¼ è¾“åˆ°å·¥ä½œå†…å­˜</li>
<li><strong>load(è½½å…¥)</strong>: ä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡,æŠŠreadçš„å€¼æ”¾å…¥å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬</li>
<li><strong>use(ä½¿ç”¨)</strong>: ä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡,æŠŠå€¼ä¼ é€’ç»™æ‰§è¡Œå¼•æ“</li>
<li><strong>assign(èµ‹å€¼)</strong>: ä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡,æŠŠæ‰§è¡Œå¼•æ“çš„å€¼èµ‹ç»™å·¥ä½œå†…å­˜çš„å˜é‡</li>
<li><strong>store(å­˜å‚¨)</strong>: ä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡,æŠŠå€¼ä¼ é€åˆ°ä¸»å†…å­˜</li>
<li><strong>write(å†™å…¥)</strong>: ä½œç”¨äºä¸»å†…å­˜çš„å˜é‡,æŠŠstoreçš„å€¼å†™å…¥ä¸»å†…å­˜çš„å˜é‡</li>
</ol>
<p><strong>happens-beforeåŸåˆ™(8å¤§è§„åˆ™):</strong></p>
<p>happens-beforeåŸåˆ™å®šä¹‰äº†æ“ä½œä¹‹é—´çš„ååºå…³ç³»,å¦‚æœæ“ä½œA happens-beforeæ“ä½œB,é‚£ä¹ˆAçš„æ‰§è¡Œç»“æœå¯¹Bå¯è§ã€‚</p>
<ol>
<li><strong>ç¨‹åºæ¬¡åºè§„åˆ™</strong>: å•çº¿ç¨‹å†…,æŒ‰ç…§ä»£ç é¡ºåºæ‰§è¡Œ</li>
<li><strong>ç›‘è§†å™¨é”è§„åˆ™</strong>: unlockæ“ä½œ happens-before åç»­å¯¹åŒä¸€ä¸ªé”çš„lockæ“ä½œ</li>
<li><strong>volatileå˜é‡è§„åˆ™</strong>: volatileå†™æ“ä½œ happens-before åç»­å¯¹è¯¥å˜é‡çš„è¯»æ“ä½œ</li>
<li><strong>çº¿ç¨‹å¯åŠ¨è§„åˆ™</strong>: Thread.start() happens-before è¯¥çº¿ç¨‹çš„æ¯ä¸€ä¸ªåŠ¨ä½œ</li>
<li><strong>çº¿ç¨‹ç»ˆæ­¢è§„åˆ™</strong>: çº¿ç¨‹çš„æ‰€æœ‰æ“ä½œ happens-before å…¶ä»–çº¿ç¨‹æ£€æµ‹åˆ°è¯¥çº¿ç¨‹ç»ˆæ­¢(Thread.join()è¿”å›ã€Thread.isAlive()è¿”å›false)</li>
<li><strong>çº¿ç¨‹ä¸­æ–­è§„åˆ™</strong>: çº¿ç¨‹interrupt()æ–¹æ³•çš„è°ƒç”¨ happens-before è¢«ä¸­æ–­çº¿ç¨‹æ£€æµ‹åˆ°ä¸­æ–­äº‹ä»¶å‘ç”Ÿ</li>
<li><strong>å¯¹è±¡ç»ˆç»“è§„åˆ™</strong>: å¯¹è±¡çš„æ„é€ å‡½æ•°æ‰§è¡Œç»“æŸ happens-before finalize()æ–¹æ³•</li>
<li><strong>ä¼ é€’æ€§</strong>: å¦‚æœA happens-before B,B happens-before C,é‚£ä¹ˆA happens-before C</li>
</ol>
<h4 data-id="heading-16">2.2.2 volatileçš„ä¸¤å¤§ç‰¹æ€§</h4>
<p><strong>1. å¯è§æ€§ä¿è¯</strong></p>
<p>å½“ä¸€ä¸ªå˜é‡è¢«å£°æ˜ä¸ºvolatileæ—¶,å¯¹è¯¥å˜é‡çš„å†™æ“ä½œä¼šç«‹å³åˆ·æ–°åˆ°ä¸»å†…å­˜,å¯¹è¯¥å˜é‡çš„è¯»æ“ä½œä¼šä»ä¸»å†…å­˜ä¸­è¯»å–æœ€æ–°å€¼ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VolatileVisibilityExample</span> {
    <span class="hljs-comment">// ä¸ä½¿ç”¨volatile,å¯èƒ½å¯¼è‡´å¯è§æ€§é—®é¢˜</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">flag</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

    <span class="hljs-comment">// ä½¿ç”¨volatile,ä¿è¯å¯è§æ€§</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">volatileFlag</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-comment">// ç¤ºä¾‹1: ä¸ä½¿ç”¨volatileçš„é—®é¢˜</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">while</span> (!flag) {
                <span class="hljs-comment">// çº¿ç¨‹å¯èƒ½æ°¸è¿œæ— æ³•çœ‹åˆ°flagçš„å˜åŒ–</span>
                <span class="hljs-comment">// JITç¼–è¯‘å™¨å¯èƒ½å°†flagç¼“å­˜åˆ°å¯„å­˜å™¨</span>
            }
            System.out.println(<span class="hljs-string">"çº¿ç¨‹1: flagå˜ä¸ºtrue"</span>);
        }).start();

        Thread.sleep(<span class="hljs-number">1000</span>);
        flag = <span class="hljs-literal">true</span>; <span class="hljs-comment">// ä¸»çº¿ç¨‹ä¿®æ”¹flag</span>
        System.out.println(<span class="hljs-string">"ä¸»çº¿ç¨‹: å·²å°†flagè®¾ç½®ä¸ºtrue"</span>);

        <span class="hljs-comment">// ç¤ºä¾‹2: ä½¿ç”¨volatileä¿è¯å¯è§æ€§</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">while</span> (!volatileFlag) {
                <span class="hljs-comment">// volatileä¿è¯èƒ½ç«‹å³çœ‹åˆ°volatileFlagçš„å˜åŒ–</span>
            }
            System.out.println(<span class="hljs-string">"çº¿ç¨‹2: volatileFlagå˜ä¸ºtrue"</span>);
        }).start();

        Thread.sleep(<span class="hljs-number">1000</span>);
        volatileFlag = <span class="hljs-literal">true</span>; <span class="hljs-comment">// ä¸»çº¿ç¨‹ä¿®æ”¹volatileFlag</span>
        System.out.println(<span class="hljs-string">"ä¸»çº¿ç¨‹: å·²å°†volatileFlagè®¾ç½®ä¸ºtrue"</span>);
    }
}
</code></pre>
<p><strong>2. æœ‰åºæ€§ä¿è¯(ç¦æ­¢æŒ‡ä»¤é‡æ’åº)</strong></p>
<p>volatileé€šè¿‡å†…å­˜å±éšœ(Memory Barrier)ç¦æ­¢ç‰¹å®šç±»å‹çš„æŒ‡ä»¤é‡æ’åºã€‚</p>
<p><strong>å†…å­˜å±éšœçš„å››ç§ç±»å‹:</strong></p>






























<table><thead><tr><th>å±éšœç±»å‹</th><th>æŒ‡ä»¤ç¤ºä¾‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>LoadLoadå±éšœ</td><td>Load1; LoadLoad; Load2</td><td>ç¡®ä¿Load1çš„æ•°æ®è£…è½½å…ˆäºLoad2åŠåç»­è£…è½½æŒ‡ä»¤</td></tr><tr><td>StoreStoreå±éšœ</td><td>Store1; StoreStore; Store2</td><td>ç¡®ä¿Store1çš„æ•°æ®åˆ·æ–°åˆ°ä¸»å†…å­˜å…ˆäºStore2åŠåç»­å­˜å‚¨æŒ‡ä»¤</td></tr><tr><td>LoadStoreå±éšœ</td><td>Load1; LoadStore; Store2</td><td>ç¡®ä¿Load1çš„æ•°æ®è£…è½½å…ˆäºStore2åŠåç»­å­˜å‚¨æŒ‡ä»¤</td></tr><tr><td>StoreLoadå±éšœ</td><td>Store1; StoreLoad; Load2</td><td>ç¡®ä¿Store1çš„æ•°æ®åˆ·æ–°åˆ°ä¸»å†…å­˜å…ˆäºLoad2åŠåç»­è£…è½½æŒ‡ä»¤(å¼€é”€æœ€å¤§)</td></tr></tbody></table>
<p><strong>volatileå†™æ“ä½œæ’å…¥çš„å†…å­˜å±éšœ:</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">volatile</span>å†™æ“ä½œ:
    StoreStoreå±éšœ    â† ç¦æ­¢ä¸Šé¢çš„æ™®é€šå†™ä¸<span class="hljs-keyword">volatile</span>å†™é‡æ’åº
    <span class="hljs-keyword">volatile</span> write
    StoreLoadå±éšœ     â† ç¦æ­¢<span class="hljs-keyword">volatile</span>å†™ä¸ä¸‹é¢å¯èƒ½çš„<span class="hljs-keyword">volatile</span>è¯»/å†™é‡æ’åº
</code></pre>
<p><strong>volatileè¯»æ“ä½œæ’å…¥çš„å†…å­˜å±éšœ:</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">volatile</span>è¯»æ“ä½œ:
    <span class="hljs-keyword">volatile</span> read
    LoadLoadå±éšœ      â† ç¦æ­¢ä¸‹é¢çš„æ™®é€šè¯»ä¸<span class="hljs-keyword">volatile</span>è¯»é‡æ’åº
    LoadStoreå±éšœ     â† ç¦æ­¢ä¸‹é¢çš„æ™®é€šå†™ä¸<span class="hljs-keyword">volatile</span>è¯»é‡æ’åº
</code></pre>
<p><strong>ç»å…¸æ¡ˆä¾‹:DCLåŒé‡æ£€æŸ¥é”å®šæ¨¡å¼</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Singleton</span> {
    <span class="hljs-comment">// å¿…é¡»ä½¿ç”¨volatile,é˜²æ­¢æŒ‡ä»¤é‡æ’åº</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> Singleton instance;

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Singleton</span><span class="hljs-params">()</span> {}

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {  <span class="hljs-comment">// ç¬¬ä¸€æ¬¡æ£€æŸ¥(ä¸åŠ é”,æé«˜æ€§èƒ½)</span>
            <span class="hljs-keyword">synchronized</span> (Singleton.class) {  <span class="hljs-comment">// åŠ é”</span>
                <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) {  <span class="hljs-comment">// ç¬¬äºŒæ¬¡æ£€æŸ¥(é˜²æ­¢å¤šæ¬¡åˆ›å»º)</span>
                    instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();  <span class="hljs-comment">// â† å…³é”®ä»£ç </span>
                }
            }
        }
        <span class="hljs-keyword">return</span> instance;
    }
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆå¿…é¡»ä½¿ç”¨volatile?</strong></p>
<p><code>instance = new Singleton()</code>å®é™…åŒ…å«ä¸‰ä¸ªæ­¥éª¤:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-number">1.</span> memory = allocate();    <span class="hljs-comment">// åˆ†é…å¯¹è±¡å†…å­˜ç©ºé—´</span>
<span class="hljs-number">2.</span> ctorInstance(memory);   <span class="hljs-comment">// åˆå§‹åŒ–å¯¹è±¡</span>
<span class="hljs-number">3.</span> instance = memory;      <span class="hljs-comment">// è®¾ç½®instanceæŒ‡å‘åˆšåˆ†é…çš„å†…å­˜åœ°å€</span>
</code></pre>
<p>ç”±äºæŒ‡ä»¤é‡æ’åº,å¯èƒ½å˜æˆ:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-number">1.</span> memory = allocate();    <span class="hljs-comment">// åˆ†é…å¯¹è±¡å†…å­˜ç©ºé—´</span>
<span class="hljs-number">3.</span> instance = memory;      <span class="hljs-comment">// è®¾ç½®instanceæŒ‡å‘åˆšåˆ†é…çš„å†…å­˜åœ°å€(æ­¤æ—¶å¯¹è±¡è¿˜æœªåˆå§‹åŒ–!)</span>
<span class="hljs-number">2.</span> ctorInstance(memory);   <span class="hljs-comment">// åˆå§‹åŒ–å¯¹è±¡</span>
</code></pre>
<p><strong>é—®é¢˜åœºæ™¯:</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">æ—¶é—´çº¿:</span>
<span class="hljs-attr">T1:</span> <span class="hljs-string">çº¿ç¨‹Aæ‰§è¡Œåˆ°æ­¥éª¤3,instanceä¸ä¸ºnull,ä½†å¯¹è±¡è¿˜æœªåˆå§‹åŒ–</span>
<span class="hljs-attr">T2:</span> <span class="hljs-string">çº¿ç¨‹Bæ‰§è¡Œç¬¬ä¸€æ¬¡æ£€æŸ¥,å‘ç°instance</span> <span class="hljs-type">!=</span> <span class="hljs-literal">null</span><span class="hljs-string">,ç›´æ¥è¿”å›instance</span>
<span class="hljs-attr">T3:</span> <span class="hljs-string">çº¿ç¨‹Bä½¿ç”¨instanceè®¿é—®å¯¹è±¡å±æ€§,ç©ºæŒ‡é’ˆå¼‚å¸¸æˆ–æ•°æ®é”™è¯¯!</span>
</code></pre>
<p>ä½¿ç”¨volatileç¦æ­¢æŒ‡ä»¤é‡æ’åºå,ä¿è¯æ­¥éª¤2ä¸€å®šåœ¨æ­¥éª¤3ä¹‹å‰æ‰§è¡Œã€‚</p>
<h4 data-id="heading-17">2.2.3 volatile vs synchronizedå¯¹æ¯”</h4>













































<table><thead><tr><th>ç‰¹æ€§</th><th>volatile</th><th>synchronized</th></tr></thead><tbody><tr><td>åŸå­æ€§</td><td>âŒ ä¸ä¿è¯(ä»…ä¿è¯å•æ¬¡è¯»/å†™çš„åŸå­æ€§)</td><td>âœ… ä¿è¯(ä¸´ç•ŒåŒºå†…çš„æ“ä½œæ˜¯åŸå­çš„)</td></tr><tr><td>å¯è§æ€§</td><td>âœ… ä¿è¯</td><td>âœ… ä¿è¯</td></tr><tr><td>æœ‰åºæ€§</td><td>âœ… ä¿è¯(ç¦æ­¢æŒ‡ä»¤é‡æ’åº)</td><td>âœ… ä¿è¯(åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ)</td></tr><tr><td>é˜»å¡æ€§</td><td>âŒ ä¸é˜»å¡</td><td>âœ… å¯èƒ½é˜»å¡(é‡é‡çº§é”)</td></tr><tr><td>é€‚ç”¨èŒƒå›´</td><td>åªèƒ½ä¿®é¥°å˜é‡</td><td>å¯ä»¥ä¿®é¥°æ–¹æ³•ã€ä»£ç å—</td></tr><tr><td>æ€§èƒ½</td><td>é«˜(åªæ’å…¥å†…å­˜å±éšœ)</td><td>è¾ƒä½(å¯èƒ½æ¶‰åŠé”ç«äº‰å’Œä¸Šä¸‹æ–‡åˆ‡æ¢)</td></tr><tr><td>ä½¿ç”¨åœºæ™¯</td><td>çŠ¶æ€æ ‡å¿—ã€ä¸€æ¬¡æ€§å®‰å…¨å‘å¸ƒ</td><td>å¤åˆæ“ä½œã€ä¸´ç•ŒåŒºä¿æŠ¤</td></tr></tbody></table>
<p><strong>ä½¿ç”¨åœºæ™¯é€‰æ‹©:</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… é€‚åˆä½¿ç”¨volatileçš„åœºæ™¯</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VolatileSuitableCase</span> {
    <span class="hljs-comment">// åœºæ™¯1: çŠ¶æ€æ ‡å¿—</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">shutdownRequested</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shutdown</span><span class="hljs-params">()</span> {
        shutdownRequested = <span class="hljs-literal">true</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doWork</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">while</span> (!shutdownRequested) {
            <span class="hljs-comment">// æ‰§è¡Œä»»åŠ¡</span>
        }
    }

    <span class="hljs-comment">// åœºæ™¯2: ä¸€æ¬¡æ€§å®‰å…¨å‘å¸ƒ(é…åˆDCL)</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> Singleton instance;
}

<span class="hljs-comment">// âŒ ä¸é€‚åˆä½¿ç”¨volatileçš„åœºæ™¯(éœ€è¦ä½¿ç”¨synchronized)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VolatileNotSuitableCase</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

    <span class="hljs-comment">// âŒ é”™è¯¯:volatileä¸èƒ½ä¿è¯count++çš„åŸå­æ€§</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        count++;  <span class="hljs-comment">// å®é™…æ˜¯ä¸‰ä¸ªæ“ä½œ: è¯»å– -&gt; åŠ 1 -&gt; å†™å›</span>
    }

    <span class="hljs-comment">// âœ… æ­£ç¡®:ä½¿ç”¨synchronizedä¿è¯åŸå­æ€§</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">incrementCorrect</span><span class="hljs-params">()</span> {
        count++;
    }
}
</code></pre>
<h3 data-id="heading-18">2.3 çº¿ç¨‹é—´é€šä¿¡æœºåˆ¶</h3>
<h4 data-id="heading-19">2.3.1 wait/notify/notifyAllæœºåˆ¶</h4>
<p><strong>æ ¸å¿ƒæ–¹æ³•:</strong></p>
<ul>
<li><code>Object.wait()</code>: é‡Šæ”¾å½“å‰æŒæœ‰çš„é”,è¿›å…¥å¯¹è±¡çš„ç­‰å¾…é˜Ÿåˆ—(WaitSet),çº¿ç¨‹çŠ¶æ€å˜ä¸ºWAITING</li>
<li><code>Object.wait(long timeout)</code>: é™æ—¶ç­‰å¾…,è¶…æ—¶åè‡ªåŠ¨å”¤é†’,çº¿ç¨‹çŠ¶æ€å˜ä¸ºTIMED_WAITING</li>
<li><code>Object.notify()</code>: éšæœºå”¤é†’ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªçº¿ç¨‹,è¢«å”¤é†’çš„çº¿ç¨‹ä»WAITINGçŠ¶æ€è½¬ä¸ºBLOCKEDçŠ¶æ€,é‡æ–°ç«äº‰é”</li>
<li><code>Object.notifyAll()</code>: å”¤é†’ç­‰å¾…é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰çº¿ç¨‹</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆå¿…é¡»åœ¨synchronizedå—ä¸­ä½¿ç”¨?</strong></p>
<ol>
<li><strong>é˜²æ­¢ä¸¢å¤±å”¤é†’</strong>: å¦‚æœwait()ä¸åœ¨synchronizedå—ä¸­,å¯èƒ½åœ¨è°ƒç”¨wait()ä¹‹å‰,notify()å·²ç»è¢«è°ƒç”¨,å¯¼è‡´çº¿ç¨‹æ°¸ä¹…ç­‰å¾…</li>
<li><strong>ä¿è¯åŸå­æ€§</strong>: wait/notifyæ“ä½œé€šå¸¸ä¼´éšç€å¯¹å…±äº«å˜é‡çš„åˆ¤æ–­å’Œä¿®æ”¹,éœ€è¦åŒæ­¥ä¿æŠ¤</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é”™è¯¯ç¤ºä¾‹:ä¸åœ¨synchronizedå—ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WrongUsage</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">wrongWait</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        lock.wait();  <span class="hljs-comment">// IllegalMonitorStateException: æœªæŒæœ‰é”</span>
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">wrongNotify</span><span class="hljs-params">()</span> {
        lock.notify();  <span class="hljs-comment">// IllegalMonitorStateException: æœªæŒæœ‰é”</span>
    }
}

<span class="hljs-comment">// âœ… æ­£ç¡®ç¤ºä¾‹:åœ¨synchronizedå—ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CorrectUsage</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">correctWait</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">synchronized</span> (lock) {
            lock.wait();  <span class="hljs-comment">// æ­£ç¡®:æŒæœ‰é”</span>
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">correctNotify</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (lock) {
            lock.notify();  <span class="hljs-comment">// æ­£ç¡®:æŒæœ‰é”</span>
        }
    }
}
</code></pre>
<p><strong>waitçš„é‡Šæ”¾é”ä¸é˜»å¡è¿‡ç¨‹:</strong></p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           wait()æ–¹æ³•çš„æ‰§è¡Œæµç¨‹                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<span class="hljs-number">1</span>. çº¿ç¨‹æŒæœ‰synchronizedé”
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Thread <span class="hljs-selector-tag">A</span>   â”‚  â† æŒæœ‰é”,_owneræŒ‡å‘Thread <span class="hljs-selector-tag">A</span>
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
          â”‚ è°ƒç”¨lock<span class="hljs-selector-class">.wait</span>()
          â–¼
<span class="hljs-number">2</span>. é‡Šæ”¾é”,è¿›å…¥WaitSet
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  _owner     â”‚  â† <span class="hljs-built_in">NULL</span>(é”å·²é‡Šæ”¾)
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  _WaitSet   â”‚  â† Thread <span class="hljs-selector-tag">A</span> (WAITINGçŠ¶æ€)
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  _EntryList â”‚  â† Thread <span class="hljs-selector-tag">B</span> (è·å¾—é”,ç»§ç»­æ‰§è¡Œ)
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ å…¶ä»–çº¿ç¨‹è°ƒç”¨lock<span class="hljs-selector-class">.notify</span>()
          â–¼
<span class="hljs-number">3</span>. ä»WaitSetç§»åˆ°EntryList,é‡æ–°ç«äº‰é”
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  _WaitSet   â”‚  â† ç©º
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  _EntryList â”‚  â† Thread <span class="hljs-selector-tag">A</span> (BLOCKEDçŠ¶æ€,ç­‰å¾…è·å–é”)
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ è·å¾—é”
          â–¼
<span class="hljs-number">4</span>. é‡æ–°æŒæœ‰é”,ç»§ç»­æ‰§è¡Œwait()ä¹‹åçš„ä»£ç 
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  _owner     â”‚  â† Thread <span class="hljs-selector-tag">A</span>
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>notifyçš„éšæœºå”¤é†’ vs notifyAllçš„å…¨éƒ¨å”¤é†’:</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NotifyExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testNotify</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-comment">// å¯åŠ¨3ä¸ªç­‰å¾…çº¿ç¨‹</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">3</span>; i++) {
            <span class="hljs-type">int</span> <span class="hljs-variable">threadNum</span> <span class="hljs-operator">=</span> i;
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
                <span class="hljs-keyword">synchronized</span> (lock) {
                    <span class="hljs-keyword">try</span> {
                        System.out.println(<span class="hljs-string">"çº¿ç¨‹"</span> + threadNum + <span class="hljs-string">"å¼€å§‹ç­‰å¾…"</span>);
                        lock.wait();
                        System.out.println(<span class="hljs-string">"çº¿ç¨‹"</span> + threadNum + <span class="hljs-string">"è¢«å”¤é†’"</span>);
                    } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                        e.printStackTrace();
                    }
                }
            }).start();
        }

        Thread.sleep(<span class="hljs-number">1000</span>);

        <span class="hljs-comment">// æµ‹è¯•notify():åªå”¤é†’ä¸€ä¸ªçº¿ç¨‹(éšæœº)</span>
        <span class="hljs-keyword">synchronized</span> (lock) {
            System.out.println(<span class="hljs-string">"è°ƒç”¨notify(),åªå”¤é†’ä¸€ä¸ªçº¿ç¨‹"</span>);
            lock.notify();  <span class="hljs-comment">// åªæœ‰ä¸€ä¸ªçº¿ç¨‹è¢«å”¤é†’,å…¶ä»–ä¸¤ä¸ªç»§ç»­ç­‰å¾…</span>
        }

        Thread.sleep(<span class="hljs-number">1000</span>);

        <span class="hljs-comment">// æµ‹è¯•notifyAll():å”¤é†’æ‰€æœ‰çº¿ç¨‹</span>
        <span class="hljs-keyword">synchronized</span> (lock) {
            System.out.println(<span class="hljs-string">"è°ƒç”¨notifyAll(),å”¤é†’æ‰€æœ‰çº¿ç¨‹"</span>);
            lock.notifyAll();  <span class="hljs-comment">// æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹è¢«å”¤é†’</span>
        }
    }
}
</code></pre>
<p><strong>è™šå‡å”¤é†’(Spurious Wakeup)é—®é¢˜:</strong></p>
<p>åœ¨æŸäº›æ“ä½œç³»ç»Ÿçš„å®ç°ä¸­,wait()å¯èƒ½åœ¨æ²¡æœ‰è¢«notify/notifyAllçš„æƒ…å†µä¸‹æ„å¤–å”¤é†’ã€‚å› æ­¤,<strong>å¿…é¡»åœ¨å¾ªç¯ä¸­ä½¿ç”¨wait()</strong>,è€Œä¸æ˜¯ifè¯­å¥ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é”™è¯¯:ä½¿ç”¨ifåˆ¤æ–­</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpuriousWakeupWrong</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">condition</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">waitForCondition</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">synchronized</span> (lock) {
            <span class="hljs-keyword">if</span> (!condition) {  <span class="hljs-comment">// âŒ ä½¿ç”¨if,è™šå‡å”¤é†’åä¸å†æ£€æŸ¥æ¡ä»¶</span>
                lock.wait();
            }
            <span class="hljs-comment">// æ‰§è¡Œä¸šåŠ¡é€»è¾‘</span>
        }
    }
}

<span class="hljs-comment">// âœ… æ­£ç¡®:ä½¿ç”¨whileå¾ªç¯</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpuriousWakeupCorrect</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">condition</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">waitForCondition</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">synchronized</span> (lock) {
            <span class="hljs-keyword">while</span> (!condition) {  <span class="hljs-comment">// âœ… ä½¿ç”¨while,è¢«å”¤é†’åé‡æ–°æ£€æŸ¥æ¡ä»¶</span>
                lock.wait();
            }
            <span class="hljs-comment">// æ‰§è¡Œä¸šåŠ¡é€»è¾‘</span>
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">signalCondition</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (lock) {
            condition = <span class="hljs-literal">true</span>;
            lock.notifyAll();
        }
    }
}
</code></pre>
<p><strong>ç»å…¸æ¡ˆä¾‹:ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProducerConsumer</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Queue&lt;String&gt; queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedList</span>&lt;&gt;();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">maxSize</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

    <span class="hljs-comment">// ç”Ÿäº§è€…</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">produce</span><span class="hljs-params">(String item)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">synchronized</span> (lock) {
            <span class="hljs-comment">// ä½¿ç”¨whileå¾ªç¯,é˜²æ­¢è™šå‡å”¤é†’</span>
            <span class="hljs-keyword">while</span> (queue.size() == maxSize) {
                System.out.println(<span class="hljs-string">"é˜Ÿåˆ—å·²æ»¡,ç”Ÿäº§è€…ç­‰å¾…..."</span>);
                lock.wait();  <span class="hljs-comment">// é˜Ÿåˆ—æ»¡,ç­‰å¾…æ¶ˆè´¹è€…æ¶ˆè´¹</span>
            }

            queue.offer(item);
            System.out.println(<span class="hljs-string">"ç”Ÿäº§: "</span> + item + <span class="hljs-string">", å½“å‰é˜Ÿåˆ—å¤§å°: "</span> + queue.size());

            lock.notifyAll();  <span class="hljs-comment">// å”¤é†’ç­‰å¾…çš„æ¶ˆè´¹è€…</span>
        }
    }

    <span class="hljs-comment">// æ¶ˆè´¹è€…</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">consume</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">synchronized</span> (lock) {
            <span class="hljs-comment">// ä½¿ç”¨whileå¾ªç¯,é˜²æ­¢è™šå‡å”¤é†’</span>
            <span class="hljs-keyword">while</span> (queue.isEmpty()) {
                System.out.println(<span class="hljs-string">"é˜Ÿåˆ—ä¸ºç©º,æ¶ˆè´¹è€…ç­‰å¾…..."</span>);
                lock.wait();  <span class="hljs-comment">// é˜Ÿåˆ—ç©º,ç­‰å¾…ç”Ÿäº§è€…ç”Ÿäº§</span>
            }

            <span class="hljs-type">String</span> <span class="hljs-variable">item</span> <span class="hljs-operator">=</span> queue.poll();
            System.out.println(<span class="hljs-string">"æ¶ˆè´¹: "</span> + item + <span class="hljs-string">", å½“å‰é˜Ÿåˆ—å¤§å°: "</span> + queue.size());

            lock.notifyAll();  <span class="hljs-comment">// å”¤é†’ç­‰å¾…çš„ç”Ÿäº§è€…</span>
            <span class="hljs-keyword">return</span> item;
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">ProducerConsumer</span> <span class="hljs-variable">pc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProducerConsumer</span>();

        <span class="hljs-comment">// å¯åŠ¨3ä¸ªç”Ÿäº§è€…</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">3</span>; i++) {
            <span class="hljs-type">int</span> <span class="hljs-variable">producerId</span> <span class="hljs-operator">=</span> i;
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt;= <span class="hljs-number">5</span>; j++) {
                        pc.produce(<span class="hljs-string">"äº§å“-"</span> + producerId + <span class="hljs-string">"-"</span> + j);
                        Thread.sleep(<span class="hljs-number">100</span>);
                    }
                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    e.printStackTrace();
                }
            }, <span class="hljs-string">"ç”Ÿäº§è€…-"</span> + i).start();
        }

        <span class="hljs-comment">// å¯åŠ¨2ä¸ªæ¶ˆè´¹è€…</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">2</span>; i++) {
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt;= <span class="hljs-number">7</span>; j++) {
                        pc.consume();
                        Thread.sleep(<span class="hljs-number">150</span>);
                    }
                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    e.printStackTrace();
                }
            }, <span class="hljs-string">"æ¶ˆè´¹è€…-"</span> + i).start();
        }
    }
}
</code></pre>
<h4 data-id="heading-20">2.3.2 LockSupportå·¥å…·ç±»</h4>
<p>LockSupportæ˜¯JDK 1.5å¼•å…¥çš„çº¿ç¨‹é˜»å¡å·¥å…·ç±»,æä¾›äº†æ›´çµæ´»çš„çº¿ç¨‹é˜»å¡å’Œå”¤é†’æœºåˆ¶ã€‚</p>
<p><strong>æ ¸å¿ƒæ–¹æ³•:</strong></p>
<ul>
<li><code>LockSupport.park()</code>: é˜»å¡å½“å‰çº¿ç¨‹,é™¤éè®¸å¯(permit)å¯ç”¨</li>
<li><code>LockSupport.park(Object blocker)</code>: é˜»å¡å½“å‰çº¿ç¨‹,å¹¶è®¾ç½®é˜»å¡å¯¹è±¡(ä¾¿äºè¯Šæ–­)</li>
<li><code>LockSupport.parkNanos(long nanos)</code>: é™æ—¶é˜»å¡(çº³ç§’çº§)</li>
<li><code>LockSupport.unpark(Thread thread)</code>: ä½¿æŒ‡å®šçº¿ç¨‹å¯ç”¨è®¸å¯,å¦‚æœçº¿ç¨‹è¢«é˜»å¡,åˆ™å”¤é†’å®ƒ</li>
</ul>
<p><strong>è®¸å¯(Permit)æœºåˆ¶:</strong></p>
<p>LockSupportå†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªè®¸å¯(permit),ç±»ä¼¼äºä¿¡å·é‡,ä½†æœ€å¤šåªæœ‰ä¸€ä¸ªè®¸å¯(0æˆ–1)ã€‚</p>
<pre><code class="hljs language-css" lang="css">è®¸å¯æœºåˆ¶:
<span class="hljs-number">1</span>. <span class="hljs-built_in">unpark</span>() â†’ è®¸å¯è®¾ç½®ä¸º<span class="hljs-number">1</span>
<span class="hljs-number">2</span>. <span class="hljs-built_in">park</span>()   â†’ å¦‚æœè®¸å¯ä¸º<span class="hljs-number">1</span>,æ¶ˆè€—è®¸å¯(è®¾ç½®ä¸º<span class="hljs-number">0</span>),ç»§ç»­æ‰§è¡Œ
              å¦‚æœè®¸å¯ä¸º<span class="hljs-number">0</span>,é˜»å¡çº¿ç¨‹

ç‰¹ç‚¹:
- è®¸å¯æœ€å¤šä¸º<span class="hljs-number">1</span>,å¤šæ¬¡<span class="hljs-built_in">unpark</span>()ä¸ä¼šç´¯åŠ 
- <span class="hljs-built_in">unpark</span>()å¯ä»¥åœ¨<span class="hljs-built_in">park</span>()ä¹‹å‰è°ƒç”¨(ä¸wait/notifyä¸åŒ)
</code></pre>
<p><strong>ä¸wait/notifyçš„åŒºåˆ«:</strong></p>



































<table><thead><tr><th>ç‰¹æ€§</th><th>wait/notify</th><th>LockSupport.park/unpark</th></tr></thead><tbody><tr><td>æ˜¯å¦éœ€è¦synchronized</td><td>âœ… å¿…é¡»åœ¨synchronizedå—ä¸­</td><td>âŒ ä¸éœ€è¦</td></tr><tr><td>å”¤é†’æŒ‡å®šçº¿ç¨‹</td><td>âŒ notify()éšæœºå”¤é†’</td><td>âœ… unpark(thread)æŒ‡å®šçº¿ç¨‹</td></tr><tr><td>é¡ºåºè¦æ±‚</td><td>âœ… å¿…é¡»å…ˆwait()ånotify()</td><td>âŒ unpark()å¯ä»¥åœ¨park()ä¹‹å‰è°ƒç”¨</td></tr><tr><td>è®¸å¯ç´¯åŠ </td><td>âŒ ä¸æ”¯æŒ</td><td>âŒ ä¸æ”¯æŒ(æœ€å¤š1ä¸ªè®¸å¯)</td></tr><tr><td>å“åº”ä¸­æ–­</td><td>âœ… æŠ›å‡ºInterruptedException</td><td>âœ… ä¸æŠ›å¼‚å¸¸,ä½†Thread.interrupted()è¿”å›true</td></tr></tbody></table>
<p><strong>åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹:</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LockSupportExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            System.out.println(<span class="hljs-string">"çº¿ç¨‹å¼€å§‹,å‡†å¤‡é˜»å¡"</span>);
            LockSupport.park();  <span class="hljs-comment">// é˜»å¡,ç­‰å¾…è®¸å¯</span>
            System.out.println(<span class="hljs-string">"çº¿ç¨‹è¢«å”¤é†’,ç»§ç»­æ‰§è¡Œ"</span>);
        });

        thread.start();
        Thread.sleep(<span class="hljs-number">2000</span>);

        System.out.println(<span class="hljs-string">"ä¸»çº¿ç¨‹å”¤é†’å­çº¿ç¨‹"</span>);
        LockSupport.unpark(thread);  <span class="hljs-comment">// ç»™threadä¸€ä¸ªè®¸å¯,å”¤é†’çº¿ç¨‹</span>
    }
}
</code></pre>
<p><strong>è®¸å¯æœºåˆ¶æ¼”ç¤º:</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LockSupportPermitExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            System.out.println(<span class="hljs-string">"çº¿ç¨‹å¯åŠ¨"</span>);

            <span class="hljs-comment">// åœºæ™¯1: unpark()åœ¨park()ä¹‹å‰è°ƒç”¨</span>
            <span class="hljs-comment">// ç”±äºå·²ç»æœ‰è®¸å¯,park()ä¸ä¼šé˜»å¡</span>
            LockSupport.park();
            System.out.println(<span class="hljs-string">"ç¬¬ä¸€æ¬¡park()ä¸é˜»å¡(è®¸å¯å·²æå‰å‘æ”¾)"</span>);

            <span class="hljs-comment">// åœºæ™¯2: è®¸å¯å·²è¢«æ¶ˆè€—,å†æ¬¡park()ä¼šé˜»å¡</span>
            System.out.println(<span class="hljs-string">"ç¬¬äºŒæ¬¡park()ä¼šé˜»å¡(è®¸å¯å·²æ¶ˆè€—)"</span>);
            LockSupport.park();
            System.out.println(<span class="hljs-string">"ç¬¬äºŒæ¬¡park()è¢«å”¤é†’"</span>);
        });

        <span class="hljs-comment">// æå‰å‘æ”¾è®¸å¯</span>
        LockSupport.unpark(thread);
        thread.start();

        Thread.sleep(<span class="hljs-number">2000</span>);

        <span class="hljs-comment">// å”¤é†’ç¬¬äºŒæ¬¡park()</span>
        LockSupport.unpark(thread);
    }
}
</code></pre>
<p><strong>LockSupportçš„åº”ç”¨åœºæ™¯:</strong></p>
<ol>
<li><strong>å®ç°è‡ªå®šä¹‰é”</strong>: AQS(AbstractQueuedSynchronizer)åº•å±‚ä½¿ç”¨LockSupportå®ç°çº¿ç¨‹é˜»å¡å’Œå”¤é†’</li>
<li><strong>ç²¾ç¡®å”¤é†’æŒ‡å®šçº¿ç¨‹</strong>: ä¸éœ€è¦notifyAll()å”¤é†’æ‰€æœ‰çº¿ç¨‹,å‡å°‘æ— æ•ˆå”¤é†’</li>
<li><strong>çµæ´»çš„é˜»å¡æœºåˆ¶</strong>: ä¸éœ€è¦è·å–é”,ä½¿ç”¨æ›´çµæ´»</li>
</ol>
<h2 data-id="heading-21">ä¸‰ã€å®æˆ˜åœºæ™¯åº”ç”¨</h2>
<h3 data-id="heading-22">åœºæ™¯1:ç”µå•†è®¢å•çŠ¶æ€æ›´æ–°çš„å¹¶å‘æ§åˆ¶</h3>
<p><strong>ä¸šåŠ¡èƒŒæ™¯:</strong></p>
<p>åœ¨ç”µå•†ç³»ç»Ÿä¸­,è®¢å•çŠ¶æ€å¯èƒ½è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹:</p>
<ul>
<li>ç”¨æˆ·æ”¯ä»˜æˆåŠŸå,æ”¯ä»˜å›è°ƒçº¿ç¨‹å°†è®¢å•çŠ¶æ€ä»"å¾…æ”¯ä»˜"æ”¹ä¸º"å¾…å‘è´§"</li>
<li>è®¢å•è¶…æ—¶æœªæ”¯ä»˜,å®šæ—¶ä»»åŠ¡çº¿ç¨‹å°†è®¢å•çŠ¶æ€æ”¹ä¸º"å·²å–æ¶ˆ"</li>
<li>ç®¡ç†å‘˜æ‰‹åŠ¨å–æ¶ˆè®¢å•,ç®¡ç†åå°çº¿ç¨‹å°†è®¢å•çŠ¶æ€æ”¹ä¸º"å·²å–æ¶ˆ"</li>
</ul>
<p><strong>é—®é¢˜åˆ†æ:</strong></p>
<p>å¦‚æœä¸è¿›è¡Œå¹¶å‘æ§åˆ¶,å¯èƒ½å‡ºç°ä»¥ä¸‹é—®é¢˜:</p>
<ol>
<li><strong>ç«æ€æ¡ä»¶</strong>: æ”¯ä»˜å›è°ƒå’Œè¶…æ—¶å–æ¶ˆåŒæ—¶æ‰§è¡Œ,å¯¼è‡´çŠ¶æ€ä¸ä¸€è‡´</li>
<li><strong>ä¸¢å¤±æ›´æ–°</strong>: åæ‰§è¡Œçš„æ“ä½œè¦†ç›–å…ˆæ‰§è¡Œçš„æ“ä½œ</li>
<li><strong>çŠ¶æ€æœºæ··ä¹±</strong>: è®¢å•çŠ¶æ€è·³è¿‡ä¸­é—´çŠ¶æ€,å¦‚ä»"å¾…æ”¯ä»˜"ç›´æ¥å˜ä¸º"å·²å®Œæˆ"</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è®¢å•çŠ¶æ€æšä¸¾</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">OrderStatus</span> {
    PENDING_PAYMENT(<span class="hljs-number">1</span>, <span class="hljs-string">"å¾…æ”¯ä»˜"</span>),
    PAID(<span class="hljs-number">2</span>, <span class="hljs-string">"å·²æ”¯ä»˜"</span>),
    SHIPPED(<span class="hljs-number">3</span>, <span class="hljs-string">"å·²å‘è´§"</span>),
    COMPLETED(<span class="hljs-number">4</span>, <span class="hljs-string">"å·²å®Œæˆ"</span>),
    CANCELLED(<span class="hljs-number">5</span>, <span class="hljs-string">"å·²å–æ¶ˆ"</span>);

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> code;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String desc;

    OrderStatus(<span class="hljs-type">int</span> code, String desc) {
        <span class="hljs-built_in">this</span>.code = code;
        <span class="hljs-built_in">this</span>.desc = desc;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getCode</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> code;
    }
}

<span class="hljs-comment">// è®¢å•å®ä½“</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Order</span> {
    <span class="hljs-keyword">private</span> Long orderId;
    <span class="hljs-keyword">private</span> OrderStatus status;
    <span class="hljs-keyword">private</span> Integer version;  <span class="hljs-comment">// ä¹è§‚é”ç‰ˆæœ¬å·</span>
    <span class="hljs-keyword">private</span> Long userId;
    <span class="hljs-keyword">private</span> BigDecimal amount;
    <span class="hljs-keyword">private</span> LocalDateTime createTime;
    <span class="hljs-keyword">private</span> LocalDateTime updateTime;

    <span class="hljs-comment">// getter/setterçœç•¥</span>
}
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆA:synchronizedæ–¹æ³•æ§åˆ¶</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">log</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(OrderService.class);

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderMapper orderMapper;

    <span class="hljs-comment">// æ–¹æ¡ˆA: ä½¿ç”¨synchronizedæ§åˆ¶å¹¶å‘</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">updateOrderStatus</span><span class="hljs-params">(Long orderId, OrderStatus targetStatus, String operator)</span> {
        <span class="hljs-comment">// 1. æŸ¥è¯¢è®¢å•</span>
        <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> orderMapper.selectById(orderId);
        <span class="hljs-keyword">if</span> (order == <span class="hljs-literal">null</span>) {
            log.warn(<span class="hljs-string">"è®¢å•ä¸å­˜åœ¨, orderId={}"</span>, orderId);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-comment">// 2. çŠ¶æ€æœºæ ¡éªŒ</span>
        <span class="hljs-keyword">if</span> (!validateStatusTransition(order.getStatus(), targetStatus)) {
            log.warn(<span class="hljs-string">"è®¢å•çŠ¶æ€è½¬æ¢ä¸åˆæ³•, orderId={}, currentStatus={}, targetStatus={}"</span>,
                orderId, order.getStatus(), targetStatus);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-comment">// 3. æ›´æ–°è®¢å•çŠ¶æ€</span>
        order.setStatus(targetStatus);
        order.setUpdateTime(LocalDateTime.now());
        orderMapper.updateById(order);

        log.info(<span class="hljs-string">"è®¢å•çŠ¶æ€æ›´æ–°æˆåŠŸ, orderId={}, {} -&gt; {}, operator={}"</span>,
            orderId, order.getStatus(), targetStatus, operator);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-comment">// çŠ¶æ€æœºæ ¡éªŒ:å®šä¹‰åˆæ³•çš„çŠ¶æ€è½¬æ¢</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">validateStatusTransition</span><span class="hljs-params">(OrderStatus current, OrderStatus target)</span> {
        <span class="hljs-keyword">if</span> (current == target) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// ç›¸åŒçŠ¶æ€,æ— éœ€æ›´æ–°</span>
        }

        <span class="hljs-keyword">switch</span> (current) {
            <span class="hljs-keyword">case</span> PENDING_PAYMENT:
                <span class="hljs-comment">// å¾…æ”¯ä»˜ â†’ å·²æ”¯ä»˜ã€å·²å–æ¶ˆ</span>
                <span class="hljs-keyword">return</span> target == OrderStatus.PAID || target == OrderStatus.CANCELLED;
            <span class="hljs-keyword">case</span> PAID:
                <span class="hljs-comment">// å·²æ”¯ä»˜ â†’ å·²å‘è´§ã€å·²å–æ¶ˆ(ç‰¹æ®Šæƒ…å†µ)</span>
                <span class="hljs-keyword">return</span> target == OrderStatus.SHIPPED || target == OrderStatus.CANCELLED;
            <span class="hljs-keyword">case</span> SHIPPED:
                <span class="hljs-comment">// å·²å‘è´§ â†’ å·²å®Œæˆ</span>
                <span class="hljs-keyword">return</span> target == OrderStatus.COMPLETED;
            <span class="hljs-keyword">case</span> COMPLETED:
            <span class="hljs-keyword">case</span> CANCELLED:
                <span class="hljs-comment">// å·²å®Œæˆã€å·²å–æ¶ˆä¸ºç»ˆæ€,ä¸å…è®¸å†è½¬æ¢</span>
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
}
</code></pre>
<p><strong>ä¼˜ç‚¹:</strong></p>
<ul>
<li>å®ç°ç®€å•,ä»£ç æ¸…æ™°</li>
<li>ä¿è¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹è®¢å•çŠ¶æ€</li>
</ul>
<p><strong>ç¼ºç‚¹:</strong></p>
<ul>
<li>é”ç²’åº¦è¿‡å¤§,synchronizedé”ä½æ•´ä¸ªæ–¹æ³•,æ‰€æœ‰è®¢å•æ›´æ–°éƒ½ä¸²è¡Œæ‰§è¡Œ</li>
<li>æ€§èƒ½å·®,é«˜å¹¶å‘åœºæ™¯ä¸‹æˆä¸ºç“¶é¢ˆ</li>
<li>å•æœºé”,åˆ†å¸ƒå¼ç¯å¢ƒä¸‹æ— æ³•ä¿è¯å®‰å…¨æ€§</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆB:æ•°æ®åº“ä¹è§‚é”(versionå­—æ®µ)</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">log</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(OrderService.class);

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderMapper orderMapper;

    <span class="hljs-comment">// æ–¹æ¡ˆB: ä½¿ç”¨æ•°æ®åº“ä¹è§‚é”</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">updateOrderStatusWithOptimisticLock</span><span class="hljs-params">(Long orderId, OrderStatus targetStatus, String operator)</span> {
        <span class="hljs-comment">// æœ€å¤šé‡è¯•3æ¬¡</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">maxRetry</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; maxRetry; i++) {
            <span class="hljs-comment">// 1. æŸ¥è¯¢è®¢å•(åŒ…å«version)</span>
            <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> orderMapper.selectById(orderId);
            <span class="hljs-keyword">if</span> (order == <span class="hljs-literal">null</span>) {
                log.warn(<span class="hljs-string">"è®¢å•ä¸å­˜åœ¨, orderId={}"</span>, orderId);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }

            <span class="hljs-comment">// 2. çŠ¶æ€æœºæ ¡éªŒ</span>
            <span class="hljs-keyword">if</span> (!validateStatusTransition(order.getStatus(), targetStatus)) {
                log.warn(<span class="hljs-string">"è®¢å•çŠ¶æ€è½¬æ¢ä¸åˆæ³•, orderId={}, currentStatus={}, targetStatus={}"</span>,
                    orderId, order.getStatus(), targetStatus);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }

            <span class="hljs-comment">// 3. ä½¿ç”¨ä¹è§‚é”æ›´æ–°(WHERE id=? AND version=?)</span>
            <span class="hljs-type">Integer</span> <span class="hljs-variable">oldVersion</span> <span class="hljs-operator">=</span> order.getVersion();
            order.setStatus(targetStatus);
            order.setVersion(oldVersion + <span class="hljs-number">1</span>);
            order.setUpdateTime(LocalDateTime.now());

            <span class="hljs-type">int</span> <span class="hljs-variable">affectedRows</span> <span class="hljs-operator">=</span> orderMapper.updateByIdAndVersion(order, oldVersion);

            <span class="hljs-keyword">if</span> (affectedRows &gt; <span class="hljs-number">0</span>) {
                log.info(<span class="hljs-string">"è®¢å•çŠ¶æ€æ›´æ–°æˆåŠŸ, orderId={}, {} -&gt; {}, operator={}, retry={}"</span>,
                    orderId, order.getStatus(), targetStatus, operator, i);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            } <span class="hljs-keyword">else</span> {
                log.warn(<span class="hljs-string">"è®¢å•çŠ¶æ€æ›´æ–°å¤±è´¥(ç‰ˆæœ¬å†²çª), orderId={}, ç¬¬{}æ¬¡é‡è¯•"</span>, orderId, i + <span class="hljs-number">1</span>);
                <span class="hljs-comment">// ç‰ˆæœ¬å†²çª,é‡è¯•</span>
                <span class="hljs-keyword">try</span> {
                    Thread.sleep(<span class="hljs-number">50</span>);  <span class="hljs-comment">// é¿å…é¢‘ç¹é‡è¯•</span>
                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    Thread.currentThread().interrupt();
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
                }
            }
        }

        log.error(<span class="hljs-string">"è®¢å•çŠ¶æ€æ›´æ–°å¤±è´¥(è¶…è¿‡æœ€å¤§é‡è¯•æ¬¡æ•°), orderId={}"</span>, orderId);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">validateStatusTransition</span><span class="hljs-params">(OrderStatus current, OrderStatus target)</span> {
        <span class="hljs-comment">// åŒæ–¹æ¡ˆA</span>
        <span class="hljs-comment">// ...</span>
    }
}

<span class="hljs-comment">// MyBatis Mapper</span>
<span class="hljs-meta">@Mapper</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">OrderMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;Order&gt; {
    <span class="hljs-comment">/**
     * ä¹è§‚é”æ›´æ–°è®¢å•
     * SQL: UPDATE t_order SET status=#{status}, version=#{version}, update_time=#{updateTime}
     *      WHERE id=#{id} AND version=#{oldVersion}
     */</span>
    <span class="hljs-meta">@Update("UPDATE t_order SET status=#{order.status}, version=#{order.version}, " +
            "update_time=#{order.updateTime} " +
            "WHERE id=#{order.id} AND version=#{oldVersion}")</span>
    <span class="hljs-type">int</span> <span class="hljs-title function_">updateByIdAndVersion</span><span class="hljs-params">(<span class="hljs-meta">@Param("order")</span> Order order, <span class="hljs-meta">@Param("oldVersion")</span> Integer oldVersion)</span>;
}
</code></pre>
<p><strong>ä¼˜ç‚¹:</strong></p>
<ul>
<li>æ— é”åŒ–è®¾è®¡,é«˜å¹¶å‘æ€§èƒ½å¥½</li>
<li>é€šè¿‡versionå­—æ®µä¿è¯æ›´æ–°çš„åŸå­æ€§</li>
<li>é€‚ç”¨äºè¯»å¤šå†™å°‘çš„åœºæ™¯</li>
</ul>
<p><strong>ç¼ºç‚¹:</strong></p>
<ul>
<li>å†²çªæ—¶éœ€è¦é‡è¯•,å¢åŠ å¤æ‚åº¦</li>
<li>é‡è¯•æ¬¡æ•°è¿‡å¤šå¯èƒ½å½±å“æ€§èƒ½</li>
<li>å•è¡¨æ›´æ–°æœ‰æ•ˆ,æ¶‰åŠå¤šè¡¨äº‹åŠ¡æ—¶éœ€è¦é¢å¤–å¤„ç†</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆC:åˆ†å¸ƒå¼é”</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">log</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(OrderService.class);

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderMapper orderMapper;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RedissonClient redissonClient;

    <span class="hljs-comment">// æ–¹æ¡ˆC: ä½¿ç”¨åˆ†å¸ƒå¼é”(Redisson)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">updateOrderStatusWithDistributedLock</span><span class="hljs-params">(Long orderId, OrderStatus targetStatus, String operator)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">lockKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order:lock:"</span> + orderId;
        <span class="hljs-type">RLock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> redissonClient.getLock(lockKey);

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å°è¯•åŠ é”,æœ€å¤šç­‰å¾…10ç§’,é”è‡ªåŠ¨é‡Šæ”¾æ—¶é—´30ç§’</span>
            <span class="hljs-type">boolean</span> <span class="hljs-variable">locked</span> <span class="hljs-operator">=</span> lock.tryLock(<span class="hljs-number">10</span>, <span class="hljs-number">30</span>, TimeUnit.SECONDS);
            <span class="hljs-keyword">if</span> (!locked) {
                log.warn(<span class="hljs-string">"è·å–åˆ†å¸ƒå¼é”å¤±è´¥, orderId={}"</span>, orderId);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }

            <span class="hljs-comment">// 1. æŸ¥è¯¢è®¢å•</span>
            <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> orderMapper.selectById(orderId);
            <span class="hljs-keyword">if</span> (order == <span class="hljs-literal">null</span>) {
                log.warn(<span class="hljs-string">"è®¢å•ä¸å­˜åœ¨, orderId={}"</span>, orderId);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }

            <span class="hljs-comment">// 2. çŠ¶æ€æœºæ ¡éªŒ</span>
            <span class="hljs-keyword">if</span> (!validateStatusTransition(order.getStatus(), targetStatus)) {
                log.warn(<span class="hljs-string">"è®¢å•çŠ¶æ€è½¬æ¢ä¸åˆæ³•, orderId={}, currentStatus={}, targetStatus={}"</span>,
                    orderId, order.getStatus(), targetStatus);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }

            <span class="hljs-comment">// 3. æ›´æ–°è®¢å•çŠ¶æ€</span>
            order.setStatus(targetStatus);
            order.setUpdateTime(LocalDateTime.now());
            orderMapper.updateById(order);

            log.info(<span class="hljs-string">"è®¢å•çŠ¶æ€æ›´æ–°æˆåŠŸ, orderId={}, {} -&gt; {}, operator={}"</span>,
                orderId, order.getStatus(), targetStatus, operator);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;

        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            Thread.currentThread().interrupt();
            log.error(<span class="hljs-string">"è·å–åˆ†å¸ƒå¼é”è¢«ä¸­æ–­, orderId={}"</span>, orderId, e);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// é‡Šæ”¾é”</span>
            <span class="hljs-keyword">if</span> (lock.isHeldByCurrentThread()) {
                lock.unlock();
            }
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">validateStatusTransition</span><span class="hljs-params">(OrderStatus current, OrderStatus target)</span> {
        <span class="hljs-comment">// åŒæ–¹æ¡ˆA</span>
        <span class="hljs-comment">// ...</span>
    }
}
</code></pre>
<p><strong>ä¼˜ç‚¹:</strong></p>
<ul>
<li>åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ä¿è¯å®‰å…¨æ€§</li>
<li>é”ç²’åº¦å¯æ§(æŒ‰è®¢å•IDåŠ é”,ä¸åŒè®¢å•å¹¶è¡Œå¤„ç†)</li>
<li>æ”¯æŒé”ç»­æœŸ(Redisson Watchdogæœºåˆ¶)</li>
</ul>
<p><strong>ç¼ºç‚¹:</strong></p>
<ul>
<li>ä¾èµ–Redis,å¢åŠ ç³»ç»Ÿå¤æ‚åº¦</li>
<li>ç½‘ç»œå»¶è¿Ÿå½±å“æ€§èƒ½</li>
<li>éœ€è¦å¤„ç†Redisæ•…éšœå’Œé”ç»­æœŸé—®é¢˜</li>
</ul>
<p><strong>æ€§èƒ½æµ‹è¯•å¯¹æ¯”:</strong></p>





































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>å¹¶å‘çº¿ç¨‹æ•°</th><th>æ€»è¯·æ±‚æ•°</th><th>å¹³å‡RT</th><th>TPS</th><th>æˆåŠŸç‡</th></tr></thead><tbody><tr><td>synchronizedæ–¹æ³•</td><td>100</td><td>10000</td><td>250ms</td><td>400</td><td>100%</td></tr><tr><td>æ•°æ®åº“ä¹è§‚é”</td><td>100</td><td>10000</td><td>80ms</td><td>1250</td><td>95%(é‡è¯•åæˆåŠŸ)</td></tr><tr><td>åˆ†å¸ƒå¼é”(Redisson)</td><td>100</td><td>10000</td><td>120ms</td><td>833</td><td>100%</td></tr></tbody></table>
<p><strong>æ¨èæ–¹æ¡ˆ:</strong></p>
<ul>
<li><strong>å•æœºåº”ç”¨</strong>: ä½¿ç”¨æ•°æ®åº“ä¹è§‚é”(æ–¹æ¡ˆB),æ€§èƒ½æœ€ä¼˜</li>
<li><strong>åˆ†å¸ƒå¼åº”ç”¨</strong>: ä½¿ç”¨åˆ†å¸ƒå¼é”(æ–¹æ¡ˆC),ä¿è¯å®‰å…¨æ€§</li>
<li><strong>ä½å¹¶å‘åœºæ™¯</strong>: ä½¿ç”¨synchronized(æ–¹æ¡ˆA),å®ç°ç®€å•</li>
</ul>
<h3 data-id="heading-23">åœºæ™¯2:ä½¿ç”¨volatileå®ç°ä¼˜é›…åœæ­¢çº¿ç¨‹</h3>
<p><strong>ä¸šåŠ¡èƒŒæ™¯:</strong></p>
<p>ç›‘æ§çº¿ç¨‹å‘¨æœŸæ€§æ£€æŸ¥ç³»ç»ŸçŠ¶æ€(å¦‚è®¢å•è¶…æ—¶æ£€æµ‹ã€åº“å­˜åŒæ­¥),éœ€è¦èƒ½ä¼˜é›…åœæ­¢çº¿ç¨‹è€Œä¸æ˜¯å¼ºåˆ¶ä¸­æ–­ã€‚</p>
<p><strong>é”™è¯¯å®ç°:booleanå˜é‡æœªåŠ volatile</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StopThreadWrong</span> {
    <span class="hljs-comment">// âŒ é”™è¯¯:æœªä½¿ç”¨volatile,å¯èƒ½å¯¼è‡´ä¸»çº¿ç¨‹ä¿®æ”¹å,å·¥ä½œçº¿ç¨‹æ— æ³•æ„ŸçŸ¥</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">stopRequested</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å¯åŠ¨å·¥ä½œçº¿ç¨‹</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
            <span class="hljs-keyword">while</span> (!stopRequested) {  <span class="hljs-comment">// å¯èƒ½æ°¸è¿œè¯»å–ä¸åˆ°stopRequestedçš„å˜åŒ–</span>
                count++;
                <span class="hljs-keyword">try</span> {
                    Thread.sleep(<span class="hljs-number">1000</span>);
                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    Thread.currentThread().interrupt();
                }
            }
            System.out.println(<span class="hljs-string">"å·¥ä½œçº¿ç¨‹åœæ­¢, æ€»æ‰§è¡Œæ¬¡æ•°: "</span> + count);
        }, <span class="hljs-string">"Worker-Thread"</span>).start();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
        stopRequested = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// ä¸»çº¿ç¨‹ä¿®æ”¹,å·¥ä½œçº¿ç¨‹å¯èƒ½çœ‹ä¸åˆ°</span>
        System.out.println(<span class="hljs-string">"ä¸»çº¿ç¨‹å·²è®¾ç½®åœæ­¢æ ‡å¿—"</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">StopThreadWrong</span> <span class="hljs-variable">worker</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StopThreadWrong</span>();
        worker.start();

        Thread.sleep(<span class="hljs-number">5000</span>);
        worker.stop();  <span class="hljs-comment">// å·¥ä½œçº¿ç¨‹å¯èƒ½æ— æ³•åœæ­¢!</span>
    }
}
</code></pre>
<p><strong>é—®é¢˜åŸå› :</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">å†…å­˜å¯è§æ€§é—®é¢˜:

ä¸»çº¿ç¨‹(CPU0)                    å·¥ä½œçº¿ç¨‹(CPU1)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ stopRequestedâ”‚                â”‚ stopRequestedâ”‚
â”‚   = <span class="hljs-literal">false</span>   â”‚                â”‚   = <span class="hljs-literal">false</span>   â”‚  â† CPU1ç¼“å­˜ä¸­çš„å€¼
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                              â”‚
       â”‚ stopRequested = <span class="hljs-literal">true</span>         â”‚ <span class="hljs-keyword">while</span>(!stopRequested)
       â–¼                              â”‚   å¾ªç¯ç»§ç»­...
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚ä¸»å†…å­˜        â”‚                      â”‚
â”‚stopRequestedâ”‚                      â”‚
â”‚   = <span class="hljs-literal">true</span>    â”‚                      â–¼
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              å¯èƒ½æ°¸è¿œè¯»å–ä¸åˆ°<span class="hljs-literal">true</span>!
                             (CPU1ç¼“å­˜æœªå¤±æ•ˆ,ä¸€ç›´ä½¿ç”¨ç¼“å­˜å€¼<span class="hljs-literal">false</span>)
</code></pre>
<p><strong>æ­£ç¡®å®ç°:ä½¿ç”¨volatile</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StopThreadCorrect</span> {
    <span class="hljs-comment">// âœ… æ­£ç¡®:ä½¿ç”¨volatile,ä¿è¯å¯è§æ€§</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">stopRequested</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å¯åŠ¨å·¥ä½œçº¿ç¨‹</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
            <span class="hljs-keyword">while</span> (!stopRequested) {  <span class="hljs-comment">// volatileä¿è¯èƒ½ç«‹å³è¯»å–åˆ°ä¸»çº¿ç¨‹çš„ä¿®æ”¹</span>
                count++;
                System.out.println(<span class="hljs-string">"æ‰§è¡Œä»»åŠ¡ #"</span> + count);
                <span class="hljs-keyword">try</span> {
                    Thread.sleep(<span class="hljs-number">1000</span>);
                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    Thread.currentThread().interrupt();
                    <span class="hljs-keyword">break</span>;
                }
            }
            System.out.println(<span class="hljs-string">"å·¥ä½œçº¿ç¨‹ä¼˜é›…åœæ­¢, æ€»æ‰§è¡Œæ¬¡æ•°: "</span> + count);
        }, <span class="hljs-string">"Worker-Thread"</span>).start();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
        stopRequested = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// volatileå†™æ“ä½œ,ç«‹å³åˆ·æ–°åˆ°ä¸»å†…å­˜</span>
        System.out.println(<span class="hljs-string">"ä¸»çº¿ç¨‹å·²è®¾ç½®åœæ­¢æ ‡å¿—"</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">StopThreadCorrect</span> <span class="hljs-variable">worker</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StopThreadCorrect</span>();
        worker.start();

        Thread.sleep(<span class="hljs-number">5000</span>);
        worker.stop();  <span class="hljs-comment">// å·¥ä½œçº¿ç¨‹èƒ½ç«‹å³æ„ŸçŸ¥åˆ°stopRequestedå˜åŒ–,ä¼˜é›…åœæ­¢</span>
    }
}
</code></pre>
<p><strong>åŸç†è§£é‡Š:</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">volatile</span>ä¿è¯å¯è§æ€§:

ä¸»çº¿ç¨‹                          å·¥ä½œçº¿ç¨‹
  â”‚                              â”‚
  â”‚ stopRequested = <span class="hljs-literal">true</span>         â”‚
  â”‚      â†“                       â”‚
  â”‚  StoreStoreå±éšœ              â”‚
  â”‚      â†“                       â”‚
  â”‚  å†™å…¥ä¸»å†…å­˜                  â”‚
  â”‚      â†“                       â”‚
  â”‚  StoreLoadå±éšœ               â”‚
  â”‚      â†“                       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                 â”‚
                                 â”‚ <span class="hljs-keyword">while</span>(!stopRequested)
                                 â”‚      â†“
                                 â”‚  LoadLoadå±éšœ
                                 â”‚      â†“
                                 â”‚  ä»ä¸»å†…å­˜è¯»å–(å¼ºåˆ¶åˆ·æ–°CPUç¼“å­˜)
                                 â”‚      â†“
                                 â”‚  è¯»å–åˆ°<span class="hljs-literal">true</span>,é€€å‡ºå¾ªç¯
</code></pre>
<p><strong>å®é™…åº”ç”¨:è®¢å•è¶…æ—¶æ£€æµ‹</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderTimeoutMonitor</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">log</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(OrderTimeoutMonitor.class);

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderService orderService;

    <span class="hljs-comment">// åœæ­¢æ ‡å¿—</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">stopRequested</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

    <span class="hljs-comment">// ç›‘æ§çº¿ç¨‹</span>
    <span class="hljs-keyword">private</span> Thread monitorThread;

    <span class="hljs-comment">/**
     * å¯åŠ¨ç›‘æ§
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (monitorThread != <span class="hljs-literal">null</span> &amp;&amp; monitorThread.isAlive()) {
            log.warn(<span class="hljs-string">"ç›‘æ§çº¿ç¨‹å·²å¯åŠ¨,æ— éœ€é‡å¤å¯åŠ¨"</span>);
            <span class="hljs-keyword">return</span>;
        }

        stopRequested = <span class="hljs-literal">false</span>;
        monitorThread = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            log.info(<span class="hljs-string">"è®¢å•è¶…æ—¶ç›‘æ§çº¿ç¨‹å¯åŠ¨"</span>);

            <span class="hljs-keyword">while</span> (!stopRequested) {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-comment">// æŸ¥è¯¢è¶…æ—¶æœªæ”¯ä»˜çš„è®¢å•</span>
                    List&lt;Order&gt; timeoutOrders = orderService.selectTimeoutOrders();

                    <span class="hljs-keyword">for</span> (Order order : timeoutOrders) {
                        <span class="hljs-comment">// è‡ªåŠ¨å–æ¶ˆè¶…æ—¶è®¢å•</span>
                        <span class="hljs-type">boolean</span> <span class="hljs-variable">success</span> <span class="hljs-operator">=</span> orderService.updateOrderStatus(
                            order.getOrderId(),
                            OrderStatus.CANCELLED,
                            <span class="hljs-string">"System-Timeout"</span>
                        );

                        <span class="hljs-keyword">if</span> (success) {
                            log.info(<span class="hljs-string">"è‡ªåŠ¨å–æ¶ˆè¶…æ—¶è®¢å•, orderId={}"</span>, order.getOrderId());
                        }
                    }

                    <span class="hljs-comment">// æ¯60ç§’æ£€æŸ¥ä¸€æ¬¡</span>
                    Thread.sleep(<span class="hljs-number">60000</span>);

                } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                    Thread.currentThread().interrupt();
                    log.warn(<span class="hljs-string">"ç›‘æ§çº¿ç¨‹è¢«ä¸­æ–­"</span>);
                    <span class="hljs-keyword">break</span>;
                } <span class="hljs-keyword">catch</span> (Exception e) {
                    log.error(<span class="hljs-string">"ç›‘æ§çº¿ç¨‹å¼‚å¸¸"</span>, e);
                }
            }

            log.info(<span class="hljs-string">"è®¢å•è¶…æ—¶ç›‘æ§çº¿ç¨‹åœæ­¢"</span>);
        }, <span class="hljs-string">"Order-Timeout-Monitor"</span>);

        monitorThread.start();
    }

    <span class="hljs-comment">/**
     * åœæ­¢ç›‘æ§
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
        stopRequested = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// volatileå†™,ä¿è¯å¯è§æ€§</span>

        <span class="hljs-keyword">if</span> (monitorThread != <span class="hljs-literal">null</span>) {
            monitorThread.interrupt();  <span class="hljs-comment">// ä¸­æ–­sleepçŠ¶æ€</span>
        }

        log.info(<span class="hljs-string">"å·²å‘é€åœæ­¢ä¿¡å·"</span>);
    }

    <span class="hljs-comment">/**
     * åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨ç›‘æ§
     */</span>
    <span class="hljs-meta">@PostConstruct</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> {
        start();
    }

    <span class="hljs-comment">/**
     * åº”ç”¨å…³é—­æ—¶ä¼˜é›…åœæ­¢ç›‘æ§
     */</span>
    <span class="hljs-meta">@PreDestroy</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span> {
        stop();
    }
}
</code></pre>
<h2 data-id="heading-24">å››ã€ç”Ÿäº§æ¡ˆä¾‹ä¸æ•…éšœæ’æŸ¥</h2>
<h3 data-id="heading-25">æ¡ˆä¾‹1:çº¿ç¨‹æ­»é”æ’æŸ¥ä¸è§£å†³</h3>
<p><strong>æ•…éšœç°è±¡:</strong></p>
<p>æŸç”µå•†å¹³å°åœ¨ä¿ƒé”€æ´»åŠ¨æœŸé—´,ç³»ç»Ÿå“åº”ç¼“æ…¢,éƒ¨åˆ†ç”¨æˆ·ä¸‹å•æ¥å£å¡æ­»è¶…æ—¶ã€‚ç›‘æ§æ˜¾ç¤ºCPUä½¿ç”¨ç‡ä¸é«˜,ä½†TPSå¤§å¹…ä¸‹é™ã€‚</p>
<p><strong>æ’æŸ¥è¿‡ç¨‹:</strong></p>
<p><strong>æ­¥éª¤1:ä½¿ç”¨jstackç”Ÿæˆçº¿ç¨‹dump</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥æ‰¾Javaè¿›ç¨‹PID</span>
jps -l

<span class="hljs-comment"># ç”Ÿæˆçº¿ç¨‹dump</span>
jstack -l 12345 &gt; thread_dump.txt
</code></pre>
<p><strong>æ­¥éª¤2:åˆ†ææ­»é”æ—¥å¿—</strong></p>
<p>åœ¨thread_dump.txtä¸­å‘ç°æ­»é”ä¿¡æ¯:</p>
<pre><code class="hljs language-vbnet" lang="vbnet">Found one Java-level deadlock:
=============================
<span class="hljs-string">"Thread-A"</span>:
  waiting <span class="hljs-keyword">to</span> lock monitor <span class="hljs-number">0</span>x00007f8a1c004e00 (<span class="hljs-type">object</span> <span class="hljs-number">0</span>x00000000e0a12345, a com.example.OrderLock),
  which <span class="hljs-built_in">is</span> held <span class="hljs-keyword">by</span> <span class="hljs-string">"Thread-B"</span>
<span class="hljs-string">"Thread-B"</span>:
  waiting <span class="hljs-keyword">to</span> lock monitor <span class="hljs-number">0</span>x00007f8a1c004d00 (<span class="hljs-type">object</span> <span class="hljs-number">0</span>x00000000e0a12346, a com.example.InventoryLock),
  which <span class="hljs-built_in">is</span> held <span class="hljs-keyword">by</span> <span class="hljs-string">"Thread-A"</span>

Java stack information <span class="hljs-keyword">for</span> the threads listed above:
===================================================
<span class="hljs-string">"Thread-A"</span>:
        at com.example.OrderService.createOrder(OrderService.java:<span class="hljs-number">45</span>)
        - waiting <span class="hljs-keyword">to</span> lock &lt;<span class="hljs-number">0</span>x00000000e0a12345&gt; (a com.example.OrderLock)
        - locked &lt;<span class="hljs-number">0</span>x00000000e0a12346&gt; (a com.example.InventoryLock)

<span class="hljs-string">"Thread-B"</span>:
        at com.example.InventoryService.deductStock(InventoryService.java:<span class="hljs-number">32</span>)
        - waiting <span class="hljs-keyword">to</span> lock &lt;<span class="hljs-number">0</span>x00000000e0a12346&gt; (a com.example.InventoryLock)
        - locked &lt;<span class="hljs-number">0</span>x00000000e0a12345&gt; (a com.example.OrderLock)
</code></pre>
<p><strong>æ­¥éª¤3:å®šä½æ­»é”ä»£ç </strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ æ­»é”ä»£ç (é”™è¯¯ç¤ºä¾‹)</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">orderLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">inventoryLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> InventoryService inventoryService;

    <span class="hljs-comment">// çº¿ç¨‹A:å…ˆé”åº“å­˜,å†é”è®¢å•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrder</span><span class="hljs-params">(Long skuId, <span class="hljs-type">int</span> quantity)</span> {
        <span class="hljs-keyword">synchronized</span> (inventoryLock) {  <span class="hljs-comment">// â† å…ˆè·å–inventoryLock</span>
            System.out.println(<span class="hljs-string">"OrderServiceè·å–inventoryLock"</span>);

            <span class="hljs-comment">// æ¨¡æ‹Ÿä¸šåŠ¡å¤„ç†</span>
            <span class="hljs-keyword">try</span> { Thread.sleep(<span class="hljs-number">100</span>); } <span class="hljs-keyword">catch</span> (InterruptedException e) {}

            <span class="hljs-keyword">synchronized</span> (orderLock) {  <span class="hljs-comment">// â† å†è·å–orderLock</span>
                System.out.println(<span class="hljs-string">"OrderServiceè·å–orderLock"</span>);
                <span class="hljs-comment">// åˆ›å»ºè®¢å•é€»è¾‘</span>
            }
        }
    }
}

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InventoryService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">orderLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">inventoryLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

    <span class="hljs-comment">// çº¿ç¨‹B:å…ˆé”è®¢å•,å†é”åº“å­˜</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deductStock</span><span class="hljs-params">(Long orderId, Long skuId, <span class="hljs-type">int</span> quantity)</span> {
        <span class="hljs-keyword">synchronized</span> (orderLock) {  <span class="hljs-comment">// â† å…ˆè·å–orderLock</span>
            System.out.println(<span class="hljs-string">"InventoryServiceè·å–orderLock"</span>);

            <span class="hljs-comment">// æ¨¡æ‹Ÿä¸šåŠ¡å¤„ç†</span>
            <span class="hljs-keyword">try</span> { Thread.sleep(<span class="hljs-number">100</span>); } <span class="hljs-keyword">catch</span> (InterruptedException e) {}

            <span class="hljs-keyword">synchronized</span> (inventoryLock) {  <span class="hljs-comment">// â† å†è·å–inventoryLock</span>
                System.out.println(<span class="hljs-string">"InventoryServiceè·å–inventoryLock"</span>);
                <span class="hljs-comment">// æ‰£å‡åº“å­˜é€»è¾‘</span>
            }
        }
    }
}
</code></pre>
<p><strong>æ­»é”åœºæ™¯å¤ç°:</strong></p>
<pre><code class="hljs language-less" lang="less">æ—¶é—´çº¿:
<span class="hljs-selector-tag">T1</span>: çº¿ç¨‹<span class="hljs-selector-tag">A</span>æ‰§è¡Œ<span class="hljs-selector-tag">createOrder</span>(),è·å–<span class="hljs-selector-tag">inventoryLock</span>
<span class="hljs-selector-tag">T2</span>: çº¿ç¨‹<span class="hljs-selector-tag">B</span>æ‰§è¡Œ<span class="hljs-selector-tag">deductStock</span>(),è·å–<span class="hljs-selector-tag">orderLock</span>
<span class="hljs-selector-tag">T3</span>: çº¿ç¨‹<span class="hljs-selector-tag">A</span>å°è¯•è·å–<span class="hljs-selector-tag">orderLock</span>,è¢«çº¿ç¨‹<span class="hljs-selector-tag">B</span>æŒæœ‰,é˜»å¡ç­‰å¾…
<span class="hljs-selector-tag">T4</span>: çº¿ç¨‹<span class="hljs-selector-tag">B</span>å°è¯•è·å–<span class="hljs-selector-tag">inventoryLock</span>,è¢«çº¿ç¨‹<span class="hljs-selector-tag">A</span>æŒæœ‰,é˜»å¡ç­‰å¾…
<span class="hljs-selector-tag">T5</span>: æ­»é”!ä¸¤ä¸ªçº¿ç¨‹äº’ç›¸ç­‰å¾…å¯¹æ–¹é‡Šæ”¾é”

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ­»é”ç¤ºæ„å›¾                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    <span class="hljs-selector-tag">Thread-A</span>                       <span class="hljs-selector-tag">Thread-B</span>
        â”‚                              â”‚
        â”‚ è·å–<span class="hljs-selector-tag">inventoryLock</span>            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º             â”‚
        â”‚ æŒæœ‰<span class="hljs-selector-tag">inventoryLock</span>            â”‚
        â”‚                              â”‚ è·å–<span class="hljs-selector-tag">orderLock</span>
        â”‚                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º
        â”‚                              â”‚ æŒæœ‰<span class="hljs-selector-tag">orderLock</span>
        â”‚                              â”‚
        â”‚ å°è¯•è·å–<span class="hljs-selector-tag">orderLock</span>            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
        â”‚  ç­‰å¾…   â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ è¢«<span class="hljs-selector-tag">Thread-B</span>æŒæœ‰
        â”‚         â”‚                    â”‚
        â”‚         â”‚                    â”‚ å°è¯•è·å–<span class="hljs-selector-tag">inventoryLock</span>
        â”‚         â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         â”‚ è¢«<span class="hljs-selector-tag">Thread-A</span>æŒæœ‰ â”€â”€â”€â–ºâ”‚  ç­‰å¾…   â”‚
        â”‚         â”‚                    â”‚         â”‚
        â”‚         â”‚                    â”‚         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      æ­»é”!
</code></pre>
<p><strong>æ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶:</strong></p>
<ol>
<li><strong>äº’æ–¥æ¡ä»¶</strong>: èµ„æºä¸èƒ½è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®</li>
<li><strong>æŒæœ‰å¹¶ç­‰å¾…</strong>: çº¿ç¨‹æŒæœ‰ä¸€ä¸ªèµ„æº,åŒæ—¶ç­‰å¾…è·å–å¦ä¸€ä¸ªèµ„æº</li>
<li><strong>ä¸å¯å‰¥å¤º</strong>: èµ„æºä¸èƒ½è¢«å¼ºåˆ¶ä»æŒæœ‰çº¿ç¨‹ä¸­å‰¥å¤º</li>
<li><strong>å¾ªç¯ç­‰å¾…</strong>: å­˜åœ¨çº¿ç¨‹ç­‰å¾…ç¯è·¯(Aç­‰B,Bç­‰A)</li>
</ol>
<p><strong>è§£å†³æ–¹æ¡ˆ1:ç»Ÿä¸€é”é¡ºåº(ç ´åå¾ªç¯ç­‰å¾…)</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… è§£å†³æ–¹æ¡ˆ1:ç»Ÿä¸€é”çš„è·å–é¡ºåº</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    <span class="hljs-comment">// ä½¿ç”¨åŒä¸€æŠŠé”å¯¹è±¡(ä»Springå®¹å™¨è·å–)</span>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> LockManager lockManager;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrder</span><span class="hljs-params">(Long skuId, <span class="hljs-type">int</span> quantity)</span> {
        <span class="hljs-type">Object</span> <span class="hljs-variable">inventoryLock</span> <span class="hljs-operator">=</span> lockManager.getInventoryLock();
        <span class="hljs-type">Object</span> <span class="hljs-variable">orderLock</span> <span class="hljs-operator">=</span> lockManager.getOrderLock();

        <span class="hljs-comment">// ç»Ÿä¸€æŒ‰ç…§:å…ˆé”inventory,å†é”order</span>
        <span class="hljs-keyword">synchronized</span> (inventoryLock) {
            System.out.println(<span class="hljs-string">"OrderServiceè·å–inventoryLock"</span>);

            <span class="hljs-keyword">synchronized</span> (orderLock) {
                System.out.println(<span class="hljs-string">"OrderServiceè·å–orderLock"</span>);
                <span class="hljs-comment">// åˆ›å»ºè®¢å•é€»è¾‘</span>
            }
        }
    }
}

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InventoryService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> LockManager lockManager;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deductStock</span><span class="hljs-params">(Long orderId, Long skuId, <span class="hljs-type">int</span> quantity)</span> {
        <span class="hljs-type">Object</span> <span class="hljs-variable">inventoryLock</span> <span class="hljs-operator">=</span> lockManager.getInventoryLock();
        <span class="hljs-type">Object</span> <span class="hljs-variable">orderLock</span> <span class="hljs-operator">=</span> lockManager.getOrderLock();

        <span class="hljs-comment">// ç»Ÿä¸€æŒ‰ç…§:å…ˆé”inventory,å†é”order(ä¸OrderServiceä¿æŒä¸€è‡´)</span>
        <span class="hljs-keyword">synchronized</span> (inventoryLock) {
            System.out.println(<span class="hljs-string">"InventoryServiceè·å–inventoryLock"</span>);

            <span class="hljs-keyword">synchronized</span> (orderLock) {
                System.out.println(<span class="hljs-string">"InventoryServiceè·å–orderLock"</span>);
                <span class="hljs-comment">// æ‰£å‡åº“å­˜é€»è¾‘</span>
            }
        }
    }
}

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LockManager</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">inventoryLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">orderLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getInventoryLock</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> inventoryLock;
    }

    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getOrderLock</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> orderLock;
    }
}
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆ2:ä½¿ç”¨tryLockè¶…æ—¶æœºåˆ¶(ç ´åæŒæœ‰å¹¶ç­‰å¾…)</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… è§£å†³æ–¹æ¡ˆ2:ä½¿ç”¨Lockçš„tryLock()æ–¹æ³•</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Lock</span> <span class="hljs-variable">inventoryLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Lock</span> <span class="hljs-variable">orderLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">createOrder</span><span class="hljs-params">(Long skuId, <span class="hljs-type">int</span> quantity)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å°è¯•è·å–inventoryLock,æœ€å¤šç­‰å¾…1ç§’</span>
            <span class="hljs-keyword">if</span> (inventoryLock.tryLock(<span class="hljs-number">1</span>, TimeUnit.SECONDS)) {
                <span class="hljs-keyword">try</span> {
                    System.out.println(<span class="hljs-string">"OrderServiceè·å–inventoryLock"</span>);

                    <span class="hljs-comment">// å°è¯•è·å–orderLock,æœ€å¤šç­‰å¾…1ç§’</span>
                    <span class="hljs-keyword">if</span> (orderLock.tryLock(<span class="hljs-number">1</span>, TimeUnit.SECONDS)) {
                        <span class="hljs-keyword">try</span> {
                            System.out.println(<span class="hljs-string">"OrderServiceè·å–orderLock"</span>);
                            <span class="hljs-comment">// åˆ›å»ºè®¢å•é€»è¾‘</span>
                            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
                        } <span class="hljs-keyword">finally</span> {
                            orderLock.unlock();
                        }
                    } <span class="hljs-keyword">else</span> {
                        System.out.println(<span class="hljs-string">"OrderServiceè·å–orderLockè¶…æ—¶,æ”¾å¼ƒæ“ä½œ"</span>);
                        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
                    }
                } <span class="hljs-keyword">finally</span> {
                    inventoryLock.unlock();
                }
            } <span class="hljs-keyword">else</span> {
                System.out.println(<span class="hljs-string">"OrderServiceè·å–inventoryLockè¶…æ—¶,æ”¾å¼ƒæ“ä½œ"</span>);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            Thread.currentThread().interrupt();
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
}
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆ3:é‡æ„ä»£ç ,é¿å…åµŒå¥—é”</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… è§£å†³æ–¹æ¡ˆ3:é¿å…åµŒå¥—é”,ä½¿ç”¨å•é”æˆ–æ— é”è®¾è®¡</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderMapper orderMapper;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> InventoryService inventoryService;

    <span class="hljs-meta">@Transactional(rollbackFor = Exception.class)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrder</span><span class="hljs-params">(Long skuId, <span class="hljs-type">int</span> quantity)</span> {
        <span class="hljs-comment">// 1. å…ˆæ‰£å‡åº“å­˜(åŸå­æ“ä½œ,æ•°æ®åº“å±‚é¢ä¿è¯)</span>
        <span class="hljs-type">boolean</span> <span class="hljs-variable">deducted</span> <span class="hljs-operator">=</span> inventoryService.tryDeductStock(skuId, quantity);
        <span class="hljs-keyword">if</span> (!deducted) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BusinessException</span>(<span class="hljs-string">"åº“å­˜ä¸è¶³"</span>);
        }

        <span class="hljs-comment">// 2. åˆ›å»ºè®¢å•(æ— éœ€é¢å¤–åŠ é”)</span>
        <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Order</span>();
        order.setSkuId(skuId);
        order.setQuantity(quantity);
        order.setStatus(OrderStatus.PENDING_PAYMENT);
        orderMapper.insert(order);
    }
}

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InventoryService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> InventoryMapper inventoryMapper;

    <span class="hljs-comment">// ä½¿ç”¨æ•°æ®åº“CASæ“ä½œ,é¿å…åŠ é”</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryDeductStock</span><span class="hljs-params">(Long skuId, <span class="hljs-type">int</span> quantity)</span> {
        <span class="hljs-comment">// UPDATE inventory SET stock = stock - #{quantity}</span>
        <span class="hljs-comment">// WHERE sku_id = #{skuId} AND stock &gt;= #{quantity}</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">affectedRows</span> <span class="hljs-operator">=</span> inventoryMapper.deductStock(skuId, quantity);
        <span class="hljs-keyword">return</span> affectedRows &gt; <span class="hljs-number">0</span>;
    }
}
</code></pre>
<p><strong>é¢„é˜²æ­»é”çš„æœ€ä½³å®è·µ:</strong></p>
<ol>
<li><strong>é¿å…åµŒå¥—é”</strong>: å°½é‡ä½¿ç”¨å•é”,å‡å°‘é”çš„åµŒå¥—å±‚çº§</li>
<li><strong>ç»Ÿä¸€é”é¡ºåº</strong>: å¦‚æœå¿…é¡»åµŒå¥—,æ‰€æœ‰çº¿ç¨‹æŒ‰ç›¸åŒé¡ºåºè·å–é”</li>
<li><strong>ä½¿ç”¨tryLock</strong>: è®¾ç½®è¶…æ—¶æ—¶é—´,é¿å…æ— é™ç­‰å¾…</li>
<li><strong>ç¼©å°é”èŒƒå›´</strong>: åªé”å¿…è¦çš„ä»£ç å—,å‡å°‘æŒé”æ—¶é—´</li>
<li><strong>ä½¿ç”¨å¹¶å‘å·¥å…·ç±»</strong>: å¦‚ConcurrentHashMapã€åŸå­ç±»,é¿å…æ˜¾å¼åŠ é”</li>
</ol>
<h3 data-id="heading-26">æ¡ˆä¾‹2:synchronizedé”ç²’åº¦è¿‡å¤§å¯¼è‡´æ€§èƒ½é—®é¢˜</h3>
<p><strong>æ•…éšœç°è±¡:</strong></p>
<p>æŸè®¢å•æŸ¥è¯¢æ¥å£åœ¨é«˜å¹¶å‘ä¸‹TPSä¸¥é‡ä¸‹é™,ä»æ­£å¸¸çš„1000 TPSé™è‡³200 TPS,å¹³å‡å“åº”æ—¶é—´ä»50msä¸Šå‡è‡³300msã€‚</p>
<p><strong>é—®é¢˜åˆ†æ:</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é—®é¢˜ä»£ç :æ•´ä¸ªæ–¹æ³•åŠ é”,é”ç²’åº¦è¿‡å¤§</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderQueryService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderMapper orderMapper;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;

    <span class="hljs-comment">// é—®é¢˜:synchronizedé”ä½æ•´ä¸ªæ–¹æ³•,åŒ…æ‹¬æ•°æ®åº“æŸ¥è¯¢å’Œç¼“å­˜æ“ä½œ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> OrderDTO <span class="hljs-title function_">getOrderDetail</span><span class="hljs-params">(Long orderId)</span> {
        <span class="hljs-comment">// 1. æŸ¥è¯¢ç¼“å­˜(çº¦50ms)</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order:"</span> + orderId;
        <span class="hljs-type">OrderDTO</span> <span class="hljs-variable">cached</span> <span class="hljs-operator">=</span> (OrderDTO) redisTemplate.opsForValue().get(cacheKey);
        <span class="hljs-keyword">if</span> (cached != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> cached;
        }

        <span class="hljs-comment">// 2. æŸ¥è¯¢æ•°æ®åº“(çº¦100ms)</span>
        <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> orderMapper.selectById(orderId);
        <span class="hljs-keyword">if</span> (order == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }

        <span class="hljs-comment">// 3. è½¬æ¢DTO(çº¦10ms)</span>
        <span class="hljs-type">OrderDTO</span> <span class="hljs-variable">dto</span> <span class="hljs-operator">=</span> convertToDTO(order);

        <span class="hljs-comment">// 4. å†™å…¥ç¼“å­˜(çº¦50ms)</span>
        redisTemplate.opsForValue().set(cacheKey, dto, <span class="hljs-number">10</span>, TimeUnit.MINUTES);

        <span class="hljs-keyword">return</span> dto;
    }

    <span class="hljs-keyword">private</span> OrderDTO <span class="hljs-title function_">convertToDTO</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-comment">// è½¬æ¢é€»è¾‘</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderDTO</span>();
    }
}
</code></pre>
<p><strong>æ€§èƒ½ç“¶é¢ˆåˆ†æ:</strong></p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">é«˜å¹¶å‘åœºæ™¯(100ä¸ªçº¿ç¨‹åŒæ—¶æŸ¥è¯¢):</span>

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         synchronizedæ–¹æ³•ä¸²è¡Œæ‰§è¡Œ                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<span class="hljs-section">Thread-1: [æŸ¥ç¼“å­˜|æŸ¥DB|è½¬æ¢|å†™ç¼“å­˜] â”€â”€â”€â–º 210ms</span>
                                        â”‚
<span class="hljs-section">Thread-2:                [æŸ¥ç¼“å­˜|æŸ¥DB|è½¬æ¢|å†™ç¼“å­˜] â”€â”€â”€â–º 420ms (ç­‰å¾…210ms)</span>
                                                       â”‚
<span class="hljs-section">Thread-3:                               [æŸ¥ç¼“å­˜|æŸ¥DB|è½¬æ¢|å†™ç¼“å­˜] â”€â”€â”€â–º 630ms (ç­‰å¾…420ms)</span>
                                                                      â”‚
<span class="hljs-section">Thread-100:                                                          ...  â”€â”€â”€â–º 21000ms (ç­‰å¾…20790ms)</span>

<span class="hljs-section">å¹³å‡å“åº”æ—¶é—´: 10500ms (å®Œå…¨ä¸å¯æ¥å—!)</span>
<span class="hljs-section">TPS: 100 / 21s â‰ˆ 4.76 (ä¸¥é‡ä¸‹é™)</span>
</code></pre>
<p><strong>ä¼˜åŒ–æ–¹æ¡ˆ1:ç¼©å°synchronizedå—èŒƒå›´</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… ä¼˜åŒ–æ–¹æ¡ˆ1:ç¼©å°synchronizedå—,åªä¿æŠ¤å…³é”®ä»£ç </span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderQueryService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderMapper orderMapper;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;

    <span class="hljs-comment">// æ¯ä¸ªè®¢å•ä¸€ä¸ªé”å¯¹è±¡,é¿å…å…¨å±€é”</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ConcurrentHashMap&lt;Long, Object&gt; locks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();

    <span class="hljs-keyword">public</span> OrderDTO <span class="hljs-title function_">getOrderDetail</span><span class="hljs-params">(Long orderId)</span> {
        <span class="hljs-comment">// 1. æŸ¥è¯¢ç¼“å­˜(ä¸åŠ é”)</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order:"</span> + orderId;
        <span class="hljs-type">OrderDTO</span> <span class="hljs-variable">cached</span> <span class="hljs-operator">=</span> (OrderDTO) redisTemplate.opsForValue().get(cacheKey);
        <span class="hljs-keyword">if</span> (cached != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> cached;
        }

        <span class="hljs-comment">// 2. ç¼“å­˜æœªå‘½ä¸­,åŠ é”æŸ¥è¯¢æ•°æ®åº“(é˜²æ­¢ç¼“å­˜å‡»ç©¿)</span>
        <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> locks.computeIfAbsent(orderId, k -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>());

        <span class="hljs-keyword">synchronized</span> (lock) {
            <span class="hljs-comment">// åŒé‡æ£€æŸ¥:å†æ¬¡æŸ¥è¯¢ç¼“å­˜</span>
            cached = (OrderDTO) redisTemplate.opsForValue().get(cacheKey);
            <span class="hljs-keyword">if</span> (cached != <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> cached;
            }

            <span class="hljs-comment">// æŸ¥è¯¢æ•°æ®åº“</span>
            <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> orderMapper.selectById(orderId);
            <span class="hljs-keyword">if</span> (order == <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
            }

            <span class="hljs-comment">// è½¬æ¢DTO</span>
            <span class="hljs-type">OrderDTO</span> <span class="hljs-variable">dto</span> <span class="hljs-operator">=</span> convertToDTO(order);

            <span class="hljs-comment">// å†™å…¥ç¼“å­˜</span>
            redisTemplate.opsForValue().set(cacheKey, dto, <span class="hljs-number">10</span>, TimeUnit.MINUTES);

            <span class="hljs-keyword">return</span> dto;
        }
        <span class="hljs-comment">// æ³¨æ„:è¿™é‡Œå¯ä»¥è€ƒè™‘æ¸…ç†locksä¸­çš„å¯¹è±¡,é¿å…å†…å­˜æ³„æ¼</span>
    }

    <span class="hljs-keyword">private</span> OrderDTO <span class="hljs-title function_">convertToDTO</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderDTO</span>();
    }
}
</code></pre>
<p><strong>ä¼˜åŒ–æ–¹æ¡ˆ2:è¯»å†™åˆ†ç¦»é”(ReadWriteLock)</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… ä¼˜åŒ–æ–¹æ¡ˆ2:ä½¿ç”¨è¯»å†™é”,å…è®¸å¤šä¸ªè¯»çº¿ç¨‹å¹¶å‘</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderQueryService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderMapper orderMapper;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;

    <span class="hljs-comment">// è¯»å†™é”:å¤šä¸ªè¯»çº¿ç¨‹å¯ä»¥å¹¶å‘,å†™çº¿ç¨‹ç‹¬å </span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ReadWriteLock</span> <span class="hljs-variable">rwLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantReadWriteLock</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Lock</span> <span class="hljs-variable">readLock</span> <span class="hljs-operator">=</span> rwLock.readLock();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Lock</span> <span class="hljs-variable">writeLock</span> <span class="hljs-operator">=</span> rwLock.writeLock();

    <span class="hljs-keyword">public</span> OrderDTO <span class="hljs-title function_">getOrderDetail</span><span class="hljs-params">(Long orderId)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">cacheKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order:"</span> + orderId;

        <span class="hljs-comment">// 1. è¯»é”:æŸ¥è¯¢ç¼“å­˜(å…è®¸å¤šçº¿ç¨‹å¹¶å‘è¯»)</span>
        readLock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">OrderDTO</span> <span class="hljs-variable">cached</span> <span class="hljs-operator">=</span> (OrderDTO) redisTemplate.opsForValue().get(cacheKey);
            <span class="hljs-keyword">if</span> (cached != <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> cached;
            }
        } <span class="hljs-keyword">finally</span> {
            readLock.unlock();
        }

        <span class="hljs-comment">// 2. å†™é”:æŸ¥è¯¢æ•°æ®åº“å¹¶å†™å…¥ç¼“å­˜(ç‹¬å )</span>
        writeLock.lock();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// åŒé‡æ£€æŸ¥</span>
            <span class="hljs-type">OrderDTO</span> <span class="hljs-variable">cached</span> <span class="hljs-operator">=</span> (OrderDTO) redisTemplate.opsForValue().get(cacheKey);
            <span class="hljs-keyword">if</span> (cached != <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> cached;
            }

            <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> orderMapper.selectById(orderId);
            <span class="hljs-keyword">if</span> (order == <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
            }

            <span class="hljs-type">OrderDTO</span> <span class="hljs-variable">dto</span> <span class="hljs-operator">=</span> convertToDTO(order);
            redisTemplate.opsForValue().set(cacheKey, dto, <span class="hljs-number">10</span>, TimeUnit.MINUTES);

            <span class="hljs-keyword">return</span> dto;
        } <span class="hljs-keyword">finally</span> {
            writeLock.unlock();
        }
    }

    <span class="hljs-keyword">private</span> OrderDTO <span class="hljs-title function_">convertToDTO</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderDTO</span>();
    }
}
</code></pre>
<p><strong>ä¼˜åŒ–æ–¹æ¡ˆ3:æ— é”åŒ–è®¾è®¡(æ¨è)</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… ä¼˜åŒ–æ–¹æ¡ˆ3:ä½¿ç”¨Guava LoadingCache,è‡ªåŠ¨åŠ è½½,æ— éœ€æ‰‹åŠ¨åŠ é”</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderQueryService</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderMapper orderMapper;

    <span class="hljs-comment">// Guava Cache:è‡ªåŠ¨åŠ è½½,çº¿ç¨‹å®‰å…¨,æ— éœ€æ‰‹åŠ¨åŠ é”</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> LoadingCache&lt;Long, OrderDTO&gt; orderCache = CacheBuilder.newBuilder()
        .maximumSize(<span class="hljs-number">10000</span>)  <span class="hljs-comment">// æœ€å¤šç¼“å­˜10000ä¸ªè®¢å•</span>
        .expireAfterWrite(<span class="hljs-number">10</span>, TimeUnit.MINUTES)  <span class="hljs-comment">// 10åˆ†é’Ÿè¿‡æœŸ</span>
        .build(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CacheLoader</span>&lt;Long, OrderDTO&gt;() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> OrderDTO <span class="hljs-title function_">load</span><span class="hljs-params">(Long orderId)</span> <span class="hljs-keyword">throws</span> Exception {
                <span class="hljs-comment">// ç¼“å­˜æœªå‘½ä¸­æ—¶è‡ªåŠ¨è°ƒç”¨æ­¤æ–¹æ³•</span>
                <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> orderMapper.selectById(orderId);
                <span class="hljs-keyword">if</span> (order == <span class="hljs-literal">null</span>) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderNotFoundException</span>(<span class="hljs-string">"è®¢å•ä¸å­˜åœ¨: "</span> + orderId);
                }
                <span class="hljs-keyword">return</span> convertToDTO(order);
            }
        });

    <span class="hljs-keyword">public</span> OrderDTO <span class="hljs-title function_">getOrderDetail</span><span class="hljs-params">(Long orderId)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// è‡ªåŠ¨å¤„ç†å¹¶å‘åŠ è½½,æ— éœ€æ‰‹åŠ¨åŠ é”</span>
            <span class="hljs-keyword">return</span> orderCache.get(orderId);
        } <span class="hljs-keyword">catch</span> (ExecutionException e) {
            <span class="hljs-keyword">if</span> (e.getCause() <span class="hljs-keyword">instanceof</span> OrderNotFoundException) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
            }
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æŸ¥è¯¢è®¢å•å¤±è´¥"</span>, e);
        }
    }

    <span class="hljs-keyword">private</span> OrderDTO <span class="hljs-title function_">convertToDTO</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderDTO</span>();
    }
}
</code></pre>
<p><strong>æ€§èƒ½æå‡å¯¹æ¯”:</strong></p>








































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>å¹¶å‘çº¿ç¨‹æ•°</th><th>å¹³å‡RT</th><th>TPS</th><th>æå‡å¹…åº¦</th></tr></thead><tbody><tr><td>synchronizedæ–¹æ³•(åŸå§‹)</td><td>100</td><td>300ms</td><td>200</td><td>-</td></tr><tr><td>ç¼©å°synchronizedå—</td><td>100</td><td>80ms</td><td>800</td><td>4å€</td></tr><tr><td>ReadWriteLock</td><td>100</td><td>60ms</td><td>1000</td><td>5å€</td></tr><tr><td>æ— é”åŒ–è®¾è®¡(Guava Cache)</td><td>100</td><td>50ms</td><td>1200</td><td>6å€</td></tr></tbody></table>
<h2 data-id="heading-27">äº”ã€å¸¸è§é—®é¢˜ä¸é¿å‘æŒ‡å—</h2>
<h3 data-id="heading-28">5.1 ä¸ºä»€ä¹ˆwait/notifyå¿…é¡»åœ¨synchronizedå—ä¸­?</h3>
<p><strong>åŸå› 1:é˜²æ­¢ä¸¢å¤±å”¤é†’(Lost Wakeup)</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é”™è¯¯ç¤ºä¾‹:ä¸åœ¨synchronizedå—ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LostWakeup</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">condition</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

    <span class="hljs-comment">// çº¿ç¨‹A:ç­‰å¾…æ¡ä»¶</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">waitForCondition</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">if</span> (!condition) {  <span class="hljs-comment">// â† æ£€æŸ¥æ¡ä»¶(æœªåŠ é”)</span>
            <span class="hljs-comment">// å‡è®¾æ­¤æ—¶çº¿ç¨‹åˆ‡æ¢,çº¿ç¨‹Bæ‰§è¡ŒnotifyCondition()</span>
            lock.wait();  <span class="hljs-comment">// â† å¯èƒ½æ°¸ä¹…é˜»å¡(notifyå·²ç»è¢«è°ƒç”¨)</span>
        }
    }

    <span class="hljs-comment">// çº¿ç¨‹B:å”¤é†’çº¿ç¨‹</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyCondition</span><span class="hljs-params">()</span> {
        condition = <span class="hljs-literal">true</span>;
        lock.notify();  <span class="hljs-comment">// â† notifyåœ¨wait()ä¹‹å‰è¢«è°ƒç”¨,ä¸¢å¤±å”¤é†’</span>
    }
}
</code></pre>
<p><strong>æ—¶é—´çº¿åˆ†æ:</strong></p>
<pre><code class="hljs language-scss" lang="scss">æ—¶é—´ | çº¿ç¨‹<span class="hljs-selector-tag">A</span> | çº¿ç¨‹<span class="hljs-selector-tag">B</span>
-----|-------|-------
T1   | if (!condition)  <span class="hljs-comment">// false,å‡†å¤‡wait() |</span>
T2   |                  | condition = true; <span class="hljs-built_in">notify</span>(); â† notifyå…ˆæ‰§è¡Œ
T3   | lock<span class="hljs-selector-class">.wait</span>();  â† æ°¸ä¹…é˜»å¡(notifyå·²ä¸¢å¤±) |
</code></pre>
<p><strong>åŸå› 2:ä¿è¯åŸå­æ€§</strong></p>
<p>wait/notifyé€šå¸¸ä¼´éšå…±äº«å˜é‡çš„åˆ¤æ–­å’Œä¿®æ”¹,éœ€è¦åŒæ­¥ä¿æŠ¤ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… æ­£ç¡®ç¤ºä¾‹:åœ¨synchronizedå—ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CorrectWaitNotify</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">condition</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">waitForCondition</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">synchronized</span> (lock) {  <span class="hljs-comment">// â† å…ˆè·å–é”</span>
            <span class="hljs-keyword">while</span> (!condition) {  <span class="hljs-comment">// â† åŸå­æ€§æ£€æŸ¥æ¡ä»¶</span>
                lock.wait();  <span class="hljs-comment">// â† é‡Šæ”¾é”,ç­‰å¾…é€šçŸ¥</span>
            }
            <span class="hljs-comment">// è¢«å”¤é†’å,é‡æ–°æŒæœ‰é”,ç»§ç»­æ‰§è¡Œ</span>
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyCondition</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (lock) {  <span class="hljs-comment">// â† å…ˆè·å–é”</span>
            condition = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// â† åŸå­æ€§ä¿®æ”¹æ¡ä»¶</span>
            lock.notifyAll();  <span class="hljs-comment">// â† å”¤é†’ç­‰å¾…çº¿ç¨‹</span>
        }
    }
}
</code></pre>
<h3 data-id="heading-29">5.2 synchronizedé”çš„æ˜¯ä»€ä¹ˆ?</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SynchronizedTarget</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">staticLock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

    <span class="hljs-comment">// 1. synchronizedä¿®é¥°æ™®é€šæ–¹æ³•:é”çš„æ˜¯thiså¯¹è±¡</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method1</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ç­‰ä»·äº: synchronized (this) { ... }</span>
    }

    <span class="hljs-comment">// 2. synchronizedä¿®é¥°é™æ€æ–¹æ³•:é”çš„æ˜¯Classå¯¹è±¡</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method2</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ç­‰ä»·äº: synchronized (SynchronizedTarget.class) { ... }</span>
    }

    <span class="hljs-comment">// 3. synchronized(this):é”çš„æ˜¯å½“å‰å®ä¾‹å¯¹è±¡</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method3</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) {
            <span class="hljs-comment">// ä¸method1()ç«äº‰åŒä¸€æŠŠé”</span>
        }
    }

    <span class="hljs-comment">// 4. synchronized(lock):é”çš„æ˜¯lockå¯¹è±¡</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method4</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (lock) {
            <span class="hljs-comment">// ç‹¬ç«‹çš„é”,ä¸ä¸å…¶ä»–æ–¹æ³•ç«äº‰</span>
        }
    }

    <span class="hljs-comment">// 5. synchronized(Classå¯¹è±¡):é”çš„æ˜¯ç±»é”</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method5</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (SynchronizedTarget.class) {
            <span class="hljs-comment">// ä¸method2()ç«äº‰åŒä¸€æŠŠé”</span>
        }
    }
}
</code></pre>
<p><strong>æ³¨æ„äº‹é¡¹:</strong></p>
<ul>
<li><strong>ä¸åŒå®ä¾‹çš„synchronizedæ–¹æ³•ä¸äº’æ–¥</strong>:æ¯ä¸ªå®ä¾‹æœ‰è‡ªå·±çš„é”(this)</li>
<li><strong>é™æ€synchronizedæ–¹æ³•ä¸æ™®é€šsynchronizedæ–¹æ³•ä¸äº’æ–¥</strong>:é”çš„æ˜¯ä¸åŒå¯¹è±¡(Class vs this)</li>
<li><strong>Stringã€Integerç­‰å¸¸é‡æ± å¯¹è±¡ä¸è¦ä½œä¸ºé”</strong>:å¯èƒ½è¢«å¤šä¸ªåœ°æ–¹å…±äº«,å¯¼è‡´æ„å¤–çš„é”ç«äº‰</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é”™è¯¯:ä½¿ç”¨Stringä½œä¸ºé”</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StringLockProblem</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-string">"LOCK"</span>;  <span class="hljs-comment">// â† å­—ç¬¦ä¸²å¸¸é‡,å¯èƒ½è¢«å…¶ä»–ä»£ç å…±äº«</span>

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (lock) {  <span class="hljs-comment">// â† å¯èƒ½ä¸å…¶ä»–ä½¿ç”¨"LOCK"å­—ç¬¦ä¸²çš„ä»£ç ç«äº‰åŒä¸€æŠŠé”</span>
            <span class="hljs-comment">// ...</span>
        }
    }
}

<span class="hljs-comment">// âœ… æ­£ç¡®:ä½¿ç”¨new Object()ä½œä¸ºé”</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ObjectLockCorrect</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();  <span class="hljs-comment">// â† ç‹¬ç«‹çš„é”å¯¹è±¡</span>

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (lock) {
            <span class="hljs-comment">// ...</span>
        }
    }
}
</code></pre>
<h3 data-id="heading-30">5.3 volatileèƒ½ä¿è¯åŸå­æ€§å—?ä¸ºä»€ä¹ˆi++ä¸å®‰å…¨?</h3>
<p><strong>ç­”æ¡ˆ:volatileä¸èƒ½ä¿è¯åŸå­æ€§ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VolatileNotAtomic</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        count++;  <span class="hljs-comment">// âŒ ä¸æ˜¯åŸå­æ“ä½œ!</span>
    }
}
</code></pre>
<p><strong>count++çš„å­—èŠ‚ç åˆ†æ:</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">count++å®é™…åˆ†ä¸º<span class="hljs-number">3</span>ä¸ªæ­¥éª¤:

<span class="hljs-number">1.</span> LOAD:   ä»ä¸»å†…å­˜è¯»å–countçš„å€¼åˆ°å·¥ä½œå†…å­˜  (è¯»æ“ä½œ)
<span class="hljs-number">2.</span> ADD:    å·¥ä½œå†…å­˜ä¸­countå€¼+<span class="hljs-number">1</span>              (è®¡ç®—æ“ä½œ)
<span class="hljs-number">3.</span> STORE:  å°†æ–°å€¼å†™å›ä¸»å†…å­˜                 (å†™æ“ä½œ)

å­—èŠ‚ç :
  getstatic     count    <span class="hljs-comment">// è¯»å–count</span>
  iconst_1               <span class="hljs-comment">// åŠ è½½å¸¸é‡1</span>
  iadd                   <span class="hljs-comment">// ç›¸åŠ </span>
  putstatic     count    <span class="hljs-comment">// å†™å›count</span>
</code></pre>
<p><strong>å¹¶å‘é—®é¢˜åœºæ™¯:</strong></p>
<pre><code class="hljs language-ini" lang="ini">åˆå§‹: <span class="hljs-attr">count</span> = <span class="hljs-number">0</span>

æ—¶é—´çº¿:
T1: çº¿ç¨‹Aè¯»å–<span class="hljs-attr">count</span>=<span class="hljs-number">0</span>              (LOAD)
T2: çº¿ç¨‹Bè¯»å–<span class="hljs-attr">count</span>=<span class="hljs-number">0</span>              (LOAD)
T3: çº¿ç¨‹Aè®¡ç®—0+<span class="hljs-attr">1</span>=<span class="hljs-number">1</span>                (ADD)
T4: çº¿ç¨‹Bè®¡ç®—0+<span class="hljs-attr">1</span>=<span class="hljs-number">1</span>                (ADD)
T5: çº¿ç¨‹Aå†™å›<span class="hljs-attr">count</span>=<span class="hljs-number">1</span>              (STORE)
T6: çº¿ç¨‹Bå†™å›<span class="hljs-attr">count</span>=<span class="hljs-number">1</span>              (STORE)  â† è¦†ç›–äº†çº¿ç¨‹Açš„ç»“æœ

é¢„æœŸç»“æœ: <span class="hljs-attr">count</span> = <span class="hljs-number">2</span>
å®é™…ç»“æœ: <span class="hljs-attr">count</span> = <span class="hljs-number">1</span>  â† ä¸¢å¤±äº†ä¸€æ¬¡æ›´æ–°!
</code></pre>
<p><strong>volatileåªä¿è¯äº†æ¯æ¬¡è¯»å†™çš„å¯è§æ€§,ä½†æ— æ³•ä¿è¯å¤šæ­¥æ“ä½œçš„åŸå­æ€§ã€‚</strong></p>
<p><strong>æ­£ç¡®åšæ³•:</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ–¹æ¡ˆ1:ä½¿ç”¨synchronized</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
    count++;
}

<span class="hljs-comment">// æ–¹æ¡ˆ2:ä½¿ç”¨AtomicInteger</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">0</span>);
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
    count.incrementAndGet();  <span class="hljs-comment">// CASåŸå­æ“ä½œ</span>
}
</code></pre>
<h3 data-id="heading-31">5.4 ä»€ä¹ˆæ—¶å€™ç”¨synchronized,ä»€ä¹ˆæ—¶å€™ç”¨volatile?</h3>








































<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ–¹æ¡ˆ</th><th>åŸå› </th></tr></thead><tbody><tr><td>ç®€å•çŠ¶æ€æ ‡å¿—</td><td>volatile</td><td>åªéœ€è¦å¯è§æ€§,æ— å¤åˆæ“ä½œ</td></tr><tr><td>ä¸€æ¬¡æ€§å®‰å…¨å‘å¸ƒ(DCLå•ä¾‹)</td><td>volatile</td><td>é˜²æ­¢æŒ‡ä»¤é‡æ’åº</td></tr><tr><td>è®¡æ•°å™¨(i++)</td><td>synchronized / AtomicInteger</td><td>éœ€è¦åŸå­æ€§</td></tr><tr><td>å¤åˆæ“ä½œ(check-then-act)</td><td>synchronized</td><td>éœ€è¦åŸå­æ€§å’Œå¯è§æ€§</td></tr><tr><td>ä¸´ç•ŒåŒºä¿æŠ¤</td><td>synchronized</td><td>éœ€è¦äº’æ–¥è®¿é—®</td></tr><tr><td>é•¿æ—¶é—´æŒé”</td><td>Lock</td><td>æ”¯æŒè¶…æ—¶ã€ä¸­æ–­ã€å…¬å¹³é”</td></tr></tbody></table>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… é€‚åˆvolatileçš„åœºæ™¯</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VolatileSuitable</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">shutdownRequested</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">shutdown</span><span class="hljs-params">()</span> {
        shutdownRequested = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// ç®€å•èµ‹å€¼,æ— å¤åˆæ“ä½œ</span>
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doWork</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">while</span> (!shutdownRequested) {  <span class="hljs-comment">// åªè¯»å–,ä¸ä¿®æ”¹</span>
            <span class="hljs-comment">// ...</span>
        }
    }
}

<span class="hljs-comment">// âŒ ä¸é€‚åˆvolatileçš„åœºæ™¯</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VolatileNotSuitable</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        count++;  <span class="hljs-comment">// âŒ å¤åˆæ“ä½œ,volatileæ— æ³•ä¿è¯åŸå­æ€§</span>
    }

    <span class="hljs-comment">// âœ… åº”è¯¥ä½¿ç”¨synchronized</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">incrementCorrect</span><span class="hljs-params">()</span> {
        count++;
    }
}
</code></pre>
<h3 data-id="heading-32">5.5 Thread.sleep()å’ŒObject.wait()çš„åŒºåˆ«</h3>



































<table><thead><tr><th>ç‰¹æ€§</th><th>Thread.sleep()</th><th>Object.wait()</th></tr></thead><tbody><tr><td>æ‰€å±ç±»</td><td>Threadç±»(é™æ€æ–¹æ³•)</td><td>Objectç±»(å®ä¾‹æ–¹æ³•)</td></tr><tr><td>æ˜¯å¦é‡Šæ”¾é”</td><td>âŒ ä¸é‡Šæ”¾</td><td>âœ… é‡Šæ”¾</td></tr><tr><td>æ˜¯å¦éœ€è¦åœ¨synchronizedä¸­</td><td>âŒ ä¸éœ€è¦</td><td>âœ… å¿…é¡»</td></tr><tr><td>å”¤é†’æ–¹å¼</td><td>æ—¶é—´åˆ°è‡ªåŠ¨å”¤é†’</td><td>notify/notifyAllå”¤é†’æˆ–è¶…æ—¶</td></tr><tr><td>ä½¿ç”¨åœºæ™¯</td><td>æš‚åœæ‰§è¡Œä¸€æ®µæ—¶é—´</td><td>çº¿ç¨‹é—´åä½œ,ç­‰å¾…æ¡ä»¶æ»¡è¶³</td></tr></tbody></table>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SleepVsWait</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Object</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSleep</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">synchronized</span> (lock) {
            System.out.println(<span class="hljs-string">"æŒæœ‰é”,å‡†å¤‡sleep"</span>);
            Thread.sleep(<span class="hljs-number">2000</span>);  <span class="hljs-comment">// â† ä¸é‡Šæ”¾é”,æŒæœ‰2ç§’</span>
            System.out.println(<span class="hljs-string">"sleepç»“æŸ,ä»æŒæœ‰é”"</span>);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testWait</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-keyword">synchronized</span> (lock) {
            System.out.println(<span class="hljs-string">"æŒæœ‰é”,å‡†å¤‡wait"</span>);
            lock.wait();  <span class="hljs-comment">// â† é‡Šæ”¾é”,ç­‰å¾…è¢«å”¤é†’</span>
            System.out.println(<span class="hljs-string">"è¢«å”¤é†’,é‡æ–°è·å¾—é”"</span>);
        }
    }
}
</code></pre>
<h3 data-id="heading-33">5.6 å¦‚ä½•ä¼˜é›…åœ°åœæ­¢ä¸€ä¸ªçº¿ç¨‹?</h3>
<p><strong>âŒ é”™è¯¯æ–¹å¼:ä½¿ç”¨stop()æ–¹æ³•(å·²åºŸå¼ƒ)</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
    <span class="hljs-comment">// ...</span>
});
thread.start();
thread.stop();  <span class="hljs-comment">// âŒ å·²åºŸå¼ƒ,ä¸å®‰å…¨!ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´</span>
</code></pre>
<p><strong>âœ… æ­£ç¡®æ–¹å¼1:ä½¿ç”¨volatileæ ‡å¿—ä½</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StopThreadWithFlag</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">stopRequested</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">while</span> (!stopRequested) {
                <span class="hljs-comment">// æ‰§è¡Œä»»åŠ¡</span>
            }
            System.out.println(<span class="hljs-string">"çº¿ç¨‹ä¼˜é›…åœæ­¢"</span>);
        }).start();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
        stopRequested = <span class="hljs-literal">true</span>;
    }
}
</code></pre>
<p><strong>âœ… æ­£ç¡®æ–¹å¼2:ä½¿ç”¨interrupt()ä¸­æ–­</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StopThreadWithInterrupt</span> {
    <span class="hljs-keyword">private</span> Thread thread;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
        thread = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">while</span> (!Thread.currentThread().isInterrupted()) {
                    <span class="hljs-comment">// æ‰§è¡Œä»»åŠ¡</span>
                    Thread.sleep(<span class="hljs-number">1000</span>);  <span class="hljs-comment">// å“åº”ä¸­æ–­</span>
                }
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                <span class="hljs-comment">// æ•è·ä¸­æ–­å¼‚å¸¸,æ‰§è¡Œæ¸…ç†å·¥ä½œ</span>
                System.out.println(<span class="hljs-string">"çº¿ç¨‹è¢«ä¸­æ–­"</span>);
            }
            System.out.println(<span class="hljs-string">"çº¿ç¨‹ä¼˜é›…åœæ­¢"</span>);
        });
        thread.start();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stop</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (thread != <span class="hljs-literal">null</span>) {
            thread.interrupt();  <span class="hljs-comment">// å‘é€ä¸­æ–­ä¿¡å·</span>
        }
    }
}
</code></pre>
<h3 data-id="heading-34">5.7 synchronizedæ–¹æ³•å’Œsynchronized(this)çš„åŒºåˆ«?</h3>
<p><strong>ç­”æ¡ˆ:æ²¡æœ‰æœ¬è´¨åŒºåˆ«,synchronizedæ–¹æ³•æ˜¯synchronized(this)çš„è¯­æ³•ç³–ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SynchronizedMethodVsBlock</span> {
    <span class="hljs-comment">// æ–¹å¼1:synchronizedæ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method1</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ...</span>
    }

    <span class="hljs-comment">// æ–¹å¼2:synchronized(this)ä»£ç å—</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method2</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) {
            <span class="hljs-comment">// ...</span>
        }
    }

    <span class="hljs-comment">// ä¸¤è€…ç­‰ä»·,é”çš„éƒ½æ˜¯thiså¯¹è±¡</span>
}
</code></pre>
<p><strong>åŒºåˆ«:</strong></p>
<ul>
<li><strong>é”ç²’åº¦</strong>: synchronizedæ–¹æ³•é”æ•´ä¸ªæ–¹æ³•,synchronizedå—å¯ä»¥åªé”éƒ¨åˆ†ä»£ç </li>
<li><strong>çµæ´»æ€§</strong>: synchronizedå—å¯ä»¥é€‰æ‹©é”å¯¹è±¡,synchronizedæ–¹æ³•å›ºå®šé”this</li>
</ul>
<p><strong>æ¨èä½¿ç”¨synchronizedå—</strong>:é”ç²’åº¦æ›´å°,æ€§èƒ½æ›´å¥½ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âœ… æ¨è:ç¼©å°é”èŒƒå›´</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// ä¸éœ€è¦åŒæ­¥çš„ä»£ç (å¦‚å‚æ•°æ ¡éªŒ)</span>
    <span class="hljs-keyword">if</span> (param == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>();
    }

    <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) {
        <span class="hljs-comment">// åªé”å¿…è¦çš„ä»£ç </span>
    }

    <span class="hljs-comment">// ä¸éœ€è¦åŒæ­¥çš„ä»£ç (å¦‚æ—¥å¿—è®°å½•)</span>
}
</code></pre>
<h3 data-id="heading-35">5.8 é™æ€synchronizedæ–¹æ³•é”çš„æ˜¯ä»€ä¹ˆ?</h3>
<p><strong>ç­”æ¡ˆ:é”çš„æ˜¯Classå¯¹è±¡,å³ç±»é”ã€‚</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StaticSynchronizedMethod</span> {
    <span class="hljs-comment">// é™æ€synchronizedæ–¹æ³•:é”çš„æ˜¯StaticSynchronizedMethod.class</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">staticMethod</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ç­‰ä»·äº: synchronized (StaticSynchronizedMethod.class) { ... }</span>
    }

    <span class="hljs-comment">// ç­‰ä»·å†™æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">staticMethodEquivalent</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">synchronized</span> (StaticSynchronizedMethod.class) {
            <span class="hljs-comment">// ...</span>
        }
    }
}
</code></pre>
<p><strong>ç±»é” vs å¯¹è±¡é”:</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassLockVsObjectLock</span> {
    <span class="hljs-comment">// ç±»é”(æ‰€æœ‰å®ä¾‹å…±äº«)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">staticMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"ç±»é”"</span>);
    }

    <span class="hljs-comment">// å¯¹è±¡é”(æ¯ä¸ªå®ä¾‹ç‹¬ç«‹)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">instanceMethod</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"å¯¹è±¡é”"</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">ClassLockVsObjectLock</span> <span class="hljs-variable">obj1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassLockVsObjectLock</span>();
        <span class="hljs-type">ClassLockVsObjectLock</span> <span class="hljs-variable">obj2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassLockVsObjectLock</span>();

        <span class="hljs-comment">// åœºæ™¯1:ä¸¤ä¸ªçº¿ç¨‹è°ƒç”¨ä¸åŒå®ä¾‹çš„instanceMethod()</span>
        <span class="hljs-comment">// ç»“æœ:ä¸äº’æ–¥(ä¸åŒå¯¹è±¡é”)</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(obj1::instanceMethod).start();
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(obj2::instanceMethod).start();

        <span class="hljs-comment">// åœºæ™¯2:ä¸¤ä¸ªçº¿ç¨‹è°ƒç”¨staticMethod()</span>
        <span class="hljs-comment">// ç»“æœ:äº’æ–¥(åŒä¸€ä¸ªç±»é”)</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(ClassLockVsObjectLock::staticMethod).start();
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(ClassLockVsObjectLock::staticMethod).start();

        <span class="hljs-comment">// åœºæ™¯3:ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨staticMethod(),å¦ä¸€ä¸ªè°ƒç”¨instanceMethod()</span>
        <span class="hljs-comment">// ç»“æœ:ä¸äº’æ–¥(ä¸åŒçš„é”)</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(ClassLockVsObjectLock::staticMethod).start();
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(obj1::instanceMethod).start();
    }
}
</code></pre>
<h2 data-id="heading-36">å…­ã€æœ€ä½³å®è·µä¸æ€»ç»“</h2>
<h3 data-id="heading-37">6.1 å¹¶å‘ç¼–ç¨‹ä¸‰å¤§ç‰¹æ€§ä¿è¯</h3>

































<table><thead><tr><th>ç‰¹æ€§</th><th>synchronized</th><th>volatile</th><th>Lock</th><th>Atomicç±»</th></tr></thead><tbody><tr><td>åŸå­æ€§</td><td>âœ…</td><td>âŒ (å•æ¬¡è¯»å†™æ˜¯åŸå­çš„)</td><td>âœ…</td><td>âœ…</td></tr><tr><td>å¯è§æ€§</td><td>âœ…</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>æœ‰åºæ€§</td><td>âœ…</td><td>âœ… (ç¦æ­¢é‡æ’åº)</td><td>âœ…</td><td>âœ…</td></tr></tbody></table>
<p><strong>ä¿è¯æ–¹å¼:</strong></p>
<ol>
<li><strong>åŸå­æ€§</strong>: synchronizedã€Lockã€Atomicç±»çš„CASæ“ä½œ</li>
<li><strong>å¯è§æ€§</strong>: volatileã€synchronized(unlockæ—¶åˆ·æ–°ä¸»å†…å­˜)ã€Lockã€final</li>
<li><strong>æœ‰åºæ€§</strong>: volatile(å†…å­˜å±éšœ)ã€synchronized(ä¸²è¡Œæ‰§è¡Œ)ã€happens-beforeè§„åˆ™</li>
</ol>
<h3 data-id="heading-38">6.2 synchronized vs Locké€‰æ‹©æŒ‡å—</h3>
<pre><code class="hljs language-arduino" lang="arduino">é€‰æ‹©<span class="hljs-keyword">synchronized</span>çš„åœºæ™¯:
â”œâ”€ ç®€å•çš„åŒæ­¥éœ€æ±‚(å¦‚ç®€å•çš„è®¡æ•°å™¨)
â”œâ”€ ä¸éœ€è¦é«˜çº§ç‰¹æ€§(è¶…æ—¶ã€ä¸­æ–­ã€å…¬å¹³é”)
â”œâ”€ JDK <span class="hljs-number">1.6</span>+ç‰ˆæœ¬(<span class="hljs-keyword">synchronized</span>å·²ä¼˜åŒ–,æ€§èƒ½æ¥è¿‘Lock)
â””â”€ ä»£ç ç®€æ´æ€§ä¼˜å…ˆ

é€‰æ‹©Lockçš„åœºæ™¯:
â”œâ”€ éœ€è¦å°è¯•éé˜»å¡è·å–é”(tryLock)
â”œâ”€ éœ€è¦å¯ä¸­æ–­è·å–é”(lockInterruptibly)
â”œâ”€ éœ€è¦è¶…æ—¶è·å–é”(<span class="hljs-built_in">tryLock</span>(timeout))
â”œâ”€ éœ€è¦å…¬å¹³é”(<span class="hljs-keyword">new</span> <span class="hljs-built_in">ReentrantLock</span>(<span class="hljs-literal">true</span>))
â”œâ”€ éœ€è¦è¯»å†™åˆ†ç¦»(ReadWriteLock)
â”œâ”€ éœ€è¦Conditionå¤šæ¡ä»¶ç­‰å¾…
â””â”€ éœ€è¦æ›´çµæ´»çš„é”æ§åˆ¶
</code></pre>
<p><strong>ç¤ºä¾‹å¯¹æ¯”:</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åœºæ™¯1:ç®€å•åŒæ­¥ â†’ ä½¿ç”¨synchronized</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleCounter</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">increment</span><span class="hljs-params">()</span> {
        count++;
    }
}

<span class="hljs-comment">// åœºæ™¯2:éœ€è¦è¶…æ—¶è·å–é” â†’ ä½¿ç”¨Lock</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TimeoutLock</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Lock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantLock</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryOperation</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">if</span> (lock.tryLock(<span class="hljs-number">1</span>, TimeUnit.SECONDS)) {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-comment">// æ‰§è¡Œæ“ä½œ</span>
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
                } <span class="hljs-keyword">finally</span> {
                    lock.unlock();
                }
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// è¶…æ—¶,æ”¾å¼ƒæ“ä½œ</span>
            }
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            Thread.currentThread().interrupt();
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
}
</code></pre>
<h3 data-id="heading-39">6.3 çº¿ç¨‹å®‰å…¨çš„è®¾è®¡åŸåˆ™</h3>
<ol>
<li><strong>ä¸å¯å˜å¯¹è±¡ä¼˜å…ˆ</strong>: ä½¿ç”¨finalã€ä¸å¯å˜é›†åˆ(Collections.unmodifiableXxx)</li>
<li><strong>æœ€å°åŒ–é”èŒƒå›´</strong>: åªé”å¿…è¦çš„ä»£ç ,å‡å°‘æŒé”æ—¶é—´</li>
<li><strong>é¿å…åµŒå¥—é”</strong>: å‡å°‘æ­»é”é£é™©,ä½¿ç”¨å•é”æˆ–æ— é”è®¾è®¡</li>
<li><strong>ä½¿ç”¨å¹¶å‘å·¥å…·ç±»</strong>: ConcurrentHashMapã€AtomicIntegerç­‰,é¿å…æ˜¾å¼åŠ é”</li>
<li><strong>çº¿ç¨‹å°é—­</strong>: ThreadLocalã€æ ˆå°é—­,é¿å…å…±äº«å˜é‡</li>
<li><strong>æ— çŠ¶æ€è®¾è®¡</strong>: StatelessæœåŠ¡,å¤©ç„¶çº¿ç¨‹å®‰å…¨</li>
</ol>
<h3 data-id="heading-40">6.4 é«˜æ€§èƒ½å¹¶å‘ç¼–ç¨‹å»ºè®®</h3>
<ol>
<li>
<p><strong>å‡å°‘é”ç«äº‰:</strong></p>
<ul>
<li>ç¼©å°é”ç²’åº¦(ç»†ç²’åº¦é”ã€åˆ†æ®µé”)</li>
<li>å‡å°‘æŒé”æ—¶é—´</li>
<li>ä½¿ç”¨è¯»å†™é”(ReadWriteLock)</li>
<li>ä½¿ç”¨æ— é”ç®—æ³•(CAS)</li>
</ul>
</li>
<li>
<p><strong>é¿å…ä¼ªå…±äº«(False Sharing):</strong></p>
<ul>
<li>ä½¿ç”¨@Contendedæ³¨è§£(JDK 8+)</li>
<li>æ‰‹åŠ¨å¡«å……ç¼“å­˜è¡Œ</li>
</ul>
</li>
<li>
<p><strong>åˆç†ä½¿ç”¨çº¿ç¨‹æ± :</strong></p>
<ul>
<li>é¿å…é¢‘ç¹åˆ›å»ºé”€æ¯çº¿ç¨‹</li>
<li>æ ¹æ®ä»»åŠ¡ç‰¹æ€§é€‰æ‹©çº¿ç¨‹æ± ç±»å‹(CPUå¯†é›†å‹ vs IOå¯†é›†å‹)</li>
<li>è®¾ç½®åˆç†çš„é˜Ÿåˆ—å¤§å°å’Œæ‹’ç»ç­–ç•¥</li>
</ul>
</li>
<li>
<p><strong>å¼‚æ­¥åŒ–è®¾è®¡:</strong></p>
<ul>
<li>ä½¿ç”¨CompletableFutureã€å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—</li>
<li>è§£è€¦åŒæ­¥è°ƒç”¨,æé«˜ååé‡</li>
</ul>
</li>
</ol>
<h3 data-id="heading-41">6.5 ä»£ç å®¡æŸ¥Checklist</h3>
<p>å¹¶å‘ç¼–ç¨‹ä»£ç å®¡æŸ¥æ—¶,é‡ç‚¹æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹:</p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å…±äº«å˜é‡æ˜¯å¦æ­£ç¡®åŒæ­¥(synchronizedã€volatileã€Lock)</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ˜¯å¦å­˜åœ¨ç«æ€æ¡ä»¶(check-then-actã€read-modify-write)</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ˜¯å¦æ­£ç¡®ä½¿ç”¨wait/notify(åœ¨synchronizedå—ä¸­ã€ä½¿ç”¨whileå¾ªç¯)</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ˜¯å¦å­˜åœ¨æ­»é”é£é™©(åµŒå¥—é”ã€é”é¡ºåºä¸ä¸€è‡´)</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> synchronized/Lockæ˜¯å¦æ­£ç¡®é‡Šæ”¾(ä½¿ç”¨finallyå—)</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> volatileæ˜¯å¦è¢«è¯¯ç”¨(å¤åˆæ“ä½œåº”ä½¿ç”¨synchronized)</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> çº¿ç¨‹åœæ­¢æ˜¯å¦ä¼˜é›…(ä½¿ç”¨æ ‡å¿—ä½æˆ–interrupt,ä¸ä½¿ç”¨stop)</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ˜¯å¦ä½¿ç”¨äº†çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»(ConcurrentHashMap vs HashMap)</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ˜¯å¦è€ƒè™‘äº†å¯è§æ€§ã€åŸå­æ€§ã€æœ‰åºæ€§ä¸‰å¤§ç‰¹æ€§</li>
</ul>
<h3 data-id="heading-42">6.6 æ€»ç»“</h3>
<p>Javaå¹¶å‘ç¼–ç¨‹æ˜¯ä¸€ä¸ªå¤æ‚ä½†å¿…é¡»æŒæ¡çš„é¢†åŸŸã€‚æœ¬æ–‡ä»çº¿ç¨‹åŸºç¡€å‡ºå‘,æ·±å…¥å‰–æäº†synchronizedå’Œvolatileçš„åº•å±‚åŸç†,ç»“åˆç”µå•†ä¸šåŠ¡åœºæ™¯å±•ç¤ºäº†å®æˆ˜åº”ç”¨,å¹¶é€šè¿‡ç”Ÿäº§æ¡ˆä¾‹åˆ†æäº†æ­»é”å’Œæ€§èƒ½é—®é¢˜çš„æ’æŸ¥æ–¹æ³•ã€‚</p>
<p><strong>æ ¸å¿ƒè¦ç‚¹:</strong></p>
<ol>
<li><strong>synchronizedæ˜¯Javaå†…ç½®çš„äº’æ–¥é”</strong>,JDK 1.6åå¼•å…¥äº†é”å‡çº§æœºåˆ¶(åå‘é”â†’è½»é‡çº§é”â†’é‡é‡çº§é”),æ€§èƒ½å¤§å¹…æå‡</li>
<li><strong>volatileä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§</strong>,ä½†ä¸ä¿è¯åŸå­æ€§,é€‚ç”¨äºçŠ¶æ€æ ‡å¿—å’Œä¸€æ¬¡æ€§å®‰å…¨å‘å¸ƒ</li>
<li><strong>wait/notifyå¿…é¡»åœ¨synchronizedå—ä¸­ä½¿ç”¨</strong>,é˜²æ­¢ä¸¢å¤±å”¤é†’å’Œä¿è¯åŸå­æ€§</li>
<li><strong>çº¿ç¨‹å®‰å…¨çš„ä¸‰å¤§ç‰¹æ€§</strong>(åŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§)æ˜¯å¹¶å‘ç¼–ç¨‹çš„æ ¸å¿ƒ</li>
<li><strong>é”ç²’åº¦ä¼˜åŒ–</strong>æ˜¯æå‡å¹¶å‘æ€§èƒ½çš„å…³é”®,ç¼©å°é”èŒƒå›´ã€ä½¿ç”¨è¯»å†™é”ã€æ— é”åŒ–è®¾è®¡</li>
<li><strong>æ­»é”çš„é¢„é˜²</strong>:é¿å…åµŒå¥—é”ã€ç»Ÿä¸€é”é¡ºåºã€ä½¿ç”¨tryLockè¶…æ—¶æœºåˆ¶</li>
</ol>
<p>åœ¨å®é™…å¼€å‘ä¸­,åº”æ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„å¹¶å‘æ§åˆ¶æ‰‹æ®µ,éµå¾ªæœ€ä½³å®è·µ,ç¼–å†™é«˜æ€§èƒ½ã€çº¿ç¨‹å®‰å…¨çš„ä»£ç ã€‚å¹¶å‘ç¼–ç¨‹æ²¡æœ‰é“¶å¼¹,éœ€è¦åœ¨æ­£ç¡®æ€§ã€æ€§èƒ½ã€å¤æ‚åº¦ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ç‚¹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[webpackè¿ç§»rsbuildâ€”â€”é…ç½®æ·±åº¦å¯¹æ¯”]]></title>    <link>https://juejin.cn/post/7585139951345909811</link>    <guid>https://juejin.cn/post/7585139951345909811</guid>    <pubDate>2025-12-19T08:17:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585139951345909811" data-draft-id="7584711683773284352" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="webpackè¿ç§»rsbuildâ€”â€”é…ç½®æ·±åº¦å¯¹æ¯”"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-19T08:17:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¸ƒåˆ—ç‘Ÿå†œçš„æ˜Ÿç©º"/> <meta itemprop="url" content="https://juejin.cn/user/976022056218471"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            webpackè¿ç§»rsbuildâ€”â€”é…ç½®æ·±åº¦å¯¹æ¯”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/976022056218471/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¸ƒåˆ—ç‘Ÿå†œçš„æ˜Ÿç©º
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T08:17:37.000Z" title="Fri Dec 19 2025 08:17:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç»¼åˆå¯¹æ¯”</h2>
<p>webpacké¡¹ç›®æ•´ä½“ä¸Šå¯ä»¥æ— ç—›è¿ç§»åˆ°rsbuildï¼Œå…¶ä¸­rspackå¯¹æ ‡webpackï¼Œswcå¯¹æ ‡babelå’Œterserï¼Œè¿™äº›å¯¹æ ‡ä¸ä»…æ˜¯ä»èƒ½åŠ›ä¸Šå¯¹æ ‡ï¼Œæ›´æ˜¯å‚è€ƒäº†ç›®æ ‡çš„å¤§é‡é…ç½®apiè®¾è®¡ï¼Œå› æ­¤ç»å¤§å¤šæ•°é‡è¦èƒ½åŠ›çš„é…ç½®apiéƒ½å¯ä»¥æ²¿ç”¨webpackçš„ï¼Œè¿ç§»è¿‡ç¨‹ä¸­å‡ ä¹ä¸éœ€è¦å…³æ³¨èƒ½åŠ›/ç‰¹æ€§ä¸¢å¤±é—®é¢˜ï¼Œä½“éªŒæä½³ã€‚</p>
<h2 data-id="heading-1">ç¼–è¯‘</h2>
<h3 data-id="heading-2">js(x)/ts(x)ç¼–è¯‘</h3>
<p>webapckå¤§å¤šåŸºäºbabelï¼ŒrsbuildåŸºäºswcï¼Œswcçš„é…ç½®ä¹Ÿå¯¹æ ‡äº†babelå¸¸ç”¨çš„presetå’Œplugin,å¦‚@babel/preset-reactï¼Œä¸è¿‡ä¹Ÿç¼ºå¤±äº†ä¸€äº›ç»†èŠ‚ä¼˜åŒ–æ’ä»¶ï¼Œå¦‚@babel/plugin-proposal-class-propertiesã€‚</p>
<p>rsbuildæä¾›äº†å¸¸ç”¨çš„é…ç½®æ’ä»¶ï¼Œé»˜è®¤å€¼çš„è®¾ç½®ä¹Ÿæ¯”è¾ƒè´´è¿‘å®è·µï¼Œä½¿ç”¨æ›´ä¸ºç®€å•ï¼Œæ¯”å¦‚å¯¹reactçš„ç¼–è¯‘ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { pluginReact } <span class="hljs-keyword">from</span> <span class="hljs-string">'@rsbuild/plugin-react'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">plugins</span>: [<span class="hljs-title function_">pluginReact</span>()],
};
</code></pre>
<p>å¦‚æœç¡®å®éœ€è¦ä½¿ç”¨éƒ¨åˆ†babelæ’ä»¶ï¼Œæ¯”å¦‚é¡¹ç›®ä¸­å¯èƒ½æœ‰è‡ªå®šä¹‰çš„astå¤„ç†è„šæœ¬ï¼Œrsbuildä¹Ÿæä¾›äº†æ¥å…¥æ–¹å¼ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { pluginBabel } <span class="hljs-keyword">from</span> <span class="hljs-string">'@rsbuild/plugin-babel'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">plugins</span>: [<span class="hljs-title function_">pluginBabel</span>()],
};
</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥æ’ä»¶å¹¶ä¸æ˜¯å°†swcåˆ‡æ¢ä¸ºbabelï¼Œè€Œæ˜¯åœ¨swcçš„åŸºç¡€ä¸Šé¢å¤–æ‰§è¡Œbabelè½¬ä¹‰ï¼Œå› æ­¤ä¼šå¢åŠ ç¼–è¯‘æ—¶é—´ã€‚</p>
<h3 data-id="heading-3">tsè£…é¥°å™¨</h3>
<p>Rsbuild ä¸ä¼šè¯»å–Â <code>tsconfig.json</code>Â ä¸­çš„Â <code>experimentalDecorators</code>Â é€‰é¡¹ï¼Œè€Œæ˜¯æä¾›äº†Â <a href="https://link.juejin.cn?target=https%3A%2F%2Frsbuild.rs%2Fzh%2Fconfig%2Fsource%2Fdecorators%23decoratorsversion" target="_blank" title="https://rsbuild.rs/zh/config/source/decorators#decoratorsversion" ref="nofollow noopener noreferrer">decorators.version</a>Â é…ç½®é¡¹æ¥æŒ‡å®šè£…é¥°å™¨ç‰ˆæœ¬</p>
<pre><code class="hljs language-css" lang="css">export default {
    source: { 
        decorators: { 
            version: <span class="hljs-string">'legacy'</span>, 
        }, 
    }, 
};
</code></pre>
<p>å¦å¤–swcæ˜ç¡®æ”¯æŒtsçš„decoratorMetadataï¼Œè¿ç§»çš„æ—¶å€™å¯ä»¥ä¸ç”¨æ‹…å¿ƒè£…é¥°å™¨è¢«ç ´åã€‚</p>
<h2 data-id="heading-4">æ ·å¼</h2>
<h3 data-id="heading-5">less/sass</h3>
<p>webpackçš„less-loader,sass-loaderå¯¹åº”@rsbuild/plugin-lesså’Œ@rsbuild/plugin-sass,é…ç½®çš„ä¸åŒç‚¹åœ¨äºwebpacké€šè¿‡module.rules[].teståŒ¹é…,è€Œrsbuildé€šè¿‡æ’ä»¶æœ¬èº«çš„includeå’Œexclude</p>
<h3 data-id="heading-6">css modules</h3>
<p>ä¸ç®¡æ˜¯è§„èŒƒè¿˜æ˜¯å¤šæ•°å®è·µï¼Œé¡¹ç›®ä¸­ä¸€èˆ¬éƒ½ä¼šå¯¹css moduleæ–‡ä»¶åä¸­å¢åŠ moduleæ ‡è®°ï¼Œæ¯”å¦‚*.module.lessã€‚rsbuildä¹Ÿæ˜¯æ ¹æ®è¯¥è§„èŒƒåˆ¤æ–­æ ·å¼æ–‡ä»¶æ˜¯å¦å¯ç”¨css modulesã€‚ä½†webpackæ›´çµæ´»ï¼Œå¯ä»¥ä»»æ„è®¾ç½®è¯¥æ–‡ä»¶æ˜¯å¦å¯ç”¨css modules:</p>
<pre><code class="hljs language-javascript" lang="javascript"> {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.module\.css$/</span>,
        <span class="hljs-attr">use</span>: [
          <span class="hljs-string">'style-loader'</span>, <span class="hljs-comment">// æˆ– mini-css-extract-plugin.loader</span>
          {
            <span class="hljs-attr">loader</span>: <span class="hljs-string">'css-loader'</span>,
            <span class="hljs-attr">options</span>: {
              <span class="hljs-attr">modules</span>: {
                <span class="hljs-attr">mode</span>: <span class="hljs-string">'local'</span>, <span class="hljs-comment">// å±€éƒ¨ä½œç”¨åŸŸï¼ˆé»˜è®¤ï¼‰</span>
                <span class="hljs-attr">localIdentName</span>: <span class="hljs-string">'[name]__[local]--[hash:base64:5]'</span>, <span class="hljs-comment">// ç±»åç”Ÿæˆè§„åˆ™</span>
                <span class="hljs-attr">exportLocalsConvention</span>: <span class="hljs-string">'camelCase'</span>, <span class="hljs-comment">// å¯¼å‡ºé©¼å³°å‘½åï¼ˆå¦‚ .btn-primary â†’ btnPrimaryï¼‰</span>
              },
            },
          },
        ],
      },
</code></pre>
<p>å› æ­¤å¦‚æœè¿ç§»rsbuildï¼Œå»ºè®®å¯¹ä¸ç¬¦åˆcss moduleså‘½åè§„èŒƒçš„æ–‡ä»¶é‡æ–°å‘½åã€‚
å½“ç„¶rsbuildä¹Ÿå¯ä»¥å¯¹ä»»æ„æ–‡ä»¶è®¾ç½®æ˜¯å¦å¯ç”¨css modules
åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰Â <code>*.module.css</code>Â ç»“å°¾çš„æ–‡ä»¶æ‰è¢«è§†ä¸º CSS Modules æ¨¡å—ã€‚</p>
<blockquote>
<p>å¦‚æœä½ æƒ³å°†å…¶ä»– CSS æ–‡ä»¶ä¹Ÿå½“åš CSS Modules æ¨¡å—è¿›è¡Œå¤„ç†ï¼Œå¯ä»¥é€šè¿‡é…ç½®Â <a href="https://link.juejin.cn?target=https%3A%2F%2Frsbuild.rs%2Fzh%2Fconfig%2Foutput%2Fcss-modules%23cssmodulesauto" target="_blank" title="https://rsbuild.rs/zh/config/output/css-modules#cssmodulesauto" ref="nofollow noopener noreferrer">output.cssModules.auto</a>Â æ¥å®ç°ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
</blockquote>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">output</span>: {
    <span class="hljs-attr">cssModules</span>: {
      <span class="hljs-attr">auto</span>: <span class="hljs-function">(<span class="hljs-params">resource</span>) =&gt;</span> {
        <span class="hljs-keyword">return</span> resource.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'.module.'</span>) || resource.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'shared/'</span>);
      },
    },
  },
};
</code></pre>
<p>è®¾ç½®åï¼Œä»¥ä¸‹ä¸¤ä¸ªæ–‡ä»¶éƒ½ä¼šè¢«è§†ä¸º CSS Modulesï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> styles1 <span class="hljs-keyword">from</span> <span class="hljs-string">'./foo.module.css'</span>;
<span class="hljs-keyword">import</span> styles2 <span class="hljs-keyword">from</span> <span class="hljs-string">'./shared/bar.css'</span>;
</code></pre>
<p>ä½†ä¸ªäººå¹¶ä¸æ¨èè¯¥æ–¹å¼ã€‚</p>
<h3 data-id="heading-7">postcsså’Œtailwind</h3>
<p>rsbuildçš„tools.postcsså¯¹æ ‡webpackçš„postcss-loaderï¼Œå¯¹tailwindçš„é…ç½®ä¹Ÿé€šè¿‡postcssã€‚ä¸è¿‡å…¶å†…ç½®çš„Lightning CSSè¦†ç›–äº†postcssä¸€äº›æ’ä»¶ï¼Œæ¯”å¦‚autoprefixerã€‚</p>
<h2 data-id="heading-8">å‹ç¼©</h2>
<h3 data-id="heading-9">SWC vs Terser</h3>
<p>SWCçš„å‹ç¼©é…ç½®å¯¹æ ‡Terserï¼ŒTerseræœ‰çš„SWCå‡ ä¹éƒ½æœ‰ï¼Œå¯ä»¥æ— è„‘åˆ‡æ¢ã€‚</p>
<h3 data-id="heading-10">css-minimizer-webpack-pluginå’ŒLightning CSSçš„å‹ç¼©</h3>
<p>css-minimizer-webpack-pluginå¯ä»¥è®¾ç½®å‹ç¼©å·¥å…·ä¸ºcssnanoï¼ˆé»˜è®¤ï¼‰ã€Lightning CSSã€cssoï¼Œrsbuildä»…æ”¯æŒLightning CSSï¼ˆå½“å‰ä¸»æµï¼‰ã€‚Lightning CSSç›¸å½“äºcssnanoï¼ˆå‹ç¼©ï¼‰+ autoprefixerï¼ˆå‰ç¼€ï¼‰+ postcss-preset-envï¼ˆè¯­æ³•é™çº§ï¼‰</p>
<h2 data-id="heading-11">å…¶ä»–é‡è¦æ’ä»¶</h2>
<h3 data-id="heading-12">svgr</h3>

















<table><thead><tr><th/><th>webpack</th><th>rsbuild</th><th>é‡è¦åŒºåˆ«</th></tr></thead><tbody><tr><td>æ’ä»¶</td><td>@svgr/webpack</td><td>@rsbuild/plugin-svgr</td><td>æ··åˆå¯¼å…¥</td></tr></tbody></table>
<p>webpackæ”¯æŒæ··åˆå¯¼å…¥ï¼Œsvgå¯ä»¥å½“æˆpathæˆ–ä¸€ä¸ªReactç»„ä»¶</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> starUrl, { <span class="hljs-title class_">ReactComponent</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">Star</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./star.svg'</span>


<span class="hljs-keyword">const</span> <span class="hljs-title function_">App</span> = (<span class="hljs-params"/>) =&gt; (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{starUrl}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"star"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Star</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
)
</code></pre>
<p>@rsbuild/plugin-svgrå¼€å¯å…·åå¯¼å…¥åï¼Œéœ€è¦é¢å¤–å¼€å¯æ··åˆå¯¼å…¥ï¼Œå¦åˆ™æ— æ³•å½“æˆpathå¤„ç†ã€‚è™½ç„¶è¯¥æ’ä»¶æ”¯æŒæ··åˆå¯¼å…¥ï¼Œä½†æ¨èçš„å†™æ³•å¦‚ä¸‹</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Logo</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./logo.svg?react'</span>; 
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">App</span> = (<span class="hljs-params"/>) =&gt; <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Logo</span> /&gt;</span></span>;
</code></pre>
<blockquote>
<p>å»ºè®®ä¼˜å…ˆä½¿ç”¨Â <code>?react</code>Â æ¥å°† SVG è½¬æ¢ä¸º React ç»„ä»¶ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ··åˆå¯¼å…¥ã€‚å› ä¸ºæ··åˆå¯¼å…¥æœ‰å¦‚ä¸‹å±€é™æ€§ï¼š</p>
<ol>
<li>åŒ…ä½“ç§¯å¢åŠ ï¼šæ··åˆå¯¼å…¥ä¼šå¯¼è‡´å•ä¸ª SVG æ¨¡å—è¢«ç¼–è¯‘ä¸ºä¸¤ç§ä»£ç ï¼ˆå³ä½¿éƒ¨åˆ†å¯¼å‡ºæ²¡æœ‰è¢«ä½¿ç”¨ï¼‰ï¼Œè¿™ä¼šå¢åŠ äº§ç‰©çš„åŒ…ä½“ç§¯ã€‚</li>
<li>ç¼–è¯‘é€Ÿåº¦ä¸‹é™ï¼šæ··åˆå¯¼å…¥ä¼šäº§ç”Ÿé¢å¤–çš„ç¼–è¯‘å¼€é”€ã€‚å³ä½¿ä»£ç ä¸­æœªä½¿ç”¨åˆ° ReactComponent å¯¼å‡ºï¼ŒSVG æ–‡ä»¶ä»ç„¶ä¼šè¢« SVGR ç¼–è¯‘ã€‚è€Œ SVGR æ˜¯åŸºäº Babel å®ç°çš„ï¼Œæ€§èƒ½å¼€é”€è¾ƒå¤§ã€‚</li>
</ol>
</blockquote>
<h3 data-id="heading-13">code-inspector-plugin</h3>

















<table><thead><tr><th/><th>webpack</th><th>rsbuild</th><th>é‡è¦åŒºåˆ«</th></tr></thead><tbody><tr><td>æ’ä»¶</td><td>code-inspector-plugin</td><td>code-inspector-plugin</td><td>é…ç½®æ–¹å¼</td></tr></tbody></table>
<p>webpackå’Œrspackçš„é…ç½®æ–¹å¼ç±»ä¼¼</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// webpack.config.js</span>
<span class="hljs-keyword">const</span> { codeInspectorPlugin } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'code-inspector-plugin'</span>);

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function">() =&gt;</span> ({
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-title function_">codeInspectorPlugin</span>({
      <span class="hljs-attr">bundler</span>: <span class="hljs-string">'webpack'</span>,
    }),
  ],
});
<span class="hljs-comment">// rspack.config.js</span>
<span class="hljs-keyword">const</span> { codeInspectorPlugin } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'code-inspector-plugin'</span>);

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-comment">// other config...</span>
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-title function_">codeInspectorPlugin</span>({
      <span class="hljs-attr">bundler</span>: <span class="hljs-string">'rspack'</span>,
    }),
    <span class="hljs-comment">// other plugins...</span>
  ],
};
</code></pre>
<p>ä½†rsbuildçš„é…ç½®ç•¥æœ‰ä¸åŒâ€”â€”rsbuildçš„pluginå¹¶ä¸æ˜¯rspackçš„plugin</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// rsbuild.config.js</span>
<span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'@rsbuild/core'</span>;
<span class="hljs-keyword">import</span> { codeInspectorPlugin } <span class="hljs-keyword">from</span> <span class="hljs-string">'code-inspector-plugin'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-comment">// ...other config</span>
  <span class="hljs-attr">tools</span>: {
    <span class="hljs-attr">rspack</span>: {
      <span class="hljs-attr">plugins</span>: [
        <span class="hljs-title function_">codeInspectorPlugin</span>({
          <span class="hljs-attr">bundler</span>: <span class="hljs-string">'rspack'</span>,
        }),
      ],
    },
  },
});
</code></pre>
<h2 data-id="heading-14">rsbuild vs vite é‡è¦ç‰¹æ€§æ¨ªå‘å¯¹æ¯”</h2>
<h3 data-id="heading-15">æŒ‰éœ€ç¼–è¯‘</h3>
<p>viteçš„æŒ‰éœ€ç¼–è¯‘ä¾èµ–æµè§ˆå™¨çš„esmåŠ è½½æœºåˆ¶ï¼Œè€Œrsbuildçš„æŒ‰éœ€ç¼–è¯‘ï¼ˆLazy compilationï¼‰ï¼Œä¾èµ–äºæ‹†åŒ…ï¼Œå³åªç¼–è¯‘å…¥å£ï¼ŒåŠ¨æ€importå¼•å…¥æ–‡ä»¶æŒ‰éœ€ç¼–è¯‘ã€‚å¦‚æœé—®å¼€å‘æœåŠ¡å™¨å¯åŠ¨æ—¶é—´ï¼Œé‚£è‚¯å®šæ˜¯viteæ›´å¿«ï¼Œä½†è¦é—®å¼€å‘ç¯å¢ƒé¡µé¢åŠ è½½æ—¶é—´ï¼Œå¤§å‹é¡¹ç›®å¯èƒ½rsbuildæ›´å¿«ã€‚</p>
<h3 data-id="heading-16">çƒ­æ›´æ–°</h3>
<p>rsbuildçš„çƒ­æ›´æ–°è¿˜æ˜¯chunkç²’åº¦ï¼Œè€Œviteæ˜¯æ–‡ä»¶ç²’åº¦ï¼Œé€Ÿåº¦ä¸Šæ¥è¯´viteæ›´å¿«ï¼Œä½†å®é™…ä½“éªŒå·®è·ä¸å¤§ã€‚</p>
<h3 data-id="heading-17">å…¼å®¹æ€§</h3>
<p>å¦‚æœéƒ½æ˜¯ä»webpackå‡çº§ï¼Œç›¸æ¯”viteï¼Œæ˜¾ç„¶rsbuildæ›´å®‰å…¨ï¼Œé™¤äº†æ’ä»¶çš„å…¼å®¹ï¼Œæ›´å…³é”®çš„æ˜¯ç¼–è¯‘å…¼å®¹ã€‚</p>
<p>swcçš„è¯­æ³•é™çº§ï¼Œå¯¹æ ‡babelçš„@babel/preset-envï¼Œæ”¯æŒæŒ‰éœ€å¼•å…¥polyfill(ç±»ä¼¼useBuiltIns: 'usage')ï¼›åŒæ—¶swcä¹Ÿå¯ä»¥å®‰å…¨åœ°ç¼–è¯‘tsçš„å…ƒæ•°æ®å’Œè£…é¥°å™¨ï¼›å‹ç¼©ä¸Šå¯¹æ ‡Terserï¼Œå‡ ä¹å¯ä»¥æ— ç¼è¿ç§»ç›¸å…³é…ç½®ã€‚è¿™ä¸‰ç‚¹è¶…è¶Šäº†esbuildã€‚</p>
<h3 data-id="heading-18">webpackç‰¹æ€§ä¸¢å¤±é—®é¢˜</h3>
<p>rsbuildå‡ ä¹æ²¡æœ‰ç‰¹æ€§ä¸¢å¤±çš„é—®é¢˜ï¼Œæ¯”å¦‚æ¨¡å—è”é‚¦ï¼ŒsplitChukså‡èƒ½ä¸webpackä¿æŒä¸€è‡´ï¼Œè€Œviteç”±äºå†…ç½®æ‰“åŒ…æ˜¯rollupï¼Œè¿™ä¸¤ä¸ªç‰¹æ€§æ”¯æŒå¹¶ä¸å¥½ã€‚</p>
<h2 data-id="heading-19">ç»“è®º</h2>
<p>çº¯ä¸ªäººæ„è§ï¼Œå……æ»¡ä¸»è§‚åˆ¤æ–­ï¼šrsbuildç›¸æ¯”webpackå…¨é¢è¶…è¶Šï¼Œç›¸æ¯”viteï¼Œæ— è®ºæ˜¯å…¼å®¹æ€§è¿˜æ˜¯å¼€å‘/é…ç½®ä½“éªŒéƒ½æ›´å¥½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±åº¦é©±åŠ¨ï¼šReact Hooks æ ¸å¿ƒä¹‹ `useState` ä¸ `useEffect` å®æˆ˜è¯¦è§£]]></title>    <link>https://juejin.cn/post/7585206549305507903</link>    <guid>https://juejin.cn/post/7585206549305507903</guid>    <pubDate>2025-12-19T07:51:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585206549305507903" data-draft-id="7585091990347661348" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±åº¦é©±åŠ¨ï¼šReact Hooks æ ¸å¿ƒä¹‹ `useState` ä¸ `useEffect` å®æˆ˜è¯¦è§£"/> <meta itemprop="keywords" content="React.js,å“åº”å¼ç¼–ç¨‹,JavaScript"/> <meta itemprop="datePublished" content="2025-12-19T07:51:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="San30"/> <meta itemprop="url" content="https://juejin.cn/user/1766294768060816"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±åº¦é©±åŠ¨ï¼šReact Hooks æ ¸å¿ƒä¹‹ `useState` ä¸ `useEffect` å®æˆ˜è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1766294768060816/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    San30
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T07:51:01.000Z" title="Fri Dec 19 2025 07:51:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p>åœ¨ React çš„å‡½æ•°ç»„ä»¶ä¸–ç•Œé‡Œï¼ŒHooks æ˜¯çµé­‚æ‰€åœ¨ã€‚æ­£å¦‚ä½ çš„ <code>readme.md</code> ä¸­æ‰€è¨€ï¼Œâ€œä»¥ <code>use</code> å¼€å¤´çš„å‡½æ•°ï¼Œéƒ½æ˜¯ React æä¾›çš„ Hooksï¼Œç”¨äºåœ¨å‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨çŠ¶æ€å’Œå…¶ä»– React åŠŸèƒ½ã€‚â€å…¶ä¸­ï¼Œ<code>useState</code> è§£å†³äº†â€œæ•°æ®å¦‚ä½•é©±åŠ¨è§†å›¾â€çš„é—®é¢˜ï¼Œè€Œ <code>useEffect</code> åˆ™è§£å†³äº†â€œå¦‚ä½•å¤„ç†çº¯å‡½æ•°ä¹‹å¤–çš„å‰¯ä½œç”¨â€çš„é—®é¢˜ã€‚</p>
<h2 data-id="heading-0">ç¬¬ä¸€éƒ¨åˆ†ï¼šuseStateâ€”â€”èµ‹äºˆç»„ä»¶â€œè®°å¿†â€çš„èƒ½åŠ›</h2>
<h3 data-id="heading-1">1. å“åº”å¼çŠ¶æ€çš„æœ¬è´¨</h3>
<p>åœ¨ React ä¹‹å‰ï¼Œæ™®é€šå˜é‡ï¼ˆå¦‚ <code>let count = 0</code>ï¼‰çš„å˜åŒ–æ— æ³•è§¦å‘ UI çš„é‡æ–°æ¸²æŸ“ã€‚<code>useState</code> çš„å‡ºç°ï¼Œä¸ºç¨‹åºå‘˜å¸¦æ¥äº†<strong>å…³é”®çš„å“åº”å¼çŠ¶æ€</strong>ï¼Œ<strong>çŠ¶æ€å°±æ˜¯å˜åŒ–çš„æ•°æ®ï¼Œç»„ä»¶çš„æ ¸å¿ƒæ˜¯çŠ¶æ€ã€‚</strong></p>
<p>æœ€å…¸å‹çš„å®šä¹‰æ–¹å¼ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">1</span>);
</code></pre>
<ul>
<li><strong>æ•°ç»„è§£æ„</strong>ï¼š<code>useState</code> è¿”å›ä¸€ä¸ªé•¿åº¦ä¸º 2 çš„æ•°ç»„ã€‚ç¬¬ä¸€é¡¹æ˜¯å½“å‰çŠ¶æ€çš„å€¼ï¼Œç¬¬äºŒé¡¹æ˜¯æ›´æ–°è¯¥çŠ¶æ€çš„å‡½æ•°ã€‚</li>
<li><strong>ç¡®å®šæ€§</strong>ï¼šåˆå§‹åŒ–æ—¶ï¼ŒçŠ¶æ€å¿…é¡»æ˜¯ç¡®å®šçš„ï¼Œè‚¯å®šçš„ã€‚</li>
</ul>
<h3 data-id="heading-2">2. æƒ°æ€§åˆå§‹åŒ–ï¼ˆLazy Initializationï¼‰</h3>
<p>å½“ä½ éœ€è¦é€šè¿‡å¤æ‚è®¡ç®—æ¥ç¡®å®šåˆå§‹å€¼æ—¶ï¼Œå¯ä»¥å‘ <code>useState</code> ä¼ å…¥ä¸€ä¸ª<strong>çº¯å‡½æ•°</strong>ï¼š</p>
<p>ä»€ä¹ˆæ˜¯çº¯å‡½æ•°ï¼Ÿ</p>
<p>çº¯å‡½æ•°æ˜¯æŒ‡å¯¹äºç›¸åŒçš„è¾“å…¥å§‹ç»ˆè¿”å›ç›¸åŒè¾“å‡ºï¼Œä¸”æ²¡æœ‰å‰¯ä½œç”¨ï¼ˆå¦‚ä¿®æ”¹å¤–éƒ¨çŠ¶æ€æˆ–ä¾èµ–å¤–éƒ¨å¯å˜æ•°æ®ï¼‰çš„å‡½æ•°ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> num1 = <span class="hljs-number">1</span> + <span class="hljs-number">2</span>;
  <span class="hljs-keyword">const</span> num2 = <span class="hljs-number">2</span> + <span class="hljs-number">3</span>;
  <span class="hljs-keyword">return</span> num1 + num2;
});
</code></pre>
<p>ä¸ºä»€ä¹ˆè¦ç”¨å‡½æ•°ï¼Ÿ</p>
<p>å¦‚æœåˆå§‹å€¼è®¡ç®—å¼€é”€å¾ˆå¤§ï¼ˆæ¯”å¦‚è¯»å–æœ¬åœ°ç¼“å­˜ã€å¾ªç¯è®¡ç®—ï¼‰ï¼Œç›´æ¥å†™åœ¨ useState(expensive()) ä¸­ä¼šå¯¼è‡´æ¯æ¬¡ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶éƒ½æ‰§è¡Œè¯¥è®¡ç®—ã€‚è€Œä¼ å…¥å‡½æ•°ï¼ŒReact åªä¼šåœ¨ç»„ä»¶åˆæ¬¡æŒ‚è½½æ—¶æ‰§è¡Œå®ƒä¸€æ¬¡ã€‚</p>
<p>æ³¨æ„ï¼Œè¿™ä¸ªå‡½æ•°å¿…é¡»æ˜¯åŒæ­¥çš„ï¼Œä¸æ”¯æŒå¼‚æ­¥çš„ï¼Œå¼‚æ­¥çš„åˆå§‹ä¼šå¸¦æ¥ä¸ç¡®å®šæ€§ï¼Œè€ŒçŠ¶æ€å¿…é¡»æ˜¯å¯é¢„æµ‹ä¸”ç¡®å®šçš„ã€‚</p>
<h3 data-id="heading-3">3. æ›´æ–°å‡½æ•°çš„ä¸¤ç§å§¿åŠ¿</h3>
<p>æ›´æ–°çŠ¶æ€çš„ä¸¤ç§é€»è¾‘ï¼š</p>
<ol>
<li><strong>ç›´æ¥ä¼ é€’æ–°å€¼</strong>ï¼š<code>setCount(count + 1)</code>ã€‚</li>
<li><strong>ä¼ é€’æ›´æ–°å‡½æ•°</strong>ï¼š<code>setNum(prevNum =&gt; prevNum + 1)</code>ã€‚</li>
</ol>
<p>æ ¸å¿ƒåŒºåˆ«ï¼š</p>
<p>ä½¿ç”¨ <code>prevNum =&gt; prevNum + 1</code> æ˜¯ä¸ºäº†å®‰å…¨åœ°åŸºäºä¸Šä¸€æ¬¡çš„å€¼æ›´æ–°ã€‚ç”±äº React çš„çŠ¶æ€æ›´æ–°å¯èƒ½æ˜¯å¼‚æ­¥çš„ï¼Œæˆ–è€…åœ¨é—­åŒ…ç¯å¢ƒä¸­ï¼Œç›´æ¥å¼•ç”¨ count å¯èƒ½ä¼šæ‹¿åˆ°æ—§å€¼ã€‚ä½¿ç”¨å›è°ƒå‡½æ•°å½¢å¼å¯ä»¥ç¡®ä¿ä½ æ‹¿åˆ°çš„ prevNum æ°¸è¿œæ˜¯å†…å­˜ä¸­æœ€æ–°çš„çŠ¶æ€ã€‚</p>
<h2 data-id="heading-4">ç¬¬äºŒéƒ¨åˆ†ï¼šuseEffectâ€”â€”æŒæ§å‰¯ä½œç”¨çš„è‰ºæœ¯</h2>
<h3 data-id="heading-5">1. ä»€ä¹ˆæ˜¯å‰¯ä½œç”¨ï¼ˆSide Effectï¼‰ï¼Ÿ</h3>
<p>å‰¯ä½œç”¨çš„å¯¹ç«‹é¢å°±æ˜¯çº¯å‡½æ•°ã€‚</p>
<ul>
<li><strong>çº¯å‡½æ•°</strong>ï¼šç›¸åŒè¾“å…¥æ°¸è¿œå¾—åˆ°ç›¸åŒè¾“å‡ºï¼Œæ— å‰¯ä½œç”¨ã€‚</li>
<li><strong>å‰¯ä½œç”¨</strong>ï¼šæŒ‡é‚£äº›ä¸ç›´æ¥å‚ä¸ UI è®¡ç®—çš„æ“ä½œï¼Œå¦‚ç½‘ç»œè¯·æ±‚ã€æ‰‹åŠ¨ä¿®æ”¹ DOMã€è®¾ç½®å®šæ—¶å™¨ã€è®°å½•æ—¥å¿—ç­‰ã€‚</li>
</ul>
<p><code>useEffect</code> çš„è®¾è®¡åˆè¡·ï¼Œå°±æ˜¯ä¸ºè¿™äº›â€œä¸çº¯â€çš„æ“ä½œæä¾›ä¸€ä¸ªå®‰å…¨çš„é¿é£æ¸¯ã€‚</p>
<h3 data-id="heading-6">2. ä¾èµ–é¡¹æ•°ç»„ï¼ˆDependency Arrayï¼‰çš„å¥¥ç§˜</h3>
<p><code>useEffect</code> çš„ç¬¬äºŒä¸ªå‚æ•°å†³å®šäº†å‰¯ä½œç”¨ä½•æ—¶è¿è¡Œï¼Œè¿™æ˜¯åˆå­¦è€…æœ€å®¹æ˜“å›°æƒ‘çš„åœ°æ–¹ï¼š</p>

























<table><thead><tr><th><strong>ä¾èµ–å‚æ•°</strong></th><th><strong>æ‰§è¡Œæ—¶æœº</strong></th><th><strong>å¯¹åº”ç”Ÿå‘½å‘¨æœŸ</strong></th></tr></thead><tbody><tr><td><strong>ä¸ä¼ </strong></td><td>æ¯æ¬¡ç»„ä»¶æ¸²æŸ“ï¼ˆrenderï¼‰åéƒ½æ‰§è¡Œ</td><td>æŒç»­æ›´æ–°</td></tr><tr><td><strong>ç©ºæ•°ç»„ <code>[]</code></strong></td><td>ä»…åœ¨ç»„ä»¶æŒ‚è½½ï¼ˆMountï¼‰åæ‰§è¡Œä¸€æ¬¡</td><td><code>onMounted</code></td></tr><tr><td><strong>æœ‰å€¼ <code>[num]</code></strong></td><td>æŒ‚è½½åæ‰§è¡Œï¼Œä¸”å½“ <code>num</code> å˜åŒ–æ—¶é‡æ–°æ‰§è¡Œ</td><td><code>onUpdated</code></td></tr></tbody></table>
<h3 data-id="heading-7">3. æ¸…ç†å‡½æ•°ï¼ˆCleanupï¼‰ï¼šé˜²æ­¢å†…å­˜æ³„æ¼</h3>
<p>è¿™æ˜¯ <code>App.jsx</code> å’Œ <code>Demo.jsx</code> ä¸­æœ€ç²¾å½©çš„éƒ¨åˆ†ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num); }, <span class="hljs-number">1000</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-built_in">clearInterval</span>(timer); <span class="hljs-comment">// æ¸…ç†å‡½æ•°</span>
    }
}, [num]);
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¦ Cleanupï¼Ÿ</strong></p>
<ol>
<li><strong>é‡å¤åˆ›å»ºé—®é¢˜</strong>ï¼šå¦‚æœä¸æ¸…é™¤ï¼Œæ¯æ¬¡ <code>num</code> å˜åŒ–éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„å®šæ—¶å™¨ï¼Œæ—§çš„å®šæ—¶å™¨ä¾ç„¶åœ¨åå°è¿è¡Œã€‚</li>
<li><strong>å†…å­˜æ³„æ¼</strong>ï¼šåœ¨ <code>Demo.jsx</code> ä¸­ï¼Œå¦‚æœç»„ä»¶å¸è½½äº†ï¼ˆ<code>num</code> å˜æˆå¥‡æ•°ï¼‰ï¼Œä½†å®šæ—¶å™¨æ²¡å…³ï¼Œå®ƒä¼šå°è¯•æ“ä½œå·²ç»ä¸å­˜åœ¨çš„é€»è¾‘ï¼Œå¯¼è‡´æ€§èƒ½ä¸‹é™ç”šè‡³å´©æºƒã€‚</li>
</ol>
<p><strong>æ‰§è¡Œæ—¶æœº</strong>ï¼š</p>
<ol>
<li>
<p>æ¸…ç†å‡½æ•°ä¼šåœ¨<strong>ä¸‹ä¸€æ¬¡å‰¯ä½œç”¨æ‰§è¡Œå‰</strong>è¢«è°ƒç”¨ï¼Œå¦‚<code>App.jsx</code>ä¸­åŠ çš„<code>[num]</code>ä¾èµ–ï¼Œåœ¨<code>num</code>å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå‰¯ä½œç”¨é‡æ–°æ‰§è¡Œã€‚</p>
</li>
<li>
<p>æ¸…ç†å‡½æ•°ä¼šåœ¨<strong>ç»„ä»¶å¸è½½å‰</strong>è¢«è°ƒç”¨ï¼Œå¦‚<code>Demo.jsx</code>ä¸­çš„<code>[]</code>ä¾èµ–ï¼Œå‰¯ä½œç”¨ä»…åœ¨ç»„ä»¶æŒ‚è½½åæ‰§è¡Œä¸€æ¬¡ï¼Œä½†åœ¨<code>num</code>ä¸ºå¥‡æ•°æ—¶ï¼Œ<code>Demo</code>å­ç»„ä»¶ä¼šå¸è½½ã€‚</p>
</li>
</ol>
<h2 data-id="heading-8">ç¬¬ä¸‰éƒ¨åˆ†ï¼šå®æˆ˜ä»£ç æ·±åº¦å‰–æ</h2>
<h3 data-id="heading-9">æ¡ˆä¾‹ 1ï¼šApp.jsx ä¸­çš„åŠ¨æ€ç›‘å¬</h3>
<p>åœ¨ <code>App.jsx</code> ä¸­ï¼Œ<code>useEffect</code> ç›‘å¬äº† <code>[num]</code>ã€‚å½“ç”¨æˆ·ç‚¹å‡» <code>div</code> ä½¿ <code>num</code> å¢åŠ æ—¶ï¼š</p>
<ol>
<li>
<p>React å‘ç° <code>num</code> å˜äº†ã€‚</p>
</li>
<li>
<p>React å…ˆè°ƒç”¨ä¸Šä¸€æ¬¡ Effect è¿”å›çš„ <code>remove</code> æ¸…ç†å‡½æ•°ï¼Œæ‰§è¡Œ <code>clearInterval</code>ã€‚</p>
</li>
<li>
<p>React æ‰§è¡Œæ–°çš„ Effectï¼Œå¼€å¯ä¸€ä¸ªæ–°çš„å®šæ—¶å™¨ï¼Œæ‰“å°æœ€æ–°çš„ numã€‚</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ åœ¨æ§åˆ¶å°èƒ½çœ‹åˆ°â€œå®æ—¶æ›´æ–°â€çš„æ•°å­—ï¼Œä¸”ä¸ä¼šå †ç§¯å¤šä¸ªå®šæ—¶å™¨ã€‚</p>
</li>
</ol>
<h3 data-id="heading-10">æ¡ˆä¾‹ 2ï¼šDemo.jsx çš„æŒ‚è½½ä¸å¸è½½</h3>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'123123'</span>); <span class="hljs-comment">// ä»…åœ¨ Demo å‡ºç°æ—¶æ‰“å°ä¸€æ¬¡</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'remove'</span>); } <span class="hljs-comment">// ä»…åœ¨ Demo æ¶ˆå¤±æ—¶æ‰§è¡Œ</span>
}, []);
</code></pre>
<p>åœ¨ä¸»ç»„ä»¶ä¸­ï¼š<code>{num % 2 === 0 &amp;&amp; &lt;Demo /&gt;}</code>ã€‚</p>
<ul>
<li>å½“ <code>num</code> ä» 0 å˜ 1 æ—¶ï¼Œæ¡ä»¶ä¸ºå‡ï¼Œ<code>Demo</code> ç»„ä»¶è¢«é”€æ¯ã€‚</li>
<li>æ­¤æ—¶ React è‡ªåŠ¨è§¦å‘ <code>Demo</code> å†…éƒ¨ <code>useEffect</code> çš„ <code>return</code> å‡½æ•°ã€‚</li>
<li><strong>ç»“è®º</strong>ï¼šè¿™å®Œç¾æ¨¡æ‹Ÿäº† Vue ä¸­çš„ <code>onMounted</code> å’Œ <code>onUnmounted</code>ã€‚</li>
</ul>
<h2 data-id="heading-11">ç¬¬å››éƒ¨åˆ†ï¼šHooks çš„ä½¿ç”¨å‡†åˆ™</h2>
<p>ä¸ºäº†ç¡®ä¿è¿™äº›é’©å­æ­£å¸¸å·¥ä½œï¼Œå¿…é¡»éµå®ˆ React çš„ä¸¤æ¡é‡‘ç§‘ç‰å¾‹ï¼š</p>
<ol>
<li><strong>åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨ Hooks</strong>ï¼šä¸è¦åœ¨å¾ªç¯ã€æ¡ä»¶åˆ¤æ–­æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hookã€‚è¿™ä¿è¯äº†æ¯æ¬¡æ¸²æŸ“æ—¶ Hook çš„è°ƒç”¨é¡ºåºä¸€è‡´ï¼ŒReact æ‰èƒ½æ­£ç¡®å…³è”çŠ¶æ€ã€‚</li>
<li><strong>åªåœ¨ React å‡½æ•°ä¸­è°ƒç”¨ Hooks</strong>ï¼šä¸è¦åœ¨æ™®é€šçš„ JS å‡½æ•°ä¸­è°ƒç”¨ï¼Œé™¤éæ˜¯ä½ è‡ªå®šä¹‰çš„ Hookï¼ˆä»¥ <code>use</code> å¼€å¤´ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-12">ç¬¬äº”éƒ¨åˆ†ï¼šæ€»ç»“ä¸æ„Ÿæ‚Ÿ</h2>
<p><code>useState</code> å’Œ <code>useEffect</code> çš„ç»„åˆï¼Œä½“ç°äº† React <strong>å£°æ˜å¼ç¼–ç¨‹</strong>çš„æ€æƒ³ï¼š</p>
<ul>
<li>ä½ åªéœ€è¦å£°æ˜ï¼š <strong>â€œå½“æ•°æ®æ˜¯è¿™æ ·æ—¶ï¼Œç•Œé¢åº”è¯¥é•¿è¿™æ ·â€</strong> ï¼ˆ<code>useState</code>ï¼‰ã€‚</li>
<li>ä½ åªéœ€è¦å£°æ˜ï¼š <strong>â€œå½“æ•°æ®å˜åŒ–æ—¶ï¼Œæˆ‘éœ€è¦åŒæ­¥åšè¿™äº›é¢å¤–çš„äº‹â€</strong> ï¼ˆ<code>useEffect</code>ï¼‰ã€‚</li>
</ul>
<p>é€šè¿‡æä¾›æ¸…ç†æœºåˆ¶ï¼ŒReact å¼ºè¿«å¼€å‘è€…æ€è€ƒèµ„æºçš„ç”Ÿå‘½å‘¨æœŸï¼Œä»è€Œç¼–å†™å‡ºæ›´å¥å£®ã€æ— æ³„æ¼çš„å‰ç«¯åº”ç”¨ã€‚</p>
<h2 data-id="heading-13">ç¬¬å…­éƒ¨åˆ†ï¼šApp.jsxå’ŒDemo.jsxæºç </h2>
<p><strong>è¿™ä¸ª App.jsx + Demo.jsx åº”ç”¨ä¸»è¦åšäº†ä¸¤ä»¶äº‹ï¼š</strong></p>
<ol>
<li>ç‚¹å‡»ä¸€ä¸ªæ•°å­—ï¼Œè®©å®ƒåŠ  1ã€‚</li>
<li>å½“æ•°å­—æ˜¯å¶æ•°æ—¶ï¼Œæ˜¾ç¤ºä¸€ä¸ªå«  çš„ç»„ä»¶ï¼›å¥‡æ•°æ—¶éšè—å®ƒã€‚</li>
<li>åŒæ—¶ï¼Œç”¨å®šæ—¶å™¨æ¯éš” 1 ç§’æ‰“å°å½“å‰æ•°å­—ï¼Œå¹¶ç¡®ä¿ä¸ä¼šé€ æˆå†…å­˜æ³„æ¼ï¼ˆæ¯”å¦‚æ—§çš„å®šæ—¶å™¨æ²¡å…³æ‰ï¼‰ã€‚</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// App.jsx</span>
<span class="hljs-keyword">import</span> { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Demo</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/Demo.jsx'</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">queryData</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-title function_">resolve</span>(<span class="hljs-number">666</span>);
        }, <span class="hljs-number">2000</span>)
    });
    <span class="hljs-keyword">return</span> data;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> [num, setNum] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num);
        }, <span class="hljs-number">1000</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'remove'</span>);
            <span class="hljs-built_in">clearInterval</span>(timer);
        }
    }, [num])
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setNum(prevNum =&gt; prevNum + 1)}&gt;{num}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            {num % 2 === 0 &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">Demo</span> /&gt;</span>}
        <span class="hljs-tag">&lt;/&gt;</span></span>
    )
}
</code></pre>
<h3 data-id="heading-14"><strong>ä¸»ç»„ä»¶ App</strong></h3>
<p>æ¯å½“<code>num</code>å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¿™ä¸ª<code> useEffect</code> ä¼šå…ˆæ¸…ç†ä¸Šä¸€æ¬¡çš„å‰¯ä½œç”¨ï¼ˆé€šè¿‡<code>return</code>å‡½æ•°ï¼‰ï¼Œå†æ‰§è¡Œæ–°çš„å‰¯ä½œç”¨ã€‚</p>
<p>å®ƒå¯åŠ¨äº†ä¸€ä¸ªæ¯ç§’æ‰“å°å½“å‰ num çš„å®šæ—¶å™¨ã€‚</p>
<p>è¿”å›çš„å‡½æ•°ï¼ˆreturn () =&gt; {...}ï¼‰å°±æ˜¯æ¸…ç†å‡½æ•°ï¼Œä¼šåœ¨ä¸‹ä¸€æ¬¡ useEffect æ‰§è¡Œå‰ï¼Œæˆ–è€…ç»„ä»¶å¸è½½æ—¶è‡ªåŠ¨è°ƒç”¨ã€‚</p>
<p>ä¸ºä»€ä¹ˆéœ€è¦æ¸…ç†ï¼Ÿ</p>
<p>å¦‚æœä¸æ¸…ç†ï¼Œæ¯æ¬¡ num å˜åŒ–éƒ½ä¼šæ–°å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼Œä½†æ—§çš„è¿˜åœ¨è·‘ï¼
æ¯”å¦‚ï¼šnum=0 æ—¶å¼€äº†ä¸€ä¸ªå®šæ—¶å™¨ï¼Œnum=1 æ—¶åˆå¼€ä¸€ä¸ªâ€¦â€¦æœ€åå¯èƒ½æœ‰ 10 ä¸ªå®šæ—¶å™¨åŒæ—¶æ‰“å°ï¼Œé€ æˆå†…å­˜æ³„æ¼æˆ–é€»è¾‘æ··ä¹±ã€‚</p>
<p>æ‰€ä»¥ï¼šåªè¦ç”¨äº† setIntervalã€setTimeoutã€ç›‘å¬äº‹ä»¶ç­‰ï¼Œå‡ ä¹éƒ½è¦å†™æ¸…ç†å‡½æ•°ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> {useEffect, useState} <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Demo</span>(<span class="hljs-params"/>) {
    <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'timer'</span>);
        }, <span class="hljs-number">1000</span>)
        <span class="hljs-comment">// å½“ num æ˜¯å¶æ•°æ—¶ï¼Œå­ç»„ä»¶è¿˜åœ¨é¡µé¢ä¸Šï¼Œæ²¡æœ‰å¸è½½ React ä¸ä¼šæ‰§è¡Œreturnæ¸…ç†å‡½æ•°</span>
        <span class="hljs-comment">// è€Œå½“ num å˜ä¸ºå¥‡æ•°æ—¶ï¼Œ&lt;Demo /&gt; è¢«ç§»é™¤ â†’ React è‡ªåŠ¨è°ƒç”¨ return () =&gt; {...} â†’ æ¸…ç†å®šæ—¶å™¨ã€‚</span>
        <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> { 
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'remove'</span>);
            <span class="hljs-built_in">clearInterval</span>(timer);
        }
    }, [])
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            å¶æ•°Demo
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<h3 data-id="heading-15"><strong>å­ç»„ä»¶ Demo</strong></h3>
<p>useEffect(..., [])ï¼šåªåœ¨ç»„ä»¶ç¬¬ä¸€æ¬¡æŒ‚è½½æ—¶æ‰§è¡Œä¸€æ¬¡ï¼ˆç±»ä¼¼ Vue çš„ onMountedï¼‰ã€‚</p>
<p>å½“ num å˜æˆå¥‡æ•°æ—¶ï¼Œ è¢«ç§»é™¤ â†’ React è‡ªåŠ¨è°ƒç”¨ return () =&gt; {...} â†’ æ¸…ç†å®šæ—¶å™¨ã€‚</p>
<p>è¿™æ ·å°±é¿å…äº†ï¼šç»„ä»¶éƒ½æ¶ˆå¤±äº†ï¼Œå®šæ—¶å™¨è¿˜åœ¨åå°è·‘ï¼</p>
<p>è¿™å°±æ˜¯ React çš„â€œç”Ÿå‘½å‘¨æœŸâ€æ€æƒ³ï¼šæŒ‚è½½ onMounted â†’ æ›´æ–° onUpdatedâ†’ å¸è½½ onUnmountedï¼Œè€Œ useEffect + æ¸…ç†å‡½æ•° èƒ½è¦†ç›–å…¨éƒ¨é˜¶æ®µã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäºvue3 å°è£…çš„antdv/element-Plus å¿«é€Ÿç”Ÿæˆå¢åˆ æ”¹æŸ¥é¡µé¢]]></title>    <link>https://juejin.cn/post/7585206349748650036</link>    <guid>https://juejin.cn/post/7585206349748650036</guid>    <pubDate>2025-12-19T08:08:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585206349748650036" data-draft-id="7585222924565889064" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäºvue3 å°è£…çš„antdv/element-Plus å¿«é€Ÿç”Ÿæˆå¢åˆ æ”¹æŸ¥é¡µé¢"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-19T08:08:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸çŸ¥åç”¨æˆ·æ¥äº†"/> <meta itemprop="url" content="https://juejin.cn/user/3579665589475639"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäºvue3 å°è£…çš„antdv/element-Plus å¿«é€Ÿç”Ÿæˆå¢åˆ æ”¹æŸ¥é¡µé¢
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3579665589475639/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸çŸ¥åç”¨æˆ·æ¥äº†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T08:08:28.000Z" title="Fri Dec 19 2025 08:08:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™æ˜¯ä¸€ä¸ªåŸºäºpnpmå·¥ä½œç©ºé—´çš„Vue 3ç»„ä»¶åº“ï¼ŒåŒ…å«ä¸‰ä¸ªä¸»è¦çš„å­åŒ…ï¼š</p>
<ul>
<li><code>@mengtr/vue3-antdv</code>ï¼šåŸºäºAnt Design Vueçš„ç»„ä»¶åº“</li>
<li><code>@mengtr/vue3-element</code>ï¼šåŸºäºElement Plusçš„ç»„ä»¶åº“</li>
<li><code>@mengtr/vue3-common</code>ï¼šå…¬å…±çš„å·¥å…·åº“å’Œç±»å‹å®šä¹‰</li>
</ul>
<p><strong>npmåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fsearch%3Fq%3D%2540mengtr" target="_blank" title="https://www.npmjs.com/search?q=%40mengtr" ref="nofollow noopener noreferrer">www.npmjs.com/search?q=%4â€¦</a></strong></p>
<p><strong>githubåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmengtianren%2Fmengtr" target="_blank" title="https://github.com/mengtianren/mengtr" ref="nofollow noopener noreferrer">github.com/mengtianrenâ€¦</a></strong></p>
<h2 data-id="heading-0">ant-design-vue è¡¨ç°</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7508bd75808403aa88ce9ea2d59a0df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN55-l5ZCN55So5oi35p2l5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766736891&amp;x-signature=cChP4A16cD9GYt9xp3Qe78BHrNc%3D" alt="antdv.png" loading="lazy"/></p>
<h2 data-id="heading-1">element-plus è¡¨ç°</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/872a2e07e56645fc8f9d0671eb52e8df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN55-l5ZCN55So5oi35p2l5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766736891&amp;x-signature=hL%2BxG%2FsStuDtnnr%2FeuV1F0uY8js%3D" alt="element.png" loading="lazy"/></p>
<h2 data-id="heading-2">é¡¹ç›®ç»“æ„</h2>
<pre><code class="hljs language-bash" lang="bash">mengtr/
â”œâ”€â”€ vue3-antdv/           <span class="hljs-comment"># åŸºäºAnt Design Vueçš„ç»„ä»¶åº“</span>
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/   <span class="hljs-comment"># ç»„ä»¶ç›®å½•</span>
â”‚   â”‚   â”œâ”€â”€ types/        <span class="hljs-comment"># ç±»å‹å®šä¹‰</span>
â”‚   â”‚   â””â”€â”€ index.ts      <span class="hljs-comment"># å…¥å£æ–‡ä»¶</span>
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.ts
â”œâ”€â”€ vue3-element/         <span class="hljs-comment"># åŸºäºElement Plusçš„ç»„ä»¶åº“</span>
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/   <span class="hljs-comment"># ç»„ä»¶ç›®å½•</span>
â”‚   â”‚   â”œâ”€â”€ types/        <span class="hljs-comment"># ç±»å‹å®šä¹‰</span>
â”‚   â”‚   â””â”€â”€ index.ts      <span class="hljs-comment"># å…¥å£æ–‡ä»¶</span>
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.ts
â”œâ”€â”€ vue3-common/          <span class="hljs-comment"># å…¬å…±å·¥å…·åº“å’Œç±»å‹å®šä¹‰</span>
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ hooks/        <span class="hljs-comment"># Vue 3 Hooks</span>
â”‚   â”‚   â”œâ”€â”€ types/        <span class="hljs-comment"># ç±»å‹å®šä¹‰</span>
â”‚   â”‚   â””â”€â”€ index.ts      <span class="hljs-comment"># å…¥å£æ–‡ä»¶</span>
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.ts
â”œâ”€â”€ package.json          <span class="hljs-comment"># æ ¹é¡¹ç›®é…ç½®</span>
â””â”€â”€ pnpm-workspace.yaml   <span class="hljs-comment"># pnpmå·¥ä½œç©ºé—´é…ç½®</span>
</code></pre>
<h2 data-id="heading-3">å®‰è£…</h2>
<h3 data-id="heading-4">å®‰è£…æ•´ä¸ªç»„ä»¶åº“</h3>
<pre><code class="hljs language-bash" lang="bash">pnpm add @mengtr/vue3-antdv @mengtr/vue3-element @mengtr/vue3-common
</code></pre>
<h3 data-id="heading-5">å•ç‹¬å®‰è£…æŸä¸ªå­åŒ…</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…åŸºäºAnt Design Vueçš„ç»„ä»¶åº“</span>
pnpm add @mengtr/vue3-antdv

<span class="hljs-comment"># å®‰è£…åŸºäºElement Plusçš„ç»„ä»¶åº“</span>
pnpm add @mengtr/vue3-element

<span class="hljs-comment"># å®‰è£…å…¬å…±å·¥å…·åº“</span>
pnpm add @mengtr/vue3-common
</code></pre>
<h2 data-id="heading-6">åŒ…è¯´æ˜</h2>
<h3 data-id="heading-7">1. @mengtr/vue3-common</h3>
<p>å…¬å…±çš„å·¥å…·åº“å’Œç±»å‹å®šä¹‰ï¼Œè¢«å…¶ä»–ä¸¤ä¸ªåŒ…ä¾èµ–ã€‚</p>
<h4 data-id="heading-8">å¯¼å‡ºæ–¹æ³•</h4>



































<table><thead><tr><th>æ–¹æ³•å</th><th>æè¿°</th><th>å‚æ•°</th><th>è¿”å›å€¼</th></tr></thead><tbody><tr><td><code>useTable</code></td><td>åˆ†é¡µè¡¨æ ¼æ•°æ®ç®¡ç†é’©å­</td><td>- <code>getData</code>: æ•°æ®è·å–å‡½æ•°<br/>- <code>init</code>: æ˜¯å¦åˆå§‹åŒ–åŠ è½½<br/>- <code>param</code>: åˆå§‹å‚æ•°<br/>- <code>pageKey</code>: åˆ†é¡µå‚æ•°æ˜ å°„</td><td><code>{ tableData, pagination, onSearch, onReset, onSetParam, search }</code></td></tr><tr><td><code>useTreeTable</code></td><td>æ ‘çŠ¶è¡¨æ ¼æ•°æ®ç®¡ç†é’©å­</td><td>- <code>getData</code>: æ•°æ®è·å–å‡½æ•°<br/>- <code>init</code>: æ˜¯å¦åˆå§‹åŒ–åŠ è½½<br/>- <code>param</code>: åˆå§‹å‚æ•°</td><td><code>{ tableData, onSearch, onReset, onSetParam, search }</code></td></tr><tr><td><code>setTablePageKey</code></td><td>è®¾ç½®åˆ†é¡µå‚æ•°æ˜ å°„</td><td>- <code>key</code>: åŒ…å«pageã€sizeã€recordsã€totalçš„å¯¹è±¡</td><td><code>void</code></td></tr><tr><td><code>buildInitialFormData</code></td><td>æ„å»ºè¡¨å•åˆå§‹æ•°æ®</td><td>- <code>fields</code>: è¡¨å•å­—æ®µé…ç½®<br/>- <code>data</code>: åˆå§‹æ•°æ®</td><td><code>object</code></td></tr></tbody></table>
<h4 data-id="heading-9">ä½¿ç”¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { useTable, setTablePageKey } <span class="hljs-keyword">from</span> <span class="hljs-string">'@mengtr/vue3-common'</span>

<span class="hljs-comment">// è®¾ç½®åˆ†é¡µå‚æ•°æ˜ å°„</span>
<span class="hljs-title function_">setTablePageKey</span>({
  <span class="hljs-attr">page</span>: <span class="hljs-string">'page'</span>,
  <span class="hljs-attr">size</span>: <span class="hljs-string">'pageSize'</span>,
  <span class="hljs-attr">records</span>: <span class="hljs-string">'rows'</span>,
  <span class="hljs-attr">total</span>: <span class="hljs-string">'total'</span>
})

<span class="hljs-comment">// ä½¿ç”¨useTableé’©å­</span>
<span class="hljs-keyword">const</span> { tableData, pagination, onSearch, onReset } = <span class="hljs-title function_">useTable</span>(
  <span class="hljs-function">(<span class="hljs-params">params</span>) =&gt;</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/list'</span>, { params }), <span class="hljs-comment">// æ•°æ®è·å–å‡½æ•°</span>
  <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ˜¯å¦åˆå§‹åŒ–åŠ è½½</span>
  { <span class="hljs-attr">status</span>: <span class="hljs-number">1</span> } <span class="hljs-comment">// åˆå§‹å‚æ•°</span>
)

<span class="hljs-comment">// ä½¿ç”¨useTreeTableé’©å­</span>
<span class="hljs-keyword">const</span> { tableData, onSearch, onReset } = <span class="hljs-title function_">useTreeTable</span>(
  <span class="hljs-function">(<span class="hljs-params">params</span>) =&gt;</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/tree'</span>, { params }), <span class="hljs-comment">// æ•°æ®è·å–å‡½æ•°</span>
  <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ˜¯å¦åˆå§‹åŒ–åŠ è½½</span>
  { <span class="hljs-attr">parentId</span>: <span class="hljs-number">0</span> } <span class="hljs-comment">// åˆå§‹å‚æ•°</span>
)

</code></pre>
<h3 data-id="heading-10">2. @mengtr/vue3-antdv</h3>
<p>åŸºäºAnt Design Vueçš„ç»„ä»¶åº“ï¼Œæä¾›äº†ä¸€ç³»åˆ—å¸¸ç”¨çš„ä¸šåŠ¡ç»„ä»¶ã€‚</p>
<h4 data-id="heading-11">å¯¼å‡ºç»„ä»¶</h4>













































<table><thead><tr><th>ç»„ä»¶å</th><th>åˆ«å</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>GPage</code></td><td><code>GTablePage</code></td><td>å®Œæ•´çš„å¢åˆ æ”¹æŸ¥é¡µé¢ç»„ä»¶</td></tr><tr><td><code>GSearch</code></td><td>-</td><td>æœç´¢åŠŸèƒ½ç»„ä»¶</td></tr><tr><td><code>GTable</code></td><td>-</td><td>è¡¨æ ¼+å¼¹çª—ç»„ä»¶</td></tr><tr><td><code>GModal</code></td><td>-</td><td>æ¨¡æ€æ¡†ç»„ä»¶</td></tr><tr><td><code>GForm</code></td><td>-</td><td>è¡¨å•ç»„ä»¶</td></tr><tr><td><code>GFormItem</code></td><td>-</td><td>è¡¨å•å­—æ®µç»„ä»¶ï¼ˆå³å°†åºŸå¼ƒï¼‰</td></tr><tr><td><code>BaseTable</code></td><td>-</td><td>åŸºç¡€è¡¨æ ¼ç»„ä»¶</td></tr></tbody></table>
<h4 data-id="heading-12">å¯¼å‡ºæ–¹æ³•</h4>

























<table><thead><tr><th>æ–¹æ³•å</th><th>æè¿°</th><th>æ¥æº</th></tr></thead><tbody><tr><td><code>useTable</code></td><td>åˆ†é¡µè¡¨æ ¼æ•°æ®ç®¡ç†é’©å­</td><td>ä»<code>@mengtr/vue3-common</code>å¯¼å…¥</td></tr><tr><td><code>useTreeTable</code></td><td>æ ‘çŠ¶è¡¨æ ¼æ•°æ®ç®¡ç†é’©å­</td><td>ä»<code>@mengtr/vue3-common</code>å¯¼å…¥</td></tr><tr><td><code>setTablePageKey</code></td><td>è®¾ç½®åˆ†é¡µå‚æ•°æ˜ å°„</td><td>ä»<code>@mengtr/vue3-common</code>å¯¼å…¥</td></tr></tbody></table>
<h4 data-id="heading-13">ä½¿ç”¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;!-- GPage å®Œæ•´å¢åˆ æ”¹æŸ¥é¡µé¢ --&gt;
  &lt;GPage :options="pageOptions" @export="onExport" @import="onImport" /&gt;
  
  &lt;!-- GSearch æœç´¢åŠŸèƒ½ç»„ä»¶ --&gt;
  &lt;GSearch :options="searchOptions" @search="onSearch" @reset="onReset" /&gt;
  
  &lt;!-- GTable è¡¨æ ¼+å¼¹çª—ç»„ä»¶ --&gt;
  &lt;GTable :options="tableOptions" /&gt;
  
  &lt;!-- BaseTable åŸºç¡€è¡¨æ ¼ç»„ä»¶ --&gt;
  &lt;BaseTable :type="1" ref="tableRef" :options="baseTableOptions"&gt;
    &lt;template #bodyCell="{ column, record, text, index }"&gt;
      &lt;!-- è‡ªå®šä¹‰å•å…ƒæ ¼å†…å®¹ --&gt;
      &lt;span v-if="column.dataIndex === 'status'"&gt;
        &lt;a-tag :color="record.status === 1 ? 'green' : 'red'"&gt;
          {{ record.status === 1 ? 'å¯ç”¨' : 'ç¦ç”¨' }}
        &lt;/a-tag&gt;
      &lt;/span&gt;
    &lt;/template&gt;
  &lt;/BaseTable&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { GPage, GSearch, GTable, BaseTable, useTable } from '@mengtr/vue3-antdv'
import axios from 'axios'

// GPage é…ç½®ç¤ºä¾‹
const pageOptions = {
  search: {
    searchOptions: [
      { type: 'string', label: 'åç§°', name: 'name', span: 6 },
      { type: 'select', label: 'çŠ¶æ€', name: 'status', options: [{ value: 1, label: 'å¯ç”¨' }, { value: 0, label: 'ç¦ç”¨' }] }
    ],
    enableCreate: true,
    enableExport: true,
    enableImport: true
  },
  table: {
    columns: [
      { title: 'åç§°', dataIndex: 'name', key: 'name' },
      { title: 'çŠ¶æ€', dataIndex: 'status', key: 'status' },
      { title: 'æ“ä½œ', dataIndex: 'action', key: 'action' }
    ],
    actions: [
      { label: 'ç¼–è¾‘', key: 1 },
      { label: 'è¯¦æƒ…', key: 2 },
      { label: 'åˆ é™¤', key: 3 },
      { label: 'è‡ªå®šä¹‰', key: 4, callback: (record) =&gt; console.log('è‡ªå®šä¹‰æ“ä½œ', record) }
    ],
    initParam: {}
  },
  modal: {
    config: { title: 'ç¼–è¾‘' },
    form: {
      config: {},
      fields: [
        { type: 'input', label: 'åç§°', name: 'name', config: { placeholder: 'è¯·è¾“å…¥åç§°' } }
      ]
    }
  },
  API: {
    getPage: (params) =&gt; axios.get('/api/list', { params }),
    detailApi: (id) =&gt; axios.get(`/api/detail/${id}`),
    delApi: (id) =&gt; axios.delete(`/api/delete/${id}`),
    putApi: (data) =&gt; axios.put('/api/update', data),
    postApi: (data) =&gt; axios.post('/api/create', data)
  }
}

// GSearch é…ç½®ç¤ºä¾‹
const searchOptions = {
  searchOptions: [
    { type: 'string', label: 'åç§°', name: 'name' },
    { type: 'select', label: 'çŠ¶æ€', name: 'status', options: [{ value: 1, label: 'å¯ç”¨' }, { value: 0, label: 'ç¦ç”¨' }] }
  ],
  enableCreate: true,
  enableExport: true
}

// GTable é…ç½®ç¤ºä¾‹
const tableOptions = {
  columns: [
    { title: 'åç§°', dataIndex: 'name', key: 'name' },
    { title: 'çŠ¶æ€', dataIndex: 'status', key: 'status' },
    { title: 'æ“ä½œ', dataIndex: 'action', key: 'action' }
  ],
  actions: [
    { label: 'ç¼–è¾‘', key: 1 },
    { label: 'è¯¦æƒ…', key: 2 },
    { label: 'åˆ é™¤', key: 3 }
  ],
  data: (params) =&gt; axios.get('/api/list', { params })
}

// BaseTable é…ç½®ç¤ºä¾‹
const baseTableOptions = {
  columns: [
    { title: 'åç§°', dataIndex: 'name', key: 'name' },
    { title: 'çŠ¶æ€', dataIndex: 'status', key: 'status' },
    { title: 'æ“ä½œ', dataIndex: 'action', key: 'action' }
  ],
  data: (params) =&gt; axios.get('/api/list', { params }),
  initParam: {},
  rowKey: 'id'
}

// äº‹ä»¶å¤„ç†
const onExport = () =&gt; { /* å¯¼å‡ºé€»è¾‘ */ }
const onImport = () =&gt; { /* å¯¼å…¥é€»è¾‘ */ }
const onSearch = (data) =&gt; { /* æœç´¢é€»è¾‘ */ }
const onReset = () =&gt; { /* é‡ç½®é€»è¾‘ */ }
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-14">3. @mengtr/vue3-element</h3>
<p>åŸºäºElement Plusçš„ç»„ä»¶åº“ï¼Œæä¾›äº†ä¸<code>@mengtr/vue3-antdv</code>ç›¸åŒçš„ç»„ä»¶APIï¼Œä½†ä½¿ç”¨Element Pluså®ç°ã€‚</p>
<h4 data-id="heading-15">å¯¼å‡ºç»„ä»¶</h4>













































<table><thead><tr><th>ç»„ä»¶å</th><th>åˆ«å</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>GPage</code></td><td><code>GTablePage</code></td><td>å®Œæ•´çš„å¢åˆ æ”¹æŸ¥é¡µé¢ç»„ä»¶</td></tr><tr><td><code>GSearch</code></td><td>-</td><td>æœç´¢åŠŸèƒ½ç»„ä»¶</td></tr><tr><td><code>GTable</code></td><td>-</td><td>è¡¨æ ¼+å¼¹çª—ç»„ä»¶</td></tr><tr><td><code>GModal</code></td><td>-</td><td>æ¨¡æ€æ¡†ç»„ä»¶</td></tr><tr><td><code>GForm</code></td><td>-</td><td>è¡¨å•ç»„ä»¶</td></tr><tr><td><code>GFormItem</code></td><td>-</td><td>è¡¨å•å­—æ®µç»„ä»¶ï¼ˆå³å°†åºŸå¼ƒï¼‰</td></tr><tr><td><code>BaseTable</code></td><td>-</td><td>åŸºç¡€è¡¨æ ¼ç»„ä»¶</td></tr></tbody></table>
<h4 data-id="heading-16">å¯¼å‡ºæ–¹æ³•</h4>

























<table><thead><tr><th>æ–¹æ³•å</th><th>æè¿°</th><th>æ¥æº</th></tr></thead><tbody><tr><td><code>useTable</code></td><td>åˆ†é¡µè¡¨æ ¼æ•°æ®ç®¡ç†é’©å­</td><td>ä»<code>@mengtr/vue3-common</code>å¯¼å…¥</td></tr><tr><td><code>useTreeTable</code></td><td>æ ‘çŠ¶è¡¨æ ¼æ•°æ®ç®¡ç†é’©å­</td><td>ä»<code>@mengtr/vue3-common</code>å¯¼å…¥</td></tr><tr><td><code>setTablePageKey</code></td><td>è®¾ç½®åˆ†é¡µå‚æ•°æ˜ å°„</td><td>ä»<code>@mengtr/vue3-common</code>å¯¼å…¥</td></tr></tbody></table>
<h4 data-id="heading-17">ä½¿ç”¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;!-- GPage å®Œæ•´å¢åˆ æ”¹æŸ¥é¡µé¢ --&gt;
  &lt;GPage :options="pageOptions" @export="onExport" @import="onImport" /&gt;
  
  &lt;!-- GSearch æœç´¢åŠŸèƒ½ç»„ä»¶ --&gt;
  &lt;GSearch :options="searchOptions" @search="onSearch" @reset="onReset" /&gt;
  
  &lt;!-- GTable è¡¨æ ¼+å¼¹çª—ç»„ä»¶ --&gt;
  &lt;GTable :options="tableOptions" /&gt;
  
  &lt;!-- BaseTable åŸºç¡€è¡¨æ ¼ç»„ä»¶ --&gt;
  &lt;BaseTable :type="1" ref="tableRef" :options="baseTableOptions"&gt;
    &lt;template #bodyCell="{ column, record, text, index }"&gt;
      &lt;!-- è‡ªå®šä¹‰å•å…ƒæ ¼å†…å®¹ --&gt;
      &lt;span v-if="column.property === 'status'"&gt;
        &lt;el-tag :type="record.status === 1 ? 'success' : 'danger'"&gt;
          {{ record.status === 1 ? 'å¯ç”¨' : 'ç¦ç”¨' }}
        &lt;/el-tag&gt;
      &lt;/span&gt;
    &lt;/template&gt;
  &lt;/BaseTable&gt;
&lt;/template&gt;

&lt;script setup lang="ts"&gt;
import { GPage, GSearch, GTable, BaseTable, useTable } from '@mengtr/vue3-element'
import axios from 'axios'

// é…ç½®ä¸@mengtr/vue3-antdvç›¸åŒ
const pageOptions = {
  // ... é…ç½®å†…å®¹ä¸@mengtr/vue3-antdvç›¸åŒ
}

const searchOptions = {
  // ... é…ç½®å†…å®¹ä¸@mengtr/vue3-antdvç›¸åŒ
}

const tableOptions = {
  // ... é…ç½®å†…å®¹ä¸@mengtr/vue3-antdvç›¸åŒ
}

const baseTableOptions = {
  // ... é…ç½®å†…å®¹ä¸@mengtr/vue3-antdvç›¸åŒ
}

// äº‹ä»¶å¤„ç†
const onExport = () =&gt; { /* å¯¼å‡ºé€»è¾‘ */ }
const onImport = () =&gt; { /* å¯¼å…¥é€»è¾‘ */ }
const onSearch = (data) =&gt; { /* æœç´¢é€»è¾‘ */ }
const onReset = () =&gt; { /* é‡ç½®é€»è¾‘ */ }
&lt;/script&gt;
</code></pre>
<h2 data-id="heading-18">ç»„ä»¶è¯¦ç»†è¯´æ˜</h2>
<h3 data-id="heading-19">GPage / GTablePage</h3>
<p>å®Œæ•´çš„å¢åˆ æ”¹æŸ¥é¡µé¢ç»„ä»¶ï¼Œé›†æˆäº†æœç´¢ã€è¡¨æ ¼ã€åˆ†é¡µã€æ¨¡æ€æ¡†ç­‰åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-20">å±æ€§</h4>




















<table><thead><tr><th>å±æ€§</th><th>ç±»å‹</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>options</code></td><td><code>IPageOptions</code></td><td>é¡µé¢é…ç½®é¡¹ï¼ŒåŒ…å«æœç´¢ã€è¡¨æ ¼ã€æ¨¡æ€æ¡†å’ŒAPIé…ç½®</td></tr><tr><td><code>disabled</code></td><td><code>boolean</code></td><td>æ˜¯å¦ç¦ç”¨</td></tr></tbody></table>
<h4 data-id="heading-21">äº‹ä»¶</h4>






























<table><thead><tr><th>äº‹ä»¶å</th><th>æè¿°</th><th>å‚æ•°</th></tr></thead><tbody><tr><td><code>export</code></td><td>å¯¼å‡ºäº‹ä»¶</td><td>-</td></tr><tr><td><code>import</code></td><td>å¯¼å…¥äº‹ä»¶</td><td>-</td></tr><tr><td><code>search</code></td><td>æœç´¢äº‹ä»¶</td><td><code>data: object</code></td></tr><tr><td><code>reset</code></td><td>é‡ç½®äº‹ä»¶</td><td>-</td></tr></tbody></table>
<h3 data-id="heading-22">GSearch</h3>
<p>æœç´¢åŠŸèƒ½ç»„ä»¶ï¼Œæ”¯æŒå¤šç§æœç´¢å­—æ®µç±»å‹ã€‚</p>
<h4 data-id="heading-23">å±æ€§</h4>















<table><thead><tr><th>å±æ€§</th><th>ç±»å‹</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>options</code></td><td><code>ISearch</code></td><td>æœç´¢é…ç½®é¡¹</td></tr></tbody></table>
<h4 data-id="heading-24">äº‹ä»¶</h4>



































<table><thead><tr><th>äº‹ä»¶å</th><th>æè¿°</th><th>å‚æ•°</th></tr></thead><tbody><tr><td><code>search</code></td><td>æœç´¢äº‹ä»¶</td><td><code>data: object</code></td></tr><tr><td><code>reset</code></td><td>é‡ç½®äº‹ä»¶</td><td>-</td></tr><tr><td><code>create</code></td><td>æ–°å¢äº‹ä»¶</td><td>-</td></tr><tr><td><code>export</code></td><td>å¯¼å‡ºäº‹ä»¶</td><td>-</td></tr><tr><td><code>import</code></td><td>å¯¼å…¥äº‹ä»¶</td><td>-</td></tr></tbody></table>
<h3 data-id="heading-25">GTable</h3>
<p>è¡¨æ ¼+å¼¹çª—ç»„ä»¶ï¼Œé›†æˆäº†è¡¨æ ¼å’Œæ¨¡æ€æ¡†åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-26">å±æ€§</h4>















<table><thead><tr><th>å±æ€§</th><th>ç±»å‹</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>options</code></td><td><code>ITable</code></td><td>è¡¨æ ¼é…ç½®é¡¹</td></tr></tbody></table>
<h3 data-id="heading-27">BaseTable</h3>
<p>åŸºç¡€è¡¨æ ¼ç»„ä»¶ï¼Œæ”¯æŒåˆ†é¡µã€æ’åºã€ç­›é€‰ç­‰åŠŸèƒ½ã€‚</p>
<h4 data-id="heading-28">å±æ€§</h4>























<table><thead><tr><th>å±æ€§</th><th>ç±»å‹</th><th>æè¿°</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td><code>type</code></td><td><code>1 | 2</code></td><td>è¡¨æ ¼ç±»å‹ï¼Œ1è¡¨ç¤ºæ™®é€šè¡¨æ ¼ï¼Œ2è¡¨ç¤ºæ ‘å½¢è¡¨æ ¼</td><td>1</td></tr><tr><td><code>options</code></td><td><code>IProps</code></td><td>è¡¨æ ¼é…ç½®é¡¹</td><td><code>{}</code></td></tr></tbody></table>
<h4 data-id="heading-29">æ’æ§½</h4>















<table><thead><tr><th>æ’æ§½å</th><th>æè¿°</th><th>å‚æ•°</th></tr></thead><tbody><tr><td><code>bodyCell</code></td><td>è‡ªå®šä¹‰å•å…ƒæ ¼å†…å®¹</td><td><code>{ column, record, text, index }</code></td></tr></tbody></table>
<h4 data-id="heading-30">æš´éœ²æ–¹æ³•</h4>



































<table><thead><tr><th>æ–¹æ³•å</th><th>æè¿°</th><th>å‚æ•°</th></tr></thead><tbody><tr><td><code>onSearch</code></td><td>è§¦å‘æœç´¢</td><td><code>(data?: any) =&gt; void</code></td></tr><tr><td><code>onReset</code></td><td>é‡ç½®æœç´¢</td><td><code>() =&gt; void</code></td></tr><tr><td><code>onSetParam</code></td><td>è®¾ç½®å‚æ•°</td><td><code>(param: any) =&gt; void</code></td></tr><tr><td><code>search</code></td><td>æœç´¢å¯¹è±¡</td><td><code>Ref&lt;object&gt;</code></td></tr><tr><td><code>pagination</code></td><td>åˆ†é¡µå¯¹è±¡</td><td><code>Ref&lt;object&gt;</code></td></tr></tbody></table>
<h2 data-id="heading-31">å¼€å‘</h2>
<h3 data-id="heading-32">å®‰è£…ä¾èµ–</h3>
<pre><code class="hljs language-bash" lang="bash">pnpm install
</code></pre>
<h3 data-id="heading-33">æ„å»ºæ‰€æœ‰åŒ…</h3>
<pre><code class="hljs language-bash" lang="bash">pnpm run build
</code></pre>
<h3 data-id="heading-34">å•ç‹¬æ„å»ºæŸä¸ªåŒ…</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ„å»ºvue3-antdvåŒ…</span>
pnpm --filter @mengtr/vue3-antdv run build

<span class="hljs-comment"># æ„å»ºvue3-elementåŒ…</span>
pnpm --filter @mengtr/vue3-element run build

<span class="hljs-comment"># æ„å»ºvue3-commonåŒ…</span>
pnpm --filter @mengtr/vue3-common run build
</code></pre>
<h3 data-id="heading-35">å‘å¸ƒåŒ…</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å‘å¸ƒæ‰€æœ‰åŒ…</span>
pnpm publish -r

<span class="hljs-comment"># å•ç‹¬å‘å¸ƒæŸä¸ªåŒ…</span>
pnpm --filter @mengtr/vue3-antdv publish
</code></pre>
<h2 data-id="heading-36">ç±»å‹å®šä¹‰</h2>
<h3 data-id="heading-37">IProps</h3>
<p>è¡¨æ ¼é…ç½®é¡¹ç±»å‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IProps</span>&lt;T = <span class="hljs-built_in">any</span>, P = <span class="hljs-built_in">any</span>&gt; {
    <span class="hljs-attr">columns</span>: P[]           <span class="hljs-comment">// è¡¨æ ¼åˆ—é…ç½®</span>
    <span class="hljs-attr">data</span>: T                <span class="hljs-comment">// æ•°æ®è·å–å‡½æ•°</span>
    initParam?: <span class="hljs-built_in">any</span>        <span class="hljs-comment">// åˆå§‹åŒ–å‚æ•°</span>
    rowKey?: <span class="hljs-built_in">string</span>        <span class="hljs-comment">// è¡Œé”®</span>
    scroll?: { x?: <span class="hljs-built_in">number</span>; y?: <span class="hljs-built_in">number</span> }  <span class="hljs-comment">// æ»šåŠ¨é…ç½®</span>
    bordered?: <span class="hljs-built_in">boolean</span>     <span class="hljs-comment">// æ˜¯å¦æ˜¾ç¤ºè¾¹æ¡†</span>
    init?: <span class="hljs-built_in">boolean</span>         <span class="hljs-comment">// æ˜¯å¦åˆå§‹åŒ–æ•°æ®</span>
}
</code></pre>
<h3 data-id="heading-38">GetData</h3>
<p>æ•°æ®è·å–å‡½æ•°ç±»å‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">GetData</span>&lt;T = <span class="hljs-built_in">any</span>&gt; = <span class="hljs-function">(<span class="hljs-params">params: { page: { page: <span class="hljs-built_in">number</span>; size: <span class="hljs-built_in">number</span> }; param: <span class="hljs-built_in">any</span> }</span>) =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;{ [<span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span> } &amp; { <span class="hljs-attr">records</span>: T[]; <span class="hljs-attr">total</span>: <span class="hljs-built_in">number</span> }&gt;
</code></pre>
<h3 data-id="heading-39">TreeData</h3>
<p>æ ‘çŠ¶æ•°æ®è·å–å‡½æ•°ç±»å‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">TreeData</span>&lt;T = <span class="hljs-built_in">any</span>&gt; = <span class="hljs-function">(<span class="hljs-params">params: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-title class_">Promise</span>&lt;T[]&gt;
</code></pre>
<h2 data-id="heading-40">FormItem ç±»å‹</h2>
<h3 data-id="heading-41">TFormItemType</h3>
<p>è¡¨å•å­—æ®µç±»å‹æšä¸¾ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">TFormItemType</span> =
  | <span class="hljs-string">'input'</span>        <span class="hljs-comment">// è¾“å…¥æ¡†</span>
  | <span class="hljs-string">'textarea'</span>     <span class="hljs-comment">// æ–‡æœ¬åŸŸ</span>
  | <span class="hljs-string">'number'</span>       <span class="hljs-comment">// æ•°å­—è¾“å…¥æ¡†</span>
  | <span class="hljs-string">'select'</span>       <span class="hljs-comment">// ä¸‹æ‹‰é€‰æ‹©å™¨</span>
  | <span class="hljs-string">'treeselect'</span>   <span class="hljs-comment">// æ ‘çŠ¶é€‰æ‹©å™¨</span>
  | <span class="hljs-string">'switch'</span>       <span class="hljs-comment">// å¼€å…³</span>
  | <span class="hljs-string">'datepicker'</span>   <span class="hljs-comment">// æ—¥æœŸé€‰æ‹©å™¨</span>
  | <span class="hljs-string">'rangepicker'</span>  <span class="hljs-comment">// æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨</span>
  | <span class="hljs-string">'component'</span>   <span class="hljs-comment">// è‡ªå®šä¹‰ç»„ä»¶</span>
  | <span class="hljs-string">'object'</span>       <span class="hljs-comment">// å¯¹è±¡ç±»å‹ï¼ˆåµŒå¥—è¡¨å•ï¼‰</span>
  | <span class="hljs-string">'array'</span>        <span class="hljs-comment">// æ•°ç»„ç±»å‹ï¼ˆåŠ¨æ€è¡¨å•ï¼‰</span>
</code></pre>
<h3 data-id="heading-42">IBaseFormItem</h3>
<p>åŸºç¡€è¡¨å•å­—æ®µæ¥å£ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IBaseFormItem</span> {
  <span class="hljs-attr">type</span>: <span class="hljs-title class_">TFormItemType</span>     <span class="hljs-comment">// å­—æ®µç±»å‹</span>
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>            <span class="hljs-comment">// å­—æ®µå</span>
  label?: <span class="hljs-built_in">string</span>          <span class="hljs-comment">// æ ‡ç­¾å</span>
  span?: <span class="hljs-built_in">number</span>           <span class="hljs-comment">// å ç”¨åˆ—æ•°</span>
  defaultValue?: <span class="hljs-built_in">any</span>      <span class="hljs-comment">// é»˜è®¤å€¼</span>
  disabled?: <span class="hljs-built_in">boolean</span>      <span class="hljs-comment">// æ˜¯å¦ç¦ç”¨</span>

  dependsOn?: {           <span class="hljs-comment">// ä¾èµ–æ¡ä»¶</span>
    <span class="hljs-attr">path</span>: <span class="hljs-built_in">string</span>[]        <span class="hljs-comment">// ä¾èµ–å­—æ®µè·¯å¾„</span>
    <span class="hljs-attr">value</span>: <span class="hljs-built_in">any</span>            <span class="hljs-comment">// ä¾èµ–å­—æ®µå€¼</span>
  }

  callback?: <span class="hljs-function">(<span class="hljs-params">formData: Recordable, field: IFormItem, oldValue?: <span class="hljs-built_in">any</span>, newValue?: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>  <span class="hljs-comment">// å­—æ®µå˜åŒ–å›è°ƒ</span>
  watch?: {              <span class="hljs-comment">// ç›‘å¬é…ç½®</span>
    <span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>[]        <span class="hljs-comment">// ç›‘å¬å­—æ®µè·¯å¾„</span>
    <span class="hljs-attr">callback</span>: <span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>  <span class="hljs-comment">// ç›‘å¬å›è°ƒ</span>
  },
  config?: <span class="hljs-title class_">Recordable</span>     <span class="hljs-comment">// é¢å¤–é…ç½®</span>
}
</code></pre>
<h3 data-id="heading-43">IFormItem</h3>
<p>è¡¨å•å­—æ®µè”åˆç±»å‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">IFormItem</span> =
  | <span class="hljs-title class_">IInputFormItem</span>        <span class="hljs-comment">// è¾“å…¥æ¡†</span>
  | <span class="hljs-title class_">ITextareaFormItem</span>     <span class="hljs-comment">// æ–‡æœ¬åŸŸ</span>
  | <span class="hljs-title class_">INumberFormItem</span>       <span class="hljs-comment">// æ•°å­—è¾“å…¥æ¡†</span>
  | <span class="hljs-title class_">ISelectFormItem</span>       <span class="hljs-comment">// ä¸‹æ‹‰é€‰æ‹©å™¨</span>
  | <span class="hljs-title class_">ISwitchFormItem</span>       <span class="hljs-comment">// å¼€å…³</span>
  | <span class="hljs-title class_">IDatePickerFormItem</span>   <span class="hljs-comment">// æ—¥æœŸé€‰æ‹©å™¨</span>
  | <span class="hljs-title class_">IRangePickerFormItem</span>  <span class="hljs-comment">// æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨</span>
  | <span class="hljs-title class_">IComponentFormItem</span>    <span class="hljs-comment">// è‡ªå®šä¹‰ç»„ä»¶</span>
  | <span class="hljs-title class_">IObjectFormItem</span>       <span class="hljs-comment">// å¯¹è±¡ç±»å‹ï¼ˆåµŒå¥—è¡¨å•ï¼‰</span>
  | <span class="hljs-title class_">IArrayFormItem</span>        <span class="hljs-comment">// æ•°ç»„ç±»å‹ï¼ˆåŠ¨æ€è¡¨å•ï¼‰</span>
</code></pre>
<h2 data-id="heading-44">æœç´¢ç±»å‹</h2>
<h3 data-id="heading-45">TSearchType</h3>
<p>æœç´¢å­—æ®µç±»å‹æšä¸¾ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">TSearchType</span> =
  | <span class="hljs-string">'number'</span>       <span class="hljs-comment">// æ•°å­—ç±»å‹</span>
  | <span class="hljs-string">'string'</span>       <span class="hljs-comment">// å­—ç¬¦ä¸²ç±»å‹</span>
  | <span class="hljs-string">'datapicker'</span>   <span class="hljs-comment">// æ—¥æœŸé€‰æ‹©å™¨</span>
  | <span class="hljs-string">'rangepicker'</span>  <span class="hljs-comment">// æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨</span>
  | <span class="hljs-string">'select'</span>       <span class="hljs-comment">// ä¸‹æ‹‰é€‰æ‹©å™¨</span>
  | <span class="hljs-string">'treeselect'</span>   <span class="hljs-comment">// æ ‘çŠ¶é€‰æ‹©å™¨</span>
</code></pre>
<h3 data-id="heading-46">TSearchOption</h3>
<p>æœç´¢å­—æ®µè”åˆç±»å‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> <span class="hljs-title class_">TSearchOption</span> =
  | <span class="hljs-title class_">INumberSearchField</span>       <span class="hljs-comment">// æ•°å­—ç±»å‹æœç´¢å­—æ®µ</span>
  | <span class="hljs-title class_">IStringSearchField</span>       <span class="hljs-comment">// å­—ç¬¦ä¸²ç±»å‹æœç´¢å­—æ®µ</span>
  | <span class="hljs-title class_">IDataPickerSearchField</span>   <span class="hljs-comment">// æ—¥æœŸé€‰æ‹©å™¨æœç´¢å­—æ®µ</span>
  | <span class="hljs-title class_">IRangePickerSearchField</span>  <span class="hljs-comment">// æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨æœç´¢å­—æ®µ</span>
  | <span class="hljs-title class_">ISelectSearchField</span>       <span class="hljs-comment">// ä¸‹æ‹‰é€‰æ‹©å™¨æœç´¢å­—æ®µ</span>
</code></pre>
<h3 data-id="heading-47">ISearch</h3>
<p>æœç´¢é…ç½®æ¥å£ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ISearch</span> {
  <span class="hljs-attr">searchOptions</span>: <span class="hljs-title class_">TSearchOption</span>[]  <span class="hljs-comment">// æœç´¢å­—æ®µé…ç½®</span>
  enableExport?: <span class="hljs-built_in">boolean</span>         <span class="hljs-comment">// æ˜¯å¦å¯ç”¨å¯¼å‡º</span>
  enableImport?: <span class="hljs-built_in">boolean</span>         <span class="hljs-comment">// æ˜¯å¦å¯ç”¨å¯¼å…¥</span>
  enableCreate?: <span class="hljs-built_in">boolean</span>         <span class="hljs-comment">// æ˜¯å¦å¯ç”¨æ–°å¢</span>
  span?: <span class="hljs-built_in">number</span>                  <span class="hljs-comment">// æœç´¢å­—æ®µå ç”¨åˆ—æ•°</span>
}
</code></pre>
<h2 data-id="heading-48">æ³¨æ„äº‹é¡¹</h2>
<ol>
<li>ç¡®ä¿ä½ çš„é¡¹ç›®ä½¿ç”¨Vue 3.5.0æˆ–ä»¥ä¸Šç‰ˆæœ¬</li>
<li>ç¡®ä¿æ­£ç¡®å®‰è£…äº†å¯¹åº”çš„UIåº“ä¾èµ–ï¼š
<ul>
<li>ä½¿ç”¨<code>@mengtr/vue3-antdv</code>æ—¶ï¼Œéœ€è¦å®‰è£…<code>ant-design-vue</code>å’Œ<code>@ant-design/icons-vue</code></li>
<li>ä½¿ç”¨<code>@mengtr/vue3-element</code>æ—¶ï¼Œéœ€è¦å®‰è£…<code>element-plus</code>å’Œ<code>@element-plus/icons-vue</code></li>
</ul>
</li>
<li>å»ºè®®ä½¿ç”¨pnpmä½œä¸ºåŒ…ç®¡ç†å™¨ï¼Œä»¥è·å¾—æœ€ä½³çš„å·¥ä½œç©ºé—´æ”¯æŒ</li>
<li><code>GFormItem</code>ç»„ä»¶å³å°†åºŸå¼ƒï¼Œå»ºè®®ä½¿ç”¨<code>GForm</code>ç»„ä»¶æ›¿ä»£</li>
<li>ç»„ä»¶åº“æä¾›äº†å®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰ï¼Œå»ºè®®ä½¿ç”¨TypeScriptå¼€å‘ä»¥è·å¾—æ›´å¥½çš„å¼€å‘ä½“éªŒ</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨ Flutter Pay æ’ä»¶å®ç° Apple Pay å’Œ Google Pay çš„å®Œæ•´æŒ‡å—]]></title>    <link>https://juejin.cn/post/7585289701826740233</link>    <guid>https://juejin.cn/post/7585289701826740233</guid>    <pubDate>2025-12-19T08:11:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585289701826740233" data-draft-id="7585289701826592777" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨ Flutter Pay æ’ä»¶å®ç° Apple Pay å’Œ Google Pay çš„å®Œæ•´æŒ‡å—"/> <meta itemprop="keywords" content="Flutter"/> <meta itemprop="datePublished" content="2025-12-19T08:11:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€åæ™®é€šçš„ç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/3913917126936087"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨ Flutter Pay æ’ä»¶å®ç° Apple Pay å’Œ Google Pay çš„å®Œæ•´æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3913917126936087/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€åæ™®é€šçš„ç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T08:11:28.000Z" title="Fri Dec 19 2025 08:11:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p><code>pay</code> æ˜¯ Google å®˜æ–¹ç»´æŠ¤çš„ Flutter æ’ä»¶ï¼Œæä¾›äº†ç»Ÿä¸€çš„ API æ¥é›†æˆ Apple Pay å’Œ Google Payã€‚ç›¸æ¯”å…¶ä»–æ”¯ä»˜æ’ä»¶ï¼Œå®ƒæ›´åŠ è½»é‡ä¸”æ˜“äºé…ç½®ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨è¿™ä¸ªæ’ä»¶åœ¨ Flutter åº”ç”¨ä¸­å®ç°åŸç”Ÿæ”¯ä»˜åŠŸèƒ½ã€‚</p>
<h2 data-id="heading-1">æ’ä»¶ä»‹ç»</h2>
<h3 data-id="heading-2">ä¸ºä»€ä¹ˆé€‰æ‹© pay æ’ä»¶ï¼Ÿ</h3>
<ul>
<li><strong>å®˜æ–¹ç»´æŠ¤</strong>: ç”± Google å®˜æ–¹å›¢é˜Ÿç»´æŠ¤ï¼Œæ›´æ–°åŠæ—¶</li>
<li><strong>ç»Ÿä¸€ API</strong>: ä¸€å¥—ä»£ç åŒæ—¶æ”¯æŒ Apple Pay å’Œ Google Pay</li>
<li><strong>é…ç½®ç®€å•</strong>: ä½¿ç”¨ JSON é…ç½®æ–‡ä»¶ï¼Œæ— éœ€å¤æ‚çš„åŸç”Ÿä»£ç </li>
<li><strong>çµæ´»æ€§é«˜</strong>: æ”¯æŒå¤šç§æ”¯ä»˜ç½‘å…³ï¼ˆStripeã€Braintreeã€Adyen ç­‰ï¼‰</li>
<li><strong>å†…ç½® UI</strong>: æä¾›æ ‡å‡†çš„æ”¯ä»˜æŒ‰é’®ç»„ä»¶</li>
</ul>
<h3 data-id="heading-3">æ’ä»¶æ¶æ„</h3>
<pre><code class="hljs language-ASCII" lang="ASCII">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Flutter App                       â”‚
â”‚                   (Payment UI)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       pay                           â”‚
â”‚                     (Plugin)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       Apple Pay        â”‚        Google Pay          â”‚
â”‚        (iOS)           â”‚        (Android)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  Payment Gateway                    â”‚
â”‚      Stripe  |  Braintree  |  Adyen  |  Others...   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 data-id="heading-4">ç¯å¢ƒå‡†å¤‡</h2>
<h3 data-id="heading-5">å‰ç½®è¦æ±‚</h3>
<ul>
<li>Flutter SDK &gt;= 3.0.0</li>
<li>Dart &gt;= 2.17.0</li>
<li>iOS 12.0+ (Apple Pay)</li>
<li>Android API 19+ (Google Pay)</li>
<li>æ”¯ä»˜ç½‘å…³è´¦æˆ·ï¼ˆå¦‚ Stripeï¼‰</li>
</ul>
<h3 data-id="heading-6">å¼€å‘ç¯å¢ƒ</h3>
<ul>
<li>Xcode 14+ (iOS å¼€å‘)</li>
<li>Android Studio / VS Code</li>
<li>çœŸæœºè®¾å¤‡ï¼ˆæ¨¡æ‹Ÿå™¨æ”¯æŒæœ‰é™ï¼‰</li>
</ul>
<h2 data-id="heading-7">å®‰è£…ä¸é…ç½®</h2>
<h3 data-id="heading-8">1. æ·»åŠ ä¾èµ–</h3>
<p>åœ¨ <code>pubspec.yaml</code> ä¸­æ·»åŠ ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">dependencies:</span>
  <span class="hljs-attr">pay:</span> <span class="hljs-string">^3.3.0</span>
</code></pre>
<p>è¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">flutter pub get
</code></pre>
<h3 data-id="heading-9">2. iOS é…ç½® (Apple Pay)</h3>
<h4 data-id="heading-10">2.1 ä¿®æ”¹ <code>ios/Podfile</code></h4>
<pre><code class="hljs language-ruby" lang="ruby">platform <span class="hljs-symbol">:ios</span>, <span class="hljs-string">'12.0'</span>
</code></pre>
<h4 data-id="heading-11">2.2 åœ¨ Xcode ä¸­æ·»åŠ  Apple Pay èƒ½åŠ›</h4>
<ol>
<li>æ‰“å¼€ <code>ios/Runner.xcworkspace</code></li>
<li>é€‰æ‹© Runner é¡¹ç›® â†’ Signing &amp; Capabilities</li>
<li>ç‚¹å‡» "+ Capability" â†’ æ·»åŠ  "Apple Pay"</li>
<li>æ·»åŠ ä½ çš„ Merchant IDï¼ˆæ ¼å¼ï¼š<code>merchant.com.yourcompany.yourapp</code>ï¼‰</li>
</ol>
<h4 data-id="heading-12">2.3 Apple Developer é…ç½®</h4>
<ol>
<li>ç™»å½• <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2F" target="_blank" title="https://developer.apple.com/" ref="nofollow noopener noreferrer">Apple Developer Portal</a></li>
<li>è¿›å…¥ Certificates, Identifiers &amp; Profiles</li>
<li>é€‰æ‹© Identifiers â†’ Merchant IDs</li>
<li>åˆ›å»ºæ–°çš„ Merchant ID</li>
<li>ä¸ºä½ çš„ App ID å¯ç”¨ Apple Pay å¹¶å…³è” Merchant ID</li>
</ol>
<h3 data-id="heading-13">3. Android é…ç½® (Google Pay)</h3>
<h4 data-id="heading-14">3.1 ä¿®æ”¹ <code>android/app/build.gradle.kts</code></h4>
<pre><code class="hljs language-kotlin" lang="kotlin">android {
    compileSdk = <span class="hljs-number">34</span>
    
    defaultConfig {
        minSdk = <span class="hljs-number">19</span>
        targetSdk = <span class="hljs-number">34</span>
    }
}
</code></pre>
<h4 data-id="heading-15">3.2 ä¿®æ”¹ <code>android/app/src/main/AndroidManifest.xml</code></h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">manifest</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">application</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- å¯ç”¨ Google Pay API --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta-data</span>
            <span class="hljs-attr">android:name</span>=<span class="hljs-string">"com.google.android.gms.wallet.api.enabled"</span>
            <span class="hljs-attr">android:value</span>=<span class="hljs-string">"true"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">application</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">manifest</span>&gt;</span>
</code></pre>
<h2 data-id="heading-16">æ”¯ä»˜é…ç½®æ–‡ä»¶</h2>
<p><code>pay</code> æ’ä»¶ä½¿ç”¨ JSON é…ç½®æ–‡ä»¶æ¥å®šä¹‰æ”¯ä»˜å‚æ•°ã€‚è¿™æ˜¯è¯¥æ’ä»¶çš„æ ¸å¿ƒç‰¹æ€§ã€‚</p>
<h3 data-id="heading-17">1. åˆ›å»ºé…ç½®æ–‡ä»¶ç›®å½•</h3>
<pre><code class="hljs">assets/
â”œâ”€â”€ apple_pay_config.json
â””â”€â”€ google_pay_config.json
</code></pre>
<h3 data-id="heading-18">2. Apple Pay é…ç½®æ–‡ä»¶</h3>
<p>åˆ›å»º <code>assets/apple_pay_config.json</code>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"apple_pay"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"merchantIdentifier"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"merchant.com.yourcompany.yourapp"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"displayName"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Your Store Name"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"merchantCapabilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-string">"3DS"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"debit"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"credit"</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"supportedNetworks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-string">"amex"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"discover"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"masterCard"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"visa"</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"countryCode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"US"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"currencyCode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"USD"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"requiredBillingContactFields"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-string">"emailAddress"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"name"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"phoneNumber"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"postalAddress"</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"requiredShippingContactFields"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-string">"emailAddress"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"name"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"phoneNumber"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"postalAddress"</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"shippingMethods"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"amount"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0.00"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"detail"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"3-5 business days"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"identifier"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"standard"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"label"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Standard Shipping"</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"amount"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"9.99"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"detail"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1-2 business days"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"identifier"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"express"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"label"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Express Shipping"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-19">é…ç½®å‚æ•°è¯´æ˜</h3>

































<table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>merchantIdentifier</code></td><td>Apple Developer ä¸­åˆ›å»ºçš„ Merchant ID</td></tr><tr><td><code>displayName</code></td><td>æ”¯ä»˜è¡¨å•ä¸­æ˜¾ç¤ºçš„å•†æˆ·åç§°</td></tr><tr><td><code>merchantCapabilities</code></td><td>æ”¯æŒçš„æ”¯ä»˜èƒ½åŠ›ï¼ˆ3DSã€å€Ÿè®°å¡ã€ä¿¡ç”¨å¡ï¼‰</td></tr><tr><td><code>supportedNetworks</code></td><td>æ”¯æŒçš„å¡ç½‘ç»œ</td></tr><tr><td><code>countryCode</code></td><td>å•†æˆ·æ‰€åœ¨å›½å®¶ä»£ç </td></tr><tr><td><code>currencyCode</code></td><td>äº¤æ˜“è´§å¸ä»£ç </td></tr></tbody></table>
<h3 data-id="heading-20">3. Google Pay é…ç½®æ–‡ä»¶</h3>
<p>åˆ›å»º <code>assets/google_pay_config.json</code>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"google_pay"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"environment"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"TEST"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"apiVersion"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"apiVersionMinor"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"allowedPaymentMethods"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"CARD"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"tokenizationSpecification"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"PAYMENT_GATEWAY"</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"gateway"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"stripe"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"stripe:version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2020-08-27"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"stripe:publishableKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"pk_test_your_publishable_key"</span>
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"allowedCardNetworks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
            <span class="hljs-string">"VISA"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-string">"MASTERCARD"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-string">"AMEX"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-string">"DISCOVER"</span>
          <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"allowedAuthMethods"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
            <span class="hljs-string">"PAN_ONLY"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-string">"CRYPTOGRAM_3DS"</span>
          <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"billingAddressRequired"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"billingAddressParameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"format"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"FULL"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"phoneNumberRequired"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"merchantInfo"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"merchantId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"BCR2DN4XXXXX"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"merchantName"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Your Store Name"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"transactionInfo"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"countryCode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"US"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"currencyCode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"USD"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-21">Google Pay é…ç½®å‚æ•°è¯´æ˜</h3>





























<table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>environment</code></td><td><code>TEST</code> æˆ– <code>PRODUCTION</code></td></tr><tr><td><code>gateway</code></td><td>æ”¯ä»˜ç½‘å…³åç§°ï¼ˆstripeã€braintree ç­‰ï¼‰</td></tr><tr><td><code>merchantId</code></td><td>Google Pay å•†æˆ· IDï¼ˆç”Ÿäº§ç¯å¢ƒéœ€è¦ï¼‰</td></tr><tr><td><code>allowedCardNetworks</code></td><td>æ”¯æŒçš„å¡ç½‘ç»œ</td></tr><tr><td><code>allowedAuthMethods</code></td><td>æ”¯æŒçš„è®¤è¯æ–¹å¼</td></tr></tbody></table>
<h3 data-id="heading-22">4. å¼•ç”¨èµ„æºæ–‡ä»¶</h3>
<p>åœ¨ <code>pubspec.yaml</code> ä¸­æ·»åŠ ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">flutter:</span>
  <span class="hljs-attr">assets:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">assets/apple_pay_config.json</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">assets/google_pay_config.json</span>
</code></pre>
<h2 data-id="heading-23">Apple Pay å®ç°</h2>
<h3 data-id="heading-24">åŸºç¡€å®ç°</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'package:pay/pay.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter/material.dart'</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ApplePayExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-keyword">const</span> ApplePayExample({<span class="hljs-keyword">super</span>.key});

  <span class="hljs-meta">@override</span>
  State&lt;ApplePayExample&gt; createState() =&gt; _ApplePayExampleState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_ApplePayExampleState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">ApplePayExample</span>&gt; </span>{
  <span class="hljs-keyword">late</span> <span class="hljs-keyword">final</span> Pay _payClient;

  <span class="hljs-comment">// å®šä¹‰æ”¯ä»˜é¡¹ç›®</span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;PaymentItem&gt; _paymentItems = [
    <span class="hljs-keyword">const</span> PaymentItem(
      label: <span class="hljs-string">'å•†å“å°è®¡'</span>,
      amount: <span class="hljs-string">'99.99'</span>,
      status: PaymentItemStatus.final_price,
    ),
    <span class="hljs-keyword">const</span> PaymentItem(
      label: <span class="hljs-string">'è¿è´¹'</span>,
      amount: <span class="hljs-string">'5.99'</span>,
      status: PaymentItemStatus.final_price,
    ),
    <span class="hljs-keyword">const</span> PaymentItem(
      label: <span class="hljs-string">'æ€»è®¡'</span>,
      amount: <span class="hljs-string">'105.98'</span>,
      status: PaymentItemStatus.final_price,
    ),
  ];

  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> initState() {
    <span class="hljs-keyword">super</span>.initState();
    <span class="hljs-comment">// ä»é…ç½®æ–‡ä»¶åˆå§‹åŒ–</span>
    _payClient = Pay({
      PayProvider.apple_pay: PaymentConfiguration.fromJsonString(
        _applePayConfigString,
      ),
    });
  }

  <span class="hljs-comment">// å¤„ç†æ”¯ä»˜ç»“æœ</span>
  <span class="hljs-keyword">void</span> _onApplePayResult(<span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">dynamic</span>&gt; result) {
    <span class="hljs-comment">// result åŒ…å«æ”¯ä»˜ token å’Œå…¶ä»–ä¿¡æ¯</span>
    debugPrint(<span class="hljs-string">'Apple Pay ç»“æœ: <span class="hljs-subst">$result</span>'</span>);
    
    <span class="hljs-comment">// å°† token å‘é€åˆ°åç«¯å¤„ç†</span>
    _processPayment(result);
  }

  Future&lt;<span class="hljs-keyword">void</span>&gt; _processPayment(<span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">dynamic</span>&gt; paymentResult) <span class="hljs-keyword">async</span> {
    <span class="hljs-comment">// å‘é€åˆ°åç«¯</span>
    <span class="hljs-comment">// final response = await http.post(...);</span>
  }

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Scaffold(
      body: Center(
        child: ApplePayButton(
          paymentConfiguration: PaymentConfiguration.fromJsonString(
            _applePayConfigString,
          ),
          paymentItems: _paymentItems,
          style: ApplePayButtonStyle.black,
          type: ApplePayButtonType.buy,
          onPaymentResult: _onApplePayResult,
          onError: (error) {
            debugPrint(<span class="hljs-string">'Apple Pay é”™è¯¯: <span class="hljs-subst">$error</span>'</span>);
          },
          loadingIndicator: <span class="hljs-keyword">const</span> CircularProgressIndicator(),
        ),
      ),
    );
  }
}
</code></pre>
<h3 data-id="heading-25">Apple Pay æŒ‰é’®æ ·å¼</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// æŒ‰é’®æ ·å¼é€‰é¡¹</span>
ApplePayButtonStyle.black      <span class="hljs-comment">// é»‘è‰²èƒŒæ™¯</span>
ApplePayButtonStyle.white      <span class="hljs-comment">// ç™½è‰²èƒŒæ™¯</span>
ApplePayButtonStyle.whiteOutline  <span class="hljs-comment">// ç™½è‰²å¸¦è¾¹æ¡†</span>

<span class="hljs-comment">// æŒ‰é’®ç±»å‹é€‰é¡¹</span>
ApplePayButtonType.buy         <span class="hljs-comment">// "ä½¿ç”¨ Apple Pay è´­ä¹°"</span>
ApplePayButtonType.plain       <span class="hljs-comment">// Apple Pay å›¾æ ‡</span>
ApplePayButtonType.setUp       <span class="hljs-comment">// "è®¾ç½® Apple Pay"</span>
ApplePayButtonType.inStore     <span class="hljs-comment">// "åº—å†…ä½¿ç”¨ Apple Pay"</span>
ApplePayButtonType.donate      <span class="hljs-comment">// "ä½¿ç”¨ Apple Pay æèµ "</span>
ApplePayButtonType.checkout    <span class="hljs-comment">// "ä½¿ç”¨ Apple Pay ç»“è´¦"</span>
ApplePayButtonType.book        <span class="hljs-comment">// "ä½¿ç”¨ Apple Pay é¢„è®¢"</span>
ApplePayButtonType.subscribe   <span class="hljs-comment">// "ä½¿ç”¨ Apple Pay è®¢é˜…"</span>
</code></pre>
<h2 data-id="heading-26">Google Pay å®ç°</h2>
<h3 data-id="heading-27">åŸºç¡€å®ç°</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'package:pay/pay.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter/material.dart'</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GooglePayExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-keyword">const</span> GooglePayExample({<span class="hljs-keyword">super</span>.key});

  <span class="hljs-meta">@override</span>
  State&lt;GooglePayExample&gt; createState() =&gt; _GooglePayExampleState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_GooglePayExampleState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">GooglePayExample</span>&gt; </span>{
  <span class="hljs-comment">// å®šä¹‰æ”¯ä»˜é¡¹ç›®</span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;PaymentItem&gt; _paymentItems = [
    <span class="hljs-keyword">const</span> PaymentItem(
      label: <span class="hljs-string">'å•†å“æ€»è®¡'</span>,
      amount: <span class="hljs-string">'99.99'</span>,
      status: PaymentItemStatus.final_price,
    ),
    <span class="hljs-keyword">const</span> PaymentItem(
      label: <span class="hljs-string">'è¿è´¹'</span>,
      amount: <span class="hljs-string">'5.99'</span>,
      status: PaymentItemStatus.final_price,
    ),
    <span class="hljs-keyword">const</span> PaymentItem(
      label: <span class="hljs-string">'æ€»è®¡'</span>,
      amount: <span class="hljs-string">'105.98'</span>,
      status: PaymentItemStatus.final_price,
    ),
  ];

  <span class="hljs-comment">// å¤„ç†æ”¯ä»˜ç»“æœ</span>
  <span class="hljs-keyword">void</span> _onGooglePayResult(<span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">dynamic</span>&gt; result) {
    debugPrint(<span class="hljs-string">'Google Pay ç»“æœ: <span class="hljs-subst">$result</span>'</span>);
    
    <span class="hljs-comment">// ä»ç»“æœä¸­æå– token</span>
    <span class="hljs-keyword">final</span> token = result[<span class="hljs-string">'paymentMethodData'</span>][<span class="hljs-string">'tokenizationData'</span>][<span class="hljs-string">'token'</span>];
    debugPrint(<span class="hljs-string">'æ”¯ä»˜ Token: <span class="hljs-subst">$token</span>'</span>);
    
    <span class="hljs-comment">// å°† token å‘é€åˆ°åç«¯å¤„ç†</span>
    _processPayment(token);
  }

  Future&lt;<span class="hljs-keyword">void</span>&gt; _processPayment(<span class="hljs-built_in">String</span> token) <span class="hljs-keyword">async</span> {
    <span class="hljs-comment">// å‘é€åˆ°åç«¯</span>
    <span class="hljs-comment">// final response = await http.post(...);</span>
  }

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Scaffold(
      body: Center(
        child: GooglePayButton(
          paymentConfiguration: PaymentConfiguration.fromAsset(
            <span class="hljs-string">'assets/google_pay_config.json'</span>,
          ),
          paymentItems: _paymentItems,
          type: GooglePayButtonType.buy,
          onPaymentResult: _onGooglePayResult,
          onError: (error) {
            debugPrint(<span class="hljs-string">'Google Pay é”™è¯¯: <span class="hljs-subst">$error</span>'</span>);
          },
          loadingIndicator: <span class="hljs-keyword">const</span> CircularProgressIndicator(),
        ),
      ),
    );
  }
}
</code></pre>
<h3 data-id="heading-28">Google Pay æŒ‰é’®æ ·å¼</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// æŒ‰é’®ç±»å‹é€‰é¡¹</span>
GooglePayButtonType.buy        <span class="hljs-comment">// "ä½¿ç”¨ Google Pay è´­ä¹°"</span>
GooglePayButtonType.book       <span class="hljs-comment">// "ä½¿ç”¨ Google Pay é¢„è®¢"</span>
GooglePayButtonType.checkout   <span class="hljs-comment">// "ä½¿ç”¨ Google Pay ç»“è´¦"</span>
GooglePayButtonType.donate     <span class="hljs-comment">// "ä½¿ç”¨ Google Pay æèµ "</span>
GooglePayButtonType.order      <span class="hljs-comment">// "ä½¿ç”¨ Google Pay ä¸‹å•"</span>
GooglePayButtonType.pay        <span class="hljs-comment">// "ä½¿ç”¨ Google Pay æ”¯ä»˜"</span>
GooglePayButtonType.plain      <span class="hljs-comment">// Google Pay å›¾æ ‡</span>
GooglePayButtonType.subscribe  <span class="hljs-comment">// "ä½¿ç”¨ Google Pay è®¢é˜…"</span>
</code></pre>
<h2 data-id="heading-29">å®Œæ•´ä»£ç ç¤ºä¾‹</h2>
<h3 data-id="heading-30">æ”¯ä»˜æœåŠ¡ç±»</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'dart:convert'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'dart:io'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter/services.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:pay/pay.dart'</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NativePayService</span> </span>{
  <span class="hljs-keyword">static</span> NativePayService? _instance;
  <span class="hljs-keyword">late</span> Pay _payClient;
  
  PaymentConfiguration? _applePayConfig;
  PaymentConfiguration? _googlePayConfig;

  NativePayService._();

  <span class="hljs-keyword">static</span> NativePayService <span class="hljs-keyword">get</span> instance {
    _instance ??= NativePayService._();
    <span class="hljs-keyword">return</span> _instance!;
  }

  <span class="hljs-comment">/// <span class="markdown">åˆå§‹åŒ–æ”¯ä»˜æœåŠ¡</span></span>
  Future&lt;<span class="hljs-keyword">void</span>&gt; initialize() <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">final</span> configurations = &lt;PayProvider, PaymentConfiguration&gt;{};

    <span class="hljs-keyword">if</span> (Platform.isIOS) {
      <span class="hljs-keyword">final</span> applePayConfigString = <span class="hljs-keyword">await</span> rootBundle.loadString(
        <span class="hljs-string">'assets/apple_pay_config.json'</span>,
      );
      _applePayConfig = PaymentConfiguration.fromJsonString(
        applePayConfigString,
      );
      configurations[PayProvider.apple_pay] = _applePayConfig!;
    }

    <span class="hljs-keyword">if</span> (Platform.isAndroid) {
      <span class="hljs-keyword">final</span> googlePayConfigString = <span class="hljs-keyword">await</span> rootBundle.loadString(
        <span class="hljs-string">'assets/google_pay_config.json'</span>,
      );
      _googlePayConfig = PaymentConfiguration.fromJsonString(
        googlePayConfigString,
      );
      configurations[PayProvider.google_pay] = _googlePayConfig!;
    }

    _payClient = Pay(configurations);
  }

  <span class="hljs-comment">/// <span class="markdown">è·å–å½“å‰å¹³å°çš„æ”¯ä»˜é…ç½®</span></span>
  PaymentConfiguration? <span class="hljs-keyword">get</span> currentConfig {
    <span class="hljs-keyword">if</span> (Platform.isIOS) <span class="hljs-keyword">return</span> _applePayConfig;
    <span class="hljs-keyword">if</span> (Platform.isAndroid) <span class="hljs-keyword">return</span> _googlePayConfig;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
  }

  <span class="hljs-comment">/// <span class="markdown">æ£€æŸ¥åŸç”Ÿæ”¯ä»˜æ˜¯å¦å¯ç”¨</span></span>
  Future&lt;<span class="hljs-built_in">bool</span>&gt; isAvailable() <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (Platform.isIOS) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> _payClient.userCanPay(PayProvider.apple_pay);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (Platform.isAndroid) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> _payClient.userCanPay(PayProvider.google_pay);
      }
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
    }
  }

  <span class="hljs-comment">/// <span class="markdown">æ˜¾ç¤ºæ”¯ä»˜è¡¨å•</span></span>
  Future&lt;<span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">dynamic</span>&gt;&gt; showPaymentSheet({
    <span class="hljs-keyword">required</span> <span class="hljs-built_in">List</span>&lt;PaymentItem&gt; paymentItems,
  }) <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">if</span> (Platform.isIOS) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> _payClient.showPaymentSelector(
        PayProvider.apple_pay,
        paymentItems,
      );
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (Platform.isAndroid) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> _payClient.showPaymentSelector(
        PayProvider.google_pay,
        paymentItems,
      );
    }
    <span class="hljs-keyword">throw</span> UnsupportedError(<span class="hljs-string">'ä¸æ”¯æŒçš„å¹³å°'</span>);
  }
}
</code></pre>
<h3 data-id="heading-31">è·¨å¹³å°æ”¯ä»˜é¡µé¢</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'dart:io'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter/material.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:pay/pay.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'../services/native_pay_service.dart'</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CheckoutScreen</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-keyword">const</span> CheckoutScreen({<span class="hljs-keyword">super</span>.key});

  <span class="hljs-meta">@override</span>
  State&lt;CheckoutScreen&gt; createState() =&gt; _CheckoutScreenState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_CheckoutScreenState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">CheckoutScreen</span>&gt; </span>{
  <span class="hljs-built_in">bool</span> _isLoading = <span class="hljs-keyword">true</span>;
  <span class="hljs-built_in">bool</span> _isPayAvailable = <span class="hljs-keyword">false</span>;
  <span class="hljs-built_in">String?</span> _errorMessage;

  <span class="hljs-comment">// è´­ç‰©è½¦å•†å“</span>
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;CartItem&gt; _cartItems = [
    CartItem(name: <span class="hljs-string">'Flutter å¼€å‘æŒ‡å—'</span>, price: <span class="hljs-number">49.99</span>),
    CartItem(name: <span class="hljs-string">'Dart ç¼–ç¨‹å®æˆ˜'</span>, price: <span class="hljs-number">39.99</span>),
  ];

  <span class="hljs-comment">// è®¡ç®—æ€»ä»·</span>
  <span class="hljs-built_in">double</span> <span class="hljs-keyword">get</span> _subtotal =&gt; _cartItems.fold(<span class="hljs-number">0</span>, (sum, item) =&gt; sum + item.price);
  <span class="hljs-built_in">double</span> <span class="hljs-keyword">get</span> _shipping =&gt; <span class="hljs-number">5.99</span>;
  <span class="hljs-built_in">double</span> <span class="hljs-keyword">get</span> _total =&gt; _subtotal + _shipping;

  <span class="hljs-comment">// æ”¯ä»˜é¡¹ç›®åˆ—è¡¨</span>
  <span class="hljs-built_in">List</span>&lt;PaymentItem&gt; <span class="hljs-keyword">get</span> _paymentItems =&gt; [
    PaymentItem(
      label: <span class="hljs-string">'å•†å“å°è®¡'</span>,
      amount: _subtotal.toStringAsFixed(<span class="hljs-number">2</span>),
      status: PaymentItemStatus.final_price,
    ),
    PaymentItem(
      label: <span class="hljs-string">'è¿è´¹'</span>,
      amount: _shipping.toStringAsFixed(<span class="hljs-number">2</span>),
      status: PaymentItemStatus.final_price,
    ),
    PaymentItem(
      label: <span class="hljs-string">'æ€»è®¡'</span>,
      amount: _total.toStringAsFixed(<span class="hljs-number">2</span>),
      status: PaymentItemStatus.final_price,
    ),
  ];

  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> initState() {
    <span class="hljs-keyword">super</span>.initState();
    _initializePayment();
  }

  Future&lt;<span class="hljs-keyword">void</span>&gt; _initializePayment() <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> NativePayService.instance.initialize();
      <span class="hljs-keyword">final</span> isAvailable = <span class="hljs-keyword">await</span> NativePayService.instance.isAvailable();
      
      setState(() {
        _isPayAvailable = isAvailable;
        _isLoading = <span class="hljs-keyword">false</span>;
      });
    } <span class="hljs-keyword">catch</span> (e) {
      setState(() {
        _errorMessage = e.toString();
        _isLoading = <span class="hljs-keyword">false</span>;
      });
    }
  }

  <span class="hljs-keyword">void</span> _onPaymentResult(<span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">dynamic</span>&gt; result) {
    debugPrint(<span class="hljs-string">'æ”¯ä»˜ç»“æœ: <span class="hljs-subst">$result</span>'</span>);
    
    <span class="hljs-comment">// æ˜¾ç¤ºæˆåŠŸæç¤º</span>
    ScaffoldMessenger.of(context).showSnackBar(
      <span class="hljs-keyword">const</span> SnackBar(
        content: Text(<span class="hljs-string">'æ”¯ä»˜æˆåŠŸï¼'</span>),
        backgroundColor: Colors.green,
      ),
    );

    <span class="hljs-comment">// å¤„ç†æ”¯ä»˜ç»“æœ</span>
    _processPaymentOnServer(result);
  }

  Future&lt;<span class="hljs-keyword">void</span>&gt; _processPaymentOnServer(<span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">dynamic</span>&gt; result) <span class="hljs-keyword">async</span> {
    <span class="hljs-comment">// æå– token å¹¶å‘é€åˆ°åç«¯</span>
    <span class="hljs-built_in">String</span> token;
    
    <span class="hljs-keyword">if</span> (Platform.isIOS) {
      <span class="hljs-comment">// Apple Pay token</span>
      token = result[<span class="hljs-string">'token'</span>] ?? <span class="hljs-string">''</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// Google Pay token</span>
      token = result[<span class="hljs-string">'paymentMethodData'</span>]?[<span class="hljs-string">'tokenizationData'</span>]?[<span class="hljs-string">'token'</span>] ?? <span class="hljs-string">''</span>;
    }

    <span class="hljs-comment">// å‘é€åˆ°åç«¯å¤„ç†</span>
    <span class="hljs-comment">// await PaymentApi.processPayment(token: token, amount: _total);</span>
  }

  <span class="hljs-keyword">void</span> _onPaymentError(<span class="hljs-built_in">Object?</span> error) {
    ScaffoldMessenger.of(context).showSnackBar(
      SnackBar(
        content: Text(<span class="hljs-string">'æ”¯ä»˜å¤±è´¥: <span class="hljs-subst">$error</span>'</span>),
        backgroundColor: Colors.red,
      ),
    );
  }

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Scaffold(
      appBar: AppBar(
        title: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'ç»“è´¦'</span>),
      ),
      body: _isLoading
          ? <span class="hljs-keyword">const</span> Center(child: CircularProgressIndicator())
          : _buildContent(),
    );
  }

  Widget _buildContent() {
    <span class="hljs-keyword">return</span> SingleChildScrollView(
      padding: <span class="hljs-keyword">const</span> EdgeInsets.all(<span class="hljs-number">16</span>),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.stretch,
        children: [
          <span class="hljs-comment">// è´­ç‰©è½¦å•†å“åˆ—è¡¨</span>
          _buildCartItems(),
          
          <span class="hljs-keyword">const</span> SizedBox(height: <span class="hljs-number">16</span>),
          
          <span class="hljs-comment">// ä»·æ ¼æ˜ç»†</span>
          _buildPriceSummary(),
          
          <span class="hljs-keyword">const</span> SizedBox(height: <span class="hljs-number">24</span>),
          
          <span class="hljs-comment">// æ”¯ä»˜æŒ‰é’®</span>
          _buildPaymentButton(),
          
          <span class="hljs-keyword">const</span> SizedBox(height: <span class="hljs-number">16</span>),
          
          <span class="hljs-comment">// æˆ–è€…ä½¿ç”¨å…¶ä»–æ”¯ä»˜æ–¹å¼</span>
          _buildAlternativePayment(),
        ],
      ),
    );
  }

  Widget _buildCartItems() {
    <span class="hljs-keyword">return</span> Card(
      child: Column(
        children: _cartItems.map((item) =&gt; ListTile(
          title: Text(item.name),
          trailing: Text(<span class="hljs-string">'\$<span class="hljs-subst">${item.price.toStringAsFixed(<span class="hljs-number">2</span>)}</span>'</span>),
        )).toList(),
      ),
    );
  }

  Widget _buildPriceSummary() {
    <span class="hljs-keyword">return</span> Card(
      child: Padding(
        padding: <span class="hljs-keyword">const</span> EdgeInsets.all(<span class="hljs-number">16</span>),
        child: Column(
          children: [
            _buildPriceRow(<span class="hljs-string">'å°è®¡'</span>, _subtotal),
            _buildPriceRow(<span class="hljs-string">'è¿è´¹'</span>, _shipping),
            <span class="hljs-keyword">const</span> Divider(),
            _buildPriceRow(<span class="hljs-string">'æ€»è®¡'</span>, _total, isBold: <span class="hljs-keyword">true</span>),
          ],
        ),
      ),
    );
  }

  Widget _buildPriceRow(<span class="hljs-built_in">String</span> label, <span class="hljs-built_in">double</span> amount, {<span class="hljs-built_in">bool</span> isBold = <span class="hljs-keyword">false</span>}) {
    <span class="hljs-keyword">return</span> Padding(
      padding: <span class="hljs-keyword">const</span> EdgeInsets.symmetric(vertical: <span class="hljs-number">4</span>),
      child: Row(
        mainAxisAlignment: MainAxisAlignment.spaceBetween,
        children: [
          Text(
            label,
            style: TextStyle(
              fontWeight: isBold ? FontWeight.bold : FontWeight.normal,
              fontSize: isBold ? <span class="hljs-number">18</span> : <span class="hljs-number">14</span>,
            ),
          ),
          Text(
            <span class="hljs-string">'\$<span class="hljs-subst">${amount.toStringAsFixed(<span class="hljs-number">2</span>)}</span>'</span>,
            style: TextStyle(
              fontWeight: isBold ? FontWeight.bold : FontWeight.normal,
              fontSize: isBold ? <span class="hljs-number">18</span> : <span class="hljs-number">14</span>,
            ),
          ),
        ],
      ),
    );
  }

  Widget _buildPaymentButton() {
    <span class="hljs-keyword">if</span> (!_isPayAvailable) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> Text(
        <span class="hljs-string">'æ­¤è®¾å¤‡ä¸æ”¯æŒ Apple Pay / Google Pay'</span>,
        textAlign: TextAlign.center,
        style: TextStyle(color: Colors.grey),
      );
    }

    <span class="hljs-keyword">final</span> config = NativePayService.instance.currentConfig;
    <span class="hljs-keyword">if</span> (config == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">const</span> SizedBox.shrink();

    <span class="hljs-keyword">if</span> (Platform.isIOS) {
      <span class="hljs-keyword">return</span> ApplePayButton(
        paymentConfiguration: config,
        paymentItems: _paymentItems,
        style: ApplePayButtonStyle.black,
        type: ApplePayButtonType.checkout,
        onPaymentResult: _onPaymentResult,
        onError: _onPaymentError,
        loadingIndicator: <span class="hljs-keyword">const</span> Center(
          child: CircularProgressIndicator(),
        ),
      );
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> GooglePayButton(
        paymentConfiguration: config,
        paymentItems: _paymentItems,
        type: GooglePayButtonType.checkout,
        onPaymentResult: _onPaymentResult,
        onError: _onPaymentError,
        loadingIndicator: <span class="hljs-keyword">const</span> Center(
          child: CircularProgressIndicator(),
        ),
      );
    }
  }

  Widget _buildAlternativePayment() {
    <span class="hljs-keyword">return</span> Column(
      children: [
        <span class="hljs-keyword">const</span> Row(
          children: [
            Expanded(child: Divider()),
            Padding(
              padding: EdgeInsets.symmetric(horizontal: <span class="hljs-number">16</span>),
              child: Text(<span class="hljs-string">'æˆ–'</span>, style: TextStyle(color: Colors.grey)),
            ),
            Expanded(child: Divider()),
          ],
        ),
        <span class="hljs-keyword">const</span> SizedBox(height: <span class="hljs-number">16</span>),
        OutlinedButton(
          onPressed: () {
            <span class="hljs-comment">// è·³è½¬åˆ°ä¿¡ç”¨å¡æ”¯ä»˜é¡µé¢</span>
          },
          child: <span class="hljs-keyword">const</span> Text(<span class="hljs-string">'ä½¿ç”¨ä¿¡ç”¨å¡æ”¯ä»˜'</span>),
        ),
      ],
    );
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CartItem</span> </span>{
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">String</span> name;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> price;

  CartItem({<span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.name, <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.price});
}
</code></pre>
<h3 data-id="heading-32">åº”ç”¨å…¥å£</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter/material.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'screens/checkout_screen.dart'</span>;

<span class="hljs-keyword">void</span> main() {
  runApp(<span class="hljs-keyword">const</span> MyApp());
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyApp</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">const</span> MyApp({<span class="hljs-keyword">super</span>.key});

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> MaterialApp(
      title: <span class="hljs-string">'Pay Plugin Demo'</span>,
      theme: ThemeData(
        colorScheme: ColorScheme.fromSeed(seedColor: Colors.blue),
        useMaterial3: <span class="hljs-keyword">true</span>,
      ),
      home: <span class="hljs-keyword">const</span> CheckoutScreen(),
    );
  }
}
</code></pre>
<h2 data-id="heading-33">ä¸æ”¯ä»˜ç½‘å…³é›†æˆ</h2>
<h3 data-id="heading-34">Stripe é›†æˆ</h3>
<h4 data-id="heading-35">åç«¯ä»£ç  (Node.js)</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>);
<span class="hljs-keyword">const</span> stripe = <span class="hljs-built_in">require</span>(<span class="hljs-string">'stripe'</span>)(<span class="hljs-string">'sk_test_your_secret_key'</span>);
<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();

app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>());

<span class="hljs-comment">// å¤„ç† Apple Pay / Google Pay token</span>
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/process-payment'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> { token, amount, currency } = req.<span class="hljs-property">body</span>;

    <span class="hljs-comment">// åˆ›å»ºæ”¯ä»˜</span>
    <span class="hljs-keyword">const</span> charge = <span class="hljs-keyword">await</span> stripe.<span class="hljs-property">charges</span>.<span class="hljs-title function_">create</span>({
      <span class="hljs-attr">amount</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(amount * <span class="hljs-number">100</span>), <span class="hljs-comment">// è½¬æ¢ä¸ºåˆ†</span>
      <span class="hljs-attr">currency</span>: currency || <span class="hljs-string">'usd'</span>,
      <span class="hljs-attr">source</span>: token,
      <span class="hljs-attr">description</span>: <span class="hljs-string">'App Purchase'</span>,
    });

    res.<span class="hljs-title function_">json</span>({
      <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">chargeId</span>: charge.<span class="hljs-property">id</span>,
    });
  } <span class="hljs-keyword">catch</span> (error) {
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>({
      <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">error</span>: error.<span class="hljs-property">message</span>,
    });
  }
});

<span class="hljs-comment">// æˆ–è€…ä½¿ç”¨ Payment Intentï¼ˆæ¨èï¼‰</span>
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/create-payment-intent'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> { amount, currency } = req.<span class="hljs-property">body</span>;

    <span class="hljs-keyword">const</span> paymentIntent = <span class="hljs-keyword">await</span> stripe.<span class="hljs-property">paymentIntents</span>.<span class="hljs-title function_">create</span>({
      <span class="hljs-attr">amount</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(amount * <span class="hljs-number">100</span>),
      <span class="hljs-attr">currency</span>: currency || <span class="hljs-string">'usd'</span>,
      <span class="hljs-attr">automatic_payment_methods</span>: {
        <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span>,
      },
    });

    res.<span class="hljs-title function_">json</span>({
      <span class="hljs-attr">clientSecret</span>: paymentIntent.<span class="hljs-property">client_secret</span>,
    });
  } <span class="hljs-keyword">catch</span> (error) {
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">error</span>: error.<span class="hljs-property">message</span> });
  }
});

app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);
</code></pre>
<h3 data-id="heading-36">å…¶ä»–æ”¯ä»˜ç½‘å…³é…ç½®</h3>
<h4 data-id="heading-37">Braintree</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"google_pay"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"environment"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"TEST"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"apiVersion"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"apiVersionMinor"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"allowedPaymentMethods"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"CARD"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"tokenizationSpecification"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"PAYMENT_GATEWAY"</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"gateway"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"braintree"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"braintree:apiVersion"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"v1"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"braintree:sdkVersion"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"3.0.0"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"braintree:merchantId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"your_merchant_id"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"braintree:clientKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"your_client_key"</span>
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"allowedCardNetworks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"VISA"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"MASTERCARD"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"allowedAuthMethods"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"PAN_ONLY"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"CRYPTOGRAM_3DS"</span><span class="hljs-punctuation">]</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-38">Adyen</h4>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"google_pay"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"environment"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"TEST"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"apiVersion"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"apiVersionMinor"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"allowedPaymentMethods"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"CARD"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"tokenizationSpecification"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"PAYMENT_GATEWAY"</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"gateway"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"adyen"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"gatewayMerchantId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"your_merchant_account"</span>
          <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"allowedCardNetworks"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"VISA"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"MASTERCARD"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"AMEX"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"allowedAuthMethods"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"PAN_ONLY"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"CRYPTOGRAM_3DS"</span><span class="hljs-punctuation">]</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-39">æµ‹è¯•ä¸è°ƒè¯•</h2>
<h3 data-id="heading-40">æµ‹è¯•ç¯å¢ƒè®¾ç½®</h3>
<ol>
<li>
<p><strong>Google Pay æµ‹è¯•æ¨¡å¼</strong></p>
<ul>
<li>é…ç½®æ–‡ä»¶ä¸­è®¾ç½® <code>"environment": "TEST"</code></li>
<li>åŠ å…¥ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdevelopers.google.com%2Fpay%2Fapi%2Fandroid%2Fguides%2Fresources%2Ftest-card-suite" target="_blank" title="https://developers.google.com/pay/api/android/guides/resources/test-card-suite" ref="nofollow noopener noreferrer">Google Pay API æµ‹è¯•å¡ç»„</a></li>
</ul>
</li>
<li>
<p><strong>Apple Pay æ²™ç›’æµ‹è¯•</strong></p>
<ul>
<li>ä½¿ç”¨ Sandbox æµ‹è¯•è´¦æˆ·</li>
<li>åœ¨è®¾ç½®ä¸­æ·»åŠ æµ‹è¯•å¡</li>
</ul>
</li>
</ol>
<h3 data-id="heading-41">è°ƒè¯•æŠ€å·§</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// è¯¦ç»†æ—¥å¿—è¾“å‡º</span>
<span class="hljs-keyword">void</span> _onPaymentResult(<span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">dynamic</span>&gt; result) {
  <span class="hljs-comment">// æ‰“å°å®Œæ•´ç»“æœ</span>
  debugPrint(<span class="hljs-string">'å®Œæ•´æ”¯ä»˜ç»“æœ:'</span>);
  debugPrint(<span class="hljs-keyword">const</span> JsonEncoder.withIndent(<span class="hljs-string">'  '</span>).convert(result));
  
  <span class="hljs-comment">// Apple Pay ç»“æœç»“æ„</span>
  <span class="hljs-keyword">if</span> (Platform.isIOS) {
    debugPrint(<span class="hljs-string">'Token: <span class="hljs-subst">${result[<span class="hljs-string">'token'</span>]}</span>'</span>);
    debugPrint(<span class="hljs-string">'Transaction ID: <span class="hljs-subst">${result[<span class="hljs-string">'transactionIdentifier'</span>]}</span>'</span>);
    debugPrint(<span class="hljs-string">'Payment Method: <span class="hljs-subst">${result[<span class="hljs-string">'paymentMethod'</span>]}</span>'</span>);
  }
  
  <span class="hljs-comment">// Google Pay ç»“æœç»“æ„</span>
  <span class="hljs-keyword">if</span> (Platform.isAndroid) {
    <span class="hljs-keyword">final</span> paymentMethodData = result[<span class="hljs-string">'paymentMethodData'</span>];
    debugPrint(<span class="hljs-string">'Type: <span class="hljs-subst">${paymentMethodData[<span class="hljs-string">'type'</span>]}</span>'</span>);
    debugPrint(<span class="hljs-string">'Token: <span class="hljs-subst">${paymentMethodData[<span class="hljs-string">'tokenizationData'</span>][<span class="hljs-string">'token'</span>]}</span>'</span>);
    debugPrint(<span class="hljs-string">'Card Network: <span class="hljs-subst">${paymentMethodData[<span class="hljs-string">'info'</span>][<span class="hljs-string">'cardNetwork'</span>]}</span>'</span>);
  }
}
</code></pre>
<h3 data-id="heading-42">å¸¸è§æµ‹è¯•åœºæ™¯</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// æµ‹è¯•ä¸åŒé‡‘é¢</span>
<span class="hljs-keyword">final</span> testAmounts = [
  PaymentItem(label: <span class="hljs-string">'å°é¢æµ‹è¯•'</span>, amount: <span class="hljs-string">'1.00'</span>, status: PaymentItemStatus.final_price),
  PaymentItem(label: <span class="hljs-string">'æ ‡å‡†æµ‹è¯•'</span>, amount: <span class="hljs-string">'99.99'</span>, status: PaymentItemStatus.final_price),
  PaymentItem(label: <span class="hljs-string">'å¤§é¢æµ‹è¯•'</span>, amount: <span class="hljs-string">'999.99'</span>, status: PaymentItemStatus.final_price),
];

<span class="hljs-comment">// æµ‹è¯•å¾…å®šä»·æ ¼ï¼ˆå¦‚è¿è´¹è®¡ç®—ä¸­ï¼‰</span>
<span class="hljs-keyword">final</span> pendingItems = [
  PaymentItem(label: <span class="hljs-string">'å•†å“'</span>, amount: <span class="hljs-string">'50.00'</span>, status: PaymentItemStatus.final_price),
  PaymentItem(label: <span class="hljs-string">'è¿è´¹'</span>, amount: <span class="hljs-string">'0.00'</span>, status: PaymentItemStatus.pending), <span class="hljs-comment">// å¾…è®¡ç®—</span>
];
</code></pre>
<h2 data-id="heading-43">å¸¸è§é—®é¢˜</h2>
<h3 data-id="heading-44">Q1: Apple Pay æŒ‰é’®ä¸æ˜¾ç¤ºï¼Ÿ</h3>
<p><strong>å¯èƒ½åŸå› ä¸è§£å†³æ–¹æ¡ˆ</strong>:</p>
<ol>
<li>
<p><strong>è®¾å¤‡æœªæ·»åŠ æ”¯ä»˜å¡</strong></p>
<ul>
<li>åœ¨è®¾ç½® â†’ é’±åŒ…ä¸ Apple Pay ä¸­æ·»åŠ å¡ç‰‡</li>
</ul>
</li>
<li>
<p><strong>Merchant ID é…ç½®é”™è¯¯</strong></p>
<ul>
<li>æ£€æŸ¥ Xcode ä¸­çš„ Merchant ID æ˜¯å¦ä¸é…ç½®æ–‡ä»¶ä¸€è‡´</li>
<li>ç¡®è®¤ Apple Developer ä¸­å·²æ­£ç¡®é…ç½®</li>
</ul>
</li>
<li>
<p><strong>æ¨¡æ‹Ÿå™¨é™åˆ¶</strong></p>
<ul>
<li>Apple Pay åœ¨æ¨¡æ‹Ÿå™¨ä¸Šæ”¯æŒæœ‰é™ï¼Œå»ºè®®ä½¿ç”¨çœŸæœºæµ‹è¯•</li>
</ul>
</li>
</ol>
<h3 data-id="heading-45">Q2: Google Pay è¿”å› "Request Failed"ï¼Ÿ</h3>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>:</p>
<ol>
<li>æ£€æŸ¥ <code>AndroidManifest.xml</code> ä¸­çš„ meta-data é…ç½®</li>
<li>ç¡®è®¤ Google Play Services å·²æ›´æ–°</li>
<li>æ£€æŸ¥é…ç½®æ–‡ä»¶ä¸­çš„ gateway å‚æ•°æ˜¯å¦æ­£ç¡®</li>
<li>ç¡®ä¿è®¾å¤‡å·²å®‰è£… Google Pay åº”ç”¨</li>
</ol>
<h3 data-id="heading-46">Q3: å¦‚ä½•å¤„ç†ç”¨æˆ·å–æ¶ˆæ”¯ä»˜ï¼Ÿ</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">void</span> _onPaymentError(<span class="hljs-built_in">Object?</span> error) {
  <span class="hljs-keyword">if</span> (error <span class="hljs-keyword">is</span> PlatformException) {
    <span class="hljs-keyword">if</span> (error.code == <span class="hljs-string">'cancelled'</span>) {
      <span class="hljs-comment">// ç”¨æˆ·å–æ¶ˆäº†æ”¯ä»˜</span>
      debugPrint(<span class="hljs-string">'ç”¨æˆ·å–æ¶ˆæ”¯ä»˜'</span>);
      <span class="hljs-keyword">return</span>;
    }
  }
  <span class="hljs-comment">// å…¶ä»–é”™è¯¯</span>
  debugPrint(<span class="hljs-string">'æ”¯ä»˜é”™è¯¯: <span class="hljs-subst">$error</span>'</span>);
}
</code></pre>
<h3 data-id="heading-47">Q4: å¦‚ä½•è‡ªå®šä¹‰æ”¯ä»˜æŒ‰é’®ï¼Ÿ</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// ä½¿ç”¨ Pay å®¢æˆ·ç«¯æ‰‹åŠ¨è§¦å‘æ”¯ä»˜</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomPayButton</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatelessWidget</span> </span>{
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">List</span>&lt;PaymentItem&gt; paymentItems;
  <span class="hljs-keyword">final</span> <span class="hljs-built_in">Function</span>(<span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">dynamic</span>&gt;) onResult;

  <span class="hljs-keyword">const</span> CustomPayButton({
    <span class="hljs-keyword">super</span>.key,
    <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.paymentItems,
    <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.onResult,
  });

  Future&lt;<span class="hljs-keyword">void</span>&gt; _handlePayment() <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">final</span> result = <span class="hljs-keyword">await</span> NativePayService.instance.showPaymentSheet(
        paymentItems: paymentItems,
      );
      onResult(result);
    } <span class="hljs-keyword">catch</span> (e) {
      debugPrint(<span class="hljs-string">'æ”¯ä»˜é”™è¯¯: <span class="hljs-subst">$e</span>'</span>);
    }
  }

  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> ElevatedButton(
      onPressed: _handlePayment,
      style: ElevatedButton.styleFrom(
        backgroundColor: Colors.black,
        foregroundColor: Colors.white,
        padding: <span class="hljs-keyword">const</span> EdgeInsets.symmetric(vertical: <span class="hljs-number">16</span>, horizontal: <span class="hljs-number">32</span>),
      ),
      child: Row(
        mainAxisSize: MainAxisSize.min,
        children: [
          Icon(Platform.isIOS ? Icons.apple : Icons.g_mobiledata),
          <span class="hljs-keyword">const</span> SizedBox(width: <span class="hljs-number">8</span>),
          Text(Platform.isIOS ? <span class="hljs-string">'Apple Pay'</span> : <span class="hljs-string">'Google Pay'</span>),
        ],
      ),
    );
  }
}
</code></pre>
<h3 data-id="heading-48">Q5: å¦‚ä½•æ”¯æŒå¤šç§è´§å¸ï¼Ÿ</h3>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// åŠ¨æ€é…ç½®è´§å¸</span>
PaymentItem createPaymentItem({
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">String</span> label,
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">double</span> amount,
  <span class="hljs-keyword">required</span> <span class="hljs-built_in">String</span> currencyCode,
}) {
  <span class="hljs-comment">// æ ¹æ®è´§å¸æ ¼å¼åŒ–é‡‘é¢</span>
  <span class="hljs-built_in">String</span> formattedAmount;
  <span class="hljs-keyword">switch</span> (currencyCode) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'JPY'</span>: <span class="hljs-comment">// æ—¥å…ƒæ— å°æ•°</span>
      formattedAmount = amount.toInt().toString();
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">default</span>:
      formattedAmount = amount.toStringAsFixed(<span class="hljs-number">2</span>);
  }

  <span class="hljs-keyword">return</span> PaymentItem(
    label: label,
    amount: formattedAmount,
    status: PaymentItemStatus.final_price,
  );
}
</code></pre>
<h2 data-id="heading-49">ç”Ÿäº§ç¯å¢ƒæ£€æŸ¥æ¸…å•</h2>
<h3 data-id="heading-50">é€šç”¨æ£€æŸ¥</h3>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ›¿æ¢æµ‹è¯•é…ç½®ä¸ºç”Ÿäº§é…ç½®</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> é…ç½®ç”Ÿäº§ç¯å¢ƒçš„æ”¯ä»˜ç½‘å…³å¯†é’¥</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å®ç°æ”¯ä»˜ç»“æœçš„æœåŠ¡ç«¯éªŒè¯</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ·»åŠ æ”¯ä»˜å¤±è´¥é‡è¯•æœºåˆ¶</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> é…ç½®é”™è¯¯ç›‘æ§å’Œæ—¥å¿—</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å®ç°è®¢å•çŠ¶æ€åŒæ­¥</li>
</ul>
<h3 data-id="heading-51">Apple Pay æ£€æŸ¥</h3>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> åœ¨ Apple Developer ä¸­å®Œæˆå•†æˆ·è®¤è¯</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> ä¸Šä¼ æ”¯ä»˜å¤„ç†è¯ä¹¦åˆ°æ”¯ä»˜ç½‘å…³</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æµ‹è¯•æ‰€æœ‰æ”¯æŒçš„å¡ç½‘ç»œ</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> éªŒè¯ Merchant ID é…ç½®</li>
</ul>
<h3 data-id="heading-52">Google Pay æ£€æŸ¥</h3>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> ç”³è¯· Google Pay ç”Ÿäº§ç¯å¢ƒè®¿é—®æƒé™</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> è®¾ç½® <code>"environment": "PRODUCTION"</code></li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> é…ç½®æ­£ç¡®çš„ <code>merchantId</code></li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å®Œæˆ Google Pay API é›†æˆæ£€æŸ¥æ¸…å•</li>
</ul>
<h2 data-id="heading-53">å‚è€ƒèµ„æº</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fpub.dev%2Fpackages%2Fpay" target="_blank" title="https://pub.dev/packages/pay" ref="nofollow noopener noreferrer">pay æ’ä»¶å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdevelopers.google.com%2Fpay%2Fapi" target="_blank" title="https://developers.google.com/pay/api" ref="nofollow noopener noreferrer">Google Pay API æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fapple-pay%2F" target="_blank" title="https://developer.apple.com/apple-pay/" ref="nofollow noopener noreferrer">Apple Pay å¼€å‘æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdevelopers.google.com%2Fpay%2Fapi%2Fweb%2Fguides%2Fbrand-guidelines" target="_blank" title="https://developers.google.com/pay/api/web/guides/brand-guidelines" ref="nofollow noopener noreferrer">Google Pay å“ç‰ŒæŒ‡å—</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fdesign%2Fhuman-interface-guidelines%2Fapple-pay" target="_blank" title="https://developer.apple.com/design/human-interface-guidelines/apple-pay" ref="nofollow noopener noreferrer">Apple Pay äººæœºç•Œé¢æŒ‡å—</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3 ç¯å¢ƒæ­å»º 5 æ­¥èµ°ï¼ˆé›¶åŸºç¡€å‹å¥½ï¼‰]]></title>    <link>https://juejin.cn/post/7585206549305606207</link>    <guid>https://juejin.cn/post/7585206549305606207</guid>    <pubDate>2025-12-19T08:12:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585206549305606207" data-draft-id="7585173051647000612" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3 ç¯å¢ƒæ­å»º 5 æ­¥èµ°ï¼ˆé›¶åŸºç¡€å‹å¥½ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-19T08:12:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¾®ç¬‘çš„æ›™å…‰"/> <meta itemprop="url" content="https://juejin.cn/user/3458394913521387"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3 ç¯å¢ƒæ­å»º 5 æ­¥èµ°ï¼ˆé›¶åŸºç¡€å‹å¥½ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3458394913521387/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¾®ç¬‘çš„æ›™å…‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T08:12:49.000Z" title="Fri Dec 19 2025 08:12:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>Vue.jsæ¸è¿›å¼å‰ç«¯æ¡†æ¶ï¼Œèšç„¦è§†å›¾å±‚ï¼Œä»¥æ•°æ®é©±åŠ¨ã€ç»„ä»¶åŒ–ä¸ºæ ¸å¿ƒã€‚å…¶å“åº”å¼æ•°æ®ç³»ç»Ÿå®ç°æ•°æ®ä¸è§†å›¾åŒå‘ç»‘å®šï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œDOMï¼›ç»„ä»¶åŒ–è®¾è®¡é™ä½å¤§å‹é¡¹ç›®å¼€å‘å¤æ‚åº¦ã€‚æ¡†æ¶è½»é‡çµæ´»ï¼Œå¯æŒ‰éœ€é›†æˆVue Routerã€Pinia/Vuexã€Viteç­‰ç”Ÿæ€å·¥å…·ã€‚Vue 2ç¨³å®šã€ç”Ÿæ€æˆç†Ÿï¼ŒVue3é€‚é…TypeScriptä¸”æ€§èƒ½ä¼˜åŒ–ã€‚å®ƒå­¦ä¹ æˆæœ¬ä½ï¼Œä¸­æ–‡æ–‡æ¡£å®Œå–„ï¼Œå¹¿æ³›åº”ç”¨äºå•é¡µåº”ç”¨ã€åå°ç®¡ç†ç³»ç»Ÿã€ç§»åŠ¨ç«¯H5ã€å°ç¨‹åºç­‰åœºæ™¯ï¼Œæ˜¯ä¼ä¸šçº§å‰ç«¯å¼€å‘çš„ä¸»æµé€‰æ‹©ã€‚</p>
</blockquote>
<p>Vue3 å®˜æ–¹æ¨èä½¿ç”¨ <strong>Vite</strong> ä½œä¸ºæ„å»ºå·¥å…·ï¼ˆæ¯”ä¼ ç»Ÿ Vue CLI æ›´å¿«ã€æ›´è½»é‡åŒ–ï¼‰ï¼Œä»¥ä¸‹æ˜¯åŸºäº Vite çš„ 5 æ­¥æç®€æ­å»ºæµç¨‹ï¼Œå…¼é¡¾æ˜“æ“ä½œå’Œå®ç”¨æ€§ï¼š</p>
<h2 data-id="heading-0">å¦‚å›¾ï¼š</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a1fe00df4bed4db2940e12a812b34058~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5b6u56yR55qE5puZ5YWJ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766736769&amp;x-signature=n7GGF4zpswxBSQG6pv%2FvIfQu%2Fzk%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-1">ä¸€ã€ å®‰è£… Node.jsï¼ˆæ ¸å¿ƒä¾èµ–ï¼‰</h3>
<p>Vue3 é¡¹ç›®ä¾èµ– Node.js ç¯å¢ƒï¼ˆæä¾› npm/yarn åŒ…ç®¡ç†å·¥å…·ï¼‰ï¼Œè¦æ±‚ Node.js ç‰ˆæœ¬ â‰¥ 18.0ï¼ˆæ¨è LTS ç‰ˆæœ¬ï¼Œå¦‚ 20.xï¼‰ã€‚</p>
<ul>
<li>ä¸‹è½½ï¼šè®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2F" target="_blank" title="https://nodejs.org/" ref="nofollow noopener noreferrer">Node.js å®˜ç½‘</a>ï¼Œé€‰æ‹©å¯¹åº”ç³»ç»Ÿï¼ˆWindows/Mac/Linuxï¼‰çš„å®‰è£…åŒ…ï¼Œä¸€é”®å®‰è£…ï¼ˆWindows å»ºè®®å‹¾é€‰ã€ŒAdd to PATHã€ï¼‰ã€‚</li>
<li>éªŒè¯ï¼šæ‰“å¼€ç»ˆç«¯/CMDï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œèƒ½æ˜¾ç¤ºç‰ˆæœ¬å·å³æˆåŠŸï¼š
<pre><code class="hljs language-bash" lang="bash">node -v   <span class="hljs-comment"># å¦‚ v20.10.0</span>
npm -v    <span class="hljs-comment"># å¦‚ v10.2.3</span>
</code></pre>
</li>
<li>å¯é€‰ä¼˜åŒ–ï¼ˆåŠ å¿« npm ä¸‹è½½é€Ÿåº¦ï¼‰ï¼šé…ç½®æ·˜å®é•œåƒæº
<pre><code class="hljs language-bash" lang="bash">npm config <span class="hljs-built_in">set</span> registry https://registry.npmmirror.com
</code></pre>
</li>
</ul>
<h3 data-id="heading-2">äºŒã€å®‰è£… Vite é¡¹ç›®åˆ›å»ºå™¨ï¼ˆå…¨å±€ï¼‰</h3>
<p>Vite æ˜¯ Vue3 å®˜æ–¹æ¨èçš„æ„å»ºå·¥å…·ï¼Œå…ˆå…¨å±€å®‰è£…ã€ŒVite é¡¹ç›®è„šæ‰‹æ¶ã€ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm install -g create-vite
</code></pre>
<ul>
<li>è‹¥æç¤ºæƒé™ä¸è¶³ï¼ˆMac/Linuxï¼‰ï¼šåŠ  <code>sudo</code> å‰ç¼€
<pre><code class="hljs language-bash" lang="bash">sudo npm install -g create-vite
</code></pre>
</li>
<li>å¤‡é€‰ï¼šè‹¥ä¹ æƒ¯ Vue CLIï¼Œå¯å®‰è£… <code>npm install -g @vue/cli@latest</code>ï¼ˆVue CLI 5+ æ”¯æŒ Vue3ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-3">ä¸‰ã€åˆ›å»º Vue3 é¡¹ç›®</h3>
<p>åœ¨ç»ˆç«¯è¿›å…¥ä½ æƒ³å­˜æ”¾é¡¹ç›®çš„ç›®å½•ï¼ˆå¦‚ <code>cd ~/Desktop</code>ï¼‰ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºé¡¹ç›®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># create-vite é¡¹ç›®å --template vueï¼ˆæŒ‡å®š Vue3 æ¨¡æ¿ï¼‰</span>
create-vite my-vue3-app --template vue
</code></pre>
<ul>
<li><code>my-vue3-app</code> æ˜¯è‡ªå®šä¹‰é¡¹ç›®åï¼ˆå¯æ”¹ï¼Œå¦‚ <code>vue3-demo</code>ï¼‰ï¼›</li>
<li>æ‰§è¡Œåï¼Œç»ˆç«¯ä¼šæç¤ºã€Œè¿›å…¥é¡¹ç›®ç›®å½• + å®‰è£…ä¾èµ–ã€ï¼Œå…ˆæŒ‰æç¤ºè¿›å…¥é¡¹ç›®ï¼š
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> my-vue3-app  <span class="hljs-comment"># è¿›å…¥é¡¹ç›®æ ¹ç›®å½•</span>
</code></pre>
</li>
<li>å®‰è£…é¡¹ç›®ä¾èµ–ï¼ˆæ ¸å¿ƒæ­¥éª¤ï¼Œç¼ºä¸€ä¸å¯ï¼‰ï¼š
<pre><code class="hljs language-bash" lang="bash">npm install
</code></pre>
</li>
</ul>
<h3 data-id="heading-4">å››ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨</h3>
<p>ä¾èµ–å®‰è£…å®Œæˆåï¼Œå¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm run dev
</code></pre>
<ul>
<li>æ‰§è¡ŒæˆåŠŸåï¼Œç»ˆç«¯ä¼šè¾“å‡ºè®¿é—®åœ°å€ï¼ˆå¦‚ <code>http://127.0.0.1:5173/</code>ï¼‰ï¼›</li>
<li>å¤åˆ¶åœ°å€åˆ°æµè§ˆå™¨æ‰“å¼€ï¼Œèƒ½çœ‹åˆ° Vue3 é»˜è®¤æ¬¢è¿é¡µé¢ï¼Œè¯´æ˜é¡¹ç›®å¯åŠ¨æˆåŠŸï¼</li>
</ul>
<h3 data-id="heading-5">äº”ã€éªŒè¯è¿è¡Œ + åŸºç¡€é…ç½®</h3>
<h4 data-id="heading-6">1. éªŒè¯åŠŸèƒ½</h4>
<ul>
<li>æµè§ˆå™¨æ‰“å¼€ <code>http://127.0.0.1:5173/</code>ï¼Œèƒ½çœ‹åˆ° Vue3 æ ‡å¿—å’Œã€ŒHello Vue 3 + Viteã€æ–‡å­—ï¼Œå³æ­å»ºå®Œæˆï¼›</li>
<li>æµ‹è¯•çƒ­æ›´æ–°ï¼šæ‰“å¼€é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œç¼–è¾‘ <code>src/App.vue</code>ï¼ˆå¦‚ä¿®æ”¹ <code>&lt;h1&gt;</code> é‡Œçš„æ–‡å­—ï¼‰ï¼Œä¿å­˜åæµè§ˆå™¨ä¼šè‡ªåŠ¨åˆ·æ–°ï¼ŒéªŒè¯çƒ­é‡è½½åŠŸèƒ½ã€‚</li>
</ul>
<h4 data-id="heading-7">2. åŸºç¡€é…ç½®ï¼ˆå¯é€‰ä½†å®ç”¨ï¼‰</h4>
<ul>
<li>æ‰“åŒ…é¡¹ç›®ï¼šå¼€å‘å®Œæˆåï¼Œæ‰§è¡Œ <code>npm run build</code>ï¼Œä¼šç”Ÿæˆ <code>dist</code> æ–‡ä»¶å¤¹ï¼ˆå¯éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼‰ï¼›</li>
<li>å®‰è£…è°ƒè¯•å·¥å…·ï¼šæµè§ˆå™¨å®‰è£…ã€ŒVue Devtoolsã€æ‰©å±•ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fchromewebstore.google.com%2Fdetail%2Fvuejs-devtools%2Fnhdogjmejiglipccpnnnanhbledajbpd" target="_blank" title="https://chromewebstore.google.com/detail/vuejs-devtools/nhdogjmejiglipccpnnnanhbledajbpd" ref="nofollow noopener noreferrer">Chrome åº”ç”¨å•†åº—</a>ï¼‰ï¼Œå¯è°ƒè¯• Vue3 ç»„ä»¶ã€çŠ¶æ€ï¼›</li>
<li>æ‰©å±•åŠŸèƒ½ï¼šå¦‚éœ€ç”¨ TypeScriptï¼Œåˆ›å»ºé¡¹ç›®æ—¶æ”¹æ¨¡æ¿ä¸º <code>--template vue-ts</code>ã€‚</li>
</ul>
<h3 data-id="heading-8">å…­ã€æ ¸å¿ƒæ³¨æ„äº‹é¡¹</h3>
<ol>
<li>è‹¥ç«¯å£è¢«å ç”¨ï¼ˆå¦‚ 5173ï¼‰ï¼ŒVite ä¼šè‡ªåŠ¨åˆ‡æ¢ç«¯å£ï¼ˆå¦‚ 5174ï¼‰ï¼Œä»¥ç»ˆç«¯è¾“å‡ºä¸ºå‡†ï¼›</li>
<li>Windows è‹¥ç»ˆç«¯è¯†åˆ«ä¸äº† <code>npm</code>ï¼Œé‡å¯ç»ˆç«¯/ç”µè„‘ï¼ˆç¡®ä¿ Node.js å·²åŠ å…¥ç¯å¢ƒå˜é‡ï¼‰ï¼›</li>
<li>è‹¥ä¾èµ–å®‰è£…å¤±è´¥ï¼Œå¯åˆ é™¤é¡¹ç›®ä¸‹çš„ <code>node_modules</code> æ–‡ä»¶å¤¹ï¼Œé‡æ–°æ‰§è¡Œ <code>npm install</code>ã€‚</li>
</ol>
<p>è‡³æ­¤ï¼ŒVue3 å¼€å‘ç¯å¢ƒå·²å®Œå…¨æ­å»ºï¼Œå¯ç›´æ¥åœ¨ <code>src</code> ç›®å½•ä¸‹ç¼–å†™ç»„ä»¶ã€å¼€å‘ä¸šåŠ¡é€»è¾‘ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¯¹æ¯”ç†è§£ Vue å“åº”å¼ APIï¼šdata(), refã€reactiveã€computed ä¸ watch è¯¦è§£]]></title>    <link>https://juejin.cn/post/7585180150254714895</link>    <guid>https://juejin.cn/post/7585180150254714895</guid>    <pubDate>2025-12-19T08:18:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585180150254714895" data-draft-id="7585130590292819983" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¯¹æ¯”ç†è§£ Vue å“åº”å¼ APIï¼šdata(), refã€reactiveã€computed ä¸ watch è¯¦è§£"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2025-12-19T08:18:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çˆ±åˆ†äº«çš„é±¼é±¼"/> <meta itemprop="url" content="https://juejin.cn/user/3901536646733133"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¯¹æ¯”ç†è§£ Vue å“åº”å¼ APIï¼šdata(), refã€reactiveã€computed ä¸ watch è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3901536646733133/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çˆ±åˆ†äº«çš„é±¼é±¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T08:18:29.000Z" title="Fri Dec 19 2025 08:18:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Vue å¼€å‘ä¸­ï¼Œç†è§£å“åº”å¼æ•°æ®çš„æ¦‚å¿µä»¥åŠå¦‚ä½•æ­£ç¡®ä½¿ç”¨ä¸åŒçš„å“åº”å¼ API æ˜¯éå¸¸é‡è¦çš„ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç» Vue 2 ä¸­çš„ data é€‰é¡¹ã€Vue 3 Composition API ä¸­çš„ refã€reactiveã€toRefs å’Œ toRef å‡½æ•°ä¹‹é—´çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯ï¼ŒåŒæ—¶ä¹Ÿä¼šä»‹ç» computed å’Œ watch çš„åŒºåˆ«ä¸ä½¿ç”¨åœºæ™¯ã€‚</p>
<h2 data-id="heading-0">åŸºæœ¬æ¦‚å¿µ</h2>
<p>å“åº”å¼æ•°æ®ï¼ˆReactive Dataï¼‰æŒ‡çš„æ˜¯å½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä½¿ç”¨è¯¥æ•°æ®çš„ç•Œé¢ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œè€Œæ— éœ€æ‰‹åŠ¨æ“ä½œDOMã€‚
å“åº”å¼æ•°æ®å…·æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š</p>
<ol>
<li><strong>è‡ªåŠ¨è¿½è¸ªå˜åŒ–</strong>ï¼šæ¡†æ¶ä¼šè‡ªåŠ¨ç›‘æµ‹æ•°æ®çš„å˜åŒ–</li>
<li><strong>ä¾èµ–å…³ç³»å»ºç«‹</strong>ï¼šæ¡†æ¶çŸ¥é“å“ªäº›è§†å›¾ä¾èµ–å“ªäº›æ•°æ®</li>
<li><strong>è‡ªåŠ¨æ›´æ–°è§†å›¾</strong>ï¼šå½“æ•°æ®å˜åŒ–æ—¶ï¼Œç›¸å…³è§†å›¾ä¼šè‡ªåŠ¨é‡æ–°æ¸²æŸ“</li>
</ol>
<h2 data-id="heading-1">1. Vue 2 ä¸­çš„ data é€‰é¡¹</h2>
<p>åœ¨ Vue 2 ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸åœ¨ç»„ä»¶çš„ data é€‰é¡¹ä¸­å®šä¹‰å“åº”å¼æ•°æ®ã€‚</p>
<h3 data-id="heading-2">1.1 åŸºæœ¬ç”¨æ³•</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">message</span>: <span class="hljs-string">'Hello Vue!'</span>,
      <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">user</span>: {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>,
        <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>
      }
    }
  }
}
</code></pre>
<h3 data-id="heading-3">1.2 ç‰¹ç‚¹</h3>
<ul>
<li>data å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªåŒ…å«å“åº”å¼æ•°æ®çš„å¯¹è±¡</li>
<li>Vue ä¼šé€’å½’åœ°å°† data ä¸­çš„æ‰€æœ‰å±æ€§è½¬æ¢ä¸º getter/setter</li>
<li>è®¿é—®å’Œä¿®æ”¹æ•°æ®æ—¶ä¸éœ€è¦ä½¿ç”¨ <code>.value</code></li>
<li>é€‚ç”¨äº Options API</li>
</ul>
<h2 data-id="heading-4">2. Vue 3 ä¸­çš„ ref</h2>
<p>ref æ˜¯ Vue 3 Composition API ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªå“åº”å¼çš„å¼•ç”¨ã€‚</p>
<h3 data-id="heading-5">2.1 åŸºæœ¬ç”¨æ³•</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// åŸºæœ¬ç±»å‹</span>
<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)
<span class="hljs-keyword">const</span> message = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'Hello Vue 3!'</span>)

<span class="hljs-comment">// å¯¹è±¡ç±»å‹</span>
<span class="hljs-keyword">const</span> user = <span class="hljs-title function_">ref</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>
})

<span class="hljs-comment">// è®¿é—®å€¼</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count.<span class="hljs-property">value</span>) <span class="hljs-comment">// 0</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user.<span class="hljs-property">value</span>.<span class="hljs-property">name</span>) <span class="hljs-comment">// 'Alice'</span>

<span class="hljs-comment">// ä¿®æ”¹å€¼</span>
count.<span class="hljs-property">value</span>++
user.<span class="hljs-property">value</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'Bob'</span>
</code></pre>
<h3 data-id="heading-6">2.2 ç‰¹ç‚¹</h3>
<ul>
<li>å¯ä»¥åŒ…è£…ä»»ä½•ç±»å‹çš„å€¼ï¼ˆåŸºæœ¬ç±»å‹ã€å¯¹è±¡ã€æ•°ç»„ç­‰ï¼‰</li>
<li>è¿”å›ä¸€ä¸ªå¸¦æœ‰ <code>.value</code> å±æ€§çš„å“åº”å¼å¼•ç”¨å¯¹è±¡</li>
<li>åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨æ—¶ï¼ŒVue ä¼šè‡ªåŠ¨è§£åŒ…ï¼Œæ— éœ€ä½¿ç”¨ <code>.value</code></li>
<li>é€‚ç”¨äºéœ€è¦å°†åŸºæœ¬ç±»å‹å˜ä¸ºå“åº”å¼çš„åœºæ™¯</li>
</ul>
<h2 data-id="heading-7">3. Vue 3 ä¸­çš„ reactive</h2>
<p>reactive æ˜¯ Vue 3 Composition API ä¸­çš„å¦ä¸€ä¸ªé‡è¦å‡½æ•°ï¼Œç”¨äºåˆ›å»ºå“åº”å¼å¯¹è±¡ã€‚</p>
<h3 data-id="heading-8">3.1 åŸºæœ¬ç”¨æ³•</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">message</span>: <span class="hljs-string">'Hello Vue 3!'</span>,
  <span class="hljs-attr">user</span>: {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>,
    <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>
  }
})

<span class="hljs-comment">// è®¿é—®å€¼</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(state.<span class="hljs-property">count</span>) <span class="hljs-comment">// 0</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(state.<span class="hljs-property">user</span>.<span class="hljs-property">name</span>) <span class="hljs-comment">// 'Alice'</span>

<span class="hljs-comment">// ä¿®æ”¹å€¼</span>
state.<span class="hljs-property">count</span>++
state.<span class="hljs-property">user</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'Bob'</span>
</code></pre>
<h3 data-id="heading-9">3.2 ç‰¹ç‚¹</h3>
<ul>
<li>åªèƒ½ç”¨äºå¯¹è±¡å’Œæ•°ç»„ï¼ˆä¸èƒ½ç”¨äºåŸºæœ¬ç±»å‹ï¼‰</li>
<li>è¿”å›åŸå§‹å¯¹è±¡çš„ä»£ç†ï¼ˆProxyï¼‰</li>
<li>ä¸éœ€è¦ä½¿ç”¨ <code>.value</code> è®¿é—®å±æ€§</li>
<li>å¯¹å¯¹è±¡è¿›è¡Œæ·±å±‚å“åº”å¼è½¬æ¢</li>
</ul>
<h2 data-id="heading-10">4. å››è€…ä¹‹é—´çš„è¯¦ç»†å¯¹æ¯”</h2>





























































<table><thead><tr><th>ç‰¹æ€§</th><th>data (Vue 2)</th><th>ref</th><th>reactive</th><th>toRefs</th><th>toRef</th></tr></thead><tbody><tr><td>Vue ç‰ˆæœ¬</td><td>Vue 2</td><td>Vue 3</td><td>Vue 3</td><td>Vue 3</td><td>Vue 3</td></tr><tr><td>API ç±»å‹</td><td>Options API</td><td>Composition API</td><td>Composition API</td><td>Composition API</td><td>Composition API</td></tr><tr><td>æ•°æ®ç±»å‹æ”¯æŒ</td><td>ä»»æ„ç±»å‹</td><td>ä»»æ„ç±»å‹</td><td>ä»…å¯¹è±¡/æ•°ç»„</td><td>å¯¹è±¡å±æ€§</td><td>å•ä¸ªå¯¹è±¡å±æ€§</td></tr><tr><td>è®¿é—®æ–¹å¼</td><td>ç›´æ¥è®¿é—®</td><td>.value è®¿é—®ï¼ˆæ¨¡æ¿ä¸­é™¤å¤–ï¼‰</td><td>ç›´æ¥è®¿é—®</td><td>.value è®¿é—®</td><td>.value è®¿é—®</td></tr><tr><td>è§£æ„æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒï¼ˆä½†å¤±å»å“åº”æ€§ï¼‰</td><td>æ”¯æŒï¼ˆä½†å¤±å»å“åº”æ€§ï¼‰</td><td>æ”¯æŒï¼ˆä¿æŒå“åº”æ€§ï¼‰</td><td>æ”¯æŒï¼ˆä¿æŒå“åº”æ€§ï¼‰</td></tr><tr><td>è‡ªåŠ¨è§£åŒ…</td><td>ä¸é€‚ç”¨</td><td>æ¨¡æ¿ä¸­è‡ªåŠ¨è§£åŒ…</td><td>ä¸é€‚ç”¨</td><td>ä¸é€‚ç”¨</td><td>ä¸é€‚ç”¨</td></tr></tbody></table>
<h2 data-id="heading-11">5. ä½¿ç”¨åœºæ™¯æ¨è</h2>
<h3 data-id="heading-12">5.1 ä½•æ—¶ä½¿ç”¨ data</h3>
<ul>
<li>ä½¿ç”¨ Vue 2 é¡¹ç›®æ—¶</li>
<li>ä½¿ç”¨ Options API æ—¶</li>
<li>éœ€è¦åœ¨ç»„ä»¶é€‰é¡¹ä¸­å®šä¹‰å“åº”å¼æ•°æ®æ—¶</li>
</ul>
<h3 data-id="heading-13">5.2 ä½•æ—¶ä½¿ç”¨ ref</h3>
<ul>
<li>éœ€è¦å°†åŸºæœ¬ç±»å‹ï¼ˆå­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ï¼‰å˜ä¸ºå“åº”å¼æ—¶</li>
<li>éœ€è¦é‡æ–°åˆ†é…æ•´ä¸ªå¯¹è±¡æ—¶</li>
<li>åœ¨æ¨¡æ¿ä¸­éœ€è¦ç›´æ¥ä½¿ç”¨å˜é‡åï¼ˆè€Œéå¯¹è±¡å±æ€§ï¼‰æ—¶</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é€‚åˆä½¿ç”¨ ref çš„åœºæ™¯</span>
<span class="hljs-keyword">const</span> isVisible = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">true</span>)
<span class="hljs-keyword">const</span> userName = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'Alice'</span>)

<span class="hljs-comment">// åˆ‡æ¢æ•´ä¸ªå¯¹è±¡</span>
<span class="hljs-keyword">let</span> user = <span class="hljs-title function_">ref</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>
})

user.<span class="hljs-property">value</span> = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Bob'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>
}
</code></pre>
<h3 data-id="heading-14">5.3 ä½•æ—¶ä½¿ç”¨ reactive</h3>
<ul>
<li>éœ€è¦åˆ›å»ºåŒ…å«å¤šä¸ªç›¸å…³å±æ€§çš„å“åº”å¼çŠ¶æ€å¯¹è±¡æ—¶</li>
<li>å¤„ç†å¤æ‚çš„æ•°æ®ç»“æ„æ—¶</li>
<li>ä¸éœ€è¦é‡æ–°åˆ†é…æ•´ä¸ªå¯¹è±¡ï¼Œåªéœ€è¦ä¿®æ”¹å¯¹è±¡å±æ€§æ—¶</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é€‚åˆä½¿ç”¨ reactive çš„åœºæ™¯</span>
<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">user</span>: {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>,
    <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>
  },
  <span class="hljs-attr">permissions</span>: [<span class="hljs-string">'read'</span>, <span class="hljs-string">'write'</span>],
  <span class="hljs-attr">isLoggedIn</span>: <span class="hljs-literal">true</span>
})
</code></pre>
<h3 data-id="heading-15">5.4 ä½•æ—¶ä½¿ç”¨ toRefs å’Œ toRef</h3>
<ul>
<li>éœ€è¦å°† reactive å¯¹è±¡çš„å±æ€§è§£æ„ä¸ºç‹¬ç«‹çš„å“åº”å¼å¼•ç”¨æ—¶</li>
<li>éœ€è¦å°† reactive å¯¹è±¡çš„éƒ¨åˆ†å±æ€§ä¼ é€’ç»™å…¶ä»–å‡½æ•°æ—¶</li>
<li>éœ€è¦ä¿æŒè§£æ„åå±æ€§çš„å“åº”æ€§æ—¶</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é€‚åˆä½¿ç”¨ toRefs çš„åœºæ™¯</span>
<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>,
  <span class="hljs-attr">permissions</span>: []
})

<span class="hljs-comment">// è§£æ„ä½†ä»ä¿æŒå“åº”æ€§</span>
<span class="hljs-keyword">const</span> { count, name } = <span class="hljs-title function_">toRefs</span>(state)

<span class="hljs-comment">// é€‚åˆä½¿ç”¨ toRef çš„åœºæ™¯</span>
<span class="hljs-keyword">const</span> countRef = <span class="hljs-title function_">toRef</span>(state, <span class="hljs-string">'count'</span>)
<span class="hljs-keyword">const</span> nameRef = <span class="hljs-title function_">toRef</span>(state, <span class="hljs-string">'name'</span>)
</code></pre>
<h2 data-id="heading-16">6. æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-17">6.1 ref çš„æ³¨æ„äº‹é¡¹</h3>
<ol>
<li>åœ¨ JavaScript ä¸­è®¿é—® ref çš„å€¼æ—¶å¿…é¡»ä½¿ç”¨ <code>.value</code></li>
<li>è§£æ„ ref ä¼šå¤±å»å“åº”æ€§</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)
<span class="hljs-keyword">const</span> { value } = count <span class="hljs-comment">// é”™è¯¯ï¼šå¤±å»äº†å“åº”æ€§</span>
</code></pre>
<h3 data-id="heading-18">6.2 reactive çš„æ³¨æ„äº‹é¡¹</h3>
<ol>
<li>ä¸èƒ½ç”¨äºåŸºæœ¬ç±»å‹</li>
<li>æ›¿æ¢ reactive å¯¹è±¡æœ¬èº«ä¸ä¼šä¿æŒå“åº”æ€§</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">let</span> state = <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> })

<span class="hljs-comment">// é”™è¯¯ï¼šè¿™å°†å¤±å»å“åº”æ€§</span>
state = <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">count</span>: <span class="hljs-number">1</span> })
</code></pre>
<ol start="3">
<li>è§£æ„ reactive å¯¹è±¡ä¼šå¤±å»å“åº”æ€§</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({ <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span> })
<span class="hljs-keyword">const</span> { count } = state <span class="hljs-comment">// é”™è¯¯ï¼šå¤±å»äº†å“åº”æ€§</span>
</code></pre>
<h3 data-id="heading-19">6.3 æœ€ä½³å®è·µ</h3>
<ol>
<li><strong>åŸºæœ¬ç±»å‹ç”¨ refï¼Œå¯¹è±¡ç±»å‹ä¼˜å…ˆè€ƒè™‘ reactive</strong></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨è</span>
<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)
<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">users</span>: [],
  <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>
})
</code></pre>
<ol start="2">
<li><strong>ç»„åˆä½¿ç”¨ ref å’Œ reactive</strong></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { ref, reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// å¤æ‚çŠ¶æ€ä½¿ç”¨ reactive</span>
<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">users</span>: [],
  <span class="hljs-attr">pagination</span>: {
    <span class="hljs-attr">page</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">size</span>: <span class="hljs-number">10</span>
  }
})

<span class="hljs-comment">// ç®€å•çŠ¶æ€ä½¿ç”¨ ref</span>
<span class="hljs-keyword">const</span> loading = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>)
<span class="hljs-keyword">const</span> errorMessage = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
</code></pre>
<ol start="3">
<li><strong>ä½¿ç”¨ toRefs è§£æ„ reactive å¯¹è±¡</strong></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { reactive, toRefs } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>
})

<span class="hljs-comment">// æ­£ç¡®çš„è§£æ„æ–¹å¼</span>
<span class="hljs-keyword">const</span> { count, name } = <span class="hljs-title function_">toRefs</span>(state)
</code></pre>
<ol start="4">
<li><strong>ä½¿ç”¨ toRef åˆ›å»ºå•ä¸ªå“åº”å¼å¼•ç”¨</strong></li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { reactive, toRef } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>
})

<span class="hljs-comment">// åˆ›å»ºå•ä¸ªå“åº”å¼å¼•ç”¨</span>
<span class="hljs-keyword">const</span> countRef = <span class="hljs-title function_">toRef</span>(state, <span class="hljs-string">'count'</span>)
<span class="hljs-keyword">const</span> nameRef = <span class="hljs-title function_">toRef</span>(state, <span class="hljs-string">'name'</span>)

<span class="hljs-comment">// ä¿®æ”¹åŸå§‹å±æ€§ä¼šå½±å“ toRef åˆ›å»ºçš„å¼•ç”¨</span>
state.<span class="hljs-property">count</span>++
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(countRef.<span class="hljs-property">value</span>) <span class="hljs-comment">// 1</span>

<span class="hljs-comment">// ä¿®æ”¹ toRef åˆ›å»ºçš„å¼•ç”¨ä¹Ÿä¼šå½±å“åŸå§‹å±æ€§</span>
countRef.<span class="hljs-property">value</span>++
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(state.<span class="hljs-property">count</span>) <span class="hljs-comment">// 2</span>
</code></pre>
<h2 data-id="heading-20">7. å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨ç¤ºä¾‹</h2>
<p>ä»¥ä¸‹æ˜¯åœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨è¿™äº› API çš„ç¤ºä¾‹ï¼š</p>
<h3 data-id="heading-21">7.1 ä½¿ç”¨ ref å¤„ç†è¡¨å•çŠ¶æ€</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { ref } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> formData = <span class="hljs-title function_">ref</span>({
      <span class="hljs-attr">username</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">email</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">password</span>: <span class="hljs-string">''</span>
    })
    
    <span class="hljs-keyword">const</span> isSubmitting = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>)
    <span class="hljs-keyword">const</span> errorMessage = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSubmit</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
      isSubmitting.<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// æäº¤è¡¨å•é€»è¾‘</span>
      } <span class="hljs-keyword">catch</span> (error) {
        errorMessage.<span class="hljs-property">value</span> = error.<span class="hljs-property">message</span>
      } <span class="hljs-keyword">finally</span> {
        isSubmitting.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>
      }
    }
    
    <span class="hljs-keyword">return</span> {
      formData,
      isSubmitting,
      errorMessage,
      handleSubmit
    }
  }
}
</code></pre>
<h3 data-id="heading-22">7.2 ä½¿ç”¨ reactive ç®¡ç†å¤æ‚çŠ¶æ€</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { reactive, computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
      <span class="hljs-attr">users</span>: [],
      <span class="hljs-attr">filters</span>: {
        <span class="hljs-attr">name</span>: <span class="hljs-string">''</span>,
        <span class="hljs-attr">status</span>: <span class="hljs-string">'active'</span>
      },
      <span class="hljs-attr">pagination</span>: {
        <span class="hljs-attr">page</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">size</span>: <span class="hljs-number">10</span>,
        <span class="hljs-attr">total</span>: <span class="hljs-number">0</span>
      },
      <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>
    })
    
    <span class="hljs-comment">// è®¡ç®—å±æ€§</span>
    <span class="hljs-keyword">const</span> activeUsers = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">return</span> state.<span class="hljs-property">users</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">user</span> =&gt;</span> user.<span class="hljs-property">status</span> === <span class="hljs-string">'active'</span>)
    })
    
    <span class="hljs-keyword">return</span> {
      state,
      activeUsers
    }
  }
}
</code></pre>
<h2 data-id="heading-23">8. computed ä¸ watch çš„åŒºåˆ«</h2>
<p>åœ¨ Vue å¼€å‘ä¸­ï¼Œé™¤äº†å“åº”å¼æ•°æ®å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¤„ç†æ´¾ç”ŸçŠ¶æ€å’Œå‰¯ä½œç”¨ã€‚è¿™å°±éœ€è¦ç”¨åˆ° computed å’Œ watchã€‚</p>
<h3 data-id="heading-24">8.1 computedï¼ˆè®¡ç®—å±æ€§ï¼‰</h3>
<p>computed ç”¨äºå£°æ˜å¼åœ°æè¿°ä¾èµ–å“åº”å¼æ•°æ®çš„å¤æ‚é€»è¾‘ï¼Œåˆ›å»ºä¸€ä¸ªå“åº”å¼çš„åªè¯»å€¼ã€‚</p>
<h4 data-id="heading-25">åŸºæœ¬ç”¨æ³•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { ref, computed } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)

<span class="hljs-comment">// åªè¯»è®¡ç®—å±æ€§</span>
<span class="hljs-keyword">const</span> doubled = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> count.<span class="hljs-property">value</span> * <span class="hljs-number">2</span>)

<span class="hljs-comment">// å¯å†™çš„è®¡ç®—å±æ€§</span>
<span class="hljs-keyword">const</span> writableComputed = <span class="hljs-title function_">computed</span>({
  <span class="hljs-attr">get</span>: <span class="hljs-function">() =&gt;</span> count.<span class="hljs-property">value</span> * <span class="hljs-number">2</span>,
  <span class="hljs-attr">set</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =&gt;</span> {
    count.<span class="hljs-property">value</span> = val / <span class="hljs-number">2</span>
  }
})

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(doubled.<span class="hljs-property">value</span>) <span class="hljs-comment">// 0</span>

count.<span class="hljs-property">value</span>++
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(doubled.<span class="hljs-property">value</span>) <span class="hljs-comment">// 2</span>
</code></pre>
<h4 data-id="heading-26">ç‰¹ç‚¹</h4>
<ul>
<li>åŸºäºå“åº”å¼ä¾èµ–è¿›è¡Œç¼“å­˜ï¼Œåªæœ‰ä¾èµ–å‘ç”Ÿæ”¹å˜æ—¶æ‰ä¼šé‡æ–°è®¡ç®—</li>
<li>é»˜è®¤æ˜¯åªè¯»çš„ï¼Œä½†ä¹Ÿå¯ä»¥åˆ›å»ºå¯å†™çš„è®¡ç®—å±æ€§</li>
<li>é€‚ç”¨äºå¤æ‚çš„é€»è¾‘è®¡ç®—ï¼Œé¿å…åœ¨æ¨¡æ¿ä¸­æ”¾å…¥å¤ªå¤šé€»è¾‘</li>
<li>åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨æ—¶ä¼šè¢«è‡ªåŠ¨è§£åŒ…ï¼Œæ— éœ€ä½¿ç”¨ <code>.value</code></li>
</ul>
<h3 data-id="heading-27">8.2 watchï¼ˆä¾¦å¬å™¨ï¼‰</h3>
<p>watch ç”¨äºç›‘å¬å“åº”å¼æ•°æ®çš„å˜åŒ–å¹¶åœ¨å˜åŒ–æ—¶æ‰§è¡Œå‰¯ä½œç”¨ã€‚</p>
<h4 data-id="heading-28">åŸºæœ¬ç”¨æ³•</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { ref, watch } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)
<span class="hljs-keyword">const</span> user = <span class="hljs-title function_">ref</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>
})

<span class="hljs-comment">// ä¾¦å¬å•ä¸ª ref</span>
<span class="hljs-title function_">watch</span>(count, <span class="hljs-function">(<span class="hljs-params">newVal, oldVal</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`count changed from <span class="hljs-subst">${oldVal}</span> to <span class="hljs-subst">${newVal}</span>`</span>)
})

<span class="hljs-comment">// ä¾¦å¬ getter å‡½æ•°</span>
<span class="hljs-title function_">watch</span>(
  <span class="hljs-function">() =&gt;</span> user.<span class="hljs-property">value</span>.<span class="hljs-property">name</span>,
  <span class="hljs-function">(<span class="hljs-params">newName, oldName</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`name changed from <span class="hljs-subst">${oldName}</span> to <span class="hljs-subst">${newName}</span>`</span>)
  }
)

<span class="hljs-comment">// ä¾¦å¬å¤šä¸ªæ•°æ®æº</span>
<span class="hljs-title function_">watch</span>(
  [count, <span class="hljs-function">() =&gt;</span> user.<span class="hljs-property">value</span>.<span class="hljs-property">name</span>],
  <span class="hljs-function">(<span class="hljs-params">[newCount, newName], [oldCount, oldName]</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`count: <span class="hljs-subst">${oldCount}</span> -&gt; <span class="hljs-subst">${newCount}</span>`</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`name: <span class="hljs-subst">${oldName}</span> -&gt; <span class="hljs-subst">${newName}</span>`</span>)
  }
)

<span class="hljs-comment">// æ·±åº¦ä¾¦å¬</span>
<span class="hljs-title function_">watch</span>(
  user,
  <span class="hljs-function">(<span class="hljs-params">newUser, oldUser</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'user changed'</span>, newUser, oldUser)
  },
  { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> }
)
</code></pre>
<h4 data-id="heading-29">ç‰¹ç‚¹</h4>
<ul>
<li>ç”¨äºæ‰§è¡Œå‰¯ä½œç”¨ï¼Œå¦‚ API è¯·æ±‚ã€æ‰‹åŠ¨ DOM æ“ä½œç­‰</li>
<li>ä¸ä¼šç¼“å­˜ï¼Œåªè¦ä¾èµ–å‘ç”Ÿå˜åŒ–å°±ä¼šæ‰§è¡Œ</li>
<li>å¯ä»¥ç›‘å¬å•ä¸ªæˆ–å¤šä¸ªæ•°æ®æº</li>
<li>æ”¯æŒæ·±åº¦ç›‘å¬ã€ç«‹å³æ‰§è¡Œç­‰é€‰é¡¹</li>
</ul>
<h3 data-id="heading-30">8.3 computed ä¸ watch çš„åŒºåˆ«å¯¹æ¯”</h3>



































<table><thead><tr><th>ç‰¹æ€§</th><th>computed</th><th>watch</th></tr></thead><tbody><tr><td>ä¸»è¦ç”¨é€”</td><td>åˆ›å»ºå“åº”å¼åªè¯»å€¼</td><td>æ‰§è¡Œå‰¯ä½œç”¨</td></tr><tr><td>ç¼“å­˜æœºåˆ¶</td><td>æœ‰ç¼“å­˜ï¼Œä¾èµ–ä¸å˜æ—¶ä¸é‡æ–°è®¡ç®—</td><td>æ— ç¼“å­˜ï¼Œæ¯æ¬¡å˜åŒ–éƒ½æ‰§è¡Œ</td></tr><tr><td>è¿”å›å€¼</td><td>è¿”å›ä¸€ä¸ªä¸å¯å˜çš„å“åº”å¼å¯¹è±¡</td><td>æ— è¿”å›å€¼ï¼ˆæ‰§è¡Œå‰¯ä½œç”¨ï¼‰</td></tr><tr><td>ä½¿ç”¨åœºæ™¯</td><td>å¤æ‚é€»è¾‘è®¡ç®—ã€æ•°æ®æ ¼å¼åŒ–</td><td>API è¯·æ±‚ã€å¼‚æ­¥æ“ä½œã€DOM æ“ä½œ</td></tr><tr><td>æ‰§è¡Œæ—¶æœº</td><td>æ¨¡æ¿æ¸²æŸ“æ—¶æŒ‰éœ€è®¡ç®—</td><td>æ•°æ®å˜åŒ–æ—¶ç«‹å³æ‰§è¡Œ</td></tr></tbody></table>
<h2 data-id="heading-31">10. æ€»ç»“</h2>
<p>é€‰æ‹©ä½¿ç”¨å“ªç§å“åº”å¼ API ä¸»è¦å–å†³äºä»¥ä¸‹å› ç´ ï¼š</p>
<ol>
<li><strong>Vue ç‰ˆæœ¬</strong>ï¼šVue 2 ä½¿ç”¨ dataï¼ŒVue 3 å¯ä»¥ä½¿ç”¨ refã€reactiveã€toRefs å’Œ toRef</li>
<li><strong>æ•°æ®ç±»å‹</strong>ï¼šåŸºæœ¬ç±»å‹æ¨èä½¿ç”¨ refï¼Œå¯¹è±¡ç±»å‹å¯ä»¥ä½¿ç”¨ reactive</li>
<li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šéœ€è¦é¢‘ç¹æ›¿æ¢æ•´ä¸ªå€¼æ—¶ä½¿ç”¨ refï¼Œå¤„ç†å¤æ‚åµŒå¥—å¯¹è±¡æ—¶ä½¿ç”¨ reactive</li>
<li><strong>API é£æ ¼</strong>ï¼šOptions API ä½¿ç”¨ dataï¼ŒComposition API ä½¿ç”¨ refã€reactiveã€toRefs å’Œ toRef</li>
<li><strong>æ´¾ç”ŸçŠ¶æ€å¤„ç†</strong>ï¼šéœ€è¦ç¼“å­˜çš„æ´¾ç”Ÿå€¼ç”¨ computedï¼Œéœ€è¦æ‰§è¡Œå‰¯ä½œç”¨ç”¨ watch</li>
<li><strong>è§£æ„éœ€æ±‚</strong>ï¼šéœ€è¦è§£æ„ reactive å¯¹è±¡å±æ€§å¹¶ä¿æŒå“åº”æ€§æ—¶ä½¿ç”¨ toRefs æˆ– toRef</li>
</ol>
<p>ç†è§£è¿™äº›å·®å¼‚æœ‰åŠ©äºæˆ‘ä»¬åœ¨å®é™…å¼€å‘ä¸­åšå‡ºæ›´å¥½çš„é€‰æ‹©ï¼Œå†™å‡ºæ›´é«˜æ•ˆã€æ›´æ˜“ç»´æŠ¤çš„ Vue ä»£ç ã€‚</p>
<pre><code class="hljs"/></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä» Arco Table è¿ç§»åˆ° VTableï¼šVTableä½¿ç”¨ç»éªŒåˆ†äº«]]></title>    <link>https://juejin.cn/post/7585289701826822153</link>    <guid>https://juejin.cn/post/7585289701826822153</guid>    <pubDate>2025-12-19T08:19:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585289701826822153" data-draft-id="7585180775705296923" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä» Arco Table è¿ç§»åˆ° VTableï¼šVTableä½¿ç”¨ç»éªŒåˆ†äº«"/> <meta itemprop="keywords" content="å‰ç«¯,å¼€æº,React.js"/> <meta itemprop="datePublished" content="2025-12-19T08:19:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç å°å­¦åƒ§"/> <meta itemprop="url" content="https://juejin.cn/user/255519436842030"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä» Arco Table è¿ç§»åˆ° VTableï¼šVTableä½¿ç”¨ç»éªŒåˆ†äº«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/255519436842030/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç å°å­¦åƒ§
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T08:19:04.000Z" title="Fri Dec 19 2025 08:19:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">VTableç®€ä»‹</h2>
<p>VTable: ä¸åªæ˜¯é«˜æ€§èƒ½çš„å¤šç»´æ•°æ®åˆ†æè¡¨æ ¼ï¼Œæ›´æ˜¯è¡Œåˆ—é—´åˆ›ä½œçš„æ–¹æ ¼è‰ºæœ¯å®¶ï¼</p>
<p>åœ¨ç°ä»£åº”ç”¨ç¨‹åºä¸­ï¼Œè¡¨æ ¼ç»„ä»¶æ˜¯ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒä»¬èƒ½å¤Ÿå¿«é€Ÿå±•ç¤ºå¤§é‡æ•°æ®ï¼Œå¹¶æä¾›è‰¯å¥½çš„å¯è§†åŒ–æ•ˆæœå’Œäº¤äº’ä½“éªŒã€‚VTableæ˜¯ä¸€æ¬¾åŸºäºå¯è§†åŒ–æ¸²æŸ“å¼•æ“VRenderçš„é«˜æ€§èƒ½è¡¨æ ¼ç»„ä»¶åº“ï¼Œä¸ºç”¨æˆ·æä¾›å“è¶Šçš„æ€§èƒ½å’Œå¼ºå¤§çš„å¤šç»´åˆ†æèƒ½åŠ›ï¼Œä»¥åŠçµæ´»å¼ºå¤§çš„å›¾å½¢èƒ½åŠ›ã€‚</p>
<p>å®˜ç½‘é“¾æ¥: <a href="https://link.juejin.cn?target=https%3A%2F%2Fvisactor.com%2Fvtable" target="_blank" title="https://visactor.com/vtable" ref="nofollow noopener noreferrer">visactor.com/vtable</a></p>
<p>githubåœ°å€: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FVisActor%2FVTable" target="_blank" title="https://github.com/VisActor/VTable" ref="nofollow noopener noreferrer">github.com/VisActor/VTâ€¦</a></p>
<h2 data-id="heading-1">åˆ›å»ºé¡¹ç›®</h2>
<p>å‡†å¤‡åˆ†äº«å‡ ä¸ªç®€å•çš„å®è·µæ¡ˆä¾‹ï¼Œæˆ‘ç›®å‰ä¸»è¦ä½¿ç”¨çš„æ˜¯åŸºç¡€è¡¨æ ¼ListTableåœ¨reacté¡¹ç›®ä¸­ï¼Œæ‰€ä»¥æ¡ˆä¾‹åŸºæœ¬ä¹Ÿéƒ½æ˜¯ListTableçš„ï¼Œåç»­åœ¨é¡¹ç›®ä¸­ä½¿ç”¨åˆ°äº†å…¶ä»–è¡¨æ ¼çš„è¿‡ç¨‹ä¸­é‡åˆ°å€¼å¾—åˆ†äº«çš„å†…å®¹ä¹Ÿä¼šç»§ç»­åˆ†äº«çš„ã€‚</p>
<p>å…¨éƒ¨ä»£ç ç¤ºä¾‹: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FLLmoskk%2Fvtable-demo" target="_blank" title="https://github.com/LLmoskk/vtable-demo" ref="nofollow noopener noreferrer">github.com/LLmoskk/vtaâ€¦</a></p>
<p>åœ¨çº¿é¢„è§ˆ: <a href="https://link.juejin.cn?target=https%3A%2F%2Fllmoskk.github.io%2Fvtable-demo%2F" target="_blank" title="https://llmoskk.github.io/vtable-demo/" ref="nofollow noopener noreferrer">llmoskk.github.io/vtable-demoâ€¦</a></p>
<p>å…ˆèµ·ä¸€ä¸ªreacté¡¹ç›®ï¼Œç»å…¸viteèµ·æ‰‹ï¼Œæ³¨: react-vtable React 19 è¿˜ä¸è¢«æ”¯æŒ æˆ‘ä»¬éœ€è¦ä½¿ç”¨18ç‰ˆæœ¬çš„reactã€‚</p>
<h2 data-id="heading-2">æŒ‡æŒ¥ AI + MCP å¿«é€Ÿå‡†ç¡®çš„ä½¿ç”¨ vtable</h2>
<p>æˆ‘ç›®å‰ä½¿ç”¨çš„AI IDEæ˜¯ AWS çš„ krioï¼Œæˆ‘ä»¬å…ˆæ·»åŠ context7 mcpï¼Œ è¿™ä¸ªmcpçš„ä½œç”¨æ˜¯è®©aiè·å–æœ€æ–°çš„æ–‡æ¡£ï¼Œé¿å…ä½¿ç”¨è¿‡æ—¶çš„apiã€‚ç°åœ¨ä¸»æµçš„IDEåŸºæœ¬éƒ½æ”¯æŒæ·»åŠ MCPäº†ï¼Œä¸åœ¨æ­¤ä¸€ä¸€ä¸¾ä¾‹ã€‚</p>
<pre><code class="hljs language-perl" lang="perl">{
  <span class="hljs-string">"mcpServers"</span>: {
    <span class="hljs-string">"context7"</span>: {
      <span class="hljs-string">"args"</span>: [
        <span class="hljs-string">"-y"</span>,
        <span class="hljs-string">"@upstash/context7-mcp@latest"</span>
      ],
      <span class="hljs-string">"command"</span>: <span class="hljs-string">"npx"</span>,
      <span class="hljs-string">"disabled"</span>: false,
      <span class="hljs-string">"autoApprove"</span>: [
        <span class="hljs-string">"resolve-library-id"</span>
      ]
    },
  }
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3127ad2a0089455d8bc40ce2b93e043c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737258&amp;x-signature=Wr0xNoOebrHxSYTHqp8lAdVcKgI%3D" alt="" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°å·²ç»æˆåŠŸè°ƒç”¨mcpå·¥å…·å»è·å–æ–‡æ¡£ä¿¡æ¯äº†ã€‚æˆ‘è¦æ±‚ä»–å®ç°ä¸€ä¸ªæ ‘å½¢è¡¨æ ¼ã€‚</p>
<p>å¾ˆå¿«å•Šï¼ aiå°±å†™å®Œäº†ã€‚æ•ˆæœè¿˜ä¸é”™ï¼Œè¿™é‡Œå°±ä¸è´´ä»£ç äº†ï¼Œæ²¡æœ‰å¤ªå¤šå‚è€ƒä»·å€¼ï¼Œåªæ˜¯ç”¨æ¥æ¼”ç¤ºä¸€ä¸‹ä½¿ç”¨ai + mcpç»“åˆå¿«é€Ÿçš„å®ç°vtableçš„åŠŸèƒ½ï¼Œæ— éœ€è‡ªå·±å»ç¿»é˜…æ–‡æ¡£äº†ã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2a96efadf1664559944b567be3e9e49c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737258&amp;x-signature=IBxnNQFpyzLO2hW3gnmtYu0rvPU%3D" alt="" width="100%" loading="lazy"/>
<h2 data-id="heading-3">å®ç°è®¡ç®—æ•°æ®å¹¶æŒä¹…åŒ–è®°å¿†ä¿®æ”¹æ‹–æ‹½åˆ—å®½åº¦</h2>
<p><strong>é¡¹ç›®åœºæ™¯æ¦‚è¿°ï¼š</strong></p>
<p>åœ¨å¤„ç†æ•°æ®é‡è¾ƒå¤§çš„è¡¨æ ¼æ—¶ï¼Œè‹¥å°†æ‰€æœ‰åˆ—çš„å®½åº¦å›ºå®šä¸º120pxï¼Œå¯èƒ½ä¼šå¯¼è‡´æŸäº›æ•°æ®è¾ƒå°‘çš„åˆ—å æ®è¿‡å¤šçš„ç©ºé—´ã€‚å› æ­¤ï¼Œæå‡ºäº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼šåŠ¨æ€è°ƒæ•´åˆ—å®½ï¼Œæ ¹æ®æ•°æ®å€¼è‡ªåŠ¨æµ‹é‡å¹¶è®¾ç½®æ¯ä¸€åˆ—çš„æœ€ç»ˆå®½åº¦ã€‚</p>
<ol>
<li>
<p><strong>åˆ—å®½è‡ªé€‚åº”</strong>ï¼šé€šè¿‡åˆ†æè¡¨æ ¼å‰20è¡Œçš„æ•°æ®ï¼Œæˆ‘ä»¬å°†åŠ¨æ€è®¡ç®—å„åˆ—çš„æœ€ä½³å®½åº¦ï¼Œä»¥ç¡®ä¿è¡¨æ ¼å¸ƒå±€æ›´åŠ åˆç†ã€‚</p>
</li>
<li>
<p><strong>ç”¨æˆ·è‡ªå®šä¹‰æ‹–æ‹½</strong>ï¼šå…è®¸ç”¨æˆ·æ‰‹åŠ¨æ‹–åŠ¨åˆ—è¾¹ç•Œè°ƒæ•´åˆ—å®½ã€‚æ‹–æ‹½åçš„å®½åº¦å°†åœ¨æœ¬åœ°å­˜å‚¨ï¼ˆlocalStorageï¼‰ä¸­ä¿å­˜ï¼Œæœ‰æ•ˆæå‡ç”¨æˆ·ä½“éªŒã€‚</p>
</li>
<li>
<p><strong>åŠ è½½ä¼˜å…ˆçº§æœºåˆ¶</strong>ï¼šè¡¨æ ¼åŠ è½½æ—¶ï¼Œå°†ä¼˜å…ˆè€ƒè™‘ä»¥ä¸‹é¡ºåºæ¥è®¾ç½®åˆ—å®½ï¼š</p>
<ol>
<li>æœ¬åœ°å­˜å‚¨ä¸­çš„å®½åº¦</li>
<li>è‡ªåŠ¨è®¡ç®—å¾—å‡ºçš„å®½åº¦</li>
<li>é»˜è®¤å®½åº¦è®¾ç½®</li>
</ol>
</li>
</ol>
<p>å°†ç¼–å†™ä¸€ä¸ªåä¸º <code>use-column-width.ts</code> çš„æ–‡ä»¶ï¼Œå°è£…ä¸€ä¸ªè‡ªå®šä¹‰Hookã€‚è¯¥Hookçš„åŠŸèƒ½æ˜¯æŒ‰ç…§ä¸Šè¿°é€»è¾‘è®¡ç®—åˆ—å®½ï¼Œå¹¶ä¸ç”¨æˆ·æ‹–æ‹½çš„å®½åº¦è¿›è¡Œè®°å¿†ã€‚æˆ‘ä»¬å°†åˆ©ç”¨ahookä¸­çš„ <code>useLocalStorageState</code> æ¥ä¿æŒçŠ¶æ€ä¿¡æ¯åŒæ­¥å­˜å‚¨åˆ° localStorage ä¸­ã€‚</p>
<p><del>æµ‹é‡æ–‡æœ¬å®½åº¦ ~~~~<em>å‚è€ƒæ–‡ç« </em> ~~~~<em><a href="https://juejin.cn/post/7091990279565082655" target="_blank" title="https://juejin.cn/post/7091990279565082655">juejin.cn/post/709199â€¦</a></em>~~~~ <em>ï¼Œ</em> ~~~~å®Œæ•´ä»£ç ä¸åœ¨è¿™é‡Œè´´å‡ºäº†å¯è®¿é—®ä»“åº“è‡ªå– ~~~~<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FLLmoskk%2Fvtable-demo%2Fblob%2Fmain%2Fsrc%2Fpages%2Fdemo1%2Futils%2Fcalculate-column-width.ts" target="_blank" title="https://github.com/LLmoskk/vtable-demo/blob/main/src/pages/demo1/utils/calculate-column-width.ts" ref="nofollow noopener noreferrer">github.com/LLmoskk/vtaâ€¦</a></del></p>
<p>(ä¸éœ€è¦è‡ªå·±å†™äº†ï¼Œå¯ä»¥ç”¨vtableå†™å¥½çš„measureText ğŸ˜…)</p>
<p>å¦‚æœæ²¡æœ‰å®šåˆ¶è¦æ±‚çš„è¯å¯ä»¥ç›´æ¥ä½¿ç”¨è¡¨æ ¼çš„ <code>è‡ªåŠ¨åˆ—å®½æ¨¡å¼ï¼ˆautoWidthï¼‰</code> å·²ç»å¸®å¿™è®¡ç®—è¿‡ä¸€éäº†ã€‚</p>
<p>vtableæ–‡å­—æµ‹é‡æ–¹æ³•: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FVisActor%2FVUtil%2Fblob%2Fmain%2Fpackages%2Fvutils%2Fsrc%2Fgraphics%2Ftext%2Fmeasure%2FtextMeasure.ts" target="_blank" title="https://github.com/VisActor/VUtil/blob/main/packages/vutils/src/graphics/text/measure/textMeasure.ts" ref="nofollow noopener noreferrer">github.com/VisActor/VUâ€¦</a></p>
<p>npm åœ°å€: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2F%40visactor%2Fvutils" target="_blank" title="https://www.npmjs.com/package/@visactor/vutils" ref="nofollow noopener noreferrer">www.npmjs.com/package/@viâ€¦</a></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { useLocalStorageState } <span class="hljs-keyword">from</span> <span class="hljs-string">'ahooks'</span>;
<span class="hljs-keyword">import</span> { useCallback, useMemo } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-keyword">type</span> <span class="hljs-title class_">ColumnDefine</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@visactor/vtable'</span>;
<span class="hljs-keyword">import</span> { calculateColumnsWidthMap } <span class="hljs-keyword">from</span> <span class="hljs-string">'../utils/calculate-column-width'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">Sort</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../type'</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">UseColumnWidthParams</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ColumnDefine</span>&gt; = {
  <span class="hljs-comment">/** åˆ—é…ç½®æ•°ç»„ */</span>
  columns?: T[];
  <span class="hljs-comment">/** localStorageçš„key */</span>
  <span class="hljs-attr">storageKey</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">/** è¡¨æ ¼æ•°æ®ï¼Œç”¨äºè®¡ç®—åˆ—å®½ */</span>
  data?: <span class="hljs-built_in">any</span>[];
  <span class="hljs-comment">/** é»˜è®¤åˆ— å®½ */</span>
  defaultWidth?: <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">/** è§†å›¾ID */</span>
  viewId?: <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span>;
  <span class="hljs-comment">/** æ˜¯å¦å·²æ’åºçš„ä¿¡æ¯ */</span>
  sorts?: <span class="hljs-title class_">Sort</span>[];
};

<span class="hljs-keyword">type</span> <span class="hljs-title class_">UseColumnWidthReturn</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ColumnDefine</span>&gt; = {
  <span class="hljs-comment">/** åº”ç”¨äº†åˆ—å®½çš„åˆ—é…ç½®ï¼ˆä¼˜å…ˆçº§ï¼šæœ¬åœ°å­˜å‚¨ &gt; è®¡ç®—å€¼ &gt; é»˜è®¤å€¼ï¼‰ */</span>
  <span class="hljs-attr">columnsWithWidth</span>: T[];
  <span class="hljs-comment">/** ä¿å­˜åˆ—å®½çš„å‡½æ•° */</span>
  <span class="hljs-attr">saveColumnWidths</span>: <span class="hljs-function">(<span class="hljs-params">colWidths: <span class="hljs-built_in">number</span>[]</span>) =&gt;</span> <span class="hljs-built_in">void</span>;
  <span class="hljs-comment">/** åˆ—å®½æ˜ å°„å¯¹è±¡ */</span>
  <span class="hljs-attr">columnWidths</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt;;
};

<span class="hljs-comment">/**
* ç®¡ç†è¡¨æ ¼åˆ—å®½æŒä¹…åŒ–çš„hook
* å½“columnsçš„fieldé¡ºåºå‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè‡ªåŠ¨æ¸…ç†ä¸å­˜åœ¨çš„åˆ—å®½è®¾ç½®
*
* åˆ—å®½ä¼˜å…ˆçº§ï¼šæœ¬åœ°å­˜å‚¨ &gt; è®¡ç®—å€¼ &gt; é»˜è®¤å€¼
*/</span>
<span class="hljs-keyword">const</span> useColumnWidth = &lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ColumnDefine</span>&gt;({
  columns,
  storageKey,
  data = [],
  defaultWidth = <span class="hljs-number">120</span>,
  sorts,
}: <span class="hljs-title class_">UseColumnWidthParams</span>&lt;T&gt;): <span class="hljs-title class_">UseColumnWidthReturn</span>&lt;T&gt; =&gt; {
  <span class="hljs-keyword">const</span> [storedValue, setStoredValue] = useLocalStorageState&lt;<span class="hljs-built_in">any</span>&gt;(storageKey, {
    <span class="hljs-attr">defaultValue</span>: {},
  });
  <span class="hljs-keyword">const</span> columnWidths = storedValue;

  <span class="hljs-keyword">const</span> calculatedWidthMap = <span class="hljs-title function_">useMemo</span>(
    <span class="hljs-function">() =&gt;</span>
      <span class="hljs-title function_">calculateColumnsWidthMap</span>(
        columns,
        data,
        sorts,
      ),
    [columns, data, sorts],
  );

  <span class="hljs-comment">// ä¿å­˜åˆ—å®½åˆ° localStorage</span>
  <span class="hljs-keyword">const</span> saveColumnWidths = <span class="hljs-title function_">useCallback</span>(
    <span class="hljs-function">(<span class="hljs-params">colWidths: <span class="hljs-built_in">number</span>[]</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> <span class="hljs-attr">widthMap</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt; = {};
      columns?.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">col, index</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (colWidths[index]) {
          widthMap[<span class="hljs-title class_">String</span>(col.<span class="hljs-property">field</span>)] = colWidths[index];
        }
      });

      <span class="hljs-title function_">setStoredValue</span>(widthMap);
    },
    [columns, setStoredValue],
  );

  <span class="hljs-comment">// åº”ç”¨åˆ—å®½åˆ°åˆ—é…ç½®</span>
  <span class="hljs-comment">// ä¼˜å…ˆçº§ï¼šæœ¬åœ°å­˜å‚¨ &gt; è®¡ç®—å€¼ &gt; é»˜è®¤å€¼</span>
  <span class="hljs-keyword">const</span> columnsWithWidth = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">return</span> columns?.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">col</span>) =&gt;</span> {
      <span class="hljs-comment">// checkbox å›ºå®š 40 cellType å¯èƒ½ä¸ºå‡½æ•°</span>
      <span class="hljs-keyword">if</span> (col.<span class="hljs-property">cellType</span> === <span class="hljs-string">'checkbox'</span> || col.<span class="hljs-property">headerType</span> === <span class="hljs-string">'checkbox'</span>) {
        <span class="hljs-keyword">return</span> {
          ...col,
          <span class="hljs-attr">width</span>: <span class="hljs-number">40</span>,
        };
      }

      <span class="hljs-comment">// ä¼˜å…ˆä½¿ç”¨æœ¬åœ°å­˜å‚¨çš„å®½åº¦</span>
      <span class="hljs-keyword">if</span> (columnWidths?.[<span class="hljs-title class_">String</span>(col.<span class="hljs-property">field</span>)]) {
        <span class="hljs-keyword">return</span> {
          ...col,
          <span class="hljs-attr">width</span>: columnWidths[<span class="hljs-title class_">String</span>(col.<span class="hljs-property">field</span>)],
        };
      }

      <span class="hljs-comment">// å…¶æ¬¡ä½¿ç”¨è®¡ç®—çš„å®½åº¦</span>
      <span class="hljs-keyword">const</span> calculatedWidth = calculatedWidthMap.<span class="hljs-title function_">get</span>(<span class="hljs-title class_">String</span>(col.<span class="hljs-property">field</span>));
      <span class="hljs-keyword">if</span> (calculatedWidth) {
        <span class="hljs-keyword">return</span> {
          ...col,
          <span class="hljs-attr">width</span>: calculatedWidth,
        };
      }

      <span class="hljs-comment">// æœ€åä½¿ç”¨é»˜è®¤å®½åº¦</span>
      <span class="hljs-keyword">return</span> {
        ...col,
        <span class="hljs-attr">width</span>: defaultWidth,
      };
    });
  }, [columns, columnWidths, calculatedWidthMap, defaultWidth]);

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">columnsWithWidth</span>: columnsWithWidth || [],
    saveColumnWidths,
    <span class="hljs-attr">columnWidths</span>: columnWidths || {},
  };
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> useColumnWidth;
</code></pre>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30815046bb3b42d9af2179ad64d2b55a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737258&amp;x-signature=kZHTXIln4SDvlTEf8OUc%2Bi%2Fop2o%3D" alt="" width="100%" loading="lazy"/>
<h2 data-id="heading-4">ä¸»é¢˜åˆ‡æ¢</h2>
<p>vtableæä¾›äº†<code>Arco design</code>çš„ä¸»é¢˜ä¸ <code>Dark Mode</code>çš„ä¸»é¢˜ï¼Œæˆ‘çš„é¡¹ç›®æ˜¯ç”±<code>Arco design</code>çš„tableåˆ‡æ¢åˆ°vtableçš„ï¼Œæ‰€ä»¥ä½¿ç”¨è‡ªå®˜æ–¹æä¾›çš„ä¸»é¢˜åŒ…ï¼Œå¹¶ä¸”æˆ‘çš„é¡¹ç›®éœ€è¦é€‚é…æš—è‰²æ¨¡å¼ï¼Œäºæ˜¯ä¹Ÿç”¨åˆ°äº† <code>Dark Mode</code> æ¥å®šåˆ¶ä¿®æ”¹äº†ä¸‹ï¼ŒåŸºæœ¬é…ç½®ä¿¡æ¯éƒ½å¯ä»¥åœ¨æ–‡æ¡£ä¸­æŸ¥çœ‹ <a href="https://link.juejin.cn?target=https%3A%2F%2Fvisactor.com%2Fvtable%2Foption%2FListTable%23theme" target="_blank" title="https://visactor.com/vtable/option/ListTable#theme" ref="nofollow noopener noreferrer">visactor.com/vtable/optiâ€¦</a></p>
<p>å†…ç½®ä¸»é¢˜æœ‰äº”ä¸ª</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">const</span> <span class="hljs-string">builtinThemes</span> <span class="hljs-string">=</span> [
    { <span class="hljs-attr">key:</span> <span class="hljs-string">'DEFAULT'</span>, <span class="hljs-attr">name:</span> <span class="hljs-string">'é»˜è®¤ä¸»é¢˜'</span>, <span class="hljs-attr">theme:</span> <span class="hljs-string">themes.DEFAULT</span> },
    { <span class="hljs-attr">key:</span> <span class="hljs-string">'DARK'</span>, <span class="hljs-attr">name:</span> <span class="hljs-string">'æš—è‰²ä¸»é¢˜'</span>, <span class="hljs-attr">theme:</span> <span class="hljs-string">themes.DARK</span> },
    { <span class="hljs-attr">key:</span> <span class="hljs-string">'BRIGHT'</span>, <span class="hljs-attr">name:</span> <span class="hljs-string">'æ˜äº®ä¸»é¢˜'</span>, <span class="hljs-attr">theme:</span> <span class="hljs-string">themes.BRIGHT</span> },
    { <span class="hljs-attr">key:</span> <span class="hljs-string">'ARCO'</span>, <span class="hljs-attr">name:</span> <span class="hljs-string">'Arcoä¸»é¢˜'</span>, <span class="hljs-attr">theme:</span> <span class="hljs-string">themes.ARCO</span> },
    { <span class="hljs-attr">key:</span> <span class="hljs-string">'SIMPLIFY'</span>, <span class="hljs-attr">name:</span> <span class="hljs-string">'ç®€çº¦ä¸»é¢˜'</span>, <span class="hljs-attr">theme:</span> <span class="hljs-string">themes.SIMPLIFY</span> }
  ]<span class="hljs-string">;</span>
</code></pre>
<p>æˆ‘ä»¬è¿˜å¯ä»¥extendsä¸»é¢˜è¿›è¡Œæ‰©å±•å®šåˆ¶ï¼Œæˆ‘ä»¬ç³»ç»Ÿä¸­æ˜¯ç”±<code>Arco design</code>çš„Tableç»„ä»¶è¿ç§»è‡³vtableçš„ï¼Œåˆ‡æ¢åˆ°ARCOä¸»é¢˜åï¼Œå‘ç°è¿˜æ˜¯å’Œç»„ä»¶åº“çš„è¡¨æ ¼æœ‰äº›ä¸åŒçš„ï¼Œå› æ­¤æˆ‘åšäº†äº›æ ·å¼è¦†å†™ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { themes } <span class="hljs-keyword">from</span> <span class="hljs-string">"@visactor/vtable"</span>;

<span class="hljs-comment">/**
* è·å–é€šç”¨çš„ VTable ä¸»é¢˜é…ç½®
*/</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">getCommonVTableTheme</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">return</span> themes.<span class="hljs-property">ARCO</span>.<span class="hljs-title function_">extends</span>({
            <span class="hljs-attr">frameStyle</span>: {
                <span class="hljs-attr">borderLineWidth</span>: <span class="hljs-number">0</span>,
            },
            <span class="hljs-attr">headerStyle</span>: {
                <span class="hljs-attr">bgColor</span>: <span class="hljs-string">'#F0F1F5'</span>,
                <span class="hljs-attr">fontSize</span>: <span class="hljs-number">12</span>,
                <span class="hljs-attr">fontWeight</span>: <span class="hljs-number">400</span>,
                <span class="hljs-attr">autoWrapText</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">lineClamp</span>: <span class="hljs-number">3</span>,
            },
            <span class="hljs-attr">bodyStyle</span>: {
                <span class="hljs-comment">// ä½¿ç”¨å‡½æ•°åŠ¨æ€è®¾ç½®èƒŒæ™¯è‰²ï¼Œå¦‚æœæ˜¯ aggregation è¡Œåˆ™ä½¿ç”¨ headerStyle çš„æ ·å¼</span>
                <span class="hljs-attr">bgColor</span>: <span class="hljs-function">(<span class="hljs-params">args: <span class="hljs-built_in">any</span></span>) =&gt;</span> {
                    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ˜¯ aggregation è¡Œ</span>
                    <span class="hljs-keyword">if</span> (args.<span class="hljs-property">table</span> &amp;&amp; <span class="hljs-keyword">typeof</span> args.<span class="hljs-property">table</span>.<span class="hljs-property">isAggregation</span> === <span class="hljs-string">'function'</span>) {
                        <span class="hljs-keyword">const</span> isAggregationCell = args.<span class="hljs-property">table</span>.<span class="hljs-title function_">isAggregation</span>(
                            args.<span class="hljs-property">col</span>,
                            args.<span class="hljs-property">row</span>,
                        );
                        <span class="hljs-keyword">if</span> (isAggregationCell) {
                            <span class="hljs-keyword">return</span> <span class="hljs-string">'#F0F1F5'</span>;
                        }
                    }
                    <span class="hljs-keyword">return</span> <span class="hljs-string">'#FFFFFF'</span>;
                },
            },
            <span class="hljs-attr">bottomFrozenStyle</span>: {
                <span class="hljs-attr">bgColor</span>: <span class="hljs-string">'#F0F1F5'</span>,
                <span class="hljs-attr">fontWeight</span>: <span class="hljs-number">600</span>,
                <span class="hljs-attr">fontSize</span>: <span class="hljs-number">14</span>,
            },
            <span class="hljs-attr">tooltipStyle</span>: {
                <span class="hljs-attr">bgColor</span>: <span class="hljs-string">'black'</span>,
                <span class="hljs-attr">color</span>: <span class="hljs-string">'white'</span>,
                <span class="hljs-attr">fontSize</span>: <span class="hljs-number">12</span>,
                <span class="hljs-attr">padding</span>: [<span class="hljs-number">8</span>, <span class="hljs-number">12</span>, <span class="hljs-number">8</span>, <span class="hljs-number">12</span>],
            },
            <span class="hljs-attr">scrollStyle</span>: {
                <span class="hljs-attr">visible</span>: <span class="hljs-string">'always'</span>, <span class="hljs-comment">// æ»šåŠ¨æ¡å§‹ç»ˆæ˜¾ç¤º</span>
                <span class="hljs-attr">hoverOn</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// æ»šåŠ¨æ¡ä¸æ‚¬æµ®åœ¨å†…å®¹ä¸Šï¼Œè€Œæ˜¯ç‹¬ç«‹æ˜¾ç¤º</span>
            },
            <span class="hljs-attr">selectionStyle</span>: {
                <span class="hljs-attr">cellBgColor</span>: <span class="hljs-string">'rgba(133,165,242,0.2)'</span>,
            },
        });
    }
};
</code></pre>
<p>å¯¹å•å…ƒæ ¼çš„æ¡ä»¶å®šåˆ¶ï¼Œéå†åˆ—é…ç½®åå¯ä»¥å•ç‹¬æ ¹æ®æ¡ä»¶è®¾ç½®å•å…ƒæ ¼æ ·å¼</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> salesColumn = baseColumns.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">col</span> =&gt;</span> col.<span class="hljs-property">field</span> === <span class="hljs-string">'sales'</span>);
  <span class="hljs-keyword">if</span> (salesColumn) {
    (salesColumn <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">style</span> = {
      <span class="hljs-attr">color</span>: <span class="hljs-function">(<span class="hljs-params">args: <span class="hljs-built_in">any</span></span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> value = args.<span class="hljs-property">dataValue</span>;
        <span class="hljs-keyword">if</span> (value &gt;= <span class="hljs-number">150000</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'#059669'</span>; <span class="hljs-comment">// ç»¿è‰²ï¼šé«˜é”€å”®é¢</span>
        <span class="hljs-keyword">if</span> (value &gt;= <span class="hljs-number">100000</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'#0891b2'</span>; <span class="hljs-comment">// è“è‰²ï¼šä¸­ç­‰é”€å”®é¢</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">'#dc2626'</span>; <span class="hljs-comment">// çº¢è‰²ï¼šä½é”€å”®é¢</span>
      },
      <span class="hljs-attr">fontWeight</span>: <span class="hljs-function">(<span class="hljs-params">args: <span class="hljs-built_in">any</span></span>) =&gt;</span> {
        <span class="hljs-keyword">return</span> args.<span class="hljs-property">dataValue</span> &gt;= <span class="hljs-number">150000</span> ? <span class="hljs-string">'bold'</span> : <span class="hljs-string">'normal'</span>;
      }
    };
  }
</code></pre>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be8a0b7cbbac4c1a8f6fe18aceb49e6b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737258&amp;x-signature=QbPF%2F62PXrndTHn1RicVD2qgl%2FA%3D" alt="" width="100%" loading="lazy"/>
<h2 data-id="heading-5">è¡¨æ ¼è½¬ç½®ä¸å†»ç»“è¡¨æ ¼</h2>
<p>å†»ç»“åˆ—åŠŸèƒ½é…ç½®: <a href="https://link.juejin.cn?target=https%3A%2F%2Fvisactor.com%2Fvtable%2Fguide%2Fbasic_function%2Ffrozen_column_row" target="_blank" title="https://visactor.com/vtable/guide/basic_function/frozen_column_row" ref="nofollow noopener noreferrer">visactor.com/vtable/guidâ€¦</a></p>
<p>åœ¨åå°ç³»ç»Ÿçœ‹è¡¨çš„æ—¶å€™ä¸€èˆ¬éœ€è¦å›ºå®šå·¦ä¾§çš„å‡ åˆ—ã€‚æ”¯æŒé¡¶éƒ¨ã€åº•éƒ¨ã€å·¦ä¾§ã€å³ä¾§çš„å†»ç»“è®¾ç½®ã€‚</p>
<p>æˆ‘åœ¨é¡¹ç›®ä¸­é‡åˆ°çš„é—®é¢˜å°±æ˜¯åˆ‡æ¢ä¸»é¢˜åˆ°æš—è‰²çš„æ—¶å€™ï¼Œè¡¨æ ¼å›ºå®šæŒ‰é’®çš„å›¾æ ‡æ²¡æœ‰è·Ÿéšä¸»é¢˜å˜åŒ–ï¼Œé€šè¿‡æŸ¥è¯¢æ–‡æ¡£å¾—çŸ¥å¯ä»¥æ³¨å†Œ icon è‡ªå®šä¹‰å›¾æ ‡çš„ä¸€äº›é…ç½®ã€‚ç„¶åæˆ‘ä»æºç ä¸­è·å–åˆ°åŸå§‹çš„ svg ä¼ å…¥è·Ÿéšä¸»é¢˜å˜åŒ–çš„ <code>frozen_color</code></p>
<p>æ³¨å†Œicon: <a href="https://link.juejin.cn?target=https%3A%2F%2Fvisactor.com%2Fvtable%2Fguide%2Fcustom_define%2Fcustom_icon" target="_blank" title="https://visactor.com/vtable/guide/custom_define/custom_icon" ref="nofollow noopener noreferrer">visactor.com/vtable/guidâ€¦</a></p>
<pre><code class="hljs language-php" lang="php">export <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">registerVtableIcon</span> = (isDark?: <span class="hljs-keyword">boolean</span>) =&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">frozen_size</span> = <span class="hljs-number">22</span>;
  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">frozen_size_2</span> = <span class="hljs-number">22</span>;
  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">frozen_color</span> = isDark ? <span class="hljs-string">'#FFFFFF'</span> : <span class="hljs-string">'#282F38'</span>;
  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">frozen_color_opacity</span> = <span class="hljs-string">'0.35'</span>;
  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">freeze_color_opacity</span> = <span class="hljs-string">'0.2'</span>;

  register.<span class="hljs-title function_ invoke__">icon</span>(<span class="hljs-string">'frozen'</span>, {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'svg'</span>,
    <span class="hljs-attr">svg</span>:
      <span class="hljs-string">'&lt;svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"&gt;'</span> +
      `&lt;path d=<span class="hljs-string">"M8.49975 3.66663C8.32294 3.66663 8.15337 3.73686 8.02835 3.86189C7.90332 3.98691 7.83309 4.15648 7.83309 4.33329V9.63246C6.76475 10.2533 6.07942 11.1795 6.00625 12.2308C5.99892 12.2786 5.99692 12.3268 6.00009 12.3741L5.99975 12.4166C5.99975 12.5934 6.06999 12.763 6.19501 12.888C6.32004 13.0131 6.48961 13.0833 6.66642 13.0833H10.3333L10.3331 17.5L10.8611 18.292C10.8763 18.3148 10.8969 18.3335 10.9211 18.3464C10.9453 18.3594 10.9723 18.3662 10.9998 18.3662C11.0272 18.3662 11.0542 18.3594 11.0784 18.3464C11.1026 18.3335 11.1232 18.3148 11.1384 18.292L11.6664 17.5L11.6666 13.0833H15.3331C15.5099 13.0833 15.6795 13.0131 15.8045 12.888C15.9295 12.763 15.9998 12.5934 15.9998 12.4166C15.9998 12.4025 15.9998 12.3883 15.9994 12.3741C16.0028 12.3263 16.0008 12.2776 15.9933 12.2295C15.9196 11.1786 15.2343 10.2528 14.1664 9.63229V4.33329C14.1664 4.15648 14.0962 3.98691 13.9712 3.86189C13.8461 3.73686 13.6766 3.66663 13.4998 3.66663H8.49975Z"</span> fill=<span class="hljs-string">"${frozen_color}"</span> fill-opacity=<span class="hljs-string">"${frozen_color_opacity}"</span>/&gt;` +
      <span class="hljs-string">'&lt;/svg&gt;'</span>,
    <span class="hljs-attr">width</span>: frozen_size,
    <span class="hljs-attr">height</span>: frozen_size,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'frozen'</span>,
    <span class="hljs-attr">funcType</span>: IconFuncTypeEnum.frozen,
    <span class="hljs-attr">positionType</span>: IconPosition.right,
    <span class="hljs-attr">marginRight</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">hover</span>: {
      <span class="hljs-attr">width</span>: frozen_size_2,
      <span class="hljs-attr">height</span>: frozen_size_2,
      <span class="hljs-attr">bgColor</span>: <span class="hljs-string">'rgba(101, 117, 168, 0.1)'</span>,
    },
    <span class="hljs-attr">cursor</span>: <span class="hljs-string">'pointer'</span>,
  });

  register.<span class="hljs-title function_ invoke__">icon</span>(<span class="hljs-string">'freeze'</span>, {
    <span class="hljs-attr">type</span>: <span class="hljs-string">'svg'</span>,
    <span class="hljs-attr">svg</span>:
      <span class="hljs-string">'&lt;svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"&gt;'</span> +
      <span class="hljs-string">'&lt;g clip-path="url(#clip0)"&gt;'</span> +
      `&lt;path d=<span class="hljs-string">"M17.1313 8.42047C17.1932 8.48238 17.2423 8.55587 17.2759 8.63676C17.3094 8.71764 17.3266 8.80434 17.3266 8.89189C17.3266 8.97944 17.3094 9.06613 17.2759 9.14702C17.2423 9.2279 17.1932 9.3014 17.1313 9.3633L13.3843 13.1103C13.7007 14.3048 13.5305 15.4443 12.8388 16.2395C12.8104 16.2781 12.7778 16.3136 12.7417 16.3451L12.712 16.3755C12.6501 16.4374 12.5766 16.4865 12.4957 16.52C12.4148 16.5535 12.3281 16.5707 12.2406 16.5707C12.153 16.5707 12.0663 16.5535 11.9854 16.52C11.9046 16.4865 11.8311 16.4374 11.7692 16.3755L9.17633 13.7826L6.05316 16.9058L5.11983 17.0925C5.09291 17.0979 5.06508 17.0965 5.03881 17.0886C5.01254 17.0806 4.98863 17.0663 4.96923 17.0469C4.94982 17.0275 4.9355 17.0036 4.92755 16.9773C4.9196 16.951 4.91827 16.9232 4.92366 16.8963L5.11033 15.963L8.23333 12.8396L5.64066 10.2471C5.57875 10.1852 5.52964 10.1117 5.49614 10.0309C5.46263 9.94997 5.44539 9.86327 5.44539 9.77572C5.44539 9.68817 5.46263 9.60148 5.49614 9.52059C5.52964 9.43971 5.57875 9.36621 5.64066 9.3043C5.65066 9.2943 5.66066 9.2843 5.67099 9.27464C5.70266 9.2383 5.73833 9.20547 5.77766 9.17664C6.57283 8.48564 7.71199 8.31564 8.90599 8.63197L12.6528 4.88497C12.7147 4.82306 12.7882 4.77395 12.8691 4.74045C12.95 4.70694 13.0367 4.6897 13.1242 4.6897C13.2118 4.6897 13.2985 4.70694 13.3794 4.74045C13.4603 4.77395 13.5338 4.82306 13.5957 4.88497L17.1312 8.42047H17.1313ZM15.7172 8.8918L13.1243 6.29914L9.56483 9.8588C9.47574 9.94788 9.36323 10.0099 9.24034 10.0376C9.11746 10.0654 8.98922 10.0578 8.87049 10.0156C8.22783 9.78764 7.63899 9.7553 7.17749 9.89814L12.1182 14.8388C12.261 14.3771 12.2287 13.7885 12.0007 13.146C11.9585 13.0272 11.9509 12.899 11.9787 12.7761C12.0064 12.6532 12.0684 12.5407 12.1575 12.4516L15.7172 8.89164V8.8918Z"</span> fill=<span class="hljs-string">"${frozen_color}"</span> fill-opacity=<span class="hljs-string">"${freeze_color_opacity}"</span>/&gt;` +
      <span class="hljs-string">'&lt;/g&gt;'</span> +
      <span class="hljs-string">'&lt;defs&gt;'</span> +
      <span class="hljs-string">'&lt;clipPath id="clip0"&gt;'</span> +
      <span class="hljs-string">'&lt;rect width="22" height="22" fill="white"/&gt;'</span> +
      <span class="hljs-string">'&lt;/clipPath&gt;'</span> +
      <span class="hljs-string">'&lt;/defs&gt;'</span> +
      <span class="hljs-string">'&lt;/svg&gt;'</span>,
    <span class="hljs-attr">width</span>: frozen_size,
    <span class="hljs-attr">height</span>: frozen_size,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'freeze'</span>,
    <span class="hljs-attr">funcType</span>: IconFuncTypeEnum.frozen,
    <span class="hljs-attr">positionType</span>: IconPosition.right,
    <span class="hljs-attr">marginRight</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">hover</span>: {
      <span class="hljs-attr">width</span>: frozen_size_2,
      <span class="hljs-attr">height</span>: frozen_size_2,
      <span class="hljs-attr">bgColor</span>: <span class="hljs-string">'rgba(101, 117, 168, 0.1)'</span>,
    },
    <span class="hljs-attr">cursor</span>: <span class="hljs-string">'pointer'</span>,
  });
};
</code></pre>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/47862d971e5342f7aca6dd83d6eef8a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737258&amp;x-signature=L1%2BcmUSRQbNUpxm46c9ZsaTk9TA%3D" alt="" width="100%" loading="lazy"/>
<p>è¡¨æ ¼è½¬ç½®è®¾ç½®ä¸‹<code>transpose</code> å³å¯è¡Œè½¬åˆ—ï¼Œè½¬ç½®è¡¨æ ¼ç‰¹åˆ«é€‚åˆæ•°æ®åˆ—å¾ˆå¤šä½†è¡Œæ•°è¾ƒå°‘çš„åœºæ™¯ï¼Œè™½ç„¶ç›®å‰æˆ‘çš„é¡¹ç›®ä¸­è¿˜æœªä½¿ç”¨åˆ°ã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b59242eac427437e98fb499b5193a890~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737258&amp;x-signature=QXH8c3ccHq1xOOJMnfXWDGCvDdA%3D" alt="" width="100%" loading="lazy"/>
<h2 data-id="heading-6">è¡¨æ ¼å°ºå¯¸é…ç½®</h2>
<p>è¡Œé«˜åˆ—å®½æ–‡æ¡£: <a href="https://link.juejin.cn?target=https%3A%2F%2Fvisactor.com%2Fvtable%2Fguide%2Fbasic_function%2Frow_height_column_width" target="_blank" title="https://visactor.com/vtable/guide/basic_function/row_height_column_width" ref="nofollow noopener noreferrer">visactor.com/vtable/guidâ€¦</a></p>
<p>widthModeæœ‰ä¸‰ç§æ¨¡å¼ <code>'standard' | 'adaptive' | 'autoWidth'</code></p>
<p>å¦‚æœæ²¡æœ‰ä¸šåŠ¡ç‰¹åˆ«å®šåˆ¶çš„åˆ—å®½è¦æ±‚çš„è¯ï¼Œè®¾ç½® <code>è‡ªåŠ¨åˆ—å®½æ¨¡å¼ï¼ˆautoWidthï¼‰</code>æœ€ä½³ï¼Œå¯ä»¥æ ¹æ®åˆ—å¤´å’Œ body å•å…ƒæ ¼ä¸­çš„å†…å®¹è‡ªåŠ¨è®¡ç®—åˆ—å®½åº¦ï¼Œå¿½ç•¥è®¾ç½®çš„ <code>width</code> å±æ€§å’Œ <code>defaultColWidth</code>ã€‚ä½†è®¡ç®—ä¼šæµªè´¹ä¸€äº›æ€§èƒ½ï¼Œå°±çœ‹è‡ªå·±çš„å–èˆäº†ã€‚</p>
<p>è¿˜æœ‰å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯æœ€å¥½è®¾ç½®è¡¨æ ¼ <code>maxWidth+minWidth</code>å› ä¸ºæˆ‘ä»¬å…è®¸ç”¨æˆ·è‡ªç”±æ‹–æ‹½åˆ—å®½äº†ï¼Œä½†åˆä¸å¸Œæœ›æ— é™åˆ¶ï¼Œæ‰€ä»¥ä¸€èˆ¬æˆ‘éƒ½ä¼šåŠ ä¸Šè¾¹ç•Œé™åˆ¶ã€‚</p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e88954cee6c74b02aa06a28fdcf55c20~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737258&amp;x-signature=So45nmSoFyYRM%2FeYHNl9LaAWiak%3D" alt="" width="100%" loading="lazy"/>
<h2 data-id="heading-7">è¡¨å¤´å›ºå®šæ‚¬æµ®</h2>
<p>ä¼ ç»Ÿçš„domè¡¨æ ¼å¯ä»¥è®¾ç½®è¡¨å¤´ç²˜æ€§å®šä½ï¼Œä½†æˆ‘ä½¿ç”¨vtableçš„æ—¶å€™æƒ³è¦å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œåªèƒ½è®©æ•´ä½“vtableçš„domç²˜æ€§äº†ï¼Œæ•ˆæœä¸æ˜¯å¾ˆå¥½ï¼Œæœ€åæƒ³åˆ°çš„åŠæ³•æ˜¯è®©vtableçš„é«˜åº¦å°½é‡ä¿æŒä¸€å±ã€‚å°±å¯ä»¥å®ç°ç±»ä¼¼è¡¨å¤´ç²˜æ€§å®šä½çš„äº¤äº’äº†ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">  const <span class="hljs-selector-attr">[tableHeight, setTableHeight]</span> = <span class="hljs-built_in">useState</span>(<span class="hljs-number">500</span>); <span class="hljs-comment">// é»˜è®¤æ’‘å¼€çš„ä¸€ä¸ªé«˜åº¦</span>
  
  <span class="hljs-built_in">useEffect</span>(() =&gt; {
    const calculateHeight = () =&gt; {
      <span class="hljs-comment">// è®¡ç®—è¡¨æ ¼é«˜åº¦ï¼šè§†å£é«˜åº¦ - é¡¶éƒ¨å¯¼èˆªæ (60) - åº•éƒ¨é—´è·(16) - Tabsé«˜åº¦(36) - åˆ†é¡µå™¨é«˜åº¦(32)</span>
      <span class="hljs-comment">// ç›®æ ‡æ˜¯è®©è¡¨æ ¼é«˜åº¦å æ»¡ä¸€å±ï¼Œè¿™æ ·å½“æ»šåŠ¨åˆ°åº•éƒ¨æ—¶ï¼Œè¡¨æ ¼æ­£å¥½é“ºæ»¡å±å¹•</span>
      const <span class="hljs-attribute">height</span> = window<span class="hljs-selector-class">.innerHeight</span> - <span class="hljs-number">60</span> - <span class="hljs-number">16</span> - <span class="hljs-number">36</span> - <span class="hljs-number">32</span> - <span class="hljs-number">80</span>;
      <span class="hljs-built_in">setTableHeight</span>(Math.max(height, <span class="hljs-number">400</span>)); <span class="hljs-comment">// è®¾ç½®æœ€å°é«˜åº¦</span>
    };

    <span class="hljs-built_in">calculateHeight</span>();
    window<span class="hljs-selector-class">.addEventListener</span>('resize', calculateHeight);

    return () =&gt; {
      window<span class="hljs-selector-class">.removeEventListener</span>('resize', calculateHeight);
    };
  }, <span class="hljs-selector-attr">[]</span>);
  
  &lt;ListTable
    <span class="hljs-comment">// ...</span>
    <span class="hljs-attribute">height</span>={tableHeight}
  /&gt;
</code></pre>
<h2 data-id="heading-8">å¤åˆ¶è¡¨æ ¼å†…å®¹</h2>
<p>vtableæ”¯æŒæ·»åŠ  keyboardOptions copySelected å³å¯å¼€å¯è¡¨æ ¼ctrl + c å¤åˆ¶åˆ°èƒ½åŠ›ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">keyboardOptions</span>={{
    copySelected: true,
}}
</code></pre>
<p>ä½†æ˜¯é¡¹ç›®ä¸­çš„è¡¨æ ¼æœ‰äº›å•å…ƒæ ¼æˆ‘ä½¿ç”¨äº† customRender è‡ªå®šä¹‰æ¸²æŸ“çš„èƒ½åŠ›ï¼Œæˆ‘å°†ä¸€ä¸ª jsonçš„æ•°æ®è½¬æ¢ä¸ºicon + æ–‡æœ¬çš„å‘ˆç°å½¢å¼ï¼Œè¿™æ—¶å€™å¤åˆ¶åˆ°è¯å°±ä¼šå‡ºé—®é¢˜ã€‚å› æ­¤éœ€è¦<code>formatCopyValue</code> <a href="https://link.juejin.cn?target=https%3A%2F%2Fvisactor.com%2Fvtable%2Foption%2FListTable%23formatCopyValue((value%3A%2520string)%2520%3D%253E%2520string)" target="_blank" title="https://visactor.com/vtable/option/ListTable#formatCopyValue((value:%20string)%20=%3E%20string)" ref="nofollow noopener noreferrer">visactor.com/vtable/optiâ€¦</a></p>
<pre><code class="hljs language-css" lang="css">{
  "<span class="hljs-attribute">icon</span>": <span class="hljs-string">"xxxx"</span>,
  <span class="hljs-string">"text"</span>: <span class="hljs-string">"Demo"</span>
}
</code></pre>

<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> formatCopyValueForVTable = (<span class="hljs-attr">value</span>: <span class="hljs-built_in">unknown</span>): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">toStr</span> = (<span class="hljs-params">v: <span class="hljs-built_in">unknown</span></span>) =&gt; (v == <span class="hljs-literal">null</span> ? <span class="hljs-string">''</span> : <span class="hljs-title class_">String</span>(v));
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value !== <span class="hljs-string">'string'</span>) <span class="hljs-keyword">return</span> <span class="hljs-title function_">toStr</span>(value);

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">parseCell</span> = (<span class="hljs-params">cell: <span class="hljs-built_in">string</span></span>) =&gt; {
    <span class="hljs-keyword">const</span> trimmed = cell.<span class="hljs-title function_">trim</span>();
    <span class="hljs-keyword">if</span> (trimmed.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'{'</span>) &amp;&amp; trimmed.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'}'</span>)) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(trimmed);
        <span class="hljs-keyword">if</span> (obj &amp;&amp; <span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">'object'</span>) {
          <span class="hljs-comment">// ä¼˜å…ˆæ£€æŸ¥ describe å­—æ®µï¼ˆasset å¯¹è±¡ï¼‰</span>
          <span class="hljs-keyword">if</span> (<span class="hljs-string">'describe'</span> <span class="hljs-keyword">in</span> obj) {
            <span class="hljs-keyword">return</span> <span class="hljs-title function_">toStr</span>((obj <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">describe</span> ?? <span class="hljs-string">''</span>);
          }
          <span class="hljs-comment">// å…¶æ¬¡æ£€æŸ¥ text å­—æ®µï¼ˆicon-text å¯¹è±¡ï¼‰</span>
          <span class="hljs-keyword">if</span> (<span class="hljs-string">'text'</span> <span class="hljs-keyword">in</span> obj) {
            <span class="hljs-keyword">return</span> <span class="hljs-title function_">toStr</span>((obj <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">text</span> ?? <span class="hljs-string">''</span>);
          }
        }
      } <span class="hljs-keyword">catch</span> (_) {
        <span class="hljs-comment">// éåˆæ³• JSONï¼Œä¿æŒåŸæ ·</span>
      }
    }
    <span class="hljs-keyword">return</span> cell;
  };

  <span class="hljs-keyword">return</span> value
    .<span class="hljs-title function_">split</span>(<span class="hljs-string">'\n'</span>)
    .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">line</span>) =&gt;</span> line.<span class="hljs-title function_">split</span>(<span class="hljs-string">'\t'</span>).<span class="hljs-title function_">map</span>(parseCell).<span class="hljs-title function_">join</span>(<span class="hljs-string">'\t'</span>))
    .<span class="hljs-title function_">join</span>(<span class="hljs-string">'\n'</span>);
};
</code></pre>
<p>è¿™æ ·å¤åˆ¶å‡ºæ¥çš„å†…å®¹å°±æ­£å¸¸äº†ã€‚</p>
<h2 data-id="heading-9">æ€»ç»“</h2>
<p>VTable æä¾›äº†é«˜æ€§èƒ½çš„è¡¨æ ¼ä½¿ç”¨ä½“éªŒï¼Œå¸®åŠ©å¼€å‘è€…ç®€åŒ–æ“ä½œã€‚å…¶å¼€æ”¾çš„å¯é…ç½® API é€‰é¡¹ä¸°å¯Œï¼ŒåŸºæœ¬æ»¡è¶³å„ç§ä¸šåŠ¡å¼€å‘éœ€æ±‚ã€‚æ­¤å¤–ï¼ŒVtable åœ¨å“åº”é—®é¢˜å’Œäº§å“è¿­ä»£æ–¹é¢ä¹Ÿå±•ç°å‡ºå¿«é€Ÿé«˜æ•ˆçš„ç‰¹ç‚¹ï¼Œä¸ºç”¨æˆ·æä¾›äº†ä¼˜è´¨çš„æ”¯æŒå’ŒæœåŠ¡ã€‚</p>
<p>æ„Ÿæ© Vtable å¼€æºé¡¹ç›®ä¸ºæˆ‘ä»¬å¸¦æ¥äº†å¦‚æ­¤å¥½ç”¨çš„å·¥å…·ï¼Œå®ƒçš„é«˜æ€§èƒ½å’Œçµæ´»é…ç½®æå¤§åœ°æ–¹ä¾¿äº†æˆ‘ä»¬çš„å¼€å‘å·¥ä½œã€‚å¼€æºçš„ç²¾ç¥è®©æ›´å¤šçš„å¼€å‘è€…å—ç›Šï¼Œå¸Œæœ›èƒ½å¤Ÿæœ‰æ›´å¤šæ­¤ç±»ä¼˜ç§€çš„å¼€æºé¡¹ç›®ç»§ç»­æ¶Œç°ï¼å¼€æºä¸‡å²ï¼</p>
<h2 data-id="heading-10">äº¤æµç¾¤ é£ä¹¦ä¸å¾®ä¿¡å…¬ä¼—å·</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d850b55efd984a80a1769657238a7fbc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737258&amp;x-signature=rhqVlM65oXPDT2ffSPgY5I4cnGg%3D" alt="" loading="lazy"/><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/369036e1d70247b3a27a32630097e988~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Luj56CB5bCP5a2m5YOn:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737258&amp;x-signature=JMR3qGv0bC95doFJZBo9Uds%2BoCY%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Go è¯­è¨€åŸºç¡€å­¦ä¹ æ–‡æ¡£]]></title>    <link>https://juejin.cn/post/7585145251843997711</link>    <guid>https://juejin.cn/post/7585145251843997711</guid>    <pubDate>2025-12-19T08:21:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585145251843997711" data-draft-id="7584991956126711843" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Go è¯­è¨€åŸºç¡€å­¦ä¹ æ–‡æ¡£"/> <meta itemprop="keywords" content="Go"/> <meta itemprop="datePublished" content="2025-12-19T08:21:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å®¾ç‡•å“¥å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/3712397421843598"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Go è¯­è¨€åŸºç¡€å­¦ä¹ æ–‡æ¡£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3712397421843598/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å®¾ç‡•å“¥å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T08:21:15.000Z" title="Fri Dec 19 2025 08:21:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Go è¯­è¨€åŸºç¡€å­¦ä¹ æ–‡æ¡£</h2>
<h3 data-id="heading-1">ä¸€ã€ç¯å¢ƒæ­å»º</h3>
<h4 data-id="heading-2">1.1 ä¸‹è½½ä¸å®‰è£…</h4>
<ul>
<li>**å®˜æ–¹ä¸‹è½½åœ°å€ï¼š**<a href="https://link.juejin.cn?target=https%3A%2F%2Fgolang.org%2Fdl%2F" target="_blank" title="https://golang.org/dl/" ref="nofollow noopener noreferrer">golang.org/dl/</a></li>
<li>**å®˜æ–¹é•œåƒç«™ï¼ˆæ¨èï¼‰ï¼š**<a href="https://link.juejin.cn?target=https%3A%2F%2Fgolang.google.cn%2Fdl%2F" target="_blank" title="https://golang.google.cn/dl/" ref="nofollow noopener noreferrer">golang.google.cn/dl/</a></li>
<li>å®‰è£…æ–¹å¼ï¼šå‚»ç“œå¼å®‰è£…ï¼ˆæŒ‰æç¤ºä¸‹ä¸€æ­¥å³å¯å®Œæˆï¼‰</li>
</ul>
<h4 data-id="heading-3">1.2 å®‰è£…éªŒè¯</h4>
<ol>
<li>
<p><strong>éªŒè¯æœ‰æ²¡æœ‰å®‰è£…æˆåŠŸ</strong></p>
<pre><code class="hljs language-cmd" lang="cmd">go version
</code></pre>
<p>æ‰“å°è¾“å‡ºç±»ä¼¼â€go version go1.24.2 windows/amd64â€œï¼Œè¯´æ˜å®‰è£…æˆåŠŸã€‚</p>
</li>
<li>
<p><strong>æŸ¥çœ‹ Go ç¯å¢ƒ</strong></p>
<pre><code class="hljs language-cmd" lang="cmd">go env
</code></pre>
<blockquote>
<p><strong>Go1.11</strong> ç‰ˆæœ¬ä¹‹åæ— éœ€æ‰‹åŠ¨é…ç½®ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨ <strong>go mod</strong> ç®¡ç†é¡¹ç›®ï¼Œä¹Ÿä¸éœ€è¦éå¾—æŠŠé¡¹ç›®æ”¾åˆ° <strong>GOPATH</strong> ç›®å½•ä¸‹ï¼Œä½ å¯ä»¥åœ¨ä»»æ„ä½ç½®æ–°å»ºé¡¹ç›®ã€‚</p>
<p><strong>Go1.13</strong> ä»¥åå¯ä»¥å½»åº•ä¸è¦ <strong>GOPATH</strong> äº†ã€‚</p>
</blockquote>
</li>
</ol>
<h4 data-id="heading-4">1.3 å¼€å‘å·¥å…·</h4>
<ol>
<li>æ¨èä½¿ç”¨ <strong>VSCode</strong></li>
<li><strong>VSCode</strong> å®‰è£… <strong>Go è¯­è¨€æ’ä»¶</strong>ï¼ˆæ’ä»¶åç§°ï¼šGoï¼‰</li>
</ol>
<h3 data-id="heading-5">äºŒã€åŸºç¡€è¯­æ³•</h3>
<h4 data-id="heading-6">2.1 fmt æ¨¡å—ï¼ˆæ ¼å¼åŒ–è¾“å‡ºï¼‰</h4>
<h5 data-id="heading-7">2.1.1 Print</h5>
<p>ç”¨äºåŸºæœ¬æ‰“å°è¾“å‡ºï¼Œå¤šå‚æ•°æ‰“å°æ— ç©ºæ ¼ã€‚</p>
<pre><code class="hljs language-go" lang="go">fmt.Print(<span class="hljs-string">"a"</span>)
<span class="hljs-comment">// a</span>

fmt.Print(<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>, <span class="hljs-string">"c"</span>)
<span class="hljs-comment">// abc ï¼ˆPS:æ‰“å°å¤šä¸ªæ—¶ï¼Œä¸ä¼šæœ‰ç©ºæ ¼ï¼‰</span>
</code></pre>
<h5 data-id="heading-8">2.1.2 Println</h5>
<p>ç”¨äºæ‰“å°è¾“å‡ºå¹¶æ”¯æŒæ ¼å¼åŒ–ã€‚</p>
<pre><code class="hljs language-go" lang="go">fmt.Println(<span class="hljs-string">"a"</span>)
<span class="hljs-comment">// a</span>
<span class="hljs-comment">// æ¢è¡Œ</span>

fmt.Println(<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>, <span class="hljs-string">"c"</span>)
<span class="hljs-comment">// a b c ï¼ˆPS:æ‰“å°å¤šä¸ªæ—¶ï¼Œä¼šæœ‰ç©ºæ ¼ï¼‰</span>
<span class="hljs-comment">// æ¢è¡Œ</span>
</code></pre>
<h5 data-id="heading-9">2.1.3 Printf</h5>
<p>ç”¨äºæ ¼å¼åŒ–æ‰“å°è¾“å‡ºï¼Œæ”¯æŒå ä½ç¬¦ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>
<span class="hljs-keyword">var</span> b = <span class="hljs-number">2</span>
<span class="hljs-keyword">var</span> c = <span class="hljs-number">3</span>

fmt.Printf(<span class="hljs-string">"a=%v,b=%v,c=%v"</span>, a, b, c)
<span class="hljs-comment">// a=1,b=2,c=3</span>

fmt.Printf(<span class="hljs-string">"a=%v,açš„ç±»å‹æ˜¯%T"</span>, a, a)
<span class="hljs-comment">// a=1,açš„ç±»å‹æ˜¯int</span>
</code></pre>
<h4 data-id="heading-10">2.2 å˜é‡ä¸å¸¸é‡</h4>
<h5 data-id="heading-11">2.2.1 å˜é‡</h5>
<p>å˜é‡æ˜¯ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­å¯ä»¥æ”¹å˜çš„é‡ï¼ŒGo è¯­è¨€æ”¯æŒä¸¤ç§å£°æ˜æ–¹å¼ã€‚</p>
<ol>
<li>
<p><strong>var å˜é‡å£°æ˜æ³•</strong></p>
<ul>
<li>
<p>é€‚ç”¨èŒƒå›´ï¼šå¯ç”¨äºå…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡ã€‚</p>
</li>
<li>
<p>åŸºæœ¬ç”¨æ³•</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// å£°æ˜å˜é‡</span>
<span class="hljs-keyword">var</span> a <span class="hljs-type">string</span>
<span class="hljs-comment">// å˜é‡èµ‹å€¼</span>
a = <span class="hljs-string">"a"</span>

<span class="hljs-comment">// å£°æ˜å˜é‡å¹¶èµ‹å€¼</span>
<span class="hljs-keyword">var</span> a <span class="hljs-type">string</span> = <span class="hljs-string">"a"</span>
<span class="hljs-comment">// å£°æ˜å˜é‡å¹¶èµ‹å€¼ï¼Œç®€å†™ï¼ˆç±»å‹æ¨å¯¼ï¼Œå¯çœç•¥ï¼‰</span>
vat a = <span class="hljs-string">"a"</span>

<span class="hljs-comment">// ä¸€æ¬¡å£°æ˜å¤šä¸ªå˜é‡ï¼ˆå¤šä¸ªå˜é‡çš„ç±»å‹éƒ½ä¸€æ ·ï¼‰</span>
<span class="hljs-keyword">var</span> a, b, c, <span class="hljs-type">string</span>
a = <span class="hljs-string">"a"</span>
b = <span class="hljs-string">"b"</span>
c = <span class="hljs-string">"c"</span>

<span class="hljs-comment">// ä¸€æ¬¡å£°æ˜å¤šä¸ªå˜é‡ï¼Œï¼ˆå¤šä¸ªå˜é‡çš„ç±»å‹å¯ä»¥ä¸ä¸€æ ·ï¼‰</span>
<span class="hljs-keyword">var</span> (
	a <span class="hljs-type">string</span>
	b <span class="hljs-type">int</span>
	c <span class="hljs-type">bool</span>
)

<span class="hljs-comment">// ä¸€æ¬¡å£°æ˜å¤šä¸ªå˜é‡å¹¶èµ‹å€¼</span>
<span class="hljs-keyword">var</span> (
	a <span class="hljs-type">string</span> = <span class="hljs-string">"a"</span>
	b <span class="hljs-type">int</span>    = <span class="hljs-number">1</span>
	c <span class="hljs-type">bool</span>   = <span class="hljs-literal">true</span>
)

<span class="hljs-comment">// ä¸€æ¬¡å£°æ˜å¤šä¸ªå˜é‡å¹¶èµ‹å€¼ï¼Œç®€å†™ï¼ˆç±»å‹æ¨å¯¼ï¼Œå¯çœç•¥ï¼‰</span>
<span class="hljs-keyword">var</span> (
	a = <span class="hljs-string">"a"</span>
	b = <span class="hljs-number">1</span>
	c = <span class="hljs-literal">true</span>
)
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>çŸ­å˜é‡å£°æ˜æ³•</strong></p>
<ul>
<li>
<p>é€‚ç”¨èŒƒå›´ï¼šä»…ç”¨äºå‡½æ•°å†…éƒ¨çš„å±€éƒ¨å˜é‡ã€‚</p>
</li>
<li>
<p>åŸºæœ¬ç”¨æ³•</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// å£°æ˜å˜é‡å¹¶èµ‹å€¼</span>
a := <span class="hljs-string">"a"</span>

<span class="hljs-comment">// ä¸€æ¬¡å£°æ˜å¤šä¸ªå˜é‡å¹¶èµ‹å€¼</span>
a, b, c := <span class="hljs-string">"a"</span>, <span class="hljs-number">1</span>, <span class="hljs-literal">true</span>
</code></pre>
</li>
</ul>
</li>
</ol>
<h5 data-id="heading-12">2.2.2 å¸¸é‡</h5>
<p>å¸¸é‡æ˜¯æ’å®šä¸å˜çš„å€¼ï¼Œå®šä¹‰æ—¶å¿…é¡»èµ‹å€¼ã€‚</p>
<ol>
<li>
<p><strong>const å®šä¹‰å¸¸é‡</strong></p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// å£°æ˜å¸¸é‡å¹¶èµ‹å€¼</span>
<span class="hljs-keyword">const</span> a = <span class="hljs-string">"a"</span>

<span class="hljs-comment">// ä¸€æ¬¡æ€§å£°æ˜å¤šä¸ªå¸¸é‡å¹¶èµ‹å€¼</span>
<span class="hljs-keyword">const</span> (
	a = <span class="hljs-string">"a"</span>
    b = <span class="hljs-string">"b"</span>
)
</code></pre>
</li>
<li>
<p><strong>å¸¸é‡çœç•¥å€¼çš„ç‰¹æ€§</strong></p>
<p>åŒæ—¶å£°æ˜å¤šä¸ªå¸¸é‡æ—¶ï¼Œè‹¥çœç•¥å€¼ï¼Œåˆ™è¡¨ç¤ºå’Œä¸Šä¸€è¡Œçš„å€¼ç›¸åŒã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">const</span> (
	a = <span class="hljs-string">"a"</span>
	b
	c
)
fmt.Printf(<span class="hljs-string">"a = %v, b = %v, c = %v\n"</span>, a, b, c)
<span class="hljs-comment">// a = a, b = a, c = a</span>
</code></pre>
</li>
</ol>
<h4 data-id="heading-13">2.3 æ•°æ®ç±»å‹</h4>
<p>Go è¯­è¨€æ•°æ®ç±»å‹åˆ†ä¸º <strong>åŸºæœ¬æ•°æ®ç±»å‹</strong> å’Œ <strong>å¤åˆæ•°æ®ç±»å‹</strong> ä¸¤å¤§ç±»ã€‚</p>
<ul>
<li>åŸºæœ¬æ•°æ®ç±»å‹ï¼šæ•´å‹ã€æµ®ç‚¹å‹ã€å¸ƒå°”å‹ã€å­—ç¬¦ä¸²</li>
<li>å¤åˆæ•°æ®ç±»å‹ï¼šæ•°ç»„ã€åˆ‡ç‰‡ã€ç»“æ„ä½“ã€å‡½æ•°ã€mapã€é€šé“ï¼ˆchannelï¼‰ã€æ¥å£ç­‰</li>
</ul>
<h5 data-id="heading-14">2.3.1 æ•´å‹ int</h5>
<p>æ•´å‹åˆ†ä¸º <strong>æœ‰ç¬¦å·æ•´å‹</strong> å’Œ <strong>æ— ç¬¦å·æ•´å‹</strong> ä¸¤ç±»ï¼Œä¸åŒç±»å‹å ç”¨å­—èŠ‚æ•°ä¸åŒã€‚</p>
<ol>
<li>
<p><strong>å£°æ˜ç¤ºä¾‹</strong></p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">var</span> num <span class="hljs-type">int</span> = <span class="hljs-number">1</span>
fmt.Printf(<span class="hljs-string">"num=%v,ç±»å‹=%T\n"</span>, num, num)
<span class="hljs-comment">// num=1,ç±»å‹=int</span>
</code></pre>
</li>
<li>
<p><strong>æ•´å‹åˆ†ç±»</strong></p>

























































































<table><thead><tr><th>ç±»å‹</th><th>æœ‰æ— ç¬¦å·</th><th>ä½æ•°</th><th>å–å€¼èŒƒå›´</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>int8</td><td>æœ‰ç¬¦å·</td><td>8</td><td>-128 åˆ° 127ï¼ˆ-2^7åˆ°2^7-1ï¼‰</td><td/></tr><tr><td>int16</td><td>æœ‰ç¬¦å·</td><td>16</td><td>-32768 åˆ° 32767ï¼ˆ-2^15åˆ°2^15-1ï¼‰</td><td/></tr><tr><td>int32</td><td>æœ‰ç¬¦å·</td><td>32</td><td>-2147483648 åˆ° 2147483647ï¼ˆ-2^31åˆ°2^31-1ï¼‰</td><td>åˆ«åï¼šrune</td></tr><tr><td>int64</td><td>æœ‰ç¬¦å·</td><td>64</td><td>-9223372036854775808 åˆ° 9223372036854775807ï¼ˆ-2^63åˆ°2^63-1ï¼‰</td><td/></tr><tr><td>uint8</td><td>æ— ç¬¦å·</td><td>8</td><td>0 åˆ° 255ï¼ˆ0åˆ°2^8-1ï¼‰</td><td>åˆ«åï¼šbyte</td></tr><tr><td>uint16</td><td>æ— ç¬¦å·</td><td>16</td><td>0 åˆ° 65535ï¼ˆ0åˆ°2^16-1ï¼‰</td><td/></tr><tr><td>uint32</td><td>æ— ç¬¦å·</td><td>32</td><td>0 åˆ° 4294967295ï¼ˆ0åˆ°2^32-1ï¼‰</td><td/></tr><tr><td>uint64</td><td>æ— ç¬¦å·</td><td>64</td><td>0 åˆ° 18446744073709551615ï¼ˆ0åˆ°2^64-1ï¼‰</td><td/></tr><tr><td>int</td><td>æœ‰ç¬¦å·</td><td>ç³»ç»Ÿç›¸å…³</td><td>32ä½ç³»ç»ŸåŒint32ï¼Œ64ä½ç³»ç»ŸåŒint64</td><td>æ¨èä¼˜å…ˆä½¿ç”¨</td></tr><tr><td>uint</td><td>æ— ç¬¦å·</td><td>ç³»ç»Ÿç›¸å…³</td><td>32ä½ç³»ç»ŸåŒuint32ï¼Œ64ä½ç³»ç»ŸåŒuint64</td><td/></tr><tr><td>uintptr</td><td>æ— ç¬¦å·</td><td>ç³»ç»Ÿç›¸å…³</td><td>è¶³å¤Ÿå­˜å‚¨æŒ‡é’ˆå€¼çš„æ— ç¬¦å·æ•´æ•°</td><td>ç”¨äºåº•å±‚ç¼–ç¨‹ï¼ˆå¦‚æŒ‡é’ˆæ“ä½œï¼‰</td></tr></tbody></table>
</li>
<li>
<p><strong>æ•´å‹ç±»å‹è½¬æ¢</strong></p>
<p>ä¸åŒæ•´å‹ä¹‹é—´æ— æ³•ç›´æ¥è¿ç®—ï¼Œéœ€è¦å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œé«˜ä½è½¬ä½ä½æ—¶éœ€æ³¨æ„æ•°æ®æº¢å‡ºã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// ä¸åŒç±»å‹ç›´æ¥è¿ç®—æŠ¥é”™</span>
<span class="hljs-keyword">var</span> num1 <span class="hljs-type">int8</span> = <span class="hljs-number">1</span>
<span class="hljs-keyword">var</span> num2 <span class="hljs-type">int16</span> = <span class="hljs-number">1</span>
fmt.Println(num1 + num2) <span class="hljs-comment">// æŠ¥é”™</span>

<span class="hljs-comment">// å¼ºåˆ¶ç±»å‹è½¬æ¢åè¿ç®—</span>
<span class="hljs-keyword">var</span> num1 <span class="hljs-type">int8</span> = <span class="hljs-number">1</span>
<span class="hljs-keyword">var</span> num2 <span class="hljs-type">int16</span> = <span class="hljs-number">1</span>
fmt.Println(<span class="hljs-type">int16</span>(num1) + num2) <span class="hljs-comment">// è¾“å‡ºï¼š2</span>

<span class="hljs-comment">// é«˜ä½è½¬ä½ä½çš„æº¢å‡ºé—®é¢˜</span>
<span class="hljs-keyword">var</span> num1 <span class="hljs-type">int16</span> = <span class="hljs-number">130</span>
fmt.Println(<span class="hljs-type">int8</span>(num1)) <span class="hljs-comment">// è¾“å‡ºï¼š-126</span>
</code></pre>
</li>
<li>
<p><strong>æ•°å­—å­—é¢é‡æ ¼å¼</strong></p>

























<table><thead><tr><th>ç¬¦å·</th><th>æè¿°</th></tr></thead><tbody><tr><td>%d</td><td>è¡¨ç¤ºåè¿›åˆ¶è¾“å‡º</td></tr><tr><td>%b</td><td>è¡¨ç¤ºäºŒè¿›åˆ¶è¾“å‡º</td></tr><tr><td>%o</td><td>è¡¨ç¤ºå…«è¿›åˆ¶è¾“å‡º</td></tr><tr><td>%x</td><td>è¡¨ç¤ºåå…­è¿›åˆ¶è¾“å‡º</td></tr></tbody></table>
<p>ç¤ºä¾‹ä»£ç </p>
<pre><code class="hljs language-go" lang="go">num := <span class="hljs-number">16</span>
fmt.Printf(<span class="hljs-string">"num=%v\n"</span>, num)  <span class="hljs-comment">// è¾“å‡ºï¼šnum=16</span>
fmt.Printf(<span class="hljs-string">"num=%d\n"</span>, num)  <span class="hljs-comment">// è¾“å‡ºï¼šnum=16</span>
fmt.Printf(<span class="hljs-string">"num=%b\n"</span>, num)  <span class="hljs-comment">// è¾“å‡ºï¼šnum=10000</span>
fmt.Printf(<span class="hljs-string">"num=%o\n"</span>, num)  <span class="hljs-comment">// è¾“å‡ºï¼šnum=20</span>
fmt.Printf(<span class="hljs-string">"num=%x\n"</span>, num)  <span class="hljs-comment">// è¾“å‡ºï¼šnum=10</span>
</code></pre>
</li>
<li>
<p><strong>è·å–å˜é‡å ç”¨å­—èŠ‚æ•°</strong></p>
<p>ä½¿ç”¨ <code>unsafe.Sizeof</code> å‡½æ•°å¯ä»¥è¿”å›å˜é‡å ç”¨çš„å­—èŠ‚æ•°ã€‚</p>
<pre><code class="hljs language-go" lang="go">num1 := <span class="hljs-type">int</span>(<span class="hljs-number">1</span>)
num2 := <span class="hljs-type">int8</span>(<span class="hljs-number">1</span>)
num3 := <span class="hljs-type">int16</span>(<span class="hljs-number">1</span>)
num4 := <span class="hljs-type">int32</span>(<span class="hljs-number">1</span>)
num5 := <span class="hljs-type">int64</span>(<span class="hljs-number">1</span>)

fmt.Println(unsafe.Sizeof(num1)) <span class="hljs-comment">// è¾“å‡ºï¼š8</span>
fmt.Println(unsafe.Sizeof(num2)) <span class="hljs-comment">// è¾“å‡ºï¼š1</span>
fmt.Println(unsafe.Sizeof(num3)) <span class="hljs-comment">// è¾“å‡ºï¼š2</span>
fmt.Println(unsafe.Sizeof(num4)) <span class="hljs-comment">// è¾“å‡ºï¼š4</span>
fmt.Println(unsafe.Sizeof(num5)) <span class="hljs-comment">// è¾“å‡ºï¼š8</span>
</code></pre>
</li>
</ol>
<h5 data-id="heading-15">2.3.2 æµ®ç‚¹å‹ float</h5>
<p>Go è¯­è¨€æ”¯æŒä¸¤ç§æµ®ç‚¹å‹ï¼š<code>float32</code> å’Œ <code>float64</code>ã€‚</p>
<ol>
<li>
<p><strong>å£°æ˜ç¤ºä¾‹</strong></p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// ç±»å‹æ¨å¯¼ï¼Œé»˜è®¤æ˜¯float64</span>
num := <span class="hljs-number">3.1415926</span>
fmt.Printf(<span class="hljs-string">"num=%v,ç±»å‹=%T\n"</span>, num, num) <span class="hljs-comment">// è¾“å‡ºï¼šnum=3.1415926,ç±»å‹=float64</span>

<span class="hljs-comment">// æ˜¾å¼å£°æ˜float32</span>
num1 := <span class="hljs-type">float32</span>(<span class="hljs-number">3.1415926</span>)
fmt.Printf(<span class="hljs-string">"num1=%v,ç±»å‹=%T\n"</span>, num1, num1) <span class="hljs-comment">// è¾“å‡ºï¼šnum1=3.1415925,ç±»å‹=float32</span>

<span class="hljs-comment">// æ˜¾å¼å£°æ˜float64</span>
num2 := <span class="hljs-type">float64</span>(<span class="hljs-number">3.1415926</span>)
fmt.Printf(<span class="hljs-string">"num2=%v,ç±»å‹=%T\n"</span>, num2, num2) <span class="hljs-comment">// è¾“å‡ºï¼šnum2=3.1415926,ç±»å‹=float64</span>
</code></pre>
</li>
<li>
<p><strong>æµ®ç‚¹å‹èŒƒå›´</strong></p>
<ul>
<li>
<p><code>float32</code>ï¼šæœ€å¤§èŒƒå›´çº¦ä¸º 3.4e38</p>
</li>
<li>
<p><code>float64</code>ï¼šæœ€å¤§èŒƒå›´çº¦ä¸º 1.8e308</p>
<p>ç¤ºä¾‹ä»£ç </p>
<pre><code class="hljs language-go" lang="go">fmt.Println(math.MaxFloat32) <span class="hljs-comment">// è¾“å‡ºï¼š3.4028234663852886e+38</span>
fmt.Println(math.MaxFloat64) <span class="hljs-comment">// è¾“å‡ºï¼š1.7976931348623157e+308</span>
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>æ ¼å¼åŒ–è¾“å‡º</strong></p>
<p>ä½¿ç”¨ <code>%f</code> å ä½ç¬¦è¾“å‡ºæµ®ç‚¹å‹ï¼Œå¯æŒ‡å®šå°æ•°ä½æ•°ã€‚</p>
<pre><code class="hljs language-go" lang="go">num1 := <span class="hljs-number">3.1415926</span>
fmt.Printf(<span class="hljs-string">"%v\n"</span>, num1)    <span class="hljs-comment">// è¾“å‡ºï¼š3.1415926</span>
fmt.Printf(<span class="hljs-string">"%f\n"</span>, num1)    <span class="hljs-comment">// è¾“å‡ºï¼š3.141593ï¼ˆé»˜è®¤ä¿ç•™6ä½ï¼Œå››èˆäº”å…¥ï¼‰</span>
fmt.Printf(<span class="hljs-string">"%.2f\n"</span>, num1)  <span class="hljs-comment">// è¾“å‡ºï¼š3.14ï¼ˆä¿ç•™2ä½ï¼‰</span>
fmt.Printf(<span class="hljs-string">"%.3f\n"</span>, num1)  <span class="hljs-comment">// è¾“å‡ºï¼š3.142ï¼ˆä¿ç•™3ä½ï¼‰</span>
</code></pre>
</li>
<li>
<p><strong>ç§‘å­¦è®¡æ•°æ³•</strong></p>
<p>æµ®ç‚¹å‹æ”¯æŒç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºã€‚</p>
<pre><code class="hljs language-go" lang="go">num1 := <span class="hljs-number">3.14e2</span>
fmt.Printf(<span class="hljs-string">"num1=%v,ç±»å‹=%T\n"</span>, num1, num1) <span class="hljs-comment">// è¾“å‡ºï¼šnum1=314,ç±»å‹=float64</span>

num2 := <span class="hljs-number">3.14e-2</span>
fmt.Printf(<span class="hljs-string">"num2=%v,ç±»å‹=%T\n"</span>, num2, num2) <span class="hljs-comment">// è¾“å‡ºï¼šnum2=0.0314,ç±»å‹=float64</span>
</code></pre>
</li>
<li>
<p><strong>ç²¾åº¦ä¸¢å¤±é—®é¢˜</strong></p>
<p>äºŒè¿›åˆ¶æµ®ç‚¹æ•°è½¬æ¢ä¸ºåè¿›åˆ¶æ—¶å¯èƒ½å­˜åœ¨ç²¾åº¦ä¸¢å¤±ï¼Œå¯ä½¿ç”¨ç¬¬ä¸‰æ–¹åŒ… <code>github.com/shopspring/decimal</code> è§£å†³ã€‚</p>
<pre><code class="hljs language-go" lang="go">num := <span class="hljs-number">1129.6</span>
fmt.Println(num * <span class="hljs-number">100</span>) <span class="hljs-comment">// è¾“å‡ºï¼š112959.99999999999</span>

num1 := <span class="hljs-number">8.2</span>
num2 := <span class="hljs-number">3.8</span>
fmt.Println(num1 - num2) <span class="hljs-comment">// è¾“å‡ºï¼š4.3999999999999995</span>
</code></pre>
</li>
<li>
<p><strong>æµ®ç‚¹å‹ä¸æ•´å‹è½¬æ¢</strong></p>
<ul>
<li>
<p>æ•´å‹è½¬æµ®ç‚¹å‹ï¼šç›´æ¥å¼ºåˆ¶è½¬æ¢ï¼Œä¸ä¼šä¸¢å¤±æ•°æ®</p>
<pre><code class="hljs language-go" lang="go">num1 := <span class="hljs-number">3</span>
num2 := <span class="hljs-type">float32</span>(num1)
fmt.Printf(<span class="hljs-string">"num2=%v,ç±»å‹=%T\n"</span>, num2, num2) <span class="hljs-comment">// è¾“å‡ºï¼šnum2=3,ç±»å‹=float32</span>

num3 := <span class="hljs-type">float64</span>(num1)
fmt.Printf(<span class="hljs-string">"num3=%v,ç±»å‹=%T\n"</span>, num3, num3) <span class="hljs-comment">// è¾“å‡ºï¼šnum3=3,ç±»å‹=float64</span>
</code></pre>
</li>
<li>
<p>æµ®ç‚¹å‹è½¬æ•´å‹ï¼šå¼ºåˆ¶è½¬æ¢ä¼šä¸¢å¤±å°æ•°éƒ¨åˆ†</p>
<pre><code class="hljs language-go" lang="go">num1 := <span class="hljs-number">3.14</span>
num2 := <span class="hljs-type">int</span>(num1)
fmt.Printf(<span class="hljs-string">"num2=%v,ç±»å‹=%T\n"</span>, num2, num2) <span class="hljs-comment">// è¾“å‡ºï¼šnum2=3,ç±»å‹=int</span>
</code></pre>
</li>
</ul>
</li>
</ol>
<h5 data-id="heading-16">2.3.2 å¸ƒå°”ç±»å‹ bool</h5>
<p>å¸ƒå°”å‹ç”¨ <code>bool</code> è¡¨ç¤ºï¼Œåªæœ‰ <code>true</code> å’Œ <code>false</code> ä¸¤ä¸ªå€¼ã€‚</p>
<ol>
<li>
<p><strong>æ³¨æ„äº‹é¡¹</strong></p>
<ul>
<li>å¸ƒå°”å‹å˜é‡é»˜è®¤å€¼ä¸º <code>false</code></li>
<li>ä¸å…è®¸å°†æ•´å‹å¼ºåˆ¶è½¬æ¢ä¸ºå¸ƒå°”å‹</li>
<li>å¸ƒå°”å‹æ— æ³•å‚ä¸æ•°å€¼è¿ç®—ï¼Œä¹Ÿæ— æ³•ä¸å…¶ä»–ç±»å‹è½¬æ¢</li>
</ul>
</li>
<li>
<p><strong>ç¤ºä¾‹ä»£ç </strong></p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">var</span> flag <span class="hljs-type">bool</span>
fmt.Printf(<span class="hljs-string">"å¸ƒå°”ç±»å‹çš„é»˜è®¤å€¼=%v,ç±»å‹=%T\n"</span>, flag, flag) <span class="hljs-comment">// è¾“å‡ºï¼šå¸ƒå°”ç±»å‹çš„é»˜è®¤å€¼=false,ç±»å‹=bool</span>

num := <span class="hljs-number">1</span>
flag = <span class="hljs-type">bool</span>(num) <span class="hljs-comment">// æŠ¥é”™</span>
<span class="hljs-keyword">if</span> num { <span class="hljs-comment">// æŠ¥é”™</span>
    fmt.Println(<span class="hljs-string">"numä¸ºçœŸ"</span>)
}

str := <span class="hljs-string">"hello"</span>
flag = <span class="hljs-type">bool</span>(str) <span class="hljs-comment">// æŠ¥é”™</span>
<span class="hljs-keyword">if</span> str { <span class="hljs-comment">// æŠ¥é”™</span>
    fmt.Println(<span class="hljs-string">"strä¸ºçœŸ"</span>)
}
</code></pre>
</li>
</ol>
<h5 data-id="heading-17">2.3.4 å­—ç¬¦ä¸²</h5>
<p>å­—ç¬¦ä¸²çš„å€¼ç”¨åŒå¼•å· <code>""</code> æˆ–åå¼•å· <code> ``</code> åŒ…è£¹ã€‚</p>
<ol>
<li>
<p><strong>æ³¨æ„äº‹é¡¹</strong></p>
<ul>
<li>åŒå¼•å·ç”¨äºè¡¨ç¤ºå•è¡Œå­—ç¬¦ä¸²ï¼Œæ”¯æŒè½¬ä¹‰ç¬¦ã€‚</li>
<li>åå¼•å·ç”¨äºè¡¨ç¤ºå¤šè¡Œå­—ç¬¦ä¸²ï¼ŒåŸæ ·è¾“å‡ºå†…å®¹ï¼Œä¸è§£æè½¬ä¹‰ç¬¦ã€‚</li>
<li>å•å¼•å· <code>''</code> ç”¨äºè¡¨ç¤ºå­—ç¬¦ï¼Œè€Œéå­—ç¬¦ä¸²ã€‚</li>
</ul>
</li>
<li>
<p><strong>å­—ç¬¦ä¸²è½¬ä¹‰ç¬¦</strong></p>
<p>å¸¸è§è½¬ä¹‰ç¬¦å¦‚ä¸‹è¡¨ï¼š</p>

































<table><thead><tr><th>è½¬ä¹‰ç¬¦</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>\r</td><td>å›è½¦ç¬¦</td></tr><tr><td>\n</td><td>æ¢è¡Œç¬¦</td></tr><tr><td>\t</td><td>åˆ¶è¡¨ç¬¦</td></tr><tr><td>\'</td><td>å•å¼•å·</td></tr><tr><td>\"</td><td>åŒå¼•å·</td></tr><tr><td>\\</td><td>åæ–œæ </td></tr></tbody></table>
<p>ç¤ºä¾‹ä»£ç </p>
<pre><code class="hljs language-go" lang="go">str := <span class="hljs-string">"mumu: \"hello golang\""</span>
fmt.Println(str) <span class="hljs-comment">// è¾“å‡ºï¼šmumu: "hello golang"</span>
</code></pre>
</li>
<li>
<p><strong>å¤šè¡Œå­—ç¬¦ä¸²</strong></p>
<p><strong>Go</strong> è¯­è¨€ä¸­è¦å®šä¹‰ä¸€ä¸ªå¤šè¡Œå­—ç¬¦ä¸²æ—¶ï¼Œå°±å¿…é¡»ä½¿ç”¨åå¼•å·ã€‚</p>
<pre><code class="hljs language-go" lang="go">multiLine := <span class="hljs-string">`è¿™æ˜¯ç¬¬ä¸€è¡Œ
è¿™æ˜¯ç¬¬äºŒè¡Œ
	è¿™æ˜¯å¸¦ç¼©è¿›çš„ç¬¬ä¸‰è¡Œ
è¿™æ˜¯ç¬¬å››è¡Œ`</span>
	fmt.Println(multiLine)
<span class="hljs-comment">// è¿™æ˜¯ç¬¬ä¸€è¡Œ</span>
<span class="hljs-comment">// è¿™æ˜¯ç¬¬äºŒè¡Œ</span>
<span class="hljs-comment">//         è¿™æ˜¯å¸¦ç¼©è¿›çš„ç¬¬ä¸‰è¡Œ</span>
<span class="hljs-comment">// è¿™æ˜¯ç¬¬å››è¡Œ</span>
</code></pre>
</li>
<li>
<p><strong>å­—ç¬¦ä¸²å¸¸ç”¨çš„æ–¹æ³•</strong></p>




























































<table><thead><tr><th>æ–¹æ³•</th><th>åŠŸèƒ½</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>len(str)</code></td><td>è¿”å›å­—ç¬¦ä¸²å­—èŠ‚æ•°</td><td><code>str := "mumu"; fmt.Println(len(str)) // è¾“å‡ºï¼š4</code></td></tr><tr><td><code>+</code></td><td>æ‹¼æ¥å­—ç¬¦ä¸²</td><td><code>fmt.Println("hello" + " golang") // è¾“å‡ºï¼šhello golang</code></td></tr><tr><td><code>fmt.Sprintf</code></td><td>æ ¼å¼åŒ–æ‹¼æ¥å­—ç¬¦ä¸²</td><td><code>str1:="hello";str2:="golang";str3:=fmt.Sprintf("%v %v",str1,str2) // str3ä¸ºhello golang</code></td></tr><tr><td><code>strings.Split(str, sep)</code></td><td>æŒ‰åˆ†éš”ç¬¦åˆ†å‰²å­—ç¬¦ä¸²ï¼Œè¿”å›åˆ‡ç‰‡</td><td><code>str:="hello golang";arr:=strings.Split(str," ");fmt.Println(arr) // è¾“å‡ºï¼š[hello golang]</code></td></tr><tr><td><code>strings.Join(arr, sep)</code></td><td>å°†åˆ‡ç‰‡æŒ‰åˆ†éš”ç¬¦åˆå¹¶ä¸ºå­—ç¬¦ä¸²</td><td><code>arr:=[]string{"hello","golang"};str:=strings.Join(arr,"-");fmt.Println(str) // è¾“å‡ºï¼šhello-golang</code></td></tr><tr><td><code>strings.Contains(str1, str2)</code></td><td>åˆ¤æ–­ str1 æ˜¯å¦åŒ…å« str2</td><td><code>str1:="hello golang";str2:="ello";fmt.Println(strings.Contains(str1,str2)) // è¾“å‡ºï¼štrue</code></td></tr><tr><td><code>strings.HasPrefix(str1, str2)</code></td><td>åˆ¤æ–­ str1 æ˜¯å¦ä»¥ str2 å¼€å¤´</td><td><code>str1:="hello golang";str2:="hello";fmt.Println(strings.HasPrefix(str1,str2)) // è¾“å‡ºï¼štrue</code></td></tr><tr><td><code>strings.HasSuffix(str1, str2)</code></td><td>åˆ¤æ–­ str1 æ˜¯å¦ä»¥ str2 ç»“å°¾</td><td><code>str1:="hello golang";str2:="golang";fmt.Println(strings.HasSuffix(str1,str2)) // è¾“å‡ºï¼štrue</code></td></tr><tr><td><code>strings.Index(str, substr)</code></td><td>æŸ¥æ‰¾ substr åœ¨ str ä¸­é¦–æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œä¸å­˜åœ¨è¿”å› -1</td><td><code>fmt.Println(strings.Index("hello golang","golang")) // è¾“å‡ºï¼š6</code></td></tr><tr><td><code>strings.LastIndex(str, substr)</code></td><td>æŸ¥æ‰¾ substr åœ¨ str ä¸­æœ€åå‡ºç°çš„ç´¢å¼•ï¼Œä¸å­˜åœ¨è¿”å› -1</td><td><code>fmt.Println(strings.LastIndex("hello golang","an")) // è¾“å‡ºï¼š9</code></td></tr></tbody></table>
</li>
</ol>
<h5 data-id="heading-18">2.3.5 byte &amp; rune</h5>
<p><code>byte</code> å’Œ <code>rune</code> æ˜¯ Go è¯­è¨€ä¸­ç”¨äºè¡¨ç¤ºå­—ç¬¦çš„ä¸“å±ç±»å‹ï¼Œåº•å±‚éƒ½æ˜¯æ•´å‹çš„åˆ«åã€‚</p>
<ol>
<li>
<p><strong>byte ä¸ rune çš„åŒºåˆ«</strong></p>























<table><thead><tr><th>ç±»å‹</th><th>åº•å±‚ç±»å‹</th><th>å ç”¨å­—èŠ‚</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>byte</td><td>uint8</td><td>1</td><td>è¡¨ç¤º ASCII å­—ç¬¦ï¼ˆ0-127 èŒƒå›´ï¼‰</td></tr><tr><td>rune</td><td>int32</td><td>4</td><td>è¡¨ç¤º Unicode å­—ç¬¦ï¼ˆå¦‚ä¸­æ–‡ã€emoji ç­‰ï¼‰</td></tr></tbody></table>
</li>
<li>
<p><strong>å­—ç¬¦ä¸²éå†</strong></p>
<ul>
<li>
<p><strong><code>for i</code> å¾ªç¯éå†ï¼ˆæŒ‰å­—èŠ‚ï¼‰</strong></p>
<p>Go å­—ç¬¦ä¸²åº•å±‚æ˜¯å­—èŠ‚æ•°ç»„ï¼Œ<code>for i</code> å¾ªç¯éå†çš„æ˜¯æ¯ä¸ªå­—èŠ‚çš„å€¼ã€‚</p>
<pre><code class="hljs language-go" lang="go">s := <span class="hljs-string">"Hello ä¸–ç•Œ"</span>
<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">len</span>(s); i++ {
    fmt.Printf(<span class="hljs-string">"%x "</span>, s[i]) <span class="hljs-comment">// è¾“å‡ºï¼š48 65 6c 6c 6f 20 e4 b8 96 e7 95 8c</span>
}
</code></pre>
</li>
<li>
<p><strong><code>for range</code> éå†ï¼ˆæŒ‰ runeï¼‰</strong></p>
<p><code>for range</code> ä¼šè‡ªåŠ¨å°†å­—ç¬¦ä¸²æŒ‰ Unicode å­—ç¬¦æ‹†åˆ†ï¼Œéå†çš„æ˜¯ <code>rune</code> ç±»å‹çš„å€¼ã€‚</p>
<pre><code class="hljs language-go" lang="go">s := <span class="hljs-string">"Hello ä¸–ç•Œ"</span>
<span class="hljs-keyword">for</span> _, r := <span class="hljs-keyword">range</span> s {
    fmt.Printf(<span class="hljs-string">"%c "</span>, r) <span class="hljs-comment">// è¾“å‡ºï¼šH e l l o  ä¸– ç•Œ</span>
}
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>å­—ç¬¦ä¸²é•¿åº¦è®¡ç®—</strong></p>
<ul>
<li>
<p><strong>len (str)ï¼šè¿”å›å­—èŠ‚æ•°</strong></p>
<p>å¯¹äºåŒ…å«å¤šå­—èŠ‚å­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œå­—èŠ‚æ•°å¤§äºå­—ç¬¦æ•°ã€‚</p>
<pre><code class="hljs language-go" lang="go">str:= <span class="hljs-string">"go ä½ å¥½"</span>
fmt.Println(<span class="hljs-built_in">len</span>(str)) <span class="hljs-comment">// è¾“å‡ºï¼š9ï¼ˆgoå 2å­—èŠ‚ï¼Œç©ºæ ¼å 1ï¼Œä½ å¥½å„å 3ï¼Œå…±2+1+3+3=9ï¼‰</span>
</code></pre>
</li>
<li>
<p><strong>len ([] rune (str))ï¼šè¿”å›å­—ç¬¦æ•°</strong></p>
<p>å°†å­—ç¬¦ä¸²è½¬ä¸º <code>rune</code> åˆ‡ç‰‡åï¼Œå†è®¡ç®—é•¿åº¦å³å¯å¾—åˆ°å­—ç¬¦æ•°ã€‚</p>
<pre><code class="hljs language-go" lang="go">str:= <span class="hljs-string">"go ä½ å¥½"</span>
fmt.Println(<span class="hljs-built_in">len</span>([]<span class="hljs-type">rune</span>(str))) <span class="hljs-comment">// è¾“å‡ºï¼š5</span>
</code></pre>
</li>
<li>
<p><strong>utf8.RuneCountInString (str)ï¼šè¿”å›å­—ç¬¦æ•°</strong></p>
<p>ä½¿ç”¨ <code>unicode/utf8</code> åŒ…çš„å‡½æ•°ç›´æ¥è·å–å­—ç¬¦æ•°ã€‚</p>
<pre><code class="hljs language-go" lang="go">str:= <span class="hljs-string">"go ä½ å¥½"</span>
fmt.Println(utf8.RuneCountInString(str)) <span class="hljs-comment">// è¾“å‡ºï¼š5</span>
</code></pre>
</li>
</ul>
</li>
</ol>
<p>æŒç»­æ›´æ–°ä¸­...</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€ä¸ªå®šæ—¶å™¨ï¼Œç†æ¸… JavaScript é‡Œçš„ this]]></title>    <link>https://juejin.cn/post/7585222924566151208</link>    <guid>https://juejin.cn/post/7585222924566151208</guid>    <pubDate>2025-12-19T08:22:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7585222924566151208" data-draft-id="7585146584893128754" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€ä¸ªå®šæ—¶å™¨ï¼Œç†æ¸… JavaScript é‡Œçš„ this"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-19T08:22:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="T___T"/> <meta itemprop="url" content="https://juejin.cn/user/1599155645973066"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€ä¸ªå®šæ—¶å™¨ï¼Œç†æ¸… JavaScript é‡Œçš„ this
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1599155645973066/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    T___T
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-19T08:22:51.000Z" title="Fri Dec 19 2025 08:22:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡å°†ä»æœ€åŸºç¡€çš„å¯¹è±¡æ–¹æ³•ä¸­<code>this</code>çš„æŒ‡å‘è¯´èµ·ï¼Œæ·±å…¥å‰–æå®šæ—¶å™¨ä¸­<code>this</code>â€œä¸å¬è¯â€ çš„åŸå› ï¼Œå†é€ä¸€è®²è§£å‡ ç§å¸¸è§çš„ â€œæ•‘å›<code>this</code>â€ çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ç»å…¸çš„<code>var that = this</code>ã€çµæ´»çš„<code>call/apply</code>ã€å®ç”¨çš„<code>bind</code>ï¼Œä»¥åŠ ES6 ä¸­æ›´ä¼˜é›…çš„ç®­å¤´å‡½æ•°ã€‚é€šè¿‡æ¸…æ™°çš„æ¡ˆä¾‹å¯¹æ¯”å’ŒåŸç†åˆ†æï¼Œå¸®ä½ å½»åº•ç†æ¸…<code>this</code>çš„ç»‘å®šè§„å¾‹ï¼Œä»æ­¤ä¸å†è¢«<code>this</code>çš„æŒ‡å‘é—®é¢˜å›°æ‰°ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ä»æœ€æ™®é€šçš„å¯¹è±¡æ–¹æ³•è¯´èµ·ï¼šthisÂ æŒ‡å‘å½“å‰å¯¹è±¡</h2>
<p>å…ˆä»æœ€æ­£å¸¸çš„åœºæ™¯çœ‹èµ·ï¼šä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢æœ‰ä¸ªæ–¹æ³•ï¼Œæ–¹æ³•é‡Œæ‰“å°Â </p>
<p>thisÂ å’ŒÂ <code>this.name</code>ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Cherry'</span>,
  <span class="hljs-attr">func1</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);
  }
};
obj.<span class="hljs-title function_">func1</span>();
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b2dafc4d2e7c46859c2f53bd40a55b5d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVF9fX1Q=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737371&amp;x-signature=mIUxUjHA%2FrDyeiEMvQBhBaYQ5yQ%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨è¿™ç§<strong>é€šè¿‡â€œå¯¹è±¡.æ–¹æ³•()â€è°ƒç”¨</strong>çš„åœºæ™¯ä¸‹ï¼š</p>
<ul>
<li>thisÂ æŒ‡å‘çš„æ˜¯Â <code>obj</code>Â æœ¬èº«</li>
<li><code>this.name</code>Â å°±æ˜¯Â <code>"Cherry"</code></li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æ˜¯â€œè°ç‚¹å‡ºæ¥çš„å‡½æ•°ï¼Œ</p>
<p>thisÂ ä¸€èˆ¬å°±æŒ‡å‘è°â€ã€‚</p>
<p>è¿™ä¸€ç‚¹å¾ˆå¤šäººéƒ½æ‡‚ï¼ŒçœŸæ­£ä¹±çš„æ˜¯ä¸‹é¢è¿™ç§æƒ…å†µã€‚</p>
<h2 data-id="heading-1">äºŒã€ä¸€è¿›å®šæ—¶å™¨ï¼ŒthisÂ å°±ä¸å¬è¯äº†</h2>
<p>æŠŠä¸Šé¢çš„å¯¹è±¡ç¨å¾®æ”¹ä¸€ä¸‹ï¼šå†åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œé‡Œé¢å¼€ä¸ªå®šæ—¶å™¨ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Cherry'</span>,
  <span class="hljs-attr">func1</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);
  },
  <span class="hljs-attr">func2</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);   <span class="hljs-comment">// è¿™é‡Œçš„ this è¿˜æ˜¯ obj</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// è¿™é‡Œçš„ this æ˜¯è°ï¼Ÿ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">func1</span>();      <span class="hljs-comment">// è¿™é‡Œå¾ˆå¤šäººç¬¬ä¸€ååº”æ˜¯â€œè°ƒç”¨ä¸åˆ°â€</span>
    }, <span class="hljs-number">3000</span>);
  }
};
obj.<span class="hljs-title function_">func2</span>();
</code></pre>
<p>è¿è¡Œä¹‹åä½ ä¼šå‘ç°ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94e7ef26bb8c4ffabea6c5109ab553ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVF9fX1Q=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737371&amp;x-signature=k%2BfKWTnowU9FYepLXTPkKofduaI%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>func2Â é‡Œé¢ç¬¬ä¸€è¡ŒÂ <code>console.log(this)</code>Â æ‰“å°çš„æ˜¯Â <code>obj</code></li>
<li>ä½†æ˜¯å®šæ—¶å™¨å›è°ƒé‡Œçš„Â <code>console.log(this)</code>ï¼Œå´ä¸å†æ˜¯Â <code>obj</code>ï¼Œè€Œæ˜¯å…¨å±€å¯¹è±¡ï¼ˆæµè§ˆå™¨é‡Œæ˜¯Â <code>window</code>ï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹ç”šè‡³å¯èƒ½æ˜¯Â <code>undefined</code>ï¼‰</li>
</ul>
<p>åŸå› æ˜¯ï¼š<strong>è°è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œ</strong></p>
<p><strong>thisÂ å°±æŒ‡å‘è°</strong>ã€‚</p>
<ul>
<li>obj.func2()Â æ˜¯â€œå¯¹è±¡.æ–¹æ³•è°ƒç”¨â€ï¼Œæ‰€ä»¥Â <code>this === obj</code></li>
<li><code>setTimeout</code>Â å›è°ƒæ˜¯â€œæ™®é€šå‡½æ•°è°ƒç”¨â€ï¼ŒçœŸæ­£æ‰§è¡Œæ—¶ç±»ä¼¼Â <code>window.callback()</code>ï¼Œæ‰€ä»¥Â thisÂ åˆå›åˆ°äº†å…¨å±€</li>
</ul>
<p>äºæ˜¯Â </p>
<p>this.func1()Â å°±å‡ºç°äº†å…¸å‹é”™è¯¯ï¼š<br/>
ä½ ä»¥ä¸ºæ˜¯è°ƒç”¨Â obj.func1ï¼Œå®é™…ä¸Šæ˜¯åœ¨å…¨å±€ç¯å¢ƒä¸‹æ‰¾Â func1ã€‚</p>
<h2 data-id="heading-2">ä¸‰ã€ä¸‰ç§å¸¸è§çš„â€œæ•‘å› thisâ€å§¿åŠ¿</h2>
<p>ä¸ºäº†åœ¨å®šæ—¶å™¨é‡Œè¿˜èƒ½æ‹¿åˆ°â€œå¤–å±‚çš„é‚£ä¸ªå¯¹è±¡â€ï¼Œå¸¸è§æœ‰ä¸‰ç§å†™æ³•ã€‚</p>
<h3 data-id="heading-3">1. è€æ´¾å†™æ³•ï¼š<code>var that = this</code></h3>
<p>æœ€æ—©æ¥è§¦åˆ°çš„æ–¹æ¡ˆä¸€èˆ¬æ˜¯è¿™ä¸ªï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Cherry'</span>,
  <span class="hljs-attr">func1</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);
  },
  <span class="hljs-attr">func2</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-keyword">var</span> that = <span class="hljs-variable language_">this</span>;   <span class="hljs-comment">// å…ˆæŠŠå¤–å±‚çš„ this å­˜èµ·æ¥</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);      <span class="hljs-comment">// è¿™é‡Œè¿˜æ˜¯å…¨å±€å¯¹è±¡</span>
      that.<span class="hljs-title function_">func1</span>();           <span class="hljs-comment">// ç”¨ that è°ƒç”¨</span>
    }, <span class="hljs-number">3000</span>);
  }
};
obj.<span class="hljs-title function_">func2</span>();
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e418a6ff1f2d4073947293c336a36859~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVF9fX1Q=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737371&amp;x-signature=mG4mGNomUaDeREwJ0C82w1Lvguw%3D" alt="image.png" loading="lazy"/></p>
<p>æ€è·¯å¾ˆç›´ç™½ï¼š</p>
<ul>
<li>å¤–å±‚Â thisÂ æ˜¯æˆ‘ä»¬æƒ³è¦çš„å¯¹è±¡</li>
<li>å›è°ƒå†…éƒ¨å†ç”¨ä¸€ä¸ªå˜é‡Â <code>that</code>Â æŠŠå®ƒâ€œé—­åŒ…â€ä½</li>
<li>ä¸å†ä¾èµ–å›è°ƒé‡Œçš„Â thisï¼Œè€Œæ˜¯ç”¨Â <code>that</code>Â å»è°ƒç”¨</li>
</ul>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>æ‰€æœ‰ç¯å¢ƒéƒ½æ”¯æŒï¼ŒES5 å°±å¯ä»¥ç”¨<br/>
ç¼ºç‚¹ï¼š</li>
<li>å¯è¯»æ€§ä¸€èˆ¬ï¼Œå¤šå±‚å›è°ƒæ—¶ä¼šå‡ºç°Â <code>that = this</code>Â /Â <code>self = this</code>Â æ»¡å¤©é£</li>
</ul>
<h3 data-id="heading-4">2.Â <code>call</code>Â /Â <code>apply</code>ï¼šç«‹å³æ‰§è¡Œå¹¶æŒ‡å®šÂ this</h3>
<p>ç¬¬äºŒç§æ–¹æ¡ˆæ˜¯åˆ©ç”¨Â <code>Function.prototype.call</code>Â /Â <code>apply</code>ï¼Œå®ƒä»¬æœ‰ä¸¤ä¸ªå…³é”®ç‚¹ï¼š</p>
<ul>
<li>éƒ½æ˜¯<strong>ç«‹å³è°ƒç”¨å‡½æ•°</strong></li>
<li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦ç»‘å®šçš„Â this</li>
</ul>
<p>ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">show</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);
}
<span class="hljs-keyword">var</span> obj = { <span class="hljs-attr">name</span>: <span class="hljs-string">'Cherry'</span> };
<span class="hljs-title function_">show</span>();             <span class="hljs-comment">// this =&gt; window / undefined</span>
show.<span class="hljs-title function_">call</span>(obj);     <span class="hljs-comment">// this =&gt; obj</span>
show.<span class="hljs-title function_">apply</span>(obj);    <span class="hljs-comment">// this =&gt; obj</span>
</code></pre>
<p><code>call</code>Â å’ŒÂ <code>apply</code>Â çš„åŒºåˆ«åªåœ¨äº<strong>ä¼ å‚æ–¹å¼</strong>ï¼š</p>
<ul>
<li><code>call(fnThis, arg1, arg2, ...)</code></li>
<li><code>apply(fnThis, [arg1, arg2, ...])</code></li>
</ul>
<p>åœ¨å’Œå®šæ—¶å™¨ç»“åˆæ—¶ï¼Œæœ‰ä¸€ç§ç¨å¾®â€œç»•â€ä¸€ç‚¹çš„å†™æ³•ï¼Œä¼šå…ˆç”¨Â <code>call</code>Â æ‰§è¡Œä¸€æ¬¡ï¼Œç„¶åæŠŠè¿”å›çš„å‡½æ•°äº¤ç»™å®šæ—¶å™¨ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);  <span class="hljs-comment">// è¿™é‡Œçš„ this è¢« call æˆ obj</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">func1</span>();
  
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);  <span class="hljs-comment">// è¿™ä¸ªå‡½æ•°çœŸæ­£è¢« setTimeout è°ƒç”¨æ—¶ï¼Œthis åˆå›åˆ°å…¨å±€</span>
  };
}.<span class="hljs-title function_">call</span>(obj), <span class="hljs-number">2000</span>);
</code></pre>
<p>åˆ†æä¸€ä¸‹è¿™ä¸ªå†™æ³•çš„æµç¨‹ï¼š</p>
<ul>
<li><code>.call(obj)</code>Â å…ˆ<strong>ç«‹åˆ»æ‰§è¡Œ</strong>è¿™æ®µå‡½æ•°ï¼Œé‡Œé¢çš„Â thisÂ æ˜¯Â <code>obj</code></li>
<li>è¿™ä¸ªå‡½æ•°é‡ŒÂ this.func1()Â èƒ½æ­£å¸¸è°ƒç”¨åˆ°Â obj.func1</li>
<li>å®ƒÂ <code>return</code>Â çš„é‚£ä¸ªå†…éƒ¨å‡½æ•°æ‰æ˜¯çœŸæ­£äº¤ç»™Â <code>setTimeout</code>Â çš„</li>
<li>è¿™ä¸ªå†…éƒ¨å‡½æ•°åœ¨å°†æ¥æ‰§è¡Œæ—¶ï¼Œåˆæ˜¯ä¸€æ¬¡â€œæ™®é€šå‡½æ•°è°ƒç”¨â€ï¼Œäºæ˜¯Â thisÂ å†æ¬¡å›åˆ°å…¨å±€</li>
</ul>
<p>è¿™ç§å†™æ³•å±äºâ€œåˆ©ç”¨Â <code>call</code>Â ç¡¬æ‹‰ä¸€æ¬¡Â </p>
<p>thisÂ è¿‡æ¥â€ï¼Œä½†åœ¨å®é™…é¡¹ç›®é‡Œï¼Œ<strong>æ›´å¸¸è§çš„åšæ³•ä¸æ˜¯è¿™æ ·ç”¨Â <code>call</code>ï¼Œè€Œæ˜¯ç¬¬ä¸‰ç§ï¼š<code>bind</code></strong>ã€‚</p>
<h3 data-id="heading-5">3.Â <code>bind</code>ï¼šå…ˆè®¢å©šï¼Œåç»“å©š</h3>
<p><code>bind</code>Â å’ŒÂ <code>call/apply</code>Â å¾ˆå®¹æ˜“æ··ï¼š</p>
<ul>
<li><code>call/apply</code>ï¼š<strong>é©¬ä¸Šæ‰§è¡Œ</strong>ï¼Œå¹¶ä¸´æ—¶æŒ‡å®šä¸€æ¬¡Â this</li>
<li><code>bind</code>ï¼š<strong>ä¸æ‰§è¡Œ</strong>ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªâ€œthis æ°¸è¿œè¢«ç»‘æ­»â€çš„æ–°å‡½æ•°</li>
</ul>
<p>ç”¨ä¸€ä¸ªç®€å•å¯¹æ¯”çœ‹å·®å¼‚ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Cherry'</span>,
  <span class="hljs-attr">func1</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);
  }
};
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">func1</span>.<span class="hljs-title function_">bind</span>(obj)); <span class="hljs-comment">// æ‰“å°çš„æ˜¯ä¸€ä¸ªæ–°å‡½æ•°</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">func1</span>.<span class="hljs-title function_">call</span>(obj)); <span class="hljs-comment">// æ‰“å°çš„æ˜¯ func1 çš„è¿”å›å€¼ï¼ˆè¿™é‡Œæ˜¯ undefinedï¼‰</span>
<span class="hljs-keyword">const</span> f = obj.<span class="hljs-property">func1</span>.<span class="hljs-title function_">bind</span>(obj);
<span class="hljs-title function_">f</span>(); <span class="hljs-comment">// å§‹ç»ˆä»¥ obj ä½œä¸º this è°ƒç”¨</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/68ec222d2f3e4c539ade13ddbb36b301~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVF9fX1Q=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737371&amp;x-signature=1j0yKGwRpgP3Vt9DKKN%2Bzm11tHk%3D" alt="image.png" loading="lazy"/></p>
<p>å¥—ç”¨ä¸€ä¸ªæ¯”è¾ƒå½¢è±¡çš„è¯´æ³•ï¼š</p>
<ul>
<li><code>call/apply</code>ï¼š<strong>é—ªå©š</strong>ï¼Œå½“åœºæ‹æ¿ï¼Œå‡½æ•°å½“åœºæ‰§è¡Œå®Œäº‹</li>
<li><code>bind</code>ï¼š<strong>å…ˆè®¢å©š</strong>ï¼Œå…ˆçº¦å®šå¥½å°†æ¥çš„Â thisï¼ŒçœŸæ­£ç»“å©šï¼ˆæ‰§è¡Œï¼‰æ˜¯ä»¥å</li>
</ul>
<p>å› æ­¤åœ¨å®šæ—¶å™¨è¿™ç§â€œå°†æ¥æ‰ä¼šæ‰§è¡Œâ€çš„åœºæ™¯ï¼Œ<code>bind</code>Â éå¸¸è‡ªç„¶ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Cherry'</span>,
  <span class="hljs-attr">func1</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);
  },
  <span class="hljs-attr">func2</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">func1</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>), <span class="hljs-number">3000</span>);
  }
};
obj.<span class="hljs-title function_">func2</span>();
</code></pre>
<ul>
<li><code>this.func1.bind(this)</code>Â ç«‹å³è¿”å›äº†ä¸€ä¸ªæ–°å‡½æ•°</li>
<li>è¿™ä¸ªæ–°å‡½æ•°é‡ŒÂ thisÂ è¢«<strong>å›ºå®šæˆå½“å‰å¯¹è±¡</strong></li>
<li><code>setTimeout</code>Â ä¸‰ç§’åå†æ‰§è¡Œå®ƒæ—¶ï¼ŒthisÂ ä¾ç„¶æ˜¯é‚£ä¸ªå¯¹è±¡</li>
</ul>
<p>ç›¸è¾ƒäºÂ <code>that = this</code>Â å’Œâ€œèŠ±é‡Œèƒ¡å“¨çš„ callÂ å†™æ³•â€ï¼Œ<code>bind</code>Â åœ¨è¿™ç§åœºæ™¯ä¸‹æ˜¯æœ€å®¹æ˜“è¯»æ‡‚çš„ä¸€ç§ã€‚</p>
<h2 data-id="heading-6">å››ã€ç®­å¤´å‡½æ•°ï¼šä¸å†åˆ›å»ºè‡ªå·±çš„Â this</h2>
<p>è¿˜æœ‰ä¸€ç§åŠæ³•ï¼Œæ˜¯ç›´æ¥Â **æ”¾å¼ƒå›è°ƒè‡ªå·±çš„Â **</p>
<p><strong>this</strong>ï¼Œè€Œæ˜¯ç”¨å¤–å±‚çš„ã€‚</p>
<p>è¿™å°±æ˜¯ç®­å¤´å‡½æ•°çš„åšæ³•ï¼š<strong>ç®­å¤´å‡½æ•°ä¸ä¼šåˆ›å»ºè‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå®ƒçš„</strong> <strong>thisÂ å®Œå…¨ç»§æ‰¿è‡ªå¤–å±‚ä½œç”¨åŸŸ</strong>ã€‚</p>
<blockquote>
<p>ç®­å¤´å‡½æ•°çš„æ ¸å¿ƒæ˜¯<strong>æ²¡æœ‰è‡ªå·±çš„Â <code>this</code></strong>ï¼Œå®ƒçš„Â <code>this</code>Â æ˜¯<strong>è¯æ³•ç»‘å®š</strong>ï¼ˆå®šä¹‰æ—¶ç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸçš„Â <code>this</code>ï¼‰ï¼Œè€ŒéåŠ¨æ€ç»‘å®šã€‚</p>
</blockquote>
<p>æŠŠå‰é¢çš„å®šæ—¶å™¨æ”¹æˆç®­å¤´å‡½æ•°ç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Cherry'</span>,
  <span class="hljs-attr">func1</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);       <span class="hljs-comment">// obj</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);  <span class="hljs-comment">// Cherry</span>
  },
  <span class="hljs-attr">func2</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);       <span class="hljs-comment">// obj</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);     <span class="hljs-comment">// ä¾ç„¶æ˜¯ obj</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">func1</span>();          <span class="hljs-comment">// ä¹Ÿèƒ½æ­£å¸¸è°ƒç”¨</span>
    }, <span class="hljs-number">3000</span>);
  }
};
obj.<span class="hljs-title function_">func2</span>();
obj.<span class="hljs-title function_">func1</span>();
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a700d4e338ec4b65a26feab9a09c2b82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVF9fX1Q=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737371&amp;x-signature=4Mn69SgKwQbdBLUTA5HV58yYni0%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™é‡Œçš„å…³é”®ç‚¹æ˜¯ï¼š</p>
<ul>
<li>func2Â é‡Œçš„Â thisÂ æ˜¯å¯¹è±¡æœ¬èº«</li>
<li>ç®­å¤´å‡½æ•°çš„Â thisÂ ç›´æ¥æ²¿ç”¨Â func2Â çš„Â this</li>
<li>æ‰€ä»¥åœ¨ç®­å¤´å‡½æ•°é‡Œï¼ŒthisÂ æ²¡æœ‰å‘ç”Ÿâ€œè·³å˜â€ï¼Œå§‹ç»ˆæ˜¯é‚£ä¸ªå¯¹è±¡</li>
</ul>
<p>å†ç»“åˆä¸€ä¸ªç®€å•çš„å¯¹æ¯”ä¾‹å­ï¼Œçœ‹å¾—æ›´æ¸…æ¥šã€‚</p>
<h3 data-id="heading-7">1. æ™®é€šå‡½æ•°å’Œç®­å¤´å‡½æ•°çš„Â thisÂ å¯¹æ¯”</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// æ™®é€šå‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">normal</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);
}
<span class="hljs-comment">// ç®­å¤´å‡½æ•°</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">arrow</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);
};
<span class="hljs-title function_">normal</span>(); <span class="hljs-comment">// éä¸¥æ ¼æ¨¡å¼ä¸‹ this =&gt; window</span>
<span class="hljs-title function_">arrow</span>();  <span class="hljs-comment">// this ç»§æ‰¿è‡ªå®šä¹‰å®ƒæ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸï¼ˆå…¨å±€é‡Œä¸€èˆ¬ä¹Ÿæ˜¯ window / undefinedï¼‰</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3c7c5f7153bb43f1a503a4e24e19c1eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVF9fX1Q=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737371&amp;x-signature=mRwOZ7bHoy6R1bXybfV5eDC4St8%3D" alt="image.png" loading="lazy"/></p>
<p>å†æ³¨æ„ä¸€ä¸ªå¸¸è¢«é—®åˆ°çš„é—®é¢˜ï¼š</p>
<ul>
<li><strong>ç®­å¤´å‡½æ•°ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°ä½¿ç”¨</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸èƒ½Â <code>new</code>Â ä¸€ä¸ªç®­å¤´å‡½æ•°<br/>
åœ¨å®é™…ä»£ç é‡Œï¼Œå¦‚æœä½ å°è¯•Â <code>new func()</code>ï¼ˆfuncÂ æ˜¯ç®­å¤´å‡½æ•°ï¼‰ï¼Œä¼šç›´æ¥æŠ¥é”™</li>
</ul>
<h3 data-id="heading-8">2. é¡¶å±‚ç®­å¤´å‡½æ•°çš„Â this</h3>
<p>åœ¨æ™®é€šè„šæœ¬é‡Œï¼Œå¦‚æœå†™ä¸€ä¸ªé¡¶å±‚ç®­å¤´å‡½æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">func</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);
};
<span class="hljs-title function_">func</span>();
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1dea99a14b5843cfa2e3fa5ca54f36d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVF9fX1Q=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737371&amp;x-signature=IS3BujGabuK9w1AxxA6%2BKDCz2AQ%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™é‡Œçš„Â </p>
<p>thisÂ ç»§æ‰¿è‡ªé¡¶å±‚ä½œç”¨åŸŸï¼š</p>
<ul>
<li>æµè§ˆå™¨éæ¨¡å—è„šæœ¬ä¸­ï¼Œä¸€èˆ¬æ˜¯Â <code>window</code></li>
<li>ä¸¥æ ¼æ¨¡å¼ / ES æ¨¡å—ä¸­ï¼Œé¡¶å±‚Â thisÂ å¾€å¾€æ˜¯Â <code>undefined</code></li>
</ul>
<p>è¿™ä¹Ÿå†æ¬¡è¯´æ˜ï¼šç®­å¤´å‡½æ•°çš„Â </p>
<p>thisÂ å®Œå…¨å–å†³äº<strong>å®ƒè¢«å®šä¹‰æ—¶æ‰€å¤„çš„ç¯å¢ƒ</strong>ï¼Œè€Œä¸æ˜¯è¢«è°è°ƒç”¨ã€‚</p>
<h3 data-id="heading-9">3. ç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸçš„Â this</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Cherry'</span>,
  <span class="hljs-attr">func</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {          <span class="hljs-comment">// æ™®é€šå‡½æ•°ï¼Œthis === obj</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤–å±‚ thisï¼š'</span>, <span class="hljs-variable language_">this</span>);
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {         <span class="hljs-comment">// ç®­å¤´å‡½æ•°ï¼Œthis ç»§æ‰¿å¤–å±‚</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç®­å¤´å‡½æ•° thisï¼š'</span>, <span class="hljs-variable language_">this</span>);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'nameï¼š'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);
    }, <span class="hljs-number">1000</span>);
  }
};
obj.<span class="hljs-title function_">func</span>();
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0ab842e366941d58aeb6d5e3d98d23f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgVF9fX1Q=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766737371&amp;x-signature=7AL9lWMeDUWaPS5uJYDfS%2BqscAk%3D" alt="image.png" loading="lazy"/></p>
<p>æŠŠ setTimeout é‡Œçš„ç®­å¤´å‡½æ•°æ¢æˆæ™®é€šå‡½æ•°ï¼Œthis ä¼šä¸¢å¤±</p>
<blockquote>
<p><strong><code>setTimeout</code>Â ä¸­çš„å›è°ƒå‡½æ•°æ˜¯è¢« JavaScript å¼•æ“ â€œç‹¬ç«‹è°ƒç”¨â€ çš„ï¼Œè€Œéä½œä¸ºæŸä¸ªå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨</strong>ã€‚</p>
</blockquote>
<h2 data-id="heading-10">äº”ã€å°ç»“ &amp; ä½¿ç”¨å»ºè®®</h2>
<p>æŠŠä¸Šé¢çš„å†…å®¹ä¸²ä¸€ä¸‹ï¼Œå¯ä»¥å¾—åˆ°è¿™æ ·ä¸€ä»½â€œé€Ÿè®°è¡¨â€ï¼š</p>
<ul>
<li>
<hr/>
<p><strong>thisÂ çš„åŸºç¡€è§„å¾‹</strong></p>
<ul>
<li><strong>è°è°ƒç”¨ï¼ŒæŒ‡å‘è°</strong>ï¼š<code>obj.method()</code>Â é‡ŒÂ <code>this === obj</code></li>
<li>æ™®é€šå‡½æ•°ç›´æ¥è°ƒç”¨ï¼š<code>fn()</code>Â é‡ŒÂ thisÂ æ˜¯å…¨å±€å¯¹è±¡ /Â <code>undefined</code>ï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰</li>
</ul>
</li>
<li>
<p><strong><code>setTimeout</code> / å›è°ƒé‡Œçš„</strong></p>
<p><strong>this</strong></p>
<ul>
<li>å›è°ƒæ˜¯æ™®é€šå‡½æ•°è°ƒç”¨ï¼ŒthisÂ é»˜è®¤æŒ‡å‘å…¨å±€</li>
<li>æ‰€ä»¥åœ¨å¯¹è±¡æ–¹æ³•é‡Œç›´æ¥å†™Â <code>setTimeout(function () { this.xxx })</code>ï¼Œå¾€å¾€æ‹¿ä¸åˆ°æˆ‘ä»¬æƒ³è¦çš„å¯¹è±¡</li>
</ul>
</li>
<li>
<p><strong>ä¸‰ç§ä¿®å¤æ–¹å¼çš„å¯¹æ¯”</strong></p>
<ul>
<li>
<p><strong><code>var that = this</code></strong></p>
<ul>
<li>åˆ©ç”¨é—­åŒ…ä¿å­˜å¤–å±‚Â this</li>
<li>å…¼å®¹æœ€å¥½ï¼Œä½†ä»£ç ç•¥æ˜¾â€œè€æ´¾â€</li>
</ul>
</li>
<li>
<p><strong><code>call/apply</code></strong></p>
<ul>
<li>ç«‹å³æ‰§è¡Œå‡½æ•°</li>
<li>ç¬¬ä¸€ä¸ªå‚æ•°ç”¨æ¥æŒ‡å®šÂ this</li>
<li>é€‚åˆâ€œå½“åœºå°±è¦æ‰§è¡Œä¸€æ¬¡â€çš„åœºæ™¯</li>
</ul>
</li>
<li>
<p><strong><code>bind</code></strong></p>
<ul>
<li>è¿”å›â€œthis è¢«é”æ­»â€çš„æ–°å‡½æ•°ï¼Œè€Œä¸æ˜¯ç«‹å³æ‰§è¡Œ</li>
<li>éå¸¸é€‚åˆâ€œå®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬ã€å›è°ƒâ€è¿™äº›â€œç¨åå†æ‰§è¡Œâ€çš„æƒ…å½¢</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>ç®­å¤´å‡½æ•°</strong></p>
<ul>
<li>ä¸åˆ›å»ºè‡ªå·±çš„Â thisï¼Œåªç»§æ‰¿å¤–å±‚</li>
<li>åœ¨å¯¹è±¡æ–¹æ³•ä¸­é…åˆå›è°ƒä½¿ç”¨ï¼Œèƒ½æœ‰æ•ˆé¿å…Â thisÂ è·³æ¥è·³å»</li>
<li>ä¸é€‚åˆä½œä¸ºæ„é€ å‡½æ•°ï¼ˆä¸èƒ½Â <code>new</code>ï¼‰</li>
</ul>
</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>