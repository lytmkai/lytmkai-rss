<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[ä¸ºä»€ä¹ˆæ¯æ¬¡æ‰“å¼€ ArcGIS Pro é¡µé¢åŠ è½½éƒ½å¦‚æ­¤ç¼“æ…¢ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7595994039108861988</link>    <guid>https://juejin.cn/post/7595994039108861988</guid>    <pubDate>2026-01-17T13:33:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595994039108861988" data-draft-id="7596025264455581732" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆæ¯æ¬¡æ‰“å¼€ ArcGIS Pro é¡µé¢åŠ è½½éƒ½å¦‚æ­¤ç¼“æ…¢ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-17T13:33:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="GISä¹‹è·¯"/> <meta itemprop="url" content="https://juejin.cn/user/4346787284915481"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆæ¯æ¬¡æ‰“å¼€ ArcGIS Pro é¡µé¢åŠ è½½éƒ½å¦‚æ­¤ç¼“æ…¢ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4346787284915481/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    GISä¹‹è·¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T13:33:22.000Z" title="Sat Jan 17 2026 13:33:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">^Â å…³æ³¨æˆ‘ï¼Œå¸¦ä½ ä¸€èµ·å­¦GISÂ ^</h2>
<p>å¤§å®¶æœ‰æ²¡æœ‰è¿™ç§ç»å†ï¼Œæ¯æ¬¡æ–°å»ºæˆ–è€…æ‰“å¼€ä¸€ä¸ªå·²æœ‰çš„<code>ArcGIS Pro</code>å·¥ç¨‹çš„è¯ï¼Œåœ¨åŠ è½½åœºæ™¯é¡µé¢éƒ½è¦ç­‰å¾…å¾ˆé•¿æ—¶é—´ï¼Œè¿™æ— ç–‘å¯¹ä½¿ç”¨ä½“éªŒé€ æˆéå¸¸ä¸å¥½çš„å½±å“ã€‚</p>
<p>é¦–å…ˆéœ€è¦æ£€æŸ¥ä¸€ä¸‹ç”µè„‘é…ç½®ï¼Œå¦‚æœä½ çš„ç”µè„‘è¿è¡Œå†…å­˜ç¨å¾®ä½ä¸€ç‚¹ï¼Œæ˜¾å¡ä¹Ÿä¸å¤ªç»™åŠ›ï¼Œå¯¹è½¯ä»¶è¿è¡Œä¼šé€ æˆä¸€å®šå½±å“ã€‚</p>
<p>å¯è®¿é—®<code>ESRI</code>ç½‘ç«™æŸ¥çœ‹é…ç½®éœ€æ±‚ã€‚<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/628c22adb13d4a9f9b7db994d4d02662~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769261602&amp;x-signature=ob37WJtamryyONRKm7jBZa43fo0%3D" alt="" loading="lazy"/></p>
<p>è®¿é—®å¦‚ä¸‹åœ°å€ï¼Œå¯æ£€æµ‹æœ¬æœºè¿è¡Œç¯å¢ƒã€‚</p>
<p><code>https://www.systemrequirementslab.com/client-app?refid=1256&amp;appkey=6D681CD0-BA6C-4B6B-9A82-639759CFD094&amp;requirementsetid=23091</code></p>
<p>æ ‡è¯†<code>ArcGIS Pro</code>ç‰ˆæœ¬ä¸º3.3åˆ°3.6ï¼Œæˆ‘æœ¬æœºçš„æ˜¯3.5ã€‚<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91d861b2567f408f9ac94948dadff0d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769261602&amp;x-signature=d5wIO58FPfCMpVk10j3oMRlUKKE%3D" alt="" loading="lazy"/></p>
<p>å¥½å§ï¼Œè™½ç„¶Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·ï¼Œä½†æ˜¯æˆ‘çš„ç”µè„‘æ²¡è¿è¡Œå‡ºç»“æœï¼Œæˆ–è€…è¯´æ£€æµ‹å‡ºé”™äº†ï¼Œä¼°è®¡æ˜¯ä¸ª<code>bug</code>ã€‚<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7e2a5276aef5466382016e254c823c9b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769261602&amp;x-signature=H%2BhilOrv7T4sKeZf4m49u9DQe0E%3D" alt="" loading="lazy"/>æœ‰å®Œæ•´è¿è¡Œç»“æœçš„åŒå­¦å¯ä»¥æˆªå›¾çœ‹ä¸€ä¸‹ã€‚</p>
<p>ç”µè„‘é…ç½®è¿™å…³è¿‡äº†çš„è¯ï¼Œå’±ä¹ˆå¯ä»¥è¿›è¡Œè½¯ä»¶è®¾ç½®äº†ã€‚</p>
<p>æˆ‘çš„ä¸»è¦é—®é¢˜æ˜¯æ¯æ¬¡æ–°å»ºå·¥ç¨‹æˆ–è€…æ‰“å¼€åŸæœ‰å·¥ç¨‹ï¼Œåˆ›å»ºåœºæ™¯çš„æ—¶é—´éƒ½å¾ˆæ¼«é•¿ï¼ˆåº•å›¾æ²¡è¢«å°ä¹‹å‰å°±åŠ è½½ç¼“æ…¢ï¼‰ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ç½‘ç»œçš„åŸå› ã€‚</p>
<p>ä½†æˆ‘çš„éœ€æ±‚å…¶å®ä¸éœ€è¦ä¸€å¼€å§‹å°±æ·»åŠ ä¸€ä¸ªå®Œæ•´çš„åº•å›¾ï¼ŒåŒ…æ‹¬åœ°å½¢ã€å½±åƒæˆ–è€…çŸ¢é‡ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘åªéœ€è¦ä¸€ä¸ªç©ºç™½å·¥ç¨‹å°±å¯ä»¥äº†ï¼Œæ‰€ä»¥æˆ‘çš„è§£å†³åŠæ³•æ˜¯åœ¨è®¾ç½®é‡Œé¢å°†é»˜è®¤åŠ è½½åº•å›¾å»é™¤ã€‚</p>
<p>é¦–å…ˆï¼Œæ‰“å¼€è®¾ç½®é€‰é¡¹<code>Options</code>ã€‚<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3bdb2fcc55f5447b9bb2c11acf40ad5a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769261602&amp;x-signature=s%2BM06sB0%2FQRPpSTgdaBfPaQxpEE%3D" alt="" loading="lazy"/></p>
<p>ç„¶åæ‰¾åˆ°<code>Map and Scene</code>ï¼Œåœ¨å³ä¾§å°†<code>Map</code>é¡¹å’Œ<code>Scene</code>é¡¹ä¿®æ”¹ä¸º<code>None</code>ï¼Œä¹Ÿå°±æ˜¯é»˜è®¤ä¸åŠ è½½åº•å›¾ã€‚<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41077acacc4e4e4eb71d7dce57d7b1b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769261602&amp;x-signature=addYSno54FbBdGrmc1AIOEtDbZY%3D" alt="" loading="lazy"/></p>
<p>ç»è¿‡æ­¤æ­¥éª¤ä¹‹åï¼Œæˆ‘å†æ‰“å¼€<code>ArcGIS Pro</code>é‚£å°±èˆ’æœå¤šäº†ã€‚</p>
<p><strong><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b3e8a07e2fc4b05ac6fab2283399a72~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769261602&amp;x-signature=EzrV7HZdxUjpc%2Bd7sKh1awPkPY4%3D" alt="" loading="lazy"/></strong></p>
<blockquote>
<p>â</p>
<p>OpenLayersç¤ºä¾‹æ•°æ®ä¸‹è½½ï¼Œè¯·åœ¨å…¬ä¼—å·åå°å›å¤ï¼š<strong>vector</strong></p>
<p>å…¨å›½ä¿¡æ¯åŒ–å·¥ç¨‹å¸ˆï¼GIS åº”ç”¨æ°´å¹³è€ƒè¯•èµ„æ–™ï¼Œè¯·åœ¨å…¬ä¼—å·åå°å›å¤ï¼š<strong>GISè€ƒè¯•</strong></p>
</blockquote>
<blockquote>
<p>â</p>
<p><em><strong>GISä¹‹è·¯</strong></em> å…¬ä¼—å·å·²ç»æ¥å…¥äº†<strong>æ™ºèƒ½</strong> <strong>åŠ©æ‰‹</strong>ï¼Œå¯ä»¥åœ¨å¯¹è¯æ¡†è¿›è¡Œæé—®ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æœç´¢å†å²æ–‡ç« è¿›è¡ŒæŸ¥çœ‹ã€‚</p>
</blockquote>
<p>éƒ½çœ‹åˆ°è¿™äº†ï¼Œä¸è¦å¿˜è®°<em><strong>ç‚¹èµã€æ”¶è—</strong></em> <strong>+</strong> <em><strong>å…³æ³¨</strong></em> å“¦ <strong>ï¼</strong></p>
<p>æœ¬å·ä¸å®šæ—¶æ›´æ–°æœ‰å…³Â <em><strong>GISå¼€å‘</strong></em> ç›¸å…³å†…å®¹ï¼Œ<em><strong>æ¬¢è¿å…³æ³¨Â <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03e439ae87384734a48383956f4cdfa8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769261602&amp;x-signature=pRYo%2FG6AxkjWzKrfjNwuw2OCjYs%3D" alt="" loading="lazy"/><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3b0bebb588f4086be4dbdf15a4aaa51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769261602&amp;x-signature=vy75MPdVP3hRQgBWxS5rHqtslh8%3D" alt="" loading="lazy"/></strong></em></p>
<hr/>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/185d313dc123458e820c445972f6ce3c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769261602&amp;x-signature=zWlsfqqtDA9NXTfauJzQHL9jl2s%3D" alt="" loading="lazy"/></p>
<p>Â  Â <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98596a98205f42a3acfa4cdbcdc07666~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769261602&amp;x-signature=6z1DpmGs%2BgdmgMgQoGvRdcD7Qsw%3D" alt="" loading="lazy"/>Â </p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwOTEzNjI5NQ%3D%3D%26mid%3D2247487953%26idx%3D1%26sn%3D0b2d5aeefdb290583cf8cdd82f3c2077%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwOTEzNjI5NQ==&amp;mid=2247487953&amp;idx=1&amp;sn=0b2d5aeefdb290583cf8cdd82f3c2077&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">GeoTools å¼€å‘åˆé›†ï¼ˆå…¨ï¼‰</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwOTEzNjI5NQ%3D%3D%26mid%3D2247487119%26idx%3D1%26sn%3Dc313efa84c27bf933ef2f2a47991ef2d%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwOTEzNjI5NQ==&amp;mid=2247487119&amp;idx=1&amp;sn=c313efa84c27bf933ef2f2a47991ef2d&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">OpenLayers å¼€å‘åˆé›†</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FhBXfq6zRK9twSicMXw69jw" target="_blank" title="https://mp.weixin.qq.com/s/hBXfq6zRK9twSicMXw69jw" ref="nofollow noopener noreferrer">ArcGIS Pro å®ç°å½±åƒæ³¢æ®µåˆæˆ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FQVFiW5C5wXQ6a1WODCaH0g" target="_blank" title="https://mp.weixin.qq.com/s/QVFiW5C5wXQ6a1WODCaH0g" ref="nofollow noopener noreferrer">è‡ªç„¶èµ„æºéƒ¨å…šç»„å…³äºè‹—æ³½ç­‰4ååŒå¿—èŒåŠ¡ä»»å…çš„é€šçŸ¥</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FJmv3J_bjbBG-4jB72zS3hw" target="_blank" title="https://mp.weixin.qq.com/s/Jmv3J_bjbBG-4jB72zS3hw" ref="nofollow noopener noreferrer">GDAL åˆ›å»ºçŸ¢é‡å›¾å±‚çš„ä¸¤ç§æ–¹å¼</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fi77nCatd4V2nuybZFIs-xA" target="_blank" title="https://mp.weixin.qq.com/s/i77nCatd4V2nuybZFIs-xA" ref="nofollow noopener noreferrer">GDAL æ•°æ®ç±»å‹å¤§å…¨</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FwkHv2NnJfuPhtyjJcFLrEQ" target="_blank" title="https://mp.weixin.qq.com/s/wkHv2NnJfuPhtyjJcFLrEQ" ref="nofollow noopener noreferrer">GDAL å®ç°çŸ¢é‡æ•°æ®è½¬æ¢å¤„ç†ï¼ˆå…¨ï¼‰</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FMZIQ57Ka3NQfKFi9AuEQEg" target="_blank" title="https://mp.weixin.qq.com/s/MZIQ57Ka3NQfKFi9AuEQEg" ref="nofollow noopener noreferrer">GDAL å®ç°æŠ•å½±è½¬æ¢</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FSX2u2ww1iNOtqR5m3BE93g" target="_blank" title="https://mp.weixin.qq.com/s/SX2u2ww1iNOtqR5m3BE93g" ref="nofollow noopener noreferrer">å›½äº§ç‰ˆçš„Google Earthï¼Œå‰æ—ä¸€å·å«æ˜ŸAppâ€œå…±ç”Ÿåœ°çƒâ€æ¥äº†</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FfWufqSyplniNj4Q3BRRbAQ" target="_blank" title="https://mp.weixin.qq.com/s/fWufqSyplniNj4Q3BRRbAQ" ref="nofollow noopener noreferrer">2026å¹´å…¨å›½è‡ªç„¶èµ„æºå·¥ä½œä¼šè®®å¬å¼€</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FRq7mCSrKU7DA7WRGDEy6Cg" target="_blank" title="https://mp.weixin.qq.com/s/Rq7mCSrKU7DA7WRGDEy6Cg" ref="nofollow noopener noreferrer">æ—¥æœ¬æ¬²æ‰“é€ â€œæœ¬åœŸç‰ˆâ€æ˜Ÿé“¾ç³»ç»Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FEqpOD--IdOUO6gyzwBc6RA" target="_blank" title="https://mp.weixin.qq.com/s/EqpOD--IdOUO6gyzwBc6RA" ref="nofollow noopener noreferrer">å‰æ—ä¸€å·å›½å†…é¦–å¼ é«˜åˆ†è¾¨ç‡å½©è‰²å¤œå…‰å«æ˜Ÿå½±åƒå‘å¸ƒ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FznfhqB1_3JbQHG7CEqWSCw" target="_blank" title="https://mp.weixin.qq.com/s/znfhqB1_3JbQHG7CEqWSCw" ref="nofollow noopener noreferrer">2025 å¹´åº¦ä¿¡åˆ›é¢†å†›ä¼ä¸šåå•å‡ºç‚‰ï¼</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RabbitMQ åœ¨ Celery ä¸­æ‰®æ¼”è§’è‰²ä»‹ç»]]></title>    <link>https://juejin.cn/post/7595878718172135460</link>    <guid>https://juejin.cn/post/7595878718172135460</guid>    <pubDate>2026-01-17T13:36:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595878718172135460" data-draft-id="7596025264455614500" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RabbitMQ åœ¨ Celery ä¸­æ‰®æ¼”è§’è‰²ä»‹ç»"/> <meta itemprop="keywords" content="RabbitMQ"/> <meta itemprop="datePublished" content="2026-01-17T13:36:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆé‡Œè°¢é¡¿"/> <meta itemprop="url" content="https://juejin.cn/user/3678304397695056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RabbitMQ åœ¨ Celery ä¸­æ‰®æ¼”è§’è‰²ä»‹ç»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3678304397695056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆé‡Œè°¢é¡¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T13:36:56.000Z" title="Sat Jan 17 2026 13:36:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>RabbitMQ åœ¨ Celery ä¸­æ‰®æ¼” <strong>æ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆMessage Brokerï¼‰</strong> çš„æ ¸å¿ƒè§’è‰²ï¼Œè´Ÿè´£åœ¨ <strong>ä»»åŠ¡ç”Ÿäº§è€…ï¼ˆProducerï¼‰</strong> å’Œ <strong>ä»»åŠ¡æ¶ˆè´¹è€…ï¼ˆWorkerï¼‰</strong> ä¹‹é—´<strong>å¯é åœ°ä¼ é€’ä»»åŠ¡æ¶ˆæ¯</strong>ã€‚å®ƒæ˜¯ Celery å®ç°<strong>å¼‚æ­¥ä»»åŠ¡ã€åˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ—ã€å®šæ—¶ä»»åŠ¡</strong>çš„åŸºç¡€è®¾æ–½ã€‚</p>
<p>ä¸‹é¢é€šè¿‡ <strong>åŸç†è¯¦è§£ + å›¾ç¤º + ä»£ç ç¤ºä¾‹</strong> å…¨é¢è§£æã€‚</p>
<hr/>
<h2 data-id="heading-0">ğŸ§  ä¸€ã€æ ¸å¿ƒè§’è‰²ä¸æµç¨‹</h2>
<h3 data-id="heading-1">1. <strong>å››å¤§æ ¸å¿ƒç»„ä»¶</strong></h3>






























<table><thead><tr><th>ç»„ä»¶</th><th>ä½œç”¨</th><th>ç±»æ¯”</th></tr></thead><tbody><tr><td><strong>Clientï¼ˆç”Ÿäº§è€…ï¼‰</strong></td><td>å‘é€ä»»åŠ¡åˆ° Broker</td><td>é¤å…é¡¾å®¢ï¼ˆç‚¹èœï¼‰</td></tr><tr><td><strong>Brokerï¼ˆRabbitMQï¼‰</strong></td><td>æ¥æ”¶ã€å­˜å‚¨ã€è½¬å‘ä»»åŠ¡æ¶ˆæ¯</td><td>é¤å…ä¼ èœç³»ç»Ÿï¼ˆè®¢å•æ± ï¼‰</td></tr><tr><td><strong>Workerï¼ˆæ¶ˆè´¹è€…ï¼‰</strong></td><td>ä» Broker è·å–ä»»åŠ¡å¹¶æ‰§è¡Œ</td><td>å¨å¸ˆï¼ˆåšèœï¼‰</td></tr><tr><td><strong>Result Backendï¼ˆå¯é€‰ï¼‰</strong></td><td>å­˜å‚¨ä»»åŠ¡æ‰§è¡Œç»“æœï¼ˆå¦‚ Redisï¼‰</td><td>ä¸Šèœè®°å½•æœ¬</td></tr></tbody></table>
<blockquote>
<p>âœ… <strong>RabbitMQ çš„æ ¸å¿ƒèŒè´£ï¼šè§£è€¦ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼Œå®ç°å¼‚æ­¥é€šä¿¡</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-2">ğŸ–¼ï¸ äºŒã€å·¥ä½œæµç¨‹å›¾è§£</h2>
<pre><code class="hljs language-css" lang="css">graph LR
    <span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[Client\n(ä»»åŠ¡ç”Ÿäº§è€…)]</span> --&gt;|<span class="hljs-number">1</span>. å‘é€ä»»åŠ¡| <span class="hljs-selector-tag">B</span>(RabbitMQ\nBroker)
    <span class="hljs-selector-tag">B</span> --&gt;|<span class="hljs-number">2</span>. å­˜å‚¨ä»»åŠ¡åˆ° Queue| C<span class="hljs-selector-attr">[Queue: default]</span>
    D<span class="hljs-selector-attr">[Worker 1]</span> --&gt;|<span class="hljs-number">3</span>. æ‹‰å–ä»»åŠ¡| C
    E<span class="hljs-selector-attr">[Worker 2]</span> --&gt;|<span class="hljs-number">3</span>. æ‹‰å–ä»»åŠ¡| C
    F<span class="hljs-selector-attr">[Worker N]</span> --&gt;|<span class="hljs-number">3</span>. æ‹‰å–ä»»åŠ¡| C
    D --&gt;|<span class="hljs-number">4</span>. æ‰§è¡Œä»»åŠ¡| G
    E --&gt;|<span class="hljs-number">4</span>. æ‰§è¡Œä»»åŠ¡| G
    F --&gt;|<span class="hljs-number">4</span>. æ‰§è¡Œä»»åŠ¡| G
    <span class="hljs-selector-tag">A</span> --&gt;|<span class="hljs-number">5</span>. æŸ¥è¯¢ç»“æœ| G
</code></pre>
<h3 data-id="heading-3">ğŸ” è¯¦ç»†æ­¥éª¤ï¼š</h3>
<ol>
<li><strong>Client</strong> è°ƒç”¨ <code>add.delay(2, 3)</code>ï¼ŒCelery å°†ä»»åŠ¡åºåˆ—åŒ–ä¸ºæ¶ˆæ¯ï¼›</li>
<li>æ¶ˆæ¯å‘é€åˆ° <strong>RabbitMQ</strong>ï¼Œå­˜å…¥æŒ‡å®šçš„ <strong>Queue</strong>ï¼ˆå¦‚ <code>celery</code>ï¼‰ï¼›</li>
<li><strong>å¤šä¸ª Worker</strong> ç›‘å¬è¯¥ Queueï¼Œç«äº‰æ¶ˆè´¹ä»»åŠ¡ï¼ˆè´Ÿè½½å‡è¡¡ï¼‰ï¼›</li>
<li>Worker æ‰§è¡Œä»»åŠ¡å‡½æ•°ï¼Œå°†ç»“æœå­˜å…¥ <strong>Result Backend</strong>ï¼›</li>
<li>Client å¯é€šè¿‡ <code>result.get()</code> ä» Result Backend è·å–ç»“æœã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-4">âš™ï¸ ä¸‰ã€RabbitMQ åœ¨ Celery ä¸­çš„å…·ä½“ä½œç”¨</h2>
<h3 data-id="heading-5">1. <strong>ä»»åŠ¡è·¯ç”±ï¼ˆRoutingï¼‰</strong></h3>
<ul>
<li>
<p>é€šè¿‡ <strong>Exchange + Queue + Binding</strong> å®ç°çµæ´»çš„ä»»åŠ¡åˆ†å‘ã€‚</p>
</li>
<li>
<p>ç¤ºä¾‹ï¼šå°†ä¸åŒä»»åŠ¡å‘é€åˆ°ä¸åŒé˜Ÿåˆ—</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># tasks.py</span>
<span class="hljs-variable">@app</span>.task
<span class="hljs-keyword">def</span> <span class="hljs-title function_">send_email</span>(): ...

<span class="hljs-variable">@app</span>.task
<span class="hljs-keyword">def</span> <span class="hljs-title function_">process_video</span>(): ...

<span class="hljs-comment"># å‘é€æ—¶æŒ‡å®šé˜Ÿåˆ—</span>
send_email.apply_async(queue=<span class="hljs-string">'email'</span>)
process_video.apply_async(queue=<span class="hljs-string">'video'</span>)
</code></pre>
<p>RabbitMQ é…ç½®ï¼š</p>
<ul>
<li>Exchange: <code>celery</code></li>
<li>Queue <code>email</code> â†’ ç»‘å®š routing key <code>email</code></li>
<li>Queue <code>video</code> â†’ ç»‘å®š routing key <code>video</code></li>
</ul>
</li>
</ul>
<h3 data-id="heading-6">2. <strong>æŒä¹…åŒ–ï¼ˆPersistenceï¼‰</strong></h3>
<ul>
<li>RabbitMQ å¯å°†æ¶ˆæ¯<strong>å†™å…¥ç£ç›˜</strong>ï¼Œå³ä½¿æœåŠ¡é‡å¯ä¹Ÿä¸ä¸¢å¤±ä»»åŠ¡ã€‚</li>
<li>Celery é»˜è®¤å¼€å¯æ¶ˆæ¯æŒä¹…åŒ–ï¼ˆéœ€é…ç½® Queue å’Œ Message ä¸º durableï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-7">3. <strong>è´Ÿè½½å‡è¡¡ï¼ˆLoad Balancingï¼‰</strong></h3>
<ul>
<li>å¤šä¸ª Worker è®¢é˜…åŒä¸€ Queueï¼ŒRabbitMQ <strong>è½®è¯¢åˆ†å‘</strong>ä»»åŠ¡ï¼ˆRound-Robinï¼‰ã€‚</li>
<li>è‡ªåŠ¨å®ç°æ¨ªå‘æ‰©å±•ï¼šåŠ æœºå™¨ = åŠ  Worker = æå‡ååé‡ã€‚</li>
</ul>
<h3 data-id="heading-8">4. <strong>æµé‡å‰Šå³°ï¼ˆBufferingï¼‰</strong></h3>
<ul>
<li>å½“ä»»åŠ¡çªå‘æ¿€å¢æ—¶ï¼ŒRabbitMQ ä½œä¸º<strong>ç¼“å†²åŒº</strong>æš‚å­˜ä»»åŠ¡ï¼Œé¿å… Worker å´©æºƒã€‚</li>
<li>Worker æŒ‰è‡ªèº«èƒ½åŠ›åŒ€é€Ÿæ¶ˆè´¹ã€‚</li>
</ul>
<h3 data-id="heading-9">5. <strong>å¯é æ€§ä¿éšœ</strong></h3>
<ul>
<li><strong>ACK æœºåˆ¶</strong>ï¼šWorker æ‰§è¡ŒæˆåŠŸåæ‰ ACKï¼Œå¤±è´¥åˆ™æ¶ˆæ¯é‡å› Queueï¼ˆæˆ–è¿›å…¥æ­»ä¿¡é˜Ÿåˆ—ï¼‰ã€‚</li>
<li><strong>æ¶ˆæ¯ç¡®è®¤</strong>ï¼šç¡®ä¿ä»»åŠ¡ä¸ä¸¢å¤±ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-10">ğŸ› ï¸ å››ã€ä»£ç é…ç½®ç¤ºä¾‹</h2>
<h3 data-id="heading-11">1. å®‰è£…ä¾èµ–</h3>
<pre><code class="hljs language-bash" lang="bash">pip install celery
<span class="hljs-comment"># RabbitMQ ä½œä¸º Broker</span>
<span class="hljs-comment"># Redis ä½œä¸º Result Backendï¼ˆå¯é€‰ï¼‰</span>
</code></pre>
<h3 data-id="heading-12">2. Celery é…ç½® (<code>celery_app.py</code>)</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> celery <span class="hljs-keyword">import</span> Celery

<span class="hljs-comment"># ä½¿ç”¨ RabbitMQ ä½œä¸º Brokerï¼ŒRedis ä½œä¸ºç»“æœå­˜å‚¨</span>
app = Celery(
    <span class="hljs-string">'myapp'</span>,
    broker=<span class="hljs-string">'pyamqp://guest@localhost//'</span>,  <span class="hljs-comment"># RabbitMQ è¿æ¥ URL</span>
    backend=<span class="hljs-string">'redis://localhost:6379/0'</span>
)

<span class="hljs-comment"># å¯é€‰ï¼šé…ç½®é˜Ÿåˆ—</span>
app.conf.task_routes = {
    <span class="hljs-string">'tasks.send_email'</span>: {<span class="hljs-string">'queue'</span>: <span class="hljs-string">'email'</span>},
    <span class="hljs-string">'tasks.process_video'</span>: {<span class="hljs-string">'queue'</span>: <span class="hljs-string">'video'</span>},
}
</code></pre>
<h3 data-id="heading-13">3. å®šä¹‰ä»»åŠ¡ (<code>tasks.py</code>)</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> celery_app <span class="hljs-keyword">import</span> app

<span class="hljs-meta">@app.task</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">x, y</span>):
    <span class="hljs-keyword">return</span> x + y

<span class="hljs-meta">@app.task</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">send_email</span>(<span class="hljs-params">to</span>):
    <span class="hljs-comment"># æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>
    <span class="hljs-keyword">import</span> time
    time.sleep(<span class="hljs-number">2</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"Email sent to <span class="hljs-subst">{to}</span>"</span>
</code></pre>
<h3 data-id="heading-14">4. å¯åŠ¨ Worker</h3>
<pre><code class="hljs language-css" lang="css"># ç›‘å¬é»˜è®¤é˜Ÿåˆ—
celery -<span class="hljs-selector-tag">A</span> celery_app worker <span class="hljs-attr">--loglevel</span>=info

# ç›‘å¬ç‰¹å®šé˜Ÿåˆ—
celery -<span class="hljs-selector-tag">A</span> celery_app worker -<span class="hljs-selector-tag">Q</span> email,<span class="hljs-selector-tag">video</span> <span class="hljs-attr">--loglevel</span>=info
</code></pre>
<h3 data-id="heading-15">5. è°ƒç”¨ä»»åŠ¡ (<code>client.py</code>)</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> tasks <span class="hljs-keyword">import</span> add, send_email

<span class="hljs-comment"># å¼‚æ­¥å‘é€ä»»åŠ¡</span>
result = add.delay(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Task ID:"</span>, result.<span class="hljs-built_in">id</span>)

<span class="hljs-comment"># è·å–ç»“æœï¼ˆé˜»å¡ç­‰å¾…ï¼‰</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Result:"</span>, result.get(timeout=<span class="hljs-number">10</span>))
</code></pre>
<hr/>
<h2 data-id="heading-16">âš ï¸ äº”ã€ä¸ºä»€ä¹ˆé€‰æ‹© RabbitMQï¼Ÿ vs å…¶ä»– Broker</h2>





























<table><thead><tr><th>Broker</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>RabbitMQ</strong></td><td>åŠŸèƒ½å¼ºå¤§ã€é«˜å¯é ã€æ”¯æŒå¤æ‚è·¯ç”±</td><td>è¿ç»´ç¨å¤æ‚</td><td>é‡‘èã€ç”µå•†ç­‰å¼ºå¯é æ€§åœºæ™¯</td></tr><tr><td><strong>Redis</strong></td><td>ç®€å•ã€é«˜æ€§èƒ½</td><td>æ¶ˆæ¯å¯èƒ½ä¸¢å¤±ï¼ˆéæŒä¹…åŒ–ï¼‰</td><td>å¿«é€ŸåŸå‹ã€å®¹å¿å°‘é‡ä¸¢å¤±</td></tr><tr><td><strong>Kafka</strong></td><td>é«˜ååã€æ—¥å¿—å‹</td><td>ä¸é€‚åˆä½å»¶è¿Ÿä»»åŠ¡</td><td>å¤§æ•°æ®ç®¡é“ã€äº‹ä»¶æº¯æº</td></tr></tbody></table>
<blockquote>
<p>âœ… <strong>RabbitMQ ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>å®Œæ•´çš„ AMQP åè®®æ”¯æŒ</li>
<li>æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDLXï¼‰å¤„ç†å¤±è´¥ä»»åŠ¡</li>
<li>ç®¡ç†ç•Œé¢ï¼ˆManagement Pluginï¼‰å¯è§†åŒ–ç›‘æ§</li>
</ul>
</blockquote>
<hr/>
<h2 data-id="heading-17">ğŸ“Š å…­ã€RabbitMQ å†…éƒ¨ç»“æ„ï¼ˆCelery è§†è§’ï¼‰</h2>
<pre><code class="hljs language-lua" lang="lua">graph TB
    subgraph RabbitMQ
        E[Exchange: celery] <span class="hljs-comment">--&gt;|routing key: celery| Q1[Queue: celery]</span>
        E <span class="hljs-comment">--&gt;|routing key: email| Q2[Queue: email]</span>
        E <span class="hljs-comment">--&gt;|routing key: video| Q3[Queue: video]</span>
    <span class="hljs-keyword">end</span>

    Client <span class="hljs-comment">--&gt;|Publish task| E</span>
    Worker1 <span class="hljs-comment">--&gt;|Consume| Q1</span>
    Worker2 <span class="hljs-comment">--&gt;|Consume| Q2</span>
    Worker3 <span class="hljs-comment">--&gt;|Consume| Q3</span>
</code></pre>
<ul>
<li><strong>Exchange ç±»å‹</strong>ï¼šCelery é»˜è®¤ä½¿ç”¨ <code>direct</code> Exchange</li>
<li><strong>Queue å£°æ˜</strong>ï¼šCelery è‡ªåŠ¨åˆ›å»º Queueï¼ˆå¯é…ç½®æŒä¹…åŒ–ï¼‰</li>
<li><strong>æ¶ˆæ¯æ ¼å¼</strong>ï¼šJSON æˆ– pickle åºåˆ—åŒ–çš„ä»»åŠ¡å…ƒæ•°æ®</li>
</ul>
<hr/>
<h2 data-id="heading-18">ğŸ›¡ï¸ ä¸ƒã€ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ</h2>
<ol>
<li>
<p><strong>æŒä¹…åŒ–é…ç½®</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç¡®ä¿æ¶ˆæ¯å’Œé˜Ÿåˆ—æŒä¹…åŒ–</span>
<span class="hljs-attr">app.conf.task_serializer</span> = <span class="hljs-string">'json'</span>
<span class="hljs-attr">app.conf.result_serializer</span> = <span class="hljs-string">'json'</span>
<span class="hljs-attr">app.conf.accept_content</span> = [<span class="hljs-string">'json'</span>]
<span class="hljs-attr">app.conf.task_acks_late</span> = <span class="hljs-literal">True</span>  <span class="hljs-comment"># ä»»åŠ¡æ‰§è¡Œå®Œå† ACK</span>
</code></pre>
</li>
<li>
<p><strong>ç›‘æ§ RabbitMQ</strong>ï¼š</p>
<ul>
<li>å¯ç”¨ Management Pluginï¼š<code>rabbitmq-plugins enable rabbitmq_management</code></li>
<li>è®¿é—® <code>http://localhost:15672</code> æŸ¥çœ‹é˜Ÿåˆ—ç§¯å‹ã€æ¶ˆè´¹è€…çŠ¶æ€</li>
</ul>
</li>
<li>
<p><strong>é”™è¯¯å¤„ç†</strong>ï¼š</p>
<ul>
<li>é…ç½®æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDLXï¼‰æ•è·å¤±è´¥ä»»åŠ¡</li>
<li>ä½¿ç”¨ <code>autoretry_for</code> è‡ªåŠ¨é‡è¯•</li>
</ul>
</li>
<li>
<p><strong>èµ„æºéš”ç¦»</strong>ï¼š</p>
<ul>
<li>ä¸ºä¸åŒç±»å‹ä»»åŠ¡åˆ›å»ºç‹¬ç«‹ Queueï¼Œé¿å…äº’ç›¸é˜»å¡</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-19">âœ… æ€»ç»“ï¼šRabbitMQ åœ¨ Celery ä¸­çš„æ ¸å¿ƒä»·å€¼</h2>





























<table><thead><tr><th>èƒ½åŠ›</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å¼‚æ­¥è§£è€¦</strong></td><td>ç”Ÿäº§è€…æ— éœ€ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæˆ</td></tr><tr><td><strong>å¯é æŠ•é€’</strong></td><td>æ¶ˆæ¯æŒä¹…åŒ– + ACK æœºåˆ¶ä¿è¯ä¸ä¸¢å¤±</td></tr><tr><td><strong>å¼¹æ€§ä¼¸ç¼©</strong></td><td>åŠ¨æ€å¢å‡ Worker åº”å¯¹æµé‡å˜åŒ–</td></tr><tr><td><strong>æµé‡å‰Šå³°</strong></td><td>ç¼“å†²çªå‘è¯·æ±‚ï¼Œä¿æŠ¤åç«¯æœåŠ¡</td></tr><tr><td><strong>çµæ´»è·¯ç”±</strong></td><td>æŒ‰ä¸šåŠ¡ç±»å‹åˆ†å‘åˆ°ä¸åŒé˜Ÿåˆ—</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ <strong>ä¸€å¥è¯</strong>ï¼š<br/>
<strong>RabbitMQ æ˜¯ Celery çš„â€œä¸­æ¢ç¥ç»â€ï¼Œæ²¡æœ‰å®ƒï¼ŒCelery å°±æ— æ³•å®ç°åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ã€‚</strong></p>
</blockquote>
<p>å¦‚æœéœ€è¦ <strong>RabbitMQ é«˜å¯ç”¨é›†ç¾¤éƒ¨ç½²æ–¹æ¡ˆ</strong>ã€<strong>Celery ä»»åŠ¡é‡è¯•ç­–ç•¥è¯¦è§£</strong> æˆ– <strong>æ­»ä¿¡é˜Ÿåˆ—é…ç½®ç¤ºä¾‹</strong>ï¼Œæ¬¢è¿ç»§ç»­æé—®ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RabbitMQå¦‚ä½•æ„å»ºç¨³å®šå¯é çš„æ¶ˆæ¯ç³»ç»Ÿ]]></title>    <link>https://juejin.cn/post/7596025264455663652</link>    <guid>https://juejin.cn/post/7596025264455663652</guid>    <pubDate>2026-01-17T13:51:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596025264455663652" data-draft-id="7595994039108894756" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RabbitMQå¦‚ä½•æ„å»ºç¨³å®šå¯é çš„æ¶ˆæ¯ç³»ç»Ÿ"/> <meta itemprop="keywords" content="RabbitMQ"/> <meta itemprop="datePublished" content="2026-01-17T13:51:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ˆé‡Œè°¢é¡¿"/> <meta itemprop="url" content="https://juejin.cn/user/3678304397695056"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RabbitMQå¦‚ä½•æ„å»ºç¨³å®šå¯é çš„æ¶ˆæ¯ç³»ç»Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3678304397695056/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ˆé‡Œè°¢é¡¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T13:51:42.000Z" title="Sat Jan 17 2026 13:51:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>RabbitMQ æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ã€é«˜å¯é çš„å¼€æºæ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå¹¿æ³›ç”¨äºè§£è€¦ã€å¼‚æ­¥å¤„ç†å’Œæµé‡å‰Šå³°ã€‚ä½†åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œè‹¥é…ç½®ä¸å½“æˆ–ç¼ºä¹ç›‘æ§ï¼Œ<strong>ææ˜“å¼•å‘ä¸¥é‡ç”Ÿäº§é—®é¢˜</strong>ã€‚ä»¥ä¸‹æ˜¯ RabbitMQ ä½¿ç”¨è¿‡ç¨‹ä¸­å¸¸è§çš„ <strong>8 å¤§æ ¸å¿ƒé—®é¢˜</strong> åŠå…¶ <strong>æ ¹æœ¬åŸå›  + è§£å†³æ–¹æ¡ˆ</strong>ï¼Œå¸®åŠ©ä½ æ„å»ºç¨³å®šå¯é çš„æ¶ˆæ¯ç³»ç»Ÿã€‚</p>
<hr/>
<h2 data-id="heading-0">ğŸš¨ ä¸€ã€æ¶ˆæ¯å †ç§¯ï¼ˆQueue Backlogï¼‰</h2>
<h3 data-id="heading-1">ğŸ” é—®é¢˜è¡¨ç°</h3>
<ul>
<li>RabbitMQ ç®¡ç†ç•Œé¢æ˜¾ç¤ºæŸä¸ª Queue çš„ <strong>"Messages ready" æŒç»­å¢é•¿</strong></li>
<li>æ¶ˆè´¹è€…å¤„ç†é€Ÿåº¦è¿œä½äºç”Ÿäº§è€…å‘é€é€Ÿåº¦</li>
<li>ç³»ç»Ÿå»¶è¿Ÿé£™å‡ï¼Œä¸šåŠ¡å¡é¡¿</li>
</ul>
<h3 data-id="heading-2">âš ï¸ æ ¹æœ¬åŸå› </h3>
<ol>
<li><strong>æ¶ˆè´¹è€…å¤„ç†èƒ½åŠ›ä¸è¶³</strong>ï¼ˆCPU/IO ç“¶é¢ˆï¼‰</li>
<li><strong>æ¶ˆè´¹è€…å®•æœºæˆ–æœªå¯åŠ¨</strong></li>
<li><strong>ä»»åŠ¡é€»è¾‘å­˜åœ¨æ­»å¾ªç¯æˆ–é˜»å¡</strong></li>
<li><strong>çªå‘æµé‡æ¿€å¢</strong></li>
</ol>
<h3 data-id="heading-3">âœ… è§£å†³æ–¹æ¡ˆ</h3>





























<table><thead><tr><th>æªæ–½</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>æ¨ªå‘æ‰©å®¹æ¶ˆè´¹è€…</strong></td><td>å¢åŠ  Worker å®ä¾‹ï¼ˆCelery: <code>celery -A app worker -Q xxx --concurrency=4</code>ï¼‰</td></tr><tr><td><strong>ä¼˜åŒ–æ¶ˆè´¹é€»è¾‘</strong></td><td>å¼‚æ­¥ I/Oã€æ‰¹é‡å¤„ç†ã€å‡å°‘ DB æŸ¥è¯¢</td></tr><tr><td><strong>é™æµç”Ÿäº§è€…</strong></td><td>åœ¨å®¢æˆ·ç«¯åšé€Ÿç‡é™åˆ¶ï¼ˆå¦‚ä»¤ç‰Œæ¡¶ï¼‰</td></tr><tr><td><strong>è®¾ç½® TTL + æ­»ä¿¡é˜Ÿåˆ—</strong></td><td>è‡ªåŠ¨ä¸¢å¼ƒè¿‡æœŸæ¶ˆæ¯ï¼Œé¿å…æ— é™å †ç§¯</td></tr><tr><td><strong>ç›‘æ§å‘Šè­¦</strong></td><td>å¯¹ Queue é•¿åº¦è®¾ç½®é˜ˆå€¼å‘Šè­¦ï¼ˆå¦‚ &gt; 10,000 æ¡ï¼‰</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ <strong>TTL + DLX é…ç½®ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># å£°æ˜ä¸»é˜Ÿåˆ—ï¼ˆå¸¦ TTL å’Œ DLXï¼‰</span>
channel.queue_declare(
    <span class="hljs-attr">queue</span>=<span class="hljs-string">'main_queue'</span>,
    <span class="hljs-attr">arguments</span>={
        'x-message-ttl': 60000,  <span class="hljs-comment"># 60ç§’è¿‡æœŸ</span>
        'x-dead-letter-exchange': 'dlx_exchange'
    }
)
</code></pre>
</blockquote>
<hr/>
<h2 data-id="heading-4">ğŸ—‘ï¸ äºŒã€æ¶ˆæ¯ä¸¢å¤±ï¼ˆMessage Lossï¼‰</h2>
<h3 data-id="heading-5">ğŸ” é—®é¢˜è¡¨ç°</h3>
<ul>
<li>ç”Ÿäº§è€…å‘é€æˆåŠŸï¼Œä½†æ¶ˆè´¹è€…ä»æœªæ”¶åˆ°</li>
<li>RabbitMQ é‡å¯åéƒ¨åˆ†æ¶ˆæ¯æ¶ˆå¤±</li>
</ul>
<h3 data-id="heading-6">âš ï¸ æ ¹æœ¬åŸå› ï¼ˆæŒ‰é“¾è·¯åˆ†æï¼‰</h3>





















<table><thead><tr><th>ç¯èŠ‚</th><th>é£é™©ç‚¹</th></tr></thead><tbody><tr><td><strong>ç”Ÿäº§è€… â†’ Broker</strong></td><td>æœªå¼€å¯ <code>publisher confirms</code>ï¼Œç½‘ç»œä¸­æ–­å¯¼è‡´æ¶ˆæ¯æœªåˆ°è¾¾</td></tr><tr><td><strong>Broker å†…éƒ¨</strong></td><td>æœªæŒä¹…åŒ–ï¼šQueue é durable / Message é persistent</td></tr><tr><td><strong>Broker â†’ æ¶ˆè´¹è€…</strong></td><td>æ¶ˆè´¹è€…æœª ACK å°±å®•æœºï¼Œä¸” <code>auto_ack=True</code></td></tr></tbody></table>
<h3 data-id="heading-7">âœ… è§£å†³æ–¹æ¡ˆï¼ˆç«¯åˆ°ç«¯å¯é æ€§ï¼‰</h3>
<h4 data-id="heading-8">1. <strong>ç”Ÿäº§è€…ç«¯ï¼šå¯ç”¨å‘å¸ƒç¡®è®¤ï¼ˆPublisher Confirmsï¼‰</strong></h4>
<pre><code class="hljs language-ini" lang="ini">channel.confirm_select()  <span class="hljs-comment"># å¼€å¯ç¡®è®¤æ¨¡å¼</span>
channel.basic_publish(<span class="hljs-attr">exchange</span>=<span class="hljs-string">''</span>, routing_key=<span class="hljs-string">'q'</span>, body=msg)
if not channel.wait_for_confirms(<span class="hljs-attr">timeout</span>=<span class="hljs-number">5</span>):
    raise Exception("Message not confirmed!")
</code></pre>
<h4 data-id="heading-9">2. <strong>Broker ç«¯ï¼šæŒä¹…åŒ–é…ç½®</strong></h4>
<ul>
<li>
<p><strong>Queue å£°æ˜ä¸º durable</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">channel.queue_declare(<span class="hljs-attr">queue</span>=<span class="hljs-string">'task_queue'</span>, durable=<span class="hljs-literal">True</span>)
</code></pre>
</li>
<li>
<p><strong>æ¶ˆæ¯æ ‡è®°ä¸º persistent</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">channel.basic_publish(
    <span class="hljs-attr">exchange</span>=<span class="hljs-string">''</span>,
    <span class="hljs-attr">routing_key</span>=<span class="hljs-string">'task_queue'</span>,
    <span class="hljs-attr">body</span>=message,
    <span class="hljs-attr">properties</span>=pika.BasicProperties(delivery_mode=<span class="hljs-number">2</span>)  <span class="hljs-comment"># 2 = persistent</span>
)
</code></pre>
</li>
</ul>
<h4 data-id="heading-10">3. <strong>æ¶ˆè´¹è€…ç«¯ï¼šæ‰‹åŠ¨ ACK + é‡å…¥é˜Ÿ</strong></h4>
<pre><code class="hljs language-ini" lang="ini">def callback(ch, method, properties, body):
    try:
        process(body)
        ch.basic_ack(<span class="hljs-attr">delivery_tag</span>=method.delivery_tag)  <span class="hljs-comment"># æˆåŠŸå ACK</span>
    except Exception:
        <span class="hljs-comment"># å¤±è´¥æ—¶æ‹’ç»å¹¶é‡æ–°å…¥é˜Ÿï¼ˆå¯é€‰ï¼‰</span>
        ch.basic_nack(<span class="hljs-attr">delivery_tag</span>=method.delivery_tag, requeue=<span class="hljs-literal">True</span>)
</code></pre>
<blockquote>
<p>ğŸ“Œ <strong>å…³é”®åŸåˆ™</strong>ï¼š<br/>
<strong>â€œå‘å‰ç¡®è®¤ + å­˜ç›˜æŒä¹… + æ”¶å ACKâ€ ä¸‰ä½ä¸€ä½“ï¼Œç¼ºä¸€ä¸å¯ï¼</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-11">ğŸ’¥ ä¸‰ã€æ¶ˆè´¹è€…é›ªå´©ï¼ˆConsumer Avalancheï¼‰</h2>
<h3 data-id="heading-12">ğŸ” é—®é¢˜è¡¨ç°</h3>
<ul>
<li>æ¶ˆè´¹è€…å› å¤„ç†å¤±è´¥å¤§é‡é‡è¯•</li>
<li>é‡è¯•æ¶ˆæ¯ç¬é—´å‹å®ä¸‹æ¸¸æœåŠ¡ï¼ˆå¦‚æ•°æ®åº“ã€APIï¼‰</li>
<li>è¿é”ååº”å¯¼è‡´æ•´ä¸ªç³»ç»Ÿç˜«ç—ª</li>
</ul>
<h3 data-id="heading-13">âš ï¸ æ ¹æœ¬åŸå› </h3>
<ul>
<li><strong>æ— é€€é¿é‡è¯•</strong>ï¼šå¤±è´¥åç«‹å³é‡æ–°å…¥é˜Ÿ</li>
<li><strong>æ— ç†”æ–­æœºåˆ¶</strong>ï¼šæŒç»­å†²å‡»å·²æ•…éšœçš„æœåŠ¡</li>
</ul>
<h3 data-id="heading-14">âœ… è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-15">æ–¹æ¡ˆ1ï¼š<strong>æŒ‡æ•°é€€é¿é‡è¯•ï¼ˆæ¨èï¼‰</strong></h4>
<ul>
<li>
<p>æ¶ˆè´¹è€…æ•è·å¼‚å¸¸åï¼Œå°†æ¶ˆæ¯å‘åˆ° <strong>å»¶è¿Ÿé˜Ÿåˆ—</strong>ï¼ˆé€šè¿‡ TTL + DLX å®ç°ï¼‰</p>
</li>
<li>
<p>ç¤ºä¾‹æµç¨‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">main_queue â†’ å¤±è´¥ â†’ delay_10s_queue (<span class="hljs-attr">TTL</span>=<span class="hljs-number">10</span>s) â†’ DLX â†’ main_queue
</code></pre>
</li>
</ul>
<h4 data-id="heading-16">æ–¹æ¡ˆ2ï¼š<strong>æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDLQï¼‰éš”ç¦»</strong></h4>
<ul>
<li>è¶…è¿‡ N æ¬¡é‡è¯•åï¼Œè½¬å…¥ DLQ äººå·¥å¤„ç†</li>
<li>é¿å…æ— æ•ˆæ¶ˆæ¯åå¤å†²å‡»ç³»ç»Ÿ</li>
</ul>
<h4 data-id="heading-17">æ–¹æ¡ˆ3ï¼š<strong>æ¶ˆè´¹è€…é™æµ</strong></h4>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># é™åˆ¶æ¯ä¸ªæ¶ˆè´¹è€…åŒæ—¶å¤„ç†çš„æ¶ˆæ¯æ•°</span>
channel.basic_qos(<span class="hljs-attr">prefetch_count</span>=<span class="hljs-number">1</span>)  <span class="hljs-comment"># å…¬å¹³åˆ†å‘</span>
</code></pre>
<hr/>
<h2 data-id="heading-18">ğŸ”’ å››ã€è¿æ¥/å†…å­˜è€—å°½</h2>
<h3 data-id="heading-19">ğŸ” é—®é¢˜è¡¨ç°</h3>
<ul>
<li>RabbitMQ æ—¥å¿—å‡ºç° <code>memory alarm</code> æˆ– <code>connection_closed_abruptly</code></li>
<li>å®¢æˆ·ç«¯é¢‘ç¹æ–­è¿é‡è¿</li>
<li>æœåŠ¡å™¨ OOMï¼ˆOut of Memoryï¼‰</li>
</ul>
<h3 data-id="heading-20">âš ï¸ æ ¹æœ¬åŸå› </h3>
<ol>
<li><strong>è¿æ¥æ³„æ¼</strong>ï¼šå®¢æˆ·ç«¯æœªæ­£ç¡®å…³é—­è¿æ¥</li>
<li><strong>Channel æ³„æ¼</strong>ï¼šå¤§é‡æœªå…³é—­çš„ Channel</li>
<li><strong>æ¶ˆæ¯ä½“ç§¯è¿‡å¤§</strong>ï¼šå•æ¡æ¶ˆæ¯ &gt; 100MB</li>
<li><strong>æœªè®¾ç½®å†…å­˜å‘Šè­¦é˜ˆå€¼</strong></li>
</ol>
<h3 data-id="heading-21">âœ… è§£å†³æ–¹æ¡ˆ</h3>

























<table><thead><tr><th>é—®é¢˜</th><th>æªæ–½</th></tr></thead><tbody><tr><td><strong>è¿æ¥ç®¡ç†</strong></td><td>ä½¿ç”¨è¿æ¥æ± ï¼ˆå¦‚ <code>pika.BlockingConnection</code> å¤ç”¨ï¼‰</td></tr><tr><td><strong>å¤§æ¶ˆæ¯å¤„ç†</strong></td><td>æ‹†åˆ†æ¶ˆæ¯ or å­˜å‚¨åˆ°å¤–éƒ¨ï¼ˆå¦‚ S3ï¼‰ï¼Œåªä¼  URL</td></tr><tr><td><strong>å†…å­˜æ§åˆ¶</strong></td><td>è°ƒæ•´ <code>vm_memory_high_watermark</code>ï¼ˆé»˜è®¤ 40%ï¼‰</td></tr><tr><td><strong>ç›‘æ§æŒ‡æ ‡</strong></td><td>ç›‘æ§ <code>connections</code>, <code>channels</code>, <code>memory_used</code></td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ <strong>RabbitMQ å†…å­˜å‘Šè­¦é…ç½®</strong>ï¼ˆ<code>rabbitmq.conf</code>ï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">vm_memory_high_watermark.relative</span> = <span class="hljs-number">0.6</span>  <span class="hljs-comment"># ä½¿ç”¨ 60% å†…å­˜æ—¶è§¦å‘æµæ§</span>
</code></pre>
</blockquote>
<hr/>
<h2 data-id="heading-22">ğŸ”„ äº”ã€é‡å¤æ¶ˆè´¹ï¼ˆDuplicate Deliveryï¼‰</h2>
<h3 data-id="heading-23">ğŸ” é—®é¢˜è¡¨ç°</h3>
<ul>
<li>åŒä¸€æ¡æ¶ˆæ¯è¢«æ¶ˆè´¹å¤šæ¬¡</li>
<li>å¯¼è‡´æ•°æ®ä¸ä¸€è‡´ï¼ˆå¦‚é‡å¤æ‰£æ¬¾ã€é‡å¤å‘é‚®ä»¶ï¼‰</li>
</ul>
<h3 data-id="heading-24">âš ï¸ æ ¹æœ¬åŸå› </h3>
<ul>
<li><strong>æ¶ˆè´¹è€…å¤„ç†æˆåŠŸä½† ACK ä¸¢å¤±</strong>ï¼ˆç½‘ç»œé—ªæ–­ï¼‰</li>
<li><strong>æ¶ˆè´¹è€…è¶…æ—¶æœª ACKï¼ŒBroker é‡æ–°æŠ•é€’</strong></li>
</ul>
<h3 data-id="heading-25">âœ… è§£å†³æ–¹æ¡ˆï¼š<strong>ä¸šåŠ¡å±‚å¹‚ç­‰æ€§è®¾è®¡</strong></h3>





















<table><thead><tr><th>æ–¹æ³•</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>å”¯ä¸€ ID å»é‡</strong></td><td>æ¶ˆæ¯æºå¸¦ <code>message_id</code>ï¼Œæ¶ˆè´¹è€…ç”¨ Redis è®°å½•å·²å¤„ç† ID</td></tr><tr><td><strong>æ•°æ®åº“å”¯ä¸€çº¦æŸ</strong></td><td>å¦‚è®¢å•å·å”¯ä¸€ï¼Œé‡å¤æ’å…¥ä¼šæŠ¥é”™</td></tr><tr><td><strong>çŠ¶æ€æœºæ ¡éªŒ</strong></td><td>åªå…è®¸ä»â€œå¾…æ”¯ä»˜â€ â†’ â€œå·²æ”¯ä»˜â€ï¼Œæ‹’ç»é‡å¤æ“ä½œ</td></tr></tbody></table>
<blockquote>
<p>ğŸ“Œ <strong>æ³¨æ„</strong>ï¼šRabbitMQ <strong>æ— æ³•ä¿è¯ Exactly-Once è¯­ä¹‰</strong>ï¼Œå¿…é¡»ç”±ä¸šåŠ¡å±‚å®ç°å¹‚ç­‰ï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-26">ğŸŒ å…­ã€é›†ç¾¤è„‘è£‚ï¼ˆSplit-Brainï¼‰</h2>
<h3 data-id="heading-27">ğŸ” é—®é¢˜è¡¨ç°ï¼ˆå¤šèŠ‚ç‚¹é›†ç¾¤ï¼‰</h3>
<ul>
<li>ç½‘ç»œåˆ†åŒºåï¼Œä¸¤ä¸ªå­é›†ç¾¤å„è‡ªé€‰ä¸¾ Master</li>
<li>æ•°æ®ä¸ä¸€è‡´ï¼Œæ¶ˆæ¯å¯èƒ½ä¸¢å¤±æˆ–é‡å¤</li>
</ul>
<h3 data-id="heading-28">âš ï¸ æ ¹æœ¬åŸå› </h3>
<ul>
<li>ç½‘ç»œä¸ç¨³å®šå¯¼è‡´èŠ‚ç‚¹é—´é€šä¿¡ä¸­æ–­</li>
<li>æœªé…ç½®è‡ªåŠ¨å¤„ç†ç­–ç•¥</li>
</ul>
<h3 data-id="heading-29">âœ… è§£å†³æ–¹æ¡ˆï¼š<strong>é…ç½®ç½‘ç»œåˆ†åŒºå¤„ç†ç­–ç•¥</strong></h3>
<p>åœ¨ <code>rabbitmq.conf</code> ä¸­è®¾ç½®ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ¨èï¼špause_minorityï¼ˆå°‘æ•°æ´¾æš‚åœï¼‰</span>
<span class="hljs-attr">cluster_partition_handling</span> = pause_minority

<span class="hljs-comment"># æˆ– autohealï¼ˆè‡ªåŠ¨æ„ˆåˆï¼Œä½†å¯èƒ½ä¸¢æ•°æ®ï¼‰</span>
<span class="hljs-comment"># cluster_partition_handling = autoheal</span>
</code></pre>
<blockquote>
<p>ğŸ“Œ <strong>pause_minority ç­–ç•¥</strong>ï¼š<br/>
ç½‘ç»œåˆ†åŒºåï¼Œ<strong>èŠ‚ç‚¹æ•°è¾ƒå°‘çš„ä¸€æ–¹è‡ªåŠ¨æš‚åœæœåŠ¡</strong>ï¼Œé¿å…è„‘è£‚ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-30">ğŸ•µï¸ ä¸ƒã€æƒé™ä¸å®‰å…¨æ¼æ´</h2>
<h3 data-id="heading-31">ğŸ” å¸¸è§é£é™©</h3>
<ul>
<li>é»˜è®¤ç”¨æˆ· <code>guest/guest</code> æœªä¿®æ”¹</li>
<li>å¼€æ”¾ 5672 ç«¯å£åˆ°å…¬ç½‘</li>
<li>æœªå¯ç”¨ TLS åŠ å¯†</li>
</ul>
<h3 data-id="heading-32">âœ… å®‰å…¨åŠ å›ºæªæ–½</h3>
<ol>
<li>
<p><strong>åˆ é™¤é»˜è®¤ç”¨æˆ·</strong>ï¼š</p>
<pre><code class="hljs">rabbitmqctl delete_user guest
</code></pre>
</li>
<li>
<p><strong>åˆ›å»ºæœ€å°æƒé™ç”¨æˆ·</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">rabbitmqctl add_user myapp secret123
rabbitmqctl set_permissions -p / myapp <span class="hljs-string">".*"</span> <span class="hljs-string">".*"</span> <span class="hljs-string">".*"</span>
</code></pre>
</li>
<li>
<p><strong>å¯ç”¨ TLS</strong>ï¼š</p>
<ul>
<li>é…ç½® SSL è¯ä¹¦ï¼Œä½¿ç”¨ <code>amqps://</code> è¿æ¥</li>
</ul>
</li>
<li>
<p><strong>é˜²ç«å¢™é™åˆ¶</strong>ï¼š</p>
<ul>
<li>ä»…å…è®¸å¯ä¿¡ IP è®¿é—® 5672/15672 ç«¯å£</li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-33">ğŸ“‰ å…«ã€ç›‘æ§ç¼ºå¤±å¯¼è‡´æ•…éšœå‘ç°æ»å</h2>
<h3 data-id="heading-34">âœ… å¿…é¡»ç›‘æ§çš„æ ¸å¿ƒæŒ‡æ ‡</h3>



































<table><thead><tr><th>æŒ‡æ ‡</th><th>å·¥å…·</th><th>å‘Šè­¦é˜ˆå€¼</th></tr></thead><tbody><tr><td>Queue é•¿åº¦</td><td>RabbitMQ Management Plugin</td><td>&gt; 10,000</td></tr><tr><td>æ¶ˆæ¯é€Ÿç‡ï¼ˆå…¥/å‡ºï¼‰</td><td>Prometheus + rabbitmq_exporter</td><td>çªé™ 90%</td></tr><tr><td>å†…å­˜ä½¿ç”¨ç‡</td><td><code>rabbitmqctl status</code></td><td>&gt; 80%</td></tr><tr><td>è¿æ¥æ•°</td><td>Management API</td><td>&gt; æœ€å¤§è¿æ¥æ•° * 80%</td></tr><tr><td>æ¶ˆè´¹è€…æ•°é‡</td><td>Management Plugin</td><td>= 0ï¼ˆæ— äººæ¶ˆè´¹ï¼‰</td></tr></tbody></table>
<blockquote>
<p>ğŸ’¡ <strong>æ¨èå·¥å…·æ ˆ</strong>ï¼š<br/>
<strong>Prometheus + Grafana + Alertmanager</strong> å®ç°å¯è§†åŒ–ç›‘æ§å‘Šè­¦</p>
</blockquote>
<hr/>
<h2 data-id="heading-35">âœ… æ€»ç»“ï¼šRabbitMQ ç”Ÿäº§ç¯å¢ƒ Checklist</h2>
<ul>
<li><strong>æ¶ˆæ¯å¯é æ€§</strong>ï¼šå‘å¸ƒç¡®è®¤ + æŒä¹…åŒ– + æ‰‹åŠ¨ ACK</li>
<li><strong>æ¶ˆè´¹è€…å¥å£®æ€§</strong>ï¼šå¹‚ç­‰è®¾è®¡ + é€€é¿é‡è¯• + DLQ</li>
<li><strong>èµ„æºæ§åˆ¶</strong>ï¼šå†…å­˜å‘Šè­¦ + è¿æ¥æ±  + å¤§æ¶ˆæ¯æ‹†åˆ†</li>
<li><strong>é«˜å¯ç”¨</strong>ï¼šé›†ç¾¤ + ç½‘ç»œåˆ†åŒºç­–ç•¥</li>
<li><strong>å®‰å…¨</strong>ï¼šå¼ºå¯†ç  + é˜²ç«å¢™ + TLS</li>
<li><strong>å¯è§‚æµ‹æ€§</strong>ï¼šå…¨é“¾è·¯ç›‘æ§ + å‘Šè­¦</li>
</ul>
<blockquote>
<p>ğŸŒŸ <strong>ç»ˆæå»ºè®®</strong>ï¼š<br/>
<strong>ä¸è¦ç­‰åˆ°çº¿ä¸Šæ•…éšœæ‰é‡è§†æ¶ˆæ¯é˜Ÿåˆ—ï¼</strong><br/>
åœ¨æµ‹è¯•ç¯å¢ƒæ¨¡æ‹Ÿ <strong>Broker å®•æœºã€ç½‘ç»œå»¶è¿Ÿã€æ¶ˆè´¹è€…å´©æºƒ</strong> ç­‰åœºæ™¯ï¼ŒéªŒè¯ç³»ç»ŸéŸ§æ€§ã€‚</p>
</blockquote>
<p>å¦‚æœéœ€è¦ <strong>RabbitMQ é«˜å¯ç”¨é›†ç¾¤éƒ¨ç½²æ¨¡æ¿</strong>ã€<strong>æ­»ä¿¡é˜Ÿåˆ—å®Œæ•´ä»£ç ç¤ºä¾‹</strong> æˆ– <strong>ä¸ Celery é›†æˆçš„æœ€ä½³å®è·µ</strong>ï¼Œæ¬¢è¿ç»§ç»­æé—®ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[8ä¸ªå¤§è„‘åŒæ—¶è½¬ï¼Ÿç¾å›¢LongCatå¼€æºï¼Œè®©AIå­¦ä¼šâ€œä¸‰æ€åè¡Œâ€]]></title>    <link>https://juejin.cn/post/7595890117865783342</link>    <guid>https://juejin.cn/post/7595890117865783342</guid>    <pubDate>2026-01-17T12:13:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595890117865783342" data-draft-id="7595894884956995635" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="8ä¸ªå¤§è„‘åŒæ—¶è½¬ï¼Ÿç¾å›¢LongCatå¼€æºï¼Œè®©AIå­¦ä¼šâ€œä¸‰æ€åè¡Œâ€"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2026-01-17T12:13:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨é£å¦‚é›ª"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            8ä¸ªå¤§è„‘åŒæ—¶è½¬ï¼Ÿç¾å›¢LongCatå¼€æºï¼Œè®©AIå­¦ä¼šâ€œä¸‰æ€åè¡Œâ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨é£å¦‚é›ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T12:13:34.000Z" title="Sat Jan 17 2026 12:13:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2026å¹´åˆšå¼€å¹´ï¼Œå¼€æºAIç¤¾åŒºå°±è¿æ¥äº†ä¸€ä¸ªé‡ç£…ç©å®¶ã€‚</p>
<p>è¿™æ¬¡ä¸å†æ˜¯å•çº¯æ¯”æ‹¼è°çš„å‚æ•°æ›´å¤§ã€è°èŠé—²å¤©æ›´æºœï¼Œç¾å›¢LongCatå›¢é˜Ÿç›´æ¥æŠŠæ¡Œå­æ€äº†ï¼Œç«¯ä¸Šæ¥ä¸€ç›˜ç¡¬èœï¼š<strong>LongCat-Flash-Thinking-2601</strong>ã€‚è¿™åå­—å¬ç€æŒºé•¿ï¼Œå…¶å®æ ¸å¿ƒå°±è®²äº†ä¸€ä»¶äº‹â€”â€”è®©AIå­¦ä¼šåƒäººç±»ä¸“å®¶ä¸€æ ·ï¼Œé‡åˆ°éš¾é¢˜å…ˆåˆ«æ€¥ç€å¼ å˜´ï¼Œåœä¸‹æ¥ï¼Œå¤šæƒ³å‡ éã€‚</p>
<p>å¾ˆå¤šå¼€å‘è€…åœ¨è¿™ä¸ªæ¨¡å‹å‘å¸ƒåæƒŠå‘¼ï¼Œè¿™å¯èƒ½æ˜¯ç›®å‰æœ€æ¥è¿‘â€œç³»ç»Ÿ2â€æ€ç»´ï¼ˆæ…¢æ€è€ƒï¼‰çš„å¼€æºå°è¯•ã€‚ä»Šå¤©å’±ä»¬å°±æŠ›å¼€é‚£äº›æ™¦æ¶©çš„è®ºæ–‡å…¬å¼ï¼ŒèŠèŠè¿™ä¸ªæ¨¡å‹åˆ°åº•ç¥åœ¨å“ªå„¿ï¼Œä»¥åŠå®ƒä¸ºä»€ä¹ˆæ•¢è¯´è‡ªå·±åœ¨å¤æ‚ä»»åŠ¡ä¸Šè¶…è¶Šäº†Claude-Opus-4.5ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2Fadsfsdgdfg-1024x369.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/adsfsdgdfg-1024x369.webp" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa28775ab87b4cde80e87f331aa31743~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769256814&amp;x-signature=jXXAs1ahKjVjU5oejOCb1faaTEQ%3D" alt="adsfsdgdfg" loading="lazy"/></a></p>
<p><strong>æ‹’ç»â€œç›´è§‰å¼â€å›ç­”ï¼šä»€ä¹ˆæ˜¯é‡æ€è€ƒæ¨¡å¼ï¼Ÿ</strong></p>
<p>ä»¥å‰çš„å¤§æ¨¡å‹ï¼Œå“ªæ€•æ˜¯æ‰€è°“çš„æ¨ç†æ¨¡å‹ï¼Œå¤§å¤šè¿˜æ˜¯â€œå•çº¿ç¨‹â€çš„ã€‚ä½ é—®ä¸ªé—®é¢˜ï¼Œå®ƒé¡ºç€é€»è¾‘é“¾æ¡å¾€ä¸‹ç¼–ï¼Œä¸€æ—¦ä¸­é—´æŸä¸€æ­¥èµ°æ­ªäº†ï¼Œåé¢å°±å…¨å´©äº†ã€‚</p>
<p>ç¾å›¢è¿™æ¬¡æäº†ä¸ªåˆ›æ–°ï¼Œå«â€œHeavy Thinking Modeâ€ï¼ˆé‡æ€è€ƒæ¨¡å¼ï¼‰ã€‚è¿™ç©æ„å„¿æœ‰ç‚¹æ„æ€ï¼Œå®ƒæ¨¡ä»¿äº†äººç±»é¢å¯¹æéš¾æ•°å­¦é¢˜æˆ–è€…å¤æ‚ä»£ç bugæ—¶çš„çŠ¶æ€ã€‚</p>
<p>å½“ä½ å¼€å¯è¿™ä¸ªæ¨¡å¼ï¼ŒLongCatå¹¶ä¸æ˜¯é©¬ä¸Šç»™ä½ ç­”æ¡ˆï¼Œè€Œæ˜¯<strong>åŒæ—¶å¯åŠ¨8ä¸ªç‹¬ç«‹çš„â€œå¤§è„‘â€ï¼ˆæ¨ç†è·¯å¾„ï¼‰</strong>ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2Fasfsdfsdg-1024x817.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/asfsdfsdg-1024x817.webp" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34ae7e3ecf904358b43d17f886a136c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769256814&amp;x-signature=CYVJ6iwWJXGvyIuQxGJdS8QrJcA%3D" alt="asfsdfsdg" loading="lazy"/></a></p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œè¿™å°±åƒæ˜¯å¼€äº†ä¸€ä¸ªåœ†æ¡Œä¼šè®®ã€‚é¢å¯¹ä½ çš„é—®é¢˜ï¼Œ8ä¸ªåˆ†èº«åŒæ—¶å¼€å§‹è§£é¢˜ï¼Œæœ‰çš„è¯•ä»£æ•°æ³•ï¼Œæœ‰çš„è¯•å‡ ä½•æ³•ï¼Œæœ‰çš„æŸ¥æ–‡æ¡£ï¼Œæœ‰çš„å†™ä¼ªä»£ç ã€‚å®ƒä»¬äº’ä¸å¹²æ‰°ï¼Œå„è‡ªæ¢ç´¢ã€‚</p>
<p>è¿™è¿˜æ²¡å®Œï¼Œç­‰å¤§å®¶éƒ½æ€è€ƒå¾—å·®ä¸å¤šäº†ï¼Œè¿›å…¥ç¬¬äºŒé˜¶æ®µï¼š<strong>æ€»ç»“å½’çº³</strong>ã€‚æ¨¡å‹ä¼šæŠŠè¿™8æ¡è·¯å¾„çš„ç»“æœæ‹¿æ¥è¿›è¡Œæ¯”å¯¹ã€éªŒè¯ã€å»ä¼ªå­˜çœŸï¼ŒæŠŠæœ€å¥½çš„æ€è·¯åƒæ‹¼ç§¯æœ¨ä¸€æ ·é€šè¿‡â€œé—­ç¯è¿­ä»£â€åˆæˆèµ·æ¥ï¼Œæœ€åæ‰æ…é‡åœ°ç»™ä½ è¾“å‡ºä¸€ä¸ªç»“æœã€‚</p>
<p>è¿™å¥—â€œæƒ³æ¸…æ¥šå†è¡ŒåŠ¨â€çš„æœºåˆ¶ï¼Œç›´æ¥è®©å®ƒåœ¨å¤„ç†é«˜éš¾åº¦ã€ä¸ç¡®å®šæ€§ä»»åŠ¡æ—¶çš„å¯é æ€§ä¸Šäº†ä¸ªå¤§å°é˜¶ã€‚</p>
<p><strong>æ•°æ®ä¸ä¼šæ’’è°ï¼šæ»¡åˆ†çš„æ•°å­¦ä¸ç¡¬æ ¸çš„å®æˆ˜</strong></p>
<p>å’±ä»¬æ¥çœ‹çœ‹æˆç»©å•ï¼Œè¿™ä¹Ÿæ˜¯å¤§å®¶æœ€å…³å¿ƒçš„éƒ¨åˆ†ã€‚</p>
<p>åœ¨AIME-25ï¼ˆç¾å›½æ•°å­¦é‚€è¯·èµ›ï¼‰çš„è¯„æµ‹åŸºå‡†ä¸Šï¼Œå¼€å¯é‡æ€è€ƒæ¨¡å¼åçš„LongCatç›´æ¥æ‹¿ä¸‹äº†<strong>100.0çš„æ»¡åˆ†</strong>ã€‚åœ¨IMO-AnswerBenchï¼ˆå›½é™…å¥¥æ•°çº§åˆ«ï¼‰ä¸Šä¹Ÿæ‹¿åˆ°äº†86.8åˆ†ï¼Œç¨³åç›®å‰å¼€æºæ¨¡å‹çš„å¤´æŠŠäº¤æ¤…ã€‚</p>
<p>ä½†çœŸæ­£è®©åœˆå†…äººæ„Ÿåˆ°å…´å¥‹çš„ï¼Œå…¶å®æ˜¯å®ƒçš„<strong>å·¥å…·è°ƒç”¨ï¼ˆAgentï¼‰èƒ½åŠ›</strong>ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2Ffsgdhtr-1024x587.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/fsgdhtr-1024x587.webp" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/17c90838983141e1bc7610590ec8ba30~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769256814&amp;x-signature=zwPQS4qEl5rDzocgd9Fl15J7%2BDo%3D" alt="fsgdhtr" loading="lazy"/></a></p>
<p>ç°åœ¨çš„å¤§æ¨¡å‹ï¼Œåšæ•°å­¦é¢˜åªæ˜¯åŸºæœ¬åŠŸï¼Œèƒ½ä¸èƒ½ç†Ÿç»ƒä½¿ç”¨å·¥å…·ã€æœç´¢ä¿¡æ¯ã€è§£å†³å®é™…é—®é¢˜æ‰æ˜¯è½åœ°çš„å…³é”®ã€‚ç¾å›¢å®˜æ–¹æŠ«éœ²ï¼Œåœ¨ä¾èµ–å·¥å…·è°ƒç”¨çš„éšæœºå¤æ‚ä»»åŠ¡ä¸­ï¼ŒLongCatçš„è¡¨ç°è¶…è¶Šäº†Claude-Opus-4.5-Thinkingã€‚</p>
<p>æ³¨æ„ï¼Œè¿™é‡Œå¼ºè°ƒçš„æ˜¯â€œéšæœºå¤æ‚ä»»åŠ¡â€ã€‚è¿™æ„å‘³ç€å®ƒä¸æ˜¯é æ­»è®°ç¡¬èƒŒå¸¸è§çš„APIæ–‡æ¡£ï¼Œè€Œæ˜¯çœŸå…·å¤‡äº†æå¼ºçš„æ³›åŒ–èƒ½åŠ›ã€‚å“ªæ€•ä½ ç»™å®ƒä¸€ä¸ªä»æœªè§è¿‡çš„ã€å……æ»¡éšæœºæ€§çš„çƒ‚æ‘Šå­å·¥å…·ç®±ï¼Œå®ƒä¹Ÿèƒ½é€šè¿‡é‚£å¥—â€œå¹¶è¡Œæ€è€ƒâ€æœºåˆ¶ï¼Œè¯•é”™ã€è°ƒæ•´ï¼Œæœ€ç»ˆæŠŠæ´»å„¿å¹²æ¼‚äº®ã€‚</p>
<p>åœ¨Ï„Â²-BenchåŸºå‡†æµ‹è¯•ä¸­ï¼Œå®ƒæ‹¿åˆ°äº†88.2åˆ†ï¼›åœ¨BrowseCompï¼ˆæ™ºèƒ½ä½“æœç´¢èƒ½åŠ›ï¼‰ä¸Šæ‹¿åˆ°äº†73.1åˆ†ã€‚è¿™äº›æ•°æ®è¯´æ˜ï¼Œå®ƒä¸ä»…æ˜¯ä¸ªåšé¢˜å®¶ï¼Œæ›´æ˜¯ä¸ªå®å¹²å®¶ã€‚</p>
<p><strong>æŠ€æœ¯åº•åº§ï¼šä¸ä»…ä»…æ˜¯å¤§</strong></p>
<p>LongCat-Flash-Thinking-2601æ˜¯åŸºäºæ··åˆä¸“å®¶æ¶æ„ï¼ˆMoEï¼‰æ„å»ºçš„ã€‚</p>
<p>æ€»å‚æ•°é‡è¾¾åˆ°äº†560Bï¼ˆ5600äº¿ï¼‰ï¼Œå¬èµ·æ¥å“äººå¯¹å§ï¼Ÿä½†åˆ«æ…Œï¼Œå¾—ç›ŠäºMoEæ¶æ„ï¼Œå®ƒåœ¨æ¨ç†æ—¶çš„æ¿€æ´»å‚æ•°åªæœ‰çº¦27Bã€‚è¿™æ„å‘³ç€å®ƒæ—¢æ‹¥æœ‰å·¨å‹æ¨¡å‹çš„çŸ¥è¯†å‚¨å¤‡ï¼Œåˆèƒ½ä¿æŒç›¸å¯¹é«˜æ•ˆçš„æ¨ç†é€Ÿåº¦ï¼ˆæ¯ç§’100+ tokensï¼‰ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2Fgdfgsdf-1024x605.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/gdfgsdf-1024x605.webp" ref="nofollow noopener noreferrer"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e32958de02b4a1b95114243940d73c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769256814&amp;x-signature=E8FnVas3uGmB6Jwswr4pQOVDiE0%3D" alt="gdfgsdf" loading="lazy"/></a></p>
<p>è€Œä¸”ï¼Œå®ƒçš„è®­ç»ƒæ–¹å¼å ªç§°â€œæ–¯å·´è¾¾å¼â€ã€‚</p>
<p>ä¸ºäº†è®©æ¨¡å‹æŠ—é€ ï¼Œå›¢é˜Ÿæäº†ä¸ªâ€œé«˜å¼ºåº¦ç»ƒå…µåœºâ€ã€‚ä»–ä»¬åœ¨è®­ç»ƒæ•°æ®é‡Œæ•…æ„æºæ²™å­â€”â€”æ³¨å…¥APIè°ƒç”¨å¤±è´¥ã€ç½‘ç»œè¶…æ—¶ã€è¿”å›å¼‚å¸¸æ•°æ®ç­‰å™ªå£°ã€‚è¿™ç§â€œæŠ—å¹²æ‰°è®­ç»ƒâ€è®©æ¨¡å‹å…»æˆäº†å¾ˆå¥½çš„å¿ƒæ€ï¼šé‡åˆ°æŠ¥é”™ä¸å‘ç–¯ï¼Œè€Œæ˜¯å†·é™åœ°åˆ†æåŸå› ï¼Œæ¢ä¸ªå§¿åŠ¿ç»§ç»­å°è¯•ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒåœ¨çœŸå®ä¸–ç•Œçš„å¤æ‚ç¯å¢ƒä¸­è¡¨ç°å¾—ç‰¹åˆ«ç¨³ã€‚</p>
<p><strong>å†™åœ¨æœ€å</strong></p>
<p>ç¾å›¢è¿™æ¬¡éå¸¸åœ°é“ï¼Œä¸ä»…ä»…æ˜¯å‘äº†è®ºæ–‡ï¼Œè€Œæ˜¯æŠŠä»£ç ã€æ¨¡å‹æƒé‡å…¨éƒ½åœ¨GitHubå’ŒHugging Faceä¸Šå¼€æºäº†ï¼Œç”šè‡³è¿˜æä¾›äº†å…è´¹çš„åœ¨çº¿ä½“éªŒå’ŒAPIé¢åº¦ã€‚</p>
<p>å¯¹äºå¼€å‘è€…æ¥è¯´ï¼ŒLongCatæä¾›äº†ä¸€ä¸ªæå…·ä»·å€¼çš„æ–°é€‰æ‹©ï¼šå½“ä½ éœ€è¦ä¸€ä¸ªèƒ½å¤„ç†å¤æ‚é€»è¾‘ã€èƒ½å®¹å¿ç¯å¢ƒå™ªå£°ã€ä¸”å…·å¤‡æ·±åº¦æ¨ç†èƒ½åŠ›çš„æ™ºèƒ½ä½“æ ¸å¿ƒæ—¶ï¼Œä¸éœ€è¦å†æ­»ç£•æ˜‚è´µçš„é—­æºAPIäº†ã€‚</p>
<p>åœ¨è¿™ä¸ªæµ®èºçš„æ—¶ä»£ï¼Œæ„¿æ„èŠ±æ—¶é—´æ•™AIâ€œä¸‰æ€è€Œåè¡Œâ€ï¼Œæœ¬èº«å°±æ˜¯ä¸€ä»¶å€¼å¾—é•¿æœŸä¸»ä¹‰è€…ç‚¹èµçš„äº‹ã€‚å¦‚æœä½ å¯¹AIçš„é€»è¾‘æ¨ç†èƒ½åŠ›æœ‰é«˜è¦æ±‚ï¼ŒLongCatç»å¯¹å€¼å¾—ä½ å»æ‹‰ä¸‹æ¥è·‘ä¸€è·‘ã€‚</p>
<p><strong>å¦‚æœä½ ä¹Ÿå¯¹æœ€æ–°çš„AIä¿¡æ¯æ„Ÿå…´è¶£æˆ–è€…æœ‰ç–‘é—® éƒ½å¯ä»¥åŠ å…¥æˆ‘çš„å¤§å®¶åº­ ç¬¬ä¸€æ—¶é—´åˆ†äº«æœ€æ–°AIèµ„è®¯ã€å·¥å…·ã€æ•™ç¨‹ã€æ–‡æ¡£ æ¬¢è¿ä½ çš„åŠ å…¥ï¼ï¼ï¼ğŸ˜‰ğŸ˜‰ğŸ˜‰</strong></p>
<p>å…¬ä¼—å·ï¼šå¢¨é£å¦‚é›ªå°ç«™</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[K-Medoidsèšç±»æ–¹æ³•å’ŒK-Meansæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7595842144907477042</link>    <guid>https://juejin.cn/post/7595842144907477042</guid>    <pubDate>2026-01-17T12:45:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595842144907477042" data-draft-id="7595890117865832494" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="K-Medoidsèšç±»æ–¹æ³•å’ŒK-Meansæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"/> <meta itemprop="keywords" content="é¢è¯•,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-17T12:45:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="aicoting"/> <meta itemprop="url" content="https://juejin.cn/user/933911964427818"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            K-Medoidsèšç±»æ–¹æ³•å’ŒK-Meansæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/933911964427818/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    aicoting
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T12:45:01.000Z" title="Sat Jan 17 2026 12:45:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ¨èç›´æ¥ç½‘ç«™åœ¨çº¿é˜…è¯»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Faicoting.cn%2F" target="_blank" title="https://aicoting.cn/" ref="nofollow noopener noreferrer">aicoting AIç®—æ³•é¢è¯•å­¦ä¹ åœ¨çº¿ç½‘ç«™</a></p>
</blockquote>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯èšç±»ï¼Ÿ</h2>
<p>èšç±»ï¼ˆClusteringï¼‰æ˜¯ä¸€ç§å…¸å‹çš„æ— ç›‘ç£å­¦ä¹ æ–¹æ³•ï¼Œå…¶ç›®æ ‡æ˜¯åœ¨æ²¡æœ‰æ ‡ç­¾ä¿¡æ¯çš„æƒ…å†µä¸‹ï¼Œå°†æ•°æ®æ ·æœ¬æŒ‰ç…§ç›¸ä¼¼æ€§åˆ’åˆ†ä¸ºè‹¥å¹²ç°‡ï¼Œä½¿å¾—åŒä¸€ç°‡å†…çš„æ ·æœ¬ç›¸ä¼¼åº¦é«˜ï¼Œä¸åŒç°‡ä¹‹é—´å·®å¼‚æ˜¾è‘—ã€‚å¸¸è§æ–¹æ³•åŒ…æ‹¬åŸºäºåˆ’åˆ†çš„ K-Meansã€åŸºäºå±‚æ¬¡çš„ å±‚æ¬¡èšç±»ã€ä»¥åŠåŸºäºå¯†åº¦çš„ DBSCANã€OPTICS ç­‰ã€‚èšç±»å¹¿æ³›åº”ç”¨äºç”¨æˆ·åˆ†ç¾¤ã€å¸‚åœºç»†åˆ†ã€æ–‡æœ¬ä¸»é¢˜å‘ç°ã€å›¾åƒåˆ†å‰²ç­‰ä»»åŠ¡ï¼Œæ˜¯æ•°æ®æŒ–æ˜å’Œæ¢ç´¢æ€§åˆ†æä¸­çš„é‡è¦å·¥å…·ã€‚</p>
<h2 data-id="heading-1">K-Means èšç±»</h2>
<p>K-Means æ˜¯æœ€ç»å…¸çš„èšç±»ç®—æ³•ä¹‹ä¸€ï¼Œå±äºåŸºäºåˆ’åˆ†ï¼ˆPartition-basedï¼‰çš„èšç±»æ–¹æ³•ã€‚å®ƒé€šè¿‡è¿­ä»£ä¼˜åŒ–ç›®æ ‡å‡½æ•°ï¼Œå°†æ•°æ®åˆ’åˆ†ä¸º K ä¸ªç°‡ï¼Œä½¿å¾—åŒç°‡å†…æ ·æœ¬ä¹‹é—´ç›¸ä¼¼åº¦æœ€å¤§åŒ–ï¼Œè€Œä¸åŒç°‡ä¹‹é—´ç›¸ä¼¼åº¦æœ€å°åŒ–ã€‚ä¸€ä¸ªç°‡è¯´ç™½äº†å°±æ˜¯ä¸€ç»„ç›¸åŒç±»åˆ«çš„ä¸œè¥¿ï¼Œåªæ˜¯åœ¨è¿™ä¸ªæ–¹æ³•é‡Œèµ·äº†ä¸ªåå­—å«ç°‡ï¼Œæ¯”å¦‚è‹¹æœï¼Œé¦™è•‰ï¼Œæ©˜å­å±äºæ°´æœé‚£ä¸€ç°‡ï¼Œå½­äºæ™ï¼Œåˆ˜äº¦è²å’Œä½ ä»¬å±äºå¸…å“¥ç¾å¥³é‚£ä¸€ç°‡ã€‚ç”±äºå…¶ç®€å•ã€é«˜æ•ˆï¼ŒK-Means åœ¨æ•°æ®æŒ–æ˜ã€æ–‡æœ¬åˆ†æã€å›¾åƒåˆ†å‰²ç­‰é¢†åŸŸè¢«å¹¿æ³›åº”ç”¨ã€‚</p>
<p>K-Means çš„ç›®æ ‡æ˜¯æœ€å°åŒ–ç°‡å†…å¹³æ–¹è¯¯å·®ï¼ˆWithin-Cluster Sum of Squares, WCSSï¼‰ï¼Œå³ï¼š</p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mo>âˆ‘</mo><mrow><mi>x</mi><mo>âˆˆ</mo><msub><mi>C</mi><mi>i</mi></msub></mrow></msub><mi mathvariant="normal">âˆ¥</mi><mi>x</mi><mo>âˆ’</mo><msub><mi>Î¼</mi><mi>i</mi></msub><msup><mi mathvariant="normal">âˆ¥</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">J = \sum_{i=1}^{K} \sum_{x \in C_i} \| x - \mu_i \|^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.381em;vertical-align:-0.3998em;"/><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0715em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span/></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3998em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">âˆ¥</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord"><span class="mord">âˆ¥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></span> ï¼šç°‡çš„ä¸ªæ•°</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> ï¼šç¬¬ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"/><span class="mord mathnormal">i</span></span></span></span></span> ä¸ªç°‡</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Î¼_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> ï¼šç°‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> çš„è´¨å¿ƒï¼ˆå‡å€¼å‘é‡ï¼‰</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">âˆ¥</mi><mi>x</mi><mo>âˆ’</mo><msub><mi>Î¼</mi><mi>i</mi></msub><msup><mi mathvariant="normal">âˆ¥</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\| x - \mu_i \|^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord">âˆ¥</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mord"><span class="mord">âˆ¥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span> ï¼šæ ·æœ¬ç‚¹ä¸ç°‡ä¸­å¿ƒçš„æ¬§å¼è·ç¦» K-Meansçš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ä¸æ–­æ›´æ–°ç°‡åˆ’åˆ†ä¸è´¨å¿ƒï¼Œç›´åˆ°æ”¶æ•›ï¼ˆç›®æ ‡å‡½æ•°ä¸å†æ˜¾è‘—ä¸‹é™ï¼‰ã€‚</li>
</ul>
<p>K-Meansçš„ç®—æ³•æµç¨‹ä¹Ÿå¾ˆå®¹æ˜“ç†è§£ï¼š</p>
<ol>
<li>åˆå§‹åŒ–ï¼šéšæœºé€‰æ‹© K ä¸ªæ ·æœ¬ä½œä¸ºåˆå§‹è´¨å¿ƒã€‚</li>
<li>åˆ†é…æ ·æœ¬ï¼šå°†æ¯ä¸ªæ ·æœ¬åˆ†é…åˆ°è·ç¦»æœ€è¿‘çš„ç°‡ä¸­å¿ƒã€‚</li>
<li>æ›´æ–°è´¨å¿ƒï¼šå¯¹æ¯ä¸ªç°‡ï¼Œè®¡ç®—æ‰€æœ‰æ ·æœ¬çš„å‡å€¼ä½œä¸ºæ–°çš„è´¨å¿ƒã€‚</li>
<li>è¿­ä»£ï¼šé‡å¤æ­¥éª¤ 2-3ï¼Œç›´åˆ°ç°‡åˆ’åˆ†ä¸å†å˜åŒ–æˆ–ç›®æ ‡å‡½æ•°æ”¶æ•›ã€‚</li>
</ol>
<p>ä¸‹é¢åŸºäºScikit-learnç¼–å†™ä¸€æ®µç¤ºä¾‹ä»£ç è®©å’±ä»¬æ›´å¥½çš„ç†è§£ä¸€ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> make_blobs
<span class="hljs-keyword">from</span> sklearn.cluster <span class="hljs-keyword">import</span> KMeans
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt

<span class="hljs-comment"># 1. ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®</span>
X, y = make_blobs(n_samples=<span class="hljs-number">300</span>, centers=<span class="hljs-number">4</span>, cluster_std=<span class="hljs-number">0.6</span>, random_state=<span class="hljs-number">42</span>)

<span class="hljs-comment"># 2. è®­ç»ƒ K-Means</span>
kmeans = KMeans(n_clusters=<span class="hljs-number">4</span>, random_state=<span class="hljs-number">42</span>, n_init=<span class="hljs-number">10</span>)
y_pred = kmeans.fit_predict(X)

<span class="hljs-comment"># 3. å¯è§†åŒ–ç»“æœ</span>
plt.scatter(X[:, <span class="hljs-number">0</span>], X[:, <span class="hljs-number">1</span>], c=y_pred, s=<span class="hljs-number">30</span>, cmap=<span class="hljs-string">'viridis'</span>)
plt.scatter(kmeans.cluster_centers_[:, <span class="hljs-number">0</span>], kmeans.cluster_centers_[:, <span class="hljs-number">1</span>],
            c=<span class="hljs-string">'red'</span>, marker=<span class="hljs-string">'X'</span>, s=<span class="hljs-number">200</span>, label=<span class="hljs-string">'Centroids'</span>)
plt.legend()
plt.title(<span class="hljs-string">"K-Means Clustering"</span>)
plt.show()
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œä¸åŒé¢œè‰²è¡¨ç¤ºä¸åŒç°‡ï¼Œçº¢è‰² X ä¸ºèšç±»ä¸­å¿ƒã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fbc5299f7e86494186c6599a1ea24857~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWljb3Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769258700&amp;x-signature=MaOGFmkgTpG4Wm6I6R3dNsa2ODY%3D" alt="" loading="lazy"/></p>
<p>æ€»ç»“ç¯èŠ‚ï¼K-Means ä½œä¸ºç»å…¸çš„æ— ç›‘ç£å­¦ä¹ æ–¹æ³•ï¼Œå‡­å€Ÿå…¶é«˜æ•ˆæ€§å’Œç›´è§‚æ€§ï¼Œæˆä¸ºæœ€å¸¸ç”¨çš„èšç±»ç®—æ³•ä¹‹ä¸€ã€‚ä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼Œéœ€è¦æ³¨æ„ç°‡æ•°é€‰æ‹©ã€åˆå§‹ç‚¹æ•æ„Ÿæ€§ä»¥åŠå¯¹å¤æ‚åˆ†å¸ƒçš„é€‚ç”¨æ€§é—®é¢˜ã€‚é’ˆå¯¹è¿™äº›ä¸è¶³ï¼Œç ”ç©¶è€…æå‡ºäº† K-Means++ã€Mini-Batch K-Means ç­‰æ”¹è¿›æ–¹æ³•ï¼Œä½¿å…¶åœ¨å¤§è§„æ¨¡æœºå™¨å­¦ä¹ ä»»åŠ¡ä¸­ä¾ç„¶å…·æœ‰é‡è¦åœ°ä½ã€‚</p>
<h2 data-id="heading-2">K-Medoids èšç±»</h2>
<p>K-Medoidsï¼ˆåˆç§° PAMï¼ŒPartitioning Around Medoidsï¼‰æ˜¯ä¸€ç§åŸºäºåˆ’åˆ†çš„èšç±»æ–¹æ³•ï¼Œä¸ K-Means ç±»ä¼¼ï¼Œä½†å®ƒä½¿ç”¨æ•°æ®é›†ä¸­çœŸå®å­˜åœ¨çš„ç‚¹ä½œä¸ºç°‡ä¸­å¿ƒï¼ˆç§°ä¸ºâ€œMedoidâ€ï¼‰ï¼Œè€Œä¸æ˜¯å‡å€¼å‘é‡ã€‚è¿™ä½¿å¾— K-Medoids å¯¹ å¼‚å¸¸å€¼å’Œå™ªå£°æ›´åŠ é²æ£’ï¼Œé€‚åˆå¤„ç†éæ¬§å¼è·ç¦»æˆ–ç¦»æ•£å‹æ•°æ®ã€‚</p>
<p>K-Medoids çš„ç›®æ ‡å‡½æ•°æ˜¯æœ€å°åŒ–æ ·æœ¬ä¸æ‰€å±ç°‡ä¸­å¿ƒçš„è·ç¦»å’Œï¼š</p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mo>âˆ‘</mo><mrow><mi>x</mi><mo>âˆˆ</mo><msub><mi>C</mi><mi>i</mi></msub></mrow></msub><mi>d</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>m</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">J = \sum_{i=1}^{K} \sum_{x \in C_i} d(x, m_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.381em;vertical-align:-0.3998em;"/><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1786em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">âˆˆ</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.0715em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span/></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3998em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></span>ï¼šç°‡çš„ä¸ªæ•°</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼šç¬¬<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"/><span class="mord mathnormal">i</span></span></span></span></span> ä¸ªç°‡</li>
<li>ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">m_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> ç°‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> çš„çš„ä¸­å¿ƒï¼ˆmedoidï¼Œå³ç°‡ä¸­æŸä¸ªå®é™…ç‚¹ï¼‰</li>
<li>ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>m</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(x, m_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>æ ·æœ¬ç‚¹ä¸ç°‡ä¸­å¿ƒ ä¹‹é—´çš„è·ç¦»ï¼ˆå¯ä»¥æ˜¯æ¬§å¼è·ç¦»ã€æ›¼å“ˆé¡¿è·ç¦»ï¼Œç”šè‡³éå‘é‡ç©ºé—´è·ç¦»ï¼‰</li>
</ul>
<p>ä¸ K-Means çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼š</p>
<ul>
<li>K-Means çš„ä¸­å¿ƒæ˜¯ ç°‡å†…å‡å€¼ï¼Œå¯èƒ½ä¸å±äºæ•°æ®é›†ï¼›</li>
<li>K-Medoids çš„ä¸­å¿ƒæ˜¯ çœŸå®æ ·æœ¬ç‚¹ï¼Œå› æ­¤å¯¹å™ªå£°æ›´ç¨³å¥ã€‚</li>
</ul>
<p>K-Medoids æœ€ç»å…¸çš„å®ç°æ˜¯ PAMï¼ˆPartitioning Around Medoidsï¼‰ï¼Œæµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>åˆå§‹åŒ–ï¼šéšæœºé€‰æ‹© K ä¸ªç‚¹ä½œä¸ºåˆå§‹ medoidã€‚</li>
<li>åˆ†é…æ ·æœ¬ï¼šå°†æ¯ä¸ªæ ·æœ¬åˆ†é…ç»™è·ç¦»æœ€è¿‘çš„ medoidã€‚</li>
<li>æ›´æ–° medoidï¼š</li>
</ol>
<ul>
<li>
<p>å¯¹äºæ¯ä¸ªç°‡ï¼Œå°è¯•ç”¨ç°‡ä¸­å…¶ä»–ç‚¹æ›¿æ¢å½“å‰ medoidï¼›</p>
</li>
<li>
<p>è®¡ç®—ä»£ä»·å‡½æ•°å˜åŒ–ï¼Œå¦‚æœä»£ä»·å‡å°‘ï¼Œåˆ™æ›´æ–° medoidã€‚</p>
</li>
</ul>
<ol start="4">
<li>è¿­ä»£ï¼šé‡å¤æ­¥éª¤ 2-3ï¼Œç›´åˆ° medoid ä¸å†å˜åŒ–æˆ–ä»£ä»·å‡½æ•°æ”¶æ•›ã€‚ PAM çš„è®¡ç®—å¤æ‚åº¦è¾ƒé«˜ï¼Œçº¦ä¸º
<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>k</mi><mo>â‹…</mo><mo stretchy="false">(</mo><mi>n</mi><mo>âˆ’</mo><mi>k</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(k \cdot (n-k)^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>ï¼Œå› æ­¤åœ¨å¤§è§„æ¨¡æ•°æ®é›†ä¸Šå¸¸ç”¨ CLARAï¼ˆClustering Large Applicationsï¼‰ æˆ– CLARANS è¿›è¡ŒåŠ é€Ÿã€‚</li>
</ol>
<p>ä¸‹é¢åŸºäºScikit-learn-extraç¼–å†™äº†ä¸€æ®µç¤ºä¾‹ä»£ç ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> make_blobs
<span class="hljs-keyword">from</span> sklearn_extra.cluster <span class="hljs-keyword">import</span> KMedoids
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt

<span class="hljs-comment"># 1. ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®</span>
X, y = make_blobs(n_samples=<span class="hljs-number">300</span>, centers=<span class="hljs-number">4</span>, cluster_std=<span class="hljs-number">0.6</span>, random_state=<span class="hljs-number">42</span>)

<span class="hljs-comment"># 2. è®­ç»ƒ K-Medoids</span>
kmedoids = KMedoids(n_clusters=<span class="hljs-number">4</span>, random_state=<span class="hljs-number">42</span>, metric=<span class="hljs-string">'euclidean'</span>)
y_pred = kmedoids.fit_predict(X)

<span class="hljs-comment"># 3. å¯è§†åŒ–ç»“æœ</span>
plt.scatter(X[:, <span class="hljs-number">0</span>], X[:, <span class="hljs-number">1</span>], c=y_pred, s=<span class="hljs-number">30</span>, cmap=<span class="hljs-string">'viridis'</span>)
plt.scatter(kmedoids.cluster_centers_[:, <span class="hljs-number">0</span>], kmedoids.cluster_centers_[:, <span class="hljs-number">1</span>],
            c=<span class="hljs-string">'red'</span>, marker=<span class="hljs-string">'X'</span>, s=<span class="hljs-number">200</span>, label=<span class="hljs-string">'Medoids'</span>)
plt.legend()
plt.title(<span class="hljs-string">"K-Medoids Clustering"</span>)
plt.show()
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œå…¶ä¸­ä¸åŒé¢œè‰²è¡¨ç¤ºä¸åŒç°‡ï¼Œçº¢è‰² X ä¸º medoidã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83d27f3acead4299a0f545912ee820e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWljb3Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769258700&amp;x-signature=9rakAf8zSwgyIz8EUI6NzFNaa7c%3D" alt="" loading="lazy"/></p>
<p>K-Medoids æ˜¯ K-Means çš„ä¸€ç§ç¨³å¥å˜ä½“ï¼Œé€‚åˆåœ¨å­˜åœ¨å™ªå£°ã€å¼‚å¸¸ç‚¹æˆ–éæ¬§å¼è·ç¦»æƒ…å†µä¸‹ä½¿ç”¨ã€‚å®ƒçš„ ä¼˜åŠ¿ åœ¨äºç°‡ä¸­å¿ƒæ˜¯å®é™…æ ·æœ¬ç‚¹ï¼Œç»“æœæ›´å…·å¯è§£é‡Šæ€§ï¼ŒåŒæ—¶å¯¹å¼‚å¸¸å€¼å’Œå™ªå£°æ›´é²æ£’ï¼Œå¹¶ä¸”å¯ç”¨äºä»»æ„è·ç¦»åº¦é‡ï¼Œä¸å±€é™äºæ¬§å¼ç©ºé—´ã€‚ä½†å®ƒè®¡ç®—å¤æ‚åº¦è¾ƒé«˜ï¼Œä¸é€‚åˆå¤§è§„æ¨¡æ•°æ®ï¼Œå¹¶ä¸”å¯¹ç°‡å½¢çŠ¶ä»æœ‰ä¸€å®šå‡è®¾ï¼Œä¸é€‚åˆå¤„ç†å¤æ‚éå‡¸ç°‡ã€‚</p>
<p>åœ¨å®è·µä¸­ï¼ŒK-Medoids æ›´é€‚åˆå°è§„æ¨¡ã€é«˜è´¨é‡æ•°æ®é›†ï¼Œæˆ–å¯¹ç¨³å¥æ€§æœ‰è¾ƒé«˜è¦æ±‚çš„ä»»åŠ¡ï¼Œè€Œåœ¨å¤§è§„æ¨¡åœºæ™¯ä¸­å¾€å¾€ç»“åˆ CLARA/CLARANS è¿›è¡Œä¼˜åŒ–ã€‚</p>
<p>æœ€æ–°çš„æ–‡ç« éƒ½åœ¨å…¬ä¼—å·aicotingæ›´æ–°ï¼Œåˆ«å¿˜è®°å…³æ³¨å“¦ï¼ï¼ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ–‡ææ‡‚å±‚æ¬¡èšç±»å’Œå¯†åº¦èšç±»æ–¹æ³•ï¼]]></title>    <link>https://juejin.cn/post/7595842144907493426</link>    <guid>https://juejin.cn/post/7595842144907493426</guid>    <pubDate>2026-01-17T12:49:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595842144907493426" data-draft-id="7595890117865865262" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ–‡ææ‡‚å±‚æ¬¡èšç±»å’Œå¯†åº¦èšç±»æ–¹æ³•ï¼"/> <meta itemprop="keywords" content="ç®—æ³•,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-17T12:49:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="aicoting"/> <meta itemprop="url" content="https://juejin.cn/user/933911964427818"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ–‡ææ‡‚å±‚æ¬¡èšç±»å’Œå¯†åº¦èšç±»æ–¹æ³•ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/933911964427818/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    aicoting
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T12:49:51.000Z" title="Sat Jan 17 2026 12:49:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ¨èç›´æ¥ç½‘ç«™åœ¨çº¿é˜…è¯»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Faicoting.cn%2F" target="_blank" title="https://aicoting.cn/" ref="nofollow noopener noreferrer">aicoting AIç®—æ³•é¢è¯•å­¦ä¹ åœ¨çº¿ç½‘ç«™</a></p>
</blockquote>
<p>èšç±»ï¼ˆClusteringï¼‰æ˜¯ä¸€ç§å…¸å‹çš„æ— ç›‘ç£å­¦ä¹ æ–¹æ³•ï¼Œå…¶ç›®æ ‡æ˜¯åœ¨æ²¡æœ‰æ ‡ç­¾ä¿¡æ¯çš„æƒ…å†µä¸‹ï¼Œå°†æ•°æ®æ ·æœ¬æŒ‰ç…§ç›¸ä¼¼æ€§åˆ’åˆ†ä¸ºè‹¥å¹²ç°‡ï¼Œä½¿å¾—åŒä¸€ç°‡å†…çš„æ ·æœ¬ç›¸ä¼¼åº¦é«˜ï¼Œä¸åŒç°‡ä¹‹é—´å·®å¼‚æ˜¾è‘—ã€‚å¸¸è§æ–¹æ³•åŒ…æ‹¬åŸºäºåˆ’åˆ†çš„ K-Meansã€åŸºäºå±‚æ¬¡çš„ å±‚æ¬¡èšç±»ã€ä»¥åŠåŸºäºå¯†åº¦çš„ DBSCANã€OPTICS ç­‰ã€‚èšç±»å¹¿æ³›åº”ç”¨äºç”¨æˆ·åˆ†ç¾¤ã€å¸‚åœºç»†åˆ†ã€æ–‡æœ¬ä¸»é¢˜å‘ç°ã€å›¾åƒåˆ†å‰²ç­‰ä»»åŠ¡ï¼Œæ˜¯æ•°æ®æŒ–æ˜å’Œæ¢ç´¢æ€§åˆ†æä¸­çš„é‡è¦å·¥å…·ã€‚</p>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯å±‚æ¬¡èšç±»</h2>
<p>åœ¨æ— ç›‘ç£å­¦ä¹ æ–¹æ³•ä¸­ï¼Œå±‚æ¬¡èšç±»ï¼ˆHierarchical Clusteringï¼‰æ˜¯ä¸€ç§å¸¸è§ä¸”ç›´è§‚çš„èšç±»æ–¹æ³•ï¼Œå¹¿æ³›åº”ç”¨äºæ–‡æœ¬åˆ†æä¸­çš„ä¸»é¢˜å‘ç°ã€åŸºå› è¡¨è¾¾æ•°æ®çš„æ¨¡å¼è¯†åˆ«ã€ç¤¾ä¼šç½‘ç»œä¸­ç¾¤ä½“ç»“æ„æŒ–æ˜ã€ä»¥åŠå›¾åƒå¤„ç†å’Œå¸‚åœºç»†åˆ†ç­‰åœºæ™¯ã€‚ä¸ K-Means ç­‰åˆ’åˆ†å¼æ–¹æ³•ä¸åŒï¼Œå±‚æ¬¡èšç±»é€šè¿‡æ„å»ºæ ·æœ¬é—´çš„å±‚æ¬¡å…³ç³»ï¼Œå½¢æˆä¸€æ£µèšç±»æ ‘ï¼ˆdendrogramï¼‰ï¼Œå¸®åŠ©æˆ‘ä»¬ç†è§£æ•°æ®çš„å¤šå±‚æ¬¡ç»“æ„ã€‚</p>
<p>å±‚æ¬¡èšç±»çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š</p>
<ul>
<li>è‡ªåº•å‘ä¸Šï¼ˆå‡èšå‹ï¼ŒAgglomerativeï¼‰ï¼šåˆå§‹æ—¶å°†æ¯ä¸ªæ ·æœ¬è§†ä¸ºä¸€ä¸ªç°‡ï¼Œç„¶åé€æ­¥å°†æœ€ç›¸ä¼¼çš„ç°‡åˆå¹¶ï¼Œç›´åˆ°æœ€ç»ˆå½¢æˆä¸€ä¸ªç°‡æˆ–è¾¾åˆ°è®¾å®šçš„ç°‡æ•°ã€‚</li>
<li>è‡ªé¡¶å‘ä¸‹ï¼ˆåˆ†è£‚å‹ï¼ŒDivisiveï¼‰ï¼šåˆå§‹æ—¶å°†æ‰€æœ‰æ ·æœ¬è§†ä¸ºä¸€ä¸ªæ•´ä½“ç°‡ï¼Œç„¶åé€æ­¥åˆ†è£‚ä¸ºæ›´å°çš„ç°‡ï¼Œç›´è‡³è¾¾åˆ°æŒ‡å®šçš„ç°‡æ•°ã€‚</li>
</ul>
<p>å¸¸ç”¨çš„æ˜¯å‡èšå‹å±‚æ¬¡èšç±»ï¼Œå› ä¸ºå…¶è®¡ç®—æ•ˆç‡æ›´é«˜ä¸”ç›´è§‚ã€‚</p>
<p>å±‚æ¬¡èšç±»ä¾èµ–äºç°‡é—´çš„è·ç¦»å®šä¹‰ï¼Œä¸åŒçš„åº¦é‡æ–¹å¼ä¼šå½±å“ç»“æœï¼š</p>
<ul>
<li>å•é“¾æ³•ï¼ˆSingle Linkageï¼‰ï¼šç°‡é—´æœ€çŸ­è·ç¦»ã€‚å®¹æ˜“å‡ºç°â€œé“¾å¼æ•ˆåº”â€ã€‚</li>
<li>å…¨é“¾æ³•ï¼ˆComplete Linkageï¼‰ï¼šç°‡é—´æœ€é•¿è·ç¦»ã€‚å€¾å‘äºå¾—åˆ°ç´§å‡‘çš„ç°‡ã€‚</li>
<li>å¹³å‡é“¾æ³•ï¼ˆAverage Linkageï¼‰ï¼šç°‡é—´å¹³å‡è·ç¦»ã€‚ç»¼åˆäº†å•é“¾ä¸å…¨é“¾çš„ç‰¹ç‚¹ã€‚</li>
<li>Ward æ–¹æ³•ï¼šåŸºäºå¹³æ–¹è¯¯å·®æœ€å°åŒ–ï¼Œå€¾å‘äºç”Ÿæˆæ–¹å·®è¾ƒå°ã€å¤§å°ç›¸å¯¹å‡è¡¡çš„ç°‡ã€‚</li>
</ul>
<p>ä»¥å‡èšå‹å±‚æ¬¡èšç±»ä¸ºä¾‹ï¼Œç®—æ³•çš„å·¥ä½œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>å°†æ¯ä¸ªæ ·æœ¬ä½œä¸ºä¸€ä¸ªç‹¬ç«‹ç°‡ã€‚</li>
<li>è®¡ç®—æ‰€æœ‰ç°‡ä¹‹é—´çš„è·ç¦»ã€‚</li>
<li>æ‰¾åˆ°æœ€è¿‘çš„ä¸¤ä¸ªç°‡å¹¶åˆå¹¶ã€‚</li>
<li>æ›´æ–°ç°‡é—´è·ç¦»çŸ©é˜µã€‚</li>
<li>é‡å¤æ­¥éª¤ 2-4ï¼Œç›´åˆ°æ‰€æœ‰æ ·æœ¬è¢«åˆå¹¶ä¸ºä¸€ä¸ªç°‡æˆ–è¾¾åˆ°é¢„è®¾ç°‡æ•°ã€‚</li>
</ol>
<p>æ˜¯ä¸æ˜¯æœ‰ç‚¹åƒäºŒåˆ†æ³•æˆ–è€…å½’å¹¶æ’åºã€‚</p>
<p>æœ€ç»ˆç»“æœå¯ä»¥ç”¨æ ‘çŠ¶å›¾ï¼ˆdendrogramï¼‰ç›´è§‚å±•ç¤ºï¼Œæ¯ä¸ªåˆ†æ”¯çš„é«˜åº¦ä»£è¡¨ç°‡ä¹‹é—´çš„è·ç¦»ã€‚</p>
<p>ä¸‹é¢ç”¨ä¸€æ®µä»£ç å½¢è±¡çš„ç†è§£ä¸€ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> load_iris
<span class="hljs-keyword">from</span> sklearn.cluster <span class="hljs-keyword">import</span> AgglomerativeClustering
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">from</span> scipy.cluster.hierarchy <span class="hljs-keyword">import</span> dendrogram, linkage

<span class="hljs-comment"># 1. åŠ è½½æ•°æ®</span>
iris = load_iris()
X = iris.data

<span class="hljs-comment"># 2. å±‚æ¬¡èšç±» (AgglomerativeClustering)</span>
model = AgglomerativeClustering(n_clusters=<span class="hljs-number">3</span>, linkage=<span class="hljs-string">'ward'</span>)
labels = model.fit_predict(X)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"èšç±»ç»“æœï¼š"</span>, labels[:<span class="hljs-number">20</span>])

<span class="hljs-comment"># 3. ç»˜åˆ¶æ ‘çŠ¶å›¾</span>
Z = linkage(X, method=<span class="hljs-string">'ward'</span>)
plt.figure(figsize=(<span class="hljs-number">8</span>, <span class="hljs-number">5</span>))
dendrogram(Z, truncate_mode=<span class="hljs-string">'level'</span>, p=<span class="hljs-number">3</span>)
plt.title(<span class="hljs-string">"Hierarchical Clustering Dendrogram"</span>)
plt.xlabel(<span class="hljs-string">"Sample Index"</span>)
plt.ylabel(<span class="hljs-string">"Distance"</span>)
plt.show()
</code></pre>
<p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9498d033350d4da99a0cc35811e68cba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWljb3Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769258990&amp;x-signature=sLZIedr05Pxar6Ev3bCmCQT0p4k%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ç®€å•è§£é‡Šä¸€ä¸‹ï¼Œæ¯”å¦‚ç¬¬ä¸€æ¬¡èšç±»ï¼Œç¬¬7ä¸ªæ ·æœ¬å’Œç¬¬8ä¸ªæ ·æœ¬è·ç¦»æœ€è¿‘ï¼Œé‚£ä¹ˆä»–ä»¬å°±æˆä¸€ä¸ªç»„åˆï¼Œç»„åˆä¹‹é—´å†è¿›è¡Œèšç±»ï¼Œæœ€åæ˜¯ä¸æ˜¯å°±èšæˆäº†ç›®æ ‡ç±»åˆ«äº†ã€‚</p>
<p>å±‚æ¬¡èšç±»çš„ä¼˜åŠ¿åœ¨äºæ— éœ€é¢„å…ˆæŒ‡å®šç°‡æ•°ï¼Œèƒ½å¤Ÿæ­ç¤ºæ•°æ®çš„å¤šå±‚æ¬¡ç»“æ„ï¼Œä¸”ç»“æœå¯è§†åŒ–ç›´è§‚ã€‚ä½†å…¶ç¼ºç‚¹æ˜¯è®¡ç®—å¤æ‚åº¦è¾ƒé«˜ï¼Œéš¾ä»¥æ‰©å±•åˆ°è¶…å¤§è§„æ¨¡æ•°æ®é›†ï¼ŒåŒæ—¶å¯¹å™ªå£°ä¸å¼‚å¸¸å€¼æ•æ„Ÿã€‚åœ¨å°è§„æ¨¡æ•°æ®åˆ†æã€æ¨¡å¼æ¢ç´¢å’Œæ•°æ®å¯è§†åŒ–åœºæ™¯ä¸­ï¼Œå±‚æ¬¡èšç±»ä¾ç„¶æ˜¯ä¸€ç§éå¸¸æœ‰ä»·å€¼çš„æ–¹æ³•ã€‚</p>
<h2 data-id="heading-1">å¯†åº¦èšç±»æ–¹æ³•</h2>
<p>å¯†åº¦èšç±»æ–¹æ³•é€šè¿‡å¯»æ‰¾æ•°æ®ç©ºé—´ä¸­é«˜å¯†åº¦åŒºåŸŸæ¥åˆ’åˆ†ç°‡ï¼Œèƒ½å¤Ÿè‡ªç„¶åœ°å¤„ç†å™ªå£°å’Œéå‡¸å½¢ç°‡ç»“æ„ï¼Œæ˜¯ä¼ ç»Ÿåˆ’åˆ†å¼æ–¹æ³•ï¼ˆå¦‚ K-Meansï¼‰éš¾ä»¥è§£å†³çš„é—®é¢˜ã€‚æˆ‘ä»¬å‡ºå»ç©åœ¨åœ°å›¾ä¸­æœç´¢ç¾é£Ÿï¼Œè¿™äº›çƒ­ç‚¹åŒºåŸŸæˆ–è€…äººå£äº‹ä»¶èšé›†åŒºéƒ½æ˜¯é€šè¿‡å¯†åº¦èšç±»æ–¹æ³•å®ç°çš„ã€‚</p>
<p>DBSCANï¼ˆDensity-Based Spatial Clustering of Applications with Noiseï¼‰å’Œ OPTICSï¼ˆOrdering Points To Identify the Clustering Structureï¼‰æ˜¯ä¸¤ç§å…¸å‹çš„å¯†åº¦èšç±»æ–¹æ³•ã€‚</p>
<h3 data-id="heading-2">1.DBSCAN</h3>
<p>DBSCAN çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šç°‡æ˜¯ç”±å¯†åº¦å¯è¾¾çš„ç‚¹ç»„æˆçš„åŒºåŸŸï¼Œè€Œä½å¯†åº¦åŒºåŸŸè§†ä¸ºå™ªå£°ã€‚</p>
<ul>
<li>æ ¸å¿ƒæ¦‚å¿µï¼š</li>
<li>-é‚»åŸŸï¼šæ ·æœ¬ç‚¹å‘¨å›´åŠå¾„ä¸º çš„åŒºåŸŸã€‚</li>
<li>æ ¸å¿ƒç‚¹ï¼šå…¶ -é‚»åŸŸå†…ç‚¹æ•° â‰¥ minPtsã€‚</li>
<li>è¾¹ç•Œç‚¹ï¼šä½äºæ ¸å¿ƒç‚¹ -é‚»åŸŸå†…ï¼Œä½†æœ¬èº«ç‚¹æ•° &lt; minPtsã€‚</li>
<li>å™ªå£°ç‚¹ï¼šä¸å±äºä»»ä½•ç°‡çš„ç‚¹ã€‚</li>
<li>èšç±»è§„åˆ™ï¼š</li>
</ul>
<ol>
<li>ä»ä»»æ„æœªè®¿é—®ç‚¹å¼€å§‹ï¼Œè‹¥å…¶ä¸ºæ ¸å¿ƒç‚¹ï¼Œåˆ™ä»¥è¯¥ç‚¹ä¸ºä¸­å¿ƒæ‰©å±•ç°‡ï¼Œå°†å¯†åº¦å¯è¾¾çš„ç‚¹åŠ å…¥ç°‡ã€‚</li>
<li>å¯¹ç°‡ä¸­æ–°å¢çš„æ ¸å¿ƒç‚¹é‡å¤æ‰©å±•è¿‡ç¨‹ï¼Œç›´åˆ°ç°‡æ— æ³•å†æ‰©å±•ã€‚</li>
<li>é‡å¤ä»¥ä¸Šæ­¥éª¤ï¼Œç›´åˆ°æ‰€æœ‰ç‚¹éƒ½è¢«è®¿é—®è¿‡ã€‚</li>
</ol>
<p>DBSCAN å¯ä»¥å‘ç°ä»»æ„å½¢çŠ¶çš„ç°‡ï¼Œèƒ½è‡ªåŠ¨è¯†åˆ«å™ªå£°ç‚¹ï¼Œå¹¶ä¸”æ— éœ€é¢„è®¾ç°‡æ•°ã€‚ä½†æ˜¯å®ƒå¯¹å‚æ•° å’Œ minPts æ¯”è¾ƒæ•æ„Ÿï¼ŒåŒæ—¶åœ¨é«˜ç»´æ•°æ®ä¸­æ•ˆæœä¼šæœ‰æ‰€ä¸‹é™ï¼Œå› ä¸ºé«˜ç»´æ•°æ®ä¸­å¯†åº¦æ¦‚å¿µå°±å¤±æ•ˆäº†ã€‚</p>
<h3 data-id="heading-3">2.OPTICS</h3>
<p>OPTICS æ˜¯ DBSCAN çš„æ”¹è¿›ï¼Œä¸»è¦è§£å†³ DBSCAN åœ¨å‚æ•°é€‰æ‹©ï¼ˆå°¤å…¶æ˜¯ ï¼‰ä¸Šçš„é™åˆ¶ã€‚</p>
<ul>
<li>æ ¸å¿ƒæ€æƒ³ï¼šä¸ç›´æ¥ç”Ÿæˆç°‡ï¼Œè€Œæ˜¯ç”Ÿæˆ å¯è¾¾è·ç¦»åºåˆ—ï¼ˆreachability distanceï¼‰ï¼Œè®°å½•ç‚¹ä¹‹é—´çš„å¯†åº¦ç»“æ„ã€‚</li>
<li>èšç±»è§„åˆ™ï¼š</li>
</ul>
<ol>
<li>å¯¹æ¯ä¸ªç‚¹è®¡ç®—æ ¸å¿ƒè·ç¦»ï¼ˆcore distanceï¼‰å’Œå¯è¾¾è·ç¦»ï¼ˆreachability distanceï¼‰ï¼›</li>
<li>æŒ‰å¯è¾¾è·ç¦»é¡ºåºè®¿é—®æ‰€æœ‰ç‚¹ï¼Œå½¢æˆä¸€ä¸ªæœ‰åºåˆ—è¡¨ï¼›</li>
<li>å¯é€šè¿‡å¯è¾¾è·ç¦»çš„çªå˜æ£€æµ‹ä¸åŒå¯†åº¦åŒºåŸŸï¼Œä»è€Œè¯†åˆ«ç°‡ã€‚</li>
</ol>
<p>OPTICSèƒ½å‘ç°ä¸åŒå¯†åº¦çš„ç°‡ï¼Œå¹¶ä¸”ä¸éœ€è¦ä¸¥æ ¼æŒ‡å®š Îµ å€¼ï¼Œé€‚åˆæ•°æ®å¯†åº¦ä¸å‡åŒ€çš„åœºæ™¯ã€‚ä½†æ˜¯è®¡ç®—å¤æ‚åº¦æ¯” DBSCAN é«˜ï¼Œç»“æœéœ€è¦è¿›ä¸€æ­¥åˆ†ææ‰èƒ½ç¡®å®šç°‡è¾¹ç•Œã€‚ ä¸‹é¢æˆ‘ä»¬ç”¨å®ç°çš„ä»£ç å±•ç¤ºä¸€ä¸‹è¿™ä¸¤ç§æ–¹æ³•çš„æ•ˆæœå¥½åï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> sklearn.datasets <span class="hljs-keyword">import</span> make_moons
<span class="hljs-keyword">from</span> sklearn.cluster <span class="hljs-keyword">import</span> DBSCAN
<span class="hljs-keyword">from</span> sklearn.cluster <span class="hljs-keyword">import</span> OPTICS
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt

<span class="hljs-comment"># ç”Ÿæˆéå‡¸å½¢æ•°æ®</span>
X, y = make_moons(n_samples=<span class="hljs-number">300</span>, noise=<span class="hljs-number">0.05</span>, random_state=<span class="hljs-number">42</span>)

<span class="hljs-comment"># DBSCAN èšç±»</span>
dbscan = DBSCAN(eps=<span class="hljs-number">0.2</span>, min_samples=<span class="hljs-number">5</span>)
labels_dbscan = dbscan.fit_predict(X)

<span class="hljs-comment"># OPTICS èšç±»</span>
optics = OPTICS(min_samples=<span class="hljs-number">5</span>, xi=<span class="hljs-number">0.05</span>, min_cluster_size=<span class="hljs-number">0.1</span>)
labels_optics = optics.fit_predict(X)

<span class="hljs-comment"># å¯è§†åŒ– DBSCAN</span>
plt.figure(figsize=(<span class="hljs-number">12</span>,<span class="hljs-number">5</span>))
plt.subplot(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>)
plt.scatter(X[:,<span class="hljs-number">0</span>], X[:,<span class="hljs-number">1</span>], c=labels_dbscan, cmap=<span class="hljs-string">'viridis'</span>, s=<span class="hljs-number">30</span>)
plt.title(<span class="hljs-string">"DBSCAN Clustering"</span>)

<span class="hljs-comment"># å¯è§†åŒ– OPTICS</span>
plt.subplot(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>)
plt.scatter(X[:,<span class="hljs-number">0</span>], X[:,<span class="hljs-number">1</span>], c=labels_optics, cmap=<span class="hljs-string">'viridis'</span>, s=<span class="hljs-number">30</span>)
plt.title(<span class="hljs-string">"OPTICS Clustering"</span>)
plt.show()
</code></pre>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°DBSCAN å’Œ OPTICS éƒ½èƒ½è¯†åˆ«éå‡¸ç°‡ï¼ŒOPTICS å¯¹ä¸åŒå¯†åº¦ç°‡è¡¨ç°æ›´ç¨³å¥ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4771130d2c6f4e41832259f9e51450cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWljb3Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769258990&amp;x-signature=DFW34DOEMOeZ%2BQIJb6U5gMIiu3M%3D" alt="" loading="lazy"/></p>
<p>æ€»ç»“æ—¶åˆ»åˆ°ï¼ŒDBSCAN å’Œ OPTICS æ˜¯å¯†åº¦èšç±»çš„ä»£è¡¨æ–¹æ³•ï¼š</p>
<ul>
<li>DBSCAN ç®€å•é«˜æ•ˆï¼Œé€‚åˆç°‡å¯†åº¦å‡åŒ€ã€å™ªå£°ç‚¹æ˜ç¡®çš„æ•°æ®ï¼›</li>
<li>OPTICS è§£å†³äº† DBSCAN å¯¹å‚æ•°æ•æ„Ÿçš„é—®é¢˜ï¼Œèƒ½å¤„ç†ä¸åŒå¯†åº¦çš„ç°‡ï¼Œä½†è®¡ç®—å¤æ‚åº¦æ›´é«˜ã€‚</li>
</ul>
<p>æ€»ä½“æ¥è¯´ï¼Œå¯†åº¦èšç±»æ–¹æ³•åœ¨éçƒå½¢ç°‡ã€å¼‚å¸¸ç‚¹æ£€æµ‹å’Œæ¢ç´¢æ€§æ•°æ®åˆ†æä¸­å…·æœ‰æ˜æ˜¾ä¼˜åŠ¿ï¼Œæ˜¯ä¼ ç»Ÿåˆ’åˆ†èšç±»æ–¹æ³•çš„é‡è¦è¡¥å……ã€‚</p>
<p>æœ€æ–°çš„æ–‡ç« éƒ½åœ¨å…¬ä¼—å·aicotingæ›´æ–°ï¼Œåˆ«å¿˜è®°å…³æ³¨å“¦ï¼ï¼ï¼</p>
<p>ä½œè€…ï¼šaicoting</p>
<p>åˆ†äº«æ˜¯ä¸€ç§ä¿¡ä»°ï¼Œè¿æ¥è®©æˆé•¿æ›´æœ‰æ¸©åº¦ã€‚</p>
<p>æˆ‘ä»¬ä¸‹æ¬¡ä¸è§ä¸æ•£ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[çŸ­ä¿¡éªŒè¯ç åˆè¢«ç›—åˆ·ï¼Ÿè¿™ç¯‡æ–‡ç« å¸®ä½ å°ä½æ‰€æœ‰æ¼æ´]]></title>    <link>https://juejin.cn/post/7595974133096906786</link>    <guid>https://juejin.cn/post/7595974133096906786</guid>    <pubDate>2026-01-17T12:53:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595974133096906786" data-draft-id="7532150298455064614" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="çŸ­ä¿¡éªŒè¯ç åˆè¢«ç›—åˆ·ï¼Ÿè¿™ç¯‡æ–‡ç« å¸®ä½ å°ä½æ‰€æœ‰æ¼æ´"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-01-17T12:53:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€åªå«ç…¤çƒçš„çŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/1732486058745054"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            çŸ­ä¿¡éªŒè¯ç åˆè¢«ç›—åˆ·ï¼Ÿè¿™ç¯‡æ–‡ç« å¸®ä½ å°ä½æ‰€æœ‰æ¼æ´
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1732486058745054/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€åªå«ç…¤çƒçš„çŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T12:53:11.000Z" title="Sat Jan 17 2026 12:53:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>é˜¿åŸæœ€è¿‘åœ¨æˆ‘çš„ç†é™¶ä¸‹ï¼Œå–œæ¬¢çœ‹å„ç§æ–‡ç« å’Œä»£ç ã€‚</p>
<p>é‚£å¤©ä»–ç»™æˆ‘å‘äº†ä¸€ä¸ªä»£ç æˆªå›¾ï¼Œé™„å¸¦ç€å‡ å¥è¯ï¼š</p>
<p>â€œå“¥ä½ çœ‹ï¼Œè¿™æ®µ <code>sendCode</code> å†™å¾—æŒºæ¸…çˆ½çš„ï¼Œä½†æ˜¯æˆ‘å’‹çœ‹ç€ä¸å¯¹åŠ²å‘¢â€</p>
<p>â€œçŸ­ä¿¡éªŒè¯ç è¿™ç§æ¥å£ï¼Œå°±è¿™ä¹ˆæš´éœ²å‡ºå»ï¼Ÿä¼šä¸ä¼šè¢«äººåˆ·çˆ†ï¼Ÿâ€</p>
<p>æˆ‘æ‰«äº†ä¸€çœ¼æˆªå›¾ï¼šä¸€ä¸ª <code>POST /sendCode</code>ï¼Œä¼ æ‰‹æœºå·å°±å‘çŸ­ä¿¡ï¼›æ²¡é™æµã€æ²¡äººæœºæ ¡éªŒã€æ²¡å‘é€é—´éš”ã€ä¹Ÿæ²¡æ¬¡æ•°ä¸Šé™ã€‚</p>
<p>ä»£ç è¶³å¤Ÿæ¸…çˆ½ï¼Œä½†å®‰å…¨æ€§ä¹Ÿç¡®å®æ¸…çˆ½ï¼Œçœ‹ç€å°±é€å¿ƒå‡‰ã€‚</p>
<p>æˆ‘è·Ÿé˜¿åŸè¯´ï¼šçŸ­ä¿¡éªŒè¯ç è¿™ä¸ªä¸œè¥¿ï¼Œæœ¬è´¨ä¸Šå¹¶ä¸æ˜¯ä¸ªæ™®é€šçš„ä¸šåŠ¡æ¥å£ã€‚è¿™æ®µä»£ç ç¡®å®å†™å¾—å¾ˆä¼˜é›…ï¼Œä½†å®Œå…¨æ²¡é˜²æŠ¤ï¼Œé‚£ä¸€æ—¦å‘ç”Ÿæ„å¤–ï¼Œå®ƒä¹Ÿä¼šä¼˜é›…åœ°æŠŠçŸ­ä¿¡é¢„ç®—é€èµ°ï¼Œç”šè‡³æ”»å‡»è€…éƒ½ä¸éœ€è¦å¤šå‰å®³ï¼Œåªè¦ä¸€æ®µè„šæœ¬å°±å¤Ÿäº†ã€‚</p>
<p>æ‰€ä»¥è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬æŠŠçŸ­ä¿¡éªŒè¯ç å‘é€é“¾è·¯é‡Œæœ€å¸¸è§çš„æ¼æ´æ‹†å¼€è®²æ˜ç™½ï¼Œå†æŒ‰æ¼æ´é€ä¸ªå»åšé˜²å¾¡ã€‚</p>
<p>è¦æ³¨æ„çš„æ˜¯ï¼Œæœ‰äº›é˜²å¾¡æªæ–½ä»¥ç‰ºç‰²ç”¨æˆ·ä½“éªŒä¸ºä»£ä»·ï¼Œä½†è¿™ä¸€èˆ¬éƒ½æ˜¯åœ¨<strong>å®‰å…¨ã€æˆæœ¬ã€è½¬åŒ–ç‡</strong>ä¹‹é—´åšè¿‡æƒè¡¡åçš„ç»¼åˆé€‰æ‹©ï¼Œè€Œä¸æ˜¯ä¸ºäº†å®‰å…¨è€Œå®‰å…¨ã€‚</p>
<p>è€å¿ƒçœ‹å®Œï¼Œä½ ä¸€å®šæœ‰æ‰€æ”¶è·ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7866e03a8c4b4677b7753f0312a6bcc5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5Y-q5Y-r54Wk55CD55qE54yr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769259191&amp;x-signature=ZODVJ062kE4J3CFz5RIH5p3lOUE%3D" alt="Text Love GIF by Pudgy Penguins.gif" loading="lazy"/></p>
<h2 data-id="heading-1">æ­£æ–‡</h2>
<h3 data-id="heading-2">å¸¸è§æ¼æ´</h3>
<h4 data-id="heading-3">æ¼æ´ 1ï¼šæ²¡æœ‰é¢‘ç‡é™åˆ¶ï¼ˆæˆ–é™åˆ¶å¤ªå•è–„ï¼‰</h4>
<ul>
<li>åŒä¸€ä¸ª IP / åŒä¸€ä¸ªæ‰‹æœºå·å¯ä»¥é«˜é¢‘è¯·æ±‚</li>
<li>æ”»å‡»è„šæœ¬ä¸€åˆ†é’Ÿå‡ ç™¾æ¬¡ï¼Œæ¥å£ç…§å•å…¨æ”¶</li>
</ul>
<h4 data-id="heading-4">æ¼æ´ 2ï¼šåªæŒ‰æ‰‹æœºå·é™åˆ¶ï¼Œä¸æŒ‰ IP / è®¾å¤‡ / ç”¨æˆ·é™åˆ¶</h4>
<ul>
<li>æ”»å‡»è€…æ¢æ‰‹æœºå·å°±ç»•è¿‡</li>
<li>æˆ–è€…ç”¨ä»£ç†æ± æ¢ IP ç»•è¿‡å• IP è§„åˆ™</li>
</ul>
<h4 data-id="heading-5">æ¼æ´ 3ï¼šç¼ºå°‘äººæœºæ ¡éªŒï¼ˆå›¾å½¢/æ»‘åŠ¨/è¡Œä¸ºéªŒè¯ç ï¼‰</h4>
<ul>
<li>å‘é€éªŒè¯ç å˜æˆä¸€ä¸ªæ— é—¨æ§›çš„æ¥å£</li>
<li>è„šæœ¬å®Œå…¨å¯ä»¥æ¨¡æ‹Ÿæ­£å¸¸è¯·æ±‚æµç¨‹</li>
</ul>
<h4 data-id="heading-6">æ¼æ´ 4ï¼šéªŒè¯ç æ ¡éªŒé“¾è·¯å¯è¢«æš´åŠ›å°è¯•</h4>
<ul>
<li>éªŒè¯æ¥å£ä¸é™åˆ¶å¤±è´¥æ¬¡æ•°</li>
<li>éªŒè¯ç è¿‡é•¿æœ‰æ•ˆæœŸã€å¯é‡å¤ä½¿ç”¨</li>
<li>å¯¼è‡´çŒœç æˆ–æ’ç çš„é£é™©ä¸Šå‡</li>
</ul>
<h4 data-id="heading-7">æ¼æ´ 5ï¼šç¼ºå°‘å¹‚ç­‰ä¸ç›‘æ§</h4>
<ul>
<li>ç”¨æˆ·/å‰ç«¯é‡è¯•ä¹Ÿå¯èƒ½é€ æˆé‡å¤æ‰£è´¹</li>
<li>æ²¡æœ‰å‘Šè­¦ï¼Œå¾€å¾€æ˜¯äº§ç”Ÿè´¦å•åæ‰å‘ç°</li>
</ul>
<h3 data-id="heading-8">å¯¹ç—‡ä¸‹è¯</h3>
<p>ä¸‹é¢æˆ‘ä»¬æŒ‰æ¼æ´å¯¹åº”é˜²å¾¡ç­–ç•¥æ¥å†™ã€‚æ¯ä¸ªç­–ç•¥éƒ½è®²æ¸…æ¥šï¼š</p>
<ol>
<li>è§£å†³äº†ä»€ä¹ˆé—®é¢˜</li>
<li>å¸¦æ¥ä»€ä¹ˆå‰¯ä½œç”¨ï¼ˆç”¨æˆ·ä½“éªŒ/è¯¯ä¼¤ï¼‰</li>
<li>å¦‚ä½•è½åœ°ï¼ˆç»™å‡ºæœ€å°å¿…è¦ä»£ç ç¤ºä¾‹ï¼‰</li>
</ol>
<blockquote>
<p>ç¤ºä¾‹é»˜è®¤ï¼šSpring Boot + Redisï¼Œæƒ³å¿…è¿™ä¹Ÿæ˜¯æœ€é€šç”¨çš„ç»„åˆã€‚</p>
</blockquote>
<h4 data-id="heading-9">1. é¢‘ç‡é™åˆ¶ï¼šå…ˆæŠŠæ— ç©·å‘é€å˜æˆæœ‰é™å‘é€</h4>
<h5 data-id="heading-10">1.1 IP ç»´åº¦é™æµï¼šæŒ¡ä½æœ€å¸¸è§çš„è„šæœ¬</h5>
<p><strong>ä½œç”¨ï¼š</strong> åŒä¸€æ¥æº IP çŸ­æ—¶é—´å†…æ²¡æ³•é¢‘ç¹æ‰“æ¥å£ã€‚<br/>
<strong>å‰¯ä½œç”¨ï¼š</strong> åŒä¸€ä¸ªå‡ºå£ IPï¼ˆæ¯”å¦‚å…¬å¸ç½‘ç»œã€æ ¡å›­ç½‘ï¼‰å¯èƒ½å¤šäººå…±ç”¨ï¼Œé˜ˆå€¼å¤ªå°ä¼šè¯¯ä¼¤ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼šåŒä¸€ IP 60 ç§’æœ€å¤š 5 æ¬¡</strong></p>
<pre><code class="hljs language-ini" lang="ini">String <span class="hljs-attr">ip</span> = request.getRemoteAddr()<span class="hljs-comment">;</span>
String <span class="hljs-attr">key</span> = <span class="hljs-string">"sms:rl:ip:"</span> + ip<span class="hljs-comment">;</span>

Long <span class="hljs-attr">n</span> = redis.opsForValue().increment(key)<span class="hljs-comment">;</span>
if (n != null &amp;&amp; <span class="hljs-attr">n</span> == <span class="hljs-number">1</span>) redis.expire(key, Duration.ofSeconds(<span class="hljs-number">60</span>))<span class="hljs-comment">;</span>
if (n != null &amp;&amp; n &gt; 5) throw new TooManyRequestsException("è¯·æ±‚è¿‡äºé¢‘ç¹")<span class="hljs-comment">;</span>
</code></pre>
<blockquote>
<p>å»ºè®®ï¼šIP é™æµé˜ˆå€¼ä¹Ÿä¸èƒ½æ— è„‘ä¸€åˆ€åˆ‡ï¼Œæ›´æ¨èè¶…è¿‡é˜ˆå€¼åè¿›å…¥æ›´ä¸¥æ ¼æ ¡éªŒï¼ˆæ¯”å¦‚äººæœºéªŒè¯ï¼‰ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‹¦æˆªã€‚</p>
</blockquote>
<h5 data-id="heading-11">1.2 æ‰‹æœºå·é™æµï¼šæœ€å…¸å‹</h5>
<p><strong>ä½œç”¨ï¼š</strong> åŒä¸€æ‰‹æœºå·å¿…é¡»å†·å´ï¼Œå¹¶æœ‰å½“å¤©çš„ä¸Šé™ã€‚<br/>
<strong>å‰¯ä½œç”¨ï¼š</strong> æå°‘æ•°æƒ…å†µä¸‹ç”¨æˆ·ç¡®å®éœ€è¦å¤šæ¬¡å‘é€ï¼ˆæ¯”å¦‚ç½‘ç»œå»¶è¿Ÿã€çŸ­ä¿¡è¢«æ‹¦æˆªç­‰ï¼‰ï¼Œä¼šç»™ç”¨æˆ·å¸¦æ¥æ„æƒ³ä¸åˆ°çš„éº»çƒ¦ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š60 ç§’å†·å´ + 24 å°æ—¶æœ€å¤š 5 æ¬¡</strong></p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-comment">// 60s å†·å´</span>
<span class="hljs-built_in">String</span> cdKey = <span class="hljs-string">"sms:cd:"</span> + phone;
<span class="hljs-keyword">if</span> (Boolean.TRUE.equals(redis.hasKey(cdKey))) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> TooManyRequestsException(<span class="hljs-string">"è¯·ç¨åå†è¯•"</span>);
redis.opsForValue().<span class="hljs-keyword">set</span>(cdKey, <span class="hljs-string">"1"</span>, <span class="hljs-built_in">Duration</span>.ofSeconds(<span class="hljs-number">60</span>));

<span class="hljs-comment">// 24h ä¸Šé™</span>
<span class="hljs-built_in">String</span> dayKey = <span class="hljs-string">"sms:cnt:"</span> + phone;
Long cnt = redis.opsForValue().increment(dayKey);
<span class="hljs-keyword">if</span> (cnt != <span class="hljs-keyword">null</span> &amp;&amp; cnt == <span class="hljs-number">1</span>) redis.expire(dayKey, <span class="hljs-built_in">Duration</span>.ofHours(<span class="hljs-number">24</span>));
<span class="hljs-keyword">if</span> (cnt != <span class="hljs-keyword">null</span> &amp;&amp; cnt &gt; <span class="hljs-number">5</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> TooManyRequestsException(<span class="hljs-string">"ä»Šæ—¥éªŒè¯ç æ¬¡æ•°å·²ç”¨å®Œ"</span>);
</code></pre>
<blockquote>
<p>ä½“éªŒæƒè¡¡ï¼š</p>
<ul>
<li>å†·å´æ—¶é—´ 60s åŸºæœ¬æ˜¯è¡Œä¸šå…±è¯†ï¼›</li>
<li>æ—¥ä¸Šé™ 5 æ¬¡å¯¹ç»å¤§å¤šæ•°ç”¨æˆ·è¶³å¤Ÿï¼Œä½†èƒ½æ˜¾è‘—å‹åˆ¶æ”»å‡»æˆæœ¬ã€‚<br/>
è¿™å±äºè½»åº¦å½±å“ä½“éªŒï¼Œä½†æå¤§é™ä½é£é™©ï¼Œæ˜¯æ¯”è¾ƒå…¸å‹çš„å†³ç­–ã€‚</li>
</ul>
</blockquote>
<h5 data-id="heading-12">1.3 ç”¨æˆ·/è®¾å¤‡ç»´åº¦é™æµ</h5>
<p>å¦‚æœæœ‰ <code>userId</code>ï¼ˆå·²ç™»å½•ï¼‰æˆ–å¯é çš„ <code>deviceId</code>ï¼ˆè®¾å¤‡æŒ‡çº¹/å®¢æˆ·ç«¯IDï¼‰ï¼Œå»ºè®®ä¹ŸåŠ ä¸Šç±»ä¼¼çš„è®¡æ•°æœºåˆ¶ã€‚<br/>
<strong>ä½œç”¨ï¼š</strong> æ”»å‡»è€…æ¢æ‰‹æœºå·ä¹Ÿä¸é‚£ä¹ˆå®¹æ˜“ã€‚<br/>
<strong>å‰¯ä½œç”¨ï¼š</strong> è®¾å¤‡æŒ‡çº¹å¦‚æœä¸å¯é ï¼Œå¯èƒ½å­˜åœ¨è¯¯åˆ¤ï¼Œéœ€è¦è°¨æ…ã€‚</p>
<p>è¿™ä¸ªå°±ä¸æä¾›ä»£ç ç¤ºä¾‹äº†ï¼ŒåŸºæœ¬å’Œæ‰‹æœºå·ç±»ä¼¼ã€‚</p>
<h4 data-id="heading-13">2. äººæœºæ ¡éªŒï¼šè®©æ”»å‡»æˆæœ¬ä¸Šå‡</h4>
<p>åªé é™æµè‚¯å®šæ˜¯ä¸å¤Ÿçš„ï¼Œæ”»å‡»è€…æœ‰å¾ˆå¤šæ–¹å¼å¯ä»¥è§„é¿ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>é€šè¿‡ä»£ç†æ± æ¢ IP</li>
<li>é€šè¿‡çŒ«æ± æ‰¹é‡æ¢æ‰‹æœºå·</li>
<li>é™é€Ÿæ…¢åˆ·</li>
</ul>
<p>è¿™æ—¶å¿…é¡»å¼•å…¥äººæœºæ ¡éªŒï¼ˆæ»‘åŠ¨/è¡Œä¸ºéªŒè¯ç ç­‰ï¼‰ã€‚</p>
<p>é€šè¿‡è¿™ç§æ”¶åˆ°é‚£ï¼Œå®ç°é£é™©åˆ†å±‚ï¼Œç¡®ä¿æ­£å¸¸ç”¨æˆ·é¡ºç•…ä½¿ç”¨ï¼Œåªæœ‰å¯ç–‘è¯·æ±‚æ‰åŠ éªŒè¯ã€‚</p>
<h5 data-id="heading-14">2.1 ä¸¤ç§ç­–ç•¥ï¼šå…¨é‡ä¸ŠéªŒè¯ç  vs åˆ†å±‚è§¦å‘éªŒè¯ç </h5>
<ul>
<li>
<p><strong>å…¨é‡ä¸ŠéªŒè¯ç </strong>ï¼šæœ€å®‰å…¨ï¼Œä½†ä½“éªŒä¸‹é™æ˜æ˜¾</p>
</li>
<li>
<p><strong>åˆ†å±‚è§¦å‘</strong>ï¼šæ›´æ¨è</p>
<ul>
<li>å½“ IP/æ‰‹æœºå·è§¦å‘æŸä¸ªé˜ˆå€¼åï¼Œå†è¦æ±‚é€šè¿‡äººæœºæ ¡éªŒ</li>
</ul>
</li>
</ul>
<p><strong>æƒè¡¡è¯´æ˜ï¼š</strong></p>
<ul>
<li>å¯¹æ–°ç”¨æˆ·æ¥è¯´ï¼Œå¤šä¸€æ­¥éªŒè¯ç å¯èƒ½é™ä½è½¬åŒ–ï¼›</li>
<li>ä½†å¦‚æœä½ çš„ä¸šåŠ¡æ­£è¢«æ”»å‡»ç›—åˆ·ï¼Œå…ˆæ­¢è¡€æ›´é‡è¦ï¼›</li>
<li>æœ€ä½³å®è·µé€šå¸¸æ˜¯å¹³æ—¶åˆ†å±‚è§¦å‘ï¼Œæ”»å‡»æœŸä¸´æ—¶æå‡å¼ºåº¦ï¼Œç”šè‡³å…¨é‡ã€‚</li>
</ul>
<h5 data-id="heading-15">2.2 ticketæœºåˆ¶ï¼šæŠŠäººæœºæ ¡éªŒç»“æœç»‘å®šåˆ°çŸ­ä¿¡å‘é€</h5>
<p>æµç¨‹ï¼š</p>
<ol>
<li>å‰ç«¯åšäººæœºæ ¡éªŒæ‹¿åˆ°å‡­è¯ï¼ˆå¦‚ challenge/validate æˆ– tokenï¼‰</li>
<li>åç«¯éªŒç­¾é€šè¿‡åå‘æ”¾ä¸€ä¸ªçŸ­æ—¶ <code>ticket</code>ï¼ˆRedis é‡Œå­˜ 2 åˆ†é’Ÿï¼‰</li>
<li>å‘é€çŸ­ä¿¡å¿…é¡»æºå¸¦ ticketï¼›ticket ç”¨ä¸€æ¬¡å°±ä½œåºŸï¼ˆé˜²æ­¢é‡æ”¾ï¼‰</li>
</ol>
<p><strong>ç¤ºä¾‹ï¼šæ ¡éªŒ ticketï¼ˆä¸€æ¬¡æ€§ï¼‰</strong></p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-type">String</span> tKey = <span class="hljs-string">"sms:ticket:"</span> + ticket;
<span class="hljs-keyword">if</span> (!<span class="hljs-type">Boolean</span>.<span class="hljs-literal">TRUE</span>.<span class="hljs-keyword">equals</span>(redis.hasKey(tKey))) <span class="hljs-keyword">throw</span> <span class="hljs-built_in">new</span> ForbiddenException(<span class="hljs-string">"è¯·å…ˆå®Œæˆäººæœºæ ¡éªŒ"</span>);
redis.delete(tKey); // ä¸€æ¬¡æ€§ï¼šé˜²æ­¢åŒ ticket é‡æ”¾åˆ·çŸ­ä¿¡
</code></pre>
<blockquote>
<p>ä»£ç æ¯”è¾ƒçŸ­å•Šï¼Œä½†æ˜¯ç¤ºä¾‹æ•ˆæœåº”è¯¥æ˜¯æœ‰äº†ï¼Œå°±æ˜¯æŠŠçŸ­ä¿¡å‘é€ä»ä¸€ä¸ªå…¬å¼€æ¥å£ï¼Œå˜æˆæŒç¥¨å…¥åœºçš„æœºåˆ¶ã€‚</p>
</blockquote>
<h4 data-id="heading-16">3. éªŒè¯ç è®¾è®¡ä¸æ ¡éªŒï¼šåˆ«è®©éªŒè¯æ¥å£ä¹Ÿæˆä¸ºçªç ´å£</h4>
<p>çŸ­ä¿¡ç›—åˆ·ä¸»è¦æ”»å‡»çš„æ˜¯å‘é€æ¥å£ï¼Œä½†éªŒè¯æ¥å£ä¹Ÿè¦å®ˆä½ã€‚</p>
<h5 data-id="heading-17">3.1 éªŒè¯ç å¿…é¡»ï¼šçŸ­æœ‰æ•ˆæœŸã€ä¸€æ¬¡æ€§ä½¿ç”¨</h5>
<p><strong>ä½œç”¨ï¼š</strong> è¿‡æœŸè‡ªåŠ¨å¤±æ•ˆï¼ŒæˆåŠŸåç«‹åˆ»ä½œåºŸã€‚<br/>
<strong>å‰¯ä½œç”¨ï¼š</strong> ç”¨æˆ·å¯èƒ½å› ä¸ºçŸ­ä¿¡å»¶è¿Ÿå¯¼è‡´è¿‡æœŸï¼Œéœ€è¦é‡æ–°è·å–ï¼ˆä½“éªŒç•¥å¾®é™ä½ï¼‰ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼šæ ¡éªŒæˆåŠŸå³åˆ é™¤</strong></p>
<pre><code class="hljs language-ini" lang="ini">String <span class="hljs-attr">codeKey</span> = <span class="hljs-string">"sms:code:"</span> + phone<span class="hljs-comment">;</span>
String <span class="hljs-attr">real</span> = redis.opsForValue().get(codeKey)<span class="hljs-comment">;</span>
if (!Objects.equals(real, inputCode)) throw new ForbiddenException("éªŒè¯ç é”™è¯¯")<span class="hljs-comment">;</span>
redis.delete(codeKey)<span class="hljs-comment">; // ä¸€æ¬¡æ€§ä½¿ç”¨</span>
</code></pre>
<h5 data-id="heading-18">3.2 é™åˆ¶éªŒè¯å¤±è´¥æ¬¡æ•°ï¼šé˜²æ­¢æš´åŠ›å°è¯•</h5>
<p><strong>ä½œç”¨ï¼š</strong> æŠµæŠ—ç©·ä¸¾æˆ–è€…æ’ç çš„è¡Œä¸º
<strong>å‰¯ä½œç”¨ï¼š</strong> ç”¨æˆ·å¦‚æœæ‰‹æ»‘è¾“é”™å¤šæ¬¡ï¼Œä¼šè¢«æš‚æ—¶é”å®šï¼ˆä½“éªŒä¸‹é™ï¼Œä½†åœ¨ä¸šåŠ¡ä¸Šä¹Ÿèƒ½ç†è§£ï¼‰</p>
<p><strong>ç¤ºä¾‹ï¼š10 åˆ†é’Ÿæœ€å¤šé”™ 5 æ¬¡</strong></p>
<pre><code class="hljs language-ini" lang="ini">String <span class="hljs-attr">failKey</span> = <span class="hljs-string">"sms:fail:"</span> + phone<span class="hljs-comment">;</span>
Long <span class="hljs-attr">fail</span> = redis.opsForValue().increment(failKey)<span class="hljs-comment">;</span>
if (fail != null &amp;&amp; <span class="hljs-attr">fail</span> == <span class="hljs-number">1</span>) redis.expire(failKey, Duration.ofMinutes(<span class="hljs-number">10</span>))<span class="hljs-comment">;</span>
if (fail != null &amp;&amp; fail &gt; 5) throw new ForbiddenException("é”™è¯¯æ¬¡æ•°è¿‡å¤šï¼Œè¯·ç¨åå†è¯•")<span class="hljs-comment">;</span>
</code></pre>
<blockquote>
<p>æƒè¡¡è¯´æ˜ï¼š</p>
<ul>
<li>
<p>è™½ç„¶æ˜¯çŸ­æ—¶é—´çš„é”å®šï¼Œä½†å¿…ç„¶ä¼šè®©ç”¨æˆ·ä¸çˆ½ï¼›</p>
</li>
<li>
<p>å¯æ˜¯å®ƒèƒ½è®©æ”»å‡»è€…çš„ç©·ä¸¾ç›´æ¥å¤±å»æ„ä¹‰</p>
<p>åœ¨å®‰å…¨é“¾è·¯é‡Œï¼Œè¿™æ˜¯å…¸å‹çš„ç”¨å°‘é‡ä½“éªŒæ¢å¤§é‡å®‰å…¨</p>
</li>
</ul>
</blockquote>
<h4 data-id="heading-19">4. å¹‚ç­‰ï¼šåˆ«è®©é‡å¤ç‚¹å‡»å˜æˆé‡å¤æ‰£è´¹</h4>
<p>æŸç§æƒ…å†µä¸‹ï¼Œå¾ˆå¤šçŸ­ä¿¡è´¹ç”¨å¹¶ä¸æ˜¯é»‘å®¢ç›—åˆ·çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸‹é¢è¿™äº›åœºæ™¯ï¼š</p>
<ul>
<li>ç”¨æˆ·ç‹‚ç‚¹é‡æ–°å‘é€</li>
<li>å‰ç«¯ç½‘ç»œæŠ–åŠ¨è‡ªåŠ¨é‡è¯•</li>
<li>ç½‘å…³é‡è¯•å¯¼è‡´é‡å¤è¯·æ±‚</li>
</ul>
<p><strong>ä½œç”¨ï¼š</strong> åŒä¸€ä¸ªè¯·æ±‚åªå‘é€ä¸€æ¬¡ã€‚<br/>
<strong>å‰¯ä½œç”¨ï¼š</strong> éœ€è¦å‰ç«¯æˆ–å®¢æˆ·ç«¯é…åˆæä¾› <code>requestId</code>ï¼ˆæˆ–ä½ åœ¨æœåŠ¡ç«¯ç”Ÿæˆå¹¶è¿”å›ï¼‰ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š3 åˆ†é’Ÿå¹‚ç­‰</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-built_in">Boolean</span> ok = redis.opsForValue()
    .setIfAbsent(<span class="hljs-string">"sms:idem:"</span> + requestId, <span class="hljs-string">"1"</span>, Duration.ofMinutes(<span class="hljs-number">3</span>));
<span class="hljs-keyword">if</span> (!<span class="hljs-built_in">Boolean</span>.TRUE.equals(ok)) <span class="hljs-keyword">return</span>; <span class="hljs-comment">// å·²å¤„ç†è¿‡ï¼Œç›´æ¥å¿½ç•¥</span>
</code></pre>
<h4 data-id="heading-20">5. ç›‘æ§ä¸å‘Šè­¦ï¼šä¸»åŠ¨çš„ç›‘æ§æŠ¥è­¦ï¼Œæå‰é¢„é˜²</h4>
<p><strong>å»ºè®®è‡³å°‘ç›‘æ§ä»¥ä¸‹è¿™å‡ ç‚¹ï¼š</strong></p>
<ul>
<li>æ¯åˆ†é’Ÿå‘é€é‡ï¼ˆæ€»é‡ + æŒ‰æ¸ é“ï¼‰</li>
<li>å‘½ä¸­é™æµæ¬¡æ•°ï¼ˆæŒ‰ IP / phoneï¼‰</li>
<li>å‘é€å¤±è´¥ç‡ï¼ˆçªç„¶å‡é«˜å¾€å¾€æ˜¯è¢«åˆ·æˆ–è¢«é£æ§ï¼‰</li>
<li>å• IP/å•å·å¼‚å¸¸æ’è¡Œ</li>
</ul>
<p>ç›‘æ§ä»£ç å’Œå¹³å°å·®å¼‚å¾ˆå¤§ï¼Œè¿™é‡Œä¸è´´å…·ä½“çš„å®ç°ï¼Œå…³é”®æ˜¯ä¸€å®šè¦æœ‰é˜ˆå€¼å‘Šè­¦ï¼Œæ¯”æ–¹è¯´é‚®ä»¶æˆ–è€…é£ä¹¦ã€é’‰é’‰çš„æŠ¥è­¦ã€‚</p>
<h2 data-id="heading-21">å†™åœ¨æœ€å</h2>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠçŸ­ä¿¡éªŒè¯ç è¿™æ¡é“¾è·¯æœ€å®¹æ˜“è¢«é’»çš„åœ°æ–¹éƒ½è¡¥äº†ä¸€éï¼šç”¨ <strong>IP/æ‰‹æœºå·/ç”¨æˆ·</strong> åšé™æµå…œåº•ï¼Œç”¨ <strong>äººæœºæ ¡éªŒ + ticket</strong> æŠ¬é«˜è„šæœ¬æˆæœ¬ï¼ŒéªŒè¯ç åšåˆ° <strong>çŸ­æœ‰æ•ˆæœŸã€ä¸€æ¬¡æ€§ã€å¤±è´¥æ¬¡æ•°é™åˆ¶</strong>ï¼Œå†åŠ ä¸Š <strong>å¹‚ç­‰å’Œç›‘æ§å‘Šè­¦</strong>ï¼Œé¿å…é‡å¤æ‰£è´¹ã€ä¹Ÿèƒ½ç¬¬ä¸€æ—¶é—´å‘ç°å¼‚å¸¸ã€‚</p>
<p>æœ‰äº›æªæ–½ä¼šè®©ä½“éªŒç¨å¾®å˜å·®ä¸€ç‚¹ï¼Œä½†è¿™æ˜¯åœ¨ <strong>ä½“éªŒã€æˆæœ¬ã€å®‰å…¨</strong> ä¹‹é—´åšè¿‡æƒè¡¡åçš„é€‰æ‹©ï¼šè®©æ­£å¸¸ç”¨æˆ·å¤šèµ°åŠæ­¥ï¼Œæ€»æ¯”è®©æ”»å‡»è€…ä¸€è·¯ç»¿ç¯å¼ºã€‚</p>
<p>æœ€åæ„Ÿæ…¨ä¸¤å¥ã€‚</p>
<p>å†™ä¸šåŠ¡çš„æ—¶å€™æˆ‘ä»¬æ€»çˆ±ç›¸ä¿¡ä¸–ç•Œæ˜¯å–„è‰¯çš„ã€‚</p>
<p>ä½†æˆå¹´äººæœ€å¤§çš„ä½“é¢ï¼Œéƒ½è¦äº¤å­¦è´¹äº¤å‡ºæ¥çš„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœºæ™¯åŒ–è½åœ°æŒ‡å—â€”â€”é‡‘ä»“æ—¶åºæ•°æ®åº“åœ¨å…³é”®è¡Œä¸šçš„åº”ç”¨å®è·µ]]></title>    <link>https://juejin.cn/post/7595974133096759330</link>    <guid>https://juejin.cn/post/7595974133096759330</guid>    <pubDate>2026-01-17T11:21:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595974133096759330" data-draft-id="7595893785907003426" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœºæ™¯åŒ–è½åœ°æŒ‡å—â€”â€”é‡‘ä»“æ—¶åºæ•°æ®åº“åœ¨å…³é”®è¡Œä¸šçš„åº”ç”¨å®è·µ"/> <meta itemprop="keywords" content="æ•°æ®åº“"/> <meta itemprop="datePublished" content="2026-01-17T11:21:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å€”å¼ºçš„çŸ³å¤´_"/> <meta itemprop="url" content="https://juejin.cn/user/3168119757484368"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœºæ™¯åŒ–è½åœ°æŒ‡å—â€”â€”é‡‘ä»“æ—¶åºæ•°æ®åº“åœ¨å…³é”®è¡Œä¸šçš„åº”ç”¨å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3168119757484368/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å€”å¼ºçš„çŸ³å¤´_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T11:21:31.000Z" title="Sat Jan 17 2026 11:21:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ—¶åºæ•°æ®æ€ä¹ˆâ€œè½åˆ°ç³»ç»Ÿé‡Œâ€ï¼Œå¾€å¾€æ¯”â€œæ¦‚å¿µè®²æ¸…æ¥šâ€æ›´éš¾ã€‚æœ¬æ–‡å°±ä»¥é‡‘ä»“æ—¶åºæ•°æ®åº“çš„å·¥ç¨‹è½åœ°ä¸ºä¸»çº¿ï¼ŒæŠŠé‡‡é›†ã€å­˜å‚¨ã€åˆ†æã€çœ‹æ¿åˆ°è¿ç»´é—­ç¯ä¸²èµ·æ¥ï¼šèƒ½åŠ›æ€ä¹ˆæ‹†ã€æ¨¡å‹æ€ä¹ˆå»ºã€SQLæ€ä¹ˆå†™ã€è¡Œä¸šæ€ä¹ˆç”¨ï¼Œå°½é‡è®²å¾—æ¸…æ¥šã€ä¹Ÿè®²å¾—èƒ½ç›´æ¥ç…§ç€åšã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5b55ca384944f96a4cf3c0a36adf160~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769253691&amp;x-signature=fdsDHhQyoy37cjLTvKj9B2Su7kQ%3D" alt="a6bb70bf487627cb7b4e42054570950f.jpg" loading="lazy"/></p>
<p>@[toc]</p>
<hr/>
<h2 data-id="heading-0">1. ä¸ºä»€ä¹ˆ 2025 å¹´æ—¶åºæ•°æ®åº“â€œå¿…é¡»åœºæ™¯åŒ–â€</h2>
<p>æ—¶åºæ•°æ®åº“æ—©å°±ä¸åªæ˜¯â€œå†™å¾—å¿«ã€å­˜å¾—ä¸‹â€è¿™ä¹ˆç®€å•äº†ã€‚åˆ°äº† 2025 å¹´ï¼Œå¤§å®¶æ›´çœ‹é‡çš„æ˜¯<strong>èƒ½ä¸èƒ½å›´ç»•åœºæ™¯æŠŠé“¾è·¯äº¤ä»˜å‡ºæ¥</strong>â€”â€”æ¥å…¥ç¨³ä¸ç¨³ã€å­˜å‚¨è´µä¸è´µã€æŸ¥è¯¢å¿«ä¸å¿«ã€ç³»ç»ŸæŠ—ä¸æŠ—å‹ã€æ²»ç†åˆä¸åˆè§„ã€å›½äº§åŒ–ç¯å¢ƒèƒ½ä¸èƒ½é•¿æœŸè·‘ä½ã€‚</p>
<h3 data-id="heading-1">1.1 2025 å¹´æ—¶åºæ•°æ®çš„å››ä¸ªå…¸å‹å˜åŒ–</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1df8dde84d2744feb7bc1cc119e5cf88~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769253691&amp;x-signature=7p2Mi36fZofdnccGaUfht%2BFXZjs%3D" alt="image.png" loading="lazy"/></p>
<ol>
<li>
<p><strong>æ•°æ®æºæ›´ç¢æ›´è¿‘</strong><br/>
è¾¹ç¼˜ä¾§è®¾å¤‡ã€ç½‘å…³ã€å·¥ä¸šæ§åˆ¶ä¸è½¦è”ç½‘ç­‰äº§ç”Ÿå¤§é‡â€œçŸ­å‘¨æœŸã€é«˜å™ªå£°ã€æ˜“ä¸¢åŒ…â€çš„æ•°æ®ï¼Œæ¥å…¥é“¾è·¯éœ€è¦æ›´å¼ºçš„ååä¸å®¹é”™ã€‚</p>
</li>
<li>
<p><strong>â€œå†™å…¥é«˜å³° + æŸ¥è¯¢çªå‘â€æˆä¸ºå¸¸æ€</strong><br/>
ç™½å¤©ä¸šåŠ¡å†™å…¥ã€å¤œé—´æ‰¹å¤„ç†ã€æ•…éšœæ’æŸ¥çªå‘æŸ¥è¯¢å åŠ ï¼Œè¦æ±‚æ•°æ®åº“åŒæ—¶å…¼é¡¾å†™å…¥ã€å‹ç¼©ã€èšåˆä¸å¹¶å‘è¯»ã€‚</p>
</li>
<li>
<p><strong>ä»â€œä¿å­˜åŸå§‹æ•°æ®â€èµ°å‘â€œå¯è¿è¥çš„æ•°æ®èµ„äº§â€</strong><br/>
ä¸åªæ˜¯å­˜ï¼šè¿˜è¦åˆ†å±‚ï¼ˆçƒ­/æ¸©/å†·ï¼‰ã€ä¿ç•™ç­–ç•¥ã€é™é‡‡æ ·ã€æ•°æ®è´¨é‡ä¸å®¡è®¡ï¼Œè®©æ•°æ®èƒ½è¢«é•¿æœŸå¤ç”¨ã€‚</p>
</li>
<li>
<p><strong>â€œå¯æ§å¯ç”¨â€æ¯”â€œå‚æ•°æœ€ä¼˜â€æ›´é‡è¦</strong><br/>
å…³é”®è¡Œä¸šæ›´çœ‹é‡å¯äº¤ä»˜æ€§ï¼šå¯è¿ç»´ã€å¯å®¡è®¡ã€å¯æ‰©å±•ã€å¯å…¼å®¹ç”Ÿæ€ã€å¯åœ¨å›½äº§åŒ–ç¯å¢ƒç¨³å®šè¿è¡Œã€‚</p>
</li>
</ol>
<h3 data-id="heading-2">1.2 è¶‹åŠ¿ã€æ ¼å±€ä¸é‡‘ä»“çš„æœºä¼šç‚¹ï¼šæŠŠâ€œèƒ½åŠ›â€å†™è¿›â€œäº¤ä»˜ä»¶â€</h3>
<p>å¦‚æœæŠŠè¡Œä¸šæ ¼å±€æ‹†å¼€çœ‹ï¼Œæ—¶åºäº§å“å¤§ä½“ä¼šè½åœ¨ä¸‰æ¡è·¯çº¿ä¸Šï¼šåå·¥ä¸š/èƒ½æºçš„ç”Ÿäº§ç³»ç»Ÿè·¯çº¿ã€å IT å¯è§‚æµ‹æ€§çš„è¿ç»´è·¯çº¿ã€ä»¥åŠåç‰©è”ç½‘ä¸å¹³å°åŒ–çš„æ•°æ®å¹³å°è·¯çº¿ã€‚èµ°åˆ° 2025 å¹´ï¼ŒçœŸæ­£èƒ½æ‹‰å¼€å·®è·çš„å¾€å¾€ä¸æ˜¯æŸä¸€é¡¹â€œæé™æŒ‡æ ‡â€ï¼Œè€Œæ˜¯èƒ½ä¸èƒ½æŠŠèƒ½åŠ›æ²‰æ·€æˆä¸€å¥—å¯å¤ç”¨ã€å¯éªŒæ”¶çš„äº¤ä»˜ä»¶ï¼š
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b622a9049f0743fb8efd44c7b228bc4c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769253691&amp;x-signature=wWSt4kYJwWDsqgK%2F5IfiFmHyqtM%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li><strong>æ•°æ®æ¥å…¥æ ‡å‡†åŒ–</strong>ï¼šæ‰¹é‡å†™å…¥ã€é‡è¯•å¹‚ç­‰ã€ä¹±åºè¡¥å†™ã€è´¨é‡æ ‡è®°è¿™äº›èƒ½åŠ›ï¼Œæœ€åè¦è½æˆæ¥å…¥è§„èŒƒä¸æ¨¡æ¿ï¼Œè°æ¥è°ç”¨ã€‚</li>
<li><strong>åˆ†åŒºç”Ÿå‘½å‘¨æœŸå·¥ç¨‹åŒ–</strong>ï¼šåˆ†åŒºè‡ªåŠ¨åˆ›å»ºä¸æ¸…ç†ã€å†·çƒ­åˆ†å±‚ã€å½’æ¡£ç­–ç•¥è¦å›ºåŒ–æˆè¿ç»´è„šæœ¬ä¸éªŒæ”¶å£å¾„ï¼Œè·‘èµ·æ¥å¿ƒé‡Œæœ‰åº•ã€‚</li>
<li><strong>çœ‹æ¿æŸ¥è¯¢äº§å“åŒ–</strong>ï¼šåˆ†é’Ÿ/å°æ—¶èšåˆå±‚é…ä¸Šå›è¡¥çª—å£ï¼ŒæŠŠçœ‹æ¿ä»â€œå¶å°”å¾ˆå¿«â€å˜æˆâ€œé•¿æœŸç¨³å®šå¿«â€ã€‚</li>
<li><strong>æ²»ç†ä¸å®¡è®¡ä½“ç³»åŒ–</strong>ï¼šæƒé™éš”ç¦»ã€å®¡è®¡ç•™ç—•ã€ä¿ç•™ç­–ç•¥å¯å®¡è®¡ï¼Œå‡å°‘ä¸Šçº¿å®¡æ‰¹ä¸åˆè§„æ²Ÿé€šæˆæœ¬ã€‚</li>
<li><strong>å›½äº§åŒ–è½åœ°å¯æŒç»­</strong>ï¼šå‹æµ‹åŸºçº¿ã€å®¹é‡æ¨¡å‹ã€æ¼”ç»ƒæµç¨‹ä¸ç›‘æ§æŒ‡æ ‡è¡¥é½ï¼Œå°½é‡æŠŠé—®é¢˜æŒ¡åœ¨ä¸Šçº¿å‰ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-3">2. é‡‘ä»“æ—¶åºæ•°æ®åº“çš„èƒ½åŠ›æ‹†è§£ï¼šç”¨å·¥ç¨‹è¯­è¨€å¯¹é½â€œèƒ½è§£å†³ä»€ä¹ˆé—®é¢˜â€</h2>
<p>æŠŠèƒ½åŠ›æŒ‰â€œè½åœ°ä¼šç”¨åˆ°çš„å±‚æ¬¡â€æ‹†å¼€çœ‹ï¼Œè§„åˆ’ã€éªŒæ”¶ã€æ‰©å®¹è¯„ä¼°éƒ½ä¼šæ¸…æ™°ä¸å°‘ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TB
  A[æ•°æ®æ¥å…¥&lt;br/&gt;é‡‡é›†/ç½‘å…³/æ¶ˆæ¯é˜Ÿåˆ—] --&gt; B[å†™å…¥ä¸ç¼“å†²&lt;br/&gt;æ‰¹é‡/ä¹±åº/å¹‚ç­‰]
  B --&gt; C[å­˜å‚¨ç»„ç»‡&lt;br/&gt;åˆ†åŒº/ç´¢å¼•/å‹ç¼©]
  C --&gt; D[æŸ¥è¯¢åˆ†æ&lt;br/&gt;çª—å£èšåˆ/å…³è”/é¢„èšåˆ]
  D --&gt; E[æ•°æ®æ²»ç†&lt;br/&gt;ç”Ÿå‘½å‘¨æœŸ/æƒé™/å®¡è®¡]
  E --&gt; F[é«˜å¯ç”¨ä¸è¿ç»´&lt;br/&gt;å¤‡ä»½æ¢å¤/ç›‘æ§/æ‰©ç¼©å®¹]
</code></pre>
<h3 data-id="heading-4">2.0 æŠŠâ€œé‡‘ä»“â€æ”¾è¿›æ¶æ„å›¾ï¼šä¸æ˜¯å•ç‚¹èƒ½åŠ›ï¼Œè€Œæ˜¯ä¸€å¥—äº¤ä»˜ä½“ç³»</h3>
<p>å…³é”®è¡Œä¸šé‡Œï¼Œé‡‘ä»“çš„æ—¶åºèƒ½åŠ›æ›´å¤šæ˜¯ä½œä¸ºé‡‘ä»“æ•°æ®åº“çš„ä¼ä¸šçº§æ•°æ®åº•åº§èƒ½åŠ›æ¥ç”¨ï¼šå®ƒèƒ½æ‰¿è½½â€œæµ·é‡æ—¶åºæ•°æ®é‡‡é›†æ£€ç´¢ç±»åº”ç”¨â€ç­‰åœºæ™¯ï¼Œå¹¶ä¸”æ”¯æŒå’Œå…³ç³»ã€æ–‡æ¡£ã€GIS ç­‰æ¨¡å‹ç»Ÿä¸€å­˜å‚¨ã€æ··åˆè®¿é—®ã€‚æ¢å¥è¯è¯´ï¼Œå¾ˆå¤šæ—¶å€™ä½ ä¸å¿…ä¸ºäº†æ—¶åºå•ç‹¬å†æ‹¼ä¸€å¥—ç³»ç»Ÿï¼Œè¿ç»´ä¸æ²»ç†çš„å‹åŠ›ä¹Ÿä¼šå°ä¸€æˆªã€‚</p>
<p>åšå›½äº§åŒ–æ›¿ä»£ï¼Œéš¾ç‚¹å¾€å¾€ä¸åœ¨â€œèƒ½ä¸èƒ½è¿â€ï¼Œè€Œåœ¨â€œè¿å®Œèƒ½ä¸èƒ½é•¿æœŸç¨³â€ã€‚æ‰€ä»¥å·¥ç¨‹äº¤ä»˜å¿…é¡»æŠŠâ€œè¯„ä¼°â€”è¿ç§»â€”å¼€å‘â€”è¿ç»´â€è¿™ä¸€ä¸²æ‰“é€šã€‚é‡‘ä»“å®˜ç½‘å…¬å¼€ä¿¡æ¯é‡Œä¹Ÿæ˜ç¡®æåˆ°å…¶é…å¥—çš„å·¥å…·ç»„ä»¶ä½“ç³»è¦†ç›–è¿ç§»è¯„ä¼°ã€æ•°æ®è¿ç§»ã€å¼€å‘ç®¡ç†ä¸é›†ä¸­è¿ç»´ç­‰ç¯èŠ‚ï¼Œç›®çš„å°±æ˜¯æŠŠâ€œèƒ½è·‘èµ·æ¥â€è¿›ä¸€æ­¥å˜æˆâ€œèƒ½æŒç»­è·‘ä¸‹å»â€ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b48a386d0f054ef18ff92cd3acb2dd60~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769253691&amp;x-signature=JA2Fl3CS3OEOuywHwQuR0G3cWV8%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-5">2.1 å†™å…¥ï¼šååã€ä¹±åºä¸â€œä¸šåŠ¡å¯æ¢å¤â€</h3>
<p>å¾ˆå¤šé¡¹ç›®é‡Œï¼Œå†™å…¥çš„çœŸå®ç—›ç‚¹å¹¶ä¸æ˜¯â€œå•æ¡å†™å¾—æ…¢â€ï¼Œè€Œæ˜¯ä¸‹é¢è¿™äº›æ›´æŠ˜ç£¨äººçš„é—®é¢˜ï¼š</p>
<ul>
<li>å³°å€¼å†™å…¥æ—¶å¦‚ä½•ä¿æŒç¨³å®šã€ä¸å¡æ­»æŸ¥è¯¢ï¼›</li>
<li>ä¹±åº/è¿Ÿåˆ°æ•°æ®å¦‚ä½•è¡¥å†™å¹¶ä¿æŒä¸€è‡´ï¼›</li>
<li>æ–­ç½‘/é‡è¯•æ—¶å¦‚ä½•åšåˆ°å¹‚ç­‰ä¸å¯è¿½æº¯ã€‚</li>
</ul>
<p>è½åˆ°å·¥ç¨‹ä¸Šï¼Œå¯ä»¥æŒ‰è¿™ä¸ªæ€è·¯åšï¼š</p>
<ul>
<li>å…¥å£å±‚å…ˆæŠŠ<strong>æ‰¹é‡å†™å…¥</strong>å’Œ<strong>é‡è¯•å»é‡</strong>åšæ‰å®ï¼ˆè®¾å¤‡ä¾§æˆ–ç½‘å…³ä¾§å¸¦å”¯ä¸€åºå·/æ—¶é—´æˆ³+è®¾å¤‡IDï¼‰ï¼Œå†™å…¥é«˜å³°æ—¶æ›´ç¨³ã€‚</li>
<li>æ•°æ®åº“ä¾§ç”¨<strong>æŒ‰æ—¶é—´èŒƒå›´åˆ†åŒº</strong>æ¥å…œåº•ï¼Œé¿å…ä¸€å¼ è¡¨æ— é™å˜å¤§åç»´æŠ¤æˆæœ¬é£™å‡ã€‚</li>
<li>å¦‚æœä¸šåŠ¡ç»´åº¦å¾ˆç¨³å®šã€è¿‡æ»¤ä¹Ÿå¾ˆé«˜é¢‘ï¼Œå°±æŠŠâ€œæ—¶é—´ + ä¸šåŠ¡ç»´åº¦â€å½“æˆè”åˆåˆ‡åˆ†çš„æŠ“æ‰‹ï¼Œæ—¢é™ä½çƒ­ç‚¹ï¼Œä¹Ÿå‡å°‘æ‰«æèŒƒå›´ã€‚[^kb-logs][^kb-safety]</li>
</ul>
<h3 data-id="heading-6">2.2 å­˜å‚¨ï¼šåˆ†åŒºã€å‹ç¼©ä¸å†·çƒ­åˆ†å±‚ï¼ˆé™ä½æ€»æˆæœ¬ï¼‰</h3>
<p>æ—¶åºæ•°æ®æŒ‰æ—¶é—´èŒƒå›´åˆ‡åˆ†ï¼ˆå¤©/å°æ—¶/å‘¨ç­‰ï¼‰å‡ ä¹æ˜¯â€œé»˜è®¤æ­£ç¡®â€çš„é€‰æ‹©ï¼Œæ”¶ç›Šä¹Ÿå¾ˆç›´æ¥ï¼š</p>
<ul>
<li>æŸ¥è¯¢è£å‰ªï¼šåªæ‰«æå‘½ä¸­çš„æ—¶é—´åˆ†åŒºï¼›</li>
<li>è¿ç»´ç®€åŒ–ï¼šè¿‡æœŸæ•°æ®ç›´æ¥æŒ‰åˆ†åŒºæ¸…ç†ï¼›</li>
<li>æ€§èƒ½ç¨³å®šï¼šé¿å…â€œè¶Šå­˜è¶Šæ…¢â€çš„é•¿å°¾é—®é¢˜ã€‚</li>
</ul>
<p>ä»äº§å“å½¢æ€ä¸Šçœ‹ï¼Œé‡‘ä»“æŠŠæ—¶åºèƒ½åŠ›æ”¾è¿›èåˆæ•°æ®åº“ä½“ç³»é‡Œï¼Œå¼ºè°ƒå¤šç§æ¨¡å‹ç»Ÿä¸€å­˜å‚¨ã€æ··åˆè®¿é—®ã€‚è¿™æ ·ä¸€æ¥ï¼Œâ€œæ—¶åºæ˜ç»† + ä¸šåŠ¡ç»´è¡¨ +ï¼ˆå¯é€‰çš„ï¼‰ç©ºé—´ä¿¡æ¯â€å°±èƒ½åœ¨åŒä¸€åº•åº§å†…é—­ç¯å®Œæˆï¼Œè·¨ç³»ç»ŸåŒæ­¥ä¸ä¸€è‡´æ€§æ²»ç†çš„éº»çƒ¦äº‹ä¼šå°‘å¾ˆå¤šã€‚[^kb-kes]</p>
<h3 data-id="heading-7">2.3 æŸ¥è¯¢ï¼šçª—å£èšåˆã€é¢„èšåˆä¸â€œç§’çº§çœ‹æ¿â€</h3>
<p>çœ‹æ¿/å‘Šè­¦æœ€å¸¸è§çš„å‘å°±æ˜¯ï¼šåŸå§‹ç‚¹ä½å¤ªå¤šï¼Œä¸€ä¸Šæ¥å°±æ‰«æ˜ç»†ï¼Œå»¶è¿Ÿä¸Šå»äº†ï¼Œèµ„æºä¹Ÿè¢«åƒå…‰ã€‚æ›´ç¨³å¦¥çš„åšæ³•é€šå¸¸æ˜¯ï¼š</p>
<ul>
<li>æ˜ç»†å±‚ä¿ç•™åŸå§‹æ•°æ®ï¼›</li>
<li>èšåˆå±‚æŒ‰åˆ†é’Ÿ/å°æ—¶åšé¢„èšåˆï¼ˆå¯ç‰©åŒ–/å¯å¢é‡ï¼‰ï¼›</li>
<li>ä¸šåŠ¡ä¾§è¯»èšåˆå±‚æ»¡è¶³å¤§å¤šæ•°å®æ—¶çœ‹æ¿ã€‚</li>
</ul>
<p>åœ¨é‡‘ä»“å…¬å¼€çš„æ—¶åºåˆ†æå®è·µé‡Œï¼Œâ€œåŒºé—´ç­›é€‰ + æ—¶é—´çª—å£èšåˆâ€çš„å‡½æ•°åŒ–æ€è·¯ç»å¸¸è¢«ç”¨æ¥æŠŠå¤æ‚æŸ¥è¯¢æ”¶æ•›æˆç¨³å®šã€å¯å¤ç”¨çš„æ—¶é—´çª—æ“ä½œï¼Œè¿™æ ·å‹æµ‹ã€ç¼“å­˜å’Œçœ‹æ¿å¤ç”¨éƒ½ä¼šæ›´é¡ºæ‰‹ã€‚[^kb-safety]</p>
<h3 data-id="heading-8">2.4 æ²»ç†ä¸å®‰å…¨ï¼šæƒé™ã€å®¡è®¡ä¸åˆè§„</h3>
<p>å…³é”®è¡Œä¸šå¾€å¾€è¦æ±‚ï¼š</p>
<ul>
<li>
<p>ç§Ÿæˆ·/éƒ¨é—¨éš”ç¦»ï¼ˆå¤šä¸šåŠ¡åŸŸå¹¶è¡Œï¼‰ï¼›</p>
</li>
<li>
<p>è¡Œçº§/åº“çº§/è¡¨çº§æƒé™ï¼›</p>
</li>
<li>
<p>æ“ä½œå®¡è®¡ã€è¿½æº¯ä¸ç•™ç—•ï¼›</p>
</li>
<li>
<p>æ•°æ®ä¿ç•™ç­–ç•¥å¯æ§ã€å¯å®¡è®¡ã€‚</p>
</li>
</ul>
<h2 data-id="heading-9">æ—¶åºé¡¹ç›®èƒ½ä¸èƒ½é¡ºåˆ©ä¸Šçº¿ã€ä¸Šçº¿åæ•¢ä¸æ•¢æ”¾é‡ï¼Œå¾ˆå¤šæ—¶å€™å°±å¡åœ¨æ²»ç†è¿™ä¸€å…³ã€‚</h2>
<h2 data-id="heading-10">3. ä¸€ä¸ªå¯å¤ç”¨çš„æ•°æ®æ¨¡å‹ï¼šè®¾å¤‡æµ‹ç‚¹è¡¨ï¼ˆå«åˆ†åŒºä¸ç´¢å¼•ï¼‰</h2>
<p>å…ˆç”¨é€šç”¨ SQL æ¥é˜è¿°å»ºæ¨¡æ€è·¯ï¼ŒæŠŠâ€œè®¾å¤‡æµ‹ç‚¹â€å½“ä½œäº‹å®è¡¨ï¼Œå¹¶æŒ‰ç…§æ—¶é—´èŒƒå›´å®æ–½åˆ†åŒºï¼Œç„¶åé’ˆå¯¹æœ€å¸¸è§çš„è¿‡æ»¤æ¡ä»¶åˆ›å»ºåˆæˆç´¢å¼•ï¼Œè¿™æ ·å¤§æ¦‚å°±å¯ä»¥æ¶µç›–å¤šæ•°ç”Ÿäº§åœºæ™¯ã€‚</p>
<p>ä¸åŒç³»ç»Ÿå¯¹äºåˆ†åŒºè¯­æ³•çš„ç»†èŠ‚å¯èƒ½å­˜åœ¨å·®åˆ«ï¼Œä¸è¿‡å»ºæ¨¡æ€è·¯ä»¥åŠå­—æ®µè®¾è®¡å¯ä»¥ç…§æ¬ï¼Œç­‰åˆ°å®é™…æ‰§è¡Œçš„æ—¶å€™ï¼Œå†ä¾ç…§é‡‘ä»“æ—¶åºæ•°æ®åº“çš„åŠŸèƒ½ä»¥åŠè¿ç»´è§„èŒƒå»è°ƒæ•´åˆ†åŒºç²’åº¦å’Œç´¢å¼•ç­–ç•¥å³å¯ã€‚</p>
<h3 data-id="heading-11">3.1 è¡¨ç»“æ„å»ºè®®</h3>
<ul>
<li><code>ts</code>ï¼šé‡‡é›†æ—¶é—´ï¼ˆç»Ÿä¸€ä½¿ç”¨åŒä¸€æ—¶åŒº/ç»Ÿä¸€å…¥åº“å£å¾„ï¼‰</li>
<li><code>device_id</code>ï¼šè®¾å¤‡/ç‚¹ä½å”¯ä¸€æ ‡è¯†</li>
<li><code>metric</code>ï¼šæŒ‡æ ‡åï¼ˆæ¸©åº¦ã€å‹åŠ›ã€ç”µæµç­‰ï¼‰</li>
<li><code>value</code>ï¼šæ•°å€¼</li>
<li><code>quality</code>ï¼šè´¨é‡ä½ï¼ˆå¯é€‰ï¼Œæ ‡è®°æ˜¯å¦æœ‰æ•ˆ/æ˜¯å¦è¡¥ä¼ ï¼‰</li>
<li><code>tags</code>ï¼šæ‰©å±•ç»´åº¦ï¼ˆå¯é€‰ï¼ŒJSON æˆ–è§„èŒƒåŒ–ç»´è¡¨ï¼‰</li>
</ul>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> telemetry_points (
  ts         <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  device_id  <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  metric     <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  <span class="hljs-keyword">value</span>      <span class="hljs-type">DOUBLE PRECISION</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  quality    <span class="hljs-type">INTEGER</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span>,
  <span class="hljs-keyword">PRIMARY</span> KEY (ts, device_id, metric)
);
</code></pre>
<h3 data-id="heading-12">3.2 æŒ‰æ—¶é—´èŒƒå›´åˆ†åŒºï¼ˆç¤ºä¾‹ï¼šæŒ‰å¤©ï¼‰</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> telemetry_points_2025_01_01 <span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">OF</span> telemetry_points
<span class="hljs-keyword">FOR</span> <span class="hljs-keyword">VALUES</span> <span class="hljs-keyword">FROM</span> (<span class="hljs-string">'2025-01-01'</span>) <span class="hljs-keyword">TO</span> (<span class="hljs-string">'2025-01-02'</span>);
</code></pre>
<h3 data-id="heading-13">3.3 å¸¸ç”¨ç´¢å¼•</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> INDEX idx_tp_device_metric_ts <span class="hljs-keyword">ON</span> telemetry_points (device_id, metric, ts);
<span class="hljs-keyword">CREATE</span> INDEX idx_tp_ts <span class="hljs-keyword">ON</span> telemetry_points (ts);
</code></pre>
<h3 data-id="heading-14">3.4 å¤šä¸šåŠ¡åŸŸ/å¤šç§Ÿæˆ·çš„ä¸¤ç§å¸¸è§éš”ç¦»æ–¹å¼</h3>
<p>æ—¶åºå¹³å°ä¸€æ—¦åšæˆâ€œå¹³å°â€ï¼Œå°±ä¼šé‡åˆ°å¤šä¸šåŠ¡åŸŸ/å¤šç§Ÿæˆ·çš„é—®é¢˜ã€‚å·¥ç¨‹ä¸Šæœ€å¸¸è§çš„éš”ç¦»æ–¹å¼åŸºæœ¬å°±è¿™ä¸¤ç±»ï¼š</p>
<ul>
<li><strong>åº“/æ¨¡å¼éš”ç¦»</strong>ï¼šä¸åŒç§Ÿæˆ·/ä¸šåŠ¡åŸŸä½¿ç”¨ä¸åŒåº“æˆ–ä¸åŒæ¨¡å¼ï¼Œéš”ç¦»æ¸…æ™°ã€æƒé™ç®€å•ï¼Œé€‚åˆå¼ºéš”ç¦»åœºæ™¯ã€‚</li>
<li><strong>è¡¨å†…éš”ç¦»</strong>ï¼šåŒä¸€å¼ äº‹å®è¡¨å¢åŠ  <code>tenant_id</code> å­—æ®µï¼Œé€‚åˆç§Ÿæˆ·å¤šä¸”å°ã€å…±äº«èµ„æºçš„åœºæ™¯ï¼Œä½†éœ€è¦æ›´ä¸¥æ ¼çš„æƒé™ä¸å®¡è®¡ç­–ç•¥ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-15">4. å…¸å‹æŸ¥è¯¢ä¸èšåˆï¼šä»â€œæ˜ç»†ç‚¹â€åˆ°â€œå¯ç”¨æŒ‡æ ‡â€</h2>
<p>è®¸å¤šå›¢é˜Ÿæ‰§è¡Œæ—¶åºåˆ†æçš„æ—¶å€™ï¼Œæœ€å¸¸çŠ¯çš„é”™è¯¯å°±æ˜¯â€œæ¯ä¸ªäººéƒ½æœ‰ä¸€å¥—è‡ªå·±çš„æ—¶é—´çª—é€»è¾‘â€ï¼Œè¿™æ ·å°±é€ æˆå£å¾„ä¸ç»Ÿä¸€ï¼Œæ€§èƒ½ä¹Ÿæ— æ³•æ§åˆ¶ï¼Œé‡‘ä»“åœ¨å¼€å±•æ—¶åºåˆ†æçš„æ—¶å€™ï¼Œæ›´ä¾§é‡äºæŠŠâ€œæ—¶é—´èŒƒå›´è¿‡æ»¤ï¼ŒåŒºé—´ç­›é€‰ï¼Œæ—¶é—´çª—å£èšåˆâ€è¿™äº›åŠŸèƒ½åšæˆå‡½æ•°åŒ–ï¼Œæ¨¡æ¿åŒ–çš„æ¨¡å¼ï¼Œä»è€Œå‡è½»é‡å¤åŠ³åŠ¨çš„è´Ÿæ‹…ï¼Œä¹Ÿä¾¿äºåˆ›å»ºæ€§èƒ½åŸºçº¿å¹¶å®æ–½å›å½’æ£€æµ‹ï¼Œè¿™é‡Œæœ‰ä¸€ç»„é€šç”¨çš„ SQL æ€è·¯ï¼›åˆ°äº†å®é™…æ“ä½œé‡‘ä»“æ—¶ï¼Œå¯ä»¥ä¼˜å…ˆé‡‡ç”¨é‡‘ä»“è‡ªèº«å…·å¤‡çš„ç­‰æ•ˆå†…ç½®å‡½æ•°åŠå…¶ç›¸å…³èƒ½åŠ›ï¼ŒæŠŠé€»è¾‘ç¼–å†™å¾—æ›´ä¸ºç²¾ç‚¼ï¼Œç¨³å®šã€‚</p>
<h3 data-id="heading-16">4.1 åŒºé—´æŸ¥è¯¢ï¼šè®¾å¤‡åœ¨æŸæ—¶é—´æ®µçš„æ›²çº¿</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> ts, <span class="hljs-keyword">value</span>
<span class="hljs-keyword">FROM</span> telemetry_points
<span class="hljs-keyword">WHERE</span> device_id <span class="hljs-operator">=</span> <span class="hljs-string">'D-10086'</span>
  <span class="hljs-keyword">AND</span> metric <span class="hljs-operator">=</span> <span class="hljs-string">'temperature'</span>
  <span class="hljs-keyword">AND</span> ts <span class="hljs-operator">&gt;=</span> <span class="hljs-string">'2025-01-01 00:00:00'</span>
  <span class="hljs-keyword">AND</span> ts <span class="hljs-operator">&lt;</span>  <span class="hljs-string">'2025-01-02 00:00:00'</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ts;
</code></pre>
<h3 data-id="heading-17">4.2 çª—å£èšåˆï¼šæŒ‰ 5 åˆ†é’Ÿåšå‡å€¼ã€æœ€å¤§ã€æœ€å°</h3>
<p>æ²¡æœ‰å†…ç½®æ—¶é—´æ¡¶å‡½æ•°æ—¶ï¼Œä¹Ÿå¯ä»¥ç”¨â€œæ—¶é—´æˆªæ–­/å–æ•´â€çš„æ–¹å¼è¡¨è¾¾æ—¶é—´æ¡¶ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span>
  (DATE_TRUNC(<span class="hljs-string">'minute'</span>, ts) <span class="hljs-operator">-</span> (<span class="hljs-built_in">EXTRACT</span>(<span class="hljs-keyword">minute</span> <span class="hljs-keyword">FROM</span> ts)::<span class="hljs-type">int</span> <span class="hljs-operator">%</span> <span class="hljs-number">5</span>) <span class="hljs-operator">*</span> <span class="hljs-type">INTERVAL</span> <span class="hljs-string">'1 minute'</span>) <span class="hljs-keyword">AS</span> bucket_start,
  <span class="hljs-built_in">AVG</span>(<span class="hljs-keyword">value</span>) <span class="hljs-keyword">AS</span> avg_value,
  <span class="hljs-built_in">MIN</span>(<span class="hljs-keyword">value</span>) <span class="hljs-keyword">AS</span> min_value,
  <span class="hljs-built_in">MAX</span>(<span class="hljs-keyword">value</span>) <span class="hljs-keyword">AS</span> max_value
<span class="hljs-keyword">FROM</span> telemetry_points
<span class="hljs-keyword">WHERE</span> device_id <span class="hljs-operator">=</span> <span class="hljs-string">'D-10086'</span>
  <span class="hljs-keyword">AND</span> metric <span class="hljs-operator">=</span> <span class="hljs-string">'temperature'</span>
  <span class="hljs-keyword">AND</span> ts <span class="hljs-operator">&gt;=</span> <span class="hljs-string">'2025-01-01 00:00:00'</span>
  <span class="hljs-keyword">AND</span> ts <span class="hljs-operator">&lt;</span>  <span class="hljs-string">'2025-01-01 06:00:00'</span>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> bucket_start
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> bucket_start;
</code></pre>
<h3 data-id="heading-18">4.3 é¢„èšåˆï¼šé¢å‘çœ‹æ¿çš„â€œåˆ†é’Ÿçº§ç‰©åŒ–è§†å›¾â€ï¼ˆç¤ºä¾‹æ€è·¯ï¼‰</h3>
<p>å½“çœ‹æ¿æŸ¥è¯¢é¢‘ç¹ã€ä¸”å¤§éƒ¨åˆ†åªéœ€è¦åˆ†é’Ÿçº§æŒ‡æ ‡æ—¶ï¼Œå»ºè®®åšâ€œæ˜ç»†å±‚ + èšåˆå±‚â€ä¸¤å±‚ç»“æ„ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> telemetry_1m (
  bucket_start <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  device_id    <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  metric       <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  avg_value    <span class="hljs-type">DOUBLE PRECISION</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  min_value    <span class="hljs-type">DOUBLE PRECISION</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  max_value    <span class="hljs-type">DOUBLE PRECISION</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  cnt          <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  <span class="hljs-keyword">PRIMARY</span> KEY (bucket_start, device_id, metric)
);
</code></pre>
<p>èšåˆåˆ·æ–°ç­–ç•¥å»ºè®®ï¼š</p>
<ul>
<li>å®æ—¶æ€§è¦æ±‚é«˜ï¼šæŒ‰åˆ†é’Ÿå¢é‡åˆ·æ–°ï¼›</li>
<li>å…è®¸å»¶è¿Ÿï¼šæŒ‰ 5 åˆ†é’Ÿ/15 åˆ†é’Ÿæ‰¹é‡åˆ·æ–°ï¼›</li>
<li>æ”¯æŒè¿Ÿåˆ°æ•°æ®ï¼šè®¾ç½®â€œå›è¡¥çª—å£â€ï¼ˆä¾‹å¦‚å›è¡¥æœ€è¿‘ 2 å°æ—¶ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-19">4.4 ä¹±åºã€é‡å¤ä¸è¡¥ä¼ ï¼šç”¨â€œè´¨é‡ä½ + ä¸šåŠ¡å¹‚ç­‰é”®â€é™ä½é£é™©</h3>
<p>ç°åœºé‡‡é›†å¸¸å¸¸ä¼šé‡åˆ°è¿™æ ·ä¸€äº›éº»çƒ¦äº‹ï¼Œç¬¬ä¸€ç§æ˜¯è®¾å¤‡è¡¥ä¼ å¼•å‘çš„é‡å¤æƒ…å†µï¼Œç¬¬äºŒç§æ˜¯å› ä¸ºç½‘ç»œæŠ–åŠ¨è€Œå‡ºç°çš„ä¹±åºç°è±¡ï¼Œç¬¬ä¸‰ç§åˆ™æ˜¯ç”±äºè®¾å¤‡ç¦»çº¿é€ æˆçš„ç¼ºæ®µé—®é¢˜ï¼Œæƒ³è¦å‡å°è¿”å·¥é‡ï¼Œæœ€å¥½æ˜¯å°±åœ¨æ¨¡å‹å±‚é¢„å…ˆç•™å‡ºæ§åˆ¶é¢ã€‚</p>
<ul>
<li><code>quality</code> æ ‡è®°æ¥æºï¼ˆæ­£å¸¸/è¡¥ä¼ /ä¼°ç®—/æ— æ•ˆç­‰ï¼‰ï¼Œä¾¿äºå‘Šè­¦ä¸ç»Ÿè®¡å£å¾„ä¸€è‡´</li>
<li>å…¥å£å±‚ç”Ÿæˆ <code>event_id</code>ï¼ˆè®¾å¤‡åºå·æˆ–å“ˆå¸Œï¼‰ï¼Œç”¨äºå¹‚ç­‰å†™å…¥ä¸å»é‡</li>
</ul>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> telemetry_points2 (
  ts         <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  device_id  <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  metric     <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  <span class="hljs-keyword">value</span>      <span class="hljs-type">DOUBLE PRECISION</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  quality    <span class="hljs-type">INTEGER</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span>,
  event_id   <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">128</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  <span class="hljs-keyword">PRIMARY</span> KEY (event_id)
);
</code></pre>
<h3 data-id="heading-20">4.5 ç¼ºå¤±è¡¥é½ï¼šæŠŠâ€œæ—¶é—´å¯¹é½â€åšæˆå¯å¤ç”¨æŸ¥è¯¢æ¨¡æ¿</h3>
<p>çœ‹æ¿ç»å¸¸è¦ä¸€æ ¹â€œç­‰é—´éš”æ—¶é—´è½´â€ï¼ˆæ¯”å¦‚æ¯åˆ†é’Ÿä¸€ä¸ªç‚¹ï¼‰ã€‚é‡åˆ°ç¼ºå¤±æ—¶ï¼Œå…ˆç”¨ <code>NULL</code> å ä½æ›´å¹²å‡€ï¼Œåé¢åœ¨å±•ç¤ºå±‚å†åšæ’å€¼æˆ–å‰å‘å¡«å……å°±å¥½ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">WITH</span> time_grid <span class="hljs-keyword">AS</span> (
  <span class="hljs-keyword">SELECT</span> generate_series(
    <span class="hljs-type">TIMESTAMP</span> <span class="hljs-string">'2025-01-01 00:00:00'</span>,
    <span class="hljs-type">TIMESTAMP</span> <span class="hljs-string">'2025-01-01 01:00:00'</span>,
    <span class="hljs-type">INTERVAL</span> <span class="hljs-string">'1 minute'</span>
  ) <span class="hljs-keyword">AS</span> ts
),
raw <span class="hljs-keyword">AS</span> (
  <span class="hljs-keyword">SELECT</span> DATE_TRUNC(<span class="hljs-string">'minute'</span>, ts) <span class="hljs-keyword">AS</span> ts, <span class="hljs-built_in">AVG</span>(<span class="hljs-keyword">value</span>) <span class="hljs-keyword">AS</span> v
  <span class="hljs-keyword">FROM</span> telemetry_points
  <span class="hljs-keyword">WHERE</span> device_id <span class="hljs-operator">=</span> <span class="hljs-string">'D-10086'</span>
    <span class="hljs-keyword">AND</span> metric <span class="hljs-operator">=</span> <span class="hljs-string">'temperature'</span>
    <span class="hljs-keyword">AND</span> ts <span class="hljs-operator">&gt;=</span> <span class="hljs-string">'2025-01-01 00:00:00'</span>
    <span class="hljs-keyword">AND</span> ts <span class="hljs-operator">&lt;</span>  <span class="hljs-string">'2025-01-01 01:00:00'</span>
  <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> DATE_TRUNC(<span class="hljs-string">'minute'</span>, ts)
)
<span class="hljs-keyword">SELECT</span> g.ts, r.v
<span class="hljs-keyword">FROM</span> time_grid g
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> raw r <span class="hljs-keyword">ON</span> r.ts <span class="hljs-operator">=</span> g.ts
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> g.ts;
</code></pre>
<h3 data-id="heading-21">4.6 å‘Šè­¦è®¡ç®—ï¼šé˜ˆå€¼ + æŒç»­æ—¶é—´ï¼ˆé¿å…â€œæŠ–åŠ¨è¯¯æŠ¥â€ï¼‰</h3>
<p>ä¸å°‘å‘Šè­¦è§„åˆ™å¹¶ä¸æ˜¯â€œè¶…è¿‡é˜ˆå€¼å°±ç«‹åˆ»æŠ¥â€ï¼Œè€Œæ˜¯â€œè¿ç»­è¶…è¿‡é˜ˆå€¼ N åˆ†é’Ÿæ‰ç®—â€ã€‚è¿™ç±»éœ€æ±‚æ›´é€‚åˆå…ˆåœ¨åˆ†é’Ÿèšåˆå±‚ç®—ï¼Œå†å»è¯†åˆ«è¿ç»­æ®µã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">WITH</span> m1 <span class="hljs-keyword">AS</span> (
  <span class="hljs-keyword">SELECT</span>
    DATE_TRUNC(<span class="hljs-string">'minute'</span>, ts) <span class="hljs-keyword">AS</span> minute_ts,
    <span class="hljs-built_in">AVG</span>(<span class="hljs-keyword">value</span>) <span class="hljs-keyword">AS</span> avg_value
  <span class="hljs-keyword">FROM</span> telemetry_points
  <span class="hljs-keyword">WHERE</span> device_id <span class="hljs-operator">=</span> <span class="hljs-string">'D-10086'</span>
    <span class="hljs-keyword">AND</span> metric <span class="hljs-operator">=</span> <span class="hljs-string">'temperature'</span>
    <span class="hljs-keyword">AND</span> ts <span class="hljs-operator">&gt;=</span> <span class="hljs-string">'2025-01-01 00:00:00'</span>
    <span class="hljs-keyword">AND</span> ts <span class="hljs-operator">&lt;</span>  <span class="hljs-string">'2025-01-01 06:00:00'</span>
  <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> DATE_TRUNC(<span class="hljs-string">'minute'</span>, ts)
),
flag <span class="hljs-keyword">AS</span> (
  <span class="hljs-keyword">SELECT</span>
    minute_ts,
    avg_value,
    <span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> avg_value <span class="hljs-operator">&gt;=</span> <span class="hljs-number">80</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> over_th
  <span class="hljs-keyword">FROM</span> m1
),
grp <span class="hljs-keyword">AS</span> (
  <span class="hljs-keyword">SELECT</span>
    <span class="hljs-operator">*</span>,
    <span class="hljs-built_in">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> over_th <span class="hljs-operator">=</span> <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> minute_ts) <span class="hljs-keyword">AS</span> grp_id
  <span class="hljs-keyword">FROM</span> flag
)
<span class="hljs-keyword">SELECT</span>
  <span class="hljs-built_in">MIN</span>(minute_ts) <span class="hljs-keyword">AS</span> start_ts,
  <span class="hljs-built_in">MAX</span>(minute_ts) <span class="hljs-keyword">AS</span> end_ts,
  <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">AS</span> minutes
<span class="hljs-keyword">FROM</span> grp
<span class="hljs-keyword">WHERE</span> over_th <span class="hljs-operator">=</span> <span class="hljs-number">1</span>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> grp_id
<span class="hljs-keyword">HAVING</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-operator">&gt;=</span> <span class="hljs-number">5</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> start_ts;
</code></pre>
<hr/>
<h2 data-id="heading-22">5. ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šçƒ­/æ¸©/å†·åˆ†å±‚ä¸ä¿ç•™ç­–ç•¥ï¼ˆè½åœ°å¯éªŒæ”¶ï¼‰</h2>
<p>æ—¶åºé¡¹ç›®æœ€å®¹æ˜“è¶Šè·‘è¶Šè´µï¼ŒåŸå› å¾€å¾€å¾ˆæœ´ç´ ï¼šåŸå§‹æ•°æ®ä¸€ç›´æ¶¨ã€èšåˆå±‚æ²¡è§„åˆ’ã€è¿‡æœŸæ•°æ®æ¸…ä¸æ‰ï¼ˆæˆ–è€…ä¸æ•¢æ¸…ï¼‰ã€‚</p>
<p>ä¸€ä¸ªå®ç”¨çš„åšæ³•ï¼Œæ˜¯æŒ‰ä¸šåŠ¡ä»·å€¼æŠŠæ•°æ®åˆ†ä¸‰å±‚ï¼š
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4847f42a74084e079a20e59150cf2a7e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769253691&amp;x-signature=ewj21miKVR%2BFpb8MZhqW5Cls6LA%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™å—æ€ä¹ˆéªŒæ”¶ä¹Ÿä¸éš¾ï¼Œå£å¾„å¯ä»¥å¾ˆæ¸…æ¥šï¼š</p>
<ul>
<li>åˆ†åŒºåˆ‡æ¢ä¸æ¸…ç†æ˜¯å¦è‡ªåŠ¨åŒ–ï¼›</li>
<li>èšåˆå±‚æ˜¯å¦æŒ‰å‘¨æœŸç”Ÿæˆå¹¶å¯å›è¡¥ï¼›</li>
<li>å•æ¬¡çœ‹æ¿æŸ¥è¯¢èƒ½å¦ç¨³å®šåœ¨ç›®æ ‡å»¶è¿Ÿï¼ˆä¾‹å¦‚ 1â€“3 ç§’çº§ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-23">5.1 åˆ†åŒºæ¸…ç†çš„æœ€å°å¯è¡Œç­–ç•¥ï¼šæŒ‰â€œåˆ†åŒºåˆ é™¤â€è€Œéâ€œå…¨è¡¨åˆ é™¤â€</h3>
<p>è¿‡æœŸæ•°æ®çš„å¤„ç†ä¸Šï¼Œä¼˜å…ˆé€‰â€œæŒ‰åˆ†åŒºåˆ é™¤/å½’æ¡£â€ï¼Œåˆ«ç”¨â€œå…¨è¡¨æ‰«ä¸€éå†åˆ â€çš„æ–¹å¼å»èµŒè¿æ°”ï¼Œè¿™æ ·èƒ½ç»•å¼€é•¿äº‹åŠ¡å’Œå¤§é‡ç¢ç‰‡å¸¦æ¥çš„æŠ–åŠ¨é£é™©ã€‚éªŒæ”¶æ—¶å°±çœ‹ä¸¤ä»¶äº‹ï¼šæ¸…ç†çª—å£é‡Œç³»ç»Ÿç¨³ä¸ç¨³ã€æ¸…ç†è€—æ—¶èƒ½ä¸èƒ½é¢„æµ‹ã€‚</p>
<h3 data-id="heading-24">5.2 ç”¨ä¸€å¼ å›¾ç†è§£â€œæ˜ç»†åˆ°æŒ‡æ ‡â€çš„æ•°æ®é‡‘å­—å¡”</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TB
  A[åŸå§‹æ˜ç»†ç‚¹ä½&lt;br/&gt;ç§’çº§/æ›´ç»†] --&gt; B[åˆ†é’Ÿèšåˆ&lt;br/&gt;çœ‹æ¿ä¸»åŠ›]
  B --&gt; C[å°æ—¶/å¤©èšåˆ&lt;br/&gt;æŠ¥è¡¨ä¸è¶‹åŠ¿]
  A --&gt; D[äº‹ä»¶/å‘Šè­¦è¡¨&lt;br/&gt;å®šä½å…¥å£]
  D --&gt; A
</code></pre>
<hr/>
<h2 data-id="heading-25">6. å…³é”®è¡Œä¸šåº”ç”¨å®è·µï¼šä¸‰ç±»åœºæ™¯ã€ä¸‰ç§äº¤ä»˜æ–¹å¼</h2>
<p>ä¸‹é¢æˆ‘å°±æŒ‰â€œä¸šåŠ¡è¯‰æ±‚â€”æ•°æ®ç‰¹å¾â€”è½åœ°æ‰“æ³•â€æ¥å†™ï¼Œä½ å†™å¾æ–‡æˆ–æ–¹æ¡ˆæ—¶ä¹Ÿæ–¹ä¾¿ç›´æ¥æ‹¿å»ç”¨ã€‚</p>
<h3 data-id="heading-26">6.0 ä¸€å¼ è¡¨æŠŠâ€œåœºæ™¯è¯‰æ±‚â€æ˜ å°„åˆ°â€œé‡‘ä»“è½åœ°åŠ¨ä½œâ€</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/edd77ec9032b4340bd1db610a7dc17aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769253691&amp;x-signature=gzJi5WMn%2FRWaSWCfyBGSUYYJoPw%3D" alt="image.png" loading="lazy"/></p>
<p>é¡ºå¸¦ä¸€æï¼Œâ€œæ—¶é—´ + ä¸šåŠ¡ç»´åº¦â€çš„è”åˆåˆ†åŒº/åˆ†ç‰‡ï¼Œä»¥åŠæŠŠæŸ¥è¯¢æ”¶æ•›åˆ°åŒºé—´ç­›é€‰ä¸æ—¶é—´çª—å£è¿™å¥—å†™æ³•ï¼Œåœ¨é‡‘ä»“å®˜ç½‘çš„æ—¶åºåˆ†ææ–‡ç« é‡Œè¢«åå¤å¼ºè°ƒï¼Œç”¨å®ƒæ¥å½“æ–¹æ¡ˆçš„è®¾è®¡æŠ“æ‰‹ä¼šæ›´è½åœ°ã€‚[^kb-logs][^kb-safety]</p>
<h3 data-id="heading-27">6.1 ç”µåŠ›ä¸èƒ½æºï¼šè®¾å¤‡çŠ¶æ€ç›‘æµ‹ + æ•…éšœè¿½æº¯</h3>
<p><strong>ä¸šåŠ¡è¯‰æ±‚</strong><br/>
è®¾å¤‡çŠ¶æ€é‡ï¼ˆç”µå‹ã€ç”µæµã€æ¸©åº¦ã€æŒ¯åŠ¨ç­‰ï¼‰è¿ç»­é‡‡é›†ï¼›å¼‚å¸¸å‘ç”Ÿåè¦èƒ½å¿«é€Ÿå®šä½æ—¶é—´çª—ã€å…³è”å·¥å†µä¸å‘Šè­¦è®°å½•ã€‚</p>
<p><strong>æ•°æ®ç‰¹å¾</strong><br/>
ç‚¹ä½å¤šã€é‡‡æ ·å‘¨æœŸçŸ­ï¼›å³°å€¼å†™å…¥é«˜ï¼›æŸ¥è¯¢ä»¥â€œè®¾å¤‡+æ—¶é—´æ®µâ€ä¸ºä¸»ï¼Œä¼´éšèšåˆä¸å¯¹æ¯”ã€‚</p>
<p><strong>è½åœ°æ‰“æ³•</strong></p>
<ul>
<li>ç”¨é‡‘ä»“æ—¶åºæ•°æ®åº“æ‰¿è½½æµ·é‡é‡‡é›†ä¸æ£€ç´¢ï¼Œå…ˆæŠŠå†™å…¥ä¸æŸ¥è¯¢åŸºçº¿å‹æµ‹è·‘å‡ºæ¥ï¼Œå¿ƒé‡Œæœ‰æ•°ï¼›[^kb-kes]</li>
<li>æ˜ç»†è¡¨æŒ‰å¤©åˆ†åŒºï¼›å¸¸ç”¨è®¾å¤‡/æŒ‡æ ‡å»ºç»„åˆç´¢å¼•ï¼›</li>
<li>å»ºåˆ†é’Ÿçº§èšåˆå±‚ä¾›çœ‹æ¿è¯»ï¼›</li>
<li>æ•…éšœè¿½æº¯èµ°â€œäº‹ä»¶è¡¨ + æ˜ç»†å›æ”¾â€é“¾è·¯ã€‚</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
  participant Dev as è®¾å¤‡/é‡‡é›†ç«¯
  participant Gw as ç½‘å…³/æ¶ˆæ¯é˜Ÿåˆ—
  participant TS as é‡‘ä»“æ—¶åºæ•°æ®åº“
  participant BI as çœ‹æ¿/å‘Šè­¦
  Dev-&gt;&gt;Gw: æ‰¹é‡ä¸ŠæŠ¥(å«åºå·/æ—¶é—´æˆ³)
  Gw-&gt;&gt;TS: æ‰¹é‡å†™å…¥/é‡è¯•
  TS--&gt;&gt;BI: åˆ†é’ŸèšåˆæŒ‡æ ‡
  BI--&gt;&gt;TS: å¼‚å¸¸å›æ”¾æŸ¥è¯¢(è®¾å¤‡+æ—¶é—´çª—)
</code></pre>
<h3 data-id="heading-28">6.2 åˆ¶é€ ä¸å·¥ä¸šäº’è”ç½‘ï¼šOEE/èƒ½è€—ä¸è´¨é‡æ³¢åŠ¨åˆ†æ</h3>
<p><strong>ä¸šåŠ¡è¯‰æ±‚</strong><br/>
æŠŠæœºå°æ•°æ®å˜æˆå¯è¿è¥æŒ‡æ ‡ï¼ˆç¨¼åŠ¨ç‡ã€èƒ½è€—ã€èŠ‚æ‹æ³¢åŠ¨ã€è‰¯ç‡å…³è”ï¼‰ï¼Œå¹¶èƒ½æŒ‰äº§çº¿/ç­ç»„/å·¥å•ç»´åº¦åˆ†æã€‚</p>
<p><strong>æ•°æ®ç‰¹å¾</strong><br/>
é™¤æ—¶åºæ˜ç»†å¤–ï¼Œå¿…é¡»å¼ºä¾èµ–ç»´åº¦ï¼ˆäº§çº¿ã€å·¥å•ã€ç‰©æ–™æ‰¹æ¬¡ã€å·¥è‰ºæ®µï¼‰ã€‚</p>
<p><strong>è½åœ°æ‰“æ³•</strong></p>
<ul>
<li>æŠŠæ—¶åºäº‹å®è¡¨å’Œä¸šåŠ¡ç»´è¡¨æ”¾åœ¨é‡‘ä»“ç»Ÿä¸€åº•åº§å†…ï¼Œå°½é‡å°‘åšè·¨åº“åŒæ­¥ï¼ŒæŠŠä¸€è‡´æ€§æ²»ç†çš„å¤æ‚åº¦å‹ä¸‹å»ï¼›[^kb-kes]</li>
<li>â€œæ—¶åºäº‹å®è¡¨ + ç»´è¡¨â€å»ºæ¨¡ï¼šç»´è¡¨ç›¸å¯¹ç¨³å®šï¼Œäº‹å®è¡¨é«˜é¢‘å†™ï¼›</li>
<li>æŸ¥è¯¢ä¾§åšâ€œçª—å£èšåˆ + ç»´è¡¨å…³è”â€ï¼ŒæŠŠæŒ‡æ ‡æ²‰æ·€åˆ°æŠ¥è¡¨å±‚ï¼›</li>
<li>å¯¹å…³é”®æŒ‡æ ‡åšé¢„èšåˆï¼Œå‡å°‘å³°å€¼å‹åŠ›ã€‚</li>
</ul>
<h3 data-id="heading-29">6.3 äº¤é€šä¸åŸå¸‚è¿è¡Œï¼šå¤šæºèåˆç›‘æµ‹ä¸æ€åŠ¿æ„ŸçŸ¥</h3>
<p><strong>ä¸šåŠ¡è¯‰æ±‚</strong><br/>
èåˆå¤šæºæ•°æ®ï¼ˆè®¾å¤‡ã€ç¯å¢ƒã€è§†é¢‘ç»“æ„åŒ–æŒ‡æ ‡ã€è·¯ç½‘çŠ¶æ€ï¼‰ï¼Œè¦æ±‚ç¨³å®šæ¥å…¥ã€å®æ—¶èšåˆä¸è¶‹åŠ¿åˆ¤æ–­ã€‚</p>
<p><strong>æ•°æ®ç‰¹å¾</strong><br/>
æ¥æºå¤šã€æ ¼å¼ä¸ä¸€ã€è´¨é‡å‚å·®ï¼›éœ€è¦ç»Ÿä¸€æ—¶é—´å¯¹é½ä¸æ•°æ®è´¨é‡ç®¡ç†ã€‚</p>
<p><strong>è½åœ°æ‰“æ³•</strong></p>
<ul>
<li>æ¥å…¥å±‚è§„èŒƒåŒ–ï¼šç»Ÿä¸€æ—¶é—´å£å¾„ã€ç»Ÿä¸€è®¾å¤‡IDæ˜ å°„ï¼›</li>
<li>å…¥åº“å‰åšåŸºç¡€è´¨é‡æ ¡éªŒï¼ˆç¼ºæµ‹ã€é‡å¤ã€å¼‚å¸¸å€¼æ ‡è®°ï¼‰ï¼›</li>
<li>ç”¨èšåˆå±‚æ”¯æ’‘å…¨å¸‚/å…¨ç½‘æ€åŠ¿çœ‹æ¿ï¼Œç”¨æ˜ç»†å±‚æ”¯æ’‘å±€éƒ¨æ’éšœå›æ”¾ã€‚</li>
<li>éœ€è¦ç©ºé—´ç»´åº¦ï¼ˆåŒºåŸŸã€è·¯æ®µã€å›´æ ï¼‰æ—¶ï¼Œå¯ç»“åˆæ—¶åºä¸ç©ºé—´æ•°æ®åšè”åˆç­›é€‰ï¼ŒæŠŠâ€œæ—¶é—´çª— + ç©ºé—´èŒƒå›´â€çš„æŸ¥è¯¢æ”¶æ•›æˆå¯å¤ç”¨æ¨¡æ¿ã€‚[^kb-kes][^kb-safety]</li>
</ul>
<hr/>
<h2 data-id="heading-30">7. å›½äº§åŒ–æ›¿ä»£èƒŒæ™¯ä¸‹ï¼šæ€ä¹ˆæŠŠâ€œå¯ç”¨â€åšæˆâ€œå¥½ç”¨ã€ç¨³ç”¨ã€å¯æŒç»­ç”¨â€</h2>
<p>å›½äº§åŒ–æ›¿ä»£é¡¹ç›®çœŸæ­£çš„å…³é”®ï¼Œé€šå¸¸ä¸æ˜¯â€œèƒ½ä¸èƒ½æ›¿â€ï¼Œè€Œæ˜¯æŠŠé£é™©å°½é‡ä»â€œä¸Šçº¿åæš´éœ²â€å‰ç§»åˆ°â€œä¸Šçº¿å‰å¯æ§â€ã€‚æ¯”è¾ƒç¨³çš„æ¨è¿›æ–¹å¼ï¼Œå¯ä»¥æ²¿ç€â€œä¸‰æ¡ä¸»çº¿â€èµ°ï¼š</p>
<h3 data-id="heading-31">7.1 ä¸»çº¿ä¸€ï¼šé€‰å‹ä¸éªŒè¯ï¼ˆå¯é‡åŒ–ã€å¯å¤æµ‹ï¼‰</h3>
<p>éªŒè¯é›†å»ºè®®è‡³å°‘è¦†ç›–è¿™äº›ç»´åº¦ï¼š</p>
<ul>
<li>
<p>å†™å…¥ï¼šå³°å€¼ååã€ä¹±åºè¡¥å†™ã€é‡è¯•å¹‚ç­‰ï¼›</p>
</li>
<li>
<p>æŸ¥è¯¢ï¼šå…¸å‹çœ‹æ¿/æŠ¥è¡¨/å›æ”¾ SQL çš„ç¨³å®šå»¶è¿Ÿï¼›</p>
</li>
<li>
<p>è¿ç»´ï¼šå¤‡ä»½æ¢å¤ã€æ‰©å®¹ã€åˆ†åŒºç»´æŠ¤ã€ç”Ÿå‘½å‘¨æœŸæ¸…ç†ï¼›</p>
</li>
<li>
<p>å®‰å…¨ï¼šæƒé™éš”ç¦»ã€å®¡è®¡ç•™ç—•ã€è´¦å·ç­–ç•¥ä¸åˆè§„è¦æ±‚ã€‚</p>
</li>
</ul>
<p>æ›´ä¸ºå…³é”®çš„æ˜¯è¦å°†éªŒè¯åŠ¨ä½œå’Œå·¥å…·é“¾å…³è”èµ·æ¥ï¼Œè¿ç§»è¯„å®šï¼Œæ•°æ®è¿ç§»ï¼Œå¼€å‘å®ˆæŠ¤ä»¥åŠé›†ä¸­è¿ç»´è¿™äº›ç¯èŠ‚éƒ½åº”è¯¥å‡ç»“æˆå¯å›æº¯çš„äº¤ä»˜ç‰©ï¼Œä¸å¯è®©æ›¿ä»£é¡¹ç›®ä»…ä¾é è®°å¿†æˆ–è€…ç»éªŒå­˜åœ¨ã€‚</p>
<h3 data-id="heading-32">7.2 ä¸»çº¿äºŒï¼šæ•°æ®åˆ†å±‚ä¸æŒ‡æ ‡ä½“ç³»ï¼ˆè®©æˆæœ¬ä¸æ€§èƒ½å¯æ§ï¼‰</h3>
<p>æ¯”è¾ƒå®ç”¨çš„åšæ³•ï¼Œæ˜¯å…ˆæŠŠæŒ‡æ ‡åˆ†æˆä¸‰ç±»ï¼š</p>
<ul>
<li>éœ€è¦ç§’çº§ï¼šèµ°åˆ†é’Ÿèšåˆå±‚æˆ–æ›´ç»†ç²’åº¦çš„é¢„èšåˆï¼›</li>
<li>éœ€è¦åˆ†é’Ÿçº§ï¼šç›´æ¥æŸ¥èšåˆå±‚ï¼›</li>
<li>éœ€è¦è¿½æº¯ï¼šä»äº‹ä»¶å®šä½ï¼Œå†å›æ”¾æ˜ç»†å±‚ã€‚</li>
</ul>
<p>è¿™æ ·èµ„æºæ¶ˆè€—å°±èƒ½ä»â€œæ¯æ¬¡éƒ½æ‰«æ˜ç»†â€å˜æˆâ€œå¤šæ•°è¯»èšåˆï¼Œå°‘æ•°å›æ”¾æ˜ç»†â€ï¼Œæ€§èƒ½å’Œæˆæœ¬éƒ½ä¼šç¨³å¾ˆå¤šã€‚</p>
<h3 data-id="heading-33">7.3 ä¸»çº¿ä¸‰ï¼šè¿ç»´é—­ç¯ï¼ˆè®©ç³»ç»Ÿåœ¨ç”Ÿäº§ä¸­æŒç»­ç¨³å®šï¼‰</h3>
<p>å»ºè®®æŠŠä¸‹é¢è¿™äº›äº‹åšæˆæ—¥å¸¸åŠ¨ä½œï¼Œåˆ«ç­‰å‡ºé—®é¢˜æ‰æƒ³èµ·æ¥ï¼š</p>
<ul>
<li>
<p>åˆ†åŒºè‡ªåŠ¨åˆ›å»ºä¸è¿‡æœŸæ¸…ç†ï¼›</p>
</li>
<li>
<p>èšåˆå±‚æŒ‰è®¡åˆ’åˆ·æ–°å¹¶å…·å¤‡å›è¡¥çª—å£ï¼›</p>
</li>
<li>
<p>æŒ‡æ ‡ç›‘æ§ï¼šå†™å…¥å»¶è¿Ÿã€æŸ¥è¯¢ P95ã€ç£ç›˜å¢é•¿ã€åˆ†åŒºæ•°é‡ã€æ…¢æŸ¥è¯¢ï¼›</p>
</li>
<li>
<p>ç¾å¤‡æ¼”ç»ƒï¼šæŒ‰å­£åº¦åšæ¢å¤æ¼”ç»ƒä¸å®¹é‡å›å½’ã€‚</p>
</li>
</ul>
<hr/>
<h2 data-id="heading-34">ç»“è¯­ï¼šç”¨â€œå¯äº¤ä»˜çš„æ—¶åºå·¥ç¨‹â€æŠŠæœºä¼šç‚¹è½åˆ°ç°å®</h2>
<p>2025å¹´çš„æ—¶åºæ•°æ®åº“ç«äº‰æ¸æ¸å˜æˆäº†ä¸€åœºå·¥ç¨‹äº¤ä»˜èƒ½åŠ›çš„è¾ƒé‡ï¼Œè°èƒ½å°†å†™å…¥ï¼Œå­˜å‚¨ï¼ŒæŸ¥è¯¢ï¼Œæ²»ç†ï¼Œè¿ç»´å½¢æˆèµ·ä¸€å¥—å¯å¤ç”¨çš„ä½“ç³»ï¼Œè°å°±æ›´æœ‰å¯èƒ½åœ¨å…³é”®è¡Œä¸šä¸­åšåˆ°è§„æ¨¡æ‰©å¼ ã€‚</p>
<p>å¦‚æœä½ æ­£åœ¨æ¨åŠ¨å…³é”®è¡Œä¸šæ—¶åºæ•°æ®å¹³å°çš„åˆ›å»ºæˆ–è€…è¿›è¡Œå›½äº§åŒ–æ›¿ä»£ï¼Œå»ºè®®å…ˆæŠŠâ€œæ•°æ®åˆ†å±‚ï¼Œåˆ†åŒºç”Ÿå‘½å‘¨æœŸï¼Œé¢„èšåˆâ€è¿™ä¸‰ä»¶äº‹åšå¥½ï¼Œç„¶åé€æ­¥æ·±å…¥åœ°å®Œå–„æŒ‡æ ‡ä½“ç³»å’Œè¿ç»´é—­ç¯ã€‚æƒ³äº†è§£æ›´å¤šäº§å“ä¸æ–¹æ¡ˆï¼Œå¯ä»¥åˆ°é‡‘ä»“æ•°æ®åº“å®˜ç½‘çœ‹çœ‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.kingbase.com.cn%2F" target="_blank" title="https://www.kingbase.com.cn/" ref="nofollow noopener noreferrer">www.kingbase.com.cn/</a></p>
<p>ğŸ‘‰ <strong>é‡‘ä»“æ•°æ®åº“å®˜æ–¹åšå®¢ç«™</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fkingbase.com.cn%2Fexplore" target="_blank" title="https://kingbase.com.cn/explore" ref="nofollow noopener noreferrer">kingbase.com.cn/explore</a><br/>
æƒ³ç»§ç»­æ·±æŒ–çš„è¯ï¼Œè¿™é‡Œæœ‰ä¸å°‘ä¸“å®¶æ–‡ç« ã€åŸç†è§£æå’Œæœ€ä½³å®è·µï¼Œå¯ä»¥æŒ‰åœºæ™¯ç›´æ¥æŒ‘ç€çœ‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4489bfd0539c468cbea4c95c197e29aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YCU5by655qE55-z5aS0Xw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769253691&amp;x-signature=uTf9%2BxessAbK49jLIj8bLrmJd5Q%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸŒ°åœ¨ OpenLayers ä¸­å®ç°å›¾å±‚è£åˆ‡]]></title>    <link>https://juejin.cn/post/7595890117865701422</link>    <guid>https://juejin.cn/post/7595890117865701422</guid>    <pubDate>2026-01-17T11:31:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595890117865701422" data-draft-id="7595894884956864563" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸŒ°åœ¨ OpenLayers ä¸­å®ç°å›¾å±‚è£åˆ‡"/> <meta itemprop="keywords" content="å‰ç«¯,GIS"/> <meta itemprop="datePublished" content="2026-01-17T11:31:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é»‘å¿ƒçš®è›‹"/> <meta itemprop="url" content="https://juejin.cn/user/3738785874458039"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸŒ°åœ¨ OpenLayers ä¸­å®ç°å›¾å±‚è£åˆ‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3738785874458039/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é»‘å¿ƒçš®è›‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T11:31:43.000Z" title="Sat Jan 17 2026 11:31:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{font-family:-apple-system,system-ui,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial;color:#00325e}.markdown-body ::selection{background-color:#00325e;color:#fff}.markdown-body blockquote{padding:10px 20px;background-color:#fffaf0;box-shadow:0 3px 10px 0 rgba(255,172,194,.24);border:1px solid #f3ca8e;transition:all .2s;margin:1em 0;border-radius:5px}.markdown-body blockquote p{font-size:14px;line-height:25px;color:#795548}.markdown-body blockquote p:last-child{margin:0}.markdown-body blockquote:hover{border-color:#ff9800;background-color:#fff8e0;box-shadow:0 6px 10px -5px rgba(225,173,98,.3803921569)}.markdown-body blockquote code{color:#ff502c}.markdown-body pre{border:1px solid #8cc0f3;box-shadow:0 3px 10px 0 rgba(255,198,198,.28);border-radius:5px;transition:all .2s;overflow-x:auto;white-space:pre-wrap}.markdown-body pre:hover{border-color:#6d9dce}.markdown-body pre&gt;code{padding:10px 20px;color:#00325e;background:#f0f8ff;font-size:12px;line-height:1.6;display:block}.markdown-body code{background:#f6fbff;color:#0b5393;padding:2px 4px;border-radius:4px;font-size:12px}.markdown-body p{font-size:14px;line-height:28px;text-align:justify;margin-bottom:17px;color:#595959}.markdown-body a{color:#00325e;text-decoration:none}.markdown-body a:after{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAQdJREFUKFNt0DtLA0EUBeBzZle0Eks7rcUfEfBRCha7NorYa6NmVJzgyi4smUgKtdZGCJktLMVH4Y8QeztLWyE7VyLEuNFbXj4Oh0P8c8mZm+uJrEN4BJFTeP/MUVe3bnocfALwkOlo1zS7iZAzf6Cx7oXgbaqjxiDEWCcVaGyxQ8pSWo9XhqhoQ/xUFbaKjhe5V+CmR7mnSplEEF6GSmJ+F/d0KHvbCIIJCLc85U6BC5mONgbJNM3uFag++sX7z8O8MzsWBucifMx0dDGE1kmm458KDVukAlnNdDz/exEeW3dNkbfsYC0xtmgDWP6ELLZ0/F6BJu/UoFQN5AkoeUjeJPvx6+i+X5Sjah4tA6gYAAAAAElFTkSuQmCC);margin-left:2px}.markdown-body a:hover{box-shadow:0 1px}.markdown-body table{max-width:100%;border-collapse:collapse;border-spacing:0;box-shadow:0 3px 10px 0 rgba(255,238,172,.24);transition:all .2s}.markdown-body table:hover{box-shadow:0 3px 10px 0 rgba(185,169,103,.24)}.markdown-body table tr th{border:1px solid #8cc0f3;background-color:#f0f8ff;padding:12px 15px}.markdown-body table tr td{border:1px solid rgba(243,202,142,.4);padding:12px 15px}.markdown-body table tbody tr{transition:all .2s}.markdown-body table tbody tr:hover td{border-color:#f3ca8e;background-color:#fff8e0;z-index:1}.markdown-body img{max-width:100%}.markdown-body h1{font-size:20px;margin-top:30px;margin-bottom:10px;padding-left:30px;position:relative}.markdown-body h1&gt;code{font-size:20px}.markdown-body h1:before{content:"ğŸº";display:block;font-size:18px;width:18px;height:18px;left:0;position:absolute}.markdown-body h2{font-size:18px;margin-top:30px;margin-bottom:10px;padding-left:28px;position:relative}.markdown-body h2&gt;code{font-size:18px}.markdown-body h2:before{content:"ğŸ»";display:block;font-size:16px;width:16px;height:16px;left:0;position:absolute}.markdown-body h3{font-size:16px;margin-top:30px;margin-bottom:10px;padding-left:26px;position:relative}.markdown-body h3&gt;code{font-size:16px}.markdown-body h3:before{content:"ğŸ¥‚";display:block;font-size:14px;width:14px;height:14px;left:0;position:absolute}.markdown-body h4{font-size:14px;margin-top:30px;margin-bottom:10px;padding-left:24px;position:relative}.markdown-body h4&gt;code{font-size:14px}.markdown-body h4:before{content:"ğŸ¥ƒ";display:block;font-size:12px;width:12px;height:12px;left:0;position:absolute}.markdown-body h5{font-size:12px;margin-top:30px;margin-bottom:10px}.markdown-body h5&gt;code{font-size:12px}.markdown-body h6{font-size:10px;margin-top:30px;margin-bottom:10px}.markdown-body h6&gt;code{font-size:10px}.markdown-body h1,.markdown-body h2{color:#ff502c}.markdown-body hr{height:4px;border:none;margin-top:32px;margin-bottom:32px;background-size:4px 1px;background-image:linear-gradient(270deg,#6d9dce,#8cc0f3 25%,transparent 50%)}.markdown-body hr:nth-child(2n){background-image:linear-gradient(270deg,#ff9800,#fff8e0 25%,transparent 50%)}.markdown-body ul{padding-inline-start:20px}.markdown-body ul li{list-style-type:"ğŸ”¸"}.markdown-body ul li li{list-style-type:"â—»ï¸"}.markdown-body ul li li li{list-style-type:"â–«ï¸"}.markdown-body ol{padding-inline-start:20px}.markdown-body ol ::marker{color:#ff9800}.markdown-body ol,.markdown-body ul{line-height:2em}.markdown-body li{padding-inline-start:1ch}.markdown-body li.task-list-item{list-style:none;padding-inline-start:0}.markdown-body li input{padding-right:2px}.markdown-body li input[type=checkbox i]{appearance:none}.markdown-body li input:before{content:"ğŸŸ©";display:block;width:13px;height:13px}.markdown-body li input:checked:before{content:"âœ…"}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atelier-sulphurpool-light">.hljs-comment,.hljs-quote{color:#6b7394}.hljs-attribute,.hljs-link,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#c94922}.hljs-built_in,.hljs-builtin-name,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#c76b29}.hljs-bullet,.hljs-string,.hljs-symbol{color:#ac9739}.hljs-section,.hljs-title{color:#3d8fd1}.hljs-keyword,.hljs-selector-tag{color:#6679cc}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#f5f7ff;color:#5e6687}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9bb77a589b2f40f2a4eec2a5f9415aab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buR5b-D55qu6JuL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769254303&amp;x-signature=zhS0YkFsCOPczuk7iFb0uBq%2FV%2FU%3D" alt="img" loading="lazy"/>ğŸ’¬ å‰è¨€</h2>
<p>â€‹	åšåœ°å›¾çš„æ—¶å€™ï¼Œå¸¸ä¼šç»™åœ°å›¾å¥—ä¸ªâ€œé®ç½©â€â€”â€”æŠŠä¸å…³å¿ƒçš„åœ°æ–¹è°ƒæš—ï¼ŒæŠŠæƒ³çœ‹çš„åœ°æ–¹çªå‡ºå‡ºæ¥ã€‚ä½†æœ‰æ—¶æˆ‘ä»¬å¹¶ä¸æƒ³åŠ¨æ•´å¼ åœ°å›¾çš„è§†è§‰æ•ˆæœï¼Œåªæƒ³æŠŠæŸä¸€å¼ å›¾å±‚æŒ‰ä¸è§„åˆ™å½¢çŠ¶å±•ç¤ºå‡ºæ¥ï¼Œæ¯”å¦‚åªåœ¨æŸå—å¤šè¾¹å½¢é‡Œæ˜¾ç¤ºæŒ‡å®šå›¾å±‚ã€‚</p>
<h2 data-id="heading-1">ğŸ¯ æœ€ç»ˆæ•ˆæœå¦‚ä¸‹</h2>
<blockquote>
<p>ç»™å®šä¸€ä¸ªå¤šè¾¹å½¢ï¼ˆpolygonCoordsï¼‰ï¼Œå¯¹å•ä¸€ WMTS/ç“¦ç‰‡å›¾å±‚è¿›è¡Œè£åˆ‡ï¼šå›¾å±‚ä»…åœ¨è¯¥å¤šè¾¹å½¢å†…éƒ¨å¯è§ï¼Œå…¶ä»–å›¾å±‚ä¸å—å½±å“ã€‚</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb736c5ae789455e90444e1b40ce72b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buR5b-D55qu6JuL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769254303&amp;x-signature=euEHOYoOheo8D9TBYBPI3PK9Pbo%3D" alt="å›¾å±‚è£åˆ‡æœ€ç»ˆæ•ˆæœ" loading="lazy"/></p>
<h2 data-id="heading-2">ğŸ§­ å®ç°æ€è·¯</h2>
<blockquote>
<p>é€šè¿‡ç›‘å¬å›¾å±‚çš„ prerender äº‹ä»¶ å’Œ postrenderäº‹ä»¶ å®ç°è£åˆ‡</p>
</blockquote>
<ol>
<li>åœ¨å›¾å±‚å¼€å§‹ç»˜åˆ¶ä¹‹å‰ï¼ˆprerenderï¼‰å‡†å¤‡è£åˆ‡ï¼š
<ul>
<li>å›è°ƒé‡Œä¼šæ‹¿åˆ°ä¸¤ä¸ªä¸œè¥¿ï¼šOpenLayers çš„çŸ¢é‡æ¸²æŸ“ä¸Šä¸‹æ–‡å’ŒåŸç”Ÿçš„ Canvas ä¸Šä¸‹æ–‡ï¼ˆctxï¼‰ã€‚</li>
<li>å…ˆç”¨ ctx.save() ä¿å­˜å½“å‰ canvas çŠ¶æ€ã€‚</li>
<li>ç”¨ <code>drawFeature(feature, style)</code> æŠŠå¤šè¾¹å½¢ç”»åˆ°å½“å‰ç”»å¸ƒä¸Šï¼ˆè¿™ä¼šåœ¨ canvas ä¸Šç”Ÿæˆè·¯å¾„ï¼‰ã€‚</li>
<li>ç„¶åè°ƒç”¨ <code>ctx.clip()</code>ï¼ŒæŠŠè¿™æ¡è·¯å¾„è®¾ä¸ºè£åˆ‡åŒº,å°†å½“å‰å›¾å±‚è¿›è¡Œè£åˆ‡ã€‚</li>
</ul>
</li>
<li>åœ¨å›¾å±‚ç»˜åˆ¶ç»“æŸåï¼ˆpostrenderï¼‰æ¢å¤çŠ¶æ€ï¼š
<ul>
<li>åœ¨ postrender å›è°ƒé‡Œè°ƒç”¨ <code>ctx.restore()</code>ï¼ŒæŠŠä¹‹å‰ä¿å­˜çš„ canvas çŠ¶æ€è¿˜åŸï¼Œç§»é™¤è£åˆ‡ï¼Œç¡®ä¿åˆ«çš„å›¾å±‚ä¸å—å½±å“ã€‚</li>
</ul>
</li>
</ol>
<h2 data-id="heading-3">âš™ï¸ åˆå§‹åŒ–é¡¹ç›®</h2>
<p>â€‹	è¿™é‡Œæˆ‘è®¾ç½®åœ°å›¾çš„åæ ‡ç³»æ˜¯3857,ä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦è®¾ç½®å¯¹åº”çš„åæ ‡ç³»</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-cn"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>openlayerå›¾å±‚è£åˆ‡<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-tag">html</span>,
        <span class="hljs-selector-tag">body</span>,
        <span class="hljs-selector-id">#map</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"map"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./ol.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">const</span> projection = ol.<span class="hljs-property">proj</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'EPSG:3857'</span>);
        <span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> ol.<span class="hljs-title class_">Map</span>({
            <span class="hljs-attr">layers</span>: [
                <span class="hljs-comment">// çŸ¢é‡åº•å›¾</span>
                <span class="hljs-keyword">new</span> ol.<span class="hljs-property">layer</span>.<span class="hljs-title class_">Tile</span>({
                    <span class="hljs-attr">source</span>: <span class="hljs-keyword">new</span> ol.<span class="hljs-property">source</span>.<span class="hljs-title function_">XYZ</span>({
                        <span class="hljs-attr">url</span>: <span class="hljs-string">`https://t{0-7}.tianditu.gov.cn/DataServer?T=vec_w&amp;x={x}&amp;y={y}&amp;l={z}&amp;tk=2aedde694311cf1e8ac3feca2da4fd3e`</span>,
                    }),
                }),
                <span class="hljs-comment">// çŸ¢é‡æ³¨è®°</span>
                <span class="hljs-keyword">new</span> ol.<span class="hljs-property">layer</span>.<span class="hljs-title class_">Tile</span>({
                    <span class="hljs-attr">source</span>: <span class="hljs-keyword">new</span> ol.<span class="hljs-property">source</span>.<span class="hljs-title function_">XYZ</span>({
                        <span class="hljs-attr">url</span>: <span class="hljs-string">`https://t{0-7}.tianditu.gov.cn/DataServer?T=cva_w&amp;x={x}&amp;y={y}&amp;l={z}&amp;tk=2aedde694311cf1e8ac3feca2da4fd3e`</span>,
                    }),
                }),
            ],
            <span class="hljs-attr">target</span>: <span class="hljs-string">'map'</span>,
            <span class="hljs-attr">view</span>: <span class="hljs-keyword">new</span> ol.<span class="hljs-title class_">View</span>({
                <span class="hljs-attr">zoom</span>: <span class="hljs-number">5</span>,
                <span class="hljs-attr">maxZoom</span>: <span class="hljs-number">17</span>,
                <span class="hljs-attr">minZoom</span>: <span class="hljs-number">1</span>,
                <span class="hljs-attr">projection</span>: projection,
                <span class="hljs-attr">center</span>: [<span class="hljs-number">116.406393</span>, <span class="hljs-number">39.909006</span>],
            }),
        })
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>æ•ˆæœå¦‚ä¸‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a43574a3cdc4763a027c2523cffc589~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buR5b-D55qu6JuL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769254303&amp;x-signature=RN3t1%2Fm7CT5YmRvO0DDmnUOqnHQ%3D" alt="image-20260117182119131" loading="lazy"/></p>
<h2 data-id="heading-4">ğŸ“ å¤šè¾¹å½¢é¢„è§ˆ</h2>
<p>â€‹	å‰é¢å®ç°æ€è·¯è¯´äº†,æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¤šè¾¹å½¢è£åˆ‡å›¾å±‚,æˆ‘è¿™é‡Œå‡†å¤‡äº†ä¸€ä¸ª</p>
<pre><code class="hljs language-js" lang="js">   <span class="hljs-keyword">const</span> polygonCoords =
                [
                    [
                        [
                            <span class="hljs-number">911245.7835522988</span>,
                            <span class="hljs-number">1672839.829528198</span>
                        ],
                        [
                            <span class="hljs-number">1517290.255658307</span>,
                            <span class="hljs-number">2962709.5078420187</span>
                        ],
                        [
                            <span class="hljs-number">2862581.9534774087</span>,
                            <span class="hljs-number">3011639.670051078</span>
                        ],
                        [
                            <span class="hljs-number">3492423.0665472616</span>,
                            <span class="hljs-number">2736407.507625122</span>
                        ],
                        [
                            <span class="hljs-number">3675871.934431684</span>,
                            <span class="hljs-number">2161478.101668681</span>
                        ],
                        [
                            <span class="hljs-number">3131640.2930412292</span>,
                            <span class="hljs-number">1647711.398473564</span>
                        ],
                        [
                            <span class="hljs-number">2141016.406465345</span>,
                            <span class="hljs-number">999386.7492035348</span>
                        ],
                        [
                            <span class="hljs-number">2581293.6893879604</span>,
                            <span class="hljs-number">63597.39695528569</span>
                        ],
                        [
                            <span class="hljs-number">2165476.2555166017</span>,
                            -<span class="hljs-number">523564.5495534199</span>
                        ],
                        [
                            <span class="hljs-number">3107180.4439899744</span>,
                            -<span class="hljs-number">982284.8202633462</span>
                        ],
                        [
                            <span class="hljs-number">2232740.8404075587</span>,
                            -<span class="hljs-number">1379842.3882119493</span>
                        ],
                        [
                            <span class="hljs-number">1609014.6896005198</span>,
                            -<span class="hljs-number">1300330.874622228</span>
                        ],
                        [
                            <span class="hljs-number">1040323.1991588091</span>,
                            -<span class="hljs-number">1104610.2257859926</span>
                        ],
                        [
                            <span class="hljs-number">471631.7087170966</span>,
                            -<span class="hljs-number">450169.3062398317</span>
                        ],
                        [
                            <span class="hljs-number">465516.74645428266</span>,
                            <span class="hljs-number">240969.23496312322</span>
                        ],
                        [
                            <span class="hljs-number">324872.6144095585</span>,
                            <span class="hljs-number">913758.9653376816</span>
                        ],
                        [
                            <span class="hljs-number">593930.953973379</span>,
                            <span class="hljs-number">1757804.2634439464</span>
                        ],
                        [
                            <span class="hljs-number">911245.7835522988</span>,
                            <span class="hljs-number">1672839.829528198</span>
                        ]
                    ]
                ]

</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f7410564aeb478e9827fd817cf71849~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buR5b-D55qu6JuL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769254303&amp;x-signature=%2Bkjd2JTkSK9KdsclpRGCcUj429U%3D" alt="image-20260117190344593" loading="lazy"/></p>
<p>åé¢å°±ä¼šç”¨è¿™ä¸ªå¤šè¾¹å½¢æ¥å¯¹å›¾å±‚è¿›è¡Œè£åˆ‡</p>
<h2 data-id="heading-5">ğŸ—ºï¸ æ·»åŠ ä¸€å¼ å½±åƒå›¾</h2>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-cn"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>openlayerå›¾å±‚è£åˆ‡<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-tag">html</span>,
        <span class="hljs-selector-tag">body</span>,
        <span class="hljs-selector-id">#map</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"map"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./ol.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">const</span> projection = ol.<span class="hljs-property">proj</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'EPSG:3857'</span>);
        <span class="hljs-keyword">const</span> projectionExtent = projection.<span class="hljs-title function_">getExtent</span>();
        <span class="hljs-keyword">const</span> size = ol.<span class="hljs-property">extent</span>.<span class="hljs-title function_">getWidth</span>(projectionExtent) / <span class="hljs-number">256</span>;
        <span class="hljs-keyword">const</span> resolutions = [];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> z = <span class="hljs-number">2</span>; z &lt; <span class="hljs-number">19</span>; ++z) {
            resolutions[z] = size / <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, z);
        }
        <span class="hljs-keyword">const</span> matrixIds = [<span class="hljs-string">'0'</span>,
            <span class="hljs-string">'1'</span>,
            <span class="hljs-string">'2'</span>,
            <span class="hljs-string">'3'</span>,
            <span class="hljs-string">'4'</span>,
            <span class="hljs-string">'5'</span>,
            <span class="hljs-string">'6'</span>,
            <span class="hljs-string">'7'</span>,
            <span class="hljs-string">'8'</span>,
            <span class="hljs-string">'9'</span>,
            <span class="hljs-string">'10'</span>,
            <span class="hljs-string">'11'</span>,
            <span class="hljs-string">'12'</span>,
            <span class="hljs-string">'13'</span>,
            <span class="hljs-string">'14'</span>,
            <span class="hljs-string">'15'</span>,
            <span class="hljs-string">'16'</span>,
            <span class="hljs-string">'17'</span>,
            <span class="hljs-string">'18'</span>]
        <span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> ol.<span class="hljs-title class_">Map</span>({
            <span class="hljs-attr">layers</span>: [
                <span class="hljs-comment">// çŸ¢é‡åº•å›¾</span>
                <span class="hljs-keyword">new</span> ol.<span class="hljs-property">layer</span>.<span class="hljs-title class_">Tile</span>({
                    <span class="hljs-attr">source</span>: <span class="hljs-keyword">new</span> ol.<span class="hljs-property">source</span>.<span class="hljs-title function_">XYZ</span>({
                        <span class="hljs-attr">url</span>: <span class="hljs-string">`https://t{0-7}.tianditu.gov.cn/DataServer?T=vec_w&amp;x={x}&amp;y={y}&amp;l={z}&amp;tk=2aedde694311cf1e8ac3feca2da4fd3e`</span>,
                    }),
                }),
                <span class="hljs-comment">// çŸ¢é‡æ³¨è®°</span>
                <span class="hljs-keyword">new</span> ol.<span class="hljs-property">layer</span>.<span class="hljs-title class_">Tile</span>({
                    <span class="hljs-attr">source</span>: <span class="hljs-keyword">new</span> ol.<span class="hljs-property">source</span>.<span class="hljs-title function_">XYZ</span>({
                        <span class="hljs-attr">url</span>: <span class="hljs-string">`https://t{0-7}.tianditu.gov.cn/DataServer?T=cva_w&amp;x={x}&amp;y={y}&amp;l={z}&amp;tk=2aedde694311cf1e8ac3feca2da4fd3e`</span>,
                    }),
                }),
            ],
            <span class="hljs-attr">target</span>: <span class="hljs-string">'map'</span>,
            <span class="hljs-attr">view</span>: <span class="hljs-keyword">new</span> ol.<span class="hljs-title class_">View</span>({
                <span class="hljs-attr">zoom</span>: <span class="hljs-number">5</span>,
                <span class="hljs-attr">maxZoom</span>: <span class="hljs-number">17</span>,
                <span class="hljs-attr">minZoom</span>: <span class="hljs-number">1</span>,
                <span class="hljs-attr">projection</span>: projection,
                <span class="hljs-attr">center</span>: [<span class="hljs-number">116.406393</span>, <span class="hljs-number">39.909006</span>],
            }),
        })
        <span class="hljs-keyword">const</span> wmtsLayer = <span class="hljs-keyword">new</span> ol.<span class="hljs-property">layer</span>.<span class="hljs-title class_">Tile</span>({
            <span class="hljs-attr">source</span>: <span class="hljs-keyword">new</span> ol.<span class="hljs-property">source</span>.<span class="hljs-title function_">WMTS</span>({
                <span class="hljs-attr">url</span>: <span class="hljs-string">`http://t{0-6}.tianditu.gov.cn/img_c/wmts?tk=2aedde694311cf1e8ac3feca2da4fd3e`</span>,
                <span class="hljs-attr">layer</span>: <span class="hljs-string">'img'</span>,
                <span class="hljs-attr">matrixSet</span>: <span class="hljs-string">'c'</span>,
                <span class="hljs-attr">style</span>: <span class="hljs-string">'default'</span>,
                <span class="hljs-attr">crossOrigin</span>: <span class="hljs-string">'anonymous'</span>,
                <span class="hljs-attr">format</span>: <span class="hljs-string">'tiles'</span>,
                <span class="hljs-attr">wrapX</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">crossOrigin</span>: <span class="hljs-string">'anonymous'</span>,
                <span class="hljs-attr">tileGrid</span>: <span class="hljs-keyword">new</span> ol.<span class="hljs-property">tilegrid</span>.<span class="hljs-title function_">WMTS</span>({
                    <span class="hljs-attr">origin</span>: ol.<span class="hljs-property">extent</span>.<span class="hljs-title function_">getTopLeft</span>(projectionExtent),
                    <span class="hljs-attr">resolutions</span>: resolutions,
                    <span class="hljs-attr">matrixIds</span>: matrixIds
                })
            })
        })
        map.<span class="hljs-title function_">addLayer</span>(wmtsLayer);
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>æ•ˆæœå¦‚ä¸‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd3566be6a6c415e81caa2a99d625fd9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buR5b-D55qu6JuL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769254303&amp;x-signature=f5pvYkkuGT3v4ZZpmDSqjln99w8%3D" alt="image-20260117191715249" loading="lazy"/></p>
<h2 data-id="heading-6">ğŸ”” ç›‘å¬å›¾å±‚äº‹ä»¶</h2>
<p>å‰é¢å·²ç»å°†è¿™ä¸ªå½±åƒå›¾æ·»åŠ åˆ°åœ°å›¾ä¸Šé¢å»äº†, æ¥ä¸‹æ¥å°±å¯ä»¥ç›‘å¬è¿™ä¸ªå›¾å±‚äº‹ä»¶,ç„¶åç”¨å¤šè¾¹å½¢å»è£åˆ‡è¿™å¼ å›¾å±‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// wmtsLayer å°±æ˜¯å‰é¢æ·»åŠ çš„å½±åƒå›¾</span>
wmtsLayer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'prerender'</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">evt</span>) {
    <span class="hljs-keyword">const</span> layerContent = ol.<span class="hljs-property">render</span>.<span class="hljs-title function_">getVectorContext</span>(evt)
    <span class="hljs-keyword">const</span> ctx = evt.<span class="hljs-property">context</span>;
    ctx.<span class="hljs-title function_">save</span>();
    layerContent.<span class="hljs-title function_">drawFeature</span>(polygon, polygonStyle)
    ctx.<span class="hljs-title function_">clip</span>();
});

<span class="hljs-comment">// æ¸²æŸ“åæ¢å¤ canvas çŠ¶æ€ï¼Œç§»é™¤è£åˆ‡</span>
wmtsLayer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'postrender'</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">evt</span>) {
    <span class="hljs-keyword">const</span> ctx = evt.<span class="hljs-property">context</span>;
    <span class="hljs-keyword">if</span> (ctx) ctx.<span class="hljs-title function_">restore</span>();
});
<span class="hljs-keyword">const</span> layer = map.<span class="hljs-title function_">addLayer</span>(wmtsLayer);
</code></pre>
<h2 data-id="heading-7">ğŸ“„ å®Œæ•´ä»£ç </h2>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-cn"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>openlayerå›¾å±‚è£åˆ‡<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-tag">html</span>,
        <span class="hljs-selector-tag">body</span>,
        <span class="hljs-selector-id">#map</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
        }

        <span class="hljs-comment">/* å³ä¸Šè§’å½¢çŠ¶æŒ‰é’®ç»„ */</span>
        <span class="hljs-selector-id">#shape-controls</span> {
            <span class="hljs-attribute">position</span>: fixed;
            <span class="hljs-attribute">top</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">right</span>: <span class="hljs-number">12px</span>;
            <span class="hljs-attribute">display</span>: flex;
            <span class="hljs-attribute">flex-direction</span>: column;
            <span class="hljs-attribute">gap</span>: <span class="hljs-number">8px</span>;
            <span class="hljs-attribute">z-index</span>: <span class="hljs-number">1000</span>;
        }

        <span class="hljs-selector-id">#shape-controls</span> <span class="hljs-selector-tag">button</span> {
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">6px</span> <span class="hljs-number">10px</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
            <span class="hljs-attribute">cursor</span>: pointer;
        }

        <span class="hljs-selector-id">#shape-controls</span> <span class="hljs-selector-tag">button</span><span class="hljs-selector-class">.active</span> {
            <span class="hljs-attribute">background</span>: <span class="hljs-number">#0b5ed7</span>;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"map"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"shape-controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn-polygon"</span>&gt;</span>æ·»åŠ å¤šè¾¹å½¢å½±åƒå›¾<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./ol.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">const</span> projection = ol.<span class="hljs-property">proj</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'EPSG:3857'</span>);
        <span class="hljs-keyword">const</span> projectionExtent = projection.<span class="hljs-title function_">getExtent</span>();
        <span class="hljs-keyword">const</span> size = ol.<span class="hljs-property">extent</span>.<span class="hljs-title function_">getWidth</span>(projectionExtent) / <span class="hljs-number">256</span>;
        <span class="hljs-keyword">const</span> resolutions = [];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> z = <span class="hljs-number">2</span>; z &lt; <span class="hljs-number">19</span>; ++z) {
            resolutions[z] = size / <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, z);
        }
        <span class="hljs-keyword">const</span> matrixIds = [<span class="hljs-string">'0'</span>,
            <span class="hljs-string">'1'</span>,
            <span class="hljs-string">'2'</span>,
            <span class="hljs-string">'3'</span>,
            <span class="hljs-string">'4'</span>,
            <span class="hljs-string">'5'</span>,
            <span class="hljs-string">'6'</span>,
            <span class="hljs-string">'7'</span>,
            <span class="hljs-string">'8'</span>,
            <span class="hljs-string">'9'</span>,
            <span class="hljs-string">'10'</span>,
            <span class="hljs-string">'11'</span>,
            <span class="hljs-string">'12'</span>,
            <span class="hljs-string">'13'</span>,
            <span class="hljs-string">'14'</span>,
            <span class="hljs-string">'15'</span>,
            <span class="hljs-string">'16'</span>,
            <span class="hljs-string">'17'</span>,
            <span class="hljs-string">'18'</span>]
        <span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> ol.<span class="hljs-title class_">Map</span>({
            <span class="hljs-attr">layers</span>: [
                <span class="hljs-comment">// çŸ¢é‡åº•å›¾</span>
                <span class="hljs-keyword">new</span> ol.<span class="hljs-property">layer</span>.<span class="hljs-title class_">Tile</span>({
                    <span class="hljs-attr">source</span>: <span class="hljs-keyword">new</span> ol.<span class="hljs-property">source</span>.<span class="hljs-title function_">XYZ</span>({
                        <span class="hljs-attr">url</span>: <span class="hljs-string">`https://t{0-7}.tianditu.gov.cn/DataServer?T=vec_w&amp;x={x}&amp;y={y}&amp;l={z}&amp;tk=2aedde694311cf1e8ac3feca2da4fd3e`</span>,
                    }),
                }),
                <span class="hljs-comment">// çŸ¢é‡æ³¨è®°</span>
                <span class="hljs-keyword">new</span> ol.<span class="hljs-property">layer</span>.<span class="hljs-title class_">Tile</span>({
                    <span class="hljs-attr">source</span>: <span class="hljs-keyword">new</span> ol.<span class="hljs-property">source</span>.<span class="hljs-title function_">XYZ</span>({
                        <span class="hljs-attr">url</span>: <span class="hljs-string">`https://t{0-7}.tianditu.gov.cn/DataServer?T=cva_w&amp;x={x}&amp;y={y}&amp;l={z}&amp;tk=2aedde694311cf1e8ac3feca2da4fd3e`</span>,
                    }),
                }),
            ],
            <span class="hljs-attr">target</span>: <span class="hljs-string">'map'</span>,
            <span class="hljs-attr">view</span>: <span class="hljs-keyword">new</span> ol.<span class="hljs-title class_">View</span>({
                <span class="hljs-attr">zoom</span>: <span class="hljs-number">5</span>,
                <span class="hljs-attr">maxZoom</span>: <span class="hljs-number">17</span>,
                <span class="hljs-attr">minZoom</span>: <span class="hljs-number">1</span>,
                <span class="hljs-attr">projection</span>: projection,
                <span class="hljs-attr">center</span>: [<span class="hljs-number">116.406393</span>, <span class="hljs-number">39.909006</span>],
            }),
        })

        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'btn-polygon'</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
            <span class="hljs-keyword">const</span> polygonCoords =
                [
                    [
                        [
                            <span class="hljs-number">911245.7835522988</span>,
                            <span class="hljs-number">1672839.829528198</span>
                        ],
                        [
                            <span class="hljs-number">1517290.255658307</span>,
                            <span class="hljs-number">2962709.5078420187</span>
                        ],
                        [
                            <span class="hljs-number">2862581.9534774087</span>,
                            <span class="hljs-number">3011639.670051078</span>
                        ],
                        [
                            <span class="hljs-number">3492423.0665472616</span>,
                            <span class="hljs-number">2736407.507625122</span>
                        ],
                        [
                            <span class="hljs-number">3675871.934431684</span>,
                            <span class="hljs-number">2161478.101668681</span>
                        ],
                        [
                            <span class="hljs-number">3131640.2930412292</span>,
                            <span class="hljs-number">1647711.398473564</span>
                        ],
                        [
                            <span class="hljs-number">2141016.406465345</span>,
                            <span class="hljs-number">999386.7492035348</span>
                        ],
                        [
                            <span class="hljs-number">2581293.6893879604</span>,
                            <span class="hljs-number">63597.39695528569</span>
                        ],
                        [
                            <span class="hljs-number">2165476.2555166017</span>,
                            -<span class="hljs-number">523564.5495534199</span>
                        ],
                        [
                            <span class="hljs-number">3107180.4439899744</span>,
                            -<span class="hljs-number">982284.8202633462</span>
                        ],
                        [
                            <span class="hljs-number">2232740.8404075587</span>,
                            -<span class="hljs-number">1379842.3882119493</span>
                        ],
                        [
                            <span class="hljs-number">1609014.6896005198</span>,
                            -<span class="hljs-number">1300330.874622228</span>
                        ],
                        [
                            <span class="hljs-number">1040323.1991588091</span>,
                            -<span class="hljs-number">1104610.2257859926</span>
                        ],
                        [
                            <span class="hljs-number">471631.7087170966</span>,
                            -<span class="hljs-number">450169.3062398317</span>
                        ],
                        [
                            <span class="hljs-number">465516.74645428266</span>,
                            <span class="hljs-number">240969.23496312322</span>
                        ],
                        [
                            <span class="hljs-number">324872.6144095585</span>,
                            <span class="hljs-number">913758.9653376816</span>
                        ],
                        [
                            <span class="hljs-number">593930.953973379</span>,
                            <span class="hljs-number">1757804.2634439464</span>
                        ],
                        [
                            <span class="hljs-number">911245.7835522988</span>,
                            <span class="hljs-number">1672839.829528198</span>
                        ]
                    ]
                ]

            <span class="hljs-keyword">const</span> wmtsLayer = <span class="hljs-keyword">new</span> ol.<span class="hljs-property">layer</span>.<span class="hljs-title class_">Tile</span>({
                <span class="hljs-attr">source</span>: <span class="hljs-keyword">new</span> ol.<span class="hljs-property">source</span>.<span class="hljs-title function_">WMTS</span>({
                    <span class="hljs-attr">url</span>: <span class="hljs-string">`http://t{0-6}.tianditu.gov.cn/img_c/wmts?tk=2aedde694311cf1e8ac3feca2da4fd3e`</span>,
                    <span class="hljs-attr">layer</span>: <span class="hljs-string">'img'</span>,
                    <span class="hljs-attr">matrixSet</span>: <span class="hljs-string">'c'</span>,
                    <span class="hljs-attr">style</span>: <span class="hljs-string">'default'</span>,
                    <span class="hljs-attr">crossOrigin</span>: <span class="hljs-string">'anonymous'</span>,
                    <span class="hljs-attr">format</span>: <span class="hljs-string">'tiles'</span>,
                    <span class="hljs-attr">wrapX</span>: <span class="hljs-literal">true</span>,
                    <span class="hljs-attr">crossOrigin</span>: <span class="hljs-string">'anonymous'</span>,
                    <span class="hljs-attr">tileGrid</span>: <span class="hljs-keyword">new</span> ol.<span class="hljs-property">tilegrid</span>.<span class="hljs-title function_">WMTS</span>({
                        <span class="hljs-attr">origin</span>: ol.<span class="hljs-property">extent</span>.<span class="hljs-title function_">getTopLeft</span>(projectionExtent),
                        <span class="hljs-attr">resolutions</span>: resolutions,
                        <span class="hljs-attr">matrixIds</span>: matrixIds
                    })
                })
            })
            <span class="hljs-keyword">const</span> polygon = <span class="hljs-keyword">new</span> ol.<span class="hljs-title class_">Feature</span>({
                <span class="hljs-attr">geometry</span>: <span class="hljs-keyword">new</span> ol.<span class="hljs-property">geom</span>.<span class="hljs-title class_">Polygon</span>(polygonCoords)
            })
            <span class="hljs-keyword">const</span> polygonStyle = <span class="hljs-keyword">new</span> ol.<span class="hljs-property">style</span>.<span class="hljs-title class_">Style</span>({
                <span class="hljs-attr">stroke</span>: <span class="hljs-keyword">new</span> ol.<span class="hljs-property">style</span>.<span class="hljs-title class_">Stroke</span>({
                    <span class="hljs-attr">color</span>: <span class="hljs-string">'rgba(255, 0, 0, 1)'</span>,
                    <span class="hljs-attr">width</span>: <span class="hljs-number">2</span>
                })
            });

            <span class="hljs-comment">// åœ¨æ¸²æŸ“å‰ä½¿ç”¨å¤šè¾¹å½¢å¯¹å›¾å±‚è¿›è¡Œè£åˆ‡ï¼ˆclipï¼‰</span>
            wmtsLayer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'prerender'</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">evt</span>) {
                <span class="hljs-keyword">const</span> layerContent = ol.<span class="hljs-property">render</span>.<span class="hljs-title function_">getVectorContext</span>(evt)
                <span class="hljs-keyword">const</span> ctx = evt.<span class="hljs-property">context</span>;
                ctx.<span class="hljs-title function_">save</span>();
                layerContent.<span class="hljs-title function_">drawFeature</span>(polygon, polygonStyle)
                ctx.<span class="hljs-title function_">clip</span>();
            });

            <span class="hljs-comment">// æ¸²æŸ“åæ¢å¤ canvas çŠ¶æ€ï¼Œç§»é™¤è£åˆ‡</span>
            wmtsLayer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'postrender'</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">evt</span>) {
                <span class="hljs-keyword">const</span> ctx = evt.<span class="hljs-property">context</span>;
                <span class="hljs-keyword">if</span> (ctx) ctx.<span class="hljs-title function_">restore</span>();
            });
            <span class="hljs-keyword">const</span> layer = map.<span class="hljs-title function_">addLayer</span>(wmtsLayer);
        });
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸš€ AIå…¨æ ˆé¡¹ç›®å®æˆ˜ Day 3ï¼šReact ç©å®¶çš„åç«¯æ–°å¤§é™† â€”â€” NestJS æ·±åº¦ç¡¬æ ¸æŒ‡å—]]></title>    <link>https://juejin.cn/post/7595808703074500634</link>    <guid>https://juejin.cn/post/7595808703074500634</guid>    <pubDate>2026-01-17T08:22:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595808703074500634" data-draft-id="7595847940621467698" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸš€ AIå…¨æ ˆé¡¹ç›®å®æˆ˜ Day 3ï¼šReact ç©å®¶çš„åç«¯æ–°å¤§é™† â€”â€” NestJS æ·±åº¦ç¡¬æ ¸æŒ‡å—"/> <meta itemprop="keywords" content="NestJS,å…¨æ ˆ"/> <meta itemprop="datePublished" content="2026-01-17T08:22:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¥ç§˜çš„çŒªå¤´"/> <meta itemprop="url" content="https://juejin.cn/user/793223472877051"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸš€ AIå…¨æ ˆé¡¹ç›®å®æˆ˜ Day 3ï¼šReact ç©å®¶çš„åç«¯æ–°å¤§é™† â€”â€” NestJS æ·±åº¦ç¡¬æ ¸æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/793223472877051/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¥ç§˜çš„çŒªå¤´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T08:22:24.000Z" title="Sat Jan 17 2026 08:22:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å“ˆå–½ï¼Œæ˜é‡‘çš„å„ä½å…¨æ ˆç»ƒä¹ ç”Ÿä»¬ï¼æˆ‘æ˜¯ä½ ä»¬çš„ç¥ç§˜çŒªå¤´å¯¼å¸ˆã€‚æ¬¢è¿æ¥åˆ° AI å…¨æ ˆé¡¹ç›®å®æˆ˜çš„ç¬¬ä¸‰å¤©ï¼ğŸ‘‹</p>
<p>åœ¨<a href="https://juejin.cn/column/7595043440520413190" target="_blank" title="https://juejin.cn/column/7595043440520413190">ä¸Šä¸€ç¯‡æ–‡ç« </a>ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½è¿˜åœ¨çº ç»“å‰ç«¯é¡µé¢çš„åƒç´ çœ¼ï¼Œæˆ–è€…ç”¨åŸç”Ÿçš„ Node.js æ‰‹æ“ç®€å•çš„æœåŠ¡ã€‚ä½†ä»Šå¤©ï¼Œæˆ‘ä»¬è¦è¿›å…¥ä¸€ä¸ªæ›´åŠ æ·±é‚ƒã€æ›´åŠ è¿·äººï¼Œä¹Ÿç»å¯¹ä¼šè®© React å¼€å‘è€…æ„Ÿåˆ°æ— æ¯”äº²åˆ‡çš„é¢†åŸŸâ€”â€”<strong>NestJS</strong>ã€‚</p>
<p>å¦‚æœä½ è§‰å¾— Express åƒæ˜¯ä¸€ä¸ªâ€œåªæœ‰æ¯›å¯æˆ¿â€çš„è£…ä¿®ç°åœºï¼Œä»€ä¹ˆéƒ½è¦è‡ªå·±é€ ï¼›é‚£ä¹ˆ NestJS å°±æ˜¯ç²¾è£…ä¿®çš„â€œè±ªå®…â€ï¼Œæ°´ç”µç…¤æ°”ï¼ˆè·¯ç”±ã€ä¾èµ–æ³¨å…¥ã€æ¨¡å—åŒ–ï¼‰ä¸€åº”ä¿±å…¨ï¼Œä½ åªéœ€è¦æ‹åŒ…å…¥ä½ï¼Œä¸“æ³¨äºä½ çš„ä¸šåŠ¡é€»è¾‘å®¶å…·æ‘†æ”¾ã€‚</p>
<p>å‡†å¤‡å¥½äº†å—ï¼Ÿæˆ‘ä»¬è¦å¼€å§‹ä¸€åœºä»â€œå‰ç«¯åˆ‡å›¾ä»”â€åˆ°â€œä¼ä¸šçº§åç«¯æ¶æ„å¸ˆâ€çš„åä¸½è½¬èº«äº†ï¼ğŸï¸</p>
<hr/>
<h2 data-id="heading-0">ğŸ§ ä¸ºä»€ä¹ˆæ˜¯ NestJSï¼Ÿ</h2>
<p>å¾ˆå¤š React å¼€å‘è€…ç¬¬ä¸€æ¬¡çœ‹ NestJS çš„ä»£ç æ—¶ï¼Œéƒ½ä¼šæƒŠå‘¼ï¼šâ€œè¿™å‘³é“â€¦â€¦å¤ªç†Ÿæ‚‰äº†ï¼â€</p>
<h3 data-id="heading-1">1. æ¨¡å—åŒ–æ¶æ„ (Modular) ğŸ§©</h3>
<p>React ç”¨ Componentï¼ˆç»„ä»¶ï¼‰æ¥æ‹¼å‡‘ UIï¼ŒNestJS ç”¨ <strong>Moduleï¼ˆæ¨¡å—ï¼‰</strong> æ¥æ‹¼å‡‘åç«¯æœåŠ¡ã€‚ä½ çš„ä»£ç ä¸å†æ˜¯æ•£è½åœ¨æ–‡ä»¶å¤¹é‡Œçš„æ„å¤§åˆ©é¢æ¡ï¼Œè€Œæ˜¯äº•äº•æœ‰æ¡çš„ç§¯æœ¨ã€‚</p>
<h3 data-id="heading-2">2. ä¾èµ–æ³¨å…¥ (Dependency Injection) ğŸ’‰</h3>
<p>å¬èµ·æ¥å¾ˆå“äººï¼Ÿå…¶å®å°±æ˜¯â€œé¥­æ¥å¼ å£â€ã€‚ä½ éœ€è¦æ•°æ®åº“è¿æ¥ï¼Ÿä¸éœ€è¦ä½ è‡ªå·±å» <code>new Database()</code>ï¼Œåªéœ€è¦åœ¨æ„é€ å‡½æ•°é‡Œå–Šä¸€å£°ï¼ŒNestJS çš„åº•å±‚å®¹å™¨å°±ä¼šæŠŠæ•°æ®åº“å®ä¾‹â€œæ³¨å…¥â€ç»™ä½ ã€‚è¿™å¤§å¤§é™ä½äº†ä»£ç çš„è€¦åˆåº¦ã€‚</p>
<h3 data-id="heading-3">3. TypeScript çš„äº²å„¿å­ ğŸ“˜</h3>
<p>NestJS åŸç”Ÿå°±æ˜¯ç”¨ TypeScript å†™çš„ã€‚å¯¹äºæˆ‘ä»¬è¿™äº›ä¹ æƒ¯äº†ç±»å‹çº¦æŸã€å—å¤Ÿäº† <code>undefined is not a function</code> çš„ç°ä»£å‰ç«¯äººæ¥è¯´ï¼Œè¿™ç®€ç›´å°±æ˜¯ç¦éŸ³ã€‚</p>
<h3 data-id="heading-4">4. MVC æ¨¡å¼çš„å®Œç¾è½åœ° ğŸ—ï¸</h3>
<ul>
<li><strong>M (Model)</strong>: æ•°æ®å±‚ï¼ˆService/Databaseï¼‰</li>
<li><strong>V (View)</strong>: è§†å›¾å±‚ï¼ˆAPI æ¥å£è¿”å›çš„ JSONï¼‰</li>
<li><strong>C (Controller)</strong>: æ§åˆ¶å±‚ï¼ˆè·¯ç”±åˆ†å‘ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-5">ğŸ› ï¸ ç¬¬ä¸€æ­¥ï¼šèµ·é«˜æ¥¼ â€”â€” é¡¹ç›®åˆ›å»º</h2>
<p>è¯ä¸å¤šè¯´ï¼Œå…ˆè·‘èµ·æ¥ã€‚æ‰“å¼€ä½ çš„ç»ˆç«¯ï¼ˆTerminalï¼‰ï¼Œæˆ‘ä»¬å…ˆè£…ä¸Š NestJS çš„è„šæ‰‹æ¶ã€‚è¿™å°±åƒæ˜¯ä¹°äº†ä¸€æŠŠä¸‡èƒ½é’¥åŒ™ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£… NestJS CLI å…¨å±€å·¥å…·</span>
npm i -g @nestjs/cli

<span class="hljs-comment"># æ–°å»ºé¡¹ç›®ï¼Œæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªå« nest-test-demo çš„é¡¹ç›®</span>
nest new nest-test-demo
</code></pre>
<p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒCLI ä¼šé—®ä½ ç”¨ npm è¿˜æ˜¯ yarnï¼Œé€‰ä½ å–œæ¬¢çš„å°±å¥½ã€‚ç­‰è¿›åº¦æ¡è·‘å®Œï¼Œä¸€ä¸ªä¼ä¸šçº§æ¶æ„çš„åç«¯é¡¹ç›®å°±å·²ç»èººåœ¨ä½ çš„ç¡¬ç›˜é‡Œäº†ã€‚</p>
<hr/>
<h2 data-id="heading-6">ğŸšª ç¬¬äºŒæ­¥ï¼šå©å¼€çœŸç†ä¹‹é—¨ â€”â€” main.ts å…¥å£åˆ†æ</h2>
<p>æˆ‘ä»¬å…ˆä¸çœ‹åˆ«çš„ï¼Œç›´æ¥å†²è¿› <code>main.ts</code>ã€‚è¿™é‡Œæ˜¯æ•´ä¸ªç¨‹åºçš„<strong>å…¥å£</strong>ï¼Œæ¢¦å¼€å§‹çš„åœ°æ–¹ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">NestFactory</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/core'</span>;
<span class="hljs-comment">// æ¨¡å—åŒ–</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppModule</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.module'</span>;
<span class="hljs-keyword">import</span> { config } <span class="hljs-keyword">from</span> <span class="hljs-string">'dotenv'</span>;
<span class="hljs-title function_">config</span>();

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">bootstrap</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// server app</span>
  <span class="hljs-comment">// å·¥å‚æ¨¡å¼ ä¸‰æ˜Ÿ æ‰‹æœºï¼Œæ±½è½¦ï¼Œæ–¹ä¾¿é¢</span>
  <span class="hljs-comment">// NestFactory nest å·¥å‚</span>
  <span class="hljs-comment">// æ ¹æ¨¡å‹</span>
  <span class="hljs-keyword">const</span> app = <span class="hljs-keyword">await</span> <span class="hljs-title class_">NestFactory</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">AppModule</span>); <span class="hljs-comment">// L12</span>
  <span class="hljs-comment">// 3000 node è¿›ç¨‹å¯¹è±¡process</span>
  <span class="hljs-comment">// ç©ºå€¼åˆå¹¶è¿ç®—ç¬¦ ES2020 2015æ˜¯ES6æ‰€ä»¥2020æ˜¯ES11</span>
  <span class="hljs-keyword">await</span> app.<span class="hljs-title function_">listen</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">PORT</span> ?? <span class="hljs-number">3000</span>); <span class="hljs-comment">// L15</span>
}
<span class="hljs-title function_">bootstrap</span>();
</code></pre>
<h3 data-id="heading-7">ğŸ­ çŸ¥è¯†ç‚¹ 1ï¼šå·¥å‚æ¨¡å¼ (Factory Pattern)</h3>
<p>è¯·çœ‹ç¬¬ 12 è¡Œï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> app = <span class="hljs-keyword">await</span> <span class="hljs-title class_">NestFactory</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">AppModule</span>);
</code></pre>
<p>è¿™é‡Œç”¨åˆ°äº†ç»å…¸çš„è®¾è®¡æ¨¡å¼â€”â€”<strong>å·¥å‚æ¨¡å¼</strong>ã€‚
æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æƒ³è¦ä¸€å°ä¸‰æ˜Ÿæ‰‹æœºã€‚ä½ ä¸éœ€è¦è‡ªå·±å»é‡‡è´­å±å¹•ã€èŠ¯ç‰‡ã€ç”µæ± ç„¶åè‡ªå·±ç»„è£…ï¼ˆé‚£æ˜¯ <code>new App()</code> åšçš„äº‹ï¼‰ã€‚ä½ åªéœ€è¦æ‰¾åˆ°â€œä¸‰æ˜Ÿå·¥å‚â€ (<code>NestFactory</code>)ï¼Œå‘Šè¯‰å®ƒï¼šâ€œç»™æˆ‘é€ ä¸€å°æ‰‹æœºï¼â€ (<code>create</code>)ï¼Œå¹¶ä¸”æŠŠè®¾è®¡å›¾çº¸ (<code>AppModule</code>) ç»™å®ƒã€‚
<code>NestFactory</code> å°±ä¼šå¸®ä½ æŠŠåº•å±‚çš„ Express å®ä¾‹ã€è·¯ç”±ç³»ç»Ÿã€å¼‚å¸¸è¿‡æ»¤å™¨ç­‰ç­‰å…¨éƒ¨ç»„è£…å¥½ï¼Œç›´æ¥è¿”ç»™ä½ ä¸€ä¸ªå¯ä»¥ç›´æ¥ä½¿ç”¨çš„ <code>app</code> å¯¹è±¡ã€‚è¿™å°±æ˜¯å°è£…çš„è‰ºæœ¯ã€‚</p>
<h3 data-id="heading-8">â“ çŸ¥è¯†ç‚¹ 2ï¼šç©ºå€¼åˆå¹¶è¿ç®—ç¬¦ (Nullish Coalescing)</h3>
<p>å†çœ‹ç¬¬ 15 è¡Œï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">await</span> app.<span class="hljs-title function_">listen</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">PORT</span> ?? <span class="hljs-number">3000</span>);
</code></pre>
<p>è¿™é‡Œæœ‰ä¸ªå¯çˆ±çš„å°ç¬¦å· <code>??</code>ã€‚è¿™æ˜¯ ES2020 (ES11) å¼•å…¥çš„æ–°ç‰¹æ€§ï¼Œå«<strong>ç©ºå€¼åˆå¹¶è¿ç®—ç¬¦</strong>ã€‚</p>
<ul>
<li><strong>ä»¥å‰æˆ‘ä»¬æ€ä¹ˆå†™ï¼Ÿ</strong> <code>process.env.PORT || 3000</code>ã€‚ä½†è¿™æœ‰ä¸ª bugï¼Œå¦‚æœç«¯å£çœŸçš„æ˜¯ <code>0</code>ï¼ˆè™½ç„¶å¾ˆå°‘è§ï¼‰ï¼Œ<code>||</code> ä¼šæŠŠå®ƒå½“æˆ falseï¼Œå¼ºè¡Œå˜æˆ 3000ã€‚</li>
<li><strong>ç°åœ¨ <code>??</code> æ€ä¹ˆåšï¼Ÿ</strong> åªæœ‰å½“å·¦ä¾§æ˜¯ <code>null</code> æˆ– <code>undefined</code> æ—¶ï¼Œæ‰ä¼šä½¿ç”¨å³ä¾§çš„å€¼ã€‚å¦‚æœå·¦ä¾§æ˜¯ <code>0</code> æˆ– <code>false</code>ï¼Œå®ƒä¼šç…§å•å…¨æ”¶ã€‚è¿™å°±æ˜¯ä¸¥è°¨ï¼</li>
</ul>
<hr/>
<h2 data-id="heading-9">ğŸ§  ç¬¬ä¸‰æ­¥ï¼šå¤§è„‘ä¸­æ¢ â€”â€” App.Module</h2>
<p>å¦‚æœè¯´ <code>main.ts</code> æ˜¯å¤§é—¨ï¼Œé‚£ <code>app.module.ts</code> å°±æ˜¯<strong>æ€»æŒ‡æŒ¥éƒ¨</strong>ã€‚NestJS æ˜¯æ¨¡å—åŒ–çš„ï¼Œè€Œ <code>AppModule</code> æ˜¯æ‰€æœ‰æ¨¡å—çš„æ ¹ï¼ˆRoot Moduleï¼‰ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Module</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppController</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.controller'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.service'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">TodosModule</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./todos/todos.module'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">DatabaseModule</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./database/database.module'</span>;
<span class="hljs-comment">// mvc è®¾è®¡æ¨¡å¼ æ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨</span>
<span class="hljs-comment">// ä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ªç±»</span>
<span class="hljs-comment">// è£…é¥°å™¨æ¨¡å¼ è®©AppModuleç±»æˆä¸ºä¸€ä¸ªæ¨¡å—</span>
<span class="hljs-meta">@Module</span>({
  <span class="hljs-attr">imports</span>: [
    <span class="hljs-title class_">TodosModule</span>,
    <span class="hljs-title class_">DatabaseModule</span>
  ],
  <span class="hljs-comment">// åç«¯è·¯ç”± æ§åˆ¶é€»è¾‘ å‚æ•°æ ¡éªŒ é€»è¾‘å¤„ç†</span>
  <span class="hljs-attr">controllers</span>: [<span class="hljs-title class_">AppController</span>],
  <span class="hljs-comment">// åç«¯æœåŠ¡ ä¸šåŠ¡é€»è¾‘ æ•°æ®åº“æ“ä½œ</span>
  <span class="hljs-comment">// æ•°æ®</span>
  <span class="hljs-attr">providers</span>: [<span class="hljs-title class_">AppService</span>],
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppModule</span> {}
</code></pre>
<h3 data-id="heading-10">ğŸ€ çŸ¥è¯†ç‚¹ 3ï¼šè£…é¥°å™¨ (Decorators)</h3>
<p>çœ‹åˆ°é‚£ä¸ª <code>@Module</code> äº†å—ï¼Ÿè¿™å°±æ˜¯<strong>è£…é¥°å™¨</strong>ã€‚
åœ¨ ES6 çš„ç±»ï¼ˆClassï¼‰ä¸Šé¢åŠ ä¸ª <code>@</code>ï¼Œå°±åƒç»™è¿™ä¸ªç±»è´´äº†ä¸ªé­”æ³•æ ‡ç­¾ã€‚
<code>AppModule</code> æœ¬èº«åªæ˜¯ä¸ªç©ºç±»ï¼ˆClassï¼‰ï¼Œå•¥ä¹Ÿä¸ä¼šã€‚ä½†æ˜¯è´´ä¸Š <code>@Module</code> åï¼ŒNestJS å°±çŸ¥é“ï¼šâ€œå“¦ï¼è¿™æ˜¯ä¸€ä¸ªæ¨¡å—ï¼â€</p>
<p><code>@Module</code> æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢æœ‰ä¸‰ä¸ªæ ¸å¿ƒå±æ€§ï¼š</p>
<ol>
<li><strong>imports</strong>: <strong>â€œæˆ‘éœ€è¦è°å¸®å¿™ï¼Ÿâ€</strong> è¿™é‡Œå¼•å…¥äº† <code>TodosModule</code> å’Œ <code>DatabaseModule</code>ã€‚è¯´æ˜ <code>AppModule</code> è¿™ä¸ªè€æ¿å¯ä»¥è°ƒç”¨è¿™ä¸¤ä¸ªéƒ¨é—¨çš„èƒ½åŠ›ã€‚</li>
<li><strong>controllers</strong>: <strong>â€œè°è´Ÿè´£æ¥å¾…å®¢äººï¼Ÿâ€</strong> <code>AppController</code> æ˜¯é—¨é¢ï¼Œè´Ÿè´£å¤„ç† HTTP è¯·æ±‚ã€‚</li>
<li><strong>providers</strong>: <strong>â€œè°è´Ÿè´£å¹²æ´»ï¼Ÿâ€</strong> <code>AppService</code> æ˜¯è‹¦åŠ›ï¼Œè´Ÿè´£å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚</li>
</ol>
<p>è¿™ä¸‰è€…å…±åŒæ„æˆäº† NestJS çš„ MVC æ¶æ„åŸºçŸ³ã€‚</p>
<hr/>
<h2 data-id="heading-11">ğŸ—£ï¸ ç¬¬å››æ­¥ï¼šé—¨é¢æ‹…å½“ â€”â€” Controller (æ§åˆ¶å™¨)</h2>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹è´Ÿè´£æ¥å¾…çš„ <code>AppController</code>ã€‚å®ƒçš„èŒè´£éå¸¸æ˜ç¡®ï¼š<strong>ç›‘å¬è·¯ç”±ï¼Œæ¥æ”¶å‚æ•°ï¼Œæ ¡éªŒæ•°æ®ï¼Œç„¶åæŠŠæ´»å„¿æ´¾ç»™ Service</strong>ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Controller</span>,<span class="hljs-title class_">Get</span>,<span class="hljs-title class_">Post</span>,<span class="hljs-title class_">Body</span>,<span class="hljs-title class_">Inject</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.service'</span>;

<span class="hljs-meta">@Controller</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppController</span> {
  <span class="hljs-comment">// service å®ä¾‹</span>
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">
    <span class="hljs-meta">@Inject</span>(<span class="hljs-string">'PG_CONNECTION'</span>) <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> db: <span class="hljs-built_in">any</span>, <span class="hljs-comment">// L8</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> appService: AppService <span class="hljs-comment">// L9</span>
  </span>){}

  <span class="hljs-meta">@Get</span>()
  <span class="hljs-title function_">getHello</span>(): <span class="hljs-built_in">string</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">appService</span>.<span class="hljs-title function_">getHello</span>();
  }

  <span class="hljs-comment">// ... çœç•¥éƒ¨åˆ†ä»£ç </span>

  <span class="hljs-meta">@Post</span>(<span class="hljs-string">'login'</span>)
  <span class="hljs-title function_">login</span>(<span class="hljs-params"><span class="hljs-meta">@Body</span>() body: {username: <span class="hljs-built_in">string</span>, password: <span class="hljs-built_in">string</span>}</span>){
    <span class="hljs-keyword">const</span> {username,password} = body;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(username,password);
    <span class="hljs-comment">// ... å‚æ•°æ ¡éªŒé€»è¾‘</span>
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">appService</span>.<span class="hljs-title function_">handleLogin</span>(username,password);
  }
}
</code></pre>
<h3 data-id="heading-12">ğŸ’‰ çŸ¥è¯†ç‚¹ 4ï¼šæ„é€ å‡½æ•°æ³¨å…¥ (Constructor Injection) â€”â€” æ ¸å¿ƒéš¾ç‚¹ï¼</h3>
<p>è¯·å¤§å®¶æŠŠç›®å…‰èšç„¦åœ¨ç¬¬ 7-10 è¡Œçš„ <code>constructor</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript">  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">
    <span class="hljs-meta">@Inject</span>(<span class="hljs-string">'PG_CONNECTION'</span>) <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> db: <span class="hljs-built_in">any</span>,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> appService: AppService
  </span>){}
</code></pre>
<p>è¿™é‡Œæœ‰ä¸¤ä¸ªéå¸¸ç¡¬æ ¸çš„çŸ¥è¯†ç‚¹ï¼š</p>
<ol>
<li>
<p><strong>TypeScript çš„å‚æ•°å±æ€§ (Parameter Properties)</strong>ï¼š
ä½ çœ‹åˆ° <code>private readonly appService: AppService</code> äº†å—ï¼Ÿ
åœ¨æ™®é€šçš„ JS ç±»é‡Œï¼Œä½ éœ€è¦å…ˆå®šä¹‰ <code>this.appService</code>ï¼Œç„¶ååœ¨æ„é€ å‡½æ•°é‡Œ <code>this.appService = appService</code>ã€‚
ä½†åœ¨ TS é‡Œï¼Œåªè¦ä½ åœ¨æ„é€ å‡½æ•°å‚æ•°å‰åŠ ä¸Š <code>private</code>ã€<code>public</code> æˆ– <code>readonly</code>ï¼ŒTS å°±ä¼šè‡ªåŠ¨å¸®ä½ æŠŠè¿™ä¸ªå‚æ•°å˜æˆç±»çš„å±æ€§ï¼Œå¹¶è‡ªåŠ¨èµ‹å€¼ï¼<strong>ä¸€è¡Œä»£ç é¡¶ä¸‰è¡Œï¼Œç®€æ´å°±æ˜¯æ­£ä¹‰ã€‚</strong></p>
</li>
<li>
<p><strong>ä¾èµ–æ³¨å…¥ (DI) çš„çœŸè°›</strong>ï¼š
æˆ‘ä»¬æ²¡æœ‰å†™ <code>new AppService()</code>ã€‚æˆ‘ä»¬åªæ˜¯å£°æ˜äº†ç±»å‹ <code>: AppService</code>ã€‚NestJS çš„æ‰«ææœºåˆ¶å‘ç°ä½ éœ€è¦ <code>AppService</code>ï¼Œå®ƒå°±ä¼šå»å®¹å™¨é‡Œæ‰¾ï¼Œæ‰¾åˆ°ä¹‹å‰åœ¨ <code>AppModule</code> é‡Œæ³¨å†Œè¿‡çš„é‚£ä¸ª <code>AppService</code> å®ä¾‹ï¼Œç›´æ¥å¡ç»™ä½ ã€‚
è¿™å°±å«â€œé›‡ä½£å…µâ€æ¨¡å¼ï¼šè°éœ€è¦è°æ‹›å‹Ÿï¼Œä½†æ‹›å‹Ÿçš„åŠ¨ä½œç”±ç³»ç»Ÿè‡ªåŠ¨å®Œæˆã€‚</p>
<p>è‡³äºé‚£ä¸ª <code>@Inject('PG_CONNECTION')</code>ï¼Œæˆ‘ä»¬ç¨åè®²æ•°æ®åº“æ¨¡å—æ—¶ä¼šæ­æ™“å®ƒçš„ç¥ç§˜é¢çº±ï¼ğŸ­</p>
</li>
</ol>
<h3 data-id="heading-13">ğŸš¦ çŸ¥è¯†ç‚¹ 5ï¼šHTTP åŠ¨è¯ä¸å‚æ•°è£…é¥°å™¨</h3>
<ul>
<li>
<p><strong>@Controller()</strong>: å¯ä»¥ä¼ å‚ï¼Œæ¯”å¦‚ <code>@Controller('users')</code>ï¼Œé‚£ä¸‹é¢çš„è·¯ç”±å‰ç¼€å°±æ˜¯ <code>/users</code>ã€‚è¿™é‡Œæ²¡ä¼ ï¼Œå°±æ˜¯æ ¹è·¯å¾„ã€‚</p>
</li>
<li>
<p><strong>@Get()</strong>: å¤„ç† GET è¯·æ±‚ã€‚</p>
</li>
<li>
<p><strong>@Post('login')</strong>: å¤„ç† POST è¯·æ±‚ï¼Œè·¯å¾„æ˜¯ <code>/login</code>ã€‚</p>
</li>
<li>
<p><strong>@Body()</strong>: è¿™æ˜¯ä¸€ä¸ª<strong>å‚æ•°è£…é¥°å™¨</strong>ã€‚å®ƒä¸“é—¨ç”¨æ¥æå– HTTP è¯·æ±‚ä½“ï¼ˆBodyï¼‰é‡Œçš„æ•°æ®ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">login</span>(<span class="hljs-meta">@Body</span>() <span class="hljs-attr">body</span>: {<span class="hljs-attr">username</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">password</span>: <span class="hljs-built_in">string</span>})
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬è¿˜é¡ºæ‰‹ç»™ <code>body</code> åŠ äº†ä¸ª TS ç±»å‹å®šä¹‰ã€‚åœ¨å‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è§£æ„ <code>username</code> å’Œ <code>password</code> è¿›è¡Œæ ¡éªŒã€‚è™½ç„¶è¿™é‡Œæˆ‘ä»¬æ˜¯æ‰‹åŠ¨å†™ <code>if (!username)</code> æ¥æ ¡éªŒçš„ï¼Œä½†åœ¨æ›´é«˜çº§çš„ç”¨æ³•é‡Œï¼Œæˆ‘ä»¬å¯ä»¥é…åˆ DTO (Data Transfer Object) å’Œ <code>class-validator</code> æ¥è‡ªåŠ¨æ ¡éªŒã€‚</p>
</li>
</ul>
<p>Controller åšå®Œæ ¡éªŒåï¼Œæœ€åä¸€è¡Œ <code>return this.appService.handleLogin(...)</code>ï¼Œå°±æŠŠå…·ä½“çš„ç™»å½•é€»è¾‘ç”©é”…ç»™ Service äº†ã€‚è¿™å°±å«<strong>èŒè´£åˆ†ç¦»</strong>ï¼</p>
<hr/>
<h2 data-id="heading-14">ğŸ‘¨â€ğŸ³ ç¬¬äº”æ­¥ï¼šå¹•åå¤§å¨ â€”â€” Service (æœåŠ¡)</h2>
<p>Controller åªæ˜¯æœåŠ¡å‘˜ï¼Œæ‹¿ç€èœå•ï¼ˆå‚æ•°ï¼‰è¿›å¨æˆ¿ã€‚<code>AppService</code> æ‰æ˜¯çœŸæ­£ç‚’èœçš„å¤§å¨ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä¾èµ–æ³¨å…¥</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>
<span class="hljs-comment">// controller æœåŠ¡äºè·¯ç”±ï¼Œ æ ‘æ ¹</span>
<span class="hljs-comment">// service åº—é‡Œçš„å¨å¸ˆ Injectable è¢«æ³¨å…¥ </span>
<span class="hljs-meta">@Injectable</span>() 
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppService</span> {
  <span class="hljs-title function_">getHello</span>(): <span class="hljs-built_in">string</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'ä½ å¥½yeah'</span>;
  }
  <span class="hljs-comment">// ...</span>
  <span class="hljs-title function_">handleLogin</span>(<span class="hljs-params">username: <span class="hljs-built_in">string</span>,password: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-keyword">if</span>(username === <span class="hljs-string">"admin"</span> &amp;&amp; password === <span class="hljs-string">"123456"</span>){
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">code</span>: <span class="hljs-number">200</span>, <span class="hljs-attr">msg</span>: <span class="hljs-string">'ç™»å½•æˆåŠŸ'</span> };
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> { <span class="hljs-attr">code</span>: <span class="hljs-number">400</span>, <span class="hljs-attr">msg</span>: <span class="hljs-string">'ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯'</span> };
  }
}
</code></pre>
<h3 data-id="heading-15">ğŸ·ï¸ çŸ¥è¯†ç‚¹ 6ï¼š@Injectable()</h3>
<p><code>@Injectable()</code> é¡¾åæ€ä¹‰ï¼š<strong>å¯è¢«æ³¨å…¥çš„</strong>ã€‚
è¿™ä¸ªè£…é¥°å™¨å‘Šè¯‰ NestJSï¼šâ€œå˜¿ï¼Œæˆ‘æ˜¯ä¸ªæœ‰ç”¨çš„ç±»ï¼Œæˆ‘å¯ä»¥è¢«æ³¨å…¥åˆ°åˆ«çš„ Controller æˆ–è€…å…¶ä»– Service é‡Œå»ã€‚â€
æ‰€æœ‰çš„ä¸šåŠ¡é€»è¾‘ï¼ˆBusiness Logicï¼‰ï¼Œæ¯”å¦‚è®¡ç®—ã€åˆ¤æ–­å¯†ç ã€å¤æ‚çš„ç®—æ³•ï¼Œéƒ½åº”è¯¥å†™åœ¨è¿™é‡Œã€‚Controller åº”è¯¥ä¿æŒæ¸…çˆ½ï¼Œåªè´Ÿè´£æ”¶å‘ã€‚</p>
<hr/>
<h2 data-id="heading-16">ğŸ§± ç¬¬å…­æ­¥ï¼šä¸¾ä¸€åä¸‰ â€”â€” Feature Module (Todos ä¸šåŠ¡æ¨¡å—)</h2>
<p>çœ‹å®Œäº† <code>AppModule</code>ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•æ‰©å±•ä¸šåŠ¡ã€‚æ¯”å¦‚æˆ‘ä»¬è¦å†™ä¸€ä¸ªå¾…åŠäº‹é¡¹ï¼ˆTodoï¼‰çš„åŠŸèƒ½ã€‚NestJS æ¨èæˆ‘ä»¬å°†åŠŸèƒ½æŒ‰æ¨¡å—æ‹†åˆ†ã€‚</p>
<h3 data-id="heading-17">1. Todos Module</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Module</span>({
    <span class="hljs-attr">controllers</span>: [<span class="hljs-title class_">TodosController</span>],
    <span class="hljs-attr">providers</span>: [<span class="hljs-title class_">TodosService</span>],
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TodosModule</span> {}
</code></pre>
<p>ç»“æ„å’Œ <code>AppModule</code> ä¸€æ¨¡ä¸€æ ·ï¼è¿™å°±æ˜¯æ¨¡å—åŒ–çš„ç¾å¦™ä¹‹å¤„â€”â€”<strong>ä¸€è‡´æ€§</strong>ã€‚æ— è®ºä½ çš„é¡¹ç›®å¤šå¤§ï¼Œæ¯ä¸ªæ¨¡å—çš„ç»“æ„éƒ½æ˜¯å¯é¢„æµ‹çš„ã€‚</p>
<h3 data-id="heading-18">2. Todos Controller (è§£é”æ–°æŠ€èƒ½)</h3>
<p>åœ¨ <code>todos.controller.ts</code> é‡Œï¼Œæˆ‘ä»¬è§£é”äº†å‡ ä¸ªæ–°è£…é¥°å™¨ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Controller</span>, <span class="hljs-title class_">Get</span>, <span class="hljs-title class_">Post</span>, <span class="hljs-title class_">Body</span>, <span class="hljs-title class_">Delete</span>, <span class="hljs-title class_">Param</span>, <span class="hljs-title class_">ParseIntPipe</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-comment">// ...</span>

<span class="hljs-meta">@Controller</span>(<span class="hljs-string">'todos'</span>) <span class="hljs-comment">// è·¯ç”±å‰ç¼€ï¼Œè®¿é—®è·¯å¾„å˜æˆäº† /todos</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TodosController</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> todosService: TodosService</span>) {}
    
    <span class="hljs-meta">@Get</span>()
    <span class="hljs-title function_">getTodos</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">todosService</span>.<span class="hljs-title function_">findAll</span>(); }

    <span class="hljs-meta">@Post</span>()
    <span class="hljs-title function_">addTodo</span>(<span class="hljs-params"><span class="hljs-meta">@Body</span>(<span class="hljs-string">'title'</span>) title: <span class="hljs-built_in">string</span></span>){ <span class="hljs-comment">// åªå– body é‡Œçš„ title å­—æ®µ</span>
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">todosService</span>.<span class="hljs-title function_">addTodo</span>(title);
    }

    <span class="hljs-meta">@Delete</span>(<span class="hljs-string">':id'</span>) <span class="hljs-comment">// åŠ¨æ€è·¯ç”±</span>
    <span class="hljs-title function_">deleteTodo</span>(<span class="hljs-params"><span class="hljs-meta">@Param</span>(<span class="hljs-string">'id'</span>, ParseIntPipe) id: <span class="hljs-built_in">number</span></span>){ <span class="hljs-comment">// ç®¡é“è½¬æ¢</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> id,<span class="hljs-string">'/////'</span>); <span class="hljs-comment">// è¿™é‡Œçš„ id å·²ç»æ˜¯ number ç±»å‹äº†ï¼</span>
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">todosService</span>.<span class="hljs-title function_">deleteTodo</span>(id);
    }
}
</code></pre>
<ul>
<li><strong>@Controller('todos')</strong>: è¿™é‡ŒåŠ äº†å‰ç¼€ã€‚æ‰€ä»¥ <code>getTodos</code> çš„ URL æ˜¯ <code>GET /todos</code>ã€‚</li>
<li><strong>@Body('title')</strong>: ä¹‹å‰æˆ‘ä»¬åœ¨ <code>login</code> é‡Œæ˜¯è·å–æ•´ä¸ª bodyã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä¼ ä¸ªå­—ç¬¦ä¸² <code>'title'</code>ï¼Œå‘Šè¯‰ NestJSï¼šâ€œæˆ‘åªè¦ body é‡Œçš„ title å±æ€§â€ã€‚ç²¾å‡†æ‰“å‡»ï¼ğŸ¯</li>
<li><strong>@Delete(':id')</strong>: å®šä¹‰äº†ä¸€ä¸ªåŠ¨æ€è·¯ç”±å‚æ•°ã€‚URL ç±»ä¼¼äº <code>DELETE /todos/123</code>ã€‚</li>
<li><strong>Pipe (ç®¡é“) â€”â€” <code>ParseIntPipe</code></strong>:
è¿™æ˜¯ NestJS çš„ä¸€å¤§æ€å™¨ï¼HTTP ä¼ è¿‡æ¥çš„å‚æ•°é»˜è®¤éƒ½æ˜¯ String ç±»å‹çš„ã€‚
ä½†æ˜¯æˆ‘ä»¬çš„ Service éœ€è¦ä¸€ä¸ª Number ç±»å‹çš„ IDã€‚
<code>@Param('id', ParseIntPipe) id: number</code> è¿™è¡Œä»£ç åšäº†ä¸€ä»¶å¾ˆé…·çš„äº‹ï¼š
<ol>
<li>ä»è·¯ç”±æå– <code>id</code>ã€‚</li>
<li><strong>ä¸­é—´ä»¶æ‹¦æˆª</strong>ï¼š<code>ParseIntPipe</code> å°è¯•æŠŠå®ƒè½¬æˆæ•´æ•°ã€‚</li>
<li><strong>å¦‚æœè½¬æ¢å¤±è´¥</strong>ï¼ˆæ¯”å¦‚ä¼ äº† <code>abc</code>ï¼‰ï¼ŒNestJS ç›´æ¥æŠ›å‡º 400 é”™è¯¯ï¼Œç”šè‡³ä¸ä¼šè¿›å…¥å‡½æ•°ä½“ã€‚</li>
<li><strong>å¦‚æœæˆåŠŸ</strong>ï¼Œä¼ å…¥å‡½æ•°çš„ <code>id</code> å°±æ˜¯çº¯æ­£çš„ <code>number</code> ç±»å‹ã€‚</li>
</ol>
</li>
</ul>
<h3 data-id="heading-19">3. Todos Service (æ¥å£ä¸æ•°æ®)</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Todo</span> {
    <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
    <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>;
    <span class="hljs-attr">completed</span>: <span class="hljs-built_in">boolean</span>;
}

<span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TodosService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">todos</span>: <span class="hljs-title class_">Todo</span>[] = [ ... ]; <span class="hljs-comment">// å†…å­˜æ•°æ®åº“</span>
    <span class="hljs-comment">// ... CRUD æ–¹æ³•</span>
}
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬å®šä¹‰äº† <code>Todo</code> æ¥å£ï¼ˆInterfaceï¼‰ã€‚åœ¨ TS é‡Œï¼Œæ¥å£æ˜¯æ„å»ºå¥å£®åº”ç”¨çš„åŸºç¡€ï¼Œå®ƒè§„å®šäº†æ•°æ®çš„å½¢çŠ¶ã€‚</p>
<hr/>
<h2 data-id="heading-20">ğŸ’ ç¬¬ä¸ƒæ­¥ï¼šè¿›é˜¶ç¡¬æ ¸ â€”â€” Database Module (è‡ªå®šä¹‰ Provider)</h2>
<p>æœ€åï¼Œæˆ‘ä»¬æ¥è®²è®²æœ€ç¡¬æ ¸çš„éƒ¨åˆ†â€”â€”å¦‚ä½•å°è£…ä¸€ä¸ªæ•°æ®åº“æ¨¡å—ã€‚
æˆ‘ä»¬åœ¨ <code>AppController</code> é‡Œçœ‹åˆ°çš„ <code>@Inject('PG_CONNECTION')</code> åˆ°åº•æ˜¯ä»å“ªæ¥çš„ï¼Ÿ</p>
<p>è¯·çœ‹ <code>src/database/database.module.ts</code>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Module</span>,<span class="hljs-title class_">Global</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Pool</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'pg'</span>; <span class="hljs-comment">// PostgreSQL å®¢æˆ·ç«¯</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> dotenv <span class="hljs-keyword">from</span> <span class="hljs-string">'dotenv'</span>;
dotenv.<span class="hljs-title function_">config</span>();

<span class="hljs-comment">// æ•°æ®åº“åŸºç¡€æœåŠ¡</span>
<span class="hljs-meta">@Global</span>() <span class="hljs-comment">// å…¨å±€æœåŠ¡</span>
<span class="hljs-meta">@Module</span>({
    <span class="hljs-attr">providers</span>: [
        {
            <span class="hljs-attr">provide</span>: <span class="hljs-string">'PG_CONNECTION'</span>, <span class="hljs-comment">// è‡ªå®šä¹‰ä»¤ç‰Œ (Token)</span>
            <span class="hljs-comment">// è¿æ¥æ± </span>
            <span class="hljs-attr">useValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Pool</span>({
                <span class="hljs-attr">user</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">DB_USER</span>,
                <span class="hljs-comment">// ... ç¯å¢ƒå˜é‡é…ç½®</span>
                <span class="hljs-attr">port</span>: <span class="hljs-built_in">parseInt</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">DB_PORT</span> || <span class="hljs-string">'5432'</span>,<span class="hljs-number">10</span>),
            })
        }
    ],
    <span class="hljs-attr">exports</span>: [<span class="hljs-string">'PG_CONNECTION'</span>] <span class="hljs-comment">// å¯¼å‡ºä»¤ç‰Œï¼Œè®©åˆ«äººä¹Ÿèƒ½ç”¨</span>
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseModule</span> {}
</code></pre>
<p>è¿™é‡ŒåŒ…å«äº† NestJS é«˜çº§ä¾èµ–æ³¨å…¥çš„ç²¾é«“ï¼š</p>
<h3 data-id="heading-21">1. è‡ªå®šä¹‰ Provider (Custom Provider)</h3>
<p>é€šå¸¸æˆ‘ä»¬çš„ provider æ˜¯ä¸€ä¸ªç±»ï¼ˆæ¯”å¦‚ <code>AppService</code>ï¼‰ã€‚ä½†æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ³¨å…¥ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“çš„å®ä¾‹ï¼ˆæ¯”å¦‚ <code>pg</code> çš„è¿æ¥æ±  <code>Pool</code>ï¼‰ï¼Œæˆ–è€…ä¸€ä¸ªå¸¸é‡ã€‚
è¿™æ—¶æˆ‘ä»¬å°±ä¸èƒ½ç›´æ¥å†™ç±»åäº†ï¼Œè€Œæ˜¯è¦ç”¨å¯¹è±¡å­—é¢é‡ï¼š</p>
<ul>
<li><strong>provide</strong>: <code>'PG_CONNECTION'</code>ã€‚è¿™æ˜¯ä¸€ä¸ª<strong>ä»¤ç‰Œ (Token)</strong>ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªæš—å·ã€‚</li>
<li><strong>useValue</strong>: è¿™æ˜¯ä¸€ä¸ªå…·ä½“çš„å€¼ï¼ˆåœ¨è¿™é‡Œæ˜¯ä¸€ä¸ªé…ç½®å¥½çš„æ•°æ®åº“è¿æ¥æ± å®ä¾‹ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-22">2. @Global() å…¨å±€æ¨¡å—</h3>
<p>é€šå¸¸æ¨¡å—æ˜¯éš”ç¦»çš„ã€‚å¦‚æœ <code>TodosModule</code> æƒ³ç”¨æ•°æ®åº“ï¼Œå®ƒå¾—åœ¨ <code>imports</code> é‡Œå¯¼å…¥ <code>DatabaseModule</code>ã€‚
ä½†æ•°æ®åº“æ˜¯åŸºç¡€è®¾æ–½ï¼Œæ¯ä¸ªæ¨¡å—éƒ½è¦ç”¨ã€‚æ¯æ¬¡éƒ½ import å¤ªéº»çƒ¦äº†ã€‚
åŠ ä¸Š <code>@Global()</code> è£…é¥°å™¨ï¼Œ<code>DatabaseModule</code> å°±å˜æˆäº†â€œVIP ä¸­ Pâ€ã€‚åªè¦åœ¨ <code>AppModule</code> é‡Œæ³¨å†Œä¸€æ¬¡ï¼Œå…¨é¡¹ç›®çš„ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒå¯¼å‡ºçš„ Providerï¼</p>
<h3 data-id="heading-23">3. å›åˆ° AppController ä½¿ç”¨å®ƒ</h3>
<p>ç°åœ¨å›åˆ° <code>src/app.controller.ts</code> çš„æ„é€ å‡½æ•°ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Inject</span>(<span class="hljs-string">'PG_CONNECTION'</span>) <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">db</span>: <span class="hljs-built_in">any</span>
</code></pre>
<p>è¿™é‡Œå¿…é¡»ç”¨ <code>@Inject('PG_CONNECTION')</code>ï¼Œå› ä¸º <code>'PG_CONNECTION'</code> æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ä»¤ç‰Œï¼ŒTS æ— æ³•é€šè¿‡ç±»å‹è‡ªåŠ¨æ¨æ–­å‡ºæ¥ï¼ˆä¸åƒ <code>AppService</code> æ˜¯ä¸ªç±»ï¼‰ã€‚
é€šè¿‡è¿™ä¸ªæš—å·ï¼ŒNestJS ä»å®¹å™¨é‡Œæ‹¿åˆ°äº†é‚£ä¸ª <code>Pool</code> å®ä¾‹ï¼Œèµ‹å€¼ç»™ <code>this.db</code>ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«åœ°å†™ SQL äº†ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript">  <span class="hljs-meta">@Get</span>(<span class="hljs-string">'db-test'</span>)
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">testConnection</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>.<span class="hljs-title function_">query</span>(<span class="hljs-string">'SELECT * FROM users'</span>); <span class="hljs-comment">// L44</span>
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">data</span>: res.<span class="hljs-property">rows</span> }
  }
</code></pre>
<p>æ³¨æ„è¿™é‡Œç”¨äº† <code>async/await</code>ï¼Œå› ä¸ºæ•°æ®åº“æŸ¥è¯¢æ˜¯å¼‚æ­¥æ“ä½œã€‚</p>
<hr/>
<h2 data-id="heading-24">ğŸ“ æ€»ç»“</h2>
<p>æ­å–œä½ ï¼ğŸ‰ è¯»åˆ°è¿™é‡Œï¼Œä½ å·²ç»æŒæ¡äº† NestJS çš„æ ¸å¿ƒå‘½è„‰ï¼š</p>
<ol>
<li><strong>CLI å°±åƒé­”æ³•æ£’</strong>ï¼š<code>nest new</code> ä¸€é”®ç”Ÿæˆã€‚</li>
<li><strong>Main å…¥å£</strong>ï¼šå·¥å‚æ¨¡å¼åˆ›å»ºåº”ç”¨ï¼Œ<code>??</code> è¿ç®—ç¬¦ä¿é©¾æŠ¤èˆªã€‚</li>
<li><strong>Module ä¹é«˜ç§¯æœ¨</strong>ï¼š<code>@Module</code> ç»„è£… Controller å’Œ Serviceã€‚</li>
<li><strong>Controller æ¥å¾…å‘˜</strong>ï¼šè·¯ç”±åˆ†å‘ï¼Œå‚æ•°æ ¡éªŒï¼ŒPipe ç®¡é“æ¸…æ´—æ•°æ®ã€‚</li>
<li><strong>Service å¤§å¨</strong>ï¼š<code>@Injectable</code> æ‰¿è½½ä¸šåŠ¡é€»è¾‘ã€‚</li>
<li><strong>Dependency Injection (DI)</strong>ï¼šé€šè¿‡æ„é€ å‡½æ•°è‡ªåŠ¨æ³¨å…¥ä¾èµ–ï¼Œè§£æ”¾åŒæ‰‹ã€‚</li>
<li><strong>Custom Provider</strong>ï¼šåˆ©ç”¨ Token æ³¨å…¥æ•°æ®åº“è¿æ¥æ± ç­‰ç¬¬ä¸‰æ–¹å®ä¾‹ã€‚</li>
</ol>
<p>NestJS å°±åƒæ˜¯ç»™ Node.js ç©¿ä¸Šäº†ä¸€å¥—é’¢é“ä¾ çš„æˆ˜è¡£ã€‚å®ƒå¯èƒ½ä¸€å¼€å§‹çœ‹èµ·æ¥æœ‰ç‚¹é‡ï¼Œä½†å½“ä½ é£èµ·æ¥çš„æ—¶å€™ï¼Œä½ ä¼šæ„Ÿè°¢è¿™å¥—æˆ˜è¡£ç»™ä½ æä¾›çš„å¼ºå¤§åŠ¨åŠ›å’Œå®‰å…¨æ„Ÿã€‚</p>
<p>å¯¹äº React å¼€å‘è€…æ¥è¯´ï¼Œå­¦ä¹  NestJS æ˜¯ä¸€æ¬¡æ€ç»´çš„å‡ç»´ã€‚ä½ ä¸å†åªæ˜¯ç”»é¡µé¢çš„ç”»å®¶ï¼Œä½ æ˜¯æ„å»ºä¸–ç•Œçš„å»ºç­‘å¸ˆã€‚</p>
<p>Stay Hungry, Stay Foolish, See you next time! ğŸ‘‹</p>
<hr/>
<h3 data-id="heading-25">ğŸ’¡ é™„å½•ï¼šæ ¸å¿ƒä»£ç åœ°å›¾</h3>
<ul>
<li><strong>å…¥å£æ–‡ä»¶</strong>: <a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target="><code>main.ts</code></a></li>
<li><strong>æ ¹æ¨¡å—</strong>: <a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target="><code>app.module.ts</code></a></li>
<li><strong>ä¸»æ§åˆ¶å™¨</strong>: <a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target="><code>app.controller.ts</code></a></li>
<li><strong>ä¸šåŠ¡æ¨¡å—</strong>: <a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target="><code>todos.module.ts</code></a></li>
<li><strong>æ•°æ®åº“æ¨¡å—</strong>: <a title="" ref="nofollow noopener noreferrer" href="https://link.juejin.cn?target="><code>database.module.ts</code></a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Flask - Tracking IDçš„è®¾è®¡]]></title>    <link>https://juejin.cn/post/7595842144906870834</link>    <guid>https://juejin.cn/post/7595842144906870834</guid>    <pubDate>2026-01-17T09:31:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595842144906870834" data-draft-id="7595890117865439278" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flask - Tracking IDçš„è®¾è®¡"/> <meta itemprop="keywords" content="åç«¯,Python,Flask"/> <meta itemprop="datePublished" content="2026-01-17T09:31:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="èŠ±é…’é”„ä½œç”°"/> <meta itemprop="url" content="https://juejin.cn/user/3289345922186590"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flask - Tracking IDçš„è®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3289345922186590/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    èŠ±é…’é”„ä½œç”°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T09:31:58.000Z" title="Sat Jan 17 2026 09:31:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨å®é™…ä¸šåŠ¡ä¸­ï¼Œæ ¹æ® <code>tracking_id</code> è¿½æº¯ä¸€æ¡è¯·æ±‚çš„å®Œæ•´å¤„ç†è·¯å¾„æ˜¯æ¯”è¾ƒå¸¸è§çš„éœ€æ±‚ã€‚å€ŸåŠ© Flask è‡ªå¸¦çš„å…¨å±€å¯¹è±¡ <code>g</code> ä»¥åŠé’©å­å‡½æ•°ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°ä¸ºæ¯æ¡è¯·æ±‚æ·»åŠ  <code>tracking_id</code>ï¼Œå¹¶åœ¨æ—¥å¿—ä¸­è‡ªåŠ¨è®°å½•ã€‚</p>
<p>ä¸»è¦å†…å®¹ï¼š</p>
<ul>
<li>å¦‚ä½•ä¸ºæ¯æ¡è¯·æ±‚æ·»åŠ  <code>tracking_id</code></li>
<li>å¦‚ä½•ä¸ºæ—¥å¿—è‡ªåŠ¨æ·»åŠ  <code>tracking_id</code> è®°å½•</li>
<li>å¦‚ä½•è‡ªå®šä¹‰å“åº”ç±»ï¼Œå®ç°ç»Ÿä¸€çš„å“åº”æ ¼å¼ï¼Œå¹¶åœ¨å“åº”å¤´ä¸­æ·»åŠ  <code>tracking_id</code></li>
<li>è§†å›¾å‡½æ•°å•å…ƒæµ‹è¯•ç¤ºä¾‹</li>
<li>Gunicorn é…ç½®</li>
</ul>
<h2 data-id="heading-1">é¡¹ç›®ç»“æ„</h2>
<p>è™½ç„¶å†…å®¹çœ‹èµ·æ¥å¾ˆå¤šï¼Œä½† tracking_id çš„å®ç°å…¶å®å¾ˆç®€å•ã€‚æœ¬æ–‡æŒ‰ç…§ç”Ÿäº§é¡¹ç›®çš„è§„èŒƒç»„ç»‡äº†ä»£ç ï¼Œæ·»åŠ äº† Gunicorn é…ç½®å’Œå•å…ƒæµ‹è¯•ä»£ç ï¼Œä»¥åŠè§„èŒƒäº†æ—¥å¿—æ ¼å¼å’Œ JSON å“åº”æ ¼å¼ã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown">â”œâ”€â”€ apis
â”‚   â”œâ”€â”€ common
â”‚   â”‚   â”œâ”€â”€ common.py
â”‚   â”‚   â””â”€â”€ <span class="hljs-strong">__init__</span>.py
â”‚   â””â”€â”€ <span class="hljs-strong">__init__</span>.py
â”œâ”€â”€ gunicorn.conf.py
â”œâ”€â”€ handles
â”‚   â””â”€â”€ user.py
â”œâ”€â”€ logs
â”‚   â”œâ”€â”€ access.log
â”‚   â””â”€â”€ error.log
â”œâ”€â”€ main.py
â”œâ”€â”€ middlewares
â”‚   â”œâ”€â”€ <span class="hljs-strong">__init__</span>.py
â”‚   â””â”€â”€ tracking<span class="hljs-emphasis">_id.py
â”œâ”€â”€ pkgs
â”‚   â””â”€â”€ log
â”‚       â”œâ”€â”€ app_</span>log.py
â”‚       â””â”€â”€ <span class="hljs-strong">__init__</span>.py
â”œâ”€â”€ pyproject.toml
â”œâ”€â”€ pytest.ini
â”œâ”€â”€ README.md
â”œâ”€â”€ responses
â”‚   â”œâ”€â”€ <span class="hljs-strong">__init__</span>.py
â”‚   â””â”€â”€ json<span class="hljs-emphasis">_response.py
â”œâ”€â”€ tests
â”‚   â””â”€â”€ apis
â”‚       â””â”€â”€ test_</span>common.py
â”œâ”€â”€ tmp
â”‚   â””â”€â”€ gunicorn.pid
â””â”€â”€ uv.lock
</code></pre>
<p>å®‰è£…ä¾èµ–</p>
<pre><code class="hljs language-shell" lang="shell">uv add flask
uv add gunicorn gevent  # ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ä¸€èˆ¬ä¾èµ–è¿™ä¸¤ä¸ª
uv add --dev pytest           # æµ‹è¯•åº“
</code></pre>
<h2 data-id="heading-2">å®ç°æ·»åŠ  tracking_id çš„ä¸­é—´ä»¶</h2>
<p>ä»£ç æ–‡ä»¶ï¼š<code>middlewares/tracking_id.py</code></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> uuid <span class="hljs-keyword">import</span> uuid4

<span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, Response, g, request


<span class="hljs-keyword">def</span> <span class="hljs-title function_">tracking_id_middleware</span>(<span class="hljs-params">app: Flask</span>):
    <span class="hljs-string">"""
    è·Ÿè¸ª ID ä¸­é—´ä»¶
    ä¸ºæ¯ä¸ªè¯·æ±‚ç”Ÿæˆæˆ–è·å–è·Ÿè¸ª IDï¼Œç”¨äºè¿½è¸ªè¯·æ±‚é“¾è·¯
    """</span>
    
<span class="hljs-meta">    @app.before_request</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">tracking_id_before_request</span>():
        <span class="hljs-string">"""
        è¯·æ±‚å‰å¤„ç†å‡½æ•°
        æ£€æŸ¥è¯·æ±‚å¤´ä¸­æ˜¯å¦åŒ…å« X-Tracking-IDï¼Œå¦‚æœæ²¡æœ‰åˆ™ç”Ÿæˆä¸€ä¸ªæ–°çš„ UUID ä½œä¸ºè·Ÿè¸ª ID
        å¹¶å°†å…¶å­˜å‚¨åˆ° Flask çš„å…¨å±€å¯¹è±¡ g ä¸­ï¼Œä¾›åç»­å¤„ç†ä½¿ç”¨
        """</span>
        <span class="hljs-comment"># ä»è¯·æ±‚å¤´ä¸­è·å– X-Tracking-ID</span>
        tracking_id = request.headers.get(<span class="hljs-string">"X-Tracking-ID"</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> tracking_id:
            <span class="hljs-comment"># å¦‚æœè¯·æ±‚å¤´ä¸­æ²¡æœ‰ X-Tracking-IDï¼Œåˆ™ç”Ÿæˆä¸€ä¸ªæ–°çš„ UUID</span>
            tracking_id = <span class="hljs-built_in">str</span>(uuid4())
        <span class="hljs-comment"># å°†è·Ÿè¸ª ID å­˜å‚¨åˆ° Flask çš„å…¨å±€å¯¹è±¡ g ä¸­ï¼Œä¾›åç»­å¤„ç†ä½¿ç”¨</span>
        g.tracking_id = tracking_id

<span class="hljs-meta">    @app.after_request</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">tracking_id_after_request</span>(<span class="hljs-params">response: Response</span>):
        <span class="hljs-string">"""
        è¯·æ±‚åå¤„ç†å‡½æ•°
        å°†è·Ÿè¸ª ID æ·»åŠ åˆ°å“åº”å¤´ä¸­ï¼Œä»¥ä¾¿å®¢æˆ·ç«¯çŸ¥é“æœ¬æ¬¡è¯·æ±‚çš„è·Ÿè¸ª ID
        """</span>
        <span class="hljs-comment"># æ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦å·²ç»æœ‰ X-Tracking-ID</span>
        tracking_id = response.headers.get(<span class="hljs-string">"X-Tracking-ID"</span>, <span class="hljs-string">""</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> tracking_id:
            <span class="hljs-comment"># å¦‚æœå“åº”å¤´ä¸­æ²¡æœ‰ X-Tracking-IDï¼Œåˆ™ä»å…¨å±€å¯¹è±¡ g ä¸­è·å–</span>
            tracking_id = g.get(<span class="hljs-string">"tracking_id"</span>, <span class="hljs-string">""</span>)
            <span class="hljs-comment"># å°†è·Ÿè¸ª ID æ·»åŠ åˆ°å“åº”å¤´ä¸­</span>
            response.headers[<span class="hljs-string">"X-Tracking-ID"</span>] = tracking_id
        <span class="hljs-keyword">return</span> response

    <span class="hljs-comment"># è¿”å›åº”ç”¨å®ä¾‹</span>
    <span class="hljs-keyword">return</span> app
</code></pre>
<p>ä»£ç æ–‡ä»¶ <code>middlewares/__init__.py</code>ï¼Œæ–¹ä¾¿å…¶ä»–æ¨¡å—å¯¼å…¥</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> .tracking_id <span class="hljs-keyword">import</span> tracking_id_middleware

__all__ = [
    <span class="hljs-string">"tracking_id_middleware"</span>,
]
</code></pre>
<h2 data-id="heading-3">æ—¥å¿—æ¨¡å— - è‡ªåŠ¨è®°å½• tracking_id</h2>
<p>å®ç°ä¸€ä¸ªç®€å•çš„è¾“å‡ºåˆ°æ§åˆ¶å°çš„æ—¥å¿—æ¨¡å—ï¼Œæ—¥å¿—æ ¼å¼ä¸º JSONï¼Œè‡ªåŠ¨æ·»åŠ  tracking_id åˆ°æ—¥å¿—ä¸­ï¼Œé¿å…æ‰‹åŠ¨åœ¨ <code>logger.info()</code> è¿™ç±»æ–¹æ³•ä¸­ä¼ å…¥ <code>tracking_id</code>ã€‚</p>
<p>ä»£ç æ–‡ä»¶ <code>pkgs/log/app_log.py</code></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> json
<span class="hljs-keyword">import</span> logging
<span class="hljs-keyword">import</span> sys

<span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> g


<span class="hljs-keyword">class</span> <span class="hljs-title class_">JSONFormatter</span>(logging.Formatter):
    <span class="hljs-string">"""æ—¥å¿—æ ¼å¼åŒ–å™¨ï¼Œè¾“å‡º JSON æ ¼å¼çš„æ—¥å¿—ã€‚"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">format</span>(<span class="hljs-params">self, record: logging.LogRecord</span>) -&gt; <span class="hljs-built_in">str</span>:
        log_record = {
            <span class="hljs-string">"@timestamp"</span>: self.formatTime(record, <span class="hljs-string">"%Y-%m-%dT%H:%M:%S%z"</span>),
            <span class="hljs-string">"level"</span>: record.levelname,
            <span class="hljs-string">"name"</span>: record.name,
            <span class="hljs-comment"># "processName": record.processName,  # å¦‚éœ€è®°å½•è¿›ç¨‹åå¯å–æ¶ˆæ³¨é‡Š</span>
            <span class="hljs-string">"tracking_id"</span>: <span class="hljs-built_in">getattr</span>(record, <span class="hljs-string">"tracking_id"</span>, <span class="hljs-literal">None</span>),
            <span class="hljs-string">"loc"</span>: <span class="hljs-string">"%s:%d"</span> % (record.filename, record.lineno),
            <span class="hljs-string">"func"</span>: record.funcName,
            <span class="hljs-string">"message"</span>: record.getMessage(),
        }

        <span class="hljs-keyword">return</span> json.dumps(log_record, ensure_ascii=<span class="hljs-literal">False</span>, default=<span class="hljs-built_in">str</span>)


<span class="hljs-keyword">class</span> <span class="hljs-title class_">TrackingIDFilter</span>(logging.Filter):
    <span class="hljs-string">"""æ—¥å¿—è¿‡æ»¤å™¨ï¼Œä¸ºæ—¥å¿—è®°å½•æ·»åŠ  tracking_idã€‚"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">filter</span>(<span class="hljs-params">self, record</span>):
        record.tracking_id = g.get(<span class="hljs-string">"tracking_id"</span>, <span class="hljs-literal">None</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>


<span class="hljs-keyword">def</span> <span class="hljs-title function_">_setup_console_handler</span>(<span class="hljs-params">level: <span class="hljs-built_in">int</span></span>) -&gt; logging.StreamHandler:
    <span class="hljs-string">"""è®¾ç½®æ§åˆ¶å°æ—¥å¿—å¤„ç†å™¨ã€‚

    Args:
        level (int): æ—¥å¿—çº§åˆ«ã€‚
    """</span>
    handler = logging.StreamHandler(sys.stdout)
    handler.setLevel(level)
    handler.setFormatter(JSONFormatter())
    <span class="hljs-keyword">return</span> handler


<span class="hljs-keyword">def</span> <span class="hljs-title function_">setup_app_logger</span>(<span class="hljs-params">level: <span class="hljs-built_in">int</span> = logging.INFO, name: <span class="hljs-built_in">str</span> = <span class="hljs-string">"app"</span></span>) -&gt; logging.Logger:
    logger = logging.getLogger(name)

    <span class="hljs-keyword">if</span> logger.hasHandlers():
        <span class="hljs-keyword">return</span> logger

    logger.setLevel(level)
    logger.propagate = <span class="hljs-literal">False</span>

    logger.addHandler(_setup_console_handler(level))
    logger.addFilter(TrackingIDFilter())

    <span class="hljs-keyword">return</span> logger
</code></pre>
<p>åœ¨ <code>pkgs/log/__init__.py</code> ä¸­åˆå§‹åŒ– <code>logger</code>ï¼Œå®ç°å•ä¾‹è°ƒç”¨ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> .app_log <span class="hljs-keyword">import</span> setup_app_logger

logger = setup_app_logger()

__all__ = [<span class="hljs-string">"logger"</span>]
</code></pre>
<h2 data-id="heading-4">è‡ªå®šä¹‰å“åº”ç±»</h2>
<p>è§„èŒƒ JSON ç±»å‹çš„å“åº”æ ¼å¼ï¼Œå¹¶åœ¨å“åº”å¤´ä¸­æ·»åŠ  <code>X-Tracking-ID</code> å’Œ <code>X-DateTime</code>ã€‚</p>
<p>ä»£ç æ–‡ä»¶ <code>responses/json_response.py</code></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> json
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime
<span class="hljs-keyword">from</span> http <span class="hljs-keyword">import</span> HTTPStatus
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Any</span>

<span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Response, g, request


<span class="hljs-keyword">class</span> <span class="hljs-title class_">JsonResponse</span>(<span class="hljs-title class_ inherited__">Response</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">
        self,
        data: <span class="hljs-type">Any</span> = <span class="hljs-literal">None</span>,
        code: HTTPStatus = HTTPStatus.OK,
        msg: <span class="hljs-built_in">str</span> = <span class="hljs-string">"this is a json response"</span>,
    </span>):
        x_tracking_id = g.get(<span class="hljs-string">"tracking_id"</span>, <span class="hljs-string">""</span>)
        x_datetime = datetime.now().astimezone().isoformat(timespec=<span class="hljs-string">"seconds"</span>)
        resp_headers = {
            <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
            <span class="hljs-string">"X-Tracking-ID"</span>: x_tracking_id,
            <span class="hljs-string">"X-DateTime"</span>: x_datetime,
        }
        <span class="hljs-keyword">try</span>:
            resp = json.dumps(
                {
                    <span class="hljs-string">"code"</span>: code.value,
                    <span class="hljs-string">"msg"</span>: msg,
                    <span class="hljs-string">"data"</span>: data,
                },
                ensure_ascii=<span class="hljs-literal">False</span>,
                default=<span class="hljs-built_in">str</span>,
            )
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            resp = json.dumps(
                {
                    <span class="hljs-string">"code"</span>: HTTPStatus.INTERNAL_SERVER_ERROR.value,
                    <span class="hljs-string">"msg"</span>: <span class="hljs-string">f"Response serialization error: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>,
                    <span class="hljs-string">"data"</span>: <span class="hljs-literal">None</span>,
                }
            )
        <span class="hljs-built_in">super</span>().__init__(response=resp, status=code.value, headers=resp_headers)


<span class="hljs-keyword">class</span> <span class="hljs-title class_">Success</span>(<span class="hljs-title class_ inherited__">JsonResponse</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, data: <span class="hljs-type">Any</span> = <span class="hljs-literal">None</span>, msg: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span></span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> msg:
            msg = <span class="hljs-string">f"<span class="hljs-subst">{request.method}</span> <span class="hljs-subst">{request.path}</span> success"</span>
        <span class="hljs-built_in">super</span>().__init__(data=data, code=HTTPStatus.OK, msg=msg)


<span class="hljs-keyword">class</span> <span class="hljs-title class_">Fail</span>(<span class="hljs-title class_ inherited__">JsonResponse</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, msg: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span>, data: <span class="hljs-type">Any</span> = <span class="hljs-literal">None</span></span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> msg:
            msg = <span class="hljs-string">f"<span class="hljs-subst">{request.method}</span> <span class="hljs-subst">{request.path}</span> failed"</span>
        <span class="hljs-built_in">super</span>().__init__(data=data, code=HTTPStatus.INTERNAL_SERVER_ERROR, msg=msg)


<span class="hljs-keyword">class</span> <span class="hljs-title class_">ArgumentNotFound</span>(<span class="hljs-title class_ inherited__">JsonResponse</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, msg: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span>, data: <span class="hljs-type">Any</span> = <span class="hljs-literal">None</span></span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> msg:
            msg = <span class="hljs-string">f"<span class="hljs-subst">{request.method}</span> <span class="hljs-subst">{request.path}</span> argument not found"</span>
        <span class="hljs-built_in">super</span>().__init__(data=data, code=HTTPStatus.BAD_REQUEST, msg=msg)


<span class="hljs-keyword">class</span> <span class="hljs-title class_">ArgumentInvalid</span>(<span class="hljs-title class_ inherited__">JsonResponse</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, msg: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span>, data: <span class="hljs-type">Any</span> = <span class="hljs-literal">None</span></span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> msg:
            msg = <span class="hljs-string">f"<span class="hljs-subst">{request.method}</span> <span class="hljs-subst">{request.path}</span> argument invalid"</span>
        <span class="hljs-built_in">super</span>().__init__(data=data, code=HTTPStatus.BAD_REQUEST, msg=msg)


<span class="hljs-keyword">class</span> <span class="hljs-title class_">AuthFailed</span>(<span class="hljs-title class_ inherited__">JsonResponse</span>):
    <span class="hljs-string">"""HTTP çŠ¶æ€ç : 401"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, msg: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span>, data: <span class="hljs-type">Any</span> = <span class="hljs-literal">None</span></span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> msg:
            msg = <span class="hljs-string">f"<span class="hljs-subst">{request.method}</span> <span class="hljs-subst">{request.path}</span> auth failed"</span>
        <span class="hljs-built_in">super</span>().__init__(data=data, code=HTTPStatus.UNAUTHORIZED, msg=msg)


<span class="hljs-keyword">class</span> <span class="hljs-title class_">ResourceConflict</span>(<span class="hljs-title class_ inherited__">JsonResponse</span>):
    <span class="hljs-string">"""HTTP çŠ¶æ€ç : 409"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, msg: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span>, data: <span class="hljs-type">Any</span> = <span class="hljs-literal">None</span></span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> msg:
            msg = <span class="hljs-string">f"<span class="hljs-subst">{request.method}</span> <span class="hljs-subst">{request.path}</span> resource conflict"</span>
        <span class="hljs-built_in">super</span>().__init__(data=data, code=HTTPStatus.CONFLICT, msg=msg)


<span class="hljs-keyword">class</span> <span class="hljs-title class_">ResourceNotFound</span>(<span class="hljs-title class_ inherited__">JsonResponse</span>):
    <span class="hljs-string">"""HTTP çŠ¶æ€ç : 404"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, msg: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span>, data: <span class="hljs-type">Any</span> = <span class="hljs-literal">None</span></span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> msg:
            msg = <span class="hljs-string">f"<span class="hljs-subst">{request.method}</span> <span class="hljs-subst">{request.path}</span> resource not found"</span>
        <span class="hljs-built_in">super</span>().__init__(data=data, code=HTTPStatus.NOT_FOUND, msg=msg)


<span class="hljs-keyword">class</span> <span class="hljs-title class_">ResourceForbidden</span>(<span class="hljs-title class_ inherited__">JsonResponse</span>):
    <span class="hljs-string">"""HTTP çŠ¶æ€ç : 403"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, msg: <span class="hljs-built_in">str</span> = <span class="hljs-string">""</span>, data: <span class="hljs-type">Any</span> = <span class="hljs-literal">None</span></span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> msg:
            msg = <span class="hljs-string">f"<span class="hljs-subst">{request.method}</span> <span class="hljs-subst">{request.path}</span> resource forbidden"</span>
        <span class="hljs-built_in">super</span>().__init__(data=data, code=HTTPStatus.FORBIDDEN, msg=msg)

</code></pre>
<p>ä»£ç æ–‡ä»¶ <code>responses/__init__.py</code>ï¼Œæ–¹ä¾¿å…¶ä»–æ¨¡å—è°ƒç”¨ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> .json_response <span class="hljs-keyword">import</span> (
    ArgumentInvalid,
    ArgumentNotFound,
    AuthFailed,
    Fail,
    JsonResponse,
    ResourceConflict,
    ResourceForbidden,
    ResourceNotFound,
    Success,
)

__all__ = [
    <span class="hljs-string">"JsonResponse"</span>,
    <span class="hljs-string">"Success"</span>,
    <span class="hljs-string">"Fail"</span>,
    <span class="hljs-string">"ArgumentNotFound"</span>,
    <span class="hljs-string">"ArgumentInvalid"</span>,
    <span class="hljs-string">"AuthFailed"</span>,
    <span class="hljs-string">"ResourceConflict"</span>,
    <span class="hljs-string">"ResourceNotFound"</span>,
    <span class="hljs-string">"ResourceForbidden"</span>,
]
</code></pre>
<h2 data-id="heading-5">ç¼–å†™è§†å›¾å‡½æ•°</h2>
<p>ä»£ç æ–‡ä»¶ <code>apis/common/common.py</code>ã€‚ä»¥ä¸‹å®šä¹‰äº† 5 ä¸ªè·¯ç”±ï¼Œä¸»è¦ç”¨äºæµ‹è¯•å“åº”ç±»æ˜¯å¦æ­£å¸¸è¿”å› JSON æ ¼å¼ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime

<span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Blueprint

<span class="hljs-keyword">from</span> handles <span class="hljs-keyword">import</span> user <span class="hljs-keyword">as</span> user_handle
<span class="hljs-keyword">from</span> pkgs.log <span class="hljs-keyword">import</span> logger
<span class="hljs-keyword">from</span> responses <span class="hljs-keyword">import</span> Success

route = Blueprint(<span class="hljs-string">"common_apis"</span>, __name__, url_prefix=<span class="hljs-string">"/api"</span>)


<span class="hljs-meta">@route.get(<span class="hljs-params"><span class="hljs-string">"/health"</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">health_check</span>():
    <span class="hljs-comment"># print(g.get("tracking_id", "no-tracking-id"))</span>
    logger.info(<span class="hljs-string">"Health check"</span>)
    <span class="hljs-keyword">return</span> Success(data=<span class="hljs-string">"OK"</span>)


<span class="hljs-meta">@route.get(<span class="hljs-params"><span class="hljs-string">"/users"</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_users</span>():
    users = user_handle.get_users()
    <span class="hljs-keyword">return</span> Success(data=users)


<span class="hljs-meta">@route.get(<span class="hljs-params"><span class="hljs-string">"/names"</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_names</span>():
    names = [<span class="hljs-string">"Alice"</span>, <span class="hljs-string">"Bob"</span>, <span class="hljs-string">"Charlie"</span>]
    <span class="hljs-keyword">return</span> Success(data=names)


<span class="hljs-meta">@route.get(<span class="hljs-params"><span class="hljs-string">"/item"</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_item</span>():
    item = {<span class="hljs-string">"id"</span>: <span class="hljs-number">101</span>, <span class="hljs-string">"name"</span>: <span class="hljs-string">"Sample Item"</span>, <span class="hljs-string">"price"</span>: <span class="hljs-number">29.99</span>, <span class="hljs-string">"now"</span>: datetime.now()}
    <span class="hljs-keyword">return</span> Success(data=item)


<span class="hljs-meta">@route.get(<span class="hljs-params"><span class="hljs-string">"/error"</span></span>)</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_error</span>():
    <span class="hljs-keyword">raise</span> Exception(<span class="hljs-string">"This is a test exception"</span>)

</code></pre>
<p><code>GET /api/users</code> è°ƒç”¨äº† <code>handles/</code> ä¸­çš„ä»£ç ï¼Œæ¨¡æ‹ŸæŸ¥è¯¢æ•°æ®åº“ã€‚<code>handles/user.py</code> ä¸­çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> time
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Any</span>, <span class="hljs-type">Dict</span>, <span class="hljs-type">List</span>


<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_users</span>() -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]]:
    <span class="hljs-comment"># æ¨¡æ‹ŸæŸ¥è¯¢ç”¨æˆ·æ•°æ®</span>
    time.sleep(<span class="hljs-number">0.1</span>)  <span class="hljs-comment"># æ¨¡æ‹Ÿå»¶è¿Ÿ</span>
    users = [{<span class="hljs-string">"id"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"name"</span>: <span class="hljs-string">"Alice"</span>}, {<span class="hljs-string">"id"</span>: <span class="hljs-number">2</span>, <span class="hljs-string">"name"</span>: <span class="hljs-string">"Bob"</span>}]
    <span class="hljs-keyword">return</span> users
</code></pre>
<p>ä»£ç æ–‡ä»¶ <code>apis/common/__init__.py</code> ä¸­å¯¼å…¥å„ä¸ªè“å›¾å¹¶ç»Ÿä¸€æš´éœ²ã€‚ç”±äºç¤ºä¾‹ä»£ç åªå®šä¹‰äº†ä¸€ä¸ªè“å›¾ï¼Œæ‰€ä»¥è¿™é‡Œå†™å¾—å¾ˆç®€å•ã€‚å¦‚æœæœ‰å¤šä¸ªè“å›¾ï¼Œå¯ä»¥æŠŠè“å›¾éƒ½æ·»åŠ åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œåœ¨ Flask åº”ç”¨ä¸­ä¸€æ¬¡æ€§éå†æ³¨å†Œã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> .common <span class="hljs-keyword">import</span> route
<span class="hljs-comment"># from .common import route as common_route</span>

<span class="hljs-comment"># routes = [</span>
<span class="hljs-comment">#     common_route,</span>
<span class="hljs-comment"># ]</span>

__all__ = [<span class="hljs-string">"route"</span>]
</code></pre>
<p>ä»£ç æ–‡ä»¶ <code>apis/__init__.py</code> ä¸­æä¾› Flask åº”ç”¨çš„å·¥å‚å‡½æ•°ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> traceback

<span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask

<span class="hljs-keyword">from</span> apis.common <span class="hljs-keyword">import</span> route <span class="hljs-keyword">as</span> common_route
<span class="hljs-keyword">from</span> middlewares <span class="hljs-keyword">import</span> tracking_id_middleware
<span class="hljs-keyword">from</span> responses <span class="hljs-keyword">import</span> Fail, ResourceNotFound
<span class="hljs-keyword">from</span> pkgs.log <span class="hljs-keyword">import</span> logger



<span class="hljs-comment"># é”™è¯¯å¤„ç†å™¨</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">error_handler_notfound</span>(<span class="hljs-params">error</span>):
    <span class="hljs-keyword">return</span> ResourceNotFound()


<span class="hljs-keyword">def</span> <span class="hljs-title function_">error_handler_generic</span>(<span class="hljs-params">error</span>):
    logger.error(traceback.format_exc())
    <span class="hljs-keyword">return</span> Fail(data=<span class="hljs-built_in">str</span>(error))



<span class="hljs-keyword">def</span> <span class="hljs-title function_">create_app</span>() -&gt; Flask:
    app = Flask(__name__)

    <span class="hljs-comment"># æ³¨å†Œä¸­é—´ä»¶</span>
    app = tracking_id_middleware(app)

    <span class="hljs-comment"># æ³¨å†Œé”™è¯¯å¤„ç†å™¨</span>
    app.errorhandler(Exception)(error_handler_generic)
    app.errorhandler(<span class="hljs-number">404</span>)(error_handler_notfound)

    <span class="hljs-comment"># æ³¨å†Œè“å›¾</span>
    app.register_blueprint(common_route)

    <span class="hljs-keyword">return</span> app

__all__ = [
    <span class="hljs-string">"create_app"</span>,
]
</code></pre>
<p>å…¥å£ä»£ç æ–‡ä»¶ <code>main.py</code></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> apis <span class="hljs-keyword">import</span> create_app

app = create_app()

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    app.run(host=<span class="hljs-string">"127.0.0.1"</span>, port=<span class="hljs-number">8000</span>, debug=<span class="hljs-literal">False</span>)
</code></pre>
<h2 data-id="heading-6">ç®€å•è¿è¡Œæµ‹è¯•</h2>
<ol>
<li>å¯åŠ¨åº”ç”¨</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹å¼1, ç›´æ¥å¯åŠ¨, ç”¨äºç®€å•æµ‹è¯•</span>
python main.py

<span class="hljs-comment"># æ–¹å¼2, ä½¿ç”¨ gunicorn, è¿™æ˜¯ç”Ÿäº§ç¯å¢ƒå¯åŠ¨æ–¹å¼. é…ç½®æ–‡ä»¶é»˜è®¤è·¯å¾„å³ ./gunicorn.conf.py</span>
gunicorn main:app
</code></pre>
<ol start="2">
<li>curl è¯·æ±‚ <code>/api/health</code>ã€‚å¯ä»¥çœ‹åˆ°å“åº”å¤´ä¸­å·²ç»æœ‰äº† <code>X-Tracking-ID</code> å’Œ <code>X-DateTime</code></li>
</ol>
<pre><code class="hljs language-bash" lang="bash">$ curl -v http://127.0.0.1:8000/api/health
*   Trying 127.0.0.1:8000...
* Connected to 127.0.0.1 (127.0.0.1) port 8000
* using HTTP/1.x
&gt; GET /api/health HTTP/1.1
&gt; Host: 127.0.0.1:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt;
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Server: gunicorn
&lt; Date: Sat, 17 Jan 2026 08:41:07 GMT
&lt; Connection: keep-alive
&lt; Content-Type: application/json
&lt; X-Tracking-ID: 1f0adb8d-9bee-49d4-873f-31aa1437da60
&lt; X-DateTime: 2026-01-17T16:41:07+08:00
&lt; Content-Length: 61
&lt;
* Connection <span class="hljs-comment">#0 to host 127.0.0.1 left intact</span>
{<span class="hljs-string">"code"</span>: 200, <span class="hljs-string">"msg"</span>: <span class="hljs-string">"GET /api/health success"</span>, <span class="hljs-string">"data"</span>: <span class="hljs-string">"OK"</span>}
</code></pre>
<ol start="3">
<li>curl è¯·æ±‚ <code>/api/users</code>ã€‚æ‰‹åŠ¨æŒ‡å®šè¯·æ±‚å¤´ä¸­çš„ <code>X-Tracking-ID</code>ï¼Œå“åº”æ—¶ä¹Ÿä¼šä¿æŒç›¸åŒçš„ IDã€‚</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">$ curl -v http://127.0.0.1:8000/api/users -H <span class="hljs-string">'X-Tracking-ID:123456'</span>
*   Trying 127.0.0.1:8000...
* Connected to 127.0.0.1 (127.0.0.1) port 8000
* using HTTP/1.x
&gt; GET /api/users HTTP/1.1
&gt; Host: 127.0.0.1:8000
&gt; User-Agent: curl/8.14.1
&gt; Accept: */*
&gt; X-Tracking-ID:123456
&gt;
* Request completely sent off
&lt; HTTP/1.1 200 OK
&lt; Server: gunicorn
&lt; Date: Sat, 17 Jan 2026 08:44:37 GMT
&lt; Connection: keep-alive
&lt; Content-Type: application/json
&lt; X-Tracking-ID: 123456
&lt; X-DateTime: 2026-01-17T16:44:37+08:00
&lt; Content-Length: 110
&lt;
* Connection <span class="hljs-comment">#0 to host 127.0.0.1 left intact</span>
{<span class="hljs-string">"code"</span>: 200, <span class="hljs-string">"msg"</span>: <span class="hljs-string">"GET /api/users success"</span>, <span class="hljs-string">"data"</span>: [{<span class="hljs-string">"id"</span>: 1, <span class="hljs-string">"name"</span>: <span class="hljs-string">"Alice"</span>}, {<span class="hljs-string">"id"</span>: 2, <span class="hljs-string">"name"</span>: <span class="hljs-string">"Bob"</span>}]}
</code></pre>
<h2 data-id="heading-7">ç¼–å†™å•å…ƒæµ‹è¯•</h2>
<p>ä½¿ç”¨ pytest è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œè¿™é‡Œåªæ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹</p>
<h3 data-id="heading-8">é…ç½® pytest</h3>
<p>é…ç½®æ–‡ä»¶ <code>pytest.ini</code></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[pytest]</span>
<span class="hljs-attr">testpaths</span> = <span class="hljs-string">"tests"</span>
<span class="hljs-attr">pythonpath</span> = <span class="hljs-string">"."</span>
</code></pre>
<h3 data-id="heading-9">æµ‹è¯•ä»£ç </h3>
<p>ä»£ç æ–‡ä»¶ <code>tests/apis/test_common.py</code></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> Generator
<span class="hljs-keyword">from</span> unittest.mock <span class="hljs-keyword">import</span> MagicMock, patch

<span class="hljs-keyword">import</span> pytest
<span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask
<span class="hljs-keyword">from</span> flask.testing <span class="hljs-keyword">import</span> FlaskClient

<span class="hljs-keyword">from</span> apis.common <span class="hljs-keyword">import</span> route <span class="hljs-keyword">as</span> common_route


<span class="hljs-meta">@pytest.fixture</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">app</span>() -&gt; Generator[Flask, <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>]:
    app = Flask(__name__)
    app.config.update(
        {
            <span class="hljs-string">"TESTING"</span>: <span class="hljs-literal">True</span>,
            <span class="hljs-string">"DEBUG"</span>: <span class="hljs-literal">False</span>,
        }
    )
    app.register_blueprint(common_route)
    <span class="hljs-keyword">yield</span> app


<span class="hljs-meta">@pytest.fixture</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">client</span>(<span class="hljs-params">app: Flask</span>) -&gt; FlaskClient:
    <span class="hljs-keyword">return</span> app.test_client()


<span class="hljs-keyword">class</span> <span class="hljs-title class_">TestGetHealth</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_get_health_success</span>(<span class="hljs-params">self, client: FlaskClient</span>) -&gt; <span class="hljs-literal">None</span>:
        resp = client.get(<span class="hljs-string">"/api/health"</span>)
        <span class="hljs-keyword">assert</span> resp.status_code == <span class="hljs-number">200</span>

        resp_headers = resp.headers
        <span class="hljs-keyword">assert</span> resp_headers.get(<span class="hljs-string">"Content-Type"</span>) == <span class="hljs-string">"application/json"</span>
        <span class="hljs-keyword">assert</span> <span class="hljs-string">"X-Tracking-ID"</span> <span class="hljs-keyword">in</span> resp_headers
        <span class="hljs-keyword">assert</span> <span class="hljs-string">"X-DateTime"</span> <span class="hljs-keyword">in</span> resp_headers

        resp_body = resp.json
        <span class="hljs-keyword">assert</span> resp_body == {
            <span class="hljs-string">"code"</span>: <span class="hljs-number">200</span>,
            <span class="hljs-string">"msg"</span>: <span class="hljs-string">"GET /api/health success"</span>,
            <span class="hljs-string">"data"</span>: <span class="hljs-string">"OK"</span>,
        }


<span class="hljs-keyword">class</span> <span class="hljs-title class_">TestGetUsers</span>:
<span class="hljs-meta">    @patch(<span class="hljs-params"><span class="hljs-string">"apis.common.common.user_handle.get_users"</span></span>)</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_get_users</span>(<span class="hljs-params">self, mock_get_users: MagicMock, client: FlaskClient</span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-comment"># mock user.get_users() çš„è¿”å›å€¼</span>
        mock_get_users.return_value = [
            {<span class="hljs-string">"id"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"name"</span>: <span class="hljs-string">"Alice123"</span>},
            {<span class="hljs-string">"id"</span>: <span class="hljs-number">2</span>, <span class="hljs-string">"name"</span>: <span class="hljs-string">"Bob456"</span>},
        ]

        <span class="hljs-comment"># å‘é€è¯·æ±‚</span>
        resp = client.get(<span class="hljs-string">"/api/users"</span>)
        <span class="hljs-keyword">assert</span> resp.status_code == <span class="hljs-number">200</span>

        resp_headers = resp.headers
        <span class="hljs-keyword">assert</span> resp_headers.get(<span class="hljs-string">"Content-Type"</span>) == <span class="hljs-string">"application/json"</span>
        <span class="hljs-keyword">assert</span> <span class="hljs-string">"X-Tracking-ID"</span> <span class="hljs-keyword">in</span> resp_headers
        <span class="hljs-keyword">assert</span> <span class="hljs-string">"X-DateTime"</span> <span class="hljs-keyword">in</span> resp_headers

        <span class="hljs-comment"># resp_body = resp.json</span>

        mock_get_users.assert_called_once()

</code></pre>
<h3 data-id="heading-10">æ‰§è¡Œæµ‹è¯•</h3>
<pre><code class="hljs language-shell" lang="shell">pytest -vv
</code></pre>
<h2 data-id="heading-11">é…ç½® Gunicorn</h2>
<p>ä»£ç æ–‡ä»¶ <code>gunicorn.conf.py</code>ã€‚ç®€å•é…ç½®äº†ä¸€äº›å¯åŠ¨å‚æ•°ï¼Œä»¥åŠè¯·æ±‚æ—¥å¿—çš„æ ¼å¼ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Gunicorn é…ç½®æ–‡ä»¶</span>
<span class="hljs-keyword">from</span> pathlib <span class="hljs-keyword">import</span> Path
<span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> cpu_count
<span class="hljs-keyword">import</span> gunicorn.glogging
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime

<span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomLogger</span>(gunicorn.glogging.Logger):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">atoms</span>(<span class="hljs-params">self, resp, req, environ, request_time</span>):
        <span class="hljs-string">"""
        é‡å†™ atoms æ–¹æ³•æ¥è‡ªå®šä¹‰æ—¥å¿—å ä½ç¬¦
        """</span>
        <span class="hljs-comment"># è·å–é»˜è®¤çš„æ‰€æœ‰å ä½ç¬¦æ•°æ®</span>
        atoms = <span class="hljs-built_in">super</span>().atoms(resp, req, environ, request_time)
        
        <span class="hljs-comment"># è‡ªå®šä¹‰ 't' (æ—¶é—´æˆ³) çš„æ ¼å¼</span>
        now = datetime.now().astimezone()
        atoms[<span class="hljs-string">'t'</span>] = now.isoformat(timespec=<span class="hljs-string">"seconds"</span>)
        
        <span class="hljs-keyword">return</span> atoms
    

<span class="hljs-comment"># é¢„åŠ è½½åº”ç”¨ä»£ç </span>
preload_app = <span class="hljs-literal">True</span>

<span class="hljs-comment"># å·¥ä½œè¿›ç¨‹æ•°é‡ï¼šé€šå¸¸æ˜¯ CPU æ ¸å¿ƒæ•°çš„ 2 å€åŠ  1</span>
<span class="hljs-comment"># workers = int(cpu_count() * 2 + 1)</span>
workers = <span class="hljs-number">2</span>

<span class="hljs-comment"># ä½¿ç”¨ gevent å¼‚æ­¥ worker ç±»å‹ï¼Œé€‚åˆ I/O å¯†é›†å‹åº”ç”¨</span>
<span class="hljs-comment"># æ³¨æ„ï¼šgevent worker ä¸ä½¿ç”¨ threads å‚æ•°ï¼Œè€Œæ˜¯ä½¿ç”¨åç¨‹è¿›è¡Œå¹¶å‘å¤„ç†</span>
worker_class = <span class="hljs-string">"gevent"</span>

<span class="hljs-comment"># æ¯ä¸ª gevent worker å¯å¤„ç†çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°</span>
worker_connections = <span class="hljs-number">2000</span>

<span class="hljs-comment"># ç»‘å®šåœ°å€å’Œç«¯å£</span>
bind = <span class="hljs-string">"127.0.0.1:8000"</span>

<span class="hljs-comment"># è¿›ç¨‹åç§°</span>
proc_name = <span class="hljs-string">"flask-dev"</span>

<span class="hljs-comment"># PID æ–‡ä»¶è·¯å¾„</span>
pidfile = <span class="hljs-built_in">str</span>(Path(__file__).parent / <span class="hljs-string">"tmp"</span> / <span class="hljs-string">"gunicorn.pid"</span>)

logger_class = CustomLogger
access_log_format = (
    <span class="hljs-string">'{"@timestamp": "%(t)s", '</span>
    <span class="hljs-string">'"remote_addr": "%(h)s", '</span>
    <span class="hljs-string">'"protocol": "%(H)s", '</span>
    <span class="hljs-string">'"host": "%({host}i)s", '</span>
    <span class="hljs-string">'"request_method": "%(m)s", '</span>
    <span class="hljs-string">'"request_path": "%(U)s", '</span>
    <span class="hljs-string">'"status_code": %(s)s, '</span>
    <span class="hljs-string">'"response_length": %(b)s, '</span>
    <span class="hljs-string">'"referer": "%(f)s", '</span>
    <span class="hljs-string">'"user_agent": "%(a)s", '</span>
    <span class="hljs-string">'"x_tracking_id": "%({x-tracking-id}i)s", '</span>
    <span class="hljs-string">'"request_time": %(L)s}'</span>
)

<span class="hljs-comment"># è®¿é—®æ—¥å¿—è·¯å¾„</span>
accesslog = <span class="hljs-built_in">str</span>(Path(__file__).parent / <span class="hljs-string">"logs"</span> / <span class="hljs-string">"access.log"</span>)

<span class="hljs-comment"># é”™è¯¯æ—¥å¿—è·¯å¾„</span>
errorlog = <span class="hljs-built_in">str</span>(Path(__file__).parent / <span class="hljs-string">"logs"</span> / <span class="hljs-string">"error.log"</span>)

<span class="hljs-comment"># æ—¥å¿—çº§åˆ«</span>
loglevel = <span class="hljs-string">"debug"</span>
</code></pre>
<p>è¾“å‡ºçš„æ—¥å¿—æ ¼å¼ã€‚å¯ä»¥çœ‹åˆ°æ—¥å¿—æ ¼å¼ç¬¦åˆ JSON è§„èŒƒï¼Œä¾¿äº Filebeat æ”¶é›†ååœ¨ Kibana ä¸Šæ£€ç´¢ã€‚</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_">$ </span><span class="bash"><span class="hljs-built_in">tail</span> -n 1 logs/access.log | python3 -m json.tool</span>
{
    "@timestamp": "2026-01-17T16:44:37+08:00",
    "remote_addr": "127.0.0.1",
    "protocol": "HTTP/1.1",
    "host": "127.0.0.1:8000",
    "request_method": "GET",
    "request_path": "/api/users",
    "status_code": 200,
    "response_length": 110,
    "referer": "-",
    "user_agent": "curl/8.14.1",
    "x_tracking_id": "123456",
    "request_time": 0.102042
}
</code></pre>
<h2 data-id="heading-12">è¡¥å……</h2>
<h3 data-id="heading-13">å…¨å±€å¯¹è±¡ g çš„æ³¨æ„äº‹é¡¹</h3>
<ol>
<li><code>g</code> ä¸æ˜¯è¿›ç¨‹æˆ–çº¿ç¨‹å…±äº«çš„å…¨å±€å˜é‡ï¼Œè¯·åªåœ¨è¯·æ±‚å¤„ç†æµç¨‹ä¸­ä½¿ç”¨ <code>g</code>ã€‚</li>
<li>å¦‚æœè§†å›¾å‡½æ•°ä¸­å¯åŠ¨äº†åå°çº¿ç¨‹æˆ–å¼‚æ­¥ä»»åŠ¡ï¼Œåœ¨å­çº¿ç¨‹ä¸­ç›´æ¥è®¿é—® <code>g</code> é€šå¸¸ä¼šæŠ¥é”™æˆ–è·å–ä¸åˆ°æ•°æ®ã€‚è¿™æ—¶å»ºè®®æ˜¾å¼ä¼ é€’æ•°æ®ã€‚</li>
<li>ä¸è¦åœ¨ <code>g</code> ä¸­å­˜å‚¨å¤§æ–‡ä»¶æˆ–æ•°æ®å¯¹è±¡ï¼Œå¦åˆ™ä¼šå ç”¨è¿‡é«˜å†…å­˜ã€‚</li>
<li><code>g</code> ä¸æ˜¯ <code>session</code>ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€å‘¨ä¹‹å†…ï¼Œäº”å®¶å…¬å¸ç”¨è¡ŒåŠ¨ç”»å‡ºäº†AIçš„æœªæ¥åœ°å›¾]]></title>    <link>https://juejin.cn/post/7595890117865537582</link>    <guid>https://juejin.cn/post/7595890117865537582</guid>    <pubDate>2026-01-17T10:16:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595890117865537582" data-draft-id="7595808703074648090" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€å‘¨ä¹‹å†…ï¼Œäº”å®¶å…¬å¸ç”¨è¡ŒåŠ¨ç”»å‡ºäº†AIçš„æœªæ¥åœ°å›¾"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-17T10:16:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‘¸é±¼çš„æ˜¥å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/1714893870865303"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€å‘¨ä¹‹å†…ï¼Œäº”å®¶å…¬å¸ç”¨è¡ŒåŠ¨ç”»å‡ºäº†AIçš„æœªæ¥åœ°å›¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1714893870865303/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‘¸é±¼çš„æ˜¥å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T10:16:24.000Z" title="Sat Jan 17 2026 10:16:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿‡å»è¿™ä¸€å‘¨ï¼Œç§‘æŠ€åœˆçš„å‡ ä¸ªå¤§åŠ¨ä½œï¼Œå•ç‹¬çœ‹éƒ½æ˜¯æ–°é—»ï¼Œè¿èµ·æ¥çœ‹ï¼Œå°±æ˜¯ä¸€å¼ æ­£åœ¨å¿«é€Ÿæˆå‹çš„æœªæ¥åœ°å›¾ã€‚</p>
<p>åœ°å›¾çš„ä¸€è§’ï¼Œå¾®è½¯å‘å‡ºè­¦å‘Šï¼Œè¯´ä¸­å›½AIæ­£åœ¨æ–°å…´å¸‚åœºæˆä¸ºé»˜è®¤é€‰æ‹©ã€‚å¦ä¸€è§’ï¼Œè‹¹æœæ­£å¼å®£å¸ƒï¼Œä¸‹ä¸€ä»£Siriçš„æ ¸å¿ƒå°†äº¤ç»™è°·æ­Œçš„Geminiæ¥é©±åŠ¨ã€‚ä¸æ­¤åŒæ—¶ï¼ŒAnthropicè®©Claudeå˜æˆäº†èƒ½ç›´æ¥æ“ä½œä½ ç”µè„‘æ–‡ä»¶çš„â€œæ•°å­—å‘˜å·¥â€ã€‚</p>
<p>è¿™äº›äº‹å‘ç”Ÿåœ¨ä¸åŒå…¬å¸ã€ä¸åŒé¢†åŸŸï¼Œä½†æŒ‡å‘åŒä¸€ä¸ªæ–¹å‘ï¼šAIç«èµ›å·²ç»ç»“æŸäº†å®éªŒå®¤ç‚«æŠ€é˜¶æ®µï¼Œè¿›å…¥äº†æ‹¼ç”Ÿæ€ã€æŠ¢å…¥å£ã€å®šæ ‡å‡†çš„å®æˆ˜ç¯èŠ‚ã€‚</p>
<h2 data-id="heading-0">å¾®è½¯çš„è­¦å‘Šï¼Œå…³äºå¦ä¸€ç§æ¸¸æˆè§„åˆ™</h2>
<p>å¾®è½¯è¿™ä»½æŠ¥å‘Šï¼Œåˆ†é‡å¾ˆé‡ã€‚å®ƒä¸æ˜¯ä»€ä¹ˆåˆ†æå¸ˆçš„è§‚ç‚¹ï¼Œè€Œæ˜¯è¿™å®¶æ·±åº¦ç»‘å®šOpenAIã€è¿è¥ç€å…¨çƒé¡¶çº§äº‘æœåŠ¡ã€å¤©å¤©çœ‹ç€å…¨çƒæ•°æ®æµçš„å·¨å¤´ï¼Œåœ¨é™ˆè¿°ä¸€ä¸ªå®ƒè§‚å¯Ÿåˆ°çš„äº‹å®ã€‚</p>
<p>å¾®è½¯è¯´ï¼Œåœ¨é«˜ç«¯ä¼ä¸šå¸‚åœºã€äº‘åŸºç¡€è®¾æ–½è¿™å—ï¼Œè¥¿æ–¹å…¬å¸ä¾ç„¶é¢†å…ˆã€‚ä½†å‡ºäº†è¥¿æ–¹ä¸–ç•Œï¼Œæ¸¸æˆè§„åˆ™å˜äº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb0d49d07083458dada20089402ed53d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pG46bG855qE5pil5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769249784&amp;x-signature=MlYYpFJcIcUhsazrRktWd0ijDtA%3D" alt="" loading="lazy"/></p>
<p>ä¸­å›½AIç”Ÿæ€æ¨çš„æ¨¡å‹ï¼Œæ›´ä¾¿å®œï¼Œæ›´å®¹æ˜“è·å–ï¼Œå¾ˆå¤šè¿˜æ˜¯å¼€æºæˆ–æ¥è¿‘å¼€æºçš„ã€‚åœ¨éæ´²ã€ä¸œæ¬§ã€æ‹‰ä¸ç¾æ´²è¿™äº›åœ°æ–¹ï¼Œä¼ä¸šé—®çš„ç¬¬ä¸€ä¸ªé—®é¢˜å¾€å¾€ä¸æ˜¯â€œå“ªä¸ªæ¨¡å‹æœ€å¼ºå¤§â€ï¼Œè€Œæ˜¯â€œå“ªä¸ªæˆ‘ä»¬ç”¨å¾—èµ·ã€éƒ¨ç½²å¾—äº†ã€ç»´æŠ¤å¾—äº†â€ã€‚</p>
<p>å¾®è½¯ç‚¹åäº†æ·±åº¦æ±‚ç´¢è¿™ç±»å…¬å¸ï¼Œè¯´å®ƒä»¬çš„æ¨¡å‹åœ¨è¿™äº›åŒºåŸŸç”¨é‡å¾ˆå¤§ï¼Œæœ‰æ—¶ç”šè‡³è¶…è¿‡äº†è¥¿æ–¹äº§å“ã€‚</p>
<p>è¿™ä»¶äº‹çš„å…³é”®åœ¨äºï¼Œä¸€æ—¦ç”¨ä¸Šäº†ï¼Œå°±å®¹æ˜“å½¢æˆç”Ÿæ€é”å®šã€‚å¼€å‘è€…ã€åˆåˆ›å…¬å¸ã€å¤§å­¦ä¹ æƒ¯äº†ç”¨æŸä¸€å¥—å·¥å…·é“¾ï¼Œæœªæ¥å‡ å¹´éƒ½ä¼šæ²¿ç€è¿™æ¡è·¯èµ°ä¸‹å»ã€‚æ—©æœŸçš„äº’è”ç½‘åè®®ã€ç§»åŠ¨æ“ä½œç³»ç»Ÿã€äº‘æœåŠ¡å•†ï¼Œéƒ½æ˜¯è¿™ä¹ˆè¿‡æ¥çš„ã€‚</p>
<p>æ‰€ä»¥å¾®è½¯çš„è­¦å‘Šå…¶å®æ˜¯ï¼Œåœ¨è¥¿æ–¹å¸‚åœºä¹‹å¤–ï¼Œä¸­å›½AIå¯èƒ½æ­£åœ¨å› ä¸ºâ€œä¾¿å®œå¥½ç”¨â€è€Œæˆä¸ºé»˜è®¤é€‰é¡¹ã€‚è¿™èƒŒåæ˜¯ä¸€æ•´å¥—å›½å®¶æ”¯æŒã€åŸºå»ºæŠ•å…¥å’Œå¿«é€Ÿè§„æ¨¡åŒ–èƒ½åŠ›çš„ååŒã€‚è¥¿æ–¹é¢å¯¹çš„ï¼Œä¸æ˜¯ä¸€ä¸ªå¯¹æ‰‹ï¼Œè€Œæ˜¯ä¸€ä¸ªé«˜åº¦åè°ƒã€èƒ½å¿«é€Ÿé“ºå¼€çš„ç”Ÿæ€ç³»ç»Ÿã€‚</p>
<p>å¯¹å¾®è½¯ã€è°·æ­Œã€äºšé©¬é€Šè¿™äº›å…¬å¸æ¥è¯´ï¼Œæ–°å…´å¸‚åœºä¸æ˜¯é”¦ä¸Šæ·»èŠ±ï¼Œè€Œæ˜¯æœªæ¥çš„å¢é•¿å¼•æ“ã€‚å¦‚æœåœ¨é‚£é‡Œå¤±å»å½±å“ï¼Œå¤±å»çš„ä¸ä»…æ˜¯å®¢æˆ·ï¼Œè¿˜æœ‰æ•°æ®é£è½®ã€å¼€å‘è€…ç”Ÿæ€ï¼Œæœ€ç»ˆæ˜¯å¸‚åœºä»½é¢ã€‚</p>
<h2 data-id="heading-1">è‹¹æœçš„é€‰æ‹©ï¼Œä¸ç”Ÿæ€çš„åˆçºµè¿æ¨ª</h2>
<p>å°±åœ¨å¾®è½¯æç»˜å…¨çƒç«äº‰å›¾æ™¯æ—¶ï¼Œè‹¹æœç”¨è¡ŒåŠ¨å±•ç¤ºäº†ç«äº‰çš„å¦ä¸€é¢ï¼šåˆçºµè¿æ¨ªã€‚</p>
<p>è‹¹æœå®˜æ–¹å®£å¸ƒï¼Œå’Œè°·æ­Œè¾¾æˆä¸€é¡¹å¤šå¹´æœŸåˆä½œã€‚è°·æ­Œçš„Geminiæ¨¡å‹å’Œäº‘æŠ€æœ¯ï¼Œå°†æˆä¸ºè‹¹æœä¸‹ä¸€ä»£åŸºç¡€æ¨¡å‹å’Œæœªæ¥â€œè‹¹æœæ™ºèƒ½â€åŠŸèƒ½çš„åŸºçŸ³ã€‚é¢„è®¡2026å¹´ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸€ä¸ªç”±Geminié©±åŠ¨çš„å…¨æ–°Siriã€‚</p>
<p>è‹¹æœçš„è¯´æ³•å¾ˆå€¼å¾—ç©å‘³ã€‚ä»–ä»¬è¯´ï¼Œç»è¿‡ä»”ç»†è¯„ä¼°ï¼Œè®¤ä¸ºè°·æ­Œçš„AIæä¾›äº†â€œèƒ½åŠ›æœ€å¼ºçš„åŸºç¡€â€ã€‚ä»¥è‹¹æœçš„æŒ‘å‰”ï¼Œè¿™ç®—æ˜¯å¾ˆé«˜çš„è¯„ä»·äº†ã€‚</p>
<p>æ›´å…³é”®çš„æ˜¯ï¼Œè‹¹æœå¹¶æ²¡æœ‰å› æ­¤è¸¢æ‰OpenAIã€‚ä»–ä»¬å‘Šè¯‰åª’ä½“ï¼Œä¹‹å‰å°†ChatGPTé›†æˆåˆ°Siriå’Œè‹¹æœæ™ºèƒ½ä¸­çš„åè®®ä¸å˜ã€‚Geminiæ˜¯æ¥é©±åŠ¨åŸºç¡€æ¨¡å‹å’Œä¸‹ä¸€ä»£Siriæ ¸å¿ƒèƒ½åŠ›çš„ï¼Œè€ŒOpenAIåˆ™å¤„ç†æŸäº›ç‰¹å®šç±»å‹çš„å¤æ‚æŸ¥è¯¢ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41bf68db613643c7af6571fa9bb62401~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pG46bG855qE5pil5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769249784&amp;x-signature=Woj4d77HWrwxYapNn0fGF4ktNCs%3D" alt="" loading="lazy"/>
è‹¹æœæœ¬è´¨ä¸Šæ˜¯åœ¨Siriå†…éƒ¨æ„å»ºä¸€ä¸ªAIè·¯ç”±ç³»ç»Ÿã€‚å®ƒæƒ³ä¿æŒè‡ªå·±éšç§ã€æœ¬åœ°å¤„ç†ã€ä¸¥æ ¼æ§åˆ¶çš„ä¸€è´¯èº«ä»½ï¼Œä½†åœ¨åº•å±‚æ¨¡å‹ä¸Šï¼Œå®ƒé€‰æ‹©ä¾é è°·æ­Œçš„å †æ ˆï¼ŒåŒæ—¶ä¹Ÿä¸æ’æ–¥æ¥å…¥å…¶ä»–å¼ºè€…ã€‚</p>
<p>è¿™ä¸ªå†³å®šçš„èƒŒæ™¯å¾ˆæœ‰æ„æ€ã€‚è°·æ­Œæ¯å…¬å¸Alphabetçš„å¸‚å€¼åˆšè¶…è¿‡è‹¹æœï¼Œè¿™æ˜¯2019å¹´ä»¥æ¥çš„ç¬¬ä¸€æ¬¡ã€‚åŒæ—¶ï¼Œè°·æ­Œå’Œè‹¹æœä¹‹é—´é‚£ä¸ªè‘—åçš„æœç´¢é»˜è®¤åè®®ï¼Œæ­£å› å„æ–­é—®é¢˜è¢«ç¾å›½æ³•é™¢å®¡è§†ã€‚</p>
<p>ä½†å³ä¾¿åœ¨è¿™ç§å‹åŠ›ä¸‹ï¼Œè°·æ­Œä¾ç„¶é€šè¿‡AIï¼ŒæŠŠè‡ªå·±çš„è§¦è§’æ›´æ·±åœ°ä¼¸è¿›äº†è‹¹æœç”Ÿæ€ã€‚Siriæ¯å¤©åœ¨è¶…è¿‡20äº¿å°æ´»è·ƒè®¾å¤‡ä¸Šå¤„ç†10äº¿æ¬¡è¯·æ±‚ï¼Œè¿™ä¸ªåˆ†å‘æ¸ é“æ˜¯è°·æ­Œé è‡ªå·±æ°¸è¿œæ— æ³•å¤åˆ¶çš„ã€‚</p>
<p>è‹¹æœè¯„ä¼°è¿‡Anthropicï¼Œæœ€ç»ˆé€‰äº†è°·æ­Œã€‚æœ‰æ¶ˆæ¯è¯´ï¼Œè´¢åŠ¡æ¡æ¬¾æ˜¯é‡è¦è€ƒé‡ã€‚è¿™ä¸å†æ˜¯åŠŸèƒ½åˆä½œï¼Œè€Œæ˜¯åŸºç¡€è®¾æ–½å±‚é¢çš„ç»‘å®šã€‚AIç«èµ›ï¼Œå·²ç»è¿›å…¥äº†å·¨å¤´ç»“ç›Ÿçš„æ–°é˜¶æ®µã€‚</p>
<h2 data-id="heading-2">ä»æ¡Œé¢åˆ°ç°å®ï¼ŒAIä»£ç†å¼€å§‹åŠ¨æ‰‹</h2>
<p>å½“å·¨å¤´ä»¬åœ¨äº‘ç«¯ç»“ç›Ÿæ—¶ï¼ŒAIä¹Ÿåœ¨å˜å¾—æ›´å…·ä½“ã€æ›´â€œåŠ¨æ‰‹â€ã€‚</p>
<p>Anthropicç»™Claudeæ¨å‡ºäº†ä¸€ä¸ªå«â€œCoWorkâ€çš„åŠŸèƒ½ï¼Œç›®å‰æ˜¯ç ”ç©¶é¢„è§ˆç‰ˆï¼Œåªç»™Macç‰ˆClaudeçš„è®¢é˜…ç”¨æˆ·ã€‚è¿™ä¸ªåŠŸèƒ½å¾ˆç®€å•ï¼Œä½ æˆæƒClaudeè®¿é—®ä½ Macä¸Šçš„æŸä¸ªæ–‡ä»¶å¤¹ï¼Œä¹‹åå®ƒå°±èƒ½ç›´æ¥åœ¨é‡Œé¢è¯»å–ã€ç¼–è¾‘ã€åˆ›å»ºæ–‡ä»¶ã€‚</p>
<p>è¿™å¬èµ·æ¥ç®€å•ï¼Œä½†åŒºåˆ«å·¨å¤§ã€‚èŠå¤©åŠ©æ‰‹æ˜¯ç»™ä½ å»ºè®®ï¼Œè€Œä»£ç†æ˜¯ç›´æ¥è§¦ç¢°ä½ çš„èµ„äº§å¹¶äº§å‡ºç»“æœã€‚CoWorkè®¾è®¡ç”¨æ¥å¤„ç†å¤šæ­¥éª¤é¡¹ç›®ï¼Œæ¯”å¦‚æ•´ç†æ–‡ä»¶ã€ä»å›¾ç‰‡é‡Œæå–æ•°æ®ã€æŠŠé›¶æ•£çš„ç¬”è®°ç”ŸæˆæŠ¥å‘Šã€‚ä½ å¯ä»¥å®æ—¶åé¦ˆï¼Œå®ƒè¿˜èƒ½é€šè¿‡è¿æ¥å™¨è°ƒç”¨å¤–éƒ¨æ•°æ®æˆ–æ§åˆ¶æµè§ˆå™¨å·¥ä½œæµã€‚</p>
<p>é£é™©æ˜¯æ˜¾ç„¶çš„ï¼Œæ‰€ä»¥Anthropicå¼ºè°ƒäº†å®‰å…¨æ§åˆ¶ã€‚ç”¨æˆ·å†³å®šClaudeèƒ½è®¿é—®å“ªäº›æ–‡ä»¶å¤¹ï¼Œåœ¨åˆ é™¤æ–‡ä»¶è¿™ç±»é‡å¤§æ“ä½œå‰ï¼ŒåŠ©æ‰‹ä¼šè¯·æ±‚è®¸å¯ã€‚ä»–ä»¬ç”šè‡³æåˆ°äº†â€œæç¤ºè¯æ³¨å…¥â€é£é™©â€”â€”æ¶æ„æ–‡æ¡£æˆ–ç½‘é¡µå¯èƒ½åµŒå…¥æŒ‡ä»¤ï¼Œè¯•å›¾åŠ«æŒä»£ç†ã€‚ç›®å‰è¿™åŠŸèƒ½è¿˜é™äºç¾å›½åŒºçš„macOSã€‚</p>
<p>å¦ä¸€å®¶å…¬å¸Manusï¼Œåˆ™ç„å‡†äº†æ¯”ç”µè„‘æ¡Œé¢æ›´æ™®éçš„åœºæ™¯ï¼šç°å®ä¸­çš„å¯¹è¯ã€‚ä»–ä»¬æ¨å‡ºäº†â€œä¼šè®®çºªè¦â€åŠŸèƒ½ï¼Œä¸“é—¨é’ˆå¯¹çº¿ä¸‹é¢å¯¹é¢ä¼šè®®ã€è®¿è°ˆï¼Œè€Œä¸æ˜¯çº¿ä¸Šä¼šè®®ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d63c64dd401b492d92a39e58033294f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pG46bG855qE5pil5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769249784&amp;x-signature=WK9tfqhxXppQ26GTdwdunZvG6HY%3D" alt="" loading="lazy"/>
å®ƒå®æ—¶å½•éŸ³ï¼Œç„¶åäº§å‡ºç»“æ„åŒ–å†…å®¹ï¼šæ‘˜è¦ã€å‘è¨€äººè¯†åˆ«ã€å‚ä¼šè€…åˆ—è¡¨ã€å¯æ‰§è¡Œä»»åŠ¡ã€‚ä¸¤ä¸ªç»†èŠ‚å¾ˆå…³é”®ï¼Œä¸€æ˜¯æ”¯æŒç¦»çº¿å½•éŸ³ï¼Œç½‘ç»œæ–­äº†ä¹Ÿä¸å½±å“ï¼ŒäºŒæ˜¯èƒ½å°è¯•è¯†åˆ«è°è¯´äº†ä»€ä¹ˆï¼Œä»¥ä¾¿æŠŠä»»åŠ¡é¡¹å‡†ç¡®åˆ†é…ç»™äººã€‚</p>
<p>Manusè¿˜æƒ³æŠŠâ€œè¯´åˆ°åšåˆ°â€çš„é—­ç¯æ‰“é€šï¼Œå®ƒèƒ½ç›´æ¥ä»ä¼šè®®ç¬”è®°åœ¨åŒä¸€ä¸ªå·¥ä½œæµé‡Œç”Ÿæˆäº¤ä»˜ç‰©ï¼Œæ¯”å¦‚æ¼”ç¤ºæ–‡ç¨¿ã€ç½‘ç«™æˆ–ç¤¾äº¤åª’ä½“ç´ æã€‚å•†ä¸šæ¨¡å¼æ˜¯ç§¯åˆ†åˆ¶ï¼Œå½•éŸ³å…è´¹ï¼Œä½†åˆ†æå’Œç»“æ„åŒ–è¾“å‡ºè¦èŠ±ç§¯åˆ†ã€‚ä»·å€¼æ˜¾ç„¶åœ¨â€œæ€è€ƒâ€éƒ¨åˆ†ï¼Œè€Œä¸åªæ˜¯è®°å½•ã€‚</p>
<h2 data-id="heading-3">æœºå™¨äººå­¦ä¼šâ€œé¢„æ¼”â€ï¼Œè°·æ­Œæƒ³å®šä¹‰AIè´­ç‰©</h2>
<p>ä»è™šæ‹Ÿä»£ç†åˆ°å®ä½“æœºå™¨äººï¼Œé€»è¾‘æ˜¯ç›¸é€šçš„ã€‚æœºå™¨äººå…¬å¸1Xå°†å…¶æ–°çš„è§†é¢‘é¢„è®­ç»ƒä¸–ç•Œæ¨¡å‹é›†æˆåˆ°äº†Neoæœºå™¨äººå¹³å°ã€‚</p>
<p>ä¼ ç»Ÿæœºå™¨äººè®­ç»ƒå¾€å¾€ä¾èµ–æµ·é‡çš„æœºå™¨äººæ¼”ç¤ºæ•°æ®ï¼Œè®©æœºå™¨äººåå¤åšåŠ¨ä½œï¼Œæ…¢ä¸”è´µã€‚1Xçš„æ–°æ–¹æ³•ï¼Œç»“åˆäº†äº’è”ç½‘è§†é¢‘å’Œâ€œè‡ªæˆ‘ä¸­å¿ƒâ€çš„äººç±»ä¸æœºå™¨äººæ•°æ®ã€‚è‡ªæˆ‘ä¸­å¿ƒæ•°æ®ï¼Œå°±æ˜¯ç¬¬ä¸€äººç§°è§†è§’ã€‚</p>
<p>è¿™ä¸ªæ¨¡å‹é€šè¿‡ç”Ÿæˆæ–‡æœ¬æ¡ä»¶ä¸‹çš„è§†é¢‘æ¨æ¼”æ¥é¢„æµ‹æœºå™¨äººåŠ¨ä½œï¼Œç„¶åå†é€šè¿‡é€†å‘åŠ¨åŠ›å­¦æŠŠè§†é¢‘è½¬æ¢æˆè¿åŠ¨æŒ‡ä»¤ã€‚ç®€å•è¯´ï¼ŒAIä¸ä»…åœ¨çœ‹ï¼Œè¿˜åœ¨é¢„æµ‹â€œåšä»€ä¹ˆåŠ¨ä½œä¼šå¯¼è‡´ä»€ä¹ˆè§†è§‰ç»“æœâ€ï¼Œç„¶åæ®æ­¤æ§åˆ¶èº«ä½“ã€‚</p>
<p>ç›®å‰æ¯æ¬¡æ¨æ¼”æ¨ç†å¤§çº¦éœ€è¦11ç§’ï¼Œè¿™è¯´æ˜æŠ€æœ¯è¿˜æ²¡åˆ°ç¬é—´è‡ªä¸»ååº”çš„çº§åˆ«ã€‚ä½†å¥½å¤„æ˜¯æ³›åŒ–èƒ½åŠ›æ›´å¼ºï¼Œå¯¹äºè®­ç»ƒæ•°æ®é‡Œæ²¡æœ‰çš„æ–°ç‰©ä½“å’Œæ–°åŠ¨ä½œï¼Œå¤„ç†å¾—æ›´å¥½ã€‚å†…éƒ¨æµ‹è¯•æ˜¾ç¤ºï¼Œå®ƒåœ¨åŒæ‰‹åè°ƒã€å¤æ‚ç‰©ä½“æ“æ§ç­‰ä»»åŠ¡ä¸Šï¼ŒæˆåŠŸç‡åŒ¹é…æˆ–è¶…è¿‡äº†ä»¥å‰çš„æ¨¡å‹ã€‚</p>
<p>æœ€åï¼Œæ˜¯è°·æ­Œå¯èƒ½åŸ‹ä¸‹çš„ä¸€ä¸ªæœ€æ·±çš„åŸºç¡€è®¾æ–½ã€‚å®ƒæ­£å¼å®£å¸ƒè¿›å…¥â€œAIå•†åŠ¡â€é˜¶æ®µï¼Œæ ¸å¿ƒæ˜¯æ¨å‡ºâ€œé€šç”¨å•†åŠ¡åè®®â€ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªæ–°çš„å¼€æ”¾æ ‡å‡†ï¼Œæ—¨åœ¨ä¸ºAIä»£ç†ã€å•†å®¶å’Œæ”¯ä»˜ç³»ç»Ÿä¹‹é—´çš„äº¤äº’æä¾›é€šç”¨è¯­è¨€ã€‚è°·æ­Œä¸Shopifyã€æ²ƒå°”ç›ã€Targetã€eBayç­‰å¤§å…¬å¸åˆä½œå¼€å‘ã€‚å®ƒå…¼å®¹ç°æœ‰çš„å…¶ä»–åè®®ï¼Œè¿™æ„å‘³ç€å®ƒèƒ½æ¥å…¥ç°æœ‰ç”Ÿæ€ï¼Œè€Œä¸æ˜¯æ¨å€’é‡æ¥ã€‚</p>
<p>ä¸€ä¸ªæœ€ç›´æ¥çš„åº”ç”¨ï¼Œå°±æ˜¯ç”¨æˆ·åœ¨ç¾å›½å¯ä»¥é€šè¿‡è°·æ­Œçš„AIæœç´¢æ¨¡å¼å’ŒGeminiåº”ç”¨ï¼Œç›´æ¥è´­ä¹°åˆä½œé›¶å”®å•†çš„å•†å“ï¼Œä½¿ç”¨è°·æ­Œé’±åŒ…æˆ–PayPalæ”¯ä»˜ã€‚é›¶å”®å•†ä¾ç„¶æ˜¯é”€å”®ä¸»ä½“ï¼Œä¿ç•™å®šåˆ¶é›†æˆçš„èƒ½åŠ›ã€‚</p>
<p>è°·æ­Œè¿˜åœ¨æ¨å‡ºâ€œå•†åŠ¡ä»£ç†â€ï¼Œè®©å“ç‰Œèƒ½åœ¨æœç´¢ç»“æœä¸­ç›´æ¥ä»¥è™šæ‹Ÿè´­ç‰©åŠ©æ‰‹çš„å½¢æ€ä¸é¡¾å®¢äº’åŠ¨ï¼Œç”¨å“ç‰Œè‡ªå·±çš„é£æ ¼å›ç­”é—®é¢˜ã€‚ç¬¬ä¸€é˜¶æ®µåŒ…æ‹¬åŠ³æ°ã€é”æ­¥ç­‰å“ç‰Œã€‚</p>
<p>è°·æ­Œåšçš„ï¼Œæ˜¯åœ¨åè®®å±‚å°è¯•æ ‡å‡†åŒ–AIè´­ç‰©ï¼ŒæŠŠå®ƒåµŒå…¥Geminiå’ŒAIæœç´¢ï¼Œå¹¶ç»™å•†å®¶åœ¨æœç´¢ç»“æœé‡Œæä¾›ä»£ç†ç•Œé¢ã€‚è¿™æ˜¯åŸºç¡€è®¾æ–½çº§åˆ«çš„å¸ƒå±€ã€‚</p>
<h2 data-id="heading-4">æ‰€ä»¥ï¼Œæœªæ¥æ˜¯ä»€ä¹ˆæ ·</h2>
<p>æŠŠè¿™äº›ç¢ç‰‡æ‹¼èµ·æ¥ï¼Œç”»é¢å°±æ¸…æ™°äº†ã€‚</p>
<p><strong>ç«äº‰æ˜¯å…¨çƒåŒ–çš„ï¼Œä½†æ‰“æ³•åˆ†æˆäº†ä¸¤ç§ã€‚</strong> ä¸€ç§æ˜¯ä»¥å¾®è½¯æŠ¥å‘Šä¸ºä»£è¡¨çš„è§‚å¯Ÿï¼šåœ¨é«˜ç«¯å¸‚åœºä¹‹å¤–ï¼Œæ€§ä»·æ¯”å’Œå¯è·å–æ€§æ­£åœ¨æˆä¸ºå†³å®šæ€§å› ç´ ï¼Œå‚¬ç”Ÿæ–°çš„ç”Ÿæ€ä¸»å¯¼è€…ã€‚</p>
<p><strong>è”ç›Ÿæ˜¯å¿…ç„¶çš„ï¼Œæ²¡æœ‰å…¨èƒ½é€‰æ‰‹ã€‚</strong> å¼ºå¦‚è‹¹æœï¼Œä¹Ÿéœ€è¦åœ¨åº•å±‚æ¨¡å‹ä¸Šä¾é è°·æ­Œï¼Œå¹¶æ¥å…¥OpenAIã€‚æœªæ¥çš„AIæœåŠ¡ï¼Œå¾ˆå¯èƒ½æ˜¯ä¸€ä¸ªç”±å¤šå®¶ä¾›åº”å•†æ¨¡å‹é©±åŠ¨çš„æ··åˆä½“ï¼Œå…³é”®åœ¨äºè°èƒ½åšå¥½è·¯ç”±å’Œæ•´åˆã€‚</p>
<p><strong>AIæ­£åœ¨ä»â€œè¯´â€èµ°å‘â€œåšâ€ã€‚</strong> æ— è®ºæ˜¯æ“ä½œä½ çš„ç”µè„‘æ–‡ä»¶ï¼Œå¤„ç†çº¿ä¸‹ä¼šè®®ï¼Œæ§åˆ¶æœºå™¨äººæ‰‹è‡‚ï¼Œè¿˜æ˜¯å¸®ä½ å®Œæˆè´­ç‰©ï¼ŒAIä»£ç†å¼€å§‹æ‹¥æœ‰æ‰§è¡Œæƒã€‚è¿™å¸¦æ¥äº†å·¨å¤§çš„ä¾¿åˆ©ï¼Œä¹Ÿå¸¦æ¥äº†å…¨æ–°çš„å®‰å…¨å’Œä¼¦ç†æŒ‘æˆ˜ã€‚</p>
<p><strong>æ ‡å‡†åè®®æ˜¯éšè—çš„æˆ˜åœºã€‚</strong> è°·æ­Œæ¨é€šç”¨å•†åŠ¡åè®®ï¼Œæ˜¯æƒ³åœ¨AIä»£ç†å¦‚ä½•ä¸å•†ä¸šä¸–ç•Œäº¤äº’è¿™ä¸ªæ ¹æœ¬é—®é¢˜ä¸Šï¼Œå®šä¹‰è§„åˆ™ã€‚è°å®šä¹‰äº†åè®®ï¼Œè°å°±æŒæ¡äº†ç”Ÿæ€çš„æ¢çº½ä½ç½®ã€‚</p>
<p>æˆ‘ä»¬æ­£åœ¨ç»å†çš„ï¼Œä¸æ˜¯å•ä¸ªäº§å“çš„å‡çº§ï¼Œè€Œæ˜¯ä¸€æ•´ä¸ªæ•°å­—ä¸–ç•Œè¿è¡Œè§„åˆ™çš„è¿ç§»ã€‚AIæ­£åœ¨ä»ä¸€é¡¹æŠ€æœ¯ï¼Œå˜æˆæˆ‘ä»¬ä¸æ‰€æœ‰æœºå™¨ã€æ‰€æœ‰ä¿¡æ¯ã€æ‰€æœ‰å•†ä¸šæ´»åŠ¨äº¤äº’çš„æ–°ç•Œé¢ã€‚</p>
<p>è¿™ä¸ªç•Œé¢å¦‚ä½•å·¥ä½œï¼Œç”±è°å®šä¹‰ï¼Œåˆå°†è¢«è°ä¸»å¯¼ï¼Œå°±æ˜¯æœªæ¥åå¹´ç§‘æŠ€ç«äº‰çš„æ ¸å¿ƒæ•…äº‹ã€‚æ•…äº‹æ‰åˆšåˆšç¿»å¼€ç¬¬ä¸€ç« ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å›é¡¾æµ®åŠ¨å¸ƒå±€]]></title>    <link>https://juejin.cn/post/7595859552347963444</link>    <guid>https://juejin.cn/post/7595859552347963444</guid>    <pubDate>2026-01-17T07:50:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595859552347963444" data-draft-id="7595871887000813568" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å›é¡¾æµ®åŠ¨å¸ƒå±€"/> <meta itemprop="keywords" content="CSS,é¢è¯•,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-17T07:50:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¿›å‡»çš„æ˜æ˜"/> <meta itemprop="url" content="https://juejin.cn/user/1159300977801081"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å›é¡¾æµ®åŠ¨å¸ƒå±€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1159300977801081/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¿›å‡»çš„æ˜æ˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T07:50:18.000Z" title="Sat Jan 17 2026 07:50:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>åœ¨ç°ä»£ Web å¼€å‘ä¸­ï¼Œè™½ç„¶ Flexbox å’Œ Grid å·²æˆä¸ºä¸»æµå¸ƒå±€æ–¹æ¡ˆï¼Œä½†Â <strong>CSS æµ®åŠ¨ï¼ˆfloatï¼‰</strong> Â ä½œä¸ºæ—©æœŸå®ç°ç½‘é¡µå¤šåˆ—å¸ƒå±€çš„æ ¸å¿ƒæŠ€æœ¯ï¼Œä»ç„¶å…·æœ‰é‡è¦çš„å†å²åœ°ä½å’Œå®ç”¨ä»·å€¼ã€‚å°¤å…¶åœ¨å¤„ç†å›¾æ–‡æ··æ’ã€æ—§é¡¹ç›®ç»´æŠ¤æˆ–å…¼å®¹æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ä¸­ï¼ŒæŒæ¡æµ®åŠ¨å¸ƒå±€ä¾ç„¶æ˜¯å‰ç«¯å¼€å‘è€…çš„å¿…å¤‡æŠ€èƒ½ã€‚</p>
<p>æœ¬æ–‡å°†ä»åŸç†ã€è¡Œä¸ºã€å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆç­‰æ–¹é¢ï¼Œç³»ç»Ÿè®²è§£ CSS æµ®åŠ¨å¸ƒå±€ã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€ä»€ä¹ˆæ˜¯æµ®åŠ¨ï¼ˆFloatï¼‰ï¼Ÿ</h2>
<p><code>float</code>Â æ˜¯ CSS ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œæœ€åˆè®¾è®¡ç”¨äºå®ç°<strong>æ–‡æœ¬ç¯ç»•å›¾ç‰‡</strong>çš„æ•ˆæœã€‚å…¶åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">element {
  <span class="hljs-type">float</span>: <span class="hljs-keyword">left</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">right</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">none</span> <span class="hljs-operator">|</span> inherit;
}
</code></pre>
<ul>
<li><code>left</code>ï¼šå…ƒç´ å‘å·¦æµ®åŠ¨ï¼›</li>
<li><code>right</code>ï¼šå…ƒç´ å‘å³æµ®åŠ¨ï¼›</li>
<li><code>none</code>ï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå…ƒç´ ä¸æµ®åŠ¨ï¼›</li>
<li><code>inherit</code>ï¼šç»§æ‰¿çˆ¶å…ƒç´ çš„æµ®åŠ¨è®¾ç½®ã€‚</li>
</ul>
<h3 data-id="heading-2">ç¤ºä¾‹ï¼šåŸºç¡€æµ®åŠ¨</h3>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">img</span> <span class="hljs-attribute">src</span>="example<span class="hljs-selector-class">.jpg</span>" style="<span class="hljs-attribute">float</span>: left; <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span>;"&gt;
&lt;<span class="hljs-selector-tag">p</span>&gt;è¿™æ˜¯ä¸€æ®µæ–‡å­—ï¼Œä¼šç¯ç»•åœ¨å›¾ç‰‡å³ä¾§â€¦â€¦&lt;/<span class="hljs-selector-tag">p</span>&gt;
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå›¾ç‰‡è„±ç¦»äº†æ­£å¸¸æ–‡æ¡£æµå¹¶å‘å·¦æµ®åŠ¨ï¼Œæ–‡å­—åˆ™å›´ç»•åœ¨å…¶å³ä¾§æµåŠ¨ã€‚</p>
<hr/>
<h2 data-id="heading-3">äºŒã€æµ®åŠ¨çš„æ ¸å¿ƒè¡Œä¸º</h2>
<p>è¦çœŸæ­£æŒæ¡æµ®åŠ¨ï¼Œå¿…é¡»ç†è§£å®ƒçš„ä¸‰ä¸ªå…³é”®ç‰¹æ€§ï¼š</p>
<h3 data-id="heading-4">1. è„±ç¦»æ­£å¸¸æ–‡æ¡£æµï¼ˆä½†ä»åœ¨é¡µé¢ä¸­ï¼‰</h3>
<p>æµ®åŠ¨å…ƒç´ ä¼š<strong>è„±ç¦»å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼ˆBFCï¼‰ä¸­çš„æ­£å¸¸æµ</strong>ï¼Œä¸å†å æ®åŸæ¥çš„ç©ºé—´ï¼ˆå¯¹åç»­å—çº§å…ƒç´ è€Œè¨€ï¼‰ï¼Œä½†<strong>ä»ä¼šå½±å“è¡Œå†…å†…å®¹çš„æ’å¸ƒ</strong>ï¼ˆå¦‚æ–‡å­—ç¯ç»•ï¼‰ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šæµ®åŠ¨å…ƒç´ å¹¶æœªå®Œå…¨â€œæ¶ˆå¤±â€ï¼Œå®ƒä¾ç„¶å­˜åœ¨äºæ¸²æŸ“æ ‘ä¸­ï¼Œå¹¶å‚ä¸å¸ƒå±€è®¡ç®—ã€‚</p>
</blockquote>
<h3 data-id="heading-5">2. å‘å·¦/å³å°½å¯èƒ½é è¾¹</h3>
<p>æµ®åŠ¨å…ƒç´ ä¼šå‘æŒ‡å®šæ–¹å‘ç§»åŠ¨ï¼Œç›´åˆ°ç¢°åˆ°<strong>åŒ…å«å—çš„è¾¹ç•Œ</strong>æˆ–<strong>å¦ä¸€ä¸ªæµ®åŠ¨å…ƒç´ </strong>ä¸ºæ­¢ã€‚</p>
<h3 data-id="heading-6">3. å—çº§å…ƒç´ â€œåå¡Œâ€é—®é¢˜</h3>
<p>å½“ä¸€ä¸ªå®¹å™¨å†…çš„æ‰€æœ‰å­å…ƒç´ éƒ½æµ®åŠ¨æ—¶ï¼Œè¯¥å®¹å™¨<strong>é«˜åº¦ä¼šå˜ä¸º 0</strong>ï¼ˆå³â€œé«˜åº¦åå¡Œâ€ï¼‰ã€‚è¿™æ˜¯å› ä¸ºæµ®åŠ¨å…ƒç´ è„±ç¦»äº†æ­£å¸¸æµï¼Œçˆ¶å®¹å™¨æ— æ³•æ„ŸçŸ¥å…¶é«˜åº¦ã€‚</p>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">div</span> class="container"&gt;
  &lt;<span class="hljs-selector-tag">div</span> style="<span class="hljs-attribute">float</span>: left; <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>; <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>; <span class="hljs-attribute">background</span>: red;"&gt;&lt;/<span class="hljs-selector-tag">div</span>&gt;
  &lt;<span class="hljs-selector-tag">div</span> style="<span class="hljs-attribute">float</span>: left; <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>; <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>; <span class="hljs-attribute">background</span>: blue;"&gt;&lt;/<span class="hljs-selector-tag">div</span>&gt;
&lt;/<span class="hljs-selector-tag">div</span>&gt;
&lt;!-- <span class="hljs-selector-class">.container</span> é«˜åº¦ä¸º <span class="hljs-number">0</span> --&gt;
</code></pre>
<p>è¿™ä¸ªé—®é¢˜éœ€è¦é€šè¿‡<strong>æ¸…é™¤æµ®åŠ¨ï¼ˆClearfixï¼‰</strong> Â æ¥è§£å†³ã€‚</p>
<hr/>
<h2 data-id="heading-7">ä¸‰ã€æ¸…é™¤æµ®åŠ¨ï¼ˆClearing Floatsï¼‰</h2>
<p>ä¸ºäº†è§£å†³çˆ¶å®¹å™¨é«˜åº¦åå¡Œçš„é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦â€œæ¸…é™¤æµ®åŠ¨â€ã€‚å¸¸ç”¨æ–¹æ³•æœ‰ï¼š</p>
<h3 data-id="heading-8">æ–¹æ³• 1ï¼šä½¿ç”¨Â <code>clear</code>Â å±æ€§</h3>
<p><code>clear: both</code>Â æ˜¯ CSS ä¸­ç”¨äº<strong>æ§åˆ¶å…ƒç´ ä¸æµ®åŠ¨å…ƒç´ ä¹‹é—´å…³ç³»</strong>çš„ä¸€ä¸ªå±æ€§å€¼ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼š<strong>å¼ºåˆ¶è¯¥å…ƒç´ ä¸ä¸ä»»ä½•å·¦ä¾§æˆ–å³ä¾§çš„æµ®åŠ¨å…ƒç´ å¤„äºåŒä¸€è¡Œ</strong>ï¼Œå³â€œæ¸…é™¤æµ®åŠ¨â€çš„å½±å“ã€‚</p>
<p>åœ¨æµ®åŠ¨å…ƒç´ åæ·»åŠ ä¸€ä¸ªç©ºå…ƒç´ å¹¶è®¾ç½®Â <code>clear: both</code>ï¼š</p>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">div</span> class="container"&gt;
  &lt;<span class="hljs-selector-tag">div</span> style="<span class="hljs-attribute">float</span>: left;"&gt;<span class="hljs-selector-tag">A</span>&lt;/<span class="hljs-selector-tag">div</span>&gt;
  &lt;<span class="hljs-selector-tag">div</span> style="<span class="hljs-attribute">float</span>: left;"&gt;<span class="hljs-selector-tag">B</span>&lt;/<span class="hljs-selector-tag">div</span>&gt;
  &lt;<span class="hljs-selector-tag">div</span> style="<span class="hljs-attribute">clear</span>: both;"&gt;&lt;/<span class="hljs-selector-tag">div</span>&gt;
&lt;/<span class="hljs-selector-tag">div</span>&gt;
</code></pre>
<blockquote>
<p>ç¼ºç‚¹ï¼šå¼•å…¥æ— è¯­ä¹‰çš„ HTML å…ƒç´ ã€‚</p>
</blockquote>
<h3 data-id="heading-9">æ–¹æ³• 2ï¼šä½¿ç”¨ä¼ªå…ƒç´ ï¼ˆæ¨è â€”â€” Clearfix æŠ€å·§ï¼‰</h3>
<pre><code class="hljs language-css" lang="css">clearfix<span class="hljs-selector-pseudo">::after</span> {
  <span class="hljs-attribute">content</span>: <span class="hljs-string">""</span>;
  <span class="hljs-attribute">display</span>: table;
  <span class="hljs-attribute">clear</span>: both;
}
</code></pre>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">div</span> class="container clearfix"&gt;
  &lt;<span class="hljs-selector-tag">div</span> style="<span class="hljs-attribute">float</span>: left;"&gt;<span class="hljs-selector-tag">A</span>&lt;/<span class="hljs-selector-tag">div</span>&gt;
  &lt;<span class="hljs-selector-tag">div</span> style="<span class="hljs-attribute">float</span>: left;"&gt;<span class="hljs-selector-tag">B</span>&lt;/<span class="hljs-selector-tag">div</span>&gt;
&lt;/<span class="hljs-selector-tag">div</span>&gt;
</code></pre>
<p>è¿™æ˜¯æœ€ç»å…¸çš„Â <strong>clearfix</strong>Â è§£å†³æ–¹æ¡ˆï¼Œå…¼å®¹æ€§å¥½ä¸”è¯­ä¹‰æ¸…æ™°ã€‚</p>
<h3 data-id="heading-10">æ–¹æ³• 3ï¼šè§¦å‘ BFCï¼ˆBlock Formatting Contextï¼‰</h3>
<p>è®©çˆ¶å®¹å™¨å½¢æˆä¸€ä¸ªæ–°çš„ BFCï¼Œä½¿å…¶èƒ½åŒ…å«æµ®åŠ¨å­å…ƒç´ ã€‚å¸¸è§æ–¹å¼åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>overflow: hidden</code>Â /Â <code>auto</code></li>
<li><code>display: flow-root</code>ï¼ˆç°ä»£æµè§ˆå™¨ï¼‰</li>
<li><code>float: left/right</code></li>
<li><code>position: absolute/fixed</code></li>
</ul>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.container</span> {
  <span class="hljs-attribute">overflow</span>: hidden; <span class="hljs-comment">/* è§¦å‘ BFC */</span>
}
</code></pre>
<blockquote>
<p>æ¨èåœ¨ç°ä»£é¡¹ç›®ä¸­ä½¿ç”¨Â <code>display: flow-root</code>ï¼Œå®ƒä¸“ä¸ºè§£å†³æ­¤é—®é¢˜è€Œç”Ÿï¼Œä¸”ä¸ä¼šå¸¦æ¥å‰¯ä½œç”¨ï¼ˆå¦‚è£å‰ªå†…å®¹ï¼‰ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-11">å››ã€æµ®åŠ¨å¸ƒå±€çš„å…¸å‹åº”ç”¨åœºæ™¯</h2>
<p>å°½ç®¡ Flex/Grid æ›´å¼ºå¤§ï¼Œä½†æµ®åŠ¨ä»æœ‰å…¶ç”¨æ­¦ä¹‹åœ°ï¼š</p>
<h3 data-id="heading-12">1. å›¾æ–‡æ··æ’</h3>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">img</span> {
  <span class="hljs-attribute">float</span>: left;
  <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">15px</span>;
}
</code></pre>
<p>è¿™æ˜¯æµ®åŠ¨æœ€åˆçš„è®¾è®¡ç›®çš„ï¼Œè‡³ä»Šä»éå¸¸é«˜æ•ˆã€‚</p>
<h3 data-id="heading-13">2. ç®€å•çš„å¤šåˆ—å¸ƒå±€ï¼ˆæ—§é¡¹ç›®ï¼‰</h3>
<p>åœ¨ Flexbox å‡ºç°å‰ï¼Œå¼€å‘è€…å¸¸é€šè¿‡æµ®åŠ¨å®ç°ä¸¤æ æˆ–ä¸‰æ å¸ƒå±€ï¼š</p>
<pre><code class="hljs language-css" lang="css">sidebar { <span class="hljs-attribute">float</span>: left; <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>; }
<span class="hljs-selector-tag">main</span> { <span class="hljs-attribute">float</span>: right; <span class="hljs-attribute">width</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100%</span> - <span class="hljs-number">200px</span>); }
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼šéœ€å¤„ç†æ¸…é™¤æµ®åŠ¨å’Œå“åº”å¼é€‚é…ã€‚</p>
</blockquote>
<h3 data-id="heading-14">3. åˆ—è¡¨é¡¹æ¨ªå‘æ’åˆ—ï¼ˆå¦‚å¯¼èˆªèœå•ï¼‰</h3>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">nav</span> <span class="hljs-selector-tag">li</span> {
  <span class="hljs-attribute">float</span>: left;
  <span class="hljs-attribute">list-style</span>: none;
}
<span class="hljs-selector-tag">nav</span><span class="hljs-selector-pseudo">::after</span> {
  <span class="hljs-attribute">content</span>: <span class="hljs-string">""</span>;
  <span class="hljs-attribute">display</span>: table;
  <span class="hljs-attribute">clear</span>: both;
}
</code></pre>
<hr/>
<h2 data-id="heading-15">äº”ã€æµ®åŠ¨çš„å±€é™æ€§ä¸æ›¿ä»£æ–¹æ¡ˆ</h2>
<h3 data-id="heading-16">å±€é™æ€§ï¼š</h3>
<ul>
<li>å®¹æ˜“å¼•å‘é«˜åº¦åå¡Œï¼›</li>
<li>å¸ƒå±€é€»è¾‘å¤æ‚ï¼Œè°ƒè¯•å›°éš¾ï¼›</li>
<li>ä¸æ”¯æŒå‚ç›´å±…ä¸­ã€ç­‰é«˜åˆ—ç­‰å¸¸è§éœ€æ±‚ï¼›</li>
<li>å“åº”å¼é€‚é…èƒ½åŠ›å¼±ã€‚</li>
</ul>
<h3 data-id="heading-17">ç°ä»£æ›¿ä»£æ–¹æ¡ˆï¼š</h3>

























<table><thead><tr><th>éœ€æ±‚</th><th>æ¨èæ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>å¤šåˆ—å¸ƒå±€</td><td>CSS Grid</td></tr><tr><td>å•è¡Œ/å•åˆ—å¼¹æ€§å¸ƒå±€</td><td>Flexbox</td></tr><tr><td>å›¾æ–‡ç¯ç»•</td><td>ä»å¯ç”¨Â <code>float</code>ï¼Œæˆ–ç»“åˆÂ <code>shape-outside</code></td></tr><tr><td>å®¹å™¨åŒ…å«æµ®åŠ¨å­å…ƒç´ </td><td><code>display: flow-root</code></td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯è·¯ç”±ä¸å†éš¾ï¼šReact Router ä»å…¥é—¨åˆ°å·¥ç¨‹åŒ–]]></title>    <link>https://juejin.cn/post/7595911076014112804</link>    <guid>https://juejin.cn/post/7595911076014112804</guid>    <pubDate>2026-01-17T08:05:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595911076014112804" data-draft-id="7595911076014096420" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯è·¯ç”±ä¸å†éš¾ï¼šReact Router ä»å…¥é—¨åˆ°å·¥ç¨‹åŒ–"/> <meta itemprop="keywords" content="React.js,å‰ç«¯æ¡†æ¶,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-17T08:05:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="xhxxx"/> <meta itemprop="url" content="https://juejin.cn/user/3235201610941578"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯è·¯ç”±ä¸å†éš¾ï¼šReact Router ä»å…¥é—¨åˆ°å·¥ç¨‹åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3235201610941578/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    xhxxx
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T08:05:49.000Z" title="Sat Jan 17 2026 08:05:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æŒæ¡ React Routerï¼šä»åŸºç¡€åˆ°å·¥ç¨‹åŒ–å®è·µ</h2>
<h3 data-id="heading-1">å‰ç«¯è·¯ç”±ï¼šä»é¡µé¢è·³è½¬åˆ°ä½“éªŒå‡çº§</h3>
<p>åœ¨ Web å¼€å‘çš„æ—©æœŸï¼Œå‰ç«¯åªæ˜¯â€œé™æ€é¡µé¢çš„æ¬è¿å·¥â€â€”â€”æ‰€æœ‰è·³è½¬é€»è¾‘ç”±åç«¯æŒæ§ï¼Œæ¯æ¬¡ç‚¹å‡»é“¾æ¥éƒ½ä¼šè§¦å‘ä¸€æ¬¡å®Œæ•´çš„é¡µé¢åˆ·æ–°ã€‚ç”¨æˆ·çœ‹åˆ°çš„æ˜¯ç™½å±ã€ç­‰å¾…ã€å†åŠ è½½ï¼›å¼€å‘è€…é¢å¯¹çš„æ˜¯è€¦åˆã€é‡å¤å’Œä½æ•ˆã€‚</p>
<p>éšç€å‰åç«¯åˆ†ç¦»æ¶æ„çš„æ™®åŠï¼Œå‰ç«¯ä¸å†åªæ˜¯å±•ç¤ºå±‚ï¼Œè€Œæ˜¯é€æ¸æ‰¿æ‹…èµ·å®Œæ•´çš„åº”ç”¨é€»è¾‘ã€‚<strong>è·¯ç”±ï¼Œä¹Ÿç”±æ­¤ä»å‰ç«¯çš„â€œç›²åŒºâ€å˜æˆäº†æ ¸å¿ƒèƒ½åŠ›ä¹‹ä¸€</strong>ã€‚</p>
<p>ä»Šå¤©ï¼Œå€ŸåŠ©åƒ React Router è¿™æ ·çš„å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸åˆ·æ–°é¡µé¢çš„å‰æä¸‹ï¼Œå®ç° URL ä¸ UI çš„ç²¾å‡†åŒæ­¥ï¼Œæ„å»ºçœŸæ­£æ„ä¹‰ä¸Šçš„å•é¡µåº”ç”¨ï¼ˆSPAï¼‰â€”â€”æ—¢ä¿æŒäº† URL çš„å¯åˆ†äº«æ€§ä¸ä¹¦ç­¾èƒ½åŠ›ï¼Œåˆå¸¦æ¥äº†æ¥è¿‘åŸç”Ÿåº”ç”¨çš„æµç•…ä½“éªŒã€‚</p>
<p>è€Œè¿™ä¸€åˆ‡ï¼Œéƒ½å§‹äºä¸€ä¸ªç®€å•çš„æ˜ å°„å…³ç³»ï¼š<br/>
<strong>è·¯å¾„ï¼ˆURLï¼‰ â†’ ç»„ä»¶ï¼ˆViewï¼‰</strong> ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ·±å…¥ React Router DOMï¼Œä»å®‰è£…é…ç½®åˆ°é«˜çº§ç”¨æ³•ï¼Œä¸€æ­¥æ­¥æ­å¼€å‰ç«¯è·¯ç”±çš„é¢çº±ã€‚</p>
<h3 data-id="heading-2">React Router DOM</h3>
<p>ä¸åŒæ¡†æ¶çš„è·¯ç”±å®ç°è™½ç„¶ä¸åŒï¼Œä½†åŸºæœ¬åŸç†æ˜¯ç›¸ä¼¼çš„ã€‚è¿™é‡Œæˆ‘ä»¬ä»¥ React è·¯ç”±ä¸ºä¾‹ï¼Œå¸¦ä½ äº†è§£è·¯ç”±çš„é­…åŠ›ã€‚</p>
<p>ä¼ ç»Ÿçš„ Web å¼€å‘æ˜¯å¤šé¡µåº”ç”¨ï¼ŒåŸºäº HTTP è¯·æ±‚å®ç°ã€‚æ¯å½“è¯·æ±‚æ–°çš„ URL æ—¶ï¼Œé¡µé¢éƒ½ä¼šå®Œå…¨åˆ·æ–°ï¼Œå¯¼è‡´ç¬é—´ç™½å±ï¼Œä½“éªŒè¾ƒå·®ã€‚</p>
<h4 data-id="heading-3">å•é¡µåº”ç”¨ (SPA)</h4>
<p>å¾—ç›Šäºè·¯ç”±çš„å‡ºç°ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå®ç°å•é¡µåº”ç”¨ï¼ˆSPAï¼‰ã€‚å½“ç”¨æˆ·ç‚¹å‡»é“¾æ¥è·³è½¬æ—¶ï¼Œåªè§¦å‘å¯¹åº”çš„äº‹ä»¶å¹¶æ›´æ–°å±€éƒ¨è§†å›¾ï¼Œè€Œä¸æ˜¯é‡æ–°æ¸²æŸ“æ•´ä¸ªé¡µé¢ï¼Œä»è€Œæä¾›æµç•…çš„ç”¨æˆ·ä½“éªŒã€‚</p>
<h4 data-id="heading-4">å®‰è£…è·¯ç”±</h4>
<pre><code class="hljs language-bash" lang="bash">npm install react-router-dom
</code></pre>
<p><strong>è·¯ç”±è¡¨ç¤ºçš„å°±æ˜¯è·¯å¾„å’Œç»„ä»¶çš„æ˜ å°„å…³ç³»</strong></p>
<h4 data-id="heading-5">è·¯ç”±çš„ä½¿ç”¨</h4>
<h5 data-id="heading-6">1. å¼•å…¥è·¯ç”±</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BrowserRouter</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">Router</span>, <span class="hljs-title class_">Route</span>, <span class="hljs-title class_">Routes</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>;
</code></pre>
<h5 data-id="heading-7">2. è·¯ç”±çš„æ¨¡å¼</h5>
<ul>
<li><strong>HashRouter</strong> (<code>#/</code>)
<ul>
<li>URL å¸¦æœ‰ <code>#</code> å·ã€‚</li>
<li>å…¼å®¹æ€§æå¥½ï¼Œé€šå¸¸åœ¨è·¯å¾„ä¹‹åä¼šè‡ªåŠ¨åŠ ä¸Š <code>#/</code>ã€‚</li>
</ul>
</li>
<li><strong>BrowserRouter</strong> (<code>/</code>)
<ul>
<li>URL å’Œåç«¯è·¯ç”±ä¸€è‡´ï¼ŒåŸºäº HTML5 History APIã€‚</li>
<li>å…¼å®¹æ€§è¾ƒå¥½ï¼ˆIE11 ä¹‹å‰ä¸æ”¯æŒï¼‰ï¼Œç°ä»£æµè§ˆå™¨å‡ ä¹éƒ½æ”¯æŒã€‚</li>
<li><strong>æ¨è</strong>ï¼šç°ä»£å¼€å‘ä¸­æ›´æ¨èä½¿ç”¨ <code>BrowserRouter</code>ã€‚</li>
<li><strong>æ³¨æ„</strong>ï¼š<code>BrowserRouter as Router</code> æ˜¯ä¸ºäº†æé«˜å¯è¯»æ€§ï¼Œåç»­ç»Ÿä¸€ä½¿ç”¨ <code>Router</code> å‘½åã€‚</li>
</ul>
</li>
</ul>
<h5 data-id="heading-8">3. æ ¸å¿ƒç»„ä»¶</h5>
<ul>
<li><strong>Routes</strong>ï¼šè·¯ç”±å®¹å™¨ï¼Œè´Ÿè´£ç®¡ç†ä¸€ç»„è·¯ç”±ï¼Œé€šå¸¸åŒ…è£¹åœ¨ <code>Router</code> ç»„ä»¶ä¸­ã€‚</li>
<li><strong>Route</strong>ï¼šå®šä¹‰å•ä¸ªè·¯ç”±è§„åˆ™ï¼Œå½“è·¯å¾„åŒ¹é…æ—¶æ¸²æŸ“å¯¹åº”çš„ç»„ä»¶ã€‚</li>
</ul>
<h4 data-id="heading-9">è·¯ç”±çš„é…ç½®</h4>
<p>åœ¨ç°ä»£çš„å¼€å‘ç›®å½•ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å°†è·¯ç”±çš„é…ç½®éƒ½æ”¾åœ¨ <code>router</code> ç›®å½•ä¸‹ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BrowserRouter</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">Router</span>, <span class="hljs-title class_">Route</span>, <span class="hljs-title class_">Routes</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Home</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./Home'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">About</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./About'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Router</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Home</span> /&gt;</span>} /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/about"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">About</span> /&gt;</span>} /&gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Router</span>&gt;</span></span>
</code></pre>
<p><strong>é…ç½®è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>/</code> å¯¹åº” <code>Home</code> ç»„ä»¶</li>
<li><code>/about</code> å¯¹åº” <code>About</code> ç»„ä»¶</li>
</ul>
<p>å½“ç”¨æˆ·è®¿é—® <code>/</code> æ—¶ï¼Œä¼šæ¸²æŸ“ <code>Home</code> ç»„ä»¶ï¼›å½“è®¿é—® <code>/about</code> æ—¶ï¼Œä¼šæ¸²æŸ“ <code>About</code> ç»„ä»¶ã€‚</p>
<h4 data-id="heading-10">è·¯ç”±å¯¼èˆª</h4>
<p>åœ¨ SPA ä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ <code>&lt;a&gt;</code> æ ‡ç­¾è¿›è¡Œå¯¼èˆªï¼Œå› ä¸ºå®ƒä¼šå¯¼è‡´é¡µé¢çš„åˆ·æ–°ã€‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨ React Router æä¾›çš„ <code>Link</code> ç»„ä»¶ã€‚</p>
<p>å½“ç”¨æˆ·ç‚¹å‡» <code>Link</code> ç»„ä»¶æ—¶ï¼Œä¼šè§¦å‘è·¯ç”±çš„å¯¼èˆªï¼Œè€Œä¸ä¼šå¯¼è‡´é¡µé¢åˆ·æ–°ã€‚æˆ‘ä»¬éœ€è¦åœ¨ <code>Link</code> ç»„ä»¶ä¸­æŒ‡å®š <code>to</code> å±æ€§ï¼Œæ¥æŒ‡å®šè·³è½¬çš„è·¯å¾„ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Link</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/"</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/about"</span>&gt;</span>About<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span></span>
</code></pre>
<p>ç‚¹å‡»å¯¹åº”çš„é“¾æ¥å°±ä¼šè·³è½¬åˆ°å¯¹åº”çš„é¡µé¢ã€‚</p>
<hr/>
<h4 data-id="heading-11">è·¯ç”±çš„ç§ç±»</h4>
<h5 data-id="heading-12">1. æ™®é€šè·¯ç”±</h5>
<p>æœ€åŸºæœ¬çš„è·¯ç”±ï¼Œå½“è·¯å¾„åŒ¹é…æ—¶ï¼Œä¼šæ¸²æŸ“å¯¹åº”çš„ç»„ä»¶ã€‚
ä¾‹å¦‚ï¼š<code>about</code> å¯¹åº” <code>About</code> ç»„ä»¶ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"> &lt;<span class="hljs-title class_">Route</span> path=<span class="hljs-string">"/about"</span> element={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">About</span> /&gt;</span></span>} /&gt;
</code></pre>
<h5 data-id="heading-13">2. åŠ¨æ€è·¯ç”±</h5>
<p>è·¯å¾„ä¸­åŒ…å«åŠ¨æ€å‚æ•°ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx">&lt;<span class="hljs-title class_">Route</span> path=<span class="hljs-string">"/user/:id"</span> element={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserProfile</span> /&gt;</span></span>} /&gt;
</code></pre>
<p>åŠ¨æ€è·¯ç”±å½“è·¯å¾„åŒ¹é…æ—¶ï¼Œä¼šæ¸²æŸ“å¯¹åº”çš„ç»„ä»¶ï¼Œå¹¶ä¸”ä¼šå°†è·¯å¾„ä¸­çš„å‚æ•°ä¼ é€’ç»™ç»„ä»¶ã€‚
ä¾‹å¦‚ï¼š<code>/user/123</code> å¯¹åº” <code>UserProfile</code> ç»„ä»¶ï¼Œå¹¶ä¸”ä¼šå°† <code>123</code> ä¼ é€’ç»™ <code>UserProfile</code> ç»„ä»¶ã€‚</p>
<p>åœ¨ <code>UserProfile</code> ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>useParams</code> hook æ¥è·å–è·¯ç”±å‚æ•°ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { useParams } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>;
<span class="hljs-keyword">const</span> { id } = <span class="hljs-title function_">useParams</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(id); <span class="hljs-comment">// 123</span>
</code></pre>
<h5 data-id="heading-14">3. åµŒå¥—è·¯ç”±</h5>
<pre><code class="hljs language-jsx" lang="jsx">&lt;<span class="hljs-title class_">Route</span> path=<span class="hljs-string">"/products"</span> element={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Product</span>/&gt;</span></span>}&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">":productId"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">ProductDetail</span> /&gt;</span>}/&gt;</span>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"new"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">NewProduct</span> /&gt;</span>}/&gt;</span>
&lt;/<span class="hljs-title class_">Route</span>&gt;
</code></pre>
<p>åµŒå¥—è·¯ç”±æ˜¯å±€éƒ¨æ›´æ–°çš„ä¸€ç§å…¸å‹ã€‚å½“ç”¨æˆ·è®¿é—®åˆ°äº§å“é¡µé¢æ—¶ï¼Œç‚¹å‡»äº§å“åˆ—è¡¨ä¸­çš„ä¸åŒæŒ‰é’®ï¼ˆä¾‹å¦‚äº§å“è¯¦æƒ…å’Œæ–°äº§å“ï¼‰ï¼Œä¼šæ¸²æŸ“å¯¹åº”çš„å­ç»„ä»¶ï¼Œè€Œä¸ä¼šå¯¼è‡´æ•´ä¸ªé¡µé¢çš„åˆ·æ–°ã€‚
è¿™æ ·çš„è·¯å¾„é…ç½®æ˜¯åŸºäº <code>/products</code> ç»§ç»­åŒ¹é…çš„ã€‚</p>
<p>åœ¨ <code>Product</code> ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>Outlet</code> ç»„ä»¶æ¥æ¸²æŸ“åµŒå¥—è·¯ç”±çš„å†…å®¹ã€‚
ä¾‹å¦‚ï¼š<code>/products/123</code> å¯¹åº” <code>ProductDetail</code> ç»„ä»¶ï¼Œå¹¶ä¸”ä¼šå°† <code>123</code> ä¼ é€’ç»™ <code>ProductDetail</code> ç»„ä»¶ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span>{
    <span class="hljs-title class_">Outlet</span>
} <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Product</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>äº§å“åˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Outlet</span> /&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  )
}
</code></pre>
<h5 data-id="heading-15">4. é‡å®šå‘è·¯ç”±</h5>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> {
  <span class="hljs-title class_">Routes</span>, 
  <span class="hljs-title class_">Route</span>,
  <span class="hljs-title class_">Navigate</span>
} <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>

&lt;<span class="hljs-title class_">Route</span> path=<span class="hljs-string">"/old-path"</span> element={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Navigate</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/new-path"</span> /&gt;</span></span>} /&gt;
</code></pre>
<p>å½“ä¸€ä¸ªç½‘ç«™å¯èƒ½å·²ç»åºŸå¼ƒæˆ–è€…ä¸å†æ›´æ–°èµ„æºï¼Œä½†ç”¨æˆ·ä¾ç„¶è®¿é—®æ—§è·¯å¾„æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸å°±éœ€è¦ä½¿ç”¨é‡å®šå‘è·¯ç”±å¸®åŠ©ç”¨æˆ·è¿›è¡Œå¯¼èˆªã€‚
å¼•å…¥ <code>Navigate</code>ï¼Œå½“ç”¨æˆ·è®¿é—® <code>/old-path</code> æ—¶ï¼Œä¼šè‡ªåŠ¨è·³è½¬åˆ° <code>/new-path</code>ã€‚é»˜è®¤æ˜¯ä½¿ç”¨ <code>replace</code> æ¨¡å¼ï¼Œä¸ä¼šä¿ç•™æ—§çš„å†å²è®°å½•ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬æƒ³è¦ä¿ç•™æ—§çš„å†å²è®°å½•ï¼Œå¯ä»¥è®¾ç½® <code>replace</code> å±æ€§ä¸º <code>false</code>ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx">&lt;<span class="hljs-title class_">Route</span> path=<span class="hljs-string">"/old-path"</span> element={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Navigate</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/new-path"</span> <span class="hljs-attr">replace</span>=<span class="hljs-string">{false}</span> /&gt;</span></span>} /&gt;
</code></pre>
<h5 data-id="heading-16">5. é‰´æƒè·¯ç”± (è·¯ç”±å®ˆå«)</h5>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">ProtectRoute</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./ProtectRoute'</span>;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">'/pay'</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>
   &lt;<span class="hljs-attr">ProtectRoute</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Pay</span> /&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-name">ProtectRoute</span>&gt;</span>
}/&gt;</span>
</code></pre>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">//protectRoute.jsx</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Navigate</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ProductRoute</span>(<span class="hljs-params">{children}</span>) {
    <span class="hljs-keyword">const</span> isLoggedIn = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'isLogin'</span>)===<span class="hljs-string">'true'</span>
    <span class="hljs-keyword">if</span>(!isLoggedIn){
        <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Navigate</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/login"</span> /&gt;</span></span>
    }
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/&gt;</span></span>
  )
}
</code></pre>
<p>é‰´æƒè·¯ç”±ä¹Ÿå«è·¯ç”±å®ˆå«ï¼Œåªæœ‰å½“æ»¡è¶³æ¡ä»¶æ—¶æ‰èƒ½å¤Ÿæ”¾è¡Œã€‚å°±åƒå¾ˆå¤šè½¯ä»¶ï¼Œä½ ä¸ç™»å½•å°±æ— æ³•ä½¿ç”¨å¾ˆå¤šåŠŸèƒ½ï¼›å½“ä½ æƒ³è¦ä»˜æ¬¾æ—¶ï¼Œå¦‚æœæ²¡æœ‰ç™»å½•ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨å¼¹å‡ºç™»å½•é¡µã€‚
ä½¿ç”¨ä¸€ä¸ªç»„ä»¶æ¥åŒ…è£¹éœ€è¦é‰´æƒçš„è·¯ç”±ï¼Œå½“ç”¨æˆ·è®¿é—®åˆ°è¿™ä¸ªè·¯ç”±æ—¶ï¼Œä¼šå…ˆåˆ¤æ–­æ˜¯å¦ç™»å½•ã€‚å¦‚æœæ²¡æœ‰ç™»å½•ï¼Œå°±ä¼šè·³è½¬åˆ°ç™»å½•é¡µï¼Œå¦åˆ™å°±ä¼šæ¸²æŸ“å¯¹åº”çš„ç»„ä»¶ã€‚</p>
<h5 data-id="heading-17">6. 404 è·¯ç”±</h5>
<pre><code class="hljs language-jsx" lang="jsx">&lt;<span class="hljs-title class_">Route</span> path=<span class="hljs-string">"*"</span> element={<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">NotFound</span> /&gt;</span></span>} /&gt;
</code></pre>
<p><code>*</code> ä»£è¡¨é™¤é…ç½®å¤–çš„æ‰€æœ‰è·¯ç”±ã€‚
å½“ç”¨æˆ·è®¿é—®åˆ°ä¸€ä¸ªä¸å­˜åœ¨çš„è·¯ç”±æ—¶ï¼Œä¼šæ¸²æŸ“ <code>NotFound</code> ç»„ä»¶ã€‚</p>
<hr/>
<h4 data-id="heading-18">æ€§èƒ½ä¼˜åŒ–</h4>
<h5 data-id="heading-19">è·¯ç”±çš„æ‡’åŠ è½½</h5>
<p>åœ¨ç°ä»£å‰ç«¯æ¡†æ¶ï¼ˆå¦‚ Reactã€Vue ç­‰ï¼‰ä¸­ï¼Œ<strong>è·¯ç”±çš„æ‡’åŠ è½½ (Lazy Loading)</strong> æ˜¯ä¸€ç§ä¼˜åŒ–åº”ç”¨æ€§èƒ½çš„é‡è¦æ‰‹æ®µã€‚å®ƒå…è®¸ä½ æŒ‰éœ€åŠ è½½ç»„ä»¶ï¼Œè€Œä¸æ˜¯åœ¨åº”ç”¨åˆå§‹åŠ è½½æ—¶ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰è·¯ç”±ç»„ä»¶ï¼Œä»è€Œå‡å°é¦–å± bundle ä½“ç§¯ã€åŠ å¿«é¡µé¢åŠ è½½é€Ÿåº¦ã€‚</p>
<p>ä¾‹å¦‚å½“ä½ æ‰“å¼€åº”ç”¨é¦–é¡µæ—¶ï¼Œä½ ä¼šçœ‹è§å¾ˆå¤šåŠŸèƒ½æŒ‰é’®ï¼Œä½†æ˜¯å¦‚æœè¦åœ¨é¦–æ¬¡è¿›å…¥æ—¶æŠŠè¿™äº›æŒ‰é’®å¯¹åº”çš„æ‰€æœ‰ç»„ä»¶ä¸€æ¬¡æ€§å…¨éƒ¨åŠ è½½ï¼Œè¿™æ— ç–‘æ˜¯å¾ˆç³Ÿç³•çš„ã€‚è¿™æ ·ä¸ä»…ä»…å¡é¡¿ï¼Œè¿˜ä¼šå¢åŠ é¦–å±åŠ è½½æ—¶é—´ï¼Œç”šè‡³æœ‰äº›ç»„ä»¶ä½ éƒ½ä¸ä½¿ç”¨ï¼Œå®ƒå´è¢«åŠ è½½äº†ï¼Œè¿™æ˜¯éå¸¸æµªè´¹èµ„æºçš„ã€‚</p>
<p>è€Œæ‡’åŠ è½½å°±å¾ˆå¥½åœ°å¤„ç†äº†è¿™ä¸ªé—®é¢˜ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// ä¼ ç»Ÿçš„å¼•å…¥</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Home</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./Home'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">About</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./About'</span>;

<span class="hljs-comment">// æ‡’åŠ è½½å¼•å…¥</span>
<span class="hljs-keyword">import</span> { lazy } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title class_">Home</span> = <span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./Home'</span>));
<span class="hljs-keyword">const</span> <span class="hljs-title class_">About</span> = <span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./About'</span>));
</code></pre>
<p>å½“ç„¶äº†ï¼Œæ‰€æœ‰æ‡’åŠ è½½çš„ç»„ä»¶éƒ½éœ€è¦åœ¨ <code>Suspense</code> ç»„ä»¶ä¸­åŒ…è£¹èµ·æ¥ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Suspense</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
   <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Home</span> /&gt;</span>} /&gt;
   <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/about"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">About</span> /&gt;</span>} /&gt;
<span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
</code></pre>
<p>å½“ <code>Home</code> å’Œ <code>About</code> ç»„ä»¶è¢«åŠ è½½æ—¶ï¼Œä¼šæ˜¾ç¤º <code>Loading...</code>ï¼Œå½“åŠ è½½å®Œæˆåï¼Œä¼šæ˜¾ç¤ºå¯¹åº”çš„ç»„ä»¶ã€‚
å½“æˆ‘ä»¬è®¿é—® <code>/</code> æ—¶ï¼Œä¼šæ˜¾ç¤º <code>Home</code> ç»„ä»¶ï¼Œè€Œ <code>About</code> åˆ™ä¼šå»¶è¿ŸåŠ è½½ï¼›åªæœ‰å½“ç”¨æˆ·è®¿é—®åˆ° <code>/about</code> æ—¶ï¼Œæ‰ä¼šåŠ è½½ <code>About</code> ç»„ä»¶ã€‚</p>
<hr/>
<h4 data-id="heading-20">è·¯ç”±èŒè´£åˆ†ç¦»</h4>
<p>ä¸ºäº†ä¿æŒä»£ç çš„æ•´æ´å’Œå¯ç»´æŠ¤æ€§ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå°†è·¯ç”±çš„<strong>é…ç½®</strong>å’Œ<strong>å¯¼èˆª</strong>é€»è¾‘ä»ä¸»åº”ç”¨ç»„ä»¶ä¸­å‰¥ç¦»å‡ºæ¥ã€‚
è¿™ç§åˆ†ç¦»è®© <code>App.jsx</code> æ›´åŠ ç®€æ´ï¼Œä¸“æ³¨äºå¸ƒå±€å’Œå…¨å±€ç»„ä»¶çš„ç»„åˆã€‚</p>
<h5 data-id="heading-21">1. ç‹¬ç«‹çš„è·¯ç”±é…ç½® (<code>src/router/index.jsx</code>)</h5>
<p>æ‰€æœ‰çš„è·¯ç”±è§„åˆ™ã€æ‡’åŠ è½½ (<code>lazy</code>)ã€è·¯ç”±å®ˆå« (<code>ProtectRoute</code>) ç­‰é€»è¾‘éƒ½é›†ä¸­ç®¡ç†ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// src/router/index.jsx</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Routes</span>, <span class="hljs-title class_">Route</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>;
<span class="hljs-keyword">import</span> { lazy, <span class="hljs-title class_">Suspense</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// ... æ‡’åŠ è½½ç»„ä»¶å®šä¹‰ ...</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">RouterConfig</span>(<span class="hljs-params"/>){
    <span class="hljs-keyword">return</span>(
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">LoadingFallback</span> /&gt;</span>}&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Home</span> /&gt;</span>} /&gt;
            {/* ...å…¶ä»–è·¯ç”±é…ç½® */}
          <span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
    )
}
</code></pre>
<h5 data-id="heading-22">2. ç‹¬ç«‹çš„å¯¼èˆªç»„ä»¶ (<code>src/components/Navigation.jsx</code>)</h5>
<p>å¯¼èˆªèœå•ã€é“¾æ¥é«˜äº®ç­‰ UI é€»è¾‘å°è£…åœ¨ç‹¬ç«‹çš„ç»„ä»¶ä¸­ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// src/components/Navigation.jsx</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Link</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Navigation</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/"</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/about"</span>&gt;</span>About<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>
      {/* ... */}
    <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span></span>
  )
}
</code></pre>
<h5 data-id="heading-23">3. ç®€æ´çš„ä¸»å…¥å£ (<code>src/App.jsx</code>)</h5>
<p>ä¸»ç»„ä»¶åªè´Ÿè´£å¼•å…¥å’Œç»„è£…ï¼Œä¸å†åŒ…å«å¤æ‚çš„è·¯ç”±é€»è¾‘ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// src/App.jsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Navigation</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/Navigation'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">RouterConfig</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./router'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Router</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Navigation</span> /&gt;</span>   {/* å¯¼èˆªåŒºåŸŸ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">RouterConfig</span> /&gt;</span> {/* è·¯ç”±è§†å›¾åŒºåŸŸ */}
    <span class="hljs-tag">&lt;/<span class="hljs-name">Router</span>&gt;</span></span>
  )
}
</code></pre>
<hr/>
<h4 data-id="heading-24">æ ·å¼ä¼˜åŒ–</h4>
<h5 data-id="heading-25">å¯¼èˆªåŒºé«˜äº® (åƒæ˜é‡‘ä¸€æ ·)</h5>
<p>å½“æˆ‘ä»¬ç‚¹å‡»å¯¼èˆªåŒºçš„ä¸åŒé“¾æ¥æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå¸Œæœ›å¯¹åº”çš„å¯¼èˆªé¡¹é«˜äº®æ˜¾ç¤ºï¼Œä»¥å‘ŠçŸ¥ç”¨æˆ·å½“å‰æ‰€åœ¨çš„ä½ç½®ã€‚
React Router æä¾›çš„ <code>useResolvedPath</code> å’Œ <code>useMatch</code> å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</p>
<ul>
<li><code>useResolvedPath</code>: å°†ç›®æ ‡è·¯å¾„ï¼ˆ<code>to</code> å±æ€§ï¼‰è§£æä¸ºç»å¯¹è·¯å¾„å¯¹è±¡ã€‚</li>
<li><code>useMatch</code>: æ¥æ”¶ä¸€ä¸ªè·¯å¾„æ¨¡å¼ï¼Œåˆ¤æ–­å½“å‰ URL æ˜¯å¦ä¸è¯¥æ¨¡å¼åŒ¹é…ã€‚</li>
</ul>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { useResolvedPath, useMatch, <span class="hljs-title class_">Link</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Navigation</span>(<span class="hljs-params"/>){
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">isActive</span> = (<span class="hljs-params">to</span>) =&gt; {
     <span class="hljs-comment">// 1. å°† to è§£æä¸º location å¯¹è±¡ï¼Œå¤„ç†ç›¸å¯¹è·¯å¾„ç­‰æƒ…å†µ</span>
     <span class="hljs-keyword">const</span> resolvedPath = <span class="hljs-title function_">useResolvedPath</span>(to);
     
     <span class="hljs-comment">// 2. æ£€æŸ¥å½“å‰è·¯å¾„æ˜¯å¦åŒ¹é… resolvedPath.pathname</span>
     <span class="hljs-keyword">const</span> match = <span class="hljs-title function_">useMatch</span>({
      <span class="hljs-attr">path</span>: resolvedPath.<span class="hljs-property">pathname</span>,
      <span class="hljs-attr">end</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// ç²¾å‡†åŒ¹é…ï¼Œé¿å… / åŒ¹é…æ‰€æœ‰è·¯å¾„</span>
     })

     <span class="hljs-keyword">return</span> match ? <span class="hljs-string">'active'</span> : <span class="hljs-string">''</span>
  }
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{isActive(</span>'/')}&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/about"</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{isActive(</span>'/<span class="hljs-attr">about</span>')}&gt;</span>About<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        {/* ... */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span></span>
  )
}
</code></pre>
<h4 data-id="heading-26">ç»“è¯­</h4>
<p>å‰ç«¯è·¯ç”±çš„æœ¬è´¨ï¼Œæ˜¯<strong>è·¯å¾„ä¸ç»„ä»¶çš„æ˜ å°„</strong>ï¼›è€Œ React Routerï¼Œåˆ™è®©è¿™ç§æ˜ å°„å˜å¾—æ¸…æ™°ã€çµæ´»åˆå¼ºå¤§ã€‚</p>
<p>ä»åŸºç¡€è·³è½¬åˆ°åŠ¨æ€å‚æ•°ï¼Œä»åµŒå¥—è·¯ç”±åˆ°æƒé™æ§åˆ¶ï¼Œå†åˆ°æ‡’åŠ è½½ä¸å·¥ç¨‹åŒ–æ‹†åˆ†â€”â€”æˆ‘ä»¬ä¸ä»…æ˜¯åœ¨é…ç½® URLï¼Œæ›´æ˜¯åœ¨æ„å»ºä¸€ä¸ªå¯ç»´æŠ¤ã€é«˜æ€§èƒ½ã€ç”¨æˆ·ä½“éªŒæµç•…çš„ç°ä»£ Web åº”ç”¨ã€‚</p>
<p>æŒæ¡ React Routerï¼Œä¸åªæ˜¯å­¦ä¼šå‡ ä¸ª APIï¼Œè€Œæ˜¯ç†è§£ SPA èƒŒåçš„å¯¼èˆªé€»è¾‘ä¸æ¶æ„æ€ç»´ã€‚å¸Œæœ›è¿™ç¯‡æŒ‡å—èƒ½æˆä¸ºä½ å¼€å‘è·¯ä¸Šçš„å¯é å‚è€ƒï¼ŒåŠ©ä½ å†™å‡ºæ›´ä¼˜é›…çš„è·¯ç”±ä»£ç ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vueè½¬Reactå­¦ä¹ ç¬”è®°(1): å…³äºuseEffectçš„å›°æƒ‘å’Œæ€è€ƒ]]></title>    <link>https://juejin.cn/post/7595842144906706994</link>    <guid>https://juejin.cn/post/7595842144906706994</guid>    <pubDate>2026-01-17T08:12:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595842144906706994" data-draft-id="7595808703074467866" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vueè½¬Reactå­¦ä¹ ç¬”è®°(1): å…³äºuseEffectçš„å›°æƒ‘å’Œæ€è€ƒ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-17T08:12:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="mo_Mo"/> <meta itemprop="url" content="https://juejin.cn/user/3727788080114596"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vueè½¬Reactå­¦ä¹ ç¬”è®°(1): å…³äºuseEffectçš„å›°æƒ‘å’Œæ€è€ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3727788080114596/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    mo_Mo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T08:12:55.000Z" title="Sat Jan 17 2026 08:12:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">é›¶ã€å†™åœ¨å‰é¢</h3>
<ol>
<li>ä¹‹å‰å®ä¹ å’Œé¡¹ç›®ä¸­éƒ½æ˜¯å­¦çš„Vueï¼Œç”±äºä¹‹åå·¥ä½œå¤§æ¦‚ç‡ä¼šè¿›å…¥Reactçš„æŠ€æœ¯ç”Ÿæ€ï¼Œæœ€è¿‘æ‰å¼€å§‹å­¦Reactå¹¶ä¸”ç¼ºå°‘ä¼ä¸šçº§çš„é¡¹ç›®å¼€å‘ç»éªŒï¼Œä¹Ÿæ²¡æœ‰å¯¹æºç åšç³»ç»Ÿç ”ç©¶ï¼Œä»¥ä¸‹çš„å†…å®¹åªæ˜¯ä¸ªäººå­¦ä¹ è¿‡ç¨‹ä¸­çš„è®°å½•å’Œæ€è€ƒï¼Œå› æ­¤å¤§æ¦‚ç‡ä¼šæ˜¾å¾—ç¨šå«©è€Œä¸”ä¸»è§‚ï¼Œéœ€è¦å¤§ä½¬ä»¬çš„æŒ‡ç‚¹å’Œä¿®æ­£ã€‚</li>
<li>è½¯ä»¶å¼€å‘æ¯•ç«Ÿå±äºå·¥ç¨‹å®è·µé¢†åŸŸï¼Œå¯¹äºç›¸åŒçš„ç›®æ ‡å¯ä»¥æœ‰ä¸åŒçš„å®ç°æ–¹æ¡ˆï¼Œè€Œä¸€æ ·çš„æŠ€æœ¯åœ¨ä¸åŒçš„åœºæ™¯ä¸‹ä¹Ÿéœ€è¦åšå–èˆæƒè¡¡ï¼Œå®ƒå¹¶ä¸åƒæ•°å­¦ç‰©ç†è¿™æ ·çš„å­¦ç§‘æœ‰ä¸€å¥—ä¸å®¹ç½®ç–‘çš„å…¬ç†ã€‚è€Œä¸”å¯¹äºå›¢é˜Ÿå¼€å‘è€…è€Œè¨€ï¼Œä¸€å¥—æŠ€æœ¯çš„å¼€å‘ä½“éªŒã€å­¦ä¹ æˆæœ¬ã€è®¤çŸ¥å¯¹é½ç­‰å› ç´ ä¹ŸåŒæ ·é‡è¦ï¼Œå®ƒä»¬åº”è¯¥æ˜¯å¸¦æœ‰ä¸»è§‚è‰²å½©çš„ï¼Œè‡³å°‘æ˜¯å¯è®¨è®ºçš„ï¼›</li>
<li>ä¸ºäº†æè¿°ç®€ä¾¿ï¼Œä»¥ä¸‹ä¼šæ ¹æ®å®˜æ–¹æ–‡æ¡£çš„å†™æ³•å’Œç§°å‘¼ï¼Œå¯¹äº<code>useEffect(setupï¼Œdependencies)</code>ï¼Œå°†æ¸²æŸ“ä¸­äº§ç”Ÿçš„å‰¯ä½œç”¨ç§°ä¸º<code>Effect</code>ï¼Œå°†ç¬¬ä¸€ä¸ªå‡½æ•°å‚æ•°ç§°ä¸º<code>setup</code>ï¼Œå°†ä¾èµ–æ•°ç»„ç®€ç§°ä¸º<code>deps</code>ï¼Œå°†<code>setup</code>è¿”å›çš„æ¸…ç†å‡½æ•°ç§°ä¸º<code>cleanup</code>ã€‚</li>
<li>æ–‡ä¸­æåˆ°çš„è§‚ç‚¹æœ‰äº›æ˜¯Reactå®˜æ–¹çš„æå€¡ï¼Œæœ‰äº›æ˜¯ç¬”è€…è‡ªå·±çš„æ€è€ƒï¼Œè¯·æ³¨æ„è¾¨åˆ«ï¼Œå®˜æ–¹æ€ä¹ˆè¯´ä¸ä»£è¡¨æˆ‘ä»¬çœŸçš„è¦é‚£ä¹ˆåš/æƒ³ã€‚å…³äºè¿™ä¸ªAPIï¼Œå…¶å®åœ¨å„ç§Reactç¤¾åŒºå·²ç»åšå‡ºäº†å¤§é‡è®¨è®ºäº†ï¼Œæœ¬æ–‡å¯ä»¥è¯´æ˜¯ä¸€ä¸ªè¯»åæ„Ÿã€‚</li>
<li>ä»¥ä¸‹æåˆ°çš„VueæŒ‡çš„æ˜¯3.0+ç‰ˆæœ¬ï¼Œè€ŒReactæŒ‡çš„æ˜¯React18+çš„å‡½æ•°å¼ç»„ä»¶+hookæ¨¡å¼ã€‚</li>
</ol>
<h3 data-id="heading-1">ä¸€ã€Vueè§†è§’çš„å¯¹æ¯”ï¼šä¸€äº›ç²—æµ…çš„ç†è§£</h3>
<p>ç”±äºä¹‹å‰æœ‰Vueæ¡†æ¶çš„å­¦ä¹ ç»éªŒï¼Œå› æ­¤åœ¨å­¦ä¹ æ–°çš„æ¡†æ¶çš„æ—¶å€™ï¼Œä¸»æ’­æ€»ä¼šä¹ æƒ¯ä¸Šè”æƒ³åˆ°Vueä¸­ç›¸å¯¹åº”çš„Apiï¼Œå¹¶ä¸”å®˜æ–¹æ–‡æ¡£å’Œå¤§å¤šæ•°æŠ€æœ¯æ•™ç¨‹éƒ½ä¼šæåˆ°ä¸‰ç§ä¸åŒdepså¯¹åº”çš„æƒ…æ™¯å’Œç”¨æ³•ã€‚</p>
<h4 data-id="heading-2">(ä¸€) ä¸‰ç§ä¾èµ–æƒ…æ™¯</h4>
<h5 data-id="heading-3">1. ä¸ä¼ ä»»ä½•depâ€”â€”ç±»æ¯”<code>onMounted</code>å’Œ<code>onUpdated</code></h5>
<p>ä¸ä¼ é€’ä»»ä½•ä¾èµ–çš„æ—¶å€™ï¼Œå‡½æ•°å¼ç»„ä»¶é¦–æ¬¡æ¸²æŸ“åŠä¹‹åæ›´æ–°ï¼Œéƒ½ä¼šsetupå‡½æ•°éƒ½ä¼šæ‰§è¡Œã€‚å¯¹Vueæ¥è®²ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œç»„ä»¶é¦–æ¬¡æŒ‚è½½æ‰§è¡ŒonMountedå’ŒonUpdatedé’©å­ï¼ŒåŒºåˆ«åœ¨äºVueçš„onUpdatedé’©å­çš„ä½¿ç”¨é¢‘ç‡æ˜¯å¾ˆä½çš„ã€‚</p>
<h5 data-id="heading-4">2. ä¼ é€’ç©ºæ•°ç»„â€”â€”ç±»æ¯”<code>onMounted</code></h5>
<p>ä¼ é€’ç©ºæ•°ç»„æ„å‘³ç€depæ°¸è¿œä¸å˜ï¼Œsetupå‡½æ•°åªä¼šåœ¨ç»„ä»¶æŒ‚è½½çš„æ—¶å€™è¿è¡Œä¸€æ¬¡</p>
<h5 data-id="heading-5">3. ä¼ é€’ä¾èµ–å€¼â€”â€”ç±»æ¯”<code>watch</code>å’Œ<code>watchEffect</code></h5>
<p>ä¾èµ–å€¼å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæ³¨å†Œçš„å›è°ƒå‡½æ•°ä¼šé‡æ–°æ‰§è¡Œ</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">useEffect</span>(() =&gt; {
  <span class="hljs-comment">// ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åè¿è¡Œ</span>
});

<span class="hljs-built_in">useEffect</span>(() =&gt; {
  <span class="hljs-comment">// åªä¼šåœ¨ç»„ä»¶æŒ‚è½½ï¼ˆé¦–æ¬¡å‡ºç°ï¼‰æ—¶è¿è¡Œ</span>
}, <span class="hljs-selector-attr">[]</span>);

<span class="hljs-built_in">useEffect</span>(() =&gt; {
  <span class="hljs-comment">// ä¼šåœ¨ç»„ä»¶æŒ‚è½½æ—¶è¿è¡Œï¼Œè€Œä¸”å½“ a æˆ– b çš„å€¼è‡ªä¸Šæ¬¡æ¸²æŸ“åå‘ç”Ÿå˜åŒ–åä¹Ÿä¼šè¿è¡Œ</span>
}, <span class="hljs-selector-attr">[a, b]</span>);
</code></pre>
<h4 data-id="heading-6">(äºŒ) æ¸…ç†å‡½æ•°</h4>
<p>cleanupå‡½æ•°ä¼šåœ¨è°ƒç”¨å’Œç»„ä»¶å¸è½½çš„æ—¶å€™æ‰§è¡Œï¼ŒVueä¸­ä¹Ÿæä¾›äº†ç›¸å…³çš„åŠŸèƒ½ï¼Œæ¯”å¦‚åœ¨onUnmountedçš„æ—¶å€™æ‰§è¡Œå¸è½½é€»è¾‘ï¼Œwatchå’ŒwatchEffectéƒ½èƒ½è¿”å›å‡½æ•°ä»¥ç”¨äºæ¸…ç†å‰¯ä½œç”¨ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// å‰¯ä½œç”¨é€»è¾‘ï¼šåˆ›å»ºå®šæ—¶å™¨</span>
  <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    count.<span class="hljs-property">value</span>++
  }, <span class="hljs-number">1000</span>)

  <span class="hljs-comment">// æ¸…ç†å‡½æ•°ï¼šæ¸…é™¤ä¸Šä¸€è½®çš„å®šæ—¶å™¨</span>
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-built_in">clearInterval</span>(timer)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å®šæ—¶å™¨å·²æ¸…é™¤'</span>)
  }
})
</code></pre>
<h4 data-id="heading-7">(ä¸‰) æ€ç»´å·®å¼‚</h4>
<p>å¯¹äºVueå¼€å‘è€…æˆ–è€…Reactç±»ç»„ä»¶çš„å¼€å‘è€…æ¥è¯´ï¼Œå¾ˆå®¹æ˜“ç”¨ç”Ÿå‘½å‘¨æœŸçš„ç»„ä»¶æ€ç»´æ¥ç†è§£hookï¼Œç„¶è€Œå®˜æ–¹è§‰å¾—è¿™å¯¹Effectæ¥è®²æ˜¯ä¸é€‚å®œçš„ã€‚å¦‚æœç”¨Vueè§’åº¦æ¥ç±»æ¯”ï¼Œå¤§æ¦‚ç‡ä¼šè§‰å¾—<code>useEffect</code>èµ·åˆ°äº†ä¸€ä¸ªâ€œç›‘å¬å™¨â€çš„ä½œç”¨ï¼Œè¿™å¼•å‘äº†åé¢å…³äºæ˜¯å¦ä½¿ç”¨effectå’Œå¦‚ä½•å†™depsæ•°ç»„çš„å·®å¼‚ã€‚</p>
<h3 data-id="heading-8">äºŒã€å¦‚ä½•ç†è§£å‰¯ä½œç”¨ï¼šåŒºåˆ†<code>Event</code>å’Œ<code>Effect</code></h3>
<h4 data-id="heading-9">(ä¸€) å‰¯ä½œç”¨çš„å®šä¹‰</h4>
<p>React hookå€¡å¯¼çš„æ˜¯<code>UI=f(state)</code>çš„å‡½æ•°å¼ç¼–ç¨‹ç†å¿µï¼Œç†è®ºä¸Šç»„ä»¶å‡½æ•°åº”è¯¥æ˜¯çº¯å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ç›¸åŒçš„è¾“å…¥è¿”å›ç›¸åŒçš„è¾“å‡ºï¼Œå¹¶ä¸”ä¸ä¾èµ–ä¹Ÿä¸å½±å“å¤–éƒ¨ç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯ä¸å’Œå¤–éƒ¨äº§ç”Ÿä»»ä½•äº¤äº’ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// éçº¯å‡½æ•°</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">fn</span>=(<span class="hljs-params">arr</span>)=&gt;{
  arr.<span class="hljs-title function_">push</span>(<span class="hljs-number">1</span>) <span class="hljs-comment">// ä¿®æ”¹äº†å¤–éƒ¨çš„å‚æ•°</span>
}
</code></pre>
<p>åœ¨æ—¥å¸¸å¼€å‘ä¸­äº§ç”Ÿå‰¯ä½œç”¨çš„é¢‘ç‡æ˜¯å¾ˆé«˜çš„ï¼Œå¸¸è§çš„æ¯”å¦‚ï¼š</p>
<ul>
<li>å‘é€httpè¯·æ±‚ï¼šå’ŒæœåŠ¡å™¨äº¤äº’</li>
<li>æ“ä½œdomå…ƒç´ ï¼šå’Œæµè§ˆå™¨APIäº¤äº’</li>
<li>å®šæ—¶å™¨ï¼šå’Œæµè§ˆå™¨APIäº¤äº’</li>
<li>ç”šè‡³console.logä¹Ÿæ˜¯</li>
</ul>
<p>å¾ˆå¤šæ–‡ç« æåˆ°ï¼Œ<code>useEffect</code>æ˜¯ç”¨æ¥ç®¡ç†å‰¯ä½œç”¨çš„ï¼Œä½†å¦‚æœæŠ±æœ‰ä¸€é‡åˆ°â€œç½‘ç»œè¯·æ±‚â€â€œå®šæ—¶å™¨â€ä¹‹ç±»çš„æ“ä½œï¼Œå°±å…¨éƒ¨æ”¾è¿›useEffectå¤„ç†ï¼Œè¿™è‚¯å®šæ˜¯ä¸å¯¹çš„ï¼Œè‡³å°‘ä¸ç¬¦åˆå®˜æ–¹æ¨èçš„ç†å¿µã€‚</p>
<p>äº‹å®ä¸Šï¼Œå®˜æ–¹æ–‡æ¡£å¤šæ¬¡å¼ºè°ƒè¦åŒºåˆ†ç”±ç”¨æˆ·äº¤äº’å¼•èµ·çš„å‰¯ä½œç”¨eventå’Œç”±æ¸²æŸ“è¿‡ç¨‹å¼•èµ·çš„Effect</p>
<h4 data-id="heading-10">(äºŒ) åŒºåˆ†<code>event</code>å’Œ<code>Effect</code></h4>
<p><strong>Effect å…è®¸ä½ æŒ‡å®šç”±æ¸²æŸ“è‡ªèº«ï¼Œè€Œä¸æ˜¯ç‰¹å®šäº‹ä»¶å¼•èµ·çš„å‰¯ä½œç”¨</strong>ã€‚</p>
<p>å½“ä½ å†³å®šå°†æŸäº›é€»è¾‘æ”¾å…¥äº‹ä»¶å¤„ç†å‡½æ•°è¿˜æ˜¯ Effect ä¸­æ—¶ï¼Œä½ éœ€è¦å›ç­”çš„ä¸»è¦é—®é¢˜æ˜¯ï¼šä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹å®ƒæ˜¯ <strong>æ€æ ·çš„é€»è¾‘</strong>ã€‚å¦‚æœè¿™ä¸ªé€»è¾‘æ˜¯ç”±æŸä¸ªç‰¹å®šçš„äº¤äº’å¼•èµ·çš„ï¼Œè¯·å°†å®ƒä¿ç•™åœ¨ç›¸åº”çš„äº‹ä»¶å¤„ç†å‡½æ•°(<code>event handler</code>)ä¸­ã€‚å¦‚æœæ˜¯ç”±ç”¨æˆ·åœ¨å±å¹•ä¸Š <strong>çœ‹åˆ°</strong> ç»„ä»¶æ—¶å¼•èµ·çš„ï¼Œè¯·å°†å®ƒä¿ç•™åœ¨ Effect ä¸­ã€‚</p>
<h5 data-id="heading-11">1. <strong>å®˜æ–¹æ–‡æ¡£çš„ä¾‹å­</strong></h5>
<p>å‡è®¾ä½ æ­£åœ¨å®ç°ä¸€ä¸ªèŠå¤©å®¤ç»„ä»¶ï¼Œéœ€æ±‚å¦‚ä¸‹ï¼š</p>
<ol>
<li>ç»„ä»¶åº”è¯¥è‡ªåŠ¨è¿æ¥é€‰ä¸­çš„èŠå¤©å®¤ã€‚</li>
<li>æ¯å½“ä½ ç‚¹å‡»â€œSendâ€æŒ‰é’®ï¼Œç»„ä»¶åº”è¯¥åœ¨å½“å‰èŠå¤©ç•Œé¢å‘é€ä¸€æ¡æ¶ˆæ¯ã€‚</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">ChatRoom</span>(<span class="hljs-params">{ roomId }</span>) {
  <span class="hljs-keyword">const</span> [message, setMessage] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);
  <span class="hljs-comment">// ...</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">handleSendClick</span>(<span class="hljs-params"/>) {
    <span class="hljs-title function_">sendMessage</span>(message);
  }
  <span class="hljs-comment">// ...</span>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{message}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setMessage(e.target.value)} /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleSendClick}</span>&gt;</span>Send<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
}
</code></pre>
<h5 data-id="heading-12">2. <strong>æ—¥å¸¸é¡¹ç›®ä¸­å¸¸è§çš„ä¾‹å­</strong></h5>
<p>æ¯”å¦‚æˆ‘ä»¬ç‚¹å‡»æŒ‰é’®åˆ‡æ¢ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œéœ€è¦å‘é€ç½‘ç»œè¯·æ±‚æ‹‰å–æœ€æ–°æ•°æ®ï¼Œç”¨effectéœ€è¦è¿™æ ·å†™</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">useEffect</span>(()=&gt;{
  <span class="hljs-built_in">fetchData</span>(type)
},<span class="hljs-selector-attr">[type]</span>)
</code></pre>
<p>è¿™æ ·å°±ä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚é¡µé¢ä¸­æœ‰ä¸€äº›æƒ…å†µä¼šæ”¹å˜typeï¼Œä½†æ˜¯é‚£ä¸ªåœºæ™¯ä¸‹ä¸éœ€è¦å‘é€è¯·æ±‚ï¼Œå´ä»æ—§è§¦å‘äº†Effectï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨setupå‡½æ•°é‡Œæ·»åŠ åˆ¤æ–­ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">useEffect</span>(()=&gt;{
  if (type==='<span class="hljs-number">1</span>'){
    <span class="hljs-built_in">fetchData</span>(type)
  }
},<span class="hljs-selector-attr">[type]</span>)
</code></pre>
<p>æœªæ¥ï¼Œå‡è®¾ä¸šåŠ¡éœ€æ±‚å˜æ›´ï¼Œä½ çš„è¯·æ±‚åˆä¾èµ–äº†å¦ä¸€ä¸ªå‚æ•°userIdï¼Œä½ éœ€è¦åœ¨depä¸­æ·»åŠ å¦ä¸€ä¸ªæ•°æ®ï¼Œç”šè‡³æ–°æ•°æ®ä¹Ÿä¼šå†é¡µé¢å…¶ä»–åœ°æ–¹è¢«ä¿®æ”¹ï¼Œä½ éœ€è¦å¯¹æ–°æ•°æ®è¿›è¡Œæ¡ä»¶åˆ¤æ–­ã€‚è¿™æ ·çš„è¯ï¼Œä»£ç çš„ç»´æŠ¤æˆæœ¬å°†ä¼šå¢é«˜ä¸å°‘ã€‚</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">useEffect</span>(()=&gt;{
  if (type==='<span class="hljs-number">1</span>' &amp;&amp; userId){
    <span class="hljs-built_in">fetchData</span>(type,userId)
  }
},<span class="hljs-selector-attr">[typeï¼ŒuserId]</span>)
</code></pre>
<p>ä½†å®é™…ä¸Šï¼Œå‡å¦‚è¯·æ±‚è¿™æ˜¯ç‚¹å‡»äº‹ä»¶è§¦å‘çš„ï¼Œå®˜æ–¹æ›´æ¨èæŠŠå®ƒç›´æ¥å†™åœ¨äº‹ä»¶å¤„ç†å‡½æ•°é‡Œã€‚è¿™æ ·å†™çš„å¥½å¤„æ˜¯ï¼šåªæœ‰å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®è¿™ä¸ªäº‹ä»¶è§¦å‘çš„æ—¶å€™æ‰ä¼šå‘é€è¯·æ±‚ï¼Œè€Œä¸æ˜¯typeå˜åŒ–çš„æ—¶å€™å‘é€è¯·æ±‚ï¼Œä»è€Œåšåˆ°åˆ‡æ–­typeå’ŒuseEffectçš„é€»è¾‘å…³ç³»ï¼Œè®©å‘é€è¯·æ±‚ä¸“å±äºç‚¹å‡»äº‹ä»¶ã€‚</p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleClick</span><span class="hljs-params">(e)</span></span>{
  const <span class="hljs-built_in">type</span>=e.target.<span class="hljs-built_in">type</span>
  fetchData(<span class="hljs-built_in">type</span>)
}
</code></pre>
<p>åœ¨å¸¸è§çš„ç®¡ç†é¡µä¸­ï¼Œæœç´¢æ¡†è¾“å…¥ï¼Œæœç´¢æ¡†ç‚¹å‡»ï¼Œåˆ†é¡µé¡µç ï¼Œä¸‹æ‹‰èœå•é€‰é¡¹éƒ½æœ‰å¯èƒ½è§¦å‘é‡æ–°è¯·æ±‚ï¼Œé‚£ä¹ˆåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å¯èƒ½ä¼šè¿™ä¹ˆå†™ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">useEffect</span>(()=&gt;{
	<span class="hljs-built_in">fetchData</span>({
		pageNum,
		pageSize,
		searchKey,
		selectType
	})
},
	<span class="hljs-selector-attr">[pageNum,pageSize,searchKey,selectType]</span>
)
</code></pre>
<p>å¤§å¤šæ•°äººæˆ‘æ„Ÿè§‰ä¹Ÿä¼šè¿™ä¹ˆå†™ï¼ŒæŠŠuseEffectå½“æˆâ€œç›‘å¬â€æ¥ä½¿ç”¨ï¼Œå½“æ•°æ®å˜åŒ–æ—¶ï¼Œæ‹¿ç€æœ€æ–°çš„æ•°æ®å‘é€è¯·æ±‚ï¼Œå¥½åƒä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ã€‚</p>
<p>ä½†æ˜¯æŒ‰ç…§Reactå®˜æ–¹çš„è¯´æ³•ï¼Œæ¯ä¸ªäº‹ä»¶å‡½æ•°é‡Œéƒ½è¦å‘é€ä¸€æ¬¡è¯·æ±‚å—ï¼Ÿæˆ‘çš„ç­”æ¡ˆæ˜¯ï¼šä¹Ÿè®¸æ˜¯çš„ã€‚ã€‚ã€‚ä½†å…¶å®ä¹Ÿæ²¡é‚£ä¹ˆå¤æ‚ï¼Œå¤šå†™å‡ æ¬¡è€Œå·²ï¼Œå‰ææ˜¯æŠŠfetchDataæå‰å°è£…å¥½ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">const handleSearch = () =&gt; {
	<span class="hljs-built_in">setPageNum</span>(<span class="hljs-number">1</span>); 
	<span class="hljs-built_in">fetchData</span>(); <span class="hljs-comment">// è°ƒç”¨ç»Ÿä¸€è¯·æ±‚å‡½æ•°</span>
};

const handlePageChange = (newPageNum, newPageSize) =&gt; {
	<span class="hljs-built_in">setPageNum</span>(newPageNum);
	<span class="hljs-built_in">setPageSize</span>(newPageSize);
	<span class="hljs-built_in">fetchData</span>(); <span class="hljs-comment">// è°ƒç”¨ç»Ÿä¸€è¯·æ±‚å‡½æ•°</span>
};

const handleSelectChange = (value) =&gt; {
	<span class="hljs-built_in">setSelectType</span>(value);
	<span class="hljs-built_in">setPageNum</span>(<span class="hljs-number">1</span>); 
	<span class="hljs-built_in">fetchData</span>(); <span class="hljs-comment">// è°ƒç”¨ç»Ÿä¸€è¯·æ±‚å‡½æ•°</span>
};
</code></pre>
<h5 data-id="heading-13"/>
<h4 data-id="heading-14">(ä¸‰) å“åº”å¼ VS å‘½ä»¤å¼â€”â€”æˆ‘ä»¬çœŸçš„éœ€è¦â€œç›‘å¬â€å—ï¼Ÿ</h4>
<p>æ‰¯è¿œä¸€ç‚¹ï¼Œæˆ–è®¸å†è€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬çœŸçš„åœ¨Reactä¸­éœ€è¦å®ç°â€œç›‘å¬â€å—ï¼Ÿ</p>
<p>åœ¨<code>JavaScript</code>å±‚é¢ï¼Œæˆ‘ä»¬æ°¸è¿œåšä¸åˆ°å¯¹ä¸€ä¸ªå˜é‡æ˜¯å¦è¢«æ”¹å˜è¿›è¡Œç›‘å¬ï¼ŒVueå’ŒReactä½œä¸ºJSæ¡†æ¶å½“ç„¶éƒ½æ— æ³•æ”¹å˜è¿™ä¸€ç‚¹ã€‚é‚£ä¸ºä»€ä¹ˆVueå¯ä»¥åšåˆ°ç›‘å¬å‘¢ï¼Ÿç¬”è€…è§‰å¾—è¿™æ¶‰åŠåˆ°ä¸¤ä¸ªæ¡†æ¶å¯¹äº<code>å“åº”å¼è®¾è®¡</code>åœ¨ç†å¿µä¸Šçš„å·¨å¤§å·®å¼‚ï¼Œä¹Ÿå°±æ˜¯å“åº”å¼ç¼–ç¨‹å’Œå‘½ä»¤å¼ç¼–ç¨‹ã€‚</p>
<p>ç®€å•è®²ï¼ŒVueä¸»æ‰“ä¸€ä¸ªâ€œè‡ªåŠ¨åŒ–â€ï¼ŒåŸºäºå‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œå½“ä½ å£°æ˜ä¸€ä¸ªæ•°æ®éœ€è¦ä¸ºâ€œå“åº”å¼â€çš„æ—¶å€™ï¼Œæ¡†æ¶å†…éƒ¨ä¼šåˆ©ç”¨getterå’Œsetterå¸®ä½ è‡ªåŠ¨åœ°è¿›è¡Œä¾èµ–çš„æ”¶é›†å’Œè§¦å‘æ›´æ–°ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">reactive</span>(<span class="hljs-params">target</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(target, {
    <span class="hljs-title function_">get</span>(<span class="hljs-params">obj, key</span>) {
      <span class="hljs-title function_">track</span>(obj, key); <span class="hljs-comment">// å¯åŠ¨ä¾èµ–è·Ÿè¸ª</span>
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">get</span>(obj, key);
    },
    <span class="hljs-title function_">set</span>(<span class="hljs-params">obj, key, value</span>) {
      <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">set</span>(obj, key, value);
      <span class="hljs-title function_">trigger</span>(obj, key); <span class="hljs-comment">// è§¦å‘å‰¯ä½œç”¨</span>
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
  });
}
</code></pre>
<p>è€ŒReactåˆ™æŠŠæ§åˆ¶æƒäº¤ç»™å¼€å‘è€…ï¼Œç±»ä¼¼äºâ€œæ‰‹åŠ¨æŒ¡â€ï¼Œæ ¹æ®<code>UI=f(state)</code>çš„ç†å¿µï¼ŒReactä¸­åªæœ‰çŠ¶æ€è¿™ä¸ªæ¦‚å¿µï¼Œå› æ­¤å¼€å‘è€…å¿…é¡»<strong>æ‰‹åŠ¨</strong>ç®¡ç†å¥½æ¯ä¸€ä¸ªçŠ¶æ€ï¼Œé€šè¿‡è°ƒç”¨<code>setState</code>è¿›è¡ŒçŠ¶æ€ä¿®æ”¹ï¼Œç”±Reactæ¥å¸®ä½ è‡ªåŠ¨é‡æ¸²æŸ“å¹¶æ›´æ–°ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ¯ä¸€å¤„å˜åŠ¨éƒ½æ˜¯å¼€å‘è€…æ‰‹åŠ¨è§¦å‘çš„ï¼ŒReactè‡ªç„¶æ²¡æœ‰è¿›è¡Œè‡ªåŠ¨ç›‘å¬çš„ä¹‰åŠ¡ã€‚</p>
<p>æ‰€ä»¥ç¬”è€…è§‰å¾—ï¼Œæˆ–è®¸å½“æˆ‘ä»¬çœŸçš„éœ€è¦ç”¨Reactæ¥è¿›è¡Œè‡ªåŠ¨ç›‘å¬çš„æ—¶å€™ï¼Œåº”è¯¥æŒæœ‰çš„å®ç°æ€è·¯å¯èƒ½æ˜¯åƒVueä¸€æ ·åŸºäºJSçš„å‘å¸ƒè®¢é˜…è¿™æ¡è·¯å»å®ç°<code>getter</code>å’Œ<code>setter</code>ï¼Œè€Œä¸æ˜¯<code>useEffect</code>ã€‚</p>
<p>å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å·²ç»æ‹¥æœ‰äº†ç¬¬ä¸‰æ–¹åº“<code>Mobx</code>ï¼Œå®ƒä¾¿æ˜¯åŸºäºVueå“åº”å¼ä¸­çš„getterå’Œsetteræ¨¡å¼ï¼Œå®ç°äº†è‡ªåŠ¨ç›‘å¬ã€‚å‡å¦‚ä½ ä½¿ç”¨<code>React + Mobx</code>åˆ™å®Œå…¨ä¸éœ€è¦æ‰‹åŠ¨<code>setState</code>äº†ï¼Œå¯ä»¥çœ‹åˆ°ä¸¤ä¸ªæ¡†æ¶çš„è®¾è®¡æ€æƒ³æ­£åœ¨å‘ç”Ÿä¸€å®šç¨‹åº¦çš„äº¤èã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> {observable, computed} from <span class="hljs-string">"mobx"</span>;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderLine</span> {
    <span class="hljs-meta">@observable</span> price = <span class="hljs-number">0</span>;
    <span class="hljs-meta">@observable</span> amount = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">constructor</span>(price) {
        <span class="hljs-keyword">this</span>.price = price;
    }
  <span class="hljs-comment">// å¾ˆåƒVueçš„computed</span>
    <span class="hljs-meta">@computed</span> <span class="hljs-keyword">get</span> total() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.price * <span class="hljs-keyword">this</span>.amount;
    }
}
</code></pre>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">todos</span> = observable([
    {
        title: <span class="hljs-string">"Make coffee"</span>,
        done: <span class="hljs-literal">true</span>,
    },
])<span class="hljs-comment">;</span>

// reaction å¾ˆåƒwatch
const <span class="hljs-attr">reaction</span> = reaction(
    () =&gt; todos.map(<span class="hljs-attr">todo</span> =&gt; todo.title),
    <span class="hljs-attr">titles</span> =&gt; console.log(<span class="hljs-string">"reaction 2:"</span>, titles.join(<span class="hljs-string">", "</span>))
)<span class="hljs-comment">;</span>

// autorun å¾ˆåƒwatchEffect
const <span class="hljs-attr">autorun1</span> = autorun(
    () =&gt; console.log("autorun 1:", todos.map(<span class="hljs-attr">todo</span> =&gt; todo.title).join(<span class="hljs-string">", "</span>))
)<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-15">ä¸‰ã€å·¨å¤§çš„å¿ƒæ™ºè´Ÿæ‹…ï¼šdepsåˆ°åº•æ€ä¹ˆå†™</h3>
<p>ä»ä»¥ä¸Šä¾‹å­å¯ä»¥çœ‹å‡ºï¼ŒEffectçš„åˆ›ä½œè€…æ‹…å¿ƒå¼€å‘äººå‘˜ç†è§£ä¸äº†è¿™ä¸ªhookï¼Œå› æ­¤ç”¨äº†å¤§é‡çš„æ¡ˆä¾‹æ¥æç¤ºä½¿ç”¨è€…åœ¨æŸäº›åœºæ™¯ä¸‹åˆ«ç”¨Effectï¼Œä½†ç”¨ä¸ç”¨Effectå¯èƒ½è¿˜ä¸æ˜¯æœ€å¤§çš„äº‰è®®ï¼ŒuseEffecté’©å­æœ€å¤§çš„äº‰è®®ç‚¹åº”è¯¥æ˜¯åœ¨äºä¾èµ–æ•°ç»„ï¼Œä¹Ÿå°±æ˜¯depsè¯¥æ€ä¹ˆå†™ï¼Œæ˜¯å¦åº”è¯¥å†™å®Œæ•´ã€‚</p>
<h4 data-id="heading-16">(ä¸€) å®˜æ–¹çš„æ¨èï¼šå†™å…¨depsæ•°ç»„</h4>
<p>æ–‡æ¡£ä¸­æåˆ°ï¼šä»»ä½•å“åº”å¼å€¼éƒ½å¯ä»¥åœ¨é‡æ–°æ¸²æŸ“æ—¶å‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥éœ€è¦å°†å“åº”å¼å€¼åŒ…æ‹¬åœ¨ Effect çš„ä¾èµ–é¡¹ä¸­ã€‚è¿™é‡Œçš„å“åº”å¼å€¼å¯èƒ½å«æœ‰ï¼š</p>
<ul>
<li>
<ol>
<li>state</li>
</ol>
</li>
<li>
<ol start="2">
<li>props</li>
</ol>
</li>
<li>
<ol start="3">
<li>æ‰€æœ‰åœ¨ç»„ä»¶å‡½æ•°ä¸­ç”¨åˆ°çš„æ™®é€šå‡½æ•°å’Œæ™®é€šå˜é‡</li>
</ol>
</li>
</ul>
<p>ä¹Ÿå°±æ˜¯æ‰€æœ‰åœ¨setupä¸­ç”¨åˆ°ï¼Œå¹¶ä¸”å‡½æ•°ç»„ä»¶ä½œç”¨åŸŸå†…çš„å¯èƒ½å˜åŒ–çš„å€¼ï¼Œéƒ½éœ€è¦æ·»åŠ åˆ°depä¸­ã€‚</p>
<p>æ­£æ˜¯è¿™ä¸€ç‚¹ï¼Œç»™å¼€å‘è€…å¸¦æ¥å·¨å¤§çš„å¿ƒæ™ºè´Ÿæ‹…ï¼Œå³ä½¿å®˜æ–¹æ¨èå®‰è£…eslintçš„æ’ä»¶è¾…åŠ©æˆ‘ä»¬è¡¥å…¨depsï¼Œä½†å®è·µä¸­è¿˜æ˜¯å°†å®ƒè®¾ç½®ä¸ºwarningè€Œå¹¶éerrorï¼Œè¿™ä»…ä»…ç›¸å½“äºèµ·åˆ°äº†ä¸€ä¸ªå¿ƒç†å®‰æ…°çš„ä½œç”¨ã€‚</p>
<p>ç‰¹åˆ«æ˜¯å½“depç”¨åˆ°äº†å‡½æ•°çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå¯¼è‡´useCallbackåµŒå¥—çš„é—®é¢˜</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">//ç»„ä»¶å‡½æ•°ä½“å†…éƒ¨</span>
function <span class="hljs-built_in">init</span>(){
	<span class="hljs-comment">// æ¯æ¬¡é‡æ¸²æŸ“éƒ½ä¼šäº§ç”Ÿæ–°å¼•ç”¨</span>
}

<span class="hljs-built_in">useEffect</span>(()=&gt;{
	<span class="hljs-built_in">init</span>(data) <span class="hljs-comment">// ä¼šé¢‘ç¹è§¦å‘</span>
},<span class="hljs-selector-attr">[data,init]</span>) 
</code></pre>
<p>æ·»åŠ useCallback</p>
<pre><code class="hljs language-scss" lang="scss">const initFn=<span class="hljs-built_in">useCallback</span>(init,[dep])
<span class="hljs-comment">// å¦‚æœdepé‡Œé¢è¿˜æœ‰å‡½æ•°ï¼Œå¯èƒ½éœ€è¦å†æ¬¡åŒ…è£¹useCallbackï¼Œä»£ç å¯è¯»æ€§ä¼šé™ä½å¾ˆå¤š</span>

<span class="hljs-built_in">useEffect</span>(()=&gt;{
	<span class="hljs-built_in">initFn</span>(data) <span class="hljs-comment">// ä¼šé¢‘ç¹è§¦å‘</span>
},<span class="hljs-selector-attr">[data,initFn]</span>) 
</code></pre>
<h4 data-id="heading-17">(äºŒ) å…ˆå®ç°setupï¼Œå†ç¡®å®šdepsï¼Œè€Œä¸æ˜¯åè¿‡æ¥</h4>
<p>å®˜æ–¹æ–‡æ¡£æåˆ°ï¼Œdepæ•°ç»„æ˜¯å®Œå…¨ç”±setupå‡½æ•°ç¡®å®šçš„ï¼Œè€Œä¸æ˜¯ç”±å¼€å‘è€…é€‰æ‹©çš„</p>
<p>ä¸ªäººæ˜¯è¿™ä¹ˆç†è§£çš„ï¼š</p>
<ol>
<li>
<ol>
<li>ä½ åº”è¯¥å…ˆç¡®å®šè¿™é‡Œçš„å‰¯ä½œç”¨æ˜¯ä»€ä¹ˆ</li>
<li>depæ˜¯å‰¯ä½œç”¨çš„è¿‡æ»¤å™¨ï¼Œé€šè¿‡æŒ‡å®šdepæ¥è·³è¿‡å‰¯ä½œç”¨çš„æ‰§è¡Œï¼Œä¿è¯æ€§èƒ½</li>
<li>åŒæ ·åœ°ï¼Œå¦‚æœè¦ä¿®æ”¹depï¼Œåº”è¯¥å…ˆä¿®æ”¹setupï¼Œè€Œä¸æ˜¯åè¿‡æ¥</li>
<li>å¦‚æœæŠ±ç€â€œç›‘å¬â€çš„æ€ç»´å»ç†è§£ï¼Œä¼šå…ˆç¡®å®šdepï¼ˆä½ è¦ç›‘å¬çš„ä¸œè¥¿ï¼‰å†å®ç°setupï¼Œé‚£æ ·çš„è¯ï¼Œä½ å¯èƒ½ä¼šæ¼å†™dep</li>
</ol>
</li>
</ol>
<h3 data-id="heading-18">å››ã€å¦‚ä½•å»ºç«‹è‡ªå·±çš„æœ€ä½³å®è·µ</h3>
<p>æ—¢ç„¶<code>useEffect</code>çš„å¿ƒæ™ºè´Ÿæ‹…é‚£ä¹ˆé‡ï¼Œæˆ‘ä»¬åº”è¯¥è¿™ä¹ˆåšï¼Œä»¥ä¸‹æ˜¯ä¸€ç‚¹ä¸ªäººçš„æ€è€ƒ</p>
<h4 data-id="heading-19">1.å°½é‡å¤šä½¿ç”¨æˆç†Ÿçš„ç¬¬ä¸‰æ–¹åº“ï¼Œå‡å°‘è‡ªå·±è£¸å†™<code>useEffect</code>çš„æƒ…æ™¯</h4>
<ul>
<li>çŠ¶æ€ç®¡ç†ä¸Šï¼Œå·²ç»æœ‰å¾ˆå¤šç¬¬ä¸‰æ–¹åº“å¸®ä½ è§£å†³æ•°æ®çš„æ”¶é›†å’Œæ›´æ–°çš„é—®é¢˜äº†ï¼Œæ¯”å¦‚Mobxå’ŒZustandï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯å‘å¸ƒè®¢é˜…çš„æ¨¡å¼</li>
<li>å‘é€è¯·æ±‚ä¸Šï¼Œä¼˜å…ˆä½¿ç”¨Tanstack-Queryã€SWRã€ahooksä¸­çš„useRequestç­‰ç¬¬ä¸‰æ–¹åº“ï¼Œæ¥å‘é€è¯·æ±‚ï¼Œå¸®ä½ ç®¡ç†è¯·æ±‚ä¸­çš„å„ç§é—®é¢˜ï¼ˆåŒ…æ‹¬ç½‘ç»œç«æ€ã€æ•°æ®ç¼“å­˜ã€loading errorç®¡ç†ç­‰ï¼‰ï¼Œæ¯”è‡ªå·±å†™useEffectè¦ç¨³å¾—å¤šã€‚</li>
</ul>
<h4 data-id="heading-20">2.å¯ä»¥ä½¿ç”¨<code>useEffect</code>çš„æƒ…å†µ</h4>
<ul>
<li>éœ€è¦æ“ä½œåŸç”Ÿdomå…ƒç´ çš„æƒ…å†µï¼šæ¯”å¦‚æ‰‹åŠ¨è®¾ç½®å…ƒç´ çš„<code>scrollTop</code>çš„å€¼</li>
<li>ç¡®ä¿å‰¯ä½œç”¨ä»…ä¸€æ¬¡æ€§æ‰§è¡Œï¼Œå¯ä»¥ä½¿ç”¨ç©ºæ•°ç»„çš„åœºæ™¯ï¼šæ¯”å¦‚åˆå§‹åŒ–ç¬¬ä¸‰æ–¹SDK</li>
<li>ç›‘å¬æµè§ˆå™¨åŸç”Ÿäº‹ä»¶çš„æƒ…å†µï¼šæ¯”å¦‚çª—å£å¤§å°å˜åŒ–<code>window.resize</code></li>
<li>éœ€è¦å’Œå¤–éƒ¨ç¯å¢ƒè¿›è¡ŒåŒæ­¥çš„æƒ…å†µï¼šæ¯”å¦‚websocketé“¾æ¥ï¼ŒSSEé“¾æ¥ç­‰</li>
<li>ä½ è§‰å¾—è‡ªå·±å®Œå…¨ææ‡‚äº†useEffectçš„è¯å¯ä»¥ç”¨ã€‚ã€‚ã€‚ï¼ˆåæ­£æˆ‘æ˜¯æ²¡ææ‡‚ã€‚ã€‚ï¼‰</li>
</ul>
<h4 data-id="heading-21">3.åä½œå¼€å‘çš„è¿‡ç¨‹éœ€è¦å’Œå›¢é˜Ÿå¯¹é½è§‚å¿µ</h4>
<p>å¦‚æœæ˜¯å›¢é˜Ÿå¼€å‘çš„è¯ï¼Œè¦èƒ½çœ‹æ‡‚å¹¶ç†è§£åˆ«äººçš„ä»£ç ï¼Œè€Œä¸æ˜¯å¼ºè¿«åˆ«äººç†è§£è‡ªå·±çš„è§‚ç‚¹ã€‚å›¢é˜Ÿçš„é¢†å¯¼è€…æœ€å¥½èƒ½åˆ¶å®šä¸€ä»½å›¢é˜Ÿçš„å¼€å‘è§„èŒƒï¼Œæ‹‰é½æ‰€æœ‰äººçš„æŠ€æœ¯è®¤çŸ¥ã€‚å½“ç„¶è¿™ä¸æ˜¯æˆ‘è¿™ç§æ–°æ‰‹è¯¥è€ƒè™‘çš„ä¸œè¥¿ï¼Œåªèƒ½è¯´é¢†å¯¼è®©æ€ä¹ˆåšå°±æ€ä¹ˆåšQvQã€‚</p>
<h3 data-id="heading-22">äº”ã€å†™åœ¨æœ€å</h3>
<p>ä½œä¸ºä¸€ç‚¹Vueè½¬Reactçš„æ–°æ‰‹ï¼Œæœ‰å‡ ç‚¹ä¸ªäººçš„ä¸»è§‚æ„Ÿå—æƒ³æä¸€ä¸‹</p>
<ol>
<li>Reactåªæ˜¯ä¸€ä¸ªJSåº“ï¼Œå®ƒæ²¡æœ‰ä¹‰åŠ¡è¦†ç›–å‰ç«¯æ‰€æœ‰çš„ä¸šåŠ¡åœºæ™¯ï¼Œä¹Ÿæ²¡ä¹‰åŠ¡æä¾›æ‰€è°“çš„æœ€ä½³å®è·µï¼Œè€Œæ˜¯è®©å¼€å‘è€…è‡ªå·±é€‰æ‹©ï¼Œè¿™ç§ç†å¿µåº”è¯¥æ˜¯å¯ä»¥ç†è§£çš„ã€‚</li>
<li>ä½†ä¸ç®¡æ€ä¹ˆè¯´ï¼Œ<code>useEffect</code>éƒ½æ˜¯ä¸€ä¸ªè®¤çŸ¥æ›²çº¿æå…¶é™¡å³­ã€ç»™å¼€å‘è€…é€ æˆå·¨å¤§å¿ƒæ™ºè´Ÿæ‹…çš„APIï¼Œä»å¼€å‘æ–‡æ¡£çš„ç¯‡å¹…ä»¥åŠReactæå‡ºçš„<code>useEffectEvent</code>å°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œä½†å…¶å®éƒ½æ˜¯åœ¨ç¼ç¼è¡¥è¡¥ã€‚</li>
<li>å®˜æ–¹å¯¹è¿™ä¸ªAPIçš„è®¾è®¡ç†å¿µï¼Œå’Œå¼€å‘è€…çš„æ—¥å¸¸ç”¨æ³•å­˜åœ¨ä¸å°‘çš„å‰²è£‚ï¼Œè¿™ä¹Ÿæ˜¯å®˜æ–¹æ–‡æ¡£ç”¨å¤§éƒ¨åˆ†ç¯‡å¹…æ¥è®²è¿™ä¸ªhookçš„åŸå› ï¼Œå°±æ˜¯ä¸ºäº†è®©å¼€å‘è€…å°‘ç”¨ï¼Œå°‘æ»¥ç”¨ã€‚</li>
<li>ä»ä½“éªŒä¸Šçœ‹ï¼ŒVueå³ä½¿å¯¹åº•å±‚åŸç†ä¸é‚£ä¹ˆç†Ÿæ‚‰ä¹Ÿèƒ½è¿›è¡Œå¼€å‘ï¼Œä½†Reactçš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œè¿˜æ˜¯éœ€è¦ä¸æ–­æŒ‰ç…§Reactçš„æœºåˆ¶å»æ¨¡æ‹Ÿæ•´ä¸ªæµç¨‹ï¼Œæ‰€ä»¥ç†è§£åŸç†è¿˜æ˜¯æ¯”è¾ƒé‡è¦ã€‚è‡³äºè¿™æ˜¯ä¸æ˜¯æ¡†æ¶åœ¨ç”©é”…ç»™å¼€å‘è€…ï¼Œå°±è§ä»è§æ™ºäº†ã€‚</li>
</ol>
<h3 data-id="heading-23">å…­ã€å‚è€ƒ</h3>
<ol>
<li>ã€Šä¸ºä»€ä¹ˆæˆ‘ä»¬è¦åˆ æ‰100%çš„useEffectã€‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.yuque.com%2Fjiango%2Fcode%2Fgood-bye-use-effect%23a6Ch9" target="_blank" title="https://www.yuque.com/jiango/code/good-bye-use-effect#a6Ch9" ref="nofollow noopener noreferrer">www.yuque.com/jiango/codeâ€¦</a></li>
<li>ã€ŠReact hookä½¿ç”¨è¯¯åŒºï¼Œé©³å®˜æ–¹æ–‡æ¡£ã€‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F450513902" target="_blank" title="https://zhuanlan.zhihu.com/p/450513902" ref="nofollow noopener noreferrer">zhuanlan.zhihu.com/p/450513902</a></li>
<li>ã€ŠA Complete Guide to useEffectã€‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Foverreacted.io%2Fa-complete-guide-to-useeffect%2F" target="_blank" title="https://overreacted.io/a-complete-guide-to-useeffect/" ref="nofollow noopener noreferrer">overreacted.io/a-complete-â€¦</a></li>
<li>ã€Šç²¾è¯»useEffectå®Œå…¨æŒ‡å—ã€‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F60277120" target="_blank" title="https://zhuanlan.zhihu.com/p/60277120" ref="nofollow noopener noreferrer">zhuanlan.zhihu.com/p/60277120</a></li>
<li>Reactå®˜æ–¹æ–‡æ¡£ã€Šè„±å›´æœºåˆ¶ã€‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fzh-hans.react.dev%2Flearn%2Fescape-hatches" target="_blank" title="https://zh-hans.react.dev/learn/escape-hatches" ref="nofollow noopener noreferrer">zh-hans.react.dev/learn/escapâ€¦</a></li>
<li>Reactå®˜æ–¹æ–‡æ¡£ useEffectï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fzh-hans.react.dev%2Freference%2Freact%2FuseEffect" target="_blank" title="https://zh-hans.react.dev/reference/react/useEffect" ref="nofollow noopener noreferrer">zh-hans.react.dev/reference/râ€¦</a></li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Messageç»„ä»¶å’ŒVue3 è¿›é˜¶ï¼šæ‰‹åŠ¨æŒ‚è½½ç»„ä»¶ä¸ Diff ç®—æ³•æ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7595871887001157632</link>    <guid>https://juejin.cn/post/7595871887001157632</guid>    <pubDate>2026-01-17T08:24:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595871887001157632" data-draft-id="7595871887001141248" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Messageç»„ä»¶å’ŒVue3 è¿›é˜¶ï¼šæ‰‹åŠ¨æŒ‚è½½ç»„ä»¶ä¸ Diff ç®—æ³•æ·±åº¦è§£æ"/> <meta itemprop="keywords" content="Vue.js,å‰ç«¯æ¡†æ¶"/> <meta itemprop="datePublished" content="2026-01-17T08:24:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¹²æ­»å‰ç«¯"/> <meta itemprop="url" content="https://juejin.cn/user/1486957885265400"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Messageç»„ä»¶å’ŒVue3 è¿›é˜¶ï¼šæ‰‹åŠ¨æŒ‚è½½ç»„ä»¶ä¸ Diff ç®—æ³•æ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1486957885265400/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¹²æ­»å‰ç«¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T08:24:01.000Z" title="Sat Jan 17 2026 08:24:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10862e9655534fde81d62ac8a0a6ae11~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bmy5q275YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769243041&amp;x-signature=N7zA2RCqEgobX5S3upfbxKuSuIM%3D" alt="ai_image_1768638049154_1.jpg" loading="lazy"/></p>
<h2 data-id="heading-0">Vue3 è¿›é˜¶ï¼šæ‰‹åŠ¨æŒ‚è½½ç»„ä»¶ä¸ Diff ç®—æ³•æ·±åº¦è§£æ</h2>
<blockquote>
<p>å¾ˆå¤š Vue å¼€å‘è€…ä¹ æƒ¯äº†åœ¨ <code>&lt;template&gt;</code> é‡Œå†™ç»„ä»¶ï¼Œä½†åœ¨å¼€å‘ <code>Message</code>ï¼ˆå…¨å±€æç¤ºï¼‰ã€<code>Modal</code>ï¼ˆæ¨¡æ€æ¡†ï¼‰æˆ– <code>Notification</code>ï¼ˆé€šçŸ¥ï¼‰è¿™ç±»ç»„ä»¶æ—¶ï¼Œæˆ‘ä»¬å¾€å¾€å¸Œæœ›é€šè¿‡ JS å‡½æ•°ç›´æ¥è°ƒç”¨ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ªé¡µé¢éƒ½å†™ä¸€ä¸ª <code>&lt;MyMessage /&gt;</code> æ ‡ç­¾ã€‚æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥ Vue3 åº•å±‚ï¼Œçœ‹çœ‹å¦‚ä½•<strong>æ‰‹åŠ¨æ¸²æŸ“ç»„ä»¶</strong>ã€‚</p>
</blockquote>
<h3 data-id="heading-1">1. ä¸ºä»€ä¹ˆéœ€è¦æ‰‹åŠ¨æŒ‚è½½ï¼Ÿ</h3>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœä½ æƒ³å¼¹å‡ºä¸€ä¸ªæˆåŠŸæç¤ºï¼Œå“ªç§æ–¹å¼æ›´ä¼˜é›…ï¼Ÿ</p>
<p><strong>æ–¹å¼ A (å£°æ˜å¼)</strong>ï¼š
éœ€è¦åœ¨æ¯ä¸ªé¡µé¢çš„ template é‡Œéƒ½å†™ä¸€éç»„ä»¶ï¼Œè¿˜è¦å®šä¹‰ä¸€ä¸ªå˜é‡æ¥æ§åˆ¶æ˜¾ç¤ºéšè—ã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">MyMessage</span> <span class="hljs-attr">:visible</span>=<span class="hljs-string">"showMsg"</span> <span class="hljs-attr">message</span>=<span class="hljs-string">"æ“ä½œæˆåŠŸ"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"showMsg = true"</span>&gt;</span>ç‚¹å‡»<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p><strong>æ–¹å¼ B (å‘½ä»¤å¼)</strong>ï¼š
ç›´æ¥åœ¨ JS é‡Œè°ƒç”¨ï¼Œéšç”¨éšè°ƒï¼Œå®Œå…¨è§£è€¦ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { message } <span class="hljs-keyword">from</span> <span class="hljs-string">'my-ui'</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleClick</span>(<span class="hljs-params"/>) {
  message.<span class="hljs-title function_">success</span>(<span class="hljs-string">'æ“ä½œæˆåŠŸ'</span>)
}
</code></pre>
<p>æ˜¾ç„¶ï¼Œæ–¹å¼ B æ˜¯ç»„ä»¶åº“çš„æ ‡å‡†åšæ³•ã€‚ä½† Vue çš„ç»„ä»¶é€šå¸¸æ˜¯æ¸²æŸ“åœ¨çˆ¶ç»„ä»¶çš„æ¨¡æ¿é‡Œçš„ï¼Œå¦‚ä½•æŠŠå®ƒâ€œå‡­ç©ºâ€å˜å‡ºæ¥å¹¶æŒ‚è½½åˆ° <code>document.body</code> ä¸Šå‘¢ï¼Ÿ</p>
<p>è¿™å°±éœ€è¦ç”¨åˆ° Vue3 æš´éœ²çš„ä¸¤ä¸ªåº•å±‚ APIï¼š<code>createVNode</code> å’Œ <code>render</code>ã€‚</p>
<h3 data-id="heading-2">2. æ ¸å¿ƒ API è§£å¯†</h3>
<h4 data-id="heading-3">createVNodeï¼šç”»å›¾çº¸</h4>
<p>åœ¨ Vue ä¸­ï¼Œä¸€åˆ‡çš† VNodeï¼ˆè™šæ‹ŸèŠ‚ç‚¹ï¼‰ã€‚æ™®é€šçš„ <code>.vue</code> æ–‡ä»¶åªæ˜¯ä¸€ä¸ªç»„ä»¶å®šä¹‰ï¼Œå®ƒä¸æ˜¯ DOMï¼Œä¹Ÿä¸æ˜¯ VNodeã€‚æˆ‘ä»¬éœ€è¦ç”¨ <code>createVNode</code> æŠŠå®ƒå®ä¾‹åŒ–ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { createVNode } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">MyComponent</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./MyComponent.vue'</span>

<span class="hljs-comment">// è¿™å°±åƒæ˜¯æ‹¿ç€å›¾çº¸ (MyComponent)</span>
<span class="hljs-comment">// åˆ›å»ºäº†ä¸€ä¸ªå…·ä½“çš„å®ä¾‹åŒ–å¯¹è±¡ (vm)</span>
<span class="hljs-comment">// ç¬¬äºŒä¸ªå‚æ•°æ˜¯ props</span>
<span class="hljs-keyword">const</span> vnode = <span class="hljs-title function_">createVNode</span>(<span class="hljs-title class_">MyComponent</span>, { <span class="hljs-attr">title</span>: <span class="hljs-string">'Hello'</span> })
</code></pre>
<h4 data-id="heading-4">renderï¼šæ–½å·¥é˜Ÿ</h4>
<p>æœ‰äº† VNodeï¼Œå®ƒè¿˜åªæ˜¯å†…å­˜é‡Œçš„å¯¹è±¡ã€‚æˆ‘ä»¬éœ€è¦ <code>render</code> å‡½æ•°æŠŠå®ƒå˜æˆçœŸå®çš„ DOM èŠ‚ç‚¹ï¼Œå¹¶æŒ‚è½½åˆ°æŸä¸ªå®¹å™¨ä¸Šã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { render } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>)
<span class="hljs-comment">// æŠŠ vnode æ¸²æŸ“åˆ° container ç›’å­é‡Œ</span>
<span class="hljs-title function_">render</span>(vnode, container)

<span class="hljs-comment">// æœ€åæŠŠç›’å­æ”¾åˆ° body ä¸Š</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(container)
</code></pre>
<h3 data-id="heading-5">3. å®æˆ˜ï¼šæ‰‹å†™ä¸€ä¸ªç®€å•çš„ Message å‡½æ•°</h3>
<p>è®©æˆ‘ä»¬æ¥çœ‹çœ‹ <code>packages/components/message/src/method.ts</code> æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p>
<h4 data-id="heading-6">ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå®¹å™¨ä¸ VNode</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { createVNode, render } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">MessageConstructor</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./message.vue'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">message</span>(<span class="hljs-params">options</span>) {
  <span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„ div å®¹å™¨</span>
  <span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>)

  <span class="hljs-comment">// 2. åˆ›å»º VNodeï¼Œå¹¶å°† options ä½œä¸º props ä¼ å…¥</span>
  <span class="hljs-comment">// ä¾‹å¦‚ï¼šcreateVNode(MessageConstructor, { message: 'ä½ å¥½', type: 'success' })</span>
  <span class="hljs-keyword">const</span> vnode = <span class="hljs-title function_">createVNode</span>(<span class="hljs-title class_">MessageConstructor</span>, options)

  <span class="hljs-comment">// 3. å°† VNode æ¸²æŸ“åˆ° container ä¸­</span>
  <span class="hljs-comment">// æ­¤æ—¶ container.firstElementChild å°±æ˜¯ç»„ä»¶ç”Ÿæˆçš„çœŸå® DOM</span>
  <span class="hljs-title function_">render</span>(vnode, container)

  <span class="hljs-comment">// 4. å°†çœŸå® DOM è¿½åŠ åˆ° body</span>
  <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(container.<span class="hljs-property">firstElementChild</span>!)
}
</code></pre>
<h4 data-id="heading-7">ç¬¬äºŒæ­¥ï¼šå¤„ç†ç»„ä»¶å¸è½½</h4>
<p>è¿™å°±å®Œäº‹äº†å—ï¼Ÿå¹¶æ²¡æœ‰ã€‚å¦‚æœæˆ‘ä»¬ä¸å¤„ç†é”€æ¯é€»è¾‘ï¼Œè¿™äº› DOM èŠ‚ç‚¹ä¼šä¸€ç›´å †ç§¯åœ¨ body é‡Œï¼Œé€ æˆå†…å­˜æ³„æ¼ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦åœ¨ç»„ä»¶å†…éƒ¨å‘å°„ä¸€ä¸ª <code>destroy</code> äº‹ä»¶ï¼ˆæ¯”å¦‚åœ¨åŠ¨ç”»ç»“æŸæ—¶ï¼‰ï¼Œç„¶ååœ¨å¤–éƒ¨ç›‘å¬å®ƒã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">const</span> vnode = <span class="hljs-title function_">createVNode</span>(<span class="hljs-title class_">MessageConstructor</span>, {
  ...options,
  <span class="hljs-comment">// ç›‘å¬ç»„ä»¶å†…éƒ¨ emit('destroy')</span>
  <span class="hljs-attr">onDestroy</span>: <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// ç§»é™¤ DOM</span>
    <span class="hljs-title function_">render</span>(<span class="hljs-literal">null</span>, container) <span class="hljs-comment">// è¿™ä¸€æ­¥ä¼šè§¦å‘ç»„ä»¶çš„ unmounted é’©å­</span>
  }
})
</code></pre>
<h3 data-id="heading-8">4. æºç æ·±æ½œï¼šcreateVNode å’Œ render åˆ°åº•å¹²äº†å•¥ï¼Ÿ</h3>
<p>å¯¹äºå¥½å¥‡å¿ƒå¼ºçš„åŒå­¦ï¼Œå¯èƒ½æƒ³çŸ¥é“ï¼šVue å†…éƒ¨åˆ°åº•æ˜¯æ€ä¹ˆæŠŠè¿™å‡ è¡Œä»£ç å˜æˆé¡µé¢çš„ï¼Ÿè®©æˆ‘ä»¬ç”¨æœ€é€šä¿—çš„ä¼ªä»£ç æ¥æ‹†è§£ä¸€ä¸‹ã€‚</p>
<h4 data-id="heading-9">4.1 createVNodeï¼šç»™èŠ‚ç‚¹â€œæ‰“æ ‡ç­¾â€</h4>
<p><code>createVNode</code> çš„æ ¸å¿ƒä»»åŠ¡ä¸ä»…ä»…æ˜¯åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œæ›´æ˜¯ä¸ºäº†<strong>æ€§èƒ½ä¼˜åŒ–</strong>ã€‚å®ƒä¼šæ ¹æ®ä½ ä¼ å…¥çš„ç±»å‹ï¼Œç»™ VNode æ‰“ä¸Šä¸€ä¸ªäºŒè¿›åˆ¶æ ‡è®°ï¼ˆShapeFlagï¼‰ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä¼ªä»£ç ç®€åŒ–ç‰ˆ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createVNode</span>(<span class="hljs-params"><span class="hljs-keyword">type</span>, props, children</span>) {
  <span class="hljs-comment">// 1. å®šä¹‰ VNode ç»“æ„</span>
  <span class="hljs-keyword">const</span> vnode = {
    <span class="hljs-keyword">type</span>, <span class="hljs-comment">// ç»„ä»¶å¯¹è±¡ æˆ– 'div' æ ‡ç­¾å</span>
    props,
    children,
    <span class="hljs-attr">component</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// ç¨åæŒ‚è½½ç»„ä»¶å®ä¾‹</span>
    <span class="hljs-attr">el</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// ç¨åæŒ‚è½½çœŸå® DOM</span>
    <span class="hljs-attr">shapeFlag</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// æ ¸å¿ƒï¼šç±»å‹æ ‡è®°</span>
  }

  <span class="hljs-comment">// 2. é€šè¿‡ä½è¿ç®—æ‰“æ ‡è®°</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">type</span> === <span class="hljs-string">'string'</span>) {
    vnode.<span class="hljs-property">shapeFlag</span> = <span class="hljs-title class_">ShapeFlags</span>.<span class="hljs-property">ELEMENT</span> <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ª HTML æ ‡ç­¾ (div, span)</span>
  }
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">type</span> === <span class="hljs-string">'object'</span>) {
    vnode.<span class="hljs-property">shapeFlag</span> = <span class="hljs-title class_">ShapeFlags</span>.<span class="hljs-property">STATEFUL_COMPONENT</span> <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ª Vue ç»„ä»¶</span>
  }

  <span class="hljs-keyword">return</span> vnode
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Ÿ</strong>
Vue çš„æ›´æ–°è¿‡ç¨‹éå¸¸é¢‘ç¹ã€‚æœ‰äº† <code>shapeFlag</code>ï¼Œåœ¨åç»­çš„ Diff è¿‡ç¨‹ä¸­ï¼ŒVue å°±ä¸éœ€è¦æ¯æ¬¡éƒ½å»çŒœâ€œè¿™æ˜¯ä¸ªå•¥â€ï¼Œç›´æ¥çœ‹äºŒè¿›åˆ¶ä½å°±çŸ¥é“æ€ä¹ˆå¤„ç†ï¼Œé€Ÿåº¦æå¿«ã€‚</p>
<h4 data-id="heading-10">4.2 renderï¼šä¸‡èƒ½çš„åŒ…å·¥å¤´</h4>
<p><code>render</code> å‡½æ•°å…¶å®éå¸¸ç®€å•ï¼Œå®ƒèƒŒåçœŸæ­£çš„å¹²æ´»ä¸»åŠ›æ˜¯ <code>patch</code> å‡½æ•°ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ä¼ªä»£ç ç®€åŒ–ç‰ˆ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params">vnode, container</span>) {
  <span class="hljs-keyword">if</span> (vnode == <span class="hljs-literal">null</span>) {
    <span class="hljs-comment">// å¦‚æœä¼  nullï¼Œè¯´æ˜è¦é”€æ¯</span>
    <span class="hljs-keyword">if</span> (container.<span class="hljs-property">_vnode</span>) {
      <span class="hljs-title function_">unmount</span>(container.<span class="hljs-property">_vnode</span>) <span class="hljs-comment">// å¸è½½æ—§èŠ‚ç‚¹</span>
    }
  }
  <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// å¦‚æœæœ‰æ–° VNodeï¼Œå°±å¼€å§‹â€œæ‰“è¡¥ä¸â€</span>
    <span class="hljs-comment">// å‚æ•°ï¼š(æ—§èŠ‚ç‚¹, æ–°èŠ‚ç‚¹, å®¹å™¨)</span>
    <span class="hljs-title function_">patch</span>(container.<span class="hljs-property">_vnode</span> || <span class="hljs-literal">null</span>, vnode, container)
  }

  <span class="hljs-comment">// è®°ä½è¿™æ¬¡æ¸²æŸ“çš„ VNodeï¼Œä¸‹æ¬¡æ›´æ–°æ—¶å®ƒå°±æ˜¯â€œæ—§èŠ‚ç‚¹â€äº†</span>
  container.<span class="hljs-property">_vnode</span> = vnode
}
</code></pre>
<h4 data-id="heading-11">4.3 patchï¼šåˆ†å‘ä»»åŠ¡</h4>
<p><code>patch</code> æ˜¯ Vue æ¸²æŸ“å™¨çš„æ ¸å¿ƒã€‚å®ƒæ ¹æ®æˆ‘ä»¬å‰é¢æ‰“çš„ <code>shapeFlag</code>ï¼ŒæŠŠä»»åŠ¡åˆ†å‘ç»™ä¸åŒçš„å¤„ç†å‡½æ•°ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">patch</span>(<span class="hljs-params">n1, n2, container</span>) {
  <span class="hljs-keyword">if</span> (n1 &amp;&amp; !<span class="hljs-title function_">isSameVNodeType</span>(n1, n2)) {
    <span class="hljs-comment">// å¦‚æœç±»å‹éƒ½ä¸ä¸€æ ·ï¼ˆæ¯”å¦‚ä» div å˜æˆäº† spanï¼‰ï¼Œç›´æ¥å¸è½½æ—§çš„</span>
    <span class="hljs-title function_">unmount</span>(n1)
    n1 = <span class="hljs-literal">null</span>
  }

  <span class="hljs-keyword">const</span> { shapeFlag } = n2
  <span class="hljs-keyword">if</span> (shapeFlag &amp; <span class="hljs-title class_">ShapeFlags</span>.<span class="hljs-property">ELEMENT</span>) {
    <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ª HTML æ ‡ç­¾</span>
    <span class="hljs-title function_">processElement</span>(n1, n2, container)
  }
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (shapeFlag &amp; <span class="hljs-title class_">ShapeFlags</span>.<span class="hljs-property">COMPONENT</span>) {
    <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ª Vue ç»„ä»¶</span>
    <span class="hljs-title function_">processComponent</span>(n1, n2, container)
  }
}
</code></pre>
<h4 data-id="heading-12">4.4 æ·±å…¥ processComponentï¼šç»„ä»¶æ˜¯æ€ä¹ˆè·‘èµ·æ¥çš„ï¼Ÿ</h4>
<p>å½“ <code>patch</code> å‘ç°è¿™æ˜¯ä¸ªç»„ä»¶æ—¶ï¼Œå®ƒä¼šåŒºåˆ†æ˜¯â€œåˆæ¬¡æŒ‚è½½â€è¿˜æ˜¯â€œæ›´æ–°â€ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">processComponent</span>(<span class="hljs-params">n1, n2, container</span>) {
  <span class="hljs-keyword">if</span> (n1 == <span class="hljs-literal">null</span>) {
    <span class="hljs-comment">// 1. æŒ‚è½½ç»„ä»¶ (Mount)</span>
    <span class="hljs-title function_">mountComponent</span>(n2, container)
  }
  <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// 2. æ›´æ–°ç»„ä»¶ (Update)</span>
    <span class="hljs-title function_">updateComponent</span>(n1, n2)
  }
}
</code></pre>
<p><strong>mountComponent åšçš„äº‹æƒ…ï¼š</strong></p>
<ol>
<li><strong>åˆ›å»ºå®ä¾‹</strong>ï¼š<code>const instance = createComponentInstance(vnode)</code>ã€‚</li>
<li><strong>è®¾ç½®çŠ¶æ€</strong>ï¼šåˆå§‹åŒ– <code>props</code>ã€<code>slots</code>ï¼Œæ‰§è¡Œ <code>setup()</code> å‡½æ•°ã€‚</li>
<li><strong>å»ºç«‹å‰¯ä½œç”¨</strong>ï¼šåˆ›å»ºä¸€ä¸ª <code>effect</code>ï¼ˆå“åº”å¼å‰¯ä½œç”¨ï¼‰ï¼Œè¿è¡Œç»„ä»¶çš„ <code>render</code> å‡½æ•°ç”Ÿæˆå­æ ‘ï¼ˆsubTreeï¼‰ï¼Œå¹¶ç›‘å¬å“åº”å¼æ•°æ®å˜åŒ–ã€‚</li>
</ol>
<h4 data-id="heading-13">4.5 æ·±å…¥ processElementï¼šæŒ‚è½½ä¸æ›´æ–°</h4>
<p>å½“ <code>patch</code> é‡åˆ° HTML æ ‡ç­¾æ—¶ï¼Œä¼šæ ¹æ® <code>n1</code>ï¼ˆæ—§èŠ‚ç‚¹ï¼‰æ˜¯å¦å­˜åœ¨æ¥å†³å®šæ˜¯åˆå§‹åŒ–è¿˜æ˜¯æ›´æ–°ã€‚</p>
<h5 data-id="heading-14">1. æŒ‚è½½ (Mount)</h5>
<p>å¦‚æœ <code>n1</code> ä¸º <code>null</code>ï¼Œè¯´æ˜æ˜¯åˆæ¬¡æ¸²æŸ“ã€‚Vue ä¼šè°ƒç”¨å®¿ä¸»ç¯å¢ƒçš„ APIï¼ˆå¦‚ <code>document.createElement</code>ï¼‰åˆ›å»ºçœŸå® DOMï¼Œå¹¶å°†å…¶æ’å…¥åˆ°å®¹å™¨ä¸­ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">mountElement</span>(<span class="hljs-params">vnode, container</span>) {
  <span class="hljs-comment">// 1. åˆ›å»ºçœŸå® DOM</span>
  <span class="hljs-keyword">const</span> el = (vnode.<span class="hljs-property">el</span> = <span class="hljs-title function_">hostCreateElement</span>(vnode.<span class="hljs-property">type</span>))

  <span class="hljs-comment">// 2. å¤„ç† Props (Style, Class, Event)</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> vnode.<span class="hljs-property">props</span>) {
    <span class="hljs-title function_">hostPatchProp</span>(el, key, <span class="hljs-literal">null</span>, vnode.<span class="hljs-property">props</span>[key])
  }

  <span class="hljs-comment">// 3. å¤„ç†å­èŠ‚ç‚¹ (é€’å½’ mount)</span>
  <span class="hljs-title function_">mountChildren</span>(vnode.<span class="hljs-property">children</span>, el)

  <span class="hljs-comment">// 4. æ’å…¥é¡µé¢</span>
  <span class="hljs-title function_">hostInsert</span>(el, container)
}
</code></pre>
<h5 data-id="heading-15">2. æ›´æ–° (Patch)</h5>
<p>å¦‚æœ <code>n1</code> å­˜åœ¨ï¼ŒVue å°±éœ€è¦å¯¹æ¯”æ–°æ—§èŠ‚ç‚¹ï¼Œåšæœ€å°é‡çš„ DOM æ“ä½œã€‚</p>
<ol>
<li><strong>æ›´æ–° Props</strong>ï¼šå¯¹æ¯”æ–°æ—§ Propsï¼Œä¿®æ”¹å˜åŠ¨çš„ Classã€Style æˆ–äº‹ä»¶ç›‘å¬å™¨ã€‚</li>
<li><strong>æ›´æ–° Children (æ ¸å¿ƒ Diff)</strong>ï¼šè¿™æ˜¯æœ€å¤æ‚çš„éƒ¨åˆ†ã€‚</li>
</ol>
<h4 data-id="heading-16">4.6 æ ¸å¿ƒ Diff ç®—æ³•ï¼šVue3 æ˜¯å¦‚ä½•â€œå¢åˆ æ”¹ç§»â€çš„ï¼Ÿ</h4>
<p>Vue3 é‡‡ç”¨çš„æ˜¯<strong>å¿«é€Ÿ Diff ç®—æ³• (Quick Diff)</strong>ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong>å…ˆå¤„ç†ä¸¤ç«¯å®¹æ˜“å¯¹æ¯”çš„èŠ‚ç‚¹ï¼Œæœ€åå†å¤„ç†ä¸­é—´å¤æ‚çš„ä¹±åºéƒ¨åˆ†</strong>ã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå…·ä½“çš„ä»£ç ç¤ºä¾‹æ¥æ¨¡æ‹Ÿè¿™ä¸ªè¿‡ç¨‹ã€‚</p>
<p><strong>å‡è®¾åœºæ™¯ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ—§åˆ—è¡¨ (n1)</span>
<span class="hljs-keyword">const</span> oldChildren = [
  { <span class="hljs-attr">key</span>: <span class="hljs-string">'A'</span> }, { <span class="hljs-attr">key</span>: <span class="hljs-string">'B'</span> }, <span class="hljs-comment">// å¤´</span>
  { <span class="hljs-attr">key</span>: <span class="hljs-string">'C'</span> }, { <span class="hljs-attr">key</span>: <span class="hljs-string">'D'</span> }, { <span class="hljs-attr">key</span>: <span class="hljs-string">'E'</span> }, <span class="hljs-comment">// ä¸­é—´</span>
  { <span class="hljs-attr">key</span>: <span class="hljs-string">'F'</span> }, { <span class="hljs-attr">key</span>: <span class="hljs-string">'G'</span> }  <span class="hljs-comment">// å°¾</span>
]

<span class="hljs-comment">// æ–°åˆ—è¡¨ (n2)</span>
<span class="hljs-keyword">const</span> newChildren = [
  { <span class="hljs-attr">key</span>: <span class="hljs-string">'A'</span> }, { <span class="hljs-attr">key</span>: <span class="hljs-string">'B'</span> }, <span class="hljs-comment">// å¤´ (ä¸å˜)</span>
  { <span class="hljs-attr">key</span>: <span class="hljs-string">'E'</span> }, { <span class="hljs-attr">key</span>: <span class="hljs-string">'C'</span> }, { <span class="hljs-attr">key</span>: <span class="hljs-string">'D'</span> }, { <span class="hljs-attr">key</span>: <span class="hljs-string">'H'</span> }, <span class="hljs-comment">// ä¸­é—´ (ä¹±åº + æ–°å¢)</span>
  { <span class="hljs-attr">key</span>: <span class="hljs-string">'F'</span> }, { <span class="hljs-attr">key</span>: <span class="hljs-string">'G'</span> }  <span class="hljs-comment">// å°¾ (ä¸å˜)</span>
]
</code></pre>
<h5 data-id="heading-17">ç¬¬ä¸€æ­¥ï¼šæå¤´ï¼ˆSync from startï¼‰</h5>
<p>Vue ä¼šç»´æŠ¤ä¸€ä¸ªç´¢å¼• <code>i = 0</code>ï¼Œä»å¤´éƒ¨å¼€å§‹å‘åéå†ï¼Œå¦‚æœ <code>key</code> ç›¸åŒï¼Œç›´æ¥ patchï¼ˆæ›´æ–°å±æ€§ï¼‰ï¼Œç„¶å <code>i++</code>ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>
<span class="hljs-keyword">const</span> e1 = oldChildren.<span class="hljs-property">length</span> - <span class="hljs-number">1</span> <span class="hljs-comment">// æ—§åˆ—è¡¨å°¾éƒ¨ç´¢å¼•</span>
<span class="hljs-keyword">const</span> e2 = newChildren.<span class="hljs-property">length</span> - <span class="hljs-number">1</span> <span class="hljs-comment">// æ–°åˆ—è¡¨å°¾éƒ¨ç´¢å¼•</span>

<span class="hljs-comment">// 1. ä»å¤´å¾€åæ¯”</span>
<span class="hljs-keyword">while</span> (i &lt;= e1 &amp;&amp; i &lt;= e2) {
  <span class="hljs-keyword">const</span> n1 = oldChildren[i]
  <span class="hljs-keyword">const</span> n2 = newChildren[i]
  
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isSameVNodeType</span>(n1, n2)) {
    <span class="hljs-title function_">patch</span>(n1, n2, container) <span class="hljs-comment">// å¤ç”¨èŠ‚ç‚¹ï¼Œæ›´æ–° Props</span>
    i++
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">break</span> <span class="hljs-comment">// é‡åˆ°ä¸åŒçš„ (C vs E)ï¼Œåœä¸‹æ¥</span>
  }
}
<span class="hljs-comment">// æ­¤æ—¶ i = 2ï¼ŒæŒ‡å‘ C å’Œ E</span>
</code></pre>
<h5 data-id="heading-18">ç¬¬äºŒæ­¥ï¼šå»å°¾ï¼ˆSync from endï¼‰</h5>
<p>åŒæ ·çš„é€»è¾‘ï¼Œä»å°¾éƒ¨å¼€å§‹å‘å‰éå†ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 2. ä»å°¾å¾€å‰æ¯”</span>
<span class="hljs-keyword">while</span> (i &lt;= e1 &amp;&amp; i &lt;= e2) {
  <span class="hljs-keyword">const</span> n1 = oldChildren[e1]
  <span class="hljs-keyword">const</span> n2 = newChildren[e2]
  
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isSameVNodeType</span>(n1, n2)) {
    <span class="hljs-title function_">patch</span>(n1, n2, container)
    e1--
    e2--
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">break</span> <span class="hljs-comment">// é‡åˆ°ä¸åŒçš„ (E vs H)ï¼Œåœä¸‹æ¥</span>
  }
}
<span class="hljs-comment">// æ­¤æ—¶ e1 = 4 (æŒ‡å‘ E), e2 = 5 (æŒ‡å‘ H)</span>
</code></pre>
<p><strong>æ­¤æ—¶çš„çŠ¶æ€ï¼š</strong></p>
<ul>
<li>å¤´éƒ¨ A, B å·²å¤„ç†ã€‚</li>
<li>å°¾éƒ¨ F, G å·²å¤„ç†ã€‚</li>
<li><strong>å‰©ä¸‹çš„çƒ‚æ‘Šå­</strong>ï¼š
<ul>
<li>æ—§ï¼š<code>[C, D, E]</code> (ç´¢å¼• 2 åˆ° 4)</li>
<li>æ–°ï¼š<code>[E, C, D, H]</code> (ç´¢å¼• 2 åˆ° 5)</li>
</ul>
</li>
</ul>
<h5 data-id="heading-19">ç¬¬ä¸‰æ­¥ï¼šå¤„ç†æ–°å¢ä¸åˆ é™¤ï¼ˆç®€å•æƒ…å†µï¼‰</h5>
<p>å¦‚æœé¢„å¤„ç†åï¼Œæ—§åˆ—è¡¨æ²¡äº†ï¼ˆ<code>i &gt; e1</code>ï¼‰ï¼Œæ–°åˆ—è¡¨è¿˜å‰©ï¼Œè¯´æ˜å…¨æ˜¯<strong>æ–°å¢</strong>ã€‚
å¦‚æœæ–°åˆ—è¡¨æ²¡äº†ï¼ˆ<code>i &gt; e2</code>ï¼‰ï¼Œæ—§åˆ—è¡¨è¿˜å‰©ï¼Œè¯´æ˜å…¨æ˜¯<strong>åˆ é™¤</strong>ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (i &gt; e1) {
  <span class="hljs-keyword">if</span> (i &lt;= e2) {
    <span class="hljs-comment">// æ—§çš„æ²¡äº†ï¼Œæ–°çš„è¿˜æœ‰ -&gt; æŒ‚è½½å‰©ä½™çš„æ–°èŠ‚ç‚¹</span>
    <span class="hljs-keyword">while</span> (i &lt;= e2) <span class="hljs-title function_">patch</span>(<span class="hljs-literal">null</span>, newChildren[i++], container)
  }
} 
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (i &gt; e2) {
  <span class="hljs-comment">// æ–°çš„æ²¡äº†ï¼Œæ—§çš„è¿˜æœ‰ -&gt; å¸è½½å‰©ä½™çš„æ—§èŠ‚ç‚¹</span>
  <span class="hljs-keyword">while</span> (i &lt;= e1) <span class="hljs-title function_">unmount</span>(oldChildren[i++])
}
</code></pre>
<h5 data-id="heading-20">ç¬¬å››æ­¥ï¼šå¤„ç†ä¹±åºï¼ˆUnknown Sequenceï¼‰</h5>
<p>è¿™æ˜¯æœ€å¤æ‚çš„æƒ…å†µï¼ˆå¦‚æˆ‘ä»¬çš„ä¾‹å­ï¼‰ã€‚Vue éœ€è¦åˆ¤æ–­å“ªäº›èŠ‚ç‚¹ç§»åŠ¨äº†ï¼Œå“ªäº›éœ€è¦æ–°å»ºã€‚</p>
<p><strong>1. æ„å»ºæ–°èŠ‚ç‚¹æ˜ å°„è¡¨ä¸åˆå§‹åŒ–</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. æ„å»ºæ–°èŠ‚ç‚¹çš„ key æ˜ å°„è¡¨</span>
<span class="hljs-keyword">const</span> keyToNewIndexMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>()
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = i; k &lt;= e2; k++) {
  keyToNewIndexMap.<span class="hljs-title function_">set</span>(newChildren[k].<span class="hljs-property">key</span>, k)
}

<span class="hljs-comment">// 2. å¾…å¤„ç†æ–°èŠ‚ç‚¹æ•°é‡</span>
<span class="hljs-keyword">const</span> count = e2 - i + <span class="hljs-number">1</span>
<span class="hljs-comment">// 3. è®°å½•æ–°èŠ‚ç‚¹åœ¨æ—§åˆ—è¡¨ä¸­çš„ä½ç½®ï¼ˆç”¨äºè®¡ç®—æœ€é•¿é€’å¢å­åºåˆ—ï¼‰</span>
<span class="hljs-keyword">const</span> newIndexToOldIndexMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(count).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>)
</code></pre>
<p><strong>2. éå†æ—§èŠ‚ç‚¹ï¼šå¤ç”¨ä¸åˆ é™¤</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 4. éå†æ—§èŠ‚ç‚¹ï¼Œå¯»æ‰¾å¯å¤ç”¨çš„èŠ‚ç‚¹</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = i; k &lt;= e1; k++) {
  <span class="hljs-keyword">const</span> oldChild = oldChildren[k]
  <span class="hljs-keyword">const</span> newIndex = keyToNewIndexMap.<span class="hljs-title function_">get</span>(oldChild.<span class="hljs-property">key</span>)

  <span class="hljs-keyword">if</span> (newIndex === <span class="hljs-literal">undefined</span>) {
    <span class="hljs-comment">// æ—§èŠ‚ç‚¹åœ¨æ–°åˆ—è¡¨ä¸­æ‰¾ä¸åˆ°äº† -&gt; åˆ é™¤</span>
    <span class="hljs-title function_">unmount</span>(oldChild)
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// æ‰¾åˆ°äº†ï¼è®°å½•æ—§ç´¢å¼• + 1ï¼ˆé˜²æ­¢ 0 ç´¢å¼•å†²çªï¼‰</span>
    <span class="hljs-comment">// newIndex - i æ˜¯ä¸ºäº†æ˜ å°„åˆ°ä» 0 å¼€å§‹çš„ count æ•°ç»„ä¸­</span>
    newIndexToOldIndexMap[newIndex - i] = k + <span class="hljs-number">1</span>
    <span class="hljs-comment">// è¿›è¡Œé€’å½’æ¯”å¯¹</span>
    <span class="hljs-title function_">patch</span>(oldChild, newChildren[newIndex], container)
  }
}
<span class="hljs-comment">/**
 * æ­¤æ—¶äº§ç”Ÿçš„æ˜ å°„å…³ç³»å›¾ä¾‹ï¼š
 * 
 * ç´¢å¼• (i):      0    1    2    3   (å¯¹åº”æ–°åˆ—è¡¨ä¸­çš„ä½ç½®)
 * æ–°èŠ‚ç‚¹ key:   [E]  [C]  [D]  [H]
 * æ—§ç´¢å¼• + 1:   [5]  [3]  [4]  [0]  (å¯¹åº” newIndexToOldIndexMap)
 * 
 * å…¶ä¸­ï¼š
 * - 0 ä»£è¡¨ H æ˜¯æ–°æ¥çš„ï¼Œéœ€è¦æŒ‚è½½ (Mount)
 * - 3, 4 æ˜¯é€’å¢çš„åºåˆ— -&gt; è¿™å°±æ˜¯ LIS (æœ€é•¿é€’å¢å­åºåˆ—)
 * - 5 æ‰“ç ´äº†é€’å¢æ€§ -&gt; è¯´æ˜ E å‘ç”Ÿäº†ç§»åŠ¨
 */</span>
</code></pre>
<blockquote>
<p><strong>ğŸ’¡ å°ç™½ä¸“å±è§£é‡Šï¼š</strong></p>
<p>ä½ å¯ä»¥æŠŠ <code>newIndexToOldIndexMap</code> æƒ³è±¡æˆä¸€å¼  <strong>â€œå¯»äººå¯äº‹è¡¨â€</strong>ã€‚
è¡¨æ ¼çš„é•¿åº¦å°±æ˜¯æ–°åˆ—è¡¨é‡Œä¹±åºçš„äººæ•°ï¼ˆè¿™é‡Œæ˜¯ 4 ä¸ªï¼šE, C, D, Hï¼‰ã€‚</p>
<ul>
<li><strong>ç¬¬ 0 æ ¼ (E)</strong>ï¼šè¡¨é‡Œå†™ç€ <code>5</code>ã€‚æ„æ€æ˜¯ï¼šâ€œæˆ‘æ˜¯æ—§åˆ—è¡¨é‡Œçš„ç¬¬ 4 å·ï¼ˆ5-1ï¼‰äººâ€ã€‚</li>
<li><strong>ç¬¬ 1 æ ¼ (C)</strong>ï¼šè¡¨é‡Œå†™ç€ <code>3</code>ã€‚æ„æ€æ˜¯ï¼šâ€œæˆ‘æ˜¯æ—§åˆ—è¡¨é‡Œçš„ç¬¬ 2 å·ï¼ˆ3-1ï¼‰äººâ€ã€‚</li>
<li><strong>ç¬¬ 2 æ ¼ (D)</strong>ï¼šè¡¨é‡Œå†™ç€ <code>4</code>ã€‚æ„æ€æ˜¯ï¼šâ€œæˆ‘æ˜¯æ—§åˆ—è¡¨é‡Œçš„ç¬¬ 3 å·ï¼ˆ4-1ï¼‰äººâ€ã€‚</li>
<li><strong>ç¬¬ 3 æ ¼ (H)</strong>ï¼šè¡¨é‡Œå†™ç€ <code>0</code>ã€‚æ„æ€æ˜¯ï¼šâ€œæŸ¥æ— æ­¤äººï¼Œæˆ‘æ˜¯æ–°æ¥çš„â€ã€‚</li>
</ul>
<p>Vue çœ‹åˆ°è¿™å¼ è¡¨ï¼Œå°±çŸ¥é“è°æ˜¯ä»å“ªå„¿æ¥çš„ï¼Œè°æ˜¯æ–°æ¥çš„ã€‚ç„¶ååªè¦ç®—å‡ºå“ªä¸ªåºåˆ—æ˜¯<strong>é€’å¢</strong>çš„ï¼ˆ3 -&gt; 4ï¼‰ï¼Œå°±è¯´æ˜è¿™å‡ ä¸ªäººï¼ˆC å’Œ Dï¼‰çš„ç›¸å¯¹ç«™ä½æ²¡å˜ï¼Œå¯ä»¥ä¸ç”¨åŠ¨ï¼ŒçœåŠ›æ°”ï¼</p>
</blockquote>
<p><strong>3. è®¡ç®—æœ€é•¿é€’å¢å­åºåˆ— (LIS)</strong></p>
<p>Vue ä½¿ç”¨ä¸€ä¸ªç®—æ³•ç®—å‡º <code>newIndexToOldIndexMap</code> ä¸­çš„<strong>æœ€é•¿é€’å¢å­åºåˆ—</strong>ã€‚è¿™ä¸ªåºåˆ—é‡Œçš„èŠ‚ç‚¹ï¼Œåœ¨æ—§åˆ—è¡¨å’Œæ–°åˆ—è¡¨é‡Œçš„ç›¸å¯¹é¡ºåºæ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥<strong>ä¸éœ€è¦ç§»åŠ¨</strong>ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è·å–æœ€é•¿é€’å¢å­åºåˆ—çš„ç›¸å¯¹ç´¢å¼•</span>
<span class="hljs-comment">// ä¼ å…¥: [5, 3, 4, 0] (å¿½ç•¥ 0)</span>
<span class="hljs-comment">// è¿”å›: [1, 2] (å¯¹åº”å€¼ 3, 4ï¼Œå³ C å’Œ Dï¼Œå®ƒä»¬åœ¨ newIndexToOldIndexMap ä¸­çš„ä¸‹æ ‡)</span>
<span class="hljs-keyword">const</span> increasingNewIndexSequence = <span class="hljs-title function_">getSequence</span>(newIndexToOldIndexMap)

<span class="hljs-comment">// j æŒ‡å‘ LIS æ•°ç»„çš„æœ«å°¾ (å³æœ€å¤§ç´¢å¼•)</span>
<span class="hljs-keyword">let</span> j = increasingNewIndexSequence.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>
</code></pre>
<p><strong>4. å€’åºéå†ä¸ç§»åŠ¨ (Moving)</strong></p>
<p>æœ€åï¼Œæˆ‘ä»¬<strong>ä»åå¾€å‰</strong>éå†éœ€è¦å¤„ç†çš„æ–°èŠ‚ç‚¹ã€‚
ä¸ºä»€ä¹ˆå€’åºï¼Ÿå› ä¸º <code>insert</code> æ“ä½œéœ€è¦ä¸€ä¸ª<strong>å‚ç…§èŠ‚ç‚¹ (Anchor)</strong>ã€‚ä»åå¾€å‰éå†æ—¶ï¼Œå½“å‰èŠ‚ç‚¹çš„<strong>åä¸€ä¸ªèŠ‚ç‚¹</strong>ä¸€å®šå·²ç»å¤„ç†å¥½äº†ï¼ˆè¦ä¹ˆæ˜¯åˆšç§»åŠ¨å®Œçš„ï¼Œè¦ä¹ˆæ˜¯æœ«å°¾å›ºå®šçš„ï¼‰ï¼Œå¯ä»¥æ”¾å¿ƒåœ°ä½œä¸º Anchorã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// éå†å¾…å¤„ç†çš„æ–°èŠ‚ç‚¹ (å€’åº)</span>
<span class="hljs-comment">// k: å½“å‰å¤„ç†èŠ‚ç‚¹åœ¨ä¹±åºåŒºé—´å†…çš„ç›¸å¯¹ç´¢å¼• (0 ~ count-1)</span>
<span class="hljs-comment">// i: ä¹±åºåŒºé—´çš„èµ·å§‹ç´¢å¼• (å…¨å±€ç´¢å¼•)</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = count - <span class="hljs-number">1</span>; k &gt;= <span class="hljs-number">0</span>; k--) {
  <span class="hljs-comment">// 1. è®¡ç®—è¯¥èŠ‚ç‚¹åœ¨æ–°åˆ—è¡¨ä¸­çš„çœŸå®å…¨å±€ç´¢å¼•</span>
  <span class="hljs-keyword">const</span> nextIndex = i + k
  <span class="hljs-keyword">const</span> nextChild = newChildren[nextIndex]
  
  <span class="hljs-comment">// 2. æ‰¾é”šç‚¹ (Anchor)ï¼šå°±æ˜¯å®ƒåé¢é‚£ä¸ªèŠ‚ç‚¹</span>
  <span class="hljs-comment">// å¦‚æœ nextIndex + 1 è¶…è¿‡äº†é•¿åº¦ï¼Œè¯´æ˜å®ƒæ˜¯æœ€åä¸€ä¸ªï¼Œé”šç‚¹æ˜¯ null (æ’åˆ°å®¹å™¨æœ«å°¾)</span>
  <span class="hljs-keyword">const</span> anchor = nextIndex + <span class="hljs-number">1</span> &lt; newChildren.<span class="hljs-property">length</span> ? newChildren[nextIndex + <span class="hljs-number">1</span>].<span class="hljs-property">el</span> : <span class="hljs-literal">null</span>

  <span class="hljs-keyword">if</span> (newIndexToOldIndexMap[k] === <span class="hljs-number">0</span>) {
    <span class="hljs-comment">// ------------------------------------</span>
    <span class="hljs-comment">// æƒ…å†µ 1: æ ‡è®°æ˜¯ 0 -&gt; æ–°å¢èŠ‚ç‚¹</span>
    <span class="hljs-comment">// ------------------------------------</span>
    <span class="hljs-title function_">patch</span>(<span class="hljs-literal">null</span>, nextChild, container, anchor)
  
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (j &lt; <span class="hljs-number">0</span> || k !== increasingNewIndexSequence[j]) {
    <span class="hljs-comment">// ------------------------------------</span>
    <span class="hljs-comment">// æƒ…å†µ 2: éœ€è¦ç§»åŠ¨</span>
    <span class="hljs-comment">// ------------------------------------</span>
    <span class="hljs-comment">// è¿™é‡Œçš„ k ä¸åœ¨ LIS é‡Œï¼Œè¯´æ˜ä½ç½®ä¸å¯¹ï¼Œéœ€è¦æ¬å®¶</span>
    <span class="hljs-title function_">move</span>(nextChild, container, anchor) 
  
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// ------------------------------------</span>
    <span class="hljs-comment">// æƒ…å†µ 3: å‘½ä¸­ LIS -&gt; åŸåœ°ä¸åŠ¨</span>
    <span class="hljs-comment">// ------------------------------------</span>
    <span class="hljs-comment">// k === seq[j]: æ­å–œï¼Œè¿™ä¸ªèŠ‚ç‚¹åœ¨æœ€é•¿é€’å¢åºåˆ—é‡Œ</span>
    <span class="hljs-comment">// å®ƒçš„ç›¸å¯¹ä½ç½®æ²¡å˜ï¼Œä¸éœ€è¦åŠ¨ DOMï¼Œåªéœ€è¦è®© LIS æŒ‡é’ˆå‰ç§»</span>
    j--
  }
}
</code></pre>
<blockquote>
<p><strong>ğŸ’¡ æ ¸å¿ƒé€»è¾‘å›¾è§£ï¼š</strong></p>
<ol>
<li><strong>H (i=3)</strong>: Map å€¼ä¸º 0 -&gt; <strong>æ–°å»º</strong>ï¼Œæ’åˆ°æœ«å°¾ã€‚</li>
<li><strong>D (i=2)</strong>: å‘½ä¸­ LIS (seq[j]=2) -&gt; <strong>ä¸åŠ¨</strong>ï¼Œ<code>j--</code>ã€‚</li>
<li><strong>C (i=1)</strong>: å‘½ä¸­ LIS (seq[j]=1) -&gt; <strong>ä¸åŠ¨</strong>ï¼Œ<code>j--</code>ã€‚</li>
<li><strong>E (i=0)</strong>: ä¸åœ¨ LIS é‡Œ -&gt; <strong>ç§»åŠ¨</strong>ï¼Œæ’åˆ° C å‰é¢ã€‚</li>
</ol>
</blockquote>
<h3 data-id="heading-21">5. æºç çº§ç»†èŠ‚ï¼šä¸ºä»€ä¹ˆéœ€è¦ Contextï¼Ÿ</h3>
<p>ä½ å¯èƒ½ä¼šå‘ç°æˆ‘ä»¬çš„æºç é‡Œæœ‰è¿™ä¹ˆä¸€è¡Œï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript">vnode.<span class="hljs-property">appContext</span> = context || <span class="hljs-literal">null</span>
</code></pre>
<p>è¿™æ˜¯ä¸ºäº†è®©åŠ¨æ€æŒ‚è½½çš„ç»„ä»¶èƒ½ç»§æ‰¿å½“å‰ App çš„ä¸Šä¸‹æ–‡ã€‚æ¯”å¦‚ï¼Œä½ åœ¨ä¸» App é‡Œæ³¨å†Œäº† <code>vue-router</code> æˆ– <code>i18n</code>ï¼Œå¦‚æœä¸æŠŠ <code>appContext</code> èµ‹å€¼ç»™æ–°çš„ VNodeï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ª Message ç»„ä»¶é‡Œå°±æ— æ³•ä½¿ç”¨ <code>useRouter()</code> æˆ– <code>$t()</code>ã€‚</p>
<h3 data-id="heading-22">6. æ€»ç»“</h3>
<p>é€šè¿‡æ‰‹åŠ¨ä½¿ç”¨ <code>createVNode</code> å’Œ <code>render</code>ï¼Œæˆ‘ä»¬çªç ´äº† Vue æ¨¡æ¿çš„é™åˆ¶ï¼Œå®ç°äº†èƒ½å¤ŸåŠ¨æ€åˆ›å»ºã€æŒ‚è½½ã€é”€æ¯çš„å‘½ä»¤å¼ç»„ä»¶ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯å¼€å‘é«˜çº§ç»„ä»¶ï¼ˆå¦‚å¼¹çª—ã€æŠ½å±‰ã€é€šçŸ¥ï¼‰çš„å¿…ç»ä¹‹è·¯ã€‚</p>
<p><strong>å…³é”®ç‚¹å¤ä¹ </strong>ï¼š</p>
<ol>
<li><code>createVNode(Component, props)</code> åˆ›å»ºè™šæ‹ŸèŠ‚ç‚¹ã€‚</li>
<li><code>render(vnode, container)</code> å°†è™šæ‹ŸèŠ‚ç‚¹è½¬åŒ–ä¸ºçœŸå® DOMã€‚</li>
<li><code>render(null, container)</code> é”€æ¯ç»„ä»¶ï¼Œé‡Šæ”¾å†…å­˜ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[async/await : ä¸€åœºç”Ÿæˆå™¨å’Œ Promiseçš„é‡Œåº”å¤–åˆ]]></title>    <link>https://juejin.cn/post/7595864836360241204</link>    <guid>https://juejin.cn/post/7595864836360241204</guid>    <pubDate>2026-01-17T08:43:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595864836360241204" data-draft-id="7595858353660723234" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="async/await : ä¸€åœºç”Ÿæˆå™¨å’Œ Promiseçš„é‡Œåº”å¤–åˆ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-01-17T08:43:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="sophieæ—­"/> <meta itemprop="url" content="https://juejin.cn/user/2559318799692952"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            async/await : ä¸€åœºç”Ÿæˆå™¨å’Œ Promiseçš„é‡Œåº”å¤–åˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2559318799692952/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    sophieæ—­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T08:43:33.000Z" title="Sat Jan 17 2026 08:43:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»19åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>è¯´å®è¯ï¼Œasync/await æˆ‘åœ¨æ—¥å¸¸å·¥ä½œä¸­å¥½åƒå¹¶æ²¡æœ‰å¾ˆä¸»åŠ¨çš„å»ç”¨ï¼Œå¯èƒ½å¯¹äºå¼‚æ­¥ç¼–ç¨‹ï¼Œæˆ‘å®æ„¿å»ç”¨ Promiseè¿™ç§æ˜¾å¼é“¾å¼æ–¹å¼å‘Šè¯‰è‡ªå·±ï¼Œè¿™æ˜¯å¼‚æ­¥æµç¨‹ã€‚åŒæ­¥å¼çš„ä»£ç è®©æˆ‘æœ‰ç‚¹å¿ƒæœ‰ä½™æ‚¸ï¼Œä¸ºå•¥ä¼šè¿™æ ·æ”¾ç€æ›´è¿‡â€œé«˜çº§â€çš„APIä¸ç”¨å‘¢ï¼Ÿæˆ‘æƒ³å¯èƒ½æœ‰ä¸€æ–¹é¢çš„åŸå› æ˜¯ï¼Œæˆ‘å¯¹å®ƒçš„äº†è§£ä¸æ·±å§ï¼Œæˆ–è€…åªåœç•™åœ¨äº†è§£å§ï¼Œè¿™ä¸¤å¤©çœ‹äº†ä¸‹ async/await çš„åŸç†ï¼Œå‘ç°å®ƒå¹¶æ²¡æœ‰é‚£ä¹ˆç¥ç§˜ï¼Œå¹¶ä¸”æ˜¯ç«™åœ¨ä¸¤ä½å·¨äººçš„è‚©è†€ä¸Šçš„ã€‚</p>
<h2 data-id="heading-1">å·¨äººä¸€å·ï¼šç”Ÿæˆå™¨ Generator</h2>
<h3 data-id="heading-2">GeneratoråŸºæœ¬ä½¿ç”¨</h3>
<p>Generatorç›¸ä¿¡å¤§å®¶éƒ½ä¸é™Œç”Ÿå•¦ï¼Œæˆ‘ä»¬ç›´æ¥ä¸Šä»£ç çœ‹è¿è¡Œç»“æœå§</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°ï¼ˆæ™®é€šå‡½æ•° + *ï¼‰</span>
<span class="hljs-keyword">function</span>* <span class="hljs-title function_">numberGenerator</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç”Ÿæˆå™¨å‡½æ•°å¼€å§‹æ‰§è¡Œ"</span>);
  
  <span class="hljs-comment">// ç¬¬ä¸€æ¬¡yieldï¼Œå‘å¤–è¿”å›å€¼</span>
  <span class="hljs-keyword">const</span> firstValue = <span class="hljs-keyword">yield</span> <span class="hljs-number">1</span>; <span class="hljs-comment">// yieldå·¦è¾¹å¯ä»¥æ¥æ”¶nextä¼ å…¥çš„å‚æ•°</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¬¬ä¸€ä¸ªyieldæ¥æ”¶åˆ°çš„å‚æ•°:"</span>, firstValue);
  
  <span class="hljs-comment">// ç¬¬äºŒæ¬¡yield</span>
  <span class="hljs-keyword">const</span> secondValue = <span class="hljs-keyword">yield</span> <span class="hljs-number">2</span>;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¬¬äºŒä¸ªyieldæ¥æ”¶åˆ°çš„å‚æ•°:"</span>, secondValue);
  
  <span class="hljs-comment">// ç¬¬ä¸‰æ¬¡yield</span>
  <span class="hljs-keyword">yield</span> <span class="hljs-number">3</span>;
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç”Ÿæˆå™¨å‡½æ•°å³å°†æ‰§è¡Œå®Œæ¯•"</span>);
  
  <span class="hljs-comment">// å‡½æ•°ç»“æŸï¼Œdoneä¼šå˜ä¸ºtrue</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">"æ‰§è¡Œç»“æŸ"</span>;
}

<span class="hljs-comment">// 1. è°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°ï¼Œä¸ä¼šæ‰§è¡Œå‡½æ•°ä½“ï¼Œåªä¼šå¾—åˆ°ç”Ÿæˆå™¨å¯¹è±¡</span>
<span class="hljs-keyword">const</span> generator = <span class="hljs-title function_">numberGenerator</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"è°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°åå¾—åˆ°çš„å¯¹è±¡:"</span>, generator); <span class="hljs-comment">// è¾“å‡º Generator å¯¹è±¡ï¼Œæ— å‡½æ•°ä½“æ‰§è¡Œæ—¥å¿—</span>

<span class="hljs-comment">// 2. ç¬¬ä¸€æ¬¡è°ƒç”¨next()ï¼Œå‡½æ•°ä½“å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªyieldæš‚åœ</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¬¬ä¸€æ¬¡nextè¿”å›:"</span>, generator.<span class="hljs-title function_">next</span>()); 
<span class="hljs-comment">// è¾“å‡ºï¼š</span>
<span class="hljs-comment">// ç”Ÿæˆå™¨å‡½æ•°å¼€å§‹æ‰§è¡Œ</span>
<span class="hljs-comment">// ç¬¬ä¸€æ¬¡nextè¿”å›: { value: 1, done: false }</span>

<span class="hljs-comment">// 3. ç¬¬äºŒæ¬¡è°ƒç”¨next()å¹¶ä¼ å…¥å‚æ•°ï¼Œå‚æ•°ä¼šä½œä¸ºä¸Šä¸€ä¸ªyieldçš„è¿”å›å€¼</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¬¬äºŒæ¬¡nextè¿”å›:"</span>, generator.<span class="hljs-title function_">next</span>(<span class="hljs-string">"æˆ‘æ˜¯ç¬¬ä¸€ä¸ªyieldçš„è¿”å›å€¼"</span>));
<span class="hljs-comment">// è¾“å‡ºï¼š</span>
<span class="hljs-comment">// ç¬¬ä¸€ä¸ªyieldæ¥æ”¶åˆ°çš„å‚æ•°: æˆ‘æ˜¯ç¬¬ä¸€ä¸ªyieldçš„è¿”å›å€¼</span>
<span class="hljs-comment">// ç¬¬äºŒæ¬¡nextè¿”å›: { value: 2, done: false }</span>

<span class="hljs-comment">// 4. ç¬¬ä¸‰æ¬¡è°ƒç”¨next()å¹¶ä¼ å…¥å‚æ•°</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¬¬ä¸‰æ¬¡nextè¿”å›:"</span>, generator.<span class="hljs-title function_">next</span>(<span class="hljs-string">"æˆ‘æ˜¯ç¬¬äºŒä¸ªyieldçš„è¿”å›å€¼"</span>));
<span class="hljs-comment">// è¾“å‡ºï¼š</span>
<span class="hljs-comment">// ç¬¬äºŒä¸ªyieldæ¥æ”¶åˆ°çš„å‚æ•°: æˆ‘æ˜¯ç¬¬äºŒä¸ªyieldçš„è¿”å›å€¼</span>
<span class="hljs-comment">// ç”Ÿæˆå™¨å‡½æ•°å³å°†æ‰§è¡Œå®Œæ¯•</span>
<span class="hljs-comment">// ç¬¬ä¸‰æ¬¡nextè¿”å›: { value: 3, done: false }</span>

<span class="hljs-comment">// 5. ç¬¬å››æ¬¡è°ƒç”¨next()ï¼Œå‡½æ•°æ‰§è¡Œåˆ°returnï¼Œdoneå˜ä¸ºtrue</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¬¬å››æ¬¡nextè¿”å›:"</span>, generator.<span class="hljs-title function_">next</span>());
<span class="hljs-comment">// è¾“å‡ºï¼š</span>
<span class="hljs-comment">// ç¬¬å››æ¬¡nextè¿”å›: { value: 'æ‰§è¡Œç»“æŸ', done: true }</span>

<span class="hljs-comment">// 6. åç»­è°ƒç”¨next()ï¼Œvalueä¸ºundefinedï¼Œdoneä¿æŒtrue</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¬¬äº”æ¬¡nextè¿”å›:"</span>, generator.<span class="hljs-title function_">next</span>());
<span class="hljs-comment">// è¾“å‡ºï¼š</span>
<span class="hljs-comment">// ç¬¬äº”æ¬¡nextè¿”å›: { value: undefined, done: true }</span>
</code></pre>
<h4 data-id="heading-3">å…³é”®ç‰¹æ€§è§£é‡Š</h4>
<ol>
<li><strong>ç”Ÿæˆå™¨å‡½æ•°å®šä¹‰</strong>ï¼š<code>function* å‡½æ•°å()</code> æ˜¯ç”Ÿæˆå™¨å‡½æ•°çš„è¯­æ³•ï¼ˆ<code>*</code> çš„ä½ç½®å¯ä»¥åœ¨ <code>function</code> åã€å‡½æ•°åå‰ï¼Œç©ºæ ¼ä¸å½±å“ï¼‰ï¼Œè¿™æ˜¯å’Œæ™®é€šå‡½æ•°æœ€æ ¸å¿ƒçš„åŒºåˆ«ã€‚</li>
<li><strong>è°ƒç”¨ä¸æ‰§è¡Œ</strong>ï¼šè°ƒç”¨ <code>numberGenerator()</code> ä¸ä¼šæ‰§è¡Œå‡½æ•°ä½“ï¼Œåªä¼šè¿”å›ä¸€ä¸ª <code>Generator</code> å¯¹è±¡ï¼Œè¿™å’Œæ™®é€šå‡½æ•°è°ƒç”¨ç«‹å³æ‰§è¡Œå®Œå…¨ä¸åŒã€‚</li>
<li><strong>yield æš‚åœä¸è¿”å›</strong>ï¼š
<ul>
<li><code>yield</code> æ˜¯ç”Ÿæˆå™¨çš„æ ¸å¿ƒå…³é”®è¯ï¼Œæ‰§è¡Œåˆ° <code>yield</code> æ—¶ï¼Œå‡½æ•°ä¼š<strong>æš‚åœæ‰§è¡Œ</strong>ï¼ˆè€Œéç»“æŸï¼‰ï¼Œå¹¶å°† <code>yield</code> åçš„å€¼ä½œä¸º <code>next()</code> è¿”å›å¯¹è±¡çš„ <code>value</code>ã€‚</li>
<li><code>yield</code> ä¸åƒ <code>return</code> é‚£æ ·ç»ˆæ­¢å‡½æ•°ï¼Œä¸‹æ¬¡è°ƒç”¨ <code>next()</code> ä¼šä»æš‚åœçš„ä½ç½®ç»§ç»­æ‰§è¡Œã€‚</li>
</ul>
</li>
<li><strong>next ä¼ å‚</strong>ï¼š<code>generator.next(å‚æ•°)</code> ä¼ å…¥çš„å‚æ•°ï¼Œä¼šä½œä¸º<strong>ä¸Šä¸€ä¸ª <code>yield</code> è¯­å¥çš„è¿”å›å€¼</strong>ï¼ˆæ³¨æ„ï¼šç¬¬ä¸€ä¸ª <code>next()</code> ä¼ å‚æ— æ•ˆï¼Œå› ä¸ºæ­¤æ—¶è¿˜æ²¡æœ‰æ‰§è¡Œè¿‡ä»»ä½• <code>yield</code>ï¼‰ã€‚</li>
<li><strong>done å±æ€§</strong>ï¼š<code>next()</code> è¿”å›å¯¹è±¡çš„ <code>done</code> å±æ€§è¡¨ç¤ºç”Ÿæˆå™¨æ˜¯å¦æ‰§è¡Œå®Œæ¯•ï¼š
<ul>
<li><code>false</code>ï¼šç”Ÿæˆå™¨æœªæ‰§è¡Œå®Œï¼Œè¿˜èƒ½ç»§ç»­è°ƒç”¨ <code>next()</code> è·å–å€¼ï¼›</li>
<li><code>true</code>ï¼šç”Ÿæˆå™¨æ‰§è¡Œå®Œæ¯•ï¼ˆæ‰§è¡Œåˆ° <code>return</code> æˆ–å‡½æ•°æœ«å°¾ï¼‰ï¼Œ<strong>åç»­ <code>next()</code> çš„ <code>value</code> ä¸º <code>undefined</code>(è¿™ä¸€ç‚¹æˆ‘ç»å¸¸å¿½ç•¥)ã€‚</strong></li>
</ul>
</li>
</ol>
<h4 data-id="heading-4">æ€»ç»“</h4>
<ol>
<li>ç”Ÿæˆå™¨å‡½æ•°é€šè¿‡ <code>function*</code> å®šä¹‰ï¼Œè°ƒç”¨åè¿”å›ç”Ÿæˆå™¨å¯¹è±¡ï¼Œè€Œéç«‹å³æ‰§è¡Œå‡½æ•°ä½“ã€‚</li>
<li><code>yield</code> è´Ÿè´£æš‚åœå‡½æ•°å¹¶å‘å¤–è¿”å›å€¼ï¼Œ<code>next()</code> è´Ÿè´£æ¢å¤æ‰§è¡Œï¼Œä¸” <code>next()</code> å¯ä¼ å‚ä½œä¸ºä¸Šä¸€ä¸ª <code>yield</code> çš„è¿”å›å€¼ã€‚</li>
<li><code>next()</code> è¿”å›çš„å¯¹è±¡åŒ…å« <code>value</code>ï¼ˆè¿”å›å€¼ï¼‰å’Œ <code>done</code>ï¼ˆæ‰§è¡ŒçŠ¶æ€ï¼‰ï¼Œ<code>done: true</code> è¡¨ç¤ºç”Ÿæˆå™¨æ‰§è¡Œå®Œæ¯•ã€‚</li>
</ol>
<h3 data-id="heading-5">Generator throw</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªåŒ…å«å¼‚å¸¸å¤„ç†çš„ç”Ÿæˆå™¨å‡½æ•°</span>
<span class="hljs-keyword">function</span>* <span class="hljs-title function_">fooGenerator</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"fooGenerator å¼€å§‹æ‰§è¡Œï¼ˆç¬¬ä¸€æ¬¡nextè§¦å‘ï¼‰"</span>);
  
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// ç¬¬ä¸€ä¸ªyieldï¼šæš‚åœå¹¶è¿”å›å€¼ï¼Œåç»­å¯èƒ½æ¥æ”¶nextä¼ å‚</span>
    <span class="hljs-keyword">const</span> receivedValue = <span class="hljs-keyword">yield</span> <span class="hljs-string">"ç¬¬ä¸€ä¸ªyieldè¿”å›å€¼"</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¬¬ä¸€ä¸ªyieldæ¥æ”¶åˆ°nextçš„å‚æ•°:"</span>, receivedValue);

    <span class="hljs-comment">// æ‰§è¡Œåˆ°è¿™é‡Œæ—¶ï¼Œå¦‚æœå¤–éƒ¨è°ƒç”¨throw()ï¼Œå¼‚å¸¸ä¼šæŠ›åˆ°å½“å‰æ‰§è¡Œä½ç½®</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å‡†å¤‡æ‰§è¡Œç¬¬äºŒä¸ªyield..."</span>);
    <span class="hljs-keyword">yield</span> <span class="hljs-string">"ç¬¬äºŒä¸ªyieldè¿”å›å€¼"</span>;

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç”Ÿæˆå™¨æœªè¢«ä¸­æ–­ï¼Œç»§ç»­æ‰§è¡Œ"</span>);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// æ•è·å¤–éƒ¨throw()æŠ›å‡ºçš„å¼‚å¸¸</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç”Ÿæˆå™¨å†…éƒ¨æ•è·åˆ°å¼‚å¸¸:"</span>, error.<span class="hljs-property">message</span>);
    <span class="hljs-comment">// æ•è·å¼‚å¸¸åï¼Œç”Ÿæˆå™¨å¯ç»§ç»­yieldè¿”å›å€¼</span>
    <span class="hljs-keyword">yield</span> <span class="hljs-string">"å¼‚å¸¸æ•è·åè¿”å›çš„å…œåº•å€¼"</span>;
  }

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç”Ÿæˆå™¨å‡½æ•°æ‰§è¡Œåˆ°æœ«å°¾"</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-string">"æ‰§è¡Œç»“æŸ"</span>;
}

<span class="hljs-comment">// 1. è°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°ï¼Œä»…å¾—åˆ°ç”Ÿæˆå™¨å¯¹è±¡ï¼Œå‡½æ•°ä½“ä¸æ‰§è¡Œ</span>
<span class="hljs-keyword">const</span> generator = <span class="hljs-title function_">fooGenerator</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"è°ƒç”¨fooGeneratoråå¾—åˆ°çš„å¯¹è±¡:"</span>, generator); <span class="hljs-comment">// Generator å¯¹è±¡</span>

<span class="hljs-comment">// 2. ç¬¬ä¸€æ¬¡è°ƒç”¨next()ï¼šå‡½æ•°ä½“å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªyieldæš‚åœ</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"===== ç¬¬ä¸€æ¬¡è°ƒç”¨ next() ====="</span>);
<span class="hljs-keyword">const</span> firstNext = generator.<span class="hljs-title function_">next</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¬¬ä¸€æ¬¡nextè¿”å›:"</span>, firstNext);
<span class="hljs-comment">// è¾“å‡ºï¼š</span>
<span class="hljs-comment">// fooGenerator å¼€å§‹æ‰§è¡Œï¼ˆç¬¬ä¸€æ¬¡nextè§¦å‘ï¼‰</span>
<span class="hljs-comment">// ç¬¬ä¸€æ¬¡nextè¿”å›: { value: 'ç¬¬ä¸€ä¸ªyieldè¿”å›å€¼', done: false }</span>

<span class="hljs-comment">// 3. ç¬¬äºŒæ¬¡è°ƒç”¨next(å‚æ•°)ï¼šä»ç¬¬ä¸€ä¸ªyieldæš‚åœå¤„ç»§ç»­æ‰§è¡Œï¼Œå‚æ•°ä½œä¸ºyieldè¿”å›å€¼</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"\n===== ç¬¬äºŒæ¬¡è°ƒç”¨ next('bar') ====="</span>);
<span class="hljs-keyword">const</span> secondNext = generator.<span class="hljs-title function_">next</span>(<span class="hljs-string">"bar"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¬¬äºŒæ¬¡nextè¿”å›:"</span>, secondNext);
<span class="hljs-comment">// è¾“å‡ºï¼š</span>
<span class="hljs-comment">// ç¬¬ä¸€ä¸ªyieldæ¥æ”¶åˆ°nextçš„å‚æ•°: bar</span>
<span class="hljs-comment">// å‡†å¤‡æ‰§è¡Œç¬¬äºŒä¸ªyield...</span>
<span class="hljs-comment">// ç¬¬äºŒæ¬¡nextè¿”å›: { value: 'ç¬¬äºŒä¸ªyieldè¿”å›å€¼', done: false }</span>

<span class="hljs-comment">// 4. è°ƒç”¨throw()ï¼šä»ç¬¬äºŒä¸ªyieldæš‚åœå¤„ç»§ç»­æ‰§è¡Œï¼Œä½†æŠ›å‡ºå¼‚å¸¸</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"\n===== è°ƒç”¨ throw() æ–¹æ³• ====="</span>);
<span class="hljs-keyword">const</span> throwResult = generator.<span class="hljs-keyword">throw</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"å¤–éƒ¨æ‰‹åŠ¨æŠ›å‡ºçš„å¼‚å¸¸"</span>));
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"throw()è¿”å›:"</span>, throwResult);
<span class="hljs-comment">// è¾“å‡ºï¼š</span>
<span class="hljs-comment">// ç”Ÿæˆå™¨å†…éƒ¨æ•è·åˆ°å¼‚å¸¸: å¤–éƒ¨æ‰‹åŠ¨æŠ›å‡ºçš„å¼‚å¸¸</span>
<span class="hljs-comment">// throw()è¿”å›: { value: 'å¼‚å¸¸æ•è·åè¿”å›çš„å…œåº•å€¼', done: false }</span>

<span class="hljs-comment">// 5. å¼‚å¸¸æ•è·åï¼Œç”Ÿæˆå™¨ä»å¯ç»§ç»­æ‰§è¡Œnext()</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"\n===== å¼‚å¸¸åè°ƒç”¨ next() ====="</span>);
<span class="hljs-keyword">const</span> thirdNext = generator.<span class="hljs-title function_">next</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"ç¬¬ä¸‰æ¬¡nextè¿”å›:"</span>, thirdNext);
<span class="hljs-comment">// è¾“å‡ºï¼š</span>
<span class="hljs-comment">// ç”Ÿæˆå™¨å‡½æ•°æ‰§è¡Œåˆ°æœ«å°¾</span>
<span class="hljs-comment">// ç¬¬ä¸‰æ¬¡nextè¿”å›: { value: 'æ‰§è¡Œç»“æŸ', done: true }</span>
</code></pre>
<h4 data-id="heading-6">throw() æ–¹æ³•æ ¸å¿ƒé€»è¾‘è§£é‡Š</h4>
<ol>
<li><strong>throw() çš„æ‰§è¡Œè§¦å‘</strong>ï¼š
<ul>
<li>å’Œ <code>next()</code> ä¸€æ ·ï¼Œè°ƒç”¨ <code>generator.throw()</code> ä¼šè®©ç”Ÿæˆå™¨ä»<strong>ä¸Šä¸€æ¬¡æš‚åœçš„ä½ç½®</strong>ç»§ç»­æ‰§è¡Œï¼›</li>
<li>ä½†ä¸åŒäº <code>next()</code> ä¼ å…¥æ™®é€šå‚æ•°ï¼Œ<code>throw()</code> ä¼šåœ¨ç”Ÿæˆå™¨å½“å‰æ‰§è¡Œä½ç½®<strong>ä¸»åŠ¨æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸</strong> -- <strong>æ„æ€å°±æ˜¯ ä»å½“å‰ä½ç½®ç›´æ¥å»èµ°catché€»è¾‘ï¼Œtryé€»è¾‘ä¸ä¼šå†èµ°äº†</strong>ã€‚</li>
</ul>
</li>
<li><strong>å¼‚å¸¸çš„æ•è·ä¸å¤„ç†</strong>ï¼š
<ul>
<li>å¦‚æœç”Ÿæˆå™¨å†…éƒ¨æœ‰ <code>try/catch</code> å—åŒ…è£¹äº†æš‚åœä½ç½®åçš„æ‰§è¡Œé€»è¾‘ï¼Œå¼‚å¸¸ä¼šè¢«å†…éƒ¨æ•è·ï¼Œç”Ÿæˆå™¨ä¸ä¼šç«‹å³ç»ˆæ­¢ï¼›</li>
<li>å¦‚æœå†…éƒ¨æ²¡æœ‰æ•è·ï¼Œå¼‚å¸¸ä¼šæŠ›å‡ºåˆ°å¤–éƒ¨ï¼Œç”Ÿæˆå™¨çŠ¶æ€å˜ä¸º <code>done: true</code>ï¼Œåç»­è°ƒç”¨ <code>next()</code> åªä¼šè¿”å› <code>{ value: undefined, done: true }</code>ã€‚</li>
</ul>
</li>
<li><strong>throw() çš„è¿”å›å€¼</strong>ï¼š
<ul>
<li>å³ä½¿æŠ›å‡ºäº†å¼‚å¸¸ï¼Œåªè¦å†…éƒ¨æ•è·äº†ï¼Œ<code>throw()</code> ä¹Ÿä¼šè¿”å›å’Œ <code>next()</code> ä¸€æ ·çš„å¯¹è±¡ï¼ˆ<code>{ value, done }</code>ï¼‰ï¼›</li>
<li>è¿™ä¸ª <code>value</code> æ˜¯å¼‚å¸¸æ•è·åï¼Œç”Ÿæˆå™¨ç»§ç»­æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ª <code>yield</code> æ—¶è¿”å›çš„å€¼ï¼ˆç¤ºä¾‹ä¸­å°±æ˜¯ <code>å¼‚å¸¸æ•è·åè¿”å›çš„å…œåº•å€¼</code>ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<h4 data-id="heading-7">æ€»ç»“</h4>
<ol>
<li><code>throw()</code> æ–¹æ³•å’Œ <code>next()</code> ä¸€æ ·èƒ½è§¦å‘ç”Ÿæˆå™¨ç»§ç»­æ‰§è¡Œï¼Œä½†æ ¸å¿ƒä½œç”¨æ˜¯<strong>å‘ç”Ÿæˆå™¨å†…éƒ¨æŠ›å‡ºå¼‚å¸¸</strong>ï¼›</li>
<li>ç”Ÿæˆå™¨å†…éƒ¨å¯é€šè¿‡ <code>try/catch</code> æ•è· <code>throw()</code> æŠ›å‡ºçš„å¼‚å¸¸ï¼Œæ•è·åç”Ÿæˆå™¨ä¸ä¼šç»ˆæ­¢ï¼Œä»å¯ç»§ç»­æ‰§è¡Œå¹¶è¿”å›æ–°çš„ <code>yield</code> å€¼ï¼›</li>
<li>ç”Ÿæˆå™¨çš„æ‰§è¡Œå§‹ç»ˆæ˜¯â€œæš‚åœ-æ¢å¤â€æ¨¡å¼ï¼š<code>next()</code> æ¢å¤æ‰§è¡Œå¹¶ä¼ å‚ï¼Œ<code>throw()</code> æ¢å¤æ‰§è¡Œå¹¶æŠ›å¼‚å¸¸ï¼Œæœ¬è´¨éƒ½æ˜¯æ”¹å˜ç”Ÿæˆå™¨çš„æ‰§è¡ŒçŠ¶æ€ã€‚</li>
</ol>
<p><code>è¿™ä¸ªç‰¹æ€§åœ¨å¼‚æ­¥ç¼–ç¨‹ä¸­å¾ˆå®ç”¨ï¼Œæ¯”å¦‚å¯ä»¥ç”¨ </code>throw()<code> ä¸»åŠ¨ç»ˆæ­¢å¼‚æ­¥ä»»åŠ¡ã€å¤„ç†å¼‚æ­¥æµç¨‹ä¸­çš„é”™è¯¯ç­‰ã€‚</code></p>
<h2 data-id="heading-8">å·¨äººäºŒå·ï¼šPromise</h2>
<p>Promiseå¤§å®¶åº”è¯¥å†ç†Ÿæ‚‰ä¸è¿‡äº†ï¼Œç”±äºç¯‡å¹…åŸå› ï¼Œè¿™ç¯‡å…ˆä¸åšæ·±å…¥äº†è§£</p>
<p>ä¸‹é¢è®©æˆ‘ä»¬çœ‹çœ‹ä»–ä»¬ç»“åˆåœ¨ä¸€èµ·ä¼šå‘ç”Ÿä»€ä¹ˆå§</p>
<h2 data-id="heading-9">â€œå›è°ƒå¼â€ å†™æ³• =ã€‹ â€œåŒæ­¥å¼â€ å†™æ³•</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼ ç»Ÿ Promise å›è°ƒå†™æ³•ï¼šæœ‰æ˜æ˜¾çš„å›è°ƒåµŒå¥—æ„Ÿï¼Œä»£ç â€œå³ç§»â€</span>
<span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://jsonplaceholder.typicode.com/todos/1'</span>)
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.<span class="hljs-title function_">json</span>())
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¯·æ±‚ç»“æœ:'</span>, data);
    <span class="hljs-comment">// å¦‚æœè¿˜è¦å‘ç¬¬äºŒä¸ªè¯·æ±‚ï¼Œå°±è¦åœ¨è¿™ç»§ç»­åµŒå¥— thenï¼Œè¶Šå¥—è¶Šæ·±</span>
    <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`https://jsonplaceholder.typicode.com/todos/<span class="hljs-subst">${data.id + <span class="hljs-number">1</span>}</span>`</span>)
      .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-title function_">json</span>())
      .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data2</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬äºŒä¸ªè¯·æ±‚ç»“æœ:'</span>, data2));
  })
  .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é”™è¯¯:'</span>, error));
</code></pre>
<p>ä»¥ä¸Šä»£ç ï¼Œæˆ‘ä»¬çœ‹åˆ° è™½ç„¶ç”¨åˆ°äº†Promiseï¼Œä½†æ˜¯ä¹Ÿéš¾å…ä¼šå‡ºç°åµŒå¥—ï¼Œä¸‹é¢æˆ‘ä»¬çœ‹çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼Œ</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡æ‹Ÿ Ajax è¯·æ±‚ï¼šè¿”å› Promiseï¼ˆçœŸå®é¡¹ç›®é‡Œæ˜¯ fetch/axios ç­‰ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-params">url</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(url)
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.<span class="hljs-title function_">json</span>()) <span class="hljs-comment">// è§£æ JSON æ•°æ®</span>
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥:'</span>, error));
}

<span class="hljs-comment">// å®šä¹‰ç”Ÿæˆå™¨å‡½æ•° mainï¼šå†…éƒ¨ç”¨ yield æš‚åœï¼Œå†™â€œåŒæ­¥é£æ ¼â€çš„å¼‚æ­¥é€»è¾‘</span>
<span class="hljs-keyword">function</span>* <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¼€å§‹æ‰§è¡Œç”Ÿæˆå™¨ï¼Œå‡†å¤‡å‘è¯·æ±‚'</span>);
  
  <span class="hljs-comment">// 1. yield æŠ›å‡º Promiseï¼ˆAjax è¯·æ±‚ï¼‰ï¼Œç”Ÿæˆå™¨æš‚åœæ‰§è¡Œ</span>
  <span class="hljs-comment">// è¿™é‡Œçš„ result ä¼šæ¥æ”¶åç»­ next(data) ä¼ è¿›æ¥çš„è¯·æ±‚ç»“æœ</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-string">'https://jsonplaceholder.typicode.com/todos/1'</span>);
  
  <span class="hljs-comment">// 3. å½“å¤–éƒ¨è°ƒç”¨ next(data) åï¼Œç”Ÿæˆå™¨ä»æš‚åœå¤„æ¢å¤ï¼Œæ‰§è¡Œè¿™è¡Œ</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç”Ÿæˆå™¨å†…éƒ¨æ‹¿åˆ°çš„è¯·æ±‚ç»“æœ:'</span>, result);
  
  <span class="hljs-comment">// å¯ä»¥ç»§ç»­å‘ç¬¬äºŒä¸ªè¯·æ±‚ï¼Œä¾ç„¶æ˜¯â€œåŒæ­¥å†™æ³•â€</span>
  <span class="hljs-keyword">const</span> result2 = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-string">`https://jsonplaceholder.typicode.com/todos/<span class="hljs-subst">${result.id + <span class="hljs-number">1</span>}</span>`</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬äºŒä¸ªè¯·æ±‚ç»“æœ:'</span>, result2);
}

<span class="hljs-comment">// å¤–ç•Œæ‰§è¡Œç”Ÿæˆå™¨çš„é€»è¾‘</span>
<span class="hljs-keyword">const</span> generator = <span class="hljs-title function_">main</span>(); <span class="hljs-comment">// 1. è°ƒç”¨ç”Ÿæˆå™¨ï¼Œå¾—åˆ°ç”Ÿæˆå™¨å¯¹è±¡ï¼ˆå‡½æ•°ä½“ä¸æ‰§è¡Œï¼‰</span>

<span class="hljs-comment">// 2. ç¬¬ä¸€æ¬¡è°ƒç”¨ next()ï¼šç”Ÿæˆå™¨å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°ç¬¬ä¸€ä¸ª yield æš‚åœ</span>
<span class="hljs-keyword">const</span> firstNextResult = generator.<span class="hljs-title function_">next</span>(); 
<span class="hljs-comment">// firstNextResult.value å°±æ˜¯ yield æŠ›å‡ºçš„ Promiseï¼ˆrequestData çš„è¿”å›å€¼ï¼‰</span>
<span class="hljs-keyword">const</span> promise = firstNextResult.<span class="hljs-property">value</span>;

<span class="hljs-comment">// 3. ç­‰ Promise æ‰§è¡Œå®Œæˆï¼ˆè¯·æ±‚è¿”å›ï¼‰ï¼ŒæŠŠç»“æœä¼ ç»™ç”Ÿæˆå™¨</span>
promise.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
  <span class="hljs-comment">// è°ƒç”¨ next(data)ï¼šæŠŠè¯·æ±‚ç»“æœä¼ è¿›å»ï¼Œç”Ÿæˆå™¨ä» yield å¤„æ¢å¤æ‰§è¡Œ</span>
  generator.<span class="hljs-title function_">next</span>(data);
  
  <span class="hljs-comment">// ç¬¬äºŒä¸ªè¯·æ±‚çš„å¤„ç†ï¼ˆå¦‚æœæœ‰ï¼‰ï¼šè¿™é‡Œå¯ä»¥å°è£…æˆè‡ªåŠ¨æ‰§è¡Œé€»è¾‘ï¼Œä¸ç”¨æ‰‹åŠ¨å†™</span>
  <span class="hljs-keyword">const</span> secondNextResult = generator.<span class="hljs-title function_">next</span>();
  secondNextResult.<span class="hljs-property">value</span>.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data2</span> =&gt;</span> {
    generator.<span class="hljs-title function_">next</span>(data2);
  });
});
</code></pre>
<h4 data-id="heading-10">é€è¡Œè§£é‡Šï¼ˆå¯¹åº”ä½ çš„æè¿°ï¼‰</h4>
<ol>
<li>
<p><strong>å®šä¹‰ç”Ÿæˆå™¨å‡½æ•° <code>main</code></strong>ï¼š</p>
<ul>
<li>å†…éƒ¨ <code>yield requestData(...)</code>ï¼š<code>requestData</code> è¿”å› Promiseï¼ˆAjax è¯·æ±‚ï¼‰ï¼Œ<code>yield</code> ä¼šæŠŠè¿™ä¸ª Promise æŠ›å‡ºå»ï¼ŒåŒæ—¶<strong>æš‚åœç”Ÿæˆå™¨çš„æ‰§è¡Œ</strong>ï¼ˆä¸ä¼šç«‹åˆ»æ‰§è¡Œåé¢çš„ <code>console.log</code>ï¼‰ã€‚</li>
<li><code>const result = yield ...</code>ï¼šè¿™é‡Œçš„ <code>result</code> æš‚æ—¶æ²¡æœ‰å€¼ï¼Œè¦ç­‰åç»­æŠŠè¯·æ±‚ç»“æœä¼ è¿›æ¥æ‰ä¼šèµ‹å€¼ã€‚</li>
</ul>
</li>
<li>
<p><strong>å¤–ç•Œè°ƒç”¨ç”Ÿæˆå™¨</strong>ï¼š</p>
<ul>
<li><code>const generator = main()</code>ï¼šè°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°ï¼Œåªå¾—åˆ°ç”Ÿæˆå™¨å¯¹è±¡ï¼Œ<code>main</code> çš„å‡½æ•°ä½“<strong>å®Œå…¨ä¸æ‰§è¡Œ</strong>ã€‚</li>
<li><code>generator.next()</code>ï¼šç¬¬ä¸€æ¬¡è°ƒç”¨ <code>next</code>ï¼Œ<code>main</code> å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ° <code>yield</code> æš‚åœï¼›<code>next()</code> è¿”å›çš„å¯¹è±¡ <code>{ value: Promise, done: false }</code> ä¸­ï¼Œ<code>value</code> å°±æ˜¯ <code>yield</code> æŠ›å‡ºæ¥çš„ Promiseï¼ˆAjax è¯·æ±‚ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>å¤„ç† Promise ç»“æœï¼Œæ¢å¤ç”Ÿæˆå™¨</strong>ï¼š</p>
<ul>
<li>ç»™ Promise åŠ  <code>then</code> å›è°ƒï¼Œç­‰è¯·æ±‚è¿”å›æ‹¿åˆ° <code>data</code> åï¼Œè°ƒç”¨ <code>generator.next(data)</code>ï¼š
<ul>
<li><code>data</code> ä¼šä½œä¸º<strong>ä¸Šä¸€ä¸ª <code>yield</code> è¯­å¥çš„è¿”å›å€¼</strong>ï¼Œèµ‹å€¼ç»™ <code>main</code> é‡Œçš„ <code>result</code>ï¼›</li>
<li>ç”Ÿæˆå™¨ä»æš‚åœçš„ <code>yield</code> ä½ç½®<strong>ç»§ç»­æ‰§è¡Œ</strong>ï¼Œæ‰§è¡Œåé¢çš„ <code>console.log(result)</code> â€”â€” è¿™ä¸€æ­¥å°±åƒâ€œåŒæ­¥ä»£ç â€ä¸€æ ·ï¼Œç›´æ¥æ‹¿åˆ°äº†å¼‚æ­¥è¯·æ±‚çš„ç»“æœã€‚</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 data-id="heading-11">ä¸ºä»€ä¹ˆè¯´â€œæ¶ˆç­äº†å›è°ƒï¼Œè¿‘ä¹åŒæ­¥ä½“éªŒâ€</h4>
<p>å¯¹æ¯”ä¸¤ç§å†™æ³•ï¼š</p>
<ul>
<li>ä¼ ç»Ÿ Promiseï¼šè¯·æ±‚ç»“æœçš„å¤„ç†é€»è¾‘å¿…é¡»å†™åœ¨ <code>then</code> å›è°ƒé‡Œï¼ˆå¼‚æ­¥é£æ ¼ï¼‰ï¼›</li>
<li>ç”Ÿæˆå™¨å†™æ³•ï¼š<code>main</code> å†…éƒ¨æ²¡æœ‰ä»»ä½• <code>then</code> å›è°ƒï¼Œ<code>const result = yield ...</code> çœ‹èµ·æ¥å°±åƒâ€œåŒæ­¥èµ‹å€¼â€ï¼Œæ‹¿åˆ°ç»“æœåç›´æ¥ <code>console.log</code> â€”â€” ä»£ç ç»“æ„å’ŒåŒæ­¥ä»£ç å®Œå…¨ä¸€è‡´ï¼Œåªæ˜¯å¤šäº† <code>yield</code> å…³é”®å­—ã€‚</li>
</ul>
<h4 data-id="heading-12">æ€»ç»“</h4>
<ol>
<li>æ ¸å¿ƒç›®çš„ï¼šç”¨ç”Ÿæˆå™¨çš„ <code>yield</code> æš‚åœç‰¹æ€§ï¼ŒæŠŠå¼‚æ­¥ Promise çš„â€œå›è°ƒå¼â€å†™æ³•ï¼Œæ”¹æˆç”Ÿæˆå™¨å†…éƒ¨çš„â€œåŒæ­¥å¼â€å†™æ³•ï¼Œæ¶ˆç­å›è°ƒåµŒå¥—ï¼›</li>
<li>æ ¸å¿ƒæµç¨‹ï¼šç”Ÿæˆå™¨ <code>yield</code> æŠ›å‡º Promise â†’ ç­‰ Promise æ‰§è¡Œå®Œæˆ â†’ è°ƒç”¨ <code>next(ç»“æœ)</code> æŠŠå€¼ä¼ å›ç”Ÿæˆå™¨ â†’ ç”Ÿæˆå™¨æ¢å¤æ‰§è¡Œï¼Œæ‹¿åˆ°ç»“æœï¼›</li>
</ol>
<h2 data-id="heading-13">ç­‰ä¸€ä¸‹ï¼Œæ€ä¹ˆçœ‹ç€æ›´å¤æ‚äº†ï¼Ÿï¼Ÿ</h2>
<p>ä¸çŸ¥é“ä½ å‘ç°æ²¡æœ‰å‘å‡ºç–‘é—®ï¼Œç»è¿‡è½¬æ¢ï¼Œæ€ä¹ˆæ¯”æˆ‘å†™ä¸ªåµŒå¥—æ›´å¤æ‚äº†ï¼Ÿåˆ«ç€æ€¥ï¼Œæˆ‘ä»¬ä¸€æ­¥æ­¥ç®€åŒ–ï¼</p>
<h4 data-id="heading-14">å…ˆçœ‹é—®é¢˜ï¼šæ‰‹åŠ¨å¤„ç†å¤šä¸ª yield çš„å¼Šç«¯</h4>
<p>å¦‚æœ <code>main</code> é‡Œæœ‰ 3 ä¸ª <code>yield</code>ï¼ˆ3 æ¬¡ Ajax è¯·æ±‚ï¼‰ï¼Œæ‰‹åŠ¨å¤„ç†ä¼šå†™æˆè¿™æ ·ï¼Œé‡å¤ä»£ç ç‰¹åˆ«å¤šï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ‰‹åŠ¨å¤„ç†å¤šä¸ª yield çš„ç³Ÿç³•å†™æ³•ï¼ˆä»…ä¸¾ä¾‹ï¼Œä¸è¦è¿™ä¹ˆå†™ï¼‰</span>
<span class="hljs-keyword">const</span> gen = <span class="hljs-title function_">main</span>();
<span class="hljs-comment">// å¤„ç†ç¬¬ä¸€ä¸ªè¯·æ±‚</span>
<span class="hljs-keyword">let</span> res1 = gen.<span class="hljs-title function_">next</span>();
res1.<span class="hljs-property">value</span>.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data1</span> =&gt;</span> {
  <span class="hljs-comment">// å¤„ç†ç¬¬äºŒä¸ªè¯·æ±‚</span>
  <span class="hljs-keyword">let</span> res2 = gen.<span class="hljs-title function_">next</span>(data1);
  res2.<span class="hljs-property">value</span>.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data2</span> =&gt;</span> {
    <span class="hljs-comment">// å¤„ç†ç¬¬ä¸‰ä¸ªè¯·æ±‚</span>
    <span class="hljs-keyword">let</span> res3 = gen.<span class="hljs-title function_">next</span>(data2);
    res3.<span class="hljs-property">value</span>.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data3</span> =&gt;</span> {
      gen.<span class="hljs-title function_">next</span>(data3); <span class="hljs-comment">// æœ€åä¸€æ¬¡ next</span>
    });
  });
});
</code></pre>
<p>è¿™ç§å†™æ³•å’Œå›è°ƒåµŒå¥—æ²¡åŒºåˆ«ï¼Œå®Œå…¨è¿èƒŒäº†ç”¨ç”Ÿæˆå™¨ç®€åŒ–å¼‚æ­¥çš„åˆè¡· â€”â€” è€Œ<strong>é€’å½’è‡ªåŠ¨æ‰§è¡Œå™¨</strong>å°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„å…³é”®ã€‚</p>
<h4 data-id="heading-15">æ ¸å¿ƒæ€è·¯ï¼šé€’å½’è‡ªåŠ¨æ‰§è¡Œå™¨</h4>
<p>æˆ‘ä»¬å†™ä¸€ä¸ªé€šç”¨çš„é€’å½’å‡½æ•°ï¼ˆæ¯”å¦‚å« <code>runGenerator</code>ï¼‰ï¼Œå®ƒä¼šï¼š</p>
<ol>
<li>è°ƒç”¨ç”Ÿæˆå™¨çš„ <code>next()</code>ï¼Œæ‹¿åˆ°è¿”å›ç»“æœï¼ˆåŒ…å« <code>value</code>ï¼ˆPromiseï¼‰å’Œ <code>done</code>ï¼‰ï¼›</li>
<li>åˆ¤æ–­ <code>done</code>ï¼šå¦‚æœæ˜¯ <code>true</code>ï¼Œé€’å½’ç»ˆæ­¢ï¼›</li>
<li>å¦‚æœæ˜¯ <code>false</code>ï¼Œç»™ <code>value</code>ï¼ˆPromiseï¼‰åŠ  <code>then</code> å›è°ƒï¼›</li>
<li>åœ¨ <code>then</code> é‡Œæ‹¿åˆ°å¼‚æ­¥ç»“æœï¼Œå†<strong>é€’å½’è°ƒç”¨è‡ªèº«</strong>ï¼ŒæŠŠç»“æœä¼ ç»™ <code>next()</code>ï¼Œç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ª <code>yield</code>ã€‚</li>
</ol>
<h4 data-id="heading-16">å®Œæ•´ä»£ç ç¤ºä¾‹ï¼ˆå«é€’å½’æ‰§è¡Œå™¨ï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. æ¨¡æ‹Ÿ Ajax è¯·æ±‚ï¼šè¿”å› Promise</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-params">url</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(url)
    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> res.<span class="hljs-title function_">json</span>())
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥:'</span>, err));
}

<span class="hljs-comment">// 2. å®šä¹‰æœ‰å¤šä¸ª yield çš„ç”Ÿæˆå™¨å‡½æ•°</span>
<span class="hljs-keyword">function</span>* <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¼€å§‹ç¬¬ä¸€ä¸ªè¯·æ±‚'</span>);
  <span class="hljs-comment">// ç¬¬ä¸€ä¸ª yieldï¼šè¯·æ±‚ todo/1</span>
  <span class="hljs-keyword">const</span> result1 = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-string">'https://jsonplaceholder.typicode.com/todos/1'</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬ä¸€ä¸ªè¯·æ±‚ç»“æœ:'</span>, result1);

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¼€å§‹ç¬¬äºŒä¸ªè¯·æ±‚'</span>);
  <span class="hljs-comment">// ç¬¬äºŒä¸ª yieldï¼šåŸºäºç¬¬ä¸€ä¸ªç»“æœè¯·æ±‚ todo/2</span>
  <span class="hljs-keyword">const</span> result2 = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-string">`https://jsonplaceholder.typicode.com/todos/<span class="hljs-subst">${result1.id + <span class="hljs-number">1</span>}</span>`</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬äºŒä¸ªè¯·æ±‚ç»“æœ:'</span>, result2);

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¼€å§‹ç¬¬ä¸‰ä¸ªè¯·æ±‚'</span>);
  <span class="hljs-comment">// ç¬¬ä¸‰ä¸ª yieldï¼šåŸºäºç¬¬äºŒä¸ªç»“æœè¯·æ±‚ todo/3</span>
  <span class="hljs-keyword">const</span> result3 = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-string">`https://jsonplaceholder.typicode.com/todos/<span class="hljs-subst">${result2.id + <span class="hljs-number">1</span>}</span>`</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬ä¸‰ä¸ªè¯·æ±‚ç»“æœ:'</span>, result3);

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰€æœ‰è¯·æ±‚æ‰§è¡Œå®Œæ¯•'</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-string">'æœ€ç»ˆç»“æœ'</span>;
}

<span class="hljs-comment">// 3. æ ¸å¿ƒï¼šé€’å½’è‡ªåŠ¨æ‰§è¡Œå™¨ï¼ˆé€šç”¨å‡½æ•°ï¼Œä»»ä½•ç”Ÿæˆå™¨éƒ½èƒ½ç”¨ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">runGenerator</span>(<span class="hljs-params">generator</span>) {
  <span class="hljs-comment">// å®šä¹‰é€’å½’å‡½æ•°</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-comment">// è°ƒç”¨ next()ï¼Œæ‹¿åˆ°å½“å‰æ‰§è¡Œç»“æœï¼ˆ{ value: Promise, done: boolean }ï¼‰</span>
    <span class="hljs-keyword">const</span> result = generator.<span class="hljs-title function_">next</span>(data);

    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶ï¼šå¦‚æœ done ä¸º trueï¼Œé€’å½’ç»“æŸ</span>
    <span class="hljs-keyword">if</span> (result.<span class="hljs-property">done</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç”Ÿæˆå™¨æ‰§è¡Œå®Œæ¯•ï¼Œæœ€ç»ˆè¿”å›å€¼:'</span>, result.<span class="hljs-property">value</span>);
      <span class="hljs-keyword">return</span>; <span class="hljs-comment">// ç»ˆæ­¢é€’å½’</span>
    }

    <span class="hljs-comment">// å¦‚æœ done ä¸º falseï¼Œå¤„ç†å½“å‰çš„ Promise</span>
    result.<span class="hljs-property">value</span>
      .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
        <span class="hljs-comment">// é€’å½’è°ƒç”¨ nextï¼ŒæŠŠå½“å‰ Promise çš„ç»“æœä¼ ç»™ä¸‹ä¸€ä¸ª yield</span>
        <span class="hljs-title function_">next</span>(data);
      })
      .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
        <span class="hljs-comment">// å¤„ç†å¼‚å¸¸ï¼šä¹Ÿå¯ä»¥è°ƒç”¨ generator.throw(err) æŠ›åˆ°ç”Ÿæˆå™¨å†…éƒ¨</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å¼‚æ­¥æ‰§è¡Œå‡ºé”™:'</span>, err);
      });
  }

  <span class="hljs-comment">// å¯åŠ¨ç¬¬ä¸€æ¬¡é€’å½’ï¼ˆç¬¬ä¸€æ¬¡ next ä¸ä¼ å‚ï¼Œå› ä¸ºç¬¬ä¸€ä¸ª yield å·¦è¾¹æ²¡å€¼å¯æ¥ï¼‰</span>
  <span class="hljs-title function_">next</span>();
}

<span class="hljs-comment">// 4. å¯åŠ¨æ‰§è¡Œå™¨ï¼Œè‡ªåŠ¨å¤„ç†æ‰€æœ‰ yield</span>
<span class="hljs-title function_">runGenerator</span>(<span class="hljs-title function_">main</span>());
</code></pre>
<h4 data-id="heading-17">é€è¡Œè§£é‡Šé€’å½’æ‰§è¡Œå™¨çš„é€»è¾‘</h4>
<ol>
<li><strong>æ‰§è¡Œå™¨åˆå§‹åŒ–</strong>ï¼šè°ƒç”¨ <code>runGenerator(main())</code>ï¼Œå…ˆåˆ›å»ºç”Ÿæˆå™¨å¯¹è±¡ï¼Œå†æ‰§è¡Œ <code>next()</code>ï¼ˆæ— å‚ï¼‰ï¼Œå¯åŠ¨ç¬¬ä¸€æ¬¡é€’å½’ã€‚</li>
<li><strong>ç¬¬ä¸€æ¬¡é€’å½’</strong>ï¼š
<ul>
<li><code>generator.next()</code> â†’ æ‰§è¡Œ <code>main</code> åˆ°ç¬¬ä¸€ä¸ª <code>yield</code>ï¼Œè¿”å› <code>{ value: ç¬¬ä¸€ä¸ªè¯·æ±‚çš„ Promise, done: false }</code>ï¼›</li>
<li>å› ä¸º <code>done: false</code>ï¼Œç»™ Promise åŠ  <code>then</code>ï¼›</li>
<li>ç­‰ç¬¬ä¸€ä¸ªè¯·æ±‚è¿”å› <code>data1</code>ï¼Œé€’å½’è°ƒç”¨ <code>next(data1)</code>ã€‚</li>
</ul>
</li>
<li><strong>ç¬¬äºŒæ¬¡é€’å½’</strong>ï¼š
<ul>
<li><code>generator.next(data1)</code> â†’ <code>data1</code> èµ‹å€¼ç»™ <code>result1</code>ï¼Œ<code>main</code> æ‰§è¡Œåˆ°ç¬¬äºŒä¸ª <code>yield</code>ï¼Œè¿”å› <code>{ value: ç¬¬äºŒä¸ªè¯·æ±‚çš„ Promise, done: false }</code>ï¼›</li>
<li>ç»™ç¬¬äºŒä¸ª Promise åŠ  <code>then</code>ï¼Œæ‹¿åˆ° <code>data2</code> åé€’å½’è°ƒç”¨ <code>next(data2)</code>ã€‚</li>
</ul>
</li>
<li><strong>ç¬¬ä¸‰æ¬¡é€’å½’</strong>ï¼š
<ul>
<li><code>generator.next(data2)</code> â†’ <code>data2</code> èµ‹å€¼ç»™ <code>result2</code>ï¼Œ<code>main</code> æ‰§è¡Œåˆ°ç¬¬ä¸‰ä¸ª <code>yield</code>ï¼Œè¿”å› <code>{ value: ç¬¬ä¸‰ä¸ªè¯·æ±‚çš„ Promise, done: false }</code>ï¼›</li>
<li>æ‹¿åˆ° <code>data3</code> åé€’å½’è°ƒç”¨ <code>next(data3)</code>ã€‚</li>
</ul>
</li>
<li><strong>ç¬¬å››æ¬¡é€’å½’</strong>ï¼š
<ul>
<li><code>generator.next(data3)</code> â†’ <code>data3</code> èµ‹å€¼ç»™ <code>result3</code>ï¼Œ<code>main</code> æ‰§è¡Œåˆ°æœ«å°¾ï¼Œè¿”å› <code>{ value: 'æœ€ç»ˆç»“æœ', done: true }</code>ï¼›</li>
<li>æ£€æµ‹åˆ° <code>done: true</code>ï¼Œé€’å½’ç»ˆæ­¢ã€‚</li>
</ul>
</li>
</ol>
<h4 data-id="heading-18">ä¸ºä»€ä¹ˆé€’å½’èƒ½è§£å†³é—®é¢˜ï¼Ÿ</h4>
<ul>
<li><strong>è‡ªåŠ¨è¿­ä»£</strong>ï¼šä¸ç®¡ <code>main</code> é‡Œæœ‰å¤šå°‘ä¸ª <code>yield</code>ï¼Œé€’å½’éƒ½ä¼šè‡ªåŠ¨å¤„ç†ï¼Œä¸ç”¨æ‰‹åŠ¨å†™æ¯ä¸€æ¬¡çš„ <code>next()</code> å’Œ <code>then()</code>ï¼›</li>
<li><strong>ç»ˆæ­¢æ¡ä»¶æ¸…æ™°</strong>ï¼šé  <code>done: true</code> åˆ¤æ–­ç”Ÿæˆå™¨æ˜¯å¦æ‰§è¡Œå®Œï¼Œé¿å…æ— é™é€’å½’ï¼›</li>
<li><strong>ä»£ç å¤ç”¨</strong>ï¼š<code>runGenerator</code> æ˜¯é€šç”¨å‡½æ•°ï¼Œä»»ä½•â€œyield å‡º Promiseâ€çš„ç”Ÿæˆå™¨éƒ½èƒ½ç›´æ¥ç”¨ï¼Œä¸ç”¨æ”¹é€»è¾‘ã€‚</li>
</ul>
<h2 data-id="heading-19"><strong>ç”Ÿæˆå™¨ + Promise å®ç°å¼‚æ­¥åŒæ­¥åŒ–</strong> å®Œæ•´æ–¹æ¡ˆ</h2>
<h4 data-id="heading-20">å†æ¢³ç†è¿™ä¸ªâ€œå®Œæ•´æ‰§è¡Œå™¨â€çš„æ ¸å¿ƒé€»è¾‘</h4>
<p>æŠŠæˆ‘ä»¬ä¹‹å‰çš„â€œç®€åŒ–ç‰ˆé€’å½’æ‰§è¡Œå™¨â€å‡çº§æˆ<strong>å·¥ä¸šçº§çš„ co å‡½æ•°</strong>ï¼Œå®Œæ•´é€»è¾‘å¦‚ä¸‹ï¼ˆä¼ªä»£ç æ¢³ç†ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. å®šä¹‰é€šç”¨æ‰§è¡Œå™¨ co</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">co</span>(<span class="hljs-params">generatorFunc</span>) {
  <span class="hljs-comment">// åˆ›å»ºç”Ÿæˆå™¨å¯¹è±¡</span>
  <span class="hljs-keyword">const</span> generator = <span class="hljs-title function_">generatorFunc</span>();

  <span class="hljs-comment">// 2. å®šä¹‰é€’å½’å¤„ç†å‡½æ•° handlerResult</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">handlerResult</span>(<span class="hljs-params">result</span>) {
    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶ï¼šç”Ÿæˆå™¨æ‰§è¡Œå®Œæ¯•</span>
    <span class="hljs-keyword">if</span> (result.<span class="hljs-property">done</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(result.<span class="hljs-property">value</span>); <span class="hljs-comment">// æœ€ç»ˆè¿”å› Promiseï¼Œå¯¹é½ async å‡½æ•°</span>
    }

    <span class="hljs-comment">// å¤„ç† Promiseï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(result.<span class="hljs-property">value</span>) <span class="hljs-comment">// ç¡®ä¿ value æ˜¯ Promiseï¼ˆå…¼å®¹é Promise æƒ…å†µï¼‰</span>
      .<span class="hljs-title function_">then</span>(
        <span class="hljs-comment">// æˆåŠŸå›è°ƒï¼šæŠŠç»“æœä¼ ç»™ nextï¼Œé€’å½’å¤„ç†ä¸‹ä¸€ä¸ª result</span>
        <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> <span class="hljs-title function_">handlerResult</span>(generator.<span class="hljs-title function_">next</span>(data)),
        <span class="hljs-comment">// å¤±è´¥å›è°ƒï¼šè°ƒç”¨ throw() æŠ›å¼‚å¸¸ç»™ç”Ÿæˆå™¨å†…éƒ¨</span>
        <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-title function_">handlerResult</span>(generator.<span class="hljs-keyword">throw</span>(error))
      );
  }

  <span class="hljs-comment">// 3. å¯åŠ¨é€’å½’ï¼šä¼ å…¥ç¬¬ä¸€æ¬¡ next() çš„ç»“æœ</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">handlerResult</span>(generator.<span class="hljs-title function_">next</span>());
}

<span class="hljs-comment">// 4. ç”Ÿæˆå™¨å†…éƒ¨ç”¨ try/catch æ•è·å¼‚å¸¸</span>
<span class="hljs-keyword">function</span>* <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> res1 = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-string">'url1'</span>);
    <span class="hljs-keyword">const</span> res2 = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-string">'url2'</span>);
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•è·å¼‚å¸¸:'</span>, err); <span class="hljs-comment">// æ•è· generator.throw() æŠ›çš„å¼‚å¸¸</span>
  }
}

<span class="hljs-comment">// 5. è°ƒç”¨ co æ‰§è¡Œç”Ÿæˆå™¨ï¼ˆé€šç”¨å¤ç”¨ï¼‰</span>
<span class="hljs-title function_">co</span>(main).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">finalRes</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœ€ç»ˆç»“æœ:'</span>, finalRes));
</code></pre>
<h4 data-id="heading-21">æ€»ç»“</h4>
<p>è¿™äº›å†…å®¹ï¼Œæ˜¯æˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„<strong>ç”Ÿæˆå™¨+Promise å®ç°å¼‚æ­¥åŒæ­¥åŒ–</strong>çš„â€œå®Œæ•´ç‰ˆè½åœ°â€ï¼š</p>
<ol>
<li>æ ¸å¿ƒé€»è¾‘å®Œå…¨ä¸€è‡´ï¼šé€’å½’æ‰§è¡Œå™¨ + æš‚åœ-æ¢å¤ + Promise å¤„ç†ï¼›</li>
<li>è¡¥å……äº†å…³é”®ç»†èŠ‚ï¼šå¼‚å¸¸å¤„ç†ï¼ˆ<code>throw()</code> + <code>try/catch</code>ï¼‰ï¼›</li>
</ol>
<h2 data-id="heading-22">å¥½çš„ï¼Œè¯¥ async/awaitç™»åœºäº†</h2>
<p>è®²äº†è¿™ä¹ˆå¤šå•Šéƒ½æ²¡æåˆ°æˆ‘ä»¬çš„ä¸»è§’ï¼Œå¥½çš„ä»–ä»¬æ¥äº†ï½</p>
<h4 data-id="heading-23">ç”¨ async/await æ”¹å†™ä½ è¿™æ®µæ‰‹åŠ¨ä»£ç </h4>
<p>ä½ æ‰‹åŠ¨å¤„ç† 2 ä¸ªè¯·æ±‚çš„ä»£ç ï¼Œæ¢æˆ <code>async/await</code> åé•¿è¿™æ ·ï¼Œ<strong>æ²¡æœ‰ä»»ä½•æ‰‹åŠ¨çš„ next/then</strong>ï¼Œä½†åº•å±‚é€»è¾‘å®Œå…¨ä¸€è‡´ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŸç”Ÿæˆå™¨é€»è¾‘ â†’ ç­‰ä»·çš„ async/await ä»£ç </span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">mainAsync</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// å¯¹åº”ï¼šç¬¬ä¸€æ¬¡ next() + promise.then + generator.next(data)</span>
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-string">'https://jsonplaceholder.typicode.com/todos/1'</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç”Ÿæˆå™¨å†…éƒ¨æ‹¿åˆ°çš„è¯·æ±‚ç»“æœ:'</span>, result);

  <span class="hljs-comment">// å¯¹åº”ï¼šsecondNextResult = generator.next() + secondNextResult.value.then + generator.next(data2)</span>
  <span class="hljs-keyword">const</span> result2 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-string">`https://jsonplaceholder.typicode.com/todos/<span class="hljs-subst">${result.id + <span class="hljs-number">1</span>}</span>`</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç¬¬äºŒä¸ªè¯·æ±‚ç»“æœ:'</span>, result2);
}

<span class="hljs-comment">// è°ƒç”¨ async å‡½æ•°ï¼ˆå¼•æ“è‡ªåŠ¨æ‰§è¡Œæ‰€æœ‰ next/then é€»è¾‘ï¼‰</span>
<span class="hljs-title function_">mainAsync</span>();
</code></pre>
<h4 data-id="heading-24">å…³é”®è¡¥å……ï¼šasync/await ä¸æ˜¯â€œæ–°ä¸œè¥¿â€ï¼Œæ˜¯è¯­æ³•ç³–</h4>
<p><code>async/await</code> å¹¶ä¸æ˜¯ JavaScript æ–°å¢çš„åº•å±‚ç‰¹æ€§ï¼Œå®ƒå°±æ˜¯<strong>ç”Ÿæˆå™¨ + è‡ªåŠ¨æ‰§è¡Œå™¨</strong>çš„â€œè¯­æ³•ç³–â€â€”â€” æœ¬è´¨ä¸Šï¼š</p>
<ol>
<li><code>async</code> å‡½æ•° = ç”Ÿæˆå™¨å‡½æ•° + å†…ç½®è‡ªåŠ¨æ‰§è¡Œå™¨ï¼›</li>
<li><code>await</code> å…³é”®å­— = <code>yield</code> å…³é”®å­—çš„â€œè¯­ä¹‰åŒ–åŒ…è£…â€ï¼ˆæ›´æ˜“è¯»ï¼Œä¸ç”¨å†™ <code>yield</code>ï¼‰ï¼›</li>
<li>ä½ æ‰‹åŠ¨å†™çš„é€’å½’æ‰§è¡Œå™¨ â†’ JS å¼•æ“å†…ç½®çš„ã€æ›´é«˜æ•ˆçš„è‡ªåŠ¨æ‰§è¡Œé€»è¾‘ã€‚</li>
</ol>
<h4 data-id="heading-25">ä¸¾ä¸ªæ›´ç›´è§‚çš„ä¾‹å­ï¼šå¼•æ“å¦‚ä½•å¤„ç† await</h4>
<p>å½“ä½ å†™ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> a = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">1</span>);
  <span class="hljs-keyword">const</span> b = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(a + <span class="hljs-number">1</span>);
  <span class="hljs-keyword">return</span> b;
}
<span class="hljs-title function_">fn</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)); <span class="hljs-comment">// è¾“å‡º 2</span>
</code></pre>
<p>JS å¼•æ“åœ¨åº•å±‚ä¼šåšè¿™äº›äº‹ï¼ˆå¯¹åº”ä½ çš„æ‰‹åŠ¨ä»£ç ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¼•æ“æ¨¡æ‹Ÿçš„åº•å±‚é€»è¾‘ï¼ˆä¼ªä»£ç ï¼‰</span>
<span class="hljs-keyword">function</span>* <span class="hljs-title function_">fnGenerator</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> a = <span class="hljs-keyword">yield</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">1</span>);
  <span class="hljs-keyword">const</span> b = <span class="hljs-keyword">yield</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(a + <span class="hljs-number">1</span>);
  <span class="hljs-keyword">return</span> b;
}

<span class="hljs-comment">// å¼•æ“å†…ç½®çš„è‡ªåŠ¨æ‰§è¡Œå™¨ï¼ˆç±»ä¼¼ä½ å†™çš„é€’å½’å‡½æ•°ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">autoRun</span>(<span class="hljs-params">generator</span>) {
  <span class="hljs-keyword">const</span> gen = <span class="hljs-title function_">generator</span>();
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-keyword">const</span> { value, done } = gen.<span class="hljs-title function_">next</span>(data);
    <span class="hljs-keyword">if</span> (done) <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(value);
    <span class="hljs-keyword">return</span> value.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-title function_">next</span>(res));
  }
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">next</span>();
}

<span class="hljs-comment">// å¼•æ“è‡ªåŠ¨è°ƒç”¨</span>
<span class="hljs-title function_">autoRun</span>(fnGenerator).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)); <span class="hljs-comment">// è¾“å‡º 2</span>
</code></pre>
<h4 data-id="heading-26">æ€»ç»“</h4>
<ol>
<li>ä½ æ‰‹åŠ¨å†™çš„ <code>next()</code>ã€<code>then()</code>ã€ä¼ å‚ã€å¤„ç†ä¸‹ä¸€ä¸ª <code>yield</code> è¿™äº›æ“ä½œï¼Œ<strong>å…¨éƒ¨ç”± <code>async/await</code> è‡ªåŠ¨å®Œæˆ</strong>ï¼Œä¸ç”¨ä½ å†™ä¸€è¡Œï¼›</li>
<li><code>async/await</code> æ˜¯ç”Ÿæˆå™¨+è‡ªåŠ¨æ‰§è¡Œå™¨çš„è¯­æ³•ç³–ï¼Œæ ¸å¿ƒé€»è¾‘å’Œä½ æ‰‹åŠ¨å°è£…çš„é€’å½’æ‰§è¡Œå™¨å®Œå…¨ä¸€è‡´ï¼›</li>
<li>åŒºåˆ«ä»…åœ¨äºï¼šå¼•æ“çš„å†…ç½®æ‰§è¡Œå™¨æ›´é«˜æ•ˆã€æ›´å¥å£®ï¼ˆå¤„ç†äº†å¼‚å¸¸ã€ä¸­æ–­ç­‰è¾¹ç•Œæƒ…å†µï¼‰ï¼Œè€Œä½ æ‰‹åŠ¨å†™çš„æ˜¯ç®€åŒ–ç‰ˆã€‚</li>
</ol>
<p>ç®€å•è¯´ï¼š<code>async/await</code> å°±æ˜¯æŠŠä½ æ‰‹åŠ¨åšçš„â€œè„æ´»ç´¯æ´»â€ï¼ˆè°ƒ nextã€ç­‰ Promiseã€ä¼ ç»“æœï¼‰å…¨éƒ¨è‡ªåŠ¨åŒ–äº†ï¼Œè®©ä½ åªéœ€è¦å†™â€œçœ‹èµ·æ¥åƒåŒæ­¥â€çš„ä»£ç å°±è¡Œã€‚</p>
<h2 data-id="heading-27"><code>async/await</code>ç”¨äº†å“ªäº›è®¾è®¡æ¨¡å¼å‘¢ï¼Ÿ</h2>
<p><code>async/await</code> å¹¶ä¸æ˜¯å•ä¸€çš„è®¾è®¡æ¨¡å¼ï¼Œè€Œæ˜¯<strong>ç»„åˆäº†å¤šä¸ªç»å…¸æ¨¡å¼</strong>çš„â€œè¯­æ³•ç³–å°è£…â€ï¼Œæ ¸å¿ƒæ˜¯è¿™3ä¸ªï¼š</p>





















<table><thead><tr><th>è®¾è®¡æ¨¡å¼</th><th>å¯¹åº” async/await çš„è§’è‰²</th></tr></thead><tbody><tr><td><strong>è¿­ä»£å™¨æ¨¡å¼ï¼ˆIteratorï¼‰</strong></td><td>ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰æœ¬èº«å°±æ˜¯è¿­ä»£å™¨çš„ä¸€ç§å®ç°ï¼Œ<code>next()</code> æ–¹æ³•å°±æ˜¯è¿­ä»£å™¨çš„æ ¸å¿ƒï¼ˆä¸€æ­¥æ­¥â€œè¿­ä»£â€æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼‰ï¼›</td></tr><tr><td><strong>è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserverï¼‰</strong></td><td>Promise æ˜¯å…¸å‹çš„è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆ<code>then/catch</code> ç›‘å¬ Promise çŠ¶æ€å˜åŒ–ï¼‰ï¼Œ<code>await</code> æœ¬è´¨æ˜¯â€œç›‘å¬ Promise å®Œæˆåé€šçŸ¥ç”Ÿæˆå™¨ç»§ç»­æ‰§è¡Œâ€ï¼›</td></tr><tr><td><strong>æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTemplate Methodï¼‰</strong></td><td>JS å¼•æ“å†…ç½®çš„â€œè‡ªåŠ¨æ‰§è¡Œå™¨â€å°±æ˜¯æ¨¡æ¿æ–¹æ³•ï¼šæŠŠâ€œè°ƒç”¨ next â†’ ç­‰ Promise â†’ ä¼ å‚ â†’ é€’å½’â€çš„å›ºå®šé€»è¾‘å°è£…æˆæ¨¡æ¿ï¼Œ<code>async/await</code> ä½¿ç”¨è€…åªéœ€è¦å†™ä¸šåŠ¡é€»è¾‘ï¼ˆawait åé¢çš„å¼‚æ­¥ä»»åŠ¡ï¼‰ï¼Œä¸ç”¨å…³å¿ƒæ‰§è¡Œæµç¨‹ï¼›</td></tr></tbody></table>
<p>å…³äºè®¾è®¡æ¨¡å¼ï¼Œæˆ‘åº”è¯¥ä¼šæ‹‰å‡ºä¸€ä¸ªä¸»é¢˜å¥½å¥½ç ”ç©¶</p>
<h2 data-id="heading-28">ç°åœ¨ä½ æœ‰æ²¡æœ‰ç†è§£æˆ‘è¯´çš„â€œé‡Œåº”å¤–åˆâ€œ</h2>
<h4 data-id="heading-29">å…ˆæ˜ç¡®â€œé‡Œâ€å’Œâ€œå¤–â€çš„è§’è‰²</h4>




















<table><thead><tr><th>è§’è‰²</th><th>å¯¹åº”ä»£ç /é€»è¾‘</th><th>æ ¸å¿ƒåŠ¨ä½œ</th></tr></thead><tbody><tr><td><strong>é‡Œï¼ˆç”Ÿæˆå™¨å†…éƒ¨ï¼‰</strong></td><td><code>async</code> å‡½æ•°é‡Œçš„ <code>await å¼‚æ­¥ä»»åŠ¡</code></td><td>1. æŠ›å‡º Promise ç»™â€œå¤–â€ï¼›2. æš‚åœç­‰å¾…ï¼›3. æ¥æ”¶â€œå¤–â€ä¼ å›æ¥çš„å€¼ç»§ç»­æ‰§è¡Œ</td></tr><tr><td><strong>å¤–ï¼ˆJSå¼•æ“/æ‰§è¡Œå™¨ï¼‰</strong></td><td>å¼•æ“å†…ç½®çš„è‡ªåŠ¨æ‰§è¡Œå™¨</td><td>1. æ¥ä½â€œé‡Œâ€æŠ›å‡ºæ¥çš„ Promiseï¼›2. ç­‰å¾… Promise æ‰§è¡Œå®Œæˆï¼›3. æŠŠç»“æœä¼ å›â€œé‡Œâ€ï¼Œè§¦å‘ç»§ç»­æ‰§è¡Œ</td></tr></tbody></table>
<h4 data-id="heading-30">ç”¨â€œé‡Œåº”å¤–åˆâ€æ‹†è§£å®Œæ•´æ‰§è¡Œæµç¨‹ï¼ˆä¸€æ­¥ä¸€æ­¥å¯¹åº”ï¼‰</h4>
<p>æˆ‘ä»¬ç”¨ <code>await requestData()</code> ä¸ºä¾‹ï¼Œè¿˜åŸè¿™ä¸ªäº’åŠ¨è¿‡ç¨‹ï¼š</p>
<h5 data-id="heading-31">ç¬¬ä¸€æ­¥ï¼šâ€œé‡Œâ€å…ˆå‡ºæ‹› â€”â€” æŠ›å‡º Promiseï¼ŒåŸåœ°å¾…å‘½</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// ã€Œé‡Œã€çš„åŠ¨ä½œï¼š</span>
  <span class="hljs-comment">// 1. æ‰§è¡Œ await requestData()ï¼Œå…ˆè°ƒç”¨ requestData å¾—åˆ° Promiseï¼›</span>
  <span class="hljs-comment">// 2. æŠŠè¿™ä¸ª Promise â€œæ‰”â€ç»™å¤–é¢çš„å¼•æ“ï¼›</span>
  <span class="hljs-comment">// 3. è‡ªå·±æš‚åœæ‰§è¡Œï¼ˆå°±åƒå£«å…µåŸåœ°å¾…å‘½ï¼Œç­‰å¤–é¢çš„æ¶ˆæ¯ï¼‰ï¼›</span>
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-string">'url'</span>); 
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res); <span class="hljs-comment">// æš‚åœåï¼Œè¿™è¡Œæš‚æ—¶ä¸æ‰§è¡Œ</span>
}
</code></pre>
<p>ğŸ‘‰ å¯¹åº”â€œé‡Œåº”å¤–åˆâ€ï¼š<strong>é‡Œå…ˆâ€œåº”â€â€”â€” æŠ›å‡ºå¼‚æ­¥ä»»åŠ¡ï¼ˆPromiseï¼‰ï¼Œå‘Šè¯‰å¤–é¢â€œæˆ‘è¦ç­‰è¿™ä¸ªåšå®Œâ€</strong>ã€‚</p>
<h5 data-id="heading-32">ç¬¬äºŒæ­¥ï¼šâ€œå¤–â€æ¥æ‹› â€”â€” å¤„ç† Promiseï¼Œç­‰ç»“æœ</h5>
<p>JS å¼•æ“ï¼ˆå¤–é¢çš„æ‰§è¡Œå™¨ï¼‰æ¥ä½è¿™ä¸ª Promise åï¼Œä¸ä¼šé—²ç€ï¼š</p>
<ol>
<li>ç›‘å¬ Promise çš„çŠ¶æ€å˜åŒ–ï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰ï¼›</li>
<li>ç­‰å¾…å¼‚æ­¥ä»»åŠ¡å®Œæˆï¼ˆæ¯”å¦‚æ¥å£è¯·æ±‚è¿”å›æ•°æ®ï¼‰ï¼›</li>
<li>æ‹¿åˆ°ç»“æœï¼ˆæ¯”å¦‚æ¥å£è¿”å›çš„ dataï¼‰ã€‚</li>
</ol>
<p>ğŸ‘‰ å¯¹åº”â€œé‡Œåº”å¤–åˆâ€ï¼š<strong>å¤–â€œåˆâ€â€”â€” å“åº”é‡Œé¢çš„è¯·æ±‚ï¼Œå¤„ç†å¼‚æ­¥ä»»åŠ¡ï¼Œæ‹¿åˆ°ç»“æœ</strong>ã€‚</p>
<h5 data-id="heading-33">ç¬¬ä¸‰æ­¥ï¼šâ€œå¤–â€å›ä¼ ç»“æœ â€”â€” ç»™â€œé‡Œâ€èµ‹å€¼ï¼Œè§¦å‘ç»§ç»­æ‰§è¡Œ</h5>
<p>å¼•æ“æ‹¿åˆ° data åï¼Œä¼šåšä¸¤ä»¶å…³é”®äº‹ï¼š</p>
<ol>
<li>æŠŠ data èµ‹å€¼ç»™ <code>await</code> å·¦è¾¹çš„å˜é‡ <code>res</code>ï¼ˆç›¸å½“äº <code>res = data</code>ï¼‰ï¼›</li>
<li>å‘Šè¯‰â€œé‡Œâ€ï¼šâ€œç»“æœæ‹¿åˆ°äº†ï¼Œä½ ç»§ç»­å¾€ä¸‹èµ°ï¼â€ â€”â€” ç”Ÿæˆå™¨ä»æš‚åœçš„ä½ç½®æ¢å¤æ‰§è¡Œã€‚</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-string">'url'</span>); 
  <span class="hljs-comment">// ã€Œé‡Œã€çš„åŠ¨ä½œï¼š</span>
  <span class="hljs-comment">// æ¥æ”¶åˆ°å¤–é¢ä¼ çš„ dataï¼Œèµ‹å€¼ç»™ resï¼Œç„¶åæ‰§è¡Œè¿™è¡Œ</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res); 
}
</code></pre>
<p>ğŸ‘‰ å¯¹åº”â€œé‡Œåº”å¤–åˆâ€ï¼š<strong>å¤–æŠŠç»“æœâ€œåˆâ€è¿›é‡Œé¢ï¼Œé‡Œæ”¶åˆ°åç»§ç»­æ‰§è¡Œï¼Œå®Œæˆä¸€æ¬¡äº’åŠ¨</strong>ã€‚</p>
<h5 data-id="heading-34">ç¬¬å››æ­¥ï¼šå¤šè½®â€œé‡Œåº”å¤–åˆâ€ï¼ˆå¤šä¸ª awaitï¼‰</h5>
<p>å¦‚æœæœ‰å¤šä¸ª <code>await</code>ï¼Œå°±æ˜¯é‡å¤ä¸Šé¢çš„è¿‡ç¨‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// ç¬¬ä¸€è½®é‡Œåº”å¤–åˆï¼š</span>
  <span class="hljs-keyword">const</span> res1 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-string">'url1'</span>); 
  <span class="hljs-comment">// ç¬¬äºŒè½®é‡Œåº”å¤–åˆï¼š</span>
  <span class="hljs-keyword">const</span> res2 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-string">`url2?<span class="hljs-subst">${res1.id}</span>`</span>); 
}
</code></pre>
<p>ğŸ‘‰ é‡ŒæŠ›ç¬¬ä¸€ä¸ª Promise â†’ å¤–å¤„ç† â†’ å›ä¼  res1 â†’ é‡Œå†æŠ›ç¬¬äºŒä¸ª Promise â†’ å¤–å¤„ç† â†’ å›ä¼  res2 â†’ ç›´åˆ°æ‰§è¡Œå®Œã€‚</p>
<h4 data-id="heading-35">è¡¥å……ï¼šå¼‚å¸¸åœºæ™¯çš„â€œé‡Œåº”å¤–åˆâ€ï¼ˆæ›´å®Œæ•´ï¼‰</h4>
<p>å¦‚æœ Promise å¤±è´¥ï¼ˆæ¯”å¦‚æ¥å£æŠ¥é”™ï¼‰ï¼Œäº’åŠ¨é€»è¾‘å˜æˆï¼š</p>
<ol>
<li>é‡Œï¼šæŠ›å‡ºå¤±è´¥çš„ Promiseï¼›</li>
<li>å¤–ï¼šæ¥ä½å¤±è´¥çš„ Promiseï¼Œæ‹¿åˆ°é”™è¯¯ä¿¡æ¯ï¼›</li>
<li>å¤–ï¼šæŠŠé”™è¯¯â€œæ‰”å›â€é‡Œï¼ˆå¯¹åº” <code>generator.throw()</code>ï¼‰ï¼›</li>
<li>é‡Œï¼šå¦‚æœæœ‰ <code>try/catch</code>ï¼Œå°±æ•è·è¿™ä¸ªé”™è¯¯ï¼Œå®Œæˆâ€œåˆâ€ã€‚</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">requestData</span>(<span class="hljs-string">'error-url'</span>); <span class="hljs-comment">// é‡ŒæŠ›å‡ºå¤±è´¥çš„ Promise</span>
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err); <span class="hljs-comment">// å¤–æŠŠé”™è¯¯ä¼ å›æ¥ï¼Œé‡Œæ•è·å¤„ç†</span>
  }
}
</code></pre>
<h4 data-id="heading-36">è®°å¿†å¼ºåŒ–ï¼šç”¨â€œé‡Œåº”å¤–åˆâ€æ€»ç»“æ ¸å¿ƒ</h4>
<ol>
<li><strong>é‡Œçš„æ ¸å¿ƒ</strong>ï¼šæŠ› Promise ç­‰ç»“æœï¼Œæ¥ç»“æœç»§ç»­èµ°ï¼ˆâ€œåº”â€â€”â€” å“åº”å¼‚æ­¥éœ€æ±‚ï¼Œç­‰å¤–éƒ¨åé¦ˆï¼‰ï¼›</li>
<li><strong>å¤–çš„æ ¸å¿ƒ</strong>ï¼šæ¥ Promise å¤„ç†å®Œï¼Œä¼ ç»“æœä¿ƒæ‰§è¡Œï¼ˆâ€œåˆâ€â€”â€” é…åˆå†…éƒ¨éœ€æ±‚ï¼Œåé¦ˆå¤„ç†ç»“æœï¼‰ï¼›</li>
<li><code>async/await</code> å°±æ˜¯æŠŠè¿™ä¸ªâ€œé‡Œåº”å¤–åˆâ€çš„è¿‡ç¨‹ï¼Œä»â€œæ‰‹åŠ¨å†™æ‰§è¡Œå™¨â€å˜æˆâ€œå¼•æ“è‡ªåŠ¨åšâ€ï¼Œ<code>ä½ åªéœ€è¦å†™â€œé‡Œâ€çš„é€»è¾‘å°±è¡Œã€‚</code></li>
</ol>
<p>è¿™ä¸ªæ¯”å–»å®Œå…¨æŠ“ä½äº†æœ¬è´¨ â€”â€” ç”Ÿæˆå™¨ï¼ˆé‡Œï¼‰å’Œæ‰§è¡Œå™¨ï¼ˆå¤–ï¼‰çš„äº’åŠ¨ï¼Œå°±æ˜¯é â€œæŠ› Promise-å¤„ç† Promise-ä¼ ç»“æœâ€å®Œæˆçš„â€œé‡Œåº”å¤–åˆâ€ï¼Œè®°ä½è¿™ä¸ªæ¯”å–»ï¼Œå°±èƒ½è®°ä½ <code>async/await</code> çš„åº•å±‚æ‰§è¡Œé€»è¾‘äº†ã€‚</p>
<h2 data-id="heading-37">è¿™ä¸‹æ˜ç™½äº† async/await å¾ˆå¤šç”¨æ³•çš„åº•å±‚é€»è¾‘</h2>
<h4 data-id="heading-38">ä¸€ã€ä¸ºä»€ä¹ˆå¿…é¡»æœ‰ <code>async</code>ï¼Ÿâ€”â€” æ ‡è®°â€œå¼‚æ­¥æ‰§è¡Œå™¨å®¹å™¨â€</h4>
<h5 data-id="heading-39">æ ¸å¿ƒåŸå› ï¼š</h5>
<p><code>async</code> æ˜¯ç»™å‡½æ•°æ‰“ä¸€ä¸ªâ€œæ ‡è®°â€ï¼Œå‘Šè¯‰ JS å¼•æ“ï¼š<strong>è¿™ä¸ªå‡½æ•°å†…éƒ¨æœ‰ <code>await</code>ï¼Œéœ€è¦æŒ‰â€œç”Ÿæˆå™¨+è‡ªåŠ¨æ‰§è¡Œå™¨â€çš„é€»è¾‘æ¥å¤„ç†</strong>ï¼Œè€Œä¸æ˜¯æ™®é€šå‡½æ•°çš„â€œä¸€æ¬¡æ€§æ‰§è¡Œå®Œâ€ã€‚</p>
<h5 data-id="heading-40">å¯¹åº”åº•å±‚é€»è¾‘ï¼ˆé‡Œåº”å¤–åˆï¼‰ï¼š</h5>
<ul>
<li>æ²¡æœ‰ <code>async</code> çš„æ™®é€šå‡½æ•°ï¼šè°ƒç”¨åä¼šâ€œä¸€å£æ°”æ‰§è¡Œå®Œæ‰€æœ‰ä»£ç â€ï¼Œæ— æ³•æš‚åœï¼›</li>
<li>åŠ äº† <code>async</code> çš„å‡½æ•°ï¼šJS å¼•æ“ä¼šæŠŠå®ƒå½“æˆã€Œç”Ÿæˆå™¨+è‡ªåŠ¨æ‰§è¡Œå™¨ã€çš„å°è£…ä½“â€”â€”è°ƒç”¨ <code>async</code> å‡½æ•°æ—¶ï¼Œå¼•æ“å…ˆåˆ›å»ºâ€œç”Ÿæˆå™¨å¼â€çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä¸ºåç»­ <code>await</code> çš„â€œæš‚åœ-æ¢å¤â€é“ºè·¯ã€‚</li>
</ul>
<h5 data-id="heading-41">è®°å¿†ä¾‹å­ï¼š</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é”™è¯¯ï¼šæ²¡æœ‰ asyncï¼Œç”¨ await ä¼šç›´æ¥æŠ¥é”™</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">requestData</span>(); <span class="hljs-comment">// Uncaught SyntaxError: await is only valid in async functions</span>
}

<span class="hljs-comment">// æ­£ç¡®ï¼šasync æ ‡è®°å‡½æ•°æ˜¯â€œå¼‚æ­¥æ‰§è¡Œå®¹å™¨â€</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">requestData</span>(); 
}
</code></pre>
<h4 data-id="heading-42">äºŒã€ä¸ºä»€ä¹ˆè¦ç”¨ <code>try/catch</code>ï¼Ÿâ€”â€” ç»Ÿä¸€æ•è·â€œé‡Œåº”å¤–åˆâ€çš„å¼‚å¸¸</h4>
<h5 data-id="heading-43">æ ¸å¿ƒåŸå› ï¼š</h5>
<p><code>await</code> åé¢çš„ Promise ä¸€æ—¦å¤±è´¥ï¼ˆrejectedï¼‰ï¼Œåº•å±‚ä¼šè§¦å‘ <code>generator.throw()</code> å‘å‡½æ•°å†…éƒ¨æŠ›å¼‚å¸¸â€”â€”å¦‚æœä¸æ•è·ï¼Œè¿™ä¸ªå¼‚å¸¸ä¼šå˜æˆâ€œæœªæ•è·å¼‚å¸¸â€å¯¼è‡´ç¨‹åºå´©æºƒï¼›è€Œ <code>try/catch</code> æ˜¯åŒæ­¥ä»£ç çš„é”™è¯¯å¤„ç†æ–¹å¼ï¼Œ<code>async/await</code> æŠŠå¼‚æ­¥é”™è¯¯â€œä¼ªè£…â€æˆåŒæ­¥é”™è¯¯ï¼Œè‡ªç„¶ç”¨ <code>try/catch</code> æ•è·æœ€è´´åˆç›´è§‰ã€‚</p>
<h5 data-id="heading-44">å¯¹åº”åº•å±‚é€»è¾‘ï¼ˆé‡Œåº”å¤–åˆï¼‰ï¼š</h5>
<ul>
<li>å¤–ï¼ˆå¼•æ“ï¼‰ï¼šå‘ç° Promise å¤±è´¥ â†’ è°ƒç”¨ <code>generator.throw(é”™è¯¯)</code> æŠŠå¼‚å¸¸æŠ›å›â€œé‡Œâ€ï¼›</li>
<li>é‡Œï¼ˆasync å‡½æ•°ï¼‰ï¼šå¦‚æœæ²¡æœ‰ <code>try/catch</code>ï¼Œå¼‚å¸¸ä¼šä»â€œé‡Œâ€é€ƒå‡ºï¼Œå˜æˆå…¨å±€æœªæ•è·å¼‚å¸¸ï¼›æœ‰ <code>try/catch</code> åˆ™èƒ½åœ¨å†…éƒ¨æ¥ä½ï¼Œå’ŒåŒæ­¥ä»£ç çš„é”™è¯¯å¤„ç†å®Œå…¨ä¸€è‡´ã€‚</li>
</ul>
<h5 data-id="heading-45">è®°å¿†ä¾‹å­ï¼š</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// await åé¢çš„ Promise å¤±è´¥ â†’ å¼•æ“æŠ›å¼‚å¸¸åˆ°è¿™é‡Œ</span>
    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥'</span>));
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ•è·é”™è¯¯:'</span>, err.<span class="hljs-property">message</span>); <span class="hljs-comment">// è¾“å‡ºï¼šè¯·æ±‚å¤±è´¥</span>
  }
}
</code></pre>
<h4 data-id="heading-46">ä¸‰ã€ä¸ºä»€ä¹ˆè¯´â€œawait åé¢çš„ä»£ç ç›¸å½“äº promise.then()â€ï¼Ÿâ€”â€” éƒ½æ˜¯â€œç­‰å¾…å®Œæˆåæ‰§è¡Œâ€</h4>
<h5 data-id="heading-47">æ ¸å¿ƒåŸå› ï¼š</h5>
<p><code>await</code> ä¼šæš‚åœå‡½æ•°æ‰§è¡Œï¼Œç­‰åé¢çš„ Promise å®Œæˆåï¼Œæ‰æ‰§è¡Œ <code>await</code> ä¸‹é¢çš„ä»£ç â€”â€”è¿™å’Œ <code>promise.then(å›è°ƒ)</code> é‡Œâ€œå›è°ƒå‡½æ•°ç­‰ Promise å®Œæˆåæ‰§è¡Œâ€çš„é€»è¾‘å®Œå…¨ä¸€è‡´ï¼Œåªæ˜¯ <code>await</code> æŠŠå›è°ƒé‡Œçš„ä»£ç â€œæ‰å¹³åŒ–â€äº†ã€‚</p>
<h5 data-id="heading-48">å¯¹åº”åº•å±‚é€»è¾‘ï¼ˆé‡Œåº”å¤–åˆï¼‰ï¼š</h5>
<ul>
<li>Promise.then å†™æ³•ï¼šå›è°ƒå‡½æ•°æ˜¯â€œå¤–â€é€šçŸ¥â€œé‡Œâ€æ‰§è¡Œçš„é€»è¾‘ï¼ˆè§‚å¯Ÿè€…æ¨¡å¼ï¼‰ï¼›</li>
<li>await å†™æ³•ï¼š<code>await</code> ä¸‹é¢çš„ä»£ç ï¼Œå°±æ˜¯å¼•æ“è‡ªåŠ¨å¸®ä½ æ”¾åˆ° <code>then</code> å›è°ƒé‡Œçš„é€»è¾‘ï¼Œåªæ˜¯ä¸ç”¨å†™å›è°ƒåµŒå¥—ã€‚</li>
</ul>
<h5 data-id="heading-49">è®°å¿†å¯¹æ¯”ï¼š</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Promise.then å†™æ³•ï¼ˆå›è°ƒåµŒå¥—ï¼‰</span>
<span class="hljs-title function_">requestData</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res); <span class="hljs-comment">// è¿™è¡Œåœ¨ then å›è°ƒé‡Œï¼Œç­‰ Promise å®Œæˆåæ‰§è¡Œ</span>
});

<span class="hljs-comment">// async/await å†™æ³•ï¼ˆæ‰å¹³åŒ–ï¼‰</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">requestData</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res); <span class="hljs-comment">// è¿™è¡Œç­‰ä»·äºä¸Šé¢ then é‡Œçš„ä»£ç ï¼Œç­‰ Promise å®Œæˆåæ‰§è¡Œ</span>
}
</code></pre>
<h4 data-id="heading-50">å››ã€ä¸ºä»€ä¹ˆè¯´â€œasync å‡½æ•°è¿”å›çš„æ˜¯ Promiseâ€ï¼Ÿâ€”â€” å¯¹é½å¼‚æ­¥ç”Ÿæ€ï¼Œå…¼å®¹æ‰§è¡Œå™¨é€»è¾‘</h4>
<h5 data-id="heading-51">æ ¸å¿ƒåŸå› ï¼š</h5>
<ol>
<li>åº•å±‚é€»è¾‘ï¼š<code>async</code> å‡½æ•°çš„è‡ªåŠ¨æ‰§è¡Œå™¨æœ€ç»ˆè¦è¿”å›ä¸€ä¸ªâ€œç»“æœå®¹å™¨â€ï¼Œè€Œ Promise æ˜¯ JS é‡Œå”¯ä¸€çš„â€œå¼‚æ­¥ç»“æœå®¹å™¨â€â€”â€”ä¸ç®¡å‡½æ•°å†…éƒ¨æœ‰æ²¡æœ‰ <code>await</code>ï¼Œå¼•æ“éƒ½ä¼šæŠŠè¿”å›å€¼åŒ…è£…æˆ Promiseï¼›</li>
<li>ç”Ÿæ€å…¼å®¹ï¼šPromise æ˜¯ JS å¼‚æ­¥çš„â€œé€šç”¨è¯­è¨€â€ï¼Œè¿”å› Promise èƒ½è®© <code>async</code> å‡½æ•°å’Œç°æœ‰å¼‚æ­¥é€»è¾‘ï¼ˆ<code>.then</code>/<code>.catch</code>ã€Promise.all ç­‰ï¼‰æ— ç¼è¡”æ¥ã€‚</li>
</ol>
<h5 data-id="heading-52">è®°å¿†ä¾‹å­ï¼š</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. æ˜¾å¼è¿”å›æ™®é€šå€¼ â†’ è‡ªåŠ¨åŒ…è£…æˆ Promise</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn1</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-number">123</span>; <span class="hljs-comment">// ç­‰ä»·äº return Promise.resolve(123)</span>
}
<span class="hljs-title function_">fn1</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)); <span class="hljs-comment">// è¾“å‡º 123</span>

<span class="hljs-comment">// 2. æ²¡æœ‰ return â†’ è¿”å› Promise.resolve(undefined)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn2</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">requestData</span>();
}
<span class="hljs-title function_">fn2</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)); <span class="hljs-comment">// è¾“å‡º undefined</span>

<span class="hljs-comment">// 3. æŠ›å‡ºå¼‚å¸¸ â†’ è¿”å› Promise.reject(é”™è¯¯)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn3</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'å‡ºé”™äº†'</span>);
}
<span class="hljs-title function_">fn3</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">message</span>)); <span class="hljs-comment">// è¾“å‡º å‡ºé”™äº†</span>
</code></pre>
<h4 data-id="heading-53">äº”ã€è¡¥å……ï¼šæˆ‘ç»å¸¸æ··æ·†çš„ç‚¹â€”â€”â€œawait ä¸æ˜¯è¿”å› Promiseï¼Œæ˜¯ç­‰å¾… Promise å¹¶å–å…¶ç»“æœâ€</h4>
<ul>
<li>âŒ é”™è¯¯ï¼šawait è¿”å› Promiseï¼›</li>
<li>âœ… æ­£ç¡®ï¼š<code>await</code> <strong>ç­‰å¾…</strong> åé¢çš„ Promise å®Œæˆï¼Œç„¶å<strong>å–å‡º Promise çš„æœ€ç»ˆç»“æœ</strong>ï¼ˆæˆåŠŸå€¼/å¤±è´¥æŠ›å¼‚å¸¸ï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-54">ä¾‹å­éªŒè¯ï¼š</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// requestData() è¿”å› Promiseï¼Œawait ç­‰å¾…å®ƒå®Œæˆï¼Œå–å‡ºç»“æœèµ‹å€¼ç»™ res</span>
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">requestData</span>(); 
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res); <span class="hljs-comment">// res æ˜¯ Promise çš„æˆåŠŸå€¼ï¼ˆæ¯”å¦‚æ¥å£è¿”å›çš„ dataï¼‰ï¼Œä¸æ˜¯ Promise</span>
}
</code></pre>
<p>å¯¹åº”åˆ°åº•å±‚æ‰§è¡Œå™¨çš„é€»è¾‘ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¯¹åº”çš„ç”Ÿæˆå™¨å‡½æ•°</span>
<span class="hljs-keyword">function</span>* <span class="hljs-title function_">genFn</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">yield</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">// await çš„åº•å±‚ï¼šyield æŠ› Promiseï¼Œç­‰ç»“æœ</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res); <span class="hljs-comment">// res = 1ï¼ˆnext ä¼ è¿›æ¥çš„ï¼‰</span>
  <span class="hljs-keyword">return</span> <span class="hljs-number">3</span>; <span class="hljs-comment">// ç”Ÿæˆå™¨æœ€ç»ˆçš„ value = 3</span>
}

<span class="hljs-comment">// æ‰§è¡Œå™¨å¤„ç†</span>
<span class="hljs-title function_">autoRun</span>(genFn).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">val</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(val)); <span class="hljs-comment">// è¾“å‡º 3</span>
<span class="hljs-comment">// autoRun é‡Œçš„é€»è¾‘ï¼š</span>
<span class="hljs-comment">// - ç¬¬ä¸€æ¬¡ next()ï¼šyield å‡º Promise.resolve(1)ï¼Œç­‰å¾…å®Œæˆå next(1)</span>
<span class="hljs-comment">// - ç¬¬äºŒæ¬¡ next(1)ï¼šres = 1ï¼Œæ‰§è¡Œåˆ° return 3ï¼Œdone = true</span>
<span class="hljs-comment">// - è§¦å‘ if (done)ï¼Œè¿”å› Promise.resolve(3) â†’ è¿™å°±æ˜¯ async å‡½æ•°çš„è¿”å›å€¼</span>
</code></pre>
<p><code>è®°å¿†å£è¯€ï¼š</code>await<code> å– Promise çš„â€œå€¼â€ï¼Œ</code>async<code> åŒ…è¿”å›å€¼æˆâ€œPromiseâ€â€”â€”å‰è€…æ˜¯â€œæ‹†åŒ…â€ï¼Œåè€…æ˜¯â€œæ‰“åŒ…â€ã€‚</code></p>
<h4 data-id="heading-55">æ€»ç»“ï¼ˆæ ¸å¿ƒè®°å¿†ç‚¹ï¼‰</h4>
<p>æŠŠè¿™äº›â€œä¸ºä»€ä¹ˆâ€æµ“ç¼©æˆ4å¥è¯ï¼Œè®°ä¸‹æ¥å°±å½»åº•æ‡‚äº†ï¼š</p>
<ol>
<li><code>async</code> æ˜¯â€œå®¹å™¨æ ‡è®°â€ï¼šå‘Šè¯‰å¼•æ“è¿™ä¸ªå‡½æ•°è¦æŒ‰â€œç”Ÿæˆå™¨+è‡ªåŠ¨æ‰§è¡Œå™¨â€é€»è¾‘è·‘ï¼›</li>
<li><code>try/catch</code> æ˜¯â€œå¼‚å¸¸å…œåº•â€ï¼šæ¥ä½å¼•æ“ä»å¤–éƒ¨æŠ›å›çš„ Promise å¤±è´¥å¼‚å¸¸ï¼›</li>
<li><code>await</code> ä¸‹é¢çš„ä»£ç  = <code>then</code> å›è°ƒï¼šéƒ½æ˜¯ç­‰ Promise å®Œæˆåæ‰§è¡Œï¼Œåªæ˜¯å†™æ³•æ›´å¹³ï¼›</li>
<li><code>async</code> å‡½æ•°è¿”å› Promiseï¼šå¯¹é½å¼‚æ­¥ç”Ÿæ€ï¼Œè®©ç»“æœèƒ½è¢« <code>.then</code>/<code>.catch</code> å¤„ç†ã€‚</li>
</ol>
<p>æœ¬è´¨ä¸Šï¼Œ<code>async/await</code> æ‰€æœ‰çš„â€œè§„åˆ™â€ï¼ˆå¿…é¡»åŠ  asyncã€ç”¨ try/catch ç­‰ï¼‰ï¼Œéƒ½æ˜¯ä¸ºäº†è®©â€œç”Ÿæˆå™¨+è‡ªåŠ¨æ‰§è¡Œå™¨â€çš„åº•å±‚é€»è¾‘ï¼Œèƒ½ä»¥â€œåŒæ­¥ä»£ç â€çš„å½¢å¼å‘ˆç°â€”â€”è¿™ä¹Ÿæ˜¯å®ƒæœ€å·§å¦™çš„åœ°æ–¹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é›¶æ„å»ºæœ¬åœ°AIåº”ç”¨ï¼šReactä¸Ollamaå…¨æ ˆå¼€å‘å®æˆ˜]]></title>    <link>https://juejin.cn/post/7595890117865504814</link>    <guid>https://juejin.cn/post/7595890117865504814</guid>    <pubDate>2026-01-17T09:39:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595890117865504814" data-draft-id="7595886887522975784" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»é›¶æ„å»ºæœ¬åœ°AIåº”ç”¨ï¼šReactä¸Ollamaå…¨æ ˆå¼€å‘å®æˆ˜"/> <meta itemprop="keywords" content="Ollama,å…¨æ ˆ,VibeCoding"/> <meta itemprop="datePublished" content="2026-01-17T09:39:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç§ƒå¤´æ•²ç å°å§å§"/> <meta itemprop="url" content="https://juejin.cn/user/24668014656249"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»é›¶æ„å»ºæœ¬åœ°AIåº”ç”¨ï¼šReactä¸Ollamaå…¨æ ˆå¼€å‘å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/24668014656249/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç§ƒå¤´æ•²ç å°å§å§
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T09:39:34.000Z" title="Sat Jan 17 2026 09:39:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">åšå®¢å¼€ç¯‡ï¼šä¸ºä»€ä¹ˆé€‰æ‹©æœ¬åœ°å¤§æ¨¡å‹å¼€å‘ï¼Ÿ</h3>
<p>åœ¨å½“å‰çš„AIæµªæ½®ä¸­ï¼ŒOpenAIç­‰äº‘ç«¯APIè™½ç„¶å¼ºå¤§ï¼Œä½†å­˜åœ¨æ•°æ®éšç§ã€Tokenæˆæœ¬å’Œç½‘ç»œå»¶è¿Ÿçš„é—®é¢˜ã€‚<strong>Ollama</strong> çš„å‡ºç°ï¼Œè®©å¼€å‘è€…å¯ä»¥åœ¨æœ¬åœ°è½»æ¾éƒ¨ç½²å¼€æºå¤§æ¨¡å‹ï¼ˆå¦‚Qwenã€Llama 3ç­‰ï¼‰ã€‚ç»“åˆå‰ç«¯æ¡†æ¶ï¼ˆå¦‚Reactï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå®Œå…¨ç§æœ‰ã€ä½æˆæœ¬çš„AIåº”ç”¨ã€‚</p>
<p>æœ¬åšå®¢å°†å¸¦ä½ ä»ç¯å¢ƒæ­å»ºåˆ°ä»£ç å®ç°ï¼Œä¸€æ­¥æ­¥æ„å»ºä¸€ä¸ªåŸºäº React å’Œ Ollama çš„èŠå¤©åº”ç”¨ï¼Œå¹¶æ·±å…¥å‰–æå…¶ä¸­çš„æŠ€æœ¯ç»†èŠ‚ã€‚</p>
<hr/>
<h3 data-id="heading-1">ç¬¬ä¸€éƒ¨åˆ†ï¼šç¯å¢ƒä¸åŸºç¡€æ¶æ„</h3>
<h4 data-id="heading-2">1.1 Ollama æ ¸å¿ƒåŸç†</h4>
<p>Ollama æ˜¯ä¸€ä¸ªåœ¨æœ¬åœ°è¿è¡Œå¤§å‹è¯­è¨€æ¨¡å‹çš„å·¥å…·ã€‚å®ƒé€šè¿‡ä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡Œæ¥å£ï¼Œè®©å¼€å‘è€…å¯ä»¥æ‹‰å–ï¼ˆPullï¼‰ã€è¿è¡Œï¼ˆRunï¼‰å’Œç®¡ç†æ¨¡å‹ã€‚</p>
<ul>
<li>
<p><strong>æ ¸å¿ƒå‘½ä»¤ï¼š</strong></p>
<ul>
<li><code>ollama pull qwen2.5:0.5b</code>ï¼šæ‹‰å–ç‰¹å®šç‰ˆæœ¬çš„åƒé—®æ¨¡å‹ã€‚</li>
<li><code>ollama run qwen2.5:0.5b</code>ï¼šå¯åŠ¨æ¨¡å‹ã€‚</li>
<li><strong>ç«¯å£æœåŠ¡ï¼š</strong> Ollama é»˜è®¤åœ¨ <code>11434</code> ç«¯å£æä¾›æœåŠ¡ï¼Œä¸”æä¾›äº†å…¼å®¹ OpenAI æ ¼å¼çš„ <code>/v1/chat/completions</code> æ¥å£ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-3">1.2 é¡¹ç›®åˆå§‹åŒ–</h4>
<p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ª React é¡¹ç›®æ¥ä½œä¸ºå‰ç«¯ç•Œé¢ã€‚ä½¿ç”¨ Vite æˆ– Create React App åˆå§‹åŒ–é¡¹ç›®ï¼Œå¹¶å®‰è£…å¿…è¦çš„ä¾èµ–ï¼ˆå¦‚ <code>axios</code> ç”¨äº HTTP è¯·æ±‚ï¼‰ã€‚</p>
<hr/>
<h3 data-id="heading-4">ç¬¬äºŒéƒ¨åˆ†ï¼šåç«¯é€šä¿¡å±‚ï¼ˆAPI æ¨¡å—ï¼‰</h3>
<p>è¿™æ˜¯åº”ç”¨çš„â€œç¥ç»ç³»ç»Ÿâ€ï¼Œè´Ÿè´£å‰ç«¯ä¸æœ¬åœ°å¤§æ¨¡å‹çš„å¯¹è¯ã€‚</p>
<h4 data-id="heading-5">2.1 ä»£ç é€»è¾‘è§£æ</h4>
<p>åœ¨æä¾›çš„ä»£ç ä¸­ï¼Œ<code>ollamaApi.js</code> æ–‡ä»¶è´Ÿè´£åˆ›å»ºä¸ Ollama æœåŠ¡çš„è¿æ¥ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;

<span class="hljs-comment">// åˆ›å»º axios å®ä¾‹</span>
<span class="hljs-keyword">const</span> ollamaApi = axios.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">'http://localhost:11434/v1'</span>, <span class="hljs-comment">// æŒ‡å‘æœ¬åœ° Ollama æœåŠ¡</span>
  <span class="hljs-attr">headers</span>: {
    <span class="hljs-string">'Authorization'</span>: <span class="hljs-string">'Bearer ollama'</span>, <span class="hljs-comment">// æ³¨æ„ï¼šOllama çš„å›ºå®š Token</span>
    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
  }
});

<span class="hljs-comment">// å°è£…èŠå¤©è¯·æ±‚å‡½æ•°</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">chatCompletions</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">messages</span>) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> ollamaApi.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/chat/completions'</span>, {
      <span class="hljs-attr">model</span>: <span class="hljs-string">'qwen2.5:0.5b'</span>, <span class="hljs-comment">// æŒ‡å®šæ¨¡å‹åç§°</span>
      messages, <span class="hljs-comment">// å¯¹è¯å†å²</span>
      <span class="hljs-attr">stream</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// å…³é—­æµå¼è¾“å‡ºï¼ˆç®€åŒ–å¤„ç†ï¼‰</span>
      <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.7</span>, <span class="hljs-comment">// æ§åˆ¶ç”Ÿæˆæ–‡æœ¬çš„éšæœºæ€§</span>
    });
    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>.<span class="hljs-property">choices</span>.<span class="hljs-property">message</span>.<span class="hljs-property">content</span>;
  } <span class="hljs-keyword">catch</span>(err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'ollama è¯·æ±‚å¤±è´¥'</span>);
  }
}
</code></pre>
<h4 data-id="heading-6">2.2 æŠ€æœ¯ç‚¹è¯¦è§£</h4>
<ol>
<li>
<p><strong>Axios å°è£…ï¼š</strong> ä½¿ç”¨ <code>axios.create</code> åˆ›å»ºå®ä¾‹ï¼Œç»Ÿä¸€ç®¡ç† <code>baseURL</code> å’Œ <code>headers</code>ï¼Œé¿å…åœ¨æ¯ä¸ªè¯·æ±‚ä¸­é‡å¤é…ç½®ã€‚</p>
</li>
<li>
<p><strong>å…¼å®¹æ€§æ¥å£ï¼š</strong> Ollama é‡‡ç”¨äº† OpenAI çš„ API è§„èŒƒï¼Œè¿™æ„å‘³ç€å¦‚æœä½ çš„åç«¯æ¢æˆ OpenAIï¼Œå‰ç«¯ä»£ç å‡ ä¹ä¸éœ€è¦ä¿®æ”¹ã€‚</p>
</li>
<li>
<p><strong>è¯·æ±‚å‚æ•°ï¼š</strong></p>
<ul>
<li><code>messages</code>: è¿™æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å« <code>role</code> (system/user/assistant) å’Œ <code>content</code>ã€‚<strong>æ³¨æ„ï¼š</strong> å¿…é¡»ä¼ å…¥å®Œæ•´çš„å¯¹è¯å†å²ï¼Œæ¨¡å‹æ‰èƒ½ç†è§£ä¸Šä¸‹æ–‡ã€‚</li>
<li><code>temperature</code>: å€¼è¶Šä½è¶Šç¡®å®šï¼Œè¶Šé«˜è¶Šæœ‰åˆ›é€ æ€§ã€‚</li>
</ul>
</li>
</ol>
<h4 data-id="heading-7">ğŸ§  ç­”ç–‘è§£æƒ‘ï¼šæ˜“é”™ç‚¹ä¸æ’æŸ¥</h4>
<ul>
<li>
<p><strong>é—®é¢˜ï¼šè·¨åŸŸé”™è¯¯ (CORS) æˆ– ç½‘ç»œè¿æ¥å¤±è´¥</strong></p>
<ul>
<li>
<p><strong>åŸå› ï¼š</strong> å‰ç«¯è¿è¡Œåœ¨ <code>localhost:3000</code>ï¼Œè€Œ Ollama æœåŠ¡è¿è¡Œåœ¨ <code>localhost:11434</code>ã€‚è™½ç„¶åŒæºç­–ç•¥é€šå¸¸å…è®¸ä¸åŒç«¯å£ï¼Œä½†å¦‚æœ Ollama æœåŠ¡æœªå¯åŠ¨ï¼Œä¼šæŠ¥ <code>ECONNREFUSED</code>ã€‚</p>
</li>
<li>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li>ç¡®ä¿ Ollama æœåŠ¡å·²å¯åŠ¨ï¼ˆç»ˆç«¯è¿è¡Œ <code>ollama serve</code> æˆ–ç›´æ¥è¿è¡Œæ¨¡å‹ï¼‰ã€‚</li>
<li>æ£€æŸ¥é˜²ç«å¢™è®¾ç½®ã€‚</li>
<li>åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œå¦‚æœé‡åˆ°ä¸¥æ ¼çš„ CORS é™åˆ¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ Vite çš„ä»£ç†é…ç½®ï¼ˆProxyï¼‰ã€‚</li>
</ol>
</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜ï¼š401 Unauthorized é”™è¯¯</strong></p>
<ul>
<li><strong>åŸå› ï¼š</strong> è™½ç„¶ Ollama æœ¬åœ°éƒ¨ç½²é€šå¸¸ä¸éœ€è¦å¤æ‚çš„é‰´æƒï¼Œä½†æ ¹æ®ä»£ç è§„èŒƒï¼Œå®ƒè¦æ±‚ Header ä¸­å¿…é¡»åŒ…å« <code>Authorization: Bearer ollama</code>ã€‚</li>
<li><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> ç¡®ä¿åœ¨è¯·æ±‚å¤´ä¸­æ­£ç¡®è®¾ç½®äº†è¯¥å­—æ®µã€‚</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜ï¼šæ¨¡å‹æœªæ‰¾åˆ° (Model not found)</strong></p>
<ul>
<li><strong>åŸå› ï¼š</strong> ä»£ç ä¸­å†™æ­»äº† <code>qwen2.5:0.5b</code>ï¼Œä½†æœ¬åœ°æœªä¸‹è½½è¯¥æ¨¡å‹ã€‚</li>
<li><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> è¿è¡Œ <code>ollama pull qwen2.5:0.5b</code>ï¼Œæˆ–è€…ä¿®æ”¹ä»£ç ä¸­çš„ <code>model</code> å­—æ®µä¸ºä½ æœ¬åœ°å·²æœ‰çš„æ¨¡å‹ï¼ˆå¦‚ <code>llama3</code>ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-8">ğŸ’¼ é¢è¯•æ¨¡æ‹Ÿï¼šAPI å±‚è®¾è®¡</h4>
<p><strong>é¢è¯•å®˜ï¼š</strong> â€œåœ¨å°è£… API æ—¶ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Axios å®ä¾‹è€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨ <code>axios.post</code>ï¼Ÿâ€<br/>
<strong>å€™é€‰äººï¼š</strong></p>
<ol>
<li><strong>ç»Ÿä¸€ç®¡ç†ï¼š</strong> å¦‚æœ baseURL å˜æ›´ï¼ˆä¾‹å¦‚ä»å¼€å‘ç¯å¢ƒåˆ‡æ¢åˆ°ç”Ÿäº§ç¯å¢ƒï¼‰ï¼Œåªéœ€ä¿®æ”¹å®ä¾‹é…ç½®ï¼Œæ— éœ€ä¿®æ”¹æ¯ä¸ªè¯·æ±‚ã€‚</li>
<li><strong>æ‹¦æˆªå™¨ï¼š</strong> å®ä¾‹å¯ä»¥æ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨ï¼ˆè‡ªåŠ¨åŠ  Tokenï¼‰å’Œå“åº”æ‹¦æˆªå™¨ï¼ˆç»Ÿä¸€é”™è¯¯å¤„ç†ï¼‰ã€‚</li>
<li><strong>å¤ç”¨æ€§ï¼š</strong> å¯ä»¥åˆ›å»ºå¤šä¸ªå®ä¾‹å¯¹åº”ä¸åŒçš„åç«¯æœåŠ¡ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-9">ç¬¬ä¸‰éƒ¨åˆ†ï¼šå‰ç«¯çŠ¶æ€ç®¡ç†ï¼ˆHooks æ¨¡å—ï¼‰</h3>
<h4 data-id="heading-10">3.1 ä»£ç é€»è¾‘è§£æ</h4>
<p><code>useLLM.js</code> æ–‡ä»¶æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰ Hookï¼Œç”¨äºç®¡ç†èŠå¤©åº”ç”¨çš„çŠ¶æ€ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { chatCompletions } <span class="hljs-keyword">from</span> <span class="hljs-string">'../api/ollamaApi.js'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useLLM</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> [messages, setMessages] = <span class="hljs-title function_">useState</span>([
    { <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">'ä½ å¥½'</span> },
    { <span class="hljs-attr">role</span>: <span class="hljs-string">'assistant'</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">'ä½ å¥½ï¼Œæˆ‘æ˜¯qwen2.5 0.5b æ¨¡å‹'</span> }
  ]);
  <span class="hljs-keyword">const</span> [loading, setLoading] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [error, setError] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);

  <span class="hljs-comment">// å‘é€æ¶ˆæ¯é€»è¾‘</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">sendMessage</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">userMessage</span>) =&gt; {
    <span class="hljs-comment">// 1. æ›´æ–°UIï¼šæ·»åŠ ç”¨æˆ·æ¶ˆæ¯</span>
    <span class="hljs-keyword">const</span> newMessages = [...messages, { <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>, <span class="hljs-attr">content</span>: userMessage }];
    <span class="hljs-title function_">setMessages</span>(newMessages);
    <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">true</span>);
    <span class="hljs-title function_">setError</span>(<span class="hljs-literal">null</span>);

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// 2. è°ƒç”¨API</span>
      <span class="hljs-keyword">const</span> botResponse = <span class="hljs-keyword">await</span> <span class="hljs-title function_">chatCompletions</span>(newMessages);
      <span class="hljs-comment">// 3. æ›´æ–°UIï¼šæ·»åŠ æœºå™¨äººå›å¤</span>
      <span class="hljs-title function_">setMessages</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> [...prev, { <span class="hljs-attr">role</span>: <span class="hljs-string">'assistant'</span>, <span class="hljs-attr">content</span>: botResponse }]);
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-title function_">setError</span>(<span class="hljs-string">'è¯·æ±‚å¤±è´¥ï¼Œè¯·é‡è¯•'</span>);
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">false</span>);
    }
  };

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">resetChat</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">setMessages</span>([]);
  };

  <span class="hljs-keyword">return</span> { messages, loading, error, sendMessage, resetChat };
};
</code></pre>
<h4 data-id="heading-11">3.2 æŠ€æœ¯ç‚¹è¯¦è§£</h4>
<ol>
<li><strong>çŠ¶æ€è®¾è®¡ï¼š</strong> ä½¿ç”¨ <code>messages</code> æ•°ç»„å­˜å‚¨å¯¹è¯å†å²ï¼Œ<code>loading</code> æ§åˆ¶æŒ‰é’®çŠ¶æ€ï¼Œ<code>error</code> å¤„ç†å¼‚å¸¸ã€‚</li>
<li><strong>é—­åŒ…ä¸å¼‚æ­¥ï¼š</strong> åœ¨ <code>sendMessage</code> ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å‡½æ•°å¼æ›´æ–° <code>setMessages(prev =&gt; [...prev, ...])</code> æ¥ç¡®ä¿è·å–åˆ°æœ€æ–°çš„çŠ¶æ€ï¼Œé¿å…é—­åŒ…é™·é˜±ã€‚</li>
<li><strong>é”™è¯¯è¾¹ç•Œï¼š</strong> ä½¿ç”¨ <code>try-catch</code> æ•è· API å¼‚å¸¸ï¼Œå¹¶é€šè¿‡ <code>setError</code> åé¦ˆç»™ UIã€‚</li>
</ol>
<h4 data-id="heading-12">ğŸ§  ç­”ç–‘è§£æƒ‘ï¼šæ˜“é”™ç‚¹ä¸æ’æŸ¥</h4>
<ul>
<li>
<p><strong>é—®é¢˜ï¼šæœºå™¨äººå›å¤æ€»æ˜¯â€œä¸Šä¸€è½®â€çš„å†…å®¹</strong></p>
<ul>
<li>
<p><strong>åŸå› ï¼š</strong> è¿™æ˜¯ä¸€ä¸ªç»å…¸çš„ <strong>State é—­åŒ…é—®é¢˜</strong>ã€‚å¦‚æœä½ åœ¨è°ƒç”¨ API å‰æ²¡æœ‰æ­£ç¡®æ›´æ–° <code>messages</code>ï¼Œæˆ–è€…åœ¨è°ƒç”¨ API æ—¶ä¼ å…¥çš„æ˜¯æ—§çš„ <code>messages</code> å¿«ç…§ã€‚</p>
</li>
<li>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ul>
<li><strong>æ–¹æ¡ˆ Aï¼š</strong> å¦‚ä¸Šé¢çš„ä»£ç æ‰€ç¤ºï¼Œå…ˆæ„é€ æ–°çš„æ¶ˆæ¯æ•°ç»„ <code>newMessages</code>ï¼Œä¼ ç»™ APIï¼ŒæˆåŠŸåå†æ›´æ–° Stateã€‚</li>
<li><strong>æ–¹æ¡ˆ Bï¼š</strong> ä½¿ç”¨ <code>useRef</code> ä¿å­˜æœ€æ–°çš„æ¶ˆæ¯åˆ—è¡¨ï¼Œæˆ–è€…åœ¨ <code>setMessages</code> çš„å›è°ƒä¸­å¤„ç†åç»­é€»è¾‘ï¼ˆè™½ç„¶ React 18 ä¸¥æ ¼æ¨¡å¼ä¸‹å¯èƒ½æ‰§è¡Œä¸¤æ¬¡æ¸²æŸ“ï¼Œä½†é€»è¾‘ä¸Šåº”ä¿è¯å¹‚ç­‰æ€§ï¼‰ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜ï¼šè¾“å…¥æ¡†æ— æ³•è¾“å…¥æˆ–æŒ‰é’®ä¸€ç›´ç¦ç”¨</strong></p>
<ul>
<li><strong>åŸå› ï¼š</strong> é€»è¾‘é”™è¯¯å¯¼è‡´ <code>loading</code> çŠ¶æ€æœªé‡ç½®ã€‚</li>
<li><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> ç¡®ä¿ <code>try-catch-finally</code> ç»“æ„å®Œæ•´ã€‚æ— è®ºæˆåŠŸæˆ–å¤±è´¥ï¼Œ<code>finally</code> å—ä¸­å¿…é¡»å°† <code>loading</code> è®¾ä¸º <code>false</code>ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-13">ğŸ’¼ é¢è¯•æ¨¡æ‹Ÿï¼šReact Hooks</h4>
<p><strong>é¢è¯•å®˜ï¼š</strong> â€œåœ¨ <code>sendMessage</code> å‡½æ•°ä¸­ï¼Œä¸ºä»€ä¹ˆåœ¨ <code>setMessages</code> ä¹‹åç«‹å³è°ƒç”¨ APIï¼Œä¼ å…¥çš„ <code>messages</code> å¯èƒ½ä¸æ˜¯æœ€æ–°çš„ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿâ€<br/>
<strong>å€™é€‰äººï¼š</strong><br/>
React çš„ <code>setState</code> æ˜¯å¼‚æ­¥çš„ã€‚åœ¨ <code>setMessages</code> è°ƒç”¨åï¼Œ<code>messages</code> å˜é‡çš„å€¼åœ¨å½“å‰å‡½æ•°ä½œç”¨åŸŸå†…å¹¶æ²¡æœ‰ç«‹å³æ”¹å˜ã€‚å¦‚æœç›´æ¥ä¼  <code>messages</code> ç»™ APIï¼Œä¼šä¸¢å¤±åˆšåˆšæ·»åŠ çš„ç”¨æˆ·æ¶ˆæ¯ã€‚<br/>
<strong>è§£å†³æ–¹æ³•ï¼š</strong></p>
<ol>
<li><strong>é¢„è®¡ç®—ï¼š</strong> åƒä»£ç ä¸­é‚£æ ·ï¼Œå…ˆç”¨ <code>const newMessages = [...messages, userMsg]</code> è®¡ç®—å‡ºæ–°æ•°ç»„ï¼Œä¼ ç»™ APIï¼Œç„¶å <code>setMessages(newMessages)</code>ã€‚</li>
<li><strong>å‡½æ•°å¼æ›´æ–°ï¼š</strong> å¦‚æœé€»è¾‘å¤æ‚ï¼Œå¯ä»¥ä½¿ç”¨ <code>useRef</code> æ¥ç»´æŠ¤ä¸€ä¸ªå¯å˜çš„å¼•ç”¨ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-14">ç¬¬å››éƒ¨åˆ†ï¼šè§†å›¾å±‚ï¼ˆUI ç»„ä»¶ï¼‰</h3>
<h4 data-id="heading-15">4.1 ä»£ç é€»è¾‘è§£æ</h4>
<p><code>App.jsx</code> æ˜¯åº”ç”¨çš„ä¸»ç»„ä»¶ï¼Œè´Ÿè´£å±•ç¤ºå’Œç”¨æˆ·äº¤äº’ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">import { useEffect, useState } from 'react'<span class="hljs-comment">;</span>
import { useLLM } from './hooks/useLLM.js'<span class="hljs-comment">;</span>

export default function App() {
  const <span class="hljs-section">[inputValue, setInputValue]</span> = useState('')<span class="hljs-comment">;</span>
  const { messages, loading, sendMessage } = useLLM()<span class="hljs-comment">; // ä½¿ç”¨è‡ªå®šä¹‰ Hook</span>

  const <span class="hljs-attr">handleSend</span> = (e) =&gt; {
    e.preventDefault()<span class="hljs-comment">;</span>
    if (!inputValue.trim()) return<span class="hljs-comment">;</span>
    sendMessage(inputValue)<span class="hljs-comment">; // è°ƒç”¨ Hook ä¸­çš„é€»è¾‘</span>
    setInputValue('')<span class="hljs-comment">; // æ¸…ç©ºè¾“å…¥æ¡†</span>
  }<span class="hljs-comment">;</span>

  // é¡µé¢æŒ‚è½½æ—¶çš„åˆå§‹åŒ–é€»è¾‘ï¼ˆå¯é€‰ï¼‰
  useEffect(() =&gt; {
    // ä¾‹å¦‚ï¼šåŠ è½½å†å²è®°å½•
  }, <span class="hljs-section">[]</span>)<span class="hljs-comment">;</span>

  return (
    &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"min-h-screen bg-gray-50 flex flex-col items-center py-6 px-4"</span>&gt;
      &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"w-full max-w-[800px] bg-white rounded-lg shadow-md flex flex-col h-[90vh] max-h-[800px]"</span>&gt;
        {/* èŠå¤©å†…å®¹åŒºåŸŸ */}
        &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"flex-1 p-4 overflow-y-auto"</span>&gt;
          {messages.map((msg, idx) =&gt; (
            &lt;div <span class="hljs-attr">key</span>={idx} className={`mb-<span class="hljs-number">4</span> p-<span class="hljs-number">3</span> rounded-lg max-w-xs <span class="hljs-variable">${msg.role === 'user' ? 'bg-blue-100 ml-auto' : 'bg-gray-100'}</span>`}&gt;
              {msg.content}
            &lt;/div&gt;
          ))}
        &lt;/div&gt;
      &lt;/div&gt;
      
      &lt;form <span class="hljs-attr">className</span>=<span class="hljs-string">"p-4 border-t"</span> <span class="hljs-literal">on</span>Submit={handleSend}&gt;
        &lt;div <span class="hljs-attr">className</span>=<span class="hljs-string">"flex gap-2"</span>&gt;
          &lt;input
            <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
            <span class="hljs-attr">value</span>={inputValue}
            <span class="hljs-attr">onChange</span>={e =&gt; setInputValue(e.target.value)} 
            <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¾“å…¥æ¶ˆæ¯....æŒ‰å›è½¦å‘é€"</span>
            <span class="hljs-attr">disabled</span>={loading} 
            <span class="hljs-attr">className</span>=<span class="hljs-string">"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"</span>
          /&gt;
          &lt;button 
            <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>
            <span class="hljs-attr">disabled</span>={loading || !inputValue.trim()}
            <span class="hljs-attr">className</span>=<span class="hljs-string">"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition"</span>
          &gt;
            {loading ? 'æ€è€ƒä¸­...' : 'å‘é€'}
          &lt;/button&gt;
        &lt;/div&gt;
      &lt;/form&gt;
    &lt;/div&gt;
  )<span class="hljs-comment">;</span>
}
</code></pre>
<h4 data-id="heading-16">4.2 æŠ€æœ¯ç‚¹è¯¦è§£</h4>
<ol>
<li><strong>å—æ§ç»„ä»¶ï¼š</strong> <code>input</code> çš„ <code>value</code> ç»‘å®šåˆ° <code>inputValue</code>ï¼Œé€šè¿‡ <code>onChange</code> æ›´æ–°çŠ¶æ€ï¼Œä¿è¯ UI ä¸ State ä¸€è‡´ã€‚</li>
<li><strong>è¡¨å•å¤„ç†ï¼š</strong> ä½¿ç”¨ <code>onSubmit</code> å¤„ç†è¡¨å•æäº¤ï¼Œå¹¶è°ƒç”¨ <code>e.preventDefault()</code> é˜»æ­¢é¡µé¢åˆ·æ–°ã€‚</li>
<li><strong>æ¡ä»¶æ¸²æŸ“ï¼š</strong> æ ¹æ® <code>loading</code> çŠ¶æ€ç¦ç”¨æŒ‰é’®å’Œæ”¹å˜æŒ‰é’®æ–‡æœ¬ï¼Œé˜²æ­¢é‡å¤æäº¤ã€‚</li>
</ol>
<h4 data-id="heading-17">ğŸ§  ç­”ç–‘è§£æƒ‘ï¼šæ˜“é”™ç‚¹ä¸æ’æŸ¥</h4>
<ul>
<li>
<p><strong>é—®é¢˜ï¼šæŒ‰ä¸‹å›è½¦é”®é¡µé¢åˆ·æ–°äº†</strong></p>
<ul>
<li><strong>åŸå› ï¼š</strong> <code>&lt;form&gt;</code> æ ‡ç­¾çš„é»˜è®¤è¡Œä¸ºæ˜¯ <code>onSubmit</code> è§¦å‘é¡µé¢è·³è½¬ã€‚</li>
<li><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> åœ¨ <code>handleSend</code> å‡½æ•°çš„ç¬¬ä¸€è¡ŒåŠ ä¸Š <code>e.preventDefault();</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜ï¼šèŠå¤©è®°å½•æ»šåŠ¨æ¡æ²¡æœ‰è‡ªåŠ¨åˆ°åº•éƒ¨</strong></p>
<ul>
<li><strong>åŸå› ï¼š</strong> DOM æ›´æ–°åï¼Œå®¹å™¨çš„ <code>scrollTop</code> æ²¡æœ‰è‡ªåŠ¨è°ƒæ•´ã€‚</li>
<li><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> ä½¿ç”¨ <code>useRef</code> è·å–èŠå¤©å®¹å™¨çš„ DOM å¼•ç”¨ï¼Œåœ¨ <code>useEffect</code> ä¸­ç›‘å¬ <code>messages</code> å˜åŒ–ï¼Œå¹¶è®¾ç½® <code>container.scrollTop = container.scrollHeight</code>ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-18">ğŸ’¼ é¢è¯•æ¨¡æ‹Ÿï¼šUI ä¸ç”¨æˆ·ä½“éªŒ</h4>
<p><strong>é¢è¯•å®˜ï¼š</strong> â€œå¦‚ä½•ä¼˜åŒ–è¿™ä¸ªèŠå¤©ç•Œé¢çš„ç”¨æˆ·ä½“éªŒï¼ˆUXï¼‰ï¼Ÿâ€<br/>
<strong>å€™é€‰äººï¼š</strong></p>
<ol>
<li><strong>æµå¼å“åº”ï¼š</strong> å½“å‰ä»£ç è®¾ç½® <code>stream: false</code>ï¼Œç”¨æˆ·éœ€è¦ç­‰å¾…æ¨¡å‹ç”Ÿæˆå®Œæ‰€æœ‰æ–‡æœ¬æ‰èƒ½çœ‹åˆ°ç»“æœã€‚å¼€å¯ <code>stream: true</code> å¯ä»¥å®ç°é€å­—è¾“å‡ºçš„æ•ˆæœï¼Œä½“éªŒæ›´åƒçœŸäººæ‰“å­—ã€‚</li>
<li><strong>åŠ è½½çŠ¶æ€ï¼š</strong> é™¤äº†æŒ‰é’®ç¦ç”¨ï¼ŒèŠå¤©åŒºåŸŸå¯ä»¥å¢åŠ ä¸€ä¸ªâ€œæœºå™¨äººæ­£åœ¨æ€è€ƒ...â€çš„ Typing åŠ¨ç”»ã€‚</li>
<li><strong>é”™è¯¯é‡è¯•ï¼š</strong> å½“ API è°ƒç”¨å¤±è´¥æ—¶ï¼ŒUI åº”è¯¥æä¾›ä¸€ä¸ªâ€œé‡è¯•â€æŒ‰é’®ï¼Œè€Œä¸æ˜¯ä»…ä»…æ˜¾ç¤ºé”™è¯¯æ–‡æœ¬ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-19">ç¬¬äº”éƒ¨åˆ†ï¼šè¿›é˜¶ä¸ä¼˜åŒ–</h3>
<h4 data-id="heading-20">5.1 æµå¼ä¼ è¾“ (Streaming)</h4>
<p>ç›®å‰çš„ä»£ç æ˜¯ç­‰å¾…æ¨¡å‹ç”Ÿæˆå®Œæ‰€æœ‰å†…å®¹åä¸€æ¬¡æ€§è¿”å›ã€‚ä¸ºäº†å®ç°ç±»ä¼¼ ChatGPT çš„æ‰“å­—æœºæ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦å¼€å¯æµå¼ä¼ è¾“ã€‚</p>
<ul>
<li><strong>åŸç†ï¼š</strong> è®¾ç½® <code>stream: true</code>ï¼Œåç«¯ä¼šä»¥ <code>text/event-stream</code> æ ¼å¼åˆ†å—ä¼ è¾“æ•°æ®ã€‚</li>
<li><strong>å®ç°ï¼š</strong> åœ¨ <code>chatCompletions</code> å‡½æ•°ä¸­ï¼Œéœ€è¦ä½¿ç”¨ <code>fetch</code> API æ›¿ä»£ Axiosï¼ˆå› ä¸º Axios å¯¹æµå¼å¤„ç†æ”¯æŒè¾ƒå¼±ï¼‰ï¼Œå¹¶è¯»å– <code>ReadableStream</code>ã€‚</li>
</ul>
<h4 data-id="heading-21">5.2 ä¸Šä¸‹æ–‡ç®¡ç†</h4>
<p><code>qwen2.5:0.5b</code> è¿™ç§ 0.5B å‚æ•°çš„æ¨¡å‹å†…å­˜æœ‰é™ã€‚å¦‚æœå¯¹è¯è¿‡é•¿ï¼Œæ¨¡å‹ä¼šâ€œå¿˜è®°â€å¼€å¤´çš„å†…å®¹ï¼Œæˆ–è€…å‡ºç°æ˜¾å­˜æº¢å‡ºã€‚</p>
<ul>
<li><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> å®ç°ä¸€ä¸ªç®€å•çš„ä¸Šä¸‹æ–‡æˆªæ–­é€»è¾‘ï¼Œåªä¿ç•™æœ€è¿‘çš„ N è½®å¯¹è¯ä¼ ç»™æ¨¡å‹ã€‚</li>
</ul>
<h4 data-id="heading-22">5.3 æ¨¡å‹åˆ‡æ¢</h4>
<p>å¯ä»¥æ‰©å±• UIï¼Œè®©ç”¨æˆ·åœ¨ç•Œé¢ä¸Šé€‰æ‹©ä¸åŒçš„æœ¬åœ°æ¨¡å‹ï¼ˆå¦‚ä» <code>qwen</code> åˆ‡æ¢åˆ° <code>llama3</code>ï¼‰ã€‚</p>
<hr/>
<h3 data-id="heading-23">åšå®¢ç»“è¯­</h3>
<p>é€šè¿‡è¿™ç¯‡åšå®¢ï¼Œæˆ‘ä»¬å®Œæˆäº†ä¸€ä¸ªä»æœ¬åœ°å¤§æ¨¡å‹éƒ¨ç½²åˆ°å‰ç«¯å…¨æ ˆåº”ç”¨çš„å¼€å‘æµç¨‹ã€‚è¿™ä¸ä»…æ˜¯ä¸€ä¸ªæŠ€æœ¯Demoï¼Œæ›´æ˜¯ç†è§£ç°ä»£AIåº”ç”¨æ¶æ„çš„åŸºçŸ³ã€‚</p>
<p><strong>æ ¸å¿ƒæ”¶è·ï¼š</strong></p>
<ol>
<li><strong>Ollama æ˜¯æœ¬åœ°AIçš„åŸºçŸ³</strong>ï¼Œå®ƒè®©å¤§æ¨¡å‹è§¦æ‰‹å¯åŠã€‚</li>
<li><strong>React Hooks</strong> æå¤§åœ°ç®€åŒ–äº†çŠ¶æ€ç®¡ç†çš„å¤æ‚åº¦ã€‚</li>
<li><strong>å‰åç«¯åˆ†ç¦»</strong> çš„æ€æƒ³ä¾ç„¶é€‚ç”¨ï¼Œå³ä½¿æ˜¯ä¸æœ¬åœ°æœåŠ¡é€šä¿¡ã€‚</li>
</ol>
<p>å¸Œæœ›è¿™ç¯‡æ•™ç¨‹èƒ½å¸®åŠ©ä½ åœ¨æœ¬åœ°AIå¼€å‘çš„é“è·¯ä¸Šæ›´è¿›ä¸€æ­¥ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å°ç¨‹åº Markdown æ¸²æŸ“è¡€æ³ªå²ï¼šmp-html ç»„ä»¶ä»å…¥é—¨åˆ°æ”¾å¼ƒå†åˆ°é‡ç”Ÿ]]></title>    <link>https://juejin.cn/post/7595886887523401768</link>    <guid>https://juejin.cn/post/7595886887523401768</guid>    <pubDate>2026-01-17T10:14:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595886887523401768" data-draft-id="7595974133096579106" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å°ç¨‹åº Markdown æ¸²æŸ“è¡€æ³ªå²ï¼šmp-html ç»„ä»¶ä»å…¥é—¨åˆ°æ”¾å¼ƒå†åˆ°é‡ç”Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,å¾®ä¿¡å°ç¨‹åº"/> <meta itemprop="datePublished" content="2026-01-17T10:14:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°æ—¶å‰ç«¯"/> <meta itemprop="url" content="https://juejin.cn/user/1197805741808339"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å°ç¨‹åº Markdown æ¸²æŸ“è¡€æ³ªå²ï¼šmp-html ç»„ä»¶ä»å…¥é—¨åˆ°æ”¾å¼ƒå†åˆ°é‡ç”Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1197805741808339/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°æ—¶å‰ç«¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T10:14:35.000Z" title="Sat Jan 17 2026 10:14:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">å‰è¨€ï¼šå°ç¨‹åº MD æ¸²æŸ“çš„éš¾ç‚¹</h2>
<p>åœ¨å°ç¨‹åºå¼€å‘ä¸­ï¼ŒMarkdown å†…å®¹çš„æ¸²æŸ“ä¸€ç›´æ˜¯ä¸€ä¸ªè®©äººå¤´ç–¼çš„é—®é¢˜ã€‚ä¸ Web ç«¯ä¸°å¯Œçš„ç”Ÿæ€ä¸åŒï¼Œå°ç¨‹åºå¹³å°æœ‰ç€è¯¸å¤šé™åˆ¶ï¼š</p>
<ul>
<li><strong>å¹³å°å·®å¼‚æ€§</strong>ï¼šå¾®ä¿¡å°ç¨‹åºã€æ”¯ä»˜å®å°ç¨‹åºã€ç™¾åº¦å°ç¨‹åºç­‰å¹³å°å¯¹ HTML å’Œ CSS çš„æ”¯æŒç¨‹åº¦ä¸åŒ</li>
<li><strong>å®‰å…¨é™åˆ¶</strong>ï¼šå°ç¨‹åºä¸å…è®¸ç›´æ¥ä½¿ç”¨ <code>dangerouslySetInnerHTML</code> æˆ–åŠ¨æ€æ‰§è¡Œè„šæœ¬</li>
<li><strong>æ ·å¼å…¼å®¹æ€§</strong>ï¼šéƒ¨åˆ† CSS å±æ€§åœ¨å°ç¨‹åºä¸­ä¸è¢«æ”¯æŒ</li>
<li><strong>æ€§èƒ½ç“¶é¢ˆ</strong>ï¼šå¤æ‚çš„å¯Œæ–‡æœ¬æ¸²æŸ“å®¹æ˜“å½±å“é¡µé¢æ€§èƒ½</li>
<li><strong>äº¤äº’é™åˆ¶</strong>ï¼šå›¾ç‰‡é¢„è§ˆã€é“¾æ¥è·³è½¬ç­‰äº¤äº’è¡Œä¸ºéœ€è¦ç‰¹æ®Šå¤„ç†</li>
</ul>
<p>è¿™äº›é™åˆ¶ä½¿å¾—åœ¨å°ç¨‹åºä¸­å®ç°å®Œæ•´çš„ Markdown æ¸²æŸ“å˜å¾—å¼‚å¸¸å›°éš¾ã€‚å¼€å‘è€…å¾€å¾€éœ€è¦åœ¨åŠŸèƒ½å®Œæ•´æ€§å’Œæ€§èƒ½ä½“éªŒä¹‹é—´å¯»æ‰¾å¹³è¡¡ã€‚</p>
<h2 data-id="heading-1">æœ€è¿‘çš„è¸©å‘ç»å†</h2>
<p>æœ€è¿‘åœ¨å¼€å‘ä¸€ä¸ªå°ç¨‹åºæ—¶ï¼Œéœ€è¦åœ¨å°ç¨‹åºä¸­æ¸²æŸ“åŒ…å«ä»£ç å—ã€è¡¨æ ¼ã€å›¾ç‰‡ç­‰å¤šç§å…ƒç´ çš„ Markdown å†…å®¹ã€‚ä¸€å¼€å§‹å¤©çœŸåœ°ä»¥ä¸ºå¯ä»¥ç”¨ç®€å•çš„ HTML è§£æå™¨æå®šï¼Œç»“æœè¸©äº†ä¸€å †å‘ã€‚</p>
<h3 data-id="heading-2">å‘ä¸€ï¼šä»£ç é«˜äº®å®Œå…¨ä¸å·¥ä½œ</h3>
<p>æœ€å…ˆé‡åˆ°çš„å°±æ˜¯ä»£ç é«˜äº®é—®é¢˜ã€‚æˆ‘æŒ‰ç…§æ–‡æ¡£å¯ç”¨ Markdown æ’ä»¶åï¼Œä»£ç å—å€’æ˜¯èƒ½æ˜¾ç¤ºï¼Œä½†æ˜¯è¯­æ³•é«˜äº®å®Œå…¨æ²¡æœ‰æ•ˆæœã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown">// è¿™æ˜¯æˆ‘ä¸€å¼€å§‹çš„é…ç½®
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">mp-html</span>
  <span class="hljs-attr">:content</span>=<span class="hljs-string">"markdownContent"</span>
  <span class="hljs-attr">:markdown</span>=<span class="hljs-string">"true"</span>
/&gt;</span></span>
</code></pre>
<p>ä»£ç å—æ˜¾ç¤ºæˆäº†æ™®é€šæ–‡æœ¬ï¼Œå®Œå…¨æ²¡æœ‰é¢œè‰²åŒºåˆ†ã€‚åæ¥æ‰å‘ç°éœ€è¦å•ç‹¬å¯ç”¨ <code>highlight</code> æ’ä»¶ï¼Œè€Œä¸”è¿˜éœ€è¦é‡æ–°æ„å»ºç»„ä»¶ã€‚</p>
<h3 data-id="heading-3">å‘äºŒï¼šå¤šè¯­è¨€ä»£ç å—è¯†åˆ«å¤±è´¥</h3>
<p>å¯ç”¨ä»£ç é«˜äº®åï¼Œå‘ç°åªæœ‰ JavaScript ä»£ç èƒ½æ­£å¸¸é«˜äº®ï¼Œå…¶ä»–è¯­è¨€å¦‚ Javaã€Pythonã€Go ç­‰éƒ½æ˜¾ç¤ºä¸ºçº¯æ–‡æœ¬ã€‚åŸæ¥ mp-html é»˜è®¤åªæ”¯æŒåŸºç¡€çš„å‡ ç§è¯­è¨€ï¼Œéœ€è¦æ‰‹åŠ¨ä¸‹è½½å®Œæ•´çš„ Prism.js æ–‡ä»¶æ¥æ”¯æŒæ›´å¤šç¼–ç¨‹è¯­è¨€ã€‚</p>
<h3 data-id="heading-4">å‘ä¸‰ï¼šå›¾ç‰‡è·¯å¾„å’Œé¢„è§ˆé—®é¢˜</h3>
<p>Markdown ä¸­çš„å›¾ç‰‡é“¾æ¥åœ¨å°ç¨‹åºä¸­æ— æ³•ç›´æ¥æ˜¾ç¤ºã€‚ä¸€å¼€å§‹æˆ‘å°è¯•ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œç»“æœå…¨éƒ¨åŠ è½½å¤±è´¥ã€‚åæ¥å‘ç°éœ€è¦é…ç½® <code>domain</code> å±æ€§æ¥å¤„ç†å›¾ç‰‡è·¯å¾„ï¼Œè€Œä¸”å›¾ç‰‡é¢„è§ˆåŠŸèƒ½è¿˜éœ€è¦æ‰‹åŠ¨å¼€å¯ã€‚</p>
<h3 data-id="heading-5">å‘å››ï¼šè¡¨æ ¼æ»šåŠ¨å’Œæ ·å¼é—®é¢˜</h3>
<p>å¤æ‚çš„è¡¨æ ¼åœ¨å°ç¨‹åºä¸­æ˜¾ç¤ºä¸å…¨ï¼Œå†…å®¹ä¼šè¢«æˆªæ–­ã€‚ç‰¹åˆ«æ˜¯æ‰‹æœºç«¯ï¼Œè¡¨æ ¼åˆ—æ•°å¤šæ—¶æ ¹æœ¬çœ‹ä¸æ¸…å†…å®¹ã€‚è€Œä¸”è¡¨æ ¼çš„æ ·å¼ä¹Ÿéœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œé»˜è®¤æ ·å¼å¾ˆéš¾çœ‹ã€‚</p>
<h3 data-id="heading-6">å‘äº”ï¼šæ–‡æœ¬é€‰æ‹©å’Œå¤åˆ¶åŠŸèƒ½</h3>
<p>ç”¨æˆ·å¸Œæœ›èƒ½å¤åˆ¶ä»£ç å—çš„å†…å®¹ï¼Œä½†æ˜¯é»˜è®¤æƒ…å†µä¸‹å°ç¨‹åºä¸æ”¯æŒæ–‡æœ¬é€‰æ‹©ã€‚åæ¥å‘ç°å¯ä»¥é€šè¿‡é…ç½® <code>selectable</code> å±æ€§æ¥å¼€å¯è¿™ä¸ªåŠŸèƒ½ã€‚</p>
<h3 data-id="heading-7">å‘å…­ï¼šMermaid å›¾è¡¨æ¸²æŸ“å¤±è´¥</h3>
<p>æœ€æ£˜æ‰‹çš„é—®é¢˜æ˜¯ Mermaid å›¾è¡¨æ¸²æŸ“ã€‚åœ¨ Markdown ä¸­ï¼ŒMermaid å›¾è¡¨é€šå¸¸ä»¥ä»£ç å—å½¢å¼å­˜åœ¨ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-code">```mermaid
graph TD;
    A--&gt;B;
    A--&gt;C;
    B--&gt;D;
    C--&gt;D;
</span></code></pre>
<pre><code class="hljs language-ini" lang="ini">
mp-html ç»„ä»¶æœ¬èº«ä¸æ”¯æŒ Mermaid è¯­æ³•æ¸²æŸ“ï¼Œå› ä¸º Mermaid éœ€è¦ JavaScript å¼•æ“æ¥è§£æå’Œç»˜åˆ¶å›¾è¡¨ï¼Œè€Œå°ç¨‹åºç¯å¢ƒå¯¹è¿™æœ‰é™åˆ¶ã€‚

ä¸€å¼€å§‹æˆ‘å°è¯•ç›´æ¥åœ¨ Markdown ä¸­åµŒå…¥ Mermaid ä»£ç ï¼Œä½†ç»“æœåªèƒ½æ˜¾ç¤ºä¸ºæ™®é€šçš„ä»£ç å—ï¼Œå®Œå…¨æ²¡æœ‰å›¾è¡¨æ•ˆæœã€‚

<span class="hljs-comment">## è§£å†³æ–¹æ¡ˆå¤§æ­ç§˜</span>

ç»è¿‡ä¸€ç•ªæŠ˜è…¾ï¼Œç»ˆäºæ‰¾åˆ°äº†å®Œæ•´çš„è§£å†³æ–¹æ¡ˆã€‚ä»¥ä¸‹æ˜¯æˆ‘çš„å®æˆ˜é…ç½®ï¼š

<span class="hljs-comment">### 1. å®Œæ•´çš„ç»„ä»¶é…ç½®</span>

```vue
&lt;template&gt;
  &lt;view <span class="hljs-attr">class</span>=<span class="hljs-string">"article-container"</span>&gt;
    &lt;mp-html
      :<span class="hljs-attr">content</span>=<span class="hljs-string">"articleContent"</span>
      :<span class="hljs-attr">markdown</span>=<span class="hljs-string">"true"</span>
      :<span class="hljs-attr">preview-img</span>=<span class="hljs-string">"true"</span>
      :<span class="hljs-attr">scroll-table</span>=<span class="hljs-string">"true"</span>
      :<span class="hljs-attr">selectable</span>=<span class="hljs-string">"true"</span>
      :<span class="hljs-attr">use-anchor</span>=<span class="hljs-string">"true"</span>
      :<span class="hljs-attr">lazy-load</span>=<span class="hljs-string">"true"</span>
      <span class="hljs-attr">container-style</span>=<span class="hljs-string">"padding: 20rpx; background: #fff; border-radius: 12rpx;"</span>
      @<span class="hljs-attr">load</span>=<span class="hljs-string">"onContentLoad"</span>
      @<span class="hljs-attr">ready</span>=<span class="hljs-string">"onContentReady"</span>
      @<span class="hljs-attr">imgtap</span>=<span class="hljs-string">"onImageTap"</span>
      @<span class="hljs-attr">linktap</span>=<span class="hljs-string">"onLinkTap"</span>
      @<span class="hljs-attr">error</span>=<span class="hljs-string">"onError"</span>
    /&gt;
  &lt;/view&gt;
&lt;/template&gt;
</code></pre>
<h3 data-id="heading-8">2. æ’ä»¶é…ç½®ï¼ˆé‡ç‚¹ï¼‰</h3>
<p>éœ€è¦åœ¨ <code>node_modules/mp-html/tools/config.js</code> ä¸­å¯ç”¨æ‰€æœ‰å¿…è¦çš„æ’ä»¶ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-string">'markdown'</span>,    <span class="hljs-comment">// Markdown è§£æ</span>
    <span class="hljs-string">'highlight'</span>,   <span class="hljs-comment">// ä»£ç é«˜äº®</span>
    <span class="hljs-string">'emoji'</span>,       <span class="hljs-comment">// Emoji æ”¯æŒ</span>
  ],

  <span class="hljs-comment">// å…¨å±€æ ·å¼é…ç½®</span>
  <span class="hljs-attr">externStyle</span>: <span class="hljs-string">`
    .markdown-body {
      color: #333;
      line-height: 1.6;
      font-size: 28rpx;
    }
    .markdown-body h1,
    .markdown-body h2,
    .markdown-body h3 {
      color: #2c3e50;
      margin: 40rpx 0 20rpx 0;
      font-weight: 600;
    }
    .markdown-body p {
      margin: 20rpx 0;
      text-align: justify;
    }
    .markdown-body pre {
      background: #f6f8fa;
      border-radius: 8rpx;
      padding: 20rpx;
      overflow-x: auto;
    }
    .markdown-body code {
      background: #f1f3f4;
      padding: 4rpx 8rpx;
      border-radius: 4rpx;
      font-family: 'Consolas', 'Monaco', monospace;
    }
    .markdown-body blockquote {
      border-left: 4rpx solid #ddd;
      padding-left: 20rpx;
      margin: 20rpx 0;
      color: #666;
      background: #fafafa;
    }
    .markdown-body table {
      border-collapse: collapse;
      width: 100%;
      margin: 20rpx 0;
    }
    .markdown-body th,
    .markdown-body td {
      border: 1rpx solid #ddd;
      padding: 12rpx;
      text-align: left;
    }
    .markdown-body th {
      background: #f5f5f5;
      font-weight: 600;
    }
  `</span>
}
</code></pre>
<h3 data-id="heading-9">3. ä»£ç é«˜äº®æ‰©å±•ï¼ˆå…³é”®æ­¥éª¤ï¼‰</h3>
<p>è¦æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€çš„ä»£ç é«˜äº®ï¼Œéœ€è¦ï¼š</p>
<ol>
<li>è®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fprismjs.com%2Fdownload.html" target="_blank" title="https://prismjs.com/download.html" ref="nofollow noopener noreferrer">prismjs.com/download.htâ€¦</a></li>
<li>é€‰æ‹© Tomorrow Night ä¸»é¢˜</li>
<li>å‹¾é€‰éœ€è¦çš„è¯­è¨€ï¼šJavaScript, Java, Python, Go, C++, C, HTML, CSS ç­‰</li>
<li>ä¸‹è½½ <code>prism.min.js</code> å’Œ <code>prism.css</code></li>
<li>æ›¿æ¢ <code>node_modules/mp-html/plugins/highlight/</code> ç›®å½•ä¸‹çš„å¯¹åº”æ–‡ä»¶</li>
<li>é‡æ–°æ„å»ºç»„ä»¶ï¼š<code>npm run build:uni-app</code></li>
</ol>
<h3 data-id="heading-10">4. ä»£ç é«˜äº®é…ç½®ä¼˜åŒ–</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// plugins/highlight/config.js</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">copyByLongPress</span>: <span class="hljs-literal">true</span>,    <span class="hljs-comment">// é•¿æŒ‰å¤åˆ¶ä»£ç </span>
  <span class="hljs-attr">showLanguageName</span>: <span class="hljs-literal">true</span>,   <span class="hljs-comment">// æ˜¾ç¤ºè¯­è¨€åç§°</span>
  <span class="hljs-attr">showLineNumber</span>: <span class="hljs-literal">true</span>       <span class="hljs-comment">// æ˜¾ç¤ºè¡Œå·</span>
}
</code></pre>
<h3 data-id="heading-11">5. Mermaid å›¾è¡¨å¤„ç†</h3>
<p>å¯¹äº Mermaid å›¾è¡¨æ¸²æŸ“é—®é¢˜ï¼Œéœ€è¦åœ¨å‰ç«¯é¢„å¤„ç†ï¼Œå°† Mermaid ä»£ç å—è½¬æ¢ä¸ºå›¾ç‰‡ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// utils/mermaidProcessor.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">processMermaidInMarkdown</span>(<span class="hljs-params">content</span>) {
  <span class="hljs-keyword">if</span> (!content) <span class="hljs-keyword">return</span> content

  <span class="hljs-comment">// åŒ¹é… mermaid ä»£ç å—</span>
  <span class="hljs-keyword">const</span> mermaidRegex = <span class="hljs-regexp">/```mermaid\s*\n([\s\S]*?)\n```/g</span>

  <span class="hljs-keyword">return</span> content.<span class="hljs-title function_">replace</span>(mermaidRegex, <span class="hljs-function">(<span class="hljs-params">match, mermaidCode</span>) =&gt;</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// å°† mermaid ä»£ç å‘é€åˆ°æœåŠ¡å™¨ç”Ÿæˆå›¾ç‰‡</span>
      <span class="hljs-comment">// è¿™é‡Œéœ€è¦å®ç°ä¸€ä¸ªæœåŠ¡ï¼Œå°† mermaid ä»£ç è½¬æ¢ä¸ºå›¾ç‰‡ URL</span>
      <span class="hljs-keyword">const</span> imageUrl = <span class="hljs-title function_">generateMermaidImageUrl</span>(mermaidCode)
      <span class="hljs-keyword">return</span> <span class="hljs-string">`![Mermaid å›¾è¡¨](<span class="hljs-subst">${imageUrl}</span>)`</span>
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Mermaid å¤„ç†å¤±è´¥:'</span>, error)
      <span class="hljs-comment">// å¤„ç†å¤±è´¥æ—¶è¿”å›åŸå§‹ä»£ç å—</span>
      <span class="hljs-keyword">return</span> match
    }
  })
}

<span class="hljs-comment">// åœ¨ Vue ç»„ä»¶ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> processedContent = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> content = question.<span class="hljs-property">value</span>?.<span class="hljs-property">content</span>
  <span class="hljs-keyword">if</span> (!content) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>

  <span class="hljs-comment">// å…ˆå¤„ç† mermaidï¼ˆå°† mermaid ä»£ç å—è½¬æ¢ä¸ºå›¾ç‰‡ï¼‰</span>
  <span class="hljs-keyword">const</span> mermaidProcessed = <span class="hljs-title function_">processMermaidInMarkdown</span>(content)
  <span class="hljs-comment">// å†è½¬æ¢ä¸º HTML</span>
  <span class="hljs-keyword">return</span> mermaidProcessed
})
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li>Mermaid å›¾è¡¨æ— æ³•åœ¨å°ç¨‹åºä¸­ç›´æ¥æ¸²æŸ“ï¼Œéœ€è¦é¢„å…ˆè½¬æ¢ä¸ºå›¾ç‰‡</li>
<li>éœ€è¦åç«¯æœåŠ¡æˆ–ç¬¬ä¸‰æ–¹ API å°† Mermaid ä»£ç è½¬æ¢ä¸ºå›¾ç‰‡</li>
<li>å¤„ç†é¡ºåºï¼šå…ˆè½¬æ¢ Mermaid â†’ å†è§£æ Markdown â†’ æœ€åæ¸²æŸ“ HTML</li>
</ul>
<h3 data-id="heading-12">6. å›¾ç‰‡å¤„ç†ç­–ç•¥</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¤„ç†å›¾ç‰‡è·¯å¾„</span>
<span class="hljs-title function_">getImageUrl</span>(<span class="hljs-params">originalUrl</span>) {
  <span class="hljs-comment">// å¦‚æœæ˜¯ç›¸å¯¹è·¯å¾„ï¼Œæ‹¼æ¥å®Œæ•´åŸŸå</span>
  <span class="hljs-keyword">if</span> (originalUrl.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'/'</span>)) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`https://your-domain.com<span class="hljs-subst">${originalUrl}</span>`</span>
  }
  <span class="hljs-comment">// å¦‚æœæ˜¯å¤–éƒ¨é“¾æ¥ï¼Œå¯ä»¥æ·»åŠ ä»£ç†æˆ–ç›´æ¥è¿”å›</span>
  <span class="hljs-keyword">return</span> originalUrl
}
</code></pre>
<h3 data-id="heading-13">6. äº‹ä»¶å¤„ç†</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">methods</span>: {
    <span class="hljs-title function_">onContentLoad</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Markdown å†…å®¹åŠ è½½å®Œæˆ'</span>)
      <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ åŠ è½½å®Œæˆåçš„é€»è¾‘</span>
    },

    <span class="hljs-title function_">onContentReady</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ‰€æœ‰èµ„æºåŠ è½½å®Œæˆ'</span>)
      <span class="hljs-comment">// å›¾ç‰‡ç­‰èµ„æºåŠ è½½å®Œæˆåçš„å¤„ç†</span>
    },

    <span class="hljs-title function_">onImageTap</span>(<span class="hljs-params">e</span>) {
      <span class="hljs-keyword">const</span> { src, i } = e.<span class="hljs-property">detail</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ç‚¹å‡»ç¬¬ <span class="hljs-subst">${i + <span class="hljs-number">1</span>}</span> å¼ å›¾ç‰‡:`</span>, src)
      <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å›¾ç‰‡ç»Ÿè®¡æˆ–å…¶ä»–é€»è¾‘</span>
    },

    <span class="hljs-title function_">onLinkTap</span>(<span class="hljs-params">e</span>) {
      <span class="hljs-keyword">const</span> { href } = e.<span class="hljs-property">detail</span>
      <span class="hljs-comment">// å¤„ç†å†…éƒ¨é“¾æ¥è·³è½¬</span>
      <span class="hljs-keyword">if</span> (href.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'#'</span>)) {
        <span class="hljs-comment">// é”šç‚¹è·³è½¬</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">mpHtml</span>.<span class="hljs-title function_">navigateTo</span>(href.<span class="hljs-title function_">substring</span>(<span class="hljs-number">1</span>))
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (href.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'/'</span>)) {
        <span class="hljs-comment">// å†…éƒ¨é¡µé¢è·³è½¬</span>
        uni.<span class="hljs-title function_">navigateTo</span>({ <span class="hljs-attr">url</span>: href })
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// å¤–éƒ¨é“¾æ¥ï¼Œå¯ä»¥å¤åˆ¶æˆ–ç”¨ webview æ‰“å¼€</span>
        uni.<span class="hljs-title function_">setClipboardData</span>({
          <span class="hljs-attr">data</span>: href,
          <span class="hljs-attr">success</span>: <span class="hljs-function">() =&gt;</span> {
            uni.<span class="hljs-title function_">showToast</span>({
              <span class="hljs-attr">title</span>: <span class="hljs-string">'é“¾æ¥å·²å¤åˆ¶'</span>,
              <span class="hljs-attr">icon</span>: <span class="hljs-string">'success'</span>
            })
          }
        })
      }
    },

    <span class="hljs-title function_">onError</span>(<span class="hljs-params">err</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'æ¸²æŸ“é”™è¯¯:'</span>, err)
      <span class="hljs-comment">// é”™è¯¯å¤„ç†é€»è¾‘</span>
    }
  }
}
</code></pre>
<h2 data-id="heading-14">æ€§èƒ½ä¼˜åŒ–å»ºè®®</h2>
<h3 data-id="heading-15">1. å›¾ç‰‡æ‡’åŠ è½½</h3>
<pre><code class="hljs language-vue" lang="vue">&lt;mp-html :lazy-load="true" /&gt;
</code></pre>
<h3 data-id="heading-16">2. æŒ‰éœ€åŠ è½½</h3>
<p>åªåœ¨éœ€è¦ Markdown æ¸²æŸ“çš„é¡µé¢å¼•å…¥ç»„ä»¶ï¼Œé¿å…å…¨å±€æ³¨å†Œå¢åŠ åŒ…ä½“ç§¯ã€‚</p>
<h3 data-id="heading-17">3. ç¼“å­˜ç­–ç•¥</h3>
<p>å¯¹äºé¢‘ç¹ä½¿ç”¨çš„ Markdown å†…å®¹ï¼Œå¯ä»¥è€ƒè™‘ç¼“å­˜è§£æç»“æœã€‚</p>
<h3 data-id="heading-18">4. æ ·å¼ä¼˜åŒ–</h3>
<p>ä½¿ç”¨ <code>externStyle</code> ç»Ÿä¸€é…ç½®æ ·å¼ï¼Œé¿å…å†…è”æ ·å¼è¿‡å¤šå½±å“æ€§èƒ½ã€‚</p>
<h2 data-id="heading-19">æ€»ç»“</h2>
<p>mp-html ç¡®å®æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å°ç¨‹åº Markdown æ¸²æŸ“ç»„ä»¶ï¼Œä½†åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­éœ€è¦æ³¨æ„ï¼š</p>
<ol>
<li><strong>æ’ä»¶é…ç½®</strong>ï¼šå¿…é¡»æ­£ç¡®å¯ç”¨å’Œé…ç½®ç›¸å…³æ’ä»¶</li>
<li><strong>ä»£ç é«˜äº®</strong>ï¼šéœ€è¦æ‰‹åŠ¨æ‰©å±• Prism.js æ¥æ”¯æŒæ›´å¤šè¯­è¨€</li>
<li><strong>æ ·å¼å¤„ç†</strong>ï¼šå……åˆ†åˆ©ç”¨ <code>externStyle</code> å’Œ <code>tag-style</code> è¿›è¡Œæ ·å¼å®šåˆ¶</li>
<li><strong>äº‹ä»¶å¤„ç†</strong>ï¼šåˆç†å¤„ç†å›¾ç‰‡ã€é“¾æ¥ç­‰äº¤äº’äº‹ä»¶</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šå¼€å¯æ‡’åŠ è½½ï¼Œåˆç†ä½¿ç”¨ç¼“å­˜ç­–ç•¥</li>
<li><strong>Mermaid å›¾è¡¨</strong>ï¼šéœ€è¦é¢„å¤„ç†å°† Mermaid ä»£ç è½¬æ¢ä¸ºå›¾ç‰‡</li>
</ol>
<p>è™½ç„¶è¸©äº†ä¸å°‘å‘ï¼Œä½†æœ€ç»ˆçš„æ•ˆæœè¿˜æ˜¯å¾ˆæ»¡æ„çš„ã€‚ç°åœ¨æˆ‘ä»¬çš„å°ç¨‹åºå¯ä»¥å®Œç¾åœ°æ¸²æŸ“åŒ…å«ä»£ç é«˜äº®ã€è¡¨æ ¼ã€å›¾ç‰‡ã€Mermaid å›¾è¡¨ç­‰å¤šç§å…ƒç´ çš„ Markdown å†…å®¹ï¼Œä¸ºç”¨æˆ·æä¾›äº†è‰¯å¥½çš„é˜…è¯»ä½“éªŒã€‚</p>
<p>ç‰¹åˆ«å€¼å¾—ä¸€æçš„æ˜¯ Mermaid å›¾è¡¨çš„å¤„ç†ï¼Œè¿™åœ¨æŠ€æœ¯é¢è¯•é¢˜ä¸­éå¸¸å¸¸è§ã€‚é€šè¿‡é¢„å¤„ç†å°†å›¾è¡¨è½¬æ¢ä¸ºå›¾ç‰‡ï¼Œæˆ‘ä»¬æˆåŠŸè§£å†³äº†å°ç¨‹åºç¯å¢ƒä¸­æ— æ³•ç›´æ¥æ¸²æŸ“ Mermaid çš„é—®é¢˜ã€‚</p>
<p>å¦‚æœä½ ä¹Ÿåœ¨å°ç¨‹åºå¼€å‘ä¸­é‡åˆ° Markdown æ¸²æŸ“çš„é—®é¢˜ï¼Œä¸å¦¨è¯•è¯• mp-html è¿™ä¸ªç»„ä»¶ï¼Œå¸Œæœ›è¿™ç¯‡è¸©å‘è®°èƒ½ä¸ºä½ èŠ‚çœä¸€äº›æ—¶é—´ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨pymobiledevice3è¿›è¡Œiphoneåº”ç”¨æ€§èƒ½é‡‡é›†]]></title>    <link>https://juejin.cn/post/7595864836360142900</link>    <guid>https://juejin.cn/post/7595864836360142900</guid>    <pubDate>2026-01-17T08:05:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595864836360142900" data-draft-id="7595871887000977408" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨pymobiledevice3è¿›è¡Œiphoneåº”ç”¨æ€§èƒ½é‡‡é›†"/> <meta itemprop="keywords" content="Python,iOS"/> <meta itemprop="datePublished" content="2026-01-17T08:05:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="èŒ«èŒ«ç¢Œç¢Œ"/> <meta itemprop="url" content="https://juejin.cn/user/430664290939080"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨pymobiledevice3è¿›è¡Œiphoneåº”ç”¨æ€§èƒ½é‡‡é›†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/430664290939080/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    èŒ«èŒ«ç¢Œç¢Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T08:05:23.000Z" title="Sat Jan 17 2026 08:05:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ‰§è¡Œæ­¥éª¤</h2>
<h4 data-id="heading-1">å®‰è£…ä¾èµ–ï¼ˆæœªå®‰è£…åˆ™æ‰§è¡Œï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash">pip install pymobiledevice3
</code></pre>
<h4 data-id="heading-2">å¯åŠ¨Tunnelï¼ˆç³»ç»Ÿç‰ˆæœ¬&gt;=17éœ€è¦ï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash">sudo pymobiledevice3 remote tunneld
</code></pre>
<h4 data-id="heading-3">è·å–æ€§èƒ½æ•°æ®ï¼ˆæ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯ï¼‰</h4>
<p>æ ¹æ®PIDè·å–æ€§èƒ½æ•°æ®</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è·å–PID</span>
pymobiledevice3 developer dvt process-id-for-bundle-id com.xxx.xxx

<span class="hljs-comment"># è·å–æŒ‡å®šPIDçš„æ€§èƒ½æ•°æ®</span>
pymobiledevice3 developer dvt sysmon process single -a pid=xxxx
</code></pre>
<p>è·å–å…¨éƒ¨è¿›ç¨‹çš„æ€§èƒ½æ•°æ®</p>
<pre><code class="hljs language-bash" lang="bash">pymobiledevice3 developer dvt sysmon process monitor --rsd xxxx:xxxx:xxxx::x 58524 0.01
</code></pre>
<h2 data-id="heading-4">ç®€å•æ–¹æ¡ˆ</h2>
<p>ä¸Šé¢çš„å¤šä¸ªæ­¥éª¤éƒ½æ˜¯é€šè¿‡<code>pymobiledevice3</code>ä¸€ä¸ªå·¥å…·æ¥å®ç°çš„ï¼Œå› æ­¤æ˜¯å¦å¯ä»¥ä¸€æ­¥å°±å®Œæˆæ€§èƒ½çš„é‡‡é›†ï¼Ÿå½“ç„¶å¯ä»¥ï¼Œé€šè¿‡æ·±æ‰’ï¼ˆå¹¶å¤åˆ¶+æ”¹é€ ï¼‰pymobiledevice3çš„æºç ï¼Œå°†æ‰€æœ‰æ“ä½œå°è£…åˆ°äº†ä¸€ä¸ªè„šæœ¬ä¸­~~~</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-string">"""
â€”â€”â€”â€”â€”â€” ä½¿ç”¨è¯´æ˜ â€”â€”â€”â€”â€”â€”
usage: python3 ios-monitor.py [-h] [-g GAP] [-b BUNDLE_ID] [-r REPORT_HOST] [--detail] [--csv] [--debug]

iosè®¾å¤‡æ€§èƒ½æ”¶é›†

options:
  -h, --help            show this help message and exit
  -g, --gap GAP         æ€§èƒ½æ•°æ®è·å–æ—¶é—´é—´éš”ï¼Œé»˜è®¤1s
  -b, --bundle_id BUNDLE_ID
                        åŒ…å, é»˜è®¤: com.mi.car.mobile
  -r, --report_host REPORT_HOST
                        æ€§èƒ½é‡‡é›†æ•°æ®ä¸ŠæŠ¥åœ°å€
  --detail              è¾“å‡ºè¯¦ç»†ä¿¡æ¯
  --csv                 ç»“æœå†™å…¥åˆ°CSVæ–‡ä»¶
  --debug               æ‰“å°debugæ—¥å¿—

â€”â€”â€”â€”â€”â€” ç¤ºä¾‹ â€”â€”â€”â€”â€”â€”
# è¿›è¡Œæ€§èƒ½é‡‡é›†ï¼Œctrl+c ç»ˆæ­¢åå†™å…¥csvæ–‡ä»¶
sudo python3 ios-monitor.py --csv

# è¿›è¡Œæ€§èƒ½é‡‡é›†ï¼Œæ•°æ®ä¸ŠæŠ¥åˆ°æŒ‡å®šæœåŠ¡
sudo python3 ios-monitor.py -r 127.0.0.1:9311

"""</span>
<span class="hljs-keyword">import</span> argparse
<span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">import</span> csv
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">import</span> logging
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> signal
<span class="hljs-keyword">import</span> sys
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> partial
<span class="hljs-keyword">import</span> multiprocessing
<span class="hljs-keyword">from</span> multiprocessing <span class="hljs-keyword">import</span> Process

<span class="hljs-keyword">from</span> pymobiledevice3.remote.common <span class="hljs-keyword">import</span> TunnelProtocol
<span class="hljs-keyword">from</span> pymobiledevice3.remote.module_imports <span class="hljs-keyword">import</span> verify_tunnel_imports
<span class="hljs-keyword">from</span> pymobiledevice3.remote.remote_service_discovery <span class="hljs-keyword">import</span> RemoteServiceDiscoveryService
<span class="hljs-keyword">from</span> pymobiledevice3.services.dvt.dvt_secure_socket_proxy <span class="hljs-keyword">import</span> DvtSecureSocketProxyService
<span class="hljs-keyword">from</span> pymobiledevice3.services.dvt.instruments.device_info <span class="hljs-keyword">import</span> DeviceInfo
<span class="hljs-keyword">from</span> pymobiledevice3.services.dvt.instruments.process_control <span class="hljs-keyword">import</span> ProcessControl
<span class="hljs-keyword">from</span> pymobiledevice3.services.dvt.instruments.sysmontap <span class="hljs-keyword">import</span> Sysmontap
<span class="hljs-keyword">from</span> pymobiledevice3.tunneld.server <span class="hljs-keyword">import</span> TunneldRunner

<span class="hljs-keyword">import</span> requests

TUNNELD_DEFAULT_ADDRESS = (<span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-number">49151</span>)

logging.basicConfig(level=logging.INFO, <span class="hljs-built_in">format</span>=<span class="hljs-string">'%(asctime)s - %(levelname)s - %(message)s'</span>)
logger = logging.getLogger(__name__)

report_error_num = <span class="hljs-number">0</span>

csv_data_list = []
csv_fieldnames=[<span class="hljs-string">'cpu'</span>, <span class="hljs-string">'mem'</span>]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">run_tunneld</span>():
    <span class="hljs-string">""" Start Tunneld service for remote tunneling
    sudo pymobiledevice3 remote tunneld
    """</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> verify_tunnel_imports():
        logger.warning(<span class="hljs-string">"verify_tunnel_imports false"</span>)
        <span class="hljs-keyword">return</span>
    host = TUNNELD_DEFAULT_ADDRESS[<span class="hljs-number">0</span>]
    port = TUNNELD_DEFAULT_ADDRESS[<span class="hljs-number">1</span>]
    protocol = TunnelProtocol(TunnelProtocol.DEFAULT.value)

    tunneld_runner = partial(TunneldRunner.create, host, port, protocol=protocol, usb_monitor=<span class="hljs-literal">True</span>,
                             wifi_monitor=<span class="hljs-literal">True</span>, usbmux_monitor=<span class="hljs-literal">True</span>, mobdev2_monitor=<span class="hljs-literal">True</span>)

    tunneld_runner()
    <span class="hljs-keyword">return</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">process_id_for_bundle_id</span>(<span class="hljs-params">lockdown, app_bundle_identifier: <span class="hljs-built_in">str</span> = <span class="hljs-string">"com.mi.car.mobile"</span></span>):
    <span class="hljs-string">""" Get PID of a bundle identifier (only returns a valid value if its running). """</span>
    <span class="hljs-keyword">with</span> DvtSecureSocketProxyService(lockdown=lockdown) <span class="hljs-keyword">as</span> dvt:
        <span class="hljs-keyword">return</span> ProcessControl(dvt).process_identifier_for_bundle_identifier(app_bundle_identifier)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">sysmon_process_single</span>(<span class="hljs-params">lockdown, pid, detail, report_host=<span class="hljs-string">''</span>, write_csv=<span class="hljs-literal">False</span>, tunnel_process=<span class="hljs-literal">None</span></span>):
    <span class="hljs-string">""" show a single snapshot of currently running processes. """</span>
    count = <span class="hljs-number">0</span>
    result = []

    <span class="hljs-keyword">with</span> DvtSecureSocketProxyService(lockdown=lockdown) <span class="hljs-keyword">as</span> dvt:
        device_info = DeviceInfo(dvt)
        <span class="hljs-keyword">with</span> Sysmontap(dvt) <span class="hljs-keyword">as</span> sysmon:
            <span class="hljs-keyword">for</span> process_snapshot <span class="hljs-keyword">in</span> sysmon.iter_processes():
                count += <span class="hljs-number">1</span>
                <span class="hljs-keyword">if</span> count &lt; <span class="hljs-number">2</span>:
                    <span class="hljs-comment"># first sample doesn't contain an initialized value for cpuUsage</span>
                    <span class="hljs-keyword">continue</span>
                <span class="hljs-keyword">for</span> process <span class="hljs-keyword">in</span> process_snapshot:
                    <span class="hljs-comment"># print(process)</span>
                    <span class="hljs-keyword">if</span> <span class="hljs-built_in">str</span>(process[<span class="hljs-string">"pid"</span>]) != <span class="hljs-built_in">str</span>(pid):
                        <span class="hljs-keyword">continue</span>
                    <span class="hljs-comment"># adding "artificially" the execName field</span>
                    process[<span class="hljs-string">'execName'</span>] = device_info.execname_for_pid(process[<span class="hljs-string">'pid'</span>])
                    result.append(process)
                <span class="hljs-comment"># exit after single snapshot</span>
                <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(result) == <span class="hljs-number">0</span>:
        logger.info(<span class="hljs-string">"[]"</span>)
        <span class="hljs-keyword">return</span>
    
    cpu_usage = <span class="hljs-string">"%.2f"</span> % result[<span class="hljs-number">0</span>][<span class="hljs-string">'cpuUsage'</span>]
    mem = <span class="hljs-string">"%.2f"</span> % (result[<span class="hljs-number">0</span>][<span class="hljs-string">'memResidentSize'</span>] / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>)
    
    <span class="hljs-keyword">if</span> write_csv:
        csv_data = {<span class="hljs-string">'cpu'</span>: cpu_usage, <span class="hljs-string">'mem'</span>: mem}
        csv_data_list.append(csv_data)

    <span class="hljs-keyword">if</span> report_host:
        report(host=report_host, info=result[<span class="hljs-number">0</span>], pid=<span class="hljs-built_in">str</span>(pid), tunnel_process=tunnel_process)
        <span class="hljs-keyword">return</span>

    <span class="hljs-keyword">if</span> detail:
        logger.info(json.dumps(result, indent=<span class="hljs-number">4</span>, ensure_ascii=<span class="hljs-literal">False</span>))
    <span class="hljs-keyword">else</span>:
        logger.info(<span class="hljs-string">"[CPU]{} %  [å†…å­˜]{} MB"</span>.<span class="hljs-built_in">format</span>(cpu_usage, mem))

<span class="hljs-keyword">def</span> <span class="hljs-title function_">report</span>(<span class="hljs-params">host: <span class="hljs-built_in">str</span>, info: <span class="hljs-built_in">dict</span>, pid: <span class="hljs-built_in">str</span>, tunnel_process=<span class="hljs-literal">None</span></span>):
    <span class="hljs-keyword">global</span> report_error_num
    url = <span class="hljs-string">'http://%s/monitor/collect'</span> % host
    mem = info[<span class="hljs-string">'memResidentSize'</span>] / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>
    data = {
        <span class="hljs-string">'device'</span>: <span class="hljs-string">'ios-%s'</span> % pid,
        <span class="hljs-string">'list'</span>: [<span class="hljs-number">0</span>, info[<span class="hljs-string">'cpuUsage'</span>], <span class="hljs-number">0</span>, mem],
        <span class="hljs-string">'app_cpu_rate'</span>: info[<span class="hljs-string">'cpuUsage'</span>],
        <span class="hljs-string">'app_mem'</span>: mem,
        <span class="hljs-string">'timestamp'</span>: <span class="hljs-built_in">int</span>(time.time() * <span class="hljs-number">1000</span>)
    }
    report_err = <span class="hljs-literal">False</span>
    <span class="hljs-keyword">try</span>:
        resp = requests.post(url=url, json=data, timeout=(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>))
    <span class="hljs-keyword">except</span> Exception:
        report_err = <span class="hljs-literal">True</span>

    <span class="hljs-keyword">if</span> report_err <span class="hljs-keyword">is</span> <span class="hljs-literal">False</span> <span class="hljs-keyword">and</span> resp.status_code != <span class="hljs-number">200</span>:
        report_err = <span class="hljs-literal">True</span>

    <span class="hljs-keyword">if</span> report_err:
        report_error_num += <span class="hljs-number">1</span>
        logger.warning(<span class="hljs-string">"ä¸ŠæŠ¥å¤±è´¥ %d"</span> % report_error_num)
        <span class="hljs-keyword">if</span> report_error_num &gt; <span class="hljs-number">5</span>:
            logger.info(<span class="hljs-string">"æ¥æ”¶ç«¯å·²å…³é—­, ç›‘æ§é€€å‡º"</span>)
            <span class="hljs-keyword">if</span> tunnel_process:
                tunnel_process.terminate()
            sys.exit(<span class="hljs-number">0</span>)
    <span class="hljs-keyword">else</span>:
        cpu_usage = <span class="hljs-string">"%.2f"</span> % info[<span class="hljs-string">'cpuUsage'</span>]
        logger.info(<span class="hljs-string">"report [CPU]{} %  [å†…å­˜]{} MB"</span>.<span class="hljs-built_in">format</span>(cpu_usage, mem))
        report_error_num = <span class="hljs-number">0</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_tunnel_addr</span>(<span class="hljs-params">attemp_times=<span class="hljs-number">30</span></span>):
    url = <span class="hljs-string">'http://127.0.0.1:%d/'</span> % TUNNELD_DEFAULT_ADDRESS[<span class="hljs-number">1</span>]
    try_times = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> try_times &lt; attemp_times:
        <span class="hljs-keyword">try</span>:
            logger.info(<span class="hljs-string">'--- è·å–è®¾å¤‡è¿æ¥ä¿¡æ¯'</span>)
            resp = requests.get(url=url, timeout=(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)).json()
            <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> resp.values():
                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> v:
                    <span class="hljs-keyword">continue</span>
                <span class="hljs-keyword">return</span> v[<span class="hljs-number">0</span>][<span class="hljs-string">'tunnel-address'</span>], v[<span class="hljs-number">0</span>][<span class="hljs-string">'tunnel-port'</span>]
        <span class="hljs-keyword">except</span> Exception:
            <span class="hljs-keyword">pass</span>
        try_times += <span class="hljs-number">1</span>
        time.sleep(<span class="hljs-number">1</span>)
        <span class="hljs-keyword">continue</span>
    logger.warning(<span class="hljs-string">'--- æœªæ‰¾åˆ°iosè®¾å¤‡'</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>, <span class="hljs-literal">None</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">run_in_one</span>(<span class="hljs-params">bundle_id: <span class="hljs-built_in">str</span>, gap: <span class="hljs-built_in">int</span>, detail: <span class="hljs-built_in">bool</span>, report_host: <span class="hljs-built_in">str</span> = <span class="hljs-string">''</span>, write_csv: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span></span>):
    logger.info(<span class="hljs-string">'--- è¿æ¥è®¾å¤‡'</span>)
    p = Process(target=run_tunneld, args=())
    p.start()

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">sys_exit</span>(<span class="hljs-params">status: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span></span>):
        p.terminate()
        <span class="hljs-comment"># å†™å…¥csv</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(csv_data_list) &gt; <span class="hljs-number">0</span>:
            logger.info(<span class="hljs-string">'--- å†™å…¥CSV'</span>)
            filename = <span class="hljs-string">'ios-monitor-result-%d.csv'</span> % <span class="hljs-built_in">int</span>(time.time())
            filepath = os.path.join(os.getcwd(), filename)
            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filepath, <span class="hljs-string">'w'</span>, encoding=<span class="hljs-string">'UTF8'</span>, newline=<span class="hljs-string">''</span>) <span class="hljs-keyword">as</span> f:
                writer = csv.DictWriter(f, fieldnames=csv_fieldnames)
                writer.writeheader()
                writer.writerows(csv_data_list)
        
        logger.info(<span class="hljs-string">' --- é€€å‡º ---'</span>)
        sys.exit(status)

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">signal_handler</span>(<span class="hljs-params">*args, **kwargs</span>):
        sys_exit(<span class="hljs-number">0</span>)

    time.sleep(<span class="hljs-number">3</span>)
    signal.signal(signal.SIGINT, signal_handler)

    addr, port = get_tunnel_addr(attemp_times=<span class="hljs-number">30</span>)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> addr:
        sys_exit(<span class="hljs-number">1</span>)

    logger.info(<span class="hljs-string">"--- connect device: %s %d"</span> % (addr, port))

    logger.debug(<span class="hljs-string">'start run'</span>)
    rsd = RemoteServiceDiscoveryService(address=(addr, port))
    logger.debug(<span class="hljs-string">'start rsd connect'</span>)
    asyncio.run(rsd.connect(), debug=<span class="hljs-literal">True</span>)
    time.sleep(<span class="hljs-number">1</span>)
    logger.debug(<span class="hljs-string">'get pid'</span>)
    pid = process_id_for_bundle_id(lockdown=rsd, app_bundle_identifier=bundle_id)
    logger.info(<span class="hljs-string">'è·å–åº”ç”¨(%s)PID: %d'</span> % (bundle_id, pid))

    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> pid:
            pid = process_id_for_bundle_id(lockdown=rsd, app_bundle_identifier=bundle_id)
            logger.info(<span class="hljs-string">'è·å–åº”ç”¨(%s)PID: %d'</span> % (bundle_id, pid))
            time.sleep(<span class="hljs-number">0.3</span>)
            <span class="hljs-keyword">continue</span>

        <span class="hljs-keyword">try</span>:
            sysmon_process_single(lockdown=rsd, pid=pid, detail=detail, report_host=report_host, write_csv=write_csv, tunnel_process=p)
            time.sleep(gap/<span class="hljs-number">1000</span>)
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> err:
            logger.error(<span class="hljs-string">'è·å–æ€§èƒ½æŒ‡æ ‡å¤±è´¥: {}'</span>.<span class="hljs-built_in">format</span>(err))
            addr, port = get_tunnel_addr(attemp_times=<span class="hljs-number">30</span>)
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> addr:
                sys_exit(<span class="hljs-number">1</span>)

            pid = process_id_for_bundle_id(lockdown=rsd, app_bundle_identifier=bundle_id)
            logger.info(<span class="hljs-string">'è·å–åº”ç”¨(%s)PID: %d'</span> % (bundle_id, pid))

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
    multiprocessing.freeze_support()
    parser = argparse.ArgumentParser(description=<span class="hljs-string">'iosè®¾å¤‡æ€§èƒ½æ”¶é›†'</span>, add_help=<span class="hljs-literal">True</span>)
    parser.add_argument(<span class="hljs-string">'-g'</span>, <span class="hljs-string">'--gap'</span>, <span class="hljs-built_in">type</span>=<span class="hljs-built_in">int</span>, required=<span class="hljs-literal">False</span>, default=<span class="hljs-number">1000</span>,
                        <span class="hljs-built_in">help</span>=<span class="hljs-string">'æ€§èƒ½æ•°æ®è·å–æ—¶é—´é—´éš”(ms)ï¼Œé»˜è®¤1000ms'</span>)
    parser.add_argument(<span class="hljs-string">'-b'</span>, <span class="hljs-string">'--bundle_id'</span>, required=<span class="hljs-literal">False</span>, default=<span class="hljs-string">'com.mi.car.mobile'</span>,
                        <span class="hljs-built_in">help</span>=<span class="hljs-string">'åŒ…å, é»˜è®¤: com.mi.car.mobile'</span>)
    parser.add_argument(<span class="hljs-string">'-r'</span>, <span class="hljs-string">'--report_host'</span>, required=<span class="hljs-literal">False</span>, default=<span class="hljs-string">''</span>,
                        <span class="hljs-built_in">help</span>=<span class="hljs-string">'æ€§èƒ½é‡‡é›†æ•°æ®ä¸ŠæŠ¥åœ°å€'</span>)
    parser.add_argument(<span class="hljs-string">'--detail'</span>, default=<span class="hljs-literal">False</span>, action=<span class="hljs-string">'store_true'</span>,
                        <span class="hljs-built_in">help</span>=<span class="hljs-string">'è¾“å‡ºè¯¦ç»†ä¿¡æ¯'</span>)
    parser.add_argument(<span class="hljs-string">'--csv'</span>, default=<span class="hljs-literal">False</span>, action=<span class="hljs-string">'store_true'</span>,
                        <span class="hljs-built_in">help</span>=<span class="hljs-string">'ç»“æœå†™å…¥åˆ°CSVæ–‡ä»¶'</span>)
    parser.add_argument(<span class="hljs-string">'--debug'</span>, default=<span class="hljs-literal">False</span>, action=<span class="hljs-string">'store_true'</span>,
                        <span class="hljs-built_in">help</span>=<span class="hljs-string">'æ‰“å°debugæ—¥å¿—'</span>)

    args = parser.parse_args()

    <span class="hljs-keyword">if</span> args.debug:
        logger.setLevel(logging.DEBUG)

    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> args.bundle_id:
        logger.error(<span class="hljs-string">'bundle_id invalid'</span>)
        sys.exit(<span class="hljs-number">1</span>)

    gap_ms = args.gap
    <span class="hljs-comment"># æœ€ä½200msé—´éš”</span>
    <span class="hljs-keyword">if</span> gap_ms &lt; <span class="hljs-number">200</span>:
        gap_ms = <span class="hljs-number">200</span>

    rpt_host = args.report_host
    <span class="hljs-comment"># ä¸ŠæŠ¥åˆ°æœ¬æœºå®¢æˆ·ç«¯</span>
    <span class="hljs-keyword">if</span> rpt_host <span class="hljs-keyword">in</span> {<span class="hljs-string">'local'</span>, <span class="hljs-string">'localhost'</span>, <span class="hljs-string">'*'</span>, <span class="hljs-string">'-'</span>, <span class="hljs-string">'9311'</span>}:
        rpt_host = <span class="hljs-string">'127.0.0.1:9311'</span>
    run_in_one(bundle_id=args.bundle_id, gap=gap_ms, detail=args.detail, report_host=rpt_host, write_csv=args.csv)

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ooderAIï¼š Agentç®¡ç†å¹³å°å¼€æºè®¾è®¡]]></title>    <link>https://juejin.cn/post/7595911076014194724</link>    <guid>https://juejin.cn/post/7595911076014194724</guid>    <pubDate>2026-01-17T10:23:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595911076014194724" data-draft-id="7595994039108485156" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ooderAIï¼š Agentç®¡ç†å¹³å°å¼€æºè®¾è®¡"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-17T10:23:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="OneCodeCN"/> <meta itemprop="url" content="https://juejin.cn/user/1427583415622366"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ooderAIï¼š Agentç®¡ç†å¹³å°å¼€æºè®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1427583415622366/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    OneCodeCN
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T10:23:40.000Z" title="Sat Jan 17 2026 10:23:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€ï¼šooderå¼€æºçš„åˆå¿ƒ</h2>
<p>ooder å›¢é˜Ÿæ˜¯ä¸€åªå¯¹æŠ€æœ¯æœ‰ç€æ‰§ç€è¿½æ±‚çš„å›¢é˜Ÿï¼Œåœ¨Agentï¼ŒSkillçš„é«˜é€Ÿå‘å±•çš„ä»Šå¤© ï¼Œ è®©æˆ‘ä»¬åšä¿¡ï¼ŒAIå¤§çˆ†å‘çš„æ—¶ä»£å¯èƒ½å°½åœ¨çœ¼å‰ã€‚ä½†å›½å†…çš„ç¯å¢ƒä¸å›½å¤–æœ‰å¾ˆå¤§çš„ä¸åŒï¼Œç‰¹åˆ«æ˜¯å¼€æºå¼€æ”¾æ–¹é¢ï¼Œå£å’éå¸¸é«˜ã€‚å³ä½¿æ‹¥æœ‰Skill è¿™æ ·è·¨æ—¶ä»£çš„æŠ€æœ¯å‡ºç°ä»ç„¶æ˜¯å¾ˆéš¾ä»¥æ’¼åŠ¨å›½å†…ITå„è‡ªä¸ºè¥çš„ç°çŠ¶ã€‚ç»è¿‡è®¤çœŸçš„è€ƒè™‘æˆ‘ä»¬å†³å®šå¼€æºæˆ‘ä»¬å†…éƒ¨åä½œä½¿ç”¨çš„åŸºäºSpringCloudçš„åˆ†å¸ƒå¼çš„SuperAgentå¹³å°ã€‚<strong>ä½¿ç”¨MITåè®®ï¼Œå…è®¸ä»»æ„ç¬¬ä¸‰æ–¹é’ˆå¯¹åè®®ã€ä»£ç æ— é™åˆ¶ä¿®æ”¹ã€åˆ†å‘</strong>ã€‚è€Œooder å›¢é˜Ÿåˆ™ä¼šå°†æ›´å¤šçš„ç²¾åŠ›æ”¾åˆ°ï¼ŒåŸºäºooder å¼€æºåè®®çš„å·¥å…·é“¾ä»¥åŠSkillåº•å±‚æ”¯æŒ çš„å¼€å‘ï¼Œä¼šåšå¼ºåšå¥½åŒ…æ‹¬ooderA2UI,SkillFlowäº§å“ï¼ŒåŒæ—¶ä¼šç»§ç»­ç»´æŠ¤OneCodeçš„ä»£ç å‡çº§ã€‚ä½†å› ä¸ºæ—¶é—´å’Œç²¾åŠ›æœ‰é™ï¼Œæˆ‘ä»¬é™¤äº†å°†ç°æœ‰çš„Agentæ ‡å‡†ï¼ŒSkillè§„èŒƒå¿«é€Ÿçš„çº³å…¥åˆ°æˆ‘ä»¬æ”¯æŒèŒƒå›´ï¼ŒåŒæ—¶è¿˜é¢ä¸´å¼ºåº¦ä¸å°çš„SuperAgentå¹³å°æœ¬èº«çš„å¼€æºé‡æ„æ•´ç†ï¼Œåœ¨åç»­çš„å‘å¸ƒè¿‡ç¨‹ä¸­æˆ‘ä»¬å°†åˆ†æ­¥å°†åè®®å’Œå·¥ç¨‹ä»£ç ä»¥åŠAIè¾…åŠ©çš„è„šæ‰‹æ¶å·¥ç¨‹æ¨å‡ºã€‚å¼€æºç‰ˆåœ¨é‡æ„è¿‡ç¨‹ä¸­å¤§é‡é‡‡ç”¨äº†AIæ¥è¾…åŠ©ç”šè‡³ä¸»å¯¼å®Œæˆã€‚ä½†æˆ‘ä»¬åšæŒæ‰€æœ‰çš„è®¾è®¡å’Œæµ‹è¯•äººå·¥å®¡æ ¸ä¼šåŒæ­¥å‘å¸ƒï¼Œä¸è¿‡ä¹Ÿå¿…é¡»å‹æƒ…æé†’ï¼ŒSuperAgentå¼€æºå·¥ç¨‹ä»…ä¸ºå¼€æºåè®®çš„å‚è€ƒå®ç°ï¼Œç›´æ¥å•†ç”¨éœ€è¦åšè®¤çœŸçš„è¯„ä¼°ã€‚</p>
<p>æˆ‘ä»¬å¸Œæœ›å‚è€ƒç‰ˆæœ¬å¯ä»¥èŠ‚çœåç»­çš„å¼€å‘è€…åœ¨è®¾è®¡ã€è§„èŒƒæ–¹é¢æŠ•å…¥æ›´å¤šçš„ç²¾åŠ›ï¼ŒåŠªåŠ›åšåˆ°å¼€ç®±å³ç”¨ï¼ŒåŒæ—¶ä¹Ÿå°†è‡´åŠ›äºä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ol>
<li><strong>æ ‡å‡†åŒ–SKILLå¼€å‘</strong>ï¼šåˆ¶å®šç»Ÿä¸€çš„SKILLå¼€å‘è§„èŒƒï¼Œè®©AIèƒ½åŠ›çš„å¼€å‘æ›´åŠ è§„èŒƒåŒ–</li>
<li><strong>è§„èŒƒåŒ–SKILLç®¡ç†</strong>ï¼šå»ºç«‹ç»Ÿä¸€çš„SKILLç®¡ç†æœºåˆ¶ï¼Œè®©ä¼ä¸šå’Œä¸ªäººèƒ½å¤Ÿæ›´é«˜æ•ˆåœ°ç®¡ç†å’Œä½¿ç”¨AIèƒ½åŠ›</li>
<li><strong>å®ç°é¡ºç•…åä½œ</strong>ï¼šæ„å»ºA2Aã€A2Pã€A2Uä¹‹é—´çš„åä½œæ¡†æ¶ï¼Œè®©AIèƒ½åŠ›èƒ½å¤Ÿæ— ç¼åä½œ</li>
<li><strong>é™ä½ä½¿ç”¨é—¨æ§›</strong>ï¼šæä¾›å¯è§†åŒ–çš„ç¼–æ’å·¥å…·ï¼Œè®©éæŠ€æœ¯äººå‘˜ä¹Ÿèƒ½è½»æ¾ä½¿ç”¨AIèƒ½åŠ›</li>
<li><strong>ä¿æŠ¤ç”¨æˆ·éšç§</strong>ï¼šæ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼ï¼Œç¡®ä¿ç”¨æˆ·æ•°æ®çš„å®‰å…¨å’Œéšç§</li>
</ol>
<p>ä½¿å¾—æˆ‘ä»¬AIAgent ç”Ÿæ€èƒ½æ›´åŠ å¥åº·å‘å±•ã€‚</p>
<p><strong>ä¸‹é¢æ˜¯æ­£æ–‡æ˜¯ï¼š</strong></p>
<p>ä¼ä¸šå’Œä¸ªäººåœ¨ä½¿ç”¨AIèƒ½åŠ›æ—¶é¢ä¸´çš„è¯¸å¤šæŒ‘æˆ˜ï¼šAIèƒ½åŠ›åˆ†æ•£åœ¨ä¸åŒå¹³å°ã€ç¼ºä¹ç»Ÿä¸€çš„ç®¡ç†æœºåˆ¶ã€è·¨ç³»ç»Ÿåä½œå›°éš¾ã€ä¸ªäººAIå·¥å…·æ— æ³•æœ‰æ•ˆæ•´åˆç­‰ã€‚SuperAgentè¯ç”Ÿäº†ï¼Œä¸‹æ–‡æ˜¯ä¸€ä¸ªç®€å•çš„ä»‹ç»ï¼š</p>
<h2 data-id="heading-1">1. ä»€ä¹ˆæ˜¯ooder SuperAgentï¼Ÿ</h2>
<p>ooder SuperAgentæ˜¯ä¸€å¥—åŸºäºMITåè®®çš„å¼€æºä¼ä¸šçº§AIèƒ½åŠ›åˆ†å‘ä¸è‡ªåŠ¨åŒ–åä½œæ¡†æ¶ï¼Œå®ƒé€šè¿‡åˆ›æ–°çš„Agentæ¶æ„å’ŒSKILLç®¡ç†æœºåˆ¶ï¼Œä¸ºä¼ä¸šæä¾›äº†ä»ç®€å•ä»»åŠ¡åˆ°å¤æ‚æµç¨‹çš„å…¨åœºæ™¯è‡ªåŠ¨åŒ–è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-2">æ ¸å¿ƒè®¾è®¡ç†å¿µ</h2>
<ol>
<li><strong>MCPAgentåˆ†å‘ç½‘ç»œ</strong>ï¼šä¼ä¸š/ç¬¬ä¸‰æ–¹ç³»ç»Ÿå¯ä»¥å°†è‡ªå·±çš„MCPAgentæ¥å…¥AIServerï¼Œå°†AIèƒ½åŠ›é€šè¿‡SuperAgentåˆ†å‘ï¼›ä¸ªäººç”¨æˆ·æ‹¥æœ‰ä¸“å±MCPAgentï¼Œæ•´åˆä¸ªäººAIå·¥å…·</li>
<li><strong>AIèƒ½åŠ›æ ‡å‡†åŒ–</strong>ï¼šå®šä¹‰ç»Ÿä¸€çš„AIèƒ½åŠ›æ¥å£è§„èŒƒï¼Œæ”¯æŒ1:n Capabilityå…³ç³»ï¼Œå®ç°AIèƒ½åŠ›çš„æ¨¡å—åŒ–è®¾è®¡</li>
<li><strong>è·¨åŸŸè‡ªåŠ¨åŒ–ç¼–æ’</strong>ï¼šé€šè¿‡Skillflowå¯è§†åŒ–å·¥å…·ï¼Œå®ç°è·¨ä¼ä¸š/ä¸ªäººMCPAgentçš„å·¥ä½œæµç¼–æ’</li>
<li><strong>å®‰å…¨å¯é çš„è®¾è®¡</strong>ï¼šåŸºäºRBACçš„æƒé™ç®¡ç†ï¼Œæ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼ï¼Œç¡®ä¿ç³»ç»Ÿå®‰å…¨å¯é </li>
</ol>
<h2 data-id="heading-3">2. SuperAgentä¼ä¸šæ€»ä½“ç»“æ„</h2>
<p>SuperAgentä¼ä¸šæ€»ä½“ç»“æ„ç”±å…­å¤§æ ¸å¿ƒç»„ä»¶æ„æˆï¼š<strong>Authè®¤è¯ä¸­å¿ƒ</strong>ã€<strong>DataServeræ•°æ®ä¸­å¿ƒ</strong>ã€<strong>Skillèƒ½åŠ›ç®¡ç†ä¸­å¿ƒ</strong>ã€<strong>LLMè°ƒåº¦ä¸­å¿ƒ</strong>ã€<strong>Skillflowè°ƒåº¦ä¸­å¿ƒ</strong>å’Œ<strong>Agentåä½œå±‚</strong>ï¼Œå½¢æˆå®Œæ•´çš„ä¼ä¸šçº§AIèƒ½åŠ›åä½œç”Ÿæ€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7cc9f19382ca4b9bb3cfe24ad2981e8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769250220&amp;x-signature=uhbeoEXstr5nOBpw5ZU7CwX%2Fmto%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-4">2.1 æ ¸å¿ƒç»„ä»¶è¯¦ç»†æè¿°</h2>
<h2 data-id="heading-5">2.1.1 Authè®¤è¯ä¸­å¿ƒ</h2>
<p><strong>æ ¸å¿ƒèŒè´£</strong>ï¼šæä¾›ç»Ÿä¸€çš„èº«ä»½è®¤è¯å’ŒæˆæƒæœåŠ¡ï¼Œç¡®ä¿ç³»ç»Ÿå®‰å…¨å¯é ã€‚</p>
<ul>
<li><strong>èº«ä»½ç®¡ç†</strong>ï¼šç”¨æˆ·ã€è§’è‰²ã€æƒé™çš„é›†ä¸­ç®¡ç†</li>
<li><strong>è®¤è¯æœåŠ¡</strong>ï¼šæ”¯æŒOAuth 2.0ã€JWTã€API Keyç­‰å¤šç§è®¤è¯æ–¹å¼</li>
<li><strong>æˆæƒç®¡ç†</strong>ï¼šåŸºäºRBACçš„ç»†ç²’åº¦æƒé™æ§åˆ¶</li>
<li><strong>å•ç‚¹ç™»å½•</strong>ï¼šæ”¯æŒä¼ä¸šå†…éƒ¨ç³»ç»Ÿçš„å•ç‚¹ç™»å½•</li>
<li><strong>å®¡è®¡æ—¥å¿—</strong>ï¼šå®Œæ•´çš„æ“ä½œæ—¥å¿—è®°å½•ï¼Œä¾¿äºåˆè§„å®¡è®¡</li>
</ul>
<h2 data-id="heading-6">2.1.2 DataServeræ•°æ®ä¸­å¿ƒ</h2>
<p><strong>æ ¸å¿ƒèŒè´£</strong>ï¼šç»Ÿä¸€ç®¡ç†ä¼ä¸šæ•°æ®ï¼Œæ”¯æŒå¤šç§æ•°æ®ç±»å‹å’Œå­˜å‚¨æ–¹å¼ã€‚</p>
<ul>
<li><strong>æ•°æ®å­˜å‚¨</strong>ï¼šæ”¯æŒç»“æ„åŒ–ã€åŠç»“æ„åŒ–ã€éç»“æ„åŒ–æ•°æ®å­˜å‚¨</li>
<li><strong>æ•°æ®å¤„ç†</strong>ï¼šæ•°æ®æ¸…æ´—ã€è½¬æ¢ã€é›†æˆç­‰ETLæ“ä½œ</li>
<li><strong>æ•°æ®åˆ†æ</strong>ï¼šæä¾›åŸºç¡€çš„æ•°æ®åˆ†æèƒ½åŠ›</li>
<li><strong>æ•°æ®å®‰å…¨</strong>ï¼šæ•°æ®åŠ å¯†ã€è„±æ•ã€è®¿é—®æ§åˆ¶</li>
<li><strong>æ•°æ®å…±äº«</strong>ï¼šæ”¯æŒè·¨ç³»ç»Ÿçš„æ•°æ®å…±äº«å’Œäº¤æ¢</li>
<li><strong>æ•°æ®ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>ï¼šæ•°æ®çš„åˆ›å»ºã€ä½¿ç”¨ã€å½’æ¡£ã€é”€æ¯å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†</li>
</ul>
<h2 data-id="heading-7">2.1.3 Skillèƒ½åŠ›ç®¡ç†ä¸­å¿ƒ</h2>
<p><strong>æ ¸å¿ƒèŒè´£</strong>ï¼šç»Ÿä¸€ç®¡ç†SKILLçš„æ³¨å†Œã€åˆ†ç±»ã€å‘ç°å’Œè°ƒç”¨ã€‚</p>
<ul>
<li><strong>SKILLæ³¨å†Œ</strong>ï¼šç®¡ç†SKILLçš„æ³¨å†Œå’Œå‘å¸ƒ</li>
<li><strong>èƒ½åŠ›åˆ†ç±»</strong>ï¼šåŸºäºCATï¼ˆCapability And Typeï¼‰çš„SKILLåˆ†ç±»æœºåˆ¶</li>
<li><strong>èƒ½åŠ›å‘ç°</strong>ï¼šæ”¯æŒåŸºäºå¤šç§æ¡ä»¶çš„SKILLå‘ç°</li>
<li><strong>ç‰ˆæœ¬ç®¡ç†</strong>ï¼šSKILLçš„ç‰ˆæœ¬æ§åˆ¶å’Œæ›´æ–°ç®¡ç†</li>
<li><strong>æƒé™æ§åˆ¶</strong>ï¼šåŸºäºRBACçš„SKILLè®¿é—®æƒé™ç®¡ç†</li>
<li><strong>ç›‘æ§ç»Ÿè®¡</strong>ï¼šSKILLçš„ä½¿ç”¨æƒ…å†µç›‘æ§å’Œç»Ÿè®¡åˆ†æ</li>
</ul>
<h2 data-id="heading-8">2.1.4 LLMè°ƒåº¦ä¸­å¿ƒ</h2>
<p><strong>æ ¸å¿ƒèŒè´£</strong>ï¼šç»Ÿä¸€ç®¡ç†LLMèµ„æºï¼Œå®ç°LLMçš„é«˜æ•ˆè°ƒåº¦å’Œç®¡æ§ã€‚</p>
<ul>
<li><strong>LLMèµ„æºç®¡ç†</strong>ï¼šç®¡ç†å¤–éƒ¨LLMå’Œæœ¬åœ°LLMèµ„æº</li>
<li><strong>è°ƒåº¦ç­–ç•¥</strong>ï¼šåŸºäºæ•°æ®æ•æ„Ÿæ€§ã€æˆæœ¬ã€æ€§èƒ½ç­‰å› ç´ çš„æ™ºèƒ½è°ƒåº¦</li>
<li><strong>æˆæœ¬æ§åˆ¶</strong>ï¼šLLMè°ƒç”¨çš„æˆæœ¬è®¡ç®—å’Œé¢„ç®—æ§åˆ¶</li>
<li><strong>é¢‘ç‡é™åˆ¶</strong>ï¼šé˜²æ­¢è¿‡åº¦è°ƒç”¨å¯¼è‡´çš„èµ„æºæµªè´¹</li>
<li><strong>ç»“æœç¼“å­˜</strong>ï¼šç¼“å­˜LLMè°ƒç”¨ç»“æœï¼Œæé«˜å“åº”é€Ÿåº¦</li>
<li><strong>è´¨é‡ç›‘æ§</strong>ï¼šç›‘æ§LLMè¾“å‡ºè´¨é‡ï¼Œå®ç°è‡ªåŠ¨è¿‡æ»¤å’Œå®¡æ ¸</li>
</ul>
<h2 data-id="heading-9">2.1.5 Skillflowè°ƒåº¦ä¸­å¿ƒ</h2>
<p><strong>æ ¸å¿ƒèŒè´£</strong>ï¼šç»Ÿä¸€ç®¡ç†Skillflowçš„å®šä¹‰ã€ç¼–æ’ã€æ‰§è¡Œå’Œç›‘æ§ã€‚</p>
<ul>
<li><strong>Skillflowå®šä¹‰</strong>ï¼šæ”¯æŒå¯è§†åŒ–å’Œä»£ç ä¸¤ç§æ–¹å¼å®šä¹‰Skillflow</li>
<li><strong>å·¥ä½œæµç¼–æ’</strong>ï¼šåŸºäºDAGçš„å·¥ä½œæµå¼•æ“ï¼Œæ”¯æŒå¤æ‚çš„æµç¨‹é€»è¾‘</li>
<li><strong>ä»»åŠ¡è°ƒåº¦</strong>ï¼šæ”¯æŒå®šæ—¶è§¦å‘ã€äº‹ä»¶è§¦å‘ã€æ‰‹åŠ¨è§¦å‘ç­‰å¤šç§æ–¹å¼</li>
<li><strong>æ‰§è¡Œç®¡ç†</strong>ï¼šå·¥ä½œæµçš„æ‰§è¡Œã€æš‚åœã€æ¢å¤ã€ç»ˆæ­¢ç­‰æ“ä½œ</li>
<li><strong>çŠ¶æ€ç›‘æ§</strong>ï¼šå®æ—¶ç›‘æ§å·¥ä½œæµçš„æ‰§è¡ŒçŠ¶æ€å’Œè¿›åº¦</li>
<li><strong>å†å²è®°å½•</strong>ï¼šå®Œæ•´çš„å·¥ä½œæµæ‰§è¡Œå†å²ï¼Œä¾¿äºå®¡è®¡å’Œåˆ†æ</li>
<li><strong>å¼‚å¸¸å¤„ç†</strong>ï¼šå·¥ä½œæµæ‰§è¡Œå¼‚å¸¸çš„è‡ªåŠ¨å¤„ç†å’Œå‘Šè­¦</li>
</ul>
<h2 data-id="heading-10">2.1.6 Agentåä½œå±‚</h2>
<p><strong>æ ¸å¿ƒèŒè´£</strong>ï¼šå®ç°ä¸åŒAgentä¹‹é—´çš„åä½œå’Œé€šä¿¡ï¼Œæ‰§è¡Œå…·ä½“çš„ä¸šåŠ¡æµç¨‹ã€‚</p>
<ul>
<li><strong>MCPAgent</strong>ï¼šæœåŠ¡æµå…¥å£ï¼Œæ¥æ”¶å¤–éƒ¨è¯·æ±‚ï¼Œåè°ƒå…¶ä»–Agent</li>
<li><strong>RouteAgent</strong>ï¼šè´Ÿè´£æ¡¥æ¥å’Œè½¬å‘ï¼Œè¿æ¥MCPAgentå’ŒEndAgent</li>
<li><strong>EndAgent</strong>ï¼šæ‰§è¡Œå…·ä½“ä»»åŠ¡ï¼Œè°ƒç”¨SKILLå®Œæˆä¸šåŠ¡é€»è¾‘</li>
<li><strong>Agentæ³¨å†Œä¸­å¿ƒ</strong>ï¼šç®¡ç†æ‰€æœ‰Agentçš„æ³¨å†Œã€å‘ç°å’ŒçŠ¶æ€</li>
</ul>
<h2 data-id="heading-11">3. MCPAgentåˆ†å‘ç½‘ç»œ</h2>
<p>SuperAgentçš„æ ¸å¿ƒåˆ›æ–°åœ¨äºMCPAgentåˆ†å‘ç½‘ç»œï¼Œå®ƒå…è®¸ä¼ä¸š/ç¬¬ä¸‰æ–¹ç³»ç»Ÿå’Œä¸ªäººç”¨æˆ·å°†è‡ªå·±çš„MCPAgentæ¥å…¥SuperAgentä¼ä¸šæ ¸å¿ƒå±‚ï¼Œå®ç°AIèƒ½åŠ›çš„ç»Ÿä¸€åˆ†å‘å’Œç¼–æ’ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b97e78219ed54dcd8458e97a88c75862~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769250220&amp;x-signature=E8%2Fs8OFzVPO5ns6%2FqmH3n0hPkoo%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-12">4. æ ¸å¿ƒæ¦‚å¿µä¸èƒ½åŠ›</h2>
<h2 data-id="heading-13">4.1 1:n Capabilityå…³ç³»</h2>
<p>SuperAgentæ”¯æŒ1:n Capabilityå…³ç³»ï¼Œä¸€ä¸ªSKILLå¯ä»¥æä¾›å¤šä¸ªèƒ½åŠ›ï¼Œå®ç°AIèƒ½åŠ›çš„æ¨¡å—åŒ–è®¾è®¡ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7833f69af2774effb529ffd442416ada~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769250220&amp;x-signature=NEegbNVcF44%2BcqNcGGSCW%2BN7mIA%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-14">4.2 Skillflowè‡ªåŠ¨åŒ–ç¼–æ’</h2>
<p>é€šè¿‡Skillflowå¯è§†åŒ–å·¥å…·ï¼Œç”¨æˆ·å¯ä»¥è½»æ¾è®¾è®¡ä»ç®€å•åˆ°å¤æ‚çš„å·¥ä½œæµï¼Œç”±Skillflowè°ƒåº¦ä¸­å¿ƒè´Ÿè´£æ‰§è¡Œå’Œç›‘æ§ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cf159204ffc34783b5ae68633791ab6c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769250220&amp;x-signature=bA6I1bB1%2F9jxCqUMIqug%2BveqnRk%3D" alt="è¯·åœ¨æ­¤æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-15">5. ä¼ä¸šæ ¸å¿ƒç»„ä»¶ä½¿ç”¨æŒ‡å—</h2>
<h2 data-id="heading-16">5.1 Authè®¤è¯ä¸­å¿ƒä½¿ç”¨</h2>
<p><strong>ä¸»è¦åŠŸèƒ½</strong>ï¼šç»Ÿä¸€èº«ä»½ç®¡ç†å’Œæƒé™æ§åˆ¶</p>
<ul>
<li><strong>ä¼ä¸šSSOé›†æˆ</strong>ï¼š</li>
</ul>
<ol>
<li>åœ¨Authè®¤è¯ä¸­å¿ƒé…ç½®ä¼ä¸šåŸŸ</li>
<li>é…ç½®ä¼ä¸šç°æœ‰ç³»ç»Ÿçš„SSOå¯¹æ¥</li>
<li>ç”¨æˆ·é€šè¿‡ä¼ä¸šè´¦å·ç™»å½•SuperAgent</li>
<li>å®ç°ä¼ä¸šå†…éƒ¨ç³»ç»Ÿçš„æ— ç¼è®¿é—®</li>
</ol>
<ul>
<li><strong>æƒé™ç®¡ç†</strong>ï¼š</li>
</ul>
<ol>
<li>åˆ›å»ºä¼ä¸šè§’è‰²å’Œæƒé™ç»„</li>
<li>ä¸ºä¸åŒéƒ¨é—¨é…ç½®ä¸åŒæƒé™</li>
<li>å®ç°åŸºäºè§’è‰²çš„SKILLè®¿é—®æ§åˆ¶</li>
<li>ç›‘æ§å’Œå®¡è®¡æƒé™ä½¿ç”¨æƒ…å†µ</li>
</ol>
<h2 data-id="heading-17">5.2 DataServeræ•°æ®ä¸­å¿ƒä½¿ç”¨</h2>
<p><strong>ä¸»è¦åŠŸèƒ½</strong>ï¼šç»Ÿä¸€æ•°æ®å­˜å‚¨å’Œç®¡ç†</p>
<ul>
<li><strong>æ•°æ®é›†æˆ</strong>ï¼š</li>
</ul>
<ol>
<li>é…ç½®æ•°æ®æºè¿æ¥ï¼ˆæ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿã€APIç­‰ï¼‰</li>
<li>è®¾è®¡æ•°æ®ETLæµç¨‹</li>
<li>å®ç°æ•°æ®çš„è‡ªåŠ¨åŒæ­¥å’Œæ›´æ–°</li>
<li>ç¡®ä¿æ•°æ®ä¸€è‡´æ€§å’Œå®Œæ•´æ€§</li>
</ol>
<ul>
<li><strong>æ•°æ®å®‰å…¨</strong>ï¼š</li>
</ul>
<ol>
<li>é…ç½®æ•°æ®åŠ å¯†ç­–ç•¥</li>
<li>å®ç°æ•°æ®è„±æ•è§„åˆ™</li>
<li>é…ç½®æ•°æ®è®¿é—®æƒé™</li>
<li>ç›‘æ§æ•°æ®è®¿é—®æ—¥å¿—</li>
</ol>
<h2 data-id="heading-18">5.3 Skillèƒ½åŠ›ç®¡ç†ä¸­å¿ƒä½¿ç”¨</h2>
<p><strong>ä¸»è¦åŠŸèƒ½</strong>ï¼šSKILLæ³¨å†Œã€ç®¡ç†å’Œå‘ç°</p>
<ul>
<li><strong>SKILLæ³¨å†Œ</strong>ï¼š</li>
</ul>
<ol>
<li>å¼€å‘SKILLå¹¶é€šè¿‡AIServerè®¤è¯</li>
<li>åœ¨Skillèƒ½åŠ›ç®¡ç†ä¸­å¿ƒæ³¨å†ŒSKILL</li>
<li>é…ç½®SKILLçš„CATåˆ†ç±»å’Œæƒé™</li>
<li>å‘å¸ƒSKILLåˆ°ä¼ä¸šSKILLåº“</li>
</ol>
<ul>
<li><strong>SKILLç®¡ç†</strong>ï¼š</li>
</ul>
<ol>
<li>ç›‘æ§SKILLçš„ä½¿ç”¨æƒ…å†µ</li>
<li>ç®¡ç†SKILLçš„ç‰ˆæœ¬æ›´æ–°</li>
<li>é…ç½®SKILLçš„è®¿é—®æƒé™</li>
<li>ç»Ÿè®¡SKILLçš„æ€§èƒ½æŒ‡æ ‡</li>
</ol>
<h2 data-id="heading-19">5.4 LLMè°ƒåº¦ä¸­å¿ƒä½¿ç”¨</h2>
<p><strong>ä¸»è¦åŠŸèƒ½</strong>ï¼šLLMèµ„æºç®¡ç†å’Œè°ƒåº¦</p>
<ul>
<li><strong>LLMèµ„æºé…ç½®</strong>ï¼š</li>
</ul>
<ol>
<li>é…ç½®å¤–éƒ¨LLM APIï¼ˆå¦‚OpenAIã€é˜¿é‡Œäº‘AIç­‰ï¼‰</li>
<li>é…ç½®æœ¬åœ°LLMèµ„æºï¼ˆå¦‚å¼€æºæ¨¡å‹éƒ¨ç½²ï¼‰</li>
<li>è®¾ç½®LLMè°ƒç”¨çš„æˆæœ¬é¢„ç®—</li>
<li>é…ç½®LLMè°ƒç”¨çš„é¢‘ç‡é™åˆ¶</li>
</ol>
<ul>
<li><strong>LLMè°ƒåº¦ç­–ç•¥</strong>ï¼š</li>
</ul>
<ol>
<li>åŸºäºæ•°æ®æ•æ„Ÿæ€§é€‰æ‹©LLMï¼ˆå¤–éƒ¨/æœ¬åœ°ï¼‰</li>
<li>é…ç½®LLMè°ƒç”¨çš„è´Ÿè½½å‡è¡¡</li>
<li>å®ç°LLMç»“æœçš„è‡ªåŠ¨è¿‡æ»¤</li>
<li>ç›‘æ§LLMè°ƒç”¨çš„è´¨é‡å’Œæˆæœ¬</li>
</ol>
<h2 data-id="heading-20">5.5 Skillflowè°ƒåº¦ä¸­å¿ƒä½¿ç”¨</h2>
<p><strong>ä¸»è¦åŠŸèƒ½</strong>ï¼šSkillflowå®šä¹‰ã€ç¼–æ’å’Œæ‰§è¡Œ</p>
<ul>
<li><strong>Skillflowè®¾è®¡</strong>ï¼š</li>
</ul>
<ol>
<li>ä½¿ç”¨å¯è§†åŒ–å·¥å…·è®¾è®¡Skillflow</li>
<li>é…ç½®è§¦å‘æ¡ä»¶å’Œæ‰§è¡Œé€»è¾‘</li>
<li>é€‰æ‹©æ‰€éœ€çš„SKILLå’ŒAgent</li>
<li>è®¾ç½®é”™è¯¯å¤„ç†å’Œé‡è¯•ç­–ç•¥</li>
</ol>
<ul>
<li><strong>Skillflowç®¡ç†</strong>ï¼š</li>
</ul>
<ol>
<li>ç®¡ç†Skillflowçš„ç‰ˆæœ¬</li>
<li>ç›‘æ§Skillflowçš„æ‰§è¡ŒçŠ¶æ€</li>
<li>æ‰‹åŠ¨æ§åˆ¶Skillflowçš„æ‰§è¡Œ</li>
<li>åˆ†æSkillflowçš„æ‰§è¡Œæ•ˆç‡</li>
<li>é…ç½®Skillflowçš„é€šçŸ¥è§„åˆ™</li>
</ol>
<ul>
<li><strong>Skillflowæ‰§è¡Œ</strong>ï¼š</li>
</ul>
<ol>
<li>è‡ªåŠ¨è§¦å‘æˆ–æ‰‹åŠ¨å¯åŠ¨Skillflow</li>
<li>å®æ—¶ç›‘æ§æ‰§è¡Œè¿›åº¦</li>
<li>å¤„ç†æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å¼‚å¸¸</li>
<li>ç”Ÿæˆæ‰§è¡ŒæŠ¥å‘Šå’Œæ—¥å¿—</li>
</ol>
<h2 data-id="heading-21">6. å…¸å‹åº”ç”¨åœºæ™¯</h2>
<h2 data-id="heading-22">6.1 ä¼ä¸šåœºæ™¯ï¼šè·¨ç³»ç»ŸAIèƒ½åŠ›åä½œ</h2>
<h2 data-id="heading-23">åœºæ™¯æè¿°</h2>
<p>ä¼ä¸šç”¨æˆ·é€šè¿‡Skillflowæ•´åˆOAç³»ç»Ÿçš„æ–‡æ¡£å¤„ç†AIã€CRMç³»ç»Ÿçš„å®¢æˆ·åˆ†æAIå’ŒERPç³»ç»Ÿçš„æ•°æ®åˆ†æAIï¼Œå®ç°è‡ªåŠ¨åŒ–çš„å®¢æˆ·æŠ¥å‘Šç”Ÿæˆæµç¨‹ã€‚</p>
<h2 data-id="heading-24">ä½¿ç”¨æµç¨‹</h2>
<ol>
<li><strong>Authè®¤è¯</strong>ï¼šç”¨æˆ·é€šè¿‡ä¼ä¸šSSOç™»å½•SuperAgent</li>
<li><strong>MCPAgentæ¥å…¥</strong>ï¼šä¼ä¸šITéƒ¨é—¨å°†OAã€CRMã€ERPç³»ç»Ÿçš„MCPAgentæ¥å…¥ä¼ä¸šæ ¸å¿ƒå±‚</li>
<li><strong>SKILLæ³¨å†Œ</strong>ï¼šåœ¨Skillèƒ½åŠ›ç®¡ç†ä¸­å¿ƒæ³¨å†Œå„ç³»ç»Ÿçš„AIèƒ½åŠ›</li>
<li><strong>LLMé…ç½®</strong>ï¼šåœ¨LLMè°ƒåº¦ä¸­å¿ƒé…ç½®æ‰€éœ€çš„LLMèµ„æº</li>
<li><strong>Skillflowè®¾è®¡</strong>ï¼šä¸šåŠ¡ç”¨æˆ·ä½¿ç”¨Skillflowç¼–è¾‘å™¨è®¾è®¡"å®¢æˆ·æŠ¥å‘Šè‡ªåŠ¨ç”Ÿæˆ"å·¥ä½œæµï¼š</li>
</ol>
<ul>
<li>è§¦å‘æ¡ä»¶ï¼šCRMç³»ç»Ÿä¸­å®¢æˆ·çŠ¶æ€å˜æ›´</li>
<li>æ‰§è¡Œæ­¥éª¤ï¼š a. è°ƒç”¨OA AIç”Ÿæˆå®¢æˆ·ç›¸å…³æ–‡æ¡£æ‘˜è¦ b. è°ƒç”¨CRM AIåˆ†æå®¢æˆ·è¡Œä¸ºæ•°æ® c. è°ƒç”¨ERP AIç”Ÿæˆå®¢æˆ·äº¤æ˜“æŠ¥å‘Š d. è°ƒç”¨LLMè°ƒåº¦ä¸­å¿ƒç”Ÿæˆå®Œæ•´å®¢æˆ·æŠ¥å‘Š e. è‡ªåŠ¨å‘é€ç»™ç›¸å…³äººå‘˜</li>
</ul>
<ol>
<li><strong>Skillflowæ‰§è¡Œ</strong>ï¼šSkillflowè°ƒåº¦ä¸­å¿ƒè´Ÿè´£æ‰§è¡Œå’Œç›‘æ§å·¥ä½œæµ</li>
<li><strong>æ•°æ®å­˜å‚¨</strong>ï¼šæ‰€æœ‰æ•°æ®å’Œæ‰§è¡Œç»“æœå­˜å‚¨åˆ°DataServer</li>
<li><strong>ç›‘æ§å®¡è®¡</strong>ï¼šé€šè¿‡ç›‘æ§ç³»ç»ŸæŸ¥çœ‹å·¥ä½œæµæ‰§è¡ŒçŠ¶æ€å’Œå®¡è®¡æ—¥å¿—</li>
</ol>
<h2 data-id="heading-25">6.2 ä¸ªäººåœºæ™¯ï¼šä¸ªäººAIå·¥å…·æ•´åˆ</h2>
<h2 data-id="heading-26">åœºæ™¯æè¿°</h2>
<p>ä¸ªäººç”¨æˆ·é€šè¿‡ä¸ªäººMCPAgentæ•´åˆå¸¸ç”¨AIå·¥å…·ï¼Œå®ç°è‡ªåŠ¨åŒ–çš„å·¥ä½œææ•ˆæµç¨‹ã€‚</p>
<h2 data-id="heading-27">ä½¿ç”¨æµç¨‹</h2>
<ol>
<li><strong>Authè®¤è¯</strong>ï¼šä¸ªäººç”¨æˆ·æ³¨å†Œå¹¶ç™»å½•SuperAgent</li>
<li><strong>MCPAgentåˆå§‹åŒ–</strong>ï¼šåˆ›å»ºä¸ªäººMCPAgent</li>
<li><strong>SKILLé›†æˆ</strong>ï¼šåœ¨Skillèƒ½åŠ›ç®¡ç†ä¸­å¿ƒå‘ç°å¹¶æ·»åŠ æ‰€éœ€çš„ä¸ªäººAIå·¥å…·</li>
<li><strong>LLMé…ç½®</strong>ï¼šåœ¨LLMè°ƒåº¦ä¸­å¿ƒé…ç½®ä¸ªäººLLMèµ„æº</li>
<li><strong>Skillflowè®¾è®¡</strong>ï¼šåˆ›å»º"ä¼šè®®åŠ©æ‰‹"å·¥ä½œæµï¼š</li>
</ol>
<ul>
<li>è§¦å‘æ¡ä»¶ï¼šæ—¥å†ä¼šè®®ç»“æŸ</li>
<li>æ‰§è¡Œæ­¥éª¤ï¼š a. è°ƒç”¨ä¼šè®®å½•éŸ³AIè½¬å†™ä¼šè®®å†…å®¹ b. è°ƒç”¨LLMç”Ÿæˆä¼šè®®æ‘˜è¦å’Œè¡ŒåŠ¨é¡¹ c. è‡ªåŠ¨æ›´æ–°ç¬”è®°ç³»ç»Ÿ d. å°†è¡ŒåŠ¨é¡¹æ·»åŠ åˆ°æ—¥å† e. å‘é€é‚®ä»¶é€šçŸ¥ç›¸å…³äººå‘˜</li>
</ul>
<ol>
<li><strong>Skillflowæ‰§è¡Œ</strong>ï¼šSkillflowè°ƒåº¦ä¸­å¿ƒè´Ÿè´£æ‰§è¡Œå’Œç›‘æ§å·¥ä½œæµ</li>
<li><strong>æ‰§è¡Œä¸ç›‘æ§</strong>ï¼šç”¨æˆ·é€šè¿‡æ§åˆ¶å°ç›‘æ§æ‰§è¡ŒçŠ¶æ€</li>
</ol>
<h2 data-id="heading-28">7. OODERå¼€æºåè®®ç›®å½•</h2>
<h2 data-id="heading-29">7.1 ç¬¬ä¸‰æ–¹ç³»ç»ŸMCPAgentæ¥å…¥æ–‡æ¡£</h2>
<ul>
<li><strong>æ–‡æ¡£ç®€ä»‹</strong>ï¼šæŒ‡å¯¼ç¬¬ä¸‰æ–¹ç³»ç»Ÿå¦‚ä½•å°†è‡ªå·±çš„MCPAgentæ¥å…¥SuperAgentä¼ä¸šæ ¸å¿ƒå±‚ï¼Œå®ç°AIèƒ½åŠ›çš„åˆ†å‘å’Œè°ƒç”¨</li>
<li><strong>æ¥å…¥æµç¨‹</strong>ï¼šæ³¨å†Œå‡­è¯è·å– â†’ ç½‘ç»œé…ç½® â†’ MCPAgentéƒ¨ç½² â†’ ç³»ç»Ÿæ¥å…¥ â†’ æµ‹è¯•éªŒè¯ â†’ ä¸Šçº¿è¿è¡Œ</li>
<li><strong>å…³é”®ç‰¹æ€§</strong>ï¼šæ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼ã€æä¾›å®Œæ•´çš„APIæ–‡æ¡£ã€æ”¯æŒç‰ˆæœ¬ç®¡ç†ã€æä¾›SDKæ”¯æŒ</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šä¼ä¸šç³»ç»ŸAIèƒ½åŠ›å¤–éƒ¨åˆ†å‘ã€ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆã€è‡ªå®šä¹‰AIèƒ½åŠ›å¼€æ”¾</li>
</ul>
<h2 data-id="heading-30">7.2 Skillè®¾è®¡è§„èŒƒ</h2>
<ul>
<li><strong>Skillå¼€æ”¾èƒ½åŠ›è®¾è®¡</strong>ï¼š</li>
<li>æ”¯æŒ1:n Capabilityå…³ç³»</li>
<li>é™æ€å®šä¹‰åŸåˆ™ï¼Œå¼€å‘å®Œæˆåä¸å¯ä¿®æ”¹</li>
<li>ç»Ÿä¸€çš„æ¥å£è§„èŒƒï¼Œæ”¯æŒRESTful APIå’ŒgRPC</li>
<li>å®Œæ•´çš„æƒé™æ§åˆ¶æœºåˆ¶</li>
<li><strong>LLMè°ƒç”¨è§„èŒƒ</strong>ï¼š</li>
<li>æ”¯æŒå¤–éƒ¨LLMå’Œæœ¬åœ°LLMè°ƒç”¨</li>
<li>ç»Ÿä¸€çš„LLMè°ƒç”¨æ¥å£ï¼Œå°è£…ä¸åŒLLMçš„å·®å¼‚</li>
<li>æ”¯æŒåŸºäºæ•°æ®æ•æ„Ÿæ€§çš„LLMé€‰æ‹©ç­–ç•¥</li>
<li>å®ç°LLMè°ƒç”¨çš„æˆæœ¬æ§åˆ¶å’Œé¢‘ç‡é™åˆ¶</li>
<li>æ”¯æŒLLMç»“æœçš„è¿‡æ»¤å’Œå®¡æ ¸</li>
</ul>
<h2 data-id="heading-31">7.3 Agentæ¥å…¥è§„èŒƒ</h2>
<ul>
<li><strong>å†…éƒ¨Agenté€šè®¯åè®®</strong>ï¼š</li>
<li>åŸºäºgRPCçš„é«˜æ•ˆäºŒè¿›åˆ¶é€šä¿¡</li>
<li>æ”¯æŒTLS/SSLåŠ å¯†</li>
<li>å†…ç½®å¿ƒè·³æœºåˆ¶å’Œæ–­çº¿é‡è¿</li>
<li>ç»Ÿä¸€çš„æ¶ˆæ¯æ ¼å¼å’Œåºåˆ—åŒ–æœºåˆ¶</li>
<li><strong>Agentè§’è‰²</strong>ï¼š</li>
<li><strong>MCPAgent</strong>ï¼šæœåŠ¡æµå…¥å£ï¼Œç®¡ç†å’Œåè°ƒå…¶ä»–Agent</li>
<li><strong>RouteAgent</strong>ï¼šæ¡¥æ¥è½¬å‘ï¼Œè¿æ¥MCPAgentå’ŒEndAgent</li>
<li><strong>EndAgent</strong>ï¼šåŠŸèƒ½æ‰§è¡Œï¼Œè°ƒç”¨SKILLå®Œæˆå…·ä½“ä»»åŠ¡</li>
<li><strong>Agentæ¥å…¥æµç¨‹</strong>ï¼š</li>
<li>è‡ªåŠ¨å‘ç°MCPAgentæœåŠ¡</li>
<li>åŠ¨æ€åˆ†é…RouteAgent</li>
<li>è‡ªåŠ¨æ³¨å†ŒCapabilityä¿¡æ¯</li>
<li>æ”¯æŒæ‰¹é‡å…¥ç½‘</li>
</ul>
<h2 data-id="heading-32">7.4 Skillflowè®¾è®¡è§„èŒƒ</h2>
<ul>
<li><strong>Skillflowå®šä¹‰</strong>ï¼š</li>
<li>åŸºäºDAGçš„å·¥ä½œæµå®šä¹‰</li>
<li>æ”¯æŒå¤šç§è§¦å‘æ¡ä»¶</li>
<li>çµæ´»çš„æ‰§è¡Œé€»è¾‘ï¼ˆé¡ºåºã€å¹¶è¡Œã€æ¡ä»¶åˆ†æ”¯ã€å¾ªç¯ï¼‰</li>
<li>å®Œæ•´çš„é”™è¯¯å¤„ç†æœºåˆ¶</li>
<li><strong>Skillflowæ‰§è¡Œ</strong>ï¼š</li>
<li>æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥æ‰§è¡Œ</li>
<li>æ”¯æŒæ–­ç‚¹ç»­ä¼ </li>
<li>å®æ—¶çŠ¶æ€ç›‘æ§</li>
<li>å®Œæ•´çš„æ‰§è¡Œæ—¥å¿—</li>
</ul>
<h2 data-id="heading-33">8. åŠ å…¥OODERå¼€æºç¤¾åŒº</h2>
<p>ooder SuperAgenté¡¹ç›®é‡‡ç”¨<strong>MITå¼€æºåè®®</strong>ï¼Œæ¬¢è¿ä¼ä¸šå’Œä¸ªäººè‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘ã€‚æˆ‘ä»¬æ¬¢è¿ç¤¾åŒºçš„å‚ä¸å’Œè´¡çŒ®ï¼Œå…±åŒæ„å»ºä¸€ä¸ªå¼ºå¤§çš„AIèƒ½åŠ›åˆ†å‘ç”Ÿæ€ã€‚</p>
<h2 data-id="heading-34">å¼€æºèµ„æº</h2>
<ul>
<li><strong>æ ¸å¿ƒæ–‡æ¡£</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2FooderCN%2Fsuper-agent.git" target="_blank" title="https://gitee.com/ooderCN/super-agent.git" ref="nofollow noopener noreferrer">gitee.com/ooderCN/supâ€¦</a></li>
</ul>
<h2 data-id="heading-35">å¼€å‘æ”¯æŒ</h2>
<ul>
<li>åŒ…å«å®Œæ•´çš„SKILLå¼€å‘ç¤ºä¾‹</li>
<li>æä¾›SKILLå¼€å‘å’Œè°ƒè¯•å·¥å…·</li>
</ul>
<h2 data-id="heading-36">å…³æ³¨OODERå…¬ä¼—å·</h2>
<p><strong>OODERå¼€æº</strong>å…¬ä¼—å·æ˜¯SuperAgenté¡¹ç›®çš„å”¯ä¸€é¦–å‘æ¸ é“ï¼Œæˆ‘ä»¬å°†åœ¨å…¬ä¼—å·ä¸Šå‘å¸ƒï¼š</p>
<ul>
<li>é¡¹ç›®æœ€æ–°è¿›å±•å’Œç‰ˆæœ¬æ›´æ–°</li>
<li>è¯¦ç»†çš„æŠ€æœ¯æ–‡æ¡£å’Œæ•™ç¨‹</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[taroé¡¹ç›®è¸©å‘æŒ‡å—â€”â€”ï¼ˆä¸€ï¼‰]]></title>    <link>https://juejin.cn/post/7595994039108501540</link>    <guid>https://juejin.cn/post/7595994039108501540</guid>    <pubDate>2026-01-17T10:27:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595994039108501540" data-draft-id="7594627998852300806" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="taroé¡¹ç›®è¸©å‘æŒ‡å—â€”â€”ï¼ˆä¸€ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-17T10:27:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Snack"/> <meta itemprop="url" content="https://juejin.cn/user/3423212600562768"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            taroé¡¹ç›®è¸©å‘æŒ‡å—â€”â€”ï¼ˆä¸€ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3423212600562768/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Snack
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T10:27:29.000Z" title="Sat Jan 17 2026 10:27:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">è‡ªå®šä¹‰å¯¼èˆªæ </h3>
<p>åœ¨å¼€å‘å°ç¨‹åºçš„æ—¶å€™æ²¡æœ‰ä½¿ç”¨å¼€å‘è€…å·¥å…·ï¼Œç”¨çš„H5ã€‚æƒ³è¦æœ‰ä¸€ä¸ªè‡ªå®šä¹‰çš„åº•éƒ¨å¯¼èˆªæ ï¼Œæ‰€ä»¥å°±å°è¯•äº†ä¸€ä¸‹taroä¸­çš„è‡ªå®šä¹‰å¯¼èˆªæ ã€‚ç»“æœé…ç½®ä¹‹åï¼Œç›´æ¥è®©é¡µé¢æ˜¾ç¤ºä¸å‡ºæ¥å†…å®¹äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef5992b6d6214917bca96f68a469b5e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU25hY2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769250448&amp;x-signature=LDLTKggX6uh15gFKSHBcVaFz2lM%3D" alt="image.png" loading="lazy"/></p>
<p>éšåæŸ¥è¯¢å®˜ç½‘åï¼Œè‡ªå®šä¹‰å¯¼èˆªæ å¥½åƒåªæ”¯æŒå¾®ä¿¡å°ç¨‹åºçš„ã€‚H5çš„åº”è¯¥æ˜¯æ²¡æœ‰çš„ï¼ŒæŠŠè¿™æ®µä»£ç åˆ æ‰ä¹‹åå°±å¯ä»¥æ­£å¸¸æ˜¾ç¤ºäº†ã€‚å¥½çƒ¦ï¼ï¼ï¼</p>
<p>åœ¨è‡ªå®šä¹‰å¯¼èˆªæ æ—¶ï¼Œåº”è¯¥ç”±å¯¼èˆªæ ç»„ä»¶è‡ªè¡Œæ§åˆ¶é¡µé¢çš„å˜æ›´å’Œå¯¼èˆªæ çš„çŠ¶æ€å˜åŒ–ã€‚åœ¨<code>taro</code>ä¸­ä½¿ç”¨<code>useDidShow</code>è¿™ä¸ªç”Ÿå‘½å‘¨æœŸ<code>Hook</code>ï¼Œé€šè¿‡é¡µé¢æ˜¾ç¤ºï¼Œåˆ¤æ–­å½“å‰è·¯ç”±ï¼Œå¹¶æ ¹æ®å½“å‰è·¯ç”±è®¾ç½®<code>activeTab</code>ã€‚åœ¨ç‚¹å‡»å¯¼èˆªæ è·³è½¬é¡µé¢æ—¶ï¼Œä½¿ç”¨<code>redirectTo</code>è¿›è¡Œè·³è½¬ã€‚</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript">  <span class="hljs-title function_">useDidShow</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> pages = <span class="hljs-title class_">Taro</span>.<span class="hljs-title function_">getCurrentPages</span>();
    <span class="hljs-keyword">const</span> current = pages[pages.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>];
    <span class="hljs-keyword">const</span> route = current.<span class="hljs-property">route</span>;
    <span class="hljs-keyword">const</span> matched = tabList.<span class="hljs-title function_">find</span>(<span class="hljs-function">(<span class="hljs-params">tab</span>) =&gt;</span> tab.<span class="hljs-property">pagePath</span> === route);
    <span class="hljs-keyword">if</span> (matched) {
      <span class="hljs-title function_">setActiveTab</span>(matched.<span class="hljs-property">id</span>);
    }
  });

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">switchTab</span> = (<span class="hljs-params">tab</span>) =&gt; {
    <span class="hljs-keyword">if</span> (activeTab !== tab.<span class="hljs-property">id</span>) {
      <span class="hljs-title class_">Taro</span>.<span class="hljs-title function_">redirectTo</span>({ <span class="hljs-attr">url</span>: tab.<span class="hljs-property">pagePath</span> });
    }
  };
</code></pre>
<h3 data-id="heading-1">é¡µé¢æŠ¥é”™æˆ–è€…æ— æ¸²æŸ“</h3>
<p>é¡µé¢æŠ¥é”™ç±»å‹</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c230b01d0c2746ac9ac872e99ba39d5b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU25hY2s=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769250448&amp;x-signature=5aHlBwPVSud2259ckN5Qik8QNRY%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™é€šå¸¸æ˜¯å› ä¸ºTaroæ— æ³•è¯†åˆ«åˆ°æ­£ç¡®çš„é¡µé¢ç»„ä»¶ã€‚å½“ä½¿ç”¨reactè¿›è¡Œå¼€å‘æ—¶ï¼Œæˆä¸ºé¡µé¢çš„é‚£ä¸ªç»„ä»¶éœ€è¦é»˜è®¤å¯¼å‡º
<code>export default functoin Index(){return &lt;&gt;&lt;/&gt;}</code>å¹¶ä¸”è¦åœ¨<code>app.config.ts</code>ä¸­é…ç½®æ­£ç¡®çš„è·¯ç”±ä¿¡æ¯ã€‚</p>
<p>å¦‚æœå‡ºç°é¡µé¢ç™½å±æ²¡æœ‰èŠ‚ç‚¹æ¸²æŸ“å¹¶ä¸”æ§åˆ¶å°æ²¡æœ‰å‡ºç°æŠ¥é”™çš„æƒ…å†µï¼Œè¿™å¯èƒ½æ˜¯å› ä¸ºç»„ä»¶éœ€è¦æ¥æ”¶çš„å¤–éƒ¨ç»„ä»¶ä¼ æ¥çš„æ•°æ®ä¸ºç©ºæˆ–è€…æ˜¯å±æ€§ä¸åŒ¹é…å¯¼è‡´çš„ã€‚åœ¨ä½¿ç”¨çš„æ—¶å€™éœ€è¦æ³¨æ„ç»„ä»¶ä¸­çš„æ•°æ®å®‰å…¨å…œåº•ï¼Œè¿›è¡Œåˆ¤ç©ºã€‚</p>
<pre><code class="hljs language-react" lang="react">// å¦‚æœå¤–éƒ¨ç»„ä»¶æ²¡æœ‰ä¼ å…¥postï¼Œé‚£ä¹ˆå°±ä¸ä¼šæ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚ï¼ˆè¿™æ˜¯ä¸€ä¸ªåµŒå…¥åˆ°é¡µé¢ä¸­çš„ç»„ä»¶ï¼‰
export function Index(post){
    return (
        &lt;div&gt;{post.msg}&lt;/div&gt;
    )
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨ Cherry Markdown æ‰“é€ ä¸æ»‘çš„ AI å¯¹è¯ä½“éªŒï¼šæµå¼æ¸²æŸ“å®Œå…¨æŒ‡å—]]></title>    <link>https://juejin.cn/post/7595847940621697074</link>    <guid>https://juejin.cn/post/7595847940621697074</guid>    <pubDate>2026-01-17T08:46:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595847940621697074" data-draft-id="7595842144906805298" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨ Cherry Markdown æ‰“é€ ä¸æ»‘çš„ AI å¯¹è¯ä½“éªŒï¼šæµå¼æ¸²æŸ“å®Œå…¨æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-17T08:46:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°æ—¶å‰ç«¯"/> <meta itemprop="url" content="https://juejin.cn/user/1197805741808339"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨ Cherry Markdown æ‰“é€ ä¸æ»‘çš„ AI å¯¹è¯ä½“éªŒï¼šæµå¼æ¸²æŸ“å®Œå…¨æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1197805741808339/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°æ—¶å‰ç«¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T08:46:35.000Z" title="Sat Jan 17 2026 08:46:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">ä¸€ã€å¼•è¨€ï¼šAI å¯¹è¯æ—¶ä»£çš„ Markdown æ¸²æŸ“ç—›ç‚¹</h2>
<h3 data-id="heading-1">1.1 ChatGPT ä»¬çš„"æ‰“å­—æœºæ•ˆæœ"æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</h3>
<p>å½“ä½ ä¸ ChatGPTã€Claude æˆ–æ–‡å¿ƒä¸€è¨€å¯¹è¯æ—¶ï¼Œæ˜¯å¦æ³¨æ„åˆ° AI çš„å›å¤ä¼šåƒçœŸäººæ‰“å­—ä¸€æ ·ï¼Œä¸€ä¸ªå­—ä¸€ä¸ªå­—åœ°"æµ"å‡ºæ¥ï¼Ÿè¿™ç§æµç•…çš„ä½“éªŒèƒŒåï¼Œéšè—ç€ä¸€ä¸ªæŠ€æœ¯éš¾é¢˜ï¼š<strong>å¦‚ä½•åœ¨æµå¼è¾“å‡ºè¿‡ç¨‹ä¸­ï¼Œå®æ—¶æ¸²æŸ“ Markdown æ ¼å¼ï¼Œè€Œä¸éœ²å‡ºä¸‘é™‹çš„æºç ï¼Ÿ</strong></p>
<p>ä¼ ç»Ÿçš„ Markdown æ¸²æŸ“å™¨åœ¨æµå¼åœºæ™¯ä¸‹å¾€å¾€ä¼š"ç¿»è½¦"ï¼š</p>
<ul>
<li>ä»£ç å—å†™åˆ°ä¸€åŠï¼Œç”¨æˆ·çœ‹åˆ°çš„æ˜¯ <code>\</code>``python\ndef hello(` è¿™æ ·çš„æºç </li>
<li>è¡¨æ ¼åªè¾“å‡ºäº†ç¬¬ä¸€è¡Œï¼Œé¡µé¢æ˜¾ç¤ºçš„æ˜¯ <code>| åˆ—1 | åˆ—2 |</code> è¿™æ ·çš„åŸå§‹è¯­æ³•</li>
<li>æ•°å­¦å…¬å¼è¿˜æ²¡å†™å®Œï¼Œå±å¹•ä¸Šå‡ºç° <code>$E = mc^</code> è¿™æ ·çš„åŠæˆå“</li>
</ul>
<h3 data-id="heading-2">1.2 ä¼ ç»Ÿ Markdown æ¸²æŸ“å™¨çš„"ç¿»è½¦ç°åœº"</h3>
<p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå…¸å‹çš„ç¿»è½¦æ¡ˆä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ ä¼ ç»Ÿæ–¹å¼ï¼šç›´æ¥æ¸²æŸ“ä¸å®Œæ•´çš„ Markdown</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">streamOutput</span>(<span class="hljs-params">text</span>) {
  <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
  <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> partial = text.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, index++);
    <span class="hljs-title function_">renderMarkdown</span>(partial);  <span class="hljs-comment">// é—®é¢˜ï¼šä¸å®Œæ•´çš„è¯­æ³•ä¼šæ˜¾ç¤ºæºç </span>
  }, <span class="hljs-number">30</span>);
}

<span class="hljs-comment">// å½“è¾“å‡ºåˆ° "```python\ndef" æ—¶ï¼Œé¡µé¢æ˜¾ç¤ºï¼š</span>
<span class="hljs-comment">// ```python</span>
<span class="hljs-comment">// def</span>
<span class="hljs-comment">// è€Œä¸æ˜¯æ¸²æŸ“åçš„ä»£ç å—æ ·å¼</span>
</code></pre>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¾ˆå¤š AI å¯¹è¯äº§å“è¦ä¹ˆï¼š</p>
<ul>
<li>ç­‰ AI å…¨éƒ¨è¾“å‡ºå®Œå†ä¸€æ¬¡æ€§æ¸²æŸ“ï¼ˆå¤±å»äº†æµå¼ä½“éªŒï¼‰</li>
<li>æˆ–è€…å¹²è„†ä¸æ”¯æŒ Markdownï¼Œåªç”¨çº¯æ–‡æœ¬ï¼ˆåŠŸèƒ½å—é™ï¼‰</li>
</ul>
<h3 data-id="heading-3">1.3 Cherry Markdown çš„è§£å†³æ–¹æ¡ˆï¼šæ™ºèƒ½è‡ªåŠ¨è¡¥å…¨</h3>
<p><strong>Cherry Markdown</strong>ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTencent%2Fcherry-markdown" target="_blank" title="https://github.com/Tencent/cherry-markdown" ref="nofollow noopener noreferrer">GitHub é¡¹ç›®åœ°å€</a>ï¼‰æ˜¯ä¸€æ¬¾ç”±è…¾è®¯å¼€æºçš„ JavaScript Markdown ç¼–è¾‘å™¨ï¼Œå®ƒå°±åƒä¸€ä½è´´å¿ƒçš„"è¯­æ³•åŠ©æ‰‹"ï¼Œä¸“é—¨ä¸º AI æµå¼è¾“å‡ºåœºæ™¯è®¾è®¡äº†æ™ºèƒ½è¡¥å…¨æœºåˆ¶ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œå½“ AI æ­£åœ¨é€å­—è¾“å‡ºä»£ç å—æ—¶ï¼ŒCherry Markdown ä¼š"èªæ˜åœ°"è¯†åˆ«å‡ºè¿™æ˜¯ä¸€ä¸ªæœªå®Œæˆçš„ä»£ç å—ï¼Œç„¶åè‡ªåŠ¨å¸®ä½ è¡¥å…¨é—­åˆæ ‡è®°ã€‚è¿™æ ·ï¼Œç”¨æˆ·çœ‹åˆ°çš„æ°¸è¿œæ˜¯æ¸²æŸ“åçš„æ¼‚äº®ä»£ç æ ·å¼ï¼Œè€Œä¸æ˜¯å°´å°¬çš„ <code>\</code>``python\ndef` è¿™æ ·çš„æºç ç‰‡æ®µã€‚</p>
<p>Cherry Markdown ä¼šè‡ªåŠ¨è¯†åˆ«æœªé—­åˆçš„ Markdown è¯­æ³•ï¼Œå¹¶ä¸´æ—¶è¡¥å…¨ï¼Œç¡®ä¿åœ¨æµå¼è¾“å‡ºè¿‡ç¨‹ä¸­å§‹ç»ˆæ˜¾ç¤ºæ¸²æŸ“åçš„æ•ˆæœï¼Œè€Œä¸æ˜¯æºç ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒè®© AI çš„"æ‰“å­—æœºæ•ˆæœ"å˜å¾—ä¸“ä¸šåˆä¼˜é›…ï¼âœ¨</p>
<p>å¼€å¯æµå¼æ¸²æŸ“åï¼ŒCherry ä¼šå¯¹ä»¥ä¸‹ 12 ç§è¯­æ³•è¿›è¡Œè‡ªåŠ¨è¡¥å…¨ï¼š</p>
<ul>
<li>âœ… æ ‡é¢˜ï¼ˆ<code># H1</code>ã€<code>## H2</code> ç­‰ï¼‰</li>
<li>âœ… åŠ ç²—ã€æ–œä½“ï¼ˆ<code>**ç²—ä½“**</code>ã€<code>*æ–œä½“*</code>ï¼‰</li>
<li>âœ… è¶…é“¾æ¥ï¼ˆ<code>[æ–‡æœ¬](url)</code>ï¼‰</li>
<li>âœ… å›¾ç‰‡ã€éŸ³è§†é¢‘ï¼ˆ<code>![alt](url)</code>ï¼‰</li>
<li>âœ… è¡Œå†…ä»£ç å—ï¼ˆ<code>`code`</code>ï¼‰</li>
<li>âœ… æ®µè½ä»£ç å—ï¼ˆ<code>```code```</code>ï¼‰</li>
<li>âœ… è¡Œå†…å…¬å¼ï¼ˆ<code>$formula$</code>ï¼‰</li>
<li>âœ… æ®µè½å…¬å¼ï¼ˆ<code>$$formula$$</code>ï¼‰</li>
<li>âœ… æ— åºåˆ—è¡¨ï¼ˆ<code>- item</code>ï¼‰</li>
<li>âœ… è¡¨æ ¼ï¼ˆ<code>| col1 | col2 |</code>ï¼‰</li>
<li>âœ… mermaid ç”»å›¾ï¼ˆ<code>```mermaid ```</code>ï¼‰</li>
<li>âœ… è„šæ³¨ï¼ˆ<code>[^1]</code>ï¼‰</li>
</ul>
<h2 data-id="heading-4">äºŒã€å¿«é€Ÿä¸Šæ‰‹ï¼š5 åˆ†é’Ÿæ­å»º AI å¯¹è¯ç•Œé¢</h2>
<h3 data-id="heading-5">2.1 æœ€å°å¯ç”¨ä»£ç </h3>
<p>è®©æˆ‘ä»¬ç”¨æœ€å°‘çš„ä»£ç ï¼Œæ­å»ºä¸€ä¸ªæ”¯æŒæµå¼æ¸²æŸ“çš„ AI å¯¹è¯ç•Œé¢ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>AI å¯¹è¯æµå¼æ¸²æŸ“ç¤ºä¾‹<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/cherry-markdown/dist/cherry-markdown.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
    <span class="hljs-selector-id">#chat-container</span> {
      <span class="hljs-attribute">max-width</span>: <span class="hljs-number">800px</span>;
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">50px</span> auto;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
      <span class="hljs-attribute">background</span>: <span class="hljs-number">#f5f5f5</span>;
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
    }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"chat-container"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/cherry-markdown/dist/cherry-markdown.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-comment">// ğŸ”‘ å…³é”®é…ç½®ï¼šå¼€å¯æµå¼æ¸²æŸ“</span>
    <span class="hljs-keyword">const</span> cherry = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cherry</span>({
      <span class="hljs-attr">el</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'chat-container'</span>),
      <span class="hljs-attr">editor</span>: {
        <span class="hljs-attr">height</span>: <span class="hljs-string">'auto'</span>,
        <span class="hljs-attr">defaultModel</span>: <span class="hljs-string">'previewOnly'</span>,  <span class="hljs-comment">// çº¯é¢„è§ˆæ¨¡å¼ï¼Œæ— ç¼–è¾‘åŒº</span>
      },
      <span class="hljs-attr">engine</span>: {
        <span class="hljs-attr">global</span>: {
          <span class="hljs-attr">flowSessionContext</span>: <span class="hljs-literal">true</span>,     <span class="hljs-comment">// å¼€å¯æµå¼æ¸²æŸ“</span>
          <span class="hljs-attr">flowSessionCursor</span>: <span class="hljs-string">'default'</span>, <span class="hljs-comment">// æ˜¾ç¤ºæ‰“å­—å…‰æ ‡æ•ˆæœ</span>
        },
      },
      <span class="hljs-attr">previewer</span>: {
        <span class="hljs-attr">enablePreviewerBubble</span>: <span class="hljs-literal">false</span>,   <span class="hljs-comment">// å…³é—­é¢„è§ˆåŒºç¼–è¾‘åŠŸèƒ½</span>
      },
    });

    <span class="hljs-comment">// æ¨¡æ‹Ÿ AI æµå¼è¾“å‡º</span>
    <span class="hljs-keyword">const</span> aiResponse = <span class="hljs-string">`### ä½ å¥½ï¼æˆ‘æ˜¯ AI åŠ©æ‰‹

è¿™æ˜¯ä¸€æ®µ**åŠ ç²—æ–‡å­—**å’Œ*æ–œä½“æ–‡å­—*çš„æ¼”ç¤ºã€‚

ä»£ç ç¤ºä¾‹ï¼š

\`\`\`python
def hello():
    print("Hello, World!")
\`\`\`

æ•°å­¦å…¬å¼ï¼š$E = mc^2$
`</span>;

    <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">streamOutput</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">if</span> (index &lt; aiResponse.<span class="hljs-property">length</span>) {
        cherry.<span class="hljs-title function_">setMarkdown</span>(aiResponse.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, index + <span class="hljs-number">1</span>));
        index++;
        <span class="hljs-built_in">setTimeout</span>(streamOutput, <span class="hljs-number">30</span>);  <span class="hljs-comment">// æ¯ 30ms è¾“å‡ºä¸€ä¸ªå­—ç¬¦</span>
      }
    }
    
    <span class="hljs-title function_">streamOutput</span>();
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>å°†ä¸Šè¿°ä»£ç ä¿å­˜ä¸º HTML æ–‡ä»¶ï¼Œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œä½ å°±èƒ½çœ‹åˆ° AI é€å­—è¾“å‡ºçš„æ•ˆæœï¼Œè€Œä¸” Markdown è¯­æ³•ä¼šå®æ—¶æ¸²æŸ“ï¼Œä¸ä¼šéœ²å‡ºæºç ï¼</p>
<h3 data-id="heading-6">2.2 å…³é”®é…ç½®é¡¹è¯¦è§£</h3>
<p>è®©æˆ‘ä»¬è¯¦ç»†è§£é‡Šä¸€ä¸‹æ¯ä¸ªé…ç½®é¡¹çš„ä½œç”¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> cherry = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cherry</span>({
  <span class="hljs-attr">el</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'chat-container'</span>),
  
  <span class="hljs-comment">// ğŸ“ ç¼–è¾‘å™¨é…ç½®</span>
  <span class="hljs-attr">editor</span>: {
    <span class="hljs-attr">height</span>: <span class="hljs-string">'auto'</span>,              <span class="hljs-comment">// é«˜åº¦è‡ªé€‚åº”å†…å®¹</span>
    <span class="hljs-attr">defaultModel</span>: <span class="hljs-string">'previewOnly'</span>,  <span class="hljs-comment">// çº¯é¢„è§ˆæ¨¡å¼ï¼ˆAI å¯¹è¯ä¸éœ€è¦ç¼–è¾‘åŠŸèƒ½ï¼‰</span>
  },
  
  <span class="hljs-comment">// âš™ï¸ å¼•æ“é…ç½®ï¼ˆæ ¸å¿ƒï¼‰</span>
  <span class="hljs-attr">engine</span>: {
    <span class="hljs-attr">global</span>: {
      <span class="hljs-comment">// ğŸ”‘ å¼€å¯æµå¼æ¸²æŸ“æ¨¡å¼</span>
      <span class="hljs-attr">flowSessionContext</span>: <span class="hljs-literal">true</span>,
      
      <span class="hljs-comment">// ğŸ”‘ è™šæ‹Ÿå…‰æ ‡é…ç½®</span>
      <span class="hljs-comment">// - "default": ä½¿ç”¨é»˜è®¤å…‰æ ‡æ ·å¼ï¼ˆæ¨èï¼‰</span>
      <span class="hljs-comment">// - "": ä¸æ˜¾ç¤ºå…‰æ ‡</span>
      <span class="hljs-comment">// - "&lt;span class='custom'&gt;|&lt;/span&gt;": è‡ªå®šä¹‰å…‰æ ‡ HTML</span>
      <span class="hljs-attr">flowSessionCursor</span>: <span class="hljs-string">'default'</span>,
    },
  },
  
  <span class="hljs-comment">// ğŸ‘ï¸ é¢„è§ˆå™¨é…ç½®</span>
  <span class="hljs-attr">previewer</span>: {
    <span class="hljs-attr">enablePreviewerBubble</span>: <span class="hljs-literal">false</span>,  <span class="hljs-comment">// å…³é—­é¢„è§ˆåŒºçš„ç¼–è¾‘æ°”æ³¡ï¼ˆAI åœºæ™¯ä¸éœ€è¦ï¼‰</span>
  },
});
</code></pre>
<h3 data-id="heading-7">2.3 æ•ˆæœé¢„è§ˆï¼šå¼€å¯ vs å…³é—­æµå¼é€‚é…å¯¹æ¯”</h3>






























<table><thead><tr><th>åœºæ™¯</th><th>å…³é—­æµå¼é€‚é…</th><th>å¼€å¯æµå¼é€‚é…</th></tr></thead><tbody><tr><td>ä»£ç å—å†™åˆ°ä¸€åŠ</td><td>æ˜¾ç¤º <code>\</code>``python\ndef`</td><td>è‡ªåŠ¨è¡¥å…¨ï¼Œæ˜¾ç¤ºä»£ç å—æ ·å¼</td></tr><tr><td>è¡¨æ ¼åªè¾“å‡ºä¸€è¡Œ</td><td>æ˜¾ç¤º <code>| col1 | col2 |</code></td><td>è‡ªåŠ¨è¡¥å…¨è¡¨æ ¼ç»“æ„</td></tr><tr><td>å…¬å¼æœªå®Œæˆ</td><td>æ˜¾ç¤º <code>$E = mc^</code></td><td>ç­‰å¾…å…¬å¼å®Œæ•´åå†æ¸²æŸ“</td></tr><tr><td>æ¸²æŸ“é¢‘ç‡</td><td>æœ€å¿« 50ms</td><td>æœ€å¿« 10msï¼ˆå¿« 5 å€ï¼‰</td></tr></tbody></table>
<h2 data-id="heading-8">ä¸‰ã€æ ¸å¿ƒåŸç†ï¼šæµå¼æ¸²æŸ“æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</h2>
<h3 data-id="heading-9">3.1 è‡ªåŠ¨è¡¥å…¨æœºåˆ¶ï¼šCherry å¦‚ä½•"çŒœ"ä½ è¦å†™ä»€ä¹ˆ</h3>
<p>Cherry Markdown çš„æµå¼æ¸²æŸ“æ ¸å¿ƒåœ¨äº<strong>æ™ºèƒ½è¯­æ³•è¡¥å…¨</strong>ã€‚å½“æ£€æµ‹åˆ°æœªé—­åˆçš„ Markdown è¯­æ³•æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨æ’å…¥ä¸´æ—¶é—­åˆæ ‡è®°ï¼Œç¡®ä¿æ¸²æŸ“å™¨èƒ½æ­£ç¡®è§£æã€‚</p>
<h4 data-id="heading-10">æ ‡é¢˜è‡ªåŠ¨è¡¥å…¨</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æµå¼è¾“å‡ºï¼š"# Hello"</span>
<span class="hljs-comment">// Cherry æ£€æµ‹åˆ° # å¼€å¤´ï¼Œè‡ªåŠ¨è¡¥å…¨ä¸ºå®Œæ•´çš„æ ‡é¢˜è¯­æ³•</span>
<span class="hljs-comment">// æ¸²æŸ“ç»“æœï¼š&lt;h1&gt;Hello&lt;/h1&gt;ï¼ˆè€Œä¸æ˜¯æ˜¾ç¤º "# Hello" æºç ï¼‰</span>
</code></pre>
<h4 data-id="heading-11">ä»£ç å—è‡ªåŠ¨è¡¥å…¨</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æµå¼è¾“å‡ºï¼š"```python\ndef hello("</span>
<span class="hljs-comment">// Cherry æ£€æµ‹åˆ° ``` å¼€å§‹ï¼Œè‡ªåŠ¨è¡¥å…¨é—­åˆæ ‡è®°</span>
<span class="hljs-comment">// æ¸²æŸ“ç»“æœï¼šæ˜¾ç¤ºä»£ç å—æ ·å¼ï¼ˆè€Œä¸æ˜¯æ˜¾ç¤ºæºç ï¼‰</span>
</code></pre>
<h4 data-id="heading-12">è¡¨æ ¼è‡ªåŠ¨è¡¥å…¨</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æµå¼è¾“å‡ºç¬¬ä¸€è¡Œï¼š"| åˆ—1 | åˆ—2 |"</span>
<span class="hljs-comment">// Cherry æ£€æµ‹åˆ°è¡¨æ ¼è¯­æ³•ï¼Œè‡ªåŠ¨è¡¥å…¨ç¬¬äºŒè¡Œå ä½ç¬¦</span>
<span class="hljs-comment">// æ¸²æŸ“ç»“æœï¼šæ˜¾ç¤ºå®Œæ•´çš„è¡¨æ ¼ç»“æ„ï¼ˆè€Œä¸æ˜¯æ˜¾ç¤ºæºç ï¼‰</span>
</code></pre>
<h4 data-id="heading-13">å…¬å¼è‡ªåŠ¨è¡¥å…¨</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æµå¼è¾“å‡ºï¼š"$E = mc^"</span>
<span class="hljs-comment">// Cherry æ£€æµ‹åˆ° $ å¼€å§‹ä½†æœªé—­åˆï¼Œç­‰å¾…å®Œæ•´å…¬å¼</span>
<span class="hljs-comment">// å®Œæ•´åï¼š"$E = mc^2$" â†’ æ¸²æŸ“ä¸ºæ•°å­¦å…¬å¼</span>
</code></pre>
<h3 data-id="heading-14">3.2 æ¸²æŸ“é¢‘ç‡ä¼˜åŒ–ï¼šä» 50ms åˆ° 10ms çš„æè‡´ä½“éªŒ</h3>
<p>Cherry Markdown åœ¨æµå¼æ¨¡å¼ä¸‹ï¼Œå°†æ¸²æŸ“é¢‘ç‡ä»é»˜è®¤çš„ 50ms ä¼˜åŒ–åˆ° 10msï¼Œæå‡äº† 5 å€æ€§èƒ½ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ™®é€šæ¨¡å¼ï¼šæœ€å¿« 50ms æ¸²æŸ“ä¸€æ¬¡</span>
<span class="hljs-keyword">const</span> cherryNormal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cherry</span>({
  <span class="hljs-attr">engine</span>: {
    <span class="hljs-attr">global</span>: {
      <span class="hljs-attr">flowSessionContext</span>: <span class="hljs-literal">false</span>,  <span class="hljs-comment">// å…³é—­æµå¼æ¨¡å¼</span>
    },
  },
});

<span class="hljs-comment">// æµå¼æ¨¡å¼ï¼šæœ€å¿« 10ms æ¸²æŸ“ä¸€æ¬¡</span>
<span class="hljs-keyword">const</span> cherryStream = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cherry</span>({
  <span class="hljs-attr">engine</span>: {
    <span class="hljs-attr">global</span>: {
      <span class="hljs-attr">flowSessionContext</span>: <span class="hljs-literal">true</span>,   <span class="hljs-comment">// å¼€å¯æµå¼æ¨¡å¼</span>
    },
  },
});
</code></pre>
<p>è¿™æ„å‘³ç€åœ¨æµå¼è¾“å‡ºåœºæ™¯ä¸‹ï¼Œç”¨æˆ·èƒ½æ„Ÿå—åˆ°æ›´æµç•…ã€æ›´å®æ—¶çš„æ¸²æŸ“æ•ˆæœã€‚</p>
<h3 data-id="heading-15">3.3 è™šæ‹Ÿå…‰æ ‡ï¼šæ¨¡æ‹ŸçœŸå®æ‰“å­—æ•ˆæœ</h3>
<p>Cherry Markdown æä¾›äº†è™šæ‹Ÿå…‰æ ‡åŠŸèƒ½ï¼Œåœ¨æµå¼è¾“å‡ºæ—¶æ˜¾ç¤ºä¸€ä¸ªé—ªçƒçš„å…‰æ ‡ï¼Œæ¨¡æ‹ŸçœŸäººæ‰“å­—çš„æ•ˆæœï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-attr">flowSessionCursor</span>: <span class="hljs-string">'default'</span>  <span class="hljs-comment">// é»˜è®¤å…‰æ ‡æ ·å¼</span>
</code></pre>
<p>ä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å…‰æ ‡æ ·å¼ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-attr">flowSessionCursor</span>: <span class="hljs-string">'&lt;span class="custom-cursor"&gt;|&lt;/span&gt;'</span>

<span class="hljs-comment">// CSS</span>
.<span class="hljs-property">custom</span>-cursor {
  <span class="hljs-attr">color</span>: #0d68ff;
  <span class="hljs-attr">animation</span>: blink 1s infinite;
}
@keyframes blink {
  <span class="hljs-number">0</span>%, <span class="hljs-number">50</span>% { <span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span>; }
  <span class="hljs-number">51</span>%, <span class="hljs-number">100</span>% { <span class="hljs-attr">opacity</span>: <span class="hljs-number">0</span>; }
}
</code></pre>
<h2 data-id="heading-16">å››ã€å®æˆ˜æ¡ˆä¾‹ï¼šæ„å»ºä¸€ä¸ªå®Œæ•´çš„ AI Chat åº”ç”¨</h2>
<h3 data-id="heading-17">4.1 æ¡ˆä¾‹ä¸€ï¼šæ¨¡æ‹Ÿ ChatGPT æµå¼è¾“å‡º</h3>
<p>è¿™ä¸ªæ¡ˆä¾‹å±•ç¤ºäº†å¦‚ä½•æ¨¡æ‹Ÿ ChatGPT çš„é€å­—è¾“å‡ºæ•ˆæœï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æ¨¡æ‹Ÿ ChatGPT æµå¼è¾“å‡º<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/cherry-markdown/dist/cherry-markdown.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
    <span class="hljs-selector-tag">body</span> {
      <span class="hljs-attribute">font-family</span>: -apple-system, BlinkMacSystemFont, <span class="hljs-string">'Segoe UI'</span>, sans-serif;
      <span class="hljs-attribute">max-width</span>: <span class="hljs-number">800px</span>;
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">50px</span> auto;
      <span class="hljs-attribute">background</span>: <span class="hljs-number">#f8f9fb</span>;
    }
    <span class="hljs-selector-class">.chat-message</span> {
      <span class="hljs-attribute">background</span>: white;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">16px</span>;
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
      <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">16px</span>;
      <span class="hljs-attribute">box-shadow</span>: <span class="hljs-number">0</span> <span class="hljs-number">1px</span> <span class="hljs-number">2px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.1</span>);
    }
    <span class="hljs-selector-class">.avatar</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">32px</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">32px</span>;
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
      <span class="hljs-attribute">background</span>: <span class="hljs-number">#0d68ff</span>;
      <span class="hljs-attribute">color</span>: white;
      <span class="hljs-attribute">display</span>: inline-flex;
      <span class="hljs-attribute">align-items</span>: center;
      <span class="hljs-attribute">justify-content</span>: center;
      <span class="hljs-attribute">font-weight</span>: bold;
      <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">12px</span>;
    }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"chat-container"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/cherry-markdown/dist/cherry-markdown.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-comment">// AI å›å¤å†…å®¹</span>
    <span class="hljs-keyword">const</span> aiResponse = <span class="hljs-string">`### ä½ å¥½ï¼æˆ‘æ˜¯ AI åŠ©æ‰‹

æˆ‘å¯ä»¥å¸®ä½ è§£ç­”é—®é¢˜ã€å†™ä»£ç ã€åˆ†ææ•°æ®ç­‰ã€‚

**åŠŸèƒ½ç‰¹ç‚¹ï¼š**
- æ”¯æŒ Markdown æ ¼å¼
- ä»£ç é«˜äº®æ˜¾ç¤º
- æ•°å­¦å…¬å¼æ¸²æŸ“

**ä»£ç ç¤ºä¾‹ï¼š**

\`\`\`python
def fibonacci(n):
    if n &lt;= 1:
        return n
    return fibonacci(n-1) + fibonacci(n-2)

print(fibonacci(10))
\`\`\`

**æ•°å­¦å…¬å¼ï¼š**

è¡Œå†…å…¬å¼ï¼š$E = mc^2$

æ®µè½å…¬å¼ï¼š

$$\\int_{-\\infty}^{\\infty} e^{-x^2} dx = \\sqrt{\\pi}$$

**è¡¨æ ¼ç¤ºä¾‹ï¼š**

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|:----|:----:|------|
| Markdown | âœ… | å®Œå…¨æ”¯æŒ |
| ä»£ç é«˜äº® | âœ… | æ”¯æŒå¤šç§è¯­è¨€ |
| æ•°å­¦å…¬å¼ | âœ… | LaTeX è¯­æ³• |
`</span>;

    <span class="hljs-comment">// åˆ›å»º Cherry å®ä¾‹</span>
    <span class="hljs-keyword">const</span> cherry = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cherry</span>({
      <span class="hljs-attr">el</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'chat-container'</span>),
      <span class="hljs-attr">editor</span>: {
        <span class="hljs-attr">height</span>: <span class="hljs-string">'auto'</span>,
        <span class="hljs-attr">defaultModel</span>: <span class="hljs-string">'previewOnly'</span>,
      },
      <span class="hljs-attr">engine</span>: {
        <span class="hljs-attr">global</span>: {
          <span class="hljs-attr">flowSessionContext</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">flowSessionCursor</span>: <span class="hljs-string">'default'</span>,
        },
      },
      <span class="hljs-attr">previewer</span>: {
        <span class="hljs-attr">enablePreviewerBubble</span>: <span class="hljs-literal">false</span>,
      },
    });

    <span class="hljs-comment">// æµå¼è¾“å‡ºå‡½æ•°</span>
    <span class="hljs-keyword">let</span> currentIndex = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> outputSpeed = <span class="hljs-number">30</span>; <span class="hljs-comment">// æ¯ 30ms è¾“å‡ºä¸€ä¸ªå­—ç¬¦</span>

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">streamOutput</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">if</span> (currentIndex &lt; aiResponse.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">const</span> partialText = aiResponse.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, currentIndex + <span class="hljs-number">1</span>);
        cherry.<span class="hljs-title function_">setMarkdown</span>(partialText);
        currentIndex++;
        <span class="hljs-built_in">setTimeout</span>(streamOutput, outputSpeed);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¾“å‡ºå®Œæˆï¼'</span>);
      }
    }

    <span class="hljs-comment">// å¼€å§‹è¾“å‡º</span>
    <span class="hljs-title function_">streamOutput</span>();
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h3 data-id="heading-18">4.2 æ¡ˆä¾‹äºŒï¼šå¯¹æ¥çœŸå® LLM APIï¼ˆSSE æµå¼æ¥å£ï¼‰</h3>
<p>è¿™ä¸ªæ¡ˆä¾‹å±•ç¤ºå¦‚ä½•å¯¹æ¥çœŸå®çš„ AI APIï¼Œå®ç°çœŸæ­£çš„æµå¼å¯¹è¯ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>å¯¹æ¥çœŸå® AI API<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/cherry-markdown/dist/cherry-markdown.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
    <span class="hljs-selector-tag">body</span> {
      <span class="hljs-attribute">font-family</span>: -apple-system, sans-serif;
      <span class="hljs-attribute">max-width</span>: <span class="hljs-number">900px</span>;
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">50px</span> auto;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
    }
    <span class="hljs-selector-id">#input-area</span> {
      <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;
    }
    <span class="hljs-selector-id">#user-input</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">12px</span>;
      <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ddd</span>;
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">6px</span>;
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
    }
    <span class="hljs-selector-id">#send-btn</span> {
      <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">10px</span>;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span> <span class="hljs-number">20px</span>;
      <span class="hljs-attribute">background</span>: <span class="hljs-number">#0d68ff</span>;
      <span class="hljs-attribute">color</span>: white;
      <span class="hljs-attribute">border</span>: none;
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">6px</span>;
      <span class="hljs-attribute">cursor</span>: pointer;
    }
    <span class="hljs-selector-id">#send-btn</span><span class="hljs-selector-pseudo">:disabled</span> {
      <span class="hljs-attribute">background</span>: <span class="hljs-number">#ccc</span>;
      <span class="hljs-attribute">cursor</span>: not-allowed;
    }
    <span class="hljs-selector-class">.message</span> {
      <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">16px</span>;
      <span class="hljs-attribute">background</span>: <span class="hljs-number">#f8f9fb</span>;
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>;
    }
    <span class="hljs-selector-class">.message</span><span class="hljs-selector-class">.user</span> {
      <span class="hljs-attribute">background</span>: <span class="hljs-number">#e3f2fd</span>;
    }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"input-area"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"user-input"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"è¾“å…¥ä½ çš„é—®é¢˜..."</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"send-btn"</span>&gt;</span>å‘é€<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"messages-container"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/cherry-markdown/dist/cherry-markdown.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">const</span> messagesContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'messages-container'</span>);
    <span class="hljs-keyword">const</span> userInput = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'user-input'</span>);
    <span class="hljs-keyword">const</span> sendBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'send-btn'</span>);

    <span class="hljs-comment">// åˆ›å»ºç”¨æˆ·æ¶ˆæ¯</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">createUserMessage</span>(<span class="hljs-params">text</span>) {
      <span class="hljs-keyword">const</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
      div.<span class="hljs-property">className</span> = <span class="hljs-string">'message user'</span>;
      div.<span class="hljs-property">textContent</span> = text;
      messagesContainer.<span class="hljs-title function_">appendChild</span>(div);
    }

    <span class="hljs-comment">// åˆ›å»º AI æ¶ˆæ¯å®¹å™¨</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">createAIMessage</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">const</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
      div.<span class="hljs-property">className</span> = <span class="hljs-string">'message'</span>;
      <span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
      container.<span class="hljs-property">id</span> = <span class="hljs-string">`ai-msg-<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>;
      div.<span class="hljs-title function_">appendChild</span>(container);
      messagesContainer.<span class="hljs-title function_">appendChild</span>(div);
      <span class="hljs-keyword">return</span> container;
    }

    <span class="hljs-comment">// åˆå§‹åŒ– Cherry å®ä¾‹</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">createCherryInstance</span>(<span class="hljs-params">container</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cherry</span>({
        <span class="hljs-attr">el</span>: container,
        <span class="hljs-attr">editor</span>: {
          <span class="hljs-attr">height</span>: <span class="hljs-string">'auto'</span>,
          <span class="hljs-attr">defaultModel</span>: <span class="hljs-string">'previewOnly'</span>,
        },
        <span class="hljs-attr">engine</span>: {
          <span class="hljs-attr">global</span>: {
            <span class="hljs-attr">flowSessionContext</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">flowSessionCursor</span>: <span class="hljs-string">'default'</span>,
          },
        },
        <span class="hljs-attr">previewer</span>: {
          <span class="hljs-attr">enablePreviewerBubble</span>: <span class="hljs-literal">false</span>,
        },
      });
    }

    <span class="hljs-comment">// å¯¹æ¥ SSE æµå¼ API</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">chatWithAI</span>(<span class="hljs-params">prompt</span>) {
      <span class="hljs-comment">// æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯</span>
      <span class="hljs-title function_">createUserMessage</span>(prompt);

      <span class="hljs-comment">// åˆ›å»º AI æ¶ˆæ¯å®¹å™¨</span>
      <span class="hljs-keyword">const</span> aiContainer = <span class="hljs-title function_">createAIMessage</span>();
      <span class="hljs-keyword">const</span> cherry = <span class="hljs-title function_">createCherryInstance</span>(aiContainer);

      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// è°ƒç”¨ä½ çš„ AI APIï¼ˆè¿™é‡Œä»¥ OpenAI å…¼å®¹æ¥å£ä¸ºä¾‹ï¼‰</span>
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/chat/stream'</span>, {
          <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
          <span class="hljs-attr">headers</span>: {
            <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
          },
          <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
            <span class="hljs-attr">messages</span>: [{ <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>, <span class="hljs-attr">content</span>: prompt }],
          }),
        });

        <span class="hljs-keyword">const</span> reader = response.<span class="hljs-property">body</span>.<span class="hljs-title function_">getReader</span>();
        <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>();
        <span class="hljs-keyword">let</span> fullText = <span class="hljs-string">''</span>;

        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
          <span class="hljs-keyword">const</span> { done, value } = <span class="hljs-keyword">await</span> reader.<span class="hljs-title function_">read</span>();
          <span class="hljs-keyword">if</span> (done) <span class="hljs-keyword">break</span>;

          <span class="hljs-comment">// è§£æ SSE æ•°æ®</span>
          <span class="hljs-keyword">const</span> chunk = decoder.<span class="hljs-title function_">decode</span>(value);
          <span class="hljs-keyword">const</span> lines = chunk.<span class="hljs-title function_">split</span>(<span class="hljs-string">'\n'</span>);

          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> line <span class="hljs-keyword">of</span> lines) {
            <span class="hljs-keyword">if</span> (line.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'data: '</span>)) {
              <span class="hljs-keyword">const</span> data = line.<span class="hljs-title function_">slice</span>(<span class="hljs-number">6</span>);
              <span class="hljs-keyword">if</span> (data === <span class="hljs-string">'[DONE]'</span>) <span class="hljs-keyword">continue</span>;

              <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">const</span> json = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data);
                <span class="hljs-keyword">const</span> delta = json.<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>].<span class="hljs-property">delta</span>.<span class="hljs-property">content</span> || <span class="hljs-string">''</span>;
                fullText += delta;
                
                <span class="hljs-comment">// ğŸ”‘ å®æ—¶æ›´æ–° Markdown å†…å®¹</span>
                cherry.<span class="hljs-title function_">setMarkdown</span>(fullText);
              } <span class="hljs-keyword">catch</span> (e) {
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è§£æé”™è¯¯:'</span>, e);
              }
            }
          }
        }
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'API è°ƒç”¨å¤±è´¥:'</span>, error);
        cherry.<span class="hljs-title function_">setMarkdown</span>(<span class="hljs-string">'**é”™è¯¯ï¼š** æ— æ³•è¿æ¥åˆ° AI æœåŠ¡ï¼Œè¯·ç¨åé‡è¯•ã€‚'</span>);
      }
    }

    <span class="hljs-comment">// å‘é€æŒ‰é’®äº‹ä»¶</span>
    sendBtn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> prompt = userInput.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>();
      <span class="hljs-keyword">if</span> (!prompt) <span class="hljs-keyword">return</span>;

      sendBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;
      userInput.<span class="hljs-property">value</span> = <span class="hljs-string">''</span>;
      
      <span class="hljs-keyword">await</span> <span class="hljs-title function_">chatWithAI</span>(prompt);
      
      sendBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">false</span>;
      userInput.<span class="hljs-title function_">focus</span>();
    });

    <span class="hljs-comment">// å›è½¦å‘é€</span>
    userInput.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'keypress'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">'Enter'</span> &amp;&amp; !sendBtn.<span class="hljs-property">disabled</span>) {
        sendBtn.<span class="hljs-title function_">click</span>();
      }
    });
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h3 data-id="heading-19">4.3 æ¡ˆä¾‹ä¸‰ï¼šæ”¯æŒæš‚åœ/ç»§ç»­çš„æµå¼æ¸²æŸ“æ§åˆ¶</h3>
<p>è¿™ä¸ªæ¡ˆä¾‹å±•ç¤ºäº†å¦‚ä½•å®ç°æš‚åœå’Œç»§ç»­åŠŸèƒ½ï¼Œè®©ç”¨æˆ·æ§åˆ¶æµå¼è¾“å‡ºçš„èŠ‚å¥ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>å¯æ§åˆ¶çš„æµå¼è¾“å‡º<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/cherry-markdown/dist/cherry-markdown.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
    <span class="hljs-selector-tag">body</span> {
      <span class="hljs-attribute">font-family</span>: -apple-system, sans-serif;
      <span class="hljs-attribute">max-width</span>: <span class="hljs-number">800px</span>;
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">50px</span> auto;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
    }
    <span class="hljs-selector-class">.controls</span> {
      <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">20px</span>;
      <span class="hljs-attribute">display</span>: flex;
      <span class="hljs-attribute">gap</span>: <span class="hljs-number">10px</span>;
    }
    <span class="hljs-selector-tag">button</span> {
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span> <span class="hljs-number">20px</span>;
      <span class="hljs-attribute">border</span>: none;
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">6px</span>;
      <span class="hljs-attribute">cursor</span>: pointer;
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
    }
    <span class="hljs-selector-class">.btn-primary</span> {
      <span class="hljs-attribute">background</span>: <span class="hljs-number">#0d68ff</span>;
      <span class="hljs-attribute">color</span>: white;
    }
    <span class="hljs-selector-class">.btn-secondary</span> {
      <span class="hljs-attribute">background</span>: <span class="hljs-number">#6c757d</span>;
      <span class="hljs-attribute">color</span>: white;
    }
    <span class="hljs-selector-tag">button</span><span class="hljs-selector-pseudo">:disabled</span> {
      <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.5</span>;
      <span class="hljs-attribute">cursor</span>: not-allowed;
    }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"controls"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"start-btn"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn-primary"</span>&gt;</span>å¼€å§‹æµå¼è¾“å‡º<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"pause-btn"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn-secondary"</span> <span class="hljs-attr">disabled</span>&gt;</span>æš‚åœ<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"resume-btn"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn-secondary"</span> <span class="hljs-attr">disabled</span>&gt;</span>ç»§ç»­<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"reset-btn"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn-secondary"</span>&gt;</span>é‡ç½®<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"output-container"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/cherry-markdown/dist/cherry-markdown.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">const</span> outputContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'output-container'</span>);
    <span class="hljs-keyword">const</span> startBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'start-btn'</span>);
    <span class="hljs-keyword">const</span> pauseBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'pause-btn'</span>);
    <span class="hljs-keyword">const</span> resumeBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'resume-btn'</span>);
    <span class="hljs-keyword">const</span> resetBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'reset-btn'</span>);

    <span class="hljs-comment">// AI å›å¤å†…å®¹</span>
    <span class="hljs-keyword">const</span> aiResponse = <span class="hljs-string">`### å¯æ§åˆ¶çš„æµå¼è¾“å‡ºæ¼”ç¤º

è¿™æ®µå†…å®¹æ”¯æŒ**æš‚åœ**å’Œ**ç»§ç»­**åŠŸèƒ½ã€‚

\`\`\`javascript
// æš‚åœæµå¼è¾“å‡º
paused = true;

// ç»§ç»­æµå¼è¾“å‡º
paused = false;
\`\`\`

æ•°å­¦å…¬å¼ï¼š$\\sum_{i=1}^{n} i = \\frac{n(n+1)}{2}$

**åŠŸèƒ½ç‰¹ç‚¹ï¼š**
- âœ… å¯ä»¥éšæ—¶æš‚åœ
- âœ… å¯ä»¥ç»§ç»­è¾“å‡º
- âœ… å¯ä»¥é‡ç½®é‡æ–°å¼€å§‹
`</span>;

    <span class="hljs-keyword">let</span> cherry = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">let</span> currentIndex = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> paused = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">let</span> streaming = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">let</span> streamTimer = <span class="hljs-literal">null</span>;

    <span class="hljs-comment">// åˆå§‹åŒ– Cherry</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">initCherry</span>(<span class="hljs-params"/>) {
      cherry = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cherry</span>({
        <span class="hljs-attr">el</span>: outputContainer,
        <span class="hljs-attr">editor</span>: {
          <span class="hljs-attr">height</span>: <span class="hljs-string">'auto'</span>,
          <span class="hljs-attr">defaultModel</span>: <span class="hljs-string">'previewOnly'</span>,
        },
        <span class="hljs-attr">engine</span>: {
          <span class="hljs-attr">global</span>: {
            <span class="hljs-attr">flowSessionContext</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">flowSessionCursor</span>: <span class="hljs-string">'default'</span>,
          },
        },
        <span class="hljs-attr">previewer</span>: {
          <span class="hljs-attr">enablePreviewerBubble</span>: <span class="hljs-literal">false</span>,
        },
      });
    }

    <span class="hljs-comment">// æµå¼è¾“å‡ºå‡½æ•°</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">streamOutput</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">if</span> (paused) {
        <span class="hljs-comment">// æš‚åœæ—¶ï¼Œæ¯ 100ms æ£€æŸ¥ä¸€æ¬¡æ˜¯å¦æ¢å¤</span>
        streamTimer = <span class="hljs-built_in">setTimeout</span>(streamOutput, <span class="hljs-number">100</span>);
        <span class="hljs-keyword">return</span>;
      }

      <span class="hljs-keyword">if</span> (currentIndex &lt; aiResponse.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">const</span> partialText = aiResponse.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, currentIndex + <span class="hljs-number">1</span>);
        cherry.<span class="hljs-title function_">setMarkdown</span>(partialText);
        currentIndex++;
        streamTimer = <span class="hljs-built_in">setTimeout</span>(streamOutput, <span class="hljs-number">30</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// è¾“å‡ºå®Œæˆ</span>
        streaming = <span class="hljs-literal">false</span>;
        startBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">false</span>;
        pauseBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;
        resumeBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;
      }
    }

    <span class="hljs-comment">// å¼€å§‹è¾“å‡º</span>
    startBtn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (!cherry) <span class="hljs-title function_">initCherry</span>();
      
      currentIndex = <span class="hljs-number">0</span>;
      paused = <span class="hljs-literal">false</span>;
      streaming = <span class="hljs-literal">true</span>;
      
      startBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;
      pauseBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">false</span>;
      resumeBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;
      
      cherry.<span class="hljs-title function_">setMarkdown</span>(<span class="hljs-string">''</span>);
      <span class="hljs-title function_">streamOutput</span>();
    });

    <span class="hljs-comment">// æš‚åœè¾“å‡º</span>
    pauseBtn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
      paused = <span class="hljs-literal">true</span>;
      pauseBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;
      resumeBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">false</span>;
    });

    <span class="hljs-comment">// ç»§ç»­è¾“å‡º</span>
    resumeBtn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
      paused = <span class="hljs-literal">false</span>;
      pauseBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">false</span>;
      resumeBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;
    });

    <span class="hljs-comment">// é‡ç½®</span>
    resetBtn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (streamTimer) {
        <span class="hljs-built_in">clearTimeout</span>(streamTimer);
        streamTimer = <span class="hljs-literal">null</span>;
      }
      
      currentIndex = <span class="hljs-number">0</span>;
      paused = <span class="hljs-literal">false</span>;
      streaming = <span class="hljs-literal">false</span>;
      
      <span class="hljs-keyword">if</span> (cherry) {
        cherry.<span class="hljs-title function_">setMarkdown</span>(<span class="hljs-string">''</span>);
      }
      
      startBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">false</span>;
      pauseBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;
      resumeBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;
    });

    <span class="hljs-comment">// åˆå§‹åŒ–</span>
    <span class="hljs-title function_">initCherry</span>();
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h2 data-id="heading-20">äº”ã€è¿›é˜¶æŠ€å·§ï¼šè®© AI å¯¹è¯æ›´ä¸“ä¸š</h2>
<h3 data-id="heading-21">5.1 å¼‚æ­¥æ¸²æŸ“å›è°ƒï¼šmermaid å›¾è¡¨å®Œæˆåçš„å¤„ç†</h3>
<p>ä» mermaid v10.0.0 å¼€å§‹ï¼Œæ¸²æŸ“é€»è¾‘ç”±åŒæ­¥æ”¹ä¸ºå¼‚æ­¥ã€‚Cherry Markdown æä¾›äº† <code>afterAsyncRender</code> å›è°ƒï¼Œè®©ä½ åœ¨å¼‚æ­¥æ¸²æŸ“å®Œæˆåè·å–ç»“æœï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> cherry = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cherry</span>({
  <span class="hljs-attr">el</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'container'</span>),
  <span class="hljs-attr">value</span>: <span class="hljs-string">`
    \`\`\`mermaid
    graph LR
        A[å¼€å§‹] --&gt; B[å¤„ç†]
        B --&gt; C[ç»“æŸ]
    \`\`\`
  `</span>,
  <span class="hljs-attr">editor</span>: {
    <span class="hljs-attr">defaultModel</span>: <span class="hljs-string">'previewOnly'</span>,
  },
  <span class="hljs-attr">engine</span>: {
    <span class="hljs-attr">global</span>: {
      <span class="hljs-attr">flowSessionContext</span>: <span class="hljs-literal">true</span>,
    },
  },
  <span class="hljs-attr">callback</span>: {
    <span class="hljs-comment">// ğŸ”‘ å¼‚æ­¥æ¸²æŸ“å®Œæˆå›è°ƒ</span>
    <span class="hljs-attr">afterAsyncRender</span>: <span class="hljs-function">(<span class="hljs-params">md, html</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Markdown æºç :'</span>, md);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ¸²æŸ“åçš„ HTML:'</span>, html);
      
      <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œåšä¸€äº›åå¤„ç†ï¼Œæ¯”å¦‚ï¼š</span>
      <span class="hljs-comment">// - ç»Ÿè®¡å›¾è¡¨æ•°é‡</span>
      <span class="hljs-comment">// - æ·»åŠ äº¤äº’åŠŸèƒ½</span>
      <span class="hljs-comment">// - å‘é€åˆ†ææ•°æ®</span>
    },
  },
});
</code></pre>
<h3 data-id="heading-22">5.2 è‡ªå®šä¹‰æµå¼å…‰æ ‡æ ·å¼</h3>
<p>ä½ å¯ä»¥å®Œå…¨è‡ªå®šä¹‰å…‰æ ‡çš„æ ·å¼ï¼Œè®©å®ƒæ›´ç¬¦åˆä½ çš„äº§å“è®¾è®¡ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> cherry = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cherry</span>({
  <span class="hljs-attr">el</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'container'</span>),
  <span class="hljs-attr">engine</span>: {
    <span class="hljs-attr">global</span>: {
      <span class="hljs-attr">flowSessionContext</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-comment">// è‡ªå®šä¹‰å…‰æ ‡ HTML</span>
      <span class="hljs-attr">flowSessionCursor</span>: <span class="hljs-string">'&lt;span class="custom-cursor"&gt;â–‹&lt;/span&gt;'</span>,
    },
  },
});

<span class="hljs-comment">// CSS</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-selector-class">.custom-cursor</span> {
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#0d68ff</span>;
  <span class="hljs-attribute">font-weight</span>: bold;
  <span class="hljs-attribute">animation</span>: blink <span class="hljs-number">1s</span> step-end infinite;
  <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">2px</span>;
}

<span class="hljs-keyword">@keyframes</span> blink {
  <span class="hljs-number">0%</span>, <span class="hljs-number">50%</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; }
  <span class="hljs-number">51%</span>, <span class="hljs-number">100%</span> { <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; }
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-23">5.3 å¤šè½®å¯¹è¯çš„æ¶ˆæ¯ç®¡ç†</h3>
<p>åœ¨å®é™…çš„ AI å¯¹è¯åº”ç”¨ä¸­ï¼Œä½ éœ€è¦ç®¡ç†å¤šè½®å¯¹è¯ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ¶ˆæ¯ç®¡ç†ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatManager</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">container</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span> = container;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cherryInstances</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  }

  <span class="hljs-comment">// æ·»åŠ ç”¨æˆ·æ¶ˆæ¯</span>
  <span class="hljs-title function_">addUserMessage</span>(<span class="hljs-params">content</span>) {
    <span class="hljs-keyword">const</span> msg = {
      <span class="hljs-attr">id</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
      <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>,
      content,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(),
    };
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span>.<span class="hljs-title function_">push</span>(msg);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderUserMessage</span>(msg);
  }

  <span class="hljs-comment">// æ·»åŠ  AI æ¶ˆæ¯ï¼ˆæµå¼ï¼‰</span>
  <span class="hljs-title function_">addAIMessageStream</span>(<span class="hljs-params">streamCallback</span>) {
    <span class="hljs-keyword">const</span> msgId = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">const</span> msg = {
      <span class="hljs-attr">id</span>: msgId,
      <span class="hljs-attr">role</span>: <span class="hljs-string">'assistant'</span>,
      <span class="hljs-attr">content</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(),
    };
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span>.<span class="hljs-title function_">push</span>(msg);

    <span class="hljs-comment">// åˆ›å»ºæ¶ˆæ¯ DOM</span>
    <span class="hljs-keyword">const</span> msgDiv = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
    msgDiv.<span class="hljs-property">className</span> = <span class="hljs-string">'ai-message'</span>;
    msgDiv.<span class="hljs-property">id</span> = <span class="hljs-string">`msg-<span class="hljs-subst">${msgId}</span>`</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">appendChild</span>(msgDiv);

    <span class="hljs-comment">// åˆ›å»º Cherry å®ä¾‹</span>
    <span class="hljs-keyword">const</span> cherry = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cherry</span>({
      <span class="hljs-attr">el</span>: msgDiv,
      <span class="hljs-attr">editor</span>: {
        <span class="hljs-attr">height</span>: <span class="hljs-string">'auto'</span>,
        <span class="hljs-attr">defaultModel</span>: <span class="hljs-string">'previewOnly'</span>,
      },
      <span class="hljs-attr">engine</span>: {
        <span class="hljs-attr">global</span>: {
          <span class="hljs-attr">flowSessionContext</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">flowSessionCursor</span>: <span class="hljs-string">'default'</span>,
        },
      },
      <span class="hljs-attr">previewer</span>: {
        <span class="hljs-attr">enablePreviewerBubble</span>: <span class="hljs-literal">false</span>,
      },
    });

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cherryInstances</span>.<span class="hljs-title function_">set</span>(msgId, cherry);

    <span class="hljs-comment">// æµå¼æ›´æ–°å†…å®¹</span>
    <span class="hljs-keyword">let</span> fullText = <span class="hljs-string">''</span>;
    <span class="hljs-title function_">streamCallback</span>(<span class="hljs-function">(<span class="hljs-params">chunk</span>) =&gt;</span> {
      fullText += chunk;
      cherry.<span class="hljs-title function_">setMarkdown</span>(fullText);
      msg.<span class="hljs-property">content</span> = fullText;
    });

    <span class="hljs-keyword">return</span> msgId;
  }

  <span class="hljs-comment">// æ¸²æŸ“ç”¨æˆ·æ¶ˆæ¯</span>
  <span class="hljs-title function_">renderUserMessage</span>(<span class="hljs-params">msg</span>) {
    <span class="hljs-keyword">const</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
    div.<span class="hljs-property">className</span> = <span class="hljs-string">'user-message'</span>;
    div.<span class="hljs-property">textContent</span> = msg.<span class="hljs-property">content</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">appendChild</span>(div);
  }

  <span class="hljs-comment">// è·å–æ‰€æœ‰æ¶ˆæ¯ï¼ˆç”¨äº API è°ƒç”¨ï¼‰</span>
  <span class="hljs-title function_">getMessagesForAPI</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">msg</span> =&gt;</span> ({
      <span class="hljs-attr">role</span>: msg.<span class="hljs-property">role</span>,
      <span class="hljs-attr">content</span>: msg.<span class="hljs-property">content</span>,
    }));
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> chatManager = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatManager</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'chat-container'</span>));

<span class="hljs-comment">// ç”¨æˆ·å‘é€æ¶ˆæ¯</span>
chatManager.<span class="hljs-title function_">addUserMessage</span>(<span class="hljs-string">'ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ Markdown'</span>);

<span class="hljs-comment">// AI æµå¼å›å¤</span>
<span class="hljs-keyword">const</span> msgId = chatManager.<span class="hljs-title function_">addAIMessageStream</span>(<span class="hljs-function">(<span class="hljs-params">update</span>) =&gt;</span> {
  <span class="hljs-comment">// æ¨¡æ‹Ÿæµå¼è¾“å‡º</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-string">'### Markdown ç®€ä»‹\n\nMarkdown æ˜¯ä¸€ç§è½»é‡çº§æ ‡è®°è¯­è¨€...'</span>;
  <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (index &lt; response.<span class="hljs-property">length</span>) {
      <span class="hljs-title function_">update</span>(response[index]);
      index++;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-built_in">clearInterval</span>(timer);
    }
  }, <span class="hljs-number">30</span>);
});
</code></pre>
<h3 data-id="heading-24">5.4 æ€§èƒ½ä¼˜åŒ–ï¼šå¤§é‡æ¶ˆæ¯æ—¶çš„å¤„ç†ç­–ç•¥</h3>
<p>å½“å¯¹è¯æ¶ˆæ¯å¾ˆå¤šæ—¶ï¼Œéœ€è¦æ³¨æ„æ€§èƒ½ä¼˜åŒ–ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">OptimizedChatManager</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">container, maxVisibleMessages = <span class="hljs-number">10</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span> = container;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxVisibleMessages</span> = maxVisibleMessages;
  }

  <span class="hljs-comment">// åªæ¸²æŸ“æœ€è¿‘çš„æ¶ˆæ¯</span>
  <span class="hljs-title function_">renderMessages</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æ¸…ç©ºå®¹å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">''</span>;

    <span class="hljs-comment">// åªæ¸²æŸ“æœ€å N æ¡æ¶ˆæ¯</span>
    <span class="hljs-keyword">const</span> visibleMessages = <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span>.<span class="hljs-title function_">slice</span>(-<span class="hljs-variable language_">this</span>.<span class="hljs-property">maxVisibleMessages</span>);

    visibleMessages.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">msg</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (msg.<span class="hljs-property">role</span> === <span class="hljs-string">'user'</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderUserMessage</span>(msg);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderAIMessage</span>(msg);
      }
    });

    <span class="hljs-comment">// æ»šåŠ¨åˆ°åº•éƒ¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">scrollToBottom</span>();
  }

  <span class="hljs-comment">// è™šæ‹Ÿæ»šåŠ¨ï¼ˆé€‚ç”¨äºè¶…å¤§é‡æ¶ˆæ¯ï¼‰</span>
  <span class="hljs-title function_">renderWithVirtualScroll</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å®ç°è™šæ‹Ÿæ»šåŠ¨é€»è¾‘</span>
    <span class="hljs-comment">// åªæ¸²æŸ“å¯è§åŒºåŸŸçš„æ¶ˆæ¯</span>
  }

  <span class="hljs-comment">// æ‡’åŠ è½½å†å²æ¶ˆæ¯</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">loadHistoryMessages</span>(<span class="hljs-params">offset = <span class="hljs-number">0</span>, limit = <span class="hljs-number">20</span></span>) {
    <span class="hljs-comment">// ä»æœåŠ¡å™¨åŠ è½½å†å²æ¶ˆæ¯</span>
    <span class="hljs-keyword">const</span> history = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/messages?offset=<span class="hljs-subst">${offset}</span>&amp;limit=<span class="hljs-subst">${limit}</span>`</span>);
    <span class="hljs-keyword">const</span> messages = <span class="hljs-keyword">await</span> history.<span class="hljs-title function_">json</span>();
    
    <span class="hljs-comment">// æ’å…¥åˆ°æ¶ˆæ¯åˆ—è¡¨å‰é¢</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">messages</span>.<span class="hljs-title function_">unshift</span>(...messages);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderMessages</span>();
  }
}
</code></pre>
<h2 data-id="heading-25">å…­ã€æ€»ç»“ä¸èµ„æº</h2>
<h3 data-id="heading-26">6.1 é€‚ç”¨åœºæ™¯ä¸€è§ˆ</h3>
<p>Cherry Markdown çš„æµå¼æ¸²æŸ“åŠŸèƒ½ç‰¹åˆ«é€‚åˆä»¥ä¸‹åœºæ™¯ï¼š</p>



































<table><thead><tr><th>åœºæ™¯</th><th>è¯´æ˜</th><th>ä¼˜åŠ¿</th></tr></thead><tbody><tr><td>AI å¯¹è¯åº”ç”¨</td><td>ChatGPTã€Claude ç­‰å¯¹è¯ç•Œé¢</td><td>å®æ—¶æ¸²æŸ“ï¼Œä¸éœ²æºç </td></tr><tr><td>ä»£ç ç”Ÿæˆå·¥å…·</td><td>AI ç”Ÿæˆä»£ç çš„å®æ—¶å±•ç¤º</td><td>ä»£ç é«˜äº®å®Œæ•´æ˜¾ç¤º</td></tr><tr><td>æ–‡æ¡£ç”Ÿæˆå·¥å…·</td><td>æµå¼ç”Ÿæˆ Markdown æ–‡æ¡£</td><td>æ‰€è§å³æ‰€å¾—</td></tr><tr><td>åœ¨çº¿æ•™è‚²</td><td>å®æ—¶è®²è§£ Markdown è¯­æ³•</td><td>æ•™å­¦æ¼”ç¤ºæ›´ç›´è§‚</td></tr><tr><td>åä½œç¼–è¾‘</td><td>å¤šäººå®æ—¶ç¼–è¾‘ Markdown</td><td>æµç•…çš„åä½œä½“éªŒ</td></tr></tbody></table>
<h3 data-id="heading-27">6.2 åœ¨çº¿ Demo ä¸æ–‡æ¡£é“¾æ¥</h3>
<ul>
<li><strong>åœ¨çº¿æ¼”ç¤º</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftencent.github.io%2Fcherry-markdown%2Fexamples%2Fai_chat.html" target="_blank" title="https://tencent.github.io/cherry-markdown/examples/ai_chat.html" ref="nofollow noopener noreferrer">AI Chat æµå¼æ¸²æŸ“ Demo</a></li>
<li><strong>å®Œæ•´æ–‡æ¡£</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTencent%2Fcherry-markdown%2Fwiki" target="_blank" title="https://github.com/Tencent/cherry-markdown/wiki" ref="nofollow noopener noreferrer">Cherry Markdown Wiki</a></li>
<li><strong>GitHub ä»“åº“</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTencent%2Fcherry-markdown" target="_blank" title="https://github.com/Tencent/cherry-markdown" ref="nofollow noopener noreferrer">Tencent/cherry-markdown</a></li>
<li><strong>API æ–‡æ¡£</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Ftencent.github.io%2Fcherry-markdown%2Fexamples%2Fapi.html" target="_blank" title="https://tencent.github.io/cherry-markdown/examples/api.html" ref="nofollow noopener noreferrer">API å‚è€ƒ</a></li>
</ul>
<h3 data-id="heading-28">6.3 å¸¸è§é—®é¢˜ FAQ</h3>
<p><strong>Q: æµå¼æ¸²æŸ“ä¼šå½±å“æ€§èƒ½å—ï¼Ÿ</strong></p>
<p>A: ä¸ä¼šã€‚Cherry Markdown åœ¨æµå¼æ¨¡å¼ä¸‹ä¼˜åŒ–äº†æ¸²æŸ“é¢‘ç‡ï¼ˆ10msï¼‰ï¼Œæ¯”æ™®é€šæ¨¡å¼ï¼ˆ50msï¼‰æ›´å¿«ã€‚</p>
<p><strong>Q: æ”¯æŒå“ªäº› Markdown è¯­æ³•ï¼Ÿ</strong></p>
<p>A: æ”¯æŒ 12 ç§è¯­æ³•çš„è‡ªåŠ¨è¡¥å…¨ï¼šæ ‡é¢˜ã€åŠ ç²—ã€æ–œä½“ã€é“¾æ¥ã€å›¾ç‰‡ã€ä»£ç å—ã€å…¬å¼ã€åˆ—è¡¨ã€è¡¨æ ¼ã€mermaidã€è„šæ³¨ç­‰ã€‚</p>
<p><strong>Q: å¯ä»¥è‡ªå®šä¹‰è¡¥å…¨è§„åˆ™å—ï¼Ÿ</strong></p>
<p>A: ç›®å‰è¡¥å…¨è§„åˆ™æ˜¯å†…ç½®çš„ï¼Œä½†ä½ å¯ä»¥é€šè¿‡è‡ªå®šä¹‰è¯­æ³•æ‰©å±•åŠŸèƒ½ã€‚è¯¦è§<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTencent%2Fcherry-markdown%2Fwiki%2F%25E8%2587%25AA%25E5%25AE%259A%25E4%25B9%2589%25E8%25AF%25AD%25E6%25B3%2595" target="_blank" title="https://github.com/Tencent/cherry-markdown/wiki/%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%AD%E6%B3%95" ref="nofollow noopener noreferrer">è‡ªå®šä¹‰è¯­æ³•æ–‡æ¡£</a>ã€‚</p>
<p><strong>Q: å¦‚ä½•å¯¹æ¥æˆ‘çš„ AI APIï¼Ÿ</strong></p>
<p>A: å‚è€ƒæœ¬æ–‡çš„"æ¡ˆä¾‹äºŒ"ï¼Œä½¿ç”¨ SSEï¼ˆServer-Sent Eventsï¼‰æˆ– WebSocket æ¥æ”¶æµå¼æ•°æ®ï¼Œç„¶åè°ƒç”¨ <code>cherry.setMarkdown()</code> æ›´æ–°å†…å®¹ã€‚</p>
<p><strong>Q: æµå¼æ¸²æŸ“æ”¯æŒç§»åŠ¨ç«¯å—ï¼Ÿ</strong></p>
<p>A: å®Œå…¨æ”¯æŒã€‚Cherry Markdown æ˜¯å“åº”å¼è®¾è®¡ï¼Œåœ¨ç§»åŠ¨ç«¯ä¹Ÿèƒ½æµç•…è¿è¡Œã€‚æŸ¥çœ‹<a href="https://link.juejin.cn?target=https%3A%2F%2Ftencent.github.io%2Fcherry-markdown%2Fexamples%2Fh5.html" target="_blank" title="https://tencent.github.io/cherry-markdown/examples/h5.html" ref="nofollow noopener noreferrer">ç§»åŠ¨ç«¯ Demo</a>ã€‚</p>
<h2 data-id="heading-29">ç»“è¯­</h2>
<p>Cherry Markdown çš„æµå¼æ¸²æŸ“åŠŸèƒ½ï¼Œè®© AI å¯¹è¯åº”ç”¨çš„ Markdown å±•ç¤ºå˜å¾—ä¸æ»‘æµç•…ã€‚æ— è®ºæ˜¯æ„å»º ChatGPT ç±»åº”ç”¨ï¼Œè¿˜æ˜¯å¼€å‘ä»£ç ç”Ÿæˆå·¥å…·ï¼ŒCherry Markdown éƒ½èƒ½ä¸ºä½ æä¾›ä¸“ä¸šçº§çš„æ¸²æŸ“ä½“éªŒã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ å¿«é€Ÿä¸Šæ‰‹ Cherry Markdown çš„æµå¼æ¸²æŸ“åŠŸèƒ½ã€‚å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTencent%2Fcherry-markdown%2Fissues" target="_blank" title="https://github.com/Tencent/cherry-markdown/issues" ref="nofollow noopener noreferrer">GitHub Issues</a> ä¸­æå‡ºã€‚</p>
<p><strong>å¼€å§‹æ„å»ºä½ çš„ AI å¯¹è¯åº”ç”¨å§ï¼</strong> ğŸš€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€ŠGit å…¥é—¨æŒ‡å—ï¼šä»é›¶å¼€å§‹æŒæ¡ç‰ˆæœ¬æ§åˆ¶ï¼ˆé™„é«˜é¢‘å‘½ä»¤é€ŸæŸ¥ï¼‰ã€‹]]></title>    <link>https://juejin.cn/post/7595864836360323124</link>    <guid>https://juejin.cn/post/7595864836360323124</guid>    <pubDate>2026-01-17T08:59:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595864836360323124" data-draft-id="7595859552348258356" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€ŠGit å…¥é—¨æŒ‡å—ï¼šä»é›¶å¼€å§‹æŒæ¡ç‰ˆæœ¬æ§åˆ¶ï¼ˆé™„é«˜é¢‘å‘½ä»¤é€ŸæŸ¥ï¼‰ã€‹"/> <meta itemprop="keywords" content="Git"/> <meta itemprop="datePublished" content="2026-01-17T08:59:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·80110532256"/> <meta itemprop="url" content="https://juejin.cn/user/1927884034804425"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€ŠGit å…¥é—¨æŒ‡å—ï¼šä»é›¶å¼€å§‹æŒæ¡ç‰ˆæœ¬æ§åˆ¶ï¼ˆé™„é«˜é¢‘å‘½ä»¤é€ŸæŸ¥ï¼‰ã€‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1927884034804425/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·80110532256
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T08:59:21.000Z" title="Sat Jan 17 2026 08:59:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Git å…¥é—¨æŒ‡å—ï¼šä»é›¶å¼€å§‹æŒæ¡ç‰ˆæœ¬æ§åˆ¶ï¼ˆé™„é«˜é¢‘å‘½ä»¤é€ŸæŸ¥ï¼‰</h2>
<blockquote>
<p><strong>ä¸ºä»€ä¹ˆåŒä¸€ä¸ªé¡¹ç›®ä¸èƒ½æœ‰å¤šä¸ª Git ä»“åº“ï¼Ÿ</strong><br/>
<strong>ä¸ºä»€ä¹ˆæäº¤è¦ç”¨ hash ID è€Œä¸ç”¨ 1ã€2ã€3ï¼Ÿ</strong><br/>
<strong>å¦‚ä½•ä¼˜é›…åœ°å›é€€ä»£ç ã€æ’¤é”€ä¿®æ”¹ï¼Ÿ</strong></p>
<p>æœ¬æ–‡ç”¨æœ€ç›´ç™½çš„è¯­è¨€ + å®æˆ˜å‘½ä»¤ï¼Œå¸¦ä½ å½»åº•ææ‡‚ Git æ ¸å¿ƒåŸç†ä¸æ—¥å¸¸æ“ä½œï¼Œå‘Šåˆ«â€œåªä¼š git add / commit / pushâ€ï¼</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ Gitï¼Ÿ</h3>
<p>æƒ³è±¡ä½ åœ¨å¼€å‘ä¸€ä¸ªé¡¹ç›®ï¼š</p>
<ul>
<li>ä»Šå¤©æ”¹äº†åŠŸèƒ½ Aï¼Œæ˜å¤©æƒ³è¯•è¯•åŠŸèƒ½ Bï¼Œä½†åˆæ€•æç ¸</li>
<li>å›¢é˜Ÿåä½œæ—¶ï¼Œå¤šäººåŒæ—¶ä¿®æ”¹åŒä¸€ä¸ªæ–‡ä»¶ï¼Œæ€ä¹ˆåˆå¹¶ï¼Ÿ</li>
<li>ä»£ç å†™å´©äº†ï¼Œæƒ³å›åˆ°æ˜¨å¤©çš„çŠ¶æ€ï¼Ÿ</li>
</ul>
<p><strong>Git å°±æ˜¯ä½ çš„â€œä»£ç æ—¶å…‰æœºâ€</strong> â€”â€” å®ƒèƒ½ï¼š</p>
<ul>
<li>è®°å½•æ¯ä¸€æ¬¡æ–‡ä»¶å˜åŒ–</li>
<li>æ”¯æŒå¤šäººåä½œä¸å†²çª</li>
<li>éšæ—¶å›é€€åˆ°ä»»æ„å†å²ç‰ˆæœ¬</li>
</ul>
<blockquote>
<p>ğŸ’¡ <strong>å…³é”®è®¤çŸ¥</strong>ï¼šGit ç®¡ç†çš„ä¸æ˜¯æ–‡ä»¶æœ¬èº«ï¼Œè€Œæ˜¯<strong>æ–‡ä»¶çš„ç‰ˆæœ¬</strong>ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-2">äºŒã€åˆå§‹åŒ–ä»“åº“ï¼š<code>git init</code></h3>
<p>è¦è®©æ™®é€šæ–‡ä»¶å¤¹å˜æˆâ€œä»£ç ä»“åº“â€ï¼Œåªéœ€ä¸€è¡Œå‘½ä»¤ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">git <span class="hljs-keyword">init</span>
</code></pre>
<p>æ‰§è¡Œåä¼šå‘ç”Ÿä¸¤ä»¶äº‹ï¼š</p>
<ol>
<li>ç”Ÿæˆéšè—ç›®å½• <code>.git</code>ï¼ˆåŒ…å«æ‰€æœ‰ç‰ˆæœ¬ä¿¡æ¯ï¼‰</li>
<li>è‡ªåŠ¨åˆ›å»ºé»˜è®¤åˆ†æ”¯ <code>master</code>ï¼ˆæˆ– <code>main</code>ï¼Œå–å†³äº Git ç‰ˆæœ¬ï¼‰</li>
</ol>
<blockquote>
<p>âš ï¸ <strong>é‡è¦åŸåˆ™</strong>ï¼š<strong>ä¸€ä¸ªé¡¹ç›®åªåº”æœ‰ä¸€ä¸ª Git ä»“åº“</strong>ï¼<br/>
å¤šä¸ªä»“åº“ä¼šå¯¼è‡´ç‰ˆæœ¬æ··ä¹±ï¼Œæ— æ³•ç»Ÿä¸€ç®¡ç†ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-3">ä¸‰ã€æ ¸å¿ƒå·¥ä½œåŒºæ¦‚å¿µï¼ˆå¿…æ‡‚ï¼ï¼‰</h3>
<p>Git æœ‰ä¸‰ä¸ªå…³é”®åŒºåŸŸï¼š</p>

























<table><thead><tr><th>åŒºåŸŸ</th><th>ä½œç”¨</th><th>å‘½ä»¤</th></tr></thead><tbody><tr><td><strong>å·¥ä½œåŒºï¼ˆWorking Directoryï¼‰</strong></td><td>ä½ ç¼–è¾‘çš„æ–‡ä»¶æ‰€åœ¨ä½ç½®</td><td>ç›´æ¥ä¿®æ”¹æ–‡ä»¶</td></tr><tr><td><strong>æš‚å­˜åŒºï¼ˆStaging Areaï¼‰</strong></td><td>ä¸´æ—¶å­˜æ”¾å‡†å¤‡æäº¤çš„ä¿®æ”¹</td><td><code>git add</code></td></tr><tr><td><strong>æœ¬åœ°ä»“åº“ï¼ˆRepositoryï¼‰</strong></td><td>æ°¸ä¹…ä¿å­˜å·²æäº¤çš„ç‰ˆæœ¬</td><td><code>git commit</code></td></tr></tbody></table>
<blockquote>
<p><strong>æµç¨‹</strong>ï¼š<br/>
å·¥ä½œåŒº â†’ <code>git add</code> â†’ æš‚å­˜åŒº â†’ <code>git commit</code> â†’ æœ¬åœ°ä»“åº“</p>
</blockquote>
<hr/>
<h3 data-id="heading-4">å››ã€é«˜é¢‘å‘½ä»¤è¯¦è§£ï¼ˆé™„ä½¿ç”¨åœºæ™¯ï¼‰</h3>
<h4 data-id="heading-5">1. <code>git status</code> â€”â€” ä½ çš„â€œçŠ¶æ€é›·è¾¾â€</h4>
<p><strong>ä½œç”¨</strong>ï¼šæŸ¥çœ‹å½“å‰ä»“åº“çŠ¶æ€ï¼ˆæœ€é‡è¦ï¼å»ºè®®æ¯æ¬¡æ“ä½œå‰éƒ½è¿è¡Œï¼‰</p>
<p>è¾“å‡ºè§£è¯»ï¼š</p>
<ul>
<li><strong>Untracked files</strong>ï¼šæœªè·Ÿè¸ªçš„æ–‡ä»¶ï¼ˆä¸åœ¨æš‚å­˜åŒºï¼‰</li>
<li><strong>Changes not staged for commit</strong>ï¼šå·²ä¿®æ”¹ä½†æœª <code>add</code></li>
<li><strong>Changes to be committed</strong>ï¼šå·²åœ¨æš‚å­˜åŒºï¼Œç­‰å¾… <code>commit</code></li>
</ul>
<blockquote>
<p><strong>å¥½ä¹ æƒ¯</strong>ï¼šä»»ä½•æ“ä½œå‰å…ˆ <code>git status</code>ï¼Œå¿ƒä¸­æœ‰æ•°ï¼</p>
</blockquote>
<hr/>
<h4 data-id="heading-6">2. <code>git add &lt;æ–‡ä»¶&gt;</code> â€”â€” æ·»åŠ åˆ°æš‚å­˜åŒº</h4>
<pre><code class="hljs language-csharp" lang="csharp">git <span class="hljs-keyword">add</span> index.html      <span class="hljs-meta"># æ·»åŠ å•ä¸ªæ–‡ä»¶</span>
git <span class="hljs-keyword">add</span> .               <span class="hljs-meta"># æ·»åŠ æ‰€æœ‰ä¿®æ”¹</span>
</code></pre>
<blockquote>
<p>æš‚å­˜åŒºè®©ä½ <strong>ç²¾ç¡®æ§åˆ¶å“ªäº›ä¿®æ”¹è¿›å…¥ä¸‹ä¸€æ¬¡æäº¤</strong>ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-7">3. <code>git commit -m "è¯´æ˜"</code> â€”â€” æäº¤åˆ°æœ¬åœ°ä»“åº“</h4>
<pre><code class="hljs language-sql" lang="sql">git <span class="hljs-keyword">commit</span> <span class="hljs-operator">-</span>m "æ–°å¢ç”¨æˆ·ç™»å½•åŠŸèƒ½"
</code></pre>
<h5 data-id="heading-8">å…³é”®çŸ¥è¯†ç‚¹ï¼š</h5>
<ul>
<li><strong>æäº¤è¯´æ˜è¦æ¸…æ™°</strong>ï¼æè¿°â€œåšäº†ä»€ä¹ˆâ€ï¼Œè€Œéâ€œæ”¹äº†å“ªé‡Œâ€</li>
<li>æ¯æ¬¡æäº¤ç”Ÿæˆå”¯ä¸€ IDï¼ˆå¦‚ <code>264c229</code>ï¼‰ï¼Œç”± SHA ç®—æ³•ç”Ÿæˆ</li>
<li><strong>ä¸ºä»€ä¹ˆä¸ç”¨ 1,2,3ï¼Ÿ</strong><br/>
â†’ å› ä¸º Git æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå¤šäººåä½œæ—¶è‡ªå¢ ID ä¼šå†²çªï¼Œè€Œ hash ID å…¨å±€å”¯ä¸€ï¼</li>
</ul>
<blockquote>
<p>è¾“å‡ºç¤ºä¾‹ï¼š<br/>
<code>2 insertions(+)</code> è¡¨ç¤ºæœ¬æ¬¡æäº¤æ–°å¢äº† 2 è¡Œä»£ç ã€‚</p>
</blockquote>
<hr/>
<h4 data-id="heading-9">4. <code>git diff</code> â€”â€” æŸ¥çœ‹ä»£ç å·®å¼‚</h4>
<p><strong>ä½œç”¨</strong>ï¼šå¯¹æ¯”<strong>å·¥ä½œåŒº</strong>ä¸<strong>æš‚å­˜åŒº/ä»“åº“</strong>çš„ä»£ç å·®å¼‚</p>
<pre><code class="hljs language-bash" lang="bash">git diff                <span class="hljs-comment"># å·¥ä½œåŒº vs æš‚å­˜åŒº</span>
git diff --cached       <span class="hljs-comment"># æš‚å­˜åŒº vs ä»“åº“</span>
</code></pre>
<blockquote>
<p><strong>å¥½ä¹ æƒ¯</strong>ï¼šé‡å¤§æäº¤å‰å…ˆ <code>git diff</code>ï¼Œç¡®ä¿æ²¡è¯¯æ”¹ï¼</p>
</blockquote>
<hr/>
<h4 data-id="heading-10">5. <code>git log</code> â€”â€” æŸ¥çœ‹æäº¤å†å²</h4>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">log</span>
</code></pre>
<p>è¾“å‡ºåŒ…å«ï¼š</p>
<ul>
<li>æäº¤ IDï¼ˆhashï¼‰</li>
<li>ä½œè€… &amp; æ—¶é—´</li>
<li>æäº¤è¯´æ˜</li>
</ul>
<blockquote>
<p>ç»“åˆ <code>git log --oneline</code> å¯ç®€æ´æŸ¥çœ‹å†å²ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-11">ğŸ”™ äº”ã€ç‰ˆæœ¬å›é€€ä¸æ’¤é”€ï¼ˆæ•‘å‘½æŠ€èƒ½ï¼ï¼‰</h3>
<h4 data-id="heading-12">åœºæ™¯ 1ï¼šåˆšæ”¹äº†ä»£ç ï¼Œæƒ³æ’¤é”€ï¼ˆæœª addï¼‰</h4>
<pre><code class="hljs language-lua" lang="lua">git checkout <span class="hljs-comment">-- æ–‡ä»¶å</span>
</code></pre>
<blockquote>
<ul>
<li>æ•ˆæœï¼šä¸¢å¼ƒå·¥ä½œåŒºä¿®æ”¹ï¼Œæ¢å¤åˆ°æœ€åä¸€æ¬¡æäº¤çŠ¶æ€ã€‚</li>
</ul>
</blockquote>
<hr/>
<h4 data-id="heading-13">åœºæ™¯ 2ï¼šå·² add åˆ°æš‚å­˜åŒºï¼Œæƒ³æ’¤å›</h4>
<pre><code class="hljs language-perl" lang="perl">git <span class="hljs-keyword">reset</span> HEAD æ–‡ä»¶å
</code></pre>
<blockquote>
<ul>
<li>æ•ˆæœï¼šæ–‡ä»¶ä»æš‚å­˜åŒºç§»å‡ºï¼Œå›åˆ°å·¥ä½œåŒºï¼ˆä¿®æ”¹ä¿ç•™ï¼‰ã€‚</li>
</ul>
</blockquote>
<hr/>
<h4 data-id="heading-14">åœºæ™¯ 3ï¼šå·² commitï¼Œæƒ³å›é€€åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬</h4>
<pre><code class="hljs language-perl" lang="perl">git <span class="hljs-keyword">reset</span> --hard HEAD^     <span class="hljs-comment"># å›é€€ 1 ä¸ªç‰ˆæœ¬</span>
git <span class="hljs-keyword">reset</span> --hard HEAD^^    <span class="hljs-comment"># å›é€€ 2 ä¸ªç‰ˆæœ¬</span>
git <span class="hljs-keyword">reset</span> --hard &lt;commit-id&gt;  <span class="hljs-comment"># å›é€€åˆ°æŒ‡å®šç‰ˆæœ¬</span>
</code></pre>
<blockquote>
<ul>
<li><code>--hard</code> ä¼š<strong>ä¸¢å¼ƒæ‰€æœ‰ä¿®æ”¹</strong>ï¼Œæ…ç”¨ï¼</li>
</ul>
</blockquote>
<hr/>
<h4 data-id="heading-15">åœºæ™¯ 4ï¼šä¸å°å¿ƒå›é€€é”™äº†ï¼Ÿæ‰¾å›ä¸¢å¤±çš„ç‰ˆæœ¬ï¼</h4>
<p>Git ä¼šè®°å½•å‡ ä¹æ‰€æœ‰æ“ä½œï¼Œç”¨ <code>reflog</code> æ‰¾å›ï¼š</p>
<pre><code class="hljs">git reflog
</code></pre>
<p>è¾“å‡ºç±»ä¼¼ï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-number">264</span>c229 (HEAD -&gt; master) HEAD@{0}: commit: append GPL
a1b2c3d HEAD@{1}: <span class="hljs-keyword">reset</span>: moving to HEAD^
</code></pre>
<p>æ‰¾åˆ°ä½ è¦çš„ commit IDï¼Œå†ç”¨ <code>git reset --hard &lt;ID&gt;</code> æ¢å¤ï¼</p>
<hr/>
<h3 data-id="heading-16">å…­ã€HEAD æŒ‡é’ˆï¼šç‰ˆæœ¬ç©¿æ¢­çš„å…³é”®</h3>
<ul>
<li><code>HEAD</code> æŒ‡å‘<strong>å½“å‰åˆ†æ”¯çš„æœ€æ–°æäº¤</strong></li>
<li>æ¯æ¬¡ <code>commit</code>ï¼ŒHEAD ä¼šè‡ªåŠ¨å‰ç§»</li>
<li><code>git reset</code> æœ¬è´¨æ˜¯<strong>ç§»åŠ¨ HEAD æŒ‡é’ˆ</strong></li>
</ul>
<blockquote>
<ul>
<li>ä½ å¯ä»¥æŠŠ Git å†å²æƒ³è±¡æˆä¸€æ¡æ—¶é—´çº¿ï¼ŒHEAD å°±æ˜¯ä½ å½“å‰çš„ä½ç½®ã€‚</li>
</ul>
</blockquote>
<hr/>
<h3 data-id="heading-17">ä¸ƒã€æœ€ä½³å®è·µæ€»ç»“</h3>





























<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæ“ä½œ</th></tr></thead><tbody><tr><td>å¼€å§‹æ–°åŠŸèƒ½</td><td>å…ˆ <code>git status</code>ï¼Œç¡®è®¤å¹²å‡€</td></tr><tr><td>æäº¤å‰</td><td><code>git diff</code> æ£€æŸ¥æ”¹åŠ¨</td></tr><tr><td>å†™æäº¤ä¿¡æ¯</td><td>æ¸…æ™°æè¿°â€œåšäº†ä»€ä¹ˆâ€</td></tr><tr><td>ä»£ç å†™å´©</td><td>ç”¨ <code>git reset --hard</code> å›é€€</td></tr><tr><td>è¯¯åˆ æäº¤</td><td>ç”¨ <code>git reflog</code> æ‰¾å›</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-18">é™„ï¼šGit å‘½ä»¤é€ŸæŸ¥è¡¨</h3>

















































<table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>git init</code></td><td>åˆå§‹åŒ–ä»“åº“</td></tr><tr><td><code>git status</code></td><td>æŸ¥çœ‹çŠ¶æ€</td></tr><tr><td><code>git add .</code></td><td>æ·»åŠ æ‰€æœ‰ä¿®æ”¹åˆ°æš‚å­˜åŒº</td></tr><tr><td><code>git commit -m "msg"</code></td><td>æäº¤</td></tr><tr><td><code>git diff</code></td><td>æŸ¥çœ‹å·®å¼‚</td></tr><tr><td><code>git log</code></td><td>æŸ¥çœ‹å†å²</td></tr><tr><td><code>git checkout -- file</code></td><td>æ’¤é”€å·¥ä½œåŒºä¿®æ”¹</td></tr><tr><td><code>git reset HEAD file</code></td><td>æ’¤é”€æš‚å­˜</td></tr><tr><td><code>git reset --hard HEAD^</code></td><td>å›é€€ç‰ˆæœ¬</td></tr><tr><td><code>git reflog</code></td><td>æŸ¥çœ‹æ“ä½œè®°å½•</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-19">ç»“è¯­</h3>
<p>Git ä¸æ˜¯é­”æ³•ï¼Œè€Œæ˜¯ä¸€ç§<strong>å·¥ç¨‹æ€ç»´</strong>ï¼š</p>
<blockquote>
<p><strong>é€šè¿‡ç²¾ç¡®è®°å½•å˜åŒ–ï¼Œè®©æˆ‘ä»¬æ•¢äºå°è¯•ã€ä¸æ€•çŠ¯é”™ã€‚</strong></p>
</blockquote>
<p>æŒæ¡è¿™äº›åŸºç¡€ï¼Œä½ å°±å·²ç»è¶…è¶Šäº† 80% çš„â€œåªä¼šä¸‰æ¿æ–§â€çš„å¼€å‘è€…ã€‚ä¸‹ä¸€æ­¥ï¼Œå¯ä»¥å­¦ä¹ åˆ†æ”¯ç®¡ç†ï¼ˆ<code>git branch</code>ï¼‰ã€è¿œç¨‹åä½œï¼ˆ<code>git push/pull</code>ï¼‰ç­‰è¿›é˜¶å†…å®¹ã€‚</p>
<blockquote>
<p><strong>è®°ä½ï¼šç‰ˆæœ¬æ§åˆ¶ä¸æ˜¯ä¸ºäº†é˜²æ­¢é”™è¯¯ï¼Œè€Œæ˜¯ä¸ºäº†è®©é”™è¯¯å˜å¾—æ— å®³ã€‚</strong></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring Cloud Alibaba+K8S æ— æ„Ÿå‡çº§æ¶æ„æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7595871887001387008</link>    <guid>https://juejin.cn/post/7595871887001387008</guid>    <pubDate>2026-01-17T08:59:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595871887001387008" data-draft-id="7595859552348274740" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring Cloud Alibaba+K8S æ— æ„Ÿå‡çº§æ¶æ„æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-17T08:59:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="wichellåŒå­¦"/> <meta itemprop="url" content="https://juejin.cn/user/729731452645966"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring Cloud Alibaba+K8S æ— æ„Ÿå‡çº§æ¶æ„æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/729731452645966/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    wichellåŒå­¦
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T08:59:42.000Z" title="Sat Jan 17 2026 08:59:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ç¬¬ä¸€éƒ¨åˆ†ï¼šSpring Cloud Alibaba å¾®æœåŠ¡é¡¹ç›® (<code>sc-alibaba-k8s-demo</code>)</h3>
<h4 data-id="heading-1">1. é¡¹ç›®ç»“æ„</h4>
<p>åˆ›å»ºä¸€ä¸ª Maven é¡¹ç›®ï¼Œä¾‹å¦‚å‘½åä¸º <code>sc-alibaba-k8s-demo</code>ã€‚</p>
<pre><code class="hljs language-css" lang="css">sc-alibaba-k8s-demo/
â”œâ”€â”€ pom<span class="hljs-selector-class">.xml</span>
â””â”€â”€ <span class="hljs-attribute">src</span>/
    â””â”€â”€ <span class="hljs-selector-tag">main</span>/
        â”œâ”€â”€ java/
        â”‚   â””â”€â”€ com/
        â”‚       â””â”€â”€ example/
        â”‚           â””â”€â”€ scalibaba/
        â”‚               â”œâ”€â”€ ScAlibabaK8sDemoApplication<span class="hljs-selector-class">.java</span>
        â”‚               â””â”€â”€ controller/
        â”‚                   â””â”€â”€ DemoController<span class="hljs-selector-class">.java</span>
        â””â”€â”€ resources/
            â””â”€â”€ application<span class="hljs-selector-class">.yml</span>
</code></pre>
<h4 data-id="heading-2">2. <code>pom.xml</code></h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.1.5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span> <span class="hljs-comment">&lt;!-- ä½¿ç”¨ Spring Boot 3.x ä»¥è·å¾—æœ€æ–°çš„ä¼˜é›…åœæœºæ”¯æŒ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span> <span class="hljs-comment">&lt;!-- lookup parent from repository --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.example<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>sc-alibaba-k8s-demo<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>sc-alibaba-k8s-demo<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span>Demo project for Spring Cloud Alibaba K8s Graceful Shutdown<span class="hljs-tag">&lt;/<span class="hljs-name">description</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">java.version</span>&gt;</span>17<span class="hljs-tag">&lt;/<span class="hljs-name">java.version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">spring-cloud.version</span>&gt;</span>2022.0.4<span class="hljs-tag">&lt;/<span class="hljs-name">spring-cloud.version</span>&gt;</span> <span class="hljs-comment">&lt;!-- å¯¹åº” Spring Boot 3.1.x --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">spring-cloud-alibaba.version</span>&gt;</span>2022.0.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">spring-cloud-alibaba.version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${spring-cloud.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-alibaba-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${spring-cloud-alibaba.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span>
</code></pre>
<h4 data-id="heading-3">3. <code>src/main/java/com/example/scalibaba/ScAlibabaK8sDemoApplication.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.scalibaba;

<span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;
<span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;
<span class="hljs-keyword">import</span> org.springframework.cloud.client.discovery.EnableDiscoveryClient;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;

<span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-meta">@EnableDiscoveryClient</span>
<span class="hljs-meta">@RestController</span> <span class="hljs-comment">// æ·»åŠ RestControlleræ³¨è§£ï¼Œè¿™æ ·å¯ä»¥ç›´æ¥åœ¨è¿™é‡Œå®šä¹‰ç®€å•çš„æ¥å£</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ScAlibabaK8sDemoApplication</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">instanceId</span> <span class="hljs-operator">=</span> java.util.UUID.randomUUID().toString().substring(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>); <span class="hljs-comment">// ç”¨äºåŒºåˆ†ä¸åŒçš„Podå®ä¾‹</span>

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        SpringApplication.run(ScAlibabaK8sDemoApplication.class, args);
    }

    <span class="hljs-meta">@GetMapping("/hello")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"Instance "</span> + instanceId + <span class="hljs-string">" received /hello request."</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello from Spring Cloud Alibaba K8s Demo (Instance: "</span> + instanceId + <span class="hljs-string">")!"</span>;
    }

    <span class="hljs-meta">@GetMapping("/slow-hello")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">slowHello</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"Instance "</span> + instanceId + <span class="hljs-string">" received /slow-hello request. Starting 20s processing..."</span>);
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// æ¨¡æ‹Ÿä¸€ä¸ªè€—æ—¶æ“ä½œï¼Œä¾‹å¦‚æ•°æ®åº“æŸ¥è¯¢ã€RPCè°ƒç”¨ç­‰</span>
            Thread.sleep(<span class="hljs-number">20</span> * <span class="hljs-number">1000</span>); <span class="hljs-comment">// 20ç§’</span>
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            Thread.currentThread().interrupt();
            System.out.println(<span class="hljs-string">"Instance "</span> + instanceId + <span class="hljs-string">" /slow-hello interrupted."</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-string">"Slow hello interrupted by instance "</span> + instanceId;
        }
        System.out.println(<span class="hljs-string">"Instance "</span> + instanceId + <span class="hljs-string">" finished /slow-hello request."</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Slow Hello finished from Spring Cloud Alibaba K8s Demo (Instance: "</span> + instanceId + <span class="hljs-string">")!"</span>;
    }
}
</code></pre>
<h4 data-id="heading-4">4. <code>src/main/resources/application.yml</code></h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>
  <span class="hljs-attr">shutdown:</span> <span class="hljs-string">graceful</span> <span class="hljs-comment"># å¯ç”¨ä¼˜é›…åœæœº</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">application:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">sc-alibaba-k8s-demo</span>
  <span class="hljs-attr">cloud:</span>
    <span class="hljs-attr">nacos:</span>
      <span class="hljs-attr">discovery:</span>
        <span class="hljs-attr">server-addr:</span> <span class="hljs-string">nacos-service:8848</span> <span class="hljs-comment"># æŒ‡å®š Nacos Server åœ°å€ï¼Œä½¿ç”¨ K8s Service Name</span>
        <span class="hljs-comment"># æ›´å¤šNacosé…ç½®å¯ä»¥æŒ‰éœ€æ·»åŠ ï¼Œä¾‹å¦‚å‘½åç©ºé—´ç­‰</span>
  <span class="hljs-attr">lifecycle:</span>
    <span class="hljs-attr">timeout-per-shutdown-phase:</span> <span class="hljs-string">60s</span> <span class="hljs-comment"># ä¼˜é›…åœæœºé˜¶æ®µçš„è¶…æ—¶æ—¶é—´ï¼Œå»ºè®®æ¯”æœ€é•¿è¯·æ±‚æ—¶é—´é•¿</span>
  <span class="hljs-attr">profiles:</span>
    <span class="hljs-attr">active:</span> <span class="hljs-string">dev</span> <span class="hljs-comment"># æ˜ç¡®æ¿€æ´»ä¸€ä¸ªprofile</span>
<span class="hljs-attr">management:</span>
  <span class="hljs-attr">endpoints:</span>
    <span class="hljs-attr">web:</span>
      <span class="hljs-attr">exposure:</span>
        <span class="hljs-attr">include:</span> <span class="hljs-string">"*"</span> <span class="hljs-comment"># æš´éœ²æ‰€æœ‰Actuatorç«¯ç‚¹</span>
  <span class="hljs-attr">endpoint:</span>
    <span class="hljs-attr">health:</span>
      <span class="hljs-attr">show-details:</span> <span class="hljs-string">always</span> <span class="hljs-comment"># åœ¨å¥åº·æ£€æŸ¥ä¸­æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯</span>
      <span class="hljs-attr">livenessstate:</span>
        <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>
      <span class="hljs-attr">readinessstate:</span>
        <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">logging:</span>
  <span class="hljs-attr">level:</span>
    <span class="hljs-attr">root:</span> <span class="hljs-string">INFO</span>
    <span class="hljs-attr">org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext:</span> <span class="hljs-string">INFO</span>
    <span class="hljs-comment"># å¢åŠ æ—¥å¿—ï¼ŒæŸ¥çœ‹ä¼˜é›…åœæœºè¿‡ç¨‹ä¸­çš„è¿æ¥å…³é—­ä¿¡æ¯</span>
    <span class="hljs-attr">org.apache.coyote.AbstractProtocol:</span> <span class="hljs-string">DEBUG</span>
    <span class="hljs-attr">org.springframework.web.servlet.DispatcherServlet:</span> <span class="hljs-string">DEBUG</span>
</code></pre>
<p>è¿™ä¸ª <code>application.yml</code> æ–‡ä»¶å¼€å¯äº†ä¼˜é›…åœæœºï¼Œè®¾ç½®äº†è¾ƒé•¿çš„åœæœºè¶…æ—¶æ—¶é—´ä»¥ç¡®ä¿æ…¢è¯·æ±‚å¯ä»¥å®Œæˆã€‚<code>nacos.discovery.server-addr</code> é…ç½®æŒ‡å‘äº†æˆ‘ä»¬ç¨åå°†åœ¨ Kubernetes ä¸­éƒ¨ç½²çš„ Nacos Serviceã€‚</p>
<h3 data-id="heading-5">ç¬¬äºŒéƒ¨åˆ†ï¼šDocker é…ç½®</h3>
<h4 data-id="heading-6">1. <code>Dockerfile</code></h4>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º <code>Dockerfile</code> æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-dockerfile" lang="dockerfile"># ä½¿ç”¨å®˜æ–¹çš„ Java é•œåƒä½œä¸ºåŸºç¡€é•œåƒ
FROM openjdk:17-jdk-slim

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å°† Maven æ„å»ºçš„ JAR æ–‡ä»¶å¤åˆ¶åˆ°å®¹å™¨ä¸­
# æ³¨æ„ï¼šä½ éœ€è¦å…ˆæ‰§è¡Œ `mvn clean package` æ¥ç”Ÿæˆè¿™ä¸ª JAR æ–‡ä»¶
COPY target/sc-alibaba-k8s-demo-0.0.1-SNAPSHOT.jar app.jar

# æš´éœ²åº”ç”¨ç¨‹åºçš„ç«¯å£
EXPOSE 8080

# å®šä¹‰å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œçš„å‘½ä»¤
# `-Djava.security.egd=file:/dev/./urandom` ç”¨äºæé«˜éšæœºæ•°ç”Ÿæˆé€Ÿåº¦ï¼Œé¿å…å¯åŠ¨æ…¢
# `-Dserver.port=8080` æ˜ç¡®æŒ‡å®šç«¯å£ï¼ŒDockerfile EXPOSE åªæ˜¯å£°æ˜ï¼Œä½†å®é™…ä½¿ç”¨è¿˜æ˜¯é…ç½®å†³å®š
ENTRYPOINT ["java", "-Djava.security.egd=file:/dev/./urandom", "-jar", "app.jar"]
</code></pre>
<h3 data-id="heading-7">ç¬¬ä¸‰éƒ¨åˆ†ï¼šKubernetes éƒ¨ç½²æ–‡ä»¶</h3>
<p>ä¸ºäº†åœ¨ Kubernetes ä¸­è¿è¡Œæˆ‘ä»¬çš„åº”ç”¨ï¼Œæˆ‘ä»¬éœ€è¦ï¼š</p>
<ol>
<li><strong>éƒ¨ç½² Nacos Server</strong>: Spring Cloud Alibaba åº”ç”¨éœ€è¦ Nacos ä½œä¸ºæœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚</li>
<li><strong>éƒ¨ç½²æˆ‘ä»¬çš„åº”ç”¨</strong>: åŒ…å« Deployment å’Œ Serviceã€‚</li>
</ol>
<h4 data-id="heading-8">1. Nacos Kubernetes éƒ¨ç½² (<code>nacos-kubernetes.yaml</code>)</h4>
<p>(ä¸ºäº†æµ‹è¯•çš„ä¾¿æ·æ€§ï¼Œè¿™é‡Œéƒ¨ç½²å•å®ä¾‹ Nacosã€‚ç”Ÿäº§ç¯å¢ƒè¯·éƒ¨ç½²é«˜å¯ç”¨ Nacos é›†ç¾¤ã€‚)</p>
<p>å°†ä»¥ä¸‹å†…å®¹ä¿å­˜ä¸º <code>nacos-kubernetes.yaml</code>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">nacos-server</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">nacos</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">matchLabels:</span>
      <span class="hljs-attr">app:</span> <span class="hljs-string">nacos</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">metadata:</span>
      <span class="hljs-attr">labels:</span>
        <span class="hljs-attr">app:</span> <span class="hljs-string">nacos</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">nacos</span>
        <span class="hljs-attr">image:</span> <span class="hljs-string">nacos/nacos-server:2.2.0</span> <span class="hljs-comment"># ä½¿ç”¨ Nacos å®˜æ–¹é•œåƒ</span>
        <span class="hljs-attr">ports:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span> <span class="hljs-number">8848</span> <span class="hljs-comment"># client port</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span> <span class="hljs-number">9848</span> <span class="hljs-comment"># raft port</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span> <span class="hljs-number">9849</span> <span class="hljs-comment"># raft port</span>
        <span class="hljs-attr">env:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">MODE</span>
          <span class="hljs-attr">value:</span> <span class="hljs-string">"standalone"</span> <span class="hljs-comment"># å•æœºæ¨¡å¼</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">JVM_XMS</span> <span class="hljs-comment"># è°ƒæ•´ JVM å†…å­˜ï¼Œå¦‚æœèµ„æºä¸è¶³å¯ä»¥ç¨å¾®è°ƒå°</span>
          <span class="hljs-attr">value:</span> <span class="hljs-string">"256m"</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">JVM_XMX</span>
          <span class="hljs-attr">value:</span> <span class="hljs-string">"256m"</span>
        <span class="hljs-comment"># ç¡®ä¿ Nacos å¯åŠ¨åå¯ä»¥å“åº”å¥åº·æ£€æŸ¥</span>
        <span class="hljs-attr">livenessProbe:</span>
          <span class="hljs-attr">httpGet:</span>
            <span class="hljs-attr">path:</span> <span class="hljs-string">/nacos/actuator/health</span>
            <span class="hljs-attr">port:</span> <span class="hljs-number">8848</span>
          <span class="hljs-attr">initialDelaySeconds:</span> <span class="hljs-number">30</span>
          <span class="hljs-attr">periodSeconds:</span> <span class="hljs-number">10</span>
        <span class="hljs-attr">readinessProbe:</span>
          <span class="hljs-attr">httpGet:</span>
            <span class="hljs-attr">path:</span> <span class="hljs-string">/nacos/actuator/health</span>
            <span class="hljs-attr">port:</span> <span class="hljs-number">8848</span>
          <span class="hljs-attr">initialDelaySeconds:</span> <span class="hljs-number">20</span>
          <span class="hljs-attr">periodSeconds:</span> <span class="hljs-number">10</span>
        <span class="hljs-attr">volumeMounts:</span> <span class="hljs-comment"># æŒä¹…åŒ– Nacos æ•°æ®</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">nacos-storage</span>
          <span class="hljs-attr">mountPath:</span> <span class="hljs-string">/home/nacos/data</span>
      <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">nacos-storage</span>
        <span class="hljs-attr">emptyDir:</span> {} <span class="hljs-comment"># ç®€å•èµ·è§ä½¿ç”¨ emptyDirï¼Œç”Ÿäº§ç¯å¢ƒè¯·ä½¿ç”¨ PersistentVolume/PersistentVolumeClaim</span>

<span class="hljs-meta">---</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">nacos-service</span> <span class="hljs-comment"># è¿™ä¸ªåå­—è¦å’Œ application.yml ä¸­çš„ server-addr åŒ¹é…</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">nacos</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">ports:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">8848</span>
    <span class="hljs-attr">targetPort:</span> <span class="hljs-number">8848</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">client</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">9848</span>
    <span class="hljs-attr">targetPort:</span> <span class="hljs-number">9848</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">raft-http</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">9849</span>
    <span class="hljs-attr">targetPort:</span> <span class="hljs-number">9849</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">raft-grpc</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">nacos</span>
  <span class="hljs-attr">type:</span> <span class="hljs-string">ClusterIP</span> <span class="hljs-comment"># å†…éƒ¨æœåŠ¡ï¼Œé›†ç¾¤å†…è®¿é—®</span>
</code></pre>
<h4 data-id="heading-9">2. å¾®æœåŠ¡ Kubernetes éƒ¨ç½² (<code>app-kubernetes.yaml</code>)</h4>
<p>å°†ä»¥ä¸‹å†…å®¹ä¿å­˜ä¸º <code>app-kubernetes.yaml</code>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">sc-alibaba-k8s-demo-deployment</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">sc-alibaba-k8s-demo</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span> <span class="hljs-comment"># éƒ¨ç½²3ä¸ªå®ä¾‹ï¼Œæ–¹ä¾¿è§‚å¯Ÿæ»šåŠ¨å‡çº§</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">matchLabels:</span>
      <span class="hljs-attr">app:</span> <span class="hljs-string">sc-alibaba-k8s-demo</span>
  <span class="hljs-attr">strategy:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">RollingUpdate</span> <span class="hljs-comment"># é»˜è®¤å°±æ˜¯RollingUpdateï¼Œè¿™é‡Œæ˜¾å¼å£°æ˜</span>
    <span class="hljs-attr">rollingUpdate:</span>
      <span class="hljs-attr">maxSurge:</span> <span class="hljs-number">1</span> <span class="hljs-comment"># æœ€å¤šå…è®¸æ¯”æœŸæœ›æ•°é‡å¤šä¸€ä¸ªPod</span>
      <span class="hljs-attr">maxUnavailable:</span> <span class="hljs-number">0</span> <span class="hljs-comment"># æœ€å¤šå…è®¸æœ‰0ä¸ªPodä¸å¯ç”¨ (è¿™æ˜¯ç¡®ä¿é›¶åœæœºçš„å…³é”®)</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">metadata:</span>
      <span class="hljs-attr">labels:</span>
        <span class="hljs-attr">app:</span> <span class="hljs-string">sc-alibaba-k8s-demo</span>
        <span class="hljs-attr">version:</span> <span class="hljs-string">v1.0.0</span> <span class="hljs-comment"># ç”¨äºåŒºåˆ†ç‰ˆæœ¬ï¼Œæ–¹ä¾¿å‡çº§</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">terminationGracePeriodSeconds:</span> <span class="hljs-number">120</span> <span class="hljs-comment"># å…è®¸Podæœ€é•¿120ç§’å…³é—­ï¼Œè¦å¤§äº preStop hook + graceful shutdown timeout</span>
      <span class="hljs-attr">containers:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">sc-alibaba-k8s-demo</span>
        <span class="hljs-attr">image:</span> <span class="hljs-string">sc-alibaba-k8s-demo:v1.0.0</span> <span class="hljs-comment"># åˆå§‹é•œåƒç‰ˆæœ¬ï¼Œéœ€è¦æœ¬åœ°æ„å»º</span>
        <span class="hljs-attr">imagePullPolicy:</span> <span class="hljs-string">IfNotPresent</span> <span class="hljs-comment"># å¦‚æœæœ¬åœ°æœ‰å°±ä¸æ‹‰å–</span>
        <span class="hljs-attr">ports:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span> <span class="hljs-number">8080</span>
        <span class="hljs-attr">livenessProbe:</span> <span class="hljs-comment"># å­˜æ´»æ¢é’ˆï¼Œæ£€æµ‹åº”ç”¨æ˜¯å¦è¿˜æ´»ç€ï¼Œå¤±è´¥åˆ™é‡å¯Pod</span>
          <span class="hljs-attr">httpGet:</span>
            <span class="hljs-attr">path:</span> <span class="hljs-string">/actuator/health/liveness</span>
            <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>
          <span class="hljs-attr">initialDelaySeconds:</span> <span class="hljs-number">15</span> <span class="hljs-comment"># åˆå§‹å»¶è¿Ÿ</span>
          <span class="hljs-attr">periodSeconds:</span> <span class="hljs-number">10</span> <span class="hljs-comment"># æ¯10ç§’æ£€æŸ¥ä¸€æ¬¡</span>
          <span class="hljs-attr">timeoutSeconds:</span> <span class="hljs-number">3</span>
          <span class="hljs-attr">failureThreshold:</span> <span class="hljs-number">3</span>
        <span class="hljs-attr">readinessProbe:</span> <span class="hljs-comment"># å°±ç»ªæ¢é’ˆï¼Œæ£€æµ‹åº”ç”¨æ˜¯å¦å¯ä»¥æ¥æ”¶æµé‡ï¼Œå¤±è´¥åˆ™ä»Serviceä¸­ç§»é™¤</span>
          <span class="hljs-attr">httpGet:</span>
            <span class="hljs-attr">path:</span> <span class="hljs-string">/actuator/health/readiness</span>
            <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>
          <span class="hljs-attr">initialDelaySeconds:</span> <span class="hljs-number">30</span> <span class="hljs-comment"># åˆå§‹å»¶è¿Ÿï¼Œç¡®ä¿åº”ç”¨å®Œå…¨å¯åŠ¨å¹¶æ³¨å†ŒNacosåæ‰Ready</span>
          <span class="hljs-attr">periodSeconds:</span> <span class="hljs-number">10</span>
          <span class="hljs-attr">timeoutSeconds:</span> <span class="hljs-number">3</span>
          <span class="hljs-attr">failureThreshold:</span> <span class="hljs-number">3</span>
        <span class="hljs-attr">lifecycle:</span>
          <span class="hljs-attr">preStop:</span> <span class="hljs-comment"># åœ¨å‘é€ TERM ä¿¡å·å‰æ‰§è¡Œï¼Œç»™ K8s å’Œè´Ÿè½½å‡è¡¡å™¨è¶³å¤Ÿæ—¶é—´ç§»é™¤ Pod</span>
            <span class="hljs-attr">exec:</span>
              <span class="hljs-attr">command:</span> [<span class="hljs-string">"/bin/sh"</span>, <span class="hljs-string">"-c"</span>, <span class="hljs-string">"echo 'PreStop hook: Sleeping for 60 seconds to allow clients to drain and K8s to update endpoints.' &amp;&amp; sleep 60"</span>]
              <span class="hljs-comment"># è¿™ä¸ª sleep æ—¶é—´åº”è¯¥è¶³å¤Ÿé•¿ï¼Œä»¥ç¡®ä¿ï¼š</span>
              <span class="hljs-comment"># 1. K8s å°†æ­¤ Pod ä» Service Endpoint åˆ—è¡¨ç§»é™¤ã€‚</span>
              <span class="hljs-comment"># 2. å¦‚æœä½¿ç”¨å¤–éƒ¨è´Ÿè½½å‡è¡¡ (å¦‚ Ingress Controller, LoadBalancer)ï¼Œå®ƒä»¬æœ‰æ—¶é—´æ›´æ–°è·¯ç”±ã€‚</span>
              <span class="hljs-comment"># 3. Nacos ä¸Šçš„æœ¬å®ä¾‹æœ‰è¶³å¤Ÿæ—¶é—´è¢«Service Registryç§»é™¤ (é€šå¸¸æ˜¯è‡ªåŠ¨çš„ï¼Œä½†å»¶è¿Ÿå¯ä»¥è¾…åŠ©)ã€‚</span>

<span class="hljs-meta">---</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">sc-alibaba-k8s-demo-service</span> <span class="hljs-comment"># å¤–éƒ¨è®¿é—®çš„æœåŠ¡å</span>
  <span class="hljs-attr">labels:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">sc-alibaba-k8s-demo</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">type:</span> <span class="hljs-string">LoadBalancer</span> <span class="hljs-comment"># æˆ–è€… NodePortï¼Œå…·ä½“å–å†³äºä½ çš„æœ¬åœ° K8s ç¯å¢ƒæ”¯æŒ</span>
  <span class="hljs-attr">ports:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">80</span>
    <span class="hljs-attr">targetPort:</span> <span class="hljs-number">8080</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">sc-alibaba-k8s-demo</span>
</code></pre>
<p><strong><code>maxUnavailable: 0</code> å’Œ <code>maxSurge: 1</code> ç­–ç•¥è§£é‡Šï¼š</strong></p>
<ul>
<li><code>maxUnavailable: 0</code>ï¼šåœ¨å‡çº§è¿‡ç¨‹ä¸­ï¼Œä»»ä½•æ—¶å€™éƒ½ä¸èƒ½æœ‰æ—§ç‰ˆæœ¬çš„ Pod ä¸å¯ç”¨ã€‚è¿™æ„å‘³ç€ Kubernetes åœ¨å¯åŠ¨å¹¶ä½¿ä¸€ä¸ªæ–° Pod å°±ç»ªä¹‹å‰ï¼Œä¸ä¼šåœæ­¢ä»»ä½•æ—§ Podã€‚</li>
<li><code>maxSurge: 1</code>ï¼šå…è®¸çš„ Pod æ•°é‡æ¯”æœŸæœ›çš„ <code>replicas</code> æ•°é‡å¤šä¸€ä¸ªã€‚è¿™æ„å‘³ç€åœ¨å‡çº§å¼€å§‹æ—¶ï¼ŒKubernetes ä¼šå…ˆåˆ›å»ºä¸€ä¸ªæ–° Podï¼Œå½“è¿™ä¸ªæ–° Pod æˆåŠŸå¯åŠ¨å¹¶å°±ç»ªåï¼Œå®ƒæ‰ä¼šç§»é™¤ä¸€ä¸ªæ—§ Podã€‚</li>
</ul>
<p>è¿™ä¸ªç»„åˆç¡®ä¿äº†åœ¨å‡çº§çš„ä»»ä½•é˜¶æ®µï¼ŒæœåŠ¡å®ä¾‹æ•°é‡éƒ½ä¸ä¼šä½äºæœŸæœ›å€¼ï¼Œä»è€Œå®ç°é›¶åœæœºã€‚</p>
<h3 data-id="heading-10">ç¬¬å››éƒ¨åˆ†ï¼šæµ‹è¯•éªŒè¯æ­¥éª¤</h3>
<p>è¯·ç¡®ä¿æ‚¨çš„ Docker Desktop/Minikube Kubernetes ç¯å¢ƒå·²å¯åŠ¨ã€‚</p>
<h4 data-id="heading-11">1. éƒ¨ç½² Nacos Server</h4>
<pre><code class="hljs language-bash" lang="bash">kubectl apply -f nacos-kubernetes.yaml
</code></pre>
<p>ç­‰å¾… Nacos Pod å¯åŠ¨å¹¶è¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">kubectl get pods -l app=nacos -w
<span class="hljs-comment"># çœ‹åˆ° nacos-server-xxxxx-yyyyy   1/1     Running å°±ç»ª</span>
</code></pre>
<h4 data-id="heading-12">2. æ„å»ºå¹¶æ¨é€ Docker é•œåƒ</h4>
<p>è¿›å…¥ <code>sc-alibaba-k8s-demo</code> é¡¹ç›®æ ¹ç›®å½•ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ¸…ç†å¹¶æ‰“åŒ… Spring Boot åº”ç”¨ä¸º JAR</span>
mvn clean package

<span class="hljs-comment"># 2. æ„å»º Docker é•œåƒ (ç‰ˆæœ¬å‘½åä¸º v1.0.0)</span>
docker build -t sc-alibaba-k8s-demo:v1.0.0 .

<span class="hljs-comment"># 3. éªŒè¯é•œåƒæ˜¯å¦ç”Ÿæˆ</span>
docker images | grep sc-alibaba-k8s-demo
</code></pre>
<p>å¦‚æœæ‚¨çš„ Kubernetes æ˜¯ Docker Desktop å†…ç½®çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªé•œåƒå°±ä¼šè‡ªåŠ¨åœ¨ K8s ç¯å¢ƒä¸­å¯ç”¨ã€‚å¦‚æœæ˜¯ Minikubeï¼Œæ‚¨å¯èƒ½éœ€è¦ï¼š<code>minikube docker-env</code> ç„¶å <code>eval $(minikube docker-env)</code>ï¼Œå†è¿›è¡Œ <code>docker build</code>ã€‚</p>
<h4 data-id="heading-13">3. éƒ¨ç½²å¾®æœåŠ¡åº”ç”¨ v1.0.0</h4>
<pre><code class="hljs language-bash" lang="bash">kubectl apply -f app-kubernetes.yaml
</code></pre>
<p>ç­‰å¾…åº”ç”¨ Pod å¯åŠ¨å¹¶è¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">kubectl get pods -l app=sc-alibaba-k8s-demo -w
<span class="hljs-comment"># çœ‹åˆ°æ‰€æœ‰ Pod éƒ½æ˜¯ Running çŠ¶æ€ (3/3)</span>
</code></pre>
<p>è·å– Service çš„å¤–éƒ¨ IP/ç«¯å£ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">kubectl get svc sc-alibaba-k8s-demo-service
<span class="hljs-comment"># æŸ¥æ‰¾ EXTERNAL-IP å’Œ PORT</span>
<span class="hljs-comment"># å¦‚æœæ˜¯ Docker Desktopï¼Œé€šå¸¸ EXTERNAL-IP æ˜¯ localhostï¼ŒNodePort ä¹Ÿä¼šæœ‰</span>
<span class="hljs-comment"># ä¾‹å¦‚ï¼šlocalhost:30000 è¿™æ ·çš„ï¼Œæˆ–è€…ç›´æ¥æ˜¯ LoadBalancer æš´éœ²çš„ç«¯å£</span>
</code></pre>
<p>å‡è®¾ Service æš´éœ²åœ¨ <code>localhost:80</code> (å¦‚æœæ˜¯ NodePortï¼Œåˆ™å¯èƒ½æ˜¯ <code>&lt;minikube-ip&gt;:&lt;node-port&gt;</code>)ã€‚</p>
<p>è®¿é—® <code>/hello</code> æ¥å£éªŒè¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">curl http://localhost:80/hello
<span class="hljs-comment"># åº”è¯¥ä¼šçœ‹åˆ°æ¥è‡ªä¸åŒå®ä¾‹çš„ "Hello..." å“åº”</span>
</code></pre>
<h4 data-id="heading-14">4. å‡†å¤‡å‡çº§ç‰ˆæœ¬ v2.0.0</h4>
<p>æˆ‘ä»¬å°†æ¨¡æ‹Ÿå¯¹åº”ç”¨ä»£ç çš„ä¿®æ”¹ï¼Œç„¶åé‡æ–°æ‰“åŒ…å’Œéƒ¨ç½²ã€‚</p>
<h5 data-id="heading-15">ä¿®æ”¹ä»£ç ï¼š</h5>
<p>ç®€å•ä¿®æ”¹ <code>ScAlibabaK8sDemoApplication.java</code> çš„ <code>/hello</code> æ¥å£ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-meta">@GetMapping("/hello")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">()</span> {
        System.out.println(<span class="hljs-string">"Instance "</span> + instanceId + <span class="hljs-string">" received /hello request. (v2.0.0)"</span>); <span class="hljs-comment">// æ·»åŠ ç‰ˆæœ¬ä¿¡æ¯</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello from Spring Cloud Alibaba K8s Demo (v2.0.0, Instance: "</span> + instanceId + <span class="hljs-string">")!"</span>; <span class="hljs-comment">// æ·»åŠ ç‰ˆæœ¬ä¿¡æ¯</span>
    }
</code></pre>
<h5 data-id="heading-16">é‡æ–°æ„å»º JAR å’Œ Docker é•œåƒï¼š</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ¸…ç†å¹¶é‡æ–°æ‰“åŒ… Spring Boot åº”ç”¨ä¸º JAR</span>
mvn clean package

<span class="hljs-comment"># 2. æ„å»º Docker é•œåƒ (ç‰ˆæœ¬å‘½åä¸º v2.0.0)</span>
docker build -t sc-alibaba-k8s-demo:v2.0.0 .
</code></pre>
<h4 data-id="heading-17">5. æ‰§è¡Œæ»šåŠ¨å‡çº§å¹¶éªŒè¯æ— æ„Ÿ</h4>
<p><strong>ç°åœ¨æ˜¯å…³é”®æ­¥éª¤ã€‚</strong></p>
<h5 data-id="heading-18">5.1. æŒç»­å‘é€è¯·æ±‚ï¼ˆæ¨¡æ‹Ÿå‰ç«¯è®¿é—®ï¼‰</h5>
<p>æ‰“å¼€ä¸¤ä¸ªç»ˆç«¯çª—å£ï¼š</p>
<p><strong>ç»ˆç«¯ 1 (å‘é€æ…¢è¯·æ±‚):</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¾ªç¯å‘é€æ…¢è¯·æ±‚ï¼Œè§‚å¯Ÿå“ªä¸ªå®ä¾‹å¤„ç†äº†è¯·æ±‚</span>
<span class="hljs-comment"># æ³¨æ„ï¼šç¬¬ä¸€æ¬¡è¯·æ±‚éœ€è¦ç­‰å¾…20ç§’æ‰èƒ½çœ‹åˆ°ç»“æœ</span>
<span class="hljs-keyword">while</span> <span class="hljs-literal">true</span>; <span class="hljs-keyword">do</span> curl http://localhost:80/slow-hello; <span class="hljs-built_in">echo</span>; <span class="hljs-built_in">sleep</span> 1; <span class="hljs-keyword">done</span>
</code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šæŒç»­å‘æœåŠ¡å‘é€æ…¢è¯·æ±‚ã€‚å½“ä¸€ä¸ª Pod æ¥æ”¶åˆ° <code>TERM</code> ä¿¡å·å‡†å¤‡å…³é—­æ—¶ï¼Œå¦‚æœå®ƒæ­£åœ¨å¤„ç†è¿™æ ·çš„æ…¢è¯·æ±‚ï¼Œå®ƒåº”è¯¥<strong>å®Œæˆ</strong>è¿™ä¸ªè¯·æ±‚ï¼Œè€Œä¸æ˜¯ä¸­æ–­ã€‚</p>
<p><strong>ç»ˆç«¯ 2 (å‘é€å¿«è¯·æ±‚):</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¾ªç¯å‘é€å¿«è¯·æ±‚ï¼Œè§‚å¯ŸæœåŠ¡æ˜¯å¦æŒç»­å¯ç”¨ï¼Œä»¥åŠç‰ˆæœ¬åˆ‡æ¢æƒ…å†µ</span>
<span class="hljs-keyword">while</span> <span class="hljs-literal">true</span>; <span class="hljs-keyword">do</span> curl http://localhost:80/hello; <span class="hljs-built_in">echo</span>; <span class="hljs-built_in">sleep</span> 0.1; <span class="hljs-keyword">done</span>
</code></pre>
<p>è¿™ä¸ªå‘½ä»¤ä¼šé«˜é¢‘æ¬¡åœ°å‘æœåŠ¡å‘é€å¿«è¯·æ±‚ã€‚åœ¨æ»šåŠ¨å‡çº§è¿‡ç¨‹ä¸­ï¼Œæ‚¨åº”è¯¥å§‹ç»ˆçœ‹åˆ°æˆåŠŸå“åº”ï¼Œå¹¶ä¸”é€æ¸åœ°ï¼Œå“åº”ä¸­çš„ç‰ˆæœ¬ä¿¡æ¯ä¼šä» <code>v1.0.0</code> å˜ä¸º <code>v2.0.0</code>ï¼Œè€Œä¸ä¼šå‡ºç°è¿æ¥é”™è¯¯æˆ–æœåŠ¡ä¸­æ–­ã€‚</p>
<h5 data-id="heading-19">5.2. åœ¨ Kubernetes ä¸­æ‰§è¡Œå‡çº§</h5>
<p>åœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¿®æ”¹ <code>app-kubernetes.yaml</code>ï¼Œå°† <code>image: sc-alibaba-k8s-demo:v1.0.0</code> æ”¹ä¸º <code>image: sc-alibaba-k8s-demo:v2.0.0</code>ï¼Œå¹¶å°† <code>template.metadata.labels.version</code> ä¹Ÿæ”¹ä¸º <code>v2.0.0</code>ã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># ... (app-kubernetes.yaml éƒ¨åˆ†å†…å®¹)</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">metadata:</span>
      <span class="hljs-attr">labels:</span>
        <span class="hljs-attr">app:</span> <span class="hljs-string">sc-alibaba-k8s-demo</span>
        <span class="hljs-attr">version:</span> <span class="hljs-string">v2.0.0</span> <span class="hljs-comment"># &lt;--- ä¿®æ”¹ä¸º v2.0.0</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">terminationGracePeriodSeconds:</span> <span class="hljs-number">120</span>
      <span class="hljs-attr">containers:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">sc-alibaba-k8s-demo</span>
        <span class="hljs-attr">image:</span> <span class="hljs-string">sc-alibaba-k8s-demo:v2.0.0</span> <span class="hljs-comment"># &lt;--- ä¿®æ”¹ä¸º v2.0.0</span>
<span class="hljs-comment"># ...</span>
</code></pre>
<p>ç„¶ååº”ç”¨æ›´æ–°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">kubectl apply -f app-kubernetes.yaml
</code></pre>
<h5 data-id="heading-20">5.3. è§‚å¯Ÿå’ŒéªŒè¯</h5>
<p>æ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯çª—å£ï¼š</p>
<p><strong>ç»ˆç«¯ 3 (è§‚å¯Ÿ Pod ç”Ÿå‘½å‘¨æœŸ):</strong></p>
<pre><code class="hljs language-bash" lang="bash">kubectl get pods -w -l app=sc-alibaba-k8s-demo
</code></pre>
<p>æ‚¨å°†çœ‹åˆ°ä»¥ä¸‹ç°è±¡ï¼š</p>
<ol>
<li>ä¸€ä¸ªæ–°çš„ <code>v2.0.0</code> Pod ä¼šè¢«åˆ›å»ºã€‚</li>
<li>è¿™ä¸ªæ–° Pod ä¼šç»å† <code>Pending</code> -&gt; <code>ContainerCreating</code> -&gt; <code>Running</code>ï¼Œä½†æ­¤æ—¶å®ƒçš„ <code>READY</code> çŠ¶æ€æ˜¯ <code>0/1</code>ã€‚</li>
<li>åªæœ‰å½“ <code>readinessProbe</code> é€šè¿‡åï¼Œæ–° Pod çš„ <code>READY</code> çŠ¶æ€æ‰ä¼šå˜ä¸º <code>1/1</code>ã€‚</li>
<li>æ­¤æ—¶ï¼ŒKubernetes ä¼šå°†è¿™ä¸ªæ–° Pod æ·»åŠ åˆ° Service çš„ Endpoints åˆ—è¡¨ä¸­ã€‚</li>
<li>ç„¶åï¼ŒKubernetes ä¼šé€‰æ‹©ä¸€ä¸ª <code>v1.0.0</code> çš„æ—§ Pod è¿›è¡Œç»ˆæ­¢ã€‚</li>
<li>æ—§ Pod è¿›å…¥ <code>Terminating</code> çŠ¶æ€ã€‚æ­¤æ—¶ï¼š
<ul>
<li><strong>Kubernetes ä¼šæ‰§è¡Œ <code>preStop</code> hook (sleep 60ç§’)ã€‚</strong> åœ¨è¿™ 60 ç§’å†…ï¼ŒPod ä¼šç»§ç»­å¤„ç†å·²æ¥æ”¶çš„è¯·æ±‚ï¼Œä½† Service ä¸ä¼šå†å‘å®ƒå‘é€æ–°è¯·æ±‚ã€‚</li>
<li><strong>åŒæ—¶ï¼Œ<code>kubectl get pods</code> ä¼šæ˜¾ç¤º <code>Terminating</code> çŠ¶æ€ã€‚</strong> <code>READY</code> çŠ¶æ€å¯èƒ½ä¼šä¿æŒ <code>1/1</code> æˆ–å˜æˆ <code>0/1</code>ï¼Œå…·ä½“å–å†³äº <code>readinessProbe</code> åœ¨ <code>preStop</code> hook æœŸé—´çš„çŠ¶æ€ã€‚ç”±äºæˆ‘ä»¬åªæœ‰ä¸€ä¸ª <code>sleep</code>ï¼Œ<code>readinessProbe</code> å¯èƒ½ä¼šåœ¨ <code>sleep</code> æœŸé—´ä»æ˜¯ <code>UP</code>ï¼Œä½† K8s å·²ç»å°†å…¶æ ‡è®°ä¸º <code>Terminating</code> å¹¶ä» Service Endpoints ç§»é™¤ã€‚</li>
<li><strong><code>preStop</code> hook ç»“æŸåï¼ŒKubernetes å‘é€ <code>TERM</code> ä¿¡å·ã€‚</strong></li>
<li><strong>Spring Boot åº”ç”¨å¯åŠ¨ä¼˜é›…åœæœºï¼š</strong> å®ƒä¼šåœæ­¢æ¥å—æ–°è¯·æ±‚ï¼Œç­‰å¾…æ­£åœ¨è¿›è¡Œä¸­çš„æ…¢è¯·æ±‚ï¼ˆ20ç§’ï¼‰å®Œæˆã€‚</li>
<li><strong>åº”ç”¨ç¨‹åºæ—¥å¿—ä¸­ä¼šæ‰“å° Spring IoC å®¹å™¨å…³é—­ã€Web æœåŠ¡å™¨å…³é—­ç­‰ä¿¡æ¯ã€‚</strong></li>
<li>å½“æ‰€æœ‰è¯·æ±‚å®Œæˆä¸”åº”ç”¨ç¨‹åºå…³é—­åï¼Œæ—§ Pod ä¼šè¢«å®Œå…¨ç§»é™¤ã€‚</li>
<li>è¿™ä¸ªè¿‡ç¨‹ä¼šä¸€ç›´é‡å¤ï¼Œç›´åˆ°æ‰€æœ‰ 3 ä¸ª <code>v1.0.0</code> Pod éƒ½è¢« 3 ä¸ª <code>v2.0.0</code> Pod æ›¿æ¢ã€‚</li>
</ul>
</li>
</ol>
<p>æ‚¨è¿˜ä¼šè§‚å¯Ÿåˆ°ï¼š</p>
<ul>
<li><strong>ç»ˆç«¯ 1 (æ…¢è¯·æ±‚):</strong> å³ä½¿æ—§ Pod å¤„äº <code>Terminating</code> çŠ¶æ€ï¼Œå®ƒæ­£åœ¨å¤„ç†çš„æ…¢è¯·æ±‚ä¹Ÿåº”è¯¥èƒ½å¤Ÿé¡ºåˆ©å®Œæˆï¼Œä¸ä¼šå‡ºç°é”™è¯¯ã€‚å½“è¯¥ Pod å®Œå…¨å…³é—­åï¼Œæ–°çš„æ…¢è¯·æ±‚ä¼šè¢«è·¯ç”±åˆ°æ–°çš„ <code>v2.0.0</code> å®ä¾‹ã€‚</li>
<li><strong>ç»ˆç«¯ 2 (å¿«è¯·æ±‚):</strong> å§‹ç»ˆèƒ½å¾—åˆ°å“åº”ã€‚éšç€å‡çº§è¿›è¡Œï¼Œæ‚¨ä¼šçœ‹åˆ°å“åº”é€æ¸ä» <code>v1.0.0</code> åˆ‡æ¢åˆ° <code>v2.0.0</code>ï¼Œä¸­é—´ä¸ä¼šæœ‰ä»»ä½•ä¸­æ–­æˆ–é”™è¯¯ã€‚</li>
</ul>
<p><strong>ç»ˆç«¯ 4 (è§‚å¯Ÿ Pod æ—¥å¿—ï¼Œç‰¹åˆ«æ˜¯ <code>Terminating</code> çŠ¶æ€çš„ Pod):</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ‰¾å‡ºä¸€ä¸ªæ­£åœ¨ Terminating çš„æ—§ Pod çš„åå­—ï¼Œä¾‹å¦‚ sc-alibaba-k8s-demo-deployment-xxxxx-abcde</span>
kubectl logs -f sc-alibaba-k8s-demo-deployment-xxxxx-abcde
</code></pre>
<p>åœ¨æ—§ Pod çš„æ—¥å¿—ä¸­ï¼Œæ‚¨åº”è¯¥èƒ½çœ‹åˆ°ï¼š</p>
<ul>
<li>å¤„ç†æ…¢è¯·æ±‚çš„ <code>"Instance ... received /slow-hello request..."</code> å’Œ <code>"Instance ... finished /slow-hello request."</code> æ­£å¸¸å®Œæˆã€‚</li>
<li>Spring Boot æ•è· <code>TERM</code> ä¿¡å·å¹¶å¯åŠ¨ä¼˜é›…åœæœºçš„æ—¥å¿—ï¼ˆä¾‹å¦‚ï¼ŒTomcat åœæ­¢æ¥æ”¶è¿æ¥ï¼Œå…³é—­çº¿ç¨‹æ± ç­‰ï¼‰ã€‚</li>
<li>Nacos å®ä¾‹æ³¨é”€çš„æ—¥å¿—ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-21">æ€»ç»“å’Œå…³é”®ç‚¹å›é¡¾</h3>
<ul>
<li><strong><code>maxUnavailable: 0</code> å’Œ <code>maxSurge: 1</code> æ»šåŠ¨å‡çº§ç­–ç•¥</strong>ï¼šè¿™æ˜¯ Kubernetes å±‚é¢å®ç°é›¶åœæœºçš„æ ¹æœ¬ã€‚å®ƒä¿è¯äº†å§‹ç»ˆæœ‰è¶³å¤Ÿå¤šçš„å¯ç”¨ Pod å¤„ç†æµé‡ã€‚</li>
<li><strong><code>readinessProbe</code> (å°±ç»ªæ¢é’ˆ)</strong>ï¼š
<ul>
<li><strong>æ–° Pod å¯åŠ¨æ—¶</strong>ï¼šç¡®ä¿åªæœ‰å½“åº”ç”¨å®Œå…¨åˆå§‹åŒ–ï¼ˆå¦‚è¿æ¥ DB, æ³¨å†Œ Nacosï¼‰å¹¶çœŸæ­£å‡†å¤‡å¥½å¤„ç†è¯·æ±‚æ—¶ï¼Œæ‰ä¼šè¢«æ·»åŠ åˆ° Service çš„ Endpointsã€‚</li>
<li><strong>æ—§ Pod ç»ˆæ­¢å‰</strong>ï¼šKubernetes ä¼šåœ¨æ—§ Pod è¢«æ ‡è®°ä¸º <code>Terminating</code> åï¼Œç­‰å¾… <code>readinessProbe</code> æœ€ç»ˆå¤±è´¥ï¼ˆé€šå¸¸åœ¨ <code>preStop</code> hook ä¹‹åæˆ– Spring Boot åœæ­¢åï¼‰ï¼Œæ‰ä¼šå°†å…¶ä» Service Endpoints å½»åº•ç§»é™¤ã€‚</li>
</ul>
</li>
<li><strong><code>preStop</code> hook</strong>ï¼šæä¾›äº†ä¸€ä¸ªåœ¨ <code>TERM</code> ä¿¡å·å‘é€ä¹‹å‰çš„é¢„å¤„ç†é˜¶æ®µã€‚
<ul>
<li>æˆ‘ä»¬ä½¿ç”¨ <code>sleep 60</code> æ¥ç»™ Kubernetes å’Œæ‰€æœ‰ä¸­é—´ä»¶ï¼ˆå¦‚æœåŠ¡ç½‘æ ¼ã€è´Ÿè½½å‡è¡¡å™¨ï¼‰è¶³å¤Ÿçš„æ—¶é—´æ¥æ›´æ–°è·¯ç”±é…ç½®ï¼Œç¡®ä¿æ—§ Pod åœ¨å¼€å§‹ä¼˜é›…åœæœºå‰ï¼Œå·²ç»ä¸å†æ¥æ”¶ä»»ä½•æ–°è¯·æ±‚ã€‚</li>
<li><code>terminationGracePeriodSeconds</code> å¿…é¡»è¶³å¤Ÿé•¿ï¼Œä»¥è¦†ç›– <code>preStop</code> hook çš„æ‰§è¡Œæ—¶é—´ï¼Œä»¥åŠ Spring Boot ä¼˜é›…åœæœºå¤„ç†æœ€é•¿è¯·æ±‚çš„æ—¶é—´ã€‚</li>
</ul>
</li>
<li><strong>Spring Boot <code>server.shutdown: graceful</code></strong>ï¼šç¡®ä¿åº”ç”¨ç¨‹åºåœ¨æ”¶åˆ° <code>TERM</code> ä¿¡å·åï¼Œåœæ­¢æ¥å—æ–°è¯·æ±‚ï¼Œä½†ä¼šç­‰å¾…æ‰€æœ‰æ­£åœ¨è¿›è¡Œä¸­çš„è¯·æ±‚å®Œæˆï¼Œä»è€Œé¿å…å®¢æˆ·ç«¯é”™è¯¯ã€‚</li>
<li><strong>Spring Cloud Alibaba Nacos æ³¨é”€</strong>ï¼šå½“ Spring Application Context å…³é—­æ—¶ï¼ŒSpring Cloud Nacos ä¼šè‡ªåŠ¨å°†è¯¥å®ä¾‹ä» Nacos ä¸­æ³¨é”€ï¼Œç¡®ä¿ Nacos Server ä¸ä¼šå°†æµé‡è·¯ç”±åˆ°å·²å…³é—­çš„å®ä¾‹ã€‚</li>
</ul>
<p>ç å­—ä¸æ˜“ï¼Œç‚¹èµæ”¯æŒ~~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RustFSï¼šåŸºäºRustçš„é«˜æ€§èƒ½åˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨ï¼Œé‡æ–°å®šä¹‰æ•°æ®å­˜å‚¨æ–°æ ‡å‡†ï¼]]></title>    <link>https://juejin.cn/post/7595911076014260260</link>    <guid>https://juejin.cn/post/7595911076014260260</guid>    <pubDate>2026-01-17T10:28:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595911076014260260" data-draft-id="7595858760134131775" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RustFSï¼šåŸºäºRustçš„é«˜æ€§èƒ½åˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨ï¼Œé‡æ–°å®šä¹‰æ•°æ®å­˜å‚¨æ–°æ ‡å‡†ï¼"/> <!----> <meta itemprop="datePublished" content="2026-01-17T10:28:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¯¹è±¡å­˜å‚¨ä¸RustFS"/> <meta itemprop="url" content="https://juejin.cn/user/652466093570057"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RustFSï¼šåŸºäºRustçš„é«˜æ€§èƒ½åˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨ï¼Œé‡æ–°å®šä¹‰æ•°æ®å­˜å‚¨æ–°æ ‡å‡†ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/652466093570057/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¯¹è±¡å­˜å‚¨ä¸RustFS
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T10:28:43.000Z" title="Sat Jan 17 2026 10:28:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">RustFSï¼šåŸºäºRustçš„é«˜æ€§èƒ½åˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨ï¼Œé‡æ–°å®šä¹‰æ•°æ®å­˜å‚¨æ–°æ ‡å‡†ï¼</h2>
<blockquote>
<p>RustFS æ˜¯ä¸€ä¸ªåŸºäº Rust è¯­è¨€å¼€å‘çš„å¼€æºåˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨ç³»ç»Ÿï¼Œæ€§èƒ½æ¯” MinIO å¿« 2.3 å€ï¼Œå®Œå…¨å…¼å®¹ S3 åè®®ï¼Œä¸ºä¼ä¸šçº§åº”ç”¨æä¾›é«˜æ€§èƒ½ã€é«˜å¯é æ€§çš„æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚</p>
</blockquote>
<h3 data-id="heading-1">å¼•è¨€ï¼šä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨ï¼Ÿ</h3>
<p>åœ¨å½“ä»Šæ•°æ®çˆ†ç‚¸çš„æ—¶ä»£ï¼Œä¼ ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿå’Œæœ¬åœ°å­˜å‚¨å·²ç»éš¾ä»¥æ»¡è¶³å¤§è§„æ¨¡æ•°æ®å­˜å‚¨çš„éœ€æ±‚ã€‚ä¼ä¸šçº§åº”ç”¨ã€äº‘åŸç”ŸæœåŠ¡å’Œå¤§æ•°æ®åˆ†æéƒ½éœ€è¦å¤„ç†æµ·é‡çš„éç»“æ„åŒ–æ•°æ®â€”â€”å›¾ç‰‡ã€è§†é¢‘ã€æ—¥å¿—æ–‡ä»¶ã€å¤‡ä»½æ•°æ®ç­‰ã€‚è¿™å°±æ˜¯åˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨çš„ç”¨æ­¦ä¹‹åœ°ã€‚</p>
<p>ä¸ä¼ ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿä¸åŒï¼Œå¯¹è±¡å­˜å‚¨å°†æ•°æ®ä½œä¸ºç‹¬ç«‹å¯¹è±¡è¿›è¡Œç®¡ç†ï¼Œæ¯ä¸ªå¯¹è±¡åŒ…å«æ•°æ®æœ¬èº«ã€å…ƒæ•°æ®å’Œå…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦ã€‚è¿™ç§æ¶æ„å¤©ç„¶é€‚åˆåˆ†å¸ƒå¼ç¯å¢ƒï¼Œèƒ½å¤Ÿå®ç°è¿‘ä¹æ— é™çš„æ‰©å±•æ€§ã€‚</p>
<h3 data-id="heading-2">RustFSçš„è®¾è®¡ç†å¿µ</h3>
<h4 data-id="heading-3">ä¸ºä»€ä¹ˆé€‰æ‹©Rustè¯­è¨€ï¼Ÿ</h4>
<p>Rustè¯­è¨€ä»¥å…¶å†…å­˜å®‰å…¨ã€é›¶æˆæœ¬æŠ½è±¡å’Œé«˜å¹¶å‘æ€§èƒ½è€Œé—»åï¼Œè¿™äº›ç‰¹æ€§ä½¿å…¶æˆä¸ºæ„å»ºåˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿçš„ç†æƒ³é€‰æ‹©ï¼š</p>
<ul>
<li><strong>å†…å­˜å®‰å…¨</strong>ï¼šæ— éœ€åƒåœ¾å›æ”¶å™¨å³å¯é˜²æ­¢å†…å­˜æ³„æ¼å’Œæ•°æ®ç«äº‰</li>
<li><strong>é«˜æ€§èƒ½</strong>ï¼šæ¥è¿‘C/C++çš„æ‰§è¡Œæ•ˆç‡</li>
<li><strong>å¼ºå¤§çš„å¹¶å‘æ¨¡å‹</strong>ï¼šåŸºäºæ‰€æœ‰æƒç³»ç»Ÿçš„ fearless concurrency</li>
<li><strong>ä¸°å¯Œçš„ç”Ÿæ€ç³»ç»Ÿ</strong>ï¼šæ‹¥æœ‰æˆç†Ÿçš„å¼‚æ­¥ç¼–ç¨‹åº“å’Œç½‘ç»œåº“</li>
</ul>
<h4 data-id="heading-4">æ ¸å¿ƒæ¶æ„è®¾è®¡</h4>
<p>RustFSé‡‡ç”¨ç»å…¸çš„åˆ†å¸ƒå¼å­˜å‚¨æ¶æ„ï¼ŒåŒ…å«ä»¥ä¸‹æ ¸å¿ƒç»„ä»¶ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// ç®€åŒ–çš„ç³»ç»Ÿç»„ä»¶ç¤ºæ„å›¾</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">RustFSCluster</span> {
    metadata_servers: <span class="hljs-type">Vec</span>&lt;metadataserver&gt;,
    data_servers: <span class="hljs-type">Vec</span>&lt;dataserver&gt;,
    client_sdk: ClientSDK,
    load_balancer: LoadBalancer,
}
</code></pre>
<h3 data-id="heading-5">RustFSçš„æ ¸å¿ƒç‰¹æ€§</h3>
<h4 data-id="heading-6">1. é«˜æ€§èƒ½æ•°æ®å­˜å–</h4>
<p>RustFSé€šè¿‡å¤šé¡¹ä¼˜åŒ–æŠ€æœ¯å®ç°æè‡´æ€§èƒ½ï¼š</p>
<p><strong>å¼‚æ­¥I/Oå’Œå¹¶è¡Œå¤„ç†</strong></p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// ä½¿ç”¨tokioå®ç°å¼‚æ­¥å†™å…¥</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">put_object</span>(&amp;<span class="hljs-keyword">self</span>, bucket: &amp;<span class="hljs-type">str</span>, key: &amp;<span class="hljs-type">str</span>, data: <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">u8</span>&gt;) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;putresult&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">upload_id</span> = <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">start_multipart_upload</span>(bucket, key).<span class="hljs-keyword">await</span>?;
    
    <span class="hljs-comment">// å¹¶è¡Œä¸Šä¼ æ•°æ®åˆ†ç‰‡</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">chunks</span> = data.<span class="hljs-title function_ invoke__">chunks</span>(<span class="hljs-keyword">Self</span>::CHUNK_SIZE);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">upload_tasks</span>: <span class="hljs-type">Vec</span>&lt;_&gt; = chunks.<span class="hljs-title function_ invoke__">enumerate</span>()
        .<span class="hljs-title function_ invoke__">map</span>(|(part_num, chunk)| {
            <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">upload_part</span>(bucket, key, &amp;upload_id, part_num + <span class="hljs-number">1</span>, chunk.<span class="hljs-title function_ invoke__">to_vec</span>())
        })
        .<span class="hljs-title function_ invoke__">collect</span>();
    
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">results</span> = <span class="hljs-title function_ invoke__">join_all</span>(upload_tasks).<span class="hljs-keyword">await</span>;
    <span class="hljs-keyword">self</span>.<span class="hljs-title function_ invoke__">complete_multipart_upload</span>(bucket, key, &amp;upload_id, results).<span class="hljs-keyword">await</span>
}
</code></pre>
<p><strong>æ™ºèƒ½ç¼“å­˜æœºåˆ¶</strong></p>
<ul>
<li>çƒ­ç‚¹æ•°æ®å†…å­˜ç¼“å­˜</li>
<li>åˆ†å±‚å­˜å‚¨ï¼ˆSSD+HDDï¼‰</li>
<li>é¢„è¯»ä¼˜åŒ–å’Œç¼“å­˜é¢„çƒ­</li>
</ul>
<h4 data-id="heading-7">2. å¼ºå¤§çš„æ•°æ®ä¸€è‡´æ€§ä¿è¯</h4>
<p>RustFSæä¾›å¤šç§ä¸€è‡´æ€§çº§åˆ«ï¼Œæ»¡è¶³ä¸åŒåœºæ™¯éœ€æ±‚ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">pub</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">ConsistencyLevel</span> {
    Strong,      <span class="hljs-comment">// å¼ºä¸€è‡´æ€§ï¼Œå†™åè¯»ä¸€è‡´æ€§</span>
    Eventual,    <span class="hljs-comment">// æœ€ç»ˆä¸€è‡´æ€§ï¼Œæ›´é«˜å¯ç”¨æ€§</span>
    ReadAfterWrite, <span class="hljs-comment">// å†™åè¯»ä¸€è‡´æ€§</span>
}
</code></pre>
<h4 data-id="heading-8">3. ä¼ä¸šçº§æ•°æ®ä¿æŠ¤</h4>
<p><strong>æ•°æ®å†—ä½™ä¸çº åˆ ç </strong></p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// ä½¿ç”¨Reed-Solomonçº åˆ ç </span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">ErasureCoding</span> {
    data_shards: <span class="hljs-type">usize</span>,
    parity_shards: <span class="hljs-type">usize</span>,
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">ErasureCoding</span> {
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">new</span>(data_shards: <span class="hljs-type">usize</span>, parity_shards: <span class="hljs-type">usize</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">Self</span> {
        <span class="hljs-keyword">Self</span> { data_shards, parity_shards }
    }
    
    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">encode</span>(&amp;<span class="hljs-keyword">self</span>, data: &amp;[<span class="hljs-type">u8</span>]) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;vec&lt;vec&lt;<span class="hljs-type">u8</span>&gt;&gt;&gt; {
        <span class="hljs-comment">// å®ç°çº åˆ ç ç¼–ç é€»è¾‘</span>
        <span class="hljs-comment">// å°†æ•°æ®åˆ†ç‰‡å¹¶ç”Ÿæˆæ ¡éªŒç‰‡</span>
    }
}
</code></pre>
<p><strong>æ•°æ®åŠ å¯†ä¸å®‰å…¨</strong></p>
<ul>
<li>ä¼ è¾“å±‚åŠ å¯†ï¼ˆTLSï¼‰</li>
<li>é™æ€æ•°æ®åŠ å¯†ï¼ˆAES-256ï¼‰</li>
<li>å®¢æˆ·ç«¯åŠ å¯†æ”¯æŒ</li>
</ul>
<h3 data-id="heading-9">å¿«é€Ÿå…¥é—¨æŒ‡å—</h3>
<h4 data-id="heading-10">å®‰è£…RustFSå®¢æˆ·ç«¯</h4>
<p>åœ¨Cargo.tomlä¸­æ·»åŠ ä¾èµ–ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-section">[dependencies]</span>
<span class="hljs-attr">rustfs-client</span> = <span class="hljs-string">"0.1.0"</span>
<span class="hljs-attr">tokio</span> = { version = <span class="hljs-string">"1.0"</span>, features = [<span class="hljs-string">"full"</span>] }
</code></pre>
<h4 data-id="heading-11">åŸºç¡€ä½¿ç”¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> rustfs_client::{Client, Config};
<span class="hljs-keyword">use</span> anyhow::<span class="hljs-type">Result</span>;

<span class="hljs-meta">#[tokio::main]</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;()&gt; {
    <span class="hljs-comment">// åˆå§‹åŒ–å®¢æˆ·ç«¯</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">config</span> = Config {
        endpoint: <span class="hljs-string">"http://127.0.0.1:8080"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),
        access_key: <span class="hljs-string">"your_access_key"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),
        secret_key: <span class="hljs-string">"your_secret_key"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),
        ..<span class="hljs-built_in">Default</span>::<span class="hljs-title function_ invoke__">default</span>()
    };
    
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">client</span> = Client::<span class="hljs-title function_ invoke__">new</span>(config)?;
    
    <span class="hljs-comment">// åˆ›å»ºå­˜å‚¨æ¡¶</span>
    client.<span class="hljs-title function_ invoke__">create_bucket</span>(<span class="hljs-string">"my-bucket"</span>).<span class="hljs-keyword">await</span>?;
    
    <span class="hljs-comment">// ä¸Šä¼ å¯¹è±¡</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">data</span> = <span class="hljs-string">b"Hello, RustFS!"</span>.<span class="hljs-title function_ invoke__">to_vec</span>();
    client.<span class="hljs-title function_ invoke__">put_object</span>(<span class="hljs-string">"my-bucket"</span>, <span class="hljs-string">"hello.txt"</span>, data).<span class="hljs-keyword">await</span>?;
    
    <span class="hljs-comment">// ä¸‹è½½å¯¹è±¡</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">downloaded</span> = client.<span class="hljs-title function_ invoke__">get_object</span>(<span class="hljs-string">"my-bucket"</span>, <span class="hljs-string">"hello.txt"</span>).<span class="hljs-keyword">await</span>?;
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Downloaded: {}"</span>, <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from_utf8</span>(downloaded)?);
    
    <span class="hljs-title function_ invoke__">Ok</span>(())
}
</code></pre>
<h4 data-id="heading-12">é«˜çº§åŠŸèƒ½ç¤ºä¾‹</h4>
<p><strong>åˆ†ç‰‡ä¸Šä¼ å¤§æ–‡ä»¶</strong></p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">upload_large_file</span>(client: &amp;Client, bucket: &amp;<span class="hljs-type">str</span>, key: &amp;<span class="hljs-type">str</span>, file_path: &amp;Path) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;()&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">file</span> = File::<span class="hljs-title function_ invoke__">open</span>(file_path).<span class="hljs-keyword">await</span>?;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">upload_id</span> = client.<span class="hljs-title function_ invoke__">create_multipart_upload</span>(bucket, key).<span class="hljs-keyword">await</span>?;
    
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">part_number</span> = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">parts</span> = <span class="hljs-type">Vec</span>::<span class="hljs-title function_ invoke__">new</span>();
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">buffer</span> = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">0</span>; <span class="hljs-number">8</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>]; <span class="hljs-comment">// 8MBç¼“å†²åŒº</span>
    
    <span class="hljs-keyword">loop</span> {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">bytes_read</span> = file.<span class="hljs-title function_ invoke__">read</span>(&amp;<span class="hljs-keyword">mut</span> buffer).<span class="hljs-keyword">await</span>?;
        <span class="hljs-keyword">if</span> bytes_read == <span class="hljs-number">0</span> {
            <span class="hljs-keyword">break</span>;
        }
        
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">part_data</span> = buffer[..bytes_read].<span class="hljs-title function_ invoke__">to_vec</span>();
        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">part</span> = client.<span class="hljs-title function_ invoke__">upload_part</span>(bucket, key, &amp;upload_id, part_number, part_data).<span class="hljs-keyword">await</span>?;
        parts.<span class="hljs-title function_ invoke__">push</span>(part);
        part_number += <span class="hljs-number">1</span>;
    }
    
    client.<span class="hljs-title function_ invoke__">complete_multipart_upload</span>(bucket, key, &amp;upload_id, parts).<span class="hljs-keyword">await</span>?;
    <span class="hljs-title function_ invoke__">Ok</span>(())
}
</code></pre>
<h3 data-id="heading-13">æ€§èƒ½åŸºå‡†æµ‹è¯•</h3>
<p>æˆ‘ä»¬åœ¨æ ‡å‡†ç¡¬ä»¶é…ç½®ä¸‹å¯¹RustFSè¿›è¡Œäº†æ€§èƒ½æµ‹è¯•ï¼š</p>

























<table><thead><tr><th>æ“ä½œç±»å‹</th><th>å¹³å‡å»¶è¿Ÿ</th><th>ååé‡</th></tr></thead><tbody><tr><td>å°æ–‡ä»¶å†™å…¥ï¼ˆ1KBï¼‰</td><td>2.3ms</td><td>12,000 ops/s</td></tr><tr><td>å¤§æ–‡ä»¶å†™å…¥ï¼ˆ100MBï¼‰</td><td>1.2s</td><td>830 MB/s</td></tr><tr><td>å¹¶å‘è¯»å–ï¼ˆ100è¿æ¥ï¼‰</td><td>5.1ms</td><td>45,000 ops/s</td></tr></tbody></table>
<h3 data-id="heading-14">å®é™…åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-15">1. äº‘åŸç”Ÿåº”ç”¨å­˜å‚¨</h4>
<p>RustFSæä¾›Kubernetes CSIé©±åŠ¨ï¼Œæ— ç¼é›†æˆå®¹å™¨åŒ–ç¯å¢ƒã€‚</p>
<h4 data-id="heading-16">2. å¤§æ•°æ®åˆ†æå¹³å°</h4>
<p>ä½œä¸ºæ•°æ®æ¹–å­˜å‚¨å±‚ï¼Œæ”¯æŒSparkã€Prestoç­‰è®¡ç®—å¼•æ“ã€‚</p>
<h4 data-id="heading-17">3. åª’ä½“å­˜å‚¨ä¸åˆ†å‘</h4>
<p>ä¸ºå›¾ç‰‡ã€è§†é¢‘ç­‰åª’ä½“æ–‡ä»¶æä¾›å¯é çš„å­˜å‚¨å’ŒCDNé›†æˆã€‚</p>
<h4 data-id="heading-18">4. å¤‡ä»½ä¸å®¹ç¾</h4>
<p>è·¨åœ°åŸŸå¤åˆ¶åŠŸèƒ½ç¡®ä¿æ•°æ®å®‰å…¨æ€§å’Œä¸šåŠ¡è¿ç»­æ€§ã€‚</p>
<h3 data-id="heading-19">æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-20">éƒ¨ç½²å»ºè®®</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># docker-compose.yml ç¤ºä¾‹</span>
<span class="hljs-attr">version:</span> <span class="hljs-string">'3.8'</span>
<span class="hljs-attr">services:</span>
  <span class="hljs-attr">rustfs-metadata:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">rustfs/metadata:latest</span>
    <span class="hljs-attr">deploy:</span>
      <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">RAFT_CLUSTER=metadata1:7000,metadata2:7000,metadata3:7000</span>
    
  <span class="hljs-attr">rustfs-data:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">rustfs/data:latest</span>
    <span class="hljs-attr">deploy:</span>
      <span class="hljs-attr">replicas:</span> <span class="hljs-number">6</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">METADATA_ENDPOINTS=metadata1:7000,metadata2:7000,metadata3:7000</span>
</code></pre>
<h4 data-id="heading-21">æ€§èƒ½è°ƒä¼˜</h4>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// å®¢æˆ·ç«¯é…ç½®ä¼˜åŒ–</span>
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">optimized_config</span> = Config {
    endpoint: <span class="hljs-string">"http://rustfs-cluster:8080"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),
    max_connections: <span class="hljs-number">100</span>,           <span class="hljs-comment">// æœ€å¤§è¿æ¥æ•°</span>
    connect_timeout: Duration::<span class="hljs-title function_ invoke__">from_secs</span>(<span class="hljs-number">10</span>),
    timeout: Duration::<span class="hljs-title function_ invoke__">from_secs</span>(<span class="hljs-number">30</span>),
    retry_policy: RetryPolicy::ExponentialBackoff {
        max_retries: <span class="hljs-number">3</span>,
        base_delay: Duration::<span class="hljs-title function_ invoke__">from_millis</span>(<span class="hljs-number">100</span>),
    },
    ..<span class="hljs-built_in">Default</span>::<span class="hljs-title function_ invoke__">default</span>()
};
</code></pre>
<h3 data-id="heading-22">æ€»ç»“ä¸å±•æœ›</h3>
<p>RustFSå‡­å€ŸRustè¯­è¨€çš„å¤©ç„¶ä¼˜åŠ¿ï¼Œåœ¨æ€§èƒ½ã€å®‰å…¨æ€§å’Œå¯é æ€§æ–¹é¢è¡¨ç°å‡ºè‰²ã€‚å…¶ç®€æ´çš„APIè®¾è®¡ã€ä¸°å¯Œçš„åŠŸèƒ½å’Œè‰¯å¥½çš„æ‰©å±•æ€§ï¼Œä½¿å…¶æˆä¸ºæ„å»ºç°ä»£åˆ†å¸ƒå¼åº”ç”¨çš„ç†æƒ³å­˜å‚¨é€‰æ‹©ã€‚</p>
<p><strong>æœªæ¥è§„åˆ’ï¼š</strong></p>
<ul>
<li>æ”¯æŒS3å…¼å®¹API</li>
<li>æœºå™¨å­¦ä¹ æ•°æ®ç®¡é“ä¼˜åŒ–</li>
<li>è¾¹ç¼˜è®¡ç®—åœºæ™¯é€‚é…</li>
<li>æ›´å¼ºçš„æ•°æ®æ²»ç†åŠŸèƒ½</li>
</ul>
<p>RustFSæ­£åœ¨ç§¯æå¼€å‘ä¸­ï¼Œæˆ‘ä»¬æ¬¢è¿ç¤¾åŒºè´¡çŒ®å’Œåé¦ˆã€‚æ— è®ºæ˜¯åŠŸèƒ½å»ºè®®ã€bugæŠ¥å‘Šè¿˜æ˜¯ä»£ç è´¡çŒ®ï¼Œéƒ½å°†å¸®åŠ©RustFSå˜å¾—æ›´åŠ å®Œå–„ã€‚</p>
<hr/>
<p>ä»¥ä¸‹æ˜¯æ·±å…¥å­¦ä¹  RustFS çš„æ¨èèµ„æºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Frustfs%2Frustfs" target="_blank" title="https://github.com/rustfs/rustfs" ref="nofollow noopener noreferrer">RustFS</a></p>
<p>å®˜æ–¹æ–‡æ¡£ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.rustfs.com%2Finstallation%2F" target="_blank" title="https://docs.rustfs.com/installation/" ref="nofollow noopener noreferrer">RustFS å®˜æ–¹æ–‡æ¡£</a>- æä¾›æ¶æ„ã€å®‰è£…æŒ‡å—å’Œ API å‚è€ƒã€‚</p>
<p>GitHub ä»“åº“ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Forgs%2Frustfs%2Frepositories" target="_blank" title="https://github.com/orgs/rustfs/repositories" ref="nofollow noopener noreferrer">GitHub ä»“åº“</a> - è·å–æºä»£ç ã€æäº¤é—®é¢˜æˆ–è´¡çŒ®ä»£ç ã€‚</p>
<p>ç¤¾åŒºæ”¯æŒï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Forgs%2Frustfs%2Fdiscussions" target="_blank" title="https://github.com/orgs/rustfs/discussions" ref="nofollow noopener noreferrer">GitHub Discussions</a>- ä¸å¼€å‘è€…äº¤æµç»éªŒå’Œè§£å†³æ–¹æ¡ˆã€‚</p>
<p>â€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <!----></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€2026æ¯•è®¾ã€‘4å¤§ç»´åº¦+12é¡¹åˆ†æï¼šSpark+Djangoçš®è‚¤ç™Œæ•°æ®å¯è§†åŒ–ç³»ç»Ÿ æ¯•ä¸šè®¾è®¡ é€‰é¢˜æ¨è æ¯•è®¾é€‰é¢˜ æ•°æ®åˆ†æ æœºå™¨å­¦ä¹ ]]></title>    <link>https://juejin.cn/post/7595896809651847208</link>    <guid>https://juejin.cn/post/7595896809651847208</guid>    <pubDate>2026-01-17T10:59:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595896809651847208" data-draft-id="7595864836360781876" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€2026æ¯•è®¾ã€‘4å¤§ç»´åº¦+12é¡¹åˆ†æï¼šSpark+Djangoçš®è‚¤ç™Œæ•°æ®å¯è§†åŒ–ç³»ç»Ÿ æ¯•ä¸šè®¾è®¡ é€‰é¢˜æ¨è æ¯•è®¾é€‰é¢˜ æ•°æ®åˆ†æ æœºå™¨å­¦ä¹ "/> <meta itemprop="keywords" content="å‰ç«¯,Python,å¤§æ•°æ®"/> <meta itemprop="datePublished" content="2026-01-17T10:59:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è®¡ç®—æœºç¼–ç¨‹æŒ‡å¯¼å¸ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/881156097585216"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€2026æ¯•è®¾ã€‘4å¤§ç»´åº¦+12é¡¹åˆ†æï¼šSpark+Djangoçš®è‚¤ç™Œæ•°æ®å¯è§†åŒ–ç³»ç»Ÿ æ¯•ä¸šè®¾è®¡ é€‰é¢˜æ¨è æ¯•è®¾é€‰é¢˜ æ•°æ®åˆ†æ æœºå™¨å­¦ä¹ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/881156097585216/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è®¡ç®—æœºç¼–ç¨‹æŒ‡å¯¼å¸ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T10:59:30.000Z" title="Sat Jan 17 2026 10:59:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">çš®è‚¤ç™Œæ•°æ®å¯è§†åŒ–åˆ†æç³»ç»Ÿ-ç®€ä»‹</h2>
<p>æœ¬ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºSpark+Djangoçš„çš®è‚¤ç™Œæ•°æ®å¯è§†åŒ–åˆ†æå¹³å°ï¼Œæ—¨åœ¨é€šè¿‡å¤§æ•°æ®æŠ€æœ¯å¤„ç†å’Œè§£ææµ·é‡çš„åŒ»ç–—è®°å½•ï¼Œä»è€Œæ­ç¤ºçš®è‚¤ç™Œä¸å¤šç§æ½œåœ¨å› ç´ ä¹‹é—´çš„æ·±å±‚å…³è”ã€‚ç³»ç»Ÿæ•´ä½“é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œåç«¯ä»¥Pythonçš„Djangoæ¡†æ¶ä¸ºæ ¸å¿ƒï¼Œè´Ÿè´£ä¸šåŠ¡é€»è¾‘å¤„ç†ä¸APIæ¥å£æä¾›ï¼Œå¹¶åˆ©ç”¨PySparkåº“ä¸å¤§æ•°æ®é›†ç¾¤è¿›è¡Œäº¤äº’ã€‚æ•°æ®å¤„ç†æµç¨‹ä¸Šï¼Œç³»ç»Ÿé¦–å…ˆå°†å­˜å‚¨äºHadoop HDFSä¸­çš„åŸå§‹çš®è‚¤ç™Œæ‚£è€…æ•°æ®é›†ï¼Œé€šè¿‡Sparkè¿›è¡Œåˆ†å¸ƒå¼æ¸…æ´—ã€è½¬æ¢å’Œé¢„å¤„ç†ï¼Œç¡®ä¿æ•°æ®è´¨é‡ã€‚æ ¸å¿ƒåˆ†æå¼•æ“åˆ©ç”¨Spark SQLå’ŒDataFrame APIï¼Œå›´ç»•å››å¤§æ ¸å¿ƒåŠŸèƒ½æ¨¡å—å±•å¼€è®¡ç®—ï¼šåœ¨æ‚£è€…å¤šç»´ç”»åƒå±‚é¢ï¼Œç³»ç»Ÿå¯¹æ‚£è€…çš„æ€§åˆ«ã€å¹´é¾„ã€å¸çƒŸé¥®é…’ä¹ æƒ¯ç­‰æ•°æ®è¿›è¡Œèšåˆç»Ÿè®¡ï¼Œæ„å»ºé«˜é£é™©äººç¾¤ç”»åƒï¼›åœ¨ä¸´åºŠç—…å˜ç‰¹å¾åˆ†æå±‚é¢ï¼Œç³»ç»Ÿå¯¹ç—…å˜å°ºå¯¸ã€é«˜å‘èº«ä½“éƒ¨ä½åŠä¸´åºŠç—‡çŠ¶é¢‘ç‡è¿›è¡Œé‡åŒ–åˆ†æï¼Œä¸ºä¸´åºŠè¯Šæ–­æä¾›æ•°æ®å‚è€ƒï¼›åœ¨é£é™©å› ç´ æŒ–æ˜å±‚é¢ï¼Œç³»ç»Ÿé€šè¿‡å…³è”è§„åˆ™ç®—æ³•æ¢ç´¢ä¸´åºŠç—‡çŠ¶ç»„åˆä¸è¯Šæ–­ç»“æœçš„å¼ºå…³è”æ€§ï¼›æœ€åï¼Œåœ¨äº¤å‰éªŒè¯åˆ†æå±‚é¢ï¼Œç³»ç»Ÿæ•´åˆå¤šç»´åº¦æ•°æ®ï¼Œä¸ºä¸åŒè¯Šæ–­ç±»å‹æ„å»ºç»¼åˆç”»åƒï¼Œå¹¶åˆ†ææ´»æ£€å†³ç­–çš„å½±å“å› ç´ ã€‚æ‰€æœ‰è®¡ç®—ç»“æœç»ç”±Djangoå°è£…æˆRESTful APIï¼Œæœ€ç»ˆç”±å‰ç«¯Vueæ¡†æ¶ç»“åˆEchartsç»„ä»¶ï¼Œä»¥åŠ¨æ€ã€äº¤äº’å¼çš„å›¾è¡¨å½¢å¼ç›´è§‚å‘ˆç°ç»™ç”¨æˆ·ã€‚</p>
<h2 data-id="heading-1">çš®è‚¤ç™Œæ•°æ®å¯è§†åŒ–åˆ†æç³»ç»Ÿ-æŠ€æœ¯</h2>
<p>å¼€å‘è¯­è¨€ï¼šPythonæˆ–Java
å¤§æ•°æ®æ¡†æ¶ï¼šHadoop+Sparkï¼ˆæœ¬æ¬¡æ²¡ç”¨Hiveï¼Œæ”¯æŒå®šåˆ¶ï¼‰
åç«¯æ¡†æ¶ï¼šDjango+Spring Boot(Spring+SpringMVC+Mybatis)
å‰ç«¯ï¼šVue+ElementUI+Echarts+HTML+CSS+JavaScript+jQuery
è¯¦ç»†æŠ€æœ¯ç‚¹ï¼šHadoopã€HDFSã€Sparkã€Spark SQLã€Pandasã€NumPy
æ•°æ®åº“ï¼šMySQL</p>
<h2 data-id="heading-2">çš®è‚¤ç™Œæ•°æ®å¯è§†åŒ–åˆ†æç³»ç»Ÿ-èƒŒæ™¯</h2>
<p>é€‰é¢˜èƒŒæ™¯
è¿‘å¹´æ¥ï¼Œéšç€å…¬ä¼—å¥åº·æ„è¯†çš„æå‡å’ŒåŒ»ç–—ä¿¡æ¯åŒ–çš„æ™®åŠï¼ŒåŒ»ç–—æœºæ„ç§¯ç´¯äº†æµ·é‡çš„æ‚£è€…è¯Šç–—æ•°æ®ã€‚çš®è‚¤ç™Œä½œä¸ºæœ€å¸¸è§çš„æ¶æ€§è‚¿ç˜¤ä¹‹ä¸€ï¼Œå…¶æ—©æœŸå‘ç°ä¸è¯Šæ–­å¯¹äºæé«˜æ‚£è€…ç”Ÿå­˜ç‡è‡³å…³é‡è¦ã€‚ç„¶è€Œï¼Œä¼ ç»Ÿçš„æ•°æ®ç»Ÿè®¡åˆ†ææ–¹æ³•å¾€å¾€éš¾ä»¥æœ‰æ•ˆå¤„ç†å’ŒæŒ–æ˜è¿™äº›è§„æ¨¡åºå¤§ã€ç»´åº¦å¤æ‚çš„åŒ»ç–—æ•°æ®ä¸­éšè—çš„ä»·å€¼ï¼Œå¯¼è‡´è®¸å¤šæœ‰ä»·å€¼çš„å…³è”æ€§è§„å¾‹æœªè¢«å……åˆ†åˆ©ç”¨ã€‚åŒæ—¶ï¼Œå¯¹äºè®¡ç®—æœºä¸“ä¸šçš„å­¦ç”Ÿè€Œè¨€ï¼Œå¦‚ä½•å°†å‰æ²¿çš„å¤§æ•°æ®æŠ€æœ¯åº”ç”¨äºå®é™…ä¸”æœ‰ç¤¾ä¼šæ„ä¹‰çš„é¢†åŸŸï¼Œæ˜¯ä¸€ä¸ªæå…·æŒ‘æˆ˜æ€§å’Œä»·å€¼çš„è¯¾é¢˜ã€‚å› æ­¤ï¼Œé€‰æ‹©ä¸€ä¸ªçœŸå®ä¸”å¤æ‚çš„åŒ»ç–—æ•°æ®é›†ï¼Œè¿ç”¨ä¸šç•Œä¸»æµçš„å¤§æ•°æ®å¤„ç†æ¡†æ¶è¿›è¡Œæ·±åº¦åˆ†æï¼Œä¸ä»…èƒ½å¤Ÿé”»ç‚¼å­¦ç”Ÿçš„å·¥ç¨‹å®è·µèƒ½åŠ›ï¼Œä¹Ÿèƒ½ä¸ºåŒ»å­¦ç ”ç©¶æä¾›ä¸€ç§æ–°çš„æ•°æ®é©±åŠ¨è§†è§’ã€‚</p>
<p>é€‰é¢˜æ„ä¹‰
è¿™ä¸ªæ¯•ä¸šè®¾è®¡é¡¹ç›®ï¼Œè™½ç„¶è§„æ¨¡æœ‰é™ï¼Œä½†å¸Œæœ›èƒ½å¸¦æ¥ä¸€äº›å®é™…çš„å‚è€ƒä»·å€¼ã€‚ä»æŠ€æœ¯å­¦ä¹ è§’åº¦çœ‹ï¼Œå®ƒèƒ½è®©åŒå­¦å®Œæ•´åœ°èµ°ä¸€éä»æ•°æ®é‡‡é›†ã€å­˜å‚¨ã€æ¸…æ´—ã€åˆ†æåˆ°å¯è§†åŒ–å±•ç¤ºçš„å¤§æ•°æ®é¡¹ç›®å…¨æµç¨‹ï¼Œæ·±å…¥æŒæ¡Sparkå’ŒDjangoç­‰æ ¸å¿ƒæŠ€æœ¯ï¼Œè¿™æ¯”å•çº¯åšä¸€ä¸ªå°å‹Webç³»ç»Ÿæˆ–CRUDé¡¹ç›®è¦æ›´æœ‰æ·±åº¦ã€‚ä»åº”ç”¨ä»·å€¼è§’åº¦çœ‹ï¼Œç³»ç»Ÿé€šè¿‡å¤šç»´åº¦æ•°æ®åˆ†æå¾—å‡ºçš„ç»“è®ºï¼Œæ¯”å¦‚ç‰¹å®šå¹´é¾„æ®µçš„é«˜å‘æ€§ã€æŸäº›ç”Ÿæ´»ä¹ æƒ¯ä¸ç–¾ç—…çš„å…³è”æ€§ï¼Œæˆ–è®¸èƒ½ä¸ºåŒ»å­¦ç ”ç©¶æä¾›ä¸€äº›æ•°æ®ä¸Šçš„ä½è¯æˆ–æ–°çš„ç ”ç©¶æ–¹å‘ï¼Œä¸ºå…¬ä¼—çš„å¥åº·ç§‘æ™®å’Œè‡ªæˆ‘æ£€æŸ¥æä¾›ç›´è§‚çš„å‚è€ƒã€‚æ€»çš„æ¥è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ªå°†æŠ€æœ¯å­¦ä¹ ä¸ç¤¾ä¼šä»·å€¼ç›¸ç»“åˆçš„å°è¯•ï¼Œä½“ç°äº†è®¡ç®—æœºç§‘å­¦åœ¨èµ‹èƒ½å…¶ä»–å­¦ç§‘æ–¹é¢çš„æ½œåŠ›ã€‚</p>
<h2 data-id="heading-3">çš®è‚¤ç™Œæ•°æ®å¯è§†åŒ–åˆ†æç³»ç»Ÿ-è§†é¢‘å±•ç¤º</h2>
<p>[video(video-vrPrBp5I-1768646839144)(type-csdn)(url-<a href="https://link.juejin.cn?target=https%3A%2F%2Flive.csdn.net%2Fv%2Fembed%2F510510)(image-https%3A%2F%2Fi-blog.csdnimg.cn%2Fdirect%2F32e4c1c8a4964ce9a5b82c6d409c2067.png)(title-%25E5%259F%25BA%25E4%25BA%258ESpark%2BDjango%25E7%259A%2584%25E7%259A%25AE%25E8%2582%25A4%25E7%2599%258C%25E6%2595%25B0%25E6%258D%25AE%25E5%258F%25AF%25E8%25A7%2586%25E5%258C%2596%25E5%2588%2586%25E6%259E%2590%25E7%25B3%25BB%25E7%25BB%259F" target="_blank" title="https://live.csdn.net/v/embed/510510)(image-https://i-blog.csdnimg.cn/direct/32e4c1c8a4964ce9a5b82c6d409c2067.png)(title-%E5%9F%BA%E4%BA%8ESpark+Django%E7%9A%84%E7%9A%AE%E8%82%A4%E7%99%8C%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F" ref="nofollow noopener noreferrer">live.csdn.net/v/embed/510â€¦</a>)]</p>
<h2 data-id="heading-4">çš®è‚¤ç™Œæ•°æ®å¯è§†åŒ–åˆ†æç³»ç»Ÿ-å›¾ç‰‡å±•ç¤º</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/20fdaed539e94f189c7fedbfd846eb53~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769252370&amp;x-signature=T6NiT1njGrPlwbqU%2BhYOtvNXTvo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ae95d356efd41ddac85fd4dc543b956~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769252370&amp;x-signature=LaxLSs48qcCLTl%2BqVjQRSi9lRtA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27edf02d705b4ce88d7c70ae7f453969~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769252370&amp;x-signature=%2FLIDcD5nPjdvvkf02e0EDqnuKF0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b161672b60d2491887824eb5087b179e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769252370&amp;x-signature=urSYD8aIhEPfLYOQ%2FYtbT5Ifj2M%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec00982f317545b19fc0e6cc885e9737~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769252370&amp;x-signature=NLhkV%2FA%2Ba9EkvcyozJpY4ZoKYjs%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cae80deaf0444539bead3338167517ce~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769252370&amp;x-signature=HYMSVR3OPGZdi9iR8DKFctudNVo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff4ff61513fc423ea9b7cc5e9831aa81~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769252370&amp;x-signature=BHZqRXPImRon7u%2BmnGEwmrF1sFI%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1dac4a12cf054b60a65a6c750f983608~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769252370&amp;x-signature=V%2BG%2F0DGEpDrV4j%2FAXKg%2BVGirx5k%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ba2dfa86dec4e00ae16722daeaf77dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769252370&amp;x-signature=F3QEAyvNOypb4qCHwcI8Uy0npkw%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d972214ec104337817b74715faa3cb0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769252370&amp;x-signature=CYIpm%2BmgujdOMwyn7esIoBSww1k%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-5">çš®è‚¤ç™Œæ•°æ®å¯è§†åŒ–åˆ†æç³»ç»Ÿ-ä»£ç å±•ç¤º</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> pyspark.sql <span class="hljs-keyword">import</span> SparkSession, functions <span class="hljs-keyword">as</span> F

spark = SparkSession.builder.appName(<span class="hljs-string">"SkinCancerAnalysis"</span>).getOrCreate()
df = spark.read.csv(<span class="hljs-string">"hdfs://path/to/skin_cancer_data.csv"</span>, header=<span class="hljs-literal">True</span>, inferSchema=<span class="hljs-literal">True</span>)

<span class="hljs-keyword">def</span> <span class="hljs-title function_">analyze_age_structure</span>(<span class="hljs-params">df</span>):
    df_with_age_group = df.withColumn(<span class="hljs-string">"age_group"</span>, F.when((F.col(<span class="hljs-string">"age"</span>) &gt;= <span class="hljs-number">0</span>) &amp; (F.col(<span class="hljs-string">"age"</span>) &lt; <span class="hljs-number">30</span>), <span class="hljs-string">"é’å¹´"</span>)
                                     .when((F.col(<span class="hljs-string">"age"</span>) &gt;= <span class="hljs-number">30</span>) &amp; (F.col(<span class="hljs-string">"age"</span>) &lt; <span class="hljs-number">50</span>), <span class="hljs-string">"ä¸­å¹´"</span>)
                                     .otherwise(<span class="hljs-string">"è€å¹´"</span>))
    age_diagnostic_count = df_with_age_group.groupBy(<span class="hljs-string">"age_group"</span>, <span class="hljs-string">"diagnostic"</span>).count()
    total_in_age_group = age_diagnostic_count.groupBy(<span class="hljs-string">"age_group"</span>).agg(F.<span class="hljs-built_in">sum</span>(<span class="hljs-string">"count"</span>).alias(<span class="hljs-string">"total"</span>))
    result = age_diagnostic_count.join(total_in_age_group, <span class="hljs-string">"age_group"</span>)
    result = result.withColumn(<span class="hljs-string">"percentage"</span>, F.<span class="hljs-built_in">round</span>((F.col(<span class="hljs-string">"count"</span>) / F.col(<span class="hljs-string">"total"</span>)) * <span class="hljs-number">100</span>, <span class="hljs-number">2</span>))
    result = result.orderBy(<span class="hljs-string">"age_group"</span>, <span class="hljs-string">"diagnostic"</span>)
    <span class="hljs-keyword">return</span> result.collect()

<span class="hljs-keyword">def</span> <span class="hljs-title function_">analyze_top_body_regions</span>(<span class="hljs-params">df</span>):
    region_count = df.<span class="hljs-built_in">filter</span>(F.col(<span class="hljs-string">"region"</span>).isNotNull()).groupBy(<span class="hljs-string">"region"</span>).count()
    top_regions = region_count.orderBy(F.col(<span class="hljs-string">"count"</span>).desc())
    <span class="hljs-keyword">return</span> top_regions.collect()

<span class="hljs-keyword">def</span> <span class="hljs-title function_">mine_symptom_associations_for_mel</span>(<span class="hljs-params">df</span>):
    mel_df = df.<span class="hljs-built_in">filter</span>(F.col(<span class="hljs-string">"diagnostic"</span>) == <span class="hljs-string">"MEL"</span>)
    symptom_cols = [<span class="hljs-string">"itch"</span>, <span class="hljs-string">"grew"</span>, <span class="hljs-string">"hurt"</span>, <span class="hljs-string">"changed"</span>, <span class="hljs-string">"bleed"</span>, <span class="hljs-string">"elevation"</span>]
    mel_symptoms = mel_df.select(*symptom_cols).na.fill(<span class="hljs-number">0</span>)
    frequent_itemsets = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(symptom_cols)):
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i + <span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(symptom_cols)):
            symptom_pair = mel_symptoms.<span class="hljs-built_in">filter</span>((F.col(symptom_cols[i]) == <span class="hljs-number">1</span>) &amp; (F.col(symptom_cols[j]) == <span class="hljs-number">1</span>))
            count = symptom_pair.count()
            <span class="hljs-keyword">if</span> count &gt; <span class="hljs-number">0</span>:
                frequent_itemsets.append({<span class="hljs-string">"symptom_pair"</span>: <span class="hljs-string">f"<span class="hljs-subst">{symptom_cols[i]}</span> &amp; <span class="hljs-subst">{symptom_cols[j]}</span>"</span>, <span class="hljs-string">"count"</span>: count})
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">sorted</span>(frequent_itemsets, key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'count'</span>], reverse=<span class="hljs-literal">True</span>)
</code></pre>
<h2 data-id="heading-6">çš®è‚¤ç™Œæ•°æ®å¯è§†åŒ–åˆ†æç³»ç»Ÿ-ç»“è¯­</h2>
<p>ä»æ•°æ®å¤„ç†åˆ°å‰ç«¯å‘ˆç°ï¼Œè¿™ä¸ªé¡¹ç›®è®©æˆ‘å¯¹å¤§æ•°æ®å…¨æµç¨‹å¼€å‘æœ‰äº†æ›´æ·±çš„ç†è§£ã€‚è™½ç„¶ç³»ç»Ÿè¿˜æœ‰è®¸å¤šå¯ä»¥å®Œå–„çš„åœ°æ–¹ï¼Œæ¯”å¦‚å¼•å…¥æ›´å¤æ‚çš„é¢„æµ‹æ¨¡å‹ï¼Œä½†å®ƒç¡®å®æ˜¯ä¸€æ¬¡å®è´µçš„å®è·µã€‚å¸Œæœ›è¿™ä¸ªåˆ†äº«èƒ½å¸®åˆ°æ­£åœ¨ä¸ºæ¯•è®¾å‘æ„çš„åŒå­¦ï¼Œç¥å¤§å®¶éƒ½èƒ½é¡ºåˆ©é€šå…³ã€‚</p>
<p>æ¯•è®¾é€‰é¢˜è¿˜åœ¨è¿·èŒ«ï¼Ÿè¿™ä¸ªç»“åˆäº†Sparkå¤§æ•°æ®å’ŒDjangoçš„çš®è‚¤ç™Œåˆ†æé¡¹ç›®æˆ–è®¸èƒ½ç»™ä½ çµæ„Ÿï¼è§‰å¾—æœ‰ç”¨çš„è¯ï¼Œåˆ«å¿˜äº†ç‚¹ä¸ªèµå’Œæ”¶è—ï¼Œä½ çš„æ”¯æŒæ˜¯æˆ‘æ›´æ–°çš„æœ€å¤§åŠ¨åŠ›ï¼æœ‰ä»»ä½•é—®é¢˜æˆ–æƒ³æ³•ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€äº¤æµï¼Œæˆ‘ä»¬ä¸€èµ·è¿›æ­¥ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernateï¼ˆ46ï¼‰ Hibernateçš„é…ç½®æ–‡ä»¶å¦‚ä½•åŠ è½½ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7595801647247327251</link>    <guid>https://juejin.cn/post/7595801647247327251</guid>    <pubDate>2026-01-16T11:55:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595801647247327251" data-draft-id="7595552420048338987" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernateï¼ˆ46ï¼‰ Hibernateçš„é…ç½®æ–‡ä»¶å¦‚ä½•åŠ è½½ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-16T11:55:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernateï¼ˆ46ï¼‰ Hibernateçš„é…ç½®æ–‡ä»¶å¦‚ä½•åŠ è½½ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T11:55:28.000Z" title="Fri Jan 16 2026 11:55:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    16
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨Hibernateä¸­ï¼Œé…ç½®æ–‡ä»¶é€šå¸¸ç”¨äºå®šä¹‰æ•°æ®åº“è¿æ¥ä¿¡æ¯ã€Hibernateå±æ€§å’Œå®ä½“ç±»æ˜ å°„ç­‰ã€‚å¸¸è§çš„é…ç½®æ–‡ä»¶åŒ…æ‹¬<code>hibernate.cfg.xml</code>å’Œ<code>hibernate.properties</code>ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•åŠ è½½Hibernateçš„é…ç½®æ–‡ä»¶ï¼Œå¹¶ç»“åˆä»£ç ç¤ºä¾‹è¯´æ˜ã€‚</p>
<h3 data-id="heading-0">åŠ è½½Hibernateé…ç½®æ–‡ä»¶</h3>
<h4 data-id="heading-1">1. ä½¿ç”¨<code>hibernate.cfg.xml</code>åŠ è½½é…ç½®</h4>
<p><code>hibernate.cfg.xml</code>æ˜¯æœ€å¸¸ç”¨çš„Hibernateé…ç½®æ–‡ä»¶ã€‚é€šå¸¸æ”¾ç½®åœ¨ç±»è·¯å¾„çš„æ ¹ç›®å½•ä¸‹ã€‚</p>
<h5 data-id="heading-2">ç¤ºä¾‹é…ç½®æ–‡ä»¶ <code>hibernate.cfg.xml</code></h5>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span>
        <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span>
        <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ•°æ®åº“è¿æ¥é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/your_database<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>your_username<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>your_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- Hibernate å±æ€§é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.show_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.format_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.hbm2ddl.auto"</span>&gt;</span>update<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- æ˜ å°„ç±» --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Product"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Category"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<h5 data-id="heading-3">åŠ è½½<code>hibernate.cfg.xml</code>çš„ç¤ºä¾‹ä»£ç </h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateUtil</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ä½¿ç”¨Configurationç±»åŠ è½½hibernate.cfg.xmlé…ç½®æ–‡ä»¶</span>
            sessionFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>).buildSessionFactory();
        } <span class="hljs-keyword">catch</span> (Throwable ex) {
            System.err.println(<span class="hljs-string">"Initial SessionFactory creation failed."</span> + ex);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExceptionInInitializerError</span>(ex);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SessionFactory <span class="hljs-title function_">getSessionFactory</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sessionFactory;
    }
}
</code></pre>
<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>new Configuration().configure("hibernate.cfg.xml")</code>ä¼šè‡ªåŠ¨æŸ¥æ‰¾ç±»è·¯å¾„ä¸‹çš„<code>hibernate.cfg.xml</code>æ–‡ä»¶ï¼Œå¹¶åŠ è½½å…¶ä¸­çš„é…ç½®ä¿¡æ¯ã€‚ç„¶åä½¿ç”¨è¿™äº›é…ç½®ä¿¡æ¯æ„å»º<code>SessionFactory</code>å®ä¾‹ã€‚</p>
<h4 data-id="heading-4">2. ä½¿ç”¨<code>hibernate.properties</code>åŠ è½½é…ç½®</h4>
<p>é™¤äº†<code>hibernate.cfg.xml</code>ï¼ŒHibernateè¿˜æ”¯æŒé€šè¿‡<code>hibernate.properties</code>æ–‡ä»¶åŠ è½½é…ç½®ä¿¡æ¯ã€‚</p>
<h5 data-id="heading-5">ç¤ºä¾‹é…ç½®æ–‡ä»¶ <code>hibernate.properties</code></h5>
<pre><code class="hljs language-properties" lang="properties">hibernate.connection.driver_class=com.mysql.cj.jdbc.Driver
hibernate.connection.url=jdbc:mysql://localhost:3306/your_database
hibernate.connection.username=your_username
hibernate.connection.password=your_password
hibernate.dialect=org.hibernate.dialect.MySQLDialect
hibernate.show_sql=true
hibernate.format_sql=true
hibernate.hbm2ddl.auto=update
</code></pre>
<h5 data-id="heading-6">åŠ è½½<code>hibernate.properties</code>çš„ç¤ºä¾‹ä»£ç </h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateUtil</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ä½¿ç”¨Configurationç±»åŠ è½½hibernate.propertiesé…ç½®æ–‡ä»¶</span>
            <span class="hljs-type">Configuration</span> <span class="hljs-variable">configuration</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>();
            configuration.configure(); <span class="hljs-comment">// é»˜è®¤ä¼šåŠ è½½ç±»è·¯å¾„ä¸‹çš„hibernate.cfg.xmlæˆ–hibernate.properties</span>
            sessionFactory = configuration.buildSessionFactory();
        } <span class="hljs-keyword">catch</span> (Throwable ex) {
            System.err.println(<span class="hljs-string">"Initial SessionFactory creation failed."</span> + ex);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExceptionInInitializerError</span>(ex);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SessionFactory <span class="hljs-title function_">getSessionFactory</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sessionFactory;
    }
}
</code></pre>
<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ<code>configuration.configure()</code>é»˜è®¤ä¼šåŠ è½½ç±»è·¯å¾„ä¸‹çš„<code>hibernate.cfg.xml</code>æˆ–<code>hibernate.properties</code>æ–‡ä»¶ï¼Œå¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚è°ƒæ•´ã€‚</p>
<h3 data-id="heading-7">é…ç½®æ–‡ä»¶åŠ è½½çš„æ·±å…¥è§£é‡Š</h3>
<ol>
<li>
<p><strong>Configurationç±»</strong>ï¼š</p>
<ul>
<li><code>org.hibernate.cfg.Configuration</code>ç±»æ˜¯Hibernateç”¨æ¥é…ç½®çš„æ ¸å¿ƒç±»ã€‚å®ƒå¯ä»¥ä»XMLæ–‡ä»¶æˆ–Javaå±æ€§æ–‡ä»¶åŠ è½½é…ç½®ã€‚</li>
<li><code>configure()</code>æ–¹æ³•é»˜è®¤æŸ¥æ‰¾ç±»è·¯å¾„æ ¹ç›®å½•ä¸‹çš„<code>hibernate.cfg.xml</code>æ–‡ä»¶ã€‚å¦‚æœæä¾›æ–‡ä»¶åå‚æ•°ï¼Œ<code>configure("hibernate.properties")</code>åˆ™ä¼šåŠ è½½æŒ‡å®šæ–‡ä»¶ã€‚</li>
</ul>
</li>
<li>
<p><strong>SessionFactory</strong>ï¼š</p>
<ul>
<li><code>SessionFactory</code>æ˜¯Hibernateæ¡†æ¶ä¸­çš„å…³é”®å¯¹è±¡ï¼Œè´Ÿè´£åˆ›å»º<code>Session</code>å¯¹è±¡ã€‚<code>Session</code>å¯¹è±¡æ˜¯å•çº¿ç¨‹çš„çŸ­æœŸå¯¹è±¡ï¼Œç”¨äºæ‰§è¡ŒCRUDæ“ä½œã€‚</li>
<li><code>SessionFactory</code>æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­å…¨å±€å…±äº«ï¼Œé€šå¸¸åœ¨åº”ç”¨å¯åŠ¨æ—¶åˆ›å»ºä¸€æ¬¡ï¼Œå¹¶åœ¨æ•´ä¸ªåº”ç”¨ç”Ÿå‘½å‘¨æœŸä¸­ä½¿ç”¨ã€‚</li>
</ul>
</li>
<li>
<p><strong>å¼‚å¸¸å¤„ç†</strong>ï¼š</p>
<ul>
<li>åœ¨é™æ€å—ä¸­åˆå§‹åŒ–<code>SessionFactory</code>ï¼Œå¹¶æ•è·ä»»ä½•å¯èƒ½çš„å¼‚å¸¸ã€‚å¦‚æœåˆå§‹åŒ–å¤±è´¥ï¼Œä¼šæŠ›å‡º<code>ExceptionInInitializerError</code>ï¼Œç¡®ä¿åº”ç”¨åŠæ—¶å‘ç°é…ç½®é—®é¢˜ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-8">ç»¼åˆç¤ºä¾‹</h3>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•é…ç½®å¹¶åŠ è½½Hibernateé…ç½®æ–‡ä»¶ï¼Œåˆ›å»º<code>SessionFactory</code>å¹¶æ‰§è¡Œä¸€äº›åŸºæœ¬æ“ä½œã€‚</p>
<h5 data-id="heading-9">å®Œæ•´ç¤ºä¾‹</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;

<span class="hljs-comment">// HibernateUtilç±»</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateUtil</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            sessionFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>).buildSessionFactory();
        } <span class="hljs-keyword">catch</span> (Throwable ex) {
            System.err.println(<span class="hljs-string">"Initial SessionFactory creation failed."</span> + ex);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExceptionInInitializerError</span>(ex);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SessionFactory <span class="hljs-title function_">getSessionFactory</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sessionFactory;
    }
}

<span class="hljs-comment">// Categoryç±»</span>
<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "category")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Category</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-meta">@Column(name = "name")</span>
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-meta">@OneToMany(mappedBy = "category", fetch = FetchType.LAZY, cascade = CascadeType.ALL)</span>
    <span class="hljs-keyword">private</span> Set&lt;Product&gt; products = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();

    <span class="hljs-comment">// Getters å’Œ Setters</span>
}

<span class="hljs-comment">// Productç±»</span>
<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "product")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Product</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-meta">@Column(name = "name")</span>
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-meta">@Column(name = "price")</span>
    <span class="hljs-keyword">private</span> Double price;

    <span class="hljs-meta">@ManyToOne</span>
    <span class="hljs-meta">@JoinColumn(name = "category_id")</span>
    <span class="hljs-keyword">private</span> Category category;

    <span class="hljs-comment">// Getters å’Œ Setters</span>
}

<span class="hljs-comment">// Hibernateæµ‹è¯•ç±»</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateTest</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è·å–SessionFactory</span>
        <span class="hljs-type">SessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> HibernateUtil.getSessionFactory();

        <span class="hljs-comment">// æ’å…¥ç¤ºä¾‹æ•°æ®</span>
        insertSampleData(sessionFactory);

        <span class="hljs-comment">// å…³é—­SessionFactory</span>
        sessionFactory.close();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insertSampleData</span><span class="hljs-params">(SessionFactory sessionFactory)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Category</span> <span class="hljs-variable">category</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Category</span>();
            category.setName(<span class="hljs-string">"Electronics"</span>);

            <span class="hljs-type">Product</span> <span class="hljs-variable">product1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>();
            product1.setName(<span class="hljs-string">"Laptop"</span>);
            product1.setPrice(<span class="hljs-number">1000.0</span>);

            <span class="hljs-type">Product</span> <span class="hljs-variable">product2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>();
            product2.setName(<span class="hljs-string">"Smartphone"</span>);
            product2.setPrice(<span class="hljs-number">500.0</span>);

            category.addProduct(product1);
            category.addProduct(product2);

            session.save(category);

            transaction.commit();
            System.out.println(<span class="hljs-string">"Inserted sample data"</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (transaction != <span class="hljs-literal">null</span>) {
                transaction.rollback();
            }
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            session.close();
        }
    }
}
</code></pre>
<p>åœ¨è¿™ä¸ªç»¼åˆç¤ºä¾‹ä¸­ï¼Œ<code>HibernateUtil</code>ç±»è´Ÿè´£åŠ è½½é…ç½®æ–‡ä»¶å¹¶åˆ›å»º<code>SessionFactory</code>ï¼Œ<code>Category</code>å’Œ<code>Product</code>ç±»å®šä¹‰äº†å®ä½“ï¼Œ<code>HibernateTest</code>ç±»åˆ™æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨Hibernateè¿›è¡Œæ•°æ®æ“ä½œã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥æœ‰æ•ˆåœ°åŠ è½½å’Œä½¿ç”¨Hibernateçš„é…ç½®æ–‡ä»¶è¿›è¡Œæ•°æ®åº“æ“ä½œã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Cursor æœ€æ–°å‘ç°ï¼šè¶…å¤§å‹é¡¹ç›® AI ä¹Ÿèƒ½åšäº†ï¼Œä¸Šç™¾ä¸ª Agent ä¸€èµ·ä¸Š]]></title>    <link>https://juejin.cn/post/7595842144906854450</link>    <guid>https://juejin.cn/post/7595842144906854450</guid>    <pubDate>2026-01-17T09:13:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595842144906854450" data-draft-id="7595831738234601481" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Cursor æœ€æ–°å‘ç°ï¼šè¶…å¤§å‹é¡¹ç›® AI ä¹Ÿèƒ½åšäº†ï¼Œä¸Šç™¾ä¸ª Agent ä¸€èµ·ä¸Š"/> <meta itemprop="keywords" content="å‰ç«¯,AIç¼–ç¨‹,Cursor"/> <meta itemprop="datePublished" content="2026-01-17T09:13:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¼ æ‹­å¿ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/571401775094312"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Cursor æœ€æ–°å‘ç°ï¼šè¶…å¤§å‹é¡¹ç›® AI ä¹Ÿèƒ½åšäº†ï¼Œä¸Šç™¾ä¸ª Agent ä¸€èµ·ä¸Š
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/571401775094312/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¼ æ‹­å¿ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T09:13:48.000Z" title="Sat Jan 17 2026 09:13:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ‹­å¿ƒã€‚</p>
<p>2008 å¹´ 9 æœˆ 2 æ—¥ï¼ŒGoogle Chrome æµè§ˆå™¨æ­£å¼å‘å¸ƒã€‚è¿™ä¸ªé¡¹ç›®ä» 2005 å¹´ç«‹é¡¹åˆ°å‘å¸ƒï¼Œ<strong>ã€Œå†æ—¶ 3 å¹´ï¼ŒæŠ•å…¥äº†æ•°åƒåå·¥ç¨‹å¸ˆã€</strong>ã€‚å¦‚ä»Šï¼ŒChromium ä»£ç è§„æ¨¡å·²è¶…è¿‡ 3600 ä¸‡è¡Œï¼Œè¢«ç§°ä¸ºâ€œäººç±»å²ä¸Šæœ€å¤æ‚çš„è½¯ä»¶å·¥ç¨‹é¡¹ç›®ä¹‹ä¸€â€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5f05cf35b2346cd9a49256b01845beb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5byg5out5b-D:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769246245&amp;x-signature=mifJjS1mapz9Vx2UnF9lKUg9sDw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è€Œå°±åœ¨æœ€è¿‘ï¼ŒCursor å›¢é˜Ÿåšäº†ä¸€ä»¶è®©äººéœ‡æƒŠçš„äº‹ï¼š<strong>ã€Œä»–ä»¬ç”¨ä¸Šç™¾ä¸ª AI Agentï¼ŒèŠ±äº†ä¸åˆ°ä¸€å‘¨æ—¶é—´ï¼Œä»é›¶å¼€å§‹æ„å»ºäº†ä¸€ä¸ªæµè§ˆå™¨ï¼Œå†™å‡ºäº†è¶…è¿‡ 100 ä¸‡è¡Œä»£ç ã€</strong>ã€‚</p>
<p>è¿™ä¸æ˜¯æ¦‚å¿µéªŒè¯ï¼Œä¹Ÿä¸æ˜¯ç©å…·é¡¹ç›®ã€‚</p>
<p>ä»–ä»¬ç”¨ Agent æŒç»­è¿è¡Œæ•°å‘¨ï¼Œåœ¨å¤šä¸ªè¶…å¤§å‹é¡¹ç›®ä¸Šå†™å‡ºäº†æ•°ç™¾ä¸‡è¡Œä»£ç ï¼šJava LSPï¼ˆ55 ä¸‡è¡Œï¼‰ã€Windows 7 æ¨¡æ‹Ÿå™¨ï¼ˆ120 ä¸‡è¡Œï¼‰ã€Excelï¼ˆ160 ä¸‡è¡Œï¼‰ã€‚æ›´ä»¤äººéœ‡æ’¼çš„æ˜¯ï¼Œå®ƒä»¬è¿˜ç›´æ¥åœ¨ Cursor è‡ªå·±çš„ç”Ÿäº§ä»£ç åº“ä¸­å®Œæˆäº†ä¸€æ¬¡å¤§è§„æ¨¡æ¡†æ¶è¿ç§»ï¼Œä»£ç å¢åˆ é‡è¾¾åˆ° +266K/-193Kï¼Œç”¨æ—¶ 3 å‘¨å¤šã€‚</p>
<p><strong>ã€Œä» 3 å¹´åˆ° 1 å‘¨ï¼Œä»æ•°åƒåå·¥ç¨‹å¸ˆåˆ°ä¸Šç™¾ä¸ª Agentï¼Œè¿™ä¸æ˜¯é‡å˜ï¼Œæ˜¯è´¨å˜ã€</strong>ã€‚</p>
<p>AI ç¼–ç¨‹æ­£åœ¨è·¨è¶Šä¸€ä¸ªå…³é”®é—¨æ§›ï¼šä»â€œè¾…åŠ©å†™ä»£ç â€åˆ°â€œè‡ªä¸»å¼€å‘é¡¹ç›®â€ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« æˆ‘ä»¬æ¥äº†è§£ä¸‹ Cursor æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Œä»¥åŠå¯¹æˆ‘ä»¬æ„å‘³ç€ä»€ä¹ˆã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å¤š Agent åä½œï¼šä»å¤±è´¥åˆ°çªç ´</h2>
<p>å•ä¸ª AI Agent èƒ½å†™å‡ºå‡ ç™¾è¡Œä»£ç ï¼Œä½†è¦å¼€å‘ä¸€ä¸ªç™¾ä¸‡è¡Œçº§åˆ«çš„é¡¹ç›®ï¼Œå…‰é ä¸€ä¸ª Agent æ˜¾ç„¶ä¸å¤Ÿã€‚</p>
<p>Cursor å›¢é˜Ÿçš„ç›®æ ‡æ˜¯è®©ç¼–ç  Agent æŒç»­è¿è¡Œæ•°å‘¨ï¼Œå®Œå…¨è‡ªä¸»åœ°å®Œæˆè¶…å¤§å‹é¡¹ç›®ã€‚</p>
<p>è¿™æ„å‘³ç€å¿…é¡»è®©ä¸Šç™¾ä¸ª Agent åŒæ—¶å·¥ä½œã€‚ä½†é—®é¢˜æ¥äº†ï¼š<strong>ã€Œæ€ä¹ˆè®©å®ƒä»¬é«˜æ•ˆåä½œï¼Œè€Œä¸æ˜¯äº’ç›¸å¹²æ‰°ï¼Ÿã€</strong></p>
<h3 data-id="heading-1">1.1 æ‰å¹³ç»“æ„ï¼šä¸€åœºç¾éš¾</h3>
<p>Cursor å›¢é˜Ÿæœ€åˆçš„æƒ³æ³•å¾ˆç›´è§‰ï¼šè®©æ‰€æœ‰ Agent å…·æœ‰åŒç­‰åœ°ä½ï¼Œé€šè¿‡ä¸€ä¸ªå…±äº«æ–‡ä»¶è‡ªè¡ŒååŒã€‚</p>
<p>æ¯ä¸ª Agent ä¼šæ£€æŸ¥å…¶ä»– Agent åœ¨åšä»€ä¹ˆã€è®¤é¢†ä¸€ä¸ªä»»åŠ¡å¹¶æ›´æ–°è‡ªå·±çš„çŠ¶æ€ã€‚ä¸ºé˜²æ­¢ä¸¤ä¸ª Agent æŠ¢å åŒä¸€é¡¹ä»»åŠ¡ï¼Œä»–ä»¬ä½¿ç”¨äº†é”æœºåˆ¶ã€‚</p>
<p>ä½†è¿™å¥—æ–¹æ¡ˆåœ¨å¹¶å‘æ–¹é¢å¤±è´¥äº†ï¼š</p>
<p><strong>ã€Œé”æœºåˆ¶æˆäº†ç“¶é¢ˆã€</strong>ã€‚ Agent ä¼šæŒæœ‰é”å¤ªä¹…ï¼Œæˆ–è€…å¹²è„†å¿˜è®°é‡Šæ”¾é”ã€‚å³ä½¿é”æœºåˆ¶æ­£å¸¸å·¥ä½œï¼Œå®ƒä¹Ÿä¼šæˆä¸ºç“¶é¢ˆã€‚äºŒåä¸ª Agent çš„é€Ÿåº¦ä¼šä¸‹é™åˆ°ç›¸å½“äºä¸¤ä¸‰ä¸ª Agent çš„æœ‰æ•ˆååé‡ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±åœ¨ç­‰å¾…ä¸Šã€‚</p>
<p><strong>ã€Œç³»ç»Ÿéå¸¸è„†å¼±ã€</strong>ã€‚ Agent å¯èƒ½åœ¨æŒæœ‰é”çš„æƒ…å†µä¸‹å¤±è´¥ã€å°è¯•è·å–è‡ªå·±å·²ç»æŒæœ‰çš„é”ï¼Œæˆ–è€…åœ¨å®Œå…¨æ²¡æœ‰è·å–é”çš„æƒ…å†µä¸‹æ›´æ–°åè°ƒæ–‡ä»¶ã€‚</p>
<p>åæ¥ä»–ä»¬å°è¯•ç”¨ä¹è§‚å¹¶å‘æ§åˆ¶æ¥æ›¿ä»£é”ï¼šAgent å¯ä»¥è‡ªç”±è¯»å–çŠ¶æ€ï¼Œä½†å¦‚æœè‡ªä¸Šæ¬¡è¯»å–åçŠ¶æ€å·²ç»å‘ç”Ÿå˜åŒ–ï¼Œåˆ™å†™å…¥ä¼šå¤±è´¥ã€‚è¿™ç§æ–¹å¼æ›´ç®€å•ã€ä¹Ÿæ›´å¥å£®ï¼Œä½†æ›´æ·±å±‚çš„é—®é¢˜ä¾ç„¶å­˜åœ¨ã€‚</p>
<p>åœ¨æ²¡æœ‰ç¡®å®šä»»åŠ¡çš„æƒ…å†µä¸‹ï¼ŒAgent å˜å¾—éå¸¸è§„é¿é£é™©ã€‚ å®ƒä»¬ä¼šå›é¿å›°éš¾ä»»åŠ¡ï¼Œè½¬è€Œåšä¸€äº›å°è€Œå®‰å…¨çš„ä¿®æ”¹ã€‚<strong>ã€Œæ²¡æœ‰ä»»ä½•ä¸€ä¸ª Agent æ‰¿æ‹…èµ·è§£å†³éš¾é¢˜æˆ–ç«¯åˆ°ç«¯å®ç°çš„è´£ä»»ã€</strong>ï¼ˆåƒæäº†æ›¾ç»é‡åˆ°çš„åŒäº‹ï¼‰ã€‚ç»“æœå°±æ˜¯å·¥ä½œé•¿æ—¶é—´åœ¨ç©ºè½¬ï¼Œå´æ²¡æœ‰å®è´¨æ€§è¿›å±•ã€‚</p>
<p>è¿™å°±åƒä¸€ä¸ªæ²¡æœ‰é¡¹ç›®ç»ç†çš„å›¢é˜Ÿï¼Œæ¯ä¸ªäººéƒ½åœ¨åšâ€œçœ‹èµ·æ¥å®‰å…¨â€çš„å°ä»»åŠ¡ï¼Œæ²¡äººæ•¢ç¢°æ ¸å¿ƒéš¾é¢˜ã€‚</p>
<h3 data-id="heading-2">1.2 åˆ†å±‚ç»“æ„ï¼šåƒçœŸå®çš„å›¢é˜Ÿä¸€æ ·å·¥ä½œ</h3>
<p>Cursor å›¢é˜Ÿåæ¥å°è¯•é‡Œå°†ä¸åŒè§’è‰²æ‹†åˆ†å¼€æ¥ã€‚ä¸å†ä½¿ç”¨æ¯ä¸ª Agent éƒ½ä»€ä¹ˆéƒ½åšçš„æ‰å¹³ç»“æ„ï¼Œè€Œæ˜¯æ­å»ºäº†ä¸€æ¡èŒè´£æ¸…æ™°çš„æµæ°´çº¿ï¼š</p>
<ul>
<li><strong>ã€Œè§„åˆ’è€…ã€</strong>ï¼ˆPlannersï¼‰ï¼šæŒç»­æ¢ç´¢ä»£ç åº“å¹¶åˆ›å»ºä»»åŠ¡ã€‚ä»–ä»¬å¯ä»¥é’ˆå¯¹ç‰¹å®šåŒºåŸŸæ´¾ç”Ÿå­è§„åˆ’è€…ï¼Œä½¿è§„åˆ’è¿‡ç¨‹æœ¬èº«ä¹Ÿå¯ä»¥å¹¶è¡Œä¸”é€’å½’åœ°å±•å¼€ã€‚</li>
<li><strong>ã€Œæ‰§è¡Œè€…ã€</strong>ï¼ˆWorkersï¼‰ï¼šé¢†å–ä»»åŠ¡å¹¶ä¸“æ³¨äºæŠŠä»»åŠ¡å®Œæˆåˆ°åº•ã€‚ä»–ä»¬ä¸ä¼šä¸å…¶ä»–æ‰§è¡Œè€…åè°ƒï¼Œä¹Ÿä¸å…³å¿ƒæ•´ä½“å¤§å±€ï¼Œåªæ˜¯å…¨åŠ›å¤„ç†è‡ªå·±è¢«åˆ†é…çš„ä»»åŠ¡ï¼Œå®Œæˆåå†æäº¤å˜æ›´ã€‚</li>
</ul>
<p>åœ¨æ¯ä¸ªå‘¨æœŸç»“æŸæ—¶ï¼Œä¼šæœ‰ä¸€ä¸ª**ã€Œè¯„å®¡ Agentã€**åˆ¤æ–­æ˜¯å¦ç»§ç»­ï¼Œç„¶åä¸‹ä¸€è½®è¿­ä»£ä¼šä»å¹²å‡€çš„åˆå§‹çŠ¶æ€é‡æ–°å¼€å§‹ã€‚</p>
<p>è¿™å¥—ç»“æ„åŸºæœ¬è§£å†³äº†ååŒé—®é¢˜ï¼Œå¹¶ä¸”è®©ä»–ä»¬å¯ä»¥æ‰©å±•åˆ°éå¸¸å¤§çš„é¡¹ç›®ï¼Œè€Œä¸ä¼šè®©ä»»ä½•å•ä¸ª Agent é™·å…¥è§†é‡è¿‡äºç‹­çª„çš„çŠ¶æ€ã€‚æˆç™¾ä¸Šåƒä¸ª Worker å¹¶å‘è¿è¡Œï¼Œå‘åŒä¸€ä¸ªåˆ†æ”¯æ¨é€ä»£ç ï¼Œè€Œä¸”å‡ ä¹æ²¡æœ‰å†²çªã€‚</p>
<p>è¿™å°±åƒä¸€ä¸ªçœŸå®çš„å¼€å‘å›¢é˜Ÿï¼š<strong>ã€Œæœ‰äººè´Ÿè´£æ¶æ„è®¾è®¡å’Œä»»åŠ¡æ‹†è§£ï¼Œæœ‰äººä¸“æ³¨æ‰§è¡Œå…·ä½“ä»»åŠ¡ï¼Œå„å¸å…¶èŒï¼Œé«˜æ•ˆåä½œã€‚ã€</strong></p>
<h3 data-id="heading-3">1.3 ä¸‰ä¸ªéœ‡æ’¼æ¡ˆä¾‹</h3>
<p>æœ‰äº†è¿™å¥—ç³»ç»Ÿåï¼ŒCursor å›¢é˜Ÿå¼€å§‹æµ‹è¯•å®ƒçš„è¾¹ç•Œï¼š</p>
<p><strong>ã€Œä»é›¶å¼€å§‹æ„å»ºæµè§ˆå™¨ã€</strong>ã€‚ Agent æŒç»­è¿è¡Œäº†å°†è¿‘ä¸€å‘¨ï¼Œåœ¨ 1ï¼Œ000 ä¸ªæ–‡ä»¶ä¸­å†™å‡ºäº†è¶…è¿‡ 100 ä¸‡è¡Œä»£ç ã€‚è™½ç„¶çœ‹èµ·æ¥åªæ˜¯ä¸€å¼ ç®€å•çš„æˆªå›¾ï¼Œä½†ä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ªæµè§ˆå™¨æå…¶å›°éš¾ã€‚å°½ç®¡ä»£ç åº“è§„æ¨¡åºå¤§ï¼Œæ–°å¯åŠ¨çš„ Agent ä»ç„¶å¯ä»¥ç†è§£å®ƒå¹¶å–å¾—å®è´¨æ€§è¿›å±•ã€‚</p>
<p><strong>ã€ŒCursor ä»£ç åº“çš„æ¡†æ¶è¿ç§»ã€</strong>ã€‚ ä»–ä»¬åœ¨ Cursor ä»£ç åº“ä¸­å°±åœ°å°† Solid è¿ç§»åˆ° Reactï¼Œæ•´ä¸ªè¿‡ç¨‹æŒç»­äº† 3 å‘¨å¤šï¼Œä»£ç å¢åˆ é‡è¾¾åˆ° +266K/-193Kã€‚éšç€æµ‹è¯•çš„è¿›è¡Œï¼Œä»–ä»¬ç¡®å®è®¤ä¸ºæœ‰å¯èƒ½åˆå¹¶è¿™æ¬¡å¤§è§„æ¨¡æ”¹åŠ¨ã€‚</p>
<p><strong>ã€Œäº§å“æ€§èƒ½æå‡ 25 å€ã€</strong>ã€‚ åœ¨ä¸€æ¬¾å³å°†ä¸Šçº¿çš„äº§å“ä¸­ï¼Œä¸€ä¸ªé•¿æ—¶é—´è¿è¡Œçš„ Agent é€šè¿‡ä¸€ä¸ªé«˜æ•ˆçš„ Rust å®ç°ï¼Œè®©è§†é¢‘æ¸²æŸ“é€Ÿåº¦æå‡äº† 25 å€ã€‚å®ƒè¿˜æ–°å¢äº†å¹³æ»‘ç¼©æ”¾å’Œå¹³ç§»çš„èƒ½åŠ›ï¼Œä½¿ç”¨è‡ªç„¶çš„å¼¹ç°§è¿‡æ¸¡å’Œè¿åŠ¨æ¨¡ç³Šæ•ˆæœï¼Œå¹¶èƒ½è·Ÿéšå…‰æ ‡é¡ºç•…ç§»åŠ¨ã€‚è¿™éƒ¨åˆ†ä»£ç å·²ç»åˆå¹¶ï¼Œä¸ä¹…å°±ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¸Šçº¿ã€‚</p>
<p>è¿™äº›æ¡ˆä¾‹è¯æ˜ï¼Œå¤š Agent å¼€å‘å¤§å‹é¡¹ç›®ä¸å†æ˜¯æ¦‚å¿µéªŒè¯ï¼Œè€Œæ˜¯çœŸå®çš„ç”Ÿäº§åŠ›ã€‚</p>
<h2 data-id="heading-4">äºŒã€ä¸ºä»€ä¹ˆç°åœ¨å¯ä»¥åšåˆ°</h2>
<p>ä¸Šç™¾ä¸ª Agent åä½œå¼€å‘è¶…å¤§å‹é¡¹ç›®ï¼Œè¿™åœ¨ä¸€å¹´å‰å‡ ä¹æ˜¯ä¸å¯æƒ³è±¡çš„ã€‚Cursor å›¢é˜Ÿçš„æˆåŠŸï¼ŒèƒŒåæœ‰å‡ ä¸ªå…³é”®å› ç´ ã€‚</p>
<h3 data-id="heading-5">2.1 æ¨¡å‹èƒ½åŠ›çš„è´¨å˜</h3>
<p>åœ¨è¿è¡Œæ—¶é—´æé•¿çš„ä»»åŠ¡ä¸­ï¼Œæ¨¡å‹é€‰æ‹©è‡³å…³é‡è¦ã€‚Cursor å›¢é˜Ÿå‘ç°ï¼Œä¸åŒæ¨¡å‹åœ¨é•¿æ—¶é—´è‡ªä¸»å·¥ä½œæ—¶è¡¨ç°å·®å¼‚å·¨å¤§ã€‚</p>
<p><strong>ã€ŒGPT-5.2 ç³»åˆ—åœ¨é•¿æ—¶é—´è‡ªä¸»å·¥ä½œæ–¹é¢è¦ä¼˜ç§€å¾—å¤šï¼šæ›´èƒ½éµå¾ªæŒ‡ä»¤ã€ä¿æŒä¸“æ³¨ã€é¿å…åç¦»ï¼Œå¹¶ä¸”åœ¨å®ç°ä¸Šæ›´åŠ ç²¾ç¡®å’Œå®Œæ•´ã€</strong>ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒOpus 4.5 å¾€å¾€ä¼šæ›´æ—©ç»“æŸã€åœ¨æ–¹ä¾¿çš„æ—¶å€™èµ°æ·å¾„ï¼Œæ›´å¿«åœ°æŠŠæ§åˆ¶æƒäº¤è¿˜ç»™ç”¨æˆ·ã€‚</p>
<p>è¿™ä¸æ˜¯è¯´ Opus 4.5 ä¸å¥½ï¼Œè€Œæ˜¯ä¸åŒæ¨¡å‹æœ‰ä¸åŒçš„â€œæ€§æ ¼â€ã€‚Opus 4.5 æ›´é€‚åˆéœ€è¦äººç±»é¢‘ç¹ä»‹å…¥çš„åœºæ™¯ï¼Œè€Œ GPT-5.2 æ›´é€‚åˆé•¿æ—¶é—´æ— äººå€¼å®ˆçš„è‡ªä¸»å¼€å‘ã€‚</p>
<p>æ›´æœ‰æ„æ€çš„æ˜¯ï¼Œä¸åŒæ¨¡å‹åœ¨ä¸åŒè§’è‰²ä¸Šå„æœ‰æ‰€é•¿ã€‚å³ä¾¿ GPT-5.1-codex æ˜¯ä¸“é—¨ä¸ºç¼–ç è®­ç»ƒçš„ï¼ŒGPT-5.2 ä¾ç„¶æ˜¯æ›´å¥½çš„è§„åˆ’è€…ã€‚ç°åœ¨ Cursor å›¢é˜Ÿä¼š**ã€Œé’ˆå¯¹æ¯ä¸ªè§’è‰²é€‰æ‹©æœ€é€‚åˆçš„æ¨¡å‹ï¼Œè€Œä¸æ˜¯ä¾èµ–å•ä¸€é€šç”¨æ¨¡å‹ã€**ã€‚</p>
<p>è§„åˆ’è€…ç”¨ GPT-5.2ï¼Œæ‰§è¡Œè€…ç”¨ GPT-5.1-codexï¼Œè¯„å®¡è€…å¯èƒ½åˆæ˜¯å¦ä¸€ä¸ªæ¨¡å‹ã€‚è¿™å°±åƒç»„å»ºä¸€ä¸ªçœŸå®å›¢é˜Ÿï¼Œä½ ä¼šæ ¹æ®æ¯ä¸ªå²—ä½çš„ç‰¹ç‚¹é€‰æ‹©æœ€åˆé€‚çš„äººã€‚</p>
<h3 data-id="heading-6">2.2 æç¤ºè¯æ¯”æ¡†æ¶æ›´é‡è¦</h3>
<p>ç³»ç»Ÿä¸­æœ‰ç›¸å½“å¤§ä¸€éƒ¨åˆ†è¡Œä¸ºï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºå¦‚ä½•ä¸ºè¿™äº› Agent è®¾è®¡æç¤ºè¯ã€‚è¦è®©å®ƒä»¬è‰¯å¥½åä½œã€é¿å…å¼‚å¸¸è¡Œä¸ºï¼Œå¹¶åœ¨é•¿æ—¶é—´å†…ä¿æŒä¸“æ³¨ï¼ŒCursor å›¢é˜Ÿåšäº†å¤§é‡å®éªŒã€‚</p>
<p>è¿è¡Œæ¡†æ¶å’Œæ¨¡å‹æœ¬èº«å›ºç„¶é‡è¦ï¼Œä½†æç¤ºè¯æ›´é‡è¦ã€‚</p>
<p>è¿™ä¸ªç»“è®ºå¯èƒ½è®©å¾ˆå¤šäººæ„å¤–ã€‚æˆ‘ä»¬å¾€å¾€ä»¥ä¸ºæŠ€æœ¯æ¶æ„å’Œæ¨¡å‹æ‰æ˜¯å…³é”®ï¼Œä½† Cursor å›¢é˜Ÿå‘ç°ï¼ŒåŒæ ·çš„æ¶æ„ï¼Œä¸åŒçš„æç¤ºè¯è®¾è®¡ï¼ŒAgent çš„è¡¨ç°ä¼šæœ‰å¤©å£¤ä¹‹åˆ«ã€‚</p>
<p>å¦‚ä½•è®©è§„åˆ’è€…æ‹†è§£ä»»åŠ¡æ—¶ç²’åº¦åˆé€‚ï¼Ÿå¦‚ä½•è®©æ‰§è¡Œè€…åœ¨é‡åˆ°å›°éš¾æ—¶ä¸æ”¾å¼ƒï¼Ÿå¦‚ä½•è®©è¯„å®¡è€…å‡†ç¡®åˆ¤æ–­å·¥ä½œè´¨é‡ï¼Ÿè¿™äº›éƒ½éœ€è¦ç²¾å¿ƒè®¾è®¡çš„æç¤ºè¯ã€‚</p>
<p>è¿™ä¹Ÿæ­ç¤ºäº†ä¸€ä¸ªé‡è¦è¶‹åŠ¿ï¼š<strong>ã€ŒPrompt Engineeringï¼ˆæç¤ºè¯å·¥ç¨‹ï¼‰æ˜¯æˆä¸º AI æ—¶ä»£çš„æ ¸å¿ƒæŠ€èƒ½ã€‚ã€</strong></p>
<blockquote>
<p>â</p>
<p>æ¨èé˜…è¯»æˆ‘å†™çš„ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Fxiaobot.net%2Fp%2Fai_1024" target="_blank" title="https://xiaobot.net/p/ai_1024" ref="nofollow noopener noreferrer">æç¤ºè¯å·¥ç¨‹ï¼šä½ ç¼ºçš„ä¸åªæ˜¯ä¸“ä¸šæœ¯è¯­</a>ã€‹</p>
<p>â</p>
</blockquote>
<h3 data-id="heading-7">2.3 å‡æ³•æ€ç»´ï¼šå°‘å³æ˜¯å¤š</h3>
<p>Cursor å›¢é˜Ÿçš„è®¸å¤šæ”¹è¿›æ¥è‡ªâ€œå‡æ³•â€è€Œä¸æ˜¯â€œåŠ æ³•â€ã€‚</p>
<p>ä¸€å¼€å§‹ä»–ä»¬ä¸ºè´¨é‡æ§åˆ¶å’Œå†²çªè§£å†³è®¾è®¡äº†ä¸€ä¸ªé›†æˆè€…ï¼ˆIntegratorï¼‰è§’è‰²ï¼Œä¸“é—¨è´Ÿè´£åè°ƒå„ä¸ª Worker çš„ä»£ç ã€è§£å†³å†²çªã€ç¡®ä¿è´¨é‡ã€‚å¬èµ·æ¥å¾ˆåˆç†ï¼Œå¯¹å§ï¼Ÿ</p>
<p>ä½†åæ¥å‘ç°ï¼Œ<strong>ã€Œé›†æˆè€…åˆ¶é€ çš„ç“¶é¢ˆå¤šäºè§£å†³çš„é—®é¢˜ã€‚å„ä¸ª Worker æœ¬èº«å°±å·²ç»æœ‰èƒ½åŠ›å¤„ç†å½¼æ­¤ä¹‹é—´çš„å†²çªã€‚å¤šå‡ºæ¥çš„è¿™ä¸ªè§’è‰²åè€Œè®©æµç¨‹å˜å¾—å¤æ‚ã€è„†å¼±ï¼Œæˆäº†æ•´ä¸ªç³»ç»Ÿçš„ç“¶é¢ˆã€</strong>ã€‚</p>
<p>å»æ‰é›†æˆè€…åï¼Œç³»ç»Ÿåè€Œæ›´æµç•…äº†ã€‚</p>
<p>è¿™ä¸ªç»éªŒå¾ˆæœ‰å¯å‘æ€§ï¼šæœ€å¥½çš„ç³»ç»Ÿå¾€å¾€æ¯”ä½ æƒ³çš„æ›´ç®€å•ã€‚èµ·åˆ Cursor å›¢é˜Ÿå°è¯•å€Ÿé‰´åˆ†å¸ƒå¼è®¡ç®—å’Œç»„ç»‡è®¾è®¡ä¸­çš„ç³»ç»Ÿæ¨¡å‹ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½é€‚ç”¨äº Agentã€‚</p>
<h2 data-id="heading-8">ä¸‰ã€å‰§å˜æ¥ä¸´çš„ä¿¡å·</h2>
<p>Cursor å›¢é˜Ÿå‘Šè¯‰æˆ‘ä»¬ï¼Œ<strong>ã€Œä¸Šç™¾ä¸ª Agent å¯ä»¥åœ¨åŒä¸€ä¸ªä»£ç åº“ä¸ŠååŒå·¥ä½œæ•°å‘¨ï¼Œæ¨åŠ¨é›„å¿ƒå‹ƒå‹ƒçš„é¡¹ç›®å–å¾—å®è´¨è¿›å±•ã€‚è¿™ä¸æ˜¯ç†è®ºï¼Œè€Œæ˜¯å·²ç»å‘ç”Ÿçš„ç°å®ã€</strong>ã€‚</p>
<p>ä½†ä»–ä»¬ä¹Ÿå¦æ‰¿ï¼šå¤šæ™ºèƒ½ä½“ååŒä»ç„¶æ˜¯ä¸€ä¸ªéš¾é¢˜ã€‚å½“å‰çš„ç³»ç»Ÿè™½ç„¶å¯ç”¨ï¼Œä½†ç¦»æœ€ä¼˜çŠ¶æ€è¿˜å·®å¾—å¾ˆè¿œã€‚Planner åº”è¯¥åœ¨ä»»åŠ¡å®Œæˆæ—¶è‡ªåŠ¨â€œé†’æ¥â€è§„åˆ’ä¸‹ä¸€æ­¥ï¼ŒAgent æœ‰æ—¶ä¼šè¿è¡Œæ—¶é—´è¿‡é•¿ï¼Œä»–ä»¬ä»ç„¶éœ€è¦å®šæœŸä»å¤´é‡å¯ï¼Œä»¥å¯¹æŠ—æ¼‚ç§»å’Œæ€ç»´è§†é‡è¿‡äºç‹­çª„çš„é—®é¢˜ã€‚</p>
<p>å³ä¾¿å¦‚æ­¤ï¼Œå¯¹äºæ ¸å¿ƒé—®é¢˜â€”â€”â€œèƒ½å¦é€šè¿‡æŠ•å…¥æ›´å¤š Agent æ¥æ‰©å±• AI è‡ªä¸»ç¼–ç èƒ½åŠ›â€â€”â€”ä»–ä»¬å¾—åˆ°çš„ç­”æ¡ˆä¾ç„¶æ¯”é¢„æœŸæ›´ä¹è§‚ã€‚</p>
<p>å›é¡¾è¿‡å»å‡ å¹´ AI ç¼–ç¨‹å·¥å…·çš„å‘å±•ï¼š</p>
<ul>
<li>2022 å¹´ï¼šGitHub Copilot è¡¥å…¨ä»£ç ç‰‡æ®µ</li>
<li>2023 å¹´ï¼šChatGPT ç”Ÿæˆå®Œæ•´å‡½æ•°</li>
<li>2024 å¹´ï¼šCursor ç†è§£é¡¹ç›®ä¸Šä¸‹æ–‡</li>
<li>2025 å¹´ï¼šCursor/TRAE æ”¯æŒ Agent è‡ªä¸»å¼€å‘</li>
<li>2026 å¹´ï¼šCursor æ¢ç´¢å¤š Agent ç³»ç»Ÿè‡ªä¸»å¼€å‘è¶…å¤§å‹é¡¹ç›®</li>
</ul>
<p>ç¼–ç¨‹å·¥å…·è¿›å±•ç¥é€Ÿï¼ŒAI ä»â€œè¾…åŠ©å†™ä»£ç â€å˜æˆäº†â€œè‡ªä¸»å¼€å‘é¡¹ç›®â€ã€‚</p>
<p>ä»Šå¤©ï¼ŒCursor ç”¨ä¸Šç™¾ä¸ª Agent å†™å‡ºäº† 100 ä¸‡è¡Œä»£ç ã€‚æ˜å¹´å‘¢ï¼Ÿåå¹´å‘¢ï¼ŸAI ç¼–ç¨‹çš„èƒ½åŠ›è¾¹ç•Œæ­£åœ¨å¿«é€Ÿæ‰©å¼ ã€‚</p>
<p>å¯¹äºå¼€å‘è€…æ¥è¯´ï¼šå¦‚æœä½ çš„æ ¸å¿ƒèƒ½åŠ›æ˜¯â€œå†™ä»£ç â€ï¼Œé‚£ä¹ˆä½ éœ€è¦è­¦æƒ•äº†ã€‚<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fxiaobot.net%2Fp%2Fai_1024" target="_blank" title="https://xiaobot.net/p/ai_1024" ref="nofollow noopener noreferrer">ä½†å¦‚æœä½ çš„æ ¸å¿ƒèƒ½åŠ›æ˜¯â€œç†è§£éœ€æ±‚ã€è®¾è®¡æ¶æ„ã€åè°ƒèµ„æºã€è§£å†³é—®é¢˜â€ï¼Œé‚£ä¹ˆä½ åè€Œä¼šå› ä¸º AI è€Œå˜å¾—æ›´å¼ºå¤§ã€‚</a></strong></p>
<p>é‚£äº›æå‰æ‹¥æŠ± AIã€å­¦ä¼šä¸ AI åä½œçš„äººï¼Œæ­£åœ¨è·å¾—å·¨å¤§çš„ç«äº‰ä¼˜åŠ¿ã€‚ä¸è¦ç­‰åˆ° AI å®Œå…¨æˆç†Ÿäº†å†å»å­¦ä¹ ï¼Œå› ä¸ºåˆ°é‚£æ—¶å€™ï¼Œçª—å£æœŸå¯èƒ½å·²ç»å…³é—­äº†ã€‚</p>
<p>Cursor ç”¨ä¸Šç™¾ä¸ª Agent å¼€å‘è¶…å¤§å‹é¡¹ç›®ï¼Œè¿™ä¸æ˜¯ç»ˆç‚¹ï¼Œè€Œæ˜¯èµ·ç‚¹ã€‚å‰§å˜æ­£åœ¨å‘ç”Ÿï¼Œä½ å‡†å¤‡å¥½äº†å—ï¼Ÿ</p>
<p>å¥½äº†ï¼Œè¿™ç¯‡æ–‡ç« åˆ°è¿™é‡Œå°±ç»“æŸäº†ã€‚æ„Ÿè°¢ä½ çš„é˜…è¯»ï¼Œæ„¿ä½ å¹³å®‰é¡ºé‚ã€‚</p>
<p>å¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿è¯„è®ºç‚¹èµè½¬å‘ï¼Œä½ çš„æ”¯æŒæ˜¯æˆ‘æœ€å¤§çš„åŠ¨åŠ›â¤ï¸</p>
<p>å‚è€ƒèµ„æ–™ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcursor.com%2Fcn%2Fblog%2Fscaling-agents" target="_blank" title="https://cursor.com/cn/blog/scaling-agents" ref="nofollow noopener noreferrer">cursor.com/cn/blog/scaâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ruoyiä¸“é¢˜]]></title>    <link>https://juejin.cn/post/7595911076013932580</link>    <guid>https://juejin.cn/post/7595911076013932580</guid>    <pubDate>2026-01-17T06:38:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595911076013932580" data-draft-id="7593296804110041128" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ruoyiä¸“é¢˜"/> <meta itemprop="keywords" content="Java,Spring Boot,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-17T06:38:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“ªé‡Œçš„ç ´æ°´ç“¶"/> <meta itemprop="url" content="https://juejin.cn/user/4394111849466414"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ruoyiä¸“é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4394111849466414/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“ªé‡Œçš„ç ´æ°´ç“¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T06:38:30.000Z" title="Sat Jan 17 2026 06:38:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#444;background-image:linear-gradient(90deg,rgba(59,59,59,.1) 3%,transparent 0),linear-gradient(1turn,rgba(122,120,121,.1) 3%,transparent 0);background-size:30px 30px;background-position:50%;letter-spacing:1px;word-spacing:1px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:34px;margin-bottom:16px;font-weight:700;line-height:1.3;cursor:text;color:#444;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body h1{font-size:41px;margin-bottom:34px;line-height:1.5}.markdown-body h1:before{content:""}.markdown-body h2{font-size:30px;padding-left:.4em;border-left:.4em solid #5e5e5e;border-bottom:1px solid #444}.markdown-body h2:after{content:"ğŸ•›";position:absolute;top:0;right:0;transition:all;animation:rotate 10s linear infinite}@keyframes rotate{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.markdown-body h3{border-left:.4em solid #8d8d8d;font-size:24px;padding-left:.4em}.markdown-body h4{font-size:20px}.markdown-body h5{font-size:16px}.markdown-body h6{font-size:14px}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body table,.markdown-body ul{margin:.8em 0}.markdown-body strong{font-weight:1000;position:relative;color:#444;padding:0 3px}.markdown-body em{font-weight:inherit}.markdown-body a{box-sizing:border-box;color:grey;position:relative}.markdown-body a:before{position:absolute;box-sizing:border-box;content:"Go -&gt;";left:0;width:100%;max-width:0;color:#fff;background-color:hsla(0,0%,50.2%,.8);white-space:nowrap;transition:.2s ease;pointer-events:none;overflow:hidden}.markdown-body a:after{content:"";position:absolute;bottom:0;left:0;width:100%;height:1px;background-color:grey}.markdown-body a:active:before,.markdown-body a:hover:before{max-width:100%;padding-left:8px;border-radius:5px}.markdown-body hr{position:relative;width:100%;height:1px;border:none;margin-top:36px;margin-bottom:36px;background:linear-gradient(90deg,grey,#f1f1f1,#444,#444,#f1f1f1,grey);overflow:visible}.markdown-body ol,.markdown-body ul{padding-left:32px}.markdown-body ol li,.markdown-body ul li{margin-bottom:6px;list-style:inherit}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol{counter-reset:my-counter}.markdown-body ol&gt;li{padding-left:6px;list-style:none;counter-increment:my-counter;position:relative}.markdown-body ol&gt;li:before{position:absolute;left:-1.5em;content:counter(my-counter);font-weight:700}.markdown-body ol&gt;li:first-child:before{content:"1ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(2):before{content:"2ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(3):before{content:"3ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(4):before{content:"4ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(5):before{content:"5ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(6):before{content:"6ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(7):before{content:"7ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(8):before{content:"8ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(9):before{content:"9ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(10):before{content:"ğŸ”Ÿ"}.markdown-body ul&gt;li{list-style:none;position:relative}.markdown-body ul&gt;li:before{z-index:10;position:absolute;left:-1.57em;content:"ğŸ”¹";margin-right:12px}.markdown-body ul&gt;li input{margin-left:8px!important}.markdown-body blockquote{position:relative;background-color:#d3d3d3;padding:5px 10px;border-left:.2em solid #000;border-radius:3px;transition:all .8s ease}.markdown-body blockquote:hover{opacity:.7}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(69,69,77,.8);color:#fff;font-size:.87em;padding:.07em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:7px;overflow:hidden}.markdown-body pre:before{z-index:10;position:absolute;top:14px;left:14px;width:12px;height:12px;border-radius:50%;background:#fc625d;-webkit-box-shadow:20px 0 #fdbc40,40px 0 #35cd4b;box-shadow:20px 0 #fdbc40,40px 0 #35cd4b;content:" "}.markdown-body pre:after{z-index:9;content:"";position:absolute;width:100%;height:40px;top:0;background-color:#1a1a1a}.markdown-body pre&gt;code{display:block;font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#171717;color:#bababa;font-size:14px;padding:40px 20px 20px}.markdown-body del{color:grey}.markdown-body table{margin-bottom:1.25rem;border-collapse:collapse}.markdown-body table td,.markdown-body table th{margin:0;padding:8px;line-height:20px;vertical-align:middle;border:1px solid #ddd}.markdown-body table thead,.markdown-body table tr:nth-child(2n){background-color:#fcfcfc}.markdown-body table thead th,.markdown-body table tr:nth-child(2n) th{font-weight:700;vertical-align:middle;color:#444}.markdown-body table tbody tr td{font-weight:400;color:#444}.markdown-body table tbody tr:hover{background-color:#d3d3d3}.markdown-body table tbody tr:hover td{color:#fff}.markdown-body img{max-width:100%;margin:0 12px}@media (max-width:720px){.markdown-body h1{font-size:32.8px}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:19.2px}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:12.8px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">ä¿®æ”¹å™¨ä¸‹è½½</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Flpf_project%2FRuoYi-MT" target="_blank" title="https://gitee.com/lpf_project/RuoYi-MT" ref="nofollow noopener noreferrer">gitee.com/lpf_projectâ€¦</a></p>
<p>é€‰æ‹©å‹ç¼©åŒ…ï¼Œé…ç½®ä¿®æ”¹å†…å®¹ï¼Œå¼€å§‹æ‰§è¡Œã€‚ä¼šè¾“å‡ºä¸€ä¸ªæ–‡ä»¶</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0979afba4c0c4176a77211e39a3c7068~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOq6YeM55qE56C05rC055O2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769247072&amp;x-signature=Q8THEbDjbgn5GYdepaad1RM8Xy8%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">Swagger</h2>
<p>Swagger æ˜¯ä¸€ä¸ªè§„èŒƒå’Œå®Œæ•´çš„æ¡†æ¶ï¼Œç”¨äºç”Ÿæˆã€æè¿°ã€è°ƒç”¨å’Œå¯è§†åŒ– RESTful é£æ ¼çš„ Web æœåŠ¡</p>
<p>å®ƒçš„ä¸»è¦ä½œç”¨æœ‰ï¼š</p>
<ul>
<li>ä½¿å¾—å‰åç«¯åˆ†ç¦»å¼€å‘æ›´åŠ æ–¹ä¾¿ï¼Œæœ‰åˆ©äºå›¢é˜Ÿåä½œ</li>
<li>åœ¨çº¿è‡ªåŠ¨ç”Ÿæˆæ¥å£æ–‡æ¡£ï¼Œé™ä½åç«¯å¼€å‘äººå‘˜ç¼–å†™æ¥å£æ–‡æ¡£çš„è´Ÿæ‹…</li>
<li>åŠŸèƒ½æµ‹è¯•</li>
</ul>
<p>Springå·²ç»å°†Swaggerçº³å…¥è‡ªèº«çš„æ ‡å‡†ï¼Œå»ºç«‹äº†Spring-Swaggeré¡¹ç›®ï¼Œç°åœ¨å«Springfoxã€‚é€šè¿‡åœ¨é¡¹ç›®ä¸­å¼•å…¥Springfox ï¼Œå°±å¯ä»¥éå¸¸ç®€å•å¿«æ·çš„ä½¿ç”¨Swaggerå•¦ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- swagger3--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.springfox<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springfox-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-comment">&lt;!-- é˜²æ­¢è¿›å…¥swaggeré¡µé¢æŠ¥ç±»å‹è½¬æ¢é”™è¯¯ï¼Œæ’é™¤3.0.0ä¸­çš„å¼•ç”¨ï¼Œæ‰‹åŠ¨å¢åŠ 1.6.2ç‰ˆæœ¬ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.swagger<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>swagger-models<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.6.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<blockquote>
<p>æ ¸å¿ƒé…ç½®ç±»</p>
</blockquote>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * Swagger2çš„æ¥å£é…ç½®
 */</span>
<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SwaggerConfig</span> {
    <span class="hljs-comment">/**
     * ç³»ç»ŸåŸºç¡€é…ç½®
     */</span>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RuoYiConfig ruoyiConfig;

    <span class="hljs-comment">/**
     * æ˜¯å¦å¼€å¯swagger
     */</span>
    <span class="hljs-meta">@Value("${swagger.enabled}")</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> enabled;

    <span class="hljs-comment">/**
     * è®¾ç½®è¯·æ±‚çš„ç»Ÿä¸€å‰ç¼€
     */</span>
    <span class="hljs-meta">@Value("${swagger.pathMapping}")</span>
    <span class="hljs-keyword">private</span> String pathMapping;

    <span class="hljs-comment">/**
     * åˆ›å»ºAPI
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Docket <span class="hljs-title function_">createRestApi</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Docket</span>(DocumentationType.OAS_30)
                <span class="hljs-comment">// æ˜¯å¦å¯ç”¨Swagger</span>
                .enable(enabled)
                <span class="hljs-comment">// ç”¨æ¥åˆ›å»ºè¯¥APIçš„åŸºæœ¬ä¿¡æ¯ï¼Œå±•ç¤ºåœ¨æ–‡æ¡£çš„é¡µé¢ä¸­ï¼ˆè‡ªå®šä¹‰å±•ç¤ºçš„ä¿¡æ¯ï¼‰</span>
                .apiInfo(apiInfo())
                <span class="hljs-comment">// è®¾ç½®å“ªäº›æ¥å£æš´éœ²ç»™Swaggerå±•ç¤º</span>
                .select()
                <span class="hljs-comment">// æ‰«ææ‰€æœ‰æœ‰æ³¨è§£çš„apiï¼Œç”¨è¿™ç§æ–¹å¼æ›´çµæ´»</span>
                .apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class))
                <span class="hljs-comment">// æ‰«ææŒ‡å®šåŒ…ä¸­çš„swaggeræ³¨è§£</span>
                <span class="hljs-comment">// .apis(RequestHandlerSelectors.basePackage("com.kzzyl.project.tool.swagger"))</span>
                <span class="hljs-comment">// æ‰«ææ‰€æœ‰ .apis(RequestHandlerSelectors.any())</span>
                .paths(PathSelectors.any())
                .build()
                <span class="hljs-comment">/* è®¾ç½®å®‰å…¨æ¨¡å¼ï¼Œswaggerå¯ä»¥è®¾ç½®è®¿é—®token */</span>
                .securitySchemes(securitySchemes())
                .securityContexts(securityContexts())
                .pathMapping(pathMapping);
    }

    <span class="hljs-comment">/**
     * å®‰å…¨æ¨¡å¼ï¼Œè¿™é‡ŒæŒ‡å®štokené€šè¿‡Authorizationå¤´è¯·æ±‚å¤´ä¼ é€’
     */</span>
    <span class="hljs-keyword">private</span> List&lt;SecurityScheme&gt; <span class="hljs-title function_">securitySchemes</span><span class="hljs-params">()</span> {
        List&lt;SecurityScheme&gt; apiKeyList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        apiKeyList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ApiKey</span>(<span class="hljs-string">"Authorization"</span>, <span class="hljs-string">"Authorization"</span>, In.HEADER.toValue()));
        <span class="hljs-keyword">return</span> apiKeyList;
    }

    <span class="hljs-comment">/**
     * å®‰å…¨ä¸Šä¸‹æ–‡
     */</span>
    <span class="hljs-keyword">private</span> List&lt;SecurityContext&gt; <span class="hljs-title function_">securityContexts</span><span class="hljs-params">()</span> {
        List&lt;SecurityContext&gt; securityContexts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        securityContexts.add(
                SecurityContext.builder()
                        .securityReferences(defaultAuth())
                        .operationSelector(o -&gt;
                                o.requestMappingPattern().matches(<span class="hljs-string">"/.*"</span>))
                        .build());
        <span class="hljs-keyword">return</span> securityContexts;
    }

    <span class="hljs-comment">/**
     * é»˜è®¤çš„å®‰å…¨ä¸Šå¼•ç”¨
     */</span>
    <span class="hljs-keyword">private</span> List&lt;SecurityReference&gt; <span class="hljs-title function_">defaultAuth</span><span class="hljs-params">()</span> {
        <span class="hljs-type">AuthorizationScope</span> <span class="hljs-variable">authorizationScope</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AuthorizationScope</span>(<span class="hljs-string">"global"</span>,
                <span class="hljs-string">"accessEverything"</span>);
        AuthorizationScope[] authorizationScopes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AuthorizationScope</span>[<span class="hljs-number">1</span>];
        authorizationScopes[<span class="hljs-number">0</span>] = authorizationScope;
        List&lt;SecurityReference&gt; securityReferences = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        securityReferences.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">SecurityReference</span>(<span class="hljs-string">"Authorization"</span>, authorizationScopes));
        <span class="hljs-keyword">return</span> securityReferences;
    }

    <span class="hljs-comment">/**
     * æ·»åŠ æ‘˜è¦ä¿¡æ¯
     */</span>
    <span class="hljs-keyword">private</span> ApiInfo <span class="hljs-title function_">apiInfo</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// ç”¨ApiInfoBuilderè¿›è¡Œå®šåˆ¶</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApiInfoBuilder</span>()
                <span class="hljs-comment">// è®¾ç½®æ ‡é¢˜</span>
                .title(<span class="hljs-string">"æ ‡é¢˜ï¼šè‹¥ä¾ç®¡ç†ç³»ç»Ÿ_æ¥å£æ–‡æ¡£"</span>)
                <span class="hljs-comment">// æè¿°</span>
                .description(<span class="hljs-string">"æè¿°ï¼šç”¨äºç®¡ç†é›†å›¢æ——ä¸‹å…¬å¸çš„äººå‘˜ä¿¡æ¯,å…·ä½“åŒ…æ‹¬XXX,XXXæ¨¡å—..."</span>)
                <span class="hljs-comment">// ä½œè€…ä¿¡æ¯</span>
                .contact(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Contact</span>(ruoyiConfig.getName(), <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>))
                <span class="hljs-comment">// ç‰ˆæœ¬</span>
                .version(<span class="hljs-string">"ç‰ˆæœ¬å·:"</span> + ruoyiConfig.getVersion())
                .build();
    }
}

</code></pre>
<h2 data-id="heading-2">é›†æˆknife4j</h2>
<p>å¦‚æœä¸ä¹ æƒ¯ä½¿ç”¨swaggerå¯ä»¥ä½¿ç”¨å‰ç«¯UIçš„å¢å¼ºè§£å†³æ–¹æ¡ˆknife4jï¼Œå¯¹æ¯”swaggerç›¸æ¯”æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼Œå‹å¥½ç•Œé¢ï¼Œç¦»çº¿æ–‡æ¡£ï¼Œæ¥å£æ’åºï¼Œå®‰å…¨æ§åˆ¶ï¼Œåœ¨çº¿è°ƒè¯•ï¼Œæ–‡æ¡£æ¸…æ™°ï¼Œæ³¨è§£å¢å¼ºï¼Œå®¹æ˜“ä¸Šæ‰‹ã€‚
ç›®å‰ï¼Œä¼ä¸šé¡¹ç›®ä¸­ä¸€èˆ¬éƒ½ä½¿ç”¨knife4jæ¡†æ¶ã€‚</p>
<blockquote>
<p>éœ€è¦ç§»é™¤ä¾èµ–ï¼Œspringfox-boot-starter å’Œ swagger-models</p>
</blockquote>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- SpringBoot2 ä½¿ç”¨ä¾èµ– --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.xiaoymin<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>knife4j-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.0.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<blockquote>
<p>å‰ç«¯ä¿®æ”¹ ry-ui\views\tool\swagger\index.vue è·³è½¬åœ°å€ï¼Œå¦‚ä¸‹</p>
</blockquote>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> url = <span class="hljs-title function_">ref</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">VITE_APP_BASE_API</span> + <span class="hljs-string">"/doc.html"</span>)
</code></pre>
<h3 data-id="heading-3">æ³¨è§£å‚æ•°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä½œç”¨åˆ°ç±»ä¸Šæè¿°ï¼Œæ ‡é¢˜</span>
<span class="hljs-meta">@Api(value = "æŠ¤ç†é¡¹ç›®ç®¡ç†", tags = "æŠ¤ç†é¡¹ç›®ç®¡ç†")</span>
<span class="hljs-comment">// ä½œç”¨åˆ°æ–¹æ³•ä¸Šï¼Œæè¿°å…·ä½“çš„æ¥å£</span>
<span class="hljs-meta">@ApiOperation("æŸ¥è¯¢æŠ¤ç†é¡¹ç›®åˆ—è¡¨")</span>
<span class="hljs-comment">// ä½œç”¨åˆ°æ–¹æ³•çš„å‚æ•°ä¸Šï¼Œæè¿°å‚æ•°ä¿¡æ¯</span>
<span class="hljs-meta">@ApiParam("æŸ¥è¯¢æ¡ä»¶å¯¹è±¡")</span>
<span class="hljs-comment">// ä½œç”¨åˆ°å®ä½“ç±»ä¸Š</span>
<span class="hljs-meta">@ApiModel("EntityåŸºç±»")</span>
<span class="hljs-comment">// ä½œç”¨åˆ°å®ä½“ç±»çš„æˆå‘˜å˜é‡ä¸Š</span>
<span class="hljs-meta">@ApiModelProperty("æœç´¢å€¼")</span>
</code></pre>
<h2 data-id="heading-4">Velocityæ¨¡å—å¼•æ“</h2>
<p>Velocityæ˜¯ä¸€ä¸ªåŸºäºJavaçš„æ¨¡æ¿å¼•æ“ï¼Œå®ƒå¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯­æ³•è·å–javaå¯¹è±¡çš„æ•°æ® , å¡«å……åˆ°æ¨¡æ¿ä¸­ï¼Œä»è€Œå®ç°ç•Œé¢å’Œjavaä»£ç çš„åˆ†ç¦»ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3433d5b35001450990f095a738cd467f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOq6YeM55qE56C05rC055O2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769247072&amp;x-signature=aHo%2FU8y22hjMMHOlSFipBAJcnIQ%3D" alt="image.png" loading="lazy"/></p>
<p>å¸¸è§çš„åº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>Webåº”ç”¨ç¨‹åº : ä½œä¸ºåº”ç”¨ç¨‹åºçš„è§†å›¾, å±•ç¤ºæ•°æ®ã€‚</li>
<li>æºä»£ç ç”Ÿæˆ : Velocityå¯ä»¥åŸºäºæ¨¡æ¿ç”ŸæˆJavaæºä»£ç ã€‚</li>
<li>è‡ªåŠ¨ç”µå­é‚®ä»¶ : ç½‘ç«™æ³¨å†Œï¼Œ è®¤è¯ç­‰çš„ç”µå­é‚®ä»¶æ¨¡æ¿ã€‚</li>
<li>ç½‘é¡µé™æ€åŒ– : åŸºäºvelocityæ¨¡æ¿ç”Ÿæˆé™æ€ç½‘é¡µã€‚</li>
</ul>
<blockquote>
<p>æ¡ˆä¾‹</p>
</blockquote>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">//<span class="hljs-doctag">TODO:</span> 1.åˆå§‹åŒ–velocity</span>
<span class="hljs-type">Properties</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();
<span class="hljs-comment">// åŠ è½½classpathç›®å½•ä¸‹çš„vmæ–‡ä»¶</span>
p.setProperty(<span class="hljs-string">"resource.loader.file.class"</span>, <span class="hljs-string">"org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader"</span>);
<span class="hljs-comment">// å®šä¹‰å­—ç¬¦é›†</span>
p.setProperty(Velocity.INPUT_ENCODING, Constants.UTF8);
<span class="hljs-comment">// åˆå§‹åŒ–Velocityå¼•æ“ï¼ŒæŒ‡å®šé…ç½®Properties</span>
Velocity.init(p);

<span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> 2.åˆ›å»ºVelocityä¸Šä¸‹æ–‡å¯¹è±¡</span>
<span class="hljs-type">VelocityContext</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">VelocityContext</span>();
context.put(<span class="hljs-string">"message"</span>, <span class="hljs-string">"åŠ æ²¹æœ‹å‹"</span>);

<span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> 3.è·å–æ¨¡æ¿</span>
<span class="hljs-type">Template</span> <span class="hljs-variable">template</span> <span class="hljs-operator">=</span> Velocity.getTemplate(<span class="hljs-string">"vms/index.html.vm"</span>, Constants.UTF8);
<span class="hljs-comment">// å‡†å¤‡è¾“å‡ºæµï¼Œå°†æ–‡ä»¶å†™å‡º</span>
<span class="hljs-type">FileWriter</span> <span class="hljs-variable">fileWriter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileWriter</span>(<span class="hljs-string">"E:\\é»‘é©¬ai\\kzzyl\\kzzyl-generator\\src\\main\\resources\\vms\\index.html"</span>);
<span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> 4.åˆå¹¶æ¨¡æ¿å’Œæ•°æ®æ¨¡å‹</span>
template.merge(context, fileWriter);

fileWriter.close();
</code></pre>
<p><strong>æ¨¡æ¿å¦‚ä¸‹ï¼šä½¿ç”¨ ${message} ä¼ é€’ message å˜é‡</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>éšä¾¿å†™ç‚¹æ•°æ®å§--${message}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>Velocityè¯­æ³•è§£é‡Š</p>
<ul>
<li>${variable}: è¡¨ç¤ºæ’å…¥å˜é‡å€¼ã€‚</li>
<li>#foreach å’Œ #end: å¾ªç¯ç»“æ„ï¼Œç”¨äºéå†åˆ—è¡¨ã€‚</li>
<li>#if å’Œ #end: æ¡ä»¶åˆ¤æ–­ç»“æ„ã€‚</li>
<li>#set: è®¾ç½®å˜é‡ã€‚</li>
<li>#elseif: æ¡ä»¶åˆ†æ”¯ã€‚</li>
</ul>
<h2 data-id="heading-5">é›†æˆ MybatisPlus</h2>
<p>åœ¨ common ä¸‹å¼•å…¥</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- MyBatis-Plus å¢å¼ºCRUD --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.baomidou<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>åˆ é™¤ mybatis-config.xml æ–‡ä»¶</p>
<pre><code class="hljs language-yml" lang="yml"><span class="hljs-comment"># MyBatisPlusé…ç½®</span>
<span class="hljs-attr">mybatis-plus:</span>
  <span class="hljs-comment"># æœç´¢æŒ‡å®šåŒ…åˆ«å</span>
  <span class="hljs-attr">typeAliasesPackage:</span> <span class="hljs-string">com.kzzyl.**.domain</span>
  <span class="hljs-comment"># é…ç½®mapperçš„æ‰«æï¼Œæ‰¾åˆ°æ‰€æœ‰çš„mapper.xmlæ˜ å°„æ–‡ä»¶</span>
  <span class="hljs-attr">mapperLocations:</span> <span class="hljs-string">classpath*:mapper/**/*Mapper.xml</span>
  <span class="hljs-attr">global-config:</span>
    <span class="hljs-attr">db-config:</span>
      <span class="hljs-attr">id-type:</span> <span class="hljs-string">auto</span>
  <span class="hljs-attr">configuration:</span>
    <span class="hljs-comment"># å¼€å¯é©¼å³°å‘½åè§„åˆ™</span>
    <span class="hljs-attr">map-underscore-to-camel-case:</span> <span class="hljs-literal">true</span>
</code></pre>
<blockquote>
<p>åˆ é™¤ MyBatisConfig æ–‡ä»¶ï¼Œæ›¿æ¢æˆ MyBatisPlusConfig å¦‚ä¸‹</p>
</blockquote>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-comment">/**
 * Mybatis Plus é…ç½®
 */</span>
<span class="hljs-meta">@EnableTransactionManagement(proxyTargetClass = true)</span>
<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MybatisPlusConfig</span> {

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> MybatisPlusInterceptor <span class="hljs-title function_">mybatisPlusInterceptor</span><span class="hljs-params">()</span> {
        <span class="hljs-type">MybatisPlusInterceptor</span> <span class="hljs-variable">interceptor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MybatisPlusInterceptor</span>();
        <span class="hljs-comment">// åˆ†é¡µæ’ä»¶</span>
        interceptor.addInnerInterceptor(paginationInnerInterceptor());
        <span class="hljs-comment">// ä¹è§‚é”æ’ä»¶</span>
        interceptor.addInnerInterceptor(optimisticLockerInnerInterceptor());
        <span class="hljs-comment">// é˜»æ–­æ’ä»¶</span>
        interceptor.addInnerInterceptor(blockAttackInnerInterceptor());
        <span class="hljs-keyword">return</span> interceptor;
    }

    <span class="hljs-comment">/**
     * åˆ†é¡µæ’ä»¶ï¼Œè‡ªåŠ¨è¯†åˆ«æ•°æ®åº“ç±»å‹
     */</span>
    <span class="hljs-keyword">public</span> PaginationInnerInterceptor <span class="hljs-title function_">paginationInnerInterceptor</span><span class="hljs-params">()</span> {
        <span class="hljs-type">PaginationInnerInterceptor</span> <span class="hljs-variable">paginationInnerInterceptor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PaginationInnerInterceptor</span>();
        <span class="hljs-comment">// è®¾ç½®æ•°æ®åº“ç±»å‹ä¸ºmysql</span>
        paginationInnerInterceptor.setDbType(DbType.MYSQL);
        <span class="hljs-comment">// è®¾ç½®æœ€å¤§å•é¡µé™åˆ¶æ•°é‡ï¼Œé»˜è®¤ 500 æ¡ï¼Œ-1 ä¸å—é™åˆ¶</span>
        paginationInnerInterceptor.setMaxLimit(-<span class="hljs-number">1L</span>);
        <span class="hljs-keyword">return</span> paginationInnerInterceptor;
    }

    <span class="hljs-comment">/**
     * ä¹è§‚é”æ’ä»¶
     */</span>
    <span class="hljs-keyword">public</span> OptimisticLockerInnerInterceptor <span class="hljs-title function_">optimisticLockerInnerInterceptor</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OptimisticLockerInnerInterceptor</span>();
    }

    <span class="hljs-comment">/**
     * å¦‚æœæ˜¯å¯¹å…¨è¡¨çš„åˆ é™¤æˆ–æ›´æ–°æ“ä½œï¼Œå°±ä¼šç»ˆæ­¢è¯¥æ“ä½œ
     */</span>
    <span class="hljs-keyword">public</span> BlockAttackInnerInterceptor <span class="hljs-title function_">blockAttackInnerInterceptor</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BlockAttackInnerInterceptor</span>();
    }

}
</code></pre>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ol>
<li>éœ€è¦åœ¨ BaseEntity é‡Œ <code>paramså’ŒsearchValue</code> éœ€è¦è®¾ç½® @TableField(exist = false)</li>
</ol>
<blockquote>
<p>æ–¹ä¾¿ç›´æ¥æ‹·è´</p>
</blockquote>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.kzzyl.common.core.domain;

<span class="hljs-keyword">import</span> java.io.Serial;
<span class="hljs-keyword">import</span> java.io.Serializable;
<span class="hljs-keyword">import</span> java.util.Date;
<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.FieldFill;
<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.TableField;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.annotation.JsonFormat;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.annotation.JsonIgnore;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.annotation.JsonInclude;
<span class="hljs-keyword">import</span> io.swagger.annotations.ApiModel;
<span class="hljs-keyword">import</span> io.swagger.annotations.ApiModelProperty;
<span class="hljs-keyword">import</span> lombok.Data;

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@author</span> Kun
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@ApiModel("EntityåŸºç±»")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseEntity</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> {

    <span class="hljs-meta">@Serial</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>;

    <span class="hljs-meta">@JsonIgnore</span>
    <span class="hljs-meta">@ApiModelProperty("æœç´¢å€¼")</span>
    <span class="hljs-meta">@TableField(exist = false)</span>
    <span class="hljs-keyword">private</span> String searchValue;

    <span class="hljs-meta">@ApiModelProperty("åˆ›å»ºè€…")</span>
    <span class="hljs-meta">@TableField(fill = FieldFill.INSERT)</span>
    <span class="hljs-keyword">private</span> String createBy;

    <span class="hljs-meta">@JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")</span>
    <span class="hljs-meta">@TableField(fill = FieldFill.INSERT)</span>
    <span class="hljs-meta">@ApiModelProperty("åˆ›å»ºæ—¶é—´")</span>
    <span class="hljs-keyword">private</span> Date createTime;

    <span class="hljs-meta">@ApiModelProperty("æ›´æ–°è€…")</span>
    <span class="hljs-meta">@TableField(fill = FieldFill.UPDATE)</span>
    <span class="hljs-keyword">private</span> String updateBy;

    <span class="hljs-meta">@JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")</span>
    <span class="hljs-meta">@TableField(fill = FieldFill.UPDATE)</span>
    <span class="hljs-meta">@ApiModelProperty("æ›´æ–°æ—¶é—´")</span>
    <span class="hljs-keyword">private</span> Date updateTime;

    <span class="hljs-comment">/**
     * å¤‡æ³¨
     */</span>
    <span class="hljs-meta">@ApiModelProperty("å¤‡æ³¨")</span>
    <span class="hljs-keyword">private</span> String remark;

    <span class="hljs-comment">/**
     * è¯·æ±‚å‚æ•°
     */</span>
    <span class="hljs-meta">@JsonInclude(JsonInclude.Include.NON_EMPTY)</span>
    <span class="hljs-meta">@TableField(exist = false)</span>
    <span class="hljs-meta">@ApiModelProperty("è¯·æ±‚å‚æ•°")</span>
    <span class="hljs-keyword">private</span> Map&lt;String, Object&gt; params;

    <span class="hljs-keyword">public</span> Map&lt;String, Object&gt; <span class="hljs-title function_">getParams</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (params == <span class="hljs-literal">null</span>) {
            params = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        }
        <span class="hljs-keyword">return</span> params;
    }

}
</code></pre>
<h2 data-id="heading-6">MybatisPlus è‡ªåŠ¨å¡«å……</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.kzzyl.framework.interceptor;

<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.handlers.MetaObjectHandler;
<span class="hljs-keyword">import</span> com.kzzyl.common.utils.DateUtils;
<span class="hljs-keyword">import</span> com.kzzyl.common.utils.SecurityUtils;
<span class="hljs-keyword">import</span> org.apache.ibatis.reflection.MetaObject;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-keyword">import</span> java.util.Date;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseEntityHandle</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MetaObjectHandler</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insertFill</span><span class="hljs-params">(MetaObject metaObject)</span> {
        <span class="hljs-built_in">this</span>.strictInsertFill(metaObject, <span class="hljs-string">"createBy"</span>, String.class, SecurityUtils.getUserId().toString());
        <span class="hljs-built_in">this</span>.strictInsertFill(metaObject, <span class="hljs-string">"createTime"</span>, Date.class, DateUtils.getNowDate());
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateFill</span><span class="hljs-params">(MetaObject metaObject)</span> {
        <span class="hljs-built_in">this</span>.setFieldValByName(<span class="hljs-string">"updateBy"</span>, SecurityUtils.getUserId().toString(), metaObject);
        <span class="hljs-built_in">this</span>.setFieldValByName(<span class="hljs-string">"updateTime"</span>, DateUtils.getNowDate(), metaObject);
    }

}
</code></pre>
<h2 data-id="heading-7">æ”¹é€  controller å±‚</h2>
<p>ä»£ç æ¨¡æ¿åœ¨ä¸‹é¢ï¼Œè¿™é‡Œåªè¯´ä¸€ä¸‹éœ€è¦è°ƒæ•´çš„å†…ç½®ä»£ç </p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> lombok.Data;
<span class="hljs-keyword">import</span> lombok.NoArgsConstructor;

<span class="hljs-keyword">import</span> java.io.Serial;
<span class="hljs-keyword">import</span> java.io.Serializable;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">/**
 * è¡¨æ ¼åˆ†é¡µæ•°æ®å¯¹è±¡
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@NoArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TableDataInfo</span>&lt;T&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> {
    
    <span class="hljs-meta">@Serial</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>;

    <span class="hljs-comment">/**
     * æ€»è®°å½•æ•°
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> total;

    <span class="hljs-comment">/**
     * åˆ—è¡¨æ•°æ®
     */</span>
    <span class="hljs-keyword">private</span> List&lt;T&gt; rows;

    <span class="hljs-comment">/**
     * æ¶ˆæ¯çŠ¶æ€ç 
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> code;

    <span class="hljs-comment">/**
     * æ¶ˆæ¯å†…å®¹
     */</span>
    <span class="hljs-keyword">private</span> String msg;

    <span class="hljs-comment">/**
     * åˆ†é¡µ
     *
     * <span class="hljs-doctag">@param</span> list  åˆ—è¡¨æ•°æ®
     * <span class="hljs-doctag">@param</span> total æ€»è®°å½•æ•°
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TableDataInfo</span><span class="hljs-params">(List&lt;T&gt; list, <span class="hljs-type">long</span> total)</span> {
        <span class="hljs-built_in">this</span>.rows = list;
        <span class="hljs-built_in">this</span>.total = total;
    }

}

</code></pre>
<p>è¿˜æœ‰ BaseController ä¸­çš„ä¸‹é¢æ–¹æ³•</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å“åº”è¯·æ±‚åˆ†é¡µæ•°æ®
 */</span>
<span class="hljs-keyword">protected</span> &lt;T&gt; TableDataInfo&lt;T&gt; <span class="hljs-title function_">getDataTable</span><span class="hljs-params">(List&lt;T&gt; list)</span> {
    TableDataInfo&lt;T&gt; rspData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TableDataInfo</span>&lt;&gt;();
    rspData.setCode(HttpStatus.SUCCESS);
    rspData.setMsg(<span class="hljs-string">"æŸ¥è¯¢æˆåŠŸ"</span>);
    rspData.setRows(list);
    rspData.setTotal(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PageInfo</span>&lt;&gt;(list).getTotal());
    <span class="hljs-keyword">return</span> rspData;
}
</code></pre>
<h2 data-id="heading-8">ä¿®æ”¹æ—¶é—´ç±»å‹ä¸º LocalDate</h2>
<p>å‰ç«¯åœ¨ views/tool/editTable æ–‡ä»¶ä¸­å¦‚ä¸‹å›¾ä½ç½®ã€‚æ–°å¢ä¸Š LocalDateTime</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a33e76adf0ed4e80a1d8f5b3d5f2fb7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOq6YeM55qE56C05rC055O2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769247072&amp;x-signature=ruYh3D%2BFK2r95jOiACIjgvAqm20%3D" alt="image.png" loading="lazy"/></p>
<p>Java</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// src/main/java/com/kzzyl/common/constant/GenConstants.java</span>
<span class="hljs-comment">/** æ—¶é—´ç±»å‹ */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">TYPE_LOCAL_DATE_TIME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"LocalDateTime"</span>;

<span class="hljs-comment">// src/main/java/com/kzzyl/generator/util/VelocityUtils.java</span>
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!column.isSuperColumn() &amp;&amp; GenConstants.TYPE_LOCAL_DATE_TIME.equals(column.getJavaType())) {
    importList.add(<span class="hljs-string">"import java.time.LocalDateTime"</span>);
    importList.add(<span class="hljs-string">"com.fasterxml.jackson.annotation.JsonFormat"</span>);
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6714aa61f48f4757977a36549e8e28b2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5ZOq6YeM55qE56C05rC055O2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769247072&amp;x-signature=QGb3nJh3bhU6Ibq%2BaF4vfAZMnt4%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-9">åˆå§‹åŒ–å­—æ®µå¯¹åº”å…³ç³»ä¿®æ”¹</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åœ¨ src/main/java/com/kzzyl/generator/util/GenUtils.java</span>
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (str != <span class="hljs-literal">null</span> &amp;&amp; str.length == <span class="hljs-number">1</span> &amp;&amp; Integer.parseInt(str[<span class="hljs-number">0</span>]) &lt;= <span class="hljs-number">10</span>
        || GenConstants.MYSQL_TINYINT.equals(column.getColumnType()) ||
        GenConstants.MYSQL_INT.equals(column.getColumnType())) {
    <span class="hljs-comment">// ä¿®æ”¹ä¸ºInteger</span>
    column.setJavaType(GenConstants.TYPE_INTEGER);
}
<span class="hljs-comment">// ---------------</span>
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arraysContains(GenConstants.COLUMNTYPE_TIME, dataType)) {
    <span class="hljs-comment">// å¦‚æœæ˜¯æ—¶é—´ç±»å‹ åˆ™ç”ŸæˆLocalDateTimeç±»å‹</span>
    column.setJavaType(GenConstants.TYPE_LOCAL_DATE_TIME);
    column.setHtmlType(GenConstants.HTML_DATETIME);
}

<span class="hljs-comment">// src/main/java/com/kzzyl/common/constant/GenConstants.java</span>
<span class="hljs-comment">/** MySql tinyint ç±»å‹ */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">MYSQL_TINYINT</span> <span class="hljs-operator">=</span> <span class="hljs-string">"tinyint"</span>;

<span class="hljs-comment">/** MySql int ç±»å‹ */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">MYSQL_INT</span> <span class="hljs-operator">=</span> <span class="hljs-string">"int"</span>;
</code></pre>
<h2 data-id="heading-10">ä»£ç ç”Ÿæˆæ¨¡æ¿</h2>
<p><strong>controller.java.vm</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> ${packageName}.controller;

<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;

<span class="hljs-keyword">import</span> lombok.AllArgsConstructor;
<span class="hljs-keyword">import</span> io.swagger.annotations.Api;
<span class="hljs-keyword">import</span> com.kzzyl.common.core.domain.R;
<span class="hljs-keyword">import</span> io.swagger.annotations.ApiParam;
<span class="hljs-keyword">import</span> io.swagger.annotations.ApiOperation;
<span class="hljs-keyword">import</span> org.springframework.security.access.prepost.PreAuthorize;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PostMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PutMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.DeleteMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.PathVariable;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestBody;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;
<span class="hljs-keyword">import</span> com.kzzyl.common.annotation.Log;
<span class="hljs-keyword">import</span> com.kzzyl.common.core.controller.BaseController;
<span class="hljs-keyword">import</span> com.kzzyl.common.core.domain.AjaxResult;
<span class="hljs-keyword">import</span> com.kzzyl.common.enums.BusinessType;
<span class="hljs-keyword">import</span> ${packageName}.domain.${ClassName};
<span class="hljs-keyword">import</span> ${packageName}.service.I${ClassName}Service;
<span class="hljs-keyword">import</span> com.kzzyl.common.utils.poi.ExcelUtil;
#<span class="hljs-keyword">if</span>($table.crud || $table.sub)
<span class="hljs-keyword">import</span> com.kzzyl.common.core.page.TableDataInfo;
#elseif($table.tree)
#end

<span class="hljs-comment">/**
 * ${functionName}Controller
 * 
 * <span class="hljs-doctag">@author</span> ${author}
 * date ${datetime}
 */</span>
<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-meta">@RequestMapping("/${moduleName}/${businessName}")</span>
<span class="hljs-meta">@Api(value = "${functionName}ç®¡ç†", tags = "${functionName}ç®¡ç†")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">$</span>{ClassName}Controller <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseController</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> I${ClassName}Service ${className}Service;

    <span class="hljs-comment">/**
     * æŸ¥è¯¢${functionName}åˆ—è¡¨
     */</span>
    <span class="hljs-meta">@ApiOperation("æŸ¥è¯¢${functionName}åˆ—è¡¨")</span>
    <span class="hljs-meta">@PreAuthorize("@ss.hasPermi('${permissionPrefix}:list')")</span>
    <span class="hljs-meta">@GetMapping("/list")</span>
#<span class="hljs-keyword">if</span>($table.crud || $table.sub)
    <span class="hljs-keyword">public</span> TableDataInfo&lt;${ClassName}&gt; list(${ClassName} ${className}) {
        startPage();
        <span class="hljs-keyword">return</span> getDataTable(${className}Service.select${ClassName}List(${className}));
    }
#elseif($table.tree)
    <span class="hljs-keyword">public</span> AjaxResult <span class="hljs-title function_">list</span><span class="hljs-params">(${ClassName} ${className})</span>
    {
        List&lt;${ClassName}&gt; list = ${className}Service.select${ClassName}List(${className});
        <span class="hljs-keyword">return</span> success(list);
    }
#end

    <span class="hljs-comment">/**
     * å¯¼å‡º${functionName}åˆ—è¡¨
     */</span>
    <span class="hljs-meta">@ApiOperation("å¯¼å‡º${functionName}åˆ—è¡¨")</span>
    <span class="hljs-meta">@PreAuthorize("@ss.hasPermi('${permissionPrefix}:export')")</span>
    <span class="hljs-meta">@Log(title = "${functionName}", businessType = BusinessType.EXPORT)</span>
    <span class="hljs-meta">@PostMapping("/export")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">export</span><span class="hljs-params">(HttpServletResponse response, ${ClassName} ${className})</span> {
        List&lt;${ClassName}&gt; list = ${className}Service.select${ClassName}List(${className});
        ExcelUtil&lt;${ClassName}&gt; util = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExcelUtil</span>&lt;&gt;(${ClassName}.class);
        util.exportExcel(response, list, <span class="hljs-string">"${functionName}æ•°æ®"</span>);
    }

    <span class="hljs-comment">/**
     * è·å–${functionName}è¯¦ç»†ä¿¡æ¯
     */</span>
    <span class="hljs-meta">@ApiOperation("è·å–${functionName}åˆ—è¡¨")</span>
    <span class="hljs-meta">@PreAuthorize("@ss.hasPermi('${permissionPrefix}:query')")</span>
    <span class="hljs-meta">@GetMapping("/{${pkColumn.javaField}}")</span>
    <span class="hljs-keyword">public</span> R&lt;${ClassName}&gt; getInfo(<span class="hljs-meta">@PathVariable</span> <span class="hljs-meta">@ApiParam("å”¯ä¸€ID")</span> ${pkColumn.javaType} ${pkColumn.javaField}) {
        <span class="hljs-keyword">return</span> R.ok(${className}Service.select${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaField}));
    }

    <span class="hljs-comment">/**
     * æ–°å¢${functionName}
     */</span>
    <span class="hljs-meta">@ApiOperation("æ–°å¢${functionName}åˆ—è¡¨")</span>
    <span class="hljs-meta">@PreAuthorize("@ss.hasPermi('${permissionPrefix}:add')")</span>
    <span class="hljs-meta">@Log(title = "${functionName}", businessType = BusinessType.INSERT)</span>
    <span class="hljs-meta">@PostMapping</span>
    <span class="hljs-keyword">public</span> AjaxResult <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> ${ClassName} ${className})</span> {
        <span class="hljs-keyword">return</span> toAjax(${className}Service.insert${ClassName}(${className}));
    }

    <span class="hljs-comment">/**
     * ä¿®æ”¹${functionName}
     */</span>
    <span class="hljs-meta">@ApiOperation("ä¿®æ”¹${functionName}åˆ—è¡¨")</span>
    <span class="hljs-meta">@PreAuthorize("@ss.hasPermi('${permissionPrefix}:edit')")</span>
    <span class="hljs-meta">@Log(title = "${functionName}", businessType = BusinessType.UPDATE)</span>
    <span class="hljs-meta">@PutMapping</span>
    <span class="hljs-keyword">public</span> AjaxResult <span class="hljs-title function_">edit</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> ${ClassName} ${className})</span> {
        <span class="hljs-keyword">return</span> toAjax(${className}Service.update${ClassName}(${className}));
    }

    <span class="hljs-comment">/**
     * åˆ é™¤${functionName}
     */</span>
    <span class="hljs-meta">@ApiOperation("åˆ é™¤${functionName}åˆ—è¡¨")</span>
    <span class="hljs-meta">@PreAuthorize("@ss.hasPermi('${permissionPrefix}:remove')")</span>
    <span class="hljs-meta">@Log(title = "${functionName}", businessType = BusinessType.DELETE)</span>
    <span class="hljs-meta">@DeleteMapping("/{${pkColumn.javaField}s}")</span>
    <span class="hljs-keyword">public</span> AjaxResult <span class="hljs-title function_">remove</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> <span class="hljs-meta">@ApiParam("å”¯ä¸€IDé›†åˆ")</span> ${pkColumn.javaType}[] ${pkColumn.javaField}s)</span> {
        <span class="hljs-keyword">return</span> toAjax(${className}Service.delete${ClassName}By${pkColumn.capJavaField}s(${pkColumn.javaField}s));
    }
}
</code></pre>
<p><strong>domain.java.vm</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> ${packageName}.domain;

<span class="hljs-keyword">import</span> lombok.*;

<span class="hljs-keyword">import</span> java.io.Serial;
#foreach ($<span class="hljs-keyword">import</span> in $importList)
<span class="hljs-keyword">import</span> ${<span class="hljs-keyword">import</span>};
#end

<span class="hljs-keyword">import</span> io.swagger.annotations.ApiModel;
<span class="hljs-keyword">import</span> com.kzzyl.common.annotation.Excel;
<span class="hljs-keyword">import</span> io.swagger.annotations.ApiModelProperty;
#<span class="hljs-keyword">if</span>($table.crud || $table.sub)
<span class="hljs-keyword">import</span> com.kzzyl.common.core.domain.BaseEntity;
#elseif($table.tree)
<span class="hljs-keyword">import</span> com.kzzyl.common.core.domain.TreeEntity;
#end

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@author</span> ${author}
 * date ${datetime}
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@NoArgsConstructor</span>
<span class="hljs-meta">@AllArgsConstructor</span>
#<span class="hljs-keyword">if</span>($table.crud || $table.sub)
#set($Entity=<span class="hljs-string">"BaseEntity"</span>)
#elseif($table.tree)
#set($Entity=<span class="hljs-string">"TreeEntity"</span>)
#end
<span class="hljs-meta">@EqualsAndHashCode(callSuper = true)</span>
<span class="hljs-meta">@ApiModel(description = "${functionName}")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">$</span>{ClassName} <span class="hljs-keyword">extends</span> <span class="hljs-title class_">$</span>{Entity} {

    <span class="hljs-meta">@Serial</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>;

#foreach ($column in $columns)
#<span class="hljs-keyword">if</span>(!$table.isSuperColumn($column.javaField))
#<span class="hljs-keyword">if</span>($column.list)
#set($parentheseIndex=$column.columnComment.indexOf(<span class="hljs-string">"ï¼ˆ"</span>))
#<span class="hljs-keyword">if</span>($parentheseIndex != -<span class="hljs-number">1</span>)
#set($comment=$column.columnComment.substring(<span class="hljs-number">0</span>, $parentheseIndex))
#<span class="hljs-keyword">else</span>
#set($comment=$column.columnComment)
#end
#<span class="hljs-keyword">if</span>($parentheseIndex != -<span class="hljs-number">1</span>)
    <span class="hljs-meta">@Excel(name = "${comment}", readConverterExp = "$column.readConverterExp()")</span>
#elseif($column.javaType == <span class="hljs-string">'Date'</span> || $column.javaType == <span class="hljs-string">'LocalDateTime'</span>)
    <span class="hljs-meta">@JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")</span>
    <span class="hljs-meta">@Excel(name = "${comment}", width = 30, dateFormat = "yyyy-MM-dd HH:mm:ss")</span>
#<span class="hljs-keyword">else</span>
    <span class="hljs-meta">@Excel(name = "${comment}")</span>
#end
#end
    <span class="hljs-meta">@ApiModelProperty("${column.columnComment}")</span>
    <span class="hljs-keyword">private</span> $column.javaType $column.javaField;

#end
#end
#<span class="hljs-keyword">if</span>($table.sub)
    <span class="hljs-comment">/** $table.subTable.functionNameä¿¡æ¯ */</span>
    <span class="hljs-keyword">private</span> List&lt;${subClassName}&gt; ${subclassName}List;
#end
#<span class="hljs-keyword">if</span>($table.sub)
    <span class="hljs-keyword">public</span> List&lt;${subClassName}&gt; get${subClassName}List()
    {
        <span class="hljs-keyword">return</span> ${subclassName}List;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> set${subClassName}List(List&lt;${subClassName}&gt; ${subclassName}List)
    {
        <span class="hljs-built_in">this</span>.${subclassName}List = ${subclassName}List;
    }
#end
}
</code></pre>
<p><strong>mapper.java.vm</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> ${packageName}.mapper;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper;
<span class="hljs-keyword">import</span> ${packageName}.domain.${ClassName};
#<span class="hljs-keyword">if</span>($table.sub)
<span class="hljs-keyword">import</span> ${packageName}.domain.${subClassName};
#end

<span class="hljs-comment">/**
 * ${functionName}Mapperæ¥å£
 * 
 * <span class="hljs-doctag">@author</span> ${author}
 * date ${datetime}
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">$</span>{ClassName}Mapper <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;${ClassName}&gt; {

    <span class="hljs-comment">/**
     * æŸ¥è¯¢${functionName}
     * 
     * <span class="hljs-doctag">@param</span> ${pkColumn.javaField} ${functionName}ä¸»é”®
     */</span>
    ${ClassName} select${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaType} ${pkColumn.javaField});

    <span class="hljs-comment">/**
     * æŸ¥è¯¢${functionName}åˆ—è¡¨
     * 
     * <span class="hljs-doctag">@param</span> ${className} ${functionName}
     */</span>
    List&lt;${ClassName}&gt; select${ClassName}List(${ClassName} ${className});

    <span class="hljs-comment">/**
     * æ–°å¢${functionName}
     * 
     * <span class="hljs-doctag">@param</span> ${className} ${functionName}
     */</span>
    <span class="hljs-type">int</span> insert${ClassName}(${ClassName} ${className});

    <span class="hljs-comment">/**
     * ä¿®æ”¹${functionName}
     * 
     * <span class="hljs-doctag">@param</span> ${className} ${functionName}
     */</span>
    <span class="hljs-type">int</span> update${ClassName}(${ClassName} ${className});

    <span class="hljs-comment">/**
     * åˆ é™¤${functionName}
     * 
     * <span class="hljs-doctag">@param</span> ${pkColumn.javaField} ${functionName}ä¸»é”®
     */</span>
    <span class="hljs-type">int</span> delete${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaType} ${pkColumn.javaField});

    <span class="hljs-comment">/**
     * æ‰¹é‡åˆ é™¤${functionName}
     * 
     * <span class="hljs-doctag">@param</span> ${pkColumn.javaField}s éœ€è¦åˆ é™¤çš„æ•°æ®ä¸»é”®é›†åˆ
     */</span>
    <span class="hljs-type">int</span> delete${ClassName}By${pkColumn.capJavaField}s(${pkColumn.javaType}[] ${pkColumn.javaField}s);
#<span class="hljs-keyword">if</span>($table.sub)

    <span class="hljs-comment">/**
     * æ‰¹é‡åˆ é™¤${subTable.functionName}
     * 
     * <span class="hljs-doctag">@param</span> ${pkColumn.javaField}s éœ€è¦åˆ é™¤çš„æ•°æ®ä¸»é”®é›†åˆ
     */</span>
    <span class="hljs-type">int</span> delete${subClassName}By${subTableFkClassName}s(${pkColumn.javaType}[] ${pkColumn.javaField}s);
    
    <span class="hljs-comment">/**
     * æ‰¹é‡æ–°å¢${subTable.functionName}
     * 
     * <span class="hljs-doctag">@param</span> ${subclassName}List ${subTable.functionName}åˆ—è¡¨
     */</span>
    <span class="hljs-type">int</span> batch${subClassName}(List&lt;${subClassName}&gt; ${subclassName}List);
    

    <span class="hljs-comment">/**
     * é€šè¿‡${functionName}ä¸»é”®åˆ é™¤${subTable.functionName}ä¿¡æ¯
     * 
     * <span class="hljs-doctag">@param</span> ${pkColumn.javaField} ${functionName}ID
     */</span>
    <span class="hljs-type">int</span> delete${subClassName}By${subTableFkClassName}(${pkColumn.javaType} ${pkColumn.javaField});
#end
}
</code></pre>
<p><strong>service.java.vm</strong></p>
<pre><code class="hljs language-vm" lang="vm">package ${packageName}.service;

import java.util.List;

import com.baomidou.mybatisplus.extension.service.IService;
import ${packageName}.domain.${ClassName};

/**
 * ${functionName}Serviceæ¥å£
 * 
 * @author ${author}
 * date ${datetime}
 */
public interface I${ClassName}Service extends IService&lt;${ClassName}&gt; {

    /**
     * æŸ¥è¯¢${functionName}
     * 
     * @param ${pkColumn.javaField} ${functionName}ä¸»é”®
     */
    ${ClassName} select${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaType} ${pkColumn.javaField});

    /**
     * æŸ¥è¯¢${functionName}åˆ—è¡¨
     * 
     * @param ${className} ${functionName}
     */
    List&lt;${ClassName}&gt; select${ClassName}List(${ClassName} ${className});

    /**
     * æ–°å¢${functionName}
     * 
     * @param ${className} ${functionName}
     */
    boolean insert${ClassName}(${ClassName} ${className});

    /**
     * ä¿®æ”¹${functionName}
     * 
     * @param ${className} ${functionName}
     */
    boolean update${ClassName}(${ClassName} ${className});

    /**
     * æ‰¹é‡åˆ é™¤${functionName}
     * 
     * @param ${pkColumn.javaField}s éœ€è¦åˆ é™¤çš„${functionName}ä¸»é”®é›†åˆ
     */
    boolean delete${ClassName}By${pkColumn.capJavaField}s(${pkColumn.javaType}[] ${pkColumn.javaField}s);

}
</code></pre>
<p><strong>serviceImpl.java.vm</strong></p>
<pre><code class="hljs language-vm" lang="vm">package ${packageName}.service;

import java.util.List;

import com.baomidou.mybatisplus.extension.service.IService;
import ${packageName}.domain.${ClassName};

/**
 * ${functionName}Serviceæ¥å£
 * 
 * @author ${author}
 * date ${datetime}
 */
public interface I${ClassName}Service extends IService&lt;${ClassName}&gt; {

    /**
     * æŸ¥è¯¢${functionName}
     * 
     * @param ${pkColumn.javaField} ${functionName}ä¸»é”®
     */
    ${ClassName} select${ClassName}By${pkColumn.capJavaField}(${pkColumn.javaType} ${pkColumn.javaField});

    /**
     * æŸ¥è¯¢${functionName}åˆ—è¡¨
     * 
     * @param ${className} ${functionName}
     */
    List&lt;${ClassName}&gt; select${ClassName}List(${ClassName} ${className});

    /**
     * æ–°å¢${functionName}
     * 
     * @param ${className} ${functionName}
     */
    boolean insert${ClassName}(${ClassName} ${className});

    /**
     * ä¿®æ”¹${functionName}
     * 
     * @param ${className} ${functionName}
     */
    boolean update${ClassName}(${ClassName} ${className});

    /**
     * æ‰¹é‡åˆ é™¤${functionName}
     * 
     * @param ${pkColumn.javaField}s éœ€è¦åˆ é™¤çš„${functionName}ä¸»é”®é›†åˆ
     */
    boolean delete${ClassName}By${pkColumn.capJavaField}s(${pkColumn.javaType}[] ${pkColumn.javaField}s);

}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨Pythonåœ¨Linuxä¸Šå®ç°ç®€å•æŠ“åŒ…å·¥å…·çš„å®Œæ•´æ•™ç¨‹]]></title>    <link>https://juejin.cn/post/7596181746061295643</link>    <guid>https://juejin.cn/post/7596181746061295643</guid>    <pubDate>2026-01-17T09:42:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596181746061295643" data-draft-id="7595847940621778994" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨Pythonåœ¨Linuxä¸Šå®ç°ç®€å•æŠ“åŒ…å·¥å…·çš„å®Œæ•´æ•™ç¨‹"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-17T09:42:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¼€å¿ƒå°±å¥½2025"/> <meta itemprop="url" content="https://juejin.cn/user/3850962908492660"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨Pythonåœ¨Linuxä¸Šå®ç°ç®€å•æŠ“åŒ…å·¥å…·çš„å®Œæ•´æ•™ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3850962908492660/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¼€å¿ƒå°±å¥½2025
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T09:42:10.000Z" title="Sat Jan 17 2026 09:42:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>PythonæŠ“åŒ…å‘åŒ…å®ç°æ¸¸æˆè‡ªåŠ¨åŒ– pythonæŠ“åŒ…ç¨‹åº</p>
<p>ç°ä»£è®¡ç®—æœºç¨‹åºå¤§éƒ¨åˆ†æ—¶å€™ç¦»ä¸å¼€ç½‘ç»œï¼Œä½œä¸ºå¼€å‘è€…ï¼Œåœ¨æ—¥å¸¸å¼€å‘ç½‘ç»œç›¸å…³çš„ç¨‹åºæˆ–è€…æ’æŸ¥ç¨‹åºé”™è¯¯æ—¶ç»å¸¸ä¼šç”¨æŠ“åŒ…å·¥å…·æ¥åˆ†æç½‘å¡æ”¶å‘çš„æ•°æ®ï¼Œæ¯”å¦‚è‘—åçš„tcpdumpï¼ŒWiresharkç­‰ã€‚å¯¹äºéœ€è¦å…¨å¹³å°æ”¯æŒä¸”æ— éœ€ä»£ç†æˆ–è¶Šç‹±çš„æŠ“åŒ…éœ€æ±‚ï¼ŒSniffmasteræ˜¯ä¸€ä¸ªå¼ºå¤§çš„é€‰æ‹©ï¼Œå®ƒæ”¯æŒHTTPSã€TCPå’ŒUDPåè®®ï¼Œå¹¶åœ¨iOSã€Androidã€Macå’ŒWindowsè®¾å¤‡ä¸Šæä¾›æš´åŠ›æŠ“åŒ…å’Œä»£ç†æŠ“åŒ…åŠŸèƒ½ã€‚</p>
<p>ä»Šå¤©æˆ‘ä»¬å°è¯•ç”¨100è¡Œå·¦å³çš„Pythonä»£ç åœ¨Linuxç³»ç»Ÿä¸Šå®ç°ä¸€ä¸ªç®€å•çš„æŠ“åŒ…å·¥å…·ã€‚</p>
<p>æœ¬æ–‡å…±åˆ†ä¸ºå››èŠ‚ï¼Œå‰ä¸‰èŠ‚åˆ†åˆ«ä»‹ç»äº†ä¸‰ä¸ªåŸºæœ¬æ¦‚å¿µï¼ŒåŒ…æ‹¬ç«¯åºã€socketã€ä»¥å¤ªç½‘å¸§ç»“æ„ï¼Œæœ€åä¸€èŠ‚ä»‹ç»å…·ä½“å®ç°ï¼Œæ–‡æœ«æœ‰å®Œæ•´ä»£ç ã€‚</p>
<ol>
<li>ç«¯åº</li>
</ol>
<p>è¯•æƒ³ä¸€ä¸ª16è¿›åˆ¶æ•°0x12345678ï¼Œå¤§ç«¯åºåœ¨å†…å­˜ä¸­çš„å‚¨å­˜é¡ºåºå¦‚ä¸‹ï¼Œé«˜å­—èŠ‚ä¿å­˜åœ¨å†…å­˜çš„ä½åœ°å€ï¼Œé«˜å­—èŠ‚åœ¨å‰ï¼š</p>
<p>å†…å­˜åœ°å€ 0 1 2 3</p>
<p>---------------------</p>
<p>å­—èŠ‚æ•°æ® | 12 | 34 | 56 | 78 |</p>
<p>---------------------</p>
<p>è€Œå°ç«¯åºé«˜å­—èŠ‚ä¿å­˜åœ¨å†…å­˜çš„é«˜åœ°å€ï¼Œä½å­—èŠ‚åœ¨å‰ï¼š</p>
<p>å†…å­˜åœ°å€ 0 1 2 3</p>
<p>---------------------</p>
<p>å­—èŠ‚æ•°æ® | 78 | 56 | 34 | 12 |</p>
<p>---------------------</p>
<p>å¤§ç«¯åºè¿˜æ˜¯å°ç«¯åºæ˜¯ç”±ç¡¬ä»¶å†³å®šçš„ï¼Œé€šå¸¸CPUå’Œå†…å­˜ä¸­çš„æ•°æ®éƒ½æ˜¯å°ç«¯åºï¼Œè€Œç½‘ç»œä¼ è¾“éƒ½ç”¨å¤§ç«¯åºï¼Œå› ä¸ºå¤§ç«¯åºå­—èŠ‚æµè§£æèµ·æ¥æ›´æ–¹ä¾¿ï¼Œä½†æœ‰äº›ç‰¹æ®Šçš„è®¾å¤‡æ˜¯ä¾‹å¤–ã€‚</p>
<p>Pythonä¸­socketæ¨¡å—çš„htonsï¼Œntohsï¼Œhtonlï¼Œntohlå‡½æ•°ç”¨æ¥å¤„ç†ç½‘ç»œå­—èŠ‚é¡ºåºä¸æœ¬åœ°å­—èŠ‚é¡ºåºä¹‹é—´çš„è½¬æ¢ã€‚å‡½æ•°åä¸­hè¡¨ç¤ºhostï¼Œnè¡¨ç¤ºnetï¼Œsè¡¨ç¤ºshort intï¼ˆ2å­—èŠ‚ï¼‰ï¼Œlè¡¨ç¤ºlong intï¼ˆ4å­—èŠ‚ï¼‰ï¼Œæ¯”å¦‚htonsæ˜¯å°†2å­—èŠ‚é•¿çš„æ•´æ•°ä»æœ¬åœ°ç«¯åºè½¬æ¢ä¸ºç½‘ç»œç«¯åºã€‚æ¯”å¦‚ï¼š</p>
<p>import socket</p>
<p>i = 0x1234 # æœ¬åœ°å°ç«¯åº</p>
<p>net_i = socket.htons(i) # ç½‘ç»œå¤§ç«¯åº</p>
<p>print(hex(i), hex(net_i))</p>
<p># è¾“å‡º 0x1234 0x3412</p>
<ol start="2">
<li>socketç¼–ç¨‹</li>
</ol>
<p>socketæ˜¯æ“ä½œç³»ç»Ÿç”¨æˆ·ä¸TCP/IPåè®®æ—é€šä¿¡çš„æ¥å£ï¼Œåˆ›å»ºä¸€ä¸ªsocketéœ€è¦3ä¸ªå‚æ•°ï¼Œåœ°å€ç°‡ï¼Œsocketç±»å‹ï¼Œåè®®ã€‚æ¯”å¦‚å¯ä»¥ç”¨ä»¥ä¸‹ä»£ç åˆ›å»ºä¸€ä¸ªå¸¸ç”¨çš„TCPå¥—æ¥å­—ï¼Œç”¨æ¥æ”¶å‘TCPæ•°æ®æµï¼š</p>
<p>import socket</p>
<p># AF_INET: internetåè®®ç°‡</p>
<p># SOCK_STREAM: streamç±»å‹çš„socket</p>
<p># 0: ä½¿ç”¨è¯¥socketç±»å‹çš„é»˜è®¤åè®®ï¼Œå³TCPåè®®</p>
<p>sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM, 0)</p>
<p>ä¹Ÿå¯ä»¥ç”¨ä»¥ä¸‹ä»£ç åˆ›å»ºä¸€ä¸ªUDPå¥—æ¥å­—ï¼Œç”¨æ¥æ”¶å‘UDPæ•°æ®åŒ…ï¼š</p>
<p># SOCK_STREAM: data gramç±»å‹çš„socket</p>
<p># 0: ä½¿ç”¨è¯¥socketç±»å‹çš„é»˜è®¤åè®®ï¼Œå³UDPåè®®</p>
<p>sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, 0)</p>
<p>ä½†æ˜¯æˆ‘ä»¬ä»Šå¤©è¦ç”¨çš„ä¸æ˜¯è¿™ç±»å¥—æ¥å­—ï¼Œè€Œæ˜¯æ›´åº•å±‚çš„åŸå§‹å¥—æ¥å­—raw socketï¼Œè¿™ç±»å¥—æ¥å­—å¯ä»¥æ“ä½œæ›´åº•çš„åè®®æ¯”å¦‚IPåè®®å’Œä»¥å¤ªç½‘åè®®ï¼Œåˆ›å»ºraw socketéœ€è¦rootæƒé™ã€‚å¯ä»¥ç”¨ä»¥ä¸‹ä»£ç åˆ›å»ºä¸€ä¸ªæ¥æ”¶ä»¥å¤ªç½‘æ•°æ®åŒ…çš„åŸå§‹å¥—æ¥å­—ï¼š</p>
<p>ETH_P_ALL = 0x3</p>
<p>ETH_P_IP = 0x0800</p>
<p>ETH_P_ARP = 0x0806</p>
<p>ETH_P_RARP = 0x8035</p>
<p>ETH_P_IPV6 = 0x086dd</p>
<p>raw_sock = socket.socket(socket.AF_PACKET, socket.SOCK_RAW, socket.htons(ETH_P_ALL))</p>
<p>å…¶ä¸­ETH_P_ALLè¡¨ç¤ºç›‘å¬æ‰€æœ‰åè®®çš„ä»¥å¤ªç½‘æ•°æ®åŒ…ï¼Œå¦‚æœæ”¹ç”¨ETH_P_IPåˆ™åªä¼šç›‘å¬IPåè®®çš„æ•°æ®åŒ…ã€‚ï¼ˆç”±äºWindowsç³»ç»Ÿä¸Šæ²¡æœ‰å®šä¹‰AF_PACKETï¼Œæ‰€ä»¥è¿™æ®µä»£ç æ— æ³•åœ¨Windowsç³»ç»Ÿä¸Šè¿è¡Œï¼‰</p>
<p>ç„¶åå¯ä»¥å¼€å§‹ç›‘å¬ï¼š</p>
<p>while True:</p>
<p>packet, packet_info = raw_sock.recvfrom(1500)</p>
<p>print(packet)</p>
<p>recvfromå‡½æ•°è¿”å›2ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªæ˜¯ä»¥å¤ªç½‘æ•°æ®åŒ…ï¼Œç¬¬äºŒä¸ªæ˜¯è¯¥æ•°æ®åŒ…ç›¸å…³çš„ä¿¡æ¯ã€‚</p>
<ol start="3">
<li>ä»¥å¤ªç½‘å¸§æ ¼å¼</li>
</ol>
<p>ä»¥å¤ªç½‘å¸§æ ¹æ®ä¸åŒçš„æ ‡å‡†æœ‰å¤šç§æ ¼å¼ï¼Œå¸¸è§çš„æœ‰Ethernet IIæ ¼å¼å’ŒEthernet 802.3æ ¼å¼ã€‚</p>
<p>Ethernet IIå¸§æ ¼å¼DMACï¼š6å­—èŠ‚ï¼Œç›®æ ‡MACåœ°å€</p>
<p>SMACï¼š6å­—èŠ‚ï¼ŒæºMACåœ°å€</p>
<p>Typeï¼š2å­—èŠ‚ï¼Œä¸Šå±‚åè®®ç±»å‹</p>
<p>Dataï¼š46ï½1500å­—èŠ‚å¯å˜é•¿åº¦ï¼Œè½½è·æ•°æ®</p>
<p>FCSï¼šæœ€å4å­—èŠ‚ï¼Œå¸§æ ¡éªŒ</p>
<p>Ethernet 802.3å¸§æ ¼å¼DMACï¼š6å­—èŠ‚ï¼Œç›®æ ‡MACåœ°å€</p>
<p>SMACï¼š6å­—èŠ‚ï¼ŒæºMACåœ°å€</p>
<p>Lengthï¼š2å­—èŠ‚ï¼ŒDataå­—æ®µåŒ…å«çš„å­—èŠ‚æ•°</p>
<p>LLCï¼š3å­—èŠ‚ï¼Œé€»è¾‘é“¾è·¯æ§åˆ¶</p>
<p>SNAPï¼š5å­—èŠ‚ï¼ŒSub-network Access Protocol</p>
<p>Dataï¼š38ï½1492å­—èŠ‚å¯å˜é•¿åº¦ï¼Œè½½è·æ•°æ®</p>
<p>FCSï¼šæœ€å4å­—èŠ‚ï¼Œå¸§æ ¡éªŒ</p>
<p>å¯ä»¥çœ‹åˆ°Ethernet IIå’ŒEthernet802.3æ ¼å¼çš„å‰12å­—èŠ‚ç»“æ„ç›¸åŒï¼Œç”±äºEthernet 802.3çš„å¤´éƒ¨å¤šäº†8å­—èŠ‚ï¼Œæ‰€ä»¥è½½è·æ•°æ®é•¿åº¦æœ€å¤§åªèƒ½ä¸º1492å­—èŠ‚ã€‚å¦å¤–éœ€è¦æ³¨æ„ï¼ŒåŸå§‹å¥—æ¥å­—è¯»å–åˆ°çš„åŒ…æœ€åä¸åŒ…å«å¸§æ ¡éªŒã€‚</p>
<ol start="4">
<li>è§£æä»¥å¤ªç½‘å¤´éƒ¨</li>
</ol>
<p>åœ¨æˆ‘ä»¬äº†è§£äº†ä»¥å¤ªç½‘å¸§æ ¼å¼åå°±å¯ä»¥å¼€å§‹è§£ææ¥æ”¶åˆ°çš„äºŒè¿›åˆ¶æ•°æ®äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹ä»£ç æŠŠMACåœ°å€è½¬æ¢æˆæ•´æ•°ï¼š</p>
<p>BIG_ENDIAN = 'big'</p>
<p>dst_mac = int.from_bytes(packet[:6], BIG_ENDIAN)</p>
<p>src_mac = int.from_bytes(packet[6:12], BIG_ENDIAN)</p>
<p>ä»ç¬¬12ã€13å­—èŠ‚ç”¨æ¥åŒºåˆ†æ¥æ”¶åˆ°çš„æ˜¯Ethernet IIå¸§è¿˜æ˜¯Ethernet 802.3å¸§ï¼Œå¦‚æœè¯¥æ•°å­—å°äºç­‰äº1500ï¼ˆ0x05DCï¼‰å¯ä»¥åˆ¤æ–­æ¥æ”¶åˆ°çš„æ˜¯Ethernet 802.3å¸§ï¼Œå¦‚æœè¯¥æ•°å­—å¤§äºç­‰äº1536ï¼ˆ0x0600ï¼‰åˆ™æ¥æ”¶åˆ°çš„æ˜¯Ethernet IIå¸§ã€‚å…¶ä»–å­—æ®µæŒ‰ç…§å¸§æ ¼å¼ä¾æ¬¡è§£æå³å¯ã€‚</p>
<p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<p>import socket</p>
<p>BIG_ENDIAN = 'big'</p>
<p>LITTLE_ENDIAN = 'little'</p>
<p>ETH_P_ALL = 0x3</p>
<p>ETH_P_IP = 0x0800</p>
<p>ETH_P_ARP = 0x0806</p>
<p>ETH_P_RARP = 0x8035</p>
<p>ETH_P_IPV6 = 0x086dd</p>
<p>ETH_TYPE_MAP = {</p>
<p>ETH_P_IP: 'IP',</p>
<p>ETH_P_ARP: 'ARP',</p>
<p>ETH_P_RARP: 'RARP',</p>
<p>ETH_P_IPV6: 'IPv6'</p>
<p>}</p>
<p>class MACAddress:</p>
<p>def __init__(self, addr: int):</p>
<p>self.addr = addr</p>
<p>def __str__(self):</p>
<p>return ':'.join('{:02x}'.format(a) for a in self.addr.to_bytes(6, BIG_ENDIAN))</p>
<p>def __repr__(self):</p>
<p>return self.__str__()</p>
<p>class EthernetHeader:</p>
<p>def __init__(self, dst_mac, src_mac):</p>
<p>self.dst_mac = dst_mac</p>
<p>self.src_mac = src_mac</p>
<p>def describe(self):</p>
<p>return {</p>
<p>'src_mac': MACAddress(self.src_mac),</p>
<p>'dst_mac': MACAddress(self.dst_mac)</p>
<p>}</p>
<p>class EthernetIIHeader(EthernetHeader):</p>
<p>def __init__(self, dst_mac, src_mac):</p>
<p>super().__init__(dst_mac, src_mac)</p>
<p>self.eth_type = 0</p>
<p>def describe(self):</p>
<p>dct = super().describe()</p>
<p>dct['eth_type'] = self._describe_eth_type(self.eth_type)</p>
<p>return dct</p>
<p>@staticmethod</p>
<p>def _describe_eth_type(eth_type):</p>
<p>if eth_type in ETH_TYPE_MAP:</p>
<p>return ETH_TYPE_MAP[eth_type]</p>
<p>return 'Unknown protocol{}'.format(eth_type)</p>
<p>class Ethernet802_3Header(EthernetHeader):</p>
<p>def __init__(self, dst_mac, src_mac):</p>
<p>super().__init__(dst_mac, src_mac)</p>
<p>self.length = 0</p>
<p>self.llc = 0</p>
<p>self.snap = 0</p>
<p>def describe(self):</p>
<p>dct = super().describe()</p>
<p>dct['length'] = self.length</p>
<p>dct['llc'] = self.llc</p>
<p>dct['snap'] = self.snap</p>
<p>return dct</p>
<p>def unpack(packet):</p>
<p>dst_mac = int.from_bytes(packet[:6], BIG_ENDIAN)</p>
<p>src_mac = int.from_bytes(packet[6:12], BIG_ENDIAN)</p>
<p>type_or_length = int.from_bytes(packet[12:14], BIG_ENDIAN)</p>
<p>if type_or_length &lt; 1500:</p>
<p>hdr = Ethernet802_3Header(dst_mac, src_mac)</p>
<p>hdr.length = type_or_length</p>
<p>hdr.llc = int.from_bytes(packet[14:17], BIG_ENDIAN)</p>
<p>hdr.snap = int.from_bytes(packet[17:22], BIG_ENDIAN)</p>
<p>return hdr, packet[22:]</p>
<p>elif type_or_length &gt;= 1536:</p>
<p>hdr = EthernetIIHeader(dst_mac, src_mac)</p>
<p>hdr.eth_type = type_or_length</p>
<p>return hdr, packet[14:]</p>
<p>else:</p>
<p>raise ValueError(type_or_length)</p>
<p>def main():</p>
<p>raw_sock = socket.socket(socket.PF_PACKET, socket.SOCK_RAW, socket.htons(ETH_P_ALL))</p>
<p>while True:</p>
<p>try:</p>
<p>packet, packet_info = raw_sock.recvfrom(1500)</p>
<p>eth_header, payload = unpack(packet)</p>
<p>print(eth_header.describe(), payload)</p>
<p>except KeyboardInterrupt:</p>
<p>break</p>
<p>except ValueError as e:</p>
<p>print('unpack failed', e)</p>
<p>if __name__ == '__main__':</p>
<p>main()</p>
<p>æœ€åï¼Œç”¨rootæƒé™è¿è¡ŒæŠ“åŒ…ç¨‹åºï¼Œå¯ä»¥çœ‹åˆ°å±å¹•ä¸Šè¾“å‡ºäº†è§£æåçš„Ethernetå¤´éƒ¨å’Œæœªè§£æçš„è½½è·æ•°æ®ï¼Œå¦‚æœæœ‰å…´è¶£çš„è¯å¯ä»¥æŒ‰ç…§åè®®æ ‡å‡†ç»§ç»­è§£æè½½è·æ•°æ®ä¸­çš„ä¸Šå±‚åè®®ã€‚å¯¹äºæ›´å¤æ‚çš„æŠ“åŒ…åœºæ™¯ï¼Œå¦‚HTTPSè§£å¯†æˆ–è·¨å¹³å°æ”¯æŒï¼Œå·¥å…·å¦‚Sniffmasteræä¾›äº†é¢å¤–åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ•°æ®æµæš´åŠ›æŠ“åŒ…å’Œä»£ç†æŠ“åŒ…ï¼Œæ— éœ€è¶Šç‹±æˆ–rootå³å¯ä½¿ç”¨ã€‚</p>
<p>{'src_mac': 50:fa:84:aa:aa:aa, 'dst_mac': ac:d1:b8:aa:aa:aa, 'eth_type': 'IP'} b'E\x00\x00T\x0c\xfe@\x004\x01\x93*\xb4e1\x0c\xc0\xa8\x00g\x00\x00\xb6\x83-\x8e\x00\x07\xa6\xb4c^\x00\x00\x00\x00G\x01\x0c\x00\x00\x00\x00\x00\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !"#$%&amp;\'()*+,-./01234567'</p>
<p>...</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ«åªæŠŠ JSON å½“å­—ç¬¦ä¸²ï¼šPostgreSQL ç”¨ JSONB æŠŠâ€œåŠç»“æ„åŒ–æ•°æ®â€æŸ¥å¿«äº†]]></title>    <link>https://juejin.cn/post/7595864836359995444</link>    <guid>https://juejin.cn/post/7595864836359995444</guid>    <pubDate>2026-01-17T07:23:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595864836359995444" data-draft-id="7595871887000862720" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ«åªæŠŠ JSON å½“å­—ç¬¦ä¸²ï¼šPostgreSQL ç”¨ JSONB æŠŠâ€œåŠç»“æ„åŒ–æ•°æ®â€æŸ¥å¿«äº†"/> <meta itemprop="keywords" content="æ•°æ®åº“,PostgreSQL,DBA"/> <meta itemprop="datePublished" content="2026-01-17T07:23:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æŠ€æœ¯ä¸æ‰“çƒŠ"/> <meta itemprop="url" content="https://juejin.cn/user/893244690677165"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ«åªæŠŠ JSON å½“å­—ç¬¦ä¸²ï¼šPostgreSQL ç”¨ JSONB æŠŠâ€œåŠç»“æ„åŒ–æ•°æ®â€æŸ¥å¿«äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/893244690677165/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æŠ€æœ¯ä¸æ‰“çƒŠ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T07:23:47.000Z" title="Sat Jan 17 2026 07:23:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b0883a71e83649d6a854be714f8a1745~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oqA5pyv5LiN5omT54OK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239427&amp;x-signature=Uxi7L5Lkc0g7E6ZOsyVbT2OOWfk%3D" alt="1.png" loading="lazy"/>
ä¸€ççœ¼ï¼Œéš”å£å¤§å‚çš„DBAå› ä¸ºé¢‘ç¹æ”¹è¡¨ç»“æ„å’Œäº§å“ç»ç†â€œæ‰“èµ·æ¥â€äº†ï¼
æ•°æ®ä¸ä¼šæ’’è°ï¼šä¼ ç»Ÿç ”å‘ä¸­ï¼Œ<strong>é«˜è¾¾50%çš„æ—¶é—´</strong>æµªè´¹åœ¨å­—æ®µå¯¹é½ã€æ¸…æ´—å’ŒSchemaè¿ç§»çš„æ— å°½æ‰¯çš®ä¸­ã€‚
éš¾æ€ªPostgreSQLç¤¾åŒºå¤§ä½¬éƒ½åæ§½ï¼šâ€œTrying to fit dynamic data into rigid columns is a fool's errand.â€ï¼ˆè¯•å›¾æŠŠåŠ¨æ€æ•°æ®å¡è¿›åƒµåŒ–åˆ—ç®€ç›´æ˜¯è‡ªæ‰¾è‹¦åƒï¼‰ã€‚</p>
<hr/>
<h2 data-id="heading-0">å­—æ®µå¤§çˆ†ç‚¸ï¼šæ˜¯æŠ€æœ¯å€ºè¿˜æ˜¯ä¸šåŠ¡åˆšéœ€ï¼Ÿ</h2>
<p>ç”µå•†å¤§ä¿ƒï¼Œè¿è¥çªç„¶è¦åŠ ä¸ªâ€œé‹åº•æè´¨â€å±æ€§ï¼›åšåŸ‹ç‚¹åˆ†æï¼Œå‰ç«¯ç‰ˆæœ¬ä¸€æ›´æ–°ï¼ŒEventé‡Œçš„å­—æ®µåˆå˜äº†ã€‚
è¿™ç§**â€œåŠç»“æ„åŒ–æ•°æ®â€**çš„å™©æ¢¦ï¼Œç›¸ä¿¡æ¯ä¸ªåšä¸šåŠ¡ç³»ç»Ÿçš„å…„å¼Ÿéƒ½ç»å†è¿‡ã€‚
ä¼ ç»Ÿçš„åšæ³•ï¼Ÿè¦ä¹ˆç–¯ç‹‚åŠ åˆ—ï¼ˆAlter Tableåˆ°å¤´ç§ƒï¼‰ï¼Œè¦ä¹ˆæŠŠä¸€å¨JSONç›´æ¥å½“å­—ç¬¦ä¸²æ‰”è¿› <code>TEXT</code> å­—æ®µé‡Œã€‚</p>
<p>ç»“æœå‘¢ï¼Ÿ
å­˜çš„æ—¶å€™æ˜¯çˆ½äº†ï¼ŒæŸ¥çš„æ—¶å€™<strong>å…¨è¡¨æ‰«æ</strong>ï¼ŒCPUç›´æ¥é£™åˆ°100%ã€‚ä½ ä»¥ä¸ºä½ åœ¨åšæ¶æ„ï¼Œå…¶å®æ˜¯åœ¨ç»™æ•°æ®åº“åŸ‹é›·ã€‚
è¿™æ—¶å€™ï¼ŒPostgreSQL çš„ <strong>JSONB</strong> ç®€ç›´å°±æ˜¯æ•‘å‘½ç¨»è‰â€”â€”å®ƒä¸æ˜¯ç®€å•çš„â€œèƒ½å­˜JSONâ€ï¼Œè€Œæ˜¯æŠŠåŠç»“æ„åŒ–æ•°æ®çš„<strong>å­˜å‚¨ã€ç´¢å¼•ã€æŸ¥è¯¢</strong>å˜æˆäº†ä¸€å¥—å¯è½åœ°çš„å·¥ç¨‹åŒ–èƒ½åŠ›ã€‚</p>
<blockquote>
<p><strong>çµé­‚æ‹·é—®ï¼š</strong> ä½ ç°åœ¨çš„ JSON æ•°æ®æ˜¯ä»…ä»…â€œæ´»ç€â€ï¼Œè¿˜æ˜¯åœ¨â€œè£¸å¥”â€ï¼Ÿ</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">JSON vs JSONBï¼šé€‰å‹ä¸€å¥è¯è®²æ˜ç™½</h2>
<p>åˆ«è¢«è¿™ä¿©åå­—ç»•æ™•äº†ï¼ŒåŒºåˆ«å°±åœ¨æ€ä¹ˆâ€œå­˜â€ã€‚
<strong>JSON</strong> ç±»å‹å°±æ˜¯çº¯æ–‡æœ¬ï¼Œä½ æ€ä¹ˆå­˜å®ƒæ€ä¹ˆæ”¾ï¼Œæ¯æ¬¡è¯»éƒ½è¦é‡æ–°è§£æï¼Œå°±åƒä¸€ä¸ªå°æ­»çš„çº¸ç®±å­ã€‚
<strong>JSONB</strong> åˆ™æ˜¯äºŒè¿›åˆ¶å­˜å‚¨ï¼ˆBinaryï¼‰ï¼Œå…¥åº“æ—¶è™½ç„¶æ…¢ç‚¹ï¼ˆå› ä¸ºè¦é¢„å¤„ç†ï¼‰ï¼Œä½†å­˜å¥½åè‡ªå¸¦ç›®å½•ï¼ŒæŸ¥èµ·æ¥é£å¿«ï¼Œå°±åƒé€æ˜çš„æ”¶çº³ç›’ ã€‚</p>
<p><strong>æ¥çœ‹ä¸€ç»„å½­åšç¤¾çº§åˆ«çš„ç¡¬æ ¸æµ‹è¯•ï¼š</strong>
åŒæ ·æ’å…¥å¤§é‡æ•°æ®ï¼ŒJSONå¯èƒ½åªèŠ±13ç§’ï¼Œè€ŒJSONBè¦èŠ±20ç§’ï¼ˆå› ä¸ºè¦è§£æå’Œå»é‡é”®å€¼ï¼‰ã€‚
<strong>ä½†çœŸæ­£çš„è´¨å˜åœ¨æŸ¥è¯¢ï¼š</strong>
å½“ä½ è¦æ£€ç´¢æŸä¸ªKeyæ—¶ï¼ŒJSONBé…åˆç´¢å¼•ä»…éœ€ <strong>8ms</strong>ï¼Œè€Œæ™®é€šJSONå¯èƒ½è¦è·‘ <strong>27ms</strong> ç”šè‡³æ›´ä¹… ã€‚</p>
<p><strong>è®°è¿™ä¸ªå£è¯€ï¼š</strong></p>
<ul>
<li><strong>åªå­˜ä¸æŸ¥</strong>ï¼ˆåšæ—¥å¿—å­˜æ¡£ã€åŸæ ·å±•ç¤ºï¼‰ï¼šé€‰ <strong>JSON</strong>ã€‚</li>
<li><strong>è¦æŸ¥è¦ç­›</strong>ï¼ˆåšæœç´¢ã€è¿‡æ»¤ã€å…³è”ï¼‰ï¼šæ— è„‘é€‰ <strong>JSONB</strong>ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-2">é»„é‡‘æ¨¡æ¿ï¼šæŠŠâ€œçµæ´»â€å’Œâ€œè§„çŸ©â€åŒæ—¶æ‹¿åˆ°</h2>
<p>å¾ˆå¤šå›¢é˜Ÿç”¨ä¸å¥½JSONBï¼Œæ˜¯å› ä¸ºèµ°å‘äº†æç«¯ï¼šè¦ä¹ˆä¸ç”¨ï¼Œè¦ä¹ˆå…¨ç”¨ã€‚
<strong>æœ€èªæ˜çš„åšæ³•æ˜¯â€œæ··æ­â€</strong>ï¼šæ ¸å¿ƒå­—æ®µå®ˆè§„çŸ©ï¼Œé•¿å°¾å­—æ®µæ”¾é£è‡ªæˆ‘ã€‚</p>
<p>ç»™ä½ ä»¬ä¸€å¼ ä»·å€¼ç™¾ä¸‡çš„**â€œé€šç”¨äº‹ä»¶è¡¨â€**è®¾è®¡æ¨¡æ¿ï¼š</p>






























<table><thead><tr><th align="left">å­—æ®µå</th><th align="left">ç±»å‹</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="left"><strong>id</strong></td><td align="left">BigInt</td><td align="left"><strong>ä¸»é”®</strong>ï¼ˆé›·æ‰“ä¸åŠ¨ï¼‰</td></tr><tr><td align="left"><strong>created_at</strong></td><td align="left">Timestamp</td><td align="left"><strong>æ ¸å¿ƒæ—¶é—´</strong>ï¼ˆç´¢å¼•åˆšéœ€ï¼‰</td></tr><tr><td align="left"><strong>tenant_id</strong></td><td align="left">Int</td><td align="left"><strong>ç§Ÿæˆ·éš”ç¦»</strong>ï¼ˆå¼ºçº¦æŸï¼‰</td></tr><tr><td align="left"><strong>payload</strong></td><td align="left"><strong>JSONB</strong></td><td align="left"><strong>å˜åŒ–å­—æ®µ</strong>ï¼ˆç”šè‡³å¯ä»¥å¡ç‰ˆæœ¬å· <code>schema_ver</code>ï¼‰</td></tr></tbody></table>
<blockquote>
<p><strong>è®¾è®¡å“²å­¦ï¼š</strong> å“ªæ€•ä¸šåŠ¡å†å˜ï¼Œ<code>payload</code> é‡Œçš„å­—æ®µéšä¾¿åŠ ï¼Œä½†å¤–å±‚çš„ <code>id</code> å’Œ <code>time</code> æ°¸è¿œä¿è¯ä½ çš„æŸ¥è¯¢åº•ç›˜ä¸å´© ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-3">æé€ŸæŸ¥è¯¢ä¸‰ä»¶å¥—ï¼šå†™æ³•+ç´¢å¼•+è§£é‡Šè®¡åˆ’</h2>
<p>æŠŠæ•°æ®å­˜è¿›å»åªæ˜¯ç¬¬ä¸€æ­¥ï¼Œæ€ä¹ˆæŸ¥å¾—å¿«æ‰æ˜¯è€å¸æœºçš„åŠŸåŠ›ã€‚</p>
<p><strong>1. æ›´æ˜¯â€œé»‘è¯â€çš„æŸ¥è¯¢ç¬¦</strong>
åˆ«å†ç”¨ <code>LIKE</code> æ¨¡ç³ŠåŒ¹é…äº†ï¼PostgreSQL æä¾›äº†ä¸“ç”¨çš„ç¥å…µåˆ©å™¨ï¼š</p>
<ul>
<li><strong>å–å€¼</strong>ï¼š<code>payload -&gt;&gt; 'user_id'</code>ï¼ˆç›´æ¥æ‹¿æ–‡æœ¬ï¼‰</li>
<li><strong>åŒ…å«</strong>ï¼š<code>payload @&gt; '{"region": "CN"}'</code>ï¼ˆæœ€å¼ºåŒ¹é…ï¼ŒåŒ…å«å³å‘½ä¸­ï¼‰</li>
<li><strong>å­˜åœ¨</strong>ï¼š<code>payload ? 'vip_level'</code>ï¼ˆåˆ¤æ–­Keyåœ¨ä¸åœ¨ï¼‰</li>
</ul>
<p><strong>2. ç´¢å¼•æ ¸æ­¦å™¨ï¼šGIN</strong>
æ™®é€šçš„ B-Tree ç´¢å¼•å¯¹ JSON å†…éƒ¨å­—æ®µæŸæ‰‹æ— ç­–ï¼Œè¿™æ—¶å€™å¿…é¡»ä¸Š <strong>GIN (Generalized Inverted Index)</strong>ã€‚
è¿™å°±å¥½æ¯”ç»™ä¸€æœ¬ä¹¦çš„æ¯ä¸€é¡µéƒ½åšäº†å…³é”®è¯ç´¢å¼•ã€‚
<strong>å†™æ³•å¾ˆç®€å•ï¼š</strong></p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> INDEX idx_payload <span class="hljs-keyword">ON</span> events <span class="hljs-keyword">USING</span> GIN (payload);
</code></pre>
<p>ä¸€æ—¦åŠ ä¸Šè¿™ä¸ªï¼Œåƒä¸‡çº§æ•°æ®çš„æŸ¥è¯¢ä¹Ÿèƒ½ç¬é—´ä» <strong>ç§’çº§</strong> æ‰åˆ° <strong>æ¯«ç§’çº§</strong> ã€‚</p>
<p><strong>3. å¿…åšåŠ¨ä½œï¼šEXPLAIN</strong>
ä¸Šçº¿å‰ï¼Œä¸€å®šè¦ç”¨ <code>EXPLAIN ANALYZE</code> è·‘ä¸€ä¸‹ã€‚å¦‚æœçœ‹åˆ° <code>Seq Scan</code>ï¼ˆå…¨è¡¨æ‰«æï¼‰ï¼Œè¯·ç«‹åˆ»å»é¢å£åçœï¼Œæ£€æŸ¥ä½ çš„ GIN ç´¢å¼•æ˜¯ä¸æ˜¯æ¼äº†æˆ–è€…æ“ä½œç¬¦ç”¨é”™äº† ã€‚</p>
<hr/>
<h2 data-id="heading-4">æ‹’ç»åƒåœ¾åœºï¼šåˆ«è®©JSONBæˆâ€œä¿¡æ¯å­¤å²›â€</h2>
<p>â€œèƒ½åŠ›è¶Šå¤§ï¼Œè´£ä»»è¶Šå¤§ã€‚â€
JSONB çš„çµæ´»æ€§å¦‚æœä¸åŠ çº¦æŸï¼Œä¸‰ä¸ªæœˆåä½ çš„æ•°æ®åº“å°±ä¼šå˜æˆåƒåœ¾åœºï¼šæ²¡äººçŸ¥é“ <code>attr1</code> åˆ°åº•å­˜çš„æ˜¯ "100" è¿˜æ˜¯ 100ã€‚</p>
<p><strong>è½åœ°æ²»ç†ä¸‰æ¿æ–§ï¼š</strong></p>
<ol>
<li><strong>æ›´æ–°è¦å…‹åˆ¶</strong>ï¼šå°½é‡ç”¨ <code>jsonb_set</code> åšå±€éƒ¨æ›´æ–°ï¼Œåˆ«æŠŠæ•´ä¸ªå¯¹è±¡è¦†ç›–äº†ï¼Œé˜²æ­¢å¹¶å‘å†²çªã€‚</li>
<li><strong>å­—å…¸è¦ç»´æŠ¤</strong>ï¼šå›¢é˜Ÿå†…éƒ¨å¿…é¡»ç»´æŠ¤ä¸€ä»½ <code>payload</code> å­—æ®µå­—å…¸ï¼ˆExcelæˆ–é£ä¹¦æ–‡æ¡£ï¼‰ï¼Œæ ‡æ˜ <code>payload.vip_level</code> æ˜¯å•¥æ„æ€ï¼Œç”±è°è´Ÿè´£ã€‚</li>
<li><strong>ç‰ˆæœ¬è¦æ§åˆ¶</strong>ï¼šåœ¨ JSON æ ¹èŠ‚ç‚¹åŠ ä¸€ä¸ª <code>version: "v1"</code>ï¼Œæ–¹ä¾¿åç»­æ¸…æ´—æ•°æ®æ—¶åšå…¼å®¹ ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-5">ç»“å°¾ï¼šæœ€å¥½çš„é‡æ„æ—¶æœºæ˜¯ç°åœ¨</h2>
<p>JSONB çš„ä»·å€¼ä¸åœ¨äºâ€œéšä¾¿å­˜â€ï¼Œè€Œåœ¨äº**â€œçµæ´»å­˜ï¼Œä½†ä¾ç„¶å¯ç´¢å¼•ã€å¯æ²»ç†â€**ã€‚
ä¸ç®¡ä½ æ˜¯åšç”µå•†å•†å“ä¸­å¿ƒï¼Œè¿˜æ˜¯å¤æ‚çš„SaaSé…ç½®ç³»ç»Ÿï¼Œåªè¦æ¶‰åŠé«˜é¢‘æŸ¥è¯¢çš„åŠç»“æ„åŒ–æ•°æ®ï¼Œè¯·æŠŠå·¥ç¨‹èµ„æºæŠ•åˆ° <strong>JSONB + GIN</strong> ä¸Š ã€‚</p>
<p><strong>ç»™æ‰€æœ‰æŠ€æœ¯äººçš„è¡ŒåŠ¨æ¸…å•ï¼š</strong></p>
<ol>
<li>æŒ‘ä¸€å¼ å­—æ®µå˜åŒ–æœ€é¢‘ç¹çš„è¡¨ï¼ˆæ¯”å¦‚ UserProfile æˆ– OrderExtraï¼‰ã€‚</li>
<li>æŠŠé•¿å°¾å­—æ®µè¿ç§»åˆ° JSONBï¼Œå¹¶åŠ ä¸Š GIN ç´¢å¼•ã€‚</li>
<li>è·‘ä¸€ä¸‹ <code>EXPLAIN</code>ï¼Œäº«å—æŸ¥è¯¢é€Ÿåº¦æå‡ 100 å€çš„å¿«æ„Ÿã€‚</li>
</ol>
<p><strong>æœ€åé—®ä¸€å¥ï¼š</strong>
ä½ ä»¬å…¬å¸çš„ä¸šåŠ¡è¡¨é‡Œï¼Œå“ªä¸€å¼ æœ€è®©ä½ å¤´å¤§ï¼Ÿè¯„è®ºåŒºæ™’å‡ºä½ çš„â€œæ…¢æŸ¥è¯¢â€SQLï¼Œä¸‹æœŸæˆ‘ä»¬ä¸“é—¨èŠèŠæ€ä¹ˆä¼˜åŒ–å®ƒï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[WebSocketåœ¨SpringBootä¸­çš„å®ç°ï¼šåŸç†ä¸æ¡ˆä¾‹]]></title>    <link>https://juejin.cn/post/7595808703074369562</link>    <guid>https://juejin.cn/post/7595808703074369562</guid>    <pubDate>2026-01-17T07:33:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595808703074369562" data-draft-id="7595847940621500466" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="WebSocketåœ¨SpringBootä¸­çš„å®ç°ï¼šåŸç†ä¸æ¡ˆä¾‹"/> <meta itemprop="keywords" content="åç«¯,Java,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-17T07:33:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Olaf_n"/> <meta itemprop="url" content="https://juejin.cn/user/1324234125087575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            WebSocketåœ¨SpringBootä¸­çš„å®ç°ï¼šåŸç†ä¸æ¡ˆä¾‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1324234125087575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Olaf_n
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T07:33:55.000Z" title="Sat Jan 17 2026 07:33:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»€ä¹ˆæ˜¯websocketï¼Ÿ</h2>
<p>WebSocket æ˜¯ä¸€ç§å…¨åŒå·¥çš„ä¸€ç§ç½‘ç»œé€šä¿¡åè®®ï¼Œè¿™ç§åè®®å¯ä»¥æ”¯æŒä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ¶ˆæ¯ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä¸»åŠ¨å‘æœåŠ¡å™¨å‘é€ä¿¡æ¯ï¼Œå±äºæœåŠ¡å™¨æ¨é€æŠ€æœ¯çš„ä¸€ç§
WebSocketåè®®æ˜¯å»ºç«‹åœ¨TCPåè®®ä¹‹ä¸Šçš„ï¼ŒåŒæ—¶WebSocketåè®®å’ŒHTTPåè®®å…¼å®¹æ€§æ¯”è¾ƒå¥½é»˜è®¤ç«¯å£80å’Œ443ï¼Œåœ¨æ¡æ‰‹é˜¶æ®µé‡‡ç”¨çš„æ˜¯Httpåè®®ã€‚
WebSocketçš„æ•°æ®æ ¼å¼æ¯”è¾ƒè½»é‡ï¼Œå¼€é”€ä¹Ÿæ¯”è¾ƒå°ï¼Œå¯ä»¥å‘é€æ–‡æœ¬ä¹Ÿå¯ä»¥å‘é€äºŒè¿›åˆ¶çš„æ•°æ®ï¼ˆblobå¯¹è±¡æˆ–ArraryBufferå¯¹è±¡ï¼‰
æ²¡æœ‰åŒæºç­–ç•¥çš„é™åˆ¶ï¼Œåè®®çš„æ ‡è¯†ç¬¦æ˜¯wsï¼Œå¦‚æœæ˜¯åŠ å¯†åçš„åè®®æ ‡è¯†ç¬¦åˆ™æ˜¯wss</p>
<h2 data-id="heading-1">ä¸ºä»€ä¹ˆè¦æœ‰websocketï¼Ÿ</h2>
<p><strong>å®æ—¶é€šä¿¡</strong>ï¼šä¼ ç»Ÿçš„ HTTP æ˜¯è¯·æ±‚-å“åº”æ¨¡å‹ï¼Œæ¯æ¬¡å®¢æˆ·ç«¯æƒ³è·å–æ•°æ®æ—¶ï¼Œéƒ½å¿…é¡»å‘èµ·è¯·æ±‚å¹¶ç­‰å¾…æœåŠ¡å™¨å“åº”ã€‚è€Œ WebSocket åè®®åœ¨å»ºç«‹è¿æ¥åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å¯ä»¥äº’ç›¸å‘é€æ•°æ®ï¼Œé€‚åˆå®æ—¶èŠå¤©ã€è‚¡ç¥¨è¡Œæƒ…ã€åœ¨çº¿æ¸¸æˆç­‰åº”ç”¨åœºæ™¯ã€‚</p>
<p><strong>å‡å°‘å»¶è¿Ÿ</strong>ï¼šç”±äº WebSocket è¿æ¥æ˜¯æŒä¹…çš„ï¼Œæ•°æ®å¯ä»¥åœ¨è¿æ¥å»ºç«‹åå³æ—¶åŒå‘ä¼ è¾“ï¼Œæ— éœ€æ¯æ¬¡è¯·æ±‚æ—¶é‡æ–°å»ºç«‹è¿æ¥ï¼Œé™ä½äº†é€šä¿¡çš„å»¶è¿Ÿã€‚</p>
<p><strong>å‡å°‘ç½‘ç»œå¼€é”€</strong>ï¼šWebSocket è¿æ¥åœ¨å»ºç«‹åï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½å‘é€ HTTP è¯·æ±‚çš„å¤´éƒ¨ä¿¡æ¯ï¼Œè¿™æ¯”ä¼ ç»Ÿçš„ HTTP è¯·æ±‚æ›´åŠ èŠ‚çœå¸¦å®½å’Œèµ„æº</p>
<h2 data-id="heading-2">ä¸ºä»€ä¹ˆä½¿ç”¨WebSocketï¼Ÿ</h2>
<p>Httpæ˜¯ä½ é—®æˆ‘ç­”ï¼ŒæœåŠ¡å™¨ä¸èƒ½ä¸»åŠ¨æ‰¾åˆ°å®¢æˆ·ç«¯ï¼Œhttpçš„æµç¨‹æ˜¯ ï¼Œå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ -&gt; æœåŠ¡å™¨å“åº” -&gt; æ–­å¼€è¿æ¥ï¼›æœåŠ¡å™¨ä¸å¯ä»¥ä¸»åŠ¨çš„æ¨é€æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ã€‚å¦‚æœä½ æƒ³çŸ¥é“æœ‰æ²¡æœ‰æ–°çš„æ¶ˆæ¯å°±åªèƒ½è¿›è¡Œè½®è¯¢æˆ–è€…é•¿è½®è¯¢ï¼›è¿™ä¸¤ç§æ–¹å¼å†æ¯”è¾ƒç®€å•çš„çš„åœºæ™¯ä¸‹å®Œå…¨å¯ä»¥ä½¿ç”¨ï¼Œè€Œä¸”è¿™ä¸¤ç§æ–¹å¼å®ç°èµ·æ¥ä¹Ÿæ˜¯æ¯”è¾ƒç®€å•ã€‚ä½†å¦‚æœæ˜¯ç½‘é¡µæ¸¸æˆå‘¢ï¼Œæ¸¸æˆä¸€èˆ¬ä¼šæœ‰å¤§é‡çš„æ•°æ®éœ€è¦ä»æœåŠ¡å™¨ä¸»åŠ¨æ¨é€åˆ°å®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯é«˜é¢‘è®¿é—®çš„åœºæ™¯ä¸‹ï¼Œè¿™ç§è½®è¯¢çš„å®ç°æˆæœ¬å°±æé«˜äº†ï¼Œè¿™æ—¶å°±éœ€è¦ç”¨çš„websocketäº†ã€‚
websocketå¯ä»¥ä¸»åŠ¨å¾€å®¢æˆ·ç«¯æ¨é€æ¶ˆæ¯ï¼Œä¸éœ€è¦å®¢æˆ·ç«¯æ¥è¯¢é—®ï¼Œè€Œä¸”websocketå»ºç«‹è¿æ¥ä»¥åæ˜¯å¯ä»¥é•¿æœŸä½¿ç”¨çš„ï¼Œé¿å…é¢‘ç¹çš„å»ºç«‹è¿æ¥é”€æ¯è¿æ¥ï¼ŒèŠ‚çœç½‘ç»œèµ„æºä¸Šçš„å¼€é”€ã€‚</p>
<h2 data-id="heading-3">ä»€ä¹ˆæ—¶å€™ç”¨Websocketï¼Ÿ</h2>
<p>æœåŠ¡å™¨è¦ä¸»åŠ¨é€šçŸ¥å®¢æˆ·ç«¯ä¾‹å¦‚ï¼šIMèŠå¤©ã€å¥½å‹ç”³è¯·/çº¢ç‚¹æé†’
æ¶ˆæ¯å‘é€çš„é¢‘ç‡éå¸¸é«˜ï¼šå®æ—¶æ—¥å¿—ã€é¡µæ¸¸ã€å®æ—¶ç›‘æ§é¢æ¿
åœ¨çº¿çŠ¶æ€ / ä¼šè¯å­˜åœ¨æ„Ÿå¾ˆé‡è¦ ï¼š åœ¨çº¿ç”¨æˆ·åˆ—è¡¨ ï¼Œ æ˜¯å¦åœ¨çº¿ç­‰åœºæ™¯</p>
<h2 data-id="heading-4">Websocketçš„è¿æ¥æ˜¯å¦‚ä½•å»ºç«‹ï¼Ÿ</h2>
<p>å¹³æ—¶æˆ‘ä»¬åˆ·ç½‘é¡µè¿™ä¸ªæ—¶å€™æˆ‘ä»¬ç”¨çš„æ˜¯Httpåè®®ï¼Œè®¿é—®é¡µæ¸¸çš„æ—¶å€™httpåè®®å°±å¾—åˆ‡æ¢æˆWebsocketã€‚
ä¸ºäº†è¦å…¼å®¹è¿™äº›åœºæ™¯ï¼Œæµè§ˆå™¨å†TCPä¸‰æ¬¡æ¡æ‰‹ä»¥åå»ºç«‹è¿æ¥ä»¥åï¼Œéƒ½ç»Ÿä¸€ä½¿ç”¨httpåè®®å…ˆè¿›è¡Œä¸€æ¬¡é€šä¿¡ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™æ˜¯æ™®é€šçš„httpè¯·æ±‚é‚£å°±ç»§ç»­ç”¨httpè¯·æ±‚ï¼Œå¦‚æœè¿™æ—¶æƒ³è¦å»ºç«‹Websocketè¿æ¥ï¼Œå°±ä¼šå†httpçš„è¯·æ±‚å¤´ä¸ŠåŠ ä¸Šä¸€äº›ç‰¹æ®Šçš„headerå¤´</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">Connection: Upgrade</span>
<span class="hljs-section">Upgrade: WebSocket</span>
<span class="hljs-section">Sec-WebSocket-Key: T2a6wZ1AwhgQNqruZ2YUyg==</span>
</code></pre>
<p>Connection: Upgrade æ˜¯æµè§ˆå™¨æƒ³è¦å‡çº§åè®®</p>
<p>Upgrade: WebSocket è¡¨ç¤ºæƒ³è¦å‡çº§çš„åè®®ç±»å‹ï¼Œè¯æ˜æµè§ˆå™¨æƒ³è¦å‡çº§æˆWebSocket</p>
<p>Sec-WebSocket-Key ä¸€æ®µéšæœºBase64ç </p>
<p>å¦‚æœæœåŠ¡å™¨æ”¯æŒå‡çº§æˆWebSocketåè®®çš„è¯ï¼Œå°±ä¼šèµ°WebSocketçš„æ¡æ‰‹æµç¨‹ï¼ŒåŒæ—¶æ ¹æ®å®¢æˆ·ç«¯ç”Ÿæˆçš„Base64ç ï¼Œç”¨æŸä¸ªå…¬å¼€çš„ç®—æ³•å˜æˆå¦å¤–ä¸€æ®µå­—ç¬¦ä¸²ï¼Œæ”¾åœ¨Httpçš„å“åº”å¤´é‡Œé¢ï¼ŒåŒæ—¶çŠ¶æ€æºå¸¦ä¸Š101çŠ¶æ€ç ï¼Œå‘å›ç»™æµè§ˆå™¨</p>
<pre><code class="hljs language-makefile" lang="makefile">HTTP/1.1 101 Switching Protocols
<span class="hljs-section">Sec-WebSocket-Accept: iBJkv/ALIW2DobfoA4dmr3JHBCY=</span>
<span class="hljs-section">Upgrade: WebSocket</span>
<span class="hljs-section">Connection: Upgrade</span>
</code></pre>
<p>æœåŠ¡å™¨ç«¯ base64 -ã€‹ æŸä¸ªå‡½æ•°/ç®—æ³• -ã€‹æœåŠ¡å™¨æ–°å­—ç¬¦ä¸²ã€‚</p>
<p>ä¹‹åå®¢æˆ·ç«¯ä¹Ÿä¼šæŠŠ base64 -ã€‹ æŸä¸ªå‡½æ•°/ç®—æ³• -ã€‹å®¢æˆ·ç«¯æ–°å­—ç¬¦ä¸²ã€‚</p>
<p>è‹¥æ˜¯æœåŠ¡å™¨æ–°å­—ç¬¦ä¸²å’Œå®¢æˆ·ç«¯æ–°å­—ç¬¦ä¸²ç›¸ç­‰ï¼Œè¯æ˜è¿æ¥å·²ç»å®Œæˆäº†ï¼Œåç»­å°±å¯ä»¥ä½¿ç”¨websocketçš„æ•°æ®æ ¼å¼æ¥è¿›è¡Œé€šä¿¡äº†ã€‚</p>
<h2 data-id="heading-5">åç«¯å®ç°WebSocket</h2>
<h3 data-id="heading-6">æ–°å»ºç«‹websocketæœåŠ¡</h3>
<h4 data-id="heading-7">pom ä¾èµ–åŒ…</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-websocket<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.hutool<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hutool-all<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.8.24<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h4 data-id="heading-8">ymlé…ç½®</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment">#æœåŠ¡å™¨é…ç½®</span>
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8081</span>
  <span class="hljs-attr">servlet:</span>
    <span class="hljs-attr">context-path:</span> <span class="hljs-string">/api</span>
</code></pre>
<h4 data-id="heading-9">websocketé…ç½®ç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebsocketConfig</span> {
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> ServerEndpointExporter <span class="hljs-title function_">serverEndpointExporter</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerEndpointExporter</span>();
    }
}
</code></pre>
<p>WebSocketæ³¨å†Œç‚¹</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@ServerEndpoint(value = "/websocket/{userId}")</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocket</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ConcurrentHashMap&lt;String, WebSocket&gt; webSocketMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
    <span class="hljs-comment">//å®ä¾‹ä¸€ä¸ªsessionï¼Œè¿™ä¸ªsessionæ˜¯websocketçš„session</span>
    <span class="hljs-keyword">private</span> Session session;

    <span class="hljs-comment">//æ–°å¢ä¸€ä¸ªæ–¹æ³•ç”¨äºä¸»åŠ¨å‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendMessage</span><span class="hljs-params">(Object message, String userId)</span> {
        <span class="hljs-type">WebSocket</span> <span class="hljs-variable">webSocket</span> <span class="hljs-operator">=</span> webSocketMap.get(userId);
        <span class="hljs-keyword">if</span> (webSocket != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">try</span> {
                webSocket.session.getBasicRemote().sendText(JSONUtil.toJsonStr(message));
                System.out.println(<span class="hljs-string">"ã€websocketæ¶ˆæ¯ã€‘å‘é€æ¶ˆæ¯æˆåŠŸ,ç”¨æˆ·="</span>+userId+<span class="hljs-string">",æ¶ˆæ¯å†…å®¹"</span>+message.toString());
            } <span class="hljs-keyword">catch</span> (IOException e) {
                e.printStackTrace();
            }
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ConcurrentHashMap&lt;String, WebSocket&gt; <span class="hljs-title function_">getWebSocketMap</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> webSocketMap;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setWebSocketMap</span><span class="hljs-params">(ConcurrentHashMap&lt;String, WebSocket&gt; webSocketMap)</span> {
        WebSocket.webSocketMap = webSocketMap;
    }

    <span class="hljs-comment">//å‰ç«¯è¯·æ±‚æ—¶ä¸€ä¸ªwebsocketæ—¶</span>
    <span class="hljs-meta">@OnOpen</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onOpen</span><span class="hljs-params">(Session session, <span class="hljs-meta">@PathParam("userId")</span> String userId)</span> {
        <span class="hljs-built_in">this</span>.session = session;
        webSocketMap.put(userId, <span class="hljs-built_in">this</span>);
        sendMessage(<span class="hljs-string">"CONNECT_SUCCESS"</span>, userId);
        System.out.println(<span class="hljs-string">"ã€websocketæ¶ˆæ¯ã€‘æœ‰æ–°çš„è¿æ¥,è¿æ¥id"</span>+userId);
    }

    <span class="hljs-comment">//å‰ç«¯å…³é—­æ—¶ä¸€ä¸ªwebsocketæ—¶</span>
    <span class="hljs-meta">@OnClose</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClose</span><span class="hljs-params">(<span class="hljs-meta">@PathParam("userId")</span> String userId)</span> {
        webSocketMap.remove(userId);
        System.out.println(<span class="hljs-string">"ã€websocketæ¶ˆæ¯ã€‘è¿æ¥æ–­å¼€,æ€»æ•°:"</span>+ webSocketMap.size());
    }

    <span class="hljs-comment">//å‰ç«¯å‘åç«¯å‘é€æ¶ˆæ¯</span>
    <span class="hljs-meta">@OnMessage</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(String message)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-keyword">if</span> (!message.equals(<span class="hljs-string">"ping"</span>)) {
            System.out.println(<span class="hljs-string">"ã€websocketæ¶ˆæ¯ã€‘æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥çš„æ¶ˆæ¯:"</span>+message);
            session.getBasicRemote().sendText(<span class="hljs-string">"æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥çš„æ¶ˆæ¯äº†,æ¶ˆæ¯å†…å®¹ä¸º:"</span>+message);
        }
    }
}
</code></pre>
<p>@ServerEndpoint å£°æ˜ä¸€ä¸ªWebsocketçš„æœåŠ¡ç‚¹</p>
<p>@OnOpen å‰ç«¯è¿æ¥åˆ°åå°çš„WebSocket</p>
<p>@OnClose å‰ç«¯å…³é—­ä¸€ä¸ªè¿æ¥</p>
<p>@OnMessage å‰ç«¯å‘åç«¯å‘é€æ¶ˆæ¯</p>
<h4 data-id="heading-10">å¯åŠ¨ç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketMain</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        SpringApplication.run(WebSocketMain.class, args);
    }
}
</code></pre>
<h4 data-id="heading-11">å‰ç«¯æµ‹è¯•é¡µé¢ä»£ç </h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"IE=edge"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>æœ¬åœ°websocketæµ‹è¯•<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"robots"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"all"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"keywords"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"æœ¬åœ°,websocket,æµ‹è¯•å·¥å…·"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"description"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"æœ¬åœ°,websocket,æµ‹è¯•å·¥å…·"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
      <span class="hljs-selector-class">.btn-group</span>{
        <span class="hljs-attribute">display</span>: inline-block;
      }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">'text'</span> <span class="hljs-attr">value</span>=<span class="hljs-string">'é€šä¿¡åœ°å€, ws://å¼€å¤´..'</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">'width:390px;display:inline'</span>
      <span class="hljs-attr">id</span>=<span class="hljs-string">'wsaddr'</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn-group"</span> &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-default"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">'addsocket();'</span>&gt;</span>è¿æ¥<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-default"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">'closesocket();'</span>&gt;</span>æ–­å¼€<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-default"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">'$("#wsaddr").val("")'</span>&gt;</span>æ¸…ç©º<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"row"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"output"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"border:1px solid #ccc;height:365px;overflow: auto;margin: 20px 0;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'message'</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-control"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">'width:810px'</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"å¾…å‘ä¿¡æ¯"</span> <span class="hljs-attr">onkeydown</span>=<span class="hljs-string">"en(event);"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input-group-btn"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-default"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"doSend();"</span>&gt;</span>å‘é€<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>		

  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://code.jquery.com/jquery-3.1.1.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">"javascript"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">formatDate</span>(<span class="hljs-params">now</span>) {
      <span class="hljs-keyword">var</span> year = now.<span class="hljs-title function_">getFullYear</span>();
      <span class="hljs-keyword">var</span> month = now.<span class="hljs-title function_">getMonth</span>() + <span class="hljs-number">1</span>;
      <span class="hljs-keyword">var</span> date = now.<span class="hljs-title function_">getDate</span>();
      <span class="hljs-keyword">var</span> hour = now.<span class="hljs-title function_">getHours</span>();
      <span class="hljs-keyword">var</span> minute = now.<span class="hljs-title function_">getMinutes</span>();
      <span class="hljs-keyword">var</span> second = now.<span class="hljs-title function_">getSeconds</span>();
      <span class="hljs-keyword">return</span> year + <span class="hljs-string">"-"</span> + (month = month &lt; <span class="hljs-number">10</span> ? (<span class="hljs-string">"0"</span> + month) : month) + <span class="hljs-string">"-"</span> + (date = date &lt; <span class="hljs-number">10</span> ? (<span class="hljs-string">"0"</span> + date) : date) +
        <span class="hljs-string">" "</span> + (hour = hour &lt; <span class="hljs-number">10</span> ? (<span class="hljs-string">"0"</span> + hour) : hour) + <span class="hljs-string">":"</span> + (minute = minute &lt; <span class="hljs-number">10</span> ? (<span class="hljs-string">"0"</span> + minute) : minute) + <span class="hljs-string">":"</span> + (
          second = second &lt; <span class="hljs-number">10</span> ? (<span class="hljs-string">"0"</span> + second) : second);
    }
    <span class="hljs-keyword">var</span> output;
    <span class="hljs-keyword">var</span> websocket;

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
      output = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"output"</span>);
      <span class="hljs-title function_">testWebSocket</span>();
    }

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">addsocket</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">var</span> wsaddr = $(<span class="hljs-string">"#wsaddr"</span>).<span class="hljs-title function_">val</span>();
      <span class="hljs-keyword">if</span> (wsaddr == <span class="hljs-string">''</span>) {
        <span class="hljs-title function_">alert</span>(<span class="hljs-string">"è¯·å¡«å†™websocketçš„åœ°å€"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }
      <span class="hljs-title class_">StartWebSocket</span>(wsaddr);
    }

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">closesocket</span>(<span class="hljs-params"/>) {
      websocket.<span class="hljs-title function_">close</span>();
    }

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">StartWebSocket</span>(<span class="hljs-params">wsUri</span>) {
      websocket = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(wsUri);
      websocket.<span class="hljs-property">onopen</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) {
        <span class="hljs-title function_">onOpen</span>(evt)
      };
      websocket.<span class="hljs-property">onclose</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) {
        <span class="hljs-title function_">onClose</span>(evt)
      };
      websocket.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) {
        <span class="hljs-title function_">onMessage</span>(evt)
      };
      websocket.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">evt</span>) {
        <span class="hljs-title function_">onError</span>(evt)
      };
    }

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">onOpen</span>(<span class="hljs-params">evt</span>) {
      <span class="hljs-title function_">writeToScreen</span>(<span class="hljs-string">"&lt;span style='color:red'&gt;è¿æ¥æˆåŠŸï¼Œç°åœ¨ä½ å¯ä»¥å‘é€ä¿¡æ¯å•¦ï¼ï¼ï¼&lt;/span&gt;"</span>);
    }

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">onClose</span>(<span class="hljs-params">evt</span>) {
      <span class="hljs-title function_">writeToScreen</span>(<span class="hljs-string">"&lt;span style='color:red'&gt;websocketè¿æ¥å·²æ–­å¼€!!!&lt;/span&gt;"</span>);
      websocket.<span class="hljs-title function_">close</span>();
    }

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">onMessage</span>(<span class="hljs-params">evt</span>) {
      <span class="hljs-title function_">writeToScreen</span>(<span class="hljs-string">'&lt;span style="color:blue"&gt;æœåŠ¡ç«¯å›åº”&amp;nbsp;'</span> + <span class="hljs-title function_">formatDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()) + <span class="hljs-string">'&lt;/span&gt;&lt;br/&gt;&lt;span class="bubble"&gt;'</span> +
                    evt.<span class="hljs-property">data</span> + <span class="hljs-string">'&lt;/span&gt;'</span>);
			}
 
			<span class="hljs-keyword">function</span> <span class="hljs-title function_">onError</span>(<span class="hljs-params">evt</span>) {
				<span class="hljs-title function_">writeToScreen</span>(<span class="hljs-string">'&lt;span style="color: red;"&gt;å‘ç”Ÿé”™è¯¯:&lt;/span&gt; '</span> + evt.<span class="hljs-property">data</span>);
			}
 
			<span class="hljs-keyword">function</span> <span class="hljs-title function_">doSend</span>(<span class="hljs-params"/>) {
				<span class="hljs-keyword">var</span> message = $(<span class="hljs-string">"#message"</span>).<span class="hljs-title function_">val</span>();
				<span class="hljs-keyword">if</span> (message == <span class="hljs-string">''</span>) {
					<span class="hljs-title function_">alert</span>(<span class="hljs-string">"è¯·å…ˆå¡«å†™å‘é€ä¿¡æ¯"</span>);
					$(<span class="hljs-string">"#message"</span>).<span class="hljs-title function_">focus</span>();
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}
				<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> websocket === <span class="hljs-string">"undefined"</span>) {
					<span class="hljs-title function_">alert</span>(<span class="hljs-string">"websocketè¿˜æ²¡æœ‰è¿æ¥ï¼Œæˆ–è€…è¿æ¥å¤±è´¥ï¼Œè¯·æ£€æµ‹"</span>);
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}
				<span class="hljs-keyword">if</span> (websocket.<span class="hljs-property">readyState</span> == <span class="hljs-number">3</span>) {
					<span class="hljs-title function_">alert</span>(<span class="hljs-string">"websocketå·²ç»å…³é—­ï¼Œè¯·é‡æ–°è¿æ¥"</span>);
					<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
				}
				<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(websocket);
				$(<span class="hljs-string">"#message"</span>).<span class="hljs-title function_">val</span>(<span class="hljs-string">''</span>);
				<span class="hljs-title function_">writeToScreen</span>(<span class="hljs-string">'&lt;span style="color:green"&gt;ä½ å‘é€çš„ä¿¡æ¯&amp;nbsp;'</span> + <span class="hljs-title function_">formatDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()) + <span class="hljs-string">'&lt;/span&gt;&lt;br/&gt;'</span> + message);
				websocket.<span class="hljs-title function_">send</span>(message);
			}
 
			<span class="hljs-keyword">function</span> <span class="hljs-title function_">writeToScreen</span>(<span class="hljs-params">message</span>) {
				<span class="hljs-keyword">var</span> div = <span class="hljs-string">"&lt;div class='newmessage'&gt;"</span> + message + <span class="hljs-string">"&lt;/div&gt;"</span>;
				<span class="hljs-keyword">var</span> d = $(<span class="hljs-string">"#output"</span>);
				<span class="hljs-keyword">var</span> d = d[<span class="hljs-number">0</span>];
				<span class="hljs-keyword">var</span> doScroll = d.<span class="hljs-property">scrollTop</span> == d.<span class="hljs-property">scrollHeight</span> - d.<span class="hljs-property">clientHeight</span>;
				$(<span class="hljs-string">"#output"</span>).<span class="hljs-title function_">append</span>(div);
				<span class="hljs-keyword">if</span> (doScroll) {
					d.<span class="hljs-property">scrollTop</span> = d.<span class="hljs-property">scrollHeight</span> - d.<span class="hljs-property">clientHeight</span>;
				}
			}
 
 
			<span class="hljs-keyword">function</span> <span class="hljs-title function_">en</span>(<span class="hljs-params">event</span>) {
				<span class="hljs-keyword">var</span> evt = evt ? evt : (<span class="hljs-variable language_">window</span>.<span class="hljs-property">event</span> ? <span class="hljs-variable language_">window</span>.<span class="hljs-property">event</span> : <span class="hljs-literal">null</span>);
				<span class="hljs-keyword">if</span> (evt.<span class="hljs-property">keyCode</span> == <span class="hljs-number">13</span>) {
					<span class="hljs-title function_">doSend</span>()
				}
			}
		</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
 
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>å‰ç«¯æµ‹è¯•ç½‘ç«™ <a href="https://link.juejin.cn?target=http%3A%2F%2Fcoolaf.com%2Ftool%2Fchattest" target="_blank" title="http://coolaf.com/tool/chattest" ref="nofollow noopener noreferrer">åœ¨çº¿websocketæµ‹è¯•-åœ¨çº¿å·¥å…·-postjson</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[iOSå¼€å‘APPä¸Šæ¶å…¨æµç¨‹è§£æï¼šä»å¼€å‘åˆ°App Storeçš„å®Œæ•´æŒ‡å—]]></title>    <link>https://juejin.cn/post/7595868336595435539</link>    <guid>https://juejin.cn/post/7595868336595435539</guid>    <pubDate>2026-01-17T09:52:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595868336595435539" data-draft-id="7595994039108436004" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="iOSå¼€å‘APPä¸Šæ¶å…¨æµç¨‹è§£æï¼šä»å¼€å‘åˆ°App Storeçš„å®Œæ•´æŒ‡å—"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-17T09:52:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¼€å¿ƒå°±å¥½2025"/> <meta itemprop="url" content="https://juejin.cn/user/3850962908492660"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            iOSå¼€å‘APPä¸Šæ¶å…¨æµç¨‹è§£æï¼šä»å¼€å‘åˆ°App Storeçš„å®Œæ•´æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3850962908492660/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¼€å¿ƒå°±å¥½2025
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T09:52:25.000Z" title="Sat Jan 17 2026 09:52:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>iOSå¼€å‘APPä¸Šæ¶å…¨æµç¨‹è§£æï¼šä»å¼€å‘åˆ°App Storeçš„å®Œæ•´æŒ‡å—</p>
<p>åœ¨ç§»åŠ¨äº’è”ç½‘æ—¶ä»£ï¼ŒiOSåº”ç”¨å¼€å‘å·²æˆä¸ºè®¸å¤šä¼ä¸šå’Œå¼€å‘è€…çš„é‡è¦ä¸šåŠ¡æ–¹å‘ã€‚ç„¶è€Œï¼Œè®¸å¤šæ–°æ‰‹å¼€å‘è€…å¸¸å¸¸å›°æƒ‘äºå¦‚ä½•å°†è‡ªå·±çš„åº”ç”¨æˆåŠŸä¸Šæ¶åˆ°App Storeã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»iOSå¼€å‘APPçš„å®Œæ•´ä¸Šæ¶æµç¨‹ï¼Œå¸®åŠ©æ‚¨è§„é¿å¸¸è§é—®é¢˜ï¼Œæé«˜ä¸Šæ¶æˆåŠŸç‡ã€‚</p>
<p>ä¸€ã€å‰æœŸå‡†å¤‡å·¥ä½œ</p>
<ol>
<li><strong>å¼€å‘è€…è´¦å·æ³¨å†Œ</strong></li>
</ol>
<p>é¦–å…ˆéœ€è¦æ³¨å†ŒAppleå¼€å‘è€…è´¦å·ï¼ˆä¸ªäººè´¦å·99ç¾å…ƒ/å¹´ï¼Œä¼ä¸šè´¦å·299ç¾å…ƒ/å¹´ï¼‰ã€‚è¿™æ˜¯ä¸Šæ¶App Storeçš„å‰ææ¡ä»¶ï¼Œæ³¨å†Œè¿‡ç¨‹å¯èƒ½éœ€è¦1-2ä¸ªå·¥ä½œæ—¥å®Œæˆå®¡æ ¸ã€‚</p>
<ol start="2">
<li><strong>åº”ç”¨ä¿¡æ¯è§„åˆ’</strong></li>
</ol>
<p>ç¡®å®šåº”ç”¨çš„åç§°ã€å›¾æ ‡ã€åŠŸèƒ½ä»‹ç»ã€å…³é”®è¯ç­‰å…ƒæ•°æ®ï¼Œè¿™äº›ä¿¡æ¯å°†ç›´æ¥å½±å“ç”¨æˆ·åœ¨App Storeä¸­æœç´¢åˆ°æ‚¨çš„åº”ç”¨çš„å¯èƒ½æ€§ã€‚</p>
<ol start="3">
<li><strong>å¼€å‘ç¯å¢ƒæ­å»º</strong></li>
</ol>
<p>ç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„Xcodeå¼€å‘å·¥å…·ï¼Œå¹¶ç†Ÿæ‚‰iOSå¼€å‘ç›¸å…³è§„èŒƒå’Œè¦æ±‚ã€‚</p>
<p>äºŒã€å¼€å‘é˜¶æ®µæ³¨æ„äº‹é¡¹</p>
<ol>
<li><strong>éµå¾ªè‹¹æœè®¾è®¡æŒ‡å—</strong></li>
</ol>
<p>ä¸¥æ ¼æŒ‰ç…§ã€ŠHuman Interface Guidelinesã€‹è¿›è¡ŒUIè®¾è®¡ï¼Œé¿å…å› ç•Œé¢é—®é¢˜è¢«æ‹’ã€‚</p>
<ol start="2">
<li><strong>åŠŸèƒ½å®Œæ•´æ€§æ£€æŸ¥</strong></li>
</ol>
<p>ç¡®ä¿åº”ç”¨æ²¡æœ‰æ˜æ˜¾bugï¼Œæ‰€æœ‰åŠŸèƒ½éƒ½èƒ½æ­£å¸¸è¿è¡Œï¼Œç‰¹åˆ«æ˜¯æ”¯ä»˜ã€ç™»å½•ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚</p>
<ol start="3">
<li><strong>éšç§æ”¿ç­–å‡†å¤‡</strong></li>
</ol>
<p>æ‰€æœ‰æ”¶é›†ç”¨æˆ·æ•°æ®çš„åº”ç”¨éƒ½å¿…é¡»æä¾›éšç§æ”¿ç­–é“¾æ¥ï¼Œè¿™æ˜¯è‹¹æœå®¡æ ¸çš„é‡ç‚¹é¡¹ç›®ã€‚</p>
<p>ä¸‰ã€ä¸Šæ¶å‰æµ‹è¯•ä¸ä¼˜åŒ–</p>
<ol>
<li><strong>TestFlightæµ‹è¯•</strong></li>
</ol>
<p>é€šè¿‡TestFlightè¿›è¡Œå†…éƒ¨æµ‹è¯•å’Œå¤–éƒ¨æµ‹è¯•ï¼Œæ”¶é›†ç”¨æˆ·åé¦ˆå¹¶ä¿®å¤é—®é¢˜ã€‚</p>
<ol start="2">
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong></li>
</ol>
<p>å…³æ³¨åº”ç”¨å¯åŠ¨æ—¶é—´ã€å†…å­˜å ç”¨ç­‰æ€§èƒ½æŒ‡æ ‡ï¼Œé¿å…å› æ€§èƒ½é—®é¢˜è¢«æ‹’ã€‚</p>
<ol start="3">
<li><strong>æˆªå›¾ä¸é¢„è§ˆè§†é¢‘</strong></li>
</ol>
<p>å‡†å¤‡é«˜è´¨é‡çš„App Storeå±•ç¤ºç´ æï¼Œè¿™æ˜¯å¸å¼•ç”¨æˆ·ä¸‹è½½çš„é‡è¦å› ç´ ã€‚</p>
<p>å››ã€æ­£å¼ä¸Šæ¶æµç¨‹</p>
<ol>
<li><strong>åˆ›å»ºApp Store Connectè®°å½•</strong></li>
</ol>
<p>åœ¨å¼€å‘è€…åå°åˆ›å»ºæ–°åº”ç”¨ï¼Œå¡«å†™å®Œæ•´å…ƒæ•°æ®ã€‚</p>
<ol start="2">
<li><strong>æ„å»ºç‰ˆæœ¬ä¸Šä¼ </strong></li>
</ol>
<p>é€šè¿‡Xcodeæˆ–Application Loaderä¸Šä¼ æ„å»ºç‰ˆæœ¬ã€‚æ­¤å¤–ï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨AppUploaderå·¥å…·åœ¨Windowsã€Linuxæˆ–Macç³»ç»Ÿä¸­ä¸Šä¼ IPAæ–‡ä»¶åˆ°App Storeï¼Œæ— éœ€Macç”µè„‘ï¼ŒåŒæ—¶æ”¯æŒiOSè¯ä¹¦ç”³è¯·å’Œæè¿°æ–‡ä»¶ç®¡ç†ï¼Œç®€åŒ–ä¸Šæ¶æµç¨‹ã€‚</p>
<ol start="3">
<li><strong>æäº¤å®¡æ ¸</strong></li>
</ol>
<p>å¡«å†™å®¡æ ¸é—®å·ï¼Œè¯´æ˜åº”ç”¨åŠŸèƒ½ã€ä½¿ç”¨åœºæ™¯ç­‰å…³é”®ä¿¡æ¯ã€‚</p>
<ol start="4">
<li><strong>ç­‰å¾…å®¡æ ¸</strong></li>
</ol>
<p>é€šå¸¸éœ€è¦1-3ä¸ªå·¥ä½œæ—¥ï¼Œé«˜å³°æœŸå¯èƒ½å»¶é•¿ã€‚</p>
<p>äº”ã€å¸¸è§è¢«æ‹’åŸå› åŠè§£å†³æ–¹æ¡ˆ</p>
<ol>
<li><strong>åŠŸèƒ½ä¸å®Œæ•´</strong></li>
</ol>
<p>ç¡®ä¿æ¼”ç¤ºè´¦å·å¯ç”¨ï¼Œæ‰€æœ‰åŠŸèƒ½éƒ½å¯æµ‹è¯•ã€‚</p>
<ol start="2">
<li><strong>è®¾è®¡ä¸ç¬¦åˆè§„èŒƒ</strong></li>
</ol>
<p>éµå¾ªè‹¹æœè®¾è®¡æŒ‡å—ï¼Œé¿å…ä½¿ç”¨ç±»ä¼¼ç³»ç»Ÿå›¾æ ‡ç­‰å…ƒç´ ã€‚</p>
<ol start="3">
<li><strong>éšç§æ”¿ç­–é—®é¢˜</strong></li>
</ol>
<p>æ˜ç¡®è¯´æ˜æ•°æ®æ”¶é›†èŒƒå›´å’Œä½¿ç”¨æ–¹å¼ã€‚</p>
<ol start="4">
<li><strong>æ”¯ä»˜é—®é¢˜</strong></li>
</ol>
<p>è™šæ‹Ÿå•†å“å¿…é¡»ä½¿ç”¨IAPæ”¯ä»˜ï¼Œå®ç‰©å•†å“å¯ä½¿ç”¨ç¬¬ä¸‰æ–¹æ”¯ä»˜ã€‚</p>
<p>å…­ã€ä¸Šæ¶åç»´æŠ¤</p>
<ol>
<li><strong>åŠæ—¶æ›´æ–°ç‰ˆæœ¬</strong></li>
</ol>
<p>æ ¹æ®ç”¨æˆ·åé¦ˆå’Œå¸‚åœºéœ€æ±‚å®šæœŸæ›´æ–°åº”ç”¨ã€‚</p>
<ol start="2">
<li><strong>ç›‘æ§å®¡æ ¸çŠ¶æ€</strong></li>
</ol>
<p>å…³æ³¨å¯èƒ½çš„å®¡æ ¸å»¶è¿Ÿæˆ–è¢«æ‹’æƒ…å†µã€‚</p>
<ol start="3">
<li><strong>ä¼˜åŒ–åº”ç”¨å•†åº—æ’å</strong></li>
</ol>
<p>é€šè¿‡ASOä¼˜åŒ–æå‡åº”ç”¨åœ¨æœç´¢ç»“æœä¸­çš„æ’åã€‚</p>
<p>iOSåº”ç”¨ä¸Šæ¶æ˜¯ä¸€ä¸ªç³»ç»Ÿå·¥ç¨‹ï¼Œéœ€è¦å¼€å‘è€…å…·å¤‡æŠ€æœ¯èƒ½åŠ›ã€è®¾è®¡æ€ç»´å’Œå¸‚åœºæ„è¯†ã€‚å¯¹äºæ²¡æœ‰ç»éªŒçš„å¼€å‘è€…æˆ–ä¼ä¸šæ¥è¯´ï¼Œæ•´ä¸ªæµç¨‹å¯èƒ½ä¼šé‡åˆ°å„ç§æ„æƒ³ä¸åˆ°çš„æŒ‘æˆ˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨ä¼ä¸šå¾®ä¿¡çš„æ¶ˆæ¯æ¨é€æ¥å‘é€å‘Šè­¦]]></title>    <link>https://juejin.cn/post/7595831738234486793</link>    <guid>https://juejin.cn/post/7595831738234486793</guid>    <pubDate>2026-01-17T07:49:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595831738234486793" data-draft-id="7595831738234470409" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨ä¼ä¸šå¾®ä¿¡çš„æ¶ˆæ¯æ¨é€æ¥å‘é€å‘Šè­¦"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-17T07:49:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä½•è¾¾ç»´"/> <meta itemprop="url" content="https://juejin.cn/user/4206083706979930"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨ä¼ä¸šå¾®ä¿¡çš„æ¶ˆæ¯æ¨é€æ¥å‘é€å‘Šè­¦
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4206083706979930/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä½•è¾¾ç»´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T07:49:28.000Z" title="Sat Jan 17 2026 07:49:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä½¿ç”¨ä¼ä¸šå¾®ä¿¡çš„æ¶ˆæ¯æ¨é€æ¥å‘é€å‘Šè­¦</h2>
<p>å®ç° Prometheus çš„ Alertmanager ä¸ä¼ä¸šå¾®ä¿¡é›†æˆï¼Œè®© Prometheus è§¦å‘çš„å‘Šè­¦èƒ½å¤Ÿè‡ªåŠ¨æ¨é€åˆ°ä¼ä¸šå¾®ä¿¡çš„ç¾¤èŠ/æœºå™¨äººä¸­ã€‚</p>
<p>å…ˆåˆ›å»ºä¼ä¸šå¾®ä¿¡æœºå™¨äººï¼Œå¤åˆ¶æœºå™¨äººçš„ Webhook URLï¼ˆæ ¼å¼ç±»ä¼¼ï¼š<code>https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxxx-xxxx-xxxxx-xxxx-xxxx</code>ï¼‰ï¼ŒæŠŠæœºå™¨äººæ‹‰å…¥ç¾¤èŠã€‚</p>
<p>å‡è®¾ä¼ä¸šå¾®ä¿¡çš„æ¶ˆæ¯æ¨é€ webhook æ˜¯ <code>https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxxx-xxxx-xxxxx-xxxx-xxxx</code>ï¼Œå¯¹è¯¥åœ°å€å‘èµ· HTTP POST è¯·æ±‚ï¼Œå³å¯å®ç°ç»™è¯¥ç¾¤ç»„å‘é€æ¶ˆæ¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">
curl <span class="hljs-string">'https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxxx-xxxx-xxxxx-xxxx-xxxx'</span> \

Â  Â -H <span class="hljs-string">'Content-Type: application/json'</span> \

Â  Â -d <span class="hljs-string">'

Â  Â {

Â  Â  Â  "msgtype": "text",

Â  Â  Â  "text": {

Â  Â  Â  Â  Â  "content": "hello world"

Â  Â  Â  }

Â  Â }'</span>

</code></pre>
<ul>
<li><code>msgtype</code>ï¼šå¿…é¡»å­—æ®µï¼Œä¸­è½¬ç«¯ç‚¹å¿…é¡»ç”Ÿæˆè¯¥å­—æ®µä»¥é€‚é…ï¼Œå¦åˆ™æ— æ³•æ¨é€ï¼Œå¸¸ç”¨çš„ä¸¤ç§ç±»å‹ï¼š</li>
</ul>
<p>Â  - <code>text</code>ï¼šæ–‡æœ¬ç±»å‹ã€‚</p>
<pre><code class="hljs language-json" lang="json">
<span class="hljs-punctuation">{</span>

    <span class="hljs-attr">"msgtype"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"text"</span><span class="hljs-punctuation">,</span>

    <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>

        <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å¹¿å·ä»Šæ—¥å¤©æ°”ï¼š29åº¦ï¼Œå¤§éƒ¨åˆ†å¤šäº‘ï¼Œé™é›¨æ¦‚ç‡ï¼š60%"</span><span class="hljs-punctuation">,</span>

    <span class="hljs-attr">"mentioned_list"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-string">"wangqing"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"@all"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>

    <span class="hljs-attr">"mentioned_mobile_list"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><span class="hljs-string">"13800001111"</span><span class="hljs-punctuation">,</span><span class="hljs-string">"@all"</span><span class="hljs-punctuation">]</span>

    <span class="hljs-punctuation">}</span>

<span class="hljs-punctuation">}</span>

</code></pre>
<p>Â  - <code>markdown</code>ï¼šmarkdown ç±»å‹ã€‚</p>
<pre><code class="hljs language-json" lang="json">
<span class="hljs-punctuation">{</span>

    <span class="hljs-attr">"msgtype"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"markdown"</span><span class="hljs-punctuation">,</span>

    <span class="hljs-attr">"markdown"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>

        <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å®æ—¶æ–°å¢ç”¨æˆ·åé¦ˆ&lt;font color=\"warning\"&gt;132ä¾‹&lt;/font&gt;ï¼Œè¯·ç›¸å…³åŒäº‹æ³¨æ„ã€‚\n&gt;ç±»å‹:&lt;font color=\"comment\"&gt;ç”¨æˆ·åé¦ˆ&lt;/font&gt;\n&gt;æ™®é€šç”¨æˆ·åé¦ˆ:&lt;font color=\"comment\"&gt;117ä¾‹&lt;/font&gt;\n&gt;VIPç”¨æˆ·åé¦ˆ:&lt;font color=\"comment\"&gt;15ä¾‹&lt;/font&gt;"</span>

    <span class="hljs-punctuation">}</span>

<span class="hljs-punctuation">}</span>

</code></pre>
<p>å…ˆæ‰‹åŠ¨æµ‹è¯• <code>markdown</code> ç±»å‹çš„æ¶ˆæ¯ï¼Œçœ‹ä¼ä¸šå¾®ä¿¡æ˜¯å¦èƒ½æ­£å¸¸æ”¶åˆ°æ¶ˆæ¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">
curl <span class="hljs-string">'https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxxx-xxxx-xxxx'</span> \

Â  -H <span class="hljs-string">'Content-Type: application/json'</span> \

Â  -d <span class="hljs-string">'{

Â  Â  "msgtype": "markdown",

Â  Â  "markdown": {

Â  Â  Â  "content": "### æµ‹è¯•å‘Šè­¦\n&gt; è¿™æ˜¯ä¸€æ¡æµ‹è¯•æ¶ˆæ¯"

Â  Â  }

Â  }'</span>

</code></pre>
<p>ä¸ºä»€ä¹ˆè¦ç”¨ webhook ä¸­è½¬ï¼Ÿç›®çš„æ˜¯è®© Alertmanager æ¨¡æ¿æ¸²æŸ“åçš„ç»“æœä¸¥æ ¼åŒ¹é…ä¼ä¸šå¾®ä¿¡æœºå™¨äººè¦æ±‚çš„æ¶ˆæ¯ç»“æ„ï¼Œè¦ç¡®ä¿ï¼š</p>
<ul>
<li>
<p>ä¼ä¸šå¾®ä¿¡æœºå™¨äººåªæ¥æ”¶ç‰¹å®šæ ¼å¼çš„ JSON æ•°æ®ï¼Œä¸Šé¢çš„ <code>markdown</code> ç±»å‹æ˜¯å‘Šè­¦åœºæ™¯æœ€å¸¸ç”¨çš„ï¼ˆæ”¯æŒæ’ç‰ˆã€é«˜äº®ï¼‰ï¼Œæ¸²æŸ“åçš„ JSON æ ¼å¼è¦ç¬¦åˆä¼ä¸šå¾®ä¿¡çš„è§„èŒƒã€‚</p>
</li>
<li>
<p><code>content</code> å­—æ®µè¦ç¬¦åˆä¼ä¸šå¾®ä¿¡ <code>markdown</code> çš„è¯­æ³•ï¼Œè¦å¤„ç†å¥½ä¸€äº›ç‰¹æ®Šå­—ç¬¦ã€‚</p>
</li>
</ul>
<p>Alertmanager ä»¥ JSON æ ¼å¼å‘é…ç½®çš„ webhook ç«¯ç‚¹å‘é€ HTTP POST è¯·æ±‚ï¼Œå›ºå®šæ ¼å¼ï¼š</p>
<pre><code class="hljs language-json" lang="json">
<span class="hljs-punctuation">{</span>

Â  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"4"</span><span class="hljs-punctuation">,</span>

Â  <span class="hljs-attr">"groupKey"</span><span class="hljs-punctuation">:</span> &lt;string&gt;<span class="hljs-punctuation">,</span> Â  Â  Â  Â  Â  Â  Â <span class="hljs-comment">// key identifying the group of alerts (e.g. to deduplicate)</span>

Â  <span class="hljs-attr">"truncatedAlerts"</span><span class="hljs-punctuation">:</span> &lt;int&gt;<span class="hljs-punctuation">,</span> Â  Â  Â  Â  Â <span class="hljs-comment">// how many alerts have been truncated due to "max_alerts"</span>

Â  <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"&lt;resolved|firing&gt;"</span><span class="hljs-punctuation">,</span>

Â  <span class="hljs-attr">"receiver"</span><span class="hljs-punctuation">:</span> &lt;string&gt;<span class="hljs-punctuation">,</span>

Â  <span class="hljs-attr">"groupLabels"</span><span class="hljs-punctuation">:</span> &lt;object&gt;<span class="hljs-punctuation">,</span>

Â  <span class="hljs-attr">"commonLabels"</span><span class="hljs-punctuation">:</span> &lt;object&gt;<span class="hljs-punctuation">,</span>

Â  <span class="hljs-attr">"commonAnnotations"</span><span class="hljs-punctuation">:</span> &lt;object&gt;<span class="hljs-punctuation">,</span>

Â  <span class="hljs-attr">"externalURL"</span><span class="hljs-punctuation">:</span> &lt;string&gt;<span class="hljs-punctuation">,</span> Â  Â  Â  Â  Â  <span class="hljs-comment">// backlink to the Alertmanager.</span>

Â  <span class="hljs-attr">"alerts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>

Â  Â  <span class="hljs-punctuation">{</span>

Â  Â  Â  <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"&lt;resolved|firing&gt;"</span><span class="hljs-punctuation">,</span>

Â  Â  Â  <span class="hljs-attr">"labels"</span><span class="hljs-punctuation">:</span> &lt;object&gt;<span class="hljs-punctuation">,</span>

Â  Â  Â  <span class="hljs-attr">"annotations"</span><span class="hljs-punctuation">:</span> &lt;object&gt;<span class="hljs-punctuation">,</span>

Â  Â  Â  <span class="hljs-attr">"startsAt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"&lt;rfc3339&gt;"</span><span class="hljs-punctuation">,</span>

Â  Â  Â  <span class="hljs-attr">"endsAt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"&lt;rfc3339&gt;"</span><span class="hljs-punctuation">,</span>

Â  Â  Â  <span class="hljs-attr">"generatorURL"</span><span class="hljs-punctuation">:</span> &lt;string&gt;<span class="hljs-punctuation">,</span> Â  Â  Â <span class="hljs-comment">// identifies the entity that caused the alert</span>

Â  Â  Â  <span class="hljs-attr">"fingerprint"</span><span class="hljs-punctuation">:</span> &lt;string&gt; Â  Â  Â  Â <span class="hljs-comment">// fingerprint to identify the alert</span>

Â  Â  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>

Â  Â  ...

Â  <span class="hljs-punctuation">]</span>

<span class="hljs-punctuation">}</span>

</code></pre>
<p>æµç¨‹ï¼š</p>
<pre><code class="hljs language-rust" lang="rust">
Alertmanagerï¼ˆå›ºå®šçš„åŸå§‹ JSON æ ¼å¼ï¼‰ <span class="hljs-punctuation">-&gt;</span> ä¸­è½¬ç«¯ç‚¹ï¼ˆæ‰“åŒ…æˆä¼ä¸šå¾®ä¿¡æœºå™¨äººè¦æ±‚çš„æ ¼å¼ï¼‰ <span class="hljs-punctuation">-&gt;</span> ä¼ä¸šå¾®ä¿¡æœºå™¨äºº

</code></pre>
<p>ä¸‹é¢ç”¨ golang æ¥å®ç°è¿™ä¸ªä¸­è½¬ç«¯ï¼Œä¹Ÿå¯ä»¥ç”¨å…¶å®ƒè¯­è¨€å®ç°æ¯”å¦‚ pythonã€‚</p>
<p><code>alertmanager.yml</code> ä¸­é…ç½®ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml">
<span class="hljs-string">...</span>

<span class="hljs-comment"># æ¨¡æ¿æ–‡ä»¶</span>

<span class="hljs-attr">templates:</span>

Â  <span class="hljs-bullet">-</span> <span class="hljs-string">'/etc/alertmanager/templates/*.tmpl'</span>

  


<span class="hljs-comment"># æ¥æ”¶å™¨ï¼šå®šä¹‰å‘Šè­¦çš„é€šçŸ¥æ–¹å¼ï¼ˆé‚®ä»¶ã€WebHook ç­‰ï¼‰</span>

<span class="hljs-attr">receivers:</span>

Â  <span class="hljs-string">...</span>

Â  <span class="hljs-comment"># ä¼ä¸šå¾®ä¿¡æ¥æ”¶å™¨ï¼ˆé€šè¿‡ WebHookï¼‰</span>

Â  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">'wechat'</span>

Â  Â  <span class="hljs-attr">webhook_configs:</span>

Â  Â  Â  <span class="hljs-comment"># golang ä¸­è½¬ç«¯</span>

Â  Â  Â  <span class="hljs-bullet">-</span> <span class="hljs-attr">url:</span> <span class="hljs-string">'http://10.0.0.12:5000/wechat'</span>

Â  Â  Â  Â  <span class="hljs-attr">send_resolved:</span> <span class="hljs-literal">true</span> Â <span class="hljs-comment"># å‘Šè­¦æ¢å¤æ—¶ä¹Ÿå‘é€é€šçŸ¥</span>

Â  Â  Â  Â  <span class="hljs-attr">timeout:</span> <span class="hljs-string">15s</span>

</code></pre>
<p><code>golang-wechat/main.go</code>ï¼š</p>
<pre><code class="hljs language-golang" lang="golang">
<span class="hljs-keyword">package</span> main

  


<span class="hljs-keyword">import</span> (

Â  <span class="hljs-string">"bytes"</span>

Â  <span class="hljs-string">"encoding/json"</span>

Â  <span class="hljs-string">"fmt"</span>

Â  <span class="hljs-string">"log"</span>

Â  <span class="hljs-string">"net/http"</span>

Â  <span class="hljs-string">"os"</span>

Â  <span class="hljs-string">"text/template"</span>

Â  <span class="hljs-string">"time"</span>

)

  


<span class="hljs-comment">// Alertmanager åŸå§‹å‘Šè­¦æ•°æ®ç»“æ„ï¼ˆä¸æ¨¡æ¿å˜é‡å¯¹åº”ï¼‰</span>

<span class="hljs-keyword">type</span> AlertmanagerData <span class="hljs-keyword">struct</span> {

Â  Receiver Â  Â  Â  Â  Â <span class="hljs-type">string</span> Â  Â  Â  Â  Â  Â <span class="hljs-string">`json:"receiver"`</span>

Â  Status Â  Â  Â  Â  Â  Â <span class="hljs-type">string</span> Â  Â  Â  Â  Â  Â <span class="hljs-string">`json:"status"`</span>

Â  Alerts Â  Â  Â  Â  Â  Â []Alert Â  Â  Â  Â  Â  <span class="hljs-string">`json:"alerts"`</span>

Â  GroupLabels Â  Â  Â  <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span> <span class="hljs-string">`json:"groupLabels"`</span>

Â  CommonLabels Â  Â  Â <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span> <span class="hljs-string">`json:"commonLabels"`</span>

Â  CommonAnnotations <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span> <span class="hljs-string">`json:"commonAnnotations"`</span>

Â  ExternalURL Â  Â  Â  <span class="hljs-type">string</span> Â  Â  Â  Â  Â  Â <span class="hljs-string">`json:"externalURL"`</span>

Â  Version Â  Â  Â  Â  Â  <span class="hljs-type">string</span> Â  Â  Â  Â  Â  Â <span class="hljs-string">`json:"version"`</span>

}

  


<span class="hljs-keyword">type</span> Alert <span class="hljs-keyword">struct</span> {

Â  Status Â  Â  Â <span class="hljs-type">string</span> Â  Â  Â  Â  Â  Â <span class="hljs-string">`json:"status"`</span>

Â  Labels Â  Â  Â <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span> <span class="hljs-string">`json:"labels"`</span>

Â  Annotations <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span> <span class="hljs-string">`json:"annotations"`</span>

Â  StartsAt Â  Â time.Time Â  Â  Â  Â  <span class="hljs-string">`json:"startsAt"`</span>

Â  EndsAt Â  Â  Â time.Time Â  Â  Â  Â  <span class="hljs-string">`json:"endsAt"`</span>

Â  Fingerprint <span class="hljs-type">string</span> Â  Â  Â  Â  Â  Â <span class="hljs-string">`json:"fingerprint"`</span>

}

  


<span class="hljs-comment">// ä¼ä¸šå¾®ä¿¡æ¶ˆæ¯ç»“æ„ï¼ˆæ¨¡æ¿æ¸²æŸ“ç»“æœéœ€ç¬¦åˆæ­¤æ ¼å¼ï¼‰</span>

<span class="hljs-keyword">type</span> WechatMessage <span class="hljs-keyword">struct</span> {

Â  MsgType Â <span class="hljs-type">string</span> <span class="hljs-string">`json:"msgtype"`</span>

Â  Markdown <span class="hljs-keyword">struct</span> {

Â  Â  Content <span class="hljs-type">string</span> <span class="hljs-string">`json:"content"`</span>

Â  } <span class="hljs-string">`json:"markdown"`</span>

}

  


<span class="hljs-keyword">var</span> (

Â  wechatWebhook <span class="hljs-type">string</span>

Â  tpl Â  Â  Â  Â  Â  *template.Template <span class="hljs-comment">// å…¨å±€æ¨¡æ¿å¯¹è±¡</span>

)

  


<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {

Â  <span class="hljs-comment">// ä»ç¯å¢ƒå˜é‡è·å–é…ç½®</span>

Â  wechatWebhook = os.Getenv(<span class="hljs-string">"WECHAT_WEBHOOK_URL"</span>)

Â  port := os.Getenv(<span class="hljs-string">"PORT"</span>)

Â  tplPath := os.Getenv(<span class="hljs-string">"TEMPLATE_PATH"</span>) <span class="hljs-comment">// æ¨¡æ¿æ–‡ä»¶è·¯å¾„</span>

  


Â  <span class="hljs-keyword">if</span> port == <span class="hljs-string">""</span> {

Â  Â  port = <span class="hljs-string">"5000"</span> <span class="hljs-comment">// é»˜è®¤ç«¯å£</span>

Â  }

Â  <span class="hljs-keyword">if</span> wechatWebhook == <span class="hljs-string">""</span> {

Â  Â  log.Fatal(<span class="hljs-string">"è¯·è®¾ç½®ç¯å¢ƒå˜é‡ WECHAT_WEBHOOK_URL"</span>)

Â  }

Â  <span class="hljs-keyword">if</span> tplPath == <span class="hljs-string">""</span> {

Â  Â  tplPath = <span class="hljs-string">"/app/templates/wechat.tmpl"</span> <span class="hljs-comment">// é»˜è®¤æ¨¡æ¿è·¯å¾„</span>

Â  }

  


Â  <span class="hljs-comment">// åŠ è½½å¹¶è§£ææ¨¡æ¿æ–‡ä»¶ï¼ˆåªæ¸²æŸ“ content å†…å®¹ï¼Œä¸å« JSON ç»“æ„ï¼‰</span>

Â  <span class="hljs-keyword">var</span> err <span class="hljs-type">error</span>

Â  tpl, err = template.ParseFiles(tplPath)

Â  <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {

Â  Â  log.Fatalf(<span class="hljs-string">"åŠ è½½æ¨¡æ¿å¤±è´¥: %v"</span>, err)

Â  }

Â  log.Printf(<span class="hljs-string">"æˆåŠŸåŠ è½½æ¨¡æ¿ï¼Œåç§°: %sï¼Œè·¯å¾„: %s"</span>, tpl.Name(), tplPath)

  


Â  <span class="hljs-comment">// æ³¨å†Œ HTTP è·¯ç”±</span>

Â  http.HandleFunc(<span class="hljs-string">"/wechat"</span>, forwardHandler)

Â  http.HandleFunc(<span class="hljs-string">"/health"</span>, healthHandler)

  


Â  <span class="hljs-comment">// å¯åŠ¨æœåŠ¡</span>

Â  log.Printf(<span class="hljs-string">"æœåŠ¡å¯åŠ¨ï¼Œç›‘å¬ç«¯å£: %s"</span>, port)

Â  log.Fatal(http.ListenAndServe(<span class="hljs-string">":"</span>+port, <span class="hljs-literal">nil</span>))

}

  


<span class="hljs-comment">// è½¬å‘å¤„ç†å‡½æ•°</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">forwardHandler</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> {

Â  <span class="hljs-comment">// è§£æ Alertmanager åŸå§‹æ•°æ®</span>

Â  <span class="hljs-keyword">var</span> alertData AlertmanagerData

Â  <span class="hljs-keyword">if</span> err := json.NewDecoder(r.Body).Decode(&amp;alertData); err != <span class="hljs-literal">nil</span> {

Â  Â  http.Error(w, <span class="hljs-string">"è§£æè¯·æ±‚å¤±è´¥: "</span>+err.Error(), http.StatusBadRequest)

Â  Â  log.Printf(<span class="hljs-string">"è§£æé”™è¯¯: %v"</span>, err)

Â  Â  <span class="hljs-keyword">return</span>

Â  }

Â  log.Printf(<span class="hljs-string">"æ”¶åˆ°å‘Šè­¦æ•°æ®: %+v"</span>, alertData)

  


Â  <span class="hljs-comment">// ç”¨æ¨¡æ¿æ¸²æŸ“ markdown.content çš„æ–‡æœ¬å†…å®¹ï¼ˆä¸å« JSON ç»“æ„ï¼‰</span>

Â  <span class="hljs-keyword">var</span> contentBuf bytes.Buffer

Â  <span class="hljs-comment">// å¸¦æœ‰å‘½åæ¨¡æ¿ï¼ˆ{{ define "wechat.message" }}ï¼‰çš„æ¨¡æ¿æ–‡ä»¶ ä½¿ç”¨ ExecuteTemplate è€Œä¸æ˜¯ Execute</span>

Â  <span class="hljs-keyword">if</span> err := tpl.ExecuteTemplate(&amp;contentBuf, <span class="hljs-string">"wechat.message"</span>, alertData); err != <span class="hljs-literal">nil</span> {

Â  Â  http.Error(w, <span class="hljs-string">"æ¨¡æ¿æ¸²æŸ“å¤±è´¥: "</span>+err.Error(), http.StatusInternalServerError)

Â  Â  log.Printf(<span class="hljs-string">"æ¨¡æ¿æ¸²æŸ“é”™è¯¯: %v"</span>, err)

Â  Â  <span class="hljs-keyword">return</span>

Â  }

Â  rawContent := contentBuf.String()

Â  log.Printf(<span class="hljs-string">"æ¸²æŸ“åçš„ content åŸå§‹å†…å®¹: %s"</span>, rawContent)

  


Â  escapedContent := rawContent

  


Â  <span class="hljs-comment">// æ„é€ ä¼ä¸šå¾®ä¿¡æ¶ˆæ¯ç»“æ„ä½“</span>

Â  <span class="hljs-keyword">var</span> wechatMsg WechatMessage

Â  wechatMsg.MsgType = <span class="hljs-string">"markdown"</span>

Â  wechatMsg.Markdown.Content = escapedContent

  


Â  <span class="hljs-comment">// åºåˆ—åŒ–ç»“æ„ä½“ä¸º JSONï¼ˆè‡ªåŠ¨å¤„ç†æ‰€æœ‰ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ï¼‰</span>

Â  jsonData, err := json.Marshal(wechatMsg)

Â  <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {

Â  Â  http.Error(w, <span class="hljs-string">"JSON åºåˆ—åŒ–å¤±è´¥: "</span>+err.Error(), http.StatusInternalServerError)

Â  Â  log.Printf(<span class="hljs-string">"JSON åºåˆ—åŒ–é”™è¯¯: %v"</span>, err)

Â  Â  <span class="hljs-keyword">return</span>

Â  }

Â  log.Printf(<span class="hljs-string">"æœ€ç»ˆå‘é€çš„ JSON: %s"</span>, jsonData)

  


Â  <span class="hljs-comment">// è½¬å‘åˆ°ä¼ä¸šå¾®ä¿¡</span>

Â  resp, err := http.Post(wechatWebhook, <span class="hljs-string">"application/json"</span>, bytes.NewBuffer(jsonData))

Â  <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {

Â  Â  http.Error(w, <span class="hljs-string">"è½¬å‘å¤±è´¥: "</span>+err.Error(), http.StatusInternalServerError)

Â  Â  log.Printf(<span class="hljs-string">"è½¬å‘é”™è¯¯: %v"</span>, err)

Â  Â  <span class="hljs-keyword">return</span>

Â  }

Â  <span class="hljs-keyword">defer</span> resp.Body.Close()

  


Â  <span class="hljs-keyword">if</span> resp.StatusCode != http.StatusOK {

Â  Â  http.Error(w, fmt.Sprintf(<span class="hljs-string">"ä¼ä¸šå¾®ä¿¡æ¥å£é”™è¯¯ï¼ŒçŠ¶æ€ç : %d"</span>, resp.StatusCode), http.StatusInternalServerError)

Â  Â  log.Printf(<span class="hljs-string">"ä¼ä¸šå¾®ä¿¡æ¥å£é”™è¯¯ï¼ŒçŠ¶æ€ç : %d"</span>, resp.StatusCode)

Â  Â  <span class="hljs-keyword">return</span>

Â  }

  


Â  <span class="hljs-comment">// è¿”å›æˆåŠŸå“åº”</span>

Â  w.WriteHeader(http.StatusOK)

Â  w.Write([]<span class="hljs-type">byte</span>(<span class="hljs-string">`{"status": "success"}`</span>))

}

  


<span class="hljs-comment">// å¥åº·æ£€æŸ¥</span>

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">healthHandler</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> {

Â  w.WriteHeader(http.StatusOK)

Â  w.Write([]<span class="hljs-type">byte</span>(<span class="hljs-string">`{"status": "healthy"}`</span>))

}

</code></pre>
<p>åŒ¹é…ä¸Šé¢ golang ä¸­è½¬ç¨‹åºçš„æ¨¡æ¿ <code>templates/wechat.tmpl</code>ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby">
{{ define <span class="hljs-string">"wechat.message"</span> }}

  


{{- range <span class="hljs-variable">$index</span>, <span class="hljs-variable">$alert</span> <span class="hljs-symbol">:</span>= .<span class="hljs-title class_">Alerts</span> -}}

{{- <span class="hljs-keyword">if</span> gt <span class="hljs-variable">$index</span> <span class="hljs-number">0</span> }}

---

{{ <span class="hljs-keyword">end</span> }}

  


{{- <span class="hljs-keyword">if</span> eq <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Status</span> <span class="hljs-string">"firing"</span> }}

<span class="hljs-comment">### ğŸš¨ ç›‘æ§æŠ¥è­¦ï¼ˆæ•…éšœå‘Šè­¦é€šçŸ¥ï¼‰</span>

{{- <span class="hljs-keyword">else</span> }}

<span class="hljs-comment">### âœ… ç›‘æ§æŠ¥è­¦ï¼ˆæ¢å¤é€šçŸ¥ï¼‰</span>

{{- <span class="hljs-keyword">end</span> }}

- **å‘Šè­¦ç±»å‹**: {{ <span class="hljs-keyword">if</span> <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Labels</span>.alertname }}{{ <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Labels</span>.alertname }}{{ <span class="hljs-keyword">else</span> }}æœªçŸ¥å‘Šè­¦{{ <span class="hljs-keyword">end</span> }}

- **å‘Šè­¦çº§åˆ«**: {{ <span class="hljs-keyword">if</span> <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Labels</span>.severity }}{{ <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Labels</span>.severity }}{{ <span class="hljs-keyword">else</span> }}æœªçŸ¥çº§åˆ«{{ <span class="hljs-keyword">end</span> }}

- **å‘Šè­¦çŠ¶æ€**: {{ <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Status</span> }} {{ <span class="hljs-keyword">if</span> eq <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Status</span> <span class="hljs-string">"firing"</span> }}æ•…éšœ{{ <span class="hljs-keyword">else</span> }}æ¢å¤{{ <span class="hljs-keyword">end</span> }}

- **æ•…éšœä¸»æœº**: {{ <span class="hljs-keyword">if</span> <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Labels</span>.instance }}{{ <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Labels</span>.instance }}{{ <span class="hljs-keyword">else</span> }}-{{ <span class="hljs-keyword">end</span> }} {{ <span class="hljs-keyword">if</span> <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Labels</span>.device }}{{ <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Labels</span>.device }}{{ <span class="hljs-keyword">else</span> }}-{{ <span class="hljs-keyword">end</span> }}

- **æœåŠ¡ç¯å¢ƒ**: {{ <span class="hljs-keyword">if</span> <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Labels</span>.env }}{{ <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Labels</span>.env }}{{ <span class="hljs-keyword">else</span> }}æœªçŸ¥ç¯å¢ƒ{{ <span class="hljs-keyword">end</span> }}

- **æœåŠ¡åç§°**: {{ <span class="hljs-keyword">if</span> <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Labels</span>.servicename }}{{ <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Labels</span>.servicename }}{{ <span class="hljs-keyword">else</span> }}æœªçŸ¥æœåŠ¡{{ <span class="hljs-keyword">end</span> }}

- **å‘Šè­¦ä¸»é¢˜**: {{ <span class="hljs-keyword">if</span> <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Annotations</span>.summary }}{{ <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Annotations</span>.summary }}{{ <span class="hljs-keyword">else</span> }}æ— ä¸»é¢˜{{ <span class="hljs-keyword">end</span> }}

- **å‘Šè­¦è¯¦æƒ…**: {{ <span class="hljs-keyword">if</span> <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Annotations</span>.message }}{{ <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Annotations</span>.message }}{{ <span class="hljs-keyword">end</span> }}{{ <span class="hljs-keyword">if</span> <span class="hljs-keyword">and</span> <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Annotations</span>.message <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Annotations</span>.description }}ï¼›{{ <span class="hljs-keyword">end</span> }}{{ <span class="hljs-keyword">if</span> <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Annotations</span>.description }}{{ <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Annotations</span>.description }}{{ <span class="hljs-keyword">else</span> }}æ— è¯¦æƒ…{{ <span class="hljs-keyword">end</span> }}

{{- <span class="hljs-keyword">if</span> <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Annotations</span>.value }}

- **è§¦å‘é˜ˆå€¼**: {{ <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Annotations</span>.value }}

{{- <span class="hljs-keyword">end</span> }}

- **æ•…éšœæ—¶é—´**: {{ (<span class="hljs-variable">$alert</span>.<span class="hljs-title class_">StartsAt</span>.<span class="hljs-title class_">Add</span> <span class="hljs-number">28800e9</span>).<span class="hljs-title class_">Format</span> <span class="hljs-string">"2006-01-02 15:04:05"</span> }}

{{- <span class="hljs-keyword">if</span> eq <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">Status</span> <span class="hljs-string">"resolved"</span> }}

- **æ¢å¤æ—¶é—´**: {{ <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-variable">$alert</span>.<span class="hljs-title class_">EndsAt</span>.<span class="hljs-title class_">IsZero</span> }}{{ (<span class="hljs-variable">$alert</span>.<span class="hljs-title class_">EndsAt</span>.<span class="hljs-title class_">Add</span> <span class="hljs-number">28800e9</span>).<span class="hljs-title class_">Format</span> <span class="hljs-string">"2006-01-02 15:04:05"</span> }}{{ <span class="hljs-keyword">else</span> }}æŒç»­ä¸­{{ <span class="hljs-keyword">end</span> }}

{{- <span class="hljs-keyword">end</span> }}

  


{{- <span class="hljs-keyword">end</span> }}

  


{{ <span class="hljs-keyword">end</span> }}

</code></pre>
<p>æˆ‘çš„ Alertmanager æ˜¯ç”¨ docker å®¹å™¨çš„å½¢å¼è¿è¡Œçš„ï¼Œè¿›å…¥å®¹å™¨ä¸­æ‰‹åŠ¨è§¦å‘å‘Šè­¦ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">
<span class="hljs-comment"># docker exec -it alertmanager sh</span>

amtool alert add \

Â  --alertmanager.url=http://localhost:9093 \

Â  --annotation summary=<span class="hljs-string">"æµ‹è¯•å‘Šè­¦"</span> \

Â  --annotation description=<span class="hljs-string">"é€šè¿‡ amtool å‘é€çš„æµ‹è¯•"</span> \

Â  alertname=TestAlert \

Â  severity=critical \

Â  instance=test-server

  


<span class="hljs-comment"># ç”Ÿæˆæµ‹è¯•æ•°æ®ï¼ˆä¿å­˜ä¸º test_alert.jsonï¼‰</span>

<span class="hljs-built_in">cat</span> &gt; test_alert.json &lt;&lt; <span class="hljs-string">EOF

{

Â  "version": "4",

Â  "status": "firing",

Â  "alerts": [

Â  Â  {

Â  Â  Â  "status": "firing",

Â  Â  Â  "labels": {

Â  Â  Â  Â  "alertname": "HostOutOfMemory",

Â  Â  Â  Â  "severity": "warning",

Â  Â  Â  Â  "instance": "ubuntu-test-10-0-0-12",

Â  Â  Â  Â  "hostname": "test-host",

Â  Â  Â  Â  "env": "prod",

Â  Â  Â  Â  "servicename": "node-exporter"

Â  Â  Â  },

Â  Â  Â  "annotations": {

Â  Â  Â  Â  "summary": "å†…å­˜ä¸è¶³å‘Šè­¦",

Â  Â  Â  Â  "description": "å†…å­˜ä½¿ç”¨ç‡è¶…è¿‡90%"

Â  Â  Â  },

Â  Â  Â  "startsAt": "2025-08-09T08:00:00Z"

Â  Â  }

Â  ]

}

EOF</span>

  


<span class="hljs-comment"># ç”¨ amtool æµ‹è¯•æ¨¡æ¿æ¸²æŸ“</span>

amtool template render \

Â  --template.glob=/etc/alertmanager/templates/wechat.tmpl \

Â  --template.data=test_alert.json \

Â  --template.text=<span class="hljs-string">'{{ template "wechat.message" . }}'</span>

</code></pre>
<p>golang ä¸­è½¬ç«¯ä¹Ÿæ˜¯ç”¨ docker å®¹å™¨çš„å½¢å¼è¿è¡Œçš„ï¼Œä¸€ä¸ªç®€å•çš„ <code>golang-wechat/Dockerfile</code>ï¼š</p>
<pre><code class="hljs language-Dockerfile" lang="Dockerfile">
FROM golang:1.23-alpine AS builder

WORKDIR /app

COPY main.go .

# å¯ç”¨ CGO ç¦ç”¨ï¼ˆé™æ€ç¼–è¯‘ï¼Œé¿å…ä¾èµ–ç³»ç»Ÿåº“ï¼‰

RUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -ldflags="-s -w" -o mywechat main.go

FROM alpine:3.20

WORKDIR /app

COPY --from=builder /app/mywechat .

EXPOSE 5000

ENTRYPOINT ["./mywechat"]

</code></pre>
<p>æ„å»ºã€å¯åŠ¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">
docker build -t mywechat:v1 .

docker stop mywechat

docker <span class="hljs-built_in">rm</span> mywechat

docker run -d \

-v /etc/localtime:/etc/localtime:ro \

--user 1026:1026 \

--name mywechat \

-p 5000:5000 \

-e WECHAT_WEBHOOK_URL=<span class="hljs-string">"https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxxx-xxxx-xxxxx-xxxx-xxxx"</span> \

-v templates:/app/templates \

mywechat:v1

</code></pre>
<p>æ¥ä¸‹æ¥å°±å¯ä»¥æ‰‹åŠ¨è§¦å‘ä¸€äº›å‘Šè­¦æ¥éªŒè¯å‘Šè­¦è§„åˆ™çš„å¤„ç†äº†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring Boot å¯åŠ¨å…¨è§£æï¼š4 å¤§å…³é”®åŠ¨ä½œ + åº•å±‚é€»è¾‘]]></title>    <link>https://juejin.cn/post/7596181746061197339</link>    <guid>https://juejin.cn/post/7596181746061197339</guid>    <pubDate>2026-01-17T07:52:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596181746061197339" data-draft-id="7591728734983880731" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring Boot å¯åŠ¨å…¨è§£æï¼š4 å¤§å…³é”®åŠ¨ä½œ + åº•å±‚é€»è¾‘"/> <meta itemprop="keywords" content="Spring Boot"/> <meta itemprop="datePublished" content="2026-01-17T07:52:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é—²ç…®å…‰é˜´"/> <meta itemprop="url" content="https://juejin.cn/user/1523239911963420"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring Boot å¯åŠ¨å…¨è§£æï¼š4 å¤§å…³é”®åŠ¨ä½œ + åº•å±‚é€»è¾‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1523239911963420/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é—²ç…®å…‰é˜´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T07:52:45.000Z" title="Sat Jan 17 2026 07:52:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Spring Boot ä»¥ â€œçº¦å®šä¼˜äºé…ç½®â€ çš„æ ¸å¿ƒæ€æƒ³å¤§å¹…ç®€åŒ–äº† Spring åº”ç”¨çš„å¼€å‘ä¸éƒ¨ç½²ï¼Œå…¶å¯åŠ¨æµç¨‹æ˜¯ç†è§£æ¡†æ¶åº•å±‚åŸç†çš„å…³é”®ã€‚æœ¬æ–‡å°†ä» â€œæ ¸å¿ƒåŠ¨ä½œâ€ å’Œ â€œå®ç°ç»†èŠ‚â€ ä¸¤ä¸ªç»´åº¦ï¼Œå…¨é¢æ‹†è§£ Spring Boot å¯åŠ¨è¿‡ç¨‹ä¸­å®Œæˆçš„æ ¸å¿ƒå·¥ä½œåŠåº•å±‚å®ç°é€»è¾‘ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€Spring Boot å¯åŠ¨æµç¨‹æ ¸å¿ƒåŠ¨ä½œ</h2>
<p>Spring Boot å¯åŠ¨çš„æœ¬è´¨æ˜¯å®Œæˆ â€œç¯å¢ƒå‡†å¤‡ - å®¹å™¨åˆå§‹åŒ– - æœåŠ¡å¯åŠ¨â€ çš„å…¨é“¾è·¯æµç¨‹ï¼Œæ ¸å¿ƒå¯æ‹†è§£ä¸ºä»¥ä¸‹ 4 ä¸ªå…³é”®åŠ¨ä½œï¼Œä¸”å„åŠ¨ä½œéµå¾ªä¸¥æ ¼çš„æ‰§è¡Œé¡ºåºï¼š</p>
<ol>
<li><strong>åŠ è½½é…ç½®æ–‡ä»¶</strong>ï¼šæ•´åˆå¤šæ¥æºé…ç½®ï¼ˆå†…ç½®é»˜è®¤ã€è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ã€ç¯å¢ƒå˜é‡ã€å‘½ä»¤è¡Œå‚æ•°ç­‰ï¼‰ï¼Œæ„å»ºç»Ÿä¸€çš„åº”ç”¨ç¯å¢ƒä¸Šä¸‹æ–‡ï¼›</li>
<li><strong>åŠ è½½æ—¥å¿—ç»„ä»¶</strong>ï¼šåˆå§‹åŒ–æ—¥å¿—ç³»ç»Ÿï¼Œç¡®ä¿å¯åŠ¨è¿‡ç¨‹åŠåº”ç”¨è¿è¡Œçš„æ—¥å¿—å¯è¿½æº¯ã€å¯é…ç½®ï¼›</li>
<li><strong>åˆ›å»º Spring å®¹å™¨å¹¶åˆå§‹åŒ– Bean</strong>ï¼šæ„å»º IoC å®¹å™¨ï¼Œæ‰«ææŒ‡å®šèŒƒå›´çš„ Bean å®šä¹‰ã€è§£ææ³¨è§£ã€å®Œæˆ Bean çš„å®ä¾‹åŒ–ä¸ä¾èµ–æ³¨å…¥ï¼›</li>
<li><strong>å¯åŠ¨åµŒå…¥å¼ Web æœåŠ¡å™¨ï¼ˆå¦‚ Tomcatï¼‰</strong>ï¼šé’ˆå¯¹ Web åº”ç”¨ï¼Œåˆå§‹åŒ–åµŒå…¥å¼æœåŠ¡å™¨å¹¶ç»‘å®š Servlet/Filter ç­‰ç»„ä»¶ï¼Œå¯¹å¤–æä¾›æœåŠ¡ã€‚</li>
</ol>
<h2 data-id="heading-1">äºŒã€æ ¸å¿ƒåŠ¨ä½œçš„åº•å±‚å®ç°ç»†èŠ‚</h2>
<h3 data-id="heading-2">2.1 åŠ è½½é…ç½®æ–‡ä»¶ï¼šæ•´åˆå¤šæ¥æºé…ç½®ï¼Œæ„å»ºç¯å¢ƒä¸Šä¸‹æ–‡</h3>
<p>Spring Boot é…ç½®æ–‡ä»¶çš„åŠ è½½æ ¸å¿ƒä¾èµ– <code>ConfigFileApplicationListener</code>ï¼ˆSpring Boot 2.4+ åé€æ­¥è¢« <code>ConfigDataEnvironmentPostProcessor</code> æ›¿ä»£ï¼Œä½†æ ¸å¿ƒé€»è¾‘ä¸€è‡´ï¼‰ï¼Œå…¶æ ¸å¿ƒä½œç”¨æ˜¯æ‰«ææŒ‡å®šè·¯å¾„ä¸‹çš„é…ç½®æ–‡ä»¶ï¼ˆå¦‚ <code>application.yml</code>/<code>application.properties</code>ï¼‰ï¼Œå¹¶å°†é…ç½®é¡¹æ•´åˆåˆ° <code>Environment</code> ä¸Šä¸‹æ–‡å¯¹è±¡ä¸­ã€‚</p>
<h4 data-id="heading-3">è°ƒç”¨æµç¨‹</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">%%{init:"wrap": false, {"flowchart":{"wrappingWidth":2000}}}%%
graph TD
A("SpringApplication.run() å…¥å£æ–¹æ³•")--&gt;|åˆ›å»º SpringApplication å®ä¾‹| B("new SpringApplication(primarySources)")
B--&gt;|æ„é€ å‡½æ•°åˆå§‹åŒ–ç›‘å¬å™¨| C("setListeners(getSpringFactoriesInstances(ApplicationListener.class))&lt;br/&gt;æ ¸å¿ƒé€»è¾‘ï¼šè¯»å– META-INF/spring.factories æ–‡ä»¶ï¼ŒåŠ è½½æ‰€æœ‰&lt;br/&gt; ApplicationListener å®ç°ç±»ï¼ŒåŒ…å« ConfigFileApplicationListener")
C --&gt;D("è°ƒç”¨ application.run(args) æ‰§è¡Œå¯åŠ¨æµç¨‹")
D --&gt;|åˆå§‹åŒ–è¿è¡Œç›‘å¬å™¨| E("SpringApplicationRunListeners listeners = getRunListeners(args)&lt;br/&gt;è¯»å– META-INF/spring.factories åŠ è½½ EventPublishingRunListener&lt;br/&gt;ï¼ˆäº‹ä»¶å‘å¸ƒç›‘å¬å™¨ï¼‰")
E--&gt;|å‡†å¤‡ç¯å¢ƒä¸Šä¸‹æ–‡| F("prepareEnvironment(listeners, applicationArguments)")
F--&gt;|å‘å¸ƒç¯å¢ƒå‡†å¤‡äº‹ä»¶|G("listeners.environmentPrepared(environment)")
G--&gt;|äº‹ä»¶åˆ†å‘|H("EventPublishingRunListener.environmentPrepared()&lt;br/&gt;è§¦å‘ EnvironmentPreparedEvent äº‹ä»¶")
H--&gt;|ç›‘å¬å™¨å¤„ç†äº‹ä»¶|I("ConfigFileApplicationListener.onApplicationEvent(EnvironmentPreparedEvent)")
I--&gt;|æ ¸å¿ƒå¤„ç†é€»è¾‘|J("onApplicationEnvironmentPreparedEvent(EnvironmentPreparedEvent)")
J--&gt;|è§£æé…ç½®æ–‡ä»¶|K("postProcessEnvironment(environment, applicationArguments)&lt;br/&gt;1. æ‰«æ classpath:/ã€classpath:/config/ã€file:./ã€file:./config/ ç­‰è·¯å¾„ï¼›&lt;br/&gt;2. æŒ‰ä¼˜å…ˆçº§åŠ è½½ application.properties/ymlã€profile ä¸“å±é…ç½®ï¼›&lt;br/&gt;3. æ•´åˆç¯å¢ƒå˜é‡ã€å‘½ä»¤è¡Œå‚æ•°è¦†ç›–é…ç½®é¡¹ï¼›&lt;br/&gt;4. å°†é…ç½®é¡¹æ³¨å…¥ Environment ä¸Šä¸‹æ–‡")


classDef leftAlign text-align:left;
class A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,S,Y,Z leftAlign;
</code></pre>
<h4 data-id="heading-4">å…³é”®è¡¥å……è¯´æ˜</h4>
<ul>
<li>é…ç½®åŠ è½½ä¼˜å…ˆçº§ï¼šå‘½ä»¤è¡Œå‚æ•° &gt; ç¯å¢ƒå˜é‡ &gt; è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ï¼ˆå¦‚ application-dev.ymlï¼‰&gt; å†…ç½®é»˜è®¤é…ç½®ï¼›</li>
<li>æ”¯æŒçš„é…ç½®æ ¼å¼ï¼špropertiesã€ymlã€yamlï¼Œä¸”æ”¯æŒå¤šç¯å¢ƒéš”ç¦»ï¼ˆé€šè¿‡ <code>spring.profiles.active</code> æŒ‡å®šæ¿€æ´»çš„ profileï¼‰ï¼›</li>
<li>æ ¸å¿ƒç›®çš„ï¼šå°†åˆ†æ•£çš„é…ç½®ç»Ÿä¸€æ•´åˆåˆ° <code>Environment</code> å¯¹è±¡ä¸­ï¼Œåç»­ Bean åˆå§‹åŒ–ã€æœåŠ¡å™¨å¯åŠ¨å‡å¯é€šè¿‡ <code>Environment</code> è·å–é…ç½®é¡¹ï¼ˆå¦‚ <code>server.port</code>ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-5">2.2 åŠ è½½æ—¥å¿—ç»„ä»¶ï¼šåˆå§‹åŒ–æ—¥å¿—ç³»ç»Ÿï¼Œä¿éšœæ—¥å¿—å¯é…ç½®</h3>
<p>Spring Boot å¯åŠ¨æ—¶ä¼˜å…ˆåˆå§‹åŒ–æ—¥å¿—ç»„ä»¶ï¼Œæ ¸å¿ƒä¾èµ– <code>LoggingApplicationListener</code>ï¼Œå…¶ä½œç”¨æ˜¯æ ¹æ®åº”ç”¨é…ç½®ï¼ˆæˆ–é»˜è®¤è§„åˆ™ï¼‰é€‰æ‹©å¹¶åˆå§‹åŒ–æ—¥å¿—æ¡†æ¶ï¼ˆå¦‚ Logbackã€Log4j2ã€Java Util Loggingï¼‰ï¼Œç¡®ä¿å¯åŠ¨è¿‡ç¨‹çš„æ—¥å¿—èƒ½æ­£å¸¸è¾“å‡ºã€‚</p>
<h4 data-id="heading-6">è°ƒç”¨æµç¨‹</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">%%{init:"wrap": false, {"flowchart":{"wrappingWidth":2000}}}%%
graph TD
A("SpringApplication.run() å…¥å£æ–¹æ³•")--&gt;|åˆ›å»º SpringApplication å®ä¾‹| B("new SpringApplication(primarySources)")
B--&gt;|æ„é€ å‡½æ•°åˆå§‹åŒ–ç›‘å¬å™¨| C("setListeners(getSpringFactoriesInstances(ApplicationListener.class))&lt;br/&gt;è¯»å– META-INF/spring.factories åŠ è½½ LoggingApplicationListener")
C --&gt;D("è°ƒç”¨ application.run(args) æ‰§è¡Œå¯åŠ¨æµç¨‹")
D --&gt;|åˆå§‹åŒ–è¿è¡Œç›‘å¬å™¨| E("SpringApplicationRunListeners listeners = getRunListeners(args)&lt;br/&gt;åŠ è½½ EventPublishingRunListener")
E--&gt;|å‘å¸ƒåº”ç”¨ç¯å¢ƒå·²å‡†å¤‡äº‹ä»¶|G("listeners.environmentPrepared()&lt;br/&gt;è§¦å‘ApplicationEnvironmentPreparedEvent äº‹ä»¶")
G--&gt;|äº‹ä»¶åˆ†å‘|H("EventPublishingRunListener.environmentPrepared()")
H--&gt;|ç›‘å¬å™¨å¤„ç†äº‹ä»¶|I("LoggingApplicationListener.onApplicationEvent(ApplicationEvent)")
I--&gt;|æ ¸å¿ƒå¤„ç†é€»è¾‘|J("onApplicationEnvironmentPreparedEvent(ApplicationEnvironmentPreparedEvent)")
J--&gt;|é€‰æ‹©å¹¶åˆå§‹åŒ–æ—¥å¿—ç³»ç»Ÿ|K("LoggingSystem.get(classLoader)&lt;br/&gt;1. æŒ‰ä¼˜å…ˆçº§æ£€æµ‹æ—¥å¿—æ¡†æ¶ï¼ˆLogback &gt; Log4j2 &gt; JULï¼‰ï¼›&lt;br/&gt;2. åŠ è½½æ—¥å¿—é…ç½®æ–‡ä»¶ï¼ˆå¦‚ logback-spring.xmlï¼‰ï¼›&lt;br/&gt;3. åˆå§‹åŒ–æ—¥å¿—çº§åˆ«ã€è¾“å‡ºæ ¼å¼ã€è¾“å‡ºè·¯å¾„ç­‰ï¼›&lt;br/&gt;4. ç»‘å®šæ—¥å¿—ç³»ç»Ÿåˆ° Spring ç¯å¢ƒï¼Œæ”¯æŒè¿è¡Œæ—¶åŠ¨æ€è°ƒæ•´")


classDef leftAlign text-align:left;
class A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,S,Y,Z leftAlign;

</code></pre>
<h4 data-id="heading-7">å…³é”®è¡¥å……è¯´æ˜</h4>
<ul>
<li>æ—¥å¿—æ¡†æ¶ä¼˜å…ˆçº§ï¼šSpring Boot é»˜è®¤å†…ç½® Logbackï¼ˆæ— éœ€é¢å¤–ä¾èµ–ï¼‰ï¼Œè‹¥éœ€åˆ‡æ¢ä¸º Log4j2ï¼Œéœ€æ’é™¤ Logback ä¾èµ–å¹¶å¼•å…¥ Log4j2 ç›¸å…³åŒ…ï¼›</li>
<li>æ—¥å¿—é…ç½®åŠ è½½è·¯å¾„ï¼šé»˜è®¤æ‰«æ <code>classpath:logback-spring.xml</code>ã€<code>classpath:log4j2.xml</code> ç­‰ï¼Œä¹Ÿå¯é€šè¿‡ <code>logging.config</code> é…ç½®é¡¹æŒ‡å®šè‡ªå®šä¹‰è·¯å¾„ï¼›</li>
<li>æ ¸å¿ƒç›®çš„ï¼šåœ¨åº”ç”¨æ ¸å¿ƒé€»è¾‘å¯åŠ¨å‰å®Œæˆæ—¥å¿—åˆå§‹åŒ–ï¼Œé¿å…å¯åŠ¨è¿‡ç¨‹ä¸­æ—¥å¿—ä¸¢å¤±æˆ–æ ¼å¼å¼‚å¸¸ã€‚</li>
</ul>
<h3 data-id="heading-8">2.3 åˆ›å»º Spring å®¹å™¨å¹¶åˆå§‹åŒ– Beanï¼šæ„å»º IoC æ ¸å¿ƒï¼Œç®¡ç† Bean ç”Ÿå‘½å‘¨æœŸ</h3>
<p>Spring Boot æ ¸å¿ƒæ˜¯æ„å»º Spring IoC å®¹å™¨ï¼Œæ ¸å¿ƒä¾èµ– <code>ConfigurationClassPostProcessor</code>ï¼ˆBean å®šä¹‰åç½®å¤„ç†å™¨ï¼‰ï¼Œå…¶ä½œç”¨æ˜¯è§£æå¯åŠ¨ç±»ä¸Šçš„æ³¨è§£ï¼ˆå¦‚ <code>@SpringBootApplication</code>ï¼‰ã€æ‰«ææŒ‡å®šåŒ…ä¸‹çš„ Beanã€è§£æè‡ªåŠ¨é…ç½®ç±»ï¼Œæœ€ç»ˆå®Œæˆ Bean çš„æ³¨å†Œä¸åˆå§‹åŒ–ã€‚</p>
<h4 data-id="heading-9">è°ƒç”¨æµç¨‹</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">%%{init:"wrap": false, {"flowchart":{"wrappingWidth":2000}}}%%
graph TD
A("SpringApplication.run() å…¥å£æ–¹æ³•")--&gt;|"åˆ›å»º SpringApplication å®ä¾‹"| A1("new SpringApplication(primarySources)")
A1--&gt;|æ‰§è¡Œå¯åŠ¨é€»è¾‘| A2("application.run(args)")
A2--&gt;|åˆ›å»ºåº”ç”¨ä¸Šä¸‹æ–‡| B("createApplicationContext()&lt;br/&gt;æ ¹æ®åº”ç”¨ç±»å‹é€‰æ‹©ä¸Šä¸‹æ–‡ï¼šWeb åº”ç”¨ä¸º AnnotationConfigServletWebServerApplicationContextï¼Œ&lt;br/&gt;é Web åº”ç”¨ä¸º AnnotationConfigApplicationContext")
B--&gt;|"åˆå§‹åŒ– Web åº”ç”¨ä¸Šä¸‹æ–‡"| C("context = new AnnotationConfigServletWebServerApplicationContext()")
C --&gt;|"åˆå§‹åŒ– Bean å®šä¹‰è¯»å–å™¨"| D("new AnnotatedBeanDefinitionReader(beanFactory)&lt;br/&gt;ç”¨äºè§£ææ³¨è§£é©±åŠ¨çš„ Bean å®šä¹‰")
D --&gt;|æ³¨å†Œæ ¸å¿ƒåç½®å¤„ç†å™¨| E("AnnotationConfigUtils.registerAnnotationConfigProcessors(beanFactory)&lt;br/&gt;å‘å®¹å™¨ä¸­æ³¨å†Œ ConfigurationClassPostProcessor ç­‰æ ¸å¿ƒå¤„ç†å™¨")
E--&gt;|å…³é”®å¤„ç†å™¨æ³¨å†Œå®Œæˆ|F("ConfigurationClassPostProcessor åŠ å…¥å®¹å™¨ï¼ˆBean å®šä¹‰è§£ææ ¸å¿ƒï¼‰")
F--&gt;|"æ³¨å†Œå¯åŠ¨ç±»ä¸º Bean"|C1("application.load(primarySources)&lt;br/&gt;å°† @SpringBootApplication æ ‡æ³¨çš„å¯åŠ¨ç±»ä½œä¸ºæ ¸å¿ƒ Bean æ³¨å…¥å®¹å™¨")
C1--&gt;|"åˆ·æ–°ä¸Šä¸‹æ–‡ï¼ˆæ ¸å¿ƒæ­¥éª¤ï¼‰"|G("refreshContext(context)")
G--&gt;|å®¹å™¨åˆ·æ–°æ ¸å¿ƒæ–¹æ³•|H("context.refresh()&lt;br/&gt;æ‰§è¡Œ Spring å®¹å™¨åˆå§‹åŒ–å…¨æµç¨‹")
H--&gt;|"æ‰§è¡Œ BeanFactory åç½®å¤„ç†å™¨"|I("invokeBeanFactoryPostProcessors(beanFactory)")
I--&gt;|åˆ†å‘åç½®å¤„ç†å™¨æ‰§è¡Œé€»è¾‘|J("PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors()")
J--&gt;|"æ‰§è¡Œ BeanDefinitionRegistry åç½®å¤„ç†å™¨"|K("invokeBeanDefinitionRegistryPostProcessors(registryProcessors, registry)")
K--&gt;|"è§£æå¹¶æ³¨å†Œ Bean å®šä¹‰"|L("ConfigurationClassPostProcessor.postProcessBeanDefinitionRegistry(registry)&lt;br/&gt;1. è§£æå¯åŠ¨ç±»ä¸Šçš„ @ComponentScanï¼Œæ‰«ææŒ‡å®šåŒ…ä¸‹çš„ @Component/@Service/@Repository ç­‰ Beanï¼›&lt;br/&gt;2. è§£æ @EnableAutoConfigurationï¼Œè¯»å– META-INF/spring/&lt;br/&gt;org.springframework.boot.autoconfigure.AutoConfiguration.imports æ–‡ä»¶ï¼ŒåŠ è½½è‡ªåŠ¨é…ç½®ç±»ï¼›&lt;br/&gt;3. è§£æ @Bean æ³¨è§£ï¼Œæ³¨å†Œæ‰‹åŠ¨å£°æ˜çš„ Beanï¼›&lt;br/&gt;4. å°†æ‰€æœ‰ Bean å®šä¹‰æ³¨å†Œåˆ° IoC å®¹å™¨")
L--&gt;|"Bean å®ä¾‹åŒ–ä¸ä¾èµ–æ³¨å…¥"|M("finishBeanFactoryInitialization(beanFactory)&lt;br/&gt;å®ä¾‹åŒ–æ‰€æœ‰éæ‡’åŠ è½½ Beanï¼Œå®Œæˆä¾èµ–æ³¨å…¥ã€åˆå§‹åŒ–æ–¹æ³•ï¼ˆ@PostConstructï¼‰æ‰§è¡Œ")

classDef leftAlign text-align:left;
class A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,S,Y,Z leftAlign;

</code></pre>
<h4 data-id="heading-10">å…³é”®è¡¥å……è¯´æ˜</h4>
<ul>
<li>è‡ªåŠ¨é…ç½®æ ¸å¿ƒï¼š<code>@EnableAutoConfiguration</code> æ˜¯è‡ªåŠ¨é…ç½®çš„å…¥å£ï¼ŒSpring Boot é€šè¿‡ <code>spring-boot-autoconfigure</code> åŒ…ä¸­çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œå®ç° â€œæŒ‰éœ€åŠ è½½â€ï¼ˆå¦‚å¼•å…¥ redis ä¾èµ–åˆ™è‡ªåŠ¨é…ç½® RedisTemplateï¼‰ï¼›</li>
<li>æ‰«æèŒƒå›´ï¼šé»˜è®¤æ‰«æå¯åŠ¨ç±»æ‰€åœ¨åŒ…åŠå…¶å­åŒ…ï¼Œå¯é€šè¿‡ <code>@ComponentScan</code> æŒ‡å®šè‡ªå®šä¹‰æ‰«æèŒƒå›´ï¼›</li>
<li>æ ¸å¿ƒç›®çš„ï¼šæ„å»ºå®Œæ•´çš„ IoC å®¹å™¨ï¼Œç®¡ç†æ‰€æœ‰ Bean çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¸ºåº”ç”¨æä¾›ä¾èµ–æ³¨å…¥ã€AOP ç­‰æ ¸å¿ƒèƒ½åŠ›ã€‚</li>
</ul>
<h3 data-id="heading-11">2.4 å¯åŠ¨åµŒå…¥å¼ Tomcatï¼šåˆå§‹åŒ– Web æœåŠ¡å™¨ï¼Œå¯¹å¤–æä¾›æœåŠ¡</h3>
<p>å¯¹äº Web åº”ç”¨ï¼ˆå¼•å…¥ <code>spring-boot-starter-web</code>ï¼‰ï¼ŒSpring Boot ä¼šè‡ªåŠ¨å¯åŠ¨åµŒå…¥å¼ Tomcatï¼ˆé»˜è®¤ï¼‰ï¼Œæ ¸å¿ƒé€»è¾‘åœ¨ <code>ServletWebServerApplicationContext</code> çš„ <code>onRefresh</code> æ–¹æ³•ä¸­ï¼Œå®ŒæˆæœåŠ¡å™¨åˆ›å»ºã€Servlet/Filter ç»‘å®šã€ç«¯å£ç›‘å¬ç­‰æ“ä½œã€‚</p>
<h4 data-id="heading-12">è°ƒç”¨æµç¨‹</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">%%{init:"wrap": false, {"flowchart":{"wrappingWidth":2000}}}%%
graph TD
A("SpringApplication.run() å…¥å£æ–¹æ³•")--&gt;|åˆ›å»º SpringApplication å®ä¾‹| A1("new SpringApplication(primarySources)")
A1--&gt;|æ‰§è¡Œå¯åŠ¨é€»è¾‘| A2("application.run(args)")
A2--&gt;|åˆ›å»ºåº”ç”¨ä¸Šä¸‹æ–‡| B("createApplicationContext()")
B--&gt;|åˆå§‹åŒ– Web åº”ç”¨ä¸Šä¸‹æ–‡| C("context = new AnnotationConfigServletWebServerApplicationContext()")
C--&gt;|åˆ·æ–°ä¸Šä¸‹æ–‡|G("refreshContext(context)")
G--&gt;|å®¹å™¨åˆ·æ–°æ ¸å¿ƒæ–¹æ³•|H("context.refresh()")
H--&gt;|Web æœåŠ¡å™¨åˆå§‹åŒ–|I("onRefresh()&lt;br/&gt;ServletWebServerApplicationContext é‡å†™çš„åˆ·æ–°æ–¹æ³•ï¼Œä¸“ç”¨äº Web æœåŠ¡å™¨å¯åŠ¨")
I--&gt;|åˆ›å»º Tomcat å®ä¾‹|J("createWebServer()&lt;br/&gt;1. æ ¹æ® server.port ç­‰é…ç½®åˆ›å»º Tomcat å®ä¾‹ï¼›&lt;br/&gt;2. é…ç½® Tomcat åŸºç¡€è·¯å¾„ã€è¿æ¥å™¨ï¼ˆConnectorï¼‰ã€å¼•æ“ï¼ˆEngineï¼‰ç­‰æ ¸å¿ƒç»„ä»¶ï¼›&lt;br/&gt;3. ç»‘å®šä¸Šä¸‹æ–‡è·¯å¾„ï¼ˆserver.servlet.context-pathï¼‰")
J--&gt;|ç»‘å®š Servlet/Filter ç­‰ç»„ä»¶|L("getSelfInitializer()&lt;br/&gt;1. ä» IoC å®¹å™¨ä¸­è·å–æ‰€æœ‰ ServletContextInitializer å®ç°ç±»ï¼ˆå¦‚ DispatcherServletRegistrationBeanï¼‰ï¼›&lt;br/&gt;2. æ‰«æå®¹å™¨ä¸­çš„ @Servlet/@Filter æ³¨è§£ç»„ä»¶ï¼Œå°è£…ä¸º ServletContextInitializer å®ç°ç±»ï¼›&lt;br/&gt;3. Tomcat åˆ›å»º ServletContext æ—¶ï¼Œæ‰§è¡Œè¿™äº› Initializerï¼Œå®Œæˆ DispatcherServletã€Filter ç­‰ç»„ä»¶çš„æ³¨å†Œ")
L--&gt;|å¯åŠ¨ Tomcat æœåŠ¡å™¨|K("finishRefresh()&lt;br/&gt;1. è°ƒç”¨ Tomcat.start() å¯åŠ¨æœåŠ¡å™¨ï¼›&lt;br/&gt;2. ç»‘å®šç«¯å£ç›‘å¬ï¼Œç­‰å¾…å®¢æˆ·ç«¯è¯·æ±‚ï¼›&lt;br/&gt;3. å‘å¸ƒ ApplicationStartedEvent äº‹ä»¶ï¼Œæ ‡è¯†åº”ç”¨å¯åŠ¨å®Œæˆ")


classDef leftAlign text-align:left;
class A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,S,Y,Z leftAlign;
</code></pre>
<h4 data-id="heading-13">å…³é”®è¡¥å……è¯´æ˜</h4>
<ul>
<li>æœåŠ¡å™¨åˆ‡æ¢ï¼šè‹¥éœ€å°† Tomcat æ›¿æ¢ä¸º Jetty/Undertowï¼Œåªéœ€æ’é™¤ <code>spring-boot-starter-tomcat</code> ä¾èµ–ï¼Œå¼•å…¥ <code>spring-boot-starter-jetty</code>/<code>spring-boot-starter-undertow</code>ï¼›</li>
<li>æ ¸å¿ƒç»„ä»¶ï¼šDispatcherServlet æ˜¯ Spring MVC çš„æ ¸å¿ƒ Servletï¼Œç”± <code>DispatcherServletAutoConfiguration</code> è‡ªåŠ¨é…ç½®ï¼Œè´Ÿè´£æ¥æ”¶å¹¶åˆ†å‘æ‰€æœ‰ Web è¯·æ±‚ï¼›</li>
<li>ç«¯å£é…ç½®ï¼šé»˜è®¤ç«¯å£ 8080ï¼Œå¯é€šè¿‡ <code>server.port</code> é…ç½®ï¼Œè‹¥é…ç½®ä¸º 0 åˆ™éšæœºåˆ†é…ç«¯å£ï¼›</li>
<li>æ ¸å¿ƒç›®çš„ï¼šå¯åŠ¨åµŒå…¥å¼ Web æœåŠ¡å™¨ï¼Œå°† Spring MVC æ ¸å¿ƒç»„ä»¶ç»‘å®šåˆ°æœåŠ¡å™¨ï¼Œå¯¹å¤–æä¾› HTTP æœåŠ¡ã€‚</li>
</ul>
<h2 data-id="heading-14">ä¸‰ã€å¯åŠ¨æµç¨‹æ•´ä½“æ—¶åºæ€»ç»“</h2>
<p>Spring Boot å¯åŠ¨æµç¨‹çš„æ ¸å¿ƒæ—¶åºå¯æ¦‚æ‹¬ä¸ºï¼š</p>
<pre><code class="hljs language-scss" lang="scss">SpringApplication<span class="hljs-selector-class">.run</span>()
â†’ åˆå§‹åŒ–ç›‘å¬å™¨ï¼ˆåŠ è½½ LoggingApplicationListener/ConfigFileApplicationListenerï¼‰
â†’ å‘å¸ƒ ApplicationStartingEventï¼ˆåˆå§‹åŒ–æ—¥å¿—ï¼‰
â†’ å‡†å¤‡ç¯å¢ƒï¼ˆåŠ è½½é…ç½®æ–‡ä»¶ï¼Œæ„å»º Environmentï¼‰
â†’ åˆ›å»º IoC å®¹å™¨ï¼ˆAnnotationConfigServletWebServerApplicationContextï¼‰
â†’ æ³¨å†Œ ConfigurationClassPostProcessorï¼ˆè§£æ Bean å®šä¹‰ï¼‰
â†’ åˆ·æ–°å®¹å™¨ï¼ˆ<span class="hljs-built_in">refresh</span>()ï¼‰
 â†’ æ‰§è¡Œ BeanFactory åç½®å¤„ç†å™¨ï¼ˆæ‰«æå¹¶æ³¨å†Œ Beanï¼‰
 â†’ å®ä¾‹åŒ– Beanï¼ˆå®Œæˆä¾èµ–æ³¨å…¥ï¼‰
 â†’ åˆå§‹åŒ– Web æœåŠ¡å™¨ï¼ˆåˆ›å»ºå¹¶å¯åŠ¨ Tomcatï¼‰
â†’ å‘å¸ƒ ApplicationStartedEventï¼ˆå¯åŠ¨å®Œæˆï¼‰
</code></pre>
<h2 data-id="heading-15">å››ã€æ ¸å¿ƒæ€»ç»“</h2>
<p>Spring Boot å¯åŠ¨æµç¨‹çš„æœ¬è´¨æ˜¯ â€œé€šè¿‡ç›‘å¬å™¨æœºåˆ¶å®Œæˆç¯å¢ƒå‡†å¤‡ï¼Œé€šè¿‡åç½®å¤„ç†å™¨å®Œæˆ Bean å®¹å™¨åˆå§‹åŒ–ï¼Œé€šè¿‡ Web åº”ç”¨ä¸Šä¸‹æ–‡å®ŒæˆåµŒå…¥å¼æœåŠ¡å™¨å¯åŠ¨â€ï¼Œå…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äºï¼š</p>
<ol>
<li>è‡ªåŠ¨åŒ–ï¼šé€šè¿‡ <code>spring.factories</code>/ è‡ªåŠ¨é…ç½®ç±»ï¼Œå®ç° â€œæŒ‰éœ€åŠ è½½â€ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®æ ¸å¿ƒç»„ä»¶ï¼›</li>
<li>æ ‡å‡†åŒ–ï¼šå›ºå®šçš„å¯åŠ¨æµç¨‹ç¡®ä¿åº”ç”¨å¼€å‘çš„ä¸€è‡´æ€§ï¼Œé™ä½é…ç½®æˆæœ¬ï¼›</li>
<li>å¯æ‰©å±•ï¼šé€šè¿‡è‡ªå®šä¹‰ <code>ApplicationListener</code>/<code>EnvironmentPostProcessor</code>/<code>BeanFactoryPostProcessor</code>ï¼Œå¯çµæ´»æ‰©å±•å¯åŠ¨é€»è¾‘ã€‚
ç†è§£ä¸Šè¿°æµç¨‹ï¼Œä¸ä»…èƒ½å¸®åŠ©å¼€å‘è€…å®šä½å¯åŠ¨è¿‡ç¨‹ä¸­çš„å¼‚å¸¸ï¼ˆå¦‚é…ç½®åŠ è½½å¤±è´¥ã€Bean å†²çªã€ç«¯å£å ç”¨ï¼‰ï¼Œä¹Ÿèƒ½ä¸ºè‡ªå®šä¹‰ Spring Boot Starterã€æ‰©å±•æ¡†æ¶èƒ½åŠ›æä¾›åº•å±‚æ”¯æ’‘ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é‡ç£…ç¦åˆ©ï¼ŒTRAE å›½é™…ç‰ˆå…¨éƒ¨ç”¨æˆ·é™å…ä¸€ä¸ªæœˆï¼]]></title>    <link>https://juejin.cn/post/7595868336595255315</link>    <guid>https://juejin.cn/post/7595868336595255315</guid>    <pubDate>2026-01-17T08:11:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595868336595255315" data-draft-id="7595868336595238931" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é‡ç£…ç¦åˆ©ï¼ŒTRAE å›½é™…ç‰ˆå…¨éƒ¨ç”¨æˆ·é™å…ä¸€ä¸ªæœˆï¼"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-17T08:11:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¿½é€æ—¶å…‰è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2770425031690333"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é‡ç£…ç¦åˆ©ï¼ŒTRAE å›½é™…ç‰ˆå…¨éƒ¨ç”¨æˆ·é™å…ä¸€ä¸ªæœˆï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2770425031690333/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¿½é€æ—¶å…‰è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T08:11:51.000Z" title="Sat Jan 17 2026 08:11:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å¥½æ¶ˆæ¯ï¼ŒTRAE å®˜æ–¹å®£å¸ƒä¸ºåº†ç¥ä¸Šçº¿ä¸€å‘¨å¹´ TRAE å›½é™…ç‰ˆå…¨éƒ¨ç”¨æˆ·é™å…ä¸€ä¸ªæœˆï¼å³ä» 2026 å¹´ 1 æœˆ 14 æ—¥ 10:00 èµ·ï¼ŒTRAE å›½é™…ç‰ˆå…¨éƒ¨ç”¨æˆ·èµ é€ Fast Request æƒç›Šï¼ˆä¸å°‘äº 1 ä¸ªæœˆ Pro ä¼šå‘˜çš„ç”¨é‡ï¼‰ï¼</p>
<ul>
<li><strong>Free ç”¨æˆ·ï¼š</strong> è´¦å·å¢åŠ  600 æ¬¡ Fast Requestï¼Œæœ‰æ•ˆæœŸè‡³åŒ—äº¬æ—¶é—´ 2 æœˆ 14 æ—¥ 10:00</li>
<li><strong>Pro ç”¨æˆ·ï¼š</strong> è´¦å·å¢åŠ  800 æ¬¡ Fast Requestï¼Œæœ‰æ•ˆæœŸè‡³åŒ—äº¬æ—¶é—´ 3 æœˆ 14 æ—¥ 10:00</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2e56f08d087e492da9044f2b13a0ec1a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769242310&amp;x-signature=Ua1SWt4bz1cULKkCGOOUvSigNV0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯ TRAEï¼Ÿ</h2>
<p>TRAE æ˜¯å­—èŠ‚è·³åŠ¨å®˜æ–¹æ¨å‡ºçš„ AI åŸç”Ÿ IDEï¼Œæ·±åº¦èåˆ AI èƒ½åŠ›ï¼Œæ˜¯ä¸€åèƒ½å¤Ÿç†è§£éœ€æ±‚ã€è°ƒç”¨å·¥å…·å¹¶ç‹¬ç«‹å®Œæˆå„ç±»å¼€å‘ä»»åŠ¡çš„â€œAI å¼€å‘å·¥ç¨‹å¸ˆâ€ï¼Œå¸®åŠ©ä½ é«˜æ•ˆæ¨è¿›æ¯ä¸€ä¸ªé¡¹ç›®ã€‚</p>
<h2 data-id="heading-2">ä¸»è¦åŠŸèƒ½</h2>
<p>TRAE è¦†ç›–ä»ç¼–ç ã€è°ƒè¯•åˆ°æµ‹è¯•ã€é‡æ„ã€éƒ¨ç½²ç­‰å¤šç±»å¼€å‘ä»»åŠ¡ã€‚æä¾›æ™ºèƒ½ä½“ç¼–ç¨‹å·¥å…· CUEï¼Œæ”¯æŒä»£ç è¡¥å…¨ã€å¤šè¡Œä¿®æ”¹ã€æ™ºèƒ½å¯¼å…¥å’Œæ™ºèƒ½é‡å‘½åç­‰åŠŸèƒ½ï¼Œé€‚é…å¤šç§æ—¥å¸¸å¼€å‘åœºæ™¯ï¼Œå¸®åŠ©ä½ å‡å°‘é‡å¤æ“ä½œï¼Œä¸“æ³¨æ ¸å¿ƒåˆ›æ–°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd67b575590943db9c969abde712eea8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769242310&amp;x-signature=YQMNr%2BSFRu%2F%2Bl5VVnn%2FWTyCHbYQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3">TRAE å†…ç½® Al Coding æ™ºèƒ½ä½“</h2>
<p>TRAE å†…ç½®çš„ SOLO æ¨¡å¼ï¼Œé…å¤‡ä¸“å± Coding Agentï¼Œå¯ç†è§£ç›®æ ‡ã€è§„åˆ’ä»»åŠ¡å¹¶è°ƒåº¦å·¥å…·ï¼Œç‹¬ç«‹æ¨è¿›å„é˜¶æ®µå¼€å‘å·¥ä½œã€‚ä»è‡ªç„¶è¯­è¨€è¾“å…¥åˆ°å¯æ‰§è¡Œäº§å‡ºï¼Œå¸®åŠ©ä½ é«˜æ•ˆå®Œæˆå¼€å‘ä»»åŠ¡ã€‚</p>
<ul>
<li><strong>SOLO Coderï¼š</strong> é¢å‘å¤æ‚é¡¹ç›®å¼€å‘çš„æ™ºèƒ½ä½“ã€‚SOLO Coder èƒ½å¤ŸåŠ©åŠ›ä½ é«˜æ•ˆå®Œæˆä»éœ€æ±‚è¿­ä»£åˆ°æ¶æ„é‡æ„çš„å…¨æµç¨‹å¼€å‘å·¥ä½œã€‚</li>
<li><strong>SOLO Builderï¼š</strong> å¿«é€Ÿæ„å»ºä¸“ä¸šä¸”åŠŸèƒ½å®Œå–„çš„ Web åº”ç”¨ã€‚ä½ åªéœ€ç”¨è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚ï¼ŒSOLO Builder ä¾¿ä¼šè‡ªåŠ¨æ ¹æ®ä»»åŠ¡é€‰æ‹©æœ€åˆé€‚çš„ AI æ¨¡å‹ã€åˆ†æéœ€æ±‚ã€ç”Ÿæˆ PRDã€ç¼–å†™ä»£ç ï¼Œå¹¶äº§å‡ºå¯é¢„è§ˆæˆæœã€‚</li>
</ul>
<h2 data-id="heading-4">é¢†å–é™æ—¶æƒç›ŠåŒ…</h2>
<ul>
<li>é¢†å–åœ°å€ï¼š<a href="https://www.trae.ai/2026-anniversary-gift" target="_blank" title="https://www.trae.ai/2026-anniversary-gift" ref="nofollow noopener noreferrer">www.trae.ai/2026-anniveâ€¦</a></li>
</ul>
<p><strong>æˆ–è€…æ‰“å¼€ TRAE ç›´æ¥è°ƒæ•´é¢†å–ï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/079f632d3f1b421587d02b83728d1782~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769242310&amp;x-signature=N0IHyrSvj9QlN9wDAG9NlShKI%2Bk%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27d2f06ac0f94919b43e8f056855047b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769242310&amp;x-signature=6ZCBUxVNyoQ3Cmce10mdUa1PZak%3D" alt="" loading="lazy"/></p>
<p><strong>é¢†å–æˆåŠŸï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/81a460a6f77d4ca29f3fd1f2e85cff34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769242310&amp;x-signature=b5d%2BvQbmwFoO%2BC4wu8sChPr67IM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">TRAE å›½é™…ç‰ˆä¸‹è½½å®‰è£…</h2>
<ul>
<li>ä¸‹è½½åœ°å€ï¼š<a href="https://www.trae.ai/" target="_blank" title="https://www.trae.ai/" ref="nofollow noopener noreferrer">www.trae.ai/</a></li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff5dc7bb8c8b4ced8187a52ac96872b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769242310&amp;x-signature=5uNrBOx%2BhT0OD0xQKoh0zOHc%2FJI%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/09e8bc5c7f0440a08cc8c225add16831~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769242310&amp;x-signature=S1FjzZZlJk6j2P0Ky2OLeDicX7A%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8541247833df43b6b85a65e834709ab3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769242310&amp;x-signature=LzqlEasXsZ4WFzkJ%2F8mTJaBgo%2BQ%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64c96e4402e34e069bb4091d1f68e422~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769242310&amp;x-signature=o2JYLLK%2FTqdK5IahJO%2BJ0kVtNdg%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/88b31830cd6d4f809cc9b6ed7bb2c779~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769242310&amp;x-signature=MplGuNksk5RQflq%2BjAtxXlyjkFs%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4d067f8f230b4f628cf988b47cdda2db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769242310&amp;x-signature=5Osd7nwzu7Sn1sAIMvB%2Bn%2FeTiwc%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9f9a9348f0d41db8861d733268a1491~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769242310&amp;x-signature=vweUe9khmcAdAT6s56UyU7vnGXQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-6">TRAE å¼€å‘è€…ç¤¾åŒº</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Flcnziv86vkx6.feishu.cn%2Fwiki%2FGEEnwlfTQi8qZrkFsPycfkUKnul" target="_blank" title="https://lcnziv86vkx6.feishu.cn/wiki/GEEnwlfTQi8qZrkFsPycfkUKnul" ref="nofollow noopener noreferrer">lcnziv86vkx6.feishu.cn/wiki/GEEnwlâ€¦</a></li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/815c0911ad4347c58d3745b8a414d5fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769242310&amp;x-signature=mtAwKEQWSxIC7%2ByYH%2Bq24YzUGt8%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">TRAE å®˜æ–¹æ–‡æ¡£</h2>
<ul>
<li><a href="https://docs.trae.ai/ide/what-is-trae?_lang=zh" target="_blank" title="https://docs.trae.ai/ide/what-is-trae?_lang=zh" ref="nofollow noopener noreferrer">docs.trae.ai/ide/what-isâ€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026æœ€æ–°AIæ¨¡å‹æ¨ªè¯„ï¼šè°æ‰æ˜¯ä½ çš„æœ€å¼ºâ€œå·¥ä½œæ­å­â€ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7595831738234519561</link>    <guid>https://juejin.cn/post/7595831738234519561</guid>    <pubDate>2026-01-17T08:25:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595831738234519561" data-draft-id="7595841630677205043" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" 2026æœ€æ–°AIæ¨¡å‹æ¨ªè¯„ï¼šè°æ‰æ˜¯ä½ çš„æœ€å¼ºâ€œå·¥ä½œæ­å­â€ï¼Ÿ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-17T08:25:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Javaä¸­æ–‡ç¤¾ç¾¤"/> <meta itemprop="url" content="https://juejin.cn/user/61228381386487"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             2026æœ€æ–°AIæ¨¡å‹æ¨ªè¯„ï¼šè°æ‰æ˜¯ä½ çš„æœ€å¼ºâ€œå·¥ä½œæ­å­â€ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/61228381386487/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Javaä¸­æ–‡ç¤¾ç¾¤
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T08:25:22.000Z" title="Sat Jan 17 2026 08:25:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>AI æ—¶ä»£ï¼Œæœ€ç—›è‹¦çš„ä¸æ˜¯æ²¡æœ‰å·¥å…·ï¼Œè€Œæ˜¯<strong>å·¥å…·å¤ªå¤šï¼Œæ ¹æœ¬ä¸çŸ¥é“é€‰å“ªä¸ª</strong>ï¼</p>
<p>ä¸€è¾¹æ˜¯ <strong>ChatGPTã€Claude</strong> ç­‰å›½å¤–è€ç‰Œéœ¸ä¸»ï¼Œä¸€è¾¹æ˜¯ <strong>DeepSeekã€Kimiã€é€šä¹‰åƒé—®</strong> ç­‰å›½äº§æ–°è´µå¼ºåŠ¿å´›èµ·ã€‚ç©¶ç«Ÿæ˜¯â€œå¤–æ¥çš„å’Œå°šå¥½å¿µç»â€ï¼Œè¿˜æ˜¯â€œå›½äº§ä¹‹å…‰â€æ›´æ‡‚ä¸­å›½å¿ƒï¼Ÿ</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å®æµ‹äº†ç›®å‰å¸‚é¢ä¸Šæœ€ç«çš„ 8 æ¬¾å¤§æ¨¡å‹ï¼Œä»<strong>é€»è¾‘æ¨ç†ã€é•¿æ–‡æœ¬å¤„ç†ã€ä»£ç èƒ½åŠ›ã€æ—¥å¸¸äº¤äº’</strong>ç­‰ç»´åº¦ï¼Œä¸ºä½ é€ä¸Šä¸€ä»½<strong>ä¿å§†çº§é€‰å‹æŒ‡å—</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-0">ğŸ¬ è§†é¢‘æ¼”ç¤º</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1HkrUBVEpn%2F" target="_blank" title="https://www.bilibili.com/video/BV1HkrUBVEpn/" ref="nofollow noopener noreferrer">www.bilibili.com/video/BV1Hkâ€¦</a></p>
<hr/>
<h2 data-id="heading-1">ç¬¬ä¸€æ¢¯é˜Ÿï¼šå›½é™…â€œä¸‰å·¨å¤´â€</h2>
<p>å¦‚æœä½ èƒ½è§£å†³ç½‘ç»œé—¨æ§›é—®é¢˜ï¼Œè¿™ä¸‰ä½ä¾ç„¶ä»£è¡¨ç€<strong>ç›®å‰ AI æ™ºåŠ›çš„â€œå¤©èŠ±æ¿â€</strong>ã€‚</p>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5a0f42aeef343f2a576ad110266b43d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YeS4reaWh-ekvue-pA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769243121&amp;x-signature=3wmhMPqJyYR0zHNwO0HsRu26UV8%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">1. ChatGPT (OpenAI) â€”â€” â€œå…­è¾¹å½¢æˆ˜å£«â€</h3>
<p><strong>ğŸ‘‘ åœ°ä½ï¼š</strong> è¡Œä¸šæ ‡æ†ï¼Œæ‰€æœ‰æ¨¡å‹çš„æ¨¡ä»¿å¯¹è±¡ã€‚</p>
<ul>
<li><strong>ğŸ”¥ æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong>
<ul>
<li><strong>ç»¼åˆèƒ½åŠ›æœ€å¼ºï¼š</strong> æ— è®ºæ˜¯å†™è¯—ã€å†™ä»£ç è¿˜æ˜¯é€»è¾‘æ¨ç†ï¼ŒGPT å‡ ä¹æ²¡æœ‰çŸ­æ¿ã€‚</li>
<li><strong>ç”Ÿæ€æ— æ•Œï¼š</strong> æ‹¥æœ‰æµ·é‡çš„ GPTsï¼ˆæ’ä»¶ï¼‰ï¼Œå¯ä»¥ç”»å›¾ã€æ•°æ®åˆ†æã€è”ç½‘æœç´¢ï¼Œä¸€ç«™å¼æå®šã€‚</li>
<li><strong>è¯­éŸ³æ¨¡å¼ï¼š</strong> å®ƒçš„å®æ—¶è¯­éŸ³å¯¹è¯æµç•…åº¦ï¼Œç›®å‰ä»æ˜¯ç‹¬ä¸€æ¡£çš„å­˜åœ¨ã€‚</li>
</ul>
</li>
<li><strong>ğŸ’” ç¼ºç‚¹ï¼š</strong>
<ul>
<li>è®¢é˜…è´¹ç”¨è´µï¼ˆ20 ç¾å…ƒ/æœˆï¼‰ã€‚</li>
<li>å›½å†…è®¿é—®é—¨æ§›é«˜ï¼Œè´¦å·å®¹æ˜“è¢«å°ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-3">2. Claude (Anthropic) â€”â€” â€œä¸ä»…æ˜¯æ–‡ç§‘ç”Ÿï¼Œæ›´æ˜¯ç¨‹åºå‘˜â€</h3>
<p><strong>ğŸ¦„ åœ°ä½ï¼š</strong> æœ€åƒâ€œäººâ€çš„ AIï¼ŒChatGPT æœ€å¼ºçš„ç«äº‰å¯¹æ‰‹ã€‚</p>
<ul>
<li><strong>ğŸ”¥ æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong>
<ul>
<li><strong>æ‹ŸäººåŒ–æœ€é«˜ï¼š</strong> å†™å‡ºæ¥çš„æ–‡ç« ä¸ä»…é€»è¾‘é€šé¡ºï¼Œè€Œä¸”æ–‡ç¬”ä¼˜ç¾ï¼Œæ²¡æœ‰â€œAI å‘³â€ï¼Œéå¸¸é€‚åˆå…¬æ–‡å†™ä½œã€é‚®ä»¶æ¶¦è‰²ã€‚</li>
<li><strong>Artifacts åŠŸèƒ½ï¼š</strong> èƒ½å¤Ÿç›´æ¥åœ¨ä¾§è¾¹æ é¢„è§ˆä»£ç æ•ˆæœï¼ˆå¦‚ç½‘é¡µã€å›¾è¡¨ï¼‰ï¼Œæ˜¯å‰ç«¯ç¨‹åºå‘˜å’Œæ•°æ®åˆ†æå¸ˆçš„æœ€çˆ±ã€‚</li>
<li><strong>è¶…å¤§ä¸Šä¸‹æ–‡ï¼š</strong> èƒ½å¤Ÿä¸€æ¬¡æ€§åƒé€æ•´æœ¬ä¹¦çš„å†…å®¹ã€‚</li>
</ul>
</li>
<li><strong>ğŸ’” ç¼ºç‚¹ï¼š</strong>
<ul>
<li><strong>é£æ§æä¸¥ï¼š</strong> ç¨å¾®èŠç‚¹æ•æ„Ÿè¯é¢˜ï¼ˆç”šè‡³åªæ˜¯ä¸ºäº†å‰§æƒ…éœ€è¦ï¼‰å°±ä¼šæ‹’ç»å›ç­”ã€‚</li>
<li>å…è´¹ç‰ˆé™åˆ¶æ¬¡æ•°è¾ƒå¤šã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-4">3. Gemini (Google) â€”â€” â€œå…¨çŸ¥å…¨èƒ½çš„æ•°æ®æ€ªå…½â€</h3>
<p><strong>ğŸš€ åœ°ä½ï¼š</strong> Google ç”Ÿæ€çš„äº²å„¿å­ï¼Œæ‹¥æœ‰ç™¾ä¸‡çº§ä¸Šä¸‹æ–‡å¤„ç†èƒ½åŠ›ã€‚</p>
<ul>
<li><strong>ğŸ”¥ æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong>
<ul>
<li><strong>ç™¾ä¸‡ä¸Šä¸‹æ–‡çª—å£ï¼š</strong> Gemini 3 Pro å¯ä»¥ä¸€æ¬¡æ€§å¤„ç†æé•¿çš„è§†é¢‘ã€éŸ³é¢‘å’Œæ–‡æ¡£ï¼Œè¿™æ˜¯å®ƒçš„æ€æ‰‹é”ã€‚</li>
<li><strong>Google å…¨å®¶æ¡¶é›†æˆï¼š</strong> ç›´æ¥è°ƒç”¨ Google Docs, Gmail, Drive é‡Œçš„èµ„æ–™ï¼ŒåŠå…¬æ•ˆç‡æé«˜ã€‚</li>
<li><strong>å¤šæ¨¡æ€ç†è§£ï¼š</strong> æ‰”ç»™å®ƒä¸€æ®µè§†é¢‘ï¼Œå®ƒèƒ½ç²¾å‡†å‘Šè¯‰ä½ è§†é¢‘é‡Œå‘ç”Ÿäº†ä»€ä¹ˆã€‚</li>
</ul>
</li>
<li><strong>ğŸ’” ç¼ºç‚¹ï¼š</strong>
<ul>
<li>é€»è¾‘æ¨ç†å¶å°”ä¼šâ€œå¹»è§‰â€ï¼ˆä¸€æœ¬æ­£ç»èƒ¡è¯´å…«é“ï¼‰ã€‚</li>
<li>äº§å“çº¿æ”¹åé¢‘ç¹ï¼Œç”¨æˆ·å®¹æ˜“æ™•ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-5">ç¬¬äºŒæ¢¯é˜Ÿï¼šå›½äº§â€œäº”è™ä¸Šå°†â€</h2>
<p>å›½äº§æ¨¡å‹ä¸ä»…<strong>å…è´¹/ä¾¿å®œ</strong>ï¼Œè€Œä¸”<strong>æ›´æ‡‚ä¸­æ–‡è¯­å¢ƒ</strong>ï¼Œåœ¨æŸäº›å‚ç›´é¢†åŸŸç”šè‡³å·²ç»è¶…è¶Šäº† GPT-4ã€‚</p>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a37ce125bb94db59f4df998ccfd87ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YeS4reaWh-ekvue-pA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769243121&amp;x-signature=JICqUjU1aljvh7yKezpBsmCbkas%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-6">1. DeepSeek (æ·±åº¦æ±‚ç´¢) â€”â€” â€œç¡¬æ ¸ç†å·¥ç”·ï¼Œå›½äº§ä¹‹å…‰â€</h3>
<p><strong>âš¡ ç‰¹æ€§ï¼š</strong> å¼€æºç•Œçš„è‹±é›„ï¼Œä»£ç ä¸æ•°å­¦èƒ½åŠ›çš„ç‹è€…ã€‚</p>
<ul>
<li><strong>ğŸ‘ ä¼˜ç‚¹ï¼š</strong>
<ul>
<li><strong>ä»£ç /æ•°å­¦èƒ½åŠ›æå¼ºï¼š</strong> åœ¨ Coding é¢†åŸŸï¼ŒDeepSeek V3/R1 çš„è¡¨ç°ç›´é€¼ç”šè‡³è¶…è¶Š GPT-4ï¼Œæ·±å—ç¨‹åºå‘˜å–œçˆ±ã€‚</li>
<li><strong>å¼€æºç²¾ç¥ï¼š</strong> æ¨¡å‹æƒé‡å…¬å¼€ï¼Œä¸ä»… API æå…¶ä¾¿å®œï¼ˆå‡ ä¹æ˜¯ç™½èœä»·ï¼‰ï¼Œè¿˜èƒ½æœ¬åœ°éƒ¨ç½²ã€‚</li>
<li><strong>æ·±åº¦æ€è€ƒï¼š</strong> R1 ç‰ˆæœ¬å¼•å…¥äº†ç±»ä¼¼ o1 çš„æ·±åº¦æ€è€ƒé“¾ï¼Œè§£å†³å¤æ‚é€»è¾‘é—®é¢˜èƒ½åŠ›çˆ†è¡¨ã€‚</li>
</ul>
</li>
<li><strong>ğŸ‘ ç¼ºç‚¹ï¼š</strong>
<ul>
<li>ç”±äºå¤ªç«ï¼ŒæœåŠ¡å™¨å¶å°”ä¼šå´©ã€‚</li>
<li>æ–‡æ¡ˆå†™ä½œç•¥æ˜¾ç”Ÿç¡¬ï¼Œä¸å¦‚æ–‡ç§‘ç±»æ¨¡å‹ç»†è…»ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-7">2. Kimi (æœˆä¹‹æš—é¢) â€”â€” â€œé•¿æ–‡æœ¬é˜…è¯»ç¥å™¨â€</h3>
<p><strong>ğŸ“š ç‰¹æ€§ï¼š</strong> æœ€æ—©æ‰“å“â€œé•¿æ–‡æœ¬â€æ‹›ç‰Œçš„å›½äº§æ¨¡å‹ã€‚</p>
<ul>
<li><strong>ğŸ‘ ä¼˜ç‚¹ï¼š</strong>
<ul>
<li><strong>åƒé€ç ”æŠ¥/è®ºæ–‡ï¼š</strong> æ‰”ç»™å®ƒ 50 ä»½ PDFï¼Œå®ƒèƒ½è¿…é€Ÿå¸®ä½ æ€»ç»“æ ¸å¿ƒè§‚ç‚¹ï¼Œæ˜¯é‡‘èä»ä¸šè€…å’Œå­¦ç”Ÿå…šçš„æ•‘æ˜Ÿã€‚</li>
<li><strong>è”ç½‘æœç´¢ç²¾å‡†ï¼š</strong> å®ƒçš„æœç´¢å¼•ç”¨é“¾æ¥éå¸¸è§„èŒƒï¼Œå‡å°‘äº†èƒ¡ç¼–ä¹±é€ çš„æ¦‚ç‡ã€‚</li>
<li><strong>ç•Œé¢æ¸…çˆ½ï¼š</strong> UI è®¾è®¡ç®€æ´ï¼Œä¸ä»…å¥½ç”¨ï¼Œè€Œä¸”å¥½çœ‹ã€‚</li>
</ul>
</li>
<li><strong>ğŸ‘ ç¼ºç‚¹ï¼š</strong>
<ul>
<li>ç”Ÿæˆé•¿æ–‡æ—¶ï¼Œåˆ›æ„åº¦æœ‰æ—¶ç¨æ˜¾ä¸è¶³ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-8">3. é€šä¹‰åƒé—® (Qwen - é˜¿é‡Œå·´å·´) â€”â€” â€œå…¨èƒ½å®å¹²å®¶â€</h3>
<p><strong>ğŸ› ï¸ ç‰¹æ€§ï¼š</strong> é˜¿é‡ŒæŠ€æœ¯èƒŒä¹¦ï¼Œå¼€æºç”Ÿæ€æå…¶ä¸°å¯Œï¼Œå¹¶ä¸”æœ€æ–°çš„åƒé—® APP è¿˜<strong>å¯ä»¥å¸®ä½ è‡ªåŠ¨ç‚¹é¤</strong>ã€‚</p>
<ul>
<li><strong>ğŸ‘ ä¼˜ç‚¹ï¼š</strong>
<ul>
<li><strong>å›¾ç‰‡ç†è§£èƒ½åŠ›å¼ºï¼š</strong> è§†è§‰è¯†åˆ«ï¼ˆVisionï¼‰èƒ½åŠ›åœ¨å›½äº§æ¨¡å‹ä¸­æ•°ä¸€æ•°äºŒï¼Œèƒ½çœ‹æ‡‚å¤æ‚çš„å›¾è¡¨å’Œèœå•ã€‚</li>
<li><strong>æ–‡æ¡£å¤„ç†ï¼š</strong> è§£æ Wordã€Excel çš„èƒ½åŠ›éå¸¸ç¨³å®šã€‚</li>
<li><strong>ä¸ä»…æ˜¯èŠå¤©ï¼š</strong> èƒŒåæœ‰é€šä¹‰å¬æ‚Ÿï¼ˆåšä¼šè®®çºªè¦ï¼‰ç­‰ä¸€ç³»åˆ—åº”ç”¨æ”¯æŒã€‚</li>
</ul>
</li>
<li><strong>ğŸ‘ ç¼ºç‚¹ï¼š</strong>
<ul>
<li>æœ‰æ—¶å€™å›ç­”è¿‡äºâ€œå®˜æ–¹â€ï¼Œç¼ºä¹ä¸€ç‚¹ä¸ªæ€§ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-9">4. æ™ºè°±æ¸…è¨€ (ChatGLM) â€”â€” â€œæ•°æ®åˆ†æå¤§å¸ˆâ€</h3>
<p><strong>ğŸ“Š ç‰¹æ€§ï¼š</strong> æºè‡ªæ¸…åç³»ï¼Œå·¥å…·è°ƒç”¨èƒ½åŠ›å¼ºã€‚</p>
<ul>
<li><strong>ğŸ‘ ä¼˜ç‚¹ï¼š</strong>
<ul>
<li><strong>æ•°æ®åˆ†æï¼š</strong> å†…ç½®çš„ä»£ç è§£é‡Šå™¨éå¸¸å¼ºå¤§ï¼Œä¸Šä¼  Excel è¡¨æ ¼ï¼Œå®ƒèƒ½ç›´æ¥å¸®ä½ ç”»å‡ºå¯è§†åŒ–çš„å›¾è¡¨ï¼ˆæŸ±çŠ¶å›¾ã€çƒ­åŠ›å›¾ç­‰ï¼‰ã€‚</li>
<li><strong>GLM èƒ½åŠ›å‡è¡¡ï¼š</strong> ç»¼åˆç´ è´¨å¾ˆé«˜ï¼Œæ—¢èƒ½ç”»å›¾ï¼Œåˆèƒ½è”ç½‘ï¼Œè€Œä¸”<strong>æœ€æ–°çš„ GLM 4.7 ä»£ç èƒ½åŠ›ä¹Ÿä¸é”™</strong>ã€‚</li>
</ul>
</li>
<li><strong>ğŸ‘ ç¼ºç‚¹ï¼š</strong>
<ul>
<li>ç§»åŠ¨ç«¯ APP çš„ä½“éªŒå¶å°”æœ‰å¡é¡¿ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-10">5. è±†åŒ… (å­—èŠ‚è·³åŠ¨) â€”â€” â€œæœ€å¼ºè¯­éŸ³æ­å­â€</h3>
<p><strong>ğŸ§ ç‰¹æ€§ï¼š</strong> æ—¥æ´»æœ€é«˜çš„å›½äº§ AIï¼Œä¸»æ‰“ C ç«¯æ—¥å¸¸é™ªä¼´ã€‚</p>
<ul>
<li><strong>ğŸ‘ ä¼˜ç‚¹ï¼š</strong>
<ul>
<li><strong>è¯­éŸ³äº¤äº’æœ€è‡ªç„¶ï¼š</strong> å£°éŸ³æå…¶é€¼çœŸï¼Œæœ‰æƒ…ç»ªèµ·ä¼ï¼Œä¸åƒæœºå™¨äººåœ¨å¿µç¨¿ï¼Œéå¸¸é€‚åˆç»ƒå£è¯­æˆ–é—²èŠã€‚</li>
<li><strong>åŠŸèƒ½ä¸°å¯Œï¼š</strong> å†…ç½®äº†å„ç§â€œæ™ºèƒ½ä½“â€ï¼ˆå¦‚è‹±è¯­è€å¸ˆã€å°è¯´å†™æ‰‹ï¼‰ï¼Œç©æ³•å¾ˆå¤šã€‚</li>
<li><strong>å“åº”é€Ÿåº¦å¿«ï¼š</strong> å­—èŠ‚çš„æŠ€æœ¯ä¼˜åŒ–ï¼Œè®©å®ƒåœ¨æ‰‹æœºä¸Šç”¨èµ·æ¥éå¸¸ä¸æ»‘ã€‚</li>
</ul>
</li>
<li><strong>ğŸ‘ ç¼ºç‚¹ï¼š</strong>
<ul>
<li>å¤„ç†å¤æ‚é€»è¾‘å’Œç¡¬æ ¸ä»£ç ä»»åŠ¡æ—¶ï¼Œç›¸æ¯” DeepSeek ç¨å¼±ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-11">âš¡ æ€»ç»“ï¼šåˆ°åº•è¯¥é€‰å“ªä¸€ä¸ªï¼Ÿ</h2>
<p>ä¸ºäº†å¸®ä½ çœæ—¶é—´ï¼Œæˆ‘ç›´æ¥ç»™å‡º**â€œæŠ„ä½œä¸šâ€å»ºè®®**ï¼š</p>















































<table><thead><tr><th align="left">ä½ çš„éœ€æ±‚</th><th align="left"><strong>é¦–é€‰æ¨è (å›½å†…)</strong></th><th align="left"><strong>é¦–é€‰æ¨è (å›½å¤–)</strong></th><th align="left">ç†ç”±</th></tr></thead><tbody><tr><td align="left"><strong>å†™ä»£ç  / ææ•°å­¦</strong></td><td align="left"><strong>DeepSeek</strong></td><td align="left">Claude</td><td align="left">é€»è¾‘æœ€å¼ºï¼Œä¸å®¹æ˜“å†™å‡º Bugã€‚</td></tr><tr><td align="left"><strong>è¯»è®ºæ–‡ / çœ‹ç ”æŠ¥</strong></td><td align="left"><strong>Kimi</strong></td><td align="left">Gemini</td><td align="left">é•¿æ–‡æœ¬ååé‡å¤§ï¼Œæ€»ç»“ç²¾å‡†ã€‚</td></tr><tr><td align="left"><strong>å†™æ–‡ç«  / æ¶¦è‰²é‚®ä»¶</strong></td><td align="left"><strong>é€šä¹‰åƒé—® / Kimi</strong></td><td align="left">ChatGPT/Gemini</td><td align="left">æ–‡ç¬”è‡ªç„¶ï¼Œè¯»èµ·æ¥ä¸å°´å°¬ã€‚</td></tr><tr><td align="left"><strong>åšå›¾è¡¨ / æ•°æ®åˆ†æ</strong></td><td align="left"><strong>æ™ºè°±æ¸…è¨€</strong></td><td align="left">ChatGPT/Gemini</td><td align="left">ç›´æ¥å‡ºå›¾ï¼Œçœå» Excel æ“ä½œã€‚</td></tr><tr><td align="left"><strong>ç»ƒå£è¯­ / é—²èŠè§£é—·</strong></td><td align="left"><strong>è±†åŒ…</strong></td><td align="left">ChatGPT</td><td align="left">å£°éŸ³å¥½å¬ï¼Œååº”å¿«ï¼Œæƒ…å•†é«˜ã€‚</td></tr><tr><td align="left"><strong>ç»¼åˆåŠå…¬ / å•¥éƒ½å¹²</strong></td><td align="left"><strong>é€šä¹‰åƒé—® / DeepSeek</strong></td><td align="left">ChatGPT/Gemini</td><td align="left">å‡è¡¡å‘å±•ï¼Œä¹Ÿæ˜¯æœ€ç¨³çš„é€‰æ‹©ã€‚</td></tr></tbody></table>

<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b9069286cc1744dc8f2542336fc7de4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2YeS4reaWh-ekvue-pA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769243121&amp;x-signature=BzxMHgBq6p2btftOoqmEUf21vno%3D" alt="" loading="lazy"/><br/>
AI æ¨¡å‹æ›´æ–°é€Ÿåº¦æå¿«ï¼ˆæŒ‰å‘¨è®¡ç®—ï¼‰ã€‚å¦‚æœæ˜¯<strong>å·¥ä½œé‡åº¦ä½¿ç”¨</strong>ï¼Œå»ºè®®**â€œDeepSeek (é€»è¾‘) + Kimi (é˜…è¯»)â€**ç»„åˆä½¿ç”¨ï¼Œå®Œå…¨å…è´¹ä¸”æ•ˆç‡ç¿»å€ï¼›å¦‚æœæœ‰æ¡ä»¶ï¼Œ<strong>ChatGPT/Gemini</strong> ä¾ç„¶æ˜¯æ¢ç´¢ AI è¾¹ç•Œçš„æœ€ä½³çª—å£ã€‚</p>
<p>æ‹’ç»é€‰æ‹©å›°éš¾ç—‡ï¼Œç°åœ¨å°±å»æ‰“å¼€ä¸€ä¸ªè¯•è¯•å§ï¼</p>
<blockquote>
<p>æœ¬æ–‡å·²æ”¶å½•åˆ°æˆ‘çš„æŠ€æœ¯å°ç«™ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.javacn.site" target="_blank" title="https://www.javacn.site" ref="nofollow noopener noreferrer">www.javacn.site</a>ï¼Œç½‘ç«™åŒ…å«çš„å†…å®¹æœ‰ï¼š<strong>N8N/Coze/Dify/LangChain/SpringAI/SpringAIAlibaba/LangChain4j/AIå®æˆ˜é¡¹ç›®/AIå¸¸è§é¢è¯•é¢˜</strong>ç­‰æŠ€æœ¯åˆ†äº«ï¼Œæ¬¢è¿å„ä½å¤§ä½¬å…‰ä¸´æŒ‡å¯¼~</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¸¿è’™å¼‚æ­¥å¹¶å‘ async/await æœ€ä½³å®è·µï¼Œä»£ç ç¬é—´ä¼˜é›…]]></title>    <link>https://juejin.cn/post/7595527937832861750</link>    <guid>https://juejin.cn/post/7595527937832861750</guid>    <pubDate>2026-01-16T08:00:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595527937832861750" data-draft-id="7595552420047585323" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¸¿è’™å¼‚æ­¥å¹¶å‘ async/await æœ€ä½³å®è·µï¼Œä»£ç ç¬é—´ä¼˜é›…"/> <meta itemprop="keywords" content="HarmonyOS,ArkTS,ArkUI"/> <meta itemprop="datePublished" content="2026-01-16T08:00:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¨å“¥çˆ±ç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/2242659450109575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¸¿è’™å¼‚æ­¥å¹¶å‘ async/await æœ€ä½³å®è·µï¼Œä»£ç ç¬é—´ä¼˜é›…
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2242659450109575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¨å“¥çˆ±ç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T08:00:48.000Z" title="Fri Jan 16 2026 08:00:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Helloï¼Œå…„å¼Ÿä»¬ï¼Œæˆ‘æ˜¯ V å“¥ï¼</p>
<p>è¿˜è®°å¾—ä»¥å‰å†™ Android æˆ–è€…æ—©æœŸ JavaScript çš„æ—¶å€™ï¼Œé‚£ä¸ªä¼ è¯´ä¸­çš„**â€œå›è°ƒåœ°ç‹±â€**å—ï¼Ÿ</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼ªä»£ç æ¼”ç¤ºï¼šè®©äººå´©æºƒçš„é‡‘å­—å¡”</span>
<span class="hljs-title function_">login</span>(user, <span class="hljs-function">(<span class="hljs-params">res1</span>) =&gt;</span> {
  <span class="hljs-title function_">getUserInfo</span>(res1.<span class="hljs-property">id</span>, <span class="hljs-function">(<span class="hljs-params">res2</span>) =&gt;</span> {
    <span class="hljs-title function_">getOrders</span>(res2.<span class="hljs-property">token</span>, <span class="hljs-function">(<span class="hljs-params">res3</span>) =&gt;</span> {
      <span class="hljs-title function_">getDetail</span>(res3.<span class="hljs-property">orderId</span>, <span class="hljs-function">(<span class="hljs-params">res4</span>) =&gt;</span> {
        <span class="hljs-comment">// ç»ˆäºç»“æŸäº†... ä»£ç å·²ç»ç¼©è¿›åˆ°å±å¹•å¤–è¾¹äº†</span>
      })
    })
  })
})
</code></pre>
<p>è¿™ç§ä»£ç ï¼Œç»´æŠ¤èµ·æ¥ç®€ç›´æ˜¯å™©æ¢¦ï¼ä½†åœ¨é¸¿è’™ ArkTS çš„ API 21 ç¯å¢ƒä¸‹ï¼Œå…„å¼Ÿä»¬åƒä¸‡åˆ«å†è¿™ä¹ˆå†™äº†ï¼ArkTS æ˜¯åŸºäº TypeScript çš„ï¼Œå®ƒåŸç”Ÿæ”¯æŒéå¸¸å¼ºå¤§çš„ <strong><code>async/await</code></strong> è¯­æ³•ã€‚</p>
<p>ä»Šå¤© V å“¥å°±å¸¦ä½ æŠŠè¿™æ®µâ€œé‡‘å­—å¡”â€æ‹å¹³ï¼Œç”¨ <strong>åŒæ­¥çš„é€»è¾‘å†™å¼‚æ­¥çš„ä»£ç </strong>ï¼Œä¼˜é›…å¾—åƒå–ä¸‹åˆèŒ¶ä¸€æ ·ï¼</p>
<hr/>
<h2 data-id="heading-0">æ ¸å¿ƒå¿ƒæ³•ï¼šæŠŠâ€œç­‰å¾…â€å˜æˆâ€œæš‚åœâ€</h2>
<p>å…„å¼Ÿä»¬ï¼Œè®°ä½ V å“¥è¿™ä¸¤ä¸ªå£è¯€ï¼š</p>
<ol>
<li><strong><code>async</code></strong>ï¼šåŠ åœ¨å‡½æ•°å®šä¹‰å‰é¢ï¼Œè¡¨ç¤ºâ€œè¿™é‡Œé¢æœ‰è€—æ—¶çš„æ´»å„¿â€ã€‚</li>
<li><strong><code>await</code></strong>ï¼šåŠ åœ¨è€—æ—¶çš„è°ƒç”¨å‰é¢ï¼Œè¡¨ç¤ºâ€œ<strong>ç­‰ç€è¿™å„¿å¹²å®Œï¼Œå†å»å¹²ä¸‹ä¸€è¡Œï¼Œä½†åˆ«æŠŠç•Œé¢å¡æ­»</strong>â€ã€‚</li>
</ol>
<p>æœ‰äº†è¿™ä¸¤ä¸ªç¥å™¨ï¼Œå¼‚æ­¥ä»£ç å†™å‡ºæ¥å°±åƒåœ¨å†™å°å­¦ä½œæ–‡ï¼Œä»ä¸Šåˆ°ä¸‹ï¼Œä¸€è¡Œä¸€è¡Œè¯»ï¼Œé€»è¾‘æ¸…æ™°æ— æ¯”ã€‚</p>
<hr/>
<h2 data-id="heading-1">å®æˆ˜ä»£ç æ¡ˆä¾‹</h2>
<p>ä¸ºäº†è®©å¤§å®¶ç›´è§‚æ„Ÿå—ï¼ŒV å“¥å†™äº†ä¸€ä¸ªå®Œæ•´çš„ Demoã€‚å’±ä»¬æ¨¡æ‹Ÿä¸‰ä¸ªå¸¸è§çš„çœŸå®åœºæ™¯ï¼š</p>
<ol>
<li><strong>ä¸²è¡Œæ‰§è¡Œ</strong>ï¼šå…ˆç™»å½•ï¼Œå†æ‹¿ç”¨æˆ·ä¿¡æ¯ã€‚</li>
<li><strong>å¹¶å‘æ‰§è¡Œ</strong>ï¼šåŒæ—¶æ‹‰å–â€œå¹¿å‘Šé…ç½®â€å’Œâ€œé¦–é¡µæ¨èâ€ã€‚</li>
<li><strong>å¼‚å¸¸å¤„ç†</strong>ï¼šä¼˜é›…åœ°æ•è·ç½‘ç»œé”™è¯¯ã€‚</li>
</ol>
<p><strong>æ“ä½œæ­¥éª¤ï¼š</strong> æ‰“å¼€ä½ çš„ DevEco Studio 6.0ï¼Œæ–°å»ºä¸€ä¸ª ArkTS é¡µé¢ï¼ŒæŠŠä¸‹é¢çš„ä»£ç å®Œæ•´å¤åˆ¶è¿›å»ï¼Œç›´æ¥è¿è¡Œï¼</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> promptAction <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.promptAction'</span>;

<span class="hljs-comment">/**
 * Vå“¥çš„æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚ç±»
 * åœ¨çœŸå®é¡¹ç›®ä¸­ï¼Œè¿™é‡Œä¼šæ¢æˆ httpRequest æˆ–è€… ç½‘ç»œåº“
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">NetworkSimulator</span> {
  <span class="hljs-comment">// æ¨¡æ‹Ÿä¸€ä¸ªå¼‚æ­¥è€—æ—¶æ“ä½œï¼Œè¿”å› Promise</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">request</span>(<span class="hljs-attr">apiName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">data</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">delay</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// æ¨¡æ‹Ÿ 20% çš„æ¦‚ç‡å¤±è´¥</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &lt; <span class="hljs-number">0.2</span>) {
          <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`<span class="hljs-subst">${apiName}</span> è¯·æ±‚å¤±è´¥ï¼Œç½‘ç»œä¸ç»™åŠ›ï¼`</span>));
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-title function_">resolve</span>(<span class="hljs-string">`<span class="hljs-subst">${apiName}</span> è¿”å›çš„æ•°æ®: <span class="hljs-subst">${data}</span>`</span>);
        }
      }, delay);
    });
  }
}

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">AsyncAwaitDemo</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">resultLog</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Vå“¥å‡†å¤‡å¥½è¾“å‡ºæ—¥å¿—äº†...'</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">isLoading</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'é¸¿è’™ async/await å®æˆ˜å®éªŒå®¤'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">24</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">20</span> })

      <span class="hljs-comment">// åœºæ™¯ä¸€ï¼šä¸²è¡Œæ‰§è¡Œ</span>
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'åœºæ™¯1ï¼šä¸²è¡Œæ‰§è¡Œ (ç™»å½• -&gt; è·å–ä¿¡æ¯)'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">15</span> })
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">testSequential</span>();
        })

      <span class="hljs-comment">// åœºæ™¯äºŒï¼šå¹¶å‘æ‰§è¡Œ</span>
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'åœºæ™¯2ï¼šå¹¶å‘æ‰§è¡Œ (åŒæ—¶æ‹‰å–é…ç½®å’Œå¹¿å‘Š)'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">15</span> })
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">testParallel</span>();
        })

      <span class="hljs-comment">// åœºæ™¯ä¸‰ï¼šå¼‚å¸¸æ•è·</span>
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'åœºæ™¯3ï¼šå¼‚å¸¸æ•è· (æ¨¡æ‹Ÿå¤±è´¥é‡è¯•)'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">15</span> })
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">testErrorHandling</span>();
        })

      <span class="hljs-comment">// æ—¥å¿—æ˜¾ç¤ºåŒºåŸŸ</span>
      <span class="hljs-title class_">Column</span>() {
        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span>)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)
          .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#333333'</span>)
          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      }
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>)
      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'40%'</span>)
      .<span class="hljs-title function_">padding</span>(<span class="hljs-number">15</span>)
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F1F3F5'</span>)
      .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">10</span>)
      .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">20</span> })

      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoading</span>) {
        <span class="hljs-title class_">LoadingProgress</span>()
          .<span class="hljs-title function_">width</span>(<span class="hljs-number">30</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">30</span>)
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">20</span> })
          .<span class="hljs-title function_">color</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span>)
      }

    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">20</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">20</span> })
  }

  <span class="hljs-comment">/**
   * Vå“¥è§£æï¼šåœºæ™¯1 - ä¸²è¡Œæ‰§è¡Œ
   * ç‰¹ç‚¹ï¼šä¸€æ­¥æ¥ä¸€æ­¥ï¼Œä¸‹ä¸€æ­¥ä¾èµ–ä¸Šä¸€æ­¥çš„ç»“æœã€‚
   * ä»£ç é€»è¾‘ï¼šå®Œå…¨æ˜¯çº¿æ€§çš„ï¼ŒåƒåŒæ­¥ä»£ç ä¸€æ ·æ˜“è¯»ï¼
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">testSequential</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoading</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> = <span class="hljs-string">'1. å¼€å§‹ç™»å½•...\n'</span>;

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// Vå“¥é‡ç‚¹ï¼šawait ä¼šæš‚åœå‡½æ•°æ‰§è¡Œï¼Œç›´åˆ° Promise resolve</span>
      <span class="hljs-comment">// è¿™é‡Œæ¨¡æ‹Ÿå…ˆç™»å½•ï¼Œè€—æ—¶ 1000ms</span>
      <span class="hljs-keyword">let</span> loginRes = <span class="hljs-keyword">await</span> <span class="hljs-title class_">NetworkSimulator</span>.<span class="hljs-title function_">request</span>(<span class="hljs-string">'LoginAPI'</span>, <span class="hljs-string">'Token123'</span>, <span class="hljs-number">1000</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`   <span class="hljs-subst">${loginRes}</span>\n`</span>;

      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">'2. æ­£åœ¨è·å–ç”¨æˆ·ä¿¡æ¯...\n'</span>;
      <span class="hljs-comment">// ä¾èµ–ä¸Šé¢çš„ Tokenï¼Œç»§ç»­ await</span>
      <span class="hljs-keyword">let</span> userRes = <span class="hljs-keyword">await</span> <span class="hljs-title class_">NetworkSimulator</span>.<span class="hljs-title function_">request</span>(<span class="hljs-string">'GetUserInfo'</span>, <span class="hljs-string">'Vå“¥çš„å¤§å'</span>, <span class="hljs-number">800</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`   <span class="hljs-subst">${userRes}</span>\n`</span>;

      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">'âœ… å…¨éƒ¨å®Œæˆï¼(ä¸²è¡Œæ€»è€—æ—¶çº¦ 1.8s)'</span>;
      
      promptAction.<span class="hljs-title function_">showToast</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'ä¸²è¡Œæ‰§è¡Œå®Œæˆ'</span> });

    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`âŒ å‡ºé”™äº†: <span class="hljs-subst">${error.message}</span>`</span>;
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoading</span> = <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-comment">/**
   * Vå“¥è§£æï¼šåœºæ™¯2 - å¹¶å‘æ‰§è¡Œ
   * ç‰¹ç‚¹ï¼šä¸¤ä¸ªè¯·æ±‚äº’ä¸ä¾èµ–ï¼ŒåŒæ—¶å‘å‡ºï¼Œè°å…ˆå›æ¥è°å…ˆç»“æŸã€‚
   * ä¼˜åŠ¿ï¼šé€Ÿåº¦æœ€å¿«ï¼æ€»è€—æ—¶ = ä¸¤ä¸ªè¯·æ±‚ä¸­æœ€æ…¢çš„é‚£ä¸ªï¼Œè€Œä¸æ˜¯ä¸¤è€…ä¹‹å’Œã€‚
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">testParallel</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoading</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> = <span class="hljs-string">'1. åŒæ—¶å¯åŠ¨å¤šä¸ªä»»åŠ¡...\n'</span>;

    <span class="hljs-comment">// è®°å½•å¼€å§‹æ—¶é—´</span>
    <span class="hljs-keyword">const</span> startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// Vå“¥é‡ç‚¹ï¼šPromise.all()</span>
      <span class="hljs-comment">// æŠŠæ‰€æœ‰è¦å¹¶å‘çš„ Promise æ”¾è¿›æ•°ç»„é‡Œ</span>
      <span class="hljs-comment">// await ä¼šç­‰æ•°ç»„é‡Œæ‰€æœ‰çš„ Promise éƒ½ resolve æ‰ç»§ç»­</span>
      <span class="hljs-keyword">let</span> results = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([
        <span class="hljs-title class_">NetworkSimulator</span>.<span class="hljs-title function_">request</span>(<span class="hljs-string">'GetConfig'</span>, <span class="hljs-string">'ç³»ç»Ÿé…ç½®'</span>, <span class="hljs-number">1500</span>), <span class="hljs-comment">// å‡è®¾è¿™ä¸ªæ…¢</span>
        <span class="hljs-title class_">NetworkSimulator</span>.<span class="hljs-title function_">request</span>(<span class="hljs-string">'GetBanner'</span>, <span class="hljs-string">'å¹¿å‘Šå›¾ç‰‡'</span>, <span class="hljs-number">1000</span>)  <span class="hljs-comment">// å‡è®¾è¿™ä¸ªå¿«</span>
      ]);

      <span class="hljs-comment">// results æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé¡ºåºå’Œä½ ä¼ å…¥çš„é¡ºåºä¸€è‡´ï¼Œä¸ç®¡è°å…ˆå›æ¥</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`   <span class="hljs-subst">${results[<span class="hljs-number">0</span>]}</span>\n`</span>; <span class="hljs-comment">// ç¬¬ä¸€ä¸ªç»“æœ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`   <span class="hljs-subst">${results[<span class="hljs-number">1</span>]}</span>\n`</span>; <span class="hljs-comment">// ç¬¬äºŒä¸ªç»“æœ</span>

      <span class="hljs-keyword">const</span> duration = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - startTime;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`âœ… å…¨éƒ¨å®Œæˆï¼(å¹¶å‘æ€»è€—æ—¶çº¦ <span class="hljs-subst">${duration}</span>msï¼Œæ¯”ä¸²è¡Œå¿«ï¼)`</span>;
      
      promptAction.<span class="hljs-title function_">showToast</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'å¹¶å‘æ‰§è¡Œå®Œæˆ'</span> });

    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`âŒ å‡ºé”™äº†: <span class="hljs-subst">${error.message}</span>`</span>;
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoading</span> = <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-comment">/**
   * Vå“¥è§£æï¼šåœºæ™¯3 - å¼‚å¸¸å¤„ç†
   * ç‰¹ç‚¹ï¼šasync/await ä¸‹ï¼Œæˆ‘ä»¬ç”¨ try...catch...finally ä»£æ›¿ .then().catch()
   * è¿™æ¯”ä¼ ç»Ÿçš„ Promise é“¾å¼è°ƒç”¨è¦ç›´è§‚å¾—å¤šï¼Œåƒå¤„ç† Java å¼‚å¸¸ä¸€æ ·èˆ’æœã€‚
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">testErrorHandling</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoading</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> = <span class="hljs-string">'å°è¯•å‘é€è¯·æ±‚ (æ¨¡æ‹Ÿ20%å¤±è´¥ç‡)...\n'</span>;

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// è¿™é‡Œçš„è¯·æ±‚å¯èƒ½ä¼šæŠ›å‡º Error</span>
      <span class="hljs-keyword">let</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title class_">NetworkSimulator</span>.<span class="hljs-title function_">request</span>(<span class="hljs-string">'RiskyAPI'</span>, <span class="hljs-string">'è¯•è¯•è¿æ°”'</span>, <span class="hljs-number">1000</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`   æˆåŠŸ: <span class="hljs-subst">${data}</span>`</span>;
      promptAction.<span class="hljs-title function_">showToast</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·æ±‚æˆåŠŸ'</span> });

    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-comment">// Vå“¥é‡ç‚¹ï¼šä¸€æ—¦ä»»ä½•ä¸€æ­¥ await æŠ¥é”™ï¼Œç›´æ¥è·³è¿› catch</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`   æ•è·åˆ°å¼‚å¸¸: <span class="hljs-subst">${error.message}</span>\n`</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`   è¿™é‡Œå¯ä»¥è¿›è¡Œé‡è¯•é€»è¾‘...`</span>;
      
      promptAction.<span class="hljs-title function_">showToast</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·æ±‚è¢«æ‹¦æˆª'</span> });

    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-comment">// Vå“¥é‡ç‚¹ï¼šfinally æ— è®ºæˆåŠŸå¤±è´¥éƒ½ä¼šæ‰§è¡Œ</span>
      <span class="hljs-comment">// é€‚åˆç”¨æ¥å…³é—­ Loading å¼¹çª—</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoading</span> = <span class="hljs-literal">false</span>;
    }
  }
}
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6818be9281524d31a73fff7d7edfe3d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aiB5ZOl54ix57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769155247&amp;x-signature=zL9R6ZeXyZSmko98g2VPgKpHfNU%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-2">V å“¥çš„ä»£ç æ·±åº¦è§£æ</h2>
<p>å…„å¼Ÿä»¬ï¼Œä»£ç èƒ½è·‘äº†ï¼Œå’±ä»¬å¾—æ‡‚åŸç†ï¼Œä¸ç„¶é¢è¯•çš„æ—¶å€™è¦æŒ‚ï¼</p>
<h3 data-id="heading-3">1. ä¸ºä»€ä¹ˆ async/await ä¸ä¼šå¡æ­»ç•Œé¢ï¼Ÿ</h3>
<p>è¿™å°±æ˜¯å¹¶å‘ç¼–ç¨‹çš„é­”åŠ›ã€‚
å½“ä½ å†™ <code>let res = await someRequest()</code> çš„æ—¶å€™ï¼ŒArkTS çš„è¿è¡Œæ—¶ä¼šæŠŠ<strong>å½“å‰ä»»åŠ¡çš„æŒ‚èµ·</strong>ï¼ŒæŠŠä¸»çº¿ç¨‹çš„æ§åˆ¶æƒäº¤è¿˜ç»™ UI ç³»ç»Ÿã€‚
è¿™å°±å¥½æ¯”ä½ å»æ’é˜Ÿä¹°å¥¶èŒ¶ï¼Œä½ å«æœåŠ¡å‘˜åšå¥¶èŒ¶ï¼ˆå‘èµ·è¯·æ±‚ï¼‰ï¼Œä½ ç«™åœ¨æ—è¾¹ç­‰ï¼ˆawaitï¼‰ï¼Œä½†**åº—é‡Œçš„å…¶ä»–äººï¼ˆUIçº¿ç¨‹ï¼‰**ä¾ç„¶å¯ä»¥ç»§ç»­è¿›åº—ä¹°ä¸œè¥¿ã€‚åªæœ‰å½“ä½ çš„å¥¶èŒ¶å¥½äº†ï¼ˆPromise resolveï¼‰ï¼Œä½ æ‰æ‹¿ç€å¥¶èŒ¶èµ°äººï¼ˆä»£ç ç»§ç»­å¾€ä¸‹èµ°ï¼‰ã€‚</p>
<h3 data-id="heading-4">2. Promise.all æ˜¯æ€§èƒ½ä¼˜åŒ–çš„åˆ©å™¨</h3>
<p>åœ¨åœºæ™¯ 2 ä¸­ï¼ŒV å“¥æ¼”ç¤ºäº† <code>Promise.all</code>ã€‚
å¦‚æœä½ çš„é¦–é¡µæœ‰ 5 ä¸ªæ¥å£ï¼Œäº’ä¸ä¾èµ–ï¼Œä½ åƒä¸‡åˆ«å†™ 5 è¡Œ awaitï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âŒ é”™è¯¯å†™æ³•ï¼šæ…¢å¾—è¦æ­»</span>
<span class="hljs-keyword">let</span> a = <span class="hljs-keyword">await</span> <span class="hljs-title function_">req1</span>(); <span class="hljs-comment">// ç­‰1ç§’</span>
<span class="hljs-keyword">let</span> b = <span class="hljs-keyword">await</span> <span class="hljs-title function_">req2</span>(); <span class="hljs-comment">// å†ç­‰1ç§’</span>
<span class="hljs-comment">// ... æ€»è€—æ—¶ 5ç§’</span>
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âœ… V å“¥æ­£ç¡®å†™æ³•ï¼šé£å¿«</span>
<span class="hljs-keyword">let</span> results = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([<span class="hljs-title function_">req1</span>(), <span class="hljs-title function_">req2</span>(), <span class="hljs-title function_">req3</span>(), <span class="hljs-title function_">req4</span>(), <span class="hljs-title function_">req5</span>()]);
<span class="hljs-comment">// æ€»è€—æ—¶ = æœ€æ…¢çš„é‚£ä¸ªæ¥å£ (å‡è®¾æ˜¯ 1.2ç§’)</span>
</code></pre>
<p>è¿™å¯æ˜¯å®æ‰“å®çš„æ€§èƒ½æå‡ï¼Œç”¨æˆ·æ‰“å¼€ App çš„é€Ÿåº¦ç›´æ¥è‚‰çœ¼å¯è§å˜å¿«ï¼</p>
<h3 data-id="heading-5">3. ä¸è¦å¿˜è®°äº† try-catch</h3>
<p>ä»¥å‰å†™ Promise é“¾ï¼Œå¦‚æœä¸åŠ  <code>.catch()</code>ï¼ŒæŠ¥é”™äº†å¯èƒ½å°±åƒçŸ³æ²‰å¤§æµ·ï¼Œé™é»˜å¤±è´¥ã€‚
ç”¨äº† <code>async/await</code>ï¼Œ<strong>ä¸€å®šè¦</strong> åŒ…è£¹åœ¨ <code>try...catch</code> é‡Œã€‚è¿™æ˜¯å¯¹è‡ªå·±ä»£ç è´Ÿè´£ï¼Œä¹Ÿæ˜¯å¯¹ç”¨æˆ·è´Ÿè´£ã€‚</p>
<hr/>
<h2 data-id="heading-6">æ€»ç»“</h2>
<p>æ¥æ¥æ¥ï¼ŒV å“¥ç¨å¾®å°ç»“ä¸€ä¸‹ï¼š</p>
<ol>
<li><strong>é€»è¾‘å¤æ‚ï¼Ÿ</strong> ç”¨ <code>async/await</code> æ‹å¹³é‡‘å­—å¡”ã€‚</li>
<li><strong>è¯·æ±‚å¤šä¸”æ…¢ï¼Ÿ</strong> ç”¨ <code>Promise.all</code> å¹¶è¡ŒåŠ é€Ÿã€‚</li>
<li><strong>æ€•å‡ºé”™ï¼Ÿ</strong> ç”¨ <code>try/catch</code> ç¨³ç¨³å…œåº•ã€‚</li>
</ol>
<p>åœ¨ DevEco Studio 6.0 é‡Œï¼Œè¿™å¥—ç»„åˆæ‹³ç”¨ç†Ÿç»ƒäº†ï¼Œä½ çš„ä»£ç è´¨é‡å’Œå¼€å‘æ•ˆç‡ç»å¯¹èƒ½ç”©å¼€åŒè¡Œä¸€æ¡è¡—ã€‚</p>
<p>æˆ‘æ˜¯ V å“¥ï¼Œæ‹’ç»å›è°ƒåœ°ç‹±ï¼Œä»ä»Šå¤©å¼€å§‹ï¼å’±ä»¬ä¸‹æœŸè§ï¼ğŸ‘‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ”¥1ç¯‡ææ‡‚AIé€šè¯†:å¤§ç™½è¯æ‹†è§£æ ¸å¿ƒç‚¹]]></title>    <link>https://juejin.cn/post/7595610998033727515</link>    <guid>https://juejin.cn/post/7595610998033727515</guid>    <pubDate>2026-01-16T07:25:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595610998033727515" data-draft-id="7595626157909213193" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ”¥1ç¯‡ææ‡‚AIé€šè¯†:å¤§ç™½è¯æ‹†è§£æ ¸å¿ƒç‚¹"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-16T07:25:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº¬ä¸œäº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2634854380340008"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ”¥1ç¯‡ææ‡‚AIé€šè¯†:å¤§ç™½è¯æ‹†è§£æ ¸å¿ƒç‚¹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2634854380340008/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº¬ä¸œäº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T07:25:11.000Z" title="Fri Jan 16 2026 07:25:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»21åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šå¢æ—­</p>
<h2 data-id="heading-0">å¼•è¨€</h2>
<p>éšç€ AI æŠ€æœ¯ä»å®éªŒå®¤èµ°å‘æ—¥å¸¸ï¼Œâ€œæœºå™¨å­¦ä¹ â€â€œå¤§æ¨¡å‹â€â€œTransformerâ€â€œMOEâ€ ç­‰è¯æ±‡å·²ä¸å†æ˜¯æŠ€æœ¯åœˆçš„ä¸“å±ã€‚ä»æ™ºèƒ½èŠå¤©åŠ©æ‰‹åˆ°ç”µå•†æ¨èï¼Œä»è¯­éŸ³è¯†åˆ«åˆ°è‡ªåŠ¨é©¾é©¶ï¼ŒAI æ­£ä»¥å¤šå…ƒå½¢æ€èå…¥ç”Ÿæ´»ã€‚è¿™ç¯‡æ–‡ç« æŒ‰ â€œåŸºç¡€â†’æ ¸å¿ƒâ†’ä¼˜åŒ–â†’è½åœ°â†’å·¥å…·â†’æœ¯è¯­â€ çš„é€»è¾‘ï¼Œç”¨æœ€é€šä¿—çš„å¤§ç™½è¯ï¼ŒæŠŠ AI é€šè¯†æŠ€æœ¯ç‚¹è®²é€ã€‚å¸®åŠ©ä½ æˆ‘ä»–å¥¹å»ºç«‹æ›´å®Œæ•´çš„ AI è®¤çŸ¥æ¡†æ¶ï¼Œç†è§£æŠ€æœ¯èƒŒåçš„æ ¸å¿ƒé€»è¾‘ä¸å®é™…ä»·å€¼ï¼Œâ€œçœ‹é€â€ AI æŠ€æœ¯çš„åº•å±‚é€»è¾‘ï¼Œè®©å¤æ‚æ¦‚å¿µå˜å¾—æ¸…æ™°æ˜“æ‡‚ã€‚</p>
<hr/>
<p>ï»¿</p>
<h2 data-id="heading-1">ä¸€ã€åŸºç¡€æ¦‚å¿µï¼ˆææ‡‚ AI çš„ â€œåº•å±‚é€»è¾‘â€ï¼‰</h2>
<h3 data-id="heading-2">1. ä»€ä¹ˆæ˜¯ AIï¼ˆäººå·¥æ™ºèƒ½ï¼‰ï¼Ÿ</h3>
<p>AI æœ¬è´¨å°±æ˜¯ â€œè®©æœºå™¨åƒäººä¸€æ ·æ€è€ƒã€å¹²æ´»â€ çš„æŠ€æœ¯ä½“ç³» â€”â€” ä¸ç”¨äººä¸€æ­¥æ­¥æŒ‡æŒ¥ï¼Œæœºå™¨èƒ½è‡ªå·±å­¦è§„å¾‹ã€åšå†³ç­–ã€‚æ¯”å¦‚æ‰‹æœºäººè„¸è¯†åˆ«ã€èŠå¤©æœºå™¨äººã€è‡ªåŠ¨é©¾é©¶ï¼Œéƒ½æ˜¯ AI çš„å…·ä½“åº”ç”¨ã€‚å®ƒä¸æ˜¯å•ä¸€æŠ€æœ¯ï¼Œè€Œæ˜¯ä¸€å †æŠ€æœ¯çš„ â€œæ€»ç§°â€ï¼Œå°±åƒ â€œå®¶ç”µâ€ åŒ…å«å†°ç®±ã€ç”µè§†ä¸€æ ·ã€‚è¿™å¼ ç½‘ä¸Šæµè¡Œçš„å›¾æ¦‚è¿°äº†äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰éšç€æ—¶é—´æ¨ç§»çš„å‘å±•å†ç¨‹ï¼Œä»æ—©æœŸé˜¶æ®µåˆ°æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ä»¥åŠå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„å‡ºç°ã€‚</p>
<p>ï»¿</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/daa11585169c437f8b058f602f61fc0a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153111&amp;x-signature=I7cedMjtba%2FN8BFKucvxk4dKCJA%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<h3 data-id="heading-3">2. ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ã€å¼ºåŒ–å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ï¼Œå®ƒä»¬çš„å…³ç³»ï¼Ÿ</h3>
<p>è¿™ä»¨æ˜¯ AI çš„ â€œæ ¸å¿ƒæ–¹æ³•è®ºâ€ï¼Œæ˜¯ â€œå¤§åœˆå¥—å°åœˆâ€ çš„å…³ç³»ï¼š</p>
<p>â€¢<strong>æœºå™¨å­¦ä¹ </strong>ï¼šAI çš„ â€œåŸºç¡€å­¦ä¹ æ³•â€â€”â€” è®©æœºå™¨åƒ â€œå­¦ç”Ÿåˆ·é¢˜â€ï¼Œä»æ•°æ®é‡Œè‡ªå·±æ‰¾è§„å¾‹ï¼ˆæ¯”å¦‚çœ‹ 1000 å¼ çŒ«çš„ç…§ç‰‡ï¼Œè‡ªå·±æ€»ç»“ â€œå°–è€³æœµ = çŒ«â€ï¼‰ï¼Œä¸ç”¨äººé€æ¡æ•™è§„åˆ™ã€‚</p>
<p>â€¢<strong>æ·±åº¦å­¦ä¹ </strong>ï¼šæœºå™¨å­¦ä¹ çš„ â€œé«˜çº§ç‰ˆâ€â€”â€” ç»™æœºå™¨é…äº† â€œå¤šå±‚æ€è€ƒå¤§è„‘â€ï¼ˆç¥ç»ç½‘ç»œï¼‰ï¼Œèƒ½åˆ†å±‚æŒ–æ•°æ®çš„æ·±å±‚è§„å¾‹ï¼ˆæ¯”å¦‚å…ˆçœ‹çŒ«çš„è½®å»“ï¼Œå†çœ‹ç»†èŠ‚ï¼Œæœ€ååˆ¤æ–­ï¼‰ï¼Œé€‚åˆå¤„ç†å›¾ç‰‡ã€é•¿æ–‡æœ¬ç­‰å¤æ‚ä»»åŠ¡ã€‚</p>
<p>â€¢<strong>å¼ºåŒ–å­¦ä¹ </strong>ï¼šæœºå™¨å­¦ä¹ çš„ â€œç‰¹è®­æ³•â€â€”â€” è®©æœºå™¨åƒ â€œå® ç‰©å­¦æŠ€èƒ½â€ï¼Œåšå¯¹äº†ç»™å¥–åŠ±ï¼ˆèµ¢æ£‹åŠ åˆ†ï¼‰ï¼Œåšé”™äº†ç»™æƒ©ç½šï¼ˆè¾“æ£‹æ‰£åˆ†ï¼‰ï¼Œåå¤è¯•é”™åä¼˜åŒ–ç­–ç•¥ï¼Œæ¯”å¦‚ AI ç©æ¸¸æˆã€ä¸‹å›´æ£‹éƒ½é å®ƒã€‚</p>
<p>å…³ç³»æ€»ç»“ï¼šæœºå™¨å­¦ä¹ æ˜¯ â€œæ€»æ–¹æ³•â€ï¼Œæ·±åº¦å­¦ä¹ æ˜¯ â€œé«˜çº§åˆ†æ”¯â€ï¼Œå¼ºåŒ–å­¦ä¹ æ˜¯ â€œè®­ç»ƒæŠ€å·§â€ï¼Œä¸‰è€…å¸¸æ­é…ä½¿ç”¨ï¼ˆæ¯”å¦‚ ChatGPT ç”¨æ·±åº¦å­¦ä¹ æ¶æ„ï¼Œé å¼ºåŒ–å­¦ä¹ ä¼˜åŒ–å›ç­”ï¼‰ã€‚</p>
<h3 data-id="heading-4">3. æœºå™¨å­¦ä¹ ä¸‰å¤§èŒƒå¼</h3>
<p>èŒƒå¼å°±æ˜¯ â€œæ•™æœºå™¨å¹²æ´»çš„å…·ä½“æ–¹å¼â€ï¼Œæ ¸å¿ƒåŒºåˆ«æ˜¯ â€œç»™ä¸ç»™æœºå™¨â€˜æ ‡å‡†ç­”æ¡ˆâ€™â€ï¼ˆæ ‡å‡†ç­”æ¡ˆå« â€œæ ‡ç­¾â€ï¼Œæ¯”å¦‚ â€œè¿™å¼ æ˜¯çŒ«â€ï¼‰ï¼š</p>





























<table><thead><tr><th>èŒƒå¼ç±»å‹</th><th>é€šä¿—ç±»æ¯”</th><th>æ ¸å¿ƒé€»è¾‘</th><th>å®é™…åº”ç”¨</th></tr></thead><tbody><tr><td>ç›‘ç£å­¦ä¹ </td><td>åš â€œå¸¦ç­”æ¡ˆçš„ä¹ é¢˜å†Œâ€</td><td>ç»™æœºå™¨çš„æ‰€æœ‰æ•°æ®éƒ½æ ‡å¥½ â€œå¯¹é”™ / ç»“æœâ€ï¼Œæœºå™¨å­¦å®Œåç›´æ¥å¥—ç”¨è§„å¾‹</td><td>åƒåœ¾é‚®ä»¶è¯†åˆ«ã€ç¿»è¯‘è½¯ä»¶ã€å›¾ç‰‡åˆ†ç±»</td></tr><tr><td>æ— ç›‘ç£å­¦ä¹ </td><td>æ•´ç† â€œæ— æ ‡ç­¾çš„æ‚ç‰©â€</td><td>åªç»™æœºå™¨åŸå§‹æ•°æ®ï¼Œä¸æ ‡ç­”æ¡ˆï¼Œè®©å®ƒè‡ªå·±æ‰¾åˆ†ç±» / è§„å¾‹</td><td>ç”µå•† â€œçŒœä½ å–œæ¬¢â€ã€å®¢æˆ·ç¾¤ä½“åˆ’åˆ†ã€å¼‚å¸¸äº¤æ˜“æ£€æµ‹</td></tr><tr><td>åŠç›‘ç£å­¦ä¹ </td><td>åš â€œä¸€åŠæœ‰ç­”æ¡ˆçš„ä¹ é¢˜å†Œâ€</td><td>å°‘é‡æ•°æ®æ ‡ç­”æ¡ˆï¼ˆæ•™åŸºç¡€è§„å¾‹ï¼‰ï¼Œå¤§é‡æ•°æ®æ— ç­”æ¡ˆï¼ˆè®©æœºå™¨ä¸¾ä¸€åä¸‰ï¼‰</td><td>æ–¹è¨€è¯†åˆ«ã€ç½•è§ç–¾ç—…è¯Šæ–­ï¼ˆæ ‡æ³¨æ•°æ®å°‘çš„åœºæ™¯ï¼‰</td></tr></tbody></table>
<p>è¡¥å……ï¼šå¼ºåŒ–å­¦ä¹ ä¹Ÿå¸¸è¢«å•ç‹¬åˆ—ä¸ºä¸€ç±»ï¼Œæ ¸å¿ƒæ˜¯ â€œé å¥–åŠ± / æƒ©ç½šè¯•é”™å­¦ä¹ â€ã€‚</p>
<h3 data-id="heading-5">4. ä»€ä¹ˆæ˜¯ç¥ç»ç½‘ç»œï¼Ÿ</h3>
<p>ç¥ç»ç½‘ç»œæ˜¯æ·±åº¦å­¦ä¹ çš„ â€œæ ¸å¿ƒéª¨æ¶â€ï¼Œæ¨¡ä»¿äººè„‘ç¥ç»å…ƒçš„è¿æ¥æ–¹å¼ï¼Œæœ¬è´¨æ˜¯ â€œæŒ‰å±‚æ’åˆ—çš„å°è®¡ç®—å•å…ƒé›†åˆâ€ï¼Œåƒ â€œå·¥å‚æµæ°´çº¿â€ï¼š</p>
<p>â€¢<strong>è¾“å…¥å±‚</strong>ï¼šâ€œåŸææ–™å…¥å£â€â€”â€” æ¥æ”¶åŸå§‹æ•°æ®ï¼ˆæ¯”å¦‚å›¾ç‰‡åƒç´ ã€æ–‡å­—ï¼‰ï¼›</p>
<p>â€¢<strong>éšè—å±‚</strong>ï¼šâ€œæ ¸å¿ƒåŠ å·¥è½¦é—´â€â€”â€” å±‚æ•°è¶Šå¤šï¼Œæ·±åº¦å­¦ä¹ è¶Š â€œæ·±â€ï¼Œè´Ÿè´£ä¸€æ­¥æ­¥æå–æ•°æ®ç‰¹å¾ï¼ˆä»è½®å»“åˆ°ç»†èŠ‚ï¼‰ï¼›</p>
<p>â€¢<strong>è¾“å‡ºå±‚</strong>ï¼šâ€œæˆå“å‡ºå£â€â€”â€” è¾“å‡ºæœ€ç»ˆç»“æœï¼ˆæ¯”å¦‚ â€œè¿™æ˜¯çŒ«â€â€œç¿»è¯‘ç»“æœâ€ï¼‰ã€‚</p>
<p>æ¯ä¸ª â€œå°è®¡ç®—å•å…ƒâ€ï¼ˆç¥ç»å…ƒï¼‰å°±åƒ â€œå°è®¡ç®—å™¨â€ï¼Œç­›é€‰æœ‰ç”¨ä¿¡æ¯ã€å¼±åŒ–æ— ç”¨ä¿¡æ¯ï¼Œè®­ç»ƒæ¨¡å‹å°±æ˜¯è°ƒæ•´è¿™äº›å•å…ƒçš„ â€œå·¥ä½œè§„åˆ™â€ï¼Œè®©å®ƒè¶Šæ¥è¶Šç²¾å‡†ã€‚</p>
<h3 data-id="heading-6">5. ä¸ºä»€ä¹ˆæ·±åº¦å­¦ä¹ è¦ â€œæ·±â€ï¼Ÿ</h3>
<p>â€œæ·±â€ æŒ‡ç¥ç»ç½‘ç»œçš„ â€œéšè—å±‚å¤šâ€ï¼Œä¸æ˜¯ä¸ºäº†å‡‘æ•°ï¼Œè€Œæ˜¯ä¸ºäº† â€œæŒ–æ·±å±‚è§„å¾‹â€ï¼š</p>
<p>â€¢1 å±‚ç½‘ç»œï¼ˆæµ…ï¼‰ï¼šåªèƒ½çœ‹è¡¨é¢ä¿¡æ¯ï¼ˆæ¯”å¦‚å›¾ç‰‡çš„åƒç´ é¢œè‰²ï¼‰ï¼Œåˆ†ä¸æ¸…çŒ«å’Œç‹—ï¼›</p>
<p>â€¢3 å±‚ç½‘ç»œï¼ˆä¸­æ·±ï¼‰ï¼šç¬¬ 1 å±‚çœ‹ â€œè¾¹ç¼˜ / æ˜æš—â€â†’ç¬¬ 2 å±‚æ‹¼ â€œè€³æœµ / åœ†å½¢è½®å»“â€â†’ç¬¬ 3 å±‚åˆ¤æ–­ â€œå°–è€³æœµ = çŒ«ã€åœ†å½¢ = çƒâ€ï¼›</p>
<p>â€¢10 å±‚ä»¥ä¸Šç½‘ç»œï¼ˆæ·±ï¼‰ï¼šèƒ½åˆ†å±‚æå–ç‰¹å¾ï¼ˆå…ˆè½®å»“â†’å†ç»†èŠ‚â†’å†é€»è¾‘ï¼‰ï¼Œæ¯”å¦‚è¯†åˆ« â€œå°ç‹—åœ¨è¿½è´è¶â€ï¼Œèƒ½çœ‹æ‡‚ â€œåŠ¨ä½œâ€ å’Œ â€œåœºæ™¯â€ã€‚</p>
<p>ç®€å•è¯´ï¼šâ€œæ·±â€ çš„æœ¬è´¨æ˜¯ â€œåˆ†å±‚æå–ç‰¹å¾â€ï¼šä»è¡¨é¢çš„ â€œåƒç´  / æ–‡å­—â€ï¼ŒæŒ–åˆ°æ·±å±‚çš„ â€œé€»è¾‘ / åœºæ™¯â€ï¼›ä»»åŠ¡è¶Šå¤æ‚ï¼ˆå†™å°è¯´ã€è§£æ•°å­¦é¢˜ï¼‰ï¼Œè¶Šéœ€è¦ â€œæ·±â€ ç½‘ç»œï¼Œæ‰èƒ½ä»è¡¨é¢æ•°æ®æŒ–åˆ°æ ¸å¿ƒé€»è¾‘ã€‚</p>
<h3 data-id="heading-7">6. ä»€ä¹ˆæ˜¯é¢„è®­ç»ƒï¼Ÿ</h3>
<p>é¢„è®­ç»ƒå°±æ˜¯ç»™å¤§æ¨¡å‹ â€œæ‰“åŸºç¡€â€â€”â€” ç”¨æµ·é‡é€šç”¨æ•°æ®ï¼ˆæ¯”å¦‚å‡ ç™¾ä¸‡æœ¬ä¹¦ã€ç½‘é¡µï¼‰è®©æ¨¡å‹å…ˆå­¦ â€œé€šç”¨çŸ¥è¯†â€ï¼ˆè¯­æ³•ã€å¸¸è¯†ã€é€»è¾‘ï¼‰ï¼Œç›¸å½“äºè®©å­¦ç”Ÿå…ˆè¯»å®Œå°å­¦åˆ°å¤§å­¦çš„é€šè¯†è¯¾ç¨‹ï¼Œå…·å¤‡åŸºæœ¬èƒ½åŠ›ã€‚</p>
<p>é¢„è®­ç»ƒåçš„æ¨¡å‹å°±åƒ â€œæœ‰åŸºç¡€çš„å­¦éœ¸â€ï¼Œä¸ç”¨å†ä»é›¶å­¦èµ·ï¼Œåç»­åªéœ€é’ˆå¯¹æ€§åŸ¹è®­ï¼ˆå¾®è°ƒï¼‰ï¼Œå°±èƒ½é€‚é…å…·ä½“ä»»åŠ¡ï¼ˆæ¯”å¦‚å½“å®¢æœã€å†™ä»£ç ï¼‰ã€‚</p>
<h3 data-id="heading-8">7. ä»€ä¹ˆæ˜¯å¤§æ¨¡å‹ LLMï¼Ÿ</h3>
<p>LLM æ˜¯ â€œå¤§è¯­è¨€æ¨¡å‹â€ çš„ç¼©å†™ï¼Œæ ¸å¿ƒæ˜¯ â€œç”¨è¶…å¤§ç¥ç»ç½‘ç»œï¼Œå­¦æµ·é‡æ–‡å­—æ•°æ®ï¼Œèƒ½åƒäººä¸€æ ·ç†è§£å’Œç”Ÿæˆè¯­è¨€â€â€”â€” é€šä¿—è¯´å°±æ˜¯ â€œè¯»è¿‡å…¨ä¸–ç•Œä¹¦çš„è¶…çº§å­¦éœ¸â€ã€‚</p>
<p>â€œå¤§â€ ä½“ç°åœ¨ä¸‰ç‚¹ï¼š</p>
<p>â€¢å‚æ•°é‡å¤§ï¼šç›¸å½“äº â€œå­¦éœ¸çš„è„‘ç»†èƒå¤šâ€ï¼Œèƒ½å­˜æ›´å¤šçŸ¥è¯†ï¼ˆæ¯”å¦‚ GPT-4 æœ‰ä¸‡äº¿çº§å‚æ•°ï¼‰ï¼›</p>
<p>â€¢æ•°æ®é‡å¤šï¼šç›¸å½“äº â€œå­¦éœ¸è¯»çš„ä¹¦å¤šâ€ï¼Œè¦†ç›–ä¹¦ç±ã€è®ºæ–‡ã€ç½‘é¡µç­‰ï¼ŒçŸ¥è¯†æ¸Šåšï¼›</p>
<p>â€¢èƒ½åŠ›å…¨ï¼šèƒ½èŠå¤©ã€å†™æ–‡æ¡ˆã€è§£æ•°å­¦é¢˜ã€ç¼–ä»£ç ï¼Œä¸ç”¨ä¸“é—¨è®­ç»ƒã€‚</p>
<h3 data-id="heading-9">8. ä»€ä¹ˆæ˜¯å¤šæ¨¡æ€å¤§æ¨¡å‹ï¼Ÿ</h3>
<p>â€œæ¨¡æ€â€ å°±æ˜¯ AI èƒ½å¤„ç†çš„ â€œä¿¡æ¯ç±»å‹â€ï¼ˆæ–‡å­—ã€å›¾ç‰‡ã€è¯­éŸ³ã€è§†é¢‘ï¼‰ï¼Œå¤šæ¨¡æ€å¤§æ¨¡å‹å°±æ˜¯ â€œå…¨èƒ½é€‰æ‰‹â€â€”â€” èƒ½åŒæ—¶å¤„ç†å¤šç§ä¿¡æ¯ï¼š</p>
<p>â€¢æ¯”å¦‚ä½ å‘ä¸€å¼ é£æ™¯ç…§ï¼Œå®ƒèƒ½æè¿°å†…å®¹ã€é…è¯—ï¼Œè¿˜èƒ½æŠŠè¯—è¯»å‡ºæ¥ï¼›</p>
<p>â€¢å¸¸è§ä¾‹å­ï¼šGPT-4Vã€æ–‡å¿ƒä¸€è¨€å¤šæ¨¡æ€ç‰ˆï¼Œèƒ½çœ‹å›¾ç‰‡ã€å¬è¯­éŸ³ã€å†™æ–‡å­—ã€‚</p>
<hr/>
<p>ï»¿</p>
<h2 data-id="heading-10">äºŒã€æ ¸å¿ƒæ¶æ„ä¸æœºåˆ¶ï¼ˆAI çš„ â€œåº•å±‚éª¨æ¶â€ï¼‰</h2>
<h3 data-id="heading-11">1. ä¼ ç»Ÿæ¶æ„ä¸æ¼”è¿›ï¼šä»€ä¹ˆæ˜¯ RNN/LSTM/GRUï¼Ÿ</h3>
<p>åœ¨ Transformer å‡ºç°å‰ï¼Œå¤„ç†æ–‡å­—ã€è¯­éŸ³ç­‰ â€œåºåˆ—æ•°æ®â€ï¼ˆæœ‰å…ˆåé¡ºåºçš„æ•°æ®ï¼‰é è¿™äº›æ¶æ„ï¼š</p>
<p>â€¢<strong>RNN</strong>ï¼šâ€œé€å­—å¤„ç†â€ çš„æ¶æ„ â€”â€” åƒè¯»æ–‡ç« é€å­—å¿µï¼Œåªèƒ½è®°ä½æœ€è¿‘çš„ä¿¡æ¯ï¼Œå¤„ç†é•¿æ–‡æœ¬ä¼š â€œå¿˜äº‹â€ï¼ˆæ¯”å¦‚è¯» 1000 å­—æ–‡ç« ï¼Œåé¢å¿˜äº†å‰é¢ï¼‰ï¼›</p>
<p>â€¢<strong>LSTM/GRU</strong>ï¼šRNN çš„ â€œå‡çº§ç‰ˆâ€â€”â€” åŠ äº† â€œè®°å¿†å•å…ƒâ€ï¼Œèƒ½è®°ä½æ›´å¤šé•¿è·ç¦»ä¿¡æ¯ï¼Œä½†æ•ˆç‡è¿˜æ˜¯ä½ï¼Œå¤„ç†è¶…é•¿æ–‡æœ¬ä»åƒåŠ›ã€‚</p>
<p>è¿™äº›æ¶æ„æ˜¯ AI çš„ â€œè€åŸºå»ºâ€ï¼Œç°åœ¨ä¸»æµå¤§æ¨¡å‹å·²ä¸ç”¨ï¼Œä½†äº†è§£å®ƒä»¬èƒ½æ›´å¥½ç†è§£ Transformer çš„åˆ›æ–°ã€‚</p>
<h3 data-id="heading-12">2. ç°ä»£å¤§æ¨¡å‹åŸºçŸ³ï¼šä»€ä¹ˆæ˜¯ Transformer æ¶æ„ï¼Ÿ</h3>
<p>Transformer æ¶æ„æ˜¯ä¸€ç§ä»¥ â€œå¹¶è¡Œè®¡ç®— + è‡ªæ³¨æ„åŠ›æœºåˆ¶â€ ä¸ºæ ¸å¿ƒçš„ç¥ç»ç½‘ç»œç»“æ„ï¼Œèƒ½é«˜æ•ˆæ•æ‰æ•°æ®ï¼ˆå¦‚æ–‡å­—ï¼‰é—´çš„å…³è”å…³ç³»ï¼Œæ˜¯ç°ä»£å¤§æ¨¡å‹ï¼ˆå¦‚ ChatGPTã€DeepSeekï¼‰çš„åŸºç¡€éª¨æ¶ã€‚2017 å¹´ç”± Google æå‡ºï¼Œæ˜¯å¤§æ¨¡å‹ â€œé«˜æ•ˆè¿è¡Œâ€ çš„å…³é”®â€”â€” å†³å®šäº†æ¨¡å‹èƒ½è·‘å¤šå¿«ã€å¤„ç†å¤šé•¿æ–‡æœ¬ã€æ•ˆæœå¤šå¥½ï¼Œå½»åº•è§£å†³äº†ä¼ ç»Ÿæ¶æ„çš„ç—›ç‚¹ï¼š</p>
<p>â€¢æ ¸å¿ƒåˆ›æ–°ï¼šâ€œå¹¶è¡Œè®¡ç®— + æ³¨æ„åŠ›æœºåˆ¶â€â€”â€” ä¸ç”¨é€å­—å¤„ç†ï¼Œèƒ½åŒæ—¶åˆ†æå¤šä¸ªå…³é”®è¯ï¼Œè¿˜èƒ½è®°ä½è¯ä¸è¯çš„å…³ç³»ï¼Œåˆå¿«åˆå‡†ï¼›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b24f4b72e34841bf830659b83f57847f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153111&amp;x-signature=jNXWMIKEgskzQQybMbt%2B1bklkQA%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>â€¢æ ¸å¿ƒç»“æ„ï¼šåˆ† â€œç¼–ç å™¨ï¼ˆEncoderï¼‰â€ å’Œ â€œè§£ç å™¨ï¼ˆDecoderï¼‰â€â€”â€” ç¼–ç å™¨è´Ÿè´£ â€œç†è§£ä¿¡æ¯â€ï¼ˆæ¯”å¦‚è¯»æ–‡ç« ï¼‰ï¼Œè§£ç å™¨è´Ÿè´£ â€œç”Ÿæˆä¿¡æ¯â€ï¼ˆæ¯”å¦‚å†™æ–‡ç« ï¼‰ï¼›</p>
<p>ï»¿</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4bd91b6a0e004a59988db4a2ffb4b698~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153111&amp;x-signature=e7WulIpGuhX1PMah%2FfZtR%2BAtLxU%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>ç®€å•è¯´ï¼ŒTransformer æ¶æ„å°±æ˜¯è®© AI èƒ½åŒæ—¶çœ‹æ‡‚æ–‡å­—é—´çš„å…³è”ã€è¿˜èƒ½å¿«é€Ÿå¤„ç†é•¿æ–‡æœ¬çš„ â€œé«˜æ•ˆå¤§è„‘éª¨æ¶â€ï½ã€‚</p>
<h3 data-id="heading-13">3. ä»€ä¹ˆæ˜¯ä½ç½®ç¼–ç ï¼Ÿ</h3>
<p>Transformer æ¶æ„æœ¬èº« â€œä¸è®¤è¯†æ–‡å­—é¡ºåºâ€â€”â€” å¦‚æœä¸åŠ ä½ç½®ç¼–ç ï¼Œæœºå™¨ä¼šæŠŠ â€œæˆ‘æ‰“ä½ â€ å’Œ â€œä½ æ‰“æˆ‘â€ å½“æˆä¸€å›äº‹ã€‚ä½ç½®ç¼–ç çš„æ ¸å¿ƒä½œç”¨æ˜¯ â€œæ ‡è®°æ–‡å­—çš„å…ˆåé¡ºåºâ€ï¼Œè®©æœºå™¨ç†è§£è¯­åºé€»è¾‘ã€‚</p>
<p>â€¢é€šä¿—è§£é‡Š</p>
<p>â—¦æ¯”å¦‚å¤„ç†å¥å­ â€œå°æ˜åƒè‹¹æœâ€ï¼šä½ç½®ç¼–ç ç»™ â€œå°æ˜â€ è´´ â€œ1 å·â€ã€â€œåƒâ€ è´´ â€œ2 å·â€ã€â€œè‹¹æœâ€ è´´ â€œ3 å·â€ï¼›</p>
<p>â—¦æœºå™¨çœ‹åˆ°æ ‡ç­¾åï¼Œå°±çŸ¥é“ â€œ1 å·ï¼ˆå°æ˜ï¼‰åš 2 å·ï¼ˆåƒï¼‰åŠ¨ä½œï¼Œå¯¹è±¡æ˜¯ 3 å·ï¼ˆè‹¹æœï¼‰â€ï¼Œä¸ä¼šæåé€»è¾‘ï¼›</p>
<p>â—¦æ³¨æ„ï¼šä½ç½®ç¼–ç ä¸æ˜¯ç®€å•çš„ 1ã€2ã€3ï¼Œè€Œæ˜¯ç”¨ç‰¹æ®Šæ•°å­—ç¼–ç ï¼Œè®©æœºå™¨åŒæ—¶ç†è§£ â€œç›¸é‚»è¯å…³ç³»æ›´è¿‘â€ï¼ˆå¦‚ â€œåƒâ€ å’Œ â€œå°æ˜â€â€œè‹¹æœâ€ çš„å…³ç³»æ¯” â€œå°æ˜â€ å’Œ â€œè‹¹æœâ€ æ›´è¿‘ï¼‰ã€‚</p>
<p>â€¢æ ¸å¿ƒä½œç”¨</p>
<p>â—¦ä½ç½®ç¼–ç è§£å†³äº† â€œè¯­åºæ··ä¹±â€ çš„é—®é¢˜ï¼Œè®©æœºå™¨èƒ½æ­£ç¡®ç†è§£ â€œä¸»è°“å®¾â€â€œå…ˆåé¡ºåºâ€ ç­‰è¯­è¨€é€»è¾‘ï¼Œæ˜¯å¤„ç†æ–‡æœ¬ä»»åŠ¡çš„å…³é”®å°æŠ€å·§ã€‚</p>
<h3 data-id="heading-14">4. è¯­ä¹‰ç†è§£å¼•æ“ï¼šä»€ä¹ˆæ˜¯æ³¨æ„åŠ›æ¨¡å‹ã€è‡ªæ³¨æ„åŠ›æœºåˆ¶ã€å¤šå¤´æ³¨æ„åŠ›ï¼Ÿ</h3>
<p>è¿™ä»¨æ˜¯ Transformer çš„ â€œæ ¸å¿ƒèƒ½åŠ›â€ï¼Œæœ¬è´¨æ˜¯è®©æœºå™¨ â€œæŠ“é‡ç‚¹ã€ç†å…³ç³»â€ï¼š</p>

























<table><thead><tr><th>æ¦‚å¿µåç§°</th><th>é€šä¿—ç±»æ¯”</th><th>æ ¸å¿ƒä½œç”¨ ï¼ˆè¾“å…¥å¥å­ â€œåŒ—äº¬çš„æ•…å®«å’Œä¸Šæµ·çš„ä¸œæ–¹æ˜ç ï¼Œå“ªä¸ªæ›´é€‚åˆæ‹ç…§ï¼Ÿï¼‰</th></tr></thead><tbody><tr><td>æ³¨æ„åŠ›æ¨¡å‹</td><td>è¯»ä¹¦æ—¶ â€œåˆ’é‡ç‚¹â€</td><td>ä»æµ·é‡ä¿¡æ¯ä¸­ç­›é€‰å‡ºå…³é”®å†…å®¹ï¼ˆå¦‚ â€œåŒ—äº¬â€â€œæ•…å®«â€â€œæ‹ç…§â€ï¼‰</td></tr><tr><td>è‡ªæ³¨æ„åŠ›æœºåˆ¶</td><td>åˆ’é‡ç‚¹å â€œåˆ†æå…³ç³»â€</td><td>ä¸ä»…æ‰¾é‡ç‚¹ï¼Œè¿˜èƒ½ç†æ¸…é‡ç‚¹é—´çš„å…³è”ï¼ˆå¦‚ â€œåŒ—äº¬æœ‰æ•…å®«ï¼Œæ•…å®«é€‚åˆæ‹ç…§â€ï¼‰</td></tr><tr><td>å¤šå¤´æ³¨æ„åŠ›</td><td>ç”¨ â€œå¤šå‰¯çœ¼é•œçœ‹é‡ç‚¹â€</td><td>ä»å¤šä¸ªè§’åº¦æŠ“é‡ç‚¹ï¼ˆä¸€å‰¯çœ‹ â€œè°åšä»€ä¹ˆâ€ï¼Œä¸€å‰¯çœ‹ â€œåœ¨å“ªé‡Œåšâ€ï¼Œä¸€å‰¯çœ‹ â€œæ€ä¹ˆåšâ€ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-15">5. æ³¨æ„åŠ›ä¼˜åŒ–å‡çº§ï¼šä»€ä¹ˆæ˜¯ MLAã€NSA å’Œä»£ç†æ³¨æ„åŠ›ï¼Ÿ</h3>
<p>æ™®é€šæ³¨æ„åŠ›æœºåˆ¶å¤„ç†é•¿æ–‡æœ¬ï¼ˆæ¯”å¦‚ 10 ä¸‡å­—æŠ¥å‘Šï¼‰æ—¶ï¼Œä¼š â€œå†…å­˜ä¸å¤Ÿã€è·‘ä¸åŠ¨â€ï¼Œè¿™ä¸‰ä¸ªæ˜¯ â€œä¼˜åŒ–ç‰ˆâ€ï¼Œæ ¸å¿ƒæ˜¯ â€œçœèµ„æºã€ææ•ˆç‡â€ï¼š</p>





























<table><thead><tr><th>æŠ€æœ¯åç§°</th><th>é€šä¿—ç±»æ¯”</th><th>æ ¸å¿ƒé€»è¾‘</th><th>åº”ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>å¤šå¤´æ½œåœ¨æ³¨æ„åŠ›ï¼ˆMLAï¼‰</td><td>æŠŠåšä¹¦åšæˆ â€œæ€ç»´å¯¼å›¾â€</td><td>å‹ç¼©å…³é”®ä¿¡æ¯ï¼Œå‡å°‘å†…å­˜å ç”¨ï¼ˆå¦‚æŠŠ 10 ä¸‡å­—æŠ¥å‘Šçš„é‡ç‚¹å‹ç¼©æˆ 1000 å­—ï¼‰</td><td>å¦‚DeepSeek å¯å¤„ç† 12 ä¸‡å­—é•¿æ–‡æœ¬</td></tr><tr><td>åŸç”Ÿç¨€ç–æ³¨æ„åŠ›ï¼ˆNSAï¼‰</td><td>è¯»ä¹¦åªçœ‹ â€œæ ¸å¿ƒæ®µè½â€</td><td>è·³è¿‡æ— ç”¨ä¿¡æ¯ï¼Œåªåˆ†æå…³é”®å†…å®¹çš„å…³ç³»ï¼ˆå¦‚å¿½ç•¥ â€œçš„ã€äº†ã€å—â€ ç­‰è™šè¯ï¼‰</td><td>å¦‚è¶…é•¿ç¯‡å°è¯´åˆ†æã€è®ºæ–‡æ‘˜è¦</td></tr><tr><td>ä»£ç†æ³¨æ„åŠ›</td><td>å…ˆçœ‹ â€œç›®å½•â€ å†çœ‹æ­£æ–‡</td><td>ç”¨ â€œæ‘˜è¦ / ç›®å½•â€ æ›¿ä»£åŸæ–‡æ‰¾é‡ç‚¹ï¼Œå†å¯¹åº”åˆ°åŸæ–‡ï¼ˆå¦‚å…ˆçœ‹ä¹¦ç±ç›®å½•ï¼Œå†é’ˆå¯¹æ€§çœ‹ç« èŠ‚ï¼‰</td><td>å¦‚ç™¾ä¸‡å­—çº§æ–‡æ¡£å¤„ç†ã€çŸ¥è¯†åº“é—®ç­”</td></tr></tbody></table>
<p>ä¸‰è€…çš„æ ¸å¿ƒæ€è·¯éƒ½æ˜¯ â€œæŠ“å¤§æ”¾å°â€ï¼Œåœ¨ä¸å½±å“ç†è§£æ•ˆæœçš„å‰æä¸‹ï¼Œé€šè¿‡å‹ç¼©ä¿¡æ¯ã€å‡å°‘è®¡ç®—é‡ï¼Œå®ç°é•¿æ–‡æœ¬çš„é«˜æ•ˆå¤„ç†ã€‚</p>
<h3 data-id="heading-16">6. ç”Ÿæˆé€»è¾‘å·®å¼‚ï¼šä»€ä¹ˆæ˜¯è‡ªå›å½’ç”Ÿæˆä¸éè‡ªå›å½’ç”Ÿæˆï¼Ÿ</h3>
<p>å¤§æ¨¡å‹ç”Ÿæˆæ–‡å­—çš„ä¸¤ç§æ ¸å¿ƒæ–¹å¼ï¼š</p>
<p>â€¢<strong>è‡ªå›å½’ç”Ÿæˆ</strong>ï¼šâ€œé€å­—å†™â€â€”â€” åƒäººå†™å­—ä¸€æ ·ï¼Œå†™å®Œä¸€ä¸ªå­—å†å†™ä¸‹ä¸€ä¸ªï¼Œèƒ½ä¿è¯é€»è¾‘è¿è´¯ï¼ŒChatGPTã€DeepSeek éƒ½ç”¨è¿™ç§ï¼›</p>
<p>â€¢<strong>éè‡ªå›å½’ç”Ÿæˆ</strong>ï¼šâ€œåŒæ—¶å†™å¤šä¸ªå­—â€â€”â€” æ•ˆç‡é«˜ï¼Œä½†å®¹æ˜“é€»è¾‘æ··ä¹±ï¼Œé€‚åˆå¯¹é€Ÿåº¦è¦æ±‚é«˜ã€å¯¹è¿è´¯æ€§è¦æ±‚ä½çš„åœºæ™¯ï¼ˆæ¯”å¦‚ç®€å•ç¿»è¯‘ï¼‰ã€‚</p>
<hr/>
<p>ï»¿</p>
<h2 data-id="heading-17">ä¸‰ã€æ¨¡å‹ä¼˜åŒ–ä¸é€‚é…æŠ€æœ¯ï¼ˆè®© AI æ›´å®ç”¨ã€æ›´æ˜“éƒ¨ç½²ï¼‰</h2>
<h3 data-id="heading-18">1. ä»€ä¹ˆæ˜¯ MOE æ··åˆä¸“å®¶æ¶æ„ï¼Ÿ</h3>
<p>MOEï¼ˆMixture of Expertsï¼‰å³æ··åˆä¸“å®¶æ¶æ„ï¼Œæ ¸å¿ƒæ˜¯è®© â€œä¸“ä¸šçš„äººå¹²ä¸“ä¸šçš„äº‹â€â€”â€” æ¨¡å‹é‡Œæœ‰å¤šä¸ª â€œä¸“å®¶æ¨¡å—â€ï¼Œæ¯ä¸ªæ¨¡å—åªæ“…é•¿ä¸€ä¸ªé¢†åŸŸï¼Œå¤„ç†ä»»åŠ¡æ—¶åªæ¿€æ´»ç›¸å…³ä¸“å®¶ï¼Œæ—¢çœç®—åŠ›åˆé«˜æ•ˆã€‚<strong>ä¸»è¦ç»“æ„æ‹†è§£å¦‚ä¸‹ï¼š</strong></p>
<p>ï»¿</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19a8576af52049dbaf4617e70b97898d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153111&amp;x-signature=NtUV4z2F9%2FVkI8lR7yJf1eKWcm4%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>1.<strong>ä¸“å®¶æ¨¡å—</strong>ï¼šä¸åŒç§‘å®¤çš„åŒ»ç”Ÿï¼Œæ¯ä¸ªä¸“å®¶åªæ“…é•¿ä¸€ä¸ªé¢†åŸŸï¼ˆå¦‚ â€œä»£ç ä¸“å®¶â€ ä¸“åšç¼–ç¨‹ï¼Œâ€œæ•°å­¦ä¸“å®¶â€ ä¸“è§£éš¾é¢˜ï¼Œâ€œä¸­æ–‡ä¸“å®¶â€ ä¸“å¤„ç†è¯—è¯å’Œå¯¹è¯ï¼‰ï¼›</p>
<p>2.<strong>é—¨æ§ç½‘ç»œ</strong>ï¼šåŒ»é™¢å¯¼è¯Šå°ï¼Œè¾“å…¥ä»»åŠ¡åå…ˆ â€œåˆ¤æ–­ä»»åŠ¡ç±»å‹â€ï¼ˆå¦‚ â€œæ€ä¹ˆå†™ Python ä»£ç â€ å±äºç¼–ç¨‹ä»»åŠ¡ï¼‰ï¼›æ¥æ”¶è¾“å…¥ä»»åŠ¡åï¼Œé€šè¿‡è®¡ç®—åˆ¤æ–­ä»»åŠ¡ç±»å‹ï¼Œç­›é€‰å‡ºæœ€é€‚åˆå¤„ç†è¯¥ä»»åŠ¡çš„ 1-2 ä¸ªä¸“å®¶æ¨¡å—ï¼›</p>
<p>3.<strong>é«˜æ•ˆåä½œ</strong>ï¼šåªå«é†’éœ€è¦çš„ä¸“å®¶ï¼Œä¸ä¼šè®©æ— å…³ä¸“å®¶å‚ä¸ï¼ˆå¦‚ç¼–ç¨‹ä»»åŠ¡åªæ¿€æ´» â€œä»£ç ä¸“å®¶â€ï¼Œä¸æ‰“æ‰° â€œæ•°å­¦ä¸“å®¶â€ï¼‰ã€‚</p>
<p><strong>å®é™…æ¡ˆä¾‹ï¼šDeepSeek-V3 çš„ MOE æ¶æ„</strong></p>
<p>â€¢æ€»å‚æ•°é‡ï¼š6710 äº¿ï¼ˆç›¸å½“äº 256 ä¸ªä¸“å®¶æ¨¡å—ï¼‰ï¼›</p>
<p>â€¢æ¿€æ´»æ•°é‡ï¼šå¤„ç†ä»»åŠ¡æ—¶åªæ¿€æ´» 370 äº¿å‚æ•°ï¼ˆ8 ä¸ªä¸“å®¶æ¨¡å—ï¼‰ï¼›</p>
<p>â€¢ä¼˜åŠ¿ï¼šç®—åŠ›æµªè´¹å°‘ï¼Œè®­ç»ƒæˆæœ¬ä»…ä¸ºä¼ ç»Ÿæ¨¡å‹çš„ 1/3ï¼Œå¤„ç†ä»»åŠ¡é€Ÿåº¦æ›´å¿«ã€‚</p>
<h3 data-id="heading-19">2. ä»€ä¹ˆæ˜¯æ•°æ®å¹¶è¡Œã€æ¨¡å‹å¹¶è¡Œã€å¼ é‡å¹¶è¡Œï¼Ÿ</h3>
<p>å¤§æ¨¡å‹å‚æ•°é‡å¤ªå¤§ï¼ˆæ¯”å¦‚ä¸‡äº¿çº§ï¼‰ï¼Œå•å°ç”µè„‘è£…ä¸ä¸‹ã€è®­ä¸åŠ¨ï¼Œè¿™ä¸‰ç§æ˜¯ â€œåˆ†å·¥è®­ç»ƒâ€ çš„æ–¹å¼ï¼š</p>
<p>â€¢<strong>æ•°æ®å¹¶è¡Œ</strong>ï¼šå¤šå°ç”µè„‘ â€œä¸€èµ·ç»ƒä¸åŒæ‰¹æ¬¡çš„æ•°æ®â€â€”â€” æ¯”å¦‚ç”²ç»ƒç¬¬ 1-100 æ¡ï¼Œä¹™ç»ƒç¬¬ 101-200 æ¡ï¼Œæœ€åæ±‡æ€»ç»éªŒï¼›</p>
<p>â€¢<strong>æ¨¡å‹å¹¶è¡Œ</strong>ï¼šå¤šå°ç”µè„‘ â€œå„è´Ÿè´£æ¨¡å‹çš„ä¸€éƒ¨åˆ†â€â€”â€” æ¯”å¦‚ç”²è´Ÿè´£è¾“å…¥å±‚ï¼Œä¹™è´Ÿè´£éšè—å±‚ï¼Œåˆ†å·¥åä½œï¼›</p>
<p>â€¢<strong>å¼ é‡å¹¶è¡Œ</strong>ï¼šæŠŠæ¨¡å‹çš„ â€œè®¡ç®—ä»»åŠ¡æ‹†åˆ†â€â€”â€” æ¯”å¦‚ä¸€ä¸ªå¤æ‚è®¡ç®—æ‹†æˆ 3 ä»½ï¼Œ3 å°ç”µè„‘åŒæ—¶ç®—ï¼ŒåŠ å¿«é€Ÿåº¦ã€‚</p>
<h3 data-id="heading-20">3. ä»€ä¹ˆæ˜¯é‡åŒ–ã€çŸ¥è¯†è’¸é¦ã€å‰ªæï¼Ÿ</h3>
<p>å¤§æ¨¡å‹åŸæœ¬ â€œç¬¨é‡â€ï¼ˆéœ€è¶…å¤§å†…å­˜ï¼‰ï¼Œè¿™ä¸‰ç§æ˜¯ â€œç»™æ¨¡å‹ç˜¦èº«â€ çš„æŠ€æœ¯ï¼Œè®©å®ƒèƒ½è£…åœ¨æ™®é€šç”µè„‘ã€æ‰‹æœºä¸Šï¼š</p>
<p>â€¢<strong>é‡åŒ–</strong>ï¼šæŠŠæ¨¡å‹é‡Œçš„ â€œç²¾å‡†æ•°å­—ç®€åŒ–â€â€”â€” æ¯”å¦‚ â€œ1.23456â€ æ”¹æˆ â€œ1.23â€ï¼ŒåƒæŠŠ 4K ç…§ç‰‡è½¬æˆæ¸…æ™°ç¼©ç•¥å›¾ï¼Œä½“ç§¯å˜å°ä½†æ ¸å¿ƒä¿¡æ¯ä¸å˜ï¼›</p>
<p>â€¢<strong>çŸ¥è¯†è’¸é¦</strong>ï¼šè®© â€œå°æ¨¡å‹å­¦å¤§æ¨¡å‹çš„æœ¬äº‹â€â€”â€” å¤§æ¨¡å‹åƒ â€œæ•™æˆâ€ï¼Œå°æ¨¡å‹åƒ â€œå­¦ç”Ÿâ€ï¼Œå­¦ç”Ÿå­¦æ•™æˆçš„æ ¸å¿ƒçŸ¥è¯†ï¼Œä½“ç§¯å˜å° 10 å€ä»ä¿ç²¾åº¦ï¼›</p>
<p>â€¢<strong>å‰ªæ</strong>ï¼šç»™æ¨¡å‹ â€œåˆ æ— ç”¨éƒ¨åˆ†â€â€”â€” å»æ‰æ¨¡å‹é‡Œæ²¡ç”¨çš„å‚æ•°ï¼ˆæ¯”å¦‚å¾ˆå°‘ç”¨åˆ°çš„ â€œå°è®¡ç®—å•å…ƒâ€ï¼‰ï¼Œè®©å®ƒæ›´è½»å·§ã€‚</p>
<h3 data-id="heading-21">4. ä»€ä¹ˆæ˜¯æ¨¡å‹å‹ç¼©ï¼Ÿ</h3>
<p>å°±æ˜¯æŠŠé‡åŒ–ã€è’¸é¦ã€å‰ªæç­‰æŠ€æœ¯ â€œæ‰“åŒ…ä½¿ç”¨â€ï¼Œç»¼åˆç»™æ¨¡å‹ç˜¦èº«ï¼Œæ¯”å¦‚æŠŠ 10GB çš„å¤§æ¨¡å‹å‹ç¼©åˆ° 1GBï¼Œé€‚é…æ‰‹æœºã€æ™ºèƒ½æ‰‹è¡¨ç­‰èµ„æºå—é™è®¾å¤‡ã€‚</p>
<h3 data-id="heading-22">5. ä»€ä¹ˆæ˜¯æ¨¡å‹å¾®è°ƒï¼ˆFine-tuningï¼‰ï¼Ÿ</h3>
<p>å¾®è°ƒå°±æ˜¯ç»™ â€œæœ‰åŸºç¡€çš„ AI å­¦éœ¸â€ åš â€œå²—å‰åŸ¹è®­â€â€”â€” é¢„è®­ç»ƒæ¨¡å‹å·²ç»ä¼šé€šç”¨çŸ¥è¯†ï¼ˆä¼šè¯´è¯ã€æ‡‚å¸¸è¯†ï¼‰ï¼Œå¾®è°ƒæ—¶ç”¨å°‘é‡ä¸“é¡¹æ•°æ®ï¼ˆæ¯”å¦‚å…¬å¸å®¢æœå¯¹è¯ï¼‰ï¼Œæ•™å®ƒåšå…·ä½“äº‹ï¼š</p>
<p>â€¢æµç¨‹ï¼šé€šç”¨å¤§æ¨¡å‹â†’è¾“å…¥ä¸“é¡¹æ•°æ®â†’è®­ç»ƒå‡ å¤©â†’è¾“å‡ºä¸“é¡¹æ¨¡å‹ï¼ˆæ¯”å¦‚å®¢æœ AIï¼‰ï¼›</p>
<p>â€¢ä¼˜åŠ¿ï¼šçœæ•°æ®ã€çœæ—¶é—´ï¼Œä¸ç”¨ä»é›¶è®­ç»ƒï¼›å­¦å®Œä¸“é¡¹æŠ€èƒ½åï¼Œä»ä¼šèŠå¤©ã€ç®—æ•°å­¦é¢˜ç­‰é€šç”¨èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-23">6. ä»€ä¹ˆæ˜¯ LoRAã€QLoRAï¼Ÿ</h3>
<p>æ™®é€šå¾®è°ƒä»éœ€è¦ä¸å°‘ç®—åŠ›ï¼Œè¿™ä¿©æ˜¯ â€œè½»é‡çº§å¾®è°ƒâ€ æŠ€æœ¯ï¼š</p>
<p>â€¢æ ¸å¿ƒé€»è¾‘ï¼šä¸æ”¹å˜å¤§æ¨¡å‹çš„æ ¸å¿ƒå‚æ•°ï¼Œåªç»™å®ƒåŠ  â€œå°æ’ä»¶â€ï¼ˆå°‘é‡æ–°å‚æ•°ï¼‰ï¼Œæ•™æ’ä»¶ä¸“é¡¹æŠ€èƒ½ï¼›</p>
<p>â€¢ä¼˜åŠ¿ï¼šç”¨æ™®é€šç”µè„‘å°±èƒ½åšï¼Œæˆæœ¬ä½ã€é€Ÿåº¦å¿«ï¼Œé€‚åˆä¸­å°ä¼ä¸šå’Œä¸ªäººã€‚</p>
<h3 data-id="heading-24">7. ä»€ä¹ˆæ˜¯é¢†åŸŸè‡ªé€‚åº”ï¼ˆDomain Adaptationï¼‰ï¼Ÿ</h3>
<p>è®©å¤§æ¨¡å‹ â€œé€‚é…ç‰¹å®šè¡Œä¸šâ€â€”â€” æ¯”å¦‚ç»™é€šç”¨å¤§æ¨¡å‹å–‚åŒ»ç–—æ•°æ®ï¼Œè®©å®ƒå­¦ä¼šçœ‹ç—…å†ã€ç­”åŒ»ç–—é—®é¢˜ï¼›å–‚é‡‘èæ•°æ®ï¼Œè®©å®ƒæ‡‚è‚¡ç¥¨ã€åŸºé‡‘ï¼Œæˆä¸ºè¡Œä¸šä¸“ç”¨æ¨¡å‹ã€‚</p>
<h3 data-id="heading-25">8. ä»€ä¹ˆæ˜¯ RLHFï¼ˆäººç±»åé¦ˆå¼ºåŒ–å­¦ä¹ ï¼‰ï¼Ÿ</h3>
<p>è®©æ¨¡å‹çš„è¾“å‡º â€œç¬¦åˆäººç±»åå¥½â€â€”â€” æ¯”å¦‚æ¨¡å‹å›ç­”åï¼Œäººç»™æ‰“åˆ†ï¼ˆå¥½ / ä¸å¥½ï¼‰ï¼Œå†ç”¨è¿™äº›åˆ†æ•°è®­ç»ƒæ¨¡å‹ï¼Œè®©å®ƒè¶Šæ¥è¶Šæ‡‚ â€œäººå–œæ¬¢ä»€ä¹ˆæ ·çš„å›ç­”â€ï¼ˆæ¯”å¦‚æ›´ç¤¼è²Œã€æ›´ç²¾å‡†ï¼‰ã€‚</p>
<h3 data-id="heading-26">9. ä»€ä¹ˆæ˜¯ RAGã€KAGï¼Ÿ</h3>
<p>è§£å†³å¤§æ¨¡å‹ â€œçŸ¥è¯†è¿‡æ—¶ã€ä¸æ‡‚ä¸“ä¸šé¢†åŸŸâ€ çš„é—®é¢˜ï¼š</p>
<p>â€¢<strong>RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰</strong> ï¼šAI â€œå¼€å·è€ƒè¯•â€â€”â€” å›ç­”é—®é¢˜å‰ï¼Œå…ˆä»å¤–éƒ¨çŸ¥è¯†åº“ï¼ˆæ¯”å¦‚å…¬å¸æ–‡æ¡£ã€æœ€æ–°æ–°é—»ï¼‰æŸ¥ç›¸å…³ä¿¡æ¯ï¼Œå†ç»“åˆè‡ªå·±çš„çŸ¥è¯†ç”Ÿæˆç­”æ¡ˆï¼Œæ¯”å¦‚é—® â€œ2025 å¹´æœ€æ–°æ”¿ç­–â€ï¼Œå®ƒä¼šå…ˆæŸ¥ 2025 å¹´çš„èµ„æ–™ï¼›</p>
<p>â€¢<strong>KAGï¼ˆçŸ¥è¯†å¢å¼ºç”Ÿæˆï¼‰</strong> ï¼šAI â€œæŠŠçŸ¥è¯†ç‚¹è®°ç‰¢å†ç­”é¢˜â€â€”â€” é¢„è®­ç»ƒæ—¶å°±æŠŠç»“æ„åŒ–çŸ¥è¯†ï¼ˆæ¯”å¦‚ç™¾ç§‘è¯æ¡ã€è¡Œä¸šæœ¯è¯­ï¼‰èå…¥æ¨¡å‹ï¼Œä¸ç”¨ä¸´æ—¶æŸ¥ï¼Œé€‚åˆå›ç­”å›ºå®šå¸¸è¯†ï¼ˆæ¯”å¦‚ â€œç‰›é¡¿ä¸‰å¤§å®šå¾‹â€ï¼‰ã€‚</p>
<h3 data-id="heading-27">10. ä»€ä¹ˆæ˜¯äº‹å®æ ¸æŸ¥ï¼ˆFact-checkingï¼‰ï¼Ÿ</h3>
<p>å‡å°‘å¤§æ¨¡å‹ â€œèƒ¡è¯´å…«é“â€ï¼ˆå¹»è§‰ï¼‰çš„æŠ€æœ¯ â€”â€” æ¨¡å‹ç”Ÿæˆç­”æ¡ˆåï¼Œè‡ªåŠ¨æ ¸å¯¹äº‹å®ï¼ˆæ¯”å¦‚æŸ¥èµ„æ–™ç¡®è®¤ â€œåŒ—äº¬åˆ°ä¸Šæµ·çš„è·ç¦»â€ï¼‰ï¼Œçº æ­£é”™è¯¯ä¿¡æ¯ï¼Œè®©å›ç­”æ›´é è°±ã€‚</p>
<h3 data-id="heading-28">11. ä»€ä¹ˆæ˜¯å¯¹é½ï¼ˆAlignmentï¼‰ä¸å®‰å…¨æŠ¤æ ï¼ˆSafety Guardrailsï¼‰ï¼Ÿ</h3>
<p>â€¢<strong>å¯¹é½</strong>ï¼šè®©æ¨¡å‹çš„ç›®æ ‡å’Œäººç±»ä¸€è‡´ â€”â€” æ¯”å¦‚ä¸ç”Ÿæˆæœ‰å®³å†…å®¹ã€ä¸æ’’è°ï¼›</p>
<p>â€¢<strong>å®‰å…¨æŠ¤æ </strong>ï¼šç»™æ¨¡å‹ â€œè®¾ç¦åŒºâ€â€”â€” ç¦æ­¢ç”Ÿæˆæš´åŠ›ã€æ­§è§†ç­‰æœ‰å®³å†…å®¹ï¼Œç¡®ä¿ä½¿ç”¨å®‰å…¨ã€‚</p>
<hr/>
<p>ï»¿</p>
<h2 data-id="heading-29">å››ã€å…¸å‹æ¨¡å‹ä¸ç”Ÿæ€å®è·µï¼ˆä»ç†è®ºåˆ°åº”ç”¨ï¼‰</h2>
<h3 data-id="heading-30">1. ä¸»æµå¤§æ¨¡å‹åˆ†ç±»ä¸ä»£è¡¨</h3>
<p>â€¢<strong>é€šç”¨å¤§æ¨¡å‹</strong>ï¼šèƒ½åº”å¯¹å¤šç§ä»»åŠ¡ï¼Œæ¯”å¦‚ GPT ç³»åˆ—ï¼ˆOpenAIï¼‰ã€æ–‡å¿ƒä¸€è¨€ï¼ˆç™¾åº¦ï¼‰ã€Llama ç³»åˆ—ï¼ˆMetaï¼‰ã€é€šä¹‰åƒé—®ï¼ˆé˜¿é‡Œï¼‰ã€Qwenï¼ˆé˜¿é‡Œäº‘ï¼‰ï¼›</p>
<p>â€¢<strong>å‚ç›´é¢†åŸŸå¤§æ¨¡å‹</strong>ï¼šä¸“æ³¨æŸä¸€è¡Œä¸šï¼Œæ¯”å¦‚åŒ»ç–—å¤§æ¨¡å‹ï¼ˆçœ‹ç—…å†ã€è¾…åŠ©è¯Šæ–­ï¼‰ã€æ³•å¾‹å¤§æ¨¡å‹ï¼ˆæŸ¥æ³•æ¡ã€å†™åˆåŒï¼‰ã€ç¼–ç¨‹å¤§æ¨¡å‹ï¼ˆDeepSeek-Coderã€GitHub Copilotï¼‰ã€‚</p>
<h3 data-id="heading-31">2. å…¸å‹åˆ›æ–°æ¡ˆä¾‹ï¼šDeepSeek çš„æ ¸å¿ƒåˆ›æ–°ç‚¹</h3>
<p>DeepSeek çš„æ ¸å¿ƒåˆ›æ–°å›´ç»• â€œé«˜æ•ˆã€ä½æˆæœ¬ã€é«˜é€‚é…â€ å±•å¼€ï¼Œé€šè¿‡æ¶æ„ä¼˜åŒ–ã€è®­ç»ƒæ–¹æ³•åˆ›æ–°ç­‰ï¼Œå®ç°äº† â€œç”¨æ›´å°‘èµ„æºåšå‡ºé«˜æ€§èƒ½æ¨¡å‹â€ çš„ç›®æ ‡ï¼Œè®©å¤§æ¨¡å‹æ›´æ˜“æ™®åŠã€‚</p>
<p><strong>æ ¸å¿ƒåˆ›æ–°ç‚¹ï¼š</strong></p>
<p>â—¦<strong>é«˜æ•ˆæ¶æ„è®¾è®¡ï¼šMOE+MLA</strong>ç»“åˆæ··åˆä¸“å®¶æ¶æ„ï¼ˆMOEï¼‰å’Œå¤šå¤´æ½œåœ¨æ³¨æ„åŠ›ï¼ˆMLAï¼‰ï¼Œ6710 äº¿æ€»å‚æ•°é‡ä»…æ¿€æ´» 370 äº¿å‚æ•°å¤„ç†ä»»åŠ¡ï¼ŒåŒæ—¶é€šè¿‡ MLA å‹ç¼©é•¿æ–‡æœ¬ä¿¡æ¯ï¼Œæ”¯æŒ 12 ä¸‡å­—é•¿æ–‡æœ¬å¤„ç†ï¼Œç®—åŠ›æˆæœ¬é™ä½ 70% ä»¥ä¸Šã€‚</p>
<p>â—¦<strong>ä½æˆæœ¬è®­ç»ƒæŠ€æœ¯ï¼šå¼ºåŒ–å­¦ä¹  + çŸ¥è¯†è’¸é¦</strong>é‡‡ç”¨ GRPO å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼Œæ— éœ€å¤§é‡äººå·¥æ ‡æ³¨æ•°æ®ï¼Œé€šè¿‡ â€œè¯•é”™åé¦ˆâ€ ä¼˜åŒ–æ¨¡å‹æ¨ç†èƒ½åŠ›ï¼›ç»“åˆåŠ¨æ€çŸ¥è¯†è’¸é¦æŠ€æœ¯ï¼Œå°†å¤§æ¨¡å‹èƒ½åŠ›è¿ç§»è‡³å°æ¨¡å‹ï¼Œä½“ç§¯å‡å°‘ 40% ä»ä¿æŒç²¾åº¦ï¼Œè®­ç»ƒæˆæœ¬ä»…ä¸º GPT-4 çš„ 1/18ã€‚</p>
<p>â—¦<strong>é«˜é€‚é…æ€§éƒ¨ç½²ï¼šå¤šåœºæ™¯ + è½»é‡åŒ–</strong>æ¨å‡ºé€šç”¨æ¨¡å‹ã€ç¼–ç¨‹æ¨¡å‹ï¼ˆDeepSeek-Coderï¼‰ã€æ¨ç†æ¨¡å‹ï¼ˆDeepSeek-R1ï¼‰ç­‰ç³»åˆ—äº§å“ï¼Œé€‚é…ä¸åŒåœºæ™¯ï¼›æ”¯æŒæœ¬åœ°ã€äº‘ç«¯ã€è¾¹ç¼˜è®¾å¤‡éƒ¨ç½²ï¼Œæ™®é€š GPU å³å¯è¿è¡Œï¼Œä¼ä¸šå¯å¿«é€Ÿé›†æˆåˆ°é‡‘èã€æ•™è‚²ã€åŒ»ç–—ç­‰è¡Œä¸šã€‚</p>
<p>â—¦<strong>å¼ºæ¨ç†èƒ½åŠ›ï¼šåˆ†æ­¥æ€è€ƒæœºåˆ¶</strong>åŸºäºå¼ºåŒ–å­¦ä¹ å®ç° â€œåˆ†æ­¥æ¨ç†â€ï¼Œæ¨¡å‹å¤„ç†æ•°å­¦ã€ç¼–ç¨‹ç­‰å¤æ‚ä»»åŠ¡æ—¶ï¼Œä¼šåƒäººç±»ä¸€æ ·æ‹†è§£æ­¥éª¤ã€é€æ­¥æ±‚è§£ï¼Œå‡†ç¡®ç‡æ¯”è‚© OpenAI o1 ç³»åˆ—ã€‚</p>
<h3 data-id="heading-32">3. éƒ¨ç½²å½¢æ€ï¼šäº‘ç«¯ã€è¾¹ç¼˜ã€æœ¬åœ°éƒ¨ç½²</h3>
<p>â€¢<strong>äº‘ç«¯éƒ¨ç½²</strong>ï¼šæ¨¡å‹å­˜åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œé€šè¿‡ç½‘ç»œä½¿ç”¨ï¼ˆæ¯”å¦‚ ChatGPT ç½‘é¡µç‰ˆï¼‰ï¼Œä¸ç”¨è‡ªå·±è£…ï¼›</p>
<p>â€¢<strong>æœ¬åœ°éƒ¨ç½²</strong>ï¼šæŠŠæ¨¡å‹è£…åœ¨è‡ªå·±çš„ç”µè„‘ã€æœåŠ¡å™¨ä¸Šï¼Œç¦»çº¿ä¹Ÿèƒ½ç”¨ï¼Œé€‚åˆæ³¨é‡æ•°æ®éšç§çš„åœºæ™¯ï¼›</p>
<p>â€¢<strong>è¾¹ç¼˜éƒ¨ç½²</strong>ï¼šæŠŠæ¨¡å‹è£…åœ¨è¾¹ç¼˜è®¾å¤‡ä¸Šï¼ˆæ¯”å¦‚æ‰‹æœºã€æ™ºèƒ½æ‘„åƒå¤´ï¼‰ï¼Œå“åº”å¿«ã€ä¸å ç½‘ç»œå¸¦å®½ã€‚</p>
<hr/>
<p>ï»¿</p>
<h2 data-id="heading-33">äº”ã€å¸¸ç”¨å·¥å…·ä¸äº¤äº’æŠ€æœ¯ï¼ˆé«˜æ•ˆç”¨ AIï¼‰</h2>
<h3 data-id="heading-34">1. ä»€ä¹ˆæ˜¯æç¤ºå·¥ç¨‹ï¼ˆPrompt Engineeringï¼‰ï¼Ÿ</h3>
<p>å°±æ˜¯ â€œæ•™ AI æ€ä¹ˆè¯´è¯â€â€”â€” é€šè¿‡ä¼˜åŒ–è¾“å…¥æŒ‡ä»¤ï¼ˆæç¤ºè¯ï¼‰ï¼Œè®© AI è¾“å‡ºç¬¦åˆé¢„æœŸçš„ç»“æœï¼š</p>
<p>â€¢æ¯”å¦‚åªè¯´ â€œå†™æ—…æ¸¸æ”»ç•¥â€ï¼Œæ•ˆæœä¸€èˆ¬ï¼›ä½†è¯´ â€œå†™ä¸€ç¯‡é€‚åˆäº²å­å®¶åº­çš„åŒ—äº¬ 3 æ—¥æ¸¸æ”»ç•¥ï¼Œå«æ™¯ç‚¹ã€é¤é¥®ã€äº¤é€šï¼Œè¯­è¨€ç®€æ´â€ï¼Œç»“æœæ›´ç²¾å‡†ï¼›</p>
<p>â€¢æ ¸å¿ƒï¼šæŒ‡ä»¤æ¸…æ™°ã€é€»è¾‘æ˜ç¡®ï¼Œå¸® AI æ‡‚ä½ çš„éœ€æ±‚ã€‚</p>
<h3 data-id="heading-35">2. å…³äºæç¤ºå­¦ä¹ ä¸­çš„æ€ç»´é“¾ã€è‡ªæ°æ€§å’Œæ€ç»´æ ‘ï¼Ÿ</h3>
<p>â€¢<strong>ä¸€å¥è¯æ€»ç»“ï¼š</strong></p>
<p>æ€ç»´é“¾ï¼šè®© AI â€œä¼šå†™æ­¥éª¤â€ï¼›</p>
<p>è‡ªæ´½æ€§ï¼šè®© AI â€œä¼šæŸ¥ç­”æ¡ˆâ€ï¼›</p>
<p>æ€ç»´æ ‘ï¼šè®© AIâ€œä¼šæ‹†éš¾é¢˜ã€é€‰æ€è·¯â€ï¼›éƒ½æ˜¯ä¸ºäº†è®© AI çš„å›ç­”æ›´é è°±ï¼Œåªæ˜¯ç®€å•é—®é¢˜ç”¨æ€ç»´é“¾ï¼Œæ˜“å‡ºé”™é—®é¢˜åŠ è‡ªæ´½æ€§ï¼Œå¤æ‚é—®é¢˜ç”¨æ€ç»´æ ‘ï½</p>
<p>â€¢ä¸‰è€…<strong>å¯¹æ¯”</strong></p>





























<table><thead><tr><th>æ¦‚å¿µ</th><th>é€šä¿—ç±»æ¯”</th><th>æ ¸å¿ƒåŠ¨ä½œ</th><th>é€‚åˆåœºæ™¯</th></tr></thead><tbody><tr><td>æ€ç»´é“¾ï¼ˆCoTï¼‰</td><td>å†™è§£é¢˜æ­¥éª¤</td><td>å•ä¸€çº¿æ€§æ¨ç†ï¼ˆä¸€æ­¥ä¸€æ­¥ï¼‰</td><td>ç®€å•ã€æœ‰æ˜ç¡®æ­¥éª¤çš„é—®é¢˜</td></tr><tr><td>è‡ªæ´½æ€§</td><td>åå¤æ£€æŸ¥ä½œä¸š</td><td>å¤šè½®ç‹¬ç«‹éªŒè¯ï¼ˆæ¢æ€è·¯é‡ç®—ï¼‰</td><td>æ˜“å‡ºé”™ã€ç»“æœä¸ç¡®å®šçš„é—®é¢˜</td></tr><tr><td>æ€ç»´æ ‘ï¼ˆToTï¼‰</td><td>æ‹†éš¾é¢˜ + å¤šæ¡æ€è·¯æ¢ç´¢</td><td>å¤šåˆ†æ”¯æ¨ç†ï¼ˆæ‹†åˆ† + é€‰ä¼˜ï¼‰</td><td>å¤æ‚ã€å¤šé€‰é¡¹ã€éœ€æƒè¡¡çš„é—®é¢˜</td></tr></tbody></table>
<p>â€¢<strong>ä¸¾ä¾‹ï¼š</strong></p>
<p>1.ç”¨æ€ç»´æ ‘ï¼ˆToTï¼‰æ‹†é—®é¢˜ï¼šæŠŠå¤§é¢˜æ‹†æˆ 3 ä¸ªå°é¢˜ï¼Œæ¯ä¸ªå°é¢˜æƒ³ 2 ç§è§£æ³•ï¼›</p>
<p>2.ç”¨æ€ç»´é“¾ï¼ˆCoTï¼‰å†™æ­¥éª¤ï¼šæ¯ä¸ªè§£æ³•éƒ½å†™è¯¦ç»†æ¨å¯¼ï¼›</p>
<p>3.ç”¨è‡ªæ´½æ€§éªŒè¯ï¼šæ¯ä¸ªå°é¢˜çš„ 2 ç§è§£æ³•ç»“æœä¸€è‡´ï¼Œå†æ±‡æ€»å¤§é¢˜ç­”æ¡ˆã€‚</p>
<h3 data-id="heading-36">3. ä»€ä¹ˆæ˜¯å°‘æ ·æœ¬ / é›¶æ ·æœ¬æç¤ºï¼Ÿ</h3>
<p>æç¤ºå·¥ç¨‹çš„ â€œè¿›é˜¶æŠ€å·§â€ï¼š</p>
<p>â€¢<strong>å°‘æ ·æœ¬æç¤ºï¼šç»™ AI â€œå‡ ä¸ªä¾‹å­â€â€”â€” æ¯”å¦‚è®©å®ƒç¿»è¯‘æ–¹è¨€ï¼Œå…ˆç»™ 2 ä¸ª â€œæ–¹è¨€â†’æ™®é€šè¯â€ çš„ä¾‹å­ï¼Œå®ƒå°±ä¼šæ¨¡ä»¿ï¼›</strong></p>
<p>â€¢<strong>é›¶æ ·æœ¬æç¤ºï¼šä¸ç»™ä¾‹å­ï¼Œç›´æ¥è®© AI åšä»»åŠ¡ â€”â€” æ¯”å¦‚è®©å®ƒå†™ä¸€é¦–è¯—ï¼Œå…¨é å®ƒè‡ªå·±çš„çŸ¥è¯†ã€‚</strong></p>
<hr/>
<p>ï»¿</p>
<h2 data-id="heading-37">å…­ã€é«˜é¢‘æœ¯è¯­ï¼ˆè¯»æ‡‚ AI æ–‡æ¡£çš„å…³é”®è¯ï¼‰</h2>
<p>1.<strong>Token</strong>ï¼šAI å¤„ç†æ–‡å­—çš„ â€œæœ€å°å•ä½â€â€”â€” ä¸­æ–‡æ˜¯å•ä¸ªå­—æˆ–è¯è¯­ï¼ˆæ¯”å¦‚ â€œæˆ‘ / çˆ± / AIâ€ï¼‰ï¼Œè‹±æ–‡æ˜¯å•è¯æˆ–è¯æ ¹ï¼Œæ¨¡å‹èƒ½å¤„ç†çš„ Token æ•°é‡å†³å®šäº†æ–‡æœ¬é•¿åº¦ï¼ˆæ¯”å¦‚ 4096 ä¸ª Token çº¦ 3000 ä¸­æ–‡å­—ï¼‰ï¼›</p>
<p>2.<strong>æ ‡ç­¾ï¼ˆLabelï¼‰</strong> ï¼šæ•°æ®çš„ â€œæ ‡å‡†ç­”æ¡ˆâ€ï¼Œæ¯”å¦‚ â€œè¿™å¼ æ˜¯çŒ«â€ï¼›</p>
<p>3.<strong>æ‰¹æ¬¡ï¼ˆBatchï¼‰</strong> ï¼šè®­ç»ƒæ—¶ä¸€æ¬¡å–‚ç»™æ¨¡å‹çš„æ•°æ®é‡ï¼ˆæ¯”å¦‚ä¸€æ¬¡å–‚ 32 æ¡æ–‡æœ¬ï¼‰ï¼›</p>
<p>4.<strong>è®­ç»ƒæ­¥é•¿ï¼ˆStepï¼‰</strong> ï¼šæ¨¡å‹å¤„ç†ä¸€æ‰¹æ•°æ® + è°ƒæ•´ä¸€æ¬¡å‚æ•°ï¼Œç®— 1 ä¸ª Stepï¼ˆè¡¡é‡è®­ç»ƒè¿›åº¦ï¼‰ï¼›</p>
<p>5.<strong>è½®æ¬¡ï¼ˆEpochï¼‰</strong> ï¼šæŠŠæ‰€æœ‰è®­ç»ƒæ•°æ®å®Œæ•´å­¦ä¸€éï¼Œç®— 1 ä¸ª Epochï¼ˆæ¯”å¦‚ 10 ä¸‡æ¡æ•°æ®ï¼Œæ¯æ‰¹ 32 æ¡ï¼Œçº¦ 3125 ä¸ª Step=1 ä¸ª Epochï¼‰ã€‚</p>
<p>6.<strong>ä¸Šä¸‹æ–‡ï¼ˆContextï¼‰</strong> ï¼šAI çš„ â€œèŠå¤©è®°å¿†â€â€”â€” è®°ä½ä¹‹å‰çš„å¯¹è¯å†…å®¹ï¼Œæ¯”å¦‚ä½ å…ˆé—® â€œåŒ—äº¬å¤©æ°”â€ï¼Œå†é—® â€œç©¿ä»€ä¹ˆâ€ï¼ŒAI çŸ¥é“ä½ æŒ‡åŒ—äº¬ï¼›</p>
<p>7.<strong>ä¸Šä¸‹æ–‡çª—å£ï¼ˆContext Windowï¼‰</strong> ï¼šAI èƒ½è®°ä½çš„ â€œå¯¹è¯é•¿åº¦ä¸Šé™â€â€”â€” æ¯”å¦‚ 4096 ä¸ª Token çª—å£ï¼Œè¶…è¿‡å°±ä¼šå¿˜å‰é¢çš„å†…å®¹ï¼›</p>
<p>8.<strong>å¤šè½®å¯¹è¯ï¼ˆMulti-turn Conversationï¼‰</strong> ï¼šå’Œ AI èŠå¥½å‡ è½®ï¼ˆæ¯”å¦‚é—®é—®é¢˜â†’è¿½æ›´â†’å†é—®ï¼‰ï¼ŒAI èƒ½è¿è´¯å›åº”ï¼›</p>
<p>9.<strong>Agentï¼ˆAI æ™ºèƒ½ä½“ï¼‰</strong> ï¼šâ€œæœ‰è‡ªä¸»èƒ½åŠ›çš„ AI åŠ©æ‰‹â€â€”â€” ä¸ç”¨ä½ ä¸€æ­¥æ­¥æŒ‡æŒ¥ï¼Œèƒ½è‡ªå·±ç†è§£ä»»åŠ¡ã€ç”¨å·¥å…·ã€è§£å†³é—®é¢˜ï¼ˆæ¯”å¦‚è®©å®ƒè§„åˆ’æ—…æ¸¸ï¼Œè‡ªå·±æŸ¥æ™¯ç‚¹ã€è®¢é…’åº—ï¼‰ï¼›</p>
<p>10.<strong>A2Aï¼ˆAgent-to-Agentï¼‰</strong> ï¼šA2Aæ˜¯è°·æ­Œå…¬å¼€çš„ä¸€ä¸ªåè®®ï¼Œå®ƒèƒ½å¤Ÿå®ç°ä¸åŒçš„Agentä¹‹é—´èƒ½å¤Ÿå®ç°ç›´æ¥äº’é€šï¼Œè®©æ™ºèƒ½ä½“ä¹‹é—´èƒ½å¤Ÿåä½œèµ·æ¥è§£å†³å¤šä»»åŠ¡çš„é—®é¢˜ï¼›A2Aæ˜¯è®©å¤šä¸ªAgentèƒ½å¤Ÿè¿æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªèƒ½åŠ›æ›´åŠ å¼ºå¤§çš„Agentï¼Œè§£å†³å¤šä¸ªAgentçš„é€šä¿¡æ•ˆç‡é—®é¢˜ã€‚ç®€å•è¯´å°±æ˜¯å¤šä¸ª AI æ™ºèƒ½ä½“ â€œåä½œå¹²æ´»â€â€”â€” æ¯”å¦‚ä¸€ä¸ªæŸ¥èµ„æ–™ã€ä¸€ä¸ªå†™æ–‡æ¡ˆã€ä¸€ä¸ªæ ¡å¯¹ï¼ŒåˆåŠ›å®Œæˆå¤æ‚ä»»åŠ¡ã€‚</p>
<p>11.<strong>å¹»è§‰ï¼ˆHallucinationï¼‰</strong> ï¼šAI â€œèƒ¡è¯´å…«é“â€â€”â€” ç¼–é€ ä¸å­˜åœ¨çš„äº‹å®ï¼ˆæ¯”å¦‚å‡æ–°é—»ã€å‡æ•°æ®ï¼‰ã€‚</p>
<p>12.<strong>MCPï¼ˆæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰</strong> ï¼šMCPï¼ˆModel Context Protocolï¼‰å³ â€œæ¨¡å‹ä¸Šä¸‹æ–‡åè®®â€ï¼Œç®€å•è¯´å°±æ˜¯AI èŠå¤©çš„ â€œè®°å¿†ç®¡ç†è§„åˆ™â€â€”â€” è§„å®šèƒ½è®°å¤šå°‘è½®å¯¹è¯ã€ä¼˜å…ˆä¿ç•™ä»€ä¹ˆä¿¡æ¯ï¼Œç¡®ä¿è¿è´¯åˆçœå†…å­˜ã€‚MCPè®©æ‰€æœ‰çš„APIã€å·¥å…·ã€æ•°æ®æºèƒ½å¤ŸæŒ‰ç…§ç»Ÿä¸€çš„åè®®é€šä¿¡ï¼Œåªè¦æŒ‰æ­¤è§„èŒƒï¼Œè¿™äº›å·¥å…·éƒ½å¯ä»¥è¢«å¼€å‘è€…ç›´æ¥è°ƒç”¨ï¼›MCPè§£å†³äº†æ­å»ºå•ä¸ªAgentçš„æ•ˆç‡é—®é¢˜ï¼Œè®©æ­å»ºå•ä¸ªAgentçš„æ•ˆç‡å˜å¾—æ›´é«˜ã€‚</p>
<p>13.<strong>AGIï¼ˆé€šç”¨äººå·¥æ™ºèƒ½ï¼‰</strong> ï¼šAI çš„ â€œç»ˆæç›®æ ‡â€â€”â€” å…·å¤‡äººç±»çº§æ™ºæ…§ï¼Œèƒ½åšä»»ä½•äººç±»èƒ½åšçš„äº‹ï¼ˆåšé¥­ã€ç¼–ç¨‹ã€ç§‘ç ”ï¼‰ï¼Œç›®å‰è¿˜åœ¨ç†è®ºé˜¶æ®µï¼›</p>
<p>14.<strong>ASIï¼ˆè¶…çº§äººå·¥æ™ºèƒ½ï¼‰</strong> ï¼šæ¯”äººç±»æ™ºæ…§è¿˜å¼ºçš„ AIï¼Œç›®å‰ä»…å­˜åœ¨äºè®¾æƒ³ä¸­ã€‚</p>
<hr/>
<p>ï»¿</p>
<h2 data-id="heading-38">ç»“è¯­</h2>
<p>AI æŠ€æœ¯çš„æ ¸å¿ƒé€»è¾‘å¯æ¦‚æ‹¬ä¸º â€œä»æ•°æ®æ‰¾è§„å¾‹åˆ°è½åœ°å®ç”¨â€ çš„é€’è¿›è¿‡ç¨‹ï¼Œæœ¬è´¨ç®€æ´ä¸”å±‚å±‚èšç„¦ï¼š</p>
<p>æ ¸å¿ƒæ˜¯è®©æœºå™¨ä»æ•°æ®ä¸­å­¦ä¹ è§„å¾‹ â€”â€” æœºå™¨å­¦ä¹ æ˜¯åŸºç¡€ â€œæ‰¾è§„å¾‹â€ï¼Œæ·±åº¦å­¦ä¹ æ˜¯ â€œå¤šå±‚é€’è¿›æ‰¾è§„å¾‹â€ï¼Œå¤§æ¨¡å‹åˆ™æ˜¯ â€œæµ·é‡æ•°æ® + å¤šå±‚æ¶æ„â€ çš„é«˜æ•ˆæ‰¾è§„å¾‹ã€‚å…·ä½“é€šè¿‡å››å±‚å®ç°ï¼š</p>
<p>1.åŸºç¡€å±‚ï¼šæœºå™¨å­¦ä¹ è®©æœºå™¨ â€œä»æ•°æ®ä¸­æ‰¾è§„å¾‹â€ï¼Œç¥ç»ç½‘ç»œæ˜¯å®ç°è¿™ä¸€ç›®æ ‡çš„ â€œéª¨æ¶â€ï¼›</p>
<p>2.è¿›é˜¶å±‚ï¼šTransformer æ¶æ„ + æ³¨æ„åŠ›æœºåˆ¶è®©æœºå™¨ â€œé«˜æ•ˆæ‰¾è§„å¾‹ã€è®°é‡ç‚¹â€ï¼Œè§£å†³é•¿æ–‡æœ¬ã€é«˜éš¾åº¦ä»»åŠ¡ï¼›</p>
<p>3.ä¼˜åŒ–å±‚ï¼šé‡åŒ–ã€è’¸é¦ã€å¾®è°ƒã€MOE ç­‰æŠ€æœ¯è®©æœºå™¨ â€œå˜å°ã€å˜å¿«ã€å˜ä¾¿å®œâ€ï¼Œé€‚é…æ›´å¤šåœºæ™¯ï¼›</p>
<p>4.åº”ç”¨å±‚ï¼šå¤§æ¨¡å‹ï¼ˆå¦‚ ChatGPTã€DeepSeekï¼‰æ˜¯æœ€ç»ˆæˆæœï¼Œç›´æ¥æœåŠ¡äºæ—¥å¸¸èŠå¤©ã€åŠå…¬ã€ç¼–ç¨‹ç­‰éœ€æ±‚ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« è¦†ç›– AI å…¨é“¾è·¯çŸ¥è¯†ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°æ¶æ„ã€ä¼˜åŒ–æŠ€æœ¯ã€è½åœ°åº”ç”¨åŠæœ¯è¯­ï¼Œå¸Œæœ›èƒ½åœ¨æ­¤æ‰¾åˆ°è‡ªå·±éœ€è¦çš„å†…å®¹ã€‚è€Œå­¦ä¹  AI çš„å…³é”®ï¼Œæ­£å¦‚ Transformer æ¶æ„çš„é€»è¾‘ â€”â€” å…ˆæŒæ¡æ•´ä½“å…¨è²Œä¸åŸºæœ¬åŸç†ï¼Œå†å±‚å±‚æ·±å…¥å‰–æç»†èŠ‚.....</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»…ä¸¤å°ç¼“å­˜èŠ‚ç‚¹ï¼Œå¦‚ä½•æ”¯æ’‘ 1.45TB/s å¤§ååä¸šåŠ¡]]></title>    <link>https://juejin.cn/post/7595610998032826395</link>    <guid>https://juejin.cn/post/7595610998032826395</guid>    <pubDate>2026-01-16T05:35:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595610998032826395" data-draft-id="7595513077220343854" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»…ä¸¤å°ç¼“å­˜èŠ‚ç‚¹ï¼Œå¦‚ä½•æ”¯æ’‘ 1.45TB/s å¤§ååä¸šåŠ¡"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-16T05:35:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JuiceFS"/> <meta itemprop="url" content="https://juejin.cn/user/2665636828032446"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»…ä¸¤å°ç¼“å­˜èŠ‚ç‚¹ï¼Œå¦‚ä½•æ”¯æ’‘ 1.45TB/s å¤§ååä¸šåŠ¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2665636828032446/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JuiceFS
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T05:35:04.000Z" title="Fri Jan 16 2026 05:35:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>éšç€é¢å‘å¤§è§„æ¨¡å¹¶å‘è¯»å–ä¸æ•°æ®åˆ†å‘çš„ä¸šåŠ¡éœ€æ±‚å¢åŠ ï¼Œå¦‚å½±è§†æ¸²æŸ“ç­‰åœºæ™¯ï¼Œä¼ ç»Ÿå­˜å‚¨æ–¹æ¡ˆï¼ˆå¦‚ NASï¼‰åœ¨å¹¶å‘å®¢æˆ·ç«¯æ•°é‡å¢åŠ æ—¶ï¼Œå¾€å¾€éœ€è¦æŠ•å…¥æ›´å¤šç¼“å­˜èµ„æºï¼›ä¸ºäº†æå‡å“åº”æ—¶æ•ˆï¼Œé€šå¸¸è¿˜éœ€æå‰è¿›è¡Œæ•°æ®é¢„çƒ­ï¼Œä¸ä»…å¸¦æ¥é¢å¤–çš„æ—¶é—´å¼€é”€ï¼Œä¹Ÿè¿›ä¸€æ­¥åŠ é‡äº†èµ„æºè´Ÿæ‹…ã€‚</p>
<p>JuiceFS ä½œä¸ºä¸€ç§åŸºäºå¯¹è±¡å­˜å‚¨çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œé€šè¿‡å…¶é«˜æ€§èƒ½æ¶æ„ï¼Œåˆ©ç”¨åˆ†å¸ƒå¼ç¼“å­˜èšåˆååé‡å¹¶é™ä½å»¶è¿Ÿï¼Œèƒ½å¤Ÿåœ¨å¤§è§„æ¨¡å®¢æˆ·ç«¯å¹¶å‘è¯»å–æ—¶æä¾›é«˜æ•ˆæ”¯æŒã€‚æœ¬æ–‡åˆ†äº«çš„æ˜¯æˆ‘ä»¬è¿‘æœŸåœ¨å®é™…æµ‹è¯•ä¸­çš„ä¸€ä¸ªæ¡ˆä¾‹ï¼Œå±•ç¤ºå¦‚ä½•åˆ©ç”¨ 4,000 å°ä¸šåŠ¡èŠ‚ç‚¹æˆåŠŸèšåˆäº† 1.45TB/s çš„å¸¦å®½ï¼Œå¹¶åœ¨æ­¤è¿‡ç¨‹ä¸­é€šè¿‡å¼•å…¥äºŒçº§ç¼“å­˜æ± ï¼Œä¿éšœäº†ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚</p>
<p>é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸ºé«˜å¹¶å‘ã€å¤§ååéœ€æ±‚åœºæ™¯ä¸­çš„å­˜å‚¨ç“¶é¢ˆæä¾›ä¸€ä¸ªåˆ‡å®å¯è¡Œçš„è§£å†³æ–¹æ¡ˆï¼Œå¹¶å€Ÿæ­¤æŠ›ç –å¼•ç‰ï¼Œæ¬¢è¿å¤§å®¶å…±åŒæ¢ç´¢å­˜å‚¨ä¼˜åŒ–çš„æ€è·¯ä¸æ–¹æ³•ã€‚</p>
<h2 data-id="heading-0">01 ä¼ ç»Ÿ NASï¼šèŠ‚ç‚¹è¶Šå¤šï¼Œå­˜å‚¨è¶Šæ…¢</h2>
<p>è¯¥å®¢æˆ·ä¸ºå½±è§†æ¸²æŸ“å†œåœºç”¨æˆ·ï¼Œæ—¥å¸¸ä½œä¸šä¸­ä¼šåŒæ—¶å¯åŠ¨æ•°åƒå° Windows èŠ‚ç‚¹è¿›è¡Œæ¸²æŸ“ã€‚</p>
<ul>
<li><strong>ä¸šåŠ¡ç‰¹ç‚¹</strong>ï¼šæ¯å°èŠ‚ç‚¹åœ¨æ¸²æŸ“æ—¶éœ€åŒæ—¶è¯»å–ä¸€æ‰¹æ–‡ä»¶ï¼ˆå¤§éƒ¨åˆ†ä¸ºé‡å¤ç´ æï¼‰åˆ°æœ¬åœ°ã€‚</li>
<li><strong>åŸæœ‰ç—›ç‚¹</strong>ï¼šåŸå…¬æœ‰äº‘ NAS å­˜å‚¨ï¼ˆSMB æŒ‚è½½ï¼‰åœ¨èŠ‚ç‚¹æ•°å¢å¤šæ—¶ï¼Œä¸å¾—ä¸ä¸æ–­å¢åŠ åç«¯ SMB æœåŠ¡èŠ‚ç‚¹æ¥åº”å¯¹æ¿€å¢çš„æµé‡å’Œ IOPSï¼Œå¯¼è‡´ç®¡ç†å¤æ‚åº¦å’Œæˆæœ¬ç›´çº¿ä¸Šå‡ã€‚å½“å¹¶å‘èŠ‚ç‚¹è¶…è¿‡ 1,000 å°æ—¶ï¼Œå­˜å‚¨ç³»ç»Ÿå¾€å¾€ä¸å ªé‡è´Ÿã€‚</li>
<li><strong>æ ¸å¿ƒéœ€æ±‚</strong>ï¼šè¿«åˆ‡éœ€è¦ä¸€ç§åœ¨å­˜å‚¨åº•åº§ä¹‹å¤–ï¼Œèƒ½å¤Ÿåˆ†æ‹…ä¸šåŠ¡ååå‹åŠ›çš„èƒ½åŠ›ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73608659d8f44ab9911c4f99ed4dc76a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVpY2VGUw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769146503&amp;x-signature=IGNCMgX%2Fo4wlqJk9z28pw2Fu%2ByA%3D" alt="" loading="lazy"/></p>
<p>åœ¨ SMB æœåŠ¡æ¨¡å¼ä¸‹ï¼Œæ¯ä¸ªå®¢æˆ·ç«¯éƒ½éœ€è¦ä» SMB å­˜å‚¨è¯»å–å…¨é‡æ•°æ®ã€‚å¯¼è‡´æœåŠ¡ç«¯æµé‡é•¿æœŸé«˜ä½ï¼Œç®¡ç†å‘˜éœ€è¦æŒç»­ç›‘æ§ SMB æœåŠ¡çš„å¥åº·çŠ¶å†µï¼Œä¸€æ—¦æ¥è¿‘æœ€å¤§è´Ÿè·ï¼Œå°±éœ€è¦åŠæ—¶è¿›è¡Œæ‰©å®¹ï¼Œæä¾›ä¸é›†ç¾¤è§„æ¨¡åŒ¹é…çš„å­˜å‚¨èƒ½åŠ›ï¼Œè¿ç»´å‹åŠ›æ˜¾è‘—å¢åŠ ã€‚</p>
<h2 data-id="heading-1">02 é—²ç½®èµ„æºåˆ©ç”¨ï¼šç”¨å¤§é‡ä¸šåŠ¡èŠ‚ç‚¹åšåˆ†å¸ƒå¼ç¼“å­˜</h2>
<p>JuiceFS åœ¨ç¤¾åŒºç‰ˆ 1.3 åŠä¼ä¸šç‰ˆ 5.2 ä¹‹åå‘å¸ƒäº†å…¨æ–°çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fjuicefs.com%2Fdocs%2Fzh%2Fcloud%2Fgetting_started%23windows-installation" target="_blank" title="https://juicefs.com/docs/zh/cloud/getting_started#windows-installation" ref="nofollow noopener noreferrer">Windows å®¢æˆ·ç«¯</a>ï¼Œæ”¯æŒé€šè¿‡ <code>.exe</code> è¿›ç¨‹å°†æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ä¸ºæœ¬åœ°ç›˜ï¼Œä½¿ç”¨æ–¹å¼ä¸ Linux ç±»ä¼¼ã€‚</p>
<p>ä½†åœ¨æµ·é‡å®¢æˆ·ç«¯åœºæ™¯ä¸‹ï¼Œå¦‚æœä»…å°†ä¸šåŠ¡åˆ‡æ¢ä¸ºæ ‡å‡†çš„ã€ŒJuiceFS æŒ‚è½½ç‚¹ â€”â€” åˆ†å¸ƒå¼ç¼“å­˜ â€”â€” å¯¹è±¡å­˜å‚¨ã€é“¾è·¯ï¼Œæµé‡ä¼šé›†ä¸­æ‰“åˆ°ç‹¬ç«‹ç¼“å­˜å±‚ï¼Œå¯èƒ½æˆä¸ºæ–°çš„æ€§èƒ½ç“¶é¢ˆã€‚ä¸å…¶ä¸æ–­æ‰©å®¹ä¸“ç”¨çš„ç¼“å­˜èŠ‚ç‚¹ï¼Œä¸å¦‚è½¬æ¢æ€è·¯ï¼š<strong>åˆ©ç”¨æµ·é‡ä¸šåŠ¡èŠ‚ç‚¹è‡ªèº«çš„é—²ç½®å¸¦å®½å’Œç£ç›˜ï¼Œå°†å®ƒä»¬æ± åŒ–ä¸ºä¸€ä¸ªå·¨å¤§çš„åˆ†å¸ƒå¼ç¼“å­˜æ± ã€‚</strong></p>
<ul>
<li><strong>JuiceFS åˆ†å¸ƒå¼ç¼“å­˜æ¨¡å¼ï¼ˆP2P æ¨¡å¼ï¼‰</strong>ï¼šåŒä¸€ä»½æ–‡ä»¶åªéœ€åœ¨é›†ç¾¤å†…è¯»å–ä¸€æ¬¡ï¼Œåç»­å…¶ä»–èŠ‚ç‚¹ç›´æ¥ä» P2P ç¼“å­˜æ± çš„é‚»è¿‘èŠ‚ç‚¹è·å–ã€‚</li>
<li><strong>å¯¹è±¡å­˜å‚¨ä¾§</strong>ï¼šå›æºæµé‡æä½ï¼Œæ–‡ä»¶é¦–æ¬¡å†·è¯»åï¼Œåç»­æµé‡å‡ ä¹å…¨ç”±ç¼“å­˜æ± æ‰¿æ‹…ã€‚</li>
<li><strong>èµ„æºè¦æ±‚</strong>ï¼šæ— éœ€ä¸“ç”¨ç¼“å­˜ç¡¬ä»¶ï¼Œä»…éœ€æ¯ä¸ªä¸šåŠ¡èŠ‚ç‚¹è´¡çŒ®éƒ¨åˆ†ç£ç›˜å’Œå¸¦å®½ã€‚</li>
</ul>
<p>åœ¨è¿™ä¸ªæ–¹æ¡ˆä¸­ï¼Œ<strong>æˆ‘ä»¬æ²¡æœ‰é…ç½®ä»»ä½•ä¸€å°ç‹¬ç«‹ç¼“å­˜èŠ‚ç‚¹ã€‚æ‰€æœ‰çš„ä¸šåŠ¡èŠ‚ç‚¹æ—¢æ˜¯æ¶ˆè´¹è€…ï¼Œä¹Ÿæ˜¯æä¾›è€…</strong>ï¼ˆP2P æ¨¡å¼ï¼‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c3e05c72b0d6407b8f0c3aa0ba458e6a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVpY2VGUw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769146503&amp;x-signature=9oa9KiCrbiUMk08uRLTZ%2BvqoddA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">03 å®æµ‹æ¡ˆä¾‹ï¼š4,000 å°ä¸šåŠ¡èŠ‚ç‚¹èšåˆåˆ° 1.45TB/s çš„å·¨å¤§åå</h2>
<p><strong>æµ‹è¯•ä»»åŠ¡</strong>ï¼šæ¯å° Windows æœºå™¨åœ¨æ— é¢„çƒ­ï¼ˆå†·è¯»ï¼‰çš„æƒ…å†µä¸‹ï¼Œè¯»å– 16 ä¸ª 2GB çš„å¤§æ–‡ä»¶ã€‚ ç»Ÿè®¡æ‰€æœ‰èŠ‚ç‚¹è¯»å®Œçš„æ€»è€—æ—¶ï¼Œå¹¶è§‚å¯Ÿå„èŠ‚ç‚¹çš„è€—æ—¶æ–¹å·®ï¼Œä»¥åŠæ˜¯å¦å­˜åœ¨é•¿å°¾æ•ˆåº”ã€‚</p>
<p><strong>é…ç½®ç­–ç•¥</strong>ï¼šå°† 4,000 ä¸ªèŠ‚ç‚¹æ‹†åˆ†ä¸ºå¤šä¸ªå­ç»„ï¼ˆæ¯ç»„ 500 ä¸ªèŠ‚ç‚¹ï¼‰ã€‚16 ä¸ª 2GB çš„æ•°æ®å—ä¼šæ•£åˆ—åˆ†å¸ƒåœ¨ç»„å†…èŠ‚ç‚¹ä¸­ï¼Œé¿å…æ‰€æœ‰èŠ‚ç‚¹åŒæ—¶å›æºå¯¹è±¡å­˜å‚¨ï¼Œé€ æˆæ‹¥å¡ã€‚</p>
<p>é‚£ä¹ˆç°åœ¨ JuiceFS å®¢æˆ·ç«¯çš„å†·è¯»æµç¨‹å°±å˜ä¸ºï¼š</p>
<ol>
<li>Windows å®¢æˆ·ç«¯è¯»å– 16 ä¸ª 2GB çš„æ–‡ä»¶ï¼Œé€šè¿‡ä¸€è‡´æ€§å“ˆå¸Œæ‹“æ‰‘å®šä½è¿™äº›æ•°æ®å—åœ¨ 500 ä¸ªç¼“å­˜ç»„å†…çš„è´Ÿè´£èŠ‚ç‚¹ï¼Œå‘å…¶å‘èµ·è¯·æ±‚ã€‚</li>
<li>ç¼“å­˜èŠ‚ç‚¹æ”¶åˆ°äº†æ•°æ®å—è¯·æ±‚åï¼Œå‘ç°æœ¬åœ°æœªå‘½ä¸­ç¼“å­˜ï¼ˆå†·è¯»ï¼‰ï¼Œåˆ™å›æºå¯¹è±¡å­˜å‚¨æ‹‰å–æ•°æ®å—ï¼Œæ‹‰å–å®Œæˆåå°†æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå¹¶ä¸”å†™å…¥æœ¬åœ°ç¼“å­˜ï¼Œä¾›åç»­è¯·æ±‚å¤ç”¨ã€‚</li>
<li>å½“å®¢æˆ·ç«¯ä»æ‰€æœ‰ç¼“å­˜æœåŠ¡èŠ‚ç‚¹è·å–å®Œæ•´æ•°æ®å—åï¼Œæµ‹è¯•ç»“æŸï¼Œç»Ÿè®¡æ‰€æœ‰å®¢æˆ·ç«¯è¯»å®Œçš„è€—æ—¶åˆ†å¸ƒï¼ˆæœ€å¤§å€¼ã€æœ€å°å€¼ï¼‰ï¼Œç”¨äºè¯„ä¼°æ–¹å·®ä¸é•¿å°¾æƒ…å†µã€‚</li>
</ol>
<p>ä¸‹é¢æ˜¯ä¸åŒå®¢æˆ·ç«¯èŠ‚ç‚¹æ•°é‡è¯»å–è¿™æ‰¹ 16*2GB å¤§æ–‡ä»¶çš„æ—¶é—´ç»“æœï¼š</p>



































<table><thead><tr><th align="center">å®¢æˆ·ç«¯å°æ•°</th><th align="left">èšåˆååæœ€é«˜</th><th align="left">æ€»è€—æ—¶ï¼ˆèŒƒå›´/å¹³å‡ï¼‰</th></tr></thead><tbody><tr><td align="center">2,000 å°</td><td align="left"><strong>729GB/s</strong></td><td align="left">92s~136s å¹³å‡ 107s</td></tr><tr><td align="center">2,500 å°</td><td align="left"><strong>921GB/s</strong></td><td align="left">87s~109s å¹³å‡ 98s</td></tr><tr><td align="center">3,000 å°</td><td align="left"><strong>1.11TB/s</strong></td><td align="left">93s~121s å¹³å‡ 106s</td></tr><tr><td align="center">3,500 å°</td><td align="left"><strong>1.34TB/s</strong></td><td align="left">89~112s å¹³å‡ 100s</td></tr><tr><td align="center">4,000 å°</td><td align="left"><strong>1.45TB/s</strong></td><td align="left">92s~115s å¹³å‡ 101s</td></tr></tbody></table>
<p>ä¸åŒæ•°é‡å®¢æˆ·ç«¯ï¼ŒJuiceFS èšåˆååè¡¨ç°</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5569fb6c97df4846aef07c566dc1a80c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVpY2VGUw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769146503&amp;x-signature=ndOp28trk%2FxpSc7GusT%2F2lFyRAY%3D" alt="" loading="lazy"/></p>
<p>æ•´ä½“ç»“æœå„æ–¹é¢éƒ½ç¬¦åˆé¢„æœŸï¼š</p>
<ul>
<li><strong>ç¨³å®šæ€§</strong>ï¼šæ— è®ºæ˜¯ 2,000 å°è¿˜æ˜¯ 4,000 å°ï¼Œè¯»å®Œæ•°æ®çš„æ€»è€—æ—¶éƒ½ç¨³å®šåœ¨ 100 ç§’å·¦å³ã€‚</li>
<li><strong>æ‰©å±•æ€§</strong>ï¼š<strong>4,000 å°èŠ‚ç‚¹æˆåŠŸèšåˆå‡º 1.45TB/s çš„è¶…å¤§å¸¦å®½ï¼Œç†è®ºä¸Šï¼Œåœ¨å…ƒæ•°æ®èƒ½å¤Ÿæ‰¿è½½çš„å‰æä¸‹ï¼Œè¯¥æ¶æ„å¯å®ç°æŒç»­çš„æ°´å¹³æ‰©å±•ï¼Œèƒ½å¤Ÿæ”¯æŒè¾¾åˆ°ä¸‡å°çº§åˆ«çš„ç¼“å­˜èŠ‚ç‚¹è§„æ¨¡ã€‚</strong></li>
</ul>
<p>ä¸šåŠ¡èŠ‚ç‚¹çš„æŒ‚è½½å‚æ•°å‚è€ƒï¼š</p>
<pre><code class="hljs language-bash" lang="bash">juicefs.exe mount juice-fs X: --cache-group=primary --buffer-size=4096 --enable-kernel-cache --as-root --subgroups=8
</code></pre>
<p>ç”±æ­¤ï¼Œæˆ‘ä»¬æœªä½¿ç”¨ä¸€å°ç‹¬ç«‹çš„ç¼“å­˜æœåŠ¡èŠ‚ç‚¹ï¼Œä»…é ç”¨æˆ·çš„ä¸šåŠ¡èŠ‚ç‚¹å°±èšåˆäº† 1.45TB/s çš„è¯»å–èƒ½åŠ›ã€‚è¿‡å®¢é€šæˆ·ç«¯èŠ‚ç‚¹ç»„æˆçš„åˆ†å¸ƒå¼ç¼“å­˜å±‚ï¼Œæˆ‘ä»¬ä»¥é›¶æˆæœ¬å°†ç»å¤§å¤šæ•°æµé‡ä»å¯¹è±¡å­˜å‚¨ä¸­åˆ†æµï¼Œå‡è½»äº†åº•å±‚å­˜å‚¨çš„è´Ÿæ‹…ã€‚</p>
<p>å®é™…ä¸šåŠ¡ä¸­ï¼Œæœªå¿…èƒ½è¾¾åˆ°å¦‚æ­¤é«˜çš„ååèƒ½åŠ›ï¼Œå› ä¸ºç¼“å­˜æ•ˆç›Šé€šå¸¸ä¸æ•°æ®é‡å¤åº¦ç›¸å…³ã€‚åœ¨å®é™…åœºæ™¯ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹è¯»å–çš„æ–‡ä»¶å¹¶ä¸å®Œå…¨ç›¸åŒã€‚å°½ç®¡å¦‚æ­¤ï¼Œè¿™ä¸€æ–¹æ¡ˆä»ç„¶æ˜¯æœ‰æ•ˆçš„å­˜å‚¨æ‰©å±•æ–¹æ³•ï¼Œå³ä½¿åªæœ‰éƒ¨åˆ†æå‡ï¼Œä¹Ÿèƒ½å¸¦æ¥éå¸¸å¯è§‚çš„æ”¶ç›Šï¼Œä¸”å‡ ä¹ä¸éœ€è¦é¢å¤–çš„æˆæœ¬æŠ•å…¥ã€‚</p>
<h2 data-id="heading-3">04 ç¨³å®šæ€§å¢å¼ºï¼šä¸¤çº§åˆ†å¸ƒå¼ç¼“å­˜</h2>
<p>ç¼“å­˜æ•ˆæœè™½ç„¶ç‚¸è£‚ï¼Œä½†å®¢æˆ·å¯¹ç³»ç»Ÿçš„ç¨³å®šæ€§æå‡ºäº†æ‹…å¿§ã€‚ä¾‹å¦‚ï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œä¸šåŠ¡èŠ‚ç‚¹åœ¨å®Œæˆä»»åŠ¡åä¼šç«‹å³é”€æ¯ï¼Œè€Œè¿™äº›ä¸šåŠ¡èŠ‚ç‚¹åŒæ—¶ä¹Ÿæ˜¯ç¼“å­˜èŠ‚ç‚¹ã€‚å½“å¤§é‡ä¸šåŠ¡èŠ‚ç‚¹çªç„¶ä¸‹çº¿æ—¶ï¼ŒåŸæœ¬å­˜å‚¨åœ¨è¿™äº›èŠ‚ç‚¹ä¸Šçš„ç¼“å­˜ä¹Ÿéšä¹‹ä¸¢å¤±ï¼Œå¯¼è‡´å¤§é‡æµé‡å›æºè‡³å¯¹è±¡å­˜å‚¨ï¼Œè¿›è€Œä½¿å¯¹è±¡å­˜å‚¨æˆä¸ºç“¶é¢ˆï¼Œå½±å“æ•´ä½“ç¨³å®šæ€§ã€‚ä¸ºäº†è§£å†³å› ä¸šåŠ¡èŠ‚ç‚¹æ³¢åŠ¨å¼•å‘çš„ç¼“å­˜æ€§èƒ½é—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸¤çº§åˆ†å¸ƒå¼ç¼“å­˜æ–¹æ¡ˆï¼Œæ¶æ„å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dd3953e1d679410cb5bbe11fea476677~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVpY2VGUw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769146503&amp;x-signature=mCuro4zhvMMiZV47agYkk%2FIfgnU%3D" alt="" loading="lazy"/></p>
<p>ç¬¬äºŒå±‚ç¼“å­˜æ± ï¼ˆL2ï¼‰ä½äºç¬¬ä¸€å±‚ï¼ˆL1ï¼‰ç¼“å­˜æ± å’Œå¯¹è±¡å­˜å‚¨ä¹‹é—´ã€‚å½“ L1 æœªå‘½ä¸­æ—¶ï¼Œæ•°æ®é¦–å…ˆä¼šä» L2 è·å–ï¼›å¦‚æœ L2 ç¼“å­˜ä¹Ÿæœªå‘½ä¸­ï¼Œåˆ™å›æºåˆ°å¯¹è±¡å­˜å‚¨ã€‚è¿™æ ·å¯ä»¥æœ‰æ•ˆæŠµæ¶ˆ L1 ç¼“å­˜èŠ‚ç‚¹æ³¢åŠ¨å¸¦æ¥çš„å½±å“ã€‚åŠ å…¥ L2 ç¼“å­˜æ± åï¼Œè¯»å–æµç¨‹å‘ç”Ÿäº†ä»¥ä¸‹å˜åŒ–ï¼š</p>
<ul>
<li>åœ¨ Windows å®¢æˆ·ç«¯è¯»å– 16 ä¸ª 2GB çš„æ–‡ä»¶ï¼Œé€šè¿‡ä¸€è‡´æ€§å“ˆå¸Œæ‹“æ‰‘ç¡®å®šæ•°æ®å—æ‰€åœ¨ L1 ç¼“å­˜ç»„ä¸­çš„ç‰¹å®šèŠ‚ç‚¹ï¼›å¹¶åŒæ—¶å‘ L2 ç¼“å­˜ç»„è¯·æ±‚æ•°æ®ã€‚</li>
<li>ç”±äºæ˜¯å†·è¯»ï¼ŒL2 ç¼“å­˜ç»„ä¸­æ²¡æœ‰æ•°æ®ï¼ŒL2 ç¼“å­˜èŠ‚ç‚¹ä¼šå‘å¯¹è±¡å­˜å‚¨å‘èµ·è¯·æ±‚å¹¶å¡«å…… L2 ç¼“å­˜æ± ã€‚</li>
<li>æ•°æ®å—ä» L2 ç¼“å­˜æ± è¿”å›è‡³ L1 ç¼“å­˜æ± å¹¶è¿›è¡Œå¡«å……ï¼Œç„¶åç”± L1 ç¼“å­˜æ± å†…çš„èŠ‚ç‚¹è‡ªè¡Œè¿›è¡Œç‚¹å¯¹ç‚¹ï¼ˆP2Pï¼‰åˆ†å‘ã€‚</li>
<li><strong>æ­¤æ—¶ï¼Œå¤§éƒ¨åˆ†æµé‡é›†ä¸­åœ¨ L1 ç¼“å­˜æ± ï¼ŒL2 åªå¤„ç†æå°‘æ•°å›æºå¯¹è±¡å­˜å‚¨çš„æµé‡ï¼Œå› æ­¤å³ä½¿ L2 åªæœ‰å°‘æ•°å‡ ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿä¸ä¼šæˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚L2 ç¼“å­˜æ± çš„ä½œç”¨æ˜¯å°±è¿‘æ›¿ä»£å¯¹è±¡å­˜å‚¨ï¼Œé™ä½å»¶è¿Ÿã€‚</strong></li>
</ul>
<p>å³ä½¿å¤§é‡ L1 ä¸šåŠ¡èŠ‚ç‚¹ä¸‹çº¿ï¼Œç¼“å­˜æ‹“æ‰‘å‘ç”Ÿå˜åŒ–å¹¶éœ€è¦é‡æ–°ä¸‹è½½æ•°æ®å—ï¼Œæ•°æ®ä»å¯ä» L2 ç¼“å­˜æ± å°±è¿‘è·å–ã€‚åªè¦åˆç†æ§åˆ¶ä¸‹çº¿æ¯”ä¾‹ï¼Œä¸šåŠ¡å‡ ä¹ä¸å—å½±å“ã€‚</p>
<p>L2 ç¼“å­˜ç»„æŒ‚è½½å‚æ•°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">juicefs mount juice-fs /jfs-cache --cache-group=secondary --cache-size=-1 --cache-dir=/data* --free-space-ratio=0.01 --buffer-size=10240 --max-downloads=400
</code></pre>
<p>L1ï¼ˆä¸šåŠ¡èŠ‚ç‚¹ï¼‰æŒ‚è½½å‚æ•°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">juicefs.exe mount juice-fs X: --cache-group=primary --second-group=secondary --buffer-size=4096 --enable-kernel-cache --as-root --subgroups=8
</code></pre>
<p><strong>æ­¤å¤–ï¼Œä¸¤çº§åˆ†å¸ƒå¼ç¼“å­˜è¿˜éå¸¸é€‚ç”¨äºéœ€è¦é‡å¤åˆ©ç”¨å·²æœ‰ç¼“å­˜æ± çš„åœºæ™¯</strong>ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€æ‰¹ä½äºåŒ—äº¬çš„ç¼“å­˜æ± ä¸šåŠ¡ï¼Œæ€»å®¹é‡ä¸º 2PiBï¼Œç¼“å­˜æ± åä¸º cache-group-bjã€‚çªç„¶ï¼Œä¸Šæµ·çš„ä¸šåŠ¡ä¹Ÿéœ€è¦ä½¿ç”¨ç›¸åŒçš„æ•°æ®ï¼Œè€Œè¿™äº›æ•°æ®ä¸åŒ—äº¬çš„æ•°æ®å‡ ä¹å®Œå…¨ç›¸åŒã€‚å¦‚æœä¸å¸Œæœ›é‡æ–°ä»åŒ—äº¬çš„å¯¹è±¡å­˜å‚¨ä¸­é¢„çƒ­è¿™ 2PiB çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸Šæµ·çš„ç¼“å­˜ç»„ä¸­é…ç½® <code>--second-group=cache-group-bj</code>ã€‚è¿™æ ·ï¼Œå½“ä¸Šæµ·çš„ä¸šåŠ¡è¯·æ±‚æ•°æ®æ—¶ï¼Œå°†ä¼˜å…ˆé€šè¿‡ä¸“çº¿ä»åŒ—äº¬çš„ç¼“å­˜æ± è¯»å–æ•°æ®ï¼Œé€Ÿåº¦éå¸¸å¿«ä¸”å»¶è¿Ÿç¨³å®šï¼ˆåœ¨ 2ms ä»¥å†…ï¼‰ï¼Œå…å»äº†é‡å¤é¢„çƒ­æ•°æ®çš„å¤æ‚è¿‡ç¨‹ï¼Œèƒ½å¤Ÿç›´æ¥å¯åŠ¨ä¸šåŠ¡ï¼Œæå¤§åœ°æ–¹ä¾¿äº†æ“ä½œã€‚</p>
<h2 data-id="heading-4">05 å°ç»“</h2>
<p>é€šè¿‡æœ¬æ¬¡ 4,000 èŠ‚ç‚¹çš„æé™å‹æµ‹ï¼Œæˆ‘ä»¬æˆåŠŸå°†è®¡ç®—é›†ç¾¤çš„å¤§è§„æ¨¡é—²ç½®èµ„æºè½¬åŒ–ä¸ºé«˜è¾¾ 1.45TB/s çš„å­˜å‚¨æ± ï¼›è€ŒäºŒçº§ç¼“å­˜çš„å¼•å…¥ï¼Œæœ‰æ•ˆè§£å†³äº†â€œæœ€åä¸€å…¬é‡Œâ€çš„ç¨³å®šæ€§é¡¾è™‘ã€‚é€šè¿‡ä½¿ç”¨ JuiceFS è¿™å¥—å­˜å‚¨è½¯ä»¶æ¶æ„ï¼Œå¯å……åˆ†æŒ–æ˜å®¢æˆ·ç«¯é›†ç¾¤çš„æ½œèƒ½ï¼Œåœ¨ä¸å¢åŠ é¢å¤–ç¡¬ä»¶æˆæœ¬çš„æƒ…å†µä¸‹ï¼Œå®ç°äº†æ€§èƒ½çš„æ˜¾è‘—æå‡ã€‚</p>
<p>æœ¬æ–¹æ¡ˆé€‚ç”¨åœºæ™¯ï¼š</p>
<ul>
<li><strong>é«˜å¹¶å‘é‡å¤è¯»å–åœºæ™¯</strong>ï¼šå¦‚æ¨¡å‹è®­æ¨æ•°æ®è°ƒç”¨ã€å®¹å™¨é•œåƒåˆ†å‘ã€å½±è§†æ¸²æŸ“ç­‰ï¼ŒèŠ‚ç‚¹è¶Šå¤šï¼ŒP2P ç¼“å­˜æ”¶ç›Šè¶Šå¤§ï¼›</li>
<li><strong>å¼¹æ€§è®¡ç®—åœºæ™¯</strong>ï¼šä¸šåŠ¡èŠ‚ç‚¹ç»å¸¸å¤§è§„æ¨¡æ‰©ç¼©å®¹ï¼ˆå¦‚ Spot Instancesï¼‰ï¼Œåˆ©ç”¨äºŒçº§ç¼“å­˜æ¶æ„å¯ç¡®ä¿æ•°æ®è®¿é—®çš„è¿ç»­æ€§ä¸ç¨³å®šæ€§ï¼›</li>
<li><strong>æ··åˆäº‘/å¤šäº‘æ¶æ„</strong>ï¼šåˆ©ç”¨äºŒçº§ç¼“å­˜æœºåˆ¶å¯ä»¥å¤ç”¨å¼‚åœ°ç¼“å­˜æ± èµ„æºï¼Œæœ€å¤§ç¨‹åº¦å‡å°‘é‡å¤é¢„çƒ­å¸¦æ¥çš„å¯¹è±¡å­˜å‚¨è°ƒç”¨å’Œä¼ è¾“æˆæœ¬ã€‚</li>
</ul>
<p>æˆ‘ä»¬å¸Œæœ›æœ¬æ–‡ä¸­çš„ä¸€äº›å®è·µç»éªŒï¼Œèƒ½ä¸ºæ­£åœ¨é¢ä¸´ç±»ä¼¼é—®é¢˜çš„å¼€å‘è€…æä¾›å‚è€ƒï¼Œå¦‚æœæœ‰å…¶ä»–ç–‘é—®æ¬¢è¿åŠ å…¥ <a href="https://link.juejin.cn?target=https%3A%2F%2Fjuicefs.com%2F" target="_blank" title="https://juicefs.com/" ref="nofollow noopener noreferrer">JuiceFS ç¤¾åŒº</a>ä¸å¤§å®¶å…±åŒäº¤æµã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Qunaré…’åº—æœç´¢æ’åºæ¨¡å‹çš„æ¼”è¿›]]></title>    <link>https://juejin.cn/post/7595626157908869129</link>    <guid>https://juejin.cn/post/7595626157908869129</guid>    <pubDate>2026-01-16T06:36:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595626157908869129" data-draft-id="7594813727053070370" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Qunaré…’åº—æœç´¢æ’åºæ¨¡å‹çš„æ¼”è¿›"/> <meta itemprop="keywords" content="å‰ç«¯,æ¶æ„,æ“ä½œç³»ç»Ÿ"/> <meta itemprop="datePublished" content="2026-01-16T06:36:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å»å“ªå„¿æŠ€æœ¯æ²™é¾™"/> <meta itemprop="url" content="https://juejin.cn/user/2251436075786791"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Qunaré…’åº—æœç´¢æ’åºæ¨¡å‹çš„æ¼”è¿›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2251436075786791/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å»å“ªå„¿æŠ€æœ¯æ²™é¾™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T06:36:01.000Z" title="Fri Jan 16 2026 06:36:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»27åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€ã€èƒŒæ™¯</h3>
<p>åœ¨ç”¨æˆ·åœ¨çº¿æµè§ˆé…’åº—æ—¶ï¼Œæ—…è¡Œå¹³å°éœ€è¦è§£å†³ä¸€ä¸ªé‡è¦é—®é¢˜ï¼šå¦‚ä½•æ›´å¥½åœ°ä¸ºç”¨æˆ·æŒ‘é€‰é€‚åˆçš„é…’åº—ï¼Œå¹¶é™ä½ç”¨æˆ·é€‰æ‹©çš„è´¹åŠ›åº¦ã€‚è€Œä¸ºç”¨æˆ·æŒ‘é€‰ç¬¦åˆéœ€æ±‚çš„é…’åº—ï¼Œéœ€è¦åƒäººåƒé¢çš„æ¨¡å‹æ’åºã€‚åœ¨å»å“ªå„¿ï¼ˆQunarï¼‰APPä¸­ï¼Œè§¦å‘ä¸ªæ€§åŒ–æ’åºçš„åœºæ™¯ä¸»è¦æ˜¯æ¬¢è¿åº¦æ’åºï¼ˆè§å›¾1ï¼‰ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/030c148d0fef4833bc48244848ee773e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=iuKj3qAYd6gOHRCAiyK4AEipxwE%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾1 Qunaré…’åº—æœç´¢äº§å“å½¢æ€</p>
<h3 data-id="heading-1">äºŒã€Qunaré…’åº—æœç´¢æ’åºæ¶æ„</h3>
<p>Qunaré…’åº—æœç´¢æ¨èç³»ç»Ÿçš„æ€»ä½“æµç¨‹å¯ä»¥åˆ†æˆå››å—ï¼Œä¸»è¦æ˜¯å¬å›ã€ç²—æ’ã€ç²¾æ’ã€é‡æ’ã€‚å…¶ä¸­ç²¾æ’ä¸»è¦ä¼šæ ¹æ®ç”¨æˆ·çš„æœç´¢å…³é”®è¯å’Œå…¶ä»–ç›¸å…³ä¿¡æ¯ï¼Œé€‰å‡ºä¸ç”¨æˆ·éœ€æ±‚æœ€ç›¸ç¬¦åˆçš„é…’åº—ï¼Œç¡®ä¿åœ¨æœç´¢ç»“æœä¸­ï¼Œç”¨æˆ·èƒ½å¤Ÿçœ‹åˆ°é‚£äº›ä¸å…¶éœ€æ±‚æœ€ç›¸å…³çš„é…’åº—ã€‚è€ŒQunaré…’åº—é•¿æœŸä¼˜åŒ–çš„ä¸šåŠ¡ç›®æ ‡æ˜¯s2oï¼Œå³ä¸‹å•ç”¨æˆ·æ•°/æœç´¢ç”¨æˆ·æ•°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e976df357f39491d86bf0eb55927c8c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=J4FS6mJjGyxn6kSjDix5UKzojpY%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾2 Qunaræœç´¢æ¶æ„</p>
<h3 data-id="heading-2">ä¸‰ã€Qunaré…’åº—æœç´¢ç²¾æ’æ’åºçš„å‘å±•å†ç¨‹</h3>
<p>ç¬¬ä¸€é˜¶æ®µå‡çº§æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œé…’åº—æœç´¢ä¸šåŠ¡å‡†å¤‡ä½¿ç”¨æœºå™¨å­¦ä¹ æ¨¡å‹æ›¿æ¢äººå·¥è§„åˆ™æ’åºã€‚ä¸ºäº†èƒ½å¿«é€Ÿä¸Šçº¿éªŒè¯æ¨¡å‹æ•ˆæœï¼Œå¹¶è€ƒè™‘åˆ°é…’åº—ä¸šåŠ¡å¤©ç”Ÿè‡ªå¸¦å¤§é‡è¿ç»­ç‰¹å¾ï¼Œå¦‚é…’åº—ä»·æ ¼ã€é…’åº—è·ç¦»ç­‰ï¼Œæˆ‘ä»¬é€‰æ‹©äº†å¯¹è¿ç»­ç‰¹å¾æ¯”è¾ƒå‹å¥½çš„æ ‘æ¨¡å‹LambdaMartæ¨¡å‹ã€‚</p>
<p>ç¬¬äºŒé˜¶æ®µå‡çº§æ·±åº¦æ¨¡å‹ï¼ŒLambdaMartæ’åºæ¨¡å‹å¸¸ç”¨çš„è¿­ä»£ä¼˜åŒ–æ‰‹æ®µï¼Œå¦‚æ·»åŠ ç‰¹å¾ã€æ ·æœ¬è°ƒæ•´ç­‰å‡ ä¹å·²ç»æ— æ³•å¸¦æ¥å¢é‡æ”¶ç›Šï¼Œå› æ­¤æˆ‘ä»¬å‡†å¤‡å‡çº§æˆæ¯”æ ‘æ¨¡å‹å¤©èŠ±æ¿æ›´é«˜çš„æ·±åº¦æ¨¡å‹æ¶æ„LambdaDNNã€‚</p>
<p>ç¬¬ä¸‰é˜¶æ®µå‡çº§å¤šç›®æ ‡æ¨¡å‹ï¼ŒLambdaDNNæ’åºæ¨¡å‹ä¸»è¦è¿˜æ˜¯èšç„¦å•ç›®æ ‡å»ºæ¨¡ï¼ˆCTCVRï¼‰ï¼Œè€Œå¤šç›®æ ‡å»ºæ¨¡æ›´å¥½çš„è€ƒè™‘äº†æ’åºå…¨ç©ºé—´çš„æ›å…‰æ ·æœ¬ï¼Œç»¼åˆè€ƒè™‘äº†ä¸‹å•å‰çš„ç”¨æˆ·ç‚¹å‡»è¡Œä¸ºï¼Œé™ä½æ ·æœ¬åå·®é—®é¢˜ï¼Œæˆ‘ä»¬å€Ÿé‰´äº†Googleçš„MMOEæ¨¡å‹ï¼ŒåŒæ—¶å­¦ä¹ CTRç›®æ ‡ä»»åŠ¡å’ŒCTCVRç›®æ ‡ä»»åŠ¡ã€‚</p>
<p>ç¬¬å››é˜¶æ®µå‡çº§å¤šåœºæ™¯å¤šç›®æ ‡æ¨¡å‹ï¼Œé…’åº—ä¸šåŠ¡æœç´¢åœºæ™¯åˆ†ä¸ºåŒåŸç©ºæœã€å¼‚åœ°ç©ºæœç­‰ï¼Œæ¯ä¸ªåœºæ™¯å•ç‹¬ä¸€ä¸ªæ¨¡å‹ï¼Œä½¿å¾—ç»´æŠ¤æˆæœ¬å¾ˆé«˜ï¼Œå¹¶ä¸”ç”¨æˆ·å‡ºè¡Œæ—¶ï¼Œä¼šåœ¨å¤šä¸ªåœºæ™¯ï¼ˆåŒåŸæœç´¢ã€å¼‚åœ°æœç´¢ï¼‰ä¸‹æœç´¢æ‰¾åˆ°ç¬¦åˆè‡ªå·±æœŸæœ›çš„é…’åº—ã€‚è‹¥å°†å¤šä¸ªåœºæ™¯åˆ†åˆ«å•ç‹¬è®­ç»ƒæ¨¡å‹ï¼Œä¼šä½¿å¾—ç”¨æˆ·è¿è´¯çš„æœç´¢è¡Œä¸ºå‰²è£‚ï¼Œå­¦ä¹ ä¸åˆ°ç”¨æˆ·åœ¨ä¸åŒåœºæ™¯ä¸‹çš„å·®å¼‚å’Œå…±æ€§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æå‡ºå°†ä¿¡æ¯è¡¨å¾æ‹†åˆ†ï¼Œèåˆå¤šåœºæ™¯æ ·æœ¬çš„å¤šåœºæ™¯å¤šç›®æ ‡æ¨¡å‹ã€‚</p>
<p>ä¸‹é¢å…·ä½“é˜è¿°æˆ‘ä»¬åœ¨Qunaré…’åº—æœç´¢æ’åºæ¨¡å‹çš„æ¼”è¿›ã€‚</p>
<h3 data-id="heading-3">å››ã€Qunaré…’åº—æœç´¢ç²¾æ’æ’åºç®—æ³•çš„è¿­ä»£</h3>
<p>æ’åºå­¦ä¹ ï¼ˆLearning to Rankï¼‰æ˜¯ä¸€ä¸ªç›‘ç£å­¦ä¹ è¿‡ç¨‹ï¼Œç»™å®šä¸€ä¸ªqueryï¼Œæœç´¢å¼•æ“ä¼šå¬å›ä¸€ç³»åˆ—ç›¸å…³çš„itemï¼Œç„¶åå¯¹è¿™äº›å¬å›çš„itemè¿›è¡Œæ’åºï¼Œæœ€åå°†Top Nçš„itemè¾“å‡ºã€‚è€Œæ’åºé—®é¢˜å°±æ˜¯ä½¿ç”¨ä¸€ä¸ªæ¨¡å‹ f(q,d)æ¥å¯¹è¯¥queryä¸‹çš„itemè¿›è¡Œæ’åºï¼Œåˆ†ä¸ºPointWiseï¼ŒPairWiseï¼ŒListWiseä¸‰ç§æ’åºå­¦ä¹ æ–¹å¼ã€‚</p>
<p>PointWiseï¼šè¾“å…¥ç©ºé—´ä¸­æ ·æœ¬æ˜¯å•ä¸ª itemï¼ˆå’Œå¯¹åº” queryï¼‰æ„æˆçš„ç‰¹å¾å‘é‡ï¼Œè¾“å‡ºç©ºé—´ä¸­æ ·æœ¬æ˜¯å•ä¸ª itemï¼ˆå’Œå¯¹åº” queryï¼‰çš„ç›¸å…³åº¦ï¼Œæ˜¯å°†æ‰€æœ‰ç”¨æˆ·çš„æ ·æœ¬ç©ºé—´çš„æ ·æœ¬åŒç­‰å¯¹å¾…ã€‚</p>
<p>PairWiseï¼šè¾“å…¥ç©ºé—´ä¸­æ ·æœ¬æ˜¯ï¼ˆåŒä¸€ query å¯¹åº”çš„ï¼‰ä¸¤ä¸ªitemæ„æˆçš„ä¸¤ä¸ªç‰¹å¾å‘é‡ï¼Œè¾“å‡ºç©ºé—´ä¸­æ ·æœ¬å¯¹çš„ååºå…³ç³»ï¼Œæ­¤æ–¹æ³•å­¦ä¹ äº†åŒä¸€ä¸ªqueryä¸‹çš„ä¸¤ä¸ªæ ·æœ¬å¯¹æ¯”åå¥½ã€‚</p>
<p>ListWiseï¼šè¾“å…¥ç©ºé—´ä¸­æ ·æœ¬æ˜¯ï¼ˆåŒä¸€ query å¯¹åº”çš„ï¼‰æ‰€æœ‰itemæ„æˆçš„å¤šä¸ªç‰¹å¾å‘é‡åˆ—è¡¨ï¼Œè¾“å‡ºç©ºé—´æ˜¯åŒä¸€ä¸ªqueryä¸‹çš„æœ€ä¼˜æ’åºåˆ—è¡¨ï¼Œæ˜¯pairwiseå’Œlambdaæ¢¯åº¦çš„ç»“åˆï¼Œå¦‚LambdaMartç®—æ³•ï¼Œå¯¹æ•´ä¸ªåˆ—è¡¨å»ºæ¨¡ï¼Œå­¦ä¹ ä¸€ä¸ªæœ€ä¼˜æ’åºåˆ—è¡¨ã€‚</p>















<table><thead><tr><th>pointWise</th><th>pairWise</th><th>listWise</th></tr></thead><tbody><tr><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e465e1ee37546e2a082c2453b5efb31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=XEThDzGzChSk93nvwrmVC%2FLat5s%3D" alt="" loading="lazy"/></td><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be0b25796d3448eab81e26e6200ea2fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=eZ1nu4KZzD%2BmEFeOZyTnp85IUYQ%3D" alt="" loading="lazy"/></td><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86f7b1da238e4f408166fea126d137ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=vULzqmFWqcAISTjuc%2B9dE8b6A5M%3D" alt="" loading="lazy"/></td></tr></tbody></table>
<p>æ¨¡å‹çš„é¢„æµ‹ç›®æ ‡ä¸ä¸šåŠ¡æŒ‡æ ‡ä¹‹é—´å­˜åœ¨ä¸€å®šçš„å·®è·ï¼ŒPointwiseæ³¨é‡å•ä¸ªç‰©å“çš„ç‚¹å‡»ç‡ï¼Œå¯¹æ‰€æœ‰è¯·æ±‚ä¸‹çš„ç‰©å“åŒç­‰å¯¹å¾…ï¼Œä¸æœç´¢ä¸šåŠ¡æŒ‡æ ‡å­˜åœ¨è¾ƒå¤§çš„Gapï¼Œè€Œæœç´¢ä¸šåŠ¡æ›´å…³æ³¨åœ¨é¡µé¢å¤´éƒ¨çš„æœç´¢ç»“æœçš„ä¼˜åŠ£ã€‚</p>
<p>å› æ­¤ï¼ŒåˆæœŸé˜¶æ®µæˆ‘ä»¬é€‰æ‹©äº†æ›´é€‚åˆæœç´¢æ’åºçš„Listwiseæ–¹å¼å­¦ä¹ æ¨¡å‹ï¼Œå³LambdaMartæ ‘æ¨¡å‹ä½œä¸ºbaseæ¨¡å‹ï¼ŒåŒæ—¶æ ‘æ¨¡å‹ä¸éœ€è¦åšå¤§é‡çš„ç‰¹å¾å¤„ç†ï¼Œå¯ä»¥å¿«é€Ÿä¸Šçº¿éªŒè¯æ•ˆæœã€æ‹¿åˆ°æ”¶ç›Šã€‚</p>
<h4 data-id="heading-4">1. ç”±LambdaMartæ¨¡å‹å‡çº§åˆ°LambdaDNNæ¨¡å‹</h4>
<p>å°†æ’åºæ¨¡å‹ä»LambdaMartå‡çº§åˆ°LambdaDNNæ¨¡å‹ä¸»è¦è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>æ—…æ¸¸å…·æœ‰å¼ºçƒˆçš„èŠ‚å‡æ—¥å‘¨æœŸå±æ€§ï¼Œéœ€è¦é•¿æ—¶é—´çª—çš„å¤§è§„æ¨¡æ•°æ®å­¦ä¹ ã€‚è€Œæ ‘æ¨¡å‹å®¹é‡æœ‰é™ï¼Œéšç€æ•°æ®è§„æ¨¡çš„å¢åŠ ï¼Œå¾ˆéš¾å¾ˆå¥½çš„è¡¨è¾¾æ•°æ®å†…éƒ¨éšè—çš„çŸ¥è¯†ã€‚LambdaDNNèƒ½å¤Ÿå®ç°æ›´å¤æ‚çš„æ¨¡å‹ï¼Œä¸”å…·å¤‡å¼ºå¤§çš„è¡¨å¾èƒ½åŠ›ï¼Œæœ‰æ›´é«˜çš„å¤©èŠ±æ¿ã€‚</li>
<li>åŸºäºæ·±åº¦å­¦ä¹ çš„æ¨¡å‹ï¼Œå…·æœ‰æ›´å¥½çš„æ³›åŒ–èƒ½åŠ›ï¼Œå’Œå¤„ç†é«˜ç»´ç¨€ç–æ•°æ®çš„èƒ½åŠ›ï¼Œæ­¤å¤–åº”ç”¨æ·±åº¦å­¦ä¹ æ¨¡å‹åå¯ä»¥æ›´å¥½çš„åº”ç”¨æ–°çš„ç ”ç©¶æˆæœï¼Œæ¯”å¦‚åé¢ä»‹ç»çš„å¤šç›®æ ‡æ’åºã€‚</li>
</ul>
<p>æ ‘æ¨¡å‹å’Œæ·±åº¦æ¨¡å‹çš„ä¸»è¦åŒºåˆ«è§è¡¨1ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f18a285af81a420e9e4fdad5d7eb6108~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=dF%2BxcPEzjX0Llhta%2BvXvoaI8l9c%3D" alt="a44cfa7ec9874f8d0a95ed9b79884305.png" loading="lazy"/></p>
<h4 data-id="heading-5">2. LambdaDNNæ¨¡å‹å®è·µ</h4>
<p>ä¸ºäº†éªŒè¯æ·±åº¦æ¨¡å‹çš„æœ‰æ•ˆæ€§ï¼Œæˆ‘ä»¬æ§åˆ¶äº†lossçš„å­¦ä¹ æ–¹å¼ï¼Œç»Ÿä¸€ä¸ºlistwiseæ–¹å¼ï¼Œå”¯ä¸€å˜é‡åªæ˜¯æ¨¡å‹çš„ç»“æ„ã€‚è€ŒLambdaDNNæ¨¡å‹æ˜¯å°†ç¥ç»ç½‘ç»œDNNä¸LamdaRank [2] å®šä¹‰çš„NDCGæ’åºæŒ‡æ ‡æ¢¯åº¦ç›¸ç»“åˆï¼Œæ¼”è¿›å‡ºäº†LambdaDNNï¼Œæ˜¯ä¸€ç§listwiseçš„å­¦ä¹ æ–¹å¼ã€‚å› æ­¤æˆ‘ä»¬å°è¯•å°†LambdaDNNæ¨¡å‹åº”ç”¨åœ¨äº†Qunaræœç´¢æ¨èä¸‹çš„ç²¾æ’é˜¶æ®µï¼Œ</p>
<p>æ¨¡å‹å­¦ä¹ ç›®æ ‡å®šä¹‰ä¸ºæ›å…‰è½¬åŒ–ç‡ï¼ˆctcvrï¼‰ã€‚LambdaDNNçš„æ­å»ºä¸»è¦åŒ…æ‹¬äº†æ¡†æ¶é€‰å‹ã€æ ·æœ¬æ„é€ ã€ç‰¹å¾å·¥ç¨‹ã€æ¨¡å‹ç¦»çº¿è®­ç»ƒåŠçº¿ä¸ŠåŒ–ï¼Œå…¶ä¸­æ ·æœ¬ä¸ç‰¹å¾å†³å®šäº†æ¨¡å‹æ•ˆæœçš„ä¸Šé™ã€‚æ¥ä¸‹æ¥åˆ†åˆ«ä»‹ç»ä¸‹è¿™å‡ ä¸ªéƒ¨åˆ†ï¼š</p>
<h5 data-id="heading-6">2.1 æ¡†æ¶é€‰å‹</h5>
<p>TensorFlow Ranking (TFR) æ˜¯ TensorFlow å®˜æ–¹å¼€å‘çš„ LTR æ¡†æ¶ï¼Œæ—¨åœ¨åŸºäº TensorFlow å¼€å‘å’Œæ•´åˆ LTR ç›¸å…³çš„æŠ€æœ¯ï¼Œä½¿å¼€å‘äººå‘˜å¯ä»¥æ›´åŠ æ–¹ä¾¿çš„è¿›è¡Œ LTR ç®—æ³•çš„å¼€å‘ã€‚TFR ä½¿ç”¨äº† Estimator APIï¼Œæä¾›äº†æ’åºä»»åŠ¡å¸¸è§çš„æŸå¤±å‡½æ•°å’ŒæŒ‡æ ‡è®¡ç®—å®ç°ï¼Œæ¯”å¦‚ listwise Loss å’Œ NDCGæŒ‡æ ‡ã€‚</p>
<p>æ ¹æ®è®­ç»ƒæµç¨‹ï¼Œæ¨¡å—ç»“æ„å¯ä»¥åˆ†æˆç‰¹å¾è¾“å…¥ã€ç‰¹å¾è½¬æ¢ã€æ¨¡å‹æ‰“åˆ†å’ŒæŸå¤±è®¡ç®—ç­‰æ¨¡å—ã€‚è¿™æ ·çš„æ¨¡å—åˆ’åˆ†å¯ä»¥æé«˜åç»­å¿«é€Ÿè¿­ä»£çš„ä¾¿åˆ©æ€§å’Œçµæ´»æ€§ï¼Œè€Œä¸ç”¨å…³æ³¨äºå„ç§å®æ–½ä¸Šçš„ç»†èŠ‚ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46c9f88896d04b62955d7c15426048ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=c0Lk9FUAZD7fFIyfho785K1RB9A%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾3 TFRankingæ¡†æ¶</p>
<p>å¦‚ä¸Šå›¾3æ‰€ç¤ºï¼Œmodel_fn å‚æ•°å†…éœ€è¦è‡ªå·±è®¾è®¡å’Œå¼€å‘çš„ç®—æ³•æ¨¡å‹æ¨¡å—ã€‚åœ¨è¿™ä¸ª model_fn ä¸­ï¼Œéœ€è¦è‡ªè¡Œè®¾è®¡æ¨¡å‹ç»“æ„ (Scoring Function)ï¼Œç„¶åç”¨æ¨¡å‹è®¡ç®—çš„ logit å’Œ label æ¥è®¡ç®— Loss å’Œ Metricsï¼Œæœ€ååˆ©ç”¨ Optimizer æ¥è¿›è¡Œæ¨¡å‹çš„ä¼˜åŒ–ã€‚å›¾3ä¸­çš„ä¸‹æ–¹éƒ¨åˆ†ä¸ºä½¿ç”¨ TFR æœåŠ¡çš„æ•´ä¸ªæµç¨‹ã€‚</p>
<p>ä¸ºäº†é…åˆ TFR æ¡†æ¶ä¸­çš„ LTR ç›¸å…³çš„ Loss å’Œ Metrics æ¥å®ç° LTR çš„è®­ç»ƒï¼Œè®­ç»ƒæ•°æ®éœ€è¦ä»¥ listwise çš„å½¢å¼ç»„ç»‡ã€‚å³LTR æ¨¡å‹ä¸ä¸€æ¬¡åªå¯¹ä¸€ä¸ªitemè¿›è¡Œåˆ†ç±»çš„æ ‡å‡†åˆ†ç±»æ¨¡å‹ä¸åŒï¼Œå®ƒä¼šå°†æ•´ä¸ªitemsåˆ—è¡¨æ¥æ”¶è¾“å…¥ï¼Œå¹¶å­¦ä¹ æ’åºï¼Œå……åˆ†æå‡æ•´ä¸ªliståˆ—è¡¨çš„æ•ˆç”¨ï¼Œå¦‚å›¾4æ‰€ç¤ºã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/35f1b0bc8ad846c1b12835b31e1ff1db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=SJbAjGqzjFbEd33Pq%2BZCemzdVxs%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾4 listwiseçš„å­¦ä¹ æ–¹å¼</p>
<h5 data-id="heading-7">2.2 æ¨¡å‹ç»“æ„</h5>
<p>æˆ‘ä»¬ä½¿ç”¨çš„æ¨¡å‹ç»“æ„ï¼Œå€Ÿé‰´äº†Airbnbçš„æ·±åº¦å­¦ä¹ [3]æ¨¡å‹æ¼”è¿›çš„ç»éªŒï¼Œæ¨¡å‹æ¢ç´¢çš„åŸåˆ™æ˜¯ä»ç®€å•åˆ°å¤æ‚ï¼Œé€æ­¥ç§¯ç´¯ç»éªŒï¼Œé’ˆå¯¹ç‰¹å¾æ•°é‡ä¸å¤šçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨éå¸¸æ·±çš„ç½‘ç»œï¼Œä¼šå¯¼è‡´è¿‡æ‹Ÿåˆã€‚å› æ­¤ï¼Œå¦‚å›¾5æ‰€ç¤ºï¼Œé‡‡ç”¨äº†ç®€å•2å±‚éšè—å±‚çš„é‡‘å­—å¡”ç½‘ç»œç»“æ„ã€‚</p>
<p>å¯¹ä¸€ä¸ªqueryä¸‹çš„æ ·æœ¬è®¡ç®—Lambda Lossï¼Œä¼˜åŒ–ç½‘ç»œå‚æ•°ã€‚å…¶ä¸­ï¼Œæ¨¡å‹è°ƒä¼˜å‚æ•°ï¼Œbatch sizeä¸º1024ï¼ŒåŠ å…¥dropoutå’ŒBatch Normalizationï¼ˆBNï¼‰ï¼Œæ¢¯åº¦ä¼˜åŒ–å™¨æ˜¯Adamï¼Œå­¦ä¹ ç‡ä¸º0.01ã€‚è¾“å…¥ç‰¹å¾ä»…ä¸º77ç»´ï¼Œéšè—å±‚ç¥ç»å…ƒæ•°ä¸º[128ï¼Œ86]ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3e9e9ca5a1b49008405301c2cd77764~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=sOg9Q15hSmzp2zBuldyRlgMZVs4%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾5 æ¨¡å‹ç»“æ„</p>
<h5 data-id="heading-8">2.3 æ ·æœ¬æ„é€ </h5>
<p>ä¸ºäº†è®­ç»ƒlistwiseæ¨¡å‹ï¼Œéœ€è¦æ„é€ æ ·æœ¬æ¥è¡¨ç¤ºç”¨æˆ·çš„æŸ¥è¯¢queryå’Œitemä¹‹é—´çš„å…³ç³»ã€‚å›¾6(å·¦å›¾)æ˜¾ç¤ºäº†ä¸€ä¸ªå…¸å‹çš„ç”¨æˆ·æœç´¢æ—…ç¨‹çš„ç®€åŒ–ç¤ºä¾‹ï¼Œå…¶ä¸­å®¢æˆ·åœ¨å¤šå¤©å†…è¿›è¡Œå¤šæ¬¡queryæœç´¢ï¼Œå¹¶ç‚¹å‡»å¤šä¸ªæœç´¢ç»“æœä»¥æŸ¥çœ‹å…¶è¯¦ç»†é¡µé¢ï¼Œæœ€ç»ˆåœ¨ç¬¬Mæ—¥query#3ä¸‹çš„ç»“æœåˆ—è¡¨ä¸­ç”¨æˆ·ç‚¹å‡»äº†é…’åº—ï¼ˆhotel-bï¼‰å’Œä¸‹å•äº†é…’åº—ï¼ˆhotel-dï¼‰ï¼Œæ•´ä¸ªä¼šè¯ä»¥ç”¨æˆ·ä¸‹å•é…’åº—æˆåŠŸç»“æŸã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4e73372caac2496ea7a067f68e712fc8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=zg%2BsK07AYu7CPp%2F3tCVxNDVcsys%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾6 ç”¨æˆ·æœç´¢è¡Œä¸ºç¤ºä¾‹</p>
<p>åœ¨æˆ‘ä»¬çš„ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œçº¿ä¸Šä¸šåŠ¡ä¼˜åŒ–ç›®æ ‡ä¸ºä¸‹å•è½¬åŒ–ç‡ï¼Œå¯¹åº”ç¦»çº¿å»ºæ¨¡ç›®æ ‡ä¸ºæ›å…‰è½¬åŒ–ç‡ï¼ˆctcvrï¼‰ï¼Œå³ä»searchåˆ°orderçš„è½¬åŒ–ï¼Œè®­ç»ƒçš„ç›®æ ‡æ˜¯ä»æ›å…‰åˆ°ä¸‹å•çš„è½¬åŒ–ã€‚</p>
<ul>
<li>liståˆ—è¡¨é€‰æ‹©ï¼š
<ul>
<li>åœ¨ä»¥Listwiseæ–¹å¼å­¦ä¹ æ—¶ï¼Œæˆ‘ä»¬åªä½¿ç”¨å«æœ‰æˆåŠŸä¸‹å•çš„æœç´¢åˆ—è¡¨ï¼ˆDay Mçš„query#3ï¼‰ä¸ºListè®­ç»ƒæ ·æœ¬ï¼ŒDay1å’ŒDay2ä¸‹çš„æ— ä¸‹å•åˆ—è¡¨æ ·æœ¬å°†ä¸¢å¼ƒï¼Œæ ‡ç­¾è§å›¾6ï¼ˆå³å›¾ï¼‰ï¼›</li>
<li>åŸå› æ˜¯è‹¥å°†åªæœ‰ç‚¹å‡»æ ‡ç­¾çš„liståŠ å…¥è®­ç»ƒï¼Œåœ¨è®¡ç®—NDCGæ—¶ï¼Œä¸ç®¡ç‚¹å‡»æ ‡ç­¾çš„å€¼æ˜¯0.01è¿˜æ˜¯1ï¼Œndcgçš„å€¼éƒ½æ˜¯ä¸€æ ·ï¼Œæ­¤æ—¶è®¡ç®—LambdaLossæ—¶ï¼Œæ¨¡å‹ä¼šæ›´å€¾å‘äºåªæœ‰ç‚¹å‡»çš„listï¼Œé‡ç‚¹ä¼˜åŒ–äº†ctrã€‚</li>
</ul>
</li>
<li>æ­£æ ·æœ¬æ„é€ ï¼š
<ul>
<li>ä¸‹å•é…’åº—æ ‡ç­¾1ï¼›</li>
<li>ç‚¹å‡»é…’åº—æ ‡ç­¾0.01ï¼Œæ ‡ç­¾å€¼è¡¨ç¤ºæ ·æœ¬å’Œqueryçš„ç›¸å…³åº¦å¤§å°ï¼Œå¯æ ¹æ®å®éªŒæ•ˆæœè°ƒæ•´ï¼ˆç‚¹å‡»å’Œä¸‹å•ç›¸å…³åº¦æ¯”å€¼æˆ‘ä»¬æ˜¯æ•°æ®ç»Ÿè®¡å¾—æ¥ï¼‰ã€‚æˆ‘ä»¬è®¤ä¸ºç”¨æˆ·ç‚¹å‡»è¿‡çš„é…’åº—æ˜¯å…·æœ‰ä¸€å®šçš„å–œå¥½ï¼Œä¸èƒ½ç®€å•çš„è®¾ç½®æ ‡ç­¾ä¸º0ã€‚</li>
</ul>
</li>
<li>è´Ÿæ ·æœ¬æ„é€ ï¼š
<ul>
<li>hard negative sampleï¼šæ›å…‰æœªä¸‹å•ä¸”æœªç‚¹å‡»çš„é…’åº—ï¼›</li>
<li>easy negative sampleï¼šåœ¨åŒä¸€ä¸ªliståˆ—è¡¨ä¸­ï¼Œé‡‡æ ·liståˆ—è¡¨æœ€åº•éƒ¨çš„nå®¶(&lt;&lt;å½“æ¬¡è¯·æ±‚æ›å…‰é…’åº—æ•°)æœªæ›å…‰çš„é…’åº—ï¼Œæ ‡ç­¾ä¸º0ã€‚ç”±äºçº¿ä¸Šç²¾æ’æ’åºå®¶æ•°è¾ƒå¤šï¼Œåªé€‰å–æ›å…‰æ ·æœ¬è®­ç»ƒï¼Œæ¨¡å‹å¯¹easyè´Ÿæ ·æœ¬å­¦ä¹ ä¸å¥½ã€‚æ¨èç»“æœä¼šæœ‰éƒ¨åˆ†ä½è´¨é‡é…’åº—ï¼Œéœ€è¦é‡‡æ ·éƒ¨åˆ†ä½è´¨é…’åº—ä½œä¸ºeasy negative sampleï¼Œä¿®æ­£çº¿ä¸Šçº¿ä¸‹æ ·æœ¬åˆ†å¸ƒåå·®ï¼Œæå‡æ¨¡å‹æ³›åŒ–èƒ½åŠ›ã€‚</li>
</ul>
</li>
<li>æ ·æœ¬é‡ï¼šæ¨¡å‹è®­ç»ƒçš„æ ·æœ¬ä»¥æ—¶é—´ç»´åº¦åˆ‡åˆ†ï¼Œ30å¤©ä¸ºè®­ç»ƒé›†ï¼Œ7å¤©ä½œä¸ºéªŒè¯é›†ï¼Œ7å¤©ä½œä¸ºæµ‹è¯•é›†ã€‚</li>
</ul>
<p>å·¥ç¨‹å®è·µï¼šListwiseå­¦ä¹ æ–¹å¼çš„Lambdaæ¢¯åº¦éœ€è¦å¯¹åŒQueryä¸‹çš„æ ·æœ¬è¿›è¡Œè®¡ç®—ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å¯¹æ ·æœ¬è¿›è¡Œé¢„å¤„ç†ï¼šå°†åŒä¸€ä¸ªæŸ¥è¯¢(Query)çš„æ ·æœ¬èšåˆåœ¨ä¸€èµ·ï¼Œé‡‡ç”¨ExampleListWithContextç¼–ç æ–¹å¼ï¼Œå°†è¿™äº›æ ·æœ¬æ‰“åŒ…è¿›ä¸€ä¸ªTFRecordä¸­ã€‚ç”±äºæ¯æ¬¡è¯·æ±‚Queryå¬å›çš„itemæ•°ä¸ä¸€æ ·ï¼Œå¯¹äºå¯å˜Sizeçš„Queryæ ·æœ¬åœ¨æ‹‰å–æ•°æ®è¿›è¡Œè®­ç»ƒæ—¶éœ€è¦æ³¨æ„ï¼ŒTFä¼šè‡ªåŠ¨è¡¥é½Mini-Batchå†…æ¯ä¸ªæ ·æœ¬å¤§å°ä¸€è‡´ã€‚</p>
<h5 data-id="heading-9">2.4ç‰¹å¾å·¥ç¨‹</h5>
<p>ç‰¹å¾å·¥ç¨‹ä¸»è¦åŒ…æ‹¬ç‰¹å¾æ„å»ºã€ç‰¹å¾åˆ†æã€ç‰¹å¾å¤„ç†ï¼Œä»¥åŠç‰¹å¾é€‰æ‹©ç­‰ï¼š</p>
<p><strong>ç‰¹å¾æ„å»ºï¼š</strong></p>
<ul>
<li>ç”¨æˆ·ç‰¹å¾ï¼šç”¨æˆ·è¡Œä¸ºç‰¹å¾ï¼Œå¦‚è¿‡å»1å¹´ä¸‹å•çš„æ¬¡æ•°ï¼Œä¸‹å•è¯¥é…’åº—çš„æ¬¡æ•°ï¼Œç”¨æˆ·ç”»åƒç­‰</li>
<li>é…’åº—ç‰¹å¾ï¼šå±æ€§ç‰¹å¾ç­‰ï¼Œå¦‚ä»·æ ¼ï¼Œæ¡£æ¬¡ï¼Œæ˜Ÿçº§ï¼Œç‚¹å‡»ç‡ï¼Œè½¬åŒ–ç‡ï¼ŒèŠ‚å‡æ—¥ç­‰</li>
<li>äº¤å‰ç‰¹å¾ï¼šç”¨æˆ·åˆ°é…’åº—çš„è·ç¦»ï¼Œpoiåˆ°é…’åº—çš„è·ç¦»ç­‰</li>
<li>ä¸Šä¸‹æ–‡ç‰¹å¾ï¼šæ—¶é—´ï¼Œæœç´¢åœºæ™¯ç­‰</li>
</ul>
<p><strong>æ„å»ºåŸåˆ™ï¼š</strong></p>
<ul>
<li>é˜²æ­¢ç‰¹å¾ç©¿è¶Š</li>
<li>å°½é‡å’Œä¸šåŠ¡ç›¸å…³</li>
<li>æœ‰åŒºåˆ†æ€§ï¼Œå°½é‡ä½¿ç‰¹å¾èƒ½å¾ˆå¥½çš„åŒºåˆ†å‡ºæ­£è´Ÿæ ·æœ¬ã€‚</li>
</ul>
<p><strong>ç‰¹å¾é€‰æ‹©ï¼š</strong></p>
<ul>
<li>æ·±åº¦æ¨¡å‹ç›¸å¯¹äºæ ‘æ¨¡å‹å¯¹ç‰¹å¾å€¼çš„å¤§å°æ›´æ•æ„Ÿï¼Œæ²¡æœ‰åƒæ ‘æ¨¡å‹ä¸€æ ·æœ‰è‡ªåŠ¨ç‰¹å¾é€‰æ‹©åŠŸèƒ½ï¼Œå¼•å…¥ä¸€äº›å†—ä½™ç‰¹å¾ä¼šå¢å¤§æ·±åº¦æ¨¡å‹çš„å™ªå£°ã€‚å› æ­¤æˆ‘ä»¬åŸºäºLambdaMartçš„ç‰¹å¾é‡è¦æ€§æ’åºï¼Œé€‰å–æœ€é‡è¦çš„ç‰¹å¾è®­ç»ƒLambdaDnnï¼Œå¦‚å›¾7æ‰€ç¤ºï¼Œtop49ç»´ï¼ˆæ€»ç»´åº¦æ˜¯200ç»´ï¼‰æ—¶ï¼Œæµ‹è¯•é›†åˆçš„ndcg@10æŒ‡æ ‡ï¼ˆtest_ndcgï¼‰å’Œå…¨é‡ç‰¹å¾ndcg@10ï¼ˆorigin_test_ndcgï¼‰ç›¸æ¯”æŒå¹³ï¼Œä¸”ç‰¹å¾åœ¨top25ç»´æ—¶æŒ‡æ ‡ä¸åœ¨å¢é•¿ã€‚è€ƒè™‘åˆ°æ·±åº¦æ¨¡å‹çš„å‚æ•°ç©ºé—´æ›´å¤§ï¼Œå­¦ä¹ èƒ½åŠ›æ›´å¼ºï¼Œæˆ‘ä»¬åœ¨top49ç»´ç‰¹å¾çš„åŸºç¡€ä¸Šï¼ŒåŸºäºäººå·¥ç»éªŒåˆæŒ‘é€‰äº†28ç»´ç‰¹å¾ï¼Œä¸€å…±77ç»´ã€‚</li>
</ul>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f97d6acfe2f4dcd870fee8b89fd7f39~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=CFy1WTk%2BLM%2FjFSCYEuK2O%2FJsLRg%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾7 é€‰æ‹©ä¸åŒtopæ•°é‡çš„ç‰¹å¾è®­ç»ƒåçš„æ¨¡å‹æ•ˆæœ</p>
<p><strong>ç‰¹å¾åˆ†æï¼š</strong></p>
<p>æ·±åº¦æ¨¡å‹å¯¹ç‰¹å¾å¤§å°è¾ƒä¸ºæ•æ„Ÿï¼Œå› æ­¤ç‰¹å¾å¤„ç†çš„å¥½åç›´æ¥å½±å“åç»­æ¨¡å‹çš„è¡¨ç°ã€‚</p>
<ul>
<li>é•¿å°¾åˆ†å¸ƒï¼šä¾‹å¦‚ç‚¹å‡»ç‡ã€ç‚¹å‡»æ¬¡æ•°ç­‰ç‰¹å¾ï¼Œ80%çš„å€¼åˆ†å¸ƒåœ¨é è¿‘0çš„é™„è¿‘ï¼Œè‹¥ç›´æ¥åŠ å…¥æ¨¡å‹è®­ç»ƒï¼Œç”±äºå€¼å·®è·å¤ªå°ï¼Œå’Œå…¶ä»–ç‰¹å¾ç›¸æ¯”æ²¡æœ‰åŒºåˆ†æ€§ï¼Œå› æ­¤éœ€è¦åšä¸€äº›logå˜æ¢åä¸ºæ­£æ€åˆ†å¸ƒï¼Œæ›´æœ‰åˆ©äºæ¨¡å‹æ”¶æ•›ã€‚å¦‚ä¸‹è¡¨ï¼š</li>
</ul>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/020bbec932a1457295073a1bb73a80a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=Nyfl8xGaxl4mXHDmjf%2BHMQDa6Xc%3D" alt="6ba3501906803be67bc43b369df8b67b.png" loading="lazy"/></p>
<ul>
<li>æ­£æ€åˆ†å¸ƒï¼šä»·æ ¼ç­‰å–å€¼è¾ƒå¤§è¿ç»­ç‰¹å¾ï¼Œä½¿ç”¨äº†æœ€å¤§æœ€å°å½’ä¸€åŒ–æ–¹æ³•ï¼Œå°†ç‰¹å¾å€¼éƒ½è½¬åŒ–ä¸º0-1ä¹‹é—´çš„æ•°å€¼ã€‚</li>
<li>ç¼ºå¤±å€¼å¡«è¡¥ï¼šåœ¨è®­ç»ƒæ ·æœ¬ä¸­ä¸å¯é¿å…åœ°æœ‰éƒ¨åˆ†è¿ç»­ç‰¹å¾å­˜åœ¨ç¼ºå¤±å€¼ï¼Œåˆç†å¤„ç†ç¼ºå¤±å€¼ä¼šå¯¹æœ€ç»ˆæ•ˆæœæœ‰ä¸€å®šå¸®åŠ©ã€‚å¡«è¡¥ç¼ºå¤±å€¼çš„æ–¹å¼æœ‰ï¼š
<ul>
<li>å–é›¶å€¼ï¼Œä¼šå¯¼è‡´ç›¸åº”æƒé‡æ— æ³•è¿›è¡Œæ›´æ–°ï¼Œæ”¶æ•›é€Ÿåº¦å‡æ…¢ã€‚</li>
<li>å–å¹³å‡å€¼ä¹Ÿç•¥æ˜¾æ­¦æ–­ï¼Œæ¯•ç«Ÿä¸åŒçš„ç‰¹å¾ç¼ºå¤±æ‰€è¡¨ç¤ºçš„å«ä¹‰å¯èƒ½ä¸å°½ç›¸åŒã€‚</li>
<li>æˆ‘ä»¬å¸Œæœ›ç¥ç»ç½‘ç»œä¹Ÿå¯ä»¥é€šè¿‡å­¦ä¹ çš„æ–¹å¼è‡ªé€‚åº”åœ°å¤„ç†ç¼ºå¤±å€¼ï¼Œè€Œä¸æ˜¯äººä¸ºè®¾ç½®é»˜è®¤å€¼ã€‚å¯¹è¾ƒä¸ºé‡è¦çš„ç‰¹å¾ï¼ˆç‰¹å¾é‡è¦åº¦å¯é€šè¿‡æ¨¡å‹çš„ä¿¡æ¯å¢ç›Šå¾—åˆ†å¾—åˆ°ï¼‰ï¼Œä¸”ç¼ºå¤±ç‡è¾ƒå¤§çš„ï¼Œå¡«è¡¥å€¼ä¸º0ï¼ŒåŒæ—¶å¯¹ç¼ºå¤±ç‰¹å¾å­¦ä¹ ä¸€ä¸ªç¼ºå¤±æƒé‡ï¼Œå¦‚ä¸‹å…¬å¼æ‰€ç¤ºï¼š</li>
</ul>
</li>
</ul>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/242195055ceb4845980ea7fe670e1412~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=bGeg6MBXCJhvjZz%2BhkD8OG2YaVk%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä»¬é€šè¿‡ä¸Šè¿°å˜æ¢æ–¹å¼ï¼Œè®©æ‰€æœ‰ç‰¹å¾èŒƒå›´åœ¨0-1ä¹‹é—´æˆ–è€…0é™„è¿‘ï¼Œåœ¨è¾“å…¥æ¨¡å‹åç»è¿‡ä¸€å±‚bnæ“ä½œè¿›è¡Œæ­£æ€åˆ†å¸ƒå¤„ç†ã€‚å½“ç„¶è¿˜æœ‰å…¶ä»–å¤„ç†æ–¹å¼ï¼Œå…·ä½“è¿˜è¦æ ¹æ®è‡ªå·±ä¸šåŠ¡é€‰æ‹©åˆé€‚çš„å¤„ç†æ–¹å¼ã€‚</p>
<h5 data-id="heading-10">2.5 å®éªŒè¯„ä¼°</h5>
<p>baselineæ¨¡å‹å³LambdaMartï¼Œç¦»çº¿ndcg@10æ•ˆæœå¦‚ä¸‹è¡¨ï¼ŒLambdaDnnçº¿ä¸Šè½¬åŒ–ç‡æå‡0.5%ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2df1297120f343a7a846f49b23cf1444~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=8WqxqrvSK4qIrQ6wXsWvSMZIuWo%3D" alt="61f15fcf5396064c9e98db66661b2597.png" loading="lazy"/></p>
<h4 data-id="heading-11">3. å¤šç›®æ ‡æ¨¡å‹ä¼˜åŒ–</h4>
<p>åœ¨ç±»ä¼¼ç”µå•†æœç´¢æ¨èç³»ç»Ÿä¸­ï¼Œç”¨æˆ·çš„è¡Œä¸ºé€šå¸¸æŒ‰ç…§ä¸€ç§åºåˆ—åŒ–çš„æ¨¡å¼è¿›è¡Œï¼Œå³é¦–å…ˆæ˜¯æ›å…‰ï¼Œç„¶åæ˜¯ç‚¹å‡»ï¼Œæœ€åæ˜¯è½¬åŒ–ã€‚å› æ­¤ï¼ŒCTCVRæ¨¡å‹çš„ä½œç”¨æ˜¯é¢„ä¼°åœ¨æ›å…‰å‘ç”Ÿåçš„è½¬åŒ–æ¦‚ç‡ã€‚</p>
<h5 data-id="heading-12">3.1 ä¸ºä»€ä¹ˆé€‰æ‹©å¤šç›®æ ‡å»ºæ¨¡ï¼Ÿ</h5>
<p><strong>å•ç›®æ ‡æ–¹å¼ç¼ºé™·ï¼š</strong></p>
<p>1ï¼‰æ ·æœ¬é€‰æ‹©åå·®é—®é¢˜</p>
<ul>
<li>è®­ç»ƒé˜¶æ®µï¼šListwiseæ¨¡å¼è®­ç»ƒæ ·æœ¬æ˜¯ç”¨æˆ·æœ€åä¸€æ¬¡åœ¨Day Mæ—¥query#3ä¸‹çš„ä¸‹å•åˆ—è¡¨ï¼Œä¸‹å•å‰çš„è¡Œä¸ºåˆ—è¡¨éƒ½è¢«ä¸¢å¼ƒã€‚</li>
<li>åœ¨çº¿æ¨æ–­ï¼šquery#1ã€query#2çš„åˆ—è¡¨éƒ½ä¼šç»è¿‡æ¨ç†ï¼Œæ­¤æ—¶æ ·æœ¬æ˜¯æœ‰é€‰æ‹©åå·®çš„ï¼Œç¦»çº¿è®­ç»ƒå’Œåœ¨çº¿æ¨ç†æ ·æœ¬åˆ†å¸ƒä¸ä¸€è‡´ï¼Œæ¨¡å‹å¾ˆéš¾å­¦ä¹ åˆ°çœŸå®æ ·æœ¬åˆ†å¸ƒä¿¡æ¯ï¼Œå¯¼è‡´æ¨¡å‹çš„æ³›åŒ–æ€§èƒ½é™ä½ï¼›</li>
<li>å¯¹æ— ä¸‹å•è¡Œä¸ºçš„ç”¨æˆ·å­¦ä¹ æ•ˆæœè¾ƒå·®</li>
</ul>
<p>2ï¼‰æ¨¡å‹åˆ†å¯è§£é‡Šæ€§å·®</p>
<ul>
<li>Listwiseæ¨¡å¼å­¦ä¹ çš„è¾“å‡ºæ˜¯ååºå…³ç³»ï¼Œå€¼èŒƒå›´è¾ƒå¤§ï¼Œä¸æ˜¯åœ¨[0-1]ä¹‹é—´ï¼Œä¸”æ¯ä¸€æ¬¡è¯·æ±‚çš„å€¼èŒƒå›´åŒºé—´ä¸åŒï¼Œå¯¹åç»­ä¸šåŠ¡é‡æ’ç­–ç•¥è°ƒæ•´éš¾åº¦è¾ƒå¤§ã€‚è‹¥å½’ä¸€åŒ–åˆ°[0-1]åï¼Œä¸åƒå®é™…cträ¸€æ ·å…·æœ‰ç‰©ç†å«ä¹‰ã€‚</li>
</ul>
<p>3ï¼‰æ•°æ®ç¨€ç–ï¼Œæ¨¡å‹æ³›åŒ–èƒ½åŠ›ä¸è¶³</p>
<ul>
<li>è‹¥pointwiseæ¨¡å¼åªä½¿ç”¨æ›å…‰å’Œä¸‹å•æ ·æœ¬è®­ç»ƒCTCVRç›®æ ‡æ—¶ï¼Œä¸‹å•æ•°æ®éå¸¸ç¨€ç–ï¼Œä¸‹å•æ ·æœ¬çš„æ•°é‡è¿œè¿œå°äºæ›å…‰æ ·æœ¬ã€‚è€Œåˆ©ç”¨CTRä»»åŠ¡çš„ä¸°å¯Œæ•°æ®å¯ä»¥å¸®åŠ©CTCVRä»»åŠ¡å…‹æœæ•°æ®ç¨€ç–æ€§é—®é¢˜ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å’Œé¢„æµ‹æ€§èƒ½</li>
</ul>
<p><strong>å¤šç›®æ ‡ä¼˜åŠ¿ï¼š</strong></p>
<p>1ï¼‰ç¼“è§£æ ·æœ¬åå·®ï¼ŒåŠç¨€ç–æ€§</p>
<ul>
<li>å°†æ›å…‰ç‚¹å‡»ä¸‹å•éƒ½å¯ä»¥åŠ å…¥åˆ°æ¨¡å‹ä¸­å­¦ä¹ </li>
</ul>
<p>2ï¼‰å¯è§£é‡Šæ€§å¥½</p>
<ul>
<li>è¾“å‡ºå€¼æ˜¯æ¦‚ç‡æ„ä¹‰ï¼Œæ›´å¥½èåˆåé¢çš„é‡æ’åŠ æƒç­–ç•¥ï¼›</li>
</ul>
<p>3ï¼‰ä¿ƒè¿›ä½œç”¨</p>
<ul>
<li>é€šè¿‡å…±äº«ä¸€äº›æµ…å±‚æ¬¡çš„ç‰¹å¾ï¼Œå¤šä»»åŠ¡å­¦ä¹ å¯ä»¥å€ŸåŠ©å½¼æ­¤ä¹‹é—´çš„ç›¸ä¼¼æ€§å’Œå·®å¼‚æ€§æ¥ä¿ƒè¿›å­¦ä¹ è¿‡ç¨‹</li>
</ul>
<p>4ï¼‰çº¦æŸä½œç”¨</p>
<ul>
<li>å½“å¤šä¸ªä»»åŠ¡åŒæ—¶è¿›è¡Œåå‘ä¼ æ’­æ—¶ï¼Œç”±äºä¸åŒä»»åŠ¡å…·æœ‰ä¸åŒçš„å™ªå£°æ¨¡å¼ï¼Œå¤šç›®æ ‡å¯ä»¥å°†å¤šä¸ªä»»åŠ¡çš„åé¦ˆä¿¡æ¯ç»“åˆèµ·æ¥ï¼Œå¹³å‡å™ªå£°æ¨¡å¼ï¼Œä»è€Œå¾—åˆ°æ›´ä¸€èˆ¬å’Œç¨³å®šçš„è¡¨å¾ï¼Œæœ‰ç‚¹åƒæ­£åˆ™åŒ–çš„ä½œç”¨ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œç›¸å¯¹äºå•ä¸ªä»»åŠ¡ï¼Œæ¨¡å‹çš„è¿‡æ‹Ÿåˆé£é™©ä¼šé™ä½ï¼Œæ³›åŒ–èƒ½åŠ›ä¼šæé«˜ã€‚</li>
</ul>
<h5 data-id="heading-13">3.2 å¤šç›®æ ‡å»ºæ¨¡é€‰å‹</h5>
<p>MMOEæ˜¯è°·æ­Œ18å¹´æå‡ºçš„æ¨¡å‹ç»“æ„ï¼Œå…¶æ€æƒ³æ˜¯æ‰€æœ‰ç›®æ ‡å…±äº«å¤šä¸ªexpertsï¼Œä½†æ˜¯è€ƒè™‘åˆ°ä¸åŒä»»åŠ¡ä¹‹é—´çš„å·®å¼‚æ€§ï¼Œä¸ºæ¯ä¸€ä¸ªç›®æ ‡è®¾ç½®ä¸€ä¸ªgateé—¨æ§ç½‘ç»œï¼Œç”¨æ¥æ§åˆ¶ä¸åŒç›®æ ‡é€‰æ‹©æ¯ä¸ªexpertçš„ä¿¡å·å æ¯”ï¼Œç±»ä¼¼äºweighted sum poolingæ“ä½œã€‚</p>
<p>MMOEï¼ˆå¦‚å›¾8æ‰€ç¤ºï¼‰é€šè¿‡å…±äº«expertså­¦ä¹ åˆ°ä¸åŒä»»åŠ¡çš„è”ç³»å’Œå·®å¼‚ï¼Œæé«˜äº†æ¯ä¸ªä»»åŠ¡çš„å­¦ä¹ æ•ˆç‡å’Œè´¨é‡ï¼ŒåŒæ—¶é€šè¿‡gatesæ¥å¹³è¡¡å¤šä¸ªä»»åŠ¡å¯¹expertsä¿¡å·çš„é€‰æ‹©ï¼Œä¸è¦æ±‚ç›®æ ‡ä¹‹é—´å¿…é¡»æ˜¯é«˜ç›¸å…³æ€§çš„ï¼ŒMMOEæ˜¯ä¸šç•Œé€šç”¨çš„å¤šç›®æ ‡å®ç°ç®—æ³•ã€‚</p>
<p>å¤šç›®æ ‡å»ºæ¨¡æ›´å¥½çš„è€ƒè™‘äº†æ’åºå…¨ç©ºé—´çš„æ›å…‰æ ·æœ¬ï¼Œç»¼åˆè€ƒè™‘äº†ä¸‹å•å‰çš„ç”¨æˆ·ç‚¹å‡»è¡Œä¸ºï¼Œé™ä½æ ·æœ¬åå·®é—®é¢˜ï¼Œå¼•å…¥äº†å¤šä¸ªä¸“å®¶ã€2ä¸ªç›®æ ‡ä»»åŠ¡ã€ä¸€ä¸ªCTRç›®æ ‡ä»»åŠ¡å’Œä¸€ä¸ªCTCVRç›®æ ‡ä»»åŠ¡ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13cd33a45b334a079829c586a29a9183~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=QqL9TVZAcK4beXbAo8D67gCuoNM%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾8 MMOEç½‘ç»œç»“æ„</p>
<h5 data-id="heading-14">3.3 MMOEæ ·æœ¬é€‰æ‹©</h5>
<p>1ï¼‰åªé€‰å–æœ‰è¡Œä¸ºçš„æœç´¢åˆ—è¡¨ï¼Œå³è¯¥åˆ—è¡¨æ˜¯æœ‰è¢«ç‚¹å‡»æˆ–è¢«ä¸‹å•çš„é…’åº—çš„åˆ—è¡¨ï¼›</p>
<ul>
<li>åŸå› ï¼šæ­£è´Ÿæ ·æœ¬æ¯”ä¾‹ç›¸å·®è¾ƒå¤§ï¼Œè¿‡æ»¤ä¸€éƒ¨åˆ†è®¤ä¸ºæ— æ•ˆè´Ÿæ ·æœ¬ï¼›å…¶æ¬¡è®­ç»ƒæ—¶é¿å…æ²¡æœ‰æ­£è¡Œä¸ºç”¨æˆ·çš„å½±å“ï¼Œåœ¨ä¸€æ‰¹æ•°æ®ä¸­å¦‚æœæŸä¸ªç”¨æˆ·å¯¹æ‰€æœ‰å±•ç¤ºçš„ç‰©å“éƒ½æ²¡æœ‰ç‚¹å‡»ç­‰è¡Œä¸ºï¼Œåº”å½“è¿‡æ»¤æ‰è¯¥ç”¨æˆ·çš„è®°å½•ï¼ˆæ²¡æœ‰æ­£è¡Œä¸ºç”¨æˆ·åªæä¾›è´Ÿä¾‹ï¼Œçœ‹ä¸å‡ºç”¨æˆ·å–œå¥½ï¼Œå¯¹æ¨¡å‹è®­ç»ƒæ²¡æœ‰å¸®åŠ©ï¼‰ã€‚</li>
</ul>
<p>2ï¼‰é€‰å–æ¯ä¸ªåˆ—è¡¨çš„æ›å…‰æ ·æœ¬ï¼Œä»¥åŠæ¯ä¸ªåˆ—è¡¨çš„æœ€åº•éƒ¨æœªæ›å…‰çš„nå®¶é…’åº—ä½œä¸ºeasy negative sampleï¼Œé˜²æ­¢æ’åºå‡ºä¸€äº›è¾ƒå·®çš„é…’åº—ã€‚</p>
<p>3ï¼‰åŒä¸€ä¸ªè¯·æ±‚åˆ—è¡¨ä¸­çš„é…’åº—è¢«ç‚¹å‡»å¤šæ¬¡çš„ï¼Œåªè®°å½•ä¸€æ¬¡ç‚¹å‡»è¡Œä¸ºï¼Œå³ä¸€æ¬¡ç‚¹å‡»æ­£æ ·æœ¬ã€‚</p>
<h5 data-id="heading-15">3.4 MMOEè®­ç»ƒè¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜</h5>
<p>1ï¼‰å®é™…çš„ä¸šåŠ¡æ•°æ®ä¸­ï¼Œæ›å…‰åˆ°è½¬åŒ–è¿‡äºç¨€ç–ï¼Œå…·ä½“è®­ç»ƒè¿‡ç¨‹ä¸­ctcvrçš„lossæ˜æ˜¾æ¯”ctrçš„losså°ã€‚ä¸ºäº†ä½¿å¾—2ä¸ªç›®æ ‡ä»»åŠ¡çš„lossçš„é‡çº§ä¸€è‡´ï¼Œå¹¶æ²¡æœ‰é‡‡ç”¨lossåŠ æƒå¤„ç†ï¼Œè€Œæ˜¯åœ¨æ ·æœ¬æ„é€ è¿‡ç¨‹ä¸­å¯¹ä¸‹å•æ ·æœ¬è¿›è¡Œä¸Šé‡‡æ ·å¤åˆ¶ï¼Œä¿æŒæ­£è´Ÿæ ·æœ¬1:1ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ä½¿å¾—ç›®æ ‡losså¤§å°é‡çº§ä¸€æ ·ã€‚</p>
<p>è¿™æ ·åœ¨è®­ç»ƒshuffleæ—¶ï¼Œä¸ä¼šä½¿å¾—ä¸€ä¸ªæ­£æ ·æœ¬åœ¨batchå†…é‡å¤å‡ºç°Næ¬¡ï¼Œä½¿å¾—ctcvrä»»åŠ¡æ³›åŒ–æ€§æ›´å¥½ï¼ŒåŒæ—¶å¯¹cträ»»åŠ¡ä¸­çš„ä¸Šé‡‡æ ·è¿‡çš„ç‚¹å‡»æ ·æœ¬è¿›è¡Œé™æƒå¤„ç†ï¼Œæ¢å¤åŸå…ˆæ ·æœ¬åˆ†å¸ƒã€‚</p>
<p>2ï¼‰gate networkè¾“å‡ºè¿›å…¥é¥±å’ŒåŒºï¼Œåå‘ä¼ æ’­æ¢¯åº¦æ¶ˆå¤±ï¼š</p>
<p>expert gateè¾“å‡ºï¼Œæ˜¯ç”±è¾“å…¥ç‰¹å¾ç»è¿‡é—¨ç½‘ç»œåsoftmaxå¾—åˆ°ï¼Œåœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­ï¼Œç»è¿‡ä¸€æ®µè¿­ä»£æ¬¡æ•°ï¼Œé—¨æ§ç½‘ç»œçš„è¾“å…¥å€¼æ–¹å·®å˜å¤§ï¼Œç»è¿‡softmaxågate networkå¤§éƒ¨åˆ†è¾“å‡ºæ˜¯0ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œmulti expertçš„ä¼˜åŠ¿å°±æ²¡åŠæ³•å‘æŒ¥å‡ºæ¥ï¼Œ</p>
<p>ä¸€ç§è§£å†³æ–¹å¼æ˜¯dropoutï¼Œä¾ç„¶è§£å†³ä¸äº†éƒ¨åˆ†å€¼åå¤§çš„é—®é¢˜ï¼›å¦ä¸€ç§æ–¹å¼å¯¹è¿›å…¥softmaxä¹‹å‰çš„å¾—åˆ†ï¼Œè¿›è¡Œå¾—åˆ†é™¤ä»¥ä¸€ä¸ªlambdaå¹³æ»‘å¤„ç†ï¼ˆå³ï¼Œæ¸©åº¦ç³»æ•°çš„è°ƒèŠ‚ï¼‰ï¼Œç¼“è§£éƒ¨åˆ†ä¸“å®¶é€€åŒ–ç°è±¡ï¼›è¿™é‡Œå–lambdaä¸ºè¾“å…¥ç‰¹å¾çš„ç»´åº¦ï¼Œä¹Ÿå¯ä»¥å‚è€ƒself-attentionã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b0118f6a54044ce39a428fb4bfa5eb78~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=EgkKNgifd7oyugJLm%2BfverfEzJI%3D" alt="å¾®ä¿¡å›¾ç‰‡_2026-01-14_153851_295.png" loading="lazy"/></p>
<p>å¦‚ä¸‹è¡¨æŒ‡æ•°eå‡½æ•°æ›²çº¿ä¸­æ‰€ç¤ºï¼Œxçš„åŸŸèŒƒå›´åœ¨[-10,10]åŒºé—´æ—¶ï¼Œsoftmaxçš„å€¼å¾ˆå®¹æ˜“åœ¨xå°äº-2.5æ—¶ä¸º0ï¼Œxå¤§äº10æ—¶ä¸º1ã€‚å¦‚æœå°†xç¼©æ”¾å°ºåº¦ä¸º1/100ï¼Œå°±ä¼šç¼“è§£é€€åŒ–é—®é¢˜ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30798f72e0334d6dbe3b5bd9678c0c4d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=aL2ZZJA2fid2p7Mygh3OlD8XXws%3D" alt="3b9aedd9a2ea098fd6d5f8fb47021e6d.png" loading="lazy"/></p>
<h5 data-id="heading-16">3.5 å®éªŒç»“æœ</h5>
<p>çº¿ä¸Šé¢„æµ‹æ—¶ï¼Œæˆ‘ä»¬ä¼šåŠ æƒèåˆä¸¤ä¸ªç›®æ ‡é¢„æµ‹å€¼ä½œä¸ºæ’åºåˆ†ï¼Œè€Œèåˆæƒé‡å¯ä»¥é€šè¿‡ç¦»çº¿æ•°æ®æ‹Ÿåˆå¾—åˆ°ã€‚</p>
<p>ä»ä¸‹è¡¨ä¸­ï¼Œæˆ‘ä»¬çš„MMOEæœ€ç»ˆçš„ç¦»çº¿æŒ‡æ ‡NDCG@10æ²¡æœ‰æå‡ï¼Œä¸»è¦çš„åŸå› æ˜¯æµ‹è¯•é›†æ˜¯åªèƒ½åœ¨æœ‰ä¸‹å•çš„è¯·æ±‚ä¸Šé¢„æµ‹ï¼Œè€Œlambdaç›´æ¥å­¦ä¹ çš„ndcgç›®æ ‡ï¼Œæ‰€ä»¥ndcgæ›´é«˜ã€‚è€Œå¤šç›®æ ‡çº¿ä¸Šçš„ctræœ‰æ˜æ˜¾æå‡ï¼Œçº¿ä¸Šç‚¹å‡»ç‡æå‡2%ï¼Œè½¬åŒ–ç‡æŒå¹³ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1176845db93740caa18c492ce2534015~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=277IzinRpbECKQIFvO2oFx%2FfMCk%3D" alt="e69c4c99b5bbf117b81801da690150a3.png" loading="lazy"/></p>
<h4 data-id="heading-17">4. å¤šåœºæ™¯å¤šç›®æ ‡ä¼˜åŒ–</h4>
<h5 data-id="heading-18">4.1 ä¸šåŠ¡èƒŒæ™¯</h5>
<p>åœ¨ç”¨æˆ·å‡ºè¡Œæƒ³è¦é¢„å®šé…’åº—æ—¶ï¼Œæœç´¢é…’åº—åˆ—è¡¨æ˜¯ä¸€ä¸ªå¸¸è§çš„è¡Œä¸ºã€‚æ ¹æ®ç”¨æˆ·æ‰€å¤„ç©ºé—´ä¸åŒã€æœç´¢è¡Œä¸ºä¸åŒï¼Œåˆ†ä¸ºï¼šå¼‚åœ°ç©ºæœï¼ŒåŒåŸç©ºæœç­‰åœºæ™¯ï¼Œå¹¶ä¸”ä¸€ä¸ªç”¨æˆ·ä¼šè·¨ä¸åŒåœºæ™¯è¿›è¡Œæœç´¢ã€‚è€Œä¹‹å‰æ¨¡å‹å»ºæ¨¡ï¼Œæ¯ä¸ªåœºæ™¯å•ç‹¬è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œä¸€æ˜¯æ ‘æ¨¡å‹å®¹é‡å°ç­‰å†å²åŸå› å»¶ç»­å•ç‹¬å»ºæ¨¡ï¼ŒäºŒæ˜¯æ¯ä¸ªåœºæ™¯ä¸‹æ‰€ä½¿ç”¨çš„ç‰¹å¾ä¸ä¸€æ ·ï¼Œç‰¹å¾çš„ç´¢å¼•ä¹Ÿæ²¡æœ‰å¯¹é½ã€‚</p>
<p>å•ç‹¬å»ºæ¨¡ä¸ä¼šå—åˆ°å…¶ä»–åœºæ™¯ä¸‹çš„ç‰¹å¾å½±å“ï¼Œå…¶æ¬¡ä¹Ÿå¯å­¦åˆ°å•ä¸ªåœºæ™¯ç‹¬æœ‰çš„ä¸€äº›ç‰¹ç‚¹ã€‚ä½†æ˜¯å¸¦æ¥çš„é—®é¢˜æ˜¯ä¸åŒåœºæ™¯ä¸‹çš„å…±æœ‰ä¿¡æ¯æ— æ³•ç›¸äº’å…±äº«ã€æ— æ³•è¿ç§»å­¦ä¹ ï¼Œé€ æˆäº†ä¿¡æ¯å­¤å²›ã€‚å› ä¸ºåŒä¸€ä¸ªç”¨æˆ·ä¼šåœ¨ä¸åŒåœºæ™¯ä¸‹éƒ½æœ‰æœç´¢è¡Œä¸ºï¼Œå°†åŒä¸€ä¸ªç”¨æˆ·è¡Œä¸ºæ ·æœ¬åˆ†å¼€å»ºæ¨¡æ˜¾ç„¶æ˜¯ä¸åˆç†çš„ï¼ŒåŒæ—¶å¯¹å¤šä¸ªæ¨¡å‹çš„ç»´æŠ¤æˆæœ¬ä¹Ÿå¾ˆé«˜ã€‚</p>
<p>å› æ­¤ï¼Œå‡çº§åˆ°äº†MMOEæ¨¡å‹åï¼Œæˆ‘ä»¬è€ƒè™‘å°†å‡ ä¸ªåœºæ™¯ä¸‹çš„æ ·æœ¬èåˆå­¦ä¹ ä¸€ä¸ªæ¨¡å‹ï¼Œå®—æ—¨æ˜¯æ—¢å¯ä»¥å­¦ä¹ åˆ°åœºæ™¯é—´ç‹¬æœ‰ä¿¡æ¯ï¼Œä¹Ÿèƒ½è¿ç§»å­¦ä¹ ä¸åŒåœºæ™¯ä¸‹çš„å…±æœ‰ä¿¡æ¯ã€‚</p>
<h5 data-id="heading-19">4.2 å¤šåœºæ™¯æ ·æœ¬å¦‚ä½•è¿›è¡Œèåˆï¼Ÿ</h5>
<p>ä¸åŒåœºæ™¯ä¸‹ç”¨æˆ·å’Œitemå­˜åœ¨é‡å ï¼Œå…·æœ‰ä¸€å®šå…±æ€§ï¼Œä¸åŒåœºæ™¯ä¸‹çš„ç”¨æˆ·è¡Œä¸ºï¼Œå…·æœ‰ä¸€å®šå·®å¼‚æ€§ï¼›ä¸åŒä»»åŠ¡ä¹‹é—´å…·æœ‰ä¸åŒçš„ç¨€ç–æ€§ï¼ŒåŒæ—¶ä¹Ÿå­˜åœ¨ç›¸äº’å½±å“ï¼›å¦‚æœåœ¨å»ºæ¨¡è¿‡ç¨‹ä¸­å¿½ç•¥äº†å¤šåœºæ™¯å’Œå¤šä»»åŠ¡ä¹‹é—´çš„å…±æ€§å’Œå·®å¼‚æ€§ï¼Œä¼šå½±å“å»ºæ¨¡æ•ˆæœï¼Œå¦‚æœå¤šä¸ªåœºæ™¯å’Œä»»åŠ¡ä¸èƒ½å¾ˆå¥½åœ°è¿›è¡Œå¹³è¡¡ï¼Œä¼šå­˜åœ¨åœºæ™¯è··è··æ¿å’Œ ä»»åŠ¡è··è··æ¿ç°è±¡ã€‚</p>
<p>ä¸€å¼€å§‹æˆ‘ä»¬ä¹Ÿæ˜¯è°ƒç ”äº†ç›®å‰ä¸åŒåœºæ™¯ä¸‹å»ºæ¨¡çš„æ–¹å¼ï¼Œå¦‚é˜¿é‡ŒSTARã€HMOEç­‰å¤šåœºæ™¯å»ºæ¨¡æ–¹å¼ï¼Œä½†æ˜¯æ•ˆæœä¸ä½³ã€‚åŸå› æ˜¯STARã€HMOEæ¨¡å‹éƒ½æ˜¯å¯¹ä¸åŒåœºæ™¯ä¸‹çš„åˆ†å¸ƒå·®å¼‚è¾ƒå¤§çš„æ ·æœ¬è¿›è¡Œå»ºæ¨¡ï¼Œä¼šæœ‰æ¯”è¾ƒå¥½çš„æ•ˆæœã€‚ä¾‹å¦‚ã€æ·˜å®çš„å•†å“çš„ä¸»æœåˆ—è¡¨æ¨èã€å’Œä¸»é¡µçš„çŒœä½ å–œæ¬¢ç­‰ä¸åŒçš„å¤šä¸ªé¢‘é“çš„å»ºæ¨¡ï¼Œè€Œåœ¨å»å“ªå„¿çš„é…’åº—åœºæ™¯ï¼Œå…¶å®è¿˜éƒ½æ˜¯ä¸€ä¸ªé¢‘é“ï¼Œç”¨æˆ·çš„è¡Œä¸ºåˆ†å¸ƒéƒ½æ˜¯ä¸€è‡´çš„ï¼Œåœ¨ç›®çš„åœ°ç¡®å®šçš„å‰æä¸‹ï¼Œæ— è®ºæ˜¯poiæœç´¢ã€åŒåŸæœç´¢ï¼Œéƒ½æ˜¯æƒ³é¢„å®šç›®çš„åœ°ä¸‹çš„ç¬¦åˆéœ€æ±‚çš„é…’åº—ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å°è¯•äº†ç›´æ¥å°†å¤šä¸ªåœºæ™¯çš„æ ·æœ¬æ”¾åœ¨ä¸€èµ·å­¦ä¹ ï¼ŒåŒæ—¶ç‰¹å¾ä¸€èµ·è¾“å…¥åˆ°MMOEä¸­ï¼Œç®€å•çš„hard-shareæ•ˆæœæ¯”STARã€HMOEæ•ˆæœä¼šå¥½ã€‚æˆ‘ä»¬å°†è®­ç»ƒå®Œçš„æ¨¡å‹ï¼Œè¾“å‡ºæ¯ä¸ªåœºæ™¯çš„ä¸“å®¶æƒé‡ï¼Œæ¥åˆ†æä¸åŒåœºæ™¯ä¸‹çš„æƒé‡æ˜¯å¦åˆ†å¸ƒä¸€æ ·ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/620531d072224d5fb4bc9ea125aeb245~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=AzAfm2Qg2IYUrVHG95Qh3jUcXig%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾9 ä¸åŒåœºæ™¯ä¸‹æ ·æœ¬åœ¨ä¸“å®¶ä¸‹çš„æƒé‡å æ¯”</p>
ä»å›¾9æ¥çœ‹ï¼Œä¸åŒåœºæ™¯ä¸‹çš„ä¸“å®¶æƒé‡ï¼Œåˆ†å¸ƒå‡ ä¹ä¸€è‡´ï¼Œæœ€é«˜çš„æƒé‡æ˜¯ä¸“å®¶2ã€‚ä¾§é¢éªŒè¯äº†ï¼Œåœ¨æˆ‘ä»¬çš„ä¸šåŠ¡ä¸‹åœºæ™¯é—´çš„åˆ†å¸ƒå·®å¼‚æ²¡æœ‰å¾ˆå¤§ã€‚çº¿ä¸Šçš„ä¸‹å•è½¬åŒ–ç›¸å¯¹æå‡0.56%ã€‚
<h5 data-id="heading-20">4.3 å¤šåœºæ™¯ä¸‹ç‰¹å¾å¦‚ä½•å¯¹é½ï¼Ÿ</h5>
<p>å¯¹äºé…’åº—ä¸šåŠ¡ä¸‹çš„ç‰¹å¾ï¼Œç‰¹å¾ä¸»è¦åˆ†ä¸º4ç±»ï¼š</p>
<ul>
<li>åœºæ™¯æ— å…³ç‰¹å¾ï¼šå¦‚é…’åº—ä»·æ ¼ã€ç”¨æˆ·ç‚¹å‡»æ¬¡æ•°ã€ä¸‹å•æ¬¡æ•°ç­‰</li>
<li>åœºæ™¯å…±æœ‰ç‰¹å¾ï¼šå¦‚é…’åº—åœ¨poiä¸‹çš„è½¬åŒ–ç‡ã€ç‚¹å‡»ç‡ç­‰ï¼Œæ­¤æ—¶ç‰¹å¾ä¼šå…±ç”¨ä¸€ä¸ªç‰¹å¾ç´¢å¼•</li>
<li>åœºæ™¯ç‹¬æœ‰ç‰¹å¾ï¼šå¦‚åŒåŸç©ºæœä¸‹ç”¨æˆ·è·ç¦»é…’åº—çš„è·ç¦»ï¼Œpoiåœºæ™¯ä¸‹poiè·ç¦»é…’åº—çš„è·ç¦»ç­‰ï¼Œæ­¤æ—¶ï¼Œç‰¹å¾ç´¢å¼•ä¸å…±ç”¨</li>
<li>åœºæ™¯æ ‡è¯†ç‰¹å¾ï¼šä¸»è¦å°±æ˜¯åœºæ™¯ ID ç±»ç‰¹å¾</li>
</ul>
<p>å¦‚ä¸Šæ‰€è¿°ï¼Œè¾“å…¥éƒ¨åˆ†ï¼Œå°†åœºæ™¯çš„domainä¿¡æ¯ä½œä¸ºç‰¹å¾å’Œåœºæ™¯å…±æœ‰ç‰¹å¾ä¸€èµ·æ‹¼æ¥è¾“å…¥åˆ°æ„ŸçŸ¥ç½‘ç»œä¸­ï¼ŒæŠ½å–åœºæ™¯é—´å…±æ€§ä¿¡æ¯ï¼›å°†åœºæ™¯çš„domainä¿¡æ¯ä½œä¸ºç‰¹å¾å’Œåœºæ™¯ç‰¹æœ‰ç‰¹å¾ä¸€èµ·æ‹¼æ¥è¾“å…¥åˆ°æ„ŸçŸ¥ç½‘ç»œä¸­ï¼ŒæŠ½å–åœºæ™¯é—´å·®å¼‚ä¿¡æ¯ï¼›</p>
<p>å¦‚æœç»Ÿä¸€ä½œä¸ºMMOEçš„è¾“å…¥ç›´æ¥è¾“å…¥ï¼Œæ¨¡å‹æ— æ³•å¾ˆå¥½çš„å­¦ä¹ åˆ°ä¸åŒåœºæ™¯çš„å·®å¼‚ï¼Œè‹¥äººä¸ºå…ˆéªŒçš„åˆ†ä¸ºä¸Šè¿°å‡ ç±»ç‰¹å¾ï¼Œæ‹‰å¹³åœºæ™¯ç‰¹å¾ä¹‹é—´çš„å·®å¼‚ã€‚å¯ä»¥ä½¿å¾—æ¨¡å‹åœ¨ä¸€ä¸ªç¨³å®šçš„æ ·æœ¬åˆ†å¸ƒä¸‹å­¦ä¹ ï¼Œå¢å¼ºæ¨¡å‹å¯¹ç”¨æˆ·è·¨åŸŸè¡Œä¸ºçš„åº•å±‚æ„ŸçŸ¥èƒ½åŠ›ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d28ab86b110f4bce87e3ed19d8c457a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=fA7N5%2B6eD21BrF4FennTBtmF0b8%3D" alt="å¾®ä¿¡å›¾ç‰‡_2026-01-14_154104_798.png" loading="lazy"/></p>
<p align="center">å›¾10 å¤šåœºæ™¯å¤šç›®æ ‡ç½‘ç»œç»“æ„</p>
<h5 data-id="heading-21">4.4 å®éªŒè¯„ä¼°</h5>
<ul>
<li>åœ¨v2é˜¶æ®µå¤šåœºæ™¯æ ·æœ¬åˆå¹¶æ—¶ï¼Œndcg@10æŒ‡æ ‡æå‡ä¸å¤§ï¼Œå¤šä¸ªåœºæ™¯ä¸‹çš„æ ·æœ¬èåˆåï¼Œç½‘ç»œçš„å‚æ•°é‡ä¸èƒ½å¾ˆå¥½çš„è¡¨è¾¾å‡ºåœºæ™¯é—´çš„ç‰¹æ€§ã€‚</li>
<li>å› æ­¤ï¼Œå°†ç½‘ç»œä¸“å®¶æ•°æ‰©å¤§åˆ°8ä¸ªï¼Œå¸Œæœ›æ¯ä¸ªä¸“å®¶èƒ½å……åˆ†å­¦ä¹ åˆ°åœºæ™¯é—´å·®å¼‚ï¼Œç¦»çº¿æŒ‡æ ‡ndcg@10ç›¸å¯¹v1æå‡0.19%ï¼Œä¸Šçº¿åï¼Œs2oæŒ‡æ ‡æå‡0.46%ï¼Œå¦å¤–ï¼Œæˆ‘ä»¬åšäº†å…¶ä»–çš„ä¸“å®¶æ•°é‡çš„å®éªŒï¼Œå‘ç°å¢åŠ 9ä¸ªä»¥åï¼ŒndcgæŒ‡æ ‡æ²¡æœ‰ä»€ä¹ˆå˜åŒ–ã€‚</li>
<li>ä¸ºäº†æ›´å¥½çš„å¯¹é½åœºæ™¯çš„ç‰¹å¾å·®å¼‚ï¼Œæˆ‘ä»¬å¯¹è¾“å…¥ç‰¹å¾åˆ†ç±»å»ºæ¨¡è¾“å…¥MMOEï¼ˆv4ï¼‰ã€‚æ­¤æ—¶ï¼Œç¦»çº¿æŒ‡æ ‡ndcg@10ç›¸å¯¹æå‡0.22%ï¼Œä¸Šçº¿åï¼Œs2oæŒ‡æ ‡æå‡0.51%ã€‚</li>
</ul>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/26887a13085a47f6a05120a1c194a068~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=941VOboOfo8q4E3QLFF%2FD%2F8aABY%3D" alt="f523e796169819e3bd5fd590008d0956.png" loading="lazy"/></p>
<h4 data-id="heading-22">5. ç‰¹å¾é€‰æ‹©</h4>
<h5 data-id="heading-23">5.1 ä¸ºä»€ä¹ˆéœ€è¦åšç‰¹å¾é€‰æ‹©ï¼Ÿ</h5>
<p>éšç€Qunaré…’åº—æ’åºæ¨¡å‹ä¸šåŠ¡éœ€æ±‚çš„è¿­ä»£ï¼Œè¶Šæ¥è¶Šå¤šçš„ç‰¹å¾è¢«å¼•å…¥æ¨¡å‹ä¸­ï¼Œå¯¼è‡´å‡ºç°å¦‚ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>å†—ä½™ç‰¹å¾å¢å¤š
<ul>
<li>æœ‰äº›ç‰¹å¾å¯èƒ½ä¸å½“ä¸‹çš„é—®é¢˜æ— å…³ã€‚è¿™æ„å‘³ç€å®ƒä»¬ä¸æ¨¡å‹è¦è§£å†³çš„ä»»åŠ¡å®Œå…¨æ— å…³ï¼Œä¸¢å¼ƒä¸ç›¸å…³çš„ç‰¹å¾å¯ä»¥é˜²æ­¢æ¨¡å‹å¾—åˆ°æ— å…³ç‰¹å¾ä¸Šå¯èƒ½æºå¸¦çš„è™šå‡ç›¸å…³æ€§ï¼Œä»è€Œé¿å…è¿‡æ‹Ÿåˆã€‚</li>
</ul>
</li>
<li>ç»´åº¦ç¾éš¾
<ul>
<li>ç‰¹å¾é€‰æ‹©æŠ€æœ¯åœ¨å…·æœ‰è®¸å¤šç‰¹å¾ä½†è®­ç»ƒç¤ºä¾‹å¾ˆå°‘çš„åœºæ™¯ä¸­å°¤ä¸ºé‡è¦ã€‚è¿™ç§æƒ…å†µå—åˆ°æ‰€è°“çš„ç»´åº¦ç¾éš¾çš„å½±å“ï¼šåœ¨é«˜ç»´ç©ºé—´ä¸­ï¼Œæ¯ä¸ªè®­ç»ƒç¤ºä¾‹éƒ½ä¸å…¶ä»–æ‰€æœ‰ç¤ºä¾‹ç›¸è·ç”šè¿œï¼Œå› æ­¤æ¨¡å‹æ— æ³•å­¦ä¹ ä»»ä½•æœ‰ç”¨çš„æ¨¡å¼ã€‚</li>
</ul>
</li>
<li>è®­ç»ƒæ—¶é—´é•¿
<ul>
<li>ç‰¹å¾è¶Šå¤šï¼Œè®­ç»ƒæ—¶é—´å°±è¶Šé•¿ã€‚è¿™ç§æƒè¡¡çš„å…·ä½“ç»†èŠ‚å–å†³äºæ‰€ä½¿ç”¨çš„ç‰¹å®šå­¦ä¹ ç®—æ³•ï¼Œä½†åœ¨éœ€è¦å®æ—¶è¿›è¡Œå†è®­ç»ƒçš„æƒ…å†µä¸‹ï¼Œå¯èƒ½éœ€è¦é™åˆ¶åœ¨å‡ ä¸ªæœ€ä½³ç‰¹å¾ä¸­è¿›è¡Œã€‚</li>
</ul>
</li>
<li>éƒ¨ç½²å·¥ä½œæˆæœ¬é«˜
<ul>
<li>ç‰¹å¾è¶Šå¤šï¼Œæœºå™¨å­¦ä¹ ç³»ç»Ÿåœ¨ç”Ÿäº§ä¸­å°±è¶Šå¤æ‚ã€‚è¿™ä¼šå¸¦æ¥å¤šç§é£é™©ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºé«˜ç»´æŠ¤å·¥ä½œé‡ã€çº çº·ã€æœªç”³æŠ¥çš„ä½¿ç”¨è€…æˆ–çº æ­£çº§è”ã€‚</li>
</ul>
</li>
<li>å¯è§£é‡Šæ€§å·®
<ul>
<li>ç”±äºç‰¹å¾å¤ªå¤šï¼Œæˆ‘ä»¬å¤±å»äº†æ¨¡å‹çš„å¯è§£é‡Šæ€§ã€‚è™½ç„¶å¯¹æ¨¡å‹ç»“æœçš„è§£é‡Šå¹¶ä¸æ€»æ˜¯ä¸»è¦çš„å»ºæ¨¡ç›®æ ‡ï¼Œä½†é€šå¸¸å¾ˆé‡è¦ï¼Œåœ¨æŸäº›å—ç›‘ç®¡çš„é¢†åŸŸï¼Œç”šè‡³å¯èƒ½æ˜¯æ³•å¾‹è¦æ±‚ã€‚</li>
</ul>
</li>
</ul>
<h5 data-id="heading-24">5.2 ä¼ ç»Ÿç‰¹å¾é€‰æ‹©æ–¹æ³•</h5>
<ul>
<li>æ— ç›‘ç£çš„ç‰¹å¾é€‰æ‹©æ–¹æ³•</li>
<li>åŒ…è£…å™¨ç‰¹å¾é€‰æ‹©æ–¹æ³•</li>
<li>è¿‡æ»¤å™¨ç‰¹å¾é€‰æ‹©æ–¹æ³•</li>
<li>Borutaï¼ˆå¸ƒå°”å¡”ï¼‰æ–¹æ³•</li>
</ul>
<p>ä¸Šè¿°ä¼ ç»Ÿæ–¹æ³•æ›´é€‚åˆæ•°é‡å°ï¼Œè®­ç»ƒæ—¶é—´çŸ­ï¼Œæ¨¡å‹ç®€å•çš„åœºæ™¯ã€‚è€Œæˆ‘ä»¬æ·±åº¦æ¨¡å‹é‡‡ç”¨äº†åŸºäºdropout çš„ç‰¹å¾é€‰æ‹©ï¼Œå€Ÿé‰´äº†è®ºæ–‡Dropout Feature Ranking for Deep Learning Models çš„å·¥ä½œã€‚</p>
<h5 data-id="heading-25">5.3 ä½¿ç”¨å˜åˆ†dropoutæ¥åšç‰¹å¾çš„æ’åº</h5>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd6610248cf4492aaed4e594ac015450~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=tWSu32VhRWdNZJtv0mnYD9BfZ38%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾11 dropoutçš„è®­ç»ƒå‰åçš„ä¸¢å¼ƒæ¦‚ç‡ç¤ºæ„å›¾</p>
<p>åŸºäºä¸¤é˜¶æ®µï¼Œç¬¬ä¸€é˜¶æ®µéœ€è¦å…ˆè®­ç»ƒä¸€ä¸ªpretrained Model è¿™æ ·å…ˆå­¦ä¹ æ¨¡å‹çš„å‚æ•°ï¼Œç¬¬äºŒé˜¶æ®µå›ºå®šæ¨¡å‹å‚æ•°ä¸åšæ¢¯åº¦æ›´æ–°ï¼Œå¯¹è¾“å…¥çš„ç‰¹å¾å¢åŠ ä¸€ä¸ªdropoutä¸¢å¼ƒå˜é‡ï¼ˆå¯å¯¼ï¼‰ä¸è¾“å…¥ç‰¹å¾å…ƒç´ ç›¸ä¹˜ï¼Œè¿™ä¸ªé˜¶æ®µçš„ä¸»è¦ç›®çš„æ˜¯ä¼˜åŒ–è¯¥dropoutä¸¢å¼ƒæ¦‚ç‡ã€‚</p>
<p>å¦‚å›¾11æ‰€ç¤ºï¼Œè®ºæ–‡æå‡ºäº†Dropout Feature Rankingæ–¹æ³•ï¼Œåœ¨è®­ç»ƒå®Œåï¼Œå¯ä»¥è·å–åˆ°æ¯ä¸ªç‰¹å¾çš„é‡è¦åº¦ã€‚</p>
<p>æœ¬è´¨çš„æ€æƒ³æ˜¯å°†ä¸å¯å¯¼çš„ç¦»æ•£å˜é‡dropoutï¼Œé‡‡ç”¨Concrete relaxationæ“ä½œï¼Œå¯¹ç¬¦åˆä¼¯åŠªåˆ©åˆ†å¸ƒçš„ç¦»æ•£å˜é‡è¿‘ä¼¼ä¼°è®¡ä¸ºä¸€ä¸ªè¿ç»­å¯å¯¼å˜é‡ã€‚æ¾å¼›ä¸ºè¿ç»­æ€§çš„å™ªå£°æ‰°åŠ¨è¿‡ç¨‹ï¼Œä½¿å…¶å¯ä»¥è¿›è¡Œæ¢¯åº¦æ›´æ–°ã€‚å¹¶å¯¹1-dropout_rateæ·»åŠ æ­£åˆ™ï¼Œä½¿å…¶åœ¨è®­ç»ƒä¸­å°½å¯èƒ½æœ€å°åŒ–ã€‚å›¾12 ä¸­çš„på°±æ˜¯ç‰¹å¾çš„ä¸¢å¼ƒæ¦‚ç‡ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/81b817f69e9042f1be01342919c68fe8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=3NG00dQ5uG1A4WOXDhwkHjT3jxo%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾12 dropout layerå±‚</p>
<p>è¿™ç§æ–¹æ¡ˆçš„ä¼˜ç‚¹ï¼š</p>
<ul>
<li>é€šç”¨æ€§é«˜ï¼šå¯ä»¥åº”ç”¨äºä»»ä½•æ·±åº¦å­¦ä¹ æ¨¡å‹</li>
<li>ç®€å•æ–¹ä¾¿ï¼šåœ¨è®­ç»ƒå¥½çš„æ¨¡å‹åªè¿›è¡Œä¸€æ¬¡dropoutå‚æ•°è®­ç»ƒå³å¯å¾—å‡ºç‰¹å¾é‡è¦æ€§æ’åºï¼Œæ— éœ€è¿›è¡Œå¤šæ¬¡å®éªŒæ¥å‰”é™¤ç‰¹å¾</li>
<li>æ•ˆæœå¯é ï¼šè¯¥æ–¹æ³•åœ¨å®é™…ä¸šåŠ¡åº”ç”¨ä¸­å±•ç°å‡ºäº†å‡ºè‰²çš„ç‰¹å¾ç­›é€‰æ•ˆæœã€‚</li>
</ul>
<h5 data-id="heading-26">å®éªŒæ•ˆæœï¼š</h5>
<p>1ã€ä¸ºäº†éªŒè¯æ— æ•ˆç‰¹å¾ä¼šå½±å“æ¨¡å‹çš„æ•ˆæœï¼Œæˆ‘ä»¬åœ¨æ¨¡å‹çš„åŸç‰¹å¾åŸºç¡€ä¸Šå¢åŠ äº†10ä¸ªéšæœºç”Ÿæˆçš„å™ªå£°ç”Ÿæˆå™ªå£°ç‰¹å¾ï¼ˆåœ¨æŸäº›ç‰¹å¾ä¸Šæ·»åŠ å‡åŒ€åˆ†å¸ƒå™ªå£°ã€é«˜æ–¯åˆ†å¸ƒå™ªå£°ç­‰ï¼‰</p>
<p>2ã€åŠ ä¸ŠDFRå±‚åï¼Œåˆ å‡äº†14ç»´ç‰¹å¾åï¼Œæ¨¡å‹æ•ˆæœä¸ä½†æ²¡æœ‰ä¸‹é™ï¼Œåè€Œæœ‰å¾®å¼±çš„æå‡ã€‚åˆ é™¤ç‰¹å¾é‡æ–°è®­ç»ƒæ¨¡å‹ï¼Œçº¿ä¸Šè½¬åŒ–ç‡æå‡0.2%ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94ac2afe054b45b690a6a39c3907ef33~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=LbydBDARjkm5MJjZffdDZ%2F2yzCg%3D" alt="4cbe3a5269eb4687a95e6edaaaa684d3.png" loading="lazy"/></p>
<p>3ã€ä½¿ç”¨DFRç®—æ³•åï¼Œç‰¹å¾é‡è¦æ€§å¦‚ä¸‹ï¼š</p>
<ul>
<li>åŸºæœ¬ä¸Šæ˜¯å®æ—¶ç‰¹å¾æ›´é‡è¦</li>
<li>æˆ‘ä»¬å°†ä½äºå¯¹ç…§ç‰¹å¾ï¼ˆé«˜æ–¯å™ªå£°ï¼‰é‡è¦åº¦åˆ†çš„ç‰¹å¾åˆ é™¤ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸€äº›å†—ä½™ç‰¹å¾ã€‚</li>
</ul>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df6bad579cdc49b9b72d422a46eabd1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=zLYMWwRJjzNyKUsDuWfq9KcujpQ%3D" alt="973e23cd3794b64133c5763dbd144d8d.png" loading="lazy"/></p>
<h2 data-id="heading-27">äº”ã€é˜¶æ®µæ€»ç»“å’Œæœªæ¥è§„åˆ’</h2>
<p>æœ¬æ–‡ä¸»è¦ä»‹ç»Qunaråœ¨é…’åº—æœç´¢ç²¾æ’æ¨¡å‹ä¸Šçš„æ¼”è¿›å®è·µï¼Œä»å®éªŒæ•ˆæœæ¥çœ‹ï¼Œè¯æ˜äº†æ·±åº¦æ¨¡å‹åœ¨é…’åº—æœç´¢æ’åºçš„æœ‰æ•ˆæ€§ï¼Œä»¥åŠåˆç†å¼•å…¥å¤šåœºæ™¯ç‰¹å¾é—´çš„å·®å¼‚å»ºæ¨¡å¯ä»¥è®©æ¨¡å‹æ›´å¥½çš„ç†è§£æ•°æ®ã€‚</p>
<p>å¯¹äºæ¥ä¸‹æ¥çš„æ·±åº¦æ¨¡å‹ä¼˜åŒ–ï¼šå€Ÿé‰´listwiseçš„å»ºæ¨¡æ–¹å¼ï¼Œå°†pointwise losså’Œlistwise lossèåˆï¼Œæ—¢å¯ä»¥å­¦ä¹ æ’åºï¼Œåˆå¯ä»¥å­¦ä¹ åˆ¤åˆ«åˆ†ç±»ã€‚</p>
<p>[1]Chris J.C. Burges. 2010. From RankNet to LambdaRank to LambdaMART: An Overview. Technical Report. <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.microsoft.com%2Fen-us%2Fresearch%2Fpublication%2Ffrom-ranknet-to-lambdarank-to-lambdamart-an-overview%2F" target="_blank" title="https://www.microsoft.com/en-us/research/publication/from-ranknet-to-lambdarank-to-lambdamart-an-overview/" ref="nofollow noopener noreferrer">www.microsoft.com/en-us/reseaâ€¦</a></p>
<p>[2] Rama Kumar Pasumarthi, Sebastian Bruch, Xuanhui Wang, Cheng Li, Michael Bendersky, Marc Najork, Jan Pfeifer, Nadav Golbandi, Rohan Anil, Stephan Wolf.</p>
<p>TF-Ranking: Scalable TensorFlow Library for Learning-to-Rank.KDD 2019.</p>
<p>[3] Haldar M, Abdool M, Ramanathan P, et al. Applying deep learning to airbnb search[C]//Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining. 2019: 1927-1935.</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaåŒäº²å§”æ´¾æ¨¡å‹å·¥ä½œåŸç†]]></title>    <link>https://juejin.cn/post/7595472747455676431</link>    <guid>https://juejin.cn/post/7595472747455676431</guid>    <pubDate>2026-01-16T01:51:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595472747455676431" data-draft-id="7595400254348378127" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaåŒäº²å§”æ´¾æ¨¡å‹å·¥ä½œåŸç†"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-16T01:51:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ITæ©˜å­çš®"/> <meta itemprop="url" content="https://juejin.cn/user/3148645291002232"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaåŒäº²å§”æ´¾æ¨¡å‹å·¥ä½œåŸç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3148645291002232/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ITæ©˜å­çš®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T01:51:41.000Z" title="Fri Jan 16 2026 01:51:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    18
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€åŒäº²å§”æ´¾æ¨¡å‹çš„æ ¸å¿ƒæœºåˆ¶</h2>
<h3 data-id="heading-1">1.1 ç±»åŠ è½½å™¨çš„å±‚çº§ç»“æ„</h3>
<p>Javaç±»åŠ è½½å™¨é‡‡ç”¨<strong>æ ‘å½¢å±‚çº§ç»“æ„</strong>ï¼ŒåŒ…å«ä¸‰ç±»æ ¸å¿ƒåŠ è½½å™¨ï¼š</p>
<ul>
<li><strong>Bootstrap ClassLoaderï¼ˆå¯åŠ¨ç±»åŠ è½½å™¨ï¼‰</strong> ï¼šç”±C++å®ç°ï¼Œè´Ÿè´£åŠ è½½JVMæ ¸å¿ƒç±»åº“ï¼ˆå¦‚<code>java.lang.*</code>ï¼‰ï¼Œä½äº<code>&lt;JAVA_HOME&gt;/lib</code>ç›®å½•ã€‚</li>
<li><strong>Extension ClassLoaderï¼ˆæ‰©å±•ç±»åŠ è½½å™¨ï¼‰</strong> ï¼šåŠ è½½<code>&lt;JAVA_HOME&gt;/lib/ext</code>ç›®å½•æˆ–<code>java.ext.dirs</code>æŒ‡å®šçš„æ‰©å±•ç±»ã€‚</li>
<li><strong>Application ClassLoaderï¼ˆåº”ç”¨ç±»åŠ è½½å™¨ï¼‰</strong> ï¼šé»˜è®¤åŠ è½½ç”¨æˆ·ç±»è·¯å¾„ï¼ˆClasspathï¼‰ä¸Šçš„ç±»ï¼Œæ˜¯è‡ªå®šä¹‰ç±»åŠ è½½å™¨çš„çˆ¶åŠ è½½å™¨ã€‚</li>
</ul>
<p>ä¸‰è€…é€šè¿‡ç»„åˆå…³ç³»å½¢æˆå±‚çº§ï¼Œè€Œéç»§æ‰¿ã€‚</p>
<h3 data-id="heading-2">1.2 åŒäº²å§”æ´¾çš„å·¥ä½œæµç¨‹</h3>
<p>å½“ç±»åŠ è½½å™¨æ”¶åˆ°åŠ è½½è¯·æ±‚æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li><strong>æ£€æŸ¥ç¼“å­˜</strong>ï¼šè‹¥å½“å‰åŠ è½½å™¨å·²åŠ è½½è¯¥ç±»ï¼Œç›´æ¥è¿”å›ã€‚</li>
<li><strong>å§”æ´¾çˆ¶åŠ è½½å™¨</strong>ï¼šé€’å½’è¯·æ±‚çˆ¶åŠ è½½å™¨åŠ è½½ï¼ˆç›´è‡³Bootstrapï¼‰ã€‚</li>
<li><strong>çˆ¶åŠ è½½å¤±è´¥åè‡ªåŠ è½½</strong>ï¼šè‹¥çˆ¶åŠ è½½å™¨æ— æ³•åŠ è½½ï¼Œå½“å‰åŠ è½½å™¨è°ƒç”¨<code>findClass()</code>æ–¹æ³•åŠ è½½ã€‚</li>
</ol>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// ClassLoaderæºç æ ¸å¿ƒé€»è¾‘ï¼ˆç®€åŒ–ï¼‰</span>
protected Class&lt;?&gt; <span class="hljs-built_in">loadClass</span>(String name, boolean resolve) {
    synchronized (getClassLoadingLock(name)) {
        Class&lt;?&gt; c = <span class="hljs-built_in">findLoadedClass</span>(name);
        if (c == null) {
            try {
                if (parent != null) {
                    c = parent<span class="hljs-selector-class">.loadClass</span>(name, false); <span class="hljs-comment">// å§”æ´¾çˆ¶åŠ è½½å™¨</span>
                } else {
                    c = <span class="hljs-built_in">findBootstrapClassOrNull</span>(name); <span class="hljs-comment">// BootstrapåŠ è½½</span>
                }
            } catch (ClassNotFoundException ignored) {}
            if (c == null) {
                c = <span class="hljs-built_in">findClass</span>(name); <span class="hljs-comment">// è‡ªåŠ è½½</span>
            }
        }
        if (resolve) <span class="hljs-built_in">resolveClass</span>(c);
        return c;
    }
}
</code></pre>
<p>æ­¤æµç¨‹ç¡®ä¿<strong>ç±»åŠ è½½è¯·æ±‚æœ€ç»ˆç”±æœ€é¡¶å±‚çš„Bootstrapå°è¯•å¤„ç†</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-3">äºŒã€åŒäº²å§”æ´¾çš„æ ¸å¿ƒä¼˜åŠ¿</h2>
<h3 data-id="heading-4">2.1 å®‰å…¨æ€§ä¿éšœ</h3>
<ul>
<li><strong>æ ¸å¿ƒç±»åº“ä¿æŠ¤</strong>ï¼šç”¨æˆ·è‡ªå®šä¹‰çš„<code>java.lang.String</code>ç­‰ç±»ä¼šè¢«BootstrapåŠ è½½å™¨æ‹¦æˆªï¼Œé¿å…ç¯¡æ”¹æ ¸å¿ƒAPIã€‚</li>
<li><strong>æ²™ç®±éš”ç¦»</strong>ï¼šæ¶æ„ä»£ç æ— æ³•é€šè¿‡è¦†ç›–æ ¸å¿ƒç±»å®ç°æ”»å‡»ã€‚</li>
</ul>
<h3 data-id="heading-5">2.2 å”¯ä¸€æ€§ä¸ç¨³å®šæ€§</h3>
<ul>
<li><strong>ç±»å”¯ä¸€æ€§</strong>ï¼šç±»ç”±<strong>å…¨é™å®šå+åŠ è½½å™¨å®ä¾‹</strong>å…±åŒæ ‡è¯†ï¼Œé¿å…é‡å¤åŠ è½½ã€‚</li>
<li><strong>èµ„æºä¸€è‡´æ€§</strong>ï¼šç¡®ä¿<code>System.getProperty("java.version")</code>ç­‰å…¨å±€èµ„æºåŠ è½½ä¸€è‡´æ€§ã€‚</li>
</ul>
<h3 data-id="heading-6">2.3 æ€§èƒ½ä¼˜åŒ–</h3>
<ul>
<li>å‡å°‘é‡å¤ç±»åŠ è½½çš„å¼€é”€ï¼Œå°¤å…¶å¯¹é¢‘ç¹ä½¿ç”¨çš„ç±»ï¼ˆå¦‚é›†åˆæ¡†æ¶ï¼‰æ•ˆæœæ˜¾è‘—ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-7">ä¸‰ã€ç ´ååŒäº²å§”æ´¾çš„å…¸å‹åœºæ™¯</h2>
<h3 data-id="heading-8">3.1 SPIæœºåˆ¶ï¼ˆæœåŠ¡æä¾›æ¥å£ï¼‰</h3>
<ul>
<li>
<p><strong>é—®é¢˜</strong>ï¼š<code>java.sql.Driver</code>ç”±BootstrapåŠ è½½ï¼Œä½†å…·ä½“å®ç°ï¼ˆå¦‚MySQLé©±åŠ¨ï¼‰éœ€ç”±åº”ç”¨ç±»åŠ è½½å™¨åŠ è½½ã€‚</p>
</li>
<li>
<p><strong>å®ç°</strong>ï¼šé€šè¿‡<code>Thread.currentThread().getContextClassLoader()</code>è·å–ä¸Šä¸‹æ–‡åŠ è½½å™¨ï¼Œæ‰“ç ´å§”æ´¾é“¾ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">// JDBCé©±åŠ¨åŠ è½½ç¤ºä¾‹
ServiceLoader&lt;Driver&gt; <span class="hljs-attr">loader</span> = ServiceLoader.load(Driver.class, Thread.currentThread().getContextClassLoader())<span class="hljs-comment">;</span>
</code></pre>
</li>
</ul>
<h3 data-id="heading-9">3.2 åº”ç”¨æœåŠ¡å™¨çƒ­éƒ¨ç½²</h3>
<ul>
<li>
<p><strong>Tomcatçš„WebappClassLoader</strong>ï¼šä¼˜å…ˆä»<code>WEB-INF/lib</code>åŠ è½½ç±»ï¼Œè€Œéå§”æ´¾ç»™çˆ¶åŠ è½½å™¨ï¼Œå®ç°Webåº”ç”¨éš”ç¦»ã€‚</p>
</li>
<li>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// Tomcatç±»åŠ è½½é€»è¾‘ï¼ˆç®€åŒ–ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-title class_">Class</span>&lt;?&gt; <span class="hljs-title function_">loadClass</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> name</span>) {
    <span class="hljs-keyword">if</span> (name.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"com.example.app"</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">findClass</span>(name); <span class="hljs-comment">// è‡ªä¼˜å…ˆåŠ è½½</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">loadClass</span>(name);
}
</code></pre>
</li>
</ul>
<h3 data-id="heading-10">3.3 æ¨¡å—åŒ–æ¡†æ¶ï¼ˆOSGiï¼‰</h3>
<ul>
<li><strong>åŠ¨æ€æ¨¡å—åŠ è½½</strong>ï¼šæ¯ä¸ªBundleæ‹¥æœ‰ç‹¬ç«‹ç±»åŠ è½½å™¨ï¼Œæ”¯æŒçƒ­æ’æ‹”ã€‚</li>
<li><strong>é€‰æ‹©æ€§å§”æ´¾</strong>ï¼šä»…å¯¹<code>java.*</code>ç­‰æ ¸å¿ƒåŒ…å§”æ´¾ï¼Œå…¶ä»–åŒ…ç”±è‡ªèº«åŠ è½½ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-11">å››ã€ç ´ååŒäº²å§”æ´¾çš„åæœä¸é£é™©</h2>
<h3 data-id="heading-12">4.1 ç±»é‡å¤åŠ è½½ä¸ç±»å‹å†²çª</h3>
<ul>
<li>
<p><strong>é—®é¢˜</strong>ï¼šä¸åŒåŠ è½½å™¨åŠ è½½åŒåç±»ï¼ˆå¦‚<code>com.user.User</code>ï¼‰ï¼Œå¯¼è‡´<code>ClassCastException</code>ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">// ç¤ºä¾‹ï¼šä¸¤ä¸ªWebåº”ç”¨åŠ è½½ä¸åŒç‰ˆæœ¬çš„Log4j
ClassLoader <span class="hljs-attr">loader1</span> = app1.getClassLoader()<span class="hljs-comment">;</span>
ClassLoader <span class="hljs-attr">loader2</span> = app2.getClassLoader()<span class="hljs-comment">;</span>
Class&lt;?&gt; <span class="hljs-attr">log4j1</span> = loader1.loadClass(<span class="hljs-string">"org.apache.log4j.Logger"</span>)<span class="hljs-comment">;</span>
Class&lt;?&gt; <span class="hljs-attr">log4j2</span> = loader2.loadClass(<span class="hljs-string">"org.apache.log4j.Logger"</span>)<span class="hljs-comment">;</span>
// log4j1 != log4j2ï¼Œç±»å‹ä¸å…¼å®¹
</code></pre>
</li>
</ul>
<h3 data-id="heading-13">4.2 æ ¸å¿ƒç±»åº“ç¯¡æ”¹é£é™©</h3>
<ul>
<li><strong>æ¶æ„ä»£ç æ³¨å…¥</strong>ï¼šè‹¥ç»•è¿‡åŒäº²å§”æ´¾åŠ è½½ä¼ªé€ çš„<code>java.lang.Runtime</code>ï¼Œå¯èƒ½æ‰§è¡Œå±é™©æ“ä½œã€‚</li>
</ul>
<h3 data-id="heading-14">4.3 å†…å­˜æ³„æ¼ä¸ç±»å¸è½½å¤±è´¥</h3>
<ul>
<li><strong>ç±»åŠ è½½å™¨æ³„æ¼</strong>ï¼šè‡ªå®šä¹‰åŠ è½½å™¨æŒæœ‰é™æ€å¼•ç”¨ï¼ˆå¦‚ç¼“å­˜ï¼‰ï¼Œå¯¼è‡´å…¶æ— æ³•è¢«GCå›æ”¶ï¼Œè¿å¸¦ç±»ä¹Ÿæ— æ³•å¸è½½ã€‚</li>
<li><strong>å…ƒç©ºé—´OOM</strong>ï¼šé¢‘ç¹åŠ è½½/å¸è½½ç±»å¯¼è‡´å…ƒç©ºé—´è†¨èƒ€ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-15">äº”ã€æœ€ä½³å®è·µä¸è°ƒä¼˜å»ºè®®</h2>
<h3 data-id="heading-16">5.1 è°¨æ…æ‰“ç ´åŒäº²å§”æ´¾</h3>
<ul>
<li><strong>é™å®šèŒƒå›´</strong>ï¼šä»…åœ¨å¿…è¦æ—¶ï¼ˆå¦‚SPIã€çƒ­éƒ¨ç½²ï¼‰å±€éƒ¨æ‰“ç ´ï¼Œé¿å…å…¨å±€ç ´åã€‚</li>
<li><strong>éš”ç¦»ç­–ç•¥</strong>ï¼šä½¿ç”¨ç‹¬ç«‹ç±»åŠ è½½å™¨åŠ è½½é«˜é£é™©ä»£ç ï¼Œå¹¶é™åˆ¶å…¶æƒé™ã€‚</li>
</ul>
<h3 data-id="heading-17">5.2 ç±»åŠ è½½å™¨ç®¡ç†</h3>
<ul>
<li>
<p><strong>å¼±å¼•ç”¨ç¼“å­˜</strong>ï¼šå¯¹<code>Class</code>å¯¹è±¡ä½¿ç”¨<code>WeakReference</code>ï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-built_in">WeakReference</span>&lt;Class<span class="hljs-meta">&lt;?</span>&gt;&gt; clazzRef = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakReference</span>&lt;&gt;(MyClass.<span class="hljs-keyword">class</span>);
</code></pre>
</li>
<li>
<p><strong>æ¸…ç†æœºåˆ¶</strong>ï¼šåœ¨Webåº”ç”¨åœæ­¢æ—¶ï¼Œæ˜¾å¼å¸è½½ç±»åŠ è½½å™¨å¹¶é‡Šæ”¾èµ„æºã€‚</p>
</li>
</ul>
<h3 data-id="heading-18">5.3 ç›‘æ§ä¸è°ƒè¯•</h3>
<ul>
<li>
<p><strong>JVMå‚æ•°</strong>ï¼š</p>
<ul>
<li><code>-verbose:class</code>ï¼šè·Ÿè¸ªç±»åŠ è½½è¿‡ç¨‹ã€‚</li>
<li><code>-XX:+TraceClassLoading</code>ï¼šè¾“å‡ºè¯¦ç»†åŠ è½½æ—¥å¿—ã€‚</li>
</ul>
</li>
<li>
<p><strong>å·¥å…·åˆ†æ</strong>ï¼šä½¿ç”¨JConsoleã€VisualVMç›‘æ§ç±»åŠ è½½å™¨çŠ¶æ€ã€‚</p>
</li>
</ul>
<hr/>
<h2 data-id="heading-19">å…­ã€æ€»ç»“</h2>
<p>åŒäº²å§”æ´¾æ¨¡å‹é€šè¿‡<strong>å±‚çº§å§”æ´¾ã€å”¯ä¸€æ€§ä¿éšœ</strong>å’Œ<strong>å®‰å…¨éš”ç¦»</strong>ï¼Œæˆä¸ºJavaç±»åŠ è½½æœºåˆ¶çš„åŸºçŸ³ã€‚å°½ç®¡åœ¨SPIã€çƒ­éƒ¨ç½²ç­‰åœºæ™¯ä¸­éœ€çµæ´»æ‰“ç ´è¯¥æ¨¡å‹ï¼Œä½†å¼€å‘è€…éœ€æ·±åˆ»ç†è§£å…¶é£é™©ï¼Œé€šè¿‡<strong>éš”ç¦»åŠ è½½ã€ä¸¥æ ¼èµ„æºç®¡ç†</strong>å’Œ<strong>ç›‘æ§è°ƒä¼˜</strong>è§„é¿æ½œåœ¨é—®é¢˜ã€‚æœªæ¥ï¼Œéšç€æ¨¡å—åŒ–ç³»ç»Ÿï¼ˆå¦‚Project Jigsawï¼‰çš„æ™®åŠï¼Œç±»åŠ è½½æœºåˆ¶å°†æ›´è¶‹ç²¾ç»†åŒ–ï¼Œä½†åŒäº²å§”æ´¾çš„æ ¸å¿ƒæ€æƒ³ä»å°†å»¶ç»­ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Reactä»å…¥é—¨åˆ°å‡ºé—¨ç¬¬ä¹ç«  èµ„æºåŠ è½½æ–°ç‰¹æ€§Suspense åŸç”Ÿåè°ƒåŸç†ä¸å®æˆ˜]]></title>    <link>https://juejin.cn/post/7595478717985243145</link>    <guid>https://juejin.cn/post/7595478717985243145</guid>    <pubDate>2026-01-16T01:22:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595478717985243145" data-draft-id="7590309337861570601" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Reactä»å…¥é—¨åˆ°å‡ºé—¨ç¬¬ä¹ç«  èµ„æºåŠ è½½æ–°ç‰¹æ€§Suspense åŸç”Ÿåè°ƒåŸç†ä¸å®æˆ˜"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯æ¡†æ¶,React.js"/> <meta itemprop="datePublished" content="2026-01-16T01:22:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ€•æµªçŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/2832784963939438"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Reactä»å…¥é—¨åˆ°å‡ºé—¨ç¬¬ä¹ç«  èµ„æºåŠ è½½æ–°ç‰¹æ€§Suspense åŸç”Ÿåè°ƒåŸç†ä¸å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2832784963939438/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ€•æµªçŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T01:22:30.000Z" title="Fri Jan 16 2026 01:22:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï½ æåˆ° React çš„ Suspenseï¼Œå¾ˆå¤šå¼€å‘è€…çš„ç¬¬ä¸€å°è±¡æ˜¯â€œç”¨æ¥åšä»£ç åˆ†å‰²â€æˆ–â€œé…åˆ lazy åŠ è½½ç»„ä»¶â€ã€‚ä½†åœ¨ React 19 ä¹‹å‰ï¼ŒSuspense åœ¨èµ„æºåŠ è½½åœºæ™¯ä¸‹å§‹ç»ˆæœ‰ä¸ªè‡´å‘½çŸ­æ¿ï¼šæ— æ³•åŸç”Ÿåè°ƒå¤šä¸ªå¼‚æ­¥èµ„æºçš„åŠ è½½çŠ¶æ€ï¼Œå¯¼è‡´æˆ‘ä»¬éœ€è¦å†™å¤§é‡æ¨¡æ¿ä»£ç å¤„ç†â€œå¤šèµ„æºå¹¶è¡ŒåŠ è½½â€â€œä¾èµ–èµ„æºä¸²è¡ŒåŠ è½½â€ç­‰åœºæ™¯ã€‚</p>
<p>React 19 å½»åº•è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œæ¨å‡ºäº† <strong>Suspense åŸç”Ÿåè°ƒ</strong> ç‰¹æ€§ï¼Œè®©å¤šèµ„æºåŠ è½½çš„çŠ¶æ€ç®¡ç†å˜å¾—æç®€ã€‚ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°±ä»â€œæ—§ç‰ˆ Suspense çš„ç—›ç‚¹â€å‡ºå‘ï¼Œä¸€æ­¥æ­¥æ‹†è§£ React 19 åŸç”Ÿåè°ƒçš„æ ¸å¿ƒåŸç†ï¼Œå†é€šè¿‡ 4 ä¸ªé«˜é¢‘å®æˆ˜æ¡ˆä¾‹ï¼Œå¸¦ä½ å½»åº•æŒæ¡è¿™ä¸ªæ–°ç‰¹æ€§çš„ç”¨æ³•ï¼Œè®©èµ„æºåŠ è½½é€»è¾‘æ›´æ¸…æ™°ã€ä»£ç æ›´ç®€æ´ï½</p>
<h2 data-id="heading-0">ä¸€ã€å…ˆå›é¡¾ï¼šæ—§ç‰ˆ Suspense çš„èµ„æºåŠ è½½ç—›ç‚¹</h2>
<p>åœ¨ React 19 ä¹‹å‰ï¼ŒSuspense è™½ç„¶èƒ½å¤„ç†å•ä¸ªå¼‚æ­¥èµ„æºçš„â€œåŠ è½½ä¸­ fallbackâ€ï¼Œä½†é¢å¯¹å¤šèµ„æºåŠ è½½åœºæ™¯æ—¶ï¼Œå°±æ˜¾å¾—åŠ›ä¸ä»å¿ƒäº†ã€‚æˆ‘ä»¬å…ˆé€šè¿‡ä¸¤ä¸ªå¸¸è§åœºæ™¯ï¼Œçœ‹çœ‹æ—§ç‰ˆ Suspense çš„é—®é¢˜æ‰€åœ¨ã€‚</p>
<h3 data-id="heading-1">1. ç—›ç‚¹ 1ï¼šå¤šèµ„æºå¹¶è¡ŒåŠ è½½ï¼Œéœ€æ‰‹åŠ¨ç®¡ç†æ•´ä½“çŠ¶æ€</h3>
<p>å‡è®¾æˆ‘ä»¬éœ€è¦åœ¨é¡µé¢ä¸­åŒæ—¶åŠ è½½â€œç”¨æˆ·ä¿¡æ¯â€å’Œâ€œç”¨æˆ·è®¢å•åˆ—è¡¨â€ä¸¤ä¸ªå¼‚æ­¥èµ„æºï¼Œè¦æ±‚ä¸¤ä¸ªèµ„æºéƒ½åŠ è½½å®Œæˆåå†å±•ç¤ºé¡µé¢ï¼ŒåŠ è½½è¿‡ç¨‹ä¸­æ˜¾ç¤ºç»Ÿä¸€çš„ loadingã€‚åœ¨ React 19 ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ç®¡ç†ä¸¤ä¸ªèµ„æºçš„åŠ è½½çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// React 19 ä¹‹å‰ï¼šå¤šèµ„æºå¹¶è¡ŒåŠ è½½çš„ç¹çå®ç°</span>
<span class="hljs-keyword">import</span> { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// å¼‚æ­¥è¯·æ±‚å‡½æ•°</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchUser</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/user'</span>);
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchOrders</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/orders'</span>);
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserDashboard</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// æ‰‹åŠ¨ç®¡ç†ä¸¤ä¸ªèµ„æºçš„åŠ è½½çŠ¶æ€å’Œç»“æœ</span>
  <span class="hljs-keyword">const</span> [user, setUser] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [orders, setOrders] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">const</span> [error, setError] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">true</span>);
    <span class="hljs-title function_">setError</span>(<span class="hljs-literal">null</span>);

    <span class="hljs-comment">// å¹¶è¡Œè¯·æ±‚ä¸¤ä¸ªèµ„æº</span>
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([<span class="hljs-title function_">fetchUser</span>(), <span class="hljs-title function_">fetchOrders</span>()])
      .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">[userData, ordersData]</span>) =&gt;</span> {
        <span class="hljs-title function_">setUser</span>(userData);
        <span class="hljs-title function_">setOrders</span>(ordersData);
      })
      .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-title function_">setError</span>(err.<span class="hljs-property">message</span>))
      .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">false</span>));
  }, []);

  <span class="hljs-comment">// æ‰‹åŠ¨å¤„ç† loading å’Œ error çŠ¶æ€</span>
  <span class="hljs-keyword">if</span> (loading) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  <span class="hljs-keyword">if</span> (error) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>åŠ è½½å¤±è´¥ï¼š{error}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  <span class="hljs-keyword">if</span> (!user || !orders) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{user.name} çš„ä»ªè¡¨ç›˜<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æˆ‘çš„è®¢å•<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        {orders.map((order) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{order.id}</span>&gt;</span>{order.title} - ï¿¥{order.amount}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p>è¿™ç§å†™æ³•çš„é—®é¢˜å¾ˆæ˜æ˜¾ï¼š<strong>éœ€è¦æ‰‹åŠ¨ç”¨ useState ç®¡ç†å¤šä¸ªèµ„æºçš„çŠ¶æ€ï¼Œç”¨ Promise.all åè°ƒå¹¶è¡Œé€»è¾‘ï¼Œä»£ç æ¨¡æ¿åŒ–ä¸¥é‡</strong>ã€‚å¦‚æœèµ„æºæ•°é‡å¢åŠ åˆ° 3 ä¸ªã€4 ä¸ªï¼ŒçŠ¶æ€ç®¡ç†ä¼šå˜å¾—æ›´åŠ æ··ä¹±ã€‚</p>
<h3 data-id="heading-2">2. ç—›ç‚¹ 2ï¼šä¾èµ–èµ„æºä¸²è¡ŒåŠ è½½ï¼Œé€»è¾‘åµŒå¥—å†—ä½™</h3>
<p>å†çœ‹ä¸€ä¸ªæ›´å¤æ‚çš„åœºæ™¯ï¼šåŠ è½½â€œç”¨æˆ·è®¢å•è¯¦æƒ…â€éœ€è¦å…ˆåŠ è½½â€œç”¨æˆ·ä¿¡æ¯â€ï¼ˆè·å–ç”¨æˆ· IDï¼‰ï¼Œå†æ ¹æ®ç”¨æˆ· ID åŠ è½½â€œè®¢å•åˆ—è¡¨â€ï¼Œæœ€åæ ¹æ®è®¢å• ID åŠ è½½â€œè®¢å•è¯¦æƒ…â€ã€‚è¿™ç§ä¸²è¡Œä¾èµ–çš„åœºæ™¯ï¼Œåœ¨æ—§ç‰ˆ React ä¸­éœ€è¦åµŒå¥—å¤šå±‚ Promiseï¼Œé€»è¾‘ç¹çï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// React 19 ä¹‹å‰ï¼šä¸²è¡Œèµ„æºåŠ è½½çš„åµŒå¥—å®ç°</span>
function <span class="hljs-built_in">OrderDetail</span>() {
  const <span class="hljs-selector-attr">[user, setUser]</span> = <span class="hljs-built_in">useState</span>(null);
  const <span class="hljs-selector-attr">[order, setOrder]</span> = <span class="hljs-built_in">useState</span>(null);
  const <span class="hljs-selector-attr">[detail, setDetail]</span> = <span class="hljs-built_in">useState</span>(null);
  const <span class="hljs-selector-attr">[loading, setLoading]</span> = <span class="hljs-built_in">useState</span>(true);
  const <span class="hljs-selector-attr">[error, setError]</span> = <span class="hljs-built_in">useState</span>(null);

  <span class="hljs-built_in">useEffect</span>(() =&gt; {
    <span class="hljs-built_in">setLoading</span>(true);
    <span class="hljs-built_in">setError</span>(null);

    <span class="hljs-comment">// ä¸²è¡Œè¯·æ±‚ï¼šç”¨æˆ·ä¿¡æ¯ â†’ è®¢å•åˆ—è¡¨ â†’ è®¢å•è¯¦æƒ…</span>
    <span class="hljs-built_in">fetchUser</span>()
      <span class="hljs-selector-class">.then</span>((userData) =&gt; {
        <span class="hljs-built_in">setUser</span>(userData);
        return <span class="hljs-built_in">fetchOrders</span>(userData.id); <span class="hljs-comment">// ä¾èµ–ç”¨æˆ· ID</span>
      })
      <span class="hljs-selector-class">.then</span>((ordersData) =&gt; {
        const firstOrder = ordersData<span class="hljs-selector-attr">[0]</span>;
        <span class="hljs-built_in">setOrder</span>(firstOrder);
        return <span class="hljs-built_in">fetchOrderDetail</span>(firstOrder.id); <span class="hljs-comment">// ä¾èµ–è®¢å• ID</span>
      })
      <span class="hljs-selector-class">.then</span>((detailData) =&gt; {
        <span class="hljs-built_in">setDetail</span>(detailData);
      })
      <span class="hljs-selector-class">.catch</span>((err) =&gt; <span class="hljs-built_in">setError</span>(err.message))
      <span class="hljs-selector-class">.finally</span>(() =&gt; <span class="hljs-built_in">setLoading</span>(false));
  }, <span class="hljs-selector-attr">[]</span>);

  if (loading) return &lt;<span class="hljs-selector-tag">div</span>&gt;åŠ è½½ä¸­...&lt;/<span class="hljs-selector-tag">div</span>&gt;;
  if (error) return &lt;<span class="hljs-selector-tag">div</span>&gt;åŠ è½½å¤±è´¥ï¼š{error}&lt;/<span class="hljs-selector-tag">div</span>&gt;;
  if (!user || !order || !detail) return null;

  return (
    &lt;div&gt;
      &lt;h2&gt;{user.name} çš„è®¢å•è¯¦æƒ…&lt;/h2&gt;
      &lt;p&gt;è®¢å•å·ï¼š{order.id}&lt;/p&gt;
      &lt;p&gt;å•†å“ï¼š{detail.goodsName}&lt;/p&gt;
      &lt;p&gt;é‡‘é¢ï¼šï¿¥{detail.amount}&lt;/p&gt;
    &lt;/div&gt;
  );
}
</code></pre>
<p>è¿™ç§åµŒå¥—å†™æ³•ä¸ä»…å¯è¯»æ€§å·®ï¼Œè€Œä¸”ä¸€æ—¦æŸä¸ªç¯èŠ‚éœ€è¦ä¿®æ”¹ï¼ˆæ¯”å¦‚å¢åŠ ä¸€ä¸ªä¾èµ–èµ„æºï¼‰ï¼Œå°±éœ€è¦æ”¹åŠ¨å¤šå±‚ä»£ç ï¼Œç»´æŠ¤æˆæœ¬æé«˜ã€‚</p>
<h3 data-id="heading-3">3. ç—›ç‚¹æ€»ç»“ï¼šæ—§ç‰ˆ Suspense ä¸ºä½•â€œä¸çœå¿ƒâ€ï¼Ÿ</h3>
<p>æ—§ç‰ˆ Suspense ä¹‹æ‰€ä»¥æ— æ³•è§£å†³è¿™äº›é—®é¢˜ï¼Œæ ¸å¿ƒåŸå› æ˜¯ï¼š<strong>ä¸å…·å¤‡åŸç”Ÿçš„èµ„æºåè°ƒèƒ½åŠ›</strong>ã€‚å®ƒåªèƒ½ç›‘å¬å•ä¸ªç»„ä»¶å†…éƒ¨çš„å¼‚æ­¥èµ„æºï¼ˆæ¯”å¦‚é€šè¿‡ use() æˆ– lazy åŠ è½½çš„èµ„æºï¼‰ï¼Œæ— æ³•æ„ŸçŸ¥å¤šä¸ªç»„ä»¶ã€å¤šä¸ªèµ„æºä¹‹é—´çš„ä¾èµ–å…³ç³»å’ŒåŠ è½½é¡ºåºã€‚å› æ­¤ï¼Œå¼€å‘è€…å¿…é¡»æ‰‹åŠ¨ç”¨ Promise æˆ–çŠ¶æ€ç®¡ç†åº“æ¥åè°ƒè¿™äº›èµ„æºï¼Œå¯¼è‡´ä»£ç å†—ä½™ã€é€»è¾‘å¤æ‚ã€‚</p>
<h2 data-id="heading-4">äºŒã€React 19 æ ¸å¿ƒå‡çº§ï¼šSuspense åŸç”Ÿåè°ƒåŸç†</h2>
<p>React 19 ä¸º Suspense æ–°å¢äº† <strong>åŸç”Ÿåè°ƒèƒ½åŠ›</strong>ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯ï¼š<strong>è‡ªåŠ¨æ„ŸçŸ¥å¹¶åè°ƒå¤šä¸ªå¼‚æ­¥èµ„æºçš„åŠ è½½çŠ¶æ€ï¼Œæ”¯æŒå¹¶è¡Œã€ä¸²è¡Œç­‰å¤šç§åŠ è½½ç­–ç•¥ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†çŠ¶æ€</strong>ã€‚è¿™ä¸€ç‰¹æ€§å½»åº•è§£å†³äº†æ—§ç‰ˆçš„ç—›ç‚¹ï¼Œè®©å¤šèµ„æºåŠ è½½å˜å¾—æç®€ã€‚</p>
<h3 data-id="heading-5">1. æ ¸å¿ƒæ¦‚å¿µï¼šä»€ä¹ˆæ˜¯â€œåŸç”Ÿåè°ƒâ€ï¼Ÿ</h3>
<p>Suspense åŸç”Ÿåè°ƒï¼Œç®€å•æ¥è¯´å°±æ˜¯ï¼š<strong>å½“å¤šä¸ªå¼‚æ­¥èµ„æºè¢« Suspense åŒ…è£¹æ—¶ï¼ŒReact ä¼šè‡ªåŠ¨æ”¶é›†æ‰€æœ‰èµ„æºçš„åŠ è½½çŠ¶æ€ï¼Œæ ¹æ®ä½ æŒ‡å®šçš„ç­–ç•¥ï¼ˆå¹¶è¡Œ/ä¸²è¡Œï¼‰ç­‰å¾…èµ„æºåŠ è½½å®Œæˆï¼Œå†ç»Ÿä¸€æ¸²æŸ“å†…å®¹ï¼›æœŸé—´åªæ˜¾ç¤ºä¸€ä¸ª fallbackï¼Œé”™è¯¯ä¹Ÿä¼šè¢«ç»Ÿä¸€æ•è·</strong>ã€‚</p>
<p>å…³é”®å˜åŒ–åœ¨äºï¼šReact 19 è®© Suspense ä»â€œå•ä¸ªèµ„æºçš„åŠ è½½å®¹å™¨â€å‡çº§ä¸ºâ€œå¤šä¸ªèµ„æºçš„åè°ƒå™¨â€ï¼Œèƒ½å¤Ÿä¸»åŠ¨ç®¡ç†å¤šä¸ªèµ„æºçš„åŠ è½½ç”Ÿå‘½å‘¨æœŸã€‚</p>
<h3 data-id="heading-6">2. æ ¸å¿ƒåŸç†ï¼š3 æ­¥å®ç°èµ„æºåè°ƒ</h3>
<p>Suspense åŸç”Ÿåè°ƒçš„åº•å±‚åŸç†ï¼Œä¾èµ–äº React 19 å¯¹â€œå¼‚æ­¥èµ„æºè°ƒåº¦ç³»ç»Ÿâ€çš„å‡çº§ï¼Œæ ¸å¿ƒæµç¨‹å¯ä»¥æ‹†è§£ä¸º 3 æ­¥ï¼š</p>
<ol>
<li>
<p><strong>èµ„æºæ”¶é›†é˜¶æ®µ</strong>ï¼šå½“ Suspense ç»„ä»¶æ¸²æŸ“æ—¶ï¼ŒReact ä¼šè‡ªåŠ¨è¿½è¸ªå…¶å†…éƒ¨æ‰€æœ‰é€šè¿‡ use() æ¶ˆè´¹çš„å¼‚æ­¥èµ„æºï¼ˆæˆ–é€šè¿‡ lazy åŠ è½½çš„ç»„ä»¶ï¼‰ï¼Œå°†è¿™äº›èµ„æºçš„ Promise æ”¶é›†åˆ°ä¸€ä¸ªâ€œèµ„æºé˜Ÿåˆ—â€ä¸­ï¼›</p>
</li>
<li>
<p><strong>åŠ è½½åè°ƒé˜¶æ®µ</strong>ï¼šReact æ ¹æ® Suspense çš„é…ç½®ï¼ˆé»˜è®¤å¹¶è¡Œï¼Œå¯é€šè¿‡é…ç½®å®ç°ä¸²è¡Œï¼‰ï¼Œåè°ƒèµ„æºé˜Ÿåˆ—çš„åŠ è½½é¡ºåºï¼š</p>
<ol>
<li>å¹¶è¡Œç­–ç•¥ï¼šåŒæ—¶è§¦å‘æ‰€æœ‰èµ„æºçš„åŠ è½½ï¼Œç­‰å¾…æ‰€æœ‰èµ„æºéƒ½å†³è®®ï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰ï¼›</li>
<li>ä¸²è¡Œç­–ç•¥ï¼šæŒ‰èµ„æºçš„ä¾èµ–å…³ç³»ä¾æ¬¡è§¦å‘åŠ è½½ï¼Œå‰ä¸€ä¸ªèµ„æºæˆåŠŸåå†åŠ è½½ä¸‹ä¸€ä¸ªï¼›</li>
</ol>
</li>
<li>
<p><strong>çŠ¶æ€ç»Ÿä¸€é˜¶æ®µ</strong>ï¼šåœ¨èµ„æºåŠ è½½è¿‡ç¨‹ä¸­ï¼ŒSuspense å§‹ç»ˆæ˜¾ç¤º fallbackï¼›å½“æ‰€æœ‰èµ„æºéƒ½æˆåŠŸåŠ è½½ï¼ŒSuspense ä¼šæ¸²æŸ“å†…éƒ¨å†…å®¹ï¼›å¦‚æœä»»ä½•ä¸€ä¸ªèµ„æºåŠ è½½å¤±è´¥ï¼Œé”™è¯¯ä¼šè¢« ErrorBoundary ç»Ÿä¸€æ•è·ã€‚</p>
</li>
</ol>
<h4 data-id="heading-7">Suspense åŸç”Ÿåè°ƒæµç¨‹å›¾</h4>
<h3 data-id="heading-8">3. å…³é”®æŠ€æœ¯ï¼šReact 19 å¦‚ä½•è¿½è¸ªèµ„æºä¾èµ–ï¼Ÿ</h3>
<p>Suspense åŸç”Ÿåè°ƒçš„æ ¸å¿ƒæŠ€æœ¯æ”¯æ’‘ï¼Œæ˜¯ React 19 å¯¹ <code>use()</code> Hook çš„å¢å¼ºå’Œâ€œèµ„æºä¾èµ–è¿½è¸ªæœºåˆ¶â€ï¼š</p>
<ul>
<li><strong>use() å¢å¼º</strong>ï¼šReact 19 ä¸­çš„ use() ä¸ä»…èƒ½æ¶ˆè´¹å•ä¸ª Promiseï¼Œè¿˜èƒ½å°†å…¶å¯¹åº”çš„èµ„æºæ³¨å†Œåˆ°æœ€è¿‘çš„ Suspense ç»„ä»¶ä¸­ï¼Œè®© Suspense æ„ŸçŸ¥åˆ°è¿™ä¸ªèµ„æºçš„å­˜åœ¨ï¼›</li>
<li><strong>ä¾èµ–è¿½è¸ª</strong>ï¼šReact ä¼šåœ¨ç»„ä»¶æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡â€œä¸Šä¸‹æ–‡â€è®°å½•å½“å‰ Suspense ç»„ä»¶ä¸èµ„æºçš„å¯¹åº”å…³ç³»ï¼Œå½¢æˆä¸€ä¸ªâ€œèµ„æºä¾èµ–æ ‘â€ã€‚å½“èµ„æºçŠ¶æ€å˜åŒ–æ—¶ï¼ŒReact èƒ½é€šè¿‡è¿™ä¸ªæ ‘å¿«é€Ÿå®šä½åˆ°å¯¹åº”çš„ Suspense ç»„ä»¶ï¼Œè§¦å‘é‡æ–°åè°ƒã€‚</li>
</ul>
<p>ç®€å•æ¥è¯´ï¼ŒReact 19 è®© Suspense å’Œ use() å½¢æˆäº†â€œçˆ¶å­å…³ç³»â€ï¼šSuspense æ˜¯â€œåè°ƒå™¨â€ï¼Œuse() æ¶ˆè´¹çš„èµ„æºæ˜¯â€œè¢«åè°ƒçš„å­èŠ‚ç‚¹â€ï¼Œåè°ƒå™¨ç»Ÿä¸€ç®¡ç†æ‰€æœ‰å­èŠ‚ç‚¹çš„åŠ è½½çŠ¶æ€ã€‚</p>
<h2 data-id="heading-9">ä¸‰ã€å®æˆ˜æ¼”ç»ƒï¼š4 ä¸ªé«˜é¢‘åœºæ™¯ç©è½¬ Suspense åŸç”Ÿåè°ƒ</h2>
<p>ç†è§£äº†æ ¸å¿ƒåŸç†åï¼Œæˆ‘ä»¬é€šè¿‡ 4 ä¸ªçœŸå®ä¸šåŠ¡åœºæ™¯ï¼Œçœ‹çœ‹ React 19 Suspense åŸç”Ÿåè°ƒå¦‚ä½•è½åœ°ã€‚æ‰€æœ‰æ¡ˆä¾‹éƒ½åŸºäºâ€œuse() + Suspense + ErrorBoundaryâ€çš„ç»„åˆï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†ä»»ä½•åŠ è½½çŠ¶æ€ã€‚</p>
<h3 data-id="heading-10">åœºæ™¯ 1ï¼šå¤šèµ„æºå¹¶è¡ŒåŠ è½½ï¼ˆåŸºç¡€ç”¨æ³•ï¼‰</h3>
<p>éœ€æ±‚ï¼šåŒæ—¶åŠ è½½â€œç”¨æˆ·ä¿¡æ¯â€å’Œâ€œè®¢å•åˆ—è¡¨â€ï¼Œå…¨éƒ¨åŠ è½½å®Œæˆåå±•ç¤ºé¡µé¢ï¼Œç»Ÿä¸€æ˜¾ç¤º loadingï¼Œé”™è¯¯ç»Ÿä¸€æ•è·ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// React 19ï¼šSuspense åŸç”Ÿåè°ƒå®ç°å¤šèµ„æºå¹¶è¡ŒåŠ è½½</span>
<span class="hljs-keyword">import</span> { use, <span class="hljs-title class_">Suspense</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// 1. å®šä¹‰å¼‚æ­¥è¯·æ±‚å‡½æ•°ï¼ˆè¿”å› Promiseï¼‰</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchUser</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/user'</span>);
  <span class="hljs-keyword">if</span> (!res.<span class="hljs-property">ok</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ç”¨æˆ·ä¿¡æ¯åŠ è½½å¤±è´¥'</span>);
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchOrders</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/orders'</span>);
  <span class="hljs-keyword">if</span> (!res.<span class="hljs-property">ok</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è®¢å•åˆ—è¡¨åŠ è½½å¤±è´¥'</span>);
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
}

<span class="hljs-comment">// 2. å­ç»„ä»¶ï¼šåˆ†åˆ«ä½¿ç”¨ use() æ¶ˆè´¹èµ„æº</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserInfo</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchUser</span>()); <span class="hljs-comment">// æ¶ˆè´¹ç”¨æˆ·èµ„æº</span>
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{user.name} çš„ä»ªè¡¨ç›˜<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderList</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> orders = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchOrders</span>()); <span class="hljs-comment">// æ¶ˆè´¹è®¢å•èµ„æº</span>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æˆ‘çš„è®¢å•<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        {orders.map((order) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{order.id}</span>&gt;</span>{order.title} - ï¿¥{order.amount}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 3. ErrorBoundary ç»„ä»¶ï¼ˆç»Ÿä¸€æ•è·é”™è¯¯ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ErrorBoundary</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) {
    <span class="hljs-variable language_">super</span>(props);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span> };
  }

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getDerivedStateFromError</span>(<span class="hljs-params">error</span>) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">true</span>, error };
  }

  <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">hasError</span>) {
      <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>åŠ è½½å¤±è´¥ï¼š{this.state.error.message}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>.<span class="hljs-property">children</span>;
  }
}

<span class="hljs-comment">// 4. çˆ¶ç»„ä»¶ï¼šç”¨ Suspense åŒ…è£¹æ‰€æœ‰å­ç»„ä»¶ï¼Œå®ç°åŸç”Ÿåè°ƒ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserDashboard</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">UserInfo</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">OrderList</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span></span>
  );
}
</code></pre>
<p>æ ¸å¿ƒç®€åŒ–ç‚¹ï¼š</p>
<ul>
<li>å»æ‰äº†æ‰€æœ‰æ‰‹åŠ¨ç®¡ç†çš„ loadingã€errorã€æ•°æ®çŠ¶æ€ï¼›</li>
<li>æ— éœ€ç”¨ Promise.all åè°ƒå¹¶è¡Œèµ„æºï¼ŒSuspense ä¼šè‡ªåŠ¨æ”¶é›† UserInfo å’Œ OrderList ä¸­çš„ä¸¤ä¸ªèµ„æºï¼Œå¹¶è¡ŒåŠ è½½ï¼›</li>
<li>åŠ è½½çŠ¶æ€å’Œé”™è¯¯çŠ¶æ€åˆ†åˆ«ç”± Suspense å’Œ ErrorBoundary ç»Ÿä¸€å¤„ç†ï¼Œä»£ç é€»è¾‘æåº¦ç®€æ´ã€‚</li>
</ul>
<h3 data-id="heading-11">åœºæ™¯ 2ï¼šä¾èµ–èµ„æºä¸²è¡ŒåŠ è½½ï¼ˆé€šè¿‡åµŒå¥— Suspense å®ç°ï¼‰</h3>
<p>éœ€æ±‚ï¼šå…ˆåŠ è½½â€œç”¨æˆ·ä¿¡æ¯â€ï¼ˆè·å– user.idï¼‰ï¼Œå†æ ¹æ® user.id åŠ è½½â€œè®¢å•åˆ—è¡¨â€ï¼Œæœ€åæ ¹æ® order.id åŠ è½½â€œè®¢å•è¯¦æƒ…â€ï¼Œä¸²è¡Œæ‰§è¡Œï¼Œç»Ÿä¸€æ˜¾ç¤º loadingã€‚</p>
<p>å®ç°æ€è·¯ï¼šåˆ©ç”¨ <strong>åµŒå¥— Suspense</strong> å®ç°ä¸²è¡ŒåŠ è½½ã€‚å› ä¸ºå†…å±‚ Suspense ä¼šç­‰å¾…å¤–å±‚ Suspense ä¸­çš„èµ„æºåŠ è½½å®Œæˆåï¼Œæ‰ä¼šæ¸²æŸ“è‡ªèº«å†…å®¹ï¼Œä»è€Œè§¦å‘å†…å±‚èµ„æºçš„åŠ è½½ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// React 19ï¼šåµŒå¥— Suspense å®ç°ä¸²è¡Œèµ„æºåŠ è½½</span>
<span class="hljs-keyword">import</span> { use, <span class="hljs-title class_">Suspense</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// å¼‚æ­¥è¯·æ±‚å‡½æ•°ï¼ˆè®¢å•å’Œè¯¦æƒ…ä¾èµ–å‰åºèµ„æºçš„ IDï¼‰</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchUser</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/user'</span>);
  <span class="hljs-keyword">if</span> (!res.<span class="hljs-property">ok</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ç”¨æˆ·ä¿¡æ¯åŠ è½½å¤±è´¥'</span>);
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchOrders</span>(<span class="hljs-params">userId</span>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/orders?userId=<span class="hljs-subst">${userId}</span>`</span>);
  <span class="hljs-keyword">if</span> (!res.<span class="hljs-property">ok</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è®¢å•åˆ—è¡¨åŠ è½½å¤±è´¥'</span>);
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchOrderDetail</span>(<span class="hljs-params">orderId</span>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/orders/<span class="hljs-subst">${orderId}</span>/detail`</span>);
  <span class="hljs-keyword">if</span> (!res.<span class="hljs-property">ok</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è®¢å•è¯¦æƒ…åŠ è½½å¤±è´¥'</span>);
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
}

<span class="hljs-comment">// å­ç»„ä»¶ 1ï¼šåŠ è½½ç”¨æˆ·ä¿¡æ¯</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">User</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchUser</span>());
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{user.name} çš„è®¢å•è¯¦æƒ…<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½è®¢å•åˆ—è¡¨ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">OrderList</span> <span class="hljs-attr">userId</span>=<span class="hljs-string">{user.id}</span> /&gt;</span> {/* ä¼ å…¥ user.id ç»™ä¸‹ä¸€å±‚ */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// å­ç»„ä»¶ 2ï¼šåŠ è½½è®¢å•åˆ—è¡¨ï¼ˆä¾èµ– user.idï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderList</span>(<span class="hljs-params">{ userId }</span>) {
  <span class="hljs-keyword">const</span> orders = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchOrders</span>(userId));
  <span class="hljs-keyword">const</span> firstOrder = orders[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å½“å‰è®¢å•ï¼š{firstOrder.id}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½è®¢å•è¯¦æƒ…ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">OrderDetail</span> <span class="hljs-attr">orderId</span>=<span class="hljs-string">{firstOrder.id}</span> /&gt;</span> {/* ä¼ å…¥ order.id ç»™ä¸‹ä¸€å±‚ */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// å­ç»„ä»¶ 3ï¼šåŠ è½½è®¢å•è¯¦æƒ…ï¼ˆä¾èµ– order.idï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderDetail</span>(<span class="hljs-params">{ orderId }</span>) {
  <span class="hljs-keyword">const</span> detail = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchOrderDetail</span>(orderId));
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å•†å“ï¼š{detail.goodsName}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>é‡‘é¢ï¼šï¿¥{detail.amount}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>çŠ¶æ€ï¼š{detail.status}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// çˆ¶ç»„ä»¶ï¼šæœ€å¤–å±‚ Suspense ç»Ÿä¸€ç®¡ç†æ•´ä½“åŠ è½½çŠ¶æ€</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderDetailPage</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>æ•´ä½“åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">User</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span></span>
  );
}
</code></pre>
<p>æ ¸å¿ƒé€»è¾‘ï¼š</p>
<ul>
<li>å¤–å±‚ Suspense åŒ…è£¹ User ç»„ä»¶ï¼Œç­‰å¾… fetchUser å®Œæˆï¼›</li>
<li>User ç»„ä»¶åŠ è½½å®Œæˆåï¼Œæ¸²æŸ“å†…å±‚ Suspense å’Œ OrderList ç»„ä»¶ï¼Œè§¦å‘ fetchOrdersï¼ˆä¾èµ– user.idï¼‰ï¼›</li>
<li>OrderList ç»„ä»¶åŠ è½½å®Œæˆåï¼Œæ¸²æŸ“æœ€å†…å±‚ Suspense å’Œ OrderDetail ç»„ä»¶ï¼Œè§¦å‘ fetchOrderDetailï¼ˆä¾èµ– order.idï¼‰ï¼›</li>
<li>æ•´ä¸ªè¿‡ç¨‹æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ï¼Œæœ€å¤–å±‚ Suspense ä¼šæ˜¾ç¤ºæ•´ä½“ loadingï¼Œä¹Ÿå¯ä»¥ä¸ºæ¯ä¸€å±‚è®¾ç½®å•ç‹¬çš„ fallbackï¼Œå®ç°æ›´ç²¾ç»†çš„åŠ è½½çŠ¶æ€å±•ç¤ºã€‚</li>
</ul>
<h3 data-id="heading-12">åœºæ™¯ 3ï¼šæ··åˆåŠ è½½ç­–ç•¥ï¼ˆéƒ¨åˆ†å¹¶è¡Œ + éƒ¨åˆ†ä¸²è¡Œï¼‰</h3>
<p>éœ€æ±‚ï¼šåŠ è½½â€œç”¨æˆ·ä¿¡æ¯â€åï¼Œå¹¶è¡ŒåŠ è½½â€œè®¢å•åˆ—è¡¨â€å’Œâ€œç”¨æˆ·æ”¶è—â€ï¼Œæœ€ååŠ è½½â€œè®¢å•è¯¦æƒ…â€ã€‚å³ï¼šä¸²è¡Œï¼ˆç”¨æˆ·ï¼‰â†’ å¹¶è¡Œï¼ˆè®¢å•+æ”¶è—ï¼‰â†’ ä¸²è¡Œï¼ˆè¯¦æƒ…ï¼‰ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// React 19ï¼šæ··åˆåŠ è½½ç­–ç•¥ï¼ˆä¸²è¡Œ+å¹¶è¡Œï¼‰</span>
<span class="hljs-keyword">import</span> { use, <span class="hljs-title class_">Suspense</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// å¼‚æ­¥è¯·æ±‚å‡½æ•°</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchUser</span>(<span class="hljs-params"/>) { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchOrders</span>(<span class="hljs-params">userId</span>) { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchCollections</span>(<span class="hljs-params">userId</span>) { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchOrderDetail</span>(<span class="hljs-params">orderId</span>) { <span class="hljs-comment">/* ... */</span> }

<span class="hljs-comment">// å¹¶è¡ŒåŠ è½½è®¢å•å’Œæ”¶è—çš„ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderAndCollection</span>(<span class="hljs-params">{ userId }</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* ä¸¤ä¸ªç»„ä»¶å¹¶è¡ŒåŠ è½½ï¼Œç”±å†…å±‚ Suspense åè°ƒ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">OrderList</span> <span class="hljs-attr">userId</span>=<span class="hljs-string">{userId}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">CollectionList</span> <span class="hljs-attr">userId</span>=<span class="hljs-string">{userId}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// è®¢å•åˆ—è¡¨ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderList</span>(<span class="hljs-params">{ userId }</span>) {
  <span class="hljs-keyword">const</span> orders = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchOrders</span>(userId));
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æˆ‘çš„è®¢å•<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>{orders.map(o =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{o.id}</span>&gt;</span>{o.title}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>)}<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// æ”¶è—åˆ—è¡¨ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">CollectionList</span>(<span class="hljs-params">{ userId }</span>) {
  <span class="hljs-keyword">const</span> collections = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchCollections</span>(userId));
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æˆ‘çš„æ”¶è—<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>{collections.map(c =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{c.id}</span>&gt;</span>{c.name}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>)}<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// è®¢å•è¯¦æƒ…ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderDetail</span>(<span class="hljs-params">{ orderId }</span>) {
  <span class="hljs-keyword">const</span> detail = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchOrderDetail</span>(orderId));
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>è®¢å•è¯¦æƒ…<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å•†å“ï¼š{detail.goodsName}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// çˆ¶ç»„ä»¶ï¼šé€šè¿‡åµŒå¥— Suspense å®ç°æ··åˆç­–ç•¥</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">MixedLoadPage</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½ç”¨æˆ·ä¿¡æ¯ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">UserWrapper</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserWrapper</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchUser</span>());
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{user.name} çš„ä¸ªäººä¸­å¿ƒ<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      {/* å¹¶è¡ŒåŠ è½½è®¢å•å’Œæ”¶è— */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½è®¢å•å’Œæ”¶è—ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">OrderAndCollection</span> <span class="hljs-attr">userId</span>=<span class="hljs-string">{user.id}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
      {/* åŠ è½½è®¢å•è¯¦æƒ…ï¼ˆä¾èµ–è®¢å•åˆ—è¡¨ï¼‰ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½è®¢å•è¯¦æƒ…ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">OrderDetail</span> <span class="hljs-attr">orderId</span>=<span class="hljs-string">"123"</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p>æ ¸å¿ƒæ€è·¯ï¼šé€šè¿‡â€œä¸åŒå±‚çº§çš„ Suspense åŒ…è£¹ä¸åŒçš„èµ„æºç»„åˆâ€ï¼Œå®ç°æ··åˆåŠ è½½ç­–ç•¥ã€‚å¤–å±‚ Suspense ç®¡ç†ä¸²è¡Œç¯èŠ‚ï¼Œå†…å±‚ Suspense ç®¡ç†å¹¶è¡Œç¯èŠ‚ï¼Œé€»è¾‘æ¸…æ™°ï¼Œå¯æ‰©å±•æ€§å¼ºã€‚</p>
<h3 data-id="heading-13">åœºæ™¯ 4ï¼šåŠ¨æ€èµ„æºåŠ è½½ï¼ˆæ ¹æ®ç”¨æˆ·æ“ä½œåŠ è½½èµ„æºï¼‰</h3>
<p>éœ€æ±‚ï¼šé¡µé¢åˆå§‹åªåŠ è½½â€œç”¨æˆ·ä¿¡æ¯â€ï¼Œç”¨æˆ·ç‚¹å‡»â€œæŸ¥çœ‹è®¢å•â€æŒ‰é’®åï¼Œå†åŠ è½½â€œè®¢å•åˆ—è¡¨â€ï¼Œç‚¹å‡»æŒ‰é’®æ—¶æ˜¾ç¤º loadingã€‚</p>
<p>å®ç°æ€è·¯ï¼šç”¨ useState æ§åˆ¶åŠ¨æ€èµ„æºçš„åŠ è½½æ—¶æœºï¼Œåªæœ‰å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®åï¼Œæ‰æ¸²æŸ“ä¾èµ–è®¢å•èµ„æºçš„ç»„ä»¶ï¼ŒSuspense ä¼šè‡ªåŠ¨æ•è·è¿™ä¸ªåŠ¨æ€åŠ è½½çš„èµ„æºã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// React 19ï¼šåŠ¨æ€èµ„æºåŠ è½½ï¼ˆç”¨æˆ·æ“ä½œè§¦å‘ï¼‰</span>
<span class="hljs-keyword">import</span> { use, <span class="hljs-title class_">Suspense</span>, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchUser</span>(<span class="hljs-params"/>) { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchOrders</span>(<span class="hljs-params">userId</span>) { <span class="hljs-comment">/* ... */</span> }

<span class="hljs-comment">// è®¢å•åˆ—è¡¨ç»„ä»¶ï¼ˆåŠ¨æ€åŠ è½½ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderList</span>(<span class="hljs-params">{ userId }</span>) {
  <span class="hljs-keyword">const</span> orders = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchOrders</span>(userId));
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
      {orders.map(o =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{o.id}</span>&gt;</span>{o.title} - ï¿¥{o.amount}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>)}
    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserPage</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchUser</span>());
  <span class="hljs-keyword">const</span> [showOrders, setShowOrders] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>); <span class="hljs-comment">// æ§åˆ¶æ˜¯å¦åŠ è½½è®¢å•</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{user.name} çš„é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setShowOrders(true)}&gt;æŸ¥çœ‹è®¢å•<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {/* åŠ¨æ€åŠ è½½è®¢å•èµ„æºï¼šåªæœ‰ showOrders ä¸º true æ—¶æ‰æ¸²æŸ“ */}
      {showOrders &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½è®¢å•ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">OrderList</span> <span class="hljs-attr">userId</span>=<span class="hljs-string">{user.id}</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// çˆ¶ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">DynamicLoadPage</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½ç”¨æˆ·ä¿¡æ¯ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">UserPage</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span></span>
  );
}
</code></pre>
<p>æ ¸å¿ƒé€»è¾‘ï¼š</p>
<ul>
<li>åˆå§‹çŠ¶æ€ä¸‹ï¼ŒshowOrders ä¸º falseï¼ŒOrderList ç»„ä»¶ä¸æ¸²æŸ“ï¼ŒfetchOrders ä¸ä¼šè¢«è§¦å‘ï¼›</li>
<li>ç”¨æˆ·ç‚¹å‡»æŒ‰é’®åï¼ŒshowOrders å˜ä¸º trueï¼ŒOrderList ç»„ä»¶æ¸²æŸ“ï¼Œuse(fetchOrders()) è§¦å‘è¯·æ±‚ï¼›</li>
<li>Suspense æ•è· fetchOrders çš„åŠ è½½çŠ¶æ€ï¼Œæ˜¾ç¤º fallbackï¼ŒåŠ è½½å®Œæˆåå±•ç¤ºè®¢å•åˆ—è¡¨ã€‚</li>
</ul>
<h2 data-id="heading-14">å››ã€é¿å‘æŒ‡å—ï¼šä½¿ç”¨ Suspense åŸç”Ÿåè°ƒçš„ 6 ä¸ªå…³é”®æ³¨æ„ç‚¹</h2>
<p>åœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæœ‰å‡ ä¸ªå®¹æ˜“è¸©å‘çš„ç‚¹ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œé¿å…å‡ºç°çŠ¶æ€æ··ä¹±æˆ–æ€§èƒ½é—®é¢˜ã€‚</p>
<h3 data-id="heading-15">1. å¿…é¡»é…åˆ use() æ¶ˆè´¹èµ„æº</h3>
<p>Suspense åŸç”Ÿåè°ƒåªèƒ½æ„ŸçŸ¥é€šè¿‡ <code>use()</code> æ¶ˆè´¹çš„å¼‚æ­¥èµ„æºï¼ˆæˆ–é€šè¿‡ <code>React.lazy</code> åŠ è½½çš„ç»„ä»¶ï¼‰ã€‚å¦‚æœç›´æ¥åœ¨ç»„ä»¶ä¸­ç”¨ Promise.then å¤„ç†å¼‚æ­¥è¯·æ±‚ï¼ŒSuspense æ— æ³•æ•è·å…¶çŠ¶æ€ï¼Œæ— æ³•è¿›è¡Œåè°ƒã€‚</p>
<p>é”™è¯¯ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// é”™è¯¯ï¼šç›´æ¥ç”¨ Promise.thenï¼ŒSuspense æ— æ³•æ„ŸçŸ¥</span>
function <span class="hljs-built_in">OrderList</span>() {
  const <span class="hljs-selector-attr">[orders, setOrders]</span> = <span class="hljs-built_in">useState</span>(null);
  <span class="hljs-built_in">useEffect</span>(() =&gt; {
    <span class="hljs-built_in">fetchOrders</span>()<span class="hljs-selector-class">.then</span>(setOrders);
  }, <span class="hljs-selector-attr">[]</span>);
  return &lt;<span class="hljs-selector-tag">ul</span>&gt;{orders<span class="hljs-selector-class">.map</span>(o =&gt; &amp;lt;li key={o.id}&amp;gt;{o.title}&amp;lt;/li&amp;gt;)}&amp;lt;/<span class="hljs-selector-tag">ul</span>&amp;gt;;
}
</code></pre>
<p>æ­£ç¡®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ­£ç¡®ï¼šç”¨ use() æ¶ˆè´¹èµ„æºï¼ŒSuspense å¯æ„ŸçŸ¥</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderList</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> orders = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchOrders</span>());
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>{orders.map(o =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{o.id}</span>&gt;</span>{o.title}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>)}<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span>;
}
</code></pre>
<h3 data-id="heading-16">2. é”™è¯¯å¿…é¡»ç”¨ ErrorBoundary æ•è·</h3>
<p>Suspense åªå¤„ç†â€œåŠ è½½ä¸­â€çŠ¶æ€ï¼Œä¸å¤„ç†â€œåŠ è½½å¤±è´¥â€çŠ¶æ€ã€‚å¦‚æœä»»ä½•ä¸€ä¸ªèµ„æºåŠ è½½å¤±è´¥ï¼Œä¼šæŠ›å‡ºé”™è¯¯ï¼Œå¿…é¡»ç”¨ ErrorBoundary ç»„ä»¶æ•è·ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ•´ä¸ªåº”ç”¨å´©æºƒã€‚</p>
<h3 data-id="heading-17">3. åµŒå¥— Suspense çš„ fallback ä¼˜å…ˆçº§</h3>
<p>å½“å­˜åœ¨åµŒå¥— Suspense æ—¶ï¼Œ<strong>å†…å±‚ Suspense çš„ fallback ä¼šè¦†ç›–å¤–å±‚çš„ fallback</strong>ã€‚å¦‚æœéœ€è¦æ˜¾ç¤ºæ•´ä½“åŠ è½½çŠ¶æ€ï¼Œå¯ä»¥åœ¨æœ€å¤–å±‚è®¾ç½®ä¸€ä¸ªå…¨å±€ fallbackï¼Œå†…å±‚è®¾ç½®å±€éƒ¨ fallbackï¼Œå®ç°åˆ†å±‚åŠ è½½æç¤ºã€‚</p>
<h3 data-id="heading-18">4. é¿å…è¿‡åº¦åµŒå¥— Suspense</h3>
<p>è™½ç„¶åµŒå¥— Suspense å¯ä»¥å®ç°å¤æ‚çš„åŠ è½½ç­–ç•¥ï¼Œä½†è¿‡åº¦åµŒå¥—ä¼šå¢åŠ  React çš„åè°ƒæˆæœ¬ï¼Œå½±å“æ€§èƒ½ã€‚å»ºè®®æ ¹æ®å®é™…éœ€æ±‚ï¼Œåˆç†åˆ’åˆ† Suspense çš„å±‚çº§ï¼Œé¿å…ä¸å¿…è¦çš„åµŒå¥—ã€‚</p>
<h3 data-id="heading-19">5. åŠ¨æ€èµ„æºåŠ è½½çš„çŠ¶æ€é‡ç½®</h3>
<p>å½“åŠ¨æ€åŠ è½½çš„èµ„æºï¼ˆå¦‚åœºæ™¯ 4 ä¸­çš„è®¢å•åˆ—è¡¨ï¼‰éœ€è¦é‡æ–°åŠ è½½æ—¶ï¼ˆæ¯”å¦‚ç”¨æˆ·åˆ‡æ¢äº†ç”¨æˆ· IDï¼‰ï¼Œåªéœ€ä¿®æ”¹èµ„æºä¾èµ–çš„å‚æ•°ï¼ˆå¦‚ userIdï¼‰ï¼ŒSuspense ä¼šè‡ªåŠ¨é‡æ–°åè°ƒï¼Œè§¦å‘æ–°çš„è¯·æ±‚ï¼Œæ— éœ€æ‰‹åŠ¨é‡ç½®çŠ¶æ€ã€‚</p>
<h3 data-id="heading-20">6. ä¸æ”¯æŒåŒæ­¥èµ„æºçš„åè°ƒ</h3>
<p>Suspense åŸç”Ÿåè°ƒåªé’ˆå¯¹â€œå¼‚æ­¥èµ„æºâ€ï¼ˆè¿”å› Promise çš„èµ„æºï¼‰ã€‚å¦‚æœèµ„æºæ˜¯åŒæ­¥çš„ï¼ˆå¦‚ç›´æ¥å¯¼å…¥çš„é™æ€æ•°æ®ï¼‰ï¼ŒSuspense ä¸ä¼šå¯¹å…¶è¿›è¡Œåè°ƒï¼Œä¼šç›´æ¥æ¸²æŸ“å†…å®¹ã€‚</p>
<h2 data-id="heading-21">äº”ã€æ ¸å¿ƒæ€»ç»“</h2>
<p>ä»Šå¤©æˆ‘ä»¬è¯¦ç»†æ‹†è§£äº† React 19 Suspense åŸç”Ÿåè°ƒçš„æ ¸å¿ƒåŸç†å’Œå®æˆ˜ç”¨æ³•ï¼Œæ ¸å¿ƒè¦ç‚¹æ€»ç»“å¦‚ä¸‹ï¼š</p>
<ol start="4">
<li>
<p><strong>æ ¸å¿ƒä»·å€¼</strong>ï¼šSuspense ä»â€œå•ä¸ªèµ„æºåŠ è½½å®¹å™¨â€å‡çº§ä¸ºâ€œå¤šèµ„æºåè°ƒå™¨â€ï¼Œè‡ªåŠ¨æ„ŸçŸ¥å¹¶åè°ƒå¤šä¸ªå¼‚æ­¥èµ„æºçš„åŠ è½½çŠ¶æ€ï¼Œæ”¯æŒå¹¶è¡Œã€ä¸²è¡Œã€æ··åˆç­‰å¤šç§åŠ è½½ç­–ç•¥ï¼Œå½»åº•æ¶ˆé™¤èµ„æºåŠ è½½çš„æ¨¡æ¿ä»£ç ï¼›</p>
</li>
<li>
<p><strong>æ ¸å¿ƒåŸç†</strong>ï¼šé€šè¿‡â€œèµ„æºæ”¶é›†-åŠ è½½åè°ƒ-çŠ¶æ€ç»Ÿä¸€â€ä¸‰æ­¥æµç¨‹ï¼Œç»“åˆ use() çš„å¢å¼ºå’Œèµ„æºä¾èµ–è¿½è¸ªæœºåˆ¶ï¼Œå®ç°å¤šèµ„æºçš„è‡ªåŠ¨åè°ƒï¼›</p>
</li>
<li>
<p><strong>å®æˆ˜å…³é”®</strong>ï¼š</p>
<ol>
<li>å¹¶è¡ŒåŠ è½½ï¼šç”¨ä¸€ä¸ª Suspense åŒ…è£¹æ‰€æœ‰èµ„æºç»„ä»¶ï¼›</li>
<li>ä¸²è¡ŒåŠ è½½ï¼šç”¨åµŒå¥— Suspense æŒ‰ä¾èµ–é¡ºåºåŒ…è£¹ç»„ä»¶ï¼›</li>
<li>åŠ¨æ€åŠ è½½ï¼šç”¨çŠ¶æ€æ§åˆ¶èµ„æºç»„ä»¶çš„æ¸²æŸ“æ—¶æœºï¼›</li>
<li>é”™è¯¯å¤„ç†ï¼šå¿…é¡»é…åˆ ErrorBoundary ç»Ÿä¸€æ•è·é”™è¯¯ã€‚</li>
</ol>
</li>
<li>
<p><strong>é¿å‘è¦ç‚¹</strong>ï¼šå¿…é¡»ç”¨ use() æ¶ˆè´¹èµ„æºï¼Œé¿å…è¿‡åº¦åµŒå¥—ï¼Œé”™è¯¯å¤„ç†ä¸èƒ½å°‘ã€‚</p>
</li>
</ol>
<h2 data-id="heading-22">å…­ã€è¿›é˜¶å­¦ä¹ æ–¹å‘</h2>
<p>æŒæ¡äº† Suspense åŸç”Ÿåè°ƒçš„åŸºç¡€ç”¨æ³•åï¼Œå¯ä»¥è¿›ä¸€æ­¥å­¦ä¹ ä»¥ä¸‹å†…å®¹ï¼Œæ·±åŒ–ç†è§£ï¼š</p>
<ul>
<li>Suspense ä¸ React 19 Action çš„ååŒï¼šå¦‚ä½•ç”¨ Action å¤„ç†è¡¨å•æäº¤åçš„èµ„æºé‡æ–°åŠ è½½ï¼›</li>
<li>Suspense æœåŠ¡å™¨ç»„ä»¶ï¼ˆServer Componentsï¼‰çš„ç»“åˆï¼šåœ¨æœåŠ¡ç«¯æ¸²æŸ“åœºæ™¯ä¸‹å¦‚ä½•ä¼˜åŒ–èµ„æºåŠ è½½ï¼›</li>
<li>èµ„æºé¢„åŠ è½½ç­–ç•¥ï¼šå¦‚ä½•é€šè¿‡ preload ç­‰æ–¹å¼ä¼˜åŒ– Suspense çš„åŠ è½½ä½“éªŒï¼›</li>
<li>æºç é˜…è¯»ï¼šæŸ¥çœ‹ React 19 æºç ä¸­ Suspense åè°ƒå™¨çš„å®ç°ï¼ˆé‡ç‚¹çœ‹ react-reconciler åŒ…ä¸­çš„ Suspenseç›¸å…³é€»è¾‘ï¼‰ã€‚</li>
</ul>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµã€æ”¶è—ã€è½¬å‘ï½ æœ‰ä»»ä½•é—®é¢˜ä¹Ÿå¯ä»¥åœ¨è¯„è®ºåŒºç•™è¨€äº¤æµï½ æˆ‘ä»¬ä¸‹æœŸå†è§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[InheritableThreadLocalä»å…¥é—¨åˆ°æ”¾å¼ƒ]]></title>    <link>https://juejin.cn/post/7595771085393100851</link>    <guid>https://juejin.cn/post/7595771085393100851</guid>    <pubDate>2026-01-16T07:37:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595771085393100851" data-draft-id="7595513077221031982" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="InheritableThreadLocalä»å…¥é—¨åˆ°æ”¾å¼ƒ"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-16T07:37:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº¬ä¸œäº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2634854380340008"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            InheritableThreadLocalä»å…¥é—¨åˆ°æ”¾å¼ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2634854380340008/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº¬ä¸œäº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T07:37:49.000Z" title="Fri Jan 16 2026 07:37:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šç”°è¶…è¾‰</p>
<h2 data-id="heading-0">èƒŒæ™¯ï¼š</h2>
<p>ä¸€ä¸ªä¸Šçº¿äº†å¾ˆä¹…ä½†æ˜¯è¯·æ±‚é‡å¾ˆä½(å¹³å‡æ¯å¤©ä¸€ä¸¤æ¬¡)çš„å†å²åŠŸèƒ½çªç„¶å‡ºç°ç©ºæŒ‡é’ˆæŠ¥é”™ï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8380d11214154ca3aa1ede7eee0545aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=lNRjruk4rpSlLh5PfSXQySnxpTw%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>æˆ‘ä»¬ç¿»å¼€ä»£ç å®šä½åˆ°å¯¹åº”çš„æŠ¥é”™ä»£ç ï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4e753899bf0648b5b420f592accee9ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=CKX7XSnUlViROzcJ4fZ0BtOvDoc%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>ç»“åˆå †æ ˆå’Œä»£ç å¯ä»¥ç¡®å®šæ˜¯ç”±äºbdIdJobMapçš„å€¼ä¸ºnullå¯¼è‡´å¾€bdIdEmployeeJobMapè¿™ä¸ªmapä¸­putAllçš„æ—¶å€™ç©ºæŒ‡é’ˆäº†ã€‚</p>
<p>è€ŒbdIdJobMapåˆå–è‡ªemployeeJobMapThread.get(); é‚£ä¹ˆè¿™ä¸ªemployeeJobMapThreadåˆæ˜¯ä½•ç‰©ï¼Ÿ</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7a90ab3d7ce7464ea281c7ec4c9c9482~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=mUEQtevsu7H%2Fvrz6fgm2xUXhSiw%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>å“¦è±ï¼ŒemployeeJobMapThreadå±…ç„¶æ˜¯ä¸ªInheritableThreadLocalã€‚</p>
<p>æ¢³ç†ä¸€ä¸‹æŠ¥é”™ä»£ç çš„ä¸Šä¸‹æ–‡é€»è¾‘å¦‚ä¸‹ï¼š</p>
<p>1.é¦–å…ˆåœ¨å½“å‰ä¸»çº¿ç¨‹ä¸­å¯¹InheritableThreadLocalç±»å‹å˜é‡employeeJobMapThreadè¿›è¡Œèµ‹å€¼</p>
<p>2.æŠŠè€—æ—¶æ“ä½œæäº¤åˆ°çº¿ç¨‹æ± ä¸­å¼‚æ­¥æ‰§è¡Œï¼Œåœ¨å¼‚æ­¥ä»»åŠ¡ä¸­å»è·å–employeeJobMapThreadçš„å€¼ï¼ˆå…¶ä¸­çº¿ç¨‹æ± é…ç½®çš„coreSize/maxSizeå‡ä¸º4ï¼Œqueueå¤§å°ä¸º3000ï¼‰</p>
<p>3.åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡ŒemployeeJobMapThread.remove()ï¼Œåœ¨å¼‚æ­¥ä»»åŠ¡å®Œæˆä¹‹åæ²¡æœ‰æ‰§è¡ŒemployeeJobMapThread.remove()</p>
<p>4.æœ€ååœ¨å¼‚æ­¥ä»»åŠ¡ä¸­é€šè¿‡employeeJobMapThreadè·å–åˆ°çš„å€¼ä¸ºnullå¯¼è‡´åç»­æ“ä½œç©ºæŒ‡é’ˆ</p>
<p>ï»¿</p>
<h2 data-id="heading-1">æ˜¯å¦å’Œæœ€è¿‘çš„ä¸Šçº¿æœ‰å…³ï¼Ÿ</h2>
<p>ç›¸ä¿¡å¤§å®¶éƒ½æœ‰è¿™æ ·çš„å…±è¯†ï¼šçº¿ä¸Šå‡ºç°æŠ¥é”™ï¼Œé¦–å…ˆæ€€ç–‘æ˜¯å¦å’Œæœ€è¿‘çš„ä¸Šçº¿æœ‰å…³ç³»ã€‚</p>
<p>æˆ‘ä»¬åšçš„ç¬¬ä¸€ä»¶äº‹æƒ…ä¹Ÿæ˜¯æ’æŸ¥äº†è¿‘æœŸçš„ä¸Šçº¿åŠŸèƒ½ï¼Œä»ä¸Šçº¿çš„åŠŸèƒ½ç‚¹å’Œç›¸å…³ä»£ç ä¸Šæ¥çœ‹éƒ½å’Œè¿™æ¬¡æŠ¥é”™çš„ä»£ç æ²¡ä»€ä¹ˆå…³ç³»ï¼Œ</p>
<p>å› æ­¤åˆæ­¥æ’é™¤äº†è¿™ä¸ªåŸå› ã€‚æ‰€ä»¥æ¥ä¸‹æ¥åªèƒ½è¿›ä¸€æ­¥äº†è§£ä»£ç æ¥æ’æŸ¥åŸå› äº†ã€‚</p>
<p>è¦ææ¸…æ¥šå½“å‰æŠ¥é”™çš„æ ¹å› ï¼Œæ¯«æ— ç–‘é—®è‚¯å®šæ˜¯è¦ç¿»è¿‡InheritableThreadLocalè¿™åº§å°å±±å•¦ã€‚</p>
<p>ï»¿</p>
<h2 data-id="heading-2">ç®€å•èŠä¸‹InheritableThreadLocalï¼š</h2>
<p>æèµ·ThreadLocalï¼Œå¤§å®¶åº”è¯¥ç›¸å¯¹éƒ½æ¯”è¾ƒç†Ÿæ‚‰äº†ï¼Œæ¯”å¦‚å­˜æ”¾ç™»å½•ç”¨æˆ·ä¿¡æ¯åˆ°ThreadLocalå˜é‡ä¸­ï¼Œç„¶ååœ¨æ¥å£å±‚å¯ä»¥æ¯”è¾ƒæ–¹ä¾¿çš„è·å–ç™»å½•ç”¨æˆ·ï¼Œå¸®åŠ©å¼€å‘ææ•ˆã€‚</p>
<p>ä½†æ˜¯å¯¹äºInheritableThreadLocalï¼Œæœ‰ä¸å°‘åŒå­¦éƒ½ä¸å¤ªäº†è§£ã€‚</p>
<p>æŒ‘é‡ç‚¹æ¥è¯´ï¼ŒInheritableThreadLocalç›¸æ¯”ThreadLocalå¤šä¸€ä¸ªèƒ½åŠ›ï¼šåœ¨åˆ›å»ºå­çº¿ç¨‹Threadæ—¶ï¼Œå­çº¿ç¨‹Threadä¼šè‡ªåŠ¨ç»§æ‰¿çˆ¶çº¿ç¨‹çš„InheritableThreadLocalä¿¡æ¯åˆ°å­çº¿ç¨‹ä¸­ï¼Œè¿›è€Œå®ç°åœ¨åœ¨å­çº¿ç¨‹è·å–çˆ¶çº¿ç¨‹çš„InheritableThreadLocalå€¼çš„ç›®çš„ã€‚</p>
<p>ä¸¾ä¸ªç®€å•çš„æ —å­å¯¹æ¯”ä¸‹InheritableThreadLocalå’ŒThreadLocalï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">InheritableThreadLocalTest</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> final ThreadLocal&lt;String&gt; threadLocal = <span class="hljs-keyword">new</span> ThreadLocal&lt;&gt;();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> final InheritableThreadLocal&lt;String&gt; inheritableThreadLocal = <span class="hljs-keyword">new</span> InheritableThreadLocal&lt;&gt;();

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> {
        testThreadLocal();
        testInheritableThreadLocal();
    }

    <span class="hljs-comment">/**
     * threadLocalæµ‹è¯•
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testThreadLocal</span>()</span> {
        <span class="hljs-comment">// åœ¨ä¸»çº¿ç¨‹ä¸­è®¾ç½®å€¼åˆ°threadLocal</span>
        threadLocal.<span class="hljs-keyword">set</span>(<span class="hljs-string">"æˆ‘æ˜¯çˆ¶çº¿ç¨‹threadLocalçš„å€¼"</span>);

        <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹å¹¶å¯åŠ¨</span>
        <span class="hljs-keyword">new</span> Thread(() -&gt; {
            <span class="hljs-comment">// åœ¨å­çº¿ç¨‹é‡Œé¢æ— æ³•è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„threadLocalï¼Œç»“æœä¸ºnull</span>
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ä»å­çº¿ç¨‹è·å–åˆ°threadLocalçš„å€¼: "</span> + threadLocal.<span class="hljs-keyword">get</span>());
        }).start();
    }

    <span class="hljs-comment">/**
     * inheritableThreadLocalæµ‹è¯•
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testInheritableThreadLocal</span>()</span> {
        <span class="hljs-comment">// åœ¨ä¸»çº¿ç¨‹ä¸­è®¾ç½®ä¸€ä¸ªå€¼åˆ°inheritableThreadLocal</span>
        inheritableThreadLocal.<span class="hljs-keyword">set</span>(<span class="hljs-string">"æˆ‘æ˜¯çˆ¶çº¿ç¨‹inheritableThreadLocalçš„å€¼"</span>);

        <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹å¹¶å¯åŠ¨</span>
        <span class="hljs-keyword">new</span> Thread(() -&gt; {
            <span class="hljs-comment">// åœ¨å­çº¿ç¨‹é‡Œé¢å¯ä»¥è‡ªåŠ¨è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocal</span>
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ä»å­çº¿ç¨‹è·å–åˆ°inheritableThreadLocalçš„å€¼: "</span> + inheritableThreadLocal.<span class="hljs-keyword">get</span>());
        }).start();
    }

}
</code></pre>
<p>æ‰§è¡Œç»“æœï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a27e0ced731d449a9422895fdee5fa21~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=1hL1sus%2FV6jSF6Bi1VeFiWZ6oN8%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>å¯ä»¥çœ‹åˆ°å­çº¿ç¨‹ä¸­å¯ä»¥è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå€¼ï¼Œä½†ä¸èƒ½è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„threadLocalå€¼ã€‚</p>
<p>ä¸ºä»€ä¹ˆInheritableThreadLocalèƒ½å¤Ÿåšåˆ°è¿™ç‚¹å‘¢ï¼Ÿ</p>
<p>æ˜¯å› ä¸ºåœ¨çˆ¶çº¿ç¨‹åˆ›å»ºå­çº¿ç¨‹Threadçš„æ—¶å€™ï¼ŒThreadçš„æ„é€ å™¨å†…éƒ¨ä¼šè‡ªåŠ¨ç»§æ‰¿çˆ¶çº¿ç¨‹çš„InheritableThreadLocalåˆ°å­çº¿ç¨‹ã€‚</p>
<p>Threadæºç è¿™ä¸¤å¤„åœ°æ–¹è§£é‡Šäº†åŸå› ï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29640a537a864efba81c146cd6d4bdd9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=sBTcTh2NFsxVBa%2BbsOce6IVUnpM%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>initæ–¹æ³•å†…éƒ¨å®ç°ï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/254227b472ae40ec981fd97a27d667d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=Oc8n%2FZtoMYleuxcPSS1t%2BhFN1BA%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>ï»¿</p>
<p>é€šè¿‡è¿™ä¸ªç®€å•çš„ä»‹ç»å¯ä»¥å¸®åŠ©å¯¹äºInheritableThreadLocalä¸äº†è§£çš„åŒå­¦æœ‰ä¸€ä¸ªåˆæ­¥çš„äº†è§£ï¼Œæœ¬æ–‡ä¸æ˜¯ä¸“é—¨ä»‹ç»InheritableThreadLocalçš„æ·±å…¥åŸç†ï¼Œæ‰€ä»¥å°±ä¸å±•å¼€èŠäº†ï¼Œå¤§å®¶æ„Ÿå…´è¶£å¯ä»¥è‡ªå·±è¿›ä¸€æ­¥æ¢ç´¢ã€‚</p>
<h2 data-id="heading-3">éªŒè¯InheritableThreadLocal+çº¿ç¨‹æ± ï¼š</h2>
<p>å‰é¢ä»‹ç»äº†InheritableThreadLocalå¯ä»¥è‡ªåŠ¨æŠŠçˆ¶çº¿ç¨‹çš„InheritableThreadLocalä¿¡æ¯ç»§æ‰¿åˆ°å­çº¿ç¨‹Threadä¸­ã€‚</p>
<p>ä½†æ˜¯åœ¨ä¸šåŠ¡é¡¹ç›®ä¸­çœŸæ­£éœ€è¦ç”¨åˆ°å­çº¿ç¨‹çš„æ—¶å€™æ­£ç»äººè°è‡ªå·±new Threadï¼Œå’±å¯æ˜¯ç”¨çº¿ç¨‹æ± çš„ã€‚</p>
<p>å½“ç„¶äº†ï¼Œå°±åƒæ–‡ç« å¼€å¤´è¯´æ˜çš„ï¼Œè¿™æ¬¡æŠ¥é”™çš„ä»£ç é‡Œé¢ä¹Ÿç”¨çº¿ç¨‹æ± æ¥æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ã€‚</p>
<p>é‚£ä¹ˆInheritableThreadLocal+çº¿ç¨‹æ± çš„ç»„åˆä¼šæ‘©æ“¦å‡ºä»€ä¹ˆæ ·çš„ç«èŠ±å‘¢ï¼Ÿ</p>
<p>æˆ‘æŠŠè¿™æ¬¡æŠ¥é”™çš„ä»£ç ç²¾ç®€ä¹‹åå¾—åˆ°ä¸‹é¢çš„ç¤ºä¾‹ï¼ˆå®é™…ä»£ç ä¸­å¾€InheritableThreadLocalèµ‹çš„å€¼ç±»å‹ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œåé¢ä¼šæåˆ°ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.dada.bd.data.service;

<span class="hljs-keyword">import</span> java.util.concurrent.LinkedBlockingQueue;
<span class="hljs-keyword">import</span> java.util.concurrent.ThreadPoolExecutor;
<span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InheritableThreadLocalWithThreadPoolTest</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> InheritableThreadLocal&lt;String&gt; inheritableThreadLocal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InheritableThreadLocal</span>&lt;&gt;();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ThreadPoolExecutor</span> <span class="hljs-variable">threadPoolExecutor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(
            <span class="hljs-number">2</span>,
            <span class="hljs-number">2</span>,
            <span class="hljs-number">0L</span>,
            TimeUnit.MILLISECONDS,
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;(<span class="hljs-number">3000</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>.CallerRunsPolicy()
    );

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        testInheritableThreadLocalWithThreadPool();
        threadPoolExecutor.shutdown();
    }

    <span class="hljs-comment">/**
     * inheritableThreadLocal+çº¿ç¨‹æ± æµ‹è¯•
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testInheritableThreadLocalWithThreadPool</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// 1. åœ¨ä¸»çº¿ç¨‹ä¸­è®¾ç½®ä¸€ä¸ªå€¼åˆ°inheritableThreadLocal</span>
        inheritableThreadLocal.set(<span class="hljs-string">"æˆ‘æ˜¯çˆ¶çº¿ç¨‹inheritableThreadLocalçš„å€¼"</span>);

        <span class="hljs-comment">// 2. æäº¤å¼‚æ­¥ä»»åŠ¡åˆ°çº¿ç¨‹æ± </span>
        threadPoolExecutor.execute(() -&gt; {
            <span class="hljs-comment">// 3. åœ¨çº¿ç¨‹æ± -å­çº¿ç¨‹é‡Œé¢å¯ä»¥è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå—ï¼Ÿ</span>
            System.out.println(<span class="hljs-string">"ä»çº¿ç¨‹æ± -å­çº¿ç¨‹è·å–åˆ°inheritableThreadLocalçš„å€¼: "</span> + inheritableThreadLocal.get());
        });

        <span class="hljs-comment">// 4. æ¸…é™¤inheritableThreadLocal</span>
        inheritableThreadLocal.remove();
    }

}
</code></pre>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65927ab9fd254ce889a230fadecc03c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=JekI5yxB4la9CisD6N%2Bx4qZ5sII%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>æ‰§è¡Œç»“æœå¦‚å›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°åœ¨çº¿ç¨‹æ± é‡Œé¢ä¹Ÿå¯ä»¥è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå€¼ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥åˆ†æä¸‹InheritableThreadLocal+çº¿ç¨‹æ± çš„æ‰§è¡Œè¿‡ç¨‹ï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d855bd2f3a949e08b221a9a2a80fd00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=PV28SF83kkUQRHLZEiefGOhyI3w%3D" alt="" loading="lazy"/></p>
<p>ï»¿</p>
<p>ä¹Ÿå°±è¯´åªæœ‰åœ¨ä»¥ä¸‹è¿™ä¸¤ä¸ªåœºæ™¯ä¸‹æ‰ä¼šç»§æ‰¿çˆ¶çº¿ç¨‹çš„InheritableThreadLocalï¼š</p>
<p>1.çº¿ç¨‹æ± å½“å‰çº¿ç¨‹æ•° &lt; æ ¸å¿ƒçº¿ç¨‹æ•°</p>
<p>2.çº¿ç¨‹æ± å½“å‰çº¿ç¨‹æ•° &gt;= æ ¸å¿ƒçº¿ç¨‹æ•° &amp;&amp; é˜Ÿåˆ—å·²æ»¡ &amp;&amp; çº¿ç¨‹æ•° &lt; æœ€å¤§çº¿ç¨‹æ•°ï¼ˆæœ¬æ¬¡çº¿ä¸ŠæŠ¥é”™çš„ä»£ç ä½¿ç”¨çš„çº¿ç¨‹æ± è®¾ç½®çš„coreSizeå’ŒmaxSizeä¸€è‡´ï¼Œæ‰€ä»¥èµ°ä¸åˆ°è¯¥åœºæ™¯ï¼‰</p>
<p>å…¶ä»–æƒ…å†µéƒ½æ˜¯åœ¨å¤ç”¨çº¿ç¨‹æ± ç°æœ‰çš„Threadï¼Œè‡ªç„¶ä¹Ÿå°±ä¸ä¼šç»§æ‰¿çˆ¶çº¿ç¨‹çš„InheritableThreadLocalã€‚</p>
<p>æˆ‘ä»¬æäº¤å¤šä¸ªå¼‚æ­¥ä»»åŠ¡åˆ°çº¿ç¨‹æ± æ¥éªŒè¯ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.dada.bd.data.service;

<span class="hljs-keyword">import</span> java.util.concurrent.LinkedBlockingQueue;
<span class="hljs-keyword">import</span> java.util.concurrent.ThreadPoolExecutor;
<span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InheritableThreadLocalWithThreadPoolTest</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> InheritableThreadLocal&lt;String&gt; inheritableThreadLocal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InheritableThreadLocal</span>&lt;&gt;();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ThreadPoolExecutor</span> <span class="hljs-variable">threadPoolExecutor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(
            <span class="hljs-number">2</span>,
            <span class="hljs-number">2</span>,
            <span class="hljs-number">0L</span>,
            TimeUnit.MILLISECONDS,
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;(<span class="hljs-number">3000</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>.CallerRunsPolicy()
    );

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        testInheritableThreadLocalWithThreadPool(<span class="hljs-string">"å¼ ä¸‰"</span>);
        testInheritableThreadLocalWithThreadPool(<span class="hljs-string">"æå››"</span>);
        testInheritableThreadLocalWithThreadPool(<span class="hljs-string">"ç‹äº”"</span>);
        testInheritableThreadLocalWithThreadPool(<span class="hljs-string">"èµµå…­"</span>);
        testInheritableThreadLocalWithThreadPool(<span class="hljs-string">"å­™ä¸ƒ"</span>);
        threadPoolExecutor.shutdown();
    }

    <span class="hljs-comment">/**
     * inheritableThreadLocal+çº¿ç¨‹æ± æµ‹è¯•
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testInheritableThreadLocalWithThreadPool</span><span class="hljs-params">(String param)</span> {
        <span class="hljs-comment">// 1. åœ¨ä¸»çº¿ç¨‹ä¸­è®¾ç½®ä¸€ä¸ªå€¼åˆ°inheritableThreadLocal</span>
        inheritableThreadLocal.set(param);

        <span class="hljs-comment">// 2. æäº¤å¼‚æ­¥ä»»åŠ¡åˆ°çº¿ç¨‹æ± </span>
        threadPoolExecutor.execute(() -&gt; {
            <span class="hljs-comment">// 3. åœ¨çº¿ç¨‹æ± -å­çº¿ç¨‹é‡Œé¢å¯ä»¥è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå—ï¼Ÿ</span>
            System.out.println(<span class="hljs-string">"çº¿ç¨‹å: "</span> + Thread.currentThread().getName() + <span class="hljs-string">", çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå€¼: "</span> + param + <span class="hljs-string">", å­çº¿ç¨‹è·å–åˆ°inheritableThreadLocalçš„å€¼: "</span> + inheritableThreadLocal.get());
        });

        <span class="hljs-comment">// 4. æ¸…é™¤inheritableThreadLocal</span>
        inheritableThreadLocal.remove();
    }

}
</code></pre>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c89ea48a0e742979b98f8b6c0931014~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=9B1N%2F47SLWKdWmw0pLtTvQPkHlU%3D" alt="" loading="lazy"/></p>
<p>ï»¿</p>
<p>æ‰§è¡Œç»“æœç”¨è¡¨æ ¼å½¢å¼å±•ç¤ºå¦‚ä¸‹ï¼š</p>






























<table><thead><tr><th>æ­¥éª¤</th><th>ä½¿ç”¨çº¿ç¨‹æ± </th><th>ç»“æœè§£é‡Šè¯´æ˜</th></tr></thead><tbody><tr><td>æäº¤ç¬¬ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å€¼ä¸ºã€å¼ ä¸‰ã€‘</td><td>åˆ›å»ºThreadï¼špool-1-thread-1</td><td>è‡ªåŠ¨ç»§æ‰¿çˆ¶çº¿ç¨‹çš„InheritableThreadLocalå€¼ã€å¼ ä¸‰ã€‘åˆ°pool-1-thread-1</td></tr><tr><td>æäº¤ç¬¬äºŒä¸ªå¼‚æ­¥ä»»åŠ¡å€¼ä¸ºã€æå››ã€‘</td><td>åˆ›å»ºThreadï¼špool-1-thread-2</td><td>è‡ªåŠ¨ç»§æ‰¿çˆ¶çº¿ç¨‹çš„InheritableThreadLocalå€¼ã€æå››ã€‘åˆ°pool-1-thread-2</td></tr><tr><td>æäº¤ç¬¬ä¸‰ä¸ªå¼‚æ­¥ä»»åŠ¡å€¼ä¸ºã€ç‹äº”ã€‘</td><td>å¤ç”¨Threadï¼špool-1-thread-1</td><td>æ²¡æœ‰è‡ªåŠ¨ç»§æ‰¿çˆ¶çº¿ç¨‹çš„InheritableThreadLocalå€¼ã€ç‹äº”ã€‘ï¼Œæ‰€ä»¥æ‹¿åˆ°äº†ç¬¬ä¸€ä¸ªä»»åŠ¡æäº¤æ—¶Threadç»§æ‰¿ä¸‹æ¥çš„å€¼ã€å¼ ä¸‰ã€‘</td></tr><tr><td>æäº¤ç¬¬å››ä¸ªå¼‚æ­¥ä»»åŠ¡å€¼ä¸ºã€èµµå…­ã€‘</td><td>å¤ç”¨Threadï¼špool-1-thread-2</td><td>æ²¡æœ‰è‡ªåŠ¨ç»§æ‰¿çˆ¶çº¿ç¨‹çš„InheritableThreadLocalå€¼ã€èµµå…­ã€‘ï¼Œæ‰€ä»¥æ‹¿åˆ°äº†ç¬¬ä¸€ä¸ªä»»åŠ¡æäº¤æ—¶Threadç»§æ‰¿ä¸‹æ¥çš„å€¼ã€æå››ã€‘</td></tr></tbody></table>
<p><strong>å¯ä»¥çœ‹åˆ°InheritableThreadLocal+çº¿ç¨‹æ± çš„ç»„åˆï¼Œä¼šé¢ä¸´InheritableThreadLocalæ±¡æŸ“çš„é—®é¢˜ï¼Œå³å¼‚æ­¥ä»»åŠ¡å¯èƒ½å–åˆ°å…¶ä»–çˆ¶çº¿ç¨‹è®¾ç½®çš„InheritableThreadLocalå€¼ã€‚</strong></p>
<p>æœ‰åŒå­¦ä¼šæåˆ°æˆ‘ä»¬ä¸æ˜¯åœ¨ä»£ç é‡Œé¢åŠ äº†inheritableThreadLocal.remove()æ¥æ¸…é™¤inheritableThreadLocalçš„å—ï¼Ÿä¸ºä»€ä¹ˆæ²¡æœ‰æ¸…é™¤æ‰å‘¢ï¼Ÿ</p>
<p>è¿™æ˜¯å› ä¸ºæ­¤æ—¶æˆ‘ä»¬æ¸…é™¤çš„åªæ˜¯çˆ¶çº¿ç¨‹çš„inheritableThreadLocalï¼Œè€Œæ²¡æœ‰æ¸…é™¤å­çº¿ç¨‹çš„inheritableThreadLocalçš„ç¼˜æ•…ã€‚</p>
<p>ï»¿</p>
<h2 data-id="heading-4">ä¸ºä»€ä¹ˆInheritableThreadLocalæ±¡æŸ“å¯¹çº¿ä¸Šæ²¡æœ‰äº§ç”Ÿå½±å“ï¼Ÿ</h2>
<p>æ—¢ç„¶InheritableThreadLocal+çº¿ç¨‹æ± çš„ç»„åˆï¼Œä¼šå­˜åœ¨InheritableThreadLocalæ±¡æŸ“çš„é—®é¢˜ï¼Œé‚£å²‚ä¸æ˜¯çº¿ä¸ŠæŠ¥é”™çš„è¿™æ®µä»£ç ä¹Ÿå­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Ÿ</p>
<p>å†æ¬¡æ£€æŸ¥ä»£ç ï¼Œç¡®è®¤å†å²ä»£ç çš„ç¡®å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œ</p>
<p>ä½†æ˜¯ï¼Œè¿™ä¸ªä»£ç ä¸Šçº¿2å¹´å¤šä¸ºå•¥ä¸€ç›´ç¨³å®šè¿è¡Œä¸”æ²¡æœ‰ç”¨æˆ·åé¦ˆè¿‡åŠŸèƒ½æœ‰é—®é¢˜ï¼Ÿåªæœ‰æœ€è¿‘çªç„¶å‡ºç°æŠ¥é”™ï¼Ÿä¸€æ—¶ä¹‹é—´è„‘è¢‹æ‡µæ‡µçš„ã€‚</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef1c66e8947748688c007ad7de5b3089~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=RWhvCgfynIz91Xgnmv8Ojil9hvE%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>ä»”ç»†æ£€ä»£ç ä¹‹åå‘ç°ï¼š</p>
<p>è¿™æ®µä»£ç åœ¨çˆ¶å­çº¿ç¨‹ä¹‹é—´é€šè¿‡InheritableThreadLocalç±»å‹å˜é‡employeeJobMapThreadä¼ é€’çš„å€¼æ˜¯ã€å…¨é‡çš„&lt;äººå‘˜Id, è¯¥äººå‘˜åŸºæœ¬ä¿¡æ¯&gt;ç»“æ„çš„mapã€‘ï¼Œå¯ä»¥è¿‘ä¹çœ‹åšæ˜¯ä¸€ä¸ªä¸å˜çš„å¸¸é‡ï¼Œæ‰€ä»¥è™½ç„¶å¼‚æ­¥ä»»åŠ¡ä¼šæ‹¿åˆ°æ±¡æŸ“çš„æ•°æ®ï¼Œä¹Ÿæ˜¯æ­£å¸¸å¯ä»¥ç”¨çš„ï¼Œæ²¡æœ‰äº§ç”Ÿä¸šåŠ¡å½±å“ã€‚</p>
<p>è¿™ç§æ„Ÿè§‰æ€ä¹ˆè¯´å‘¢ï¼Œåªèƒ½è¯´æ„Ÿå¹å‰äººçš„æ™ºæ…§ï¼ŒæŠŠå‡ ä¹ä¸å¯èƒ½åšåˆ°äº†å¯èƒ½~</p>
<p>å¥½äº†ï¼Œåˆ°è¿™é‡Œæˆ‘ä»¬è§£é‡Šäº†ä¸ºä»€ä¹ˆè¿™æ®µä»£ç ä¸Šçº¿è¿™ä¹ˆä¹…ä¸€ç›´æ²¡é—®é¢˜ï¼Œ<strong>å› ä¸ºä»£ç ç¡®å®æœ‰InheritableThreadLocalæ±¡æŸ“é—®é¢˜ï¼Œä½†è¢«æ±¡æŸ“äº†ä¹Ÿä¸å½±å“ä½¿ç”¨ã€‚ã€‚ã€‚æ‰€ä»¥ä»æœ€ç»ˆç»“æœæ¥çœ‹ç¡®å®å¯ä»¥æ­£å¸¸è¿è¡Œã€‚</strong></p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b1a0c1c64314867a7a181d04306b3fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=wI8FplIjVejiaiVxWKw%2FTxvOghc%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>ï»¿</p>
<h2 data-id="heading-5">ä»€ä¹ˆåŸå› å¯¼è‡´å­çº¿ç¨‹è·å–åˆ°çš„InheritableThreadLocalå€¼æ˜¯nullï¼Ÿ</h2>
<p>ä½†æ˜¯ã€‚ã€‚ã€‚è¯´äº†è¿™ä¹ˆå¤šï¼Œè¿˜æ˜¯ä¸èƒ½è§£é‡Šä¸ºä»€ä¹ˆçº¿ä¸Šä»£ç è·å–åˆ°çš„inheritableThreadLocalå€¼ä¼šæ˜¯nullã€‚</p>
<p>1.éš¾é“çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå€¼å¯èƒ½ä¼šæ˜¯nullï¼Ÿ</p>
<p>æ£€æŸ¥ä»£ç å‘ç°çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalä¸å¯èƒ½ä¸ºnullï¼Œé¡¶å¤šä¼šæ˜¯ç©ºé›†åˆï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a80e4335b56443fbc540d1c2c701d94~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=OIHRC0xFlp8KPnfvg6yYLTj80TU%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>ï»¿</p>
<p>2.éš¾é“æ˜¯çº¿ç¨‹æ± åˆ›å»ºä¹‹åé€šè¿‡prestartAllCoreThreadsåˆå§‹åŒ–äº†æ ¸å¿ƒçº¿ç¨‹ï¼Œåœ¨æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„æ—¶å€™ï¼Œéƒ½æ˜¯å¤ç”¨çš„å·²æœ‰çº¿ç¨‹å¯¼è‡´çš„ï¼Ÿ</p>
<p>æ£€æŸ¥äº†å¯¹åº”çº¿ç¨‹æ± çš„åˆå§‹åŒ–ä»£ç ï¼Œå‘ç°å¹¶æ²¡æœ‰åˆå§‹åŒ–æ ¸å¿ƒçº¿ç¨‹ï¼Œä¹Ÿæ’é™¤äº†è¿™ä¸ªå¯èƒ½ã€‚è€Œä¸”å¦‚æœçœŸçš„æ˜¯è¯¥åŸå› 22å¹´ä¸Šçº¿ä¹‹ååŠŸèƒ½ä¸€å®šæ˜¯æœ‰é—®é¢˜çš„ï¼Œå‰é¢è¯´è¿‡ï¼Œè¯¥åŠŸèƒ½ä¸Šçº¿ä¹‹åæ²¡äººåé¦ˆè¿‡å¼‚å¸¸ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥æ’é™¤è¯¥åŸå› ã€‚</p>
<p>ï»¿</p>
<p>â€¢è¯¥åŠŸèƒ½22å¹´ä¸Šçº¿ä¹‹é—´2å¹´å¤šä¸€ç›´æ²¡äººåé¦ˆï¼Œå¤§æ¦‚ç‡è¯¥åŠŸèƒ½ä¹‹å‰å¾ˆé•¿æ—¶é—´æ˜¯æ­£å¸¸çš„ï¼Œè¿‘æœŸç”±äºæŸä¸ªåŸå› å¯¼è‡´åŠŸèƒ½å¼‚å¸¸</p>
<p>â€¢è™½ç„¶å†å²ä»£ç çš„ç”¨æ³•å­˜åœ¨å­ä»»åŠ¡ä¸­è·å–åˆ°çš„InheritableThreadLocalè¢«æ±¡æŸ“çš„é—®é¢˜ï¼Œä½†æ˜¯è¢«æ±¡æŸ“çš„å€¼ä¹Ÿèƒ½ç”¨ï¼Œä¸å½±å“æ­£ç¡®æ€§</p>
<p>â€¢åªè¦çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹åˆå§‹åŒ–çš„æ—¶å€™ç»§æ‰¿äº†æ­£ç¡®çš„InheritableThreadLocalå€¼ï¼Œåç»­å°±ä¸ä¼šè¢«æ¸…é™¤æ‰ï¼Œä¹Ÿå°±å¯ä»¥æ­£å¸¸è¿è¡ŒåŠŸèƒ½</p>
<p>ä»è¿™äº›å·²çŸ¥çš„ä¿¡æ¯æ¥æ¨æ–­ï¼Œå¯ä»¥æ¨æ–­å‡ºè¿™æ®µå†å²ä»£ç å†™æ³•è™½ç„¶æœ‰éšæ‚£ï¼Œä½†æ˜¯ä¸æ˜¯å¼•å‘å½“å‰ç©ºæŒ‡é’ˆçš„çš„åŸå› ã€‚</p>
<p>3.å‰©ä¸‹çš„åªæœ‰ä¸€ç§å¯èƒ½ï¼š<strong>å­˜åœ¨çº¿ç¨‹æ± çš„å…±ç”¨ã€‚</strong></p>
<p><strong>åœ¨æ‰§è¡Œè¿™ä¸ªæŠ¥é”™çš„å¼‚æ­¥ä»»åŠ¡çš„æ—¶å€™ï¼Œå¤ç”¨äº†æŸä¸ªå·²æœ‰çš„çº¿ç¨‹Aï¼Œå¹¶ä¸”å½“æ—¶åˆ›å»ºè¯¥çº¿ç¨‹Açš„æ—¶å€™ï¼Œæ²¡æœ‰ç»§æ‰¿InheritableThreadLocalï¼Œè¿›è€Œå¯¼è‡´åé¢å¤ç”¨è¯¥çº¿ç¨‹çš„æ—¶å€™ï¼Œä»InheritableThreadLocalè·å–åˆ°çš„å€¼ä¸ºnullã€‚</strong></p>
<p><strong>è€Œåªè¦æ˜¯é€šè¿‡è¿™æ®µå†å²ä»£ç åˆ›å»ºçš„çº¿ç¨‹ä¸€å®šæ˜¯æ²¡é—®é¢˜çš„ï¼Œæ‰€ä»¥ä¸€å®šæ˜¯å­˜åœ¨å…¶ä»–ä¸šåŠ¡å…±ç”¨äº†è¿™ä¸ªçº¿ç¨‹æ± ï¼Œå¹¶ä¸”è¿™ä¸ªä¸šåŠ¡ä¼˜å…ˆæ‰§è¡Œè¿›è€Œåˆå§‹åŒ–äº†çº¿ç¨‹æ± çš„çº¿ç¨‹ï¼Œå¯¼è‡´çº¿ç¨‹æ± çš„çº¿ç¨‹æ²¡æœ‰ç»§æ‰¿InheritableThreadLocalã€‚</strong></p>
<p>å¦‚ä¸‹ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.dada.bd.data.service;

<span class="hljs-keyword">import</span> java.util.concurrent.LinkedBlockingQueue;
<span class="hljs-keyword">import</span> java.util.concurrent.ThreadPoolExecutor;
<span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InheritableThreadLocalWithThreadPoolTest</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> InheritableThreadLocal&lt;String&gt; inheritableThreadLocal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InheritableThreadLocal</span>&lt;&gt;();
    <span class="hljs-comment">// è¿™é‡Œçº¿ç¨‹æ± core/maxæ•°é‡éƒ½åªæœ‰2</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ThreadPoolExecutor</span> <span class="hljs-variable">threadPoolExecutor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(
            <span class="hljs-number">2</span>,
            <span class="hljs-number">2</span>,
            <span class="hljs-number">0L</span>,
            TimeUnit.MILLISECONDS,
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;(<span class="hljs-number">3000</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>.CallerRunsPolicy()
    );

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// å…ˆæ‰§è¡Œäº†ä¸æ¶‰åŠInheritableThreadLocalçš„å­ä»»åŠ¡åˆå§‹åŒ–çº¿ç¨‹æ± çº¿ç¨‹</span>
        testAnotherFunction();
        testAnotherFunction();
        <span class="hljs-comment">// åæ‰§è¡Œäº†æœ¬æ¬¡çš„å†å²ä»£ç ï¼Œå…¶æ¶‰åŠInheritableThreadLocal</span>
        testInheritableThreadLocalWithThreadPool(<span class="hljs-string">"å¼ ä¸‰"</span>);
        testInheritableThreadLocalWithThreadPool(<span class="hljs-string">"æå››"</span>);
        threadPoolExecutor.shutdown();
    }

    <span class="hljs-comment">/**
     * inheritableThreadLocal+çº¿ç¨‹æ± æµ‹è¯•
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testInheritableThreadLocalWithThreadPool</span><span class="hljs-params">(String param)</span> {
        <span class="hljs-comment">// 1. åœ¨ä¸»çº¿ç¨‹ä¸­è®¾ç½®ä¸€ä¸ªå€¼åˆ°inheritableThreadLocal</span>
        inheritableThreadLocal.set(param);

        <span class="hljs-comment">// 2. æäº¤å¼‚æ­¥ä»»åŠ¡åˆ°çº¿ç¨‹æ± </span>
        threadPoolExecutor.execute(() -&gt; {
            <span class="hljs-comment">// 3. åœ¨çº¿ç¨‹æ± -å­çº¿ç¨‹é‡Œé¢å¯ä»¥è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå—ï¼Ÿ</span>
            System.out.println(<span class="hljs-string">"çº¿ç¨‹å: "</span> + Thread.currentThread().getName() + <span class="hljs-string">", çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå€¼: "</span> + param + <span class="hljs-string">", å­çº¿ç¨‹è·å–åˆ°inheritableThreadLocalçš„å€¼: "</span> + inheritableThreadLocal.get());
        });

        <span class="hljs-comment">// 4. æ¸…é™¤inheritableThreadLocal</span>
        inheritableThreadLocal.remove();
    }

    <span class="hljs-comment">/**
     * æ¨¡æ‹Ÿå¦ä¸€ä¸ªç‹¬ç«‹çš„åŠŸèƒ½
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testAnotherFunction</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æäº¤å¼‚æ­¥ä»»åŠ¡åˆ°çº¿ç¨‹æ± </span>
        threadPoolExecutor.execute(() -&gt; {
            <span class="hljs-comment">// åœ¨çº¿ç¨‹æ± -å­çº¿ç¨‹é‡Œé¢å¯ä»¥è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå—ï¼Ÿ</span>
            System.out.println(<span class="hljs-string">"çº¿ç¨‹å: "</span> + Thread.currentThread().getName() + <span class="hljs-string">", çº¿ç¨‹æ± -å­çº¿ç¨‹æ‘¸ä¸ªé±¼"</span>);
        });
    }

}
</code></pre>
<p>æ‰§è¡Œç»“æœï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dec173b5ceb94d0e9b2682e36554882a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=VKoOVd2tvXKIH2Rbfbr%2FMTM%2Bv%2B8%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>åœ¨é¡¹ç›®é‡Œé¢æœä¸€ä¸‹çœ‹çœ‹ï¼ŒæœçœŸå¦‚æ­¤ï¼Œæœ‰2å‡ºåœ°æ–¹åœ¨ç”¨è¿™ä¸ªçº¿ç¨‹æ± ï¼Œå¹¶ä¸”å¦å¤–çš„ä¸€å¤„ä»£ç ä¸­æäº¤çš„å¼‚æ­¥ä»»åŠ¡ä¸æ¶‰åŠinheritableThreadLocalï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1b7252364dd40c481b0e04bd6072312~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=371YiGglilqaZ8puW6D2WRpgPbQ%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p>
<p>é€»è¾‘æ‰§è¡Œé¡ºåºä¸ºï¼š<strong>åˆ›å»ºçº¿ç¨‹æ±  - æ‰§è¡ŒåŠŸèƒ½A - æ‰§è¡ŒåŠŸèƒ½A - æ‰§è¡ŒåŠŸèƒ½B</strong></p>
<p>å…¶ä¸­ï¼š</p>
<p>åŠŸèƒ½Aå…¨æµç¨‹å‡ä¸æ¶‰åŠInheritableThreadLocal</p>
<p>åŠŸèƒ½Bå¯¹åº”æŠ¥é”™çš„ä»£ç ï¼Œä¸»çº¿ç¨‹è®¾ç½®InheritableThreadLocalå¹¶ä¸”åœ¨å­çº¿ç¨‹ä½¿ç”¨</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f046ff6251fe43288c764d29f334b68e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=LU9oGqcE5yfyvlF9i%2FmxCc9UuK4%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>è‡³æ­¤ï¼Œçº¿ä¸ŠæŠ¥é”™çš„æ ¹å› ç¡®å®šäº†ï¼š<strong>å°±æ˜¯å› ä¸ºInheritableThreadLocal + çº¿ç¨‹æ± å…±ç”¨å¯¼è‡´ã€‚</strong></p>
<p>ï»¿</p>
<p>æ‰©å±•ä¸€ä¸‹ï¼š</p>
<p>å‡å¦‚æ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·å‘¢ï¼š<strong>åˆ›å»ºçº¿ç¨‹æ±  - æ‰§è¡ŒåŠŸèƒ½B - æ‰§è¡ŒåŠŸèƒ½B - æ‰§è¡ŒåŠŸèƒ½A</strong></p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d5962f26cae4b19a6f07e377fadf0b4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=7SQpylxXpoblgFCyH5h4bOzgiTA%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>ç»“å±€å±…ç„¶æ˜¯ä¸€åˆ‡å®‰å¥½ã€‚</p>
<p>ï»¿</p>
<p>å‡å¦‚æ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·å‘¢ï¼š<strong>åˆ›å»ºçº¿ç¨‹æ±  - æ‰§è¡ŒåŠŸèƒ½B - æ‰§è¡ŒåŠŸèƒ½A - æ‰§è¡ŒåŠŸèƒ½B</strong></p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0fd8326d9c354a66a1a0bcc0f5cb14dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=R5vDd%2FKkFxDw9dabEwbESC%2BMlHM%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p><strong>å‘ç°äº†å—ï¼Ÿå¦‚æœåº”ç”¨å¯åŠ¨ä¹‹ååŠŸèƒ½Bå…ˆæ‰§è¡Œå¹¶ä¸”åˆå§‹åŒ–äº†çº¿ç¨‹æ± æ‰€æœ‰æ ¸å¿ƒçº¿ç¨‹ï¼Œé‚£ä¹ˆä¸€åˆ‡æ­£å¸¸ï¼Œå¦åˆ™å°±å¯èƒ½æŠ¥é”™ã€‚</strong></p>
<p><strong>ä¹Ÿå°±æ˜¯è¯´åŠŸèƒ½Bæ˜¯å¦æ­£å¸¸è¿˜çœ‹è¿æ°”çš„ï¼Œè¿æ°”å¥½å°±æ­£å¸¸æ‰§è¡Œï¼Œè¿æ°”ä¸å¥½å°±æŠ¥ç©ºæŒ‡é’ˆçš„é”™ã€‚</strong></p>
<p>ï»¿</p>
<p>è¿™ä½ æ•¢ä¿¡ï¼Ÿ</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f53a48af60c44188eb202b8ef47b72a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=nxqA6HGHqejuSeVLmqFBwKKPDFg%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<h2 data-id="heading-6">å°æ’æ›²ï¼š</h2>
<p>è¿™ä¸ªé—®é¢˜çš„æ’æŸ¥å½“ä¸­è¿˜é‡åˆ°äº†2ä¸ªå°æ’æ›²ï¼š</p>
<p>æ’æ›²1ï¼š</p>
<p>æœ€åˆæ€€ç–‘æ˜¯çº¿ç¨‹æ± å¤ç”¨å¯¼è‡´çš„ï¼Œä½†æ˜¯åœ¨IDEAé‡Œé¢æœä»£ç çš„æ—¶å€™ç²—å¿ƒå¤§æ„æ²¡æœ‰çœ‹åˆ°å…¶ä»–åœ°æ–¹åœ¨å¤ç”¨çº¿ç¨‹æ± ã€‚</p>
<p>å› æ­¤æœŸé—´ä¸€åº¦è‡ªæˆ‘æ€€ç–‘è§é¬¼äº†ï¼Œå¯¼è‡´æœ¬æ¥å¯ä»¥ä¸€ä¸¤ä¸ªå°æ—¶ç¡®å®šæ ¹å› çš„ï¼Œç»“æœé¥¶äº†å¼¯è·¯å¤šèŠ±äº†ä¸¤ä¸ªå°æ—¶æ‰ç¡®å®šæ ¹å› ã€‚</p>
<p>æ‰€ä»¥è¯´<strong>æ’æŸ¥é—®é¢˜çš„æ—¶å€™æ¯ä¸€æ­¥éƒ½è¦ä¿æŒç»†å¿ƒï¼Œå¾—å‡ºçš„æ¯ä¸€ä¸ªç»“è®ºéƒ½åº”è¯¥æ˜¯è¯æ®ç¡®å‡¿ï¼Œç†ç”±å……åˆ†</strong>ï¼Œ</p>
<p>å¦åˆ™ä¼šè®©è‡ªå·±å…œå…œè½¬è½¬æµªè´¹å®è´µçš„æ—¶é—´ã€‚</p>
<p>ï»¿</p>
<p>æ’æ›²2ï¼š</p>
<p>æ’æŸ¥ä»£ç çš„æ—¶å€™å‘ç°å¼‚æ­¥ä»»åŠ¡ä»£ç æ²¡æœ‰åšä»»ä½•çš„å¼‚å¸¸å¤„ç†ï¼Œè¿™å…¶å®æ˜¯å¾ˆå‘çš„ã€‚</p>
<p>æœ‰ç»éªŒçš„åŒå­¦åº”è¯¥çŸ¥é“ï¼Œ<strong>çº¿ç¨‹æ± é‡Œé¢æäº¤å¼‚æ­¥ä»»åŠ¡å¦‚æœæ²¡æœ‰åšå¼‚å¸¸å¤„ç†ï¼Œå‡ºç°å¼‚å¸¸çš„è¯ä¸ä¼šæœ‰ä»»ä½•çš„æ—¥å¿—ä¿¡æ¯ã€‚</strong></p>
<p>æœ¬åœ°è¿è¡Œçš„æ—¶å€™ä¼šæ‰“å°åˆ°æ§åˆ¶å°ï¼Œä½†æ˜¯çº¿ä¸Šæ§åˆ¶å°çš„ä¿¡æ¯å¯ä¸ä¼šè®°å½•åˆ°æ—¥å¿—é‡Œé¢ã€‚</p>
<p>æ‰€ä»¥ç»å¸¸é‡åˆ°å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œç»“æœä¸ç¬¦åˆé¢„æœŸï¼Œä½†æ˜¯çº¿ä¸Šæ²¡æœ‰ä»»ä½•ç›¸å…³æ—¥å¿—å°±æ˜¯è¿™ä¸ªåŸå› ã€‚</p>
<p>æˆ‘ä»¬è¿™é‡Œæœ‰æ—¥å¿—æ˜¯å› ä¸ºä½¿ç”¨çš„çº¿ç¨‹æ± æ˜¯äºŒæ¬¡å°è£…è¿‡çš„ï¼Œé‡Œé¢å¯¹å¼‚æ­¥ä»»åŠ¡åšäº†å…œåº•çš„å¼‚å¸¸è®°å½•ã€‚</p>
<p>ï»¿</p>
<h2 data-id="heading-7">æ€»ç»“ï¼š</h2>
<p>å‰é¢åˆ†æåˆ°äº†å¯¼è‡´ç©ºæŒ‡é’ˆçš„åŸå› æ˜¯çº¿ç¨‹æ± å…±ç”¨å¯¼è‡´çš„è€ä»£ç æŠ¥é”™ï¼Œè€Œå…±ç”¨è¿™ä¸ªçº¿ç¨‹æ± çš„ä»£ç æ˜¯æ–°ä¸Šçº¿çš„åŠŸèƒ½å¼•å…¥çš„ã€‚</p>
<p>è¿™å°±æ‰“è„¸äº†å¼€å¤´æˆ‘ä»¬æ£€æŸ¥äº†ä¸Šçº¿çš„åŠŸèƒ½ä¸æ­¤æ— å…³ï¼Œå®åˆ™æœ‰å…³ã€‚</p>
<p>åªæ˜¯æˆ‘ä»¬è¯„ä¼°å¤ç”¨çº¿ç¨‹æ± çš„å½±å“æ—¶ï¼Œå¾ˆéš¾æƒ³åˆ°ä¼šæœ‰è¿™æ ·çš„å½±å“ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šè€ƒè™‘ï¼š</p>
<p>1.æ˜¯å¦ä¼šå½±å“å…±ç”¨è¯¥çº¿ç¨‹æ± çš„è€åŠŸèƒ½å“åº”æ—¶é—´è¾¹é•¿</p>
<p>2.æ˜¯å¦å­˜åœ¨çˆ¶å­ä»»åŠ¡å…±ç”¨çº¿ç¨‹æ± å¯¼è‡´å¯èƒ½äº§ç”Ÿæ­»é”</p>
<p>é’ˆå¯¹InheritableThreadLocalï¼Œæˆ‘ä¸ªäººçš„å»ºè®®æ˜¯ï¼š</p>
<p>1.InheritableThreadLocalï¼ˆå…¶å®ThreadLocalä¹Ÿä¸€æ ·ï¼‰ä¸é€‚åˆåº”ç”¨äºä¸šåŠ¡ä»£ç ä¸­ï¼Œå› ä¸ºä»–ä»¬éƒ½æ˜¯éšå¼çš„å‚æ•°ä¼ é€’ï¼Œè€Œä¸šåŠ¡ç³»ç»Ÿä¸­å¥½ç»´æŠ¤çš„ä»£ç åº”å½“æ˜¯æ˜¾å¼çš„å‚æ•°ä¼ é€’ï¼ˆæˆ‘ä»¬è¿™ä¸ªçº¿ä¸Šé—®é¢˜å°±é‡‡ç”¨è¯¥æ–¹å¼ï¼‰</p>
<p>2.æ¡†æ¶ç±»ä»£ç æ‰æ˜¯InheritableThreadLocalå’ŒThreadLocalä¸»è¦å‘å…‰å‘çƒ­çš„åœ°æ–¹ï¼Œå› ä¸ºå¯¹åº”çš„ç ”å‘æ°´å¹³é€šå¸¸è¾ƒé«˜ï¼Œä¸”ä»£ç ç»è¿‡ä¸¥æ ¼æµ‹è¯•éªŒè¯ï¼Œå¹¶ä¸”è¾ƒå°‘å˜åŠ¨ã€‚è€Œä¸šåŠ¡ç³»ç»Ÿç ”å‘æ°´å¹³å‚å·®ä¸é½ï¼Œä¸”ç»å¸¸ä¼šå‘ç”ŸåŒæ­¥æ“ä½œå˜å¼‚æ­¥ç­‰</p>
<p>3.è™½ç„¶InheritableThreadLocalä¸å»ºè®®åœ¨ä¸šåŠ¡ä»£ç ä¸­ä½¿ç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯éœ€è¦æŒæ¡å®ƒï¼Œä¸ä¸ºåˆ«çš„ï¼Œåªæœ‰æŒæ¡å®ƒçš„ä¼˜ç¼ºç‚¹æ‰èƒ½å‘Šè¯‰è‡ªå·±å’Œä»–äººä¸ºä»€ä¹ˆåº”è¯¥åœ¨ä¸šåŠ¡ä»£ç ä¸­æ”¾å¼ƒä½¿ç”¨å®ƒ</p>
<p>ï»¿</p>
<p>é’ˆå¯¹å¦‚ä½•æœ‰æ•ˆçš„åº”å¯¹ä¸šåŠ¡ç ”å‘é‡åˆ°çš„ä¸€äº›â€œç–‘éš¾æ‚ç—‡â€ï¼Œæˆ‘çš„å»ºè®®æ˜¯ï¼š</p>
<p>1.å¤§èƒ†æå‡ºåˆç†çš„å‡è®¾ï¼Œå°å¿ƒè°¨æ…è¿›è¡ŒéªŒè¯</p>
<p>2.æ²¡æœ‰å……è¶³ç†ç”±ï¼Œä¸è¦è½»æ˜“ä¸‹ç»“è®º</p>
<p>3.æ²¡æœ‰å¤´ç»ªæ—¶ï¼Œä¼‘æ¯ä¸€ä¸‹ï¼Œæˆ–æ‰¾åˆé€‚çš„äººä¸€èµ·æ¢è®¨ï¼Œç»™è‡ªå·±æ‰“å¼€æ–°çš„æ€è·¯</p>
<p>ï»¿</p>
<p>æœ€åï¼Œæ„¿å¤©ä¸‹æ²¡æœ‰æ•…éšœï¼Œæ²¡æœ‰çº¿ä¸Šé—®é¢˜ï¼Œæ²¡æœ‰bugã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ«å†æ‰‹å†™ URL è§£æå™¨äº†ï¼šPHP 8.5 URI æ‰©å±•è®© URL å¤„ç†æ›´å®‰å…¨ã€æ›´å¹²å‡€]]></title>    <link>https://juejin.cn/post/7595495896134647834</link>    <guid>https://juejin.cn/post/7595495896134647834</guid>    <pubDate>2026-01-15T23:48:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595495896134647834" data-draft-id="7595478717984849929" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ«å†æ‰‹å†™ URL è§£æå™¨äº†ï¼šPHP 8.5 URI æ‰©å±•è®© URL å¤„ç†æ›´å®‰å…¨ã€æ›´å¹²å‡€"/> <meta itemprop="keywords" content="åç«¯,PHP"/> <meta itemprop="datePublished" content="2026-01-15T23:48:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ«å†æ‰‹å†™ URL è§£æå™¨äº†ï¼šPHP 8.5 URI æ‰©å±•è®© URL å¤„ç†æ›´å®‰å…¨ã€æ›´å¹²å‡€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-15T23:48:00.000Z" title="Thu Jan 15 2026 23:48:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åˆ«å†æ‰‹å†™ URL è§£æå™¨äº†ï¼šPHP 8.5 URI æ‰©å±•è®© URL å¤„ç†æ›´å®‰å…¨ã€æ›´å¹²å‡€</h2>
<h3 data-id="heading-1">parse_url() èƒ½ç”¨ï¼Œä½†ä¸å¤Ÿç”¨</h3>
<p>å¤šå¹´æ¥ï¼ŒPHP å¼€å‘è€…å¤„ç† URL çš„æ–¹å¼å¤§åŒå°å¼‚ï¼š</p>
<ul>
<li>ç”¨ <code>parse_url()</code> æ‹†åˆ†å„éƒ¨åˆ†</li>
<li>ç”¨ <code>rawurlencode()</code> / <code>urlencode()</code> è½¬ä¹‰</li>
<li>ç”¨å­—ç¬¦ä¸²æ‹¼æ¥é‡å»ºæœ€ç»ˆ URL</li>
<li>é‡åˆ°"å¥‡æ€ª"è¾“å…¥æ—¶ï¼Œå†ä¸Šå‡ ä¸ªæ­£åˆ™</li>
</ul>
<p>å¤§å¤šæ•°æƒ…å†µä¸‹è¿™å¥—æµç¨‹èƒ½è·‘é€šã€‚é—®é¢˜åœ¨äºï¼ŒURL å¤„ç†æ°æ°æ˜¯é‚£ç§"åœ¨è¾¹è§’æƒ…å†µä¸‹å‡ºé—®é¢˜"çš„é¢†åŸŸï¼šç¼–ç ã€fragmentã€userinfoã€å›½é™…åŒ–åŸŸåã€"ç­‰ä»·ä½†ä¸ç›¸åŒ"çš„ URLï¼Œä»¥åŠå„ç§åªåœ¨ç”Ÿäº§æ—¥å¿—é‡Œæ‰å†’å‡ºæ¥çš„è¾¹ç¼˜åœºæ™¯ã€‚</p>
<p>PHP 8.5 æä¾›äº†ä¸€ä¸ªå†…ç½®æ›¿ä»£æ–¹æ¡ˆï¼šä¸€ä¸ªå§‹ç»ˆå¯ç”¨çš„ URI æ‰©å±•ï¼Œæä¾› API æ¥æŒ‰ç…§ RFC 3986 å’Œ WHATWG URL æ ‡å‡†è§£æã€ä¿®æ”¹ URL/URIã€‚</p>
<p>å¦‚æœ"æ ‡å‡†"äºŒå­—è®©ä½ è§‰å¾—æŠ½è±¡ï¼Œè¿™é‡Œç»™å‡ºå®é™…å«ä¹‰ï¼š</p>
<ul>
<li>æ‹¿åˆ° URI/URL å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ•°ç»„ + å­—ç¬¦ä¸²æ‹¼æ¥ã€‚</li>
<li>ç”¨å®‰å…¨çš„ç»„ä»¶ getter å’Œä¸å¯å˜çš„ <code>with*()</code> æ–¹æ³•ã€‚</li>
<li>ä½ å¯ä»¥é€‰æ‹© RFC 3986 è¡Œä¸ºï¼ˆä¸¥æ ¼ URIï¼Œ"åŸå§‹ vs è§„èŒƒåŒ–è§£ç "ï¼‰æˆ–æµè§ˆå™¨é£æ ¼çš„ WHATWG è¡Œä¸ºï¼ˆUnicode/IDNAã€è½¯é”™è¯¯ã€è‡ªåŠ¨ç¼–ç ï¼‰ã€‚</li>
</ul>
<p>æœ¬æ–‡æ˜¯ä¸€ç¯‡å®æˆ˜æ•™ç¨‹ï¼Œé‡ç‚¹è®²ï¼š</p>
<ul>
<li>ä¸ºä»€ä¹ˆæ‰‹åŠ¨è§£æå®¹æ˜“å‡ºé”™ï¼Œ</li>
<li>æ–° URI å¯¹è±¡æ€ä¹ˆç”¨ï¼Œ</li>
<li>å¦‚ä½•å®‰å…¨åœ°ä¿®æ”¹/è§„èŒƒåŒ–ï¼Œ</li>
<li>åœ¨é‡å®šå‘ã€ç­¾åé“¾æ¥ç­‰å®‰å…¨æ•æ„Ÿåœºæ™¯ä¸‹å¦‚ä½•ä½¿ç”¨ã€‚</li>
</ul>
<p>ä¸è®²å‡çº§æŒ‡å—ï¼Œä¸è®²åºŸå¼ƒæ¸…å•â€”â€”åªè®² URI æ‰©å±•ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2026-01%2Fphp85-uri-extension-safer-cleaner-urls" target="_blank" title="https://catchadmin.com/post/2026-01/php85-uri-extension-safer-cleaner-urls" ref="nofollow noopener noreferrer">åŸæ–‡ åˆ«å†æ‰‹å†™ URL è§£æå™¨äº†ï¼šPHP 8.5 URI æ‰©å±•è®© URL å¤„ç†æ›´å®‰å…¨ã€æ›´å¹²å‡€</a></p>
<h3 data-id="heading-2">æ‰‹åŠ¨ URL è§£æçš„é—®é¢˜</h3>
<h4 data-id="heading-3">parse_url() ä¸è§£ç ï¼ˆè€Œä¸”å¾ˆå®¹æ˜“å¿˜ï¼‰</h4>
<p>PHP çš„ <code>parse_url()</code> è¿”å›å„ç»„ä»¶ï¼Œä½†<strong>ä¸ä¼š</strong> URL è§£ç å®ƒä»¬ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$u</span> = <span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-string">"https://example.com/t%65st?name=Ali%63e#fr%61g"</span>);
<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$u</span>[<span class="hljs-string">'path'</span>]);   <span class="hljs-comment">// "/t%65st"</span>
<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$u</span>[<span class="hljs-string">'query'</span>]);  <span class="hljs-comment">// "name=Ali%63e"</span>
<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$u</span>[<span class="hljs-string">'fragment'</span>]); <span class="hljs-comment">// "fr%61g"</span>
</code></pre>
<p>å¦‚æœä½ åœ¨æ¯”è¾ƒè·¯å¾„æˆ–åº”ç”¨è·¯ç”±è§„åˆ™æ—¶æ²¡æœ‰ç»Ÿä¸€è§£ç /è§„èŒƒåŒ–ï¼Œå¯èƒ½ä¼šæŠŠç­‰ä»·çš„ URI å½“æˆä¸åŒçš„æ¥å¤„ç†ã€‚</p>
<p>æ›´ç³Ÿçš„æ˜¯ï¼šå›¢é˜Ÿå¾€å¾€æ··ç”¨ï¼š</p>
<ul>
<li>æœ‰äº›åœ°æ–¹ç”¨è§£ç åçš„å€¼ï¼Œ</li>
<li>æœ‰äº›åœ°æ–¹ç”¨åŸå§‹å€¼ï¼Œ</li>
<li>å†åŠ ä¸Šæ•£è½åœ¨å„å¤„çš„ä¸´æ—¶è§£ç é€»è¾‘ã€‚</li>
</ul>
<p>è¿™ç§æ··ä¹±å¾ˆå®¹æ˜“åŸ‹ä¸‹éšè”½ bug å’Œå®‰å…¨éšæ‚£ã€‚</p>
<h4 data-id="heading-4">å­—ç¬¦ä¸²æ‹¼æ¥å®¹æ˜“æ‹¼å‡º"å·®ä¸€ç‚¹å¯¹"çš„ URL</h4>
<p>æ‰‹åŠ¨é‡å»º URL å®¹æ˜“çŠ¯çš„é”™ï¼š</p>
<ul>
<li>æ¼æ‰ <code>?</code> æˆ– <code>#</code></li>
<li>é‡å¤ç¼–ç </li>
<li>å®Œå…¨æ²¡ç¼–ç </li>
<li>ç¼–ç é”™äº†ä¸œè¥¿ï¼ˆæ¯”å¦‚æŠŠæ•´ä¸ª query string ç¼–ç è€Œä¸æ˜¯åªç¼–ç  valueï¼‰</li>
<li>ä¸¢å¤±æˆ–æ‰“ä¹±å‚æ•°é¡ºåº</li>
<li>ç©º query/fragment å¤„ç†ä¸å½“</li>
</ul>
<p>ä¸€ä¸ªå¸¸è§çš„"å·®ä¸€ç‚¹å¯¹"å‡½æ•°ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addQueryParam</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$url</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$key</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$value</span></span>): <span class="hljs-title">string</span>
</span>{
    <span class="hljs-variable">$parts</span> = <span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>);
    <span class="hljs-variable">$query</span> = <span class="hljs-variable">$parts</span>[<span class="hljs-string">'query'</span>] ?? <span class="hljs-string">''</span>;
    <span class="hljs-variable">$query</span> .= (<span class="hljs-variable">$query</span> === <span class="hljs-string">''</span> ? <span class="hljs-string">''</span> : <span class="hljs-string">'&amp;'</span>) . <span class="hljs-variable">$key</span> . <span class="hljs-string">'='</span> . <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$value</span>);
    <span class="hljs-variable">$out</span> = <span class="hljs-variable">$parts</span>[<span class="hljs-string">'scheme'</span>] . <span class="hljs-string">'://'</span> . <span class="hljs-variable">$parts</span>[<span class="hljs-string">'host'</span>] . (<span class="hljs-variable">$parts</span>[<span class="hljs-string">'path'</span>] ?? <span class="hljs-string">''</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$query</span> !== <span class="hljs-string">''</span>) {
        <span class="hljs-variable">$out</span> .= <span class="hljs-string">'?'</span> . <span class="hljs-variable">$query</span>;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$parts</span>[<span class="hljs-string">'fragment'</span>])) {
        <span class="hljs-variable">$out</span> .= <span class="hljs-string">'#'</span> . <span class="hljs-variable">$parts</span>[<span class="hljs-string">'fragment'</span>];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$out</span>;
}
</code></pre>
<p>çœ‹èµ·æ¥æ²¡é—®é¢˜ã€‚ç›´åˆ°é‡åˆ°ï¼š</p>
<ul>
<li>æ²¡æœ‰ scheme/host çš„ URLï¼ˆç›¸å¯¹ URLï¼‰ï¼Œ</li>
<li>å¸¦ userinfo/port çš„ URLï¼Œ</li>
<li>å·²ç»ç¼–ç è¿‡çš„å€¼ï¼Œ</li>
<li>éœ€è¦ <code>rawurlencode()</code> è§„åˆ™ï¼ˆRFC 3986ï¼‰çš„å‚æ•°ï¼Œ</li>
<li>åº”è¯¥åŸæ ·ä¿ç•™çš„ fragmentã€‚</li>
</ul>
<h4 data-id="heading-5">ç­‰ä»·çš„ URL ä¸ä¸€å®šæ˜¯ç›¸åŒçš„å­—ç¬¦ä¸²</h4>
<p>ä¸‹é¢è¿™äº›å¯ä»¥æŒ‡å‘åŒä¸€ä¸ªèµ„æºï¼Œä½†å­—ç¬¦ä¸²ä¸åŒï¼š</p>
<ul>
<li>scheme/host å¤§å°å†™ä¸åŒï¼ˆ<code>HTTPS://EXAMPLE.com</code>ï¼‰</li>
<li>path ä¸­ <code>%65</code> vs <code>e</code>ï¼ˆ<code>/t%65st</code> vs <code>/test</code>ï¼‰</li>
<li>path ä¸­çš„ç‚¹å·æ®µï¼ˆ<code>/foo/../bar/</code>ï¼‰</li>
<li>é»˜è®¤ç«¯å£ï¼ˆhttps çš„ <code>:443</code>ï¼‰</li>
</ul>
<p>å¦‚æœä½ æŠŠ URL å½“æˆçº¯å­—ç¬¦ä¸²å¤„ç†ï¼Œè¦ä¹ˆï¼š</p>
<ul>
<li>ç¼“å­˜/è·¯ç”±å‡ºç°è¯¡å¼‚é—®é¢˜ï¼Œ</li>
<li>è¦ä¹ˆå®‰å…¨æ£€æŸ¥è¢«ç»•è¿‡ï¼Œå› ä¸ºä½ æ¯”è¾ƒçš„æ˜¯"é”™è¯¯çš„è¡¨ç¤ºå½¢å¼"ã€‚</li>
</ul>
<h4 data-id="heading-6">IDNAï¼ˆå›½é™…åŒ–åŸŸåï¼‰è¿˜æ¶‰åŠå®‰å…¨é—®é¢˜</h4>
<p>å¦‚æœä½ å…è®¸ç”¨æˆ·æäº¤ URLï¼Œå›½é™…åŒ–åŸŸåå¯èƒ½æ˜¯åˆæ³•çš„â€”â€”ä½†ä¹Ÿå¯èƒ½é€ æˆæ··æ·†ã€‚åŸŸåå¯ä»¥ç”¨ Unicode æˆ– punycodeï¼ˆASCII å½¢å¼ï¼‰è¡¨ç¤ºã€‚RFC è®¨è®ºä¸­æ˜ç¡®æŒ‡å‡ºäººä¸ºé£é™©ï¼špunycode åŸŸååœ¨ Unicode æ¸²æŸ“æ—¶å¯èƒ½çœ‹èµ·æ¥åƒä¸€ä¸ªç†Ÿæ‚‰çš„ã€ä½†å®é™…ä¸åŒçš„åŸŸåã€‚</p>
<p>è¿™ä¸æ˜¯ä½ æƒ³ç”¨æ­£åˆ™"æ‰‹åŠ¨å¤„ç†"ç„¶åç¥ˆç¥·æ²¡é—®é¢˜çš„äº‹ã€‚</p>
<h3 data-id="heading-7">URI æ‰©å±•çš„æ¦‚å¿µï¼šURI å¯¹è±¡ + ä¸¤å¥—æ ‡å‡†</h3>
<p>PHP 8.5 çš„ URI æ‰©å±•æä¾›ä¸¤ä¸ªä¸»è¦ç±»ï¼š</p>
<ul>
<li><code>Uri\Rfc3986\Uri</code>ï¼ˆRFC 3986 åˆè§„ï¼Œä¸¥æ ¼ URI è§„åˆ™ï¼‰</li>
<li><code>Uri\WhatWg\Url</code>ï¼ˆWHATWG URL åˆè§„ï¼Œæµè§ˆå™¨é£æ ¼çš„ URL è§„åˆ™ï¼‰</li>
</ul>
<p>é…å¥—çš„ç±»å‹åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>Uri\InvalidUriException</code></li>
<li><code>Uri\WhatWg\InvalidUrlException</code></li>
<li><code>Uri\WhatWg\UrlValidationError</code> å’Œ <code>UrlValidationErrorType</code></li>
<li><code>Uri\UriComparisonMode</code>ï¼ˆç”¨äºæ¯”è¾ƒï¼‰</li>
</ul>
<p>ä¸€ä¸ªå…³é”®è®¾è®¡å†³ç­–ï¼šä¸¤ä¸ªå®ç°éƒ½æ˜¯ readonly ä¸”ä»¥ä¸å¯å˜æ–¹å¼ä½¿ç”¨â€”â€”<code>withPath()</code>ã€<code>withQuery()</code> ç­‰æ–¹æ³•è¿”å›æ–°å®ä¾‹ã€‚</p>
<p>å¦ä¸€ä¸ªè¦ç‚¹ï¼šè¿™ä¸ªæ‰©å±•åœ¨ PHP 8.5 ä¸­å§‹ç»ˆå¯ç”¨ï¼Œåº•å±‚ç”±ä»¥ä¸‹åº“é©±åŠ¨ï¼š</p>
<ul>
<li>uriparserï¼ˆç”¨äº RFC 3986ï¼‰</li>
<li>Lexborï¼ˆç”¨äº WHATWG URLï¼‰</li>
</ul>
<p>æ‰€ä»¥ä½ ä¸éœ€è¦ç¬¬ä¸‰æ–¹åº“å°±èƒ½è·å¾—åˆç†çš„ URL å¤„ç†èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-8">åˆ›å»ºå’Œè§£æ URIï¼šä»å­—ç¬¦ä¸²åˆ°ç»„ä»¶</h3>
<h4 data-id="heading-9">æœ€ç®€å•çš„æƒ…å†µï¼šè§£æä¸€ä¸ª HTTP URL å¹¶è®¿é—®å„éƒ¨åˆ†</h4>
<p>RFC 3986ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;

<span class="hljs-variable">$uri</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"https://php.net/releases/8.5/en.php"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getScheme</span>(); <span class="hljs-comment">// "https"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getHost</span>();   <span class="hljs-comment">// "php.net"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getPath</span>();   <span class="hljs-comment">// "/releases/8.5/en.php"</span>
</code></pre>
<p>WHATWGï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;

<span class="hljs-variable">$url</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-string">"https://example.com/path?query=1#frag"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getScheme</span>();      <span class="hljs-comment">// "https"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getAsciiHost</span>();   <span class="hljs-comment">// "example.com"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getPath</span>();        <span class="hljs-comment">// "/path"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getQuery</span>();       <span class="hljs-comment">// "query=1"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getFragment</span>();    <span class="hljs-comment">// "frag"</span>
</code></pre>
<p>æ³¨æ„ï¼šWHATWG çš„ getter æ•…æ„ä¸è¿”å›åˆ†éš”ç¬¦ï¼ˆå¦‚ <code>:</code> <code>/</code> <code>?</code> <code>#</code>ï¼‰ã€‚</p>
<h4 data-id="heading-10">æ„é€ å‡½æ•°æŠ›å¼‚å¸¸ï¼›parse() è¿”å› null</h4>
<p>ä¸¤ä¸ªå®ç°éƒ½æ”¯æŒä¸¤ç§è§£æé£æ ¼ï¼š</p>
<ul>
<li>æ„é€ å‡½æ•°ï¼šæ— æ•ˆæ—¶æŠ›å¼‚å¸¸</li>
<li><code>parse()</code>ï¼šæ— æ•ˆæ—¶è¿”å› null</li>
</ul>
<p>RFC 3986 è¡Œä¸ºï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">InvalidUriException</span>;

<span class="hljs-keyword">try</span> {
    <span class="hljs-variable">$uri</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"not a uri"</span>);
} <span class="hljs-keyword">catch</span> (InvalidUriException <span class="hljs-variable">$e</span>) {
    <span class="hljs-comment">// æ‹’ç»è¾“å…¥</span>
}

<span class="hljs-variable">$uri</span> = <span class="hljs-title class_">Uri</span>::<span class="hljs-title function_ invoke__">parse</span>(<span class="hljs-string">"not a uri"</span>);
<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$uri</span>); <span class="hljs-comment">// null</span>
</code></pre>
<p>WHATWG è¡Œä¸ºæä¾›æ›´ä¸°å¯Œçš„é”™è¯¯ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">InvalidUrlException</span>;

<span class="hljs-keyword">try</span> {
    <span class="hljs-variable">$url</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-string">"invalid url"</span>);
} <span class="hljs-keyword">catch</span> (InvalidUrlException <span class="hljs-variable">$e</span>) {
    <span class="hljs-comment">// $e-&gt;errors åŒ…å« UrlValidationError å®ä¾‹</span>
}

<span class="hljs-variable">$errors</span> = [];
<span class="hljs-variable">$url</span> = <span class="hljs-title class_">Url</span>::<span class="hljs-title function_ invoke__">parse</span>(<span class="hljs-string">"invalid url"</span>, <span class="hljs-literal">null</span>, <span class="hljs-variable">$errors</span>);
<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$url</span>);    <span class="hljs-comment">// null</span>
<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$errors</span>); <span class="hljs-comment">// UrlValidationError æ•°ç»„</span>
</code></pre>
<p>è¿™ç§åŒºåˆ†ï¼ˆç¡¬é”™è¯¯ vs è½¯é”™è¯¯ vs parse-and-return-nullï¼‰åœ¨ RFC ä¸­æœ‰è¯¦ç»†è¯´æ˜ã€‚</p>
<h4 data-id="heading-11">Base URL å’Œå¼•ç”¨è§£æï¼ˆç›¸å¯¹ â†’ ç»å¯¹ï¼‰</h4>
<p>æœ‰äº†è¿™ä¸ªåŠŸèƒ½ï¼Œä½ ä¸å†éœ€è¦æ‰‹åŠ¨æ£€æŸ¥æ˜¯å¦ä»¥ <code>/</code> å¼€å¤´ç„¶åæ‹¼æ¥ã€‚</p>
<p>åœ¨æ„é€ å‡½æ•°æˆ– <code>parse()</code> ä¸­ä½¿ç”¨ base URLï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;

<span class="hljs-variable">$base</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"https://example.com"</span>);
<span class="hljs-variable">$uri</span>  = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"/foo"</span>, <span class="hljs-variable">$base</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">toString</span>(); <span class="hljs-comment">// "https://example.com/foo"</span>
</code></pre>
<p>WHATWG ç±»ä¼¼ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;

<span class="hljs-variable">$base</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-string">"https://example.com"</span>);
<span class="hljs-variable">$url</span>  = <span class="hljs-title class_">Url</span>::<span class="hljs-title function_ invoke__">parse</span>(<span class="hljs-string">"/foo"</span>, <span class="hljs-variable">$base</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">toAsciiString</span>(); <span class="hljs-comment">// "https://example.com/foo"</span>
</code></pre>
<p>æ‰©å±•è¿˜æä¾›äº†ä¾¿æ·çš„ <code>resolve()</code> æ–¹æ³•ï¼Œä»¥å½“å‰å¯¹è±¡ä½œä¸º baseã€‚</p>
<h3 data-id="heading-12">å®‰å…¨ä¿®æ”¹ï¼šè®¾ç½®/æ›¿æ¢ pathã€queryã€fragmentï¼ˆä¸å¯å˜ï¼‰</h3>
<p>æ‹¿åˆ°å¯¹è±¡åï¼Œå¯ä»¥ç”¨ <code>with*()</code> æ–¹æ³•ä¿®æ”¹ç»„ä»¶ã€‚è¿™äº›æ–¹æ³•è¿”å›æ–°å®ä¾‹ï¼ŒåŸå¯¹è±¡ä¿æŒä¸å˜ã€‚</p>
<h4 data-id="heading-13">RFC 3986ï¼šwithPath()ã€withQuery()ã€withFragment()</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;

<span class="hljs-variable">$uri</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"https://example.com/products?sort=asc#top"</span>);

<span class="hljs-variable">$updated</span> = <span class="hljs-variable">$uri</span>
    -&gt;<span class="hljs-title function_ invoke__">withPath</span>(<span class="hljs-string">"/products/123"</span>)
    -&gt;<span class="hljs-title function_ invoke__">withQuery</span>(<span class="hljs-string">"sort=desc&amp;ref=home"</span>)
    -&gt;<span class="hljs-title function_ invoke__">withFragment</span>(<span class="hljs-string">"reviews"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">toString</span>();     <span class="hljs-comment">// åŸå¯¹è±¡ä¸å˜</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$updated</span>-&gt;<span class="hljs-title function_ invoke__">toString</span>(); <span class="hljs-comment">// ä¿®æ”¹åçš„</span>
</code></pre>
<p>RFC 3986 æä¾›"åŸå§‹"å’Œ"è§„èŒƒåŒ–è§£ç "ä¸¤ç§ getterï¼ˆä¸‹ä¸€èŠ‚è¯¦è¿°ï¼‰ï¼Œä»¥åŠ <code>toString()</code> å’Œ <code>toRawString()</code> æ–¹æ³•ã€‚</p>
<h4 data-id="heading-14">WHATWGï¼šåŒæ ·çš„æ€è·¯ï¼Œå¤–åŠ  ASCII/Unicode å­—ç¬¦ä¸²è¾“å‡º</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;

<span class="hljs-variable">$url</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-string">"https://example.com/"</span>);

<span class="hljs-variable">$new</span> = <span class="hljs-variable">$url</span>
    -&gt;<span class="hljs-title function_ invoke__">withPath</span>(<span class="hljs-string">"/search"</span>)
    -&gt;<span class="hljs-title function_ invoke__">withQuery</span>(<span class="hljs-string">"q=php+8.5"</span>)
    -&gt;<span class="hljs-title function_ invoke__">withFragment</span>(<span class="hljs-string">"results"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$new</span>-&gt;<span class="hljs-title function_ invoke__">toAsciiString</span>();
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$new</span>-&gt;<span class="hljs-title function_ invoke__">toUnicodeString</span>();
</code></pre>
<p>WHATWG æœ‰ <code>toAsciiString()</code> å’Œ <code>toUnicodeString()</code> ä¸¤ç§è¾“å‡ºï¼Œåˆ†åˆ«ç”¨äºæœºå™¨å¤„ç†å’Œäººç±»å±•ç¤ºã€‚</p>
<h4 data-id="heading-15">ä¸€ä¸ªå°ä½†é‡è¦çš„è¡Œä¸ºï¼šè¾“å…¥ä¸­çš„åˆ†éš”ç¬¦</h4>
<p>ä½¿ç”¨ WHATWG æ—¶ï¼Œå¦‚æœä½ åœ¨è®¾ç½® query/fragment æ—¶ä¸å°å¿ƒåŒ…å«äº† <code>?</code> æˆ– <code>#</code>ï¼Œå®ƒä¼šæŠŠå®ƒä»¬å½“ä½œåˆ†éš”ç¬¦å¹¶å»æ‰ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;

<span class="hljs-variable">$url</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-string">"https://example.com/"</span>);
<span class="hljs-variable">$url</span> = <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">withQuery</span>(<span class="hljs-string">"?foo"</span>);
<span class="hljs-variable">$url</span> = <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">withFragment</span>(<span class="hljs-string">"#bar"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getQuery</span>();    <span class="hljs-comment">// "foo"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getFragment</span>(); <span class="hljs-comment">// "bar"</span>
</code></pre>
<p>è¿™ä¸ªè¡Œä¸ºåœ¨æ–‡æ¡£ä¸­æœ‰æ˜ç¡®è¯´æ˜ã€‚</p>
<h3 data-id="heading-16">è§„èŒƒåŒ–ä¸ç¼–ç ï¼šé¿å…é‡å¤ç¼–ç å’Œ"å¥‡æ€ªå­—ç¬¦"</h3>
<p>URI æ‰©å±•çš„ä»·å€¼ä¸æ­¢äº API è®¾è®¡â€”â€”å®ƒè®©ä½ èƒ½æ§åˆ¶ URL çš„è¡¨ç¤ºå½¢å¼ã€‚</p>
<h4 data-id="heading-17">RFC 3986 ç»™ä½ ä¸¤ç§è¡¨ç¤ºï¼šåŸå§‹ vs è§„èŒƒåŒ–è§£ç </h4>
<p>å¯¹äºå¤§å¤šæ•°ç»„ä»¶ï¼Œ<code>Uri\Rfc3986\Uri</code> æš´éœ²ï¼š</p>
<ul>
<li>rawï¼šè§£æå™¨ç»™å‡ºçš„å½¢å¼ï¼ˆæœ€æ¥è¿‘åŸå§‹è¾“å…¥ï¼‰</li>
<li>è§„èŒƒåŒ–è§£ç ï¼šè§„èŒƒåŒ– + ç™¾åˆ†å·è§£ç ï¼Œæ„åœ¨æˆä¸ºè§„èŒƒå½¢å¼ä¸”å¯å¾€è¿”è½¬æ¢</li>
</ul>
<p>RFC è§£é‡Šäº†ä¸ºä»€ä¹ˆéœ€è¦ä¸¤ç§å½¢å¼ä»¥åŠä½•æ—¶ä½¿ç”¨â€”â€”ç­¾åæ–¹å’Œ API å®¢æˆ·ç«¯é€šå¸¸åå¥½ rawï¼Œè€Œè·¯ç”±/ç¼“å­˜é€šå¸¸åå¥½è§„èŒƒåŒ–è§£ç ã€‚</p>
<p>å…·ä½“æ•ˆæœï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;

<span class="hljs-variable">$uri</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"https://%61pple:p%61ss@ex%61mple.com:433/foob%61r?%61bc=%61bc#%61bc"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getRawHost</span>(); <span class="hljs-comment">// "ex%61mple.com"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getHost</span>();    <span class="hljs-comment">// "example.com"</span>

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getRawPath</span>(); <span class="hljs-comment">// "/foob%61r"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getPath</span>();    <span class="hljs-comment">// "/foobar"</span>

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getRawQuery</span>(); <span class="hljs-comment">// "%61bc=%61bc"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getQuery</span>();    <span class="hljs-comment">// "abc=abc"</span>
</code></pre>
<p>è§„èŒƒåŒ–ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;

<span class="hljs-variable">$uri</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"HTTPS://EXAMPLE.COM/foo/../bar/"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getRawScheme</span>(); <span class="hljs-comment">// "HTTPS"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getScheme</span>();    <span class="hljs-comment">// "https"</span>

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getRawHost</span>(); <span class="hljs-comment">// "EXAMPLE.COM"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getHost</span>();    <span class="hljs-comment">// "example.com"</span>

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getRawPath</span>(); <span class="hljs-comment">// "/foo/../bar/"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getPath</span>();    <span class="hljs-comment">// "/bar/"</span>
</code></pre>
<h4 data-id="heading-18">WHATWG åœ¨ä¿®æ”¹æ—¶è‡ªåŠ¨ç¼–ç æŸäº›å­—ç¬¦</h4>
<p>å¦‚æœä½ è®¾ç½®çš„ path åŒ…å«è¯¥ç»„ä»¶å¿…é¡»ç™¾åˆ†å·ç¼–ç çš„å­—ç¬¦ï¼ŒWHATWG ä¼šè‡ªåŠ¨ç¼–ç ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;

<span class="hljs-variable">$url</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-string">"https://example.com"</span>);
<span class="hljs-variable">$url</span> = <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">withPath</span>(<span class="hljs-string">"/?#:"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getPath</span>(); <span class="hljs-comment">// "/%3F%23:"</span>
</code></pre>
<p>è¿™èƒ½é˜²æ­¢æ„å¤–æ„å»ºå‡ºæŸåçš„ URLã€‚</p>
<h4 data-id="heading-19">"é‡å¤ç¼–ç "é™·é˜±ï¼ˆä»¥åŠæ–° API å¦‚ä½•å¸®å¿™ï¼‰</h4>
<p>é‡å¤ç¼–ç é€šå¸¸è¿™æ ·å‘ç”Ÿï¼š</p>
<ol>
<li>ä½ ç”¨ <code>rawurlencode()</code> ç¼–ç ä¸€ä¸ªå€¼ï¼Œå› ä¸º"å®ƒè¦æ”¾è¿› URL"</li>
<li>ä½ æ‰‹åŠ¨æŠŠå®ƒåŠ åˆ° query string</li>
<li>åæ¥æŸå¤„åˆç¼–ç äº†ä¸€æ¬¡ï¼ˆæ¡†æ¶ã€ä»£ç†ã€å®¢æˆ·ç«¯ï¼‰</li>
</ol>
<p>ä½¿ç”¨ URI å¯¹è±¡ï¼Œä¸€ä¸ªå¥½åšæ³•æ˜¯ï¼š</p>
<ul>
<li>æ•°æ®ä¿æŒä¸ºæ™®é€šå­—ç¬¦ä¸²ï¼ˆæœªç¼–ç ï¼‰</li>
<li>ç”¨ <code>http_build_query()</code> æ„å»º queryï¼ˆæˆ–ä½ åå¥½çš„ç¼–ç å™¨ï¼‰</li>
<li>æŠŠç»“æœä¼ ç»™ <code>withQuery()</code></li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;

<span class="hljs-variable">$base</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"https://example.com/search"</span>);

<span class="hljs-variable">$params</span> = [
    <span class="hljs-string">'q'</span> =&gt; <span class="hljs-string">'php 8.5 uri'</span>,
    <span class="hljs-string">'tag'</span> =&gt; <span class="hljs-string">'url/encoding'</span>,
];

<span class="hljs-comment">// RFC 3986 é£æ ¼ç¼–ç ï¼ˆç©ºæ ¼ç”¨ %20 è€Œé +ï¼‰</span>
<span class="hljs-variable">$query</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">'+'</span>, <span class="hljs-string">'%20'</span>, <span class="hljs-title function_ invoke__">http_build_query</span>(<span class="hljs-variable">$params</span>));

<span class="hljs-variable">$uri</span> = <span class="hljs-variable">$base</span>-&gt;<span class="hljs-title function_ invoke__">withQuery</span>(<span class="hljs-variable">$query</span>);
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">toString</span>();
</code></pre>
<p><code>http_build_query()</code> ä¸ä¸€å®šé€‚åˆæ‰€æœ‰åœºæ™¯ï¼Œä½†å¥½å¤„æ˜¯ç¼–ç è§„åˆ™é›†ä¸­åœ¨ä¸€å¤„ï¼Œè€Œéæ•£è½åœ¨å„ç§å­—ç¬¦ä¸²æ‹¼æ¥é‡Œã€‚</p>
<p>å¦‚æœç¡®å®éœ€è¦å¯¹ path æ®µè¿›è¡Œ RFC 3986 åŸå§‹ç¼–ç ï¼ŒPHP çš„ <code>rawurlencode()</code> éµå¾ª RFC 3986 è§„åˆ™ã€‚</p>
<h3 data-id="heading-20">éªŒè¯ç”¨æˆ·è¾“å…¥çš„ URLï¼šå®ç”¨çš„æœ€ä½è§„åˆ™</h3>
<p>å¦‚æœè¾“å…¥æ¥è‡ªç”¨æˆ·ï¼ˆæˆ–ä¸å¯ä¿¡æ¥æºï¼‰ï¼ŒéªŒè¯åº”è¯¥æœ‰æ˜ç¡®çš„ç«‹åœºã€‚</p>
<p>å¯¹äºä½ æ‰“ç®— fetch æˆ–è·³è½¬çš„ URLï¼Œä¸€ä¸ªåŠ¡å®çš„å®‰å…¨å¯¼å‘æ¨¡å¼ï¼š</p>
<ul>
<li>å¿…é¡»è§£ææˆåŠŸï¼ˆç¡¬é”™è¯¯ç›´æ¥æ‹’ç»ï¼‰</li>
<li>åªå…è®¸ http / https</li>
<li>URL ä¸­ä¸èƒ½æœ‰ç”¨æˆ·å/å¯†ç </li>
<li>åŸŸåç™½åå•ï¼ˆç”¨ ASCII å½¢å¼æ¯”è¾ƒï¼‰</li>
<li>å¯é€‰ï¼šé™åˆ¶ç«¯å£</li>
<li>å¯é€‰ï¼šè¦æ±‚ç»å¯¹ URLï¼ˆæˆ–ç›¸å¯¹ URL åŸºäºå·²çŸ¥ base è§£æï¼‰</li>
</ul>
<h4 data-id="heading-21">ä¸¥æ ¼éªŒè¯ helperï¼ˆWHATWG ç‰ˆæœ¬ï¼‰</h4>
<p>WHATWG é€‚åˆå¤„ç†"æµè§ˆå™¨é£æ ¼"URL å’Œ IDNAã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">InvalidUrlException</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateExternalUrl</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$input</span>, <span class="hljs-keyword">array</span> <span class="hljs-variable">$allowedHosts</span></span>): <span class="hljs-title">Url</span>
</span>{
    <span class="hljs-keyword">try</span> {
        <span class="hljs-variable">$softErrors</span> = [];
        <span class="hljs-variable">$url</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-variable">$input</span>, <span class="hljs-literal">null</span>, <span class="hljs-variable">$softErrors</span>);
    } <span class="hljs-keyword">catch</span> (InvalidUrlException <span class="hljs-variable">$e</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Invalid URL."</span>);
    }

    <span class="hljs-comment">// Scheme ç™½åå•</span>
    <span class="hljs-variable">$scheme</span> = <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getScheme</span>();
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$scheme</span>, [<span class="hljs-string">'http'</span>, <span class="hljs-string">'https'</span>], <span class="hljs-literal">true</span>)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Unsupported scheme."</span>);
    }

    <span class="hljs-comment">// ç¦æ­¢å‡­è¯</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getUsername</span>() !== <span class="hljs-literal">null</span> || <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getPassword</span>() !== <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Credentials in URL are not allowed."</span>);
    }

    <span class="hljs-comment">// Host ç™½åå•ï¼ˆASCII æ¯”è¾ƒï¼‰</span>
    <span class="hljs-variable">$host</span> = <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getAsciiHost</span>();
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$host</span> === <span class="hljs-literal">null</span> || !<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$host</span>), <span class="hljs-variable">$allowedHosts</span>, <span class="hljs-literal">true</span>)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Host not allowed."</span>);
    }

    <span class="hljs-comment">// å¯é€‰ï¼šç«¯å£é™åˆ¶</span>
    <span class="hljs-variable">$port</span> = <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getPort</span>();
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$port</span> !== <span class="hljs-literal">null</span> &amp;&amp; !<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$port</span>, [<span class="hljs-number">80</span>, <span class="hljs-number">443</span>], <span class="hljs-literal">true</span>)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Port not allowed."</span>);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$url</span>;
}
</code></pre>
<p>å‡ ç‚¹è¯´æ˜ï¼š</p>
<ul>
<li><code>Url</code> å³ä½¿è§£ææˆåŠŸä¹Ÿå¯èƒ½è¿”å›è½¯é”™è¯¯ã€‚RFC è§£é‡Šäº†"è½¯ vs ç¡¬"æ¨¡å‹ï¼Œå¹¶ç»™å‡ºäº†è§£æç»§ç»­ä½†æŠ¥å‘ŠéªŒè¯é”™è¯¯çš„ä¾‹å­ã€‚</li>
<li>WHATWG åŒæ—¶æš´éœ² <code>getAsciiHost()</code> å’Œ <code>getUnicodeHost()</code>ï¼›æ¯”è¾ƒé€šå¸¸ç”¨ ASCIIï¼Œå±•ç¤ºç”¨ Unicodeã€‚</li>
</ul>
<h4 data-id="heading-22">RFC 3986 éªŒè¯ï¼šä¸¥æ ¼ URI è§£æ + è§„èŒƒåŒ–é€‰é¡¹</h4>
<p>å¦‚æœä½ åœ¨éªŒè¯é€šç”¨ URIï¼ˆä¸åªæ˜¯ HTTP URLï¼‰ï¼Œæˆ–è€…ä½ å…³å¿ƒ raw vs è§„èŒƒåŒ–è§£ç çš„è¡¨ç¤ºï¼Œ<code>Uri\Rfc3986\Uri</code> æ˜¯ä¸ªå¥½é€‰æ‹©ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">InvalidUriException</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateHttpUri</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$input</span>, <span class="hljs-keyword">array</span> <span class="hljs-variable">$allowedHosts</span></span>): <span class="hljs-title">Uri</span>
</span>{
    <span class="hljs-keyword">try</span> {
        <span class="hljs-variable">$uri</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-variable">$input</span>);
    } <span class="hljs-keyword">catch</span> (InvalidUriException <span class="hljs-variable">$e</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Invalid URI."</span>);
    }

    <span class="hljs-variable">$scheme</span> = <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getScheme</span>();
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$scheme</span>, [<span class="hljs-string">'http'</span>, <span class="hljs-string">'https'</span>], <span class="hljs-literal">true</span>)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Unsupported scheme."</span>);
    }

    <span class="hljs-comment">// Userinfo åœ¨å¤§å¤šæ•° Web åº”ç”¨ä¸­æ˜¯ä¸ªå‘</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getUserInfo</span>() !== <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Userinfo is not allowed."</span>);
    }

    <span class="hljs-variable">$host</span> = <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getHost</span>();
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$host</span> === <span class="hljs-literal">null</span> || !<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$host</span>), <span class="hljs-variable">$allowedHosts</span>, <span class="hljs-literal">true</span>)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Host not allowed."</span>);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$uri</span>;
}
</code></pre>
<h3 data-id="heading-23">å®é™…ç”¨ä¾‹ï¼šç­¾åé“¾æ¥ã€å®‰å…¨é‡å®šå‘ã€è§„èŒƒ URL</h3>
<h4 data-id="heading-24">ç”¨ä¾‹ï¼šç­¾åé“¾æ¥è€Œä¸ç ´åç¼–ç </h4>
<p>ç­¾å URLï¼ˆHMAC tokenã€ä¸´æ—¶è®¿é—®é“¾æ¥ã€CDN è®¤è¯ï¼‰å¯¹è¡¨ç¤ºå½¢å¼æå…¶æ•æ„Ÿã€‚ä¸€ä¸ªå°çš„"è§„èŒƒåŒ–å˜æ›´"å°±èƒ½ä½¿ç­¾åå¤±æ•ˆã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ RFC æ˜ç¡®æŒ‡å‡º"API å®¢æˆ·ç«¯æˆ–ç­¾åæ–¹"é€šå¸¸åå¥½åŸå§‹è¡¨ç¤ºçš„åŸå› ã€‚</p>
<p>ä¸€ä¸ªç®€å•çš„ç­¾å URL æ–¹æ³•ï¼š</p>
<ol>
<li>æ„å»º URL</li>
<li>å¯¹ç¨³å®šçš„å­—ç¬¦ä¸²è¡¨ç¤ºè®¡ç®—ç­¾å</li>
<li>æŠŠç­¾åä½œä¸º query å‚æ•°åŠ è¿›å»</li>
</ol>
<p>ç¤ºä¾‹ï¼Œä½¿ç”¨ RFC 3986 å’Œ <code>toRawString()</code> ç­¾åï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">signUri</span>(<span class="hljs-params">Uri <span class="hljs-variable">$uri</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$secret</span></span>): <span class="hljs-title">Uri</span>
</span>{
    <span class="hljs-comment">// å½“ä½ æƒ³é¿å…æ„å¤–è½¬æ¢æ—¶ï¼Œç”¨ raw string</span>
    <span class="hljs-variable">$baseString</span> = <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">toRawString</span>();
    <span class="hljs-variable">$sig</span> = <span class="hljs-title function_ invoke__">hash_hmac</span>(<span class="hljs-string">'sha256'</span>, <span class="hljs-variable">$baseString</span>, <span class="hljs-variable">$secret</span>);

    <span class="hljs-variable">$query</span> = <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getRawQuery</span>();
    <span class="hljs-variable">$query</span> = <span class="hljs-variable">$query</span> ? <span class="hljs-variable">$query</span> . <span class="hljs-string">'&amp;'</span> : <span class="hljs-string">''</span>;
    <span class="hljs-variable">$query</span> .= <span class="hljs-string">'sig='</span> . <span class="hljs-title function_ invoke__">rawurlencode</span>(<span class="hljs-variable">$sig</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">withQuery</span>(<span class="hljs-variable">$query</span>);
}

<span class="hljs-variable">$uri</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"https://download.example.com/file/%2Fsafe?expires=1736035200"</span>);
<span class="hljs-variable">$signed</span> = <span class="hljs-title function_ invoke__">signUri</span>(<span class="hljs-variable">$uri</span>, <span class="hljs-string">"super-secret-key"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$signed</span>-&gt;<span class="hljs-title function_ invoke__">toRawString</span>();
</code></pre>
<p>ä¸¤ä¸ªè¦ç‚¹ï¼š</p>
<ul>
<li>ä½ æ˜¯æ•…æ„é€‰æ‹© raw çš„ï¼Œå› ä¸ºç­¾åå…³å¿ƒçš„æ˜¯"çº¿ä¸Šå®é™…å‘é€çš„æ˜¯ä»€ä¹ˆ"ã€‚</li>
<li>query æ„å»ºä»ç„¶è¦å°å¿ƒï¼Œé¿å…ç¼–ç é”™è¯¯ã€‚</li>
</ul>
<p>å¦‚æœä½ çš„ç­¾åç®—æ³•éœ€è¦è§„èŒƒå½¢å¼ï¼ˆæœ‰äº›ç¡®å®éœ€è¦ï¼‰ï¼Œå¯ä»¥æ•…æ„å¯¹ <code>toString()</code> ç­¾åâ€”â€”ä½†è¦çŸ¥é“è‡ªå·±åœ¨åšä»€ä¹ˆï¼Œè€Œä¸æ˜¯æ„å¤–è¿™ä¹ˆåšã€‚</p>
<h4 data-id="heading-25">ç”¨ä¾‹ï¼šå®‰å…¨é‡å®šå‘ï¼ˆé¿å…å¼€æ”¾é‡å®šå‘ + è§£ææ··æ·†ï¼‰</h4>
<p>å®‰å…¨é‡å®šå‘é—®é¢˜é€šå¸¸é•¿è¿™æ ·ï¼š</p>
<ol>
<li>ä½ æœ‰ <code>/login?next=&lt;something&gt;</code></li>
<li>ç™»å½•åè·³è½¬åˆ° next</li>
<li>æ”»å‡»è€…å°è¯• <code>next=https://evil.com</code> æˆ–å„ç§å˜ä½“</li>
</ol>
<p>ä¸€ä¸ªå¥å£®çš„æ¨¡å¼æ˜¯ï¼š</p>
<ol>
<li>æŠŠç”¨æˆ·è¾“å…¥è§£æä¸ºç›¸å¯¹ URL æˆ–ç»å¯¹ URL</li>
<li>ç›¸å¯¹ URL åŸºäºä½ è‡ªå·±çš„å·²çŸ¥ base è§£æ</li>
<li>éªŒè¯ host/scheme æ˜¯ä½ çš„ï¼ˆæˆ–åœ¨å…è®¸åˆ—è¡¨ä¸­ï¼‰</li>
</ol>
<p>ä½¿ç”¨ WHATWGï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeRedirectTarget</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$next</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$appBase</span></span>): <span class="hljs-title">string</span>
</span>{
    <span class="hljs-variable">$base</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-variable">$appBase</span>);

    <span class="hljs-comment">// å®‰å…¨è§£æç›¸å¯¹å¼•ç”¨</span>
    <span class="hljs-variable">$errors</span> = [];
    <span class="hljs-variable">$resolved</span> = <span class="hljs-title class_">Url</span>::<span class="hljs-title function_ invoke__">parse</span>(<span class="hljs-variable">$next</span>, <span class="hljs-variable">$base</span>, <span class="hljs-variable">$errors</span>);

    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$resolved</span> === <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$base</span>-&gt;<span class="hljs-title function_ invoke__">toAsciiString</span>(); <span class="hljs-comment">// fallback</span>
    }

    <span class="hljs-comment">// åªå…è®¸åŒ host</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$resolved</span>-&gt;<span class="hljs-title function_ invoke__">getAsciiHost</span>() ?? <span class="hljs-string">''</span>) !== <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$base</span>-&gt;<span class="hljs-title function_ invoke__">getAsciiHost</span>() ?? <span class="hljs-string">''</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$base</span>-&gt;<span class="hljs-title function_ invoke__">toAsciiString</span>();
    }

    <span class="hljs-comment">// åªå…è®¸ http/https</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$resolved</span>-&gt;<span class="hljs-title function_ invoke__">getScheme</span>(), [<span class="hljs-string">'http'</span>, <span class="hljs-string">'https'</span>], <span class="hljs-literal">true</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$base</span>-&gt;<span class="hljs-title function_ invoke__">toAsciiString</span>();
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$resolved</span>-&gt;<span class="hljs-title function_ invoke__">toAsciiString</span>();
}

<span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">safeRedirectTarget</span>(<span class="hljs-string">"/dashboard"</span>, <span class="hljs-string">"https://app.example.com"</span>);
</code></pre>
<p>è¿™é‡Œç”¨åˆ°äº† base URL è§£æå’Œå¼•ç”¨è§£æåŠŸèƒ½ã€‚</p>
<h4 data-id="heading-26">ç”¨ä¾‹ï¼šè§„èŒƒ URLï¼ˆSEO å’Œç¼“å­˜çš„ä¸€è‡´è¡¨ç¤ºï¼‰</h4>
<p>è§„èŒƒåŒ–é€šå¸¸æ„å‘³ç€ï¼š</p>
<ul>
<li>scheme/host å°å†™</li>
<li>ç§»é™¤ path ä¸­çš„ç‚¹å·æ®µ</li>
<li>ç§»é™¤é»˜è®¤ç«¯å£</li>
<li>query ä¿æŒä¸€è‡´ï¼ˆæœ‰æ—¶æ’åºï¼‰</li>
<li>å†³å®šå¦‚ä½•å¤„ç†æœ«å°¾æ–œæ </li>
</ul>
<p>ä½¿ç”¨ <code>Uri\Rfc3986\Uri</code>ï¼Œä½ å·²ç»å¯ä»¥é€šè¿‡ <code>get*()</code> vs <code>getRaw*()</code>ï¼ˆä»¥åŠ <code>toString()</code> vs <code>toRawString()</code>ï¼‰æ¸…æ™°åœ°è·å¾—è§„èŒƒåŒ–è¡Œä¸ºã€‚</p>
<p>ä¸€ä¸ªç®€å•çš„è§„èŒƒåŒ–ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">canonicalizeForCache</span>(<span class="hljs-params">Uri <span class="hljs-variable">$uri</span></span>): <span class="hljs-title">Uri</span>
</span>{
    <span class="hljs-comment">// ä»è§„èŒƒåŒ–è§£ç çš„éƒ¨åˆ†å¼€å§‹</span>
    <span class="hljs-variable">$uri</span> = <span class="hljs-variable">$uri</span>
        -&gt;<span class="hljs-title function_ invoke__">withScheme</span>(<span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getScheme</span>())
        -&gt;<span class="hljs-title function_ invoke__">withHost</span>(<span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getHost</span>())
        -&gt;<span class="hljs-title function_ invoke__">withPath</span>(<span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getPath</span>());

    <span class="hljs-comment">// ä¸ºç¼“å­˜ key æ’åº query å‚æ•°ï¼ˆè¿™æ˜¯ä¸€ç§ç­–ç•¥é€‰æ‹©ï¼‰</span>
    <span class="hljs-variable">$query</span> = <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getQuery</span>();
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$query</span>) {
        <span class="hljs-title function_ invoke__">parse_str</span>(<span class="hljs-variable">$query</span>, <span class="hljs-variable">$params</span>);
        <span class="hljs-title function_ invoke__">ksort</span>(<span class="hljs-variable">$params</span>);
        <span class="hljs-variable">$sorted</span> = <span class="hljs-title function_ invoke__">http_build_query</span>(<span class="hljs-variable">$params</span>, <span class="hljs-string">''</span>, <span class="hljs-string">'&amp;'</span>, PHP_QUERY_RFC3986);
        <span class="hljs-variable">$uri</span> = <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">withQuery</span>(<span class="hljs-variable">$sorted</span>);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$uri</span>;
}

<span class="hljs-variable">$u</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"HTTPS://EXAMPLE.COM/foo/../bar/?b=2&amp;a=1"</span>);
<span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">canonicalizeForCache</span>(<span class="hljs-variable">$u</span>)-&gt;<span class="hljs-title function_ invoke__">toString</span>();
</code></pre>
<p>è¿™ä¸ªå‡½æ•°ä¸è¯•å›¾è¦†ç›–æ‰€æœ‰è§„èŒƒåŒ–ç­–ç•¥ï¼ˆé‚£æ˜¯åº”ç”¨å±‚é¢çš„äº‹ï¼‰ï¼Œä½†ç»“æ„åŒ– API çš„å¥½å¤„æ˜¯ï¼šè§„åˆ™å¯ä»¥æ˜¾å¼æ„å»ºã€å¯ä»¥æµ‹è¯•ã€‚</p>
<h3 data-id="heading-27">ä» parse_url() + å­—ç¬¦ä¸²æ‹¼æ¥è¿ç§»ï¼ˆä¸ç—›è‹¦ï¼‰</h3>
<p>ä½ ä¸éœ€è¦ä¸€æ¬¡æ€§é‡å†™æ‰€æœ‰ä»£ç ã€‚æœ€ç®€å•çš„è¿ç§»è·¯å¾„æ˜¯ï¼š</p>
<p><strong>1. æ‰¾å‡º URL å¤„ç†å¯¹å®‰å…¨æ•æ„Ÿæˆ–å®¹æ˜“å‡º bug çš„åœ°æ–¹ï¼š</strong></p>
<ul>
<li>é‡å®šå‘</li>
<li>webhook éªŒè¯</li>
<li>ç­¾å URL</li>
<li>åŸŸåç™½åå•</li>
<li>è·¯ç”±/ç¼“å­˜ key</li>
</ul>
<p><strong>2. å…ˆæ›¿æ¢è¿™äº›ã€‚</strong></p>
<p><strong>3. çº¯å±•ç¤ºç”¨é€”çš„ç®€å•è§£æï¼Œç­‰åˆ°æœ‰å¿…è¦æ—¶å†å¤„ç†ã€‚</strong></p>
<h4 data-id="heading-28">è¿ç§»å‰ï¼šæ•°ç»„è§£æ + æ‰‹åŠ¨é‡å»º</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$parts</span> = <span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$input</span>);
<span class="hljs-variable">$host</span>  = <span class="hljs-variable">$parts</span>[<span class="hljs-string">'host'</span>] ?? <span class="hljs-literal">null</span>;

<span class="hljs-keyword">if</span> (<span class="hljs-variable">$host</span> !== <span class="hljs-string">'example.com'</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">"Bad host"</span>);
}

<span class="hljs-variable">$newUrl</span> = <span class="hljs-variable">$parts</span>[<span class="hljs-string">'scheme'</span>] . <span class="hljs-string">'://'</span> . <span class="hljs-variable">$parts</span>[<span class="hljs-string">'host'</span>] . <span class="hljs-string">'/new-path'</span>;
</code></pre>
<p>é—®é¢˜ï¼š</p>
<ul>
<li>æ²¡å¤„ç† portã€userinfoã€fragmentã€ç›¸å¯¹ URL</li>
<li>æ²¡æœ‰è§„èŒƒåŒ–</li>
<li>æ²¡æœ‰è§„èŒƒåŒ–é€‰æ‹©</li>
<li>å®¹æ˜“æ„å»ºå‡ºæ— æ•ˆè¾“å‡º</li>
</ul>
<h4 data-id="heading-29">è¿ç§»åï¼šä½¿ç”¨ Url/Uriï¼Œæ”¹åŠ¨å±€éƒ¨åŒ–</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;

<span class="hljs-variable">$url</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-variable">$input</span>);

<span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getAsciiHost</span>() ?? <span class="hljs-string">''</span>) !== <span class="hljs-string">'example.com'</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Bad host"</span>);
}

<span class="hljs-variable">$new</span> = <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">withPath</span>(<span class="hljs-string">'/new-path'</span>);
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$new</span>-&gt;<span class="hljs-title function_ invoke__">toAsciiString</span>();
</code></pre>
<p>ä»£ç æ›´çŸ­ï¼Œæ„å›¾æ›´æ˜ç¡®ï¼Œç»†èŠ‚ä¸Šæ›´éš¾å‡ºé”™ã€‚</p>
<h4 data-id="heading-30">RFC 3986 å’Œ WHATWG æ€ä¹ˆé€‰ï¼ˆç»éªŒæ³•åˆ™ï¼‰</h4>
<p><strong>ä½¿ç”¨ <code>Uri\WhatWg\Url</code> å½“ï¼š</strong></p>
<ul>
<li>ä½ åœ¨å¤„ç†æ¥è‡ªæµè§ˆå™¨/ç”¨æˆ·çš„ HTTP(S) URL</li>
<li>ä½ éœ€è¦ IDNA/Unicode åŸŸåå¤„ç†ï¼ˆ<code>getUnicodeHost()</code> ç”¨äºå±•ç¤ºï¼Œ<code>getAsciiHost()</code> ç”¨äºæ¯”è¾ƒï¼‰</li>
<li>ä½ æƒ³è¦ WHATWG è§£æè¡Œä¸ºå’Œé”™è¯¯æŠ¥å‘Šï¼ˆè½¯é”™è¯¯ï¼‰</li>
</ul>
<p><strong>ä½¿ç”¨ <code>Uri\Rfc3986\Uri</code> å½“ï¼š</strong></p>
<ul>
<li>ä½ åœ¨å¤„ç†"Web URL"ä¹‹å¤–çš„é€šç”¨ URI</li>
<li>ä½ éœ€è¦ raw vs è§„èŒƒåŒ–è§£ç çš„è¡¨ç¤º</li>
<li>ä½ åœ¨åšç­¾åæˆ–åè®®å±‚é¢çš„å·¥ä½œï¼Œè¡¨ç¤ºå½¢å¼å¾ˆé‡è¦</li>
</ul>
<p>RFC æ˜ç¡®åŒºåˆ†äº†è¿™ä¸¤ç§æ–¹æ³•ï¼ŒåŒ…æ‹¬ Unicode/IDNA æ”¯æŒçš„å·®å¼‚ã€‚</p>
<h3 data-id="heading-31">é™„åŠ å†…å®¹ï¼šæ­£ç¡®æ¯”è¾ƒ URLï¼ˆequals() ä»¥åŠä¸ºä»€ä¹ˆæ²¡æœ‰ __toString()ï¼‰</h3>
<p>ä¸€ä¸ªå€¼å¾—ç•™æ„çš„è®¾è®¡ï¼šå†…ç½® URI ç±»æ•…æ„ä¸å®ç° <code>__toString()</code>ï¼Œå› ä¸ºæ¾æ•£æ¯”è¾ƒï¼ˆ<code>==</code>ï¼‰å®¹æ˜“å‡ºé”™ã€‚</p>
<p>å–è€Œä»£ä¹‹ï¼Œä½ ç”¨ <code>equals()</code> æ¯”è¾ƒï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">UriComparisonMode</span>;

<span class="hljs-variable">$u1</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"https://example.COM#foo"</span>);
<span class="hljs-variable">$u2</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"https://EXAMPLE.COM"</span>);

<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$u1</span>-&gt;<span class="hljs-title function_ invoke__">equals</span>(<span class="hljs-variable">$u2</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$u1</span>-&gt;<span class="hljs-title function_ invoke__">equals</span>(<span class="hljs-variable">$u2</span>, <span class="hljs-title class_">UriComparisonMode</span>::<span class="hljs-variable constant_">IncludeFragment</span>)); <span class="hljs-comment">// false</span>
</code></pre>
<p>WHATWG ç±»ä¼¼ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">UriComparisonMode</span>;

<span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-string">"https:////example.COM/"</span>);
<span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-string">"https://EXAMPLE.COM"</span>);

<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$a</span>-&gt;<span class="hljs-title function_ invoke__">equals</span>(<span class="hljs-variable">$b</span>)); <span class="hljs-comment">// true</span>
</code></pre>
<h3 data-id="heading-32">ç»“è®º</h3>
<p>PHP 8.5 çš„ URI æ‰©å±•çœ‹èµ·æ¥æ˜¯ä¸ªå°åŠŸèƒ½ï¼Œç”¨ä¸€æ®µæ—¶é—´åæ‰ä¼šå‘ç°å®ƒæŒ¡æ‰äº†å¤šå°‘ç»†å¾®çš„ URL bugã€‚</p>
<p>æ ¸å¿ƒä»·å€¼åœ¨äº<strong>æ§åˆ¶</strong>ï¼š</p>
<ul>
<li>ä½ å¯ä»¥é€‰æ‹© RFC 3986 vs WHATWG è¯­ä¹‰ã€‚</li>
<li>ä½ å¯ä»¥å†³å®šè¦ raw è¿˜æ˜¯è§„èŒƒåŒ–è§£ç çš„è¡¨ç¤ºã€‚</li>
<li>ä½ å¯ä»¥ä¸å¯å˜ä¸”å®‰å…¨åœ°ä¿®æ”¹ç»„ä»¶ã€‚</li>
<li>ä½ å¯ä»¥ç”¨æ›´éš¾æ„å¤–å‰Šå¼±çš„æ–¹å¼éªŒè¯å’Œæ¯”è¾ƒ URLã€‚</li>
</ul>
<p>å¦‚æœä½ æ›¾ç»å‘å¸ƒè¿‡ä¸€ä¸ª"å¿«é€Ÿ URL ä¿®å¤"ï¼Œåæ¥åœ¨å®‰å…¨æŠ¥å‘Šæˆ–ç”Ÿäº§äº‹æ•…ä¸­çœ‹åˆ°å®ƒï¼Œè¿™ä¸ªæ‰©å±•å€¼å¾—å°½æ—©é‡‡ç”¨â€”â€”ä»é‡å®šå‘å’Œç­¾å URL å¼€å§‹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaç»“åˆå¤§æ¨¡å‹æ–‡ç”Ÿå›¾å®æˆ˜]]></title>    <link>https://juejin.cn/post/7595513077220524078</link>    <guid>https://juejin.cn/post/7595513077220524078</guid>    <pubDate>2026-01-16T06:13:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595513077220524078" data-draft-id="7595619510042181670" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaç»“åˆå¤§æ¨¡å‹æ–‡ç”Ÿå›¾å®æˆ˜"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2026-01-16T06:13:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ä¸­é£˜è¡çš„è®°å¿†"/> <meta itemprop="url" content="https://juejin.cn/user/694547077666606"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaç»“åˆå¤§æ¨¡å‹æ–‡ç”Ÿå›¾å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547077666606/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ä¸­é£˜è¡çš„è®°å¿†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T06:13:45.000Z" title="Fri Jan 16 2026 06:13:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Javaç»“åˆå¤§æ¨¡å‹æ–‡ç”Ÿå›¾å®æˆ˜</p>
<blockquote>
<p><strong>å¯¼è¯»</strong>ï¼šéšç€AIGCæŠ€æœ¯çš„å¿«é€Ÿå‘å±•ï¼Œæ–‡ç”Ÿå›¾å·²æˆä¸ºè½¯ä»¶å¼€å‘ä¸­çš„çƒ­é—¨åŠŸèƒ½ã€‚æœ¬æ–‡å°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œä½¿ç”¨Javaç»“åˆOpenAIçš„DALL-Eæ¨¡å‹ï¼Œæ„å»ºä¸€ä¸ªå®Œæ•´çš„æ–‡ç”Ÿå›¾ç³»ç»Ÿã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€æŠ€æœ¯èƒŒæ™¯ä¸é€‰å‹</h2>
<p>2023å¹´å…¨çƒAIGCå¸‚åœºè§„æ¨¡è¾¾åˆ°150äº¿ç¾å…ƒï¼Œé¢„è®¡2025å¹´å°†çªç ´500äº¿ç¾å…ƒã€‚Javaä½œä¸ºä¼ä¸šçº§å¼€å‘çš„ä¸»åŠ›è¯­è¨€ï¼Œä¸AIå¤§æ¨¡å‹çš„ç»“åˆæ­£æˆä¸ºå¼€å‘è€…å…³æ³¨çš„ç„¦ç‚¹ã€‚</p>
<h2 data-id="heading-1">ä¸ºä»€ä¹ˆé€‰æ‹©OpenAI DALL-Eï¼Ÿ</h2>
<pre><code class="hljs">âœ… æŠ€æœ¯æˆç†Ÿï¼šAPIç¨³å®šï¼Œæ–‡æ¡£å®Œå–„
âœ… æ•ˆæœä¼˜è´¨ï¼šç”Ÿæˆå›¾ç‰‡è´¨é‡é«˜
âœ… é›†æˆä¾¿æ·ï¼šæä¾›å®˜æ–¹Java SDK
âœ… å•†ä¸šå‹å¥½ï¼šæ¸…æ™°çš„å®šä»·æ¨¡å‹
</code></pre>
<h2 data-id="heading-2"><strong>äºŒã€ç³»ç»Ÿæ¶æ„è®¾è®¡</strong></h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1386ab3fc2e54d8b89e8e7231e1eef67~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769148824&amp;x-signature=4mGg5JlUAxHy7AE4eaF8tCb0R%2F0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3"><strong>å…­å±‚æ¶æ„ä½“ç³»</strong>ï¼š</h2>
<pre><code class="hljs">1ï¸âƒ£ è¡¨ç°å±‚ï¼šReact/Vueå‰ç«¯
2ï¸âƒ£Â APIç½‘å…³å±‚ï¼šè®¤è¯æˆæƒã€æµé‡ç®¡ç†
3ï¸âƒ£ åº”ç”¨æœåŠ¡å±‚ï¼šä¸šåŠ¡é€»è¾‘ç¼–æ’
4ï¸âƒ£ ä¸šåŠ¡é€»è¾‘å±‚ï¼šæ ¸å¿ƒç®—æ³•å¤„ç†
5ï¸âƒ£ æ•°æ®å±‚ï¼šMySQL/Redis/MongoDB
6ï¸âƒ£Â AIæœåŠ¡å±‚ï¼šOpenAIÂ DALL-Eè°ƒç”¨
</code></pre>
<h2 data-id="heading-4"><strong>ä¸‰ã€æ ¸å¿ƒä»£ç å®ç°</strong></h2>
<h2 data-id="heading-5">æ ¸å¿ƒä¾èµ–é…ç½®</h2>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
Â  Â Â <span class="hljs-comment">&lt;!-- Spring Boot Webflux --&gt;</span>
Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â  Â  Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â  Â  Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â  Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

Â  Â Â <span class="hljs-comment">&lt;!-- OpenAI Client --&gt;</span>
Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â  Â  Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.theokanning.openai-gpt3-java<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â  Â  Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>service<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â  Â  Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.17.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
Â  Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

Â  Â Â <span class="hljs-comment">&lt;!-- Caffeineç¼“å­˜ --&gt;</span>
Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â  Â  Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.ben-manes.caffeine<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â  Â  Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>caffeine<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â  Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h2 data-id="heading-6"><strong>æ ¸å¿ƒç±»å›¾</strong></h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27d9893693224fbf9d2ada3fa85bdcaf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769148824&amp;x-signature=gJeyeXKTZvrzeN8PaJjqHNC6v8U%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7"><strong>äº”ä¸ªæ ¸å¿ƒç±»</strong>ï¼š</h2>
<pre><code class="hljs">ğŸ”¹ ImageControllerï¼šå¤„ç†HTTPè¯·æ±‚
ğŸ”¹ OpenAiImageServiceï¼šè°ƒç”¨OpenAI API
ğŸ”¹ ImageRequestï¼šè¯·æ±‚å‚æ•°å°è£…
ğŸ”¹ ImageResponseï¼šå“åº”ç»“æœå°è£…
ğŸ”¹ CacheServiceï¼šç¼“å­˜ç®¡ç†
</code></pre>
<h2 data-id="heading-8">æ ¸å¿ƒä»£ç ç¤ºä¾‹</h2>
<h2 data-id="heading-9">ImageRequest - è¯·æ±‚æ¨¡å‹</h2>
<pre><code class="hljs language-arduino" lang="arduino">package com.example.textToImage.model;

<span class="hljs-keyword">import</span> lombok.AllArgsConstructor;
<span class="hljs-keyword">import</span> lombok.Data;
<span class="hljs-keyword">import</span> lombok.NoArgsConstructor;

<span class="hljs-keyword">import</span> javax.validation.constraints.*;

<span class="hljs-comment">/**
 * æ–‡ç”Ÿå›¾è¯·æ±‚å‚æ•°
 */</span>
@Data
@NoArgsConstructor
@AllArgsConstructor
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ImageRequest</span> {

    <span class="hljs-comment">/**
     * æç¤ºè¯
     */</span>
    @<span class="hljs-built_in">NotBlank</span>(message = <span class="hljs-string">"æç¤ºè¯ä¸èƒ½ä¸ºç©º"</span>)
    @<span class="hljs-built_in">Size</span>(max = <span class="hljs-number">1000</span>, message = <span class="hljs-string">"æç¤ºè¯é•¿åº¦ä¸èƒ½è¶…è¿‡1000å­—ç¬¦"</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> prompt;

    <span class="hljs-comment">/**
     * å›¾ç‰‡å°ºå¯¸
     */</span>
    @<span class="hljs-built_in">NotNull</span>(message = <span class="hljs-string">"å›¾ç‰‡å°ºå¯¸ä¸èƒ½ä¸ºç©º"</span>)
    <span class="hljs-keyword">private</span> ImageSize size = ImageSize.S1024X1024;

    <span class="hljs-comment">/**
     * å›¾ç‰‡æ•°é‡
     */</span>
    @<span class="hljs-built_in">Min</span>(value = <span class="hljs-number">1</span>, message = <span class="hljs-string">"å›¾ç‰‡æ•°é‡è‡³å°‘ä¸º1"</span>)
    @<span class="hljs-built_in">Max</span>(value = <span class="hljs-number">10</span>, message = <span class="hljs-string">"å›¾ç‰‡æ•°é‡æœ€å¤šä¸º10"</span>)
    <span class="hljs-keyword">private</span> Integer n = <span class="hljs-number">1</span>;

    <span class="hljs-comment">/**
     * å›¾ç‰‡é£æ ¼
     */</span>
    <span class="hljs-keyword">private</span> ImageStyle style = ImageStyle.VIVID;

    <span class="hljs-comment">/**
     * ç”¨æˆ·IDï¼ˆç”¨äºç¼“å­˜ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> userId;

    <span class="hljs-comment">/**
     * å›¾ç‰‡å°ºå¯¸æšä¸¾
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">ImageSize</span> {
        <span class="hljs-built_in">S256X256</span>(<span class="hljs-string">"256x256"</span>),
        <span class="hljs-built_in">S512X512</span>(<span class="hljs-string">"512x512"</span>),
        <span class="hljs-built_in">S1024X1024</span>(<span class="hljs-string">"1024x1024"</span>);

        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> value;

        <span class="hljs-built_in">ImageSize</span>(<span class="hljs-type">String</span> value) {
            <span class="hljs-keyword">this</span>.value = value;
        }

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-title">getValue</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> value;
        }
    }

    <span class="hljs-comment">/**
     * å›¾ç‰‡é£æ ¼æšä¸¾
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">ImageStyle</span> {
        <span class="hljs-built_in">NATURAL</span>(<span class="hljs-string">"natural"</span>),
        <span class="hljs-built_in">VIVID</span>(<span class="hljs-string">"vivid"</span>);

        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> value;

        <span class="hljs-built_in">ImageStyle</span>(<span class="hljs-type">String</span> value) {
            <span class="hljs-keyword">this</span>.value = value;
        }

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-title">getValue</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> value;
        }
    }
}
</code></pre>
<h2 data-id="heading-10">ImageController - RESTæ¥å£</h2>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">package</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.textToImage</span><span class="hljs-selector-class">.controller</span>;

<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.textToImage</span><span class="hljs-selector-class">.model</span><span class="hljs-selector-class">.ImageRequest</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.textToImage</span><span class="hljs-selector-class">.model</span><span class="hljs-selector-class">.ImageResponse</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.textToImage</span><span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.OpenAiImageService</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">lombok</span><span class="hljs-selector-class">.extern</span><span class="hljs-selector-class">.slf4j</span><span class="hljs-selector-class">.Slf4j</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.beans</span><span class="hljs-selector-class">.factory</span><span class="hljs-selector-class">.annotation</span><span class="hljs-selector-class">.Autowired</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.http</span><span class="hljs-selector-class">.ResponseEntity</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.web</span><span class="hljs-selector-class">.bind</span><span class="hljs-selector-class">.annotation</span>.*;

<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">javax</span><span class="hljs-selector-class">.validation</span><span class="hljs-selector-class">.Valid</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Arrays</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.List</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.concurrent</span><span class="hljs-selector-class">.CompletableFuture</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.stream</span><span class="hljs-selector-class">.Collectors</span>;

<span class="hljs-comment">/**
 * æ–‡ç”Ÿå›¾æ§åˆ¶å™¨
 *
 * æä¾›RESTful APIæ¥å£
 */</span>
@<span class="hljs-selector-tag">Slf4j</span>
@<span class="hljs-selector-tag">RestController</span>
@<span class="hljs-selector-tag">RequestMapping</span>(<span class="hljs-string">"/api/images"</span>)
@<span class="hljs-selector-tag">CrossOrigin</span>(origins = <span class="hljs-string">"*"</span>)
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">ImageController</span> {

    <span class="hljs-variable">@Autowired</span>
    private OpenAiImageService imageService;

    <span class="hljs-comment">/**
     * ç”Ÿæˆå›¾ç‰‡ - åŒæ­¥æ¥å£
     */</span>
    <span class="hljs-variable">@PostMapping</span>
    public ResponseEntity&lt;ImageResponse&gt; <span class="hljs-built_in">generateImage</span>(<span class="hljs-variable">@Valid</span> <span class="hljs-variable">@RequestBody</span> ImageRequest request) {
        <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"æ”¶åˆ°å›¾ç‰‡ç”Ÿæˆè¯·æ±‚: prompt={}, size={}"</span>, request.<span class="hljs-built_in">getPrompt</span>(), request.<span class="hljs-built_in">getSize</span>());

        <span class="hljs-selector-tag">try</span> {
            <span class="hljs-selector-tag">ImageResponse</span> <span class="hljs-selector-tag">response</span> = <span class="hljs-selector-tag">imageService</span><span class="hljs-selector-class">.generateImage</span>(request);

            <span class="hljs-selector-tag">if</span> (response.<span class="hljs-built_in">getSuccess</span>()) {
                <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(response);
            } <span class="hljs-selector-tag">else</span> {
                <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.internalServerError</span>()<span class="hljs-selector-class">.body</span>(response);
            }
        } <span class="hljs-selector-tag">catch</span> (Exception e) {
            <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.error</span>(<span class="hljs-string">"å›¾ç‰‡ç”Ÿæˆè¯·æ±‚å¤„ç†å¤±è´¥"</span>, e);
            <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.internalServerError</span>()
                    <span class="hljs-selector-class">.body</span>(ImageResponse.<span class="hljs-built_in">builder</span>()
                            .<span class="hljs-built_in">error</span>(e.<span class="hljs-built_in">getMessage</span>())
                            .<span class="hljs-built_in">success</span>(false)
                            .<span class="hljs-built_in">build</span>());
        }
    }

    <span class="hljs-comment">/**
     * ç”Ÿæˆå›¾ç‰‡ - å¼‚æ­¥æ¥å£
     */</span>
    @<span class="hljs-selector-tag">PostMapping</span>(<span class="hljs-string">"/async"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">CompletableFuture</span>&lt;<span class="hljs-selector-tag">ResponseEntity</span>&lt;<span class="hljs-selector-tag">ImageResponse</span>&gt;&gt; <span class="hljs-selector-tag">generateImageAsync</span>(<span class="hljs-variable">@Valid</span> <span class="hljs-variable">@RequestBody</span> ImageRequest request) {
        <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"æ”¶åˆ°å¼‚æ­¥å›¾ç‰‡ç”Ÿæˆè¯·æ±‚: prompt={}"</span>, request.<span class="hljs-built_in">getPrompt</span>());

        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">CompletableFuture</span><span class="hljs-selector-class">.supplyAsync</span>(() -&gt; {
            <span class="hljs-selector-tag">try</span> {
                <span class="hljs-selector-tag">ImageResponse</span> <span class="hljs-selector-tag">response</span> = <span class="hljs-selector-tag">imageService</span><span class="hljs-selector-class">.generateImage</span>(request);

                <span class="hljs-selector-tag">if</span> (response.<span class="hljs-built_in">getSuccess</span>()) {
                    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(response);
                } <span class="hljs-selector-tag">else</span> {
                    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.internalServerError</span>()<span class="hljs-selector-class">.body</span>(response);
                }
            } <span class="hljs-selector-tag">catch</span> (Exception e) {
                <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.error</span>(<span class="hljs-string">"å¼‚æ­¥å›¾ç‰‡ç”Ÿæˆè¯·æ±‚å¤„ç†å¤±è´¥"</span>, e);
                <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.internalServerError</span>()
                        <span class="hljs-selector-class">.body</span>(ImageResponse.<span class="hljs-built_in">builder</span>()
                                .<span class="hljs-built_in">error</span>(e.<span class="hljs-built_in">getMessage</span>())
                                .<span class="hljs-built_in">success</span>(false)
                                .<span class="hljs-built_in">build</span>());
            }
        });
    }

    <span class="hljs-comment">/**
     * æ‰¹é‡ç”Ÿæˆå›¾ç‰‡
     */</span>
    @<span class="hljs-selector-tag">PostMapping</span>(<span class="hljs-string">"/batch"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">CompletableFuture</span>&lt;<span class="hljs-selector-tag">ResponseEntity</span>&lt;<span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">ImageResponse</span>&gt;&gt;&gt; <span class="hljs-selector-tag">generateImages</span>(
            <span class="hljs-variable">@Valid</span> <span class="hljs-variable">@RequestBody</span> List&lt;ImageRequest&gt; requests) {

        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">CompletableFuture</span><span class="hljs-selector-class">.supplyAsync</span>(() -&gt; {
            <span class="hljs-selector-tag">try</span> {
                <span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">ImageResponse</span>&gt; <span class="hljs-selector-tag">responses</span> = <span class="hljs-selector-tag">requests</span><span class="hljs-selector-class">.stream</span>()
                        <span class="hljs-selector-class">.map</span>(<span class="hljs-attribute">imageService</span>::generateImage)
                        <span class="hljs-selector-class">.collect</span>(Collectors.<span class="hljs-built_in">toList</span>());

                <span class="hljs-selector-tag">boolean</span> <span class="hljs-selector-tag">allSuccess</span> = <span class="hljs-selector-tag">responses</span><span class="hljs-selector-class">.stream</span>()<span class="hljs-selector-class">.allMatch</span>(<span class="hljs-attribute">ImageResponse</span>::getSuccess);

                <span class="hljs-selector-tag">if</span> (allSuccess) {
                    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(responses);
                } <span class="hljs-selector-tag">else</span> {
                    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.internalServerError</span>()<span class="hljs-selector-class">.body</span>(responses);
                }
            } <span class="hljs-selector-tag">catch</span> (Exception e) {
                <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.error</span>(<span class="hljs-string">"æ‰¹é‡å›¾ç‰‡ç”Ÿæˆè¯·æ±‚å¤„ç†å¤±è´¥"</span>, e);
                <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.internalServerError</span>()
                        <span class="hljs-selector-class">.body</span>(Arrays.<span class="hljs-built_in">asList</span>(ImageResponse.<span class="hljs-built_in">builder</span>()
                                .<span class="hljs-built_in">error</span>(e.<span class="hljs-built_in">getMessage</span>())
                                .<span class="hljs-built_in">success</span>(false)
                                .<span class="hljs-built_in">build</span>()));
            }
        });
    }

    <span class="hljs-comment">/**
     * ç”Ÿæˆç¤ºä¾‹å›¾ç‰‡
     */</span>
    @<span class="hljs-selector-tag">GetMapping</span>(<span class="hljs-string">"/examples"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">ResponseEntity</span>&lt;<span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">ImageRequest</span>&gt;&gt; <span class="hljs-selector-tag">getExampleRequests</span>() {
        <span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">ImageRequest</span>&gt; <span class="hljs-selector-tag">examples</span> = <span class="hljs-selector-tag">Arrays</span><span class="hljs-selector-class">.asList</span>(
                <span class="hljs-built_in">createExampleRequest</span>(<span class="hljs-string">"ä¸€åªå¯çˆ±çš„å¡é€šçŒ«ï¼Œååœ¨èŠ±å›­é‡Œï¼Œé˜³å…‰æ˜åªš"</span>, ImageRequest.ImageSize.S1024X1024, <span class="hljs-number">1</span>, ImageRequest.ImageStyle.VIVID),
                <span class="hljs-built_in">createExampleRequest</span>(<span class="hljs-string">"ç°ä»£åŸå¸‚å¤©é™…çº¿ï¼Œå¤œæ™šï¼Œéœ“è™¹ç¯"</span>, ImageRequest.ImageSize.S1024X1024, <span class="hljs-number">1</span>, ImageRequest.ImageStyle.NATURAL),
                <span class="hljs-built_in">createExampleRequest</span>(<span class="hljs-string">"æŠ½è±¡è‰ºæœ¯ï¼Œå½©è‰²å‡ ä½•å½¢çŠ¶"</span>, ImageRequest.ImageSize.S512X512, <span class="hljs-number">2</span>, ImageRequest.ImageStyle.VIVID)
        );

        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(examples);
    }

    <span class="hljs-comment">/**
     * æ£€æŸ¥æœåŠ¡çŠ¶æ€
     */</span>
    @<span class="hljs-selector-tag">GetMapping</span>(<span class="hljs-string">"/health"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">ResponseEntity</span>&lt;<span class="hljs-selector-tag">String</span>&gt; <span class="hljs-selector-tag">healthCheck</span>() {
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(<span class="hljs-string">"Image Generation Service is running"</span>);
    }

    <span class="hljs-comment">/**
     * åˆ›å»ºè¯·æ±‚
     */</span>
    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">ImageRequest</span> <span class="hljs-selector-tag">createExampleRequest</span>(String prompt, ImageRequest.ImageSize size, int n, ImageRequest.ImageStyle style) {
        <span class="hljs-selector-tag">ImageRequest</span> <span class="hljs-selector-tag">request</span> = <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">ImageRequest</span>();
        <span class="hljs-selector-tag">request</span><span class="hljs-selector-class">.setPrompt</span>(prompt);
        <span class="hljs-selector-tag">request</span><span class="hljs-selector-class">.setSize</span>(size);
        <span class="hljs-selector-tag">request</span><span class="hljs-selector-class">.setN</span>(n);
        <span class="hljs-selector-tag">request</span><span class="hljs-selector-class">.setStyle</span>(style);
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">request</span>;
    }
}
</code></pre>
<h2 data-id="heading-11"><strong>OpenAiImageService</strong></h2>
<pre><code class="hljs language-scss" lang="scss">package com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.textToImage</span><span class="hljs-selector-class">.service</span>;

import com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.textToImage</span><span class="hljs-selector-class">.model</span><span class="hljs-selector-class">.ApiKeyConfig</span>;
import com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.textToImage</span><span class="hljs-selector-class">.model</span><span class="hljs-selector-class">.ImageRequest</span>;
import com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.textToImage</span><span class="hljs-selector-class">.model</span><span class="hljs-selector-class">.ImageResponse</span>;
import com<span class="hljs-selector-class">.theokanning</span><span class="hljs-selector-class">.openai</span><span class="hljs-selector-class">.image</span><span class="hljs-selector-class">.CreateImageRequest</span>;
import com<span class="hljs-selector-class">.theokanning</span><span class="hljs-selector-class">.openai</span><span class="hljs-selector-class">.image</span><span class="hljs-selector-class">.ImageResult</span>;
import com<span class="hljs-selector-class">.theokanning</span><span class="hljs-selector-class">.openai</span><span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.OpenAiService</span>;
import lombok<span class="hljs-selector-class">.extern</span><span class="hljs-selector-class">.slf4j</span><span class="hljs-selector-class">.Slf4j</span>;
import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.beans</span><span class="hljs-selector-class">.factory</span><span class="hljs-selector-class">.annotation</span><span class="hljs-selector-class">.Autowired</span>;
import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.cache</span><span class="hljs-selector-class">.annotation</span><span class="hljs-selector-class">.Cacheable</span>;
import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.stereotype</span><span class="hljs-selector-class">.Service</span>;

import java<span class="hljs-selector-class">.time</span><span class="hljs-selector-class">.Duration</span>;
import java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Arrays</span>;
import java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Collections</span>;
import java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.List</span>;
import java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.UUID</span>;
import java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.stream</span><span class="hljs-selector-class">.Collectors</span>;

<span class="hljs-comment">/**
 * OpenAIæ–‡ç”Ÿå›¾æœåŠ¡å®ç°
 *
 * ä½¿ç”¨DALL-E 3/2æ¨¡å‹ç”Ÿæˆå›¾ç‰‡
 * æ”¯æŒå¤šç§å‚æ•°é…ç½®
 */</span>
<span class="hljs-keyword">@Slf</span>4j
<span class="hljs-keyword">@Service</span>
public class OpenAiImageService {

    <span class="hljs-keyword">@Autowired</span>
    private ApiKeyConfig apiKeyConfig;

    <span class="hljs-comment">/**
     * ç”Ÿæˆå›¾ç‰‡
     */</span>
    <span class="hljs-keyword">@Cacheable</span>(value = <span class="hljs-string">"images"</span>, key = <span class="hljs-string">"#request.prompt + '_' + #request.size + '_' + #request.style"</span>)
    public ImageResponse generateImage(ImageRequest request) {
        long startTime = System<span class="hljs-selector-class">.currentTimeMillis</span>();
        String requestId = UUID<span class="hljs-selector-class">.randomUUID</span>()<span class="hljs-selector-class">.toString</span>();

        try {
            <span class="hljs-comment">// åˆ›å»ºOpenAIæœåŠ¡</span>
            OpenAiService service = <span class="hljs-built_in">createOpenAiService</span>();

            <span class="hljs-comment">// æ„å»ºè¯·æ±‚å‚æ•°</span>
            CreateImageRequest imageRequest = <span class="hljs-built_in">buildCreateImageRequest</span>(request);

            <span class="hljs-comment">// è°ƒç”¨APIç”Ÿæˆå›¾ç‰‡</span>
            ImageResult result = service<span class="hljs-selector-class">.createImage</span>(imageRequest);

            <span class="hljs-comment">// æ„å»ºå“åº”</span>
            ImageResponse response = <span class="hljs-built_in">buildResponse</span>(request, requestId, result, startTime);

            log<span class="hljs-selector-class">.info</span>("å›¾ç‰‡ç”ŸæˆæˆåŠŸ: requestId={}, prompt={}", requestId, request.getPrompt());
            return response;

        } catch (Exception e) {
            log<span class="hljs-selector-class">.error</span>("å›¾ç‰‡ç”Ÿæˆå¤±è´¥: requestId={}, prompt={}", requestId, request.getPrompt(), e);
            return <span class="hljs-built_in">buildErrorResponse</span>(requestId, e.getMessage(), startTime);
        }
    }

    <span class="hljs-comment">/**
     * åˆ›å»ºOpenAIæœåŠ¡
     */</span>
    private OpenAiService <span class="hljs-built_in">createOpenAiService</span>() {
        if (apiKeyConfig.getUseProxy() &amp;&amp; apiKeyConfig<span class="hljs-selector-class">.getProxy</span>() != null) {
            <span class="hljs-comment">// ä»£ç†é…ç½®ï¼ˆç¤ºä¾‹ï¼‰</span>
            return new <span class="hljs-built_in">OpenAiService</span>(apiKeyConfig.getOpenaiKey(), Duration<span class="hljs-selector-class">.ofSeconds</span>(apiKeyConfig.getTimeout()));
        } else {
            <span class="hljs-comment">// ç›´æ¥è¿æ¥</span>
            return new <span class="hljs-built_in">OpenAiService</span>(apiKeyConfig.getOpenaiKey(), Duration<span class="hljs-selector-class">.ofSeconds</span>(apiKeyConfig.getTimeout()));
        }
    }

    <span class="hljs-comment">/**
     * æ„å»ºå›¾ç‰‡è¯·æ±‚
     */</span>
    private CreateImageRequest <span class="hljs-built_in">buildCreateImageRequest</span>(ImageRequest request) {
        return CreateImageRequest<span class="hljs-selector-class">.builder</span>()
                <span class="hljs-selector-class">.prompt</span>(request.getPrompt())
                <span class="hljs-selector-class">.n</span>(request.getN())
                <span class="hljs-selector-class">.size</span>(request.getSize()<span class="hljs-selector-class">.getValue</span>())
                <span class="hljs-selector-class">.responseFormat</span>("url")
                <span class="hljs-selector-class">.user</span>(request.getUserId() != null ? request<span class="hljs-selector-class">.getUserId</span>() : <span class="hljs-string">"anonymous"</span>)
                .<span class="hljs-built_in">build</span>();
    }

    <span class="hljs-comment">/**
     * æ„å»ºæˆåŠŸå“åº”
     */</span>
    private ImageResponse <span class="hljs-built_in">buildResponse</span>(ImageRequest request, String requestId,
                                       ImageResult result, long startTime) {
        List&lt;String&gt; urls = Arrays<span class="hljs-selector-class">.asList</span>(result.getData()<span class="hljs-selector-class">.stream</span>()
                <span class="hljs-selector-class">.map</span>(image -&gt; image.getUrl())
                <span class="hljs-selector-class">.toArray</span>(String[]::new));

        List&lt;String&gt; imageIds = Collections<span class="hljs-selector-class">.emptyList</span>(); <span class="hljs-comment">// æš‚æ—¶ä½¿ç”¨ç©ºåˆ—è¡¨</span>

        return ImageResponse<span class="hljs-selector-class">.builder</span>()
                <span class="hljs-selector-class">.requestId</span>(requestId)
                <span class="hljs-selector-class">.prompt</span>(request.getPrompt())
                <span class="hljs-selector-class">.createdAt</span>(java.time.LocalDateTime.now())
                <span class="hljs-selector-class">.urls</span>(urls)
                <span class="hljs-selector-class">.imageIds</span>(imageIds)
                <span class="hljs-selector-class">.duration</span>(System.currentTimeMillis() - startTime)
                <span class="hljs-selector-class">.success</span>(true)
                <span class="hljs-selector-class">.build</span>();
    }

    <span class="hljs-comment">/**
     * æ„å»ºé”™è¯¯å“åº”
     */</span>
    private ImageResponse <span class="hljs-built_in">buildErrorResponse</span>(String requestId, String errorMessage, long startTime) {
        return ImageResponse<span class="hljs-selector-class">.builder</span>()
                <span class="hljs-selector-class">.requestId</span>(requestId)
                <span class="hljs-selector-class">.error</span>(errorMessage)
                <span class="hljs-selector-class">.createdAt</span>(java.time.LocalDateTime.now())
                <span class="hljs-selector-class">.duration</span>(System.currentTimeMillis() - startTime)
                <span class="hljs-selector-class">.success</span>(false)
                <span class="hljs-selector-class">.build</span>();
    }
}
</code></pre>
<h2 data-id="heading-12">å››ã€ä¸šåŠ¡æµç¨‹è¯¦è§£</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0805a9c66498428b80e59e848aa70aaa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769148824&amp;x-signature=T83iGvnktqU8tT1ADDDbTOGRDlo%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-13"><strong>8æ­¥å®Œæ•´æµç¨‹</strong>ï¼š</h2>
<pre><code class="hljs">1ï¸âƒ£ ç”¨æˆ·è¾“å…¥æ–‡æœ¬ï¼šå‰ç«¯æäº¤æ–‡æœ¬æè¿°
2ï¸âƒ£ å‚æ•°éªŒè¯ï¼šæ ¡éªŒå‚æ•°æ ¼å¼å’Œå†…å®¹
3ï¸âƒ£ ç¼“å­˜æŸ¥è¯¢ï¼šæ£€æŸ¥æ˜¯å¦å·²ç”Ÿæˆè¿‡
4ï¸âƒ£ æ„å»ºAPIè¯·æ±‚ï¼šç»„è£…OpenAIè¯·æ±‚
5ï¸âƒ£ è°ƒç”¨OpenAIï¼šå‘é€å›¾ç‰‡ç”Ÿæˆè¯·æ±‚
6ï¸âƒ£ æ¥æ”¶å“åº”ï¼šè·å–å›¾ç‰‡URL
7ï¸âƒ£ å¤„ç†ç»“æœï¼šä¿å­˜åˆ°æ•°æ®åº“
8ï¸âƒ£ è¿”å›å›¾ç‰‡ï¼šå“åº”ç»™ç”¨æˆ·
</code></pre>
<h2 data-id="heading-14">æ—¶åºå›¾</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2caa60ec4ec946d7b19738e5a807eb95~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769148824&amp;x-signature=5Q5ko1T06kut0cPjPe8Y1ntAsco%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-15"><strong>å…³é”®äº¤äº’æµç¨‹</strong>ï¼š</h2>
<p>å‰ç«¯â†’æ§åˆ¶å™¨ï¼šPOSTè¯·æ±‚</p>
<p>æ§åˆ¶å™¨â†’æœåŠ¡ï¼šå‚æ•°éªŒè¯</p>
<p>æœåŠ¡â†’ç¼“å­˜ï¼šæŸ¥è¯¢ç¼“å­˜</p>
<p>æœåŠ¡â†’OpenAIï¼šAPIè°ƒç”¨</p>
<p>OpenAIâ†’æœåŠ¡ï¼šè¿”å›å›¾ç‰‡URL</p>
<p>æœåŠ¡â†’ç¼“å­˜ï¼šæ›´æ–°ç¼“å­˜</p>
<p>æœåŠ¡â†’æ§åˆ¶å™¨ï¼šè¿”å›å“åº”</p>
<h2 data-id="heading-16">äº”ã€ç¼“å­˜æœºåˆ¶ä¼˜åŒ–</h2>
<h2 data-id="heading-17">å¤šçº§ç¼“å­˜ç­–ç•¥</h2>
<h2 data-id="heading-18">L1 - Caffeineæœ¬åœ°ç¼“å­˜</h2>
<p>è¯»å†™é€Ÿåº¦å¿«ï¼Œé€‚åˆçƒ­ç‚¹æ•°æ®</p>
<p>å‡å°‘ç½‘ç»œè°ƒç”¨</p>
<h2 data-id="heading-19">L2 - Redisåˆ†å¸ƒå¼ç¼“å­˜</h2>
<p>æ”¯æŒé›†ç¾¤ï¼Œå®¹é‡å¤§</p>
<p>é›†ç¾¤ç¯å¢ƒæ•°æ®å…±äº«</p>
<h2 data-id="heading-20">L3 - OpenAI APIç¼“å­˜</h2>
<p>ç¬¬ä¸‰æ–¹æœåŠ¡è‡ªå¸¦ç¼“å­˜</p>
<p>é™ä½APIæˆæœ¬</p>
<h2 data-id="heading-21">Caffeine</h2>
<pre><code class="hljs language-csharp" lang="csharp">package com.example.textToImage.demo;

import com.github.benmanes.caffeine.cache.Cache;
import com.github.benmanes.caffeine.cache.Caffeine;
import com.github.benmanes.caffeine.cache.Expiry;
import org.springframework.stereotype.Component;

import java.util.concurrent.TimeUnit;

<span class="hljs-comment">/**
 * Caffeineç¼“å­˜æ¼”ç¤ºç±»
 *
 * Caffeineç¼“å­˜çš„åŸºæœ¬ç”¨æ³•å’Œé«˜çº§ç‰¹æ€§
 */</span>
@Component
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CaffeineDemo</span> {

    <span class="hljs-comment">/**
     * åˆ›å»ºåŸºç¡€ç¼“å­˜
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Cache</span>&lt;<span class="hljs-title">String</span>, <span class="hljs-title">String</span>&gt; <span class="hljs-title">createBasicCache</span>()</span> {
        <span class="hljs-keyword">return</span> Caffeine.newBuilder()
                .maximumSize(<span class="hljs-number">1000</span>) <span class="hljs-comment">// æœ€å¤§ç¼“å­˜æ•°é‡</span>
                .expireAfterWrite(<span class="hljs-number">1</span>, TimeUnit.HOURS) <span class="hljs-comment">// å†™å…¥å1å°æ—¶è¿‡æœŸ</span>
                .build();
    }

    <span class="hljs-comment">/**
     * å¸¦æœ‰è‡ªå®šä¹‰è¿‡æœŸç­–ç•¥çš„ç¼“å­˜
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Cache</span>&lt;<span class="hljs-title">String</span>, <span class="hljs-title">Object</span>&gt; <span class="hljs-title">createCustomExpiryCache</span>()</span> {
        <span class="hljs-keyword">return</span> Caffeine.newBuilder()
                .expireAfter(<span class="hljs-keyword">new</span> Expiry&lt;String, Object&gt;() {
                    @Override
                    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">long</span> <span class="hljs-title">expireAfterCreate</span>(<span class="hljs-params">String key, Object <span class="hljs-keyword">value</span>, <span class="hljs-built_in">long</span> currentTime</span>)</span> {
                        <span class="hljs-keyword">return</span> TimeUnit.MINUTES.toNanos(<span class="hljs-number">30</span>); <span class="hljs-comment">// åˆ›å»ºå30åˆ†é’Ÿè¿‡æœŸ</span>
                    }

                    @Override
                    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">long</span> <span class="hljs-title">expireAfterUpdate</span>(<span class="hljs-params">String key, Object <span class="hljs-keyword">value</span>, <span class="hljs-built_in">long</span> currentTime, <span class="hljs-built_in">long</span> currentDuration</span>)</span> {
                        <span class="hljs-keyword">return</span> currentDuration; <span class="hljs-comment">// æ›´æ–°æ—¶ä¸é‡ç½®è¿‡æœŸæ—¶é—´</span>
                    }

                    @Override
                    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">long</span> <span class="hljs-title">expireAfterRead</span>(<span class="hljs-params">String key, Object <span class="hljs-keyword">value</span>, <span class="hljs-built_in">long</span> currentTime, <span class="hljs-built_in">long</span> currentDuration</span>)</span> {
                        <span class="hljs-keyword">return</span> currentDuration; <span class="hljs-comment">// è¯»å–æ—¶ä¸é‡ç½®è¿‡æœŸæ—¶é—´</span>
                    }
                })
                .maximumSize(<span class="hljs-number">500</span>)
                .build();
    }

    <span class="hljs-comment">/**
     * å¸¦æœ‰ç»Ÿè®¡ä¿¡æ¯çš„ç¼“å­˜
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Cache&lt;String, String&gt; <span class="hljs-title">createStatsCache</span>()</span> {
        <span class="hljs-keyword">return</span> Caffeine.newBuilder()
                .maximumSize(<span class="hljs-number">1000</span>)
                .recordStats() <span class="hljs-comment">// å¼€å¯ç»Ÿè®¡åŠŸèƒ½</span>
                .expireAfterWrite(<span class="hljs-number">1</span>, TimeUnit.HOURS)
                .build();
    }

    <span class="hljs-comment">/**
     * ç¼“å­˜æ“ä½œ
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">demonstrateCacheOperations</span>()</span> {
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"=== Caffeineç¼“å­˜æ¼”ç¤º ==="</span>);

        <span class="hljs-comment">// åˆ›å»ºç¼“å­˜</span>
        Cache&lt;String, String&gt; cache = createBasicCache();

        <span class="hljs-comment">// 1. åŸºæœ¬æ“ä½œ</span>
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"\n1. åŸºæœ¬ç¼“å­˜æ“ä½œ:"</span>);

        <span class="hljs-comment">// å­˜å‚¨</span>
        cache.put(<span class="hljs-string">"user:1001"</span>, <span class="hljs-string">"å¼ ä¸‰"</span>);
        cache.put(<span class="hljs-string">"user:1002"</span>, <span class="hljs-string">"æå››"</span>);
        cache.put(<span class="hljs-string">"user:1003"</span>, <span class="hljs-string">"ç‹äº”"</span>);

        <span class="hljs-comment">// è·å–</span>
        String user1 = cache.getIfPresent(<span class="hljs-string">"user:1001"</span>);
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"è·å–ç”¨æˆ·1001: "</span> + user1);

        <span class="hljs-comment">// ä½¿ç”¨computeIfAbsentï¼ˆåŸå­æ“ä½œï¼‰</span>
        String user4 = cache.<span class="hljs-keyword">get</span>(<span class="hljs-string">"user:1004"</span>, k -&gt; <span class="hljs-string">"æ–°ç”¨æˆ·"</span> + k.substring(k.lastIndexOf(<span class="hljs-string">":"</span>) + <span class="hljs-number">1</span>));
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"è·å–ç”¨æˆ·1004: "</span> + user4);

        <span class="hljs-comment">// 2. ç»Ÿè®¡ä¿¡æ¯</span>
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"\n2. ç¼“å­˜ç»Ÿè®¡:"</span>);
        Cache&lt;String, String&gt; statsCache = createStatsCache();

        <span class="hljs-comment">// æ¨¡æ‹Ÿä¸€äº›æ“ä½œ</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
            statsCache.put(<span class="hljs-string">"key:"</span> + i, <span class="hljs-string">"value:"</span> + i);
        }

        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">50</span>; i++) {
            statsCache.getIfPresent(<span class="hljs-string">"key:"</span> + i);
        }

        <span class="hljs-comment">// æ‰“å°ç»Ÿè®¡ä¿¡æ¯</span>
        com.github.benmanes.caffeine.cache.stats.CacheStats stats = statsCache.stats();
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ç¼“å­˜å‘½ä¸­æ¬¡æ•°: "</span> + stats.hitCount());
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ç¼“å­˜æœªå‘½ä¸­æ¬¡æ•°: "</span> + stats.missCount());
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ç¼“å­˜å‘½ä¸­ç‡: "</span> + stats.hitRate());
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"åŠ è½½æ—¶é—´: "</span> + stats.totalLoadTime() + <span class="hljs-string">" ns"</span>);

        <span class="hljs-comment">// 3. æ‰‹åŠ¨å¤±æ•ˆ</span>
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"\n3. ç¼“å­˜å¤±æ•ˆ:"</span>);
        cache.invalidate(<span class="hljs-string">"user:1001"</span>); <span class="hljs-comment">// å•ä¸ªkeyå¤±æ•ˆ</span>
        cache.invalidateAll(); <span class="hljs-comment">// å…¨éƒ¨å¤±æ•ˆ</span>

        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ç¼“å­˜æ¼”ç¤ºå®Œæˆ!"</span>);
    }

    <span class="hljs-comment">/**
     * å›¾ç‰‡ç¼“å­˜åœºæ™¯
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">demonstrateImageCache</span>()</span> {
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"\n=== å›¾ç‰‡ç¼“å­˜æ¼”ç¤º ==="</span>);

        Cache&lt;String, <span class="hljs-built_in">byte</span>[]&gt; imageCache = Caffeine.newBuilder()
                .maximumSize(<span class="hljs-number">100</span>) <span class="hljs-comment">// ç¼“å­˜100å¼ å›¾ç‰‡</span>
                .maximumWeight(<span class="hljs-number">10</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>) <span class="hljs-comment">// æœ€å¤§10MB</span>
                .expireAfterWrite(<span class="hljs-number">24</span>, TimeUnit.HOURS) <span class="hljs-comment">// 24å°æ—¶è¿‡æœŸ</span>
                .build();

        <span class="hljs-comment">// æ¨¡æ‹Ÿå›¾ç‰‡æ•°æ®</span>
        <span class="hljs-built_in">byte</span>[] smallImage = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">50</span> * <span class="hljs-number">1024</span>]; <span class="hljs-comment">// 50KB</span>
        <span class="hljs-built_in">byte</span>[] largeImage = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">2</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>]; <span class="hljs-comment">// 2MB</span>

        <span class="hljs-comment">// å­˜å‚¨å›¾ç‰‡</span>
        imageCache.put(<span class="hljs-string">"image:small"</span>, smallImage);
        imageCache.put(<span class="hljs-string">"image:large"</span>, largeImage);

        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å°å›¾ç‰‡ç¼“å­˜çŠ¶æ€: "</span> +
            (imageCache.getIfPresent(<span class="hljs-string">"image:small"</span>) != <span class="hljs-literal">null</span> ? <span class="hljs-string">"å·²ç¼“å­˜"</span> : <span class="hljs-string">"æœªç¼“å­˜"</span>));
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å¤§å›¾ç‰‡ç¼“å­˜çŠ¶æ€: "</span> +
            (imageCache.getIfPresent(<span class="hljs-string">"image:large"</span>) != <span class="hljs-literal">null</span> ? <span class="hljs-string">"å·²ç¼“å­˜"</span> : <span class="hljs-string">"æœªç¼“å­˜"</span>));

        <span class="hljs-comment">// è·å–ç¼“å­˜ç»Ÿè®¡</span>
        com.github.benmanes.caffeine.cache.stats.CacheStats stats = imageCache.stats();
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å›¾ç‰‡ç¼“å­˜å‘½ä¸­ç‡: "</span> + String.format(<span class="hljs-string">"%.2f%%"</span>, stats.hitRate() * <span class="hljs-number">100</span>));
    }
}
</code></pre>
<h2 data-id="heading-22">æ•°æ®æµè½¬</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b40904f168e40d0a82d234f2f1c85d4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769148824&amp;x-signature=sokObZi%2FIcvu5uom26rRt4gDaEU%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-23"><strong>æ™ºèƒ½ç¼“å­˜æŸ¥è¯¢æµç¨‹</strong>ï¼š</h2>
<pre><code class="hljs">1ã€ç”¨æˆ·å‘èµ·è¯·æ±‚
2ã€éªŒè¯å¹¶æŸ¥è¯¢ç¼“å­˜
3ã€ç¼“å­˜æœªå‘½ä¸­è°ƒç”¨API
4ã€OpenAIç”Ÿæˆå›¾ç‰‡
5ã€å¤„ç†ç»“æœå¹¶ç¼“å­˜
6ã€è¿”å›ç»“æœç»™ç”¨æˆ·
</code></pre>
<h2 data-id="heading-24">å…­ã€æ€§èƒ½ä¼˜åŒ–ä¸éƒ¨ç½²</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e20de3c3a4d44566993e0949d237dc71~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769148824&amp;x-signature=QCo8%2Fedj%2BFofoXqJgW4SjfNJA30%3D" alt="éƒ¨ç½²å›¾.png" loading="lazy"/></p>
<h2 data-id="heading-25">JVMå‚æ•°ä¼˜åŒ–</h2>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-deletion">-Xms2g -Xmx4gÂ </span>
<span class="hljs-deletion">-XX:+UseG1GCÂ </span>
<span class="hljs-deletion">-XX:MaxGCPauseMillis=200</span>
</code></pre>
<h2 data-id="heading-26">å¼‚æ­¥å¤„ç†é…ç½®</h2>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Configuration</span>
<span class="hljs-variable">@EnableAsync</span>
publicÂ classÂ AsyncConfigÂ {
Â  Â Â <span class="hljs-variable">@Bean</span>
Â  Â Â publicÂ ExecutorÂ <span class="hljs-built_in">taskExecutor</span>() {
Â  Â  Â  Â Â <span class="hljs-selector-tag">ThreadPoolTaskExecutor</span>Â <span class="hljs-selector-tag">executor</span> =Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-selector-tag">new</span>Â <span class="hljs-selector-tag">ThreadPoolTaskExecutor</span>();
Â  Â  Â  Â  <span class="hljs-selector-tag">executor</span><span class="hljs-selector-class">.setCorePoolSize</span>(<span class="hljs-number">5</span>);
Â  Â  Â  Â  <span class="hljs-selector-tag">executor</span><span class="hljs-selector-class">.setMaxPoolSize</span>(<span class="hljs-number">20</span>);
Â  Â  Â  Â  <span class="hljs-selector-tag">executor</span><span class="hljs-selector-class">.setQueueCapacity</span>(<span class="hljs-number">100</span>);
Â  Â  Â  Â Â <span class="hljs-selector-tag">return</span>Â <span class="hljs-selector-tag">executor</span>;
Â  Â  }
}
</code></pre>
<h2 data-id="heading-27">ä¸ƒã€æ€»ç»“</h2>
<h2 data-id="heading-28">å¤šæ¨¡æ€èåˆ</h2>
<pre><code class="hljs">æ–‡+å›¾â†’å›¾
å›¾+å›¾â†’è§†é¢‘
AR/VRå†…å®¹ç”Ÿæˆ
</code></pre>
<h2 data-id="heading-29">æœ¬åœ°åŒ–éƒ¨ç½²</h2>
<pre><code class="hljs">æ¨¡å‹å°å‹åŒ–
æ¨ç†ä¼˜åŒ–
æˆæœ¬å¯æ§
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ArcGIS Pro å®ç°å½±åƒæ³¢æ®µåˆæˆ]]></title>    <link>https://juejin.cn/post/7595878718171496484</link>    <guid>https://juejin.cn/post/7595878718171496484</guid>    <pubDate>2026-01-17T07:17:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595878718171496484" data-draft-id="7595878718171447332" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ArcGIS Pro å®ç°å½±åƒæ³¢æ®µåˆæˆ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-17T07:17:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="GISä¹‹è·¯"/> <meta itemprop="url" content="https://juejin.cn/user/4346787284915481"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ArcGIS Pro å®ç°å½±åƒæ³¢æ®µåˆæˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4346787284915481/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    GISä¹‹è·¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T07:17:49.000Z" title="Sat Jan 17 2026 07:17:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">^Â å…³æ³¨æˆ‘ï¼Œå¸¦ä½ ä¸€èµ·å­¦GISÂ ^</h2>
<h2 data-id="heading-1">å‰è¨€</h2>
<blockquote>
<p>â</p>
<p>é€šå¸¸ï¼Œæˆ‘ä»¬ä¸‹è½½çš„å«æ˜Ÿå½±åƒæ•°æ®æ¯ä¸ªæ³¢æ®µéƒ½å­˜åœ¨ä¸€ä¸ªå•ç‹¬çš„æ³¢æ®µä¸­ï¼Œä½†æ˜¯åœ¨ç”Ÿäº§å®è·µä¸­ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦ç”±å„ä¸ªæ³¢æ®µç»„æˆçš„å®Œæ•´æ•°æ®é›†ã€‚æ‰€ä»¥ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦è¿›è¡Œæ³¢æ®µåˆæˆæ“ä½œã€‚</p>
</blockquote>
<p>æœ¬èŠ‚ä¸»è¦è®²è§£å¦‚ä½•åœ¨<code>ArcGIS Pro</code>ä¸­å®ç°TIFFå½±åƒæ³¢æ®µåˆæˆã€‚</p>
<h2 data-id="heading-2">1. è½¯ä»¶ç¯å¢ƒ</h2>
<p>æœ¬æ–‡ä½¿ç”¨ä»¥ä¸‹è½¯ä»¶ç¯å¢ƒï¼Œä»…ä¾›å‚è€ƒã€‚</p>
<p>æ—¶é—´ï¼š2026 å¹´</p>
<p>æ“ä½œè½¯ä»¶ï¼šArcGIS Pro 3.5</p>
<p>æ“ä½œç³»ç»Ÿï¼šwindows 11</p>
<h2 data-id="heading-3">2. ä¸‹è½½å«æ˜Ÿå½±åƒæ•°æ®</h2>
<p>ä¿—è¯è¯´å·§å¦‡éš¾ä¸ºæ— ç±³ä¹‹ç‚Šï¼Œæ•°æ®å°±æ˜¯è½¯ä»¶çš„åŸºçŸ³ï¼Œæ²¡æœ‰æ•°æ®ï¼Œå†ç¾å¥½çš„è®¾æƒ³éƒ½æ˜¯ç©ºä¸­æ¥¼é˜ã€‚å› æ­¤ï¼Œç¬¬ä¸€æ­¥éœ€è¦ä¸‹è½½é¥æ„Ÿå½±åƒæ•°æ®ã€‚</p>
<p>ä½†æ˜¯ï¼Œå½±åƒæ•°æ®åœ¨å“ªé‡Œä¸‹è½½å‘¢ï¼Ÿåˆ«ç€æ€¥ï¼Œæœ¬æ–‡éƒ½ç»™ä½ æ•´ç†å¥½äº†ã€‚</p>
<p>æ•°æ®ä¸‹è½½å¯å‚è€ƒæ–‡ç« ï¼š<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F5c_J7f0xkUXEv7_z0eNweQ" target="_blank" title="https://mp.weixin.qq.com/s/5c_J7f0xkUXEv7_z0eNweQ" ref="nofollow noopener noreferrer">GIS å½±åƒæ•°æ®æºä»‹ç»</a></strong></p>
<hr/>
<p>å¦‚ä¸‹ï¼Œè¿™æ˜¯æˆ‘åœ¨ã€åœ°ç†ç©ºé—´æ•°æ®äº‘ã€‘å¹³å°ä¸‹è½½çš„<code>landsat8</code>é¥æ„Ÿå½±åƒã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d84b92a0b40d4034963934177df1a031~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=of2Fly6Jshn0NSPXuxWzZhYbV80%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">3. ArcGIS Pro è½¯ä»¶å®‰è£…</h2>
<p>è¦æƒ³ä½¿ç”¨<code>ArcGIS Pro</code>å®ç°å½±åƒæ³¢æ®µåˆæˆï¼Œé‚£ä½ å¾—å®‰è£…å¥½<code>ArcGIS Pro</code>è½¯ä»¶ã€‚</p>
<p>ä½†æ˜¯ï¼Œè½¯ä»¶å®‰è£…è¯´æ˜ä¸åœ¨æœ¬æ–‡çš„æ•™ç¨‹ä¹‹å†…ï¼Œå°±ä¸è¿›è¡Œä»‹ç»äº†ï¼Œè¯·æœªå®‰è£…çš„åŒå­¦è‡ªè¡Œè§£å†³ã€‚</p>
<h2 data-id="heading-5">4. æ³¢æ®µåˆæˆ</h2>
<p>å¥½äº†ï¼Œç»è¿‡ä¸Šé¢ä¸€å †åºŸè¯ï¼Œä¸‹é¢æ­£å¼è¿›å…¥ä¸»é¢˜ï¼Œè¿›è¡Œå®æ“ã€‚</p>
<p>å¦‚æœæœ‰è¿‡<code>ArcGIS</code>ç‰ˆæœ¬è½¯ä»¶åŸºç¡€çš„åŒå­¦ï¼Œå¯ä»¥å¾ˆå¿«å®Œæˆï¼Œå› ä¸º<code>ArcGIS Pro</code>å’Œ<code>ArcGIS</code>çš„å·¥å…·è®¾ç½®å¤§ä½“ç›¸åŒã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆéœ€è¦æ‰¾åˆ°æ•°æ®å¤„ç†å·¥å…·ç®±ã€‚ç‚¹å‡»èœå•æ åˆ†ææŒ‰é’®<code>Analysis</code>ï¼Œç„¶åå†ç‚¹å‡»å·¥å…·<code>Tools</code><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7c8076dc07845479102d90dd17d308a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=OSDuOcG9NRBTxxGad5f1WlZlJ4U%3D" alt="" loading="lazy"/></p>
<p>æˆ–è€…ç‚¹å‡»è½¯ä»¶æœç´¢æ¡†ä¸­ï¼Œå…¶ä¸­ä¼šå‡ºç°æ¨èçš„åœ°ç†å¤„ç†å·¥å…·ç®±ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5fff6d3407a4e3fb2f8374db9359252~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=X%2Fx9moBCXTD6c%2FQQoVqsTsQ%2BLPs%3D" alt="" loading="lazy"/></p>
<p>æ‰“å¼€å·¥å…·ä¹‹åï¼Œç‚¹å‡»æ•°æ®æ•°æ®å¤„ç†å·¥å…·<code>Data Management Tools</code>ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1b3e6e05dec4467bd3e8cc4b681b24d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=iebeNhWxQ7lVOPMgrOmx7O72sG0%3D" alt="" loading="lazy"/></p>
<p>ç„¶åä¾æ¬¡ç‚¹å‡»æ …æ ¼<code>Raster</code>ã€æ …æ ¼å¤„ç†<code>Raster Processing</code>ã€æ³¢æ®µåˆæˆ<code>Composite Bands</code>å³å¯ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f510cb90a704b508a978116ba2ef779~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=AG0UNLFjvlcGr5GK9ZclORqIJYI%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœä½ è§‰å¾—ä¸Šè¿°æ“ä½œè·¯å¾„å¤ªé•¿ï¼Œæˆ–è€…ä½ ç†Ÿæ‚‰æ“ä½œå·¥å…·åç§°çš„è¯ï¼Œå¯ä»¥ç›´æ¥åœ¨é¡µé¢é¡¶éƒ¨æœç´¢æ¡†è¾“å…¥å·¥å…·åç§°<code>Composite Bands</code>è¿›è¡Œæ£€ç´¢ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec6b42d3a9c24b4084223de64da05b7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=flCgGSeanif6XunNBJTROOpdmpk%3D" alt="" loading="lazy"/>åˆæˆ–è€…åœ¨åœ°ç†å¤„ç†æœç´¢æ¡†è¾“å…¥å·¥å…·åç§°<code>Composite Bands</code>è¿›è¡Œæ£€ç´¢ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8b25223e45d456ca4e3abab70ecb9ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=uewFzBIH4aBse9eAYUXx0R5GtOw%3D" alt="" loading="lazy"/></p>
<p>æ‰“å¼€æ³¢æ®µåˆæˆå·¥å…·ï¼Œå…ˆåœ¨è¾“å…¥æ …æ ¼ä¸­é€‰æ‹©éœ€è¦è¿›è¡Œåˆæˆçš„æ³¢æ®µæ•°æ®ï¼Œç„¶åé€‰æ‹©è¾“å‡ºä½ç½®ï¼Œæœ€åç‚¹å‡»è¿è¡Œã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89bacb94e89a4131ab6db1d68c3a1f2b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=usZeSG6NRqEdp5fd4rzI5%2B8nnyQ%3D" alt="" loading="lazy"/></p>
<p>å¦‚ä¸‹ä¸ºæ³¢æ®µ4ã€æ³¢æ®µ3ã€æ³¢æ®µ2åˆæˆçš„å½©è‰²æ•ˆæœå›¾ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34917ce015fd4ce5ade7870358129a15~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=MNASd9tuC3QJLLRCmt16Popl%2FCQ%3D" alt="" loading="lazy"/></p>
<p>å¦‚ä¸‹ä¸ºæ³¢æ®µ5ã€æ³¢æ®µ4ã€æ³¢æ®µ3åˆæˆçš„å½©è‰²æ•ˆæœå›¾ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3587d067d40a452a861ee370223a94fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=M7mI4xsjsA1YzXz9QXb1%2BHchzoA%3D" alt="" loading="lazy"/></p>
<p>å¯åœ¨å±æ€§ä¸­æŸ¥çœ‹æºæ•°æ®ä¿¡æ¯ï¼Œå…¶ä¸­ä¸‰ä¸ªæ³¢æ®µæ˜¾ç¤ºå¦‚ä¸‹ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/443efe33146949759ecf91f538658ada~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=W0KAGiPSKV0nywM84wscE6SFm%2FY%3D" alt="" loading="lazy"/></p>
<p><strong><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a464e74f3dd1474297f5c6b912c7c142~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=DrwtKbkVjkCn%2BWP5e32RMwsFZAs%3D" alt="" loading="lazy"/></strong></p>
<blockquote>
<p>â</p>
<p>OpenLayersç¤ºä¾‹æ•°æ®ä¸‹è½½ï¼Œè¯·åœ¨å…¬ä¼—å·åå°å›å¤ï¼š<strong>olæ•°æ®</strong></p>
<p>å…¨å›½ä¿¡æ¯åŒ–å·¥ç¨‹å¸ˆï¼GIS åº”ç”¨æ°´å¹³è€ƒè¯•èµ„æ–™ï¼Œè¯·åœ¨å…¬ä¼—å·åå°å›å¤ï¼š<strong>GISè€ƒè¯•</strong></p>
</blockquote>
<blockquote>
<p>â</p>
<p><em><strong>GISä¹‹è·¯</strong></em> å…¬ä¼—å·å·²ç»æ¥å…¥äº†<strong>æ™ºèƒ½</strong> <strong>åŠ©æ‰‹</strong>ï¼Œå¯ä»¥åœ¨å¯¹è¯æ¡†è¿›è¡Œæé—®ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æœç´¢å†å²æ–‡ç« è¿›è¡ŒæŸ¥çœ‹ã€‚</p>
</blockquote>
<p>éƒ½çœ‹åˆ°è¿™äº†ï¼Œä¸è¦å¿˜è®°<em><strong>ç‚¹èµã€æ”¶è—</strong></em> <strong>+</strong> <em><strong>å…³æ³¨</strong></em> å“¦ <strong>ï¼</strong></p>
<p>æœ¬å·ä¸å®šæ—¶æ›´æ–°æœ‰å…³Â <em><strong>GISå¼€å‘</strong></em> ç›¸å…³å†…å®¹ï¼Œ<em><strong>æ¬¢è¿å…³æ³¨Â <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98fb3fd9bb7a4811aea7749e685e59ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=xDF%2Bixl%2FX68BrkFtZzyeGWri1zs%3D" alt="" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73ee6be123244a598088074583d02a14~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=2D81qCPIatgudDFCfp6FwhehdK4%3D" alt="" loading="lazy"/></strong></em></p>
<hr/>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7df248a6f1614c67a274cebeaad1fd51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=aQ2DqpsmJynDTpbZt5kktnADd2g%3D" alt="" loading="lazy"/></p>
<p>Â  Â <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca3c1964cf644a608241df989ebf3ed7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=zzPiuq4%2BaowJ0pxpdjAM1Gx%2FwNA%3D" alt="" loading="lazy"/>Â </p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwOTEzNjI5NQ%3D%3D%26mid%3D2247487953%26idx%3D1%26sn%3D0b2d5aeefdb290583cf8cdd82f3c2077%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwOTEzNjI5NQ==&amp;mid=2247487953&amp;idx=1&amp;sn=0b2d5aeefdb290583cf8cdd82f3c2077&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">GeoTools å¼€å‘åˆé›†ï¼ˆå…¨ï¼‰</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwOTEzNjI5NQ%3D%3D%26mid%3D2247487119%26idx%3D1%26sn%3Dc313efa84c27bf933ef2f2a47991ef2d%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwOTEzNjI5NQ==&amp;mid=2247487119&amp;idx=1&amp;sn=c313efa84c27bf933ef2f2a47991ef2d&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">OpenLayers å¼€å‘åˆé›†</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FwkHv2NnJfuPhtyjJcFLrEQ" target="_blank" title="https://mp.weixin.qq.com/s/wkHv2NnJfuPhtyjJcFLrEQ" ref="nofollow noopener noreferrer">GDAL å®ç°çŸ¢é‡æ•°æ®è½¬æ¢å¤„ç†ï¼ˆå…¨ï¼‰</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FMZIQ57Ka3NQfKFi9AuEQEg" target="_blank" title="https://mp.weixin.qq.com/s/MZIQ57Ka3NQfKFi9AuEQEg" ref="nofollow noopener noreferrer">GDAL å®ç°æŠ•å½±è½¬æ¢</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FQVFiW5C5wXQ6a1WODCaH0g" target="_blank" title="https://mp.weixin.qq.com/s/QVFiW5C5wXQ6a1WODCaH0g" ref="nofollow noopener noreferrer">è‡ªç„¶èµ„æºéƒ¨å…šç»„å…³äºè‹—æ³½ç­‰4ååŒå¿—èŒåŠ¡ä»»å…çš„é€šçŸ¥</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FSX2u2ww1iNOtqR5m3BE93g" target="_blank" title="https://mp.weixin.qq.com/s/SX2u2ww1iNOtqR5m3BE93g" ref="nofollow noopener noreferrer">å›½äº§ç‰ˆçš„Google Earthï¼Œå‰æ—ä¸€å·å«æ˜ŸAppâ€œå…±ç”Ÿåœ°çƒâ€æ¥äº†</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FfWufqSyplniNj4Q3BRRbAQ" target="_blank" title="https://mp.weixin.qq.com/s/fWufqSyplniNj4Q3BRRbAQ" ref="nofollow noopener noreferrer">2026å¹´å…¨å›½è‡ªç„¶èµ„æºå·¥ä½œä¼šè®®å¬å¼€</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FRq7mCSrKU7DA7WRGDEy6Cg" target="_blank" title="https://mp.weixin.qq.com/s/Rq7mCSrKU7DA7WRGDEy6Cg" ref="nofollow noopener noreferrer">æ—¥æœ¬æ¬²æ‰“é€ â€œæœ¬åœŸç‰ˆâ€æ˜Ÿé“¾ç³»ç»Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FEqpOD--IdOUO6gyzwBc6RA" target="_blank" title="https://mp.weixin.qq.com/s/EqpOD--IdOUO6gyzwBc6RA" ref="nofollow noopener noreferrer">å‰æ—ä¸€å·å›½å†…é¦–å¼ é«˜åˆ†è¾¨ç‡å½©è‰²å¤œå…‰å«æ˜Ÿå½±åƒå‘å¸ƒ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FznfhqB1_3JbQHG7CEqWSCw" target="_blank" title="https://mp.weixin.qq.com/s/znfhqB1_3JbQHG7CEqWSCw" ref="nofollow noopener noreferrer">2025 å¹´åº¦ä¿¡åˆ›é¢†å†›ä¼ä¸šåå•å‡ºç‚‰ï¼</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½ çš„æ‰‹åŠ¿å†²çªè§£å†³äº†å—ï¼Ÿé¸¿è’™äº‹ä»¶æ‹¦æˆªæœºåˆ¶å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7595552420047568939</link>    <guid>https://juejin.cn/post/7595552420047568939</guid>    <pubDate>2026-01-16T08:00:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595552420047568939" data-draft-id="7595552420047552555" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½ çš„æ‰‹åŠ¿å†²çªè§£å†³äº†å—ï¼Ÿé¸¿è’™äº‹ä»¶æ‹¦æˆªæœºåˆ¶å…¨è§£æ"/> <meta itemprop="keywords" content="HarmonyOS,ArkTS,ArkUI"/> <meta itemprop="datePublished" content="2026-01-16T08:00:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¨å“¥çˆ±ç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/2242659450109575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½ çš„æ‰‹åŠ¿å†²çªè§£å†³äº†å—ï¼Ÿé¸¿è’™äº‹ä»¶æ‹¦æˆªæœºåˆ¶å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2242659450109575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¨å“¥çˆ±ç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T08:00:04.000Z" title="Fri Jan 16 2026 08:00:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    13
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å“ˆå–½ï¼Œå…„å¼Ÿä»¬ï¼Œæˆ‘æ˜¯ V å“¥ï¼
åœ¨é¸¿è’™å¼€å‘ä¸­ï¼Œå°¤å…¶æ˜¯åšå¤æ‚çš„äº¤äº’é¡µé¢ï¼ˆæ¯”å¦‚<strong>åˆ—è¡¨é‡Œå¥—æŒ‰é’®</strong>ã€<strong>æ¨ªæ»‘èœå•</strong>ã€<strong>åœ°å›¾ç¼©æ”¾</strong>ï¼‰æ—¶ï¼Œæ‰‹åŠ¿äº‹ä»¶å°±åƒæ˜¯ä¸€ç¾¤è°ƒçš®çš„å­©å­ï¼Œè°éƒ½æƒ³æŠ¢ç€æ¥ç›˜ã€‚å¦‚æœä½ ä¸ç®¡å¥½ä»–ä»¬ï¼ŒAppçš„ä½“éªŒä¼šå·®å¼ºäººæ„ã€‚</p>
<p>å…³äºé¸¿è’™API 21 çš„äº‹ä»¶æ‹¦æˆªæœºåˆ¶ã€‚è¿™ä¸‰æ‹›ï¼Œä¸“æ²»å„ç§â€œä¹±è·³â€ã€â€œè¯¯è§¦â€å’Œâ€œæ»‘åŠ¨å¤±æ•ˆâ€ã€‚ä»£ç æˆ‘éƒ½ç»™ä½ å†™å¥½äº†ï¼Œç›´æ¥å¤åˆ¶å°±èƒ½æ²»å¥½ä½ çš„ Appï¼</p>
<hr/>
<h2 data-id="heading-0">ç—›ç‚¹ä¸€ï¼šç‚¹å‡»å†’æ³¡ â€”â€” â€œæˆ‘ç‚¹çš„æŒ‰é’®ï¼Œä½ å…³åˆ—è¡¨ä»€ä¹ˆäº‹ï¼Ÿâ€</h2>
<h3 data-id="heading-1">ğŸ“œ æ¡ˆå‘ç°åœº</h3>
<p>æœ€å¸¸è§çš„åœºæ™¯ï¼šä¸€ä¸ª <code>ListItem</code> æœ¬èº«æ˜¯å¯ä»¥ç‚¹å‡»è·³è½¬è¯¦æƒ…çš„ï¼Œä½†é‡Œé¢æœ‰ä¸€ä¸ªâ€œåˆ é™¤â€æŒ‰é’®ã€‚
ç”¨æˆ·æƒ³ç‚¹åˆ é™¤ï¼Œç»“æœæ‰‹æŒ‡ç¨å¾®åäº†ä¸€ç‚¹ç‚¹ï¼Œæˆ–è€…ç³»ç»Ÿåˆ¤å®šå¤±è¯¯ï¼Œä¸ä»…åˆ é™¤äº†æ•°æ®ï¼Œè¿˜é¡ºæ‰‹è·³åˆ°äº†è¯¦æƒ…é¡µã€‚ç”¨æˆ·ä½“éªŒæå…¶ç³Ÿç³•ã€‚</p>
<h3 data-id="heading-2">ğŸ” åŸç†å‰–æ</h3>
<p>è¿™æ˜¯å…¸å‹çš„<strong>äº‹ä»¶å†’æ³¡</strong>ã€‚è§¦æ‘¸äº‹ä»¶ä»å­ç»„ä»¶ï¼ˆæŒ‰é’®ï¼‰ä¼ é€’åˆ°çˆ¶ç»„ä»¶ï¼ˆåˆ—è¡¨é¡¹ï¼‰ã€‚å­ç»„ä»¶å¤„ç†å®Œäº†ï¼Œå¦‚æœæ²¡è¯´â€œåˆ«ä¼ äº†â€ï¼Œçˆ¶ç»„ä»¶å°±ä¼šè§‰å¾—ï¼šâ€œå“¦ï¼Ÿæœ‰äººç‚¹äº†æˆ‘çš„åœ°ç›˜ï¼Ÿé‚£æˆ‘ä¹Ÿå“åº”ä¸€ä¸‹å§ã€‚â€</p>
<h3 data-id="heading-3">âœ… V å“¥çš„ä¸€æ‹›åˆ¶æ•Œï¼šhitTestBehavior</h3>
<p>æˆ‘ä»¬è¦åšçš„å°±æ˜¯ï¼š<strong>ç»™å­ç»„ä»¶ï¼ˆæŒ‰é’®ï¼‰è®¾ä¸ªâ€œè·¯éšœâ€ï¼Œå‘Šè¯‰çˆ¶ç»„ä»¶ï¼šè¿™äº‹æˆ‘åŠäº†ï¼Œä½ åˆ«æ’æ‰‹ï¼</strong></p>
<hr/>
<h2 data-id="heading-4">ç—›ç‚¹äºŒï¼šæ»‘åŠ¨æ‰“æ¶ â€”â€” â€œæˆ‘æƒ³æ¨ªæ»‘ï¼Œä½ éè¦ç«–ç€æ»šï¼Ÿâ€</h2>
<h3 data-id="heading-5">ğŸ“œ æ¡ˆå‘ç°åœº</h3>
<p>ä½ åœ¨åšä¸€ä¸ªéŸ³ä¹æ’­æ”¾å™¨ï¼Œè¿›åº¦æ¡æ”¯æŒæ¨ªå‘æ‹–åŠ¨ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªæ’­æ”¾å™¨æ˜¯æ”¾åœ¨ä¸€ä¸ª <code>Scroll</code>ï¼ˆå‚ç›´æ»šåŠ¨ï¼‰å®¹å™¨é‡Œçš„ã€‚
å½“ä½ æƒ³æ‹–åŠ¨è¿›åº¦æ¡æ—¶ï¼Œæ‰‹æŒ‡ç¨å¾®å¸¦ç‚¹å‚ç›´è§’åº¦ï¼Œé¡µé¢å°±å¼€å§‹ä¸Šä¸‹æ»šåŠ¨ï¼Œè¿›åº¦æ¡æ ¹æœ¬æ‹–ä¸åŠ¨ã€‚</p>
<h3 data-id="heading-6">ğŸ” åŸç†å‰–æ</h3>
<p>çˆ¶å®¹å™¨çš„ <code>VerticalScroll</code>ï¼ˆå‚ç›´æ»šåŠ¨æ‰‹åŠ¿ï¼‰å’Œå­ç»„ä»¶çš„ <code>PanGesture</code>ï¼ˆæ‹–åŠ¨æ‰‹åŠ¿ï¼‰å‘ç”Ÿäº†<strong>ç«äº‰</strong>ã€‚ç³»ç»Ÿä¸çŸ¥é“ä½ æ˜¯æƒ³åˆ‡æ­Œè¿˜æ˜¯æƒ³çœ‹æ­Œè¯ã€‚</p>
<h3 data-id="heading-7">âœ… V å“¥çš„ä¸€æ‹›åˆ¶æ•Œï¼šPanGesture &amp; ParallelGesture</h3>
<p>æˆ‘ä»¬éœ€è¦ç²¾ç»†åŒ–æ§åˆ¶æ‰‹åŠ¿çš„<strong>æ–¹å‘</strong>å’Œ<strong>å¹¶å‘æ¨¡å¼</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-8">ä»£ç æ¡ˆä¾‹</h2>
<p>æˆ‘ä»¬æ‰“å¼€ DevEco Studio 6.0ï¼Œæ–°å»ºä¸€ä¸ªé¡µé¢ <code>GestureDemo.ets</code>ã€‚è¿™æ®µä»£ç åŒ…å«äº†ä¸Šé¢ä¸¤ä¸ªé—®é¢˜çš„å®Œæ•´è§£å†³æ–¹æ¡ˆï¼Œè·‘ä¸€éä½ å°±å…¨æ‡‚äº†ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> promptAction <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.promptAction'</span>;

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">GestureDemo</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">deleteLog</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'æ“ä½œæ—¥å¿—ï¼šç­‰å¾…æ“ä½œ...'</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Vå“¥çš„æ‰‹åŠ¿å†²çªè¯Šç–—å®¤'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">24</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">20</span> })

      <span class="hljs-comment">// ==========================================</span>
      <span class="hljs-comment">// åœºæ™¯ä¸€ï¼šç‚¹å‡»å†²çªï¼ˆå†’æ³¡é—®é¢˜ï¼‰</span>
      <span class="hljs-comment">// ==========================================</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'åœºæ™¯1ï¼šåˆ—è¡¨é¡¹ç‚¹å‡» vs æŒ‰é’®ç‚¹å‡»'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#666'</span>)

      <span class="hljs-comment">// æ¨¡æ‹Ÿä¸€ä¸ªåˆ—è¡¨é¡¹</span>
      <span class="hljs-title class_">Row</span>() {
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Vå“¥çš„é¸¿è’™å®æˆ˜æ•™ç¨‹.mp4'</span>)
          .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)
        
        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'åˆ é™¤'</span>)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)
          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>)
          .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">12</span> })
          <span class="hljs-comment">// --- Vå“¥çš„å…³é”®ç¥æŠ€ ---</span>
          <span class="hljs-comment">// HitTestMode.Block è¡¨ç¤ºï¼šæˆ‘ï¼ˆæŒ‰é’®ï¼‰æ˜¯æŒ¡ç®­ç‰Œã€‚</span>
          <span class="hljs-comment">// åªè¦ç‚¹å‡»è½åœ¨æŒ‰é’®åŒºåŸŸï¼Œå°±ç”±æˆ‘å¤„ç†ï¼Œç»ä¸ä¼ ç»™çˆ¶ç»„ä»¶ Rowã€‚</span>
          <span class="hljs-comment">// è¿™æ ·çˆ¶ç»„ä»¶çš„ onClick å°±ä¸ä¼šè¢«è¯¯è§¦äº†ï¼</span>
          .<span class="hljs-title function_">hitTestBehavior</span>(<span class="hljs-title class_">HitTestMode</span>.<span class="hljs-property">Block</span>)
          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">deleteLog</span> = <span class="hljs-string">'ğŸ”¥ æ“ä½œï¼šç‚¹å‡»äº†ã€åˆ é™¤ã€‘æŒ‰é’®ï¼ˆçˆ¶ç»„ä»¶è¢«æ‹¦æˆªï¼‰'</span>;
            promptAction.<span class="hljs-title function_">showToast</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'åˆ é™¤æˆåŠŸï¼'</span> });
          })
      }
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">padding</span>(<span class="hljs-number">15</span>)
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F1F3F5'</span>)
      .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">8</span>)
      .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">20</span> })
      .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// ç‚¹å‡» Row çš„ç©ºç™½å¤„ä¼šè§¦å‘è¿™é‡Œï¼Œä½†ç‚¹æŒ‰é’®ä¸ä¼š</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">deleteLog</span> = <span class="hljs-string">'ğŸ“– æ“ä½œï¼šç‚¹å‡»äº†ã€åˆ—è¡¨é¡¹ã€‘ï¼Œåº”è¯¥è·³è½¬è¯¦æƒ…'</span>;
      })

      <span class="hljs-comment">// ==========================================</span>
      <span class="hljs-comment">// åœºæ™¯äºŒï¼šæ»‘åŠ¨å†²çªï¼ˆçºµæ¨ªé—®é¢˜ï¼‰</span>
      <span class="hljs-comment">// ==========================================</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'åœºæ™¯2ï¼šç«–å‘æ»šåŠ¨ vs æ¨ªå‘æ‹–æ‹½'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#666'</span>)

      <span class="hljs-comment">// å¤–å±‚ï¼šç«–å‘æ»šåŠ¨å®¹å™¨</span>
      <span class="hljs-title class_">Scroll</span>() {
        <span class="hljs-title class_">Column</span>() {
          <span class="hljs-title class_">Text</span>(<span class="hljs-string">'è¿™æ˜¯é¡¶éƒ¨å†…å®¹'</span>)
            .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)
            .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
            .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Pink</span>)

          <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºæ¨ªå‘æ‹–æ‹½çš„åŒºåŸŸ</span>
          <span class="hljs-title class_">Row</span>() {
            <span class="hljs-title class_">Text</span>(<span class="hljs-string">'æ‹–åŠ¨æˆ‘ -&gt; '</span>)
              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
            <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">toString</span>())
              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
          }
          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)
          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Orange</span>)
          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">8</span>)
          .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">20</span> })
          <span class="hljs-comment">// --- Vå“¥çš„å…³é”®ç¥æŠ€ ---</span>
          <span class="hljs-comment">// 1. å®šä¹‰ä¸€ä¸ªæ¨ªå‘æ‹–åŠ¨æ‰‹åŠ¿</span>
          .<span class="hljs-title function_">gesture</span>(
            <span class="hljs-title class_">PanGesture</span>({ <span class="hljs-attr">direction</span>: <span class="hljs-title class_">PanDirection</span>.<span class="hljs-property">Horizontal</span> })
              .<span class="hljs-title function_">onActionStart</span>(<span class="hljs-function">() =&gt;</span> {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">deleteLog</span> = <span class="hljs-string">'ğŸ¤š æ“ä½œï¼šå¼€å§‹ã€æ¨ªå‘ã€‘æ‹–æ‹½'</span>;
              })
              .<span class="hljs-title function_">onActionUpdate</span>(<span class="hljs-function">(<span class="hljs-params">event: GestureEvent</span>) =&gt;</span> {
                <span class="hljs-comment">// Vå“¥æ¼”ç¤ºï¼šç®€å•ç´¯åŠ ä¸€ä¸‹åç§»é‡</span>
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> += event.<span class="hljs-property">offsetX</span>;
              })
          )

          <span class="hljs-title class_">Text</span>(<span class="hljs-string">'è¿™æ˜¯åº•éƒ¨å†…å®¹ï¼Œå¤šæ’‘å¼€ç‚¹é«˜åº¦'</span>)
            .<span class="hljs-title function_">height</span>(<span class="hljs-number">400</span>)
            .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
            .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Grey</span>)
        }
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      }
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">height</span>(<span class="hljs-number">300</span>)
      .<span class="hljs-title function_">scrollable</span>(<span class="hljs-title class_">ScrollDirection</span>.<span class="hljs-property">Vertical</span>) <span class="hljs-comment">// ç”³æ˜ç«–å‘æ»šåŠ¨</span>
      .<span class="hljs-title function_">border</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span> })

      <span class="hljs-comment">// æ—¥å¿—æ˜¾ç¤º</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">deleteLog</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#333'</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">20</span> })
        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
        .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">5</span>)
        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#E0E0E0'</span>)

    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">20</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">20</span> })
  }

  <span class="hljs-comment">// ç”¨äºå­˜å‚¨æ»‘å—å€¼çš„å˜é‡</span>
  <span class="hljs-meta">@State</span> <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
}
</code></pre>
<hr/>
<h2 data-id="heading-9">å¤ç›˜ä¸€ä¸‹ï¼šæ‰‹åŠ¿æœºåˆ¶çš„ä¸‰ä¸ªâ€œæŒ¡ç®­ç‰Œâ€</h2>
<p>ä»£ç è·‘é€šäº†ï¼Œå’±ä»¬å¾—æŠŠ API 21 é‡Œçš„è¿™å‡ ä¸ªå‚æ•°åƒé€ï¼Œä»¥åé‡åˆ°å˜ç§ Bug ä¹Ÿèƒ½ä¸€æ‹›åˆ¶æ•Œã€‚</p>
<h3 data-id="heading-10">1. hitTestBehavior çš„å››ä¸ªå¢ƒç•Œ</h3>
<p>è¿™æ˜¯æœ€å¸¸ç”¨çš„å±æ€§ï¼Œä¿®é¥°åœ¨ç»„ä»¶ä¸Šã€‚</p>
<ul>
<li>
<p><strong><code>HitTestMode.Default</code>ï¼ˆé»˜è®¤ï¼‰</strong>ï¼š</p>
<ul>
<li>ç‰¹ç‚¹ï¼šè¯¥è°æ˜¯è°ã€‚å¦‚æœç»„ä»¶æœ¬èº«æ˜¯ <code>Button</code> è¿™ç±»å¯ç‚¹å‡»çš„ï¼Œå®ƒå°±æ‹¦æˆªï¼›å¦‚æœæ˜¯ <code>Text</code> è¿™ç§ï¼Œå®ƒå°±æ”¾è¡Œç»™çˆ¶ç»„ä»¶ã€‚</li>
<li><strong>V å“¥åæ§½</strong>ï¼šæœ‰æ—¶å€™ç³»ç»Ÿè¯¯åˆ¤ï¼Œå¯¼è‡´å¸ƒå±€é€æ˜çš„ <code>Row</code> æŒ¡ä½äº†ä¸‹å±‚æŒ‰é’®ï¼Œè¿™æ—¶å€™ä½ å°±å¾—æ”¹å®ƒã€‚</li>
</ul>
</li>
<li>
<p><strong><code>HitTestMode.None</code>ï¼ˆé€æ˜äººï¼‰</strong>ï¼š</p>
<ul>
<li>ç‰¹ç‚¹ï¼š<strong>æˆ‘ä¸æ‹¦æˆª</strong>ã€‚ç‚¹å‡»æˆ‘è¿™ä¸ªåŒºåŸŸï¼Œå°±å¥½åƒæˆ‘ä¸å­˜åœ¨ä¸€æ ·ï¼Œäº‹ä»¶ç›´æ¥ç©¿é€æˆ‘ï¼Œä¼ ç»™æˆ‘çš„å­©å­æˆ–è€…å…„å¼Ÿã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šä½ åšäº†ä¸€ä¸ªå¤æ‚çš„èƒŒæ™¯å¸ƒå±€ï¼Œä½†ä¸æƒ³å®ƒæŒ¡ä½èƒŒåçš„æŒ‰é’®ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>HitTestMode.Block</code>ï¼ˆæ‹¦è·¯è™ï¼‰</strong>ï¼šğŸŒŸ <strong>V å“¥æ¨è</strong></p>
<ul>
<li>ç‰¹ç‚¹ï¼š<strong>æˆ‘å…¨æ”¶äº†</strong>ã€‚ä¸ç®¡æˆ‘ä¸‹é¢æ˜¯ä»€ä¹ˆï¼Œåªè¦ç‚¹åˆ°æˆ‘ï¼Œæˆ‘å°±å¤„ç†ï¼Œç»ä¸å¾€å¤–ä¼ ã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šè¿™å°±æ˜¯å’±ä»¬ä»£ç é‡Œè§£å†³â€œåˆ—è¡¨é‡Œå¥—æŒ‰é’®â€çš„ç¥å™¨ã€‚ç»™æŒ‰é’®åŠ ä¸Šå®ƒï¼Œçˆ¶ç»„ä»¶å†ä¹Ÿä¸ä¼šè¯¯è§¦è·³è½¬ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>HitTestMode.Transparent</code>ï¼ˆä¼ å£°ç­’ï¼‰</strong>ï¼š</p>
<ul>
<li>ç‰¹ç‚¹ï¼šæˆ‘æ‹¦æˆªåˆ°äº‹ä»¶åï¼Œå¤„ç†å®Œï¼Œè¿˜è¦ä¼ ç»™çˆ¶ç»„ä»¶ã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šå¾ˆå°‘ç”¨ï¼Œé™¤éä½ æƒ³å®ç°â€œç‚¹å­ç»„ä»¶ï¼Œçˆ¶å­ä¸€èµ·åŠ¨â€çš„æ•ˆæœï¼ˆé€šå¸¸ä¸æ¨èï¼Œå®¹æ˜“ä¹±ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-11">2. æ‰‹åŠ¿çš„ä¼˜å…ˆçº§</h3>
<p>å¦‚æœä¸¤ä¸ªæ‰‹åŠ¿éƒ½æƒ³å“åº”ï¼Œå¬è°çš„ï¼Ÿ</p>
<ul>
<li><strong>ç³»ç»Ÿé»˜è®¤</strong>ï¼š<code>TapGesture</code> (ç‚¹å‡») &gt; <code>LongPressGesture</code> (é•¿æŒ‰) &gt; <code>PanGesture</code> (æ‹–åŠ¨) &gt; <code>PinchGesture</code> (æåˆ)ã€‚</li>
<li><strong>æ‰‹åŠ¨å¹²é¢„</strong>ï¼šå¦‚æœä½ æƒ³å¼ºè¡Œè®©æŸä¸ªæ‰‹åŠ¿ä¼˜å…ˆï¼Œå¯ä»¥ç”¨ <code>priorityGesture</code> åŒ…è£¹æ‰‹åŠ¿ã€‚</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript">    .<span class="hljs-title function_">gesture</span>(
      <span class="hljs-comment">// å³ä½¿çˆ¶ç»„ä»¶æƒ³æ»šåŠ¨ï¼Œå­ç»„ä»¶çš„æ¨ªå‘æ‹–åŠ¨ä¼˜å…ˆçº§æ›´é«˜</span>
      <span class="hljs-title function_">priorityGesture</span>(<span class="hljs-title class_">PanGesture</span>({ <span class="hljs-attr">direction</span>: <span class="hljs-title class_">PanDirection</span>.<span class="hljs-property">Horizontal</span> }))
    )
</code></pre>
<h3 data-id="heading-12">3. å¹¶å‘æ‰‹åŠ¿</h3>
<p>å¦‚æœä¸¤ä¸ªæ‰‹åŠ¿å¯ä»¥<strong>åŒæ—¶å‘ç”Ÿ</strong>ï¼ˆæ¯”å¦‚ä¸€è¾¹ç¼©æ”¾ä¸€è¾¹æ—‹è½¬ï¼‰ï¼Œç”¨ <code>GestureGroup</code> é…åˆ <code>GestureMode.Parallel</code>ã€‚
ä¸è¿‡ï¼Œå¯¹äºå¤§å¤šæ•°â€œçºµæ¨ªå†²çªâ€ï¼Œé¸¿è’™ç³»ç»Ÿ API 21 å·²ç»èƒ½å¾ˆæ™ºèƒ½åœ°é€šè¿‡ <code>PanGesture</code> çš„ <code>direction</code> å±æ€§è‡ªåŠ¨åŒºåˆ†æ–¹å‘äº†ã€‚å¦‚æœä½ å‘ç°å®ƒåˆ†ä¸æ¸…ï¼Œé€šå¸¸æ˜¯<strong>å¸ƒå±€é‡å </strong>æˆ–è€…<strong>è§¦æ‘¸åŒºåŸŸè®¾ç½®ä¸åˆç†</strong>å¯¼è‡´çš„ã€‚</p>
<hr/>
<h2 data-id="heading-13">å°ç»“ä¸€ä¸‹</h2>
<p>ä¸‹æ¬¡å†åšåˆ—è¡¨ã€ç›¸å†Œã€æ’­æ”¾å™¨çš„æ—¶å€™ï¼ŒæŠŠè¿™ä¸‰æ‹›æ‹¿å‡ºæ¥ï¼Œäº§å“ç»ç†çœ‹ä½ çš„çœ¼ç¥ç»å¯¹ä¸ä¸€æ ·ï¼</p>
<ol>
<li><strong>æ€•è¯¯è§¦ï¼ˆç‚¹å‡»å†²çªï¼‰</strong>ï¼šç»™æŒ‰é’®åŠ  <strong><code>hitTestBehavior(HitTestMode.Block)</code></strong>ã€‚</li>
<li><strong>æ€•æŠ¢æ»‘ï¼ˆæ»‘åŠ¨å†²çªï¼‰</strong>ï¼šç»™å­ç»„ä»¶ç»‘å®šæ˜ç¡®æ–¹å‘çš„ <strong><code>PanGesture</code></strong>ï¼Œå¿…è¦æ—¶åŠ  <strong><code>priorityGesture</code></strong>ã€‚</li>
<li><strong>æ€•é€ä¼ </strong>ï¼šç»™é®æŒ¡å±‚åŠ  <strong><code>hitTestBehavior(HitTestMode.None)</code></strong>ã€‚</li>
</ol>
<p>æˆ‘æ˜¯Vå“¥ï¼Œå’±ä»¬ä¸‹æœŸæŠ€æœ¯å¤ç›˜è§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>