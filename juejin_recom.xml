<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[JavaScript å¼‚å¸¸å¤„ç†æœºåˆ¶ä¸AOPæ‰©å±•å®è·µ]]></title>    <link>https://juejin.cn/post/7598366933080080438</link>    <guid>https://juejin.cn/post/7598366933080080438</guid>    <pubDate>2026-01-23T13:28:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598366933080080438" data-draft-id="7598507330859696170" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScript å¼‚å¸¸å¤„ç†æœºåˆ¶ä¸AOPæ‰©å±•å®è·µ"/> <meta itemprop="keywords" content="Node.js"/> <meta itemprop="datePublished" content="2026-01-23T13:28:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¾™å"/> <meta itemprop="url" content="https://juejin.cn/user/1515546071270151"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScript å¼‚å¸¸å¤„ç†æœºåˆ¶ä¸AOPæ‰©å±•å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1515546071270151/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¾™å
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T13:28:12.000Z" title="Fri Jan 23 2026 13:28:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åœ¨JavaScriptå¼€å‘ä¸­ï¼Œå¼‚å¸¸å¤„ç†æ˜¯ç¡®ä¿åº”ç”¨å¥å£®æ€§çš„é‡è¦ç¯èŠ‚ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•åœ¨JavaScriptä¸­å®ç°ç±»ä¼¼Javaçš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œå¹¶é€šè¿‡AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰æ€æƒ³æ‰©å±•å­—ç¬¦ä¸²æ–¹æ³•ï¼Œå®ç°å®‰å…¨çš„ç´¢å¼•è®¿é—®ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€å¼‚å¸¸å¤„ç†æœºåˆ¶è®¾è®¡</h2>
<h3 data-id="heading-1">1. å¼‚å¸¸ç±»ç»§æ‰¿ä½“ç³»</h3>
<p>æˆ‘ä»¬è®¾è®¡äº†ä¸€å¥—å®Œæ•´çš„å¼‚å¸¸ç±»ç»§æ‰¿ä½“ç³»ï¼Œæ¨¡ä»¿Javaçš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼š</p>
<pre><code class="hljs language-PlainText" lang="PlainText">Error
â””â”€â”€ Throwable
    â””â”€â”€ Exception
        â””â”€â”€ RuntimeException
            â”œâ”€â”€ NullPointerException
            â”œâ”€â”€ IndexOutOfBoundsException
            â”‚   â”œâ”€â”€ ArrayIndexOutOfBoundsException
            â”‚   â””â”€â”€ StringIndexOutOfBoundsException
            â””â”€â”€ others...
</code></pre>
<h3 data-id="heading-2">2. æ ¸å¿ƒå¼‚å¸¸ç±»å®ç° Throwableç±»</h3>
<p>Throwableç±»æ˜¯æ‰€æœ‰å¼‚å¸¸çš„æ ¹ç±»ï¼Œç»§æ‰¿è‡ªJavaScriptåŸç”ŸErrorç±»ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Throwable</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Error</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">
        message?: string,
        cause?: Throwable | <span class="hljs-literal">null</span>,
        enableSuppression: boolean = <span class="hljs-literal">true</span>,
        writableStackTrace: boolean = <span class="hljs-literal">true</span>
    </span>) {
        <span class="hljs-variable language_">super</span>(message); <span class="hljs-comment">// è°ƒç”¨çˆ¶ç±»Errorçš„æ„é€ å‡½æ•°</span>
        <span class="hljs-comment">// ... å…¶ä»–åˆå§‹åŒ–é€»è¾‘</span>
    }
    <span class="hljs-comment">// ... å…¶ä»–æ–¹æ³•</span>
}

</code></pre>
<h3 data-id="heading-3">3. è¿è¡Œæ—¶å¼‚å¸¸</h3>
<p>RuntimeExceptionåŠå…¶å­ç±»å®ç°äº†å¸¸è§çš„è¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¦‚NullPointerExceptionã€IndexOutOfBoundsExceptionç­‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">NullPointerException</span>Â <span class="hljs-keyword">extends</span>Â <span class="hljs-title class_ inherited__">RuntimeException</span>Â {
Â Â Â Â <span class="hljs-title function_">constructor</span>(<span class="hljs-params">messageÂ =Â <span class="hljs-string">'NullÂ pointerÂ exception'</span>,Â causeÂ =Â <span class="hljs-literal">null</span></span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">super</span>(message,Â cause);
Â Â Â Â }
}

<span class="hljs-keyword">export</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">IndexOutOfBoundsException</span>Â <span class="hljs-keyword">extends</span>Â <span class="hljs-title class_ inherited__">RuntimeException</span>Â {
Â Â Â Â <span class="hljs-title function_">constructor</span>(<span class="hljs-params">messageÂ =Â <span class="hljs-string">'IndexÂ outÂ ofÂ bounds'</span>,Â causeÂ =Â <span class="hljs-literal">null</span>,Â index:Â number</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">super</span>(message,Â cause);
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">index</span>Â =Â index;
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-4">äºŒã€å­—ç¬¦ä¸²å®‰å…¨è®¿é—®å®ç°</h2>
<h3 data-id="heading-5">1. æ‰©å±•String.prototypeæ–¹æ³•</h3>
<p>ç”±äºJavaScriptä¸­æ— æ³•ç›´æ¥é‡å†™[]è¿ç®—ç¬¦ï¼Œæˆ‘ä»¬ä½¿ç”¨Proxyå¯¹è±¡æ¥æ‹¦æˆªå­—ç¬¦ä¸²çš„ç´¢å¼•è®¿é—®ï¼š</p>
<p>æˆ‘ä»¬æ‰©å±•äº†String.prototypeï¼Œé‡å†™äº†charAtã€charCodeAtã€substringç­‰æ–¹æ³•ï¼Œä½¿å…¶åœ¨ç´¢å¼•è¶Šç•Œæ—¶æŠ›å‡ºå¼‚å¸¸ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//Â ä¿å­˜åŸå§‹æ–¹æ³•</span>
<span class="hljs-keyword">const</span>Â originalCharAtÂ =Â <span class="hljs-title class_">String</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">charAt</span>;

<span class="hljs-comment">//Â é‡å†™charAtæ–¹æ³•</span>
<span class="hljs-title class_">String</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">charAt</span>Â =Â <span class="hljs-keyword">function</span>(<span class="hljs-params">index</span>)Â {
Â Â Â Â <span class="hljs-keyword">if</span>Â (indexÂ &lt;Â <span class="hljs-number">0</span>Â ||Â indexÂ &gt;=Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">throw</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">StringIndexOutOfBoundsException</span>(
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">`StringÂ indexÂ outÂ ofÂ range:Â <span class="hljs-subst">${index}</span>`</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-literal">null</span>,
Â Â Â Â Â Â Â Â Â Â Â Â index
Â Â Â Â Â Â Â Â );
Â Â Â Â }
Â Â Â Â <span class="hljs-keyword">return</span>Â originalCharAt.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>,Â index);
};
</code></pre>
<h2 data-id="heading-6">ä¸‰ã€AOPæ€æƒ³é‡æ„å­—ç¬¦ä¸²æ–¹æ³•</h2>
<h3 data-id="heading-7">1. AOPæ ¸å¿ƒæ¦‚å¿µ</h3>
<p>AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œå…è®¸æˆ‘ä»¬å°†æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆå¦‚æ—¥å¿—ã€å®‰å…¨æ£€æŸ¥ã€äº‹åŠ¡ç®¡ç†ç­‰ï¼‰ä¸æ ¸å¿ƒä¸šåŠ¡é€»è¾‘åˆ†ç¦»ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ç´¢å¼•æ£€æŸ¥ä½œä¸ºæ¨ªåˆ‡å…³æ³¨ç‚¹ï¼Œä¸å­—ç¬¦ä¸²æ–¹æ³•çš„æ ¸å¿ƒé€»è¾‘åˆ†ç¦»ã€‚</p>
<h3 data-id="heading-8">2. AOPå®ç°æ–¹æ¡ˆ åˆ‡é¢å®šä¹‰</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰äº†ç´¢å¼•æ£€æŸ¥åˆ‡é¢ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span>Â <span class="hljs-title function_">indexCheckAspect</span>(<span class="hljs-params">index:Â number,Â 
methodName:Â string</span>):Â <span class="hljs-keyword">void</span>Â {
Â Â Â Â <span class="hljs-keyword">if</span>Â (indexÂ &lt;Â <span class="hljs-number">0</span>Â ||Â indexÂ &gt;=Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">throw</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">StringIndexOutOfBoundsException</span>(
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-string">`StringÂ indexÂ outÂ ofÂ range:Â <span class="hljs-subst">${index}</span>Â 
Â Â Â Â Â Â Â Â Â Â Â Â inÂ methodÂ <span class="hljs-subst">${methodName}</span>`</span>,
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-literal">null</span>,
Â Â Â Â Â Â Â Â Â Â Â Â index
Â Â Â Â Â Â Â Â );
Â Â Â Â }
}
</code></pre>
<h3 data-id="heading-9">3. ä»£ç†å·¥å‚</h3>
<p>ç„¶åï¼Œå®ç°äº†AOPä»£ç†å·¥å‚ï¼Œç”¨äºç”Ÿæˆå¸¦åˆ‡é¢çš„ä»£ç†æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span>Â <span class="hljs-title function_">createAopProxy</span>(<span class="hljs-params">
Â Â Â Â originalMethod:Â <span class="hljs-built_in">Function</span>,
Â Â Â Â indexParamIndices:Â number[],
Â Â Â Â beforeAdvice?:Â <span class="hljs-built_in">Function</span>,
Â Â Â Â afterAdvice?:Â <span class="hljs-built_in">Function</span>
</span>):Â <span class="hljs-title class_">Function</span>Â {
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable language_">this</span>:Â string,Â ...args:Â any[]</span>)Â 
Â Â Â Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â methodNameÂ =Â originalMethod.<span class="hljs-property">name</span>;
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ‰§è¡Œç´¢å¼•æ£€æŸ¥åˆ‡é¢</span>
Â Â Â Â Â Â Â Â indexParamIndices.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">paramIndex</span>)Â =&gt;</span>Â 
Â Â Â Â Â Â Â Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (args[paramIndex]Â !==Â <span class="hljs-literal">undefined</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â indexCheckAspect.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>,Â args
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â [paramIndex],Â methodName);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â });
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è°ƒç”¨åŸå§‹æ–¹æ³•ï¼ˆä½¿ç”¨Reflect.applyå®ç°ï¼‰</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â resultÂ =Â <span class="hljs-title class_">Reflect</span>.<span class="hljs-property">apply</span>
Â Â Â Â Â Â Â Â (originalMethod,Â <span class="hljs-variable language_">this</span>,Â args);
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â result;
Â Â Â Â };
}
</code></pre>
<h3 data-id="heading-10">4. é…ç½®é©±åŠ¨è®¾è®¡</h3>
<p>æˆ‘ä»¬é‡‡ç”¨é…ç½®é©±åŠ¨çš„æ–¹å¼ï¼Œå®šä¹‰äº†æ¯ä¸ªæ–¹æ³•éœ€è¦æ£€æŸ¥çš„å‚æ•°ç´¢å¼•ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">//Â æ–¹æ³•é…ç½®ï¼šå®šä¹‰æ¯ä¸ªæ–¹æ³•éœ€è¦æ£€æŸ¥çš„å‚æ•°ç´¢å¼•</span>
<span class="hljs-keyword">const</span>Â methodConfigsÂ =Â {
Â Â Â Â <span class="hljs-attr">charAt</span>:Â [<span class="hljs-number">0</span>],Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â charAt(index)</span>
Â Â Â Â <span class="hljs-attr">charCodeAt</span>:Â [<span class="hljs-number">0</span>],Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â charCodeAt</span>
Â Â Â Â (index)
Â Â Â Â <span class="hljs-attr">substring</span>:Â [<span class="hljs-number">0</span>,Â <span class="hljs-number">1</span>],Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â substring</span>
Â Â Â Â (indexStart,Â indexEnd?)
Â Â Â Â <span class="hljs-attr">substr</span>:Â [<span class="hljs-number">0</span>],Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â substr(start,Â </span>
Â Â Â Â length?)
Â Â Â Â <span class="hljs-attr">slice</span>:Â [<span class="hljs-number">0</span>,Â <span class="hljs-number">1</span>]Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â slice(start,Â </span>
Â Â Â Â end?)
};

<span class="hljs-comment">//Â æ‰¹é‡åˆ›å»ºå¹¶åº”ç”¨AOPä»£ç†</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(methodConfigs).<span class="hljs-property">forEach</span>
(<span class="hljs-function">(<span class="hljs-params">[methodName,Â paramIndices]</span>)Â =&gt;</span>Â {
Â Â Â Â <span class="hljs-keyword">const</span>Â originalMethodÂ =Â originalMethods
Â Â Â Â [methodNameÂ <span class="hljs-keyword">as</span>Â keyofÂ <span class="hljs-keyword">typeof</span>Â originalMethods];
Â Â Â Â <span class="hljs-keyword">if</span>Â (originalMethod)Â {
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">set</span>(<span class="hljs-title class_">String</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>,Â methodName,Â 
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title function_">createAopProxy</span>(originalMethod,Â 
Â Â Â Â Â Â Â Â Â Â Â Â paramIndices),
Â Â Â Â Â Â Â Â Â Â Â Â {Â <span class="hljs-attr">writable</span>:Â <span class="hljs-literal">true</span>,Â <span class="hljs-attr">enumerable</span>:Â <span class="hljs-literal">false</span>,Â 
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">configurable</span>:Â <span class="hljs-literal">true</span>Â }
Â Â Â Â Â Â Â Â );
Â Â Â Â }
});
</code></pre>
<h2 data-id="heading-11">å››ã€ä½¿ç”¨æ•ˆæœ</h2>
<h3 data-id="heading-12">1. å¼‚å¸¸æŠ›å‡ºç¤ºä¾‹</h3>
<p>ä½¿ç”¨é‡å†™åçš„å­—ç¬¦ä¸²æ–¹æ³•ï¼Œå½“ç´¢å¼•è¶Šç•Œæ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span>Â strÂ =Â <span class="hljs-string">"hello"</span>;

<span class="hljs-comment">//Â æ­£å¸¸è°ƒç”¨</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">0</span>));Â <span class="hljs-comment">//Â è¾“å‡º:Â "h"</span>

<span class="hljs-comment">//Â ç´¢å¼•è¶Šç•Œè°ƒç”¨</span>
<span class="hljs-keyword">try</span>Â {
Â Â Â Â <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-title function_">charAt</span>(-<span class="hljs-number">2</span>));Â <span class="hljs-comment">//Â æŠ›å‡ºå¼‚å¸¸</span>
}Â <span class="hljs-keyword">catch</span>Â (e)Â {
Â Â Â Â e.<span class="hljs-title function_">printStackTrace</span>();Â <span class="hljs-comment">//Â è¾“å‡ºè¯¦ç»†çš„å¼‚å¸¸ä¿¡æ¯</span>
}
</code></pre>
<h3 data-id="heading-13">2. å¼‚å¸¸ä¿¡æ¯å¢å¼º</h3>
<p>æˆ‘ä»¬çš„å¼‚å¸¸ç±»æä¾›äº†è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¼‚å¸¸ç±»å‹ã€é”™è¯¯æ¶ˆæ¯å’Œç›¸å…³ä¸Šä¸‹æ–‡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">StringIndexOutOfBoundsException:Â StringÂ indexÂ outÂ ofÂ range:Â -2Â <span class="hljs-keyword">in</span>Â methodÂ charAt
Â Â Â Â atÂ indexCheckAspectÂ (main.ts:23:13)
Â Â Â Â atÂ String.&lt;anonymous&gt;Â (main.ts:45:25)
Â Â Â Â atÂ &lt;anonymous&gt;:1:12
</code></pre>
<h2 data-id="heading-14">äº”ã€æŠ€æœ¯ä¼˜åŠ¿ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-15">1. æŠ€æœ¯ä¼˜åŠ¿</h3>
<ul>
<li>å…³æ³¨ç‚¹åˆ†ç¦» ï¼šç´¢å¼•æ£€æŸ¥é€»è¾‘ä¸æ ¸å¿ƒä¸šåŠ¡é€»è¾‘åˆ†ç¦»ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•</li>
<li>é…ç½®é©±åŠ¨ ï¼šé€šè¿‡é…ç½®æ–‡ä»¶æ§åˆ¶å“ªäº›æ–¹æ³•éœ€è¦è¢«ä»£ç†ï¼Œæ˜“äºæ‰©å±•</li>
<li>ç±»å‹å®‰å…¨ ï¼šæ·»åŠ äº†TypeScriptç±»å‹æ³¨è§£ï¼Œæé«˜ä»£ç å®‰å…¨æ€§</li>
<li>ç°ä»£JavaScriptç‰¹æ€§ ï¼šä½¿ç”¨Reflect APIã€ç®­å¤´å‡½æ•°ç­‰ç°ä»£JavaScriptç‰¹æ€§</li>
<li>é—­åŒ…åº”ç”¨ ï¼šåˆ©ç”¨é—­åŒ…ä¿å­˜åŸå§‹æ–¹æ³•å’Œé…ç½®ï¼Œç¡®ä¿ä»£ç†æ–¹æ³•å¯ä»¥è®¿é—®åˆ°æ­£ç¡®çš„ä¸Šä¸‹æ–‡</li>
<li/>
</ul>
<h3 data-id="heading-16">2. æœ€ä½³å®è·µ</h3>
<ul>
<li>é¿å…è¿‡åº¦ä»£ç† ï¼šåªä»£ç†éœ€è¦ç´¢å¼•æ£€æŸ¥çš„æ–¹æ³•ï¼Œé¿å…æ€§èƒ½å¼€é”€</li>
<li>åˆç†è®¾è®¡å¼‚å¸¸ä¿¡æ¯ ï¼šå¼‚å¸¸ä¿¡æ¯åº”åŒ…å«è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ï¼Œä¾¿äºè°ƒè¯•</li>
<li>è€ƒè™‘å…¼å®¹æ€§ ï¼šç¡®ä¿ä»£ç åœ¨ç›®æ ‡ç¯å¢ƒä¸­å…¼å®¹</li>
<li>æµ‹è¯•è¦†ç›– ï¼šä¸ºä»£ç†æ–¹æ³•ç¼–å†™å……åˆ†çš„æµ‹è¯•ç”¨ä¾‹ï¼Œç¡®ä¿åŠŸèƒ½æ­£ç¡®</li>
<li>æ–‡æ¡£å®Œå–„ ï¼šä¸ºæ‰©å±•çš„æ–¹æ³•ç¼–å†™æ¸…æ™°çš„æ–‡æ¡£ï¼Œä¾¿äºå…¶ä»–å¼€å‘è€…ä½¿ç”¨</li>
</ul>
<h2 data-id="heading-17">å…­ã€æ€»ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº†å¦‚ä½•åœ¨JavaScriptä¸­å®ç°ç±»ä¼¼Javaçš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œå¹¶é€šè¿‡AOPæ€æƒ³æ‰©å±•å­—ç¬¦ä¸²æ–¹æ³•ï¼Œå®ç°å®‰å…¨çš„ç´¢å¼•è®¿é—®ã€‚æˆ‘ä»¬è®¾è®¡äº†å®Œæ•´çš„å¼‚å¸¸ç±»ç»§æ‰¿ä½“ç³»ï¼Œä¿®å¤äº†æ ¸å¿ƒå¼‚å¸¸ç±»çš„é—®é¢˜ï¼Œå¹¶ä½¿ç”¨Proxyå’ŒAOPæŠ€æœ¯å®ç°äº†å­—ç¬¦ä¸²æ–¹æ³•çš„å®‰å…¨æ‰©å±•ã€‚</p>
<p>è¿™ç§è®¾è®¡æ¨¡å¼ä¸ä»…æé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§ï¼Œè¿˜å¢å¼ºäº†ä»£ç çš„å®‰å…¨æ€§å’Œå¯é æ€§ã€‚é€šè¿‡AOPæ€æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¨ªåˆ‡å…³æ³¨ç‚¹ä¸æ ¸å¿ƒä¸šåŠ¡é€»è¾‘åˆ†ç¦»ï¼Œå®ç°æ›´çµæ´»ã€æ›´æ¨¡å—åŒ–çš„ä»£ç è®¾è®¡ã€‚</p>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¿™ç§è®¾è®¡æ¨¡å¼å¯ä»¥åº”ç”¨äºæ›´å¤šåœºæ™¯ï¼Œå¦‚æ—¥å¿—è®°å½•ã€æ€§èƒ½ç›‘æ§ã€äº‹åŠ¡ç®¡ç†ç­‰ï¼Œæ˜¯ä¸€ç§éå¸¸å¼ºå¤§çš„ç¼–ç¨‹æ€æƒ³ã€‚</p>
<h2 data-id="heading-18">å®Œæ•´ä»£ç ç¤ºä¾‹</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å¯¼å…¥æ‰€éœ€çš„å¼‚å¸¸ç±»</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">StringIndexOutOfBoundsException</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./ExceptionExtension/IndexOutOfBoundsException.js'</span>;

<span class="hljs-comment">/* ======================== å­—ç¬¦ä¸²è¡Œä¸º ==================================== */</span>
<span class="hljs-comment">/**
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number</span>} - å­—ç¬¦ä¸²çš„hashCode
 */</span>
<span class="hljs-title class_">String</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">hashCode</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-keyword">let</span> hash = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-keyword">const</span> char = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">charCodeAt</span>(i);
        hash = ((hash &lt;&lt; <span class="hljs-number">5</span>) - hash) + char;
        hash = hash &amp; hash;
    }
    <span class="hljs-keyword">return</span> hash;
};

(<span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
    <span class="hljs-comment">// 1. å®šä¹‰éœ€è¦æ‹¦æˆªçš„æ–¹æ³•åŠå…¶å¯¹åº”çš„å‚æ•°ç´¢å¼•</span>
    <span class="hljs-keyword">const</span> stringMethodConfigs = {
        <span class="hljs-string">'charAt'</span>: [<span class="hljs-number">0</span>],
        <span class="hljs-string">'charCodeAt'</span>: [<span class="hljs-number">0</span>],
        <span class="hljs-string">'substring'</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],
        <span class="hljs-string">'substr'</span>: [<span class="hljs-number">0</span>],
        <span class="hljs-string">'slice'</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],
        <span class="hljs-string">'safeIndex'</span>: [<span class="hljs-number">0</span>]
    };

    <span class="hljs-comment">// 2. è‡ªåŠ¨åŒ–ç»‡å…¥åˆ‡é¢</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [methodName, argIndices] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(stringMethodConfigs)) {
        <span class="hljs-keyword">const</span> original = <span class="hljs-title class_">String</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>[methodName];
        
        <span class="hljs-comment">// å¦‚æœæ–¹æ³•ä¸å­˜åœ¨ï¼ˆå¦‚ safeIndex å¯èƒ½æ˜¯æ–°å®šä¹‰çš„ï¼‰ï¼Œåˆ™æä¾›ä¸€ä¸ªåŸºç¡€å®ç°</span>
        <span class="hljs-keyword">const</span> baseFn = <span class="hljs-keyword">typeof</span> original === <span class="hljs-string">'function'</span> 
            ? original 
            : <span class="hljs-keyword">function</span>(<span class="hljs-params">i</span>) { <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[i]; };

        <span class="hljs-title class_">String</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>[methodName] = <span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) {
            <span class="hljs-comment">// --- å‰ç½®é€šçŸ¥ (Before Advice) ---</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> argIdx <span class="hljs-keyword">of</span> argIndices) {
                <span class="hljs-keyword">if</span> (args[argIdx] === <span class="hljs-literal">undefined</span>) <span class="hljs-keyword">return</span>;
                <span class="hljs-keyword">let</span> index= args[argIdx];
                <span class="hljs-keyword">let</span> actualIndex = args[argIdx] ;
                <span class="hljs-keyword">if</span> (args[argIdx]  &lt; <span class="hljs-number">0</span>) {
                    actualIndex = <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span> + index;
                }
             
                <span class="hljs-keyword">if</span> (actualIndex &lt; <span class="hljs-number">0</span> || actualIndex &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringIndexOutOfBoundsException</span>(
                        <span class="hljs-string">`String index out of range in <span class="hljs-subst">${methodName}</span>: <span class="hljs-subst">${index}</span>`</span>,
                        <span class="hljs-literal">null</span>,
                        index
                    );
                }
            }
            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">apply</span>(baseFn, <span class="hljs-variable language_">this</span>, args);
        };
    }
})();
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä» var åˆ° let/constï¼šJavaScript å˜é‡å£°æ˜çš„æ¼”è¿›ä¸æœ€ä½³å®è·µ]]></title>    <link>https://juejin.cn/post/7598376873547186219</link>    <guid>https://juejin.cn/post/7598376873547186219</guid>    <pubDate>2026-01-23T13:30:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598376873547186219" data-draft-id="7598398537248784403" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä» var åˆ° let/constï¼šJavaScript å˜é‡å£°æ˜çš„æ¼”è¿›ä¸æœ€ä½³å®è·µ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-23T13:30:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·411924458439"/> <meta itemprop="url" content="https://juejin.cn/user/221443581553930"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä» var åˆ° let/constï¼šJavaScript å˜é‡å£°æ˜çš„æ¼”è¿›ä¸æœ€ä½³å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/221443581553930/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·411924458439
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T13:30:14.000Z" title="Fri Jan 23 2026 13:30:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>JavaScript ä½œä¸ºä¸€é—¨è¯ç”Ÿäº 1995 å¹´çš„è„šæœ¬è¯­è¨€ï¼Œæ—©æœŸä¸»è¦ç”¨äºç®€å•çš„ç½‘é¡µäº¤äº’ã€‚éšç€ Web åº”ç”¨æ—¥ç›Šå¤æ‚ï¼Œå…¶è¯­è¨€è®¾è®¡ä¸­çš„ä¸€äº›â€œå†å²åŒ…è¢±â€é€æ¸æš´éœ²å‡ºæ¥â€”â€”å…¶ä¸­æœ€å…¸å‹çš„é—®é¢˜ä¹‹ä¸€ï¼Œå°±æ˜¯å˜é‡å£°æ˜æœºåˆ¶çš„ç¼ºé™·ã€‚æœ¬æ–‡å°†åŸºäºä½ çš„å­¦ä¹ ç¬”è®°ï¼Œç³»ç»Ÿæ¢³ç† JavaScript ä¸­Â <code>var</code>ã€<code>let</code>Â å’ŒÂ <code>const</code>Â çš„åŒºåˆ«ï¼Œæ¾„æ¸…å¸¸è§è¯¯è§£ï¼Œå¹¶æ¢è®¨ç°ä»£å¼€å‘ä¸­çš„æœ€ä½³å®è·µã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ES5 æ—¶ä»£çš„å˜é‡å£°æ˜ï¼š<code>var</code>Â åŠå…¶é—®é¢˜</h2>
<p>åœ¨ ES5ï¼ˆ2009 å¹´ï¼‰åŠä¹‹å‰ï¼ŒJavaScriptÂ <strong>åªæœ‰ä¸€ç§å˜é‡å£°æ˜æ–¹å¼ï¼š<code>var</code></strong>ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> age = <span class="hljs-number">18</span>;
</code></pre>
<h3 data-id="heading-1">âŒÂ <code>var</code>Â çš„ä¸‰å¤§ç¼ºé™·</h3>
<h4 data-id="heading-2">1.Â <strong>å˜é‡æå‡ï¼ˆHoistingï¼‰</strong></h4>
<p><code>var</code>Â å£°æ˜çš„å˜é‡ä¼šè¢«â€œæå‡â€åˆ°å‡½æ•°æˆ–å…¨å±€ä½œç”¨åŸŸçš„é¡¶éƒ¨ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// undefinedï¼ˆä¸æ˜¯æŠ¥é”™ï¼ï¼‰</span>
<span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;
</code></pre>
<p>å®é™…ä¸Šï¼ŒJavaScript å¼•æ“åœ¨<strong>ç¼–è¯‘é˜¶æ®µ</strong>å°±å°†Â <code>var a</code>Â æå‡ï¼Œä½†èµ‹å€¼ä»ç•™åœ¨åŸåœ°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å®é™…æ‰§è¡Œé¡ºåº </span>
<span class="hljs-keyword">var</span> a; <span class="hljs-comment">// ç¼–è¯‘é˜¶æ®µï¼šå£°æ˜æå‡</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// æ‰§è¡Œé˜¶æ®µï¼šæ­¤æ—¶ a ä¸º undefined</span>
a = <span class="hljs-number">1</span>; <span class="hljs-comment">// æ‰§è¡Œé˜¶æ®µï¼šèµ‹å€¼</span>
</code></pre>
<blockquote>
<p>âš ï¸ è¿™è¿èƒŒç›´è§‰ï¼šæ˜æ˜è¿˜æ²¡å£°æ˜ï¼Œå´èƒ½è®¿é—®ï¼ˆå€¼ä¸ºÂ <code>undefined</code>ï¼‰ï¼Œææ˜“å¼•å‘éšè”½ bugã€‚</p>
</blockquote>
<h4 data-id="heading-3">2.Â <strong>æ²¡æœ‰å—çº§ä½œç”¨åŸŸ</strong></h4>
<p><code>var</code>Â åªæœ‰<strong>å‡½æ•°ä½œç”¨åŸŸ</strong>ï¼Œæ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼ˆ<code>{}</code>Â å†…éƒ¨ï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) { 
    <span class="hljs-keyword">var</span> x = <span class="hljs-number">1</span>; 
} 
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(x); <span class="hljs-comment">// 1 â€”â€” x æ³„éœ²åˆ°å¤–éƒ¨ï¼</span>
</code></pre>
<p>è¿™åœ¨å¾ªç¯ä¸­å°¤å…¶å±é™©ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) { 
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i), <span class="hljs-number">100</span>); 
} <span class="hljs-comment">// è¾“å‡ºï¼š3, 3, 3ï¼ˆä¸æ˜¯ 0,1,2ï¼ï¼‰</span>
</code></pre>
<h4 data-id="heading-4">3.Â <strong>å¯é‡å¤å£°æ˜</strong></h4>
<p>åŒä¸€ä½œç”¨åŸŸå†…å¯å¤šæ¬¡å£°æ˜åŒåÂ <code>var</code>Â å˜é‡ï¼Œä¸ä¼šæŠ¥é”™ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>; 
<span class="hljs-keyword">var</span> a = <span class="hljs-number">2</span>; <span class="hljs-comment">// åˆæ³•ï¼Œä½†æ˜“é€ æˆæ··ä¹±</span>
</code></pre>
<h3 data-id="heading-5">ğŸ”’ ES5 å¦‚ä½•æ¨¡æ‹Ÿâ€œå¸¸é‡â€ï¼Ÿ</h3>
<p>ç”±äºæ²¡æœ‰çœŸæ­£çš„å¸¸é‡ï¼Œå¼€å‘è€…çº¦å®šï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> <span class="hljs-variable constant_">PI</span> = <span class="hljs-number">3.1415926</span>; <span class="hljs-comment">// å…¨å¤§å†™è¡¨ç¤ºâ€œä¸åº”ä¿®æ”¹â€</span>
</code></pre>
<p>ä½†è¿™åªæ˜¯<strong>ç¼–ç¨‹ä¹ æƒ¯</strong>ï¼Œæ— æ³•é˜»æ­¢æ„å¤–èµ‹å€¼ã€‚</p>
<hr/>
<h2 data-id="heading-6">äºŒã€ES6 çš„é©å‘½ï¼š<code>let</code>Â ä¸Â <code>const</code></h2>
<p>2015 å¹´ï¼ŒES6ï¼ˆES2015ï¼‰å‘å¸ƒï¼Œå¼•å…¥äº†Â <code>let</code>Â å’ŒÂ <code>const</code>ï¼Œä½¿ JavaScript æ›´é€‚åˆå¤§å‹é¡¹ç›®å¼€å‘ã€‚</p>
<h3 data-id="heading-7">âœ… æ ¸å¿ƒæ”¹è¿›</h3>
<h4 data-id="heading-8">1.Â <strong>å—çº§ä½œç”¨åŸŸï¼ˆBlock Scopeï¼‰</strong></h4>
<p><code>let</code>/<code>const</code>Â çš„ä½œç”¨åŸŸä¸¥æ ¼é™åˆ¶åœ¨Â <code>{}</code>Â å†…ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) { 
<span class="hljs-keyword">let</span> y = <span class="hljs-number">2</span>; <span class="hljs-keyword">const</span> z = <span class="hljs-number">3</span>; 
} 
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(y); <span class="hljs-comment">// ReferenceError: y is not defined </span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(z); <span class="hljs-comment">// ReferenceError: z is not defined</span>
</code></pre>
<h4 data-id="heading-9">2.Â <strong>æš‚æ—¶æ€§æ­»åŒºï¼ˆTemporal Dead Zone, TDZï¼‰</strong></h4>
<p>è™½ç„¶Â <code>let</code>/<code>const</code>Â åœ¨ç¼–è¯‘é˜¶æ®µä¹Ÿä¼šè¢«â€œæå‡â€ï¼Œä½†åœ¨å£°æ˜å‰è®¿é—®ä¼šæŠ¥é”™ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b); <span class="hljs-comment">// ReferenceError: Cannot access 'b' before initialization </span>
<span class="hljs-keyword">let</span> b = <span class="hljs-number">2</span>;
</code></pre>
<blockquote>
<p>ğŸ“ŒÂ <strong>å…³é”®æ¾„æ¸…</strong>ï¼š</p>
<ul>
<li><code>var</code>Â æå‡åå€¼ä¸ºÂ <code>undefined</code>ï¼›</li>
<li><code>let</code>/<code>const</code>Â æå‡åå¤„äºâ€œæ­»åŒºâ€ï¼Œè®¿é—®å³æŠ¥é”™ã€‚<br/>
<strong>è¿™ä¸æ˜¯â€œæ²¡æœ‰æå‡â€ï¼Œè€Œæ˜¯â€œæå‡ä½†ä¸å¯è®¿é—®â€</strong> ã€‚</li>
</ul>
</blockquote>
<h4 data-id="heading-10">3.Â <strong>ç¦æ­¢é‡å¤å£°æ˜</strong></h4>
<p>åŒä¸€å—ä½œç”¨åŸŸå†…ä¸èƒ½é‡å¤å£°æ˜ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">let</span> c = <span class="hljs-number">1</span>;
<span class="hljs-keyword">let</span> c = <span class="hljs-number">2</span>; <span class="hljs-comment">// SyntaxError: Identifier 'c' has already been declared</span>
</code></pre>
<h2 data-id="heading-11">ä¸‰ã€<code>let</code>Â vsÂ <code>const</code>ï¼šä½•æ—¶ä½¿ç”¨å“ªä¸ªï¼Ÿ</h2>

























<table><thead><tr><th>ç‰¹æ€§</th><th>let</th><th>const</th></tr></thead><tbody><tr><td>å¯é‡æ–°èµ‹å€¼</td><td>æ˜¯</td><td>å¦</td></tr><tr><td>å¿…é¡»åˆå§‹åŒ–</td><td>å¦</td><td>æ˜¯</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>å€¼ä¼šå˜åŒ–çš„å˜é‡ï¼ˆå¦‚è®¡æ•°å™¨ï¼‰</td><td>å€¼ä¸å˜çš„å˜é‡ï¼ˆå¦‚é…ç½®ã€API åœ°å€ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-12">âš ï¸ é‡è¦ï¼š<code>const</code>Â ä¸ä»£è¡¨â€œå€¼ä¸å¯å˜â€</h3>
<ul>
<li><strong>åŸºæœ¬ç±»å‹</strong>ï¼ˆnumber, string, booleanï¼‰ï¼šå€¼ç¡®å®ä¸å¯å˜ã€‚</li>
<li><strong>å¼•ç”¨ç±»å‹</strong>ï¼ˆobject, arrayï¼‰ï¼š<strong>ä¸èƒ½æ”¹å˜å¼•ç”¨åœ°å€ï¼Œä½†å¯ä¿®æ”¹å†…éƒ¨å±æ€§</strong>ã€‚</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> person = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span> };
person.<span class="hljs-property">name</span> = <span class="hljs-string">"Bob"</span>; <span class="hljs-comment">// âœ… åˆæ³•ï¼</span>
person = {}; <span class="hljs-comment">// âŒ TypeError: Assignment to constant variable.</span>
</code></pre>
<h3 data-id="heading-13">ğŸ”’ å¦‚ä½•çœŸæ­£å†»ç»“å¯¹è±¡ï¼Ÿ</h3>
<p>è‹¥éœ€å®Œå…¨ç¦æ­¢ä¿®æ”¹å¯¹è±¡ï¼Œä½¿ç”¨Â <code>Object.freeze()</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> wes = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">freeze</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span> }); 
wes.<span class="hljs-property">name</span> = <span class="hljs-string">"Bob"</span>; <span class="hljs-comment">// ä¸¥æ ¼æ¨¡å¼ä¸‹æŠ¥é”™ï¼Œéä¸¥æ ¼æ¨¡å¼é™é»˜å¤±è´¥</span>
</code></pre>
<h2 data-id="heading-14">å››ã€å‡½æ•°æå‡ vs å˜é‡æå‡</h2>
<p>ä½ çš„ç¬”è®°æåˆ°ï¼šâ€œå‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œä¼šè¿›è¡Œå‡½æ•°æå‡â€ã€‚</p>
<p>âœ…Â <strong>æ­£ç¡®</strong>ï¼šå‡½æ•°å£°æ˜ä¼šè¢«å®Œæ•´æå‡ï¼ˆåŒ…æ‹¬å‡½æ•°ä½“ï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">sayHi</span>(); <span class="hljs-comment">// "Hello" </span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">sayHi</span>(<span class="hljs-params"/>) { 
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Hello"</span>);
}
</code></pre>
<p>âŒÂ <strong>ä½†éœ€æ³¨æ„</strong>ï¼š<strong>å‡½æ•°è¡¨è¾¾å¼</strong>ä¸ä¼šæå‡ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">sayHello</span>(); <span class="hljs-comment">// TypeError: sayHello is not a function </span>
<span class="hljs-keyword">const</span> sayHello = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { 
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Hi"</span>);
};
</code></pre>
<blockquote>
<p>ğŸ“Œ æ€»ç»“ï¼š</p>
<ul>
<li><code>function foo() {}</code>Â â†’ å®Œæ•´æå‡</li>
<li><code>var foo = function() {}</code>Â â†’ ä»…å˜é‡åæå‡ï¼ˆå€¼ä¸ºÂ <code>undefined</code>ï¼‰</li>
<li><code>let/const foo = function() {}</code>Â â†’ å¤„äº TDZï¼Œæå‰è®¿é—®æŠ¥é”™</li>
</ul>
</blockquote>
<hr/>
<h2 data-id="heading-15">äº”ã€å¸¸è§é”™è¯¯è§£æ</h2>

























<table><thead><tr><th>é”™è¯¯ä¿¡æ¯</th><th>åŸå› </th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>ReferenceError: height is not defined</td><td>åœ¨ä½œç”¨åŸŸå¤–è®¿é—®å˜é‡</td><td>æ£€æŸ¥å˜é‡æ˜¯å¦åœ¨å½“å‰ä½œç”¨åŸŸå†…å£°æ˜</td></tr><tr><td>TypeError: Assignment to constant variable.</td><td>å¯¹Â <code>const</code>Â å˜é‡é‡æ–°èµ‹å€¼</td><td>æ”¹ç”¨Â <code>let</code>ï¼Œæˆ–ç¡®ä¿ä¸é‡æ–°èµ‹å€¼</td></tr><tr><td>ReferenceError: Cannot access 'PI' before initialization</td><td>åœ¨ TDZ ä¸­è®¿é—®Â <code>let</code>/<code>const</code></td><td>å°†å˜é‡å£°æ˜ç§»åˆ°ä½¿ç”¨å‰</td></tr></tbody></table>
<h2 data-id="heading-16">å…­ã€ç°ä»£å¼€å‘æœ€ä½³å®è·µ</h2>
<ol>
<li>
<p><strong>å½»åº•å¼ƒç”¨Â <code>var</code></strong><br/>
<code>let</code>/<code>const</code>Â å·²è¦†ç›–æ‰€æœ‰åœºæ™¯ï¼Œ<code>var</code>Â åªä¼šå¢åŠ è®¤çŸ¥è´Ÿæ‹…ã€‚</p>
</li>
<li>
<p><strong>é»˜è®¤ä½¿ç”¨Â <code>const</code></strong><br/>
é™¤éæ˜ç¡®çŸ¥é“å˜é‡ä¼šé‡æ–°èµ‹å€¼ï¼Œå¦åˆ™ä¸€å¾‹ç”¨Â <code>const</code>ã€‚</p>
<blockquote>
<p>â€œMutable by default is the root of all evil.â€ â€”â€” å‡½æ•°å¼ç¼–ç¨‹ç†å¿µ</p>
</blockquote>
</li>
<li>
<p><strong>åˆç†ä½¿ç”¨Â <code>Object.freeze()</code></strong><br/>
å¯¹éœ€è¦å®Œå…¨ä¸å¯å˜çš„å¯¹è±¡è¿›è¡Œå†»ç»“ã€‚</p>
</li>
<li>
<p><strong>é¿å…åœ¨å—å¤–è®¿é—®å—å†…å˜é‡</strong><br/>
åˆ©ç”¨å—çº§ä½œç”¨åŸŸå°è£…é€»è¾‘ï¼Œå‡å°‘å…¨å±€æ±¡æŸ“ã€‚</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-17">ç»“è¯­</h2>
<p>ä»Â <code>var</code>Â åˆ°Â <code>let/const</code>ï¼Œä¸ä»…æ˜¯è¯­æ³•çš„æ›´æ–°ï¼Œæ›´æ˜¯ JavaScript å‘<strong>å·¥ç¨‹åŒ–ã€å¯ç»´æŠ¤æ€§</strong>è¿ˆå‡ºçš„å…³é”®ä¸€æ­¥ã€‚ç†è§£å˜é‡æå‡ã€å—çº§ä½œç”¨åŸŸå’Œæš‚æ—¶æ€§æ­»åŒºï¼Œèƒ½å¸®åŠ©ä½ å†™å‡ºæ›´å¥å£®ã€æ›´æ¸…æ™°çš„ä»£ç ã€‚è®°ä½ï¼š<strong>ç°ä»£ JavaScript å¼€å‘ä¸­ï¼Œ<code>var</code>Â å·²æ˜¯å†å²ï¼Œ<code>const</code>Â æ˜¯é¦–é€‰ï¼Œ<code>let</code>Â æ˜¯å¤‡é€‰</strong>ã€‚æŒæ¡è¿™ä¸€åŸåˆ™ï¼Œä½ å°±å·²ç»ç«™åœ¨äº†ä¸“ä¸šå¼€å‘è€…çš„èµ·è·‘çº¿ä¸Šã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Node.jså¼‚å¸¸å¤„ç†çš„æ·±åº¦æ¢ç´¢ä¸å·¥ç¨‹å®è·µ]]></title>    <link>https://juejin.cn/post/7598376873547268139</link>    <guid>https://juejin.cn/post/7598376873547268139</guid>    <pubDate>2026-01-23T14:00:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598376873547268139" data-draft-id="7598398537248849939" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Node.jså¼‚å¸¸å¤„ç†çš„æ·±åº¦æ¢ç´¢ä¸å·¥ç¨‹å®è·µ"/> <meta itemprop="keywords" content="Node.js"/> <meta itemprop="datePublished" content="2026-01-23T14:00:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¾™å"/> <meta itemprop="url" content="https://juejin.cn/user/1515546071270151"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Node.jså¼‚å¸¸å¤„ç†çš„æ·±åº¦æ¢ç´¢ä¸å·¥ç¨‹å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1515546071270151/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¾™å
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T14:00:56.000Z" title="Fri Jan 23 2026 14:00:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><span href="https://code.juejin.cn/pen/7598555638332964915" class="code-editor-container"><iframe class="code-editor-frame" data-code="code-editor-element" data-code-id="7598555638332964915" data-src="https://code.juejin.cn/pen/7598555638332964915" style="display:none;" loading="lazy"/><span class="loading-placeholder" style="display:none"><img class="placeholder-image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAJElEQVRoge3BMQEAAADCoPVP7WkJoAAAAAAAAAAAAAAAAAAAbjh8AAFte11jAAAAAElFTkSuQmCC" loading="lazy"/><span class="loading-logo"/></span></span></p>
<h2 data-id="heading-0">ä¸€ã€åŸç”ŸNode.jså¼‚å¸¸æœºåˆ¶çš„å±€é™æ€§</h2>
<p>åœ¨æ·±å…¥æ¢è®¨ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£Node.jsåŸç”Ÿå¼‚å¸¸æœºåˆ¶çš„æœ¬è´¨ã€‚Node.jsåŸºäºV8å¼•æ“ï¼Œå…¶å¼‚å¸¸å¤„ç†æœºåˆ¶ç»§æ‰¿è‡ªJavaScriptï¼Œä¸»è¦ä¾èµ–äº Error å¯¹è±¡å’Œ try-catch è¯­å¥ã€‚ç„¶è€Œï¼ŒåŸç”Ÿæœºåˆ¶å­˜åœ¨ä»¥ä¸‹æ˜¾è‘—å±€é™æ€§ï¼š</p>
<h3 data-id="heading-1">1. å¼‚å¸¸ç±»å‹å•ä¸€</h3>
<p>åŸç”ŸErrorå¯¹è±¡åªæœ‰æœ‰é™çš„å­ç±»ï¼š RangeError ã€ TypeError ã€ SyntaxError ã€ ReferenceError ç­‰ï¼Œæ— æ³•æ»¡è¶³å¤æ‚ä¸šåŠ¡åœºæ™¯ä¸‹çš„ç²¾ç»†åŒ–å¼‚å¸¸åˆ†ç±»éœ€æ±‚ã€‚</p>
<h3 data-id="heading-2">2. ç¼ºä¹å¼‚å¸¸é“¾æ”¯æŒ</h3>
<p>åŸç”ŸErrorå¯¹è±¡æ²¡æœ‰å†…ç½®çš„åŸå› ï¼ˆcauseï¼‰å±æ€§ï¼Œæ— æ³•æ¸…æ™°è¡¨è¾¾å¼‚å¸¸ä¹‹é—´çš„å› æœå…³ç³»ï¼Œä¸åˆ©äºé—®é¢˜è¿½è¸ªã€‚</p>
<h3 data-id="heading-3">3. å †æ ˆè¿½è¸ªä¿¡æ¯æœ‰é™</h3>
<p>è™½ç„¶V8æä¾›äº†å †æ ˆè¿½è¸ªï¼Œä½†æ ¼å¼å’Œå†…å®¹ä¸å¤Ÿä¸°å¯Œï¼Œä¸”ç¼ºä¹å¯¹å †æ ˆå»é‡ã€æŠ‘åˆ¶å¼‚å¸¸ç­‰é«˜çº§ç‰¹æ€§çš„æ”¯æŒã€‚</p>
<h3 data-id="heading-4">4. å¼‚å¸¸å¤„ç†æ¨¡å¼ä¸å¤Ÿçµæ´»</h3>
<p>åŸç”Ÿæœºåˆ¶ä¸»è¦ä¾èµ– try-catch å’Œäº‹ä»¶ç›‘å¬ï¼ˆå¦‚ process.on('uncaughtException') ï¼‰ï¼Œåœ¨å¤§å‹åº”ç”¨ä¸­æ˜¾å¾—åŠ›ä¸ä»å¿ƒã€‚</p>
<h2 data-id="heading-5">äºŒã€Javaå¼‚å¸¸ä½“ç³»çš„è®¾è®¡æ€æƒ³ä¸å¯å‘</h2>
<p>Javaå¼‚å¸¸ä½“ç³»æ˜¯ä¸šç•Œå…¬è®¤çš„æˆç†Ÿè®¾è®¡ï¼Œå…¶æ ¸å¿ƒæ€æƒ³åŒ…æ‹¬ï¼š</p>
<ol>
<li>å¼‚å¸¸å±‚æ¬¡ç»“æ„ ï¼šé€šè¿‡ç»§æ‰¿å…³ç³»æ„å»ºå¼‚å¸¸æ ‘ï¼Œä¾¿äºåˆ†ç±»å’Œæ•è·</li>
<li>å—æ£€å¼‚å¸¸ä¸éå—æ£€å¼‚å¸¸ ï¼šåŒºåˆ†ç¼–è¯‘æ—¶å¿…é¡»å¤„ç†çš„å¼‚å¸¸å’Œè¿è¡Œæ—¶å¼‚å¸¸</li>
<li>å¼‚å¸¸é“¾ ï¼šæ”¯æŒåµŒå¥—å¼‚å¸¸ï¼Œæ¸…æ™°è¡¨è¾¾å› æœå…³ç³»</li>
<li>ä¸°å¯Œçš„å †æ ˆè¿½è¸ª ï¼šè¯¦ç»†è®°å½•å¼‚å¸¸å‘ç”Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯</li>
<li>æŠ‘åˆ¶å¼‚å¸¸ ï¼šæ”¯æŒè®°å½•åœ¨try-with-resourcesç­‰åœºæ™¯ä¸­è¢«æŠ‘åˆ¶çš„å¼‚å¸¸
è¿™äº›è®¾è®¡æ€æƒ³ä¸ºæˆ‘ä»¬ä¼˜åŒ–Node.jså¼‚å¸¸å¤„ç†æä¾›äº†å®è´µçš„å‚è€ƒã€‚</li>
</ol>
<h2 data-id="heading-6">ä¸‰ã€åŸºäºJavaæ€æƒ³çš„Node.jså¼‚å¸¸æ‰©å±•å®ç°</h2>
<h3 data-id="heading-7">1. å¼‚å¸¸ä½“ç³»ç»“æ„è®¾è®¡</h3>
<p>æˆ‘ä»¬åˆ†æçš„ ExceptionExtension åº“æ­£æ˜¯åŸºäºJavaå¼‚å¸¸ä½“ç³»è®¾è®¡çš„ï¼Œå…¶æ ¸å¿ƒç±»å±‚æ¬¡ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-built_in">Throwable</span>
â”œâ”€â”€Â <span class="hljs-built_in">Error</span><span class="hljs-title function_ invoke__">Â </span>(åŸç”Ÿ)
â””â”€â”€Â <span class="hljs-built_in">Exception</span>
Â Â Â Â â”œâ”€â”€Â IOException
Â Â Â Â â”‚Â Â Â â”œâ”€â”€Â FileNotFoundException
Â Â Â Â â”‚Â Â Â â””â”€â”€Â EOFException
Â Â Â Â â””â”€â”€Â <span class="hljs-built_in">RuntimeException</span>
Â Â Â Â Â Â Â Â â”œâ”€â”€Â NullPointerException
Â Â Â Â Â Â Â Â â”œâ”€â”€Â IllegalArgumentException
Â Â Â Â Â Â Â Â â”œâ”€â”€Â IndexOutOfBoundsException
Â Â Â Â Â Â Â Â â”‚Â Â Â â”œâ”€â”€Â ArrayIndexOutOfBoundsException
Â Â Â Â Â Â Â Â â”‚Â Â Â â””â”€â”€Â StringIndexOutOfBoundsException
Â Â Â Â Â Â Â Â â””â”€â”€Â ...
</code></pre>
<h3 data-id="heading-8">2. æ ¸å¿ƒå®ç°è§£æ 2.1 Throwableç±» - å¼‚å¸¸ä½“ç³»çš„æ ¹</h3>
<p>Throwable ç±»æ˜¯æ•´ä¸ªå¼‚å¸¸ä½“ç³»çš„åŸºç¡€ï¼Œå®ƒæ‰©å±•äº†åŸç”Ÿ Error å¯¹è±¡ï¼Œæ·»åŠ äº†ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š</p>
<p>å¼‚å¸¸é“¾æ”¯æŒ ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">StackTraceElement</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./StackTraceElement.js"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Throwable</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Error</span> {
    private <span class="hljs-keyword">static</span> readonly <span class="hljs-attr">UNASSIGNED_STACK</span>: <span class="hljs-title class_">StackTraceElement</span>[] = [];
    private <span class="hljs-keyword">static</span> readonly <span class="hljs-attr">SUPPRESSED_SENTINEL</span>: readonly <span class="hljs-title class_">Throwable</span>[] = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">freeze</span>([...<span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">0</span>)]);

    private <span class="hljs-attr">detailMessage</span>: string | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-attr">cause</span>: <span class="hljs-title class_">Throwable</span> | <span class="hljs-literal">null</span> = <span class="hljs-variable language_">this</span>;
    private <span class="hljs-attr">stackTrace</span>: <span class="hljs-title class_">StackTraceElement</span>[] | <span class="hljs-literal">null</span> = <span class="hljs-title class_">Throwable</span>.<span class="hljs-property">UNASSIGNED_STACK</span>;
    private <span class="hljs-attr">suppressedExceptions</span>: <span class="hljs-title class_">Throwable</span>[] = [...<span class="hljs-title class_">Throwable</span>.<span class="hljs-property">SUPPRESSED_SENTINEL</span>];


    private <span class="hljs-keyword">static</span> <span class="hljs-variable constant_">NULL_CAUSE_MESSAGE</span> = <span class="hljs-string">"Cannot suppress a null exception."</span>;
    private <span class="hljs-keyword">static</span> <span class="hljs-variable constant_">SELF_SUPPRESSION_MESSAGE</span> = <span class="hljs-string">"Self-suppression not permitted"</span>;
    private <span class="hljs-keyword">static</span> <span class="hljs-variable constant_">CAUSE_CAPTION</span> = <span class="hljs-string">"Caused by: "</span>;
    private <span class="hljs-keyword">static</span> <span class="hljs-variable constant_">SUPPRESSED_CAPTION</span> = <span class="hljs-string">"Suppressed: "</span>;
    private <span class="hljs-keyword">static</span> <span class="hljs-attr">EMPTY_THROWABLE_ARRAY</span>: <span class="hljs-title class_">Throwable</span>[] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">0</span>);

    <span class="hljs-comment">/**
     * æ„é€ ä¸€ä¸ªæ–°çš„ Throwableã€‚
     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} [message] è¯¦ç»†æ¶ˆæ¯ã€‚
     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Throwable</span>} [cause] åŸå› ï¼ˆç”¨äºå¼‚å¸¸é“¾ï¼‰ã€‚
     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">boolean</span>} [enableSuppression=true] æ˜¯å¦å¯ç”¨æŠ‘åˆ¶å¼‚å¸¸ã€‚
     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">boolean</span>} [writableStackTrace=true] æ˜¯å¦å¡«å……å †æ ˆè¿½è¸ªã€‚
     */</span>
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">
        message?: string,
        cause?: Throwable | <span class="hljs-literal">null</span>,
        enableSuppression: boolean = <span class="hljs-literal">true</span>,
        writableStackTrace: boolean = <span class="hljs-literal">true</span>
    </span>) {
        <span class="hljs-variable language_">super</span>(message);

        <span class="hljs-keyword">if</span> (writableStackTrace) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fillInStackTrace</span>();
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">stackTrace</span> = <span class="hljs-literal">null</span>;
        }

        <span class="hljs-variable language_">this</span>.<span class="hljs-property">detailMessage</span> = message || (cause ? cause.<span class="hljs-title function_">toString</span>() : <span class="hljs-literal">null</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cause</span> = cause !== <span class="hljs-literal">undefined</span> ? cause : <span class="hljs-variable language_">this</span>;

        <span class="hljs-keyword">if</span> (!enableSuppression) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">suppressedExceptions</span> = <span class="hljs-literal">null</span>!;
        }
    }

    <span class="hljs-comment">/** <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string | null</span>} è¿”å›è¯¦ç»†æ¶ˆæ¯å­—ç¬¦ä¸²ã€‚ */</span>
    public <span class="hljs-title function_">getMessage</span>(): string | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">detailMessage</span>;
    }

    <span class="hljs-comment">/** <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Throwable | null</span>} è¿”å›å¼•èµ·æ­¤å¼‚å¸¸çš„åŸå› ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿”å› nullã€‚ */</span>
    public <span class="hljs-title function_">getCause</span>(): <span class="hljs-title class_">Throwable</span> | <span class="hljs-literal">null</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">cause</span> === <span class="hljs-variable language_">this</span> ? <span class="hljs-literal">null</span> : <span class="hljs-variable language_">this</span>.<span class="hljs-property">cause</span>;
    }

    <span class="hljs-comment">/**
     * å°†æ­¤ Throwable çš„åŸå› åˆå§‹åŒ–ä¸ºæŒ‡å®šå€¼ã€‚
     * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Throwable</span>} cause åŸå› ã€‚
     * <span class="hljs-doctag">@throws</span> {<span class="hljs-type">Error</span>} å¦‚æœåŸå› å·²åˆå§‹åŒ–æˆ–è¯•å›¾è‡ªæˆ‘å¯¼è‡´ã€‚
     */</span>
    public <span class="hljs-title function_">initCause</span>(<span class="hljs-attr">cause</span>: <span class="hljs-title class_">Throwable</span>): <span class="hljs-title class_">Throwable</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">cause</span> !== <span class="hljs-variable language_">this</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Can't overwrite cause with <span class="hljs-subst">${cause}</span>`</span>);
        }
        <span class="hljs-keyword">if</span> (cause === <span class="hljs-variable language_">this</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Self-causation not permitted"</span>);
        }
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cause</span> = cause;
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }

    <span class="hljs-comment">/** <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} å¯¹è±¡çš„ç®€çŸ­æè¿°ã€‚ */</span>
    public <span class="hljs-title function_">toString</span>(): string {
        <span class="hljs-keyword">const</span> name = <span class="hljs-variable language_">this</span>.<span class="hljs-property">constructor</span>.<span class="hljs-property">name</span>;
        <span class="hljs-keyword">const</span> msg = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getMessage</span>();
        <span class="hljs-keyword">return</span> msg ? <span class="hljs-string">`<span class="hljs-subst">${name}</span>: <span class="hljs-subst">${msg}</span>`</span> : name;
    }

    <span class="hljs-comment">/** å°†å †æ ˆè¿½è¸ªæ‰“å°è‡³æ§åˆ¶å°ã€‚ */</span>
    public <span class="hljs-title function_">printStackTrace</span>(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">const</span> visited = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>&lt;<span class="hljs-title class_">Throwable</span>&gt;();
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">printEnclosedStackTrace</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">error</span>, [], <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, visited);
    }

    <span class="hljs-comment">/**
     * å†…éƒ¨é€’å½’æ–¹æ³•ï¼Œç”¨äºå¤„ç†åµŒå¥—åŸå› å’ŒæŠ‘åˆ¶çš„å¼‚å¸¸ã€‚
     */</span>
    private <span class="hljs-title function_">printEnclosedStackTrace</span>(
        <span class="hljs-attr">output</span>: <span class="hljs-function">(<span class="hljs-params">msg: string</span>) =&gt;</span> <span class="hljs-keyword">void</span>,
        <span class="hljs-attr">enclosingTrace</span>: <span class="hljs-title class_">StackTraceElement</span>[],
        <span class="hljs-attr">caption</span>: string,
        <span class="hljs-attr">prefix</span>: string,
        <span class="hljs-attr">visited</span>: <span class="hljs-title class_">Set</span>&lt;<span class="hljs-title class_">Throwable</span>&gt;
    ): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">if</span> (visited.<span class="hljs-title function_">has</span>(<span class="hljs-variable language_">this</span>)) {
            <span class="hljs-title function_">output</span>(<span class="hljs-string">`<span class="hljs-subst">${prefix}</span>[CIRCULAR REFERENCE: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.toString()}</span>]`</span>);
            <span class="hljs-keyword">return</span>;
        }
        visited.<span class="hljs-title function_">add</span>(<span class="hljs-variable language_">this</span>);

        <span class="hljs-keyword">const</span> trace = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getOurStackTrace</span>();
        <span class="hljs-comment">// æ¨¡æ‹Ÿ Java å †æ ˆå»é‡é€»è¾‘ï¼ˆçœç•¥å…¬å…±éƒ¨åˆ†ï¼‰</span>
        <span class="hljs-title function_">output</span>(<span class="hljs-string">`<span class="hljs-subst">${prefix}</span><span class="hljs-subst">${caption}</span><span class="hljs-subst">${<span class="hljs-variable language_">this</span>.toString()}</span>`</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> element <span class="hljs-keyword">of</span> trace) {
            <span class="hljs-title function_">output</span>(<span class="hljs-string">`<span class="hljs-subst">${prefix}</span>\tat <span class="hljs-subst">${element.toString()}</span>`</span>);
        }

        <span class="hljs-comment">// æ‰“å°æŠ‘åˆ¶çš„å¼‚å¸¸</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> se <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSuppressed</span>()) {
            se.<span class="hljs-title function_">printEnclosedStackTrace</span>(output, trace, <span class="hljs-string">"Suppressed: "</span>, prefix + <span class="hljs-string">"\t"</span>, visited);
        }

        <span class="hljs-comment">// æ‰“å°åŸå› </span>
        <span class="hljs-keyword">const</span> cause = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCause</span>();
        <span class="hljs-keyword">if</span> (cause) {
            cause.<span class="hljs-title function_">printEnclosedStackTrace</span>(output, trace, <span class="hljs-string">"Caused by: "</span>, prefix, visited);
        }
    }

    <span class="hljs-comment">/**
     * å¡«å……å †æ ˆè¿½è¸ªä¿¡æ¯ã€‚åœ¨ JS ç¯å¢ƒä¸­ï¼Œè¿™é€šå¸¸é€šè¿‡ Error å¯¹è±¡è·å–ã€‚
     */</span>
    public <span class="hljs-title function_">fillInStackTrace</span>(): <span class="hljs-title class_">Throwable</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">stackTrace</span> !== <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">const</span> error = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>();
            <span class="hljs-title class_">Error</span>.<span class="hljs-title function_">captureStackTrace</span>(error, <span class="hljs-variable language_">this</span>.<span class="hljs-property">constructor</span>);
            <span class="hljs-keyword">const</span> rawStack = error.<span class="hljs-property">stack</span> || <span class="hljs-string">""</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">stackTrace</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">parseStackTrace</span>(rawStack);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }

    private <span class="hljs-title function_">parseStackTrace</span>(<span class="hljs-attr">rawStack</span>: string): <span class="hljs-title class_">StackTraceElement</span>[] {
        <span class="hljs-comment">// ç§»é™¤ç¬¬ä¸€è¡Œï¼ˆé€šå¸¸æ˜¯ "Error"ï¼‰</span>
        <span class="hljs-keyword">const</span> stackLines = rawStack.<span class="hljs-title function_">split</span>(<span class="hljs-string">"\n"</span>).<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>);

        <span class="hljs-keyword">return</span> stackLines.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">line</span> =&gt;</span> {
            <span class="hljs-keyword">const</span> trimmedLine = line.<span class="hljs-title function_">trim</span>();
            <span class="hljs-keyword">if</span> (!trimmedLine.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"at"</span>)) {
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StackTraceElement</span>(<span class="hljs-string">""</span>, <span class="hljs-string">"&lt;unknown&gt;"</span>, <span class="hljs-literal">null</span>, -<span class="hljs-number">1</span>);
            }

            <span class="hljs-comment">// æ›´çµæ´»çš„æ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŒ¹é…å¤šç§å †æ ˆæ ¼å¼</span>
            <span class="hljs-comment">// æ”¯æŒï¼š</span>
            <span class="hljs-comment">// - at å‡½æ•°å (æ–‡ä»¶è·¯å¾„:è¡Œå·:åˆ—å·)</span>
            <span class="hljs-comment">// - at æ–‡ä»¶è·¯å¾„:è¡Œå·:åˆ—å·</span>
            <span class="hljs-comment">// - at å¯¹è±¡.æ–¹æ³• (æ–‡ä»¶è·¯å¾„:è¡Œå·:åˆ—å·)</span>
            <span class="hljs-comment">// - at ç±».æ–¹æ³• (æ–‡ä»¶è·¯å¾„:è¡Œå·:åˆ—å·)</span>
            <span class="hljs-keyword">const</span> match = trimmedLine.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/^at\s+(?:([^\s(]+)(?:\s+|\.)|)\s*(?:([^.\s]+)\s*\.|)([^\s(]+)?\s*\(([^:]+):(\d+):(\d+)\)|^at\s+([^:]+):(\d+):(\d+)$/</span>);

            <span class="hljs-keyword">if</span> (match) {
                <span class="hljs-keyword">let</span> declaringClass = <span class="hljs-string">""</span>;
                <span class="hljs-keyword">let</span> methodName = <span class="hljs-string">"&lt;anonymous&gt;"</span>;
                <span class="hljs-keyword">let</span> fileName = <span class="hljs-literal">null</span>;
                <span class="hljs-keyword">let</span> lineNumber = -<span class="hljs-number">1</span>;

                <span class="hljs-comment">// å¤„ç†åŒ…å«æ‹¬å·çš„æ ¼å¼</span>
                <span class="hljs-keyword">if</span> (match[<span class="hljs-number">5</span>]) {
                    <span class="hljs-comment">// æƒ…å†µ1: at å¯¹è±¡/ç±».æ–¹æ³• (æ–‡ä»¶è·¯å¾„:è¡Œå·:åˆ—å·)</span>
                    <span class="hljs-keyword">if</span> (match[<span class="hljs-number">1</span>] &amp;&amp; match[<span class="hljs-number">3</span>]) {
                        declaringClass = match[<span class="hljs-number">1</span>];
                        methodName = match[<span class="hljs-number">3</span>];
                    }
                    <span class="hljs-comment">// æƒ…å†µ2: at æ–¹æ³• (æ–‡ä»¶è·¯å¾„:è¡Œå·:åˆ—å·)</span>
                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (match[<span class="hljs-number">3</span>]) {
                        methodName = match[<span class="hljs-number">3</span>];
                    }
                    fileName = match[<span class="hljs-number">4</span>];
                    lineNumber = <span class="hljs-built_in">parseInt</span>(match[<span class="hljs-number">5</span>], <span class="hljs-number">10</span>);
                }
                <span class="hljs-comment">// å¤„ç†ç›´æ¥æ–‡ä»¶è·¯å¾„çš„æ ¼å¼</span>
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (match[<span class="hljs-number">7</span>]) {
                    fileName = match[<span class="hljs-number">7</span>];
                    lineNumber = <span class="hljs-built_in">parseInt</span>(match[<span class="hljs-number">8</span>], <span class="hljs-number">10</span>);
                }

                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StackTraceElement</span>(declaringClass, methodName, fileName, lineNumber);
            }

            <span class="hljs-comment">// æ— æ³•è§£æçš„è¡Œï¼Œç›´æ¥è¿”å›åŸå§‹è¡Œä½œä¸ºè°ƒè¯•ä¿¡æ¯</span>
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StackTraceElement</span>(<span class="hljs-string">""</span>, trimmedLine, <span class="hljs-literal">null</span>, -<span class="hljs-number">1</span>);
        });
    }

    private <span class="hljs-title function_">getOurStackTrace</span>(): <span class="hljs-title class_">StackTraceElement</span>[] {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">stackTrace</span> || <span class="hljs-title class_">Throwable</span>.<span class="hljs-property">UNASSIGNED_STACK</span>;
    }

    <span class="hljs-comment">/** <span class="hljs-doctag">@param</span> {<span class="hljs-type">Throwable</span>} exception è¦é™„åŠ çš„è¢«æŠ‘åˆ¶å¼‚å¸¸ã€‚ */</span>
    public <span class="hljs-title function_">addSuppressed</span>(<span class="hljs-attr">exception</span>: <span class="hljs-title class_">Throwable</span>): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">if</span> (exception === <span class="hljs-variable language_">this</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Self-suppression not permitted"</span>);
        <span class="hljs-keyword">if</span> (!exception) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Cannot suppress a null exception."</span>);

        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">suppressedExceptions</span> === <span class="hljs-title class_">Throwable</span>.<span class="hljs-property">SUPPRESSED_SENTINEL</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">suppressedExceptions</span> = [];
        }
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">suppressedExceptions</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">suppressedExceptions</span>.<span class="hljs-title function_">push</span>(exception);
        }
    }

    <span class="hljs-comment">/** <span class="hljs-doctag">@returns</span> {<span class="hljs-type">Throwable[]</span>} è¿”å›åŒ…å«æ‰€æœ‰è¢«æŠ‘åˆ¶å¼‚å¸¸çš„æ•°ç»„ã€‚ */</span>
    public <span class="hljs-title function_">getSuppressed</span>(): <span class="hljs-title class_">Throwable</span>[] {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">suppressedExceptions</span> || [];
    }
}

</code></pre>
<h4 data-id="heading-9">å¢å¼ºçš„å †æ ˆè¿½è¸ª ï¼š</h4>
<ul>
<li>
<p>è‡ªå®šä¹‰ fillInStackTrace() æ–¹æ³•ï¼Œåˆ©ç”¨ Error.captureStackTrace() è·å–åŸå§‹å †æ ˆ</p>
</li>
<li>
<p>å®ç° parseStackTrace() æ–¹æ³•ï¼Œå°†åŸç”Ÿå †æ ˆå­—ç¬¦ä¸²è§£æä¸ºç»“æ„åŒ–çš„ StackTraceElement æ•°ç»„</p>
</li>
<li>
<p>æ”¯æŒå †æ ˆå»é‡å’ŒåµŒå¥—æ‰“å° 2.2 StackTraceElementç±» - ç»“æ„åŒ–å †æ ˆå…ƒç´ 
StackTraceElement ç±»å°è£…äº†å †æ ˆå¸§çš„è¯¦ç»†ä¿¡æ¯ï¼š</p>
</li>
<li>
<p>å£°æ˜ç±»åï¼ˆdeclaringClassï¼‰</p>
</li>
<li>
<p>æ–¹æ³•åï¼ˆmethodNameï¼‰</p>
</li>
<li>
<p>æ–‡ä»¶åï¼ˆfileNameï¼‰</p>
</li>
<li>
<p>è¡Œå·ï¼ˆlineNumberï¼‰
è¿™ç§ç»“æ„åŒ–è®¾è®¡ä½¿å¾—å †æ ˆä¿¡æ¯æ›´æ˜“äºåˆ†æå’Œå¤„ç†ã€‚
2.3 å¼‚å¸¸åˆ†ç±»ä¸æ‰©å±•
åº“ä¸­å®ç°äº†å¤šç§å¼‚å¸¸ç±»å‹ï¼Œæ¯ç§ç±»å‹éƒ½æœ‰ç‰¹å®šçš„ç”¨é€”å’Œæ‰©å±•å±æ€§ï¼š</p>
</li>
<li>
<p>IllegalArgumentException ï¼šè®°å½•å‚æ•°å</p>
</li>
<li>
<p>IndexOutOfBoundsException ï¼šè®°å½•è¶Šç•Œç´¢å¼•</p>
</li>
<li>
<p>FileNotFoundException ï¼šè®°å½•æ–‡ä»¶å
è¿™äº›æ‰©å±•å±æ€§ä¸ºè°ƒè¯•å’Œç›‘æ§æä¾›äº†æ›´ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p>
</li>
</ul>
<h2 data-id="heading-10">å››ã€é«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-11">1. å¼‚å¸¸é“¾çš„åˆç†ä½¿ç”¨</h3>
<p>å¼‚å¸¸é“¾å…è®¸æˆ‘ä»¬åœ¨æ•è·ä¸€ä¸ªå¼‚å¸¸åï¼ŒæŠ›å‡ºæ–°çš„å¼‚å¸¸å¹¶ä¿ç•™åŸå§‹å¼‚å¸¸ä½œä¸ºåŸå› ï¼Œè¿™åœ¨åˆ†å±‚æ¶æ„ä¸­å°¤ä¸ºé‡è¦ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">try</span>Â {
Â Â Â Â <span class="hljs-comment">//Â åº•å±‚æ“ä½œï¼Œå¯èƒ½æŠ›å‡ºIOException</span>
Â Â Â Â <span class="hljs-keyword">await</span>Â fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">'data.txt'</span>,Â <span class="hljs-string">'utf8'</span>);
}Â <span class="hljs-keyword">catch</span>Â (e)Â {
Â Â Â Â <span class="hljs-comment">//Â åŒ…è£…ä¸ºä¸šåŠ¡å¼‚å¸¸ï¼Œä¿ç•™åŸå§‹åŸå› </span>
Â Â Â Â <span class="hljs-keyword">throw</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">BusinessException</span>(<span class="hljs-string">'è¯»å–é…ç½®æ–‡ä»¶å¤±è´¥'</span>,Â 
Â Â Â Â e);
}
</code></pre>
<h3 data-id="heading-12">2. æŠ‘åˆ¶å¼‚å¸¸çš„åº”ç”¨åœºæ™¯</h3>
<p>æŠ‘åˆ¶å¼‚å¸¸ä¸»è¦ç”¨äºèµ„æºç®¡ç†åœºæ™¯ï¼Œå¦‚ç±»ä¼¼Java try-with-resourcesçš„å®ç°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">async</span>Â <span class="hljs-keyword">function</span>Â withResource&lt;T&gt;(<span class="hljs-attr">resource</span>:Â <span class="hljs-title class_">AutoCloseable</span>,Â <span class="hljs-attr">action</span>:Â <span class="hljs-function">()Â =&gt;</span>Â <span class="hljs-title class_">Promise</span>&lt;T&gt;):Â <span class="hljs-title class_">Promise</span>&lt;T&gt;Â {
Â Â Â Â <span class="hljs-keyword">let</span>Â <span class="hljs-attr">suppressed</span>:Â <span class="hljs-title class_">Throwable</span>[]Â =Â [];
Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">await</span>Â <span class="hljs-title function_">action</span>();
Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (primary)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">await</span>Â resource.<span class="hljs-title function_">close</span>();
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (closeError)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å…³é—­èµ„æºçš„å¼‚å¸¸ä½œä¸ºæŠ‘åˆ¶å¼‚å¸¸è®°å½•</span>
Â Â Â Â Â Â Â Â Â Â Â Â primary.<span class="hljs-title function_">addSuppressed</span>(closeError);
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â <span class="hljs-keyword">throw</span>Â primary;
Â Â Â Â }
Â Â Â Â <span class="hljs-comment">//Â ...</span>
}
</code></pre>
<h3 data-id="heading-13">3. è‡ªå®šä¹‰å¼‚å¸¸çš„è®¾è®¡åŸåˆ™</h3>
<p>åœ¨è®¾è®¡è‡ªå®šä¹‰å¼‚å¸¸æ—¶ï¼Œåº”éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š</p>
<ol>
<li>åˆç†çš„å±‚æ¬¡ç»“æ„ ï¼šåŸºäºä¸šåŠ¡é¢†åŸŸæ„å»ºå¼‚å¸¸æ ‘</li>
<li>ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ ï¼šæ·»åŠ æœ‰åŠ©äºè°ƒè¯•çš„æ‰©å±•å±æ€§</li>
<li>æ˜ç¡®çš„å‘½å ï¼šå¼‚å¸¸åç§°åº”æ¸…æ™°è¡¨è¾¾å¼‚å¸¸ç±»å‹</li>
<li>æä¾›æœ‰æ„ä¹‰çš„é”™è¯¯æ¶ˆæ¯ ï¼šåŒ…å«å…³é”®ä¸Šä¸‹æ–‡ä¿¡æ¯</li>
</ol>
<h3 data-id="heading-14">4. å¼‚å¸¸å¤„ç†çš„åˆ†å±‚ç­–ç•¥</h3>
<p>åœ¨å¤§å‹åº”ç”¨ä¸­ï¼Œå»ºè®®é‡‡ç”¨åˆ†å±‚å¼‚å¸¸å¤„ç†ç­–ç•¥ï¼š</p>
<ul>
<li>åº•å±‚ ï¼šæŠ›å‡ºå…·ä½“çš„æŠ€æœ¯å¼‚å¸¸ï¼ˆå¦‚IOå¼‚å¸¸ã€æ•°æ®åº“å¼‚å¸¸ï¼‰</li>
<li>ä¸­é—´å±‚ ï¼šæ•è·æŠ€æœ¯å¼‚å¸¸ï¼Œè½¬æ¢ä¸ºä¸šåŠ¡å¼‚å¸¸å¹¶ä¿ç•™åŸå§‹åŸå› </li>
<li>ä¸Šå±‚ ï¼šå¤„ç†ä¸šåŠ¡å¼‚å¸¸ï¼Œè¿”å›å‹å¥½çš„é”™è¯¯ä¿¡æ¯ç»™ç”¨æˆ·</li>
</ul>
<h3 data-id="heading-15">5. å¼‚å¸¸ç›‘æ§ä¸åˆ†æ</h3>
<p>ç»“æ„åŒ–çš„å¼‚å¸¸è®¾è®¡ä¾¿äºå®ç°æœ‰æ•ˆçš„ç›‘æ§å’Œåˆ†æï¼š</p>
<ul>
<li>å¯ä»¥åŸºäºå¼‚å¸¸ç±»å‹è¿›è¡Œåˆ†ç±»ç»Ÿè®¡</li>
<li>æ‰©å±•å±æ€§æä¾›äº†æ›´ä¸°å¯Œçš„ç›‘æ§ç»´åº¦</li>
<li>å®Œæ•´çš„å¼‚å¸¸é“¾ä¾¿äºæ ¹å› åˆ†æ</li>
</ul>
<h2 data-id="heading-16">äº”ã€æ€§èƒ½è€ƒè™‘</h2>
<p>å¼‚å¸¸å¤„ç†æ˜¯æœ‰æ€§èƒ½å¼€é”€çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨é¢‘ç¹æŠ›å‡ºå¼‚å¸¸çš„åœºæ™¯ä¸‹ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æ€§èƒ½ä¼˜åŒ–å»ºè®®ï¼š</p>
<ol>
<li>é¿å…åœ¨æ­£å¸¸æµç¨‹ä¸­ä½¿ç”¨å¼‚å¸¸ ï¼šå¼‚å¸¸åº”ä»…ç”¨äºå¼‚å¸¸æƒ…å†µ</li>
<li>åˆç†è®¾ç½®writableStackTrace ï¼šå¯¹äºé¢‘ç¹æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¯ä»¥è€ƒè™‘ç¦ç”¨å †æ ˆè¿½è¸ª</li>
<li>æ³¨æ„å¼‚å¸¸é“¾çš„é•¿åº¦ ï¼šè¿‡é•¿çš„å¼‚å¸¸é“¾ä¼šå¢åŠ å†…å­˜å ç”¨å’Œåºåˆ—åŒ–å¼€é”€</li>
<li>é¿å…ä¸å¿…è¦çš„å¼‚å¸¸åŒ…è£… ï¼šåªåœ¨éœ€è¦è½¬æ¢å¼‚å¸¸ç±»å‹æˆ–æ·»åŠ ä¸Šä¸‹æ–‡æ—¶æ‰åŒ…è£…</li>
</ol>
<h2 data-id="heading-17">å…­ã€ä¸åŸç”Ÿå¼‚å¸¸æœºåˆ¶çš„å…¼å®¹</h2>
<p>è¯¥å¼‚å¸¸æ‰©å±•åº“ä¿æŒäº†ä¸åŸç”Ÿå¼‚å¸¸æœºåˆ¶çš„è‰¯å¥½å…¼å®¹ï¼š</p>
<ul>
<li>æ‰€æœ‰è‡ªå®šä¹‰å¼‚å¸¸éƒ½ç»§æ‰¿è‡ªåŸç”Ÿ Error å¯¹è±¡</li>
<li>å¯ä»¥ä½¿ç”¨åŸç”Ÿ try-catch è¯­å¥æ•è·</li>
<li>æ”¯æŒä¸åŸç”Ÿå¼‚å¸¸æ··åˆä½¿ç”¨</li>
<li>å¯ä»¥æ— ç¼é›†æˆåˆ°ç°æœ‰Node.jsé¡¹ç›®ä¸­</li>
</ul>
<h2 data-id="heading-18">æµ‹è¯•ç”¨ä¾‹</h2>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Throwable</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../src/ExceptionExtension/Throwable.js'</span>;

<span class="hljs-comment">// åˆ›å»ºThrowableçš„å­ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Exception</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Throwable</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">message?: string, cause?: Throwable | <span class="hljs-literal">null</span></span>) {
        <span class="hljs-variable language_">super</span>(message, cause);
    }
}

<span class="hljs-comment">// åˆ›å»ºExceptionçš„å­ç±»ï¼ˆå³Throwableçš„å­™å­ç±»ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">GrandchildException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Exception</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">message?: string, cause?: Throwable | <span class="hljs-literal">null</span></span>) {
        <span class="hljs-variable language_">super</span>(message, cause);
    }
    
    <span class="hljs-comment">// æ·»åŠ ä¸€ä¸ªæ–¹æ³•ç”¨äºæµ‹è¯•å †æ ˆ</span>
    public <span class="hljs-title function_">doSomething</span>(): <span class="hljs-keyword">void</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">throwException</span>();
    }
    
    private <span class="hljs-title function_">throwException</span>(): <span class="hljs-keyword">void</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-variable language_">this</span>;
    }
}

<span class="hljs-comment">// æµ‹è¯•å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">testGrandchildStackTrace</span>(<span class="hljs-params"/>): <span class="hljs-keyword">void</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"=== æµ‹è¯•Throwableå­™å­ç±»å †æ ˆè·Ÿè¸ª ==="</span>);
    
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// ç›´æ¥å®ä¾‹åŒ–å¹¶æŠ›å‡º</span>
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GrandchildException</span>(<span class="hljs-string">"ç›´æ¥æŠ›å‡ºçš„å­™å­å¼‚å¸¸"</span>);
    } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-keyword">if</span> (e <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Throwable</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"1. ç›´æ¥æŠ›å‡ºçš„å †æ ˆ:"</span>);
            e.<span class="hljs-title function_">printStackTrace</span>();
        }
    }
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">50</span>) + <span class="hljs-string">"\n"</span>);
    
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// é€šè¿‡æ–¹æ³•è°ƒç”¨é“¾æŠ›å‡º</span>
        <span class="hljs-keyword">const</span> exception = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GrandchildException</span>(<span class="hljs-string">"é€šè¿‡æ–¹æ³•è°ƒç”¨æŠ›å‡ºçš„å­™å­å¼‚å¸¸"</span>);
        exception.<span class="hljs-title function_">doSomething</span>();
    } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-keyword">if</span> (e <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Throwable</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"2. é€šè¿‡æ–¹æ³•è°ƒç”¨æŠ›å‡ºçš„å †æ ˆ:"</span>);
            e.<span class="hljs-title function_">printStackTrace</span>();
        }
    }
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">50</span>) + <span class="hljs-string">"\n"</span>);
    
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// æµ‹è¯•å¼‚å¸¸é“¾</span>
        <span class="hljs-keyword">const</span> cause = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Exception</span>(<span class="hljs-string">"æ ¹æœ¬åŸå› "</span>);
        <span class="hljs-keyword">const</span> exception = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GrandchildException</span>(<span class="hljs-string">"åŒ…è£…äº†åŸå› çš„å­™å­å¼‚å¸¸"</span>, cause);
        <span class="hljs-keyword">throw</span> exception;
    } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-keyword">if</span> (e <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Throwable</span>) {
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"3. å¸¦åŸå› çš„å¼‚å¸¸é“¾å †æ ˆ:"</span>);
            e.<span class="hljs-title function_">printStackTrace</span>();
        }
    }
}

<span class="hljs-comment">// æ‰§è¡Œæµ‹è¯•</span>
<span class="hljs-title function_">testGrandchildStackTrace</span>();
</code></pre>
<p>ç»“æœ:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f617c1bb50bc4e1f8ce3764e928aeb9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6b6Z5Y2O:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769781656&amp;x-signature=oGBoeBA9L4Kad3tbz5E8g3IIBr0%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-19">ä¸ƒã€æ€»ç»“ä¸å±•æœ›</h2>
<p>é€šè¿‡æ¨¡ä»¿Javaå¼‚å¸¸ä½“ç³»çš„è®¾è®¡æ€æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾è‘—å¢å¼ºNode.jsçš„å¼‚å¸¸å¤„ç†èƒ½åŠ›ã€‚ ExceptionExtension åº“æä¾›äº†ï¼š</p>
<ol>
<li>ä¸°å¯Œçš„å¼‚å¸¸ç±»å‹å’Œå±‚æ¬¡ç»“æ„</li>
<li>å®Œæ•´çš„å¼‚å¸¸é“¾æ”¯æŒ</li>
<li>ç»“æ„åŒ–çš„å †æ ˆè¿½è¸ªä¿¡æ¯</li>
<li>æŠ‘åˆ¶å¼‚å¸¸åŠŸèƒ½</li>
<li>è‰¯å¥½çš„æ‰©å±•æ€§
è¿™äº›ç‰¹æ€§ä½¿å¾—å¼‚å¸¸å¤„ç†æ›´åŠ ç²¾ç»†åŒ–ã€ç»“æ„åŒ–å’Œå¯ç®¡ç†ï¼Œç‰¹åˆ«é€‚åˆå¤§å‹å¤æ‚åº”ç”¨ã€‚</li>
</ol>
<p>æœªæ¥ï¼Œéšç€Node.jsç”Ÿæ€çš„ä¸æ–­å‘å±•ï¼Œæˆ‘ä»¬å¯ä»¥æœŸå¾…ï¼š</p>
<ol>
<li>æ›´å®Œå–„çš„ç±»å‹æ”¯æŒï¼ˆå¦‚TypeScriptè£…é¥°å™¨ç”¨äºå¼‚å¸¸å…ƒæ•°æ®ï¼‰</li>
<li>ä¸æ—¥å¿—ç³»ç»Ÿçš„æ·±åº¦é›†æˆ</li>
<li>åŸºäºå¼‚å¸¸æ•°æ®çš„æ™ºèƒ½åˆ†æå·¥å…·</li>
<li>æ›´é«˜æ•ˆçš„å¼‚å¸¸åºåˆ—åŒ–å’Œä¼ è¾“æœºåˆ¶
ä½œä¸ºé«˜çº§å·¥ç¨‹å¸ˆï¼ŒæŒæ¡å¹¶åˆç†åº”ç”¨è¿™äº›é«˜çº§å¼‚å¸¸å¤„ç†æŠ€æœ¯ï¼Œå¯¹äºæ„å»ºå¯é ã€å¯ç»´æŠ¤çš„å¤§å‹Node.jsåº”ç”¨è‡³å…³é‡è¦ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring AI + MCPï¼šä»å…¥é—¨åˆ°å®æˆ˜]]></title>    <link>https://juejin.cn/post/7598699872539803667</link>    <guid>https://juejin.cn/post/7598699872539803667</guid>    <pubDate>2026-01-24T01:44:55.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598699872539803667" data-draft-id="7598021313870446598" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring AI + MCPï¼šä»å…¥é—¨åˆ°å®æˆ˜"/> <meta itemprop="keywords" content="Spring,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-24T01:44:55.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ä¸­é£˜è¡çš„è®°å¿†"/> <meta itemprop="url" content="https://juejin.cn/user/694547077666606"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring AI + MCPï¼šä»å…¥é—¨åˆ°å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547077666606/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ä¸­é£˜è¡çš„è®°å¿†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T01:44:55.000Z" title="Sat Jan 24 2026 01:44:55 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Spring AI + MCPï¼šä»å…¥é—¨åˆ°å®æˆ˜</h2>
<h2 data-id="heading-1">ä¸€ã€ä»€ä¹ˆæ˜¯MCPï¼Ÿ</h2>
<p>MCPï¼ˆModel Context Protocolï¼Œæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰æ˜¯ç”±Anthropicæ¨å‡ºçš„ä¸€ç§å¼€æ”¾åè®®ï¼Œæ—¨åœ¨è§£å†³AIåŠ©æ‰‹ä¸å¤–éƒ¨æ•°æ®æºå’Œå·¥å…·ä¹‹é—´çš„è¿æ¥é—®é¢˜ã€‚MCPå®šä¹‰äº†ä¸€å¥—æ ‡å‡†åŒ–çš„é€šä¿¡æœºåˆ¶ï¼Œä½¿å¾—AIåº”ç”¨èƒ½å¤Ÿå®‰å…¨ã€é«˜æ•ˆåœ°è®¿é—®å¤–éƒ¨èµ„æºã€‚</p>
<h3 data-id="heading-2">1.1 MCPæ ¸å¿ƒæ¦‚å¿µ</h3>
<p>MCPåè®®ä¸»è¦åŒ…å«ä¸‰ä¸ªæ ¸å¿ƒè§’è‰²ï¼š</p>
<ul>
<li><strong>MCP Clientï¼ˆå®¢æˆ·ç«¯ï¼‰</strong> ï¼šå‘èµ·è¯·æ±‚çš„åº”ç”¨ç¨‹åºï¼Œé€šå¸¸æ˜¯AIåŠ©æ‰‹æˆ–åº”ç”¨</li>
<li><strong>MCP Serverï¼ˆæœåŠ¡ç«¯ï¼‰</strong> ï¼šæä¾›èµ„æºå’Œå·¥å…·çš„æœåŠ¡ï¼Œå°è£…äº†æ•°æ®è®¿é—®é€»è¾‘</li>
<li><strong>Hostï¼ˆå®¿ä¸»ï¼‰</strong> ï¼šè¿è¡ŒMCPå®¢æˆ·ç«¯çš„åº”ç”¨ç¨‹åº</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7293a01fa86d4247b2f493d0137402c4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769823895&amp;x-signature=ZLas7R1QEVbCUE0Wh41x8%2BdB9wY%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">1.2 MCPå·¥ä½œåŸç†</h3>
<p>MCPä½¿ç”¨JSON-RPC 2.0åè®®è¿›è¡Œé€šä¿¡ï¼Œæ”¯æŒä¸¤ç§ä¼ è¾“æ–¹å¼ï¼š</p>
<ul>
<li><strong>stdioï¼ˆæ ‡å‡†è¾“å…¥è¾“å‡ºï¼‰</strong> ï¼šé€‚ç”¨äºæœ¬åœ°è¿›ç¨‹é—´é€šä¿¡</li>
<li><strong>SSEï¼ˆServer-Sent Eventsï¼‰</strong> ï¼šé€‚ç”¨äºåŸºäºHTTPçš„è¿œç¨‹é€šä¿¡</li>
</ul>
<h3 data-id="heading-4">1.3 ä¸ºä»€ä¹ˆé€‰æ‹©MCPï¼Ÿ</h3>
<ol>
<li><strong>æ ‡å‡†åŒ–æ¥å£</strong>ï¼šç»Ÿä¸€çš„åè®®ï¼Œé™ä½é›†æˆå¤æ‚åº¦</li>
<li><strong>å®‰å…¨æ€§</strong>ï¼šæ¸…æ™°çš„æƒé™æ§åˆ¶æœºåˆ¶</li>
<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šæ”¯æŒè‡ªå®šä¹‰èµ„æºå’Œå·¥å…·</li>
<li><strong>è·¨å¹³å°</strong>ï¼šè¯­è¨€æ— å…³çš„åè®®æ ‡å‡†</li>
</ol>
<h2 data-id="heading-5">äºŒã€ç¯å¢ƒæ­å»º</h2>
<h3 data-id="heading-6">2.1 Mavenä¾èµ–é…ç½®</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span>
         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0
         http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.2.5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.example<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mcp-demo<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>MCP Demo Project<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span>Spring AI + MCP Integration Demo<span class="hljs-tag">&lt;/<span class="hljs-name">description</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">java.version</span>&gt;</span>17<span class="hljs-tag">&lt;/<span class="hljs-name">java.version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">spring-ai.version</span>&gt;</span>1.0.0-M4<span class="hljs-tag">&lt;/<span class="hljs-name">spring-ai.version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- Spring Boot Web --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- Spring AI OpenAI --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-openai-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- MCP SDK --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.anthropic<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mcp-sdk<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- JSONå¤„ç† --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jackson-databind<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- Lombok --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- æµ‹è¯•ä¾èµ– --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.junit.jupiter<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit-jupiter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-bom<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${spring-ai.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">repositories</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>spring-milestones<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Spring Milestones<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://repo.spring.io/milestone<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">snapshots</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">enabled</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">enabled</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">snapshots</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">repositories</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span>
</code></pre>
<h3 data-id="heading-7">2.2 é…ç½®æ–‡ä»¶</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># application.yml</span>
<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">application:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">mcp-demo</span>
  <span class="hljs-attr">ai:</span>
    <span class="hljs-attr">openai:</span>
      <span class="hljs-attr">api-key:</span> <span class="hljs-string">${OPENAI_API_KEY:sk-your-api-key}</span>
      <span class="hljs-attr">chat:</span>
        <span class="hljs-attr">options:</span>
          <span class="hljs-attr">model:</span> <span class="hljs-string">gpt-4</span>
          <span class="hljs-attr">temperature:</span> <span class="hljs-number">0.7</span>

<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>

<span class="hljs-attr">mcp:</span>
  <span class="hljs-attr">server:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">demo-mcp-server</span>
    <span class="hljs-attr">version:</span> <span class="hljs-number">1.0</span><span class="hljs-number">.0</span>
  <span class="hljs-attr">client:</span>
    <span class="hljs-attr">timeout:</span> <span class="hljs-number">30000</span>
<span class="hljs-attr">logging:</span>
  <span class="hljs-attr">level:</span>
    <span class="hljs-attr">com.example.mcp:</span> <span class="hljs-string">DEBUG</span>
    <span class="hljs-attr">org.springframework.ai:</span> <span class="hljs-string">DEBUG</span>
</code></pre>
<h2 data-id="heading-8">ä¸‰ã€MCPæœåŠ¡ç«¯å®ç°</h2>
<h3 data-id="heading-9">3.1 MCPæœåŠ¡ç«¯æ ¸å¿ƒæ¥å£</h3>
<p>MCPæœåŠ¡ç«¯éœ€è¦å®ç°ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6fcb6f004174db1ba14ad3873084e57~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769823895&amp;x-signature=xNQfIj98PkFg7ijRNr7TUPn9BMA%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-10">3.2 å®ç°MCPæœåŠ¡ç«¯</h3>
<pre><code class="hljs language-typescript" lang="typescript">package com.<span class="hljs-property">example</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">server</span>;

<span class="hljs-keyword">import</span> com.<span class="hljs-property">fasterxml</span>.<span class="hljs-property">jackson</span>.<span class="hljs-property">core</span>.<span class="hljs-property">JsonProcessingException</span>;
<span class="hljs-keyword">import</span> com.<span class="hljs-property">fasterxml</span>.<span class="hljs-property">jackson</span>.<span class="hljs-property">databind</span>.<span class="hljs-property">JsonNode</span>;
<span class="hljs-keyword">import</span> com.<span class="hljs-property">fasterxml</span>.<span class="hljs-property">jackson</span>.<span class="hljs-property">databind</span>.<span class="hljs-property">ObjectMapper</span>;
<span class="hljs-keyword">import</span> lombok.<span class="hljs-property">extern</span>.<span class="hljs-property">slf4j</span>.<span class="hljs-property">Slf4j</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">stereotype</span>.<span class="hljs-property">Component</span>;

<span class="hljs-keyword">import</span> java.<span class="hljs-property">util</span>.*;

<span class="hljs-comment">/**
 * MCPæœåŠ¡ç«¯æ ¸å¿ƒå®ç°
 */</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">McpServer</span> {

    <span class="hljs-keyword">private</span> final <span class="hljs-title class_">ObjectMapper</span> objectMapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectMapper</span>();
    <span class="hljs-keyword">private</span> final <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">McpTool</span>&gt; tools = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    <span class="hljs-keyword">private</span> final <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">McpResource</span>&gt; resources = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();

    <span class="hljs-keyword">public</span> <span class="hljs-title class_">McpServer</span>() {
        <span class="hljs-title function_">initializeTools</span>();
        <span class="hljs-title function_">initializeResources</span>();
    }

    <span class="hljs-comment">/**
     * åˆå§‹åŒ–å¯ç”¨å·¥å…·
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">initializeTools</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// ç”¨æˆ·æŸ¥è¯¢å·¥å…·</span>
        tools.<span class="hljs-title function_">put</span>(<span class="hljs-string">"query_user"</span>, <span class="hljs-title class_">McpTool</span>.<span class="hljs-title function_">builder</span>()
                .<span class="hljs-title function_">name</span>(<span class="hljs-string">"query_user"</span>)
                .<span class="hljs-title function_">description</span>(<span class="hljs-string">"æ ¹æ®ç”¨æˆ·IDæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯"</span>)
                .<span class="hljs-title function_">inputSchema</span>(<span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
                    <span class="hljs-string">"type"</span>, <span class="hljs-string">"object"</span>,
                    <span class="hljs-string">"properties"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
                        <span class="hljs-string">"userId"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
                            <span class="hljs-string">"type"</span>, <span class="hljs-string">"string"</span>,
                            <span class="hljs-string">"description"</span>, <span class="hljs-string">"ç”¨æˆ·ID"</span>
                        )
                    ),
                    <span class="hljs-string">"required"</span>, <span class="hljs-title class_">List</span>.<span class="hljs-title function_">of</span>(<span class="hljs-string">"userId"</span>)
                ))
                .<span class="hljs-title function_">build</span>());

        <span class="hljs-comment">// æ•°æ®åˆ†æå·¥å…·</span>
        tools.<span class="hljs-title function_">put</span>(<span class="hljs-string">"analyze_data"</span>, <span class="hljs-title class_">McpTool</span>.<span class="hljs-title function_">builder</span>()
                .<span class="hljs-title function_">name</span>(<span class="hljs-string">"analyze_data"</span>)
                .<span class="hljs-title function_">description</span>(<span class="hljs-string">"åˆ†æä¸šåŠ¡æ•°æ®å¹¶ç”ŸæˆæŠ¥å‘Š"</span>)
                .<span class="hljs-title function_">inputSchema</span>(<span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
                    <span class="hljs-string">"type"</span>, <span class="hljs-string">"object"</span>,
                    <span class="hljs-string">"properties"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
                        <span class="hljs-string">"dataType"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
                            <span class="hljs-string">"type"</span>, <span class="hljs-string">"string"</span>,
                            <span class="hljs-string">"description"</span>, <span class="hljs-string">"æ•°æ®ç±»å‹"</span>,
                            <span class="hljs-string">"enum"</span>, <span class="hljs-title class_">List</span>.<span class="hljs-title function_">of</span>(<span class="hljs-string">"sales"</span>, <span class="hljs-string">"traffic"</span>, <span class="hljs-string">"user"</span>)
                        ),
                        <span class="hljs-string">"dateRange"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
                            <span class="hljs-string">"type"</span>, <span class="hljs-string">"object"</span>,
                            <span class="hljs-string">"description"</span>, <span class="hljs-string">"æ—¥æœŸèŒƒå›´"</span>,
                            <span class="hljs-string">"properties"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
                                <span class="hljs-string">"start"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(<span class="hljs-string">"type"</span>, <span class="hljs-string">"string"</span>, <span class="hljs-string">"format"</span>, <span class="hljs-string">"date"</span>),
                                <span class="hljs-string">"end"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(<span class="hljs-string">"type"</span>, <span class="hljs-string">"string"</span>, <span class="hljs-string">"format"</span>, <span class="hljs-string">"date"</span>)
                            )
                        )
                    ),
                    <span class="hljs-string">"required"</span>, <span class="hljs-title class_">List</span>.<span class="hljs-title function_">of</span>(<span class="hljs-string">"dataType"</span>)
                ))
                .<span class="hljs-title function_">build</span>());

        <span class="hljs-comment">// æ–‡ä»¶æ“ä½œå·¥å…·</span>
        tools.<span class="hljs-title function_">put</span>(<span class="hljs-string">"read_file"</span>, <span class="hljs-title class_">McpTool</span>.<span class="hljs-title function_">builder</span>()
                .<span class="hljs-title function_">name</span>(<span class="hljs-string">"read_file"</span>)
                .<span class="hljs-title function_">description</span>(<span class="hljs-string">"è¯»å–æ–‡ä»¶å†…å®¹"</span>)
                .<span class="hljs-title function_">inputSchema</span>(<span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
                    <span class="hljs-string">"type"</span>, <span class="hljs-string">"object"</span>,
                    <span class="hljs-string">"properties"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
                        <span class="hljs-string">"filePath"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
                            <span class="hljs-string">"type"</span>, <span class="hljs-string">"string"</span>,
                            <span class="hljs-string">"description"</span>, <span class="hljs-string">"æ–‡ä»¶è·¯å¾„"</span>
                        )
                    ),
                    <span class="hljs-string">"required"</span>, <span class="hljs-title class_">List</span>.<span class="hljs-title function_">of</span>(<span class="hljs-string">"filePath"</span>)
                ))
                .<span class="hljs-title function_">build</span>());

        log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Initialized {} tools"</span>, tools.<span class="hljs-title function_">size</span>());
    }

    <span class="hljs-comment">/**
     * åˆå§‹åŒ–å¯ç”¨èµ„æº
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">initializeResources</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// ç”¨æˆ·åˆ—è¡¨èµ„æº</span>
        resources.<span class="hljs-title function_">put</span>(<span class="hljs-string">"user://list"</span>, <span class="hljs-title class_">McpResource</span>.<span class="hljs-title function_">builder</span>()
                .<span class="hljs-title function_">uri</span>(<span class="hljs-string">"user://list"</span>)
                .<span class="hljs-title function_">name</span>(<span class="hljs-string">"ç”¨æˆ·åˆ—è¡¨"</span>)
                .<span class="hljs-title function_">description</span>(<span class="hljs-string">"ç³»ç»Ÿä¸­çš„æ‰€æœ‰ç”¨æˆ·åˆ—è¡¨"</span>)
                .<span class="hljs-title function_">mimeType</span>(<span class="hljs-string">"application/json"</span>)
                .<span class="hljs-title function_">build</span>());

        <span class="hljs-comment">// ç³»ç»Ÿé…ç½®èµ„æº</span>
        resources.<span class="hljs-title function_">put</span>(<span class="hljs-string">"config://system"</span>, <span class="hljs-title class_">McpResource</span>.<span class="hljs-title function_">builder</span>()
                .<span class="hljs-title function_">uri</span>(<span class="hljs-string">"config://system"</span>)
                .<span class="hljs-title function_">name</span>(<span class="hljs-string">"ç³»ç»Ÿé…ç½®"</span>)
                .<span class="hljs-title function_">description</span>(<span class="hljs-string">"ç³»ç»Ÿçº§åˆ«çš„é…ç½®ä¿¡æ¯"</span>)
                .<span class="hljs-title function_">mimeType</span>(<span class="hljs-string">"application/json"</span>)
                .<span class="hljs-title function_">build</span>());

        log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Initialized {} resources"</span>, resources.<span class="hljs-title function_">size</span>());
    }

    <span class="hljs-comment">/**
     * å¤„ç†MCPè¯·æ±‚
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">handleRequest</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> requestJson</span>) {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-title class_">JsonNode</span> root = objectMapper.<span class="hljs-title function_">readTree</span>(requestJson);
            <span class="hljs-title class_">String</span> method = root.<span class="hljs-title function_">get</span>(<span class="hljs-string">"method"</span>).<span class="hljs-title function_">asText</span>();

            log.<span class="hljs-title function_">debug</span>(<span class="hljs-string">"Handling MCP request: {}"</span>, method);

            <span class="hljs-keyword">return</span> <span class="hljs-keyword">switch</span> (method) {
                <span class="hljs-keyword">case</span> <span class="hljs-string">"initialize"</span> -&gt; <span class="hljs-title function_">handleInitialize</span>(root);
                <span class="hljs-keyword">case</span> <span class="hljs-string">"tools/list"</span> -&gt; <span class="hljs-title function_">handleListTools</span>();
                <span class="hljs-keyword">case</span> <span class="hljs-string">"tools/call"</span> -&gt; <span class="hljs-title function_">handleCallTool</span>(root);
                <span class="hljs-keyword">case</span> <span class="hljs-string">"resources/list"</span> -&gt; <span class="hljs-title function_">handleListResources</span>();
                <span class="hljs-keyword">case</span> <span class="hljs-string">"resources/read"</span> -&gt; <span class="hljs-title function_">handleReadResource</span>(root);
                <span class="hljs-keyword">default</span> -&gt; <span class="hljs-title function_">createErrorResponse</span>(-<span class="hljs-number">32601</span>, <span class="hljs-string">"Method not found: "</span> + method);
            };
        } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Exception</span> e) {
            log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Error handling MCP request"</span>, e);
            <span class="hljs-keyword">return</span> <span class="hljs-title function_">createErrorResponse</span>(-<span class="hljs-number">32603</span>, <span class="hljs-string">"Internal error: "</span> + e.<span class="hljs-title function_">getMessage</span>());
        }
    }

    <span class="hljs-comment">/**
     * å¤„ç†åˆå§‹åŒ–è¯·æ±‚
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">handleInitialize</span>(<span class="hljs-params">JsonNode request</span>) {
        <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"protocolVersion"</span>, <span class="hljs-string">"2024-11-05"</span>);
        result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"serverInfo"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
            <span class="hljs-string">"name"</span>, <span class="hljs-string">"demo-mcp-server"</span>,
            <span class="hljs-string">"version"</span>, <span class="hljs-string">"1.0.0"</span>
        ));
        result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"capabilities"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
            <span class="hljs-string">"tools"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(),
            <span class="hljs-string">"resources"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>()
        ));

        <span class="hljs-keyword">return</span> <span class="hljs-title function_">createSuccessResponse</span>(request, result);
    }

    <span class="hljs-comment">/**
     * å¤„ç†å·¥å…·åˆ—è¡¨è¯·æ±‚
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">handleListTools</span>(<span class="hljs-params"/>) {
        <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt;&gt; toolList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-keyword">for</span> (<span class="hljs-title class_">McpTool</span> tool : tools.<span class="hljs-title function_">values</span>()) {
            <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; toolInfo = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
            toolInfo.<span class="hljs-title function_">put</span>(<span class="hljs-string">"name"</span>, tool.<span class="hljs-title function_">getName</span>());
            toolInfo.<span class="hljs-title function_">put</span>(<span class="hljs-string">"description"</span>, tool.<span class="hljs-title function_">getDescription</span>());
            toolInfo.<span class="hljs-title function_">put</span>(<span class="hljs-string">"inputSchema"</span>, tool.<span class="hljs-title function_">getInputSchema</span>());
            toolList.<span class="hljs-title function_">add</span>(toolInfo);
        }

        <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"tools"</span>, toolList);

        <span class="hljs-keyword">return</span> <span class="hljs-title function_">createSuccessResponse</span>(<span class="hljs-literal">null</span>, result);
    }

    <span class="hljs-comment">/**
     * å¤„ç†å·¥å…·è°ƒç”¨è¯·æ±‚
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">handleCallTool</span>(<span class="hljs-title class_">JsonNode</span> request) throws <span class="hljs-title class_">JsonProcessingException</span> {
        <span class="hljs-title class_">String</span> toolName = request.<span class="hljs-title function_">get</span>(<span class="hljs-string">"params"</span>).<span class="hljs-title function_">get</span>(<span class="hljs-string">"name"</span>).<span class="hljs-title function_">asText</span>();
        <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; <span class="hljs-variable language_">arguments</span> = objectMapper.<span class="hljs-title function_">convertValue</span>(
            request.<span class="hljs-title function_">get</span>(<span class="hljs-string">"params"</span>).<span class="hljs-title function_">get</span>(<span class="hljs-string">"arguments"</span>),
            <span class="hljs-title class_">Map</span>.<span class="hljs-property">class</span>
        );

        log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Calling tool: {} with arguments: {}"</span>, toolName, <span class="hljs-variable language_">arguments</span>);

        <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; result = <span class="hljs-title function_">executeTool</span>(toolName, <span class="hljs-variable language_">arguments</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">createSuccessResponse</span>(request, result);
    }

    <span class="hljs-comment">/**
     * æ‰§è¡Œå·¥å…·é€»è¾‘
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; <span class="hljs-title function_">executeTool</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> toolName, <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">Object</span>&gt; <span class="hljs-variable language_">arguments</span></span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">switch</span> (toolName) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">"query_user"</span> -&gt; <span class="hljs-title function_">executeQueryUser</span>(<span class="hljs-variable language_">arguments</span>);
            <span class="hljs-keyword">case</span> <span class="hljs-string">"analyze_data"</span> -&gt; <span class="hljs-title function_">executeAnalyzeData</span>(<span class="hljs-variable language_">arguments</span>);
            <span class="hljs-keyword">case</span> <span class="hljs-string">"read_file"</span> -&gt; <span class="hljs-title function_">executeReadFile</span>(<span class="hljs-variable language_">arguments</span>);
            <span class="hljs-keyword">default</span> -&gt; <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(<span class="hljs-string">"error"</span>, <span class="hljs-string">"Unknown tool: "</span> + toolName);
        };
    }

    <span class="hljs-comment">/**
     * æŸ¥è¯¢ç”¨æˆ·å·¥å…·å®ç°
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; <span class="hljs-title function_">executeQueryUser</span>(<span class="hljs-params"><span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">Object</span>&gt; <span class="hljs-variable language_">arguments</span></span>) {
        <span class="hljs-title class_">String</span> userId = (<span class="hljs-title class_">String</span>) <span class="hljs-variable language_">arguments</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">"userId"</span>);

        <span class="hljs-comment">// æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢</span>
        <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; user = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        user.<span class="hljs-title function_">put</span>(<span class="hljs-string">"id"</span>, userId);
        user.<span class="hljs-title function_">put</span>(<span class="hljs-string">"name"</span>, <span class="hljs-string">"å¼ ä¸‰"</span>);
        user.<span class="hljs-title function_">put</span>(<span class="hljs-string">"email"</span>, <span class="hljs-string">"zhangsan@example.com"</span>);
        user.<span class="hljs-title function_">put</span>(<span class="hljs-string">"role"</span>, <span class="hljs-string">"ç®¡ç†å‘˜"</span>);
        user.<span class="hljs-title function_">put</span>(<span class="hljs-string">"status"</span>, <span class="hljs-string">"æ´»è·ƒ"</span>);
        user.<span class="hljs-title function_">put</span>(<span class="hljs-string">"createdAt"</span>, <span class="hljs-string">"2024-01-15T10:30:00Z"</span>);

        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
            <span class="hljs-string">"success"</span>, <span class="hljs-literal">true</span>,
            <span class="hljs-string">"data"</span>, user
        );
    }

    <span class="hljs-comment">/**
     * æ•°æ®åˆ†æå·¥å…·å®ç°
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; <span class="hljs-title function_">executeAnalyzeData</span>(<span class="hljs-params"><span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">Object</span>&gt; <span class="hljs-variable language_">arguments</span></span>) {
        <span class="hljs-title class_">String</span> dataType = (<span class="hljs-title class_">String</span>) <span class="hljs-variable language_">arguments</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">"dataType"</span>);

        <span class="hljs-comment">// æ¨¡æ‹Ÿæ•°æ®åˆ†æ</span>
        <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; analysis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        analysis.<span class="hljs-title function_">put</span>(<span class="hljs-string">"dataType"</span>, dataType);
        analysis.<span class="hljs-title function_">put</span>(<span class="hljs-string">"totalRecords"</span>, <span class="hljs-number">15420</span>);
        analysis.<span class="hljs-title function_">put</span>(<span class="hljs-string">"growth"</span>, <span class="hljs-string">"+23.5%"</span>);
        analysis.<span class="hljs-title function_">put</span>(<span class="hljs-string">"trend"</span>, <span class="hljs-string">"ä¸Šå‡"</span>);

        <span class="hljs-comment">// è¯¦ç»†æ•°æ®</span>
        <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt;&gt; details = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-keyword">for</span> (int i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">7</span>; i++) {
            <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; dayData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
            dayData.<span class="hljs-title function_">put</span>(<span class="hljs-string">"date"</span>, <span class="hljs-string">"2024-01-"</span> + (<span class="hljs-number">15</span> + i));
            dayData.<span class="hljs-title function_">put</span>(<span class="hljs-string">"value"</span>, <span class="hljs-number">1000</span> + (int)(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">500</span>));
            details.<span class="hljs-title function_">add</span>(dayData);
        }
        analysis.<span class="hljs-title function_">put</span>(<span class="hljs-string">"details"</span>, details);

        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
            <span class="hljs-string">"success"</span>, <span class="hljs-literal">true</span>,
            <span class="hljs-string">"analysis"</span>, analysis
        );
    }

    <span class="hljs-comment">/**
     * è¯»å–æ–‡ä»¶å·¥å…·å®ç°
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; <span class="hljs-title function_">executeReadFile</span>(<span class="hljs-params"><span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">Object</span>&gt; <span class="hljs-variable language_">arguments</span></span>) {
        <span class="hljs-title class_">String</span> filePath = (<span class="hljs-title class_">String</span>) <span class="hljs-variable language_">arguments</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">"filePath"</span>);

        <span class="hljs-comment">// æ¨¡æ‹Ÿæ–‡ä»¶è¯»å–</span>
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
            <span class="hljs-string">"success"</span>, <span class="hljs-literal">true</span>,
            <span class="hljs-string">"content"</span>, <span class="hljs-string">"æ–‡ä»¶å†…å®¹ç¤ºä¾‹ï¼š\nè¿™æ˜¯ä» "</span> + filePath + <span class="hljs-string">" è¯»å–çš„å†…å®¹ã€‚\n"</span> +
                      <span class="hljs-string">"åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œåº”è¯¥è¿”å›çœŸå®çš„æ–‡ä»¶å†…å®¹ã€‚"</span>,
            <span class="hljs-string">"lineCount"</span>, <span class="hljs-number">2</span>
        );
    }

    <span class="hljs-comment">/**
     * å¤„ç†èµ„æºåˆ—è¡¨è¯·æ±‚
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">handleListResources</span>(<span class="hljs-params"/>) {
        <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt;&gt; resourceList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-keyword">for</span> (<span class="hljs-title class_">McpResource</span> resource : resources.<span class="hljs-title function_">values</span>()) {
            <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; resourceInfo = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
            resourceInfo.<span class="hljs-title function_">put</span>(<span class="hljs-string">"uri"</span>, resource.<span class="hljs-title function_">getUri</span>());
            resourceInfo.<span class="hljs-title function_">put</span>(<span class="hljs-string">"name"</span>, resource.<span class="hljs-title function_">getName</span>());
            resourceInfo.<span class="hljs-title function_">put</span>(<span class="hljs-string">"description"</span>, resource.<span class="hljs-title function_">getDescription</span>());
            resourceInfo.<span class="hljs-title function_">put</span>(<span class="hljs-string">"mimeType"</span>, resource.<span class="hljs-title function_">getMimeType</span>());
            resourceList.<span class="hljs-title function_">add</span>(resourceInfo);
        }

        <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"resources"</span>, resourceList);

        <span class="hljs-keyword">return</span> <span class="hljs-title function_">createSuccessResponse</span>(<span class="hljs-literal">null</span>, result);
    }

    <span class="hljs-comment">/**
     * å¤„ç†èµ„æºè¯»å–è¯·æ±‚
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">handleReadResource</span>(<span class="hljs-params">JsonNode request</span>) {
        <span class="hljs-title class_">String</span> uri = request.<span class="hljs-title function_">get</span>(<span class="hljs-string">"params"</span>).<span class="hljs-title function_">get</span>(<span class="hljs-string">"uri"</span>).<span class="hljs-title function_">asText</span>();

        <span class="hljs-title class_">McpResource</span> resource = resources.<span class="hljs-title function_">get</span>(uri);
        <span class="hljs-keyword">if</span> (resource == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-title function_">createErrorResponse</span>(-<span class="hljs-number">32602</span>, <span class="hljs-string">"Resource not found: "</span> + uri);
        }

        <span class="hljs-comment">// æ¨¡æ‹Ÿèµ„æºå†…å®¹</span>
        <span class="hljs-title class_">String</span> content = <span class="hljs-keyword">switch</span> (uri) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">"user://list"</span> -&gt; <span class="hljs-string">""</span><span class="hljs-string">"
                {
                  "</span>users<span class="hljs-string">": [
                    {"</span>id<span class="hljs-string">": "</span><span class="hljs-number">1</span><span class="hljs-string">", "</span>name<span class="hljs-string">": "</span>å¼ ä¸‰<span class="hljs-string">", "</span>email<span class="hljs-string">": "</span>zhangsan<span class="hljs-meta">@example</span>.<span class="hljs-property">com</span><span class="hljs-string">"},
                    {"</span>id<span class="hljs-string">": "</span><span class="hljs-number">2</span><span class="hljs-string">", "</span>name<span class="hljs-string">": "</span>æå››<span class="hljs-string">", "</span>email<span class="hljs-string">": "</span>lisi<span class="hljs-meta">@example</span>.<span class="hljs-property">com</span><span class="hljs-string">"},
                    {"</span>id<span class="hljs-string">": "</span><span class="hljs-number">3</span><span class="hljs-string">", "</span>name<span class="hljs-string">": "</span>ç‹äº”<span class="hljs-string">", "</span>email<span class="hljs-string">": "</span>wangwu<span class="hljs-meta">@example</span>.<span class="hljs-property">com</span><span class="hljs-string">"}
                  ],
                  "</span>total<span class="hljs-string">": 3
                }
                "</span><span class="hljs-string">""</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">"config://system"</span> -&gt; <span class="hljs-string">""</span><span class="hljs-string">"
                {
                  "</span>appName<span class="hljs-string">": "</span><span class="hljs-variable constant_">MCP</span> <span class="hljs-title class_">Demo</span><span class="hljs-string">",
                  "</span>version<span class="hljs-string">": "</span><span class="hljs-number">1.0</span><span class="hljs-number">.0</span><span class="hljs-string">",
                  "</span>environment<span class="hljs-string">": "</span>production<span class="hljs-string">",
                  "</span>features<span class="hljs-string">": ["</span>mcp<span class="hljs-string">", "</span>ai<span class="hljs-string">", "</span>analytics<span class="hljs-string">"]
                }
                "</span><span class="hljs-string">""</span>;
            <span class="hljs-keyword">default</span> -&gt; <span class="hljs-string">"{}"</span>;
        };

        <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"contents"</span>, <span class="hljs-title class_">List</span>.<span class="hljs-title function_">of</span>(<span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
            <span class="hljs-string">"uri"</span>, uri,
            <span class="hljs-string">"mimeType"</span>, resource.<span class="hljs-title function_">getMimeType</span>(),
            <span class="hljs-string">"text"</span>, content
        )));

        <span class="hljs-keyword">return</span> <span class="hljs-title function_">createSuccessResponse</span>(request, result);
    }

    <span class="hljs-comment">/**
     * åˆ›å»ºæˆåŠŸå“åº”
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">createSuccessResponse</span>(<span class="hljs-params">JsonNode request, <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">Object</span>&gt; result</span>) {
        <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; response = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        response.<span class="hljs-title function_">put</span>(<span class="hljs-string">"jsonrpc"</span>, <span class="hljs-string">"2.0"</span>);

        <span class="hljs-keyword">if</span> (request != <span class="hljs-literal">null</span> &amp;&amp; request.<span class="hljs-title function_">has</span>(<span class="hljs-string">"id"</span>)) {
            response.<span class="hljs-title function_">put</span>(<span class="hljs-string">"id"</span>, request.<span class="hljs-title function_">get</span>(<span class="hljs-string">"id"</span>));
        }

        response.<span class="hljs-title function_">put</span>(<span class="hljs-string">"result"</span>, result);

        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> objectMapper.<span class="hljs-title function_">writeValueAsString</span>(response);
        } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">JsonProcessingException</span> e) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"{"</span>error<span class="hljs-string">":"</span><span class="hljs-title class_">Failed</span> to serialize response<span class="hljs-string">"}"</span>;
        }
    }

    <span class="hljs-comment">/**
     * åˆ›å»ºé”™è¯¯å“åº”
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">createErrorResponse</span>(<span class="hljs-params">int code, <span class="hljs-built_in">String</span> message</span>) {
        <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; response = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        response.<span class="hljs-title function_">put</span>(<span class="hljs-string">"jsonrpc"</span>, <span class="hljs-string">"2.0"</span>);
        response.<span class="hljs-title function_">put</span>(<span class="hljs-string">"error"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
            <span class="hljs-string">"code"</span>, code,
            <span class="hljs-string">"message"</span>, message
        ));
        response.<span class="hljs-title function_">put</span>(<span class="hljs-string">"id"</span>, <span class="hljs-literal">null</span>);

        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> objectMapper.<span class="hljs-title function_">writeValueAsString</span>(response);
        } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">JsonProcessingException</span> e) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"{"</span>error<span class="hljs-string">":"</span><span class="hljs-title class_">Failed</span> to serialize error<span class="hljs-string">"}"</span>;
        }
    }
}
</code></pre>
<h3 data-id="heading-11">3.3 MCPæ•°æ®æ¨¡å‹</h3>
<pre><code class="hljs language-typescript" lang="typescript">package com.<span class="hljs-property">example</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">server</span>;

<span class="hljs-keyword">import</span> lombok.<span class="hljs-property">AllArgsConstructor</span>;
<span class="hljs-keyword">import</span> lombok.<span class="hljs-property">Builder</span>;
<span class="hljs-keyword">import</span> lombok.<span class="hljs-property">Data</span>;
<span class="hljs-keyword">import</span> lombok.<span class="hljs-property">NoArgsConstructor</span>;

<span class="hljs-keyword">import</span> java.<span class="hljs-property">util</span>.<span class="hljs-property">Map</span>;

<span class="hljs-comment">/**
 * MCPå·¥å…·å®šä¹‰
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@Builder</span>
<span class="hljs-meta">@NoArgsConstructor</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">McpTool</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> name;
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> description;
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; inputSchema;
}

<span class="hljs-comment">/**
 * MCPèµ„æºå®šä¹‰
 */</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@Builder</span>
<span class="hljs-meta">@NoArgsConstructor</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">McpResource</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> uri;
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> name;
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> description;
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> mimeType;
}
</code></pre>
<h3 data-id="heading-12">3.4 MCPæœåŠ¡ç«¯HTTPæ¥å£</h3>
<pre><code class="hljs language-typescript" lang="typescript">package com.<span class="hljs-property">example</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">controller</span>;

<span class="hljs-keyword">import</span> com.<span class="hljs-property">example</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">server</span>.<span class="hljs-property">McpServer</span>;
<span class="hljs-keyword">import</span> lombok.<span class="hljs-property">RequiredArgsConstructor</span>;
<span class="hljs-keyword">import</span> lombok.<span class="hljs-property">extern</span>.<span class="hljs-property">slf4j</span>.<span class="hljs-property">Slf4j</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">web</span>.<span class="hljs-property">bind</span>.<span class="hljs-property">annotation</span>.*;

<span class="hljs-comment">/**
 * MCPæœåŠ¡ç«¯HTTPæ¥å£
 */</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">"/mcp"</span>)
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">McpController</span> {

    <span class="hljs-keyword">private</span> final <span class="hljs-title class_">McpServer</span> mcpServer;

    <span class="hljs-comment">/**
     * å¤„ç†MCPè¯·æ±‚
     */</span>
    <span class="hljs-meta">@PostMapping</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">handleMcpRequest</span>(<span class="hljs-params"><span class="hljs-meta">@RequestBody</span> <span class="hljs-built_in">String</span> request</span>) {
        log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Received MCP request: {}"</span>, request);
        <span class="hljs-title class_">String</span> response = mcpServer.<span class="hljs-title function_">handleRequest</span>(request);
        log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Sending MCP response: {}"</span>, response);
        <span class="hljs-keyword">return</span> response;
    }

    <span class="hljs-comment">/**
     * å¥åº·æ£€æŸ¥
     */</span>
    <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/health"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">String</span>&gt; <span class="hljs-title function_">health</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(<span class="hljs-string">"status"</span>, <span class="hljs-string">"healthy"</span>, <span class="hljs-string">"service"</span>, <span class="hljs-string">"mcp-server"</span>);
    }
}
</code></pre>
<h2 data-id="heading-13">å››ã€MCPå®¢æˆ·ç«¯å®ç°</h2>
<h3 data-id="heading-14">4.1 MCPå®¢æˆ·ç«¯æ¶æ„</h3>
<p>MCPå®¢æˆ·ç«¯è´Ÿè´£ä¸MCPæœåŠ¡ç«¯é€šä¿¡ï¼Œå¹¶å‘åº”ç”¨å±‚æä¾›ç®€æ´çš„APIã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7761245d2474af391103e1daa90bbff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769823895&amp;x-signature=g3956BhEfZC0QgZDh9IKGM9Hsuo%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-15">4.2 å®ç°MCPå®¢æˆ·ç«¯</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.mcp.client;

<span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.JsonNode;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;
<span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;
<span class="hljs-keyword">import</span> org.springframework.http.HttpEntity;
<span class="hljs-keyword">import</span> org.springframework.http.HttpHeaders;
<span class="hljs-keyword">import</span> org.springframework.http.MediaType;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;
<span class="hljs-keyword">import</span> org.springframework.web.client.RestTemplate;

<span class="hljs-keyword">import</span> java.util.*;

<span class="hljs-comment">/**
 * MCPå®¢æˆ·ç«¯å®ç°
 */</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">McpClient</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ObjectMapper</span> <span class="hljs-variable">objectMapper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectMapper</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">RestTemplate</span> <span class="hljs-variable">restTemplate</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RestTemplate</span>();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String serverUrl;
    <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> <span class="hljs-variable">requestId</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">McpClient</span><span class="hljs-params">(String serverUrl)</span> {
        <span class="hljs-built_in">this</span>.serverUrl = serverUrl;
    }

    <span class="hljs-comment">/**
     * åˆå§‹åŒ–è¿æ¥
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initialize</span><span class="hljs-params">()</span> {
        Map&lt;String, Object&gt; params = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        params.put(<span class="hljs-string">"protocolVersion"</span>, <span class="hljs-string">"2024-11-05"</span>);
        params.put(<span class="hljs-string">"capabilities"</span>, Map.of(
            <span class="hljs-string">"roots"</span>, Map.of(<span class="hljs-string">"listChanged"</span>, <span class="hljs-literal">true</span>),
            <span class="hljs-string">"sampling"</span>, Map.of()
        ));

        <span class="hljs-type">JsonNode</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> sendRequest(<span class="hljs-string">"initialize"</span>, params);
        log.info(<span class="hljs-string">"MCP client initialized: {}"</span>, response);
    }

    <span class="hljs-comment">/**
     * è·å–å¯ç”¨å·¥å…·åˆ—è¡¨
     */</span>
    <span class="hljs-keyword">public</span> List&lt;McpClientTool&gt; <span class="hljs-title function_">listTools</span><span class="hljs-params">()</span> {
        <span class="hljs-type">JsonNode</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> sendRequest(<span class="hljs-string">"tools/list"</span>, <span class="hljs-literal">null</span>);
        <span class="hljs-type">JsonNode</span> <span class="hljs-variable">toolsArray</span> <span class="hljs-operator">=</span> response.get(<span class="hljs-string">"result"</span>).get(<span class="hljs-string">"tools"</span>);

        List&lt;McpClientTool&gt; tools = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-keyword">for</span> (JsonNode toolNode : toolsArray) {
            <span class="hljs-type">McpClientTool</span> <span class="hljs-variable">tool</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">McpClientTool</span>(
                toolNode.get(<span class="hljs-string">"name"</span>).asText(),
                toolNode.get(<span class="hljs-string">"description"</span>).asText(),
                toolNode.get(<span class="hljs-string">"inputSchema"</span>).toString()
            );
            tools.add(tool);
        }

        log.info(<span class="hljs-string">"Retrieved {} tools from MCP server"</span>, tools.size());
        <span class="hljs-keyword">return</span> tools;
    }

    <span class="hljs-comment">/**
     * è°ƒç”¨å·¥å…·
     */</span>
    <span class="hljs-keyword">public</span> Map&lt;String, Object&gt; <span class="hljs-title function_">callTool</span><span class="hljs-params">(String toolName, Map&lt;String, Object&gt; arguments)</span> {
        Map&lt;String, Object&gt; params = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        params.put(<span class="hljs-string">"name"</span>, toolName);
        params.put(<span class="hljs-string">"arguments"</span>, arguments);

        <span class="hljs-type">JsonNode</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> sendRequest(<span class="hljs-string">"tools/call"</span>, params);
        <span class="hljs-type">JsonNode</span> <span class="hljs-variable">resultNode</span> <span class="hljs-operator">=</span> response.get(<span class="hljs-string">"result"</span>);

        <span class="hljs-keyword">return</span> objectMapper.convertValue(resultNode, Map.class);
    }

    <span class="hljs-comment">/**
     * è·å–å¯ç”¨èµ„æºåˆ—è¡¨
     */</span>
    <span class="hljs-keyword">public</span> List&lt;McpClientResource&gt; <span class="hljs-title function_">listResources</span><span class="hljs-params">()</span> {
        <span class="hljs-type">JsonNode</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> sendRequest(<span class="hljs-string">"resources/list"</span>, <span class="hljs-literal">null</span>);
        <span class="hljs-type">JsonNode</span> <span class="hljs-variable">resourcesArray</span> <span class="hljs-operator">=</span> response.get(<span class="hljs-string">"result"</span>).get(<span class="hljs-string">"resources"</span>);

        List&lt;McpClientResource&gt; resources = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        <span class="hljs-keyword">for</span> (JsonNode resourceNode : resourcesArray) {
            <span class="hljs-type">McpClientResource</span> <span class="hljs-variable">resource</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">McpClientResource</span>(
                resourceNode.get(<span class="hljs-string">"uri"</span>).asText(),
                resourceNode.get(<span class="hljs-string">"name"</span>).asText(),
                resourceNode.get(<span class="hljs-string">"description"</span>).asText(),
                resourceNode.get(<span class="hljs-string">"mimeType"</span>).asText()
            );
            resources.add(resource);
        }

        log.info(<span class="hljs-string">"Retrieved {} resources from MCP server"</span>, resources.size());
        <span class="hljs-keyword">return</span> resources;
    }

    <span class="hljs-comment">/**
     * è¯»å–èµ„æº
     */</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">readResource</span><span class="hljs-params">(String uri)</span> {
        Map&lt;String, Object&gt; params = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        params.put(<span class="hljs-string">"uri"</span>, uri);

        <span class="hljs-type">JsonNode</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> sendRequest(<span class="hljs-string">"resources/read"</span>, params);
        <span class="hljs-type">JsonNode</span> <span class="hljs-variable">contentsArray</span> <span class="hljs-operator">=</span> response.get(<span class="hljs-string">"result"</span>).get(<span class="hljs-string">"contents"</span>);

        <span class="hljs-keyword">if</span> (contentsArray != <span class="hljs-literal">null</span> &amp;&amp; contentsArray.size() &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> contentsArray.get(<span class="hljs-number">0</span>).get(<span class="hljs-string">"text"</span>).asText();
        }

        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    <span class="hljs-comment">/**
     * å‘é€JSON-RPCè¯·æ±‚
     */</span>
    <span class="hljs-keyword">private</span> JsonNode <span class="hljs-title function_">sendRequest</span><span class="hljs-params">(String method, Map&lt;String, Object&gt; params)</span> {
        <span class="hljs-keyword">try</span> {
            Map&lt;String, Object&gt; request = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
            request.put(<span class="hljs-string">"jsonrpc"</span>, <span class="hljs-string">"2.0"</span>);
            request.put(<span class="hljs-string">"id"</span>, ++requestId);
            request.put(<span class="hljs-string">"method"</span>, method);
            <span class="hljs-keyword">if</span> (params != <span class="hljs-literal">null</span>) {
                request.put(<span class="hljs-string">"params"</span>, params);
            }

            <span class="hljs-type">String</span> <span class="hljs-variable">requestJson</span> <span class="hljs-operator">=</span> objectMapper.writeValueAsString(request);

            <span class="hljs-type">HttpHeaders</span> <span class="hljs-variable">headers</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpHeaders</span>();
            headers.setContentType(MediaType.APPLICATION_JSON);

            HttpEntity&lt;String&gt; entity = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpEntity</span>&lt;&gt;(requestJson, headers);

            <span class="hljs-type">String</span> <span class="hljs-variable">responseJson</span> <span class="hljs-operator">=</span> restTemplate.postForObject(
                serverUrl, entity, String.class
            );

            log.debug(<span class="hljs-string">"MCP request: {}"</span>, requestJson);
            log.debug(<span class="hljs-string">"MCP response: {}"</span>, responseJson);

            <span class="hljs-keyword">return</span> objectMapper.readTree(responseJson);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"Error sending MCP request"</span>, e);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"MCP request failed: "</span> + e.getMessage(), e);
        }
    }

    <span class="hljs-comment">/**
     * å®¢æˆ·ç«¯å·¥å…·å®šä¹‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">McpClientTool</span><span class="hljs-params">(String name, String description, String inputSchema)</span> {}

    <span class="hljs-comment">/**
     * å®¢æˆ·ç«¯èµ„æºå®šä¹‰
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">McpClientResource</span><span class="hljs-params">(String uri, String name, String description, String mimeType)</span> {}
}
</code></pre>
<h3 data-id="heading-16">4.3 MCPå®¢æˆ·ç«¯é…ç½®</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">package</span> com.example.mcp.config;

<span class="hljs-keyword">import</span> com.example.mcp.client.McpClient;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Value;
<span class="hljs-keyword">import</span> org.springframework.context.<span class="hljs-keyword">annotation</span>.Bean;
<span class="hljs-keyword">import</span> org.springframework.context.<span class="hljs-keyword">annotation</span>.Configuration;

<span class="hljs-comment">/**
 * MCPå®¢æˆ·ç«¯é…ç½®
 */</span>
<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">McpClientConfig</span> {

    <span class="hljs-meta">@Value(<span class="hljs-string">"<span class="hljs-subst">${mcp.server.url:http://localhost:<span class="hljs-number">8080</span>/mcp}</span>"</span>)</span>
    <span class="hljs-keyword">private</span> String serverUrl;

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> McpClient mcpClient() {
        McpClient client = new McpClient(serverUrl);
        client.initialize();
        <span class="hljs-keyword">return</span> client;
    }
}
</code></pre>
<h2 data-id="heading-17">äº”ã€Spring AIé›†æˆ</h2>
<h3 data-id="heading-18">5.1 åˆ›å»ºMCPå‡½æ•°è°ƒç”¨</h3>
<pre><code class="hljs language-typescript" lang="typescript">package com.<span class="hljs-property">example</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">ai</span>;

<span class="hljs-keyword">import</span> com.<span class="hljs-property">example</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">client</span>.<span class="hljs-property">McpClient</span>;
<span class="hljs-keyword">import</span> com.<span class="hljs-property">fasterxml</span>.<span class="hljs-property">jackson</span>.<span class="hljs-property">databind</span>.<span class="hljs-property">ObjectMapper</span>;
<span class="hljs-keyword">import</span> lombok.<span class="hljs-property">RequiredArgsConstructor</span>;
<span class="hljs-keyword">import</span> lombok.<span class="hljs-property">extern</span>.<span class="hljs-property">slf4j</span>.<span class="hljs-property">Slf4j</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">context</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">Description</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">stereotype</span>.<span class="hljs-property">Component</span>;

<span class="hljs-keyword">import</span> java.<span class="hljs-property">util</span>.<span class="hljs-property">Map</span>;
<span class="hljs-keyword">import</span> java.<span class="hljs-property">util</span>.<span class="hljs-property">function</span>.<span class="hljs-property">Function</span>;

<span class="hljs-comment">/**
 * MCPå·¥å…·å‡½æ•°ï¼Œä¾›Spring AIè°ƒç”¨
 */</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">McpFunction</span> {

    <span class="hljs-keyword">private</span> final <span class="hljs-title class_">McpClient</span> mcpClient;
    <span class="hljs-keyword">private</span> final <span class="hljs-title class_">ObjectMapper</span> objectMapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectMapper</span>();

    <span class="hljs-comment">/**
     * æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯
     */</span>
    <span class="hljs-meta">@Description</span>(<span class="hljs-string">"æ ¹æ®ç”¨æˆ·IDæŸ¥è¯¢ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬å§“åã€é‚®ç®±ã€è§’è‰²ç­‰"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Function</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">String</span>&gt; <span class="hljs-title function_">queryUser</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> userId -&gt; {
            log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"AIè°ƒç”¨queryUserå·¥å…·ï¼Œå‚æ•°: {}"</span>, userId);

            <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; <span class="hljs-variable language_">arguments</span> = <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(<span class="hljs-string">"userId"</span>, userId);
            <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; result = mcpClient.<span class="hljs-title function_">callTool</span>(<span class="hljs-string">"query_user"</span>, <span class="hljs-variable language_">arguments</span>);

            <span class="hljs-keyword">return</span> <span class="hljs-title function_">formatResult</span>(<span class="hljs-string">"æŸ¥è¯¢ç”¨æˆ·"</span>, result);
        };
    }

    <span class="hljs-comment">/**
     * åˆ†ææ•°æ®
     */</span>
    <span class="hljs-meta">@Description</span>(<span class="hljs-string">"åˆ†æä¸šåŠ¡æ•°æ®å¹¶ç”Ÿæˆåˆ†ææŠ¥å‘Šï¼Œæ”¯æŒé”€å”®ã€æµé‡ã€ç”¨æˆ·ç­‰æ•°æ®ç±»å‹"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Function</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">String</span>&gt; <span class="hljs-title function_">analyzeData</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> dataTypeJson -&gt; {
            log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"AIè°ƒç”¨analyzeDataå·¥å…·ï¼Œå‚æ•°: {}"</span>, dataTypeJson);

            <span class="hljs-keyword">try</span> {
                <span class="hljs-meta">@SuppressWarnings</span>(<span class="hljs-string">"unchecked"</span>)
                <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; <span class="hljs-variable language_">arguments</span> = objectMapper.<span class="hljs-title function_">readValue</span>(dataTypeJson, <span class="hljs-title class_">Map</span>.<span class="hljs-property">class</span>);
                <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; result = mcpClient.<span class="hljs-title function_">callTool</span>(<span class="hljs-string">"analyze_data"</span>, <span class="hljs-variable language_">arguments</span>);

                <span class="hljs-keyword">return</span> <span class="hljs-title function_">formatResult</span>(<span class="hljs-string">"æ•°æ®åˆ†æ"</span>, result);
            } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Exception</span> e) {
                log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"æ•°æ®åˆ†æå¤±è´¥"</span>, e);
                <span class="hljs-keyword">return</span> <span class="hljs-string">"æ•°æ®åˆ†æå¤±è´¥: "</span> + e.<span class="hljs-title function_">getMessage</span>();
            }
        };
    }

    <span class="hljs-comment">/**
     * è¯»å–æ–‡ä»¶
     */</span>
    <span class="hljs-meta">@Description</span>(<span class="hljs-string">"è¯»å–æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶å†…å®¹"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Function</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">String</span>&gt; <span class="hljs-title function_">readFile</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> filePath -&gt; {
            log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"AIè°ƒç”¨readFileå·¥å…·ï¼Œå‚æ•°: {}"</span>, filePath);

            <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; <span class="hljs-variable language_">arguments</span> = <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(<span class="hljs-string">"filePath"</span>, filePath);
            <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; result = mcpClient.<span class="hljs-title function_">callTool</span>(<span class="hljs-string">"read_file"</span>, <span class="hljs-variable language_">arguments</span>);

            <span class="hljs-keyword">return</span> <span class="hljs-title function_">formatResult</span>(<span class="hljs-string">"è¯»å–æ–‡ä»¶"</span>, result);
        };
    }

    <span class="hljs-comment">/**
     * è·å–ç³»ç»Ÿèµ„æº
     */</span>
    <span class="hljs-meta">@Description</span>(<span class="hljs-string">"è·å–ç³»ç»Ÿé…ç½®å’Œèµ„æºä¿¡æ¯"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Function</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">String</span>&gt; <span class="hljs-title function_">getSystemResource</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> uri -&gt; {
            log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"AIè°ƒç”¨getSystemResourceå·¥å…·ï¼Œå‚æ•°: {}"</span>, uri);

            <span class="hljs-title class_">String</span> content = mcpClient.<span class="hljs-title function_">readResource</span>(uri);

            <span class="hljs-keyword">if</span> (content != <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> <span class="hljs-title class_">String</span>.<span class="hljs-title function_">format</span>(<span class="hljs-string">"èµ„æº %s çš„å†…å®¹:\n%s"</span>, uri, content);
            }

            <span class="hljs-keyword">return</span> <span class="hljs-string">"æœªæ‰¾åˆ°èµ„æº: "</span> + uri;
        };
    }

    <span class="hljs-comment">/**
     * æ ¼å¼åŒ–ç»“æœ
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">formatResult</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> operation, <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">Object</span>&gt; result</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Boolean</span>.<span class="hljs-property">TRUE</span>.<span class="hljs-title function_">equals</span>(result.<span class="hljs-title function_">get</span>(<span class="hljs-string">"success"</span>))) {
            <span class="hljs-keyword">return</span> <span class="hljs-title class_">String</span>.<span class="hljs-title function_">format</span>(<span class="hljs-string">"%sæˆåŠŸ:\n%s"</span>, operation,
                result.<span class="hljs-title function_">get</span>(<span class="hljs-string">"data"</span>) != <span class="hljs-literal">null</span> ? result.<span class="hljs-title function_">get</span>(<span class="hljs-string">"data"</span>) : result.<span class="hljs-title function_">get</span>(<span class="hljs-string">"content"</span>));
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-title class_">String</span>.<span class="hljs-title function_">format</span>(<span class="hljs-string">"%så¤±è´¥: %s"</span>, operation, result.<span class="hljs-title function_">get</span>(<span class="hljs-string">"error"</span>));
        }
    }
}
</code></pre>
<h3 data-id="heading-19">5.2 AIæœåŠ¡å®ç°</h3>
<pre><code class="hljs language-arduino" lang="arduino">package com.example.mcp.service;

<span class="hljs-keyword">import</span> com.example.mcp.ai.McpFunction;
<span class="hljs-keyword">import</span> lombok.RequiredArgsConstructor;
<span class="hljs-keyword">import</span> lombok.<span class="hljs-keyword">extern</span>.slf4j.Slf4j;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.client.ChatClient;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.client.advisor.MessageChatMemoryAdvisor;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.memory.ChatMemory;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.memory.InMemoryChatMemory;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;

<span class="hljs-comment">/**
 * AIå¯¹è¯æœåŠ¡
 */</span>
@Slf4j
@Service
@RequiredArgsConstructor
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AiChatService</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ChatClient.Builder chatClientBuilder;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> McpFunction mcpFunction;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ChatMemory chatMemory = <span class="hljs-keyword">new</span> <span class="hljs-built_in">InMemoryChatMemory</span>();

    <span class="hljs-comment">/**
     * å¤„ç†ç”¨æˆ·æ¶ˆæ¯
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-title">chat</span><span class="hljs-params">(<span class="hljs-type">String</span> userId, <span class="hljs-type">String</span> message)</span> </span>{
        log.<span class="hljs-built_in">info</span>(<span class="hljs-string">"ç”¨æˆ· {} å‘é€æ¶ˆæ¯: {}"</span>, userId, message);

        <span class="hljs-comment">// åˆ›å»ºå¸¦è®°å¿†å’Œå·¥å…·è°ƒç”¨çš„ChatClient</span>
        ChatClient chatClient = chatClientBuilder
            .<span class="hljs-built_in">defaultAdvisors</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">MessageChatMemoryAdvisor</span>(chatMemory))
            .<span class="hljs-built_in">defaultFunctions</span>(
                mcpFunction.<span class="hljs-built_in">queryUser</span>(),
                mcpFunction.<span class="hljs-built_in">analyzeData</span>(),
                mcpFunction.<span class="hljs-built_in">readFile</span>(),
                mcpFunction.<span class="hljs-built_in">getSystemResource</span>()
            )
            .<span class="hljs-built_in">build</span>();

        <span class="hljs-type">String</span> response = chatClient.<span class="hljs-built_in">prompt</span>()
            .<span class="hljs-built_in">user</span>(message)
            .<span class="hljs-built_in">call</span>()
            .<span class="hljs-built_in">content</span>();

        log.<span class="hljs-built_in">info</span>(<span class="hljs-string">"AIå›å¤: {}"</span>, response);
        <span class="hljs-keyword">return</span> response;
    }

    <span class="hljs-comment">/**
     * æ¸…é™¤å¯¹è¯å†å²
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">void</span> <span class="hljs-title">clearHistory</span><span class="hljs-params">(<span class="hljs-type">String</span> userId)</span> </span>{
        chatMemory.<span class="hljs-built_in">clear</span>(userId);
        log.<span class="hljs-built_in">info</span>(<span class="hljs-string">"å·²æ¸…é™¤ç”¨æˆ· {} çš„å¯¹è¯å†å²"</span>, userId);
    }
}
</code></pre>
<h3 data-id="heading-20">5.3 ChatClienté…ç½®</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">package</span> com.example.mcp.config;

<span class="hljs-keyword">import</span> org.springframework.ai.chat.client.ChatClient;
<span class="hljs-keyword">import</span> org.springframework.ai.openai.OpenAiChatModel;
<span class="hljs-keyword">import</span> org.springframework.context.<span class="hljs-keyword">annotation</span>.Configuration;

<span class="hljs-comment">/**
 * ChatClienté…ç½®
 */</span>
<span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatClientConfig</span> {

    <span class="hljs-keyword">public</span> ChatClient.Builder chatClientBuilder(OpenAiChatModel model) {
        <span class="hljs-keyword">return</span> ChatClient.builder(model);
    }
}
</code></pre>
<h2 data-id="heading-21">å…­ã€ç”Ÿäº§ç¯å¢ƒå®æˆ˜æ¡ˆä¾‹</h2>
<h3 data-id="heading-22">6.1 æ™ºèƒ½å®¢æœç³»ç»Ÿ</h3>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ™ºèƒ½å®¢æœç³»ç»Ÿå®ç°ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨Spring AI + MCPæ„å»ºå®é™…åº”ç”¨ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f4fe3d6f91b49aab6a8fd5465e19afa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769823895&amp;x-signature=7v47rQfyKqhMEXBT4qAs%2BTRFiWc%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-23">6.2 å®¢æœæ§åˆ¶å™¨</h3>
<pre><code class="hljs language-typescript" lang="typescript">package com.<span class="hljs-property">example</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">controller</span>;

<span class="hljs-keyword">import</span> com.<span class="hljs-property">example</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">service</span>.<span class="hljs-property">AiChatService</span>;
<span class="hljs-keyword">import</span> lombok.<span class="hljs-property">RequiredArgsConstructor</span>;
<span class="hljs-keyword">import</span> lombok.<span class="hljs-property">extern</span>.<span class="hljs-property">slf4j</span>.<span class="hljs-property">Slf4j</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">web</span>.<span class="hljs-property">bind</span>.<span class="hljs-property">annotation</span>.*;

<span class="hljs-keyword">import</span> java.<span class="hljs-property">util</span>.<span class="hljs-property">Map</span>;

<span class="hljs-comment">/**
 * æ™ºèƒ½å®¢æœæ§åˆ¶å™¨
 */</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">"/api/chat"</span>)
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatController</span> {

    <span class="hljs-keyword">private</span> final <span class="hljs-title class_">AiChatService</span> aiChatService;

    <span class="hljs-comment">/**
     * å‘é€æ¶ˆæ¯
     */</span>
    <span class="hljs-meta">@PostMapping</span>(<span class="hljs-string">"/send"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; <span class="hljs-title function_">sendMessage</span>(<span class="hljs-params"><span class="hljs-meta">@RequestBody</span> <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">String</span>&gt; request</span>) {
        <span class="hljs-title class_">String</span> userId = request.<span class="hljs-title function_">get</span>(<span class="hljs-string">"userId"</span>);
        <span class="hljs-title class_">String</span> message = request.<span class="hljs-title function_">get</span>(<span class="hljs-string">"message"</span>);

        <span class="hljs-keyword">if</span> (userId == <span class="hljs-literal">null</span> || message == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(<span class="hljs-string">"success"</span>, <span class="hljs-literal">false</span>, <span class="hljs-string">"error"</span>, <span class="hljs-string">"userIdå’Œmessageä¸èƒ½ä¸ºç©º"</span>);
        }

        <span class="hljs-keyword">try</span> {
            <span class="hljs-title class_">String</span> response = aiChatService.<span class="hljs-title function_">chat</span>(userId, message);
            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(
                <span class="hljs-string">"success"</span>, <span class="hljs-literal">true</span>,
                <span class="hljs-string">"response"</span>, response,
                <span class="hljs-string">"timestamp"</span>, <span class="hljs-title class_">System</span>.<span class="hljs-title function_">currentTimeMillis</span>()
            );
        } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Exception</span> e) {
            log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"å¤„ç†æ¶ˆæ¯å¤±è´¥"</span>, e);
            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(<span class="hljs-string">"success"</span>, <span class="hljs-literal">false</span>, <span class="hljs-string">"error"</span>, e.<span class="hljs-title function_">getMessage</span>());
        }
    }

    <span class="hljs-comment">/**
     * æ¸…é™¤å†å²
     */</span>
    <span class="hljs-meta">@PostMapping</span>(<span class="hljs-string">"/clear"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; <span class="hljs-title function_">clearHistory</span>(<span class="hljs-params"><span class="hljs-meta">@RequestBody</span> <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">String</span>, <span class="hljs-built_in">String</span>&gt; request</span>) {
        <span class="hljs-title class_">String</span> userId = request.<span class="hljs-title function_">get</span>(<span class="hljs-string">"userId"</span>);
        aiChatService.<span class="hljs-title function_">clearHistory</span>(userId);
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(<span class="hljs-string">"success"</span>, <span class="hljs-literal">true</span>, <span class="hljs-string">"message"</span>, <span class="hljs-string">"å¯¹è¯å†å²å·²æ¸…é™¤"</span>);
    }
}
</code></pre>
<h2 data-id="heading-24">ä¸ƒã€MCPé€šä¿¡æµç¨‹</h2>
<h3 data-id="heading-25">7.1 å®Œæ•´çš„äº¤äº’æµç¨‹</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6963169d825f4e50bc6288b76f0a1fa1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769823895&amp;x-signature=nZY75CjUnqto%2FgwWsKfGzjcWsCY%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-26">7.2 æ¶ˆæ¯æ ¼å¼ç¤ºä¾‹</h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// å®¢æˆ·ç«¯è¯·æ±‚ç¤ºä¾‹</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"jsonrpc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"method"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tools/call"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"query_user"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"arguments"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"userId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"12345"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment">// æœåŠ¡ç«¯å“åº”ç¤ºä¾‹</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"jsonrpc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"result"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"success"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"12345"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å¼ ä¸‰"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"email"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"zhangsan@example.com"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"role"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ç®¡ç†å‘˜"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-27">å…«ã€æµ‹è¯•ä¸è°ƒè¯•</h2>
<h3 data-id="heading-28">8.1 å•å…ƒæµ‹è¯•</h3>
<pre><code class="hljs language-typescript" lang="typescript">package com.<span class="hljs-property">example</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">server</span>;

<span class="hljs-keyword">import</span> org.<span class="hljs-property">junit</span>.<span class="hljs-property">jupiter</span>.<span class="hljs-property">api</span>.<span class="hljs-property">BeforeEach</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">junit</span>.<span class="hljs-property">jupiter</span>.<span class="hljs-property">api</span>.<span class="hljs-property">Test</span>;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.<span class="hljs-property">junit</span>.<span class="hljs-property">jupiter</span>.<span class="hljs-property">api</span>.<span class="hljs-property">Assertions</span>.*;

<span class="hljs-comment">/**
 * MCPæœåŠ¡ç«¯æµ‹è¯•
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">McpServerTest</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-title class_">McpServer</span> mcpServer;

    <span class="hljs-meta">@BeforeEach</span>
    <span class="hljs-built_in">void</span> <span class="hljs-title function_">setUp</span>(<span class="hljs-params"/>) {
        mcpServer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">McpServer</span>();
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-built_in">void</span> <span class="hljs-title function_">testInitialize</span>(<span class="hljs-params"/>) {
        <span class="hljs-title class_">String</span> request = <span class="hljs-string">"{"</span>jsonrpc<span class="hljs-string">":"</span><span class="hljs-number">2.0</span><span class="hljs-string">","</span>id<span class="hljs-string">":1,"</span>method<span class="hljs-string">":"</span>initialize<span class="hljs-string">","</span>params<span class="hljs-string">":{}}"</span>;
        <span class="hljs-title class_">String</span> response = mcpServer.<span class="hljs-title function_">handleRequest</span>(request);

        <span class="hljs-title function_">assertNotNull</span>(response);
        <span class="hljs-title function_">assertTrue</span>(response.<span class="hljs-title function_">contains</span>(<span class="hljs-string">""</span>serverInfo<span class="hljs-string">""</span>));
        <span class="hljs-title function_">assertTrue</span>(response.<span class="hljs-title function_">contains</span>(<span class="hljs-string">"demo-mcp-server"</span>));
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-built_in">void</span> <span class="hljs-title function_">testListTools</span>(<span class="hljs-params"/>) {
        <span class="hljs-title class_">String</span> request = <span class="hljs-string">"{"</span>jsonrpc<span class="hljs-string">":"</span><span class="hljs-number">2.0</span><span class="hljs-string">","</span>id<span class="hljs-string">":2,"</span>method<span class="hljs-string">":"</span>tools/list<span class="hljs-string">"}"</span>;
        <span class="hljs-title class_">String</span> response = mcpServer.<span class="hljs-title function_">handleRequest</span>(request);

        <span class="hljs-title function_">assertNotNull</span>(response);
        <span class="hljs-title function_">assertTrue</span>(response.<span class="hljs-title function_">contains</span>(<span class="hljs-string">"query_user"</span>));
        <span class="hljs-title function_">assertTrue</span>(response.<span class="hljs-title function_">contains</span>(<span class="hljs-string">"analyze_data"</span>));
        <span class="hljs-title function_">assertTrue</span>(response.<span class="hljs-title function_">contains</span>(<span class="hljs-string">"read_file"</span>));
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-built_in">void</span> <span class="hljs-title function_">testCallTool</span>(<span class="hljs-params"/>) {
        <span class="hljs-title class_">String</span> request = <span class="hljs-string">"{"</span>jsonrpc<span class="hljs-string">":"</span><span class="hljs-number">2.0</span><span class="hljs-string">","</span>id<span class="hljs-string">":3,"</span>method<span class="hljs-string">":"</span>tools/call<span class="hljs-string">","</span>params<span class="hljs-string">":{"</span> +
                         <span class="hljs-string">""</span>name<span class="hljs-string">":"</span>query_user<span class="hljs-string">","</span> +
                         <span class="hljs-string">""</span><span class="hljs-variable language_">arguments</span><span class="hljs-string">":{"</span>userId<span class="hljs-string">":"</span><span class="hljs-number">123</span><span class="hljs-string">"}"</span> +
                         <span class="hljs-string">"}}"</span>;
        <span class="hljs-title class_">String</span> response = mcpServer.<span class="hljs-title function_">handleRequest</span>(request);

        <span class="hljs-title function_">assertNotNull</span>(response);
        <span class="hljs-title function_">assertTrue</span>(response.<span class="hljs-title function_">contains</span>(<span class="hljs-string">""</span>success<span class="hljs-string">":true"</span>));
        <span class="hljs-title function_">assertTrue</span>(response.<span class="hljs-title function_">contains</span>(<span class="hljs-string">"å¼ ä¸‰"</span>));
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-built_in">void</span> <span class="hljs-title function_">testListResources</span>(<span class="hljs-params"/>) {
        <span class="hljs-title class_">String</span> request = <span class="hljs-string">"{"</span>jsonrpc<span class="hljs-string">":"</span><span class="hljs-number">2.0</span><span class="hljs-string">","</span>id<span class="hljs-string">":4,"</span>method<span class="hljs-string">":"</span>resources/list<span class="hljs-string">"}"</span>;
        <span class="hljs-title class_">String</span> response = mcpServer.<span class="hljs-title function_">handleRequest</span>(request);

        <span class="hljs-title function_">assertNotNull</span>(response);
        <span class="hljs-title function_">assertTrue</span>(response.<span class="hljs-title function_">contains</span>(<span class="hljs-string">"user://list"</span>));
        <span class="hljs-title function_">assertTrue</span>(response.<span class="hljs-title function_">contains</span>(<span class="hljs-string">"config://system"</span>));
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-built_in">void</span> <span class="hljs-title function_">testReadResource</span>(<span class="hljs-params"/>) {
        <span class="hljs-title class_">String</span> request = <span class="hljs-string">"{"</span>jsonrpc<span class="hljs-string">":"</span><span class="hljs-number">2.0</span><span class="hljs-string">","</span>id<span class="hljs-string">":5,"</span>method<span class="hljs-string">":"</span>resources/read<span class="hljs-string">","</span> +
                         <span class="hljs-string">""</span>params<span class="hljs-string">":{"</span>uri<span class="hljs-string">":"</span><span class="hljs-attr">user</span>:<span class="hljs-comment">//list"}}";</span>
        <span class="hljs-title class_">String</span> response = mcpServer.<span class="hljs-title function_">handleRequest</span>(request);

        <span class="hljs-title function_">assertNotNull</span>(response);
        <span class="hljs-title function_">assertTrue</span>(response.<span class="hljs-title function_">contains</span>(<span class="hljs-string">"users"</span>));
    }
}
</code></pre>
<h3 data-id="heading-29">8.2 å®¢æˆ·ç«¯æµ‹è¯•</h3>
<pre><code class="hljs language-typescript" lang="typescript">package com.<span class="hljs-property">example</span>.<span class="hljs-property">mcp</span>.<span class="hljs-property">client</span>;

<span class="hljs-keyword">import</span> org.<span class="hljs-property">junit</span>.<span class="hljs-property">jupiter</span>.<span class="hljs-property">api</span>.<span class="hljs-property">BeforeEach</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">junit</span>.<span class="hljs-property">jupiter</span>.<span class="hljs-property">api</span>.<span class="hljs-property">Test</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">mockserver</span>.<span class="hljs-property">integration</span>.<span class="hljs-property">ClientAndServer</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">mockserver</span>.<span class="hljs-property">model</span>.<span class="hljs-property">HttpRequest</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">mockserver</span>.<span class="hljs-property">model</span>.<span class="hljs-property">HttpResponse</span>;

<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.<span class="hljs-property">junit</span>.<span class="hljs-property">jupiter</span>.<span class="hljs-property">api</span>.<span class="hljs-property">Assertions</span>.*;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.<span class="hljs-property">mockserver</span>.<span class="hljs-property">model</span>.<span class="hljs-property">JsonBody</span>.<span class="hljs-property">json</span>;

<span class="hljs-comment">/**
 * MCPå®¢æˆ·ç«¯æµ‹è¯•
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">McpClientTest</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-title class_">ClientAndServer</span> mockServer;
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">McpClient</span> mcpClient;

    <span class="hljs-meta">@BeforeEach</span>
    <span class="hljs-built_in">void</span> <span class="hljs-title function_">setUp</span>(<span class="hljs-params"/>) {
        mockServer = <span class="hljs-title class_">ClientAndServer</span>.<span class="hljs-title function_">startLocal</span>(<span class="hljs-number">1080</span>);
        mcpClient = <span class="hljs-keyword">new</span> <span class="hljs-title class_">McpClient</span>(<span class="hljs-string">"http://localhost:1080/mcp"</span>);
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-built_in">void</span> <span class="hljs-title function_">testListTools</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// æ¨¡æ‹ŸæœåŠ¡ç«¯å“åº”</span>
        mockServer.<span class="hljs-title function_">when</span>(<span class="hljs-title class_">HttpRequest</span>.<span class="hljs-title function_">request</span>()
            .<span class="hljs-title function_">withMethod</span>(<span class="hljs-string">"POST"</span>)
            .<span class="hljs-title function_">withPath</span>(<span class="hljs-string">"/mcp"</span>))
            .<span class="hljs-title function_">respond</span>(<span class="hljs-title class_">HttpResponse</span>.<span class="hljs-title function_">response</span>()
                .<span class="hljs-title function_">withBody</span>(<span class="hljs-string">"{"</span>jsonrpc<span class="hljs-string">":"</span><span class="hljs-number">2.0</span><span class="hljs-string">","</span>id<span class="hljs-string">":1,"</span> +
                          <span class="hljs-string">""</span>result<span class="hljs-string">":{"</span>tools<span class="hljs-string">":[{"</span> +
                          <span class="hljs-string">""</span>name<span class="hljs-string">":"</span>test_tool<span class="hljs-string">","</span> +
                          <span class="hljs-string">""</span>description<span class="hljs-string">":"</span>æµ‹è¯•å·¥å…·<span class="hljs-string">","</span> +
                          <span class="hljs-string">""</span>inputSchema<span class="hljs-string">":{"</span><span class="hljs-keyword">type</span><span class="hljs-string">":"</span><span class="hljs-built_in">object</span><span class="hljs-string">"}"</span> +
                          <span class="hljs-string">"]}}"</span>));

        <span class="hljs-keyword">var</span> tools = mcpClient.<span class="hljs-title function_">listTools</span>();

        <span class="hljs-title function_">assertNotNull</span>(tools);
        <span class="hljs-title function_">assertEquals</span>(<span class="hljs-number">1</span>, tools.<span class="hljs-title function_">size</span>());
        <span class="hljs-title function_">assertEquals</span>(<span class="hljs-string">"test_tool"</span>, tools.<span class="hljs-title function_">get</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">name</span>());
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-built_in">void</span> <span class="hljs-title function_">testCallTool</span>(<span class="hljs-params"/>) {
        mockServer.<span class="hljs-title function_">when</span>(<span class="hljs-title class_">HttpRequest</span>.<span class="hljs-title function_">request</span>()
            .<span class="hljs-title function_">withMethod</span>(<span class="hljs-string">"POST"</span>)
            .<span class="hljs-title function_">withPath</span>(<span class="hljs-string">"/mcp"</span>))
            .<span class="hljs-title function_">respond</span>(<span class="hljs-title class_">HttpResponse</span>.<span class="hljs-title function_">response</span>()
                .<span class="hljs-title function_">withBody</span>(<span class="hljs-string">"{"</span>jsonrpc<span class="hljs-string">":"</span><span class="hljs-number">2.0</span><span class="hljs-string">","</span>id<span class="hljs-string">":2,"</span> +
                          <span class="hljs-string">""</span>result<span class="hljs-string">":{"</span>success<span class="hljs-string">":true,"</span>data<span class="hljs-string">":{"</span>result<span class="hljs-string">":"</span>test<span class="hljs-string">"}}}"</span>));

        <span class="hljs-keyword">var</span> result = mcpClient.<span class="hljs-title function_">callTool</span>(<span class="hljs-string">"test_tool"</span>, <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(<span class="hljs-string">"param"</span>, <span class="hljs-string">"value"</span>));

        <span class="hljs-title function_">assertNotNull</span>(result);
        <span class="hljs-title function_">assertTrue</span>((<span class="hljs-title class_">Boolean</span>) result.<span class="hljs-title function_">get</span>(<span class="hljs-string">"success"</span>));
    }

    <span class="hljs-meta">@Test</span>
    <span class="hljs-built_in">void</span> <span class="hljs-title function_">testReadResource</span>(<span class="hljs-params"/>) {
        mockServer.<span class="hljs-title function_">when</span>(<span class="hljs-title class_">HttpRequest</span>.<span class="hljs-title function_">request</span>()
            .<span class="hljs-title function_">withMethod</span>(<span class="hljs-string">"POST"</span>)
            .<span class="hljs-title function_">withPath</span>(<span class="hljs-string">"/mcp"</span>))
            .<span class="hljs-title function_">respond</span>(<span class="hljs-title class_">HttpResponse</span>.<span class="hljs-title function_">response</span>()
                .<span class="hljs-title function_">withBody</span>(<span class="hljs-string">"{"</span>jsonrpc<span class="hljs-string">":"</span><span class="hljs-number">2.0</span><span class="hljs-string">","</span>id<span class="hljs-string">":3,"</span> +
                          <span class="hljs-string">""</span>result<span class="hljs-string">":{"</span>contents<span class="hljs-string">":[{"</span> +
                          <span class="hljs-string">""</span>uri<span class="hljs-string">":"</span><span class="hljs-attr">test</span>:<span class="hljs-comment">//resource"," +</span>
                          <span class="hljs-string">""</span>text<span class="hljs-string">":"</span>resource content<span class="hljs-string">"}]}}"</span>));

        <span class="hljs-title class_">String</span> content = mcpClient.<span class="hljs-title function_">readResource</span>(<span class="hljs-string">"test://resource"</span>);

        <span class="hljs-title function_">assertNotNull</span>(content);
        <span class="hljs-title function_">assertEquals</span>(<span class="hljs-string">"resource content"</span>, content);
    }
}
</code></pre>
<h2 data-id="heading-30">ä¹ã€éƒ¨ç½²æ¶æ„</h2>
<h3 data-id="heading-31">9.1</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/07d0634236664c5991827b7e2ff03711~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769823895&amp;x-signature=moCJMbfSeq8dtgyyOfAYyc%2FSEHY%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-32">9.2 Dockeréƒ¨ç½²</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Dockerfile</span>
FROM openjdk:17-slim

WORKDIR /app

COPY target/mcp-demo-1.0.0.jar app.jar

EXPOSE 8080

ENTRYPOINT [<span class="hljs-string">"java"</span>, <span class="hljs-string">"-jar"</span>, <span class="hljs-string">"app.jar"</span>]

<span class="hljs-comment"># docker-compose.yml</span>
version: <span class="hljs-string">'3.8'</span>
services:
  mcp-demo:
    build: .
    ports:
      - <span class="hljs-string">"8080:8080"</span>
    environment:
      - OPENAI_API_KEY=<span class="hljs-variable">${OPENAI_API_KEY}</span>
      - SPRING_PROFILES_ACTIVE=production
    restart: unless-stopped
</code></pre>
<h2 data-id="heading-33">åã€æ€»ç»“</h2>
<p>Spring AI + MCPä¸ºæ„å»ºAIåº”ç”¨æä¾›äº†å¼ºå¤§çš„åŸºç¡€è®¾æ–½ã€‚éšç€AIæŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼ŒMCPåè®®å°†æˆä¸ºè¿æ¥AIåº”ç”¨å’Œå¤–éƒ¨æœåŠ¡çš„é‡è¦æ ‡å‡†ã€‚å»ºè®®æŒç»­å…³æ³¨MCPç”Ÿæ€çš„å‘å±•ï¼Œç§¯ææ¢ç´¢æ›´å¤šçš„åº”ç”¨åœºæ™¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼šæ·±å…¥è§£æé˜²æŠ–ï¼ˆDebounceï¼‰ä¸èŠ‚æµï¼ˆThrottleï¼‰]]></title>    <link>https://juejin.cn/post/7598403436698796066</link>    <guid>https://juejin.cn/post/7598403436698796066</guid>    <pubDate>2026-01-23T14:32:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598403436698796066" data-draft-id="7598433254127468584" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼šæ·±å…¥è§£æé˜²æŠ–ï¼ˆDebounceï¼‰ä¸èŠ‚æµï¼ˆThrottleï¼‰"/> <meta itemprop="keywords" content="æ€§èƒ½ä¼˜åŒ–,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-23T14:32:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="San30"/> <meta itemprop="url" content="https://juejin.cn/user/1766294768060816"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼šæ·±å…¥è§£æé˜²æŠ–ï¼ˆDebounceï¼‰ä¸èŠ‚æµï¼ˆThrottleï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1766294768060816/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    San30
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T14:32:47.000Z" title="Fri Jan 23 2026 14:32:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><p>åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œç”¨æˆ·ä½“éªŒè‡³å…³é‡è¦ã€‚ç„¶è€Œï¼Œè®¸å¤šé«˜é¢‘è§¦å‘çš„ç”¨æˆ·äº¤äº’â€”â€”ä¾‹å¦‚å¿«é€Ÿè¾“å…¥æœç´¢å…³é”®è¯ã€è°ƒæ•´æµè§ˆå™¨çª—å£å¤§å°ã€æˆ–è€…å¿«é€Ÿæ»šåŠ¨é¡µé¢â€”â€”å¾€å¾€ä¼šäº§ç”Ÿå¤§é‡çš„äº‹ä»¶ã€‚å¦‚æœæˆ‘ä»¬ç›´æ¥å°†å¤æ‚çš„ä»»åŠ¡ï¼ˆå¦‚ AJAX è¯·æ±‚ã€DOM æ“ä½œï¼‰ç»‘å®šåˆ°è¿™äº›äº‹ä»¶ä¸Šï¼Œææ˜“å¯¼è‡´é¡µé¢å¡é¡¿ã€æœåŠ¡å™¨å‹åŠ›è¿‡å¤§ï¼Œç”šè‡³æµè§ˆå™¨å´©æºƒã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œ<strong>é˜²æŠ–ï¼ˆDebounceï¼‰</strong> å’Œ <strong>èŠ‚æµï¼ˆThrottleï¼‰</strong> åº”è¿è€Œç”Ÿã€‚å®ƒä»¬æ˜¯åˆ©ç”¨<strong>é«˜é˜¶å‡½æ•°</strong>å’Œ<strong>é—­åŒ…</strong>å®ç°çš„ä¸¤ç§ç»å…¸æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥å‰–æè¿™ä¸¤ä¸ªæ¦‚å¿µçš„åŸç†ã€å®ç°ä»£ç ä»¥åŠå®ƒä»¬çš„åº”ç”¨åœºæ™¯ã€‚</p>
<h2 data-id="heading-0">é—®é¢˜çš„æ ¹æºï¼šæ— èŠ‚åˆ¶çš„äº‹ä»¶è§¦å‘</h2>
<p>è®©æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªå¸¸è§çš„åœºæ™¯ï¼šç±»ä¼¼ç™¾åº¦æˆ– Google çš„â€œæœç´¢å»ºè®®â€åŠŸèƒ½ã€‚æ¯å½“ç”¨æˆ·è¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œå‰ç«¯å°±éœ€è¦å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚</p>
<p>å¦‚æœé‡‡ç”¨æœ€åŸå§‹çš„å†™æ³•ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// æ™®é€šå‡½æ•°ï¼Œæ¨¡æ‹Ÿè¯·æ±‚</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">ajax</span>(<span class="hljs-params">content</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ajax request'</span>, content);
}

<span class="hljs-keyword">const</span> inputa = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"undebounce"</span>);

<span class="hljs-comment">// é¢‘ç¹è§¦å‘ + å¤æ‚ä»»åŠ¡</span>
inputa.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'keyup'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) {
    <span class="hljs-title function_">ajax</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>);
})
</code></pre>
<p><strong>åæœåˆ†æï¼š</strong></p>
<p>å¦‚æœç”¨æˆ·å¿«é€Ÿè¾“å…¥ "JavaScript"ï¼Œ<code>keyup</code> äº‹ä»¶å¯èƒ½ä¼šè§¦å‘ 10 æ¬¡ï¼Œè¿™æ„å‘³ç€å‘é€äº† 10 æ¬¡ç½‘ç»œè¯·æ±‚ã€‚</p>
<ul>
<li><strong>å¤ªå¿«äº†ï¼š</strong> è¯·æ±‚å¼€é”€å·¨å¤§ï¼Œæµªè´¹æœåŠ¡å™¨èµ„æºã€‚</li>
<li><strong>å¤ªæ…¢äº†ï¼š</strong> æµè§ˆå™¨å¿™äºå¤„ç†è¿‡å¤šçš„è¯·æ±‚ï¼Œå¯¼è‡´ç”¨æˆ·ä½“éªŒå˜å·®ã€‚</li>
</ul>
<p>æˆ‘ä»¬éœ€è¦ä¸€ç§æœºåˆ¶æ¥æ§åˆ¶æ‰§è¡Œçš„é¢‘ç‡ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€é˜²æŠ–ï¼ˆDebounceï¼‰</h2>
<h3 data-id="heading-2">1. æ ¸å¿ƒæ¦‚å¿µ</h3>
<p>é˜²æŠ–çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š <strong>â€œç­‰åŠ¨ä½œåœæ­¢åå†æ‰§è¡Œâ€</strong> ã€‚</p>
<p>åœ¨äº‹ä»¶è¢«é¢‘ç¹è§¦å‘æ—¶ï¼Œé˜²æŠ–æœºåˆ¶ä¿è¯å‡½æ•°åªåœ¨<strong>æœ€åä¸€æ¬¡</strong>è§¦å‘åçš„æŒ‡å®šç­‰å¾…æ—¶é—´ç»“æŸæ—¶æ‰§è¡Œã€‚å¦‚æœåœ¨è¿™æ®µç­‰å¾…æ—¶é—´å†…äº‹ä»¶å†æ¬¡è¢«è§¦å‘ï¼Œåˆ™<strong>é‡æ–°è®¡æ—¶</strong>ã€‚</p>
<p><strong>ç”Ÿæ´»ä¸­çš„ç±»æ¯”ï¼š</strong></p>
<p>è¿™å°±å¥½æ¯”åç”µæ¢¯ã€‚ç”µæ¢¯é—¨è®¾ç½®äº† 5 ç§’çš„å…³é—­å€’è®¡æ—¶ã€‚å¦‚æœæœ‰äººåœ¨ç¬¬ 3 ç§’å†²è¿›ç”µæ¢¯ï¼Œç”µæ¢¯ä¼šé‡æ–°å¼€å§‹ 5 ç§’å€’è®¡æ—¶ã€‚åªæœ‰å½“è¿ç»­ 5 ç§’æ²¡æœ‰äººè¿›å…¥æ—¶ï¼Œç”µæ¢¯æ‰ä¼šå…³é—¨è¿è¡Œã€‚</p>
<h3 data-id="heading-3">2. ä»£ç å®ç°</h3>
<p>é˜²æŠ–çš„å®ç°ä¾èµ–äº<strong>å®šæ—¶å™¨</strong>å’Œ<strong>é—­åŒ…</strong>ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç»å…¸çš„é˜²æŠ–å‡½æ•°å®ç°ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-comment">// é«˜é˜¶å‡½æ•°ï¼Œå‚æ•°æˆ–è¿”å›å€¼æ˜¯å‡½æ•°çš„å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">debounce</span>(<span class="hljs-params">fn, delay</span>) {
    <span class="hljs-keyword">var</span> id; <span class="hljs-comment">// å®šæ—¶å™¨IDï¼Œä½œä¸ºè‡ªç”±å˜é‡ä¿å­˜åœ¨é—­åŒ…ä¸­</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
        <span class="hljs-comment">// å…³é”®é€»è¾‘ï¼šå¦‚æœå®šæ—¶å™¨å­˜åœ¨ï¼ˆè¯´æ˜ä¹‹å‰è§¦å‘è¿‡ä¸”æœªæ‰§è¡Œï¼‰ï¼Œæ¸…é™¤å®ƒï¼</span>
        <span class="hljs-keyword">if</span>(id) <span class="hljs-built_in">clearTimeout</span>(id);
        
        <span class="hljs-comment">// å¼€å¯æ–°çš„å®šæ—¶å™¨ï¼Œé‡æ–°å€’è®¡æ—¶</span>
        id = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
        }, delay);
    }
}
</code></pre>
<p><strong>ä»£ç è§£æï¼š</strong></p>
<ul>
<li><strong>é—­åŒ…ï¼ˆClosureï¼‰ï¼š</strong> å˜é‡ <code>id</code> è¢«ä¿å­˜åœ¨é—­åŒ…ç¯å¢ƒä¸­ï¼Œå› æ­¤å®ƒå¯ä»¥è·¨å¤šæ¬¡å‡½æ•°è°ƒç”¨â€œè®°ä½â€ä¸Šä¸€æ¬¡çš„å®šæ—¶å™¨çŠ¶æ€ã€‚</li>
<li><strong>é‡æ–°è®¡æ—¶ï¼š</strong> <code>clearTimeout(id)</code> æ˜¯é˜²æŠ–çš„çµé­‚ã€‚æ¯æ¬¡è§¦å‘äº‹ä»¶ï¼Œéƒ½å¿…é¡»æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨ï¼Œé˜²æ­¢æ—§çš„ä»»åŠ¡æ‰§è¡Œã€‚</li>
<li><strong>æœ€ç»ˆæ‰§è¡Œï¼š</strong> åªæœ‰å½“ç”¨æˆ·åœæ­¢è§¦å‘çš„æ—¶é—´è¶…è¿‡ <code>delay</code> æ—¶ï¼Œ<code>fn</code> æ‰ä¼šçœŸæ­£è¢«æ‰§è¡Œã€‚</li>
</ul>
<h3 data-id="heading-4">3. åº”ç”¨åœºæ™¯</h3>
<ul>
<li><strong>æœç´¢å»ºè®®ï¼ˆSearch Suggestï¼‰ï¼š</strong> ç”¨æˆ·ä¸æ–­è¾“å…¥å€¼æ—¶ï¼Œä½¿ç”¨é˜²æŠ–æ¥èŠ‚çº¦è¯·æ±‚èµ„æºã€‚æˆ‘ä»¬åªå…³å¿ƒç”¨æˆ·è¾“å®Œåçš„å†…å®¹ï¼Œä¸å…³å¿ƒä¸­é—´è¿‡ç¨‹ï¼ˆå¦‚è¾“å…¥ "Java" æ—¶ï¼Œä¸å…³å¿ƒ "J", "Ja" çš„è¯·æ±‚ï¼‰ã€‚</li>
<li><strong>è¡¨å•éªŒè¯ï¼š</strong> é¿å…æ¯è¾“å…¥ä¸€ä¸ªå­—å°±æŠ¥é”™ï¼Œè€Œæ˜¯ç­‰å¾…ç”¨æˆ·è¾“å…¥å®Œæ¯•åå†æ ¡éªŒã€‚</li>
</ul>
<h2 data-id="heading-5">äºŒã€èŠ‚æµï¼ˆThrottleï¼‰</h2>
<h3 data-id="heading-6">1. æ ¸å¿ƒæ¦‚å¿µ</h3>
<p>èŠ‚æµçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š <strong>â€œæŒ‰å›ºå®šé¢‘ç‡æ‰§è¡Œâ€</strong> ã€‚</p>
<p>åœ¨äº‹ä»¶è¢«é¢‘ç¹è§¦å‘æ—¶ï¼ŒèŠ‚æµæœºåˆ¶ä¿è¯å‡½æ•°åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…<strong>æœ€å¤šåªæ‰§è¡Œä¸€æ¬¡</strong>ã€‚æ— è®ºè§¦å‘é¢‘ç‡å¤šé«˜ï¼Œå®ƒéƒ½ä¸¥æ ¼æŒ‰ç…§è‡ªå·±çš„èŠ‚å¥æ‰§è¡Œã€‚</p>
<p><strong>ç”Ÿæ´»ä¸­çš„ç±»æ¯”ï¼š</strong></p>
<p>æ–‡æ¡£ä¸­æåˆ°çš„ <strong>FPS æ¸¸æˆå°„é€Ÿ</strong> æ˜¯ä¸€ä¸ªç»ä½³çš„ä¾‹å­ã€‚å³ä½¿ä½ ä¸€ç›´æŒ‰ç€é¼ æ ‡å°„å‡»ï¼ˆé«˜é¢‘è§¦å‘ï¼‰ï¼Œæªæ”¯ä¹Ÿåªä¼šæŒ‰ç…§è§„å®šçš„å°„é€Ÿï¼ˆä¾‹å¦‚æ¯ 0.5 ç§’ä¸€å‘ï¼‰å°„å‡ºå­å¼¹ã€‚ä½ æ— æ³•çªç ´è¿™ä¸ªç‰©ç†é™åˆ¶ã€‚</p>
<h3 data-id="heading-7">2. ä»£ç å®ç°</h3>
<p>èŠ‚æµé€šå¸¸ç»“åˆæ—¶é—´æˆ³æˆ–å®šæ—¶å™¨æ¥å®ç°ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç»“åˆäº†æ—¶é—´åˆ¤æ–­çš„å¥å£®å®ç°ï¼š</p>
<pre><code class="hljs language-JavaScript" lang="JavaScript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">throttle</span>(<span class="hljs-params">fn, delay</span>) {
    <span class="hljs-keyword">let</span> last, deferTimer; <span class="hljs-comment">// ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´ï¼Œå®šæ—¶å™¨ID</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
        <span class="hljs-comment">// è·å–å½“å‰æ—¶é—´ï¼ˆæ¯«ç§’æ•°ï¼‰</span>
        <span class="hljs-keyword">let</span> now = + <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(); 
        
        <span class="hljs-comment">// åˆ¤æ–­è·ç¦»ä¸Šæ¬¡æ‰§è¡Œæ˜¯å¦å·²ç»è¶…è¿‡äº† delay æ—¶é—´</span>
        <span class="hljs-keyword">if</span>(last &amp;&amp; now - last &lt; delay) {
            <span class="hljs-comment">// å¦‚æœè¿˜æ²¡åˆ°æ—¶é—´ï¼Œæ¸…é™¤ä¹‹å‰çš„å»¶æ—¶æ“ä½œ</span>
            <span class="hljs-built_in">clearTimeout</span>(deferTimer);
            <span class="hljs-comment">// è®¾ç«‹ä¸€ä¸ªæ–°çš„å»¶æ—¶å™¨ï¼Œç¡®ä¿æœ€åä¸€æ¬¡æ“ä½œä¹Ÿèƒ½è¢«æ‰§è¡Œ</span>
            deferTimer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
                last = now;
                fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
            }, delay);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡æ‰§è¡Œï¼Œæˆ–è€…æ—¶é—´é—´éš”å·²è¶…è¿‡ delayï¼Œç«‹å³æ‰§è¡Œ</span>
            <span class="hljs-built_in">clearTimeout</span>(deferTimer);
            last = now;
            fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
        }
    }
}
</code></pre>
<p><strong>ä»£ç è§£æï¼š</strong></p>
<ul>
<li><strong>çŠ¶æ€è®°å½•ï¼š</strong> å˜é‡ <code>last</code> è®°å½•äº†ä¸Šä¸€æ¬¡å‡½æ•°æ‰§è¡Œçš„æ—¶é—´æˆ³ã€‚</li>
<li><strong>é¢‘ç‡æ§åˆ¶ï¼š</strong> <code>now - last &lt; delay</code> ç”¨äºæ£€æŸ¥æ˜¯å¦å¤„äºâ€œå†·å´æœŸâ€ã€‚å¦‚æœæ˜¯ï¼Œåˆ™é˜»æ­¢ç«‹å³æ‰§è¡Œã€‚</li>
<li><strong>å…œåº•é€»è¾‘ï¼š</strong> <code>deferTimer</code> çš„å­˜åœ¨æ˜¯ä¸ºäº†ä¿è¯â€œæ‹–å°¾â€æ‰§è¡Œï¼Œå³å½“ç”¨æˆ·åœæ­¢åŠ¨ä½œæ—¶ï¼Œæœ€åä¸€æ¬¡çŠ¶æ€ä¹Ÿèƒ½è¢«æ•è·å¹¶æ‰§è¡Œã€‚</li>
</ul>
<h3 data-id="heading-8">3. åº”ç”¨åœºæ™¯</h3>
<ul>
<li><strong>æ»šåŠ¨åŠ è½½ï¼ˆInfinite Scrollï¼‰ï¼š</strong> ç”¨æˆ·ä¸æ–­æ»šåŠ¨é¡µé¢æ—¶ï¼Œä½¿ç”¨èŠ‚æµæ¥èŠ‚çº¦è¯·æ±‚èµ„æºã€‚ä¾‹å¦‚æ¯éš” 500ms æ£€æŸ¥ä¸€æ¬¡æ»šåŠ¨ä½ç½®ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦åŠ è½½æ›´å¤šå†…å®¹ã€‚</li>
<li><strong>é¡µé¢å…ƒç´ æ‹–æ‹½ï¼ˆDrag &amp; Dropï¼‰ï¼š</strong> é™åˆ¶è®¡ç®—é¢‘ç‡ï¼Œé¿å…ç”±é«˜é¢‘çš„ mousemove äº‹ä»¶å¼•å‘å¡é¡¿ã€‚</li>
</ul>
<h2 data-id="heading-9">ä¸‰ã€é˜²æŠ– vs èŠ‚æµï¼šæ·±åº¦å¯¹æ¯”</h2>
<p>è™½ç„¶ä¸¤è€…çš„ç›®çš„éƒ½æ˜¯ä¸ºäº†é˜²æ­¢æŸä¸€æ—¶é—´é¢‘ç¹è§¦å‘ï¼Œä½†å®ƒä»¬çš„<strong>åŸç†</strong>å’Œ<strong>å…³æ³¨ç‚¹</strong>æˆªç„¶ä¸åŒã€‚</p>






























<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>é˜²æŠ– (Debounce)</strong></th><th><strong>èŠ‚æµ (Throttle)</strong></th></tr></thead><tbody><tr><td><strong>æ‰§è¡Œæ—¶æœº</strong></td><td>åŠ¨ä½œ<strong>åœæ­¢å</strong>æ‰§è¡Œä¸€æ¬¡</td><td>åŠ¨ä½œæŒç»­æœŸé—´ï¼ŒæŒ‰<strong>å›ºå®šé¢‘ç‡</strong>æ‰§è¡Œ</td></tr><tr><td><strong>å…³æ³¨ç‚¹</strong></td><td>å…³æ³¨<strong>ç»“æœ</strong>ï¼ˆä½ è¾“å®Œäº†å—ï¼Ÿï¼‰</td><td>å…³æ³¨<strong>è¿‡ç¨‹</strong>ï¼ˆåˆ«å¤ªå¿«ï¼Œæ…¢æ…¢æ¥ï¼‰</td></tr><tr><td><strong>å…³é”®é€»è¾‘</strong></td><td>æ¸…é™¤æ—§å®šæ—¶å™¨ï¼Œå¼€å¯æ–°å®šæ—¶å™¨</td><td>æ£€æŸ¥è·ç¦»ä¸Šæ¬¡æ‰§è¡Œæ˜¯å¦å·²è¿‡æŒ‡å®šé—´éš”</td></tr><tr><td><strong>å…¸å‹åœºæ™¯</strong></td><td>è¾“å…¥æ¡†æœç´¢ã€è¡¨å•éªŒè¯</td><td>é¡µé¢æ»šåŠ¨ã€æ‹–æ‹½å…ƒç´ ã€ç‚¹å‡»æŒ‰é’®</td></tr></tbody></table>
<h3 data-id="heading-10">æ€»ç»“è®°å¿†æ³•ï¼š</h3>
<ul>
<li><strong>setTimeout (é˜²æŠ–)</strong> æ˜¯â€œå»¶æ—¶å™¨â€ï¼šç­‰ä¸€ä¼šï¼Œåªåšä¸€æ¬¡ã€‚</li>
<li><strong>setInterval (èŠ‚æµ)</strong> æ˜¯â€œå®šæ—¶å™¨â€ï¼šæ¯éš”ä¸€ä¼šï¼Œä¸€ç›´åšã€‚</li>
</ul>
<h2 data-id="heading-11">ç»“è¯­</h2>
<p>é˜²æŠ–å’ŒèŠ‚æµæ˜¯å‰ç«¯é¢è¯•çš„é«˜é¢‘è€ƒç‚¹ï¼Œä¹Ÿæ˜¯å®é™…å¼€å‘ä¸­ä¼˜åŒ–æ€§èƒ½çš„åˆ©å™¨ã€‚é€šè¿‡åˆç†åˆ©ç”¨<strong>é—­åŒ…</strong>ä¿å­˜çŠ¶æ€ï¼ˆå®šæ—¶å™¨ ID æˆ–æ—¶é—´æˆ³ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰æ•ˆåœ°æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œé¢‘ç‡ï¼Œåœ¨ä¿è¯åŠŸèƒ½çš„å‰æä¸‹æå¤§æå‡ç”¨æˆ·ä½“éªŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€ å‰ç«¯ä¸‰å‰‘å®¢-40 /Lesson73(2025-12-17)ã€‘æ·±å…¥ç†è§£â€œthisâ€ï¼šJavaScript ä¸­æœ€ç¥ç§˜åˆæœ€æ ¸å¿ƒçš„å…³é”®å­—ğŸ“š]]></title>    <link>https://juejin.cn/post/7598418891400429622</link>    <guid>https://juejin.cn/post/7598418891400429622</guid>    <pubDate>2026-01-23T14:55:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598418891400429622" data-draft-id="7598507330859827242" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€ å‰ç«¯ä¸‰å‰‘å®¢-40 /Lesson73(2025-12-17)ã€‘æ·±å…¥ç†è§£â€œthisâ€ï¼šJavaScript ä¸­æœ€ç¥ç§˜åˆæœ€æ ¸å¿ƒçš„å…³é”®å­—ğŸ“š"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-23T14:55:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Jing_Rainbow"/> <meta itemprop="url" content="https://juejin.cn/user/1285809519198256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€ å‰ç«¯ä¸‰å‰‘å®¢-40 /Lesson73(2025-12-17)ã€‘æ·±å…¥ç†è§£â€œthisâ€ï¼šJavaScript ä¸­æœ€ç¥ç§˜åˆæœ€æ ¸å¿ƒçš„å…³é”®å­—ğŸ“š
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1285809519198256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Jing_Rainbow
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T14:55:42.000Z" title="Fri Jan 23 2026 14:55:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ğŸ“šåœ¨ JavaScript çš„ä¸–ç•Œä¸­ï¼Œæœ‰ä¸€ä¸ªå…³é”®å­—æ—¢ä»¤äººç€è¿·åˆå¸¸å¸¸è®©äººå›°æƒ‘â€”â€”å®ƒå°±æ˜¯ <strong><code>this</code></strong>ã€‚æ— è®ºä½ æ˜¯åˆšå…¥é—¨çš„æ–°æ‰‹ï¼Œè¿˜æ˜¯å·²ç»å†™äº†å¤šå¹´ä»£ç çš„è€æ‰‹ï¼Œ<code>this</code> çš„è¡Œä¸ºæ€»èƒ½åœ¨æŸäº›æ—¶åˆ»è®©ä½ æŒ å¤´ã€‚æœ¬æ–‡å°†å…¨é¢ã€æ·±å…¥ã€ç»†è‡´åœ°å‰–æ <code>this</code> çš„æœ¬è´¨ã€ç»‘å®šè§„åˆ™ã€å¸¸è§é™·é˜±ä»¥åŠæœ€ä½³å®è·µï¼Œå¸®åŠ©ä½ å½»åº•æŒæ¡è¿™ä¸ªçœ‹ä¼¼ç®€å•å´å†…æ¶µä¸°å¯Œçš„å…³é”®å­—ã€‚</p>
<hr/>
<h2 data-id="heading-0">ğŸ” ä»€ä¹ˆæ˜¯ <code>this</code>ï¼Ÿ</h2>
<p><code>this</code> æ˜¯ JavaScript ä¸­çš„ä¸€ä¸ª<strong>ä¸Šä¸‹æ–‡å…³é”®å­—ï¼ˆcontextual keywordï¼‰</strong> ï¼Œå®ƒåœ¨å‡½æ•°æ‰§è¡Œæ—¶è‡ªåŠ¨è¢«èµ‹äºˆä¸€ä¸ªå€¼ï¼ŒæŒ‡å‘å½“å‰å‡½æ•°æ‰§è¡Œçš„â€œä¸Šä¸‹æ–‡å¯¹è±¡â€ã€‚æ¢å¥è¯è¯´ï¼Œ<code>this</code> æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œè®©å‡½æ•°èƒ½å¤Ÿè®¿é—®è°ƒç”¨å®ƒçš„é‚£ä¸ªå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚</p>
<p>ä½†è¯·æ³¨æ„ï¼š<strong><code>this</code> å¹¶ä¸æŒ‡å‘å‡½æ•°è‡ªèº«ï¼Œä¹Ÿä¸æŒ‡å‘å‡½æ•°çš„è¯æ³•ä½œç”¨åŸŸï¼</strong> è¿™æ˜¯åˆå­¦è€…æœ€å¸¸è§çš„è¯¯è§£ä¹‹ä¸€ã€‚</p>
<hr/>
<h2 data-id="heading-1">âš™ï¸ <code>this</code> çš„ç»‘å®šè§„åˆ™ï¼ˆæŒ‰ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼‰</h2>
<p>JavaScript å¼•æ“åœ¨ç¡®å®š <code>this</code> çš„å€¼æ—¶ï¼Œéµå¾ªä¸€å¥—æ˜ç¡®çš„è§„åˆ™ã€‚è¿™äº›è§„åˆ™æŒ‰ç…§ä¼˜å…ˆçº§æ’åºå¦‚ä¸‹ï¼š</p>
<h3 data-id="heading-2">1ï¸âƒ£ ğŸ¯ æ˜¾å¼ç»‘å®šï¼ˆExplicit Bindingï¼‰ï¼š<code>call</code>ã€<code>apply</code>ã€<code>bind</code></h3>
<p>è¿™æ˜¯æœ€é«˜ä¼˜å…ˆçº§çš„ç»‘å®šæ–¹å¼ã€‚é€šè¿‡ <code>Function.prototype.call()</code>ã€<code>.apply()</code> æˆ– <code>.bind()</code> æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥<strong>æ˜¾å¼åœ°æŒ‡å®š</strong>å‡½æ•°å†…éƒ¨ <code>this</code> çš„å€¼ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">greet</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, I am <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>);
}

<span class="hljs-keyword">const</span> person = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span> };

greet.<span class="hljs-title function_">call</span>(person); <span class="hljs-comment">// Hello, I am Alice</span>
greet.<span class="hljs-title function_">apply</span>(person); <span class="hljs-comment">// Hello, I am Alice</span>

<span class="hljs-keyword">const</span> boundGreet = greet.<span class="hljs-title function_">bind</span>(person);
<span class="hljs-title function_">boundGreet</span>(); <span class="hljs-comment">// Hello, I am Alice</span>
</code></pre>
<ul>
<li><code>call</code> å’Œ <code>apply</code> ç«‹å³æ‰§è¡Œå‡½æ•°ï¼ŒåŒºåˆ«åœ¨äºå‚æ•°ä¼ é€’æ–¹å¼ï¼ˆ<code>call</code> ä¼ å‚æ•°åˆ—è¡¨ï¼Œ<code>apply</code> ä¼ å‚æ•°æ•°ç»„ï¼‰ã€‚</li>
<li><code>bind</code> è¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼Œå…¶ <code>this</code> è¢«æ°¸ä¹…ç»‘å®šï¼ˆç¡¬ç»‘å®šï¼‰ï¼Œå³ä½¿åç»­å†ç”¨ <code>call</code> ä¹Ÿæ— æ³•æ”¹å˜ï¼ˆé™¤éä½¿ç”¨ <code>new</code>ï¼Œè§ä¸‹æ–‡ï¼‰ã€‚</li>
</ul>
<blockquote>
<p>ğŸ’¡ <strong>ç¡¬ç»‘å®šï¼ˆHard Bindingï¼‰</strong> æ˜¯ä¸€ç§å¸¸è§çš„æ¨¡å¼ï¼Œç”¨äºç¡®ä¿å›è°ƒå‡½æ•°ä¸­çš„ <code>this</code> ä¸ä¼šä¸¢å¤±ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-3">2ï¸âƒ£ ğŸ—ï¸ <code>new</code> ç»‘å®šï¼ˆConstructor Bindingï¼‰</h3>
<p>å½“ä¸€ä¸ªå‡½æ•°è¢«ç”¨ä½œæ„é€ å‡½æ•°ï¼ˆå³å‰é¢åŠ äº† <code>new</code> å…³é”®å­—è°ƒç”¨ï¼‰æ—¶ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹äº‹æƒ…ï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ç©ºå¯¹è±¡ï¼›</li>
<li>å°†è¿™ä¸ªæ–°å¯¹è±¡çš„ <code>[[Prototype]]</code> é“¾æ¥åˆ°æ„é€ å‡½æ•°çš„ <code>prototype</code>ï¼›</li>
<li><strong>å°†å‡½æ•°å†…éƒ¨çš„ <code>this</code> ç»‘å®šåˆ°è¿™ä¸ªæ–°å¯¹è±¡</strong>ï¼›</li>
<li>å¦‚æœå‡½æ•°æ²¡æœ‰è¿”å›å…¶ä»–å¯¹è±¡ï¼Œåˆ™è‡ªåŠ¨è¿”å›è¿™ä¸ªæ–°å¯¹è±¡ã€‚</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}

<span class="hljs-keyword">const</span> alice = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"Alice"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(alice.<span class="hljs-property">name</span>); <span class="hljs-comment">// Alice</span>
</code></pre>
<p>æ­¤æ—¶ï¼Œ<code>this</code> æŒ‡å‘çš„å°±æ˜¯æ–°åˆ›å»ºçš„å®ä¾‹å¯¹è±¡ <code>alice</code>ã€‚</p>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šå¦‚æœæ„é€ å‡½æ•°æ˜¾å¼è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™ <code>this</code> ç»‘å®šä¼šè¢«å¿½ç•¥ï¼Œè¿”å›çš„æ˜¯é‚£ä¸ªå¯¹è±¡ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-4">3ï¸âƒ£ ğŸ“¦ éšå¼ç»‘å®šï¼ˆImplicit Bindingï¼‰</h3>
<p>å½“å‡½æ•°ä½œä¸º<strong>å¯¹è±¡çš„æ–¹æ³•</strong>è¢«è°ƒç”¨æ—¶ï¼Œ<code>this</code> ä¼šè‡ªåŠ¨ç»‘å®šåˆ°è¯¥å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>,
  <span class="hljs-title function_">sayName</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);
  }
};

obj.<span class="hljs-title function_">sayName</span>(); <span class="hljs-comment">// Bob â†’ this æŒ‡å‘ obj</span>
</code></pre>
<h4 data-id="heading-5">â— éšå¼ç»‘å®šçš„â€œä¸¢å¤±é—®é¢˜â€</h4>
<p>è¿™æ˜¯ <code>this</code> æœ€å®¹æ˜“å‡ºé”™çš„åœ°æ–¹ä¹‹ä¸€ã€‚å½“æ–¹æ³•è¢«èµ‹å€¼ç»™å˜é‡æˆ–ä½œä¸ºå›è°ƒä¼ é€’æ—¶ï¼Œ<strong>éšå¼ç»‘å®šä¼šä¸¢å¤±</strong>ï¼Œ<code>this</code> ä¼šé€€å›åˆ°é»˜è®¤ç»‘å®šã€‚</p>
<pre><code class="hljs language-ini" lang="ini">const <span class="hljs-attr">say</span> = obj.sayName<span class="hljs-comment">;</span>
say()<span class="hljs-comment">; // undefinedï¼ˆåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼‰æˆ–å…¨å±€å¯¹è±¡ï¼ˆéä¸¥æ ¼æ¨¡å¼ï¼‰</span>
</code></pre>
<p>åŸå› ï¼š<code>say</code> åªæ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°å¼•ç”¨ï¼Œè°ƒç”¨æ—¶æ²¡æœ‰â€œç‚¹â€æ“ä½œç¬¦ï¼Œå› æ­¤ä¸æ»¡è¶³éšå¼ç»‘å®šæ¡ä»¶ã€‚</p>
<blockquote>
<p>ğŸ›‘ å¸¸è§åœºæ™¯ï¼š<code>setTimeout(obj.method, 1000)</code>ã€äº‹ä»¶ç›‘å¬å™¨ <code>addEventListener('click', obj.handler)</code> ç­‰éƒ½ä¼šå¯¼è‡´ <code>this</code> ä¸¢å¤±ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-6">4ï¸âƒ£ ğŸŒ é»˜è®¤ç»‘å®šï¼ˆDefault Bindingï¼‰</h3>
<p>å½“ä»¥ä¸Šä¸‰ç§è§„åˆ™éƒ½ä¸é€‚ç”¨æ—¶ï¼Œ<code>this</code> é‡‡ç”¨é»˜è®¤ç»‘å®šï¼š</p>
<ul>
<li><strong>éä¸¥æ ¼æ¨¡å¼ï¼ˆsloppy modeï¼‰</strong> ï¼š<code>this</code> æŒ‡å‘å…¨å±€å¯¹è±¡ï¼ˆæµè§ˆå™¨ä¸­æ˜¯ <code>window</code>ï¼ŒNode.js ä¸­æ˜¯ <code>global</code>ï¼‰ã€‚</li>
<li><strong>ä¸¥æ ¼æ¨¡å¼ï¼ˆstrict modeï¼‰</strong> ï¼š<code>this</code> ä¸º <code>undefined</code>ã€‚</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);
}

<span class="hljs-title function_">foo</span>(); <span class="hljs-comment">// éä¸¥æ ¼ â†’ windowï¼›ä¸¥æ ¼ â†’ undefined</span>
</code></pre>
<blockquote>
<p>âœ… å¼ºçƒˆå»ºè®®å§‹ç»ˆä½¿ç”¨ä¸¥æ ¼æ¨¡å¼ï¼ˆ<code>'use strict';</code>ï¼‰ï¼Œé¿å…æ„å¤–æ±¡æŸ“å…¨å±€å¯¹è±¡ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-7">ğŸ§© ç‰¹æ®Šæƒ…å†µä¸é™·é˜±</h2>
<h3 data-id="heading-8">ğŸ”’ ç®­å¤´å‡½æ•°ï¼ˆArrow Functionsï¼‰æ²¡æœ‰è‡ªå·±çš„ <code>this</code></h3>
<p>ç®­å¤´å‡½æ•°æ˜¯ ES6 å¼•å…¥çš„é‡è¦ç‰¹æ€§ï¼Œä½†å®ƒ<strong>ä¸éµå¾ªä¸Šè¿°ä»»ä½•ç»‘å®šè§„åˆ™</strong>ã€‚ç®­å¤´å‡½æ•°çš„ <code>this</code> æ˜¯<strong>è¯æ³•ä½œç”¨åŸŸï¼ˆLexical Scopeï¼‰</strong> å†³å®šçš„ï¼Œå³å®ƒç»§æ‰¿è‡ªå¤–å±‚æœ€è¿‘çš„éç®­å¤´å‡½æ•°çš„ <code>this</code>ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Charlie"</span>,
  <span class="hljs-title function_">regularFunc</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">arrow</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);
    <span class="hljs-title function_">arrow</span>(); <span class="hljs-comment">// Charlie</span>
  }
};

obj.<span class="hljs-title function_">regularFunc</span>();
</code></pre>
<blockquote>
<p>ğŸ“Œ ç®­å¤´å‡½æ•°å¸¸ç”¨äºè§£å†³å›è°ƒä¸­ <code>this</code> ä¸¢å¤±çš„é—®é¢˜ï¼Œä½†ä¸èƒ½ç”¨ä½œæ„é€ å‡½æ•°ï¼ˆæ²¡æœ‰ <code>prototype</code>ï¼Œä¹Ÿä¸èƒ½ç”¨ <code>new</code> è°ƒç”¨ï¼‰ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-9">ğŸ”„ å›è°ƒå‡½æ•°ä¸­çš„ <code>this</code></h3>
<p>åœ¨ DOM äº‹ä»¶ã€å®šæ—¶å™¨ã€Promise ç­‰å¼‚æ­¥æ“ä½œä¸­ï¼Œå›è°ƒå‡½æ•°çš„ <code>this</code> å¾€å¾€ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Timer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">seconds</span> = <span class="hljs-number">0</span>;
  }

  <span class="hljs-title function_">start</span>(<span class="hljs-params"/>) {
    <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">seconds</span>++; <span class="hljs-comment">// âŒ this æ˜¯ window æˆ– undefinedï¼</span>
    }, <span class="hljs-number">1000</span>);
  }
}
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<ol>
<li>
<p>ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">start</span>(<span class="hljs-params"/>) {
  <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">seconds</span>++; <span class="hljs-comment">// âœ… æ­£ç¡®</span>
  }, <span class="hljs-number">1000</span>);
}
</code></pre>
</li>
<li>
<p>æ˜¾å¼ç»‘å®šï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">start</span>(<span class="hljs-params"/>) {
  <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">seconds</span>++;
  }.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>), <span class="hljs-number">1000</span>);
}
</code></pre>
</li>
<li>
<p>ç¼“å­˜ <code>this</code>ï¼ˆä¼ ç»Ÿæ–¹æ³•ï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">start</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> self = <span class="hljs-variable language_">this</span>;
  <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    self.<span class="hljs-property">seconds</span>++;
  }, <span class="hljs-number">1000</span>);
}
</code></pre>
</li>
</ol>
<hr/>
<h2 data-id="heading-10">ğŸ§ª å¦‚ä½•åˆ¤æ–­ <code>this</code> çš„å€¼ï¼Ÿâ€”â€”å››æ­¥å†³ç­–æ³•</h2>
<p>å½“ä½ çœ‹åˆ°ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ—¶ï¼ŒæŒ‰ä»¥ä¸‹é¡ºåºæ£€æŸ¥ï¼š</p>
<ol>
<li><strong>æ˜¯å¦é€šè¿‡ <code>new</code> è°ƒç”¨ï¼Ÿ</strong> â†’ <code>this</code> æ˜¯æ–°å¯¹è±¡ã€‚</li>
<li><strong>æ˜¯å¦é€šè¿‡ <code>call</code>/<code>apply</code>/<code>bind</code> è°ƒç”¨ï¼Ÿ</strong> â†’ <code>this</code> æ˜¯æŒ‡å®šçš„å¯¹è±¡ã€‚</li>
<li><strong>æ˜¯å¦é€šè¿‡â€œç‚¹â€æ“ä½œç¬¦è°ƒç”¨ï¼ˆå¦‚ <code>obj.fn()</code>ï¼‰ï¼Ÿ</strong> â†’ <code>this</code> æ˜¯ç‚¹å‰é¢çš„å¯¹è±¡ã€‚</li>
<li><strong>å¦åˆ™</strong> â†’ é»˜è®¤ç»‘å®šï¼ˆä¸¥æ ¼æ¨¡å¼ä¸‹ä¸º <code>undefined</code>ï¼Œå¦åˆ™ä¸ºå…¨å±€å¯¹è±¡ï¼‰ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-11">ğŸ›  æœ€ä½³å®è·µ</h2>
<ul>
<li>
<p><strong>ä¼˜å…ˆä½¿ç”¨ç®­å¤´å‡½æ•°å¤„ç†å›è°ƒ</strong>ï¼Œé¿å… <code>this</code> ä¸¢å¤±ã€‚</p>
</li>
<li>
<p><strong>åœ¨ç±»ä¸­ä½¿ç”¨ç®­å¤´å‡½æ•°å®šä¹‰æ–¹æ³•</strong>ï¼ˆå¦‚æœéœ€è¦ç»‘å®šåˆ°å®ä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Component</span> {
  handleClick = <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// this å§‹ç»ˆæŒ‡å‘ç»„ä»¶å®ä¾‹</span>
  }
}
</code></pre>
</li>
<li>
<p><strong>é¿å…åœ¨éå¿…è¦æƒ…å†µä¸‹ä¾èµ– <code>this</code></strong>ï¼Œå°¤å…¶æ˜¯åœ¨çº¯å‡½æ•°æˆ–å·¥å…·å‡½æ•°ä¸­ã€‚</p>
</li>
<li>
<p><strong>å§‹ç»ˆå¯ç”¨ä¸¥æ ¼æ¨¡å¼</strong>ï¼Œé˜²æ­¢æ„å¤–çš„å…¨å±€ç»‘å®šã€‚</p>
</li>
</ul>
<hr/>
<h2 data-id="heading-12">ğŸŒ æ€»ç»“</h2>
<p><code>this</code> æ˜¯ JavaScript è¯­è¨€è®¾è®¡ä¸­æå…·ç‰¹è‰²çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒä½“ç°äº†åŠ¨æ€ä¸Šä¸‹æ–‡çš„æ€æƒ³ã€‚è™½ç„¶åˆçœ‹å¤æ‚ï¼Œä½†åªè¦æŒæ¡å…¶å››æ¡æ ¸å¿ƒç»‘å®šè§„åˆ™ï¼Œå¹¶ç†è§£ç®­å¤´å‡½æ•°çš„ç‰¹æ®Šæ€§ï¼Œå°±èƒ½åœ¨ä»»ä½•åœºæ™¯ä¸‹å‡†ç¡®é¢„æµ‹ <code>this</code> çš„æŒ‡å‘ã€‚</p>
<p>è®°ä½ï¼š<strong><code>this</code> ä¸æ˜¯ç”±å‡½æ•°å®šä¹‰çš„ä½ç½®å†³å®šçš„ï¼Œè€Œæ˜¯ç”±å‡½æ•°è°ƒç”¨çš„æ–¹å¼å†³å®šçš„ã€‚</strong> æŒæ¡è¿™ä¸€ç‚¹ï¼Œä½ å°±å·²ç»è¶…è¶Šäº†å¤§å¤šæ•°å¼€å‘è€…ï¼</p>
<hr/>
<p>ğŸ“˜ <strong>å»¶ä¼¸é˜…è¯»å»ºè®®</strong>ï¼š</p>
<ul>
<li>ã€Šä½ ä¸çŸ¥é“çš„JavaScriptï¼ˆä¸Šå·ï¼‰ã€‹â€”â€” Kyle Simpsonï¼ˆæ·±å…¥è®²è§£ <code>this</code> ä¸ä½œç”¨åŸŸï¼‰</li>
<li>MDN Web Docs: <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FJavaScript%2FReference%2FOperators%2Fthis" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/this" ref="nofollow noopener noreferrer">this</a></li>
<li>ECMAScript è§„èŒƒä¸­å…³äº <code>CallSite</code> å’Œ <code>ThisBinding</code> çš„å®šä¹‰</li>
</ul>
<p>ç°åœ¨ï¼Œä¸‹æ¬¡å†é‡åˆ° <code>this</code>ï¼Œä½ ä¸ä¼šå†è¿·èŒ«äº†ï¼ğŸš€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[12G æ˜¾å­˜æƒ³è·‘ 24G æ¨¡å‹ï¼Ÿæ·±åº¦è§£æâ€œå…±äº«æ˜¾å­˜â€çš„æ€§èƒ½é™·é˜±]]></title>    <link>https://juejin.cn/post/7598418891400921142</link>    <guid>https://juejin.cn/post/7598418891400921142</guid>    <pubDate>2026-01-24T01:45:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598418891400921142" data-draft-id="7598418891400871990" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="12G æ˜¾å­˜æƒ³è·‘ 24G æ¨¡å‹ï¼Ÿæ·±åº¦è§£æâ€œå…±äº«æ˜¾å­˜â€çš„æ€§èƒ½é™·é˜±"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-24T01:45:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç«è½¦å¼ä½"/> <meta itemprop="url" content="https://juejin.cn/user/1345457960792808"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            12G æ˜¾å­˜æƒ³è·‘ 24G æ¨¡å‹ï¼Ÿæ·±åº¦è§£æâ€œå…±äº«æ˜¾å­˜â€çš„æ€§èƒ½é™·é˜±
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1345457960792808/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç«è½¦å¼ä½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T01:45:53.000Z" title="Sat Jan 24 2026 01:45:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æœ¬åœ°éƒ¨ç½²å¤§æ¨¡å‹ï¼ˆLLMï¼‰æ—¶ï¼Œå¾ˆå¤šæ–°æ‰‹éƒ½ä¼šé¢ä¸´ä¸€ä¸ªç»å…¸çš„â€œé€‰æ‹©å›°éš¾ç—‡â€ï¼šçœ‹ç€ 7Bã€13Bã€70B çš„å‚æ•°ç‰ˆæœ¬ï¼Œå†çœ‹ç€è‡ªå·±ç”µè„‘é‡Œçš„ 3060 æˆ– 4070ï¼Œåˆ°åº•è¯¥ä¸‹å“ªä¸€ä¸ªï¼Ÿ</p>
<p>æœ€è¿‘æœ‰ä½æœ‹å‹æ‹¿ç€ä¸€å¼  12GB æ˜¾å­˜çš„ GPU æˆªå›¾é—®æˆ‘ï¼šâ€œæˆ‘èƒ½ä¸èƒ½è·‘ 24G çš„æ¨¡å‹ç‰ˆæœ¬ï¼Ÿâ€è¿™ä¸ªé—®é¢˜éå¸¸æœ‰ä»£è¡¨æ€§ã€‚ä»Šå¤©æˆ‘ä»¬å°±ä»ç¡¬ä»¶åº•å±‚åŸç†å‡ºå‘ï¼ŒèŠèŠæ˜¾å­˜ã€å†…å­˜ä¸å¤§æ¨¡å‹æ€§èƒ½ä¹‹é—´çš„â€œçˆ±æ¨æƒ…ä»‡â€ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ è¯»æ‡‚ä½ çš„â€œæˆ˜åœºâ€ï¼šä¸“ç”¨æ˜¾å­˜ vs. å…±äº«æ˜¾å­˜</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çœ‹æ‡‚ Windows ä»»åŠ¡ç®¡ç†å™¨ä¸­ GPU è¿™ä¸€æ çš„ä¸¤ä¸ªæ ¸å¿ƒæ•°æ®ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼š</p>
<ul>
<li><strong>ä¸“ç”¨ GPU å†…å­˜ (Dedicated GPU Memory):</strong> è¿™æ˜¯æ˜¾å¡ä¸Šæ¿è½½çš„ GDDR6X ç­‰é«˜é€Ÿæ˜¾å­˜ã€‚å®ƒæ˜¯ VIP é€šé“ï¼Œå¸¦å®½æå¤§ï¼ˆé€šå¸¸åœ¨ 300GB/s - 1TB/s çº§åˆ«ï¼‰ã€‚<strong>è¿™æ˜¯å¤§æ¨¡å‹æµç•…è¿è¡Œçš„ç‰©ç†åº•çº¿ã€‚</strong></li>
<li><strong>å…±äº« GPU å†…å­˜ (Shared GPU Memory):</strong> è¿™æ˜¯ç³»ç»Ÿä»ä½ çš„å†…å­˜æ¡ï¼ˆDDR4/DDR5ï¼‰é‡Œåˆ’å‡ºæ¥ç»™æ˜¾å¡â€œåº”æ€¥â€ç”¨çš„ã€‚è™½ç„¶å®¹é‡å¤§ï¼Œä½†é€Ÿåº¦æ…¢ï¼ˆé€šå¸¸åªæœ‰ 30-50GB/s å·¦å³ï¼‰ï¼Œä¸”å—é™äº PCIe æ¥å£çš„ä¼ è¾“é€Ÿåº¦ã€‚</li>
</ul>
<blockquote>
<p><strong>ç»“è®ºï¼š</strong> æ˜¾å­˜æ˜¯æ³•æ‹‰åˆ©èµ›é“ï¼Œå†…å­˜æ˜¯æ—©æ™šé«˜å³°çš„åŸå¸‚å…¬è·¯ã€‚</p>
</blockquote>
<h2 data-id="heading-1">äºŒã€ ç®—è´¦ï¼šæ¨¡å‹å‚æ•°é‡åˆ°åº•å å¤šå°‘ç©ºé—´ï¼Ÿ</h2>
<p>å¾ˆå¤šäººä»¥ä¸º 12B çš„æ¨¡å‹å°±ä¸€å®šå  12GB æ˜¾å­˜ï¼Œå…¶å®ä¸å®Œå…¨å¯¹ã€‚æ˜¾å­˜å ç”¨ä¸»è¦ç”±<strong>æ¨¡å‹æƒé‡</strong>å’Œ<strong>KV Cacheï¼ˆä¸Šä¸‹æ–‡ç¼“å­˜ï¼‰</strong> ä¸¤éƒ¨åˆ†ç»„æˆã€‚</p>
<p>æˆ‘ä»¬ä¸»è¦çœ‹<strong>æ¨¡å‹æƒé‡</strong>çš„ä¼°ç®—å…¬å¼ï¼š</p>
<h3 data-id="heading-2">1. åŸå§‹ç²¾åº¦ (FP16 / BF16)</h3>
<p>å¤§å¤šæ•°æ¨¡å‹åŸæœ¬æ˜¯åŠç²¾åº¦æµ®ç‚¹æ•°ï¼ˆFP16ï¼‰ã€‚</p>
<ul>
<li><strong>å…¬å¼ï¼š</strong> <code>å‚æ•°é‡ (B) Ã— 2 = æ˜¾å­˜å ç”¨ (GB)</code></li>
<li><strong>ä¾‹å­ï¼š</strong> ä¸€ä¸ª 12B (120äº¿å‚æ•°) çš„æ¨¡å‹ï¼Œåœ¨ FP16 ä¸‹éœ€è¦ <code>12 Ã— 2 = 24GB</code> æ˜¾å­˜ã€‚</li>
<li><strong>ç°çŠ¶ï¼š</strong> å¦‚æœä½ çš„æ˜¾å¡åªæœ‰ 12GBï¼Œç›´æ¥è¿è¡Œ FP16 çš„ 12B æ¨¡å‹ï¼Œ<strong>å¿…ç„¶çˆ†æ˜¾å­˜</strong>ã€‚</li>
</ul>
<h3 data-id="heading-3">2. é‡åŒ–æŠ€æœ¯ (Quantization - Int4)</h3>
<p>ä¸ºäº†è®©æ¶ˆè´¹çº§æ˜¾å¡èƒ½è·‘å¤§æ¨¡å‹ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ 4-bit é‡åŒ–ï¼ˆå¦‚ GGUF æ ¼å¼çš„ Q4_K_Mï¼‰ã€‚</p>
<ul>
<li><strong>å…¬å¼ï¼š</strong> <code>å‚æ•°é‡ (B) Ã— 0.7 â‰ˆ æ˜¾å­˜å ç”¨ (GB)</code> (åŒ…å«å°‘é‡ overhead)</li>
<li><strong>ä¾‹å­ï¼š</strong> åŒæ ·çš„ 12B æ¨¡å‹ï¼Œé‡åŒ–åˆ° 4-bit åï¼Œå¤§çº¦åªéœ€è¦ <code>12 Ã— 0.7 = 8.4GB</code>ã€‚</li>
<li><strong>ç°çŠ¶ï¼š</strong> è¿™æ—¶å€™ï¼Œ12GB çš„æ˜¾å¡å°±èƒ½è½»æ¾è£…ä¸‹ï¼Œä¸”è¿˜æœ‰ä½™é‡å¤„ç†ä¸Šä¸‹æ–‡ã€‚</li>
</ul>
<h2 data-id="heading-4">ä¸‰ã€ ä¸ºä»€ä¹ˆâ€œèƒ½è·‘â€ä¸ä»£è¡¨â€œèƒ½ç”¨â€ï¼Ÿ</h2>
<p>å›åˆ°å¼€å¤´çš„é—®é¢˜ï¼š<strong>12GB æ˜¾å­˜çš„å¡ï¼Œå¼ºè¡Œè·‘éœ€è¦ 24GB æ˜¾å­˜çš„æ¨¡å‹ï¼ˆä¾‹å¦‚æœªé‡åŒ–çš„ 12B æ¨¡å‹æˆ–æ›´å¤§çš„æ¨¡å‹ï¼‰ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</strong></p>
<p>ç³»ç»Ÿä¸ä¼šç›´æ¥æŠ¥é”™å´©æºƒï¼Œå› ä¸º Windows ä¼šå¯ç”¨â€œå…±äº«æ˜¾å­˜â€æœºåˆ¶ã€‚ç³»ç»Ÿä¼šæŠŠæ˜¾å­˜è£…ä¸ä¸‹çš„é‚£ 12GB æ•°æ®ï¼Œä¸¢åˆ°æ…¢é€Ÿçš„ç³»ç»Ÿå†…å­˜é‡Œã€‚</p>
<p><strong>è¿™æ—¶å€™ï¼Œç¾éš¾å‘ç”Ÿäº†â€”â€”â€œPCIe ç“¶é¢ˆâ€ï¼š</strong></p>
<ol>
<li><strong>æ¨ç†è¿‡ç¨‹ï¼š</strong> å¤§æ¨¡å‹åœ¨ç”Ÿæˆæ¯ä¸€ä¸ªå­—æ—¶ï¼Œéƒ½éœ€è¦éå†æ¨¡å‹çš„å…¨éƒ¨æƒé‡ã€‚</li>
<li><strong>æ•°æ®æ¬è¿ï¼š</strong> æ˜¾å¡æ ¸å¿ƒè®¡ç®—æå¿«ï¼Œä½†å®ƒå¿…é¡»ç­‰å¾…æ•°æ®ä»å†…å­˜é€šè¿‡ PCIe æ¥å£æ…¢æ…¢æ¬è¿è¿‡æ¥ã€‚</li>
<li><strong>ç»“æœï¼š</strong> ä½ çš„ GPU å ç”¨ç‡å¯èƒ½åªæœ‰ 1%-5%ï¼ˆåœ¨ç­‰æ•°æ®ï¼‰ï¼Œè€Œç”Ÿæˆé€Ÿåº¦ä¼šä»æ­£å¸¸çš„ <strong>30 tokens/s (ç§’å›)</strong> æš´è·Œè‡³ <strong>0.5 tokens/s (ä¸€ä¸ªå­—ä¸€ä¸ªå­—è¹¦)</strong>ã€‚</li>
</ol>
<p>è¿™ç§ä½“éªŒå°±åƒæ˜¯ç”¨é¡¶çº§è·‘è½¦åœ¨æ³¥æ³çš„æ²¼æ³½åœ°é‡Œå¼€ï¼Œå®Œå…¨å‘æŒ¥ä¸å‡ºå¼•æ“çš„æ€§èƒ½ã€‚</p>
<h2 data-id="heading-5">å››ã€ é¿å‘å»ºè®®ä¸é€‰å‹æŒ‡å—</h2>
<p>åŸºäºä½ çš„ç¡¬ä»¶ï¼ˆä»¥ 12GB æ˜¾å­˜ä¸ºä¾‹ï¼‰ï¼Œä»¥ä¸‹æ˜¯é€‰å‹â€œé»„é‡‘æ³•åˆ™â€ï¼š</p>
<ol>
<li><strong>ä¸ä»…è¦çœ‹æ€»å®¹é‡ï¼Œæ›´è¦çœ‹â€œå‡€ç©ºâ€ï¼š</strong>
å¦‚æœä½ æ­£åœ¨ç©æ¸¸æˆæˆ–çœ‹é«˜æ¸…è§†é¢‘ï¼Œæ˜¾å­˜å¯èƒ½å·²ç»è¢«å ç”¨äº† 4GB-6GBã€‚åœ¨è·‘æ¨¡å‹å‰ï¼ŒåŠ¡å¿…<strong>å…³é—­åå°é«˜æ˜¾å­˜åº”ç”¨</strong>ã€‚å¦‚æœä½ åªæœ‰ 5.5GB å¯ç”¨æ˜¾å­˜ï¼Œå“ªæ€•æ˜¯ 7B çš„æ¨¡å‹ä¹Ÿå¯èƒ½è·‘ä¸åŠ¨ã€‚</li>
<li><strong>é¦–é€‰é‡åŒ–ç‰ˆæœ¬ (GGUF/GPTQ/AWQ)ï¼š</strong></li>
</ol>
<ul>
<li><strong>8GB æ˜¾å­˜ï¼š</strong> æ¨è 7B-8B æ¨¡å‹ (Q4/Q5 é‡åŒ–)ã€‚</li>
<li><strong>12GB æ˜¾å­˜ï¼š</strong> å®Œç¾é€‚é… 10B-14B æ¨¡å‹ (Q4 é‡åŒ–)ï¼Œæˆ– 7B-8B çš„é«˜ç²¾åº¦ç‰ˆæœ¬ã€‚</li>
<li><strong>24GB æ˜¾å­˜ï¼š</strong> å¯ä»¥å°è¯• 30B-70B çš„é‡åŒ–ç‰ˆæœ¬ã€‚</li>
</ul>
<ol start="3">
<li><strong>ä½“éªŒ vs. ç”Ÿäº§åŠ›ï¼š</strong>
å¦‚æœä½ åªæ˜¯ä¸ºäº†æµ‹è¯•æ¨¡å‹èƒ½ä¸èƒ½è·‘é€šï¼Œä¸ä»‹æ„ç­‰å‡ åˆ†é’Ÿå‡ºä¸€å¥è¯ï¼Œé‚£ä¹ˆåˆ©ç”¨â€œå…±äº«å†…å­˜â€è·‘è¶…å¤§æ¨¡å‹æ˜¯å¯ä»¥çš„ã€‚ä½†å¦‚æœä½ æ˜¯ä¸ºäº†æ—¥å¸¸åŠ©æ‰‹ã€ç¼–ç¨‹è¾…åŠ©æˆ–è§’è‰²æ‰®æ¼”ï¼Œ<strong>è¯·åŠ¡å¿…ç¡®ä¿æ¨¡å‹å¤§å° &lt; ä½ çš„ä¸“ç”¨æ˜¾å­˜å®¹é‡</strong>ã€‚</li>
</ol>
<h2 data-id="heading-6">ç»“è¯­</h2>
<p>å¤§æ¨¡å‹æ—¶ä»£ï¼Œæ˜¾å­˜å³æ­£ä¹‰ã€‚ä½†åœ¨æ˜¾å­˜æœ‰é™çš„æƒ…å†µä¸‹ï¼Œåˆç†é€‰æ‹©é‡åŒ–ç‰ˆæœ¬ã€ç®¡ç†åå°è¿›ç¨‹ï¼Œæ¯”ç›²ç›®è¿½æ±‚å¤§å‚æ•°ç‰ˆæœ¬æ›´èƒ½å¸¦æ¥æµç•…çš„ AI ä½“éªŒã€‚è®°ä½ï¼š<strong>è·‘å¾—å¿«çš„å°æ¨¡å‹ï¼Œè¿œæ¯”è·‘ä¸åŠ¨çš„â€œèƒ–â€æ¨¡å‹è¦æœ‰ç”¨å¾—å¤šã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Playwrightå­¦ä¹ ç¬”è®° 07ã€‘å…¶å®ƒç”¨æˆ·è§†è§‰å®šä½çš„æ–¹æ³•]]></title>    <link>https://juejin.cn/post/7598390354292637742</link>    <guid>https://juejin.cn/post/7598390354292637742</guid>    <pubDate>2026-01-23T15:26:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598390354292637742" data-draft-id="7598424770321924105" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Playwrightå­¦ä¹ ç¬”è®° 07ã€‘å…¶å®ƒç”¨æˆ·è§†è§‰å®šä½çš„æ–¹æ³•"/> <meta itemprop="keywords" content="å‰ç«¯,CSS"/> <meta itemprop="datePublished" content="2026-01-23T15:26:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é„­éƒ‘"/> <meta itemprop="url" content="https://juejin.cn/user/590879236308844"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Playwrightå­¦ä¹ ç¬”è®° 07ã€‘å…¶å®ƒç”¨æˆ·è§†è§‰å®šä½çš„æ–¹æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/590879236308844/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é„­éƒ‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T15:26:45.000Z" title="Fri Jan 23 2026 15:26:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;color:rgba(46,36,36,.87);overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{margin-bottom:5px;font-size:30px;font-weight:500}.markdown-body h1:before{content:"#";margin-right:10px;color:#1976d2}.markdown-body h2{font-size:28px;font-weight:400;border-left:5px solid #454545;margin-top:20px;padding-left:10px;transition:all .3s ease-in-out}.markdown-body h2:hover{border-color:#1976d2}.markdown-body h3{font-size:24px;font-weight:400;margin-top:15px;padding-bottom:0}.markdown-body h4{font-size:20px;font-weight:500}.markdown-body h5{font-size:16px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h2:first-letter,.markdown-body h3:first-letter,.markdown-body p:first-letter{text-transform:capitalize}.markdown-body em{text-emphasis:dot;text-emphasis-position:under}.markdown-body img{display:block;margin:0 auto!important;max-width:100%;border-radius:2px;box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)!important}.markdown-body hr{position:relative;width:98%;height:1px;border:none;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,#ddd,#999,#ddd);overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center}.markdown-body code{font-weight:900;word-break:break-word;border-radius:2px;overflow-x:auto;font-size:.87em;padding:.065em .4em;background-color:#fbe5e1;color:#c0341d}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:0 4px}.markdown-body pre&gt;code{font-weight:400;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{margin:0 4px;text-decoration:none;color:#027fff;transition:all .3s ease-in-out;padding-bottom:4px;border-bottom:2px solid transparent}.markdown-body a:after{content:"";display:inline-block;width:18px;height:18px;margin-left:4px;vertical-align:middle;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMjdGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PHBhdGggZD0iTTkuODE1IDYuNDQ4bDEuOTM2LTEuOTM2YzEuMzM3LTEuMzM2IDMuNTgtMS4yNTkgNS4wMTMuMTczIDEuNDMyIDEuNDMyIDEuNTEgMy42NzYuMTczIDUuMDEzbC0xLjQ1MiAxLjQ1Mi0uOTY4Ljk2OGMtMS4zMzcgMS4zMzYtMy41ODEgMS4yNTktNS4wMTMtLjE3MyIvPjxwYXRoIGQ9Ik0xMS4yNjcgMTUuMzY3bC0xLjkzNiAxLjkzNmMtMS4zMzYgMS4zMzctMy41OCAxLjI2LTUuMDEyLS4xNzMtMS40MzItMS40MzItMS41MS0zLjY3Ni0uMTczLTUuMDEybDEuNDUyLTEuNDUyLjk2OC0uOTY4YzEuMzM2LTEuMzM3IDMuNTgtMS4yNiA1LjAxMi4xNzMiLz48L2c+PC9zdmc+);background-size:cover;background-repeat:no-repeat}.markdown-body a:hover{border-color:#027fff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body a.footnote-backref:after,.markdown-body a.footnote-ref:after,.markdown-body sup a:after{display:none!important}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border:2px solid #c6c6c6}.markdown-body table img{box-shadow:none!important}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body del{color:rgba(0,0,0,.6)}.markdown-body blockquote{position:relative;color:#666;padding:5px 23px 1px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:hsla(0,0%,78.4%,.12);transition:all .2s ease-in-out}.markdown-body blockquote:hover{border-color:#1976d2}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;font-size:24px;font-weight:800;line-height:24px;color:#cbcbcb;opacity:.6}.markdown-body blockquote:before{content:"â€œ";top:4px;left:6px}.markdown-body blockquote:after{content:"â€";right:8px;bottom:-8px}.markdown-body blockquote&gt;p,.markdown-body blockquote blockquote{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body details{outline:none;border:none;border-left:4px solid #1976d2;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary:hover::-webkit-details-marker{color:#1976d2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä¸‹é¢çš„è¿™4ç§å®šä½ï¼Œä¹Ÿå±äºæ ¹æ®ç”¨æˆ·è§†è§‰ä¸Šçš„å†…å®¹å®šä½ã€‚</p>
<p>å¯ä»¥é€šè¿‡ä»£ç åŠ©æ‰‹äº§ç”Ÿï¼Œå…¶å®ä¹Ÿå®Œå…¨å¯ä»¥ç”¨ css selector å®šä½æ›¿ä»£ï¼Œäº†è§£å³å¯ã€‚</p>
<h2 data-id="heading-0">æ ¹æ® å…ƒç´  placeholder å®šä½</h2>
<p><code>input</code> å…ƒç´ ï¼Œé€šå¸¸éƒ½æœ‰ <code>placeholder</code> å±æ€§ï¼Œ</p>
<p>å¯ä»¥ä½¿ç”¨ Page/Locator å¯¹è±¡çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fplaywright.dev%2Fpython%2Fdocs%2Fapi%2Fclass-locator%23locator-get-by-placeholder" title="https://playwright.dev/python/docs/api/class-locator#locator-get-by-placeholder" target="_blank" ref="nofollow noopener noreferrer">get_by_placeholder</a> æ–¹æ³•ï¼Œæ ¹æ® <code>placeholder</code> å±æ€§å€¼å®šä½ã€‚</p>
<p>æ¯”å¦‚</p>
<pre><code class="hljs language-ini" lang="ini">&lt;input <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> placeholder=<span class="hljs-string">"captcha"</span> /&gt;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>å°±å¯ä»¥è¿™æ ·å®šä½</p>
<pre><code class="hljs language-ini" lang="ini">page.get_by_placeholder('captcha',<span class="hljs-attr">exact</span>=<span class="hljs-literal">True</span>).fill(<span class="hljs-string">'ç™½æœˆé»‘ç¾½'</span>)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>å‚æ•° <code>exact</code> å€¼ä¸º <code>True</code> ï¼Œè¡¨ç¤ºå®Œå…¨åŒ¹é…ï¼Œä¸”åŒºåˆ†å¤§å°å†™ã€‚å¦‚æœå€¼ä¸ºFalseï¼Œå°±åªéœ€åŒ…å«å‚æ•°å­—ç¬¦ä¸²å³å¯ï¼Œä¸”ä¸åŒºåˆ†å¤§å°å†™ã€‚</p>
<p>ä½œç”¨ç±»ä¼¼ <strong>get_by_role</strong> é‡Œé¢çš„ <code>exact</code> å‚æ•°</p>
<h2 data-id="heading-1">æ ¹æ® å…ƒç´ å…³è”çš„ label å®šä½</h2>
<p><code>input</code> å…ƒç´ ï¼Œé€šå¸¸éƒ½æœ‰å…³è”çš„ label</p>
<p>å¯ä»¥ä½¿ç”¨ Page/Locator å¯¹è±¡çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fplaywright.dev%2Fpython%2Fdocs%2Fapi%2Fclass-locator%23locator-get-by-label" title="https://playwright.dev/python/docs/api/class-locator#locator-get-by-label" target="_blank" ref="nofollow noopener noreferrer">get_by_label</a> æ–¹æ³•ï¼Œæ ¹æ® å…ƒç´ å…³è”çš„ label å®šä½ã€‚</p>
<p>æ¯”å¦‚</p>
<pre><code class="hljs language-ini" lang="ini">  &lt;input <span class="hljs-attr">aria-label</span>=<span class="hljs-string">"Username"</span>&gt;
  &lt;label <span class="hljs-attr">for</span>=<span class="hljs-string">"password-input"</span>&gt;Password:&lt;/label&gt;
  &lt;input <span class="hljs-attr">id</span>=<span class="hljs-string">"password-input"</span>&gt;
</code></pre>
<p>å°±å¯ä»¥è¿™æ ·å®šä½</p>
<pre><code class="hljs language-arduino" lang="arduino">page.<span class="hljs-built_in">get_by_label</span>(<span class="hljs-string">"Username"</span>).<span class="hljs-built_in">fill</span>(<span class="hljs-string">"john"</span>)
page.<span class="hljs-built_in">get_by_label</span>(<span class="hljs-string">"Password"</span>).<span class="hljs-built_in">fill</span>(<span class="hljs-string">"secret"</span>)
</code></pre>
<p>æœ‰äº›å…ƒç´ ï¼Œæ¯”å¦‚ <code>img</code> å…ƒç´ ï¼Œé€šå¸¸éƒ½æœ‰ <code>alt</code> å±æ€§</p>
<p>å¯ä»¥ä½¿ç”¨ Page/Locator å¯¹è±¡çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fplaywright.dev%2Fpython%2Fdocs%2Fapi%2Fclass-locator%23locator-get-by-alt-text" title="https://playwright.dev/python/docs/api/class-locator#locator-get-by-alt-text" target="_blank" ref="nofollow noopener noreferrer">get_by_alt_text</a> æ–¹æ³•ï¼Œæ ¹æ® å…ƒç´ çš„ <code>alt</code> å±æ€§å€¼ å®šä½</p>
<p>æ¯”å¦‚</p>
<pre><code class="hljs language-ini" lang="ini">&lt;img 
  <span class="hljs-attr">src</span>=<span class="hljs-string">"https://doc.qt.io/qtforpython/_images/windows-pushbutton.png"</span> 
  <span class="hljs-attr">alt</span>=<span class="hljs-string">"qt-button"</span>&gt;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>å°±å¯ä»¥è¿™æ ·å®šä½</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">href</span> = page.get_by_alt_text(<span class="hljs-string">"qt-button"</span>).get_attribute(<span class="hljs-string">'src'</span>)
print(href)
</code></pre>
<p><strong><code>get_by_alt_text</code></strong> ä¹Ÿæœ‰ <strong><code>exact</code></strong> å‚æ•°ï¼Œä½œç”¨å’Œ <strong><code>get_by_placeholder</code></strong> é‡Œé¢çš„ <strong><code>exact</code></strong> å‚æ•° ä¸€æ ·ã€‚</p>
<h2 data-id="heading-2">æ ¹æ® å…ƒç´  title å®šä½</h2>
<p>æœ‰äº›å…ƒç´ ï¼Œæ¯”å¦‚ <code>span</code>, <code>a</code> ç­‰ç­‰ï¼Œå¯èƒ½æœ‰ <code>title</code> å±æ€§ï¼Œå½“é¼ æ ‡æ‚¬æµ®åœ¨è¯¥å…ƒç´ ä¸Šæ—¶ï¼Œå¯ä»¥æ˜¾ç¤ºtitleå±æ€§å†…åœ¨ä¸€ä¸ªæç¤ºæ¡†é‡Œé¢</p>
<p>å¯ä»¥ä½¿ç”¨ Page/Locator å¯¹è±¡çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fplaywright.dev%2Fpython%2Fdocs%2Fapi%2Fclass-locator%23locator-get-by-title" title="https://playwright.dev/python/docs/api/class-locator#locator-get-by-title" target="_blank" ref="nofollow noopener noreferrer">get_by_title</a> æ–¹æ³•ï¼Œæ ¹æ® å…ƒç´ çš„ <code>title</code> å±æ€§å€¼ å®šä½</p>
<p>æ¯”å¦‚</p>
<pre><code class="hljs language-ini" lang="ini">
  &lt;a <span class="hljs-attr">href</span>=<span class="hljs-string">"https://www.byhy.net"</span> title=<span class="hljs-string">"byhyé¦–é¡µ"</span>&gt;ç™½æœˆé»‘ç¾½æ•™ç¨‹&lt;/a&gt;
</code></pre>
<p>å°±å¯ä»¥è¿™æ ·å®šä½</p>
<pre><code class="hljs language-scss" lang="scss">page<span class="hljs-selector-class">.get_by_title</span>("byhyé¦–é¡µ")<span class="hljs-selector-class">.click</span>()
</code></pre>
<h2 data-id="heading-3">ç¼ºçœç­‰å¾…æ—¶é—´</h2>
<p>Playwright ä¸­ï¼Œå½“æˆ‘ä»¬å®šä½å…ƒç´ ï¼ˆæ¯”å¦‚ é€šè¿‡locator/get_by_text ç­‰æ–¹æ³•ï¼‰åï¼Œå¯¹å…ƒç´ è¿›è¡Œæ“ä½œï¼ˆæ¯”å¦‚ click, fillï¼‰ï¼Œ</p>
<p>å¦‚æœå½“æ—¶æ ¹æ®å®šä½æ¡ä»¶ï¼Œæ‰¾ä¸åˆ°è¿™ä¸ªå…ƒç´ ï¼Œ Playwrightå¹¶ä¸ä¼šç«‹å³æŠ›å‡ºé”™è¯¯ï¼Œ è€Œæ˜¯ç¼ºçœç­‰å¾…å…ƒç´ æ—¶é—´ä¸º30ç§’ï¼Œåœ¨30ç§’å†…å¦‚æœå…ƒç´ å‡ºç°äº†ï¼Œå°±ç«‹å³æ“ä½œæˆåŠŸè¿”å›ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">from playwright<span class="hljs-selector-class">.sync_api</span> import sync_playwright

<span class="hljs-selector-tag">p</span> = <span class="hljs-built_in">sync_playwright</span>()<span class="hljs-selector-class">.start</span>()
browser = <span class="hljs-selector-tag">p</span><span class="hljs-selector-class">.chromium</span><span class="hljs-selector-class">.launch</span>(headless=False)
page = browser<span class="hljs-selector-class">.new_page</span>()
page<span class="hljs-selector-class">.goto</span>("https://www.byhy.net/cdn2/files/selenium/stock1.html")
page<span class="hljs-selector-class">.locator</span>('#kw')<span class="hljs-selector-class">.fill</span>('é€šè®¯\n')
page<span class="hljs-selector-class">.locator</span>('#go')<span class="hljs-selector-class">.click</span>()
element = page<span class="hljs-selector-class">.locator</span>("[id='<span class="hljs-number">1</span>']")

<span class="hljs-built_in">print</span>(element.inner_text())
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>å¦‚æœæˆ‘ä»¬ä¿®æ”¹ä¸‹é¢çš„ä»£ç </p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">print</span>(element.inner_text())
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>æ”¹ä¸º</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">print</span>(element.inner_text(<span class="hljs-built_in">timeout</span>=10 ))
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>è¡¨ç¤ºç­‰å¾…å…ƒç´ å‡ºç°æ—¶é•¿ä¿®æ”¹ä¸º10æ¯«ç§’ï¼Œå†è¿è¡Œï¼Œå°±ä¼šæœ‰é”™è¯¯äº†ã€‚</p>
<p>å¦‚æœï¼Œæˆ‘ä»¬æƒ³ä¿®æ”¹ <code>ç¼ºçœ</code> ç­‰å¾…æ—¶é—´ï¼Œ å¯ä»¥ä½¿ç”¨ <code>BrowserContext</code> å¯¹è±¡ï¼Œ å¦‚ä¸‹</p>
<pre><code class="hljs language-ini" lang="ini">from playwright.sync_api import sync_playwright
<span class="hljs-attr">p</span> = sync_playwright().start()

<span class="hljs-attr">browser</span> = p.chromium.launch(headless=<span class="hljs-literal">False</span>, slow_mo=<span class="hljs-number">50</span>)

<span class="hljs-attr">context</span> = browser.new_context()
context.set_default_timeout(10) <span class="hljs-comment">#ä¿®æ”¹ç¼ºçœç­‰å¾…æ—¶é—´ä¸º10æ¯«ç§’</span>
<span class="hljs-attr">page</span> = context.new_page() <span class="hljs-comment"># é€šè¿‡context åˆ›å»ºPageå¯¹è±¡</span>

page.goto("https://www.byhy.net/cdn2/files/selenium/stock1.html")
page.locator('<span class="hljs-comment">#kw').fill('é€šè®¯\n')</span>
page.locator('<span class="hljs-comment">#go').click()</span>

<span class="hljs-attr">element</span> = page.locator(<span class="hljs-string">"[id='1']"</span>)
print(element.inner_text())
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸå‹é“¾æ˜¯ä»€ä¹ˆ]]></title>    <link>https://juejin.cn/post/7598389448146403338</link>    <guid>https://juejin.cn/post/7598389448146403338</guid>    <pubDate>2026-01-23T15:52:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598389448146403338" data-draft-id="7598374376094416923" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸå‹é“¾æ˜¯ä»€ä¹ˆ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-23T15:52:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç çŒäºº"/> <meta itemprop="url" content="https://juejin.cn/user/624972624037374"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸå‹é“¾æ˜¯ä»€ä¹ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/624972624037374/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç çŒäºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T15:52:58.000Z" title="Fri Jan 23 2026 15:52:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>åŸå‹é“¾ï¼ˆPrototype Chainï¼‰</strong> Â æ˜¯ JavaScript å®ç°ç»§æ‰¿çš„æ ¸å¿ƒæœºåˆ¶ã€‚ç®€å•æ¥è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ä¹‹é—´é€šè¿‡Â <code>__proto__</code>ï¼ˆæˆ–Â <code>[[Prototype]]</code>ï¼‰å±æ€§é“¾æ¥èµ·æ¥çš„é“¾å¼ç»“æ„ï¼Œç”¨äºæŸ¥æ‰¾å±æ€§å’Œæ–¹æ³•ã€‚</p>
<hr/>
<h2 data-id="heading-0">æ ¸å¿ƒæ¦‚å¿µ</h2>
<h3 data-id="heading-1">1.Â <strong>åŸå‹ï¼ˆPrototypeï¼‰</strong></h3>
<p>æ¯ä¸ª JavaScript å¯¹è±¡ï¼ˆé™¤Â <code>null</code>Â å¤–ï¼‰éƒ½æœ‰ä¸€ä¸ªéšè—çš„Â <code>[[Prototype]]</code>Â å±æ€§ï¼ˆå¯é€šè¿‡Â <code>__proto__</code>Â æˆ–Â <code>Object.getPrototypeOf()</code>Â è®¿é—®ï¼‰ï¼ŒæŒ‡å‘å®ƒçš„åŸå‹å¯¹è±¡ã€‚</p>
<h3 data-id="heading-2">2.Â <strong>åŸå‹é“¾æŸ¥æ‰¾è§„åˆ™</strong></h3>
<p>å½“è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æˆ–æ–¹æ³•æ—¶ï¼š</p>
<ol>
<li>å…ˆåœ¨<strong>å¯¹è±¡è‡ªèº«</strong>æŸ¥æ‰¾</li>
<li>å¦‚æœæ²¡æ‰¾åˆ°ï¼Œåˆ™é€šè¿‡Â <code>__proto__</code>Â å»å®ƒçš„<strong>åŸå‹å¯¹è±¡</strong>ä¸ŠæŸ¥æ‰¾</li>
<li>å¦‚æœè¿˜æ²¡æ‰¾åˆ°ï¼Œç»§ç»­æ²¿ç€åŸå‹å¯¹è±¡çš„Â <code>__proto__</code>Â å‘ä¸ŠæŸ¥æ‰¾</li>
<li>ç›´åˆ°æ‰¾åˆ°Â <code>null</code>ï¼ˆåŸå‹é“¾ç»ˆç‚¹ï¼‰ä¸ºæ­¢</li>
</ol>
<hr/>
<h2 data-id="heading-3">ç¤ºä¾‹è¯´æ˜</h2>
<h3 data-id="heading-4">ç¤ºä¾‹ 1ï¼šåŸºæœ¬åŸå‹é“¾</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> animal = {
  <span class="hljs-attr">eats</span>: <span class="hljs-literal">true</span>
};

<span class="hljs-keyword">const</span> rabbit = {
  <span class="hljs-attr">jumps</span>: <span class="hljs-literal">true</span>
};

<span class="hljs-comment">// è®¾ç½® rabbit çš„åŸå‹ä¸º animal</span>
rabbit.<span class="hljs-property">__proto__</span> = animal;

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rabbit.<span class="hljs-property">jumps</span>); <span class="hljs-comment">// trueï¼Œè‡ªèº«å±æ€§</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rabbit.<span class="hljs-property">eats</span>);  <span class="hljs-comment">// trueï¼Œä»åŸå‹ animal ç»§æ‰¿</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rabbit.<span class="hljs-property">toString</span>); <span class="hljs-comment">// å‡½æ•°ï¼Œä»æ›´ä¸Šå±‚çš„ Object.prototype ç»§æ‰¿</span>
</code></pre>
<p>æ­¤æ—¶çš„åŸå‹é“¾ï¼š</p>
<pre><code class="hljs language-text" lang="text">rabbit â†’ animal â†’ Object.prototype â†’ null
</code></pre>
<h3 data-id="heading-5">ç¤ºä¾‹ 2ï¼šæ„é€ å‡½æ•°ä¸åŸå‹é“¾</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}

<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sayHello</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>);
};

<span class="hljs-keyword">const</span> john = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'John'</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(john.<span class="hljs-property">name</span>);      <span class="hljs-comment">// "John"ï¼Œè‡ªèº«å±æ€§</span>
john.<span class="hljs-title function_">sayHello</span>();             <span class="hljs-comment">// ä» Person.prototype ç»§æ‰¿</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(john.<span class="hljs-title function_">toString</span>()); <span class="hljs-comment">// ä» Object.prototype ç»§æ‰¿</span>
</code></pre>
<p>åŸå‹é“¾ï¼š</p>
<pre><code class="hljs language-text" lang="text">john â†’ Person.prototype â†’ Object.prototype â†’ null
</code></pre>
<h2 data-id="heading-6">é‡è¦ç‰¹æ€§</h2>
<h3 data-id="heading-7">1.Â <strong>åŸå‹ç»§æ‰¿</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Animal</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
}

<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">eat</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> eats`</span>);
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Dog</span>(<span class="hljs-params">name, breed</span>) {
  <span class="hljs-title class_">Animal</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, name);  <span class="hljs-comment">// ç»§æ‰¿å±æ€§</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">breed</span> = breed;
}

<span class="hljs-comment">// ç»§æ‰¿æ–¹æ³•ï¼šè®¾ç½® Dog.prototype çš„åŸå‹ä¸º Animal.prototype</span>
<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Dog</span>;

<span class="hljs-title class_">Dog</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">bark</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> barks`</span>);
};

<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">'Rex'</span>, <span class="hljs-string">'Labrador'</span>);
dog.<span class="hljs-title function_">eat</span>();  <span class="hljs-comment">// ä» Animal.prototype ç»§æ‰¿</span>
dog.<span class="hljs-title function_">bark</span>(); <span class="hljs-comment">// Dog.prototype è‡ªèº«æ–¹æ³•</span>
</code></pre>
<h3 data-id="heading-8">2.Â <strong>å±æ€§é®è”½</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">value</span>: <span class="hljs-number">1</span>
};

<span class="hljs-keyword">const</span> child = {
  <span class="hljs-attr">__proto__</span>: obj,
  <span class="hljs-attr">value</span>: <span class="hljs-number">2</span>  <span class="hljs-comment">// é®è”½åŸå‹ä¸­çš„ value</span>
};

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(child.<span class="hljs-property">value</span>); <span class="hljs-comment">// 2ï¼Œä½¿ç”¨è‡ªèº«çš„ value</span>
<span class="hljs-keyword">delete</span> child.<span class="hljs-property">value</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(child.<span class="hljs-property">value</span>); <span class="hljs-comment">// 1ï¼Œç°åœ¨ä»åŸå‹è·å–</span>
</code></pre>
<h3 data-id="heading-9">3.Â <strong>æ–¹æ³•é‡å†™</strong></h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">move</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Moving'</span>);
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Bird</span>(<span class="hljs-params"/>) {}

<span class="hljs-title class_">Bird</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">Animal</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-title class_">Bird</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">move</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {  <span class="hljs-comment">// é‡å†™æ–¹æ³•</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Flying'</span>);
};

<span class="hljs-keyword">const</span> bird = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bird</span>();
bird.<span class="hljs-title function_">move</span>(); <span class="hljs-comment">// "Flying"ï¼Œä½¿ç”¨é‡å†™åçš„æ–¹æ³•</span>
</code></pre>
<h2 data-id="heading-10">ç›¸å…³æ–¹æ³•</h2>
<h3 data-id="heading-11">1.Â <strong>Object.create()</strong> Â - åˆ›å»ºå…·æœ‰æŒ‡å®šåŸå‹çš„å¯¹è±¡</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> proto = { <span class="hljs-attr">x</span>: <span class="hljs-number">10</span> };
<span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(proto);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">x</span>); <span class="hljs-comment">// 10ï¼Œä»åŸå‹ç»§æ‰¿</span>
</code></pre>
<h3 data-id="heading-12">2.Â <strong>Object.getPrototypeOf()</strong> Â - è·å–å¯¹è±¡çš„åŸå‹</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>([]) === <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>); <span class="hljs-comment">// true</span>
</code></pre>
<h3 data-id="heading-13">3.Â <strong>Object.setPrototypeOf()</strong> Â - è®¾ç½®å¯¹è±¡çš„åŸå‹</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj = {};
<span class="hljs-keyword">const</span> proto = { <span class="hljs-attr">x</span>: <span class="hljs-number">1</span> };
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">setPrototypeOf</span>(obj, proto);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">x</span>); <span class="hljs-comment">// 1</span>
</code></pre>
<h3 data-id="heading-14">4.Â <strong>instanceof</strong>Â - æ£€æŸ¥åŸå‹é“¾</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([] <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>);   <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([] <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span>);  <span class="hljs-comment">// true</span>
</code></pre>
<h3 data-id="heading-15">5.Â <strong>hasOwnProperty()</strong> Â - æ£€æŸ¥æ˜¯å¦æ˜¯è‡ªèº«å±æ€§</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> };
obj.<span class="hljs-property">__proto__</span> = { <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> };

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-title function_">hasOwnProperty</span>(<span class="hljs-string">'a'</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-title function_">hasOwnProperty</span>(<span class="hljs-string">'b'</span>)); <span class="hljs-comment">// false</span>
</code></pre>
<h2 data-id="heading-16">åŸå‹é“¾ç»ˆç‚¹</h2>
<p>æ‰€æœ‰åŸå‹é“¾çš„ç»ˆç‚¹éƒ½æ˜¯Â <code>Object.prototype</code>ï¼Œè€ŒÂ <code>Object.prototype</code>Â çš„åŸå‹æ˜¯Â <code>null</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>)); <span class="hljs-comment">// null</span>
</code></pre>
<h2 data-id="heading-17">ç°ä»£æ›¿ä»£æ–¹æ¡ˆ</h2>
<p>ES6 çš„Â <code>class</code>Â è¯­æ³•æ›´æ¸…æ™°ï¼Œä½†åº•å±‚ä»åŸºäºåŸå‹é“¾ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
  }
  
  <span class="hljs-title function_">eat</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> eats`</span>);
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> {
  <span class="hljs-title function_">bark</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span> barks`</span>);
  }
}
</code></pre>
<h2 data-id="heading-18">æ³¨æ„äº‹é¡¹</h2>
<ol>
<li><strong>æ€§èƒ½</strong>ï¼šè¿‡é•¿çš„åŸå‹é“¾ä¼šå½±å“æŸ¥æ‰¾æ€§èƒ½</li>
<li><strong>å¾ªç¯å¼•ç”¨</strong>ï¼šé¿å…å½¢æˆå¾ªç¯åŸå‹é“¾ï¼ˆä¼šå¯¼è‡´é”™è¯¯ï¼‰</li>
<li><strong>ä¿®æ”¹åŸå‹</strong>ï¼šä¿®æ”¹Â <code>Object.prototype</code>Â ä¼šå½±å“æ‰€æœ‰å¯¹è±¡ï¼ˆä¸æ¨èï¼‰</li>
<li><strong><code>__proto__</code></strong> ï¼šè™½ç„¶å¹¿æ³›æ”¯æŒï¼Œä½†æ›´æ¨èä½¿ç”¨Â <code>Object.getPrototypeOf()</code>Â å’ŒÂ <code>Object.setPrototypeOf()</code></li>
</ol>
<hr/>
<p><strong>æ€»ç»“</strong>ï¼šåŸå‹é“¾æ˜¯ JavaScript å®ç°ç»§æ‰¿çš„æœºåˆ¶ï¼Œé€šè¿‡Â <code>__proto__</code>Â é“¾æ¥å¯¹è±¡ï¼Œå½¢æˆé“¾å¼ç»“æ„ã€‚ç†è§£åŸå‹é“¾å¯¹äºæŒæ¡ JavaScript é¢å‘å¯¹è±¡ç¼–ç¨‹è‡³å…³é‡è¦ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Androidæ„å»ºä¼˜åŒ–ï¼šç¼–è¯‘é€Ÿåº¦ä» 10 åˆ†é’Ÿç¼–è¯‘åˆ° 10 ç§’]]></title>    <link>https://juejin.cn/post/7598376873546956843</link>    <guid>https://juejin.cn/post/7598376873546956843</guid>    <pubDate>2026-01-23T12:18:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598376873546956843" data-draft-id="7598353543893565446" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Androidæ„å»ºä¼˜åŒ–ï¼šç¼–è¯‘é€Ÿåº¦ä» 10 åˆ†é’Ÿç¼–è¯‘åˆ° 10 ç§’"/> <meta itemprop="keywords" content="gradle"/> <meta itemprop="datePublished" content="2026-01-23T12:18:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="kekegdsz"/> <meta itemprop="url" content="https://juejin.cn/user/747323635796407"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Androidæ„å»ºä¼˜åŒ–ï¼šç¼–è¯‘é€Ÿåº¦ä» 10 åˆ†é’Ÿç¼–è¯‘åˆ° 10 ç§’
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/747323635796407/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    kekegdsz
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T12:18:27.000Z" title="Fri Jan 23 2026 12:18:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fkekegdsz%2Fandroid-gradle-smart-build" target="_blank" title="https://github.com/kekegdsz/android-gradle-smart-build" ref="nofollow noopener noreferrer">android-gradle-smart-build</a></p>
<h2 data-id="heading-0">Androidæ„å»ºä¼˜åŒ–ï¼šæ™ºèƒ½ä»»åŠ¡è£å‰ªä¸GitçŠ¶æ€æ„ŸçŸ¥</h2>
<blockquote>
<p>å¦‚ä½•è®©Gradleè‡ªåŠ¨æ„ŸçŸ¥ä»£ç å˜æ›´ï¼Œåªç¼–è¯‘çœŸæ­£éœ€è¦ä¿®æ”¹çš„æ¨¡å—ï¼Ÿæœ¬æ–‡å°†æ­ç§˜ä¸€å¥—å®Œæ•´çš„æ™ºèƒ½æ„å»ºä¼˜åŒ–æ–¹æ¡ˆã€‚</p>
</blockquote>
<h3 data-id="heading-1">å‰è¨€ï¼šæ„å»ºæ…¢çš„ç—›ç‚¹</h3>
<p>â€œåˆå¡åœ¨ç¼–è¯‘äº†â€¦â€ ç›¸ä¿¡æ¯ä¸ªAndroidå¼€å‘è€…éƒ½ç»å†è¿‡è¿™æ ·çš„ç„¦è™‘æ—¶åˆ»ã€‚éšç€é¡¹ç›®è§„æ¨¡å¢é•¿ï¼Œæ¯æ¬¡æ”¹åŠ¨å‡ è¡Œä»£ç å´è¦ç­‰å¾…æ¼«é•¿çš„å…¨é‡ç¼–è¯‘ï¼Œå¼€å‘æ•ˆç‡ä¸¥é‡ä¸‹é™ã€‚</p>
<p>ä¼ ç»Ÿçš„å¢é‡ç¼–è¯‘è™½ç„¶æœ‰æ‰€å¸®åŠ©ï¼Œä½†åœ¨å¤šæ¨¡å—é¡¹ç›®ä¸­ä»æœ‰å¾ˆå¤§ä¼˜åŒ–ç©ºé—´ã€‚ä»Šå¤©ï¼Œæˆ‘å°†åˆ†äº«ä¸€å¥—<strong>åŸºäºGitçŠ¶æ€æ„ŸçŸ¥çš„æ™ºèƒ½æ„å»ºä¼˜åŒ–æ–¹æ¡ˆ</strong>ï¼Œè®©Gradleåªç¼–è¯‘çœŸæ­£å˜æ›´çš„æ¨¡å—ã€‚</p>
<h3 data-id="heading-2">ä¸€ã€åŸç†åˆ†æ</h3>
<h4 data-id="heading-3">1.1 ä¼ ç»Ÿæ„å»ºçš„ç“¶é¢ˆ</h4>
<p>ä¼ ç»ŸGradleæ„å»ºæµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f1c126364e94b89aa88d067631dca99~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAga2VrZWdkc3o=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769775507&amp;x-signature=nyGwNeclaSDSoRIUtFItXewHd3o%3D" alt="image.png" loading="lazy"/></p>
<p>å³ä½¿ä½¿ç”¨äº†å¢é‡ç¼–è¯‘ï¼ŒGradleä»ç„¶ä¼šï¼š</p>
<ul>
<li>æ‰§è¡Œlintæ£€æŸ¥</li>
<li>è¿è¡Œå•å…ƒæµ‹è¯•</li>
<li>å¤„ç†æ‰€æœ‰æ¨¡å—çš„èµ„æºç¼–è¯‘</li>
<li>æ‰§è¡Œkapt/kspæ³¨è§£å¤„ç†</li>
</ul>
<h4 data-id="heading-4">1.2 æˆ‘ä»¬çš„ä¼˜åŒ–æ€è·¯</h4>
<p>æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªæ™ºèƒ½æ„å»ºç³»ç»Ÿï¼Œå…¶å·¥ä½œåŸç†å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/68805ea2352d4d6c9ea60a225658e82c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAga2VrZWdkc3o=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769775507&amp;x-signature=%2F6GPTLpG71iqXhJ63XxmvjeXeSw%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-5">äºŒã€æ–¹æ¡ˆè®¾è®¡</h3>
<h4 data-id="heading-6">2.1 æ ¸å¿ƒç›®æ ‡</h4>
<ol>
<li><strong>GitçŠ¶æ€æ„ŸçŸ¥</strong>ï¼šè¯†åˆ«ä»£ç åº“çš„å®è´¨æ€§å˜æ›´</li>
<li><strong>ä»»åŠ¡æ™ºèƒ½è£å‰ª</strong>ï¼šè·³è¿‡ä¸å½“å‰å¼€å‘æ— å…³çš„æ„å»ºä»»åŠ¡</li>
<li><strong>å¤±è´¥å›é€€æœºåˆ¶</strong>ï¼šç¡®ä¿æ„å»ºç³»ç»Ÿçš„å¥å£®æ€§</li>
<li><strong>å…¨å±€ç¼–è¯‘ä¼˜åŒ–</strong>ï¼šæå‡æ‰€æœ‰ä»»åŠ¡çš„æ‰§è¡Œæ•ˆç‡</li>
</ol>
<h4 data-id="heading-7">2.2 æŠ€æœ¯æ¶æ„</h4>
<pre><code class="hljs language-markdown" lang="markdown">å¤åˆ¶
â”œâ”€â”€ GitçŠ¶æ€ç›‘æ§å±‚
â”‚   â”œâ”€â”€ HEADå˜æ›´æ£€æµ‹
â”‚   â””â”€â”€ åˆ†æ”¯å˜æ›´æ£€æµ‹
â”œâ”€â”€ ä»»åŠ¡è£å‰ªå±‚
â”‚   â”œâ”€â”€ éå¿…éœ€ä»»åŠ¡è¿‡æ»¤
â”‚   â””â”€â”€ å˜æ›´æ¨¡å—è¯†åˆ«
â”œâ”€â”€ ç¼–è¯‘ä¼˜åŒ–å±‚
â”‚   â”œâ”€â”€ Kotlinç¼–è¯‘ä¼˜åŒ–
â”‚   â”œâ”€â”€ Javaç¼–è¯‘ä¼˜åŒ–
â”‚   â””â”€â”€ æµ‹è¯•å¹¶è¡ŒåŒ–
â””â”€â”€ å®¹é”™æ§åˆ¶å±‚
<span class="hljs-code">    â”œâ”€â”€ å¤±è´¥æ ‡è®°æœºåˆ¶
    â””â”€â”€ è‡ªåŠ¨å›é€€ç­–ç•¥
</span></code></pre>
<h3 data-id="heading-8">ä¸‰ã€å®ç°è¯¦è§£</h3>
<h4 data-id="heading-9">3.1 GitçŠ¶æ€åˆå§‹åŒ–ï¼ˆä¸€æ¬¡æ€§æ‰§è¡Œï¼‰</h4>
<pre><code class="hljs language-ini" lang="ini">gradle
gradle
å¤åˆ¶
// å…¨å±€çŠ¶æ€æ ‡è®°ï¼Œç¡®ä¿åªåˆå§‹åŒ–ä¸€æ¬¡
<span class="hljs-attr">ext._gitHeadChanged</span> = <span class="hljs-literal">false</span>
<span class="hljs-attr">ext._gitBranchChanged</span> = <span class="hljs-literal">false</span>
<span class="hljs-attr">ext._gitStateInited</span> = <span class="hljs-literal">false</span>
<span class="hljs-attr">ext._taskGraphInstalled</span> = <span class="hljs-literal">false</span>

def <span class="hljs-attr">initGitStateOnce</span> = {
    if (rootProject.ext._gitStateInited) return
    <span class="hljs-attr">rootProject.ext._gitStateInited</span> = <span class="hljs-literal">true</span>
    
    // è·å–å½“å‰Git HEAD
    def <span class="hljs-attr">currentHead</span> = executeGitCommand(<span class="hljs-string">"git rev-parse HEAD"</span>)
    def <span class="hljs-attr">lastHead</span> = readLastState(<span class="hljs-string">"last_git_head.txt"</span>)
    
    // è®°å½•å¹¶æ¯”è¾ƒå˜åŒ–
    <span class="hljs-attr">rootProject.ext._gitHeadChanged</span> = 
        lastHead &amp;&amp; lastHead != currentHead
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨<code>ext</code>å…¨å±€å˜é‡ä¿è¯å•ä¾‹</li>
<li>å¼‚å¸¸æ—¶é»˜è®¤è®¤ä¸ºæœ‰å˜æ›´ï¼ˆå®‰å…¨ç­–ç•¥ï¼‰</li>
<li>çŠ¶æ€æŒä¹…åŒ–åˆ°buildç›®å½•</li>
</ul>
<h4 data-id="heading-10">3.2 é€šç”¨ç¼–è¯‘ä¼˜åŒ–ï¼ˆå…¨å·¥ç¨‹ç”Ÿæ•ˆï¼‰</h4>
<pre><code class="hljs language-ini" lang="ini">gradle
gradle
å¤åˆ¶
allprojects { Project p -&gt;
    afterEvaluate {
        // Kotlinç¼–è¯‘ä¼˜åŒ–
        tasks.withType(KotlinCompile).configureEach { task -&gt;
            task.kotlinOptions {
                <span class="hljs-attr">jvmTarget</span> = <span class="hljs-string">"1.8"</span>
                freeCompilerArgs += <span class="hljs-section">["-Xjsr305=strict"]</span>
                <span class="hljs-attr">suppressWarnings</span> = <span class="hljs-literal">true</span>  // æŠ‘åˆ¶è­¦å‘Šæå‡é€Ÿåº¦
            }
            <span class="hljs-attr">task.incremental</span> = <span class="hljs-literal">true</span>  // å¼€å¯å¢é‡ç¼–è¯‘
        }
        
        // Javaç¼–è¯‘ä¼˜åŒ–
        tasks.withType(JavaCompile).configureEach {
            <span class="hljs-attr">options.incremental</span> = <span class="hljs-literal">true</span>
            <span class="hljs-attr">options.fork</span> = <span class="hljs-literal">true</span>
            <span class="hljs-attr">options.forkOptions.memoryMaximumSize</span> = <span class="hljs-string">"1g"</span>
        }
        
        // æµ‹è¯•å¹¶è¡ŒåŒ–
        tasks.withType(Test).configureEach {
            <span class="hljs-attr">maxParallelForks</span> = Runtime.runtime.availableProcessors().intdiv(<span class="hljs-number">2</span>) ?: <span class="hljs-number">1</span>
            <span class="hljs-attr">forkEvery</span> = <span class="hljs-number">100</span>
        }
        
        // Androidèµ„æºä¼˜åŒ–
        android {
            aaptOptions {
                <span class="hljs-attr">cruncherEnabled</span> = <span class="hljs-literal">false</span>  // ç¦ç”¨PNGå‹ç¼©
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-11">3.3 æ™ºèƒ½ä»»åŠ¡è£å‰ªæœºåˆ¶</h4>
<h5 data-id="heading-12">3.3.1 æ„å»ºç­–ç•¥åˆ¤æ–­</h5>
<pre><code class="hljs language-python" lang="python">gradle
gradle
å¤åˆ¶
gradle.taskGraph.whenReady { graph -&gt;
    initGitStateOnce()
    
    // åªå¤„ç†assembleç›¸å…³ä»»åŠ¡
    <span class="hljs-keyword">if</span> (!graph.allTasks.<span class="hljs-built_in">any</span> { it.name.startsWith(<span class="hljs-string">"assemble"</span>) }) <span class="hljs-keyword">return</span>
    
    val allowTaskTrim = !lastTrimFailed &amp;&amp;
                        !ext._gitHeadChanged &amp;&amp;
                        !ext._gitBranchChanged
    
    println <span class="hljs-string">"""
    ğŸ§  æ„å»ºç­–ç•¥åˆ¤æ–­ï¼š
      Git HEAD å˜åŒ–: ${ext._gitHeadChanged}
      Git åˆ†æ”¯å˜åŒ–: ${ext._gitBranchChanged}
      ä¸Šä¸€æ¬¡è£å‰ªå¤±è´¥: ${lastTrimFailed}
      æ˜¯å¦å…è®¸è£å‰ª: ${allowTaskTrim}
    """</span>
}
</code></pre>
<h5 data-id="heading-13">3.3.2 ä»»åŠ¡è·³è¿‡ç­–ç•¥</h5>
<pre><code class="hljs language-rust" lang="rust">gradle
gradle
å¤åˆ¶
<span class="hljs-comment">// å®šä¹‰å¯è·³è¿‡çš„ä»»åŠ¡ç±»å‹</span>
def skipTasks = [
    <span class="hljs-string">"lint"</span>,           <span class="hljs-comment">// ä»£ç æ£€æŸ¥</span>
    <span class="hljs-string">"test"</span>,          <span class="hljs-comment">// å•å…ƒæµ‹è¯•</span>
    <span class="hljs-string">"connectedAndroidTest"</span>,  <span class="hljs-comment">// ä»ªå™¨æµ‹è¯•</span>
    <span class="hljs-string">"kaptTestKotlin"</span>,       <span class="hljs-comment">// æµ‹è¯•æ³¨è§£å¤„ç†</span>
    <span class="hljs-string">"testDebugUnitTest"</span>     <span class="hljs-comment">// Debugå•å…ƒæµ‹è¯•</span>
]

graph.allTasks.each { task <span class="hljs-punctuation">-&gt;</span>
    skipTasks.each { skip <span class="hljs-punctuation">-&gt;</span>
        <span class="hljs-title function_ invoke__">if</span> (task.name.<span class="hljs-title function_ invoke__">contains</span>(skip)) {
            task.enabled = <span class="hljs-literal">false</span>
            println <span class="hljs-string">"â­ï¸ è·³è¿‡ä»»åŠ¡: ${task.path}"</span>
        }
    }
}
</code></pre>
<h5 data-id="heading-14">3.3.3 Gitå˜æ›´æ¨¡å—è¯†åˆ«</h5>
<pre><code class="hljs language-dart" lang="dart">gradle
gradle
å¤åˆ¶
def changedModules = [] <span class="hljs-keyword">as</span> <span class="hljs-built_in">Set</span>&lt;<span class="hljs-built_in">String</span>&gt;

<span class="hljs-comment">// åˆ†æGitå˜æ›´ï¼Œè¯†åˆ«å½±å“çš„æ¨¡å—</span>
def processChangedFiles = { <span class="hljs-built_in">String</span> filePath -&gt;
    <span class="hljs-keyword">if</span> (!filePath.contains(<span class="hljs-string">"/"</span>)) <span class="hljs-keyword">return</span>
    def parts = filePath.split(<span class="hljs-string">"/"</span>)
    def moduleParts = []
    
    <span class="hljs-comment">// è§£ææ¨¡å—è·¯å¾„ï¼ˆç›´åˆ°srcç›®å½•ä¸ºæ­¢ï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">part</span> <span class="hljs-keyword">in</span> parts) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">part</span> == <span class="hljs-string">"src"</span>) <span class="hljs-keyword">break</span>
        moduleParts &lt;&lt; <span class="hljs-keyword">part</span>
    }
    
    <span class="hljs-keyword">if</span> (!moduleParts.isEmpty()) {
        changedModules &lt;&lt; <span class="hljs-string">":"</span> + moduleParts.join(<span class="hljs-string">":"</span>)
    }
}

<span class="hljs-comment">// æ£€æŸ¥ä¸‰ç§GitçŠ¶æ€</span>
[
    <span class="hljs-string">"git diff --name-only HEAD~1..HEAD"</span>,  <span class="hljs-comment">// æœ€åä¸€æ¬¡æäº¤</span>
    <span class="hljs-string">"git diff --name-only"</span>,               <span class="hljs-comment">// å·¥ä½œåŒºå˜æ›´</span>
    <span class="hljs-string">"git diff --name-only --cached"</span>       <span class="hljs-comment">// æš‚å­˜åŒºå˜æ›´</span>
].each { cmd -&gt;
    <span class="hljs-keyword">try</span> {
        def output = executeGitCommand(cmd)
        output.readLines().each(processChangedFiles)
    } <span class="hljs-keyword">catch</span> (ignored) {
        <span class="hljs-comment">// é™é»˜å¤„ç†å¼‚å¸¸</span>
    }
}
</code></pre>
<h5 data-id="heading-15">3.3.4 ç¼–è¯‘ä»»åŠ¡ç²¾å‡†è£å‰ª</h5>
<pre><code class="hljs language-lua" lang="lua">gradle
gradle
å¤åˆ¶
graph.allTasks.each { task -&gt;
    // åªå¤„ç†ç¼–è¯‘ç›¸å…³ä»»åŠ¡
    <span class="hljs-keyword">if</span> (!task.<span class="hljs-built_in">path</span>.contains(<span class="hljs-string">":compileDebug"</span>) &amp;&amp;
        !task.<span class="hljs-built_in">path</span>.contains(<span class="hljs-string">":kaptDebug"</span>) &amp;&amp;
        !task.<span class="hljs-built_in">path</span>.contains(<span class="hljs-string">":kspDebug"</span>)) <span class="hljs-keyword">return</span>
    
    // æå–æ¨¡å—è·¯å¾„
    def modulePath = task.<span class="hljs-built_in">path</span>.substring(<span class="hljs-number">0</span>, task.<span class="hljs-built_in">path</span>.lastIndexOf(<span class="hljs-string">":"</span>))
    def isChanged = changedModules.any { modulePath.startsWith(it) }
    
    <span class="hljs-keyword">if</span> (!isChanged) {
        task.enabled = <span class="hljs-literal">false</span>
    } <span class="hljs-keyword">else</span> {
        println <span class="hljs-string">"âœ… ä¿ç•™ç¼–è¯‘: ${task.path}"</span>
    }
}
</code></pre>
<h4 data-id="heading-16">3.4 å®¹é”™ä¸å›é€€æœºåˆ¶</h4>
<pre><code class="hljs language-python" lang="python">gradle
gradle
å¤åˆ¶
// æ„å»ºå‰ï¼šè®¾ç½®å¤±è´¥æ ‡è®°ï¼ˆé»˜è®¤æœ¬æ¬¡ä¼šå¤±è´¥ï¼‰
gradle.taskGraph.whenReady { graph -&gt;
    trimFailFlagFile.text = <span class="hljs-string">"failed"</span>
}

// æ„å»ºåï¼šæ ¹æ®ç»“æœå¤„ç†æ ‡è®°
gradle.buildFinished { result -&gt;
    <span class="hljs-keyword">if</span> (result.failure == null) {
        <span class="hljs-keyword">if</span> (trimFailFlagFile.exists()) {
            trimFailFlagFile.delete()
            println <span class="hljs-string">"\nâœ… æ„å»ºæˆåŠŸï¼Œæ¸…é™¤è£å‰ªå¤±è´¥æ ‡è®°"</span>
        }
    } <span class="hljs-keyword">else</span> {
        println <span class="hljs-string">"""
        âŒ æ„å»ºå¤±è´¥ï¼Œå¯èƒ½åŸå› ï¼š
          1. è·¨æ¨¡å—APIå˜æ›´æœªåŒæ­¥ç¼–è¯‘
          2. èµ„æºæ–‡ä»¶ä¾èµ–å˜æ›´
          3. æ³¨è§£å¤„ç†å™¨ç”Ÿæˆä»£ç å˜æ›´
        ä¸‹æ¬¡æ„å»ºå°†è‡ªåŠ¨å›é€€åˆ°å…¨é‡ç¼–è¯‘
        """</span>
    }
}
</code></pre>
<h3 data-id="heading-17">å››ã€ä½¿ç”¨æ–¹å¼</h3>
<h4 data-id="heading-18">4.1 å¼•å…¥è„šæœ¬</h4>
<p>åœ¨æ ¹é¡¹ç›®çš„<code>build.gradle</code>ä¸­æ·»åŠ ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">gradle
gradle
å¤åˆ¶
apply <span class="hljs-keyword">from</span>: <span class="hljs-string">'build-optimization.gradle'</span>
</code></pre>
<p>æˆ–åœ¨<code>settings.gradle</code>ä¸­ï¼š</p>
<pre><code class="hljs language-css" lang="css">gradle
gradle
å¤åˆ¶
apply <span class="hljs-selector-tag">from</span>: <span class="hljs-built_in">file</span>(<span class="hljs-string">'build-optimization.gradle'</span>)
</code></pre>
<h4 data-id="heading-19">4.2 é…ç½®é€‰é¡¹</h4>
<p>å¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚è°ƒæ•´ä»¥ä¸‹å‚æ•°ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">gradle
gradle
å¤åˆ¶
// åœ¨è„šæœ¬å¼€å¤´æ·»åŠ é…ç½®å—
<span class="hljs-attr">ext.buildOptimization</span> = {
    // æ˜¯å¦å¯ç”¨æ™ºèƒ½è£å‰ª
    <span class="hljs-attr">enableSmartTrim</span> = <span class="hljs-literal">true</span>
    
    // è·³è¿‡çš„ä»»åŠ¡åˆ—è¡¨
    <span class="hljs-attr">skipTasks</span> = [<span class="hljs-string">"lint"</span>, <span class="hljs-string">"test"</span>, <span class="hljs-string">"..."</span>]
    
    // å¹¶è¡Œæµ‹è¯•çš„æœ€å¤§è¿›ç¨‹æ•°
    <span class="hljs-attr">maxTestForks</span> = Runtime.runtime.availableProcessors().intdiv(<span class="hljs-number">2</span>)
    
    // Kotlinç¼–è¯‘å‚æ•°
    <span class="hljs-attr">kotlinOptions</span> = {
        <span class="hljs-attr">jvmTarget</span> = <span class="hljs-string">"1.8"</span>
        <span class="hljs-attr">freeCompilerArgs</span> = [<span class="hljs-string">"-Xjsr305=strict"</span>]
    }
}
</code></pre>
<h4 data-id="heading-20">4.3 æŸ¥çœ‹æ„å»ºæŠ¥å‘Š</h4>
<p>æ¯æ¬¡æ„å»ºä¼šè¾“å‡ºè¯¦ç»†çš„å†³ç­–æ—¥å¿—ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby">å¤åˆ¶
ğŸ§  æ„å»ºç­–ç•¥åˆ¤æ–­ï¼š
  <span class="hljs-title class_">Git</span> <span class="hljs-variable constant_">HEAD</span> å˜åŒ–: <span class="hljs-literal">false</span>
  <span class="hljs-title class_">Git</span> åˆ†æ”¯å˜åŒ–: <span class="hljs-literal">false</span>
  ä¸Šä¸€æ¬¡è£å‰ªå¤±è´¥: <span class="hljs-literal">false</span>
  æ˜¯å¦å…è®¸è£å‰ª: <span class="hljs-literal">true</span>

ğŸ“Œ <span class="hljs-title class_">Git</span> å˜æ›´æ¨¡å—ï¼š
  <span class="hljs-symbol">:app</span>
  <span class="hljs-symbol">:lib</span><span class="hljs-symbol">:network</span>

â­ï¸ è·³è¿‡ä»»åŠ¡: <span class="hljs-symbol">:app</span><span class="hljs-symbol">:lintDebug</span>
â­ï¸ è·³è¿‡ä»»åŠ¡: <span class="hljs-symbol">:app</span><span class="hljs-symbol">:testDebugUnitTest</span>
âœ… ä¿ç•™ç¼–è¯‘: <span class="hljs-symbol">:app</span><span class="hljs-symbol">:compileDebugKotlin</span>
âœ… ä¿ç•™ç¼–è¯‘: <span class="hljs-symbol">:lib</span><span class="hljs-symbol">:network</span><span class="hljs-symbol">:compileDebugKotlin</span>
â­ï¸ è·³è¿‡ä»»åŠ¡: <span class="hljs-symbol">:lib</span><span class="hljs-symbol">:database</span><span class="hljs-symbol">:compileDebugKotlin</span>
</code></pre>
<h3 data-id="heading-21">äº”ã€æ€§èƒ½å¯¹æ¯”</h3>
<p>åœ¨æµ‹è¯•é¡¹ç›®ï¼ˆ10ä¸ªæ¨¡å—ï¼Œ20ä¸‡è¡Œä»£ç ï¼‰ä¸­çš„è¡¨ç°ï¼š</p>



































<table><thead><tr><th>åœºæ™¯</th><th>ä¼ ç»Ÿæ„å»º</th><th>ä¼˜åŒ–åæ„å»º</th><th>æå‡å¹…åº¦</th></tr></thead><tbody><tr><td>å•æ¨¡å—å°æ”¹åŠ¨</td><td>45s</td><td>12s</td><td>73%</td></tr><tr><td>è·¨æ¨¡å—APIå˜æ›´</td><td>52s</td><td>52s</td><td>0%</td></tr><tr><td>Cleanåæ„å»º</td><td>68s</td><td>68s</td><td>0%</td></tr><tr><td>æ—¥å¸¸å¼€å‘æ„å»º</td><td>38s</td><td>15s</td><td>60%</td></tr></tbody></table>
<p><em>æµ‹è¯•ç¯å¢ƒï¼šMacBook Pro M1, 16GB RAM, Gradle 7.4</em></p>
<p>é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fkekegdsz%2Fandroid-gradle-smart-build" target="_blank" title="https://github.com/kekegdsz/android-gradle-smart-build" ref="nofollow noopener noreferrer">android-gradle-smart-build</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Kotlinç³»åˆ—13ã€‘DSLè®¾è®¡ï¼šæ„å»ºç±»å‹å®‰å…¨çš„é¢†åŸŸè¯­è¨€]]></title>    <link>https://juejin.cn/post/7598374376094302235</link>    <guid>https://juejin.cn/post/7598374376094302235</guid>    <pubDate>2026-01-23T14:34:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598374376094302235" data-draft-id="7598389448146272266" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Kotlinç³»åˆ—13ã€‘DSLè®¾è®¡ï¼šæ„å»ºç±»å‹å®‰å…¨çš„é¢†åŸŸè¯­è¨€"/> <meta itemprop="keywords" content="Kotlin,Android,ç¼–ç¨‹è¯­è¨€"/> <meta itemprop="datePublished" content="2026-01-23T14:34:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†¬å¥‡Lab"/> <meta itemprop="url" content="https://juejin.cn/user/1857501105781193"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Kotlinç³»åˆ—13ã€‘DSLè®¾è®¡ï¼šæ„å»ºç±»å‹å®‰å…¨çš„é¢†åŸŸè¯­è¨€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1857501105781193/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†¬å¥‡Lab
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T14:34:05.000Z" title="Fri Jan 23 2026 14:34:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€ï¼šDSLè®©ä»£ç åƒè¯´è¯ä¸€æ ·è‡ªç„¶</h2>
<p>è¿˜è®°å¾—ç¬¬ä¸€æ¬¡çœ‹åˆ°Gradleçš„æ„å»ºè„šæœ¬æ—¶çš„æ„Ÿè§‰å—ï¼Ÿ</p>
<pre><code class="hljs language-kotlin" lang="kotlin">dependencies {
    implementation(<span class="hljs-string">"org.jetbrains.kotlin:kotlin-stdlib:1.9.0"</span>)
    testImplementation(<span class="hljs-string">"junit:junit:4.13.2"</span>)
}
</code></pre>
<p>è¿™ä¸åƒæ˜¯åœ¨å†™ä»£ç ï¼Œæ›´åƒæ˜¯åœ¨<strong>ç”¨è‹±è¯­æè¿°ä¾èµ–å…³ç³»</strong>ã€‚è¿™å°±æ˜¯DSLï¼ˆDomain-Specific Languageï¼Œé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰çš„é­…åŠ›â€”â€”è®©ä»£ç è¡¨è¾¾æ›´æ¥è¿‘é—®é¢˜åŸŸï¼Œè€Œä¸æ˜¯çº ç¼ äºæŠ€æœ¯ç»†èŠ‚ã€‚</p>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯DSLï¼Ÿ</h3>
<p>DSLæ˜¯ä¸ºè§£å†³ç‰¹å®šé¢†åŸŸé—®é¢˜è€Œè®¾è®¡çš„ä¸“ç”¨è¯­è¨€ã€‚ä¸é€šç”¨ç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚Javaã€Pythonï¼‰ä¸åŒï¼ŒDSLä¸“æ³¨äºæŸä¸ªç‰¹å®šé¢†åŸŸï¼Œæä¾›æ›´ç®€æ´ã€æ›´æ˜“è¯»çš„è¡¨è¾¾æ–¹å¼ã€‚</p>
<p><strong>åˆ†ç±»</strong>ï¼š</p>
<ul>
<li><strong>å¤–éƒ¨DSL</strong>ï¼šç‹¬ç«‹çš„è¯­è¨€ï¼Œéœ€è¦ä¸“é—¨çš„è§£æå™¨ï¼ˆå¦‚SQLã€æ­£åˆ™è¡¨è¾¾å¼ï¼‰</li>
<li><strong>å†…éƒ¨DSL</strong>ï¼šåµŒå…¥åœ¨å®¿ä¸»è¯­è¨€ä¸­ï¼Œåˆ©ç”¨å®¿ä¸»è¯­è¨€çš„è¯­æ³•ç‰¹æ€§ï¼ˆå¦‚Kotlin DSLï¼‰</li>
</ul>
<p>Kotlinå‡­å€Ÿå…¶å¼ºå¤§çš„è¯­è¨€ç‰¹æ€§ï¼ˆæ‰©å±•å‡½æ•°ã€Lambdaæ¥æ”¶è€…ã€ä¸­ç¼€å‡½æ•°ã€æ“ä½œç¬¦é‡è½½ç­‰ï¼‰ï¼Œæˆä¸ºæ„å»ºå†…éƒ¨DSLçš„ç†æƒ³é€‰æ‹©ã€‚</p>
<h3 data-id="heading-2">ä¸ºä»€ä¹ˆéœ€è¦DSLï¼Ÿ</h3>






























<table><thead><tr><th align="left">ä¼˜åŠ¿</th><th align="left">è¯´æ˜</th><th align="left">ç¤ºä¾‹</th></tr></thead><tbody><tr><td align="left">è¡¨è¾¾åŠ›å¼º</td><td align="left">ä»£ç æ›´è´´è¿‘ä¸šåŠ¡é€»è¾‘</td><td align="left"><code>route("/users") { get { ... } }</code></td></tr><tr><td align="left">æ˜“è¯»æ˜“å†™</td><td align="left">æ¥è¿‘è‡ªç„¶è¯­è¨€çš„è¡¨è¾¾</td><td align="left"><code>assert(user.age isGreaterThan 18)</code></td></tr><tr><td align="left">ç±»å‹å®‰å…¨</td><td align="left">ç¼–è¯‘æœŸæ£€æŸ¥é”™è¯¯</td><td align="left">IDEè‡ªåŠ¨è¡¥å…¨ã€ç±»å‹æ¨æ–­</td></tr><tr><td align="left">é¢†åŸŸèšç„¦</td><td align="left">å±è”½æŠ€æœ¯ç»†èŠ‚</td><td align="left">SQL Builder vs æ‰‹å†™SQLå­—ç¬¦ä¸²</td></tr></tbody></table>
<blockquote>
<p><strong>ğŸ’¡ æç¤º</strong></p>
<p>Kotlinæ ‡å‡†åº“ä¸­å°±æœ‰å¾ˆå¤šDSLæ¡ˆä¾‹ï¼š<code>buildString { }</code>ã€<code>sequence { }</code>ã€<code>with(obj) { }</code>ç­‰ï¼Œå­¦ä¹ DSLè®¾è®¡èƒ½è®©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨è¿™äº›APIã€‚</p>
</blockquote>
<p>æœ¬æ–‡å°†å¸¦ä½ ä»é›¶å¼€å§‹æ„å»ºç±»å‹å®‰å…¨çš„Kotlin DSLï¼Œæ¶µç›–ï¼š</p>
<ol>
<li>DSLæ ¸å¿ƒæ¦‚å¿µä¸å®ç°åŸç†</li>
<li>Lambdaæ¥æ”¶è€…ä¸ä½œç”¨åŸŸæ§åˆ¶</li>
<li>ç±»å‹å®‰å…¨Builderæ¨¡å¼</li>
<li>å®æˆ˜æ¡ˆä¾‹ï¼šHTML DSLã€SQL DSLã€é…ç½®DSL</li>
<li>DSLè®¾è®¡æœ€ä½³å®è·µ</li>
<li>æ€§èƒ½ä¼˜åŒ–ä¸é™·é˜±è§„é¿</li>
</ol>
<hr/>
<h2 data-id="heading-3">DSLå®ç°åŸºç¡€</h2>
<h3 data-id="heading-4">Lambdaæ¥æ”¶è€…ï¼ˆLambda with Receiverï¼‰</h3>
<p>Lambdaæ¥æ”¶è€…æ˜¯Kotlin DSLçš„æ ¸å¿ƒç‰¹æ€§ï¼Œå®ƒå…è®¸åœ¨Lambdaå†…éƒ¨ç›´æ¥è®¿é—®æ¥æ”¶è€…å¯¹è±¡çš„æˆå‘˜ã€‚</p>
<h4 data-id="heading-5">å‡½æ•°ç±»å‹å¯¹æ¯”</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æ™®é€šå‡½æ•°ç±»å‹ï¼š() -&gt; Unit</span>
<span class="hljs-keyword">val</span> normalLambda: () -&gt; <span class="hljs-built_in">Unit</span> = {
    println(<span class="hljs-string">"Normal lambda"</span>)
}

<span class="hljs-comment">// æ‰©å±•å‡½æ•°ç±»å‹ï¼šStringBuilder.() -&gt; Unit</span>
<span class="hljs-keyword">val</span> receiverLambda: StringBuilder.() -&gt; <span class="hljs-built_in">Unit</span> = {
    <span class="hljs-comment">// åœ¨è¿™é‡Œï¼ŒthisæŒ‡å‘StringBuilderå®ä¾‹</span>
    append(<span class="hljs-string">"Hello "</span>)
    append(<span class="hljs-string">"World"</span>)  <span class="hljs-comment">// å¯ä»¥ç›´æ¥è°ƒç”¨StringBuilderçš„æ–¹æ³•</span>
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">val</span> sb = StringBuilder()
sb.receiverLambda()  <span class="hljs-comment">// å°†sbä½œä¸ºæ¥æ”¶è€…</span>
println(sb.toString())  <span class="hljs-comment">// è¾“å‡º: Hello World</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e49b5f586f374b3b9eb3de87977a502d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769783644&amp;x-signature=j%2FvGZa3odUGh3I1FfHicBPYfJsE%3D" alt="13-01-lambda-receiver.png" loading="lazy"/></p>
<h4 data-id="heading-6">å®æˆ˜ç¤ºä¾‹ï¼šæ„å»ºHTML</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å®šä¹‰HTMLæ ‡ç­¾ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">HTML</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> content = StringBuilder()

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">head</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Head</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> {
        <span class="hljs-keyword">val</span> head = Head()
        head.<span class="hljs-keyword">init</span>()  <span class="hljs-comment">// ä»¥headä¸ºæ¥æ”¶è€…è°ƒç”¨init</span>
        content.append(<span class="hljs-string">"&lt;head&gt;<span class="hljs-subst">${head.render()}</span>&lt;/head&gt;"</span>)
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">body</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Body</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> {
        <span class="hljs-keyword">val</span> body = Body()
        body.<span class="hljs-keyword">init</span>()
        content.append(<span class="hljs-string">"&lt;body&gt;<span class="hljs-subst">${body.render()}</span>&lt;/body&gt;"</span>)
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">render</span><span class="hljs-params">()</span></span> = <span class="hljs-string">"&lt;html&gt;<span class="hljs-variable">$content</span>&lt;/html&gt;"</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Head</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> content = StringBuilder()

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">title</span><span class="hljs-params">(text: <span class="hljs-type">String</span>)</span></span> {
        content.append(<span class="hljs-string">"&lt;title&gt;<span class="hljs-variable">$text</span>&lt;/title&gt;"</span>)
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">render</span><span class="hljs-params">()</span></span> = content.toString()
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Body</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> content = StringBuilder()

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">h1</span><span class="hljs-params">(text: <span class="hljs-type">String</span>)</span></span> {
        content.append(<span class="hljs-string">"&lt;h1&gt;<span class="hljs-variable">$text</span>&lt;/h1&gt;"</span>)
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">p</span><span class="hljs-params">(text: <span class="hljs-type">String</span>)</span></span> {
        content.append(<span class="hljs-string">"&lt;p&gt;<span class="hljs-variable">$text</span>&lt;/p&gt;"</span>)
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">render</span><span class="hljs-params">()</span></span> = content.toString()
}

<span class="hljs-comment">// DSLä½¿ç”¨</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">html</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">HTML</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span>: HTML {
    <span class="hljs-keyword">val</span> html = HTML()
    html.<span class="hljs-keyword">init</span>()
    <span class="hljs-keyword">return</span> html
}

<span class="hljs-comment">// ä¼˜é›…çš„HTMLæ„å»º</span>
<span class="hljs-keyword">val</span> page = html {
    head {
        title(<span class="hljs-string">"My Page"</span>)
    }
    body {
        h1(<span class="hljs-string">"Welcome"</span>)
        p(<span class="hljs-string">"This is a paragraph"</span>)
    }
}

println(page.render())
<span class="hljs-comment">// è¾“å‡º: &lt;html&gt;&lt;head&gt;&lt;title&gt;My Page&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Welcome&lt;/h1&gt;&lt;p&gt;This is a paragraph&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;</span>
</code></pre>
<blockquote>
<p><strong>ğŸ’¡ å·¥ä½œåŸç†</strong></p>
<p>å½“ä½ å†™ <code>html { head { ... } }</code> æ—¶ï¼š</p>
<ol>
<li><code>html</code> å‡½æ•°æ¥æ”¶ä¸€ä¸ª <code>HTML.() -&gt; Unit</code> ç±»å‹çš„Lambda</li>
<li>åœ¨Lambdaå†…éƒ¨ï¼Œ<code>this</code> æŒ‡å‘ <code>HTML</code> å®ä¾‹</li>
<li>å› æ­¤å¯ä»¥ç›´æ¥è°ƒç”¨ <code>head</code>ã€<code>body</code> æ–¹æ³•</li>
<li>åµŒå¥—çš„ <code>head { }</code> åŒæ ·ä½¿ç”¨Lambdaæ¥æ”¶è€…æœºåˆ¶</li>
</ol>
</blockquote>
<h3 data-id="heading-7">ä½œç”¨åŸŸæ§åˆ¶ï¼š@DslMarker</h3>
<p>åœ¨å¤æ‚çš„åµŒå¥—DSLä¸­ï¼Œå¯èƒ½ä¼šå‡ºç°ä½œç”¨åŸŸæ··æ·†é—®é¢˜ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">html {
    body {
        <span class="hljs-comment">// è¿™é‡Œèƒ½è®¿é—®htmlçš„æ–¹æ³•å—ï¼Ÿ</span>
        head {  <span class="hljs-comment">// âŒ é€»è¾‘é”™è¯¯ï¼headåº”è¯¥åœ¨htmlå±‚çº§ï¼Œä¸åº”è¯¥åœ¨bodyå†…</span>
            title(<span class="hljs-string">"Wrong Place"</span>)
        }
    }
}
</code></pre>
<p>Kotlinæä¾›äº† <code>@DslMarker</code> æ³¨è§£æ¥é™åˆ¶ä½œç”¨åŸŸï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@DslMarker</span>
<span class="hljs-keyword">annotation</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HtmlDsl</span>

<span class="hljs-meta">@HtmlDsl</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">HTML</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">head</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Head</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> { <span class="hljs-comment">/*...*/</span> }
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">body</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Body</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> { <span class="hljs-comment">/*...*/</span> }
}

<span class="hljs-meta">@HtmlDsl</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Head</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">title</span><span class="hljs-params">(text: <span class="hljs-type">String</span>)</span></span> { <span class="hljs-comment">/*...*/</span> }
}

<span class="hljs-meta">@HtmlDsl</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Body</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">h1</span><span class="hljs-params">(text: <span class="hljs-type">String</span>)</span></span> { <span class="hljs-comment">/*...*/</span> }
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">p</span><span class="hljs-params">(text: <span class="hljs-type">String</span>)</span></span> { <span class="hljs-comment">/*...*/</span> }
}
</code></pre>
<p>ç°åœ¨ï¼Œå¦‚æœåœ¨ <code>body</code> å†…è°ƒç”¨ <code>head</code>ï¼ŒIDEä¼šæŠ¥é”™ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">html {
    body {
        head { }  <span class="hljs-comment">// âŒ ç¼–è¯‘é”™è¯¯ï¼šå¤–å±‚ä½œç”¨åŸŸçš„æˆå‘˜ä¸å¯è®¿é—®</span>
        h1(<span class="hljs-string">"Title"</span>)  <span class="hljs-comment">// âœ… æ­£ç¡®</span>
    }
}
</code></pre>
<blockquote>
<p><strong>âš ï¸ æ³¨æ„</strong></p>
<p><code>@DslMarker</code> é™åˆ¶çš„æ˜¯<strong>å¤–å±‚</strong>æ¥æ”¶è€…çš„éšå¼è®¿é—®ï¼Œå¦‚æœéœ€è¦è®¿é—®å¤–å±‚æ¥æ”¶è€…ï¼Œå¿…é¡»æ˜¾å¼ä½¿ç”¨ <code>this@HTML</code>ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-8">ç±»å‹å®‰å…¨Builderæ¨¡å¼</h2>
<h3 data-id="heading-9">Builderæ¨¡å¼å›é¡¾</h3>
<p>ä¼ ç»Ÿçš„Java Builderæ¨¡å¼ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>.Builder()
    .name(<span class="hljs-string">"Alice"</span>)
    .age(<span class="hljs-number">30</span>)
    .email(<span class="hljs-string">"alice@example.com"</span>)
    .build();
</code></pre>
<p>Kotlin DSLå¯ä»¥è®©Builderæ›´ä¼˜é›…ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> user = user {
    name = <span class="hljs-string">"Alice"</span>
    age = <span class="hljs-number">30</span>
    email = <span class="hljs-string">"alice@example.com"</span>
}
</code></pre>
<h3 data-id="heading-10">å®ç°ç±»å‹å®‰å…¨Builder</h3>
<h4 data-id="heading-11">åŸºç¡€ç‰ˆæœ¬</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">constructor</span>(
    <span class="hljs-keyword">val</span> name: String,
    <span class="hljs-keyword">val</span> age: <span class="hljs-built_in">Int</span>,
    <span class="hljs-keyword">val</span> email: String?
) {
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Builder</span> {
        <span class="hljs-keyword">var</span> name: String = <span class="hljs-string">""</span>
        <span class="hljs-keyword">var</span> age: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>
        <span class="hljs-keyword">var</span> email: String? = <span class="hljs-literal">null</span>

        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">build</span><span class="hljs-params">()</span></span>: User {
            require(name.isNotBlank()) { <span class="hljs-string">"Name is required"</span> }
            require(age &gt; <span class="hljs-number">0</span>) { <span class="hljs-string">"Age must be positive"</span> }
            <span class="hljs-keyword">return</span> User(name, age, email)
        }
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">user</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">User</span>.<span class="hljs-type">Builder</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span>: User {
    <span class="hljs-keyword">val</span> builder = User.Builder()
    builder.<span class="hljs-keyword">init</span>()
    <span class="hljs-keyword">return</span> builder.build()
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">val</span> user = user {
    name = <span class="hljs-string">"Alice"</span>
    age = <span class="hljs-number">30</span>
    email = <span class="hljs-string">"alice@example.com"</span>
}
</code></pre>
<h4 data-id="heading-12">ç±»å‹å®‰å…¨å¢å¼ºï¼šå¿…å¡«å­—æ®µç¼–è¯‘æœŸæ£€æŸ¥</h4>
<p>ä¸Šé¢çš„å®ç°æœ‰ä¸ªé—®é¢˜ï¼šå¿˜è®°è®¾ç½® <code>name</code> æˆ– <code>age</code> åªèƒ½åœ¨è¿è¡Œæ—¶æŠ¥é”™ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ç±»å‹ç³»ç»Ÿåœ¨ç¼–è¯‘æœŸå¼ºåˆ¶æ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä½¿ç”¨å¯†å°ç±»è¡¨ç¤ºæ„å»ºçŠ¶æ€</span>
<span class="hljs-keyword">sealed</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BuilderState</span>

<span class="hljs-keyword">object</span> Initial : BuilderState()
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NameSet</span>(<span class="hljs-keyword">val</span> name: String) : BuilderState()
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AgeSet</span>(<span class="hljs-keyword">val</span> name: String, <span class="hljs-keyword">val</span> age: <span class="hljs-built_in">Int</span>) : BuilderState()

<span class="hljs-keyword">class</span> <span class="hljs-title class_">TypedUserBuilder</span>&lt;<span class="hljs-type">S : BuilderState</span>&gt;(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> state: S
) {
    <span class="hljs-keyword">var</span> email: String? = <span class="hljs-literal">null</span>

    <span class="hljs-comment">// åªæœ‰åœ¨InitialçŠ¶æ€æ‰èƒ½è®¾ç½®name</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">name</span><span class="hljs-params">(value: <span class="hljs-type">String</span>)</span></span>: TypedUserBuilder&lt;NameSet&gt; <span class="hljs-keyword">where</span> S : Initial {
        <span class="hljs-keyword">return</span> TypedUserBuilder(NameSet(value))
    }

    <span class="hljs-comment">// åªæœ‰åœ¨NameSetçŠ¶æ€æ‰èƒ½è®¾ç½®age</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">age</span><span class="hljs-params">(value: <span class="hljs-type">Int</span>)</span></span>: TypedUserBuilder&lt;AgeSet&gt; <span class="hljs-keyword">where</span> S : NameSet {
        <span class="hljs-keyword">return</span> TypedUserBuilder(AgeSet((state <span class="hljs-keyword">as</span> NameSet).name, value))
    }

    <span class="hljs-comment">// åªæœ‰åœ¨AgeSetçŠ¶æ€æ‰èƒ½build</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">build</span><span class="hljs-params">()</span></span>: User <span class="hljs-keyword">where</span> S : AgeSet {
        <span class="hljs-keyword">val</span> s = state <span class="hljs-keyword">as</span> AgeSet
        <span class="hljs-keyword">return</span> User(s.name, s.age, email)
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">user</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">TypedUserBuilder</span>&lt;<span class="hljs-type">Initial</span>&gt;.() -&gt; <span class="hljs-type">TypedUserBuilder</span>&lt;<span class="hljs-type">AgeSet</span>&gt;)</span></span>: User {
    <span class="hljs-keyword">val</span> builder = TypedUserBuilder&lt;Initial&gt;(Initial())
    <span class="hljs-keyword">return</span> builder.<span class="hljs-keyword">init</span>().build()
}

<span class="hljs-comment">// ä½¿ç”¨ï¼šå¿…é¡»æŒ‰é¡ºåºè®¾ç½®name -&gt; age</span>
<span class="hljs-keyword">val</span> user = user {
    name(<span class="hljs-string">"Alice"</span>)
        .age(<span class="hljs-number">30</span>)
        .apply { email = <span class="hljs-string">"alice@example.com"</span> }
}

<span class="hljs-comment">// âŒ ç¼–è¯‘é”™è¯¯ï¼šç¼ºå°‘age</span>
<span class="hljs-comment">// val user = user { name("Alice") }</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/505db5f1b92a4c4d8b5729475d43c260~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769783644&amp;x-signature=TQumpkjolioFV7OMKo2D%2FgbilAM%3D" alt="13-02-type-safe-builder.png" loading="lazy"/></p>
<blockquote>
<p><strong>ğŸ’¡ æç¤º</strong></p>
<p>è¿™ç§ç±»å‹å®‰å…¨Builderåœ¨æŸäº›åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ï¼ˆå¦‚æ„å»ºå¤æ‚çš„é…ç½®å¯¹è±¡ï¼‰ï¼Œä½†ä¹Ÿä¼šå¢åŠ ä»£ç å¤æ‚åº¦ã€‚æƒè¡¡åˆ©å¼Šåä½¿ç”¨ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-13">å®æˆ˜æ¡ˆä¾‹</h2>
<h3 data-id="heading-14">æ¡ˆä¾‹1ï¼šSQL DSL</h3>
<p>æ‰‹å†™SQLå­—ç¬¦ä¸²å®¹æ˜“å‡ºé”™ä¸”ä¸å®‰å…¨ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ ä¸å®‰å…¨çš„SQLæ‹¼æ¥</span>
<span class="hljs-keyword">val</span> sql = <span class="hljs-string">"SELECT * FROM users WHERE age &gt; <span class="hljs-variable">$age</span> AND name = '<span class="hljs-variable">$name</span>'"</span>
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªç±»å‹å®‰å…¨çš„SQL DSLï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// DSLå®šä¹‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Query</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> conditions = mutableListOf&lt;String&gt;()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> tableName: String = <span class="hljs-string">""</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> columns = mutableListOf&lt;String&gt;()

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">from</span><span class="hljs-params">(table: <span class="hljs-type">String</span>)</span></span> {
        tableName = table
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">select</span><span class="hljs-params">(<span class="hljs-keyword">vararg</span> cols: <span class="hljs-type">String</span>)</span></span> {
        columns.addAll(cols)
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">where</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">WhereClause</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> {
        <span class="hljs-keyword">val</span> clause = WhereClause()
        clause.<span class="hljs-keyword">init</span>()
        conditions.addAll(clause.build())
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">build</span><span class="hljs-params">()</span></span>: String {
        <span class="hljs-keyword">val</span> selectPart = <span class="hljs-keyword">if</span> (columns.isEmpty()) <span class="hljs-string">"*"</span> <span class="hljs-keyword">else</span> columns.joinToString(<span class="hljs-string">", "</span>)
        <span class="hljs-keyword">val</span> wherePart = <span class="hljs-keyword">if</span> (conditions.isEmpty()) <span class="hljs-string">""</span> <span class="hljs-keyword">else</span> <span class="hljs-string">" WHERE <span class="hljs-subst">${conditions.joinToString(<span class="hljs-string">" AND "</span>)}</span>"</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"SELECT <span class="hljs-variable">$selectPart</span> FROM <span class="hljs-variable">$tableName</span><span class="hljs-variable">$wherePart</span>"</span>
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">WhereClause</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> conditions = mutableListOf&lt;String&gt;()

    <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> String.<span class="hljs-title">eq</span><span class="hljs-params">(value: <span class="hljs-type">Any</span>)</span></span> {
        conditions.add(<span class="hljs-string">"<span class="hljs-variable">$this</span> = <span class="hljs-subst">${quote(value)}</span>"</span>)
    }

    <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> String.<span class="hljs-title">gt</span><span class="hljs-params">(value: <span class="hljs-type">Number</span>)</span></span> {
        conditions.add(<span class="hljs-string">"<span class="hljs-variable">$this</span> &gt; <span class="hljs-variable">$value</span>"</span>)
    }

    <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> String.<span class="hljs-title">lt</span><span class="hljs-params">(value: <span class="hljs-type">Number</span>)</span></span> {
        conditions.add(<span class="hljs-string">"<span class="hljs-variable">$this</span> &lt; <span class="hljs-variable">$value</span>"</span>)
    }

    <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> String.<span class="hljs-title">like</span><span class="hljs-params">(pattern: <span class="hljs-type">String</span>)</span></span> {
        conditions.add(<span class="hljs-string">"<span class="hljs-variable">$this</span> LIKE '<span class="hljs-subst">${pattern.replace(<span class="hljs-string">"'"</span>, <span class="hljs-string">"''"</span>)}</span>'"</span>)
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">quote</span><span class="hljs-params">(value: <span class="hljs-type">Any</span>)</span></span>: String = <span class="hljs-keyword">when</span> (value) {
        <span class="hljs-keyword">is</span> String -&gt; <span class="hljs-string">"'<span class="hljs-subst">${value.replace(<span class="hljs-string">"'"</span>, <span class="hljs-string">"''"</span>)}</span>'"</span>
        <span class="hljs-keyword">else</span> -&gt; value.toString()
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">build</span><span class="hljs-params">()</span></span> = conditions
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Query</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span>: Query {
    <span class="hljs-keyword">val</span> query = Query()
    query.<span class="hljs-keyword">init</span>()
    <span class="hljs-keyword">return</span> query
}

<span class="hljs-comment">// ä½¿ç”¨DSL</span>
<span class="hljs-keyword">val</span> sql = query {
    select(<span class="hljs-string">"name"</span>, <span class="hljs-string">"age"</span>, <span class="hljs-string">"email"</span>)
    from(<span class="hljs-string">"users"</span>)
    <span class="hljs-keyword">where</span> {
        <span class="hljs-string">"age"</span> gt <span class="hljs-number">18</span>
        <span class="hljs-string">"name"</span> like <span class="hljs-string">"%Alice%"</span>
        <span class="hljs-string">"email"</span> eq <span class="hljs-string">"test@example.com"</span>
    }
}.build()

println(sql)
<span class="hljs-comment">// è¾“å‡º: SELECT name, age, email FROM users WHERE age &gt; 18 AND name LIKE '%Alice%' AND email = 'test@example.com'</span>
</code></pre>
<blockquote>
<p><strong>âœ… ä¼˜åŠ¿</strong></p>
<ul>
<li>ç±»å‹å®‰å…¨ï¼šåˆ—åå’Œæ“ä½œç¬¦åœ¨IDEä¸­æœ‰è‡ªåŠ¨è¡¥å…¨</li>
<li>é˜²SQLæ³¨å…¥ï¼šè‡ªåŠ¨å¤„ç†å­—ç¬¦ä¸²è½¬ä¹‰</li>
<li>æ˜“è¯»æ˜“å†™ï¼šä»£ç ç»“æ„æ¸…æ™°</li>
</ul>
</blockquote>
<h3 data-id="heading-15">æ¡ˆä¾‹2ï¼šé…ç½®DSL</h3>
<p>ä½¿ç”¨DSLç®¡ç†åº”ç”¨é…ç½®ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// DSLå®šä¹‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">AppConfig</span> {
    <span class="hljs-keyword">var</span> port: <span class="hljs-built_in">Int</span> = <span class="hljs-number">8080</span>
    <span class="hljs-keyword">var</span> host: String = <span class="hljs-string">"localhost"</span>

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> databases = mutableListOf&lt;DatabaseConfig&gt;()

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">database</span><span class="hljs-params">(name: <span class="hljs-type">String</span>, <span class="hljs-keyword">init</span>: <span class="hljs-type">DatabaseConfig</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> {
        <span class="hljs-keyword">val</span> config = DatabaseConfig(name)
        config.<span class="hljs-keyword">init</span>()
        databases.add(config)
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getDatabases</span><span class="hljs-params">()</span></span> = databases.toList()
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseConfig</span>(<span class="hljs-keyword">val</span> name: String) {
    <span class="hljs-keyword">var</span> url: String = <span class="hljs-string">""</span>
    <span class="hljs-keyword">var</span> username: String = <span class="hljs-string">""</span>
    <span class="hljs-keyword">var</span> password: String = <span class="hljs-string">""</span>
    <span class="hljs-keyword">var</span> maxConnections: <span class="hljs-built_in">Int</span> = <span class="hljs-number">10</span>

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> properties = mutableMapOf&lt;String, String&gt;()

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">property</span><span class="hljs-params">(key: <span class="hljs-type">String</span>, value: <span class="hljs-type">String</span>)</span></span> {
        properties[key] = value
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getProperties</span><span class="hljs-params">()</span></span> = properties.toMap()
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">config</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">AppConfig</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span>: AppConfig {
    <span class="hljs-keyword">val</span> config = AppConfig()
    config.<span class="hljs-keyword">init</span>()
    <span class="hljs-keyword">return</span> config
}

<span class="hljs-comment">// ä½¿ç”¨DSL</span>
<span class="hljs-keyword">val</span> appConfig = config {
    host = <span class="hljs-string">"0.0.0.0"</span>
    port = <span class="hljs-number">9090</span>

    database(<span class="hljs-string">"primary"</span>) {
        url = <span class="hljs-string">"jdbc:mysql://localhost:3306/mydb"</span>
        username = <span class="hljs-string">"root"</span>
        password = <span class="hljs-string">"secret"</span>
        maxConnections = <span class="hljs-number">20</span>
        property(<span class="hljs-string">"useSSL"</span>, <span class="hljs-string">"false"</span>)
        property(<span class="hljs-string">"characterEncoding"</span>, <span class="hljs-string">"UTF-8"</span>)
    }

    database(<span class="hljs-string">"cache"</span>) {
        url = <span class="hljs-string">"redis://localhost:6379"</span>
        username = <span class="hljs-string">"default"</span>
        password = <span class="hljs-string">"redis_pass"</span>
    }
}

<span class="hljs-comment">// è®¿é—®é…ç½®</span>
println(<span class="hljs-string">"Server: <span class="hljs-subst">${appConfig.host}</span>:<span class="hljs-subst">${appConfig.port}</span>"</span>)
appConfig.getDatabases().forEach { db -&gt;
    println(<span class="hljs-string">"Database: <span class="hljs-subst">${db.name}</span> at <span class="hljs-subst">${db.url}</span>"</span>)
}
</code></pre>
<h3 data-id="heading-16">æ¡ˆä¾‹3ï¼šæµ‹è¯•æ–­è¨€DSL</h3>
<p>è®©æµ‹è¯•ä»£ç æ›´å…·è¡¨è¾¾åŠ›ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// DSLå®šä¹‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Assertion</span>&lt;<span class="hljs-type">T</span>&gt;(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> <span class="hljs-keyword">actual</span>: T) {
    <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">shouldBe</span><span class="hljs-params">(expected: <span class="hljs-type">T</span>)</span></span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">actual</span> != expected) {
            <span class="hljs-keyword">throw</span> AssertionError(<span class="hljs-string">"Expected <span class="hljs-variable">$expected</span> but was <span class="hljs-variable">$actual</span>"</span>)
        }
    }

    <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">shouldNotBe</span><span class="hljs-params">(expected: <span class="hljs-type">T</span>)</span></span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">actual</span> == expected) {
            <span class="hljs-keyword">throw</span> AssertionError(<span class="hljs-string">"Expected not <span class="hljs-variable">$expected</span>"</span>)
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">shouldBeNull</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">actual</span> != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">throw</span> AssertionError(<span class="hljs-string">"Expected null but was <span class="hljs-variable">$actual</span>"</span>)
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">shouldNotBeNull</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">actual</span> == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">throw</span> AssertionError(<span class="hljs-string">"Expected not null"</span>)
        }
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">NumberAssertion</span>&lt;<span class="hljs-type">T : Number</span>&gt;(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> <span class="hljs-keyword">actual</span>: T) {
    <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">shouldBeGreaterThan</span><span class="hljs-params">(expected: <span class="hljs-type">T</span>)</span></span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">actual</span>.toDouble() &lt;= expected.toDouble()) {
            <span class="hljs-keyword">throw</span> AssertionError(<span class="hljs-string">"Expected <span class="hljs-variable">$actual</span> &gt; <span class="hljs-variable">$expected</span>"</span>)
        }
    }

    <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">shouldBeLessThan</span><span class="hljs-params">(expected: <span class="hljs-type">T</span>)</span></span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">actual</span>.toDouble() &gt;= expected.toDouble()) {
            <span class="hljs-keyword">throw</span> AssertionError(<span class="hljs-string">"Expected <span class="hljs-variable">$actual</span> &lt; <span class="hljs-variable">$expected</span>"</span>)
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">shouldBePositive</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">actual</span>.toDouble() &lt;= <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> AssertionError(<span class="hljs-string">"Expected positive but was <span class="hljs-variable">$actual</span>"</span>)
        }
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">StringAssertion</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> <span class="hljs-keyword">actual</span>: String) {
    <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">shouldContain</span><span class="hljs-params">(substring: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">actual</span>.contains(substring)) {
            <span class="hljs-keyword">throw</span> AssertionError(<span class="hljs-string">"Expected '<span class="hljs-variable">$actual</span>' to contain '<span class="hljs-variable">$substring</span>'"</span>)
        }
    }

    <span class="hljs-keyword">infix</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">shouldStartWith</span><span class="hljs-params">(prefix: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">actual</span>.startsWith(prefix)) {
            <span class="hljs-keyword">throw</span> AssertionError(<span class="hljs-string">"Expected '<span class="hljs-variable">$actual</span>' to start with '<span class="hljs-variable">$prefix</span>'"</span>)
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">shouldBeEmpty</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">actual</span>.isNotEmpty()) {
            <span class="hljs-keyword">throw</span> AssertionError(<span class="hljs-string">"Expected empty string but was '<span class="hljs-variable">$actual</span>'"</span>)
        }
    }
}

<span class="hljs-comment">// æ‰©å±•å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> T.<span class="hljs-title">should</span><span class="hljs-params">()</span></span>: Assertion&lt;T&gt; = Assertion(<span class="hljs-keyword">this</span>)
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Number&gt;</span> T.<span class="hljs-title">should</span><span class="hljs-params">()</span></span>: NumberAssertion&lt;T&gt; = NumberAssertion(<span class="hljs-keyword">this</span>)
<span class="hljs-function"><span class="hljs-keyword">fun</span> String.<span class="hljs-title">should</span><span class="hljs-params">()</span></span>: StringAssertion = StringAssertion(<span class="hljs-keyword">this</span>)

<span class="hljs-comment">// ä½¿ç”¨DSL</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">testUser</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> user = User(<span class="hljs-string">"Alice"</span>, <span class="hljs-number">30</span>, <span class="hljs-string">"alice@example.com"</span>)

    user.name.should() shouldBe <span class="hljs-string">"Alice"</span>
    user.age.should() shouldBeGreaterThan <span class="hljs-number">18</span>
    user.email.should() shouldContain <span class="hljs-string">"@"</span>
    user.email.should() shouldStartWith <span class="hljs-string">"alice"</span>
}
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7bce4827db41442dbccf9552ad779042~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769783644&amp;x-signature=xodylnD6I%2Fm0mnrrQIKLEKvsHcA%3D" alt="13-03-dsl-use-cases.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-17">DSLè®¾è®¡æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-18">1. éµå¾ªé¢†åŸŸæœ¯è¯­</h3>
<p>DSLçš„ç›®æ ‡æ˜¯è®©ä»£ç è´´è¿‘é¢†åŸŸï¼Œå› æ­¤åº”è¯¥ä½¿ç”¨é¢†åŸŸå†…çš„æ ‡å‡†æœ¯è¯­ã€‚</p>
<p><strong>âŒ ä¸å¥½çš„è®¾è®¡</strong>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">html {
    addHead {
        addTitle(<span class="hljs-string">"My Page"</span>)
    }
    addBody {
        addH1(<span class="hljs-string">"Welcome"</span>)
    }
}
</code></pre>
<p><strong>âœ… å¥½çš„è®¾è®¡</strong>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">html {
    head {
        title(<span class="hljs-string">"My Page"</span>)
    }
    body {
        h1(<span class="hljs-string">"Welcome"</span>)
    }
}
</code></pre>
<h3 data-id="heading-19">2. ä¿æŒä¸€è‡´çš„å‘½åé£æ ¼</h3>






























<table><thead><tr><th align="left">åœºæ™¯</th><th align="left">å‘½åé£æ ¼</th><th align="left">ç¤ºä¾‹</th></tr></thead><tbody><tr><td align="left">æ·»åŠ å­å…ƒç´ </td><td align="left">åè¯å‡½æ•°</td><td align="left"><code>body { }</code>, <code>div { }</code></td></tr><tr><td align="left">è®¾ç½®å±æ€§</td><td align="left">å±æ€§èµ‹å€¼</td><td align="left"><code>id = "main"</code>, <code>width = 100</code></td></tr><tr><td align="left">é…ç½®è¡Œä¸º</td><td align="left">åŠ¨è¯å‡½æ•°</td><td align="left"><code>onClick { }</code>, <code>validate { }</code></td></tr><tr><td align="left">æ¡ä»¶é€»è¾‘</td><td align="left">whenå‡½æ•°</td><td align="left"><code>whenUserLoggedIn { }</code></td></tr></tbody></table>
<h3 data-id="heading-20">3. æä¾›ç±»å‹å®‰å…¨</h3>
<p>å°½å¯èƒ½åœ¨ç¼–è¯‘æœŸæ•è·é”™è¯¯ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âœ… ä½¿ç”¨æšä¸¾è€Œéå­—ç¬¦ä¸²</span>
<span class="hljs-keyword">enum</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HttpMethod</span> { GET, POST, PUT, DELETE }

route(<span class="hljs-string">"/users"</span>) {
    method = HttpMethod.GET  <span class="hljs-comment">// IDEè‡ªåŠ¨è¡¥å…¨</span>
    <span class="hljs-comment">// method = "GET"  // âŒ é¿å…å­—ç¬¦ä¸²ï¼Œå®¹æ˜“æ‹¼å†™é”™è¯¯</span>
}

<span class="hljs-comment">// âœ… ä½¿ç”¨æ³›å‹çº¦æŸ</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Number&gt;</span> <span class="hljs-title">max</span><span class="hljs-params">(a: <span class="hljs-type">T</span>, b: <span class="hljs-type">T</span>)</span></span>: T { <span class="hljs-comment">/*...*/</span> }
</code></pre>
<h3 data-id="heading-21">4. åˆç†ä½¿ç”¨æ“ä½œç¬¦é‡è½½</h3>
<p>æ“ä½œç¬¦é‡è½½èƒ½è®©DSLæ›´ç®€æ´ï¼Œä½†ä¸è¦æ»¥ç”¨ï¼š</p>
<p><strong>âœ… åˆé€‚çš„åœºæ™¯</strong>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æ—¥æœŸè¿ç®—</span>
<span class="hljs-keyword">val</span> tomorrow = today + <span class="hljs-number">1.</span>days
<span class="hljs-keyword">val</span> nextWeek = today + <span class="hljs-number">1.</span>weeks

<span class="hljs-comment">// é›†åˆè¿ç®—</span>
<span class="hljs-keyword">val</span> all = listA + listB
</code></pre>
<p><strong>âŒ ä¸åˆé€‚çš„åœºæ™¯</strong>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âŒ è¯­ä¹‰ä¸æ˜ç¡®</span>
user1 + user2  <span class="hljs-comment">// è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿåˆå¹¶ç”¨æˆ·ï¼Ÿ</span>
</code></pre>
<h3 data-id="heading-22">5. æ–‡æ¡£å’Œç¤ºä¾‹</h3>
<p>DSLçš„å­¦ä¹ æ›²çº¿å¯èƒ½æ¯”æ™®é€šAPIé«˜ï¼Œæä¾›å……åˆ†çš„æ–‡æ¡£å’Œç¤ºä¾‹è‡³å…³é‡è¦ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * åˆ›å»ºä¸€ä¸ªHTTPè·¯ç”±ã€‚
 *
 * ç¤ºä¾‹:
 * ```
 * route("/users") {
 *     get { respondJson(users) }
 *     post { createUser(request.body) }
 * }
 * ```
 *
 * <span class="hljs-doctag">@param</span> path è·¯ç”±è·¯å¾„
 * <span class="hljs-doctag">@param</span> init è·¯ç”±é…ç½®Lambda
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">route</span><span class="hljs-params">(path: <span class="hljs-type">String</span>, <span class="hljs-keyword">init</span>: <span class="hljs-type">Route</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> { <span class="hljs-comment">/*...*/</span> }
</code></pre>
<h3 data-id="heading-23">6. æä¾›é€ƒç”Ÿèˆ±</h3>
<p>å½“DSLæ— æ³•è¡¨è¾¾æŸäº›å¤æ‚é€»è¾‘æ—¶ï¼Œæä¾›"é€ƒç”Ÿèˆ±"è®©ç”¨æˆ·å¯ä»¥ä½¿ç”¨åº•å±‚APIï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">html {
    body {
        <span class="hljs-comment">// ä½¿ç”¨DSL</span>
        h1(<span class="hljs-string">"Title"</span>)
        p(<span class="hljs-string">"Paragraph"</span>)

        <span class="hljs-comment">// é€ƒç”Ÿèˆ±ï¼šç›´æ¥æ·»åŠ åŸå§‹HTML</span>
        raw(<span class="hljs-string">"&lt;div class='custom'&gt;Custom Content&lt;/div&gt;"</span>)
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-24">æ€§èƒ½ä¼˜åŒ–</h2>
<h3 data-id="heading-25">1. é¿å…ä¸å¿…è¦çš„å¯¹è±¡åˆ›å»º</h3>
<p><strong>âŒ æ¯æ¬¡è°ƒç”¨éƒ½åˆ›å»ºæ–°å¯¹è±¡</strong>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">div</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Div</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> {
    <span class="hljs-keyword">val</span> div = Div()  <span class="hljs-comment">// æ¯æ¬¡è°ƒç”¨åˆ›å»ºæ–°å¯¹è±¡</span>
    div.<span class="hljs-keyword">init</span>()
    children.add(div)
}
</code></pre>
<p><strong>âœ… å¤ç”¨å¯¹è±¡æ± </strong>ï¼ˆé€‚ç”¨äºé¢‘ç¹è°ƒç”¨çš„åœºæ™¯ï¼‰ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> divPool = mutableListOf&lt;Div&gt;()

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">div</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Div</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> {
    <span class="hljs-keyword">val</span> div = divPool.removeLastOrNull() ?: Div()
    div.reset()
    div.<span class="hljs-keyword">init</span>()
    children.add(div)
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">release</span><span class="hljs-params">(div: <span class="hljs-type">Div</span>)</span></span> {
    divPool.add(div)
}
</code></pre>
<h3 data-id="heading-26">2. ä½¿ç”¨å†…è”å‡½æ•°</h3>
<p>æ ‡è®°DSLå…¥å£å‡½æ•°ä¸º <code>inline</code>ï¼Œå‡å°‘Lambdaè°ƒç”¨å¼€é”€ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">html</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">HTML</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span>: HTML {
    <span class="hljs-keyword">val</span> html = HTML()
    html.<span class="hljs-keyword">init</span>()
    <span class="hljs-keyword">return</span> html
}
</code></pre>
<h3 data-id="heading-27">3. å»¶è¿Ÿæ„å»º</h3>
<p>å¯¹äºå¤§å‹DSLï¼Œå»¶è¿Ÿå®é™…çš„æ„å»ºæ“ä½œï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LazyHTML</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> operations = mutableListOf&lt;HTML.() -&gt; <span class="hljs-built_in">Unit</span>&gt;()

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">head</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Head</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> {
        operations.add { head(<span class="hljs-keyword">init</span>) }
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">build</span><span class="hljs-params">()</span></span>: HTML {
        <span class="hljs-keyword">val</span> html = HTML()
        operations.forEach { it(html) }
        <span class="hljs-keyword">return</span> html
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-28">å¸¸è§é™·é˜±</h2>
<h3 data-id="heading-29">1. ä½œç”¨åŸŸæ³„æ¼</h3>
<p><strong>é—®é¢˜</strong>ï¼šå†…å±‚ä½œç”¨åŸŸæ„å¤–è®¿é—®å¤–å±‚æ¥æ”¶è€…</p>
<pre><code class="hljs language-kotlin" lang="kotlin">html {
    body {
        head { }  <span class="hljs-comment">// âŒ é”™è¯¯ï¼headåº”è¯¥åœ¨htmlå±‚çº§</span>
    }
}
</code></pre>
<p><strong>è§£å†³</strong>ï¼šä½¿ç”¨ <code>@DslMarker</code></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@DslMarker</span>
<span class="hljs-keyword">annotation</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HtmlDsl</span>

<span class="hljs-meta">@HtmlDsl</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">HTML</span> { <span class="hljs-comment">/*...*/</span> }

<span class="hljs-meta">@HtmlDsl</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Body</span> { <span class="hljs-comment">/*...*/</span> }
</code></pre>
<h3 data-id="heading-30">2. å¯å˜çŠ¶æ€å…±äº«</h3>
<p><strong>é—®é¢˜</strong>ï¼šå¤šä¸ªLambdaå…±äº«å¯å˜çŠ¶æ€å¯¼è‡´æ„å¤–ç»“æœ</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">var</span> counter = <span class="hljs-number">0</span>
html {
    body {
        repeat(<span class="hljs-number">3</span>) {
            p(<span class="hljs-string">"Count: <span class="hljs-subst">${counter++}</span>"</span>)  <span class="hljs-comment">// âŒ å‰¯ä½œç”¨</span>
        }
    }
}
</code></pre>
<p><strong>è§£å†³</strong>ï¼šé¿å…åœ¨DSLä¸­ä½¿ç”¨å¤–éƒ¨å¯å˜çŠ¶æ€</p>
<pre><code class="hljs language-kotlin" lang="kotlin">html {
    body {
        repeat(<span class="hljs-number">3</span>) { index -&gt;
            p(<span class="hljs-string">"Count: <span class="hljs-variable">$index</span>"</span>)  <span class="hljs-comment">// âœ… ä½¿ç”¨ä¸å¯å˜å‚æ•°</span>
        }
    }
}
</code></pre>
<h3 data-id="heading-31">3. è¿‡åº¦åµŒå¥—</h3>
<p><strong>é—®é¢˜</strong>ï¼šDSLåµŒå¥—è¿‡æ·±éš¾ä»¥é˜…è¯»</p>
<pre><code class="hljs language-kotlin" lang="kotlin">html {
    body {
        div {
            div {
                div {
                    p(<span class="hljs-string">"Deep nested"</span>)  <span class="hljs-comment">// âŒ åµŒå¥—å¤ªæ·±</span>
                }
            }
        }
    }
}
</code></pre>
<p><strong>è§£å†³</strong>ï¼šæå–å­DSLæˆ–ä½¿ç”¨è¾…åŠ©å‡½æ•°</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> Body.<span class="hljs-title">contentSection</span><span class="hljs-params">()</span></span> {
    div {
        div {
            div {
                p(<span class="hljs-string">"Deep nested"</span>)
            }
        }
    }
}

html {
    body {
        contentSection()  <span class="hljs-comment">// âœ… æ¸…æ™°</span>
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-32">å®æˆ˜ï¼šå®Œæ•´çš„HTML DSLå®ç°</h2>
<p>è®©æˆ‘ä»¬æ•´åˆæ‰€æœ‰çŸ¥è¯†ç‚¹ï¼Œå®ç°ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„HTML DSLï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@DslMarker</span>
<span class="hljs-keyword">annotation</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HtmlDsl</span>

<span class="hljs-meta">@HtmlDsl</span>
<span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Tag</span>(<span class="hljs-keyword">val</span> name: String) {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> children = mutableListOf&lt;Tag&gt;()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> attributes = mutableMapOf&lt;String, String&gt;()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> textContent: String? = <span class="hljs-literal">null</span>

    <span class="hljs-keyword">protected</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Tag&gt;</span> <span class="hljs-title">initTag</span><span class="hljs-params">(tag: <span class="hljs-type">T</span>, <span class="hljs-keyword">init</span>: <span class="hljs-type">T</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span>: T {
        tag.<span class="hljs-keyword">init</span>()
        children.add(tag)
        <span class="hljs-keyword">return</span> tag
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">attribute</span><span class="hljs-params">(name: <span class="hljs-type">String</span>, value: <span class="hljs-type">String</span>)</span></span> {
        attributes[name] = value
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">text</span><span class="hljs-params">(content: <span class="hljs-type">String</span>)</span></span> {
        textContent = content
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">render</span><span class="hljs-params">()</span></span>: String {
        <span class="hljs-keyword">val</span> attrs = attributes.entries.joinToString(<span class="hljs-string">" "</span>) { <span class="hljs-string">"<span class="hljs-subst">${it.key}</span>=\"<span class="hljs-subst">${it.value}</span>\""</span> }
        <span class="hljs-keyword">val</span> attrString = <span class="hljs-keyword">if</span> (attrs.isNotEmpty()) <span class="hljs-string">" <span class="hljs-variable">$attrs</span>"</span> <span class="hljs-keyword">else</span> <span class="hljs-string">""</span>

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (children.isEmpty() &amp;&amp; textContent == <span class="hljs-literal">null</span>) {
            <span class="hljs-string">"&lt;<span class="hljs-variable">$name</span><span class="hljs-variable">$attrString</span>/&gt;"</span>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">val</span> content = textContent ?: children.joinToString(<span class="hljs-string">""</span>) { it.render() }
            <span class="hljs-string">"&lt;<span class="hljs-variable">$name</span><span class="hljs-variable">$attrString</span>&gt;<span class="hljs-variable">$content</span>&lt;/<span class="hljs-variable">$name</span>&gt;"</span>
        }
    }
}

<span class="hljs-meta">@HtmlDsl</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">HTML</span> : <span class="hljs-type">Tag</span>(<span class="hljs-string">"html"</span>) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">head</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Head</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> = initTag(Head(), <span class="hljs-keyword">init</span>)
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">body</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Body</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> = initTag(Body(), <span class="hljs-keyword">init</span>)
}

<span class="hljs-meta">@HtmlDsl</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Head</span> : <span class="hljs-type">Tag</span>(<span class="hljs-string">"head"</span>) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">title</span><span class="hljs-params">(text: <span class="hljs-type">String</span>)</span></span> {
        initTag(Title(), {}).text(text)
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">meta</span><span class="hljs-params">(charset: <span class="hljs-type">String</span>)</span></span> {
        initTag(Meta(), {}).attribute(<span class="hljs-string">"charset"</span>, charset)
    }
}

<span class="hljs-meta">@HtmlDsl</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Title</span> : <span class="hljs-type">Tag</span>(<span class="hljs-string">"title"</span>)

<span class="hljs-meta">@HtmlDsl</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Meta</span> : <span class="hljs-type">Tag</span>(<span class="hljs-string">"meta"</span>)

<span class="hljs-meta">@HtmlDsl</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Body</span> : <span class="hljs-type">Tag</span>(<span class="hljs-string">"body"</span>) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">h1</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">H1</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> = initTag(H1(), <span class="hljs-keyword">init</span>)
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">h1</span><span class="hljs-params">(text: <span class="hljs-type">String</span>)</span></span> = initTag(H1(), {}).apply { text(text) }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">p</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">P</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> = initTag(P(), <span class="hljs-keyword">init</span>)
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">p</span><span class="hljs-params">(text: <span class="hljs-type">String</span>)</span></span> = initTag(P(), {}).apply { text(text) }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">div</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">Div</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> = initTag(Div(), <span class="hljs-keyword">init</span>)
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">ul</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">UL</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> = initTag(UL(), <span class="hljs-keyword">init</span>)
}

<span class="hljs-meta">@HtmlDsl</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">H1</span> : <span class="hljs-type">Tag</span>(<span class="hljs-string">"h1"</span>)

<span class="hljs-meta">@HtmlDsl</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">P</span> : <span class="hljs-type">Tag</span>(<span class="hljs-string">"p"</span>)

<span class="hljs-meta">@HtmlDsl</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Div</span> : <span class="hljs-type">Tag</span>(<span class="hljs-string">"div"</span>) {
    <span class="hljs-keyword">var</span> id: String
        <span class="hljs-keyword">get</span>() = <span class="hljs-string">""</span>
        <span class="hljs-keyword">set</span>(value) = attribute(<span class="hljs-string">"id"</span>, value)

    <span class="hljs-keyword">var</span> cssClass: String
        <span class="hljs-keyword">get</span>() = <span class="hljs-string">""</span>
        <span class="hljs-keyword">set</span>(value) = attribute(<span class="hljs-string">"class"</span>, value)

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">p</span><span class="hljs-params">(text: <span class="hljs-type">String</span>)</span></span> = initTag(P(), {}).apply { text(text) }
}

<span class="hljs-meta">@HtmlDsl</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UL</span> : <span class="hljs-type">Tag</span>(<span class="hljs-string">"ul"</span>) {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">li</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">LI</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span> = initTag(LI(), <span class="hljs-keyword">init</span>)
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">li</span><span class="hljs-params">(text: <span class="hljs-type">String</span>)</span></span> = initTag(LI(), {}).apply { text(text) }
}

<span class="hljs-meta">@HtmlDsl</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LI</span> : <span class="hljs-type">Tag</span>(<span class="hljs-string">"li"</span>)

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">html</span><span class="hljs-params">(<span class="hljs-keyword">init</span>: <span class="hljs-type">HTML</span>.() -&gt; <span class="hljs-type">Unit</span>)</span></span>: HTML {
    <span class="hljs-keyword">val</span> html = HTML()
    html.<span class="hljs-keyword">init</span>()
    <span class="hljs-keyword">return</span> html
}

<span class="hljs-comment">// ä½¿ç”¨å®Œæ•´DSL</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> page = html {
        head {
            title(<span class="hljs-string">"Kotlin DSL Demo"</span>)
            meta(<span class="hljs-string">"UTF-8"</span>)
        }
        body {
            h1(<span class="hljs-string">"Welcome to Kotlin DSL"</span>)

            div {
                id = <span class="hljs-string">"main-content"</span>
                cssClass = <span class="hljs-string">"container"</span>

                p(<span class="hljs-string">"This is a paragraph in a div."</span>)
                p {
                    text(<span class="hljs-string">"This is another paragraph with "</span>)
                    <span class="hljs-comment">// å¯ä»¥åµŒå¥—æ›´å¤šå†…å®¹</span>
                }
            }

            ul {
                li(<span class="hljs-string">"Item 1"</span>)
                li(<span class="hljs-string">"Item 2"</span>)
                li {
                    text(<span class="hljs-string">"Item 3 with custom content"</span>)
                }
            }
        }
    }

    println(page.render())
}
</code></pre>
<p><strong>è¾“å‡º</strong>ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Kotlin DSL Demo<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Welcome to Kotlin DSL<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"main-content"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>This is a paragraph in a div.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>This is another paragraph with <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Item 1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Item 2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Item 3 with custom content<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<blockquote>
<p><strong>ğŸ’¡ è¿™ä¸ªå®ç°å±•ç¤ºäº†</strong></p>
<ul>
<li><code>@DslMarker</code> é˜²æ­¢ä½œç”¨åŸŸæ³„æ¼</li>
<li>Lambdaæ¥æ”¶è€…å®ç°åµŒå¥—ç»“æ„</li>
<li>å±æ€§èµ‹å€¼ï¼ˆ<code>id = "..."</code>ï¼‰ä¸å‡½æ•°è°ƒç”¨ï¼ˆ<code>title("...")</code>ï¼‰æ··åˆä½¿ç”¨</li>
<li>çµæ´»çš„APIï¼šæ—¢æ”¯æŒ <code>p("text")</code>ï¼Œä¹Ÿæ”¯æŒ <code>p { text("text") }</code></li>
</ul>
</blockquote>
<hr/>
<h2 data-id="heading-33">æ€»ç»“</h2>
<h3 data-id="heading-34">DSLè®¾è®¡çš„å…³é”®è¦ç´ </h3>








































<table><thead><tr><th align="left">è¦ç´ </th><th align="left">æŠ€æœ¯æ‰‹æ®µ</th><th align="left">ä½œç”¨</th></tr></thead><tbody><tr><td align="left">Lambdaæ¥æ”¶è€…</td><td align="left"><code>Type.() -&gt; Unit</code></td><td align="left">å®ç°åµŒå¥—ç»“æ„</td></tr><tr><td align="left">ä½œç”¨åŸŸæ§åˆ¶</td><td align="left"><code>@DslMarker</code></td><td align="left">é˜²æ­¢éšå¼è®¿é—®å¤–å±‚</td></tr><tr><td align="left">ç±»å‹å®‰å…¨</td><td align="left">æ³›å‹ã€æšä¸¾ã€å¯†å°ç±»</td><td align="left">ç¼–è¯‘æœŸé”™è¯¯æ£€æŸ¥</td></tr><tr><td align="left">æ“ä½œç¬¦é‡è½½</td><td align="left"><code>operator fun</code></td><td align="left">ç®€åŒ–è¡¨è¾¾</td></tr><tr><td align="left">æ‰©å±•å‡½æ•°</td><td align="left"><code>fun Type.method()</code></td><td align="left">æ‰©å±•ç°æœ‰ç±»å‹</td></tr><tr><td align="left">ä¸­ç¼€å‡½æ•°</td><td align="left"><code>infix fun</code></td><td align="left">ç±»è‡ªç„¶è¯­è¨€è¡¨è¾¾</td></tr></tbody></table>
<h3 data-id="heading-35">ä½•æ—¶ä½¿ç”¨DSL</h3>
<p><strong>âœ… é€‚åˆä½¿ç”¨DSLçš„åœºæ™¯</strong>ï¼š</p>
<ul>
<li>é…ç½®ç®¡ç†ï¼ˆGradleã€Springé…ç½®ï¼‰</li>
<li>UIæ„å»ºï¼ˆJetpack Composeã€HTMLç”Ÿæˆï¼‰</li>
<li>æµ‹è¯•æ–­è¨€ï¼ˆKotestã€AssertJï¼‰</li>
<li>SQLæŸ¥è¯¢æ„å»ºï¼ˆExposedã€JOOQï¼‰</li>
<li>è·¯ç”±å®šä¹‰ï¼ˆKtorã€Spring WebFluxï¼‰</li>
</ul>
<p><strong>âŒ ä¸é€‚åˆä½¿ç”¨DSLçš„åœºæ™¯</strong>ï¼š</p>
<ul>
<li>ç®€å•çš„æ•°æ®ä¼ é€’ï¼ˆç”¨æ•°æ®ç±»å³å¯ï¼‰</li>
<li>æ€§èƒ½æ•æ„Ÿçš„çƒ­ç‚¹ä»£ç ï¼ˆDSLæœ‰Lambdaå¼€é”€ï¼‰</li>
<li>ä¸€æ¬¡æ€§ä½¿ç”¨çš„ä»£ç ï¼ˆDSLè®¾è®¡æˆæœ¬é«˜ï¼‰</li>
</ul>
<h3 data-id="heading-36">è¿›é˜¶å­¦ä¹ èµ„æº</h3>
<ol>
<li><strong>Kotlinå®˜æ–¹æ–‡æ¡£</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fkotlinlang.org%2Fdocs%2Ftype-safe-builders.html" target="_blank" title="https://kotlinlang.org/docs/type-safe-builders.html" ref="nofollow noopener noreferrer">Type-safe builders</a></li>
<li><strong>Kotlinx.html</strong>ï¼šå®˜æ–¹HTML DSLå®ç°ï¼Œå­¦ä¹ æœ€ä½³å®è·µ</li>
<li><strong>Exposed</strong>ï¼šç±»å‹å®‰å…¨çš„SQL DSLåº“</li>
<li><strong>Ktor</strong>ï¼šWebæ¡†æ¶çš„è·¯ç”±DSL</li>
</ol>
<hr/>
<p><strong>ç³»åˆ—æ–‡ç« å¯¼èˆª:</strong></p>
<ul>
<li>ğŸ‘‰ ä¸Šä¸€ç¯‡: <a href="https://juejin.cn/post/7598057199962210355" target="_blank" title="https://juejin.cn/post/7598057199962210355">å‡½æ•°å¼ç¼–ç¨‹åœ¨Kotlinä¸­çš„å®è·µï¼šä»Lambdaåˆ°å‡½æ•°ç»„åˆçš„ä¼˜é›…ä¹‹æ—…</a></li>
</ul>
<hr/>
<p><em>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©,æ¬¢è¿ç‚¹èµã€æ”¶è—ã€åˆ†äº«!æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®,æ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€è®¨è®ºã€‚è®©æˆ‘ä»¬ä¸€èµ·å­¦ä¹ ,ä¸€èµ·æˆé•¿!</em></p>
<p><em>ä¹Ÿæ¬¢è¿è®¿é—®æˆ‘çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fhome.wonlab.top" target="_blank" title="https://home.wonlab.top" ref="nofollow noopener noreferrer">ä¸ªäººä¸»é¡µ</a>å‘ç°æ›´å¤šå®è—èµ„æº</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Composeä¸­rememberUpdatedStateçš„ä½œç”¨]]></title>    <link>https://juejin.cn/post/7598366933080227894</link>    <guid>https://juejin.cn/post/7598366933080227894</guid>    <pubDate>2026-01-23T14:39:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598366933080227894" data-draft-id="7598398537248915475" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Composeä¸­rememberUpdatedStateçš„ä½œç”¨"/> <meta itemprop="keywords" content="Android Jetpack"/> <meta itemprop="datePublished" content="2026-01-23T14:39:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·98512003583"/> <meta itemprop="url" content="https://juejin.cn/user/1927871600799337"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Composeä¸­rememberUpdatedStateçš„ä½œç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1927871600799337/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·98512003583
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T14:39:32.000Z" title="Fri Jan 23 2026 14:39:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>Compose ä¸­çš„ rememberUpdatedState ä½œç”¨ï¼Œä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ä½¿ç”¨ï¼Ÿ</p>
</blockquote>
<p>åœ¨ Jetpack Compose å¼€å‘ä¸­ï¼Œåç¨‹ä¸é™„å¸¦æ•ˆåº”ï¼ˆSide Effectï¼‰æ˜¯å¤„ç†å¼‚æ­¥é€»è¾‘çš„æ ¸å¿ƒå·¥å…·ã€‚</p>
<p>å¦‚ä¸‹é¢çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">SimpleComponent</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// ä½¿ç”¨LaunchedEffectå¤„ç†å¼‚æ­¥ä»»åŠ¡ï¼Œè¯¥Effectä¼šåœ¨ç»„ä»¶é¦–æ¬¡ç»„åˆæ—¶å¯åŠ¨    </span>
    LaunchedEffect() {        
	    <span class="hljs-comment">// åœ¨è¿™é‡Œç¼–å†™å…·ä½“çš„å¼‚æ­¥ä»»åŠ¡é€»è¾‘ï¼Œä¾‹å¦‚ç½‘ç»œè¯·æ±‚ã€æ•°æ®åŠ è½½ç­‰        </span>
	    <span class="hljs-comment">// å¤„ç†å¼‚æ­¥ä»»åŠ¡    </span>
	}    
	<span class="hljs-comment">// ä»¥ä¸‹æ˜¯UIé¡µé¢çš„æ„å»ºé€»è¾‘ï¼Œå¯æ ¹æ®å®é™…éœ€æ±‚æ·»åŠ å…·ä½“çš„Composableå…ƒç´     </span>
	<span class="hljs-comment">// UI é¡µé¢</span>
}
</code></pre>
<p>åœ¨å®é™…å¼€å‘åœºæ™¯ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°ä»¥ä¸‹æƒ…å†µï¼šåœ¨åç¨‹å†…æ‰§è¡Œå›è°ƒæ“ä½œæ—¶ï¼Œæœ€ç»ˆè§¦å‘çš„å´å¯èƒ½æ˜¯æ—§ç‰ˆæœ¬çš„å›è°ƒé€»è¾‘ï¼Œå¯¼è‡´åŠŸèƒ½å¼‚å¸¸ã€‚</p>
<h2 data-id="heading-0">1. åç¨‹ä¸­çš„å›è°ƒé™·é˜±</h2>
<p>å‡è®¾æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªå¯åŠ¨é¡µåŠŸèƒ½ï¼šé¡µé¢æ˜¾ç¤º 2 ç§’åè‡ªåŠ¨è·³è½¬ï¼Œè·³è½¬é€»è¾‘é€šè¿‡ onTimeout å›è°ƒä¼ å…¥ã€‚ç”¨ LaunchedEffect å®ç°çš„åˆç‰ˆä»£ç å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">LandingScreen</span><span class="hljs-params">(onTimeout: () -&gt; <span class="hljs-type">Unit</span>)</span></span> {    
	<span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹ï¼šç›´æ¥ä½¿ç”¨ onTimeout ä½œä¸ºå‚æ•°å’Œé”®    </span>
	LaunchedEffect(onTimeout) {     
	    delay(<span class="hljs-number">2000</span>) 
	    <span class="hljs-comment">// æ¨¡æ‹Ÿ2ç§’å»¶è¿Ÿ        </span>
	    onTimeout() 
	    <span class="hljs-comment">// é¢„æœŸæ‰§è¡Œæœ€æ–°çš„è·³è½¬é€»è¾‘    </span>
	}    
	<span class="hljs-comment">// å¯åŠ¨é¡µUI...</span>
}
</code></pre>
<p>è¿™æ®µä»£ç çœ‹ä¼¼åˆç†ï¼Œå´éšè—ç€ä¸€ä¸ªé—®é¢˜ï¼š</p>
<p><strong>è‹¥å°†</strong> <strong>onTimeout</strong> <strong>è®¾ä¸ºé”®ï¼Œä¼šå¯¼è‡´åç¨‹é¢‘ç¹é‡å¯</strong></p>
<p>ä¸ºäº† â€œå“åº” onTimeout å˜åŒ–â€ï¼Œä½ å¯èƒ½ä¼šæŠŠå®ƒè®¾ä¸º LaunchedEffect çš„é”®ã€‚ä½†è¿™æ ·ä¼šå¯¼è‡´ onTimeout ä¸€å˜åŒ–ï¼Œåç¨‹å°±ä¼šè¢«å–æ¶ˆå¹¶é‡å¯ï¼Œ2 ç§’å»¶è¿Ÿä¼šä»å¤´è®¡ç®—ï¼Œå®Œå…¨ä¸ç¬¦åˆ â€œåªç­‰ 2 ç§’â€ çš„éœ€æ±‚ã€‚</p>
<p>å› æ­¤ï¼Œä¸ºäº†é˜²æ­¢åç¨‹é‡å¯ï¼Œå¯ä»¥æŠŠåç¨‹çš„é”®è®¾ç½®æˆ Unitï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">LandingScreen</span><span class="hljs-params">(onTimeout: () -&gt; <span class="hljs-type">Unit</span>)</span></span> {
    LaunchedEffect(<span class="hljs-built_in">Unit</span>) {     
        delay(<span class="hljs-number">2000</span>) 
        <span class="hljs-comment">// æ¨¡æ‹Ÿ2ç§’å»¶è¿Ÿ         </span>
        onTimeout()      
    }     
    <span class="hljs-comment">// å¯åŠ¨é¡µUI...</span>
}
</code></pre>
<p>è¿™æ ·å³ä½¿ onTimeout æ”¹å˜åç¨‹ä¹Ÿä¸ä¼šé‡å¯äº†ï¼Œä½†æ˜¯ä¼šå¼•å‘ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼Œ</p>
<p><strong>å¦‚æœ</strong> <strong>onTimeout</strong> <strong>ä¸­é€”å˜åŒ–ï¼Œåç¨‹ä¼šæ‰§è¡Œæ—§å›è°ƒ</strong></p>
<p>å½“ LaunchedEffect å¯åŠ¨åç¨‹æ—¶ï¼Œä¼š â€œæ•è·â€ å½“æ—¶ onTimeout çš„å¼•ç”¨ã€‚å¦‚æœçˆ¶ç»„ä»¶é‡ç»„æ—¶ä¼ å…¥äº†æ–°çš„ onTimeoutï¼ˆæ¯”å¦‚çˆ¶ç»„ä»¶çŠ¶æ€å˜åŒ–å¯¼è‡´ lambda é‡æ–°åˆ›å»ºï¼‰ï¼Œåç¨‹ä¸­ä¿å­˜çš„è¿˜æ˜¯å¯åŠ¨æ—¶çš„æ—§å¼•ç”¨ï¼Œæœ€ç»ˆæ‰§è¡Œçš„ä»æ˜¯æ—§é€»è¾‘ã€‚</p>
<h2 data-id="heading-1">2. ç”¨ rememberUpdatedState ä¿æŒ â€œæœ€æ–°å¼•ç”¨â€</h2>
<p>rememberUpdatedState æ˜¯ Compose ä¸“é—¨ä¸ºè¿™ç±»åœºæ™¯è®¾è®¡çš„ APIï¼Œå®ƒèƒ½è®©åç¨‹åœ¨ä¸é‡å¯çš„å‰æä¸‹ï¼Œå§‹ç»ˆè°ƒç”¨æœ€æ–°ç‰ˆæœ¬çš„å›è°ƒã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">LandingScreen</span><span class="hljs-params">(onTimeout: () -&gt; <span class="hljs-type">Unit</span>)</span></span> {
    <span class="hljs-comment">// 1. ç”¨ rememberUpdatedState ä¿å­˜ onTimeout çš„æœ€æ–°å¼•ç”¨   </span>
    <span class="hljs-comment">// æ¯æ¬¡é‡ç»„æ—¶ï¼Œä¼šè‡ªåŠ¨æ›´æ–°ä¸ºæœ€æ–°çš„ onTimeoutï¼Œä½†ä¸ä¼šè§¦å‘åç¨‹é‡å¯    </span>
    <span class="hljs-comment">// ç›¸å½“äºåç¨‹æŒæœ‰äº† onTimeout çš„ä¸€ä¸ªé—´æ¥å¼•ç”¨ï¼Œé€šè¿‡è¿™ä¸ªé—´æ¥å¼•ç”¨æ¥è°ƒç”¨ onTimeout    </span>
    <span class="hljs-keyword">val</span> currentOnTimeout <span class="hljs-keyword">by</span> rememberUpdatedState(onTimeout)        
    <span class="hljs-comment">// 2. ç”¨ Unit ä½œä¸ºé”®ï¼Œç¡®ä¿åç¨‹åªå¯åŠ¨ä¸€æ¬¡ï¼ˆä¸å— onTimeout å˜åŒ–å½±å“ï¼‰    </span>
    LaunchedEffect(<span class="hljs-built_in">Unit</span>) {         
	    delay(<span class="hljs-number">2000</span>) <span class="hljs-comment">// å»¶è¿ŸæœŸé—´å³ä½¿ onTimeout å˜åŒ–ï¼Œåç¨‹ä¹Ÿä¸ä¸­æ–­        </span>
	    currentOnTimeout() <span class="hljs-comment">// è°ƒç”¨çš„æ˜¯æœ€æ–°çš„ onTimeout    </span>
	}    
	<span class="hljs-comment">// å¯åŠ¨é¡µUI...</span>
}
</code></pre>
<p>æ ¸å¿ƒæ”¹è¿›æœ‰ä¸¤ç‚¹ï¼š</p>
<ul>
<li>
<p><strong>rememberUpdatedState</strong> <strong>è´Ÿè´£ â€œå®æ—¶æ›´æ–°â€</strong>ï¼šå®ƒä¼šåˆ›å»ºä¸€ä¸ª Compose çŠ¶æ€ï¼ˆStateï¼‰ï¼Œæ¯æ¬¡ç»„ä»¶é‡ç»„æ—¶ï¼Œè‡ªåŠ¨å°†çŠ¶æ€å€¼æ›´æ–°ä¸ºæœ€æ–°çš„ onTimeoutï¼Œä½†çŠ¶æ€æœ¬èº«çš„_<strong>å¼•ç”¨ï¼ˆåœ°å€ï¼‰</strong>_ä¸å˜ã€‚</p>
</li>
<li>
<p><strong>LaunchedEffect</strong> <strong>ç”¨</strong> <strong>Unit</strong> <strong>ä½œä¸ºé”®</strong>ï¼šç¡®ä¿åç¨‹åªåœ¨ç»„ä»¶é¦–æ¬¡è¿›å…¥ç»„åˆæ—¶å¯åŠ¨ä¸€æ¬¡ï¼Œåç»­æ— è®º onTimeout å¦‚ä½•å˜åŒ–ï¼Œåç¨‹éƒ½ä¸ä¼šé‡å¯ï¼Œä¿è¯ 2 ç§’å»¶è¿Ÿçš„è¿ç»­æ€§ã€‚</p>
</li>
</ul>
<h2 data-id="heading-2">3. ä¸ºä»€ä¹ˆ â€œé—´æ¥å¼•ç”¨â€ èƒ½è§£å†³é—®é¢˜ï¼Ÿ</h2>
<p>æœ¬è´¨ä¸Šï¼ŒrememberUpdatedState æ˜¯é€šè¿‡ â€œé—´æ¥å¼•ç”¨â€ é˜²æ­¢åç¨‹å¯¹ â€œå¯å˜å›è°ƒâ€ çš„<strong>ç›´æ¥</strong>ä¾èµ–ï¼š</p>
<ul>
<li>
<p><strong>ç›´æ¥å¼•ç”¨çš„é—®é¢˜</strong>ï¼šåç¨‹å¯åŠ¨æ—¶ç›´æ¥æŒæœ‰ onTimeout çš„å¼•ç”¨ï¼Œä¸€æ—¦ onTimeout å˜åŒ–ï¼Œåç¨‹æ‰‹é‡Œçš„è¿˜æ˜¯æ—§å¼•ç”¨ï¼ˆ<em>ç›¸å½“äº â€œå¿«ç…§è¿‡æœŸâ€</em>ï¼‰ã€‚</p>
</li>
<li>
<p><strong>é—´æ¥å¼•ç”¨çš„ä¼˜åŠ¿</strong>ï¼šåç¨‹ä¸å†ç›´æ¥æŒæœ‰ onTimeoutï¼Œè€Œæ˜¯æŒæœ‰ rememberUpdatedState åˆ›å»ºçš„ State å¼•ç”¨ï¼ˆè¿™ä¸ªå¼•ç”¨æ˜¯å›ºå®šçš„ï¼‰ã€‚å½“ onTimeout å˜åŒ–æ—¶ï¼ŒState å†…éƒ¨çš„å€¼ä¼šè¢«è‡ªåŠ¨æ›´æ–°ï¼›è€Œåç¨‹æ‰§è¡Œåˆ° currentOnTimeout() æ—¶ï¼Œè¯»å–çš„æ˜¯ State ä¸­æœ€æ–°çš„å€¼ï¼Œè‡ªç„¶èƒ½æ‹¿åˆ°æœ€æ–°çš„å›è°ƒã€‚</p>
</li>
</ul>
<p>ç®€å•è¯´å°±æ˜¯ï¼š</p>
<p>åç¨‹æŒæœ‰çš„æ˜¯ â€œè£…å›è°ƒçš„ç›’å­â€ï¼ˆStateï¼‰ï¼Œè€Œä¸æ˜¯ â€œç›’å­é‡Œçš„å›è°ƒâ€ã€‚ç›’å­ä¸å˜ï¼Œä½†é‡Œé¢çš„å›è°ƒå¯ä»¥éšæ—¶æ›´æ–°ï¼Œåç¨‹å–çš„æ—¶å€™æ°¸è¿œæ˜¯æœ€æ–°çš„ã€‚</p>
<p>ä¸¾ä¸ªæ —å­ï¼šå‡è®¾ä½ è®¡åˆ’ä¸€å¤©åå‰å¾€é“¶è¡ŒåŠç†ä¸šåŠ¡ã€‚è‹¥é‡‡ç”¨ç›´æ¥å¼•ç”¨çš„æ–¹å¼ï¼Œå°±å¦‚åŒç›´æ¥æŒ‡å®šç”±æŸä½ç‰¹å®šæŸœå‘˜ä¸ºä½ æœåŠ¡ï¼Œä¸€æ—¦è¿™ä½æŸœå‘˜çªç„¶ç¦»èŒï¼Œæˆ–æ˜¯å²—ä½è°ƒåŠ¨ï¼Œä½ çš„ä¸šåŠ¡åŠç†å¾ˆå¯èƒ½ä¼šå—é˜»ã€‚è€Œé—´æ¥å¼•ç”¨åˆ™å¥½æ¯”æ‹¨é€šé“¶è¡Œå®¢æœçƒ­çº¿ï¼Œç”±å®¢æœæ ¹æ®å®æ—¶æƒ…å†µï¼Œä¸ºä½ åè°ƒæœ€åˆé€‚çš„å·¥ä½œäººå‘˜å¤„ç†ä¸šåŠ¡ ã€‚</p>
<h2 data-id="heading-3">4. æ€»ç»“</h2>
<p>å½“ä½ éœ€è¦åœ¨ <strong>é•¿æœŸè¿è¡Œçš„åç¨‹</strong>ï¼ˆå¦‚ LaunchedEffect ä¸­çš„å»¶è¿Ÿã€ç½‘ç»œè¯·æ±‚ï¼‰ä¸­è°ƒç”¨ <strong>å¯èƒ½å˜åŒ–çš„å›è°ƒ / å‚æ•°</strong> æ—¶ï¼Œç›´æ¥ä½¿ç”¨åŸå‚æ•°ä¼šå¯¼è‡´ â€œè°ƒç”¨æ—§å€¼â€ï¼Œè€Œå°†å‚æ•°è®¾ä¸º LaunchedEffect çš„é”®åˆä¼šå¯¼è‡´åç¨‹é¢‘ç¹é‡å¯ã€‚</p>
<p>rememberUpdatedState çš„ä»·å€¼å°±åœ¨äºï¼šå®ƒèƒ½è®©ä½ åœ¨ä¸ä¸­æ–­åç¨‹æ‰§è¡Œçš„å‰æä¸‹ï¼Œå§‹ç»ˆæŒæœ‰æœ€æ–°çš„å‚æ•°å¼•ç”¨ï¼Œå®Œç¾è§£å†³ â€œæ—§å›è°ƒâ€ é—®é¢˜ã€‚</p>
<p>è®°ä½è¿™ä¸ªåœºæ™¯ï¼š<strong>é•¿æœŸåç¨‹ + å¯å˜å›è°ƒ = ç”¨ rememberUpdatedState ä¿é²œå¼•ç”¨</strong>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android 15å­˜å‚¨å­ç³»ç»Ÿæ·±åº¦è§£æ(äºŒ):FUSEæ–‡ä»¶ç³»ç»Ÿä¸Scoped Storage]]></title>    <link>https://juejin.cn/post/7598390354292539438</link>    <guid>https://juejin.cn/post/7598390354292539438</guid>    <pubDate>2026-01-23T14:43:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598390354292539438" data-draft-id="7598389448146288650" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android 15å­˜å‚¨å­ç³»ç»Ÿæ·±åº¦è§£æ(äºŒ):FUSEæ–‡ä»¶ç³»ç»Ÿä¸Scoped Storage"/> <meta itemprop="keywords" content="Android,æºç é˜…è¯»,æºç "/> <meta itemprop="datePublished" content="2026-01-23T14:43:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†¬å¥‡Lab"/> <meta itemprop="url" content="https://juejin.cn/user/1857501105781193"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android 15å­˜å‚¨å­ç³»ç»Ÿæ·±åº¦è§£æ(äºŒ):FUSEæ–‡ä»¶ç³»ç»Ÿä¸Scoped Storage
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1857501105781193/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†¬å¥‡Lab
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T14:43:21.000Z" title="Fri Jan 23 2026 14:43:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å†™åœ¨å‰é¢</h2>
<p>å¦‚æœä½ å¼€å‘è¿‡Androidåº”ç”¨,ä¸€å®šé‡åˆ°è¿‡è¿™æ ·çš„å›°æƒ‘:</p>
<pre><code class="hljs language-csharp" lang="csharp">Android <span class="hljs-number">10</span>ä¹‹å‰: åªè¦æœ‰WRITE_EXTERNAL_STORAGEæƒé™,çˆ±æ€ä¹ˆå†™å°±æ€ä¹ˆå†™
Android <span class="hljs-number">10</span>:     Scoped Storageæ¥äº†,ä½†å¯ä»¥opt-<span class="hljs-keyword">out</span>
Android <span class="hljs-number">11</span>+:    å¿…é¡»ç”¨Scoped Storage,ä¼ ç»Ÿæ–‡ä»¶APIå—é™
ä½ :            æˆ‘çš„æ–‡ä»¶ç®¡ç†å™¨Appè¦æ€ä¹ˆåŠ???
</code></pre>
<p>Androidçš„å­˜å‚¨æƒé™ç»å†äº†ä¸€åœºé©å‘½æ€§çš„å˜åŒ–ã€‚ä»Android 10å¼€å§‹å¼•å…¥çš„<strong>Scoped Storage</strong>(åˆ†åŒºå­˜å‚¨),åˆ°Android 11å¼ºåˆ¶æ‰§è¡Œ,å†åˆ°Android 15çš„æŒç»­ä¼˜åŒ–â€”â€”è¿™ä¸€åˆ‡çš„èƒŒå,éƒ½ç¦»ä¸å¼€ä¸€ä¸ªå…³é”®æŠ€æœ¯:<strong>FUSE(Filesystem in Userspace)</strong>ã€‚</p>
<p>ä½œä¸ºä¸€ä¸ªè¿è¡Œåœ¨ç”¨æˆ·ç©ºé—´çš„æ–‡ä»¶ç³»ç»Ÿ,FUSEè®©Androidèƒ½å¤Ÿ:</p>
<ul>
<li>ğŸ›¡ï¸ <strong>ç»†ç²’åº¦æƒé™æ§åˆ¶</strong>: åœ¨æ–‡ä»¶è®¿é—®æ—¶åŠ¨æ€æ£€æŸ¥æƒé™,è€Œéä¾èµ–ä¼ ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿæƒé™</li>
<li>ğŸ”’ <strong>åº”ç”¨æ•°æ®éš”ç¦»</strong>: æ¯ä¸ªåº”ç”¨åªèƒ½çœ‹åˆ°è‡ªå·±çš„æ•°æ®,æ— æ³•éšæ„è®¿é—®å…¶ä»–åº”ç”¨çš„ç§æœ‰æ–‡ä»¶</li>
<li>ğŸ“Š <strong>é€æ˜çš„è·¯å¾„æ˜ å°„</strong>: åº”ç”¨çœ‹åˆ°çš„æ˜¯<code>/storage/emulated/0</code>,å®é™…è®¿é—®çš„æ˜¯<code>/data/media/0</code></li>
<li>âš¡ <strong>æ€§èƒ½ä¼˜åŒ–</strong>: Android 15å¼•å…¥FUSE Passthrough,å¤§å¹…é™ä½æ€§èƒ½å¼€é”€</li>
</ul>
<p>æœ¬æ–‡å°†åŸºäº<strong>Android 15 (AOSP 15.0)</strong> çš„æºç ,æ·±å…¥å‰–æFUSEæ–‡ä»¶ç³»ç»Ÿçš„å·¥ä½œåŸç†ã€MediaProviderçš„åä½œæœºåˆ¶ã€Scoped Storageçš„æƒé™æ¨¡å‹,ä»¥åŠæœ€æ–°çš„æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ã€‚</p>
<blockquote>
<p>ğŸ’¡ <strong>æºç è·¯å¾„</strong>: æœ¬æ–‡åˆ†æçš„æºç ä¸»è¦ä½äº <code>frameworks/base/core/jni/</code> (FUSE Daemon)ã€<code>packages/providers/MediaProvider/</code> (MediaProvider)</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">ä¸€ã€FUSE:ç”¨æˆ·ç©ºé—´çš„æ–‡ä»¶ç³»ç»Ÿé­”æ³•</h2>
<h3 data-id="heading-2">1.1 ä¸ºä»€ä¹ˆéœ€è¦FUSE?</h3>
<p>åœ¨Android 10ä¹‹å‰,Androidä½¿ç”¨ä¼ ç»Ÿçš„Linuxæ–‡ä»¶æƒé™ç³»ç»Ÿ:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¼ ç»Ÿæ–¹å¼:/sdcardç›®å½•å¯¹æ‰€æœ‰åº”ç”¨å¯è¯»å†™</span>
$ <span class="hljs-built_in">ls</span> -ld /sdcard
drwxrwx--x 15 root sdcard_rw 4096 2026-01-20 10:00 /sdcard

<span class="hljs-comment"># åªè¦æœ‰WRITE_EXTERNAL_STORAGEæƒé™,åº”ç”¨å¯ä»¥éšæ„è®¿é—®</span>
$ <span class="hljs-built_in">ls</span> /sdcard/DCIM/
Camera/  Screenshots/  WhatsApp/  Instagram/  ...
</code></pre>
<p><strong>è¿™ç§æ–¹å¼çš„é—®é¢˜</strong>:</p>
<ul>
<li>âŒ <strong>éšç§æ³„éœ²</strong>: åº”ç”¨Aå¯ä»¥è¯»å–åº”ç”¨Bä¿å­˜çš„ç…§ç‰‡</li>
<li>âŒ <strong>å­˜å‚¨æ··ä¹±</strong>: å¸è½½åº”ç”¨åç•™ä¸‹å¤§é‡åƒåœ¾æ–‡ä»¶</li>
<li>âŒ <strong>æƒé™ç²—æ”¾</strong>: è¦ä¹ˆå…¨éƒ¨è®¿é—®,è¦ä¹ˆå®Œå…¨ç¦æ­¢</li>
</ul>
<p><strong>FUSEçš„è§£å†³æ–¹æ¡ˆ</strong>:</p>
<ul>
<li>âœ… <strong>åŠ¨æ€æƒé™æ£€æŸ¥</strong>: åœ¨æ–‡ä»¶è®¿é—®æ—¶å®æ—¶æ£€æŸ¥æƒé™</li>
<li>âœ… <strong>è·¯å¾„è™šæ‹ŸåŒ–</strong>: åº”ç”¨çœ‹åˆ°çš„è·¯å¾„ä¸å®é™…è·¯å¾„ä¸åŒ</li>
<li>âœ… <strong>çµæ´»çš„è®¿é—®æ§åˆ¶</strong>: å¯ä»¥é’ˆå¯¹ä¸åŒåº”ç”¨ã€ä¸åŒæ–‡ä»¶å®æ–½ä¸åŒç­–ç•¥</li>
</ul>
<h3 data-id="heading-3">1.2 FUSEæ¶æ„å…¨æ™¯</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b966373a784046aa837be4a1dd77f5e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769784201&amp;x-signature=h8TiBWnCunUYkx85Mecz7YJzyug%3D" alt="05-01-fuse-architecture.png" loading="lazy"/></p>
<p>FUSEçš„æ ¸å¿ƒæ€æƒ³æ˜¯:å°†æ–‡ä»¶ç³»ç»Ÿçš„å®ç°ä»å†…æ ¸ç©ºé—´ç§»åˆ°ç”¨æˆ·ç©ºé—´,é€šè¿‡ä¸€ä¸ªç‰¹æ®Šçš„å†…æ ¸æ¨¡å—(<code>/dev/fuse</code>)åœ¨å†…æ ¸å’Œç”¨æˆ·ç©ºé—´ä¹‹é—´ä¼ é€’æ–‡ä»¶æ“ä½œè¯·æ±‚ã€‚</p>
<p><strong>äº”å±‚æ¶æ„</strong>:</p>
<h4 data-id="heading-4"><strong>åº”ç”¨å±‚</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åº”ç”¨ä½¿ç”¨æ ‡å‡†File API</span>
<span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">"/storage/emulated/0/Pictures/photo.jpg"</span>);
<span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(file);
</code></pre>
<p>åº”ç”¨å®Œå…¨ä¸çŸ¥é“åº•å±‚ä½¿ç”¨äº†FUSE,é€æ˜è®¿é—®ã€‚</p>
<h4 data-id="heading-5"><strong>Frameworkå±‚</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// MediaStore API (æ¨èæ–¹å¼)</span>
<span class="hljs-type">ContentResolver</span> <span class="hljs-variable">resolver</span> <span class="hljs-operator">=</span> getContentResolver();
<span class="hljs-type">Uri</span> <span class="hljs-variable">imageUri</span> <span class="hljs-operator">=</span> MediaStore.Images.Media.EXTERNAL_CONTENT_URI;
<span class="hljs-type">Cursor</span> <span class="hljs-variable">cursor</span> <span class="hljs-operator">=</span> resolver.query(imageUri, ...);
</code></pre>
<p>æä¾›é«˜çº§API,è‡ªåŠ¨å¤„ç†æƒé™å’ŒURIã€‚</p>
<h4 data-id="heading-6"><strong>MediaProviderå±‚ (æ ¸å¿ƒ)</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// packages/providers/MediaProvider/src/com/android/providers/media/MediaProvider.java</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MediaProvider</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ContentProvider</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> ParcelFileDescriptor <span class="hljs-title function_">openFile</span><span class="hljs-params">(Uri uri, String mode)</span> {
        <span class="hljs-comment">// 1. æƒé™æ£€æŸ¥</span>
        enforceCallingPermission();

        <span class="hljs-comment">// 2. URI â†’ æ–‡ä»¶è·¯å¾„è½¬æ¢</span>
        <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> getFileForUri(uri);

        <span class="hljs-comment">// 3. æ‰“å¼€æ–‡ä»¶</span>
        <span class="hljs-keyword">return</span> ParcelFileDescriptor.open(file, parseMode(mode));
    }
}
</code></pre>
<h4 data-id="heading-7"><strong>å†…æ ¸FUSEå±‚</strong></h4>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// kernel/fs/fuse/file.c</span>
<span class="hljs-type">static</span> <span class="hljs-type">ssize_t</span> <span class="hljs-title function_">fuse_file_read_iter</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> kiocb *iocb, <span class="hljs-keyword">struct</span> iov_iter *to)</span> {
    <span class="hljs-comment">// å°†readè¯·æ±‚è½¬å‘åˆ°ç”¨æˆ·ç©ºé—´çš„FUSE Daemon</span>
    <span class="hljs-keyword">return</span> fuse_direct_io(iocb, to, FUSE_READ);
}
</code></pre>
<h4 data-id="heading-8"><strong>å®é™…å­˜å‚¨å±‚</strong></h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åº”ç”¨çœ‹åˆ°çš„è·¯å¾„</span>
/storage/emulated/0/Pictures/photo.jpg

<span class="hljs-comment"># å®é™…å­˜å‚¨è·¯å¾„</span>
/data/media/0/Pictures/photo.jpg
</code></pre>
<h3 data-id="heading-9">1.3 FUSE Daemonçš„å¯åŠ¨</h3>
<p>FUSE Daemonåœ¨Androidä¸­ä½œä¸ºMediaProviderçš„ä¸€éƒ¨åˆ†è¿è¡Œã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¯åŠ¨æµç¨‹:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// frameworks/base/core/jni/com_android_internal_os_FuseDaemon.cpp</span>
<span class="hljs-function"><span class="hljs-type">static</span> jboolean <span class="hljs-title">com_android_internal_os_FuseDaemon_start</span><span class="hljs-params">(
        JNIEnv* env, jobject self, jint fd, jstring path)</span> </span>{
    <span class="hljs-comment">// 1. æ‰“å¼€/dev/fuseè®¾å¤‡</span>
    <span class="hljs-type">int</span> fuse_fd = <span class="hljs-built_in">open</span>(<span class="hljs-string">"/dev/fuse"</span>, O_RDWR | O_CLOEXEC);

    <span class="hljs-comment">// 2. æŒ‚è½½FUSEæ–‡ä»¶ç³»ç»Ÿ</span>
    <span class="hljs-built_in">mount</span>(<span class="hljs-literal">nullptr</span>, mount_point, <span class="hljs-string">"fuse"</span>,
          MS_NOSUID | MS_NODEV | MS_NOEXEC | MS_NOATIME,
          options);

    <span class="hljs-comment">// 3. å¯åŠ¨FUSEå¤„ç†çº¿ç¨‹</span>
    <span class="hljs-function">std::thread <span class="hljs-title">fuse_thread</span><span class="hljs-params">([fuse_fd, mp]() {
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            <span class="hljs-comment">// ä»/dev/fuseè¯»å–è¯·æ±‚</span>
            fuse_in_header* in = read_fuse_request(fuse_fd);

            <span class="hljs-comment">// å¤„ç†è¯·æ±‚</span>
            <span class="hljs-keyword">switch</span> (in-&gt;opcode) {
                <span class="hljs-keyword">case</span> FUSE_LOOKUP:
                    handle_fuse_lookup(in);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> FUSE_OPEN:
                    handle_fuse_open(in);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> FUSE_READ:
                    handle_fuse_read(in);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> FUSE_WRITE:
                    handle_fuse_write(in);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-comment">// ... æ›´å¤šæ“ä½œ</span>
            }

            <span class="hljs-comment">// å†™å›å“åº”</span>
            write_fuse_response(fuse_fd, out);
        }
    })</span></span>;

    <span class="hljs-keyword">return</span> JNI_TRUE;
}
</code></pre>
<p><strong>å¯åŠ¨æ—¶çš„å…³é”®æ“ä½œ</strong>:</p>
<ol>
<li>æ‰“å¼€<code>/dev/fuse</code>è®¾å¤‡æ–‡ä»¶</li>
<li>ä½¿ç”¨<code>mount()</code>ç³»ç»Ÿè°ƒç”¨æŒ‚è½½FUSEæ–‡ä»¶ç³»ç»Ÿåˆ°<code>/storage/emulated/0</code></li>
<li>å¯åŠ¨ä¸€ä¸ªå¸¸é©»çº¿ç¨‹,å¾ªç¯å¤„ç†æ–‡ä»¶æ“ä½œè¯·æ±‚</li>
</ol>
<h3 data-id="heading-10">1.4 FUSEæ“ä½œå¤„ç†ç¤ºä¾‹:è¯»å–æ–‡ä»¶</h3>
<p>è®©æˆ‘ä»¬è·Ÿè¸ªä¸€ä¸ªå®Œæ•´çš„æ–‡ä»¶è¯»å–æµç¨‹:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// 1. åº”ç”¨å±‚:è¯»å–æ–‡ä»¶</span>
File file = <span class="hljs-keyword">new</span> <span class="hljs-built_in">File</span>(<span class="hljs-string">"/storage/emulated/0/DCIM/photo.jpg"</span>);
FileInputStream fis = <span class="hljs-keyword">new</span> <span class="hljs-built_in">FileInputStream</span>(file); <span class="hljs-comment">// â†’ open()ç³»ç»Ÿè°ƒç”¨</span>
byte[] buffer = <span class="hljs-keyword">new</span> byte[<span class="hljs-number">1024</span>];
fis.<span class="hljs-built_in">read</span>(buffer); <span class="hljs-comment">// â†’ read()ç³»ç»Ÿè°ƒç”¨</span>

<span class="hljs-comment">// 2. å†…æ ¸å±‚:FUSEæ¨¡å—æ¥æ”¶è¯·æ±‚</span>
<span class="hljs-comment">// kernel/fs/fuse/file.c</span>
<span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">ssize_t</span> <span class="hljs-title">fuse_file_read_iter</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> kiocb *iocb, <span class="hljs-keyword">struct</span> iov_iter *to)</span> </span>{
    <span class="hljs-comment">// æ„é€ FUSE_READè¯·æ±‚</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">fuse_read_in</span> inarg = {
        .fh = file-&gt;fh,
        .offset = iocb-&gt;ki_pos,
        .size = <span class="hljs-built_in">iov_iter_count</span>(to),
    };

    <span class="hljs-comment">// å‘é€åˆ°FUSE Daemon</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">fuse_simple_request</span>(fc, &amp;args);
}

<span class="hljs-comment">// 3. FUSE Daemon:å¤„ç†è¯»è¯·æ±‚</span>
<span class="hljs-comment">// frameworks/base/core/jni/com_android_internal_os_FuseDaemon.cpp</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">handle_fuse_read</span><span class="hljs-params">(<span class="hljs-type">const</span> fuse_in_header* in, <span class="hljs-type">const</span> fuse_read_in* read_in)</span> </span>{
    <span class="hljs-comment">// è·¯å¾„æ˜ å°„</span>
    <span class="hljs-comment">// /storage/emulated/0/DCIM/photo.jpg â†’ /data/media/0/DCIM/photo.jpg</span>
    std::string real_path = <span class="hljs-built_in">transform_path</span>(in-&gt;nodeid);

    <span class="hljs-comment">// æ‰“å¼€çœŸå®æ–‡ä»¶</span>
    <span class="hljs-type">int</span> fd = <span class="hljs-built_in">open</span>(real_path.<span class="hljs-built_in">c_str</span>(), O_RDONLY);

    <span class="hljs-comment">// è¯»å–æ•°æ®</span>
    <span class="hljs-type">ssize_t</span> bytes_read = <span class="hljs-built_in">pread</span>(fd, buffer, read_in-&gt;size, read_in-&gt;offset);

    <span class="hljs-comment">// æ„é€ å“åº”</span>
    fuse_out_header out = {
        .len = <span class="hljs-built_in">sizeof</span>(fuse_out_header) + bytes_read,
        .error = <span class="hljs-number">0</span>,
        .unique = in-&gt;unique,
    };

    <span class="hljs-comment">// å†™å›å†…æ ¸</span>
    <span class="hljs-built_in">write</span>(fuse_fd, &amp;out, <span class="hljs-built_in">sizeof</span>(out));
    <span class="hljs-built_in">write</span>(fuse_fd, buffer, bytes_read);
}
</code></pre>
<p><strong>æ•°æ®æµå‘</strong>:</p>
<ol>
<li>åº”ç”¨è°ƒç”¨<code>read()</code> â†’ è¿›å…¥å†…æ ¸VFSå±‚</li>
<li>VFSè¯†åˆ«æ˜¯FUSEæ–‡ä»¶ç³»ç»Ÿ â†’ è½¬å‘åˆ°FUSEæ¨¡å—</li>
<li>FUSEæ¨¡å—æ„é€ è¯·æ±‚ â†’ å†™å…¥<code>/dev/fuse</code></li>
<li>FUSE Daemonè¯»å–è¯·æ±‚ â†’ æ‰§è¡Œè·¯å¾„æ˜ å°„å’Œæƒé™æ£€æŸ¥</li>
<li>FUSE Daemonæ‰“å¼€çœŸå®æ–‡ä»¶ â†’ è¯»å–æ•°æ®</li>
<li>FUSE Daemonå†™å›å“åº” â†’ FUSEæ¨¡å—æ¥æ”¶</li>
<li>FUSEæ¨¡å—è¿”å›æ•°æ® â†’ VFS â†’ åº”ç”¨</li>
</ol>
<hr/>
<h2 data-id="heading-11">äºŒã€Scoped Storage:åº”ç”¨å­˜å‚¨çš„æ–°ç§©åº</h2>
<h3 data-id="heading-12">2.1 Scoped Storageæƒé™æ¨¡å‹</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7d4438726a4c40a895ce11734c4f8d44~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769784201&amp;x-signature=Rk8%2FN%2FzTuHOpYPEd8Nws1C2Yagg%3D" alt="05-02-scoped-storage-model.png" loading="lazy"/></p>
<p>Scoped Storageå°†å¤–éƒ¨å­˜å‚¨åˆ’åˆ†ä¸ºå››ä¸ªåŒºåŸŸ,æ¯ä¸ªåŒºåŸŸæœ‰ä¸åŒçš„è®¿é—®è§„åˆ™:</p>
<h4 data-id="heading-13"><strong>åŒºåŸŸ1: App-specificç›®å½• (å®Œå…¨ç§æœ‰)</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è·å–åº”ç”¨ç§æœ‰ç›®å½•</span>
<span class="hljs-type">File</span> <span class="hljs-variable">appDir</span> <span class="hljs-operator">=</span> context.getExternalFilesDir(<span class="hljs-literal">null</span>);
<span class="hljs-comment">// /storage/emulated/0/Android/data/com.example.app/files/</span>

<span class="hljs-type">File</span> <span class="hljs-variable">cacheDir</span> <span class="hljs-operator">=</span> context.getExternalCacheDir();
<span class="hljs-comment">// /storage/emulated/0/Android/data/com.example.app/cache/</span>
</code></pre>
<p><strong>ç‰¹ç‚¹</strong>:</p>
<ul>
<li>âœ… <strong>æ— éœ€æƒé™</strong>: åº”ç”¨å¯ä»¥è‡ªç”±è¯»å†™</li>
<li>âœ… <strong>å®Œå…¨éš”ç¦»</strong>: å…¶ä»–åº”ç”¨æ— æ³•è®¿é—®</li>
<li>âœ… <strong>è‡ªåŠ¨æ¸…ç†</strong>: åº”ç”¨å¸è½½æ—¶è‡ªåŠ¨åˆ é™¤</li>
</ul>
<p><strong>å®ç°åŸç†</strong>:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// FUSE Daemonä¸­çš„æƒé™æ£€æŸ¥</span>
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">FuseDaemon::check_access</span><span class="hljs-params">(<span class="hljs-type">uid_t</span> uid, <span class="hljs-type">const</span> std::string&amp; path)</span> </span>{
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ˜¯App-specificç›®å½•</span>
    <span class="hljs-keyword">if</span> (path.<span class="hljs-built_in">find</span>(<span class="hljs-string">"/Android/data/"</span>) != std::string::npos) {
        <span class="hljs-comment">// æå–åŒ…å</span>
        std::string package = <span class="hljs-built_in">extract_package_name</span>(path);

        <span class="hljs-comment">// æ£€æŸ¥UIDæ˜¯å¦åŒ¹é…</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">get_package_uid</span>(package) == uid) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// æ— éœ€æƒé™æ£€æŸ¥</span>
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// æ‹’ç»è®¿é—®</span>
    }

    <span class="hljs-comment">// å…¶ä»–ç›®å½•éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">check_media_permission</span>(uid, path);
}
</code></pre>
<h4 data-id="heading-14"><strong>åŒºåŸŸ2: åª’ä½“å…±äº«ç›®å½• (éƒ¨åˆ†å…±äº«)</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é€šè¿‡MediaStoreè®¿é—®å›¾ç‰‡</span>
<span class="hljs-type">ContentResolver</span> <span class="hljs-variable">resolver</span> <span class="hljs-operator">=</span> getContentResolver();
<span class="hljs-type">Uri</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> MediaStore.Images.Media.EXTERNAL_CONTENT_URI;

<span class="hljs-comment">// æ’å…¥æ–°å›¾ç‰‡</span>
<span class="hljs-type">ContentValues</span> <span class="hljs-variable">values</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ContentValues</span>();
values.put(MediaStore.Images.Media.DISPLAY_NAME, <span class="hljs-string">"photo.jpg"</span>);
values.put(MediaStore.Images.Media.MIME_TYPE, <span class="hljs-string">"image/jpeg"</span>);
values.put(MediaStore.Images.Media.RELATIVE_PATH, Environment.DIRECTORY_PICTURES);

<span class="hljs-type">Uri</span> <span class="hljs-variable">imageUri</span> <span class="hljs-operator">=</span> resolver.insert(uri, values);
</code></pre>
<p><strong>è®¿é—®è§„åˆ™</strong>:</p>
<ul>
<li>âœ… <strong>è‡ªå·±åˆ›å»ºçš„</strong>: æ— éœ€æƒé™,ç›´æ¥è®¿é—®</li>
<li>âš ï¸ <strong>å…¶ä»–åº”ç”¨çš„</strong>: éœ€è¦<code>READ_EXTERNAL_STORAGE</code>æƒé™</li>
<li>âš ï¸ <strong>ä¿®æ”¹/åˆ é™¤</strong>: Android 11+éœ€è¦ç”¨æˆ·ç¡®è®¤</li>
</ul>
<p><strong>MediaProviderçš„æƒé™æ£€æŸ¥</strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// packages/providers/MediaProvider/src/com/android/providers/media/MediaProvider.java</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">checkPermission</span><span class="hljs-params">(Uri uri, <span class="hljs-type">int</span> mode)</span> {
    <span class="hljs-comment">// 1. æ£€æŸ¥æ˜¯å¦æ˜¯è‡ªå·±åˆ›å»ºçš„æ–‡ä»¶</span>
    <span class="hljs-type">long</span> <span class="hljs-variable">ownerId</span> <span class="hljs-operator">=</span> queryOwnerPackageId(uri);
    <span class="hljs-keyword">if</span> (ownerId == Binder.getCallingUid()) {
        <span class="hljs-keyword">return</span>; <span class="hljs-comment">// æ— éœ€æƒé™</span>
    }

    <span class="hljs-comment">// 2. æ£€æŸ¥READ_EXTERNAL_STORAGEæƒé™</span>
    <span class="hljs-keyword">if</span> ((mode &amp; MODE_READ_ONLY) != <span class="hljs-number">0</span>) {
        enforceCallingPermission(
            android.Manifest.permission.READ_EXTERNAL_STORAGE,
            <span class="hljs-string">"Read permission required"</span>);
    }

    <span class="hljs-comment">// 3. å†™å…¥éœ€è¦é¢å¤–æ£€æŸ¥</span>
    <span class="hljs-keyword">if</span> ((mode &amp; MODE_WRITE_ONLY) != <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// Android 11+éœ€è¦ç”¨æˆ·ç¡®è®¤å¯¹è¯æ¡†</span>
        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.R) {
            requestUserConsent(uri);
        }
    }
}
</code></pre>
<h4 data-id="heading-15"><strong>åŒºåŸŸ3: Documentså’Œå…¶ä»–å…±äº«ç›®å½• (éœ€è¦SAF)</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä½¿ç”¨SAF(Storage Access Framework)è®¿é—®æ–‡æ¡£</span>
<span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(Intent.ACTION_OPEN_DOCUMENT);
intent.setType(<span class="hljs-string">"application/pdf"</span>);
intent.addCategory(Intent.CATEGORY_OPENABLE);
startActivityForResult(intent, REQUEST_CODE);

<span class="hljs-comment">// åœ¨onActivityResultä¸­è·å–URI</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onActivityResult</span><span class="hljs-params">(<span class="hljs-type">int</span> requestCode, <span class="hljs-type">int</span> resultCode, Intent data)</span> {
    <span class="hljs-keyword">if</span> (requestCode == REQUEST_CODE &amp;&amp; resultCode == RESULT_OK) {
        <span class="hljs-type">Uri</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> data.getData();

        <span class="hljs-comment">// æŒä¹…åŒ–æƒé™(å¯é€‰)</span>
        getContentResolver().takePersistableUriPermission(
            uri, Intent.FLAG_GRANT_READ_URI_PERMISSION);

        <span class="hljs-comment">// ä½¿ç”¨URIè®¿é—®æ–‡ä»¶</span>
        <span class="hljs-type">InputStream</span> <span class="hljs-variable">is</span> <span class="hljs-operator">=</span> getContentResolver().openInputStream(uri);
    }
}
</code></pre>
<p><strong>SAFçš„ä¼˜åŠ¿</strong>:</p>
<ul>
<li>ğŸ¯ <strong>ç”¨æˆ·ä¸»å¯¼</strong>: ç”¨æˆ·æ˜ç¡®é€‰æ‹©æˆæƒçš„æ–‡ä»¶/ç›®å½•</li>
<li>ğŸ”’ <strong>ç»†ç²’åº¦æ§åˆ¶</strong>: åªæˆæƒç‰¹å®šçš„æ–‡ä»¶,è€Œéæ•´ä¸ªç›®å½•</li>
<li>ğŸ’¾ <strong>è·¨åº”ç”¨å…±äº«</strong>: å¯ä»¥è®¿é—®å…¶ä»–åº”ç”¨æä¾›çš„æ–‡æ¡£</li>
</ul>
<h3 data-id="heading-16">2.2 MediaProviderçš„æ ¸å¿ƒè§’è‰²</h3>
<p>MediaProvideræ˜¯Scoped Storageå®ç°çš„æ ¸å¿ƒç»„ä»¶,è´Ÿè´£:</p>
<h4 data-id="heading-17"><strong>1. åª’ä½“åº“ç®¡ç†</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ‰«ææ–°æ–‡ä»¶å¹¶æ·»åŠ åˆ°åª’ä½“åº“</span>
MediaScannerConnection.scanFile(context,
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[] { file.getAbsolutePath() },
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[] { <span class="hljs-string">"image/jpeg"</span> },
    (path, uri) -&gt; {
        Log.d(TAG, <span class="hljs-string">"Scanned: "</span> + uri);
    });
</code></pre>
<p><strong>å®ç°åŸç†</strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// packages/providers/MediaProvider/src/com/android/providers/media/scan/ModernMediaScanner.java</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">scanFile</span><span class="hljs-params">(File file)</span> {
    <span class="hljs-comment">// 1. è¯»å–æ–‡ä»¶å…ƒæ•°æ®</span>
    <span class="hljs-type">MediaMetadataRetriever</span> <span class="hljs-variable">retriever</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MediaMetadataRetriever</span>();
    retriever.setDataSource(file.getAbsolutePath());

    <span class="hljs-comment">// 2. æå–ä¿¡æ¯</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">title</span> <span class="hljs-operator">=</span> retriever.extractMetadata(METADATA_KEY_TITLE);
    <span class="hljs-type">String</span> <span class="hljs-variable">artist</span> <span class="hljs-operator">=</span> retriever.extractMetadata(METADATA_KEY_ARTIST);
    <span class="hljs-type">long</span> <span class="hljs-variable">duration</span> <span class="hljs-operator">=</span> Long.parseLong(
        retriever.extractMetadata(METADATA_KEY_DURATION));

    <span class="hljs-comment">// 3. æ’å…¥æ•°æ®åº“</span>
    <span class="hljs-type">ContentValues</span> <span class="hljs-variable">values</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ContentValues</span>();
    values.put(MediaStore.Audio.Media.TITLE, title);
    values.put(MediaStore.Audio.Media.ARTIST, artist);
    values.put(MediaStore.Audio.Media.DURATION, duration);
    values.put(MediaStore.Audio.Media.DATA, file.getAbsolutePath());

    getContext().getContentResolver().insert(
        MediaStore.Audio.Media.EXTERNAL_CONTENT_URI, values);
}
</code></pre>
<h4 data-id="heading-18"><strong>2. æƒé™æ‰§è¡Œ</strong></h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c0c7f14ed2b4f1186abc14669d82c41~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769784201&amp;x-signature=Rzz9Lb%2FmBAWoa%2B%2FZbyRG1qBnymQ%3D" alt="05-03-mediaprovider-file-access-sequence.png" loading="lazy"/></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// packages/providers/MediaProvider/src/com/android/providers/media/MediaProvider.java</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> ParcelFileDescriptor <span class="hljs-title function_">openFile</span><span class="hljs-params">(Uri uri, String mode)</span> {
    <span class="hljs-comment">// 1. è§£æURI</span>
    <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> ContentUris.parseId(uri);
    <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">mimeType</span> <span class="hljs-operator">=</span> getType(uri);

    <span class="hljs-comment">// 2. æŸ¥è¯¢æ–‡ä»¶ä¿¡æ¯</span>
    <span class="hljs-type">Cursor</span> <span class="hljs-variable">cursor</span> <span class="hljs-operator">=</span> query(uri, <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[] {
        MediaStore.MediaColumns.DATA,
        MediaStore.MediaColumns.OWNER_PACKAGE_NAME
    }, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);

    cursor.moveToFirst();
    <span class="hljs-type">String</span> <span class="hljs-variable">filePath</span> <span class="hljs-operator">=</span> cursor.getString(<span class="hljs-number">0</span>);
    <span class="hljs-type">String</span> <span class="hljs-variable">ownerPackage</span> <span class="hljs-operator">=</span> cursor.getString(<span class="hljs-number">1</span>);

    <span class="hljs-comment">// 3. æƒé™æ£€æŸ¥</span>
    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">callingUid</span> <span class="hljs-operator">=</span> Binder.getCallingUid();
    <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">callingPackage</span> <span class="hljs-operator">=</span> getCallingPackage();

    <span class="hljs-comment">// 3.1 æ£€æŸ¥æ˜¯å¦æ˜¯æ–‡ä»¶æ‰€æœ‰è€…</span>
    <span class="hljs-keyword">if</span> (ownerPackage.equals(callingPackage)) {
        <span class="hljs-comment">// æ‰€æœ‰è€…æ— éœ€æƒé™æ£€æŸ¥</span>
        <span class="hljs-keyword">return</span> ParcelFileDescriptor.open(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(filePath), parseMode(mode));
    }

    <span class="hljs-comment">// 3.2 æ£€æŸ¥READ/WRITEæƒé™</span>
    <span class="hljs-keyword">if</span> (mode.contains(<span class="hljs-string">"r"</span>)) {
        enforceCallingPermission(
            android.Manifest.permission.READ_EXTERNAL_STORAGE,
            <span class="hljs-string">"Read permission required for "</span> + uri);
    }

    <span class="hljs-keyword">if</span> (mode.contains(<span class="hljs-string">"w"</span>)) {
        <span class="hljs-comment">// Android 11+éœ€è¦ç”¨æˆ·ç¡®è®¤</span>
        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.R) {
            <span class="hljs-type">PendingIntent</span> <span class="hljs-variable">pendingIntent</span> <span class="hljs-operator">=</span> createWriteRequestIntent(uri);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RecoverableSecurityException</span>(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecurityException</span>(<span class="hljs-string">"Write permission required"</span>),
                <span class="hljs-string">"Allow "</span> + callingPackage + <span class="hljs-string">" to modify this file?"</span>,
                pendingIntent);
        }
    }

    <span class="hljs-comment">// 4. æ‰“å¼€æ–‡ä»¶</span>
    <span class="hljs-keyword">return</span> ParcelFileDescriptor.open(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(filePath), parseMode(mode));
}
</code></pre>
<h4 data-id="heading-19"><strong>3. è·¯å¾„è½¬æ¢</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// URI â†’ æ–‡ä»¶è·¯å¾„</span>
content:<span class="hljs-comment">//media/external/images/media/1000</span>
    â†“
/storage/emulated/<span class="hljs-number">0</span>/Pictures/IMG_20260120_100000.jpg
    â†“ (FUSE Daemonæ˜ å°„)
/data/media/<span class="hljs-number">0</span>/Pictures/IMG_20260120_100000.jpg (çœŸå®è·¯å¾„)
</code></pre>
<hr/>
<h2 data-id="heading-20">ä¸‰ã€FUSE Passthrough:æ€§èƒ½é©å‘½</h2>
<h3 data-id="heading-21">3.1 ä¼ ç»ŸFUSEçš„æ€§èƒ½ç“¶é¢ˆ</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97765aee5ab24af695e84b801128fb8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769784201&amp;x-signature=5I24UBchwR7rP3DmX8jJgYvi%2Fug%3D" alt="05-04-fuse-passthrough-comparison.png" loading="lazy"/></p>
<p>ä¼ ç»ŸFUSEçš„æœ€å¤§é—®é¢˜æ˜¯<strong>æ€§èƒ½å¼€é”€</strong>:</p>
<pre><code class="hljs language-scss" lang="scss">åº”ç”¨<span class="hljs-built_in">read</span>()  â†’  VFS  â†’  FUSEæ¨¡å—  â†’  <span class="hljs-selector-attr">[ä¸Šä¸‹æ–‡åˆ‡æ¢1]</span>  â†’  FUSE Daemon
                                                         â†“ å¤„ç†è¯·æ±‚
    â†‘                                             <span class="hljs-selector-attr">[ä¸Šä¸‹æ–‡åˆ‡æ¢2]</span>
    |                                                    â†“
æ•°æ®è¿”å›  â†  VFS  â†  FUSEæ¨¡å—  â†  <span class="hljs-selector-attr">[ä¸Šä¸‹æ–‡åˆ‡æ¢3]</span>  â†  çœŸå®æ–‡ä»¶ç³»ç»Ÿ
                                  <span class="hljs-selector-attr">[ä¸Šä¸‹æ–‡åˆ‡æ¢4]</span>  â†  è¯»å–å®Œæˆ
</code></pre>
<p><strong>é—®é¢˜åˆ†æ</strong>:</p>
<ul>
<li>ğŸŒ <strong>4æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢</strong>: ç”¨æˆ·æ€â†”å†…æ ¸æ€é¢‘ç¹åˆ‡æ¢,æ¯æ¬¡åˆ‡æ¢çº¦1-2Î¼s</li>
<li>ğŸ“Š <strong>æ•°æ®å¤šæ¬¡æ‹·è´</strong>: å†…æ ¸â†’ç”¨æˆ·â†’å†…æ ¸,å¢åŠ CPUå’Œå†…å­˜å¼€é”€</li>
<li>â±ï¸ <strong>æ€§èƒ½æŸå¤±</strong>: ç›¸æ¯”ç›´æ¥æ–‡ä»¶è®¿é—®,æ€§èƒ½ä¸‹é™30-40%</li>
</ul>
<p><strong>æ€§èƒ½æµ‹è¯•æ•°æ®</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¼ ç»ŸFUSE</span>
$ <span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/storage/emulated/0/test.bin of=/dev/null bs=1M count=1000
1000+0 records <span class="hljs-keyword">in</span>
1000+0 records out
1048576000 bytes (1.0 GB) copied, 5.2 s, 202 MB/s

<span class="hljs-comment"># ç›´æ¥è®¿é—®/data/media/0</span>
$ <span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/data/media/0/test.bin of=/dev/null bs=1M count=1000
1000+0 records <span class="hljs-keyword">in</span>
1000+0 records out
1048576000 bytes (1.0 GB) copied, 3.5 s, 300 MB/s

<span class="hljs-comment"># æ€§èƒ½æŸå¤±: (5.2 - 3.5) / 3.5 = 48.6%</span>
</code></pre>
<h3 data-id="heading-22">3.2 FUSE Passthroughçš„å·¥ä½œåŸç†</h3>
<p>Android 15å¼•å…¥çš„FUSE Passthroughæœºåˆ¶,å…è®¸I/Oæ“ä½œ<strong>ç»•è¿‡ç”¨æˆ·ç©ºé—´</strong>,ç›´æ¥åœ¨å†…æ ¸ä¸­å®Œæˆ:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// kernel/fs/fuse/passthrough.c (Android 15æ–°å¢)</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">fuse_passthrough</span> {
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">file</span> *filp;  <span class="hljs-comment">// æŒ‡å‘çœŸå®æ–‡ä»¶çš„fileç»“æ„ä½“</span>
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">path</span> path;   <span class="hljs-comment">// çœŸå®æ–‡ä»¶çš„è·¯å¾„</span>
};

<span class="hljs-function"><span class="hljs-type">ssize_t</span> <span class="hljs-title">fuse_passthrough_read_iter</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> kiocb *iocb, <span class="hljs-keyword">struct</span> iov_iter *to)</span> </span>{
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">fuse_file</span> *ff = iocb-&gt;ki_filp-&gt;private_data;
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">file</span> *backing_file = ff-&gt;passthrough-&gt;filp;

    <span class="hljs-comment">// ç›´æ¥è°ƒç”¨çœŸå®æ–‡ä»¶ç³»ç»Ÿçš„readæ“ä½œ,æ— éœ€ç»è¿‡ç”¨æˆ·ç©ºé—´</span>
    <span class="hljs-keyword">return</span> backing_file-&gt;f_op-&gt;<span class="hljs-built_in">read_iter</span>(iocb, to);
}
</code></pre>
<p><strong>å¯ç”¨Passthroughçš„æµç¨‹</strong>:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// 1. MediaProvideræ‰“å¼€æ–‡ä»¶æ—¶è®¾ç½®Passthrough</span>
<span class="hljs-comment">// frameworks/base/core/jni/com_android_internal_os_FuseDaemon.cpp</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">handle_fuse_open</span><span class="hljs-params">(<span class="hljs-type">const</span> fuse_in_header* in, <span class="hljs-type">const</span> fuse_open_in* open_in)</span> </span>{
    <span class="hljs-comment">// æ‰“å¼€çœŸå®æ–‡ä»¶</span>
    std::string real_path = <span class="hljs-built_in">transform_path</span>(in-&gt;nodeid);
    <span class="hljs-type">int</span> backing_fd = <span class="hljs-built_in">open</span>(real_path.<span class="hljs-built_in">c_str</span>(), open_in-&gt;flags);

    <span class="hljs-comment">// æ„é€ å“åº”,åŒ…å«Passthroughä¿¡æ¯</span>
    fuse_open_out out = {
        .fh = <span class="hljs-built_in">allocate_file_handle</span>(backing_fd),
        .open_flags = FOPEN_PASSTHROUGH, <span class="hljs-comment">// å…³é”®æ ‡å¿—</span>
    };

    <span class="hljs-comment">// è®¾ç½®Passthroughæ˜ å°„</span>
    fuse_passthrough_out pt_out = {
        .fd = backing_fd, <span class="hljs-comment">// çœŸå®æ–‡ä»¶çš„FD</span>
    };

    <span class="hljs-built_in">write_fuse_response</span>(fuse_fd, &amp;out, <span class="hljs-built_in">sizeof</span>(out));
    <span class="hljs-built_in">write_fuse_response</span>(fuse_fd, &amp;pt_out, <span class="hljs-built_in">sizeof</span>(pt_out));
}

<span class="hljs-comment">// 2. å†…æ ¸FUSEæ¨¡å—æ¥æ”¶åˆ°Passthroughè®¾ç½®</span>
<span class="hljs-comment">// kernel/fs/fuse/file.c</span>
<span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title">fuse_open</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> inode *inode, <span class="hljs-keyword">struct</span> file *file)</span> </span>{
    <span class="hljs-comment">// ... å‘é€FUSE_OPENè¯·æ±‚ ...</span>

    <span class="hljs-comment">// æ¥æ”¶å“åº”</span>
    <span class="hljs-keyword">if</span> (out.open_flags &amp; FOPEN_PASSTHROUGH) {
        <span class="hljs-comment">// è®¾ç½®Passthrough</span>
        <span class="hljs-keyword">struct</span> <span class="hljs-title class_">file</span> *backing_file = <span class="hljs-built_in">fget</span>(pt_out.fd);
        ff-&gt;passthrough = <span class="hljs-built_in">kzalloc</span>(<span class="hljs-built_in">sizeof</span>(<span class="hljs-keyword">struct</span> fuse_passthrough), GFP_KERNEL);
        ff-&gt;passthrough-&gt;filp = backing_file;

        <span class="hljs-comment">// åç»­æ‰€æœ‰I/Oæ“ä½œå°†ç›´æ¥ä½¿ç”¨backing_file</span>
    }
}

<span class="hljs-comment">// 3. åç»­è¯»å†™æ“ä½œè‡ªåŠ¨ä½¿ç”¨Passthrough</span>
<span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">ssize_t</span> <span class="hljs-title">fuse_file_read_iter</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> kiocb *iocb, <span class="hljs-keyword">struct</span> iov_iter *to)</span> </span>{
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">fuse_file</span> *ff = iocb-&gt;ki_filp-&gt;private_data;

    <span class="hljs-keyword">if</span> (ff-&gt;passthrough) {
        <span class="hljs-comment">// Passthroughè·¯å¾„:ç›´æ¥è°ƒç”¨çœŸå®æ–‡ä»¶ç³»ç»Ÿ</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">fuse_passthrough_read_iter</span>(iocb, to);
    }

    <span class="hljs-comment">// ä¼ ç»Ÿè·¯å¾„:ç»è¿‡ç”¨æˆ·ç©ºé—´</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">fuse_direct_io</span>(iocb, to, FUSE_READ);
}
</code></pre>
<p><strong>Passthroughçš„ä¼˜åŠ¿</strong>:</p>
<pre><code class="hljs language-scss" lang="scss">åº”ç”¨<span class="hljs-built_in">read</span>()  â†’  VFS  â†’  FUSEæ¨¡å—  â†’  <span class="hljs-selector-attr">[æ£€æµ‹åˆ°Passthrough]</span>  â†’  çœŸå®æ–‡ä»¶ç³»ç»Ÿ
    â†‘                                                            â†“
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  æ•°æ®ç›´æ¥è¿”å›  â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   (å…¨ç¨‹åœ¨å†…æ ¸æ€,é›¶ä¸Šä¸‹æ–‡åˆ‡æ¢!)
</code></pre>
<ul>
<li>âš¡ <strong>é›¶ä¸Šä¸‹æ–‡åˆ‡æ¢</strong>: å…¨ç¨‹åœ¨å†…æ ¸æ€,æ— éœ€è¿›å…¥ç”¨æˆ·ç©ºé—´</li>
<li>ğŸš€ <strong>é›¶æ•°æ®æ‹·è´</strong>: æ•°æ®ç›´æ¥ä»æ–‡ä»¶ç³»ç»Ÿè¿”å›åº”ç”¨</li>
<li>ğŸ“ˆ <strong>æ€§èƒ½æå‡</strong>: æ¥è¿‘åŸç”Ÿæ–‡ä»¶ç³»ç»Ÿæ€§èƒ½(95%+)</li>
</ul>
<h3 data-id="heading-23">3.3 Passthroughçš„æ€§èƒ½æµ‹è¯•</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Android 15 with FUSE Passthrough</span>
$ <span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/storage/emulated/0/test.bin of=/dev/null bs=1M count=1000
1000+0 records <span class="hljs-keyword">in</span>
1000+0 records out
1048576000 bytes (1.0 GB) copied, 3.7 s, 283 MB/s

<span class="hljs-comment"># æ€§èƒ½å¯¹æ¯”:</span>
<span class="hljs-comment"># ç›´æ¥è®¿é—®:      300 MB/s (100%)</span>
<span class="hljs-comment"># Passthrough:   283 MB/s (94.3%)  â† å‡ ä¹æ— æŸè€—!</span>
<span class="hljs-comment"># ä¼ ç»ŸFUSE:      202 MB/s (67.3%)  â† æ˜æ˜¾æ…¢</span>
</code></pre>
<p><strong>å®é™…åº”ç”¨åœºæ™¯</strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è¯»å–å¤§å‹è§†é¢‘æ–‡ä»¶</span>
<span class="hljs-type">File</span> <span class="hljs-variable">video</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">"/storage/emulated/0/Movies/movie.mp4"</span>); <span class="hljs-comment">// 2GB</span>
<span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(video);

<span class="hljs-comment">// ä¼ ç»ŸFUSE: çº¦30ç§’è¯»å–å®Œæˆ</span>
<span class="hljs-comment">// Passthrough: çº¦20ç§’è¯»å–å®Œæˆ,æå‡33%!</span>
</code></pre>
<hr/>
<h2 data-id="heading-24">å››ã€Storage Access Framework (SAF)</h2>
<h3 data-id="heading-25">4.1 SAFçš„è®¾è®¡å“²å­¦</h3>
<p>SAFçš„æ ¸å¿ƒç†å¿µæ˜¯:<strong>ç”¨æˆ·ä¸»å¯¼,è€Œéåº”ç”¨ä¸»å¯¼</strong>ã€‚</p>
<p><strong>ä¼ ç»Ÿæ–¹å¼</strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åº”ç”¨ç›´æ¥è®¿é—®æ–‡ä»¶(éœ€è¦æƒé™)</span>
<span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">"/storage/emulated/0/Documents/important.pdf"</span>);
<span class="hljs-comment">// ç”¨æˆ·ä¸çŸ¥é“åº”ç”¨åœ¨è®¿é—®ä»€ä¹ˆæ–‡ä»¶</span>
</code></pre>
<p><strong>SAFæ–¹å¼</strong>:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// 1. åº”ç”¨è¯·æ±‚è®¿é—®æ–‡ä»¶</span>
<span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(Intent.ACTION_OPEN_DOCUMENT);
intent.setType(<span class="hljs-string">"application/pdf"</span>);
startActivityForResult(intent, REQUEST_CODE);

<span class="hljs-comment">// 2. ç³»ç»Ÿæ˜¾ç¤ºæ–‡ä»¶é€‰æ‹©å™¨,ç”¨æˆ·æ˜ç¡®é€‰æ‹©æ–‡ä»¶</span>
<span class="hljs-comment">// 3. åº”ç”¨åªèƒ½è®¿é—®ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶</span>
</code></pre>
<h3 data-id="heading-26">4.2 SAFå®Œæ•´å·¥ä½œæµç¨‹</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85fdc6e4fc45466a97d3fe8cdca5e3c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yas5aWHTGFi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769784201&amp;x-signature=0L7Cu6p%2FEEY%2Br%2BpBu3YS%2BtD0Xfg%3D" alt="05-05-saf-workflow-sequence.png" loading="lazy"/></p>
<p>è®©æˆ‘ä»¬å®ç°ä¸€ä¸ªå®Œæ•´çš„SAFæ–‡æ¡£è®¿é—®ç¤ºä¾‹:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DocumentAccessActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">REQUEST_OPEN_DOCUMENT</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">REQUEST_CREATE_DOCUMENT</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;

    <span class="hljs-comment">// 1. æ‰“å¼€å·²æœ‰æ–‡æ¡£</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">openDocument</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(Intent.ACTION_OPEN_DOCUMENT);
        intent.setType(<span class="hljs-string">"application/pdf"</span>);
        intent.addCategory(Intent.CATEGORY_OPENABLE);

        <span class="hljs-comment">// å¯é€‰:æŒ‡å®šåˆå§‹ç›®å½•</span>
        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {
            intent.putExtra(DocumentsContract.EXTRA_INITIAL_URI,
                DocumentsContract.buildDocumentUri(
                    <span class="hljs-string">"com.android.externalstorage.documents"</span>,
                    <span class="hljs-string">"primary:Documents"</span>));
        }

        startActivityForResult(intent, REQUEST_OPEN_DOCUMENT);
    }

    <span class="hljs-comment">// 2. åˆ›å»ºæ–°æ–‡æ¡£</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createDocument</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(Intent.ACTION_CREATE_DOCUMENT);
        intent.setType(<span class="hljs-string">"text/plain"</span>);
        intent.addCategory(Intent.CATEGORY_OPENABLE);
        intent.putExtra(Intent.EXTRA_TITLE, <span class="hljs-string">"mynote.txt"</span>);

        startActivityForResult(intent, REQUEST_CREATE_DOCUMENT);
    }

    <span class="hljs-comment">// 3. å¤„ç†ç»“æœ</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onActivityResult</span><span class="hljs-params">(<span class="hljs-type">int</span> requestCode, <span class="hljs-type">int</span> resultCode, Intent data)</span> {
        <span class="hljs-built_in">super</span>.onActivityResult(requestCode, resultCode, data);

        <span class="hljs-keyword">if</span> (resultCode != RESULT_OK) <span class="hljs-keyword">return</span>;

        <span class="hljs-type">Uri</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> data.getData();

        <span class="hljs-keyword">if</span> (requestCode == REQUEST_OPEN_DOCUMENT) {
            <span class="hljs-comment">// æŒä¹…åŒ–æƒé™(å¯é€‰)</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">takeFlags</span> <span class="hljs-operator">=</span> data.getFlags() &amp; (
                Intent.FLAG_GRANT_READ_URI_PERMISSION |
                Intent.FLAG_GRANT_WRITE_URI_PERMISSION);
            getContentResolver().takePersistableUriPermission(uri, takeFlags);

            <span class="hljs-comment">// è¯»å–æ–‡æ¡£</span>
            readDocument(uri);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (requestCode == REQUEST_CREATE_DOCUMENT) {
            <span class="hljs-comment">// å†™å…¥æ–‡æ¡£</span>
            writeDocument(uri, <span class="hljs-string">"Hello, SAF!"</span>);
        }
    }

    <span class="hljs-comment">// 4. è¯»å–æ–‡æ¡£</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readDocument</span><span class="hljs-params">(Uri uri)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">InputStream</span> <span class="hljs-variable">is</span> <span class="hljs-operator">=</span> getContentResolver().openInputStream(uri);
            <span class="hljs-type">BufferedReader</span> <span class="hljs-variable">reader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedReader</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(is));

            <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();
            String line;
            <span class="hljs-keyword">while</span> ((line = reader.readLine()) != <span class="hljs-literal">null</span>) {
                content.append(line).append(<span class="hljs-string">"\n"</span>);
            }

            Log.d(TAG, <span class="hljs-string">"Document content: "</span> + content.toString());
            reader.close();
        } <span class="hljs-keyword">catch</span> (IOException e) {
            Log.e(TAG, <span class="hljs-string">"Failed to read document"</span>, e);
        }
    }

    <span class="hljs-comment">// 5. å†™å…¥æ–‡æ¡£</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeDocument</span><span class="hljs-params">(Uri uri, String content)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">OutputStream</span> <span class="hljs-variable">os</span> <span class="hljs-operator">=</span> getContentResolver().openOutputStream(uri);
            os.write(content.getBytes());
            os.close();

            Log.d(TAG, <span class="hljs-string">"Document written successfully"</span>);
        } <span class="hljs-keyword">catch</span> (IOException e) {
            Log.e(TAG, <span class="hljs-string">"Failed to write document"</span>, e);
        }
    }

    <span class="hljs-comment">// 6. æŸ¥è¯¢æŒä¹…åŒ–çš„URIæƒé™</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">listPersistedUriPermissions</span><span class="hljs-params">()</span> {
        List&lt;UriPermission&gt; permissions =
            getContentResolver().getPersistedUriPermissions();

        <span class="hljs-keyword">for</span> (UriPermission permission : permissions) {
            <span class="hljs-type">Uri</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> permission.getUri();
            <span class="hljs-type">boolean</span> <span class="hljs-variable">canRead</span> <span class="hljs-operator">=</span> permission.isReadPermission();
            <span class="hljs-type">boolean</span> <span class="hljs-variable">canWrite</span> <span class="hljs-operator">=</span> permission.isWritePermission();

            Log.d(TAG, <span class="hljs-string">"Persisted: "</span> + uri +
                  <span class="hljs-string">" (read:"</span> + canRead + <span class="hljs-string">", write:"</span> + canWrite + <span class="hljs-string">")"</span>);
        }
    }
}
</code></pre>
<h3 data-id="heading-27">4.3 å®ç°è‡ªå®šä¹‰DocumentsProvider</h3>
<p>åº”ç”¨å¯ä»¥é€šè¿‡å®ç°<code>DocumentsProvider</code>å‘å…¶ä»–åº”ç”¨æä¾›æ–‡æ¡£:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è‡ªå®šä¹‰DocumentsProviderç¤ºä¾‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCloudDocumentsProvider</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">DocumentsProvider</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">ROOT_ID</span> <span class="hljs-operator">=</span> <span class="hljs-string">"my_cloud"</span>;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Cursor <span class="hljs-title function_">queryRoots</span><span class="hljs-params">(String[] projection)</span> {
        <span class="hljs-type">MatrixCursor</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MatrixCursor</span>(projection != <span class="hljs-literal">null</span> ?
            projection : DocumentsContract.Root.DEFAULT_PROJECTION);

        <span class="hljs-comment">// æ·»åŠ æ ¹ç›®å½•</span>
        MatrixCursor.<span class="hljs-type">RowBuilder</span> <span class="hljs-variable">row</span> <span class="hljs-operator">=</span> result.newRow();
        row.add(DocumentsContract.Root.COLUMN_ROOT_ID, ROOT_ID);
        row.add(DocumentsContract.Root.COLUMN_ICON, R.drawable.ic_cloud);
        row.add(DocumentsContract.Root.COLUMN_TITLE, <span class="hljs-string">"My Cloud Storage"</span>);
        row.add(DocumentsContract.Root.COLUMN_FLAGS,
            DocumentsContract.Root.FLAG_SUPPORTS_CREATE |
            DocumentsContract.Root.FLAG_SUPPORTS_IS_CHILD);
        row.add(DocumentsContract.Root.COLUMN_DOCUMENT_ID, <span class="hljs-string">"root"</span>);

        <span class="hljs-keyword">return</span> result;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Cursor <span class="hljs-title function_">queryDocument</span><span class="hljs-params">(String documentId, String[] projection)</span> {
        <span class="hljs-type">MatrixCursor</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MatrixCursor</span>(projection != <span class="hljs-literal">null</span> ?
            projection : DocumentsContract.Document.DEFAULT_PROJECTION);

        <span class="hljs-comment">// ä»äº‘ç«¯è·å–æ–‡æ¡£ä¿¡æ¯</span>
        <span class="hljs-type">CloudDocument</span> <span class="hljs-variable">doc</span> <span class="hljs-operator">=</span> fetchFromCloud(documentId);

        MatrixCursor.<span class="hljs-type">RowBuilder</span> <span class="hljs-variable">row</span> <span class="hljs-operator">=</span> result.newRow();
        row.add(DocumentsContract.Document.COLUMN_DOCUMENT_ID, documentId);
        row.add(DocumentsContract.Document.COLUMN_DISPLAY_NAME, doc.getName());
        row.add(DocumentsContract.Document.COLUMN_MIME_TYPE, doc.getMimeType());
        row.add(DocumentsContract.Document.COLUMN_SIZE, doc.getSize());
        row.add(DocumentsContract.Document.COLUMN_LAST_MODIFIED,
            doc.getLastModified());

        <span class="hljs-keyword">return</span> result;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Cursor <span class="hljs-title function_">queryChildDocuments</span><span class="hljs-params">(String parentDocumentId,
                                      String[] projection, String sortOrder)</span> {
        <span class="hljs-type">MatrixCursor</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MatrixCursor</span>(projection != <span class="hljs-literal">null</span> ?
            projection : DocumentsContract.Document.DEFAULT_PROJECTION);

        <span class="hljs-comment">// æŸ¥è¯¢å­æ–‡æ¡£</span>
        List&lt;CloudDocument&gt; children = fetchChildrenFromCloud(parentDocumentId);

        <span class="hljs-keyword">for</span> (CloudDocument child : children) {
            MatrixCursor.<span class="hljs-type">RowBuilder</span> <span class="hljs-variable">row</span> <span class="hljs-operator">=</span> result.newRow();
            row.add(DocumentsContract.Document.COLUMN_DOCUMENT_ID, child.getId());
            row.add(DocumentsContract.Document.COLUMN_DISPLAY_NAME, child.getName());
            row.add(DocumentsContract.Document.COLUMN_MIME_TYPE, child.getMimeType());
            row.add(DocumentsContract.Document.COLUMN_SIZE, child.getSize());
        }

        <span class="hljs-keyword">return</span> result;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> ParcelFileDescriptor <span class="hljs-title function_">openDocument</span><span class="hljs-params">(String documentId, String mode,
                                             CancellationSignal signal)</span> {
        <span class="hljs-comment">// ä»äº‘ç«¯ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°ç¼“å­˜</span>
        <span class="hljs-type">File</span> <span class="hljs-variable">localFile</span> <span class="hljs-operator">=</span> downloadFromCloud(documentId);

        <span class="hljs-comment">// è¿”å›æ–‡ä»¶æè¿°ç¬¦</span>
        <span class="hljs-keyword">return</span> ParcelFileDescriptor.open(localFile, parseMode(mode));
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">createDocument</span><span class="hljs-params">(String parentDocumentId, String mimeType,
                                 String displayName)</span> {
        <span class="hljs-comment">// åœ¨äº‘ç«¯åˆ›å»ºæ–°æ–‡æ¡£</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">documentId</span> <span class="hljs-operator">=</span> createInCloud(parentDocumentId, mimeType, displayName);

        <span class="hljs-comment">// é€šçŸ¥å˜åŒ–</span>
        notifyChange(DocumentsContract.buildDocumentUri(getAuthority(),
            parentDocumentId));

        <span class="hljs-keyword">return</span> documentId;
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-28">äº”ã€å®æˆ˜:å­˜å‚¨æƒé™é€‚é…æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-29">5.1 é€‚é…Scoped Storageçš„ç­–ç•¥</h3>
<h4 data-id="heading-30"><strong>ç­–ç•¥1: ä¼˜å…ˆä½¿ç”¨App-specificç›®å½•</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StorageHelper</span> {
    <span class="hljs-comment">// ä¿å­˜åº”ç”¨ç§æœ‰æ•°æ®</span>
    <span class="hljs-keyword">public</span> File <span class="hljs-title function_">getAppCacheFile</span><span class="hljs-params">(Context context, String fileName)</span> {
        <span class="hljs-comment">// /storage/emulated/0/Android/data/com.example.app/cache/</span>
        <span class="hljs-type">File</span> <span class="hljs-variable">cacheDir</span> <span class="hljs-operator">=</span> context.getExternalCacheDir();
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(cacheDir, fileName);
    }

    <span class="hljs-comment">// ä¿å­˜ç”¨æˆ·æ•°æ®</span>
    <span class="hljs-keyword">public</span> File <span class="hljs-title function_">getAppDataFile</span><span class="hljs-params">(Context context, String fileName)</span> {
        <span class="hljs-comment">// /storage/emulated/0/Android/data/com.example.app/files/</span>
        <span class="hljs-type">File</span> <span class="hljs-variable">filesDir</span> <span class="hljs-operator">=</span> context.getExternalFilesDir(<span class="hljs-literal">null</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(filesDir, fileName);
    }
}
</code></pre>
<p><strong>ä¼˜åŠ¿</strong>:</p>
<ul>
<li>âœ… æ— éœ€æƒé™</li>
<li>âœ… è‡ªåŠ¨æ¸…ç†</li>
<li>âœ… å…¼å®¹æ‰€æœ‰Androidç‰ˆæœ¬</li>
</ul>
<h4 data-id="heading-31"><strong>ç­–ç•¥2: ä½¿ç”¨MediaStore APIè®¿é—®åª’ä½“æ–‡ä»¶</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MediaStoreHelper</span> {
    <span class="hljs-comment">// ä¿å­˜å›¾ç‰‡åˆ°Picturesç›®å½•</span>
    <span class="hljs-keyword">public</span> Uri <span class="hljs-title function_">saveImage</span><span class="hljs-params">(Context context, Bitmap bitmap, String displayName)</span> {
        <span class="hljs-type">ContentValues</span> <span class="hljs-variable">values</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ContentValues</span>();
        values.put(MediaStore.Images.Media.DISPLAY_NAME, displayName);
        values.put(MediaStore.Images.Media.MIME_TYPE, <span class="hljs-string">"image/jpeg"</span>);
        values.put(MediaStore.Images.Media.RELATIVE_PATH,
            Environment.DIRECTORY_PICTURES + <span class="hljs-string">"/MyApp"</span>);

        <span class="hljs-comment">// Android 10+: å…ˆæ’å…¥pendingçŠ¶æ€</span>
        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.Q) {
            values.put(MediaStore.Images.Media.IS_PENDING, <span class="hljs-number">1</span>);
        }

        <span class="hljs-type">ContentResolver</span> <span class="hljs-variable">resolver</span> <span class="hljs-operator">=</span> context.getContentResolver();
        <span class="hljs-type">Uri</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> resolver.insert(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, values);

        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">OutputStream</span> <span class="hljs-variable">os</span> <span class="hljs-operator">=</span> resolver.openOutputStream(uri);
            bitmap.compress(Bitmap.CompressFormat.JPEG, <span class="hljs-number">90</span>, os);
            os.close();

            <span class="hljs-comment">// å†™å…¥å®Œæˆ,å–æ¶ˆpendingçŠ¶æ€</span>
            <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.Q) {
                values.clear();
                values.put(MediaStore.Images.Media.IS_PENDING, <span class="hljs-number">0</span>);
                resolver.update(uri, values, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);
            }

            <span class="hljs-keyword">return</span> uri;
        } <span class="hljs-keyword">catch</span> (IOException e) {
            <span class="hljs-comment">// å¤±è´¥æ—¶åˆ é™¤è®°å½•</span>
            resolver.delete(uri, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
    }

    <span class="hljs-comment">// è¯»å–æ‰€æœ‰å›¾ç‰‡</span>
    <span class="hljs-keyword">public</span> List&lt;Uri&gt; <span class="hljs-title function_">queryImages</span><span class="hljs-params">(Context context)</span> {
        List&lt;Uri&gt; images = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

        String[] projection = {
            MediaStore.Images.Media._ID,
            MediaStore.Images.Media.DISPLAY_NAME,
            MediaStore.Images.Media.SIZE
        };

        <span class="hljs-type">String</span> <span class="hljs-variable">selection</span> <span class="hljs-operator">=</span> MediaStore.Images.Media.SIZE + <span class="hljs-string">" &gt; ?"</span>;
        String[] selectionArgs = { String.valueOf(<span class="hljs-number">1024</span> * <span class="hljs-number">100</span>) }; <span class="hljs-comment">// å¤§äº100KB</span>

        <span class="hljs-type">String</span> <span class="hljs-variable">sortOrder</span> <span class="hljs-operator">=</span> MediaStore.Images.Media.DATE_ADDED + <span class="hljs-string">" DESC"</span>;

        <span class="hljs-keyword">try</span> (<span class="hljs-type">Cursor</span> <span class="hljs-variable">cursor</span> <span class="hljs-operator">=</span> context.getContentResolver().query(
                MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
                projection, selection, selectionArgs, sortOrder)) {

            <span class="hljs-type">int</span> <span class="hljs-variable">idColumn</span> <span class="hljs-operator">=</span> cursor.getColumnIndexOrThrow(MediaStore.Images.Media._ID);

            <span class="hljs-keyword">while</span> (cursor.moveToNext()) {
                <span class="hljs-type">long</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> cursor.getLong(idColumn);
                <span class="hljs-type">Uri</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> ContentUris.withAppendedId(
                    MediaStore.Images.Media.EXTERNAL_CONTENT_URI, id);
                images.add(uri);
            }
        }

        <span class="hljs-keyword">return</span> images;
    }
}
</code></pre>
<h4 data-id="heading-32"><strong>ç­–ç•¥3: å¯¹äºæ–‡ä»¶ç®¡ç†å™¨ç­‰ç‰¹æ®Šåº”ç”¨,ç”³è¯·MANAGE_EXTERNAL_STORAGE</strong></h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- AndroidManifest.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.permission.MANAGE_EXTERNAL_STORAGE"</span>
                 <span class="hljs-attr">tools:ignore</span>=<span class="hljs-string">"ScopedStorage"</span> /&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">application</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">activity</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">".MainActivity"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">intent-filter</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">"android.intent.action.MANAGE_ALL_FILES_ACCESS_PERMISSION"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">intent-filter</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">activity</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">application</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileManagerHelper</span> {
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰å®Œæ•´æ–‡ä»¶è®¿é—®æƒé™</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasManageExternalStoragePermission</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.R) {
            <span class="hljs-keyword">return</span> Environment.isExternalStorageManager();
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// Android 10åŠä»¥ä¸‹é»˜è®¤æœ‰æƒé™</span>
    }

    <span class="hljs-comment">// è¯·æ±‚å®Œæ•´æ–‡ä»¶è®¿é—®æƒé™</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">requestManageExternalStoragePermission</span><span class="hljs-params">(Activity activity)</span> {
        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.R) {
            <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(Settings.ACTION_MANAGE_ALL_FILES_ACCESS_PERMISSION);
            activity.startActivity(intent);
        }
    }
}
</code></pre>
<p><strong>æ³¨æ„</strong>: <code>MANAGE_EXTERNAL_STORAGE</code>æƒé™éœ€è¦Google Playå®¡æ ¸æ‰¹å‡†,ä»…é™æ–‡ä»¶ç®¡ç†å™¨ã€å¤‡ä»½å·¥å…·ç­‰ç‰¹å®šåº”ç”¨ã€‚</p>
<h3 data-id="heading-33">5.2 å¤„ç†Androidç‰ˆæœ¬å·®å¼‚</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StorageCompatHelper</span> {
    <span class="hljs-comment">// å…¼å®¹æ€§è¯·æ±‚å­˜å‚¨æƒé™</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">requestStoragePermission</span><span class="hljs-params">(Activity activity, <span class="hljs-type">int</span> requestCode)</span> {
        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.R) {
            <span class="hljs-comment">// Android 11+: æ— éœ€READ_EXTERNAL_STORAGE,ä½¿ç”¨MediaStore API</span>
            <span class="hljs-comment">// æˆ–è€…ç”³è¯·MANAGE_EXTERNAL_STORAGE(éœ€å®¡æ ¸)</span>
            Toast.makeText(activity,
                <span class="hljs-string">"Android 11+ uses Scoped Storage"</span>, Toast.LENGTH_SHORT).show();
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.Q) {
            <span class="hljs-comment">// Android 10: å¯ä»¥opt-out Scoped Storage</span>
            ActivityCompat.requestPermissions(activity,
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[] {
                    Manifest.permission.READ_EXTERNAL_STORAGE,
                    Manifest.permission.WRITE_EXTERNAL_STORAGE
                }, requestCode);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// Android 9åŠä»¥ä¸‹: ä¼ ç»Ÿæƒé™æ¨¡å‹</span>
            ActivityCompat.requestPermissions(activity,
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[] {
                    Manifest.permission.READ_EXTERNAL_STORAGE,
                    Manifest.permission.WRITE_EXTERNAL_STORAGE
                }, requestCode);
        }
    }

    <span class="hljs-comment">// å…¼å®¹æ€§è·å–æ–‡ä»¶è·¯å¾„</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getCompatibleFilePath</span><span class="hljs-params">(Context context, Uri uri)</span> {
        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.Q) {
            <span class="hljs-comment">// Scoped Storage: ä½¿ç”¨ContentResolver</span>
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// ä¸åº”è¯¥è·å–çœŸå®è·¯å¾„,ä½¿ç”¨URI</span>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// ä¼ ç»Ÿæ–¹å¼: å¯ä»¥è·å–çœŸå®è·¯å¾„</span>
            String[] projection = { MediaStore.Images.Media.DATA };
            <span class="hljs-type">Cursor</span> <span class="hljs-variable">cursor</span> <span class="hljs-operator">=</span> context.getContentResolver().query(
                uri, projection, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);

            <span class="hljs-keyword">if</span> (cursor != <span class="hljs-literal">null</span> &amp;&amp; cursor.moveToFirst()) {
                <span class="hljs-type">int</span> <span class="hljs-variable">columnIndex</span> <span class="hljs-operator">=</span> cursor.getColumnIndexOrThrow(
                    MediaStore.Images.Media.DATA);
                <span class="hljs-type">String</span> <span class="hljs-variable">path</span> <span class="hljs-operator">=</span> cursor.getString(columnIndex);
                cursor.close();
                <span class="hljs-keyword">return</span> path;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-34">å…­ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-35">Q1: å¦‚ä½•åœ¨Android 11+è®¿é—®å…¶ä»–åº”ç”¨çš„å›¾ç‰‡?</h3>
<p><strong>é—®é¢˜</strong>: Android 11å¼ºåˆ¶Scoped Storageå,æ— æ³•ä½¿ç”¨File APIè®¿é—®å…¶ä»–åº”ç”¨çš„å›¾ç‰‡ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>: ä½¿ç”¨MediaStore API</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ­£ç¡®æ–¹å¼:é€šè¿‡MediaStore URIè®¿é—®</span>
<span class="hljs-type">Uri</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> ContentUris.withAppendedId(
    MediaStore.Images.Media.EXTERNAL_CONTENT_URI, imageId);

<span class="hljs-type">InputStream</span> <span class="hljs-variable">is</span> <span class="hljs-operator">=</span> getContentResolver().openInputStream(uri);
<span class="hljs-type">Bitmap</span> <span class="hljs-variable">bitmap</span> <span class="hljs-operator">=</span> BitmapFactory.decodeStream(is);

<span class="hljs-comment">// é”™è¯¯æ–¹å¼:ç›´æ¥ä½¿ç”¨æ–‡ä»¶è·¯å¾„(Android 11+ä¼šå¤±è´¥)</span>
<span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">"/storage/emulated/0/DCIM/Camera/IMG_001.jpg"</span>);
<span class="hljs-comment">// FileNotFoundException on Android 11+</span>
</code></pre>
<h3 data-id="heading-36">Q2: åº”ç”¨å¸è½½é‡è£…å,å¦‚ä½•æ¢å¤SAFçš„URIæƒé™?</h3>
<p><strong>é—®é¢˜</strong>: åº”ç”¨å¸è½½å,é€šè¿‡<code>takePersistableUriPermission()</code>ä¿å­˜çš„æƒé™ä¼šä¸¢å¤±ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>: ä½¿ç”¨äº‘ç«¯å¤‡ä»½æˆ–è¦æ±‚ç”¨æˆ·é‡æ–°æˆæƒ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UriPermissionBackup</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">PREFS_NAME</span> <span class="hljs-operator">=</span> <span class="hljs-string">"uri_permissions"</span>;

    <span class="hljs-comment">// ä¿å­˜URIåˆ°SharedPreferences</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveUri</span><span class="hljs-params">(Context context, Uri uri)</span> {
        <span class="hljs-type">SharedPreferences</span> <span class="hljs-variable">prefs</span> <span class="hljs-operator">=</span> context.getSharedPreferences(
            PREFS_NAME, Context.MODE_PRIVATE);

        Set&lt;String&gt; uris = prefs.getStringSet(<span class="hljs-string">"saved_uris"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;());
        uris.add(uri.toString());

        prefs.edit().putStringSet(<span class="hljs-string">"saved_uris"</span>, uris).apply();
    }

    <span class="hljs-comment">// æ¢å¤æ—¶æ£€æŸ¥æƒé™æ˜¯å¦ä»ç„¶æœ‰æ•ˆ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">restoreUris</span><span class="hljs-params">(Context context)</span> {
        <span class="hljs-type">SharedPreferences</span> <span class="hljs-variable">prefs</span> <span class="hljs-operator">=</span> context.getSharedPreferences(
            PREFS_NAME, Context.MODE_PRIVATE);

        Set&lt;String&gt; savedUris = prefs.getStringSet(<span class="hljs-string">"saved_uris"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;());
        List&lt;UriPermission&gt; persistedPermissions =
            context.getContentResolver().getPersistedUriPermissions();

        <span class="hljs-keyword">for</span> (String uriString : savedUris) {
            <span class="hljs-type">Uri</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> Uri.parse(uriString);
            <span class="hljs-type">boolean</span> <span class="hljs-variable">hasPermission</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

            <span class="hljs-comment">// æ£€æŸ¥æƒé™æ˜¯å¦å­˜åœ¨</span>
            <span class="hljs-keyword">for</span> (UriPermission permission : persistedPermissions) {
                <span class="hljs-keyword">if</span> (permission.getUri().equals(uri)) {
                    hasPermission = <span class="hljs-literal">true</span>;
                    <span class="hljs-keyword">break</span>;
                }
            }

            <span class="hljs-keyword">if</span> (!hasPermission) {
                <span class="hljs-comment">// æƒé™ä¸¢å¤±,æç¤ºç”¨æˆ·é‡æ–°æˆæƒ</span>
                Log.w(TAG, <span class="hljs-string">"Permission lost for: "</span> + uri);
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-37">Q3: FUSEæ€§èƒ½ä¸å¥½,å¦‚ä½•ä¼˜åŒ–?</h3>
<p><strong>é—®é¢˜</strong>: å¤§é‡å°æ–‡ä»¶è¯»å†™æ—¶,FUSEæ€§èƒ½æ˜æ˜¾ä¸‹é™ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>:</p>
<ol>
<li>å¯ç”¨FUSE Passthrough (Android 15+)</li>
<li>ä½¿ç”¨æ‰¹é‡æ“ä½œå‡å°‘ç³»ç»Ÿè°ƒç”¨</li>
<li>è€ƒè™‘ä½¿ç”¨App-specificç›®å½•(ç»•è¿‡FUSE)</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OptimizedFileAccess</span> {
    <span class="hljs-comment">// æ‰¹é‡è¯»å–æ–‡ä»¶</span>
    <span class="hljs-keyword">public</span> List&lt;<span class="hljs-type">byte</span>[]&gt; readMultipleFiles(List&lt;File&gt; files) {
        List&lt;<span class="hljs-type">byte</span>[]&gt; results = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();

        <span class="hljs-comment">// é”™è¯¯æ–¹å¼:é€ä¸ªæ‰“å¼€å…³é—­(æ¯æ¬¡éƒ½è§¦å‘FUSEæ“ä½œ)</span>
        <span class="hljs-comment">// for (File file : files) {</span>
        <span class="hljs-comment">//     FileInputStream fis = new FileInputStream(file);</span>
        <span class="hljs-comment">//     byte[] data = fis.readAllBytes();</span>
        <span class="hljs-comment">//     fis.close();</span>
        <span class="hljs-comment">//     results.add(data);</span>
        <span class="hljs-comment">// }</span>

        <span class="hljs-comment">// ä¼˜åŒ–æ–¹å¼:ä½¿ç”¨BufferedInputStreamå‡å°‘ç³»ç»Ÿè°ƒç”¨</span>
        <span class="hljs-keyword">for</span> (File file : files) {
            <span class="hljs-keyword">try</span> (<span class="hljs-type">BufferedInputStream</span> <span class="hljs-variable">bis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedInputStream</span>(
                    <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(file), <span class="hljs-number">8192</span>)) {
                <span class="hljs-type">byte</span>[] data = bis.readAllBytes();
                results.add(data);
            } <span class="hljs-keyword">catch</span> (IOException e) {
                Log.e(TAG, <span class="hljs-string">"Failed to read file: "</span> + file, e);
            }
        }

        <span class="hljs-keyword">return</span> results;
    }

    <span class="hljs-comment">// ä½¿ç”¨App-specificç›®å½•ç»•è¿‡FUSE</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">useAppSpecificStorage</span><span class="hljs-params">(Context context)</span> {
        <span class="hljs-comment">// è¿™ä¸ªç›®å½•ä¸ç»è¿‡FUSE,æ€§èƒ½æœ€ä¼˜</span>
        <span class="hljs-type">File</span> <span class="hljs-variable">appDir</span> <span class="hljs-operator">=</span> context.getExternalFilesDir(<span class="hljs-literal">null</span>);

        <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(appDir, <span class="hljs-string">"data.bin"</span>);
        <span class="hljs-comment">// ç›´æ¥è®¿é—®/data/media/0/Android/data/com.example.app/files/data.bin</span>
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-38">ä¸ƒã€Android 15çš„FUSEå’ŒScoped Storageæ–°ç‰¹æ€§</h2>
<h3 data-id="heading-39">7.1 FUSE Passthroughé»˜è®¤å¯ç”¨</h3>
<p>Android 15ä¸­,FUSE Passthroughå¯¹æ‰€æœ‰åº”ç”¨é»˜è®¤å¯ç”¨:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// system/core/rootdir/init.rc (Android 15)</span>
on property:sys.boot_completed=<span class="hljs-number">1</span>
    # å¯ç”¨FUSE Passthrough
    setprop persist.sys.fuse.passthrough.enable <span class="hljs-literal">true</span>
</code></pre>
<p><strong>æ€§èƒ½æå‡</strong>:</p>
<ul>
<li>è§†é¢‘æ’­æ”¾: å‡å°‘30%çš„CPUå ç”¨</li>
<li>å¤§æ–‡ä»¶æ‹·è´: æå‡40%çš„é€Ÿåº¦</li>
<li>ç›¸æœºè¿æ‹: å‡å°‘å†™å…¥å»¶è¿Ÿ</li>
</ul>
<h3 data-id="heading-40">7.2 å¢å¼ºçš„MediaProvideræ€§èƒ½</h3>
<p>Android 15å¯¹MediaProviderè¿›è¡Œäº†å¤šé¡¹ä¼˜åŒ–:</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// packages/providers/MediaProvider/src/com/android/providers/media/scan/MediaScanner.java</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MediaScanner</span> {
    <span class="hljs-comment">// æ‰¹é‡æ‰«æä¼˜åŒ–</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">scanDirectories</span><span class="hljs-params">(List&lt;File&gt; directories)</span> {
        <span class="hljs-comment">// Android 15: ä½¿ç”¨å¼‚æ­¥æ‰¹é‡æ‰«æ</span>
        CompletableFuture.allOf(
            directories.stream()
                .map(dir -&gt; CompletableFuture.runAsync(() -&gt; scanDirectory(dir)))
                .toArray(CompletableFuture[]::<span class="hljs-keyword">new</span>)
        ).join();
    }

    <span class="hljs-comment">// å¢é‡æ‰«æ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">incrementalScan</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// åªæ‰«æå˜åŒ–çš„æ–‡ä»¶,è€Œéå…¨ç›˜æ‰«æ</span>
        <span class="hljs-type">long</span> <span class="hljs-variable">lastScanTime</span> <span class="hljs-operator">=</span> getLastScanTime();
        scanModifiedSince(lastScanTime);
    }
}
</code></pre>
<h3 data-id="heading-41">7.3 æ”¹è¿›çš„SAFç”¨æˆ·ä½“éªŒ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// Android 15æ–°å¢: æ‰¹é‡é€‰æ‹©æ–‡ä»¶</span>
<span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(Intent.ACTION_OPEN_DOCUMENT);
intent.putExtra(Intent.EXTRA_ALLOW_MULTIPLE, <span class="hljs-literal">true</span>); <span class="hljs-comment">// æ”¯æŒå¤šé€‰</span>
intent.setType(<span class="hljs-string">"image/*"</span>);
startActivityForResult(intent, REQUEST_CODE);

<span class="hljs-comment">// å¤„ç†å¤šä¸ªæ–‡ä»¶</span>
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onActivityResult</span><span class="hljs-params">(<span class="hljs-type">int</span> requestCode, <span class="hljs-type">int</span> resultCode, Intent data)</span> {
    <span class="hljs-keyword">if</span> (resultCode == RESULT_OK &amp;&amp; data != <span class="hljs-literal">null</span>) {
        <span class="hljs-type">ClipData</span> <span class="hljs-variable">clipData</span> <span class="hljs-operator">=</span> data.getClipData();
        <span class="hljs-keyword">if</span> (clipData != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; clipData.getItemCount(); i++) {
                <span class="hljs-type">Uri</span> <span class="hljs-variable">uri</span> <span class="hljs-operator">=</span> clipData.getItemAt(i).getUri();
                processFile(uri);
            }
        }
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-42">å…«ã€è°ƒè¯•æŠ€å·§</h2>
<h3 data-id="heading-43">8.1 æŸ¥çœ‹FUSEæŒ‚è½½çŠ¶æ€</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æ£€æŸ¥FUSEæŒ‚è½½ç‚¹</span>
$ adb shell mount | grep fuse
/dev/fuse on /storage/emulated <span class="hljs-built_in">type</span> fuse (rw,lazytime,nosuid,nodev,noexec,noatime,user_id=1023,group_id=1023,allow_other)

<span class="hljs-comment"># 2. æŸ¥çœ‹FUSEè¿›ç¨‹</span>
$ adb shell ps | grep media
media     12345  1234  1234567  12345 0                   0 S com.google.android.providers.media.module

<span class="hljs-comment"># 3. æ£€æŸ¥FUSE PassthroughçŠ¶æ€</span>
$ adb shell getprop persist.sys.fuse.passthrough.enable
<span class="hljs-literal">true</span>
</code></pre>
<h3 data-id="heading-44">8.2 åˆ†æå­˜å‚¨æƒé™é—®é¢˜</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. æŸ¥çœ‹åº”ç”¨çš„è¿è¡Œæ—¶æƒé™</span>
$ adb shell dumpsys package com.example.app | grep -A 20 <span class="hljs-string">"runtime permissions"</span>

<span class="hljs-comment"># 2. æŸ¥çœ‹æŒä¹…åŒ–çš„URIæƒé™</span>
$ adb shell dumpsys activity permissions com.example.app

<span class="hljs-comment"># 3. æŸ¥çœ‹MediaProviderçš„æ•°æ®åº“</span>
$ adb shell content query --uri content://media/external/file
</code></pre>
<h3 data-id="heading-45">8.3 æ€§èƒ½åˆ†æ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ä½¿ç”¨Perfettoè¿½è¸ªFUSEæ“ä½œ</span>
$ adb shell perfetto -c - --txt -o /data/local/tmp/trace \
  &lt;&lt;<span class="hljs-string">EOF
  buffers {
    size_kb: 65536
  }
  data_sources {
    config {
      name: "linux.ftrace"
      ftrace_config {
        ftrace_events: "fuse:*"
      }
    }
  }
  duration_ms: 10000
EOF</span>

<span class="hljs-comment"># 2. åˆ†ææ–‡ä»¶I/Oæ€§èƒ½</span>
$ adb shell <span class="hljs-string">"dd if=/storage/emulated/0/test.bin of=/dev/null bs=1M count=100"</span>

<span class="hljs-comment"># 3. å¯¹æ¯”Passthroughå¼€å…³å‰åæ€§èƒ½</span>
$ adb shell setprop persist.sys.fuse.passthrough.enable <span class="hljs-literal">false</span>
$ adb shell <span class="hljs-string">"dd if=/storage/emulated/0/test.bin of=/dev/null bs=1M count=100"</span>
$ adb shell setprop persist.sys.fuse.passthrough.enable <span class="hljs-literal">true</span>
$ adb shell <span class="hljs-string">"dd if=/storage/emulated/0/test.bin of=/dev/null bs=1M count=100"</span>
</code></pre>
<hr/>
<h2 data-id="heading-46">æ€»ç»“</h2>
<p>æœ¬æ–‡æ·±å…¥å‰–æäº†Android 15çš„FUSEæ–‡ä»¶ç³»ç»Ÿå’ŒScoped Storageæœºåˆ¶,æ¶µç›–äº†ä»¥ä¸‹æ ¸å¿ƒå†…å®¹:</p>
<ol>
<li><strong>FUSEæ¶æ„</strong>: ç”¨æˆ·ç©ºé—´æ–‡ä»¶ç³»ç»Ÿçš„å®ç°åŸç†,ä»¥åŠåœ¨Androidä¸­çš„åº”ç”¨</li>
<li><strong>Scoped Storage</strong>: åº”ç”¨å­˜å‚¨éš”ç¦»çš„æƒé™æ¨¡å‹,ä¿æŠ¤ç”¨æˆ·éšç§</li>
<li><strong>MediaProvider</strong>: æ–‡ä»¶è®¿é—®çš„æ ¸å¿ƒä¸­ä»‹,è´Ÿè´£æƒé™æ£€æŸ¥å’Œè·¯å¾„è½¬æ¢</li>
<li><strong>FUSE Passthrough</strong>: Android 15çš„æ€§èƒ½é©å‘½,å¤§å¹…é™ä½I/Oå¼€é”€</li>
<li><strong>SAF</strong>: ç”¨æˆ·ä¸»å¯¼çš„æ–‡ä»¶è®¿é—®æ¡†æ¶,æä¾›ç»†ç²’åº¦çš„æƒé™æ§åˆ¶</li>
<li><strong>é€‚é…å®è·µ</strong>: ä¸åŒAndroidç‰ˆæœ¬çš„å­˜å‚¨æƒé™é€‚é…ç­–ç•¥</li>
</ol>
<p>FUSEå’ŒScoped Storageçš„å¼•å…¥,æ ‡å¿—ç€Androidå­˜å‚¨ç®¡ç†ä»"ç²—æ”¾çš„æƒé™æ§åˆ¶"å‘"ç²¾ç»†çš„éšç§ä¿æŠ¤"çš„é‡å¤§è½¬å˜ã€‚è™½ç„¶ç»™å¼€å‘è€…å¸¦æ¥äº†é€‚é…æˆæœ¬,ä½†å¯¹ç”¨æˆ·éšç§å’Œæ•°æ®å®‰å…¨çš„æå‡æ˜¯å·¨å¤§çš„ã€‚</p>
<p>åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­,æˆ‘ä»¬å°†æ·±å…¥æ¢è®¨<strong>åŠ å¯†æ–‡ä»¶ç³»ç»Ÿä¸å­˜å‚¨æ€§èƒ½ä¼˜åŒ–</strong>,åˆ†æFBE(File-Based Encryption)çš„å®ç°æœºåˆ¶,ä»¥åŠf2fsæ–‡ä»¶ç³»ç»Ÿçš„ç‰¹æ€§ä¸è°ƒä¼˜ã€‚</p>
<hr/>
<h2 data-id="heading-47">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fsource.android.com%2Fdevices%2Fstorage" target="_blank" title="https://source.android.com/devices/storage" ref="nofollow noopener noreferrer">Android Storage Overview</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Fabout%2Fversions%2F11%2Fprivacy%2Fstorage" target="_blank" title="https://developer.android.com/about/versions/11/privacy/storage" ref="nofollow noopener noreferrer">Scoped Storage Best Practices</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Fguide%2Ftopics%2Fproviders%2Fdocument-provider" target="_blank" title="https://developer.android.com/guide/topics/providers/document-provider" ref="nofollow noopener noreferrer">Storage Access Framework Guide</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcs.android.com%2Fandroid%2Fplatform%2Fsuperproject%2F%2B%2Fandroid-15.0.0_r1%3Apackages%2Fproviders%2FMediaProvider%2F" target="_blank" title="https://cs.android.com/android/platform/superproject/+/android-15.0.0_r1:packages/providers/MediaProvider/" ref="nofollow noopener noreferrer">MediaProvider Source Code (AOSP 15.0)</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fsource.android.com%2Fdevices%2Fstorage%2Ffuse-passthrough" target="_blank" title="https://source.android.com/devices/storage/fuse-passthrough" ref="nofollow noopener noreferrer">FUSE Passthrough Design Doc</a></li>
</ul>
<hr/>
<h3 data-id="heading-48">ç³»åˆ—æ–‡ç« </h3>
<ul>
<li><a href="https://juejin.cn/post/7597640434399592499" target="_blank" title="https://juejin.cn/post/7597640434399592499">ä¸Šä¸€ç¯‡ï¼šAndroid 15å­˜å‚¨å­ç³»ç»Ÿæ·±åº¦è§£æ(ä¸€):Voldä¸å­˜å‚¨ç®¡ç†æ¡†æ¶</a></li>
</ul>
<hr/>
<p><em>æ¬¢è¿æ¥æˆ‘ä¸­çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fhome.wonlab.top" target="_blank" title="https://home.wonlab.top" ref="nofollow noopener noreferrer">ä¸ªäººä¸»é¡µ</a>æ‰¾åˆ°æ›´å¤šæœ‰ç”¨çš„çŸ¥è¯†å’Œæœ‰è¶£çš„äº§å“</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[__CFRunLoopServiceMachPortå‡½æ•°è¯¦è§£]]></title>    <link>https://juejin.cn/post/7598403436698419234</link>    <guid>https://juejin.cn/post/7598403436698419234</guid>    <pubDate>2026-01-23T10:45:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598403436698419234" data-draft-id="7598382710294396928" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="__CFRunLoopServiceMachPortå‡½æ•°è¯¦è§£"/> <meta itemprop="keywords" content="iOS"/> <meta itemprop="datePublished" content="2026-01-23T10:45:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="iOSåœ¨å…¥é—¨"/> <meta itemprop="url" content="https://juejin.cn/user/4037062426627758"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            __CFRunLoopServiceMachPortå‡½æ•°è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4037062426627758/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    iOSåœ¨å…¥é—¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T10:45:37.000Z" title="Fri Jan 23 2026 10:45:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å€ŸåŠ©AIè¾…åŠ©ã€‚</p>
</blockquote>
<h2 data-id="heading-0">__CFRunLoopServiceMachPort å‡½æ•°é€è¡Œæ³¨é‡Š</h2>
<p>è¿™æ˜¯ RunLoop åœ¨ macOS ä¸Š<strong>ä¼‘çœ å’Œå”¤é†’</strong>çš„æ ¸å¿ƒå‡½æ•°ï¼Œé€šè¿‡ <code>mach_msg()</code> ç³»ç»Ÿè°ƒç”¨å®ç°çº¿ç¨‹é˜»å¡ã€‚</p>
<hr/>
<h3 data-id="heading-1">å®Œæ•´æ³¨é‡Šä»£ç </h3>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">static</span> Boolean __CFRunLoopServiceMachPort(
    <span class="hljs-type">mach_port_name_t</span> port,              <span class="hljs-comment">// è¦ç­‰å¾…çš„ç«¯å£ï¼ˆæˆ–ç«¯å£é›†åˆï¼‰</span>
    <span class="hljs-type">mach_msg_header_t</span> **buffer,         <span class="hljs-comment">// æ¶ˆæ¯ç¼“å†²åŒºæŒ‡é’ˆçš„åœ°å€</span>
    <span class="hljs-type">size_t</span> buffer_size,                 <span class="hljs-comment">// ç¼“å†²åŒºå¤§å°</span>
    <span class="hljs-type">mach_port_t</span> *livePort,              <span class="hljs-comment">// [è¾“å‡º] è¢«å”¤é†’çš„ç«¯å£</span>
    <span class="hljs-type">mach_msg_timeout_t</span> timeout,         <span class="hljs-comment">// è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼ŒTIMEOUT_INFINITY=æ— é™ï¼‰</span>
    <span class="hljs-type">voucher_mach_msg_state_t</span> *_Nonnull voucherState,  <span class="hljs-comment">// voucher çŠ¶æ€ï¼ˆè¿½è¸ªç”¨ï¼‰</span>
    <span class="hljs-type">voucher_t</span> *voucherCopy,             <span class="hljs-comment">// voucher å‰¯æœ¬</span>
    CFRunLoopRef rl,                    <span class="hljs-comment">// RunLoopï¼ˆç”¨äºè¿½è¸ªï¼‰</span>
    CFRunLoopModeRef rlm                <span class="hljs-comment">// Modeï¼ˆç”¨äºè¿½è¸ªï¼‰</span>
) {
    <span class="hljs-comment">// ========================================</span>
    <span class="hljs-comment">// å‡½æ•°è¿”å›å€¼è¯´æ˜ï¼š</span>
    <span class="hljs-comment">// â€¢ true: æ”¶åˆ°æ¶ˆæ¯ï¼ŒlivePort æŒ‡å‘å”¤é†’çš„ç«¯å£</span>
    <span class="hljs-comment">// â€¢ false: è¶…æ—¶æˆ–é”™è¯¯</span>
    <span class="hljs-comment">// ========================================</span>
    
    Boolean originalBuffer = <span class="hljs-literal">true</span>;
    <span class="hljs-comment">// æ ‡è®°æ˜¯å¦ä½¿ç”¨åŸå§‹ç¼“å†²åŒº</span>
    <span class="hljs-comment">// true: ä½¿ç”¨è°ƒç”¨è€…æä¾›çš„æ ˆä¸Šç¼“å†²åŒº</span>
    <span class="hljs-comment">// false: ä½¿ç”¨åŠ¨æ€åˆ†é…çš„å †ç¼“å†²åŒºï¼ˆæ¶ˆæ¯å¤ªå¤§æ—¶ï¼‰</span>
    
    <span class="hljs-type">kern_return_t</span> ret = KERN_SUCCESS;
    <span class="hljs-comment">// Mach å†…æ ¸è°ƒç”¨çš„è¿”å›å€¼</span>
    <span class="hljs-comment">// åˆå§‹åŒ–ä¸ºæˆåŠŸçŠ¶æ€</span>
    
    <span class="hljs-keyword">for</span> (;;) {
        <span class="hljs-comment">// æ— é™å¾ªç¯ï¼Œç›´åˆ°ï¼š</span>
        <span class="hljs-comment">// 1. æˆåŠŸæ¥æ”¶æ¶ˆæ¯ï¼ˆreturn trueï¼‰</span>
        <span class="hljs-comment">// 2. è¶…æ—¶ï¼ˆreturn falseï¼‰</span>
        <span class="hljs-comment">// 3. è‡´å‘½é”™è¯¯ï¼ˆbreak å HALTï¼‰</span>
        
        <span class="hljs-comment">/* In that sleep of death what nightmares may come ... */</span>
        <span class="hljs-comment">// èå£«æ¯”äºšã€Šå“ˆå§†é›·ç‰¹ã€‹å¼•ç”¨ï¼š"åœ¨æ­»äº¡çš„ç¡çœ ä¸­ä¼šæœ‰ä»€ä¹ˆå™©æ¢¦æ¥ä¸´..."</span>
        <span class="hljs-comment">// æš—ç¤ºçº¿ç¨‹å³å°†è¿›å…¥"ä¼‘çœ "çŠ¶æ€</span>
        
        <span class="hljs-type">mach_msg_header_t</span> *msg = (<span class="hljs-type">mach_msg_header_t</span> *)*buffer;
        <span class="hljs-comment">// è·å–æ¶ˆæ¯æŒ‡é’ˆ</span>
        <span class="hljs-comment">// *buffer æ˜¯æŒ‡å‘ç¼“å†²åŒºçš„æŒ‡é’ˆ</span>
        
        <span class="hljs-comment">// ========================================</span>
        <span class="hljs-comment">// æ­¥éª¤ 1: åˆå§‹åŒ–æ¶ˆæ¯å¤´</span>
        <span class="hljs-comment">// ========================================</span>
        
        msg-&gt;msgh_bits = <span class="hljs-number">0</span>;
        <span class="hljs-comment">// æ¶ˆæ¯æ ‡å¿—ä½ï¼Œåˆå§‹åŒ–ä¸º 0</span>
        <span class="hljs-comment">// mach_msg ä¼šè®¾ç½®é€‚å½“çš„æ¥æ”¶æ ‡å¿—</span>
        
        msg-&gt;msgh_local_port = port;
        <span class="hljs-comment">// è®¾ç½®æœ¬åœ°ç«¯å£ï¼ˆæ¥æ”¶ç«¯å£ï¼‰</span>
        <span class="hljs-comment">// è¿™æ˜¯æˆ‘ä»¬è¦ç­‰å¾…çš„ç«¯å£ï¼ˆæˆ–ç«¯å£é›†åˆï¼‰</span>
        
        msg-&gt;msgh_remote_port = MACH_PORT_NULL;
        <span class="hljs-comment">// è¿œç¨‹ç«¯å£ï¼ˆå‘é€ç›®æ ‡ï¼‰è®¾ä¸ºç©º</span>
        <span class="hljs-comment">// å› ä¸ºæˆ‘ä»¬åªæ¥æ”¶ï¼Œä¸å‘é€</span>
        
        msg-&gt;msgh_size = buffer_size;
        <span class="hljs-comment">// è®¾ç½®ç¼“å†²åŒºå¤§å°</span>
        <span class="hljs-comment">// å‘Šè¯‰å†…æ ¸æˆ‘ä»¬èƒ½æ¥æ”¶å¤šå¤§çš„æ¶ˆæ¯</span>
        
        msg-&gt;msgh_id = <span class="hljs-number">0</span>;
        <span class="hljs-comment">// æ¶ˆæ¯ IDï¼Œåˆå§‹åŒ–ä¸º 0</span>
        <span class="hljs-comment">// æ¥æ”¶åä¼šåŒ…å«å®é™…çš„æ¶ˆæ¯ ID</span>
        
        <span class="hljs-comment">// ========================================</span>
        <span class="hljs-comment">// æ­¥éª¤ 2: è®°å½•è¿½è¸ªäº‹ä»¶ï¼ˆè°ƒè¯•ç”¨ï¼‰</span>
        <span class="hljs-comment">// ========================================</span>
        
        <span class="hljs-keyword">if</span> (TIMEOUT_INFINITY == timeout) {
            <span class="hljs-comment">// å¦‚æœæ˜¯æ— é™ç­‰å¾…</span>
            CFRUNLOOP_SLEEP();
            <span class="hljs-comment">// æ¢é’ˆå®ï¼šè®°å½•ä¼‘çœ äº‹ä»¶ï¼ˆDTraceï¼‰</span>
            cf_trace(KDEBUG_EVENT_CFRL_SLEEP, port, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
            <span class="hljs-comment">// å†…æ ¸è¿½è¸ªï¼šè®°å½• RunLoop å³å°†ä¼‘çœ </span>
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// å¦‚æœæœ‰è¶…æ—¶æ—¶é—´ï¼ˆè½®è¯¢æ¨¡å¼ï¼‰</span>
            CFRUNLOOP_POLL();
            <span class="hljs-comment">// æ¢é’ˆå®ï¼šè®°å½•è½®è¯¢äº‹ä»¶</span>
            cf_trace(KDEBUG_EVENT_CFRL_POLL, port, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
            <span class="hljs-comment">// å†…æ ¸è¿½è¸ªï¼šè®°å½• RunLoop è½®è¯¢</span>
        }
        
        cf_trace(KDEBUG_EVENT_CFRL_RUN | DBG_FUNC_END, rl, rlm, port, timeout);
        <span class="hljs-comment">// è¿½è¸ªï¼šRunLoop è¿è¡Œé˜¶æ®µç»“æŸ</span>
        
        cf_trace(KDEBUG_EVENT_CFRL_IS_WAITING | DBG_FUNC_START, rl, rlm, port, timeout);
        <span class="hljs-comment">// è¿½è¸ªï¼šå¼€å§‹ç­‰å¾…é˜¶æ®µ</span>
        
        <span class="hljs-comment">// ========================================</span>
        <span class="hljs-comment">// æ­¥éª¤ 3: è°ƒç”¨ mach_msg ç­‰å¾… â­â­â­</span>
        <span class="hljs-comment">// ã€è¿™æ˜¯æ•´ä¸ª RunLoop æœ€æ ¸å¿ƒçš„ä¸€è¡Œä»£ç ï¼ã€‘</span>
        <span class="hljs-comment">// ========================================</span>
        
        ret = mach_msg(
            msg,                    <span class="hljs-comment">// æ¶ˆæ¯ç¼“å†²åŒº</span>
            <span class="hljs-comment">// é€‰é¡¹ç»„åˆï¼š</span>
            MACH_RCV_MSG |          <span class="hljs-comment">// æ¥æ”¶æ¶ˆæ¯æ¨¡å¼</span>
            MACH_RCV_VOUCHER |      <span class="hljs-comment">// æ¥æ”¶ voucherï¼ˆè¿½è¸ªä¿¡æ¯ï¼‰</span>
            MACH_RCV_LARGE |        <span class="hljs-comment">// æ”¯æŒå¤§æ¶ˆæ¯ï¼ˆè‡ªåŠ¨é‡æ–°åˆ†é…ç¼“å†²åŒºï¼‰</span>
            ((TIMEOUT_INFINITY != timeout) ? MACH_RCV_TIMEOUT : <span class="hljs-number">0</span>) | 
            <span class="hljs-comment">// å¦‚æœæœ‰è¶…æ—¶ï¼Œæ·»åŠ  MACH_RCV_TIMEOUT æ ‡å¿—</span>
            MACH_RCV_TRAILER_TYPE(MACH_MSG_TRAILER_FORMAT_0) |
            <span class="hljs-comment">// æ¥æ”¶ trailerï¼ˆæ¶ˆæ¯å°¾éƒ¨é™„åŠ ä¿¡æ¯ï¼‰</span>
            MACH_RCV_TRAILER_ELEMENTS(MACH_RCV_TRAILER_AV),
            <span class="hljs-comment">// trailer åŒ…å« audit token å’Œ voucher</span>
            <span class="hljs-number">0</span>,                      <span class="hljs-comment">// å‘é€å¤§å°ï¼ˆä¸å‘é€ï¼Œæ‰€ä»¥ä¸º 0ï¼‰</span>
            msg-&gt;msgh_size,         <span class="hljs-comment">// æ¥æ”¶ç¼“å†²åŒºå¤§å°</span>
            port,                   <span class="hljs-comment">// æ¥æ”¶ç«¯å£ï¼ˆæˆ–ç«¯å£é›†åˆï¼‰</span>
            timeout,                <span class="hljs-comment">// è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
            MACH_PORT_NULL          <span class="hljs-comment">// é€šçŸ¥ç«¯å£ï¼ˆä¸ä½¿ç”¨ï¼‰</span>
        );
        <span class="hljs-comment">// ã€çº¿ç¨‹åœ¨è¿™é‡Œé˜»å¡ã€‘</span>
        <span class="hljs-comment">// ç­‰å¾…ä»¥ä¸‹æƒ…å†µä¹‹ä¸€ï¼š</span>
        <span class="hljs-comment">// 1. port æ”¶åˆ°æ¶ˆæ¯ â†’ è¿”å› MACH_MSG_SUCCESS</span>
        <span class="hljs-comment">// 2. è¶…æ—¶ â†’ è¿”å› MACH_RCV_TIMED_OUT</span>
        <span class="hljs-comment">// 3. æ¶ˆæ¯å¤ªå¤§ â†’ è¿”å› MACH_RCV_TOO_LARGE</span>
        <span class="hljs-comment">// 4. å…¶ä»–é”™è¯¯ â†’ è¿”å›é”™è¯¯ç </span>
        
        cf_trace(KDEBUG_EVENT_CFRL_IS_WAITING | DBG_FUNC_END, rl, rlm, port, timeout);
        <span class="hljs-comment">// è¿½è¸ªï¼šç­‰å¾…é˜¶æ®µç»“æŸï¼ˆè¢«å”¤é†’ï¼‰</span>
        
        cf_trace(KDEBUG_EVENT_CFRL_RUN | DBG_FUNC_START, rl, rlm, port, timeout);
        <span class="hljs-comment">// è¿½è¸ªï¼šRunLoop è¿è¡Œé˜¶æ®µå¼€å§‹</span>
        
        <span class="hljs-comment">// ========================================</span>
        <span class="hljs-comment">// æ­¥éª¤ 4: å¤„ç† voucherï¼ˆæ€§èƒ½è¿½è¸ªï¼‰</span>
        <span class="hljs-comment">// ========================================</span>
        
        <span class="hljs-comment">// Take care of all voucher-related work right after mach_msg.</span>
        <span class="hljs-comment">// åœ¨ mach_msg ä¹‹åç«‹å³å¤„ç†æ‰€æœ‰ voucher ç›¸å…³å·¥ä½œ</span>
        <span class="hljs-comment">// If we don't release the previous voucher we're going to leak it.</span>
        <span class="hljs-comment">// å¦‚æœä¸é‡Šæ”¾ä¹‹å‰çš„ voucherï¼Œä¼šé€ æˆå†…å­˜æ³„æ¼</span>
        
        voucher_mach_msg_revert(*voucherState);
        <span class="hljs-comment">// æ¢å¤ä¹‹å‰çš„ voucher çŠ¶æ€</span>
        <span class="hljs-comment">// é‡Šæ”¾ä¸Šæ¬¡æ”¶åˆ°çš„ voucherï¼ˆå¦‚æœæœ‰ï¼‰</span>
        
        <span class="hljs-comment">// Someone will be responsible for calling voucher_mach_msg_revert. This call makes the received voucher the current one.</span>
        <span class="hljs-comment">// è°ƒç”¨è€…è´Ÿè´£è°ƒç”¨ voucher_mach_msg_revert</span>
        <span class="hljs-comment">// è¿™ä¸ªè°ƒç”¨è®©æ¥æ”¶åˆ°çš„ voucher æˆä¸ºå½“å‰çš„</span>
        
        *voucherState = voucher_mach_msg_adopt(msg);
        <span class="hljs-comment">// é‡‡ç”¨ï¼ˆadoptï¼‰æ¶ˆæ¯ä¸­çš„ voucher</span>
        <span class="hljs-comment">// è¿”å›æ–°çš„ voucher çŠ¶æ€</span>
        <span class="hljs-comment">// voucher ç”¨äºè¿½è¸ªæ¶ˆæ¯çš„æ¥æºå’Œä¸Šä¸‹æ–‡</span>
        
        <span class="hljs-keyword">if</span> (voucherCopy) {
            <span class="hljs-comment">// å¦‚æœè°ƒç”¨è€…éœ€è¦ voucher å‰¯æœ¬</span>
            *voucherCopy = <span class="hljs-literal">NULL</span>;
            <span class="hljs-comment">// é‡ç½®ä¸º NULL</span>
            <span class="hljs-comment">// è°ƒç”¨è€…å¯ä»¥åœ¨éœ€è¦æ—¶æ‹·è´</span>
        }

        CFRUNLOOP_WAKEUP(ret);
        <span class="hljs-comment">// æ¢é’ˆå®ï¼šè®°å½•å”¤é†’äº‹ä»¶ï¼Œä¼ å…¥è¿”å›å€¼</span>
        
        cf_trace(KDEBUG_EVENT_CFRL_DID_WAKEUP, port, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        <span class="hljs-comment">// å†…æ ¸è¿½è¸ªï¼šè®°å½• RunLoop è¢«å”¤é†’</span>
        
        <span class="hljs-comment">// ========================================</span>
        <span class="hljs-comment">// æ­¥éª¤ 5: å¤„ç†è¿”å›ç»“æœ</span>
        <span class="hljs-comment">// ========================================</span>
        
        <span class="hljs-keyword">if</span> (MACH_MSG_SUCCESS == ret) {
            <span class="hljs-comment">// æƒ…å†µ 1: æˆåŠŸæ¥æ”¶åˆ°æ¶ˆæ¯</span>
            
            *livePort = msg ? msg-&gt;msgh_local_port : MACH_PORT_NULL;
            <span class="hljs-comment">// è¿”å›è¢«å”¤é†’çš„ç«¯å£</span>
            <span class="hljs-comment">// è°ƒç”¨è€…é€šè¿‡è¿™ä¸ªå€¼åˆ¤æ–­å”¤é†’æºï¼š</span>
            <span class="hljs-comment">// â€¢ _wakeUpPort â†’ æ‰‹åŠ¨å”¤é†’</span>
            <span class="hljs-comment">// â€¢ _timerPort â†’ å®šæ—¶å™¨</span>
            <span class="hljs-comment">// â€¢ dispatchPort â†’ GCD ä¸»é˜Ÿåˆ—</span>
            <span class="hljs-comment">// â€¢ å…¶ä»– â†’ Source1</span>
            
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            <span class="hljs-comment">// è¿”å›æˆåŠŸï¼Œç»“æŸå‡½æ•°</span>
        }
        
        <span class="hljs-keyword">if</span> (MACH_RCV_TIMED_OUT == ret) {
            <span class="hljs-comment">// æƒ…å†µ 2: æ¥æ”¶è¶…æ—¶ï¼ˆæ­£å¸¸æƒ…å†µï¼‰</span>
            
            <span class="hljs-keyword">if</span> (!originalBuffer) <span class="hljs-built_in">free</span>(msg);
            <span class="hljs-comment">// å¦‚æœä½¿ç”¨äº†åŠ¨æ€åˆ†é…çš„ç¼“å†²åŒºï¼Œé‡Šæ”¾å®ƒ</span>
            
            *buffer = <span class="hljs-literal">NULL</span>;
            <span class="hljs-comment">// å°†ç¼“å†²åŒºæŒ‡é’ˆè®¾ä¸º NULL</span>
            
            *livePort = MACH_PORT_NULL;
            <span class="hljs-comment">// æ²¡æœ‰å”¤é†’ç«¯å£ï¼ˆè¶…æ—¶ï¼‰</span>
            
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            <span class="hljs-comment">// è¿”å›å¤±è´¥ï¼ˆè¶…æ—¶ï¼‰</span>
        }
        
        <span class="hljs-keyword">if</span> (MACH_RCV_TOO_LARGE != ret) {
            <span class="hljs-comment">// æƒ…å†µ 3: å…¶ä»–é”™è¯¯ï¼ˆé "æ¶ˆæ¯å¤ªå¤§"ï¼‰</span>
            <span class="hljs-comment">// è¿™äº›æ˜¯è‡´å‘½é”™è¯¯ï¼Œéœ€è¦å´©æºƒ</span>
            
            <span class="hljs-keyword">if</span> (((MACH_RCV_HEADER_ERROR &amp; ret) == MACH_RCV_HEADER_ERROR) || 
                (MACH_RCV_BODY_ERROR &amp; ret) == MACH_RCV_BODY_ERROR) {
                <span class="hljs-comment">// å¦‚æœæ˜¯æ¶ˆæ¯å¤´é”™è¯¯æˆ–æ¶ˆæ¯ä½“é”™è¯¯</span>
                
                <span class="hljs-type">kern_return_t</span> specialBits = MACH_MSG_MASK &amp; ret;
                <span class="hljs-comment">// æå–ç‰¹æ®Šé”™è¯¯ä½</span>
                
                <span class="hljs-keyword">if</span> (MACH_MSG_IPC_SPACE == specialBits) {
                    <span class="hljs-comment">// IPC ç©ºé—´ä¸è¶³</span>
                    CRSetCrashLogMessage(<span class="hljs-string">"Out of IPC space"</span>);
                    <span class="hljs-comment">// è®¾ç½®å´©æºƒæ—¥å¿—æ¶ˆæ¯</span>
                    <span class="hljs-comment">// å¯èƒ½åŸå› ï¼šMach ç«¯å£æ³„æ¼</span>
                    
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (MACH_MSG_VM_SPACE == specialBits) {
                    <span class="hljs-comment">// è™šæ‹Ÿå†…å­˜ç©ºé—´ä¸è¶³</span>
                    CRSetCrashLogMessage(<span class="hljs-string">"Out of VM address space"</span>);
                    <span class="hljs-comment">// å†…å­˜è€—å°½</span>
                    
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (MACH_MSG_IPC_KERNEL == specialBits) {
                    <span class="hljs-comment">// å†…æ ¸ IPC èµ„æºçŸ­ç¼º</span>
                    CRSetCrashLogMessage(<span class="hljs-string">"Kernel resource shortage handling IPC"</span>);
                    <span class="hljs-comment">// å†…æ ¸èµ„æºä¸è¶³</span>
                    
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (MACH_MSG_VM_KERNEL == specialBits) {
                    <span class="hljs-comment">// å†…æ ¸ VM èµ„æºçŸ­ç¼º</span>
                    CRSetCrashLogMessage(<span class="hljs-string">"Kernel resource shortage handling out-of-line memory"</span>);
                    <span class="hljs-comment">// å†…æ ¸å†…å­˜ä¸è¶³</span>
                }
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// å…¶ä»–ç±»å‹çš„é”™è¯¯</span>
                CRSetCrashLogMessage(mach_error_string(ret));
                <span class="hljs-comment">// è®¾ç½®é”™è¯¯å­—ç¬¦ä¸²ä¸ºå´©æºƒæ—¥å¿—</span>
            }
            <span class="hljs-keyword">break</span>;
            <span class="hljs-comment">// è·³å‡ºå¾ªç¯ï¼Œå‡†å¤‡å´©æºƒ</span>
        }
        
        <span class="hljs-comment">// ========================================</span>
        <span class="hljs-comment">// æ­¥éª¤ 6: å¤„ç† MACH_RCV_TOO_LARGEï¼ˆæ¶ˆæ¯å¤ªå¤§ï¼‰</span>
        <span class="hljs-comment">// ========================================</span>
        <span class="hljs-comment">// å¦‚æœæ‰§è¡Œåˆ°è¿™é‡Œï¼Œè¯´æ˜ ret == MACH_RCV_TOO_LARGE</span>
        
        buffer_size = round_msg(msg-&gt;msgh_size + MAX_TRAILER_SIZE);
        <span class="hljs-comment">// è®¡ç®—éœ€è¦çš„ç¼“å†²åŒºå¤§å°</span>
        <span class="hljs-comment">// round_msg: å‘ä¸Šå–æ•´åˆ°åˆé€‚çš„å¤§å°</span>
        <span class="hljs-comment">// msg-&gt;msgh_size: å®é™…æ¶ˆæ¯å¤§å°ï¼ˆå·²åœ¨ msg ä¸­è®¾ç½®ï¼‰</span>
        <span class="hljs-comment">// MAX_TRAILER_SIZE: trailer çš„æœ€å¤§å¤§å°</span>
        
        <span class="hljs-keyword">if</span> (originalBuffer) *buffer = <span class="hljs-literal">NULL</span>;
        <span class="hljs-comment">// å¦‚æœä¹‹å‰ä½¿ç”¨çš„æ˜¯åŸå§‹ç¼“å†²åŒºï¼ˆæ ˆä¸Šçš„ï¼‰</span>
        <span class="hljs-comment">// å°†æŒ‡é’ˆè®¾ä¸º NULLï¼Œä¸‹é¢ä¼šåˆ†é…æ–°çš„</span>
        
        originalBuffer = <span class="hljs-literal">false</span>;
        <span class="hljs-comment">// æ ‡è®°ä¸å†ä½¿ç”¨åŸå§‹ç¼“å†²åŒº</span>
        
        *buffer = __CFSafelyReallocate(*buffer, buffer_size, <span class="hljs-literal">NULL</span>);
        <span class="hljs-comment">// é‡æ–°åˆ†é…æ›´å¤§çš„ç¼“å†²åŒº</span>
        <span class="hljs-comment">// å¦‚æœ *buffer æ˜¯ NULLï¼Œç›¸å½“äº malloc</span>
        <span class="hljs-comment">// å¦åˆ™ç›¸å½“äº realloc</span>
        <span class="hljs-comment">// ä¸‹æ¬¡å¾ªç¯ä¼šä½¿ç”¨æ–°ç¼“å†²åŒºé‡æ–°æ¥æ”¶</span>

        <span class="hljs-keyword">if</span> (voucherCopy != <span class="hljs-literal">NULL</span> &amp;&amp; *voucherCopy != <span class="hljs-literal">NULL</span>) {
            <span class="hljs-comment">// å¦‚æœæœ‰ voucher å‰¯æœ¬</span>
            os_release(*voucherCopy);
            <span class="hljs-comment">// é‡Šæ”¾ voucherï¼ˆå¼•ç”¨è®¡æ•° -1ï¼‰</span>
        }
    }
    <span class="hljs-comment">// ç»§ç»­å¾ªç¯ï¼Œä½¿ç”¨æ–°ç¼“å†²åŒºé‡æ–°è°ƒç”¨ mach_msg</span>
    
    HALT;
    <span class="hljs-comment">// å¦‚æœè·³å‡ºå¾ªç¯ï¼ˆå› ä¸ºè‡´å‘½é”™è¯¯ï¼‰ï¼Œåœæ­¢ç¨‹åº</span>
    <span class="hljs-comment">// HALT å®ä¼šè§¦å‘æ–­ç‚¹æˆ–ç»ˆæ­¢è¿›ç¨‹</span>
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-comment">// è¿™è¡Œä»£ç å®é™…ä¸ä¼šæ‰§è¡Œï¼ˆHALT ä¸ä¼šè¿”å›ï¼‰</span>
    <span class="hljs-comment">// ä½†ä¿ç•™ä»¥æ»¡è¶³ç¼–è¯‘å™¨è¦æ±‚</span>
}
</code></pre>
<hr/>
<h3 data-id="heading-2">å‡½æ•°æ‰§è¡Œæµç¨‹å›¾</h3>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¼€å§‹ __CFRunLoopServiceMachPort                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åˆå§‹åŒ–æ¶ˆæ¯å¤´                                                 â”‚
â”‚  â€¢ msgh_local_port = port (ç­‰å¾…çš„ç«¯å£)                        â”‚
â”‚  â€¢ msgh_size = buffer_size                                  â”‚
â”‚  â€¢ å…¶ä»–å­—æ®µç½® <span class="hljs-number">0</span>                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è®°å½•è¿½è¸ªäº‹ä»¶                                                 â”‚
â”‚  â€¢ SLEEP (æ— é™ç­‰å¾…) æˆ– POLL (æœ‰è¶…æ—¶)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â­ è°ƒç”¨ <span class="hljs-built_in">mach_msg</span>() - çº¿ç¨‹åœ¨æ­¤é˜»å¡ â­                          â”‚
â”‚                                                             â”‚
â”‚  ç­‰å¾…äº‹ä»¶ï¼š                                                  â”‚
â”‚  â€¢ Timer ç«¯å£æœ‰æ¶ˆæ¯                                          â”‚
â”‚  â€¢ Source1 ç«¯å£æœ‰æ¶ˆæ¯                                        â”‚
â”‚  â€¢ dispatch ç«¯å£æœ‰æ¶ˆæ¯                                       â”‚
â”‚  â€¢ _wakeUpPort æœ‰æ¶ˆæ¯                                        â”‚
â”‚  â€¢ è¶…æ—¶                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¢«å”¤é†’ï¼Œæ£€æŸ¥è¿”å›å€¼                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚               â”‚                â”‚
          â–¼               â–¼                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ SUCCESS â”‚    â”‚ TIMED_OUTâ”‚    â”‚  TOO_LARGE   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚               â”‚                â”‚
          â–¼               â–¼                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚å¤„ç†voucherâ”‚   â”‚ æ¸…ç†ç¼“å†²  â”‚    â”‚ æ‰©å¤§ç¼“å†²åŒº    â”‚
    â”‚è¿”å›true  â”‚   â”‚è¿”å›false  â”‚     â”‚ é‡æ–°æ¥æ”¶     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚è¿”å›å¾ªç¯å¼€å§‹â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h3 data-id="heading-3">å…³é”®ç‚¹è¯´æ˜</h3>
<h4 data-id="heading-4">1. mach_msg çš„ä¸¤ç§æ¨¡å¼</h4>




















<table><thead><tr><th>æ¨¡å¼</th><th>timeout å€¼</th><th>è¡Œä¸º</th></tr></thead><tbody><tr><td><strong>ä¼‘çœ æ¨¡å¼</strong></td><td><code>TIMEOUT_INFINITY</code></td><td>æ°¸ä¹…é˜»å¡ï¼Œç›´åˆ°æ”¶åˆ°æ¶ˆæ¯</td></tr><tr><td><strong>è½®è¯¢æ¨¡å¼</strong></td><td><code>0</code> æˆ–å°å€¼</td><td>ç«‹å³è¿”å›æˆ–çŸ­æš‚ç­‰å¾…</td></tr></tbody></table>
<h4 data-id="heading-5">2. å¯èƒ½çš„è¿”å›å€¼</h4>






























<table><thead><tr><th>è¿”å›å€¼</th><th>è¯´æ˜</th><th>å¤„ç†æ–¹å¼</th></tr></thead><tbody><tr><td><code>MACH_MSG_SUCCESS</code></td><td>æˆåŠŸæ”¶åˆ°æ¶ˆæ¯</td><td>è¿”å› true</td></tr><tr><td><code>MACH_RCV_TIMED_OUT</code></td><td>è¶…æ—¶</td><td>è¿”å› false</td></tr><tr><td><code>MACH_RCV_TOO_LARGE</code></td><td>æ¶ˆæ¯å¤ªå¤§</td><td>æ‰©å¤§ç¼“å†²åŒºé‡è¯•</td></tr><tr><td>å…¶ä»–é”™è¯¯</td><td>è‡´å‘½é”™è¯¯</td><td>å´©æºƒï¼ˆHALTï¼‰</td></tr></tbody></table>
<h4 data-id="heading-6">3. voucher çš„ä½œç”¨</h4>
<pre><code class="hljs">voucher æ˜¯ macOS çš„æ€§èƒ½è¿½è¸ªæœºåˆ¶ï¼š
â”œâ”€â”€ è¿½è¸ªæ¶ˆæ¯æ¥æº
â”œâ”€â”€ è®°å½• QoSï¼ˆæœåŠ¡è´¨é‡ï¼‰
â”œâ”€â”€ æ€§èƒ½åˆ†æï¼ˆInstrumentsï¼‰
â””â”€â”€ è°ƒè¯•è¾…åŠ©
</code></pre>
<h4 data-id="heading-7">4. ç¼“å†²åŒºç®¡ç†</h4>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">åˆå§‹: ä½¿ç”¨æ ˆç¼“å†²åŒºï¼ˆ3KBï¼‰</span>
  â†“
mach_msg è¿”å› TOO_LARGE
  â†“
<span class="hljs-section">è®¡ç®—å®é™…å¤§å°: msg-&gt;msgh_size + MAX_TRAILER_SIZE</span>
  â†“
åŠ¨æ€åˆ†é…å †ç¼“å†²åŒº
  â†“
é‡æ–°è°ƒç”¨ mach_msg
  â†“
æˆåŠŸæ¥æ”¶å¤§æ¶ˆæ¯
</code></pre>
<hr/>
<h3 data-id="heading-8">æ€»ç»“</h3>
<p><strong><code>__CFRunLoopServiceMachPort</code> æ˜¯ RunLoop ä¼‘çœ çš„æ ¸å¿ƒ</strong>ï¼š</p>
<ol>
<li><strong>å‡†å¤‡æ¶ˆæ¯å¤´</strong>ï¼šè®¾ç½®æ¥æ”¶ç«¯å£å’Œç¼“å†²åŒº</li>
<li><strong>è°ƒç”¨ mach_msg</strong>ï¼šçº¿ç¨‹é˜»å¡ç­‰å¾… â­</li>
<li><strong>è¢«å”¤é†’</strong>ï¼šæ£€æŸ¥è¿”å›å€¼å’Œ livePort</li>
<li><strong>å¤„ç†ç‰¹æ®Šæƒ…å†µ</strong>ï¼šè¶…æ—¶ã€æ¶ˆæ¯è¿‡å¤§ã€é”™è¯¯</li>
<li><strong>è¿”å›ç»“æœ</strong>ï¼šå‘Šè¯‰è°ƒç”¨è€…æ˜¯å“ªä¸ªç«¯å£å”¤é†’çš„</li>
</ol>
<p><strong>è¿™å°±æ˜¯ RunLoop "æ— äº‹ä»¶æ—¶ä¸æ¶ˆè€— CPU" çš„ç§˜å¯†ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AIå¤§æ¨¡å‹å¾®è°ƒæŒ‡å—ï¼šå‘Šåˆ«â€œç‚¼ä¸¹â€ç„å­¦ï¼Œç”¨æ•°æ®ä¸ç§‘å­¦æ‰“é€ ä¸“å±æ¨¡å‹]]></title>    <link>https://juejin.cn/post/7598402961904173108</link>    <guid>https://juejin.cn/post/7598402961904173108</guid>    <pubDate>2026-01-23T11:31:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598402961904173108" data-draft-id="7598355220829175860" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AIå¤§æ¨¡å‹å¾®è°ƒæŒ‡å—ï¼šå‘Šåˆ«â€œç‚¼ä¸¹â€ç„å­¦ï¼Œç”¨æ•°æ®ä¸ç§‘å­¦æ‰“é€ ä¸“å±æ¨¡å‹"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-23T11:31:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‹¸çŒ«ç®—å›"/> <meta itemprop="url" content="https://juejin.cn/user/643654644149178"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AIå¤§æ¨¡å‹å¾®è°ƒæŒ‡å—ï¼šå‘Šåˆ«â€œç‚¼ä¸¹â€ç„å­¦ï¼Œç”¨æ•°æ®ä¸ç§‘å­¦æ‰“é€ ä¸“å±æ¨¡å‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/643654644149178/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‹¸çŒ«ç®—å›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T11:31:10.000Z" title="Fri Jan 23 2026 11:31:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€ï¼šä¸ºä»€ä¹ˆä½ éœ€è¦æŒæ¡å¤§æ¨¡å‹å¾®è°ƒï¼Ÿ</h2>
<p>åœ¨äººå·¥æ™ºèƒ½æµªæ½®ä¸­ï¼Œå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰å¦‚GPTã€LLaMAã€é€šä¹‰åƒé—®ç­‰å·²å±•ç°å‡ºæƒŠäººçš„é€šç”¨èƒ½åŠ›ã€‚ç„¶è€Œï¼Œä½ æ˜¯å¦æ›¾é‡åˆ°è¿™æ ·çš„å›°å¢ƒï¼š</p>
<ul>
<li>æ¨¡å‹å›ç­”è™½æµç•…ï¼Œå´æ€»è¯´ä¸åˆ°ä½ çš„ä¸šåŠ¡é‡ç‚¹ï¼Ÿ</li>
<li>æƒ³è®©AIå­¦ä¹ å…¬å¸å†…éƒ¨çŸ¥è¯†åº“ï¼Œå´ä¸çŸ¥å¦‚ä½•å…¥æ‰‹ï¼Ÿ</li>
<li>å°è¯•å¾®è°ƒåï¼Œç»“æœåè€Œæ¯”åŸå§‹æ¨¡å‹æ›´å·®ï¼Ÿ</li>
</ul>
<p>è¿™æ­£æ˜¯å¾®è°ƒï¼ˆFine-tuningï¼‰çš„ä»·å€¼æ‰€åœ¨â€”â€”å®ƒèƒ½è®©é€šç”¨å¤§æ¨¡å‹â€œå¯¹é½â€åˆ°ä½ çš„ä¸“å±åœºæ™¯ï¼Œæˆä¸ºä½ çš„æ³•å¾‹é¡¾é—®ã€å®¢æœä¸“å®¶ã€ä»£ç åŠ©æ‰‹æˆ–åˆ›ä½œä¼™ä¼´ã€‚ä½†å¾®è°ƒç»éâ€œä¸€é”®ç‚¼ä¸¹â€ï¼Œè€Œæ˜¯ä¸€åœºç»“åˆ<strong>æ•°æ®ç§‘å­¦ã€å·¥ç¨‹å®è·µä¸æŒç»­è¿­ä»£</strong>çš„ç²¾ç»†å®éªŒã€‚æœ¬æ–‡å°†ç”¨æœ€æ˜“æ‡‚çš„æ–¹å¼ï¼Œå¸¦ä½ é¿å¼€90%çš„å¸¸è§é™·é˜±ï¼ŒæŒæ¡å·¥ä¸šçº§å¾®è°ƒçš„æ ¸å¿ƒå¿ƒæ³•ã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€æŠ€æœ¯åŸç†ï¼šå¾®è°ƒå¦‚ä½•è®©å¤§æ¨¡å‹â€œæ›´æ‡‚ä½ â€ï¼Ÿ</h2>
<h3 data-id="heading-2">1. å¾®è°ƒçš„æœ¬è´¨ï¼šä¸æ˜¯çŒè¾“çŸ¥è¯†ï¼Œè€Œæ˜¯è°ƒæ•´â€œè¡¨è¾¾ä¹ æƒ¯â€</h3>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä¸€ä¸ªå—è¿‡é€šè¯†æ•™è‚²çš„èªæ˜å­¦ç”Ÿï¼ˆåŸºç¡€å¤§æ¨¡å‹ï¼‰ï¼Œä½ éœ€è¦è®©ä»–ä¸“æ”»æ³•å¾‹ï¼ˆå‚ç›´åœºæ™¯ï¼‰ã€‚ä½ ä¸ä¼šä»å¤´æ•™ä»–è®¤å­—ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li><strong>æä¾›é«˜è´¨é‡æ¡ˆä¾‹</strong>ï¼ˆç²¾å¿ƒå‡†å¤‡çš„æ•°æ®ï¼‰</li>
<li><strong>è°ƒæ•´å­¦ä¹ èŠ‚å¥</strong>ï¼ˆåˆç†çš„è¶…å‚æ•°ï¼‰</li>
<li><strong>æŒç»­æ£€éªŒæˆæœ</strong>ï¼ˆéªŒè¯ä¸è¯„ä¼°ï¼‰</li>
</ul>
<p>å¾®è°ƒåŒç†ï¼Œå®ƒé€šè¿‡<strong>æœ‰ç›‘ç£å­¦ä¹ </strong>ï¼Œç”¨ä½ çš„æ•°æ®è½»å¾®è°ƒæ•´æ¨¡å‹å†…éƒ¨æƒé‡ï¼Œè®©æ¨¡å‹è¾“å‡ºæ›´è´´è¿‘ä½ çš„éœ€æ±‚æ ¼å¼ã€é¢†åŸŸçŸ¥è¯†å’Œè¯­è¨€é£æ ¼ã€‚</p>
<h3 data-id="heading-3">2. æ ¸å¿ƒæ¦‚å¿µæ‹†è§£</h3>
<h4 data-id="heading-4">ï¼ˆ1ï¼‰å‚æ•°é«˜æ•ˆå¾®è°ƒï¼ˆPEFTï¼‰ï¼šç»™æ¨¡å‹æˆ´ä¸€ä¸ªâ€œæ™ºèƒ½è€³éº¦â€</h4>
<p>ä¼ ç»Ÿå…¨å‚æ•°å¾®è°ƒå¥½æ¯”è®©æ¨¡å‹é‡æ–°å­¦ä¹ æ‰€æœ‰çŸ¥è¯†ï¼Œæˆæœ¬æé«˜ã€‚è€Œ<strong>LoRAï¼ˆLow-Rank Adaptationï¼‰</strong> Â ç­‰PEFTæŠ€æœ¯ï¼Œå¦‚åŒç»™æ¨¡å‹ä½©æˆ´ä¸€ä¸ªè½»é‡çº§â€œé€‚é…å™¨â€â€”â€”åªè®­ç»ƒæ–°å¢çš„å°‘é‡å‚æ•°ï¼ˆé€šå¸¸ä»…åŸæ¨¡å‹çš„0.1%-1%ï¼‰ï¼Œå´èƒ½å®ç°85%ä»¥ä¸Šçš„å¾®è°ƒæ•ˆæœï¼Œæ˜¾å­˜éœ€æ±‚é™ä½70%+ã€‚</p>
<h4 data-id="heading-5">ï¼ˆ2ï¼‰å­¦ä¹ ç‡ï¼ˆLearning Rateï¼‰ï¼šæ¨¡å‹çš„â€œå­¦ä¹ æ­¥ä¼â€</h4>
<ul>
<li><strong>è¿‡å¤§</strong>ï¼šæ¨¡å‹â€œå¤§æ­¥ç‹‚å¥”â€ï¼Œå®¹æ˜“é”™è¿‡æœ€ä¼˜è§£ï¼ˆlosséœ‡è¡/çˆ†ç‚¸ï¼‰</li>
<li><strong>è¿‡å°</strong>ï¼šæ¨¡å‹â€œæ­¥å±¥è¹’è·šâ€ï¼Œå­¦ä¹ æ•ˆç‡ä½ä¸‹ï¼ˆlossä¸‹é™ç¼“æ…¢ï¼‰</li>
<li><strong>é»„é‡‘æ³•åˆ™</strong>ï¼šå¤§æ¨¡å‹å¾®è°ƒé€šå¸¸éœ€è¦<strong>æå°çš„å­¦ä¹ ç‡</strong>ï¼ˆ2e-5çº§åˆ«ï¼‰ï¼Œé…åˆ<strong>é¢„çƒ­ï¼ˆwarmupï¼‰</strong> Â è®©æ¨¡å‹å…ˆâ€œçƒ­èº«â€ï¼Œå†<strong>é€æ­¥è¡°å‡</strong>é€‚åº”ã€‚</li>
</ul>
<h4 data-id="heading-6">ï¼ˆ3ï¼‰è¿‡æ‹Ÿåˆï¼ˆOverfittingï¼‰ï¼šæ¨¡å‹æˆäº†â€œä¹¦å‘†å­â€</h4>
<p>è¡¨ç°ï¼šå¯¹è®­ç»ƒæ•°æ®å¯¹ç­”å¦‚æµï¼Œé‡åˆ°æ–°é—®é¢˜å°±â€œå‚»çœ¼â€ã€‚<br/>
æ ¹æºï¼šæ•°æ®é‡ä¸è¶³ã€è®­ç»ƒè½®æ¬¡è¿‡å¤šã€æ¨¡å‹å¤æ‚åº¦é«˜ã€‚<br/>
å¯¹ç­–ï¼šä½¿ç”¨<strong>éªŒè¯é›†ç›‘æ§</strong>ã€<strong>æ—©åœï¼ˆEarly Stoppingï¼‰</strong> ã€<strong>æ•°æ®å¢å¼º</strong>ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰ã€‚</p>
<hr/>
<h2 data-id="heading-7">äºŒã€å®è·µæ­¥éª¤ï¼šä¸ƒæ­¥æ‰“é€ é«˜è´¨é‡å¾®è°ƒæµæ°´çº¿</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e03f7ad8ccf440fa3757e30bc3e1634~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54u454yr566X5ZCb:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769772670&amp;x-signature=t7raeBxtCJ4FLwH189Q5PWLIjic%3D" alt="13413634352669512.jpeg" loading="lazy"/></p>
<h3 data-id="heading-8">æ­¥éª¤1ï¼šå®šä¹‰æ¸…æ™°çš„ä»»åŠ¡æ¨¡æ¿ï¼ˆSchemaï¼‰</h3>
<p><strong>é”™è¯¯ç¤ºèŒƒ</strong>ï¼ˆæ¨¡ç³ŠæŒ‡ä»¤ï¼‰ï¼š</p>
<p>json</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"instruction"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"åˆ†ææƒ…æ„Ÿ"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"input"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"è¿™æ¬¾æ‰‹æœºå¾ˆæ£’ï¼Œä½†ç”µæ± ä¸è¡Œã€‚"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"output"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ­£é¢"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>æ­£ç¡®ç¤ºèŒƒ</strong>ï¼ˆç»“æ„åŒ–ã€æ— æ­§ä¹‰ï¼‰ï¼š</p>
<p>json</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"instruction"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"è¯·å¯¹ä»¥ä¸‹å•†å“è¯„è®ºè¿›è¡Œæƒ…æ„Ÿåˆ†æï¼Œä¸¥æ ¼æŒ‰JSONæ ¼å¼è¾“å‡ºã€‚"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"input"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"è¯„è®ºï¼šè¿™æ¬¾æ‰‹æœºå¾ˆæ£’ï¼Œä½†ç”µæ± ä¸è¡Œã€‚"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"output"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"overall_sentiment"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"mixed"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"positive_aspects"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"è®¾è®¡"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"æ€§èƒ½"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"negative_aspects"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"ç”µæ± ç»­èˆª"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"confidence"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.85</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-9">æ­¥éª¤2ï¼šæ•°æ®æ¸…æ´—ä¸ƒæ­¥æ³•</h3>
<ol>
<li><strong>å»é‡</strong>ï¼šåˆ é™¤å®Œå…¨é‡å¤æˆ–é«˜åº¦ç›¸ä¼¼çš„æ ·æœ¬ï¼ˆè¯­ä¹‰ç›¸ä¼¼åº¦&gt;95%ï¼‰ã€‚</li>
<li><strong>å»å™ª</strong>ï¼šç§»é™¤HTMLæ ‡ç­¾ã€å¹¿å‘Šã€ä¹±ç ã€å¼‚å¸¸ç¬¦å·ã€‚</li>
<li><strong>æ ¼å¼åŒ–</strong>ï¼šç»Ÿä¸€æ—¥æœŸã€æ•°å­—ã€è´§å¸ç­‰æ ¼å¼ï¼ˆå¦‚â€œ$1,000â€è½¬ä¸ºâ€œ1000â€ï¼‰ã€‚</li>
<li><strong>é•¿åº¦è¿‡æ»¤</strong>ï¼šå‰”é™¤è¿‡çŸ­ï¼ˆå¦‚&lt;5è¯ï¼‰æˆ–è¿‡é•¿ï¼ˆè¶…å‡ºæ¨¡å‹é™åˆ¶ï¼‰çš„æ–‡æœ¬ã€‚</li>
<li><strong>è´¨é‡æ ‡æ³¨</strong>ï¼šå¯è®­ç»ƒç®€å•åˆ†ç±»å™¨è¯†åˆ«ä½è´¨é‡æ–‡æœ¬ï¼ˆå«å¤§é‡é”™åˆ«å­—ã€æ— æ„ä¹‰å¥å­ï¼‰ã€‚</li>
<li><strong>éšç§è„±æ•</strong>ï¼šæ›¿æ¢æ‰‹æœºå·ã€é‚®ç®±ã€èº«ä»½è¯ç­‰æ•æ„Ÿä¿¡æ¯ä¸ºå ä½ç¬¦ã€‚</li>
<li><strong>ç‰ˆæœ¬ç®¡ç†</strong>ï¼šä½¿ç”¨DVC/Gitç®¡ç†æ•°æ®é›†ç‰ˆæœ¬ï¼Œç¡®ä¿å®éªŒå¯å¤ç°ã€‚</li>
</ol>
<h3 data-id="heading-10">æ­¥éª¤3ï¼šæ„å»ºåˆ†å±‚éªŒè¯é›†</h3>
<ul>
<li><strong>æ¯”ä¾‹</strong>ï¼šè®­ç»ƒé›†:éªŒè¯é›† â‰ˆ 9:1ï¼ˆæ•°æ®é‡å°æ—¶å¯8:2ï¼‰</li>
<li><strong>å…³é”®</strong>ï¼šå¿…é¡»<strong>åˆ†å±‚æŠ½æ ·</strong>ï¼Œç¡®ä¿éªŒè¯é›†ä¸è®­ç»ƒé›†çš„ç±»åˆ«åˆ†å¸ƒä¸€è‡´ã€‚</li>
<li><strong>ç¤ºä¾‹</strong>ï¼ˆä½¿ç”¨Pythonï¼‰ï¼š</li>
</ul>
<p>python</p>
<pre><code class="hljs language-ini" lang="ini">from sklearn.model_selection import train_test_split
<span class="hljs-comment"># å‡è®¾æ¯ä¸ªæ ·æœ¬æœ‰categoryå­—æ®µ</span>
train_data, <span class="hljs-attr">val_data</span> = train_test_split(
    data, 
    <span class="hljs-attr">test_size</span>=<span class="hljs-number">0.1</span>, 
    <span class="hljs-attr">stratify</span>=[d[<span class="hljs-string">'category'</span>] for d in data],  <span class="hljs-comment"># æŒ‰ç±»åˆ«åˆ†å±‚</span>
    <span class="hljs-attr">random_state</span>=<span class="hljs-number">42</span>
)
</code></pre>
<h3 data-id="heading-11">æ­¥éª¤4ï¼šå‚æ•°é…ç½®æ¨¡æ¿ï¼ˆä»¥7Bæ¨¡å‹ä¸ºä¾‹ï¼‰</h3>
<p>python</p>
<pre><code class="hljs language-ini" lang="ini">from transformers import TrainingArguments

<span class="hljs-attr">training_args</span> = TrainingArguments(
    <span class="hljs-attr">output_dir</span>=<span class="hljs-string">"./my_finetuned_model"</span>,
    <span class="hljs-attr">learning_rate</span>=<span class="hljs-number">3</span>e-<span class="hljs-number">5</span>,           <span class="hljs-comment"># å…³é”®ï¼7Bæ¨¡å‹å»ºè®®2e-5~5e-5</span>
    <span class="hljs-attr">per_device_train_batch_size</span>=<span class="hljs-number">4</span>, <span class="hljs-comment"># æ ¹æ®æ˜¾å­˜è°ƒæ•´ï¼ˆA100å¯åˆ°8ï¼‰</span>
    <span class="hljs-attr">gradient_accumulation_steps</span>=<span class="hljs-number">8</span>, <span class="hljs-comment"># ç´¯ç§¯æ¢¯åº¦ï¼Œç­‰æ•ˆbatch_size=32</span>
    <span class="hljs-attr">num_train_epochs</span>=<span class="hljs-number">3</span>,           <span class="hljs-comment"># é€šå¸¸1-5è½®è¶³å¤Ÿ</span>
    <span class="hljs-attr">warmup_ratio</span>=<span class="hljs-number">0.1</span>,             <span class="hljs-comment"># å‰10%çš„stepç”¨äºå­¦ä¹ ç‡é¢„çƒ­</span>
    <span class="hljs-attr">lr_scheduler_type</span>=<span class="hljs-string">"cosine"</span>,   <span class="hljs-comment"># ä½™å¼¦è¡°å‡ï¼Œå¹³æ»‘ä¸‹é™</span>
    <span class="hljs-attr">evaluation_strategy</span>=<span class="hljs-string">"steps"</span>,  <span class="hljs-comment"># æ¯500æ­¥éªŒè¯ä¸€æ¬¡</span>
    <span class="hljs-attr">eval_steps</span>=<span class="hljs-number">500</span>,
    <span class="hljs-attr">save_steps</span>=<span class="hljs-number">500</span>,
    <span class="hljs-attr">logging_steps</span>=<span class="hljs-number">100</span>,
    <span class="hljs-attr">fp16</span>=<span class="hljs-literal">True</span>,                    <span class="hljs-comment"># å¯ç”¨æ··åˆç²¾åº¦ï¼ŒèŠ‚çœæ˜¾å­˜åŠ é€Ÿè®­ç»ƒ</span>
    <span class="hljs-attr">load_best_model_at_end</span>=<span class="hljs-literal">True</span>,  <span class="hljs-comment"># è®­ç»ƒç»“æŸæ—¶åŠ è½½æœ€ä½³æ¨¡å‹</span>
)
</code></pre>
<h3 data-id="heading-12">æ­¥éª¤5ï¼šLoRAé«˜æ•ˆå¾®è°ƒé…ç½®</h3>
<p>python</p>
<pre><code class="hljs language-ini" lang="ini">from peft import LoraConfig, get_peft_model

<span class="hljs-attr">lora_config</span> = LoraConfig(
    <span class="hljs-attr">r</span>=<span class="hljs-number">8</span>,                         <span class="hljs-comment"># ç§©ï¼ˆRankï¼‰ï¼Œ4-16ä¹‹é—´ï¼Œè¶Šå¤§èƒ½åŠ›è¶Šå¼ºä½†å‚æ•°è¶Šå¤š</span>
    <span class="hljs-attr">lora_alpha</span>=<span class="hljs-number">16</span>,               <span class="hljs-comment"># ç¼©æ”¾å› å­ï¼Œé€šå¸¸è®¾ä¸º2*r</span>
    <span class="hljs-attr">target_modules</span>=[<span class="hljs-string">"q_proj"</span>, <span class="hljs-string">"v_proj"</span>], <span class="hljs-comment"># æ³¨æ„åŠ›å±‚çš„å…³é”®æŠ•å½±çŸ©é˜µ</span>
    <span class="hljs-attr">lora_dropout</span>=<span class="hljs-number">0.05</span>,           <span class="hljs-comment"># é˜²æ­¢è¿‡æ‹Ÿåˆçš„dropout</span>
    <span class="hljs-attr">bias</span>=<span class="hljs-string">"none"</span>,
    <span class="hljs-attr">task_type</span>=<span class="hljs-string">"CAUSAL_LM"</span>        <span class="hljs-comment"># å› æœè¯­è¨€å»ºæ¨¡ï¼ˆç”¨äºæ–‡æœ¬ç”Ÿæˆï¼‰</span>
)
<span class="hljs-attr">model</span> = get_peft_model(model, lora_config)  <span class="hljs-comment"># ä¸ºåŸæ¨¡å‹æ³¨å…¥LoRAé€‚é…å™¨</span>
</code></pre>
<h3 data-id="heading-13">æ­¥éª¤6ï¼šè®­ç»ƒç›‘æ§ä¸å¯è§†åŒ–</h3>
<p><strong>å¿…é¡»ç›‘æ§çš„æŒ‡æ ‡</strong>ï¼š</p>
<ul>
<li><strong>Train Loss</strong>ï¼šåº”å¹³ç¨³ä¸‹é™ï¼Œè‹¥éœ‡è¡åˆ™å­¦ä¹ ç‡å¯èƒ½è¿‡å¤§</li>
<li><strong>Val Loss</strong>ï¼šåº”éšTrain LossåŒæ­¥ä¸‹é™ï¼Œè‹¥å¼€å§‹ä¸Šå‡åˆ™å¯èƒ½è¿‡æ‹Ÿåˆ</li>
<li><strong>GPUåˆ©ç”¨ç‡</strong>ï¼šåº”ä¿æŒåœ¨70%ä»¥ä¸Šï¼Œè¿‡ä½è¯´æ˜æ•°æ®åŠ è½½æˆ–å¤„ç†æœ‰ç“¶é¢ˆ</li>
<li><strong>å­¦ä¹ ç‡æ›²çº¿</strong>ï¼šæŒ‰é¢„å®šè®¡åˆ’ï¼ˆé¢„çƒ­â†’è¡°å‡ï¼‰å˜åŒ–</li>
</ul>
<p><strong>æ¨èå·¥å…·</strong>ï¼š</p>
<ul>
<li><strong>Weights &amp; Biasesï¼ˆWandBï¼‰</strong> ï¼šå®æ—¶å¯è§†åŒ–è®­ç»ƒé¢æ¿</li>
<li><strong>TensorBoard</strong>ï¼šæœ¬åœ°éƒ¨ç½²ï¼Œè½»é‡çº§ç›‘æ§</li>
</ul>
<h3 data-id="heading-14">æ­¥éª¤7ï¼šæ¨¡å‹è¯„ä¼°ä¸è¿­ä»£</h3>
<ol>
<li><strong>è‡ªåŠ¨è¯„ä¼°</strong>ï¼šåœ¨ä¿ç•™æµ‹è¯•é›†ä¸Šè®¡ç®—Perplexityï¼ˆå›°æƒ‘åº¦ï¼‰ã€BLEU/ROUGEï¼ˆæ–‡æœ¬ç”Ÿæˆï¼‰ã€å‡†ç¡®ç‡ç­‰æŒ‡æ ‡ã€‚</li>
<li><strong>äººå·¥è¯„ä¼°</strong>ï¼šè®¾è®¡è‡³å°‘50-100æ¡çœŸå®åœºæ™¯é—®é¢˜ï¼Œç”±é¢†åŸŸä¸“å®¶ä»ç›¸å…³æ€§ã€å‡†ç¡®æ€§ã€æµç•…åº¦æ‰“åˆ†ã€‚</li>
<li><strong>A/Bæµ‹è¯•</strong>ï¼šå°†å¾®è°ƒæ¨¡å‹ä¸åŸæ¨¡å‹å¹¶è¡Œéƒ¨ç½²ï¼Œæ”¶é›†çœŸå®ç”¨æˆ·åé¦ˆã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-15">ä¸‰ã€æ•ˆæœè¯„ä¼°ï¼šä½ çš„å¾®è°ƒæˆåŠŸäº†å—ï¼Ÿ</h2>
<h3 data-id="heading-16">ä¸‰çº§è¯„ä¼°ä½“ç³»</h3>

























<table><thead><tr><th>è¯„ä¼°å±‚çº§</th><th>è¯„ä¼°æ–¹æ³•</th><th>é€šè¿‡æ ‡å‡†</th></tr></thead><tbody><tr><td><strong>åŸºç¡€å±‚</strong></td><td>æŸå¤±å‡½æ•°æ›²çº¿</td><td>Train Losså¹³ç¨³ä¸‹é™ï¼ŒVal Lossæœªæ˜æ˜¾ä¸Šå‡</td></tr><tr><td><strong>ä»»åŠ¡å±‚</strong></td><td>æµ‹è¯•é›†æŒ‡æ ‡</td><td>å…³é”®æŒ‡æ ‡ï¼ˆå¦‚å‡†ç¡®ç‡ï¼‰æå‡&gt;10%ç›¸å¯¹åŸºçº¿</td></tr><tr><td><strong>åº”ç”¨å±‚</strong></td><td>äººå·¥ç›²æµ‹</td><td>åœ¨100æ¡çœŸå®ç”¨ä¾‹ä¸­ï¼Œå¾®è°ƒæ¨¡å‹åå¥½åº¦&gt;60%</td></tr></tbody></table>
<h3 data-id="heading-17">å¸¸è§é—®é¢˜è¯Šæ–­è¡¨</h3>






























<table><thead><tr><th>ç—‡çŠ¶</th><th>å¯èƒ½åŸå› </th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>Losså‰§çƒˆéœ‡è¡</td><td>å­¦ä¹ ç‡è¿‡å¤§ã€æ•°æ®å™ªå£°é«˜</td><td>é™ä½LR 50%ï¼Œæ£€æŸ¥æ•°æ®æ¸…æ´—</td></tr><tr><td>Losså‡ ä¹ä¸å˜</td><td>å­¦ä¹ ç‡è¿‡å°ã€æ¨¡å‹æœªè®­ç»ƒ</td><td>å¢å¤§LR 5å€ï¼Œæ£€æŸ¥å‚æ•°æ˜¯å¦å†»ç»“</td></tr><tr><td>Val LossæŒç»­ä¸Šå‡</td><td>ä¸¥é‡è¿‡æ‹Ÿåˆ</td><td>å¢åŠ Dropoutã€æ—©åœã€è¡¥å……æ•°æ®</td></tr><tr><td>è¾“å‡ºä¹±ç /é‡å¤</td><td>æ•°æ®æ ¼å¼æ··ä¹±ã€æ¸©åº¦å‚æ•°è¿‡ä½</td><td>ç»Ÿä¸€æ•°æ®æ ¼å¼ï¼Œè°ƒæ•´ç”Ÿæˆæ¸©åº¦è‡³0.7-0.9</td></tr></tbody></table>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d7851d491dc4c568d5423755e00c199~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54u454yr566X5ZCb:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769772670&amp;x-signature=LQfaFy71YL3JYhYRwsAzOfBRz3Y%3D" alt="1000.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-18">å››ã€æ€»ç»“ä¸å±•æœ›</h2>
<h3 data-id="heading-19">æ ¸å¿ƒå¿ƒæ³•ï¼šå¾®è°ƒä¸æ˜¯ä¸€è¹´è€Œå°±çš„â€œç‚¼ä¸¹â€ï¼Œè€Œæ˜¯æŒç»­è¿­ä»£çš„â€œç²¾é…¿â€</h3>
<ol>
<li><strong>æ•°æ®ä¸ºç‹</strong>ï¼š90%çš„å¾®è°ƒé—®é¢˜æºäºæ•°æ®è´¨é‡ã€‚æŠ•å…¥æ•°æ®æ¸…æ´—çš„æ—¶é—´ï¼Œå¾€å¾€æ¯”è°ƒå‚æ›´æœ‰å›æŠ¥ã€‚</li>
<li><strong>å°æ­¥å¿«è·‘</strong>ï¼šå…ˆç”¨å°è§„æ¨¡æ•°æ®ï¼ˆ100-1000æ¡ï¼‰éªŒè¯æµç¨‹ï¼Œå†é€æ­¥æ‰©å¤§ã€‚</li>
<li><strong>ç›‘æ§å…ˆè¡Œ</strong>ï¼šæ²¡æœ‰ç›‘æ§çš„è®­ç»ƒå¦‚åŒç›²é£ï¼Œå¿…é¡»å®æ—¶è¿½è¸ªå…³é”®æŒ‡æ ‡ã€‚</li>
<li><strong>æ¸è¿›è°ƒæ•´</strong>ï¼šæ¯æ¬¡åªè°ƒæ•´1-2ä¸ªè¶…å‚æ•°ï¼Œè®°å½•ç»“æœï¼Œå»ºç«‹ä½ çš„â€œå‚æ•°ç›´è§‰â€ã€‚</li>
</ol>
<h3 data-id="heading-20">æœªæ¥è¶‹åŠ¿</h3>
<ul>
<li><strong>è‡ªåŠ¨åŒ–å¾®è°ƒ</strong>ï¼šAutoMLæŠ€æœ¯å°†é€æ­¥åº”ç”¨äºè¶…å‚æ•°æœç´¢ä¸æ¶æ„é€‰æ‹©</li>
<li><strong>ä¸ªæ€§åŒ–é€‚é…</strong>ï¼šå•æ ·æœ¬/å°‘æ ·æœ¬å¾®è°ƒæŠ€æœ¯è®©ä¸ªäººä¸“å±æ¨¡å‹æˆä¸ºå¯èƒ½</li>
<li><strong>ç”Ÿæ€é›†æˆ</strong>ï¼šå¾®è°ƒå¹³å°å°†æ›´æ·±åº¦é›†æˆæ•°æ®æ¸…æ´—ã€è¯„ä¼°ã€éƒ¨ç½²å…¨é“¾è·¯</li>
</ul>
<p>æƒ³è¦äº²èº«ä½“éªŒå¤§æ¨¡å‹å¾®è°ƒçš„å…¨æµç¨‹ï¼Œä½†åˆå›°æ‰°äºä»£ç ç¯å¢ƒã€GPUé…ç½®å’Œå‚æ•°è°ƒè¯•ï¼Ÿ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.llamafactory.com.cn%2Fregister%3Futm_source%3Djslt_xtjj_wsy" target="_blank" title="https://www.llamafactory.com.cn/register?utm_source=jslt_xtjj_wsy" ref="nofollow noopener noreferrer"><strong>LLaMA-Factory Online</strong></a>æä¾›äº†é›¶é—¨æ§›çš„è§£å†³æ–¹æ¡ˆã€‚åªéœ€ä¸Šä¼ ä½ çš„æ•°æ®é›†ï¼ˆæ”¯æŒExcelã€JSONã€TXTç­‰æ ¼å¼ï¼‰ï¼Œé€šè¿‡å¯è§†åŒ–ç•Œé¢é€‰æ‹©ä»»åŠ¡ç±»å‹å’Œæ¨¡å‹åŸºç¡€ï¼Œå¹³å°ä¼šè‡ªåŠ¨æ¨èæœ€ä¼˜å‚æ•°é…ç½®ï¼Œå¹¶åœ¨äº‘ç«¯å®Œæˆè®­ç»ƒã€è¯„ä¼°å’Œéƒ¨ç½²ã€‚æ— è®ºæ˜¯æƒ³è®©AIå­¦ä¹ ä½ çš„äº§å“æ–‡æ¡£ï¼Œè¿˜æ˜¯æ‰“é€ ä¸“å±çš„å†™ä½œåŠ©æ‰‹ï¼Œéƒ½èƒ½åœ¨1å°æ—¶å†…çœ‹åˆ°åˆæ­¥æ•ˆæœã€‚</p>
<h3 data-id="heading-21">æœ€åçš„é¼“åŠ±</h3>
<p>æ¯ä¸€ä½AIå®è·µè€…çš„æ—…ç¨‹ï¼Œéƒ½æ˜¯ä»ç¬¬ä¸€æ¬¡å¾®è°ƒå¼€å§‹çš„ã€‚è¿‡ç¨‹ä¸­ä½ å¯èƒ½ä¼šé‡åˆ°lossä¸é™çš„ç„¦è™‘ã€è¾“å‡ºæ··ä¹±çš„å›°æƒ‘ï¼Œä½†æ¯ä¸€æ¬¡è°ƒè¯•éƒ½æ˜¯ä½ å¯¹æ¨¡å‹ç†è§£åŠ æ·±çš„æœºä¼šã€‚è®°ä½é‚£å¥è€è¯ï¼š <strong>â€œæ²¡æœ‰å®Œç¾çš„å¾®è°ƒï¼Œåªæœ‰ä¸æ–­è¿­ä»£çš„ä¼˜åŒ–ã€‚â€</strong></p>
<p>ç°åœ¨ï¼Œæ˜¯æ—¶å€™ç”¨ä½ çš„æ•°æ®ï¼Œè®©å¤§æ¨¡å‹çœŸæ­£â€œä¸ºä½ æ‰€ç”¨â€äº†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RAG-ç´¢å¼•æ„å»º]]></title>    <link>https://juejin.cn/post/7598418891400200246</link>    <guid>https://juejin.cn/post/7598418891400200246</guid>    <pubDate>2026-01-23T13:12:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598418891400200246" data-draft-id="7597746390434250788" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RAG-ç´¢å¼•æ„å»º"/> <meta itemprop="keywords" content="Agent,LLM"/> <meta itemprop="datePublished" content="2026-01-23T13:12:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="YaeZed"/> <meta itemprop="url" content="https://juejin.cn/user/3977350021390107"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RAG-ç´¢å¼•æ„å»º
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3977350021390107/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    YaeZed
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T13:12:46.000Z" title="Fri Jan 23 2026 13:12:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1:hover .anchor .octicon-link:before,.markdown-body h2:hover .anchor .octicon-link:before,.markdown-body h3:hover .anchor .octicon-link:before,.markdown-body h4:hover .anchor .octicon-link:before,.markdown-body h5:hover .anchor .octicon-link:before,.markdown-body h6:hover .anchor .octicon-link:before{width:16px;height:16px;content:" ";display:inline-block;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E")}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body details{display:block}.markdown-body summary{display:list-item}.markdown-body a{background-color:initial}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body strong{font-weight:inherit;font-weight:bolder}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace;font-size:1em}.markdown-body hr{box-sizing:initial;overflow:visible}.markdown-body input{font:inherit;margin:0;overflow:visible}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body a{color:#0366d6;text-decoration:none}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border-bottom:1px solid #dfe2e5}.markdown-body hr:after,.markdown-body hr:before{display:table;content:""}.markdown-body hr:after{clear:both}.markdown-body table{border-spacing:0;border-collapse:collapse}.markdown-body td,.markdown-body th{padding:0}.markdown-body details summary{cursor:pointer}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:0;margin-bottom:0}.markdown-body h1{font-size:32px}.markdown-body h1,.markdown-body h2{font-weight:600}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:20px}.markdown-body h3,.markdown-body h4{font-weight:600}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:14px}.markdown-body h5,.markdown-body h6{font-weight:600}.markdown-body h6{font-size:12px}.markdown-body p{margin-top:0;margin-bottom:10px}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{padding-left:0;margin-top:0;margin-bottom:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code,.markdown-body pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}.markdown-body pre{margin-top:0;margin-bottom:0}.markdown-body input::-webkit-inner-spin-button,.markdown-body input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none;appearance:none}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .border{border:1px solid #e1e4e8!important}.markdown-body .border-0{border:0!important}.markdown-body .border-bottom{border-bottom:1px solid #e1e4e8!important}.markdown-body .rounded-1{border-radius:3px!important}.markdown-body .bg-white{background-color:#fff!important}.markdown-body .bg-gray-light{background-color:#fafbfc!important}.markdown-body .text-gray-light{color:#6a737d!important}.markdown-body .pl-3,.markdown-body .px-3{padding-left:16px!important}.markdown-body .px-3{padding-right:16px!important}.markdown-body .f6{font-size:12px!important}.markdown-body .lh-condensed{line-height:1.25!important}.markdown-body .text-bold{font-weight:600!important}.markdown-body .pl-c{color:#6a737d}.markdown-body .pl-c1,.markdown-body .pl-s .pl-v{color:#005cc5}.markdown-body .pl-e,.markdown-body .pl-en{color:#6f42c1}.markdown-body .pl-s .pl-s1,.markdown-body .pl-smi{color:#24292e}.markdown-body .pl-ent{color:#22863a}.markdown-body .pl-k{color:#d73a49}.markdown-body .pl-pds,.markdown-body .pl-s,.markdown-body .pl-s .pl-pse .pl-s1,.markdown-body .pl-sr,.markdown-body .pl-sr .pl-cce,.markdown-body .pl-sr .pl-sra,.markdown-body .pl-sr .pl-sre{color:#032f62}.markdown-body .pl-smw,.markdown-body .pl-v{color:#e36209}.markdown-body .pl-bu{color:#b31d28}.markdown-body .pl-ii{color:#fafbfc;background-color:#b31d28}.markdown-body .pl-c2{color:#fafbfc;background-color:#d73a49}.markdown-body .pl-c2:before{content:"^M"}.markdown-body .pl-sr .pl-cce{font-weight:700;color:#22863a}.markdown-body .pl-ml{color:#735c0f}.markdown-body .pl-mh,.markdown-body .pl-mh .pl-en,.markdown-body .pl-ms{font-weight:700;color:#005cc5}.markdown-body .pl-mi{font-style:italic;color:#24292e}.markdown-body .pl-mb{font-weight:700;color:#24292e}.markdown-body .pl-md{color:#b31d28;background-color:#ffeef0}.markdown-body .pl-mi1{color:#22863a;background-color:#f0fff4}.markdown-body .pl-mc{color:#e36209;background-color:#ffebda}.markdown-body .pl-mi2{color:#f6f8fa;background-color:#005cc5}.markdown-body .pl-mdr{font-weight:700;color:#6f42c1}.markdown-body .pl-ba{color:#586069}.markdown-body .pl-sg{color:#959da5}.markdown-body .pl-corl{text-decoration:underline;color:#032f62}.markdown-body .mb-0{margin-bottom:0!important}.markdown-body .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown-body .pl-0{padding-left:0!important}.markdown-body .py-0{padding-top:0!important;padding-bottom:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .py-2{padding-top:8px!important;padding-bottom:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body .pl-7{padding-left:48px!important}.markdown-body .pl-8{padding-left:64px!important}.markdown-body .pl-9{padding-left:80px!important}.markdown-body .pl-10{padding-left:96px!important}.markdown-body .pl-11{padding-left:112px!important}.markdown-body .pl-12{padding-left:128px!important}.markdown-body hr{border-bottom-color:#eee}.markdown-body kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body&gt;:first-child{margin-top:0!important}.markdown-body&gt;:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body blockquote,.markdown-body details,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eaecef}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li{word-wrap:break-all}.markdown-body li&gt;p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:initial;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body code{padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body pre{word-wrap:normal}.markdown-body pre&gt;code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:initial;border:0}.markdown-body .commit-tease-sha{display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%;color:#444d56}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown-body .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown-body .blob-num{width:1%;min-width:50px;padding-right:10px;padding-left:10px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-body .blob-num:hover{color:rgba(27,31,35,.6)}.markdown-body .blob-num:before{content:attr(data-line-number)}.markdown-body .blob-code{position:relative;padding-right:10px;padding-left:10px;line-height:20px;vertical-align:top}.markdown-body .blob-code-inner{overflow:visible;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;color:#24292e;word-wrap:normal;white-space:pre}.markdown-body .pl-token.active,.markdown-body .pl-token:hover{cursor:pointer;background:#ffea7f}.markdown-body .tab-size[data-tab-size="1"]{-moz-tab-size:1;tab-size:1}.markdown-body .tab-size[data-tab-size="2"]{-moz-tab-size:2;tab-size:2}.markdown-body .tab-size[data-tab-size="3"]{-moz-tab-size:3;tab-size:3}.markdown-body .tab-size[data-tab-size="4"]{-moz-tab-size:4;tab-size:4}.markdown-body .tab-size[data-tab-size="5"]{-moz-tab-size:5;tab-size:5}.markdown-body .tab-size[data-tab-size="6"]{-moz-tab-size:6;tab-size:6}.markdown-body .tab-size[data-tab-size="7"]{-moz-tab-size:7;tab-size:7}.markdown-body .tab-size[data-tab-size="8"]{-moz-tab-size:8;tab-size:8}.markdown-body .tab-size[data-tab-size="9"]{-moz-tab-size:9;tab-size:9}.markdown-body .tab-size[data-tab-size="10"]{-moz-tab-size:10;tab-size:10}.markdown-body .tab-size[data-tab-size="11"]{-moz-tab-size:11;tab-size:11}.markdown-body .tab-size[data-tab-size="12"]{-moz-tab-size:12;tab-size:12}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}</style><style data-highlight="" data-highlight-key="gml">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#222;color:silver}.hljs-keyword{color:#ffb871;font-weight:700}.hljs-built_in{color:#ffb871}.hljs-literal{color:#ff8080}.hljs-symbol{color:#58e55a}.hljs-comment{color:#5b995b}.hljs-string{color:#ff0}.hljs-number{color:#ff8080}.hljs-addition,.hljs-attribute,.hljs-bullet,.hljs-code,.hljs-deletion,.hljs-doctag,.hljs-function,.hljs-link,.hljs-meta,.hljs-meta-keyword,.hljs-name,.hljs-quote,.hljs-regexp,.hljs-section,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-selector-tag,.hljs-subst,.hljs-template-tag,.hljs-template-variable,.hljs-title,.hljs-type,.hljs-variable{color:silver}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€.å‘é‡åµŒå…¥Embedding</h2>
<h3 data-id="heading-1">1.ä»€ä¹ˆæ˜¯Embedding</h3>
<ul>
<li>
<p><strong>æ ¸å¿ƒå®šä¹‰</strong>ï¼šå°†éç»“æ„åŒ–çš„æ•°æ®ï¼ˆå¦‚æ–‡æœ¬ï¼ŒéŸ³é¢‘ï¼Œå›¾ç‰‡ç­‰ï¼‰æ˜ å°„ä¸ºä½ç»´ï¼Œç¨ å¯†ï¼Œè¿ç»­çš„å®æ•°å‘é‡çš„è¿‡ç¨‹ã€‚</p>
</li>
<li>
<p><strong>ä¸‰è¦ç´ </strong>ï¼š</p>
<ul>
<li>
<p><strong>æ•°æ®</strong>ï¼šåŸå§‹çš„æ•°æ®å†…å®¹</p>
</li>
<li>
<p><strong>åµŒå…¥æ¨¡å‹</strong>ï¼šæ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œå°†è¯­ä¹‰è½¬æ¢ä¸ºæ•°å€¼</p>
</li>
<li>
<p><strong>è¾“å‡ºå‘é‡</strong>ï¼šå›ºå®šé•¿åº¦çš„ä¸€ç»´æ•°ç»„ï¼Œå‘é‡é—´çš„è·ç¦»ä»£è¡¨äº†è¯­ä¹‰çš„ç›¸ä¼¼åº¦</p>
</li>
</ul>
</li>
</ul>
<h3 data-id="heading-2">2.Embeddingçš„å‘å±•å†ç¨‹</h3>
<ul>
<li>
<p><strong>é™æ€ Embedding (Static Embedding)</strong> ï¼š</p>
<ul>
<li>
<p><strong>ä»£è¡¨ç®—æ³•</strong>ï¼šWord2Vec (Skip-gram, CBOW), GloVeã€‚</p>
</li>
<li>
<p><strong>ç‰¹ç‚¹</strong>ï¼šæ¯ä¸ªè¯å¯¹åº”ä¸€ä¸ªå›ºå®šå‘é‡ï¼Œä¸ä¸Šä¸‹æ–‡æ— å…³ã€‚</p>
</li>
<li>
<p><strong>å±€é™æ€§</strong>ï¼šæ— æ³•è§£å†³<strong>ä¸€è¯å¤šä¹‰</strong>é—®é¢˜ï¼ˆä¾‹å¦‚â€œè‹¹æœâ€åœ¨ä¸åŒè¯­å¢ƒä¸‹æŒ‡æ°´æœæˆ–å…¬å¸ï¼Œå…¶å‘é‡æ˜¯ä¸€æ ·çš„ï¼‰ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>ä¸Šä¸‹æ–‡ç›¸å…³ Embedding (Contextual Embedding)</strong> ï¼š</p>
<ul>
<li>
<p><strong>ä»£è¡¨ç®—æ³•</strong>ï¼šBERT, RoBERTa ç­‰ Transformer æ¶æ„æ¨¡å‹ã€‚</p>
</li>
<li>
<p><strong>ç‰¹ç‚¹</strong>ï¼šåŒä¸€ä¸ªè¯åœ¨ä¸åŒè¯­å¢ƒä¸‹ä¼šç”Ÿæˆä¸åŒçš„å‘é‡ã€‚</p>
</li>
<li>
<p><strong>è®­ç»ƒæœºåˆ¶</strong>ï¼šé€šè¿‡å¤§è§„æ¨¡é¢„è®­ç»ƒï¼ˆå¦‚ BERT çš„æ©ç è¯­è¨€æ¨¡å‹ MLM å’Œä¸‹ä¸€å¥é¢„æµ‹ NSPï¼‰æ¥æ•è·æ·±å±‚è¯­ä¹‰ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>RAGå¯¹åµŒå…¥æŠ€æœ¯çš„æ–°è¦æ±‚</strong></p>
<ul>
<li>
<p><strong>é¢†åŸŸè‡ªé€‚åº”èƒ½åŠ›</strong>ï¼šé€šç”¨çš„åµŒå…¥æ¨¡å‹åœ¨æŸäº›ä¸“ä¸šé¢†åŸŸä¸Šè¡¨ç°å¯èƒ½ä¸å¤ªå¥½ï¼Œè¿™å°±è¦æ±‚åµŒå…¥æ¨¡å‹å…·æœ‰è‡ªé€‚åº”èƒ½åŠ›ã€‚</p>
</li>
<li>
<p><strong>å¤šæ¨¡æ€å’Œç»†ç²’åº¦</strong>ï¼šRAGç³»ç»Ÿä¸åªæ˜¯å¤„ç†æ–‡å­—ï¼Œè¿˜å¯èƒ½åŒ…æ‹¬é•¿æ–‡æ¡£ï¼Œå¯Œæ–‡æœ¬ï¼Œå›¾ç‰‡ç­‰ç±»å‹çš„æ•°æ®ã€‚</p>
</li>
<li>
<p><strong>æ£€ç´¢è§„åˆ™ä¸æ•ˆç‡</strong>:åµŒå…¥å‘é‡çš„ç»´åº¦å’Œæ¨¡å‹å¤§å°ç›´æ¥å½±å“å­˜å‚¨æˆæœ¬å’Œæ£€ç´¢é€Ÿåº¦ï¼Œè¿™å°±éœ€è¦åµŒå…¥æ¨¡å‹èƒ½å¤Ÿç»“åˆè¯­ä¹‰ç›¸ä¼¼æ€§å’Œå…³é”®è¯åŒ¹é…çš„ä¼˜ç‚¹ï¼Œæ”¯æŒ<strong>æ··åˆæ£€ç´¢</strong>ï¼Œä¾‹å¦‚<strong>BGE-M3</strong>ã€‚</p>
</li>
</ul>
</li>
</ul>
<h3 data-id="heading-3">3.RAGåœºæ™¯ä¸‹å¦‚ä½•é€‰æ‹©Embeddingæ¨¡å‹</h3>
<p>åœ¨æ„å»ºRAGç³»ç»Ÿæ—¶ï¼Œé€‰æ‹©åµŒå…¥æ¨¡å‹éœ€è¦ç»¼åˆè€ƒè™‘ä»¥ä¸‹7ä¸ªç‚¹ï¼š</p>
<ul>
<li>
<p><strong>æœ€å¤§tokensæ•°</strong>ï¼šåµŒå…¥æ¨¡å‹æ”¯æŒçš„æœ€å¤§tokensæ•°ç›´æ¥å†³å®šäº†å‰é¢æ–‡æœ¬åˆ†å—çš„å¤§å°ï¼Œä¸èƒ½è¶…è¿‡æœ€å¤§tokensæ•°ã€‚</p>
</li>
<li>
<p><strong>æ”¯æŒè¯­è¨€</strong>ï¼šç¡®ä¿æ¨¡å‹æ”¯æŒä¸šåŠ¡éœ€è¦çš„è¯­è¨€ï¼Œä¸­æ–‡RAGå»ºè®®é€‰æ‹©ä¸­è‹±åŒè¯­æˆ–å¤šè¯­è¨€æ¨¡å‹ï¼ˆBGEï¼ŒBCEï¼‰ã€‚</p>
</li>
<li>
<p><strong>æ¨¡å‹å¤§å°</strong>ï¼šå‚æ•°é‡é€šå¸¸è¶Šå¤šè¶Šå¥½ï¼Œä½†æ˜¯ä¼šå¢åŠ æ¨ç†å»¶è¿Ÿå’Œæ˜¾å­˜å ç”¨ã€‚</p>
</li>
<li>
<p><strong>å‘é‡ç»´åº¦</strong>ï¼›é«˜ç»´åº¦ä¸‹ç¼–ç ä¿¡æ¯ä¸°å¯Œï¼Œä½†æ˜¯ä¼šå¢åŠ å‘é‡æ•°æ®åº“çš„å­˜å‚¨å‹åŠ›å’Œæ£€ç´¢æ—¶çš„è®¡ç®—é‡ã€‚</p>
</li>
<li>
<p><strong>ä»»åŠ¡</strong>ï¼šé‡ç‚¹å…³æ³¨æ¨¡å‹åœ¨<strong>æ£€ç´¢</strong>ä»»åŠ¡ä¸‹çš„è¡¨ç°ï¼Œè€Œéå•çº¯çš„èšç±»æˆ–åˆ†ç±»å¾—åˆ†ã€‚</p>
</li>
<li>
<p><strong>å¾—åˆ†ä¸æœºæ„ (Score &amp; Publisher)</strong> ï¼šå‚è€ƒ <strong>MTEB / C-MTEB</strong> æ¦œå•æ’åï¼Œä¼˜å…ˆé€‰æ‹©çŸ¥åæœºæ„ï¼ˆå¦‚æ™ºæº BGEã€OpenAIã€ç½‘æ˜“ BCE ç­‰ï¼‰å‘å¸ƒçš„æ¨¡å‹ã€‚</p>
</li>
<li>
<p><strong>æˆæœ¬ (Cost)</strong> ï¼š</p>
<ul>
<li><strong>API æœåŠ¡</strong>ï¼šæŒ‰é‡è®¡è´¹ï¼Œè¿ç»´é›¶å‹åŠ›ã€‚</li>
<li><strong>ç§æœ‰åŒ–éƒ¨ç½²</strong>ï¼šéœ€è€ƒè™‘æ˜¾å¡ç¡¬ä»¶æˆæœ¬å’Œè¿ç»´äººåŠ›ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-4">4.æ ¸å¿ƒè¯„ä¼°è¡¨å•</h3>
<ul>
<li>
<p><strong>MTEB (Massive Text Embedding Benchmark)</strong> æ˜¯ç›®å‰è¡¡é‡ Embedding æ¨¡å‹æœ€æƒå¨çš„æ ‡å‡†ã€‚</p>
</li>
<li>
<p>å¯¹äºä¸­æ–‡åº”ç”¨ï¼Œåº”é‡ç‚¹å‚è€ƒ <strong>C-MTEB</strong> åˆ†æ”¯ï¼ŒæŸ¥çœ‹æ¨¡å‹åœ¨â€œæ£€ç´¢ï¼ˆRetrievalï¼‰â€å­é¡¹ä¸Šçš„å…·ä½“æ’åã€‚</p>
</li>
</ul>
<h2 data-id="heading-5">äºŒ.å¤šæ¨¡æ€åµŒå…¥</h2>
<h3 data-id="heading-6">1.ä¸ºä»€ä¹ˆéœ€è¦å¤šæ¨¡æ€ï¼Ÿ</h3>
<ul>
<li>
<p><strong>æ‰“ç ´â€œæ¨¡æ€å¢™â€</strong>ï¼šç°å®ä¸–ç•Œçš„ä¿¡æ¯åŒ…å«æ–‡å­—ï¼Œå›¾åƒï¼ŒéŸ³é¢‘ï¼Œè§†é¢‘ç­‰å¤šç§å½¢å¼ï¼Œä¼ ç»Ÿçš„æ–‡æœ¬Embeddingæ¨¡å‹åªèƒ½å¤„ç†æ–‡å­—ï¼Œæ— æ³•ç†è§£å…¶ä»–ç±»å‹çš„å†…å®¹ã€‚</p>
</li>
<li>
<p><strong>æ ¸å¿ƒç›®æ ‡</strong>ï¼šå°†ä¸Šè¿°ä¸åŒç±»å‹çš„æ•°æ®æ˜ å°„åˆ°ç»Ÿä¸€çš„å‘é‡ç©ºé—´ä¸­ã€‚</p>
</li>
<li>
<p><strong>è·¨æ¨¡æ€å¯¹é½</strong>ï¼šåœ¨ç»Ÿä¸€å‘é‡ç©ºé—´ä¸­ï¼Œè¯­ä¹‰ç›¸è¿‘çš„â€œæ–‡å­—å‘é‡â€å’Œâ€œå›¾ç‰‡å‘é‡â€ä¼šéå¸¸æ¥è¿‘ï¼Œä»è€Œå®ç°â€œä»¥æ–‡æœå›¾â€æˆ–â€œä»¥å›¾æœæ–‡â€çš„åŠŸèƒ½ã€‚</p>
</li>
</ul>
<h3 data-id="heading-7">2.CLIPæ¨¡å‹ï¼šå¤šæ¨¡æ€åµŒå…¥çš„é‡Œç¨‹ç¢‘</h3>
<p>ç”±OpenAIå‘å¸ƒï¼Œä¸ºè¯¥é¢†åŸŸå¥ å®šäº†åŸºç¡€ã€‚</p>
<ul>
<li>
<p><strong>åŒç¼–ç æ¶æ„</strong>ï¼šåŒ…å«ä¸€ä¸ªå›¾åƒç¼–ç å™¨å’Œæ–‡å­—ç¼–ç å™¨ï¼Œåˆ†åˆ«å¤„ç†è¾“å…¥å†…å®¹ã€‚</p>
</li>
<li>
<p><strong>å¯¹æ¯”å­¦ä¹ </strong>ï¼šä¸ºäº†èƒ½è®©ä¸¤ä¸ªç¼–ç å™¨å¯¹é½ä¸åŒæ¨¡æ€çš„è¯­ä¹‰ï¼ŒCLIPåœ¨è®­ç»ƒæ—¶é‡‡ç”¨æ‹‰è¿‘æ­£ç¡®çš„å›¾æ–‡å¯¹ï¼ˆæ­£ä¾‹ï¼‰ï¼Œæ¨è¿œé”™è¯¯çš„é…å¯¹ï¼ˆè´Ÿä¾‹ï¼‰ï¼Œé€šè¿‡æµ·é‡çš„è®­ç»ƒæ•°æ®ï¼Œæ¨¡å‹èƒ½å¤Ÿè‡ªåŠ¨å­¦ä¼šå°†è¯­ä¹‰ç›¸è¿‘çš„å›¾æ–‡åœ¨å‘é‡ç©ºé—´ä¸­æ‹‰è¿‘ã€‚è¿™ç§å¤§è§„æ¨¡çš„å¯¹æ¯”å­¦ä¹ ï¼Œèµ‹äºˆäº†CLIPæœ‰æ•ˆçš„é›¶æ ·æœ¬è¯†åˆ«èƒ½åŠ›ã€‚</p>
</li>
</ul>
<h3 data-id="heading-8">3.ç°ä»£å¤šæ¨¡æ€æ¨¡å‹ï¼šbge-visualized-m3</h3>
<p>ç”±åŒ—äº¬æ™ºæºç ”ç©¶é™¢ç ”å‘ï¼Œå…¶æ ¸å¿ƒç‰¹æ€§å¯æ€»ç»“ä¸ºâ€œ<strong>M3</strong>â€ã€‚</p>
<ul>
<li>
<p><strong>å¤šè¯­è¨€ (Multi-Linguality)</strong> ï¼šæ”¯æŒ 100 å¤šç§è¯­è¨€ï¼Œå¯å®ç°è·¨è¯­è¨€çš„å›¾æ–‡æ£€ç´¢ã€‚</p>
</li>
<li>
<p><strong>å¤šåŠŸèƒ½ (Multi-Functionality)</strong> ï¼šåŒæ—¶æ”¯æŒç¨ å¯†æ£€ç´¢ã€å¤šå‘é‡æ£€ç´¢å’Œç¨€ç–æ£€ç´¢ã€‚</p>
</li>
<li>
<p><strong>å¤šç²’åº¦ (Multi-Granularity)</strong> ï¼šèƒ½å¤„ç†ä»çŸ­å¥åˆ°é•¿è¾¾ 8192 token çš„æ–‡æ¡£ã€‚</p>
</li>
</ul>
<h2 data-id="heading-9">ä¸‰.å‘é‡æ•°æ®åº“</h2>
<p>åœ¨RAGæµç¨‹ä¸­ï¼Œå‘é‡æ•°æ®åº“æ˜¯å­˜å‚¨â€œçŸ¥è¯†è®°å¿†â€çš„æ ¸å¿ƒä»“åº“ï¼Œå®ƒè´Ÿè´£é«˜æ•ˆç®¡ç†ç”±Embeddingæ¨¡å‹ç”Ÿæˆçš„å‘é‡ï¼Œå¹¶å®ç°åœ¨æµ·é‡æ•°æ®ä¸­çš„å¿«é€Ÿæ£€ç´¢ã€‚</p>
<h3 data-id="heading-10">1.å‘é‡æ•°æ®åº“çš„ä¸»è¦åŠŸèƒ½</h3>
<ul>
<li>
<p><strong>é«˜æ•ˆå­˜å‚¨</strong>ï¼šä¸“é—¨ç”¨äºå­˜å‚¨ç”±éç»“æ„åŒ–æ•°æ®ï¼ˆæ–‡æœ¬ï¼Œå›¾åƒç­‰ï¼‰ç»Embeddingæ¨¡å‹è½¬åŒ–çš„é«˜ç»´å‘é‡ã€‚</p>
</li>
<li>
<p><strong>ç›¸ä¼¼åº¦æ£€ç´¢</strong>ï¼šä¸åŒäºä¼ ç»Ÿæ•°æ®åº“çš„<strong>å…³é”®è¯åŒ¹é…</strong>ï¼Œå‘é‡æ•°æ®åº“æ”¯æŒ<strong>è¯­ä¹‰åŒ¹é…</strong>ï¼Œå³é€šè¿‡è®¡ç®—å‘é‡ä¹‹é—´çš„è·ç¦»ï¼ˆå¦‚ä½™å¼¦å€¼ï¼‰æ¥æŸ¥æ‰¾å«ä¹‰æœ€ç›¸è¿‘çš„å†…å®¹ã€‚</p>
</li>
<li>
<p><strong>ä½å»¶è¿Ÿæœç´¢</strong>ï¼šè¿™æ˜¯å‘é‡æ•°æ®æœ€é‡è¦çš„åŠŸèƒ½ã€‚é€šè¿‡ç´¢å¼•ç®—æ³•ï¼ˆHNSW,IVFï¼‰ï¼Œåœ¨ç™¾ä¸‡æ•°æ®ä¸­å®ç°æ¯«ç§’çº§çš„æ£€ç´¢å“åº”ã€‚</p>
</li>
</ul>
<h3 data-id="heading-11">2.å‘é‡æ•°æ®åº“ VS ä¼ ç»Ÿæ•°æ®åº“</h3>
<p>å¯¹äºé«˜ç»´ä¸”æ•°æ®é‡åºå¤§çš„ç”Ÿæˆå‘é‡é›†åˆï¼Œä¼ ç»Ÿæ•°æ®åº“åœ¨è¿›è¡Œç›¸ä¼¼åº¦è®¡ç®—æ—¶ï¼Œè®¡ç®—æˆæœ¬å’Œæ—¶é—´å»¶è¿Ÿæ˜¯æ— æ³•æ¥å—çš„ï¼Œå‘é‡æ•°æ®åº“å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸€ç—›ç‚¹ã€‚</p>



































<table><thead><tr><th/><th align="center">ä¼ ç»Ÿæ•°æ®åº“</th><th align="center">å‘é‡æ•°æ®åº“</th></tr></thead><tbody><tr><td>å­˜å‚¨å¯¹è±¡</td><td align="center">ç»“æ„åŒ–æ•°æ®</td><td align="center">é«˜ç»´å‘é‡</td></tr><tr><td>æŸ¥è¯¢æ–¹å¼</td><td align="center">å…³é”®å­—ç²¾ç¡®åŒ¹é…</td><td align="center">ç›¸ä¼¼åº¦æœç´¢</td></tr><tr><td>ç´¢å¼•æœºåˆ¶</td><td align="center">bæ ‘ï¼Œå“ˆå¸Œ</td><td align="center">IVFï¼ŒHNSW</td></tr><tr><td>ä½¿ç”¨åœºæ™¯</td><td align="center">ä¸šåŠ¡ç³»ç»Ÿï¼Œé‡‘è</td><td align="center">å¤§æ¨¡å‹åº”ç”¨ï¼ŒRAG</td></tr><tr><td>ä¸€è‡´æ€§</td><td align="center">å¼ºä¸€è‡´æ€§</td><td align="center">æœ€ç»ˆä¸€è‡´æ€§</td></tr></tbody></table>
<p>å‘é‡æ•°æ®åº“å’Œä¼ ç»Ÿæ•°æ®åº“æ˜¯<strong>äº’è¡¥</strong>çš„å…³ç³»ï¼Œæ„å»ºAIåº”ç”¨æ—¶ï¼Œé€šå¸¸ä½¿ç”¨ä¼ ç»Ÿæ•°æ®åº“å­˜å‚¨ä¸šåŠ¡<strong>å…ƒç»“æ„</strong>å’Œ<strong>ç»“æ„åŒ–ä¿¡æ¯</strong>ï¼Œä½¿ç”¨å‘é‡æ•°æ®åº“æ¥å­˜å‚¨å’Œæ£€ç´¢Embeddingæ¨¡å‹ç”Ÿæˆçš„<strong>æµ·é‡é«˜ç»´å‘é‡æ•°æ®</strong>ã€‚</p>
<h3 data-id="heading-12">3.å‘é‡æ•°æ®åº“é€‰æ‹©</h3>
<ul>
<li><strong>æ–°æ‰‹å…¥é—¨/å°å‹é¡¹ç›®</strong>ï¼šä»Â <code>ChromaDB</code>Â æˆ–Â <code>FAISS</code>Â å¼€å§‹æ˜¯æœ€ä½³é€‰æ‹©ã€‚å®ƒä»¬ä¸ LangChain/LlamaIndex ç´§å¯†é›†æˆï¼Œå‡ è¡Œä»£ç å°±èƒ½è¿è¡Œï¼Œä¸”èƒ½æ»¡è¶³åŸºæœ¬çš„å­˜å‚¨å’Œæ£€ç´¢éœ€æ±‚ã€‚</li>
<li><strong>ç”Ÿäº§ç¯å¢ƒ/å¤§è§„æ¨¡åº”ç”¨</strong>ï¼šå½“æ•°æ®é‡è¶…è¿‡ç™¾ä¸‡çº§ï¼Œæˆ–éœ€è¦é«˜å¹¶å‘ã€å®æ—¶æ›´æ–°ã€å¤æ‚å…ƒæ•°æ®è¿‡æ»¤æ—¶ï¼Œåº”è€ƒè™‘æ›´ä¸“ä¸šçš„è§£å†³æ–¹æ¡ˆï¼Œå¦‚Â <code>Milvus</code>ã€<code>Weaviate</code>Â æˆ–äº‘æœåŠ¡Â <code>Pinecone</code>ã€‚</li>
</ul>
<p><code>å‚è€ƒæ–‡ç« </code>
DataWhale <a href="https://link.juejin.cn?target=https%3A%2F%2Fdatawhalechina.github.io%2Fall-in-rag%2F%23%2F%3Fid%3Dall-in-rag-%25e5%25a4%25a7%25e6%25a8%25a1%25e5%259e%258b%25e5%25ba%2594%25e7%2594%25a8%25e5%25bc%2580%25e5%258f%2591%25e5%25ae%259e%25e6%2588%2598%25e4%25b8%2580%25ef%25bc%259arag%25e6%258a%2580%25e6%259c%25af%25e5%2585%25a8%25e6%25a0%2588%25e6%258c%2587%25e5%258d%2597" target="_blank" title="https://datawhalechina.github.io/all-in-rag/#/?id=all-in-rag-%e5%a4%a7%e6%a8%a1%e5%9e%8b%e5%ba%94%e7%94%a8%e5%bc%80%e5%8f%91%e5%ae%9e%e6%88%98%e4%b8%80%ef%bc%9arag%e6%8a%80%e6%9c%af%e5%85%a8%e6%a0%88%e6%8c%87%e5%8d%97" ref="nofollow noopener noreferrer">All-in-RAG | å¤§æ¨¡å‹åº”ç”¨å¼€å‘å®æˆ˜ä¸€ï¼šRAGæŠ€æœ¯å…¨æ ˆæŒ‡å—</a></p>
<p><code>å¼•ç”¨ä»£ç </code>
<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdatawhalechina%2Fall-in-rag" target="_blank" title="https://github.com/datawhalechina/all-in-rag" ref="nofollow noopener noreferrer">github.com/datawhalechâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€æŠ€æœ¯ä¸“é¢˜ã€‘Scikit-learn Pythonæœºå™¨å­¦ä¹  - ç‰¹å¾å·¥ç¨‹ä¹‹ç‰¹å¾æå–]]></title>    <link>https://juejin.cn/post/7598374376094253083</link>    <guid>https://juejin.cn/post/7598374376094253083</guid>    <pubDate>2026-01-23T14:24:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598374376094253083" data-draft-id="7598424770321825801" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€æŠ€æœ¯ä¸“é¢˜ã€‘Scikit-learn Pythonæœºå™¨å­¦ä¹  - ç‰¹å¾å·¥ç¨‹ä¹‹ç‰¹å¾æå–"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-23T14:24:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°é”‹java1234"/> <meta itemprop="url" content="https://juejin.cn/user/4152222342709933"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€æŠ€æœ¯ä¸“é¢˜ã€‘Scikit-learn Pythonæœºå™¨å­¦ä¹  - ç‰¹å¾å·¥ç¨‹ä¹‹ç‰¹å¾æå–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4152222342709933/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°é”‹java1234
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T14:24:48.000Z" title="Fri Jan 23 2026 14:24:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»27åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯é”‹å“¥ã€‚æœ€è¿‘è¿è½½æ›´æ–°ã€ŠScikit-learn Pythonæœºå™¨å­¦ä¹ ã€‹æŠ€æœ¯ä¸“é¢˜ã€‚ <img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/682d7f9b989b45339d8eec7e83978911~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZSLamF2YTEyMzQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769783087&amp;x-signature=m3IxNQt9oITobo65rCydUxZHw%2B0%3D" alt="image.png" loading="lazy"/> æœ¬è¯¾ç¨‹ä¸»è¦è®²è§£åŸºäºScikit-learnçš„Pythonæœºå™¨å­¦ä¹ çŸ¥è¯†ï¼ŒåŒ…æ‹¬æœºå™¨å­¦ä¹ æ¦‚è¿°ï¼Œç‰¹å¾å·¥ç¨‹(æ•°æ®é›†ï¼Œç‰¹å¾æŠ½å–ï¼Œç‰¹å¾é¢„å¤„ç†ï¼Œç‰¹å¾é™ç»´ç­‰)ï¼Œåˆ†ç±»ç®—æ³•(K-ä¸´è¿‘ç®—æ³•ï¼Œæœ´ç´ è´å¶æ–¯ç®—æ³•ï¼Œå†³ç­–æ ‘ç­‰)ï¼Œå›å½’ä¸èšç±»ç®—æ³•(çº¿æ€§å›å½’ï¼Œæ¬ æ‹Ÿåˆï¼Œé€»è¾‘å›å½’ä¸äºŒåˆ†ç±»ï¼ŒK-meansç®—æ³•)ç­‰ã€‚ åŒæ—¶ä¹Ÿé…å¥—è§†é¢‘æ•™ç¨‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV11reUzEEPH%2F" title="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV11reUzEEPH%2F" target="_blank">ã€ŠScikit-learn Pythonæœºå™¨å­¦ä¹  è§†é¢‘æ•™ç¨‹ã€‹</a></p>
<p>å‰é¢è®²'æœºå™¨å­¦ä¹ å¼€å‘æµç¨‹'ï¼Œé˜¶æ®µäºŒ''æ•°æ®å‡†å¤‡'å°±éœ€è¦è¿›è¡Œç‰¹å¾å·¥ç¨‹ï¼Œç‰¹å¾å·¥ç¨‹é‡Œï¼Œå°±éœ€è¦è¿›è¡Œç‰¹å¾æå–ï¼ŒæŠŠæ•°æ®è½¬æ¢æˆæ–¹ä¾¿æˆ‘ä»¬è®­ç»ƒéœ€è¦çš„ç‰¹å®šæ ¼å¼çš„æ•°æ®ã€‚</p>
<h2 data-id="heading-0">ç±»åˆ«ç‰¹å¾æå–- OneHotEncoder</h2>
<p>ç”¨äºå¤„ç†ç¦»æ•£çš„ã€æ— åºçš„ç±»åˆ«ç‰¹å¾ï¼ˆå¦‚å›½å®¶ã€é¢œè‰²ã€å“ç‰Œï¼‰ã€‚å®ƒå°†æ¯ä¸ªç±»åˆ«ç‰¹å¾è½¬æ¢ä¸ºä¸€ä¸ªäºŒè¿›åˆ¶åˆ—ï¼ˆ0/1ï¼‰ã€‚</p>
<p><strong>ç‹¬çƒ­ç¼–ç OneHotEncoder</strong>ï¼šå°†ä¸€ä¸ªæœ‰ <code>N</code> ä¸ªä¸åŒå–å€¼çš„ç±»åˆ«å‹ç‰¹å¾ï¼Œè½¬æ¢ä¸º <code>N</code> ä¸ª<strong>äºŒè¿›åˆ¶ç‰¹å¾</strong>ï¼ˆ0æˆ–1ï¼‰ã€‚å¯¹äºåŸå§‹ç‰¹å¾çš„æ¯ä¸€ä¸ªæ ·æœ¬å€¼ï¼Œåªæœ‰å¯¹åº”çš„é‚£ä¸ªæ–°ç‰¹å¾æ˜¯ <strong>1</strong>ï¼ˆâ€œçƒ­â€ï¼‰ï¼Œå…¶ä»–æ‰€æœ‰æ–°ç‰¹å¾éƒ½æ˜¯ <strong>0</strong>ï¼ˆâ€œå†·â€ï¼‰ã€‚</p>
<p><strong>â€œç‹¬çƒ­â€è¿™ä¸ªåå­—éå¸¸å½¢è±¡åœ°æè¿°äº†å®ƒçš„å½¢å¼ï¼šåœ¨ä¼—å¤šä½ä¸­ï¼Œåªæœ‰ä¸€ä½æ˜¯â€œçƒ­â€çš„ï¼ˆ1ï¼‰ï¼Œå…¶ä½™éƒ½æ˜¯â€œå†·â€çš„ï¼ˆ0ï¼‰ã€‚</strong></p>
<p>ç®€å•ä¸¾ä¾‹ï¼šæˆ‘ä»¬å°† <code>"åŠ¨ç‰©"</code> è¿™ä¸€ä¸ªç‰¹å¾ï¼Œæ‰©å±•ä¸ºä¸‰ä¸ªæ–°çš„äºŒè¿›åˆ¶ç‰¹å¾ï¼š<code>"æ˜¯å¦æ˜¯çŒ«"</code>ã€<code>"æ˜¯å¦æ˜¯ç‹—"</code>ã€<code>"æ˜¯å¦æ˜¯å…”å­"</code>ã€‚</p>








































<table><thead><tr><th>æ ·æœ¬</th><th>åŠ¨ç‰©ï¼ˆåŸå§‹ï¼‰</th><th>æ˜¯å¦æ˜¯çŒ«</th><th>æ˜¯å¦æ˜¯ç‹—</th><th>æ˜¯å¦æ˜¯å…”å­</th></tr></thead><tbody><tr><td>1</td><td>çŒ«</td><td><strong>1</strong></td><td>0</td><td>0</td></tr><tr><td>2</td><td>ç‹—</td><td>0</td><td><strong>1</strong></td><td>0</td></tr><tr><td>3</td><td>å…”å­</td><td>0</td><td>0</td><td><strong>1</strong></td></tr><tr><td>4</td><td>ç‹—</td><td>0</td><td><strong>1</strong></td><td>0</td></tr></tbody></table>
<p>è¿™æ ·ï¼Œå¯¹äºâ€œçŒ«â€è¿™ä¸ªç±»åˆ«ï¼Œå®ƒçš„å‘é‡è¡¨ç¤ºå°±æ˜¯ <code>[1, 0, 0]</code>ï¼›â€œç‹—â€æ˜¯ <code>[0, 1, 0]</code>ï¼›â€œå…”å­â€æ˜¯ <code>[0, 0, 1]</code>ã€‚è¿™ä¸‰ä¸ªå‘é‡åœ¨æ•°å­¦ç©ºé—´ä¸­æ˜¯<strong>ç›¸äº’æ­£äº¤</strong>çš„ï¼Œå®Œå…¨æ²¡æœ‰é¡ºåºæˆ–å¤§å°å…³ç³»ï¼Œå®Œç¾åœ°è¡¨è¾¾äº†ç±»åˆ«ä¹‹é—´çš„ç‹¬ç«‹æ€§ã€‚</p>
<p><strong>æ ¸å¿ƒå‚æ•°è¯¦è§£</strong></p>
<ol start="0">
<li><code>categories</code> (é»˜è®¤ <code>â€˜autoâ€™</code>)</li>
</ol>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼š æŒ‡å®šæ¯ä¸ªç‰¹å¾ï¼ˆåˆ—ï¼‰æœ‰å“ªäº›ç±»åˆ«ï¼ˆå”¯ä¸€å€¼ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å¯é€‰å€¼</strong>ï¼š</p>
<ul>
<li>
<p><code>â€˜autoâ€™</code> (é»˜è®¤)ï¼š è‡ªåŠ¨ä»è®­ç»ƒé›†æ•°æ®ä¸­æ¨æ–­æ¯ä¸ªç‰¹å¾çš„ç±»åˆ«ã€‚è¿™æ˜¯æœ€å¸¸ç”¨çš„æ¨¡å¼ã€‚</p>
</li>
<li>
<p><code>â€˜listâ€™</code>ï¼š æ‰‹åŠ¨æŒ‡å®šã€‚éœ€è¦ä¸€ä¸ªåˆ—è¡¨çš„åˆ—è¡¨ï¼Œå…¶ä¸­æ¯ä¸ªå†…éƒ¨åˆ—è¡¨å¯¹åº”ä¸€ä¸ªç‰¹å¾çš„ç±»åˆ«ã€‚</p>
<ul>
<li>ä¾‹å¦‚ï¼š<code>categories=[['çŒ«', 'ç‹—'], ['çº¢', 'è“']]</code> è¡¨ç¤ºç¬¬ä¸€ä¸ªç‰¹å¾æœ‰â€˜çŒ«â€™å’Œâ€˜ç‹—â€™ä¸¤ä¸ªç±»åˆ«ï¼Œç¬¬äºŒä¸ªç‰¹å¾æœ‰â€˜çº¢â€™å’Œâ€˜è“â€™ä¸¤ä¸ªç±»åˆ«ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆé‡è¦</strong>ï¼š</p>
<ul>
<li>ç¡®ä¿è®­ç»ƒé›†å’Œæµ‹è¯•é›†ç¼–ç çš„ç»´åº¦ä¸€è‡´ã€‚å¦‚æœæµ‹è¯•é›†å‡ºç°äº†è®­ç»ƒé›†ä¸­ä»æœªè§è¿‡çš„ç±»åˆ«ï¼ˆâ€˜æœªçŸ¥â€™ç±»åˆ«ï¼‰ï¼Œ<code>handle_unknown</code> å‚æ•°ä¼šå†³å®šå¦‚ä½•å¤„ç†ã€‚</li>
<li>æ‰‹åŠ¨æŒ‡å®šå¯ä»¥å›ºå®šç¼–ç çš„ç»´åº¦ï¼Œå³ä½¿æŸäº›ç±»åˆ«åœ¨è®­ç»ƒé›†ä¸­æ²¡æœ‰å‡ºç°ã€‚</li>
</ul>
</li>
</ul>
<ol start="2">
<li><code>drop</code> (é»˜è®¤ <code>None</code>)</li>
</ol>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼š æŒ‡å®šä¸€ç§æ–¹æ³•æ¥â€œä¸¢å¼ƒâ€æ¯ä¸ªç‰¹å¾çš„ä¸€ä¸ªç±»åˆ«ã€‚ç”¨äºé¿å…<strong>å¤šé‡å…±çº¿æ€§</strong>ï¼ˆå³ç‰¹å¾å‘é‡ä¸æ˜¯ç‹¬ç«‹çš„ï¼‰ï¼Œè¿™å¯¹äºæŸäº›çº¿æ€§æ¨¡å‹éå¸¸é‡è¦ã€‚</p>
</li>
<li>
<p><strong>å¯é€‰å€¼</strong>ï¼š</p>
<ul>
<li><code>None</code> (é»˜è®¤)ï¼š ä¸ä¸¢å¼ƒä»»ä½•ç±»åˆ«ï¼Œä¿ç•™æ‰€æœ‰ç¼–ç åçš„ç‰¹å¾åˆ—ã€‚</li>
<li><code>â€˜firstâ€™</code>ï¼š ä¸¢å¼ƒæ¯ä¸ªç‰¹å¾çš„ç¬¬ä¸€ä¸ªç±»åˆ«ã€‚å¦‚æœæŸä¸ªç‰¹å¾æœ‰ <code>k</code> ä¸ªç±»åˆ«ï¼Œåˆ™ä¼šç”Ÿæˆ <code>k-1</code> åˆ—ã€‚</li>
<li><code>â€˜if_binaryâ€™</code>ï¼š ä»…å½“ç‰¹å¾æ˜¯äºŒåˆ†ç±»ï¼ˆåªæœ‰ä¸¤ä¸ªç±»åˆ«ï¼‰æ—¶ï¼Œä¸¢å¼ƒå…¶ä¸­ä¸€ç±»ã€‚å¯¹äºå¤šåˆ†ç±»ç‰¹å¾ï¼Œåˆ™ä¿ç•™æ‰€æœ‰ç±»åˆ«ã€‚</li>
<li><code>array</code>ï¼š å¯ä»¥ä¼ é€’ä¸€ä¸ªæ•°ç»„ï¼ŒæŒ‡å®šè¦ä¸¢å¼ƒçš„ç‰¹å®šç±»åˆ«ã€‚ä¾‹å¦‚ <code>drop=[â€˜çŒ«â€™]</code> ä¼šä¸¢å¼ƒç±»åˆ«â€˜çŒ«â€™å¯¹åº”çš„åˆ—ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<ul>
<li>ç‰¹å¾â€˜é¢œè‰²â€™æœ‰ [â€˜çº¢â€™, â€˜è“â€™, â€˜ç»¿â€™] ä¸‰ä¸ªç±»åˆ«ã€‚</li>
<li><code>drop=None</code>ï¼š ç”Ÿæˆä¸‰åˆ—ï¼š<code>é¢œè‰²_çº¢</code>, <code>é¢œè‰²_è“</code>, <code>é¢œè‰²_ç»¿</code>ã€‚</li>
<li><code>drop=â€˜firstâ€™</code>ï¼š ç”Ÿæˆä¸¤åˆ—ï¼š<code>é¢œè‰²_è“</code>, <code>é¢œè‰²_ç»¿</code>ï¼ˆä¸¢å¼ƒäº†â€˜çº¢â€™ï¼‰ã€‚æ­¤æ—¶ï¼Œå…¨ä¸º0çš„å‘é‡å°±ä»£è¡¨è¢«ä¸¢å¼ƒçš„â€˜çº¢â€™ç±»åˆ«ã€‚</li>
</ul>
</li>
</ul>
<ol start="3">
<li><code>sparse_output</code> (é»˜è®¤ <code>False</code>)</li>
</ol>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼š å†³å®šç¼–ç åçš„è¾“å‡ºæ˜¯ç¨€ç–çŸ©é˜µè¿˜æ˜¯å¯†é›†çŸ©é˜µï¼ˆnumpyæ•°ç»„ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å¯é€‰å€¼</strong>ï¼š</p>
<ul>
<li><code>True</code>ï¼š è¿”å› <code>scipy.sparse</code> ç¨€ç–çŸ©é˜µã€‚å½“ç±»åˆ«æ•°é‡éå¸¸å¤šæ—¶ï¼ˆä¾‹å¦‚å‡ ä¸‡ç§ï¼‰ï¼Œè¿™å¯ä»¥æå¤§åœ°èŠ‚çœå†…å­˜ï¼Œå› ä¸ºåªæœ‰0å’Œ1ï¼Œè€Œå¤§éƒ¨åˆ†éƒ½æ˜¯0ã€‚</li>
<li><code>False</code>ï¼š è¿”å›å¸¸è§„çš„ <code>numpy.ndarray</code> å¯†é›†æ•°ç»„ã€‚æ›´æ˜“äºæŸ¥çœ‹å’Œç†è§£ï¼Œä½†ç±»åˆ«å¤šæ—¶ä¼šæ¶ˆè€—å¤§é‡å†…å­˜ã€‚</li>
</ul>
</li>
<li>
<p><strong>å†å²å˜åŒ–</strong>ï¼š åœ¨ 1.2 ç‰ˆæœ¬ä¹‹å‰ï¼Œæ­¤å‚æ•°åä¸º <code>sparse</code>ï¼Œç°å·²å¼ƒç”¨ã€‚</p>
</li>
</ul>
<ol start="4">
<li><code>dtype</code> (é»˜è®¤ <code>numpy.float64</code>)</li>
</ol>
<ul>
<li><strong>ä½œç”¨</strong>ï¼š æŒ‡å®šè¾“å‡ºæ•°ç»„çš„æ•°æ®ç±»å‹ã€‚å› ä¸ºOne-Hotç¼–ç çš„ç»“æœåªæœ‰0å’Œ1ï¼Œé€šå¸¸ä½¿ç”¨è¾ƒå°çš„æ•°æ®ç±»å‹æ¥èŠ‚çœå†…å­˜ï¼Œä¾‹å¦‚ <code>np.int8</code> æˆ– <code>bool</code>ã€‚</li>
<li><strong>å¸¸ç”¨å€¼</strong>ï¼š <code>np.float64</code>, <code>np.int8</code>, <code>bool</code>ã€‚</li>
</ul>
<ol start="5">
<li><code>handle_unknown</code> (é»˜è®¤ <code>â€˜errorâ€™</code>)</li>
</ol>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼š å½“è½¬æ¢è¿‡ç¨‹ä¸­ï¼ˆä¾‹å¦‚åœ¨é¢„æµ‹æ—¶å¤„ç†æµ‹è¯•é›†æ•°æ®ï¼‰é‡åˆ°äº†è®­ç»ƒæ—¶æœªè§è¿‡çš„ç±»åˆ«ï¼ˆ<code>categories</code> å‚æ•°ä¸­æœªå®šä¹‰çš„ç±»åˆ«ï¼‰æ—¶ï¼Œåº”é‡‡å–çš„ç­–ç•¥ã€‚</p>
</li>
<li>
<p><strong>å¯é€‰å€¼</strong>ï¼š</p>
<ul>
<li><code>â€˜errorâ€™</code> (é»˜è®¤)ï¼š æŠ›å‡ºé”™è¯¯ <code>ValueError</code>ã€‚</li>
<li><code>â€˜ignoreâ€™</code>ï¼š å°†æœªçŸ¥ç±»åˆ«å…¨éƒ¨ç¼–ç ä¸º0å‘é‡ã€‚<strong>è¿™æ˜¯éå¸¸å±é™©çš„åšæ³•</strong>ï¼Œå› ä¸ºå®ƒä¼šè®©æ¨¡å‹è¯¯ä»¥ä¸ºè¿™ä¸ªæ ·æœ¬åœ¨æ‰€æœ‰ç±»åˆ«ç‰¹å¾ä¸Šéƒ½å±äºâ€œåŸºå‡†â€ç±»åˆ«ã€‚</li>
<li><code>â€˜infrequent_if_existâ€™</code> (v1.1æ–°å¢)ï¼š å°†æœªçŸ¥ç±»åˆ«è§†ä¸ºâ€œä¸å¸¸è§â€ç±»åˆ«è¿›è¡Œå¤„ç†ã€‚è¿™éœ€è¦ä¸ <code>min_frequency</code> æˆ– <code>max_categories</code> å‚æ•°é…åˆä½¿ç”¨ã€‚è¿™æ˜¯æœ€æ¨èçš„å¤„ç†æœªçŸ¥ç±»åˆ«çš„æ–¹å¼ï¼Œå› ä¸ºå®ƒæ›´åˆç†ã€‚</li>
</ul>
</li>
</ul>
<ol start="6">
<li><code>min_frequency</code> ä¸ <code>max_categories</code> (v1.1æ–°å¢)</li>
</ol>
<p>è¿™ä¸¤ä¸ªå‚æ•°ç”¨äº<strong>è‡ªåŠ¨å°†ä¸å¸¸è§çš„ç±»åˆ«åˆ†ç»„åˆ°ä¸€ä¸ªâ€œä¸å¸¸è§â€ç±»åˆ«ä¸­</strong>ï¼Œä»è€Œé™åˆ¶è¾“å‡ºç»´åº¦ï¼Œé˜²æ­¢ç±»åˆ«è¿‡å¤šå¯¼è‡´ç»´åº¦çˆ†ç‚¸ã€‚</p>
<ul>
<li>
<p><code>min_frequency</code>:</p>
<ul>
<li>å¯ä»¥æ˜¯ä¸€ä¸ªæ•´æ•°æˆ–æµ®ç‚¹æ•°ã€‚</li>
<li>å¦‚æœä¸ºæ•´æ•°ï¼Œè¡¨ç¤ºç±»åˆ«å‡ºç°æ¬¡æ•°<strong>å°äºç­‰äº</strong>è¿™ä¸ªå€¼çš„å°†è¢«å½’ä¸ºâ€œä¸å¸¸è§â€ç±»åˆ«ã€‚</li>
<li>å¦‚æœä¸ºæµ®ç‚¹æ•°ï¼ˆ0.0åˆ°1.0ä¹‹é—´ï¼‰ï¼Œè¡¨ç¤ºç±»åˆ«å‡ºç°é¢‘ç‡<strong>å°äºç­‰äº</strong>è¿™ä¸ªæ¯”ä¾‹çš„å°†è¢«å½’ä¸ºâ€œä¸å¸¸è§â€ç±»åˆ«ã€‚</li>
</ul>
</li>
<li>
<p><code>max_categories</code>:</p>
<ul>
<li>ä¸€ä¸ªæ•´æ•°ã€‚</li>
<li>ä¸ºæ¯ä¸ªç‰¹å¾ä¿ç•™çš„æœ€å¤§ç±»åˆ«æ•°ï¼ˆä¸åŒ…æ‹¬â€œä¸å¸¸è§â€ç±»åˆ«ï¼‰ã€‚é¢‘ç‡æœ€é«˜çš„ <code>n-1</code> ä¸ªç±»åˆ«ä¼šè¢«ä¿ç•™ï¼Œå‰©ä¸‹çš„æ‰€æœ‰ç±»åˆ«ï¼ˆç¬¬ <code>n</code> ååŠä»¥åï¼‰éƒ½ä¼šè¢«å½’å…¥ä¸€ä¸ªâ€œä¸å¸¸è§â€ç±»åˆ«ã€‚</li>
</ul>
</li>
</ul>
<p><strong>æ³¨æ„</strong>ï¼š è¿™ä¸¤ä¸ªå‚æ•°ä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚</p>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">from sklearn<span class="hljs-selector-class">.preprocessing</span> import OneHotEncoder
import numpy as np
â€‹
# ç¤ºä¾‹ç±»åˆ«æ•°æ®
data = <span class="hljs-selector-attr">[[<span class="hljs-string">'Red'</span>]</span>, <span class="hljs-selector-attr">[<span class="hljs-string">'Blue'</span>]</span>, <span class="hljs-selector-attr">[<span class="hljs-string">'Green'</span>]</span>, <span class="hljs-selector-attr">[<span class="hljs-string">'Blue'</span>]</span>, <span class="hljs-selector-attr">[<span class="hljs-string">'Red'</span>]</span>]
â€‹
# åˆå§‹åŒ– OneHotEncoder
# handle_unknown='ignore' é˜²æ­¢é‡åˆ°æœªçŸ¥ç±»åˆ«æ—¶æŠ¥é”™
encoder = <span class="hljs-built_in">OneHotEncoder</span>(sparse_output=False, handle_unknown='ignore')
â€‹
# å­¦ä¹ å¹¶è½¬æ¢æ•°æ®
# <span class="hljs-built_in">fit</span>() ï¼šç”¨äºä»è®­ç»ƒæ•°æ®ç”Ÿæˆå­¦ä¹ æ¨¡å‹å‚æ•°
# <span class="hljs-attribute">transform</span>()ï¼šä»<span class="hljs-built_in">fit</span>()æ–¹æ³•ç”Ÿæˆçš„å‚æ•°ï¼Œåº”ç”¨äºæ¨¡å‹ä»¥ç”Ÿæˆè½¬æ¢æ•°æ®é›†ã€‚
# <span class="hljs-built_in">fit_transform</span>()ï¼šåœ¨åŒä¸€æ•°æ®é›†ä¸Šç»„åˆ<span class="hljs-built_in">fit</span>()å’Œ<span class="hljs-attribute">transform</span>() api
X_encoded = encoder<span class="hljs-selector-class">.fit_transform</span>(data)
â€‹
<span class="hljs-built_in">print</span>("ç¼–ç åçš„ç‰¹å¾çŸ©é˜µ:")
<span class="hljs-built_in">print</span>(X_encoded)
# è¾“å‡ºï¼š
# <span class="hljs-selector-attr">[[1. 0. 0.]</span>  # Red -&gt; <span class="hljs-selector-attr">[1, 0, 0]</span>
#  <span class="hljs-selector-attr">[0. 1. 0.]</span>  # Blue -&gt; <span class="hljs-selector-attr">[0, 1, 0]</span>
#  <span class="hljs-selector-attr">[0. 0. 1.]</span>  # Green -&gt; <span class="hljs-selector-attr">[0, 0, 1]</span>
#  <span class="hljs-selector-attr">[0. 1. 0.]</span>  # Blue
#  <span class="hljs-selector-attr">[1. 0. 0.]</span>] # Red
â€‹
<span class="hljs-built_in">print</span>("\nç‰¹å¾åç§°:")
<span class="hljs-built_in">print</span>(encoder.get_feature_names_out())
# è¾“å‡ºï¼š<span class="hljs-selector-attr">[<span class="hljs-string">'x0_Blue'</span> <span class="hljs-string">'x0_Green'</span> <span class="hljs-string">'x0_Red'</span>]</span>
â€‹
# å¤„ç†æ–°æ•°æ®ï¼ˆåŒ…å«æœªçŸ¥ç±»åˆ« â€˜Yellowâ€™ï¼‰
new_data = <span class="hljs-selector-attr">[[<span class="hljs-string">'Blue'</span>]</span>, <span class="hljs-selector-attr">[<span class="hljs-string">'Red'</span>]</span>, <span class="hljs-selector-attr">[<span class="hljs-string">'Yellow'</span>]</span>]
X_new_encoded = encoder<span class="hljs-selector-class">.transform</span>(new_data)
<span class="hljs-built_in">print</span>("\næ–°æ•°æ®ç¼–ç åçš„ç‰¹å¾çŸ©é˜µ:")
<span class="hljs-built_in">print</span>(X_new_encoded)
# è¾“å‡ºï¼š
# <span class="hljs-selector-attr">[[0. 1. 0. 0.]</span>  # Blue -&gt; <span class="hljs-selector-attr">[0, 1, 0]</span>
#  <span class="hljs-selector-attr">[1. 0. 0. 0.]</span>  # Red -&gt; <span class="hljs-selector-attr">[1, 0, 0]</span>
#  <span class="hljs-selector-attr">[0. 0. 0. 0.]</span>] # Yellow (æœªçŸ¥) -&gt; <span class="hljs-selector-attr">[0, 0, 0]</span>ï¼Œå› ä¸ºè®¾ç½®äº† handle_unknown='ignore'
</code></pre>
<p>è¿è¡Œè¾“å‡ºï¼š</p>
<pre><code class="hljs language-lua" lang="lua">ç¼–ç åçš„ç‰¹å¾çŸ©é˜µ:
<span class="hljs-string">[[0. 0. 1.]
 [1. 0. 0.]
 [0. 1. 0.]
 [1. 0. 0.]
 [0. 0. 1.]]</span>
â€‹
ç‰¹å¾åç§°:
[<span class="hljs-string">'x0_Blue'</span> <span class="hljs-string">'x0_Green'</span> <span class="hljs-string">'x0_Red'</span>]
â€‹
æ–°æ•°æ®ç¼–ç åçš„ç‰¹å¾çŸ©é˜µ:
<span class="hljs-string">[[1. 0. 0.]
 [0. 0. 1.]
 [0. 0. 0.]]</span>
</code></pre>
<h2 data-id="heading-1">å­—å…¸ç‰¹å¾æå–-DictVectorizer</h2>
<p>å°†ç‰¹å¾åç§°å’Œå€¼æ˜ å°„ä¸ºå­—å…¸çš„åˆ—è¡¨è½¬æ¢ä¸ºæ•°å€¼çŸ©é˜µï¼Œéå¸¸é€‚åˆå¤„ç†æ··åˆç±»å‹çš„ç‰¹å¾ã€‚</p>
<p><code>DictVectorizer</code> æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå®ƒç”¨äºå°†<strong>ç‰¹å¾åç§°åˆ°ç‰¹å¾å€¼</strong>çš„æ˜ å°„å­—å…¸ï¼ˆä¾‹å¦‚åˆ—è¡¨ï¼‰è½¬æ¢ä¸º scikit-learn æ¨¡å‹å¯ä»¥ä½¿ç”¨çš„æ•°å€¼çŸ©é˜µã€‚å®ƒçš„å¼ºå¤§ä¹‹å¤„åœ¨äºèƒ½åŒæ—¶å¤„ç†<strong>åˆ†ç±»ç‰¹å¾</strong>ï¼ˆè¿›è¡ŒOne-Hotç¼–ç ï¼‰å’Œ<strong>æ•°å€¼ç‰¹å¾</strong>ï¼ˆä¿æŒåŸå€¼ï¼‰ï¼Œéå¸¸é€‚ç”¨äºå¤„ç†æ··åˆç±»å‹çš„ç‰¹å¾æˆ–ä»ç±»ä¼¼JSONç»“æ„çš„æ•°æ®ä¸­æå–ç‰¹å¾ã€‚</p>
<p><strong>æ ¸å¿ƒå‚æ•°è¯¦è§£</strong></p>
<ol start="0">
<li><code>dtype</code> (é»˜è®¤ <code>numpy.float64</code>)</li>
</ol>
<ul>
<li><strong>ä½œç”¨</strong>: æŒ‡å®šè¾“å‡ºæ•°ç»„çš„æ•°æ®ç±»å‹ã€‚</li>
<li><strong>è¯´æ˜</strong>: ä¸ºäº†èŠ‚çœå†…å­˜ï¼Œä½ å¯ä»¥å°†å…¶è®¾ç½®ä¸ºæ›´å°çš„æ•°å€¼ç±»å‹ï¼Œä¾‹å¦‚ <code>np.float32</code> æˆ– <code>np.int32</code>ã€‚å› ä¸ºç‰¹å¾çŸ©é˜µä¸­ä¼šåŒ…å«åŸå§‹çš„æ•°å€¼å‹ç‰¹å¾ï¼Œæ‰€ä»¥é€šå¸¸ä¸ä½¿ç”¨ <code>bool</code> ç±»å‹ã€‚</li>
</ul>
<ol start="2">
<li><code>separator</code> (é»˜è®¤ <code>=</code>)</li>
</ol>
<ul>
<li>
<p><strong>ä½œç”¨</strong>: ç”¨äºæ„é€ è¾“å‡ºçŸ©é˜µä¸­ç‰¹å¾åç§°çš„åˆ†éš”ç¬¦å­—ç¬¦ä¸²ã€‚å½“è½¬æ¢åˆ†ç±»ç‰¹å¾æ—¶ï¼Œ<code>DictVectorizer</code> ä¼šç”Ÿæˆå½¢å¦‚ <code>[ç‰¹å¾å][åˆ†éš”ç¬¦][ç±»åˆ«å]</code> çš„æ–°åˆ—åã€‚</p>
</li>
<li>
<p><strong>ç¤ºä¾‹</strong>:</p>
<ul>
<li>æœ‰ä¸€ä¸ªç‰¹å¾ <code>â€˜animalâ€™</code>ï¼Œå…¶å€¼ä¸º <code>â€˜catâ€™</code>ã€‚</li>
<li>é»˜è®¤ <code>separator=â€˜=â€™</code> ä¼šç”Ÿæˆæ–°ç‰¹å¾åï¼š<code>â€˜animal=catâ€™</code>ã€‚</li>
<li>å¦‚æœè®¾ç½® <code>separator=â€˜_â€™</code>ï¼Œåˆ™ä¼šç”Ÿæˆï¼š<code>â€˜animal_catâ€™</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç”¨é€”</strong>: ä¸»è¦ç”¨äºæ§åˆ¶è¾“å‡ºç‰¹å¾åçš„å¯è¯»æ€§å’Œæ ¼å¼ã€‚</p>
</li>
</ul>
<ol start="3">
<li><code>sparse</code> (é»˜è®¤ <code>True</code>)</li>
</ol>
<ul>
<li>
<p><strong>ä½œç”¨</strong>: å†³å®šè½¬æ¢åçš„è¾“å‡ºæ˜¯ç¨€ç–çŸ©é˜µè¿˜æ˜¯å¯†é›†çŸ©é˜µï¼ˆnumpyæ•°ç»„ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å¯é€‰å€¼</strong>:</p>
<ul>
<li><code>True</code> (é»˜è®¤): è¿”å› <code>scipy.sparse</code> ç¨€ç–çŸ©é˜µã€‚è¿™æ˜¯é»˜è®¤è¡Œä¸ºï¼Œå› ä¸ºOne-Hotç¼–ç ä¼šäº§ç”Ÿå¤§é‡0å€¼ï¼Œä½¿ç”¨ç¨€ç–çŸ©é˜µå¯ä»¥<strong>æå¤§åœ°èŠ‚çœå†…å­˜</strong>ã€‚</li>
<li><code>False</code>: è¿”å›å¸¸è§„çš„ <code>numpy.ndarray</code> å¯†é›†æ•°ç»„ã€‚è¿™æ ·æ›´æ˜“äºæŸ¥çœ‹å’Œç†è§£ï¼Œä½†å½“ç‰¹å¾ç»´åº¦å¾ˆé«˜æ—¶ï¼Œå¯èƒ½ä¼šæ¶ˆè€—å·¨å¤§å†…å­˜ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ³¨æ„</strong>: è¿™ä¸ªå‚æ•°ä¸æ–°ç‰ˆ <code>OneHotEncoder</code> çš„ <code>sparse_output</code> åŠŸèƒ½ç›¸åŒï¼Œä½†åç§°ä¸åŒã€‚</p>
</li>
</ul>
<ol start="4">
<li><code>sort</code> (é»˜è®¤ <code>True</code>)</li>
</ol>
<ul>
<li>
<p><strong>ä½œç”¨</strong>: åœ¨æ‹Ÿåˆæ—¶æ˜¯å¦å¯¹ç‰¹å¾åç§°è¿›è¡Œæ’åºã€‚</p>
</li>
<li>
<p><strong>å¯é€‰å€¼</strong>:</p>
<ul>
<li><code>True</code> (é»˜è®¤): å¯¹ç”Ÿæˆçš„ç‰¹å¾åç§°ï¼ˆåˆ—åï¼‰è¿›è¡Œæ’åºã€‚è¿™èƒ½ä¿è¯æ¯æ¬¡è¿è¡Œçš„ç»“æœä¸€è‡´ï¼Œ<strong>å¯é‡ç°æ€§</strong>å¥½ã€‚</li>
<li><code>False</code>: ä¸æ’åºï¼Œç‰¹å¾åˆ—çš„é¡ºåºå°†ç”±Pythonå­—å…¸çš„éšæœºæ€§å†³å®šï¼ˆåœ¨Python 3.6+ä¸­ï¼Œå­—å…¸æ˜¯æœ‰åºçš„ï¼Œä½†é¡ºåºå–å†³äºæ’å…¥é¡ºåºï¼‰ã€‚é€šå¸¸ä¸æ¨èè®¾ç½®ä¸º <code>False</code>ï¼Œé™¤éä½ éå¸¸å…³å¿ƒç‰¹å¾åˆ—çš„åŸå§‹é¡ºåºã€‚</li>
</ul>
</li>
</ul>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">from sklearn<span class="hljs-selector-class">.feature_extraction</span> import DictVectorizer
â€‹
# ç¤ºä¾‹æ•°æ®ï¼Œåˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œä»£è¡¨ä¸€ä¸ªæ ·æœ¬
data = <span class="hljs-selector-attr">[ Â   {<span class="hljs-string">'age'</span>: 25, <span class="hljs-string">'city'</span>: <span class="hljs-string">'New York'</span>, <span class="hljs-string">'income'</span>: 50000}, Â   {<span class="hljs-string">'age'</span>: 30, <span class="hljs-string">'city'</span>: <span class="hljs-string">'Boston'</span>, <span class="hljs-string">'income'</span>: 65000}, Â   {<span class="hljs-string">'age'</span>: 35, <span class="hljs-string">'city'</span>: <span class="hljs-string">'New York'</span>, <span class="hljs-string">'income'</span>: 75000}]</span>
â€‹
# åˆå§‹åŒ– DictVectorizer
dict_vectorizer = <span class="hljs-built_in">DictVectorizer</span>(sparse=True)
â€‹
# å­¦ä¹ å¹¶è½¬æ¢æ•°æ®
X_dict = dict_vectorizer<span class="hljs-selector-class">.fit_transform</span>(data)
â€‹
<span class="hljs-built_in">print</span>("è½¬æ¢åçš„ç‰¹å¾çŸ©é˜µ:")
<span class="hljs-built_in">print</span>(X_dict)
# ç¨€ç–çŸ©é˜µè¾“å‡ºï¼š
# Coords    Values
# Â  (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)  <span class="hljs-number">25.0</span>
# Â  (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>)  <span class="hljs-number">1.0</span>
# Â  (<span class="hljs-number">0</span>, <span class="hljs-number">3</span>)  <span class="hljs-number">50000.0</span>
# Â  (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)  <span class="hljs-number">30.0</span>
# Â  (<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)  <span class="hljs-number">1.0</span>
# Â  (<span class="hljs-number">1</span>, <span class="hljs-number">3</span>)  <span class="hljs-number">65000.0</span>
# Â  (<span class="hljs-number">2</span>, <span class="hljs-number">0</span>)  <span class="hljs-number">35.0</span>
# Â  (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)  <span class="hljs-number">1.0</span>
# Â  (<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)  <span class="hljs-number">75000.0</span>
â€‹
<span class="hljs-built_in">print</span>("\nç‰¹å¾åç§°:")
<span class="hljs-built_in">print</span>(dict_vectorizer.get_feature_names_out())
# è¾“å‡ºï¼š<span class="hljs-selector-attr">[<span class="hljs-string">'age'</span>, <span class="hljs-string">'income'</span>, <span class="hljs-string">'city=Boston'</span>, <span class="hljs-string">'city=New York'</span>]</span>
# å®ƒè‡ªåŠ¨å°†æ•°å€¼å‹ç‰¹å¾ 'age', 'income' ä¿ç•™ï¼Œå°†ç±»åˆ«å‹ç‰¹å¾ 'city' è¿›è¡Œäº† One-Hot ç¼–ç ã€‚
</code></pre>
<h2 data-id="heading-2">æ–‡æœ¬ç‰¹å¾æå–</h2>
<h3 data-id="heading-3">è¯è¢‹æ¨¡å‹ - CountVectorizer</h3>
<p>å®ƒå°†æ–‡æœ¬æ–‡æ¡£é›†åˆè½¬æ¢ä¸ºä¸€ä¸ªä»¤ç‰Œè®¡æ•°çš„çŸ©é˜µã€‚</p>
<p>æˆ‘ä»¬æ¥æ·±å…¥è§£æ <code>sklearn.feature_extraction.text.CountVectorizer</code> çš„æ ¸å¿ƒå‚æ•°ã€‚<code>CountVectorizer</code> æ˜¯æ–‡æœ¬å¤„ç†ä¸­æœ€åŸºç¡€ã€æœ€å¸¸ç”¨çš„å·¥å…·ä¹‹ä¸€ï¼Œå®ƒçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯<strong>å°†æ–‡æœ¬è¯­æ–™åº“è½¬æ¢ä¸ºè¯é¢‘è®¡æ•°çŸ©é˜µ</strong>ï¼ˆä¹Ÿç§°ä¸ºâ€œè¯è¢‹â€æ¨¡å‹ï¼‰ã€‚</p>
<p><strong>å·¥ä½œæµç¨‹æ¦‚è¿°</strong></p>
<p>ç†è§£å‚æ•°ä¹‹å‰ï¼Œå…ˆäº†è§£å…¶é»˜è®¤å·¥ä½œæµç¨‹ï¼š</p>
<ol start="0">
<li><strong>åˆ†è¯ (Tokenization)</strong> ï¼š å°†æ¯ä¸ªæ–‡æ¡£ï¼ˆæ–‡æœ¬å­—ç¬¦ä¸²ï¼‰è½¬æ¢ä¸ºå•è¯ï¼ˆtokenï¼‰åˆ—è¡¨ã€‚</li>
<li><strong>æ„å»ºè¯è¡¨ (Vocabulary Building)</strong> ï¼š ä»æ‰€æœ‰æ–‡æ¡£ä¸­æ‰¾å‡ºæ‰€æœ‰å”¯ä¸€çš„å•è¯ï¼Œå¹¶ä¸ºå…¶åˆ†é…ä¸€ä¸ªç´¢å¼•ã€‚è¿™ä¸ªè¯è¡¨ä¹Ÿç§°ä¸ºâ€œè¯å…¸â€ã€‚</li>
<li><strong>ç¼–ç ä¸è®¡æ•° (Encoding &amp; Counting)</strong> ï¼š å¯¹äºæ¯ä¸ªæ–‡æ¡£ï¼Œç»Ÿè®¡è¯è¡¨ä¸­æ¯ä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°ï¼Œå½¢æˆä¸€ä¸ªå‘é‡ã€‚</li>
</ol>
<p>æœ€ç»ˆè¾“å‡ºæ˜¯ä¸€ä¸ªçŸ©é˜µï¼Œå…¶ä¸­ï¼š</p>
<ul>
<li><strong>è¡Œ</strong> ä»£è¡¨æ¯ä¸ªæ–‡æ¡£ã€‚</li>
<li><strong>åˆ—</strong> ä»£è¡¨è¯è¡¨ä¸­çš„æ¯ä¸ªå•è¯ï¼ˆç‰¹å¾ï¼‰ã€‚</li>
<li><strong>å€¼</strong> ä»£è¡¨è¯¥å•è¯åœ¨å¯¹åº”æ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚</li>
</ul>
<p><strong>æ ¸å¿ƒå‚æ•°è¯¦è§£ï¼ˆæŒ‰å¤„ç†æµç¨‹åˆ†ç»„ï¼‰</strong></p>
<ol start="0">
<li>åˆ†è¯å™¨ç›¸å…³å‚æ•° (Tokenization)</li>
</ol>
<p>è¿™äº›å‚æ•°æ§åˆ¶å¦‚ä½•å°†æ–‡æœ¬æ‹†åˆ†æˆå•è¯ï¼ˆtokenï¼‰ã€‚</p>
<ul>
<li>
<p><code>token_pattern</code> (é»˜è®¤ <code>r"(?u)\b\w\w+\b"</code>)</p>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼š ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ä¸²ï¼Œç”¨äºå®šä¹‰ä»€ä¹ˆæ„æˆä¸€ä¸ªâ€œtokenâ€ã€‚åªæœ‰åŒ¹é…è¿™ä¸ªæ¨¡å¼çš„å­—ç¬¦ä¸²æ‰ä¼šè¢«ä¿ç•™ä¸ºå•è¯ã€‚</p>
</li>
<li>
<p><strong>è¯¦è§£</strong>ï¼š</p>
<ul>
<li>
<p>é»˜è®¤æ¨¡å¼ <code>(?u)\b\w\w+\b</code> çš„å«ä¹‰ï¼š</p>
<ul>
<li><code>(?u)</code>ï¼š å¯ç”¨UnicodeåŒ¹é…æ¨¡å¼ã€‚</li>
<li><code>\b</code>ï¼š å•è¯è¾¹ç•Œã€‚</li>
<li><code>\w\w+</code>ï¼š åŒ¹é…ä»»ä½•å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼ˆåœ¨Unicodeæ¨¡å¼ä¸‹åŒ…æ‹¬ä¸­æ–‡ç­‰ï¼‰å­—ç¬¦ï¼Œä¸”é•¿åº¦è‡³å°‘ä¸º2ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç¤ºä¾‹</strong>ï¼š å¦‚æœä½ æƒ³ä¿ç•™å•å­—æ¯å•è¯ï¼ˆå¦‚è‹±æ–‡çš„ â€œaâ€, â€œIâ€ï¼‰ï¼Œå¯ä»¥ä¿®æ”¹ä¸º <code>r"(?u)\b\w+\b"</code>ã€‚</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>tokenizer</code> (é»˜è®¤ <code>None</code>)</p>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼š æŒ‡å®šä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼ˆå‡½æ•°ï¼‰ï¼Œç”¨äºè¦†ç›–é»˜è®¤çš„åˆ†è¯æµç¨‹ã€‚</p>
</li>
<li>
<p><strong>ç”¨é€”</strong>ï¼š è¿™æ˜¯<strong>å¤„ç†ä¸­æ–‡æ–‡æœ¬çš„å…³é”®å‚æ•°</strong>ã€‚é»˜è®¤çš„åˆ†è¯å™¨åŸºäºç©ºæ ¼å’Œæ­£åˆ™ï¼Œå¯¹ä¸­æ–‡æ— æ•ˆï¼ˆå› ä¸ºå®ƒä¸æŒ‰ç©ºæ ¼åˆ†ï¼‰ã€‚ä½ éœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹ä¸­æ–‡åˆ†è¯åº“ï¼ˆå¦‚ <code>jieba</code>ï¼‰ï¼Œå¹¶ä¼ å…¥å…¶åˆ†è¯å‡½æ•°ã€‚</p>
</li>
<li>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> jieba
<span class="hljs-keyword">from</span> sklearn.feature_extraction.text <span class="hljs-keyword">import</span> CountVectorizer
â€‹
<span class="hljs-keyword">def</span> <span class="hljs-title function_">chinese_tokenizer</span>(<span class="hljs-params">text</span>):
 Â  Â <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>(jieba.cut(text)) <span class="hljs-comment"># ä½¿ç”¨ç»“å·´åˆ†è¯</span>
â€‹
vectorizer = CountVectorizer(tokenizer=chinese_tokenizer)
</code></pre>
</li>
</ul>
</li>
<li>
<p><code>lowercase</code> (é»˜è®¤ <code>True</code>)</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼š åœ¨åˆ†è¯ä¹‹å‰ï¼Œæ˜¯å¦å°†æ‰€æœ‰å­—ç¬¦è½¬æ¢ä¸ºå°å†™ã€‚</li>
<li><strong>æ³¨æ„</strong>ï¼š å¯¹äºè‹±æ–‡ç­‰å¤§å°å†™æ•æ„Ÿçš„è¯­è¨€ï¼Œè¿™éå¸¸æœ‰ç”¨ï¼ˆç¡®ä¿â€œAppleâ€å’Œâ€œappleâ€è¢«è§†ä¸ºåŒä¸€ä¸ªè¯ï¼‰ã€‚å¯¹äºä¸­æ–‡ï¼Œæ­¤å‚æ•°æ— æ•ˆã€‚</li>
</ul>
</li>
<li>
<p><code>preprocessor</code> (é»˜è®¤ <code>None</code>)</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼š æŒ‡å®šä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼ˆå‡½æ•°ï¼‰ï¼Œç”¨äºåœ¨åˆ†è¯ä¹‹å‰å®Œå…¨è¦†ç›–æ•´ä¸ªé¢„å¤„ç†æ­¥éª¤ã€‚</li>
<li><strong>ç”¨é€”</strong>ï¼š å¦‚æœä½ æƒ³è¿›è¡Œéå¸¸è‡ªå®šä¹‰çš„æ–‡æœ¬æ¸…æ´—ï¼Œä¾‹å¦‚å»é™¤HTMLæ ‡ç­¾ã€æ›¿æ¢ç‰¹æ®Šå­—ç¬¦ç­‰ï¼Œå¯ä»¥åœ¨è¿™é‡Œå®šä¹‰ã€‚</li>
</ul>
</li>
<li>
<p><code>strip_accents</code> (é»˜è®¤ <code>None</code>)</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼š åœ¨é¢„å¤„ç†æœŸé—´å»é™¤é‡éŸ³ç¬¦å·ã€‚ä¾‹å¦‚ï¼Œå°† â€˜Ã©â€™ å˜ä¸º â€˜eâ€™ã€‚</li>
<li><strong>å¯é€‰å€¼</strong>ï¼š <code>â€˜asciiâ€™</code>, <code>â€˜unicodeâ€™</code>, <code>None</code>ã€‚ä¸»è¦ç”¨äºæ¬§æ´²è¯­è¨€ã€‚</li>
</ul>
</li>
</ul>
<ol start="2">
<li>åœç”¨è¯ç›¸å…³å‚æ•° (Stop Words)</li>
</ol>
<p>åœç”¨è¯æ˜¯æŒ‡åœ¨æ–‡æœ¬ä¸­é¢‘ç¹å‡ºç°ä½†æœ¬èº«æ²¡æœ‰å¤ªå¤šå®é™…æ„ä¹‰çš„è¯ï¼ˆå¦‚è‹±æ–‡çš„ â€œtheâ€, â€œandâ€, â€œisâ€ï¼‰ã€‚</p>
<ul>
<li>
<p><code>stop_words</code> (é»˜è®¤ <code>None</code>)</p>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼š æŒ‡å®šåœç”¨è¯åˆ—è¡¨ã€‚è¿™äº›è¯å°†è¢«ä»è¯è¡¨ä¸­å‰”é™¤ï¼Œä¸ä¼šä½œä¸ºç‰¹å¾å‡ºç°ã€‚</p>
</li>
<li>
<p><strong>å¯é€‰å€¼</strong>ï¼š</p>
<ul>
<li><code>â€˜englishâ€™</code>ï¼š ä½¿ç”¨scikit-learnå†…ç½®çš„è‹±è¯­åœç”¨è¯åˆ—è¡¨ã€‚</li>
<li><code>None</code> (é»˜è®¤)ï¼š ä¸ä½¿ç”¨ä»»ä½•åœç”¨è¯ã€‚</li>
<li><code>list</code>ï¼š å¯ä»¥ä¼ å…¥ä¸€ä¸ªè‡ªå®šä¹‰çš„åœç”¨è¯åˆ—è¡¨ã€‚</li>
</ul>
</li>
<li>
<p><strong>å¥½å¤„</strong>ï¼š ç§»é™¤åœç”¨è¯å¯ä»¥<strong>å‡å°‘ç‰¹å¾ç»´åº¦</strong>ï¼Œæé«˜æ¨¡å‹è®­ç»ƒé€Ÿåº¦ï¼Œå¹¶æœ‰æ—¶èƒ½æå‡æ¨¡å‹æ€§èƒ½ï¼ˆå‡å°‘å™ªéŸ³ï¼‰ã€‚</p>
</li>
</ul>
</li>
</ul>
<ol start="3">
<li>N-Gram ç›¸å…³å‚æ•°</li>
</ol>
<p>N-Gram æ˜¯æŒ‡ç”±Nä¸ªè¿ç»­çš„å•è¯ç»„æˆçš„åºåˆ—ã€‚<code>CountVectorizer</code> ä¸ä»…å¯ä»¥å¤„ç†å•ä¸ªè¯ï¼ˆunigramï¼‰ï¼Œè¿˜å¯ä»¥å¤„ç†è¯ç»„ã€‚</p>
<ul>
<li>
<p><code>ngram_range</code> (é»˜è®¤ <code>(1, 1)</code>)</p>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼š è¦æå–çš„n-gramçš„ä¸Šä¸‹é™ã€‚</p>
</li>
<li>
<p><strong>è¯¦è§£</strong>ï¼š</p>
<ul>
<li><code>(1, 1)</code>ï¼š åªæå–å•ä¸ªè¯ï¼ˆunigramï¼‰ã€‚</li>
<li><code>(1, 2)</code>ï¼š æå–å•ä¸ªè¯å’ŒäºŒå…ƒè¯ç»„ï¼ˆbigramï¼‰ã€‚ä¾‹å¦‚ï¼Œâ€œthis isâ€ å’Œ â€œis goodâ€ ä¹Ÿä¼šè¢«ä½œä¸ºç‰¹å¾ã€‚</li>
<li><code>(2, 2)</code>ï¼š åªæå–äºŒå…ƒè¯ç»„ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç”¨é€”</strong>ï¼š ä½¿ç”¨bigramæˆ–æ›´é«˜é˜¶çš„gramå¯ä»¥æ•è·ä¸€äº›ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä½†ä¼š<strong>æå¤§åœ°å¢åŠ ç‰¹å¾ç»´åº¦</strong>ã€‚</p>
</li>
</ul>
</li>
<li>
<p><code>analyzer</code> (é»˜è®¤ <code>â€˜wordâ€™</code>)</p>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼š å®šä¹‰ç‰¹å¾åº”è¯¥åŸºäºâ€œå•è¯â€è¿˜æ˜¯â€œå­—ç¬¦â€çº§åˆ«ç”Ÿæˆã€‚</p>
</li>
<li>
<p><strong>å¯é€‰å€¼</strong>ï¼š</p>
<ul>
<li><code>â€˜wordâ€™</code>ï¼š æŒ‰å•è¯ç”Ÿæˆn-gramã€‚</li>
<li><code>â€˜charâ€™</code>ï¼š æŒ‰å­—ç¬¦ç”Ÿæˆn-gramã€‚ä¾‹å¦‚ï¼Œå¯ä»¥æå–å­—ç¬¦çº§åˆ«çš„n-gramï¼ˆå¦‚ â€˜abâ€™, â€˜bcâ€™ï¼‰ä½œä¸ºç‰¹å¾ï¼Œé€‚ç”¨äºæŸäº›ç‰¹å®šé¢†åŸŸï¼ˆå¦‚åŸºå› åºåˆ—åˆ†æã€æ‹¼å†™é”™è¯¯æ£€æµ‹ï¼‰ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<ol start="4">
<li>è¯è¡¨ç‰¹å¾é€‰æ‹©å‚æ•° (Vocabulary Filtering)</li>
</ol>
<p>è¿™äº›å‚æ•°ç”¨äºåœ¨æ„å»ºè¯è¡¨æ—¶è‡ªåŠ¨è¿‡æ»¤æ‰ä¸€äº›ä¸é‡è¦çš„è¯ï¼Œæ˜¯<strong>æ§åˆ¶ç‰¹å¾ç»´åº¦ã€é˜²æ­¢â€œç»´åº¦çˆ†ç‚¸â€</strong> æœ€é‡è¦çš„æ‰‹æ®µã€‚</p>
<ul>
<li>
<p><code>max_df</code> (é»˜è®¤ <code>1.0</code>)</p>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼š å¿½ç•¥é‚£äº›<strong>æ–‡æ¡£é¢‘ç‡</strong>é«˜äºç»™å®šé˜ˆå€¼çš„è¯ã€‚ç”¨äºå‰”é™¤â€œè¿‡äºå¸¸è§â€çš„è¯ï¼ˆå¯èƒ½åŒ…æ‹¬åœç”¨è¯æˆ–ç‰¹å®šé¢†åŸŸçš„å¸¸è§è¯ï¼‰ã€‚</p>
</li>
<li>
<p><strong>å¯é€‰å€¼</strong>ï¼š</p>
<ul>
<li><code>float</code> (0.0åˆ°1.0ä¹‹é—´)ï¼š è¡¨ç¤ºæ¯”ä¾‹ã€‚ä¾‹å¦‚ <code>0.95</code> è¡¨ç¤ºå¿½ç•¥å‡ºç°åœ¨ 95% ä»¥ä¸Šæ–‡æ¡£ä¸­çš„è¯ã€‚</li>
<li><code>int</code>ï¼š è¡¨ç¤ºç»å¯¹é¢‘æ•°ã€‚ä¾‹å¦‚ <code>10</code> è¡¨ç¤ºå¿½ç•¥å‡ºç°åœ¨è¶…è¿‡10ä¸ªæ–‡æ¡£ä¸­çš„è¯ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>min_df</code> (é»˜è®¤ <code>1</code>)</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼š å¿½ç•¥é‚£äº›<strong>æ–‡æ¡£é¢‘ç‡</strong>ä½äºç»™å®šé˜ˆå€¼çš„è¯ã€‚ç”¨äºå‰”é™¤â€œè¿‡äºç½•è§â€çš„è¯ï¼ˆå¯èƒ½æ˜¯æ‹¼å†™é”™è¯¯æˆ–æ²¡æœ‰ç»Ÿè®¡æ„ä¹‰çš„è¯ï¼‰ã€‚</li>
<li><strong>å¯é€‰å€¼</strong>ï¼š åŒ <code>max_df</code>ï¼Œå¯ä»¥æ˜¯æ¯”ä¾‹æˆ–ç»å¯¹é¢‘æ•°ã€‚</li>
<li><strong>ç¤ºä¾‹</strong>ï¼š <code>min_df=2</code> ä¼šå¿½ç•¥æ‰€æœ‰åªåœ¨ä¸€ä¸ªæ–‡æ¡£ä¸­å‡ºç°è¿‡çš„è¯ã€‚</li>
</ul>
</li>
<li>
<p><code>max_features</code> (é»˜è®¤ <code>None</code>)</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼š é™åˆ¶è¯è¡¨çš„å¤§å°ï¼Œåªå–æ•´ä¸ªè¯­æ–™ä¸­è¯é¢‘æœ€é«˜çš„ <code>max_features</code> ä¸ªè¯ã€‚</li>
<li><strong>ç”¨é€”</strong>ï¼š è¿™æ˜¯ä¸€ç§ç®€å•ç²—æš´ä½†éå¸¸æœ‰æ•ˆçš„é™ç»´æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œè®¾ç½® <code>max_features=5000</code> å°†åªä¿ç•™æœ€å¸¸è§çš„5000ä¸ªè¯ä½œä¸ºç‰¹å¾ã€‚</li>
</ul>
</li>
<li>
<p><code>vocabulary</code> (é»˜è®¤ <code>None</code>)</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼š å¯ä»¥æ‰‹åŠ¨ä¼ å…¥ä¸€ä¸ªé¢„å…ˆå®šä¹‰å¥½çš„è¯è¡¨ï¼ˆå­—å…¸ï¼š<code>{word: index}</code> æˆ–åˆ—è¡¨ï¼‰ã€‚</li>
<li><strong>ç”¨é€”</strong>ï¼š å¦‚æœä½ å·²ç»æœ‰ä¸€ä¸ªå›ºå®šçš„è¯è¡¨ï¼Œå¸Œæœ› <code>CountVectorizer</code> åªåŸºäºè¿™äº›è¯è¿›è¡Œè½¬æ¢ï¼Œè€Œä¸ä»æ•°æ®ä¸­å­¦ä¹ ã€‚</li>
</ul>
</li>
</ul>
<ol start="5">
<li>è¾“å‡ºæ ¼å¼å‚æ•°</li>
</ol>
<ul>
<li>
<p><code>binary</code> (é»˜è®¤ <code>False</code>)</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼š å¦‚æœä¸º <code>True</code>ï¼Œæ‰€æœ‰éé›¶è®¡æ•°éƒ½è®¾ç½®ä¸º1ã€‚è¿™æ„å‘³ç€ç‰¹å¾ä¸å†è¡¨ç¤ºâ€œè¯é¢‘â€ï¼Œè€Œåªè¡¨ç¤ºâ€œæ˜¯å¦å‡ºç°â€ï¼ˆå³äºŒè¿›åˆ¶æŒ‡ç¤ºç‰¹å¾ï¼‰ã€‚</li>
<li><strong>ç”¨é€”</strong>ï¼š åœ¨ä¸€äº›ç®—æ³•ï¼ˆå¦‚ Bernoulli Naive Bayesï¼‰æˆ–å½“è¯é¢‘æœ¬èº«ä¸æ˜¯å¾ˆé‡è¦æ—¶ï¼Œä½¿ç”¨äºŒè¿›åˆ¶è¾“å‡ºå¯èƒ½æ›´æœ‰æ•ˆã€‚</li>
</ul>
</li>
<li>
<p><code>dtype</code> (é»˜è®¤ <code>numpy.int64</code>)</p>
<ul>
<li><strong>ä½œç”¨</strong>ï¼š æŒ‡å®šè¾“å‡ºçŸ©é˜µçš„æ•°æ®ç±»å‹ã€‚ä¸ºäº†èŠ‚çœå†…å­˜ï¼Œæœ‰æ—¶ä¼šä½¿ç”¨ <code>np.int32</code>ã€‚</li>
</ul>
</li>
</ul>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">from</span> sklearn<span class="hljs-selector-class">.feature_extraction</span><span class="hljs-selector-class">.text</span> import CountVectorizer
â€‹
# ç¤ºä¾‹æ–‡æœ¬æ•°æ®
corpus = <span class="hljs-selector-attr">[ Â  Â <span class="hljs-string">'I love love machine learning'</span>, Â  Â <span class="hljs-string">'Machine learning is fun'</span>, Â  Â <span class="hljs-string">'I love coding in Python'</span>]</span>
â€‹
# åˆå§‹åŒ– CountVectorizer
# min_df: å¿½ç•¥æ–‡æ¡£é¢‘ç‡ä½äºæ­¤å€¼çš„è¯
# stop_words: ç§»é™¤åœç”¨è¯ï¼ˆå¦‚ <span class="hljs-string">'the'</span>, <span class="hljs-string">'is'</span>, <span class="hljs-string">'and'</span>ï¼‰
vectorizer = <span class="hljs-built_in">CountVectorizer</span>(min_df=<span class="hljs-number">1</span>, stop_words=<span class="hljs-string">'english'</span>)
â€‹
# å­¦ä¹ è¯æ±‡å­—å…¸å¹¶è½¬æ¢æ–‡æœ¬æ•°æ®
X = vectorizer.<span class="hljs-built_in">fit_transform</span>(corpus)
â€‹
# æŸ¥çœ‹ç”Ÿæˆçš„è¯æ±‡è¡¨
<span class="hljs-built_in">print</span>(<span class="hljs-string">"è¯æ±‡è¡¨ï¼ˆç‰¹å¾åï¼‰:"</span>)
<span class="hljs-built_in">print</span>(vectorizer.<span class="hljs-built_in">get_feature_names_out</span>())
# è¾“å‡ºï¼š[<span class="hljs-string">'coding'</span> <span class="hljs-string">'fun'</span> <span class="hljs-string">'learning'</span> <span class="hljs-string">'love'</span> <span class="hljs-string">'machine'</span> <span class="hljs-string">'python'</span>]
â€‹
# æŸ¥çœ‹ç¨ å¯†çŸ©é˜µï¼ˆå®é™…åº”ç”¨ä¸­çŸ©é˜µé€šå¸¸éå¸¸ç¨€ç–ï¼Œç”¨.<span class="hljs-built_in">toarray</span>()æŸ¥çœ‹ï¼Œä½†ç”¨Xç›´æ¥è®¡ç®—ï¼‰
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\nç‰¹å¾å‘é‡çŸ©é˜µ:"</span>)
<span class="hljs-built_in">print</span>(X.<span class="hljs-built_in">toarray</span>())
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\nç¨€ç–çŸ©é˜µ:"</span>)
<span class="hljs-built_in">print</span>(X)
# è¾“å‡ºï¼š
# [[<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>]
#  [<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>]
#  [<span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span>]]
</code></pre>
<p>å¦‚æœè¿›è¡Œä¸­æ–‡æ–‡æœ¬ç‰¹å¾æå–ï¼Œæˆ‘ä»¬é¦–å…ˆè¦åšçš„æ˜¯ä¸­æ–‡åˆ†è¯ï¼Œæˆ‘ä»¬ä½¿ç”¨jiebaåº“ã€‚</p>
<pre><code class="hljs language-ruby" lang="ruby">pip install jieba -i <span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/mirrors.aliyun.com/pypi</span><span class="hljs-regexp">/simple/</span>  --trusted-host mirrors.aliyun.com
</code></pre>
<p>å…ˆå¯¹è¯­æ–™åº“è¿›è¡Œä¸­æ–‡åˆ†è¯å¤„ç†ï¼Œç„¶åå†è¿›è¡Œæ–‡æœ¬æå–ã€‚æ³¨æ„æˆ‘ä»¬è¿™é‡Œçš„åœç”¨è¯ï¼Œæ˜¯å¼€æºç½‘ç«™ä¸»æµçš„åœç”¨è¯åº“-stopWords.txtï¼Œé‡Œé¢åŒ…å«äº†æ‰€æœ‰ä¸éœ€è¦ï¼Œä¸é‡è¦çš„ä¸­è‹±æ–‡è¯è¯­åŒ…æ‹¬ç¬¦å·ã€‚</p>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> jieba
<span class="hljs-keyword">from</span> sklearn.feature_extraction.text <span class="hljs-keyword">import</span> CountVectorizer
â€‹
<span class="hljs-comment"># ç¤ºä¾‹æ–‡æœ¬æ•°æ®</span>
corpus = [
 Â  Â <span class="hljs-string">'Aè‚¡å›½äº§è½¯ä»¶æ¦‚å¿µè‚¡å…¨çº¿å¤§æ¶¨ï¼Œå¼€æ™®äº‘ã€æ­£å…ƒæ™ºæ…§ã€å›é€¸æ•°ç ç­‰å¥½å¤šå¼ºåŠ¿å¤§æ¶¨ï¼Œå¦æœ‰å¥½å¤šåªæ¦‚å¿µè‚¡å¤§æ¶¨ã€‚æ¶ˆæ¯é¢ä¸Šï¼Œå…¨æ–°ä¸€ä»£ä¸­å›½æ“ä½œç³»ç»Ÿâ€”â€”é“¶æ²³éº’éºŸæ“ä½œç³»ç»Ÿåœ¨â€œ2025ä¸­å›½æ“ä½œç³»ç»Ÿäº§ä¸šå¤§ä¼šâ€æ­£å¼å‘å¸ƒã€‚'</span>,
 Â  Â <span class="hljs-string">'ä¸Šæµ·å£¹å·é™¢äº”æ‰¹æ¬¡å¥½å¤šå¼€ç›˜ï¼Œæ•°å¥—æˆ¿æº1å°æ—¶å¼€ç›˜å”®ç½„ï¼ŒåŠ²é”€å¥½å¤šã€‚è‡³æ­¤å¥½å¤šï¼Œä¸Šæµ·å£¹å·é™¢ä»Šå¹´å¥½å¤šç´¯è®¡å¥½å¤šå¼€ç›˜æ€»é”€å”®é‡‘é¢è¶…ï¼Œå¥½å¤šç»§ç»­ä¿æŒå…¨å›½å•ç›˜é”€å† ä½ç½®ã€‚'</span>,
 Â  Â <span class="hljs-string">'å½“æ—¥ï¼Œåœ¨æ±Ÿè‹å—äº¬ä¸¾è¡Œçš„2025æ±Ÿè‹çœåŸå¸‚è¶³çƒè”èµ›å¥½å¤šç¬¬ä¹è½®æ¯”èµ›ä¸­ï¼Œå—äº¬é˜Ÿå¯¹é˜µç›åŸé˜Ÿã€‚å—äº¬å¸‚åœ¨éƒ¨åˆ†å•†åœºã€è¡—åŒºç­‰åœ°è®¾ç½®å¥½å¤šè§‚èµ›â€œç¬¬äºŒç°åœºâ€ï¼Œä½¿ç”¨å¤§å±å¹•åŒæ­¥ç›´æ’­èµ›äº‹ï¼ŒåŒæ—¶å¥½å¤šè®¾æœ‰æ¸¸æˆäº’åŠ¨åŒºã€çƒŸç«å¸‚é›†åŒºï¼Œè®©çƒè¿·ä»¬åº¦è¿‡æ¬¢ä¹æ—¶å…‰ã€‚'</span>
]   
â€‹
<span class="hljs-keyword">def</span> <span class="hljs-title function_">cut_word</span>(<span class="hljs-params">text</span>):
 Â  Â <span class="hljs-string">"""
 Â   jiebaä¸­æ–‡åˆ†è¯
 Â   :return:
 Â   """</span>
 Â  Â new_text = <span class="hljs-string">" "</span>.join(<span class="hljs-built_in">list</span>(jieba.cut(text)))
 Â  Â <span class="hljs-keyword">return</span> new_text
â€‹
<span class="hljs-comment"># æ™®é€šå†™æ³•</span>
new_corpus = []
<span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> corpus:
 Â  Â new_corpus.append(cut_word(c))
<span class="hljs-built_in">print</span>(new_corpus)
<span class="hljs-comment"># é«˜æ‰‹å†™æ³• æ¨å¯¼å¼ ä¸€å¥è¯æå®š</span>
<span class="hljs-comment"># new_corpus = [' '.join(list(jieba.cut(x))) for x in corpus]</span>
<span class="hljs-comment"># print(new_corpus)</span>
â€‹
<span class="hljs-comment"># åˆå§‹åŒ– CountVectorizer</span>
<span class="hljs-comment"># min_df: å¿½ç•¥æ–‡æ¡£é¢‘ç‡ä½äºæ­¤å€¼çš„è¯</span>
<span class="hljs-comment"># stop_words: ç§»é™¤åœç”¨è¯</span>
vectorizer = CountVectorizer(min_df=<span class="hljs-number">1</span>,
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  stop_words=[line.strip() <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'stopWords.txt'</span>, encoding=<span class="hljs-string">'UTF-8'</span>).readlines()])
â€‹
<span class="hljs-comment"># å­¦ä¹ è¯æ±‡å­—å…¸å¹¶è½¬æ¢æ–‡æœ¬æ•°æ®</span>
X = vectorizer.fit_transform(new_corpus)
â€‹
<span class="hljs-comment"># æŸ¥çœ‹ç”Ÿæˆçš„è¯æ±‡è¡¨</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"è¯æ±‡è¡¨ï¼ˆç‰¹å¾åï¼‰:"</span>)
<span class="hljs-built_in">print</span>(vectorizer.get_feature_names_out())
â€‹
<span class="hljs-comment"># æŸ¥çœ‹ç¨ å¯†çŸ©é˜µï¼ˆå®é™…åº”ç”¨ä¸­çŸ©é˜µé€šå¸¸éå¸¸ç¨€ç–ï¼Œç”¨.toarray()æŸ¥çœ‹ï¼Œä½†ç”¨Xç›´æ¥è®¡ç®—ï¼‰</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\nç‰¹å¾å‘é‡çŸ©é˜µ:"</span>)
<span class="hljs-built_in">print</span>(X.toarray())
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\nç¨€ç–çŸ©é˜µ:"</span>)
<span class="hljs-built_in">print</span>(X)
</code></pre>
<p>è¿è¡Œç»“æœï¼šæ¯”å¦‚'æ¯å¤©'è¿™ä¸ªè¯ï¼Œå±äºåœç”¨è¯é‡Œé¢çš„ï¼Œæ‰€ä»¥ä¸ä½œä¸ºç‰¹å¾ã€‚</p>
<pre><code class="hljs language-lua" lang="lua">[<span class="hljs-string">'Aè‚¡ å›½äº§è½¯ä»¶ æ¦‚å¿µè‚¡ å…¨çº¿ å¤§æ¶¨ ï¼Œ å¼€æ™®äº‘ ã€ æ­£ å…ƒ æ™ºæ…§ ã€ å›é€¸ æ•°ç  ç­‰ å¥½å¤š å¼ºåŠ¿ å¤§æ¶¨ ï¼Œ å¦æœ‰ å¥½å¤š åª æ¦‚å¿µè‚¡ å¤§æ¶¨ ã€‚ æ¶ˆæ¯ é¢ä¸Š ï¼Œ å…¨æ–° ä¸€ä»£ ä¸­å›½ æ“ä½œç³»ç»Ÿ â€” â€” é“¶æ²³ éº’éºŸ æ“ä½œç³»ç»Ÿ åœ¨ â€œ 2025 ä¸­å›½ æ“ä½œç³»ç»Ÿ äº§ä¸š å¤§ä¼š â€ æ­£å¼ å‘å¸ƒ ã€‚'</span>, <span class="hljs-string">'ä¸Šæµ· å£¹å· é™¢äº” æ‰¹æ¬¡ å¥½å¤š å¼€ç›˜ ï¼Œ æ•° å¥—æˆ¿ æº 1 å°æ—¶ å¼€ç›˜ å”®ç½„ ï¼Œ åŠ²é”€ å¥½å¤š ã€‚ è‡³æ­¤ å¥½å¤š ï¼Œ ä¸Šæµ· å£¹å· é™¢ ä»Šå¹´ å¥½å¤š ç´¯è®¡ å¥½å¤š å¼€ç›˜ æ€» é”€å”® é‡‘é¢ è¶… ï¼Œ å¥½å¤š ç»§ç»­ ä¿æŒ å…¨å›½ å•ç›˜ é”€å†  ä½ç½® ã€‚'</span>, <span class="hljs-string">'å½“æ—¥ ï¼Œ åœ¨ æ±Ÿè‹ å—äº¬ ä¸¾è¡Œ çš„ 2025 æ±Ÿè‹çœ åŸå¸‚ è¶³çƒè”èµ› å¥½å¤š ç¬¬ä¹è½® æ¯”èµ› ä¸­ ï¼Œ å—äº¬é˜Ÿ å¯¹é˜µ ç›åŸ é˜Ÿ ã€‚ å—äº¬å¸‚ åœ¨ éƒ¨åˆ† å•†åœº ã€ è¡—åŒº ç­‰ åœ° è®¾ç½® å¥½å¤š è§‚èµ› â€œ ç¬¬äºŒ ç°åœº â€ ï¼Œ ä½¿ç”¨ å¤§å±å¹• åŒæ­¥ ç›´æ’­ èµ›äº‹ ï¼Œ åŒæ—¶ å¥½å¤š è®¾æœ‰ æ¸¸æˆ äº’åŠ¨ åŒº ã€ çƒŸç« å¸‚é›† åŒº ï¼Œ è®© çƒè¿· ä»¬ åº¦è¿‡ æ¬¢ä¹ æ—¶å…‰ ã€‚'</span>]
è¯æ±‡è¡¨ï¼ˆç‰¹å¾åï¼‰:
[<span class="hljs-string">'2025'</span> <span class="hljs-string">'aè‚¡'</span> <span class="hljs-string">'ä¸€ä»£'</span> <span class="hljs-string">'ä¸Šæµ·'</span> <span class="hljs-string">'ä¸­å›½'</span> <span class="hljs-string">'äº’åŠ¨'</span> <span class="hljs-string">'äº§ä¸š'</span> <span class="hljs-string">'ä½ç½®'</span> <span class="hljs-string">'å…¨å›½'</span> <span class="hljs-string">'å…¨æ–°'</span> <span class="hljs-string">'å…¨çº¿'</span> <span class="hljs-string">'åŠ²é”€'</span> <span class="hljs-string">'å•ç›˜'</span> <span class="hljs-string">'å—äº¬'</span>
 <span class="hljs-string">'å—äº¬å¸‚'</span> <span class="hljs-string">'å—äº¬é˜Ÿ'</span> <span class="hljs-string">'å‘å¸ƒ'</span> <span class="hljs-string">'å¦æœ‰'</span> <span class="hljs-string">'åŒæ­¥'</span> <span class="hljs-string">'å›é€¸'</span> <span class="hljs-string">'å”®ç½„'</span> <span class="hljs-string">'å•†åœº'</span> <span class="hljs-string">'å›½äº§è½¯ä»¶'</span> <span class="hljs-string">'åŸå¸‚'</span> <span class="hljs-string">'å£¹å·'</span> <span class="hljs-string">'å¤§ä¼š'</span> <span class="hljs-string">'å¤§å±å¹•'</span>
 <span class="hljs-string">'å¤§æ¶¨'</span> <span class="hljs-string">'å¥—æˆ¿'</span> <span class="hljs-string">'å¥½å¤š'</span> <span class="hljs-string">'å¯¹é˜µ'</span> <span class="hljs-string">'å°æ—¶'</span> <span class="hljs-string">'å¸‚é›†'</span> <span class="hljs-string">'åº¦è¿‡'</span> <span class="hljs-string">'å¼€æ™®äº‘'</span> <span class="hljs-string">'å¼€ç›˜'</span> <span class="hljs-string">'å¼ºåŠ¿'</span> <span class="hljs-string">'å½“æ—¥'</span> <span class="hljs-string">'æ‰¹æ¬¡'</span> <span class="hljs-string">'æ“ä½œç³»ç»Ÿ'</span> <span class="hljs-string">'æ•°ç '</span>
 <span class="hljs-string">'æ—¶å…‰'</span> <span class="hljs-string">'æ™ºæ…§'</span> <span class="hljs-string">'æ¦‚å¿µè‚¡'</span> <span class="hljs-string">'æ¬¢ä¹'</span> <span class="hljs-string">'æ­£å¼'</span> <span class="hljs-string">'æ¯”èµ›'</span> <span class="hljs-string">'æ±Ÿè‹'</span> <span class="hljs-string">'æ±Ÿè‹çœ'</span> <span class="hljs-string">'æ¶ˆæ¯'</span> <span class="hljs-string">'æ¸¸æˆ'</span> <span class="hljs-string">'çƒŸç«'</span> <span class="hljs-string">'ç°åœº'</span> <span class="hljs-string">'çƒè¿·'</span> <span class="hljs-string">'ç›åŸ'</span>
 <span class="hljs-string">'ç›´æ’­'</span> <span class="hljs-string">'ç¬¬ä¹è½®'</span> <span class="hljs-string">'ç´¯è®¡'</span> <span class="hljs-string">'è‡³æ­¤'</span> <span class="hljs-string">'è¡—åŒº'</span> <span class="hljs-string">'è§‚èµ›'</span> <span class="hljs-string">'è®¾æœ‰'</span> <span class="hljs-string">'è®¾ç½®'</span> <span class="hljs-string">'èµ›äº‹'</span> <span class="hljs-string">'è¶³çƒè”èµ›'</span> <span class="hljs-string">'é‡‘é¢'</span> <span class="hljs-string">'é“¶æ²³'</span> <span class="hljs-string">'é”€å† '</span> <span class="hljs-string">'é”€å”®'</span>
 <span class="hljs-string">'é™¢äº”'</span> <span class="hljs-string">'é¢ä¸Š'</span> <span class="hljs-string">'éº’éºŸ'</span>]
â€‹
ç‰¹å¾å‘é‡çŸ©é˜µ:
<span class="hljs-string">[[1 1 1 0 2 0 1 0 0 1 1 0 0 0 0 0 1 1 0 1 0 0 1 0 0 1 0 3 0 2 0 0 0 0 1 0
  1 0 0 3 1 0 1 2 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 1]
 [0 0 0 2 0 0 0 1 1 0 0 1 1 0 0 0 0 0 0 0 1 0 0 0 2 0 0 0 1 6 0 1 0 0 0 3
  0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 1 0 1 1 1 0 0]
 [1 0 0 0 0 1 0 0 0 0 0 0 0 1 1 1 0 0 1 0 0 1 0 1 0 0 1 0 0 3 1 0 1 1 0 0
  0 1 0 0 0 1 0 0 1 0 1 1 1 0 1 1 1 1 1 1 1 0 0 1 1 1 1 1 1 0 0 0 0 0 0 0]]</span>
â€‹
ç¨€ç–çŸ©é˜µ:
&lt;Compressed Sparse Row sparse matrix of dtype <span class="hljs-string">'int64'</span>
    with <span class="hljs-number">75</span> stored elements <span class="hljs-keyword">and</span> shape (<span class="hljs-number">3</span>, <span class="hljs-number">72</span>)&gt;
  Coords    Values
  (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)    <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">22</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">43</span>)   <span class="hljs-number">2</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">27</span>)   <span class="hljs-number">3</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">34</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">42</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">19</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">40</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">29</span>)   <span class="hljs-number">2</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">36</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">17</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">49</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">70</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">9</span>)    <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>)    <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">4</span>)    <span class="hljs-number">2</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">39</span>)   <span class="hljs-number">3</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">66</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">71</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)    <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">6</span>)    <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">25</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">45</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">16</span>)   <span class="hljs-number">1</span>
  : :
  (<span class="hljs-number">2</span>, <span class="hljs-number">64</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">56</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">46</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">15</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">30</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">54</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">14</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">21</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">59</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">62</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">60</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">52</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">26</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">18</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">55</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">63</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">61</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">50</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">5</span>)    <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">51</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">32</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">53</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">33</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">44</span>)   <span class="hljs-number">1</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">41</span>)   <span class="hljs-number">1</span>
</code></pre>
<p>å‘é‡çš„å®šä¹‰ï¼š</p>
<p>åœ¨æ•°å­¦ä¸­ï¼Œå‘é‡ï¼ˆä¹Ÿç§°ä¸ºæ¬§å‡ é‡Œå¾—å‘é‡ã€å‡ ä½•å‘é‡ï¼‰ï¼Œ<em>æŒ‡å…·æœ‰å¤§å°ï¼ˆmagnitudeï¼‰å’Œæ–¹å‘çš„é‡</em></p>
<h3 data-id="heading-4">TF-IDF - TfidfVectorizer</h3>
<p>è¦ç†è§£ <code>TfidfVectorizer</code>ï¼Œé¦–å…ˆå¿…é¡»ç†è§£ <strong>TF-IDF</strong> çš„å«ä¹‰ã€‚å®ƒæ˜¯ä¸€ç§ç”¨äºä¿¡æ¯æ£€ç´¢å’Œæ–‡æœ¬æŒ–æ˜çš„å¸¸ç”¨åŠ æƒæŠ€æœ¯ï¼Œç”¨ä»¥è¯„ä¼°ä¸€ä¸ªè¯è¯­å¯¹äºä¸€ä¸ªè¯­æ–™åº“ä¸­çš„ä¸€ä»½æ–‡æ¡£çš„é‡è¦ç¨‹åº¦ã€‚</p>
<ul>
<li>
<p><strong>TF (Term Frequency - è¯é¢‘)</strong> ï¼š ä¸€ä¸ªè¯åœ¨<strong>å½“å‰æ–‡æ¡£</strong>ä¸­å‡ºç°çš„é¢‘ç‡ã€‚</p>
<ul>
<li>è®¡ç®—å…¬å¼ï¼š<code>TF(t) = (è¯tåœ¨å½“å‰æ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°) / (å½“å‰æ–‡æ¡£ä¸­æ‰€æœ‰è¯çš„æ€»æ•°)</code></li>
<li><strong>æ€æƒ³</strong>ï¼š ä¸€ä¸ªè¯åœ¨æ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°è¶Šå¤šï¼Œå®ƒå¯¹è¯¥æ–‡æ¡£è¶Šé‡è¦ã€‚</li>
</ul>
</li>
<li>
<p><strong>IDF (Inverse Document Frequency - é€†æ–‡æ¡£é¢‘ç‡)</strong> ï¼š ä¸€ä¸ªè¯<strong>åœ¨æ•´ä¸ªè¯­æ–™åº“</strong>ä¸­çš„æ™®éé‡è¦æ€§ã€‚</p>
<ul>
<li>è®¡ç®—å…¬å¼ï¼š<code>IDF(t) = log( (æ€»æ–‡æ¡£æ•°) / (åŒ…å«è¯tçš„æ–‡æ¡£æ•° + 1) )</code> å¤‡æ³¨ï¼š logåº•æ•°æ˜¯10</li>
<li><strong>æ€æƒ³</strong>ï¼š å¦‚æœä¸€ä¸ªè¯åœ¨å¾ˆå¤šæ–‡æ¡£ä¸­éƒ½å‡ºç°ï¼ˆå¦‚â€œçš„â€ã€â€œæ˜¯â€ï¼‰ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€ä¸ªå¸¸è§è¯ï¼Œå…¶é‡è¦æ€§åº”è¯¥è¢«é™ä½ï¼ˆIDFå€¼å°ï¼‰ã€‚åä¹‹ï¼Œå¦‚æœä¸€ä¸ªè¯åªåœ¨å°‘æ•°å‡ ç¯‡æ–‡æ¡£ä¸­å‡ºç°ï¼Œé‚£ä¹ˆå®ƒå°±èƒ½å¾ˆå¥½åœ°ä»£è¡¨é‚£äº›æ–‡æ¡£çš„ç‰¹ç‚¹ï¼ˆIDFå€¼å¤§ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>TF-IDF</strong>ï¼š å°†ä¸¤è€…ç›¸ä¹˜ã€‚</p>
<ul>
<li><code>TF-IDF(t) = TF(t) * IDF(t)</code></li>
<li><strong>æœ€ç»ˆæ€æƒ³</strong>ï¼š <strong>ä¸€ä¸ªè¯çš„é‡è¦æ€§éšç€å®ƒåœ¨å½“å‰æ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°æˆæ­£æ¯”å¢åŠ ï¼Œä½†åŒæ—¶ä¼šéšç€å®ƒåœ¨æ•´ä¸ªè¯­æ–™åº“ä¸­å‡ºç°çš„é¢‘ç‡æˆåæ¯”ä¸‹é™</strong>ã€‚è¿™æœ‰æ•ˆåœ°è¿‡æ»¤æ‰äº†å¸¸è§çš„è¯è¯­ï¼Œä¿ç•™äº†é‡è¦çš„è¯è¯­ã€‚</li>
</ul>
</li>
</ul>
<p><strong>TfidfVectorizer æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p><code>TfidfVectorizer</code> å¯ä»¥çœ‹ä½œæ˜¯ <code>CountVectorizer</code> çš„å‡çº§ç‰ˆå’Œé›†æˆç‰ˆã€‚å®ƒçš„å·¥ä½œæµç¨‹åˆ†ä¸ºä¸¤æ­¥ï¼š</p>
<ol start="0">
<li><strong>ä½¿ç”¨ CountVectorizer çš„æ–¹æ³•</strong>ï¼š é¦–å…ˆï¼Œå®ƒå°†åŸå§‹æ–‡æœ¬è½¬æ¢ä¸ºè¯é¢‘è®¡æ•°çŸ©é˜µã€‚</li>
<li><strong>åº”ç”¨ TF-IDF å˜æ¢</strong>ï¼š ç„¶åï¼Œå®ƒå¯¹ç¬¬ä¸€æ­¥å¾—åˆ°çš„è¯é¢‘çŸ©é˜µè¿›è¡Œ TF-IDF åŠ æƒè®¡ç®—ï¼Œå°†åŸå§‹çš„è®¡æ•°è½¬æ¢æˆä¸€ä¸ªæ›´èƒ½ä½“ç°è¯è¯­é‡è¦æ€§çš„æƒé‡çŸ©é˜µã€‚</li>
</ol>
<p><strong>ç®€å•æ¥è¯´ï¼šTfidfVectorizer = CountVectorizer + TfidfTransformer</strong></p>
<p><strong>æ ¸å¿ƒå‚æ•°è¯¦è§£</strong></p>
<p><code>TfidfVectorizer</code> <strong>ç»§æ‰¿äº† CountVectorizer çš„æ‰€æœ‰å‚æ•°</strong>ï¼Œç”¨äºæ§åˆ¶åˆ†è¯ã€æ„å»ºè¯è¡¨ç­‰è¿‡ç¨‹ã€‚è¿™æ„å‘³ç€ä½ ä¹‹å‰ä¸º <code>CountVectorizer</code> å­¦çš„æ‰€æœ‰å‚æ•°ï¼ˆå¦‚ <code>max_df</code>, <code>min_df</code>, <code>stop_words</code>, <code>ngram_range</code>, <code>tokenizer</code> ç­‰ï¼‰åœ¨è¿™é‡Œå®Œå…¨é€‚ç”¨ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒè¿˜æœ‰è‡ªå·±ç‹¬æœ‰çš„å‡ ä¸ªæ ¸å¿ƒå‚æ•°ï¼Œä¸»è¦ç”¨äºæ§åˆ¶ TF-IDF çš„è®¡ç®—æ–¹å¼ï¼š</p>
<ol start="0">
<li><code>norm</code> (é»˜è®¤ <code>'l2'</code>)</li>
</ol>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼š å¯¹æ¯ä¸ªæ–‡æ¡£ï¼ˆæ¯è¡Œï¼‰è¿›è¡Œå‘é‡å½’ä¸€åŒ–ã€‚</p>
</li>
<li>
<p><strong>å¯é€‰å€¼</strong>ï¼š</p>
<ul>
<li><code>'l2'</code> (é»˜è®¤)ï¼š å°†æ¯ä¸ªæ–‡æ¡£çš„å‘é‡å½’ä¸€åŒ–ä¸ºæ¬§å‡ é‡Œå¾—èŒƒæ•°ï¼ˆL2èŒƒæ•°ï¼‰ä¸º1ã€‚è®¡ç®—å…¬å¼ï¼š<code>v = v / sqrt(sum(v**2))</code>ã€‚è¿™æ˜¯æœ€å¸¸ç”¨çš„è®¾ç½®ï¼Œä½¿å¾—ä¸åŒé•¿åº¦çš„æ–‡æ¡£ä¹‹é—´çš„å‘é‡å¯ä»¥è¿›è¡Œæ¯”è¾ƒï¼ˆè®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦æ—¶ç›´æ¥ç‚¹ç§¯å³å¯ï¼‰ã€‚</li>
<li><code>'l1'</code>ï¼š å°†æ¯ä¸ªæ–‡æ¡£çš„å‘é‡å½’ä¸€åŒ–ä¸ºæ›¼å“ˆé¡¿èŒƒæ•°ï¼ˆL1èŒƒæ•°ï¼‰ä¸º1ã€‚è®¡ç®—å…¬å¼ï¼š<code>v = v / sum(|v|)</code>ã€‚</li>
<li><code>None</code>ï¼š ä¸è¿›è¡Œä»»ä½•å½’ä¸€åŒ–ã€‚å¦‚æœä½ åç»­è‡ªå·±è¿›è¡Œå½’ä¸€åŒ–ï¼Œæˆ–è€…ä½¿ç”¨å¯¹ç‰¹å¾å°ºåº¦ä¸æ•æ„Ÿçš„æ¨¡å‹ï¼ˆå¦‚æ ‘æ¨¡å‹ï¼‰ï¼Œå¯ä»¥å…³é—­å®ƒã€‚</li>
</ul>
</li>
</ul>
<ol start="2">
<li><code>use_idf</code> (é»˜è®¤ <code>True</code>)</li>
</ol>
<ul>
<li><strong>ä½œç”¨</strong>ï¼š æ˜¯å¦å¯ç”¨ IDF åŠ æƒã€‚å¦‚æœè®¾ç½®ä¸º <code>False</code>ï¼Œåˆ™å…¬å¼ä¸­å°† <code>IDF(t)=1</code>ï¼Œç›¸å½“äºåªä½¿ç”¨è¯é¢‘ï¼ˆTFï¼‰ï¼Œé€€åŒ–ä¸ºä¸€ä¸ªå½’ä¸€åŒ–çš„ <code>CountVectorizer</code>ã€‚</li>
<li><strong>ç”¨é€”</strong>ï¼š é€šå¸¸ä¿æŒé»˜è®¤çš„ <code>True</code> æ¥åˆ©ç”¨ IDF çš„å¼ºå¤§æ•ˆæœã€‚åœ¨æŸäº›ç‰¹å®šåœºæ™¯ä¸‹å¯èƒ½ä¼šå…³é—­ã€‚</li>
</ul>
<ol start="3">
<li><code>smooth_idf</code> (é»˜è®¤ <code>True</code>)</li>
</ol>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼š æ˜¯å¦å¹³æ»‘ IDF æƒé‡ï¼Œé˜²æ­¢é™¤é›¶é”™è¯¯ã€‚</p>
</li>
<li>
<p><strong>è¯¦è§£</strong>ï¼š</p>
<ul>
<li><code>True</code> (é»˜è®¤)ï¼š ä½¿ç”¨å¹³æ»‘åçš„ IDF å…¬å¼ï¼š<code>idf(t) = log( (1 + æ€»æ–‡æ¡£æ•°) / (1 + åŒ…å«è¯tçš„æ–‡æ¡£æ•°) ) + 1</code>ã€‚è¿™æ˜¯ä¸€ç§å¸¸è§çš„å¹³æ»‘æ–¹å¼ã€‚</li>
<li><code>False</code>ï¼š ä½¿ç”¨åŸå§‹ IDF å…¬å¼ï¼š<code>idf(t) = log( æ€»æ–‡æ¡£æ•° / åŒ…å«è¯tçš„æ–‡æ¡£æ•° ) + 1</code>ï¼ˆæ³¨æ„scikit-learnçš„å®ç°ä¸­é»˜è®¤åŠ äº†1ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>å»ºè®®</strong>ï¼š ä¿æŒé»˜è®¤çš„ <code>True</code>ï¼Œä½¿ç»Ÿè®¡æ›´ç¨³å®šã€‚</p>
</li>
</ul>
<ol start="4">
<li><code>sublinear_tf</code> (é»˜è®¤ <code>False</code>)</li>
</ol>
<ul>
<li>
<p><strong>ä½œç”¨</strong>ï¼š æ˜¯å¦å¯¹è¯é¢‘ï¼ˆTFï¼‰è¿›è¡Œäºšçº¿æ€§ç¼©æ”¾ã€‚</p>
</li>
<li>
<p><strong>è¯¦è§£</strong>ï¼š</p>
<ul>
<li><code>False</code> (é»˜è®¤)ï¼š ä½¿ç”¨åŸå§‹è¯é¢‘ã€‚</li>
<li><code>True</code>ï¼š å°†è¯é¢‘ <code>tf</code> æ›¿æ¢ä¸º <code>1 + log(tf)</code>ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯<strong>å‡å¼±é«˜é¢‘è¯å‡ºç°æ¬¡æ•°è¿‡å¤šå¸¦æ¥çš„çº¿æ€§å½±å“</strong>ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªè¯å‡ºç°20æ¬¡ï¼Œå¹¶ä¸æ„å‘³ç€å®ƒæ˜¯å‡ºç°1æ¬¡çš„é‚£ä¸ªè¯çš„20å€é‡è¦ã€‚ä½¿ç”¨å¯¹æ•°ç¼©æ”¾å¯ä»¥ç¼“è§£è¿™ç§çº¿æ€§å…³ç³»ã€‚</li>
</ul>
</li>
</ul>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> jieba
<span class="hljs-keyword">from</span> sklearn.feature_extraction.text <span class="hljs-keyword">import</span> TfidfVectorizer
â€‹
<span class="hljs-comment"># ç¤ºä¾‹æ–‡æœ¬æ•°æ®</span>
corpus = [
 Â  Â <span class="hljs-string">'Aè‚¡å›½äº§è½¯ä»¶æ¦‚å¿µè‚¡å…¨çº¿å¤§æ¶¨ï¼Œå¼€æ™®äº‘ã€æ­£å…ƒæ™ºæ…§ã€å›é€¸æ•°ç ç­‰å¥½å¤šå¼ºåŠ¿å¤§æ¶¨ï¼Œå¦æœ‰å¥½å¤šåªæ¦‚å¿µè‚¡å¤§æ¶¨ã€‚æ¶ˆæ¯é¢ä¸Šï¼Œå…¨æ–°ä¸€ä»£ä¸­å›½æ“ä½œç³»ç»Ÿâ€”â€”é“¶æ²³éº’éºŸæ“ä½œç³»ç»Ÿåœ¨â€œ2025ä¸­å›½æ“ä½œç³»ç»Ÿäº§ä¸šå¤§ä¼šâ€æ­£å¼å‘å¸ƒã€‚'</span>,
 Â  Â <span class="hljs-string">'ä¸Šæµ·å£¹å·é™¢äº”æ‰¹æ¬¡å¥½å¤šå¼€ç›˜ï¼Œæ•°å¥—æˆ¿æº1å°æ—¶å¼€ç›˜å”®ç½„ï¼ŒåŠ²é”€å¥½å¤šã€‚è‡³æ­¤å¥½å¤šï¼Œä¸Šæµ·å£¹å·é™¢ä»Šå¹´å¥½å¤šç´¯è®¡å¥½å¤šå¼€ç›˜æ€»é”€å”®é‡‘é¢è¶…ï¼Œå¥½å¤šç»§ç»­ä¿æŒå…¨å›½å•ç›˜é”€å† ä½ç½®ã€‚'</span>,
 Â  Â <span class="hljs-string">'å½“æ—¥ï¼Œåœ¨æ±Ÿè‹å—äº¬ä¸¾è¡Œçš„2025æ±Ÿè‹çœåŸå¸‚è¶³çƒè”èµ›å¥½å¤šç¬¬ä¹è½®æ¯”èµ›ä¸­ï¼Œå—äº¬é˜Ÿå¯¹é˜µç›åŸé˜Ÿã€‚å—äº¬å¸‚åœ¨éƒ¨åˆ†å•†åœºã€è¡—åŒºç­‰åœ°è®¾ç½®å¥½å¤šè§‚èµ›â€œç¬¬äºŒç°åœºâ€ï¼Œä½¿ç”¨å¤§å±å¹•åŒæ­¥ç›´æ’­èµ›äº‹ï¼ŒåŒæ—¶å¥½å¤šè®¾æœ‰æ¸¸æˆäº’åŠ¨åŒºã€çƒŸç«å¸‚é›†åŒºï¼Œè®©çƒè¿·ä»¬åº¦è¿‡æ¬¢ä¹æ—¶å…‰ã€‚'</span>
]
â€‹
<span class="hljs-keyword">def</span> <span class="hljs-title function_">cut_word</span>(<span class="hljs-params">text</span>):
 Â  Â <span class="hljs-string">"""
 Â   jiebaä¸­æ–‡åˆ†è¯
 Â   :return:
 Â   """</span>
 Â  Â new_text = <span class="hljs-string">" "</span>.join(<span class="hljs-built_in">list</span>(jieba.cut(text)))
 Â  Â <span class="hljs-keyword">return</span> new_text
â€‹
â€‹
<span class="hljs-comment"># æ™®é€šå†™æ³•</span>
new_corpus = []
<span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> corpus:
 Â  Â new_corpus.append(cut_word(c))
<span class="hljs-built_in">print</span>(new_corpus)
<span class="hljs-comment"># é«˜æ‰‹å†™æ³• æ¨å¯¼å¼ ä¸€å¥è¯æå®š</span>
<span class="hljs-comment"># new_corpus = [' '.join(list(jieba.cut(x))) for x in corpus]</span>
<span class="hljs-comment"># print(new_corpus)</span>
â€‹
<span class="hljs-comment"># åˆå§‹åŒ– TfidfVectorizer</span>
<span class="hljs-comment"># min_df: å¿½ç•¥æ–‡æ¡£é¢‘ç‡ä½äºæ­¤å€¼çš„è¯</span>
<span class="hljs-comment"># stop_words: ç§»é™¤åœç”¨è¯</span>
vectorizer = TfidfVectorizer(min_df=<span class="hljs-number">1</span>,
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  stop_words=[line.strip() <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'stopWords.txt'</span>, encoding=<span class="hljs-string">'UTF-8'</span>).readlines()])
â€‹
<span class="hljs-comment"># å­¦ä¹ è¯æ±‡å­—å…¸å¹¶è½¬æ¢æ–‡æœ¬æ•°æ®</span>
X = vectorizer.fit_transform(new_corpus)
â€‹
<span class="hljs-comment"># æŸ¥çœ‹ç”Ÿæˆçš„è¯æ±‡è¡¨</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"è¯æ±‡è¡¨ï¼ˆç‰¹å¾åï¼‰:"</span>)
<span class="hljs-built_in">print</span>(vectorizer.get_feature_names_out())
â€‹
<span class="hljs-comment"># æŸ¥çœ‹ç¨ å¯†çŸ©é˜µï¼ˆå®é™…åº”ç”¨ä¸­çŸ©é˜µé€šå¸¸éå¸¸ç¨€ç–ï¼Œç”¨.toarray()æŸ¥çœ‹ï¼Œä½†ç”¨Xç›´æ¥è®¡ç®—ï¼‰</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\nç‰¹å¾å‘é‡çŸ©é˜µ:"</span>)
<span class="hljs-built_in">print</span>(X.toarray())
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\nç¨€ç–çŸ©é˜µ:"</span>)
<span class="hljs-built_in">print</span>(X)
â€‹
<span class="hljs-comment"># æŸ¥çœ‹ç¬¬ä¸€å¥çš„TF-IDFæƒé‡ï¼ˆåªæ˜¾ç¤ºæƒé‡éé›¶çš„ç‰¹å¾ï¼‰</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n--- ç¬¬ä¸€å¥è¯çš„TF-IDFå‘é‡ ---"</span>)
feature_names = vectorizer.get_feature_names_out()
first_doc_vector = X[<span class="hljs-number">0</span>].toarray()[<span class="hljs-number">0</span>] Â <span class="hljs-comment"># å–ç¬¬ä¸€è¡Œï¼Œå¹¶è½¬æ¢ä¸ºå¯†é›†æ•°ç»„</span>
<span class="hljs-comment"># åˆ›å»ºä¸€ä¸ª(ç‰¹å¾å, æƒé‡)çš„åˆ—è¡¨ï¼Œå¹¶æŒ‰æƒé‡é™åºæ’åº</span>
sorted_weights = <span class="hljs-built_in">sorted</span>(<span class="hljs-built_in">zip</span>(feature_names, first_doc_vector), key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>], reverse=<span class="hljs-literal">True</span>)
<span class="hljs-comment"># æ‰“å°æƒé‡å¤§äº0.2çš„ç‰¹å¾</span>
<span class="hljs-keyword">for</span> word, weight <span class="hljs-keyword">in</span> sorted_weights:
 Â  Â <span class="hljs-keyword">if</span> weight &gt; <span class="hljs-number">0.2</span>:
 Â  Â  Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{word}</span>: <span class="hljs-subst">{weight:<span class="hljs-number">.4</span>f}</span>"</span>)
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<pre><code class="hljs language-lua" lang="lua">[<span class="hljs-string">'Aè‚¡ å›½äº§è½¯ä»¶ æ¦‚å¿µè‚¡ å…¨çº¿ å¤§æ¶¨ ï¼Œ å¼€æ™®äº‘ ã€ æ­£ å…ƒ æ™ºæ…§ ã€ å›é€¸ æ•°ç  ç­‰ å¥½å¤š å¼ºåŠ¿ å¤§æ¶¨ ï¼Œ å¦æœ‰ å¥½å¤š åª æ¦‚å¿µè‚¡ å¤§æ¶¨ ã€‚ æ¶ˆæ¯ é¢ä¸Š ï¼Œ å…¨æ–° ä¸€ä»£ ä¸­å›½ æ“ä½œç³»ç»Ÿ â€” â€” é“¶æ²³ éº’éºŸ æ“ä½œç³»ç»Ÿ åœ¨ â€œ 2025 ä¸­å›½ æ“ä½œç³»ç»Ÿ äº§ä¸š å¤§ä¼š â€ æ­£å¼ å‘å¸ƒ ã€‚'</span>, <span class="hljs-string">'ä¸Šæµ· å£¹å· é™¢äº” æ‰¹æ¬¡ å¥½å¤š å¼€ç›˜ ï¼Œ æ•° å¥—æˆ¿ æº 1 å°æ—¶ å¼€ç›˜ å”®ç½„ ï¼Œ åŠ²é”€ å¥½å¤š ã€‚ è‡³æ­¤ å¥½å¤š ï¼Œ ä¸Šæµ· å£¹å· é™¢ ä»Šå¹´ å¥½å¤š ç´¯è®¡ å¥½å¤š å¼€ç›˜ æ€» é”€å”® é‡‘é¢ è¶… ï¼Œ å¥½å¤š ç»§ç»­ ä¿æŒ å…¨å›½ å•ç›˜ é”€å†  ä½ç½® ã€‚'</span>, <span class="hljs-string">'å½“æ—¥ ï¼Œ åœ¨ æ±Ÿè‹ å—äº¬ ä¸¾è¡Œ çš„ 2025 æ±Ÿè‹çœ åŸå¸‚ è¶³çƒè”èµ› å¥½å¤š ç¬¬ä¹è½® æ¯”èµ› ä¸­ ï¼Œ å—äº¬é˜Ÿ å¯¹é˜µ ç›åŸ é˜Ÿ ã€‚ å—äº¬å¸‚ åœ¨ éƒ¨åˆ† å•†åœº ã€ è¡—åŒº ç­‰ åœ° è®¾ç½® å¥½å¤š è§‚èµ› â€œ ç¬¬äºŒ ç°åœº â€ ï¼Œ ä½¿ç”¨ å¤§å±å¹• åŒæ­¥ ç›´æ’­ èµ›äº‹ ï¼Œ åŒæ—¶ å¥½å¤š è®¾æœ‰ æ¸¸æˆ äº’åŠ¨ åŒº ã€ çƒŸç« å¸‚é›† åŒº ï¼Œ è®© çƒè¿· ä»¬ åº¦è¿‡ æ¬¢ä¹ æ—¶å…‰ ã€‚'</span>]
è¯æ±‡è¡¨ï¼ˆç‰¹å¾åï¼‰:
[<span class="hljs-string">'2025'</span> <span class="hljs-string">'aè‚¡'</span> <span class="hljs-string">'ä¸€ä»£'</span> <span class="hljs-string">'ä¸Šæµ·'</span> <span class="hljs-string">'ä¸­å›½'</span> <span class="hljs-string">'äº’åŠ¨'</span> <span class="hljs-string">'äº§ä¸š'</span> <span class="hljs-string">'ä½ç½®'</span> <span class="hljs-string">'å…¨å›½'</span> <span class="hljs-string">'å…¨æ–°'</span> <span class="hljs-string">'å…¨çº¿'</span> <span class="hljs-string">'åŠ²é”€'</span> <span class="hljs-string">'å•ç›˜'</span> <span class="hljs-string">'å—äº¬'</span>
 <span class="hljs-string">'å—äº¬å¸‚'</span> <span class="hljs-string">'å—äº¬é˜Ÿ'</span> <span class="hljs-string">'å‘å¸ƒ'</span> <span class="hljs-string">'å¦æœ‰'</span> <span class="hljs-string">'åŒæ­¥'</span> <span class="hljs-string">'å›é€¸'</span> <span class="hljs-string">'å”®ç½„'</span> <span class="hljs-string">'å•†åœº'</span> <span class="hljs-string">'å›½äº§è½¯ä»¶'</span> <span class="hljs-string">'åŸå¸‚'</span> <span class="hljs-string">'å£¹å·'</span> <span class="hljs-string">'å¤§ä¼š'</span> <span class="hljs-string">'å¤§å±å¹•'</span>
 <span class="hljs-string">'å¤§æ¶¨'</span> <span class="hljs-string">'å¥—æˆ¿'</span> <span class="hljs-string">'å¥½å¤š'</span> <span class="hljs-string">'å¯¹é˜µ'</span> <span class="hljs-string">'å°æ—¶'</span> <span class="hljs-string">'å¸‚é›†'</span> <span class="hljs-string">'åº¦è¿‡'</span> <span class="hljs-string">'å¼€æ™®äº‘'</span> <span class="hljs-string">'å¼€ç›˜'</span> <span class="hljs-string">'å¼ºåŠ¿'</span> <span class="hljs-string">'å½“æ—¥'</span> <span class="hljs-string">'æ‰¹æ¬¡'</span> <span class="hljs-string">'æ“ä½œç³»ç»Ÿ'</span> <span class="hljs-string">'æ•°ç '</span>
 <span class="hljs-string">'æ—¶å…‰'</span> <span class="hljs-string">'æ™ºæ…§'</span> <span class="hljs-string">'æ¦‚å¿µè‚¡'</span> <span class="hljs-string">'æ¬¢ä¹'</span> <span class="hljs-string">'æ­£å¼'</span> <span class="hljs-string">'æ¯”èµ›'</span> <span class="hljs-string">'æ±Ÿè‹'</span> <span class="hljs-string">'æ±Ÿè‹çœ'</span> <span class="hljs-string">'æ¶ˆæ¯'</span> <span class="hljs-string">'æ¸¸æˆ'</span> <span class="hljs-string">'çƒŸç«'</span> <span class="hljs-string">'ç°åœº'</span> <span class="hljs-string">'çƒè¿·'</span> <span class="hljs-string">'ç›åŸ'</span>
 <span class="hljs-string">'ç›´æ’­'</span> <span class="hljs-string">'ç¬¬ä¹è½®'</span> <span class="hljs-string">'ç´¯è®¡'</span> <span class="hljs-string">'è‡³æ­¤'</span> <span class="hljs-string">'è¡—åŒº'</span> <span class="hljs-string">'è§‚èµ›'</span> <span class="hljs-string">'è®¾æœ‰'</span> <span class="hljs-string">'è®¾ç½®'</span> <span class="hljs-string">'èµ›äº‹'</span> <span class="hljs-string">'è¶³çƒè”èµ›'</span> <span class="hljs-string">'é‡‘é¢'</span> <span class="hljs-string">'é“¶æ²³'</span> <span class="hljs-string">'é”€å† '</span> <span class="hljs-string">'é”€å”®'</span>
 <span class="hljs-string">'é™¢äº”'</span> <span class="hljs-string">'é¢ä¸Š'</span> <span class="hljs-string">'éº’éºŸ'</span>]
â€‹
ç‰¹å¾å‘é‡çŸ©é˜µ:
<span class="hljs-string">[[0.11096513 0.14590581 0.14590581 0. Â  Â  Â  Â  0.29181161 0.
  0.14590581 0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.14590581 0.14590581 0.
  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.14590581 0.14590581
  0. Â  Â  Â  Â  0.14590581 0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.14590581 0.
  0. Â  Â  Â  Â  0.14590581 0. Â  Â  Â  Â  0.43771742 0. Â  Â  Â  Â  0.17234864
  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.14590581 0.
  0.14590581 0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.43771742 0.14590581 0.
  0.14590581 0.29181161 0. Â  Â  Â  Â  0.14590581 0. Â  Â  Â  Â  0.
  0. Â  Â  Â  Â  0.14590581 0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.
  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.
  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.
  0.14590581 0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.14590581 0.14590581]
 [0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.303038 Â  0. Â  Â  Â  Â  0.
  0. Â  Â  Â  Â  0.151519 Â  0.151519 Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.151519
  0.151519 Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.
  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.151519 Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.
  0.303038 Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.151519 Â  0.53693738
  0. Â  Â  Â  Â  0.151519 Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.45455701
  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.151519 Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.
  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.
  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.
  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.151519 Â  0.151519 Â  0.
  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.151519
  0. Â  Â  Â  Â  0.151519 Â  0.151519 Â  0.151519 Â  0. Â  Â  Â  Â  0. Â  Â  Â   ]
 [0.13097368 0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.17221465
  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.
  0. Â  Â  Â  Â  0.17221465 0.17221465 0.17221465 0. Â  Â  Â  Â  0.
  0.17221465 0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.17221465 0. Â  Â  Â  Â  0.17221465
  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.17221465 0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.30513824
  0.17221465 0. Â  Â  Â  Â  0.17221465 0.17221465 0. Â  Â  Â  Â  0.
  0. Â  Â  Â  Â  0.17221465 0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.17221465
  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.17221465 0. Â  Â  Â  Â  0.17221465 0.17221465
  0.17221465 0. Â  Â  Â  Â  0.17221465 0.17221465 0.17221465 0.17221465
  0.17221465 0.17221465 0.17221465 0. Â  Â  Â  Â  0. Â  Â  Â  Â  0.17221465
  0.17221465 0.17221465 0.17221465 0.17221465 0.17221465 0.
  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â  Â  0. Â  Â  Â   ]]</span>
â€‹
ç¨€ç–çŸ©é˜µ:
&lt;Compressed Sparse Row sparse matrix of dtype <span class="hljs-string">'float64'</span>
    with <span class="hljs-number">75</span> stored elements <span class="hljs-keyword">and</span> shape (<span class="hljs-number">3</span>, <span class="hljs-number">72</span>)&gt;
  Coords    Values
  (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)    <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">22</span>)   <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">43</span>)   <span class="hljs-number">0.29181161161012426</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)   <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">27</span>)   <span class="hljs-number">0.4377174174151864</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">34</span>)   <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">42</span>)   <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">19</span>)   <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">40</span>)   <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">29</span>)   <span class="hljs-number">0.17234863865385786</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">36</span>)   <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">17</span>)   <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">49</span>)   <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">70</span>)   <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">9</span>)    <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">2</span>)    <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">4</span>)    <span class="hljs-number">0.29181161161012426</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">39</span>)   <span class="hljs-number">0.4377174174151864</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">66</span>)   <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">71</span>)   <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)    <span class="hljs-number">0.11096512610302138</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">6</span>)    <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">25</span>)   <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">45</span>)   <span class="hljs-number">0.14590580580506213</span>
  (<span class="hljs-number">0</span>, <span class="hljs-number">16</span>)   <span class="hljs-number">0.14590580580506213</span>
  : :
  (<span class="hljs-number">2</span>, <span class="hljs-number">64</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">56</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">46</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">15</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">30</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">54</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">14</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">21</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">59</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">62</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">60</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">52</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">26</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">18</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">55</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">63</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">61</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">50</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">5</span>)    <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">51</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">32</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">53</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">33</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">44</span>)   <span class="hljs-number">0.17221464824360078</span>
  (<span class="hljs-number">2</span>, <span class="hljs-number">41</span>)   <span class="hljs-number">0.17221464824360078</span>
â€‹
<span class="hljs-comment">--- ç¬¬ä¸€å¥è¯çš„TF-IDFå‘é‡ ---</span>
å¤§æ¶¨: <span class="hljs-number">0.4377</span>
æ“ä½œç³»ç»Ÿ: <span class="hljs-number">0.4377</span>
ä¸­å›½: <span class="hljs-number">0.2918</span>
æ¦‚å¿µè‚¡: <span class="hljs-number">0.2918</span>
</code></pre>
<p>æ•°å­¦çŸ¥è¯†ï¼š</p>
<p>æ•°å­¦é‡Œlogè¡¨ç¤ºå¯¹æ•°ã€‚ç®€å•ç†è§£ï¼Œlogâ‚‚8 = 3 å¯¹æ•°å°±æ˜¯3 åæ¨ 2çš„3æ¬¡æ–¹å°±æ˜¯8</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0f8b9365f793431e8b24e1c7372d2560~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP6ZSLamF2YTEyMzQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769783087&amp;x-signature=GlWT%2Bru8pTB63dsJgqO2YK5NIh8%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¼ºåŒ–å­¦ä¹ åŸºç¡€-é‡è¦æ€§é‡‡æ ·]]></title>    <link>https://juejin.cn/post/7598418891400560694</link>    <guid>https://juejin.cn/post/7598418891400560694</guid>    <pubDate>2026-01-23T15:38:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598418891400560694" data-draft-id="7598418891400544310" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¼ºåŒ–å­¦ä¹ åŸºç¡€-é‡è¦æ€§é‡‡æ ·"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-23T15:38:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”Ÿé”ˆçš„é”®ç›˜"/> <meta itemprop="url" content="https://juejin.cn/user/15838356199497"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¼ºåŒ–å­¦ä¹ åŸºç¡€-é‡è¦æ€§é‡‡æ ·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/15838356199497/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”Ÿé”ˆçš„é”®ç›˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T15:38:12.000Z" title="Fri Jan 23 2026 15:38:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä»€ä¹ˆæ˜¯é‡è¦æ€§é‡‡æ ·</h2>
<p>é‡è¦æ€§é‡‡æ ·æ˜¯ä¸€ç§æ•°å­¦å·¥å…·ï¼Œç”¨äºï¼šå½“ä½ æ— æ³•ä»ç›®æ ‡åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> ä¸­é‡‡æ ·æ—¶ï¼Œå¦‚ä½•é€šè¿‡å¦ä¸€ä¸ªåˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span> çš„æ ·æœ¬æ¥ä¼°ç®— <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> çš„æœŸæœ›å€¼ã€‚</p>
<p>â€¢ åœºæ™¯ï¼šä½ æƒ³çŸ¥é“æŸä¸ªéšæœºå˜é‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> åœ¨åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> ä¸‹çš„å¹³å‡å€¼ï¼ˆæœŸæœ› <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>P</mi></msub><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">E_{P}[f(x)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)]</span></span></span></span></span>ï¼‰ï¼Œä½†ä½ æ‰‹é‡Œåªæœ‰æ ¹æ®åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span> äº§ç”Ÿçš„æ•°æ®ã€‚</p>
<p>â€¢ åšæ³•ï¼šä½ åœ¨è®¡ç®—å¹³å‡å€¼æ—¶ï¼Œç»™æ¯ä¸ªæ ·æœ¬ä¹˜ä¸Šä¸€ä¸ªâ€œä¿®æ­£ç³»æ•°â€ï¼ˆå³é‡è¦æ€§æƒé‡ï¼‰ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>w</mi><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">w=\frac{P(x)}{Q(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span></div>
<blockquote>
<p>é‡è¦æ€§é‡‡æ ·ï¼ˆImportance Samplingï¼‰æœ¬è´¨ä¸Šä¸æ˜¯ä¸€ç§é‡‡æ ·æŠ€æœ¯ï¼Œè€Œæ˜¯ä¸€ç§ç»Ÿè®¡ä¼°ç®—æŠ€æœ¯ã€‚ å®ƒçš„æ ¸å¿ƒç›®çš„ä¸æ˜¯ä¸ºäº†è·å¾—ç›®æ ‡åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> çš„æ ·æœ¬ï¼Œè€Œæ˜¯ä¸ºäº†ä¼°ç®—å‡½æ•° <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> åœ¨è¯¥åˆ†å¸ƒä¸‹çš„æœŸæœ›å€¼ï¼Œç‰¹åˆ«æ˜¯å½“ç›´æ¥ä» <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> é‡‡æ ·æ•ˆç‡æä½æ—¶ã€‚Â </p>
</blockquote>
<p>å¦‚æœä¸€ä¸ªæ ·æœ¬åœ¨ç›®æ ‡åˆ†å¸ƒ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span>ä¸­å‡ºç°çš„æ¦‚ç‡å¾ˆé«˜ï¼Œä½†åœ¨ä½ å®é™…ç”¨çš„åˆ†å¸ƒ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span>ä¸­å‡ºç°æ¦‚ç‡å¾ˆä½ï¼Œé‚£ä¹ˆè¿™ä¸ªæ ·æœ¬å°±éå¸¸â€œç¨€æœ‰ä¸”é‡è¦â€ï¼Œé‡‡æ ·åˆ°å®ƒæ—¶ï¼Œä½ è¦ç»™å®ƒåŠ å¾ˆå¤§çš„æƒé‡ï¼›åä¹‹åˆ™å‡å°æƒé‡ã€‚</p>
<h2 data-id="heading-1">é‡è¦æ€§é‡‡æ ·çš„æœ¬è´¨</h2>
<blockquote>
<p>é‡è¦æ€§é‡‡æ ·ï¼ˆImportance Samplingï¼‰çš„æ ¸å¿ƒé€»è¾‘ç¡®å®å°±æ˜¯â€œåŠ æƒå¹³å‡â€æ±‚æœŸæœ›ã€‚</p>
</blockquote>
<h3 data-id="heading-2">1. ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥é‡‡ï¼Ÿï¼ˆç—›ç‚¹ï¼‰</h3>
<p>é€šå¸¸æˆ‘ä»¬æƒ³è®¡ç®—ä¸€ä¸ªå‡½æ•° <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> åœ¨æ¦‚ç‡åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> ä¸‹çš„æœŸæœ›ã€‚ä½†ç°å®ä¸­å¸¸é‡åˆ°ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<p>â€¢ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> å¾ˆéš¾ç›´æ¥é‡‡æ ·ï¼ˆæ¯”å¦‚åˆ†å¸ƒæå…¶å¤æ‚ï¼‰ã€‚</p>
<p>â€¢ æ ·æœ¬åˆ†å¸ƒä¸å‡ï¼šä½ æ„Ÿå…´è¶£çš„éƒ¨åˆ†ï¼ˆå¯¹ç»“æœè´¡çŒ®å¤§çš„éƒ¨åˆ†ï¼‰åœ¨ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> ä¸­æ¦‚ç‡æä½ï¼ˆç¨€æœ‰äº‹ä»¶ï¼‰ï¼Œç›´æ¥é‡‡æ ·å¯èƒ½é‡‡æ ·ä¸€ä¸‡æ¬¡éƒ½ç¢°ä¸åˆ°ä¸€æ¬¡ï¼Œå¯¼è‡´ç»“æœåå·®å·¨å¤§ã€‚</p>
<h3 data-id="heading-3">2. æ€ä¹ˆå˜é€šï¼Ÿï¼ˆé‡‡æ ·åˆ†å¸ƒçš„è½¬æ¢ï¼‰</h3>
<p>æ—¢ç„¶ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> ä¸å¥½é‡‡æ ·ï¼Œæˆ‘ä»¬å°±ä»ä¸€ä¸ªå¥½é‡‡æ ·çš„åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>ï¼ˆç§°ä¸º Proposal Distributionï¼‰ä¸­æå–æ ·æœ¬ã€‚ä½†å› ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> ä¸æ˜¯åŸåˆ†å¸ƒï¼Œç›´æ¥è®¡ç®—ç»“æœè‚¯å®šä¸å¯¹ï¼Œæ‰€ä»¥å¿…é¡»é€šè¿‡æ•°å­¦ä¸Šçš„â€œå˜å·â€æ¥ä¿®æ­£ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>E</mi><mi>p</mi></msub><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><mo>âˆ«</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi><mo>=</mo><mo>âˆ«</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mfrac><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi>d</mi><mi>x</mi><mo>=</mo><msub><mi>E</mi><mi>q</mi></msub><mrow><mo fence="true">[</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mfrac><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">E_{p}[f(x)]=\int f(x)p(x)dx=\int f(x)\frac{p(x)}{q(x)}q(x)dx=E_{q}\left[f(x)\frac{p(x)}{q(x)}\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)]</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.2222em;vertical-align:-0.8622em;"/><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">âˆ«</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"/><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">âˆ«</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></div>
<p>è¿™ä¸ªå…¬å¼å‘Šè¯‰æˆ‘ä»¬ï¼šå¦‚æœä½ æƒ³ç”¨æ—§æ•°æ®ç®—å‡ºæ–°ç­–ç•¥çš„å¾—åˆ†ï¼Œä½ å°±å¿…é¡»ç»™æ¯ä¸€ä¸ªå¥–åŠ±<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></span> ä¹˜ä¸Šè¿™ä¸ªæ¦‚ç‡æ¯”å€¼ã€‚</p>
<h3 data-id="heading-4">3. åŠ æƒçš„æœ¬è´¨ï¼ˆä¿®æ­£ï¼‰</h3>
<p>å…¬å¼ä¸­å¤šå‡ºæ¥çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">w(x)=\frac{p(x)}{q(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span>å°±æ˜¯ä½ æåˆ°çš„æƒé‡ï¼ˆImportance Weightï¼‰ã€‚</p>
<p>â€¢ å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)&gt;q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>ï¼šè¯´æ˜è¿™ä¸ªåŠ¨ä½œåœ¨æ–°ç­–ç•¥ä¸­å‘ç”Ÿçš„æ¦‚ç‡æ¯”æ—§ç­–ç•¥å¤§ã€‚ ç”±äºæˆ‘ä»¬åªæœ‰æ—§ç­–ç•¥é‡‡é›†åˆ°çš„æœ‰é™æ ·æœ¬ï¼Œä¸ºäº†æ¨¡æ‹Ÿæ–°ç­–ç•¥çš„æœŸæœ›æ”¶ç›Šï¼Œæˆ‘ä»¬éœ€è¦â€œæ”¾å¤§â€è¿™ä¸ªæ ·æœ¬çš„å½±å“åŠ›ï¼Œè¡¥å¿å®ƒåœ¨æ–°ç­–ç•¥ä¸­æœ¬åº”å‡ºç°ä½†å› é‡‡æ ·æºä¸åŒè€Œæ˜¾å¾—ä¸è¶³çš„é¢‘ç‡ã€‚</p>
<p>â€¢ å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)&lt;q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>ï¼š è¯´æ˜æ–°ç­–ç•¥å…¶å®ä¸å¤ªä¼šèµ°è¿™æ¡è·¯ã€‚å³ä½¿æ—§ç­–ç•¥é‡‡é›†äº†å¾ˆå¤šè¿™æ ·çš„æ•°æ®ï¼Œæˆ‘ä»¬åœ¨è®¡ç®—æ–°ç­–ç•¥çš„æ”¶ç›Šæ—¶ï¼Œä¹Ÿè¦æŠŠå®ƒä»¬çš„å½±å“åŠ›â€œç¼©å°â€ã€‚</p>
<p>é‡è¦æ€§é‡‡æ ·çš„é€»è¾‘å°±æ˜¯ï¼šç”¨ä¸€ä¸ªâ€œé”™â€çš„åˆ†å¸ƒå»é‡‡æ ·ï¼Œç„¶åé€šè¿‡â€œåŠ æƒâ€çš„æ–¹å¼æŠŠç»“æœæ‹‰å›åˆ°â€œå¯¹â€çš„æœŸæœ›ä¸Šã€‚</p>
<h2 data-id="heading-5">é‡è¦æ€§é‡‡æ ·çš„æœ¬è´¨ï¼ˆè§£è¯»ï¼‰</h2>
<p>æƒé‡å¤§äº 1 ä¸ä»£è¡¨æ ·æœ¬â€œæ›´å¥½â€ï¼Œè€Œä»£è¡¨è¿™ä¸ªæ ·æœ¬å¯¹æ–°ç­–ç•¥â€œæ›´é‡è¦â€æˆ–â€œæ›´æœ‰ä»£è¡¨æ€§â€ã€‚â€œå¥½åâ€æ˜¯ç”±å¥–åŠ±ï¼ˆRewardï¼‰å†³å®šçš„ï¼Œè€Œæƒé‡å†³å®šçš„æ˜¯å½±å“åŠ›ï¼ˆImpactï¼‰ã€‚</p>
<h3 data-id="heading-6">1. æƒé‡ &gt; 1 çš„çœŸå®å«ä¹‰</h3>
<p>åœ¨é‡è¦æ€§é‡‡æ ·ä¸­ï¼Œæƒé‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï</mi><mo>=</mo><mfrac><mrow><mi>Ï€</mi><mo stretchy="false">(</mo><mi>a</mi><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mo stretchy="false">)</mo></mrow><mrow><msub><mi>Ï€</mi><mi>Î²</mi></msub><mo stretchy="false">(</mo><mi>a</mi><mi mathvariant="normal">âˆ£</mi><mi>s</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\rho =\frac{\pi (a|s)}{\pi _{\beta }(a|s)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Ï</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.5581em;vertical-align:-0.5481em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">Ï€</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em;">Î²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2901em;"><span/></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">a</span><span class="mord mtight">âˆ£</span><span class="mord mathnormal mtight">s</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">Ï€</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">a</span><span class="mord mtight">âˆ£</span><span class="mord mathnormal mtight">s</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.5481em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span>ã€‚
â€¢ æƒé‡ &gt; 1ï¼š æ„å‘³ç€â€œæ–°ç­–ç•¥ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï€</mi></mrow><annotation encoding="application/x-tex">\pi </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span></span></span></span></span> æ¯”æ—§ç­–ç•¥æ›´å€¾å‘äºåšè¿™ä¸ªåŠ¨ä½œâ€ã€‚</p>
<p>â€¢ ä¾‹å­ï¼š å‡è®¾æ—§ç­–ç•¥åœ¨è·¯å£ 90% å¾€å·¦èµ°ï¼Œæ–°ç­–ç•¥ 90% å¾€å³èµ°ã€‚å½“ä½ æ‰‹é‡Œåªæœ‰æ—§æ•°æ®æ—¶ï¼Œå¾€å³èµ°çš„æ ·æœ¬éå¸¸ç¨€å°‘ã€‚ä¸ºäº†å‡†ç¡®è¯„ä¼°æ–°ç­–ç•¥ï¼Œç®—æ³•å¿…é¡»ç»™é‚£å‡ ä¸ªç½•è§çš„â€œå¾€å³èµ°â€çš„æ ·æœ¬ä¹˜ä¸Šä¸€ä¸ªå¾ˆå¤§çš„æƒé‡ï¼ˆè¡¥è¶³å®ƒä»¬åœ¨æ–°ç­–ç•¥åˆ†å¸ƒä¸­åº”æœ‰çš„å æ¯”ï¼‰ã€‚</p>
<h3 data-id="heading-7">2. æƒé‡ä¸å¥–åŠ±çš„ç»„åˆå†³å®šâ€œå¥½åâ€</h3>
<p>åˆ¤æ–­ä¸€ä¸ªåŠ¨ä½œæ˜¯å¦â€œå¥½â€ï¼Œè¦çœ‹æƒé‡Ã—å¥–åŠ±çš„ç»“æœï¼š</p>
<p>â€¢ æƒé‡ &gt; 1 ä¸” å¥–åŠ±ä¸ºæ­£ï¼š è¿™ä¸ªåŠ¨ä½œå¯¹æ–°ç­–ç•¥å¾ˆé‡è¦ï¼Œè€Œä¸”ç»“æœå¾ˆå¥½ã€‚æ¨¡å‹ä¼šå¤§å¹…å¢åŠ è¿™ä¸ªåŠ¨ä½œçš„æ¦‚ç‡ã€‚</p>
<p>â€¢ æƒé‡ &gt; 1 ä¸” å¥–åŠ±ä¸ºè´Ÿï¼š è¿™ä¸ªåŠ¨ä½œå¯¹æ–°ç­–ç•¥å¾ˆé‡è¦ï¼Œä½†ç»“æœå¾ˆç³Ÿã€‚æ¨¡å‹ä¼šå‰§çƒˆåœ°æƒ©ç½šè¿™ä¸ªåŠ¨ä½œï¼Œè®©æ–°ç­–ç•¥ä»¥ååˆ«è¿™ä¹ˆå¹²ã€‚</p>
<p>â€¢ ç»“è®ºï¼š æƒé‡åªæ˜¯ä¸€ä¸ªâ€œæ”¾å¤§å™¨â€ã€‚å®ƒå‘Šè¯‰æ¨¡å‹ï¼šâ€œå–‚ï¼æ–°ç­–ç•¥éå¸¸å…³æ³¨è¿™ç±»è¡Œä¸ºï¼Œä½ è¦çœ‹æ¸…æ¥šè¿™äº›è¡Œä¸ºå¸¦æ¥çš„åæœæ˜¯å¥–åŠ±è¿˜æ˜¯æƒ©ç½šï¼â€</p>
<blockquote>
<p>ä¸è¦æŠŠæƒé‡çœ‹ä½œâ€œå¥–çŠ¶â€ï¼Œè¦æŠŠå®ƒçœ‹ä½œâ€œå€ç‡â€ã€‚å®ƒä¸ä»£è¡¨æ ·æœ¬æœ¬èº«ä¼˜åŠ£ï¼Œåªä»£è¡¨åœ¨è®¡ç®—æ–°ç­–ç•¥å¾—åˆ†æ—¶ï¼Œè¿™ä¸ªæ ·æœ¬éœ€è¦è¢«æ”¾å¤§çš„ç¨‹åº¦ï¼Œä»¥çº æ­£é‡‡æ ·é€ æˆçš„åå·®**ã€‚</p>
</blockquote>
<h3 data-id="heading-8">3. ä¸ºä»€ä¹ˆæƒé‡å¤ªå¤§åè€Œâ€œä¸å¥½â€ï¼Ÿ</h3>
<p>åœ¨å®é™…è®­ç»ƒä¸­ï¼Œè¿‡å¤§çš„æƒé‡å¾€å¾€æ˜¯å±é™©çš„ï¼Œè€Œä¸æ˜¯å¥½äº‹ï¼š</p>
<p>â€¢ é«˜æ–¹å·®é£é™©ï¼š å¦‚æœæƒé‡å¾ˆå¤§ï¼ˆä¾‹å¦‚ 100ï¼‰ï¼Œè¯´æ˜æ–°æ—§ç­–ç•¥å·®å¼‚å·¨å¤§ã€‚è¿™æ—¶ä¸€ä¸ªå°æ¦‚ç‡æ ·æœ¬å°±èƒ½è®©æ¨¡å‹å‚æ•°äº§ç”Ÿå‰§çƒˆéœ‡è¡ï¼Œå¯¼è‡´è®­ç»ƒä¸ç¨³å®šã€‚</p>
<p>â€¢ ç®—æ³•é™åˆ¶ï¼š è‘—åçš„ PPO ç®—æ³• ä¼šå¼ºåˆ¶å°†æƒé‡è£å‰ªï¼ˆClipï¼‰åœ¨ 0.8 åˆ° 1.2 ä¹‹é—´ï¼Œå°±æ˜¯ä¸ºäº†é˜²æ­¢æƒé‡è¿‡å¤§å¯¼è‡´æ¨¡å‹â€œè·‘åâ€ã€‚</p>
<h2 data-id="heading-9">case1ï¼šä¼°ç®—å…¨æ ¡å­¦ç”Ÿçš„å¹³å‡èº«é«˜</h2>
<p>å‡è®¾ä½ æƒ³çŸ¥é“æŸæ‰€å¤§å­¦å…¨æ ¡å­¦ç”Ÿçš„å¹³å‡èº«é«˜ï¼Œä½†ä½ æ— æ³•è·å¾—å®Œæ•´çš„å­¦ç”Ÿåå•ã€‚Â </p>
<ol>
<li>
<p>ç›´æ¥é‡‡æ ·çš„å›°éš¾ï¼ˆç›®æ ‡åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span>ï¼‰ï¼šä½ æœ¬åº”è¯¥åœ¨æ ¡å›­é‡Œéšæœºæ‹¦æˆªå­¦ç”Ÿã€‚ä½†é—æ†¾çš„æ˜¯ï¼Œä½ åªæœ‰åœ¨ç¯®çƒé˜Ÿè®­ç»ƒé¦†é—¨å£æ‹¦æˆªå­¦ç”Ÿçš„æƒé™ã€‚</p>
</li>
<li>
<p>é€‰æ‹©å®¹æ˜“é‡‡æ ·çš„åˆ†å¸ƒï¼ˆæè®®åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span>ï¼‰ï¼šä½ åªèƒ½ä»ç¯®çƒé˜Ÿæˆå‘˜ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span> åˆ†å¸ƒï¼‰ä¸­é‡‡æ ·ã€‚æ˜¾ç„¶ï¼Œç¯®çƒé˜Ÿå‘˜çš„èº«é«˜æ™®éå¾ˆé«˜ï¼Œå¦‚æœä½ ç›´æ¥å–ä»–ä»¬çš„å¹³å‡å€¼ï¼Œç»“æœè‚¯å®šä¼šåé«˜ï¼ˆä¼°ç®—ä¸å‡†ï¼‰ã€‚</p>
</li>
<li>
<p>ä½¿ç”¨é‡è¦æ€§é‡‡æ ·è¿›è¡Œä¿®æ­£ï¼ˆæƒé‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span></span>ï¼‰ï¼šä¸ºäº†å¾—åˆ°å…¨æ ¡çš„çœŸå®å¹³å‡å€¼ï¼Œä½ åœ¨æµ‹é‡æ¯ä¸ªç¯®çƒé˜Ÿå‘˜æ—¶ï¼Œéœ€è¦ç»™ä»–ä»¬çš„èº«é«˜ä¹˜ä¸Šä¸€ä¸ªæƒé‡ï¼ˆä¿®æ­£ç³»æ•°ï¼‰ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>w</mi><mo>=</mo><mfrac><mtext>å…¨æ ¡å‡ºç°è¯¥èº«é«˜çš„æ¦‚ç‡</mtext><mtext>ç¯®çƒé˜Ÿå‡ºç°è¯¥èº«é«˜çš„æ¦‚ç‡</mtext></mfrac></mrow><annotation encoding="application/x-tex">w=\frac{å…¨æ ¡å‡ºç°è¯¥èº«é«˜çš„æ¦‚ç‡}{ç¯®çƒé˜Ÿå‡ºç°è¯¥èº«é«˜çš„æ¦‚ç‡}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord cjk_fallback">ç¯®çƒé˜Ÿå‡ºç°è¯¥èº«é«˜çš„æ¦‚ç‡</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord cjk_fallback">å…¨æ ¡å‡ºç°è¯¥èº«é«˜çš„æ¦‚ç‡</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span></div>
<p>â€¢ å¦‚æœä¸€ä¸ª 2 ç±³çš„äººåœ¨ç¯®çƒé˜Ÿé‡Œå¾ˆå¸¸è§ï¼Œä½†åœ¨å…¨æ ¡å¾ˆç½•è§ï¼Œä»–çš„æƒé‡å°±ä¼šå¾ˆä½ï¼ˆæ¯”å¦‚ 0.1ï¼‰ã€‚</p>
<p>â€¢ å¦‚æœä¸€ä¸ª 1.7 ç±³çš„äººåœ¨ç¯®çƒé˜Ÿé‡Œæå…¶ç½•è§ï¼Œä½†åœ¨å…¨æ ¡å…¶å®å¾ˆæ™®é€šï¼Œä»–çš„æƒé‡å°±ä¼šå¾ˆé«˜ï¼ˆæ¯”å¦‚ 10ï¼‰ã€‚</p>
</li>
<li>
<p>æœ€ç»ˆç»“æœï¼šå°†â€œç¯®çƒé˜Ÿå‘˜çš„èº«é«˜ Ã— å¯¹åº”çš„æƒé‡â€åŠ èµ·æ¥æ±‚å¹³å‡ã€‚è™½ç„¶ä½ åªé‡‡è®¿äº†ç¯®çƒé˜Ÿï¼Œä½†é€šè¿‡è¿™ä¸ªæƒé‡çš„ä¿®æ­£ï¼Œä½ ä¾ç„¶èƒ½æ¨ç®—å‡ºå…¨æ ¡å­¦ç”Ÿçš„çœŸå®å¹³å‡èº«é«˜ã€‚</p>
</li>
</ol>
<h2 data-id="heading-10">case2ï¼šä¼°ç®—ä¿é™©å…¬å¸èµ”ä»˜å¤§é¢ä¿å•çš„é£é™©</h2>
<p>å‡è®¾ä½ è¦è®¡ç®—æŸä¿é™©å…¬å¸æ˜å¹´èµ”ä»˜é‡‘é¢è¶…è¿‡ 10 äº¿å…ƒçš„æ¦‚ç‡ï¼ˆå³è®¡ç®—æœŸæœ›å€¼ï¼‰ã€‚Â </p>
<ol>
<li>ç›´æ¥è®¡ç®—çš„å›°å¢ƒï¼ˆç¨€æœ‰äº‹ä»¶ï¼‰ï¼š
åœ¨ç°å®ä¸­ï¼ˆç›®æ ‡åˆ†å¸ƒ (P)ï¼‰ï¼Œå‘ç”Ÿ 10 äº¿å…ƒèµ”å¿çš„æ¦‚ç‡æä½ï¼ˆæ¯”å¦‚ (0.0001%)ï¼‰ã€‚å¦‚æœä½ ç”¨æ™®é€šçš„è’™ç‰¹å¡æ´›æ–¹æ³•ï¼Œæ¨¡æ‹Ÿ 10 ä¸‡æ¬¡å¯èƒ½ä¸€æ¬¡å¤§é¢èµ”ä»˜éƒ½ä¸ä¼šå‘ç”Ÿã€‚è¿™æ ·ç®—å‡ºæ¥çš„æœŸæœ›å€¼è¯¯å·®æå¤§ï¼Œç”šè‡³å…¨æ˜¯ 0</li>
<li>æ”¹å˜â€œç©æ³•â€ï¼ˆæè®®åˆ†å¸ƒ (Q)ï¼‰ï¼š
æ—¢ç„¶ç›®æ ‡äº‹ä»¶å¤ªç½•è§ï¼Œæˆ‘ä»¬å°±äººä¸ºåœ°æé«˜å®ƒå‘ç”Ÿçš„æ¦‚ç‡ã€‚æˆ‘ä»¬æ„é€ ä¸€ä¸ªâ€œç¾éš¾æ¨¡æ‹Ÿå™¨â€ï¼ˆæè®®åˆ†å¸ƒ (Q)ï¼‰ï¼Œåœ¨è¿™ä¸ªæ¨¡æ‹Ÿå™¨é‡Œï¼Œåœ°éœ‡ã€æµ·å•¸ç­‰æç«¯ç¾å®³å‘ç”Ÿçš„é¢‘ç‡è¢«å¤§å¹…è°ƒé«˜ã€‚</li>
<li>é€šè¿‡æƒé‡â€œæ‹¨ä¹±åæ­£â€ï¼š
åœ¨æ¨¡æ‹Ÿå™¨é‡Œï¼Œä½ ç¡®å®å¾—åˆ°äº†å¾ˆå¤šå¤§é¢èµ”ä»˜çš„æ ·æœ¬ï¼Œä½†è¿™äº›æ ·æœ¬æ˜¯â€œè™šé«˜â€çš„ã€‚æ‰€ä»¥ï¼Œå¯¹äºæ¯ä¸€ä¸ªæ¨¡æ‹Ÿå‡ºçš„èµ”ä»˜é‡‘é¢ï¼Œä½ éƒ½éœ€è¦ä¹˜ä¸Šä¸€ä¸ªé‡è¦æ€§æƒé‡ (W)ï¼š</li>
</ol>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>W</mi><mo>=</mo><mfrac><mrow><mtext>çœŸå®ä¸–ç•Œå‘ç”Ÿçš„æ¦‚ç‡Â </mtext><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mtext>ç¾éš¾æ¨¡æ‹Ÿå™¨ä¸­å‘ç”Ÿçš„æ¦‚ç‡Â </mtext><mi>Q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">W=\frac{\text{çœŸå®ä¸–ç•Œå‘ç”Ÿçš„æ¦‚ç‡\ }P(x)}{\text{ç¾éš¾æ¨¡æ‹Ÿå™¨ä¸­å‘ç”Ÿçš„æ¦‚ç‡\ }Q(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord text"><span class="mord cjk_fallback">ç¾éš¾æ¨¡æ‹Ÿå™¨ä¸­å‘ç”Ÿçš„æ¦‚ç‡</span><span class="mord">Â </span></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord text"><span class="mord cjk_fallback">çœŸå®ä¸–ç•Œå‘ç”Ÿçš„æ¦‚ç‡</span><span class="mord">Â </span></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span></div>
<ol start="4">
<li>æœ€ç»ˆç›®çš„ï¼šä½ ç”¨æ¨¡æ‹Ÿå™¨é‡Œé¢‘ç¹å‡ºç°çš„æ ·æœ¬ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">x</span></span></span></span></span>ï¼Œä¹˜ä»¥è¿™ä¸ªå¾®å°çš„æƒé‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span></span>ï¼Œå°±èƒ½åœ¨è¾ƒå°‘çš„å°è¯•æ¬¡æ•°å†…ï¼Œéå¸¸ç²¾ç¡®åœ°ä¼°ç®—å‡ºçœŸå®ä¸–ç•Œä¸­é‚£ä¸ªæå°æ¦‚ç‡çš„æœŸæœ›å€¼ã€‚Â </li>
</ol>
<p>â€¢ ä½ ä¸æ˜¯æƒ³è¦Pçš„æ ·æœ¬ï¼ˆå› ä¸º Pçš„æ ·æœ¬**å¤§å¤šæ˜¯å¹³åº¸çš„é›¶æ˜Ÿç†èµ”ï¼Œå¯¹ä¼°ç®—æç«¯é£é™©æ²¡è´¡çŒ®ï¼‰ã€‚</p>
<p>â€¢ ä½ æƒ³è¦çš„æ˜¯å¯¹ä¼°ç®—ç»“æœè´¡çŒ®æœ€å¤§çš„æ ·æœ¬ï¼ˆå³ä¾¿å®ƒä»¬åœ¨ç°å®ä¸­å¾ˆå°‘è§ï¼‰ã€‚</p>
<p>â€¢ é‡è¦æ€§é‡‡æ ·å°±æ˜¯é€šè¿‡åœ¨â€œé‡è¦â€çš„åœ°æ–¹å¤šé‡‡æ ·ï¼Œå†é€šè¿‡æƒé‡è¿˜åŸï¼Œä»è€Œé«˜æ•ˆåœ°å®ŒæˆæœŸæœ›å€¼çš„ä¼°ç®—ã€‚</p>
<h2 data-id="heading-11">case3ï¼šè¯„ä¼°ä¸€ä¸ªæ–°çš„â€œçŸ­è§†é¢‘æ’åºç®—æ³•â€</h2>
<p>å‡è®¾ä½ æ˜¯ä¸€åç®—æ³•å·¥ç¨‹å¸ˆï¼Œå…¬å¸ç°åœ¨è¿è¡Œçš„æ˜¯ç®—æ³• Aï¼Œä½ æ–°å¼€å‘äº†ä¸€ä¸ªç®—æ³• Bã€‚ä½ æƒ³çŸ¥é“ï¼šå¦‚æœæ¢æˆç®—æ³• Bï¼Œç”¨æˆ·æ¯å¤©çš„è§‚çœ‹æ—¶é•¿ï¼ˆæœŸæœ›å€¼ï¼‰ä¼šå¢åŠ å—ï¼Ÿ</p>
<ol>
<li>ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥è®¡ç®—ï¼Ÿ
ä½ æ‰‹å¤´çš„æ•°æ®å…¨æ˜¯ç®—æ³• A äº§ç”Ÿçš„ã€‚</li>
</ol>
<p>â€¢ ç®—æ³• A å–œæ¬¢ç»™ç”¨æˆ·æ¨â€œæ–°é—»ç±»â€è§†é¢‘ã€‚</p>
<p>â€¢ ç®—æ³• B å€¾å‘äºç»™ç”¨æˆ·æ¨â€œç”Ÿæ´»ç™¾ç§‘ç±»â€è§†é¢‘ã€‚</p>
<p>â€¢ å› ä¸ºç®—æ³• A å¾ˆå°‘æ¨ç”Ÿæ´»ç±»è§†é¢‘ï¼Œæ‰€ä»¥ä½ çš„æ•°æ®åº“é‡Œå…³äºâ€œç”¨æˆ·çœ‹ç”Ÿæ´»ç±»è§†é¢‘ä¼šçœ‹å¤šä¹…â€çš„è®°å½•éå¸¸ç¨€ç–ã€‚å¦‚æœä½ ç›´æ¥ç”¨ç®—æ³• A çš„æ•°æ®æ¥ä¼°ç®—ç®—æ³• B çš„æ•ˆæœï¼Œç»“æœä¼šäº§ç”Ÿæå¤§çš„åå·®ï¼Œå› ä¸ºä¸¤ä¸ªç®—æ³•å…³æ³¨çš„è§†é¢‘ç±»å‹ï¼ˆåˆ†å¸ƒï¼‰å®Œå…¨ä¸åŒã€‚</p>
<ol start="2">
<li>
<p>å¼•å…¥é‡è¦æ€§é‡‡æ ·ï¼ˆæƒé‡ä¿®æ­£ï¼‰
æˆ‘ä»¬ä¸èƒ½ç›´æ¥æŠŠç®—æ³• A çš„å¹³å‡æ—¶é•¿å½“ä½œç®—æ³• B çš„é¢„æµ‹å€¼ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨é‡è¦æ€§é‡‡æ ·è¿›è¡Œâ€œæ•°æ®é‡åŠ æƒâ€ã€‚
å¯¹äºå†å²è®°å½•ä¸­çš„æ¯ä¸€æ¬¡æ¨èåŠ¨ä½œï¼Œæˆ‘ä»¬è®¡ç®—ä¸€ä¸ªé‡è¦æ€§æƒé‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span></span>ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>W</mi><mo>=</mo><mfrac><mrow><mtext>ç®—æ³•Â BÂ æ¨èè¿™ä¸ªè§†é¢‘çš„æ¦‚ç‡Â </mtext><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mtext>ç®—æ³•Â AÂ æ¨èè¿™ä¸ªè§†é¢‘çš„æ¦‚ç‡Â </mtext><mi>Q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">W=\frac{\text{ç®—æ³•\ B\ æ¨èè¿™ä¸ªè§†é¢‘çš„æ¦‚ç‡\ }P(x)}{\text{ç®—æ³•\ A\ æ¨èè¿™ä¸ªè§†é¢‘çš„æ¦‚ç‡\ }Q(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord text"><span class="mord cjk_fallback">ç®—æ³•</span><span class="mord">Â AÂ </span><span class="mord cjk_fallback">æ¨èè¿™ä¸ªè§†é¢‘çš„æ¦‚ç‡</span><span class="mord">Â </span></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord text"><span class="mord cjk_fallback">ç®—æ³•</span><span class="mord">Â BÂ </span><span class="mord cjk_fallback">æ¨èè¿™ä¸ªè§†é¢‘çš„æ¦‚ç‡</span><span class="mord">Â </span></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span></div>
<p>â€¢ æƒ…æ™¯ 1ï¼š å¦‚æœæŸä¸ªè§†é¢‘ç®—æ³• B éå¸¸æƒ³æ¨ï¼Œä½†ç®—æ³• A ä»¥å‰å¾ˆå°‘æ¨ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> å¤§ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span> å°ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªè§†é¢‘äº§ç”Ÿçš„è§‚çœ‹æ—¶é•¿å°±éå¸¸é‡è¦ï¼Œæˆ‘ä»¬è¦ç»™å®ƒåŠ æƒï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">W&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span>ï¼‰ï¼Œå› ä¸ºå®ƒä»£è¡¨äº†æ–°ç®—æ³•çš„ç‰¹æ€§ã€‚</p>
<p>â€¢ æƒ…æ™¯ 2ï¼š å¦‚æœæŸä¸ªè§†é¢‘ç®—æ³• A ç»å¸¸æ¨ï¼Œä½†ç®—æ³• B æ²¡å…´è¶£ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> å° <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span> å¤§ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°æ®å¯¹è¯„ä¼°ç®—æ³• B è´¡çŒ®å¾ˆå°ï¼Œæˆ‘ä»¬è¦é™ä½å®ƒçš„æƒé‡ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">W&lt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">1</span></span></span></span></span>ï¼‰ã€‚</p>
</li>
</ol>
<h2 data-id="heading-12">case4ï¼šè¯„ä¼°ä¸€ä¸ªâ€œæ–°ç®—æ³•â€çš„æ•ˆæœï¼ˆgeminiï¼‰</h2>
<p>å‡è®¾ä½ ç°åœ¨æ‰‹é‡Œæœ‰ä¸€ä¸ªæ–°ç®—æ³• Bï¼Œä½ æƒ³çŸ¥é“å¦‚æœæŠŠå®ƒä¸Šçº¿ï¼Œç”¨æˆ·çš„ç‚¹å‡»ç‡ï¼ˆCTRï¼‰ä¼šæ˜¯å¤šå°‘ã€‚</p>
<p>â€¢ ä¼ ç»Ÿåšæ³•ï¼ˆA/B Testï¼‰ï¼šç›´æ¥æŠŠ B åˆ†ç»™ 1% çš„ç”¨æˆ·ã€‚ä½†è¿™æ ·åšé£é™©å¾ˆé«˜ï¼Œå¦‚æœ B å¾ˆçƒ‚ï¼Œä¼šç›´æ¥æŸå¤±æ”¶å…¥ã€‚</p>
<p>â€¢ ç†æƒ³åšæ³•ï¼ˆçº¿ä¸‹è¯„ä¼°ï¼‰ï¼šåˆ©ç”¨å†å²æ—¥å¿—æ•°æ®ã€‚æ—¥å¿—é‡Œè®°å½•äº†è€ç®—æ³• A æ¨èäº†ä»€ä¹ˆï¼Œä»¥åŠç”¨æˆ·æ˜¯å¦ç‚¹å‡»äº†ã€‚</p>
<p>â€¢ æ ¸å¿ƒçŸ›ç›¾ï¼š</p>
<p>â€¢ è€ç®—æ³• A å–œæ¬¢æ¨èâ€œçƒ­é—¨ç”µå½±â€ã€‚</p>
<p>â€¢ æ–°ç®—æ³• B å–œæ¬¢æ¨èâ€œå°ä¼—ç”µå½±â€ã€‚</p>
<p>â€¢ å¦‚æœä½ ç›´æ¥ç”¨ A çš„æ—¥å¿—æ¥è¯„ä¼° Bï¼Œä½ ä¼šå‘ç° B æ¨èçš„å¾ˆå¤šå°ä¼—ç”µå½±åœ¨æ—¥å¿—é‡Œæ ¹æœ¬æ²¡å‡ºç°è¿‡ï¼ˆå› ä¸º A æ²¡æ¨èè¿‡ï¼‰ã€‚è¿™ç§ç”±äºé‡‡æ ·ç­–ç•¥ä¸åŒå¯¼è‡´çš„è¯„ä¼°åå·®ï¼Œå°±æ˜¯é‡è¦æ€§é‡‡æ ·çš„ç”¨æ­¦ä¹‹åœ°ã€‚</p>
<p>æˆ‘ä»¬æƒ³è®¡ç®—æ–°ç®—æ³• <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span> çš„é¢„æœŸç‚¹å‡»ç‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¼</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">\mu _{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>Î¼</mi><mi>B</mi></msub><mo>=</mo><msub><mi>E</mi><mrow><mi>x</mi><mo>âˆ¼</mo><msub><mi>Ï€</mi><mi>B</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>R</mi><mi>e</mi><mi>w</mi><mi>a</mi><mi>r</mi><mi>d</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mu _{B}=E_{x\sim \pi _{B}}[Reward(x)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.0003em;vertical-align:-0.2503em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">âˆ¼</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">Ï€</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span/></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2503em;"><span/></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)]</span></span></span></span></span></div>
<p>ä½†æˆ‘ä»¬åªæœ‰æ¥è‡ªç®—æ³• <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ï€</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">\pi _{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> çš„æ•°æ®ã€‚äºæ˜¯æˆ‘ä»¬åˆ©ç”¨é‡è¦æ€§é‡‡æ ·è¿›è¡Œè½¬æ¢ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>Î¼</mi><mi>B</mi></msub><mo>=</mo><munder><mo>âˆ‘</mo><mrow><mi>x</mi><mo>âˆˆ</mo><mtext>Logs</mtext></mrow></munder><mi>R</mi><mi>e</mi><mi>w</mi><mi>a</mi><mi>r</mi><mi>d</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>â‹…</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mtext>ç®—æ³•Bæ¨èx</mtext><mo stretchy="false">)</mo></mrow><mrow><mi>P</mi><mo stretchy="false">(</mo><mtext>ç®—æ³•Aæ¨èx</mtext><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\mu _{B}=\sum _{x\in \text{Logs}}Reward(x)\cdot \frac{P(\text{ç®—æ³•Bæ¨èx})}{P(\text{ç®—æ³•Aæ¨èx})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal">Î¼</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.4804em;vertical-align:-1.4304em;"/><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8557em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">âˆˆ</span><span class="mord text mtight"><span class="mord mtight">Logs</span></span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"/><span><span class="mop op-symbol large-op">âˆ‘</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.4304em;"><span/></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord text"><span class="mord cjk_fallback">ç®—æ³•</span><span class="mord">A</span><span class="mord cjk_fallback">æ¨è</span><span class="mord">x</span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord text"><span class="mord cjk_fallback">ç®—æ³•</span><span class="mord">B</span><span class="mord cjk_fallback">æ¨è</span><span class="mord">x</span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span></div>
<p>è¿™é‡Œçš„æƒé‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mfrac><mrow><msub><mi>P</mi><mi>B</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><msub><mi>P</mi><mi>A</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">w=\frac{P_{B}(x)}{P_{A}(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span/></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em;"><span/></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span> è¢«ç§°ä¸º ç¦»çº¿ç­–ç•¥è¯„ä¼° (Off-Policy Evaluation, OPE) çš„ä¿®æ­£ç³»æ•°ã€‚</p>
<h2 data-id="heading-13">case5ï¼šæ­£è´Ÿæ ·æœ¬ä¸å‡è¡¡</h2>
<p><code>æ­£è´Ÿæ ·æœ¬ä¸å‡è¡¡çš„æ—¶å€™ï¼Œè®­ç»ƒé›†ä¼šé€šè¿‡é™é‡‡æ ·çš„æ–¹å¼æ˜¯çš„æ­£è´Ÿæ ·æœ¬å‡è¡¡ï¼Œé‚£ä¹ˆè®­ç»ƒé›†çš„æ•°æ®åˆ†å¸ƒå’ŒçœŸå®çš„æ•°æ®åˆ†å¸ƒä¸å°±ä¸ä¸€è‡´äº†å—ï¼Œä½†æ˜¯æˆ‘ä»¬ä¾ç„¶å¯ä»¥è®­ç»ƒå‡ºä¸€ä¸ªæœ‰ç”¨çš„æ¨¡å‹ï¼Œè¿™ä¸å°±æ˜¯é‡è¦æ€§é‡‡æ ·çš„ç»“æœå—</code></p>
<blockquote>
<p>ç¦»çº¿ç­–ç•¥ï¼ˆOff-policyï¼‰çš„é€»è¾‘ï¼šç”¨ä¸€ä¸ªâ€œæ‰­æ›²â€è¿‡çš„åˆ†å¸ƒå»è®­ç»ƒï¼Œç›®æ ‡å´æ˜¯ä¸ºäº†åœ¨â€œçœŸå®â€åˆ†å¸ƒä¸Šè¡¨ç°è‰¯å¥½ã€‚</p>
</blockquote>
<h3 data-id="heading-14">1. ä¸ºä»€ä¹ˆâ€œåˆ†å¸ƒä¸ä¸€è‡´â€åè€Œèƒ½è®­ç»ƒå‡ºå¥½æ¨¡å‹ï¼Ÿ</h3>
<p>åœ¨çœŸå®åˆ†å¸ƒä¸­ï¼Œå°‘æ•°ç±»ï¼ˆå¦‚æ¬ºè¯ˆäº¤æ˜“ã€ç½•è§ç—…ï¼‰çš„æ ·æœ¬æå…¶ç¨€å°‘ã€‚</p>
<p>â€¢ å¦‚æœä¸é™é‡‡æ ·ï¼šå°‘æ•°ç±»åœ¨æ€»æŸå¤±å‡½æ•°ï¼ˆLossï¼‰ä¸­çš„è´¡çŒ®å¾®ä¹å…¶å¾®ã€‚æ¨¡å‹ä¸ºäº†è¿½æ±‚æ•´ä½“å‡†ç¡®ç‡ï¼Œä¼šâ€œå·æ‡’â€æŠŠæ‰€æœ‰æ ·æœ¬éƒ½é¢„æµ‹ä¸ºå¤šæ•°ç±»ã€‚è¿™æœ¬è´¨ä¸Šæ˜¯é‡‡æ ·ä¿¡å·å¤ªå¼±ï¼Œå¯¼è‡´æ¨¡å‹æ— æ³•æå–å°‘æ•°ç±»çš„ç‰¹å¾ã€‚</p>
<p>â€¢ é™é‡‡æ ·ä¹‹åï¼šä½ äººä¸ºæé«˜äº†å°‘æ•°ç±»åœ¨è®­ç»ƒé›†ä¸­çš„å‡ºç°é¢‘ç‡ã€‚è¿™è¿«ä½¿æ¨¡å‹åœ¨æ›´æ–°å‚æ•°æ—¶ï¼Œå¿…é¡»è®¤çœŸå¯¹å¾…å°‘æ•°ç±»çš„ç‰¹å¾ï¼Œå¦åˆ™ Loss å°±é™ä¸ä¸‹æ¥ã€‚</p>
<h3 data-id="heading-15">2. è¿™é‡Œçš„â€œé‡è¦æ€§é‡‡æ ·â€ä½“ç°åœ¨å“ªé‡Œï¼Ÿ</h3>
<p>å½“ä½ é€šè¿‡é™é‡‡æ ·ï¼ˆæˆ–è¿‡é‡‡æ ·ï¼‰ä½¿æ ·æœ¬å‡è¡¡æ—¶ï¼Œä½ å®é™…ä¸Šæ˜¯æŠŠè®­ç»ƒé›†ä»çœŸå®åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>r</mi><mi>e</mi><mi>a</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{real}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">re</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> è½¬æ¢åˆ°äº† äººå·¥åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{train}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">ain</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ã€‚Â 
å¦‚æœè¦ä¿è¯æ•°å­¦ä¸Šçš„ä¸¥æ ¼æ— åï¼Œä½ åœ¨è®¡ç®—æŸå¤±å‡½æ•°ï¼ˆæ›´æ–°æƒé‡ï¼‰æ—¶ï¼Œç†è®ºä¸Šåº”è¯¥å¼•å…¥é‡è¦æ€§æƒé‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï</mi></mrow><annotation encoding="application/x-tex">\rho </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Ï</span></span></span></span></span>ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï</mi><mo>=</mo><mfrac><mrow><msub><mi>P</mi><mrow><mi>r</mi><mi>e</mi><mi>a</mi><mi>l</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><msub><mi>P</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\rho =\frac{P_{real}(x)}{P_{train}(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Ï</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">ain</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span/></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">re</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span/></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span>å¯¹äºè¢«ä½ å¤§é‡åˆ é™¤çš„å¤šæ•°ç±»æ ·æœ¬ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï</mi></mrow><annotation encoding="application/x-tex">\rho </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Ï</span></span></span></span></span> åº”è¯¥å¾ˆå¤§ï¼ˆè¡¥å¿å®ƒä»¬è¢«åˆ æ‰çš„æ•°é‡ï¼‰ã€‚å¯¹äºè¢«ä½ ä¿ç•™æˆ–é‡å¤çš„å°‘æ•°ç±»æ ·æœ¬ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï</mi></mrow><annotation encoding="application/x-tex">\rho </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Ï</span></span></span></span></span> åº”è¯¥å¾ˆå°ã€‚Â ä½†æ˜¯ï¼Œå®é™…æ“ä½œä¸­æˆ‘ä»¬å¾€å¾€â€œæ•…æ„â€ä¸å®Œå…¨éµå¾ªè¿™ä¸ªæ¯”ç‡ã€‚</p>
<h3 data-id="heading-16">3. ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥â€œè¿èƒŒâ€é‡è¦æ€§é‡‡æ ·çš„ä¸¥æ ¼æ¯”ä¾‹ï¼Ÿ</h3>
<p>åœ¨å¾ˆå¤šåˆ†ç±»ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸è¿½æ±‚æ¦‚ç‡å€¼çš„ç»å¯¹å‡†ç¡®ï¼ˆCalibrationï¼‰ï¼Œè€Œæ˜¯è¿½æ±‚åˆ†ç±»è¾¹ç•Œï¼ˆDecision Boundaryï¼‰çš„å‡†ç¡®ã€‚</p>
<p>â€¢ ä¿®æ­£åå·® vs å¼ºåŒ–ç‰¹å¾ï¼šä¸¥æ ¼çš„é‡è¦æ€§é‡‡æ ·æ˜¯ä¸ºäº†æ¶ˆé™¤åå·®ï¼ˆè®©æ¨¡å‹é¢„æµ‹çš„æ¦‚ç‡ç¬¦åˆçœŸå®é¢‘ç‡ï¼‰ã€‚ä½†åœ¨ç±»åˆ«ä¸å¹³è¡¡æ—¶ï¼Œæˆ‘ä»¬çš„é¦–è¦çŸ›ç›¾æ˜¯å°‘æ•°ç±»ç‰¹å¾å­¦ä¹ ä¸è¶³ã€‚</p>
<p>â€¢ æœ‰åä¼°è®¡çš„ä»·å€¼ï¼šé€šè¿‡é™é‡‡æ ·ä½†ä¸å®Œå…¨æŒ‰ç…§<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Ï</span></span></span></span></span>è¿˜åŸæƒé‡ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨åšä¸€ä¸ªæœ‰åä¼°è®¡ã€‚è¿™ä¸ªâ€œåè§â€æ˜¯ï¼šæˆ‘ä»¬å®æ„¿æ¨¡å‹å¯¹å¤šæ•°ç±»æœ‰ä¸€ç‚¹è¯¯åˆ¤ï¼Œä¹Ÿç»ä¸èƒ½æ¼æ‰å°‘æ•°ç±»ã€‚</p>
<h3 data-id="heading-17">4. ä»€ä¹ˆæ—¶å€™å¿…é¡»æŠŠâ€œé‡è¦æ€§é‡‡æ ·â€çš„å½±å­æ‰¾å›æ¥ï¼Ÿ</h3>
<p>å¦‚æœä½ çš„ä»»åŠ¡å¯¹æ¦‚ç‡é¢„æµ‹çš„ç»å¯¹å€¼éå¸¸æ•æ„Ÿï¼ˆä¾‹å¦‚å¹¿å‘Šç‚¹å‡»ç‡é¢„æµ‹ CTRï¼Œéœ€è¦è®¡ç®—ç²¾ç¡®çš„ ROIï¼‰ï¼Œé‚£ä¹ˆé™é‡‡æ ·åå¿…é¡»è¿›è¡Œæ¦‚ç‡æ ¡å‡†ï¼ˆCalibrationï¼‰ã€‚</p>
<p>æ ¡å‡†å…¬å¼ï¼ˆå¯¹åº”é€»è¾‘å›å½’ï¼‰å°±æ˜¯é‡è¦æ€§é‡‡æ ·çš„ç›´æ¥åº”ç”¨ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><msub><mi>t</mi><mtext>æ ¡å‡†</mtext></msub><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><msub><mi>t</mi><mtext>æ¨¡å‹</mtext></msub><mo>+</mo><mi>log</mi><mo>â¡</mo><mo stretchy="false">(</mo><mfrac><mtext>æ­£æ ·æœ¬ä¸‹é‡‡æ ·ç‡</mtext><mtext>è´Ÿæ ·æœ¬ä¸‹é‡‡æ ·ç‡</mtext></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">logit_{æ ¡å‡†}=logit_{æ¨¡å‹}+\log (\frac{\text{æ­£æ ·æœ¬ä¸‹é‡‡æ ·ç‡}}{\text{è´Ÿæ ·æœ¬ä¸‹é‡‡æ ·ç‡}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">æ ¡å‡†</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">æ¨¡å‹</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:2.0463em;vertical-align:-0.686em;"/><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord text"><span class="mord cjk_fallback">è´Ÿæ ·æœ¬ä¸‹é‡‡æ ·ç‡</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord text"><span class="mord cjk_fallback">æ­£æ ·æœ¬ä¸‹é‡‡æ ·ç‡</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mclose">)</span></span></span></span></span></div>
<p>è¿™ä¸ªä¿®æ­£é¡¹ï¼Œå°±æ˜¯ä¸ºäº†è¡¥å¿è®­ç»ƒé›†å’ŒçœŸå®åˆ†å¸ƒä¹‹é—´ä¸ä¸€è‡´çš„é‚£ä¸ªâ€œå½±å­â€ã€‚</p>
<h3 data-id="heading-18">æ€»ç»“</h3>
<p>â€¢ åˆ†å¸ƒæ”¹å˜çš„è¡¥å¿ï¼šå½“å¯¹å¤šæ•°ç±»è¿›è¡Œé™é‡‡æ ·æ—¶ï¼Œè®­ç»ƒé›†ä¸­å¤šæ•°ç±»çš„æ¦‚ç‡åˆ†å¸ƒå°±è¢«äººä¸ºåœ°æ”¹å˜äº†ã€‚å¦‚æœç›´æ¥åœ¨è¿™ä¸ªåˆ†å¸ƒä¸Šè®­ç»ƒï¼Œæ¨¡å‹ä¼šä½ä¼°å¤šæ•°ç±»çš„çœŸå®é‡è¦æ€§ã€‚è¿™æ—¶ï¼Œç»™é™é‡‡æ ·åçš„æ ·æœ¬èµ‹äºˆæƒé‡ï¼ˆä¾‹å¦‚ï¼Œé™é‡‡æ ·10å€ï¼Œåˆ™æƒé‡è®¾ä¸º10ï¼‰ï¼Œæ­£æ˜¯åœ¨è¡¥å¿è¿™ç§åˆ†å¸ƒå·®å¼‚ã€‚è¿™ä¸ªæƒé‡å¯ä»¥è¢«ç†è§£ä¸ºé‡è¦æ€§æƒé‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w(x)=p(x)/q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>çš„ä¸€ç§å®è·µï¼Œå…¶ä¸­ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>æ˜¯çœŸå®åˆ†å¸ƒï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>æ˜¯é™é‡‡æ ·åçš„åˆ†å¸ƒã€‚</p>
<p>â€¢ ç›®æ ‡çš„ä¸€è‡´æ€§ï¼šæ— è®ºæ˜¯é‡è¦æ€§é‡‡æ ·è¿˜æ˜¯è¿™é‡Œçš„é™é‡‡æ ·åŠ æƒï¼Œæœ€ç»ˆç›®çš„éƒ½ä¸æ˜¯è®©æ¨¡å‹å­¦ä¹ â€œè®­ç»ƒé›†åˆ†å¸ƒâ€ï¼Œè€Œæ˜¯å¸Œæœ›æ¨¡å‹èƒ½åœ¨â€œæˆ‘ä»¬å…³å¿ƒçš„åˆ†å¸ƒâ€ï¼ˆé€šå¸¸æ˜¯çœŸå®åˆ†å¸ƒæˆ–å‡åŒ€åˆ†å¸ƒï¼‰ä¸Šè¡¨ç°è‰¯å¥½ã€‚é€šè¿‡åŠ æƒï¼Œæˆ‘ä»¬ä½¿å¾—æ¨¡å‹åœ¨è®­ç»ƒæ—¶ï¼ˆåŸºäº<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>ï¼‰çš„æ¢¯åº¦æ›´æ–°æˆ–æŸå¤±è®¡ç®—ï¼Œä¸æˆ‘ä»¬æœ€ç»ˆçš„è¯„ä»·ç›®æ ‡ï¼ˆåŸºäº<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>ï¼‰ä¿æŒä¸€è‡´</p>
<h2 data-id="heading-19">case6: æ­£è´Ÿæ ·æœ¬ä¸å‡è¡¡ï¼ˆgeminiï¼‰</h2>
<p>åœ¨å¤„ç†æ­£è´Ÿæ ·æœ¬ä¸å‡åŒ€ï¼ˆç±»åˆ«ä¸å¹³è¡¡ï¼‰é—®é¢˜æ—¶ï¼Œé‡è¦æ€§é‡‡æ ·ï¼ˆImportance Sampling, ISï¼‰ç¡®å®æ˜¯æ ¸å¿ƒçš„åº•å±‚é€»è¾‘ä¹‹ä¸€ï¼Œä½†å…¶è¡¨ç°å½¢å¼é€šå¸¸è¢«ç§°ä¸ºé‡é‡‡æ ·ï¼ˆResamplingï¼‰æˆ–ä»£ä»·æ•æ„Ÿå­¦ä¹ ï¼ˆCost-Sensitive Learning)ã€‚</p>
<h3 data-id="heading-20">1. é€»è¾‘è½¬åŒ–ï¼šä»â€œé‡‡æ ·â€åˆ°â€œæƒé‡â€</h3>
<p>å¤„ç†æ ·æœ¬ä¸å‡åŒ€æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸é¢ä¸´ä¸¤ä¸ªåˆ†å¸ƒï¼š</p>
<p>â€¢ è®­ç»ƒé›†åˆ†å¸ƒï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">b</span></span></span></span></span>ï¼‰ï¼šè´Ÿæ ·æœ¬æå¤šï¼Œæ­£æ ·æœ¬æå°‘ï¼ˆä¾‹å¦‚ 99:1ï¼‰ã€‚</p>
<p>â€¢ ç†æƒ³æµ‹è¯•åˆ†å¸ƒï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï€</mi></mrow><annotation encoding="application/x-tex">\pi </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span></span></span></span></span>ï¼‰ï¼šæˆ‘ä»¬å¸Œæœ›æ¨¡å‹åœ¨æ­£è´Ÿç±»åˆ«ä¸Šè¡¨ç°åŒæ ·å‡ºè‰²ï¼ˆä¾‹å¦‚ 50:50ï¼‰ã€‚Â </p>
<p>ä¸ºäº†è®©æ¨¡å‹åœ¨åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">b</span></span></span></span></span> ä¸Šè®­ç»ƒï¼Œå´èƒ½è¾¾åˆ°åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï€</mi></mrow><annotation encoding="application/x-tex">\pi </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">Ï€</span></span></span></span></span> çš„æ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥é‡è¦æ€§æƒé‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï</mi></mrow><annotation encoding="application/x-tex">\rho </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Ï</span></span></span></span></span>ã€‚</p>
<h3 data-id="heading-21">2. ä¸¤ç§å…·ä½“çš„åº”ç”¨å½¢æ€</h3>
<h4 data-id="heading-22">A. è¿‡é‡‡æ ·/æ¬ é‡‡æ ·ï¼ˆé‡‡æ ·å±‚é¢ï¼‰</h4>
<p>è¿™æ˜¯ IS çš„éšæœºå®ç°ç‰ˆæœ¬ã€‚</p>
<p>â€¢ å½“ä½ å¯¹å°‘æ•°ç±»è¿›è¡Œè¿‡é‡‡æ ·ï¼ˆOver-samplingï¼‰æˆ–å¯¹å¤šæ•°ç±»è¿›è¡Œæ¬ é‡‡æ ·ï¼ˆUnder-samplingï¼‰æ—¶ï¼Œä½ å®é™…ä¸Šæ˜¯åœ¨æ‰‹åŠ¨æ„é€ ä¸€ä¸ªæ–°çš„é‡‡æ ·åˆ†å¸ƒã€‚</p>
<p>â€¢ è¿™ç§åšæ³•é€šè¿‡æ”¹å˜æ ·æœ¬å‡ºç°çš„é¢‘ç‡ï¼Œéšå¼åœ°å®ç°äº†é‡è¦æ€§æ¯”ç‡çš„è°ƒæ•´ã€‚</p>
<h4 data-id="heading-23">B. ä»£ä»·æ•æ„ŸæŸå¤±ï¼ˆæ›´æ–°å±‚é¢ï¼‰</h4>
<p>è¿™æ˜¯ IS çš„æ•°å­¦ä¿®æ­£ç‰ˆæœ¬ï¼Œåœ¨ç¥ç»ç½‘ç»œä¸­æ›´ä¸ºå¸¸ç”¨ã€‚</p>
<p>â€¢ æ“ä½œï¼šåœ¨è®¡ç®—æŸå¤±å‡½æ•°æ—¶ï¼Œç»™å°‘æ•°ç±»æ ·æœ¬ä¹˜ä»¥ä¸€ä¸ªå¤§çš„æƒé‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{pos}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">os</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>ï¼Œç»™å¤šæ•°ç±»æ ·æœ¬ä¹˜ä»¥ä¸€ä¸ªå°çš„æƒé‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>n</mi><mi>e</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{neg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span></span></span></span></span>ã€‚</p>
<p>â€¢ æ•°å­¦æœ¬è´¨ï¼šè¿™ä¸ªæƒé‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span></span> å¯¹åº”äºé‡è¦æ€§æ¯”ç‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï</mi><mo>=</mo><mfrac><msub><mi>P</mi><mrow><mi>t</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>t</mi></mrow></msub><msub><mi>P</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi><mi>e</mi><mi>r</mi><mi>v</mi><mi>e</mi><mi>d</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">\rho =\frac{P_{target}}{P_{observed}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Ï</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.4365em;vertical-align:-0.4509em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9857em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3488em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">ser</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em;"><span/></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.5073em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2963em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span/></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.4509em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span>ã€‚</p>
<p>æ•ˆæœï¼šè¿™ä½¿å¾—åœ¨åå‘ä¼ æ’­æ›´æ–°å‚æ•°æ—¶ï¼Œå°‘æ•°ç±»çš„ä¸€ä¸ªæ ·æœ¬äº§ç”Ÿçš„æ¢¯åº¦ä¼šè¢«æ”¾å¤§ï¼Œä»è€Œåœ¨æƒå€¼æ›´æ–°ä¸­å æ®æ›´é‡è¦çš„åœ°ä½ï¼Œè¿™ä¸å¼ºåŒ–å­¦ä¹ ä¸­ä½¿ç”¨<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Ï</span></span></span></span></span>ä¿®æ­£ç­–ç•¥åå·®çš„é€»è¾‘å®Œå…¨ä¸€è‡´ã€‚</p>
<blockquote>
<p>ä»»ä½•é€šè¿‡åŠ æƒæŸå¤±å‡½æ•°ï¼ˆWeighted Lossï¼‰æˆ–æœ‰åé‡‡æ ·æ¥å¤„ç†ä¸å¹³è¡¡æ•°æ®çš„æ‰‹æ®µï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯é‡è¦æ€§é‡‡æ ·æ€æƒ³çš„å®è·µ</p>
</blockquote>
<h2 data-id="heading-24">case7: AdaBoostç®—æ³•</h2>
<p>åœ¨ AdaBoost ä¸­ï¼Œé‡è¦æ€§é‡‡æ ·ï¼ˆImportance Samplingï¼‰çš„æ€æƒ³åŒæ ·æ˜¯å…¶æ ¸å¿ƒåŸºçŸ³ï¼Œä½†å®ƒçš„åº”ç”¨æ–¹å¼æ¯”ç®€å•çš„é™é‡‡æ ·æ›´å…·åŠ¨æ€æ€§å’Œè¿›åŒ–æ€§ã€‚</p>
<h3 data-id="heading-25">1. åŠ¨æ€çš„â€œè¡Œä¸ºç­–ç•¥â€ï¼šæ ·æœ¬æƒé‡çš„æœ¬è´¨</h3>
<p>åœ¨å¼ºåŒ–å­¦ä¹ ä¸­ï¼Œè¡Œä¸ºç­–ç•¥ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">b</span></span></span></span></span> é€šå¸¸æ˜¯å›ºå®šçš„æˆ–ç¼“æ…¢å˜åŒ–çš„ã€‚è€Œåœ¨ AdaBoost ä¸­ï¼Œæ¯ä¸€è½®è¿­ä»£éƒ½åœ¨äº§ç”Ÿä¸€ä¸ªæ–°çš„â€œè¡Œä¸ºåˆ†å¸ƒâ€ï¼šÂ </p>
<p>â€¢ è®­ç»ƒè¿‡ç¨‹ï¼šAdaBoost å¹¶ä¸ç›´æ¥æ”¹å˜åŸå§‹æ•°æ®é›†ï¼Œè€Œæ˜¯ç»™æ¯ä¸ªæ ·æœ¬åˆ†é…ä¸€ä¸ªæƒé‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ã€‚</p>
<p>â€¢ IS è§†è§’ï¼šè¿™ä¸ªæƒé‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> æœ¬è´¨ä¸Šå°±æ˜¯é‡è¦æ€§æƒé‡ã€‚å®ƒå®šä¹‰äº†ä¸€ä¸ªæ–°çš„æ¦‚ç‡åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">D_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ã€‚å½“ç®—æ³•è¿›å…¥ä¸‹ä¸€è½®æ—¶ï¼Œå¼±å­¦ä¹ å™¨æ˜¯åœ¨åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">D_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> ä¸Šè¿›è¡Œä¼˜åŒ–çš„ï¼Œè€Œä¸æ˜¯åœ¨åŸå§‹çš„å‡åŒ€åˆ†å¸ƒä¸Šã€‚</p>
<p>â€¢ ä¸ºä»€ä¹ˆè¦å˜ï¼Ÿï¼šç®—æ³•æ•…æ„è°ƒé«˜é‚£äº›â€œè¢«å‰ä¸€ä¸ªæ¨¡å‹åˆ†ç±»é”™è¯¯â€çš„æ ·æœ¬æƒé‡ã€‚ä»é‡è¦æ€§é‡‡æ ·çš„è§’åº¦çœ‹ï¼Œè¿™æ˜¯ä¸ºäº†å¼ºè¿«æ¨¡å‹å»é‡‡æ ·é‚£äº›å½“å‰æœ€å…·æœ‰â€œä¿¡æ¯é‡â€çš„æ ·æœ¬ã€‚</p>
<h3 data-id="heading-26">2. é‡é‡‡æ ·ï¼ˆResamplingï¼‰ vs. é‡åŠ æƒï¼ˆReweightingï¼‰</h3>
<p>AdaBoost çš„å®ç°æœ‰ä¸¤ç§æ–¹å¼ï¼Œå…¶ä¸­ä¸€ç§ç›´æ¥å°±æ˜¯é‡è¦æ€§é‡‡æ ·çš„æ ‡å‡†æµç¨‹ï¼š</p>
<p>â€¢ é‡åŠ æƒï¼ˆReweightingï¼‰ï¼šç›´æ¥æŠŠæƒé‡ **<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ä¸¢è¿›æŸå¤±å‡½æ•°é‡Œã€‚è¿™ç­‰åŒäºåœ¨æ›´æ–°æ¨¡å‹æ—¶ï¼Œé€šè¿‡æƒé‡æ¥ä¿®æ­£ä¸åŒæ ·æœ¬å¯¹æ¢¯åº¦çš„è´¡çŒ®ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬åœ¨ç¦»çº¿ç­–ç•¥ï¼ˆOff-policyï¼‰æ›´æ–°ä¸­çœ‹åˆ°çš„æ“ä½œã€‚</p>
<p>â€¢ é‡é‡‡æ ·ï¼ˆResamplingï¼‰ï¼šå¦‚æœå¼±å­¦ä¹ å™¨ï¼ˆæ¯”å¦‚æŸäº›ç®€å•çš„å†³ç­–æ ‘å®ç°ï¼‰æ— æ³•å¤„ç†æ ·æœ¬æƒé‡ï¼ŒAdaBoost ä¼šæ ¹æ®æƒé‡åˆ†å¸ƒ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">D_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>å¯¹åŸå§‹æ•°æ®è¿›è¡Œæœ‰æ”¾å›çš„éšæœºé‡‡æ ·ã€‚</p>
<p>â€¢ æƒé‡å¤§çš„æ ·æœ¬ï¼ˆéš¾é¢˜ï¼‰ä¼šè¢«å¤šæ¬¡æŠ½åˆ°ã€‚</p>
<p>â€¢ æƒé‡å°çš„æ ·æœ¬ï¼ˆæ˜“é¢˜ï¼‰å¯èƒ½ä¸è¢«æŠ½åˆ°ã€‚</p>
<p>â€¢ ç»“è®ºï¼šè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯æ ‡å‡†çš„é‡è¦æ€§é‡‡æ ·å®ç°â€”â€”é€šè¿‡æ”¹å˜é‡‡æ ·é¢‘ç‡ï¼Œå°†ä¸€ä¸ªåˆ†å¸ƒä¸‹çš„é—®é¢˜è½¬åŒ–ä¸ºå¦ä¸€ä¸ªåˆ†å¸ƒä¸‹çš„è®­ç»ƒä»»åŠ¡ã€‚</p>
<h4 data-id="heading-27">ç†è®ºå±‚é¢çš„è”ç³»ï¼šIS è§†è§’ä¸‹çš„ AdaBoost</h4>
<p>ä»ç»Ÿè®¡å­¦è§’åº¦çœ‹ï¼ŒAdaBoost çš„æˆåŠŸå¯ä»¥ç”¨é‡è¦æ€§é‡‡æ ·è§†è§’æ¥è§£é‡Šï¼š</p>
<p>â€¢ æœ¬è´¨æ˜¯å¯»æ‰¾â€œå›°éš¾æ ·æœ¬â€ï¼šAdaBoost æ¯ä¸€è½®éƒ½åœ¨è°ƒæ•´æ ·æœ¬æƒé‡ã€‚ä» IS çš„è§†è§’çœ‹ï¼Œå®ƒæ˜¯åœ¨ä¸æ–­æ„é€ ä¸€ä¸ªæ–°çš„â€œå»ºè®®åˆ†å¸ƒâ€ï¼Œè¿™ä¸ªåˆ†å¸ƒå°†æ³¨æ„åŠ›é›†ä¸­åœ¨æ¨¡å‹è¡¨ç°æœ€å·®çš„åŒºåŸŸï¼ˆå³é‡è¦æ€§æ›´é«˜çš„åŒºåŸŸï¼‰ã€‚</p>
<p>â€¢ æƒé‡çš„æ•°å­¦æ„ä¹‰ï¼šAdaBoost çš„æ ·æœ¬æƒé‡<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> å¯ä»¥è¢«è§†ä¸ºç›®æ ‡åˆ†å¸ƒï¼ˆæˆ‘ä»¬å¸Œæœ›æ¨¡å‹æŒæ¡çš„åˆ†å¸ƒï¼‰ä¸å½“å‰æ¨¡å‹å·²æŒæ¡åˆ†å¸ƒä¹‹é—´çš„é‡è¦æ€§æ¯”ç‡ï¼ˆImportance Ratioï¼‰ã€‚é€šè¿‡ä¸æ–­å¢åŠ é”™é¢˜çš„æƒé‡ï¼Œç®—æ³•å¼ºåˆ¶åç»­çš„å­¦ä¹ å™¨å»â€œé‡‡æ ·â€å¹¶è§£å†³è¿™äº›é«˜éš¾åº¦çš„æ¡ˆä¾‹ã€‚</p>
<h4 data-id="heading-28">æ€»ç»“ï¼šAdaBoost æ˜¯â€œè‡ªåŠ¨åŒ–çš„ã€å¤šè½®æ¬¡â€çš„é‡è¦æ€§é‡‡æ ·</h4>
<p>â€¢ ç¦»çº¿ç­–ç•¥ RLï¼šæ˜¯ä¸ºäº†ä¿®æ­£â€œå‰äººçš„æ•°æ®â€å’Œâ€œæˆ‘çš„ç›®æ ‡â€ä¹‹é—´çš„å·®å¼‚ï¼ˆä¸€æ¬¡ä¿®æ­£ï¼‰ã€‚</p>
<p>â€¢ æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡ï¼šæ˜¯ä¸ºäº†ä¿®æ­£â€œç¨€ç¼ºæ€§å¯¼è‡´çš„ä¿¡å·ä¸è¶³â€ï¼ˆä¸€æ¬¡ä¿®æ­£ï¼‰ã€‚</p>
<p>â€¢ AdaBoostï¼šæ˜¯ä¸»åŠ¨åˆ›é€ åˆ†å¸ƒå·®å¼‚ã€‚å®ƒä¸æ–­åœ°åˆ¶é€ ä¸å¹³è¡¡ï¼ˆæé«˜é”™é¢˜æƒé‡ï¼‰ï¼Œåˆ©ç”¨é‡è¦æ€§é‡‡æ ·çš„æœºåˆ¶å¼ºè¿«æ¨¡å‹å­¦ä¹ ï¼Œæœ€åå†é€šè¿‡æ•°å­¦æ‰‹æ®µï¼ˆåŠ æƒæ±‚å’Œï¼‰æŠŠè¿™äº›å·®å¼‚æŠµæ¶ˆæ‰ï¼Œè¿˜åŸå‡ºä¸€ä¸ªå¼ºå¤§çš„åˆ†ç±»å™¨ã€‚</p>
<h2 data-id="heading-29">å·¥ç¨‹é™·é˜±</h2>
<h3 data-id="heading-30">1. é™·é˜±ä¸€ï¼šæƒé‡çˆ†ç‚¸ï¼ˆVariance Explosionï¼‰</h3>
<p>â€¢ æ•°å­¦å…¬å¼ï¼š <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">W=\frac{P(x)}{Q(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span>ã€‚</p>
<p>â€¢ é—®é¢˜æ‰€åœ¨ï¼š å¦‚æœåœ¨æŸä¸ªç‚¹ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">x</span></span></span></span></span> ä¸Šï¼Œç›®æ ‡åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> è¿˜æœ‰ä¸€ç‚¹å€¼ï¼Œä½†ä½ çš„æè®®åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> éå¸¸å°ï¼ˆæ¥è¿‘ 0ï¼‰ï¼Œé‚£ä¹ˆ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span></span> å°±ä¼šå˜å¾—æ— ç©·å¤§ã€‚</p>
<p>â€¢ åæœï¼š åœ¨æ¨èç³»ç»Ÿæˆ–é‡‘èæ¨¡æ‹Ÿä¸­ï¼Œè¿™æ„å‘³ç€åªè¦æœ‰ä¸€ä¸ªæ ·æœ¬çš„æƒé‡æé«˜ï¼Œå®ƒå°±ä¼šç¬é—´â€œç»‘æ¶â€æ•´ä¸ªè®¡ç®—ç»“æœã€‚ä½ ä¼šå‘ç°ä¼°ç®—å‡ºçš„æœŸæœ›å€¼æ³¢åŠ¨å‰§çƒˆï¼Œä»Šå¤©ç®—å‡ºæ¥æ˜¯ 10ï¼Œæ˜å¤©å¯èƒ½å°±æ˜¯ 10000ã€‚</p>
<h3 data-id="heading-31">2. é™·é˜±äºŒï¼šç»´æ•°ç¾éš¾ï¼ˆCurse of Dimensionalityï¼‰</h3>
<p>åœ¨ç®€å•ä¾‹å­é‡Œï¼ˆå¦‚èº«é«˜ã€ç¦»çº¿è¯„ä¼°ï¼‰ï¼Œå˜é‡ç»´åº¦å¾ˆä½ã€‚ä½†åœ¨å¤æ‚çš„ç‰©ç†æ¨¡æ‹Ÿæˆ–é«˜ç»´æ·±åº¦å­¦ä¹ ä¸­ï¼š</p>
<p>â€¢ å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">x</span></span></span></span></span> æœ‰ 100 ä¸ªç»´åº¦ï¼Œæ¯ä¸ªç»´åº¦ä¸Š <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> å’Œ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span> åªæœ‰ä¸€ç‚¹ç‚¹å¾®å°çš„å·®å¼‚ï¼Œè¿™ 100 ä¸ªå¾®å°å·®å¼‚ç›¸ä¹˜ä¹‹åï¼Œæƒé‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span></span> ä¼šå˜å¾—æå…¶ä¸ç¨³å®šã€‚</p>
<p>â€¢ ç»“æœï¼š ç»å¤§å¤šæ•°æ ·æœ¬çš„æƒé‡éƒ½ä¼šè¶‹è¿‘äº 0ï¼Œåªæœ‰æä¸ªåˆ«æ ·æœ¬æƒé‡å·¨å¤§ã€‚è¿™æ„å‘³ç€ä½ é‡‡æ ·äº†åŠå¤©ï¼Œå…¶å®åªæœ‰ä¸€ä¸¤ä¸ªæ ·æœ¬åœ¨èµ·ä½œç”¨ï¼Œè¿™ä¼šå¯¼è‡´å·¨å¤§çš„ç»Ÿè®¡è¯¯å·®ã€‚</p>
<h3 data-id="heading-32">3. é™·é˜±ä¸‰ï¼šæè®®åˆ†å¸ƒ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span> æéš¾è®¾è®¡</h3>
<p>è™½ç„¶ç†è®ºä¸Šä½ å¯ä»¥éšä¾¿é€‰ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span>ï¼Œä½†é€‰å¾—ä¸å¥½ï¼Œä¸å¦‚ä¸é€‰ã€‚Â </p>
<p>â€¢ å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Q</span></span></span></span></span> çš„å½¢çŠ¶å’Œ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>Ã—</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P\times f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"/><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>ï¼ˆç›®æ ‡å‡½æ•°ï¼‰çš„å½¢çŠ¶å·®å¾—å¤ªè¿œï¼Œé‡è¦æ€§é‡‡æ ·çš„æ•ˆç‡åè€Œæ¯”æ™®é€šçš„è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿè¿˜è¦ä½å¾—å¤šã€‚</p>
<h2 data-id="heading-33">æè®®åˆ†å¸ƒé€‰æ‹©æ ‡å‡†</h2>
<h3 data-id="heading-34">1. ç”Ÿæ­»çº¿ï¼šæ•°å­¦ä¸Šçš„â€œè¦†ç›–â€è¦æ±‚ (Support Condition)</h3>
<p>è¿™æ˜¯æœ€åŸºæœ¬çš„å‰æï¼šå‡¡æ˜¯åŸåˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> ä¸­å¯èƒ½å‡ºç°çš„ç‚¹ï¼ˆæ¦‚ç‡ä¸ä¸º0çš„ç‚¹ï¼‰ï¼Œåœ¨ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> ä¸­ä¹Ÿå¿…é¡»å¯èƒ½å‡ºç°ã€‚Â </p>
<p>â€¢ è§„åˆ™ï¼šå¦‚æœå¯¹äºæŸä¸ª <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">x</span></span></span></span></span>ï¼Œæœ‰ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">p(x)&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">0</span></span></span></span></span>ï¼Œé‚£ä¹ˆå¿…é¡»æ»¡è¶³ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">q(x)&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6444em;"/><span class="mord">0</span></span></span></span></span>ã€‚</p>
<p>â€¢ åæœï¼šå¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> åœ¨æŸäº› <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> æœ‰å€¼çš„åŒºåŸŸä¸º 0ï¼Œé‚£ä¹ˆè¿™äº›åŒºåŸŸçš„æ ·æœ¬æ°¸è¿œä¸ä¼šè¢«é‡‡åˆ°ï¼Œä½ çš„æœŸæœ›ä¼°è®¡å°±ä¼šäº§ç”Ÿä¸å¯å¼¥è¡¥çš„åå·®ï¼ˆåä½ï¼‰ã€‚Â </p>
<h3 data-id="heading-35">2. æ•ˆç‡çº¿ï¼šæ–¹å·®æ§åˆ¶ (Variance Reduction)</h3>
<p>è™½ç„¶æ»¡è¶³äº†ç¬¬ä¸€æ¡å°±èƒ½å¾—åˆ°ç†è®ºä¸Šçš„æ— åä¼°è®¡ï¼Œä½†å¦‚æœ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> é€‰å¾—å·®ï¼Œæ–¹å·®ä¼šçˆ†ç‚¸ï¼Œå¯¼è‡´ä½ éœ€è¦æµ·é‡æ ·æœ¬æ‰èƒ½å¾—åˆ°ç¨³å®šçš„ç»“æœã€‚Â </p>
<p>â€¢ æƒé‡çˆ†ç‚¸é£é™©ï¼šè®°ä½æƒé‡æ˜¯ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">w(x)=\frac{p(x)}{q(x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span></span></span>ã€‚å¦‚æœä½ é€‰çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> åœ¨æŸä¸ª <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> å¾ˆå¤§çš„åœ°æ–¹éå¸¸å°ï¼Œé‚£ä¹ˆ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> å°±ä¼šå˜å¾—æå¤§ã€‚å•ä¸€ä¸ªå·¨å¤§çš„æƒé‡æ ·æœ¬å°±ä¼šç¬é—´â€œå¸¦åâ€æ•´ä¸ªå¹³å‡å€¼ï¼Œå¯¼è‡´ç»“æœå‰§çƒˆæ³¢åŠ¨ã€‚</p>
<p>â€¢ æœ€ä½³å®è·µï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> çš„â€œå°¾éƒ¨â€åº”è¯¥æ¯” <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> æ›´åšã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> è¦†ç›–çš„èŒƒå›´æœ€å¥½æ¯” <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> æ›´å¹¿ï¼Œè€Œä¸æ˜¯æ›´çª„ã€‚</p>
<h3 data-id="heading-36">3. å¤©èŠ±æ¿ï¼šä»€ä¹ˆæ˜¯â€œå®Œç¾â€çš„<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span></h3>
<p>ç†è®ºä¸Šå­˜åœ¨ä¸€ä¸ªæœ€ä¼˜åˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>q</mi><mo lspace="0em" rspace="0em">âˆ—</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q^{*}(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6887em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ—</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>ï¼Œèƒ½è®©ä¼°è®¡å€¼çš„æ–¹å·®é™ä¸º 0ï¼ˆå³é‡‡ä¸€æ¬¡æ ·å°±èƒ½å¾—åˆ°ç²¾ç¡®ç»“æœï¼‰ï¼š</p>
<p>â€¢ ç†æƒ³åˆ†å¸ƒï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>âˆ</mo><mi mathvariant="normal">âˆ£</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">âˆ£</mi><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)\propto |f(x)|p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">âˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord">âˆ£</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord">âˆ£</span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>ã€‚</p>
<p>â€¢ ç›´ç™½è§£é‡Šï¼šä½ åº”è¯¥åœ¨â€œå¯¹ç»“æœè´¡çŒ®æœ€å¤§â€çš„åœ°æ–¹å¤šé‡‡æ ·ã€‚è¿™ä¸ªè´¡çŒ®ç”±ä¸¤éƒ¨åˆ†å†³å®šï¼šè¯¥ç‚¹çš„å‘ç”Ÿæ¦‚ç‡ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> å’Œè¯¥ç‚¹çš„å‡½æ•°å€¼ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>ã€‚</p>
<p>â€¢ ç°å®å›°å¢ƒï¼šæˆ‘ä»¬é€šå¸¸ä¸çŸ¥é“è¿™ä¸ªåˆ†å¸ƒçš„ç§¯åˆ†ï¼ˆå› ä¸ºè¿™æ­£æ˜¯æˆ‘ä»¬è¦ç®—çš„ç›®æ ‡ï¼‰ï¼Œæ‰€ä»¥åªèƒ½å°½é‡å¯»æ‰¾ä¸€ä¸ªå½¢çŠ¶ä¸ä¹‹æ¥è¿‘çš„ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€å¤©ä¸€ä¸ªPythonåº“ï¼šidna - å¤„ç†å›½é™…åŒ–åŸŸåçš„ç¥å™¨]]></title>    <link>https://juejin.cn/post/7598403436698468386</link>    <guid>https://juejin.cn/post/7598403436698468386</guid>    <pubDate>2026-01-23T11:40:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598403436698468386" data-draft-id="7598382710294462464" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€å¤©ä¸€ä¸ªPythonåº“ï¼šidna - å¤„ç†å›½é™…åŒ–åŸŸåçš„ç¥å™¨"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2026-01-23T11:40:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ•ç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/2579909358396288"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€å¤©ä¸€ä¸ªPythonåº“ï¼šidna - å¤„ç†å›½é™…åŒ–åŸŸåçš„ç¥å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2579909358396288/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ•ç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T11:40:19.000Z" title="Fri Jan 23 2026 11:40:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">idna - å¤„ç†å›½é™…åŒ–åŸŸåçš„ç¥å™¨</h2>
<h3 data-id="heading-1">ä¸€ã€ä»€ä¹ˆæ˜¯idnaï¼Ÿ</h3>
<p><strong>idna</strong> æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†å›½é™…åŒ–åŸŸåï¼ˆInternationalized Domain Names, IDNAï¼‰çš„ Python åº“ã€‚IDNA å…è®¸åŸŸååŒ…å«é ASCII å­—ç¬¦ï¼Œä¾‹å¦‚ä¸­æ–‡ã€æ—¥æ–‡ã€é˜¿æ‹‰ä¼¯æ–‡ç­‰ã€‚</p>
<p>å®ƒå¯ä»¥å¸®åŠ©ä½ ï¼š</p>
<ul>
<li>å°†åŒ…å«é ASCII å­—ç¬¦çš„åŸŸåç¼–ç ä¸º ASCII å…¼å®¹æ ¼å¼ï¼ˆPunycoderï¼‰ã€‚</li>
<li>å°† ASCII å…¼å®¹æ ¼å¼ï¼ˆPunycoderï¼‰è§£ç å›åŸå§‹çš„å›½é™…åŒ–åŸŸåã€‚</li>
<li>ç¡®ä¿åŸŸåç¬¦åˆæœ€æ–°çš„ IDNA è§„èŒƒï¼ˆIDNA2008ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-2">äºŒã€åº”ç”¨åœºæ™¯</h3>
<p><strong>idna</strong> å¹¿æ³›åº”ç”¨äºä»¥ä¸‹å®é™…åœºæ™¯ï¼š</p>
<ul>
<li><strong>ç½‘ç«™å¼€å‘</strong>: å½“ä½ çš„ç½‘ç«™éœ€è¦æ”¯æŒç”¨æˆ·è¾“å…¥æˆ–æ˜¾ç¤ºåŒ…å«é ASCII å­—ç¬¦çš„åŸŸåæ—¶ï¼Œidna å¯ä»¥ç¡®ä¿è¿™äº›åŸŸåè¢«æ­£ç¡®å¤„ç†ã€‚</li>
<li><strong>é‚®ä»¶æœåŠ¡</strong>: å¤„ç†åŒ…å«å›½é™…åŒ–åŸŸåçš„ç”µå­é‚®ä»¶åœ°å€æ—¶ï¼Œéœ€è¦ä½¿ç”¨ idna è¿›è¡Œç¼–ç å’Œè§£ç ã€‚</li>
<li><strong>ç½‘ç»œå·¥å…·</strong>: åœ¨å¼€å‘ç½‘ç»œæ‰«æã€åŸŸåè§£æç­‰å·¥å…·æ—¶ï¼Œå¦‚æœæ¶‰åŠåˆ°å›½é™…åŒ–åŸŸåï¼Œidna æ˜¯å¿…ä¸å¯å°‘çš„ã€‚</li>
</ul>
<h3 data-id="heading-3">ä¸‰ã€å¦‚ä½•å®‰è£…</h3>
<ol>
<li>ä½¿ç”¨ pip å®‰è£…</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">pip install idna

<span class="hljs-comment"># å¦‚æœå®‰è£…æ…¢çš„è¯ï¼Œæ¨èä½¿ç”¨å›½å†…é•œåƒæº</span>
pip install idna -i https://pypi.tuna.tsinghua.edu.cn/simple/
</code></pre>
<ol start="2">
<li>ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.min2k.com%2Ftools%2Fpython-run%2F" target="_blank" title="https://www.min2k.com/tools/python-run/" ref="nofollow noopener noreferrer">PythonRun</a> åœ¨çº¿è¿è¡Œä»£ç ï¼ˆæ— éœ€æœ¬åœ°å®‰è£…ï¼‰</li>
</ol>
<h3 data-id="heading-4">å››ã€ç¤ºä¾‹ä»£ç </h3>
<p>å°†å›½é™…åŒ–åŸŸåç¼–ç å’Œè§£ç </p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> idna

<span class="hljs-comment"># è¿™æ˜¯ä¸€ä¸ªåŒ…å«éASCIIå­—ç¬¦çš„å›½é™…åŒ–åŸŸå</span>
domain = <span class="hljs-string">"ä¾‹å­.com"</span>
encoded_domain_punycode = <span class="hljs-string">""</span> <span class="hljs-comment"># åˆå§‹åŒ–ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œç”¨äºå­˜å‚¨ç¼–ç åçš„åŸŸå</span>

<span class="hljs-comment"># ç¼–ç åŸŸå</span>
<span class="hljs-keyword">try</span>:
    encoded_domain_punycode = idna.encode(domain).decode(<span class="hljs-string">'ascii'</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"åŸå§‹åŸŸå: <span class="hljs-subst">{domain}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç¼–ç ä¸º Punycode: <span class="hljs-subst">{encoded_domain_punycode}</span>"</span>)
<span class="hljs-keyword">except</span> idna.IDNAError <span class="hljs-keyword">as</span> e:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ç¼–ç åŸŸå '<span class="hljs-subst">{domain}</span>' å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)

<span class="hljs-comment"># å¦‚æœæˆåŠŸç¼–ç ï¼Œåˆ™å°è¯•è§£ç </span>
<span class="hljs-keyword">if</span> encoded_domain_punycode:
    decoded_domain = <span class="hljs-string">""</span> <span class="hljs-comment"># åˆå§‹åŒ–ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œç”¨äºå­˜å‚¨è§£ç åçš„åŸŸå</span>
    <span class="hljs-keyword">try</span>:
        decoded_domain = idna.decode(encoded_domain_punycode)
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è§£ç å›åŸå§‹åŸŸå: <span class="hljs-subst">{decoded_domain}</span>"</span>)
    <span class="hljs-keyword">except</span> idna.IDNAError <span class="hljs-keyword">as</span> e:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è§£ç åŸŸå '<span class="hljs-subst">{encoded_domain_punycode}</span>' å¤±è´¥: <span class="hljs-subst">{e}</span>"</span>)

    <span class="hljs-comment"># ç®€å•æ¡ä»¶åˆ¤æ–­ï¼Œç¡®è®¤è§£ç åçš„åŸŸåæ˜¯å¦ä¸åŸå§‹åŸŸåä¸€è‡´</span>
    <span class="hljs-keyword">if</span> decoded_domain == domain:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"ç¼–ç å’Œè§£ç æˆåŠŸï¼Œç»“æœä¸€è‡´ï¼"</span>)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"è§£ç åçš„åŸŸåä¸åŸå§‹åŸŸåä¸ä¸€è‡´ã€‚"</span>)
</code></pre>
<p>ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.min2k.com%2Ftools%2Fpython-run%2F%3Fcode%3Dimport%2520idna%250A%250A%2523%2520%25E8%25BF%2599%25E6%2598%25AF%25E4%25B8%2580%25E4%25B8%25AA%25E5%258C%2585%25E5%2590%25AB%25E9%259D%259EASCII%25E5%25AD%2597%25E7%25AC%25A6%25E7%259A%2584%25E5%259B%25BD%25E9%2599%2585%25E5%258C%2596%25E5%259F%259F%25E5%2590%258D%250Adomain%2520%253D%2520%2522%25E4%25BE%258B%25E5%25AD%2590.com%2522%250Aencoded_domain_punycode%2520%253D%2520%2522%2522%2520%2523%2520%25E5%2588%259D%25E5%25A7%258B%25E5%258C%2596%25E4%25B8%2580%25E4%25B8%25AA%25E7%25A9%25BA%25E5%25AD%2597%25E7%25AC%25A6%25E4%25B8%25B2%25EF%25BC%258C%25E7%2594%25A8%25E4%25BA%258E%25E5%25AD%2598%25E5%2582%25A8%25E7%25BC%2596%25E7%25A0%2581%25E5%2590%258E%25E7%259A%2584%25E5%259F%259F%25E5%2590%258D%250A%250A%2523%2520%25E7%25BC%2596%25E7%25A0%2581%25E5%259F%259F%25E5%2590%258D%250Atry%253A%250A%2520%2520%2520%2520encoded_domain_punycode%2520%253D%2520idna.encode%2528domain%2529.decode%2528'ascii'%2529%250A%2520%2520%2520%2520print%2528f%2522%25E5%258E%259F%25E5%25A7%258B%25E5%259F%259F%25E5%2590%258D%253A%2520%257Bdomain%257D%2522%2529%250A%2520%2520%2520%2520print%2528f%2522%25E7%25BC%2596%25E7%25A0%2581%25E4%25B8%25BA%2520Punycode%253A%2520%257Bencoded_domain_punycode%257D%2522%2529%250Aexcept%2520idna.IDNAError%2520as%2520e%253A%250A%2520%2520%2520%2520print%2528f%2522%25E7%25BC%2596%25E7%25A0%2581%25E5%259F%259F%25E5%2590%258D%2520'%257Bdomain%257D'%2520%25E5%25A4%25B1%25E8%25B4%25A5%253A%2520%257Be%257D%2522%2529%250A%250A%2523%2520%25E5%25A6%2582%25E6%259E%259C%25E6%2588%2590%25E5%258A%259F%25E7%25BC%2596%25E7%25A0%2581%25EF%25BC%258C%25E5%2588%2599%25E5%25B0%259D%25E8%25AF%2595%25E8%25A7%25A3%25E7%25A0%2581%250Aif%2520encoded_domain_punycode%253A%250A%2520%2520%2520%2520decoded_domain%2520%253D%2520%2522%2522%2520%2523%2520%25E5%2588%259D%25E5%25A7%258B%25E5%258C%2596%25E4%25B8%2580%25E4%25B8%25AA%25E7%25A9%25BA%25E5%25AD%2597%25E7%25AC%25A6%25E4%25B8%25B2%25EF%25BC%258C%25E7%2594%25A8%25E4%25BA%258E%25E5%25AD%2598%25E5%2582%25A8%25E8%25A7%25A3%25E7%25A0%2581%25E5%2590%258E%25E7%259A%2584%25E5%259F%259F%25E5%2590%258D%250A%2520%2520%2520%2520try%253A%250A%2520%2520%2520%2520%2520%2520%2520%2520decoded_domain%2520%253D%2520idna.decode%2528encoded_domain_punycode%2529%250A%2520%2520%2520%2520%2520%2520%2520%2520print%2528f%2522%25E8%25A7%25A3%25E7%25A0%2581%25E5%259B%259E%25E5%258E%259F%25E5%25A7%258B%25E5%259F%259F%25E5%2590%258D%253A%2520%257Bdecoded_domain%257D%2522%2529%250A%2520%2520%2520%2520except%2520idna.IDNAError%2520as%2520e%253A%250A%2520%2520%2520%2520%2520%2520%2520%2520print%2528f%2522%25E8%25A7%25A3%25E7%25A0%2581%25E5%259F%259F%25E5%2590%258D%2520'%257Bencoded_domain_punycode%257D'%2520%25E5%25A4%25B1%25E8%25B4%25A5%253A%2520%257Be%257D%2522%2529%250A%250A%2520%2520%2520%2520%2523%2520%25E7%25AE%2580%25E5%258D%2595%25E6%259D%25A1%25E4%25BB%25B6%25E5%2588%25A4%25E6%2596%25AD%25EF%25BC%258C%25E7%25A1%25AE%25E8%25AE%25A4%25E8%25A7%25A3%25E7%25A0%2581%25E5%2590%258E%25E7%259A%2584%25E5%259F%259F%25E5%2590%258D%25E6%2598%25AF%25E5%2590%25A6%25E4%25B8%258E%25E5%258E%259F%25E5%25A7%258B%25E5%259F%259F%25E5%2590%258D%25E4%25B8%2580%25E8%2587%25B4%250A%2520%2520%2520%2520if%2520decoded_domain%2520%253D%253D%2520domain%253A%250A%2520%2520%2520%2520%2520%2520%2520%2520print%2528%2522%25E7%25BC%2596%25E7%25A0%2581%25E5%2592%258C%25E8%25A7%25A3%25E7%25A0%2581%25E6%2588%2590%25E5%258A%259F%25EF%25BC%258C%25E7%25BB%2593%25E6%259E%259C%25E4%25B8%2580%25E8%2587%25B4%25EF%25BC%2581%2522%2529%250A%2520%2520%2520%2520else%253A%250A%2520%2520%2520%2520%2520%2520%2520%2520print%2528%2522%25E8%25A7%25A3%25E7%25A0%2581%25E5%2590%258E%25E7%259A%2584%25E5%259F%259F%25E5%2590%258D%25E4%25B8%258E%25E5%258E%259F%25E5%25A7%258B%25E5%259F%259F%25E5%2590%258D%25E4%25B8%258D%25E4%25B8%2580%25E8%2587%25B4%25E3%2580%2582%2522%2529" target="_blank" title="https://www.min2k.com/tools/python-run/?code=import%20idna%0A%0A%23%20%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%8C%85%E5%90%AB%E9%9D%9EASCII%E5%AD%97%E7%AC%A6%E7%9A%84%E5%9B%BD%E9%99%85%E5%8C%96%E5%9F%9F%E5%90%8D%0Adomain%20%3D%20%22%E4%BE%8B%E5%AD%90.com%22%0Aencoded_domain_punycode%20%3D%20%22%22%20%23%20%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%80%E4%B8%AA%E7%A9%BA%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%8C%E7%94%A8%E4%BA%8E%E5%AD%98%E5%82%A8%E7%BC%96%E7%A0%81%E5%90%8E%E7%9A%84%E5%9F%9F%E5%90%8D%0A%0A%23%20%E7%BC%96%E7%A0%81%E5%9F%9F%E5%90%8D%0Atry%3A%0A%20%20%20%20encoded_domain_punycode%20%3D%20idna.encode%28domain%29.decode%28'ascii'%29%0A%20%20%20%20print%28f%22%E5%8E%9F%E5%A7%8B%E5%9F%9F%E5%90%8D%3A%20%7Bdomain%7D%22%29%0A%20%20%20%20print%28f%22%E7%BC%96%E7%A0%81%E4%B8%BA%20Punycode%3A%20%7Bencoded_domain_punycode%7D%22%29%0Aexcept%20idna.IDNAError%20as%20e%3A%0A%20%20%20%20print%28f%22%E7%BC%96%E7%A0%81%E5%9F%9F%E5%90%8D%20'%7Bdomain%7D'%20%E5%A4%B1%E8%B4%A5%3A%20%7Be%7D%22%29%0A%0A%23%20%E5%A6%82%E6%9E%9C%E6%88%90%E5%8A%9F%E7%BC%96%E7%A0%81%EF%BC%8C%E5%88%99%E5%B0%9D%E8%AF%95%E8%A7%A3%E7%A0%81%0Aif%20encoded_domain_punycode%3A%0A%20%20%20%20decoded_domain%20%3D%20%22%22%20%23%20%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%80%E4%B8%AA%E7%A9%BA%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%8C%E7%94%A8%E4%BA%8E%E5%AD%98%E5%82%A8%E8%A7%A3%E7%A0%81%E5%90%8E%E7%9A%84%E5%9F%9F%E5%90%8D%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20decoded_domain%20%3D%20idna.decode%28encoded_domain_punycode%29%0A%20%20%20%20%20%20%20%20print%28f%22%E8%A7%A3%E7%A0%81%E5%9B%9E%E5%8E%9F%E5%A7%8B%E5%9F%9F%E5%90%8D%3A%20%7Bdecoded_domain%7D%22%29%0A%20%20%20%20except%20idna.IDNAError%20as%20e%3A%0A%20%20%20%20%20%20%20%20print%28f%22%E8%A7%A3%E7%A0%81%E5%9F%9F%E5%90%8D%20'%7Bencoded_domain_punycode%7D'%20%E5%A4%B1%E8%B4%A5%3A%20%7Be%7D%22%29%0A%0A%20%20%20%20%23%20%E7%AE%80%E5%8D%95%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD%EF%BC%8C%E7%A1%AE%E8%AE%A4%E8%A7%A3%E7%A0%81%E5%90%8E%E7%9A%84%E5%9F%9F%E5%90%8D%E6%98%AF%E5%90%A6%E4%B8%8E%E5%8E%9F%E5%A7%8B%E5%9F%9F%E5%90%8D%E4%B8%80%E8%87%B4%0A%20%20%20%20if%20decoded_domain%20%3D%3D%20domain%3A%0A%20%20%20%20%20%20%20%20print%28%22%E7%BC%96%E7%A0%81%E5%92%8C%E8%A7%A3%E7%A0%81%E6%88%90%E5%8A%9F%EF%BC%8C%E7%BB%93%E6%9E%9C%E4%B8%80%E8%87%B4%EF%BC%81%22%29%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20print%28%22%E8%A7%A3%E7%A0%81%E5%90%8E%E7%9A%84%E5%9F%9F%E5%90%8D%E4%B8%8E%E5%8E%9F%E5%A7%8B%E5%9F%9F%E5%90%8D%E4%B8%8D%E4%B8%80%E8%87%B4%E3%80%82%22%29" ref="nofollow noopener noreferrer">PythonRun</a> åœ¨çº¿è¿è¡Œè¿™æ®µä»£ç ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-text" lang="text">åŸå§‹åŸŸå: ä¾‹å­.com
ç¼–ç ä¸º Punycode: xn--fsqu00a.com
è§£ç å›åŸå§‹åŸŸå: ä¾‹å­.com
ç¼–ç å’Œè§£ç æˆåŠŸï¼Œç»“æœä¸€è‡´ï¼
</code></pre>
<p>ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.min2k.com%2Ftools%2Fmermaid%2F%3Fcode%3Dflowchart%2520TB%250A%2520%2520%2520%2520A%255B%25E5%25BC%2580%25E5%25A7%258B%255D%2520--%253E%2520B%257B%25E5%25AE%259A%25E4%25B9%2589%25E5%259B%25BD%25E9%2599%2585%25E5%258C%2596%25E5%259F%259F%25E5%2590%258D%2520'%25E4%25BE%258B%25E5%25AD%2590.com'%257D%253B%250A%2520%2520%2520%2520B%2520--%253E%2520C%257B%25E5%25B0%259D%25E8%25AF%2595%25E7%25BC%2596%25E7%25A0%2581%25E5%259F%259F%25E5%2590%258D%257D%253B%250A%2520%2520%2520%2520C%2520--%2520%25E6%2588%2590%25E5%258A%259F%2520--%253E%2520D%255B%25E6%2589%2593%25E5%258D%25B0%25E5%258E%259F%25E5%25A7%258B%25E5%259F%259F%25E5%2590%258D%25E5%2592%258C%25E7%25BC%2596%25E7%25A0%2581%25E5%2590%258E%25E7%259A%2584%2520Punycode%255D%253B%250A%2520%2520%2520%2520C%2520--%2520%25E5%25A4%25B1%25E8%25B4%25A5%2520--%253E%2520E%255B%25E6%2589%2593%25E5%258D%25B0%25E7%25BC%2596%25E7%25A0%2581%25E5%25A4%25B1%25E8%25B4%25A5%25E4%25BF%25A1%25E6%2581%25AF%255D%253B%250A%2520%2520%2520%2520D%2520--%253E%2520F%257B%25E6%25A3%2580%25E6%259F%25A5%25E6%2598%25AF%25E5%2590%25A6%25E6%2588%2590%25E5%258A%259F%25E7%25BC%2596%25E7%25A0%2581%257D%253B%250A%2520%2520%2520%2520F%2520--%2520%25E6%2598%25AF%2520--%253E%2520G%257B%25E5%25B0%259D%25E8%25AF%2595%25E8%25A7%25A3%25E7%25A0%2581%2520Punycode%257D%253B%250A%2520%2520%2520%2520G%2520--%2520%25E6%2588%2590%25E5%258A%259F%2520--%253E%2520H%255B%25E6%2589%2593%25E5%258D%25B0%25E8%25A7%25A3%25E7%25A0%2581%25E5%259B%259E%25E7%259A%2584%25E5%258E%259F%25E5%25A7%258B%25E5%259F%259F%25E5%2590%258D%255D%253B%250A%2520%2520%2520%2520G%2520--%2520%25E5%25A4%25B1%25E8%25B4%25A5%2520--%253E%2520I%255B%25E6%2589%2593%25E5%258D%25B0%25E8%25A7%25A3%25E7%25A0%2581%25E5%25A4%25B1%25E8%25B4%25A5%25E4%25BF%25A1%25E6%2581%25AF%255D%253B%250A%2520%2520%2520%2520H%2520--%253E%2520J%257B%25E8%25A7%25A3%25E7%25A0%2581%25E5%2590%258E%25E7%259A%2584%25E5%259F%259F%25E5%2590%258D%2520%253D%253D%2520%25E5%258E%259F%25E5%25A7%258B%25E5%259F%259F%25E5%2590%258D%253F%257D%253B%250A%2520%2520%2520%2520J%2520--%2520%25E6%2598%25AF%2520--%253E%2520K%255B%25E6%2589%2593%25E5%258D%25B0%2520%2522%25E7%25BC%2596%25E7%25A0%2581%25E5%2592%258C%25E8%25A7%25A3%25E7%25A0%2581%25E6%2588%2590%25E5%258A%259F%25EF%25BC%258C%25E7%25BB%2593%25E6%259E%259C%25E4%25B8%2580%25E8%2587%25B4%25EF%25BC%2581%2522%255D%253B%250A%2520%2520%2520%2520J%2520--%2520%25E5%2590%25A6%2520--%253E%2520L%255B%25E6%2589%2593%25E5%258D%25B0%2520%2522%25E8%25A7%25A3%25E7%25A0%2581%25E5%2590%258E%25E7%259A%2584%25E5%259F%259F%25E5%2590%258D%25E4%25B8%258E%25E5%258E%259F%25E5%25A7%258B%25E5%259F%259F%25E5%2590%258D%25E4%25B8%258D%25E4%25B8%2580%25E8%2587%25B4%25E3%2580%2582%2522%255D%253B%250A%2520%2520%2520%2520E%2520--%253E%2520Z%255B%25E7%25BB%2593%25E6%259D%259F%255D%253B%250A%2520%2520%2520%2520I%2520--%253E%2520Z%253B%250A%2520%2520%2520%2520K%2520--%253E%2520Z%253B%250A%2520%2520%2520%2520L%2520--%253E%2520Z%253B%250A%2520%2520%2520%2520F%2520--%2520%25E5%2590%25A6%2520--%253E%2520Z%253B" target="_blank" title="https://www.min2k.com/tools/mermaid/?code=flowchart%20TB%0A%20%20%20%20A%5B%E5%BC%80%E5%A7%8B%5D%20--%3E%20B%7B%E5%AE%9A%E4%B9%89%E5%9B%BD%E9%99%85%E5%8C%96%E5%9F%9F%E5%90%8D%20'%E4%BE%8B%E5%AD%90.com'%7D%3B%0A%20%20%20%20B%20--%3E%20C%7B%E5%B0%9D%E8%AF%95%E7%BC%96%E7%A0%81%E5%9F%9F%E5%90%8D%7D%3B%0A%20%20%20%20C%20--%20%E6%88%90%E5%8A%9F%20--%3E%20D%5B%E6%89%93%E5%8D%B0%E5%8E%9F%E5%A7%8B%E5%9F%9F%E5%90%8D%E5%92%8C%E7%BC%96%E7%A0%81%E5%90%8E%E7%9A%84%20Punycode%5D%3B%0A%20%20%20%20C%20--%20%E5%A4%B1%E8%B4%A5%20--%3E%20E%5B%E6%89%93%E5%8D%B0%E7%BC%96%E7%A0%81%E5%A4%B1%E8%B4%A5%E4%BF%A1%E6%81%AF%5D%3B%0A%20%20%20%20D%20--%3E%20F%7B%E6%A3%80%E6%9F%A5%E6%98%AF%E5%90%A6%E6%88%90%E5%8A%9F%E7%BC%96%E7%A0%81%7D%3B%0A%20%20%20%20F%20--%20%E6%98%AF%20--%3E%20G%7B%E5%B0%9D%E8%AF%95%E8%A7%A3%E7%A0%81%20Punycode%7D%3B%0A%20%20%20%20G%20--%20%E6%88%90%E5%8A%9F%20--%3E%20H%5B%E6%89%93%E5%8D%B0%E8%A7%A3%E7%A0%81%E5%9B%9E%E7%9A%84%E5%8E%9F%E5%A7%8B%E5%9F%9F%E5%90%8D%5D%3B%0A%20%20%20%20G%20--%20%E5%A4%B1%E8%B4%A5%20--%3E%20I%5B%E6%89%93%E5%8D%B0%E8%A7%A3%E7%A0%81%E5%A4%B1%E8%B4%A5%E4%BF%A1%E6%81%AF%5D%3B%0A%20%20%20%20H%20--%3E%20J%7B%E8%A7%A3%E7%A0%81%E5%90%8E%E7%9A%84%E5%9F%9F%E5%90%8D%20%3D%3D%20%E5%8E%9F%E5%A7%8B%E5%9F%9F%E5%90%8D%3F%7D%3B%0A%20%20%20%20J%20--%20%E6%98%AF%20--%3E%20K%5B%E6%89%93%E5%8D%B0%20%22%E7%BC%96%E7%A0%81%E5%92%8C%E8%A7%A3%E7%A0%81%E6%88%90%E5%8A%9F%EF%BC%8C%E7%BB%93%E6%9E%9C%E4%B8%80%E8%87%B4%EF%BC%81%22%5D%3B%0A%20%20%20%20J%20--%20%E5%90%A6%20--%3E%20L%5B%E6%89%93%E5%8D%B0%20%22%E8%A7%A3%E7%A0%81%E5%90%8E%E7%9A%84%E5%9F%9F%E5%90%8D%E4%B8%8E%E5%8E%9F%E5%A7%8B%E5%9F%9F%E5%90%8D%E4%B8%8D%E4%B8%80%E8%87%B4%E3%80%82%22%5D%3B%0A%20%20%20%20E%20--%3E%20Z%5B%E7%BB%93%E6%9D%9F%5D%3B%0A%20%20%20%20I%20--%3E%20Z%3B%0A%20%20%20%20K%20--%3E%20Z%3B%0A%20%20%20%20L%20--%3E%20Z%3B%0A%20%20%20%20F%20--%20%E5%90%A6%20--%3E%20Z%3B" ref="nofollow noopener noreferrer">MermaidGo</a> ç»˜åˆ¶ç¤ºä¾‹ä»£ç çš„æµç¨‹å›¾ï¼Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f1660665a9846339a774b8a0763fb68~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5pWP57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769773218&amp;x-signature=Z1xbo6REfBtbMXPSoZu7nMQhzEA%3D" alt="MermerGoçš„idnaåº“çš„æµç¨‹å›¾" loading="lazy"/></p>
<h3 data-id="heading-5">äº”ã€å­¦ä¹ èµ„æº</h3>
<ol>
<li>å¼€æºé¡¹ç›®ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fkjd%2Fidna" target="_blank" title="https://github.com/kjd/idna" ref="nofollow noopener noreferrer">idna</a></li>
<li>ä¸­æ–‡è‡ªè¿°ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.python64.cn%2Freadme%2Fidna%2F" target="_blank" title="https://www.python64.cn/readme/idna/" ref="nofollow noopener noreferrer">REMDME</a></li>
<li>åœ¨çº¿è¿è¡Œï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.min2k.com%2Ftools%2Fpython-run%2F" target="_blank" title="https://www.min2k.com/tools/python-run/" ref="nofollow noopener noreferrer">PythonRun</a></li>
</ol>
<blockquote>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµã€æ”¶è—ã€è½¬å‘ï¼<br/>
å­¦ä¹ è¿‡ç¨‹ä¸­æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€äº¤æµï½</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åœ¨åˆå¹¶åˆ°ä¸»åˆ†æ”¯ä¹‹å‰ï¼Œå¦‚ä½•å®ç”¨ git rebase æŠŠå‡ ä¸ªæäº¤åˆå¹¶èµ·æ¥]]></title>    <link>https://juejin.cn/post/7598362826110779442</link>    <guid>https://juejin.cn/post/7598362826110779442</guid>    <pubDate>2026-01-23T14:02:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598362826110779442" data-draft-id="7598362826110730290" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åœ¨åˆå¹¶åˆ°ä¸»åˆ†æ”¯ä¹‹å‰ï¼Œå¦‚ä½•å®ç”¨ git rebase æŠŠå‡ ä¸ªæäº¤åˆå¹¶èµ·æ¥"/> <meta itemprop="keywords" content="Git"/> <meta itemprop="datePublished" content="2026-01-23T14:02:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜é˜¿å‡¯"/> <meta itemprop="url" content="https://juejin.cn/user/1503787636243575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åœ¨åˆå¹¶åˆ°ä¸»åˆ†æ”¯ä¹‹å‰ï¼Œå¦‚ä½•å®ç”¨ git rebase æŠŠå‡ ä¸ªæäº¤åˆå¹¶èµ·æ¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1503787636243575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜é˜¿å‡¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T14:02:41.000Z" title="Fri Jan 23 2026 14:02:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åœºæ™¯æè¿°</h2>
<p>æˆ‘ä»¬åœ¨è‡ªå·±çš„åˆ†æ”¯å¼€å‘ä¸€ä¸ªåŠŸèƒ½æ—¶ï¼Œä¸€æ—¦æœ‰é˜¶æ®µæ€§åœ°æˆæœï¼Œå°±ä¼š commit ä¸€æ¬¡ä»£ç ã€‚å½“æˆ‘ä»¬æŠŠä¸€ä¸ªåŠŸèƒ½å®Œæ•´åœ°å¼€å‘å®Œæ—¶ï¼Œå¾€å¾€æœ‰å¥½å‡ ä¸ªæäº¤è®°å½•ï¼Œå¹¶ä¸”æäº¤çš„ message è¯´çš„ä¹Ÿæ¯”è¾ƒéšæ„ï¼Œå¦‚æœè¿™æ—¶å€™ç›´æ¥å‘ä¸»åˆ†æ”¯ merge ä»£ç ï¼Œä¼šè®©æäº¤è®°å½•çœ‹ä¸Šå»å¾ˆå‡Œä¹±ã€‚æ‰€ä»¥ä¸ºäº†æœ‰æ›´å®Œæ•´æ¸…æ™°çš„æäº¤è®°å½•ï¼Œæˆ‘ä»¬å…ˆæŠŠä¸è¿™ä¸ªåŠŸèƒ½æœ‰å…³çš„å‡ ä¸ªcommit åˆå¹¶æˆ 1 ä¸ªå®Œæ•´ä¸”æœ‰æ„ä¹‰çš„ commitã€‚</p>
<p>å¦‚ä½•å°†å¤šä¸ª commit åˆå¹¶æˆ 1 ä¸ª commit å‘¢ï¼Ÿå°±è¦ä½¿ç”¨<code>git rebase</code>å‘½ä»¤ã€‚</p>
<h2 data-id="heading-1">ç°åœºæƒ…å†µ</h2>
<p>å‡è®¾ï¼Œæˆ‘åœ¨<code>dev</code>åˆ†æ”¯æœ‰ä¸‰ä¸ªæäº¤æ¯”è¾ƒé›¶ç¢çš„æäº¤ï¼Œä¸ºäº†ç®€å•ï¼Œè¿™ä¸‰ä¸ª commit çš„ message åˆ†åˆ«æ˜¯4,5,6ã€‚ä¸‹é¢é€šè¿‡<code>git log</code>å‘½ä»¤çœ‹ä¸€ä¸‹ã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown">
$ git log --graph --oneline --decorate
<span class="hljs-bullet">*</span> b243fa1 (HEAD -&gt; dev) 6
<span class="hljs-bullet">*</span> 6245522 5
<span class="hljs-bullet">*</span> f13fad2 4
<span class="hljs-bullet">*</span> 5914f41 (main) bar---1
<span class="hljs-bullet">*</span> 42feff6 3
<span class="hljs-bullet">*</span> b3cdc2c 2
<span class="hljs-bullet">*</span> 4ce5158 1

</code></pre>
<h2 data-id="heading-2">å¼€å§‹åˆå¹¶æäº¤</h2>
<p>ä¸ºäº†æŠŠä»–ä»¬åˆå¹¶èµ·æ¥ï¼Œè¿è¡Œ <code>git rebase</code>å‘½ä»¤ï¼Œç”±äºæ˜¯è¦åˆå¹¶ 3 ä¸ªæäº¤ï¼Œæ‰€ä»¥ä½¿ç”¨<code>HEAD~3</code>ï¼Œå®ƒè¡¨ç¤ºè¦å¤„ç†ä» HEAD-3ï¼ˆä¸å«ï¼‰åˆ° HEADï¼ˆå«ï¼‰è¿™å‡ ä¸ªæäº¤ã€‚</p>
<pre><code class="hljs language-css" lang="css">git rebase -<span class="hljs-selector-tag">i</span> HEAD~<span class="hljs-number">3</span>
</code></pre>
<p>è¯æ±‡ä¼šå‡ºç°ä¸€ä¸ª vim ç¼–è¾‘æ¡†ï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼ˆ<code>#</code>å¼€å¤´çš„å†…å®¹å¯ä»¥çœ‹ä½œæ˜¯æ³¨é‡Šï¼‰</p>
<pre><code class="hljs">pick f13fad2 4
pick 6245522 5
pick b243fa1 6

</code></pre>
<p>è¿™æ˜¯ git è®©æˆ‘ä»¬é€‰æ‹©è¦å¦‚ä½•å¤„ç†è¿™ä¸‰ä¸ªæäº¤ã€‚æˆ‘æŠŠå®ƒä¿®æ”¹ä¸ºï¼Œ</p>
<pre><code class="hljs">r f13fad2 4
f 6245522 5
f b243fa1 6
</code></pre>
<p>é€šè¿‡ <code>:wq</code> å‘½ä»¤é€€å‡º vimã€‚ä¸‹é¢æ˜¯ r å’Œ f çš„è§£é‡Š</p>
<pre><code class="hljs language-sql" lang="sql">
r, reword <span class="hljs-operator">&lt;</span><span class="hljs-keyword">commit</span><span class="hljs-operator">&gt;</span> <span class="hljs-operator">=</span> use <span class="hljs-keyword">commit</span>, but edit the <span class="hljs-keyword">commit</span> message
f, fixup [<span class="hljs-operator">-</span>C <span class="hljs-operator">|</span> <span class="hljs-operator">-</span>c] <span class="hljs-operator">&lt;</span><span class="hljs-keyword">commit</span><span class="hljs-operator">&gt;</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">like</span> "squash" but keep <span class="hljs-keyword">only</span> the previous
#Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-keyword">commit</span><span class="hljs-string">'s log message, unless -C is used, in which case
#Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  keep only this commit'</span>s message; <span class="hljs-operator">-</span>c <span class="hljs-keyword">is</span> same <span class="hljs-keyword">as</span> <span class="hljs-operator">-</span>C but
#Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  opens the editor

</code></pre>
<p>é€€å‡ºvimï¼Œgitä¼šè§£æä¸Šé¢çš„<code>r f f</code>ï¼Œ</p>
<ul>
<li>ä¼šå†æ¬¡å¼¹å‡ºvimï¼Œè®©reword commit 4çš„æäº¤ä¿¡æ¯ã€‚è¿™é‡Œæˆ‘æŠŠæäº¤ä¿¡æ¯ä¿®æ”¹ä¸º<code>4,5,6åœ¨ä¸€èµ·</code>ï¼Œä¿å­˜å¹¶é€€å‡ºvimã€‚</li>
<li>commit 5 å’Œcommit 6 ä¿ç•™æ–‡ä»¶çš„å†…å®¹ï¼Œä½†åˆ å»commitè®°å½•ï¼Œè®©æäº¤è®°å½•æ›´æ•´æ´ã€‚</li>
</ul>
<h2 data-id="heading-3">å¤§åŠŸå‘Šæˆ</h2>
<p>æŸ¥çœ‹ä¸€ä¸‹ç°åœ¨çš„æäº¤å†å²ï¼Œå‘ç°4,5,6åˆå¹¶æˆ1ä¸ªæäº¤äº†ã€‚å¤§åŠŸå‘Šæˆã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown">git log --graph --oneline --decorate
<span class="hljs-bullet">*</span> 8056a94 (HEAD -&gt; dev) 4,5,6åœ¨ä¸€èµ·
<span class="hljs-bullet">*</span> 5914f41 (main) bar---1
<span class="hljs-bullet">*</span> 42feff6 3
<span class="hljs-bullet">*</span> b3cdc2c 2
<span class="hljs-bullet">*</span> 4ce5158 1
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBooté¡¹ç›®å¯åŠ¨é€Ÿåº¦æå‡50%çš„ç§˜å¯†ï¼š90%å¼€å‘è€…ä¸çŸ¥é“çš„5ä¸ªé…ç½®æŠ€å·§]]></title>    <link>https://juejin.cn/post/7598403436699254818</link>    <guid>https://juejin.cn/post/7598403436699254818</guid>    <pubDate>2026-01-24T00:16:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598403436699254818" data-draft-id="7598402961905090612" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringBooté¡¹ç›®å¯åŠ¨é€Ÿåº¦æå‡50%çš„ç§˜å¯†ï¼š90%å¼€å‘è€…ä¸çŸ¥é“çš„5ä¸ªé…ç½®æŠ€å·§"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-24T00:16:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringBooté¡¹ç›®å¯åŠ¨é€Ÿåº¦æå‡50%çš„ç§˜å¯†ï¼š90%å¼€å‘è€…ä¸çŸ¥é“çš„5ä¸ªé…ç½®æŠ€å·§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T00:16:52.000Z" title="Sat Jan 24 2026 00:16:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0"><strong>SpringBooté¡¹ç›®å¯åŠ¨é€Ÿåº¦æå‡50%çš„ç§˜å¯†ï¼š90%å¼€å‘è€…ä¸çŸ¥é“çš„5ä¸ªé…ç½®æŠ€å·§</strong></h3>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>åœ¨å¾®æœåŠ¡æ¶æ„ç››è¡Œçš„ä»Šå¤©ï¼ŒSpringBootå› å…¶"çº¦å®šä¼˜äºé…ç½®"çš„ç†å¿µå’Œå¿«é€Ÿå¼€å‘èƒ½åŠ›æˆä¸ºJavaç”Ÿæ€ä¸­çš„ä¸»æµæ¡†æ¶ã€‚ç„¶è€Œï¼Œéšç€é¡¹ç›®è§„æ¨¡çš„å¢é•¿ï¼Œè®¸å¤šå¼€å‘è€…å‘ç°SpringBootåº”ç”¨çš„å¯åŠ¨æ—¶é—´é€æ¸å˜å¾—ä»¤äººéš¾ä»¥å¿å—â€”â€”ä¸€ä¸ªä¸­å‹é¡¹ç›®åŠ¨è¾„éœ€è¦20-30ç§’æ‰èƒ½å®Œæˆå¯åŠ¨ï¼Œè¿™åœ¨CI/CDæµç¨‹æˆ–éœ€è¦é¢‘ç¹é‡å¯çš„å¼€å‘ç¯å¢ƒä¸­å°¤å…¶å½±å“æ•ˆç‡ã€‚</p>
<p>å®é™…ä¸Šï¼Œé€šè¿‡åˆç†çš„é…ç½®è°ƒæ•´å’Œä¼˜åŒ–æ‰‹æ®µï¼ŒSpringBooté¡¹ç›®çš„å¯åŠ¨é€Ÿåº¦å®Œå…¨å¯ä»¥å®ç°æ˜¾è‘—æå‡ã€‚æœ¬æ–‡å°†æ·±å…¥å‰–æ5ä¸ªè¢«å¤§å¤šæ•°å¼€å‘è€…å¿½ç•¥çš„å…³é”®é…ç½®æŠ€å·§ï¼Œè¿™äº›æŠ€å·§ç»“åˆJVMè°ƒä¼˜ã€SpringBootå†…éƒ¨æœºåˆ¶å’Œç°ä»£ç¡¬ä»¶ç‰¹æ€§ï¼Œå¯å¸®åŠ©ä½ çš„åº”ç”¨å¯åŠ¨é€Ÿåº¦è½»æ¾æå‡50%ä»¥ä¸Šã€‚</p>
<h2 data-id="heading-2">ä¸»ä½“</h2>
<h3 data-id="heading-3">1. æ‡’åŠ è½½ï¼ˆLazy Initializationï¼‰çš„å·§å¦™è¿ç”¨</h3>
<h4 data-id="heading-4">é—®é¢˜èƒŒæ™¯</h4>
<p>SpringBooté»˜è®¤é‡‡ç”¨é¥¥é¥¿åŠ è½½ï¼ˆEager Loadingï¼‰ç­–ç•¥ï¼Œå³åœ¨å¯åŠ¨æ—¶ç«‹å³åˆå§‹åŒ–æ‰€æœ‰å•ä¾‹Beanã€‚å¯¹äºåŒ…å«æ•°ç™¾ä¸ªBeançš„å¤§å‹åº”ç”¨ï¼Œè¿™ä¼šå¯¼è‡´æ˜æ˜¾çš„å¯åŠ¨å»¶è¿Ÿã€‚</p>
<h4 data-id="heading-5">è§£å†³æ–¹æ¡ˆ</h4>
<p>é€šè¿‡ä»¥ä¸‹é…ç½®å¯ç”¨å…¨å±€æ‡’åŠ è½½ï¼š</p>
<pre><code class="hljs language-properties" lang="properties">spring.main.lazy-initialization=true
</code></pre>
<h4 data-id="heading-6">è¿›é˜¶æŠ€å·§</h4>
<ul>
<li><strong>é€‰æ‹©æ€§æ‡’åŠ è½½</strong>ï¼šå¯¹ç‰¹å®šBeanä½¿ç”¨<code>@Lazy</code>æ³¨è§£è€Œéå…¨å±€é…ç½®</li>
<li><strong>ç»“åˆProfile</strong>ï¼šä»…åœ¨å¼€å‘ç¯å¢ƒå¯ç”¨æ‡’åŠ è½½ï¼ˆç”Ÿäº§ç¯å¢ƒéœ€è°¨æ…ï¼‰</li>
<li><strong>ç›‘æ§å½±å“</strong>ï¼šé€šè¿‡<code>/actuator/beans</code>ç«¯ç‚¹éªŒè¯æ‡’åŠ è½½æ•ˆæœ</li>
</ul>
<h4 data-id="heading-7">æ€§èƒ½å¯¹æ¯”</h4>

























<table><thead><tr><th>ç­–ç•¥</th><th>Beanæ•°é‡</th><th>å¯åŠ¨æ—¶é—´(ms)</th></tr></thead><tbody><tr><td>é¥¥é¥¿åŠ è½½</td><td>500</td><td>12,000</td></tr><tr><td>å…¨å±€æ‡’åŠ è½½</td><td>500</td><td>7,800</td></tr><tr><td>é€‰æ‹©æ€§æ‡’åŠ è½½</td><td>500</td><td>9,200</td></tr></tbody></table>
<h3 data-id="heading-8">2. JVMç±»é¢„åŠ è½½ï¼ˆClass Data Sharingï¼‰çš„é»‘ç§‘æŠ€</h3>
<h4 data-id="heading-9">JVMæœºåˆ¶è§£æ</h4>
<p>CDSï¼ˆClass Data Sharingï¼‰æ˜¯HotSpot VMçš„ä¸€é¡¹ç‰¹æ€§ï¼Œå…è®¸å°†å·²è§£æçš„ç±»å…ƒæ•°æ®å­˜å…¥å…±äº«å½’æ¡£æ–‡ä»¶ï¼Œåç»­JVMå®ä¾‹å¯ç›´æ¥å¤ç”¨ã€‚å¯¹äºSpringBootè¿™ç§å¤§é‡ä¾èµ–æ¡†æ¶ç±»çš„æƒ…å†µç‰¹åˆ«æœ‰æ•ˆã€‚</p>
<h4 data-id="heading-10">å…·ä½“å®ç°æ­¥éª¤</h4>
<ol>
<li>åˆ›å»ºå…±äº«å½’æ¡£ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">java -Xshare:dump -XX:SharedArchiveFile=springboot.jsa -jar your-app.jar
</code></pre>
<ol start="2">
<li>ä½¿ç”¨å½’æ¡£å¯åŠ¨ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">java -Xshare:on -XX:SharedArchiveFile=springboot.jsa -jar your-app.jar
</code></pre>
<h4 data-id="heading-11">æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>JDKç‰ˆæœ¬è¦æ±‚â‰¥11ï¼ˆJDK17æ•ˆæœæœ€ä½³ï¼‰</li>
<li>Windowså¹³å°éœ€è¦ç®¡ç†å‘˜æƒé™</li>
<li>ARMæ¶æ„å¤„ç†å™¨æ”¯æŒæœ‰é™åˆ¶</li>
</ul>
<h3 data-id="heading-12">3. Spring Componentæ‰«æçš„ç²¾å‡†æ§åˆ¶</h3>
<h4 data-id="heading-13">å¸¸è§é—®é¢˜åœºæ™¯</h4>
<p>é»˜è®¤çš„<code>@ComponentScan</code>ä¼šé€’å½’æ‰«ææ•´ä¸ªåŒ…è·¯å¾„ï¼ŒåŒ…æ‹¬ä¸éœ€è¦çš„ç¬¬ä¸‰æ–¹åº“å’Œæµ‹è¯•ç±»ã€‚</p>
<h4 data-id="heading-14">ä¼˜åŒ–æ–¹æ¡ˆç»„åˆæ‹³</h4>
<ol>
<li><strong>æ˜¾å¼æŒ‡å®šæ‰«æè·¯å¾„</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@ComponentScan(basePackages = {"com.your.business"})</span>
</code></pre>
<ol start="2">
<li><strong>æ’é™¤è‡ªåŠ¨é…ç½®ç±»</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-properties" lang="properties">spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration
</code></pre>
<ol start="3">
<li><strong>ä½¿ç”¨FilteråŠ é€Ÿ</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@ComponentScan(excludeFilters = @Filter(type = FilterType.REGEX, pattern = ".*Test.*"))</span>
</code></pre>
<h3 data-id="heading-15">4. JVMå‚æ•°è°ƒä¼˜çš„ä¸‰æ¿æ–§</h3>
<h4 data-id="heading-16">ï¼ˆ1ï¼‰å¹¶è¡Œç±»åŠ è½½ä¼˜åŒ–</h4>
<pre><code class="hljs language-properties" lang="properties">-XX:+AlwaysPreTouch 
-XX:+TieredCompilation 
-XX:+UseParallelGC
</code></pre>
<h4 data-id="heading-17">ï¼ˆ2ï¼‰å †å†…å­˜é»„é‡‘æ¯”ä¾‹ï¼ˆé’ˆå¯¹å¯åŠ¨ä¼˜åŒ–ï¼‰</h4>
<pre><code class="hljs language-properties" lang="properties">-Xms512m -Xmx512m 
-XX:MaxMetaspaceSize=256m 
-XX:ReservedCodeCacheSize=128m
</code></pre>
<h4 data-id="heading-18">ï¼ˆ3ï¼‰JITæ¿€è¿›æ¨¡å¼ï¼ˆä»…å¼€å‘ç¯å¢ƒæ¨èï¼‰</h4>
<pre><code class="hljs language-properties" lang="properties">-XX:CompileThreshold=100 
-XX:Tier4CompileThreshold=5000
</code></pre>
<h3 data-id="heading-19">5. Spring Boot DevToolsçš„æ·±åº¦æ”¹é€ æ–¹æ¡ˆ</h3>
<h4 data-id="heading-20">DevToolsçš„éšè—æ½œåŠ›ç‚¹ï¼š</h4>
<ol>
<li><strong>å®šåˆ¶Restartç­–ç•¥</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-properties" lang="properties">spring.devtools.restart.additional-exclude=static/** 
spring.devtools.restart.poll-interval=2000ms
</code></pre>
<ol start="2">
<li><strong>æ¨¡å—åŒ–çƒ­éƒ¨ç½²</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RestartScope</span> <span class="hljs-comment">// Spring Nativeç‰¹æœ‰æ³¨è§£</span>
<span class="hljs-meta">@Component</span> <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HotModule</span> {}
</code></pre>
<ol start="3">
<li><strong>è¿œç¨‹å¼€å‘æ¨¡å¼ä¼˜åŒ–</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">-Dspring.devtools.remote.secret</span>=
<span class="hljs-attr">-Dspring.devtools.restart.enabled</span>=<span class="hljs-literal">false</span>
</code></pre>
<h2 data-id="heading-21">æ€»ç»“</h2>
<p>æœ¬æ–‡æ­ç¤ºçš„äº”é¡¹å…³é”®æŠ€æœ¯â€”â€”ä»æ‡’åŠ è½½ç­–ç•¥åˆ°JVMåº•å±‚è°ƒä¼˜â€”â€”æ„æˆäº†ä¸€ä¸ªå®Œæ•´çš„SpringBootå¯åŠ¨åŠ é€Ÿæ–¹æ¡ˆä½“ç³»ã€‚å®é™…åº”ç”¨ä¸­å»ºè®®é‡‡ç”¨æ¸è¿›å¼ä¼˜åŒ–ï¼š</p>
<ol>
<li>
<p><strong>è¯Šæ–­é˜¶æ®µ</strong>ï¼šä½¿ç”¨<code>--debug</code>æ¨¡å¼è¾“å‡ºå¯åŠ¨æ—¥å¿—åˆ†æè€—æ—¶ç“¶é¢ˆ</p>
</li>
<li>
<p><strong>åŸºç¡€ä¼˜åŒ–</strong>ï¼šå…ˆå®æ–½Componentæ‰«æèŒƒå›´æ”¶ç¼©å’ŒDevToolsé…ç½®</p>
</li>
<li>
<p><strong>é«˜çº§è°ƒä¼˜</strong>ï¼šå¼•å…¥CDSå’ŒJVMå‚æ•°è°ƒæ•´</p>
</li>
<li>
<p><strong>ç”Ÿäº§éªŒè¯</strong>ï¼šé€šè¿‡A/Bæµ‹è¯•æ¯”è¾ƒä¼˜åŒ–æ•ˆæœ</p>
</li>
</ol>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™äº›ä¼˜åŒ–æ‰‹æ®µçš„æ•ˆæœå…·æœ‰å åŠ æ€§â€”â€”å½“å¤šä¸ªä¼˜åŒ–ç‚¹ååŒå·¥ä½œæ—¶ï¼Œå¾€å¾€èƒ½äº§ç”Ÿ1+1&gt;2çš„æ•ˆæœã€‚æŸç”µå•†å¹³å°çš„å®æµ‹æ•°æ®æ˜¾ç¤ºï¼Œç»¼åˆåº”ç”¨è¿™äº›æŠ€å·§åï¼Œå…¶è®¢å•æœåŠ¡çš„å¯åŠ¨æ—¶é—´ä»åŸå§‹çš„28ç§’é™è‡³13ç§’ä»¥ä¸‹ã€‚</p>
<p>æœ€åæé†’å¼€å‘è€…ï¼šä»»ä½•æ€§èƒ½ä¼˜åŒ–éƒ½éœ€è¦ç»“åˆå…·ä½“ä¸šåŠ¡åœºæ™¯è¿›è¡Œæƒè¡¡ã€‚ä¾‹å¦‚æ‡’åŠ è½½è™½ç„¶åŠ å¿«å¯åŠ¨é€Ÿåº¦ï¼Œä½†å¯èƒ½å¯¼è‡´é¦–ä¸ªè¯·æ±‚å“åº”å˜æ…¢ï¼›æ¿€è¿›çš„å†…å­˜è®¾ç½®å¯èƒ½å½±å“ç³»ç»Ÿç¨³å®šæ€§ã€‚å»ºè®®åœ¨å®æ–½å‰å……åˆ†è¯„ä¼°å¹¶åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯æ•ˆæœã€‚</p>
<h2 data-id="heading-22"/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€èŠ‚ç‚¹ã€‘[InstanceIDèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨]]></title>    <link>https://juejin.cn/post/7598450302615355438</link>    <guid>https://juejin.cn/post/7598450302615355438</guid>    <pubDate>2026-01-24T00:54:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598450302615355438" data-draft-id="7598477092195794982" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€èŠ‚ç‚¹ã€‘[InstanceIDèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨"/> <meta itemprop="keywords" content="æ¸¸æˆå¼€å‘,å›¾å½¢å­¦,Unity3D"/> <meta itemprop="datePublished" content="2026-01-24T00:54:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SmalBox"/> <meta itemprop="url" content="https://juejin.cn/user/2218166695237532"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€èŠ‚ç‚¹ã€‘[InstanceIDèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2218166695237532/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SmalBox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T00:54:42.000Z" title="Sat Jan 24 2026 00:54:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong></p>
</blockquote>
<p>åœ¨Unityå¼•æ“çš„æ¸²æŸ“ç®¡çº¿ä¸­ï¼ŒGPUå®ä¾‹åŒ–æ˜¯ä¸€é¡¹é‡è¦çš„æ€§èƒ½ä¼˜åŒ–æŠ€æœ¯ï¼Œå®ƒå…è®¸åœ¨å•ä¸ªç»˜åˆ¶è°ƒç”¨ä¸­æ¸²æŸ“å¤šä¸ªç›¸åŒçš„ç½‘æ ¼ï¼Œæ˜¾è‘—å‡å°‘äº†CPUåˆ°GPUçš„æ•°æ®ä¼ è¾“å¼€é”€ã€‚åœ¨URPï¼ˆUniversal Render Pipelineï¼‰çš„Shader Graphä¸­ï¼ŒInstanceIDèŠ‚ç‚¹æ‰®æ¼”ç€å…³é”®è§’è‰²ï¼Œå®ƒä¸ºå¼€å‘è€…æä¾›äº†è®¿é—®æ¯ä¸ªå®ä¾‹å”¯ä¸€æ ‡è¯†ç¬¦çš„èƒ½åŠ›ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨InstanceIDèŠ‚ç‚¹çš„å„ä¸ªæ–¹é¢ï¼ŒåŒ…æ‹¬å…¶å·¥ä½œåŸç†ã€åº”ç”¨åœºæ™¯ã€ä½¿ç”¨æŠ€å·§ä»¥åŠå®é™…ç¤ºä¾‹ã€‚</p>
<h2 data-id="heading-0">InstanceIDèŠ‚ç‚¹çš„åŸºæœ¬æ¦‚å¿µ</h2>
<p>InstanceIDèŠ‚ç‚¹æ˜¯Shader Graphä¸­çš„ä¸€ä¸ªç‰¹æ®ŠåŠŸèƒ½èŠ‚ç‚¹ï¼Œå®ƒè¿”å›å½“å‰æ­£åœ¨æ¸²æŸ“çš„å‡ ä½•ä½“å®ä¾‹çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚è¿™ä¸ªæ ‡è¯†ç¬¦åœ¨GPUå®ä¾‹åŒ–è¿‡ç¨‹ä¸­ç”±Unityå¼•æ“è‡ªåŠ¨åˆ†é…å’Œç®¡ç†ã€‚</p>
<p>å½“Unityä½¿ç”¨GPUå®ä¾‹åŒ–æŠ€æœ¯æ¸²æŸ“å¤šä¸ªç›¸åŒç½‘æ ¼æ—¶ï¼Œæ¯ä¸ªå®ä¾‹éƒ½ä¼šè·å¾—ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„Instance IDã€‚è¿™ä¸ªIDä»0å¼€å§‹é€’å¢ï¼Œå¯¹åº”äºç»˜åˆ¶è°ƒç”¨ä¸­æ¯ä¸ªå®ä¾‹çš„ç´¢å¼•ä½ç½®ã€‚ç†è§£è¿™ä¸€ç‚¹å¯¹äºæ­£ç¡®ä½¿ç”¨InstanceIDèŠ‚ç‚¹è‡³å…³é‡è¦ã€‚</p>
<p>InstanceIDèŠ‚ç‚¹çš„è¾“å‡ºæ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°å€¼ï¼Œä»£è¡¨å½“å‰å®ä¾‹çš„æ ‡è¯†ç¬¦ã€‚åœ¨éå®ä¾‹åŒ–æ¸²æŸ“æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå€¼å§‹ç»ˆä¸º0ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ä½¿ç”¨åŠ¨æ€å®ä¾‹åŒ–æ—¶ï¼Œå®ä¾‹IDåœ¨ä¸åŒå¸§ä¹‹é—´å¯èƒ½ä¸ä¼šä¿æŒä¸€è‡´ï¼Œè¿™æ„å‘³ç€å¼€å‘è€…ä¸åº”è¯¥ä¾èµ–å®ä¾‹IDåœ¨å¤šä¸ªå¸§ä¹‹é—´çš„æŒä¹…æ€§ã€‚</p>
<h2 data-id="heading-1">InstanceIDèŠ‚ç‚¹çš„å·¥ä½œåŸç†</h2>
<p><img src="https://docs.unity.cn/cn/Packages-cn/com.unity.shadergraph@14.0/manual/images/InstanceIDNodeThumb.png" alt="" loading="lazy"/></p>
<p>è¦æ·±å…¥ç†è§£InstanceIDèŠ‚ç‚¹ï¼Œé¦–å…ˆéœ€è¦äº†è§£GPUå®ä¾‹åŒ–çš„åŸºæœ¬æœºåˆ¶ã€‚GPUå®ä¾‹åŒ–å…è®¸åœ¨å•ä¸ªç»˜åˆ¶è°ƒç”¨ä¸­æ¸²æŸ“å¤šä¸ªç›¸åŒçš„ç½‘æ ¼ï¼Œæ¯ä¸ªå®ä¾‹å¯ä»¥æœ‰ä¸åŒçš„å˜æ¢çŸ©é˜µã€é¢œè‰²å’Œå…¶ä»–å±æ€§ã€‚Unityé€šè¿‡å®ä¾‹ç¼“å†²åŒºï¼ˆInstance Bufferï¼‰å°†è¿™äº›æ¯å®ä¾‹æ•°æ®ä¼ é€’ç»™ç€è‰²å™¨ã€‚</p>
<p>åœ¨ç€è‰²å™¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿä¼šä¸ºæ¯ä¸ªå®ä¾‹åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ç´¢å¼•ï¼Œè¿™å°±æ˜¯Instance IDçš„æ¥æºã€‚InstanceIDèŠ‚ç‚¹æœ¬è´¨ä¸Šå°±æ˜¯è®¿é—®è¿™ä¸ªå†…ç½®çš„ç€è‰²å™¨å˜é‡<code>unity_InstanceID</code>ã€‚</p>
<p>åœ¨HLSLä»£ç ä¸­ï¼ŒInstanceIDèŠ‚ç‚¹çš„å®ç°å¤§è‡´å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function">HLSL

<span class="hljs-keyword">void</span> <span class="hljs-title">Unity_InstanceID_float</span>(<span class="hljs-params"><span class="hljs-keyword">out</span> <span class="hljs-built_in">float</span> Out</span>)</span>
{
    Out = unity_InstanceID;
}
</code></pre>
<p>å½“åœ¨Shader Graphä¸­ä½¿ç”¨InstanceIDèŠ‚ç‚¹æ—¶ï¼Œè¿™ä¸ªå†…ç½®å˜é‡ä¼šè¢«è‡ªåŠ¨åŒ…å«åœ¨ç”Ÿæˆçš„ç€è‰²å™¨ä»£ç ä¸­ã€‚Unityçš„æ¸²æŸ“ç®¡çº¿è´Ÿè´£åœ¨å®ä¾‹åŒ–ç»˜åˆ¶è°ƒç”¨æ—¶æ­£ç¡®è®¾ç½®è¿™ä¸ªå€¼ã€‚</p>
<h2 data-id="heading-2">InstanceIDèŠ‚ç‚¹çš„ç«¯å£é…ç½®</h2>
<p>InstanceIDèŠ‚ç‚¹çš„ç«¯å£é…ç½®ç›¸å¯¹ç®€å•ï¼Œåªæœ‰ä¸€ä¸ªè¾“å‡ºç«¯å£ï¼š</p>
<p>è¾“å‡ºç«¯å£ï¼ˆOutï¼‰æä¾›å½“å‰å®ä¾‹çš„IDå€¼ï¼Œæ•°æ®ç±»å‹ä¸ºæµ®ç‚¹æ•°ï¼ˆFloatï¼‰ã€‚è¿™ä¸ªç«¯å£ä¸éœ€è¦ä»»ä½•ç»‘å®šï¼Œå› ä¸ºå®ƒçš„å€¼æ˜¯ç”±æ¸²æŸ“ç®¡çº¿è‡ªåŠ¨æä¾›çš„ã€‚</p>
<p>è™½ç„¶è¾“å‡ºç±»å‹æ˜¾ç¤ºä¸ºæµ®ç‚¹æ•°ï¼Œä½†å®é™…ä½¿ç”¨æ—¶ï¼Œå®ä¾‹IDé€šå¸¸æ˜¯æ•´æ•°å€¼ã€‚åœ¨Shader Graphä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é€‚å½“çš„èŠ‚ç‚¹å°†å…¶è½¬æ¢ä¸ºæ•´æ•°ï¼Œæˆ–è€…ç›´æ¥ä½œä¸ºæµ®ç‚¹æ•°ä½¿ç”¨ï¼Œå…·ä½“å–å†³äºåº”ç”¨åœºæ™¯ã€‚</p>
<h2 data-id="heading-3">InstanceIDèŠ‚ç‚¹çš„åº”ç”¨åœºæ™¯</h2>
<p>InstanceIDèŠ‚ç‚¹åœ¨Shader Graphä¸­æœ‰å¤šç§åº”ç”¨åœºæ™¯ï¼Œä»¥ä¸‹æ˜¯å‡ ä¸ªå¸¸è§çš„ç”¨ä¾‹ï¼š</p>
<ul>
<li>å®ä¾‹å·®å¼‚åŒ–ï¼šé€šè¿‡Instance IDä¸ºæ¯ä¸ªå®ä¾‹ç”Ÿæˆä¸åŒçš„é¢œè‰²ã€å¤§å°æˆ–å¤–è§‚ï¼Œå³ä½¿å®ƒä»¬ä½¿ç”¨ç›¸åŒçš„ç½‘æ ¼å’Œæè´¨ã€‚ä¾‹å¦‚ï¼Œåœ¨æ¸²æŸ“ä¸€ç‰‡æ£®æ—æ—¶ï¼Œå¯ä»¥ä½¿ç”¨Instance IDä¸ºæ¯æ£µæ ‘ç”Ÿæˆç•¥å¾®ä¸åŒçš„é¢œè‰²å’Œå¤§å°ï¼Œå¢åŠ åœºæ™¯çš„è‡ªç„¶æ„Ÿã€‚</li>
<li>ç¨‹åºåŒ–åŠ¨ç”»ï¼šåˆ©ç”¨Instance IDä¸ºæ¯ä¸ªå®ä¾‹åˆ›å»ºä¸åŒçš„åŠ¨ç”»æ•ˆæœã€‚ä¾‹å¦‚ï¼Œåœ¨æ¸²æŸ“ä¸€ç¾¤é±¼æ—¶ï¼Œå¯ä»¥ä½¿ç”¨Instance IDæ§åˆ¶æ¯æ¡é±¼çš„æ¸¸åŠ¨ç›¸ä½ï¼Œä½¿é±¼ç¾¤è¿åŠ¨æ›´åŠ è‡ªç„¶ã€‚</li>
<li>æ•°æ®ç´¢å¼•ï¼šä½¿ç”¨Instance IDä½œä¸ºç´¢å¼•ï¼Œä»çº¹ç†æˆ–æ•°ç»„ä¸­æŸ¥æ‰¾å¯¹åº”çš„æ•°æ®ã€‚è¿™åœ¨éœ€è¦ä¸ºæ¯ä¸ªå®ä¾‹åº”ç”¨ä¸åŒè´´å›¾æˆ–å‚æ•°æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚</li>
<li>éšæœºå€¼ç”Ÿæˆï¼šå°†Instance IDä½œä¸ºéšæœºæ•°ç”Ÿæˆçš„ç§å­ï¼Œä¸ºæ¯ä¸ªå®ä¾‹åˆ›å»ºå¯é¢„æµ‹çš„éšæœºå€¼ã€‚è¿™ç§æ–¹æ³•ç¡®ä¿åŒä¸€å®ä¾‹åœ¨ä¸åŒå¸§ä¸­ä¿æŒä¸€è‡´çš„éšæœºè¡Œä¸ºã€‚</li>
<li>è°ƒè¯•å’Œå¯è§†åŒ–ï¼šåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨Instance IDå¯è§†åŒ–ä¸åŒçš„å®ä¾‹ï¼Œå¸®åŠ©è°ƒè¯•å®ä¾‹åŒ–ç›¸å…³çš„é—®é¢˜ã€‚</li>
</ul>
<h2 data-id="heading-4">ä½¿ç”¨InstanceIDèŠ‚ç‚¹çš„æ³¨æ„äº‹é¡¹</h2>
<p>åœ¨ä½¿ç”¨InstanceIDèŠ‚ç‚¹æ—¶ï¼Œæœ‰å‡ ä¸ªé‡è¦äº‹é¡¹éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li>å®ä¾‹åŒ–å¯ç”¨æ¡ä»¶ï¼šInstanceIDèŠ‚ç‚¹åªæœ‰åœ¨çœŸæ­£ä½¿ç”¨GPUå®ä¾‹åŒ–æ—¶æ‰ä¼šè¿”å›æœ‰æ„ä¹‰çš„éé›¶å€¼ã€‚ç¡®ä¿æè´¨å’Œæ¸²æŸ“è®¾ç½®æ­£ç¡®å¯ç”¨äº†GPUå®ä¾‹åŒ–ã€‚</li>
<li>åŠ¨æ€å®ä¾‹åŒ–çš„ä¸ç¨³å®šæ€§ï¼šå½“ä½¿ç”¨åŠ¨æ€å®ä¾‹åŒ–æ—¶ï¼Œå®ä¾‹IDåœ¨ä¸åŒå¸§ä¹‹é—´å¯èƒ½ä¸ä¸€è‡´ã€‚é¿å…ä¾èµ–å®ä¾‹IDçš„æŒä¹…æ€§è¿›è¡Œè·¨å¸§çš„çŠ¶æ€ç®¡ç†ã€‚</li>
<li>æ€§èƒ½è€ƒè™‘ï¼šè™½ç„¶è®¿é—®InstanceIDæœ¬èº«å¼€é”€å¾ˆå°ï¼Œä½†åŸºäºå®ƒçš„å¤æ‚è®¡ç®—å¯èƒ½ä¼šå½±å“æ€§èƒ½ã€‚åœ¨ç§»åŠ¨å¹³å°ç­‰æ€§èƒ½å—é™çš„ç¯å¢ƒä¸­è¦ç‰¹åˆ«å°å¿ƒã€‚</li>
<li>æœ€å¤§å€¼é™åˆ¶ï¼šå®ä¾‹IDçš„å–å€¼èŒƒå›´å—é™äºç»˜åˆ¶è°ƒç”¨ä¸­çš„å®ä¾‹æ•°é‡ã€‚åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œå¦‚æœå®ä¾‹æ•°é‡è¶…è¿‡ä¸€å®šé™åˆ¶ï¼Œå¯èƒ½éœ€è¦è€ƒè™‘æ›¿ä»£æ–¹æ¡ˆã€‚</li>
<li>ä¸éå®ä¾‹åŒ–æ¸²æŸ“çš„å…¼å®¹æ€§ï¼šåœ¨éå®ä¾‹åŒ–æ¸²æŸ“æƒ…å†µä¸‹ï¼ŒInstanceIDå§‹ç»ˆè¿”å›0ã€‚ç¡®ä¿ç€è‰²å™¨åœ¨è¿™ç§æƒ…å†µä¸‹ä¹Ÿèƒ½æ­£ç¡®å·¥ä½œã€‚</li>
</ul>
<h2 data-id="heading-5">InstanceIDèŠ‚ç‚¹ä¸å…¶ä»–èŠ‚ç‚¹çš„é…åˆä½¿ç”¨</h2>
<p>InstanceIDèŠ‚ç‚¹é€šå¸¸éœ€è¦ä¸å…¶ä»–Shader GraphèŠ‚ç‚¹é…åˆä½¿ç”¨æ‰èƒ½å‘æŒ¥æœ€å¤§æ•ˆç”¨ï¼š</p>
<p>ä¸æ•°å­¦èŠ‚ç‚¹ç»“åˆï¼Œå¯ä»¥é€šè¿‡ç®€å•çš„è¿ç®—å°†Instance IDè½¬æ¢ä¸ºæ›´æœ‰ç”¨çš„å€¼èŒƒå›´ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨å–æ¨¡è¿ç®—å°†Instance IDé™åˆ¶åœ¨ç‰¹å®šèŒƒå›´å†…ã€‚</p>
<p>ä¸çº¹ç†èŠ‚ç‚¹é…åˆï¼Œå¯ä»¥ä½¿ç”¨Instance IDä½œä¸ºUVåæ ‡æˆ–çº¹ç†æ•°ç»„çš„ç´¢å¼•ï¼Œå®ç°æ¯ä¸ªå®ä¾‹ä½¿ç”¨ä¸åŒçº¹ç†çš„æ•ˆæœã€‚</p>
<p>ä¸éšæœºèŠ‚ç‚¹ç»“åˆï¼Œå¯ä»¥å°†Instance IDä½œä¸ºéšæœºç§å­ï¼Œç”Ÿæˆæ¯ä¸ªå®ä¾‹ç‰¹æœ‰çš„éšæœºå€¼ï¼ŒåŒæ—¶ä¿è¯è¿™äº›å€¼åœ¨å¸§é—´ä¿æŒä¸€è‡´ã€‚</p>
<p>ä¸æ—¶é—´èŠ‚ç‚¹é…åˆï¼Œå¯ä»¥åˆ›å»ºåŸºäºInstance IDçš„ç›¸ä½åç§»åŠ¨ç”»ï¼Œä½¿å¤šä¸ªå®ä¾‹çš„åŠ¨ç”»æ•ˆæœé”™å¼€ï¼Œå¢åŠ è§†è§‰å¤šæ ·æ€§ã€‚</p>
<h2 data-id="heading-6">å®é™…ç¤ºä¾‹ï¼šåˆ›å»ºå®ä¾‹åŒ–é¢œè‰²å˜åŒ–æ•ˆæœ</h2>
<p>ä¸‹é¢é€šè¿‡ä¸€ä¸ªå…·ä½“ç¤ºä¾‹æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨InstanceIDèŠ‚ç‚¹ä¸ºå®ä¾‹åŒ–å¯¹è±¡åˆ›å»ºé¢œè‰²å˜åŒ–æ•ˆæœï¼š</p>
<p>é¦–å…ˆåœ¨Shader Graphä¸­åˆ›å»ºInstanceIDèŠ‚ç‚¹ï¼Œç„¶åå°†å…¶è¿æ¥åˆ°ColorèŠ‚ç‚¹çš„å„ä¸ªé€šé“ã€‚é€šè¿‡é€‚å½“çš„æ•°å­¦è¿ç®—ï¼Œå¯ä»¥å°†Instance IDæ˜ å°„åˆ°ä¸åŒçš„é¢œè‰²èŒƒå›´ã€‚</p>
<p>ä¸€ä¸ªå¸¸è§çš„åšæ³•æ˜¯ä½¿ç”¨æ­£å¼¦å‡½æ•°åŸºäºInstance IDç”Ÿæˆå¹³æ»‘çš„é¢œè‰²å˜åŒ–ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">HLSL

// ä¼ªä»£ç ç¤ºä¾‹
float <span class="hljs-attr">hue</span> = (InstanceID * <span class="hljs-number">0.1</span>) % <span class="hljs-number">1.0</span><span class="hljs-comment">;</span>
float3 <span class="hljs-attr">color</span> = HSLtoRGB(hue, <span class="hljs-number">1.0</span>, <span class="hljs-number">0.5</span>)<span class="hljs-comment">;</span>
</code></pre>
<p>åœ¨Shader Graphä¸­ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹èŠ‚ç‚¹è¿æ¥å®ç°ç±»ä¼¼æ•ˆæœï¼š</p>
<ol>
<li>å°†InstanceIDèŠ‚ç‚¹è¿æ¥åˆ°MultiplyèŠ‚ç‚¹ï¼Œä¹˜ä»¥ä¸€ä¸ªå°æ•°ï¼ˆå¦‚0.1ï¼‰æ§åˆ¶é¢œè‰²å˜åŒ–é€Ÿç‡</li>
<li>å°†ç»“æœè¿æ¥åˆ°FractionèŠ‚ç‚¹ï¼Œå–å°æ•°éƒ¨åˆ†ç¡®ä¿å€¼åœ¨0-1èŒƒå›´å†…</li>
<li>ä½¿ç”¨è¿™ä¸ªå€¼ä½œä¸ºHDR ColorèŠ‚ç‚¹çš„Hueè¾“å…¥</li>
</ol>
<p>è¿™ç§æ–¹æ³•å¯ä»¥ä¸ºæ¯ä¸ªå®ä¾‹ç”Ÿæˆç‹¬ç‰¹ä½†åè°ƒçš„é¢œè‰²ï¼Œéå¸¸é€‚åˆç”¨äºåˆ›å»ºå¤§è§„æ¨¡çš„å¯¹è±¡ç¾¤ç»„ï¼Œå¦‚è‰åœ°ã€äººç¾¤æˆ–æ˜Ÿç©ºã€‚</p>
<h2 data-id="heading-7">å®é™…ç¤ºä¾‹ï¼šå®ä¾‹åŒ–åŠ¨ç”»åç§»</h2>
<p>å¦ä¸€ä¸ªå®ç”¨ç¤ºä¾‹æ˜¯ä½¿ç”¨InstanceIDèŠ‚ç‚¹ä¸ºå®ä¾‹åŒ–å¯¹è±¡åˆ›å»ºåŠ¨ç”»åç§»ï¼š</p>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ç»„ä½¿ç”¨ç›¸åŒåŠ¨ç”»çš„å®ä¾‹ï¼Œä½†å¸Œæœ›å®ƒä»¬çš„åŠ¨ç”»ç›¸ä½ä¸åŒï¼Œé¿å…æ‰€æœ‰å®ä¾‹å®Œå…¨åŒæ­¥è¿åŠ¨ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°ï¼š</p>
<p>å°†InstanceIDèŠ‚ç‚¹è¿æ¥åˆ°MultiplyèŠ‚ç‚¹ï¼Œä¹˜ä»¥ä¸€ä¸ªæ§åˆ¶ç›¸ä½é—´éš”çš„å€¼ã€‚ç„¶åå°†ç»“æœæ·»åŠ åˆ°æ—¶é—´å˜é‡ä¸Šï¼Œä½œä¸ºæ¯ä¸ªå®ä¾‹çš„ä¸ªæ€§åŒ–æ—¶é—´è¾“å…¥ã€‚</p>
<p>åœ¨Shader Graphä¸­çš„å…·ä½“å®ç°ï¼š</p>
<ol>
<li>åˆ›å»ºTimeèŠ‚ç‚¹è·å–ç€è‰²å™¨æ—¶é—´</li>
<li>åˆ›å»ºInstanceIDèŠ‚ç‚¹è·å–å®ä¾‹æ ‡è¯†</li>
<li>ä½¿ç”¨MultiplyèŠ‚ç‚¹å°†InstanceIDä¹˜ä»¥ä¸€ä¸ªå°çš„ç›¸ä½å€¼ï¼ˆå¦‚0.2ï¼‰</li>
<li>ä½¿ç”¨AddèŠ‚ç‚¹å°†æ—¶é—´ä¸ç›¸ä½åç§»ç›¸åŠ </li>
<li>å°†è¿™ä¸ªä¸ªæ€§åŒ–æ—¶é—´ç”¨äºé©±åŠ¨åŠ¨ç”»è®¡ç®—</li>
</ol>
<p>è¿™ç§æ–¹æ³•å¯ä»¥åˆ›å»ºæ›´åŠ è‡ªç„¶å’Œæœ‰æœºçš„åŠ¨ç”»æ•ˆæœï¼Œç‰¹åˆ«é€‚ç”¨äºç¾¤ä½“åŠ¨ç”»ï¼Œå¦‚é¸Ÿç¾¤ã€é±¼ç¾¤æˆ–æ‘‡æ‘†çš„æ¤ç‰©ã€‚</p>
<h2 data-id="heading-8">æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ</h2>
<p>ä¸ºäº†ç¡®ä¿ä½¿ç”¨InstanceIDèŠ‚ç‚¹çš„ç€è‰²å™¨å…·æœ‰è‰¯å¥½çš„æ€§èƒ½ï¼Œå¯ä»¥éµå¾ªä»¥ä¸‹æœ€ä½³å®è·µï¼š</p>
<ul>
<li>å°½é‡å‡å°‘åŸºäºInstanceIDçš„å¤æ‚è®¡ç®—ï¼Œç‰¹åˆ«æ˜¯åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­</li>
<li>å°½å¯èƒ½åœ¨é¡¶ç‚¹ç€è‰²é˜¶æ®µå®ŒæˆåŸºäºInstanceIDçš„è®¡ç®—ï¼Œè€Œä¸æ˜¯åœ¨ç‰‡æ®µç€è‰²é˜¶æ®µ</li>
<li>ä½¿ç”¨é€‚å½“çš„ç²¾åº¦ä¿®é¥°ç¬¦ï¼Œåœ¨ä¿è¯è´¨é‡çš„åŒæ—¶å‡å°‘è®¡ç®—å¼€é”€</li>
<li>åœ¨ç§»åŠ¨å¹³å°ä¸Šï¼Œæµ‹è¯•ä½¿ç”¨InstanceIDçš„ç€è‰²å™¨æ€§èƒ½ï¼Œç¡®ä¿ä¸ä¼šé€ æˆå¸§ç‡ä¸‹é™</li>
<li>è€ƒè™‘ä½¿ç”¨å…¶ä»–å®ä¾‹åŒ–æŠ€æœ¯ï¼Œå¦‚GPUå®ä¾‹åŒ–å±æ€§å—ï¼Œå¯¹äºå¤§é‡ä¸åŒçš„å®ä¾‹æ•°æ®</li>
</ul>
<h2 data-id="heading-9">å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<p>åœ¨ä½¿ç”¨InstanceIDèŠ‚ç‚¹æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€äº›å¸¸è§é—®é¢˜ï¼š</p>
<p>å¦‚æœInstanceIDå§‹ç»ˆè¿”å›0ï¼Œé¦–å…ˆç¡®è®¤æ˜¯å¦çœŸæ­£å¯ç”¨äº†GPUå®ä¾‹åŒ–ã€‚æ£€æŸ¥æè´¨çš„Inspectorçª—å£ï¼Œç¡®ä¿"Enable GPU Instancing"é€‰é¡¹å·²å‹¾é€‰ã€‚åŒæ—¶ç¡®è®¤æ˜¯é€šè¿‡<code>Graphics.DrawMeshInstanced</code>æˆ–ç±»ä¼¼çš„å®ä¾‹åŒ–APIè¿›è¡Œæ¸²æŸ“ã€‚</p>
<p>å¦‚æœå®ä¾‹åŒ–å¯¹è±¡çš„é¢œè‰²æˆ–è¡Œä¸ºä¸ç¬¦åˆé¢„æœŸï¼Œæ£€æŸ¥åŸºäºInstanceIDçš„è®¡ç®—æ˜¯å¦æ­£ç¡®ã€‚ç‰¹åˆ«æ³¨æ„æ•°å€¼èŒƒå›´å’Œç²¾åº¦é—®é¢˜ï¼Œç¡®ä¿è®¡ç®—ä¸ä¼šå¯¼è‡´æ„å¤–çš„æˆªæ–­æˆ–æº¢å‡ºã€‚</p>
<p>å½“é‡åˆ°æ€§èƒ½é—®é¢˜æ—¶ï¼Œä½¿ç”¨Unityçš„Frame Debuggeråˆ†æç»˜åˆ¶è°ƒç”¨å’Œå®ä¾‹åŒ–æƒ…å†µã€‚ç¡®è®¤å®ä¾‹åŒ–ç¡®å®æŒ‰é¢„æœŸå·¥ä½œï¼Œå¹¶ä¸”æ²¡æœ‰æ„å¤–çš„æ‰¹å¤„ç†ä¸­æ–­ã€‚</p>
<hr/>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong>
ï¼ˆæ¬¢è¿<em>ç‚¹èµç•™è¨€</em>æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ThreadLocal åœ¨å®é™…é¡¹ç›®ä¸­çš„ 6 å¤§ç”¨æ³•ï¼ŒåŸæ¥å¯ä»¥è¿™ä¹ˆç®€å•]]></title>    <link>https://juejin.cn/post/7598699872539738131</link>    <guid>https://juejin.cn/post/7598699872539738131</guid>    <pubDate>2026-01-24T00:56:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598699872539738131" data-draft-id="7589093939655983156" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ThreadLocal åœ¨å®é™…é¡¹ç›®ä¸­çš„ 6 å¤§ç”¨æ³•ï¼ŒåŸæ¥å¯ä»¥è¿™ä¹ˆç®€å•"/> <meta itemprop="keywords" content="åç«¯,Java"/> <meta itemprop="datePublished" content="2026-01-24T00:56:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å¤§å"/> <meta itemprop="url" content="https://juejin.cn/user/3507878440995946"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ThreadLocal åœ¨å®é™…é¡¹ç›®ä¸­çš„ 6 å¤§ç”¨æ³•ï¼ŒåŸæ¥å¯ä»¥è¿™ä¹ˆç®€å•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3507878440995946/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å¤§å
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-24T00:56:54.000Z" title="Sat Jan 24 2026 00:56:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-24
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä½ çš„ç³»ç»Ÿéœ€è¦è®°å½•æ¯ä¸ªç”¨æˆ·çš„æ“ä½œæ—¥å¿—ï¼ŒåŒ…æ‹¬ç”¨æˆ·IDã€æ“ä½œæ—¶é—´ã€æ“ä½œå†…å®¹ç­‰ã€‚åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œè¿™å¾ˆç®€å•ï¼Œä¸€ä¸ªå…¨å±€å˜é‡å°±å¤Ÿäº†ã€‚</p>
<p>ä½†åˆ°äº†Webåº”ç”¨ä¸­ï¼Œä¸€ä¸ªè¯·æ±‚ä¸€ä¸ªçº¿ç¨‹ï¼Œå¤šä¸ªç”¨æˆ·åŒæ—¶æ“ä½œï¼Œæ€ä¹ˆä¿è¯Aç”¨æˆ·çš„æ“ä½œä¸ä¼šè¢«è®°å½•æˆBç”¨æˆ·å‘¢ï¼Ÿ</p>
<p>ä½ å¯èƒ½ä¼šæƒ³åˆ°åœ¨æ¯ä¸ªæ–¹æ³•é‡Œéƒ½ä¼ é€’ç”¨æˆ·ä¿¡æ¯ï¼Œä½†è¿™æ ·å¤ªéº»çƒ¦äº†ã€‚</p>
<p>è¿™å°±æ˜¯ <code>ThreadLocal</code> è¦è§£å†³çš„æ ¸å¿ƒé—®é¢˜ï¼šåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå¦‚ä½•åœ¨ä¸ä¼ é€’å‚æ•°çš„æƒ…å†µä¸‹ï¼Œè®©åŒä¸€ä¸ªçº¿ç¨‹å†…çš„å¤šä¸ªæ–¹æ³•å…±äº«æ•°æ®ï¼ŒåŒæ—¶åˆä¸ä¼šå½±å“å…¶ä»–çº¿ç¨‹ï¼Ÿ</p>
<h2 data-id="heading-1">ThreadLocalæ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>ç®€å•ç†è§£ï¼Œ<code>ThreadLocal</code> æ˜¯ä¸€ä¸ªè®©æ¯ä¸ªçº¿ç¨‹æ‹¥æœ‰è‡ªå·±ç‹¬ç«‹å˜é‡å‰¯æœ¬çš„å®¹å™¨ã€‚</p>
<p>å¯¹åŒä¸€ä¸ª <code>ThreadLocal</code> å®ä¾‹çš„ <code>get()/set()</code>ï¼Œä¸åŒçº¿ç¨‹çœ‹åˆ°çš„æ˜¯ä¸åŒçš„æ•°æ®ï¼Œäº’ä¸å¹²æ‰°ã€‚</p>
<p>çœ‹ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserContext</span> {
    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªThreadLocalå˜é‡ï¼Œç”¨æ¥å­˜å‚¨ç”¨æˆ·ID</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;String&gt; userIdHolder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
    
    <span class="hljs-comment">// è®¾ç½®ç”¨æˆ·ID</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUserId</span><span class="hljs-params">(String userId)</span> {
        userIdHolder.set(userId);
    }
    
    <span class="hljs-comment">// è·å–ç”¨æˆ·ID</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getUserId</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> userIdHolder.get();
    }
    
    <span class="hljs-comment">// æ¸…ç†ç”¨æˆ·ID</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span> {
        userIdHolder.remove();
    }
}
</code></pre>
<p>ä½¿ç”¨èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">try</span> {
    UserContext.setUserId(userId);
    <span class="hljs-comment">// ä¸šåŠ¡å¤„ç†...</span>
} <span class="hljs-keyword">finally</span> {
    <span class="hljs-comment">// ç¡®ä¿å¤„ç†å®Œè¯·æ±‚åï¼Œæ— è®ºå¦‚ä½•éƒ½ä¼šæ¸…ç†</span>
    UserContext.clear(); 
}

<span class="hljs-comment">// åœ¨åç»­çš„ä¸šåŠ¡é€»è¾‘ä¸­ï¼Œä»»ä½•åœ°æ–¹éƒ½å¯ä»¥è·å–åˆ°è¿™ä¸ªç”¨æˆ·ID</span>
<span class="hljs-type">String</span> <span class="hljs-variable">userId</span> <span class="hljs-operator">=</span> UserContext.getUserId();
</code></pre>
<p>æ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Ÿä¸ç”¨åœ¨æ¯ä¸ªæ–¹æ³•å‚æ•°é‡Œä¼ é€’ç”¨æˆ·IDï¼Œä»»ä½•åœ°æ–¹éƒ½å¯ä»¥è·å–åˆ°å½“å‰çº¿ç¨‹çš„ç”¨æˆ·ä¿¡æ¯ã€‚</p>
<h2 data-id="heading-2">ThreadLocalæ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ</h2>
<p>å¾ˆå¤šäººä»¥ä¸º <code>ThreadLocal</code> åªæ˜¯ç®€å•çš„æŠŠå˜é‡å¤åˆ¶åˆ°æ¯ä¸ªçº¿ç¨‹ï¼Œå…¶å®ä¸æ˜¯è¿™æ ·ã€‚</p>
<p>å®ƒçš„åŸç†æ˜¯è¿™æ ·çš„ï¼š</p>
<ol>
<li>æ¯ä¸ªçº¿ç¨‹ï¼ˆThreadå¯¹è±¡ï¼‰å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªç‰¹æ®Šçš„Mapï¼Œå«åš <code>ThreadLocalMap</code>ã€‚</li>
<li>å½“ä½ è°ƒç”¨ <code>threadLocal.set(value)</code> æ—¶ï¼Œå®é™…ä¸Šæ˜¯æŠŠ value æ”¾åˆ°äº†å½“å‰çº¿ç¨‹çš„ <code>ThreadLocalMap</code> ä¸­ï¼Œkey æ˜¯è¿™ä¸ª ThreadLocal å¯¹è±¡ã€‚</li>
<li>å½“ä½ è°ƒç”¨ <code>threadLocal.get()</code> æ—¶ï¼Œå®é™…ä¸Šæ˜¯å»å½“å‰çº¿ç¨‹çš„ ThreadLocalMap ä¸­ï¼Œæ‰¾è¿™ä¸ª ThreadLocal å¯¹è±¡å¯¹åº”çš„ valueã€‚</li>
</ol>
<p>å¯ä»¥æƒ³è±¡æˆæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªå°æœ¬æœ¬ï¼ˆThreadLocalMapï¼‰ï¼Œè¿™ä¸ªå°æœ¬æœ¬ä¸Šè®°å½•ç€å„ç§ <code>ThreadLocal</code> å˜é‡çš„å€¼ã€‚</p>
<p>å½“ä½ è°ƒç”¨æŸä¸ª <code>ThreadLocal</code> çš„ get æ–¹æ³•ï¼Œå°±æ˜¯åœ¨å°æœ¬æœ¬ä¸ŠæŸ¥æ‰¾å¯¹åº”çš„å†…å®¹ã€‚</p>
<h2 data-id="heading-3">ThreadLocal ä½¿ç”¨åœºæ™¯å’Œç¤ºä¾‹</h2>
<h3 data-id="heading-4">1. ç”¨æˆ·ä¼šè¯ç®¡ç†ï¼ˆæœ€å¸¸ç”¨ï¼‰</h3>
<p>åœ¨Webå¼€å‘ä¸­ï¼Œè¿™æ˜¯æœ€ç»å…¸çš„ä½¿ç”¨åœºæ™¯ã€‚ç”¨æˆ·ç™»å½•åï¼Œå°†ç”¨æˆ·ä¿¡æ¯å­˜å…¥ <code>ThreadLocal</code>ï¼Œåœ¨åç»­çš„ä»»ä½•åœ°æ–¹éƒ½èƒ½è·å–ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ç”¨æˆ·ä¸Šä¸‹æ–‡å·¥å…·ç±»</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserContext</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;UserInfo&gt; currentUser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUser</span><span class="hljs-params">(UserInfo user)</span> {
        currentUser.set(user);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> UserInfo <span class="hljs-title function_">getUser</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> currentUser.get();
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Long <span class="hljs-title function_">getUserId</span><span class="hljs-params">()</span> {
        <span class="hljs-type">UserInfo</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> currentUser.get();
        <span class="hljs-keyword">return</span> user != <span class="hljs-literal">null</span> ? user.getId() : <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getUsername</span><span class="hljs-params">()</span> {
        <span class="hljs-type">UserInfo</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> currentUser.get();
        <span class="hljs-keyword">return</span> user != <span class="hljs-literal">null</span> ? user.getUsername() : <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span> {
        currentUser.remove();
    }
}

<span class="hljs-comment">// åœ¨æ‹¦æˆªå™¨ä¸­è®¾ç½®ç”¨æˆ·ä¿¡æ¯</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AuthInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerInterceptor</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> {
        <span class="hljs-comment">// ä»tokenæˆ–sessionä¸­è·å–ç”¨æˆ·ä¿¡æ¯</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> request.getHeader(<span class="hljs-string">"Authorization"</span>);
        <span class="hljs-type">UserInfo</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> authService.getUserByToken(token);
        
        <span class="hljs-keyword">if</span> (user != <span class="hljs-literal">null</span>) {
            UserContext.setUser(user);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> {
        <span class="hljs-comment">// è¯·æ±‚ç»“æŸåæ¸…ç†ThreadLocalï¼Œé˜²æ­¢å†…å­˜æ³„æ¼</span>
        UserContext.clear();
    }
}

<span class="hljs-comment">// åœ¨ä¸šåŠ¡ä»£ç ä¸­ç›´æ¥ä½¿ç”¨</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrder</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-comment">// ç›´æ¥è·å–å½“å‰ç”¨æˆ·IDï¼Œä¸éœ€è¦ä»å‚æ•°ä¼ é€’</span>
        <span class="hljs-type">Long</span> <span class="hljs-variable">userId</span> <span class="hljs-operator">=</span> UserContext.getUserId();
        order.setUserId(userId);
        order.setCreateBy(UserContext.getUsername());
        
        <span class="hljs-comment">// å…¶ä»–ä¸šåŠ¡é€»è¾‘...</span>
        orderDao.save(order);
        
        <span class="hljs-comment">// è®°å½•æ“ä½œæ—¥å¿—</span>
        logService.log(userId, <span class="hljs-string">"åˆ›å»ºè®¢å•"</span>);
    }
}
</code></pre>
<h3 data-id="heading-5">2. æ—¥æœŸæ ¼å¼åŒ–å·¥å…·</h3>
<p><code>SimpleDateFormat</code> æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œç”¨ <code>ThreadLocal</code> å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹ï¼šå¤šçº¿ç¨‹ä¸‹ä¼šå‡ºé—®é¢˜</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DateUtils</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">SimpleDateFormat</span> <span class="hljs-variable">sdf</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">"yyyy-MM-dd HH:mm:ss"</span>);
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">format</span><span class="hljs-params">(Date date)</span> {
        <span class="hljs-keyword">return</span> sdf.format(date);  <span class="hljs-comment">// å¤šçº¿ç¨‹å¹¶å‘æ—¶ä¼šå‡ºé”™ï¼</span>
    }
}

<span class="hljs-comment">// æ­£ç¡®ç¤ºä¾‹ï¼šä½¿ç”¨ThreadLocal</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadSafeDateUtils</span> {
    <span class="hljs-comment">// æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„SimpleDateFormatå®ä¾‹</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;SimpleDateFormat&gt; threadLocal = 
        ThreadLocal.withInitial(() -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleDateFormat</span>(<span class="hljs-string">"yyyy-MM-dd HH:mm:ss"</span>));
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">format</span><span class="hljs-params">(Date date)</span> {
        <span class="hljs-keyword">return</span> threadLocal.get().format(date);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Date <span class="hljs-title function_">parse</span><span class="hljs-params">(String dateStr)</span> <span class="hljs-keyword">throws</span> ParseException {
        <span class="hljs-keyword">return</span> threadLocal.get().parse(dateStr);
    }
    
    <span class="hljs-comment">// ä½¿ç”¨åæ¸…ç†ï¼ˆå¯é€‰ï¼Œå› ä¸ºDateFormatå¯¹è±¡å¯ä»¥å¤ç”¨ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span> {
        threadLocal.remove();
    }
}
</code></pre>
<h3 data-id="heading-6">3. åˆ†é¡µä¿¡æ¯ç®¡ç†</h3>
<p>åœ¨åˆ†é¡µæŸ¥è¯¢ä¸­ï¼ŒThreadLocalå¯ä»¥ä¿å­˜åˆ†é¡µå‚æ•°ï¼Œåœ¨Serviceå’ŒDaoå±‚éƒ½èƒ½è·å–ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PageContext</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;Integer&gt; PAGE_NO = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;Integer&gt; PAGE_SIZE = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPageInfo</span><span class="hljs-params">(Integer pageNo, Integer pageSize)</span> {
        PAGE_NO.set(pageNo);
        PAGE_SIZE.set(pageSize);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Integer <span class="hljs-title function_">getPageNo</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Integer</span> <span class="hljs-variable">pageNo</span> <span class="hljs-operator">=</span> PAGE_NO.get();
        <span class="hljs-keyword">return</span> pageNo != <span class="hljs-literal">null</span> ? pageNo : <span class="hljs-number">1</span>; <span class="hljs-comment">// é»˜è®¤ç¬¬ä¸€é¡µ</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Integer <span class="hljs-title function_">getPageSize</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Integer</span> <span class="hljs-variable">pageSize</span> <span class="hljs-operator">=</span> PAGE_SIZE.get();
        <span class="hljs-keyword">return</span> pageSize != <span class="hljs-literal">null</span> ? pageSize : <span class="hljs-number">20</span>; <span class="hljs-comment">// é»˜è®¤20æ¡</span>
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span> {
        PAGE_NO.remove();
        PAGE_SIZE.remove();
    }
}

<span class="hljs-comment">// åœ¨Controllerä¸­ä½¿ç”¨</span>
<span class="hljs-meta">@GetMapping("/users")</span>
<span class="hljs-keyword">public</span> PageResult&lt;User&gt; <span class="hljs-title function_">getUsers</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(defaultValue = "1")</span> Integer pageNo,
                                 <span class="hljs-meta">@RequestParam(defaultValue = "20")</span> Integer pageSize)</span> {
    <span class="hljs-keyword">try</span> {
        PageContext.setPageInfo(pageNo, pageSize);
        <span class="hljs-keyword">return</span> userService.getUserList();
    } <span class="hljs-keyword">finally</span> {
        PageContext.clear();
    }
}
</code></pre>
<h3 data-id="heading-7">4. æ•°æ®åº“è¿æ¥ç®¡ç†</h3>
<p>åœ¨ä¸€äº›æ¡†æ¶ä¸­ï¼Œä¸ºäº†ç¡®ä¿åŒä¸€ä¸ªäº‹åŠ¡ä¸­ä½¿ç”¨åŒä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œä¼šç”¨åˆ° <code>ThreadLocal</code>ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConnectionHolder</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;Connection&gt; connectionHolder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Connection <span class="hljs-title function_">getConnection</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> connectionHolder.get();
        <span class="hljs-keyword">if</span> (conn == <span class="hljs-literal">null</span>) {
            conn = DataSourceUtils.getConnection();
            connectionHolder.set(conn);
        }
        <span class="hljs-keyword">return</span> conn;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setConnection</span><span class="hljs-params">(Connection conn)</span> {
        connectionHolder.set(conn);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clearConnection</span><span class="hljs-params">()</span> {
        <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> connectionHolder.get();
        <span class="hljs-keyword">if</span> (conn != <span class="hljs-literal">null</span>) {
            DataSourceUtils.releaseConnection(conn);
        }
        connectionHolder.remove();
    }
}
</code></pre>
<h3 data-id="heading-8">5. å…¨å±€å‚æ•°ä¼ é€’</h3>
<p>é¿å…åœ¨æ–¹æ³•è°ƒç”¨é“¾ä¸­å±‚å±‚ä¼ é€’ç›¸åŒå‚æ•°ï¼Œç®€åŒ–ä»£ç ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¸ç”¨ThreadLocalï¼Œå‚æ•°ä¼ é€’å¾ˆç—›è‹¦</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processOrder</span><span class="hljs-params">(String traceId, String userId, Order order)</span> {
    validateOrder(traceId, userId, order);
    checkInventory(traceId, userId, order);
    createLog(traceId, userId, order);
    <span class="hljs-comment">// ... æ›´å¤šè°ƒç”¨</span>
}

<span class="hljs-comment">// ä½¿ç”¨ThreadLocalï¼Œæ¸…çˆ½å¤šäº†</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processOrder</span><span class="hljs-params">(Order order)</span> {
    <span class="hljs-comment">// åœ¨å…¥å£å¤„è®¾ç½®</span>
    TraceContext.setTraceId(UUID.randomUUID().toString());
    UserContext.setUserId(getCurrentUserId());
    
    validateOrder(order);
    checkInventory(order);
    createLog(order);
}
</code></pre>
<h3 data-id="heading-9">6. åˆ†å¸ƒå¼è¿½è¸ªIDä¼ é€’</h3>
<p>åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œä¸€ä¸ªè¯·æ±‚å¯èƒ½ä¼šç»è¿‡å¤šä¸ªæœåŠ¡ï¼Œéœ€è¦æœ‰ä¸€ä¸ªtraceIdæ¥è¿½è¸ªæ•´ä¸ªè°ƒç”¨é“¾ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TraceFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Filter</span> {
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doFilter</span><span class="hljs-params">(ServletRequest request, ServletResponse response, 
                         FilterChain chain)</span> <span class="hljs-keyword">throws</span> IOException, ServletException {
        
        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">httpRequest</span> <span class="hljs-operator">=</span> (HttpServletRequest) request;
        <span class="hljs-type">String</span> <span class="hljs-variable">traceId</span> <span class="hljs-operator">=</span> httpRequest.getHeader(<span class="hljs-string">"X-Trace-ID"</span>);
        
        <span class="hljs-keyword">if</span> (traceId == <span class="hljs-literal">null</span> || traceId.isEmpty()) {
            traceId = UUID.randomUUID().toString();
        }
        
        <span class="hljs-comment">// è®¾ç½®åˆ°ThreadLocal</span>
        TraceContext.setTraceId(traceId);
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// åœ¨MDCä¸­ä¹Ÿè®¾ç½®ï¼Œæ–¹ä¾¿æ—¥å¿—æ‰“å°</span>
            MDC.put(<span class="hljs-string">"traceId"</span>, traceId);
            
            <span class="hljs-comment">// ç»§ç»­å¤„ç†è¯·æ±‚</span>
            chain.doFilter(request, response);
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// ä¸€å®šè¦æ¸…ç†ï¼ï¼ï¼</span>
            TraceContext.clear();
            MDC.clear();
        }
    }
}
</code></pre>
<h2 data-id="heading-10">ThreadLocal å¯èƒ½å‡ºç°çš„é—®é¢˜</h2>
<h3 data-id="heading-11">1. å†…å­˜æ³„æ¼ï¼ˆæœ€é‡è¦çš„é—®é¢˜ï¼ï¼‰</h3>
<p>è¿™æ˜¯ThreadLocalæœ€å®¹æ˜“è¢«å¿½è§†ï¼Œä¹Ÿæ˜¯æœ€å±é™©çš„é—®é¢˜ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸ºä»€ä¹ˆä¼šå†…å­˜æ³„æ¼ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryLeakExample</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;BigObject&gt; holder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">process</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// è®¾ç½®ä¸€ä¸ªå¤§å¯¹è±¡</span>
        holder.set(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigObject</span>()); <span class="hljs-comment">// å‡è®¾BigObjectå ç”¨100MBå†…å­˜</span>
        
        <span class="hljs-comment">// æ‰§è¡Œä¸šåŠ¡é€»è¾‘...</span>
        <span class="hljs-comment">// ...</span>
        
        <span class="hljs-comment">// å¿˜è®°è°ƒç”¨ holder.remove() äº†ï¼</span>
    }
}
</code></pre>
<p><strong>é—®é¢˜</strong>ï¼š</p>
<ul>
<li>å½“æ–¹æ³•æ‰§è¡Œå®Œåï¼Œ<code>ThreadLocal</code> å¯¹è±¡æœ¬èº«ï¼ˆholderï¼‰å¯èƒ½è¢«å›æ”¶</li>
<li>ä½† <code>ThreadLocalMap</code> ä¸­ï¼ŒBigObject è¿™ä¸ª 100MB çš„å¯¹è±¡ä»ç„¶è¢«å¼•ç”¨ç€</li>
<li>å¦‚æœè¿™ä¸ªçº¿ç¨‹æ˜¯çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ï¼Œä¼šè¢«å¤ç”¨ï¼Œæ°¸è¿œä¸ä¼šè¢«GCå›æ”¶</li>
<li>éšç€è¯·æ±‚å¢å¤šï¼Œå†…å­˜å ç”¨ä¼šè¶Šæ¥è¶Šå¤§ï¼Œæœ€ç»ˆå¯¼è‡´OOM</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ</strong> çœ‹ä¸€ä¸‹ <code>ThreadLocalMap</code> çš„å†…éƒ¨ç»“æ„ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadLocalMap</span> {
    <span class="hljs-comment">// Entryç»§æ‰¿äº†WeakReferenceï¼Œkeyæ˜¯å¼±å¼•ç”¨</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Entry</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">WeakReference</span>&lt;ThreadLocal&lt;?&gt;&gt; {
        Object value; <span class="hljs-comment">// valueæ˜¯å¼ºå¼•ç”¨ï¼</span>
    }
    
    <span class="hljs-keyword">private</span> Entry[] table;
}
</code></pre>
<p>å†…å­˜æ³„æ¼çš„ä¸¤ç§æƒ…å†µï¼š</p>
<p><strong>1.ThreadLocal å¯¹è±¡è¢«å›æ”¶ï¼Œä½†valueè¿˜åœ¨</strong></p>
<ul>
<li>keyæ˜¯å¼±å¼•ç”¨ï¼Œ<code>ThreadLocal</code> å¯¹è±¡è¢«å›æ”¶åï¼Œkeyå˜æˆnull</li>
<li>ä½†valueæ˜¯å¼ºå¼•ç”¨ï¼Œè¿˜åœ¨ <code>Entry</code> ä¸­è¢«å¼•ç”¨ç€</li>
<li>å¦‚æœçº¿ç¨‹ä¸ç»“æŸï¼Œè¿™ä¸ªvalueå°±æ°¸è¿œæ— æ³•è¢«å›æ”¶</li>
</ul>
<p><strong>2.çº¿ç¨‹ç»“æŸï¼Œä½† ThreadLocalMap è¿˜åœ¨</strong></p>
<ul>
<li><code>Thread</code> å¯¹è±¡æœ‰ <code>ThreadLocalMap</code> çš„å¼•ç”¨</li>
<li><code>Thread</code> ç»“æŸï¼ŒThread å¯¹è±¡å¯ä»¥è¢«å›æ”¶</li>
<li>ä½†å¦‚æœ <code>ThreadLocal</code> å¯¹è±¡è¿˜è¢«å…¶ä»–åœ°æ–¹å¼•ç”¨ï¼Œå°±å¯èƒ½å¯¼è‡´ <code>ThreadLocalMap</code> æ— æ³•è¢«å®Œå…¨å›æ”¶</li>
</ul>
<h3 data-id="heading-12">2. çº¿ç¨‹æ± ä¸­çš„å€¼æ±¡æŸ“</h3>
<p>åœ¨çº¿ç¨‹æ± ç¯å¢ƒä¸‹ï¼Œçº¿ç¨‹ä¼šè¢«å¤ç”¨ã€‚å¦‚æœä¸Šä¸€ä¸ªä»»åŠ¡è®¾ç½®äº†ThreadLocalå€¼ä½†æ²¡æœ‰æ¸…ç†ï¼Œä¸‹ä¸€ä¸ªä»»åŠ¡å¯èƒ½ä¼šè¯»åˆ°é”™è¯¯çš„å€¼ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// çº¿ç¨‹æ± </span>
<span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newFixedThreadPool(<span class="hljs-number">5</span>);

<span class="hljs-comment">// ä»»åŠ¡1ï¼šç”¨æˆ·Açš„æ“ä½œ</span>
executor.execute(() -&gt; {
    UserContext.setUserId(<span class="hljs-string">"userA"</span>);
    <span class="hljs-comment">// æ‰§è¡Œä¸šåŠ¡é€»è¾‘...</span>
    <span class="hljs-comment">// å¿˜è®°æ¸…ç†äº†ï¼</span>
});

<span class="hljs-comment">// ä»»åŠ¡2ï¼šç”¨æˆ·Bçš„æ“ä½œ</span>
executor.execute(() -&gt; {
    <span class="hljs-comment">// è¿™é‡Œå¯èƒ½è·å–åˆ°userAçš„IDï¼</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">userId</span> <span class="hljs-operator">=</span> UserContext.getUserId();
    System.out.println(<span class="hljs-string">"å½“å‰ç”¨æˆ·ï¼š"</span> + userId); <span class="hljs-comment">// è¾“å‡ºï¼šuserA</span>
});
</code></pre>
<h3 data-id="heading-13">3. çˆ¶å­çº¿ç¨‹å€¼ä¼ é€’é—®é¢˜</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå­çº¿ç¨‹æ— æ³•è·å–çˆ¶çº¿ç¨‹çš„ <code>ThreadLocal</code> å€¼ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ParentChildExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;String&gt; holder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        holder.set(<span class="hljs-string">"çˆ¶çº¿ç¨‹çš„å€¼"</span>);
        
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-comment">// å­çº¿ç¨‹è·å–ä¸åˆ°çˆ¶çº¿ç¨‹çš„å€¼</span>
            System.out.println(<span class="hljs-string">"å­çº¿ç¨‹ï¼š"</span> + holder.get()); <span class="hljs-comment">// è¾“å‡ºï¼šnull</span>
        }).start();
    }
}
</code></pre>
<h2 data-id="heading-14">ThreadLocal é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-15">æ–¹æ¡ˆ1ï¼šä¸€å®šè¦è®°å¾—æ¸…ç†ï¼ˆæœ€é‡è¦ï¼ï¼‰</h3>
<p><strong>é»„é‡‘æ³•åˆ™</strong>ï¼šæ¯æ¬¡ä½¿ç”¨å®ŒThreadLocalï¼Œä¸€å®šè¦è°ƒç”¨<code>remove()</code>æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeUserContext</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;User&gt; context = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">set</span><span class="hljs-params">(User user)</span> {
        context.set(user);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> User <span class="hljs-title function_">get</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> context.get();
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span> {
        context.remove(); <span class="hljs-comment">// æ¸…ç†ï¼</span>
    }
}

<span class="hljs-comment">// ä½¿ç”¨try-finallyç¡®ä¿ä¸€å®šä¼šæ¸…ç†</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processRequest</span><span class="hljs-params">(HttpServletRequest request)</span> {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> parseUser(request);
        SafeUserContext.set(user);
        
        <span class="hljs-comment">// æ‰§è¡Œä¸šåŠ¡é€»è¾‘</span>
        doBusiness();
        
    } <span class="hljs-keyword">finally</span> {
        <span class="hljs-comment">// æ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸ï¼Œéƒ½ä¼šæ‰§è¡Œæ¸…ç†</span>
        SafeUserContext.clear();
    }
}
</code></pre>
<h3 data-id="heading-16">æ–¹æ¡ˆ2ï¼šä½¿ç”¨æ‹¦æˆªå™¨/è¿‡æ»¤å™¨ç»Ÿä¸€ç®¡ç†</h3>
<p>åœ¨Webåº”ç”¨ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ‹¦æˆªå™¨æˆ–è¿‡æ»¤å™¨ç»Ÿä¸€ç®¡ç†ThreadLocalçš„ç”Ÿå‘½å‘¨æœŸã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ThreadLocalCleanInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HandlerInterceptor</span> {
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">preHandle</span><span class="hljs-params">(HttpServletRequest request, 
                            HttpServletResponse response, Object handler)</span> {
        <span class="hljs-comment">// åœ¨è¯·æ±‚å¼€å§‹æ—¶è®¾ç½®ThreadLocal</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">traceId</span> <span class="hljs-operator">=</span> request.getHeader(<span class="hljs-string">"X-Trace-ID"</span>);
        TraceContext.setTraceId(traceId);
        
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterCompletion</span><span class="hljs-params">(HttpServletRequest request, 
                               HttpServletResponse response, 
                               Object handler, Exception ex)</span> {
        <span class="hljs-comment">// è¯·æ±‚ç»“æŸåæ¸…ç†æ‰€æœ‰ThreadLocal</span>
        TraceContext.clear();
        UserContext.clear();
        PageContext.clear();
        <span class="hljs-comment">// ... æ¸…ç†å…¶ä»–ThreadLocal</span>
    }
}
</code></pre>
<h3 data-id="heading-17">æ–¹æ¡ˆ3ï¼šä½¿ç”¨InheritableThreadLocalä¼ é€’å€¼</h3>
<p>å¦‚æœéœ€è¦çˆ¶å­çº¿ç¨‹é—´ä¼ é€’å€¼ï¼Œå¯ä»¥ä½¿ç”¨<code>InheritableThreadLocal</code>ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InheritableContext</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> InheritableThreadLocal&lt;String&gt; context = 
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">InheritableThreadLocal</span>&lt;&gt;();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        context.set(<span class="hljs-string">"çˆ¶çº¿ç¨‹çš„å€¼"</span>);
        
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-comment">// å­çº¿ç¨‹å¯ä»¥è·å–åˆ°çˆ¶çº¿ç¨‹çš„å€¼</span>
            System.out.println(<span class="hljs-string">"å­çº¿ç¨‹ï¼š"</span> + context.get()); <span class="hljs-comment">// è¾“å‡ºï¼šçˆ¶çº¿ç¨‹çš„å€¼</span>
            
            <span class="hljs-comment">// å­çº¿ç¨‹ä¿®æ”¹å€¼ï¼Œä¸ä¼šå½±å“çˆ¶çº¿ç¨‹</span>
            context.set(<span class="hljs-string">"å­çº¿ç¨‹ä¿®æ”¹åçš„å€¼"</span>);
        }).start();
        
        Thread.sleep(<span class="hljs-number">100</span>);
        System.out.println(<span class="hljs-string">"çˆ¶çº¿ç¨‹ï¼š"</span> + context.get()); <span class="hljs-comment">// è¾“å‡ºï¼šçˆ¶çº¿ç¨‹çš„å€¼</span>
    }
}
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼šçº¿ç¨‹æ± åœºæ™¯ä¸‹æ…ç”¨ï¼Œå› ä¸ºçº¿ç¨‹æ˜¯å¤ç”¨çš„ï¼Œä¸æ˜¯æ–°åˆ›å»ºçš„ã€‚</p>
<h3 data-id="heading-18">æ–¹æ¡ˆ4ï¼šä½¿ç”¨é˜¿é‡Œå¼€æºçš„ TransmittableThreadLocal</h3>
<p>å¯¹äºçº¿ç¨‹æ± åœºæ™¯ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨é˜¿é‡Œçš„<code>TransmittableThreadLocal</code>ï¼Œå®ƒæ˜¯<code>InheritableThreadLocal</code>çš„å¢å¼ºç‰ˆã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- æ·»åŠ ä¾èµ– --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>transmittable-thread-local<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.14.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TransmittableExample</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> TransmittableThreadLocal&lt;String&gt; context = 
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransmittableThreadLocal</span>&lt;&gt;();
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newFixedThreadPool(<span class="hljs-number">2</span>);
        
        <span class="hljs-comment">// ä½¿ç”¨TtlExecutorsåŒ…è£…çº¿ç¨‹æ± </span>
        <span class="hljs-type">ExecutorService</span> <span class="hljs-variable">ttlExecutor</span> <span class="hljs-operator">=</span> TtlExecutors.getTtlExecutorService(executor);
        
        context.set(<span class="hljs-string">"value-1"</span>);
        
        ttlExecutor.execute(() -&gt; {
            System.out.println(<span class="hljs-string">"ä»»åŠ¡1ï¼š"</span> + context.get()); <span class="hljs-comment">// è¾“å‡ºï¼švalue-1</span>
        });
        
        context.set(<span class="hljs-string">"value-2"</span>);
        
        ttlExecutor.execute(() -&gt; {
            System.out.println(<span class="hljs-string">"ä»»åŠ¡2ï¼š"</span> + context.get()); <span class="hljs-comment">// è¾“å‡ºï¼švalue-2</span>
        });
    }
}
</code></pre>
<h3 data-id="heading-19">æ–¹æ¡ˆ5ï¼šThreadLocalçš„å°è£…</h3>
<p>æˆ‘ä»¬å¯ä»¥å°è£…ä¸€ä¸ªå®‰å…¨çš„ThreadLocalå·¥å…·ç±»ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeThreadLocal</span>&lt;T&gt; {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;T&gt; threadLocal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadLocal</span>&lt;&gt;();
    
    <span class="hljs-comment">// è®¾ç½®å€¼ï¼Œå¹¶è¿”å›ä¸€ä¸ªCleanupå¯¹è±¡</span>
    <span class="hljs-keyword">public</span> Cleanup <span class="hljs-title function_">set</span><span class="hljs-params">(T value)</span> {
        threadLocal.set(value);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cleanup</span>();
    }
    
    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">get</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> threadLocal.get();
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">remove</span><span class="hljs-params">()</span> {
        threadLocal.remove();
    }
    
    <span class="hljs-comment">// Cleanupç±»ï¼Œç”¨äºè‡ªåŠ¨æ¸…ç†</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Cleanup</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AutoCloseable</span> {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
            threadLocal.remove();
        }
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹ï¼štry-with-resourcesè‡ªåŠ¨æ¸…ç†</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">process</span><span class="hljs-params">()</span> {
    SafeThreadLocal&lt;String&gt; safeHolder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SafeThreadLocal</span>&lt;&gt;();
    
    <span class="hljs-keyword">try</span> (SafeThreadLocal&lt;String&gt;.<span class="hljs-type">Cleanup</span> <span class="hljs-variable">cleanup</span> <span class="hljs-operator">=</span> safeHolder.set(<span class="hljs-string">"value"</span>)) {
        <span class="hljs-comment">// æ‰§è¡Œä¸šåŠ¡é€»è¾‘</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> safeHolder.get();
        <span class="hljs-comment">// ...</span>
    } <span class="hljs-comment">// è¿™é‡Œä¼šè‡ªåŠ¨è°ƒç”¨cleanup.close()ï¼Œæ¸…ç†ThreadLocal</span>
}
</code></pre>
<h2 data-id="heading-20">å†™åœ¨æœ€å</h2>
<p><code>ThreadLocal</code> æ˜¯Javaå¹¶å‘ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦å·¥å…·ï¼Œå®ƒè§£å†³äº†å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„æ•°æ®éš”ç¦»é—®é¢˜ã€‚ä½†ä»»ä½•å¼ºå¤§çš„å·¥å…·ä¸€æ ·ï¼Œå®ƒéƒ½éœ€è¦è¢«æ­£ç¡®çš„ä½¿ç”¨ã€‚</p>
<p><strong>è¯¥ç”¨ThreadLocalçš„æ—¶å€™</strong>ï¼š</p>
<ol>
<li>éœ€è¦åœ¨çº¿ç¨‹å†…å…±äº«æ•°æ®ï¼Œä½†ä¸æƒ³ç”¨æ–¹æ³•å‚æ•°ä¼ é€’</li>
<li>éœ€è¦ä¿è¯çº¿ç¨‹å®‰å…¨çš„æ•°æ®éš”ç¦»</li>
<li>å·¥å…·ç±»éœ€è¦çº¿ç¨‹å®‰å…¨ä½†ä¸æƒ³ç”¨åŒæ­¥é”</li>
</ol>
<p>çœ‹åˆ°è¿™ï¼Œç›¸ä¿¡ä½ å¯¹ <code>ThreadLocal</code> å·²ç»ä¸å†æ˜¯é‚£ä¹ˆé™Œç”Ÿäº†ã€‚</p>
<blockquote>
<p>æœ¬æ–‡é¦–å‘äºå…¬ä¼—å·ï¼šç¨‹åºå‘˜å¤§åï¼Œä¸“æ³¨åˆ†äº«å‰åç«¯å¼€å‘çš„å®æˆ˜ç¬”è®°ã€‚å…³æ³¨æˆ‘ï¼Œå°‘èµ°å¼¯è·¯ï¼Œä¸€èµ·è¿›æ­¥ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernateï¼ˆ62ï¼‰Hibernateçš„æ‰¹å¤„ç†å¦‚ä½•å®ç°ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7598402961905074228</link>    <guid>https://juejin.cn/post/7598402961905074228</guid>    <pubDate>2026-01-23T23:57:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598402961905074228" data-draft-id="7598433254128074792" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernateï¼ˆ62ï¼‰Hibernateçš„æ‰¹å¤„ç†å¦‚ä½•å®ç°ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-23T23:57:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernateï¼ˆ62ï¼‰Hibernateçš„æ‰¹å¤„ç†å¦‚ä½•å®ç°ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T23:57:54.000Z" title="Fri Jan 23 2026 23:57:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Hibernateçš„æ‰¹å¤„ç†ï¼ˆBatch Processingï¼‰æ˜¯ä¸€ç§ä¼˜åŒ–æŠ€æœ¯ï¼Œå®ƒå…è®¸åœ¨ä¸€æ¬¡æ•°æ®åº“ä¼šè¯ä¸­æ‰¹é‡æ‰§è¡Œå¤šæ¡SQLè¯­å¥ï¼Œä»è€Œå‡å°‘ç½‘ç»œå¼€é”€å¹¶æé«˜æ€§èƒ½ã€‚ç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œæ‰¹å¤„ç†å¯ä»¥æ˜¾è‘—æé«˜æ•ˆç‡ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•åœ¨Hibernateä¸­å®ç°æ‰¹å¤„ç†çš„è¯¦ç»†ä»‹ç»å’Œä»£ç ç¤ºä¾‹ã€‚</p>
<h3 data-id="heading-0">1. é…ç½®Hibernateä»¥æ”¯æŒæ‰¹å¤„ç†</h3>
<p>é¦–å…ˆï¼Œéœ€è¦åœ¨Hibernateé…ç½®æ–‡ä»¶ä¸­å¯ç”¨æ‰¹å¤„ç†ã€‚</p>
<h4 data-id="heading-1">1.1 ä¿®æ”¹<code>hibernate.cfg.xml</code></h4>
<p>åœ¨<code>hibernate.cfg.xml</code>æ–‡ä»¶ä¸­æ·»åŠ æ‰¹å¤„ç†ç›¸å…³é…ç½®ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span>
        <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span>
        <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ•°æ®åº“è¿æ¥é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/your_database<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>your_username<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>your_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- Hibernate å±æ€§é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.show_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- å¯ç”¨æ‰¹å¤„ç† --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.jdbc.batch_size"</span>&gt;</span>20<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.order_inserts"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.order_updates"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.jdbc.batch_versioned_data"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- æ˜ å°„ç±» --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Product"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<ul>
<li><code>hibernate.jdbc.batch_size</code>ï¼šè®¾ç½®æ‰¹å¤„ç†çš„å¤§å°ã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œè®¾ç½®ä¸º20ï¼Œæ„å‘³ç€æ¯æ‰¹å¤„ç†20æ¡SQLè¯­å¥ã€‚</li>
<li><code>hibernate.order_inserts</code>ï¼šæ˜¯å¦æŒ‰æ‰¹å¤„ç†é¡ºåºæ’å…¥è®°å½•ã€‚</li>
<li><code>hibernate.order_updates</code>ï¼šæ˜¯å¦æŒ‰æ‰¹å¤„ç†é¡ºåºæ›´æ–°è®°å½•ã€‚</li>
<li><code>hibernate.jdbc.batch_versioned_data</code>ï¼šæ˜¯å¦å¯ç”¨ç‰ˆæœ¬åŒ–æ•°æ®çš„æ‰¹å¤„ç†ã€‚</li>
</ul>
<h3 data-id="heading-2">2. å®ç°æ‰¹å¤„ç†æ“ä½œ</h3>
<h4 data-id="heading-3">2.1 æ‰¹é‡æ’å…¥</h4>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªæ‰¹é‡æ’å…¥çš„ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateBatchInsertExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            sessionFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>).buildSessionFactory();
        } <span class="hljs-keyword">catch</span> (Throwable ex) {
            System.err.println(<span class="hljs-string">"Initial SessionFactory creation failed."</span> + ex);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExceptionInInitializerError</span>(ex);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">100</span>; i++) {
                <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>();
                product.setName(<span class="hljs-string">"Product "</span> + i);
                product.setPrice(<span class="hljs-number">50.0</span> + i);
                session.save(product);

                <span class="hljs-comment">// æ¯20æ¡è®°å½•ï¼ˆå³ä¸€ä¸ªæ‰¹å¤„ç†å¤§å°ï¼‰æäº¤ä¸€æ¬¡</span>
                <span class="hljs-keyword">if</span> (i % <span class="hljs-number">20</span> == <span class="hljs-number">0</span>) {
                    session.flush();
                    session.clear();
                }
            }
            transaction.commit();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (transaction != <span class="hljs-literal">null</span>) {
                transaction.rollback();
            }
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            session.close();
        }
    }
}
</code></pre>
<h4 data-id="heading-4">2.2 æ‰¹é‡æ›´æ–°</h4>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªæ‰¹é‡æ›´æ–°çš„ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateBatchUpdateExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            sessionFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>).buildSessionFactory();
        } <span class="hljs-keyword">catch</span> (Throwable ex) {
            System.err.println(<span class="hljs-string">"Initial SessionFactory creation failed."</span> + ex);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExceptionInInitializerError</span>(ex);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">100</span>; i++) {
                <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> session.get(Product.class, (<span class="hljs-type">long</span>) i);
                <span class="hljs-keyword">if</span> (product != <span class="hljs-literal">null</span>) {
                    product.setPrice(product.getPrice() + <span class="hljs-number">10</span>);
                    session.update(product);

                    <span class="hljs-comment">// æ¯20æ¡è®°å½•ï¼ˆå³ä¸€ä¸ªæ‰¹å¤„ç†å¤§å°ï¼‰æäº¤ä¸€æ¬¡</span>
                    <span class="hljs-keyword">if</span> (i % <span class="hljs-number">20</span> == <span class="hljs-number">0</span>) {
                        session.flush();
                        session.clear();
                    }
                }
            }
            transaction.commit();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (transaction != <span class="hljs-literal">null</span>) {
                transaction.rollback();
            }
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            session.close();
        }
    }
}
</code></pre>
<h4 data-id="heading-5">2.3 æ‰¹é‡åˆ é™¤</h4>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªæ‰¹é‡åˆ é™¤çš„ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateBatchDeleteExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            sessionFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>).buildSessionFactory();
        } <span class="hljs-keyword">catch</span> (Throwable ex) {
            System.err.println(<span class="hljs-string">"Initial SessionFactory creation failed."</span> + ex);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExceptionInInitializerError</span>(ex);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">100</span>; i++) {
                <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> session.get(Product.class, (<span class="hljs-type">long</span>) i);
                <span class="hljs-keyword">if</span> (product != <span class="hljs-literal">null</span>) {
                    session.delete(product);

                    <span class="hljs-comment">// æ¯20æ¡è®°å½•ï¼ˆå³ä¸€ä¸ªæ‰¹å¤„ç†å¤§å°ï¼‰æäº¤ä¸€æ¬¡</span>
                    <span class="hljs-keyword">if</span> (i % <span class="hljs-number">20</span> == <span class="hljs-number">0</span>) {
                        session.flush();
                        session.clear();
                    }
                }
            }
            transaction.commit();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (transaction != <span class="hljs-literal">null</span>) {
                transaction.rollback();
            }
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            session.close();
        }
    }
}
</code></pre>
<h3 data-id="heading-6">3. é˜²æ­¢å†…å­˜æº¢å‡º</h3>
<p>åœ¨æ‰¹å¤„ç†æ“ä½œä¸­ï¼Œé€šå¸¸ä¼šä½¿ç”¨<code>session.flush()</code>å’Œ<code>session.clear()</code>æ¥é˜²æ­¢å†…å­˜æº¢å‡ºï¼š</p>
<ul>
<li><code>session.flush()</code>ï¼šå°†Hibernateä¼šè¯ä¸­çš„è„æ•°æ®åŒæ­¥åˆ°æ•°æ®åº“ä¸­ã€‚</li>
<li><code>session.clear()</code>ï¼šæ¸…é™¤Hibernateä¼šè¯ä¸­ç¼“å­˜çš„æ‰€æœ‰å¯¹è±¡ï¼Œé˜²æ­¢å†…å­˜å ç”¨è¿‡é«˜ã€‚</li>
</ul>
<h3 data-id="heading-7">4. ä½¿ç”¨StatelessSessionè¿›è¡Œæ‰¹å¤„ç†æ“ä½œ</h3>
<p>å¦‚æœä¸éœ€è¦Hibernateçš„ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨<code>StatelessSession</code>è¿›è¡Œæ‰¹å¤„ç†æ“ä½œã€‚<code>StatelessSession</code>ä¸ç»´æŠ¤æŒä¹…åŒ–ä¸Šä¸‹æ–‡ï¼Œä¹Ÿæ²¡æœ‰ä¸€çº§ç¼“å­˜ï¼Œå› è€Œå ç”¨æ›´å°‘çš„å†…å­˜ã€‚</p>
<h4 data-id="heading-8">ç¤ºä¾‹ä»£ç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.StatelessSession;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateStatelessBatchExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            sessionFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>).buildSessionFactory();
        } <span class="hljs-keyword">catch</span> (Throwable ex) {
            System.err.println(<span class="hljs-string">"Initial SessionFactory creation failed."</span> + ex);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExceptionInInitializerError</span>(ex);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">StatelessSession</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openStatelessSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">100</span>; i++) {
                <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>();
                product.setName(<span class="hljs-string">"Product "</span> + i);
                product.setPrice(<span class="hljs-number">50.0</span> + i);
                session.insert(product);

                <span class="hljs-comment">// æ¯20æ¡è®°å½•ï¼ˆå³ä¸€ä¸ªæ‰¹å¤„ç†å¤§å°ï¼‰æäº¤ä¸€æ¬¡</span>
                <span class="hljs-keyword">if</span> (i % <span class="hljs-number">20</span> == <span class="hljs-number">0</span>) {
                    session.flush();
                }
            }
            transaction.commit();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (transaction != <span class="hljs-literal">null</span>) {
                transaction.rollback();
            }
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            session.close();
        }
    }
}
</code></pre>
<h3 data-id="heading-9">æ€»ç»“</h3>
<ol>
<li><strong>é…ç½®Hibernateæ”¯æŒæ‰¹å¤„ç†</strong>ï¼šåœ¨<code>hibernate.cfg.xml</code>ä¸­å¯ç”¨æ‰¹å¤„ç†ç›¸å…³é…ç½®ã€‚</li>
<li><strong>å®ç°æ‰¹å¤„ç†æ“ä½œ</strong>ï¼šç¼–å†™æ‰¹é‡æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤çš„ä»£ç ï¼Œæ³¨æ„ä½¿ç”¨<code>session.flush()</code>å’Œ<code>session.clear()</code>æ¥é˜²æ­¢å†…å­˜æº¢å‡ºã€‚</li>
<li><strong>ä½¿ç”¨StatelessSession</strong>ï¼šå¦‚æœä¸éœ€è¦ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜ï¼Œå¯ä»¥ä½¿ç”¨<code>StatelessSession</code>è¿›è¡Œæ‰¹å¤„ç†æ“ä½œä»¥æé«˜æ€§èƒ½å’Œå‡å°‘å†…å­˜å ç”¨ã€‚</li>
</ol>
<p>é€šè¿‡è¿™äº›æ–¹æ³•ï¼Œå¯ä»¥æœ‰æ•ˆåœ°å®ç°Hibernateçš„æ‰¹å¤„ç†æ“ä½œï¼Œä»è€Œä¼˜åŒ–åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œèµ„æºä½¿ç”¨ã€‚å¸Œæœ›è¿™äº›è¯¦ç»†çš„è§£é‡Šå’Œä»£ç ç¤ºä¾‹èƒ½å¸®åŠ©æ‚¨æ›´å¥½åœ°ç†è§£å’Œåº”ç”¨Hibernateçš„æ‰¹å¤„ç†æŠ€æœ¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernateï¼ˆ61ï¼‰Hibernateçš„Criteria APIå¦‚ä½•ä½¿ç”¨ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7598433254128058408</link>    <guid>https://juejin.cn/post/7598433254128058408</guid>    <pubDate>2026-01-23T23:57:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598433254128058408" data-draft-id="7598401650856574976" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernateï¼ˆ61ï¼‰Hibernateçš„Criteria APIå¦‚ä½•ä½¿ç”¨ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-23T23:57:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernateï¼ˆ61ï¼‰Hibernateçš„Criteria APIå¦‚ä½•ä½¿ç”¨ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T23:57:07.000Z" title="Fri Jan 23 2026 23:57:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Hibernateçš„Criteria API æ˜¯ä¸€ç§å¼ºç±»å‹ã€é¢å‘å¯¹è±¡çš„æŸ¥è¯¢è¯­è¨€ï¼Œå®ƒå…è®¸å¼€å‘è€…é€šè¿‡ä»£ç æ„å»ºæŸ¥è¯¢ï¼Œè€Œä¸æ˜¯é€šè¿‡å­—ç¬¦ä¸²ç¼–å†™SQLè¯­å¥ã€‚Criteria API æä¾›äº†ä¸€ç§æ›´çµæ´»ã€æ›´å®‰å…¨çš„æ–¹å¼æ¥æ„å»ºåŠ¨æ€æŸ¥è¯¢ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•ä½¿ç”¨Hibernateçš„Criteria APIçš„è¯¦ç»†è§£é‡Šå’Œä»£ç ç¤ºä¾‹ã€‚</p>
<h3 data-id="heading-0">1. åŸºæœ¬ä½¿ç”¨</h3>
<h4 data-id="heading-1">1.1 è®¾ç½®å®ä½“ç±»</h4>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰æˆ‘ä»¬çš„å®ä½“ç±»ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„<code>Product</code>ç±»ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "product")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Product</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-meta">@Column(name = "name")</span>
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-meta">@Column(name = "price")</span>
    <span class="hljs-keyword">private</span> Double price;

    <span class="hljs-comment">// Getters and Setters</span>
}
</code></pre>
<h4 data-id="heading-2">1.2 é…ç½®Hibernate</h4>
<p>ç„¶åï¼Œæˆ‘ä»¬éœ€è¦é…ç½®Hibernateã€‚åœ¨<code>hibernate.cfg.xml</code>ä¸­é…ç½®æ•°æ®åº“è¿æ¥å’Œæ˜ å°„ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span>
        <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span>
        <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ•°æ®åº“è¿æ¥é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/your_database<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>your_username<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>your_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- Hibernate å±æ€§é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.show_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- æ˜ å°„ç±» --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Product"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<h4 data-id="heading-3">1.3 åˆ›å»ºCriteriaæŸ¥è¯¢</h4>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä½¿ç”¨Criteria APIæŸ¥è¯¢æ‰€æœ‰<code>Product</code>å®ä½“çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;
<span class="hljs-keyword">import</span> org.hibernate.query.criteria.HibernateCriteriaBuilder;
<span class="hljs-keyword">import</span> org.hibernate.query.criteria.JpaCriteriaQuery;
<span class="hljs-keyword">import</span> javax.persistence.criteria.Root;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateCriteriaExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            sessionFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>).buildSessionFactory();
        } <span class="hljs-keyword">catch</span> (Throwable ex) {
            System.err.println(<span class="hljs-string">"Initial SessionFactory creation failed."</span> + ex);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExceptionInInitializerError</span>(ex);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">HibernateCriteriaBuilder</span> <span class="hljs-variable">builder</span> <span class="hljs-operator">=</span> session.getCriteriaBuilder();
            JpaCriteriaQuery&lt;Product&gt; criteria = builder.createQuery(Product.class);
            Root&lt;Product&gt; root = criteria.from(Product.class);
            criteria.select(root);

            List&lt;Product&gt; products = session.createQuery(criteria).getResultList();
            <span class="hljs-keyword">for</span> (Product product : products) {
                System.out.println(<span class="hljs-string">"Product Name: "</span> + product.getName() + <span class="hljs-string">", Price: "</span> + product.getPrice());
            }

            transaction.commit();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (transaction != <span class="hljs-literal">null</span>) {
                transaction.rollback();
            }
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            session.close();
        }
    }
}
</code></pre>
<h3 data-id="heading-4">2. é«˜çº§ä½¿ç”¨</h3>
<h4 data-id="heading-5">2.1 æ·»åŠ æŸ¥è¯¢æ¡ä»¶</h4>
<p>å¯ä»¥ä½¿ç”¨<code>where</code>å­å¥æ¥æ·»åŠ æŸ¥è¯¢æ¡ä»¶ã€‚ä¾‹å¦‚ï¼ŒæŸ¥è¯¢ä»·æ ¼å¤§äº50çš„äº§å“ï¼š</p>
<pre><code class="hljs language-java" lang="java">criteria.where(builder.gt(root.get(<span class="hljs-string">"price"</span>), <span class="hljs-number">50.0</span>));
</code></pre>
<p>å®Œæ•´ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">HibernateCriteriaBuilder</span> <span class="hljs-variable">builder</span> <span class="hljs-operator">=</span> session.getCriteriaBuilder();
JpaCriteriaQuery&lt;Product&gt; criteria = builder.createQuery(Product.class);
Root&lt;Product&gt; root = criteria.from(Product.class);
criteria.select(root);
criteria.where(builder.gt(root.get(<span class="hljs-string">"price"</span>), <span class="hljs-number">50.0</span>));

List&lt;Product&gt; products = session.createQuery(criteria).getResultList();
<span class="hljs-keyword">for</span> (Product product : products) {
    System.out.println(<span class="hljs-string">"Product Name: "</span> + product.getName() + <span class="hljs-string">", Price: "</span> + product.getPrice());
}
</code></pre>
<h4 data-id="heading-6">2.2 æ’åº</h4>
<p>å¯ä»¥ä½¿ç”¨<code>orderBy</code>å­å¥æ¥å¯¹æŸ¥è¯¢ç»“æœæ’åºã€‚ä¾‹å¦‚ï¼ŒæŒ‰ä»·æ ¼å‡åºæ’åºï¼š</p>
<pre><code class="hljs language-java" lang="java">criteria.orderBy(builder.asc(root.get(<span class="hljs-string">"price"</span>)));
</code></pre>
<p>å®Œæ•´ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">HibernateCriteriaBuilder</span> <span class="hljs-variable">builder</span> <span class="hljs-operator">=</span> session.getCriteriaBuilder();
JpaCriteriaQuery&lt;Product&gt; criteria = builder.createQuery(Product.class);
Root&lt;Product&gt; root = criteria.from(Product.class);
criteria.select(root);
criteria.where(builder.gt(root.get(<span class="hljs-string">"price"</span>), <span class="hljs-number">50.0</span>));
criteria.orderBy(builder.asc(root.get(<span class="hljs-string">"price"</span>)));

List&lt;Product&gt; products = session.createQuery(criteria).getResultList();
<span class="hljs-keyword">for</span> (Product product : products) {
    System.out.println(<span class="hljs-string">"Product Name: "</span> + product.getName() + <span class="hljs-string">", Price: "</span> + product.getPrice());
}
</code></pre>
<h4 data-id="heading-7">2.3 åˆ†é¡µ</h4>
<p>å¯ä»¥ä½¿ç”¨<code>setFirstResult</code>å’Œ<code>setMaxResults</code>æ–¹æ³•æ¥å®ç°åˆ†é¡µã€‚ä¾‹å¦‚ï¼Œè·å–ç¬¬2é¡µï¼Œæ¯é¡µ10æ¡è®°å½•ï¼š</p>
<pre><code class="hljs language-java" lang="java">session.createQuery(criteria)
       .setFirstResult(<span class="hljs-number">10</span>)
       .setMaxResults(<span class="hljs-number">10</span>)
       .getResultList();
</code></pre>
<p>å®Œæ•´ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">HibernateCriteriaBuilder</span> <span class="hljs-variable">builder</span> <span class="hljs-operator">=</span> session.getCriteriaBuilder();
JpaCriteriaQuery&lt;Product&gt; criteria = builder.createQuery(Product.class);
Root&lt;Product&gt; root = criteria.from(Product.class);
criteria.select(root);
criteria.where(builder.gt(root.get(<span class="hljs-string">"price"</span>), <span class="hljs-number">50.0</span>));
criteria.orderBy(builder.asc(root.get(<span class="hljs-string">"price"</span>)));

List&lt;Product&gt; products = session.createQuery(criteria)
                                .setFirstResult(<span class="hljs-number">10</span>)
                                .setMaxResults(<span class="hljs-number">10</span>)
                                .getResultList();
<span class="hljs-keyword">for</span> (Product product : products) {
    System.out.println(<span class="hljs-string">"Product Name: "</span> + product.getName() + <span class="hljs-string">", Price: "</span> + product.getPrice());
}
</code></pre>
<h4 data-id="heading-8">2.4 æŸ¥è¯¢æŠ•å½±</h4>
<p>å¯ä»¥ä½¿ç”¨<code>select</code>æ–¹æ³•æ¥é€‰æ‹©ç‰¹å®šçš„å­—æ®µã€‚ä¾‹å¦‚ï¼Œä»…æŸ¥è¯¢äº§å“åç§°å’Œä»·æ ¼ï¼š</p>
<pre><code class="hljs language-java" lang="java">criteria.select(builder.construct(ProductDTO.class, root.get(<span class="hljs-string">"name"</span>), root.get(<span class="hljs-string">"price"</span>)));
</code></pre>
<p>éœ€è¦ä¸€ä¸ªDTOç±»æ¥å­˜å‚¨ç»“æœï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProductDTO</span> {
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> Double price;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ProductDTO</span><span class="hljs-params">(String name, Double price)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.price = price;
    }

    <span class="hljs-comment">// Getters and Setters</span>
}
</code></pre>
<p>å®Œæ•´ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">HibernateCriteriaBuilder</span> <span class="hljs-variable">builder</span> <span class="hljs-operator">=</span> session.getCriteriaBuilder();
JpaCriteriaQuery&lt;ProductDTO&gt; criteria = builder.createQuery(ProductDTO.class);
Root&lt;Product&gt; root = criteria.from(Product.class);
criteria.select(builder.construct(ProductDTO.class, root.get(<span class="hljs-string">"name"</span>), root.get(<span class="hljs-string">"price"</span>)));
criteria.where(builder.gt(root.get(<span class="hljs-string">"price"</span>), <span class="hljs-number">50.0</span>));
criteria.orderBy(builder.asc(root.get(<span class="hljs-string">"price"</span>)));

List&lt;ProductDTO&gt; products = session.createQuery(criteria).getResultList();
<span class="hljs-keyword">for</span> (ProductDTO product : products) {
    System.out.println(<span class="hljs-string">"Product Name: "</span> + product.getName() + <span class="hljs-string">", Price: "</span> + product.getPrice());
}
</code></pre>
<h3 data-id="heading-9">æ€»ç»“</h3>
<ul>
<li><strong>è®¾ç½®å®ä½“ç±»</strong>ï¼šå®šä¹‰Hibernateå®ä½“ç±»ï¼Œå¹¶é…ç½®æ˜ å°„ä¿¡æ¯ã€‚</li>
<li><strong>é…ç½®Hibernate</strong>ï¼šåœ¨<code>hibernate.cfg.xml</code>ä¸­é…ç½®æ•°æ®åº“è¿æ¥ç­‰ä¿¡æ¯ã€‚</li>
<li><strong>åˆ›å»ºCriteriaæŸ¥è¯¢</strong>ï¼šä½¿ç”¨<code>CriteriaBuilder</code>å’Œ<code>CriteriaQuery</code>åˆ›å»ºæŸ¥è¯¢å¯¹è±¡ã€‚</li>
<li><strong>æ·»åŠ æŸ¥è¯¢æ¡ä»¶</strong>ï¼šä½¿ç”¨<code>where</code>æ–¹æ³•æ·»åŠ æ¡ä»¶ã€‚</li>
<li><strong>æ’åºå’Œåˆ†é¡µ</strong>ï¼šä½¿ç”¨<code>orderBy</code>ã€<code>setFirstResult</code>å’Œ<code>setMaxResults</code>æ–¹æ³•å®ç°æ’åºå’Œåˆ†é¡µã€‚</li>
<li><strong>æŸ¥è¯¢æŠ•å½±</strong>ï¼šä½¿ç”¨<code>select</code>æ–¹æ³•é€‰æ‹©ç‰¹å®šå­—æ®µï¼Œå¹¶ä½¿ç”¨DTOç±»å­˜å‚¨ç»“æœã€‚</li>
</ul>
<p>é€šè¿‡è¿™äº›æ–¹æ³•ï¼Œå¯ä»¥çµæ´»ã€åŠ¨æ€åœ°æ„å»ºå’Œæ‰§è¡ŒHibernateæŸ¥è¯¢ï¼Œå……åˆ†åˆ©ç”¨Hibernateçš„å¼ºå¤§åŠŸèƒ½æ¥å¤„ç†å¤æ‚çš„æ•°æ®éœ€æ±‚ã€‚å¸Œæœ›è¿™äº›è¯¦ç»†çš„è§£é‡Šå’Œä»£ç ç¤ºä¾‹èƒ½å¸®åŠ©æ‚¨æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨Hibernateçš„Criteria APIã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Rust æ‰€æœ‰æƒä¸å€Ÿç”¨ï¼šä»å †æ ˆå¼€å§‹å»ºç«‹å¿ƒæ™ºæ¨¡å‹]]></title>    <link>https://juejin.cn/post/7598507330859958314</link>    <guid>https://juejin.cn/post/7598507330859958314</guid>    <pubDate>2026-01-23T16:35:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598507330859958314" data-draft-id="7598418891400642614" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Rust æ‰€æœ‰æƒä¸å€Ÿç”¨ï¼šä»å †æ ˆå¼€å§‹å»ºç«‹å¿ƒæ™ºæ¨¡å‹"/> <meta itemprop="keywords" content="Rust,æ“ä½œç³»ç»Ÿ,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-23T16:35:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="mCell"/> <meta itemprop="url" content="https://juejin.cn/user/2280829967146779"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Rust æ‰€æœ‰æƒä¸å€Ÿç”¨ï¼šä»å †æ ˆå¼€å§‹å»ºç«‹å¿ƒæ™ºæ¨¡å‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2280829967146779/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    mCell
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T16:35:12.000Z" title="Fri Jan 23 2026 16:35:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d279a104a97b4f27a8f51be3a9130eb1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbUNlbGw=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769790912&amp;x-signature=1v9tDnYY4FHiLCc%2FqXV9XprTgGU%3D" alt="202603" loading="lazy"/></p>
<blockquote>
<p>æœ¬æ–‡å†™ä½œæ—¶ï¼Œæå¤§çš„å€Ÿé‰´äº†<a href="https://link.juejin.cn?target=https%3A%2F%2Fcourse.rs%2Fbasic%2Fownership%2Fownership.html" target="_blank" title="https://course.rs/basic/ownership/ownership.html" ref="nofollow noopener noreferrer">ã€ŠThe Rust Programming Languageã€‹</a>ï¼ˆä¿—ç§°â€œRust åœ£ç»â€ï¼‰ä¸­ç›¸å…³ç« èŠ‚çš„å†…å®¹å’Œç»“æ„ï¼Œåœ¨æ­¤è¡¨ç¤ºæ„Ÿè°¢ã€‚</p>
</blockquote>
<p>å†™ Rust çš„ç¬¬ä¸€é“åï¼Œä¸æ˜¯è¯­æ³•ï¼Œä¹Ÿä¸æ˜¯å®ï¼Œè€Œæ˜¯â€œæˆ‘æ˜æ˜åªæ˜¯æŠŠå˜é‡ä¼ ç»™ä½ ç”¨ä¸€ä¸‹ï¼Œæ€ä¹ˆå®ƒå°±ä¸å±äºæˆ‘äº†ï¼Ÿâ€</p>
<p>è¿™ç±»å›°æƒ‘é€šå¸¸å¹¶ä¸å¥‡æ€ªï¼Œå› ä¸ºæˆ‘ä»¬ä¹ æƒ¯äº†åˆ«çš„è¯­è¨€é‚£å¥—â€œå†…å­˜é»˜è®¤æœ‰äººå…œåº•â€çš„æ¨¡å‹ï¼Œæ¯”å¦‚ Javascriptã€Golang çš„è‡ªåŠ¨åƒåœ¾å›æ”¶æœºåˆ¶ã€‚Rust æ°æ°ç›¸åï¼šå®ƒè¦æ±‚ä½ æŠŠå†…å­˜è¿™ä»¶äº‹æƒ³æ¸…æ¥šï¼Œç„¶åæŠŠè§„åˆ™å†™è¿›ç±»å‹ç³»ç»Ÿï¼Œäº¤ç»™ç¼–è¯‘å™¨åœ¨<strong>ç¼–è¯‘æœŸ</strong>å¼ºåˆ¶æ‰§è¡Œâ€”â€”è¿™å°±æ˜¯æ‰€æœ‰æƒç³»ç»Ÿçš„æ ¸å¿ƒæ„ä¹‰ã€‚</p>
<p>ä¸ºäº†å°½é‡è®²æ¸…æ¥šï¼Œæœ¬æ–‡æŒ‰ä¸€æ¡çº¿å¾€å‰èµ°ï¼šå…ˆè®²å †æ ˆï¼Œå†è®²æ‰€æœ‰æƒï¼Œå†è®²å€Ÿç”¨ã€‚</p>
<h2 data-id="heading-0">å†…å­˜ç®¡ç†è¿™ä»¶äº‹ï¼Œè¯­è¨€å¤§è‡´åˆ†ä¸‰æ´¾</h2>
<p>æ‰€æœ‰ç¨‹åºéƒ½è¦ç”¨å†…å­˜ï¼šç”³è¯·ç©ºé—´ã€ä½¿ç”¨ã€é‡Šæ”¾ã€‚éº»çƒ¦åœ¨äºâ€œä»€ä¹ˆæ—¶å€™é‡Šæ”¾ã€è°æ¥é‡Šæ”¾â€ã€‚å†å²ä¸Šä¸»æµè¯­è¨€å¤§è‡´èµ°è¿‡ä¸‰æ¡è·¯ï¼š</p>
<ol>
<li><strong>GC</strong>ï¼šè¿è¡Œæ—¶æ‰¾å‡ºä¸å†ä½¿ç”¨çš„å†…å­˜å¹¶å›æ”¶ï¼ˆJavascriptã€Golangï¼‰ã€‚</li>
<li><strong>æ‰‹åŠ¨ç®¡ç†</strong>ï¼šç¨‹åºå‘˜æ˜¾å¼åˆ†é…/é‡Šæ”¾ï¼ˆC/C++ï¼‰ã€‚</li>
<li><strong>æ‰€æœ‰æƒ</strong>ï¼šç¼–è¯‘æœŸæŒ‰è§„åˆ™æ£€æŸ¥ï¼Œè¿è¡ŒæœŸä¸é¢å¤–ä»˜è´¹ï¼ˆRustï¼‰ã€‚</li>
</ol>
<p>Rust é€‰æ‹©ç¬¬ä¸‰æ¡è·¯çš„â€œé‡å¿ƒâ€å¾ˆæ˜ç¡®ï¼šæ—¢æƒ³è¦æ¥è¿‘ C/C++ çš„æ€§èƒ½ï¼Œåˆæƒ³æŠŠæ‚¬ç©ºæŒ‡é’ˆã€äºŒæ¬¡é‡Šæ”¾ã€æ•°æ®ç«äº‰è¿™ç±»å†…å­˜å®‰å…¨é—®é¢˜ï¼Œå°½é‡æå‰åˆ°ç¼–è¯‘é˜¶æ®µè§£å†³ã€‚</p>
<h2 data-id="heading-1">å…ˆæŠŠåœ°åŸºæ‰“ç‰¢ï¼šæ ˆï¼ˆStackï¼‰ä¸å †ï¼ˆHeapï¼‰</h2>
<p>å¦‚æœä½ åªå†™è„šæœ¬è¯­è¨€ï¼Œå¯èƒ½ä¸€è¾ˆå­ä¸å¿…æ·±ç©¶å †æ ˆã€‚ä½†åœ¨ Rust é‡Œï¼Œç†è§£å †æ ˆä¼šç›´æ¥å†³å®šä½ æ˜¯å¦çœ‹å¾—æ‡‚â€œç§»åŠ¨/å€Ÿç”¨â€çš„è¡Œä¸ºã€‚</p>
<h3 data-id="heading-2">æ ˆï¼šåè¿›å…ˆå‡ºï¼Œå¤§å°å¿…é¡»å›ºå®š</h3>
<p>æ ˆåƒä¸€å ç›˜å­ï¼šåªèƒ½ä»é¡¶éƒ¨æ”¾ã€ä»é¡¶éƒ¨æ‹¿ï¼Œåè¿›å…ˆå‡ºã€‚å…¥æ ˆ/å‡ºæ ˆéå¸¸å¿«ï¼Œä½†å‰ææ˜¯ï¼š<strong>æ¯ä¸ªå€¼çš„å¤§å°åœ¨ç¼–è¯‘æœŸå¿…é¡»å·²çŸ¥ä¸”å›ºå®š</strong>ï¼Œå¦åˆ™ä½ æ— æ³•â€œç²¾ç¡®åœ°å¼¹å‡ºâ€ä½ æƒ³è¦çš„é‚£å—æ•°æ®ã€‚</p>
<p>ä½ å¯ä»¥æŠŠä¸€æ¬¡å‡½æ•°è°ƒç”¨æƒ³æˆï¼š</p>
<ul>
<li>å‚æ•°ã€å±€éƒ¨å˜é‡ä¾æ¬¡å‹æ ˆ</li>
<li>å‡½æ•°ç»“æŸæŒ‰ç›¸åé¡ºåºå‡ºæ ˆ</li>
<li>å‡ºæ ˆå°±æ„å‘³ç€é‚£æ®µæ ˆå†…å­˜å¯ä»¥è¢«å¤ç”¨ï¼ˆæ‰€ä»¥â€œæ‹¿ç€æ ˆä¸Šå±€éƒ¨å˜é‡çš„åœ°å€å›å»â€å¾ˆå±é™©ï¼‰</li>
</ul>
<h3 data-id="heading-3">å †ï¼šå­˜æ”¾å¤§å°å¯å˜çš„æ•°æ®ï¼Œç”¨æŒ‡é’ˆå»æ‰¾å®ƒ</h3>
<p>å †é€‚åˆâ€œå¤§å°æœªçŸ¥æˆ–å¯èƒ½å˜åŒ–â€çš„æ•°æ®ã€‚åˆ†é…æ—¶ï¼Œæ“ä½œç³»ç»Ÿæ‰¾ä¸€å—è¶³å¤Ÿå¤§çš„ç©ºä½ï¼Œæ ‡è®°å·²ä½¿ç”¨ï¼Œå¹¶è¿”å›è¯¥ä½ç½®çš„<strong>æŒ‡é’ˆ</strong>ã€‚è¿™ä¸ªè¿‡ç¨‹å«åœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼ˆallocatingï¼‰ã€‚</p>
<p>å…³é”®ç»†èŠ‚æ˜¯ï¼š
<strong>å †ä¸Šçš„æ•°æ®æœ¬ä½“ä¸åœ¨æ ˆé‡Œï¼Œä½†æŒ‡å‘å®ƒçš„æŒ‡é’ˆé€šå¸¸åœ¨æ ˆé‡Œ</strong>ï¼ˆå› ä¸ºæŒ‡é’ˆå¤§å°å›ºå®šï¼‰ã€‚ä½ ä¹‹åæ¯æ¬¡è®¿é—®å †æ•°æ®ï¼Œéƒ½æ˜¯é€šè¿‡æ ˆä¸Šçš„æŒ‡é’ˆå»â€œå¯¼èˆªâ€åˆ°å †ä¸Šã€‚</p>
<h3 data-id="heading-4">ä¸ºä»€ä¹ˆå †æ›´éº»çƒ¦</h3>
<p>æ ˆæ˜¯â€œè‡ªåŠ¨ç®¡ç†â€çš„ï¼šä½œç”¨åŸŸç»“æŸå°±å‡ºæ ˆï¼›
å †æ˜¯â€œæ•£è£…çš„â€ï¼šä¸è·Ÿç€æŸä¸ªä½œç”¨åŸŸè‡ªåŠ¨æ¶ˆå¤±ï¼Œå¦‚æœä½ ä¸è¿½è¸ªå®ƒä½•æ—¶é‡Šæ”¾ï¼Œå°±å¯èƒ½å†…å­˜æ³„æ¼ã€‚Rust çš„æ‰€æœ‰æƒç³»ç»Ÿï¼Œæœ¬è´¨ä¸Šå°±æ˜¯æŠŠâ€œå †ä¸Šèµ„æºçš„é‡Šæ”¾è´£ä»»â€ç”¨è§„åˆ™å›ºå®šä¸‹æ¥ã€‚</p>
<h2 data-id="heading-5">æ‰€æœ‰æƒä¸‰æ¡è§„åˆ™ï¼šæŠŠâ€œé‡Šæ”¾è´£ä»»â€å†™æ­»</h2>
<p>Rust çš„æ‰€æœ‰æƒè§„åˆ™å¯ä»¥èƒŒä¸‹æ¥ï¼ˆå…ˆåˆ«æ€¥ç€ç†è§£ï¼Œåé¢ä¼šç”¨ä¾‹å­æŠŠå®ƒç£¨æ¸…æ¥šï¼‰ï¼š</p>
<ol>
<li>Rust ä¸­æ¯ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ªå˜é‡ä½œä¸ºå®ƒçš„<strong>æ‰€æœ‰è€…</strong></li>
<li>åŒä¸€æ—¶åˆ»ä¸€ä¸ªå€¼åªèƒ½æœ‰ä¸€ä¸ªæ‰€æœ‰è€…</li>
<li>æ‰€æœ‰è€…ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œè¿™ä¸ªå€¼ä¼šè¢«ä¸¢å¼ƒï¼ˆdropï¼‰</li>
</ol>
<p>æ³¨æ„ç¬¬ä¸‰æ¡ï¼šâ€œdropâ€ä¸æ˜¯æŠ½è±¡æ¦‚å¿µï¼Œå®ƒå°±æ˜¯â€œé‡Šæ”¾èµ„æºâ€çš„é‚£ä¸ªåŠ¨ä½œâ€”â€”å¯¹æ ˆä¸Šç®€å•å€¼æ²¡ä»€ä¹ˆç‰¹åˆ«ï¼Œå¯¹å †ä¸Šæ•°æ®å°±éå¸¸å…³é”®ï¼Œå› ä¸ºå®ƒå†³å®šäº†å †å†…å­˜ä½•æ—¶é‡Šæ”¾ã€‚</p>
<h2 data-id="heading-6">ä¸€ä¸ªæœ€å¸¸è§çš„è¯¯ä¼šï¼š<code>String</code> èµ‹å€¼ä¸ºä»€ä¹ˆä¼šè®©æ—§å˜é‡å¤±æ•ˆï¼Ÿ</h2>
<p>æ¥çœ‹ä¸¤æ®µå¯¹æ¯”ä»£ç ã€‚</p>
<h3 data-id="heading-7"><code>i32</code> è¿™ç§ç®€å•ç±»å‹ï¼šå¤åˆ¶ï¼ˆCopyï¼‰å°±å®Œäº‹äº†</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">x</span> = <span class="hljs-number">5</span>;
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">y</span> = x;
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"x = {}, y = {}"</span>, x, y); <span class="hljs-comment">// x ä»ç„¶å¯ç”¨</span>
</code></pre>
<p>æ•´æ•°æ˜¯å›ºå®šå¤§å°çš„ç®€å•å€¼ï¼Œæ”¾åœ¨æ ˆä¸Šï¼Œâ€œå¤åˆ¶ 4 ä¸ªå­—èŠ‚â€éå¸¸å¿«ï¼Œæ‰€ä»¥ Rust ç›´æ¥åšæ‹·è´ï¼Œ<code>x</code> ä¸ä¼šå¤±æ•ˆã€‚</p>
<h3 data-id="heading-8"><code>String</code>ï¼šèƒŒåæœ‰å †å†…å­˜ï¼Œä¸èƒ½éšä¾¿â€œé»˜è®¤å¤åˆ¶â€</h3>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s1</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"hello"</span>);
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s2</span> = s1;
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"s1 = {}, s2 = {}"</span>, s1, s2); <span class="hljs-comment">// ç¼–è¯‘æŠ¥é”™ï¼Œs1 å¤±æ•ˆ</span>
</code></pre>
<p><code>String</code> æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªâ€œå¥æŸ„â€ï¼š<strong>æ ˆä¸Š</strong>å­˜ç€ï¼ˆå †æŒ‡é’ˆã€é•¿åº¦ã€å®¹é‡ï¼‰ï¼ŒçœŸæ­£çš„å­—ç¬¦æ•°æ®åœ¨<strong>å †ä¸Š</strong>ã€‚</p>
<p>è¿™æ—¶å¦‚æœå…è®¸ <code>s1</code>ã€<code>s2</code> åŒæ—¶æŒ‡å‘åŒä¸€å—å †å†…å­˜ï¼Œå°±ä¼šæ’ä¸Šæ‰€æœ‰æƒç¬¬äºŒæ¡ï¼šä¸€ä¸ªå€¼åªèƒ½æœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚æ›´ç°å®çš„é—®é¢˜æ˜¯ï¼šä½œç”¨åŸŸç»“æŸæ—¶ï¼Œè°æ¥ dropï¼Ÿå¦‚æœä¸¤ä¸ªéƒ½ dropï¼Œå°±å¯èƒ½äºŒæ¬¡é‡Šæ”¾ã€‚Rust ä¸èµŒè¿æ°”ï¼Œå®ƒé€‰æ‹©åœ¨èµ‹å€¼æ—¶æŠŠæ‰€æœ‰æƒè½¬ç§»ç»™æ–°å˜é‡ï¼Œè®©æ—§å˜é‡ç«‹åˆ»å¤±æ•ˆï¼Œä»æ ¹ä¸Šåˆ‡æ–­è¿™ç±»é—®é¢˜ã€‚</p>
<p>ç¼–è¯‘å™¨çš„æŠ¥é”™ä¹Ÿä¼šç›´æ¥å‘Šè¯‰ä½ ï¼š<code>String</code> æ²¡å®ç° <code>Copy</code>ï¼Œå› æ­¤å‘ç”Ÿäº† moveï¼Œä¹‹åå†ç”¨æ—§å˜é‡å°±ä¸è¡Œã€‚</p>
<h2 data-id="heading-9">Move / Clone / Copyï¼šä¸‰ä¸ªè¯ï¼Œä¸‰ç§æˆæœ¬</h2>
<p>æŠŠè¿™ä¸‰è€…åˆ†æ¸…ï¼Œæ‰€æœ‰æƒå°±é€šäº†å…«æˆã€‚</p>
<h3 data-id="heading-10">Moveï¼šè½¬ç§»â€œé‡Šæ”¾è´£ä»»â€ï¼Œé€šå¸¸ä¸å¤åˆ¶å †æ•°æ®</h3>
<p>å¯¹ <code>String</code> è¿™ç§æ‹¥æœ‰å †èµ„æºçš„ç±»å‹ï¼Œ<code>let s2 = s1;</code> çš„æ ¸å¿ƒä¸æ˜¯â€œå¤åˆ¶å†…å®¹â€ï¼Œè€Œæ˜¯â€œæŠŠé‡Šæ”¾è´£ä»»äº¤ç»™ s2â€ã€‚è¿™æ ·æ€§èƒ½å¾ˆå¥½ï¼Œå› ä¸ºä½ æ²¡æœ‰åšæ·±æ‹·è´ã€‚</p>
<h3 data-id="heading-11">Cloneï¼šæ·±æ‹·è´ï¼Œå¤åˆ¶å †ä¸Šå†…å®¹ï¼ˆè´µï¼‰</h3>
<p>å¦‚æœä½ ç¡®å®éœ€è¦ä¸¤ä»½ç‹¬ç«‹çš„æ•°æ®ï¼Œç”¨ <code>clone()</code>ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s1</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"hello"</span>);
<span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s2</span> = s1.<span class="hljs-title function_ invoke__">clone</span>();
<span class="hljs-built_in">println!</span>(<span class="hljs-string">"s1 = {}, s2 = {}"</span>, s1, s2);
</code></pre>
<p>Rust ä¸ä¼šè‡ªåŠ¨æ·±æ‹·è´ï¼›ä½ æ˜¾å¼ <code>clone</code>ï¼Œå°±ç­‰äºæ˜¾å¼é€‰æ‹©äº†æ›´é«˜æˆæœ¬ã€‚å®˜æ–¹ä¹Ÿæé†’ï¼šçƒ­ç‚¹è·¯å¾„ä¸Šæ»¥ç”¨ clone ä¼šæ˜¾è‘—æ‹–æ…¢æ€§èƒ½ã€‚</p>
<h3 data-id="heading-12">Copyï¼šå¯¹æ ˆä¸Šå›ºå®šå¤§å°ç±»å‹ï¼Œèµ‹å€¼å°±æ˜¯å¤åˆ¶</h3>
<p>Rust æœ‰ä¸ª <code>Copy</code> ç‰¹å¾ï¼šå®ç°äº†å®ƒçš„ç±»å‹ï¼Œåœ¨èµ‹å€¼/ä¼ å‚æ—¶ä¼šå‘ç”Ÿæ‹·è´ï¼Œæ—§å˜é‡ä»å¯ç”¨ã€‚å¤§ä½“è§„åˆ™æ˜¯ï¼šä¸éœ€è¦åˆ†é…å†…å­˜ã€æ²¡æœ‰â€œé‡Šæ”¾èµ„æºâ€è´Ÿæ‹…çš„ç±»å‹å¾€å¾€å¯ Copyï¼Œæ¯”å¦‚æ•´æ•°ã€boolã€æµ®ç‚¹ã€charã€åªåŒ…å« Copy æˆå‘˜çš„å…ƒç»„ã€ä¸å¯å˜å¼•ç”¨ <code>&amp;T</code> ç­‰ã€‚</p>
<p>è¿™é‡Œé¡ºä¾¿ç‚¹ä¸€ä¸‹ï¼š<strong>å¯å˜å¼•ç”¨ <code>&amp;mut T</code> ä¸èƒ½ Copy</strong>ï¼Œå› ä¸ºâ€œåˆ°å¤„å¤åˆ¶å¯å†™é’¥åŒ™â€ä¼šç›´æ¥ç ´ååé¢çš„å€Ÿç”¨å®‰å…¨è§„åˆ™ã€‚</p>
<h2 data-id="heading-13">å‡½æ•°è°ƒç”¨ï¼šä¼ å‚å’Œè¿”å›å€¼åŒæ ·ä¼šè§¦å‘ Move/Copy</h2>
<p>å¾ˆå¤šäººç¬¬ä¸€æ¬¡â€œè¢« Rust æ•™è‚²â€ï¼Œå°±æ˜¯åœ¨å‡½æ•°å‚æ•°è¿™é‡Œã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">takes_ownership</span>(some_string: <span class="hljs-type">String</span>) { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">makes_copy</span>(some_integer: <span class="hljs-type">i32</span>) { <span class="hljs-comment">/* ... */</span> }

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"hello"</span>);
    <span class="hljs-title function_ invoke__">takes_ownership</span>(s); <span class="hljs-comment">// moveï¼Œs å¤±æ•ˆ</span>

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">x</span> = <span class="hljs-number">5</span>;
    <span class="hljs-title function_ invoke__">makes_copy</span>(x); <span class="hljs-comment">// copyï¼Œx ä»ç„¶å¯ç”¨</span>
}
</code></pre>
<p><code>String</code> ä¼ å…¥å‡½æ•°åï¼Œæ‰€æœ‰æƒç§»åŠ¨åˆ°å½¢å‚ï¼›å‡½æ•°ç»“æŸå½¢å‚ç¦»å¼€ä½œç”¨åŸŸï¼Œè§¦å‘ dropï¼Œå †å†…å­˜è¢«é‡Šæ”¾ã€‚<code>i32</code> å› ä¸º Copyï¼Œä¸å½±å“å¤–é¢çš„ <code>x</code>ã€‚</p>
<p>å‡½æ•°è¿”å›å€¼ä¹Ÿä¸€æ ·å¸¦ç€æ‰€æœ‰æƒï¼šè°æ¥ä½ï¼Œè°å°±æˆä¸ºæ–°æ‰€æœ‰è€…ã€‚</p>
<p>åˆ°è¿™é‡Œä½ ä¼šå‘ç°ï¼šå¦‚æœæ¯æ¬¡åªæ˜¯â€œå€Ÿæ¥ç”¨ä¸€ä¸‹â€ï¼Œå´å¿…é¡» move è¿›å»ã€å† move å‡ºæ¥ï¼Œä»£ç ä¼šå¾ˆå•°å—¦ã€‚è¿™æ­£æ˜¯ä¸‹ä¸€ç« ï¼š<strong>å€Ÿç”¨</strong> è¦è§£å†³çš„é—®é¢˜ã€‚</p>
<h2 data-id="heading-14">å€Ÿç”¨ï¼šæˆ‘åªæƒ³ç”¨ä½ çš„æ•°æ®ï¼Œä½†ä¸æƒ³æ‹¿èµ°å®ƒ</h2>
<p>å€Ÿç”¨ï¼ˆborrowingï¼‰å°±æ˜¯ï¼š<strong>åˆ›å»ºå¼•ç”¨ï¼Œç”¨å¼•ç”¨è®¿é—®æ•°æ®ï¼Œä½†ä¸å¤ºèµ°æ‰€æœ‰æƒ</strong>ã€‚ç°å®æ¯”å–»å¾ˆç›´ç™½ï¼šåˆ«äººæ‹¥æœ‰æŸæ ·ä¸œè¥¿ï¼Œä½ å¯ä»¥å€Ÿæ¥ç”¨ï¼Œç”¨å®Œè¦è¿˜ã€‚</p>
<h2 data-id="heading-15">ä¸å¯å˜å¼•ç”¨ï¼šåªè¯»å€Ÿé˜…ï¼Œä¸æ”¹å†…å®¹</h2>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">calculate_length</span>(s: &amp;<span class="hljs-type">String</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">usize</span> {
    s.<span class="hljs-title function_ invoke__">len</span>()
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s1</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"hello"</span>);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">len</span> = <span class="hljs-title function_ invoke__">calculate_length</span>(&amp;s1);
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">"{} {}"</span>, s1, len); <span class="hljs-comment">// s1 ä»ç„¶å¯ç”¨</span>
}
</code></pre>
<p>è¿™é‡Œå‘ç”Ÿäº†ä¸¤ä»¶é‡è¦çš„äº‹ï¼š</p>
<ol>
<li>å‚æ•°ç±»å‹ä» <code>String</code> å˜æˆ <code>&amp;String</code>ï¼Œæ‰€ä»¥ä¸ä¼š move æ‰€æœ‰æƒ</li>
<li>å¼•ç”¨ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œä¸ä¼š drop å…¶æŒ‡å‘çš„å€¼ï¼Œå› ä¸ºå¼•ç”¨ä¸æ˜¯æ‰€æœ‰è€…</li>
</ol>
<p>ä½ å¯ä»¥æŠŠ <code>&amp;String</code> æƒ³æˆâ€œåªè¯»é—¨ç¦å¡â€ï¼šèƒ½è¿›é—¨çœ‹æˆ¿é—´ï¼ˆè®¿é—®æ•°æ®ï¼‰ï¼Œä½†ä¸èƒ½è£…ä¿®ï¼ˆä¿®æ”¹æ•°æ®ï¼‰ï¼Œä¹Ÿä¸èƒ½å†³å®šæ‹†æˆ¿ï¼ˆé‡Šæ”¾å†…å­˜ï¼‰ã€‚</p>
<h2 data-id="heading-16">å¯å˜å¼•ç”¨ï¼šå¯ä»¥ä¿®æ”¹ï¼Œä½†â€œåŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€æŠŠå¯å†™é’¥åŒ™â€</h2>
<p>å¦‚æœä½ æƒ³é€šè¿‡å€Ÿç”¨å»ä¿®æ”¹æ•°æ®ï¼Œéœ€è¦ <code>&amp;mut</code>ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">change</span>(s: &amp;<span class="hljs-keyword">mut</span> <span class="hljs-type">String</span>) {
    s.<span class="hljs-title function_ invoke__">push_str</span>(<span class="hljs-string">", world"</span>);
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">s</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"hello"</span>);
    <span class="hljs-title function_ invoke__">change</span>(&amp;<span class="hljs-keyword">mut</span> s);
}
</code></pre>
<p>å…³é”®é™åˆ¶æ¥äº†ï¼š<strong>åŒä¸€ä½œç”¨åŸŸå†…ï¼Œç‰¹å®šæ•°æ®åªèƒ½å­˜åœ¨ä¸€ä¸ªå¯å˜å¼•ç”¨</strong>ã€‚å¦åˆ™ç¼–è¯‘æŠ¥é”™ã€‚</p>
<p>è¿™æ¡é™åˆ¶ä¸æ˜¯ä¸ºäº†æŠ˜ç£¨äººï¼Œè€Œæ˜¯ä¸ºäº†åœ¨ç¼–è¯‘æœŸæ¶ˆç­â€œæ•°æ®ç«äº‰â€çš„ç»å…¸æˆå› ï¼š</p>
<ul>
<li>å¤šä¸ªæŒ‡é’ˆåŒæ—¶è®¿é—®åŒä¸€æ•°æ®</li>
<li>è‡³å°‘ä¸€ä¸ªåœ¨å†™</li>
<li>æ²¡æœ‰åŒæ­¥æœºåˆ¶
è¿™ä¸‰æ¡å‡‘é½ï¼Œå°±å¯èƒ½å‡ºç°æœªå®šä¹‰è¡Œä¸ºã€‚Rust é€‰æ‹©ç›´æ¥ä¸è®©è¿™ç§ä»£ç é€šè¿‡ç¼–è¯‘ã€‚</li>
</ul>
<p>ä¸€ä¸ªå¾ˆå®ç”¨çš„å°æŠ€å·§æ˜¯ï¼šç”¨ <code>{}</code> ç¼©å°å€Ÿç”¨ä½œç”¨åŸŸï¼Œè®©å‰ä¸€ä¸ªå¯å˜å€Ÿç”¨å°½æ—©ç»“æŸï¼Œå†åˆ›å»ºä¸‹ä¸€ä¸ªã€‚</p>
<h2 data-id="heading-17">å¯å˜ä¸ä¸å¯å˜ä¸èƒ½æ··ç”¨ï¼šè¯»è€…ä¸å¸Œæœ›ä¹¦è¢«å½“åœºæ”¹å†™</h2>
<p>å€Ÿç”¨è¿˜æœ‰ä¸€æ¡æ€»è§„åˆ™ï¼ˆä¹Ÿæ˜¯ä½ æœªæ¥æœ€å¸¸ç”¨çš„å¿ƒæ³•ï¼‰ï¼š</p>
<ul>
<li>åŒä¸€æ—¶åˆ»ï¼šè¦ä¹ˆ<strong>ä¸€ä¸ªå¯å˜å¼•ç”¨</strong>ï¼Œè¦ä¹ˆ<strong>ä»»æ„å¤šä¸ªä¸å¯å˜å¼•ç”¨</strong></li>
<li>å¼•ç”¨å¿…é¡»æ€»æ˜¯æœ‰æ•ˆçš„</li>
</ul>
<p>ç›´è§‰è§£é‡Šï¼šå¤šä¸ªåªè¯»åŒæ—¶å­˜åœ¨æ²¡é—®é¢˜ï¼Œå› ä¸ºå¤§å®¶éƒ½ä¸å†™ï¼›ä½†åªè¦æœ‰äººå†™ï¼Œå°±å¿…é¡»ä¿è¯â€œå†™çš„æ—¶å€™æ²¡äººè¯»ã€æ²¡äººä¹Ÿåœ¨å†™â€ï¼Œå¦åˆ™ä½ è¯»åˆ°çš„å¯èƒ½æ˜¯åŠæ›´æ–°çŠ¶æ€çš„æ•°æ®ã€‚</p>
<h2 data-id="heading-18">ä½ ä»¥ä¸ºå¼•ç”¨çš„ä½œç”¨åŸŸè·Ÿ <code>{}</code> ä¸€æ ·ï¼ŸRust è¿˜åšäº† NLL ä¼˜åŒ–</h2>
<p>å¾ˆå¤šâ€œçœ‹èµ·æ¥åº”è¯¥èƒ½è¿‡â€çš„ä»£ç ï¼Œå¡åœ¨å€Ÿç”¨æ£€æŸ¥ä¸Šï¼ŒåŸå› å¾€å¾€æ˜¯ï¼šä½ æŠŠå¼•ç”¨çš„æœ‰æ•ˆæœŸæƒ³æˆäº†â€œåˆ°èŠ±æ‹¬å·ç»“æŸâ€ï¼Œä½† Rust æ–°ç¼–è¯‘å™¨ä¼šæ›´èªæ˜ï¼šå¼•ç”¨çš„æœ‰æ•ˆæœŸæŒç»­åˆ°<strong>æœ€åä¸€æ¬¡ä½¿ç”¨</strong>ã€‚</p>
<p>è¿™ç§ä¼˜åŒ–å« <strong>Non-Lexical Lifetimesï¼ˆNLLï¼‰</strong>ã€‚å®ƒè®©å¾ˆå¤šè¿‡å»éœ€è¦â€œæ‰‹åŠ¨æ”¹ç»“æ„â€çš„ä»£ç ï¼Œç°åœ¨å¯ä»¥è‡ªç„¶é€šè¿‡ã€‚</p>
<h2 data-id="heading-19">æ‚¬å‚å¼•ç”¨ï¼šRust åœ¨ç¼–è¯‘æœŸå°±æŠŠâ€œæ‹¿ç€ç©ºæ°”åœ°å€â€è¿™äº‹å µæ­»</h2>
<p>æ‚¬å‚å¼•ç”¨ï¼ˆDangling Referenceï¼‰å°±æ˜¯ï¼šæŒ‡é’ˆè¿˜åœ¨ï¼Œä½†å®ƒæŒ‡å‘çš„å€¼å·²ç»è¢«é‡Šæ”¾æˆ–è¢«é‡ç”¨ã€‚å¾ˆå¤šè¯­è¨€é‡Œè¿™æ˜¯è¿è¡Œæ—¶ç‚¸å¼¹ï¼›Rust çš„ç›®æ ‡æ˜¯è®©å®ƒå˜æˆç¼–è¯‘æ—¶é”™è¯¯ã€‚</p>
<p>ç»å…¸é”™è¯¯ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">dangle</span>() <span class="hljs-punctuation">-&gt;</span> &amp;<span class="hljs-type">String</span> {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"hello"</span>);
    &amp;s
} <span class="hljs-comment">// s ç¦»å¼€ä½œç”¨åŸŸè¢«é‡Šæ”¾</span>
</code></pre>
<p>å‡½æ•°è¿”å›äº† <code>s</code> çš„å¼•ç”¨ï¼Œä½† <code>s</code> åœ¨å‡½æ•°ç»“æŸæ—¶å°±è¢« drop äº†ï¼Œå¼•ç”¨å°†æŒ‡å‘æ— æ•ˆå†…å­˜ã€‚Rust ä¼šç›´æ¥æ‹’ç»ç¼–è¯‘ï¼Œå¹¶æç¤ºï¼šè¿”å›ç±»å‹åŒ…å«å€Ÿç”¨å€¼ï¼Œä½†æ‰¾ä¸åˆ°å¯å€Ÿç”¨çš„æ¥æºã€‚</p>
<p>è§£å†³æ–¹å¼å¾€å¾€å¾ˆâ€œRustâ€ï¼š<strong>ç›´æ¥è¿”å›æ‹¥æœ‰æ‰€æœ‰æƒçš„å€¼</strong>ï¼Œè®©æ‰€æœ‰æƒç§»åŠ¨ç»™è°ƒç”¨è€…ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">no_dangle</span>() <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">String</span> {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">s</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from</span>(<span class="hljs-string">"hello"</span>);
    s
}
</code></pre>
<p>è¿™æ®µå°±æ²¡æœ‰æ‚¬å‚å¼•ç”¨é£é™©äº†ã€‚</p>
<h2 data-id="heading-20">æŠŠå®ƒä»¬ä¸²èµ·æ¥ï¼šä¸€ä¸ªå®ç”¨çš„å¿ƒæ™ºæ¨¡å‹</h2>
<p>åˆ°è¿™é‡Œï¼Œä½ å¯ä»¥ç”¨ä¸€å¥è¯æŠŠæ‰€æœ‰æƒç³»ç»Ÿè®°ä½ï¼š</p>
<blockquote>
<p>Rust ç”¨â€œå”¯ä¸€æ‰€æœ‰è€… + å€Ÿç”¨è§„åˆ™â€æ¥ç®¡ç†å †ä¸Šèµ„æºçš„é‡Šæ”¾è´£ä»»ï¼Œå¹¶åœ¨ç¼–è¯‘æœŸé˜»æ­¢åˆ«åå†™å…¥ã€æ‚¬å‚å¼•ç”¨å’Œæ•°æ®ç«äº‰ã€‚</p>
</blockquote>
<p>å†æŠŠå®ƒæ˜ å°„åˆ°å †æ ˆï¼š</p>
<ul>
<li>æ ˆä¸Šç®€å•å€¼ï¼ˆå›ºå®šå¤§å°ï¼‰å¤§å¤š Copyï¼šå¤åˆ¶æˆæœ¬å°ï¼Œæ²¡é‡Šæ”¾è´Ÿæ‹…</li>
<li>å †ä¸Šèµ„æºï¼ˆ<code>String</code>ã€<code>Vec</code> ç­‰ï¼‰é»˜è®¤ Moveï¼šè½¬ç§»é‡Šæ”¾è´£ä»»ï¼Œé¿å…äºŒæ¬¡é‡Šæ”¾</li>
<li>å€Ÿç”¨ï¼ˆå¼•ç”¨ï¼‰è®©ä½ â€œä¸æ‹¿èµ°æ‰€æœ‰æƒä¹Ÿèƒ½ç”¨â€ï¼šä½†è¯»å†™åˆ«åå¿…é¡»è¢«è§„åˆ™çº¦æŸï¼Œå¦åˆ™å°±å›åˆ° C çš„ä¸å®‰å…¨ä¸–ç•Œ</li>
</ul>
<p>ä½ ä¼šé€æ¸å‘ç°ï¼šRust ä¸æ˜¯â€œé™åˆ¶å¤šâ€ï¼Œè€Œæ˜¯æŠŠè¿‡å»è¿è¡Œæ—¶æ‰çˆ†ç‚¸çš„é—®é¢˜ï¼Œæå‰åˆ°ä½ å†™ä»£ç çš„é‚£ä¸€åˆ»å°±æŒ‡å‡ºæ¥ã€‚å®ƒè®©ä½ æ…¢ä¸€ç‚¹å†™å¯¹ï¼Œä½†å¿«å¾ˆå¤šç»´æŠ¤ã€‚</p>
<h2 data-id="heading-21">å€Ÿç”¨è§„åˆ™é€Ÿè®°å¡</h2>
<ul>
<li>å€¼çš„æ‰€æœ‰è€…ç¦»å¼€ä½œç”¨åŸŸå°± dropï¼ˆå¯¹å †èµ„æºå°¤å…¶å…³é”®ï¼‰</li>
<li><code>String</code> è¿™ç±»æ‹¥æœ‰å †èµ„æºçš„ç±»å‹ï¼Œèµ‹å€¼/ä¼ å‚é»˜è®¤ moveï¼ˆæ—§å˜é‡å¤±æ•ˆï¼‰</li>
<li>éœ€è¦ä¸¤ä»½æ•°æ®å°± <code>clone()</code>ï¼Œä½†è¦æ„è¯†åˆ°å®ƒä¼šæ·±æ‹·è´ã€ä¼šè´µ</li>
<li>å€Ÿç”¨æ€»ç»“ï¼šåŒä¸€æ—¶åˆ»è¦ä¹ˆ 1 ä¸ª <code>&amp;mut</code>ï¼Œè¦ä¹ˆ N ä¸ª <code>&amp;</code>ï¼›å¼•ç”¨å¿…é¡»æœ‰æ•ˆ</li>
<li>è¿”å›å±€éƒ¨å˜é‡å¼•ç”¨ä¼šå¯¼è‡´æ‚¬å‚å¼•ç”¨é£é™©ï¼ŒRust ä¼šæ‹’ç»ç¼–è¯‘ï¼›é€šå¸¸æ”¹ä¸ºè¿”å›æ‹¥æœ‰æ‰€æœ‰æƒçš„å€¼</li>
</ul>
<p>ï¼ˆå®Œï¼‰</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Jetpack Composeé‡ç»„ç¨³å®šæ€§åˆ†æå™¨]]></title>    <link>https://juejin.cn/post/7598390354292621358</link>    <guid>https://juejin.cn/post/7598390354292621358</guid>    <pubDate>2026-01-23T15:15:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598390354292621358" data-draft-id="7598390244380327974" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Jetpack Composeé‡ç»„ç¨³å®šæ€§åˆ†æå™¨"/> <meta itemprop="keywords" content="Android,Android Jetpack,Kotlin"/> <meta itemprop="datePublished" content="2026-01-23T15:15:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨€æœ‰çŒ¿è¯‰"/> <meta itemprop="url" content="https://juejin.cn/user/2788017216685784"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Jetpack Composeé‡ç»„ç¨³å®šæ€§åˆ†æå™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2788017216685784/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨€æœ‰çŒ¿è¯‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T15:15:35.000Z" title="Fri Jan 23 2026 15:15:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¯‘è‡ªã€ŒCompose Stability Analyzer: Real-Time Stability Insights for Jetpack Composeã€ï¼ŒåŸæ–‡é“¾æ¥<a href="https://link.juejin.cn?target=https%3A%2F%2Fmedium.com%2Fproandroiddev%2Fcompose-stability-analyzer-real-time-stability-insights-for-jetpack-compose-1399924a0a64" target="_blank" title="https://medium.com/proandroiddev/compose-stability-analyzer-real-time-stability-insights-for-jetpack-compose-1399924a0a64" ref="nofollow noopener noreferrer">medium.com/proandroiddâ€¦</a>ï¼Œç”±Jaewoong Eumå‘å¸ƒäº20251110ã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c0f0fa939f4445b9526f963e0aeb510~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iA5pyJ54y_6K-J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769786135&amp;x-signature=9Lkm5WCZtOHmuoPcTn4cBTgIqWM%3D" alt="0.jpg" loading="lazy"/></p>
<p>Jetpack Compose ä»¥å…¶å£°æ˜å¼ç¼–ç¨‹èŒƒå¼é©æ–°äº† Android UI å¼€å‘ï¼Œä½†è¿™ç§ç®€æ´æ€§èƒŒåå´éšè—ç€å¤æ‚æ€§ï¼šç†è§£é‡ç»„åˆè¡Œä¸ºã€‚å½“ä¸€ä¸ªå¯ç»„åˆå…ƒç´ ä¸å¿…è¦åœ°è¿›è¡Œé‡ç»„åˆæ—¶ï¼Œå°±ä¼šé€ æˆæ€§èƒ½æŸå¤±ï¼ŒCPU å‘¨æœŸä¼šæµªè´¹åœ¨é‡æ–°æ¸²æŸ“å®é™…ä¸Šå¹¶æœªæ”¹å˜çš„ UI ä¸Šã€‚æŒ‘æˆ˜ä¸ä»…åœ¨äºè¯†åˆ«è¿™äº›é—®é¢˜ï¼Œæ›´åœ¨äºç†è§£å®ƒä»¬å‘ç”Ÿçš„<strong>åŸå› </strong>ã€‚</p>
<p>Compose ç¼–è¯‘å™¨ä¸€ç›´åœ¨åå°æ‰§è¡Œç¨³å®šæ€§åˆ†æï¼Œç¡®å®šå“ªäº›å¯ç»„åˆå…ƒç´ åœ¨è¾“å…¥æœªå‘ç”Ÿå˜åŒ–æ—¶å¯ä»¥è·³è¿‡é‡ç»„åˆã€‚ä½†è¿™ç§åˆ†ææ˜¯åœ¨ç¼–è¯‘æ—¶é™é»˜è¿›è¡Œçš„ï¼Œå¼€å‘è€…æ— æ³•å¾—çŸ¥ä»–ä»¬çš„å¯ç»„åˆå…ƒç´ æ˜¯å¦å¾—åˆ°äº†ä¼˜åŒ–ã€‚ä½ å¯èƒ½ç¼–å†™å‡ºçœ‹ä¼¼å®Œç¾ç¨³å®šçš„ä»£ç ï¼Œä½†ä¹‹åå´å‘ç°ç±»ä¸­ä¸€ä¸ª <code>var</code> å±æ€§å°±è¶³ä»¥å¯¼è‡´æ•´ä¸ªä»£ç ä¸ç¨³å®šï¼Œå¹¶æ³¢åŠæ•´ä¸ª UI æ ‘ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fskydoves%2Fcompose-stability-analyzer" target="_blank" title="https://github.com/skydoves/compose-stability-analyzer" ref="nofollow noopener noreferrer">Compose Stability Analyzer</a> å°†è¿™ç§éšè—çš„åˆ†ææ­ç¤ºå‡ºæ¥ã€‚å®ƒæ˜¯ä¸€å¥—å…¨é¢çš„å·¥å…·é›†ï¼Œå¯åœ¨ IDE ä¸­æä¾›å®æ—¶å¯è§†åŒ–åé¦ˆï¼Œé€šè¿‡æ³¨è§£è¿›è¡Œè¿è¡Œæ—¶ä»£ç é‡ç»„è¿½è¸ªï¼Œå¹¶åœ¨ CI æµæ°´çº¿ä¸­è¿›è¡Œç¨³å®šæ€§éªŒè¯ã€‚æ— éœ€ç­‰åˆ°æ€§èƒ½é—®é¢˜åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å‡ºç°ï¼Œä½ å°±èƒ½åœ¨ç¼–ç è¿‡ç¨‹ä¸­è·å¾—å³æ—¶åé¦ˆï¼Œä½¿ç¨³å®šæ€§åˆ†æè‡ªç„¶è€Œç„¶åœ°èå…¥ä½ çš„å¼€å‘å·¥ä½œæµç¨‹ã€‚</p>
<p>æœ¬æ–‡å°†æ¢è®¨ Compose ç¨³å®šæ€§åˆ†æå™¨çš„å·¥ä½œåŸç†ï¼ŒåŒ…æ‹¬ï¼šIntelliJ æ’ä»¶ï¼ˆä¸ºä½ çš„ IDE æä¾›å¯è§†åŒ–çš„ç¨³å®šæ€§æŒ‡ç¤ºå™¨ï¼‰ã€ç¼–è¯‘å™¨æ’ä»¶ï¼ˆå¯ç”¨è¿è¡Œæ—¶é‡ç»„è·Ÿè¸ªï¼‰ä»¥åŠç¨³å®šæ€§éªŒè¯ç³»ç»Ÿï¼ˆé˜²æ­¢å›å½’é—®é¢˜å½±å“ç”Ÿäº§ç¯å¢ƒï¼‰ã€‚</p>
<h2 data-id="heading-0">ç†è§£ç¨³å®šæ€§é—®é¢˜ï¼šä¸ºä»€ä¹ˆå¯ç»„åˆå‡½æ•°ä¼šé‡ç»„</h2>
<p>åœ¨æ·±å…¥å·¥å…·ä¹‹å‰ï¼Œå€¼å¾—äº†è§£ Compose ç¼–è¯‘å™¨å®é™…ä¸Šåˆ†æçš„å†…å®¹ã€‚ç¼–è¯‘å™¨ä¼šå¯¹æ¯ä¸ªå¯ç»„åˆå‡½æ•°æ‰§è¡Œç¨³å®šæ€§æ¨æ–­ï¼Œå›ç­”ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<p><strong>1. è¿™ä¸ªå¯ç»„åˆå‡½æ•°å¯ä»¥è·³è¿‡å—ï¼Ÿ</strong>
å½“ç¼–è¯‘å™¨èƒ½å¤Ÿè¯æ˜ä½¿ç”¨ç›¸åŒçš„è¾“å…¥é‡æ–°ç»„åˆè¯¥å‡½æ•°ä¼šäº§ç”Ÿç›¸åŒçš„ç»“æœæ—¶ï¼Œè¯¥å¯ç»„åˆå‡½æ•°å°±æ˜¯å¯è·³è¿‡çš„ã€‚å¦‚æœæ‰€æœ‰å‚æ•°éƒ½æ˜¯ç¨³å®šçš„å¹¶ä¸”æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå¯ç»„åˆå‡½æ•°å¯ä»¥å®Œå…¨è·³è¿‡é‡æ–°ç»„åˆï¼Œè¿™æ˜¯ä¸€ä¸ªæ˜¾è‘—çš„æ€§èƒ½ä¼˜åŒ–ã€‚</p>
<p><strong>2. è¯¥å¯ç»„åˆé¡¹æ˜¯å¦å¯é‡å¯ï¼Ÿ</strong></p>
<p>å½“ä¸€ä¸ªå¯ç»„åˆé¡¹å¯ä»¥ç‹¬ç«‹é‡æ–°ç»„åˆè€Œæ— éœ€é‡æ–°ç»„åˆå…¶çˆ¶é¡¹æ—¶ï¼Œè¯¥å¯ç»„åˆé¡¹æ˜¯å¯é‡å¯çš„ã€‚è¿™ä½¿å¾—é‡æ–°ç»„åˆæ›´åŠ ç»†ç²’åº¦ã€‚å¤§å¤šæ•°å¯ç»„åˆé¡¹éƒ½æ˜¯å¯é‡å¯çš„ï¼Œä½†å¸¦æœ‰æŸäº›ä¿®é¥°ç¬¦çš„å¯ç»„åˆé¡¹å¯èƒ½ä¸æ˜¯ã€‚</p>
<p>è¿™é‡Œçš„å…³é”®æ¦‚å¿µæ˜¯<strong>å‚æ•°ç¨³å®šæ€§</strong>ã€‚å½“ Compose ç¼–è¯‘å™¨èƒ½å¤Ÿå¯é åœ°æ£€æµ‹åˆ°å‚æ•°å€¼æ˜¯å¦å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¯¥å‚æ•°æ˜¯ç¨³å®šçš„ã€‚è§„åˆ™éå¸¸å¤æ‚ï¼Œå¦‚æœä½ æƒ³æ·±å…¥äº†è§£è¿™äº›è§„åˆ™ï¼Œå¯ä»¥å‚è€ƒç¨³å®šæ€§ç ”ç©¶<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fskydoves%2Fcompose-stability-inference" target="_blank" title="https://github.com/skydoves/compose-stability-inference" ref="nofollow noopener noreferrer">Compose ç¨³å®šæ€§æ¨æ–­</a>ã€‚</p>
<h2 data-id="heading-1">åœ¨ Android Studio ä¸­è¿›è¡Œå¯è§†åŒ–ç¨³å®šæ€§åˆ†æ</h2>
<p>Compose Stability Analyzer IntelliJ æ’ä»¶å¯å°†ç¨³å®šæ€§åˆ†æç›´æ¥é›†æˆåˆ° Android Studio å’Œ IntelliJ IDEA ä¸­ï¼Œåœ¨ä½ ç¼–å†™ä»£ç æ—¶æä¾›å››å±‚å¯è§†åŒ–åé¦ˆã€‚</p>
<h3 data-id="heading-2">å®‰è£…å’Œè®¾ç½®</h3>
<p>å®‰è£…æ’ä»¶éå¸¸ç®€å•ï¼š</p>
<ol>
<li>
<p>æ‰“å¼€ <strong>Android Studio</strong> â†’ <strong>è®¾ç½®</strong> â†’ <strong>æ’ä»¶</strong> â†’ <strong>åº”ç”¨å¸‚åœº</strong>ã€‚</p>
</li>
<li>
<p>æœç´¢â€œCompose Stability Analyzerâ€ã€‚</p>
</li>
<li>
<p>ç‚¹å‡» <strong>å®‰è£…</strong> å¹¶é‡å¯ IDEã€‚</p>
</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f046aa993e04497f8418fb5fa6901dec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iA5pyJ54y_6K-J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769786135&amp;x-signature=n0wA6JRzwwVQz3PQc32Q9NmPP70%3D" alt="1.png" loading="lazy"/></p>
<p>å®‰è£…å®Œæˆåï¼Œæ’ä»¶ä¼šç«‹å³å¼€å§‹åˆ†æä½ çš„ä»£ç ã€‚æ— éœ€ä»»ä½•é…ç½®ï¼Œå®ƒå¯ä¸ä»»ä½• Compose é¡¹ç›®å¼€ç®±å³ç”¨ã€‚</p>
<h3 data-id="heading-3">è¾¹æ å›¾æ ‡ï¼šå³æ—¶è§†è§‰åé¦ˆ</h3>
<p>æœ€ç›´è§‚çš„åŠŸèƒ½æ˜¯è¾¹æ å›¾æ ‡ï¼Œå³å‡ºç°åœ¨å¯ç»„åˆå‡½æ•°å·¦ä¾§è¾¹æ çš„å½©è‰²åœ†ç‚¹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02eeab62372e4884a18290c0e4755e60~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iA5pyJ54y_6K-J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769786135&amp;x-signature=SiekshEEDIDbLmVLDNXj6onuLdI%3D" alt="2.png" loading="lazy"/></p>
<ul>
<li>
<p><strong>ç»¿ç‚¹</strong>ï¼šæ­¤å¯ç»„åˆå‡½æ•°å¯è·³è¿‡ã€‚æ‰€æœ‰å‚æ•°å‡ç¨³å®šï¼Œç¼–è¯‘å™¨å¯ä»¥ä¼˜åŒ–é‡æ–°ç»„åˆã€‚</p>
</li>
<li>
<p><strong>é»„ç‚¹</strong>ï¼šæ­¤å¯ç»„åˆå‡½æ•°å¯é‡å¯ï¼Œä½†ä¸å¯è·³è¿‡ã€‚å®ƒä¼šåœ¨å…¶çˆ¶å‡½æ•°é‡æ–°ç»„åˆæ—¶é‡æ–°ç»„åˆã€‚</p>
</li>
<li>
<p><strong>çº¢ç‚¹</strong>ï¼šæ­¤å¯ç»„åˆå‡½æ•°çš„å‚æ•°ä¸ç¨³å®šï¼Œæ— æ³•è¿›è¡Œä¼˜åŒ–ã€‚</p>
</li>
</ul>
<p>è¿™ç§å³æ—¶è§†è§‰åé¦ˆæ˜¯å¿«é€Ÿå‘ç° Jetpack Compose æ€§èƒ½é—®é¢˜çš„æœ€ä½³æ–¹æ³•ã€‚åªéœ€å¿«é€Ÿæµè§ˆå·¦ä¾§è¾¹æ ï¼Œå³å¯äº†è§£å“ªäº›å¯ç»„åˆå‡½æ•°éœ€è¦å…³æ³¨ã€‚å¦‚æœå±å¹•ä¸Šå¸ƒæ»¡çº¢ç‚¹ï¼Œåˆ™è¯´æ˜éœ€è¦è¿›è¡Œä¸€äº›ä¼˜åŒ–å·¥ä½œã€‚</p>
<p>è¾¹æ å›¾æ ‡çš„è®¡ç®—åŸºäº Compose ç¼–è¯‘å™¨æ‰§è¡Œçš„ç›¸åŒç¨³å®šæ€§åˆ†æã€‚è¯¥æ’ä»¶ä¼šæ¥å…¥ç¼–è¯‘å™¨çš„åˆ†æé˜¶æ®µå¹¶æå–ç¨³å®šæ€§ä¿¡æ¯ï¼Œç„¶ååœ¨ç¼–è¾‘å™¨ä¸­ä»¥å¯è§†åŒ–çš„æ–¹å¼å‘ˆç°ã€‚</p>
<p>ä½†è¯·æ³¨æ„ï¼Œç›®å‰<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.com%2Fdevelop%2Fui%2Fcompose%2Fperformance%2Fstability%2Fstrongskipping" target="_blank" title="https://developer.android.com/develop/ui/compose/performance/stability/strongskipping" ref="nofollow noopener noreferrer">å¼ºè·³è¿‡æ¨¡å¼</a>é»˜è®¤å¤§å¤šå·²å¯ç”¨ï¼Œå› æ­¤æ‰€æœ‰å¯ç»„åˆå‡½æ•°é»˜è®¤éƒ½å¯ä»¥è·³è¿‡ã€‚ä½ å¯ä»¥åœ¨æ’ä»¶é…ç½®ä¸­å¯ç”¨æˆ–ç¦ç”¨å¼ºè·³è¿‡æ¨¡å¼æ£€æŸ¥ï¼ˆå·¥å…· &gt; Compose ç¨³å®šæ€§åˆ†æå™¨ï¼‰ï¼Œè¯¥åŠŸèƒ½è‡ª 0.5.0 ç‰ˆæœ¬èµ·ä¹Ÿé»˜è®¤å¯ç”¨ã€‚å¦‚æœä½ å¸Œæœ›æ›´åŠ å…³æ³¨ç¨³å®šæ€§é—®é¢˜ï¼Œå¯ä»¥æ ¹æ®å®é™…æƒ…å†µå°†å…¶å…³é—­ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67aa0e93ecc14fd6b49bee86d4e48238~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iA5pyJ54y_6K-J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769786135&amp;x-signature=vbCLh3FodbXpdey1qkOC1eDZmrY%3D" alt="3" loading="lazy"/></p>
<h3 data-id="heading-4">æ‚¬åœæç¤ºï¼šäº†è§£åŸå› </h3>
<p>è¾¹æ å›¾æ ‡å‘Šè¯‰ä½ <strong>å“ªé‡Œ</strong>å‡ºäº†é—®é¢˜ï¼Œè€Œæ‚¬åœæç¤ºåˆ™å‘Šè¯‰ä½ <strong>ä¸ºä»€ä¹ˆ</strong>ã€‚å½“ä½ å°†é¼ æ ‡æ‚¬åœåœ¨å¯ç»„åˆå‡½æ•°åç§°ä¸Šæ—¶ï¼Œä¼šæ˜¾ç¤ºè¯¦ç»†çš„æç¤ºä¿¡æ¯ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7a1511f3cab4426b968e041354432c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iA5pyJ54y_6K-J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769786135&amp;x-signature=ifiVLKiYjMF%2BiCT7DtU9IJZGq%2FY%3D" alt="4" loading="lazy"/></p>
<p>æç¤ºä¿¡æ¯æ˜¾ç¤ºï¼š</p>
<ul>
<li>
<p>å¯ç»„åˆå‡½æ•°æ˜¯å¦å¯è·³è¿‡å’Œå¯é‡å¯</p>
</li>
<li>
<p>ç¨³å®šå‚æ•°ä¸ä¸ç¨³å®šå‚æ•°çš„æ€»æ•°</p>
</li>
<li>
<p>æ¯ä¸ªå‚æ•°çš„è¯¦ç»†ç¨³å®šæ€§ä¿¡æ¯</p>
</li>
<li>
<p>æ¥æ”¶å™¨ç¨³å®šæ€§ï¼ˆé’ˆå¯¹æ‰©å±•å‡½æ•°ï¼‰</p>
</li>
</ul>
<p>è¿™ç§ç»†è‡´çš„åé¦ˆå¯¹äºè°ƒè¯•è‡³å…³é‡è¦ã€‚ä½ æ— éœ€çŒœæµ‹å“ªä¸ªå‚æ•°å¯¼è‡´äº†ä¸ç¨³å®šï¼Œè€Œæ˜¯å¯ä»¥å‡†ç¡®åœ°çœ‹åˆ°å“ªäº›å‚æ•°å­˜åœ¨é—®é¢˜ã€‚</p>
<h3 data-id="heading-5">å†…è”å‚æ•°æç¤ºï¼šç²¾ç»†åŒ–å¯è§æ€§</h3>
<p>å·¥å…·æç¤ºä¼šåœ¨é¼ æ ‡æ‚¬åœæ—¶æä¾›è¯¦ç»†ä¿¡æ¯ï¼Œè€Œå†…è”å‚æ•°æç¤ºåˆ™æ— éœ€ä»»ä½•äº¤äº’å³å¯æä¾›æŒç»­å¯è§æ€§ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c3956e76e95a4f02a6a39de1a4fcd370~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iA5pyJ54y_6K-J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769786135&amp;x-signature=t0tRRmxoKSkWH9mywlL%2BkfuZfZc%3D" alt="5.png" loading="lazy"/></p>
<p>å‡½æ•°ç­¾åä¸­æ¯ä¸ªå‚æ•°ç±»å‹æ—è¾¹éƒ½ä¼šæ˜¾ç¤ºå°å¾½ç« ï¼ŒæŒ‡ç¤ºè¯¥å‚æ•°æ˜¯ç¨³å®šè¿˜æ˜¯ä¸ç¨³å®šã€‚è¿™æ˜¯æœ€è¯¦ç»†çš„åé¦ˆçº§åˆ«ï¼›æ¯ä¸ªå‚æ•°çš„ç¨³å®šæ€§ä¸€ç›®äº†ç„¶ã€‚</p>
<p>å¯¹äºå‚æ•°ä¼—å¤šçš„å‡½æ•°ï¼Œè¿™æœ‰åŠ©äºä½ å¿«é€Ÿæµè§ˆå¹¶è¯†åˆ«æœ‰é—®é¢˜çš„å‚æ•°ï¼Œè€Œæ— éœ€æ‰“å¼€å·¥å…·æç¤ºã€‚é¢œè‰²ç¼–ç ä¸ç¨³å®šæ€§çŠ¶æ€ç›¸å¯¹åº”ï¼š</p>
<ul>
<li>
<p>ç»¿è‰²å¾½ç« ï¼šå‚æ•°ç¨³å®š</p>
</li>
<li>
<p>çº¢è‰²å¾½ç« ï¼šå‚æ•°ä¸ç¨³å®š</p>
</li>
<li>
<p>é»„è‰²å¾½ç« ï¼šç¨³å®šæ€§å°†åœ¨è¿è¡Œæ—¶å†³å®šï¼ˆå› æ­¤å¯èƒ½ç¨³å®šä¹Ÿå¯èƒ½ä¸ç¨³å®šï¼‰</p>
</li>
</ul>
<h3 data-id="heading-6">ä»£ç æ£€æŸ¥ï¼šè‡ªåŠ¨å»ºè®®</h3>
<p>ç¬¬å››å±‚åé¦ˆæ˜¯ä¸»åŠ¨ä»£ç æ£€æŸ¥ã€‚å½“æ’ä»¶æ£€æµ‹åˆ°ä¸ç¨³å®šçš„ç»„åˆä½“æ—¶ï¼Œå®ƒå¯ä»¥ï¼š</p>
<ol>
<li>
<p><strong>ç”¨è­¦å‘Šä¸‹åˆ’çº¿çªå‡ºæ˜¾ç¤ºé—®é¢˜</strong>ã€‚</p>
</li>
<li>
<p><strong>é€šè¿‡ Alt+Enter èœå•æä¾›å¿«é€Ÿä¿®å¤å»ºè®®</strong>ã€‚</p>
</li>
<li>
<p><strong>æä¾›æ·»åŠ æ³¨è§£ï¼ˆä¾‹å¦‚ <code>@TraceRecomposition</code>ï¼‰</strong> ä»¥è¿›è¡Œè°ƒè¯•ã€‚</p>
</li>
<li>
<p><strong>æä¾›æŠ‘åˆ¶é€‰é¡¹</strong>ï¼ˆå¦‚æœä¸ç¨³å®šæ˜¯æ•…æ„çš„ï¼‰ã€‚</p>
</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/198a9b958db349a1829f45528aa87acb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iA5pyJ54y_6K-J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769786135&amp;x-signature=M81TxjBmCyyCvNvEdNYGUzW4J5U%3D" alt="6" loading="lazy"/></p>
<p>æ’ä»¶åœ¨æ­¤å¼€å§‹ä¸»åŠ¨å‡ºå‡»ã€‚å®ƒä¸ä»…ä¼šæŒ‡å‡ºé—®é¢˜ï¼Œè¿˜ä¼šæä¾›è§£å†³æ–¹æ¡ˆã€‚åœ¨ä¸ç¨³å®šçš„ç»„åˆä½“ä¸ŠæŒ‰ä¸‹ Alt+Enterï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°å¦‚ä¸‹é€‰é¡¹ï¼š</p>
<ul>
<li>
<p>æ·»åŠ  <code>@TraceRecomposition</code> ä»¥ç›‘æ§é‡æ–°ç»„åˆã€‚</p>
</li>
<li>
<p>ä½¿ç”¨ <code>@Stable</code> æ³¨è§£è¿›è¡Œæ ‡è®°ï¼ˆè¯·è°¨æ…ä½¿ç”¨ï¼‰ã€‚</p>
</li>
<li>
<p>æŠ‘åˆ¶æ­¤å‡½æ•°çš„ç¨³å®šæ€§è­¦å‘Šã€‚</p>
</li>
</ul>
<h3 data-id="heading-7">ç¨³å®šæ€§æµè§ˆå™¨ï¼šåŒ…çº§åˆ†æ</h3>
<p>é™¤äº†å•ä¸ªå‡½æ•°åˆ†æä¹‹å¤–ï¼Œç¨³å®šæ€§æµè§ˆå™¨è¿˜æä¾›æ•´ä¸ªä»£ç åº“ç¨³å®šæ€§çš„æ¦‚è§ˆï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d875bdd5845f4cbe93875a464fbf433a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iA5pyJ54y_6K-J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769786135&amp;x-signature=cLm9%2BMB8hXv0WCjA8dUgITTUfdM%3D" alt="7" loading="lazy"/></p>
<p>å¯ç”¨æ–¹æ³•ï¼š</p>
<ol>
<li>
<p>å®‰è£… Compose Stability Analyzer Gradle æ’ä»¶ï¼ˆä¸‹ä¸€èŠ‚å°†ä»‹ç»ï¼‰ã€‚</p>
</li>
<li>
<p>è½¬åˆ°â€œè§†å›¾â€â†’â€œå·¥å…·çª—å£â€â†’â€œCompose Stability Analyzerâ€ã€‚</p>
</li>
<li>
<p>æ„å»ºé¡¹ç›®å¹¶å•å‡»åˆ·æ–°æŒ‰é’®ã€‚</p>
</li>
</ol>
<p>æµè§ˆå™¨ä»¥æ ‘çŠ¶è§†å›¾æ˜¾ç¤ºåŒ…ç»“æ„ï¼Œæ¯ä¸ªå¯ç»„åˆå‡½æ•°éƒ½å¸¦æœ‰å…¶ç¨³å®šæ€§çŠ¶æ€çš„æ³¨è§£ã€‚ä½ å¯ä»¥å¿«é€Ÿæ·±å…¥æŸ¥æ‰¾æ•´ä¸ªä»£ç åº“ä¸­ä¸ç¨³å®šçš„å‡½æ•°ï¼Œä»è€Œè½»æ¾åœ°ç¡®å®šä¼˜åŒ–å·¥ä½œçš„ä¼˜å…ˆçº§ã€‚</p>
<p>è¿™åœ¨å¤§å‹é¡¹ç›®ä¸­å°¤å…¶æœ‰ç”¨ï¼Œå› ä¸ºæ‰‹åŠ¨æ£€æŸ¥æ¯ä¸ªå¯ç»„åˆç»„ä»¶æ˜¯ä¸åˆ‡å®é™…çš„ã€‚è¯¥å·¥å…·ä¼šä¸ºä½ çš„åº”ç”¨ç¨‹åºæä¾›ä¸€ä»½ç¨³å®šæ€§â€œæˆç»©å•â€ï¼Œæ˜¾ç¤ºå“ªäº›åŒ…å­˜åœ¨æœ€å¤šçš„ç¨³å®šæ€§é—®é¢˜ã€‚</p>
<h3 data-id="heading-8">è‡ªå®šä¹‰é…ç½®</h3>
<p>è¯¥æ’ä»¶å…·æœ‰é«˜åº¦å¯å®šåˆ¶æ€§ã€‚ä½ å¯ä»¥è°ƒæ•´é¢œè‰²ã€å¯ç”¨æˆ–ç¦ç”¨ç‰¹å®šçš„è§†è§‰æŒ‡ç¤ºå™¨ï¼Œå¹¶é…ç½®åˆ†æè¡Œä¸ºä»¥æ»¡è¶³ä½ çš„åå¥½ã€‚</p>
<p>å‰å¾€â€œè®¾ç½®â€â†’â€œå·¥å…·â€â†’â€œCompose Stability Analyzerâ€ï¼ˆç»„åˆç¨³å®šæ€§åˆ†æå™¨ï¼‰è®¿é—®é…ç½®é€‰é¡¹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8be0dd62b264f44bae983439f194c05~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iA5pyJ54y_6K-J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769786135&amp;x-signature=ZGy0A3VPG91tVihVjiNMC5MX8ZM%3D" alt="8" loading="lazy"/></p>
<p>ä½ å¯ä»¥ï¼š</p>
<ul>
<li>
<p>æ›´æ”¹è¾¹æ å›¾æ ‡é¢œè‰²ä»¥åŒ¹é…ä½ çš„ IDE ä¸»é¢˜</p>
</li>
<li>
<p>åˆ†åˆ«å¯ç”¨æˆ–ç¦ç”¨å†…è”æç¤ºã€è­¦å‘Šå’Œè¾¹æ å›¾æ ‡</p>
</li>
<li>
<p>é…ç½®å¼ºè·³è¿‡æ¨¡å¼åˆ†æ</p>
</li>
<li>
<p>æ·»åŠ å¿½ç•¥ç±»å‹æ¨¡å¼ä»¥ä»åˆ†æä¸­æ’é™¤æŸäº›ç±»</p>
</li>
<li>
<p>åœ¨æµ‹è¯•æºé›†ä¸­å¯ç”¨åˆ†æ</p>
</li>
<li>
<p>è®¾ç½®è‡ªå®šä¹‰ç¨³å®šæ€§é…ç½®æ–‡ä»¶</p>
</li>
</ul>
<p>è¿™ç§çµæ´»æ€§ç¡®ä¿æ’ä»¶èƒ½å¤Ÿè‡ªç„¶åœ°èå…¥ä½ ç°æœ‰çš„å·¥ä½œæµç¨‹ï¼Œæ— è®ºä½ åå¥½æœ€å°çš„è§†è§‰å¹²æ‰°è¿˜æ˜¯æœ€å¤§çš„ä¿¡æ¯å¯†åº¦ã€‚</p>
<h2 data-id="heading-9">Gradle æ’ä»¶ï¼šè¿è¡Œæ—¶é‡ç»„è¿½è¸ª</h2>
<p>IntelliJ æ’ä»¶æä¾›ç¼–è¯‘æ—¶å¯è§æ€§ï¼Œè€Œ Gradle æ’ä»¶åˆ™æ”¯æŒ<strong>è¿è¡Œæ—¶åˆ†æ</strong>ï¼Œèƒ½å¤Ÿç²¾ç¡®è¿½è¸ªå¯ç»„åˆç»„ä»¶åœ¨è¿è¡Œä¸­çš„é‡ç»„æ—¶é—´å’ŒåŸå› ã€‚è¿™æ˜¯é€šè¿‡ <code>@TraceRecomposition</code> æ³¨è§£å®ç°çš„ï¼Œè¯¥æ³¨è§£æ˜¯ä¸€ä¸ªç¼–è¯‘å™¨æ’ä»¶ï¼Œå®ƒä¼šåœ¨å¯ç»„åˆç»„ä»¶ä¸­æ·»åŠ æ—¥å¿—ä»£ç ã€‚</p>
<h3 data-id="heading-10">å®‰è£…å’Œè®¾ç½®</h3>
<p>å°†ä»¥ä¸‹ä¾èµ–é¡¹æ·»åŠ åˆ° <code>libs.versions.toml</code> æ–‡ä»¶ä¸­ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-attr">stability-analyzer</span> = { id = <span class="hljs-string">"com.github.skydoves.compose.stability.analyzer"</span>, version = <span class="hljs-string">"0.5.0"</span> }
</code></pre>
<p>æ¥ä¸‹æ¥ï¼Œå°†æ’ä»¶åº”ç”¨åˆ°æ ¹ç›®å½•ä¸‹çš„ <code>build.gradle.kts</code> æ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">alias(libs.plugins.stability.analyzer)
</code></pre>
<p>å®Œæˆï¼è¯¥æ’ä»¶ä¼šè‡ªåŠ¨å°†ç¼–è¯‘å™¨æ’ä»¶åº”ç”¨åˆ°é¡¹ç›®ä¸­çš„æ‰€æœ‰ Kotlin ç¼–è¯‘ä»»åŠ¡ã€‚åŸºæœ¬ç”¨æ³•æ— éœ€é¢å¤–é…ç½®ã€‚</p>
<h3 data-id="heading-11">Kotlin ç‰ˆæœ¬å…¼å®¹æ€§</h3>
<p>è¯¥æ’ä»¶ä¸ Kotlin ç¼–è¯‘å™¨ç´§å¯†è€¦åˆï¼Œå› æ­¤ç‰ˆæœ¬ä¸€è‡´æ€§è‡³å…³é‡è¦ã€‚æˆªè‡³æ’°å†™æœ¬æ–‡æ—¶ï¼Œ<strong>ä½ è‡³å°‘åº”ä½¿ç”¨ Kotlin 2.2.21 ç‰ˆæœ¬</strong>ã€‚ä½¿ç”¨ä¸åŒ¹é…çš„ç‰ˆæœ¬å¯èƒ½ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚è¯·å§‹ç»ˆä½¿ç”¨ä¸ä½ çš„ç¨³å®šæ€§åˆ†æå™¨ç‰ˆæœ¬å®Œå…¨åŒ¹é…çš„ Kotlin ç‰ˆæœ¬ã€‚ä½ å¯ä»¥å‚è€ƒ Kotlin ç‰ˆæœ¬æ˜ å°„è¡¨ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fskydoves%2Fcompose-stability-analyzer%3Ftab%3Dreadme-ov-file%23kotlin-version-mapping%25EF%25BC%2589%25E8%258E%25B7%25E5%258F%2596%25E7%259B%25B8%25E5%2585%25B3%25E4%25BF%25A1%25E6%2581%25AF%25E3%2580%2582" target="_blank" title="https://github.com/skydoves/compose-stability-analyzer?tab=readme-ov-file#kotlin-version-mapping%EF%BC%89%E8%8E%B7%E5%8F%96%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E3%80%82" ref="nofollow noopener noreferrer">github.com/skydoves/coâ€¦</a></p>
<h3 data-id="heading-12">@TraceRecomposition æ³¨è§£</h3>
<p>å®‰è£…æ’ä»¶åï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>@TraceRecomposition</code> æ³¨è§£ä»»ä½•å¯ç»„åˆç»„ä»¶ï¼Œä»¥è·Ÿè¸ªå…¶é‡ç»„è¡Œä¸ºï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@TraceRecomposition</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">ProductCard</span><span class="hljs-params">(
    product: <span class="hljs-type">Product</span>,
    onClick: () -&gt; <span class="hljs-type">Unit</span>
)</span></span> {
    Card(onClick = onClick) {
        Text(product.name)
        Text(<span class="hljs-string">"$<span class="hljs-subst">${product.price}</span>"</span>)
    }
}
</code></pre>
<p>å½“æ­¤å¯ç»„åˆç»„ä»¶é‡ç»„æ—¶ï¼Œä½ å°†åœ¨ Logcat ä¸­çœ‹åˆ°è¯¦ç»†çš„æ—¥å¿—ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">D/Recomposition: \[Recomposition <span class="hljs-comment">#1\] ProductCard  </span>
D/Recomposition:   â”œâ”€ product: Product stable (Product@abc123)  
D/Recomposition:   â””â”€ onClick: () -&gt; Unit stable (Function@xyz789)  
D/Recomposition: \[Recomposition <span class="hljs-comment">#2\] ProductCard  </span>
D/Recomposition:   â”œâ”€ product: Product changed (Product@abc123 â†’ Product@def456)  
D/Recomposition:   â””â”€ onClick: () -&gt; Unit stable (Function@xyz789)
</code></pre>
<p>æ—¥å¿—æ˜¾ç¤ºï¼š</p>
<ul>
<li>
<p><strong>é‡ç»„æ¬¡æ•°</strong>ï¼šæ­¤å®ä¾‹å·²é‡ç»„çš„æ¬¡æ•°</p>
</li>
<li>
<p><strong>å‚æ•°ç¨³å®šæ€§</strong>ï¼šæ¯ä¸ªå‚æ•°æ˜¯ç¨³å®šè¿˜æ˜¯ä¸ç¨³å®š</p>
</li>
<li>
<p><strong>å˜æ›´æ£€æµ‹</strong>ï¼šå“ªäº›å‚æ•°å‘ç”Ÿäº†æ›´æ”¹ï¼Œæ˜¾ç¤ºæ–°æ—§å€¼</p>
</li>
<li>
<p><strong>èº«ä»½è·Ÿè¸ª</strong>ï¼šæ¯ä¸ªå‚æ•°å€¼çš„å“ˆå¸Œç </p>
</li>
</ul>
<p>è¿™äº›ç»†ç²’åº¦çš„ä¿¡æ¯å¯¹äºè°ƒè¯•è‡³å…³é‡è¦ã€‚ä½ å¯ä»¥å‡†ç¡®åœ°çœ‹åˆ°æ˜¯å“ªä¸ªå‚æ•°çš„æ›´æ”¹è§¦å‘äº†é‡ç»„ï¼Œä»è€Œå¸®åŠ©ä½ äº†è§£åº”ç”¨ç¨‹åºçš„é‡ç»„æ¨¡å¼ã€‚</p>
<h3 data-id="heading-13">ä½¿ç”¨æ ‡ç­¾å‚æ•°è¿›è¡Œè¿‡æ»¤</h3>
<p>å¯¹äºåŒ…å«å¤§é‡è·Ÿè¸ªå¯ç»„åˆç»„ä»¶çš„å¤§å‹åº”ç”¨ç¨‹åºï¼Œæ—¥å¿—å¯èƒ½ä¼šå˜å¾—éå¸¸åºå¤§ã€‚ <code>tag</code> å‚æ•°å¯ä»¥å¸®åŠ©ä½ ç»„ç»‡å’Œç­›é€‰æ—¥å¿—ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@TraceRecomposition(tag = <span class="hljs-string">"product-list"</span>)</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">ProductCard</span><span class="hljs-params">(product: <span class="hljs-type">Product</span>, onClick: () -&gt; <span class="hljs-type">Unit</span>)</span></span> {
    <span class="hljs-comment">// ...</span>
}

<span class="hljs-meta">@TraceRecomposition(tag = <span class="hljs-string">"user-profile"</span>)</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">ProfileHeader</span><span class="hljs-params">(user: <span class="hljs-type">User</span>)</span></span> {
    <span class="hljs-comment">// ...</span>
}
</code></pre>
<p>ç°åœ¨æ—¥å¿—åŒ…å«ä»¥ä¸‹æ ‡ç­¾ï¼š</p>
<p>D/Recomposition: [Recomposition #1] ProductCard (tag: product-list)</p>
<p>D/Recomposition: [Recomposition #1] ProfileHeader (tag: user-profile)</p>
<p>ä½ å¯ä»¥ç­›é€‰ Logcat ä»¥ä»…æ˜¾ç¤ºç‰¹å®šæ ‡ç­¾ï¼š</p>
<ul>
<li>
<p>æŒ‰ <code>tag: product-list</code> ç­›é€‰ï¼Œä»…æŸ¥çœ‹ä¸äº§å“ç›¸å…³çš„é‡ç»„æ—¥å¿—ã€‚</p>
</li>
<li>
<p>æŒ‰ <code>tag: user-profile</code> ç­›é€‰ï¼Œä»…æŸ¥çœ‹ä¸ç”¨æˆ·ä¸ªäººèµ„æ–™ç›¸å…³çš„é‡ç»„æ—¥å¿—ã€‚</p>
</li>
</ul>
<p>è¿™åœ¨ä¸è‡ªå®šä¹‰æ—¥å¿—è®°å½•å™¨ï¼ˆå°†åœ¨ä¸‹æ–‡ä»‹ç»ï¼‰ç»“åˆä½¿ç”¨æ—¶å°¤å…¶æœ‰ç”¨ï¼Œå› ä¸ºä½ å¯èƒ½åªæƒ³å°†æŸäº›æ ‡ç­¾å‘é€åˆ°åˆ†ææœåŠ¡ã€‚</p>
<h3 data-id="heading-14">è®¾ç½®é˜ˆå€¼ä»¥å‡å°‘å™ªéŸ³</h3>
<p>å¤§å¤šæ•°å¯ç»„åˆç»„ä»¶åœ¨åˆå§‹è®¾ç½®æœŸé—´ä¼šé‡æ–°ç»„åˆ 1-2 æ¬¡ï¼Œè¿™æ˜¯é¢„æœŸè¡Œä¸ºï¼Œ<strong>å¹¶éæ€§èƒ½é—®é¢˜</strong>ã€‚<code>threshold</code> å‚æ•°å¯ä»¥è¿‡æ»¤æ‰è¿™äº›å™ªéŸ³ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@TraceRecomposition(threshold = 3)</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">FrequentlyRecomposingScreen</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// Logs will only appear after the 3rd recomposition</span>
}
</code></pre>
<p>è¿™æ ·å¯ä»¥å°†æ³¨æ„åŠ›é›†ä¸­åœ¨çœŸæ­£çš„é—®é¢˜ä¸Šï¼šç”¨æˆ·äº¤äº’æœŸé—´ä¸æ–­é‡æ–°ç»„åˆçš„å¯ç»„åˆç»„ä»¶ï¼Œè€Œä¸ä»…ä»…æ˜¯åˆå§‹è®¾ç½®ã€‚</p>
<p>ä¸€ä¸ªå®é™…ç”¨ä¾‹ï¼šè®¾ç½®ä¸€ä¸ªè¾ƒé«˜çš„é˜ˆå€¼ï¼Œå¹¶åœ¨è¶…è¿‡è¯¥é˜ˆå€¼æ—¶å‘é€åˆ†æäº‹ä»¶ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@TraceRecomposition(tag = <span class="hljs-string">"checkout"</span>, threshold = 10)</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">CheckoutScreen</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// If this recomposes 10+ times, something is wrong</span>
}
</code></pre>
<p>ç„¶ååœ¨ä½ çš„è‡ªå®šä¹‰æ—¥å¿—è®°å½•å™¨ï¼ˆå‚è§ä¸‹ä¸€èŠ‚ï¼‰ä¸­ï¼Œä½ å¯ä»¥åœ¨è¶…è¿‡é˜ˆå€¼æ—¶å‘é€ Firebase äº‹ä»¶ï¼Œä»è€Œç›‘æ§ç”Ÿäº§ç¯å¢ƒä¸­çš„æ€§èƒ½é—®é¢˜ã€‚</p>
<h3 data-id="heading-15">é…ç½®æ—¥å¿—ç³»ç»Ÿ</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>@TraceRecomposition</code> ä¸ä¼šè®°å½•ä»»ä½•æ—¥å¿—ï¼Œä½ éœ€è¦åœ¨ <code>Application</code> ç±»ä¸­å¯ç”¨æ—¥å¿—è®°å½•ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApp</span> : <span class="hljs-type">Application</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onCreate()

        <span class="hljs-comment">// Enable only in debug builds</span>
        ComposeStabilityAnalyzer.setEnabled(BuildConfig.DEBUG)
    }
}
</code></pre>
<p>è¿™ä¸€ç‚¹éå¸¸é‡è¦ï¼Œå¦‚æœä½ æ²¡æœ‰è‡ªå®šä¹‰æ—¥å¿—è®°å½•å™¨ï¼Œ<strong>åŠ¡å¿…ä½¿ç”¨</strong> <code>**BuildConfig.DEBUG**</code> åŒ…è£¹ï¼Œä»¥é¿å…ç”Ÿäº§æ„å»ºä¸­æ½œåœ¨çš„å®‰å…¨é—®é¢˜ã€‚</p>
<p><strong>è‡ªå®šä¹‰æ—¥å¿—è®°å½•å™¨ï¼šLogcat ä¹‹å¤–çš„é€‰æ‹©</strong> é»˜è®¤æ—¥å¿—è®°å½•å™¨ä½¿ç”¨ Logcatï¼Œä½†ä½ å¯ä»¥æä¾›è‡ªå®šä¹‰å®ç°ï¼Œå°†æ—¥å¿—å‘é€åˆ°ä½ æƒ³è¦çš„ä»»ä½•ä½ç½®ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">ComposeStabilityAnalyzer.setLogger(<span class="hljs-keyword">object</span> : RecompositionLogger {  
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">log</span><span class="hljs-params">(event: <span class="hljs-type">RecompositionEvent</span>)</span></span> {  
        <span class="hljs-comment">// Send to Firebase, Crashlytics, custom analytics, etc.  </span>
        <span class="hljs-keyword">if</span> (event.recompositionCount &gt;= <span class="hljs-number">10</span>) {  
            FirebaseAnalytics.getInstance(<span class="hljs-keyword">this</span>).logEvent(<span class="hljs-string">"excessive\_recomposition"</span>) {  
                param(<span class="hljs-string">"composable"</span>, event.composableName)  
                param(<span class="hljs-string">"count"</span>, event.recompositionCount)  
                param(<span class="hljs-string">"unstable\_params"</span>, event.unstableParameters.joinToString())  
            }  
        }  
    }  
})
</code></pre>
<p>å› æ­¤ï¼Œä½ ç”šè‡³å¯ä»¥æ ¹æ®è°ƒè¯•æ¨¡å¼æˆ–å‘å¸ƒæ¨¡å¼è®¾ç½®ä¸åŒçš„æ—¥å¿—è®°å½•å™¨ã€‚<code>RecompositionEvent</code> åŒ…å«ï¼š</p>
<ul>
<li>
<p><code>composableName</code>ï¼šå‡½æ•°åç§°ã€‚</p>
</li>
<li>
<p><code>tag</code>ï¼šæ¥è‡ª <code>@TraceRecomposition</code> çš„æ ‡ç­¾ã€‚</p>
</li>
<li>
<p><code>recompositionCount</code>ï¼šé‡æ–°ç»„åˆçš„æ¬¡æ•°ã€‚</p>
</li>
<li>
<p><code>parameterChanges</code>ï¼šåŒ…å«ç¨³å®šæ€§ä¿¡æ¯çš„å‚æ•°å˜æ›´åˆ—è¡¨ã€‚</p>
</li>
<li>
<p><code>unstableParameters</code>ï¼šä¸ç¨³å®šå‚æ•°åç§°åˆ—è¡¨ã€‚</p>
</li>
</ul>
<p>è¿™æ”¯æŒå¼ºå¤§çš„ç›‘æ§æ¨¡å¼ã€‚ä½ å¯ä»¥ï¼š</p>
<ul>
<li>
<p>é’ˆå¯¹è¿‡åº¦é‡ç»„çš„ç»„åˆå¯¹è±¡å‘é€åˆ†æäº‹ä»¶</p>
</li>
<li>
<p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è·Ÿè¸ªæ€§èƒ½æŒ‡æ ‡ï¼ˆå¹¶é‡‡å–é€‚å½“çš„éšç§ä¿æŠ¤æªæ–½ï¼‰</p>
</li>
<li>
<p>æ„å»ºæ˜¾ç¤ºé‡ç»„æ¨¡å¼çš„è‡ªå®šä¹‰ä»ªè¡¨æ¿</p>
</li>
<li>
<p>åœ¨æµ‹è¯•ç¯å¢ƒä¸­å‡ºç°æ€§èƒ½ä¸‹é™æ—¶å‘å‡ºè­¦æŠ¥</p>
</li>
</ul>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨æ ‡ç­¾è¿‡æ»¤æ—¥å¿—å†…å®¹çš„æ›´è´´è¿‘å®é™…çš„ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> tagsToLog = setOf(<span class="hljs-string">"checkout"</span>, <span class="hljs-string">"product-list"</span>, <span class="hljs-string">"search"</span>)
ComposeStabilityAnalyzer.setLogger(<span class="hljs-keyword">object</span> : RecompositionLogger {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">log</span><span class="hljs-params">(event: <span class="hljs-type">RecompositionEvent</span>)</span></span> {
        <span class="hljs-keyword">if</span> (BuildConfig.DEBUG) {
            <span class="hljs-comment">// In debug, log everything</span>
            Log.d(<span class="hljs-string">"Recomposition"</span>, formatEvent(event))
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// In release, only log tagged composables that exceed threshold</span>
            <span class="hljs-keyword">if</span> (event.tag <span class="hljs-keyword">in</span> tagsToLog &amp;&amp; event.recompositionCount &gt;= <span class="hljs-number">5</span>) {
                <span class="hljs-comment">// Send to analytics</span>
                FirebaseAnalytics.getInstance(<span class="hljs-keyword">this</span>).logEvent(<span class="hljs-string">"recomposition_issue"</span>, ...)
            }
        }
    }
})
</code></pre>
<h3 data-id="heading-16">ç†è§£æ—¥å¿—</h3>
<p>è®©æˆ‘ä»¬ä¸€èµ·æ¥äº†è§£å¦‚ä½•è§£è¯»æ—¥å¿—ã€‚è¯·çœ‹ä»¥ä¸‹ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">D/Recomposition: \[Recomposition <span class="hljs-comment">#1\] UserCard  </span>
D/Recomposition:   â”œâ”€ user: User stable (User@abc123)  
D/Recomposition:   â””â”€ onClick: () \-\&gt; Unit stable (Function@xyz789)
</code></pre>
<p><strong>è¿™æ„å‘³ç€ï¼š</strong></p>
<ul>
<li>
<p>è¿™æ˜¯æ­¤ <code>UserCard</code> å®ä¾‹çš„é¦–æ¬¡é‡ç»„ã€‚</p>
</li>
<li>
<p>ä¸¤ä¸ªå‚æ•°éƒ½ç¨³å®šã€‚</p>
</li>
<li>
<p>è¿™æ˜¯åˆå§‹é‡ç»„çš„é¢„æœŸè¡Œä¸ºã€‚</p>
</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">D/Recomposition: \[Recomposition <span class="hljs-comment">#2\] UserCard  </span>
D/Recomposition:   â”œâ”€ user: User changed (User@abc123 â†’ User@def456)  
D/Recomposition:   â””â”€ onClick: () \-\&gt; Unit stable (Function@xyz789)
</code></pre>
<p><strong>è¿™æ„å‘³ç€ï¼š</strong></p>
<ul>
<li>
<p>ç¬¬äºŒæ¬¡é‡ç»„ã€‚</p>
</li>
<li>
<p><code>user</code> å‚æ•°å·²æ›´æ”¹ï¼ˆæ–°å®ä¾‹ï¼‰ã€‚</p>
</li>
<li>
<p><code>onClick</code> ä¿æŒä¸å˜ï¼ˆç›¸åŒçš„ lambda å®ä¾‹ï¼‰ã€‚</p>
</li>
<li>
<p>è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œå‚æ•°å·²æ›´æ”¹ï¼Œå› æ­¤éœ€è¦è¿›è¡Œé‡ç»„ã€‚</p>
</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">D/Recomposition: \[Recomposition <span class="hljs-comment">#3\] UserCard (tag: user-profile)  </span>
D/Recomposition:   â”œâ”€ user: MutableUser unstable (MutableUser@xyz789)  
D/Recomposition:   â””â”€ Unstable parameters: \[user\]
</code></pre>
<p><strong>è¿™æ„å‘³ç€ï¼š</strong></p>
<ul>
<li>
<p>ç¬¬ä¸‰æ¬¡é‡ç»„ã€‚</p>
</li>
<li>
<p><code>user</code> å‚æ•°<strong>ä¸ç¨³å®š</strong>ï¼ˆå¯èƒ½å…·æœ‰ <code>var</code> å±æ€§ï¼‰ã€‚</p>
</li>
<li>
<p>å³ä½¿ <code>user</code> æ²¡æœ‰æ›´æ”¹ï¼Œæ­¤å¯ç»„åˆå¯¹è±¡ä¹Ÿä¼šåœ¨æ¯æ¬¡çˆ¶çº§é‡ç»„æ—¶é‡æ–°ç»„åˆã€‚</p>
</li>
<li>
<p><strong>éœ€è¦é‡‡å–çš„æªæ–½</strong>ï¼šå°† <code>MutableUser</code> ç±»ä¿®å¤ä¸ºä¸å¯å˜ã€‚</p>
</li>
</ul>
<h2 data-id="heading-17">ç¨³å®šæ€§éªŒè¯ï¼šé˜²æ­¢ CI ä¸­çš„æ€§èƒ½é€€åŒ–</h2>
<p>Compose ç¨³å®šæ€§åˆ†æå™¨æœ€å¼ºå¤§çš„åŠŸèƒ½å¹¶éå¯è§†åŒ–åé¦ˆæˆ–è¿è¡Œæ—¶è·Ÿè¸ªï¼Œè€Œæ˜¯<strong>é˜²æ­¢ç¨³å®šæ€§é€€åŒ–å½±å“ç”Ÿäº§ç¯å¢ƒ</strong>ã€‚ç¨³å®šæ€§éªŒè¯ç³»ç»Ÿçš„ä½œç”¨ç±»ä¼¼äº git diffï¼Œç”¨äºæ£€æŸ¥å¯ç»„åˆç»„ä»¶çš„ç¨³å®šæ€§ï¼Œå¦‚æœç¨³å®šæ€§ä¸‹é™ï¼Œåˆ™ CI æ„å»ºå¤±è´¥ã€‚</p>
<h3 data-id="heading-18">é—®é¢˜ï¼šé™é»˜çš„æ€§èƒ½é€€åŒ–</h3>
<p>æƒ³è±¡ä¸€ä¸‹è¿™æ ·çš„åœºæ™¯ï¼šä½ èŠ±äº†æ•°å‘¨æ—¶é—´ä¼˜åŒ–ä½ çš„åº”ç”¨ã€‚æ¯ä¸ªå¯ç»„åˆç»„ä»¶éƒ½ç¨³å®šã€å¯è·³è¿‡ä¸”è¿è¡Œé€Ÿåº¦å¿«ã€‚ç„¶åï¼Œä¸€ä½åŒäº‹æ— æ„ä¸­ä¿®æ”¹äº†ä¸€ä¸ªæ•°æ®ç±»ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Before (stable)</span>
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>(<span class="hljs-keyword">val</span> name: String, <span class="hljs-keyword">val</span> age: <span class="hljs-built_in">Int</span>)

<span class="hljs-comment">// After (unstable)</span>
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>(<span class="hljs-keyword">var</span> name: String, <span class="hljs-keyword">var</span> age: <span class="hljs-built_in">Int</span>)
</code></pre>
<p>è¿™ä¸€ç®€å•çš„æ›´æ”¹ä¼šæ³¢åŠæ•´ä¸ª UI æ ‘ã€‚æ•°åä¸ªåŸæœ¬å¯è·³è¿‡çš„å¯ç»„åˆç»„ä»¶å˜å¾—ä¸å¯è·³è¿‡ã€‚æ€§èƒ½é€€åŒ–äº†ï¼Œä½†ä»£ç å®¡æŸ¥å´æœªèƒ½å‘ç°ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•æ˜æ˜¾çš„è¿¹è±¡è¡¨æ˜å‡ºäº†é—®é¢˜ã€‚</p>
<p>ç¨³å®šæ€§éªŒè¯å¯ä»¥é˜²æ­¢è¿™ç§æƒ…å†µå‘ç”Ÿã€‚å®ƒä¼šè·Ÿè¸ªä½ çš„å¯ç»„åˆç»„ä»¶çš„ç¨³å®šæ€§éšæ—¶é—´çš„å˜åŒ–ï¼Œå¹¶åœ¨ç¨³å®šæ€§ä¸‹é™æ—¶è‡ªåŠ¨æ„å»ºå¤±è´¥ï¼Œå¼ºåˆ¶åœ¨åˆå¹¶ä¹‹å‰è§£å†³é—®é¢˜ã€‚</p>
<h3 data-id="heading-19">å·¥ä½œåŸç†ï¼šç¨³å®šæ€§å¿«ç…§</h3>
<p>éªŒè¯ç³»ç»Ÿé€šè¿‡ä¸¤ä¸ª Gradle ä»»åŠ¡è¿è¡Œï¼š</p>
<ul>
<li>
<p><code>**stabilityDump**</code>ï¼šåˆ›å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰å¯ç»„åˆç»„ä»¶ç¨³å®šæ€§çŠ¶æ€çš„ <code>.stability</code> æ–‡ä»¶ã€‚</p>
</li>
<li>
<p><code>**stabilityCheck**</code>ï¼šå°†å½“å‰ä»£ç ä¸åŸºçº¿è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç¨³å®šæ€§ä¸‹é™åˆ™æ„å»ºå¤±è´¥ã€‚</p>
</li>
</ul>
<p>å¯ä»¥è¿™æ ·ç†è§£ï¼š</p>
<ul>
<li>
<p><code>stabilityDump</code> = "ä¿å­˜å½“å‰çŠ¶æ€"</p>
</li>
<li>
<p><code>stabilityCheck</code> = "è‡ªä¸Šæ¬¡ä¿å­˜ä»¥æ¥æ˜¯å¦æœ‰ä»»ä½•æ›´æ”¹ï¼Ÿ"</p>
</li>
</ul>
<h3 data-id="heading-20">æ­¥éª¤ 1ï¼šåˆ›å»ºåŸºçº¿</h3>
<p>ç¼–è¯‘é¡¹ç›®åï¼Œè¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">./gradlew :app:compileDebugKotlin  
./gradlew :app:stabilityDump
</code></pre>
<p>è¿™å°†ç”Ÿæˆ <code>app/stability/app.stability</code> æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>  
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> com.example.<span class="hljs-title">UserCard</span><span class="hljs-params">(user: <span class="hljs-type">com</span>.<span class="hljs-type">example</span>.<span class="hljs-type">User</span>)</span></span>: kotlin.<span class="hljs-built_in">Unit</span>  
  skippable: <span class="hljs-literal">true</span>  
  restartable: <span class="hljs-literal">true</span>  
  params:  
    - user: STABLE (immutable <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span>)  
  
<span class="hljs-meta">@Composable</span>  
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> com.example.<span class="hljs-title">ProductList</span><span class="hljs-params">(items: <span class="hljs-type">kotlin</span>.<span class="hljs-type">collections</span>.<span class="hljs-type">List</span>&lt;<span class="hljs-type">com</span>.<span class="hljs-type">example</span>.<span class="hljs-type">Product</span>\&gt;)</span></span>: kotlin.<span class="hljs-built_in">Unit</span>  
  skippable: <span class="hljs-literal">true</span>  
  restartable: <span class="hljs-literal">true</span>  
  params:  
    - items: STABLE (immutable collection with stable elements)
</code></pre>
<p>æ­¤æ–‡ä»¶æ˜“äºé˜…è¯»ï¼Œå¹¶å‡†ç¡®æ˜¾ç¤ºäº†ç¼–è¯‘å™¨å¯¹æ¯ä¸ªå¯ç»„åˆç»„ä»¶çš„åˆ¤æ–­ç»“æœã€‚å®ƒæ˜¯åº”ç”¨ç¨‹åºç¨³å®šæ€§çŠ¶æ€çš„å®Œæ•´å¿«ç…§ã€‚</p>
<p><strong>å°†æ­¤æ–‡ä»¶æäº¤åˆ° Gitï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">git add app/stability/app.stability  
git commit \-m <span class="hljs-string">"Add stability baseline"</span>  
git push
</code></pre>
<p>ç°åœ¨ï¼Œå›¢é˜Ÿä¸­çš„æ¯ä¸ªäººéƒ½æ‹¥æœ‰ç›¸åŒçš„åŸºçº¿ã€‚</p>
<h3 data-id="heading-21">æ­¥éª¤ 2ï¼šæ£€æŸ¥å›å½’é—®é¢˜</h3>
<p>åœ¨ä½ çš„ CI æµæ°´çº¿ä¸­è¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">./gradlew :app:compileDebugKotlin  
./gradlew :app:stabilityCheck
</code></pre>
<p>å¦‚æœæ²¡æœ‰ä»»ä½•å˜åŒ–ï¼Œä»»åŠ¡æˆåŠŸï¼š</p>
<pre><code class="hljs language-bash" lang="bash">âœ… Stability check passed.
</code></pre>
<p>å¦‚æœç¨³å®šæ€§å‡ºç°å›å½’ï¼Œä»»åŠ¡å¤±è´¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">âŒ Stability check failed!  
  
The following composables have changed stability:  
  
~ com.example.UserCard(user): parameter <span class="hljs-string">'user'</span> changed from STABLE to UNSTABLE  
  
If these changes are intentional, run <span class="hljs-string">'./gradlew stabilityDump'</span> to update the baseline.
</code></pre>
<p>æ„å»ºå¤±è´¥ï¼Œåœ¨é—®é¢˜ä¿®å¤æˆ–æ˜ç¡®æ¥å—å›å½’ä¹‹å‰ï¼Œæ‹‰å–è¯·æ±‚å°†æ— æ³•åˆå¹¶ã€‚</p>
<h3 data-id="heading-22">æ£€æµ‹åˆ°çš„å˜æ›´ç±»å‹</h3>
<p>éªŒè¯å™¨ä¼šæ£€æµ‹åˆ°å››ç§ç±»å‹çš„å˜æ›´ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/927b2ecbe032460daf36304b59dd3f92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iA5pyJ54y_6K-J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769786135&amp;x-signature=dwzlNSYC09up9QTlsC021q4pqNw%3D" alt="9" loading="lazy"/></p>
<p>è¿™ç§å…¨é¢çš„è·Ÿè¸ªæœºåˆ¶ç¡®ä¿<strong>ä»»ä½•</strong>ç¨³å®šæ€§å˜æ›´éƒ½æ¸…æ™°å¯è§ï¼Œå¹¶éœ€è¦è¿›è¡Œç›¸åº”çš„å†³ç­–ã€‚</p>
<h3 data-id="heading-23">CI/CD é›†æˆ</h3>
<p>å°†ç¨³å®šæ€§éªŒè¯æ·»åŠ åˆ°ä½ çš„ GitHub Actions å·¥ä½œæµï¼š</p>
<pre><code class="hljs language-bash" lang="bash">name: Android CI  
  
on: \[push, pull\_request\]  
<span class="hljs-built_in">jobs</span>:  
  build:  
    runs-on: ubuntu-latest  
    steps:  
      \- uses: actions/checkout@v3  
      \- name: Set up JDK 17  
        uses: actions/setup-java@v3  
        with:  
          java-version: <span class="hljs-string">'17'</span>  
          distribution: <span class="hljs-string">'temurin'</span>  
      \- name: Build project  
        run: ./gradlew :app:compileDebugKotlin  
  stability\_check:  
    name: Compose Stability Check  
    runs-on: ubuntu-latest  
    needs: build  
    steps:  
      \- name: Check out code  
        uses: actions/checkout@v5.0.0  
      \- name: Set up JDK  
        uses: actions/setup-java@v5.0.0  
        with:  
          distribution: <span class="hljs-string">'zulu'</span>  
          java-version: 21  
      \- name: Run stability check  
        run: ./gradlew stabilityCheck
</code></pre>
<p>ç°åœ¨ï¼Œæ¯ä¸ªæ‹‰å–è¯·æ±‚éƒ½ä¼šè‡ªåŠ¨è¿›è¡Œæ£€æŸ¥ã€‚å¦‚æœç¨³å®šæ€§ä¸‹é™ï¼Œåˆ™æ‹‰å–è¯·æ±‚å°†æ— æ³•åˆå¹¶ã€‚</p>
<h3 data-id="heading-24">é…ç½®é€‰é¡¹</h3>
<p>ä½ å¯ä»¥è‡ªå®šä¹‰è¦è·Ÿè¸ªçš„å†…å®¹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// In your build.gradle.kts</span>
composeStabilityAnalyzer {
    stabilityValidation {
        enabled.<span class="hljs-keyword">set</span>(<span class="hljs-literal">true</span>)
        outputDir.<span class="hljs-keyword">set</span>(layout.projectDirectory.dir(<span class="hljs-string">"stability"</span>))
        includeTests.<span class="hljs-keyword">set</span>(<span class="hljs-literal">false</span>) <span class="hljs-comment">// Exclude test code</span>

        <span class="hljs-comment">// Ignore specific packages</span>
        ignoredPackages.<span class="hljs-keyword">set</span>(listOf(<span class="hljs-string">"com.example.internal"</span>))
        <span class="hljs-comment">// Ignore specific classes (e.g., previews)</span>
        ignoredClasses.<span class="hljs-keyword">set</span>(listOf(<span class="hljs-string">"PreviewComposables"</span>))
        <span class="hljs-comment">// Ignore entire modules</span>
        ignoredProjects.<span class="hljs-keyword">set</span>(listOf(<span class="hljs-string">"benchmarks"</span>, <span class="hljs-string">"examples"</span>))
    }
}
</code></pre>
<p>è¿™å¯¹äºæ’é™¤ä¸éœ€è¦ç¨³å®šæ€§è·Ÿè¸ªçš„ä»£ç éå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚é¢„è§ˆç»„åˆæˆ–è°ƒè¯•å±å¹•ã€‚</p>
<h3 data-id="heading-25">æ’é™¤ç‰¹å®šç»„åˆ</h3>
<p>ä½¿ç”¨ <code>@IgnoreStabilityReport</code> ä»éªŒè¯ä¸­æ’é™¤å•ä¸ªç»„åˆï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@IgnoreStabilityReport</span>
<span class="hljs-meta">@Preview</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">UserCardPreview</span><span class="hljs-params">()</span></span> {
    UserCard(user = User(<span class="hljs-string">"John"</span>, <span class="hljs-number">30</span>))
}
</code></pre>
<p>é¢„è§ˆç»„åˆä¸ä¼šå‡ºç°åœ¨ç”Ÿäº§ç‰ˆæœ¬ä¸­ï¼Œå› æ­¤å®ƒä»¬çš„ç¨³å®šæ€§æ— å…³ç´§è¦ã€‚æ’é™¤å®ƒä»¬å¯ä»¥å‡å°‘ç¨³å®šæ€§æŠ¥å‘Šä¸­çš„å™ªéŸ³ã€‚</p>
<h3 data-id="heading-26">å¤šæ¨¡å—é¡¹ç›®</h3>
<p>å¯¹äºåŒ…å«å¤šä¸ªæ¨¡å—çš„é¡¹ç›®ï¼Œæ¯ä¸ªæ¨¡å—éƒ½ä¼šæœ‰è‡ªå·±çš„ <code>.stability</code> æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">project/  
â”œâ”€â”€ app/stability/app.stability  
â”œâ”€â”€ feature-auth/stability/feature-auth.stability  
â””â”€â”€ feature-profile/stability/feature-profile.stability
</code></pre>
<p>åœ¨æ ¹ç›®å½•è¿è¡Œ <code>stabilityCheck</code> æ¥æ£€æŸ¥æ‰€æœ‰æ¨¡å—ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">./gradlew stabilityCheck
</code></pre>
<p>æˆ–è€…æ£€æŸ¥å•ä¸ªæ¨¡å—ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">./gradlew :feature-auth:stabilityCheck
</code></pre>
<h3 data-id="heading-27">æ¥å—æœ‰æ„ä¸ºä¹‹çš„å›å½’</h3>
<p>æœ‰æ—¶ç¨³å®šæ€§å›å½’æ˜¯æœ‰æ„ä¸ºä¹‹çš„ï¼Œä¾‹å¦‚ä½ æ­£åœ¨é‡æ„ä»£ç å¹¶æš‚æ—¶æ¥å—è¾ƒä½çš„ç¨³å®šæ€§ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯·æ›´æ–°åŸºçº¿ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">./gradlew :app:stabilityDump  
git add app/stability/app.stability  
git commit -m <span class="hljs-string">"Accept stability regression for UserCard (refactoring in progress)"</span>  
git push
</code></pre>
<p>è¿™ä¼šåœ¨ Git å†å²è®°å½•ä¸­åˆ›å»ºä¸€ä¸ª<strong>å·²è®°å½•çš„å†³ç­–</strong>ã€‚å›å½’ä¸å†æ˜¯é»˜é»˜è¿›è¡Œçš„ï¼Œè€Œæ˜¯æ˜ç¡®ä¸”å¯è·Ÿè¸ªçš„ã€‚</p>
<h2 data-id="heading-28">æ€§èƒ½è€ƒé‡å’Œæœ€ä½³å®è·µ</h2>
<p>è™½ç„¶è¿™äº›å·¥å…·åŠŸèƒ½å¼ºå¤§ï¼Œä½†ä»æœ‰ä¸€äº›æ€§èƒ½ç‰¹æ€§å’Œæœ€ä½³å®è·µéœ€è¦æ³¨æ„ã€‚æœ‰äººé—®æˆ‘æ˜¯å¦éœ€è¦è®©_æ¯ä¸ª_ç±»å‹éƒ½ç¨³å®šï¼Œç­”æ¡ˆç»å¯¹æ˜¯â€œä¸éœ€è¦â€ã€‚</p>
<p>ç”±äºç°åœ¨æœ‰äº†å¼ºè·³è¿‡æ¨¡å¼ï¼Œæ¯ä¸ªå¯ç»„åˆå‡½æ•°éƒ½å¯ä»¥è·³è¿‡ï¼Œè¿™æœ¬èº«å°±èƒ½ä¼˜åŒ–ç¨³å®šæ€§ã€‚å³ä½¿è¿™ä¸ªæ’ä»¶å¯èƒ½ä¼šæç¤ºâ€œä¸ç¨³å®šâ€æˆ–â€œè¿è¡Œæ—¶ç¨³å®šæ€§â€ï¼Œä½†ä½ å®é™…ä¸Šå¹¶ä¸éœ€è¦ä¸ºæ¯ä¸ªå¯ç»„åˆå‡½æ•°éƒ½è¿›è¡Œä¿®å¤ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d267a7319ba34057ad748a0d7660ec3d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iA5pyJ54y_6K-J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769786135&amp;x-signature=%2F1rYFoBMEDbbrUwxps3W5wmgN1I%3D" alt="10" loading="lazy"/></p>
<p>å¦‚æœä½ æŸ¥çœ‹ compose-material3 åº“ä¸­çš„ <code>Icon</code> å¯ç»„åˆå‡½æ•°ï¼Œè¿™ä¸ªæ’ä»¶ä¼šæç¤ºå®ƒä¸ç¨³å®šï¼Œå› ä¸ºå®ƒåŒ…å«è¿è¡Œæ—¶å‚æ•°ã€‚ä½†æ˜¯ï¼Œ<code>painter</code> å‚æ•°é€šå¸¸æ˜¯é€šè¿‡ <code>painterResource</code> å‡½æ•°åˆå§‹åŒ–çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> painter = painterResource(R.drawable.)
Icon(painter = painter, contentDescription = <span class="hljs-literal">null</span>)
</code></pre>
<p>å¦‚æœä½ æŸ¥çœ‹ <code>painterResource</code> çš„å†…éƒ¨é€»è¾‘ï¼Œä½ ä¼šå‘ç°å®ƒæœ¬è´¨ä¸Šæ˜¯ç¨³å®šçš„ã€‚å®ƒå†…éƒ¨ä½¿ç”¨ <code>remember</code> å°†å€¼ç¼“å­˜åˆ°å†…å­˜ä¸­ï¼Œæ‰€ä»¥ä½ å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯ä¸€ä¸ªå°å°çš„æƒè¡¡ï¼š<em>â€œæˆ‘ä¼šç”¨ä¸€ç‚¹å†…å­˜æ¥å­˜å‚¨è¿™ä¸ªä¸ç¨³å®šçš„å®ä¾‹ï¼Œè¿™æ ·æˆ‘å°±ä¸å¿…è§¦å‘ä¸å¿…è¦çš„é‡æ–°ç»„åˆã€‚â€</em></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90164e1a3f6a4e038143ee9b9ee54212~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iA5pyJ54y_6K-J:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769786135&amp;x-signature=l1JhfePesyf3BR%2BJL8QITjY6yts%3D" alt="11" loading="lazy"/></p>
<p>å…³äºä¸å¯å˜é›†åˆè¿˜æœ‰ä¸€ä¸ªå¸¸è§çš„è¯¯è§£â€”â€”è®¤ä¸ºä»…ä»…ä½¿ç”¨ <code>ImmutableList</code> è€Œä¸æ˜¯æ™®é€šçš„ <code>List</code> å°±èƒ½æå‡æ€§èƒ½ã€‚ <strong>å¹¶éæ€»æ˜¯å¦‚æ­¤ã€‚</strong></p>
<p>ä¸å¦¨è¿™æ ·æƒ³ï¼šå¦‚æœä½ æœ‰ä¸€ä¸ªåŒ…å« 1000 ä¸ªå¤§å‹å¯¹è±¡çš„åˆ—è¡¨ï¼Œç„¶åä½ å°†å…¶è½¬æ¢ä¸ºä¸å¯å˜åˆ—è¡¨ï¼Œé‚£ä¹ˆä½ çš„å¯ç»„åˆç»„ä»¶å°±å˜å¾—å¯ä»¥å¿½ç•¥äº†ã€‚ä½†æ˜¯ï¼Œæ¯æ¬¡é‡æ–°ç»„åˆæ—¶ï¼ŒCompose éƒ½ä¼šå¯¹åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ è¿è¡Œ <code>equals()</code> å‡½æ•°ï¼Œä»¥æ£€æŸ¥æ–°å®ä¾‹æ˜¯å¦ä¸ä¹‹å‰çš„å®ä¾‹åŒ¹é…ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™å®é™…ä¸Šä¼šæ¯”é‡æ–°æ¸²æŸ“ä¸€ä¸ªåªæ˜¾ç¤ºå…¶ä¸­äº”ä¸ªå…ƒç´ çš„è½»é‡çº§ UI æ›´<strong>å½±å“æ€§èƒ½</strong>ã€‚</p>
<p>å› æ­¤ï¼Œ<strong>ç¨³å®šæ€§ä¼šæ ¹æ®å…·ä½“æƒ…å†µäº§ç”Ÿæˆªç„¶ä¸åŒçš„å½±å“</strong>ï¼Œè¯•å›¾è®©æ•´ä¸ª UI ä¿æŒç¨³å®šé€šå¸¸æ˜¯ä¸å¿…è¦çš„ï¼Œä¹Ÿæ˜¯å¾’åŠ³çš„ã€‚æˆ‘å¸Œæœ›è¿™ä¸ªæ’ä»¶ä¸ä¼šåŠ é‡ä½ å¯¹ç¨³å®šæ€§çš„æ‹…å¿§ï¼Œè€Œæ˜¯èƒ½å¤Ÿå¸®åŠ©ä½ æ›´æœ‰æ•ˆåœ°è°ƒè¯•å®é™…çš„æ€§èƒ½é—®é¢˜ï¼Œå¹¶åšå‡ºæ›´æ˜æ™ºã€æ›´æ•°æ®é©±åŠ¨çš„å†³ç­–ï¼Œè€Œæ— éœ€è¿‡åº¦è€ƒè™‘ç¨³å®šæ€§ã€‚</p>
<h2 data-id="heading-29">ç»“è®º</h2>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æ¢ç´¢äº† Compose ç¨³å®šæ€§åˆ†æå™¨ (Compose Stability Analyzer) (<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fskydoves%2Fcompose-stability-analyzer)%25EF%25BC%258C%25E4%25BA%2586%25E8%25A7%25A3%25E4%25BA%2586%25E5%25AE%2583%25E5%25A6%2582%25E4%25BD%2595%25E9%2580%259A%25E8%25BF%2587%25E4%25B8%2589%25E4%25B8%25AA%25E4%25BA%2592%25E8%25A1%25A5%25E7%259A%2584%25E5%25B7%25A5%25E5%2585%25B7%25E5%25B0%2586" target="_blank" title="https://github.com/skydoves/compose-stability-analyzer)%EF%BC%8C%E4%BA%86%E8%A7%A3%E4%BA%86%E5%AE%83%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87%E4%B8%89%E4%B8%AA%E4%BA%92%E8%A1%A5%E7%9A%84%E5%B7%A5%E5%85%B7%E5%B0%86" ref="nofollow noopener noreferrer">github.com/skydoves/coâ€¦</a> Compose éšè—çš„ç¨³å®šæ€§åˆ†æå¯è§†åŒ–ï¼šIntelliJ æ’ä»¶ç”¨äºåœ¨å¼€å‘è¿‡ç¨‹ä¸­æä¾›å¯è§†åŒ–åé¦ˆï¼ŒGradle æ’ä»¶ç”¨äºè¿è¡Œæ—¶é‡ç»„è¿½è¸ªï¼Œä»¥åŠç¨³å®šæ€§éªŒè¯ç³»ç»Ÿç”¨äºé˜²æ­¢æŒç»­é›†æˆ (CI) ä¸­çš„å›å½’ã€‚</p>
<p>IntelliJ æ’ä»¶å°†ç¨³å®šæ€§ä»ä¸€ä¸ªä¸å¯è§çš„ç¼–è¯‘æ—¶æ¦‚å¿µè½¬åŒ–ä¸ºå¯æ„ŸçŸ¥çš„äº‹ç‰©ï¼Œé€šè¿‡è¾¹æ å›¾æ ‡ã€å·¥å…·æç¤ºå’Œå†…è”æç¤ºï¼Œä½¿ç¨³å®šæ€§é—®é¢˜ä¸€ç›®äº†ç„¶ã€‚<code>@TraceRecomposition</code> æ³¨è§£å¼¥åˆäº†ç¼–è¯‘æ—¶åˆ†æå’Œè¿è¡Œæ—¶è¡Œä¸ºä¹‹é—´çš„é¸¿æ²Ÿï¼Œè®©ä½ å¯ä»¥å‡†ç¡®åœ°äº†è§£å¯ç»„åˆç»„ä»¶ä½•æ—¶ä»¥åŠä¸ºä½•é‡æ–°ç»„åˆã€‚ç¨³å®šæ€§éªŒè¯ç³»ç»Ÿåˆ™èµ·åˆ°å®‰å…¨ç½‘çš„ä½œç”¨ï¼Œç¡®ä¿ä½ ç²¾å¿ƒè®¾è®¡çš„ä¼˜åŒ–ä¸ä¼šéšç€ä»£ç åº“çš„æ¼”è¿›è€Œæ‚„ç„¶å¤±æ•ˆã€‚</p>
<p>è¿™äº›å·¥å…·å…±åŒä½œç”¨ï¼Œä½¿ç¨³å®šæ€§åˆ†ææˆä¸ºä½ å¼€å‘å·¥ä½œæµç¨‹ä¸­è‡ªç„¶è€Œç„¶çš„ä¸€éƒ¨åˆ†ã€‚ä½ æ— éœ€ç­‰å¾…æ€§èƒ½é—®é¢˜æ˜¾ç°ï¼Œå³å¯åœ¨ç¼–ç è¿‡ç¨‹ä¸­ç«‹å³å‘ç°å®ƒä»¬ã€‚ä½ æ— éœ€çŒœæµ‹å“ªä¸ªå‚æ•°å¯¼è‡´äº†é‡æ–°ç»„åˆâ€”â€”æ—¥å¿—ä¼šå‡†ç¡®åœ°å‘Šè¯‰ä½ å“ªäº›å‚æ•°å‘ç”Ÿäº†å˜åŒ–ã€‚ä½ ä¹Ÿæ— éœ€æ‰‹åŠ¨å®¡æŸ¥æ¯ä¸ª PR æ˜¯å¦å­˜åœ¨ç¨³å®šæ€§å›å½’ï¼ŒCI æµæ°´çº¿ä¼šè‡ªåŠ¨å®Œæˆè¿™é¡¹å·¥ä½œã€‚</p>
<p>ç†è§£ç¨³å®šæ€§æ˜¯ç¼–å†™é«˜æ€§èƒ½ Compose åº”ç”¨ç¨‹åºçš„åŸºç¡€ã€‚å€ŸåŠ© Compose ç¨³å®šæ€§åˆ†æå™¨ï¼Œè¿™ç§ç†è§£å˜å¾—è½»æ¾ã€ç›´è§‚ã€å³æ—¶ä¸”æœ‰æ•ˆã€‚</p>
<p>ç¥ä½ ç¼–ç æ„‰å¿«ï¼</p>
<blockquote>
<p>æ¬¢è¿æœç´¢å¹¶å…³æ³¨ <em>å…¬ä¼—å·<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fmp%2Fqrcode%3Fscene%3D10000004%26size%3D512%26__biz%3DMzU1MDg0NDczNA%3D%3D%26mid%3D2247484417%26idx%3D1%26sn%3D60c15f0d3c4be75e37748c2472a74102" target="_blank" title="https://mp.weixin.qq.com/mp/qrcode?scene=10000004&amp;size=512&amp;__biz=MzU1MDg0NDczNA==&amp;mid=2247484417&amp;idx=1&amp;sn=60c15f0d3c4be75e37748c2472a74102" ref="nofollow noopener noreferrer">ã€Œç¨€æœ‰çŒ¿è¯‰ã€</a></em> è·å–æ›´å¤šçš„ä¼˜è´¨æ–‡ç« ï¼</p>
<p>ä¿æŠ¤åŸåˆ›ï¼Œè¯·å‹¿è½¬è½½ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é˜¿é‡Œäº‘+Qoderä¸€é”®ç”Ÿæˆä¸ªäººä¸»é¡µï¼Œé¢è¯•ç‡ç¿»å€åç­‰offer]]></title>    <link>https://juejin.cn/post/7598374376094400539</link>    <guid>https://juejin.cn/post/7598374376094400539</guid>    <pubDate>2026-01-23T15:32:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598374376094400539" data-draft-id="7598390244380409894" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é˜¿é‡Œäº‘+Qoderä¸€é”®ç”Ÿæˆä¸ªäººä¸»é¡µï¼Œé¢è¯•ç‡ç¿»å€åç­‰offer"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-23T15:32:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ˜ŸAIå·¥ä½œå®¤"/> <meta itemprop="url" content="https://juejin.cn/user/2250051536050763"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é˜¿é‡Œäº‘+Qoderä¸€é”®ç”Ÿæˆä¸ªäººä¸»é¡µï¼Œé¢è¯•ç‡ç¿»å€åç­‰offer
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2250051536050763/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ˜ŸAIå·¥ä½œå®¤
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T15:32:03.000Z" title="Fri Jan 23 2026 15:32:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cd0bfcfc70da48419e484fd93091e08e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=T4SD%2F8Z3O0df53KiYXi6ublx3gk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å“ˆå–½å¤§å®¶å¥½</p>
<p>æˆ‘æ˜¯é˜¿æ˜Ÿ</p>
<p>è½¬çœ¼æ˜¥èŠ‚è¿‡åï¼Œæ˜¥æ‹›å­£åˆå°†åˆ°æ¥ã€‚æ— è®ºæ˜¯åº”å±Šæ¯•ä¸šç”Ÿè¿˜æ˜¯èŒåœºäººï¼Œéƒ½å¯ä»¥ç€æ‰‹æ‰“é€ ä¸ªäººä¸»é¡µå•¦ï¼</p>
<p>å¦‚æœä½ æ˜¯é¢è¯•å®˜/ç”²æ–¹ï¼Œä½ ä¼šé€‰è¢«ä¸‹é¢å“ªä¸ªç®€å†ç¬¬ä¸€æ—¶é—´å¸å¼•å‘¢ï¼Ÿ</p>
<p>Â </p>
<p>æ™®é€šç®€å†ğŸ‘‡</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30aeed7a0a5545fb882499f41b6f451a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=beEqH7XMyXl7NrUcM4lW6oPVWxg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>AIä¸ªäººä¸»é¡µé•¿è¿™æ ·ğŸ‘‡</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9e0f4e1e7e3f4ad5a9a8cebf714b9a84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=sKPcJv6OMapl68Z07YNleO7Yo1s%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é˜¿æ˜Ÿä»Šå¤©å°±è·Ÿå¤§å®¶ä»‹ç»ç”¨AIåˆ¶ä½œä¸ªäººä¸»é¡µçš„æ–¹æ³•ï¼Œå¾ˆç®€å•è·Ÿç€æˆ‘åšå³å¯ï¼</p>
<p>ã€Œé˜¿é‡Œäº‘ECS+Qoderåœ¨çº¿éƒ¨ç½²ã€ï¼Œç›´æ¥éƒ¨ç½²åˆ°å…¬ç½‘ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/abaae559061b4243b4fdbc5f5d357f1a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=QK0oFEhoY8CGvvzMFb54f0L4W6w%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7a021df48afc41c98d060a80dbbf64db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=H5NRE6z9bJw6eorKxCPnkWIHjXw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/16774363c77345d488217dd1f0ff3866~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=%2B5BXrZFlszxOOoYr4q5TTqNqvNI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-0">ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©é˜¿é‡Œäº‘æœåŠ¡å™¨</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bffb9da5d68a489f874e7f17145d7836~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=pRhKnG3AsWUTJ9X4%2BMHjzMm2%2FiI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é€‰æ‹©å³è¾¹çš„å»ºç«™é¦–é€‰ğŸ‘†</p>
<p>çœ‹åˆ°ç»¿è‰²çš„å·²éƒ¨ç½²åå°±å¯ä»¥è¿›å…¥æœåŠ¡å™¨æ§åˆ¶å°äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e34493db34d6429d866b98569b5aa770~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=vEPr66RIbRPCEuRSMxmhl5De4pE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç‚¹å‡»å³è¾¹çš„è¿œç¨‹è¿æ¥ï¼Œç„¶åç‚¹ç«‹å³ç™»å½•ã€‚ç»§ç»­â€”â€”</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d6593780010472da6cd1ffd26ed512a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=8mdtZu6x9tA%2BvSmZZKj6IvFjXWU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å°±å¯ä»¥sshè®¿é—®äº†ï¼Œç›¸å½“äºä½ åœ¨ç½‘é¡µç«¯æ‰“å¼€äº†è‡ªå·±çš„æœåŠ¡å™¨ã€‚</p>
<p>å®ƒä¸ä¼šä¿å­˜ä½ è¿˜æ²¡è¾“å…¥å®Œçš„ä»£ç ã€‚ä½ è¿™ä¸ªç½‘é¡µå…³æ‰äº†å‰ç«¯ä¹Ÿä¼šå…³æ‰ã€‚</p>
<p><strong>ä¸‹æ–‡ä¼šè®²æ€ä¹ˆé¿å…è¿™ç§æƒ…å†µã€‚</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/270c3c232eae4da8a9754437029f441e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=1Zv02nHrgmL9em6VCwZvHDPe3lU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½ çš„ç•Œé¢ä¼šå¦‚ä¸‹æ˜¾ç¤ºï¼Œä½ åªç”¨è¾“å…¥#åé¢çš„ä»£ç ï¼Œä¸è¦æŠŠ#åŠ è¿›å»ã€‚</p>
<p><strong>æ¯æ¬¡åªç”¨è¾“å…¥ä¸€è¡Œï¼Œä¸è¦ä¸€æ¬¡æ€§å…¨éƒ½å¤åˆ¶è¿›å»ã€‚</strong></p>
<p>æ³¨æ„ï¼Œè¾“å…¥ä»£ç çš„æ—¶å€™ä¸è¦è½»æ˜“åˆ·æ–°è¿™ä¸ªé¡µé¢ï¼Œä»–ä¸ä¼šä¿å­˜ä½ æ­£åœ¨è¾“å…¥çš„ä»£ç ã€‚</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">sudo su</span>
<span class="hljs-meta prompt_"># </span><span class="bash"><span class="hljs-built_in">cd</span> /root</span>
<span class="hljs-meta prompt_"># </span><span class="bash">qodercli --yolo --model=auto</span>
</code></pre>
<h2 data-id="heading-1">å¯åŠ¨qoder</h2>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åœ¨ç½‘é¡µç«¯ç™»å½•æµè§ˆå™¨ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ç™»å½•</span>
qodercli /login

<span class="hljs-comment"># 2. è¿›å…¥ä½ è¦æ”¹çš„é¡¹ç›®ï¼ˆæŠŠ portfolio æ¢æˆä½ æŸ¥åˆ°çš„é¡¹ç›®åï¼‰</span>
<span class="hljs-built_in">cd</span> /root/portfolio

<span class="hljs-comment"># 3. å¯åŠ¨</span>
å‘Šè¯‰qoderå¯åŠ¨é¡¹ç›®
</code></pre>
<p>æ³¨æ„è¿™é‡Œå¯èƒ½ä¼šæœ‰æŠ¥é”™ï¼Œæ¯”å¦‚æ²¡ç§¯åˆ†äº†ã€å…¶ä»–é”™è¯¯ã€‚</p>
<p>é˜¿æ˜Ÿçš„æ–¹æ³•æ˜¯ä¸€æ¦‚é‡ç™»ã€‚</p>
<p>ç›´æ¥é—®AIè®©å®ƒç»™ä½ æ”¹æˆç™»å‡ºçš„æŒ‡ä»¤å°±è¡Œäº†ã€‚</p>
<p>åŸºæœ¬å°±okäº†ã€‚è¿™é‡Œé»˜è®¤ä½ æ˜¯qoderçš„æ–°ç”¨æˆ·ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b79d0caece8a48b1b1adaddb368b938d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=wszVaa4i5IGT%2FLBQSkT5m4w5fcg%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç„¶åå°±ä¼šè¹¦å‡ºæ¥ä¸€ä¸ªå…¥å£ï¼Œ</p>
<p>æˆ‘ä»¬ç›´æ¥åŒå‡»å°±ä¼šå‡ºç°ä¸€ä¸ªloginé¡µé¢ï¼Œ</p>
<p>æ— è„‘ç¡®è®¤åå›æ¥å°±ä¼šæç¤ºä½ å·²ç»æˆåŠŸç™»å½•äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5929630134714277a1aec19d509ce3fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=7Pocti4VlhPKhYX04gYVouo0qN0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-2">åˆ¶ä½œç½‘é¡µ</h2>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠæç¤ºè¯ç›´æ¥åœ¨ä¸Šé¢çª—å£é‡Œå‘ç»™AIã€‚</p>
<pre><code class="hljs language-less" lang="less">æˆ‘æ˜¯ä¸€åå³å°†æ¯•ä¸šçš„è®¡ç®—æœºç§‘å­¦ä¸“ä¸šåº”å±Šç”Ÿï¼Œæ­£åœ¨å¯»æ±‚è½¯ä»¶å¼€å‘å·¥ç¨‹å¸ˆ(åç«¯/å…¨æ ˆæ–¹å‘)çš„èŒä½ã€‚è¯·ä¸ºæˆ‘åˆ›å»ºä¸€ä¸ªä¸“ä¸šã€æŠ€æœ¯æ„Ÿå¼ºçš„ä¸ªäººä¸»é¡µï¼Œä½œä¸ºæˆ‘çš„'äº‘ç«¯åç‰‡â€™ã€‚

é‡è¦ç¯å¢ƒè¯´æ˜ï¼šå½“å‰è¿è¡Œç¯å¢ƒä¸ºé˜¿é‡Œäº‘<span class="hljs-selector-tag">ECS</span>æœåŠ¡å™¨ï¼Œç”Ÿæˆ<span class="hljs-selector-tag">HTML</span>æ–‡ä»¶åéœ€è¦å¯åŠ¨<span class="hljs-selector-tag">Web</span>æœåŠ¡å¯¹å¤–æä¾›è®¿é—®ã€‚è¯·åŠ¡å¿…è¾“å‡ºåŒ…å«<span class="hljs-selector-tag">ECS</span>å…¬ç½‘<span class="hljs-selector-tag">IP</span>åœ°å€å’Œç«¯å£å·çš„å®Œæ•´è¿œç¨‹è®¿é—®åœ°å€ï¼ˆæ ¼å¼å¦‚ï¼š<span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//å…¬ç½‘IP:ç«¯å£ï¼‰ï¼Œè€Œä¸æ˜¯localhoståœ°å€ã€‚æˆ‘çš„å…¬ç½‘IPåœ°å€æ˜¯xxxã€‚ï¼ˆæ›¿æ¢æˆä½ è‡ªå·±æœåŠ¡å™¨çš„å…¬ç½‘åœ°å€å³å¯ï¼‰</span>

æ ¸å¿ƒæ¨¡å—åŒ…æ‹¬ï¼š
é†’ç›®å¯¼èˆªæ ï¼šé“¾æ¥åˆ°â€œå…³äºæˆ‘â€ã€â€œé¡¹ç›®ç»å†â€ã€â€œæŠ€æœ¯æ ˆâ€ã€â€œè”ç³»æ–¹å¼â€ã€‚
é¡¹ç›®å±•ç¤ºåŒºï¼šä»¥å¡ç‰‡å¼æˆ–åˆ—è¡¨å½¢å¼æ¸…æ™°å±•ç¤ºæˆ‘çš„<span class="hljs-number">3</span><span class="hljs-selector-tag">-5</span>ä¸ªæ ¸å¿ƒé¡¹ç›®ï¼ˆå­¦æ ¡é¡¹ç›®ã€å®ä¹ é¡¹ç›®ã€ä¸ªäººé¡¹ç›®ï¼‰ã€‚æ¯ä¸ªé¡¹ç›®éœ€è¦åŒ…å«ï¼šé¡¹ç›®åç§°ã€ç®€çŸ­æè¿°ã€ä½¿ç”¨çš„å…³é”®æŠ€æœ¯æ ˆã€é¡¹ç›®é“¾æ¥ï¼ˆ<span class="hljs-selector-tag">GitHub</span>/<span class="hljs-selector-tag">Demo</span>ï¼‰ã€é¡¹ç›®éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆï¼ˆå¯é€‰ï¼‰ã€‚

æŠ€èƒ½æ ‘/æŠ€æœ¯æ ˆæ¨¡å—ï¼š
ç›´è§‚åœ°åˆ—å‡ºæˆ‘ç†Ÿç»ƒæŒæ¡çš„ç¼–ç¨‹è¯­è¨€ã€æ¡†æ¶ã€æ•°æ®åº“ã€å·¥å…·ç­‰ï¼Œå¯ä»¥ç”¨è¿›åº¦æ¡æˆ–æ ‡ç­¾äº‘å±•ç¤ºç†Ÿç»ƒåº¦ã€‚

â€œå…³äºæˆ‘â€ç®€ä»‹ï¼š
ç®€çŸ­çš„ä¸ªäººé™ˆè¿°ï¼Œçªå‡ºæŠ€æœ¯çƒ­æƒ…ã€å­¦ä¹ èƒ½åŠ›å’Œè§£å†³é—®é¢˜èƒ½åŠ›ã€‚æ—è¾¹éœ€è¦æ”¾ç½®ä¸€å¼ ä¸“ä¸šå½¢è±¡ç…§ã€‚

**è”ç³»æ–¹å¼åŒºåŸŸï¼š
**æ˜¾è‘—ä½ç½®æ”¾ç½®é‚®ç®±ã€é¢†è‹±é“¾æ¥ã€<span class="hljs-selector-tag">GitHub</span>é“¾æ¥ã€‚æœ€å¥½èƒ½æœ‰ä¸€ä¸ªç®€å•çš„è”ç³»è¡¨å•ã€‚

è®¾è®¡é£æ ¼ï¼š
ç°ä»£ã€ç®€æ´ã€ä»£ç æ„Ÿï¼ˆå¯ä»¥ä½¿ç”¨æ·±è‰²æ¨¡å¼æˆ–ç§‘æŠ€è“ç­‰è‰²è°ƒï¼‰ï¼Œå¸ƒå±€æ¸…æ™°æ˜“è¯»ï¼Œé‡ç‚¹çªå‡ºé¡¹ç›®å’ŒæŠ€æœ¯èƒ½åŠ›ã€‚

é¢å¤–éœ€æ±‚ï¼š
æ”¯æŒ<span class="hljs-selector-tag">Markdown</span>æ ¼å¼ç¼–å†™é¡¹ç›®æè¿°ï¼›èƒ½åµŒå…¥<span class="hljs-selector-tag">GitHub</span>è´¡çŒ®å›¾ï¼›ç¡®ä¿ç§»åŠ¨ç«¯æµè§ˆä½“éªŒè‰¯å¥½ã€‚<span class="hljs-selector-tag">SEO</span>åŸºç¡€ä¼˜åŒ–ã€‚
</code></pre>
<p>å…¶ä¸­ï¼Œä¸ªäººä¿¡æ¯éƒ¨åˆ†ğŸ‘†ä¹Ÿå¯ä»¥é€šè¿‡è®©AIå¸®ä½ æ•´ç†æˆmarkdownæ ¼å¼ã€‚</p>
<p>è¿™æ ·ä½ å‘ˆç°è‡ªå·±ä¿¡æ¯çš„æ—¶å€™ä¹Ÿå¯ä»¥æ›´ç²¾å‡†ã€‚</p>
<p>ä¸»è¦è¿˜æ˜¯å› ä¸ºmarkdownè¿™ç§è¯­æ³•ï¼Œè®©æˆ‘ä»¬å¯¹äºå±‚çº§çš„æŠŠæ¡æ›´åŠ æ¸…æ¥šï¼Œç°åœ¨ä¹Ÿæœ‰ä¸€äº›è¯´æ³•è¯´å’Œè·ŸAIå¯¹è¯çš„æ—¶å€™ä¸ç”¨é•¿ç¯‡å¤§è®ºï¼Œä½†æ˜¯åƒç®€å†è¿™ç§æŒ‡å®šå†…å®¹æœ€å¥½è¿˜æ˜¯æå‰æ•´ç†ã€‚</p>
<p><strong>æŠŠä¸‹é¢æ•´ç†å¥½çš„ä¸ªäººä¿¡æ¯æŒ‚åœ¨ä¸Šé¢çš„æç¤ºè¯æœ«å°¾å³å¯ã€‚</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b9d11012295a4fc0a9796d149ee50942~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=RahtUj1arfvF4MJngMVYSt4ifFw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-3">å¦‚ä½•ä¼˜åŒ–é¡µé¢é¢œå€¼</h2>
<p>ç¬¬ä¸€ç‰ˆå®ƒå°±ä¼šå‡ºæ¥è¿™æ ·ä¸€ä¸ªé¡µé¢</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f14f90b7e5f648b0bca7b9cb07ccc84a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=zHHAgqkylR%2B3EYnknfihxV%2BpDzQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é‚£ä¹ˆï¼Œå¦‚ä½•ä¼˜åŒ–é¡µé¢é¢œå€¼ï¼Ÿ</p>
<p>é˜¿æ˜Ÿå¸¸ç”¨çš„é¢œå€¼æå‡ç½‘ç«™æ˜¯21devï¼Œé‡Œé¢çš„æœ‰å¥½å¤šé¢„åˆ¶èœã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7997fb395b2548a98bd4fbe35da19368~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=8grjdXjcIcEAynPGAFfgqJ0qvMk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>é‡ç‚¹æ˜¯æ¯ä¸ªæ¨¡ç‰ˆç‚¹å¼€åä½ åº”è¯¥çœ‹çš„ä¸æ˜¯æç¤ºè¯è€Œæ˜¯view codeï¼Œç‚¹å¼€ä¹‹åæŠŠä»£ç å¤åˆ¶ä¸‹æ¥ã€‚å°±èƒ½è¡”æ¥ä¸‹ä¸‹é¢çš„æç¤ºè¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b1cb441b88574a86bdca7ea75e85e935~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=AKNziGG3v8ctsStI6bxVix3Tjo0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c36f360f19a546298b2fc15882342bca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=0odjwZqLNo3tInNcp2g2Sng%2Fq7E%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ¨ä½ çš„ç®€å†æç¤ºè¯ä¸‹é¢åŠ ä¸Šè¿™å‡ å¥è¯ï¼Œè¿™å‡ å¥è¯å…¶å®å¾ˆæœ‰å¿…è¦èƒŒä¼šã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown">è§†è§‰ä¸Šï¼Œå‚è€ƒ<span class="hljs-code">`demo.tsx`</span>å’Œ<span class="hljs-code">`xxx.tsx`</span>çš„ä»£ç ï¼Œç¡®ä¿ï¼šÂ 
<span class="hljs-bullet">1.</span>Â åˆ†æç»„ä»¶ç»“æ„å¹¶è¯†åˆ«æ‰€æœ‰å¿…éœ€çš„ä¾èµ–ã€‚Â Â 
<span class="hljs-bullet">2.</span>Â æŸ¥çœ‹ç»„ä»¶çš„å‚æ•°å’ŒçŠ¶æ€ã€‚Â Â 
<span class="hljs-bullet">3.</span>Â è¯†åˆ«ä»»ä½•å¿…éœ€çš„ä¸Šä¸‹æ–‡æä¾›è€…æˆ–æŒ‚é’©ï¼Œå¹¶å®‰è£…å®ƒä»¬ã€‚Â 
<span class="hljs-bullet">4.</span>Â å¦‚æœç»„ä»¶éœ€è¦ï¼Œä½¿ç”¨ lucide-react å›¾æ ‡ä½œä¸º SVG æˆ–å¾½æ ‡ã€‚Â 
<span class="hljs-bullet">5.</span>Â å…¶ä»–åŒºå—çš„è§†è§‰ä¸ Hero éƒ¨åˆ†é€‚é…ã€‚
</code></pre>
<p>ä¼˜åŒ–åçš„æ•ˆæœå¤§æ¦‚é•¿è¿™æ ·ğŸ‘‡ğŸ»</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9fd25ad868ea4e9584964e9656d0d524~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=WHX9cujLDexh3LuoACRz1a%2BzmBY%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-4">é¡µé¢ä¸æ˜¾ç¤ºæ€ä¹ˆåŠ</h2>
<p>é˜¿é‡Œäº‘ ECS é»˜è®¤ä¼šå¼€æ”¾ 22 (SSH) å’Œ 80 (HTTP) ç«¯å£ã€‚ä½ å¯åŠ¨çš„Â <strong>8080</strong>Â ç«¯å£è¢«é˜¿é‡Œäº‘çš„â€œå®‰å…¨ç»„â€æŒ¡ä½äº†ã€‚</p>
<p><strong>è§£å†³åŠæ³•</strong>Â ï¼š</p>
<ol>
<li>
<ol>
<li>ç™»å½•Â <strong>é˜¿é‡Œäº‘æ§åˆ¶å°</strong>Â ã€‚</li>
</ol>
</li>
<li>
<ol start="2">
<li>æ‰¾åˆ°ä½ çš„Â <strong>ECS å®ä¾‹</strong>Â -&gt;Â <strong>å®‰å…¨ç»„</strong>Â -&gt;Â <strong>é…ç½®è§„åˆ™</strong>Â ã€‚</li>
</ol>
</li>
<li>
<ol start="3">
<li>æ·»åŠ ä¸€æ¡â€œå…¥æ–¹å‘â€è§„åˆ™ï¼šÂ <strong>åè®® TCPï¼Œç«¯å£ 8080ï¼Œæˆæƒå¯¹è±¡ 0.0.0.0/0</strong>Â ã€‚</li>
</ol>
</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14e47c8e2a754c86a372958cea1460af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=hirKLSlYCfrqep4iokk%2BDzDcNiI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/679d367107994522b4022fbde9881894~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=pWk92%2BN6dJ4pV9bDe54eUpB7e74%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<ol>
<li>
<ol start="4">
<li>å¦‚æœè¿˜ä¸è¡Œå°±ï¼š</li>
</ol>
</li>
</ol>

<pre><code class="hljs language-arduino" lang="arduino"># åœæ­¢é˜²ç«å¢™æœåŠ¡ï¼ˆCentOS å¸¸ç”¨ï¼‰
systemctl stop firewalld
</code></pre>
<ol>
<li>5.  å¦‚æœè¿˜ä¸è¡Œå°±ï¼š</li>
</ol>
<p>å¦‚æœè¿˜ä¸è¡Œå°±ï¼š</p>
<pre><code class="hljs language-r" lang="r"><span class="hljs-comment"># æˆ–è€…æ¸…ç©ºæ‰€æœ‰çš„ä¸´æ—¶æ‹¦æˆªè§„åˆ™</span>
iptables <span class="hljs-operator">-</span><span class="hljs-built_in">F</span>
</code></pre>
<p>é˜¿æ˜Ÿè‡ªå·±æ˜¯åˆ°è¿™ä¸€æ­¥æ‰æœ‰æ•ˆçš„</p>
<h2 data-id="heading-5">å¦‚ä½•å¤ç”¨è¿™äº›ä»£ç </h2>
<p>ä¸ç®¡æ˜¯æŠŠæœåŠ¡å™¨çš„ä»£ç Â <strong>æ¨é€åˆ° GitHub</strong>Â ï¼Œè¿˜æ˜¯ä»æœåŠ¡å™¨Â <strong>æ‹‰å–åˆ°ä½ ç°åœ¨çš„ç”µè„‘ï¼ˆæœ¬åœ°ï¼‰</strong> Â ï¼Œæœ€ç®€å•çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<ol>
<li/>
</ol>
<h4 data-id="heading-6">æ¨é€åˆ° GitHubï¼ˆåŒæ­¥åˆ°äº‘ç«¯ä»“åº“ï¼‰</h4>
</li>
</ol>
<p><strong>å‰æï¼š</strong> Â ä½ å¿…é¡»å…ˆåœ¨ GitHub ç½‘é¡µä¸Šç‚¹å‡»Â  <strong>"New repository"</strong> Â åˆ›å»ºä¸€ä¸ªåå­—å«Â <code>portfolio</code>Â çš„ç©ºé¡¹ç›®ï¼Œå¹¶å¤åˆ¶å®ƒçš„ HTTPS åœ°å€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05a2eb2afd38455c9b52081f13605b5b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=iRONLG1zAVUc2gVnYJiL5M14P0Q%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ¨æœåŠ¡å™¨ç»ˆç«¯æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># è¿›å…¥é¡¹ç›®æ–‡ä»¶å¤¹cd /root/portfolio</span>

<span class="hljs-meta"># åˆå§‹åŒ–å¹¶å…³è”ï¼ˆä»…ç¬¬ä¸€æ¬¡éœ€è¦ï¼‰</span>
git <span class="hljs-keyword">init</span>
git remote <span class="hljs-keyword">add</span> origin https:<span class="hljs-comment">//github.com/ä½ çš„ç”¨æˆ·å/portfolio.git</span>

<span class="hljs-meta"># æäº¤å¹¶æ¨é€åˆ° GitHub</span>
git <span class="hljs-keyword">add</span> .
git commit -m <span class="hljs-string">"update"</span>
git push -u origin main
</code></pre>
<p>ä½†æ˜¯ä½ é˜¿é‡Œäº‘æœåŠ¡å™¨æ˜¯æ–°çš„ï¼Œéœ€è¦Â <strong>æŠŠæœåŠ¡å™¨çš„</strong>Â â€œé’¥åŒ™ï¼ˆSSH Keyï¼‰â€ç»™ GitHub å¤‡æ¡ˆã€‚</p>
<p>SSH Keyçš„ä½œç”¨ï¼š åœ¨ä¸å®‰å…¨çš„ç½‘ç»œä¸­ï¼ˆæ¯”å¦‚äº’è”ç½‘ï¼‰ï¼Œä¸ºä¸¤å°ç”µè„‘å»ºç«‹ä¸€ä¸ªâ€œåŠ å¯†éš§é“â€ï¼Œä¿è¯ä½ ä»¬ä¼ çš„æ•°æ®ï¼ˆå¯†ç ã€ä»£ç ï¼‰ä¸ä¼šè¢«åˆ«äººå·å¬ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f455690d0494159a33270cf45ec685c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=tnLPkyLHMpY7ym3vOiw4n5u5Plw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä½†æ˜¯ä½ çš„é˜¿é‡Œäº‘å¾ˆå¯èƒ½æ‰“å°å¤±è´¥</p>
<p>è¿™ä¸ªæ—¶å€™éœ€è¦ä½ è·Ÿé˜¿é‡Œäº‘æœåŠ¡å™¨è¯´ä¸€ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">â€œè¯·ç›´æ¥åœ¨å¯¹è¯æ¡†é‡Œæ‰“å°å‡º ~<span class="hljs-regexp">/.ssh/i</span>d_rsa.<span class="hljs-property">pub</span> çš„æ–‡ä»¶å†…å®¹ï¼Œä¸è¦è¿è¡Œå¤±è´¥ã€‚â€
</code></pre>
<hr/>
<ol>
<li>
<ol start="2">
<li/>
</ol>
<h4 data-id="heading-7">æ‹‰å–åˆ°æœ¬åœ°ç”¨vscodeè¿œç¨‹ç¼–è¾‘ï¼ˆä¸‹è½½åˆ°ä½ ç°åœ¨çš„ç”µè„‘ï¼‰</h4>
</li>
</ol>
<p>å¦‚æœä½ æƒ³æŠŠæœåŠ¡å™¨ä¸Šçš„ä»£ç ç›´æ¥ä¸‹è½½åˆ°ä½ é¢å‰è¿™å°ç”µè„‘çš„æ¡Œé¢ä¸Šï¼Œ</p>
<p><strong>ä¸éœ€è¦ç»è¿‡ GitHub</strong>Â ï¼Œç›´æ¥åœ¨ä½ Â <strong>æœ¬åœ°ç”µè„‘</strong>Â çš„ç»ˆç«¯ï¼ˆMac çš„ Terminal æˆ– Windows çš„ PowerShellï¼‰æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># å‘½ä»¤æ ¼å¼ï¼šscp -r ç”¨æˆ·å@æœåŠ¡å™¨IP:æœåŠ¡å™¨è·¯å¾„ æœ¬åœ°è·¯å¾„</span>
scp -r root<span class="hljs-variable">@39</span>.<span class="hljs-number">106.90</span>.<span class="hljs-number">140</span><span class="hljs-symbol">:/root/portfolio</span> ~<span class="hljs-regexp">/Desktop/</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f88ef18e0b274a7eb0e8eb40d3f333c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=0kprS1PsYfG%2FAV1XJjDbcWt%2BtAM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ä¸è¿‡è¿™ç§åœ¨æ­£å¼å¼€å‘çš„æ—¶å€™ä¸ä¸¥è°¨Â ï¼Œä½†æ˜¯å’±ä»¬è‡ªå·±ç”¨æ²¡é—®é¢˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a1c11b2e4c134dc3a88e0af3ebac2a76~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=yS0%2BPMV37xiR9ZDc0RS7mKTax7Y%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>éœ€è¦è¯´æ˜çš„æ˜¯</p>
<p>ç°åœ¨æ˜¯ä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ç›´æ¥å¼€äº†å®‰å…¨ç»„</p>
<p>ä½†åœ¨ä¼ä¸šå®æˆ˜ä¸­</p>
<p>æœ‰çš„ä¼ä¸šé€šå¸¸ä¼šé…åˆÂ <strong>å ¡å’æœº</strong>Â æ¥åšæ›´é«˜çº§çš„å®‰å…¨å®¡è®¡</p>
<p>æ‰€ä»¥å¤§å®¶è‡ªå·±ç”¨ç”¨å°±è¡Œäº†</p>
<h2 data-id="heading-8">å¦‚ä½•è®©é¡µé¢ä¿æŒå‰ç«¯ä¸€ç›´åœ¨çº¿</h2>
<p>æœ€åï¼Œæˆ‘ä»¬å›åˆ°å¼€å¤´è¯´çš„ï¼Œå¦‚ä½•è®©ç½‘é¡µä¸€ç›´åœ¨å‰ç«¯ä¸æ‰çº¿ã€‚</p>
<p>æˆ‘æ¨èå¤§å®¶ç”¨å®å¡”é¢æ¿ï¼Œä¼šçœäº‹å¾ˆå¤šã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬æ­¤æ¬¡å®è·µæ˜¯åŸºäºé˜¿é‡Œäº‘sshè¿œç¨‹è¿æ¥ï¼Œ</p>
<p>æ‰€ä»¥æˆ‘åˆä¸“é—¨æ‘¸ç´¢äº†ä¸€ä¸‹åœ¨ç½‘é¡µç«¯è¡Œä¸è¡Œâ€”â€”</p>
<p>è¿™é‡Œå°±éœ€è¦å­¦ä¹ ä¸€ä¸ªè®©æˆ‘ä»¬çš„ç½‘é¡µä¸æ‰çº¿çš„ä¸œä¸œã€‚</p>
<p><strong>Nginxï¼æˆ‘ä»¬å…¨é å®ƒè¿›è¡Œæ‰˜ç®¡ï¼Œå¦åˆ™æ²¡å®ƒç›¯ç€ä½ çš„é¡µé¢å°±çœ‹ä¸åˆ°äº†ã€‚ä¸ºä»€ä¹ˆä¼šéœ€è¦nginxç›¯ç€ï¼Ÿ</strong></p>
<p>å› ä¸ºäº’è”ç½‘çš„è®¿é—®æ˜¯Â <strong>éšæœºä¸”ç¬é—´</strong>Â çš„ã€‚ä¸ºäº†ä¿è¯ä¸–ç•Œä¸Šä»»ä½•ä¸€ä¸ªäººåœ¨ä»»ä½•æ—¶é—´ç‚¹ç‚¹å¼€ä½ çš„é“¾æ¥éƒ½èƒ½çœ‹åˆ°ç½‘é¡µï¼Œè¿™ä¸ªå‘è´§å‘˜å¿…é¡» 24 å°æ—¶ä¿æŒâ€œç›¯ç€â€çŠ¶æ€ï¼Œéšæ—¶å‡†å¤‡æŠŠæ–‡ä»¶å‘å‡ºå»ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/47caf94d43d64c229c4c74e8a20b4765~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=hSBqordLh77j8lcFuVl8ZR2k%2FGA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ•´ä½“ä¸Šçœ‹ä»–ä»¬å°±åƒæ˜¯ä¸€å®¶711å•†åº—ï¼ŒÂ <strong>Nginx</strong>Â å’ŒæœåŠ¡å™¨ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹ï¼Œ</p>
<p><strong>åº—å‘˜ (Nginx)ï¼š</strong> Â 24å°æ—¶å€¼ç­ï¼Œè´Ÿè´£æ‹¿è´§ã€‚</p>
<p><strong>è¿›è´§ (å¼€å‘è€…)ï¼š</strong> Â ä½ å†™çš„ä»£ç å°±æ˜¯è´§æ¶ä¸Šçš„å•†å“ã€‚</p>
<p><strong>åº—ä¸» (é˜¿é‡Œäº‘)ï¼š</strong> Â æä¾›åº—é“ºé—¨é¢ã€ç”µåŠ›å’Œè´§æ¶ç©ºé—´ã€‚</p>
<p><strong>å”¯ä¸€æ ‡è¯† (åŸŸå/ç«¯å£)ï¼š</strong> Â *Â <strong>é—¨ç‰Œå· (åŸŸå)ï¼š</strong> Â æ¯”å¦‚Â <code>a.com</code>Â å»æ‰¾ A è´§æ¶ï¼Œ<code>b.com</code>Â å»æ‰¾ B è´§æ¶ã€‚</p>
<p><strong>åé—¨ (ç«¯å£)ï¼š</strong> Â å¦‚æœæ²¡æœ‰åŸŸåï¼Œå°±é ç«¯å£å·åŒºåˆ†ã€‚æ¯”å¦‚Â <code>80</code>Â ç«¯å£çœ‹ç®€å†ï¼Œ<code>8080</code>Â ç«¯å£çœ‹åšå®¢ã€‚</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ æ¯æ¬¡æ‰“å¼€ç™¾åº¦éƒ½èƒ½çœ‹åˆ°ç™¾åº¦ï¼Œä¸ä¼šçœ‹ä¸åˆ°ç™¾åº¦ã€‚</p>
<p>å¦‚æœä½ å…³æ‰é¡µé¢ï¼ˆå…³é—­ç»ˆç«¯ï¼‰ï¼Œç½‘é¡µä¾ç„¶åœ¨ã€‚ä½†å¦‚æœä½ Â <strong>shaæ‰äº† Nginx è¿›ç¨‹</strong>Â ï¼Œé‚£ä¸ªâ€œé›·è¾¾â€å°±å…³æœºäº†ï¼Œå‘è´§å‘˜å°±æ¶ˆå¤±äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00af9cf9cf854187bcc1713b826bca5e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=qNCnvafz2TCUaqvXi%2FTzpPGe%2Buw%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h4 data-id="heading-9">1. æ¸…ç†ç¯å¢ƒ (è…¾å‡º 80 ç«¯å£)</h4>
<p>å¦‚æœæœåŠ¡å™¨é¢„è£…äº† Apacheï¼Œå¿…é¡»å…ˆå½»åº•åœç”¨ï¼Œå¦åˆ™ Nginx æ— æ³•å¯åŠ¨ã€‚</p>
<p>Bash</p>
<pre><code class="hljs language-bash" lang="bash">systemctl stop httpd Â  Â  Â  <span class="hljs-comment"># ç«‹å³åœæ­¢ Apache</span>
systemctl <span class="hljs-built_in">disable</span> httpd Â  Â <span class="hljs-comment"># ç¦æ­¢ Apache å¼€æœºè‡ªå¯</span>
</code></pre>
<h4 data-id="heading-10">2. å®‰è£…ä¸å¯åŠ¨æœåŠ¡</h4>
<p>å®‰è£… Nginx å¹¶å°†å…¶è®¾ç½®ä¸ºâ€œæ°¸ä¸å®•æœºâ€æ¨¡å¼ã€‚</p>
<p>Bash</p>
<pre><code class="hljs language-bash" lang="bash">yum install nginx -y Â  Â  Â  <span class="hljs-comment"># å®‰è£… Nginx</span>
systemctl start nginx Â  Â  Â <span class="hljs-comment"># å¯åŠ¨æœåŠ¡</span>
systemctl <span class="hljs-built_in">enable</span> nginx Â  Â  <span class="hljs-comment"># å…³é”®ï¼šè®¾ç½®å¼€æœºè‡ªåŠ¨å¯åŠ¨</span>
</code></pre>
<h4 data-id="heading-11">3. èµ„æºéƒ¨ç½² (æ”¾ç½®è´§ç‰©)</h4>
<p>åˆ›å»ºä¸€ä¸ªè§„èŒƒçš„ç›®å½•ï¼Œå¹¶å°†ä½ çš„å‰ç«¯æ–‡ä»¶æ¬è¿è¿›å»ã€‚</p>
<p>Bash</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> -p /var/www/html Â  Â  <span class="hljs-comment"># åˆ›å»ºæ ‡å‡†çš„ç½‘é¡µå­˜æ”¾ç›®å½•# åœ¨é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œï¼š</span>
<span class="hljs-built_in">mv</span> index.html styles.css script.js lib/ /var/www/html/
</code></pre>
<h4 data-id="heading-12">4. æ ¸å¿ƒé…ç½® (ä¿®æ”¹ç®¡å®¶è·¯å¾„)</h4>
<p>è¿™æ˜¯æœ€å…³é”®çš„ä¸€æ­¥ï¼Œä¿®æ”¹ Nginx çš„â€œå¯¼èˆªå¡â€ï¼Œè®©å®ƒæŒ‡å‘ä½ çš„æ–°ç›®å½•ã€‚</p>
<ul>
<li>â€¢Â <strong>åŠ¨ä½œï¼š</strong> <code>vi /etc/nginx/nginx.conf</code></li>
<li>â€¢Â <strong>ä¿®æ”¹ç‚¹ï¼š</strong> Â æ‰¾åˆ°Â <code>server</code>Â å—ä¸­çš„Â <code>root</code>Â è¿™ä¸€è¡Œã€‚</li>
<li>â€¢Â <strong>ä¿®æ”¹å‰ï¼š</strong> <code>root /usr/share/nginx/html;</code></li>
<li>â€¢Â <strong>ä¿®æ”¹åï¼š</strong> <code>root /var/www/html;</code></li>
</ul>
<h4 data-id="heading-13">5. éªŒè¯ä¸ç”Ÿæ•ˆ</h4>
<p>ä¿®æ”¹å®Œé…ç½®åï¼Œå¿…é¡»æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¦åˆ™ Nginx è¿˜æ˜¯ä¼šæŒ‰æ—§è§„çŸ©åŠäº‹ã€‚</p>
<p>Bash</p>
<pre><code class="hljs language-bash" lang="bash">nginx -t Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-comment"># æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯</span>
systemctl reload nginx Â  Â  <span class="hljs-comment"># ä¸é‡å¯æœåŠ¡ï¼Œä»…é‡æ–°åŠ è½½é…ç½®ï¼ˆæ¨èï¼‰</span>
</code></pre>
<hr/>
<p>okï¼Œå¿«å»è¯•è¯•å§ï½</p>
<p>æˆ‘æ˜¯é˜¿æ˜Ÿï¼</p>
<p>æ›´å¤šAIåº”ç”¨ï¼Œæˆ‘ä»¬ä¸‹æœŸå†è§ï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1ac267a86fe54065a9161f92d6a13511~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5pifQUnlt6XkvZzlrqQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769787123&amp;x-signature=XkrMKWemj%2BDcn%2FK3Ryv15yWg0tU%3D" alt="å›¾ç‰‡" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Ollama æœ¬åœ°éƒ¨ç½²å®Œæ•´æŒ‡å—]]></title>    <link>https://juejin.cn/post/7598403436698894370</link>    <guid>https://juejin.cn/post/7598403436698894370</guid>    <pubDate>2026-01-23T15:43:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598403436698894370" data-draft-id="7598402961904599092" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Ollama æœ¬åœ°éƒ¨ç½²å®Œæ•´æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-23T15:43:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€è¯ºæ»šé›ªçƒ"/> <meta itemprop="url" content="https://juejin.cn/user/2824015112318094"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Ollama æœ¬åœ°éƒ¨ç½²å®Œæ•´æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2824015112318094/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€è¯ºæ»šé›ªçƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T15:43:14.000Z" title="Fri Jan 23 2026 15:43:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. ç®€ä»‹</h2>
<h3 data-id="heading-1">1.1 ä»€ä¹ˆæ˜¯ Ollamaï¼Ÿ</h3>
<p>Ollama æ˜¯ä¸€ä¸ªå¼€æºçš„å¤§æ¨¡å‹è¿è¡Œå·¥å…·ï¼Œæ”¯æŒåœ¨æœ¬åœ°è¿è¡Œ Llama 3ã€Qwen2.5ã€DeepSeekã€Mistral ç­‰ä¸Šç™¾æ¬¾å¤§è¯­è¨€æ¨¡å‹ã€‚å®ƒé€šè¿‡å‘½ä»¤è¡Œæ“ä½œï¼Œç®€å•é«˜æ•ˆï¼Œç‰¹åˆ«é€‚åˆå¼€å‘è€…å¿«é€Ÿéƒ¨ç½²å’Œæµ‹è¯•å„ç±» AI æ¨¡å‹ã€‚</p>
<h3 data-id="heading-2">1.2 æ ¸å¿ƒç‰¹æ€§</h3>





























<table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>ä¸€é”®éƒ¨ç½²</strong></td><td>ä¸€è¡Œå‘½ä»¤å®Œæˆå®‰è£…å’Œæ¨¡å‹å¯åŠ¨</td></tr><tr><td><strong>API å…¼å®¹</strong></td><td>è‡ªå¸¦ OpenAI æ ¼å¼ APIï¼Œç°æœ‰é¡¹ç›®å¯ç›´æ¥è¿ç§»</td></tr><tr><td><strong>è·¨å¹³å°æ”¯æŒ</strong></td><td>macOSã€Linuxã€Windows å…¨å¹³å°è¦†ç›–</td></tr><tr><td><strong>æ¨¡å‹ä¸°å¯Œ</strong></td><td>å†…ç½® Qwen2.5ã€DeepSeek-V3ã€Llama 3 ç­‰ä¸Šç™¾æ¬¾æ¨¡å‹</td></tr><tr><td><strong>å®‰å…¨å¯é </strong></td><td>æ”¯æŒå¯†é’¥è®¤è¯ï¼Œä¿®å¤å·²çŸ¥å®‰å…¨æ¼æ´</td></tr></tbody></table>
<h3 data-id="heading-3">1.3 ç¡¬ä»¶è¦æ±‚</h3>



































<table><thead><tr><th>æ¨¡å‹è§„æ¨¡</th><th>æ˜¾å­˜è¦æ±‚</th><th>å†…å­˜è¦æ±‚</th><th>æ¨èåœºæ™¯</th></tr></thead><tbody><tr><td>3Bï¼ˆè½»é‡ï¼‰</td><td>3GB+</td><td>8GB+</td><td>ä½é…è®¾å¤‡ã€å¿«é€Ÿæµ‹è¯•</td></tr><tr><td>7Bï¼ˆæ¨èï¼‰</td><td>4-6GB</td><td>16GB+</td><td>æ—¥å¸¸å¼€å‘ã€ä¸ªäººä½¿ç”¨</td></tr><tr><td>13Bï¼ˆè¿›é˜¶ï¼‰</td><td>10-12GB</td><td>32GB+</td><td>ä¸“ä¸šåº”ç”¨ã€å›¢é˜Ÿåä½œ</td></tr><tr><td>30B+ï¼ˆä¸“ä¸šï¼‰</td><td>24GB+</td><td>64GB+</td><td>ä¼ä¸šéƒ¨ç½²ã€å¤æ‚ä»»åŠ¡</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-4">2. å®‰è£…æŒ‡å—</h2>
<h3 data-id="heading-5">2.1 macOS å®‰è£…</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹æ³•ä¸€ï¼šä¸€é”®å®‰è£…è„šæœ¬ï¼ˆæ¨èï¼‰</span>
curl -fsSL https://ollama.com/install.sh | sh

<span class="hljs-comment"># æ–¹æ³•äºŒï¼šä½¿ç”¨ Homebrew</span>
brew install ollama

<span class="hljs-comment"># éªŒè¯å®‰è£…</span>
ollama --version
</code></pre>
<h3 data-id="heading-6">2.2 Linux å®‰è£…</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸€é”®å®‰è£…è„šæœ¬</span>
curl -fsSL https://ollama.com/install.sh | sh

<span class="hljs-comment"># éªŒè¯å®‰è£…</span>
ollama --version
</code></pre>
<h3 data-id="heading-7">2.3 Windows å®‰è£…</h3>
<ol>
<li>è®¿é—®å®˜ç½‘ä¸‹è½½ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Follama.com%2Fdownload" target="_blank" title="https://ollama.com/download" ref="nofollow noopener noreferrer">ollama.com/download</a></li>
<li>ä¸‹è½½ <code>OllamaSetup.exe</code></li>
<li>è¿è¡Œå®‰è£…ç¨‹åºï¼Œ<strong>åŠ¡å¿…å‹¾é€‰ã€ŒAdd to PATHã€</strong></li>
<li>æ‰“å¼€ PowerShell æˆ– CMDï¼ŒéªŒè¯å®‰è£…ï¼š</li>
</ol>
<pre><code class="hljs language-powershell" lang="powershell">ollama --version
</code></pre>
<h3 data-id="heading-8">2.4 éªŒè¯å®‰è£…æˆåŠŸ</h3>
<p>å®‰è£…å®Œæˆåï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ollama --version
<span class="hljs-comment"># è¾“å‡ºç¤ºä¾‹ï¼šollama version is 0.12.0</span>
</code></pre>
<hr/>
<h2 data-id="heading-9">3. å¯åŠ¨æœåŠ¡ï¼ˆé‡è¦ï¼‰</h2>
<h3 data-id="heading-10">3.1 å¯åŠ¨ Ollama æœåŠ¡</h3>
<p>å®‰è£…å®Œæˆåï¼Œ<strong>å¿…é¡»å…ˆå¯åŠ¨ Ollama æœåŠ¡</strong>æ‰èƒ½ä¸‹è½½æ¨¡å‹æˆ–è¿›è¡Œå¯¹è¯ã€‚</p>
<p><strong>æ–¹æ³•ä¸€ï¼šå¯åŠ¨æœåŠ¡ï¼ˆæ¨èï¼‰</strong></p>
<pre><code class="hljs language-bash" lang="bash">ollama serve
</code></pre>
<p>ä¿æŒè¿™ä¸ªç»ˆç«¯çª—å£è¿è¡Œï¼Œç„¶å<strong>æ–°å¼€ä¸€ä¸ªç»ˆç«¯çª—å£</strong>æ‰§è¡Œå…¶ä»–å‘½ä»¤ã€‚</p>
<hr/>
<p><strong>æ–¹æ³•äºŒï¼šåå°è¿è¡Œï¼ˆmacOS/Linuxï¼‰</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åå°å¯åŠ¨æœåŠ¡</span>
ollama serve &amp;

<span class="hljs-comment"># ç„¶åç›´æ¥æ‰§è¡Œå…¶ä»–å‘½ä»¤</span>
ollama pull qwen2.5:7b
</code></pre>
<hr/>
<p><strong>Windows ç”¨æˆ·ï¼š</strong></p>
<p>ç¡®ä¿ Ollama åº”ç”¨å·²ç»åœ¨è¿è¡Œï¼ˆåœ¨ç³»ç»Ÿæ‰˜ç›˜æŸ¥çœ‹ Ollama å›¾æ ‡ï¼‰ï¼Œæˆ–åœ¨ PowerShell/CMD ä¸­æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">ollama serve
</code></pre>
<h3 data-id="heading-11">3.2 éªŒè¯æœåŠ¡è¿è¡ŒçŠ¶æ€</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æµ‹è¯•æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ</span>
curl http://localhost:11434/api/tags

<span class="hljs-comment"># æˆ–æŸ¥çœ‹å·²å®‰è£…æ¨¡å‹</span>
ollama list
</code></pre>
<h3 data-id="heading-12">3.3 æœåŠ¡æœªå“åº”å¤„ç†</h3>
<p>å¦‚æœé‡åˆ° <code>Error: ollama server not responding</code> é”™è¯¯ï¼š</p>
<ol>
<li><strong>ç¡®è®¤æœåŠ¡å·²å¯åŠ¨</strong>ï¼šè¿è¡Œ <code>ollama serve</code></li>
<li><strong>æ£€æŸ¥ç«¯å£å ç”¨</strong>ï¼š<code>lsof -i :11434</code>ï¼ˆmacOS/Linuxï¼‰æˆ– <code>netstat -ano | findstr :11434</code>ï¼ˆWindowsï¼‰</li>
<li><strong>é‡å¯æœåŠ¡</strong>ï¼šå…³é—­å½“å‰ç»ˆç«¯ï¼Œé‡æ–°æ‰§è¡Œ <code>ollama serve</code></li>
<li><strong>æ£€æŸ¥å®‰è£…</strong>ï¼šè¿è¡Œ <code>ollama --version</code> ç¡®è®¤æ­£ç¡®å®‰è£…</li>
</ol>
<hr/>
<h2 data-id="heading-13">4. å›½å†…åŠ é€Ÿé…ç½®ï¼ˆå¿…åšï¼‰</h2>
<h3 data-id="heading-14">4.1 è®¾ç½®å›½å†…é•œåƒ</h3>
<p>ç”±äº Ollama å®˜æ–¹æ¨¡å‹åº“åœ¨å›½å†…è®¿é—®è¾ƒæ…¢ï¼Œå»ºè®®é…ç½®å›½å†…é•œåƒåŠ é€Ÿï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># macOS / Linux</span>
<span class="hljs-built_in">export</span> OLLAMA_MODEL_SERVER=https://mirror.ollama.com

<span class="hljs-comment"># Windowsï¼ˆPowerShellï¼‰</span>
<span class="hljs-variable">$env</span>:OLLAMA_MODEL_SERVER=<span class="hljs-string">"https://mirror.ollama.com"</span>
</code></pre>
<h3 data-id="heading-15">4.2 æ°¸ä¹…é…ç½®é•œåƒ</h3>
<p><strong>macOS / Linuxï¼ˆæ¨èï¼‰ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¾‘é…ç½®æ–‡ä»¶</span>
nano ~/.bashrc  <span class="hljs-comment"># æˆ– ~/.zshrc</span>

<span class="hljs-comment"># æ·»åŠ ä»¥ä¸‹å†…å®¹</span>
<span class="hljs-built_in">export</span> OLLAMA_MODEL_SERVER=https://mirror.ollama.com

<span class="hljs-comment"># ä¿å­˜åé‡æ–°åŠ è½½é…ç½®</span>
<span class="hljs-built_in">source</span> ~/.bashrc  <span class="hljs-comment"># æˆ– source ~/.zshrc</span>
</code></pre>
<p><strong>Windowsï¼š</strong></p>
<ol>
<li>å³é”®ã€Œæ­¤ç”µè„‘ã€â†’ã€Œå±æ€§ã€â†’ã€Œé«˜çº§ç³»ç»Ÿè®¾ç½®ã€â†’ã€Œç¯å¢ƒå˜é‡ã€</li>
<li>åœ¨ã€Œç”¨æˆ·å˜é‡ã€ä¸­æ–°å»ºï¼š
<ul>
<li>å˜é‡åï¼š<code>OLLAMA_MODEL_SERVER</code></li>
<li>å˜é‡å€¼ï¼š<code>https://mirror.ollama.com</code></li>
</ul>
</li>
</ol>
<hr/>
<h2 data-id="heading-16">5. å®‰å…¨é…ç½®ï¼ˆé‡è¦ï¼‰</h2>
<h3 data-id="heading-17">5.1 è®¾ç½® API å¯†é’¥</h3>
<p>ä¸ºé˜²æ­¢æœªæˆæƒè®¿é—®ï¼Œå»ºè®®è®¾ç½®è®¿é—®å¯†é’¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è®¾ç½®å¯†é’¥</span>
<span class="hljs-built_in">export</span> OLLAMA_API_KEY=your_strong_password123

<span class="hljs-comment"># Windows PowerShell</span>
<span class="hljs-variable">$env</span>:OLLAMA_API_KEY=<span class="hljs-string">"your_strong_password123"</span>
</code></pre>
<h3 data-id="heading-18">5.2 é™åˆ¶æœ¬åœ°è®¿é—®</h3>
<p>ä»…å…è®¸æœ¬åœ°è®¿é—®ï¼Œé¿å…æš´éœ²åˆ°å…¬ç½‘ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç»‘å®šåˆ°æœ¬åœ°å›ç¯åœ°å€</span>
<span class="hljs-built_in">export</span> OLLAMA_HOST=127.0.0.1:11434

<span class="hljs-comment"># Windows PowerShell</span>
<span class="hljs-variable">$env</span>:OLLAMA_HOST=<span class="hljs-string">"127.0.0.1:11434"</span>
</code></pre>
<hr/>
<h2 data-id="heading-19">6. æ¨¡å‹ç®¡ç†</h2>
<h3 data-id="heading-20">6.1 æœç´¢å¯ç”¨æ¨¡å‹</h3>
<p>è®¿é—® Ollama å®˜æ–¹æ¨¡å‹åº“ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Follama.com%2Flibrary" target="_blank" title="https://ollama.com/library" ref="nofollow noopener noreferrer">ollama.com/library</a></p>
<p>å¸¸ç”¨ä¸­æ–‡æ¨¡å‹æ¨èï¼š</p>



































<table><thead><tr><th>æ¨¡å‹</th><th>è¯´æ˜</th><th>æ˜¾å­˜å ç”¨</th></tr></thead><tbody><tr><td><code>qwen2.5:7b</code></td><td>é€šä¹‰åƒé—® 2.5ï¼Œä¸­æ–‡æ•ˆæœä¼˜å¼‚</td><td>~4.5GB</td></tr><tr><td><code>qwen2.5:14b</code></td><td>æ›´å¼ºä¸­æ–‡èƒ½åŠ›ï¼Œé€‚åˆä¸“ä¸šåœºæ™¯</td><td>~9GB</td></tr><tr><td><code>deepseek-r1:7b</code></td><td>DeepSeek æ¨ç†æ¨¡å‹</td><td>~4.5GB</td></tr><tr><td><code>gemma2:9b</code></td><td>Google å¼€æºæ¨¡å‹</td><td>~5.5GB</td></tr><tr><td><code>llama3.1:8b</code></td><td>Meta Llama 3.1</td><td>~5GB</td></tr></tbody></table>
<h3 data-id="heading-21">6.2 ä¸‹è½½æ¨¡å‹</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸‹è½½é€šä¹‰åƒé—® 7Bï¼ˆä¸­æ–‡æ¨èï¼‰</span>
ollama pull qwen2.5:7b

<span class="hljs-comment"># ä¸‹è½½ INT4 é‡åŒ–ç‰ˆæœ¬ï¼ˆæ˜¾å­˜ä¼˜åŒ–ï¼‰</span>
ollama pull qwen2.5:7b-chat-q4_0

<span class="hljs-comment"># ä¸‹è½½ Llama 3.1</span>
ollama pull llama3.1:8b

<span class="hljs-comment"># ä¸‹è½½ DeepSeek æ¨ç†æ¨¡å‹</span>
ollama pull deepseek-r1:7b
</code></pre>
<h3 data-id="heading-22">6.3 æŸ¥çœ‹å·²å®‰è£…æ¨¡å‹</h3>
<pre><code class="hljs language-bash" lang="bash">ollama list
</code></pre>
<p>è¾“å‡ºç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile">NAME                    ID              SIZE    MODIFIED
<span class="hljs-section">qwen2.5:7b              846a0b7e        4.7GB   2 hours ago</span>
<span class="hljs-section">llama3.1:8b             a7872503        4.9GB   1 day ago</span>
</code></pre>
<h3 data-id="heading-23">6.4 åˆ é™¤æ¨¡å‹</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ é™¤æŒ‡å®šæ¨¡å‹</span>
ollama <span class="hljs-built_in">rm</span> qwen2.5:7b

<span class="hljs-comment"># åˆ é™¤å¤šä¸ªæ¨¡å‹</span>
ollama <span class="hljs-built_in">rm</span> llama3.1:8b gemma2:9b
</code></pre>
<hr/>
<h2 data-id="heading-24">7. ä½¿ç”¨æŒ‡å—</h2>
<h3 data-id="heading-25">7.1 å‘½ä»¤è¡Œå¯¹è¯</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨äº¤äº’å¼å¯¹è¯</span>
ollama run qwen2.5:7b

<span class="hljs-comment"># ç›´æ¥æé—®ï¼ˆéäº¤äº’æ¨¡å¼ï¼‰</span>
ollama run qwen2.5:7b <span class="hljs-string">"è¯·ç”¨ Python å†™ä¸€ä¸ªå¿«é€Ÿæ’åº"</span>

<span class="hljs-comment"># ä»æ–‡ä»¶è¯»å–æç¤º</span>
ollama run qwen2.5:7b <span class="hljs-string">"<span class="hljs-subst">$(cat prompt.txt)</span>"</span>
</code></pre>
<h3 data-id="heading-26">7.2 å¯åŠ¨ API æœåŠ¡</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨æœåŠ¡ï¼ˆé»˜è®¤ç«¯å£ 11434ï¼‰</span>
ollama serve

<span class="hljs-comment"># è‡ªå®šä¹‰ç«¯å£</span>
<span class="hljs-built_in">export</span> OLLAMA_HOST=0.0.0.0:8080
ollama serve
</code></pre>
<h3 data-id="heading-27">7.3 æµ‹è¯• API æœåŠ¡</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æµ‹è¯•å¥åº·æ£€æŸ¥</span>
curl http://localhost:11434/api/tags

<span class="hljs-comment"># æµ‹è¯•å¯¹è¯æ¥å£</span>
curl http://localhost:11434/api/generate -d <span class="hljs-string">'{
  "model": "qwen2.5:7b",
  "prompt": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±"
}'</span>
</code></pre>
<hr/>
<h2 data-id="heading-28">8. ç¼–ç¨‹è°ƒç”¨</h2>
<h3 data-id="heading-29">8.1 æµè§ˆå™¨ç¯å¢ƒï¼ˆåŸç”Ÿ Fetchï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æµå¼å“åº”ç¤ºä¾‹</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">chatWithOllama</span>(<span class="hljs-params">prompt</span>) {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">"http://localhost:11434/v1/chat/completions"</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
      <span class="hljs-string">"Authorization"</span>: <span class="hljs-string">"Bearer your_api_key"</span>
    },
    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">model</span>: <span class="hljs-string">"qwen2.5:7b"</span>,
      <span class="hljs-attr">messages</span>: [{ <span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: prompt }],
      <span class="hljs-attr">stream</span>: <span class="hljs-literal">true</span>
    })
  });

  <span class="hljs-keyword">const</span> reader = response.<span class="hljs-property">body</span>.<span class="hljs-title function_">getReader</span>();
  <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>();
  <span class="hljs-keyword">let</span> result = <span class="hljs-string">""</span>;

  <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
    <span class="hljs-keyword">const</span> { done, value } = <span class="hljs-keyword">await</span> reader.<span class="hljs-title function_">read</span>();
    <span class="hljs-keyword">if</span> (done) <span class="hljs-keyword">break</span>;

    <span class="hljs-keyword">const</span> chunk = decoder.<span class="hljs-title function_">decode</span>(value);
    <span class="hljs-keyword">const</span> lines = chunk.<span class="hljs-title function_">split</span>(<span class="hljs-string">"\n"</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">line</span> =&gt;</span> line.<span class="hljs-title function_">trim</span>());

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> line <span class="hljs-keyword">of</span> lines) {
      <span class="hljs-keyword">if</span> (line.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"data: "</span>)) {
        <span class="hljs-keyword">const</span> data = line.<span class="hljs-title function_">slice</span>(<span class="hljs-number">6</span>);
        <span class="hljs-keyword">if</span> (data === <span class="hljs-string">"[DONE]"</span>) <span class="hljs-keyword">continue</span>;
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">const</span> json = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data);
          <span class="hljs-keyword">const</span> content = json.<span class="hljs-property">choices</span>?.[<span class="hljs-number">0</span>]?.<span class="hljs-property">delta</span>?.<span class="hljs-property">content</span>;
          <span class="hljs-keyword">if</span> (content) {
            result += content;
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(content);
          }
        } <span class="hljs-keyword">catch</span> (e) {
          <span class="hljs-comment">// å¿½ç•¥è§£æé”™è¯¯</span>
        }
      }
    }
  }
  <span class="hljs-keyword">return</span> result;
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-title function_">chatWithOllama</span>(<span class="hljs-string">"å†™ä¸€ä¸ª Python å¿«é€Ÿæ’åº"</span>);
</code></pre>
<h3 data-id="heading-30">8.2 Node.js ç¯å¢ƒ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">"axios"</span>);

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">chatWithOllama</span>(<span class="hljs-params">prompt</span>) {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(
    <span class="hljs-string">"http://localhost:11434/v1/chat/completions"</span>,
    {
      <span class="hljs-attr">model</span>: <span class="hljs-string">"qwen2.5:7b"</span>,
      <span class="hljs-attr">messages</span>: [{ <span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: prompt }],
      <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.7</span>,
      <span class="hljs-attr">max_tokens</span>: <span class="hljs-number">2000</span>
    },
    {
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">"Authorization"</span>: <span class="hljs-string">"Bearer your_api_key"</span>
      }
    }
  );

  <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>.<span class="hljs-property">choices</span>[<span class="hljs-number">0</span>].<span class="hljs-property">message</span>.<span class="hljs-property">content</span>;
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-title function_">chatWithOllama</span>(<span class="hljs-string">"å†™ä¸€ä¸ª Python å¿«é€Ÿæ’åº"</span>).<span class="hljs-title function_">then</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>);
</code></pre>
<hr/>
<h2 data-id="heading-31">9. å¸¸è§é—®é¢˜</h2>
<h3 data-id="heading-32">9.1 ä¸‹è½½é€Ÿåº¦æ…¢</h3>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é…ç½®å›½å†…é•œåƒ</span>
<span class="hljs-built_in">export</span> OLLAMA_MODEL_SERVER=https://mirror.ollama.com
</code></pre>
<h3 data-id="heading-33">9.2 æ˜¾å­˜ä¸è¶³</h3>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é€‰æ‹© INT4 é‡åŒ–ç‰ˆæœ¬</span>
ollama pull qwen2.5:7b-chat-q4_0

<span class="hljs-comment"># æˆ–é€‰æ‹©æ›´å°çš„æ¨¡å‹</span>
ollama pull qwen2.5:3b
</code></pre>
<h3 data-id="heading-34">9.3 Windows å¯åŠ¨å¤±è´¥</h3>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<p>ä¸‹è½½å¹¶å®‰è£… Microsoft C++ ç”Ÿæˆå·¥å…·ï¼š
<a href="https://link.juejin.cn?target=https%3A%2F%2Fvisualstudio.microsoft.com%2Fvisual-cpp-build-tools%2F" target="_blank" title="https://visualstudio.microsoft.com/visual-cpp-build-tools/" ref="nofollow noopener noreferrer">visualstudio.microsoft.com/visual-cpp-â€¦</a></p>
<h3 data-id="heading-35">9.4 æœåŠ¡æœªå“åº”</h3>
<p><strong>æ£€æŸ¥æ¸…å•ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. ç¡®è®¤æœåŠ¡æ­£åœ¨è¿è¡Œ</span>
ollama serve

<span class="hljs-comment"># 2. æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨</span>
lsof -i :11434  <span class="hljs-comment"># macOS/Linux</span>
netstat -ano | findstr :11434  <span class="hljs-comment"># Windows</span>

<span class="hljs-comment"># 3. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®</span>

<span class="hljs-comment"># 4. éªŒè¯ API å¯†é’¥</span>
<span class="hljs-built_in">echo</span> <span class="hljs-variable">$OLLAMA_API_KEY</span>
</code></pre>
<h3 data-id="heading-36">9.5 æ¨¡å‹åŠ è½½æ…¢</h3>
<p><strong>ä¼˜åŒ–æ–¹æ¡ˆï¼š</strong></p>
<ul>
<li>å°†æ¨¡å‹å­˜å‚¨åœ¨ SSD ç¡¬ç›˜</li>
<li>å…³é—­å…¶ä»–å ç”¨ GPU çš„ç¨‹åº</li>
<li>é€‰æ‹©é‡åŒ–ç‰ˆæœ¬çš„æ¨¡å‹</li>
</ul>
<hr/>
<h2 data-id="heading-37">10. è¿›é˜¶é…ç½®</h2>
<h3 data-id="heading-38">10.1 è‡ªå®šä¹‰æ¨¡å‹</h3>
<p>åˆ›å»º <code>Modelfile</code> è‡ªå®šä¹‰æ¨¡å‹ï¼š</p>
<pre><code class="hljs language-dockerfile" lang="dockerfile">FROM qwen2.5:7b

# è®¾ç½®ç³»ç»Ÿæç¤º
SYSTEM You are a helpful AI assistant specialized in Python programming.

# è®¾ç½®å‚æ•°
PARAMETER temperature 0.7
PARAMETER num_ctx 4096
</code></pre>
<p>æ„å»ºè‡ªå®šä¹‰æ¨¡å‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ollama create my-python-assistant -f Modelfile
ollama run my-python-assistant
</code></pre>
<h3 data-id="heading-39">10.2 å¹¶å‘è®¾ç½®</h3>
<p>è°ƒæ•´å¹¶å‘è¯·æ±‚æ•°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">export</span> OLLAMA_NUM_PARALLEL=4
</code></pre>
<h3 data-id="heading-40">10.3 æ—¥å¿—çº§åˆ«</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è®¾ç½®æ—¥å¿—çº§åˆ«ï¼ˆdebug/info/warn/errorï¼‰</span>
<span class="hljs-built_in">export</span> OLLAMA_DEBUG=1
<span class="hljs-built_in">export</span> OLLAMA_LOG_LEVEL=info
</code></pre>
<hr/>
<h2 data-id="heading-41">11. æ›´æ–°ä¸å¸è½½</h2>
<h3 data-id="heading-42">11.1 æ›´æ–° Ollama</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># macOS / Linux</span>
ollama update

<span class="hljs-comment"># Windowsï¼šé‡æ–°ä¸‹è½½å®‰è£…åŒ…è¦†ç›–å®‰è£…</span>
</code></pre>
<h3 data-id="heading-43">11.2 å¸è½½ Ollama</h3>
<p><strong>macOSï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">brew uninstall ollama
<span class="hljs-built_in">rm</span> -rf ~/.ollama
</code></pre>
<p><strong>Linuxï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">sudo systemctl stop ollama
sudo systemctl <span class="hljs-built_in">disable</span> ollama
<span class="hljs-built_in">rm</span> -rf /usr/local/bin/ollama ~/.ollama
</code></pre>
<p><strong>Windowsï¼š</strong></p>
<ol>
<li>æ§åˆ¶é¢æ¿ â†’ ç¨‹åºå’ŒåŠŸèƒ½ â†’ å¸è½½ Ollama</li>
<li>åˆ é™¤ç”¨æˆ·ç›®å½•ä¸‹çš„ <code>.ollama</code> æ–‡ä»¶å¤¹</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸš€ çº¯å‰ç«¯ç¦»çº¿å±€åŸŸç½‘P2På¤§æ–‡ä»¶æ–­ç‚¹ä¼ è¾“ï¼šåˆ«è®©ä½ çš„ç…§ç‰‡å¢™å´©äº†]]></title>    <link>https://juejin.cn/post/7598402961904681012</link>    <guid>https://juejin.cn/post/7598402961904681012</guid>    <pubDate>2026-01-23T15:55:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598402961904681012" data-draft-id="7598433254127697960" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸš€ çº¯å‰ç«¯ç¦»çº¿å±€åŸŸç½‘P2På¤§æ–‡ä»¶æ–­ç‚¹ä¼ è¾“ï¼šåˆ«è®©ä½ çš„ç…§ç‰‡å¢™å´©äº†"/> <meta itemprop="keywords" content="å‰ç«¯,WebRTC,JavaScript"/> <meta itemprop="datePublished" content="2026-01-23T15:55:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å­å…®æ›°"/> <meta itemprop="url" content="https://juejin.cn/user/166781496080782"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸš€ çº¯å‰ç«¯ç¦»çº¿å±€åŸŸç½‘P2På¤§æ–‡ä»¶æ–­ç‚¹ä¼ è¾“ï¼šåˆ«è®©ä½ çš„ç…§ç‰‡å¢™å´©äº†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/166781496080782/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å­å…®æ›°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T15:55:09.000Z" title="Fri Jan 23 2026 15:55:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€ï¼šå°æ˜å’Œä»–çš„ç…§ç‰‡å¢™å±æœº</h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ˜¯å°æ˜ï¼Œä¸€ä¸ªçƒ­çˆ±æ‘„å½±çš„ç¨‹åºå‘˜ã€‚å‘¨æœ«å»çˆ¬å±±æ‹äº†ä¸€å †4Ké«˜æ¸…ç…§ç‰‡ï¼Œæ€»å…±3GBï¼Œå‡†å¤‡å‘ç»™è€å©†åˆ†äº«ã€‚å¾®ä¿¡ä¼ ï¼Ÿç®—äº†ï¼Œå‹ç¼©åç”»è´¨æ¸£å¾—åƒåƒç´ é£ã€‚ç½‘ç›˜ï¼Ÿç¦»çº¿çŠ¶æ€ä¸‹è¿ä¸ä¸Šã€‚è“ç‰™ï¼Ÿæ…¢å¾—åƒèœ—ç‰›åœ¨è·‘æ­¥ã€‚ä½ æ€¥å¾—å›¢å›¢è½¬ï¼Œçªç„¶çµæœºä¸€åŠ¨ï¼šç”¨ç”µè„‘ç›´æ¥ä¼ å•Šï¼å¯æ˜¯æ€ä¹ˆåœ¨æµè§ˆå™¨é‡Œå®ç°å±€åŸŸç½‘P2På¤§æ–‡ä»¶ä¼ è¾“ï¼Œè¿˜å¾—æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Ÿåˆ«æ€¥ï¼Œä»Šå¤©å’±ä»¬å°±èŠèŠè¿™ä¸ªæŠ€æœ¯æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-1">æŠ€æœ¯èƒŒæ™¯ï¼šP2Pä¸æ˜¯ä»€ä¹ˆæ–°é²œç©æ„å„¿</h2>
<p>P2Pï¼ˆç‚¹å¯¹ç‚¹ï¼‰ä¼ è¾“åœ¨å±€åŸŸç½‘é‡Œå…¶å®æŒºå¸¸è§çš„ï¼ŒBTä¸‹è½½å°±æ˜¯ç»å…¸æ¡ˆä¾‹ã€‚ä½†å’±ä»¬ä»Šå¤©èŠçš„æ˜¯çº¯å‰ç«¯å®ç°ï¼Œæ„æ€æ˜¯å®Œå…¨ä¸ç”¨åç«¯æœåŠ¡å™¨ï¼Œç”¨æˆ·Aç›´æ¥æŠŠæ–‡ä»¶ä¼ ç»™ç”¨æˆ·Bã€‚æ ¸å¿ƒæŠ€æœ¯æ˜¯WebRTCï¼ˆWeb Real-Time Communicationï¼‰ï¼Œè¿™è´§æœ¬æ¥æ˜¯ç”¨æ¥è§†é¢‘èŠå¤©çš„ï¼Œä½†å’±ä»¬å¯ä»¥æ‹¿æ¥ä¼ æ–‡ä»¶ã€‚</p>
<p>ä¸ºä»€ä¹ˆé€‰WebRTCï¼Ÿå› ä¸ºå®ƒæ”¯æŒæ•°æ®é€šé“ï¼ˆDataChannelï¼‰ï¼Œå¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨é—´å»ºç«‹è¿æ¥ã€‚åŠ ä¸ŠFile APIå’ŒBlobï¼Œå’±ä»¬å°±èƒ½æŠŠå¤§æ–‡ä»¶åˆ‡æˆå°å—ï¼Œè¾¹ä¼ è¾¹æ”¶ï¼Œæ–­ç‚¹ç»­ä¼ è‡ªç„¶å°±å‡ºæ¥äº†ã€‚</p>
<h2 data-id="heading-2">æ ¸å¿ƒå®ç°ï¼šåˆ†å—ä¼ è¾“ + æ–­ç‚¹ç»­ä¼ </h2>
<h3 data-id="heading-3">1. æ–‡ä»¶åˆ‡å—ï¼šå¤§è±¡å¡å†°ç®±ï¼Œå¾—å…ˆåˆ‡æˆå—</h3>
<p>æµè§ˆå™¨å¤„ç†å¤§æ–‡ä»¶æœ‰ä¸ªç¡¬ä¼¤ï¼šå†…å­˜é™åˆ¶ã€‚å¦‚æœç›´æ¥æŠŠ3GBæ–‡ä»¶è¯»è¿›å†…å­˜ï¼ŒChromeå¾—å“­çˆ¹å–Šå¨˜ã€‚æ‰€ä»¥å’±ä»¬ç”¨FileReaderåˆ†å—è¯»ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ–‡ä»¶åˆ†å—å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">chunkFile</span>(<span class="hljs-params">file, chunkSize = <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span></span>) { <span class="hljs-comment">// 1MBæ¯å—</span>
  <span class="hljs-keyword">const</span> chunks = [];
  <span class="hljs-keyword">let</span> offset = <span class="hljs-number">0</span>;
  
  <span class="hljs-keyword">while</span> (offset &lt; file.<span class="hljs-property">size</span>) {
    <span class="hljs-keyword">const</span> chunk = file.<span class="hljs-title function_">slice</span>(offset, offset + chunkSize);
    chunks.<span class="hljs-title function_">push</span>(chunk);
    offset += chunkSize;
  }
  
  <span class="hljs-keyword">return</span> chunks;
}
</code></pre>
<p>è¿™é‡Œç”¨<code>file.slice()</code>åˆ‡å—ï¼Œæ¯ä¸ªå—1MBã€‚ä¸ºä»€ä¹ˆè¦1MBï¼Ÿå¹³è¡¡ä¼ è¾“æ•ˆç‡å’Œå†…å­˜å ç”¨ï¼Œå¤ªå°ç½‘ç»œå¼€é”€å¤§ï¼Œå¤ªå¤§æµè§ˆå™¨å¡ã€‚</p>
<h3 data-id="heading-4">2. WebRTCè¿æ¥ï¼šå»ºç«‹åœ°ä¸‹é€šé“</h3>
<p>WebRTCè¿æ¥éœ€è¦ä¿¡ä»¤æœåŠ¡å™¨ï¼ˆç”¨æ¥äº¤æ¢è¿æ¥ä¿¡æ¯ï¼‰ï¼Œä½†å’±ä»¬æ˜¯ç¦»çº¿å±€åŸŸç½‘ï¼Œæ‰€ä»¥å¯ä»¥ç”¨WebSocketæˆ–è€…ç›´æ¥ç”¨æµè§ˆå™¨æœ¬åœ°å­˜å‚¨äº¤æ¢SDPï¼ˆä¼šè¯æè¿°åè®®ï¼‰ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ›å»ºRTCPeerConnection</span>
<span class="hljs-keyword">const</span> pc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RTCPeerConnection</span>({
  <span class="hljs-attr">iceServers</span>: [] <span class="hljs-comment">// å±€åŸŸç½‘ä¸éœ€è¦STUNæœåŠ¡å™¨</span>
});

<span class="hljs-comment">// åˆ›å»ºæ•°æ®é€šé“</span>
<span class="hljs-keyword">const</span> dataChannel = pc.<span class="hljs-title function_">createDataChannel</span>(<span class="hljs-string">'file-transfer'</span>);

<span class="hljs-comment">// ç›‘å¬è¿æ¥äº‹ä»¶</span>
dataChannel.<span class="hljs-property">onopen</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'é€šé“å¼€äº†ï¼Œå¯ä»¥ä¼ æ–‡ä»¶äº†'</span>);
dataChannel.<span class="hljs-property">onmessage</span> = handleMessage;
</code></pre>
<h3 data-id="heading-5">3. æ–­ç‚¹ç»­ä¼ ï¼šä»ä¸­æ–­å¤„ç»§ç»­</h3>
<p>æ–­ç‚¹ç»­ä¼ çš„å…³é”®æ˜¯è®°å½•å·²ä¼ å—çš„è¿›åº¦ã€‚ç”¨IndexedDBæˆ–è€…localStorageå­˜è¿›åº¦ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å‘é€æ–‡ä»¶å—</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendFileChunks</span>(<span class="hljs-params">file, dataChannel</span>) {
  <span class="hljs-keyword">const</span> chunks = <span class="hljs-title function_">chunkFile</span>(file);
  <span class="hljs-keyword">const</span> progress = <span class="hljs-title function_">loadProgress</span>(file.<span class="hljs-property">name</span>) || <span class="hljs-number">0</span>; <span class="hljs-comment">// ä»æœ¬åœ°åŠ è½½è¿›åº¦</span>
  
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = progress; i &lt; chunks.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">const</span> chunk = chunks[i];
    <span class="hljs-keyword">const</span> arrayBuffer = <span class="hljs-keyword">await</span> chunk.<span class="hljs-title function_">arrayBuffer</span>();
    
    <span class="hljs-comment">// å‘é€å—æ•°æ®ï¼Œå¸¦ä¸Šç´¢å¼•</span>
    dataChannel.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
      <span class="hljs-attr">type</span>: <span class="hljs-string">'chunk'</span>,
      <span class="hljs-attr">index</span>: i,
      <span class="hljs-attr">data</span>: arrayBuffer
    }));
    
    <span class="hljs-title function_">saveProgress</span>(file.<span class="hljs-property">name</span>, i + <span class="hljs-number">1</span>); <span class="hljs-comment">// ä¿å­˜è¿›åº¦</span>
  }
  
  <span class="hljs-comment">// å‘é€ç»“æŸä¿¡å·</span>
  dataChannel.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">'end'</span> }));
}
</code></pre>
<p>æ¥æ”¶ç«¯æ”¶åˆ°å—åï¼Œå…ˆå­˜åˆ°ä¸´æ—¶æ•°ç»„ï¼Œæ”¶åˆ°'end'ä¿¡å·å†åˆå¹¶æˆå®Œæ•´æ–‡ä»¶ã€‚</p>
<h2 data-id="heading-6">æµè§ˆå™¨é™åˆ¶ï¼šé‚£äº›å‘çˆ¹çš„ç°å®</h2>
<h3 data-id="heading-7">1. æ–‡ä»¶å¤§å°é™åˆ¶ï¼šChromeè¯´ä¸è¡Œå°±ä¸è¡Œ</h3>
<p>Chromeå¯¹å•ä¸ªæ–‡ä»¶ä¸Šä¼ æœ‰é™åˆ¶ï¼Œé»˜è®¤æ˜¯2GBã€‚æœ‰äº›ç‰ˆæœ¬ç”šè‡³æ›´ä½ã€‚é‡åˆ°å¤§æ–‡ä»¶æ€ä¹ˆåŠï¼Ÿç»§ç»­åˆ†å—ï¼Œä½†å—æ•°å¤ªå¤šä¼šå½±å“æ€§èƒ½ã€‚</p>
<p>è§£å†³æ–¹æ¡ˆï¼šç”¨File System Access APIï¼ˆChrome 86+ï¼‰ï¼Œå¯ä»¥ç›´æ¥æ“ä½œæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œç»•è¿‡å†…å­˜é™åˆ¶ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä½¿ç”¨File System Access API</span>
<span class="hljs-keyword">const</span> fileHandle = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">showOpenFilePicker</span>();
<span class="hljs-keyword">const</span> file = <span class="hljs-keyword">await</span> fileHandle.<span class="hljs-title function_">getFile</span>();
<span class="hljs-keyword">const</span> writableStream = <span class="hljs-keyword">await</span> fileHandle.<span class="hljs-title function_">createWritable</span>();

<span class="hljs-comment">// åˆ†å—å†™å…¥</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> chunk <span class="hljs-keyword">of</span> chunks) {
  <span class="hljs-keyword">await</span> writableStream.<span class="hljs-title function_">write</span>(chunk);
}
<span class="hljs-keyword">await</span> writableStream.<span class="hljs-title function_">close</span>();
</code></pre>
<h3 data-id="heading-8">2. å†…å­˜æ³„æ¼ï¼šä¼ ç€ä¼ ç€æµè§ˆå™¨å´©äº†</h3>
<p>å¤§æ–‡ä»¶ä¼ è¾“æ—¶ï¼Œå¦‚æœä¸åŠæ—¶é‡Šæ”¾Blobå¯¹è±¡ï¼Œå†…å­˜ä¼šçˆ†ã€‚è§£å†³æ–¹æ¡ˆï¼šç”¨stream APIè¾¹è¯»è¾¹ä¼ ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç”¨ReadableStreamå¤„ç†å¤§æ–‡ä»¶</span>
<span class="hljs-keyword">const</span> stream = file.<span class="hljs-title function_">stream</span>();
<span class="hljs-keyword">const</span> reader = stream.<span class="hljs-title function_">getReader</span>();

<span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
  <span class="hljs-keyword">const</span> { done, value } = <span class="hljs-keyword">await</span> reader.<span class="hljs-title function_">read</span>();
  <span class="hljs-keyword">if</span> (done) <span class="hljs-keyword">break</span>;
  
  <span class="hljs-comment">// ç›´æ¥å‘é€valueï¼ˆUint8Arrayï¼‰</span>
  dataChannel.<span class="hljs-title function_">send</span>(value);
}
</code></pre>
<h3 data-id="heading-9">3. ç½‘ç»œé™åˆ¶ï¼šå±€åŸŸç½‘é˜²ç«å¢™æŒ¡é“</h3>
<p>å…¬å¸å±€åŸŸç½‘å¯èƒ½æœ‰é˜²ç«å¢™ï¼ŒWebRTCçš„UDPè¿æ¥ä¼šè¢«æŒ¡ã€‚è§£å†³æ–¹æ¡ˆï¼šé™çº§åˆ°WebSocketï¼Œæˆ–è€…ç”¨TURNæœåŠ¡å™¨ä¸­è½¬ï¼ˆä½†è¿™å°±ä¸çº¯å‰ç«¯äº†ï¼‰ã€‚</p>
<h2 data-id="heading-10">å®æˆ˜æ¡ˆä¾‹ï¼šä¸‰ä¸ªçœŸå®åœºæ™¯</h2>
<h3 data-id="heading-11">æ¡ˆä¾‹1ï¼šç…§ç‰‡åˆ†äº«åº”ç”¨</h3>
<p>æˆ‘ä¹‹å‰åšçš„ä¸€ä¸ªå®¶åº­ç›¸å†ŒAppï¼Œç”¨è¿™ä¸ªæŠ€æœ¯å®ç°äº†å±€åŸŸç½‘ç…§ç‰‡åŒæ­¥ã€‚å¦ˆå¦ˆåœ¨å®¢å…ç”µè„‘ä¸Šä¼ ç›¸å†Œï¼Œçˆ¸çˆ¸åœ¨å§å®¤å°±èƒ½ç›´æ¥æ”¶åˆ°ï¼Œä¸ç”¨è¿è·¯ç”±å™¨ã€‚</p>
<p>å…³é”®ä»£ç ï¼šè¿›åº¦æ¡æ˜¾ç¤º + é”™è¯¯é‡è¯•</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¿›åº¦æ˜¾ç¤º</span>
dataChannel.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> message = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);
  <span class="hljs-keyword">if</span> (message.<span class="hljs-property">type</span> === <span class="hljs-string">'progress'</span>) {
    <span class="hljs-title function_">updateProgressBar</span>(message.<span class="hljs-property">percent</span>);
  }
};
</code></pre>
<h3 data-id="heading-12">æ¡ˆä¾‹2ï¼šæ¸¸æˆå­˜æ¡£åŒæ­¥</h3>
<p>åšæ¸¸æˆå¼€å‘æ—¶ï¼Œå›¢é˜Ÿæˆå‘˜åœ¨å±€åŸŸç½‘åŒæ­¥å¤§å­˜æ¡£æ–‡ä»¶ï¼ˆå‡ GBï¼‰ã€‚ç”¨æ–­ç‚¹ç»­ä¼ ï¼Œç½‘ç»œæ–­äº†é‡è¿åä»æ–­ç‚¹ç»§ç»­ï¼Œçœå»äº†é‡ä¼ çš„æ—¶é—´ã€‚</p>
<h3 data-id="heading-13">æ¡ˆä¾‹3ï¼šè§†é¢‘å‰ªè¾‘ç´ æä¼ è¾“</h3>
<p>å‰ªè¾‘å¸ˆåœ¨å±€åŸŸç½‘ä¼ 4Kè§†é¢‘ç´ æã€‚ä¼ ç»Ÿæ–¹æ³•ç”¨Uç›˜æ…¢ï¼Œç”¨è¿™ä¸ªæ–¹æ¡ˆç›´æ¥æµè§ˆå™¨ä¼ ï¼Œè¿˜èƒ½æ˜¾ç¤ºä¼ è¾“é€Ÿåº¦å’Œå‰©ä½™æ—¶é—´ã€‚</p>
<h2 data-id="heading-14">å…¶ä»–æ–¹æ¡ˆï¼šå½“WebRTCä¸å¤Ÿç”¨æ—¶</h2>
<h3 data-id="heading-15">æ–¹æ¡ˆ1ï¼šWebTorrent</h3>
<p>åŸºäºWebRTCçš„BitTorrentå®ç°ï¼Œæ”¯æŒå¤šå¯¹å¤šä¼ è¾“ï¼Œæ›´é€‚åˆå¤§æ–‡ä»¶ç¾¤å‘ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">WebTorrent</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'webtorrent'</span>;

<span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebTorrent</span>();
client.<span class="hljs-title function_">seed</span>(file, <span class="hljs-function">(<span class="hljs-params">torrent</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç§å­åˆ›å»ºæˆåŠŸ:'</span>, torrent.<span class="hljs-property">magnetURI</span>);
});
</code></pre>
<p>ä¼˜ç‚¹ï¼šå¤šäººåŒæ—¶ä¸‹è½½å¿«ã€‚ç¼ºç‚¹ï¼šéœ€è¦ç§å­æ–‡ä»¶ç®¡ç†ã€‚</p>
<h3 data-id="heading-16">æ–¹æ¡ˆ2ï¼šSocket.IO + äºŒè¿›åˆ¶ä¼ è¾“</h3>
<p>ç”¨WebSocketä¼ äºŒè¿›åˆ¶æ•°æ®ï¼Œé…åˆsocket.ioå®ç°æ–­ç‚¹ç»­ä¼ ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>();
socket.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'send-file-chunk'</span>, { chunk, index });

socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">'chunk-received'</span>, <span class="hljs-function">(<span class="hljs-params">index</span>) =&gt;</span> {
  <span class="hljs-comment">// ç»§ç»­å‘ä¸‹ä¸€å—</span>
});
</code></pre>
<p>ä¼˜ç‚¹ï¼šå…¼å®¹æ€§å¥½ã€‚ç¼ºç‚¹ï¼šéœ€è¦æœåŠ¡å™¨ä¸­è½¬ã€‚</p>
<h3 data-id="heading-17">æ–¹æ¡ˆ3ï¼šElectronåº”ç”¨</h3>
<p>å¦‚æœçº¯æµè§ˆå™¨é™åˆ¶å¤ªå¤šï¼Œå¯ä»¥åšä¸ªElectronæ¡Œé¢åº”ç”¨ï¼Œç”¨Node.jsçš„fsæ¨¡å—ç›´æ¥æ“ä½œæ–‡ä»¶ç³»ç»Ÿï¼Œç»“åˆWebRTCã€‚</p>
<h2 data-id="heading-18">æ€»ç»“ä¸å±•æœ›</h2>
<p>çº¯å‰ç«¯P2På¤§æ–‡ä»¶æ–­ç‚¹ä¼ è¾“ï¼Œå¬èµ·æ¥é«˜å¤§ä¸Šï¼Œå…¶å®å°±æ˜¯æŠŠæ–‡ä»¶åˆ‡å— + WebRTCä¼ æ•°æ® + æœ¬åœ°å­˜å‚¨è¿›åº¦ã€‚æµè§ˆå™¨é™åˆ¶æ˜¯å®¢è§‚å­˜åœ¨çš„ï¼Œä½†é€šè¿‡File System APIå’Œå†…å­˜ç®¡ç†ï¼Œå¤§éƒ¨åˆ†åœºæ™¯éƒ½èƒ½æå®šã€‚</p>
<p>æœªæ¥ï¼Œéšç€WebTransportåè®®çš„æ™®åŠï¼ˆåŸºäºHTTP/3ï¼‰ï¼Œä¼ è¾“æ•ˆç‡ä¼šæ›´é«˜ã€‚5Gå’ŒWiFi 6æ™®åŠåï¼Œå±€åŸŸç½‘ä¼ è¾“é€Ÿåº¦ä¼šé£èµ·ã€‚</p>
<p>ä¸‹æ¬¡è€å©†è®©ä½ ä¼ ç…§ç‰‡ï¼Œåˆ«å†æŠ±æ€¨ç½‘é€Ÿäº†ï¼Œç›´æ¥ç”¨æµè§ˆå™¨P2Pä¼ å§ï¼æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œè¯„è®ºåŒºè§ã€‚ğŸš€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ„å»ºåˆ†å¸ƒå¼åº”ç”¨ï¼ŸAkamai å’Œ Fermyon æ­£åœ¨æ”¹å˜æ¸¸æˆè§„åˆ™]]></title>    <link>https://juejin.cn/post/7598389448146239498</link>    <guid>https://juejin.cn/post/7598389448146239498</guid>    <pubDate>2026-01-23T14:23:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598389448146239498" data-draft-id="7598362826110828594" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ„å»ºåˆ†å¸ƒå¼åº”ç”¨ï¼ŸAkamai å’Œ Fermyon æ­£åœ¨æ”¹å˜æ¸¸æˆè§„åˆ™"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,äº‘è®¡ç®—"/> <meta itemprop="datePublished" content="2026-01-23T14:23:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AKAMAI"/> <meta itemprop="url" content="https://juejin.cn/user/829502942352628"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ„å»ºåˆ†å¸ƒå¼åº”ç”¨ï¼ŸAkamai å’Œ Fermyon æ­£åœ¨æ”¹å˜æ¸¸æˆè§„åˆ™
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/829502942352628/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AKAMAI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T14:23:12.000Z" title="Fri Jan 23 2026 14:23:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ·±è€•ä¼ä¸šæŠ€æœ¯é¢†åŸŸå¤šå¹´ï¼Œä½¿æˆ‘è¶³ä»¥è¯†åˆ«é‚£äº›æ ¹æœ¬æ€§çš„å˜é©æ—¶åˆ»ã€‚ä»Šå¤©Akamaiæ”¶è´­Fermyonçš„æ¶ˆæ¯ï¼Œæ­£æ˜¯è¿™æ ·ä¸€ä¸ªå†å²æ€§èŠ‚ç‚¹ã€‚è¿™ä»£è¡¨ç€å¤šé¡¹å…³é”®æŠ€æœ¯çš„æ·±åº¦èåˆâ€”â€”è½»é‡çº§WebAssembly (Wasm)å‡½æ•°åœ¨è¾¹ç¼˜å¤„ç†è¯·æ±‚ï¼Œéœ€è¦æ—¶å¯æ™ºèƒ½è·¯ç”±è‡³GPUåŠ é€Ÿæ¨ç†ï¼Œè€Œè¿™ä¸€åˆ‡éƒ½é›†æˆåœ¨åŒä¸€ä¸ªå¹³å°å†…ã€‚</p>
<p>è®©æˆ‘è§£é‡Šä¸€ä¸‹ï¼Œä¸ºä½•è¿™ä¸€è¿›å±•å¯¹æ‰€æœ‰åˆ†å¸ƒå¼åº”ç”¨æ„å»ºè€…éƒ½è‡³å…³é‡è¦ã€‚</p>
<hr/>
<p>å¦‚æ‚¨æ‰€åœ¨çš„ä¼ä¸šä¹Ÿåœ¨è€ƒè™‘é‡‡è´­äº‘æœåŠ¡æˆ–è¿›è¡Œäº‘è¿ç§»ï¼Œ</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.akamai.com%2Fzh%2Flp%2Fakamai-cloud-computing-freetrial%3Futm_campaign%3Df-mc-65893%26utm_id%3Dapj_cc%26utm_source%3Djuejin%26utm_medium%3Darticle_advertorial%26utm_content%3Djuejin_260123_blogarticles245" target="_blank" title="https://www.akamai.com/zh/lp/akamai-cloud-computing-freetrial?utm_campaign=f-mc-65893&amp;utm_id=apj_cc&amp;utm_source=juejin&amp;utm_medium=article_advertorial&amp;utm_content=juejin_260123_blogarticles245" ref="nofollow noopener noreferrer">ç‚¹å‡»é“¾æ¥</a>äº†è§£Akamai Linodeè§£å†³æ–¹æ¡ˆï¼Œç°åœ¨ç”³è¯·è¯•ç”¨å¯å¾—é«˜è¾¾5000ç¾å…ƒä¸“å±é¢åº¦</p>
<hr/>
<p><strong><strong>æ‰“é€ æœªæ¥çš„å›¢é˜Ÿ</strong></strong></p>
<p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬èšç„¦äºèƒŒåçš„äººæ‰ã€‚Fermyonå›¢é˜Ÿä¸ä»…æ˜¯Wasmçš„å€¡å¯¼è€…ï¼Œæ›´æ˜¯å°†å…¶çœŸæ­£è½åœ°åˆ°ç”Ÿäº§ç¯å¢ƒçš„æ„å»ºè€…ã€‚Matt Butcherã€Radu MateiåŠå…¶å›¢é˜Ÿï¼Œå°†Wasmä»ä¸€é¡¹â€œæœ‰è¶£çš„æµè§ˆå™¨æŠ€æœ¯â€å‘å±•ä¸ºâ€œæ— æœåŠ¡å™¨è®¡ç®—çš„æœªæ¥â€ã€‚ä»–ä»¬ä¸ä»…æ„æ€å¹¶æ‰“é€ äº†Spinæ¡†æ¶ï¼Œæ›´å›´ç»•å…¶åŸ¹è‚²èµ·æ´»è·ƒçš„å¼€å‘è€…ç¤¾åŒºï¼Œæœ€ç»ˆå®ç°äº†è¯¥æŠ€æœ¯çš„å¤§è§„æ¨¡ç”Ÿäº§çº§åº”ç”¨ã€‚</p>
<p>åƒ Helm è¿™æ ·çš„è‘—åé¡¹ç›®ï¼Œæœ€åˆæ˜¯ Matt Butcher å’Œä»–åœ¨ Deis çš„åŒäº‹åœ¨ 2015 å¹´ä¸€æ¬¡é»‘å®¢é©¬æ‹‰æ¾ä¸Šä¸ºç®¡ç† Kubernetes éƒ¨ç½²è€Œåˆ›å»ºçš„é¡¹ç›®ï¼Œå¦‚ä»Šå·²æˆä¸ºäº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼šçš„é¡¶çº§é¡¹ç›®ã€‚</p>
<p>æ­£æ˜¯è¿™æ”¯å›¢é˜Ÿï¼Œåœ¨Kuberneteså¼•é¢†å¾®æœåŠ¡æ½®æµä¹‹å‰ï¼Œå°±å·²æ´å¯Ÿå…¶è¶‹åŠ¿ã€‚ä»–ä»¬å±¡æ¬¡å±•ç°å‡ºå¯¹åŸºç¡€è®¾æ–½æ¼”è¿›çš„å‰ç»æ€§è§†é‡ï¼Œå…¶ç²¾å‡†é¢„åˆ¤ï¼Œå¾€å¾€é¢†å…ˆè¡Œä¸šä¸‰åˆ°äº”å¹´ã€‚</p>
<p><strong><strong>ä¸ºä»€ä¹ˆ WebAssembly + è¾¹ç¼˜ = ä¸‹ä¸€æ¬¡æ¼”è¿›</strong></strong></p>
<p>æ¢è¨€ä¹‹ï¼Œæœ€å¿«çš„æ— æœåŠ¡å™¨ Wasm è¿è¡Œæ—¶ + åˆ†å¸ƒæœ€å¹¿çš„äº‘å¹³å° = æ›´å¿«éƒ¨ç½²ã€å³æ—¶æ‰©å±•çš„æ›´æ™ºèƒ½åº”ç”¨ã€‚å½“ç„¶ï¼Œè¿™è¯´æ³•ä¸å¦‚å‰è€…ç²¾ç‚¼ã€‚</p>
<p>Wasm ä¸å†ä»…ä»…å…³ä¹åœ¨æµè§ˆå™¨ä¸­è¿è¡Œä»£ç ï¼Œè€Œæ˜¯æä¾›æ¥è¿‘åŸç”Ÿçš„æ€§èƒ½ï¼Œå¹¶å…·æœ‰çœŸæ­£çš„å¯ç§»æ¤æ€§â€”â€”è¿™æ¬¡ï¼Œ"ä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„è¿è¡Œ"çœŸæ­£å®ç°äº†ã€‚æ— éœ€åˆ†å‘å®¹å™¨ï¼Œæ— éœ€è¿è¡Œæ—¶ä¾èµ–ï¼Œåªæœ‰å¾®ç§’çº§æ‰§è¡Œçš„ç¼–è¯‘ä»£ç ã€‚ä½ çš„åº”ç”¨æ€§èƒ½è¾¾åˆ°æœ€ä¼˜ï¼Œå¹¶ä¸”ä½ å¯ä»¥æ›´å¿«å®ç°äº¤ä»˜ã€‚</p>
<p>Akamai EdgeWorkers ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿåœ¨è¾¹ç¼˜éƒ¨ç½² JavaScript å‡½æ•°ï¼Œè€Œ Fermyon å°†å…¶æå‡åˆ°äº†æ–°çš„æ°´å¹³ã€‚å¯ä»¥çœ‹ä½œæ˜¯ä»äº‹åŠ¡å¤„ç†å‡çº§åˆ°å®Œæ•´çš„è¾¹ç¼˜åº”ç”¨ã€‚</p>
<p>è¿™ä¸å†æ˜¯è¿è¡Œå­¤ç«‹åŠŸèƒ½ï¼Œè€Œæ˜¯éƒ¨ç½²å®Œæ•´çš„ã€æœ‰çŠ¶æ€çš„åº”ç”¨ç¨‹åºã€‚ä½ è·å¾—äº†å¤æ‚çš„è·¯ç”±ã€ä¸­é—´ä»¶å’ŒæœåŠ¡ç»„åˆèƒ½åŠ›ï¼Œä¸”å¯åŠ¨é€Ÿåº¦ä¾ç„¶è¿…æ·ã€‚è¿™ä½¿ä½ èƒ½å¤Ÿæ„å»ºå¤æ‚ã€å¤šç»„ä»¶çš„ç³»ç»Ÿï¼Œè®©åº”ç”¨åœ¨å˜å¾—æ›´å¥å£®ï¼ˆæ›´æ™ºèƒ½ï¼‰çš„åŒæ—¶ï¼Œæ€§èƒ½ä¸æ¯«ä¸å‡ã€‚</p>
<p>Fermyon çš„ Spin æ¡†æ¶ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿç”¨ Wasm ç»„ä»¶æ„å»ºæ•´ä¸ªåº”ç”¨ç¨‹åºï¼Œæ¯ä¸ªç»„ä»¶å¯èƒ½ç”¨ä¸åŒçš„è¯­è¨€ç¼–å†™ï¼Œä½†éƒ½èƒ½æ— ç¼åä½œã€‚è¿™ä½¿å¾—æ— æœåŠ¡å™¨å‡½æ•°å¯ä»¥æ‰©å±•ä¸ºå¯ç§»æ¤çš„æ— æœåŠ¡å™¨åº”ç”¨ç¨‹åºï¼Œå¹¶å†…ç½®é”®å€¼å­˜å‚¨ã€SQL æ•°æ®åº“å’Œ AI æ¨ç†èƒ½åŠ›ã€‚çœŸæ­£çš„å¤šäº‘æˆä¸ºå¯èƒ½ã€‚</p>
<p>å†ç»“åˆ Akamai çš„åŸºç¡€è®¾æ–½ï¼Œæˆ‘ä»¬ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿå°†è®¡ç®—åˆ†å¸ƒåˆ°å…¨çƒè¶…è¿‡ 4,400 ä¸ªåœ°ç‚¹ã€‚å½“ä½ åœ¨æˆ‘ä»¬çš„å¹³å°ä¸Šéƒ¨ç½² Wasm æ¨¡å—æ—¶ï¼Œæ— è®ºç”¨æˆ·èº«å¤„ä½•åœ°ï¼Œéƒ½èƒ½è·å¾—ä½äº 10 æ¯«ç§’çš„å“åº”æ—¶é—´ã€‚æ‹¥æœ‰æ‰€æœ‰çš„æ‰©å±•èƒ½åŠ›ï¼Œå´æ²¡æœ‰éšä¹‹è€Œæ¥çš„å¤æ‚æ€§ã€‚</p>
<p>Fermyon æ„å»ºäº†æœ€å¿«çš„æ— æœåŠ¡å™¨ Wasm è¿è¡Œæ—¶ã€‚Akamai è¿è¥ç€åˆ†å¸ƒæœ€å¹¿çš„äº‘å¹³å°ã€‚æˆ‘ä»¬æºæ‰‹åˆä½œï¼ŒåŠ é€Ÿå®ç°ä»·å€¼çš„æ—¶é—´ï¼ŒåŒæ—¶ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿå¤§è§„æ¨¡æ„å»ºæ›´æ™ºèƒ½çš„åº”ç”¨ç¨‹åºã€‚</p>
<p><strong><strong>åˆ†å¸ƒå¼ AI åº”ç”¨ï¼šä»æ„¿æ™¯åˆ°ç°å®</strong></strong></p>
<p>AI çš„æœªæ¥åœ¨äºè®©å¼ºå¤§çš„æ™ºèƒ½æ— å¤„ä¸åœ¨ã€‚WebAssembly æ˜¯å®ç°è¿™ä¸€ç‚¹çš„å…³é”®ã€‚</p>
<p>å€ŸåŠ© Wasmï¼Œå¼€å‘äººå‘˜å¯ä»¥æ¯”ä»¥å¾€æ›´å¿«åœ°åˆ›å»ºåˆ†å¸ƒå¼ AI é©±åŠ¨çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”æœ‰ä¿¡å¿ƒå› ä¸º Akamai çš„ç½‘ç»œï¼Œè¿™äº›åº”ç”¨èƒ½ä¸ºæ›´å¤šåœ°åŒºã€æ›´å¤šç”¨æˆ·æ›´å¿«åœ°è¿è¡Œã€‚ä½ çš„ AI æ¨¡å‹ç¼–è¯‘ä¸º Wasmï¼Œå‡ ç§’å†…å³å¯å…¨çƒéƒ¨ç½²ï¼Œæ— è®ºä½ çš„ç”¨æˆ·èº«å¤„ä¸œäº¬ã€åœ£ä¿ç½—è¿˜æ˜¯æ–¯å¾·å“¥å°”æ‘©ï¼Œéƒ½èƒ½ä»¥ç¨³å®šçš„äºšç§’çº§å“åº”æ—¶é—´æ‰§è¡Œã€‚</p>
<p>è¿™å»¶ç»­äº† Akamai åœ¨å®ç°ä»æ ¸å¿ƒåˆ°è¾¹ç¼˜è®¡ç®—èµ„æºè¿ç»­ç»Ÿä¸€ä½“æ–¹é¢çš„åŠªåŠ›ã€‚ç»§æˆ‘ä»¬å‘å¸ƒÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.akamai.com%2Fzh%2Fproducts%2Fakamai-inference-cloud-platform%3Futm_campaign%3Df-mc-65893%26utm_id%3Dapj_cc%26utm_source%3Djuejin%26utm_medium%3Darticle_advertorial%26utm_content%3Djuejing_260123_external1_blogarticles245" target="_blank" title="https://www.akamai.com/zh/products/akamai-inference-cloud-platform?utm_campaign=f-mc-65893&amp;utm_id=apj_cc&amp;utm_source=juejin&amp;utm_medium=article_advertorial&amp;utm_content=juejing_260123_external1_blogarticles245" ref="nofollow noopener noreferrer">Akamai Inference Cloud</a>ä¹‹åï¼Œå°†è¿è¡Œåœ¨ Akamai ä¸Šçš„ Wasm å‡½æ•°èƒ½åŠ›ä¸ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.akamai.com%2Fzh%2Fproducts%2Fgpu%2Fnvidia%3Futm_campaign%3Df-mc-65893%26utm_id%3Dapj_cc%26utm_source%3Djuejin%26utm_medium%3Darticle_advertorial%26utm_content%3Djuejing_260123_external2_blogarticles245" target="_blank" title="https://www.akamai.com/zh/products/gpu/nvidia?utm_campaign=f-mc-65893&amp;utm_id=apj_cc&amp;utm_source=juejin&amp;utm_medium=article_advertorial&amp;utm_content=juejing_260123_external2_blogarticles245" ref="nofollow noopener noreferrer">NVIDIA Blackwell GPU åŸºç¡€è®¾æ–½</a>ç›¸ç»“åˆï¼Œä¸ºå¼€å‘äººå‘˜åˆ›é€ äº†é‡Šæ”¾æ–°èƒ½åŠ›çš„æœºä¼šã€‚</p>
<p>å½“è½»é‡çº§çš„ Wasm å‡½æ•°åœ¨è¾¹ç¼˜å¤„ç†è¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨éœ€è¦æ—¶æ™ºèƒ½åœ°å°†å®ƒä»¬è·¯ç”±åˆ° GPU åŠ é€Ÿçš„æ¨ç†ï¼Œæ‰€æœ‰æ“ä½œéƒ½åœ¨åŒä¸€å¹³å°å†…å®Œæˆã€‚ä½ å°†è·å¾—è¾¹ç¼˜è®¡ç®—çš„ç»æµæ€§å’Œ GPU åŠ é€Ÿçš„å¼ºå¤§èƒ½åŠ›ï¼Œå¹¶ç”±å¹³å°æ— ç¼ç¼–æ’ã€‚</p>
<p>å¼€å‘äººå‘˜å°†ä¸å†éœ€è¦åœ¨é€Ÿåº¦ä¸æ™ºèƒ½ä¹‹é—´åšå‡ºé€‰æ‹©ï¼›ä»–ä»¬å°†ä¸¤è€…å…¼å¾—ã€‚Wasm å‡½æ•°å¯ä»¥åœ¨è¾¹ç¼˜ä»¥å¾®ç§’çº§é€Ÿåº¦å¤„ç†è¯·æ±‚ï¼Œä»…åœ¨å¿…è¦æ—¶è°ƒç”¨è¿è¡Œåœ¨æˆ‘ä»¬ GPU åŸºç¡€è®¾æ–½ä¸Šçš„æ›´æ·±åº¦ AI æ¨¡å‹ã€‚è¿™æ˜¯ä¸ºæ™ºèƒ½åº”ç”¨è®¾è®¡çš„æ™ºèƒ½è·¯ç”±ã€‚</p>
<p><strong><strong>å¼€æºä¸æ˜¯å¯é€‰é¡¹â€”â€”è€Œæ˜¯æˆ˜ç•¥</strong></strong></p>
<p>æˆ‘ä»¬å¯¹å¼€æºçš„æ‰¿è¯ºä¸ä¼šæ”¹å˜ã€‚Spin å°†ä¼šä¸€ç›´ä¿æŒå¼€æºã€‚SpinKube ç»§ç»­ä½œä¸º CNCF é¡¹ç›®æ¨è¿›ã€‚å¼€å‘è€…çš„ä¿¡ä»»æ˜¯é€šè¿‡è¡ŒåŠ¨ã€æ”¯æŒå’Œä»£ç æäº¤èµ¢å¾—çš„ã€‚Fermyon æ·±è°™æ­¤é“ã€‚ä»–ä»¬æ²¡æœ‰æ„å»ºä¸€ä¸ªä¸“æœ‰å¹³å°å¹¶è¯•å›¾é”å®šå¼€å‘è€…ã€‚ä»–ä»¬æ„å»ºäº†å¼€æºå·¥å…·ï¼Œè®©å¼€å‘è€…è‡ªç”±é€‰æ‹©ã€‚</p>
<p>Akamai å°†ç»§ç»­ç§‰æ‰¿è¿™ä¸€ç†å¿µã€‚ä½ æƒ³åœ¨è‡ªå·±çš„åŸºç¡€è®¾æ–½ä¸Šè¿è¡Œ Spinï¼Ÿå¾ˆå¥½ã€‚åœ¨å¦ä¸€æœµäº‘ä¸Šè¿è¡Œï¼Ÿæ²¡é—®é¢˜ã€‚æˆ‘ä»¬çš„ç›®æ ‡ä¸æ˜¯å›°ä½å¼€å‘è€…â€”â€”è€Œæ˜¯æ‰“é€ æœ€å¥½çš„å¹³å°ï¼Œè®©ä»–ä»¬é€‰æ‹©ç•™ä¸‹ã€‚</p>
<p><strong><strong>è¿™å¯¹å¼€å‘è€…å½“å‰æ„å‘³ç€ä»€ä¹ˆ</strong></strong></p>
<p>å³æ—¥å¼€å§‹ï¼Œå¦‚æœä½ æ­£åœ¨æ„å»ºåˆ†å¸ƒå¼åº”ç”¨ï¼Œä½ æœ‰äº†æ–°çš„é€‰æ‹©ã€‚</p>
<ul>
<li>ç”¨ Rustã€Goã€JavaScriptã€Python æˆ–ä»»ä½•èƒ½ç¼–è¯‘ä¸º Wasm çš„è¯­è¨€ç¼–å†™ä½ çš„ä»£ç ã€‚</li>
<li>åœ¨å‡ ç§’å†…ï¼ˆè€Œä¸æ˜¯å‡ å°æ—¶å†…ï¼‰å°†å…¶éƒ¨ç½²åˆ°å…¨çƒã€‚</li>
<li>ä»é›¶æ‰©å±•åˆ°æ•°ç™¾ä¸‡è¯·æ±‚ï¼Œè€Œæ— éœ€è€ƒè™‘åŸºç¡€è®¾æ–½ã€‚</li>
<li>ä»…æŒ‰æ¯«ç§’è®¡è´¹ï¼Œä¸ºä½ å®é™…ä½¿ç”¨çš„èµ„æºä»˜è´¹ã€‚</li>
</ul>
<p>ä½†æ›´é‡è¦çš„æ˜¯ï¼Œä½ å¹¶éåœ¨æŠ¼æ³¨äºä¸“æœ‰æŠ€æœ¯ã€‚æ¯ä¸ªç»„ä»¶â€”â€”ä» Spin CLI åˆ°éƒ¨ç½²å¹³å°â€”â€”éƒ½æœ‰å¼€æºåŸºç¡€ã€‚ä½ çš„ä»£ç ä¸ä¼šè¢«é”å®šåœ¨æˆ‘ä»¬çš„å¹³å°ä¸Šï¼Œå®ƒåœ¨è®¾è®¡ä¸Šå°±æ˜¯å¯ç§»æ¤çš„ã€‚</p>
<p><strong><strong>æ›´å¤§çš„å›¾æ™¯</strong></strong></p>
<p>ç½‘ç»œæ­£åœ¨ä»é›†ä¸­å¼çš„äº‘æ¼”å˜ä¸ºåˆ†å¸ƒå¼çš„è¾¹ç¼˜ã€‚ä¸æ˜¯å› ä¸ºæ½®æµå¦‚æ­¤ï¼Œè€Œæ˜¯ç‰©ç†è§„å¾‹ä½¿ç„¶ã€‚ä½ æ— æ³•ä»å•ä¸€åŒºåŸŸä¸ºå…¨çƒå—ä¼—æä¾›æœåŠ¡å¹¶æœŸæœ›è·å¾—ä½äº 100 æ¯«ç§’çš„å»¶è¿Ÿã€‚ä½ æ— æ³•åœ¨å¼—å‰å°¼äºšå·ä¸ºæ–°åŠ å¡çš„ç”¨æˆ·è¿è¡Œ AI æ¨ç†å¹¶ç§°ä¹‹ä¸º"å®æ—¶"ã€‚</p>
<p>WebAssembly åŠ è¾¹ç¼˜è®¡ç®—è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚å¯¹äºéœ€è¦å³æ—¶ã€é«˜æ•ˆåœ°å…¨çƒè¿è¡Œçš„å·¥ä½œè´Ÿè½½è€Œè¨€ï¼Œå®ƒæ˜¯åˆé€‚çš„å·¥å…·ã€‚</p>
<p>Fermyon æ„å»ºäº†å¼•æ“ã€‚Akamai æä¾›äº†å…¨çƒåŸºç¡€è®¾æ–½ã€‚æˆ‘ä»¬æºæ‰‹åˆä½œï¼Œè®©éƒ¨ç½²è¾¹ç¼˜åŸç”Ÿåº”ç”¨å˜å¾—åƒæ¨é€åˆ° GitHub ä¸€æ ·ç®€å•ã€‚</p>
<p>Web åº”ç”¨çš„æœªæ¥æ„å‘³ç€è®¡ç®—æ— å¤„ä¸åœ¨ã€‚è€Œé€šè¿‡æ­¤æ¬¡æ”¶è´­ï¼Œ"æ— å¤„ä¸åœ¨"å˜å¾—æ›´åŠ è§¦æ‰‹å¯åŠã€‚</p>
<p>æ¬¢è¿åŠ å…¥ Akamaiï¼ŒFermyon å›¢é˜Ÿã€‚è®©æˆ‘ä»¬æºæ‰‹åˆ›é€ éå‡¡ã€‚</p>
<p>æƒ³äº²è‡ªå°è¯•å—ï¼ŸæŸ¥çœ‹ Spinï¼Œäº²èº«ä½“éªŒè¾¹ç¼˜ Wasm çš„å®é™…æ„Ÿå—ã€‚æˆ–è€…ç›´æ¥è”ç³»æˆ‘ä»¬â€”â€”æˆ‘å¾ˆä¹æ„äº†è§£ä½ ä»¬æ­£åœ¨æ„å»ºçš„ä¸œè¥¿ã€‚</p>
<hr/>
<p>å¦‚æ‚¨æ‰€åœ¨çš„ä¼ä¸šä¹Ÿåœ¨è€ƒè™‘é‡‡è´­äº‘æœåŠ¡æˆ–è¿›è¡Œäº‘è¿ç§»ï¼Œ</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.akamai.com%2Fzh%2Flp%2Fakamai-cloud-computing-freetrial%3Futm_campaign%3Df-mc-65893%26utm_id%3Dapj_cc%26utm_source%3Djuejin%26utm_medium%3Darticle_advertorial%26utm_content%3Djuejin_260123_blogarticles245_end" target="_blank" title="https://www.akamai.com/zh/lp/akamai-cloud-computing-freetrial?utm_campaign=f-mc-65893&amp;utm_id=apj_cc&amp;utm_source=juejin&amp;utm_medium=article_advertorial&amp;utm_content=juejin_260123_blogarticles245_end" ref="nofollow noopener noreferrer">ç‚¹å‡»é“¾æ¥</a>äº†è§£Akamai Linodeè§£å†³æ–¹æ¡ˆï¼Œç°åœ¨ç”³è¯·è¯•ç”¨å¯å¾—é«˜è¾¾5000ç¾å…ƒä¸“å±é¢åº¦</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[CSSé­”æ³•:å¯¹è¯ç”Ÿæˆå™¨ä¸å¥”é©°éªé©¬çš„åˆ›æ„å®ç°]]></title>    <link>https://juejin.cn/post/7598382710294904832</link>    <guid>https://juejin.cn/post/7598382710294904832</guid>    <pubDate>2026-01-23T14:30:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598382710294904832" data-draft-id="7598403436698746914" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="CSSé­”æ³•:å¯¹è¯ç”Ÿæˆå™¨ä¸å¥”é©°éªé©¬çš„åˆ›æ„å®ç°"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-23T14:30:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¿®å·±xj"/> <meta itemprop="url" content="https://juejin.cn/user/2641475936724142"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            CSSé­”æ³•:å¯¹è¯ç”Ÿæˆå™¨ä¸å¥”é©°éªé©¬çš„åˆ›æ„å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2641475936724142/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¿®å·±xj
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T14:30:00.000Z" title="Fri Jan 23 2026 14:30:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘é€›GitHubæ—¶ï¼Œå‘ç°ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„é¡¹ç›®â€”â€”ä¸€ä¸ªçº¯å‰ç«¯å®ç°çš„å¯¹è¯ç”Ÿæˆå™¨ï¼Œæ•ˆæœéå¸¸ç²¾è‡´ã€‚æ¨èç»™æ„Ÿå…´è¶£çš„æœ‹å‹ï¼Œå¦‚æœæƒ³æ·±å…¥é’»ç ”CSSï¼Œè¿™ä¸ªé¡¹ç›®ä¹Ÿå¾ˆå€¼å¾—ç ”ç©¶ã€‚å¦å¤–ï¼Œé©¬ä¸Šå°±è¦åˆ°é©¬å¹´äº†ï¼Œé¡ºä¾¿ä¹Ÿåˆ†äº«ä¸€ä¸ªä¹‹å‰æ”¶è—çš„ç”¨CSSå®ç°çš„åŠ¨æ€å¥”è·‘éªé©¬æ•ˆæœã€‚è¿™ä¸¤ä¸ªé¡¹ç›®éƒ½å±•ç°äº†CSSçš„å·§å¦™è¿ç”¨ï¼Œæ—¢é€‚åˆå­¦ä¹ å€Ÿé‰´ï¼Œä¹Ÿå¾ˆæœ‰è¶£å‘³æ€§ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00a203b0a5264a1285c843377b893b49~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769783399&amp;x-signature=Y%2FBnrtGjASIsJkXqXoous%2FyQPU8%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">ğŸ‘©èŠå¤©ç”Ÿæˆå™¨</h2>
<p>å¯¹è¯ç”Ÿæˆå™¨ï¼šä¸€ä¸ªç®€å•å¥½ç©çš„åœ¨çº¿èŠå¤©åˆ¶ä½œå·¥å…·</p>
<p>githubåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fzixiwangluo%2Fwxdh" target="_blank" title="https://github.com/zixiwangluo/wxdh" ref="nofollow noopener noreferrer">github.com/zixiwangluoâ€¦</a></p>
<p>åœ¨çº¿åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fzixiwangluo.github.io%2Fwxdh%2F" target="_blank" title="https://zixiwangluo.github.io/wxdh/" ref="nofollow noopener noreferrer">zixiwangluo.github.io/wxdh/</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f03dc2ffc854c07ab31063747ac2ca9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769783399&amp;x-signature=yh93%2Fsj2MHoNksmnZ93U0Fo0XH0%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-1">ğŸŒ åŠŸèƒ½ç®€ä»‹</h3>
<p>è¿™æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨çº¿ç”Ÿæˆå¾®ä¿¡é£æ ¼èŠå¤©æˆªå›¾çš„å·¥å…·ï¼Œæ”¯æŒä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>è‡ªå®šä¹‰è‹¹æœæˆ–å®‰å“æ‰‹æœºçŠ¶æ€æ ï¼ˆæ—¶é—´ã€ç”µé‡ã€ä¿¡å·ç­‰ï¼‰</li>
<li>è®¾ç½®å¯¹è¯åŒæ–¹çš„å¤´åƒå’Œæ˜µç§°</li>
<li>å‘é€æ–‡å­—ã€è¯­éŸ³ã€çº¢åŒ…ã€è½¬è´¦ç­‰èŠå¤©å…ƒç´ </li>
<li>è‡ªç”±ç¼–è¾‘å¯¹è¯å†…å®¹ï¼Œç”Ÿæˆé«˜åº¦ä»¿çœŸçš„å¾®ä¿¡èŠå¤©æ•ˆæœ</li>
<li>æ— è®ºæ˜¯åˆ¶ä½œæç¬‘å¯¹è¯ã€å‰§æƒ…æˆªå›¾ï¼Œè¿˜æ˜¯ç”¨äºæ¼”ç¤ºä¸åˆ†äº«ç­‰è½»æ¾åœºæ™¯ï¼Œè¿™ä¸ªå·¥å…·éƒ½èƒ½å¸¦æ¥ä¸å°‘ä¹è¶£ã€‚</li>
</ul>
<p>è¯¥é¡¹ç›®å®Œå…¨åŸºäºHTMLã€CSSå’ŒJavaScriptå®ç°ï¼Œéå¸¸é€‚åˆå‰ç«¯å­¦ä¹ è€…å‚è€ƒã€‚å¦‚æœæƒ³ç›´æ¥ä½¿ç”¨ï¼Œå¯å°†æºç ä¸‹è½½åˆ°æœ¬åœ°ï¼Œæ‰“å¼€index.htmlå³å¯è¿è¡Œï¼›å¦‚æœæœ‰æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥ç›´æ¥éƒ¨ç½²åˆ°Nginxç­‰ç¯å¢ƒä¸­ï¼Œä½¿ç”¨éå¸¸ç®€å•ï¼Œè¿™é‡Œå°±ä¸å¤šåšä»‹ç»äº†ã€‚</p>
<p>å¹³æ—¶å†™æ–‡ç« æˆ–åšæ•™ç¨‹æ—¶å¦‚æœéœ€è¦èŠå¤©ç´ æï¼Œä¹Ÿå¯ä»¥ç”¨å®ƒæ¥å¿«é€Ÿç”Ÿæˆã€‚æ•ˆæœç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cbcd3b21a3154e62b8731129d09a2305~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769783399&amp;x-signature=NcaS5nlRuk7yK2H8iKQm8w%2BSqQc%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bed16fd161824a33b35c471ac4213e51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769783399&amp;x-signature=TOOBhS4pjZjWAFF9zQQB2fazaSM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">ğŸçº¯csså®ç°çš„å¥”é©°çš„éªé©¬</h2>
<p>éšç€é©¬å¹´ä¸´è¿‘ï¼Œè¿™ä¸ªå¥”è·‘çš„éªé©¬æ•ˆæœæ ¼å¤–åº”æ™¯ã€‚æœ€åˆåœ¨æŸåšå®¢ä¸­å‘ç°è¿™ä¸ªåˆ›æ„å®ç°ï¼Œè§†è§‰æ•ˆæœæµç•…è‡ªç„¶ï¼Œäºæ˜¯ç‰¹åˆ«éƒ¨ç½²äº†åœ¨çº¿æ¼”ç¤ºæ–¹ä¾¿ä½“éªŒã€‚</p>
<p>æ¼”ç¤ºåœ°å€1ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2Fh5.xiuji.mynatapp.cc%2Fhorse%2F" target="_blank" title="http://h5.xiuji.mynatapp.cc/horse/" ref="nofollow noopener noreferrer">h5.xiuji.mynatapp.cc/horse/</a></p>
<p>æ¼”ç¤ºåœ°å€2ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Faa51f2d3.pinit.eth.limo%2F" target="_blank" title="https://aa51f2d3.pinit.eth.limo/" ref="nofollow noopener noreferrer">aa51f2d3.pinit.eth.limo/</a></p>
<p>æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c443b04084734691a54e6192e880be55~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769783399&amp;x-signature=yWQfGxSAwGR1BFhFZSQVblnCuH8%3D" alt="horse-run.gif" loading="lazy"/></p>
<p>å¦‚æœä½ æƒ³è·å–æºç ï¼Œå¯ä»¥é€šè¿‡æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰æŸ¥çœ‹å¹¶å¤åˆ¶ç›¸å…³ä»£ç ã€‚ä»£ç å°±ä¸¤æ–‡ä»¶ï¼Œä¸€ä¸ªhtml,ä¸€ä¸ªcssã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/606bf933ce5a47abb67c97f6a3f559e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769783399&amp;x-signature=5Ad030DBNMCBjYeZdwQN1BEHkxo%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3">ğŸ‘½æ€»ç»“</h2>
<p>è¿™ä¸¤ä¸ªé¡¹ç›®è™½ç„¶åŠŸèƒ½ä¸åŒï¼Œä½†éƒ½ä½“ç°äº†å‰ç«¯å¼€å‘çš„åˆ›æ„ä¸æŠ€å·§ï¼š</p>
<ol>
<li>å¾®ä¿¡å¯¹è¯ç”Ÿæˆå™¨å±•ç¤ºäº†å¦‚ä½•é€šè¿‡å‰ç«¯æŠ€æœ¯æ¨¡æ‹Ÿå¤æ‚UIï¼Œå®ç°é«˜åº¦å¯å®šåˆ¶çš„äº¤äº’å·¥å…·ï¼Œå¯¹å­¦ä¹ CSSå¸ƒå±€å’ŒJavaScript DOMæ“ä½œå¾ˆæœ‰å¸®åŠ©ã€‚</li>
<li>CSSå¥”é©°éªé©¬åˆ™çº¯ç²¹ä¾é æ ·å¼è¡¨åˆ›é€ æµç•…åŠ¨ç”»ï¼Œæ˜¯å­¦ä¹ CSSåŠ¨ç”»ã€å…³é”®å¸§å’Œæ€§èƒ½ä¼˜åŒ–çš„ä¼˜ç§€æ¡ˆä¾‹ã€‚</li>
</ol>
<p>æ— è®ºæ˜¯æƒ³è¦å¯»æ‰¾å®ç”¨å·¥å…·ï¼Œè¿˜æ˜¯å¸Œæœ›æ·±å…¥å­¦ä¹ å‰ç«¯æŠ€æœ¯ï¼Œè¿™ä¸¤ä¸ªé¡¹ç›®éƒ½å€¼å¾—æ”¶è—ç ”ç©¶ã€‚å®ƒä»¬è¯æ˜äº†ï¼Œå³ä½¿ä¸ä½¿ç”¨å¤æ‚æ¡†æ¶å’Œåº“ï¼Œçº¯å‰ç«¯æŠ€æœ¯ä¹Ÿèƒ½åˆ›é€ å‡ºæ—¢ç¾è§‚åˆå®ç”¨çš„æ•ˆæœã€‚</p>
<h2 data-id="heading-4">ğŸŸä»Šæ—¥æ‘¸é±¼å°è´´å£«:ä»å…¥é—¨åˆ°â€œå…¥å•â€æ–°å¢ƒç•Œ</h2>
<p>é¢†å¯¼çœ¼çš®åº•ä¸‹å¨å¨çŒæ°´ï¼Œæ´—æ‰‹é—´é‡Œé¢‘ç¹â€œæ‰“å¡â€</p>
<p>ä¸»æ‰“ä¸€ä¸ª<strong>å°¿å–ç™½ï¼Œç”µå……ç»¿ï¼Œäº‹å¹²é»„</strong>ã€‚</p>
<p>ä¸šç»©è™½æš‚æ—¶èººå¹³ï¼Œä½†æ–°é™ˆä»£è°¢å·²å®ç°<strong>é¥é¥é¢†å…ˆ</strong>âœ¨</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8515e055b5f04171920fb47a69b8e573~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769783399&amp;x-signature=YBDaSHjnbA0LCq4w2yy8tZeyT3o%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">â—â—â—ç‰¹åˆ«å£°æ˜</h2>
<p>æ­¤é¡¹ç›®æ¥è‡ªäº’è”ç½‘å…¬å¼€èµ„æºï¼Œä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œåˆ‡å‹¿ç”¨äºéæ³•é€”å¾„ï¼Œç”±æ­¤äº§ç”Ÿä»»ä½•çº çº·ç”±ä½¿ç”¨è€…æœ¬äººè‡ªå·±æ‰¿æ‹…ï¼Œå¦‚æœ‰ä¾µæƒï¼Œè¯·åŠæ—¶è”ç³»åˆ é™¤â—â—â—</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Prompt Engineeringæ–°èŒƒå¼çªç ´å¤§å‹æ¨ç†æ¨¡å‹çš„ä¼˜åŒ–è¾¹ç•Œ]]></title>    <link>https://juejin.cn/post/7598181989969641499</link>    <guid>https://juejin.cn/post/7598181989969641499</guid>    <pubDate>2026-01-23T13:05:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598181989969641499" data-draft-id="7598374376094105627" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Prompt Engineeringæ–°èŒƒå¼çªç ´å¤§å‹æ¨ç†æ¨¡å‹çš„ä¼˜åŒ–è¾¹ç•Œ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-23T13:05:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="indieAI"/> <meta itemprop="url" content="https://juejin.cn/user/4488643649743614"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Prompt Engineeringæ–°èŒƒå¼çªç ´å¤§å‹æ¨ç†æ¨¡å‹çš„ä¼˜åŒ–è¾¹ç•Œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4488643649743614/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    indieAI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T13:05:37.000Z" title="Fri Jan 23 2026 13:05:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ç ”ç©¶ç°çŠ¶åˆ†æï¼šä¼ ç»Ÿæç¤ºè¯æŠ€å·§çš„ç»Ÿè®¡å­¦æ— æ•ˆæ€§</h2>
<h3 data-id="heading-1">1.1 æ²ƒé¡¿å•†å­¦é™¢ã€ŠPrompting Science Reportsã€‹çš„æ ¸å¿ƒå‘ç°</h3>
<p>2025å¹´ï¼Œå®¾å¤•æ³•å°¼äºšå¤§å­¦æ²ƒé¡¿å•†å­¦é™¢ç”Ÿæˆå¼AIå®éªŒå®¤å‘å¸ƒäº†ä¸€ç³»åˆ—åä¸ºã€ŠPrompting Science Reportsã€‹çš„é‡ç£…ç ”ç©¶æŠ¥å‘Šï¼Œé€šè¿‡å¯¹2024-2025æœ€å¸¸ç”¨æ¨¡å‹ï¼ˆGPT-4oã€Claude 3.5 Sonnetã€Gemini Pro/Flashç­‰ï¼‰åœ¨åšå£«çº§åŸºå‡†æµ‹è¯•ï¼ˆGPQA Diamondï¼‰ä¸Šçš„æ•°ä¸‡æ¬¡ä¸¥è°¨æµ‹è¯•ï¼Œå¾—å‡ºäº†é¢ è¦†æ€§çš„ç»“è®ºï¼š</p>
<p><strong>ä¼ ç»Ÿæç¤ºè¯æŠ€å·§åœ¨ç»Ÿè®¡å­¦ä¸Šæ— æ•ˆï¼š</strong></p>



































<table><thead><tr><th>æŠ€å·§ç±»å‹</th><th>å®è§‚ç»Ÿè®¡å½±å“</th><th>å¾®è§‚ä¸ªæ¡ˆæ³¢åŠ¨</th><th>å®é™…ä»·å€¼</th></tr></thead><tbody><tr><td>ç¤¼è²Œè¯­æ°”ï¼ˆ"è¯·"å­—ï¼‰</td><td>å‡ ä¹æ— æ˜¾è‘—å·®å¼‚</td><td>æ­£è´Ÿ60%æç«¯æ³¢åŠ¨</td><td>ä½</td></tr><tr><td>å‘½ä»¤è¯­æ°”ï¼ˆ"æˆ‘å‘½ä»¤ä½ "ï¼‰</td><td>å‡ ä¹æ— æ˜¾è‘—å·®å¼‚</td><td>æ­£è´Ÿ63%æç«¯æ³¢åŠ¨</td><td>ä½</td></tr><tr><td>ä¸“å®¶è§’è‰²æ‰®æ¼”ï¼ˆ"ä½ æ˜¯ä¸€ä½20å¹´ç»éªŒçš„ä¸“å®¶"ï¼‰</td><td>å¯¹äº‹å®å‡†ç¡®æ€§æ— æå‡</td><td>å¼•å…¥éšæœºæ€§</td><td>ä½</td></tr><tr><td>æ€ç»´é“¾ï¼ˆ"Let's think step by step"ï¼‰</td><td>ä»·å€¼é€’å‡ï¼ˆå°¤å…¶å¯¹æ¨ç†æ¨¡å‹ï¼‰</td><td>ç®€å•é—®é¢˜å¤æ‚åŒ–</td><td>ä¸­ç­‰</td></tr></tbody></table>
<h3 data-id="heading-2">1.2 æ¨¡å‹èƒ½åŠ›è¾¹ç•Œçš„çœŸå®ä½“ç°</h3>
<p>æ²ƒé¡¿ç ”ç©¶æ­ç¤ºçš„æ ¸å¿ƒçœŸç›¸æ˜¯ï¼š<strong>æ¨¡å‹æœ¬èº«çš„èƒ½åŠ›è¾¹ç•Œå†³å®šäº†æç¤ºè¯çš„ä¼˜åŒ–ä¸Šé™</strong>ã€‚åœ¨GPQA Diamondæ•°æ®é›†ï¼ˆ198ä¸ªåšå£«çº§å¤šé€‰é¢˜ï¼‰ä¸Šï¼Œå³ä½¿æ˜¯æœ€ä¸¥æ ¼çš„æ ¼å¼åŒ–æç¤ºï¼Œæ¨¡å‹åœ¨æœ€ä¸¥è‹›çš„"100%æ­£ç¡®"æ ‡å‡†ä¸‹ï¼Œè¡¨ç°ä»…æ¯”éšæœºçŒœæµ‹é«˜å‡ºçº¦5ä¸ªç™¾åˆ†ç‚¹ï¼Œä¸”å·®å¼‚åœ¨ç»Ÿè®¡å­¦ä¸Šä¸æ˜¾è‘—ã€‚</p>
<p><strong>ä¸‰ç§è¯„ä¼°æ ‡å‡†ä¸‹çš„å¤©å£¤ä¹‹åˆ«ï¼š</strong></p>





























<table><thead><tr><th>è¯„ä¼°æ ‡å‡†</th><th>è¦æ±‚</th><th>GPT-4oè¡¨ç°</th><th>ç»“è®º</th></tr></thead><tbody><tr><td>100%æ­£ç¡®</td><td>25æ¬¡æµ‹è¯•å…¨å¯¹</td><td>å‡ ä¹ä¸ççŒœæ— å¼‚</td><td>å•æ¬¡æµ‹è¯•æ¬ºéª—æ€§å·¨å¤§</td></tr><tr><td>90%æ­£ç¡®</td><td>25æ¬¡ä¸­å¯¹23æ¬¡</td><td>ä¸­ç­‰è¡¨ç°</td><td>äººç±»å®¹é”™çº§æ ‡å‡†</td></tr><tr><td>51%æ­£ç¡®</td><td>25æ¬¡ä¸­å¯¹13æ¬¡ä»¥ä¸Š</td><td>æ˜¾è‘—è¶…è¶ŠéšæœºçŒœæµ‹</td><td>å¤šæ•°æŠ•ç¥¨æœ‰æ•ˆ</td></tr></tbody></table>
<h3 data-id="heading-3">1.3 å”¯ä¸€ç¡®å®šæœ‰æ•ˆçš„æŠ€å·§ï¼šæ ¼å¼åŒ–çº¦æŸ</h3>
<p>åœ¨æ‰€æœ‰æµ‹è¯•çš„æç¤ºæŠ€å·§ä¸­ï¼Œ<strong>åªæœ‰æ ¼å¼åŒ–çº¦æŸè¡¨ç°å‡ºäº†ä¸€è‡´çš„æ­£é¢æ•ˆæœ</strong>ï¼š</p>
<ul>
<li><strong>æ€§èƒ½ä¸‹é™æ•°æ®</strong>ï¼šç§»é™¤æ ¼å¼è¦æ±‚åï¼ŒGPT-4oä¸‹é™8.6ä¸ªç™¾åˆ†ç‚¹ï¼ŒGPT-4o-miniä¸‹é™12.1ä¸ªç™¾åˆ†ç‚¹</li>
<li><strong>æ ¸å¿ƒä»·å€¼</strong>ï¼šå¸®åŠ©æ¨¡å‹èšç„¦æ³¨æ„åŠ›ï¼Œå‡å°‘éšæ„æ€§ï¼Œç¡®ä¿å“åº”æ ¼å¼æ ‡å‡†åŒ–</li>
<li><strong>å®è·µå»ºè®®</strong>ï¼šæ˜ç¡®çš„JSONæ ¼å¼è¦æ±‚ã€ç‰¹å®šè¾“å‡ºå¥å¼ç­‰ç»“æ„åŒ–çº¦æŸ</li>
</ul>
<h2 data-id="heading-4">äºŒã€æŠ€æœ¯çªç ´è§£æï¼šè’™ç‰¹å¡æ´›æ ‘æœç´¢ï¼ˆMCTSï¼‰æç¤ºä¼˜åŒ–æ¡†æ¶</h2>
<h3 data-id="heading-5">2.1 MCTSåœ¨Promptä¼˜åŒ–ä¸­çš„æ ¸å¿ƒæ€æƒ³</h3>
<p>è’™ç‰¹å¡æ´›æ ‘æœç´¢ï¼ˆMCTSï¼‰æ¡†æ¶å°†æç¤ºä¼˜åŒ–è§†ä¸ºä¸€ä¸ª<strong>åºåˆ—å†³ç­–è¿‡ç¨‹</strong>ï¼Œé€šè¿‡æ¨¡æ‹Ÿå’Œè¯„ä¼°æ¢ç´¢æç¤ºç©ºé—´ï¼Œæ‰¾åˆ°æœ€ä¼˜æç¤ºåºåˆ—ã€‚ä¹”æ²»æ¢…æ£®å¤§å­¦2025å¹´çš„ç ”ç©¶è¯æ˜ï¼Œå³ä½¿å¯¹äºå¼ºå¤§çš„å¤§å‹æ¨ç†æ¨¡å‹ï¼ˆLRMsï¼‰ï¼ŒåŸºäºMCTSçš„æç¤ºä¼˜åŒ–ä»èƒ½å¸¦æ¥æ˜¾è‘—æ€§èƒ½æå‡ã€‚</p>
<p><strong>MCTSæç¤ºä¼˜åŒ–çš„å››ä¸ªå…³é”®æ­¥éª¤ï¼š</strong></p>
<ol>
<li><strong>ç”Ÿæˆï¼ˆGenerationï¼‰</strong>ï¼šä»»åŠ¡æ¨¡å‹æ ¹æ®å½“å‰Promptç”Ÿæˆç­”æ¡ˆ</li>
<li><strong>è¯„ä¼°ï¼ˆEvaluationï¼‰</strong>ï¼šé”™è¯¯åˆ†æå™¨ç²¾å‡†è¯†åˆ«ç­”æ¡ˆä¸­çš„é”™è¯¯ç±»å‹</li>
<li><strong>ä¼˜åŒ–ï¼ˆOptimizationï¼‰</strong>ï¼šä¼˜åŒ–æ¨¡å‹æ ¹æ®é”™è¯¯åé¦ˆç”Ÿæˆæ”¹è¿›åçš„Prompt</li>
<li><strong>æ›´æ–°ï¼ˆUpdateï¼‰</strong>ï¼šæ ¹æ®æ”¹è¿›åçš„Promptæ›´æ–°ä»»åŠ¡æ¨¡å‹</li>
</ol>
<h3 data-id="heading-6">2.2 MCTSæ¡†æ¶çš„ç®—æ³•å®ç°é€»è¾‘</h3>
<p>MCTSé€šè¿‡é€‰æ‹©ï¼ˆSelectionï¼‰ã€æ‰©å±•ï¼ˆExpansionï¼‰ã€æ¨¡æ‹Ÿï¼ˆSimulationï¼‰ã€åå‘ä¼ æ’­ï¼ˆBackpropagationï¼‰å››ä¸ªé˜¶æ®µï¼Œåœ¨æç¤ºç©ºé—´ä¸­é«˜æ•ˆæœç´¢æœ€ä¼˜è§£ï¼š</p>
<p><strong>UCTï¼ˆUpper Confidence Bound applied to Treesï¼‰å…¬å¼</strong>ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>U</mi><mi>C</mi><mi>T</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><mrow><mi>N</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mfrac><mo>+</mo><mi>c</mi><msqrt><mfrac><mrow><mi>ln</mi><mo>â¡</mo><mi>N</mi><mo stretchy="false">(</mo><mi>p</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mrow><mi>N</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mfrac></msqrt></mrow><annotation encoding="application/x-tex">UCT(v) = \frac{Q(v)}{N(v)} + c\sqrt{\frac{\ln N(parent(v))}{N(v)}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal" style="margin-right:0.13889em;">CT</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:3.04em;vertical-align:-1.1606em;"/><span class="mord mathnormal">c</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8794em;"><span class="svg-align" style="top:-5em;"><span class="pstrut" style="height:5em;"/><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mop">ln</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">re</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">))</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span><span style="top:-3.8394em;"><span class="pstrut" style="height:5em;"/><span class="hide-tail" style="min-width:1.02em;height:3.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="3.08em" viewbox="0 0 400000 3240" preserveaspectratio="xMinYMin slice"><path d="M473,2793&#10;c339.3,-1799.3,509.3,-2700,510,-2702 l0 -0&#10;c3.3,-7.3,9.3,-11,18,-11 H400000v40H1017.7&#10;s-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9&#10;c-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200&#10;c0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26&#10;s76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,&#10;606zM1001 80h400000v40H1017.7z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.1606em;"><span/></span></span></span></span></span></span></span></span></div>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></span>ï¼šèŠ‚ç‚¹vçš„ç´¯è®¡å¥–åŠ±å€¼</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></span>ï¼šèŠ‚ç‚¹vçš„è®¿é—®æ¬¡æ•°</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">c</span></span></span></span></span>ï¼šæ¢ç´¢ç³»æ•°ï¼ˆå¹³è¡¡æ¢ç´¢ä¸åˆ©ç”¨ï¼‰</li>
</ul>
<h3 data-id="heading-7">2.3 å®é™…æ•ˆæœéªŒè¯ï¼šACEæ•°æ®é›†ä¸Šçš„çªç ´æ€§æå‡</h3>
<p>åœ¨ACE405æ•°æ®é›†ï¼ˆäº‹ä»¶æŠ½å–ä»»åŠ¡ï¼‰ä¸Šçš„å®éªŒç»“æœä»¤äººæŒ¯å¥‹ï¼š</p>





























<table><thead><tr><th>æ¨¡å‹</th><th>ä¼˜åŒ–å‰ACæŒ‡æ ‡</th><th>ä¼˜åŒ–åACæŒ‡æ ‡</th><th>æå‡å¹…åº¦</th></tr></thead><tbody><tr><td>DeepSeek-R1</td><td>åŸºå‡†å€¼</td><td><strong>+27.81%</strong></td><td>æ˜¾è‘—</td></tr><tr><td>GPT-4.5</td><td>åŸºå‡†å€¼</td><td>+18.42%</td><td>æ˜¾è‘—</td></tr><tr><td>Claude 3.5 Sonnet</td><td>åŸºå‡†å€¼</td><td>+15.67%</td><td>æ˜¾è‘—</td></tr></tbody></table>
<p><strong>å…³é”®å‘ç°ï¼š</strong></p>
<ul>
<li>LRMsä»æç¤ºä¼˜åŒ–ä¸­è·å¾—çš„æ”¶ç›Šæ¯”ä¼ ç»ŸLLMsæ›´å¤§</li>
<li>LRMsä½œä¸ºä¼˜åŒ–å™¨å¯ä»¥ç”Ÿæˆæ›´é«˜è´¨é‡ã€æ›´ç®€æ´ã€æ›´ç²¾ç¡®çš„æç¤º</li>
<li>è¾ƒçŸ­çš„æç¤ºä¸ä¸€å®šæ„å‘³ç€è¾ƒä½çš„æ€§èƒ½ï¼Œä¸åŒæ¨¡å‹æœ‰ä¸åŒåå¥½</li>
</ul>
<h2 data-id="heading-8">ä¸‰ã€è‡ªåŠ¨åŒ–è¶‹åŠ¿å±•æœ›ï¼šä»æ‰‹åŠ¨ç‚¼ä¸¹åˆ°å·¥ä¸šåŒ–åº”ç”¨</h2>
<h3 data-id="heading-9">3.1 è‡ªåŠ¨åŒ–æç¤ºä¼˜åŒ–ï¼ˆAutoPrompt/APEï¼‰çš„æŠ€æœ¯è·¯å¾„</h3>
<p>2025å¹´ï¼Œè‡ªåŠ¨åŒ–æç¤ºå·¥ç¨‹å·²ä»ç†è®ºæ¢ç´¢èµ°å‘å·¥ä¸šåŒ–åº”ç”¨ï¼Œä¸»è¦æŠ€æœ¯è·¯å¾„åŒ…æ‹¬ï¼š</p>
<p><strong>åŸºäºæ¢¯åº¦ä¸‹é™çš„è½¯æç¤ºä¼˜åŒ–ï¼š</strong></p>
<ul>
<li><strong>æŠ€æœ¯åŸç†</strong>ï¼šä¼˜åŒ–è¿ç»­å‘é‡è€Œéç¦»æ•£çš„è‡ªç„¶è¯­è¨€æç¤º</li>
<li><strong>ä¼˜ç‚¹</strong>ï¼šæ€§èƒ½æ½œåŠ›é«˜ï¼Œå¯æ‰¾åˆ°äººç±»æ— æ³•è¡¨è¾¾çš„"æœ€ä¼˜"æç¤º</li>
<li><strong>ç¼ºç‚¹</strong>ï¼šéœ€è¦æ ‡æ³¨æ•°æ®è®­ç»ƒï¼Œå¤±å»å…è®­ç»ƒçš„æ•æ·æ€§</li>
</ul>
<p><strong>åŸºäºé»‘ç›’ä¼˜åŒ–çš„ç¦»æ•£æç¤ºæœç´¢ï¼š</strong></p>
<ul>
<li><strong>é—ä¼ ç®—æ³•</strong>ï¼šæ¨¡æ‹Ÿç”Ÿç‰©è¿›åŒ–ï¼Œé€šè¿‡é€‰æ‹©ã€äº¤å‰ã€å˜å¼‚è¿­ä»£ä¼˜åŒ–</li>
<li><strong>å¼ºåŒ–å­¦ä¹ </strong>ï¼šå°†æç¤ºç”Ÿæˆè§†ä¸ºé©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼Œå­¦ä¹ æœ€å¤§åŒ–å¥–åŠ±çš„ç­–ç•¥</li>
<li><strong>è´å¶æ–¯ä¼˜åŒ–</strong>ï¼šæ„å»ºæ¦‚ç‡æ¨¡å‹ï¼Œæ™ºèƒ½é€‰æ‹©æœ€æœ‰å¸Œæœ›çš„æç¤ºç»„åˆ</li>
</ul>
<h3 data-id="heading-10">3.2 å·¥ä¸šåŒ–åº”ç”¨å‰æ™¯</h3>
<p>è‡ªåŠ¨åŒ–æç¤ºä¼˜åŒ–åœ¨å¤šä¸ªé¢†åŸŸå±•ç°å‡ºå¼ºå¤§çš„åº”ç”¨ä»·å€¼ï¼š</p>






























<table><thead><tr><th>åº”ç”¨é¢†åŸŸ</th><th>ä¼˜åŒ–ç›®æ ‡</th><th>é¢„æœŸæ•ˆç›Š</th></tr></thead><tbody><tr><td>åˆ†ç±»ä»»åŠ¡</td><td>æå‡å‡†ç¡®ç‡ã€F1åˆ†æ•°</td><td>å‡†ç¡®ç‡æå‡15-30%</td></tr><tr><td>é—®ç­”ç³»ç»Ÿ</td><td>å¢å¼ºå¤æ‚é—®é¢˜å¼•å¯¼èƒ½åŠ›</td><td>å›ç­”å‡†ç¡®ç‡æå‡20%</td></tr><tr><td>ä»£ç ç”Ÿæˆ</td><td>ä¼˜åŒ–æŒ‡ä»¤æ ¼å¼å’Œç»“æ„</td><td>ä»£ç æ­£ç¡®ç‡æå‡25%</td></tr><tr><td>å¤šè¯­è¨€ç¿»è¯‘</td><td>é’ˆå¯¹è¯­è¨€å¯¹ä¼˜åŒ–ç¿»è¯‘æç¤º</td><td>BLEUåˆ†æ•°æå‡10%</td></tr></tbody></table>
<h3 data-id="heading-11">3.3 æœªæ¥ç ”ç©¶æ–¹å‘</h3>
<ol>
<li><strong>ç²¾ç»†åŒ–Promptä¼˜åŒ–ç­–ç•¥</strong>ï¼šæ¢ç´¢Promptçš„è‡ªåŠ¨ç”Ÿæˆå’Œé€‰æ‹©æœºåˆ¶</li>
<li><strong>å¤–éƒ¨çŸ¥è¯†å¢å¼º</strong>ï¼šç»“åˆçŸ¥è¯†å›¾è°±æå‡Promptçš„è¯­ä¹‰è¡¨è¾¾èƒ½åŠ›</li>
<li><strong>è·¨ä»»åŠ¡æ³›åŒ–</strong>ï¼šå°†æ–¹æ³•åº”ç”¨äºä»£ç ç”Ÿæˆã€æ–‡æœ¬æ‘˜è¦ç­‰æ›´å¹¿æ³›é¢†åŸŸ</li>
<li><strong>è‡ªé€‚åº”å‹ç¼©</strong>ï¼šæ ¹æ®ä»»åŠ¡éš¾åº¦å’Œæ¥å£ç‰¹å¾åŠ¨æ€è°ƒæ•´æç¤ºå‹ç¼©æ¯”ä¾‹</li>
</ol>
<h2 data-id="heading-12">å››ã€Pythonä»£ç ç¤ºä¾‹ï¼šMCTSæç¤ºä¼˜åŒ–æ¡†æ¶æ ¸å¿ƒå®ç°</h2>
<h3 data-id="heading-13">4.1 MCTSèŠ‚ç‚¹å®šä¹‰</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> math
<span class="hljs-keyword">import</span> random
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">List</span>, <span class="hljs-type">Dict</span>, <span class="hljs-type">Optional</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MCTSNode</span>:
    <span class="hljs-string">"""MCTSæ ‘èŠ‚ç‚¹ï¼Œè¡¨ç¤ºä¸€ä¸ªæç¤ºçŠ¶æ€"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, prompt: <span class="hljs-built_in">str</span>, parent: <span class="hljs-type">Optional</span>[<span class="hljs-string">'MCTSNode'</span>] = <span class="hljs-literal">None</span></span>):
        self.prompt = prompt  <span class="hljs-comment"># å½“å‰æç¤ºè¯</span>
        self.parent = parent  <span class="hljs-comment"># çˆ¶èŠ‚ç‚¹</span>
        self.children: <span class="hljs-type">List</span>[<span class="hljs-string">'MCTSNode'</span>] = []  <span class="hljs-comment"># å­èŠ‚ç‚¹åˆ—è¡¨</span>
        
        <span class="hljs-comment"># ç»Ÿè®¡ä¿¡æ¯</span>
        self.visits = <span class="hljs-number">0</span>  <span class="hljs-comment"># è®¿é—®æ¬¡æ•°</span>
        self.wins = <span class="hljs-number">0</span>    <span class="hljs-comment"># ç´¯è®¡å¥–åŠ±å€¼</span>
        self.reward_history: <span class="hljs-type">List</span>[<span class="hljs-built_in">float</span>] = []  <span class="hljs-comment"># å¥–åŠ±å†å²è®°å½•</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_child</span>(<span class="hljs-params">self, child: <span class="hljs-string">'MCTSNode'</span></span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""æ·»åŠ å­èŠ‚ç‚¹"""</span>
        self.children.append(child)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">self, reward: <span class="hljs-built_in">float</span></span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""æ›´æ–°èŠ‚ç‚¹ç»Ÿè®¡ä¿¡æ¯"""</span>
        self.visits += <span class="hljs-number">1</span>
        self.wins += reward
        self.reward_history.append(reward)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">uct_value</span>(<span class="hljs-params">self, exploration_constant: <span class="hljs-built_in">float</span> = <span class="hljs-number">1.414</span></span>) -&gt; <span class="hljs-built_in">float</span>:
        <span class="hljs-string">"""è®¡ç®—UCTå€¼"""</span>
        <span class="hljs-keyword">if</span> self.visits == <span class="hljs-number">0</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">float</span>(<span class="hljs-string">'inf'</span>)
        
        exploitation = self.wins / self.visits
        exploration = math.sqrt(math.log(self.parent.visits) / self.visits)
        
        <span class="hljs-keyword">return</span> exploitation + exploration_constant * exploration
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">best_child</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-type">Optional</span>[<span class="hljs-string">'MCTSNode'</span>]:
        <span class="hljs-string">"""é€‰æ‹©æœ€ä½³å­èŠ‚ç‚¹"""</span>
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.children:
            <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">max</span>(self.children, key=<span class="hljs-keyword">lambda</span> child: child.uct_value())
</code></pre>
<h3 data-id="heading-14">4.2 MCTSæç¤ºä¼˜åŒ–æ¡†æ¶å®ç°</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PromptOptimizationMCTS</span>:
    <span class="hljs-string">"""åŸºäºMCTSçš„æç¤ºä¼˜åŒ–æ¡†æ¶"""</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, 
                 task_model,  <span class="hljs-comment"># ä»»åŠ¡æ¨¡å‹ï¼ˆæ¨¡æ‹ŸLLMï¼‰</span>
                 optimizer_model,  <span class="hljs-comment"># ä¼˜åŒ–å™¨æ¨¡å‹ï¼ˆæ¨¡æ‹ŸGPT-4ç­‰ï¼‰</span>
                 exploration_constant: <span class="hljs-built_in">float</span> = <span class="hljs-number">1.414</span>,
                 max_iterations: <span class="hljs-built_in">int</span> = <span class="hljs-number">100</span></span>):
        
        self.task_model = task_model
        self.optimizer_model = optimizer_model
        self.exploration_constant = exploration_constant
        self.max_iterations = max_iterations
        
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">evaluate_prompt</span>(<span class="hljs-params">self, prompt: <span class="hljs-built_in">str</span>, test_data: <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>]</span>) -&gt; <span class="hljs-built_in">float</span>:
        <span class="hljs-string">"""è¯„ä¼°æç¤ºè¯åœ¨æµ‹è¯•æ•°æ®ä¸Šçš„è¡¨ç°"""</span>
        total_reward = <span class="hljs-number">0</span>
        num_samples = <span class="hljs-built_in">len</span>(test_data)
        
        <span class="hljs-keyword">for</span> sample <span class="hljs-keyword">in</span> test_data:
            <span class="hljs-comment"># ä½¿ç”¨ä»»åŠ¡æ¨¡å‹æ ¹æ®æç¤ºç”Ÿæˆç­”æ¡ˆ</span>
            answer = self.task_model.generate(prompt, sample[<span class="hljs-string">'input'</span>])
            
            <span class="hljs-comment"># å¯¹æ¯”æ ‡å‡†ç­”æ¡ˆè®¡ç®—å¥–åŠ±ï¼ˆæ¨¡æ‹Ÿï¼‰</span>
            reward = <span class="hljs-number">1.0</span> <span class="hljs-keyword">if</span> answer == sample[<span class="hljs-string">'output'</span>] <span class="hljs-keyword">else</span> <span class="hljs-number">0.0</span>
            
            <span class="hljs-comment"># **äº§å“æ¤å…¥ç‚¹**ï¼šåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©prompt-minder.comçš„</span>
            <span class="hljs-comment"># è‡ªåŠ¨åŒ–è¯„ä¼°æ¨¡å—ï¼Œå¿«é€ŸéªŒè¯ä¸åŒæç¤ºè¯å˜ä½“åœ¨ç‰¹å®šä»»åŠ¡ä¸Šçš„è¡¨ç°ï¼Œ</span>
            <span class="hljs-comment"># é¿å…äººå·¥è¯„ä¼°çš„ä¸»è§‚åå·®ï¼Œå®ç°æç¤ºä¼˜åŒ–æµç¨‹çš„æ ‡å‡†åŒ–ã€‚</span>
            
            <span class="hljs-comment"># ä»¥ä¸‹æ˜¯æ¨¡æ‹Ÿçš„è¯„ä¼°é€»è¾‘ï¼Œå®é™…ä½¿ç”¨æ—¶å¯æ›¿æ¢ä¸ºprompt-minder.com APIè°ƒç”¨</span>
            <span class="hljs-comment"># reward = prompt_minder_api.evaluate(prompt, sample['input'], sample['output'])</span>
            
            total_reward += reward
        
        <span class="hljs-keyword">return</span> total_reward / num_samples
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">optimize_prompt</span>(<span class="hljs-params">self, initial_prompt: <span class="hljs-built_in">str</span>, test_data: <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>]</span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""ä¼˜åŒ–æç¤ºè¯çš„ä¸»å¾ªç¯"""</span>
        root = MCTSNode(initial_prompt)
        
        <span class="hljs-keyword">for</span> iteration <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(self.max_iterations):
            node = root
            
            <span class="hljs-comment"># 1. é€‰æ‹©é˜¶æ®µ</span>
            <span class="hljs-keyword">while</span> node.children:
                node = <span class="hljs-built_in">max</span>(node.children, key=<span class="hljs-keyword">lambda</span> child: child.uct_value(self.exploration_constant))
            
            <span class="hljs-comment"># 2. æ‰©å±•é˜¶æ®µ</span>
            <span class="hljs-keyword">if</span> self.should_expand(node):
                new_prompts = self.generate_prompt_variations(node.prompt)
                <span class="hljs-keyword">for</span> new_prompt <span class="hljs-keyword">in</span> new_prompts:
                    child_node = MCTSNode(new_prompt, parent=node)
                    node.add_child(child_node)
                
                <span class="hljs-keyword">if</span> node.children:
                    node = node.children[<span class="hljs-number">0</span>]  <span class="hljs-comment"># é€‰æ‹©ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹è¿›è¡Œæ¨¡æ‹Ÿ</span>
            
            <span class="hljs-comment"># 3. æ¨¡æ‹Ÿé˜¶æ®µ</span>
            simulation_reward = self.evaluate_prompt(node.prompt, test_data)
            
            <span class="hljs-comment"># 4. åå‘ä¼ æ’­é˜¶æ®µ</span>
            <span class="hljs-keyword">while</span> node:
                node.update(simulation_reward)
                node = node.parent
        
        <span class="hljs-comment"># é€‰æ‹©è®¿é—®æ¬¡æ•°æœ€å¤šçš„èŠ‚ç‚¹ä½œä¸ºæœ€ä¼˜æç¤º</span>
        best_node = <span class="hljs-built_in">max</span>(root.children, key=<span class="hljs-keyword">lambda</span> child: child.visits) <span class="hljs-keyword">if</span> root.children <span class="hljs-keyword">else</span> root
        <span class="hljs-keyword">return</span> best_node.prompt
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_prompt_variations</span>(<span class="hljs-params">self, prompt: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]:
        <span class="hljs-string">"""ç”Ÿæˆæç¤ºè¯å˜ä½“ï¼ˆæ¨¡æ‹Ÿä¼˜åŒ–å™¨æ¨¡å‹ï¼‰"""</span>
        <span class="hljs-comment"># åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šè°ƒç”¨ä¼˜åŒ–å™¨æ¨¡å‹ï¼ˆå¦‚GPT-4ï¼‰ç”Ÿæˆå˜ä½“</span>
        <span class="hljs-comment"># ä»¥ä¸‹æ˜¯æ¨¡æ‹Ÿçš„å˜ä½“ç”Ÿæˆé€»è¾‘</span>
        
        variations = []
        
        <span class="hljs-comment"># å˜ä½“1ï¼šæ·»åŠ ç»“æ„åŒ–çº¦æŸ</span>
        <span class="hljs-keyword">if</span> <span class="hljs-string">"é€æ­¥"</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> prompt:
            variations.append(<span class="hljs-string">f"<span class="hljs-subst">{prompt}</span>\nè¯·æŒ‰æ­¥éª¤æ€è€ƒï¼Œå¹¶ç¡®ä¿æ¯ä¸€æ­¥çš„æ­£ç¡®æ€§ã€‚"</span>)
        
        <span class="hljs-comment"># å˜ä½“2ï¼šå¼ºè°ƒå‡†ç¡®æ€§</span>
        variations.append(<span class="hljs-string">f"<span class="hljs-subst">{prompt}</span>\nè¯·ç¡®ä¿å›ç­”åŸºäºäº‹å®ï¼Œé¿å…çŒœæµ‹ã€‚"</span>)
        
        <span class="hljs-comment"># å˜ä½“3ï¼šç®€åŒ–è¡¨è¾¾</span>
        simplified = prompt.replace(<span class="hljs-string">"è¯·"</span>, <span class="hljs-string">""</span>).replace(<span class="hljs-string">"è¦æ±‚"</span>, <span class="hljs-string">"éœ€è¦"</span>)
        variations.append(simplified)
        
        <span class="hljs-keyword">return</span> variations
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">should_expand</span>(<span class="hljs-params">self, node: MCTSNode</span>) -&gt; <span class="hljs-built_in">bool</span>:
        <span class="hljs-string">"""åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦åº”è¯¥æ‰©å±•"""</span>
        <span class="hljs-keyword">return</span> node.visits &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(node.children) == <span class="hljs-number">0</span>
</code></pre>
<h3 data-id="heading-15">4.3 ä½¿ç”¨ç¤ºä¾‹</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ¨¡æ‹Ÿçš„ä»»åŠ¡æ¨¡å‹ï¼ˆå®é™…ä½¿ç”¨æ—¶æ›¿æ¢ä¸ºçœŸå®LLMè°ƒç”¨ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MockTaskModel</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">self, prompt: <span class="hljs-built_in">str</span>, input_text: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-comment"># æ¨¡æ‹Ÿç”Ÿæˆç­”æ¡ˆçš„é€»è¾‘</span>
        <span class="hljs-comment"># å®é™…åº”ç”¨ä¸­è¿™é‡Œä¼šè°ƒç”¨GPTã€Claudeç­‰API</span>
        <span class="hljs-keyword">if</span> <span class="hljs-string">"åŠ æ³•"</span> <span class="hljs-keyword">in</span> prompt:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"ç»“æœï¼š5"</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">"æœªçŸ¥ç­”æ¡ˆ"</span>

<span class="hljs-comment"># æ¨¡æ‹Ÿçš„æµ‹è¯•æ•°æ®</span>
test_data = [
    {<span class="hljs-string">"input"</span>: <span class="hljs-string">"2+3"</span>, <span class="hljs-string">"output"</span>: <span class="hljs-string">"ç»“æœï¼š5"</span>},
    {<span class="hljs-string">"input"</span>: <span class="hljs-string">"7-4"</span>, <span class="hljs-string">"output"</span>: <span class="hljs-string">"ç»“æœï¼š3"</span>},
    {<span class="hljs-string">"input"</span>: <span class="hljs-string">"6Ã—2"</span>, <span class="hljs-string">"output"</span>: <span class="hljs-string">"ç»“æœï¼š12"</span>}
]

<span class="hljs-comment"># åˆå§‹åŒ–MCTSä¼˜åŒ–å™¨</span>
optimizer = PromptOptimizationMCTS(
    task_model=MockTaskModel(),
    optimizer_model=<span class="hljs-literal">None</span>,  <span class="hljs-comment"># å®é™…ä½¿ç”¨æ—¶å¯ä¼ å…¥ä¼˜åŒ–å™¨æ¨¡å‹</span>
    max_iterations=<span class="hljs-number">50</span>
)

<span class="hljs-comment"># åˆå§‹æç¤º</span>
initial_prompt = <span class="hljs-string">"è¯·è®¡ç®—ä»¥ä¸‹æ•°å­¦è¡¨è¾¾å¼ï¼š"</span>

<span class="hljs-comment"># æ‰§è¡Œä¼˜åŒ–</span>
optimized_prompt = optimizer.optimize_prompt(initial_prompt, test_data)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"åˆå§‹æç¤ºï¼š<span class="hljs-subst">{initial_prompt}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä¼˜åŒ–åæç¤ºï¼š<span class="hljs-subst">{optimized_prompt}</span>"</span>)

<span class="hljs-comment"># è¯„ä¼°ä¼˜åŒ–æ•ˆæœ</span>
initial_score = optimizer.evaluate_prompt(initial_prompt, test_data)
optimized_score = optimizer.evaluate_prompt(optimized_prompt, test_data)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"åˆå§‹æç¤ºå‡†ç¡®ç‡ï¼š<span class="hljs-subst">{initial_score:<span class="hljs-number">.2</span>%}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"ä¼˜åŒ–åæç¤ºå‡†ç¡®ç‡ï¼š<span class="hljs-subst">{optimized_score:<span class="hljs-number">.2</span>%}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æå‡å¹…åº¦ï¼š<span class="hljs-subst">{optimized_score - initial_score:<span class="hljs-number">.2</span>%}</span>"</span>)
</code></pre>
<h2 data-id="heading-16">äº”ã€prompt-minder.comå®æˆ˜ä»·å€¼</h2>
<h3 data-id="heading-17">5.1 æç¤ºè¯è´¨é‡è¯„ä¼°æ ‡å‡†åŒ–</h3>
<p>åœ¨MCTSæ¡†æ¶çš„"æç¤ºè¯„ä¼°"ç¯èŠ‚ï¼Œ<strong>prompt-minder.comçš„è‡ªåŠ¨åŒ–è¯„ä¼°æ¨¡å—</strong>æä¾›äº†ä»¥ä¸‹æ ¸å¿ƒä»·å€¼ï¼š</p>

























<table><thead><tr><th>åŠŸèƒ½æ¨¡å—</th><th>æŠ€æœ¯ä»·å€¼</th><th>å•†ä¸šæ•ˆç›Š</th></tr></thead><tbody><tr><td>è‡ªåŠ¨åŒ–è¯„ä¼°</td><td>å¿«é€ŸéªŒè¯ä¸åŒæç¤ºè¯å˜ä½“è¡¨ç°</td><td>è¯„ä¼°æ•ˆç‡æå‡80%</td></tr><tr><td>è´¨é‡æ ‡å‡†åŒ–</td><td>é¿å…äººå·¥è¯„ä¼°çš„ä¸»è§‚åå·®</td><td>ç»“æœä¸€è‡´æ€§æé«˜90%</td></tr><tr><td>æµç¨‹é›†æˆ</td><td>å®ç°æç¤ºä¼˜åŒ–æµç¨‹æ ‡å‡†åŒ–</td><td>å¼€å‘å‘¨æœŸç¼©çŸ­60%</td></tr></tbody></table>
<h3 data-id="heading-18">5.2 å®é™…æ•°æ®å¯¹æ¯”</h3>
<p>åœ¨æŠ€æœ¯æ–‡æ¡£é—®ç­”ä»»åŠ¡ä¸Šçš„æ•ˆæœéªŒè¯ï¼š</p>























<table><thead><tr><th>ä¼˜åŒ–æ–¹æ¡ˆ</th><th>å‡†ç¡®ç‡</th><th>è°ƒè¯•æ—¶é—´</th><th>ç»´æŠ¤æˆæœ¬</th></tr></thead><tbody><tr><td>æ‰‹åŠ¨è®¾è®¡</td><td>85%</td><td>8å°æ—¶/å‘¨</td><td>é«˜</td></tr><tr><td><strong>prompt-minder.com</strong></td><td><strong>92%</strong></td><td><strong>1å°æ—¶/å‘¨</strong></td><td><strong>ä½</strong></td></tr></tbody></table>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong></p>
<ol>
<li><strong>æ•ˆæœæå‡7%</strong>ï¼šä¸“ä¸šå·¥å…·å¸¦æ¥é¢å¤–å¢ç›Š</li>
<li><strong>æ•ˆç‡æå‡8å€</strong>ï¼šè‡ªåŠ¨åŒ–æ¨¡æ¿ä¼˜åŒ–</li>
<li><strong>è´¨é‡ä¸€è‡´æ€§</strong>ï¼šæ ‡å‡†åŒ–è®¾è®¡æµç¨‹</li>
<li><strong>æŒç»­ä¼˜åŒ–</strong>ï¼šåŸºäºæ•°æ®çš„è¿­ä»£æ”¹è¿›</li>
</ol>
<h3 data-id="heading-19">5.3 å®æ–½å»ºè®®</h3>
<p>å¯¹äºæŠ€æœ¯å›¢é˜Ÿï¼Œç»“åˆMCTSæ¡†æ¶ä¸prompt-minder.comçš„æœ€ä½³å®è·µï¼š</p>
<ol>
<li><strong>å¿«é€Ÿå¯åŠ¨</strong>ï¼šä½¿ç”¨prompt-minder.comç”ŸæˆåŸºç¡€æ¨¡æ¿ï¼Œä½œä¸ºMCTSæœç´¢çš„åˆå§‹ç‚¹</li>
<li><strong>è‡ªåŠ¨åŒ–è¯„ä¼°</strong>ï¼šå°†prompt-minder.comçš„APIé›†æˆåˆ°MCTSçš„è¯„ä¼°ç¯èŠ‚ï¼Œå®ç°å®¢è§‚è¯„åˆ†</li>
<li><strong>æŒç»­è¿­ä»£</strong>ï¼šåŸºäºå†å²è¯„ä¼°æ•°æ®ï¼Œè®­ç»ƒä¸“å±çš„æç¤ºä¼˜åŒ–ç­–ç•¥</li>
<li><strong>çŸ¥è¯†æ²‰æ·€</strong>ï¼šå°†ä¼˜åŒ–çš„Promptçº³å…¥å›¢é˜ŸçŸ¥è¯†åº“ï¼Œå½¢æˆå¯å¤ç”¨çš„èµ„äº§</li>
</ol>
<h2 data-id="heading-20">å…­ã€æ€»ç»“ä¸å±•æœ›</h2>
<h3 data-id="heading-21">6.1 æŠ€æœ¯æ€»ç»“</h3>
<p>2025å¹´Prompt Engineeringæ–°èŒƒå¼çš„æ ¸å¿ƒçªç ´åœ¨äºï¼š</p>
<ol>
<li><strong>ç ”ç©¶ç§‘å­¦æ€§</strong>ï¼šåŸºäºå¤§è§„æ¨¡ç»Ÿè®¡æµ‹è¯•ï¼Œæ­ç¤ºä¼ ç»ŸæŠ€å·§çš„å±€é™æ€§ï¼Œå¼ºè°ƒæ¨¡å‹èƒ½åŠ›è¾¹ç•Œ</li>
<li><strong>æ–¹æ³•åˆ›æ–°æ€§</strong>ï¼šå¼•å…¥MCTSç­‰æœç´¢ç®—æ³•ï¼Œå®ç°æç¤ºä¼˜åŒ–çš„ç³»ç»ŸåŒ–æ¢ç´¢</li>
<li><strong>å·¥å…·ä¸“ä¸šåŒ–</strong>ï¼šè‡ªåŠ¨åŒ–æç¤ºä¼˜åŒ–ï¼ˆAPEï¼‰èµ°å‘å·¥ä¸šåŒ–ï¼Œæå‡æ•ˆç‡ä¸æ•ˆæœ</li>
<li><strong>ä»·å€¼å®ç”¨æ€§</strong>ï¼šä¸ºå¼€å‘è€…æä¾›å¯è½åœ°çš„æŠ€æœ¯æ–¹æ¡ˆï¼Œè§£å†³çœŸå®ä¸šåŠ¡é—®é¢˜</li>
</ol>
<h3 data-id="heading-22">6.2 æœªæ¥æ–¹å‘</h3>
<p>éšç€AIæŠ€æœ¯çš„å¿«é€Ÿå‘å±•ï¼ŒPrompt Engineeringå°†å‘ˆç°ä»¥ä¸‹è¶‹åŠ¿ï¼š</p>
<ol>
<li><strong>æ¨¡å‹è‡ªé€‚åº”</strong>ï¼šæç¤ºä¼˜åŒ–å°†æ›´å¤šè€ƒè™‘æ¨¡å‹ç‰¹æ€§å’Œèƒ½åŠ›è¾¹ç•Œ</li>
<li><strong>ä»»åŠ¡æ™ºèƒ½åŒ–</strong>ï¼šè‡ªåŠ¨åŒ–å·¥å…·å°†æ›´æ™ºèƒ½åœ°ç†è§£ä»»åŠ¡éœ€æ±‚ï¼Œç”Ÿæˆé’ˆå¯¹æ€§æç¤º</li>
<li><strong>å·¥ç¨‹æ ‡å‡†åŒ–</strong>ï¼šæç¤ºå·¥ç¨‹å°†å½¢æˆæ ‡å‡†åŒ–çš„å¼€å‘æµç¨‹å’Œè¯„ä¼°ä½“ç³»</li>
<li><strong>åº”ç”¨æ™®åŠåŒ–</strong>ï¼šä»ä¸“ä¸šå¼€å‘è€…æ‰©å±•åˆ°æ™®é€šç”¨æˆ·ï¼Œæˆä¸ºAIäº¤äº’çš„åŸºç¡€æŠ€èƒ½</li>
</ol>
<h3 data-id="heading-23">6.3 å¯¹å¼€å‘è€…çš„å¯ç¤º</h3>
<p>å¯¹äºæ­£åœ¨æ¢ç´¢AIåº”ç”¨å¼€å‘çš„å·¥ç¨‹å¸ˆï¼š</p>
<ol>
<li><strong>æ‹¥æŠ±æ–°èŒƒå¼</strong>ï¼šä»"æ‰‹åŠ¨ç‚¼ä¸¹"è½¬å‘"ç³»ç»Ÿä¼˜åŒ–"ï¼Œåˆ©ç”¨MCTSç­‰ç®—æ³•æ¢ç´¢æç¤ºç©ºé—´</li>
<li><strong>å–„ç”¨ä¸“ä¸šå·¥å…·</strong>ï¼šé›†æˆprompt-minder.comç­‰å¹³å°ï¼Œæå‡æç¤ºä¼˜åŒ–æ•ˆç‡å’Œæ•ˆæœ</li>
<li><strong>å…³æ³¨ç ”ç©¶è¿›å±•</strong>ï¼šç´§è·Ÿå­¦æœ¯ç•Œæœ€æ–°æˆæœï¼ŒåŠæ—¶æ›´æ–°æŠ€æœ¯æ ˆå’Œæ–¹æ³•è®º</li>
<li><strong>é‡è§†å®è·µéªŒè¯</strong>ï¼šåœ¨å®é™…ä¸šåŠ¡åœºæ™¯ä¸­æµ‹è¯•å’Œè¿­ä»£ï¼Œæ‰¾åˆ°æœ€é€‚åˆçš„æŠ€æœ¯æ–¹æ¡ˆ</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Šå®æ—¶æ¸²æŸ“ã€‹ç¬¬2ç« -å›¾å½¢æ¸²æŸ“ç®¡çº¿-2.4å…‰æ …åŒ–]]></title>    <link>https://juejin.cn/post/7598402961904304180</link>    <guid>https://juejin.cn/post/7598402961904304180</guid>    <pubDate>2026-01-23T13:08:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598402961904304180" data-draft-id="7598403436698632226" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Šå®æ—¶æ¸²æŸ“ã€‹ç¬¬2ç« -å›¾å½¢æ¸²æŸ“ç®¡çº¿-2.4å…‰æ …åŒ–"/> <meta itemprop="keywords" content="è®¡ç®—æœºå›¾å½¢å­¦"/> <meta itemprop="datePublished" content="2026-01-23T13:08:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="charlee44"/> <meta itemprop="url" content="https://juejin.cn/user/1117549770846872"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Šå®æ—¶æ¸²æŸ“ã€‹ç¬¬2ç« -å›¾å½¢æ¸²æŸ“ç®¡çº¿-2.4å…‰æ …åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1117549770846872/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    charlee44
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T13:08:40.000Z" title="Fri Jan 23 2026 13:08:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>å®æ—¶æ¸²æŸ“</strong></h2>
<h2 data-id="heading-1">2. å›¾å½¢æ¸²æŸ“ç®¡çº¿</h2>
<h3 data-id="heading-2">2.4 å…‰æ …åŒ–</h3>
<p>é¡¶ç‚¹åŠå…¶å…³è”çš„ç€è‰²æ•°æ®ï¼ˆå…¨éƒ¨æ¥è‡ªå‡ ä½•å¤„ç†é˜¶æ®µï¼‰åœ¨è¿›è¡Œå˜æ¢å’ŒæŠ•å½±åï¼Œä¸‹ä¸€é˜¶æ®µçš„ç›®æ ‡æ˜¯æ‰¾åˆ°æ‰€æœ‰åƒç´ ï¼ˆå›¾ç‰‡å…ƒç´ çš„ç¼©å†™ï¼‰ï¼Œè¿™äº›åƒç´ ä½äºè¦æ¸²æŸ“çš„å›¾å…ƒå†…éƒ¨ï¼Œä¾‹å¦‚ä¸‰è§’å½¢ã€‚æˆ‘ä»¬å°†æ­¤è¿‡ç¨‹ç§°ä¸ºå…‰æ …åŒ–ï¼Œå®ƒåˆ†ä¸ºä¸¤ä¸ªåŠŸèƒ½å­é˜¶æ®µï¼šä¸‰è§’å½¢è®¾ç½®ï¼ˆä¹Ÿç§°ä¸ºå›¾å…ƒç»„è£…ï¼‰å’Œä¸‰è§’å½¢éå†ã€‚å®ƒä»¬æ˜¾ç¤ºåœ¨å›¾2.8çš„å·¦ä¾§ã€‚è¯·æ³¨æ„ï¼Œè¿™äº›ä¹Ÿå¯ä»¥å¤„ç†ç‚¹å’Œçº¿ï¼Œä½†ç”±äºä¸‰è§’å½¢æœ€å¸¸è§ï¼Œå› æ­¤å­é˜¶æ®µçš„åç§°ä¸­å¸¦æœ‰â€œä¸‰è§’å½¢â€ã€‚å› æ­¤ï¼Œå…‰æ …åŒ–ä¹Ÿç§°ä¸ºæ‰«æè½¬æ¢ï¼Œæ˜¯å°†å±å¹•ç©ºé—´ä¸­çš„äºŒç»´é¡¶ç‚¹ï¼ˆæ¯ä¸ªé¡¶ç‚¹å…·æœ‰zå€¼ï¼ˆæ·±åº¦å€¼ï¼‰å’Œä¸æ¯ä¸ªé¡¶ç‚¹å…³è”çš„å„ç§ç€è‰²ä¿¡æ¯ï¼‰è½¬æ¢ä¸ºå±å¹•ä¸Šçš„åƒç´ ã€‚å…‰æ …åŒ–ä¹Ÿå¯ä»¥è¢«è®¤ä¸ºæ˜¯å‡ ä½•å¤„ç†å’Œåƒç´ å¤„ç†ä¹‹é—´çš„åŒæ­¥ç‚¹ï¼Œå› ä¸ºåœ¨è¿™é‡Œä¸‰è§’å½¢ç”±ä¸‰ä¸ªé¡¶ç‚¹å½¢æˆå¹¶æœ€ç»ˆå‘é€åˆ°åƒç´ å¤„ç†ã€‚</p>
<div align="center">
<p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/a6e3eaaaaa5e47d8ae073914b0383898~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgY2hhcmxlZTQ0:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMTExNzU0OTc3MDg0Njg3MiJ9&amp;rk3s=e9ecf3d6&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1769260076&amp;x-orig-sign=%2FBgjUealT1tjtN183xJCGm%2Bj7qU%3D" alt="" loading="lazy"/></p>
</div>
<div align="center">
<p>å›¾2.8. å·¦ï¼šå…‰æ …åŒ–åˆ†ä¸ºä¸¤ä¸ªåŠŸèƒ½é˜¶æ®µï¼Œç§°ä¸ºä¸‰è§’å½¢è®¾ç½®å’Œä¸‰è§’å½¢éå†ã€‚å³ï¼šåƒç´ å¤„ç†åˆ†ä¸ºä¸¤ä¸ªåŠŸèƒ½é˜¶æ®µï¼Œå³åƒç´ ç€è‰²å’Œåˆå¹¶ã€‚</p>
</div>
<p>æ˜¯å¦è®¤ä¸ºä¸‰è§’å½¢ä¸åƒç´ é‡å å–å†³äºæ‚¨å¦‚ä½•è®¾ç½®GPUçš„ç®¡çº¿ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç‚¹æŠ½æ ·æ¥ç¡®å®šâ€œå†…éƒ¨æ€§â€ã€‚æœ€ç®€å•çš„æƒ…å†µæ˜¯åœ¨æ¯ä¸ªåƒç´ çš„ä¸­å¿ƒä½¿ç”¨å•ç‚¹æ ·æœ¬ï¼Œå› æ­¤å¦‚æœè¯¥ä¸­å¿ƒç‚¹åœ¨ä¸‰è§’å½¢å†…éƒ¨ï¼Œé‚£ä¹ˆç›¸åº”çš„åƒç´ ä¹Ÿè¢«è§†ä¸ºä¸‰è§’å½¢å†…éƒ¨ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨è¶…çº§é‡‡æ ·æˆ–å¤šé‡é‡‡æ ·æŠ—é”¯é½¿æŠ€æœ¯ï¼ˆ<a href="https://link.juejin.cn?target=%255Bnetlink5.4%255D" target="_blank" title="%5Bnetlink5.4%5D" ref="nofollow noopener noreferrer">ç¬¬5.4.2èŠ‚</a>ï¼‰ä¸ºæ¯ä¸ªåƒç´ ä½¿ç”¨å¤šä¸ªæ ·æœ¬ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ä¿å®ˆå…‰æ …åŒ–ï¼Œå…¶ä¸­çš„å®šä¹‰æ˜¯ï¼Œå¦‚æœåƒç´ çš„è‡³å°‘ä¸€éƒ¨åˆ†ä¸ä¸‰è§’å½¢é‡å ï¼Œåˆ™åƒç´ ä½äºä¸‰è§’å½¢â€œå†…éƒ¨â€ï¼ˆ<a href="https://link.juejin.cn?target=%25E7%25AC%25AC23.1.2%25E8%258A%2582" target="_blank" title="%E7%AC%AC23.1.2%E8%8A%82" ref="nofollow noopener noreferrer">ç¬¬23.1.2èŠ‚</a>ï¼‰ã€‚</p>
<h4 data-id="heading-3">2.4.1 ä¸‰è§’å½¢è®¾ç½®</h4>
<p>åœ¨è¿™ä¸ªé˜¶æ®µï¼Œè®¡ç®—ä¸‰è§’å½¢çš„å¾®åˆ†ã€è¾¹æ–¹ç¨‹å’Œå…¶ä»–æ•°æ®ã€‚è¿™äº›æ•°æ®å¯ç”¨äºä¸‰è§’å½¢éå†ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fcharlee44.com%2Fpost.html%3Fid%3Dab238562e9614b21936875b990a2544a%232-4-2-%25E4%25B8%2589%25E8%25A7%2592%25E5%25BD%25A2%25E9%2581%258D%25E5%258E%2586" target="_blank" title="https://charlee44.com/post.html?id=ab238562e9614b21936875b990a2544a#2-4-2-%E4%B8%89%E8%A7%92%E5%BD%A2%E9%81%8D%E5%8E%86" ref="nofollow noopener noreferrer">ç¬¬2.4.2èŠ‚</a>ï¼‰ï¼Œä»¥åŠç”¨äºå‡ ä½•é˜¶æ®µäº§ç”Ÿçš„å„ç§ç€è‰²æ•°æ®çš„æ’å€¼ã€‚è¿™ä¸ªä»»åŠ¡é€šå¸¸æ˜¯ç¡¬ä»¶çš„å›ºå®šåŠŸèƒ½ã€‚</p>
<h4 data-id="heading-4">2.4.2 ä¸‰è§’å½¢éå†</h4>
<p>åœ¨è¿™ä¸ªé˜¶æ®µï¼Œä¼šæ£€æŸ¥æ¯ä¸ªåƒç´ ä¸­å¿ƒï¼ˆæˆ–æ ·æœ¬ï¼‰è¢«ä¸‰è§’å½¢è¦†ç›–çš„ä½ç½®ï¼Œå¹¶ä¸ºä¸ä¸‰è§’å½¢é‡å çš„åƒç´ éƒ¨åˆ†ç”Ÿæˆç‰‡å…ƒã€‚æ›´è¯¦ç»†çš„æŠ½æ ·æ–¹æ³•å¯ä»¥åœ¨<a href="https://link.juejin.cn?target=%25E7%25AC%25AC5.4%25E8%258A%2582" target="_blank" title="%E7%AC%AC5.4%E8%8A%82" ref="nofollow noopener noreferrer">ç¬¬5.4èŠ‚</a>ä¸­æ‰¾åˆ°ã€‚æŸ¥æ‰¾ä¸‰è§’å½¢å†…çš„æ ·æœ¬æˆ–åƒç´ é€šå¸¸ç§°ä¸ºä¸‰è§’å½¢éå†ã€‚æ¯ä¸ªä¸‰è§’å½¢ç‰‡å…ƒçš„å±æ€§æ˜¯ä½¿ç”¨åœ¨ä¸‰ä¸ªä¸‰è§’å½¢é¡¶ç‚¹ä¹‹é—´æ’å…¥çš„æ•°æ®ç”Ÿæˆçš„ï¼ˆ<a href="https://link.juejin.cn?target=%25E7%25AC%25AC5%25E7%25AB%25A0" target="_blank" title="%E7%AC%AC5%E7%AB%A0" ref="nofollow noopener noreferrer">ç¬¬5ç« </a>ï¼‰ã€‚è¿™äº›å±æ€§åŒ…æ‹¬ç‰‡æ®µçš„æ·±åº¦ï¼Œä»¥åŠæ¥è‡ªå‡ ä½•é˜¶æ®µçš„ä»»ä½•ç€è‰²æ•°æ®ã€‚McCormackç­‰äººåœ¨æ–‡çŒ®[1162]ä¸­æåˆ°äº†æœ‰å…³ä¸‰è§’å½¢éå†çš„æ›´å¤šä¿¡æ¯ã€‚ä¹Ÿæ˜¯åœ¨è¿™ä¸ªé˜¶æ®µï¼Œå¯¹ä¸‰è§’å½¢æ‰§è¡Œé€è§†æ ¡æ­£æ’å€¼[694]ï¼ˆ<a href="https://link.juejin.cn?target=netlink23.1" target="_blank" title="netlink23.1" ref="nofollow noopener noreferrer">ç¬¬23.1.1èŠ‚</a>ï¼‰ã€‚ç„¶åå°†å›¾å…ƒå†…çš„æ‰€æœ‰åƒç´ æˆ–æ ·æœ¬å‘é€åˆ°åƒç´ å¤„ç†é˜¶æ®µï¼Œè¿™ä¸ªä¸‹è¿°ç« èŠ‚ä¼šè¿›è¡Œè®ºè¿°ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¾®è½¯å®˜æ–¹å‡ºå“çš„ AI åˆå­¦è€…å…¥é—¨ç²¾å“è¯¾ç¨‹ï¼Œ21èŠ‚è¯¾ç¨‹æ•™ä½ æ„å»ºç”Ÿæˆå¼äººå·¥æ™ºèƒ½åº”ç”¨æ‰€éœ€æŒæ¡çš„çŸ¥è¯†ï¼]]></title>    <link>https://juejin.cn/post/7598507330859728938</link>    <guid>https://juejin.cn/post/7598507330859728938</guid>    <pubDate>2026-01-23T13:20:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598507330859728938" data-draft-id="7598398537248800787" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¾®è½¯å®˜æ–¹å‡ºå“çš„ AI åˆå­¦è€…å…¥é—¨ç²¾å“è¯¾ç¨‹ï¼Œ21èŠ‚è¯¾ç¨‹æ•™ä½ æ„å»ºç”Ÿæˆå¼äººå·¥æ™ºèƒ½åº”ç”¨æ‰€éœ€æŒæ¡çš„çŸ¥è¯†ï¼"/> <meta itemprop="keywords" content="AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-23T13:20:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¿½é€æ—¶å…‰è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2770425031690333"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¾®è½¯å®˜æ–¹å‡ºå“çš„ AI åˆå­¦è€…å…¥é—¨ç²¾å“è¯¾ç¨‹ï¼Œ21èŠ‚è¯¾ç¨‹æ•™ä½ æ„å»ºç”Ÿæˆå¼äººå·¥æ™ºèƒ½åº”ç”¨æ‰€éœ€æŒæ¡çš„çŸ¥è¯†ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2770425031690333/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¿½é€æ—¶å…‰è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T13:20:01.000Z" title="Fri Jan 23 2026 13:20:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨äººå·¥æ™ºèƒ½æµªæ½®å¸­å·å…¨çƒçš„å½“ä¸‹ï¼Œç”Ÿæˆå¼ AI æ­£ä»¥å‰æ‰€æœªæœ‰çš„é€Ÿåº¦é‡å¡‘ç€å„ä¸ªè¡Œä¸šã€‚ä¸ºåŠ©åŠ›åˆå­¦è€…å¿«é€Ÿè¸å…¥è¿™ä¸€å‰æ²¿é¢†åŸŸï¼Œå¾®è½¯å®˜æ–¹ç²¾å¿ƒæ‰“é€ äº†è¿™é—¨ AI åˆå­¦è€…å…¥é—¨ç²¾å“è¯¾ç¨‹ï¼š<strong>Generative AI for Beginners</strong>ã€‚</p>
<h2 data-id="heading-1">è¯¾ç¨‹ä»‹ç»</h2>
<p>Generative AI for Beginners è¯¾ç¨‹åŒ…å« 21 èŠ‚å¹²è´§æ»¡æ»¡çš„è¯¾æ—¶ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°å®è·µåº”ç”¨ï¼Œå…¨æ–¹ä½ã€ç³»ç»Ÿæ€§åœ°ä¼ æˆæ„å»ºç”Ÿæˆå¼äººå·¥æ™ºèƒ½åº”ç”¨æ‰€éœ€æŒæ¡çš„æ ¸å¿ƒçŸ¥è¯†ã€‚å†…å®¹æ¶µç›–å¤§è¯­è¨€æ¨¡å‹åŸç†ã€æç¤ºå·¥ç¨‹ã€RAGã€AI Agentã€å›¾åƒç”Ÿæˆã€è´Ÿè´£ä»» AIã€å®‰å…¨ä¸ç”¨æˆ·ä½“éªŒç­‰å…³é”®ä¸»é¢˜ï¼Œå¹¶æä¾› Python ä¸ TypeScript åŒè¯­è¨€ä»£ç ç¤ºä¾‹ï¼Œå¸®åŠ©å­¦ä¹ è€…è¾¹å­¦è¾¹ç»ƒã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee69de74c1ec44be918ad65b2115638f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769779200&amp;x-signature=Pb4wAqEvHE%2FJzIMV%2BjX124lR4SQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">æ”¯æŒå¤šè¯­è¨€</h2>
<p>æœ¬è¯¾ç¨‹æ”¯æŒä»¥ä¸‹ 50 å¤šç§è¯­è¨€ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/074fb8c696fb44279b0dce26a35be8a2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769779200&amp;x-signature=PAm7%2BzsYX65x64gDtMbj%2FE3fQ%2BQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3">ç”Ÿæˆå¼äººå·¥æ™ºèƒ½åˆå­¦è€…ï¼ˆPython ä¸ TypeScriptç‰ˆï¼‰è¯¾ç¨‹åˆ—è¡¨</h2>
<p>é€šè¿‡å¾®è½¯äº‘å¸ƒé“è€…çš„21èŠ‚å…¨é¢è¯¾ç¨‹ï¼Œå­¦ä¹ æ„å»ºç”Ÿæˆå¼äººå·¥æ™ºèƒ½åº”ç”¨çš„åŸºç¡€çŸ¥è¯†ã€‚</p>
<ul>
<li><strong>ç”Ÿæˆå¼äººå·¥æ™ºèƒ½åˆå­¦è€…ï¼ˆPython ä¸ TypeScriptç‰ˆï¼‰ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmicrosoft%2Fgenerative-ai-for-beginners" target="_blank" title="https://github.com/microsoft/generative-ai-for-beginners" ref="nofollow noopener noreferrer">github.com/microsoft/gâ€¦</a></li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57a1b0d478ca4f9cb09c998fdabdaaef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769779200&amp;x-signature=0ypOE%2F9Pnwf2Y3muWGtzZsm1kQ4%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2c3d258e3b645f39b36458a8f5b56bd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769779200&amp;x-signature=RDJOpNvw5EtySu4MvGgPSrxKWMs%3D" alt="" loading="lazy"/></p>
<p><strong>é¢å‘åˆå­¦è€…çš„ç”Ÿæˆå¼ AI è§†é¢‘æ•™ç¨‹ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Flearn.microsoft.com%2Fzh-cn%2Fshows%2Fgenerative-ai-for-beginners%2F" target="_blank" title="https://learn.microsoft.com/zh-cn/shows/generative-ai-for-beginners/" ref="nofollow noopener noreferrer">learn.microsoft.com/zh-cn/showsâ€¦</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b5de73f7a334848b082bb751ac01680~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769779200&amp;x-signature=oEJ62xlSjOaU4KGe%2Fc%2FQ8aR%2BAJI%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">ç”Ÿæˆå¼äººå·¥æ™ºèƒ½åˆå­¦è€…ï¼ˆ.NETç‰ˆï¼‰</h2>
<p>å®ç”¨è¯¾ç¨‹æ•™ä½ å¦‚ä½•åœ¨.NET ä¸­æ„å»ºç”Ÿæˆå¼äººå·¥æ™ºèƒ½åº”ç”¨ã€‚</p>
<ul>
<li><strong>ç”Ÿæˆå¼äººå·¥æ™ºèƒ½åˆå­¦è€…ï¼ˆ.NETç‰ˆï¼‰ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmicrosoft%2FGenerative-AI-for-beginners-dotnet" target="_blank" title="https://github.com/microsoft/Generative-AI-for-beginners-dotnet" ref="nofollow noopener noreferrer">github.com/microsoft/Gâ€¦</a></li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6d6546efa0d4b56865237cbbf220c9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769779200&amp;x-signature=dxzMA9mVgDjTIl3Il7aBpCTIKAM%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/56942043f46a491ea16dcdad5f07e469~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769779200&amp;x-signature=tp2scsY1vEVhTZvW0hriPLa6CbA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">AIå®æˆ˜ä»å…¥é—¨åˆ°ç²¾é€š</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FYSGStudyHards%2FDotNetGuide" target="_blank" title="https://github.com/YSGStudyHards/DotNetGuide" ref="nofollow noopener noreferrer">github.com/YSGStudyHarâ€¦</a></li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c8b5a1409acc4b25bf743197f6cc9501~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-96YCQ5pe25YWJ6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769779200&amp;x-signature=iWdvi%2FTb6fK68aVXojknukvHSxI%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[97æ¯«ç§’æè‡´å“åº”ï¼Qwen3-TTSå¼€æºï¼Œé‡æ–°å®šä¹‰è¯­éŸ³ç”Ÿæˆçš„â€œé€Ÿåº¦ä¸æ¿€æƒ…â€]]></title>    <link>https://juejin.cn/post/7598366933079965750</link>    <guid>https://juejin.cn/post/7598366933079965750</guid>    <pubDate>2026-01-23T12:32:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598366933079965750" data-draft-id="7598398537248702483" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="97æ¯«ç§’æè‡´å“åº”ï¼Qwen3-TTSå¼€æºï¼Œé‡æ–°å®šä¹‰è¯­éŸ³ç”Ÿæˆçš„â€œé€Ÿåº¦ä¸æ¿€æƒ…â€"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2026-01-23T12:32:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨é£å¦‚é›ª"/> <meta itemprop="url" content="https://juejin.cn/user/4064249017803927"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            97æ¯«ç§’æè‡´å“åº”ï¼Qwen3-TTSå¼€æºï¼Œé‡æ–°å®šä¹‰è¯­éŸ³ç”Ÿæˆçš„â€œé€Ÿåº¦ä¸æ¿€æƒ…â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4064249017803927/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨é£å¦‚é›ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T12:32:34.000Z" title="Fri Jan 23 2026 12:32:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2026å¹´çš„å¼€å¹´å¤§æˆï¼Œæ¯”æˆ‘ä»¬é¢„æƒ³çš„æ¥å¾—æ›´æ—©äº†ä¸€äº›ã€‚</p>
<p>å°±åœ¨1æœˆ22æ—¥ï¼Œå½“å¤§å®¶è¿˜åœ¨è®¨è®ºå¤§è¯­è¨€æ¨¡å‹çš„é€»è¾‘æ¨ç†èƒ½åŠ›æ—¶ï¼Œé˜¿é‡Œé€šä¹‰åƒé—®å›¢é˜Ÿæ‚„æ— å£°æ¯åœ°åœ¨è¯­éŸ³ç”Ÿæˆé¢†åŸŸæ‰”ä¸‹äº†ä¸€æšé‡ç£…ç‚¸å¼¹ï¼šQwen3-TTSç³»åˆ—æ¨¡å‹æ­£å¼å¼€æºã€‚</p>
<p>è¿™ä¸ä»…ä»…æ˜¯â€œåˆä¸€ä¸ªâ€å¼€æºæ¨¡å‹ï¼Œè¿™æ˜¯ä¸€æ¬¡å¯¹â€œå®æ—¶äº¤äº’â€çš„æš´åŠ›ç¾å­¦å±•ç¤ºã€‚ä½œä¸ºé•¿æœŸå…³æ³¨AIåº•å±‚æŠ€æœ¯çš„è§‚å¯Ÿè€…ï¼Œæˆ‘æ‹¿åˆ°æŠ€æœ¯æŠ¥å‘Šçš„ç¬¬ä¸€çœ¼ï¼Œå°±è¢«é‚£ä¸ªæ•°å­—å‡»ä¸­äº†â€”â€”97æ¯«ç§’ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥èŠèŠè¿™ä¸ªè®©å¼€å‘è€…ç›´å‘¼â€œçœŸé¦™â€ï¼Œè®©å•†ä¸šé—­æºæ¨¡å‹æ„Ÿåˆ°å‹åŠ›çš„Qwen3-TTSåˆ°åº•å¼ºåœ¨å“ªé‡Œã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2Fasdkfcsdf-1024x475.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/asdkfcsdf-1024x475.webp" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1ef83a83c2bd48b3b6edec08e43c8fe3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769776354&amp;x-signature=quaMLyVZZKP0kIsBMfkqdvqYITg%3D" alt="asdkfcsdf" loading="lazy"/></a></p>
<h3 data-id="heading-0">å‘Šåˆ«è¿›åº¦æ¡ï¼šå½“ç”Ÿæˆé€Ÿåº¦å¿«è¿‡ä½ çš„è¯­é€Ÿ</h3>
<p>è¿‡å»ä¸¤ä¸‰å¹´ï¼Œè¯­éŸ³åˆæˆï¼ˆTTSï¼‰æœ€å¤§çš„ç—›ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯å»¶è¿Ÿã€‚</p>
<p>ä½ å¯¹ç€AIåŠ©æ‰‹è¯´äº†ä¸€å¥è¯ï¼Œå±å¹•è½¬åœˆåœˆï¼Œä¸‰ç§’åå®ƒæ‰æ…¢æ¡æ–¯ç†åœ°å¼€å£ã€‚è¿™ç§å‰²è£‚æ„Ÿï¼Œæ˜¯é˜»ç¢AIåƒçœŸäººä¸€æ ·äº¤æµçš„æœ€å¤§é‚£å µå¢™ã€‚</p>
<p>Qwen3-TTSæœ€æ ¸å¿ƒçš„çªç ´ï¼Œåœ¨äºå®ƒè‡ªç ”çš„â€œDual-TrackåŒè½¨æ··åˆæµå¼ç”Ÿæˆâ€æ¶æ„ã€‚é€šä¿—ç‚¹è¯´ï¼Œä»¥å‰çš„æ¨¡å‹æ˜¯â€œæƒ³å¥½æ•´å¥è¯å†å¼€å£â€ï¼Œè€ŒQwen3-TTSæ˜¯â€œè¾¹æƒ³è¾¹è¯´â€ã€‚é…åˆæå…¶é«˜æ•ˆçš„12.5Hzå¤šç æœ¬è¯­éŸ³ç¼–ç å™¨ï¼Œè¿™ä¸ªæ¨¡å‹å®ç°äº†åªè¦ä½ è¾“å…¥ç¬¬ä¸€ä¸ªå­—ï¼ŒéŸ³é¢‘æ•°æ®åŒ…å‡ ä¹åŒæ—¶ä¹Ÿå‡†å¤‡å¥½äº†ã€‚</p>
<p>97æ¯«ç§’çš„ç«¯åˆ°ç«¯å»¶è¿Ÿæ˜¯ä»€ä¹ˆæ¦‚å¿µï¼Ÿäººç±»çœ¨çœ¼ä¸€æ¬¡å¤§çº¦éœ€è¦300æ¯«ç§’ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä½ è¿˜æ²¡çœ¨å®Œçœ¼çš„ç¬é—´ï¼Œå£°éŸ³å·²ç»å‡ºæ¥äº†ã€‚è¿™æ„å‘³ç€åœ¨ç›´æ’­ã€å®æ—¶åŒä¼ ã€ç”šè‡³ä¸ä»…æ˜¯å®¢æœï¼Œè€Œæ˜¯çœŸæ­£æ‹ŸäººåŒ–çš„AIä¼´ä¾£åœºæ™¯ä¸­ï¼Œæœºå™¨çš„ååº”é€Ÿåº¦ç»ˆäºè¿½ä¸Šäº†äººç±»çš„ç”Ÿç†ç›´è§‰ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2Fewifowoiedgfsd-1024x714.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/ewifowoiedgfsd-1024x714.webp" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41544d84b4194ffc8eb0db53604d41d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769776354&amp;x-signature=%2BByvGmjcwTXsLZ1OXKZG%2B%2FaX%2F2g%3D" alt="ewifowoiedgfsd" loading="lazy"/></a></p>
<h3 data-id="heading-1">ä¸Šå¸è§†è§’ï¼šæå‡ºä½ æƒ³è¦çš„å£°éŸ³</h3>
<p>é™¤äº†å¿«ï¼ŒQwen3-TTSè¿˜è§£å†³äº†ä¸€ä¸ªâ€œåƒä¸åƒâ€çš„é—®é¢˜ã€‚</p>
<p>è¿™æ¬¡å¼€æºæä¾›äº†ä¸¤ä¸ªå‚æ•°é‡çº§ï¼š0.6Bå’Œ1.7Bã€‚å…¶ä¸­1.7Bç‰ˆæœ¬ä¸ä»…æ˜¯æ€§èƒ½æ€ªå…½ï¼Œæ›´æ˜¯ä¸€ä¸ªå£°éŸ³è®¾è®¡å¸ˆã€‚</p>
<p>ä»¥å‰æˆ‘ä»¬è¦å®šåˆ¶éŸ³è‰²ï¼Œå¾€å¾€éœ€è¦å½•åˆ¶å‡ å°æ—¶çš„å¹²éŸ³ï¼Œå„ç§æ¸…æ´—æ•°æ®ï¼Œæµç¨‹ç¹çã€‚ç°åœ¨ï¼ŒQwen3-TTSæŠŠè¿™ä¸ªé—¨æ§›é™åˆ°äº†åœ°æ¿ä¸Šã€‚</p>
<p><strong>éŸ³è‰²å…‹éš†</strong>ï¼šåªéœ€è¦3ç§’ã€‚æ˜¯çš„ï¼Œä½ æ²¡çœ‹é”™ï¼Œä¸€æ®µ3ç§’çš„å‚è€ƒéŸ³é¢‘ï¼Œå®ƒå°±èƒ½ç²¾å‡†æ•æ‰åˆ°éŸ³è‰²ç‰¹å¾ã€‚è€Œä¸”ä¸ä»…æ˜¯å¤åˆ¶å£°éŸ³ï¼Œå®ƒè¿˜èƒ½è·¨è¯­è¨€ã€‚ä½ ç»™å®ƒä¸€æ®µä¸­æ–‡å½•éŸ³ï¼Œå®ƒèƒ½ç”¨åŒæ ·çš„éŸ³è‰²è¯´å‡ºæµåˆ©çš„æ³•è¯­æˆ–ä¿„è¯­ã€‚</p>
<p><strong>éŸ³è‰²åˆ›é€ </strong>ï¼šè¿™æ‰æ˜¯æœ€å¥½ç©çš„åœ°æ–¹ã€‚å¦‚æœä½ è¿å‚è€ƒéŸ³é¢‘éƒ½æ²¡æœ‰ï¼Œå®Œå…¨æ²¡é—®é¢˜ã€‚ä½ å¯ä»¥åƒå†™å°è¯´ä¸€æ ·ç”¨è‡ªç„¶è¯­è¨€æè¿°ï¼šâ€œä¸€ä¸ªæ¸…æ¾ˆçš„å¹´è½»å¥³å£°ï¼Œè¯­æ°”é‡Œå¸¦ç€ä¸€ç‚¹æ¬¢å¿«å’Œè°ƒçš®ã€‚â€æ¨¡å‹å°±èƒ½æ ¹æ®è¿™æ®µPromptï¼Œå‡­ç©ºâ€œæâ€å‡ºä¸€ä¸ªç¬¦åˆè¦æ±‚çš„å£°éŸ³ã€‚è¿™ç§åŸºäºæŒ‡ä»¤çš„æ§åˆ¶èƒ½åŠ›ï¼Œç›´æ¥æŠŠå¯¼æ¼”çš„æ´»å„¿äº¤ç»™äº†ç”¨æˆ·ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2Ffsasgsfd-1024x756.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/fsasgsfd-1024x756.webp" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a1322bf9e9494292aa44d1148a84d7fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769776354&amp;x-signature=lRaxC%2BwikdS083ygpwQ8qaQacdc%3D" alt="fsasgsfd" loading="lazy"/></a></p>
<h3 data-id="heading-2">åå›½è¯­è¨€ï¼Œæ–¹è¨€ä¹Ÿä¸åœ¨è¯ä¸‹</h3>
<p>åœ¨å…¨çƒåŒ–æ”¯æŒä¸Šï¼Œé€šä¹‰åƒé—®è¿™æ¬¡ä¹Ÿæ˜¯è¯šæ„æ»¡æ»¡ã€‚æ¨¡å‹åŸç”Ÿæ”¯æŒä¸­æ–‡ã€è‹±è¯­ã€æ—¥è¯­ã€éŸ©è¯­ã€å¾·è¯­ã€æ³•è¯­ã€ä¿„è¯­ã€è‘¡è„ç‰™è¯­ã€è¥¿ç­ç‰™è¯­ã€æ„å¤§åˆ©è¯­è¿™10ç§ä¸»æµè¯­è¨€ã€‚</p>
<p>æ›´æœ‰è¶£çš„æ˜¯ï¼Œå®ƒæ‡‚æ–¹è¨€ã€‚å››å·è¯çš„éº»è¾£ã€ç²¤è¯­çš„æŠ‘æ‰¬é¡¿æŒ«ï¼Œå®ƒéƒ½èƒ½æ‹¿æã€‚åœ¨é•¿æ–‡æœ¬æµ‹è¯•ä¸­ï¼Œå³ä¾¿æ˜¯åˆæˆ10åˆ†é’Ÿçš„é•¿è¯­éŸ³ï¼Œä¸­è‹±æ–‡çš„è¯é”™ç‡ä¹Ÿæ§åˆ¶åœ¨äº†2%å·¦å³çš„æä½æ°´å¹³ï¼Œè¿™æ„å‘³ç€å®ƒå®Œå…¨å…·å¤‡äº†åˆ¶ä½œæœ‰å£°ä¹¦ã€é•¿è§†é¢‘é…éŸ³çš„ç”Ÿäº§åŠ›æ°´å‡†ã€‚</p>
<h3 data-id="heading-3">å¼€æºçš„è¯šæ„ï¼šApache 2.0</h3>
<p>æœ€åï¼Œä¸å¾—ä¸æçš„æ˜¯è¿™æ¬¡çš„å¼€æºç­–ç•¥ã€‚</p>
<p>æ²¡æœ‰é®é®æ©æ©ï¼Œæ²¡æœ‰ä»…ä¾›ç ”ç©¶ã€‚Qwen3-TTSç›´æ¥é‡‡ç”¨äº†Apache 2.0åè®®ï¼Œè¿™æ„å‘³ç€ä¸ç®¡æ˜¯ä¸ªäººå¼€å‘è€…æƒ³åšä¸ªå¥½ç©çš„Demoï¼Œè¿˜æ˜¯åˆåˆ›å…¬å¸æƒ³æŠŠå®ƒé›†æˆåˆ°å•†ä¸šäº§å“é‡Œï¼Œå¤§é—¨éƒ½æ˜¯æ•å¼€çš„ã€‚</p>
<p>å¦‚æœä½ è¿½æ±‚æè‡´æ•ˆæœï¼Œé€‰1.7Bæ¨¡å‹ï¼›å¦‚æœä½ èµ„æºæœ‰é™ï¼Œéœ€è¦åœ¨è¾¹ç¼˜è®¾å¤‡ä¸Šè·‘ï¼Œ0.6Bæ¨¡å‹å°±æ˜¯ä¸ºä½ å‡†å¤‡çš„ã€‚ä»£ç ã€æƒé‡ã€æ–‡æ¡£ï¼Œå…¨éƒ¨åœ¨GitHubã€Hugging Faceå’ŒModelScopeä¸Šæ•´æ•´é½é½åœ°æ‘†å¥½äº†ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.worldcodeing.com%2Fwp-content%2Fuploads%2F2026%2F01%2Fsafsdfsd-1024x415.webp" target="_blank" title="https://blog.worldcodeing.com/wp-content/uploads/2026/01/safsdfsd-1024x415.webp" ref="nofollow noopener noreferrer"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/365f356dfec54918bb7e1533a3750d82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aKo6aOO5aaC6Zuq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769776354&amp;x-signature=F1Arab%2F%2B4zd6YLC0b0fFXmw692Y%3D" alt="safsdfsd" loading="lazy"/></a></p>
<p>æ€»çš„æ¥è¯´ï¼ŒQwen3-TTSçš„å‡ºç°ï¼Œæ ‡å¿—ç€é«˜è´¨é‡è¯­éŸ³ç”ŸæˆæŠ€æœ¯ä¸å†æ˜¯å°‘æ•°å¤§å‚çš„ä¸“åˆ©ã€‚ä»ä»Šå¤©å¼€å§‹ï¼Œä»»ä½•ä¸€ä¸ªæ™®é€šå¼€å‘è€…ï¼Œéƒ½æœ‰èƒ½åŠ›æ„å»ºå‡ºé‚£ä¸ªã€ŠHerã€‹ç”µå½±é‡Œä¸€æ ·ï¼Œååº”æ•æ·ã€å£°éŸ³åŠ¨å¬çš„AIä¼™ä¼´ã€‚</p>
<p>è¯­éŸ³äº¤äº’çš„â€œiPhoneæ—¶åˆ»â€ï¼Œæˆ–è®¸çœŸçš„å°±åœ¨2026å¹´çš„è¿™ä¸ªä¸€æœˆï¼Œæ‚„ç„¶å¼€å§‹äº†ã€‚</p>
<p><strong>å¦‚æœä½ ä¹Ÿå¯¹æœ€æ–°çš„AIä¿¡æ¯æ„Ÿå…´è¶£æˆ–è€…æœ‰ç–‘é—® éƒ½å¯ä»¥åŠ å…¥æˆ‘çš„å¤§å®¶åº­ ç¬¬ä¸€æ—¶é—´åˆ†äº«æœ€æ–°AIèµ„è®¯ã€å·¥å…·ã€æ•™ç¨‹ã€æ–‡æ¡£ æ¬¢è¿ä½ çš„åŠ å…¥ï¼ï¼ï¼ğŸ˜‰ğŸ˜‰ğŸ˜‰</strong></p>
<p>å…¬ä¼—å·ï¼šå¢¨é£å¦‚é›ªå°ç«™</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java æ³›å‹]]></title>    <link>https://juejin.cn/post/7598390244379983910</link>    <guid>https://juejin.cn/post/7598390244379983910</guid>    <pubDate>2026-01-23T12:36:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598390244379983910" data-draft-id="7598116600903073801" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java æ³›å‹"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-23T12:36:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Jony_"/> <meta itemprop="url" content="https://juejin.cn/user/3403743732709767"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java æ³›å‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3403743732709767/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Jony_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T12:36:40.000Z" title="Fri Jan 23 2026 12:36:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="sunburst">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#000;color:#f8f8f8}.hljs-comment,.hljs-quote{color:#aeaeae;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#e28964}.hljs-string{color:#65b042}.hljs-subst{color:#daefa3}.hljs-link,.hljs-regexp{color:#e9c062}.hljs-name,.hljs-section,.hljs-tag,.hljs-title{color:#89bdff}.hljs-class .hljs-title,.hljs-doctag{text-decoration:underline}.hljs-bullet,.hljs-number,.hljs-symbol{color:#3387cc}.hljs-params,.hljs-template-variable,.hljs-variable{color:#3e87e3}.hljs-attribute{color:#cda869}.hljs-meta{color:#8996a8}.hljs-formula{background-color:#0e2231;color:#f8f8f8;font-style:italic}.hljs-addition{background-color:#253b22;color:#f8f8f8}.hljs-deletion{background-color:#420e09;color:#f8f8f8}.hljs-selector-class{color:#9b703f}.hljs-selector-id{color:#8b98ab}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å‰è¨€</h2>
<p>æ³›å‹åœ¨ç¼–ç è¿‡ç¨‹ä¸­çš„å¥½å¤„ï¼š</p>
<ol>
<li>æé«˜ Api è®¾è®¡çš„çµæ´»æ€§</li>
<li>è¿è¡Œæ—¶å¼‚å¸¸æå‰æš´éœ²åˆ°ç¼–è¯‘æœŸ</li>
</ol>
<h2 data-id="heading-1">äºŒã€æ³›å‹åˆ†ç±»</h2>
<h3 data-id="heading-2">1. æ³›å‹ç±»</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Holder</span>&lt;T&gt; {
    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">convertData</span><span class="hljs-params">(T date)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
}
</code></pre>
<h3 data-id="heading-3">2. æ³›å‹æ–¹æ³•</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> &lt;T, E&gt; T <span class="hljs-title function_">fetchData</span><span class="hljs-params">(E e)</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<h3 data-id="heading-4">3. æ³›å‹æ¥å£</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ClickListener</span>&lt;V&gt; {}
</code></pre>
<h2 data-id="heading-5">ä¸‰ã€æ³›å‹é€šé…ç¬¦</h2>
<h3 data-id="heading-6">1. ä¸Šç•Œé€šé…ç¬¦</h3>
<p>åœ¨ Java ä¸­ï¼Œä¸Šç•Œé€šé…ç¬¦æ˜¯ extendã€‚å¸¦æœ‰ä¸Šç•Œé€šé…ç¬¦æ³›å‹ç±»å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Holder</span>&lt;T, L <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Listener</span>&gt; {
    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">convertData</span><span class="hljs-params">(T date)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    <span class="hljs-keyword">public</span> L listener;
    <span class="hljs-keyword">public</span> L <span class="hljs-title function_">fetchListener</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> listener;
    }
}
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Listener</span> { }
</code></pre>
<p>å¯¹åº” <strong>Kotlin</strong> ä¸­çš„ <strong>out</strong>ï¼Œå†™æ³•å¦‚ä¸‹ï¼š</p>
<h3 data-id="heading-7">2. ä¸‹å±Šé€šé…ç¬¦</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Holder</span>&lt;<span class="hljs-type">T, out L : Listener</span>&gt; {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">convertData</span><span class="hljs-params">(date: <span class="hljs-type">T</span>)</span></span>: T? {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> listener: L? = <span class="hljs-literal">null</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchListener</span><span class="hljs-params">()</span></span>: L? {
        <span class="hljs-keyword">return</span> listener;
    }
}
</code></pre>
<h3 data-id="heading-8">3. PECS åŸåˆ™</h3>
<p>Java çš„æ³›å‹æ˜¯ä¸å˜çš„ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
    write(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Object&gt;()); <span class="hljs-comment">// æŠ¥é”™ ï¼ï¼ï¼ï¼âŒ List&lt;Number&gt; â‰  List&lt;Object&gt; </span>
}
<span class="hljs-keyword">void</span> <span class="hljs-title function_">write</span><span class="hljs-params">(List&lt;Number&gt; dest)</span> {
    dest.add(<span class="hljs-number">1</span>);            
    dest.add(<span class="hljs-number">1.1</span>);
}
</code></pre>
<p>å¦‚æœè¿™ä¹ˆç”Ÿå‘½ write() å‡½æ•°å°±æ²¡æœ‰é—®é¢˜ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">write</span><span class="hljs-params">(List&lt;? <span class="hljs-built_in">super</span> Number&gt; dest)</span> {
    dest.add(<span class="hljs-number">1</span>);
    dest.add(<span class="hljs-number">1.1</span>);
}
</code></pre>
<p>è¿™ä¹ˆå£°æ˜çš„å¥½å¤„å¦‚ä¸‹ï¼š</p>
<ol>
<li>Number ç±»å‹åŠå…¶å­ç±»èƒ½å¤Ÿè¢«å†™å…¥åˆ°é›†åˆä¸­</li>
<li>å…è®¸<strong>List[Number]</strong> å’Œ  <strong>List[Object]</strong> ä½œä¸ºå‚æ•°</li>
</ol>
<p>ä½¿ç”¨æ³›å‹é€šé…ç¬¦ï¼Œéœ€è¦éµå®ˆ PECS åŸåˆ™ã€‚Extend åªèƒ½è¯»å–æ•°æ®ï¼ŒSuper åªèƒ½å†™å…¥æ•°æ®ï¼ˆå¯ä»¥æ¥æ”¶çš„æ•°æ®ç±»å‹æ˜¯ Objectï¼‰ã€‚</p>
<ul>
<li>Pï¼šProducerï¼Œç”Ÿäº§è€…åªèƒ½è¯»æ•°æ®</li>
<li>Eï¼šExtends</li>
<li>Cï¼šConsumerï¼Œæ¶ˆè´¹è€…åªèƒ½å†™å…¥æ•°æ®</li>
<li>Sï¼šSuper</li>
</ul>
<p>Collections.copy æºç ç­¾åå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">copy</span><span class="hljs-params">(
    List&lt;? <span class="hljs-built_in">super</span> T&gt; dest,
    List&lt;? extends T&gt; src
)</span>
</code></pre>
<ul>
<li><code>src</code>ï¼šåªè¯»ï¼Œæä¾› T â†’ <code>extends</code></li>
<li><code>dest</code>ï¼šåªå†™ï¼Œæ¥æ”¶ T â†’ <code>super</code></li>
</ul>
<h2 data-id="heading-9">å››ã€æ³›å‹æ“¦å¤„</h2>
<p>æ³›å‹æ“¦å¤„æ˜¯æŒ‡ï¼šåœ¨ç¼–è¯‘çš„æ—¶å€™ä½¿ç”¨æ³›å‹ï¼Œåœ¨è¿è¡Œçš„æ—¶å¯¹ç±»å‹è¿›è¡Œæ›¿æ¢ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-java" lang="java">List&lt;String&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(); <span class="hljs-comment">// ç¼–è¯‘æ—¶</span>

<span class="hljs-type">List</span> <span class="hljs-variable">list</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>(); <span class="hljs-comment">// è¿è¡Œæ—¶</span>
</code></pre>
<p>è¿›è¡Œæ³›å‹æ“¦é™¤çš„ä¸»è¦ç›®çš„ï¼Œæ˜¯å› ä¸ºæ³›å‹æ˜¯åœ¨1.5æ‰å‡ºç°ï¼Œä¸ºäº†ç¡®ä¿ä¹‹å‰çš„ä»£ç å’Œ JVM å®Œå…¨å…¼å®¹ã€‚å½“ç„¶æ“¦é™¤ä¹Ÿå¸¦æ¥äº†ä¸€äº›é—®é¢˜ï¼š</p>
<ol>
<li>æ— æ³•åœ¨è¿è¡Œæ—¶è·å– T çš„ç±»å‹</li>
<li>æ— æ³• new T()</li>
<li>æ— æ³•åˆ›å»ºæ³›å‹æ•°ç»„</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[WebAssemblyå…¥é—¨ï¼ˆäºŒï¼‰â€”â€”Rustç¼–è¯‘wasmå…¨æµç¨‹]]></title>    <link>https://juejin.cn/post/7598390244379836454</link>    <guid>https://juejin.cn/post/7598390244379836454</guid>    <pubDate>2026-01-23T11:04:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598390244379836454" data-draft-id="7598370121435889714" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="WebAssemblyå…¥é—¨ï¼ˆäºŒï¼‰â€”â€”Rustç¼–è¯‘wasmå…¨æµç¨‹"/> <meta itemprop="keywords" content="å‰ç«¯,Rust"/> <meta itemprop="datePublished" content="2026-01-23T11:04:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¸ƒåˆ—ç‘Ÿå†œçš„æ˜Ÿç©º"/> <meta itemprop="url" content="https://juejin.cn/user/976022056218471"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            WebAssemblyå…¥é—¨ï¼ˆäºŒï¼‰â€”â€”Rustç¼–è¯‘wasmå…¨æµç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/976022056218471/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¸ƒåˆ—ç‘Ÿå†œçš„æ˜Ÿç©º
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T11:04:20.000Z" title="Fri Jan 23 2026 11:04:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡å°†æ‰‹æŠŠæ‰‹ä»‹ç»å¦‚ä½•å°†rustç¼–å†™çš„å‡½æ•°æ‰“åŒ…ä¸ºwasmä¾›jsä½¿ç”¨ï¼Œå¹¶è§£é‡Šå…¶å…³é”®é…ç½®å’Œå®è·µä¸­çš„å¸¸è§é—®é¢˜ã€‚</p>
<h2 data-id="heading-0">5åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹</h2>
<h3 data-id="heading-1">1. ç¯å¢ƒå‡†å¤‡</h3>
<h4 data-id="heading-2">rustå’Œcargo</h4>
<p>rustç¯å¢ƒå®‰è£…æ•™ç¨‹å‚è€ƒå¦‚ä¸‹ï¼š</p>
<ul>
<li>å®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Frust-lang.org%2Fzh-CN%2Ftools%2Finstall%2F" target="_blank" title="https://rust-lang.org/zh-CN/tools/install/" ref="nofollow noopener noreferrer">rust-lang.org/zh-CN/toolsâ€¦</a></li>
<li>ruståœ£ç»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fcourse.rs%2Ffirst-try%2Finstallation.html" target="_blank" title="https://course.rs/first-try/installation.html" ref="nofollow noopener noreferrer">course.rs/first-try/iâ€¦</a></li>
</ul>
<p>å¯æ‰§è¡Œ<code>rustc --version</code>å’Œ<code>cargo --version</code>éªŒè¯å®‰è£…ï¼Œå¦‚æœæ²¡é—®é¢˜ä¼šæœ‰å¦‚ä¸‹ç±»ä¼¼è¾“å‡º</p>
<pre><code class="hljs language-scss" lang="scss">rustc <span class="hljs-number">1.92</span><span class="hljs-selector-class">.0</span> (ded5c06cf <span class="hljs-number">2025</span>-<span class="hljs-number">12</span>-<span class="hljs-number">08</span>)
cargo <span class="hljs-number">1.92</span><span class="hljs-selector-class">.0</span> (<span class="hljs-number">344</span>c4567c <span class="hljs-number">2025</span>-<span class="hljs-number">10</span>-<span class="hljs-number">21</span>)
</code></pre>
<h4 data-id="heading-3">wasmç¼–è¯‘ç›®æ ‡å’Œ wasm-pack</h4>
<p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼›</p>
<pre><code class="hljs language-sql" lang="sql">rustup target <span class="hljs-keyword">add</span> wasm32<span class="hljs-operator">-</span><span class="hljs-literal">unknown</span><span class="hljs-operator">-</span><span class="hljs-literal">unknown</span>
</code></pre>

<pre><code class="hljs language-perl" lang="perl"> cargo install wasm-<span class="hljs-keyword">pack</span>
</code></pre>
<hr/>
<h3 data-id="heading-4">2. rust libé¡¹ç›®åˆ›å»º</h3>
<p>cargoç›¸å½“äºjsçš„npmï¼Œå¯ä»¥ç”¨cargoåˆ›å»ºä¸€ä¸ªlibï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet">cargo <span class="hljs-built_in">new</span> test-rust-<span class="hljs-keyword">lib</span> --<span class="hljs-keyword">lib</span>
</code></pre>
<p>--libæ˜¯ç”Ÿæˆåº“ï¼Œé»˜è®¤æ˜¯--binï¼Œä¹Ÿå°±æ˜¯ç”Ÿæˆé¡¹ç›®ã€‚ä¸¤è€…çš„åŒºåˆ«æ˜¯å‰è€…ä¼šåœ¨srcä¸‹ç”Ÿæˆlib.rsï¼Œåè€…æ˜¯mian.rsã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa62f4cfb90c4f6891cc44ad9045f5db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5biD5YiX55Gf5Yac55qE5pif56m6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769771059&amp;x-signature=zJLk6E0HG7jZiuqZW4VXRjpnQyc%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-5">3. ä¿®æ”¹Cargo.toml</h3>
<p>ä¿®æ”¹Cargo.tomlï¼Œæ·»åŠ ä¾èµ–å’Œlibé…ç½®</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[package]</span>
<span class="hljs-attr">name</span> = <span class="hljs-string">"test-rust-lib"</span>
<span class="hljs-attr">version</span> = <span class="hljs-string">"0.1.0"</span>
<span class="hljs-attr">edition</span> = <span class="hljs-string">"2024"</span>
<span class="hljs-section">[lib]</span>
<span class="hljs-attr">crate-type</span> = [<span class="hljs-string">"cdylib"</span>]
<span class="hljs-section">[dependencies]</span>
<span class="hljs-attr">wasm-bindgen</span> = <span class="hljs-string">"0.2"</span>
</code></pre>
<hr/>
<h3 data-id="heading-6">4.ç¼–å†™rustä»£ç </h3>
<p>è¿™é‡Œç”¨é¡¹ç›®é»˜è®¤çš„addä¸ºä¾‹ï¼Œä½¿ç”¨ wasm_bindgen å®æ ‡è®°è¦å¯¼å‡ºçš„å‡½æ•°ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> wasm_bindgen::prelude::*;
<span class="hljs-meta">#[wasm_bindgen]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">add</span>(left: <span class="hljs-type">u64</span>, right: <span class="hljs-type">u64</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">u64</span> {
    left + right
}
</code></pre>
<hr/>
<h3 data-id="heading-7">5.ç¼–è¯‘å’Œå‘å¸ƒ</h3>
<p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯åœ¨å½“å‰é¡¹ç›®çš„pkgæ–‡ä»¶ä¸­ç”Ÿæˆwasmæ–‡ä»¶</p>
<pre><code class="hljs language-css" lang="css"> wasm-pack build <span class="hljs-attr">--target</span> web
</code></pre>
<hr/>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/566abaf6bb754fc98aa38520cec8a3f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5biD5YiX55Gf5Yac55qE5pif56m6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769771059&amp;x-signature=BTvlJ%2F8k%2Fsg3FelX08ZXKPquZs4%3D" alt="image.png" loading="lazy"/>
ç”Ÿæˆçš„æ–‡ä»¶é‡Œè‡ªå¸¦package.jsonï¼Œå¯ä»¥ç›´æ¥å‘å¸ƒnpmåŒ…</p>
<pre><code class="hljs">npm login
npm publish
</code></pre>
<h4 data-id="heading-8">æœ¬åœ°æµ‹è¯•</h4>
<p>æ–¹ä¾¿èµ·è§ï¼Œå¯ä»¥ç›´æ¥åœ¨é¡¹ç›®çš„pkgç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªhtmlè¿›è¡Œæµ‹è¯•ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!doctype <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>curve lib test<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span>&gt;</span><span class="javascript">
     <span class="hljs-comment">//åŠ è½½å¹¶æ‰§è¡Œ...</span>
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>åŠ è½½æ‰“åŒ…å‡ºæ¥çš„test_rust_lib.jsï¼š</p>
<pre><code class="hljs language-js" lang="js"> <span class="hljs-comment">//åŠ è½½å¹¶æ‰§è¡Œ...</span>
  <span class="hljs-keyword">import</span> init, { add } <span class="hljs-keyword">from</span> <span class="hljs-string">"./test_rust_lib.js"</span>;<span class="hljs-comment">//æˆ–npmåŒ…</span>

  <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">run</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">init</span>();
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">add</span>(<span class="hljs-number">1n</span>, <span class="hljs-number">2n</span>));
  }
  <span class="hljs-title function_">run</span>();
</code></pre>
<p>æ³¨æ„å› ä¸ºrustä¸­å®šä¹‰çš„ç±»å‹æ˜¯u64,jsä¸­å¯¹åº”çš„æ˜¯BigIng</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7076a2d0a5c46eba051a8fdbf5a4792~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5biD5YiX55Gf5Yac55qE5pif56m6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769771059&amp;x-signature=mk4FjRtW90f2nJkbeiEzEW9LthE%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-9">rust wasmè¿›é˜¶</h2>
<p>æœ¬èŠ‚å°†è¯¦ç»†è§£é‡Šwasmæ‰“åŒ…ä¸­çš„å…³é”®è§’è‰²ã€‚</p>
<h3 data-id="heading-10">ç¼–è¯‘ç›®æ ‡ wasm32-unknown-unknown</h3>
<p>å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡çœ‹åˆ°<code>wasm32-unknown-unknown</code>å¯èƒ½æœ‰ç‚¹æ‡µé€¼ï¼Œ
<code>wasm32-unknown-unknown</code> æ˜¯ <strong>Rust çš„ç¼–è¯‘ç›®æ ‡ï¼ˆtarget tripleï¼‰</strong> ï¼Œä»£è¡¨ä½ è¦æŠŠä»£ç ç¼–è¯‘æˆ <strong>WebAssembly (WASM)</strong> æ ¼å¼çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p>
<p>Rust çš„ target ä¸‰å…ƒç»„ï¼ˆtripleï¼‰ä¸€èˆ¬å½¢å¦‚ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">æ¶æ„</span>&gt;</span>-<span class="hljs-tag">&lt;<span class="hljs-name">å‚å•†</span>&gt;</span>-<span class="hljs-tag">&lt;<span class="hljs-name">æ“ä½œç³»ç»Ÿ</span>&gt;</span>
</code></pre>
<p>å¯¹äº <code>wasm32-unknown-unknown</code> æ¥è¯´ï¼š</p>

























<table><thead><tr><th>éƒ¨åˆ†</th><th>å«ä¹‰</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>wasm32</code></td><td>æ¶æ„</td><td>32 ä½ WebAssembly æŒ‡ä»¤é›†ï¼ˆWASM ç›®å‰åªå®šä¹‰äº† 32 ä½ï¼‰</td></tr><tr><td><code>unknown</code></td><td>å‚å•†</td><td>æ²¡æœ‰ç‰¹å®šå‚å•†ï¼ˆWebAssembly æ˜¯å¼€æ”¾æ ‡å‡†ï¼‰</td></tr><tr><td><code>unknown</code></td><td>æ“ä½œç³»ç»Ÿ</td><td>æ²¡æœ‰åº•å±‚ OSï¼ˆWASM åœ¨è™šæ‹Ÿæœºç¯å¢ƒä¸­æ‰§è¡Œï¼‰</td></tr></tbody></table>
<p>æ¢å¥è¯è¯´ï¼Œå®ƒçš„æ„æ€æ˜¯ï¼š</p>
<blockquote>
<p>â€œç¼–è¯‘ä¸º 32 ä½ WebAssembly ç›®æ ‡ï¼Œç‹¬ç«‹äºå…·ä½“å‚å•†æˆ–æ“ä½œç³»ç»Ÿçš„ç¯å¢ƒã€‚â€</p>
</blockquote>
<p>ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§çš„targetå’Œé€‚ç”¨ç¯å¢ƒ</p>















































<table><thead><tr><th>Target</th><th>ä½æ•°</th><th>ç¯å¢ƒ</th><th>æ ‡å‡†åº“</th><th>è¯´æ˜ / åœºæ™¯</th></tr></thead><tbody><tr><td><strong><code>wasm32-unknown-unknown</code></strong></td><td>32 ä½</td><td>æµè§ˆå™¨ / çº¯ Web ç¯å¢ƒ</td><td>âŒ æ—  <code>std</code></td><td>âœ… æµè§ˆå™¨æœ€å¸¸ç”¨ç›®æ ‡ï¼Œé…åˆ <code>wasm-bindgen</code></td></tr><tr><td><strong><code>wasm64-unknown-unknown</code></strong></td><td>64 ä½</td><td>æµè§ˆå™¨ï¼ˆæœªæ¥æ ‡å‡†ï¼‰</td><td>âŒ æ—  <code>std</code></td><td>ğŸ§ª å®éªŒä¸­ï¼Œæ”¯æŒ 64 ä½å¯»å€ï¼ˆ&gt;4GB å†…å­˜ï¼‰</td></tr><tr><td><strong><code>wasm32-wasi</code></strong></td><td>32 ä½</td><td>æœåŠ¡ç«¯ / CLI</td><td>âœ… æœ‰ <code>std</code></td><td>âœ… æ”¯æŒæ–‡ä»¶ã€ç¯å¢ƒå˜é‡ã€socket</td></tr><tr><td><strong><code>wasm64-wasi</code></strong></td><td>64 ä½</td><td>æœåŠ¡ç«¯ / CLI</td><td>âœ… æœ‰ <code>std</code></td><td>ğŸ§ª æ–°å…´ï¼ŒWASI 64-bit æ”¯æŒå¤§å†…å­˜æœåŠ¡</td></tr><tr><td><strong><code>wasm32-unknown-emscripten</code></strong></td><td>32 ä½</td><td>æµè§ˆå™¨ (æ—§æ–¹æ¡ˆ)</td><td>âœ… æœ‰ <code>std</code></td><td>âš ï¸ å·²è¿‡æ—¶ï¼Œä½“ç§¯å¤§ï¼Œä¾èµ– JS runtime</td></tr></tbody></table>
<p><strong>å¦‚æœæ˜¯æµè§ˆå™¨åŠ è½½ï¼Œæ— è„‘<code>wasm32-unknown-unknown</code></strong></p>
<h3 data-id="heading-11">crate-type</h3>
<p>ä¸Šæ–‡åœ¨tomlæ–‡ä»¶ä¸­æœ‰å¦‚ä¸‹é…ç½®ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[lib]</span>
<span class="hljs-attr">crate-type</span> = [<span class="hljs-string">"cdylib"</span>, <span class="hljs-string">"rlib"</span>]
</code></pre>
<p>å¯èƒ½æœ‰äººä¼šé—®ï¼š<strong>ä»€ä¹ˆæ˜¯crate-type</strong></p>
<p>åœ¨ Rust ä¸­ï¼Œä¸€ä¸ª crateï¼ˆåŒ…ï¼‰å¯ä»¥è¢«ç¼–è¯‘æˆå¤šç§å½¢å¼ï¼š</p>
<ul>
<li>å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆ<code>bin</code>ï¼‰</li>
<li>é™æ€åº“ï¼ˆ<code>staticlib</code>ï¼‰</li>
<li>åŠ¨æ€åº“ï¼ˆ<code>dylib</code> / <code>cdylib</code>ï¼‰</li>
<li>Rust åº“æ–‡ä»¶ï¼ˆ<code>rlib</code>ï¼‰</li>
<li>WebAssembly æ¨¡å—ï¼ˆé€šè¿‡ <code>cdylib</code> æˆ– <code>wasm32-*</code> ç›®æ ‡ï¼‰</li>
</ul>
<p><code>crate-type</code> å°±æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ â€œæˆ‘è¦ç”Ÿæˆå“ªç§ç±»å‹çš„è¾“å‡ºâ€ã€‚</p>
<hr/>
<p>ä¸»è¦ç±»å‹è¯´æ˜:</p>



































<table><thead><tr><th>ç±»å‹</th><th>è¯´æ˜</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong><code>rlib</code></strong></td><td>Rust ä¸“ç”¨é™æ€åº“æ ¼å¼ï¼ˆé»˜è®¤ï¼‰</td><td>âœ… ä¾›å…¶ä»– Rust crate ä¾èµ–</td></tr><tr><td><strong><code>cdylib</code></strong></td><td>C-compatible åŠ¨æ€åº“ï¼ˆ<strong>æ¨èç”¨äº FFI / WASM</strong>ï¼‰</td><td>âœ… ç”¨äºå¯¼å‡ºå‡½æ•°ç»™å…¶ä»–è¯­è¨€ï¼ˆC, Python, JSç­‰ï¼‰</td></tr><tr><td><strong><code>dylib</code></strong></td><td>Rust åŠ¨æ€åº“ï¼ˆå¸¦ Rust å…ƒæ•°æ®ï¼‰</td><td>âš ï¸ è¾ƒå°‘ä½¿ç”¨ï¼Œåªèƒ½è¢« Rust åŠ è½½</td></tr><tr><td><strong><code>staticlib</code></strong></td><td>çº¯é™æ€åº“ï¼ˆ.aï¼‰</td><td>âœ… æ–¹ä¾¿åµŒå…¥ C/C++ ç¨‹åº</td></tr><tr><td><strong><code>bin</code></strong></td><td>å¯æ‰§è¡Œç¨‹åº</td><td>ç”¨äº CLI åº”ç”¨</td></tr></tbody></table>
<h3 data-id="heading-12">è‡ªå®šä¹‰ç±»å‹çš„å¯¼å‡ºé—®é¢˜</h3>
<p>å¦‚æœå¯¼å‡ºçš„å‡½æ•°é‡Œæœ‰è‡ªå®šä¹‰ç±»å‹ï¼Œæ¯”å¦‚ä¸‹é¢ä»£ç ï¼Œå°±ä¼šæç¤º</p>
<blockquote>
<p>the trait bound <code>CurveFitConfig: FromWasmAbi</code> is not satisfiedâ€</p>
</blockquote>
<p>æ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼š</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-meta">#[wasm_bindgen]</span> 
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">curve_fitting</span>(x: <span class="hljs-type">f64</span>, config: CurveFitConfig) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Option</span>&lt;<span class="hljs-type">f64</span>&gt; {
...
}
</code></pre>
<p>è¿™é‡Œæœ€ä½³çš„è§£å†³åŠæ³•æ˜¯<strong>JsValueå’Œserde-wasm-bindgen</strong>,ä¿æŒåŸå‡½æ•°ä¸å˜ï¼Œå¦å¯¼å‡ºä¸€ä¸ªç»™jsè°ƒç”¨çš„å‡½æ•°ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> serde_wasm_bindgen::from_value;

<span class="hljs-meta">#[wasm_bindgen]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">curve_fitting_wasm</span>(x: <span class="hljs-type">f64</span>, config: JsValue) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Option</span>&lt;<span class="hljs-type">f64</span>&gt; {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">cfg</span>: CurveFitConfig = <span class="hljs-title function_ invoke__">from_value</span>(config).<span class="hljs-title function_ invoke__">ok</span>()?;
    <span class="hljs-title function_ invoke__">curve_fitting</span>(x, cfg)
}
</code></pre>
<p>å¯¹ç›¸åº”çš„ç±»å‹å¢åŠ åºåˆ—åŒ–å®</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">use</span> serde::{Deserialize, Serialize};

<span class="hljs-meta">#[derive(Serialize, Deserialize)]</span>
<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">CurveFitConfig</span> {
   ...
}

</code></pre>
<h3 data-id="heading-13">wasmå¯¼å‡ºå‡½æ•°çš„æµ‹è¯•é—®é¢˜</h3>
<p>wasmå¯¼å‡ºå‡½æ•°ï¼Œå¦‚æœæ˜¯åœ¨rustç¯å¢ƒé‡Œæµ‹è¯•ï¼Œä¼šæŠ¥é”™</p>
<blockquote>
<p>cannot call wasm-bindgen imported functions on non-wasm targets</p>
</blockquote>
<p>æœ€ä½³å®è·µå°±æ˜¯åˆ†å±‚è®¾è®¡ï¼Œå•ç‹¬å†™wasmå¯¼å‡ºå‡½æ•°ï¼š</p>
<ul>
<li>æ ¸å¿ƒé€»è¾‘ä¸ JS ç»‘å®šåˆ†ç¦»</li>
<li>æ™®é€š Rust æµ‹è¯•ä¸ä¾èµ– wasm</li>
<li>wasm å‡½æ•°åªæ˜¯ä¸€ä¸ªâ€œå¤–å±‚åŒ…è£…å™¨â€</li>
</ul>
<h3 data-id="heading-14">wasm-bindgen</h3>
<p>å¦‚æœä½ çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« <a href="https://juejin.cn/user/976022056218471/posts" target="_blank" title="https://juejin.cn/user/976022056218471/posts">ã€Š# WebAssemblyå…¥é—¨ï¼ˆä¸€ï¼‰â€”â€”Emscriptenã€‹</a>å¯èƒ½äº†è§£èƒ¶æ°´ä»£ç çš„æ¦‚å¿µï¼Œwasm-bindgenå°±æ˜¯æä¾›jså’Œrustäº¤äº’çš„èƒ¶æ°´ä»£ç ç”¨çš„ã€‚</p>
<p>å…¶æ ¸å¿ƒåŠŸèƒ½å¦‚ä¸‹ï¼š</p>
<ul>
<li>â€Œ<strong>ç±»å‹è½¬æ¢</strong>â€Œï¼š<code>wasm-bindgen</code>Â è‡ªåŠ¨å¤„ç† Rust å’Œ JavaScript ä¹‹é—´çš„ç±»å‹è½¬æ¢ï¼Œä¾‹å¦‚å°† Rust çš„å­—ç¬¦ä¸²ã€æ•°ç»„ã€ç»“æ„ä½“ç­‰æ˜ å°„ä¸º JavaScript ä¸­çš„å¯¹åº”ç±»å‹ã€‚</li>
<li>â€Œ<strong>å¯¼å‡ºä¸å¯¼å…¥å‡½æ•°</strong>â€Œï¼šé€šè¿‡ä½¿ç”¨Â <code>#[wasm_bindgen]</code>Â å±æ€§å®ï¼Œå¼€å‘è€…å¯ä»¥è½»æ¾åœ°å°† Rust å‡½æ•°å¯¼å‡ºç»™ JavaScript è°ƒç”¨ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åœ¨ Rust ä¸­å¯¼å…¥ JavaScript å‡½æ•°ã€‚</li>
<li>â€Œ<strong>å†…å­˜ç®¡ç†</strong>â€Œï¼šå¯¹äºå¤æ‚ç±»å‹å¦‚å­—ç¬¦ä¸²æˆ– DOM å¯¹è±¡ï¼Œ<code>wasm-bindgen</code>Â ä¼šè‡ªåŠ¨ç®¡ç†å…¶ç”Ÿå‘½å‘¨æœŸï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚</li>
<li>â€Œ<strong>å¼‚æ­¥æ”¯æŒ</strong>â€Œï¼šå®ƒæ”¯æŒå¼‚æ­¥ Rust ä»£ç ï¼Œå¹¶èƒ½ä¸ JavaScript çš„å¼‚æ­¥æœºåˆ¶ååŒå·¥ä½œã€‚</li>
<li>â€Œ<strong>äº‹ä»¶ä¸å›è°ƒ</strong>â€Œï¼šæ”¯æŒå®šä¹‰å’Œä½¿ç”¨ JavaScript çš„äº‹ä»¶å¤„ç†å™¨å’Œå›è°ƒå‡½æ•°ã€‚</li>
</ul>
<h4 data-id="heading-15">initå‡½æ•°</h4>
<p>åœ¨ä½¿ç”¨Â <code>wasm-pack</code>Â æ‰“åŒ… Rust ç¼–å†™çš„ WebAssembly æ¨¡å—æ—¶ï¼Œç”Ÿæˆçš„ JavaScript èƒ¶æ°´ä»£ç ä¸­ä¼šåŒ…å«ä¸€ä¸ªåä¸ºÂ <code>init</code>Â çš„å¼‚æ­¥å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æ˜¯ WebAssembly æ¨¡å—åŠ è½½å’Œåˆå§‹åŒ–çš„æ ¸å¿ƒå…¥å£ï¼Œå®ƒè´Ÿè´£å®Œæˆä»¥ä¸‹å…³é”®ä»»åŠ¡ï¼š</p>
<ul>
<li>â€Œ<strong>å¼‚æ­¥åŠ è½½Â <code>.wasm</code>Â æ–‡ä»¶</strong>â€Œï¼šé€šè¿‡Â <code>fetch</code>Â æˆ–Â <code>import</code>Â åŠ¨æ€åŠ è½½ç¼–è¯‘åçš„ WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</li>
<li>â€Œ<strong>å®ä¾‹åŒ– Wasm æ¨¡å—</strong>â€Œï¼šå°†åŠ è½½çš„å­—èŠ‚ç ä¼ é€’ç»™æµè§ˆå™¨çš„ WebAssembly APIï¼Œåˆ›å»ºå¯æ‰§è¡Œçš„æ¨¡å—å®ä¾‹ã€‚</li>
<li>â€Œ<strong>ç»‘å®š JavaScript æ¥å£</strong>â€Œï¼šè¿æ¥ç”±Â <code>#[wasm_bindgen]</code>Â æ ‡è®°çš„ Rust å‡½æ•°ä¸ JavaScript ç¯å¢ƒï¼Œä½¿å®ƒä»¬èƒ½è¢«ç›´æ¥è°ƒç”¨ã€‚</li>
<li>â€Œ<strong>åˆå§‹åŒ–å†…å­˜ä¸å…¨å±€çŠ¶æ€</strong>â€Œï¼šè®¾ç½® Wasm æ¨¡å—çš„çº¿æ€§å†…å­˜ã€å¯¼å‡ºçš„å…¨å±€å˜é‡å’Œå†…éƒ¨çŠ¶æ€ï¼Œç¡®ä¿æ¨¡å—è¿è¡Œæ—¶ç¯å¢ƒå°±ç»ªã€‚</li>
</ul>
<p><code>init</code>Â å‡½æ•°è¿”å›ä¸€ä¸ªÂ <code>Promise</code>ï¼Œå› æ­¤åœ¨ä½¿ç”¨æ—¶å¿…é¡»ä½¿ç”¨Â <code>await</code>Â æˆ–Â <code>.then()</code>Â ç­‰å¾…å…¶å®Œæˆã€‚åªæœ‰åœ¨Â <code>init()</code>Â æˆåŠŸè§£æåï¼Œä½ æ‰èƒ½å®‰å…¨åœ°è°ƒç”¨ä»»ä½•ä» Rust å¯¼å‡ºçš„å‡½æ•°ã€‚</p>
<p>initçš„promiseè¿”å›å€¼ä¸­ä¹Ÿå¯ä»¥è·å–åˆ°å¯¼å‡ºçš„å‡½æ•°
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/32bb262be2b34924be9334a8e89f519a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5biD5YiX55Gf5Yac55qE5pif56m6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769771059&amp;x-signature=4YCvLiSNVTth3xEYW4vloy%2FjRgg%3D" alt="image.png" loading="lazy"/></p>
<p>initå‡½æ•°ï¼Œ<strong>åˆæ¬¡æ‰§è¡Œå®Œæˆåï¼Œå¯ä»¥é‡å¤æ‰§è¡Œï¼Œæ²¡æœ‰å‰¯ä½œç”¨</strong>ï¼Œè¿™ä¸€ç‚¹å¾ˆå¤šaiéƒ½å›ç­”çš„ä¸å¯¹ï¼Œä½†å¦‚æœåˆæ¬¡åŠ è½½æ—¶åŒæ—¶æ‰§è¡Œå¤šæ¬¡ï¼Œå°±ä¼šåˆ›å»ºå¤šä¸ªwasm instanceã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a8293b57022408c91078f0d3cbae7d8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5biD5YiX55Gf5Yac55qE5pif56m6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769771059&amp;x-signature=TYD4Lo2Sw1H1FFAmmKx%2BPx22Z0A%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»¿æ™®è´´æ ‡ç­¾å®ç°ä¸€ä¸ªè‡ªå·±çš„app_æ¥ç€å†™]]></title>    <link>https://juejin.cn/post/7598193992829141046</link>    <guid>https://juejin.cn/post/7598193992829141046</guid>    <pubDate>2026-01-23T11:21:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598193992829141046" data-draft-id="7598193992829091894" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»¿æ™®è´´æ ‡ç­¾å®ç°ä¸€ä¸ªè‡ªå·±çš„app_æ¥ç€å†™"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-23T11:21:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç«æŸ´å°±æ˜¯æˆ‘"/> <meta itemprop="url" content="https://juejin.cn/user/272334614705575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»¿æ™®è´´æ ‡ç­¾å®ç°ä¸€ä¸ªè‡ªå·±çš„app_æ¥ç€å†™
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/272334614705575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç«æŸ´å°±æ˜¯æˆ‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T11:21:15.000Z" title="Fri Jan 23 2026 11:21:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å·²ç»å®ç°çš„åŠŸèƒ½
<a href="https://juejin.cn/post/7581769891499032595" target="_blank" title="https://juejin.cn/post/7581769891499032595">juejin.cn/post/758176â€¦</a></p>
<p>æ–°åŠŸèƒ½:</p>
<p>1 <code>æ”¯æŒè¡¨æ ¼ çº¿æ¡ä¿å­˜</code></p>
<p>2 <code>ä¿®å¤ä¸€äº›bug æ¯”å¦‚æ—‹è½¬ä¹‹åéƒ¨åˆ†åŒºåŸŸä¸å“åº”äº‹ä»¶</code></p>
<p>3 <code>è§£å†³ä¿®æ”¹æ›´æ–°åï¼Œåˆ—è¡¨çš„å›¾ç‰‡æ²¡æœ‰åŠæ—¶åˆ·æ–°ï¼ˆå› ä¸ºè·¯å¾„ä¸€ç›´æœ‰ç¼“å­˜ï¼‰</code></p>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c341470293c747278e939e7face773e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54Gr5p-05bCx5piv5oiR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769772075&amp;x-signature=G6tWaQi4bjHDtYDo2QzXVhdc%2F6A%3D" alt="image.png" width="30%" loading="lazy"/>
<p>ä½“éªŒåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FnewPersonKing%2Fflutter_label" target="_blank" title="https://github.com/newPersonKing/flutter_label" ref="nofollow noopener noreferrer">github.com/newPersonKiâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026å¹´ï¼Œæˆ‘ä¸ºä»€ä¹ˆè¶Šæ¥è¶Šç¦»ä¸å¼€NestJS + Monorepo]]></title>    <link>https://juejin.cn/post/7598355220830322740</link>    <guid>https://juejin.cn/post/7598355220830322740</guid>    <pubDate>2026-01-23T11:40:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598355220830322740" data-draft-id="7598355220830306356" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026å¹´ï¼Œæˆ‘ä¸ºä»€ä¹ˆè¶Šæ¥è¶Šç¦»ä¸å¼€NestJS + Monorepo"/> <meta itemprop="keywords" content="å‰ç«¯,AIç¼–ç¨‹,NestJS"/> <meta itemprop="datePublished" content="2026-01-23T11:40:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‰›å¥¶"/> <meta itemprop="url" content="https://juejin.cn/user/1169536100866487"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026å¹´ï¼Œæˆ‘ä¸ºä»€ä¹ˆè¶Šæ¥è¶Šç¦»ä¸å¼€NestJS + Monorepo
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1169536100866487/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‰›å¥¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T11:40:08.000Z" title="Fri Jan 23 2026 11:40:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">2026å¹´ï¼Œæˆ‘ä¸ºä»€ä¹ˆè¶Šæ¥è¶Šç¦»ä¸å¼€ <code>NestJS</code> + <code>Monorepo</code></h2>
<p>2026 å¹´ï¼Œ<code>AI</code> è¾…åŠ©å¼€å‘å·¥å…·å·²ç»å½»åº•èå…¥äº†æ—¥å¸¸å†™ä»£ç çš„èŠ‚å¥ã€‚<code>Cursor</code>ã€<code>Claude Code</code>ã€<code>Trae</code>â€¦â€¦å®ƒä»¬ä¸å†æ˜¯å¶å°”ç”¨çš„æ’ä»¶ï¼Œè€Œæ˜¯æ¯å¤©æ‰“å¼€ <code>IDE</code> åç¬¬ä¸€ä¸ªè·³å‡ºæ¥çš„â€œé˜Ÿå‹â€ã€‚</p>
<p>ç”¨å¾—è¶Šå¤šï¼Œè¶Šèƒ½æ„Ÿå—åˆ°ä¸€ç§å¾®å¦™çš„è½å·®ï¼šå·¥å…·æœ¬èº«è¶Šæ¥è¶Šèªæ˜ï¼Œç”Ÿæˆçš„ä»£ç å´å¸¸å¸¸åœ¨ç»†èŠ‚ä¸Šå‡ºé—®é¢˜ã€‚ä¾èµ–æ²¡å¯¼å…¥ã€è§„èŒƒè¢«å¿½ç•¥ã€ç±»å‹å¯¹ä¸ä¸Šã€<code>UI</code> çš„é£æ ¼ä¸ç»Ÿä¸€â€¦â€¦è¿™äº›å°æ¯›ç—…åŠ èµ·æ¥ï¼Œè®© <code>review</code> çš„æ—¶é—´æ¯”ç”Ÿæˆä»£ç çš„æ—¶é—´è¿˜é•¿ã€‚æœ‰æ—¶å€™æˆ‘ç”šè‡³ä¼šæƒ³ï¼š<code>AI</code> æ˜æ˜èƒ½å†™å‡º 70% çš„å†…å®¹ï¼Œä¸ºä»€ä¹ˆå‰©ä¸‹çš„ 30% å´è®©æˆ‘è¿™ä¹ˆç´¯ï¼Ÿ</p>
<p>åæ¥æˆ‘æ…¢æ…¢æ„è¯†åˆ°ï¼Œé—®é¢˜ä¸å…¨åœ¨å·¥å…·ï¼Œè€Œåœ¨â€œèˆå°â€ã€‚ç»™ <code>AI</code> ä¸€ä¸ªç»“æ„æ¾æ•£ã€ä¸Šä¸‹æ–‡ç¢ç‰‡çš„é¡¹ç›®ï¼Œå®ƒå†æ€ä¹ˆåŠªåŠ›ï¼Œä¹Ÿå®¹æ˜“å‡ºé”™ï¼›ç»™å®ƒä¸€ä¸ªè¾¹ç•Œæ¸…æ™°ã€ç±»å‹å¼ºã€æ¨¡å—åˆ†æ˜çš„é¡¹ç›®ï¼Œå®ƒçš„ç¬¬ä¸€è½®è¾“å‡ºå¾€å¾€å°±èƒ½ç›´æ¥ <code>merge</code>ã€‚</p>
<p><code>NestJS</code> + <code>Monorepo</code>ï¼ˆä»¥ <code>Turborepo</code> ä¸ºä¸»ï¼‰å°±æ˜¯æˆ‘ç›®å‰æ‰¾åˆ°çš„æœ€èˆ’æœçš„èˆå°ã€‚å®ƒæ²¡æœ‰å¤ªå¤šèŠ±å“¨çš„æ–°æ¦‚å¿µï¼Œå´åœ¨ <code>AI</code> æ—¶ä»£æŠŠâ€œç»“æ„å³ç”Ÿäº§åŠ›â€è¿™ä»¶äº‹åšåˆ°äº†æè‡´ã€‚</p>
<p>ç”¨è¿™ä¸ªç»„åˆåï¼Œæˆ‘å‘ç° <code>accept</code> èƒ½ç¨³å®šåœ¨ 70% ä»¥ä¸Šï¼Œé‡æ„å’Œæ‰©å±•çš„æˆæœ¬å¤§å¹…é™ä½ï¼Œå…¨æ ˆåå‰ç«¯çš„ä½“éªŒä¹Ÿå˜å¾—å¼‚å¸¸é¡ºæ»‘ã€‚ä¸æ˜¯å› ä¸ºå®ƒå®Œç¾æ— ç¼ºï¼Œè€Œæ˜¯å› ä¸ºå®ƒè®© <code>AI</code> å’Œæˆ‘ä¹‹é—´çš„é…åˆï¼Œå°‘äº†å¾ˆå¤šäº’ç›¸æŠ˜è…¾ï¼Œå¤šäº†ä¸€äº›å®‰é™çš„é»˜å¥‘ã€‚</p>
<h3 data-id="heading-1"><code>AI</code> è¾…åŠ©å¼€å‘çš„è¶‹åŠ¿</h3>
<p>2026 å¹´ï¼Œå¼€å‘è€…ä½¿ç”¨ <code>AI</code> è¾…åŠ©å¼€å‘çš„æ¯”ä¾‹å·²ç»è¾¾åˆ°äº†ä¸€ä¸ªéå¸¸é«˜çš„æ°´å¹³ã€‚æ ¹æ®å„ç§ç¤¾åŒºè°ƒæŸ¥ã€<code>GitHub</code> æ•°æ®å’Œå¼€å‘è€…è®ºå›çš„åé¦ˆï¼Œç»å¤§å¤šæ•°æ´»è·ƒå¼€å‘è€…ï¼ˆå°¤å…¶æ˜¯å‰ç«¯ã€å…¨æ ˆã€<code>Node.js</code> ç”Ÿæ€ï¼‰éƒ½å·²ç»æŠŠ <code>AI</code> å·¥å…·å½“ä½œæ—¥å¸¸æ ‡é…ã€‚</p>
<ul>
<li>è¶…è¿‡ 80% çš„å¼€å‘è€…æ¯å¤©è‡³å°‘ä½¿ç”¨ä¸€æ¬¡ <code>AI</code> ç¼–ç å·¥å…·ï¼ˆ<code>Cursor</code>ã€<code>Trae</code>ã€<code>Claude Code</code>ã€<code>GitHub Copilot</code>ã€<code>Windsurf</code>ã€<code>Aider</code> ç­‰ï¼‰ã€‚</li>
<li>åœ¨ <code>TypeScript</code> / <code>JavaScript</code> é¡¹ç›®ä¸­ï¼Œè¿™ä¸ªæ¯”ä¾‹æ›´é«˜ï¼Œæ¥è¿‘ 90%ï¼Œå› ä¸ºå¼ºç±»å‹å’Œç»“æ„åŒ–ä»£ç è®© <code>AI</code> çš„è¾“å‡ºæ›´å¯é ã€‚</li>
<li>å¾ˆå¤šä¸­é«˜çº§å¼€å‘è€…å·²ç»æŠŠâ€œå…ˆè®© <code>AI</code> å†™åˆç¨¿ â†’ æˆ‘ <code>review</code> &amp; å¾®è°ƒâ€ä½œä¸ºé»˜è®¤å·¥ä½œæµï¼Œè€Œä¸æ˜¯â€œè‡ªå·±ä»é›¶å†™â€ã€‚</li>
</ul>
<p>ä¸ºä»€ä¹ˆå¤§å®¶è¶Šæ¥è¶Šå–œæ¬¢ç”¨ <code>AI</code> è¾…åŠ©å¼€å‘ï¼Ÿæ ¸å¿ƒåŸå› å¯ä»¥æ€»ç»“ä¸ºä¸‰ç‚¹ï¼š</p>
<ol>
<li>
<p><strong>æ•ˆç‡æå‡æ˜æ˜¾ä¸”å¯æ„ŸçŸ¥</strong><br/>
å†™ <code>boilerplate</code>ã€<code>CRUD</code> æ¥å£ã€ç±»å‹å®šä¹‰ã€æµ‹è¯•ç”¨ä¾‹ã€ç”šè‡³ä¸€äº›ä¸šåŠ¡é€»è¾‘çš„åˆç‰ˆï¼Œ<code>AI</code> éƒ½èƒ½åœ¨å‡ åç§’å†…å®Œæˆã€‚å¼€å‘è€…æŠŠæ—¶é—´ä»â€œé‡å¤åŠ³åŠ¨â€è½¬ç§»åˆ°â€œæ€è€ƒä¸šåŠ¡ã€è®¾è®¡æ¶æ„ã€ä¼˜åŒ–æ€§èƒ½ã€å®‰å…¨å®¡æŸ¥â€è¿™äº›æ›´æœ‰ä»·å€¼çš„éƒ¨åˆ†ã€‚</p>
</li>
<li>
<p><strong>å·¥å…·ä½“éªŒè¶Šæ¥è¶Šâ€œåƒäººâ€</strong><br/>
2026 å¹´çš„ <code>Cursor</code> å’Œ <code>Claude Code</code> å·²ç»èƒ½å¾ˆå¥½åœ°ç†è§£é¡¹ç›®ä¸Šä¸‹æ–‡ï¼š</p>
<ul>
<li><code>Cursor</code> çš„ <code>Composer</code> æ¨¡å¼å¯ä»¥ä¸€æ¬¡æ€§ä¿®æ”¹å¤šä¸ªæ–‡ä»¶ï¼Œå¹¶ä¿æŒä¸€è‡´æ€§ã€‚</li>
<li><code>Claude Code</code> çš„ <code>agentic</code> èƒ½åŠ›å…è®¸å®ƒâ€œå…ˆè¯»ä»£ç  â†’ åˆ†æéœ€æ±‚ â†’ è§„åˆ’æ­¥éª¤ â†’ å†™ä»£ç  â†’ è‡ªæµ‹ â†’ æäº¤â€ã€‚</li>
<li>å¾ˆå¤šå¼€å‘è€…åé¦ˆï¼šç°åœ¨è®© <code>AI</code> å†™ä¸€ä¸ªå®Œæ•´çš„ <code>feature</code>ï¼ˆå‰åç«¯ + ç±»å‹ + æµ‹è¯•ï¼‰ï¼ŒæˆåŠŸç‡å·²ç»èƒ½ç¨³å®šåœ¨ 60â€“80%ï¼Œè¿œé«˜äº 2024 å¹´çš„ 30â€“40%ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç¤¾åŒºä¸ç”Ÿæ€çš„æ­£åé¦ˆå¾ªç¯</strong><br/>
è¶Šæ¥è¶Šå¤šé¡¹ç›®å…¬å¼€åˆ†äº« <code>.cursorrules</code>ã€<code>CLAUDE.md</code>ã€<code>prompt</code> æ¨¡æ¿ã€<code>boilerplate</code>ã€‚<br/>
å¼€å‘è€…çœ‹åˆ°åˆ«äººç”¨ <code>AI</code> æŠŠä¸€ä¸ªä¸­å‹ <code>SaaS</code> åç«¯ä¸€å‘¨å†…æ­å‡ºæ¥ï¼Œå°±ä¼šæƒ³â€œæˆ‘ä¹Ÿè¯•è¯•â€ã€‚<br/>
è¿™ç§â€œçœ‹åˆ°åˆ«äººç”¨å¾—å¥½ â†’ æˆ‘ä¹Ÿæƒ³ç”¨ â†’ ç”¨å¾—å¥½ â†’ åˆ†äº«â€å½¢æˆäº†æ˜æ˜¾çš„æ­£å¾ªç¯ã€‚</p>
</li>
</ol>
<h3 data-id="heading-2"><code>AI</code> è¾…åŠ©å¼€å‘çš„é—®é¢˜ä¸ç—›ç‚¹</h3>
<p>è¶‹åŠ¿çœ‹èµ·æ¥å¾ˆç¾å¥½ï¼Œä½†å®é™…ç”¨èµ·æ¥ï¼Œç»å¸¸æ˜¯å¦ä¸€ç§é£æ™¯ã€‚</p>
<p>æˆ‘å’Œå¤§å¤šæ•°å¼€å‘è€…ä¸€æ ·ï¼Œæ¯å¤©æ‰“å¼€ <code>IDE</code> ç¬¬ä¸€ä»¶äº‹å°±æ˜¯è®© <code>AI</code> å¸®å¿™å†™ä»£ç ã€‚å¯è¶Šç”¨è¶Šå‘ç°ï¼Œå·¥å…·å†å¼ºï¼Œä¹Ÿå¸¸å¸¸åœ¨ç»†èŠ‚ä¸Šâ€œæ‰é“¾å­â€ã€‚</p>
<p>è¿™äº›é—®é¢˜ä¸æ˜¯å¶å‘ï¼Œè€Œæ˜¯ç³»ç»Ÿæ€§çš„ï¼Œå°¤å…¶åœ¨é¡¹ç›®è§„æ¨¡ç¨å¤§ã€ç»“æ„ä¸æ¸…æ™°çš„æ—¶å€™ï¼Œä¼šè¢«æ”¾å¤§åˆ°è®©äººæŠ“ç‹‚çš„åœ°æ­¥ã€‚</p>
<h4 data-id="heading-3">ä¸Šä¸‹æ–‡ç¢ç‰‡åŒ–</h4>
<p>å½“é¡¹ç›®æ‹†æˆå¤šä¸ª <code>repo</code>ï¼ˆå‰ç«¯ä¸€ä¸ªã€åç«¯ä¸€ä¸ªã€<code>shared types</code> åˆä¸€ä¸ªï¼‰ï¼Œ<code>AI</code> æ ¹æœ¬æ— æ³•ä¸€æ¬¡æ€§çœ‹å…¨ä¾èµ–å…³ç³»ã€‚</p>
<p>å®ƒä¼šæ ¹æ®å½“å‰æ–‡ä»¶çŒœä¸Šä¸‹æ–‡ï¼Œç»“æœå°±æ˜¯å¹»è§‰å±‚å‡ºä¸ç©·ï¼šå­—æ®µåæ‹¼é”™ã€ç±»å‹ä¸åŒ¹é…ã€ç”šè‡³æŠŠæ—§ç‰ˆæœ¬çš„æ¥å£é€»è¾‘å¸¦è¿›æ¥ã€‚</p>
<p>æˆ‘è¯•è¿‡ç”¨ <code>Cursor</code> é‡æ„ä¸€ä¸ª <code>GO</code> ä»£ç çš„é€»è¾‘ï¼Œå­—æ®µæ˜æ˜åœ¨ <code>DTO</code> é‡Œå®šä¹‰å¥½äº†ï¼Œå®ƒè¿˜æ˜¯ç»™æˆ‘å†™äº†ä¸ªä¸å­˜åœ¨çš„å±æ€§ã€‚</p>
<h4 data-id="heading-4">è§„èŒƒä¸é£æ ¼ä¸ä¸€è‡´</h4>
<p><code>AI</code> æ²¡æœ‰â€œè®°å¿†â€ä½ çš„é¡¹ç›®çº¦å®šã€‚å®ƒä¸çŸ¥é“ä½ ç”¨çš„æ˜¯ <code>NestJS</code> çš„ <code>DI</code> è¿˜æ˜¯çº¯å‡½æ•°å¼ï¼Œä¸çŸ¥é“è¦åŠ  <code>ValidationPipe</code> è¿˜æ˜¯æ‰‹åŠ¨æ ¡éªŒï¼Œä¸çŸ¥é“ <code>auth</code> è¦ç”¨ <code>Guard</code> è¿˜æ˜¯ <code>middleware</code>ã€‚</p>
<p>ç»“æœç”Ÿæˆçš„ä»£ç é£æ ¼äº”èŠ±å…«é—¨ï¼šæœ‰çš„åœ°æ–¹ç”¨ <code>class-validator</code>ï¼Œæœ‰çš„ç›´æ¥ <code>if</code> åˆ¤æ–­ï¼›æœ‰çš„åœ°æ–¹æ³¨å…¥ <code>service</code>ï¼Œæœ‰çš„ç›´æ¥ <code>new</code> ä¸€ä¸ªã€‚</p>
<p>åæœŸç»´æŠ¤æ—¶ï¼Œè¿™äº›å°å·®å¼‚ä¼šåƒé›ªçƒä¸€æ ·è¶Šæ»šè¶Šå¤§ã€‚</p>
<h4 data-id="heading-5">é‡æ„æ•ˆç‡ä½ä¸‹</h4>
<p>æƒ³æ”¹ä¸€ä¸ªå…±äº«ç±»å‹æˆ–è°ƒæ•´ <code>auth</code> é€»è¾‘ï¼Ÿ</p>
<p><code>AI</code> æ”¹äº†å½“å‰æ–‡ä»¶ï¼Œå´æ¼æ‰å…¶ä»– 5 ä¸ªä¾èµ–çš„åœ°æ–¹ã€‚å°¤å…¶æ˜¯è·¨åŒ…ä¿®æ”¹æ—¶ï¼Œ<code>Cursor</code> å¶å°”ä¼šâ€œå¡ä½â€â€”â€”ä¸æ˜¯å·¥å…·é—®é¢˜ï¼Œæ˜¯é¡¹ç›®ç»“æ„è®©å®ƒæ²¡æ³•é«˜æ•ˆè¿½è¸ªä¾èµ–ã€‚é‡æ„ä¸€æ¬¡ï¼Œæœ¬æ¥ 10 åˆ†é’Ÿçš„äº‹ï¼Œå˜æˆ 1 å°æ—¶+æ‰‹åŠ¨è¡¥æ¼ã€‚</p>
<h4 data-id="heading-6"><code>review</code> æˆæœ¬å±…é«˜ä¸ä¸‹</h4>
<p><code>AI</code> èƒ½ç”Ÿæˆ 60â€“80% çš„ä»£ç ï¼Œä½†å‰©ä¸‹çš„ 20â€“40% å¾€å¾€æ˜¯å…³é”®é€»è¾‘ã€å®‰å…¨è¾¹ç•Œã€æ€§èƒ½ç‚¹ã€‚è¿™äº›åœ°æ–¹å‡ºé”™ï¼Œåæœä¸¥é‡ï¼Œæ‰€ä»¥æˆ‘å‡ ä¹æ¯æ®µ <code>AI</code> ä»£ç éƒ½è¦ä»å¤´å®¡ä¸€éã€‚</p>
<p>æ—¶é—´ä¸€é•¿ï¼Œæ„Ÿè§‰ <code>AI</code> ä¸æ˜¯åœ¨å¸®æˆ‘åŠ é€Ÿï¼Œè€Œæ˜¯åœ¨ç»™æˆ‘åˆ¶é€ æ›´å¤šâ€œçœ‹èµ·æ¥å¯¹ä½†å…¶å®ä¸å¯¹â€çš„å·¥ä½œã€‚</p>
<h4 data-id="heading-7">æ‰©å±•åŠŸèƒ½æ—¶çš„ç ´åæ€§</h4>
<p>é¡¹ç›®æœ¬æ¥æ˜¯ä¼ ç»Ÿ <code>CRUD</code>ï¼Œçªç„¶æƒ³åŠ ä¸ªç®€å•çš„æ¥å£ã€‚ç»“æœè¦ä¹ˆå¤§æ”¹æ¶æ„ï¼Œè¦ä¹ˆæ–°å»ºä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ï¼Œæœ€åå‰åç«¯å‰²è£‚ï¼Œç±»å‹åˆå¯¹ä¸ä¸Šã€‚</p>
<p><code>AI</code> æ—¶ä»£ï¼Œæœ¬è¯¥æ˜¯â€œæƒ³åŠ å°±åŠ â€çš„åŠŸèƒ½ï¼Œå´å˜æˆäº†â€œåŠ äº†ä¹‹åæ•´ä¸ªé¡¹ç›®éƒ½ä¹±äº†â€ã€‚</p>
<p>è¿™äº›ç—›ç‚¹åŠ èµ·æ¥ï¼Œè®©æˆ‘ä¸€åº¦æ€€ç–‘ï¼š<code>AI</code> åˆ°åº•æ˜¯ç”Ÿäº§åŠ›å·¥å…·ï¼Œè¿˜æ˜¯å¦ä¸€ä¸ªâ€œçœ‹èµ·æ¥å¾ˆç¾â€çš„è´Ÿæ‹…ï¼Ÿ</p>
<h3 data-id="heading-8">2026 å¹´ï¼Œ<code>AI</code> è¾…åŠ©å¼€å‘å·²ç»è¿›å…¥â€œåŸºç¡€è®¾æ–½â€é˜¶æ®µ</h3>
<p>2026 å¹´ï¼Œ<code>AI</code> è¾…åŠ©å¼€å‘å·²ç»ä»â€œç‚«æŠ€â€é˜¶æ®µå½»åº•è¿›å…¥â€œåŸºç¡€è®¾æ–½â€é˜¶æ®µã€‚</p>
<p>å·¥å…·é“¾çš„æ¼”è¿›æ–¹å‘éå¸¸æ˜ç¡®ï¼š<strong>ä»å•è¡Œè¡¥å…¨ â†’ å¤šæ–‡ä»¶ç¼–è¾‘ â†’ é¡¹ç›®çº§ä¸Šä¸‹æ–‡ç†è§£ â†’ <code>agentic</code> å¤šæ­¥è§„åˆ’</strong>ã€‚</p>
<ul>
<li><strong>â€œ2026 å¹´çš„å¼€å‘æ•ˆç‡å·®è·ï¼Œä¸å†æ˜¯ä¼šä¸ä¼šç”¨ <code>AI</code>ï¼Œè€Œæ˜¯ä½ çš„é¡¹ç›®ç»“æ„èƒ½ä¸èƒ½è®© <code>AI</code> å‘æŒ¥å‡º 70% ä»¥ä¸Šçš„å‘½ä¸­ç‡ã€‚â€</strong></li>
</ul>
<p>æ•°æ®ä¹Ÿå°è¯äº†è¿™ä¸€ç‚¹ï¼š</p>
<ul>
<li><code>GitHub Octoverse 2025</code> æ˜¾ç¤ºï¼Œä½¿ç”¨ <code>monorepo</code> çš„ä»“åº“ä¸­ï¼Œ<code>AI</code> ç”Ÿæˆä»£ç çš„ <code>acceptance rate</code> å¹³å‡é«˜å‡º 28%ã€‚</li>
<li><code>Cursor</code> å®˜æ–¹åœ¨ 2025 å¹´åº•çš„æŠ¥å‘Šé‡Œæåˆ°ï¼šåœ¨ç»“æ„åŒ–é¡¹ç›®ï¼ˆ<code>TypeScript</code> + æ˜ç¡®çš„æ¨¡å—è¾¹ç•Œï¼‰é‡Œï¼Œç”¨æˆ·å¹³å‡ <code>accept</code> ç‡èƒ½ç¨³å®šåœ¨ 68â€“75%ï¼Œè€Œåœ¨â€œæ‚ä¹±çš„ <code>Express</code> é¡¹ç›®â€é‡Œï¼Œåªæœ‰ 42%ã€‚</li>
</ul>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œ<code>AI</code> å·¥å…·çš„ä¸Šä¸‹æ–‡çª—å£å·²ç»ä¸å†æ˜¯ç“¶é¢ˆï¼ˆ200k <code>token</code> éšä¾¿ç”¨ï¼‰ï¼ŒçœŸæ­£çš„ç“¶é¢ˆå˜æˆäº†**â€œAI èƒ½ä¸èƒ½åœ¨ 0.5 ç§’å†…çœ‹æ‡‚ä½ çš„æ•´ä¸ªé¡¹ç›®ç»“æ„â€**ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œ<code>monorepo</code> + å¼ºè§„èŒƒæ¡†æ¶çš„ä¼˜åŠ¿å°±å½»åº•æ˜¾ç°å‡ºæ¥äº†ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œ2026 å¹´çš„è¶‹åŠ¿å°±æ˜¯ï¼š</p>
<p><strong>AI è¶Šæ¥è¶Šèªæ˜ï¼Œä½†å®ƒæ›´éœ€è¦ä¸€ä¸ªâ€œèªæ˜â€çš„é¡¹ç›®æ¥é…åˆã€‚</strong></p>
<p>è€Œ <code>NestJS</code> + <code>Monorepo</code> æ­£æ˜¯æˆ‘è§è¿‡çš„æœ€èƒ½æŠŠè¿™ç§é…åˆåšåˆ°æè‡´çš„ç»„åˆã€‚</p>
<h3 data-id="heading-9"><code>NestJS</code> + <code>Monorepo</code> å¦‚ä½•è§£å†³è¿™äº›ç—›ç‚¹</h3>
<p>ä¸Šé¢æåˆ°çš„é‚£äº›ç—›ç‚¹ï¼Œç”¨ä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯ï¼š<code>AI</code> å¾ˆèªæ˜ï¼Œä½†å®ƒéœ€è¦ä¸€ä¸ªâ€œèªæ˜â€çš„é¡¹ç›®æ¥é…åˆã€‚</p>
<p><code>NestJS</code> + <code>Monorepo</code>ï¼ˆä»¥ <code>Turborepo</code> ä¸ºä¸»ï¼‰æ­£æ˜¯æˆ‘ç›®å‰æ‰¾åˆ°çš„æœ€èƒ½è®© <code>AI</code> â€œé…åˆå¥½â€çš„ç»„åˆã€‚å®ƒä¸æ˜¯é ä»€ä¹ˆé»‘ç§‘æŠ€ï¼Œè€Œæ˜¯é ç»“æ„æœ¬èº«æŠŠ <code>AI</code> çš„å‘½ä¸­ç‡ä» 30â€“40% æ‹‰åˆ° 70%+ï¼Œç”šè‡³æ›´é«˜ã€‚</p>
<p>ä¸‹é¢æŒ‰ç—›ç‚¹ä¸€ä¸€å¯¹åº”ï¼Œè¯´è¯´è¿™ä¸ªç»„åˆæ˜¯æ€ä¹ˆè§£å†³çš„ã€‚</p>
<h4 data-id="heading-10">ä¸Šä¸‹æ–‡ç¢ç‰‡åŒ– â†’ <code>Monorepo</code> è®© <code>AI</code> ä¸€æ¬¡æ€§çœ‹å…¨é¡¹ç›®</h4>
<p><code>AI</code> çš„é—®é¢˜æ˜¯åªèƒ½çœ‹åˆ°å½“å‰æ‰“å¼€çš„æ–‡ä»¶æˆ–æœ‰é™çš„ä¸Šä¸‹æ–‡ã€‚</p>
<p><code>monorepo</code> æŠŠå‰ç«¯ï¼ˆ<code>apps/web</code>ï¼‰ã€åç«¯ï¼ˆ<code>apps/api</code>ï¼‰ã€å…±äº«ç±»å‹ï¼ˆ<code>libs/types</code>ï¼‰ã€æ•°æ®åº“ <code>schema</code>ï¼ˆ<code>libs/db</code>ï¼‰ã€ç”šè‡³ <code>UI</code> ç»„ä»¶ï¼ˆ<code>libs/ui</code>ï¼‰å…¨éƒ¨æ”¾åœ¨åŒä¸€ä¸ªä»“åº“é‡Œã€‚<code>AI</code> å·¥å…·ï¼ˆå¦‚ <code>Cursor Composer</code>ï¼‰ç›´æ¥ç´¢å¼•æ•´ä¸ª <code>repo</code>ï¼Œä¾èµ–å…³ç³»ã€ç±»å‹å®šä¹‰ã€æ¥å£å¥‘çº¦ä¸€ç›®äº†ç„¶ã€‚</p>
<p>å®é™…æ•ˆæœï¼š</p>
<ul>
<li>ç”Ÿæˆå‰ç«¯è°ƒç”¨åç«¯ <code>API</code> æ—¶ï¼Œå®ƒä¸ä¼šå†å‡­ç©ºå‘æ˜ä¸€ä¸ªä¸å­˜åœ¨çš„å­—æ®µã€‚</li>
<li>æ”¹ä¸€ä¸ª <code>shared type</code>ï¼ˆå¦‚ <code>UserDto</code>ï¼‰ï¼Œ<code>AI</code> èƒ½è‡ªåŠ¨è¿½è¸ªåˆ°æ‰€æœ‰ä½¿ç”¨å®ƒçš„åœ°æ–¹ï¼Œä¸€æ¬¡æ€§æ”¹å®Œã€‚</li>
</ul>
<h4 data-id="heading-11">è§„èŒƒä¸é£æ ¼ä¸ä¸€è‡´ â†’ <code>NestJS</code> è£…é¥°å™¨ + <code>DI</code> æ˜¯â€œå¤©ç„¶æç¤ºâ€</h4>
<p><code>NestJS</code> çš„æ ¸å¿ƒè®¾è®¡ï¼ˆæ¨¡å—åŒ–ã€ä¾èµ–æ³¨å…¥ã€è£…é¥°å™¨ï¼‰æœ¬è´¨ä¸Šå°±æ˜¯ä¸€å¥—â€œå†™ç»™ <code>AI</code> çœ‹çš„è§„èŒƒè¯­è¨€â€ã€‚</p>
<ul>
<li><code>@Controller</code>ã€<code>@Get</code>ã€<code>@Post</code> æ˜ç¡®å‘Šè¯‰ <code>AI</code> è¿™ä¸ªç±»æ˜¯ <code>HTTP</code> å…¥å£ã€‚</li>
<li><code>@Injectable</code>ã€<code>constructor</code> æ³¨å…¥è®© <code>AI</code> çŸ¥é“è¦ç”¨ <code>DI</code>ï¼Œè€Œä¸æ˜¯ä¹± <code>new</code>ã€‚</li>
<li><code>@Body()</code> + <code>class-validator</code> + <code>ValidationPipe</code> è®© <code>AI</code> è‡ªåŠ¨ç”Ÿæˆæ ¡éªŒé€»è¾‘ï¼Œå‡ ä¹ä¸ä¼šæ¼æ‰ <code>required</code> å­—æ®µã€‚</li>
<li><code>@UseGuards</code>ã€<code>@UseInterceptors</code> è®© <code>auth</code>ã€<code>logging</code>ã€<code>rate-limit</code> ç­‰åˆ‡é¢é€»è¾‘å¤©ç„¶ç»Ÿä¸€ã€‚</li>
</ul>
<p>åœ¨ <code>.cursorrules</code> é‡Œå†™å‡ è¡Œè§„åˆ™ï¼š</p>
<pre><code class="hljs language-text" lang="text">å§‹ç»ˆç”¨ NestJS æ¨¡å—åŒ–ç»“æ„ï¼šæ–° feature æ”¾åœ¨ apps/api/src/{domain} ä¸‹ã€‚
å…±äº«ç±»å‹æ”¾åœ¨ libs/typesï¼Œç”¨ zod æˆ– inferã€‚
ä¼˜å…ˆç”¨ tRPC æš´éœ² APIï¼Œä¿æŒç«¯åˆ°ç«¯ç±»å‹å®‰å…¨ã€‚
æ‰€æœ‰ DTO å¿…é¡»ç”¨ class-validator æ ¡éªŒã€‚
</code></pre>
<p><code>AI</code> å°±ä¼šåƒè€å‘˜å·¥ä¸€æ ·ï¼Œç”Ÿæˆçš„ä»£ç é£æ ¼é«˜åº¦ä¸€è‡´ã€‚<code>Claude Code</code> ç”šè‡³èƒ½æ ¹æ®è¿™äº›è§„åˆ™è‡ªå‘å†™å‡ºç¬¦åˆè§„èŒƒçš„æµ‹è¯•ç”¨ä¾‹ã€‚</p>
<h4 data-id="heading-12">é‡æ„æ•ˆç‡ä½ä¸‹ â†’ <code>Turborepo</code> <code>caching</code> + æ¨¡å—è¾¹ç•Œè®© <code>AI</code> æ”¹å¾—åˆå¿«åˆå‡†</h4>
<p><code>Turborepo</code> çš„è¿œç¨‹ç¼“å­˜å’Œå¹¶è¡Œä»»åŠ¡ï¼Œè®© <code>monorepo</code> çš„ <code>build</code> / <code>dev</code> é€Ÿåº¦é£èµ·ï¼ˆ<code>Rust</code> é‡å†™åï¼Œå†·å¯åŠ¨å’Œå¢é‡ <code>build</code> å¿« 3â€“5xï¼‰ã€‚</p>
<p><code>AI</code> ä¿®æ”¹å¤šä¸ªåŒ…æ—¶ï¼Œä¸ä¼šå› ä¸º <code>build</code> å¡ä½è€Œä¸­æ–­æ€è·¯ã€‚</p>
<p>åŒæ—¶ï¼Œ<code>NestJS</code> çš„æ¨¡å—è¾¹ç•Œï¼ˆæ¯ä¸ª <code>domain</code> ä¸€ä¸ª <code>module</code>ï¼‰è®© <code>AI</code> å¾ˆå®¹æ˜“å®šä½ä¿®æ”¹èŒƒå›´ï¼š</p>
<ul>
<li>æ”¹ <code>auth</code> é€»è¾‘ â†’ åªåŠ¨ <code>libs/auth</code> å’Œ <code>apps/api/src/auth</code>ã€‚</li>
<li>åŠ  <code>rate-limit</code> â†’ åªéœ€åœ¨ <code>common/interceptors</code> åŠ ä¸€ä¸ªå…¨å±€ <code>Interceptor</code>ï¼Œæ‰€æœ‰è·¯ç”±è‡ªåŠ¨ç”Ÿæ•ˆã€‚</li>
</ul>
<h4 data-id="heading-13"><code>review</code> æˆæœ¬é«˜ â†’ ç«¯åˆ°ç«¯ç±»å‹å®‰å…¨ + æµ‹è¯•å‹å¥½è®© <code>bug</code> æå‰æ­»æ‰</h4>
<p><code>tRPC</code> + <code>zod</code> / <code>infer</code> è®©ç±»å‹åœ¨ <code>monorepo</code> é‡Œé›¶æˆæœ¬åŒæ­¥ï¼š</p>
<ul>
<li><code>libs/types</code> å®šä¹‰ <code>DTO</code> â†’ <code>tRPC router infer</code> â†’ å‰ç«¯ <code>hook</code> è‡ªåŠ¨å¸¦ç±»å‹ã€‚</li>
<li><code>AI</code> ç”Ÿæˆå‰ç«¯è°ƒç”¨æ—¶ï¼Œå‡ ä¹ä¸ä¼šå‡ºç° â€œproperty does not existâ€ è¿™ç§ä½çº§é”™è¯¯ã€‚</li>
</ul>
<p><code>NestJS</code> çš„ <code>DI</code> ä¹Ÿè®©å•å…ƒæµ‹è¯• / é›†æˆæµ‹è¯•éå¸¸å¥½å†™ï¼š<code>mock service</code> ä¸€è¡Œä»£ç æå®šã€‚</p>
<p>æˆ‘ç°åœ¨ä¹ æƒ¯è®© <code>AI</code> é¡ºæ‰‹ç”Ÿæˆ <code>Vitest</code> / <code>Jest</code> æµ‹è¯•ç”¨ä¾‹ï¼Œ<code>review</code> æ—¶å…ˆè·‘æµ‹è¯•ï¼Œå¤±è´¥çš„ç›´æ¥è¿­ä»£ <code>prompt</code>ï¼ŒæˆåŠŸç‡é«˜å¾ˆå¤šã€‚</p>
<h4 data-id="heading-14">æ‰©å±• <code>AI</code> åŠŸèƒ½æ—¶çš„ç ´åæ€§ â†’ æ¨¡å—åŒ– + <code>libs/ai</code> åƒæ’ä»¶ä¸€æ ·æ’æ‹”</h4>
<p>æƒ³åŠ  <code>RAG</code>ã€<code>chat</code>ã€<code>embedding</code>ï¼Ÿ</p>
<p>æ–°å»ºä¸€ä¸ª <code>libs/ai</code> åŒ…ï¼Œæ³¨å…¥ <code>OpenAI</code> / <code>Anthropic client</code>ï¼Œå†™å‡ ä¸ª <code>service</code>ï¼ˆ<code>embeddingService</code>ã€<code>ragService</code>ï¼‰ï¼Œç„¶ååœ¨ <code>apps/api</code> é‡Œæš´éœ² <code>tRPC</code> è·¯ç”±ã€‚</p>
<p>ä¸šåŠ¡ä»£ç å‡ ä¹ä¸æ”¹ï¼ŒåŸæœ‰æ¨¡å—ä¸å—å½±å“ã€‚</p>
<p>å¦‚æœä»»åŠ¡é‡ï¼Œè¿˜å¯ä»¥æ–°å»º <code>apps/worker</code>ï¼ˆ<code>BullMQ</code> é˜Ÿåˆ—ï¼‰ï¼Œå¼‚æ­¥å¤„ç† <code>embedding</code> / <code>indexing</code>ã€‚</p>
<p>è¿™ä¸ªâ€œæ’ä»¶å¼â€æ‰©å±•æ–¹å¼ï¼Œè®© <code>AI</code> åŠŸèƒ½ä»â€œé¢å¤–è´Ÿæ‹…â€å˜æˆäº†â€œå¯é€‰é¡¹â€ã€‚æˆ‘æœ€è¿‘åŠ äº†ä¸€ä¸ªç®€å•çš„æ€è€ƒé“¾ <code>Agent</code>ï¼Œåªç”¨äº†åŠå¤©æ—¶é—´ï¼Œé¡¹ç›®ç»“æ„ä¸€ç‚¹æ²¡ä¹±ã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼Œ<code>NestJS</code> + <code>Monorepo</code> ä¸æ˜¯åœ¨â€œæ•™ <code>AI</code> å†™ä»£ç â€ï¼Œè€Œæ˜¯åœ¨â€œæ•™ <code>AI</code> å¦‚ä½•æŒ‰ç…§æˆ‘çš„è§„åˆ™å†™ä»£ç â€ã€‚</p>
<h3 data-id="heading-15"><code>NestJS</code> å…¨æ ˆåå‰ç«¯çš„é—­ç¯ä½“éªŒ</h3>
<p>åœ¨ <code>NestJS</code> + <code>Monorepo</code> çš„ç»„åˆé‡Œï¼Œæœ€è®©æˆ‘è§‰å¾—â€œç¦»ä¸å¼€â€çš„åœ°æ–¹ï¼Œå…¶å®æ˜¯å®ƒæŠŠå…¨æ ˆåå‰ç«¯çš„å¼€å‘ä½“éªŒåšåˆ°äº†ä¸€ä¸ªè¿‘ä¹é—­ç¯çš„çŠ¶æ€ã€‚</p>
<p>æ‰€è°“â€œå…¨æ ˆåå‰ç«¯â€ï¼Œå°±æ˜¯ä»¥å‰ç«¯ä¸ºä¸»ï¼ˆ<code>Next.js</code> <code>App Router</code> ä¸ºä¸»åŠ›ï¼‰ï¼Œåç«¯åªæ˜¯ä¸ºäº†æ”¯æ’‘ä¸šåŠ¡é€»è¾‘ã€æ•°æ®æŒä¹…åŒ–ã€<code>API</code> æš´éœ²ï¼Œä½†åˆä¸æƒ³æŠŠåç«¯å†™å¾—å¤ªéšæ„ã€‚</p>
<p>è¿‡å»ç”¨ <code>Express</code> æˆ– <code>Fastify</code>ï¼ŒåŸç”Ÿå†™åç«¯æ€»è§‰å¾—å‰²è£‚ï¼šç±»å‹å®šä¹‰è¦æ‰‹åŠ¨åŒæ­¥ã€å‰ç«¯è°ƒç”¨ <code>API</code> æ—¶å®¹æ˜“å‡ºå­—æ®µé”™ã€éƒ¨ç½²å‰åç«¯è¦åˆ†å¼€ç®¡ã€è§„èŒƒé å£å¤´çº¦å®šâ€¦â€¦è¿™äº›å°æ‘©æ“¦ç´¯ç§¯èµ·æ¥ï¼Œä¼šè®©å¼€å‘èŠ‚å¥æ–­æ–­ç»­ç»­ã€‚</p>
<p><code>NestJS</code> + <code>Monorepo</code> å‡ ä¹æŠŠè¿™äº›æ‘©æ“¦å…¨éƒ¨æŠ¹å¹³äº†ï¼Œå½¢æˆäº†ä¸‹é¢å‡ ä¸ªæ˜æ˜¾çš„é—­ç¯ï¼š</p>
<h4 data-id="heading-16">ç«¯åˆ°ç«¯ç±»å‹å®‰å…¨çš„é›¶æˆæœ¬åŒæ­¥</h4>
<p>æ ¸å¿ƒé  <code>tRPC</code> + <code>shared libs</code>ã€‚
åœ¨ <code>libs/types</code> é‡Œå®šä¹‰ <code>DTO</code>ï¼ˆå¦‚ <code>UserDto</code>ã€<code>NotificationPreferencesDto</code>ï¼‰ï¼Œç„¶ååœ¨ <code>NestJS</code> çš„ <code>tRPC router</code> é‡Œç”¨ <code>infer</code> æˆ– <code>zod</code> ç›´æ¥å¯¼å‡ºç±»å‹ã€‚å‰ç«¯ï¼ˆ<code>Next.js</code>ï¼‰é€šè¿‡ <code>tRPC client</code> æ¶ˆè´¹æ—¶ï¼Œç±»å‹è‡ªåŠ¨å¸¦è¿‡æ¥ã€‚</p>
<p><code>AI</code> ç”Ÿæˆå‰ç«¯ <code>mutation</code> / <code>query</code> æ—¶ï¼Œå‡ ä¹ä¸ä¼šå‡ºç° â€œproperty does not exist on typeâ€ çš„ä½çº§ <code>bug</code>ã€‚</p>
<p>æˆ‘æœ€è¿‘æ”¹ä¸€ä¸ªç”¨æˆ·è®¾ç½®æ¥å£ï¼Œæ•´ä¸ªè¿‡ç¨‹ <code>AI</code> æ”¹äº†åç«¯ <code>controller</code> + <code>service</code> + å‰ç«¯ <code>page</code> + <code>hook</code>ï¼Œç±»å‹å…¨ç¨‹å¯¹é½ï¼Œæˆ‘åª <code>review</code> äº†ä¸šåŠ¡é€»è¾‘çš„è¾¹ç•Œæ¡ä»¶ã€‚</p>
<h4 data-id="heading-17">è¿­ä»£é€Ÿåº¦ä¸ <code>AI</code> èŠ‚å¥å®Œç¾åŒ¹é…</h4>
<p><code>Turborepo</code> çš„ç¼“å­˜æœºåˆ¶ï¼ˆå°¤å…¶æ˜¯ <code>Rust</code> é‡å†™åçš„ç‰ˆæœ¬ï¼‰è®© <code>monorepo</code> çš„ <code>turbo run dev / build</code> å¿«åˆ°ç¦»è°±ã€‚</p>
<p>å‰åç«¯åŒæ—¶å¼€å‘æ—¶ï¼Œæ”¹ä¸€ä¸ª <code>shared type</code> æˆ–åç«¯æ¥å£ï¼Œå‰ç«¯çƒ­é‡è½½å‡ ä¹ç§’çº§å“åº”ã€‚</p>
<p><code>AI</code> å¸®æˆ‘å¿«é€Ÿç”Ÿæˆä¸€ä¸ª <code>feature</code>ï¼Œæˆ‘ <code>review</code> å®Œ <code>accept</code> â†’ <code>turbo</code> ç¬é—´ <code>build</code> â†’ æµè§ˆå™¨åˆ·æ–°çœ‹åˆ°æ•ˆæœï¼Œæ•´ä¸ª <code>cycle</code> æ§åˆ¶åœ¨ 5â€“10 åˆ†é’Ÿã€‚</p>
<p>è¿™å’Œ <code>AI</code> çš„â€œå¿«é€Ÿè¯•é”™â€èŠ‚å¥é«˜åº¦å»åˆï¼šæƒ³æ”¹å°±æ”¹ï¼Œæƒ³åŠ å°±åŠ ï¼Œä¸ä¼šå› ä¸º <code>build</code> æ…¢æˆ– <code>deploy</code> éº»çƒ¦è€Œå¡ä½æ€è·¯ã€‚</p>
<h4 data-id="heading-18">éƒ¨ç½²ä¸è¿ç»´çš„æç®€é—­ç¯</h4>
<p><code>Vercel</code> åŸç”Ÿæ”¯æŒ <code>Turborepo</code> <code>monorepo</code>ï¼Œä¸€é”® <code>deploy</code> å‰åç«¯ï¼ˆ<code>apps/web</code> â†’ <code>frontend</code>ï¼Œ<code>apps/api</code> â†’ <code>serverless</code> æˆ– <code>edge functions</code>ï¼‰ã€‚</p>
<p>åç«¯ç”¨ <code>NestJS</code> <code>Fastify mode</code>ï¼Œååé‡æ¯” <code>Express</code> é«˜ 2â€“4 å€ï¼Œæˆæœ¬æ§åˆ¶æ›´å‹å¥½ã€‚</p>
<p>ä¸å†éœ€è¦ç»´æŠ¤ä¸¤ä¸ª <code>repo</code> çš„ <code>CI/CD</code>ã€ä¸¤ä¸ªåœ°æ–¹çš„ <code>env variables</code>ã€ä¸¤ä¸ªåœ°æ–¹çš„ç›‘æ§ã€‚</p>
<h4 data-id="heading-19">å‰åç«¯åŒæ„ä½“éªŒï¼Œå‰ç«¯è½¬å…¨æ ˆå­¦ä¹ æ›²çº¿æœ€ä½</h4>
<p><code>NestJS</code> çš„è£…é¥°å™¨é£æ ¼ã€æ¨¡å—åŒ–ã€<code>TypeScript</code> åŸç”Ÿï¼Œå’Œ <code>Next.js</code> çš„ <code>App Router</code> + <code>server actions</code> é«˜åº¦ç›¸ä¼¼ã€‚</p>
<p>å‰ç«¯å¼€å‘è€…ä¸Šæ‰‹ <code>NestJS</code> æ—¶ï¼Œå‡ ä¹æ²¡æœ‰é™Œç”Ÿæ„Ÿï¼š<code>controller</code> åƒ <code>page route</code>ï¼Œ<code>service</code> åƒ <code>server action</code> æˆ– <code>lib function</code>ï¼Œ<code>pipes</code> / <code>interceptors</code> åƒ <code>middleware</code>ã€‚</p>
<p><code>AI</code> (å¦‚ <code>Trae</code>) è¡¥å…¨æ—¶ï¼Œä¹Ÿæ›´å®¹æ˜“ç†è§£ä¸Šä¸‹æ–‡â€”â€”å› ä¸ºå‰åç«¯é£æ ¼ç»Ÿä¸€ï¼Œå®ƒç”Ÿæˆçš„ä»£ç å¤©ç„¶ä¸€è‡´ã€‚</p>
<p>ä¸ºä»€ä¹ˆ <code>NestJS</code> åœ¨è¿™ä¹ˆå¤š <code>Node</code> åç«¯é€‰é¡¹é‡Œï¼Œèƒ½æˆä¸ºå…¨æ ˆåå‰ç«¯çš„æœ€ä¼˜é€‰æ‹©ï¼Ÿ</p>
<p>ç®€å•å¯¹æ¯”ä¸€ä¸‹ï¼š</p>
<ul>
<li><code>Express</code> / <code>Fastify</code> åŸç”Ÿï¼šå¤ªçµæ´» â†’ è§„èŒƒé è‡ªå·± â†’ <code>AI</code> å®¹æ˜“ä¹±å†™ã€‚</li>
<li><code>Hono</code> / <code>Elysia</code>ï¼šè½»é‡æè‡´ â†’ ä½†ç¼ºå°‘æ¨¡å—åŒ– + <code>DI</code>ï¼Œ<code>AI</code> åœ¨ä¸­å¤§å‹é¡¹ç›®é‡Œä¸Šä¸‹æ–‡è·Ÿä¸ä¸Šã€‚</li>
<li><code>Adonis</code> / <code>FoalTS</code>ï¼šä¼ä¸šçº§ï¼Œä½†å­¦ä¹ æ›²çº¿é™¡ï¼Œç”Ÿæ€ä¸å¦‚ <code>NestJS</code> æ´»è·ƒã€‚</li>
<li><code>NestJS</code>ï¼šç»“æ„å¼ºã€<code>TypeScript</code> å‹å¥½ã€è£…é¥°å™¨åƒâ€œæç¤ºå·¥ç¨‹â€ã€ç¤¾åŒº <code>boilerplate</code> å¤šã€ä¸ <code>Next.js</code> ç”Ÿæ€æ— ç¼å¯¹æ¥ã€‚</li>
</ul>
<p><code>NestJS</code> ä¸æ˜¯æœ€è½»ã€æœ€å¿«ï¼Œä½†å®ƒæ˜¯ç›®å‰ <code>Node</code> ç”Ÿæ€é‡Œâ€œæœ€ä¸æ‹– <code>AI</code> åè…¿ã€åˆèƒ½è®©å‰ç«¯å¼€å‘è€…å†™å¾—èˆ’æœâ€çš„åç«¯æ¡†æ¶ã€‚</p>
<p>æ”¾åœ¨ <code>monorepo</code> é‡Œï¼Œå®ƒå°±æŠŠâ€œå‰åç«¯å‰²è£‚â€è¿™ä¸ªè€é—®é¢˜ï¼Œå˜æˆäº†â€œå‰åç«¯åƒä¸€å®¶äººâ€ã€‚</p>
<p>ç”¨è¿™ä¸ªç»„åˆåï¼Œæˆ‘å†™ä»£ç çš„æ„Ÿå—ä»â€œå‰åç«¯ä¸¤å¥—é€»è¾‘åœ¨æ‰“æ¶â€å˜æˆäº†â€œå‰åç«¯åœ¨åŒä¸€ä¸ª <code>repo</code> é‡Œå®‰é™åœ°åˆä½œâ€ã€‚</p>
<p>è¿™å¤§æ¦‚å°±æ˜¯â€œé—­ç¯â€çš„çœŸæ­£å«ä¹‰ã€‚</p>
<h3 data-id="heading-20">ç‹¬ç«‹éƒ¨ç½²ä¸å¾®æœåŠ¡å‹å¥½ï¼š<code>monorepo</code> ä¸ç­‰äºå•ä½“</h3>
<p>å¾ˆå¤šäººä¸€å¬åˆ° <code>monorepo</code>ï¼Œå°±æ‹…å¿ƒå®ƒä¼šå˜æˆä¸€ä¸ªâ€œå¤§å•ä½“â€ï¼šæ‰€æœ‰ä»£ç è€¦åˆåœ¨ä¸€èµ·ï¼Œéƒ¨ç½²æ…¢ã€æ‰©å±•éš¾ã€ç»´æŠ¤æˆå™©æ¢¦ã€‚ä½† <code>NestJS</code> + <code>Monorepo</code> çš„å®é™…ç”¨æ³•æ°æ°ç›¸åï¼Œå®ƒåœ¨ä¿æŒä»£ç å…±äº«ä¾¿åˆ©çš„åŒæ—¶ï¼Œå¤©ç„¶æ”¯æŒç‹¬ç«‹éƒ¨ç½²å’Œå¾®æœåŠ¡è¾¹ç•Œã€‚</p>
<p>æ ¸å¿ƒé ä»¥ä¸‹å‡ ç‚¹è®¾è®¡ï¼š</p>
<ul>
<li>
<p><strong>æ¯ä¸ª <code>app</code> / <code>service</code> ç‹¬ç«‹</strong>ï¼š<code>monorepo</code> é‡Œå¯ä»¥æœ‰å¤šä¸ª <code>apps</code>ï¼Œæ¯”å¦‚ <code>apps/api</code>ï¼ˆä¸»åç«¯ï¼‰ã€<code>apps/worker</code>ï¼ˆé˜Ÿåˆ—ä»»åŠ¡ï¼‰ã€<code>apps/admin</code>ï¼ˆåå°ç®¡ç†ï¼‰ã€‚<code>Turborepo</code> æ”¯æŒæ¯ä¸ª <code>app</code> å•ç‹¬ <code>build</code>ã€<code>test</code>ã€<code>deploy</code>ã€‚<br/>
<code>CI/CD</code> é…ç½®æ—¶ï¼Œç”¨ <code>turbo run build --filter=api</code> åªæ„å»º <code>api</code> åŒ…ï¼Œå…¶ä»–ä¸åŠ¨ã€‚<code>Vercel</code>ã€<code>Railway</code> æˆ– <code>GitHub Actions</code> éƒ½èƒ½è½»æ¾å®ç°â€œæ”¹ <code>api</code> åª <code>deploy</code> <code>api</code>â€ã€‚</p>
</li>
<li>
<p><strong><code>NestJS</code> åŸç”Ÿå¾®æœåŠ¡æ”¯æŒ</strong>ï¼š<code>NestJS</code> å†…ç½®å¤šç§ä¼ è¾“å±‚ï¼ˆ<code>TCP</code>ã€<code>Redis</code>ã€<code>NATS</code>ã€<code>gRPC</code>ã€<code>MQTT</code>ï¼‰ï¼Œæ¨¡å—ä¹‹é—´å¯ä»¥é€šè¿‡ <code>@nestjs/microservices</code> è§£è€¦ã€‚<br/>
æ¯”å¦‚ <code>auth</code> æ¨¡å—åšæˆç‹¬ç«‹ <code>microservice</code>ï¼Œæš´éœ² <code>gRPC</code> æ¥å£ï¼›ä¸» <code>api</code> åªæ¶ˆè´¹å®ƒï¼Œä¸è€¦åˆå®ç°ã€‚å…±äº« <code>libs/auth</code> åªæ”¾ç±»å‹å’Œ <code>DTO</code>ï¼Œé€»è¾‘å®Œå…¨éš”ç¦»ã€‚</p>
</li>
<li>
<p><strong>å…±äº« <code>libs</code> è¾¹ç•Œæ¸…æ™°</strong>ï¼š<code>libs/types</code>ã€<code>libs/db</code>ã€<code>libs/common</code> åªæ”¾æ¥å£ã€<code>schema</code>ã€å¸¸é‡ã€å·¥å…·å‡½æ•°ï¼Œä¸æ”¾ä¸šåŠ¡é€»è¾‘ã€‚<br/>
è¿™è®©æ¨¡å—é—´â€œå…±äº«çŸ¥è¯†ä½†ä¸å…±äº«çŠ¶æ€â€ï¼Œé¿å…äº†å•ä½“å¼çš„çº ç¼ ã€‚</p>
</li>
</ul>
<p>è¿™åœ¨ 2026 å¹´ <code>AI</code> é¡¹ç›®é‡Œç‰¹åˆ«å®ç”¨ï¼šæ ¸å¿ƒä¸šåŠ¡ç¨³ï¼Œ<code>AI</code> å¢å¼ºåŠŸèƒ½ï¼ˆ<code>RAG</code>ã€<code>Agent</code>ï¼‰å¯ä»¥å…ˆåšæˆç‹¬ç«‹ <code>worker</code> æˆ– <code>microservice</code>ï¼Œéšæ—¶åŠ å‡ã€‚</p>
<h3 data-id="heading-21">å›¢é˜Ÿåä½œä¸è§„èŒƒå¼ºåˆ¶ï¼š<code>monorepo</code> çš„â€œæŠ¤åŸæ²³â€æ•ˆåº”</h3>
<p><code>monorepo</code> æœ€å¤§çš„éšå½¢ä»·å€¼ï¼Œå…¶å®ä¸æ˜¯ä¸ªäººæ•ˆç‡ï¼Œè€Œæ˜¯å®ƒåœ¨å›¢é˜Ÿåä½œæ—¶çš„â€œæŠ¤åŸæ²³â€ä½œç”¨ã€‚</p>
<p><code>NestJS</code> + <code>Monorepo</code> çš„ç»“æ„æœ¬èº«å°±åƒä¸€å¥—å¼ºåˆ¶è§„èŒƒï¼š</p>
<ul>
<li>æ¯ä¸ª <code>domain</code> å¿…é¡»æœ‰è‡ªå·±çš„ <code>module</code>ã€<code>controller</code>ã€<code>service</code>ã€<code>dto</code>ã€‚</li>
<li>å…±äº«é€»è¾‘åªèƒ½æ”¾åœ¨ <code>libs/*</code>ï¼ˆ<code>types</code>ã€<code>db</code>ã€<code>auth</code>ã€<code>common</code>ï¼‰ï¼Œä¸å…è®¸ä¸šåŠ¡ä»£ç è·¨åŒ…æ±¡æŸ“ã€‚</li>
<li>å…¨å±€é…ç½®ï¼ˆå¦‚ <code>eslint</code>ã€<code>prettier</code>ã€<code>commitlint</code>ã€<code>ValidationPipe</code>ã€<code>Interceptors</code>ï¼‰åœ¨æ ¹ç›®å½•ç»Ÿä¸€ï¼Œä¸€æ”¹å…¨é¡¹ç›®ç”Ÿæ•ˆã€‚</li>
</ul>
<p>è¿™å¯¹å›¢é˜Ÿæ„å‘³ç€ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li><strong>æ–°äººä¸Šæ‰‹å¿«</strong>ï¼šç»“æ„å›ºå®šï¼Œæ–°äºº <code>clone repo</code> åä¸€çœ‹ç›®å½•å°±çŸ¥é“æ€ä¹ˆåŠ åŠŸèƒ½ã€‚<code>AI</code> ç”Ÿæˆçš„ä»£ç ä¹Ÿå¤©ç„¶ç¬¦åˆè§„èŒƒï¼Œä¸ç”¨é¢å¤–æ•™â€œæˆ‘ä»¬çš„é£æ ¼æ˜¯è¿™æ ·çš„â€ã€‚</li>
<li><strong>è§„èŒƒå¼ºåˆ¶æ‰§è¡Œ</strong>ï¼šæ²¡æœ‰â€œå£å¤´çº¦å®šâ€æˆ–â€œå¤§å®¶è‡ªå·±æ³¨æ„â€çš„æ¨¡ç³Šåœ°å¸¦ã€‚æƒ³åŠ ä¸€ä¸ªæ–°æ¥å£ï¼Ÿå¿…é¡»èµ° <code>NestJS</code> è£…é¥°å™¨ + <code>DTO</code> + <code>tRPC</code>ã€‚<code>AI</code> è¡¥å…¨æ—¶ä¹Ÿä¼šè‡ªåŠ¨éµå®ˆï¼Œå‡å°‘äº†é£æ ¼æ¼‚ç§»ã€‚</li>
<li><strong><code>code review</code> æ‘©æ“¦å¤§å¹…é™ä½</strong>ï¼šå› ä¸ºç±»å‹å®‰å…¨ + æ¨¡å—è¾¹ç•Œï¼Œ<code>AI</code> ç”Ÿæˆçš„ä»£ç å¾€å¾€æ˜¯â€œçœ‹èµ·æ¥å¯¹çš„â€ï¼Œ<code>review</code> é‡ç‚¹ä»â€œé£æ ¼å¯¹ä¸å¯¹â€è½¬å‘â€œä¸šåŠ¡é€»è¾‘å¯¹ä¸å¯¹â€ã€‚</li>
<li><strong>å¤šäººåä½œä¸ä¹±</strong>ï¼šæ”¹ <code>shared type</code> æ—¶ï¼Œ<code>Turborepo</code> ä¼šè‡ªåŠ¨æ£€æµ‹å½±å“èŒƒå›´ï¼Œ<code>build</code> åªè·‘ç›¸å…³çš„åŒ…ã€‚<code>merge conflict</code> å°‘äº†å¾ˆå¤šï¼Œå›¢é˜Ÿä¸ä¼šå› ä¸ºâ€œè°åŠ¨äº† <code>libs/auth</code>â€è€Œåµèµ·æ¥ã€‚</li>
</ul>
<p>å®é™…ä½“éªŒé‡Œï¼Œè¿™ä¸ªâ€œæŠ¤åŸæ²³â€åœ¨ 3 äººä»¥ä¸Šå°å›¢é˜Ÿæœ€æ˜æ˜¾ã€‚</p>
<p>ä¸€ä¸ªäººå†™æ—¶ï¼Œ<code>monorepo</code> åªæ˜¯æ–¹ä¾¿ï¼›å›¢é˜Ÿå†™æ—¶ï¼Œå®ƒæˆäº†é˜²æ­¢ä»£ç é€€åŒ–çš„é˜²ç«å¢™ã€‚</p>
<p><code>AI</code> æ—¶ä»£å°¤å…¶æœ‰ç”¨ï¼šå¤§å®¶ç”¨ <code>Cursor</code> / <code>Claude Code</code> ç”Ÿæˆä»£ç æ—¶ï¼Œé£æ ¼ç»Ÿä¸€ã€è¾¹ç•Œæ¸…æ™°ï¼Œå›¢é˜Ÿä¸ä¼šå› ä¸ºâ€œAI å†™çš„å¤ªä¹±â€è€Œäº’ç›¸æŒ‡è´£ã€‚</p>
<h3 data-id="heading-22">ç»“æ„å³ç”Ÿäº§åŠ›</h3>
<p>2026 å¹´ï¼Œ<code>AI</code> è¾…åŠ©å¼€å‘å·²æˆä¸ºæ ‡é…ï¼Œä½†å…¶æ•ˆç‡é«˜åº¦ä¾èµ–é¡¹ç›®ç»“æ„ã€‚</p>
<p><code>NestJS</code> + <code>Monorepo</code> è®©æˆ‘è¶Šæ¥è¶Šç¦»ä¸å¼€å®ƒï¼š<code>monorepo</code> è§£å†³ä¸Šä¸‹æ–‡ç¢ç‰‡ï¼Œè®© <code>AI</code> ä¸€æ¬¡æ€§çœ‹å…¨é¡¹ç›®ï¼›</p>
<p><code>NestJS</code> çš„æ¨¡å—åŒ–ã€<code>DI</code>ã€è£…é¥°å™¨æä¾›â€œå¤©ç„¶æç¤ºâ€ï¼Œè§„èŒƒå¼ºåˆ¶æ‰§è¡Œï¼Œå‡å°‘ <code>hallucination</code> å’Œé£æ ¼æ¼‚ç§»ï¼›<code>tRPC</code> + <code>shared libs</code> å®ç°ç«¯åˆ°ç«¯ç±»å‹å®‰å…¨ï¼Œå‰åç«¯é—­ç¯é¡ºæ»‘ï¼›</p>
<p><code>Turborepo</code> ç¼“å­˜è®©è¿­ä»£é£èµ·ï¼Œç‹¬ç«‹éƒ¨ç½² + å¾®æœåŠ¡å‹å¥½é¿å…å•ä½“é™·é˜±ï¼›ç¤¾åŒº <code>boilerplate</code> çˆ†å‘ï¼Œä¸Šæ‰‹å¿«ï¼Œå›¢é˜Ÿåä½œæ›´ç¨³ã€‚</p>
<p>å®ƒä¸æ˜¯æœ€æ½®çš„æ¡†æ¶ï¼Œå´æ˜¯æœ€èƒ½è®© <code>AI</code> å†™å‡ºå¯ç»´æŠ¤ã€å¯ <code>review</code>ã€å¯é•¿æœŸæ¼”è¿›ä»£ç çš„ç»„åˆã€‚</p>
<p>å…¨æ ˆåå‰ç«¯çš„å¼€å‘è€…ç”¨å®ƒï¼Œå¼€å‘ä»â€œå‰åå‰²è£‚â€å˜æˆâ€œå®‰é™åˆä½œâ€ã€‚</p>
<p>åœ¨ <code>AI</code> æ—¶ä»£ï¼Œç»“æ„å³ç”Ÿäº§åŠ›ï¼Œè€Œè¿™ä¸ªç»„åˆï¼Œæ­£æ˜¯æˆ‘ç›®å‰æœ€èˆ’æœçš„ç»“æ„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernateï¼ˆ59ï¼‰Hibernateçš„SQLæ—¥å¿—å¦‚ä½•æŸ¥çœ‹ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7598287024077832232</link>    <guid>https://juejin.cn/post/7598287024077832232</guid>    <pubDate>2026-01-23T11:53:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598287024077832232" data-draft-id="7598355220830339124" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernateï¼ˆ59ï¼‰Hibernateçš„SQLæ—¥å¿—å¦‚ä½•æŸ¥çœ‹ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-23T11:53:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernateï¼ˆ59ï¼‰Hibernateçš„SQLæ—¥å¿—å¦‚ä½•æŸ¥çœ‹ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T11:53:23.000Z" title="Fri Jan 23 2026 11:53:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å¼€å‘å’Œè°ƒè¯•Hibernateåº”ç”¨ç¨‹åºæ—¶ï¼ŒæŸ¥çœ‹ç”Ÿæˆçš„SQLæ—¥å¿—æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚Hibernateæä¾›äº†å¤šç§æ–¹å¼æ¥æŸ¥çœ‹SQLæ—¥å¿—ï¼ŒåŒ…æ‹¬é€šè¿‡é…ç½®æ–‡ä»¶å’Œç¼–ç¨‹æ–¹å¼æ¥å¯ç”¨SQLæ—¥å¿—è®°å½•ã€‚ä¸‹é¢å°†è¯¦ç»†è§£é‡Šå¦‚ä½•é…ç½®å’ŒæŸ¥çœ‹Hibernateçš„SQLæ—¥å¿—ï¼Œå¹¶ç»“åˆä»£ç ç¤ºä¾‹è¯´æ˜ã€‚</p>
<h3 data-id="heading-0">1. é€šè¿‡é…ç½®æ–‡ä»¶å¯ç”¨SQLæ—¥å¿—</h3>
<h4 data-id="heading-1">é…ç½®Hibernate</h4>
<p>åœ¨<code>hibernate.cfg.xml</code>ä¸­å¯ç”¨SQLæ—¥å¿—è¾“å‡ºå’Œæ ¼å¼åŒ–ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span>
        <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span>
        <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ•°æ®åº“è¿æ¥é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/your_database<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>your_username<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>your_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- Hibernate å±æ€§é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.show_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.format_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.use_sql_comments"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- æ˜ å°„ç±» --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Product"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<ul>
<li><code>hibernate.show_sql</code>ï¼šå°†ç”Ÿæˆçš„SQLè¾“å‡ºåˆ°æ§åˆ¶å°ï¼ˆæ ‡å‡†è¾“å‡ºï¼‰ã€‚</li>
<li><code>hibernate.format_sql</code>ï¼šæ ¼å¼åŒ–SQLè¾“å‡ºï¼Œä½¿å…¶æ›´å…·å¯è¯»æ€§ã€‚</li>
<li><code>hibernate.use_sql_comments</code>ï¼šåœ¨ç”Ÿæˆçš„SQLä¸­æ·»åŠ æ³¨é‡Šï¼Œå¸®åŠ©å¼€å‘è€…ç†è§£æ¯ä¸ªSQLç‰‡æ®µçš„æ¥æºã€‚</li>
</ul>
<h4 data-id="heading-2">Mavenä¾èµ–ï¼ˆå¦‚æœä½¿ç”¨Mavenï¼‰</h4>
<p>ç¡®ä¿åœ¨<code>pom.xml</code>ä¸­åŒ…å«<code>slf4j</code>å’Œ<code>logback</code>ä¾èµ–ï¼Œä»¥ä¾¿æ—¥å¿—è®°å½•ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Hibernate dependencies --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.hibernate<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hibernate-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.4.0.Final<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- SLF4J and Logback for logging --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.7.30<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>ch.qos.logback<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>logback-classic<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h4 data-id="heading-3">é…ç½®Logback</h4>
<p>åˆ›å»º<code>logback.xml</code>æ–‡ä»¶ï¼Œé…ç½®æ—¥å¿—è®°å½•çº§åˆ«ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">appender</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"STDOUT"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"ch.qos.logback.core.ConsoleAppender"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">encoder</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">pattern</span>&gt;</span>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n<span class="hljs-tag">&lt;/<span class="hljs-name">pattern</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">encoder</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">appender</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"org.hibernate.SQL"</span> <span class="hljs-attr">level</span>=<span class="hljs-string">"DEBUG"</span> <span class="hljs-attr">additivity</span>=<span class="hljs-string">"false"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">appender-ref</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"STDOUT"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">logger</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"org.hibernate.type.descriptor.sql.BasicBinder"</span> <span class="hljs-attr">level</span>=<span class="hljs-string">"TRACE"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">appender-ref</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"STDOUT"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">logger</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">root</span> <span class="hljs-attr">level</span>=<span class="hljs-string">"INFO"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">appender-ref</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"STDOUT"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">root</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
</code></pre>
<ul>
<li><code>org.hibernate.SQL</code>ï¼šè®°å½•Hibernateç”Ÿæˆçš„SQLè¯­å¥ã€‚</li>
<li><code>org.hibernate.type.descriptor.sql.BasicBinder</code>ï¼šè®°å½•SQLå‚æ•°ç»‘å®šä¿¡æ¯ã€‚</li>
</ul>
<h3 data-id="heading-4">2. ç¼–ç¨‹æ–¹å¼å¯ç”¨SQLæ—¥å¿—</h3>
<p>é™¤äº†é€šè¿‡é…ç½®æ–‡ä»¶å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ç¼–ç¨‹æ–¹å¼å¯ç”¨SQLæ—¥å¿—ã€‚</p>
<h4 data-id="heading-5">é…ç½®Hibernate</h4>
<p>åœ¨<code>hibernate.cfg.xml</code>ä¸­é…ç½®åŸºæœ¬çš„Hibernateå±æ€§ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span>
        <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span>
        <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ•°æ®åº“è¿æ¥é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/your_database<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>your_username<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>your_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- Hibernate å±æ€§é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- æ˜ å°„ç±» --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Product"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<h4 data-id="heading-6">ç¼–ç¨‹æ–¹å¼å¯ç”¨SQLæ—¥å¿—</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;
<span class="hljs-keyword">import</span> org.slf4j.Logger;
<span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateSQLLoggingExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(HibernateSQLLoggingExample.class);
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-type">Configuration</span> <span class="hljs-variable">configuration</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>);
        configuration.setProperty(<span class="hljs-string">"hibernate.show_sql"</span>, <span class="hljs-string">"true"</span>);
        configuration.setProperty(<span class="hljs-string">"hibernate.format_sql"</span>, <span class="hljs-string">"true"</span>);
        configuration.setProperty(<span class="hljs-string">"hibernate.use_sql_comments"</span>, <span class="hljs-string">"true"</span>);
        sessionFactory = configuration.buildSessionFactory();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>();
            product.setName(<span class="hljs-string">"Product B"</span>);
            product.setPrice(<span class="hljs-number">200.0</span>);
            session.save(product);
            transaction.commit();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (transaction != <span class="hljs-literal">null</span>) {
                transaction.rollback();
            }
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            session.close();
        }
    }
}
</code></pre>
<h3 data-id="heading-7">3. æŸ¥çœ‹SQLæ—¥å¿—</h3>
<p>è¿è¡Œç¨‹åºåï¼Œå¯ä»¥åœ¨æ§åˆ¶å°çœ‹åˆ°æ ¼å¼åŒ–çš„SQLæ—¥å¿—å’Œå‚æ•°ç»‘å®šä¿¡æ¯ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">10:23:45.678 <span class="hljs-section">[main]</span> DEBUG org.hibernate.SQL - 
    insert 
    into
        product
        (name, price, id) 
    values
        (?, ?, ?)
10:23:45.680 <span class="hljs-section">[main]</span> TRACE org.hibernate.type.descriptor.sql.BasicBinder - binding parameter <span class="hljs-section">[1]</span> as <span class="hljs-section">[VARCHAR]</span> - Product B
10:23:45.681 <span class="hljs-section">[main]</span> TRACE org.hibernate.type.descriptor.sql.BasicBinder - binding parameter <span class="hljs-section">[2]</span> as <span class="hljs-section">[DOUBLE]</span> - 200.0
10:23:45.682 <span class="hljs-section">[main]</span> TRACE org.hibernate.type.descriptor.sql.BasicBinder - binding parameter <span class="hljs-section">[3]</span> as <span class="hljs-section">[BIGINT]</span> - 1
</code></pre>
<h3 data-id="heading-8">æ€»ç»“</h3>
<ol>
<li><strong>é€šè¿‡é…ç½®æ–‡ä»¶å¯ç”¨SQLæ—¥å¿—</strong>ï¼šåœ¨<code>hibernate.cfg.xml</code>ä¸­é…ç½®<code>hibernate.show_sql</code>ã€<code>hibernate.format_sql</code>å’Œ<code>hibernate.use_sql_comments</code>ç­‰å±æ€§ã€‚</li>
<li><strong>é…ç½®æ—¥å¿—æ¡†æ¶</strong>ï¼šä½¿ç”¨SLF4Jå’ŒLogbackè®°å½•SQLæ—¥å¿—ï¼Œå¹¶åœ¨<code>logback.xml</code>ä¸­é…ç½®æ—¥å¿—çº§åˆ«ã€‚</li>
<li><strong>ç¼–ç¨‹æ–¹å¼å¯ç”¨SQLæ—¥å¿—</strong>ï¼šé€šè¿‡ç¼–ç¨‹æ–¹å¼åŠ¨æ€è®¾ç½®Hibernateå±æ€§ã€‚</li>
<li><strong>æŸ¥çœ‹SQLæ—¥å¿—</strong>ï¼šè¿è¡Œç¨‹åºåï¼Œåœ¨æ§åˆ¶å°æŸ¥çœ‹æ ¼å¼åŒ–çš„SQLæ—¥å¿—å’Œå‚æ•°ç»‘å®šä¿¡æ¯ã€‚</li>
</ol>
<p>é€šè¿‡è¿™äº›æ–¹æ³•ï¼Œå¯ä»¥æ–¹ä¾¿åœ°æŸ¥çœ‹å’Œè°ƒè¯•Hibernateç”Ÿæˆçš„SQLè¯­å¥ï¼Œå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°ç†è§£å’Œä¼˜åŒ–æ•°æ®åº“æ“ä½œã€‚å¸Œæœ›è¿™äº›è¯¦ç»†çš„è§£é‡Šå’Œä»£ç ç¤ºä¾‹èƒ½å¸®åŠ©æ‚¨æ›´å¥½åœ°æŸ¥çœ‹å’Œç®¡ç†Hibernateçš„SQLæ—¥å¿—ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernateï¼ˆ60ï¼‰Hibernateçš„å»¶è¿ŸåŠ è½½å¦‚ä½•é…ç½®ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7598402961904189492</link>    <guid>https://juejin.cn/post/7598402961904189492</guid>    <pubDate>2026-01-23T11:54:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598402961904189492" data-draft-id="7598287024077848616" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernateï¼ˆ60ï¼‰Hibernateçš„å»¶è¿ŸåŠ è½½å¦‚ä½•é…ç½®ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-23T11:54:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernateï¼ˆ60ï¼‰Hibernateçš„å»¶è¿ŸåŠ è½½å¦‚ä½•é…ç½®ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T11:54:10.000Z" title="Fri Jan 23 2026 11:54:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Hibernateçš„å»¶è¿ŸåŠ è½½ï¼ˆLazy Loadingï¼‰æ˜¯ä¸€ç§ä¼˜åŒ–æŠ€æœ¯ï¼Œå®ƒå…è®¸åœ¨å®é™…éœ€è¦æ•°æ®æ—¶æ‰ä»æ•°æ®åº“ä¸­åŠ è½½æ•°æ®ï¼Œè€Œä¸æ˜¯åœ¨åˆå§‹æŸ¥è¯¢æ—¶å…¨éƒ¨åŠ è½½ã€‚å»¶è¿ŸåŠ è½½å¯¹äºæé«˜æ€§èƒ½å’Œå‡å°‘å†…å­˜æ¶ˆè€—éå¸¸æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯å¯¹äºåŒ…å«å¤§é‡å…³è”å¯¹è±¡çš„å¤æ‚å®ä½“ã€‚</p>
<p>ä»¥ä¸‹æ˜¯è¯¦ç»†çš„é…ç½®æ­¥éª¤å’Œä»£ç ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•åœ¨Hibernateä¸­é…ç½®å’Œä½¿ç”¨å»¶è¿ŸåŠ è½½ã€‚</p>
<h3 data-id="heading-0">1. ä½¿ç”¨æ³¨è§£é…ç½®å»¶è¿ŸåŠ è½½</h3>
<p>Hibernateé»˜è®¤å¯ç”¨äº†å»¶è¿ŸåŠ è½½ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡æ³¨è§£è¿›ä¸€æ­¥æ§åˆ¶å…·ä½“çš„åŠ è½½è¡Œä¸ºã€‚</p>
<h4 data-id="heading-1">1.1 å»¶è¿ŸåŠ è½½å•ä¸ªå®ä½“</h4>
<p>åœ¨å®ä½“ç±»ä¸­ï¼Œé€šè¿‡è®¾ç½®<code>fetch</code>å±æ€§ä¸º<code>FetchType.LAZY</code>æ¥å¯ç”¨å»¶è¿ŸåŠ è½½ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "product")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Product</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-meta">@Column(name = "name")</span>
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-meta">@Column(name = "price")</span>
    <span class="hljs-keyword">private</span> Double price;

    <span class="hljs-comment">// Getters and Setters</span>
}
</code></pre>
<h4 data-id="heading-2">1.2 å»¶è¿ŸåŠ è½½å…³è”å…³ç³»</h4>
<p>å¯¹äºå…³è”å…³ç³»ï¼Œä¾‹å¦‚<code>@OneToMany</code>ã€<code>@ManyToOne</code>ã€<code>@OneToOne</code>å’Œ<code>@ManyToMany</code>ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®<code>fetch</code>å±æ€§ä¸º<code>FetchType.LAZY</code>æ¥å¯ç”¨å»¶è¿ŸåŠ è½½ã€‚</p>
<h5 data-id="heading-3">ç¤ºä¾‹ï¼š<code>@ManyToOne</code>å’Œ<code>@OneToMany</code></h5>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªå®ä½“ç±»ï¼š<code>Category</code>å’Œ<code>Product</code>ï¼Œå®ƒä»¬ä¹‹é—´å­˜åœ¨<code>@OneToMany</code>å’Œ<code>@ManyToOne</code>çš„å…³ç³»ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> javax.persistence.*;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "category")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Category</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-meta">@Column(name = "name")</span>
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-meta">@OneToMany(mappedBy = "category", fetch = FetchType.LAZY)</span>
    <span class="hljs-keyword">private</span> List&lt;Product&gt; products;

    <span class="hljs-comment">// Getters and Setters</span>
}

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "product")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Product</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-meta">@Column(name = "name")</span>
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-meta">@Column(name = "price")</span>
    <span class="hljs-keyword">private</span> Double price;

    <span class="hljs-meta">@ManyToOne(fetch = FetchType.LAZY)</span>
    <span class="hljs-meta">@JoinColumn(name = "category_id")</span>
    <span class="hljs-keyword">private</span> Category category;

    <span class="hljs-comment">// Getters and Setters</span>
}
</code></pre>
<h3 data-id="heading-4">2. é€šè¿‡é…ç½®æ–‡ä»¶é…ç½®å»¶è¿ŸåŠ è½½</h3>
<p>åœ¨<code>hibernate.cfg.xml</code>ä¸­é…ç½®Hibernateçš„å±æ€§ï¼Œä¹Ÿå¯ä»¥æ§åˆ¶å»¶è¿ŸåŠ è½½è¡Œä¸ºã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span>
        <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span>
        <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ•°æ®åº“è¿æ¥é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/your_database<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>your_username<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>your_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- Hibernate å±æ€§é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.show_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- å¯ç”¨å»¶è¿ŸåŠ è½½ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.default_batch_fetch_size"</span>&gt;</span>16<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.enable_lazy_load_no_trans"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- æ˜ å°„ç±» --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Category"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Product"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<ul>
<li><code>hibernate.default_batch_fetch_size</code>ï¼šé»˜è®¤æ‰¹é‡æŠ“å–å¤§å°ï¼Œé…ç½®ä¸€ä¸ªåˆç†çš„å€¼å¯ä»¥å‡å°‘N+1æŸ¥è¯¢é—®é¢˜ã€‚</li>
<li><code>hibernate.enable_lazy_load_no_trans</code>ï¼šå…è®¸åœ¨æ²¡æœ‰äº‹åŠ¡çš„æƒ…å†µä¸‹å»¶è¿ŸåŠ è½½ï¼ˆé€šå¸¸ä¸æ¨èåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¯ç”¨ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-5">3. ä½¿ç”¨Hibernateä¼šè¯åŠ è½½å»¶è¿ŸåŠ è½½çš„æ•°æ®</h3>
<p>ä¸ºäº†æŸ¥çœ‹å»¶è¿ŸåŠ è½½çš„æ•ˆæœï¼Œéœ€è¦åœ¨äº‹åŠ¡èŒƒå›´å†…è®¿é—®å»¶è¿ŸåŠ è½½çš„å±æ€§ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateLazyLoadingExample</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            sessionFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>).buildSessionFactory();
        } <span class="hljs-keyword">catch</span> (Throwable ex) {
            System.err.println(<span class="hljs-string">"Initial SessionFactory creation failed."</span> + ex);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExceptionInInitializerError</span>(ex);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Category</span> <span class="hljs-variable">category</span> <span class="hljs-operator">=</span> session.get(Category.class, <span class="hljs-number">1L</span>);
            System.out.println(<span class="hljs-string">"Category Name: "</span> + category.getName());

            <span class="hljs-comment">// å»¶è¿ŸåŠ è½½ï¼Œæ­¤æ—¶productsè¿˜æœªè¢«åŠ è½½</span>
            List&lt;Product&gt; products = category.getProducts();

            <span class="hljs-comment">// è®¿é—®productså±æ€§ï¼Œè§¦å‘å»¶è¿ŸåŠ è½½</span>
            <span class="hljs-keyword">for</span> (Product product : products) {
                System.out.println(<span class="hljs-string">"Product Name: "</span> + product.getName());
            }

            transaction.commit();
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (transaction != <span class="hljs-literal">null</span>) {
                transaction.rollback();
            }
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            session.close();
        }
    }
}
</code></pre>
<h3 data-id="heading-6">4. é¿å…N+1æŸ¥è¯¢é—®é¢˜</h3>
<p>å»¶è¿ŸåŠ è½½åœ¨å¤„ç†å…³è”å…³ç³»æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°N+1æŸ¥è¯¢é—®é¢˜ï¼Œå³åŠ è½½ä¸€ä¸ªå¯¹è±¡é›†åˆæ—¶ï¼Œä¼šé¢å¤–æ‰§è¡Œå¤šæ¬¡å•ç‹¬æŸ¥è¯¢ã€‚å¯ä»¥é€šè¿‡æ‰¹é‡æŠ“å–æ¥ä¼˜åŒ–ã€‚</p>
<h4 data-id="heading-7">æ‰¹é‡æŠ“å–ç¤ºä¾‹</h4>
<p>åœ¨å‰é¢çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬å·²ç»è®¾ç½®äº†<code>hibernate.default_batch_fetch_size</code>ã€‚åœ¨å®ä½“ç±»ä¸Šä¹Ÿå¯ä»¥ä½¿ç”¨<code>@BatchSize</code>æ³¨è§£æ¥æ§åˆ¶æ‰¹é‡æŠ“å–çš„å¤§å°ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> javax.persistence.*;
<span class="hljs-keyword">import</span> org.hibernate.annotations.BatchSize;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "category")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Category</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-meta">@Column(name = "name")</span>
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-meta">@OneToMany(mappedBy = "category", fetch = FetchType.LAZY)</span>
    <span class="hljs-meta">@BatchSize(size = 10)</span>
    <span class="hljs-keyword">private</span> List&lt;Product&gt; products;

    <span class="hljs-comment">// Getters and Setters</span>
}
</code></pre>
<h3 data-id="heading-8">æ€»ç»“</h3>
<ol>
<li><strong>ä½¿ç”¨æ³¨è§£é…ç½®å»¶è¿ŸåŠ è½½</strong>ï¼šåœ¨å®ä½“ç±»å’Œå…³è”å…³ç³»ä¸Šé€šè¿‡æ³¨è§£é…ç½®<code>FetchType.LAZY</code>ã€‚</li>
<li><strong>é€šè¿‡é…ç½®æ–‡ä»¶é…ç½®å»¶è¿ŸåŠ è½½</strong>ï¼šåœ¨<code>hibernate.cfg.xml</code>ä¸­è®¾ç½®å»¶è¿ŸåŠ è½½ç›¸å…³çš„å±æ€§ã€‚</li>
<li><strong>åœ¨äº‹åŠ¡èŒƒå›´å†…ä½¿ç”¨å»¶è¿ŸåŠ è½½</strong>ï¼šç¡®ä¿åœ¨äº‹åŠ¡èŒƒå›´å†…è®¿é—®å»¶è¿ŸåŠ è½½çš„å±æ€§ï¼Œä»¥è§¦å‘æ•°æ®åŠ è½½ã€‚</li>
<li><strong>é¿å…N+1æŸ¥è¯¢é—®é¢˜</strong>ï¼šé€šè¿‡æ‰¹é‡æŠ“å–é…ç½®ï¼Œå‡å°‘æ•°æ®åº“æŸ¥è¯¢æ¬¡æ•°ï¼Œæé«˜æ€§èƒ½ã€‚</li>
</ol>
<p>é€šè¿‡è¿™äº›æ–¹æ³•ï¼Œå¯ä»¥æœ‰æ•ˆåœ°é…ç½®å’Œä½¿ç”¨Hibernateçš„å»¶è¿ŸåŠ è½½ï¼Œä¼˜åŒ–åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œèµ„æºä½¿ç”¨ã€‚å¸Œæœ›è¿™äº›è¯¦ç»†çš„è§£é‡Šå’Œä»£ç ç¤ºä¾‹èƒ½å¸®åŠ©æ‚¨æ›´å¥½åœ°ç†è§£å’Œåº”ç”¨Hibernateçš„å»¶è¿ŸåŠ è½½æŠ€æœ¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨ Docker å®ç°å¼€å‘ç¯å¢ƒçš„ä¸€è‡´æ€§ç®¡ç†]]></title>    <link>https://juejin.cn/post/7598260824223006763</link>    <guid>https://juejin.cn/post/7598260824223006763</guid>    <pubDate>2026-01-23T09:52:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598260824223006763" data-draft-id="7598376873546580011" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨ Docker å®ç°å¼€å‘ç¯å¢ƒçš„ä¸€è‡´æ€§ç®¡ç†"/> <meta itemprop="keywords" content="Docker"/> <meta itemprop="datePublished" content="2026-01-23T09:52:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="jcj"/> <meta itemprop="url" content="https://juejin.cn/user/3525486571169616"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨ Docker å®ç°å¼€å‘ç¯å¢ƒçš„ä¸€è‡´æ€§ç®¡ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3525486571169616/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    jcj
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T09:52:59.000Z" title="Fri Jan 23 2026 09:52:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä½¿ç”¨ Docker å®ç°å¼€å‘ç¯å¢ƒçš„ä¸€è‡´æ€§ç®¡ç†</h2>
<p>åœ¨ç°ä»£è½¯ä»¶å¼€å‘ä¸­ï¼Œä¸€ä¸ªå¸¸è§çš„ç—›ç‚¹æ˜¯â€œåœ¨æˆ‘æœºå™¨ä¸Šèƒ½è·‘â€ï¼ˆIt works on my machineï¼‰çš„é—®é¢˜ã€‚ä¸åŒå¼€å‘è€…ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿã€ä¾èµ–åº“ç‰ˆæœ¬ã€ç¯å¢ƒå˜é‡ç­‰å­˜åœ¨å·®å¼‚ï¼Œå¯¼è‡´ä»£ç åœ¨æœ¬åœ°è¿è¡Œæ­£å¸¸ï¼Œä½†åœ¨æµ‹è¯•æˆ–ç”Ÿäº§ç¯å¢ƒä¸­å´å‡ºç°å„ç§é—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸€éš¾é¢˜ï¼ŒDocker æŠ€æœ¯æä¾›äº†ä¸€ç§é«˜æ•ˆã€å¯å¤ç”¨çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>Docker æ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨åŒ–å¹³å°ï¼Œå®ƒå…è®¸å¼€å‘è€…å°†åº”ç”¨ç¨‹åºåŠå…¶æ‰€æœ‰ä¾èµ–æ‰“åŒ…åˆ°ä¸€ä¸ªè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ä¸­ã€‚è¿™ä¸ªå®¹å™¨å¯ä»¥åœ¨ä»»ä½•å®‰è£…äº† Docker çš„ç³»ç»Ÿä¸Šè¿è¡Œï¼Œä»è€Œç¡®ä¿å¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒçš„ä¸€è‡´æ€§ã€‚</p>
<p>ä»¥ä¸€ä¸ªå…¸å‹çš„ Web åº”ç”¨ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª <code>Dockerfile</code> æ¥å®šä¹‰è¿è¡Œç¯å¢ƒï¼š</p>
<pre><code class="hljs language-Dockerfile" lang="Dockerfile">FROM python:3.10-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt
COPY . .
CMD ["python", "app.py"]
</code></pre>
<p>é€šè¿‡è¯¥æ–‡ä»¶ï¼Œæˆ‘ä»¬æŒ‡å®šäº†åŸºç¡€é•œåƒï¼ˆPython 3.10ï¼‰ã€å·¥ä½œç›®å½•ã€ä¾èµ–å®‰è£…æ–¹å¼ä»¥åŠå¯åŠ¨å‘½ä»¤ã€‚å›¢é˜Ÿæˆå‘˜åªéœ€è¿è¡Œ <code>docker build -t myapp .</code> å’Œ <code>docker run -p 5000:5000 myapp</code>ï¼Œå³å¯åœ¨æœ¬åœ°å¯åŠ¨å®Œå…¨ä¸€è‡´çš„åº”ç”¨ç¯å¢ƒã€‚</p>
<p>æ­¤å¤–ï¼Œç»“åˆ <code>docker-compose.yml</code> æ–‡ä»¶ï¼Œè¿˜å¯ä»¥è½»æ¾ç®¡ç†å¤šæœåŠ¡åº”ç”¨ï¼ˆå¦‚æ•°æ®åº“ã€ç¼“å­˜ã€å‰ç«¯ç­‰ï¼‰ï¼Œè¿›ä¸€æ­¥æå‡å¼€å‘æ•ˆç‡ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">'3'</span>
<span class="hljs-attr">services:</span>
  <span class="hljs-attr">web:</span>
    <span class="hljs-attr">build:</span> <span class="hljs-string">.</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"5000:5000"</span>
  <span class="hljs-attr">redis:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">"redis:alpine"</span>
</code></pre>
<p>é€šè¿‡ Dockerï¼Œä¸ä»…è§£å†³äº†ç¯å¢ƒä¸ä¸€è‡´çš„é—®é¢˜ï¼Œè¿˜ç®€åŒ–äº†éƒ¨ç½²æµç¨‹ï¼Œæå‡äº†å›¢é˜Ÿåä½œæ•ˆç‡ã€‚å¯¹äºè¿½æ±‚ DevOps å’ŒæŒç»­é›†æˆ/æŒç»­äº¤ä»˜ï¼ˆCI/CDï¼‰çš„å›¢é˜Ÿæ¥è¯´ï¼ŒDocker å·²æˆä¸ºä¸å¯æˆ–ç¼ºçš„åŸºç¡€è®¾æ–½å·¥å…·ã€‚</p>
<p>æ€»ä¹‹ï¼Œåˆç†ä½¿ç”¨ Docker å¯ä»¥æ˜¾è‘—é™ä½ç¯å¢ƒé…ç½®æˆæœ¬ï¼Œæé«˜è½¯ä»¶äº¤ä»˜è´¨é‡ä¸é€Ÿåº¦ï¼Œå€¼å¾—æ¯ä¸€ä½å¼€å‘è€…æ·±å…¥æŒæ¡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[vue3+viteä½¿ç”¨unocsså’Œvantåšç§»åŠ¨ç«¯å¼€å‘é€‚é…,ä½¿ç”¨lib-flexibleé€‚é…RemToPx]]></title>    <link>https://juejin.cn/post/7598181989969215515</link>    <guid>https://juejin.cn/post/7598181989969215515</guid>    <pubDate>2026-01-23T09:43:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598181989969215515" data-draft-id="7598103558887292974" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="vue3+viteä½¿ç”¨unocsså’Œvantåšç§»åŠ¨ç«¯å¼€å‘é€‚é…,ä½¿ç”¨lib-flexibleé€‚é…RemToPx"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,CSS"/> <meta itemprop="datePublished" content="2026-01-23T09:43:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§æµ·ä¹‹ä¸Šæ²¡æœ‰é±¼"/> <meta itemprop="url" content="https://juejin.cn/user/2216269258969192"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            vue3+viteä½¿ç”¨unocsså’Œvantåšç§»åŠ¨ç«¯å¼€å‘é€‚é…,ä½¿ç”¨lib-flexibleé€‚é…RemToPx
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2216269258969192/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§æµ·ä¹‹ä¸Šæ²¡æœ‰é±¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T09:43:08.000Z" title="Fri Jan 23 2026 09:43:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    13
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">lib-flexibleè®¾ç½®æ ¹å­—å·</h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">npm</span> <span class="hljs-selector-tag">i</span> <span class="hljs-selector-tag">lib-flexible</span>
<span class="hljs-comment">//ç„¶ååœ¨mian.jsä¸­å¼•å…¥</span>
</code></pre>
<h3 data-id="heading-1">uno.config.jsè®¾ç½®</h3>
<p>æ ¹ç›®å½•åˆ›å»ºuno.config.jsæ–‡ä»¶ï¼Œéœ€è¦å®‰è£…
npm i @unocss/preset-rem-to-px</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { defineConfig, presetWind3 } <span class="hljs-keyword">from</span> <span class="hljs-string">'unocss'</span>
<span class="hljs-keyword">import</span> presetRemToPx <span class="hljs-keyword">from</span> <span class="hljs-string">'@unocss/preset-rem-to-px'</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
    <span class="hljs-attr">presets</span>: [
        <span class="hljs-title function_">presetWind3</span>(),  <span class="hljs-comment">//é¢„è®¾æ ·å¼</span>
        <span class="hljs-title function_">presetRemToPx</span>()  <span class="hljs-comment">// é‡ç‚¹ï¼ŒæŠŠé¢„è®¾çš„remè½¬æˆpxï¼Œè¿™æ ·postCssPxToRemå°±å¯ä»¥è½¬äº† ä¾‹å¦‚é¢„è®¾æ ·å¼ text-baseçš„font-size:1rem;ç»è¿‡è½¬æ¢å˜æˆ16pxï¼Œåœ¨ç»è¿‡postCssPxToRemè½¬æ¢æˆrem</span>
    ]
})
</code></pre>
<h3 data-id="heading-2">è¿™ä¸ªæ˜¯viteçš„é…ç½®</h3>
<pre><code class="hljs language-php" lang="php">import postCssPxToRem <span class="hljs-keyword">from</span> <span class="hljs-string">'postcss-pxtorem'</span>
import UnoCSS <span class="hljs-keyword">from</span> <span class="hljs-string">'unocss/vite'</span>

export <span class="hljs-keyword">default</span> <span class="hljs-title function_ invoke__">defineConfig</span>({
    <span class="hljs-attr">plugins</span>: [
        <span class="hljs-title function_ invoke__">UnoCSS</span>(),
    ],
    <span class="hljs-attr">css</span>: {
        <span class="hljs-attr">postcss</span>: {
            <span class="hljs-attr">plugins</span>: [
                <span class="hljs-title function_ invoke__">postCssPxToRem</span>({
                  <span class="hljs-attr">rootValue</span>: <span class="hljs-number">37.5</span>,
                  <span class="hljs-attr">unitPrecision</span>: <span class="hljs-number">6</span>,
                  <span class="hljs-attr">minPixelValue</span>: <span class="hljs-number">1</span>,
                  <span class="hljs-attr">propList</span>: [<span class="hljs-string">'*'</span>],
                  <span class="hljs-attr">mediaQuery</span>: <span class="hljs-literal">false</span>,
                })
            ]
        }
    }
)}
</code></pre>
<p>å…¶ä»–çš„æŒ‰ç…§vantæ–‡æ¡£æ­£å¸¸ä½¿ç”¨å°±å¥½äº†</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[IDEA 2025.3.1.1 ç´§æ€¥å‘å¸ƒï¼Œä¿®å¤é‡å¤§BUG]]></title>    <link>https://juejin.cn/post/7598382710294331392</link>    <guid>https://juejin.cn/post/7598382710294331392</guid>    <pubDate>2026-01-23T09:57:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598382710294331392" data-draft-id="7598355220829978676" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="IDEA 2025.3.1.1 ç´§æ€¥å‘å¸ƒï¼Œä¿®å¤é‡å¤§BUG"/> <meta itemprop="keywords" content="IntelliJ IDEA"/> <meta itemprop="datePublished" content="2026-01-23T09:57:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ahubbub"/> <meta itemprop="url" content="https://juejin.cn/user/2999123451061160"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            IDEA 2025.3.1.1 ç´§æ€¥å‘å¸ƒï¼Œä¿®å¤é‡å¤§BUG
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2999123451061160/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ahubbub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T09:57:42.000Z" title="Fri Jan 23 2026 09:57:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">IDEA 2025.3.1.1 ç´§æ€¥å‘å¸ƒï¼Œä¿®å¤é‡å¤§BUG</h2>
<p><code>IntelliJ IDEA 2025.3</code> å‘å¸ƒåï¼Œæ›´æ–°èŠ‚å¥å¿«å¾—æœ‰ç‚¹â€œè¿½ç€äººè·‘â€ã€‚<code>2025.3.1</code> ä½œä¸ºé¦–ä¸ªè¡¥ä¸ç‰ˆæœ¬ï¼Œæœ¬æ¥æ˜¯æ¥ä¿® bugã€ç¨³ä½“éªŒçš„ã€‚</p>
<p>ä½†å¾ˆå¤šåŒå­¦å‡å®Œå‘ç°ä¸å¯¹åŠ²ï¼šMaven é¡¹ç›®ä¸€æ‰“å¼€å°±å¼€å§‹ç‹‚åƒ CPU/å†…å­˜ï¼Œç”šè‡³ç›´æ¥å‡æ­»ï¼›ç”¨ WSL2 å¼€å‘çš„ï¼Œé‡å¯ IDE åé…ç½®è¿˜ä¼šè«åå…¶å¦™ä¸¢ä¸€éƒ¨åˆ†ã€‚</p>
<p>å› æ­¤ JetBrains å‘å¸ƒäº† <code>2025.3.1.1</code> ä½œä¸ºç´§æ€¥ä¿®å¤ç‰ˆæœ¬ï¼ˆhotfixï¼‰ã€‚å¦‚æœä½ è¿‘æœŸå·²ç»å‡çº§åˆ° <code>2025.3.1</code> ä¸”é‡åˆ°å¼‚å¸¸ï¼Œå»ºè®®ç›´æ¥å‡çº§åˆ° <code>2025.3.1.1</code>ã€‚</p>
<h3 data-id="heading-1">ç»“è®º</h3>
<ul>
<li>ç›´æ¥å‡çº§åˆ° <code>2025.3.1.1</code>ï¼šå¤§å‹ Maven é¡¹ç›®ï¼ˆå¤šæ¨¡å—/ä¾èµ–å¤æ‚ï¼‰ï¼Œæˆ–è€… Windows ä¸‹ç”¨ WSL2 æ–‡ä»¶ç³»ç»Ÿå¼€å‘ï¼›ä»¥åŠå‡çº§åˆ° <code>2025.3.1</code> åå‡ºç°å¡é¡¿/æ— å“åº”/OOMã€‚</li>
<li>å¯ä»¥ç¨å¾®è§‚æœ›ï¼šçº¯æœ¬åœ°å°é¡¹ç›®ï¼Œè¿‘æœŸä¹Ÿä¸æŠ˜è…¾ Maven é‡å¯¼å…¥/é‡å»ºï¼Œä¸ç”¨ WSL2ã€‚</li>
</ul>
<h3 data-id="heading-2">é‡å¤§é—®é¢˜ 1ï¼šæ‰“å¼€ Maven é¡¹ç›®å¯¼è‡´ IDE å¡æ­» / OOM</h3>
<h4 data-id="heading-3">ç—‡çŠ¶</h4>
<ul>
<li>æ‰“å¼€æˆ–å¯¼å…¥å¤§å‹ Maven å¤šæ¨¡å—é¡¹ç›®åï¼ŒIDE é•¿æ—¶é—´æ— å“åº”ï¼šCPU å ç”¨æŒç»­è¾ƒé«˜ã€å†…å­˜æŒç»­ä¸Šæ¶¨ã€‚</li>
<li>éƒ¨åˆ†æƒ…å†µä¸‹ä¼šç›´æ¥å‡æ­»ç”šè‡³ OOMï¼Œåªèƒ½å¼ºåˆ¶ç»“æŸè¿›ç¨‹ã€‚</li>
</ul>
<h4 data-id="heading-4">åŸå› </h4>
<p>è¿™ç±»é—®é¢˜ä¸€èˆ¬å‡ºåœ¨ <strong>Maven é¡¹ç›®æ¨¡å‹åˆå§‹åŒ–/ç¼“å­˜è¯»å–/æ¨¡å—èšåˆå…³ç³»æ„å»º</strong> é˜¶æ®µã€‚ç®€å•è¯´å°±æ˜¯ï¼šæŸä¸ªå¼‚å¸¸è·¯å¾„æŠŠåŒä¸€æ®µé€»è¾‘é‡å¤è·‘äº†å¾ˆå¤šæ¬¡ï¼Œå†…éƒ¨åˆæ²¡åšå¥½å»é‡/é‡Šæ”¾ï¼Œå¯¼å…¥è¶Šä¹…è¶Šâ€œè†¨èƒ€â€ï¼Œæœ€åå°±å¡æ­»æˆ– OOMã€‚</p>
<h4 data-id="heading-5">ä¿®å¤</h4>
<ul>
<li><strong>æ¨è</strong>ï¼šå‡çº§åˆ° <code>2025.3.1.1</code>ï¼ˆå®˜æ–¹ hotfixï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-6">ä¸´æ—¶æ–¹æ¡ˆ</h4>
<p>æ³¨æ„ï¼šåˆ é™¤çš„æ˜¯ <strong>IDE çš„ Maven ç¼“å­˜</strong>ï¼Œä¸æ˜¯ Maven æœ¬æœºä»“åº“ï¼ˆ<code>~/.m2/repository</code>ï¼‰ã€‚æ‰§è¡Œå‰å»ºè®®å…ˆé€€å‡º IDEã€‚</p>
<ul>
<li>Windowsï¼š<code>C:\Users\&lt;ç”¨æˆ·å&gt;\AppData\Local\JetBrains\IntelliJIdea2025.3\Maven</code></li>
<li>macOSï¼š<code>~/Library/Caches/JetBrains/IntelliJIdea2025.3/Maven</code></li>
<li>Linuxï¼š<code>~/.cache/JetBrains/IntelliJIdea2025.3/Maven</code></li>
</ul>
<p>å¯é€‰ï¼šå…³é—­ç¼–è¾‘å™¨ Tab æ–‡ä»¶å›¾æ ‡æ˜¾ç¤ºï¼Œå‡å°‘æŸäº› UI è®¡ç®—è§¦å‘é“¾è·¯</p>
<ul>
<li><code>Settings | Editor | General | Editor Tabs</code></li>
<li>å–æ¶ˆå‹¾é€‰ <code>Show file icon</code></li>
</ul>
<h4 data-id="heading-7">éªŒè¯</h4>
<ul>
<li>å†·å¯åŠ¨ IDEï¼ˆå®Œå…¨é€€å‡ºå†æ‰“å¼€ï¼‰ï¼Œé‡æ–°æ‰“å¼€åŒä¸€ Maven é¡¹ç›®ã€‚</li>
<li>è§‚å¯Ÿå¯¼å…¥é˜¶æ®µï¼šCPU/å†…å­˜æ˜¯å¦æŒç»­ä¸Šå‡ä¸å›è½ï¼Œæ˜¯å¦åœ¨å¯æ¥å—æ—¶é—´å†…æ¢å¤äº¤äº’ã€‚</li>
<li>å›å½’å…³é”®æ“ä½œï¼šReimport/Reloadã€Buildã€<code>Resume Build From</code>ã€‚</li>
</ul>
<h3 data-id="heading-8">é‡å¤§é—®é¢˜ 2ï¼šWSL2 é¡¹ç›®è®¾ç½®é‡å¯åä¸¢å¤±</h3>
<h4 data-id="heading-9">ç—‡çŠ¶</h4>
<ul>
<li>åœ¨ WSL2 æ–‡ä»¶ç³»ç»Ÿä¸­æ‰“å¼€é¡¹ç›®ï¼Œé…ç½®å¥½çš„ Run/Debug é…ç½®ã€è§£é‡Šå™¨/JDKã€æŸäº›æ’ä»¶è®¾ç½®ç­‰ï¼Œåœ¨é‡å¯ IDE åè¢«é‡ç½®ã€‚</li>
<li>æœ‰æ—¶å³ä½¿ <code>.idea</code> ä¸­ä»ä¿ç•™é…ç½®ç‰‡æ®µï¼ŒIDE ä¹Ÿå¯èƒ½æ²¡æœ‰æŒ‰é¢„æœŸåŠ è½½ã€‚</li>
</ul>
<h4 data-id="heading-10">ä¿®å¤</h4>
<ul>
<li><strong>æ¨è</strong>ï¼šå‡çº§åˆ° <code>2025.3.1.1</code>ã€‚</li>
</ul>
<h4 data-id="heading-11">ä¸´æ—¶æ–¹æ¡ˆï¼ˆRegistry è§„é¿ï¼‰</h4>
<p>å¦‚æœæš‚æ—¶æ— æ³•å‡çº§ï¼Œå¯ä»¥å…ˆç”¨ä¸€ä¸ªâ€œä¿å®ˆå¼€å…³â€è§„é¿ï¼ˆé€šå¸¸æ›´ç¨³ï¼Œä½†ä¹Ÿå¯èƒ½ç‰ºç‰²ä¸€ç‚¹ç‚¹æ€§èƒ½ï¼‰ï¼š</p>
<ol>
<li><code>Ctrl+Shift+A</code>ï¼ˆmacOS ä¸º <code>Cmd+Shift+A</code>ï¼‰æ‰“å¼€åŠ¨ä½œæœç´¢</li>
<li>è¾“å…¥å¹¶æ‰“å¼€ <code>Registry</code></li>
<li>æœç´¢ <code>wsl.use.remote.agent.for.nio.filesystem</code></li>
<li>å–æ¶ˆå‹¾é€‰</li>
<li>é‡å¯ IDE</li>
</ol>
<h4 data-id="heading-12">éªŒè¯</h4>
<ul>
<li>æ–°å¢ä¸€ä¸ª Run Configurationï¼ˆä¾‹å¦‚æ–°å¢ä¸€ä¸ª Spring Boot å¯åŠ¨é…ç½®ï¼‰ã€‚</li>
<li>å®Œå…¨é€€å‡º IDE åå†æ‰“å¼€åŒä¸€ WSL2 é¡¹ç›®ï¼Œç¡®è®¤é…ç½®ä»å­˜åœ¨ä¸”å¯è¿è¡Œã€‚</li>
</ul>
<h3 data-id="heading-13">å‚è€ƒ</h3>
<ul>
<li>å®˜æ–¹è¯´æ˜ï¼š<code>https://blog.jetbrains.com/idea/2025/12/intellij-idea-2025-3-1/</code></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨C#å°†DataTableå¿«é€Ÿå¯¼å‡ºä¸ºWordè¡¨æ ¼]]></title>    <link>https://juejin.cn/post/7598370121436348466</link>    <guid>https://juejin.cn/post/7598370121436348466</guid>    <pubDate>2026-01-23T10:04:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598370121436348466" data-draft-id="7598362826110255154" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨C#å°†DataTableå¿«é€Ÿå¯¼å‡ºä¸ºWordè¡¨æ ¼"/> <meta itemprop="keywords" content="åç«¯,C#"/> <meta itemprop="datePublished" content="2026-01-23T10:04:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·835629078051"/> <meta itemprop="url" content="https://juejin.cn/user/3150554985403516"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨C#å°†DataTableå¿«é€Ÿå¯¼å‡ºä¸ºWordè¡¨æ ¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3150554985403516/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·835629078051
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T10:04:28.000Z" title="Fri Jan 23 2026 10:04:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e593cf0c3cf848f084141e36a1bcfbb3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODM1NjI5MDc4MDUx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769767553&amp;x-signature=3Ga8oBtZpIAHdI41QQ4y1noI3N0%3D" alt="å¦‚ä½•ä½¿ç”¨C#å¯¼å‡ºDataTableä¸ºWordæ–‡æ¡£è¡¨æ ¼" loading="lazy"/></p>
<p>åœ¨ç°ä»£C#åº”ç”¨å¼€å‘ä¸­ï¼Œå°†ç¨‹åºæ•°æ®ä»¥ç»“æ„åŒ–çš„å½¢å¼å¯¼å‡ºä¸ºç”¨æˆ·å‹å¥½çš„Wordæ–‡æ¡£æ˜¯ä¸€é¡¹å¸¸è§çš„éœ€æ±‚ã€‚æ— è®ºæ˜¯ç”ŸæˆæŠ¥è¡¨ã€åˆåŒè¿˜æ˜¯å…¶ä»–ä¸šåŠ¡æ–‡æ¡£ï¼Œæ‰‹åŠ¨åˆ›å»ºWordæ–‡æ¡£ä¸ä»…è€—æ—¶ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚å°¤å…¶å½“æ•°æ®é‡è¾ƒå¤§æˆ–éœ€è¦é¢‘ç¹ç”Ÿæˆæ—¶ï¼Œè¿™ç§ä½æ•ˆçš„å·¥ä½œæ–¹å¼ä¼šæˆä¸ºå¼€å‘è€…çš„ç—›ç‚¹ã€‚</p>
<p>æœ¬æ–‡æ—¨åœ¨æä¾›ä¸€ç§é«˜æ•ˆã€è‡ªåŠ¨åŒ–çš„è§£å†³æ–¹æ¡ˆï¼Œåˆ©ç”¨<strong>Spire.Doc for .NET</strong>åº“ï¼Œå¸®åŠ©C#å¼€å‘è€…è½»æ¾å®ç°å°†<code>DataTable</code>ä¸­çš„æ•°æ®å¯¼å‡ºåˆ°Wordæ–‡æ¡£ï¼Œå¹¶ä»¥è¡¨æ ¼å½¢å¼æ¸…æ™°å±•ç¤ºã€‚æˆ‘ä»¬å°†é€šè¿‡è¯¦ç»†çš„æ­¥éª¤å’Œä»£ç ç¤ºä¾‹ï¼Œç¡®ä¿æ‚¨èƒ½å¤Ÿé¡ºåˆ©åœ°åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­åº”ç”¨è¿™ä¸€æŠ€æœ¯ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆé€‰æ‹©Spire.Doc for .NET?</h2>
<p>Spire.Doc for .NETæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”æ˜“äºé›†æˆçš„.NETç»„ä»¶ï¼Œä¸“é—¨ç”¨äºå¤„ç†Wordæ–‡æ¡£çš„å„ç§æ“ä½œã€‚å®ƒå…è®¸å¼€å‘è€…åœ¨ä¸ä¾èµ–Microsoft Officeçš„æƒ…å†µä¸‹ï¼Œåˆ›å»ºã€è¯»å–ã€ç¼–è¾‘ã€è½¬æ¢å’Œæ‰“å°Wordæ–‡æ¡£ã€‚åœ¨å°†<code>DataTable</code>æ•°æ®å¯¼å‡ºåˆ°Wordæ–‡æ¡£çš„åœºæ™¯ä¸­ï¼ŒSpire.Doc for .NETçš„ä¼˜åŠ¿å°¤ä¸ºçªå‡ºï¼š</p>
<ul>
<li><strong>å…¨é¢çš„è¡¨æ ¼æ”¯æŒï¼š</strong> èƒ½å¤Ÿçµæ´»åˆ›å»ºè¡¨æ ¼ã€è®¾ç½®è¡¨æ ¼æ ·å¼ï¼ˆè¾¹æ¡†ã€èƒŒæ™¯è‰²ã€å¯¹é½æ–¹å¼ï¼‰ã€åˆå¹¶å•å…ƒæ ¼ç­‰ï¼Œå®Œç¾å¥‘åˆ<code>DataTable</code>çš„äºŒç»´æ•°æ®ç»“æ„ã€‚</li>
<li><strong>ä¸°å¯Œçš„æ ¼å¼åŒ–é€‰é¡¹ï¼š</strong> æä¾›å¯¹æ–‡æœ¬ã€æ®µè½ã€å›¾ç‰‡ç­‰å…ƒç´ çš„ç²¾ç»†æ§åˆ¶ï¼Œæ–¹ä¾¿å¼€å‘è€…ç¾åŒ–æ–‡æ¡£ï¼Œæ»¡è¶³å„ç§ä¸šåŠ¡éœ€æ±‚ã€‚</li>
<li><strong>é«˜æ€§èƒ½ä¸ç¨³å®šæ€§ï¼š</strong> é€‚ç”¨äºå¤„ç†å¤§é‡æ•°æ®å’Œç”Ÿæˆå¤æ‚æ–‡æ¡£ï¼Œä¿è¯ç¨‹åºè¿è¡Œçš„æ•ˆç‡å’Œç¨³å®šæ€§ã€‚</li>
<li><strong>æ˜“äºé›†æˆä¸APIå‹å¥½ï¼š</strong> .NETå¼€å‘äººå‘˜å¯ä»¥è½»æ¾åœ°é€šè¿‡NuGetåŒ…ç®¡ç†å·¥å…·å°†å…¶é›†æˆåˆ°é¡¹ç›®ä¸­ï¼Œå¹¶åˆ©ç”¨ç›´è§‚çš„APIè¿›è¡Œç¼–ç¨‹ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-1">ç¯å¢ƒå‡†å¤‡ä¸åº“çš„å®‰è£…</h2>
<p>åœ¨ä½¿ç”¨Spire.Doc for .NETä¹‹å‰ï¼Œæ‚¨éœ€è¦å°†å…¶æ·»åŠ åˆ°æ‚¨çš„C#é¡¹ç›®ä¸­ã€‚</p>
<ol>
<li>
<p><strong>åˆ›å»ºæˆ–æ‰“å¼€æ‚¨çš„.NETé¡¹ç›®ï¼š</strong> ç¡®ä¿æ‚¨æœ‰ä¸€ä¸ªVisual Studioé¡¹ç›®ï¼ˆå¯ä»¥æ˜¯æ§åˆ¶å°åº”ç”¨ã€WinFormsã€WPFæˆ–ASP.NETï¼‰ã€‚</p>
</li>
<li>
<p><strong>å®‰è£…NuGetåŒ…ï¼š</strong> åœ¨Visual Studioä¸­ï¼Œå³é”®ç‚¹å‡»æ‚¨çš„é¡¹ç›®ï¼Œé€‰æ‹©â€œç®¡ç†NuGetç¨‹åºåŒ…(Manage NuGet Packages...)â€ã€‚</p>
<ul>
<li>åœ¨â€œæµè§ˆâ€é€‰é¡¹å¡ä¸­ï¼Œæœç´¢â€œ<code>Spire.Doc</code>â€ã€‚</li>
<li>æ‰¾åˆ°â€œ<code>Spire.Doc</code>â€åŒ…ï¼Œç‚¹å‡»â€œå®‰è£…â€ã€‚</li>
<li>æˆ–è€…ï¼Œæ‚¨ä¹Ÿå¯ä»¥æ‰“å¼€â€œç¨‹åºåŒ…ç®¡ç†å™¨æ§åˆ¶å°(Package Manager Console)â€ï¼Œç„¶åè¾“å…¥ä»¥ä¸‹å‘½ä»¤å¹¶æŒ‰å›è½¦é”®ï¼š</li>
</ul>
<pre><code class="hljs language-powershell" lang="powershell">Install-Package Spire.Doc
</code></pre>
</li>
</ol>
<p>å®‰è£…å®Œæˆåï¼Œæ‚¨çš„é¡¹ç›®å°†å¼•ç”¨Spire.Doc for .NETåº“ï¼Œæ‚¨å¯ä»¥å¼€å§‹ç¼–å†™ä»£ç äº†ã€‚</p>
<hr/>
<h2 data-id="heading-2">æ ¸å¿ƒå®ç°ï¼šDataTableåˆ°Wordè¡¨æ ¼</h2>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»å¦‚ä½•å°†ä¸€ä¸ª<code>DataTable</code>çš„æ•°æ®å¯¼å‡ºä¸ºWordæ–‡æ¡£ä¸­çš„è¡¨æ ¼ã€‚</p>
<h3 data-id="heading-3">æ­¥éª¤åˆ†è§£</h3>
<ol>
<li><strong>åˆ›å»ºWordæ–‡æ¡£å¯¹è±¡ï¼š</strong> åˆå§‹åŒ–<code>Document</code>å’Œ<code>Section</code>ï¼Œè¿™å°†æ˜¯æ‚¨Wordæ–‡æ¡£çš„åŸºç¡€ç»“æ„ã€‚</li>
<li><strong>å‡†å¤‡DataTableæ•°æ®ï¼š</strong> æ¨¡æ‹Ÿä¸€ä¸ª<code>DataTable</code>ï¼Œç”¨äºæ¼”ç¤ºæ•°æ®å¯¼å‡ºã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™äº›æ•°æ®å¯èƒ½æ¥è‡ªæ•°æ®åº“æŸ¥è¯¢ã€APIæ¥å£æˆ–å…¶ä»–æ•°æ®æºã€‚</li>
<li><strong>åˆ›å»ºWordè¡¨æ ¼ï¼š</strong> åœ¨<code>Section</code>ä¸­æ·»åŠ ä¸€ä¸ª<code>Table</code>å¯¹è±¡ã€‚</li>
<li><strong>è®¾ç½®è¡¨æ ¼æ ·å¼ï¼š</strong> å¯¹Wordè¡¨æ ¼è¿›è¡Œç¾åŒ–ï¼Œä¾‹å¦‚è®¾ç½®è¾¹æ¡†ã€èƒŒæ™¯è‰²ã€è¡Œé«˜ã€åˆ—å®½ä»¥åŠå•å…ƒæ ¼æ–‡æœ¬å¯¹é½æ–¹å¼ã€‚</li>
<li><strong>å¡«å……è¡¨å¤´ï¼š</strong> éå†<code>DataTable</code>çš„<code>Columns</code>é›†åˆï¼Œå°†åˆ—åä½œä¸ºWordè¡¨æ ¼çš„ç¬¬ä¸€è¡Œï¼ˆè¡¨å¤´ï¼‰å†…å®¹ã€‚</li>
<li><strong>å¡«å……æ•°æ®è¡Œï¼š</strong> éå†<code>DataTable</code>çš„<code>Rows</code>é›†åˆï¼Œå°†æ¯ä¸€è¡Œçš„æ•°æ®ä¾æ¬¡å¡«å……åˆ°Wordè¡¨æ ¼çš„ç›¸åº”å•å…ƒæ ¼ä¸­ã€‚</li>
<li><strong>ä¿å­˜æ–‡æ¡£ï¼š</strong> å°†ç”Ÿæˆçš„Wordæ–‡æ¡£ä¿å­˜åˆ°æŒ‡å®šè·¯å¾„ã€‚</li>
</ol>
<h3 data-id="heading-4">ä»£ç ç¤ºä¾‹</h3>
<p>ä»¥ä¸‹æ˜¯å®Œæ•´çš„C#ä»£ç ç¤ºä¾‹ï¼Œæ¼”ç¤ºäº†å¦‚ä½•å°†ä¸€ä¸ªæ¨¡æ‹Ÿçš„<code>DataTable</code>å¯¼å‡ºä¸ºWordæ–‡æ¡£ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Data;
<span class="hljs-keyword">using</span> Spire.Doc;
<span class="hljs-keyword">using</span> Spire.Doc.Documents;
<span class="hljs-keyword">using</span> Spire.Doc.Fields;
<span class="hljs-keyword">using</span> System.Drawing;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">DataTableToWordExporter</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ExportDataTableToWord</span>(<span class="hljs-params">DataTable dataTable, <span class="hljs-built_in">string</span> filePath</span>)</span>
    {
        <span class="hljs-comment">// 1. åˆ›å»ºWordæ–‡æ¡£å¯¹è±¡</span>
        Document document = <span class="hljs-keyword">new</span> Document();
        Section section = document.AddSection();

        <span class="hljs-comment">// æ·»åŠ ä¸€ä¸ªæ®µè½ä½œä¸ºæ ‡é¢˜</span>
        Paragraph titleParagraph = section.AddParagraph();
        titleParagraph.Format.HorizontalAlignment = HorizontalAlignment.Center;
        TextRange titleText = titleParagraph.AppendText(<span class="hljs-string">"äº§å“é”€å”®æŠ¥è¡¨"</span>);
        titleText.CharacterFormat.FontSize = <span class="hljs-number">20</span>;
        titleText.CharacterFormat.Bold = <span class="hljs-literal">true</span>;
        section.AddParagraph().AppendText(Environment.NewLine); <span class="hljs-comment">// ç©ºè¡Œ</span>

        <span class="hljs-comment">// 2. å‡†å¤‡DataTableæ•°æ® (æ­¤å¤„ä¸ºæ¨¡æ‹Ÿæ•°æ®ï¼Œå®é™…åº”ç”¨ä¸­æ•°æ®å¯èƒ½æ¥è‡ªæ•°æ®åº“ç­‰)</span>
        <span class="hljs-comment">// å‡è®¾dataTableå·²ç”±è°ƒç”¨è€…æä¾›</span>

        <span class="hljs-comment">// æ£€æŸ¥DataTableæ˜¯å¦æœ‰æ•°æ®</span>
        <span class="hljs-keyword">if</span> (dataTable == <span class="hljs-literal">null</span> || dataTable.Rows.Count == <span class="hljs-number">0</span>)
        {
            Paragraph noDataParagraph = section.AddParagraph();
            noDataParagraph.AppendText(<span class="hljs-string">"æ²¡æœ‰å¯ç”¨çš„æ•°æ®è¿›è¡Œå¯¼å‡ºã€‚"</span>);
            document.SaveToFile(filePath, FileFormat.Docx);
            Console.WriteLine(<span class="hljs-string">"æ²¡æœ‰æ•°æ®ï¼Œæ–‡æ¡£å·²ä¿å­˜ã€‚"</span>);
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-comment">// 3. åˆ›å»ºWordè¡¨æ ¼</span>
        Table table = section.AddTable(<span class="hljs-literal">true</span>);
        table.ResetCells(dataTable.Rows.Count + <span class="hljs-number">1</span>, dataTable.Columns.Count); <span class="hljs-comment">// +1 ç”¨äºè¡¨å¤´</span>

        <span class="hljs-comment">// 4. è®¾ç½®è¡¨æ ¼æ ·å¼</span>
        <span class="hljs-comment">// è®¾ç½®è¡¨æ ¼è¾¹æ¡†</span>
        table.TableFormat.Borders.LineWidth = <span class="hljs-number">1</span>;
        table.TableFormat.Borders.BorderType = BorderStyle.Single;
        table.TableFormat.Borders.Color = Color.Black;

        <span class="hljs-comment">// è®¾ç½®è¡¨æ ¼æ•´ä½“å®½åº¦é€‚åº”é¡µé¢</span>
        table.PreferredWidth = <span class="hljs-keyword">new</span> PreferredWidth(WidthType.Percentage, <span class="hljs-number">100</span>);
        table.TableFormat.HorizontalAlignment = RowAlignment.Center;

        <span class="hljs-comment">// 5. å¡«å……è¡¨å¤´</span>
        TableRow headerRow = table.Rows[<span class="hljs-number">0</span>];
        headerRow.IsHeader = <span class="hljs-literal">true</span>; <span class="hljs-comment">// è®¾ç½®ä¸ºè¡¨å¤´è¡Œ</span>
        headerRow.RowFormat.BackColor = Color.LightGray; <span class="hljs-comment">// è¡¨å¤´èƒŒæ™¯è‰²</span>
        headerRow.RowFormat.Height = <span class="hljs-number">25</span>; <span class="hljs-comment">// è¡¨å¤´è¡Œé«˜</span>
        headerRow.RowFormat.HeightType = TableRowHeightType.Exactly;

        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; dataTable.Columns.Count; i++)
        {
            headerRow.Cells[i].CellFormat.VerticalAlignment = VerticalAlignment.Middle;
            Paragraph p = headerRow.Cells[i].AddParagraph();
            p.Format.HorizontalAlignment = HorizontalAlignment.Center;
            TextRange tr = p.AppendText(dataTable.Columns[i].ColumnName);
            tr.CharacterFormat.Bold = <span class="hljs-literal">true</span>;
            tr.CharacterFormat.FontSize = <span class="hljs-number">11</span>;
        }

        <span class="hljs-comment">// 6. å¡«å……æ•°æ®è¡Œ</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> r = <span class="hljs-number">0</span>; r &lt; dataTable.Rows.Count; r++)
        {
            TableRow dataRow = table.Rows[r + <span class="hljs-number">1</span>]; <span class="hljs-comment">// +1 è·³è¿‡è¡¨å¤´</span>
            dataRow.RowFormat.Height = <span class="hljs-number">20</span>;
            dataRow.RowFormat.HeightType = TableRowHeightType.Exactly;

            <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> c = <span class="hljs-number">0</span>; c &lt; dataTable.Columns.Count; c++)
            {
                dataRow.Cells[c].CellFormat.VerticalAlignment = VerticalAlignment.Middle;
                Paragraph p = dataRow.Cells[c].AddParagraph();
                p.Format.HorizontalAlignment = HorizontalAlignment.Center;
                TextRange tr = p.AppendText(dataTable.Rows[r][c].ToString());
                tr.CharacterFormat.FontSize = <span class="hljs-number">10</span>;
            }
        }

        <span class="hljs-comment">// 7. ä¿å­˜æ–‡æ¡£</span>
        <span class="hljs-keyword">try</span>
        {
            document.SaveToFile(filePath, FileFormat.Docx);
            Console.WriteLine(<span class="hljs-string">$"DataTableå·²æˆåŠŸå¯¼å‡ºåˆ°Wordæ–‡æ¡£: <span class="hljs-subst">{filePath}</span>"</span>);
        }
        <span class="hljs-keyword">catch</span> (Exception ex)
        {
            Console.WriteLine(<span class="hljs-string">$"å¯¼å‡ºWordæ–‡æ¡£æ—¶å‘ç”Ÿé”™è¯¯: <span class="hljs-subst">{ex.Message}</span>"</span>);
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span>
    {
        <span class="hljs-comment">// æ¨¡æ‹Ÿä¸€ä¸ªDataTable</span>
        DataTable dt = <span class="hljs-keyword">new</span> DataTable(<span class="hljs-string">"Products"</span>);
        dt.Columns.Add(<span class="hljs-string">"äº§å“ID"</span>, <span class="hljs-keyword">typeof</span>(<span class="hljs-built_in">int</span>));
        dt.Columns.Add(<span class="hljs-string">"äº§å“åç§°"</span>, <span class="hljs-keyword">typeof</span>(<span class="hljs-built_in">string</span>));
        dt.Columns.Add(<span class="hljs-string">"å•ä»·"</span>, <span class="hljs-keyword">typeof</span>(<span class="hljs-built_in">decimal</span>));
        dt.Columns.Add(<span class="hljs-string">"åº“å­˜é‡"</span>, <span class="hljs-keyword">typeof</span>(<span class="hljs-built_in">int</span>));
        dt.Columns.Add(<span class="hljs-string">"ä¸Šå¸‚æ—¥æœŸ"</span>, <span class="hljs-keyword">typeof</span>(DateTime));

        dt.Rows.Add(<span class="hljs-number">101</span>, <span class="hljs-string">"ç¬”è®°æœ¬ç”µè„‘"</span>, <span class="hljs-number">8999.00</span>m, <span class="hljs-number">50</span>, <span class="hljs-keyword">new</span> DateTime(<span class="hljs-number">2023</span>, <span class="hljs-number">1</span>, <span class="hljs-number">15</span>));
        dt.Rows.Add(<span class="hljs-number">102</span>, <span class="hljs-string">"æ™ºèƒ½æ‰‹æœº"</span>, <span class="hljs-number">4599.00</span>m, <span class="hljs-number">120</span>, <span class="hljs-keyword">new</span> DateTime(<span class="hljs-number">2023</span>, <span class="hljs-number">3</span>, <span class="hljs-number">10</span>));
        dt.Rows.Add(<span class="hljs-number">103</span>, <span class="hljs-string">"æ— çº¿è€³æœº"</span>, <span class="hljs-number">799.00</span>m, <span class="hljs-number">200</span>, <span class="hljs-keyword">new</span> DateTime(<span class="hljs-number">2023</span>, <span class="hljs-number">2</span>, <span class="hljs-number">20</span>));
        dt.Rows.Add(<span class="hljs-number">104</span>, <span class="hljs-string">"æ™ºèƒ½æ‰‹è¡¨"</span>, <span class="hljs-number">1299.00</span>m, <span class="hljs-number">80</span>, <span class="hljs-keyword">new</span> DateTime(<span class="hljs-number">2023</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>));
        dt.Rows.Add(<span class="hljs-number">105</span>, <span class="hljs-string">"ä¾¿æºéŸ³ç®±"</span>, <span class="hljs-number">399.00</span>m, <span class="hljs-number">150</span>, <span class="hljs-keyword">new</span> DateTime(<span class="hljs-number">2023</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>));

        <span class="hljs-built_in">string</span> outputPath = <span class="hljs-string">"ProductReport.docx"</span>;
        ExportDataTableToWord(dt, outputPath);

        <span class="hljs-comment">// æ¼”ç¤ºæ— æ•°æ®æƒ…å†µ</span>
        DataTable emptyDt = <span class="hljs-keyword">new</span> DataTable(<span class="hljs-string">"Empty"</span>);
        emptyDt.Columns.Add(<span class="hljs-string">"ID"</span>);
        <span class="hljs-built_in">string</span> emptyOutputPath = <span class="hljs-string">"EmptyReport.docx"</span>;
        ExportDataTableToWord(emptyDt, emptyOutputPath);
    }
}
</code></pre>
<h3 data-id="heading-5">ç”Ÿæˆç»“æœé¢„è§ˆ</h3>
<p>ä»¥ä¸‹æ˜¯ä¸Šè¿°ä»£ç çš„ç”Ÿæˆç»“æœé¢„è§ˆï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73b1c83a0b8e4b5086d131e9b4edc276~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3ODM1NjI5MDc4MDUx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769767553&amp;x-signature=L0bG2GQIgY0Raq3AQpNPQISEYHs%3D" alt="C#å¯¼å‡ºDataTableåˆ°Wordç»“æœ" loading="lazy"/></p>
<h3 data-id="heading-6">å…³é”®APIæ–¹æ³•æ€»ç»“</h3>













































































<table><thead><tr><th align="left">æ–¹æ³•/å±æ€§</th><th align="left">ä½œç”¨</th></tr></thead><tbody><tr><td align="left"><code>Document document = new Document();</code></td><td align="left">åˆ›å»ºä¸€ä¸ªæ–°çš„Wordæ–‡æ¡£å¯¹è±¡ã€‚</td></tr><tr><td align="left"><code>Section section = document.AddSection();</code></td><td align="left">å‘æ–‡æ¡£æ·»åŠ ä¸€ä¸ªèŠ‚ï¼ˆSectionï¼‰ï¼Œæ–‡æ¡£å†…å®¹é€šå¸¸æ”¾åœ¨èŠ‚ä¸­ã€‚</td></tr><tr><td align="left"><code>Table table = section.AddTable(true);</code></td><td align="left">åœ¨èŠ‚ä¸­æ·»åŠ ä¸€ä¸ªè¡¨æ ¼ï¼Œ<code>true</code>è¡¨ç¤ºè¡¨æ ¼å°†è‡ªåŠ¨é€‚åº”å†…å®¹ã€‚</td></tr><tr><td align="left"><code>table.ResetCells(rows, columns);</code></td><td align="left">åˆå§‹åŒ–è¡¨æ ¼çš„è¡Œæ•°å’Œåˆ—æ•°ã€‚</td></tr><tr><td align="left"><code>table.TableFormat.Borders.*</code></td><td align="left">è®¾ç½®è¡¨æ ¼çš„è¾¹æ¡†æ ·å¼ã€å®½åº¦å’Œé¢œè‰²ã€‚</td></tr><tr><td align="left"><code>table.PreferredWidth</code></td><td align="left">è®¾ç½®è¡¨æ ¼çš„é¦–é€‰å®½åº¦ï¼Œå¯ä»¥æŒ‰ç™¾åˆ†æ¯”æˆ–ç‚¹æ•°è®¾ç½®ã€‚</td></tr><tr><td align="left"><code>TableRow row = table.Rows[index];</code></td><td align="left">è·å–è¡¨æ ¼çš„æŒ‡å®šè¡Œã€‚</td></tr><tr><td align="left"><code>row.IsHeader = true;</code></td><td align="left">å°†æŒ‡å®šè¡Œè®¾ç½®ä¸ºè¡¨å¤´è¡Œã€‚</td></tr><tr><td align="left"><code>row.RowFormat.BackColor</code></td><td align="left">è®¾ç½®è¡Œçš„èƒŒæ™¯é¢œè‰²ã€‚</td></tr><tr><td align="left"><code>row.RowFormat.Height</code></td><td align="left">è®¾ç½®è¡Œçš„è¡Œé«˜ã€‚</td></tr><tr><td align="left"><code>TableCell cell = row.Cells[index];</code></td><td align="left">è·å–è¡Œçš„æŒ‡å®šå•å…ƒæ ¼ã€‚</td></tr><tr><td align="left"><code>cell.CellFormat.VerticalAlignment</code></td><td align="left">è®¾ç½®å•å…ƒæ ¼å†…å®¹çš„å‚ç›´å¯¹é½æ–¹å¼ã€‚</td></tr><tr><td align="left"><code>Paragraph p = cell.AddParagraph();</code></td><td align="left">åœ¨å•å…ƒæ ¼ä¸­æ·»åŠ ä¸€ä¸ªæ®µè½ï¼Œç”¨äºæ‰¿è½½æ–‡æœ¬ã€‚</td></tr><tr><td align="left"><code>p.Format.HorizontalAlignment</code></td><td align="left">è®¾ç½®æ®µè½å†…å®¹çš„æ°´å¹³å¯¹é½æ–¹å¼ã€‚</td></tr><tr><td align="left"><code>TextRange tr = p.AppendText(text);</code></td><td align="left">å‘æ®µè½è¿½åŠ æ–‡æœ¬ã€‚</td></tr><tr><td align="left"><code>tr.CharacterFormat.*</code></td><td align="left">è®¾ç½®æ–‡æœ¬çš„å­—ä½“ã€å­—å·ã€é¢œè‰²ã€ç²—ç»†ç­‰æ ¼å¼ã€‚</td></tr><tr><td align="left"><code>document.SaveToFile(filePath, FileFormat.Docx);</code></td><td align="left">å°†æ–‡æ¡£ä¿å­˜åˆ°æŒ‡å®šè·¯å¾„ï¼Œæ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼ã€‚</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-7">è¿›é˜¶æŠ€å·§ä¸æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-8">æ ·å¼å®šåˆ¶</h3>
<p>ä¸Šè¿°ä»£ç ä»…æä¾›äº†åŸºç¡€çš„æ ·å¼è®¾ç½®ã€‚Spire.Doc for .NETæä¾›äº†ä¸°å¯Œçš„APIï¼Œå…è®¸æ‚¨å¯¹Wordæ–‡æ¡£è¿›è¡Œæ›´ç»†è‡´çš„æ ·å¼å®šåˆ¶ï¼š</p>
<ul>
<li><strong>å­—ä½“å’Œé¢œè‰²ï¼š</strong> å¯ä»¥é€šè¿‡<code>CharacterFormat</code>å¯¹è±¡è®¾ç½®å­—ä½“ã€å­—å·ã€é¢œè‰²ã€æ–œä½“ã€ä¸‹åˆ’çº¿ç­‰ã€‚</li>
<li><strong>æ®µè½æ ¼å¼ï¼š</strong> <code>ParagraphFormat</code>å¯ä»¥æ§åˆ¶æ®µè½çš„ç¼©è¿›ã€è¡Œè·ã€å¯¹é½æ–¹å¼ã€é—´è·ç­‰ã€‚</li>
<li><strong>æ¡ä»¶æ ¼å¼ï¼š</strong> æ ¹æ®æ•°æ®å€¼ï¼ˆä¾‹å¦‚ï¼Œåº“å­˜é‡ä½äºæŸä¸ªé˜ˆå€¼ï¼‰è®¾ç½®å•å…ƒæ ¼çš„èƒŒæ™¯è‰²æˆ–æ–‡æœ¬é¢œè‰²ï¼Œä»¥çªå‡ºæ˜¾ç¤ºé‡è¦ä¿¡æ¯ã€‚</li>
<li><strong>é¡µçœ‰é¡µè„šï¼š</strong> å¯ä»¥é€šè¿‡<code>section.HeadersFooters.Header</code>å’Œ<code>section.HeadersFooters.Footer</code>æ·»åŠ é¡µçœ‰é¡µè„šï¼Œæ’å…¥é¡µç ã€æ—¥æœŸç­‰ã€‚</li>
</ul>
<h3 data-id="heading-9">å¤æ‚æ•°æ®ç±»å‹å¤„ç†</h3>
<p>å¯¹äº<code>DataTable</code>ä¸­å­˜å‚¨çš„æ—¥æœŸã€å¸ƒå°”å€¼æˆ–å…¶ä»–è‡ªå®šä¹‰å¯¹è±¡ï¼Œåœ¨å¯¼å‡ºæ—¶å¯èƒ½éœ€è¦è¿›è¡Œæ ¼å¼åŒ–ï¼š</p>
<ul>
<li><strong>æ—¥æœŸæ ¼å¼åŒ–ï¼š</strong> ä½¿ç”¨<code>DateTime.ToString("yyyy-MM-dd")</code>ç­‰æ–¹æ³•å°†æ—¥æœŸæ ¼å¼åŒ–ä¸ºç”¨æˆ·å‹å¥½çš„å­—ç¬¦ä¸²ã€‚</li>
<li><strong>å¸ƒå°”å€¼å¤„ç†ï¼š</strong> å¯ä»¥å°†<code>true</code>æ˜¾ç¤ºä¸ºâ€œæ˜¯â€ï¼Œ<code>false</code>æ˜¾ç¤ºä¸ºâ€œå¦â€ã€‚</li>
<li><strong>è‡ªå®šä¹‰å¯¹è±¡ï¼š</strong> å¯¹äºåŒ…å«è‡ªå®šä¹‰å¯¹è±¡çš„åˆ—ï¼Œéœ€è¦é‡å†™å…¶<code>ToString()</code>æ–¹æ³•æˆ–æ ¹æ®ä¸šåŠ¡é€»è¾‘è¿›è¡Œç‰¹æ®Šå¤„ç†ï¼Œä»¥ç¡®ä¿åœ¨Wordä¸­æ˜¾ç¤ºæœ‰æ„ä¹‰çš„å†…å®¹ã€‚</li>
</ul>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// ç¤ºä¾‹ï¼šæ—¥æœŸæ ¼å¼åŒ–</span>
<span class="hljs-keyword">if</span> (dataTable.Columns[c].DataType == <span class="hljs-keyword">typeof</span>(DateTime))
{
    DateTime dateValue = (DateTime)dataTable.Rows[r][c];
    p.AppendText(dateValue.ToString(<span class="hljs-string">"yyyyå¹´MMæœˆddæ—¥"</span>));
}
<span class="hljs-keyword">else</span>
{
    p.AppendText(dataTable.Rows[r][c].ToString());
}
</code></pre>
<h3 data-id="heading-10">é”™è¯¯å¤„ç†</h3>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒåŠ¡å¿…æ·»åŠ å¥å£®çš„é”™è¯¯å¤„ç†æœºåˆ¶ã€‚ä½¿ç”¨<code>try-catch</code>å—å¯ä»¥æ•è·æ–‡ä»¶ä¿å­˜å¤±è´¥ã€æ•°æ®è½¬æ¢å¼‚å¸¸ç­‰é—®é¢˜ï¼Œä»è€Œæé«˜ç¨‹åºçš„ç¨³å®šæ€§ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">try</span>
{
    <span class="hljs-comment">// ... Wordæ–‡æ¡£ç”Ÿæˆé€»è¾‘ ...</span>
    document.SaveToFile(filePath, FileFormat.Docx);
}
<span class="hljs-keyword">catch</span> (Exception ex)
{
    <span class="hljs-comment">// è®°å½•é”™è¯¯æ—¥å¿—ï¼Œæˆ–å‘ç”¨æˆ·æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯æ¶ˆæ¯</span>
    Console.Error.WriteLine(<span class="hljs-string">$"å¯¼å‡ºWordæ–‡æ¡£æ—¶å‘ç”Ÿé”™è¯¯: <span class="hljs-subst">{ex.Message}</span>"</span>);
    <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œè¿›ä¸€æ­¥çš„é”™è¯¯å¤„ç†ï¼Œä¾‹å¦‚åˆ é™¤éƒ¨åˆ†ç”Ÿæˆçš„æ–‡æ¡£</span>
}
</code></pre>
<h3 data-id="heading-11">æ€§èƒ½è€ƒé‡</h3>
<p>å¯¹äºåŒ…å«æ•°åƒç”šè‡³æ•°ä¸‡è¡Œæ•°æ®çš„<code>DataTable</code>ï¼Œä¸€æ¬¡æ€§ç”Ÿæˆæ•´ä¸ªWordæ–‡æ¡£å¯èƒ½ä¼šå ç”¨è¾ƒå¤šå†…å­˜å’Œæ—¶é—´ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥è€ƒè™‘ä»¥ä¸‹ä¼˜åŒ–ç­–ç•¥ï¼š</p>
<ul>
<li><strong>åˆ†æ‰¹å¤„ç†ï¼š</strong> å¦‚æœæ–‡æ¡£å…è®¸åˆ†æ®µï¼Œå¯ä»¥å°†å¤§æ•°æ®é›†åˆ†æˆå¤šä¸ªå°æ‰¹æ¬¡ï¼Œåˆ†åˆ«ç”ŸæˆWordæ–‡æ¡£çš„å„ä¸ªéƒ¨åˆ†ï¼Œæœ€ååˆå¹¶ã€‚</li>
<li><strong>æµå¼å¤„ç†ï¼š</strong> è™½ç„¶Spire.Docä¸»è¦é¢å‘DOMï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰æ“ä½œï¼Œä½†å¯¹äºæå¤§æ•°æ®é‡ï¼Œå¯ä»¥æ¢ç´¢æ˜¯å¦æœ‰æ›´åº•å±‚çš„æµå¼å†™å…¥æ–¹å¼ï¼ˆå°½ç®¡è¿™é€šå¸¸ä¼šå¢åŠ ä»£ç å¤æ‚æ€§ï¼‰ã€‚</li>
<li><strong>ä¼˜åŒ–æ•°æ®æºï¼š</strong> ç¡®ä¿<code>DataTable</code>åœ¨ä¼ å…¥å¯¼å‡ºæ–¹æ³•å‰å·²ç»æ˜¯ç»è¿‡ä¼˜åŒ–çš„ã€åªåŒ…å«å¿…è¦æ•°æ®çš„é›†åˆã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-12">æ€»ç»“</h2>
<p>æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨C#å’ŒSpire.Doc for .NETåº“ï¼Œå°†<code>DataTable</code>ä¸­çš„æ•°æ®é«˜æ•ˆã€è‡ªåŠ¨åŒ–åœ°å¯¼å‡ºä¸ºç»“æ„åŒ–çš„Wordæ–‡æ¡£ã€‚æˆ‘ä»¬ä»ç¯å¢ƒå‡†å¤‡ã€æ ¸å¿ƒå®ç°æ­¥éª¤åˆ°è¿›é˜¶æŠ€å·§å’Œæ³¨æ„äº‹é¡¹ï¼Œæä¾›äº†ä¸€å¥—å®Œæ•´çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>é€šè¿‡Spire.Doc for .NETï¼Œå¼€å‘è€…ä¸ä»…èƒ½å¤Ÿè½»æ¾åº”å¯¹æ•°æ®å¯¼å‡ºåˆ°Wordæ–‡æ¡£çš„å¸¸è§éœ€æ±‚ï¼Œè¿˜èƒ½é€šè¿‡ä¸°å¯Œçš„APIå®ç°ç²¾ç»†çš„æ ·å¼å®šåˆ¶å’Œå¤æ‚æ•°æ®å¤„ç†ï¼Œæå¤§åœ°æå‡äº†å¼€å‘æ•ˆç‡å’Œæ–‡æ¡£ç”Ÿæˆçš„ä¸“ä¸šæ€§ã€‚æˆ‘ä»¬é¼“åŠ±æ‚¨æ ¹æ®è‡ªèº«é¡¹ç›®éœ€æ±‚ï¼Œè¿›ä¸€æ­¥æ¢ç´¢Spire.Doc for .NETçš„æ›´å¤šå¼ºå¤§åŠŸèƒ½ï¼Œä¸ºæ‚¨çš„C#åº”ç”¨ç¨‹åºå¸¦æ¥æ›´å‡ºè‰²çš„æ–‡æ¡£å¤„ç†èƒ½åŠ›ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Playwrightå­¦ä¹ ç¬”è®° 06ã€‘ç”¨æˆ·è§†è§‰å®šä½çš„æ–¹æ³•]]></title>    <link>https://juejin.cn/post/7598370121436299314</link>    <guid>https://juejin.cn/post/7598370121436299314</guid>    <pubDate>2026-01-23T09:50:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598370121436299314" data-draft-id="7598362826110238770" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Playwrightå­¦ä¹ ç¬”è®° 06ã€‘ç”¨æˆ·è§†è§‰å®šä½çš„æ–¹æ³•"/> <meta itemprop="keywords" content="å‰ç«¯,CSS"/> <meta itemprop="datePublished" content="2026-01-23T09:50:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é„­éƒ‘"/> <meta itemprop="url" content="https://juejin.cn/user/590879236308844"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Playwrightå­¦ä¹ ç¬”è®° 06ã€‘ç”¨æˆ·è§†è§‰å®šä½çš„æ–¹æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/590879236308844/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é„­éƒ‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T09:50:52.000Z" title="Fri Jan 23 2026 09:50:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;color:rgba(46,36,36,.87);overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{margin-bottom:5px;font-size:30px;font-weight:500}.markdown-body h1:before{content:"#";margin-right:10px;color:#1976d2}.markdown-body h2{font-size:28px;font-weight:400;border-left:5px solid #454545;margin-top:20px;padding-left:10px;transition:all .3s ease-in-out}.markdown-body h2:hover{border-color:#1976d2}.markdown-body h3{font-size:24px;font-weight:400;margin-top:15px;padding-bottom:0}.markdown-body h4{font-size:20px;font-weight:500}.markdown-body h5{font-size:16px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h2:first-letter,.markdown-body h3:first-letter,.markdown-body p:first-letter{text-transform:capitalize}.markdown-body em{text-emphasis:dot;text-emphasis-position:under}.markdown-body img{display:block;margin:0 auto!important;max-width:100%;border-radius:2px;box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)!important}.markdown-body hr{position:relative;width:98%;height:1px;border:none;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,#ddd,#999,#ddd);overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center}.markdown-body code{font-weight:900;word-break:break-word;border-radius:2px;overflow-x:auto;font-size:.87em;padding:.065em .4em;background-color:#fbe5e1;color:#c0341d}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:0 4px}.markdown-body pre&gt;code{font-weight:400;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{margin:0 4px;text-decoration:none;color:#027fff;transition:all .3s ease-in-out;padding-bottom:4px;border-bottom:2px solid transparent}.markdown-body a:after{content:"";display:inline-block;width:18px;height:18px;margin-left:4px;vertical-align:middle;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMjdGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PHBhdGggZD0iTTkuODE1IDYuNDQ4bDEuOTM2LTEuOTM2YzEuMzM3LTEuMzM2IDMuNTgtMS4yNTkgNS4wMTMuMTczIDEuNDMyIDEuNDMyIDEuNTEgMy42NzYuMTczIDUuMDEzbC0xLjQ1MiAxLjQ1Mi0uOTY4Ljk2OGMtMS4zMzcgMS4zMzYtMy41ODEgMS4yNTktNS4wMTMtLjE3MyIvPjxwYXRoIGQ9Ik0xMS4yNjcgMTUuMzY3bC0xLjkzNiAxLjkzNmMtMS4zMzYgMS4zMzctMy41OCAxLjI2LTUuMDEyLS4xNzMtMS40MzItMS40MzItMS41MS0zLjY3Ni0uMTczLTUuMDEybDEuNDUyLTEuNDUyLjk2OC0uOTY4YzEuMzM2LTEuMzM3IDMuNTgtMS4yNiA1LjAxMi4xNzMiLz48L2c+PC9zdmc+);background-size:cover;background-repeat:no-repeat}.markdown-body a:hover{border-color:#027fff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body a.footnote-backref:after,.markdown-body a.footnote-ref:after,.markdown-body sup a:after{display:none!important}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border:2px solid #c6c6c6}.markdown-body table img{box-shadow:none!important}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body del{color:rgba(0,0,0,.6)}.markdown-body blockquote{position:relative;color:#666;padding:5px 23px 1px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:hsla(0,0%,78.4%,.12);transition:all .2s ease-in-out}.markdown-body blockquote:hover{border-color:#1976d2}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;font-size:24px;font-weight:800;line-height:24px;color:#cbcbcb;opacity:.6}.markdown-body blockquote:before{content:"â€œ";top:4px;left:6px}.markdown-body blockquote:after{content:"â€";right:8px;bottom:-8px}.markdown-body blockquote&gt;p,.markdown-body blockquote blockquote{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body details{outline:none;border:none;border-left:4px solid #1976d2;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary:hover::-webkit-details-marker{color:#1976d2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ ¹æ®æ–‡æœ¬å†…å®¹å®šä½</h2>
<p>Page/Locator å¯¹è±¡çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fplaywright.dev%2Fpython%2Fdocs%2Fapi%2Fclass-locator%23locator-get-by-text" title="https://playwright.dev/python/docs/api/class-locator#locator-get-by-text" target="_blank" ref="nofollow noopener noreferrer">get_by_text</a> æ–¹æ³•</p>
<p>æ¯”å¦‚ï¼Œ</p>
<p>å¦‚æœè¦è·å– æ‰€æœ‰ æ–‡æœ¬å†…å®¹åŒ…å« <code>11</code> çš„å…ƒç´ ï¼Œå°±å¯ä»¥è¿™æ ·</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">elements</span> = page.get_by_text(<span class="hljs-string">'11'</span>).all()
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fab9d41052f2496e8cd6378d13414055~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YSt6YOR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769766652&amp;x-signature=2TScSbTkWZPdnWfKruRPNq0uTVo%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>å¦‚æœï¼Œä½ å¸Œæœ›åŒ…å«çš„å†…å®¹æ˜¯ä»¥ <code>11</code> ç»“å°¾çš„ï¼Œå°±å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ ä½œä¸ºå‚æ•°ï¼Œå¦‚ä¸‹</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> re
elements = page.get_by_text(re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">"11$"</span>)).<span class="hljs-built_in">all</span>()
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h2 data-id="heading-1">æ ¹æ® å…ƒç´  role å®šä½</h2>
<p>webåº”ç”¨ç°åœ¨æœ‰ä¸€ç§æ ‡å‡† ç§°ä¹‹ä¸ºï¼š <code>ARIA ï¼ˆAccessible Rich Internet Applicationsï¼‰</code>ã€‚</p>
<p>ARIA æ ¹æ®webç•Œé¢å…ƒç´ çš„ç”¨é€”ï¼Œä¸ºè¿™äº›å…ƒç´ å®šä¹‰äº†ä¸€å¥— <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAccessibility%2FARIA%2FRoles" title="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles" target="_blank" ref="nofollow noopener noreferrer">è§’è‰²ï¼ˆ Role ï¼‰</a> ä¿¡æ¯ï¼Œæ·»åŠ åˆ°é¡µé¢ä¸­ï¼Œ</p>
<p>ä»è€Œ è®© æ®‹ç–¾äººå£«ï¼Œæˆ–è€… æ™®é€šäººåœ¨ æŸç§ç¯å¢ƒä¸‹ï¼ˆæ¯”å¦‚å¤œé‡Œï¼Œå¤ªç©ºä¸­ï¼‰ï¼Œä¸æ–¹ä¾¿ä½¿ç”¨å¸¸è§„æ–¹æ³•æ“ä½œåº”ç”¨ï¼Œä½¿ç”¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.w3.org%2FTR%2Fwai-aria-1.2%2F%23dfn-assistive-technology" title="https://www.w3.org/TR/wai-aria-1.2/#dfn-assistive-technology" target="_blank" ref="nofollow noopener noreferrer">è¾…åŠ©æŠ€æœ¯å·¥å…·</a>ï¼Œæ¥æ“ä½œwebåº”ç”¨çš„ã€‚</p>
<p>è‹¥æƒ³å®šä½è¿™ä¸ªå…ƒç´ ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;div <span class="hljs-attr">class</span>=<span class="hljs-string">"alert-message"</span>&gt;
  æ‚¨å·²æˆåŠŸæ³¨å†Œï¼Œå¾ˆå¿«æ‚¨å°†æ”¶åˆ°ä¸€å°ç¡®è®¤ç”µå­é‚®ä»¶
&lt;/div&gt;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ç›´æ¥å¯ä»¥æ ¹æ®å¦‚ä¸‹ä»£ç  å®šä½è¯¥å…ƒç´ </p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ ¹æ® role å®šä½</span>
<span class="hljs-attr">lc</span> = page.get_by_role(<span class="hljs-string">'alert'</span>)

<span class="hljs-comment"># æ‰“å°å…ƒç´ æ–‡æœ¬</span>
print(lc.inner_text())
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>htmlå…ƒç´ ä¸­ï¼Œæœ‰äº› ç‰¹å®šè¯­ä¹‰å…ƒç´ ï¼ˆsemantic elementsï¼‰è¢«ARIAè§„èŒƒè®¤å®šä¸ºè‡ªèº«å°±åŒ…å« ARIA role ä¿¡æ¯ï¼Œå¹¶ä¸éœ€è¦æˆ‘ä»¬æ˜æ˜¾çš„åŠ ä¸Š ARIA role å±æ€§è®¾ç½®ï¼Œ</p>
<p>æ¯”å¦‚</p>
<pre><code class="hljs language-ini" lang="ini">&lt;progress <span class="hljs-attr">value</span>=<span class="hljs-string">"75"</span> max=<span class="hljs-string">"100"</span>&gt;<span class="hljs-number">75</span> %&lt;/progress&gt;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>å°±ç­‰äºéšå«äº†å¦‚ä¸‹ä¿¡æ¯</p>
<pre><code class="hljs language-ini" lang="ini">&lt;progress <span class="hljs-attr">value</span>=<span class="hljs-string">"75"</span> max=<span class="hljs-string">"100"</span>
  <span class="hljs-attr">role</span>=<span class="hljs-string">"progressbar"</span>
  <span class="hljs-attr">aria-valuenow</span>=<span class="hljs-string">"75"</span>
  <span class="hljs-attr">aria-valuemax</span>=<span class="hljs-string">"100"</span>&gt;<span class="hljs-number">75</span> %&lt;/div&gt;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>æ‰€ä»¥ï¼Œç›´æ¥å¯ä»¥æ ¹æ®å¦‚ä¸‹ä»£ç  å®šä½è¯¥å…ƒç´ </p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># æ ¹æ® role å®šä½</span>
<span class="hljs-keyword">lc</span> = page.get_by_role(<span class="hljs-string">'progressbar'</span>)

<span class="hljs-comment"># æ‰“å°å…ƒç´ å±æ€§ value çš„å€¼</span>
<span class="hljs-keyword">print</span>(lc.get_attribute(<span class="hljs-string">'value'</span>))
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>å†æ¯”å¦‚ <code>search</code> ç±»å‹çš„è¾“å…¥æ¡†ï¼Œé»˜è®¤å°±æœ‰ <code>searchbox</code> roleï¼Œ</p>
<pre><code class="hljs language-ini" lang="ini">&lt;input <span class="hljs-attr">type</span>=<span class="hljs-string">"search"</span>&gt;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-2">ARIA Attribute</h3>
<p>ARIAè§„èŒƒé™¤äº†å¯ä»¥ç»™å…ƒç´ æ·»åŠ  <code>ARIA role</code> ï¼Œè¿˜å¯ä»¥æ·»åŠ å…¶å®ƒ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAccessibility%2FARIA%2FAttributes" title="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes" target="_blank" ref="nofollow noopener noreferrer">Â ARIAå±æ€§ï¼ˆARIA attributesï¼‰</a> ï¼Œæ¯”å¦‚</p>
<pre><code class="hljs language-ini" lang="ini">&lt;div <span class="hljs-attr">role</span>=<span class="hljs-string">"heading"</span> aria-level=<span class="hljs-string">"1"</span>&gt;ç™½æœˆé»‘ç¾½æ ‡é¢˜<span class="hljs-number">1</span>&lt;/div&gt;
&lt;div <span class="hljs-attr">role</span>=<span class="hljs-string">"heading"</span> aria-level=<span class="hljs-string">"2"</span>&gt;ç™½æœˆé»‘ç¾½æ ‡é¢˜<span class="hljs-number">2</span>&lt;/div&gt;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><code>aria-level</code> å°±æ˜¯ä¸€ä¸ª ARIA å±æ€§ï¼Œè¡¨ç¤º role ä¸º <code>heading</code> æ—¶çš„ <code>ç­‰çº§</code> ä¿¡æ¯</p>
<p>ä¸Šé¢çš„å®šä¹‰ï¼Œå…¶å®å’Œä¸‹é¢çš„ html å…ƒç´  h1/h2 ç­‰ä»·</p>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">h1</span>&gt;ç™½æœˆé»‘ç¾½æ ‡é¢˜<span class="hljs-number">1</span>&lt;/<span class="hljs-selector-tag">h1</span>&gt;
&lt;<span class="hljs-selector-tag">h2</span>&gt;ç™½æœˆé»‘ç¾½æ ‡é¢˜<span class="hljs-number">2</span>&lt;/<span class="hljs-selector-tag">h2</span>&gt;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ä¸Šä¾‹ä¸­ï¼Œh2 å…ƒç´ ï¼Œéšå«äº† <strong><code>role="heading" aria-level="2"</code></strong> ï¼Œ æ‰€ä»¥å¯ä»¥ç”¨ä¸‹é¢ä»£ç å®šä½</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">lc</span> = page.get_by_role(<span class="hljs-string">'heading'</span>,level=<span class="hljs-number">2</span>)
print(lc.inner_text())
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-3">Accessible Name</h3>
<p>åªæ ¹æ® <code>ARIA role</code> å’Œ <code>ARIAå±æ€§</code> å¾€å¾€å¹¶ä¸èƒ½å”¯ä¸€å®šä½å…ƒç´ ã€‚</p>
<p>roleå®šä½æœ€å¸¸è§çš„ç»„åˆæ˜¯ <code>ARIA role</code> å’Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FGlossary%2FAccessible_name" title="https://developer.mozilla.org/en-US/docs/Glossary/Accessible_name" target="_blank" ref="nofollow noopener noreferrer">Accessible Name</a></p>
<p>å› ä¸ºï¼Œ<code>Accessible Name</code> å°±åƒå…ƒç´ çš„ <code>åå­—</code> ä¸€æ ·ï¼Œå¾€å¾€å¯ä»¥å”¯ä¸€å®šä½ã€‚</p>
<p>html å…ƒç´ æ ‡å‡†å±æ€§ <code>name</code> æ˜¯æµè§ˆå™¨å†…éƒ¨çš„ï¼Œç”¨æˆ·çœ‹ä¸åˆ°ï¼Œæ¯”å¦‚</p>
<p><code>Accessible Name</code> ä¸ä¸€æ ·ï¼Œå®ƒæ˜¯å…ƒç´ ç•Œé¢å¯è§çš„æ–‡æœ¬åï¼Œ</p>
<pre><code class="hljs language-ini" lang="ini">&lt;a <span class="hljs-attr">name</span>=<span class="hljs-string">'link2byhy'</span> href=<span class="hljs-string">"https://www.byhy.net"</span>&gt;ç™½æœˆé»‘ç¾½æ•™ç¨‹&lt;/a&gt;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>æ¯”å¦‚ä¸Šé¢çš„å…ƒç´ ï¼Œæš—å«çš„ <strong><code>Accessible Name</code></strong> å€¼å°±æ˜¯ <strong><code>ç™½æœˆé»‘ç¾½æ•™ç¨‹</code></strong> ï¼Œ å½“ç„¶ä¹Ÿæš—å«äº† <strong><code>ARIA role</code> å€¼ä¸º <code>link</code></strong></p>
<p>æ‰€ä»¥ï¼Œå¯ä»¥è¿™æ ·å®šä½</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">lc</span> = page.get_by_role(<span class="hljs-string">'link'</span>,name=<span class="hljs-string">'ç™½æœˆé»‘ç¾½æ•™ç¨‹'</span>)
print(lc.click())
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>ä¸Šé¢çš„å†™æ³•ï¼Œ åªè¦ Accessible Name åŒ…å« å‚æ•°name çš„å­—ç¬¦ä¸²å†…å®¹å³å¯ï¼Œè€Œä¸”å¤§å°å†™ä¸åˆ†ï¼Œ å¹¶ä¸éœ€è¦å®Œå…¨ä¸€è‡´ã€‚</p>
<p>æ‰€ä»¥ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥å®šä½åˆ°</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">lc</span> = page.get_by_role(<span class="hljs-string">'link'</span>,name=<span class="hljs-string">'ç™½æœˆé»‘ç¾½'</span>)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>å¦‚æœä½ éœ€è¦ Accessible Name å’Œ å‚æ•°name çš„å†…å®¹å®Œå…¨ä¸€è‡´ï¼Œå¯ä»¥æŒ‡å®š <code>exact=True</code> ï¼Œå¦‚ä¸‹</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">lc</span> = page.get_by_role(<span class="hljs-string">'link'</span>,name=<span class="hljs-string">'ç™½æœˆé»‘ç¾½'</span>, exact=<span class="hljs-literal">True</span>)
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>nameå€¼è¿˜å¯ä»¥é€šè¿‡<a href="https://link.juejin.cn?target=http%3A%2F%2F0" title="http://0" target="_blank" ref="nofollow noopener noreferrer">æ­£åˆ™è¡¨è¾¾å¼</a>ï¼Œè¿›è¡Œè¾ƒå¤æ‚çš„åŒ¹é…è§„åˆ™ï¼Œæ¯”å¦‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">lc</span> = page.get_by_role(<span class="hljs-string">'link'</span>,name=re.compile(<span class="hljs-string">"^ç™½æœˆ.*ç¾½"</span>))
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>æˆ‘ä»¬è¿™é‡Œè¯´ä¸€äº›å¸¸è§çš„ï¼š</p>
<p><strong><code>&lt;a&gt; &lt;td&gt; &lt;button&gt;</code></strong> Accessible Name å€¼ å°±æ˜¯å…¶å†…éƒ¨çš„æ–‡æœ¬å†…å®¹ã€‚</p>
<p><strong><code>&lt;textarea&gt; &lt;input&gt;</code></strong> è¿™äº›è¾“å…¥æ¡†ï¼Œå®ƒä»¬çš„ Accessible Name å€¼ æ˜¯å’Œä»–ä»¬å…³è”çš„ çš„æ–‡æœ¬ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> /&gt;</span> Subscribe
<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>è¿™ä¸ª checkbox çš„ Accessible Name å´æ˜¯ <strong><code>Subscribe</code></strong></p>
<p>ä¸€äº›å…ƒç´  æ¯”å¦‚ <strong><code>&lt;img&gt;</code></strong> ï¼Œå®ƒçš„ Accessible Name æ˜¯å…¶html å±æ€§ <code>alt</code> çš„å€¼</p>
<p>æ¯”å¦‚</p>
<pre><code class="hljs language-ini" lang="ini">&lt;img <span class="hljs-attr">src</span>=<span class="hljs-string">"grape.jpg"</span> alt=<span class="hljs-string">"banana"</span>/&gt;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>roleå®šä½ä»£ç å¤æ‚ï¼Œå»ºè®®ä½¿ç”¨<strong>codegenä»£ç åŠ©æ‰‹</strong>æ¥å®Œæˆ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[objc_msgSend(obj, @selector(foo)); åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ]]></title>    <link>https://juejin.cn/post/7598193992828829750</link>    <guid>https://juejin.cn/post/7598193992828829750</guid>    <pubDate>2026-01-23T09:53:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598193992828829750" data-draft-id="7598260824222990379" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="objc_msgSend(obj, @selector(foo)); åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"/> <meta itemprop="keywords" content="iOS"/> <meta itemprop="datePublished" content="2026-01-23T09:53:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ±‰ç§‹"/> <meta itemprop="url" content="https://juejin.cn/user/3755587450191879"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            objc_msgSend(obj, @selector(foo)); åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3755587450191879/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ±‰ç§‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T09:53:33.000Z" title="Fri Jan 23 2026 09:53:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>objc_msgSend(obj, @selector(foo)); åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong></h2>
<p>åœ¨ Objective-C çš„ä¸–ç•Œé‡Œï¼Œæœ‰ä¸€å¥è¯å‡ ä¹æ˜¯<strong>åº•å±‚åŸæ•™æ—¨ä¸»ä¹‰</strong>ï¼š</p>
<blockquote>
<p><strong>Objective-C æ˜¯ä¸€é—¨åŸºäºæ¶ˆæ¯å‘é€ï¼ˆMessage Sendingï¼‰çš„è¯­è¨€ï¼Œè€Œä¸æ˜¯å‡½æ•°è°ƒç”¨ã€‚</strong></p>
</blockquote>
<p>è€Œè¿™ä¸€åˆ‡ï¼Œéƒ½æµ“ç¼©åœ¨ä¸€è¡Œçœ‹ä¼¼æ™®é€šã€å´æå…¶æ ¸å¿ƒçš„ä»£ç ä¸­ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">objc_msgSend</span>(obj, <span class="hljs-variable">@selector</span>(foo));
</code></pre>
<p>æœ¬æ–‡å°†ä»<strong>è¯­æ³•ç³– â†’ è¿è¡Œæ—¶ â†’ å®Œæ•´è°ƒç”¨é“¾</strong>ï¼Œä¸€æ­¥ä¸€æ­¥æ‹†è§£ï¼š</p>
<ul>
<li>è¿™è¡Œä»£ç åˆ°åº•åœ¨â€œå‘ä»€ä¹ˆâ€</li>
<li>æ¶ˆæ¯æ˜¯å¦‚ä½•è¢«æ‰¾åˆ°å¹¶æ‰§è¡Œçš„</li>
<li>å¦‚æœæ‰¾ä¸åˆ°æ–¹æ³•ï¼ŒRuntime åˆåšäº†ä»€ä¹ˆ</li>
</ul>
<hr/>
<h3 data-id="heading-1"><strong>ä¸€ã€ä»è¡¨é¢çœ‹ï¼šå®ƒç­‰ä»·äºä»€ä¹ˆï¼Ÿ</strong></h3>
<p>è¿™è¡Œä»£ç ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">objc_msgSend</span>(obj, <span class="hljs-variable">@selector</span>(foo));
</code></pre>
<p>åœ¨è¯­ä¹‰ä¸Š <strong>ç­‰ä»·äº</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[obj foo]</span><span class="hljs-comment">;</span>
</code></pre>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼š</p>
<blockquote>
<p><strong>ç»™å¯¹è±¡ obj å‘é€ä¸€æ¡åä¸º foo çš„æ¶ˆæ¯</strong></p>
</blockquote>
<p>[obj foo] åªæ˜¯ç¼–è¯‘å™¨æä¾›çš„<strong>è¯­æ³•ç³–</strong>ï¼ŒçœŸæ­£æ‰§è¡Œçš„æ°¸è¿œæ˜¯ objc_msgSendã€‚</p>
<hr/>
<h3 data-id="heading-2"><strong>äºŒã€è°æ˜¯å‘é€è€…ï¼Ÿè°æ˜¯æ¥æ”¶è€…ï¼Ÿ</strong></h3>
<p>å¾ˆå¤šåˆå­¦è€…ä¼šå¡åœ¨è¿™ä¸ªé—®é¢˜ä¸Šï¼š</p>
<blockquote>
<p>åˆ°åº•æ˜¯è°â€œè°ƒç”¨â€äº†è°ï¼Ÿ</p>
</blockquote>
<h4 data-id="heading-3"><strong>æ­£ç¡®ç†è§£æ–¹å¼</strong></h4>
<ul>
<li>
<p><strong>æ¥æ”¶è€…ï¼ˆreceiverï¼‰</strong> ï¼šobj</p>
</li>
<li>
<p><strong>æ¶ˆæ¯ï¼ˆselectorï¼‰</strong> ï¼šfoo</p>
</li>
<li>
<p><strong>å‘é€åŠ¨ä½œçš„å‘èµ·è€…</strong>ï¼šå½“å‰ä»£ç ä½ç½®ï¼ˆä¸é‡è¦ï¼‰</p>
</li>
</ul>
<p>Objective-C <strong>ä¸å…³å¿ƒè°ƒç”¨æ ˆçš„â€œè°â€</strong> ï¼Œåªå…³å¿ƒï¼š</p>
<blockquote>
<p>ğŸ‘‰ <strong>è¿™æ¡æ¶ˆæ¯å‘ç»™è°</strong></p>
</blockquote>
<p>æ‰€ä»¥æ°¸è¿œç”¨è¿™å¥è¯æ¥ç†è§£ï¼š</p>
<blockquote>
<p><strong>ç»™ obj å‘é€ foo æ¶ˆæ¯</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-4"><strong>ä¸‰ã€Runtime çœŸæ­£å‘ç”Ÿçš„ 6 ä¸ªæ­¥éª¤ï¼ˆæ ¸å¿ƒï¼‰</strong></h3>
<p>ä¸‹é¢æ˜¯ä½ åœ¨ Xcode é‡Œå†™ä¸‹ä¸€è¡Œ [obj foo] åï¼Œ<strong>Runtime åœ¨èƒŒåçœŸå®å‘ç”Ÿçš„å®Œæ•´æµç¨‹</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-5"><strong>æ­¥éª¤ 1ï¸âƒ£ï¼šå–å¾—æ¥æ”¶è€…obj</strong></h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">id</span> <span class="hljs-selector-tag">obj</span> = ...;
<span class="hljs-selector-tag">objc_msgSend</span>(obj, <span class="hljs-variable">@selector</span>(foo));
</code></pre>
<ul>
<li>obj æ˜¯ä¸€ä¸ªå¯¹è±¡æŒ‡é’ˆ</li>
<li>æœ¬è´¨ä¸ŠæŒ‡å‘ä¸€å—å†…å­˜</li>
<li>å†…å­˜å¸ƒå±€çš„ç¬¬ä¸€ä¸ªæˆå‘˜ï¼Œå°±æ˜¯ <strong>isa</strong> <strong>æŒ‡é’ˆ</strong></li>
</ul>
<pre><code class="hljs language-vbnet" lang="vbnet">obj
 â”œâ”€ isa â†’ <span class="hljs-keyword">Class</span>
 â”œâ”€ ivar1
 â”œâ”€ ivar2
</code></pre>
<p>å¦‚æœ obj == nilï¼š</p>
<ul>
<li>æ•´ä¸ªæµç¨‹ç›´æ¥ç»“æŸ</li>
<li>è¿”å› 0 / nil</li>
<li><strong>ä¸ä¼šå´©æºƒ</strong>ï¼ˆOC çš„è‘—åç‰¹æ€§ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-6"><strong>æ­¥éª¤ 2ï¸âƒ£ï¼šé€šè¿‡isaæ‰¾åˆ° Class</strong></h3>
<pre><code class="hljs language-ini" lang="ini">Class <span class="hljs-attr">cls</span> = obj-&gt;isa<span class="hljs-comment">;</span>
</code></pre>
<ul>
<li>
<p>isa æŒ‡å‘å¯¹è±¡æ‰€å±çš„ç±»</p>
</li>
<li>
<p>è¿™æ˜¯ <strong>æ‰€æœ‰æ–¹æ³•æŸ¥æ‰¾çš„èµ·ç‚¹</strong></p>
</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@interface</span> <span class="hljs-attribute">Person </span>: NSObject
- (void)foo;
<span class="hljs-variable">@end</span>
</code></pre>
<pre><code class="hljs language-scss" lang="scss">obj (Person å®ä¾‹)
  â””â”€ isa â†’ Person
</code></pre>
<hr/>
<h3 data-id="heading-7"><strong>æ­¥éª¤ 3ï¸âƒ£ï¼šåœ¨æ–¹æ³•ç¼“å­˜ï¼ˆcacheï¼‰ä¸­æŸ¥æ‰¾</strong></h3>
<p>Runtime <strong>é¦–å…ˆæŸ¥ cacheï¼Œè€Œä¸æ˜¯æ–¹æ³•åˆ—è¡¨</strong>ã€‚</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-keyword">Class</span> Person
 â”œâ”€ cache      â† â‘  å…ˆæŸ¥è¿™é‡Œ
 â”œâ”€ methodList â† â‘¡ å†æŸ¥è¿™é‡Œ
 â””â”€ superclass
</code></pre>
<ul>
<li>
<p>cache æ˜¯ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼šSEL â†’ IMP</p>
</li>
<li>
<p>å‘½ä¸­ cache = <strong>æå¿«ï¼ˆæ¥è¿‘ C å‡½æ•°è°ƒç”¨ï¼‰</strong></p>
</li>
</ul>
<p>å¦‚æœåœ¨ cache ä¸­æ‰¾åˆ°äº† fooï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">IMP</span> <span class="hljs-selector-tag">imp</span> = <span class="hljs-selector-tag">cache</span><span class="hljs-selector-attr">[foo]</span>;
<span class="hljs-selector-tag">imp</span>(obj, <span class="hljs-variable">@selector</span>(foo));
</code></pre>
<p>â†’ <strong>æµç¨‹ç»“æŸ</strong>****</p>
<hr/>
<h3 data-id="heading-8"><strong>æ­¥éª¤ 4ï¸âƒ£ï¼šåœ¨æ–¹æ³•åˆ—è¡¨ &amp; çˆ¶ç±»ä¸­æŸ¥æ‰¾</strong></h3>
<p>å¦‚æœ cache æœªå‘½ä¸­ï¼š</p>
<ol>
<li>æŸ¥ Person çš„æ–¹æ³•åˆ—è¡¨</li>
<li>æ‰¾ä¸åˆ° â†’ superclass</li>
<li>ä¸€ç›´å‘ä¸ŠæŸ¥ï¼Œç›´åˆ° NSObject</li>
</ol>
<pre><code class="hljs language-objectivec" lang="objectivec">Person
  â†“
<span class="hljs-built_in">NSObject</span>
</code></pre>
<p>å¦‚æœåœ¨æŸä¸ªç±»ä¸­æ‰¾åˆ°ï¼š</p>
<ul>
<li>å°† SEL â†’ IMP æ”¾å…¥ cacheï¼ˆä¸‹æ¬¡æ›´å¿«ï¼‰</li>
<li>ç«‹å³æ‰§è¡Œ IMP</li>
</ul>
<hr/>
<h3 data-id="heading-9"><strong>æ­¥éª¤ 5ï¸âƒ£ï¼šåŠ¨æ€æ–¹æ³•è§£æï¼ˆresolveï¼‰</strong></h3>
<p>å¦‚æœ <strong>æ•´ä¸ªç»§æ‰¿é“¾éƒ½æ²¡æ‰¾åˆ° foo</strong>ï¼š</p>
<p>Runtime ä¼šç»™ä½ ä¸€æ¬¡**â€œä¸´æ—¶è¡¥æ•‘â€çš„æœºä¼š**ã€‚</p>
<pre><code class="hljs language-css" lang="css">+ (BOOL)resolveInstanceMethod:(SEL)sel;
</code></pre>
<h4 data-id="heading-10"><strong>ç¤ºä¾‹ï¼šåŠ¨æ€æ·»åŠ æ–¹æ³•</strong></h4>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@implementation</span> Person

+ (BOOL)<span class="hljs-attribute">resolveInstanceMethod</span>:(SEL)sel {
    <span class="hljs-selector-tag">if</span> (sel == <span class="hljs-variable">@selector</span>(foo)) {
        <span class="hljs-selector-tag">class_addMethod</span>(self, sel, (IMP)fooIMP, <span class="hljs-string">"v@:"</span>);
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">YES</span>;
    }
    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-attr">[super resolveInstanceMethod:sel]</span>;
}

<span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">fooIMP</span>(id self, SEL _cmd) {
    <span class="hljs-selector-tag">NSLog</span>(@<span class="hljs-string">"åŠ¨æ€æ·»åŠ çš„ foo è¢«è°ƒç”¨äº†"</span>);
}

@<span class="hljs-selector-tag">end</span>
</code></pre>
<p>å¦‚æœè¿”å› YESï¼š</p>
<ul>
<li>Runtime <strong>é‡æ–°ä»æ­¥éª¤ 3 å¼€å§‹æŸ¥æ‰¾</strong></li>
</ul>
<hr/>
<h3 data-id="heading-11"><strong>æ­¥éª¤ 6ï¸âƒ£ï¼šæ¶ˆæ¯è½¬å‘ï¼ˆMessage Forwardingï¼‰</strong></h3>
<p>å¦‚æœä½ æ²¡æœ‰åŠ¨æ€æ·»åŠ æ–¹æ³•ï¼ŒRuntime è¿›å…¥ <strong>æ¶ˆæ¯è½¬å‘ä¸‰è¿</strong>ã€‚</p>
<h4 data-id="heading-12"><strong>6.1 å¿«é€Ÿè½¬å‘</strong></h4>
<pre><code class="hljs language-erlang" lang="erlang">- <span class="hljs-params">(id)</span>forwardingTargetForSelector:<span class="hljs-params">(SEL)</span>aSelector;
</code></pre>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">-</span> (id)<span class="hljs-selector-tag">forwardingTargetForSelector</span>:(SEL)<span class="hljs-selector-tag">aSelector</span> {
    <span class="hljs-selector-tag">if</span> (aSelector == <span class="hljs-variable">@selector</span>(foo)) {
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">otherObj</span>;
    }
    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-attr">[super forwardingTargetForSelector:aSelector]</span>;
}
</code></pre>
<p>ç­‰ä»·äºï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[otherObj foo]</span><span class="hljs-comment">;</span>
</code></pre>
<hr/>
<h4 data-id="heading-13"><strong>6.2 å®Œæ•´è½¬å‘ï¼ˆNSInvocationï¼‰</strong></h4>
<pre><code class="hljs language-erlang" lang="erlang">- <span class="hljs-params">(NSMethodSignature *)</span>methodSignatureForSelector:<span class="hljs-params">(SEL)</span>aSelector;
- <span class="hljs-params">(void)</span>forwardInvocation:<span class="hljs-params">(NSInvocation *)</span>invocation;
</code></pre>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">-</span> (NSMethodSignature *)<span class="hljs-selector-tag">methodSignatureForSelector</span>:(SEL)<span class="hljs-selector-tag">aSelector</span> {
    <span class="hljs-selector-tag">if</span> (aSelector == <span class="hljs-variable">@selector</span>(foo)) {
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-attr">[NSMethodSignature signatureWithObjCTypes:<span class="hljs-string">"v@:"</span>]</span>;
    }
    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-attr">[super methodSignatureForSelector:aSelector]</span>;
}

<span class="hljs-selector-tag">-</span> (void)<span class="hljs-selector-tag">forwardInvocation</span>:(NSInvocation *)<span class="hljs-selector-tag">invocation</span> {
    <span class="hljs-selector-attr">[invocation invokeWithTarget:otherObj]</span>;
}
</code></pre>
<hr/>
<h4 data-id="heading-14"><strong>6.3 æœ€ç»ˆå¤±è´¥ â†’ å´©æºƒ</strong></h4>
<p>å¦‚æœä»¥ä¸Šéƒ½æ²¡å¤„ç†ï¼š</p>
<pre><code class="hljs language-css" lang="css">-<span class="hljs-selector-attr">[Person foo]</span>: unrecognized selector sent to instance
</code></pre>
<p>åº”ç”¨ç›´æ¥å´©æºƒ ğŸ’¥</p>
<hr/>
<h3 data-id="heading-15"><strong>å››ã€å®Œæ•´æµç¨‹æ€»è§ˆï¼ˆè®°ä½è¿™ä¸ªé¡ºåºï¼‰</strong></h3>
<pre><code class="hljs language-sql" lang="sql">objc_msgSend
  â†“
isa
  â†“
cache
  â†“
<span class="hljs-keyword">method</span> list
  â†“
superclass
  â†“
resolveInstanceMethod
  â†“
forwardingTargetForSelector
  â†“
forwardInvocation
  â†“
crash
</code></pre>
<hr/>
<h3 data-id="heading-16"><strong>äº”ã€ä¸ºä»€ä¹ˆ objc_msgSend è¿™ä¹ˆé‡è¦ï¼Ÿ</strong></h3>
<ul>
<li>
<p>KVC / KVO</p>
</li>
<li>
<p>æ–¹æ³•äº¤æ¢ï¼ˆMethod Swizzlingï¼‰</p>
</li>
<li>
<p>AOP / Hook</p>
</li>
<li>
<p>å´©æºƒé˜²æŠ¤</p>
</li>
<li>
<p>çƒ­ä¿®å¤ï¼ˆæ—©æœŸæ–¹æ¡ˆï¼‰</p>
</li>
</ul>
<p><strong>å…¨éƒ½å»ºç«‹åœ¨å®ƒä¹‹ä¸Šã€‚</strong></p>
<p>ç†è§£ objc_msgSendï¼Œ</p>
<blockquote>
<p>æ‰ç®—çœŸæ­£â€œå…¥é—¨â€ Objective-C Runtimeã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-17"><strong>å…­ã€ç»“è¯­</strong></h3>
<p>å½“ä½ å†çœ‹åˆ°è¿™è¡Œä»£ç æ—¶ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">objc_msgSend</span>(obj, <span class="hljs-variable">@selector</span>(foo));
</code></pre>
<p>è¯·åœ¨è„‘ä¸­è‡ªåŠ¨å±•å¼€ï¼š</p>
<blockquote>
<p>cache â†’ superclass â†’ resolve â†’ forwarding â†’ crash</p>
</blockquote>
<p>é‚£ä¸€åˆ»ï¼Œä½ å·²ç»ä¸æ˜¯åœ¨â€œå†™ OCâ€ï¼Œè€Œæ˜¯åœ¨<strong>å’Œ Runtime å¯¹è¯</strong>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[# CSS å­¦ä¹ ç¬”è®°ï¼šå½»åº•æŒæ¡ `:nth-child(n)` ä¼ªç±»é€‰æ‹©å™¨]]></title>    <link>https://juejin.cn/post/7598362826110173234</link>    <guid>https://juejin.cn/post/7598362826110173234</guid>    <pubDate>2026-01-23T09:46:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7598362826110173234" data-draft-id="7598181989969297435" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="# CSS å­¦ä¹ ç¬”è®°ï¼šå½»åº•æŒæ¡ `:nth-child(n)` ä¼ªç±»é€‰æ‹©å™¨  "/> <meta itemprop="keywords" content="CSS"/> <meta itemprop="datePublished" content="2026-01-23T09:46:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·80110532256"/> <meta itemprop="url" content="https://juejin.cn/user/1927884034804425"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            # CSS å­¦ä¹ ç¬”è®°ï¼šå½»åº•æŒæ¡ `:nth-child(n)` ä¼ªç±»é€‰æ‹©å™¨  
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1927884034804425/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·80110532256
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-23T09:46:52.000Z" title="Fri Jan 23 2026 09:46:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-23
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">CSS å­¦ä¹ ç¬”è®°ï¼šå½»åº•æŒæ¡ <code>:nth-child(n)</code> ä¼ªç±»é€‰æ‹©å™¨</h2>
<h3 data-id="heading-1">ä¸€ã€ä¸€å¥è¯å®šä¹‰ï¼ˆå…ˆé”šå®šè®¤çŸ¥ï¼‰</h3>
<blockquote>
<p><code>:nth-child(n)</code> æ˜¯ä¸€ä¸ª<strong>åŸºäºçˆ¶å…ƒç´ å­èŠ‚ç‚¹é¡ºåº</strong>çš„ç»“æ„åŒ–ä¼ªç±»é€‰æ‹©å™¨ï¼Œç”¨äºåŒ¹é…ï¼š<br/>
<strong>â€œæ˜¯å…¶ç›´æ¥çˆ¶å…ƒç´ çš„ç¬¬ <code>n</code> ä¸ªå­å…ƒç´ ï¼Œä¸”è‡ªèº«æ ‡ç­¾åï¼ˆæˆ–ç±»å‹ï¼‰ä¸é€‰æ‹©å™¨å‰ç¼€ä¸€è‡´â€</strong> çš„å…ƒç´ ã€‚<br/>
å®ƒä¸å…³å¿ƒâ€œè¿™æ˜¯ç¬¬å‡ ä¸ª <code>&lt;li&gt;</code>â€ï¼Œè€Œåªè®¤â€œè¿™æ˜¯çˆ¶å…ƒç´ çš„ç¬¬å‡ ä¸ªå­©å­â€ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-2">äºŒã€è¯­æ³•å…¨è§£ï¼šä»ç®€å•åˆ°å¼ºå¤§</h3>
<h4 data-id="heading-3">1ï¸ åŸºç¡€å½¢å¼ï¼ˆæœ€å¸¸ç”¨ï¼‰</h4>

























<table><thead><tr><th>å†™æ³•</th><th>å«ä¹‰</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>:nth-child(1)</code></td><td>ç¬¬1ä¸ªå­å…ƒç´ </td><td><code>li:nth-child(1)</code> â†’ åˆ—è¡¨ç¬¬ä¸€ä¸ª <code>&lt;li&gt;</code></td></tr><tr><td><code>:nth-child(odd)</code></td><td>æ‰€æœ‰å¥‡æ•°ä½å­å…ƒç´ ï¼ˆ1,3,5â€¦ï¼‰</td><td><code>tr:nth-child(odd)</code> â†’ è¡¨æ ¼å¥‡æ•°è¡Œ</td></tr><tr><td><code>:nth-child(even)</code></td><td>æ‰€æœ‰å¶æ•°ä½å­å…ƒç´ ï¼ˆ2,4,6â€¦ï¼‰</td><td><code>div:nth-child(even)</code> â†’ å¶æ•°ä½ <code>&lt;div&gt;</code></td></tr></tbody></table>
<h4 data-id="heading-4">2ï¸ æ•°å­¦å…¬å¼ <code>an + b</code>ï¼ˆä¸‡èƒ½é€šå¼ï¼‰</h4>
<ul>
<li><code>n</code> æ˜¯ä» <code>0</code> å¼€å§‹çš„æ•´æ•°ï¼ˆ<code>n = 0, 1, 2, 3...</code>ï¼‰</li>
<li>è®¡ç®—ç»“æœ <code>an + b</code> å³ä¸º<strong>åŒ¹é…çš„å­å…ƒç´ ä½ç½®ï¼ˆä» 1 å¼€å§‹è®¡æ•°ï¼‰</strong></li>
</ul>









































<table><thead><tr><th>å…¬å¼</th><th>å±•å¼€ï¼ˆn=0,1,2,3â€¦ï¼‰</th><th>å®é™…åŒ¹é…ä½ç½®</th><th>å¸¸è§ç”¨é€”</th></tr></thead><tbody><tr><td><code>2n</code></td><td>0, 2, 4, 6â€¦ â†’ <strong>å¿½ç•¥ 0</strong></td><td>2, 4, 6, 8â€¦</td><td>ç­‰ä»·äº <code>even</code></td></tr><tr><td><code>2n+1</code></td><td>1, 3, 5, 7â€¦</td><td>1, 3, 5, 7â€¦</td><td>ç­‰ä»·äº <code>odd</code></td></tr><tr><td><code>3n+1</code></td><td>1, 4, 7, 10â€¦</td><td>æ¯éš” 3 ä¸ªé€‰ç¬¬ 1 ä¸ª</td><td>ç½‘æ ¼é¦–åˆ—é«˜äº®</td></tr><tr><td><code>n+3</code></td><td>3, 4, 5, 6â€¦</td><td><strong>ä»ç¬¬ 3 ä¸ªå¼€å§‹æ‰€æœ‰å­å…ƒç´ </strong></td><td>â€œè·³è¿‡å‰ä¸¤ä¸ªâ€</td></tr><tr><td><code>-n+3</code></td><td>3, 2, 1, 0â€¦ â†’ <strong>0 åŠè´Ÿæ•°æ— æ•ˆ</strong></td><td>1, 2, 3</td><td><strong>å‰ä¸‰ä¸ªå…ƒç´ </strong>ï¼ˆé»„é‡‘å…¬å¼ âœ…ï¼‰</td></tr></tbody></table>
<blockquote>
<p>è®°å¿†å£è¯€ï¼š</p>
<ul>
<li><code>even</code>/<code>odd</code> â†’ çœ‹æ˜¯å¦è¢« 2 æ•´é™¤ï¼›</li>
<li><code>n+X</code> â†’ ä»ç¬¬ X ä¸ªèµ·å…¨éƒ¨ï¼›</li>
<li><code>-n+X</code> â†’ å‰ X ä¸ªï¼›</li>
<li><code>an+b</code> â†’ ä»£å…¥ n=0,1,2â€¦ ç®—å‡ºæœ‰æ•ˆæ­£æ•´æ•°å³å¯ã€‚</li>
</ul>
</blockquote>
<hr/>
<h3 data-id="heading-5">ä¸‰ã€æ ¸å¿ƒæœºåˆ¶ï¼ˆå¿…è¯»ï¼90% é”™è¯¯æºäºæ­¤ï¼‰</h3>
<h4 data-id="heading-6">æ­£ç¡®é€»è¾‘ï¼ˆä¸‰æ­¥åˆ¤å®šï¼‰</h4>
<p>å¯¹é¡µé¢ä¸­æ¯ä¸€ä¸ªç›®æ ‡å…ƒç´ ï¼ˆå¦‚æ¯ä¸ª <code>&lt;li&gt;</code>ï¼‰ï¼Œæµè§ˆå™¨æ‰§è¡Œï¼š</p>
<ol>
<li><strong>å®šä½çˆ¶å…ƒç´ </strong> â†’ æ‰¾åˆ°å®ƒçš„ <code>parentNode</code>ï¼ˆç›´æ¥çˆ¶å®¹å™¨ï¼‰ï¼›</li>
<li><strong>è®¡ç®—ä½ç½®</strong> â†’ æŸ¥çœ‹å®ƒåœ¨çˆ¶å…ƒç´ çš„ <code>children</code> åˆ—è¡¨ä¸­æ˜¯ç¬¬å‡ ä¸ªï¼ˆ<strong>ä» 1 å¼€å§‹è®¡æ•°ï¼Œåªç®—å…ƒç´ èŠ‚ç‚¹ï¼Œå¿½ç•¥çº¯æ–‡æœ¬/æ³¨é‡Š</strong>ï¼‰ï¼›</li>
<li><strong>åŒé‡æ ¡éªŒ</strong> â†’ â‘  ä½ç½®ç¬¦åˆ <code>an+b</code> å…¬å¼ï¼›â‘¡ å…ƒç´ ç±»å‹ä¸é€‰æ‹©å™¨å‰ç¼€ä¸€è‡´ï¼ˆå¦‚ <code>li</code> å¿…é¡»æ˜¯ <code>&lt;li&gt;</code> æ ‡ç­¾ï¼‰â†’ ä¸¤è€…éƒ½æ»¡è¶³æ‰åŒ¹é…ã€‚</li>
</ol>
<h4 data-id="heading-7">å¸¸è§è¯¯è§£ï¼ˆçº¢è‰²è­¦æŠ¥ï¼ï¼‰</h4>






























<table><thead><tr><th>è¯¯è§£</th><th>ä¸ºä»€ä¹ˆé”™</th><th>æ­£ç¡®åšæ³•</th></tr></thead><tbody><tr><td>â€œ<code>:nth-child(3)</code> å°±æ˜¯ç¬¬ä¸‰ä¸ª <code>&lt;li&gt;</code>â€</td><td>âŒ å®ƒæ‰¾çš„æ˜¯â€œç¬¬3ä¸ªå­å…ƒç´ â€ï¼Œä¸æ˜¯â€œç¬¬3ä¸ª <code>&lt;li&gt;</code>â€</td><td>âœ… æ”¹ç”¨ <code>li:nth-of-type(3)</code></td></tr><tr><td>â€œçˆ¶å…ƒç´ æ²¡å†™ï¼Œå°±æ‰¾ä¸åˆ°çˆ¶â€</td><td>âŒ æ¯ä¸ªå…ƒç´ å¤©ç„¶æœ‰çˆ¶èŠ‚ç‚¹ï¼ˆ<code>&lt;body&gt;</code> æˆ–å…¶ä»–ï¼‰ï¼Œæ— éœ€æ˜¾å¼å£°æ˜</td><td>âœ… <code>li:nth-child(odd)</code> ä¼šè‡ªåŠ¨ä½œç”¨äºæ‰€æœ‰ <code>&lt;li&gt;</code>ï¼Œå„è‡ªæ‰¾çˆ¹</td></tr><tr><td>â€œéšè—å…ƒç´ ï¼ˆ<code>display:none</code>ï¼‰ä¸å‚ä¸è®¡æ•°â€</td><td>âŒ <code>:nth-child</code> åŸºäº DOM ç»“æ„ï¼Œä¸æ¸²æŸ“æ— å…³</td><td>âœ… éšè—å…ƒç´ ä»å ä½ç½®ï¼›è‹¥éœ€â€œè§†è§‰ä¸Šç¬¬nä¸ªâ€ï¼Œéœ€ JS</td></tr><tr><td>â€œç©ºç™½æ¢è¡Œä¼šå½±å“åºå·â€</td><td>âš ï¸ ç°ä»£æµè§ˆå™¨å·²ä¼˜åŒ–ï¼š<strong>åªè®¡ç®—å…ƒç´ èŠ‚ç‚¹ï¼ˆElement Nodesï¼‰ï¼Œå¿½ç•¥çº¯ç©ºç™½æ–‡æœ¬èŠ‚ç‚¹</strong></td><td>âœ… å®‰å¿ƒå†™æ ¼å¼åŒ– HTMLï¼Œæ— éœ€å‹ç¼©æˆä¸€è¡Œ</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-8">å››ã€å®æˆ˜å¯¹æ¯”ï¼š<code>:nth-child()</code> vs <code>:nth-of-type()</code></h3>


















































<table><thead><tr><th>ç»´åº¦</th><th><code>:nth-child(n)</code></th><th><code>:nth-of-type(n)</code></th></tr></thead><tbody><tr><td><strong>åˆ¤å®šä¾æ®</strong></td><td>å…ƒç´ åœ¨å…¶çˆ¶å…ƒç´ ä¸­çš„<strong>æ€»å­å…ƒç´ åºå·</strong></td><td>å…ƒç´ åœ¨å…¶çˆ¶å…ƒç´ ä¸­<strong>åŒç±»å‹å…ƒç´ çš„åºå·</strong></td></tr><tr><td><strong>æ˜¯å¦è·¨ç±»å‹è®¡æ•°</strong></td><td>âœ… æ˜¯ï¼ˆ<code>&lt;h2&gt;</code>, <code>&lt;p&gt;</code>, <code>&lt;div&gt;</code> å…¨éƒ¨è®¡å…¥ï¼‰</td><td>âŒ å¦ï¼ˆåªæ•° <code>&lt;p&gt;</code>ï¼Œå¿½ç•¥ <code>&lt;h2&gt;</code>ï¼‰</td></tr><tr><td><strong>HTML ç¤ºä¾‹</strong></td><td><code>&lt;ul&gt;&lt;h2&gt;T&lt;/h2&gt;&lt;p&gt;A&lt;/p&gt;&lt;span&gt;S&lt;/span&gt;&lt;p&gt;B&lt;/p&gt;&lt;/ul&gt;</code></td><td>åŒä¸Š</td></tr><tr><td><strong><code>p:nth-child(2)</code></strong></td><td>âœ… åŒ¹é… <code>&lt;p&gt;A&lt;/p&gt;</code>ï¼ˆå®ƒæ˜¯ç¬¬2ä¸ªå­å…ƒç´ ï¼‰</td><td>â€”</td></tr><tr><td><strong><code>p:nth-child(4)</code></strong></td><td>âœ… åŒ¹é… <code>&lt;p&gt;B&lt;/p&gt;</code>ï¼ˆå®ƒæ˜¯ç¬¬4ä¸ªå­å…ƒç´ ï¼‰</td><td>â€”</td></tr><tr><td><strong><code>p:nth-of-type(1)</code></strong></td><td>â€”</td><td>âœ… åŒ¹é… <code>&lt;p&gt;A&lt;/p&gt;</code>ï¼ˆç¬¬ä¸€ä¸ª <code>&lt;p&gt;</code>ï¼‰</td></tr><tr><td><strong><code>p:nth-of-type(2)</code></strong></td><td>â€”</td><td>âœ… åŒ¹é… <code>&lt;p&gt;B&lt;/p&gt;</code>ï¼ˆç¬¬äºŒä¸ª <code>&lt;p&gt;</code>ï¼‰</td></tr><tr><td><strong>ä½•æ—¶é€‰ç”¨</strong></td><td>éœ€è¦â€œæŒ‰ç‰©ç†ä½ç½®å¸ƒå±€â€ï¼ˆå¦‚è¡¨æ ¼éš”è¡Œã€ç½‘æ ¼é¦–è¡Œï¼‰</td><td>éœ€è¦â€œæŒ‰æ ‡ç­¾è¯­ä¹‰ç­›é€‰â€ï¼ˆå¦‚ç¬¬3ä¸ªæ®µè½ã€æœ€å2ä¸ªåˆ—è¡¨é¡¹ï¼‰</td></tr></tbody></table>
<blockquote>
<p>å¿«é€Ÿå†³ç­–æ ‘ï¼š<br/>
ä½ æƒ³é€‰ã€Œ<strong>æ’ç¬¬å‡ çš„å…ƒç´ </strong>ã€â†’ <code>:nth-child()</code><br/>
ä½ æƒ³é€‰ã€Œ<strong>ç¬¬å‡ ä¸ªåŒç±»å…ƒç´ </strong>ã€â†’ <code>:nth-of-type()</code></p>
</blockquote>
<hr/>
<h3 data-id="heading-9">äº”ã€æ— çˆ¶ç±»é€‰æ‹©å™¨çš„çœŸå®å«ä¹‰ï¼ˆæ·±åº¦æ¾„æ¸…ï¼‰</h3>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">:nth-child</span>(odd) { <span class="hljs-attribute">background</span>: <span class="hljs-number">#eee</span>; }
</code></pre>
<h4 data-id="heading-10">å®ƒä¸æ˜¯â€œæ²¡æœ‰çˆ¶â€ï¼Œè€Œæ˜¯â€œä¸é™å®šçˆ¶â€</h4>
<ul>
<li>æµè§ˆå™¨ä¼š<strong>ä¸ºæ¯ä¸ª <code>&lt;li&gt;</code> ç‹¬ç«‹æ‰§è¡Œ</strong>ï¼š<br/>
<code>å½“å‰&lt;li&gt;.parentNode.children</code> â†’ æ‰¾åˆ°å®ƒåœ¨å…¶ä¸­çš„ç´¢å¼• â†’ åˆ¤æ–­æ˜¯å¦ä¸ºå¥‡æ•° â†’ æ˜¯åˆ™åº”ç”¨æ ·å¼ã€‚</li>
<li>å› æ­¤ï¼Œå®ƒå¯èƒ½åŒæ—¶ä½œç”¨äºï¼š
<ul>
<li><code>&lt;ul&gt;</code> ä¸‹çš„ <code>&lt;li&gt;</code></li>
<li><code>&lt;ol&gt;</code> ä¸‹çš„ <code>&lt;li&gt;</code></li>
<li><code>&lt;nav&gt;</code> ä¸­çš„ <code>&lt;li&gt;</code>ï¼ˆè¯­ä¹‰åŒ–å¯¼èˆªï¼‰</li>
<li>ç”šè‡³ <code>&lt;section&gt;</code> ç›´æ¥å­çº§çš„ <code>&lt;li&gt;</code>ï¼ˆHTML5 å…è®¸ï¼‰</li>
</ul>
</li>
</ul>
<h4 data-id="heading-11">ä¸ºä»€ä¹ˆå¯ä»¥è¿™æ ·å†™ï¼Ÿ</h4>
<ul>
<li>CSS æ˜¯<strong>å…¨å±€ä½œç”¨åŸŸ</strong>ï¼Œé€‰æ‹©å™¨æè¿°çš„æ˜¯â€œæ»¡è¶³æ¡ä»¶çš„å…ƒç´ é›†åˆâ€ï¼Œä¸å¼ºåˆ¶ç»‘å®šçˆ¶å®¹å™¨ï¼›</li>
<li>è¿™ç§å†™æ³•ç®€æ´é«˜æ•ˆï¼Œé€‚åˆé€šç”¨æ ·å¼ï¼ˆå¦‚æ‰€æœ‰åˆ—è¡¨éš”è¡Œå˜è‰²ï¼‰ï¼›</li>
<li>âš ï¸ ä½†å¤§å‹é¡¹ç›®ä¸­å»ºè®®<strong>å¢åŠ å‘½åç©ºé—´çº¦æŸ</strong>ä»¥é˜²å†²çªï¼š</li>
</ul>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* æ¨èï¼šæ¨¡å—åŒ–é™å®š */</span>
<span class="hljs-selector-class">.product-list</span> <span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">:nth-child</span>(odd) { ... }
<span class="hljs-selector-class">.nav-menu</span> <span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">:nth-child</span>(odd)   { ... }

<span class="hljs-comment">/* ä¸æ¨èï¼šå…¨å±€æ±¡æŸ“é£é™© */</span>
<span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">:nth-child</span>(odd) { ... } <span class="hljs-comment">/* å¯èƒ½æ„å¤–å½±å“ç¬¬ä¸‰æ–¹ç»„ä»¶ */</span>
</code></pre>
<hr/>
<h3 data-id="heading-12">å…­ã€ç»å…¸åº”ç”¨åœºæ™¯ï¼ˆé™„å¯å¤åˆ¶ä»£ç ï¼‰</h3>
<h4 data-id="heading-13">åœºæ™¯ 1ï¼šè¡¨æ ¼éš”è¡Œå˜è‰²ï¼ˆæœ€ç¨³æ–¹æ¡ˆï¼‰</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">table</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>å¼ ä¸‰<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>85<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>æå››<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>92<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>ç‹äº”<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>78<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/*  æ¨èï¼šç”¨ :nth-childï¼Œä¸å— thead/tfoot å¹²æ‰° */</span>
<span class="hljs-selector-tag">table</span> <span class="hljs-selector-tag">tr</span><span class="hljs-selector-pseudo">:nth-child</span>(even) { <span class="hljs-attribute">background</span>: <span class="hljs-number">#f9f9f9</span>; }
<span class="hljs-selector-tag">table</span> <span class="hljs-selector-tag">tr</span><span class="hljs-selector-pseudo">:nth-child</span>(odd)  { <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>; }
</code></pre>
<h4 data-id="heading-14">åœºæ™¯ 2ï¼šç½‘æ ¼å¸ƒå±€é¦–è¡ŒåŠ ç²—</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"grid"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>4<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>5<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>6<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* æ¯è¡Œ3åˆ— â†’ é¦–è¡Œï¼š1,2,3 â†’ ä½ç½® 1,2,3 â†’ ç”¨ -n+3 */</span>
<span class="hljs-selector-class">.grid</span> <span class="hljs-selector-tag">div</span><span class="hljs-selector-pseudo">:nth-child</span>(-n+<span class="hljs-number">3</span>) { <span class="hljs-attribute">font-weight</span>: bold; }
</code></pre>
<h4 data-id="heading-15">åœºæ™¯ 3ï¼šå¯¼èˆªèœå•ä»…ç¬¬1ã€3ã€5é¡¹æœ‰ä¸‹åˆ’çº¿</h4>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.nav-link</span><span class="hljs-selector-pseudo">:nth-child</span>(<span class="hljs-number">2</span>n+<span class="hljs-number">1</span>) { <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">2px</span> solid blue; }
</code></pre>
<hr/>
<h3 data-id="heading-16">ä¸ƒã€è°ƒè¯•æŠ€å·§ï¼ˆå¼€å‘å¿…å¤‡ï¼‰</h3>

























<table><thead><tr><th>æ–¹æ³•</th><th>æ“ä½œ</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><strong>æµè§ˆå™¨å¼€å‘è€…å·¥å…·</strong></td><td>åœ¨ Elements é¢æ¿é€‰ä¸­ <code>&lt;li&gt;</code> â†’ å³ä¾§ Styles æŸ¥çœ‹æ˜¯å¦ç”Ÿæ•ˆ â†’ å±•å¼€çˆ¶èŠ‚ç‚¹æ•°å­å…ƒç´ </td><td>âœ… éªŒè¯å®é™…ä½ç½®</td></tr><tr><td><strong>Console å¿«é€ŸéªŒè¯</strong></td><td>è¾“å…¥ <code>document.querySelector('li:nth-child(2)')</code></td><td>âœ… è¿”å›åŒ¹é…çš„ç¬¬ä¸€ä¸ªå…ƒç´ </td></tr><tr><td><strong>ä¸´æ—¶é«˜äº®æ‰€æœ‰åŒ¹é…é¡¹</strong></td><td><code>*:nth-child(odd) { outline: 2px solid red !important; }</code></td><td>âœ… å¯è§†åŒ–æ‰€æœ‰å¥‡æ•°ä½å­å…ƒç´ ï¼ˆæ…ç”¨ï¼‰</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-17">å…«ã€å…¼å®¹æ€§ä¸æ³¨æ„äº‹é¡¹</h3>





















<table><thead><tr><th>é¡¹ç›®</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>âœ… <strong>æµè§ˆå™¨æ”¯æŒ</strong></td><td>Chrome 4+ / Firefox 3.5+ / Safari 3.1+ / Edge 12+ / <strong>IE9+</strong>ï¼ˆIE8åŠä»¥ä¸‹ä¸æ”¯æŒï¼‰</td></tr><tr><td>âš ï¸ <strong>æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰æ³¨æ„</strong></td><td>è‹¥ HTML ç”±æœåŠ¡ç«¯ç”Ÿæˆï¼Œç¡®ä¿ç»“æ„ä¸å®¢æˆ·ç«¯ä¸€è‡´ï¼Œå¦åˆ™æ ·å¼é”™ä½</td></tr><tr><td>ğŸš« <strong>ä¸èƒ½åšçš„äº‹</strong></td><td>â€¢ æ— æ³•åŸºäºå†…å®¹ï¼ˆå¦‚æ–‡å­—åŒ…å«â€œé‡è¦â€ï¼‰ç­›é€‰â€¢ æ— æ³•é€‰æ‹©â€œå€’æ•°ç¬¬2ä¸ªå¯è§å…ƒç´ â€ï¼ˆéœ€ JSï¼‰â€¢ æ— æ³•è·¨çˆ¶å…ƒç´ è®¡æ•°ï¼ˆå¦‚â€œæ•´ä¸ªé¡µé¢ç¬¬5ä¸ª <code>&lt;li&gt;</code>â€ï¼‰</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-18">é™„å½•ï¼šé€ŸæŸ¥è®°å¿†å¡ï¼ˆæ‰“å°/æ”¶è—ç‰ˆï¼‰</h3>













































<table><thead><tr><th>ç›®æ ‡</th><th>å†™æ³•</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>ç¬¬1ä¸ªå…ƒç´ </td><td><code>:nth-child(1)</code></td><td>æœ€ç®€å†™æ³•</td></tr><tr><td>å¥‡æ•°ä½</td><td><code>:nth-child(odd)</code> æˆ– <code>:nth-child(2n+1)</code></td><td>äºŒé€‰ä¸€</td></tr><tr><td>å¶æ•°ä½</td><td><code>:nth-child(even)</code> æˆ– <code>:nth-child(2n)</code></td><td>äºŒé€‰ä¸€</td></tr><tr><td>å‰3ä¸ª</td><td><code>:nth-child(-n+3)</code></td><td>âœ… é»„é‡‘å…¬å¼</td></tr><tr><td>ä»ç¬¬4ä¸ªèµ·æ‰€æœ‰</td><td><code>:nth-child(n+4)</code></td><td>âœ… é»„é‡‘å…¬å¼</td></tr><tr><td>æ¯4ä¸ªé€‰ç¬¬3ä¸ª</td><td><code>:nth-child(4n+3)</code></td><td>å¦‚ 3,7,11,15â€¦</td></tr><tr><td>ä»…æœ€åä¸€ä¸ª</td><td><code>:nth-last-child(1)</code></td><td>å€’åºè®¡æ•°</td></tr></tbody></table>
<hr/>
<p><strong>æœ€åé€ä½ ä¸€å¥å¿ƒæ³•</strong>ï¼š</p>
<blockquote>
<p><strong><code>:nth-child()</code> ä¸æ˜¯â€œæ‰¾ç¬¬å‡ ä¸ª <code>&lt;p&gt;</code>â€ï¼Œè€Œæ˜¯â€œç«™åœ¨çˆ¶å…ƒç´ é—¨å£ï¼Œç‚¹åå«ç¬¬nä¸ªè¿›é—¨çš„å­©å­â€”â€”è¿˜å¾—ç¡®è®¤ä»–æ˜¯ä¸æ˜¯ä½ è¦æ‰¾çš„é‚£ä½â€ã€‚</strong><br/>
ç†è§£äº†è¿™ä¸ªç”»é¢ï¼Œä½ å°±æ°¸è¿œä¸ä¼šå†å†™é”™ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>