<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[JS-ä¸€æ–‡å¸¦ä½ å½»åº•ææ‡‚ Promise å¹¶å‘æ§åˆ¶ï¼šall, race, any, allSettled]]></title>    <link>https://juejin.cn/post/7602544700476227594</link>    <guid>https://juejin.cn/post/7602544700476227594</guid>    <pubDate>2026-02-04T07:40:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602544700476227594" data-draft-id="7602531501457555465" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JS-ä¸€æ–‡å¸¦ä½ å½»åº•ææ‡‚ Promise å¹¶å‘æ§åˆ¶ï¼šall, race, any, allSettled"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2026-02-04T07:40:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘ç°ä¸€åªå¤§å‘†ç“œ"/> <meta itemprop="url" content="https://juejin.cn/user/180747382561607"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JS-ä¸€æ–‡å¸¦ä½ å½»åº•ææ‡‚ Promise å¹¶å‘æ§åˆ¶ï¼šall, race, any, allSettled
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/180747382561607/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘ç°ä¸€åªå¤§å‘†ç“œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T07:40:10.000Z" title="Wed Feb 04 2026 07:40:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>åœ¨å¤„ç†å¼‚æ­¥ä»»åŠ¡æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦åŒæ—¶å‘èµ·å¤šä¸ªè¯·æ±‚ã€‚Promise æä¾›çš„é™æ€æ–¹æ³•èƒ½è®©æˆ‘ä»¬ä¼˜é›…åœ°æ§åˆ¶å¤šä¸ªå¹¶å‘å¼‚æ­¥ä»»åŠ¡ã€‚æœ¬æ–‡å°†æ·±åº¦å¯¹æ¯” <code>all</code>ã€<code>race</code>ã€<code>any</code> å’Œ <code>allSettled</code> çš„åŒºåˆ«ä¸åº”ç”¨åœºæ™¯ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ æ–¹æ³•è¯¦è§£ä¸å¯¹æ¯”</h2>
<h3 data-id="heading-2">1. Promise.all() â€”â€” â€œå…¨å‘˜é€šè¿‡åˆ¶â€</h3>
<ul>
<li>
<p><strong>æ¦‚å¿µ</strong>ï¼šå°†å¤šä¸ª Promise å®ä¾‹åŒ…è£…æˆä¸€ä¸ªã€‚</p>
</li>
<li>
<p><strong>çŠ¶æ€å†³å®š</strong>ï¼š</p>
<ul>
<li><strong>Fulfilled</strong>ï¼šæ‰€æœ‰å®ä¾‹éƒ½æˆåŠŸã€‚</li>
<li><strong>Rejected</strong>ï¼šåªè¦æœ‰<strong>ä¸€ä¸ª</strong>å¤±è´¥ï¼Œæ•´ä½“ç«‹å³å¤±è´¥ã€‚</li>
</ul>
</li>
<li>
<p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šå¤šä¸ªæ¥å£è”åŠ¨ï¼Œå¿…é¡»å…¨éƒ¨æ‹¿åˆ°æ•°æ®æ‰èƒ½æ¸²æŸ“é¡µé¢ã€‚</p>
</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript">  <span class="hljs-keyword">const</span> p1 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">1</span>);
  <span class="hljs-keyword">const</span> p2 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">2</span>);
  <span class="hljs-keyword">const</span> p3 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">3</span>);

  <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([p1, p2, p3])
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">results</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(results); <span class="hljs-comment">// [1, 2, 3] é¡ºåºä¸ä¼ å…¥ä¸€è‡´</span>
    })
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å…¶ä¸­ä¸€ä¸ªå¤±è´¥äº†'</span>, err);
    });
</code></pre>
<h3 data-id="heading-3">2. Promise.race() â€”â€” â€œç«é€Ÿåˆ¶â€</h3>
<ul>
<li><strong>æ¦‚å¿µ</strong>ï¼šè°è·‘å¾—å¿«å°±å¬è°çš„ã€‚</li>
<li><strong>çŠ¶æ€å†³å®š</strong>ï¼šçŠ¶æ€å–å†³äº<strong>ç¬¬ä¸€ä¸ª</strong>æ”¹å˜çŠ¶æ€çš„å®ä¾‹ã€‚</li>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šè¯·æ±‚è¶…æ—¶æ§åˆ¶ã€‚</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript">  <span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'1ç§’åæˆåŠŸ'</span>), <span class="hljs-number">1000</span>)
  );
  <span class="hljs-keyword">const</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'500æ¯«ç§’åæˆåŠŸ'</span>), <span class="hljs-number">500</span>)
  );
  <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>([p1, p2]).<span class="hljs-title function_">then</span>(
    <span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•1ç»“æœï¼š<span class="hljs-subst">${res}</span> (ç«é€Ÿèµ¢å®¶)`</span>, <span class="hljs-string">'success'</span>),
    <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æµ‹è¯•1å¤±è´¥ï¼š<span class="hljs-subst">${err}</span>`</span>, <span class="hljs-string">'error'</span>)
  );
</code></pre>
<h3 data-id="heading-4">3. Promise.any() â€”â€” â€œæ‹©ä¼˜å½•å–åˆ¶â€</h3>
<ul>
<li>
<p><strong>æ¦‚å¿µ</strong>ï¼šåªè¦æœ‰ä¸€ä¸ªæˆåŠŸå°±ç®—æˆåŠŸã€‚</p>
</li>
<li>
<p><strong>çŠ¶æ€å†³å®š</strong>ï¼š</p>
<ul>
<li><strong>Fulfilled</strong>ï¼šåªè¦æœ‰ä¸€ä¸ªæˆåŠŸã€‚</li>
<li><strong>Rejected</strong>ï¼š<strong>å…¨éƒ¨</strong>éƒ½å¤±è´¥æ—¶æ‰å¤±è´¥ï¼ˆè¿”å› <code>AggregateError</code>ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šä»å¤šä¸ªå¤‡ç”¨æœåŠ¡å™¨è·å–ç›¸åŒèµ„æºã€‚</p>
</li>
</ul>
<pre><code class="hljs language-JavaScript" lang="JavaScript">  <span class="hljs-keyword">const</span> p1 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">1</span>);
  <span class="hljs-keyword">const</span> p2 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-number">2</span>);
  <span class="hljs-keyword">const</span> p3 = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-number">3</span>);
  <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">any</span>([p1, p2, p3])
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æœ‰ä¸€ä¸ªæˆåŠŸäº†ï¼š<span class="hljs-subst">${res}</span>`</span>, <span class="hljs-string">'success'</span>))
    .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ‰€æœ‰éƒ½å¤±è´¥äº†ï¼š<span class="hljs-subst">${err}</span>`</span>, <span class="hljs-string">'error'</span>));
</code></pre>
<h3 data-id="heading-5">4. Promise.allSettled() â€”â€” â€œç»“æœå¯¼å‘åˆ¶â€</h3>
<ul>
<li><strong>æ¦‚å¿µ</strong>ï¼šæ— è®ºæˆåŠŸå¤±è´¥ï¼Œæˆ‘å…¨éƒ½è¦ã€‚</li>
<li><strong>çŠ¶æ€å†³å®š</strong>ï¼šæ°¸è¿œæ˜¯ <strong>fulfilled</strong>ï¼ˆåœ¨æ‰€æœ‰å®ä¾‹éƒ½ç»“æŸåï¼‰ã€‚</li>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šæ‰§è¡Œå¤šä¸ªäº’ä¸å½±å“çš„æ“ä½œï¼Œæœ€åç»Ÿä¸€ç»Ÿè®¡ç»“æœã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-6">äºŒã€ æ ¸å¿ƒå·®å¼‚å¯¹æ¯”è¡¨</h2>
<p>ä¸ºäº† scannabilityï¼ˆæ˜“è¯»æ€§ï¼‰ï¼Œæˆ‘ä»¬é€šè¿‡è¡¨æ ¼ç›´è§‚å¯¹æ¯”ï¼š</p>



































<table><thead><tr><th><strong>æ–¹æ³•</strong></th><th><strong>æˆåŠŸæ¡ä»¶ (Fulfilled)</strong></th><th><strong>å¤±è´¥æ¡ä»¶ (Rejected)</strong></th><th><strong>ç»“æœè¿”å›å€¼</strong></th></tr></thead><tbody><tr><td><strong><code>.all()</code></strong></td><td><strong>å…¨éƒ¨</strong>æˆåŠŸ</td><td><strong>ä»»æ„ä¸€ä¸ª</strong>å¤±è´¥</td><td>æˆåŠŸç»“æœæ•°ç»„ï¼ˆæŒ‰åºï¼‰</td></tr><tr><td><strong><code>.race()</code></strong></td><td><strong>ä»»æ„ä¸€ä¸ª</strong>æœ€å…ˆæˆåŠŸ</td><td><strong>ä»»æ„ä¸€ä¸ª</strong>æœ€å…ˆå¤±è´¥</td><td>ç¬¬ä¸€ä¸ªæ”¹å˜çŠ¶æ€çš„å€¼</td></tr><tr><td><strong><code>.any()</code></strong></td><td><strong>ä»»æ„ä¸€ä¸ª</strong>æˆåŠŸ</td><td><strong>å…¨éƒ¨</strong>å¤±è´¥</td><td>ç¬¬ä¸€ä¸ªæˆåŠŸçš„å€¼</td></tr><tr><td><strong><code>.allSettled()</code></strong></td><td><strong>æ‰€æœ‰</strong>ä»»åŠ¡ç»“æŸ</td><td>ä»ä¸ï¼ˆçŠ¶æ€æ°¸è¿œæˆåŠŸï¼‰</td><td>åŒ…å«çŠ¶æ€å’Œå€¼çš„å¯¹è±¡æ•°ç»„</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-7">ä¸‰ã€ æ€»ç»“</h2>
<h3 data-id="heading-8">1. Promise.all ä¸ Promise.race çš„ç›´è§‚åŒºåˆ«</h3>
<ul>
<li><strong>Promise.all</strong>ï¼šç…§é¡¾â€œè·‘å¾—æœ€æ…¢â€çš„ã€‚å¿…é¡»ç­‰æœ€æ…¢çš„ä¸€ä¸ªå®Œæˆï¼Œä¸”å…¨å‘˜åˆæ ¼ï¼Œæ‰ç»™æœ€ç»ˆç»“æœã€‚</li>
<li><strong>Promise.race</strong>ï¼šå…³æ³¨â€œè·‘å¾—æœ€å¿«â€çš„ã€‚æœ€å¿«çš„é‚£ä¸ªä¸€æ—¦è¿‡çº¿ï¼Œæ— è®ºè¾“èµ¢ï¼Œæ¯”èµ›ç«‹åˆ»ç»“æŸã€‚</li>
</ul>
<h3 data-id="heading-9">2.  è¿›é˜¶ä½¿ç”¨</h3>
<p>åœ¨é¡¹ç›®ä¸­ï¼Œé…åˆ <code>async/await</code> ä½¿ç”¨æ›´åŠ ä¼˜é›…ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchData</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// å¼ºç±»å‹çº¦æŸç»“æœæ•°ç»„</span>
    <span class="hljs-keyword">const</span> [user, orders] = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-property">all</span>&lt;[<span class="hljs-title class_">UserType</span>, <span class="hljs-title class_">OrderType</span>[]]&gt;([
      <span class="hljs-title function_">getUserInfo</span>(),
      <span class="hljs-title function_">getOrderList</span>()
    ]);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user, orders);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// å¤„ç†ç¬¬ä¸€ä¸ªæ•è·åˆ°çš„é”™è¯¯</span>
  }
};
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ï¼ˆçº¯å¹²è´§ï¼‰å¦‚ä½•ä¸º AI agents ç¼–å†™ä¼˜ç§€çš„ Spec]]></title>    <link>https://juejin.cn/post/7602901565032792110</link>    <guid>https://juejin.cn/post/7602901565032792110</guid>    <pubDate>2026-02-04T08:29:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602901565032792110" data-draft-id="7601486204174843954" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ï¼ˆçº¯å¹²è´§ï¼‰å¦‚ä½•ä¸º AI agents ç¼–å†™ä¼˜ç§€çš„ Spec"/> <meta itemprop="keywords" content="AIç¼–ç¨‹,VibeCoding,Agent"/> <meta itemprop="datePublished" content="2026-02-04T08:29:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘ä¸åƒé¥¼å¹²"/> <meta itemprop="url" content="https://juejin.cn/user/3263006241480605"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ï¼ˆçº¯å¹²è´§ï¼‰å¦‚ä½•ä¸º AI agents ç¼–å†™ä¼˜ç§€çš„ Spec
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3263006241480605/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘ä¸åƒé¥¼å¹²
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T08:29:54.000Z" title="Wed Feb 04 2026 08:29:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»39åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.7;font-weight:400;font-size:16px;overflow-x:hidden;color:#212122}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:8px;padding-bottom:8px}.markdown-body h1{color:#a0a0a0;font-size:38px;margin-top:32px;padding-top:32px}.markdown-body h2{color:#fff;background-color:#212122;width:fit-content;border-bottom-right-radius:100px;margin-top:47px;margin-bottom:16px;padding:4px 48px 4px 8px;line-height:1.7;font-size:30px;transition:all .3s ease-out}.markdown-body h2:hover{border-bottom-right-radius:50px;transition:all .3s ease-out}.markdown-body h3{font-size:24px;padding-left:8px;margin-top:32px;border-bottom:2px solid #c6c4c4;line-height:1.7}.markdown-body h4{font-size:20px;padding-left:8px;margin-top:32px;border-bottom:1px solid #ddd}.markdown-body h5{font-size:16px;margin-top:24px}.markdown-body h6{margin-top:16px;line-height:1.1}.markdown-body p{font-size:16px;text-align:start;white-space:normal;text-size-adjust:auto;line-height:2;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%;margin:auto;padding-left:8px;padding-right:8px}.markdown-body hr{border:none;border-top:4px double #212122;margin-top:32px;margin-bottom:32px;text-align:center}.markdown-body hr:after{content:"â™¥";display:inline-block;position:relative;top:-15px;padding:0 10px;color:#212122;font-size:18px}.markdown-body code{word-break:break-word;overflow-x:auto;background-color:#f1f1f1;color:#ef7060;font-size:14px;padding:.065em 6px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.7;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);margin:32px 16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-color:#212122;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);background-size:40px}.markdown-body pre&gt;code{font-size:14px;padding:16px 8px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#fff;background:#272822}.markdown-body pre&gt;code::-webkit-scrollbar{height:10px;background-color:#f5f5f5}.markdown-body pre&gt;code::-webkit-scrollbar-track{box-shadow:inset 0 0 6px rgba(0,0,0,.3);border-radius:3px;background-color:#f5f5f5}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{border-radius:3px;box-shadow:inset 0 0 6px rgba(0,0,0,.3);background-color:#555}.markdown-body a{color:#ef7060;padding:2px;text-decoration:none;border-bottom:.125em solid #ef7060;border-radius:2px;box-shadow:inset 0 -.025em 0 #ef7060;transition:box-shadow .27s cubic-bezier(.77,0,.175,1),color .27s cubic-bezier(.77,0,.175,1)}.markdown-body a:focus,.markdown-body a:hover{outline:none;box-shadow:inset 0 -1.5em 0 #ef7060;color:#fff}.markdown-body a:before{content:"â‡² ";vertical-align:top;margin-left:2px;font-family:dart!important;font-size:12px;color:inherit;opacity:.7}.markdown-body table{background:#fbfbfb;border-radius:4px;border-collapse:collapse;margin:auto;padding:5px;width:95%;box-shadow:0 5px 10px rgba(0,0,0,.1);animation:float 5s infinite}.markdown-body table th{color:#fff;background:#212122;border-bottom:1px solid #9ea7af;border-right:1px solid #343a45;font-size:18px;padding:16px;text-align:left;vertical-align:middle}.markdown-body table th:first-child{border-top-left-radius:4px}.markdown-body table th:last-child{border-top-right-radius:4px;border-right:none}.markdown-body table tr{border-top:1px solid #c1c3d1;border-bottom:1px solid #c1c3d1;color:#666b85}.markdown-body table tr:hover td{background:#212122;color:#fff;border-top:1px solid #22262e}.markdown-body table tr:first-child{border-top:none}.markdown-body table tr:last-child{border-bottom:none}.markdown-body table tr:nth-child(odd) td{background:#f1f1f1}.markdown-body table tr:nth-child(odd):hover td{background:#212122}.markdown-body table tr:last-child td:first-child{border-bottom-left-radius:4px}.markdown-body table tr:last-child td:last-child{border-bottom-right-radius:4px}.markdown-body table td{background:#fbfbfb;padding:16px;text-align:left;vertical-align:middle;font-size:16px;border-right:1px solid #c1c3d1}.markdown-body table td:last-child{border-right:0}.markdown-body blockquote{color:#777;padding:1px 16px;margin:24px 0;border-left:4px solid #c6c4c4;background-color:#f1f1f1;transition:all .3s ease-out;border-radius:4px}.markdown-body blockquote:hover{border-left-color:#212122;background-color:#212122;color:#fff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:24px}.markdown-body ol li,.markdown-body ul li{margin-bottom:6px;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body span.math{margin-left:32px;font-size:18px;font-weight:700}@media (max-width:720px){.markdown-body h1{font-size:30.4px}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:19.2px}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:12.8px}}</style><style data-highlight="" data-highlight-key="a11y-light">.hljs-comment,.hljs-quote{color:#696969}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d91e18}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa5d00}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:green}.hljs-section,.hljs-title{color:#007faa}.hljs-keyword,.hljs-selector-tag{color:#7928a1}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fefefe;color:#545454}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><blockquote>
<p>åŸæ–‡ <a href="https://link.juejin.cn?target=https%3A%2F%2Faddyosmani.com%2Fblog%2Fgood-spec%2F" target="_blank" title="https://addyosmani.com/blog/good-spec/" ref="nofollow noopener noreferrer">How to write a good spec for AI agents</a></p>
<p>å› ä¸ºè‹±è¯­æ¯”è¾ƒå·®æ‰€ä»¥æœºç¿»äº†ä¸€éï¼Œå†æ…¢æ…¢é˜…è¯»ï¼Œä¸é€šé¡ºçš„åœ°æ–¹éƒ½åšäº†ä¿®æ”¹ï¼Œå°±é¡ºä¾¿åˆ†äº«å‡ºæ¥ã€‚æ–‡ç« å¾ˆé•¿ï¼Œå»ºè®®æ…¢æ…¢çœ‹ï¼Œæ”¶è·å¾ˆå¤šã€‚</p>
</blockquote>
<p><strong>å¤ªé•¿ä¸çœ‹ç‰ˆï¼šç›®æ ‡æ˜¯æ’°å†™ä¸€ä»½æ¸…æ™°çš„ specï¼ŒåŒ…å«æ°åˆ°å¥½å¤„çš„ç»†èŠ‚ï¼ˆå¯èƒ½åŒ…æ‹¬ç»“æ„ã€é£æ ¼ã€æµ‹è¯•ã€è¾¹ç•Œæ¡ä»¶ï¼‰ï¼Œæ—¢èƒ½å¼•å¯¼ AIï¼Œåˆä¸ä¼šå› ä¿¡æ¯è¿‡è½½è€Œå¯¼è‡´æ¨¡å‹è¿·å¤±æ–¹å‘ã€‚å°†å¤§ä»»åŠ¡æ‹†è§£ä¸ºå°ä»»åŠ¡ï¼Œè€Œä¸æ˜¯å°†æ‰€æœ‰å†…å®¹éƒ½å¡è¿›ä¸€ä¸ªå·¨å¤§çš„ promptï¼ˆæç¤ºè¯ï¼‰ä¸­ã€‚å…ˆåœ¨åªè¯»æ¨¡å¼ä¸‹è§„åˆ’ï¼Œå†æ‰§è¡Œï¼Œå¹¶æŒç»­è¿­ä»£ã€‚</strong></p>
<blockquote>
<p>â€œå…³äºæ€æ ·ä¸º AI agent å†™å¥½ specï¼Œæˆ‘å¬è¿‡å¾ˆå¤šè®¨è®ºï¼Œä½†ä¸€ç›´æ²¡æ‰¾åˆ°ä¸€ä¸ªé è°±çš„æ¡†æ¶ã€‚æˆ‘å¯ä»¥æŠŠ spec å†™å¾—åƒ RFC ä¸€æ ·è¯¦å°½ï¼Œä½†åˆ°æŸä¸ªç‚¹ï¼Œä¸Šä¸‹æ–‡å¤ªå¤§ï¼Œæ¨¡å‹å°±æ’‘ä¸ä½äº†ã€‚â€</p>
</blockquote>
<p>è®¸å¤šå¼€å‘è€…éƒ½æœ‰è¿™ç§æŒ«è´¥æ„Ÿï¼šç›´æ¥æŠŠä¸€ä»½å·¨å¤§çš„ spec æ‰”ç»™ AI agent å¹¶ä¸ä¼šå¥æ•ˆâ€”â€”ä¸Šä¸‹æ–‡çª—å£çš„é™åˆ¶å’Œæ¨¡å‹çš„â€œæ³¨æ„åŠ›é¢„ç®—â€ä¼šæˆä¸ºé˜»ç¢ã€‚å…³é”®åœ¨äºå†™èªæ˜çš„ specï¼šæ—¢èƒ½æ¸…æ™°å¼•å¯¼ agentï¼Œåˆèƒ½æ§åˆ¶åœ¨å®é™…å¯ç”¨çš„ä¸Šä¸‹æ–‡è§„æ¨¡å†…ï¼Œå¹¶èƒ½éšç€é¡¹ç›®æ¨è¿›ä¸æ–­æ¼”åŒ–ã€‚æœ¬æ–‡æ€»ç»“äº†æˆ‘ä½¿ç”¨ Claude Codeã€Gemini CLI ç­‰ç¼–ç  agent çš„ç»éªŒä¸æœ€ä½³å®è·µï¼Œæ•´ç†æˆä¸€å¥— spec ç¼–å†™æ¡†æ¶ï¼Œè®©ä½ çš„ AI agent ä¿æŒä¸“æ³¨ã€é«˜æ•ˆã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šä»‹ç»å†™å‡ºä¼˜ç§€ AI agent spec çš„äº”ä¸ªåŸåˆ™ï¼›æ¯ä¸ªåŸåˆ™éƒ½ä¼šå…ˆç»™å‡ºä¸€æ¡åŠ ç²—çš„æ ¸å¿ƒè¦ç‚¹ã€‚</p>
<h2 data-id="heading-0">1. ä»é«˜å±‚æ„¿æ™¯å¼€å§‹ï¼Œè®© AI èµ·è‰ç»†èŠ‚</h2>
<p><strong>å…ˆç”¨ä¸€ä»½ç®€æ˜çš„ high-level specï¼ˆé¡¹ç›®æ¦‚è¦ï¼‰å¯åŠ¨é¡¹ç›®ï¼Œç„¶åè®© AI å°†å…¶æ‰©å±•ä¸ºè¯¦ç»†è®¡åˆ’ã€‚</strong></p>
<p>ä¸å…¶åœ¨å‰æœŸè¿‡åº¦è®¾è®¡ï¼Œä¸å¦‚ä»ä¸€ä¸ªæ¸…æ™°çš„ç›®æ ‡é™ˆè¿°å’Œå‡ ä¸ªæ ¸å¿ƒéœ€æ±‚å¼€å§‹ã€‚å°†å…¶è§†ä¸ºâ€œäº§å“ç®€æŠ¥â€ï¼Œè®© agent ä»ä¸­ç”Ÿæˆæ›´è¯¦å°½çš„ specã€‚è¿™æ ·æ—¢èƒ½åˆ©ç”¨ AI åœ¨ç»†èŠ‚é˜è¿°æ–¹é¢çš„ä¼˜åŠ¿ï¼Œåˆèƒ½è®©ä½ æŒæ§å¤§å±€ã€‚é™¤éä½ ä»ä¸€å¼€å§‹å°±æœ‰éå¸¸å…·ä½“çš„æŠ€æœ¯è¦æ±‚å¿…é¡»æ»¡è¶³ï¼Œå¦åˆ™è¿™ç§æ–¹æ³•æ•ˆæœå¾ˆå¥½ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆæœ‰æ•ˆï¼š</strong> åŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„ agent åœ¨è·å¾—å¯é çš„ high-level æŒ‡ä»¤æ—¶ï¼Œæ“…é•¿å……å®ç»†èŠ‚ï¼Œä½†å®ƒä»¬éœ€è¦ä¸€ä¸ªæ¸…æ™°çš„ä»»åŠ¡ç›®æ ‡ä»¥é¿å…åç¦»æ–¹å‘ã€‚é€šè¿‡æä¾›ç®€çŸ­çš„å¤§çº²æˆ–ç›®æ ‡æè¿°ï¼Œå¹¶è¦æ±‚ AI ç”Ÿæˆå®Œæ•´çš„ specï¼ˆä¾‹å¦‚ <code>spec.md</code> æ–‡ä»¶ï¼‰ï¼Œä½ å°±åˆ›å»ºäº†ä¸€ä¸ªä¾› agent æŒç»­å‚è€ƒçš„æ–‡æ¡£ã€‚å¯¹äº agent è€Œè¨€ï¼Œæå‰è§„åˆ’æ›´ä¸ºé‡è¦â€”â€”ä½ å¯ä»¥å…ˆè¿­ä»£å®Œå–„è®¡åˆ’ï¼Œç„¶åå†äº¤ç»™ agent ç¼–å†™ä»£ç ã€‚spec æˆä¸ºä½ å’Œ AI å…±åŒæ„å»ºçš„ç¬¬ä¸€ä¸ªäº§å‡ºç‰©ã€‚</p>
<p><strong>å®è·µæ–¹æ³•ï¼š</strong> é€šè¿‡è¿™æ ·çš„ prompt å¼€å§‹æ–°çš„ç¼–ç ä¼šè¯ï¼šâ€œä½ æ˜¯ä¸€å AI è½¯ä»¶å·¥ç¨‹å¸ˆã€‚ä¸º [é¡¹ç›® X] èµ·è‰ä¸€ä»½è¯¦ç»† specï¼Œæ¶µç›–ç›®æ ‡ã€åŠŸèƒ½ã€çº¦æŸæ¡ä»¶å’Œåˆ†æ­¥è®¡åˆ’ã€‚â€ä¿æŒåˆå§‹ prompt çš„ high-level ç‰¹æ€§â€”â€”ä¾‹å¦‚â€œæ„å»ºä¸€ä¸ªç½‘é¡µåº”ç”¨ï¼Œç”¨æˆ·å¯ä»¥è·Ÿè¸ªä»»åŠ¡ï¼ˆå¾…åŠäº‹é¡¹åˆ—è¡¨ï¼‰ï¼ŒåŒ…å«ç”¨æˆ·è´¦æˆ·ã€æ•°æ®åº“å’Œç®€æ´çš„ç”¨æˆ·ç•Œé¢â€ã€‚agent å¯èƒ½ä¼šå›å¤ä¸€ä»½ç»“æ„åŒ–çš„ spec è‰æ¡ˆï¼šæ¦‚è¿°ã€åŠŸèƒ½åˆ—è¡¨ã€æŠ€æœ¯æ ˆå»ºè®®ã€æ•°æ®æ¨¡å‹ç­‰ç­‰ã€‚è¿™ä»½ spec éšåæˆä¸ºä½ å’Œ agent éƒ½èƒ½å›æº¯å‚è€ƒçš„â€œçœŸç†ä¹‹æºâ€ã€‚GitHub çš„ AI å›¢é˜Ÿå€¡å¯¼ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.blog%2Fai-and-ml%2Fgenerative-ai%2Fspec-driven-development-with-ai-get-started-with-a-new-open-source-toolkit%2F" target="_blank" title="https://github.blog/ai-and-ml/generative-ai/spec-driven-development-with-ai-get-started-with-a-new-open-source-toolkit/" ref="nofollow noopener noreferrer">spec é©±åŠ¨å¼€å‘</a>ï¼Œè®¤ä¸ºâ€œspec æˆä¸ºå…±äº«çš„çœŸç†ä¹‹æºâ€¦â€¦æ˜¯éšé¡¹ç›®æ¼”è¿›çš„æ´»æ–‡æ¡£ã€å¯æ‰§è¡Œçš„äº§å‡ºç‰©â€ã€‚åœ¨ç¼–å†™ä»»ä½•ä»£ç ä¹‹å‰ï¼Œå®¡æŸ¥å¹¶å®Œå–„ AI ç”Ÿæˆçš„ specã€‚ç¡®ä¿å®ƒä¸ä½ çš„æ„¿æ™¯ä¸€è‡´ï¼Œå¹¶çº æ­£ä»»ä½•å¹»è§‰æˆ–åç¦»ç›®æ ‡çš„ç»†èŠ‚ã€‚</p>
<p><strong>ä½¿ç”¨ Plan Mode å¼ºåˆ¶ä¼˜å…ˆè§„åˆ’ï¼š</strong> åƒ Claude Code è¿™æ ·çš„å·¥å…·æä¾›äº† <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.claude.com%2Fdocs%2Fen%2Fcommon-workflows" target="_blank" title="https://code.claude.com/docs/en/common-workflows" ref="nofollow noopener noreferrer">Plan Modeï¼ˆè®¡åˆ’æ¨¡å¼ï¼‰</a>ï¼Œè¯¥æ¨¡å¼å°† agent é™åˆ¶ä¸ºåªè¯»æ“ä½œâ€”â€”å®ƒå¯ä»¥åˆ†æä½ çš„ä»£ç åº“å¹¶åˆ›å»ºè¯¦ç»†è®¡åˆ’ï¼Œä½†åœ¨ä½ å‡†å¤‡å¥½ä¹‹å‰ä¸ä¼šç¼–å†™ä»»ä½•ä»£ç ã€‚è¿™å¯¹è§„åˆ’é˜¶æ®µéå¸¸ç†æƒ³ï¼šåœ¨ Plan Mode ä¸‹å¯åŠ¨ï¼ˆClaude Code ä¸­æŒ‰ Shift+Tabï¼‰ï¼Œæè¿°ä½ æƒ³æ„å»ºä»€ä¹ˆï¼Œè®© agent åœ¨æ¢ç´¢ç°æœ‰ä»£ç çš„åŒæ—¶èµ·è‰ specã€‚è®©å®ƒé€šè¿‡è¯¢é—®ä½ æ¥é˜æ˜è®¡åˆ’ä¸­çš„æ¨¡ç³Šä¹‹å¤„ã€‚è®©å®ƒå®¡æŸ¥è®¡åˆ’çš„æ¶æ„ã€æœ€ä½³å®è·µã€å®‰å…¨é£é™©å’Œæµ‹è¯•ç­–ç•¥ã€‚ç›®æ ‡æ˜¯å®Œå–„è®¡åˆ’ç›´åˆ°æ²¡æœ‰ä»»ä½•è¯¯è§£ã€‚ç›´åˆ°æ­¤æ—¶æ‰é€€å‡º Plan Modeï¼Œè®© agent æ‰§è¡Œã€‚è¿™ä¸ªå·¥ä½œæµç¨‹é¿å…äº†åœ¨ spec å°šæœªç¨³å›ºå‰å°±ç›´æ¥è·³å…¥ä»£ç ç”Ÿæˆçš„å¸¸è§é™·é˜±ã€‚</p>
<p><strong>å°† spec ç”¨ä½œä¸Šä¸‹æ–‡ï¼š</strong> spec ä¸€æ—¦é€šè¿‡ï¼Œä¿å­˜è¿™ä»½ specï¼ˆä¾‹å¦‚ä¿å­˜ä¸º <code>SPEC.md</code>ï¼‰ï¼Œå¹¶æ ¹æ®éœ€è¦å°†ç›¸å…³éƒ¨åˆ†æä¾›ç»™ agentã€‚è®¸å¤šä½¿ç”¨å¼ºå¤§æ¨¡å‹çš„å¼€å‘è€…æ­£æ˜¯è¿™æ ·åšçš„â€”â€”spec æ–‡ä»¶åœ¨ä¼šè¯ä¹‹é—´æŒä¹…å­˜åœ¨ï¼Œæ¯å½“é¡¹ç›®å·¥ä½œæ¢å¤æ—¶éƒ½èƒ½ä¸º AI æä¾›é”šç‚¹ã€‚è¿™ç¼“è§£äº†å½“å¯¹è¯å†å²è¿‡é•¿æˆ–å¿…é¡»é‡å¯ agent æ—¶å¯èƒ½å‘ç”Ÿçš„â€œå¥å¿˜â€é—®é¢˜ã€‚è¿™ç±»ä¼¼äºå›¢é˜Ÿä¸­ä½¿ç”¨äº§å“éœ€æ±‚æ–‡æ¡£ï¼ˆPRDï¼‰çš„æ–¹å¼ï¼šä¸€ä»½æ¯ä¸ªäººï¼ˆæ— è®ºæ˜¯äººè¿˜æ˜¯ AIï¼‰éƒ½èƒ½æŸ¥é˜…ä»¥ä¿æŒæ­£è½¨çš„å‚è€ƒæ–‡æ¡£ã€‚æ­£å¦‚ä¸€ä½å·¥ç¨‹å¸ˆè§‚å¯Ÿåˆ°çš„ï¼Œæœ‰ç»éªŒçš„äººé€šå¸¸â€œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fsimonwillison.net%2F2025%2FOct%2F7%2Fvibe-engineering%2F" target="_blank" title="https://simonwillison.net/2025/Oct/7/vibe-engineering/" ref="nofollow noopener noreferrer">å…ˆç¼–å†™è‰¯å¥½çš„æ–‡æ¡£</a>ï¼Œæ¨¡å‹å¯èƒ½ä»…å‡­è¯¥è¾“å…¥å°±èƒ½æ„å»ºåŒ¹é…çš„å®ç°â€ã€‚è€Œ spec å°±æ˜¯é‚£ä»½æ–‡æ¡£ã€‚</p>
<p><strong>ä¿æŒç›®æ ‡å¯¼å‘ï¼š</strong> ä¸º AI agent ç¼–å†™çš„ high-level spec åº”è¯¥æ›´å¤šåœ°å…³æ³¨æ˜¯ä»€ä¹ˆå’Œä¸ºä»€ä¹ˆï¼Œè€Œä¸æ˜¯ï¼ˆè‡³å°‘æœ€åˆï¼‰ç»†ææœ«èŠ‚çš„æ€ä¹ˆåšã€‚æŠŠå®ƒæƒ³è±¡æˆç”¨æˆ·æ•…äº‹å’ŒéªŒæ”¶æ ‡å‡†ï¼šç”¨æˆ·æ˜¯è°ï¼Ÿä»–ä»¬éœ€è¦ä»€ä¹ˆï¼ŸæˆåŠŸæ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿï¼ˆä¾‹å¦‚â€œç”¨æˆ·å¯ä»¥æ·»åŠ ã€ç¼–è¾‘ã€å®Œæˆä»»åŠ¡ï¼›æ•°æ®æŒä¹…ä¿å­˜ï¼›åº”ç”¨å“åº”è¿…é€Ÿä¸”å®‰å…¨â€ï¼‰ã€‚è¿™ä½¿ AI çš„è¯¦ç»† spec æ¤æ ¹äºç”¨æˆ·éœ€æ±‚å’Œç»“æœï¼Œè€Œä¸ä»…ä»…æ˜¯æŠ€æœ¯å¾…åŠäº‹é¡¹ã€‚æ­£å¦‚ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.blog%2Fai-and-ml%2Fgenerative-ai%2Fspec-driven-development-with-ai-get-started-with-a-new-open-source-toolkit%2F" target="_blank" title="https://github.blog/ai-and-ml/generative-ai/spec-driven-development-with-ai-get-started-with-a-new-open-source-toolkit/" ref="nofollow noopener noreferrer">GitHub Spec Kit docs</a> æ–‡æ¡£æ‰€è¯´ï¼Œæä¾›ä½ æ­£åœ¨æ„å»ºä»€ä¹ˆä»¥åŠä¸ºä»€ä¹ˆçš„ high-level æè¿°ï¼Œè®© coding agent ç”Ÿæˆä¸“æ³¨äºç”¨æˆ·ä½“éªŒå’ŒæˆåŠŸæ ‡å‡†çš„è¯¦ç»† specã€‚ä»è¿™ä¸ªå®è§‚æ„¿æ™¯å¼€å§‹ï¼Œå¯ä»¥é˜²æ­¢ agent åœ¨åç»­ç¼–ç æ—¶åªè§æ ‘æœ¨ä¸è§æ£®æ—ã€‚</p>
<h2 data-id="heading-1">2. åƒä¸“ä¸š PRDï¼ˆæˆ– SRSï¼‰é‚£æ ·æ„å»º spec</h2>
<p><strong>å°†ä½ çš„ AI spec è§†ä¸ºä¸€ä»½ç»“æ„åŒ–æ–‡æ¡£ï¼ˆPRDï¼‰ï¼ŒåŒ…å«æ¸…æ™°çš„ç« èŠ‚ï¼Œè€Œä¸æ˜¯ä¸€å †æ¾æ•£çš„ç¬”è®°ã€‚</strong></p>
<p>è®¸å¤šå¼€å‘è€…å†™ç»™ AI agent çš„ specï¼Œæ–¹å¼ä¸ä¼ ç»Ÿçš„äº§å“éœ€æ±‚æ–‡æ¡£ï¼ˆPRDï¼‰æˆ–ç³»ç»Ÿè®¾è®¡æ–‡æ¡£éå¸¸ç›¸ä¼¼â€”â€”å…¨é¢ã€ç»„ç»‡è‰¯å¥½ï¼Œä¸”ä¾¿äºâ€œå­—é¢ç†è§£â€çš„ AI è§£æã€‚è¿™ç§æ›´æ­£å¼çš„å†™æ³•ä¸º agent æä¾›äº†ä¸€ä»½å¯éµå¾ªçš„è“å›¾ï¼Œå¹¶å‡å°‘äº†æ­§ä¹‰ã€‚</p>
<p><strong>å…­ä¸ªæ ¸å¿ƒé¢†åŸŸï¼š</strong> GitHub å¯¹ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.blog%2Fai-and-ml%2Fgithub-copilot%2Fhow-to-write-a-great-agents-md-lessons-from-over-2500-repositories%2F" target="_blank" title="https://github.blog/ai-and-ml/github-copilot/how-to-write-a-great-agents-md-lessons-from-over-2500-repositories/" ref="nofollow noopener noreferrer">è¶…è¿‡ 2,500 ä¸ª agent é…ç½®æ–‡ä»¶çš„åˆ†æ</a> æ­ç¤ºäº†ä¸€ä¸ªæ¸…æ™°çš„æ¨¡å¼ï¼šæœ€æœ‰æ•ˆçš„ spec æ¶µç›–å…­ä¸ªé¢†åŸŸã€‚å¯ä»¥æŠŠå®ƒå½“ä½œå®Œæ•´æ€§æ£€æŸ¥æ¸…å•ï¼š</p>
<ol>
<li>
<p><strong>å‘½ä»¤ï¼š</strong> å°†å¯æ‰§è¡Œå‘½ä»¤æ”¾åœ¨å‰é¢â€”â€”ä¸ä»…ä»…æ˜¯å·¥å…·åç§°ï¼Œè€Œæ˜¯å¸¦æœ‰å‚æ•°çš„å®Œæ•´å‘½ä»¤ï¼š<code>npm test</code>ã€<code>pytest -v</code>ã€<code>npm run build</code>ã€‚agent ä¼šä¸æ–­å‚è€ƒè¿™äº›å‘½ä»¤ã€‚</p>
</li>
<li>
<p><strong>æµ‹è¯•ï¼š</strong> å¦‚ä½•è¿è¡Œæµ‹è¯•ã€ä½¿ç”¨ä»€ä¹ˆæ¡†æ¶ã€æµ‹è¯•æ–‡ä»¶ä½äºä½•å¤„ï¼Œä»¥åŠå­˜åœ¨ä»€ä¹ˆè¦†ç›–ç‡æœŸæœ›ã€‚</p>
</li>
<li>
<p><strong>é¡¹ç›®ç»“æ„ï¼š</strong> æºä»£ç ä½äºä½•å¤„ã€æµ‹è¯•æ”¾åœ¨å“ªé‡Œã€æ–‡æ¡£å½’å±ä½•å¤„ã€‚è¦æ˜ç¡®ï¼šâ€œ<code>src/</code> ç”¨äºåº”ç”¨ä»£ç ï¼Œ<code>tests/</code> ç”¨äºå•å…ƒæµ‹è¯•ï¼Œ<code>docs/</code> ç”¨äºæ–‡æ¡£ã€‚â€</p>
</li>
<li>
<p><strong>ä»£ç é£æ ¼ï¼š</strong> ä¸€ä¸ªçœŸå®çš„ä»£ç ç‰‡æ®µå±•ç¤ºä½ çš„é£æ ¼ï¼Œèƒœè¿‡ä¸‰æ®µæè¿°æ€§æ–‡å­—ã€‚åŒ…æ‹¬å‘½åçº¦å®šã€æ ¼å¼è§„åˆ™å’Œè‰¯å¥½è¾“å‡ºçš„ç¤ºä¾‹ã€‚</p>
</li>
<li>
<p><strong>Git å·¥ä½œæµï¼š</strong> åˆ†æ”¯å‘½åã€commit ä¿¡æ¯æ ¼å¼ã€PR è¦æ±‚ã€‚å¦‚æœä½ æ˜ç¡®è¯´æ˜ï¼Œagent ä¼šéµå¾ªè¿™äº›è§„åˆ™ã€‚</p>
</li>
<li>
<p><strong>è¾¹ç•Œæ¡ä»¶ï¼š</strong> agent ç»ä¸åº”æ¥è§¦çš„å†…å®¹â€”â€”å¯†é’¥ã€vendor ç›®å½•ã€ç”Ÿäº§ç¯å¢ƒé…ç½®ã€ç‰¹å®šæ–‡ä»¶å¤¹ã€‚â€œæ°¸è¿œä¸è¦æäº¤å¯†é’¥â€æ˜¯ GitHub ç ”ç©¶ä¸­æœ€å¸¸è§ã€ä¹Ÿæœ€æœ‰ç”¨çš„çº¦æŸä¹‹ä¸€ã€‚</p>
</li>
</ol>
<p><strong>æ˜ç¡®ä½ çš„æŠ€æœ¯æ ˆï¼š</strong> è¯´â€œReact 18 + TypeScriptã€Viteã€Tailwind CSSâ€ï¼Œè€Œä¸æ˜¯â€œReact é¡¹ç›®â€ã€‚åŒæ—¶å†™æ¸…ç‰ˆæœ¬ä¸å…³é”®ä¾èµ–ã€‚æ¨¡ç³Šçš„ spec å¾€å¾€åªä¼šäº§å‡ºæ¨¡ç³Šçš„ä»£ç ã€‚</p>
<p><strong>ä½¿ç”¨ä¸€è‡´çš„æ ¼å¼ï¼š</strong> æ¸…æ™°ä¸ºç‹ã€‚è®¸å¤šå¼€å‘è€…ä¼šåœ¨ spec ä¸­ä½¿ç”¨ Markdown æ ‡é¢˜ï¼Œç”šè‡³ç”¨ç±»ä¼¼ XML çš„æ ‡ç­¾æ¥åˆ’åˆ†ç« èŠ‚ï¼Œå› ä¸º AI æ¨¡å‹æ›´æ“…é•¿å¤„ç†ç»“æ„åŒ–æ–‡æœ¬ï¼Œè€Œä¸æ˜¯è‡ªç”±æ•£æ–‡ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥è¿™æ ·ç»„ç»‡ specï¼š</p>
<pre><code class="hljs language-md" lang="md"><span class="hljs-section"># Project spec: My team's tasks app</span>

<span class="hljs-section">## Objective</span>
<span class="hljs-bullet">-</span> Build a web app for small teams to manage tasks...

<span class="hljs-section">## Tech Stack</span>
<span class="hljs-bullet">-</span> React 18+, TypeScript, Vite, Tailwind CSS
<span class="hljs-bullet">-</span> Node.js/Express backend, PostgreSQL, Prisma ORM

<span class="hljs-section">## Commands</span>
<span class="hljs-bullet">-</span> Build: <span class="hljs-code">`npm run build`</span> (compiles TypeScript, outputs to dist/)
<span class="hljs-bullet">-</span> Test: <span class="hljs-code">`npm test`</span> (runs Jest, must pass before commits)
<span class="hljs-bullet">-</span> Lint: <span class="hljs-code">`npm run lint --fix`</span> (auto-fixes ESLint errors)

<span class="hljs-section">## Project Structure</span>
<span class="hljs-bullet">-</span> <span class="hljs-code">`src/`</span> â€“ Application source code
<span class="hljs-bullet">-</span> <span class="hljs-code">`tests/`</span> â€“ Unit and integration tests
<span class="hljs-bullet">-</span> <span class="hljs-code">`docs/`</span> â€“ Documentation

<span class="hljs-section">## Boundaries</span>
<span class="hljs-bullet">-</span> âœ… Always: Run tests before commits, follow naming conventions
<span class="hljs-bullet">-</span> âš ï¸ Ask first: Database schema changes, adding dependencies
<span class="hljs-bullet">-</span> ğŸš« Never: Commit secrets, edit node<span class="hljs-emphasis">_modules/, modify CI config
</span></code></pre>
<p>è¿™ç§ç»„ç»‡å±‚æ¬¡ä¸ä»…å¸®åŠ©ä½ æŠŠäº‹æƒ…æƒ³æ¸…æ¥šï¼Œä¹Ÿèƒ½å¸®åŠ© AI æ›´å¿«å®šä½ä¿¡æ¯ã€‚Anthropic çš„å·¥ç¨‹å¸ˆå»ºè®®<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anthropic.com%2Fengineering%2Feffective-context-engineering-for-ai-agents" target="_blank" title="https://www.anthropic.com/engineering/effective-context-engineering-for-ai-agents" ref="nofollow noopener noreferrer">å°† prompt ç»„ç»‡æˆä¸åŒçš„éƒ¨åˆ†</a>ï¼ˆå¦‚ <code>&lt;background&gt;</code>ã€<code>&lt;instructions&gt;</code>ã€<code>&lt;tools&gt;</code>ã€<code>&lt;output_format&gt;</code> ç­‰ï¼‰ï¼Œæ­£æ˜¯å‡ºäºè¿™ä¸ªåŸå› â€”â€”å®ƒèƒ½ç»™æ¨¡å‹å¼ºæœ‰åŠ›çš„çº¿ç´¢ï¼ŒåŒºåˆ†ä¸åŒç±»å‹çš„ä¿¡æ¯ã€‚è®°ä½ï¼Œâ€œç®€æ´ä¸ä¸€å®šæ„å‘³ç€ç®€çŸ­â€â€”â€”å¦‚æœç»†èŠ‚å¾ˆé‡è¦ï¼Œä¸è¦å›é¿ï¼›ä½†è¦ä¿æŒä¸“æ³¨ã€‚</p>
<p><strong>å°† spec é›†æˆåˆ°ä½ çš„å·¥å…·é“¾ä¸­ï¼š</strong> å°† spec è§†ä¸ºä¸ç‰ˆæœ¬æ§åˆ¶å’Œ CI/CD ç»‘å®šçš„â€œå¯æ‰§è¡Œäº§å‡ºç‰©â€ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.blog%2Fai-and-ml%2Fgenerative-ai%2Fspec-driven-development-with-ai-get-started-with-a-new-open-source-toolkit%2F" target="_blank" title="https://github.blog/ai-and-ml/generative-ai/spec-driven-development-with-ai-get-started-with-a-new-open-source-toolkit/" ref="nofollow noopener noreferrer">GitHub Spec Kit</a> ä½¿ç”¨å››é˜¶æ®µçš„é—¨æ§å·¥ä½œæµï¼Œè®© spec æˆä¸ºå·¥ç¨‹æµç¨‹çš„ä¸­å¿ƒã€‚ä¸å…¶å†™å®Œ spec å°±æç½®ï¼Œä¸å¦‚è®© spec é©±åŠ¨å®ç°ã€æ£€æŸ¥æ¸…å•å’Œä»»åŠ¡æ‹†è§£ã€‚ä½ çš„ä¸»è¦è§’è‰²æ˜¯æŒèˆµï¼›coding agent è´Ÿè´£å¤§éƒ¨åˆ†äº§å‡ºã€‚æ¯ä¸ªé˜¶æ®µéƒ½æœ‰æ˜ç¡®èŒè´£ï¼Œåœ¨å½“å‰é˜¶æ®µå®Œå…¨éªŒè¯ä¹‹å‰ï¼Œä¸è¿›å…¥ä¸‹ä¸€é˜¶æ®µï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e26591adff7f4e41900f4bd855719220~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5LiN5ZCD6aW85bmy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770798594&amp;x-signature=1n8zRtqSk97KM6%2FGTn80EJUpnVI%3D" alt="image.png" loading="lazy"/></p>
<ol>
<li>
<p><strong>Spec é˜¶æ®µï¼ˆSpecifyï¼‰ï¼š</strong> ä½ æä¾›å…³äºâ€œè¦æ„å»ºä»€ä¹ˆã€ä¸ºä»€ä¹ˆè¦æ„å»ºâ€çš„ high-level æè¿°ï¼Œcoding agent ç”Ÿæˆè¯¦ç»† specã€‚è¿™ä¸æ˜¯åœ¨è®¨è®ºæŠ€æœ¯æ ˆæˆ–åº”ç”¨è®¾è®¡â€”â€”è€Œæ˜¯ç”¨æˆ·æ—…ç¨‹ï¼ˆuser journeysï¼‰ã€ä½“éªŒï¼Œä»¥åŠâ€œæˆåŠŸé•¿ä»€ä¹ˆæ ·â€ã€‚è°ä¼šä½¿ç”¨å®ƒï¼Ÿå®ƒè§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿä»–ä»¬ä¼šå¦‚ä½•ä¸ä¹‹äº¤äº’ï¼Ÿä½ å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯åœ¨å‹¾å‹’æœŸæœ›çš„ç”¨æˆ·ä½“éªŒï¼Œå†ç”± coding agent è¡¥é½ç»†èŠ‚ã€‚å®ƒä¼šéšç€ä½ æŒæ¡æ›´å¤šä¿¡æ¯è€ŒæŒç»­æ¼”è¿›ã€‚</p>
</li>
<li>
<p><strong>è®¡åˆ’é˜¶æ®µï¼ˆPlanï¼‰ï¼š</strong> ç°åœ¨è¿›å…¥æŠ€æœ¯å±‚é¢ã€‚ä½ æä¾›æœŸæœ›çš„æŠ€æœ¯æ ˆã€æ¶æ„ä¸çº¦æŸæ¡ä»¶ï¼Œcoding agent ç”Ÿæˆå…¨é¢çš„æŠ€æœ¯è®¡åˆ’ã€‚å¦‚æœä½ æ‰€åœ¨å›¢é˜Ÿå¯¹æŸäº›æŠ€æœ¯æœ‰æ ‡å‡†åŒ–è¦æ±‚ï¼Œå°±åœ¨è¿™é‡Œè¯´æ¸…æ¥šã€‚å¦‚æœä½ è¦ä¸å·²æœ‰ç³»ç»Ÿé›†æˆï¼Œæˆ–æœ‰åˆè§„è¦æ±‚ï¼Œä¹Ÿéƒ½æ”¾åœ¨è¿™é‡Œã€‚ä½ å¯ä»¥è¦æ±‚å¤šå¥—è®¡åˆ’æ–¹æ¡ˆæ¥å¯¹æ¯”å–èˆï¼›å¦‚æœä½ æä¾›å†…éƒ¨æ–‡æ¡£ï¼Œagent ä¹Ÿå¯ä»¥æŠŠä½ ä»¬çš„æ¶æ„æ¨¡å¼ç›´æ¥æ•´åˆè¿›è®¡åˆ’ã€‚</p>
</li>
<li>
<p><strong>ä»»åŠ¡é˜¶æ®µï¼ˆTasksï¼‰ï¼š</strong> coding agent å°† spec ä¸è®¡åˆ’æ‹†è§£æˆå®é™…å·¥ä½œâ€”â€”å°è€Œå¯å®¡æŸ¥çš„ä»»åŠ¡å—ï¼Œæ¯ä¸ªåªè§£å†³æ‹¼å›¾ä¸­çš„æŸä¸€å—ã€‚æ¯ä¸ªä»»åŠ¡éƒ½åº”å½“å¯ä»¥è¢«ç‹¬ç«‹å®ç°ä¸æµ‹è¯•ï¼Œè¿™å‡ ä¹å°±åƒæ˜¯åœ¨å¯¹ä½ çš„ AI agent åšæµ‹è¯•é©±åŠ¨å¼€å‘ã€‚ä½ ä¸ä¼šæ‹¿åˆ°â€œæ„å»ºèº«ä»½éªŒè¯â€è¿™ç§ç¬¼ç»Ÿä»»åŠ¡ï¼Œè€Œæ˜¯æ›´å…·ä½“çš„æ¡ç›®ï¼Œä¾‹å¦‚â€œåˆ›å»ºä¸€ä¸ªç”¨æˆ·æ³¨å†Œç«¯ç‚¹ï¼ˆendpointï¼‰ï¼Œå¹¶éªŒè¯ç”µå­é‚®ä»¶æ ¼å¼â€ã€‚</p>
</li>
<li>
<p><strong>å®ç°é˜¶æ®µï¼ˆImplementï¼‰ï¼š</strong> coding agent é€ä¸ªï¼ˆæˆ–å¹¶è¡Œï¼‰æ‰§è¡Œä»»åŠ¡ã€‚ä½ ä¸å¿…å®¡æŸ¥â€œä¸Šåƒè¡Œä»£ç å€¾å€’â€ï¼Œè€Œæ˜¯å®¡æŸ¥ä¸ºè§£å†³ç‰¹å®šé—®é¢˜è€Œåšçš„é›†ä¸­æ”¹åŠ¨ã€‚agent æ¸…æ¥šè¦æ„å»ºä»€ä¹ˆï¼ˆspecï¼‰ã€å¦‚ä½•æ„å»ºï¼ˆplanï¼‰ã€è¦åšä»€ä¹ˆï¼ˆtaskï¼‰ã€‚å…³é”®åœ¨äºï¼Œä½ è¦åœ¨æ¯ä¸ªé˜¶æ®µåšéªŒè¯ï¼šspec æ˜¯å¦å‡†ç¡®è¡¨è¾¾äº†ä½ çš„æ„å›¾ï¼Ÿè®¡åˆ’æ˜¯å¦è€ƒè™‘äº†çº¦æŸæ¡ä»¶ï¼ŸAI æ˜¯å¦é—æ¼äº†è¾¹ç•Œæƒ…å†µï¼Ÿè¿™å¥—æµç¨‹å†…ç½®äº†æ£€æŸ¥ç‚¹ï¼Œç¡®ä¿ä½ åœ¨ç»§ç»­æ¨è¿›å‰èƒ½åŠæ—¶è¯„ä¼°ã€å‘ç°åå·®å¹¶çº æ­£ã€‚</p>
</li>
</ol>
<p>è¿™ç§é—¨æ§å·¥ä½œæµèƒ½é˜²æ­¢ Willison æ‰€è¯´çš„â€œçº¸ç‰Œå±‹ä»£ç â€â€”â€”ç»ä¸èµ·å®¡æŸ¥çš„ã€è„†å¼±çš„ AI è¾“å‡ºã€‚Anthropic çš„æŠ€èƒ½ç³»ç»Ÿï¼ˆSkills systemï¼‰ä¹Ÿæä¾›äº†ç±»ä¼¼æ¨¡å¼ï¼Œè®©ä½ å®šä¹‰å¯å¤ç”¨ã€åŸºäº Markdown çš„è¡Œä¸ºä¾› agent è°ƒç”¨ã€‚æŠŠ spec åµŒå…¥è¿™äº›å·¥ä½œæµåï¼Œä½ å¯ä»¥ç¡®ä¿ spec æœªéªŒè¯å‰ï¼Œagent ä¸èƒ½ç»§ç»­å¾€ä¸‹èµ°ï¼›åŒæ—¶ï¼Œspec çš„æ›´æ”¹ä¹Ÿä¼šè‡ªåŠ¨ä¼ é€’åˆ°ä»»åŠ¡æ‹†è§£ä¸æµ‹è¯•ä¸­ã€‚</p>
<p><strong>è€ƒè™‘ç”¨ <code>agents.md</code> å®šä¹‰ä¸“é—¨è§’è‰²ï¼š</strong> å¯¹äºåƒ GitHub Copilot è¿™æ ·çš„å·¥å…·ï¼Œä½ å¯ä»¥åˆ›å»º <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.blog%2Fai-and-ml%2Fgithub-copilot%2Fhow-to-write-a-great-agents-md-lessons-from-over-2500-repositories%2F" target="_blank" title="https://github.blog/ai-and-ml/github-copilot/how-to-write-a-great-agents-md-lessons-from-over-2500-repositories/" ref="nofollow noopener noreferrer"><code>agents.md</code> æ–‡ä»¶</a> æ¥å®šä¹‰ä¸“é—¨çš„ agent è§’è‰²â€”â€”ç”¨äºæŠ€æœ¯å†™ä½œçš„ @docs-agentã€ç”¨äºè´¨é‡ä¿è¯çš„ @test-agentã€ç”¨äºä»£ç å®¡æŸ¥çš„ @security-agentã€‚æ¯ä¸ªæ–‡ä»¶éƒ½å……å½“è¯¥è§’è‰²è¡Œä¸ºã€å‘½ä»¤ä¸è¾¹ç•Œçš„â€œä¸“æ³¨ specâ€ã€‚å½“ä½ å¸Œæœ›æŒ‰ä»»åŠ¡åˆ‡æ¢ä¸åŒ agentï¼Œè€Œä¸æ˜¯åªç”¨ä¸€ä¸ªé€šç”¨åŠ©æ‰‹æ—¶ï¼Œè¿™ä¼šç‰¹åˆ«æœ‰ç”¨ã€‚</p>
<p><strong>ä¸º Agent Experience (AX) è€Œè®¾è®¡ï¼š</strong> æ­£å¦‚æˆ‘ä»¬ä¸ºå¼€å‘è€…ä½“éªŒï¼ˆdeveloper experienceï¼ŒDXï¼‰è®¾è®¡ API ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ä¸ºâ€œAgent Experienceâ€è®¾è®¡ specã€‚è¿™æ„å‘³ç€ä½¿ç”¨æ¸…æ™°ã€å¯è§£æçš„æ ¼å¼ï¼šagent å°†è¦è°ƒç”¨çš„ API çš„ OpenAPI schemaã€é¢å‘ LLM çš„æ–‡æ¡£æ‘˜è¦æ–‡ä»¶ <code>llms.txt</code>ã€ä»¥åŠæ˜ç¡®çš„ç±»å‹å®šä¹‰ç­‰ã€‚æ™ºèƒ½ä½“ AI åŸºé‡‘ä¼šï¼ˆAAIFï¼‰æ­£åœ¨æ ‡å‡†åŒ–åƒ MCPï¼ˆæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰è¿™ç±»å·¥å…·é›†æˆåè®®â€”â€”éµå¾ªè¿™äº›æ¨¡å¼çš„ specï¼Œæ›´å®¹æ˜“è¢« agent ç¨³å®šåœ°ç†è§£ä¸æ‰§è¡Œã€‚</p>
<p><strong>PRD ä¸ SRS æ€ç»´æ–¹å¼ï¼š</strong> å€Ÿé‰´æˆç†Ÿçš„æ–‡æ¡£å®è·µå¾ˆæœ‰å¸®åŠ©ã€‚å¯¹äº AI agent specï¼Œä½ é€šå¸¸ä¼šæŠŠä¸¤è€…èåˆåˆ°åŒä¸€ä»½æ–‡æ¡£ä¸­ï¼ˆå¦‚ä¸Šæ‰€ç¤ºï¼‰ï¼Œä½†åŒæ—¶è¦†ç›–è¿™ä¸¤ä¸ªè§†è§’å¾€å¾€æ›´ç¨³ã€‚æŒ‰ PRD çš„å†™æ³•èƒ½ç¡®ä¿ä½ è¡¥é½ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„ä¸Šä¸‹æ–‡ï¼ˆâ€œæ¯ä¸ªåŠŸèƒ½èƒŒåçš„åŸå› â€ï¼‰ï¼Œé¿å… AI ä¸ºé”™è¯¯çš„ç›®æ ‡åšä¼˜åŒ–ï¼›æŒ‰ SRS çš„å†™æ³•æ‰©å±•ï¼Œåˆ™èƒ½æ˜ç¡® AI ç”Ÿæˆæ­£ç¡®ä»£ç æ‰€éœ€çš„å…³é”®ç»†èŠ‚ï¼ˆä¾‹å¦‚ç”¨ä»€ä¹ˆæ•°æ®åº“ã€è°ƒç”¨ä»€ä¹ˆ APIï¼‰ã€‚å¾ˆå¤šå¼€å‘è€…å‘ç°ï¼Œå¤šåšä¸€ç‚¹å‰æœŸåŠŸå¤«ï¼Œèƒ½æ˜¾è‘—å‡å°‘åç»­ä¸ agent çš„è¯¯è§£æˆæœ¬ã€‚</p>
<p><strong>ä½¿ spec æˆä¸ºâ€œæ´»æ–‡æ¡£â€ï¼š</strong> ä¸è¦å†™å®Œå°±å¿˜ã€‚éšç€ä½ å’Œ agent åšå‡ºå†³ç­–æˆ–å‘ç°æ–°ä¿¡æ¯ï¼ŒåŠæ—¶æ›´æ–° specã€‚å¦‚æœ AI éœ€è¦æ›´æ”¹æ•°æ®æ¨¡å‹ï¼Œæˆ–ä½ å†³å®šç æ‰æŸä¸ªåŠŸèƒ½ï¼Œéœ€è¦åœ¨ spec ä¸­åæ˜ å‡ºæ¥ï¼Œè®©å®ƒå§‹ç»ˆä¿æŒä¸ºâ€œåŸºå‡†äº‹å®â€ï¼ˆground truthï¼‰ã€‚æŠŠå®ƒå½“ä½œå—ç‰ˆæœ¬æ§åˆ¶çš„æ–‡æ¡£ã€‚åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.blog%2Fai-and-ml%2Fgenerative-ai%2Fspec-driven-development-with-ai-get-started-with-a-new-open-source-toolkit%2F" target="_blank" title="https://github.blog/ai-and-ml/generative-ai/spec-driven-development-with-ai-get-started-with-a-new-open-source-toolkit/" ref="nofollow noopener noreferrer">spec é©±åŠ¨çš„å·¥ä½œæµä¸­</a>ï¼Œspec ä¼šé©±åŠ¨å®ç°ã€æµ‹è¯•ä¸ä»»åŠ¡æ‹†è§£ï¼›åœ¨ spec éªŒè¯ä¹‹å‰ï¼Œä½ ä¸ä¼šè¿›å…¥ç¼–ç é˜¶æ®µã€‚è¿™ä¸ªä¹ æƒ¯èƒ½ä¿æŒé¡¹ç›®çš„ä¸€è‡´æ€§ï¼Œå°¤å…¶åœ¨ä½ æˆ– agent æš‚æ—¶ç¦»å¼€ä¹‹åå†å›æ¥æ—¶æ›´æ˜æ˜¾ã€‚è®°ä½ï¼šspec ä¸ä»…æ˜¯å†™ç»™ AI çš„â€”â€”å®ƒä¹Ÿå¸®åŠ©ä½ ä½œä¸ºå¼€å‘è€…ä¿æŒç›‘ç£ï¼Œå¹¶ç¡®ä¿ AI çš„å·¥ä½œæ»¡è¶³çœŸå®éœ€æ±‚ã€‚</p>
<h2 data-id="heading-2">3. å°†ä»»åŠ¡åˆ†è§£ä¸ºæ¨¡å—åŒ– prompt å’Œä¸Šä¸‹æ–‡ï¼Œè€Œéä¸€ä¸ªå¤§ prompt</h2>
<p><strong>åˆ†è€Œæ²»ä¹‹ï¼š</strong> ä¸€æ¬¡ç»™ AI ä¸€ä¸ªä¸“æ³¨çš„ä»»åŠ¡ï¼Œè€Œä¸æ˜¯è¯•å›¾ç”¨ä¸€ä¸ªåŒ…å«æ‰€æœ‰å†…å®¹çš„åºå¤§ prompt æŠŠäº‹æƒ…â€œä¸€æ¬¡è¯´å®Œâ€ã€‚</p>
<p>æœ‰ç»éªŒçš„ AI å·¥ç¨‹å¸ˆéƒ½å‘ç°ï¼ŒæŠŠæ•´ä¸ªé¡¹ç›®ï¼ˆæ‰€æœ‰éœ€æ±‚ã€æ‰€æœ‰ä»£ç ã€æ‰€æœ‰æŒ‡ä»¤ï¼‰å¡è¿›å•ä¸ª prompt æˆ–å•æ¡ agent æ¶ˆæ¯ï¼Œæ˜¯èµ°å‘æ··ä¹±çš„æ ¹æºã€‚ä½ ä¸ä»…å®¹æ˜“è§¦å‘ token ä¸Šé™ï¼Œè¿˜ä¼šå› ä¸ºæ‰€è°“çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmaxpool.dev%2Fresearch-papers%2Fcurse_of_instructions_report.html" target="_blank" title="https://maxpool.dev/research-papers/curse_of_instructions_report.html" ref="nofollow noopener noreferrer">â€œæŒ‡ä»¤è¯…å’’ï¼ˆcurse of instructionsï¼‰â€</a> è€Œè®©æ¨¡å‹å¤±å»ç„¦ç‚¹â€”â€”æŒ‡ä»¤å¤ªå¤šæ—¶ï¼Œå®ƒå¾€å¾€ä»€ä¹ˆéƒ½åšä¸å¥½ã€‚æ›´å¥½çš„åšæ³•æ˜¯ç”¨æ¨¡å—åŒ–çš„æ–¹å¼è®¾è®¡ spec å’Œå·¥ä½œæµï¼šä¸€æ¬¡åªå¤„ç†ä¸€ä¸ªéƒ¨åˆ†ï¼Œåªæä¾›è¿™ä¸ªéƒ¨åˆ†çœŸæ­£éœ€è¦çš„ä¸Šä¸‹æ–‡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d24c31ba41114e858bf1e34a7af13076~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5LiN5ZCD6aW85bmy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770798594&amp;x-signature=RUDVjoLKOwiYWmcJu4yEfhk81zg%3D" alt="image.png" loading="lazy"/></p>
<p><strong>è¿‡å¤šä¸Šä¸‹æ–‡ / æŒ‡ä»¤çš„è¯…å’’ï¼š</strong> ç ”ç©¶éªŒè¯äº†è®¸å¤šå¼€å‘è€…çš„è§‚ç‚¹ï¼šå½“ä½ åœ¨ prompt é‡Œå †æ›´å¤šæŒ‡ä»¤ or æ•°æ®æ—¶ï¼Œæ¨¡å‹å¯¹æ¯ä¸€æ¡æŒ‡ä»¤çš„éµå®ˆåº¦éƒ½ä¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fopenreview.net%2Fpdf%2F848f1332e941771aa491f036f6350af2effe0513.pdf" target="_blank" title="https://openreview.net/pdf/848f1332e941771aa491f036f6350af2effe0513.pdf" ref="nofollow noopener noreferrer">æ˜æ˜¾ä¸‹é™</a>ã€‚ä¸€é¡¹ç ”ç©¶æŠŠè¿™å«ä½œâ€œæŒ‡ä»¤è¯…å’’â€ï¼Œè¡¨æ˜å³ä½¿æ˜¯ GPT-4 å’Œ Claudeï¼Œåœ¨è¢«è¦æ±‚åŒæ—¶æ»¡è¶³å¾ˆå¤šè¦æ±‚æ—¶ä¹Ÿä¼šåƒåŠ›ã€‚å®é™…æ“ä½œä¸­ï¼Œå¦‚æœä½ ç»™å‡º 10 æ¡è¯¦ç»†è§„åˆ™ï¼ŒAI å¾€å¾€åªä¼šè®¤çœŸéµå®ˆå‰å‡ æ¡ï¼Œåé¢çš„å°±å¼€å§‹è¢«å¿½ç•¥ã€‚æ›´å¥½çš„ç­–ç•¥æ˜¯â€œè¿­ä»£èšç„¦â€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmaxpool.dev%2Fresearch-papers%2Fcurse_of_instructions_report.html" target="_blank" title="https://maxpool.dev/research-papers/curse_of_instructions_report.html" ref="nofollow noopener noreferrer">è¡Œä¸šæŒ‡å—</a> å»ºè®®æŠŠå¤æ‚éœ€æ±‚æ‹†æˆé¡ºåºæ‰§è¡Œçš„ç®€å•æŒ‡ä»¤ä½œä¸ºæœ€ä½³å®è·µã€‚è®© AI ä¸€æ¬¡åªä¸“æ³¨äºä¸€ä¸ªå­é—®é¢˜ï¼Œå®Œæˆä¹‹åå†ç»§ç»­ä¸‹ä¸€æ­¥ï¼Œè¿™æ ·æ—¢èƒ½ä¿æŒè´¨é‡ï¼Œåˆè®©é”™è¯¯æ›´å¯æ§ã€‚</p>
<p><strong>å°† spec åˆ†ä¸ºé˜¶æ®µæˆ–ç»„ä»¶ï¼š</strong> å¦‚æœä½ çš„ spec æ–‡æ¡£éå¸¸é•¿ï¼Œæˆ–è€…è¦†ç›–äº†å¾ˆå¤šé¢†åŸŸï¼Œå¯ä»¥è€ƒè™‘æŠŠå®ƒæ‹†æˆè‹¥å¹²éƒ¨åˆ†ï¼ˆç‰©ç†ä¸Šåˆ†æˆå¤šä¸ªæ–‡ä»¶ï¼Œæˆ–åœ¨åŒä¸€æ–‡æ¡£ä¸­æ¸…æ™°åˆ†èŠ‚ï¼‰ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æœ‰â€œåç«¯ API specâ€éƒ¨åˆ†ï¼Œå’Œâ€œå‰ç«¯ UI specâ€éƒ¨åˆ†ã€‚AI åœ¨å¤„ç†åç«¯æ—¶ï¼Œå¹¶ä¸éœ€è¦å‰ç«¯ specï¼Œåä¹‹äº¦ç„¶ã€‚å¾ˆå¤šé‡‡ç”¨å¤š agent æ¶æ„çš„å›¢é˜Ÿï¼Œç”šè‡³ä¼šä¸ºæ¯ä¸€éƒ¨åˆ†åˆ›å»ºç‹¬ç«‹çš„ agent æˆ–å­æµç¨‹â€”â€”ä¾‹å¦‚ï¼Œä¸€ä¸ª agent è´Ÿè´£æ•°æ®åº“ / æ¨¡å‹ï¼Œå¦ä¸€ä¸ªè´Ÿè´£ API é€»è¾‘ï¼Œå†ä¸€ä¸ªè´Ÿè´£å‰ç«¯â€”â€”æ¯ä¸ªåªæ‹¿åˆ°ä¸è‡ªå·±ç›¸å…³çš„ specã€‚å³ä¾¿ä½ ä½¿ç”¨å•ä¸ª agentï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä»…å°†ç›¸å…³ spec éƒ¨åˆ†å¤åˆ¶åˆ°è¯¥ä»»åŠ¡çš„ prompt ä¸­æ¥æ¨¡æ‹Ÿè¿™ä¸€ç‚¹ã€‚è¦é¿å…ä¸Šä¸‹æ–‡è¿‡è½½ï¼šæ­£å¦‚ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.digitalocean.com%2Fproducts%2Fgradient-ai-platform%2Fconcepts%2Fcontext-management%2F" target="_blank" title="https://docs.digitalocean.com/products/gradient-ai-platform/concepts/context-management/" ref="nofollow noopener noreferrer">DigitalOcean AI æŒ‡å—</a> æ‰€æé†’çš„ï¼Œä¸è¦åœ¨ä¸€ä¸ª prompt é‡Œåˆåšèº«ä»½éªŒè¯ï¼Œåˆæ”¹æ•°æ®åº“ schemaã€‚è®©æ¯ä¸ª prompt éƒ½ç´§ç´§å›´ç»•ä¸€ä¸ªå½“å‰ç›®æ ‡ã€‚</p>
<p><strong>å¤§å‹ spec çš„æ‰©å±•ç›®å½• / æ‘˜è¦ï¼š</strong> ä¸€ä¸ªå¾ˆå®ç”¨çš„å°æŠ€å·§ï¼Œæ˜¯è®© agent ä¸º spec æ„å»ºä¸€ä¸ªâ€œå¸¦æ‘˜è¦çš„æ‰©å±•ç›®å½•â€ã€‚æœ¬è´¨ä¸Šï¼Œå®ƒå°±æ˜¯ä¸€ä»½â€œspec æ‘˜è¦â€ï¼ŒæŠŠæ¯ä¸ªéƒ¨åˆ†å‹ç¼©æˆå‡ ä¸ªå…³é”®ç‚¹æˆ–å…³é”®è¯ï¼Œå¹¶æ ‡å‡ºå¯ä»¥æŸ¥çœ‹è¯¦ç»†å†…å®¹çš„ä½ç½®ã€‚æ¯”å¦‚ï¼Œå¦‚æœå®Œæ•´ spec é‡Œæœ‰ä¸€èŠ‚â€œå®‰å…¨è¦æ±‚â€é•¿è¾¾ 500 å­—ï¼Œä½ å¯ä»¥è®© agent æŠŠå®ƒæ€»ç»“æˆï¼šâ€œå®‰å…¨ï¼šä½¿ç”¨ HTTPSï¼Œä¿æŠ¤ API å¯†é’¥ï¼Œå®æ–½è¾“å…¥éªŒè¯ï¼ˆè§å®Œæ•´ spec Â§4.2ï¼‰â€ã€‚åœ¨è§„åˆ’é˜¶æ®µå…ˆåšå‡ºè¿™æ ·çš„åˆ†å±‚æ‘˜è¦ï¼Œä½ å°±èƒ½å¾—åˆ°ä¸€ä¸ªå¯ä»¥å¸¸é©»åœ¨ prompt é‡Œçš„â€œé¸Ÿç°å›¾â€ï¼Œè€Œç»†èŠ‚åˆ™åœ¨ä¸éœ€è¦æ—¶ä¿æŒå¸è½½çŠ¶æ€ã€‚è¿™ä¸ªæ‰©å±•ç›®å½•å°±åƒç´¢å¼•ï¼šagent å¯ä»¥å…ˆçœ‹å®ƒï¼Œç„¶åè¯´â€œå•Šå“ˆï¼Œè¿™é‡Œæœ‰ä¸€èŠ‚å®‰å…¨ç›¸å…³å†…å®¹éœ€è¦çœ‹çœ‹â€ï¼Œæ¥ç€ä½ å†æŒ‰éœ€æä¾›é‚£ä¸€å°èŠ‚çš„å…¨æ–‡ã€‚è¿™å¾ˆåƒäººç±»å¼€å‘è€…çœ‹ç›®å½•ã€å†ç¿»åˆ° spec æ–‡æ¡£å¯¹åº”é¡µé¢çš„è¿‡ç¨‹ã€‚</p>
<p>è¦å®ç°è¿™ä¸€ç‚¹ï¼Œä½ å¯ä»¥åœ¨å†™å®Œ spec åè¿™æ ·æç¤º agentï¼šâ€œå°†ä¸Šè¿° spec æ€»ç»“ä¸ºä¸€ä¸ªéå¸¸ç®€æ´çš„å¤§çº²ï¼ŒåŒ…å«æ¯ä¸ªéƒ¨åˆ†çš„å…³é”®ç‚¹å’Œå‚è€ƒæ ‡ç­¾ã€‚â€è¾“å‡ºç»“æœå¾ˆå¯èƒ½æ˜¯ä¸€ä»½åˆ†èŠ‚åˆ—è¡¨ï¼Œæ¯èŠ‚åªç”¨ä¸€ä¸¤å¥è¯æ¦‚æ‹¬ã€‚è¿™ä¸ªæ‘˜è¦å¯ä»¥æ”¾åœ¨ system / assistant æ¶ˆæ¯é‡Œï¼Œæ—¢èƒ½æŒ‡å¯¼ agent æŠŠæ³¨æ„åŠ›æ”¾åœ¨æ­£ç¡®çš„åœ°æ–¹ï¼Œåˆä¸ä¼šåƒæ‰å¤ªå¤š tokenã€‚å·²çŸ¥è¿™ç§<a href="https://link.juejin.cn?target=https%3A%2F%2Faddyo.substack.com%2Fp%2Fcontext-engineering-bringing-engineering" target="_blank" title="https://addyo.substack.com/p/context-engineering-bringing-engineering" ref="nofollow noopener noreferrer">åˆ†å±‚æ€»ç»“çš„æ–¹å¼</a>Â ï¼Œå¯ä»¥é€šè¿‡å¼ºåŒ–å¯¹é«˜å±‚ç»“æ„çš„å…³æ³¨ï¼Œå¸®åŠ© LLM ç»´æŒé•¿æœŸä¸Šä¸‹æ–‡â€”â€”ç›¸å½“äºè®© agent åœ¨è„‘æµ·é‡Œæºå¸¦ä¸€ä»½ spec çš„â€œå¿ƒæ™ºåœ°å›¾â€ã€‚</p>
<p><strong>åˆ©ç”¨å­ agent æˆ–â€œæŠ€èƒ½â€å¤„ç†ä¸åŒ spec éƒ¨åˆ†ï¼š</strong> å¦ä¸€ç§æ›´é«˜çº§çš„æ–¹å¼ï¼Œæ˜¯ä½¿ç”¨å¤šä¸ªä¸“é—¨çš„ agentï¼ˆAnthropic ç§°ä¹‹ä¸º subagentï¼Œä½ ä¹Ÿå¯ä»¥ç†è§£æˆâ€œæŠ€èƒ½â€ï¼‰ã€‚æ¯ä¸ªå­ agent éƒ½é…ç½®ä¸ºæŸä¸ªç‰¹å®šé¢†åŸŸï¼Œå¹¶åªæ‹¿åˆ°ä¸è¯¥é¢†åŸŸç›¸å…³çš„é‚£éƒ¨åˆ† specã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æœ‰ä¸€ä¸ªâ€œæ•°æ®åº“è®¾è®¡å¸ˆâ€å­ agentï¼Œå®ƒåªäº†è§£æ•°æ®æ¨¡å‹é‚£ä¸€èŠ‚ï¼›å†æœ‰ä¸€ä¸ªâ€œAPI å¼€å‘è€…â€å­ agentï¼Œåªçœ‹ API æ¥å£ specã€‚ä¸» agentï¼ˆæˆ–ä¸€ä¸ªç¼–æ’å™¨ï¼‰å¯ä»¥è‡ªåŠ¨æŠŠä»»åŠ¡è·¯ç”±ç»™åˆé€‚çš„å­ agentã€‚å¥½å¤„æ˜¯ï¼šæ¯ä¸ª agent è¦å¤„ç†çš„ä¸Šä¸‹æ–‡çª—å£æ›´å°ï¼Œè§’è‰²æ›´èšç„¦ï¼Œè¿™å¾€å¾€èƒ½<a href="https://link.juejin.cn?target=https%3A%2F%2F10xdevelopers.dev%2Fstructured%2Fclaude-code-with-subagents%2F" target="_blank" title="https://10xdevelopers.dev/structured/claude-code-with-subagents/" ref="nofollow noopener noreferrer">æé«˜å‡†ç¡®æ€§ï¼Œå¹¶å…è®¸åœ¨ç›¸äº’ç‹¬ç«‹çš„ä»»åŠ¡ä¸Šå¹¶è¡Œå·¥ä½œ</a>ã€‚Anthropic çš„ Claude Code æ”¯æŒä½ å®šä¹‰å¸¦æœ‰è‡ªå·± system prompt å’Œå·¥å…·é›†çš„å­ agentã€‚æ­£å¦‚ä»–ä»¬çš„æ–‡æ¡£ä¸­æ‰€è¯´ï¼šâ€œæ¯ä¸ªå­ agent éƒ½æœ‰ç‰¹å®šçš„ç›®çš„å’Œä¸“ä¸šé¢†åŸŸï¼Œä½¿ç”¨ç‹¬ç«‹äºä¸»å¯¹è¯çš„ä¸Šä¸‹æ–‡çª—å£ï¼Œå¹¶æœ‰è‡ªå®šä¹‰çš„ system prompt æŒ‡å¯¼å…¶è¡Œä¸ºã€‚â€ å½“å‡ºç°ä¸€ä¸ªä»»åŠ¡æ°å¥½å±äºæŸä¸ªå­ agent çš„é¢†åŸŸæ—¶ï¼ŒClaude å¯ä»¥æŠŠä»»åŠ¡å§”æ‰˜ç»™å®ƒï¼Œç”±å­ agent ç‹¬ç«‹è¿”å›ç»“æœã€‚</p>
<p><strong>å¹¶è¡Œ agent æé«˜ååé‡ï¼š</strong> åŒæ—¶è¿è¡Œå¤šä¸ª agentï¼Œæ­£åœ¨æˆä¸ºæå‡å¼€å‘è€…ç”Ÿäº§åŠ›çš„â€œä¸‹ä¸€ä¸ªå¤§è¶‹åŠ¿â€ã€‚ä¸å…¶ç­‰ä¸€ä¸ª agent å¹²å®Œå†å¼€ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œä½ å¯ä»¥ä¸ºäº’ä¸é‡å çš„å·¥ä½œåŒæ—¶å¯åŠ¨å¤šä¸ª agentã€‚Willison æŠŠè¿™ç§°ä½œâ€œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fsimonwillison.net%2F2025%2FOct%2F7%2Fvibe-engineering%2F" target="_blank" title="https://simonwillison.net/2025/Oct/7/vibe-engineering/" ref="nofollow noopener noreferrer">æ‹¥æŠ±å¹¶è¡Œç¼–ç  agent</a>â€ï¼Œå¹¶æŒ‡å‡ºè¿™â€œå‡ºå¥‡åœ°é«˜æ•ˆï¼Œè™½ç„¶ç²¾ç¥è´Ÿæ‹…ä¸å°â€ã€‚å…³é”®åœ¨äºåˆç†åˆ’åˆ†ä»»åŠ¡è¾¹ç•Œï¼Œé¿å… agent ç›¸äº’å¹²æ‰°â€”â€”æ¯”å¦‚ï¼Œä¸€ä¸ª agent å†™åŠŸèƒ½ä»£ç ï¼Œå¦ä¸€ä¸ªå†™æµ‹è¯•ï¼Œæˆ–è€…ä¸åŒç»„ä»¶å¹¶è¡Œå¼€å‘ã€‚åƒ LangGraphã€OpenAI Swarm è¿™æ ·çš„ç¼–æ’æ¡†æ¶å¯ä»¥å¸®åŠ©åè°ƒè¿™äº› agentï¼Œè€Œé€šè¿‡å‘é‡æ•°æ®åº“ï¼ˆå¦‚ Chromaï¼‰è¿™æ ·çš„å…±äº«å†…å­˜ï¼Œå®ƒä»¬å¯ä»¥è®¿é—®å…¬å…±ä¸Šä¸‹æ–‡ï¼Œè€Œä¸éœ€è¦å†—ä½™ promptã€‚</p>
<p><strong>å• agent ä¸å¤š agentï¼šå„è‡ªé€‚ç”¨åœ¨ä»€ä¹ˆæ—¶å€™ï¼Ÿ</strong></p>






























<table><thead><tr><th>ç»´åº¦</th><th>å• agent</th><th>å¹¶è¡Œ / å¤š agent</th></tr></thead><tbody><tr><td><strong>ä¼˜åŠ¿</strong></td><td>è®¾ç½®æ›´ç®€å•ï¼›å¼€é”€æ›´å°ï¼›æ›´æ˜“è°ƒè¯•å’Œè¿½è¸ª</td><td>ååé‡æ›´é«˜ï¼›èƒ½å¤„ç†å¤æ‚ä¾èµ–å…³ç³»ï¼›å¯ä¸ºä¸åŒé¢†åŸŸé…ç½®ä¸“é—¨çš„ agent</td></tr><tr><td><strong>æŒ‘æˆ˜</strong></td><td>å¤§é¡¹ç›®å®¹æ˜“ä¸Šä¸‹æ–‡è¿‡è½½ï¼›è¿­ä»£è¾ƒæ…¢ï¼›å­˜åœ¨å•ç‚¹æ•…éšœ</td><td>åè°ƒå¼€é”€å¤§ï¼›å¯èƒ½å‡ºç°å†²çªï¼›éœ€è¦å…±äº«å†…å­˜ï¼ˆä¾‹å¦‚å‘é‡æ•°æ®åº“ï¼‰</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>ç›¸å¯¹ç‹¬ç«‹çš„æ¨¡å—ï¼›ä¸­å°å‹é¡¹ç›®ï¼›æ—©æœŸåŸå‹é˜¶æ®µ</td><td>å¤§å‹ä»£ç åº“ï¼›ä¸€äººå†™ä»£ç  + ä¸€äººå†™æµ‹è¯• + ä¸€äººåšè¯„å®¡ï¼›å½¼æ­¤ç‹¬ç«‹çš„åŠŸèƒ½æ¨¡å—</td></tr><tr><td><strong>Tips</strong></td><td>ä½¿ç”¨ spec æ‘˜è¦ï¼›æŒ‰ä»»åŠ¡åˆ·æ–°ä¸Šä¸‹æ–‡ï¼›åœ¨åˆ‡æ¢å¤§åŠŸèƒ½æ—¶é‡å¼€ä¼šè¯</td><td>åˆæœŸå…ˆä» 2â€“3 ä¸ª agent å¼€å§‹ï¼›ç”¨ MCP å…±äº«å·¥å…·ï¼›æå‰å®šä¹‰æ¸…æ™°çš„èŒè´£è¾¹ç•Œ</td></tr></tbody></table>
<p>åœ¨å®è·µä¸­ï¼Œä½¿ç”¨å­ agent æˆ–æŠ€èƒ½ç‰¹å®šçš„æç¤ºå¯èƒ½æ˜¯è¿™æ ·çš„ï¼šä½ ç»´æŠ¤å¤šä¸ª spec æ–‡ä»¶ï¼ˆæˆ– prompt æ¨¡æ¿ï¼‰â€”â€”ä¾‹å¦‚ <code>SPEC_backend.md</code>ã€<code>SPEC_frontend.md</code> â€”â€” ç„¶åå‘Šè¯‰ AIï¼šâ€œå¤„ç†åç«¯ä»»åŠ¡æ—¶ï¼Œå‚è€ƒ <code>SPEC_backend</code>ï¼›å¤„ç†å‰ç«¯ä»»åŠ¡æ—¶ï¼Œå‚è€ƒ <code>SPEC_frontend</code>ã€‚â€ æˆ–è€…åœ¨ Cursor/Claude è¿™æ ·çš„å·¥å…·ä¸­ï¼Œä½ å®é™…ä¸Šä¼šä¸ºæ¯ä¸ªéƒ¨åˆ†å¯åŠ¨ä¸€ä¸ªå­ agentã€‚è¿™å½“ç„¶æ¯”å• agent å¾ªç¯æ›´å¤æ‚ï¼Œä½†å®ƒæ¨¡æ‹Ÿäº†äººç±»å¼€å‘è€…çš„åšæ³• â€”â€” æˆ‘ä»¬åœ¨å¿ƒé‡Œä¼šæŠŠå¤§å‹ spec æ‹†åˆ†æˆç›¸å…³çš„å—ï¼ˆä½ ä¸ä¼šä¸€æ¬¡æ€§æŠŠæ•´ä»½ 50 é¡µçš„ spec éƒ½è®°åœ¨è„‘å­é‡Œï¼›ä½ ä¼šå›å¿†å½“å‰ä»»åŠ¡éœ€è¦çš„éƒ¨åˆ†ï¼Œå¹¶å¯¹æ•´ä½“æ¶æ„æœ‰ä¸€ä¸ªå¤§è‡´äº†è§£ï¼‰ã€‚å¦‚å‰æ‰€è¿°ï¼ŒæŒ‘æˆ˜åœ¨äºç®¡ç†ç›¸äº’ä¾èµ–å…³ç³»ï¼šå­ agent ä»ç„¶éœ€è¦åè°ƒï¼ˆå‰ç«¯éœ€è¦çŸ¥é“åç«¯ spec ä¸­çš„ API çº¦å®šç­‰ï¼‰ã€‚ä¸€ä¸ªä¸­å¿ƒæ¦‚è§ˆï¼ˆæˆ–ä¸€ä¸ª â€œæ¶æ„å¸ˆâ€ agentï¼‰å¯ä»¥é€šè¿‡å¼•ç”¨å­ spec å¹¶ç¡®ä¿ä¸€è‡´æ€§æ¥æä¾›å¸®åŠ©ã€‚</p>
<p><strong>è®©æ¯ä¸ª prompt ä¸“æ³¨äºä¸€ä¸ªä»»åŠ¡/éƒ¨åˆ†ï¼š</strong> å³ä½¿æ²¡æœ‰èŠ±å“¨çš„å¤š agent è®¾ç½®ï¼Œä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨å¼ºåˆ¶æ¨¡å—åŒ–ã€‚ä¾‹å¦‚ï¼Œspec å†™å®Œåï¼Œä½ çš„ä¸‹ä¸€æ­¥å¯èƒ½æ˜¯ï¼šâ€œæ­¥éª¤ 1ï¼šå®ç°æ•°æ®åº“ schemaã€‚â€ä½ åªç»™ agent æä¾› spec çš„æ•°æ®åº“éƒ¨åˆ†ï¼ŒåŠ ä¸Š spec ä¸­çš„ä»»ä½•å…¨å±€çº¦æŸï¼ˆå¦‚æŠ€æœ¯æ ˆï¼‰ã€‚agent å¤„ç†è¿™ä¸ªã€‚ç„¶åå¯¹äºæ­¥éª¤ 2ï¼Œâ€œç°åœ¨å®ç°èº«ä»½éªŒè¯åŠŸèƒ½â€ï¼Œä½ æä¾› spec çš„ Auth éƒ¨åˆ†ï¼Œå¦‚æœéœ€è¦çš„è¯ï¼Œå¯èƒ½è¿˜æä¾› schema çš„ç›¸å…³éƒ¨åˆ†ã€‚é€šè¿‡ä¸ºæ¯ä¸ªä¸»è¦ä»»åŠ¡åˆ·æ–°ä¸Šä¸‹æ–‡ï¼Œä½ ç¡®ä¿æ¨¡å‹ä¸ä¼šæºå¸¦å¤§é‡å¯èƒ½åˆ†æ•£æ³¨æ„åŠ›çš„è¿‡æ—¶æˆ–æ— å…³ä¿¡æ¯ã€‚æ­£å¦‚ä¸€ä»½æŒ‡å—æ‰€å»ºè®®çš„ï¼šâ€œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.digitalocean.com%2Fproducts%2Fgradient-ai-platform%2Fconcepts%2Fcontext-management%2F" target="_blank" title="https://docs.digitalocean.com/products/gradient-ai-platform/concepts/context-management/" ref="nofollow noopener noreferrer">é‡æ–°å¼€å§‹ï¼šåœ¨åˆ‡æ¢ä¸»è¦åŠŸèƒ½æ—¶å¼€å§‹æ–°ä¼šè¯ä»¥æ¸…é™¤ä¸Šä¸‹æ–‡</a>â€ã€‚ä½ å¯ä»¥åœ¨æ¯æ¬¡éƒ½æé†’ agent å…³é”®çš„å…¨å±€è§„åˆ™ï¼ˆæ¥è‡ª spec çš„çº¦æŸéƒ¨åˆ†ï¼‰ï¼Œä½†å¦‚æœä¸éœ€è¦ï¼Œå°±ä¸è¦æŠŠæ•´ä¸ª spec éƒ½å¡è¿›å»ã€‚</p>
<p><strong>ä½¿ç”¨å†…è”æŒ‡ä»¤å’Œä»£ç  TODOï¼š</strong> å¦ä¸€ä¸ªæ¨¡å—åŒ–æŠ€å·§æ˜¯å°†ä½ çš„ä»£ç æˆ– spec ä½œä¸ºå¯¹è¯çš„æ´»è·ƒéƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œç”¨ <code>// TODO</code> æ³¨é‡Šæ­å»ºä»£ç æ¡†æ¶ï¼Œæè¿°éœ€è¦å®Œæˆçš„å†…å®¹ï¼Œç„¶åè®© agent é€ä¸€å¡«å……ã€‚æ¯ä¸ª TODO æœ¬è´¨ä¸Šéƒ½æ˜¯ä¸€ä¸ªå°ä»»åŠ¡çš„è¿·ä½  specã€‚è¿™è®© AI ä¿æŒæ¿€å…‰èˆ¬çš„ä¸“æ³¨ï¼ˆâ€œæ ¹æ®è¿™ä¸ª spec ç‰‡æ®µå®ç°è¿™ä¸ªç‰¹å®šå‡½æ•°â€ï¼‰ï¼Œä½ å¯ä»¥åœ¨ç´§å¯†å¾ªç¯ä¸­è¿­ä»£ã€‚è¿™ç±»ä¼¼äºç»™ AI ä¸€ä¸ªå¾…åŠæ¸…å•é¡¹æ¥å®Œæˆï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§ç»™å‡ºæ•´ä¸ªæ¸…å•ã€‚</p>
<p>æ€»ç»“ï¼šå°è€Œèšç„¦çš„ä¸Šä¸‹æ–‡èƒœè¿‡ä¸€ä¸ªå¤§ promptã€‚è¿™æé«˜äº†è´¨é‡ï¼Œå¹¶é˜²æ­¢ AI å› ä¸€æ¬¡æ€§æ¥æ”¶å¤ªå¤šä¿¡æ¯è€Œâ€œä¸å ªé‡è´Ÿâ€ã€‚æ­£å¦‚ä¸€å¥—æœ€ä½³å®è·µæ‰€æ€»ç»“çš„ï¼Œå‘æ¨¡å‹æä¾› â€œå•ä¸€ä»»åŠ¡èšç„¦â€ å’Œ â€œä»…æä¾›ç›¸å…³ä¿¡æ¯â€ï¼Œé¿å…åˆ°å¤„å€¾å€’æ‰€æœ‰å†…å®¹ã€‚é€šè¿‡å°†å·¥ä½œæ„å»ºæˆæ¨¡å—â€”â€”å¹¶ä½¿ç”¨ spec æ‘˜è¦æˆ–å­ spec agent ç­‰ç­–ç•¥â€”â€”ä½ å°†ç»•è¿‡ä¸Šä¸‹æ–‡å¤§å°é™åˆ¶å’Œ AI çš„çŸ­æœŸè®°å¿†ä¸Šé™ã€‚è®°ä½ï¼Œä¸€ä¸ªâ€œå–‚å¾—å¥½â€çš„ AI å°±åƒä¸€ä¸ªâ€œå–‚å¾—å¥½â€çš„å‡½æ•°ï¼šåªç»™å®ƒ <a href="https://link.juejin.cn?target=https%3A%2F%2Faddyo.substack.com%2Fp%2Fcontext-engineering-bringing-engineering" target="_blank" title="https://addyo.substack.com/p/context-engineering-bringing-engineering" ref="nofollow noopener noreferrer">æ‰‹å¤´å·¥ä½œæ‰€éœ€çš„è¾“å…¥</a>ã€‚</p>
<h2 data-id="heading-3">4. å†…ç½®è‡ªæ£€ã€çº¦æŸå’Œäººç±»ä¸“ä¸šçŸ¥è¯†</h2>
<p><strong>è®©ä½ çš„ spec ä¸ä»…æ˜¯ agent çš„å¾…åŠæ¸…å•ï¼Œä¹Ÿæ˜¯è´¨é‡æ§åˆ¶çš„æŒ‡å—ï¼Œä¸è¦å®³æ€•æ³¨å…¥ä½ è‡ªå·±çš„ä¸“ä¸šçŸ¥è¯†ã€‚</strong></p>
<p>ä¸€ä»½å¥½çš„ AI agent spec ä¼šé¢„åˆ¤ AI å¯èƒ½å‡ºé”™çš„åœ°æ–¹ï¼Œå¹¶è®¾ç½®é˜²æŠ¤æ ã€‚å®ƒè¿˜ä¼šåˆ©ç”¨ä½ æ‰€çŸ¥é“çš„çŸ¥è¯†ï¼ˆé¢†åŸŸçŸ¥è¯†ã€è¾¹ç•Œæƒ…å†µã€â€œé™·é˜±â€ï¼‰è®© AI ä¸ä¼šåœ¨çœŸç©ºä¸­æ“ä½œã€‚æŠŠ spec æƒ³è±¡æˆ AI çš„æ•™ç»ƒå’Œè£åˆ¤ï¼šå®ƒåº”è¯¥é¼“åŠ±æ­£ç¡®çš„æ–¹æ³•ï¼Œå¹¶æŒ‡å‡ºçŠ¯è§„ã€‚</p>
<p><strong>ä½¿ç”¨ä¸‰å±‚è¾¹ç•Œï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.blog%2Fai-and-ml%2Fgithub-copilot%2Fhow-to-write-a-great-agents-md-lessons-from-over-2500-repositories%2F" target="_blank" title="https://github.blog/ai-and-ml/github-copilot/how-to-write-a-great-agents-md-lessons-from-over-2500-repositories/" ref="nofollow noopener noreferrer">GitHub å¯¹ 2,500+ ä¸ª agent æ–‡ä»¶çš„åˆ†æ</a> å‘ç°ï¼Œæœ€æœ‰æ•ˆçš„ spec ä½¿ç”¨ä¸‰å±‚è¾¹ç•Œç³»ç»Ÿï¼Œè€Œä¸æ˜¯ç®€å•çš„ç¦æ­¢äº‹é¡¹åˆ—è¡¨ã€‚è¿™ä¸º agent æä¾›äº†æ›´æ¸…æ™°çš„æŒ‡å¯¼æ¥è¯´æ˜ä½•æ—¶ç»§ç»­ã€ä½•æ—¶æš‚åœã€ä½•æ—¶åœæ­¢ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90e8372bc6734a43802d98d4a510a0ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5LiN5ZCD6aW85bmy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770798594&amp;x-signature=BqB7nUXz9VMNMy6LR2DnRrnPH9c%3D" alt="image.png" loading="lazy"/></p>
<p>âœ… <strong>æ€»æ˜¯è¦åšï¼š</strong> agent åº”è¯¥æ— éœ€è¯¢é—®å°±æ‰§è¡Œçš„æ“ä½œã€‚â€œæäº¤å‰æ€»æ˜¯è¿è¡Œæµ‹è¯•ã€‚â€â€œæ€»æ˜¯éµå¾ªé£æ ¼æŒ‡å—ä¸­çš„å‘½åçº¦å®šã€‚â€â€œæ€»æ˜¯å°†é”™è¯¯è®°å½•åˆ°ç›‘æ§æœåŠ¡ã€‚â€</p>
<p>âš ï¸ <strong>å…ˆè¯¢é—®ï¼š</strong> éœ€è¦äººå·¥æ‰¹å‡†çš„æ“ä½œã€‚â€œä¿®æ”¹æ•°æ®åº“ schema å‰å…ˆè¯¢é—®ã€‚â€â€œæ·»åŠ æ–°ä¾èµ–å‰å…ˆè¯¢é—®ã€‚â€â€œæ›´æ”¹ CI/CD é…ç½®å‰å…ˆè¯¢é—®ã€‚â€è¿™ä¸€å±‚æ•è·é‚£äº›å¯èƒ½æ²¡é—®é¢˜ä½†éœ€è¦äººå·¥æ£€æŸ¥çš„é«˜å½±å“å˜æ›´ã€‚</p>
<p>ğŸš« <strong>æ°¸è¿œä¸è¦åšï¼š</strong> ç¡¬æ€§åœæ­¢ã€‚â€œæ°¸è¿œä¸è¦æäº¤å¯†ç æˆ– API å¯†é’¥ã€‚â€â€œæ°¸è¿œä¸è¦ç¼–è¾‘ <code>node_modules/</code> æˆ– <code>vendor/</code>ã€‚â€â€œæ°¸è¿œä¸è¦åœ¨æœªç»æ˜ç¡®æ‰¹å‡†çš„æƒ…å†µä¸‹åˆ é™¤å¤±è´¥çš„æµ‹è¯•ã€‚â€â€œæ°¸è¿œä¸è¦æäº¤å¯†é’¥â€æ˜¯ç ”ç©¶ä¸­æœ€å¸¸è§ã€ä¹Ÿæœ€æœ‰ç”¨çš„çº¦æŸã€‚</p>
<p>è¿™ç§ä¸‰å±‚æ–¹æ³•æ¯”æ‰å¹³åŒ–çš„è§„åˆ™åˆ—è¡¨æ›´åŠ ç»†è‡´ã€‚å®ƒé˜æ˜æœ‰äº›æ“ä½œæ€»æ˜¯å®‰å…¨çš„ï¼Œæœ‰äº›éœ€è¦ç›‘ç£ï¼Œæœ‰äº›åˆ™å®Œå…¨ç¦æ­¢ã€‚agent å¯ä»¥è‡ªä¿¡åœ°æ‰§è¡Œâ€œæ€»æ˜¯è¦åšâ€çš„é¡¹ç›®ï¼Œæ ‡è®°â€œå…ˆè¯¢é—®â€çš„é¡¹ç›®ä»¥ä¾›å®¡æŸ¥ï¼Œå¹¶åœ¨â€œæ°¸è¿œä¸è¦åšâ€çš„é¡¹ç›®ä¸Šç¡¬æ€§åœæ­¢ã€‚</p>
<p><strong>é¼“åŠ±è‡ªæ£€ï¼š</strong> ä¸€ä¸ªå¼ºå¤§çš„æ¨¡å¼æ˜¯è®© agent è‡ªåŠ¨å¯¹ç…§ spec éªŒè¯å…¶å·¥ä½œã€‚å¦‚æœä½ çš„å·¥å…·å…è®¸ï¼Œå¯ä»¥é›†æˆå•å…ƒæµ‹è¯•æˆ– lint æ£€æŸ¥ï¼Œè®© AI åœ¨ç”Ÿæˆä»£ç åè¿è¡Œã€‚ä½†å³ä½¿åœ¨ spec/prompt å±‚é¢ï¼Œä½ ä¹Ÿå¯ä»¥æŒ‡ç¤º AI è¿›è¡ŒäºŒæ¬¡æ£€æŸ¥ï¼šä¾‹å¦‚â€œå®ç°åï¼Œå°†ç»“æœä¸ spec è¿›è¡Œæ¯”è¾ƒï¼Œç¡®è®¤æ‰€æœ‰è¦æ±‚éƒ½å·²æ»¡è¶³ã€‚åˆ—å‡ºä»»ä½•æœªå¤„ç†çš„ spec é¡¹ã€‚â€è¿™æ¨åŠ¨ LLM åæ€å…¶è¾“å‡ºç›¸å¯¹äº spec çš„æƒ…å†µï¼Œæ•è·é—æ¼ã€‚è¿™æ˜¯å†…ç½®åœ¨æµç¨‹ä¸­çš„ä¸€ç§è‡ªæˆ‘å®¡è®¡å½¢å¼ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä½ å¯ä»¥åœ¨ prompt æœ«å°¾æ·»åŠ ï¼šâ€œï¼ˆç¼–å†™å‡½æ•°åï¼Œå›é¡¾ä¸Šè¿°éœ€æ±‚åˆ—è¡¨ï¼Œç¡®ä¿æ¯ä¸€é¡¹éƒ½å¾—åˆ°æ»¡è¶³ï¼Œæ ‡è®°ä»»ä½•ç¼ºå¤±çš„é¡¹ï¼‰ã€‚â€ç„¶åæ¨¡å‹ä¼šï¼ˆç†æƒ³æƒ…å†µä¸‹ï¼‰è¾“å‡ºä»£ç ï¼Œåè·Ÿä¸€ä¸ªç®€çŸ­çš„æ£€æŸ¥æ¸…å•ï¼Œè¯´æ˜æ˜¯å¦æ»¡è¶³æ¯ä¸ªè¦æ±‚ã€‚è¿™é™ä½äº†å®ƒåœ¨è¿è¡Œæµ‹è¯•ä¹‹å‰å°±å¿˜è®°æŸäº›å†…å®¹çš„å¯èƒ½æ€§ã€‚è¿™ä¸æ˜¯ä¸‡æ— ä¸€å¤±çš„ï¼Œä½†ç¡®å®æœ‰å¸®åŠ©ã€‚</p>
<p><strong>ä½¿ç”¨ LLM-as-a-Judge è¿›è¡Œä¸»è§‚æ£€æŸ¥ï¼š</strong> å¯¹äºéš¾ä»¥è‡ªåŠ¨æµ‹è¯•çš„æ ‡å‡†â€”â€”ä»£ç é£æ ¼ã€å¯è¯»æ€§ã€å¯¹æ¶æ„æ¨¡å¼çš„éµå¾ªâ€”â€”è€ƒè™‘ä½¿ç”¨â€œLLM-as-a-Judgeï¼ˆLLM ä½œä¸ºè£åˆ¤ï¼‰â€ã€‚è¿™æ„å‘³ç€è®©ç¬¬äºŒä¸ª agentï¼ˆæˆ–å•ç‹¬çš„ promptï¼‰æ ¹æ®ä½ çš„ spec è´¨é‡æŒ‡å—å®¡æŸ¥ç¬¬ä¸€ä¸ª agent çš„è¾“å‡ºã€‚Anthropic å’Œå…¶ä»–å…¬å¸å‘ç°è¿™å¯¹ä¸»è§‚è¯„ä¼°å¾ˆæœ‰æ•ˆã€‚ä½ å¯ä»¥è¿™æ ·å†™ promptï¼šâ€œå®¡æŸ¥è¿™æ®µä»£ç æ˜¯å¦ç¬¦åˆæˆ‘ä»¬çš„é£æ ¼æŒ‡å—ã€‚æ ‡è®°ä»»ä½•è¿è§„è¡Œä¸ºã€‚â€ è£åˆ¤ agent è¿”å›åé¦ˆï¼Œè¦ä¹ˆè¢«æ¥å—ï¼Œè¦ä¹ˆè§¦å‘ä¿®æ”¹ã€‚è¿™åœ¨è¯­æ³•æ£€æŸ¥ä¹‹å¤–å¢åŠ äº†ä¸€å±‚è¯­ä¹‰è¯„ä¼°ã€‚</p>
<p><strong>ä¸€è‡´æ€§æµ‹è¯•ï¼š</strong> Willison ä¸»å¼ æ„å»ºä¸€è‡´æ€§æµ‹è¯•å¥—ä»¶â€”â€”ä»»ä½•å®ç°éƒ½å¿…é¡»é€šè¿‡çš„ç‹¬ç«‹äºè¯­è¨€çš„æµ‹è¯•ï¼ˆé€šå¸¸åŸºäº YAMLï¼‰ã€‚è¿™äº›æµ‹è¯•å……å½“å¥‘çº¦ï¼šå¦‚æœä½ æ­£åœ¨æ„å»º APIï¼Œä¸€è‡´æ€§æµ‹è¯•å¥—ä»¶æŒ‡å®šé¢„æœŸçš„è¾“å…¥/è¾“å‡ºï¼Œagent çš„ä»£ç å¿…é¡»æ»¡è¶³æ‰€æœ‰æµ‹è¯• caseã€‚è¿™æ¯”ä¸´æ—¶å•å…ƒæµ‹è¯•æ›´ä¸¥æ ¼ï¼Œå› ä¸ºå®ƒç›´æ¥æ¥è‡ª spec å¹¶ä¸”å¯ä»¥å¤ç”¨äºä¸åŒå®ç°ã€‚åœ¨ä½ çš„ spec çš„â€œæˆåŠŸæ ‡å‡†â€éƒ¨åˆ†åŒ…å«ä¸€è‡´æ€§æµ‹è¯•æ ‡å‡†ï¼ˆä¾‹å¦‚ï¼Œâ€œå¿…é¡»é€šè¿‡ <code>conformance/api-tests.yaml</code> ä¸­çš„æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹â€ï¼‰ã€‚</p>
<p><strong>åœ¨ spec ä¸­åˆ©ç”¨æµ‹è¯•ï¼š</strong> å¦‚æœå¯èƒ½ï¼Œåœ¨ spec å’Œ prompt æµç¨‹ä¸­çº³å…¥æµ‹è¯•è®¡åˆ’ç”šè‡³å®é™…æµ‹è¯•ä»£ç ã€‚åœ¨ä¼ ç»Ÿå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ TDD æˆ–ç¼–å†™æµ‹è¯•ç”¨ä¾‹æ¥æ˜ç¡®éœ€æ±‚â€”â€”ä½ å¯ä»¥å¯¹ AI åšåŒæ ·çš„äº‹æƒ…ã€‚ä¾‹å¦‚ï¼Œåœ¨ä½ çš„ spec çš„â€œæˆåŠŸæ ‡å‡†â€ä¸­ï¼Œä½ å¯ä»¥è¯´â€œè¿™äº›ç¤ºä¾‹è¾“å…¥åº”è¯¥äº§ç”Ÿè¿™äº›è¾“å‡ºâ€¦â€¦â€æˆ–â€œä»¥ä¸‹å•å…ƒæµ‹è¯•åº”è¯¥é€šè¿‡â€ã€‚å¯ä»¥æç¤º agent åœ¨è„‘æµ·ä¸­è¿è¡Œè¿™äº›ç”¨ä¾‹ï¼Œæˆ–è€…å¦‚æœå®ƒæœ‰è¿™ç§èƒ½åŠ›ç›´æ¥æ‰§è¡Œç”¨ä¾‹ã€‚Simon Willison æŒ‡å‡ºï¼Œæ‹¥æœ‰<a href="https://link.juejin.cn?target=https%3A%2F%2Fsimonwillison.net%2F2025%2FOct%2F7%2Fvibe-engineering%2F" target="_blank" title="https://simonwillison.net/2025/Oct/7/vibe-engineering/" ref="nofollow noopener noreferrer">å¼ºå¤§çš„æµ‹è¯•å¥—ä»¶</a>å°±åƒç»™ agent è¶…èƒ½åŠ›â€”â€”å½“æµ‹è¯•å¤±è´¥æ—¶ï¼Œå®ƒä»¬å¯ä»¥å¿«é€ŸéªŒè¯å’Œè¿­ä»£ã€‚åœ¨ AI ç¼–ç ä¸Šä¸‹æ–‡ä¸­ï¼Œåœ¨ spec ä¸­ä¸ºæµ‹è¯•æˆ–é¢„æœŸç»“æœç¼–å†™ä¸€äº›ä¼ªä»£ç å¯ä»¥æŒ‡å¯¼ agent çš„å®ç°ã€‚æ­¤å¤–ï¼Œä½ å¯ä»¥åœ¨å­ agent è®¾ç½®ä¸­ä½¿ç”¨ä¸“é—¨çš„â€œ<a href="https://link.juejin.cn?target=https%3A%2F%2F10xdevelopers.dev%2Fstructured%2Fclaude-code-with-subagents%2F" target="_blank" title="https://10xdevelopers.dev/structured/claude-code-with-subagents/" ref="nofollow noopener noreferrer">æµ‹è¯• agent</a>â€ï¼Œå®ƒæ ¹æ® spec çš„æ ‡å‡†å¹¶æŒç»­éªŒè¯â€œç¼–ç  agentâ€çš„è¾“å‡ºã€‚</p>
<p><strong>æ³¨å…¥ä½ çš„é¢†åŸŸçŸ¥è¯†ï¼š</strong> ä½ çš„ spec åº”è¯¥ä½“ç°åªæœ‰ç»éªŒä¸°å¯Œçš„å¼€å‘è€…æˆ–äº†è§£ä¸Šä¸‹æ–‡çš„äººæ‰ä¼šçŸ¥é“çš„è§è§£ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æ­£åœ¨æ„å»ºä¸€ä¸ªç”µå•† agentï¼Œå¹¶ä¸”ä½ çŸ¥é“â€œäº§å“â€å’Œâ€œç±»åˆ«â€å…·æœ‰å¤šå¯¹å¤šå…³ç³»ï¼Œè¯·æ˜ç¡®è¯´æ˜ï¼ˆä¸è¦å‡è®¾ AI ä¼šæ¨æ–­å‡ºæ¥â€”â€”å®ƒå¯èƒ½ä¸ä¼šï¼‰ã€‚å¦‚æœæŸä¸ªåº“ç‰¹åˆ«æ£˜æ‰‹ï¼Œè¯·æåŠè¦é¿å…çš„é™·é˜±ã€‚æœ¬è´¨ä¸Šæ˜¯æŠŠä½ çš„æŒ‡å¯¼æ³¨å…¥åˆ° spec ä¸­ã€‚spec å¯ä»¥åŒ…å«è¿™æ ·çš„å»ºè®®ï¼šâ€œå¦‚æœä½¿ç”¨åº“ Xï¼Œè¯·æ³¨æ„ç‰ˆæœ¬ Y ä¸­çš„å†…å­˜æ³„æ¼é—®é¢˜ï¼ˆåº”ç”¨è§£å†³æ–¹æ¡ˆ Zï¼‰ã€‚â€è¿™ç§è¯¦ç»†ç¨‹åº¦æ˜¯å°†æ™®é€šçš„ AI è¾“å‡ºè½¬å˜ä¸ºçœŸæ­£å¥å£®è§£å†³æ–¹æ¡ˆçš„å…³é”®ï¼Œå› ä¸ºä½ å·²ç»å¼•å¯¼ AI è¿œç¦»å¸¸è§é™·é˜±ã€‚</p>
<p>å¦å¤–ï¼Œå¦‚æœä½ æœ‰åå¥½æˆ–é£æ ¼æŒ‡å—ï¼ˆæ¯”å¦‚ï¼Œâ€œåœ¨ React ä¸­ä½¿ç”¨å‡½æ•°ç»„ä»¶è€Œä¸æ˜¯ç±»ç»„ä»¶â€ï¼‰ï¼Œå°†å…¶ç¼–ç åˆ° spec ä¸­ã€‚ç„¶å AI ä¼šæ¨¡ä»¿ä½ çš„é£æ ¼ã€‚è®¸å¤šå·¥ç¨‹å¸ˆç”šè‡³åœ¨ spec ä¸­åŒ…å«å°ä¾‹å­ï¼Œä¾‹å¦‚ï¼Œâ€œæ‰€æœ‰ API å“åº”éƒ½åº”è¯¥æ˜¯ JSONã€‚ä¾‹å¦‚ï¼Œé”™è¯¯æ—¶ä½¿ç”¨ <code>{"error": "message"}</code>ã€‚â€é€šè¿‡ç»™å‡ºç®€å•ç¤ºä¾‹ï¼Œå°† AI é”šå®šåˆ°ä½ æƒ³è¦çš„ç²¾ç¡®æ ¼å¼ã€‚</p>
<p><strong>ç®€å•ä»»åŠ¡çš„æç®€ä¸»ä¹‰ï¼š</strong> è™½ç„¶æˆ‘ä»¬æå€¡è¯¦å°½çš„ specï¼Œä½†ä¸“ä¸šçŸ¥è¯†ä¹ŸåŒ…æ‹¬æ‡‚å¾—ä½•æ—¶ä¿æŒç®€æ´ã€‚å¯¹äºç›¸å¯¹ç®€å•ã€å­¤ç«‹çš„ä»»åŠ¡ï¼Œç¹ççš„ spec å®é™…ä¸Šå¯èƒ½é€ æˆå›°æƒ‘è€Œéå¸®åŠ©ã€‚è‹¥ä½ è®© agent åšç›´æ¥æ˜äº†çš„äº‹ï¼ˆå¦‚"åœ¨é¡µé¢ä¸Šå±…ä¸­ä¸€ä¸ª div"ï¼‰ï¼Œä½ å¯èƒ½åªéœ€è¦è¯´ï¼Œâ€œç¡®ä¿è§£å†³æ–¹æ¡ˆç®€æ´ï¼Œä¸è¦æ·»åŠ å¤šä½™çš„æ ‡è®°æˆ–æ ·å¼ã€‚â€ ä¸éœ€è¦å®Œæ•´çš„ PRDã€‚ç›¸åï¼Œå¯¹äºå¤æ‚çš„ä»»åŠ¡ï¼ˆæ¯”å¦‚â€œå®ç°å¸¦æœ‰ä»¤ç‰Œåˆ·æ–°å’Œé”™è¯¯å¤„ç†çš„ OAuth æµç¨‹â€ï¼‰ï¼Œæ‰æ˜¯ä½ è¯¦ç»†ç¼–å†™ spec çš„æ—¶å€™ã€‚ä¸€ä¸ªå¥½çš„ç»éªŒæ³•åˆ™æ˜¯ï¼šæ ¹æ®ä»»åŠ¡å¤æ‚åº¦è°ƒæ•´ spec è¯¦ç»†ç¨‹åº¦ã€‚ä¸è¦å¯¹å›°éš¾é—®é¢˜ spec ä¸è¶³ï¼ˆagent ä¼šå¤±è´¥æˆ–åç¦»è½¨é“ï¼‰ï¼Œä½†ä¹Ÿä¸è¦å¯¹çç¢é—®é¢˜è¿‡åº¦ specï¼ˆagent å¯èƒ½ä¼šè¢«çº ç¼ æˆ–åœ¨ä¸å¿…è¦çš„æŒ‡ä»¤ä¸Šæ¶ˆè€—ä¸Šä¸‹æ–‡ï¼‰ã€‚</p>
<p><strong>å¦‚éœ€è¦ï¼Œä¿æŒ AI çš„â€œäººè®¾â€ï¼š</strong> æœ‰æ—¶ï¼Œä½ çš„ spec çš„ä¸€éƒ¨åˆ†æ˜¯å®šä¹‰ agent åº”è¯¥å¦‚ä½•è¡Œä¸ºæˆ–å“åº”ï¼Œå°¤å…¶å½“ agent ä¸ç”¨æˆ·äº¤äº’æ—¶ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ„å»ºå®¢æˆ·æ”¯æŒ agentï¼Œä½ çš„ spec å¯èƒ½åŒ…å«è¿™æ ·çš„æŒ‡å¯¼åŸåˆ™ï¼šâ€œä½¿ç”¨å‹å¥½å’Œä¸“ä¸šçš„è¯­æ°”â€ï¼Œâ€œå¦‚æœä½ ä¸çŸ¥é“ç­”æ¡ˆï¼Œå¯»æ±‚è§£é‡Šæˆ–æä¾›åç»­è·Ÿè¿›ï¼Œè€Œä¸æ˜¯çŒœæµ‹ã€‚â€ è¿™ç±»è§„åˆ™ï¼ˆé€šå¸¸åŒ…å«åœ¨ system prompt ä¸­ï¼‰æœ‰åŠ©äºä¿æŒ AI çš„è¾“å‡ºä¸æœŸæœ›ä¸€è‡´ã€‚å®ƒä»¬æœ¬è´¨ä¸Šæ˜¯ AI è¡Œä¸ºçš„ spec é¡¹ã€‚ä¿æŒå®ƒä»¬ä¸€è‡´ï¼Œå¹¶åœ¨é•¿ä¼šè¯ä¸­éœ€è¦æ—¶æé†’æ¨¡å‹ï¼ˆå¦‚æœä¸åŠ ä»¥çº¦æŸï¼ŒLLM çš„é£æ ¼å¯èƒ½ä¼šéšæ—¶é—´â€œæ¼‚ç§»â€ï¼‰ã€‚</p>
<p><strong>ä½ ä»ç„¶æ˜¯å¾ªç¯ä¸­çš„æ‰§è¡Œè€…ï¼š</strong> spec èµ‹äºˆ agent æƒåŠ›ï¼Œä½†ä½ ä»ç„¶æ˜¯æœ€ç»ˆçš„è´¨é‡è¿‡æ»¤å™¨ã€‚å¦‚æœ agent äº§ç”Ÿäº†æŠ€æœ¯ä¸Šç¬¦åˆ spec ä½†æ„Ÿè§‰ä¸å¯¹çš„ä¸œè¥¿ï¼Œç›¸ä¿¡ä½ çš„åˆ¤æ–­ã€‚è¦ä¹ˆå®Œå–„ specï¼Œè¦ä¹ˆç›´æ¥è°ƒæ•´è¾“å‡ºã€‚AI agent çš„ä¼˜ç‚¹æ˜¯å®ƒä»¬ä¸ä¼šæ„Ÿåˆ°å†’çŠ¯â€”â€”å¦‚æœå®ƒä»¬äº¤ä»˜äº†ä¸€ä¸ªåç¦»é¢„æœŸçš„è®¾è®¡ï¼Œä½ å¯ä»¥è¯´ï¼Œâ€œå®é™…ä¸Šï¼Œè¿™ä¸æ˜¯æˆ‘çš„æœ¬æ„ï¼Œè®©æˆ‘ä»¬æ˜ç¡® spec å¹¶é‡åšã€‚â€spec æ˜¯ä¸ AI åä½œçš„æ´»æ–‡æ¡£ï¼Œè€Œä¸æ˜¯ä½ ä¸èƒ½æ›´æ”¹çš„ä¸€æ¬¡æ€§åˆåŒã€‚</p>
<p>Simon Willison å¹½é»˜åœ°å°†ä¸ AI agent åˆä½œæ¯”ä½œâ€œä¸€ç§éå¸¸å¥‡æ€ªçš„ç®¡ç†å½¢å¼â€ï¼Œç”šè‡³â€œä»ç¼–ç  agent ä¸­è·å¾—è‰¯å¥½ç»“æœæ„Ÿè§‰<a href="https://link.juejin.cn?target=https%3A%2F%2Fsimonwillison.net%2F2025%2FOct%2F7%2Fvibe-engineering%2F" target="_blank" title="https://simonwillison.net/2025/Oct/7/vibe-engineering/" ref="nofollow noopener noreferrer">ä¸ç®¡ç†äººç±»å®ä¹ ç”Ÿéå¸¸æ¥è¿‘</a>â€ã€‚ä½ éœ€è¦æä¾›æ¸…æ™°çš„æŒ‡ä»¤ï¼ˆspecï¼‰ï¼Œç¡®ä¿å®ƒä»¬æœ‰å¿…è¦çš„ä¸Šä¸‹æ–‡ï¼ˆspec å’Œç›¸å…³ä¿¡æ¯ï¼‰ï¼Œå¹¶ç»™å‡ºå¯æ“ä½œçš„åé¦ˆã€‚spec è®¾å®šäº†èˆå°ï¼Œä½†æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ç›‘ç£å’Œåé¦ˆæ˜¯å…³é”®ã€‚å¦‚æœ AI æ˜¯â€œä¸€ä¸ªéå¸¸å¥‡æ€ªçš„æ•°å­—å®ä¹ ç”Ÿï¼Œå¦‚æœä½ ç»™å®ƒæœºä¼šï¼Œå®ƒç»å¯¹ä¼šä½œå¼Šâ€ï¼Œé‚£ä¹ˆä½ ç¼–å†™çš„ spec å’Œçº¦æŸå°±æ˜¯å¦‚ä½•é˜²æ­¢è¿™ç§ä½œå¼Šå¹¶è®©å®ƒä»¬ä¸“æ³¨äºä»»åŠ¡ã€‚</p>
<p>è¿™å°±æ˜¯å›æŠ¥ï¼šä¸€ä¸ªå¥½çš„ spec ä¸ä»…å‘Šè¯‰ AI è¦æ„å»ºä»€ä¹ˆï¼Œè¿˜å¸®åŠ©å®ƒè‡ªæˆ‘çº æ­£å¹¶ä¿æŒåœ¨å®‰å…¨è¾¹ç•Œå†…ã€‚é€šè¿‡èå…¥éªŒè¯æ­¥éª¤ã€çº¦æŸå’Œä½ æ¥ä¹‹ä¸æ˜“çš„çŸ¥è¯†ï¼Œä½ å¤§å¤§å¢åŠ äº† agent çš„è¾“å‡ºåœ¨ç¬¬ä¸€æ¬¡å°è¯•æ—¶å°±æ­£ç¡®ï¼ˆæˆ–è‡³å°‘æ›´æ¥è¿‘æ­£ç¡®ï¼‰çš„å¯èƒ½æ€§ã€‚è¿™å‡å°‘äº†è¿­ä»£å’Œé‚£äº›â€œå®ƒåˆ°åº•ä¸ºä»€ä¹ˆè¦é‚£æ ·åšï¼Ÿâ€çš„æ—¶åˆ»ã€‚</p>
<h2 data-id="heading-4">5. æµ‹è¯•ã€è¿­ä»£å¹¶æ”¹è¿› specï¼ˆå¹¶ä½¿ç”¨æ­£ç¡®çš„å·¥å…·ï¼‰</h2>
<p><strong>å°† spec ç¼–å†™å’Œ agent æ„å»ºè§†ä¸ºè¿­ä»£å¾ªç¯ï¼šå°½æ—©æµ‹è¯•ï¼Œæ”¶é›†åé¦ˆï¼Œå®Œå–„ specï¼Œå¹¶åˆ©ç”¨å·¥å…·è‡ªåŠ¨åŒ–æ£€æŸ¥ã€‚</strong></p>
<p>åˆå§‹çš„ spec ä¸æ˜¯ç»ˆç‚¹â€”â€”å®ƒæ˜¯ä¸€ä¸ªå¾ªç¯çš„å¼€å§‹ã€‚æŒç»­æ ¹æ® spec éªŒè¯ agent çš„å·¥ä½œå¹¶ç›¸åº”è°ƒæ•´æ‰ä¼šè·å¾—æœ€ä½³ç»“æœã€‚æ­¤å¤–ï¼Œç°ä»£ AI å¼€å‘è€…ä½¿ç”¨å„ç§å·¥å…·æ¥æ”¯æŒè¿™ä¸€è¿‡ç¨‹ï¼ˆä» CI æµæ°´çº¿åˆ°ä¸Šä¸‹æ–‡ç®¡ç†å·¥å…·ï¼‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1af19dda49d341b1a405c26d46bf48bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5LiN5ZCD6aW85bmy:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770798594&amp;x-signature=%2B6B8pYkIyU7kOTmULPaptppdWNU%3D" alt="image.png" loading="lazy"/></p>
<p><strong>æŒç»­æµ‹è¯•ï¼š</strong> ä¸è¦ç­‰åˆ°æœ€åæ‰çœ‹ agent æ˜¯å¦æ»¡è¶³ specã€‚åœ¨æ¯ä¸ªä¸»è¦é‡Œç¨‹ç¢‘ä¹‹åï¼Œç”šè‡³æ¯ä¸ªå‡½æ•°ä¹‹åï¼Œè¿è¡Œæµ‹è¯•æˆ–è‡³å°‘è¿›è¡Œå¿«é€Ÿæ‰‹åŠ¨æ£€æŸ¥ã€‚å¦‚æœå‡ºç°å¤±è´¥ï¼Œåœ¨ç»§ç»­ä¹‹å‰æ›´æ–° spec æˆ– promptã€‚ä¾‹å¦‚ï¼Œå¦‚æœ spec è¯´â€œå¯†ç å¿…é¡»ç”¨ bcrypt å“ˆå¸Œâ€ï¼Œè€Œä½ çœ‹åˆ° agent çš„ä»£ç å­˜å‚¨æ˜æ–‡â€”â€”åœä¸‹æ¥çº æ­£å®ƒï¼ˆå¹¶åœ¨ spec æˆ– prompt ä¸­æé†’è¯¥è§„åˆ™ï¼‰ã€‚è‡ªåŠ¨åŒ–æµ‹è¯•åœ¨è¿™é‡Œå¤§æ”¾å¼‚å½©ï¼šå¦‚æœä½ æä¾›äº†æµ‹è¯•ï¼ˆæˆ–è¾¹åšè¾¹å†™ï¼‰ï¼Œè®© agent è¿è¡Œå®ƒä»¬ã€‚åœ¨è®¸å¤š coding agent è®¾ç½®ä¸­ï¼Œä½ å¯ä»¥è®© agent åœ¨å®Œæˆä»»åŠ¡åè¿è¡Œ <code>npm test</code> æˆ–ç±»ä¼¼å‘½ä»¤ã€‚ç»“æœï¼ˆå¤±è´¥ï¼‰å¯ä»¥åé¦ˆåˆ°ä¸‹ä¸€ä¸ª prompt ä¸­ï¼Œæœ‰æ•ˆåœ°å‘Šè¯‰ agentâ€œä½ çš„è¾“å‡ºåœ¨ Xã€Yã€Z ä¸Šä¸ç¬¦åˆ specâ€”â€”ä¿®å¤å®ƒã€‚â€è¿™ç§ agent å¾ªç¯ï¼ˆä»£ç  -&gt; æµ‹è¯• -&gt; ä¿®å¤ -&gt; é‡å¤ï¼‰éå¸¸å¼ºå¤§ï¼Œè¿™æ­£æ˜¯åƒ Claude Code æˆ– Copilot Labs ç­‰å·¥å…·è¿›åŒ–ä»¥å¤„ç†æ›´å¤§ä»»åŠ¡çš„æ–¹å¼ã€‚å§‹ç»ˆå®šä¹‰â€œå®Œæˆâ€çš„å«ä¹‰ï¼ˆé€šè¿‡æµ‹è¯•æˆ–æ ‡å‡†ï¼‰å¹¶è¿›è¡Œæ£€æŸ¥ã€‚</p>
<p><strong>è¿­ä»£ spec æœ¬èº«ï¼š</strong> å¦‚æœä½ å‘ç° spec ä¸å®Œæ•´æˆ–ä¸æ¸…æ¥šï¼ˆä¹Ÿè®¸ agent è¯¯è§£äº†æŸäº›å†…å®¹ï¼Œæˆ–è€…ä½ æ„è¯†åˆ°é—æ¼äº†ä¸€ä¸ªéœ€æ±‚ï¼‰ï¼Œæ›´æ–° spec æ–‡æ¡£ã€‚ç„¶åæ˜ç¡®åœ°å°† agent ä¸æ–° spec é‡æ–°åŒæ­¥ï¼šâ€œæˆ‘å·²æŒ‰å¦‚ä¸‹æ–¹å¼æ›´æ–°äº† specâ€¦â€¦æ ¹æ®æ›´æ–°çš„ specï¼Œç›¸åº”åœ°è°ƒæ•´è®¡åˆ’æˆ–é‡æ„ä»£ç ã€‚â€è¿™æ · spec ä»ç„¶æ˜¯å”¯ä¸€çš„çœŸç†æ¥æºã€‚è¿™ç±»ä¼¼äºæˆ‘ä»¬åœ¨æ­£å¸¸å¼€å‘ä¸­å¤„ç†éœ€æ±‚å˜æ›´çš„æ–¹å¼â€”â€”ä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ ä¹Ÿæ˜¯ AI agent çš„äº§å“ç»ç†ã€‚å¦‚æœå¯èƒ½ï¼Œä¿ç•™ç‰ˆæœ¬å†å²ï¼ˆå³ä½¿åªæ˜¯é€šè¿‡commitæ¶ˆæ¯æˆ–ç¬”è®°ï¼‰ï¼Œè¿™æ ·ä½ å°±çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–ä»¥åŠä¸ºä»€ä¹ˆã€‚</p>
<p><strong>åˆ©ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å’Œè®°å¿†å·¥å…·ï¼š</strong> ä¸æ–­å¢é•¿çš„å·¥å…·ç”Ÿæ€å¯ä»¥å¸®åŠ©ä½ ç®¡ç† AI agent çš„ä¸Šä¸‹æ–‡å’ŒçŸ¥è¯†ã€‚ä¾‹å¦‚ï¼Œæ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰æ˜¯ä¸€ç§æ¨¡å¼ï¼Œagent å¯ä»¥å³æ—¶ä»çŸ¥è¯†åº“ï¼ˆå¦‚å‘é‡æ•°æ®åº“ï¼‰ä¸­æå–ç›¸å…³æ•°æ®å—ã€‚å¦‚æœä½ çš„ spec å¾ˆå¤§ï¼Œä½ å¯ä»¥åµŒå…¥å…¶ä¸­çš„éƒ¨åˆ†ï¼Œè®© agent åœ¨éœ€è¦æ—¶æ£€ç´¢æœ€ç›¸å…³çš„éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯æ€»æ˜¯æä¾›æ•´ä¸ªå†…å®¹ã€‚è¿˜æœ‰ä¸€äº›æ¡†æ¶å®ç°äº†æ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼ˆMCPï¼‰ï¼Œå®ƒæ ¹æ®å½“å‰ä»»åŠ¡è‡ªåŠ¨å‘æ¨¡å‹æä¾›æ­£ç¡®çš„ä¸Šä¸‹æ–‡ã€‚ä¸€ä¸ªä¾‹å­æ˜¯ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.digitalocean.com%2Fproducts%2Fgradient-ai-platform%2Fconcepts%2Fcontext-management%2F" target="_blank" title="https://docs.digitalocean.com/products/gradient-ai-platform/concepts/context-management/" ref="nofollow noopener noreferrer">Context7</a> (context7.com)ï¼Œå®ƒå¯ä»¥æ ¹æ®ä½ æ­£åœ¨å¤„ç†çš„å†…å®¹è‡ªåŠ¨ä»æ–‡æ¡£ä¸­è·å–ç›¸å…³çš„ä¸Šä¸‹æ–‡ç‰‡æ®µã€‚å®é™…ä¸Šï¼Œè¿™å¯èƒ½æ„å‘³ç€ agent æ³¨æ„åˆ°ä½ æ­£åœ¨å¤„ç†â€œæ”¯ä»˜å¤„ç†â€ï¼Œå®ƒä¼šå°† spec æˆ–æ–‡æ¡£çš„â€œæ”¯ä»˜â€éƒ¨åˆ†æ‹‰å…¥æç¤ºä¸­ã€‚è€ƒè™‘é‡‡ç”¨è¿™äº›å·¥å…·ï¼Œæˆ–è€…è‡³å°‘è®¾ç½®ä¸€ä¸ªåŸºç¡€ç‰ˆæœ¬ï¼ˆå³ä½¿åªæ˜¯åœ¨ spec æ–‡æ¡£ä¸­è¿›è¡Œç®€å•æœç´¢ï¼‰ã€‚</p>
<p><strong>è°¨æ…å¹¶è¡ŒåŒ–ï¼š</strong> ä¸€äº›å¼€å‘è€…åœ¨ä¸åŒä»»åŠ¡ä¸Šå¹¶è¡Œè¿è¡Œå¤šä¸ª agent å®ä¾‹ï¼ˆå¦‚å‰é¢æåˆ°çš„ subagentï¼‰ã€‚è¿™å¯ä»¥åŠ å¿«å¼€å‘é€Ÿåº¦â€”â€”ä¾‹å¦‚ï¼Œä¸€ä¸ª agent ç”Ÿæˆä»£ç ï¼Œè€Œå¦ä¸€ä¸ªåŒæ—¶ç¼–å†™æµ‹è¯•ï¼Œæˆ–è€…ä¸¤ä¸ªåŠŸèƒ½åŒæ—¶æ„å»ºã€‚å¦‚æœä½ é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œç¡®ä¿ä»»åŠ¡çœŸæ­£ç‹¬ç«‹æˆ–æ˜ç¡®åˆ†ç¦»ä»¥é¿å…å†²çªï¼ˆspec åº”æ³¨æ˜ä»»ä½•ä¾èµ–å…³ç³»ï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸è¦è®©ä¸¤ä¸ª agent åŒæ—¶å†™å…¥åŒä¸€ä¸ªæ–‡ä»¶ã€‚ä¸€ç§å·¥ä½œæµç¨‹æ˜¯è®©ä¸€ä¸ª agent ç”Ÿæˆä»£ç ï¼Œå¦ä¸€ä¸ªå¹¶è¡Œå®¡æŸ¥å®ƒï¼Œæˆ–è€…æ„å»ºå•ç‹¬çš„ç»„ä»¶ä»¥ä¾¿ä»¥åé›†æˆã€‚è¿™æ˜¯é«˜çº§ç”¨æ³•ï¼Œç®¡ç†èµ·æ¥å¯èƒ½åœ¨ç²¾ç¥ä¸Šå¾ˆç´¯ï¼ˆæ­£å¦‚ Willison æ‰¿è®¤çš„ï¼Œè¿è¡Œå¤šä¸ª agent å‡ºå¥‡åœ°æœ‰æ•ˆï¼Œå°½ç®¡åœ¨ç²¾ç¥ä¸Šä»¤äººç–²æƒ«ï¼ï¼‰ã€‚æœ€å¤šä» 2-3 ä¸ª agent å¼€å§‹ï¼Œä»¥ä¿æŒå¯ç®¡ç†æ€§ã€‚</p>
<p><strong>ç‰ˆæœ¬æ§åˆ¶å’Œ spec é”å®šï¼š</strong> ä½¿ç”¨ Git æˆ–ä½ é€‰æ‹©çš„ç‰ˆæœ¬æ§åˆ¶æ¥è·Ÿè¸ª agent çš„æ“ä½œã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fsimonwillison.net%2F2025%2FOct%2F7%2Fvibe-engineering%2F" target="_blank" title="https://simonwillison.net/2025/Oct/7/vibe-engineering/" ref="nofollow noopener noreferrer">è‰¯å¥½çš„ç‰ˆæœ¬æ§åˆ¶ä¹ æƒ¯</a>åœ¨ AI è¾…åŠ©ä¸‹æ›´ä¸ºé‡è¦ã€‚å°† spec æ–‡ä»¶æœ¬èº«æäº¤åˆ°ä»“åº“ã€‚è¿™ä¸ä»…ä¿ç•™äº†å†å²è®°å½•ï¼Œagent ç”šè‡³å¯ä»¥ä½¿ç”¨ <code>git diff</code> æˆ– <code>blame</code> æ¥ç†è§£å˜åŒ–ï¼ˆLLM éå¸¸æ“…é•¿é˜…è¯»å·®å¼‚ï¼‰ã€‚ä¸€äº›é«˜çº§ agent è®¾ç½®è®© agent æŸ¥è¯¢ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå†å²ä»¥æŸ¥çœ‹æŸäº›å†…å®¹ä½•æ—¶å¼•å…¥â€”â€”ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œæ¨¡å‹â€œåœ¨ Git æ–¹é¢éå¸¸èƒœä»»â€ã€‚é€šè¿‡å°† spec ä¿å­˜åœ¨ä»“åº“ä¸­ï¼Œå¯ä»¥è®©ä½ å’Œ AI éƒ½è·Ÿè¸ªå˜åŒ–ã€‚æœ‰ä¸€äº›å·¥å…·ï¼ˆå¦‚å‰é¢æåˆ°çš„ GitHub Spec Kitï¼‰å°† spec é©±åŠ¨å¼€å‘é›†æˆåˆ° git å·¥ä½œæµä¸­â€”â€”ä¾‹å¦‚ï¼Œåœ¨æ›´æ–° spec æ—¶é™åˆ¶åˆå¹¶æˆ–ä» spec é¡¹ç”Ÿæˆæ£€æŸ¥æ¸…å•ã€‚è™½ç„¶ä½ ä¸éœ€è¦è¿™äº›å·¥å…·å°±èƒ½æˆåŠŸï¼Œä½†é‡ç‚¹æ˜¯åƒå¯¹å¾…ä»£ç ä¸€æ ·å¯¹å¾… specâ€”â€”è®¤çœŸç»´æŠ¤å®ƒã€‚</p>
<p><strong>æˆæœ¬å’Œé€Ÿåº¦è€ƒè™‘ï¼š</strong> ä½¿ç”¨å¤§å‹æ¨¡å‹å’Œé•¿ä¸Šä¸‹æ–‡å¯èƒ½æ—¢æ…¢åˆè´µã€‚ä¸€ä¸ªå®ç”¨çš„æŠ€å·§æ˜¯å·§å¦™åœ°ä½¿ç”¨æ¨¡å‹é€‰æ‹©å’Œæ‰¹å¤„ç†ã€‚ä¹Ÿè®¸ä½¿ç”¨æ›´ä¾¿å®œ/æ›´å¿«çš„æ¨¡å‹è¿›è¡Œåˆå§‹è‰ç¨¿æˆ–é‡å¤ï¼Œå¹¶å°†æœ€å¼ºå¤§ï¼ˆå’Œæ˜‚è´µï¼‰çš„æ¨¡å‹ä¿ç•™ç”¨äºæœ€ç»ˆè¾“å‡ºæˆ–å¤æ‚æ¨ç†ã€‚ä¸€äº›å¼€å‘è€…ä½¿ç”¨ GPT-4 æˆ– Claude è¿›è¡Œè§„åˆ’å’Œå…³é”®æ­¥éª¤ï¼Œä½†å°†æ›´ç®€å•çš„æ‰©å±•æˆ–é‡æ„åº”ç”¨åœ¨æœ¬åœ°æ¨¡å‹æˆ–è¾ƒå°çš„ API æ¨¡å‹ã€‚å¦‚æœä½¿ç”¨å¤šä¸ª agentï¼Œä¹Ÿè®¸ä¸æ˜¯æ‰€æœ‰ agent éƒ½éœ€è¦é¡¶çº§ï¼›è¿è¡Œæµ‹è¯•çš„ agent æˆ–ä»£ç æ£€æŸ¥ agent å¯ä»¥æ˜¯è¾ƒå°çš„æ¨¡å‹ã€‚è¿˜è¦è€ƒè™‘é™åˆ¶ä¸Šä¸‹æ–‡å¤§å°ï¼šå¦‚æœ 5k å°±å¤Ÿäº†ï¼Œå°±ä¸è¦æä¾› 20k tokenã€‚æ­£å¦‚æˆ‘ä»¬è®¨è®ºçš„ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anthropic.com%2Fengineering%2Feffective-context-engineering-for-ai-agents" target="_blank" title="https://www.anthropic.com/engineering/effective-context-engineering-for-ai-agents" ref="nofollow noopener noreferrer">æ›´å¤š token å¯èƒ½æ„å‘³ç€æ”¶ç›Šé€’å‡</a>ã€‚</p>
<p><strong>ç›‘æ§å¹¶è®°å½•ä¸€åˆ‡ï¼š</strong> åœ¨å¤æ‚çš„ agent å·¥ä½œæµä¸­ï¼Œè®°å½• agent çš„æ“ä½œå’Œè¾“å‡ºè‡³å…³é‡è¦ã€‚æ£€æŸ¥æ—¥å¿—ä»¥æŸ¥çœ‹ agent æ˜¯å¦åç¦»æˆ–é‡åˆ°é”™è¯¯ã€‚è®¸å¤šæ¡†æ¶æä¾›è·Ÿè¸ªæ—¥å¿—æˆ–å…è®¸æ‰“å° agent çš„æ€è€ƒé“¾ï¼ˆç‰¹åˆ«æ˜¯å¦‚æœä½ æç¤ºå®ƒé€æ­¥æ€è€ƒï¼‰ã€‚å®¡æŸ¥è¿™äº›æ—¥å¿—å¯ä»¥çªå‡ºæ˜¾ç¤º spec æˆ–æŒ‡ä»¤å¯èƒ½è¢«è¯¯è§£çš„åœ°æ–¹ã€‚è¿™ä¸è°ƒè¯•ç¨‹åºæ²¡ä»€ä¹ˆä¸åŒâ€”â€”åªæ˜¯â€œç¨‹åºâ€æ˜¯å¯¹è¯/æç¤ºé“¾ã€‚å¦‚æœå‘ç”Ÿå¥‡æ€ªçš„äº‹æƒ…ï¼Œå›åˆ° spec/æŒ‡ä»¤çœ‹çœ‹æ˜¯å¦å­˜åœ¨æ­§ä¹‰ã€‚</p>
<p><strong>å­¦ä¹ å’Œæ”¹è¿›ï¼š</strong> æœ€åï¼Œå°†æ¯ä¸ªé¡¹ç›®è§†ä¸ºå®Œå–„ spec ç¼–å†™æŠ€èƒ½çš„å­¦ä¹ æœºä¼šã€‚ä¹Ÿè®¸ä½ ä¼šå‘ç°æŸç§æªè¾æ€»æ˜¯è®© AI å›°æƒ‘ï¼Œæˆ–è€…ä»¥æŸç§æ–¹å¼ç»„ç»‡ spec éƒ¨åˆ†ä¼šäº§ç”Ÿæ›´å¥½çš„éµå®ˆæ€§ã€‚å°†è¿™äº›ç»éªŒæ•™è®­èå…¥ä¸‹ä¸€ä¸ª specã€‚AI agent é¢†åŸŸæ­£åœ¨å¿«é€Ÿå‘å±•ï¼Œå› æ­¤æ–°çš„æœ€ä½³å®è·µï¼ˆå’Œå·¥å…·ï¼‰ä¸æ–­æ¶Œç°ã€‚é€šè¿‡åšå®¢ï¼ˆå¦‚ Simon Willisonã€Andrej Karpathy ç­‰ï¼‰ä¿æŒæ›´æ–°ï¼Œä¸è¦çŠ¹è±«å»å®éªŒã€‚</p>
<p>ä¸º AI agent ç¼–å†™çš„ spec ä¸æ˜¯â€œå†™ä¸€æ¬¡å°±å®Œæˆâ€ã€‚å®ƒæ˜¯æŒ‡å¯¼ã€éªŒè¯å’Œå®Œå–„çš„æŒç»­å¾ªç¯çš„ä¸€éƒ¨åˆ†ã€‚è¿™ç§å‹¤å¥‹çš„å›æŠ¥æ˜¯å·¨å¤§çš„ï¼šé€šè¿‡å°½æ—©å‘ç°é—®é¢˜å¹¶ä¿æŒ agent å¯¹é½ï¼Œä½ å¯ä»¥é¿å…åæœŸæ˜‚è´µçš„é‡å†™æˆ–å¤±è´¥ã€‚æ­£å¦‚ä¸€ä½ AI å·¥ç¨‹å¸ˆæ‰“è¶£è¯´ï¼Œä½¿ç”¨è¿™äº›å®è·µå¯ä»¥æ„Ÿè§‰åƒæ‹¥æœ‰â€œä¸€æ”¯å®ä¹ ç”Ÿå†›é˜Ÿâ€ä¸ºä½ å·¥ä½œï¼Œä½†ä½ å¿…é¡»å¥½å¥½ç®¡ç†ä»–ä»¬ã€‚ä¸€ä¸ªè‰¯å¥½çš„ã€æŒç»­ç»´æŠ¤çš„ spec å°±æ˜¯ä½ çš„ç®¡ç†å·¥å…·ã€‚</p>
<h2 data-id="heading-5">é¿å…å¸¸è§é™·é˜±</h2>
<p>åœ¨ç»“æŸä¹‹å‰ï¼Œå€¼å¾—æŒ‡å‡ºçš„æ˜¯ï¼Œå³ä½¿æ˜¯å–„æ„çš„ spec é©±åŠ¨å·¥ä½œæµï¼Œä¹Ÿå¯èƒ½ä¼šè„±è½¨çš„é”™è¯¯æ¨¡å¼ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.blog%2Fai-and-ml%2Fgithub-copilot%2Fhow-to-write-a-great-agents-md-lessons-from-over-2500-repositories%2F" target="_blank" title="https://github.blog/ai-and-ml/github-copilot/how-to-write-a-great-agents-md-lessons-from-over-2500-repositories/" ref="nofollow noopener noreferrer">GitHub å¯¹ 2,500 å¤šä¸ª agent æ–‡ä»¶çš„ç ”ç©¶</a> æ­ç¤ºäº†ä¸€ä¸ªæ˜æ˜¾çš„åˆ†æ­§ï¼šâ€œå¤§å¤šæ•° agent æ–‡ä»¶å¤±è´¥æ˜¯å› ä¸ºå®ƒä»¬å¤ªæ¨¡ç³Šã€‚â€ä»¥ä¸‹æ˜¯è¦é¿å…çš„é”™è¯¯ï¼š</p>
<p><strong>æ¨¡ç³Šçš„ promptï¼š</strong> â€œç»™æˆ‘æ„å»ºä¸€äº›é…·çš„ä¸œè¥¿â€æˆ–â€œè®©å®ƒå·¥ä½œå¾—æ›´å¥½â€æ²¡æœ‰ç»™ agent ä»»ä½•å¯ä»¥ä¾é çš„ä¸œè¥¿ã€‚æ­£å¦‚ Baptiste Studer æ‰€è¯´ï¼šâ€œæ¨¡ç³Šçš„ prompt æ„å‘³ç€é”™è¯¯çš„ç»“æœã€‚â€å¯¹è¾“å…¥ã€è¾“å‡ºå’Œçº¦æŸè¦å…·ä½“ã€‚â€œä½ æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„ç¼–ç åŠ©æ‰‹â€ä¸èµ·ä½œç”¨ã€‚â€œä½ æ˜¯ä¸€åä¸º React ç»„ä»¶ç¼–å†™æµ‹è¯•çš„æµ‹è¯•å·¥ç¨‹å¸ˆï¼Œéµå¾ªè¿™äº›ç¤ºä¾‹ï¼Œæ°¸è¿œä¸ä¿®æ”¹æºä»£ç â€æ‰æœ‰æ•ˆã€‚</p>
<p><strong>è¿‡é•¿çš„ä¸Šä¸‹æ–‡è€Œæ²¡æœ‰æ€»ç»“ï¼š</strong> å°† 50 é¡µæ–‡æ¡£æ‰”è¿› prompt ä¸­å¹¶å¸Œæœ›æ¨¡å‹èƒ½ç†è§£ï¼Œè¿™å¾ˆå°‘å¥æ•ˆã€‚ä½¿ç”¨åˆ†å±‚æ‘˜è¦ï¼ˆå¦‚åŸåˆ™ 3 ä¸­è®¨è®ºçš„ï¼‰æˆ– RAG ä»…å‘ˆç°ç›¸å…³å†…å®¹ã€‚ä¸Šä¸‹æ–‡é•¿åº¦ä¸èƒ½æ›¿ä»£ä¸Šä¸‹æ–‡è´¨é‡ã€‚</p>
<p><strong>è·³è¿‡äººå·¥å®¡æŸ¥ï¼š</strong> Willison æœ‰ä¸€ä¸ªä¸ªäººè§„åˆ™ï¼šâ€œæˆ‘ä¸ä¼šæäº¤æˆ‘æ— æ³•å‘åˆ«äººè§£é‡Šçš„ä»£ç ã€‚â€ è¿™å› ä¸º agent ç”Ÿæˆçš„ä¸œè¥¿é€šè¿‡äº†æµ‹è¯•ï¼Œå¹¶ä¸æ„å‘³ç€å®ƒæ˜¯æ­£ç¡®çš„ã€å®‰å…¨çš„æˆ–å¯ç»´æŠ¤çš„ã€‚å§‹ç»ˆå®¡æŸ¥å…³é”®ä»£ç è·¯å¾„ã€‚â€œçº¸ç‰Œå±‹â€çš„æ¯”å–»é€‚ç”¨ï¼šAI ç”Ÿæˆçš„ä»£ç å¯èƒ½çœ‹èµ·æ¥å¾ˆç¨³å›ºï¼Œä½†åœ¨ä½ æ²¡æœ‰æµ‹è¯•çš„è¾¹ç¼˜æƒ…å†µä¸‹ä¼šå´©æºƒã€‚</p>
<p><strong>å°†vibe codingä¸ç”Ÿäº§å·¥ç¨‹æ··ä¸ºä¸€è°ˆï¼š</strong> ä½¿ç”¨ AI è¿›è¡Œå¿«é€ŸåŸå‹è®¾è®¡ï¼ˆâ€œvibe codingï¼Œæ°›å›´ç¼–ç¨‹â€ï¼‰å¯¹äºæ¢ç´¢å’Œä¸€æ¬¡æ€§é¡¹ç›®å¾ˆå¥½ã€‚ä½†åœ¨æ²¡æœ‰ä¸¥æ ¼ specã€æµ‹è¯•å’Œå®¡æŸ¥çš„æƒ…å†µä¸‹å°†è¯¥ä»£ç å‘å¸ƒåˆ°ç”Ÿäº§ç¯å¢ƒæ˜¯è‡ªæ‰¾éº»çƒ¦ã€‚æˆ‘åŒºåˆ†â€œvibe codingâ€å’Œâ€œAI è¾…åŠ©å·¥ç¨‹â€â€”â€”åè€…éœ€è¦æœ¬æŒ‡å—æè¿°çš„çºªå¾‹ã€‚çŸ¥é“ä½ å¤„äºå“ªç§æ¨¡å¼ã€‚</p>
<p><strong>å¿½è§†â€œè‡´å‘½ä¸‰è¦ç´ â€ï¼š</strong> Willison è­¦å‘Šä¸‰ä¸ªä½¿ AI agent å±é™©çš„å±æ€§ï¼šé€Ÿåº¦ï¼ˆå®ƒä»¬å·¥ä½œå¾—æ¯”ä½ å®¡æŸ¥å¾—å¿«ï¼‰ã€éç¡®å®šæ€§ï¼ˆç›¸åŒè¾“å…¥ï¼Œä¸åŒè¾“å‡ºï¼‰å’Œæˆæœ¬ï¼ˆé¼“åŠ±åœ¨éªŒè¯ä¸Šå·å·¥å‡æ–™ï¼‰ã€‚ä½ çš„ spec å’Œå®¡æŸ¥æµç¨‹å¿…é¡»è€ƒè™‘æ‰€æœ‰ä¸‰ä¸ªå› ç´ ã€‚ä¸è¦è®©é€Ÿåº¦è¶…è¿‡ä½ çš„éªŒè¯èƒ½åŠ›ã€‚</p>
<p><strong>é—æ¼å…­ä¸ªæ ¸å¿ƒé¢†åŸŸï¼š</strong> å¦‚æœä½ çš„ spec æ²¡æœ‰æ¶µç›–å‘½ä»¤ã€æµ‹è¯•ã€é¡¹ç›®ç»“æ„ã€ä»£ç é£æ ¼ã€git å·¥ä½œæµå’Œè¾¹ç•Œæ¡ä»¶ï¼Œä½ å¯èƒ½é—æ¼äº† agent éœ€è¦çš„ä¸œè¥¿ã€‚åœ¨äº¤ç»™ agent ä¹‹å‰ï¼Œä½¿ç”¨ç¬¬ 2 èŠ‚çš„å…­é¢†åŸŸæ£€æŸ¥æ¸…å•ä½œä¸ºå¥å…¨æ€§æ£€æŸ¥ã€‚</p>
<h2 data-id="heading-6">ç»“è®º</h2>
<p>ä¸º AI ç¼–ç  agent ç¼–å†™æœ‰æ•ˆçš„ spec éœ€è¦æ‰å®çš„è½¯ä»¶å·¥ç¨‹åŸåˆ™ï¼Œç»“åˆå¯¹å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ç‰¹æ€§çš„é€‚åº”ã€‚ä»æ˜ç¡®çš„ç›®æ ‡å¼€å§‹ï¼Œè®© AI å¸®åŠ©æ‰©å±•è®¡åˆ’ã€‚åƒä¸¥è‚ƒçš„è®¾è®¡æ–‡æ¡£é‚£æ ·æ„å»º spec â€”â€” æ¶µç›–å…­ä¸ªæ ¸å¿ƒé¢†åŸŸï¼Œå¹¶å°†å…¶é›†æˆåˆ°ä½ çš„å·¥å…·é“¾ä¸­ï¼Œä½¿å…¶æˆä¸ºå¯æ‰§è¡Œçš„äº§å‡ºç‰©ï¼Œè€Œä¸ä»…ä»…æ˜¯æ–‡å­—ã€‚é€šè¿‡ä¸€æ¬¡å‘ agent æä¾›ä¸€å—æ‹¼å›¾æ¥ä¿æŒå…¶ç„¦ç‚¹ç´§å¯†ï¼ˆå¹¶è€ƒè™‘ä½¿ç”¨å·§å¦™çš„ç­–ç•¥ï¼Œå¦‚æ‘˜è¦ç›®å½•ã€å­ agent æˆ–å¹¶è¡Œç¼–æ’æ¥å¤„ç†å¤§å‹ specï¼‰ã€‚é€šè¿‡åŒ…å«ä¸‰å±‚è¾¹ç•Œï¼ˆå§‹ç»ˆ/å…ˆè¯¢é—®/æ°¸ä¸ï¼‰ã€è‡ªæˆ‘æ£€æŸ¥å’Œä¸€è‡´æ€§æµ‹è¯•æ¥é¢„é˜²é™·é˜±â€”â€”æœ¬è´¨ä¸Šï¼Œæ˜¯æ•™ AI å¦‚ä½•ä¸å¤±è´¥ã€‚å¹¶å°†æ•´ä¸ªè¿‡ç¨‹è§†ä¸ºè¿­ä»£çš„ï¼šä½¿ç”¨æµ‹è¯•å’Œåé¦ˆæŒç»­å®Œå–„ spec å’Œä»£ç ã€‚</p>
<p>éµå¾ªè¿™äº›æŒ‡å—ï¼Œä½ çš„ AI agent åœ¨å¤§å‹ä¸Šä¸‹æ–‡ä¸‹â€œå´©æºƒâ€æˆ–åç¦»åˆ°æ— æ„ä¹‰å†…å®¹çš„å¯èƒ½æ€§å°†å¤§å¤§é™ä½ã€‚</p>
<p>ç¥ spec ç¼–å†™æ„‰å¿«ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring AIä¸­çš„å¤šè½®å¯¹è¯è‰ºæœ¯ï¼šè®©å¤§æ¨¡å‹ä¸»åŠ¨æé—®è·å–æ˜ç¡®éœ€æ±‚]]></title>    <link>https://juejin.cn/post/7602482736913301539</link>    <guid>https://juejin.cn/post/7602482736913301539</guid>    <pubDate>2026-02-04T01:00:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602482736913301539" data-draft-id="7602482736913285155" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring AIä¸­çš„å¤šè½®å¯¹è¯è‰ºæœ¯ï¼šè®©å¤§æ¨¡å‹ä¸»åŠ¨æé—®è·å–æ˜ç¡®éœ€æ±‚"/> <meta itemprop="keywords" content="åç«¯,LLM"/> <meta itemprop="datePublished" content="2026-02-04T01:00:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€ç°ç°"/> <meta itemprop="url" content="https://juejin.cn/user/377887729916126"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring AIä¸­çš„å¤šè½®å¯¹è¯è‰ºæœ¯ï¼šè®©å¤§æ¨¡å‹ä¸»åŠ¨æé—®è·å–æ˜ç¡®éœ€æ±‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/377887729916126/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€ç°ç°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T01:00:17.000Z" title="Wed Feb 04 2026 01:00:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Spring AIä¸­çš„å¤šè½®å¯¹è¯è‰ºæœ¯ï¼šè®©å¤§æ¨¡å‹ä¸»åŠ¨æé—®è·å–æ˜ç¡®éœ€æ±‚</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e929010384814e7ab6e1a65d5a8ff290~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA54Gw54Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770771616&amp;x-signature=3bDDrGdPQUPJhFM7p9YtB7fsELs%3D" alt="" loading="lazy"/></p>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FLcvmiIERs6aOIlRAKGGnFg" target="_blank" title="https://mp.weixin.qq.com/s/LcvmiIERs6aOIlRAKGGnFg" ref="nofollow noopener noreferrer">Spring AIä¸­çš„å¤šè½®å¯¹è¯è‰ºæœ¯ï¼šè®©å¤§æ¨¡å‹ä¸»åŠ¨æé—®è·å–æ˜ç¡®éœ€æ±‚</a></p>
</blockquote>
<p>åœ¨æ—¥å¸¸æˆ‘ä»¬ä¸å¤§æ¨¡å‹äº¤äº’çš„è¿‡ç¨‹ä¸­ï¼Œé€šå¸¸æ˜¯æˆ‘è¾“å…¥ä¸€ä¸ªé—®é¢˜æˆ–è€…åœºæ™¯è¦æ±‚ï¼Œç„¶åå¤§æ¨¡å‹åŸºäºæˆ‘ç»™å‡ºçš„ä¿¡æ¯è¿›è¡Œç”Ÿæˆå†…å®¹ã€‚è¿™ç§æ–¹å¼å¾ˆå®¹æ˜“å‡ºç°ä¸€ä¸ªç­”éæ‰€é—®çš„åœºæ™¯ï¼ˆå¥½åƒå¤§æ¨¡å‹å¹¶ä¸èƒ½æ€»æ˜¯å›ç­”åˆ°æˆ‘çš„å¿ƒè¶´ä¸ŠğŸ¤£ï¼‰</p>
<p>é‚£ä¹ˆæœ‰ä»€ä¹ˆå¥½çš„è§£å†³åŠæ³•å—ï¼Ÿ</p>
<p>ç†Ÿç»ƒè°ƒæ•™å¤§æ¨¡å‹çš„å°ä¼™ä¼´ï¼Œå¯èƒ½æ—©å°±æœ‰è‡ªå·±çš„ä¸€å¥—æ ‡å‡†æµç¨‹äº† -- é€šè¿‡å¤šæ¬¡ä¸å¤§æ¨¡å‹ä¹‹é—´çš„å¤šæ¬¡é—®è¯¢å›ç­”ï¼Œè®©å¤§æ¨¡å‹èƒ½æ›´æ¸…æ™°çš„çŸ¥é“è‡ªå·±çš„è¯‰æ±‚</p>
<p>é‚£ä¹ˆå¦‚ä½•è®©AIä¸»åŠ¨é—®è¯¢ç”¨æˆ·æ¥è·å–æ›´ç²¾ç¡®çš„ä¿¡æ¯å‘¢ï¼Ÿå¦‚æœæˆ‘å¼€å‘çš„å¤§æ¨¡å‹åº”ç”¨ï¼Œå¸Œæœ›é›†æˆè¿™æ ·çš„èƒ½åŠ›ï¼Œåˆå¯ä»¥æ€ä¹ˆå®ç°å‘¢ï¼Ÿ</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹ï¼ŒSpringAIä¸­ï¼Œå¦‚ä½•é€šè¿‡å·§å¦™çš„å¤šè½®å¯¹è¯è‰ºæœ¯ï¼Œæ¥å®ç°è®©å¤§æ¨¡å‹ä¸»åŠ¨æé—®è·å–æ˜ç¡®éœ€æ±‚</p>
<h3 data-id="heading-1">ä¸€ã€æ–¹æ¡ˆè®¾è®¡</h3>
<h4 data-id="heading-2">1.1 æ ¸å¿ƒé—®é¢˜</h4>
<p>åœ¨æˆ‘ä»¬è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæ ¸å¿ƒçš„é—®é¢˜ç‚¹åœ¨äº <strong>å¦‚ä½•è®©å¤§æ¨¡å‹åœ¨é¢å¯¹æ¨¡ç³Šéœ€æ±‚æ—¶ï¼Œèƒ½å¤Ÿä¸»åŠ¨å‘èµ·è¯¢é—®ï¼Œè·å–æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œä»è€Œæä¾›æ›´ç²¾å‡†çš„å“åº”ã€‚</strong></p>
<p>å¸¸è§çš„å®ç°ä¸­ï¼Œå­˜åœ¨çš„é—®é¢˜å¦‚ä¸‹ï¼š</p>
<ul>
<li>å•æ¬¡äº¤äº’è¯•å›¾è§£å†³å¤æ‚é—®é¢˜</li>
<li>å¯¹æ¨¡ç³Šè¾“å…¥ä¸åšå¤„ç†ç›´æ¥å“åº”</li>
<li>ç¼ºå°‘å¤šè½®å¯¹è¯çš„çŠ¶æ€ç®¡ç†</li>
</ul>
<p>è¿™äº›é—®é¢˜çš„æ ¹æœ¬åŸå› åœ¨äºæ²¡æœ‰å»ºç«‹èµ·AIä¸ç”¨æˆ·ä¹‹é—´çš„æœ‰æ•ˆåé¦ˆå¾ªç¯ï¼Œå¯¼è‡´å¤§æ¨¡å‹æ— æ³•è·å–è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä½†æ˜¯å¯¹äºå¤§æ¨¡å‹è€Œè¨€ï¼Œå“åº”å†…å®¹æ˜¯å¯¹å®ƒçš„ä¸€ä¸ªéå¸¸é‡è¦çš„è€ƒé‡æŒ‡æ ‡ï¼Œæ‰€ä»¥å°±å¾ˆå®¹å‡ºç°å¤§æ¨¡å‹<code>è¯è¯´å…«é“</code> <code>ç­”éæ‰€é—®</code>ç­‰å¹»è§‰é‚£é—®é¢˜</p>
<h4 data-id="heading-3">1.2 ä¸»åŠ¨é—®è¯¢è®¾è®¡</h4>
<blockquote>
<p>å¥½çš„è®¾è®¡åº”è¯¥ä¸»åŠ¨é€‚åº”ç”¨æˆ·ï¼Œè€Œä¸æ˜¯è®©ç”¨æˆ·é€‚åº”è®¾è®¡ã€‚</p>
</blockquote>
<p>å¾ˆå¤šäººè®¤ä¸ºå¤§æ¨¡å‹åªèƒ½è¢«åŠ¨æ¥æ”¶è¾“å…¥ï¼Œå®é™…ä¸Š <code>Spring AI</code> æä¾›äº† <code>AskUserQuestionTool</code> è¿™ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œè®©AIèƒ½å¤Ÿä¸»åŠ¨å‘ç”¨æˆ·æå‡ºé—®é¢˜ã€‚</p>
<p>å®ƒæ˜¯é€šè¿‡ä»€ä¹ˆå®ç°çš„å‘¢ï¼Ÿå¯ä»¥çœ‹ä¸‹é¢è¿™å¼ å›¾</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/594ea809f72c42a4a2428ae4980a072e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA54Gw54Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770771616&amp;x-signature=ey6meq8ehHSd3pNPWjgKgxmyIpY%3D" alt="æ ¸å¿ƒå®ç°æµç¨‹" loading="lazy"/></p>
<ul>
<li>é€šè¿‡Function Callbackæ¥å®ç°ï¼Œå°†<code>AskUserQuestionTool</code>æ³¨å†Œä¸ºå¤§æ¨¡å‹å¯å›è°ƒä½¿ç”¨çš„å·¥å…·ï¼Œé€šè¿‡è¿™ä¸ªå·¥å…·æ¥å®ç°å¤šè½®é—®è¯¢åº”ç­”</li>
</ul>
<p>ä¸‹é¢æ˜¯è¿™ä¸ªå·¥å…·çš„æ ¸å¿ƒå®šä¹‰:</p>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AskUserQuestionTool</span> {
    <span class="hljs-meta">@Tool(
        name = "AskUserQuestionTool",
        description = "Use this tool when you need to ask the user questions during execution. This allows you to:\n1. Gather user preferences or requirements\n2. Clarify ambiguous instructions\n3. Get decisions on implementation choices as you work\n4. Offer choices to the user about what direction to take.\n\nUsage notes:\n- Users will always be able to select \"Other\" to provide custom text input\n- Use multiSelect: true to allow multiple answers to be selected for a question\n- If you recommend a specific option, make that the first option in the list and add \"(Recommended)\" at the end of the label\n"
    )</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">askUserQuestion</span><span class="hljs-params">(<span class="hljs-meta">@ToolParam(description = "Questions to ask the user (1-4 questions)")</span> List&lt;Question&gt; questions, <span class="hljs-meta">@ToolParam(description = "User answers collected by the permission component",required = false)</span> Map&lt;String, String&gt; answers)</span> {
        <span class="hljs-built_in">this</span>.validateQuestions(questions);
        <span class="hljs-comment">// çœç•¥...</span>
    }
}
</code></pre>
<p>é‡ç‚¹çœ‹ä¸€ä¸‹è¿™ä¸ªå·¥å…·çš„æè¿°ï¼Œå°†å…¶ç¿»è¯‘æˆä¸­æ–‡ï¼Œå†…å®¹å¦‚ä¸‹</p>
<pre><code class="hljs language-txt" lang="txt">åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­éœ€è¦å‘ç”¨æˆ·æé—®æ—¶ï¼Œè¯·ä½¿ç”¨æ­¤å·¥å…·ã€‚è¿™ä½¿æ‚¨èƒ½å¤Ÿï¼š
1. æ”¶é›†ç”¨æˆ·åå¥½æˆ–éœ€æ±‚
2. æ˜ç¡®å«ç³Šä¸æ¸…çš„æŒ‡ä»¤
3. åœ¨å·¥ä½œä¸­å°±å®æ–½é€‰æ‹©åšå‡ºå†³ç­–
4. å‘ç”¨æˆ·æä¾›é€‰æ‹©ï¼Œè®©ä»–ä»¬å†³å®šè¦é‡‡å–çš„æ–¹å‘ã€‚

ä½¿ç”¨é¡»çŸ¥ï¼š
- ç”¨æˆ·å§‹ç»ˆå¯ä»¥é€‰æ‹©â€œå…¶ä»–â€æ¥æä¾›è‡ªå®šä¹‰æ–‡æœ¬è¾“å…¥
- ä½¿ç”¨multiSelect: trueï¼Œå…è®¸ä¸€ä¸ªé—®é¢˜æœ‰å¤šä¸ªç­”æ¡ˆé€‰é¡¹
- å¦‚æœä½ æ¨èäº†ä¸€ä¸ªç‰¹å®šé€‰é¡¹ï¼Œè¯·å°†å…¶ä½œä¸ºåˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªé€‰é¡¹ï¼Œå¹¶åœ¨æ ‡ç­¾æœ«å°¾åŠ ä¸Šâ€œï¼ˆæ¨èï¼‰â€
</code></pre>
<p>åœ¨è¿™ä¸ªå·¥å…·ç±»ä¸­ï¼Œé€šè¿‡å·§å¦™çš„è®¾è®¡ï¼Œå‘Šè¯‰å¤§æ¨¡å‹åœ¨å…·ä½“å“åº”ä¹‹å‰ï¼Œå¯ä»¥å…ˆè¿›è¡Œç”¨æˆ·é—®è¯¢</p>
<ul>
<li>å¤§æ¨¡å‹å°†éœ€è¦é—®è¯¢çš„å†…å®¹ï¼Œè½¬æ¢ä¸ºç»“æ„åŒ–çš„ <code>List&lt;Question&gt;</code></li>
<li>é€šè¿‡è®¾è®¡ä¸€ä¸ª<code>QuestionHandler</code>æ¥å¤„ç†å…·ä½“çš„ç”¨æˆ·é—®ç­”äº¤äº’æµç¨‹ï¼Œé€šè¿‡è´£ä»»åˆ†ç¦»çš„è®¾è®¡æ€æƒ³ï¼ŒAIè´Ÿè´£å†³å®šä½•æ—¶æé—®ï¼Œå…·ä½“çš„UIäº¤äº’ç”±å¼€å‘è€…è‡ªå®šä¹‰ã€‚ä½ å¯ä»¥å°†å…¶é€‚é…åˆ°Webç•Œé¢ã€ç§»åŠ¨ç«¯æˆ–ä»»ä½•å…¶ä»–å¹³å°ã€‚</li>
</ul>
<p>å› æ­¤å…·ä½“çš„é—®è¯¢åº”ç­”æ–¹å¼ï¼Œå®Œå…¨æ˜¯ç”±åº”ç”¨æ–¹ï¼ˆå³å¼€å‘è€…ï¼‰æ¥æ§åˆ¶çš„</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¿›å…¥å®æˆ˜æ¼”ç»ƒï¼Œçœ‹çœ‹å¦‚ä½•å®ç°è¿™æ ·çš„ä¸€ä¸ªå¤šè½®é—®è¯¢</p>
<h3 data-id="heading-4">äºŒã€é¡¹ç›®åˆ›å»º</h3>
<h4 data-id="heading-5">2.1 åŸºç¡€ç¯å¢ƒè¦æ±‚</h4>
<p>è¦ä½“éªŒSpringAIçš„é—®è¯¢æœºåˆ¶ï¼Œç›®å‰éœ€è¦å‡çº§åˆ°SpringAI 2.xç‰ˆæœ¬ï¼ŒåŒæ—¶æˆ‘ä»¬çš„SpringBootä¹Ÿå¯ä»¥å‡çº§åˆ°4.x</p>
<ul>
<li>SpringAI: 2.0.0-M2</li>
<li>SpringBoot: 4.0.1</li>
<li>JDK21/17ï¼šè¿™ä¸¤ç‰ˆæœ¬éƒ½å¯ä»¥</li>
</ul>
<p>é™¤äº†è¿™å‡ ä¸ªåŸºæœ¬ä¾èµ–ä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸€ä¸ªæ”¯æŒFunction Toolçš„å¤§æ¨¡å‹æ¥ä½œä¸ºè¿™ä¸ªå®ç°çš„å¤§è„‘ä¸­æ¢</p>
<p>æˆ‘ä»¬è¿™é‡Œé€‰æ‹©æ™ºè°±çš„å¤§æ¨¡å‹<code>GLM-4.5-Flash</code> ï¼ˆåŸå› å°±æ˜¯å› ä¸ºå®ƒå…è´¹ï¼Œä¸”æ•ˆæœè¿˜è¡Œï¼Œå¯¹æ‰€æœ‰æƒ³ä½“éªŒçš„å°ä¼™ä¼´æ²¡æœ‰ä»»ä½•é¢å¤–æˆæœ¬æŠ•å…¥ï¼‰</p>
<h4 data-id="heading-6">2.2 é¡¹ç›®åˆ›å»º</h4>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªSpringAIåº”ç”¨ï¼Œå¯¹äºä¸€ä¸ªæ ‡å‡†çš„SpringAIåº”ç”¨ï¼Œåœ¨<code>pom.xml</code>é…ç½®ä¸­ï¼Œä½ ä¼šçœ‹åˆ°ä¸‹é¢è¿™äº›åŸºç¡€ç‰ˆæœ¬æŒ‡å®šï¼Œè¿™ä¸ªä¹Ÿæ²¡ä»€ä¹ˆå¥½è¯´çš„</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.0.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span> /&gt;</span> 
<span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>21<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>21<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">spring-ai.version</span>&gt;</span>2.0.0-M2<span class="hljs-tag">&lt;/<span class="hljs-name">spring-ai.version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>


<span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-bom<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${spring-ai.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">repositories</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>spring-snapshots<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Spring Snapshots<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://repo.spring.io/snapshot<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">releases</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">enabled</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">enabled</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">releases</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Central Portal Snapshots<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>central-portal-snapshots<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://central.sonatype.com/repository/maven-snapshots/<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">releases</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">enabled</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">enabled</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">releases</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">snapshots</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">enabled</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">enabled</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">snapshots</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">repositories</span>&gt;</span>
</code></pre>
<p>æ¥ä¸‹æ¥é‡ç‚¹çœ‹ä¸€ä¸‹æˆ‘ä»¬è¿™ä¸ªé¡¹ç›®æ‰€ç”¨åˆ°çš„å‡ ä¸ªæ ¸å¿ƒä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springaicommunity<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-agent-utils<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.4.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-starter-model-zhipuai<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<ul>
<li>spring-ai-agent-utils: è¿™ä¸ªå°±æ˜¯SpringAIè¿›è¡Œagentå¼€å‘çš„å…³é”®ä¾èµ–åŒ…</li>
<li>spring-ai-starter-model-zhipuai: è¿™ä¸ªæ˜¯æ™ºè°±å¤§æ¨¡å‹è¿›è¡Œäº¤äº’çš„ä¾èµ–åŒ…</li>
</ul>
<h4 data-id="heading-7">2.3 é¡¹ç›®é…ç½®</h4>
<p>ä¾èµ–æå®šä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œé…ç½®LLMè®¿é—®çš„ç›¸å…³ä¿¡æ¯ã€ä»¥åŠagentç›¸å…³é…ç½®å‚æ•°ï¼Œå¯¹åº”çš„é…ç½®æ–‡ä»¶ <code>resources/application.yml</code></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">ai:</span>
    <span class="hljs-attr">zhipuai:</span>
      <span class="hljs-comment"># api-key ä½¿ç”¨ä½ è‡ªå·±ç”³è¯·çš„è¿›è¡Œæ›¿æ¢ï¼›å¦‚æœä¸ºäº†å®‰å…¨è€ƒè™‘ï¼Œå¯ä»¥é€šè¿‡å¯åŠ¨å‚æ•°è¿›è¡Œè®¾ç½®</span>
      <span class="hljs-attr">api-key:</span> <span class="hljs-string">${zhipuai-api-key}</span>
      <span class="hljs-attr">chat:</span> <span class="hljs-comment"># èŠå¤©æ¨¡å‹</span>
        <span class="hljs-attr">options:</span>
          <span class="hljs-attr">model:</span> <span class="hljs-string">GLM-4.7-Flash</span>
</code></pre>
<h3 data-id="heading-8">ä¸‰ã€æ ¸å¿ƒå®ç°</h3>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¿›è¡Œå¿«é€Ÿä½“éªŒï¼Œé¦–å…ˆä¸ºäº†æ›´å¥½çš„è§‚å¯Ÿåº”ç”¨ä¸å¤§æ¨¡å‹ä¹‹é—´çš„äº¤äº’ï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ª<code>LoggingAdvisor</code></p>
<h4 data-id="heading-9">3.1 äº¤äº’æ—¥å¿—æ‰“å°ï¼š MyLoggingAdvisor</h4>
<blockquote>
<p>è¯´æ˜ï¼šè¿™ä¸ªå®ç°éå¿…éœ€ï¼Œä¸æ„Ÿå…´è¶£çš„ç›´æ¥è·³è¿‡</p>
</blockquote>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyLoggingAdvisor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">BaseAdvisor</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> order;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> showSystemMessage;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> showAvailableTools;

    <span class="hljs-keyword">private</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">cnt</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(<span class="hljs-number">1</span>);

    <span class="hljs-keyword">private</span> <span class="hljs-title function_">MyLoggingAdvisor</span><span class="hljs-params">(<span class="hljs-type">int</span> order, <span class="hljs-type">boolean</span> showSystemMessage, <span class="hljs-type">boolean</span> showAvailableTools)</span> {
        <span class="hljs-built_in">this</span>.order = order;
        <span class="hljs-built_in">this</span>.showSystemMessage = showSystemMessage;
        <span class="hljs-built_in">this</span>.showAvailableTools = showAvailableTools;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getOrder</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.order;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> ChatClientRequest <span class="hljs-title function_">before</span><span class="hljs-params">(ChatClientRequest chatClientRequest, AdvisorChain advisorChain)</span> {
        System.out.println(<span class="hljs-string">"======================= ç¬¬ "</span> + cnt.getAndAdd(<span class="hljs-number">1</span>) + <span class="hljs-string">" è½® ===================================="</span>);

        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(<span class="hljs-string">"\nUSER: "</span>);

        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.showSystemMessage &amp;&amp; chatClientRequest.prompt().getSystemMessage() != <span class="hljs-literal">null</span>) {
            sb.append(<span class="hljs-string">"\n - SYSTEM: "</span>).append(first(chatClientRequest.prompt().getSystemMessage().getText(), <span class="hljs-number">300</span>));
        }

        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.showAvailableTools) {
            <span class="hljs-type">Object</span> <span class="hljs-variable">tools</span> <span class="hljs-operator">=</span> <span class="hljs-string">"No Tools"</span>;

            <span class="hljs-keyword">if</span> (chatClientRequest.prompt().getOptions() <span class="hljs-keyword">instanceof</span> ToolCallingChatOptions toolOptions) {
                tools = toolOptions.getToolCallbacks().stream().map(tc -&gt; tc.getToolDefinition().name()).toList();
            }

            sb.append(<span class="hljs-string">"\n - TOOLS: "</span>).append(ModelOptionsUtils.toJsonString(tools));
        }

        <span class="hljs-type">Message</span> <span class="hljs-variable">lastMessage</span> <span class="hljs-operator">=</span> chatClientRequest.prompt().getLastUserOrToolResponseMessage();

        <span class="hljs-keyword">if</span> (lastMessage.getMessageType() == MessageType.TOOL) {
            <span class="hljs-type">ToolResponseMessage</span> <span class="hljs-variable">toolResponseMessage</span> <span class="hljs-operator">=</span> (ToolResponseMessage) lastMessage;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> toolResponse : toolResponseMessage.getResponses()) {
                <span class="hljs-type">var</span> <span class="hljs-variable">tr</span> <span class="hljs-operator">=</span> toolResponse.name() + <span class="hljs-string">": "</span> + first(toolResponse.responseData(), <span class="hljs-number">1000</span>);
                sb.append(<span class="hljs-string">"\n - TOOL-RESPONSE: "</span>).append(tr);
            }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (lastMessage.getMessageType() == MessageType.USER) {
            <span class="hljs-keyword">if</span> (StringUtils.hasText(lastMessage.getText())) {
                sb.append(<span class="hljs-string">"\n - TEXT: "</span>).append(first(lastMessage.getText(), <span class="hljs-number">1000</span>));
            }
        }

        System.out.println(<span class="hljs-string">"before: "</span> + sb);
        <span class="hljs-keyword">return</span> chatClientRequest;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> ChatClientResponse <span class="hljs-title function_">after</span><span class="hljs-params">(ChatClientResponse chatClientResponse, AdvisorChain advisorChain)</span> {
        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">sb</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(<span class="hljs-string">"\nASSISTANT: "</span>);

        <span class="hljs-keyword">if</span> (chatClientResponse.chatResponse() == <span class="hljs-literal">null</span> || chatClientResponse.chatResponse().getResults() == <span class="hljs-literal">null</span>) {
            sb.append(<span class="hljs-string">" No chat response "</span>);
            System.out.println(<span class="hljs-string">"after: "</span> + sb);
            <span class="hljs-keyword">return</span> chatClientResponse;
        }

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> generation : chatClientResponse.chatResponse().getResults()) {
            <span class="hljs-type">var</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> generation.getOutput();
            <span class="hljs-keyword">if</span> (message.getToolCalls() != <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> toolCall : message.getToolCalls()) {
                    sb.append(<span class="hljs-string">"\n - TOOL-CALL: "</span>)
                            .append(toolCall.name())
                            .append(<span class="hljs-string">" ("</span>)
                            .append(toolCall.arguments())
                            .append(<span class="hljs-string">")"</span>);
                }
            }

            <span class="hljs-keyword">if</span> (message.getText() != <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">if</span> (StringUtils.hasText(message.getText())) {
                    sb.append(<span class="hljs-string">"\n - TEXT: "</span>).append(first(message.getText(), <span class="hljs-number">1200</span>));
                }
            }
        }

        System.out.println(<span class="hljs-string">"after: "</span> + sb);
        <span class="hljs-keyword">return</span> chatClientResponse;
    }

    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">first</span><span class="hljs-params">(String text, <span class="hljs-type">int</span> n)</span> {
        <span class="hljs-keyword">if</span> (text.length() &lt;= n) {
            <span class="hljs-keyword">return</span> text;
        }
        <span class="hljs-keyword">return</span> text.substring(<span class="hljs-number">0</span>, n) + <span class="hljs-string">"..."</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Builder <span class="hljs-title function_">builder</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Builder</span>();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Builder</span> {

        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

        <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">showSystemMessage</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;

        <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">showAvailableTools</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;

        <span class="hljs-keyword">public</span> Builder <span class="hljs-title function_">order</span><span class="hljs-params">(<span class="hljs-type">int</span> order)</span> {
            <span class="hljs-built_in">this</span>.order = order;
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
        }

        <span class="hljs-keyword">public</span> Builder <span class="hljs-title function_">showSystemMessage</span><span class="hljs-params">(<span class="hljs-type">boolean</span> showSystemMessage)</span> {
            <span class="hljs-built_in">this</span>.showSystemMessage = showSystemMessage;
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
        }

        <span class="hljs-keyword">public</span> Builder <span class="hljs-title function_">showAvailableTools</span><span class="hljs-params">(<span class="hljs-type">boolean</span> showAvailableTools)</span> {
            <span class="hljs-built_in">this</span>.showAvailableTools = showAvailableTools;
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;
        }

        <span class="hljs-keyword">public</span> MyLoggingAdvisor <span class="hljs-title function_">build</span><span class="hljs-params">()</span> {
            <span class="hljs-type">MyLoggingAdvisor</span> <span class="hljs-variable">advisor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyLoggingAdvisor</span>(<span class="hljs-built_in">this</span>.order, <span class="hljs-built_in">this</span>.showSystemMessage,
                    <span class="hljs-built_in">this</span>.showAvailableTools);
            <span class="hljs-keyword">return</span> advisor;
        }
    }

}
</code></pre>
<h4 data-id="heading-10">3.2 å‘½ä»¤è¡Œçš„é—®è¯¢åº”ç­”å®ç°ï¼šCommandLineQuestionHandler</h4>
<p>åœ¨å‰é¢çš„è®¾è®¡ç¯‡ä¸­ä»‹ç»äº†<code>AskUserQuestionTool</code>ä¸­ï¼Œè®¾è®¡äº†ä¸€ä¸ªæ‰©å±•ç‚¹ <code>QuestionHandler</code> ç”±ä½¿ç”¨è€…æ¥å®ç°å…·ä½“çš„é—®ç­”äº¤äº’æ–¹æ¡ˆï¼Œå› æ­¤æˆ‘ä»¬å…ˆå®ç°ä¸€ä¸ªåŸºç¡€çš„åŸºäºå‘½ä»¤è¡Œçš„é—®ç­”</p>
<ul>
<li><code>CommandLineQuestionHandler</code>ï¼šå®ç°<code>QuestionHandler</code>æ¥å£ï¼Œå¤„ç†ç”¨æˆ·é—®é¢˜åˆ—è¡¨</li>
<li><code>handle</code>æ–¹æ³•ï¼šéå†é—®é¢˜ï¼Œæ˜¾ç¤ºé€‰é¡¹ä¾›ç”¨æˆ·é€‰æ‹©ï¼Œæ”¯æŒå•é€‰/å¤šé€‰æ¨¡å¼</li>
<li><code>parseResponse</code>æ–¹æ³•ï¼šè§£æç”¨æˆ·è¾“å…¥ï¼Œå°†æ•°å­—ç¼–å·è½¬æ¢ä¸ºå¯¹åº”é€‰é¡¹æ ‡ç­¾ï¼Œæˆ–ç›´æ¥è¿”å›è‡ªå®šä¹‰æ–‡æœ¬ç­”æ¡ˆ</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å‘½ä»¤è¡Œé—®é¢˜å¤„ç†å™¨ï¼Œå®ç° AskUserQuestionTool.QuestionHandler æ¥å£
 * ç”¨äºå¤„ç†AIå·¥å…·å‘ç”¨æˆ·æå‡ºçš„é—®é¢˜ï¼Œæ”¯æŒå•é€‰ã€å¤šé€‰å’Œè‡ªå®šä¹‰æ–‡æœ¬è¾“å…¥
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CommandLineQuestionHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AskUserQuestionTool</span>.QuestionHandler {

    <span class="hljs-comment">/**
     * å¤„ç†ä¼ å…¥çš„é—®é¢˜åˆ—è¡¨ï¼Œé€ä¸ªæ˜¾ç¤ºé—®é¢˜å’Œé€‰é¡¹ï¼Œæ”¶é›†ç”¨æˆ·è¾“å…¥çš„ç­”æ¡ˆ
     *
     * <span class="hljs-doctag">@param</span> questions éœ€è¦å¤„ç†çš„é—®é¢˜åˆ—è¡¨
     * <span class="hljs-doctag">@return</span> åŒ…å«é—®é¢˜å’Œå¯¹åº”ç­”æ¡ˆçš„æ˜ å°„è¡¨
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Map&lt;String, String&gt; <span class="hljs-title function_">handle</span><span class="hljs-params">(List&lt;AskUserQuestionTool.Question&gt; questions)</span> {
        Map&lt;String, String&gt; answers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();

        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);

        <span class="hljs-keyword">for</span> (AskUserQuestionTool.Question q : questions) {
            <span class="hljs-comment">// æ˜¾ç¤ºé—®é¢˜æ ‡é¢˜å’Œå†…å®¹</span>
            System.out.println(<span class="hljs-string">"\n"</span> + q.header() + <span class="hljs-string">": "</span> + q.question());

            <span class="hljs-comment">// è·å–å¹¶æ˜¾ç¤ºé€‰é¡¹</span>
            List&lt;AskUserQuestionTool.Question.Option&gt; options = q.options();
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; options.size(); i++) {
                AskUserQuestionTool.Question.<span class="hljs-type">Option</span> <span class="hljs-variable">opt</span> <span class="hljs-operator">=</span> options.get(i);
                System.out.printf(<span class="hljs-string">"  %d. %s - %s%n"</span>, i + <span class="hljs-number">1</span>, opt.label(), opt.description());
            }

            <span class="hljs-comment">// æ ¹æ®æ˜¯å¦ä¸ºå¤šé€‰æ˜¾ç¤ºæç¤ºä¿¡æ¯</span>
            <span class="hljs-keyword">if</span> (q.multiSelect()) {
                System.out.println(<span class="hljs-string">"  (Enter numbers separated by commas, or type custom text)"</span>);
            } <span class="hljs-keyword">else</span> {
                System.out.println(<span class="hljs-string">"  (Enter a number, or type custom text)"</span>);
            }

            <span class="hljs-comment">// è¯»å–ç”¨æˆ·è¾“å…¥å¹¶è§£æç­”æ¡ˆ</span>
            <span class="hljs-type">String</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> scanner.nextLine().trim();
            answers.put(q.question(), parseResponse(response, options));
        }

        <span class="hljs-keyword">return</span> answers;
    }

    <span class="hljs-comment">/**
     * è§£æç”¨æˆ·è¾“å…¥çš„å“åº”ï¼Œæ ¹æ®é€‰é¡¹ç´¢å¼•æˆ–è‡ªå®šä¹‰æ–‡æœ¬è¿”å›å¯¹åº”çš„å€¼
     *
     * <span class="hljs-doctag">@param</span> response ç”¨æˆ·è¾“å…¥çš„åŸå§‹å­—ç¬¦ä¸²
     * <span class="hljs-doctag">@param</span> options  å¯ç”¨çš„é€‰é¡¹åˆ—è¡¨
     * <span class="hljs-doctag">@return</span> è§£æåçš„ç­”æ¡ˆå­—ç¬¦ä¸²
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">parseResponse</span><span class="hljs-params">(String response, List&lt;AskUserQuestionTool.Question.Option&gt; options)</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// å°è¯•å°†è¾“å…¥è§£æä¸ºé€‰é¡¹ç¼–å·ï¼ˆæ”¯æŒå¤šä¸ªé€‰é¡¹ï¼‰</span>
            String[] parts = response.split(<span class="hljs-string">","</span>);
            List&lt;String&gt; labels = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
            <span class="hljs-keyword">for</span> (String part : parts) {
                <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> Integer.parseInt(part.trim()) - <span class="hljs-number">1</span>;
                <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span> &amp;&amp; index &lt; options.size()) {
                    labels.add(options.get(index).label());
                }
            }
            <span class="hljs-comment">// å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„é€‰é¡¹ç¼–å·ï¼Œåˆ™è¿”å›åŸå§‹è¾“å…¥ï¼›å¦åˆ™è¿”å›é€‰é¡¹æ ‡ç­¾çš„ç»„åˆ</span>
            <span class="hljs-keyword">return</span> labels.isEmpty() ? response : String.join(<span class="hljs-string">", "</span>, labels);
        } <span class="hljs-keyword">catch</span> (NumberFormatException e) {
            <span class="hljs-comment">// å¦‚æœè¾“å…¥ä¸æ˜¯æ•°å­—ï¼Œåˆ™å°†å…¶è§†ä¸ºè‡ªç”±æ–‡æœ¬</span>
            <span class="hljs-keyword">return</span> response;
        }
    }
}
</code></pre>
<h4 data-id="heading-11">3.3 é—®è¯¢å¯¹è¯å®ç°</h4>
<p>åˆ›å»ºä¸€ä¸ªç®€æ˜“èŠå¤©å®¢æˆ·ç«¯ï¼Œé…ç½®äº†ä¸‰ä¸ªAdvisorï¼šå·¥å…·è°ƒç”¨é¡¾é—®ã€æ¶ˆæ¯è®°å¿†é¡¾é—®å’Œè‡ªå®šä¹‰æ—¥å¿—é¡¾é—®ï¼ˆéšè—å¯ç”¨å·¥å…·å’Œç³»ç»Ÿæ¶ˆæ¯ï¼‰ã€‚</p>
<p>ç„¶åå¯åŠ¨ä¸€ä¸ªå‘½ä»¤è¡Œå¾ªç¯ï¼Œç”¨æˆ·è¾“å…¥é—®é¢˜åé€šè¿‡èŠå¤©å®¢æˆ·ç«¯å¤„ç†å¹¶è¾“å‡ºAIåŠ©æ‰‹çš„å›ç­”</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Bean</span>
CommandLineRunner <span class="hljs-title function_">commandLineRunner</span><span class="hljs-params">(ChatClient.Builder chatClientBuilder)</span> <span class="hljs-keyword">throws</span> IOException {
    <span class="hljs-keyword">return</span> args -&gt; {
        <span class="hljs-comment">// æ„å»ºChatClientå®ä¾‹ï¼Œé…ç½®æ‰€éœ€çš„å·¥å…·å’Œé¡¾é—®</span>
        <span class="hljs-type">ChatClient</span> <span class="hljs-variable">chatClient</span> <span class="hljs-operator">=</span> chatClientBuilder
                <span class="hljs-comment">// è®¾ç½®é»˜è®¤å·¥å…·ï¼Œè¿™é‡Œä½¿ç”¨AskUserQuestionToolï¼Œå®ƒå…è®¸AIå‘ç”¨æˆ·æé—®</span>
                .defaultTools(AskUserQuestionTool.builder()
                        <span class="hljs-comment">// ä½¿ç”¨å‘½ä»¤è¡Œé—®é¢˜å¤„ç†å™¨æ¥å¤„ç†AIå‘ç”¨æˆ·æå‡ºçš„é—®é¢˜</span>
                        .questionHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CommandLineQuestionHandler</span>())
                        .build())

                <span class="hljs-comment">// é…ç½®é»˜è®¤çš„é¡¾é—®ï¼ˆæ‹¦æˆªå™¨ï¼‰ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œ</span>
                .defaultAdvisors(
                        <span class="hljs-comment">// å·¥å…·è°ƒç”¨é¡¾é—®ï¼šå¤„ç†å·¥å…·è°ƒç”¨é€»è¾‘</span>
                        ToolCallAdvisor.builder().conversationHistoryEnabled(<span class="hljs-literal">false</span>).build(),
                        
                        <span class="hljs-comment">// æ¶ˆæ¯è®°å¿†é¡¾é—®ï¼šç»´æŠ¤å¯¹è¯å†å²ï¼Œä½¿ç”¨æ¶ˆæ¯çª—å£èŠå¤©è®°å¿†</span>
                        <span class="hljs-comment">// ä½äºå·¥å…·è°ƒç”¨é¡¾é—®ä¹‹åï¼Œä»¥ç¡®ä¿èƒ½å¤Ÿè®°ä½å·¥å…·è°ƒç”¨ç»“æœ</span>
                        MessageChatMemoryAdvisor.builder(
                            MessageWindowChatMemory.builder()
                                .maxMessages(<span class="hljs-number">500</span>)  <span class="hljs-comment">// æœ€å¤šä¿å­˜500æ¡æ¶ˆæ¯</span>
                                .build())
                        .build(),
                        
                        <span class="hljs-comment">// è‡ªå®šä¹‰æ—¥å¿—é¡¾é—®ï¼šè®°å½•å¯¹è¯è¿‡ç¨‹ï¼Œå¯æ§åˆ¶æ˜¯å¦æ˜¾ç¤ºå¯ç”¨å·¥å…·å’Œç³»ç»Ÿæ¶ˆæ¯</span>
                        MyLoggingAdvisor.builder()
                                .showAvailableTools(<span class="hljs-literal">true</span>)   <span class="hljs-comment">// æ˜¾ç¤ºå¯ç”¨å·¥å…·åˆ—è¡¨</span>
                                .showSystemMessage(<span class="hljs-literal">true</span>)    <span class="hljs-comment">// æ˜¾ç¤ºç³»ç»Ÿæ¶ˆæ¯</span>
                                .build())
                .build();

        <span class="hljs-comment">// å¯åŠ¨èŠå¤©å¾ªç¯çš„æç¤ºä¿¡æ¯</span>
        System.out.println(<span class="hljs-string">"\nI am your assistant.\n"</span>);

        <span class="hljs-comment">// ä½¿ç”¨try-with-resourcesç¡®ä¿Scannerèµ„æºå¾—åˆ°æ­£ç¡®é‡Šæ”¾</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in)) {
            <span class="hljs-comment">// æ— é™å¾ªç¯ï¼ŒæŒç»­æ¥æ”¶ç”¨æˆ·è¾“å…¥å¹¶è¿”å›AIå›å¤</span>
            <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
                System.out.print(<span class="hljs-string">"\n$-&gt;USER: "</span>);  <span class="hljs-comment">// æç¤ºç”¨æˆ·è¾“å…¥</span>
                
                <span class="hljs-comment">// è·å–ç”¨æˆ·è¾“å…¥ï¼Œé€šè¿‡chatClientå‘é€è¯·æ±‚ï¼ŒæŒ‡å®šå¯¹è¯IDï¼Œå¹¶è¾“å‡ºAIå›å¤</span>
                System.out.println(<span class="hljs-string">"\n$-&gt;ASSISTANT: "</span> + 
                        chatClient.prompt(scanner.nextLine())  <span class="hljs-comment">// å‘é€ç”¨æˆ·è¾“å…¥åˆ°AI</span>
                                .advisors(a -&gt; a.param(ChatMemory.CONVERSATION_ID, <span class="hljs-string">"113331"</span>))  <span class="hljs-comment">// è®¾ç½®å¯¹è¯IDä»¥ç»´æŠ¤ä¸Šä¸‹æ–‡</span>
                                .call().content());  <span class="hljs-comment">// æ‰§è¡Œè°ƒç”¨å¹¶è·å–AIå›å¤å†…å®¹</span>
            }
        }
    };
}
</code></pre>
<h4 data-id="heading-12">3.4 æµ‹è¯•éªŒè¯</h4>
<p>ç›´æ¥å¯åŠ¨é¡¹ç›®ï¼Œç„¶åå†æ§åˆ¶å°ä¸­è¾“å…¥æˆ‘çš„åŸå§‹è¯‰æ±‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/864eac3fbd7043a0948db1c2c339fa90~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA54Gw54Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770771616&amp;x-signature=uwWH9EvIUxlWsS1KvtWLzPeVC%2B4%3D" alt="" loading="lazy"/></p>
<p>ä¸‹é¢æ˜¯å®Œæ•´çš„æ–‡å­—ç‰ˆæœ¬è¾“å‡ºå†…å®¹</p>
<pre><code class="hljs language-bash" lang="bash">I am your assistant.


$-&gt;USER: æˆ‘å‡†å¤‡è®¾è®¡ä¸€å¼ é”¦é²¤ä¸»é¢˜çš„å¾®ä¿¡çº¢åŒ…å°é¢
======================= ç¬¬ 1 è½® ====================================
before: 
USER: 
 - SYSTEM: 
 - TOOLS: [<span class="hljs-string">"AskUserQuestionTool"</span>]
 - TEXT: æˆ‘å‡†å¤‡è®¾è®¡ä¸€å¼ é”¦é²¤ä¸»é¢˜çš„å¾®ä¿¡çº¢åŒ…å°é¢
after: 
ASSISTANT: 
 - TOOL-CALL: AskUserQuestionTool ({<span class="hljs-string">"questions"</span>:[{<span class="hljs-string">"header"</span>: <span class="hljs-string">"è®¾è®¡é£æ ¼"</span>, <span class="hljs-string">"multiSelect"</span>: <span class="hljs-literal">false</span>, <span class="hljs-string">"options"</span>: [{<span class="hljs-string">"description"</span>: <span class="hljs-string">"ç®€çº¦çº¿æ¡å’Œç°ä»£è‰²å½©ï¼Œé€‚åˆæ—¥å¸¸ä½¿ç”¨"</span>, <span class="hljs-string">"label"</span>: <span class="hljs-string">"ç®€çº¦ç°ä»£é£"</span>}, {<span class="hljs-string">"description"</span>: <span class="hljs-string">"ä¼ ç»Ÿæ°´å¢¨ç”»é£æ ¼ï¼Œå±•ç°å›½æ½®éŸµå‘³"</span>, <span class="hljs-string">"label"</span>: <span class="hljs-string">"å›½æ½®æ°´å¢¨é£"</span>}, {<span class="hljs-string">"description"</span>: <span class="hljs-string">"å¯çˆ±çš„å¡é€šå½¢è±¡ï¼Œæ´»æ³¼æœ‰è¶£"</span>, <span class="hljs-string">"label"</span>: <span class="hljs-string">"å¯çˆ±å¡é€šé£"</span>}, {<span class="hljs-string">"description"</span>: <span class="hljs-string">"é‡‘è‰²ä¸ºä¸»ï¼Œé…ä»¥ä¼ ç»Ÿçº¹æ ·ï¼Œæ˜¾å¾—é«˜çº§"</span>, <span class="hljs-string">"label"</span>: <span class="hljs-string">"é‡‘è‰²å¥¢åé£"</span>}], <span class="hljs-string">"question"</span>: <span class="hljs-string">"ä½ å¸Œæœ›çº¢åŒ…å°é¢çš„è®¾è®¡é£æ ¼æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"</span>}, {<span class="hljs-string">"header"</span>: <span class="hljs-string">"ä½¿ç”¨åœºæ™¯"</span>, <span class="hljs-string">"multiSelect"</span>: <span class="hljs-literal">true</span>, <span class="hljs-string">"options"</span>: [{<span class="hljs-string">"description"</span>: <span class="hljs-string">"æ–°å¹´ã€æ˜¥èŠ‚ç­‰ä¼ ç»ŸèŠ‚æ—¥"</span>, <span class="hljs-string">"label"</span>: <span class="hljs-string">"ä¼ ç»ŸèŠ‚æ—¥"</span>}, {<span class="hljs-string">"description"</span>: <span class="hljs-string">"å©šç¤¼ã€ç”Ÿæ—¥ã€åº†å…¸ç­‰å–œåº†åœºåˆ"</span>, <span class="hljs-string">"label"</span>: <span class="hljs-string">"å–œåº†åœºåˆ"</span>}, {<span class="hljs-string">"description"</span>: <span class="hljs-string">"æ—¥å¸¸é€ç¤¼ã€æœ‹å‹é—´äº’åŠ¨"</span>, <span class="hljs-string">"label"</span>: <span class="hljs-string">"æ—¥å¸¸äº’åŠ¨"</span>}, {<span class="hljs-string">"description"</span>: <span class="hljs-string">"å•†åŠ¡åœºåˆã€å®¢æˆ·å…³ç³»ç»´æŠ¤"</span>, <span class="hljs-string">"label"</span>: <span class="hljs-string">"å•†åŠ¡åœºåˆ"</span>}], <span class="hljs-string">"question"</span>: <span class="hljs-string">"è¿™ä¸ªçº¢åŒ…å°é¢ä¸»è¦ä¼šåœ¨ä»€ä¹ˆåœºåˆä½¿ç”¨ï¼Ÿ"</span>}, {<span class="hljs-string">"header"</span>: <span class="hljs-string">"é¢œè‰²åå¥½"</span>, <span class="hljs-string">"multiSelect"</span>: <span class="hljs-literal">false</span>, <span class="hljs-string">"options"</span>: [{<span class="hljs-string">"description"</span>: <span class="hljs-string">"çº¢è‰²ä¸ºä¸»ï¼Œé…é‡‘è‰²æˆ–ç™½è‰²"</span>, <span class="hljs-string">"label"</span>: <span class="hljs-string">"çº¢é‡‘é…è‰²"</span>}, {<span class="hljs-string">"description"</span>: <span class="hljs-string">"è“è‰²ä¸ºä¸»ï¼Œé…é‡‘è‰²æˆ–ç™½è‰²"</span>, <span class="hljs-string">"label"</span>: <span class="hljs-string">"è“é‡‘é…è‰²"</span>}, {<span class="hljs-string">"description"</span>: <span class="hljs-string">"çº¯è‰²èƒŒæ™¯ï¼Œç®€æ´å¤§æ–¹"</span>, <span class="hljs-string">"label"</span>: <span class="hljs-string">"å•è‰²èƒŒæ™¯"</span>}, {<span class="hljs-string">"description"</span>: <span class="hljs-string">"æ ¹æ®é”¦é²¤è‡ªç„¶è‰²å½©æ­é…"</span>, <span class="hljs-string">"label"</span>: <span class="hljs-string">"è‡ªç„¶è‰²å½©"</span>}], <span class="hljs-string">"question"</span>: <span class="hljs-string">"ä½ æ›´å€¾å‘äºä»€ä¹ˆé¢œè‰²æ­é…ï¼Ÿ"</span>}, {<span class="hljs-string">"header"</span>: <span class="hljs-string">"æ–‡å­—å†…å®¹"</span>, <span class="hljs-string">"multiSelect"</span>: <span class="hljs-literal">false</span>, <span class="hljs-string">"options"</span>: [{<span class="hljs-string">"description"</span>: <span class="hljs-string">"åªæ”¾é”¦é²¤å›¾æ¡ˆï¼Œç®€æ´å¤§æ–¹"</span>, <span class="hljs-string">"label"</span>: <span class="hljs-string">"çº¯å›¾æ¡ˆ"</span>}, {<span class="hljs-string">"description"</span>: <span class="hljs-string">"é”¦é²¤å›¾æ¡ˆ+ç®€å•ç¥ç¦è¯­"</span>, <span class="hljs-string">"label"</span>: <span class="hljs-string">"å›¾æ¡ˆ+ç¥ç¦è¯­"</span>}, {<span class="hljs-string">"description"</span>: <span class="hljs-string">"é”¦é²¤å›¾æ¡ˆ+å“ç‰Œæˆ–å…¬å¸ä¿¡æ¯"</span>, <span class="hljs-string">"label"</span>: <span class="hljs-string">"å›¾æ¡ˆ+æ–‡å­—"</span>}], <span class="hljs-string">"question"</span>: <span class="hljs-string">"çº¢åŒ…å°é¢æ˜¯å¦éœ€è¦æ·»åŠ æ–‡å­—å†…å®¹ï¼Ÿ"</span>}]})
 - TEXT: æˆ‘æ¥å¸®ä½ è®¾è®¡é”¦é²¤ä¸»é¢˜çš„å¾®ä¿¡çº¢åŒ…å°é¢ï¼ä¸ºäº†ç»™ä½ æä¾›æ›´ç¬¦åˆéœ€æ±‚çš„è®¾è®¡æ–¹æ¡ˆï¼Œæˆ‘éœ€è¦äº†è§£ä¸€äº›å…·ä½“ä¿¡æ¯ã€‚

è®¾è®¡é£æ ¼: ä½ å¸Œæœ›çº¢åŒ…å°é¢çš„è®¾è®¡é£æ ¼æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ
  1. ç®€çº¦ç°ä»£é£ - ç®€çº¦çº¿æ¡å’Œç°ä»£è‰²å½©ï¼Œé€‚åˆæ—¥å¸¸ä½¿ç”¨
  2. å›½æ½®æ°´å¢¨é£ - ä¼ ç»Ÿæ°´å¢¨ç”»é£æ ¼ï¼Œå±•ç°å›½æ½®éŸµå‘³
  3. å¯çˆ±å¡é€šé£ - å¯çˆ±çš„å¡é€šå½¢è±¡ï¼Œæ´»æ³¼æœ‰è¶£
  4. é‡‘è‰²å¥¢åé£ - é‡‘è‰²ä¸ºä¸»ï¼Œé…ä»¥ä¼ ç»Ÿçº¹æ ·ï¼Œæ˜¾å¾—é«˜çº§
  (Enter a number, or <span class="hljs-built_in">type</span> custom text)
1

ä½¿ç”¨åœºæ™¯: è¿™ä¸ªçº¢åŒ…å°é¢ä¸»è¦ä¼šåœ¨ä»€ä¹ˆåœºåˆä½¿ç”¨ï¼Ÿ
  1. ä¼ ç»ŸèŠ‚æ—¥ - æ–°å¹´ã€æ˜¥èŠ‚ç­‰ä¼ ç»ŸèŠ‚æ—¥
  2. å–œåº†åœºåˆ - å©šç¤¼ã€ç”Ÿæ—¥ã€åº†å…¸ç­‰å–œåº†åœºåˆ
  3. æ—¥å¸¸äº’åŠ¨ - æ—¥å¸¸é€ç¤¼ã€æœ‹å‹é—´äº’åŠ¨
  4. å•†åŠ¡åœºåˆ - å•†åŠ¡åœºåˆã€å®¢æˆ·å…³ç³»ç»´æŠ¤
  (Enter numbers separated by commas, or <span class="hljs-built_in">type</span> custom text)
1

é¢œè‰²åå¥½: ä½ æ›´å€¾å‘äºä»€ä¹ˆé¢œè‰²æ­é…ï¼Ÿ
  1. çº¢é‡‘é…è‰² - çº¢è‰²ä¸ºä¸»ï¼Œé…é‡‘è‰²æˆ–ç™½è‰²
  2. è“é‡‘é…è‰² - è“è‰²ä¸ºä¸»ï¼Œé…é‡‘è‰²æˆ–ç™½è‰²
  3. å•è‰²èƒŒæ™¯ - çº¯è‰²èƒŒæ™¯ï¼Œç®€æ´å¤§æ–¹
  4. è‡ªç„¶è‰²å½© - æ ¹æ®é”¦é²¤è‡ªç„¶è‰²å½©æ­é…
  (Enter a number, or <span class="hljs-built_in">type</span> custom text)
1

æ–‡å­—å†…å®¹: çº¢åŒ…å°é¢æ˜¯å¦éœ€è¦æ·»åŠ æ–‡å­—å†…å®¹ï¼Ÿ
  1. çº¯å›¾æ¡ˆ - åªæ”¾é”¦é²¤å›¾æ¡ˆï¼Œç®€æ´å¤§æ–¹
  2. å›¾æ¡ˆ+ç¥ç¦è¯­ - é”¦é²¤å›¾æ¡ˆ+ç®€å•ç¥ç¦è¯­
  3. å›¾æ¡ˆ+æ–‡å­— - é”¦é²¤å›¾æ¡ˆ+å“ç‰Œæˆ–å…¬å¸ä¿¡æ¯
  (Enter a number, or <span class="hljs-built_in">type</span> custom text)
2
======================= ç¬¬ 2 è½® ====================================
before: 
USER: 
 - SYSTEM: 
 - TOOLS: [<span class="hljs-string">"AskUserQuestionTool"</span>]
 - TOOL-RESPONSE: AskUserQuestionTool: <span class="hljs-string">"User has answered your questions: {\"è¿™ä¸ªçº¢åŒ…å°é¢ä¸»è¦ä¼šåœ¨ä»€ä¹ˆåœºåˆä½¿ç”¨ï¼Ÿ\":\"ä¼ ç»ŸèŠ‚æ—¥\",\"ä½ å¸Œæœ›çº¢åŒ…å°é¢çš„è®¾è®¡é£æ ¼æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ\":\"ç®€çº¦ç°ä»£é£\",\"ä½ æ›´å€¾å‘äºä»€ä¹ˆé¢œè‰²æ­é…ï¼Ÿ\":\"çº¢é‡‘é…è‰²\",\"çº¢åŒ…å°é¢æ˜¯å¦éœ€è¦æ·»åŠ æ–‡å­—å†…å®¹ï¼Ÿ\":\"å›¾æ¡ˆ+ç¥ç¦è¯­\"}"</span>
after: 
ASSISTANT: 
 - TEXT: æ ¹æ®æ‚¨çš„éœ€æ±‚ï¼Œæˆ‘ä¸ºæ‚¨è®¾è®¡äº†ä¸€ä¸ª**ç®€çº¦ç°ä»£é£ã€çº¢é‡‘é…è‰²çš„é”¦é²¤ä¸»é¢˜å¾®ä¿¡çº¢åŒ…å°é¢**ï¼Œéå¸¸é€‚åˆä¼ ç»ŸèŠ‚æ—¥ä½¿ç”¨ã€‚

<span class="hljs-comment">## ğŸ¨ è®¾è®¡æ–¹æ¡ˆè¯¦æƒ…</span>

<span class="hljs-comment">### ğŸ“ å°ºå¯¸è§„æ ¼</span>
- **ä¸»å°ºå¯¸**: 1080Ã—1920åƒç´ ï¼ˆç¬¦åˆå¾®ä¿¡çº¢åŒ…å°é¢æ ‡å‡†ï¼‰
- **å®‰å…¨åŒºåŸŸ**: ä¸Šä¸‹å·¦å³å„ç•™å‡º100pxï¼Œç¡®ä¿é‡è¦å†…å®¹ä¸è¢«é®æŒ¡

<span class="hljs-comment">### ğŸ¯ è®¾è®¡å…ƒç´ </span>
1. **èƒŒæ™¯**: 
   - ä½¿ç”¨æ¸å˜çº¢è‰²èƒŒæ™¯ï¼ˆä»æ·±çº¢åˆ°æµ…çº¢ï¼‰ï¼Œè¥é€ èŠ‚æ—¥æ°›å›´
   - æ·»åŠ å¾®å¦™çš„é‡‘è‰²ç½‘æ ¼çº¹ç†ï¼Œå¢åŠ ç°ä»£æ„Ÿ

2. **é”¦é²¤å›¾æ¡ˆ**:
   - é€‰ç”¨ç®€çº¦çº¿æ¡é£æ ¼çš„é”¦é²¤å‰ªå½±
   - é”¦é²¤å‘ˆå‘ä¸Šæ¸¸åŠ¨å§¿æ€ï¼Œå¯“æ„<span class="hljs-string">"é±¼è·ƒé¾™é—¨"</span>
   - é‡‘è‰²çº¿æ¡å‹¾å‹’ï¼Œä¸çº¢è‰²èƒŒæ™¯å½¢æˆå¯¹æ¯”

3. **æ–‡å­—å†…å®¹**:
   - **ä¸»æ ‡é¢˜**: <span class="hljs-string">"ç¦æ»¡é”¦é²¤"</span>ï¼ˆé‡‘è‰²ç«‹ä½“æ•ˆæœï¼‰
   - **ç¥ç¦è¯­**: <span class="hljs-string">"å¹´å¹´æœ‰ä½™ï¼Œç¦è¿ç»µé•¿"</span>
   - **è£…é¥°å…ƒç´ **: æ°´æ³¢çº¹ã€ç¥¥äº‘ç­‰ä¼ ç»Ÿå…ƒç´ ç‚¹ç¼€

4. **å“ç‰Œä¿¡æ¯**ï¼ˆå¯é€‰ï¼‰:
   - åº•éƒ¨å°å­—ï¼š<span class="hljs-string">"[æ‚¨çš„å“ç‰Œ/å§“å]ç¥æ‚¨æ–°å¹´å¿«ä¹"</span>

<span class="hljs-comment">### ğŸŒˆ è‰²å½©æ–¹æ¡ˆ</span>
- **ä¸»è‰²**: <span class="hljs-comment">#D32F2Fï¼ˆæ·±çº¢ï¼‰â†’ #FFEB3Bï¼ˆé‡‘è‰²æ¸å˜ï¼‰</span>
- **è¾…åŠ©è‰²**: <span class="hljs-comment">#FFF8E1ï¼ˆæµ…ç±³è‰²ï¼Œç”¨äºæ–‡å­—èƒŒæ™¯ï¼‰</span>

<span class="hljs-comment">### âœ¨ è®¾è®¡äº®ç‚¹</span>
- ç®€çº¦ç°ä»£çš„çº¿æ¡é£æ ¼ï¼Œé¿å…è¿‡äºç¹å¤
- çº¢é‡‘é…è‰²ç»å…¸å¤§æ°”ï¼Œç¬¦åˆä¼ ç»ŸèŠ‚æ—¥æ°›å›´
- é”¦é²¤å‘ä¸Šæ¸¸åŠ¨çš„å§¿æ€ï¼Œå¯“æ„ç§¯æå‘ä¸Š
- èŠ‚å¥æ„Ÿçš„å¸ƒå±€ï¼Œè§†è§‰å¹³è¡¡åè°ƒ

<span class="hljs-comment">### ğŸ“ ä½¿ç”¨å»ºè®®</span>
- é€‚åˆæ˜¥èŠ‚ã€å…ƒå®µèŠ‚ã€ä¸­ç§‹ç­‰ä¼ ç»ŸèŠ‚æ—¥å‘é€
- å¯ç”¨äºäº²å‹ç¥ç¦ã€å•†åŠ¡æ‹œå¹´ã€å®¢æˆ·ç­”è°¢ç­‰åœºåˆ
- çº¢é‡‘é…è‰²æ—¢æœ‰ä¼ ç»ŸéŸµå‘³ï¼Œåˆä¸å¤±ç°ä»£æ„Ÿ

è¿™ä¸ªè®¾è®¡æ–¹æ¡ˆæ—¢ä¿æŒäº†ä¼ ç»ŸèŠ‚æ—¥çš„å–œåº†æ°›å›´ï¼Œåˆç¬¦åˆç°ä»£å®¡ç¾ï¼Œç›¸ä¿¡ä¼šæ˜¯ä¸€ä¸ªå¾ˆå—æ¬¢è¿çš„çº¢åŒ…å°é¢ï¼æ‚¨è§‰å¾—è¿™ä¸ªè®¾è®¡æ–¹æ¡ˆå¦‚ä½•ï¼Ÿå¦‚æœéœ€è¦è°ƒæ•´ä»»ä½•ç»†èŠ‚ï¼Œè¯·å‘Šè¯‰æˆ‘ã€‚

$-&gt;ASSISTANT: æ ¹æ®æ‚¨çš„éœ€æ±‚ï¼Œæˆ‘ä¸ºæ‚¨è®¾è®¡äº†ä¸€ä¸ª**ç®€çº¦ç°ä»£é£ã€çº¢é‡‘é…è‰²çš„é”¦é²¤ä¸»é¢˜å¾®ä¿¡çº¢åŒ…å°é¢**ï¼Œéå¸¸é€‚åˆä¼ ç»ŸèŠ‚æ—¥ä½¿ç”¨ã€‚

<span class="hljs-comment">## ğŸ¨ è®¾è®¡æ–¹æ¡ˆè¯¦æƒ…</span>

<span class="hljs-comment">### ğŸ“ å°ºå¯¸è§„æ ¼</span>
- **ä¸»å°ºå¯¸**: 1080Ã—1920åƒç´ ï¼ˆç¬¦åˆå¾®ä¿¡çº¢åŒ…å°é¢æ ‡å‡†ï¼‰
- **å®‰å…¨åŒºåŸŸ**: ä¸Šä¸‹å·¦å³å„ç•™å‡º100pxï¼Œç¡®ä¿é‡è¦å†…å®¹ä¸è¢«é®æŒ¡

<span class="hljs-comment">### ğŸ¯ è®¾è®¡å…ƒç´ </span>
1. **èƒŒæ™¯**: 
   - ä½¿ç”¨æ¸å˜çº¢è‰²èƒŒæ™¯ï¼ˆä»æ·±çº¢åˆ°æµ…çº¢ï¼‰ï¼Œè¥é€ èŠ‚æ—¥æ°›å›´
   - æ·»åŠ å¾®å¦™çš„é‡‘è‰²ç½‘æ ¼çº¹ç†ï¼Œå¢åŠ ç°ä»£æ„Ÿ

2. **é”¦é²¤å›¾æ¡ˆ**:
   - é€‰ç”¨ç®€çº¦çº¿æ¡é£æ ¼çš„é”¦é²¤å‰ªå½±
   - é”¦é²¤å‘ˆå‘ä¸Šæ¸¸åŠ¨å§¿æ€ï¼Œå¯“æ„<span class="hljs-string">"é±¼è·ƒé¾™é—¨"</span>
   - é‡‘è‰²çº¿æ¡å‹¾å‹’ï¼Œä¸çº¢è‰²èƒŒæ™¯å½¢æˆå¯¹æ¯”

3. **æ–‡å­—å†…å®¹**:
   - **ä¸»æ ‡é¢˜**: <span class="hljs-string">"ç¦æ»¡é”¦é²¤"</span>ï¼ˆé‡‘è‰²ç«‹ä½“æ•ˆæœï¼‰
   - **ç¥ç¦è¯­**: <span class="hljs-string">"å¹´å¹´æœ‰ä½™ï¼Œç¦è¿ç»µé•¿"</span>
   - **è£…é¥°å…ƒç´ **: æ°´æ³¢çº¹ã€ç¥¥äº‘ç­‰ä¼ ç»Ÿå…ƒç´ ç‚¹ç¼€

4. **å“ç‰Œä¿¡æ¯**ï¼ˆå¯é€‰ï¼‰:
   - åº•éƒ¨å°å­—ï¼š<span class="hljs-string">"[æ‚¨çš„å“ç‰Œ/å§“å]ç¥æ‚¨æ–°å¹´å¿«ä¹"</span>

<span class="hljs-comment">### ğŸŒˆ è‰²å½©æ–¹æ¡ˆ</span>
- **ä¸»è‰²**: <span class="hljs-comment">#D32F2Fï¼ˆæ·±çº¢ï¼‰â†’ #FFEB3Bï¼ˆé‡‘è‰²æ¸å˜ï¼‰</span>
- **è¾…åŠ©è‰²**: <span class="hljs-comment">#FFF8E1ï¼ˆæµ…ç±³è‰²ï¼Œç”¨äºæ–‡å­—èƒŒæ™¯ï¼‰</span>

<span class="hljs-comment">### âœ¨ è®¾è®¡äº®ç‚¹</span>
- ç®€çº¦ç°ä»£çš„çº¿æ¡é£æ ¼ï¼Œé¿å…è¿‡äºç¹å¤
- çº¢é‡‘é…è‰²ç»å…¸å¤§æ°”ï¼Œç¬¦åˆä¼ ç»ŸèŠ‚æ—¥æ°›å›´
- é”¦é²¤å‘ä¸Šæ¸¸åŠ¨çš„å§¿æ€ï¼Œå¯“æ„ç§¯æå‘ä¸Š
- èŠ‚å¥æ„Ÿçš„å¸ƒå±€ï¼Œè§†è§‰å¹³è¡¡åè°ƒ

<span class="hljs-comment">### ğŸ“ ä½¿ç”¨å»ºè®®</span>
- é€‚åˆæ˜¥èŠ‚ã€å…ƒå®µèŠ‚ã€ä¸­ç§‹ç­‰ä¼ ç»ŸèŠ‚æ—¥å‘é€
- å¯ç”¨äºäº²å‹ç¥ç¦ã€å•†åŠ¡æ‹œå¹´ã€å®¢æˆ·ç­”è°¢ç­‰åœºåˆ
- çº¢é‡‘é…è‰²æ—¢æœ‰ä¼ ç»ŸéŸµå‘³ï¼Œåˆä¸å¤±ç°ä»£æ„Ÿ

è¿™ä¸ªè®¾è®¡æ–¹æ¡ˆæ—¢ä¿æŒäº†ä¼ ç»ŸèŠ‚æ—¥çš„å–œåº†æ°›å›´ï¼Œåˆç¬¦åˆç°ä»£å®¡ç¾ï¼Œç›¸ä¿¡ä¼šæ˜¯ä¸€ä¸ªå¾ˆå—æ¬¢è¿çš„çº¢åŒ…å°é¢ï¼æ‚¨è§‰å¾—è¿™ä¸ªè®¾è®¡æ–¹æ¡ˆå¦‚ä½•ï¼Ÿå¦‚æœéœ€è¦è°ƒæ•´ä»»ä½•ç»†èŠ‚ï¼Œè¯·å‘Šè¯‰æˆ‘ã€‚
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæ–¹æ¡ˆï¼Œæ‹¿æ¥ç”Ÿæˆå›¾ç‰‡ï¼Œæ¯”å¦‚ä¸‹é¢æ˜¯è±†åŒ…ã€åƒé—®ã€å…ƒå®ç­‰ä¸åŒå¹³å°çš„ç”Ÿæˆæ•ˆæœ</p>





























<table><thead><tr><th>æ¨¡å‹</th><th>æ•ˆæœå›¾</th></tr></thead><tbody><tr><td>è±†åŒ…</td><td><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/717a119154874a61b6fe649239838e51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA54Gw54Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770771616&amp;x-signature=Ld4iSoksfjl16C8apJ%2BhCh1B0yc%3D" alt="è±†åŒ…" loading="lazy"/></td></tr><tr><td>å…ƒå®</td><td><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14e3fc00f46b43818e7ff42892a301e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA54Gw54Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770771616&amp;x-signature=AaenZvOolMK%2F4ncc4TKkO3uL1XY%3D" alt="å…ƒå®æ•ˆæœå›¾" loading="lazy"/></td></tr><tr><td>åƒé—®</td><td><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/603dca0305f24dab83da1d8ce80d0a30~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA54Gw54Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770771616&amp;x-signature=gZZ46JjDQtqyYqYnrSL9LsAd1KA%3D" alt="åƒé—®æ•ˆæœå›¾" loading="lazy"/></td></tr><tr><td>ç™¾åº¦</td><td><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1d5c66d6ba72445c854a7b748bd58deb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA54Gw54Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770771616&amp;x-signature=sVD%2BPj7bEw0QPXyBKI6xBmJQ6JM%3D" alt="ç™¾åº¦" loading="lazy"/></td></tr><tr><td>ChatGPT</td><td><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3245a0fa03324eed97d57e275782c46c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA54Gw54Gw:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770771616&amp;x-signature=Cyo%2BVFZb0WpXa8WlbeDHtQM618A%3D" alt="ChatGPTæ•ˆæœå›¾" loading="lazy"/></td></tr></tbody></table>
<h3 data-id="heading-13">å››ã€å°ç»“</h3>
<p>æœ¬ç‰‡å†…å®¹é€šè¿‡è®¾è®¡+å®ä¾‹ç»™å¤§å®¶æ¼”ç¤ºäº†ä¸€ä¸‹Spring AIä¸­çš„å¤šè½®å¯¹è¯è‰ºæœ¯ï¼Œå¦‚ä½•è®©å¤§æ¨¡å‹ä¸»åŠ¨æé—®è·å–æ˜ç¡®éœ€æ±‚ï¼Ÿ ä¸‹é¢å‡ éƒ¨å³å¯ï¼š</p>
<ul>
<li>ä¸»åŠ¨è¯¢é—®æœºåˆ¶ï¼šä½¿ç”¨AskUserQuestionToolè®©AIåœ¨ä¿¡æ¯ä¸è¶³æ—¶ä¸»åŠ¨æé—®</li>
<li>çµæ´»çš„å“åº”å¤„ç†ï¼šé€šè¿‡è‡ªå®šä¹‰QuestionHandleré€‚é…ä¸åŒå¹³å°çš„äº¤äº’æ–¹å¼</li>
<li>å¯¹è¯çŠ¶æ€ç®¡ç†ï¼šåˆ©ç”¨MessageChatMemoryAdvisorç»´æŠ¤å¤šè½®å¯¹è¯çš„ä¸Šä¸‹æ–‡</li>
<li>å·¥å…·ç»„åˆä½¿ç”¨ï¼šå°†è¯¢é—®å·¥å…·ä¸è®°å¿†é¡¾é—®ã€æ—¥å¿—é¡¾é—®ç­‰é…åˆä½¿ç”¨ï¼Œæ„å»ºå®Œæ•´çš„äº¤äº’ä½“ç³»</li>
<li>å¼‚æ­¥å¤„ç†æ”¯æŒï¼šåœ¨Webç¯å¢ƒä¸­ä½¿ç”¨SSEå®ç°æµç•…çš„å¤šè½®å¯¹è¯ä½“éªŒ</li>
</ul>
<blockquote>
<p>é¡¹ç›®æºç ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fliuyueyi%2Fspring-ai-demo%2Ftree%2Fmaster%2Fv2%2FT02-manual-qa-cli-robot" target="_blank" title="https://github.com/liuyueyi/spring-ai-demo/tree/master/v2/T02-manual-qa-cli-robot" ref="nofollow noopener noreferrer">github.com/liuyueyi/spâ€¦</a></p>
</blockquote>
<hr/>
<p>å¯¹äºå¤§æ¨¡å‹åº”ç”¨å¼€å‘æ„Ÿå…´è¶£çš„å°ä¼™ä¼´ï¼Œæˆ–è€…å¯¹ä¸Šé¢æåˆ°çš„çŸ¥è¯†ç‚¹æœ‰ç–‘æƒ‘çš„å°ä¼™ä¼´ï¼Œä¸å¦¨çœ‹çœ‹ä»¥ä¸‹å‡ ç¯‡å†…å®¹ï¼ˆæ¯ç¯‡è€—æ—¶ä¸è¶…è¿‡äº”åˆ†é’ŸğŸ˜Šï¼‰</p>
<p>é›¶åŸºç¡€å…¥é—¨ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FqCn8x2XO2shA8MheYbHq0w" target="_blank" title="https://mp.weixin.qq.com/s/qCn8x2XO2shA8MheYbHq0w" ref="nofollow noopener noreferrer">LLM åº”ç”¨å¼€å‘æ˜¯ä»€ä¹ˆï¼šé›¶åŸºç¡€ä¹Ÿå¯ä»¥è¯»æ‡‚çš„ç§‘æ™®æ–‡(æç®€ç‰ˆ)</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F2GXBNOUq3jlysipftz8TpA" target="_blank" title="https://mp.weixin.qq.com/s/2GXBNOUq3jlysipftz8TpA" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šåº-ä¸ºä»€ä¹ˆä½ â€œä¼šç”¨ LLMâ€ï¼Œä½†åšä¸å‡ºå¤æ‚åº”ç”¨ï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fv-z6EHY300ElOxdGPdzc0w" target="_blank" title="https://mp.weixin.qq.com/s/v-z6EHY300ElOxdGPdzc0w" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬ä¸€ç« LLMåˆ°åº•åœ¨åšä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Ft_BuAW9i0npcaJdua3Am2Q" target="_blank" title="https://mp.weixin.qq.com/s/t_BuAW9i0npcaJdua3Am2Q" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬äºŒç«  æ¨¡å‹ä¸æ˜¯é‡ç‚¹ï¼Œå‚æ•°æ‰æ˜¯ä½ çœŸæ­£çš„æ§åˆ¶é¢æ¿</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fvzt0bGwcfnASOiBa0Kc7VQ" target="_blank" title="https://mp.weixin.qq.com/s/vzt0bGwcfnASOiBa0Kc7VQ" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬ä¸‰ç«  ä¸ºä»€ä¹ˆæˆ‘çš„Promptè¡¨ç°å¾ˆç³Ÿï¼Ÿ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FNk-N34TLJVCTI5F4k5rGaQ" target="_blank" title="https://mp.weixin.qq.com/s/Nk-N34TLJVCTI5F4k5rGaQ" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬å››ç« Prompt çš„å·¥ç¨‹åŒ–ç»“æ„è®¾è®¡</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FZQbztqBq7_PzynG06N4-mg" target="_blank" title="https://mp.weixin.qq.com/s/ZQbztqBq7_PzynG06N4-mg" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬äº”ç«  ä» Prompt åˆ° Prompt æ¨¡æ¿ä¸å·¥ç¨‹æ²»ç†</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FnnKspRO87xbrn4-LBV3RNA" target="_blank" title="https://mp.weixin.qq.com/s/nnKspRO87xbrn4-LBV3RNA" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘ç³»åˆ—æ•™ç¨‹ï¼šç¬¬å…­ç«  ä¸Šä¸‹æ–‡çª—å£çš„çœŸå®è¾¹ç•Œ</a></li>
</ul>
<hr/>
<p>å®æˆ˜</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F96rHyp_gBUgmA2dhSbzNww" target="_blank" title="https://mp.weixin.qq.com/s/96rHyp_gBUgmA2dhSbzNww" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘å®æˆ˜ï¼šä¸¤ç™¾è¡Œå®ç°ä¸€ä¸ªè‡ªç„¶è¯­è¨€åœ°å€æå–æ™ºèƒ½ä½“</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FSnXdTB6tYqAzG7HgbnTSAQ" target="_blank" title="https://mp.weixin.qq.com/s/SnXdTB6tYqAzG7HgbnTSAQ" ref="nofollow noopener noreferrer">å¤§æ¨¡å‹åº”ç”¨å¼€å‘å®æˆ˜ï¼šåŸºäºSpringAIä¸å¤§æ¨¡å‹çš„é›¶é…ç½®å‘ç¥¨æ™ºèƒ½æå–æ¶æ„</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FNHqLJbos-_nrxNNmhg7IBQ" target="_blank" title="https://mp.weixin.qq.com/s/NHqLJbos-_nrxNNmhg7IBQ" ref="nofollow noopener noreferrer">å®æˆ˜ | é›¶åŸºç¡€æ­å»ºçŸ¥è¯†åº“é—®ç­”æœºå™¨äººï¼šåŸºäºSpringAI+RAGçš„å®Œæ•´å®ç°</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¸¿è’™å¼€å‘å®æˆ˜ï¼šç©è½¬â€œæ™ºæ„Ÿæ¡å§¿â€â€”â€”æ–°é—»åˆ—è¡¨å·¦å³æ‰‹æ™ºèƒ½åˆ‡æ¢]]></title>    <link>https://juejin.cn/post/7602455806446993414</link>    <guid>https://juejin.cn/post/7602455806446993414</guid>    <pubDate>2026-02-04T02:00:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602455806446993414" data-draft-id="7602455806446977030" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¸¿è’™å¼€å‘å®æˆ˜ï¼šç©è½¬â€œæ™ºæ„Ÿæ¡å§¿â€â€”â€”æ–°é—»åˆ—è¡¨å·¦å³æ‰‹æ™ºèƒ½åˆ‡æ¢"/> <meta itemprop="keywords" content="HarmonyOS,ArkUI,ArkTS"/> <meta itemprop="datePublished" content="2026-02-04T02:00:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¨å“¥çˆ±ç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/2242659450109575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¸¿è’™å¼€å‘å®æˆ˜ï¼šç©è½¬â€œæ™ºæ„Ÿæ¡å§¿â€â€”â€”æ–°é—»åˆ—è¡¨å·¦å³æ‰‹æ™ºèƒ½åˆ‡æ¢
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2242659450109575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¨å“¥çˆ±ç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T02:00:35.000Z" title="Wed Feb 04 2026 02:00:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯Vå“¥ã€‚</p>
<p>ä½ æœ‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼š</p>
<blockquote>
<p>å·¦æ‰‹æ‹¿ç€å¥¶èŒ¶ï¼Œå³æ‰‹åˆ·æ–°é—»ï¼Œç»“æœå¤´å›¾æ°¸è¿œåœ¨å³è¾¹ï¼Œç‚¹éƒ½ç‚¹ä¸åˆ°ï¼Ÿ</p>
</blockquote>
<p>ç°åœ¨å¥½äº†ï¼Œç³»ç»Ÿèƒ½å®æ—¶æ„ŸçŸ¥ä½ æ˜¯å·¦æ‰‹è¿˜æ˜¯å³æ‰‹æ¡æŒï¼ŒUI è‡ªåŠ¨é€‚é…ï¼è¿™æ‰æ˜¯çœŸæ­£çš„â€œæ‡‚ä½ â€ï¼</p>
<p>ä»Šå¤© V å“¥å°±ç”¨ä¸€ä¸ªæ–°é—»åˆ—è¡¨é¡µé¢ï¼Œå¸¦ä½  10 åˆ†é’Ÿæå®šæ™ºæ„Ÿæ¡å§¿çš„å®Œæ•´å¼€å‘ï¼èƒ½æ ¹æ®ä½ æ‹¿æ‰‹æœºçš„å§¿åŠ¿ï¼Œè‡ªåŠ¨æŠŠå›¾ç‰‡å’Œæ–‡å­—äº’æ¢ä½ç½®ã€‚ä»£ç å…¨åœ¨ä¸€ä¸ªé¡µé¢ï¼Œå¤åˆ¶è¿›å»å°±èƒ½è·‘ï¼Œç»å¯¹ç¡¬æ ¸ï¼</p>
<h2 data-id="heading-0">æŠ€æœ¯åŸç†ï¼šæ‰‹æœºæ€ä¹ˆçŸ¥é“é‚£æ˜¯ä½ çš„å·¦æ‰‹ï¼Ÿ</h2>
<p>å…¶å®å¾ˆç®€å•ã€‚ä½ æƒ³æƒ³ï¼Œå½“ä½ ç”¨<strong>å³æ‰‹</strong>å•æ‰‹æ¡æŒæ‰‹æœºæ—¶ï¼Œä¸ºäº†è®©å¤§æ‹‡æŒ‡å¤Ÿåˆ°å±å¹•å·¦ä¾§ï¼Œæ‰‹æœºé€šå¸¸ä¼šä¸ç”±è‡ªä¸»åœ°å‘<strong>å·¦å€¾æ–œ</strong>ä¸€ç‚¹ç‚¹ï¼ˆæˆ–è€…å‘å³å€¾æ–œï¼Œçœ‹ä¸ªäººä¹ æƒ¯ï¼Œé€šå¸¸æˆ‘ä»¬è®¾å®šä¸€ä¸ªå€¾æ–œé˜ˆå€¼ï¼‰ã€‚</p>
<p>å’±ä»¬åˆ©ç”¨é¸¿è’™çš„ <code>@ohos.sensor</code>ï¼ˆä¼ æ„Ÿå™¨èƒ½åŠ›ï¼‰ï¼Œç›‘å¬é‡åŠ›å˜åŒ–ã€‚</p>
<ul>
<li>å½“æ£€æµ‹åˆ°æ‰‹æœºå‘å·¦å€¾æ–œï¼ˆXè½´é‡åŠ›åˆ†é‡å˜åŒ–ï¼‰ï¼Œåˆ¤å®šä¸ºå·¦æ‰‹æˆ–å·¦ä¾§æ¨¡å¼ã€‚</li>
<li>å½“æ£€æµ‹åˆ°æ‰‹æœºå‘å³å€¾æ–œï¼Œåˆ¤å®šä¸ºå³æ‰‹æˆ–å³ä¾§æ¨¡å¼ã€‚</li>
</ul>
<p>è¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šå¹²è´§ã€‚</p>
<h2 data-id="heading-1">å®æˆ˜ä»£ç ï¼šæ™ºæ„Ÿæ¡å§¿æ–°é—»åˆ—è¡¨</h2>
<p>å…ˆçœ‹ä¸€ä¸‹ V å“¥å†™çš„æ¡ˆä¾‹æˆªå›¾ï¼š</p>
<p>å·¦æ‰‹æ¨¡å¼ï¼š
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b42835686180458ca633de69f422302a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aiB5ZOl54ix57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775235&amp;x-signature=RB6sXkH4TZrwj%2Fb4HNrZXo9ZmmY%3D" alt="" loading="lazy"/></p>
<p>å³æ‰‹æ¨¡å¼ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f0a094fd43a24a7f87fec7d5fd8d656e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aiB5ZOl54ix57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770775235&amp;x-signature=GCDYvuJye6KgaQScA9xY62BDwho%3D" alt="" loading="lazy"/></p>
<p>å‡†å¤‡å¥½ä½ çš„ DevEco Studioï¼Œæ–°å»ºä¸€ä¸ª ArkTS é¡µé¢ï¼ŒæŠŠä¸‹é¢çš„ä»£ç å…¨é€‰ã€å¤åˆ¶ã€ç²˜è´´è¿›å»ã€‚</p>
<h3 data-id="heading-2">å®Œæ•´ä»£ç æ¡ˆä¾‹</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> sensor <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.sensor'</span>;
<span class="hljs-keyword">import</span> promptAction <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.promptAction'</span>;

<span class="hljs-comment">// 1. å®šä¹‰æ–°é—»æ•°æ®æ¨¡å‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">NewsItem</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">summary</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">imageColor</span>: <span class="hljs-title class_">Color</span>; <span class="hljs-comment">// ç”¨é¢œè‰²å—ä»£æ›¿å›¾ç‰‡ï¼Œæ–¹ä¾¿æµ‹è¯•ï¼Œä¸ç”¨æ‰¾èµ„æº</span>

  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">id: <span class="hljs-built_in">number</span>, title: <span class="hljs-built_in">string</span>, summary: <span class="hljs-built_in">string</span>, color: Color</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = id;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">title</span> = title;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">summary</span> = summary;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imageColor</span> = color;
  }
}

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">SmartGripNewsPage</span> {
  <span class="hljs-comment">// 2. çŠ¶æ€å˜é‡</span>
  <span class="hljs-comment">// isRightMode: true ä»£è¡¨å³æ‰‹æ¨¡å¼ï¼ˆå›¾åœ¨å³ï¼‰ï¼Œfalse ä»£è¡¨å·¦æ‰‹æ¨¡å¼ï¼ˆå›¾åœ¨å·¦ï¼‰</span>
  <span class="hljs-meta">@State</span> <span class="hljs-attr">isRightMode</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span>;
  <span class="hljs-comment">// è®°å½•å½“å‰çš„å€¾æ–œè§’åº¦Xå€¼ï¼Œç”¨äºæ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯</span>
  <span class="hljs-meta">@State</span> <span class="hljs-attr">currentGravityX</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;

  <span class="hljs-comment">// æ¨¡æ‹Ÿæ–°é—»æ•°æ®</span>
  <span class="hljs-meta">@State</span> <span class="hljs-attr">newsList</span>: <span class="hljs-title class_">NewsItem</span>[] = [
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">NewsItem</span>(<span class="hljs-number">1</span>, <span class="hljs-string">"é¸¿è’™Nextæ­£å¼å‘å¸ƒ"</span>, <span class="hljs-string">"çº¯è¡€é¸¿è’™ä¸å†å…¼å®¹å®‰å“ï¼Œå¼€å¯ç§»åŠ¨æ“ä½œç³»ç»Ÿæ–°çºªå…ƒã€‚"</span>, <span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span>),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">NewsItem</span>(<span class="hljs-number">2</span>, <span class="hljs-string">"Vå“¥èŠæŠ€æœ¯"</span>, <span class="hljs-string">"æ·±åº¦è§£æArkTSè¯­è¨€ç‰¹æ€§ï¼Œå¸¦ä½ å¼¯é“è¶…è½¦ã€‚"</span>, <span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">NewsItem</span>(<span class="hljs-number">3</span>, <span class="hljs-string">"2026è¡Œä¸šå±•æœ›"</span>, <span class="hljs-string">"AIèµ›é“çˆ†å‘ï¼Œæ™®é€šç¨‹åºå‘˜å¦‚ä½•æŠ“ä½æœ€åçš„æœºä¼šï¼Ÿ"</span>, <span class="hljs-title class_">Color</span>.<span class="hljs-property">Green</span>),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">NewsItem</span>(<span class="hljs-number">4</span>, <span class="hljs-string">"SpaceXæ˜Ÿèˆ°å‘å°„"</span>, <span class="hljs-string">"é©¬æ–¯å…‹ç«æ˜Ÿæ®–æ°‘è®¡åˆ’åˆè¿‘äº†ä¸€æ­¥ï¼Œéœ‡æ’¼å…¨äººç±»ã€‚"</span>, <span class="hljs-title class_">Color</span>.<span class="hljs-property">Orange</span>),
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">NewsItem</span>(<span class="hljs-number">5</span>, <span class="hljs-string">"å‘¨æœ«å»å“ªå„¿ç©"</span>, <span class="hljs-string">"å‘ç°åŸå¸‚å‘¨è¾¹çš„å°ä¼—éœ²è¥åœ°ï¼Œæ”¾æ¾èº«å¿ƒå¥½å»å¤„ã€‚"</span>, <span class="hljs-title class_">Color</span>.<span class="hljs-property">Pink</span>),
  ];

  <span class="hljs-comment">// 3. é¡µé¢åŠ è½½æ—¶å¼€å¯ä¼ æ„Ÿå™¨ç›‘å¬</span>
  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startSensor</span>();
  }

  <span class="hljs-comment">// 4. é¡µé¢é”€æ¯æ—¶å…³é—­ä¼ æ„Ÿå™¨ï¼Œçœç”µ</span>
  <span class="hljs-title function_">aboutToDisappear</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">stopSensor</span>();
  }

  <span class="hljs-comment">// å¼€å¯ä¼ æ„Ÿå™¨é€»è¾‘</span>
  <span class="hljs-title function_">startSensor</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// ç›‘å¬é‡åŠ›ä¼ æ„Ÿå™¨ï¼Œé¢‘ç‡è®¾ç½®ä¸º UI (é€‚åˆUIäº¤äº’çš„é¢‘ç‡)</span>
      sensor.<span class="hljs-title function_">on</span>(sensor.<span class="hljs-property">SensorId</span>.<span class="hljs-property">GRAVITY</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
        <span class="hljs-comment">// data.x ä»£è¡¨ x è½´çš„é‡åŠ›åˆ†é‡</span>
        <span class="hljs-comment">// å½“æ‰‹æœºç«–å±é¢å¯¹ä½ ï¼š</span>
        <span class="hljs-comment">// æ‰‹æœºå‘å³å€¾æ–œï¼Œx &gt; 0</span>
        <span class="hljs-comment">// æ‰‹æœºå‘å·¦å€¾æ–œï¼Œx &lt; 0</span>
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentGravityX</span> = data.<span class="hljs-property">x</span>;

        <span class="hljs-comment">// è®¾ç½®ä¸€ä¸ªé˜ˆå€¼ï¼Œé˜²æ­¢è½»å¾®æŠ–åŠ¨å°±åˆ‡æ¢</span>
        <span class="hljs-comment">// è¿™é‡Œè®¾ç½® 1.5 ä¸ºé˜ˆå€¼ï¼Œä½ å¯ä»¥æ ¹æ®æ‰‹æ„Ÿè°ƒæ•´</span>
        <span class="hljs-keyword">if</span> (data.<span class="hljs-property">x</span> &gt; <span class="hljs-number">1.5</span>) {
          <span class="hljs-comment">// å‘å³å€¾æ–œï¼Œè®¤ä¸ºæ˜¯å³æ‰‹æ¡æŒæˆ–è€…æƒ³çœ‹å³è¾¹</span>
          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isRightMode</span> === <span class="hljs-literal">false</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isRightMode</span> = <span class="hljs-literal">true</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showToast</span>(<span class="hljs-string">"æ™ºæ„Ÿåˆ‡æ¢ï¼šå³æ‰‹æ¨¡å¼"</span>);
          }
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data.<span class="hljs-property">x</span> &lt; -<span class="hljs-number">1.5</span>) {
          <span class="hljs-comment">// å‘å·¦å€¾æ–œï¼Œè®¤ä¸ºæ˜¯å·¦æ‰‹æ¡æŒ</span>
          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isRightMode</span> === <span class="hljs-literal">true</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isRightMode</span> = <span class="hljs-literal">false</span>;
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showToast</span>(<span class="hljs-string">"æ™ºæ„Ÿåˆ‡æ¢ï¼šå·¦æ‰‹æ¨¡å¼"</span>);
          }
        }
      }, { <span class="hljs-attr">interval</span>: <span class="hljs-number">100000000</span> }); <span class="hljs-comment">// 100ms ä¸€æ¬¡å›è°ƒ</span>
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Vå“¥æç¤ºï¼šä¼ æ„Ÿå™¨å¯åŠ¨å¤±è´¥ï¼Œå¯èƒ½æ˜¯æ¨¡æ‹Ÿå™¨ä¸æ”¯æŒ"</span>, err);
    }
  }

  <span class="hljs-comment">// å…³é—­ä¼ æ„Ÿå™¨</span>
  <span class="hljs-title function_">stopSensor</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">try</span> {
      sensor.<span class="hljs-title function_">off</span>(sensor.<span class="hljs-property">SensorId</span>.<span class="hljs-property">GRAVITY</span>);
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Vå“¥æç¤ºï¼šä¼ æ„Ÿå™¨å…³é—­å¤±è´¥"</span>, err);
    }
  }

  <span class="hljs-comment">// å°æç¤ºå¼¹çª—</span>
  <span class="hljs-title function_">showToast</span>(<span class="hljs-params">msg: <span class="hljs-built_in">string</span></span>) {
    promptAction.<span class="hljs-title function_">showToast</span>({
      <span class="hljs-attr">message</span>: msg,
      <span class="hljs-attr">duration</span>: <span class="hljs-number">1500</span>,
      <span class="hljs-attr">bottom</span>: <span class="hljs-number">100</span>
    });
  }

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-comment">// é¡¶éƒ¨æ ‡é¢˜æ </span>
      <span class="hljs-title class_">Row</span>() {
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">"æ™ºæ„Ÿæ–°é—»"</span>)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">24</span>)
          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
        <span class="hljs-title class_">Blank</span>()
        <span class="hljs-comment">// æ˜¾ç¤ºå½“å‰æ¨¡å¼çŠ¶æ€</span>
        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isRightMode</span> ? <span class="hljs-string">"å½“å‰ï¼šå³æ‰‹æ¨¡å¼"</span> : <span class="hljs-string">"å½“å‰ï¼šå·¦æ‰‹æ¨¡å¼"</span>)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)
          .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Gray</span>)
      }
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">padding</span>(<span class="hljs-number">20</span>)
      .<span class="hljs-title function_">height</span>(<span class="hljs-number">60</span>)
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F1F3F5'</span>)

      <span class="hljs-comment">// è°ƒè¯•ä¿¡æ¯ï¼ˆæ­£å¼ä¸Šçº¿å¯ä»¥å»æ‰ï¼‰</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`é‡åŠ›Xè½´æ„Ÿåº”å€¼: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.currentGravityX.toFixed(<span class="hljs-number">2</span>)}</span>`</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>)
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Gray</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })

      <span class="hljs-comment">// æ–°é—»åˆ—è¡¨</span>
      <span class="hljs-title class_">List</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">15</span> }) {
        <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">newsList</span>, <span class="hljs-function">(<span class="hljs-params">item: NewsItem</span>) =&gt;</span> {
          <span class="hljs-title class_">ListItem</span>() {
            <span class="hljs-comment">// æ ¸å¿ƒå¸ƒå±€ï¼šæ ¹æ® isRightMode å†³å®šå¸ƒå±€æ–¹å‘</span>
            <span class="hljs-comment">// Direction.Ltr (Left to Right) æˆ–è€…æ˜¯ Rtl</span>
            <span class="hljs-comment">// è¿™é‡Œæˆ‘ä»¬ç”¨ Flex æˆ–è€… Row æ‰‹åŠ¨æ§åˆ¶é¡ºåºæ›´ç¨³</span>
            <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">NewsItemBuilder</span>(item)
          }
        })
      }
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>) <span class="hljs-comment">// å æ»¡å‰©ä½™ç©ºé—´</span>
      .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">15</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">15</span> })
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
  }

  <span class="hljs-comment">// è‡ªå®šä¹‰æ„å»ºå‡½æ•°ï¼Œå¤„ç†å•ä¸ªæ–°é—»çš„å¸ƒå±€</span>
  <span class="hljs-meta">@Builder</span>
  <span class="hljs-title class_">NewsItemBuilder</span>(<span class="hljs-attr">item</span>: <span class="hljs-title class_">NewsItem</span>) {
    <span class="hljs-title class_">Row</span>() {
      <span class="hljs-comment">// è¿™é‡Œçš„é€»è¾‘ï¼š</span>
      <span class="hljs-comment">// å¦‚æœæ˜¯å·¦æ‰‹æ¨¡å¼(isRightMode=false)ï¼Œå›¾ç‰‡åœ¨å·¦ï¼Œæ–‡å­—åœ¨å³</span>
      <span class="hljs-comment">// å¦‚æœæ˜¯å³æ‰‹æ¨¡å¼(isRightMode=true)ï¼Œæ–‡å­—åœ¨å·¦ï¼Œå›¾ç‰‡åœ¨å³</span>
      <span class="hljs-comment">// åˆ©ç”¨ Row çš„ direction å±æ€§æˆ–è€…ç®€å•çš„ if/else æ¸²æŸ“é¡ºåº</span>

      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isRightMode</span>) {
        <span class="hljs-comment">// å·¦æ‰‹æ¨¡å¼ï¼šå›¾ -&gt; æ–‡</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">ImageBlock</span>(item.<span class="hljs-property">imageColor</span>)
        <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">TextBlock</span>(item)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// å³æ‰‹æ¨¡å¼ï¼šæ–‡ -&gt; å›¾</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">TextBlock</span>(item)
        <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">ImageBlock</span>(item.<span class="hljs-property">imageColor</span>)
      }
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)
    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
    .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">10</span>)
    .<span class="hljs-title function_">shadow</span>({ <span class="hljs-attr">radius</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">color</span>: <span class="hljs-number">0x1F000000</span>, <span class="hljs-attr">offsetY</span>: <span class="hljs-number">2</span> })
    .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)
    <span class="hljs-comment">// æ·»åŠ ä¸€ä¸ªé¡ºæ»‘çš„åŠ¨ç”»æ•ˆæœ</span>
    .<span class="hljs-title function_">animation</span>({
      <span class="hljs-attr">duration</span>: <span class="hljs-number">300</span>,
      <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">EaseInOut</span>
    })
  }

  <span class="hljs-comment">// æŠ½å–å›¾ç‰‡ç»„ä»¶</span>
  <span class="hljs-meta">@Builder</span>
  <span class="hljs-title class_">ImageBlock</span>(<span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>) {
    <span class="hljs-comment">// æ¨¡æ‹Ÿå›¾ç‰‡</span>
    <span class="hljs-title class_">Stack</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">"å¤´å›¾"</span>)
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>)
    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">backgroundColor</span>(color)
    .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">8</span>)
    .<span class="hljs-title function_">margin</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isRightMode</span> ? { <span class="hljs-attr">left</span>: <span class="hljs-number">10</span> } : { <span class="hljs-attr">right</span>: <span class="hljs-number">10</span> }) <span class="hljs-comment">// æ ¹æ®ä½ç½®ç»™é—´è·</span>
  }

  <span class="hljs-comment">// æŠ½å–æ–‡å­—ç»„ä»¶</span>
  <span class="hljs-meta">@Builder</span>
  <span class="hljs-title class_">TextBlock</span>(<span class="hljs-attr">item</span>: <span class="hljs-title class_">NewsItem</span>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(item.<span class="hljs-property">title</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
        .<span class="hljs-title function_">maxLines</span>(<span class="hljs-number">1</span>)
        .<span class="hljs-title function_">textOverflow</span>({ <span class="hljs-attr">overflow</span>: <span class="hljs-title class_">TextOverflow</span>.<span class="hljs-property">Ellipsis</span> })
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      
      <span class="hljs-title class_">Text</span>(item.<span class="hljs-property">summary</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Gray</span>)
        .<span class="hljs-title function_">maxLines</span>(<span class="hljs-number">2</span>)
        .<span class="hljs-title function_">textOverflow</span>({ <span class="hljs-attr">overflow</span>: <span class="hljs-title class_">TextOverflow</span>.<span class="hljs-property">Ellipsis</span> })
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">5</span> })
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    }
    .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>) <span class="hljs-comment">// å æ»¡å‰©ä½™å®½åº¦</span>
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Start</span>)
    .<span class="hljs-title function_">alignItems</span>(<span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Start</span>)
  }
}
</code></pre>
<h3 data-id="heading-3">ä»£ç æ·±åº¦è§£æï¼ˆVå“¥æ°ç¢äº†è®²ï¼‰</h3>
<p>å…„å¼Ÿä»¬ï¼Œä»£ç è´´å®Œäº†ï¼ŒVå“¥ç»™ä½ æ‹ä¸€æ‹è¿™é‡Œçš„æ ¸å¿ƒé—¨é“ï¼Œé¢è¯•æˆ–è€…åšé¡¹ç›®çš„æ—¶å€™éƒ½èƒ½å¹ä¸€æ³¢ã€‚</p>
<p><strong>1. ä¼ æ„Ÿå™¨ç›‘å¬ (<code>sensor.on</code>)</strong>
è¿™æ˜¯æ•´ä¸ªåŠŸèƒ½çš„çµé­‚ã€‚æˆ‘ä»¬ç”¨äº† <code>sensor.SensorId.GRAVITY</code>ã€‚</p>
<ul>
<li><code>data.x</code> æ˜¯å…³é”®ã€‚å½“ä½ æ‹¿ç€æ‰‹æœºå¾€å·¦æ­ªï¼ˆåƒæ˜¯å·¦æ‰‹æ‹¿ç€æ‰‹æœºæƒ³çœ‹å·¦è¾¹å±å¹•ï¼‰æ—¶ï¼ŒXè½´ä¼šå˜è´Ÿæ•°ï¼›å¾€å³æ­ªæ—¶ï¼ŒXè½´å˜æ­£æ•°ã€‚</li>
<li>è¿™é‡Œæˆ‘åŠ äº†ä¸ª<strong>é˜ˆå€¼ 1.5</strong>ã€‚ä¸ºå•¥ï¼Ÿå¦‚æœä¸åŠ é˜ˆå€¼ï¼Œä½ çš„æ‰‹ç¨å¾®æŠ–ä¸€ä¸‹ï¼Œç•Œé¢å°±å·¦å³ä¹±è·³ï¼Œç”¨æˆ·å¾—æ°”æ­»ã€‚1.5 æ˜¯ä¸ªç»éªŒå€¼ï¼Œå¤§çº¦å€¾æ–œ 15-20 åº¦å·¦å³è§¦å‘ï¼Œæ—¢çµæ•åˆä¸ä¼šè¯¯è§¦ã€‚</li>
</ul>
<p><strong>2. çŠ¶æ€é©±åŠ¨ UI (<code>@State isRightMode</code>)</strong>
é¸¿è’™ ArkUI çš„ç²¾é«“å°±æ˜¯<strong>çŠ¶æ€é©±åŠ¨</strong>ã€‚</p>
<ul>
<li>æˆ‘ä»¬ä¸éœ€è¦å»æ‰‹åŠ¨æ¬è¿ç»„ä»¶ã€‚åªè¦æ”¹å˜ <code>isRightMode</code> è¿™ä¸ªå¸ƒå°”å€¼ï¼ŒUI å°±ä¼šè‡ªåŠ¨åˆ·æ–°ã€‚</li>
<li>é…åˆ <code>.animation</code> å±æ€§ï¼Œå½“ç»„ä»¶ä½ç½®äº’æ¢æ—¶ï¼Œä¸ä¼šç”Ÿç¡¬åœ°â€œé—ªç°â€ï¼Œè€Œæ˜¯ä¼šæœ‰ä¸€ä¸ªæ»‘åŠ¨çš„è¿‡æ¸¡æ•ˆæœï¼Œé«˜çº§æ„Ÿç«‹é©¬å°±æ¥äº†ã€‚</li>
</ul>
<p><strong>3. æ¡ä»¶æ¸²æŸ“ (<code>if/else</code>)</strong>
åœ¨ <code>NewsItemBuilder</code> é‡Œï¼ŒVå“¥ç”¨äº†ä¸€ä¸ªæœ€ç¬¨ä½†æœ€æœ‰æ•ˆçš„æ–¹æ³•ï¼š</p>
<ul>
<li>å¦‚æœæ˜¯å·¦æ‰‹æ¨¡å¼ï¼šå…ˆæ¸²æŸ“å›¾ç‰‡ç»„ä»¶ï¼Œå†æ¸²æŸ“æ–‡å­—ç»„ä»¶ã€‚</li>
<li>å¦‚æœæ˜¯å³æ‰‹æ¨¡å¼ï¼šå…ˆæ¸²æŸ“æ–‡å­—ç»„ä»¶ï¼Œå†æ¸²æŸ“å›¾ç‰‡ç»„ä»¶ã€‚</li>
<li>å› ä¸ºæ˜¯åœ¨ <code>Row</code> å®¹å™¨é‡Œï¼Œæ¸²æŸ“é¡ºåºç›´æ¥å†³å®šäº†è°åœ¨å·¦è°åœ¨å³ã€‚</li>
</ul>
<h3 data-id="heading-4">æ€ä¹ˆæµ‹è¯•ï¼Ÿ</h3>
<ol>
<li><strong>çœŸæœºæµ‹è¯•ï¼ˆæ¨èï¼‰</strong>ï¼šæŠŠä»£ç çƒ§å½•åˆ°é¸¿è’™æ‰‹æœºä¸Šã€‚æ‹¿ç€æ‰‹æœºå‘å·¦å€¾æ–œä¸€ä¸‹ï¼Œä½ ä¼šå‘ç°å›¾ç‰‡â€œåˆ·â€ä¸€ä¸‹è·‘åˆ°å·¦è¾¹äº†ï¼›å‘å³å€¾æ–œä¸€ä¸‹ï¼Œå›¾ç‰‡åˆè·‘å›å³è¾¹äº†ã€‚</li>
<li><strong>æ¨¡æ‹Ÿå™¨æµ‹è¯•</strong>ï¼šDevEco Studio çš„æ¨¡æ‹Ÿå™¨é€šå¸¸æœ‰ä¸ªâ€œè™šæ‹Ÿä¼ æ„Ÿå™¨â€é¢æ¿ã€‚ä½ å¯ä»¥æ‰‹åŠ¨æ‹–åŠ¨é‡åŠ›ä¼ æ„Ÿå™¨çš„ X è½´æ»‘å—ï¼Œæ¨¡æ‹Ÿæ‰‹æœºå€¾æ–œï¼Œçœ‹ç•Œé¢ä¼šä¸ä¼šå˜ã€‚</li>
</ol>
<h3 data-id="heading-5">Vå“¥çš„æœ€åå” å¨</h3>
<p>å…„å¼Ÿä»¬ï¼Œè¿™ä¸ªåŠŸèƒ½è™½ç„¶ä»£ç ä¸å¤šï¼Œä½†ä½“ç°çš„æ˜¯<strong>ä»¥äººä¸ºæœ¬</strong>çš„è®¾è®¡æ€ç»´ã€‚</p>
<p>è¿™å°±æ˜¯é¸¿è’™ Next å¼€å‘å¥½ç©çš„åœ°æ–¹ï¼Œç¡¬ä»¶èƒ½åŠ›è°ƒç”¨æå…¶ç®€å•ã€‚2026å¹´ï¼Œä¸ç®¡æ˜¯åšåº”ç”¨è¿˜æ˜¯åšç³»ç»Ÿï¼Œ<strong>äº¤äº’ä½“éªŒ</strong>æ°¸è¿œæ˜¯æ ¸å¿ƒç«äº‰åŠ›ã€‚</p>
<p>èµ¶ç´§æŠŠè¿™ä»£ç è·‘èµ·æ¥ï¼Œä»¥åè€æ¿è®©ä½ åšâ€œé€‚è€åŒ–â€æˆ–è€…â€œå•æ‰‹æ¨¡å¼â€ï¼Œä½ æŠŠè¿™ä¸ª Demo ä¸€äº®ï¼Œç»å¯¹æƒŠè‰³å…¨åœºï¼ç¥å¤§å®¶å‘ç æ„‰å¿«ï¼Œæ²¡æœ‰ Bugï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JS-æ‰‹å†™ç³»åˆ—ï¼šä»é›¶æ‰‹å†™ Promise]]></title>    <link>https://juejin.cn/post/7602565408533004338</link>    <guid>https://juejin.cn/post/7602565408533004338</guid>    <pubDate>2026-02-04T07:17:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602565408533004338" data-draft-id="7602565408532922418" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JS-æ‰‹å†™ç³»åˆ—ï¼šä»é›¶æ‰‹å†™ Promise"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2026-02-04T07:17:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘ç°ä¸€åªå¤§å‘†ç“œ"/> <meta itemprop="url" content="https://juejin.cn/user/180747382561607"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JS-æ‰‹å†™ç³»åˆ—ï¼šä»é›¶æ‰‹å†™ Promise
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/180747382561607/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘ç°ä¸€åªå¤§å‘†ç“œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T07:17:19.000Z" title="Wed Feb 04 2026 07:17:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p><code>Promise</code> æ˜¯ JavaScript å¤„ç†å¼‚æ­¥ç¼–ç¨‹çš„åŸºçŸ³ã€‚è™½ç„¶æˆ‘ä»¬åœ¨æ—¥å¸¸å¼€å‘ä¸­é¢‘ç¹ä½¿ç”¨ <code>async/await</code>ï¼Œä½†æ‰‹åŠ¨å®ç°ä¸€ä¸ªç¬¦åˆ Promiseè§„èŒƒçš„ç±»ï¼Œä¸ä»…èƒ½è®©ä½ åœ¨é¢è¯•ä¸­è„±é¢–è€Œå‡ºï¼Œæ›´èƒ½è®©ä½ æ·±åˆ»ç†è§£å¾®ä»»åŠ¡ä¸é“¾å¼è°ƒç”¨çš„æœ¬è´¨ã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€ Promise æ ¸å¿ƒè®¾è®¡æ–¹æ¡ˆ</h2>
<p>å®ç°ä¸€ä¸ªæ ‡å‡†çš„ Promiseï¼Œå¿…é¡»ç´§æ‰£ä»¥ä¸‹å››ä¸ªæ ¸å¿ƒç‚¹ï¼š</p>
<ol>
<li><strong>çŠ¶æ€æœºæœºåˆ¶</strong>ï¼šå­˜åœ¨ <code>PENDING</code>ï¼ˆç­‰å¾…ï¼‰ã€<code>FULFILLED</code>ï¼ˆæˆåŠŸï¼‰ã€<code>REJECTED</code>ï¼ˆå¤±è´¥ï¼‰ä¸‰ç§çŠ¶æ€ï¼ŒçŠ¶æ€è½¬æ¢ä¸å¯é€†ã€‚</li>
<li><strong>ç«‹å³æ‰§è¡Œ</strong>ï¼šæ„é€ å‡½æ•°ä¸­çš„æ‰§è¡Œå™¨ <code>executor(resolve, reject)</code> æ˜¯åŒæ­¥ç«‹å³æ‰§è¡Œçš„ã€‚</li>
<li><strong>å¾®ä»»åŠ¡é˜Ÿåˆ—</strong>ï¼šå›è°ƒå‡½æ•°çš„æ‰§è¡Œå¿…é¡»æ˜¯å¼‚æ­¥çš„ï¼Œé€šå¸¸ä½¿ç”¨ <code>queueMicrotask</code> æ¥å®ç°ã€‚</li>
<li><strong>é“¾å¼è°ƒç”¨</strong>ï¼š<code>then</code> æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªæ–°çš„ Promiseï¼Œå¹¶å°†å‰ä¸€ä¸ª Promise çš„è¾“å‡ºä½œä¸ºåä¸€ä¸ª Promise çš„è¾“å…¥ã€‚</li>
</ol>
<h2 data-id="heading-2">äºŒã€ ä»£ç å®ç°</h2>
<pre><code class="hljs language-JavaScript" lang="JavaScript">      <span class="hljs-comment">// å®šä¹‰Promiseçš„ä¸‰ç§çŠ¶æ€</span>
      <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PENDING</span> = <span class="hljs-string">'pending'</span>;
      <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">FULFILLED</span> = <span class="hljs-string">'fulfilled'</span>;
      <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">REJECTED</span> = <span class="hljs-string">'rejected'</span>;

      <span class="hljs-comment">/**
       * è‡ªå®šä¹‰Promiseå®ç°
       * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} executor æ‰§è¡Œå™¨å‡½æ•°ï¼Œæ¥æ”¶resolveå’Œrejectå‚æ•°
       */</span>
      <span class="hljs-keyword">function</span> <span class="hljs-title function_">MyPromise</span>(<span class="hljs-params">executor</span>) {
        <span class="hljs-keyword">const</span> self = <span class="hljs-variable language_">this</span>; <span class="hljs-comment">// ä¿å­˜thisæŒ‡å‘ï¼Œé¿å…å›è°ƒä¸­ä¸¢å¤±</span>
        self.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">PENDING</span>; <span class="hljs-comment">// åˆå§‹çŠ¶æ€ä¸ºpending</span>
        self.<span class="hljs-property">value</span> = <span class="hljs-literal">undefined</span>; <span class="hljs-comment">// æˆåŠŸçš„ç»“æœå€¼</span>
        self.<span class="hljs-property">reason</span> = <span class="hljs-literal">undefined</span>; <span class="hljs-comment">// å¤±è´¥çš„åŸå› </span>
        self.<span class="hljs-property">onFulfilledCallbacks</span> = []; <span class="hljs-comment">// å­˜å‚¨æˆåŠŸå›è°ƒ</span>
        self.<span class="hljs-property">onRejectedCallbacks</span> = []; <span class="hljs-comment">// å­˜å‚¨å¤±è´¥å›è°ƒ</span>

        <span class="hljs-comment">// æˆåŠŸå›è°ƒå‡½æ•°</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-params">value</span>) {
          <span class="hljs-comment">// åªæœ‰pendingçŠ¶æ€æ‰èƒ½æ”¹å˜</span>
          <span class="hljs-keyword">if</span> (self.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PENDING</span>) {
            self.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">FULFILLED</span>;
            self.<span class="hljs-property">value</span> = value;
            <span class="hljs-comment">// å¼‚æ­¥æ‰§è¡Œæ‰€æœ‰æˆåŠŸå›è°ƒï¼Œå› ä¸ºthenæ–¹æ³•æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥è¦ç­‰executoræ‰§è¡Œå®Œå†æ‰§è¡Œ</span>
            <span class="hljs-title function_">queueMicrotask</span>(<span class="hljs-function">() =&gt;</span> {
              self.<span class="hljs-property">onFulfilledCallbacks</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">callback</span>) =&gt;</span> {
                <span class="hljs-title function_">callback</span>(self.<span class="hljs-property">value</span>);
              });
            });
          }
        }

        <span class="hljs-comment">// å¤±è´¥å›è°ƒå‡½æ•°</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">reject</span>(<span class="hljs-params">reason</span>) {
          <span class="hljs-comment">// åªæœ‰pendingçŠ¶æ€æ‰èƒ½æ”¹å˜</span>
          <span class="hljs-keyword">if</span> (self.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PENDING</span>) {
            self.<span class="hljs-property">status</span> = <span class="hljs-variable constant_">REJECTED</span>;
            self.<span class="hljs-property">reason</span> = reason;
            <span class="hljs-comment">// å¼‚æ­¥æ‰§è¡Œæ‰€æœ‰å¤±è´¥å›è°ƒ</span>
            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
              self.<span class="hljs-property">onRejectedCallbacks</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">callback</span>) =&gt;</span> {
                <span class="hljs-title function_">callback</span>(self.<span class="hljs-property">reason</span>);
              });
            });
          }
        }

        <span class="hljs-keyword">try</span> {
          <span class="hljs-comment">// ç«‹å³æ‰§è¡Œæ‰§è¡Œå™¨å‡½æ•°</span>
          <span class="hljs-title function_">executor</span>(resolve, reject);
        } <span class="hljs-keyword">catch</span> (error) {
          <span class="hljs-comment">// æ‰§è¡Œå™¨æŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œç›´æ¥è°ƒç”¨reject</span>
          <span class="hljs-title function_">reject</span>(error);
        }
      }

      <span class="hljs-comment">/** thenæ–¹æ³•å®ç°
       * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} onFulfilled æˆåŠŸå›è°ƒ
       * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} onRejected å¤±è´¥å›è°ƒ
       * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">MyPromise</span>} è¿”å›æ–°çš„Promiseå®ç°é“¾å¼è°ƒç”¨
       */</span>
      <span class="hljs-title class_">MyPromise</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">then</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">onFulfilled, onRejected</span>) {
        <span class="hljs-keyword">const</span> self = <span class="hljs-variable language_">this</span>;
        <span class="hljs-comment">// å¤„ç†é»˜è®¤å›è°ƒï¼ˆå…¼å®¹ä¸ä¼ å›è°ƒçš„æƒ…å†µï¼‰</span>
        onFulfilled =
          <span class="hljs-keyword">typeof</span> onFulfilled === <span class="hljs-string">'function'</span> ? onFulfilled : <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> value;
        onRejected =
          <span class="hljs-keyword">typeof</span> onRejected === <span class="hljs-string">'function'</span>
            ? onRejected
            : <span class="hljs-function">(<span class="hljs-params">reason</span>) =&gt;</span> {
                <span class="hljs-keyword">throw</span> reason;
              };

        <span class="hljs-comment">// è¿”å›æ–°çš„Promiseå®ç°é“¾å¼è°ƒç”¨ï¼Œå› ä¸ºåç»­å‡½æ•°ä¹Ÿå¯ä»¥é€šè¿‡thenæ–¹æ³•æ¥å¤„ç†</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
          <span class="hljs-comment">// å¤„ç†æˆåŠŸçŠ¶æ€</span>
          <span class="hljs-keyword">if</span> (self.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">FULFILLED</span>) {
            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
              <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// æ‰§è¡ŒæˆåŠŸå›è°ƒå¹¶è·å–è¿”å›å€¼</span>
                <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">onFulfilled</span>(self.<span class="hljs-property">value</span>);
                <span class="hljs-comment">// æ ¹æ®è¿”å›å€¼å¤„ç†æ–°Promiseçš„çŠ¶æ€</span>
                <span class="hljs-title function_">resolvePromise</span>(result, resolve, reject);
              } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-title function_">reject</span>(error);
              }
            });
          }


          <span class="hljs-comment">// å¤„ç†å¤±è´¥çŠ¶æ€</span>
          <span class="hljs-keyword">if</span> (self.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">REJECTED</span>) {
            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
              <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// æ‰§è¡Œå¤±è´¥å›è°ƒå¹¶è·å–è¿”å›å€¼</span>
                <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">onRejected</span>(self.<span class="hljs-property">reason</span>);
                <span class="hljs-comment">// æ ¹æ®è¿”å›å€¼å¤„ç†æ–°Promiseçš„çŠ¶æ€</span>
                <span class="hljs-title function_">resolvePromise</span>(result, resolve, reject);
              } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-title function_">reject</span>(error);
              }
            });
          }

          <span class="hljs-comment">// å¤„ç†ç­‰å¾…çŠ¶æ€ï¼ˆæš‚å­˜å›è°ƒï¼‰</span>
          <span class="hljs-keyword">if</span> (self.<span class="hljs-property">status</span> === <span class="hljs-variable constant_">PENDING</span>) {
            self.<span class="hljs-property">onFulfilledCallbacks</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> {
              <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">onFulfilled</span>(self.<span class="hljs-property">value</span>);
                <span class="hljs-title function_">resolvePromise</span>(result, resolve, reject);
              } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-title function_">reject</span>(error);
              }
            });

            self.<span class="hljs-property">onRejectedCallbacks</span>.<span class="hljs-title function_">push</span>(<span class="hljs-function">() =&gt;</span> {
              <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">onRejected</span>(self.<span class="hljs-property">reason</span>);
                <span class="hljs-title function_">resolvePromise</span>(result, resolve, reject);
              } <span class="hljs-keyword">catch</span> (error) {
                <span class="hljs-title function_">reject</span>(error);
              }
            });
          }
        });
      };

      <span class="hljs-comment">/** catchæ–¹æ³•å®ç°ï¼ˆè¯­æ³•ç³–ï¼Œç­‰ä»·äºthen(null, onRejected)ï¼‰
       * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Function</span>} onRejected å¤±è´¥å›è°ƒ
       * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">MyPromise</span>}
       */</span>
      <span class="hljs-title class_">MyPromise</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">catch</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">onRejected</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">then</span>(<span class="hljs-literal">null</span>, onRejected);
      };

      <span class="hljs-comment">//é™æ€æ–¹æ³•resolve - è¿”å›ä¸€ä¸ªå·²å®Œæˆçš„Promise</span>
      <span class="hljs-title class_">MyPromise</span>.<span class="hljs-property">resolve</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) {
        <span class="hljs-keyword">if</span> (value <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">MyPromise</span>) {
          <span class="hljs-keyword">return</span> value;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
          <span class="hljs-title function_">resolve</span>(value);
        });
      };

      <span class="hljs-comment">//é™æ€æ–¹æ³•reject - è¿”å›ä¸€ä¸ªå·²å¤±è´¥çš„Promise</span>
      <span class="hljs-title class_">MyPromise</span>.<span class="hljs-property">reject</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">reason</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyPromise</span>(<span class="hljs-function">(<span class="hljs-params">_, reject</span>) =&gt;</span> {
          <span class="hljs-title function_">reject</span>(reason);
        });
      };

      <span class="hljs-comment">// å¤„ç†thenå›è°ƒè¿”å›å€¼çš„å·¥å…·å‡½æ•°</span>
      <span class="hljs-keyword">function</span> <span class="hljs-title function_">resolvePromise</span>(<span class="hljs-params">result, resolve, reject</span>) {
        <span class="hljs-comment">// å¦‚æœè¿”å›å€¼æ˜¯å½“å‰Promiseï¼ŒæŠ›å‡ºå¾ªç¯å¼•ç”¨é”™è¯¯</span>
        <span class="hljs-keyword">if</span> (result <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">MyPromise</span>) {
          result.<span class="hljs-title function_">then</span>(resolve, reject);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-comment">// æ™®é€šå€¼ç›´æ¥resolve</span>
          <span class="hljs-title function_">resolve</span>(result);
        }
      }
    
      <span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'--- æµ‹è¯•ç”¨ä¾‹å¼€å§‹ ---'</span>);

      <span class="hljs-comment">// 1. åŸºæœ¬ resolve</span>
      <span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyPromise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'æˆåŠŸ1'</span>), <span class="hljs-number">100</span>);
      })
      p1.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Test 1: æˆåŠŸ1'</span>, res); <span class="hljs-comment">// æˆåŠŸ1</span>
      })
      p1.<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Test 1: å¤±è´¥1'</span>, err);
      })

      <span class="hljs-comment">// 2. åŸºæœ¬ reject + catch</span>
      <span class="hljs-comment">// const p2 = new MyPromise((_, reject) =&gt; {</span>
      <span class="hljs-comment">//   setTimeout(() =&gt; reject('å¤±è´¥1'), 100);</span>
      <span class="hljs-comment">// })</span>
      <span class="hljs-comment">// p2.then(success =&gt; {</span>
      <span class="hljs-comment">//   console.log('Test 2: æˆåŠŸ1', success); // å¤±è´¥1</span>
      <span class="hljs-comment">// }, (err) =&gt; {</span>
      <span class="hljs-comment">//   console.log('Test 2: å¤±è´¥1', err); // å¤±è´¥1</span>
      <span class="hljs-comment">// })</span>
      <span class="hljs-comment">// p2.catch(err =&gt; {</span>
      <span class="hljs-comment">//   console.log('Test 2: å¤±è´¥2', err); // å¤±è´¥1</span>
      <span class="hljs-comment">// })</span>

      <span class="hljs-comment">// 3. executor æŠ›å‡ºå¼‚å¸¸</span>
      <span class="hljs-comment">// new MyPromise(() =&gt; {</span>
      <span class="hljs-comment">//   throw new Error('executor error');</span>
      <span class="hljs-comment">// }).catch(err =&gt; {</span>
      <span class="hljs-comment">//   console.log('Test 4: å¼‚å¸¸', err.message); // executor error</span>
      <span class="hljs-comment">// });</span>

      <span class="hljs-comment">// 4. Promise é“¾å¼åµŒå¥—</span>
      <span class="hljs-comment">// const p4 = new MyPromise((resolve) =&gt; resolve(1))</span>
      <span class="hljs-comment">//   .then((v) =&gt; v + 1)</span>
      <span class="hljs-comment">//   .then((v) =&gt; MyPromise.resolve(v * 2))</span>
      <span class="hljs-comment">//   .then((v) =&gt; {</span>
      <span class="hljs-comment">//     console.log('Test 5:', v); // 4</span>
      <span class="hljs-comment">//   });</span>
</code></pre>
<h2 data-id="heading-3">ä¸‰ã€ æ·±åº¦ç»†èŠ‚è§£æ</h2>
<h3 data-id="heading-4">1. ä¸ºä»€ä¹ˆä½¿ç”¨ <code>queueMicrotask</code>ï¼Ÿ</h3>
<p>æ ¹æ® Promiseè§„èŒƒï¼Œ<code>onFulfilled</code> æˆ– <code>onRejected</code> å¿…é¡»åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆä»…åŒ…å«å¹³å°ä»£ç æ—¶æ‰§è¡Œã€‚è¿™æ„å‘³ç€å›è°ƒå¿…é¡»æ˜¯å¼‚æ­¥çš„ã€‚ä½¿ç”¨å¾®ä»»åŠ¡è€Œä¸æ˜¯å®ä»»åŠ¡ï¼ˆå¦‚ <code>setTimeout</code>ï¼‰ï¼Œæ˜¯ä¸ºäº†ä¿è¯åœ¨å½“å‰ä»»åŠ¡å¾ªç¯ç»“æŸå‰å°½å¯èƒ½å¿«åœ°æ‰§è¡Œå›è°ƒã€‚</p>
<h3 data-id="heading-5">2. çŠ¶æ€ä¸å¯é€†æ€§</h3>
<p>åœ¨ <code>resolve</code> å’Œ <code>reject</code> å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ¤æ–­ <code>state === 'pending'</code>ã€‚ä¸€æ—¦çŠ¶æ€å˜ä¸º <code>fulfilled</code> æˆ– <code>rejected</code>ï¼Œåç»­ä»»ä½•è°ƒç”¨éƒ½å°†è¢«å¿½ç•¥ï¼Œè¿™ä¿è¯äº† Promise çš„ç¨³å®šæ€§ã€‚</p>
<hr/>
<h2 data-id="heading-6">å››ã€ æ€»ç»“</h2>
<ol>
<li><strong>åŒæ­¥æ‰§è¡Œ</strong> <code>executor</code>ã€‚</li>
<li><strong>å¼‚æ­¥æ”¶é›†</strong> å›è°ƒå‡½æ•°ã€‚</li>
<li><strong>é€’å½’è§£æ</strong> è¿”å›å€¼ï¼Œå®ç°é“¾å¼è°ƒç”¨ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Redis äº‹åŠ¡çš„â€œåŸå­æ€§â€è¿·æ€ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬æœ€ç»ˆé€‰æ‹©äº† Lua è„šæœ¬]]></title>    <link>https://juejin.cn/post/7602811649126613043</link>    <guid>https://juejin.cn/post/7602811649126613043</guid>    <pubDate>2026-02-04T14:44:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602811649126613043" data-draft-id="7602901565024862217" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redis äº‹åŠ¡çš„â€œåŸå­æ€§â€è¿·æ€ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬æœ€ç»ˆé€‰æ‹©äº† Lua è„šæœ¬"/> <meta itemprop="keywords" content="Redis,é¢è¯•,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-02-04T14:44:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€æ—…äºº"/> <meta itemprop="url" content="https://juejin.cn/user/3485898277388519"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redis äº‹åŠ¡çš„â€œåŸå­æ€§â€è¿·æ€ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬æœ€ç»ˆé€‰æ‹©äº† Lua è„šæœ¬
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3485898277388519/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€æ—…äºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T14:44:09.000Z" title="Wed Feb 04 2026 14:44:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>å†™åœ¨å‰é¢çš„è¯</strong></p>
<p>ä½œä¸ºä¸€ä¸ªé•¿æœŸå’Œå…³ç³»å‹æ•°æ®åº“ï¼ˆRDBMSï¼‰æ‰“äº¤é“çš„å¼€å‘è€…ï¼Œåˆæ¬¡æŸ¥é˜… Redis æ–‡æ¡£æ—¶ï¼Œçœ‹åˆ° <code>MULTI</code>ã€<code>EXEC</code>ã€<code>DISCARD</code> è¿™äº›æŒ‡ä»¤ï¼Œå¿ƒä¸­éš¾å…æ¶Œèµ·ä¸€è‚¡ç”±äºç†Ÿæ‚‰è€Œå¸¦æ¥çš„å®‰å…¨æ„Ÿã€‚</p>
<p>æˆ‘ä»¬çš„å¤§è„‘ä¼šè‡ªåŠ¨å»ºç«‹æ˜ å°„ï¼š<code>MULTI</code> å°±æ˜¯ <code>BEGIN</code>ï¼Œ<code>EXEC</code> å°±æ˜¯ <code>COMMIT</code>ï¼Œ<code>DISCARD</code> å°±æ˜¯ <code>ROLLBACK</code>ã€‚è¿™å¥—ç»„åˆæ‹³æ‰“ä¸‹æ¥ï¼Œæ‰€æœ‰çš„ä¸šåŠ¡é€»è¾‘ä¼¼ä¹éƒ½åº”è¯¥å…·å¤‡äº†â€œä¸æˆåŠŸä¾¿æˆä»â€çš„åŸå­æ€§ä¿éšœã€‚</p>
<p>ä½†è¿™æ°æ°æ˜¯ Redis ç»™æˆ‘ä¸Šçš„ç¬¬ä¸€è¯¾ï¼š<strong>ç›¸ä¼¼çš„å‘½åèƒŒåï¼Œå¾€å¾€è—ç€æˆªç„¶ä¸åŒçš„çµé­‚ã€‚</strong> å½“ä½ æŠŠ MySQL çš„äº‹åŠ¡è§‚ç”Ÿæ¬ç¡¬å¥—åˆ° Redis èº«ä¸Šæ—¶ï¼Œé”™ä»˜å°±å·²ç»å¼€å§‹äº†ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« å°†å¸¦ä½ å‰¥å¼€ <strong>Redis äº‹åŠ¡</strong>çš„å¤–è¡£ï¼Œä»â€œåŸå­æ€§â€çš„å®šä¹‰åå·®è¯´èµ·ï¼ŒèŠèŠä¸ºä»€ä¹ˆåœ¨ç°ä»£å¼€å‘ä¸­ï¼Œæˆ‘ä»¬è¶Šæ¥è¶Šå€¾å‘äº<strong>ç”¨ Lua è„šæœ¬æ¥æ›¿ä»£å®ƒã€‚</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ã€å…ˆæŠŠè¯¯ä¼šè§£å¼€ï¼šRedis äº‹åŠ¡ä¸æ˜¯ ACID</h2>
<p><strong>åœ¨å…³ç³»å‹æ•°æ®åº“çš„ä¸–ç•Œé‡Œï¼Œâ€œäº‹åŠ¡â€äºŒå­—é‡è‹¥åƒé’§</strong>ï¼Œå®ƒå‡ ä¹ç­‰åŒäº <strong>ACID</strong>ï¼ˆåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ï¼‰ã€‚æˆ‘ä»¬ä¹ æƒ¯äº†â€œè¦ä¹ˆå…¨æœ‰ï¼Œè¦ä¹ˆå…¨æ— â€çš„å®‰å…¨æ„Ÿã€‚</p>
<p>è€Œåœ¨ Redis çš„ä¸–ç•Œé‡Œï¼Œ<code>MULTI</code> å’Œ <code>EXEC</code> æ›´åƒæ˜¯ä¸€ä¸ª<strong>æ‰¹å¤„ç†ä¿¡å·</strong>ï¼š</p>
<blockquote>
<p><strong>æŠŠä¸€å †å‘½ä»¤å…ˆæ”¾è¿›é˜Ÿåˆ—é‡Œæ’é˜Ÿï¼Œç­‰åˆ° <code>EXEC</code> æ—¶ï¼Œä¸€æ¬¡æ€§ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œå®ƒä»¬ã€‚</strong></p>
</blockquote>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªå·¨å¤§çš„è®¤çŸ¥åå·®ã€‚å½“æˆ‘ä»¬è°ˆè®º Redis çš„â€œåŸå­æ€§â€æ—¶ï¼ŒRedis æŒ‡çš„å…¶å®æ˜¯ <strong>éš”ç¦»æ€§ï¼ˆIsolationï¼‰</strong>ï¼Œè€Œä¸æ˜¯ <strong>å›æ»šï¼ˆRollbackï¼‰</strong>ã€‚</p>
<ul>
<li><strong>å®ƒä¿è¯çš„æ˜¯</strong>ï¼š<strong>æˆ‘æ‰§è¡Œè¿™æ®µå‘½ä»¤çš„æ—¶å€™ï¼Œåˆ«äººä¸èƒ½æ’é˜Ÿï¼ˆç‹¬å æ‰§è¡Œï¼‰ã€‚</strong></li>
<li><strong>å®ƒä¸ä¿è¯çš„æ˜¯</strong>ï¼š<strong>å¦‚æœæˆ‘æ‰§è¡Œåˆ°ä¸€åŠæŠ¥é”™äº†ï¼Œæˆ‘ä¼šå¸®ä½ æŠŠå‰é¢çš„æ“ä½œæ’¤é”€ï¼ˆå¤±è´¥å›æ»šï¼‰ã€‚</strong></li>
</ul>
<p>ä¸ºäº†æ›´ç›´è§‚åœ°ç†è§£ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ¯”ä¸€ä¸‹ Redis äº‹åŠ¡å’Œæ ‡å‡† ACID äº‹åŠ¡çš„åŒºåˆ«ï¼š</p>



































<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">å…³ç³»å‹æ•°æ®åº“ (MySQL)</th><th align="left">Redis äº‹åŠ¡</th><th align="left">å·®å¼‚è§£è¯»</th></tr></thead><tbody><tr><td align="left"><strong>åŸå­æ€§ (Atomicity)</strong></td><td align="left"><strong>All or Nothing</strong> <br/> å¤±è´¥å³å›æ»šï¼Œå¦‚åŒæœªå‘ç”Ÿè¿‡</td><td align="left"><strong>All or Partial</strong> <br/> æ²¡å¾—å•†é‡ï¼Œé”™äº†å°±é”™äº†ï¼Œå‰©ä¸‹çš„æ¥ç€å¹²</td><td align="left">Redis ä¸æ”¯æŒ Rollbackï¼Œéƒ¨åˆ†æˆåŠŸæ˜¯å¸¸æ€</td></tr><tr><td align="left"><strong>ä¸€è‡´æ€§ (Consistency)</strong></td><td align="left">å¼ºä¸€è‡´æ€§ <br/> çº¦æŸå¿…é¡»æ»¡è¶³</td><td align="left">å¼±ä¸€è‡´æ€§ <br/> ä¾èµ–ä¸šåŠ¡ä»£ç ä¿éšœ</td><td align="left">Redis ä¸ä¼šæ ¡éªŒä¸šåŠ¡çº¦æŸï¼ˆå¦‚å¤–é”®ã€éç©ºç­‰ï¼‰</td></tr><tr><td align="left"><strong>éš”ç¦»æ€§ (Isolation)</strong></td><td align="left">æœ‰å¤šç§éš”ç¦»çº§åˆ« (RC/RR/Serializable)</td><td align="left"><strong>ä¸²è¡ŒåŒ–æ‰§è¡Œ</strong> <br/> æ‰§è¡ŒæœŸé—´ä¸å¯è¢«æ‰“æ–­</td><td align="left">å¾—ç›Šäºå•çº¿ç¨‹æ¨¡å‹ï¼Œ<code>EXEC</code> æœŸé—´å¤©ç„¶éš”ç¦»</td></tr><tr><td align="left"><strong>æŒä¹…æ€§ (Durability)</strong></td><td align="left">WAL æ—¥å¿—ä¿éšœ <br/> æ‰ç”µä¸ä¸¢å¤±</td><td align="left">å–å†³äº AOF/RDB é…ç½®</td><td align="left">é»˜è®¤é…ç½®ä¸‹é€šå¸¸æœ‰æ•°æ®ä¸¢å¤±é£é™©</td></tr></tbody></table>
<blockquote>
<p><strong>ä¸€å¥è¯æ€»ç»“ï¼š</strong>
<strong>Redis äº‹åŠ¡æ˜¯â€œå‘½ä»¤é˜Ÿåˆ— + ç‹¬å æ‰§è¡Œâ€ï¼Œç»ä¸æ˜¯â€œå¤±è´¥å›æ»š + å¼ºä¸€è‡´â€ã€‚</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-1">äºŒã€æ®‹é…·çš„çœŸç›¸ï¼šå®ƒçœŸçš„ä¸åŒ…å›æ»š</h2>
<p>ä¸ºäº†æŠŠè¿™ä¸ªæ¦‚å¿µåˆ»è¿› DNAï¼Œæˆ‘ä»¬çœ‹ä¸¤ç§çœŸå®çš„é”™è¯¯åœºæ™¯ã€‚</p>
<h3 data-id="heading-2">1. å…¥é˜Ÿæ—¶çš„â€œä½çº§é”™è¯¯â€ï¼ˆå…¨å‘˜è¿åï¼‰</h3>
<p>å¦‚æœä½ åœ¨<strong>å‘½ä»¤å…¥é˜Ÿé˜¶æ®µ</strong>å°±çŠ¯äº†è¯­æ³•é”™è¯¯ï¼ˆæ¯”å¦‚å‚æ•°å†™å°‘äº†ï¼‰ï¼ŒRedis è¿˜æ˜¯è®²é“ç†çš„ï¼Œå®ƒä¼šç›´æ¥æ‹’ç»æ•´ä¸ªäº‹åŠ¡ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">127.0.0.1:6379&gt; MULTI
OK
127.0.0.1:6379&gt; SET key1 value1
QUEUED
127.0.0.1:6379&gt; SET key2      <span class="hljs-comment"># &lt;--- è¯­æ³•é”™è¯¯ï¼šå°‘äº†å‚æ•°</span>
(error) ERR wrong number of arguments <span class="hljs-keyword">for</span> <span class="hljs-string">'set'</span> <span class="hljs-built_in">command</span>
127.0.0.1:6379&gt; EXEC
(error) EXECABORT Transaction discarded because of previous errors.
</code></pre>
<p>è¿™æ—¶å€™ï¼Œ<strong>æ‰€æœ‰å‘½ä»¤éƒ½ä¸ä¼šæ‰§è¡Œ</strong>ã€‚è¿™ç¬¦åˆæˆ‘ä»¬å¯¹â€œäº‹åŠ¡â€çš„é¢„æœŸã€‚</p>
<h3 data-id="heading-3">2. æ‰§è¡Œæ—¶çš„â€œè¿è¡Œæ—¶é”™è¯¯â€ï¼ˆè™½æ­»çŠ¹è¿›ï¼‰</h3>
<p>è¿™æ‰æ˜¯çœŸæ­£çš„å‘ã€‚å‡è®¾è¯­æ³•æ²¡é—®é¢˜ï¼Œä½†åœ¨<strong>æ‰§è¡ŒæœŸé—´</strong>ï¼ŒæŸæ¡å‘½ä»¤å› ä¸ºæ•°æ®ç±»å‹ä¸åŒ¹é…æŠ¥é”™äº†ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">127.0.0.1:6379&gt; MULTI
OK
127.0.0.1:6379&gt; SET user:A:points 100
QUEUED
127.0.0.1:6379&gt; LPUSH user:A:points <span class="hljs-string">"error_data"</span>  <span class="hljs-comment"># &lt;--- å¯¹ String ç±»å‹åš List æ“ä½œï¼Œæ³¨å®šè¿è¡ŒæŠ¥é”™</span>
QUEUED
127.0.0.1:6379&gt; INCR user:A:points                 <span class="hljs-comment"># &lt;--- åç»­å‘½ä»¤</span>
QUEUED

127.0.0.1:6379&gt; EXEC
1) OK
2) (error) WRONGTYPE Operation against a key holding the wrong kind of value  &lt;--- æŠ¥é”™ï¼
3) (<span class="hljs-built_in">integer</span>) 101                                                              &lt;--- ä¾ç„¶æˆåŠŸäº†ï¼
</code></pre>
<p><strong>ç›®çªå£å‘†äº†å—ï¼Ÿ</strong>
ç¬¬äºŒæ¡å‘½ä»¤æŠ¥é”™äº†ï¼Œä½†ç¬¬ä¸‰æ¡å‘½ä»¤ä¾ç„¶æ¬¢å¿«åœ°æ‰§è¡Œäº†ã€‚æ•°æ®å‡ºç°äº†ä¸­é—´æ€ï¼šå³æ‰€è°“çš„â€œä¸ä¸€è‡´â€ã€‚</p>
<p>Redis å®˜æ–¹å¯¹æ­¤çš„è§£é‡Šéå¸¸â€œç›´ç”·â€ï¼š</p>
<blockquote>
<p>â€œåªæœ‰è¯­æ³•é”™è¯¯æ‰ä¼šè¢«æ‹¦æˆªï¼Œè¿è¡Œæ—¶é”™è¯¯å±äºç¨‹åºå‘˜çš„é€»è¾‘ Bugï¼ˆæ¯”å¦‚æŠŠ String å½“ List ç”¨ï¼‰ã€‚<strong>æ•°æ®åº“ä¸åº”è¯¥ä¸ºäº†ç¨‹åºå‘˜çš„ Bug ä¹°å•ï¼Œå»æå¤æ‚çš„å›æ»šæœºåˆ¶ã€‚</strong>â€</p>
</blockquote>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€è¿›é˜¶ä¹‹è·¯ï¼šä»åŸç”Ÿæ‰¹é‡åˆ° Lua è„šæœ¬</h2>
<blockquote>
<p><strong>ğŸ’¡ é¢„å¤‡çŸ¥è¯†ï¼šRTT æ˜¯æ€§èƒ½æ€æ‰‹</strong></p>
<p>ä¸€ä¸ª Redis å‘½ä»¤çš„æ‰§è¡Œå¯ä»¥ç®€åŒ–ä¸º 4 æ­¥ï¼š<strong>å‘é€å‘½ä»¤ â†’ å‘½ä»¤æ’é˜Ÿ â†’ å‘½ä»¤æ‰§è¡Œ â†’ è¿”å›ç»“æœ</strong>ã€‚</p>
<p>å…¶ä¸­ï¼Œç¬¬ 1 æ­¥å’Œç¬¬ 4 æ­¥çš„æ—¶é—´ä¹‹å’Œç§°ä¸º <strong>RTT (å¾€è¿”æ—¶é—´)</strong>ã€‚å¦‚æœæˆ‘æœ‰ 100 ä¸ªå‘½ä»¤ï¼Œä¸€ä¸ªä¸ªå‘å°±éœ€è¦ 100 æ¬¡ RTTï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½æµªè´¹åœ¨ç½‘ç»œä¼ è¾“ä¸Šã€‚
<strong>æ‰¹é‡æ“ä½œçš„æ ¸å¿ƒæ„ä¹‰ï¼Œå°±æ˜¯æŠŠ 100 æ¬¡ RTT å‹ç¼©æˆ 1 æ¬¡ã€‚</strong></p>
</blockquote>
<p>æ—¢ç„¶ <code>MULTI/EXEC</code> è¿™ä¹ˆâ€œå¤´é“â€ï¼Œé‚£æˆ‘ä»¬åœ¨å®é™…å¼€å‘ä¸­åˆ°åº•è¯¥æ€ä¹ˆé€‰ï¼Ÿæˆ‘ä»¬å¯ä»¥æŠŠ Redis çš„æ‰¹é‡æ“ä½œèƒ½åŠ›åˆ†ä¸ºå‡ ä¸ªæ®µä½ã€‚</p>
<h3 data-id="heading-5">Lv1. åŸç”Ÿæ‰¹é‡å‘½ä»¤ (MSET / MGET)</h3>
<p>è¿™æ˜¯æœ€ç®€å•ã€æœ€å¿«çš„æ–¹å¼ã€‚</p>
<ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šåŸç”Ÿçš„åŸå­æ€§ã€‚<code>MSET key1 val1 key2 val2</code> æ˜¯ä¸€ä¸ªåŸå­æ“ä½œï¼Œ<strong>è¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥</strong>ï¼ˆåœ¨ Redis å±‚é¢ï¼‰ã€‚</li>
<li><strong>ç¤ºä¾‹</strong>ï¼š
<pre><code class="hljs language-bash" lang="bash">MSET key1 <span class="hljs-string">"Hello"</span> key2 <span class="hljs-string">"World"</span>
</code></pre>
</li>
<li><strong>å±€é™</strong>ï¼šåªèƒ½å¤„ç†åŒä¸€ç§å‘½ä»¤ï¼Œé€»è¾‘æ­»æ¿ã€‚</li>
</ul>
<h3 data-id="heading-6">Lv2. ç®¡é“ (Pipeline)</h3>
<p>å½“ä½ éœ€è¦æ‰¹é‡æ‰§è¡Œå‡ åä¸ªä¸åŒçš„å‘½ä»¤ï¼Œä¸”ä¸éœ€è¦å®ƒä»¬ä¹‹é—´æœ‰é€»è¾‘ä¾èµ–æ—¶ï¼ŒPipeline æ˜¯é¦–é€‰ã€‚</p>
<ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼š<strong>å”¯å¿«ä¸ç ´</strong>ã€‚å®ƒæŠŠå‡ åä¸ªå‘½ä»¤æ‰“åŒ…ï¼Œä¸€æ¬¡ç½‘ç»œè¯·æ±‚ï¼ˆRTTï¼‰å‘ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ‰§è¡Œå®Œå†ä¸€æ¬¡æ€§è¿”å›ã€‚</li>
<li><strong>å½¢è±¡ç†è§£</strong>ï¼š<strong>ä¸‹ 100 ä¸ªå• -&gt; ä¸€æ¬¡æ€§æ”¶ 100 ä¸ªå¿«é€’ (1 æ¬¡ RTT)</strong>ã€‚</li>
<li><strong>ä¸äº‹åŠ¡çš„åŒºåˆ«</strong>ï¼š
<ul>
<li><strong>éåŸå­æ€§</strong>ï¼šPipeline åªæ˜¯æ‰“åŒ…å‘é€ï¼ŒRedis å¯èƒ½ä¼šåœ¨å¤„ç† Pipeline ä¸­é—´ç©¿æ’æ‰§è¡Œå…¶ä»–å®¢æˆ·ç«¯çš„å‘½ä»¤ï¼ˆäº¤é”™æ‰§è¡Œï¼‰ã€‚</li>
<li><strong>æ•ˆç‡æ›´é«˜</strong>ï¼šä¸éœ€è¦åƒäº‹åŠ¡é‚£æ ·æ¯ä¸ªå‘½ä»¤éƒ½å‘ä¸€æ¬¡ï¼Œåªéœ€è¦å‘é€ä¸€æ¬¡ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-7">Lv3. äº‹åŠ¡ (MULTI / EXEC)</h3>
<p>æ¯” Pipeline å¤šäº†ä¸€å±‚ä¿éšœï¼š<strong>ç‹¬å æ‰§è¡Œ</strong>ã€‚</p>
<ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼š<strong>åŸå­æ“ä½œï¼ˆéš”ç¦»æ€§ï¼‰</strong>ã€‚
<ul>
<li><strong>ä¸¤ä¸ªä¸åŒçš„äº‹åŠ¡ä¸ä¼šåŒæ—¶è¿è¡Œ</strong>ã€‚åœ¨ <code>EXEC</code> æ‰§è¡ŒæœŸé—´ï¼ŒRedis ä¼šâ€œä»¥æ­¤ä¸ºå°Šâ€ï¼Œä¿è¯æ²¡æœ‰å…¶ä»–å®¢æˆ·ç«¯èƒ½æ’é˜Ÿã€‚</li>
</ul>
</li>
<li><strong>ç¼ºç‚¹</strong>ï¼š
<ul>
<li><strong>RTT å¼€é”€å¤§</strong>ï¼šäº‹åŠ¡ä¸­ <strong>æ¯ä¸ªå‘½ä»¤éƒ½éœ€è¦å•ç‹¬å‘é€</strong> åˆ°æœåŠ¡ç«¯å…¥é˜Ÿï¼Œè¯·æ±‚æ¬¡æ•°å¹¶æ²¡æœ‰å‡å°‘ã€‚</li>
<li><strong>ä¸æ”¯æŒå›æ»š</strong>ï¼Œä¸æ”¯æŒåœ¨äº‹åŠ¡ä¸­é—´åšé€»è¾‘åˆ¤æ–­ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-8">Lv3.1 äº‹åŠ¡ + WATCH (ä¹è§‚é”)</h3>
<p>å•çº¯çš„ <code>MULTI/EXEC</code> å¾€å¾€æ¯”è¾ƒé¸¡è‚‹ï¼Œå› ä¸ºå®ƒæ— æ³•æ„ŸçŸ¥ä¸­é—´çŠ¶æ€ã€‚<strong>ä½†è¿™å¥—æœºåˆ¶å”¯ä¸€çš„â€œç‹ç‰Œâ€ç»„åˆæ˜¯é…åˆ <code>WATCH</code> å‘½ä»¤ï¼Œå®ç°ä¹è§‚é” (CAS)ã€‚</strong></p>
<ul>
<li>
<p><strong>åœºæ™¯</strong>ï¼šç§’æ€æ‰£å‡åº“å­˜ã€‚</p>
<ul>
<li>åœ¨ <code>MULTI</code> ä¹‹å‰ <code>WATCH stock</code>ã€‚</li>
<li>å¦‚æœåœ¨ <code>EXEC</code> æ‰§è¡Œå‰ <code>stock</code> è¢«åˆ«äººæ”¹äº†ï¼Œæ•´ä¸ªäº‹åŠ¡åŸåœ°å–æ¶ˆï¼ˆè¿”å› nilï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">WATCH stock:001                <span class="hljs-comment"># 1. ç›‘è§†åº“å­˜</span>
GET stock:001                  <span class="hljs-comment"># 2. è¯»åº“å­˜ï¼Œå‘ç°æ˜¯ 10</span>
MULTI                          <span class="hljs-comment"># 3. å¼€å¯äº‹åŠ¡ (å¼€å§‹æ’é˜Ÿ)</span>
DECR stock:001                 <span class="hljs-comment"># 4. å‡åº“å­˜</span>
EXEC                           <span class="hljs-comment"># 5. æ‰§è¡Œ</span>
<span class="hljs-comment"># å¦‚æœåœ¨æ­¥éª¤ 1-5 ä¹‹é—´ï¼Œåˆ«äººæ”¹äº† stock:001ï¼Œè¿™é‡Œä¼šè¿”å› (nil)ï¼Œäº‹åŠ¡å›æ»šã€‚</span>
</code></pre>
</li>
<li>
<p><strong>è‡´å‘½å¼±ç‚¹</strong>ï¼š<strong>é«˜å¹¶å‘ä¸‹æ€§èƒ½æå·®</strong>ã€‚</p>
<ul>
<li>å°±åƒä¸€ç¾¤äººæŠ¢ä¸€ä¸ªéº¦å…‹é£ï¼Œä¸€ä¸ªäººæŠ¢åˆ°äº†ï¼Œå…¶ä»–äººçš„ <code>CAS</code> å…¨éƒ¨å¤±è´¥ï¼Œåªèƒ½å®¢æˆ·ç«¯é‡è¯•ï¼ˆè‡ªæ—‹ï¼‰ã€‚</li>
<li><strong>ç«äº‰è¶Šæ¿€çƒˆï¼Œé‡è¯•è¶Šé¢‘ç¹ï¼ŒCPU ç©ºè½¬è¶Šä¸¥é‡ã€‚</strong></li>
</ul>
</li>
</ul>
<h3 data-id="heading-9">Lv4. æœ€ç»ˆå…µå™¨ â€”â€” Lua è„šæœ¬</h3>
<p>ä» Redis 2.6 å¼€å§‹ï¼ŒLua è„šæœ¬æˆä¸ºäº†è§£å†³å¤æ‚åŸå­æ€§é—®é¢˜çš„æ ¸å¿ƒæ–¹æ¡ˆï¼Œå®ƒå®Œç¾æ›¿ä»£äº† <code>WATCH</code> äº‹åŠ¡ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆå®ƒæ¯”äº‹åŠ¡å¼ºï¼Ÿ</strong></p>
<ol>
<li><strong>é€»è¾‘åŸå­æ€§</strong>ï¼šä¸€æ®µ Lua è„šæœ¬è¢«è§†ä½œä¸€æ¡å‘½ä»¤ã€‚Redis ä¿è¯è„šæœ¬æ‰§è¡ŒæœŸé—´ï¼Œ<strong>ä¸ä¼šæœ‰ä»»ä½•å…¶ä»–è„šæœ¬æˆ–å‘½ä»¤æ’å…¥</strong>ã€‚</li>
<li><strong>æ•ˆç‡æ›´é«˜</strong>ï¼šä¸éœ€è¦åƒ <code>WATCH</code> é‚£æ ·åå¤é‡è¯•ã€‚è„šæœ¬åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œï¼Œåªæœ‰ä¸€æ¬¡ RTTã€‚</li>
</ol>
<p><strong>ç¤ºä¾‹ï¼šå®‰å…¨çš„â€œå…ˆæŸ¥åæ”¹â€</strong></p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-comment">-- åˆ¤æ–­ key æ˜¯å¦ç­‰äºé¢„æœŸå€¼ï¼Œå¦‚æœæ˜¯åˆ™åˆ é™¤</span>
<span class="hljs-keyword">if</span> redis.call(<span class="hljs-string">"GET"</span>, KEYS[<span class="hljs-number">1</span>]) == ARGV[<span class="hljs-number">1</span>] <span class="hljs-keyword">then</span>
    <span class="hljs-keyword">return</span> redis.call(<span class="hljs-string">"DEL"</span>, KEYS[<span class="hljs-number">1</span>])
<span class="hljs-keyword">else</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p><strong>âš ï¸ å¿…é¡»è­¦æƒ•çš„ç¼ºé™·ï¼šLua ä¹Ÿä¸å›æ»šï¼</strong>
è™½ç„¶ Lua è„šæœ¬è¢«ç§°ä¸ºâ€œåŸå­æ“ä½œâ€ï¼Œä½†è¯·æ³¨æ„ï¼šå®ƒçš„åŸå­æ€§ä¾ç„¶æŒ‡çš„æ˜¯<strong>ä¸è¢«æ‰“æ‰°</strong>ï¼Œè€Œä¸æ˜¯<strong>å¤±è´¥å›æ»š</strong>ã€‚</p>
<blockquote>
<p><strong>å¦‚æœ Lua è„šæœ¬è¿è¡Œåˆ°ä¸­é€”å‡ºé”™ï¼ˆæ¯”å¦‚è°ƒç”¨äº†ä¸å­˜åœ¨çš„å‘½ä»¤ï¼Œæˆ–æ˜¾å¼æŠ¥é”™é€€å‡ºï¼‰ï¼Œè„šæœ¬ä¼šåœæ­¢æ‰§è¡Œï¼Œä½†ä¹‹å‰å·²ç»æ‰§è¡Œè¿‡çš„å†™æ“ä½œï¼Œæ˜¯ä¸ä¼šè¢«æ’¤é”€çš„ï¼</strong></p>
</blockquote>
<p>è¿™æ„å‘³ç€ï¼Œå³ä½¿æ˜¯ Luaï¼Œä¹Ÿä¸èƒ½ç»™ä½ å¸¦æ¥ RDBMS é‚£ç§â€œå›æ»šä¸€åˆ‡â€çš„å®‰å…¨æ„Ÿã€‚ä½ ä¾ç„¶éœ€è¦åœ¨ä»£ç å±‚é¢ä¿è¯é€»è¾‘çš„ä¸¥å¯†æ€§ã€‚</p>
<hr/>
<h2 data-id="heading-10">å››ã€æ€»ç»“ï¼šé€‰å‹å†³ç­–è¡¨</h2>
<p>ä¸ºäº†è®©ä½ åœ¨å®é™…ä¸šåŠ¡ä¸­ä¸å†çº ç»“ï¼Œæˆ‘æ•´ç†äº†ä¸€ä»½ç®€å•çš„å†³ç­–è¡¨ï¼š</p>



































<table><thead><tr><th align="left">éœ€æ±‚åœºæ™¯</th><th align="left">æ¨èæ–¹æ¡ˆ</th><th align="left">æ ¸å¿ƒç†ç”±</th></tr></thead><tbody><tr><td align="left"><strong>ç®€å•æ‰¹é‡è¯»å†™ (KV)</strong></td><td align="left"><strong>MSET / MGET</strong></td><td align="left">åŸç”Ÿå‘½ä»¤ï¼Œæœ€å¿«ï¼Œæœ€çœå¿ƒã€‚</td></tr><tr><td align="left"><strong>å¤§é‡ç¦»æ•£å‘½ä»¤ (æ— å…³è”)</strong></td><td align="left"><strong>Pipeline</strong></td><td align="left">ç½‘ç»œå¼€é”€æœ€ä½ï¼Œååé‡æœ€é«˜ã€‚</td></tr><tr><td align="left"><strong>éœ€è¦ CAS (ä½å¹¶å‘)</strong></td><td align="left"><strong>WATCH + MULTI</strong></td><td align="left"><strong>äº‹åŠ¡å”¯ä¸€çš„ç”¨æ­¦ä¹‹åœ°ã€‚</strong> é€‚åˆä½é¢‘ç«äº‰ï¼Œå®ç°ç®€å•ã€‚</td></tr><tr><td align="left"><strong>å¤æ‚é€»è¾‘ / é«˜å¹¶å‘</strong></td><td align="left"><strong>Lua è„šæœ¬</strong></td><td align="left"><strong>è¡Œä¸šæ ‡å‡†ã€‚</strong> é¿å…äº† CAS è‡ªæ—‹çš„æ€§èƒ½å¼€é”€ï¼ŒåŸå­æ€§å¼ºã€‚</td></tr><tr><td align="left"><strong>å³ä½¿æŠ¥é”™ä¹Ÿè¦å›æ»š</strong></td><td align="left"><strong>MySQL / RDBMS</strong></td><td align="left"><strong>åˆ«ä¸ºéš¾ Redisã€‚</strong> å®ƒæ²¡æœ‰ Undo Logï¼Œåšä¸åˆ°çœŸæ­£çš„å›æ»šã€‚</td></tr></tbody></table>
<h2 data-id="heading-11">å†™åœ¨æœ€å</h2>
<p>å›å¤´çœ‹ï¼Œ<strong>Redis äº‹åŠ¡è¿™å¥—æœºåˆ¶ï¼Œå°±åƒæ˜¯ä¸€ä¸ªâ€œå¦‚æœä¸ä»”ç»†è¯»è¯´æ˜ä¹¦ä¸€å®šä¼šç”¨é”™â€çš„åŠæˆå“ã€‚</strong></p>
<p>ä½†æ­£æ˜¯è¿™ä¸ªâ€œåŠæˆå“â€ï¼ŒæŠ˜å°„å‡ºäº† Redis æœ€åº•å±‚çš„ä»·å€¼è§‚ï¼š<strong>ä¸ºäº†æ€§èƒ½ï¼Œå¯ä»¥ç‰ºç‰²ä¸€åˆ‡â€œçœ‹èµ·æ¥å¾ˆç¾â€çš„æŠ½è±¡</strong>ã€‚å®ƒæ‹’ç»äº†æ²‰é‡çš„ Undo Logï¼Œæ‹’ç»äº†å¤æ‚çš„éš”ç¦»çº§åˆ«ï¼Œåªç•™ä¸‹äº†ä¸€ä¸ªæœ€ç®€å•çš„â€œæ’é˜Ÿæ‰§è¡Œâ€é€»è¾‘ã€‚</p>
<p>æ‰€ä»¥ï¼Œå½“æˆ‘ä»¬ä¸‹æ¬¡å†å†™ä¸‹ <code>MULTI</code> çš„æ—¶å€™ï¼Œå¿ƒé‡Œè¦æ¸…æ¥šï¼š</p>
<ul>
<li>å¦‚æœåªæ˜¯ä¸ºäº†å¿«ï¼Œ<strong>Pipeline</strong> æ‰æ˜¯é‚£ä¸ªä¸è®²æ­¦å¾·çš„â€œåŠ é€Ÿå™¨â€ã€‚</li>
<li>å¦‚æœåªæ˜¯ä¸ºäº†é˜²æ’é˜Ÿï¼Œ<strong>Transaction</strong> å¤Ÿç”¨äº†ï¼Œä½†åœ¨é«˜å¹¶å‘ä¸‹ï¼Œå®ƒè„†å¼±å¾—åƒä¸ªæ˜“ç¢å“ã€‚</li>
<li>å¦‚æœè¦å¤„ç†çœŸæ­£çš„å¤æ‚é€»è¾‘ï¼Œè¯·æ¯«ä¸çŠ¹è±«åœ°æ‹¥æŠ± <strong>Lua</strong> â€”â€” è™½ç„¶å®ƒä¹Ÿä¸ä¼šå›æ»šï¼Œä½†è‡³å°‘åœ¨â€œæ‰§è¡ŒåŸå­æ€§â€ä¸Šï¼Œå®ƒæ˜¯æˆ‘ä»¬æ‰‹é‡Œæœ€ç¨³çš„é‚£å¼ ç‰Œã€‚</li>
</ul>
<p>çœŸæ­£çš„æŠ€æœ¯æˆç†Ÿï¼Œä¸æ˜¯èƒŒè¯µå…«è‚¡æ–‡é‡Œçš„ ACID å®šä¹‰ï¼Œè€Œæ˜¯æ‡‚å¾—åœ¨<strong>ç”±äºç‰©ç†é™åˆ¶è€Œæ»¡æ˜¯é—æ†¾çš„çœŸå®ä¸–ç•Œé‡Œ</strong>ï¼Œåšå‡ºé‚£ä¸ªæœ€ä¸åçš„é€‰æ‹©ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android Studio Otter 3 å‘å¸ƒï¼šæ—¥å¸¸å¼€å‘é€‰ASè¿˜æ˜¯Cursorï¼Ÿ]]></title>    <link>https://juejin.cn/post/7603004323912286214</link>    <guid>https://juejin.cn/post/7603004323912286214</guid>    <pubDate>2026-02-05T07:46:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603004323912286214" data-draft-id="7603030564837343286" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android Studio Otter 3 å‘å¸ƒï¼šæ—¥å¸¸å¼€å‘é€‰ASè¿˜æ˜¯Cursorï¼Ÿ"/> <meta itemprop="keywords" content="Android Studio,Cursor,Flutter"/> <meta itemprop="datePublished" content="2026-02-05T07:46:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜è€åˆ˜"/> <meta itemprop="url" content="https://juejin.cn/user/662360127965769"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android Studio Otter 3 å‘å¸ƒï¼šæ—¥å¸¸å¼€å‘é€‰ASè¿˜æ˜¯Cursorï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/662360127965769/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜è€åˆ˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T07:46:17.000Z" title="Thu Feb 05 2026 07:46:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯è€åˆ˜</strong></p>
<p>å‰å‡ å¤©Android Studio Otter 3 å‘å¸ƒäº†ã€‚è¿™çœ‹èµ·æ¥ä¸æ˜¯ä¸€ä¸ªç‰¹åˆ«é‡å¤§çš„æ–°ç‰ˆæœ¬ï¼Œä½†æ˜¯å¯¹å½“å‰çš„å®¢æˆ·ç«¯å’ŒFlutterå¼€å‘è€…æ¥è¯´å´æ˜¯æœ‰ç€æ¯”è¾ƒå¤§çš„å½±å“ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè€åˆ˜åšFlutterå¼€å‘7å¹´äº†ï¼Œå¹³æ—¶å¯¹sdkç‰ˆæœ¬å’ŒIDEçš„å‡çº§å¹¶ä¸ç§¯æï¼Œä½†æ˜¯è¿™ä¸ªç‰ˆæœ¬è¦å•ç‹¬è¯´ä¸€ä¸‹çš„åŸå› ã€‚</p>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹AS Otter 3åšäº†å“ªäº›å‡çº§ï¼Œç„¶åæ¥èŠèŠå‡çº§åçš„ASå’ŒCursorè¿™æ ·çš„AI IDEç›¸æ¯”ï¼Œä½ è¯¥é€‰è°ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€Android Studio Otter 3 å‡çº§äº†å“ªäº›åŠŸèƒ½ï¼Ÿ</h2>
<h3 data-id="heading-1">1. AI æ¨¡å‹çµæ´»æ€§ä¸æœ¬åœ°åŒ–</h3>
<p>è¿™æ˜¯ AS è¿ˆå‘å¼€æ”¾çš„é‡è¦ä¸€æ­¥ï¼Œä¸å†å±€é™äºå†…ç½®æ¨¡å‹ã€‚ç°åœ¨ASç»ˆäºå‘å…¶å®ƒAI IDEçœ‹é½äº†ã€‚</p>
<p><strong>æ”¯æŒæœ¬åœ°æ¨¡å‹ (Local Models)</strong></p>
<p>å…è®¸å¼€å‘è€…é€šè¿‡ Ollama æˆ– LM Studio è¿è¡Œæœ¬åœ° LLMï¼ˆå¦‚ Llama 3, DeepSeek ç­‰ï¼‰ï¼Œæ»¡è¶³éšç§å®‰å…¨æˆ–ç¦»çº¿å¼€å‘éœ€æ±‚ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0107dedefef41e3928ef4e18db28b49~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6ICB5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770882379&amp;x-signature=2T9nVK8s88%2BrqwDPnAPHj4RdZrU%3D" alt="alt text" loading="lazy"/></p>
<p>å¾ˆå¤šå¤§å‚ç°åœ¨æœ‰è¿™æ–¹é¢çš„è§„å®šï¼Œæ¯”å¦‚è¦æ±‚åªèƒ½ä½¿ç”¨è‡ªå®¶çš„AI IDEã€‚</p>
<p>ä½†æ˜¯å®é™…æƒ…å†µæ˜¯å¯¹äºAndroidå¼€å‘æˆ–è€…Flutterå¼€å‘æ¥è¯´ï¼Œç›®å‰æ²¡æœ‰å·¥å…·èƒ½å®Œå…¨æ›¿ä»£ASåœ¨å®é™…å¼€å‘ä¸­çš„ä½œç”¨ã€‚</p>
<p><strong>æ”¯æŒè‡ªå®šä¹‰ Gemini API Key</strong></p>
<p>å¼€å‘è€…å¯ä»¥å¡«å…¥è‡ªå·±çš„ API Keyï¼Œä»è€Œç›´æ¥è°ƒç”¨ Google æœ€æ–°çš„ Gemini 3 Pro å’Œ Gemini 3 Flash æ¨¡å‹ã€‚</p>
<p>è¿™æ ·å¯ä»¥è·å¾—æ›´å¤§çš„ä¸Šä¸‹æ–‡çª—å£ï¼ˆContext Windowï¼‰å’Œæ›´é«˜çš„é…é¢ï¼Œç‰¹åˆ«é€‚åˆå¤„ç†å¤æ‚çš„ä»£ç åº“ã€‚</p>
<p><strong>è¿œç¨‹æ¨¡å‹æ”¯æŒ</strong></p>
<p>å…è®¸æ¥å…¥ OpenAI (GPT)ã€Anthropic (Claude) ç­‰ç¬¬ä¸‰æ–¹è¿œç¨‹æ¨¡å‹ï¼Œéœ€é…ç½® API ç«¯ç‚¹å’Œå¯†é’¥ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0770a77878774714bd2cdeabeacef5bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6ICB5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770882379&amp;x-signature=MCA8%2BWEfMgogSGjEvgip7QZ36%2BA%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">2. æ™ºèƒ½ä½“æ¨¡å¼ (Agent Mode) å¢å¼º</h3>
<p>AS çš„ Agent Mode å˜å¾—æ›´åƒä¸€ä¸ªå…¨èƒ½ç»“å¯¹ç¨‹åºå‘˜ï¼Œå…·å¤‡äº†æ„ŸçŸ¥å’Œæ“ä½œè®¾å¤‡çš„èƒ½åŠ›ã€‚</p>
<p><strong>è®¾å¤‡äº¤äº’ä¸éªŒè¯ (Device Actions)</strong></p>
<p>Agent ç°åœ¨ä¸ä»…ä»…æ˜¯å†™ä»£ç ï¼Œè¿˜å¯ä»¥ éƒ¨ç½²åº”ç”¨åˆ°è®¾å¤‡ ï¼Œå¹¶çœ‹åˆ°å±å¹•å†…å®¹ã€æ£€æŸ¥ Logcat æ—¥å¿—ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´å®ƒå¯ä»¥åœ¨ä¿®æ”¹ä»£ç åï¼Œè‡ªåŠ¨è¿è¡Œ App å¹¶éªŒè¯ä¿®å¤æ˜¯å¦ç”Ÿæ•ˆã€‚</p>
<p><strong>å˜æ›´æŠ½å±‰ (Changes Drawer)</strong></p>
<p>æ–°å¢äº†ä¸€ä¸ªä¸“é—¨çš„é¢æ¿æ¥ç®¡ç† Agent äº§ç”Ÿçš„ä»£ç å˜æ›´ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/87ba4fec029548a898dcf3179925fc91~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6ICB5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770882379&amp;x-signature=qK2xffInzDTGr%2FuIqpwhJY4Kvjo%3D" alt="" loading="lazy"/></p>
<p>å¼€å‘è€…å¯ä»¥æŸ¥çœ‹æ‰€æœ‰ä¿®æ”¹çš„æ–‡ä»¶åˆ—è¡¨ï¼Œé€šè¿‡ Diff è§†å›¾é€ä¸ªå®¡æŸ¥ã€æ¥å—æˆ–å›æ»šæ›´æ”¹ï¼Œè§£å†³äº† AI ä¹±æ”¹ä»£ç éš¾ä»¥è¿½è¸ªçš„é—®é¢˜ã€‚</p>
<p><strong>å¤šçº¿ç¨‹å¯¹è¯ (Multiple Conversation Threads)</strong></p>
<p>æ”¯æŒåŒæ—¶è¿›è¡Œå¤šä¸ªç‹¬ç«‹çš„å¯¹è¯çº¿ç¨‹ï¼Œé¿å…ä¸åŒä»»åŠ¡çš„ä¸Šä¸‹æ–‡æ··æ·†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/350d6d1a099f41749c3c86fbfb25066d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6ICB5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770882379&amp;x-signature=j9KdS2DWJV4h%2BBrisAo5v%2BjwHnQ%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">3. å¼€å‘ä¸æµ‹è¯•æ–°ä½“éªŒ</h3>
<p><strong>Journeys (è‡ªç„¶è¯­è¨€ UI æµ‹è¯•)</strong></p>
<p>éœ€åœ¨ Studio Labs ä¸­å¼€å¯</p>
<p>åˆ©ç”¨ Gemini çš„è§†è§‰å’Œæ¨ç†èƒ½åŠ›ï¼Œå¼€å‘è€…å¯ä»¥ç”¨è‡ªç„¶è¯­è¨€ç¼–å†™ç«¯åˆ°ç«¯çš„ UI æµ‹è¯•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7e04accfce74de1b0816493a4e3bc3c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6ICB5YiY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770882379&amp;x-signature=eFYgCaOL3Allqx3IDHwC0jKxBNw%3D" alt="" loading="lazy"/></p>
<p>Gemini ä¼šå°†â€œç‚¹å‡»ç™»å½•æŒ‰é’®â€è¿™æ ·çš„æŒ‡ä»¤è½¬æ¢ä¸ºå®é™…çš„æµ‹è¯•æ“ä½œï¼Œå¹¶æ ¹æ®å±å¹•è§†è§‰å†…å®¹è¿›è¡Œæ–­è¨€ï¼Œæ¯”ä¼ ç»Ÿçš„ View æŸ¥æ‰¾æ–¹å¼æ›´ç¨³å¥ã€‚</p>
<p><strong>Logcat è‡ªåŠ¨ R8 åæ··æ·†</strong></p>
<p>åœ¨ä½¿ç”¨ AGP 9.0 (æˆ– 8.12+) ä¸”å¼€å¯ R8 ( minifyEnabled = true ) æ—¶ï¼ŒLogcat ç°åœ¨ä¼šè‡ªåŠ¨è¿˜åŸï¼ˆRetraceï¼‰å †æ ˆä¿¡æ¯ï¼Œæ— éœ€å†æ‰‹åŠ¨ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·è¿›è¡Œæ˜ å°„ï¼Œæå¤§æ–¹ä¾¿äº† Release åŒ…çš„ Crash æ’æŸ¥ã€‚</p>
<p>è¯è¯´è¿™ä¸€ç‚¹æ˜¯è€åˆ˜è¿™æ ·çš„ä¼ä¸šå¼€å‘è€…éå¸¸éœ€è¦çš„ï¼Œå¯¹äºå®šä½çº¿ä¸Šé—®é¢˜å¯ä»¥çœä¸å°‘äº‹ã€‚</p>
<h3 data-id="heading-4">4. æ”¯æŒAGP 9.0</h3>
<p>ä¸‹è¡¨åˆ—å‡ºäº†å„ä¸ª Android Studio ç‰ˆæœ¬éœ€è¦çš„ AGP ç‰ˆæœ¬ã€‚</p>













































<table><thead><tr><th>Android Studio ç‰ˆæœ¬</th><th>AGP ç‰ˆæœ¬</th></tr></thead><tbody><tr><td>Otter 3 åŠŸèƒ½æ›´æ–° | 2025.2.3</td><td>4.0â€“9.0</td></tr><tr><td>Otter 2 åŠŸèƒ½æ›´æ–° | 2025.2.2</td><td>4.0â€“8.13</td></tr><tr><td>Otter | 2025.2.1</td><td>4.0â€“8.13</td></tr><tr><td>Narwhal 4 åŠŸèƒ½æ›´æ–° | 2025.1.4</td><td>4.0â€“8.13</td></tr><tr><td>Narwhal 3 åŠŸèƒ½æ›´æ–° | 2025.1.3</td><td>4.0â€“8.13</td></tr><tr><td>Narwhal åŠŸèƒ½æ›´æ–° | 2025.1.2</td><td>4.0â€“8.12</td></tr><tr><td>Narwhal | 2025.1.1</td><td>3.2â€“8.11</td></tr><tr><td>Meerkat åŠŸèƒ½æ›´æ–° | 2024.3.2</td><td>3.2â€“8.10</td></tr><tr><td>Meerkat | 2024.3.1</td><td>3.2â€“8.9</td></tr></tbody></table>
<h2 data-id="heading-5">äºŒã€æ—¥å¸¸å¼€å‘é€‰ASè¿˜æ˜¯Cursorï¼ˆFlutter å¼€å‘è€…è§†è§’ï¼‰ ï¼Ÿ</h2>
<p>äºæ˜¯ä¸€ä¸ªé—®é¢˜å°±å‡ºç°äº†ï¼šæ—¥å¸¸å¼€å‘é€‰ASè¿˜æ˜¯Cursor / Trae è¿™æ ·çš„AI IDE ï¼Ÿ</p>
<h3 data-id="heading-6">1. AI IDEèƒ½å®Œå…¨æ›¿ä»£ASå—ï¼ˆFlutter å¼€å‘è€…è§†è§’ï¼‰ï¼Ÿ</h3>
<p>æ¯”å¦‚è€åˆ˜è‡ªå·±ï¼Œè¿‘å‡ ä¸ªæœˆæ¥ï¼Œç”¨Cursoræˆ–è€…Traeçš„æ—¶é—´è¶Šæ¥è¶Šå¤šäº†ã€‚</p>
<p>å…¶å®è¿™ä¸­é—´ä¸€ä¸ªæœ€é‡è¦çš„å½±å“å› ç´ æ˜¯æ€§ä»·æ¯”ã€‚</p>
<p>æ¯”å¦‚Trae æ¯ä¸ªæœˆ10åˆ€ï¼Œè™½ç„¶æ²¡æœ‰äº†Claudeæ¨¡å‹ï¼Œä½†æ˜¯Gemini 3 Pro ç”¨èµ·æ¥ä¹Ÿè¿˜æ˜¯ä¸é”™çš„ã€‚</p>
<p>è¿™æ˜¯ç›®å‰è€åˆ˜ä½¿ç”¨çš„æœ€å…·æ€§ä»·æ¯”çš„æ–¹æ¡ˆäº†ï¼Œè€Œä¸”è¿˜ä¸ç”¨æ¯æ¬¡å†™ä»£ç éƒ½è€ƒè™‘ç½‘ç»œé—®é¢˜ã€‚</p>
<p>Cursor è™½ç„¶è¦20åˆ€ï¼Œä½†æ˜¯å®ƒçš„åŠŸèƒ½æ›´åŠ å¼ºå¤§ï¼Œè€Œä¸”å¯ä»¥ç”¨claudeç³»åˆ—æ¨¡å‹ã€‚</p>
<p>é‚£ä¹ˆ Trae æˆ–è€… Cursorèƒ½å®Œå…¨æ›¿ä»£ASå—ï¼Ÿ</p>
<p><strong>ç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚</strong></p>
<p>æ ¹æœ¬åŸå› åœ¨äºAIåœ¨å¤§å‹é¡¹ç›®ç‰¹åˆ«æ˜¯ä¼ä¸šé¡¹ç›®çš„å¼€å‘ä¸­è¿˜æ²¡åŠæ³•å®Œå…¨æ›¿ä»£ç¨‹åºå‘˜çš„ä½œç”¨ã€‚</p>
<h4 data-id="heading-7">ä¸ªäººå¼€å‘å’Œä¼ä¸šå¼€å‘çš„å·®å¼‚ï¼ˆFlutter å¼€å‘è€…è§†è§’ï¼‰</h4>
<p>è¿™å¯èƒ½æ˜¯å¾ˆå¤šäººçš„ä¸€ä¸ªè¯¯åŒºï¼Œè§‰å¾—AIç°åœ¨ä»€ä¹ˆæ ·çš„ä»£ç éƒ½èƒ½å†™å‡ºæ¥ï¼Œåº”è¯¥èƒ½ä»£æ›¿å¤§éƒ¨åˆ†å¼€å‘è€…äº†ã€‚</p>
<p>æ¯”å¦‚ä½ å¯èƒ½ä¸€å¥è¯å°±å¯ä»¥åˆ©ç”¨AIå†™ä¸€ä¸ªå¾ˆæ¼‚äº®çš„Appã€‚</p>
<p>ä½†æ˜¯å®é™…ä¸Šä¼ä¸šå¼€å‘å’Œå¾ˆå¤šä¸ªäººå¼€å‘è€…å¼€å‘æ˜¯å®Œå…¨ä¸åŒçš„å·¥ä½œæ–¹å¼ã€‚</p>
<p><strong>å¯¹ä¸ªäººå¼€å‘è€…æ¥è¯´</strong></p>
<p>é‡è¦çš„æ˜¯çœ‹åˆ°éœ€æ±‚å’Œå¸‚åœºï¼Œç„¶ååˆ©ç”¨AIå¿«é€Ÿå®ç°æƒ³è¦çš„åŠŸèƒ½ã€‚</p>
<p>è¿™ç§æƒ…å†µä¸‹åªè¦AIå†™å‡ºæ¥çš„ä»£ç åŠŸèƒ½æ­£ç¡®ï¼Œç•Œé¢æ¼‚äº®ï¼Œé‚£ä¹ˆå°±å¯ä»¥å‘å¸ƒï¼Œç„¶åå†æ ¹æ®ç”¨æˆ·çš„åé¦ˆè¿›è¡Œè¿­ä»£ã€‚</p>
<p>æ¯”å¦‚ä½ è®©AIå†™ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œä»–å°±èƒ½è‡ªåŠ¨å®ç°ä¸€ä¸ªæ¼‚äº®çš„ç™»å½•ç•Œé¢ï¼Œè€Œä¸”åŠŸèƒ½ä¹Ÿæ¯”è¾ƒå®Œå–„ã€‚</p>
<p><strong>å¯¹ä¼ä¸šå¼€å‘è€…æ¥è¯´</strong></p>
<p>å¼€å‘è€…éœ€è¦100%çš„å®ç°äº§å“å›¢é˜Ÿéœ€æ±‚æè¿°ä¸­çš„æ¯ä¸€ä¸ªç»†èŠ‚ã€‚</p>
<p>UIä¸Šï¼Œä½ çš„æ¯ä¸€ä¸ªåƒç´ ã€æ¯ä¸€ä¸ªäº¤äº’çš„ç»†èŠ‚ï¼Œéƒ½éœ€è¦100% çš„è¿˜åŸUI/UE è®¾è®¡ï¼Œè€Œä¸æ˜¯ç”¨AIå®ç°ä¸€ä¸ªå·®ä¸å¤šçš„ä¸œè¥¿ã€‚</p>
<p>åœ¨åŠŸèƒ½é€»è¾‘ä¸Šæ›´æ˜¯å¦‚æ­¤ã€‚</p>
<p>å¾ˆå¤šåŠŸèƒ½çš„ç»†èŠ‚æ˜¯è¿è¥ã€äº§å“ã€å¼€å‘ã€æµ‹è¯•å¤šä¸ªå›¢é˜Ÿçš„äººååœ¨ä¸€èµ·è®¨è®ºå‡ºæ¥çš„ï¼Œè™½ç„¶æœ€åä¼šè½åœ¨éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦è¿™æ ·çš„æ–‡æ¡£ä¸­ï¼Œä½†æ˜¯æ–‡æ¡£æ¯•ç«Ÿæ²¡åŠæ³•å®Œå…¨æè¿°å‡ºæ¯ä¸€ä¸ªç»†èŠ‚ã€‚</p>
<p>æ‰€ä»¥å®é™…å¼€å‘ä¸­æœ‰å¾ˆå¤šä¸œè¥¿è¿˜æ˜¯åªå­˜åœ¨äºå¼€å‘è€…çš„è„‘æµ·ä¸­ï¼Œæˆ–è€…æ˜¯éšæ—¶ä¸äº§å“å›¢é˜Ÿè¿›è¡Œæ²Ÿé€šã€‚</p>
<p>æ‰€ä»¥ç»™AIä¸€ä¸ªéœ€æ±‚è¯´æ˜æ–‡æ¡£ï¼Œç„¶åAIå®ç°ä¸€ä¸ªå·®ä¸å¤šçš„ä»£ç ï¼Œæ˜¯å®Œå…¨è¡Œä¸é€šçš„ã€‚</p>
<p>æœ€åè¿˜æ˜¯éœ€è¦å¼€å‘è€…è‡ªå·±å»å®ç°æˆ–è€…è°ƒæ•´å¾ˆå¤šçš„ç»†èŠ‚ã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ç‰¹åˆ«æ˜¯å®¢æˆ·ç«¯é¡¹ç›®ä¸­ï¼Œä¸ç®¡æ˜¯AndroidåŸç”Ÿè¿˜æ˜¯Flutteré¡¹ç›®ï¼ŒASå¯¹å¼€å‘æ¥è¯´æ•ˆç‡éƒ½ä¼šæ›´é«˜ä¸€äº›ã€‚</p>
<h4 data-id="heading-8">ASåœ¨bugå®šä½å’Œæ€§èƒ½åˆ†ææ–¹é¢æ›´æ–¹ä¾¿</h4>
<p>AS å¯¹ bug å®šä½å’Œæ€§èƒ½åˆ†ææä¾›äº†æ›´æ–¹ä¾¿çš„å·¥å…·å’ŒåŠŸèƒ½ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬å‰é¢æåˆ°çš„è¿™æ¬¡ASæ›´æ–°çš„åŠŸèƒ½ï¼Œ<strong>Logcat è‡ªåŠ¨ R8 åæ··æ·†</strong>ã€‚</p>
<p>å†æ¯”å¦‚ï¼ŒAS è¿˜æä¾›äº†æ€§èƒ½åˆ†æå·¥å…·ï¼Œå¦‚ Profiler å¯ä»¥å¸®åŠ©å¼€å‘è€…åˆ†æåº”ç”¨çš„æ€§èƒ½ç“¶é¢ˆï¼Œä¼˜åŒ–åº”ç”¨çš„æ€§èƒ½ã€‚</p>
<p>è™½ç„¶ä¹Ÿæœ‰ä¸€äº›ç½‘é¡µç‰ˆçš„å·¥å…·æ¯”å¦‚Flutterçš„dev toolsï¼Œä½†æ˜¯å§‹ç»ˆæ²¡æœ‰ASå†…éƒ¨çš„é¡ºæ‰‹ä¸”æ–¹ä¾¿ã€‚</p>
<h3 data-id="heading-9">2. æ—¥å¸¸å¼€å‘Flutteré¡¹ç›®ï¼Œè€åˆ˜ç”¨å•¥å·¥å…·ï¼Ÿ</h3>
<p>æ—¥å¸¸å¼€å‘Flutteré¡¹ç›®çš„æ—¶å€™è€åˆ˜åˆ°åº•æ˜¯ç”¨Traeè¿˜æ˜¯ASå‘¢ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯ä¸¤ä¸ªéƒ½ç”¨ã€‚</p>
<h4 data-id="heading-10">æ–¹æ¡ˆè®¾è®¡ç”¨Trae</h4>
<p>åœ¨çœŸæ­£å¼€å§‹å†™ä»£ç å‰ï¼Œé€šå¸¸æˆ‘ä¼šå’ŒAIè®¨è®ºä¸€ä¸‹æ¶æ„æ–¹æ¡ˆã€‚</p>
<p>æ¯”å¦‚æ¨¡å—å¦‚ä½•æ‹†åˆ†ï¼Œæ•°æ®æµå¦‚ä½•è®¾è®¡ç­‰ç­‰ã€‚</p>
<h4 data-id="heading-11">å¤§å—ä»£ç ç”¨Trae</h4>
<p>å› ä¸ºè€åˆ˜å·¥ä½œä¸­å¤§éƒ¨åˆ†çš„é¡¹ç›®åŸºç¡€è®¾æ–½å·²ç»å°è£…å“ˆäº†ï¼Œå³ä½¿å¼€æ–°çš„Appï¼Œå¤§æ¦‚ç‡ä¹Ÿä¼šåŸºäºè¿™äº›åŸºç¡€è®¾æ–½è¿›è¡Œå¼€å‘ã€‚</p>
<p>æ¯”å¦‚Flutterçš„çŠ¶æ€ç®¡ç†ã€è·¯ç”±ç®¡ç†ã€åº•å±‚æ•°æ®åº“ã€æœåŠ¡ç«¯æ¥å£ç­‰ç­‰ï¼Œéƒ½æœ‰ç°æˆçš„å°è£…å¥½çš„ä»£ç å¯ä»¥ç”¨ã€‚</p>
<p>æ‰€ä»¥æˆ‘é€šå¸¸å¯ä»¥åœ¨é¡¹ç›®çš„æ—©æœŸå°±è¿›å…¥ä¸šåŠ¡é€»è¾‘çš„å¼€å‘é˜¶æ®µã€‚</p>
<p>è¿™ä¸ªé˜¶æ®µæˆ‘ä¸»è¦ç”¨çš„æ˜¯Traeï¼Œå› ä¸ºå®ƒä¾¿å®œã€‚</p>
<p>æ³¨æ„è¿™é‡Œå¹¶ä¸æ˜¯è¯´ä¸€æ¬¡äº¤ç»™AIä¸€ä¸ªé¡µé¢ï¼Œè®©ä»–ä¸€æ¬¡æ€§å®Œæˆã€‚</p>
<p>æˆ‘ä¼šåˆ†æˆå¤šä¸ªæ­¥éª¤ã€‚</p>
<p>æ¯”å¦‚å…ˆç”Ÿæˆä¸€ä¸ªé¡µé¢æ¡†æ¶ï¼ŒæŠŠæ ‡é¢˜ã€é¡µé¢ç»“æ„ã€èƒŒæ™¯è‰²ç­‰åŸºæœ¬å…ƒç´ å…ˆå†™å¥½ã€‚</p>
<p>ç„¶åå°†é¡µé¢çš„å…·ä½“å†…å®¹åˆ†æˆå‡ ä¸ªæ¨¡å—ã€‚</p>
<p>æ¯ä¸ªæ¨¡å—å•ç‹¬è®©Traeå®ç°ã€‚</p>
<p>æ¯”å¦‚å…ˆå®ç°ä¸€ä¸ªå•†å“æè¿°å¡ç‰‡ï¼Œç„¶åå®ç°ç±»ä¼¼å•†å“æ¨èå¡ç‰‡ã€‚</p>
<p>æ¯ä¸ªæ¨¡å—å®ç°å®Œåï¼Œå…ˆæ£€æŸ¥ä¸€ä¸‹ä»£ç æ˜¯å¦ç¬¦åˆè§„èŒƒï¼Œæ˜¯å¦æœ‰é”™è¯¯ã€‚</p>
<p>å¦‚æœæœ‰é”™è¯¯ï¼Œå’ŒAIè¿›è¡Œæ²Ÿé€šï¼Œç„¶åä¸€èµ·è§£å†³ã€‚</p>
<p>è¿™ä¸ªè¿‡ç¨‹ä¸­éœ€è¦AIè¿›è¡Œå¤šæ¬¡æ²Ÿé€šï¼Œç›´åˆ°æ¨¡å—å®ç°ç¬¦åˆé¢„æœŸã€‚</p>
<h4 data-id="heading-12">ç»†èŠ‚è°ƒæ•´ç”¨AS</h4>
<p>å‰é¢è¯´äº†ï¼ŒAIæ²¡åŠæ³•100%çš„å®Œæˆéœ€æ±‚çš„æ‰€æœ‰ç»†èŠ‚ã€‚</p>
<p>å› æ­¤Traeå®ç°çš„ä»£ç åªæ˜¯ä¸€ä¸ªåˆå§‹ç‰ˆæœ¬ï¼Œéœ€è¦å¼€å‘è€…è‡ªå·±å»è°ƒæ•´å’Œå®Œå–„ã€‚</p>
<p>å…¶ä¸­æ¯”è¾ƒç®€å•çš„é—®é¢˜ç›´æ¥åœ¨Traeä¸­å°±ä¿®æ”¹äº†ï¼Œæ¯”å¦‚å¸ƒå±€é—®é¢˜ã€‚</p>
<p>æœ‰äº›é—®é¢˜å’ŒAIå¤šæ¬¡æ²Ÿé€šéƒ½æ²¡åŠæ³•å¾ˆå¥½çš„è§£å†³ï¼Œæ¯”å¦‚ä¸€äº›æ¯”è¾ƒå¤æ‚çš„äº¤äº’é€»è¾‘ã€‚</p>
<p>è¿™ç§é—®é¢˜å¯èƒ½å°±ä¼šæ”¾åˆ°ASä¸­è‡ªå·±å»å®ç°ã€‚</p>
<p>ä½†æ˜¯è¿™ä¸ªåˆ‡æ¢ä¸æ˜¯å¾ˆé¢‘ç¹ã€‚</p>
<p>æ¯”å¦‚ä»Šå¤©ä¸»è¦ç”¨Traeå®ç°å¤§éƒ¨åˆ†ä»£ç ï¼Œé‚£å³ä½¿è¦è‡ªå·±å†™ä¸€äº›ä»£ç ï¼Œå°±ä¹Ÿä¼šåœ¨Traeä¸­å®Œæˆã€‚</p>
<p>ç­‰ç¬¬äºŒå¤©ä¸Šç­æƒ³æƒ³ä»Šå¤©çš„ä»»åŠ¡ä¸»è¦æ˜¯è‡ªå·±å†™ï¼Œé‚£å°±ä¼šåœ¨ASä¸­å®Œæˆã€‚</p>
<h4 data-id="heading-13">bugä¿®å¤ä¸»è¦ç”¨AS</h4>
<p>ä»£ç å®Œæˆæäº¤æµ‹è¯•åå¤§æ¦‚ç‡ä¼šæœ‰ä¸€äº›bugï¼ˆå…¶å®æˆ‘ä»¬ç”¨TDDä¼šé¿å…å¾ˆå¤šbugï¼Œä½†æ²¡æ³•åšåˆ°å®Œå…¨æ²¡æœ‰ï¼‰ã€‚</p>
<p>è¿™ç§æƒ…å†µä¸‹å®šä½bugå¯èƒ½æ›´å¤šçš„æ˜¯åœ¨ASä¸­ã€‚</p>
<p>ä»¥ä¸ºç»è¿‡TDDçš„éªŒè¯ï¼Œé‚£äº›ç®€å•çš„bugæ˜¯ä¸ä¼šè¿›å…¥åˆ°æµ‹è¯•ç¯å¢ƒçš„ã€‚</p>
<p>æ‰€ä»¥è¿™ä¸ªé˜¶æ®µæ”¶åˆ°çš„bugåŸºæœ¬éƒ½æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œæ¯”å¦‚é‚£äº›éš¾ä»¥å¤ç°çš„ï¼Œæˆ–è€…éš¾ä»¥å®šä½çš„ã€‚</p>
<p>è¿™ç§bugäº¤ç»™AIé€šå¸¸æ•ˆæœå¹¶ä¸ç†æƒ³ã€‚å› ä¸ºAIå¹¶ä¸èƒ½çœŸæ­£ç†è§£ä½ çš„é—®é¢˜ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªåŸºäºæ¦‚ç‡çš„æ¨¡å¼åŒ¹é…çš„æœºå™¨ã€‚</p>
<p>æ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒASçš„bugå®šä½å’Œä¿®å¤å·¥å…·å°±ä¼šéå¸¸æ–¹ä¾¿ã€‚</p>
<p>å¥½äº†ï¼Œæ€»ç»“ä¸€ä¸‹å°±æ˜¯ç°é˜¶æ®µAIå¹¶ä¸èƒ½å®Œå…¨æ›¿ä»£ç¨‹åºå‘˜å®Œæˆå¼€å‘å·¥ä½œï¼Œç‰¹åˆ«æ˜¯åœ¨ä¼ä¸šçº§é¡¹ç›®çš„å¼€å‘ä¸­ã€‚æ‰€ä»¥è€åˆ˜è‡ªå·±ç›®å‰çš„å®é™…ç”¨æ³•æ˜¯Traeå’ŒASæ··åˆä½¿ç”¨ã€‚</p>
<h2 data-id="heading-14">ä¸‰ã€ä¸ºå•¥ä¸æClaude Codeï¼Ÿ</h2>
<p>åˆ°è¿™é‡Œå¯èƒ½å¾ˆå¤šäººæœ‰ç–‘é—®ï¼Œä¸ºå•¥æ²¡æœ‰æClaude Codeè¿™ç±»å¼€å‘å·¥å…·ï¼Ÿå…¶å®æœ‰ä¸¤ä¸ªåŸå› </p>
<h3 data-id="heading-15">1. åŸºäºç»ˆç«¯çš„AIå¼€å‘å·¥å…·ä¸é™IDE</h3>
<p>è€åˆ˜è§‰å¾—è¿™æ˜¯åŸºäºcliçš„å¼€å‘å·¥å…·æœ€èªæ˜çš„åœ°æ–¹ï¼Œé¿å¼€äº†å’Œå„ç§IDEçš„ç›´æ¥ç«äº‰ï¼Œå¯ä»¥æ— ç¼è¡”æ¥åˆ°ä»»ä½•ä¸€ä¸ªIDEä¸­ã€‚</p>
<p>ä½†æ˜¯è¿˜æ˜¯è¦è¯´å›æ¥ï¼ŒCLIç±»çš„å¼€å‘å·¥å…·æ¯•ç«Ÿæ— æ³•å®Œå…¨ä»£æ›¿IDEã€‚</p>
<p>å°±å¥½åƒæˆ‘ä»¬å‰é¢è¯´çš„ï¼Œç°é˜¶æ®µåœ¨ä¼ä¸šçº§å¼€å‘ä¸­AIè¿˜æ²¡åŠæ³•100%å®Œæˆéœ€æ±‚</p>
<p>æ—¢ç„¶è¿˜éœ€è¦å¼€å‘è€…çš„å¹²é¢„ï¼Œé‚£ä¹ˆå°±è¿˜æ˜¯æ— æ³•ç»•å¼€IDEè€Œå®Œå…¨åˆ‡æ¢åˆ°çº¯cliå¼€å‘å·¥å…·ä¸Šã€‚</p>
<h3 data-id="heading-16">2. æ€§ä»·æ¯”ä¸é«˜</h3>
<p>è€åˆ˜ç”¨Claude Codeçš„æ—¶é—´å…¶å®ä¹Ÿä¸ç®—çŸ­ã€‚æ€»ç»“Claude Codeæœ‰ä¸¤ä¸ªé—®é¢˜</p>
<p><strong>ç¬¬ä¸€ä¸ªæ˜¯å®˜æ–¹è´¦å·å¤ªå®¹æ˜“å°å·äº†ã€‚</strong></p>
<p>è€åˆ˜è‡ªå·±è¢«å°äº†ä¸¤ä¸ªè´¦å·ï¼Œèº«è¾¹çš„åŒäº‹ä¹ŸåŸºæœ¬éƒ½æœ‰ä¸­æ‹›çš„ã€‚</p>
<p>è¿™å°±é€ æˆäº†ç”¨èµ·æ¥å¾ˆä¸ç¨³å®šï¼Œè€Œä¸”æå¿ƒåŠèƒ†çš„ã€‚</p>
<p>æ‰€æœ‰ç¬¬äºŒä¸ªè´¦å·è¢«å°åï¼Œè€åˆ˜å°±ç›´æ¥è½¬ç”¨å›½å†…çš„APIä»£ç†äº†ã€‚</p>
<p><strong>ç¬¬äºŒä¸ªæ˜¯ä»·æ ¼è¾ƒé«˜</strong></p>
<p>å…¶å®claudeå®˜æ–¹è´¦å·æœ¬èº«è®¢é˜…å°±ä¸ä¾¿å®œã€‚</p>
<p>ç›¸ä¿¡ç›®å‰æ„¿æ„ç»™å‘˜å·¥ä»˜è´¹claudeè´¦å·çš„å…¬å¸å¯¥å¯¥å¯æ•°å§ï¼Ÿ</p>
<p>å¦‚æœè®©å‘˜å·¥è‡ªå·±ä¹°ï¼Œé‚£ç›¸å½“äºä»˜è´¹ä¸Šç­äº†ï¼Œè¿™ä¸ªå¯¹å¤§å¤šæ•°ç‰›é©¬æ¥è¯´ä¼°è®¡æ˜¯ä¸ä¼šå¹²çš„ã€‚</p>
<p>æ‰€ä»¥å®˜æ–¹è®¢é˜…å…¶å®æ›´é€‚åˆé‚£äº›ç‹¬ç«‹å¼€å‘è€…ã€‚</p>
<p>æ¯”å¦‚å¦‚æœè€åˆ˜å»å†™åç«¯ä»£ç ï¼Œå› ä¸ºæˆ‘è‡ªå·±ä¹Ÿä¸ç†Ÿï¼Œæ‰€ä»¥å¯èƒ½å°±éœ€è¦å’Œé€šè¿‡AIè¿›è¡Œåå¤çš„ä¿®æ”¹ã€‚</p>
<p>è¿™æ—¶å€™å®˜æ–¹çš„è®¢é˜…åŸºæœ¬ä¸Šèƒ½é”å®šä¸€ä¸ªå°é¡¶çš„ä»·æ ¼ï¼Œæ€»çš„æ¥è¯´å°±è¿˜æ˜¯æ¯”è¾ƒåˆé€‚çš„ã€‚</p>
<p>é‚£å›½å†…çš„ APIä»£ç†æ€ä¹ˆæ ·å‘¢ï¼Ÿ</p>
<p>è¿™ä¸ªæœ€å¤§çš„é—®é¢˜æ˜¯å¤§å¤šæ•°ä»£ç†éƒ½æ˜¯æŒ‰ä½¿ç”¨é‡æ”¶è´¹ï¼Œå°‘æœ‰åŒ…æœˆçš„ï¼Œæˆ–è€…åŒ…æœˆæ¯”å®˜æ–¹è¿˜è´µã€‚</p>
<p>æŒ‰ä½¿ç”¨é‡çš„è¯ï¼Œè€åˆ˜å»ºè®®ä¸è¦è½»æ˜“å°è¯•ï¼ŒåŸºæœ¬ä¸Šæ˜¯ å‡ ç¾åˆ€æ¯å°æ—¶çš„æ ·å­ã€‚</p>
<h2 data-id="heading-17">å››ã€æ€»ç»“</h2>
<p>æ€»çš„æ¥è¯´Android Studio Otter 3 çš„å‘å¸ƒï¼Œæ ‡å¿—ç€å®˜æ–¹ IDE åœ¨å¼€æ”¾æ€§å’Œæ™ºèƒ½åŒ–ä¸Šè¿ˆå‡ºäº†é‡è¦ä¸€æ­¥ï¼Œç‰¹åˆ«æ˜¯æœ¬åœ°æ¨¡å‹æ”¯æŒå’Œ Agent æ¨¡å¼çš„å¢å¼ºï¼Œè®©å®ƒåœ¨ä¸“ä¸šå¼€å‘é¢†åŸŸä¾ç„¶ç¨³å›ºã€‚</p>
<p>ä½†åœ¨ AI ç¼–ç¨‹æµªæ½®ä¸‹ï¼ŒCursor å’Œ Trae ç­‰æ–°å…´ IDE å‡­å€Ÿæé«˜çš„å¼€å‘æ•ˆç‡å’Œæ€§ä»·æ¯”ï¼Œæ­£åœ¨é‡å¡‘æˆ‘ä»¬çš„ç¼–ç ä¹ æƒ¯ã€‚å¯¹äºå¼€å‘è€…ï¼ˆå°¤å…¶æ˜¯ Flutter å¼€å‘è€…ï¼‰æ¥è¯´ï¼Œè¿™å¹¶éæ˜¯ä¸€åœºéæ­¤å³å½¼çš„æ·˜æ±°èµ›ï¼Œè€Œæ˜¯ä¸€æ¬¡å·¥å…·ç®±çš„å‡çº§ã€‚</p>
<p>æœ€èªæ˜çš„åšæ³•æ˜¯<strong>åšé‡‡ä¼—é•¿</strong>ï¼š</p>
<ol>
<li><strong>å‰æœŸ</strong>ï¼šåˆ©ç”¨ <strong>Trae</strong> ç­‰ AI IDE çš„é«˜æ€§ä»·æ¯”å’Œå¿«é€Ÿç”Ÿæˆèƒ½åŠ›ï¼Œå®Œæˆæ–¹æ¡ˆéªŒè¯ã€æ¡†æ¶æ­å»ºå’Œå¤§å—ä¸šåŠ¡é€»è¾‘çš„å®ç°ã€‚</li>
<li><strong>åæœŸ</strong>ï¼šå›å½’ <strong>Android Studio</strong>ï¼Œåˆ©ç”¨å…¶å¼ºå¤§çš„è°ƒè¯•å·¥å…·ã€æ€§èƒ½åˆ†æå™¨å’Œå¯¹åŸç”Ÿç¯å¢ƒçš„å®Œç¾æ”¯æŒï¼Œè¿›è¡Œç»†èŠ‚æ‰“ç£¨ã€Bug ä¿®å¤å’Œæœ€ç»ˆäº¤ä»˜ã€‚</li>
</ol>
<p>å·¥å…·åªæ˜¯æ‰‹æ®µï¼Œæ•ˆç‡æ‰æ˜¯ç›®çš„ã€‚åœ¨è¿™ä¸ª AI å¿«é€Ÿè¿­ä»£çš„æ—¶ä»£ï¼Œçµæ´»ç»„åˆä½¿ç”¨ä¸åŒçš„å·¥å…·ï¼Œå„å–æ‰€é•¿ï¼Œæ‰æ˜¯å½“ä¸‹æœ€é«˜æ•ˆçš„ç”Ÿå­˜ä¹‹é“ã€‚</p>
<blockquote>
<p>ğŸ¤ å¦‚æœçœ‹åˆ°è¿™é‡Œçš„åŒå­¦å¯¹å®¢æˆ·ç«¯æˆ–è€…Flutterå¼€å‘æ„Ÿå…´è¶£ï¼Œæ¬¢è¿è”ç³»è€åˆ˜ï¼Œæˆ‘ä»¬äº’ç›¸å­¦ä¹ ã€‚</p>
<p>ğŸ ç§ä¿¡å…è´¹é¢†è€åˆ˜æ•´ç†çš„ã€ŠFlutterå¼€å‘æ‰‹å†Œã€‹ï¼Œè¦†ç›–90%åº”ç”¨å¼€å‘åœºæ™¯ã€‚å¯ä»¥ä½œä¸ºFlutterå­¦ä¹ çš„çŸ¥è¯†åœ°å›¾ã€‚</p>
<p>ğŸ’¬ : laoliu_dev</p>
</blockquote>
<blockquote>
<p>ğŸ“‚ è€åˆ˜ä¹ŸæŠŠè‡ªå·±å†å²æ–‡ç« æ•´ç†åœ¨GitHubä»“åº“é‡Œï¼Œæ–¹ä¾¿å¤§å®¶æŸ¥é˜…ã€‚</p>
<p>ğŸ”— <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flzt-code%2Fblog" target="_blank" title="https://github.com/lzt-code/blog" ref="nofollow noopener noreferrer">github.com/lzt-code/blâ€¦</a></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥å‰–æRocketMQçš„æ¶ˆè´¹é€»è¾‘]]></title>    <link>https://juejin.cn/post/7602497125268897798</link>    <guid>https://juejin.cn/post/7602497125268897798</guid>    <pubDate>2026-02-04T02:57:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602497125268897798" data-draft-id="7602529888483311679" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥å‰–æRocketMQçš„æ¶ˆè´¹é€»è¾‘"/> <meta itemprop="keywords" content="åç«¯,RocketMQ"/> <meta itemprop="datePublished" content="2026-02-04T02:57:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸æµªæ— ç—•"/> <meta itemprop="url" content="https://juejin.cn/user/2834988091055719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥å‰–æRocketMQçš„æ¶ˆè´¹é€»è¾‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2834988091055719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸æµªæ— ç—•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T02:57:19.000Z" title="Wed Feb 04 2026 02:57:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    30
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å¾ˆå¤šäººåœ¨ä½¿ç”¨RocketMQæ—¶ï¼ŒåªçŸ¥é“å†™ä¸ªListenerå°±èƒ½æ¶ˆè´¹æ¶ˆæ¯ï¼Œä½†å¯¹åº•å±‚çš„æ¶ˆè´¹æœºåˆ¶ä¸€çŸ¥åŠè§£ã€‚æœ¬æ–‡å°†ç”¨å¤§ç™½è¯æ·±å…¥å‰–æRocketMQçš„æ¶ˆè´¹é€»è¾‘ï¼Œå¸®åŠ©ä½ çœŸæ­£ç†è§£ï¼šæ¶ˆæ¯æ˜¯æ€ä¹ˆåˆ°è¾¾ä½ çš„ä»£ç çš„ï¼Ÿæ¨æ¨¡å¼è¿˜æ˜¯æ‹‰æ¨¡å¼ï¼Ÿçº¿ç¨‹æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ</p>
<p>æœ¬æ–‡ä»¥Spring Boot Starteræ–¹å¼ä¸ºä¾‹è¿›è¡Œè®²è§£ï¼Œè¿™ä¹Ÿæ˜¯ç›®å‰æœ€å¸¸ç”¨çš„æ–¹å¼ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€æ•´ä½“æ¶ˆè´¹æµç¨‹æ¦‚è§ˆ</h2>
<p>å…ˆä»å®è§‚å±‚é¢çœ‹çœ‹RocketMQçš„æ¶ˆè´¹æµç¨‹ã€‚æ•´ä¸ªè¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªæ ¸å¿ƒç¯èŠ‚ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[Brokerå­˜å‚¨æ¶ˆæ¯] --&gt;|é•¿è½®è¯¢æ‹‰å–| B[Consumeræ‹‰å–çº¿ç¨‹]
    B --&gt;|æ”¾å…¥æœ¬åœ°ç¼“å­˜| C[ProcessQueue]
    C --&gt;|åˆ†å‘æ¶ˆæ¯| D[æ¶ˆè´¹çº¿ç¨‹æ± ]
    D --&gt;|å›è°ƒ| E[ä½ çš„ä¸šåŠ¡ä»£ç ]
    E --&gt;|è¿”å›ç»“æœ| F[ACK/NACK]
    
    style A fill:#e1f5ff,stroke:#01579b,stroke-width:2px
    style B fill:#fff3e0,stroke:#e65100,stroke-width:2px
    style C fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    style D fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px
    style E fill:#fff9c4,stroke:#f57f17,stroke-width:2px
    style F fill:#fce4ec,stroke:#880e4f,stroke-width:2px
</code></pre>
<p>è¿™ä¸ªæµç¨‹çœ‹èµ·æ¥ç®€å•ï¼Œä½†æ¯ä¸€æ­¥éƒ½æœ‰å¾ˆå¤šç»†èŠ‚å€¼å¾—æ·±ç©¶ã€‚</p>
<h2 data-id="heading-2">äºŒã€æ¨æ¨¡å¼ vs æ‹‰æ¨¡å¼ï¼šä¸€ä¸ªç¾ä¸½çš„è¯¯è§£</h2>
<h3 data-id="heading-3">2.1 è¡¨é¢ç°è±¡ï¼šçœ‹èµ·æ¥æ˜¯æ¨æ¨¡å¼</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RocketMQMessageListener(topic = "order-topic", consumerGroup = "order-group")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RocketMQListener</span>&lt;Order&gt; {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-comment">// æ¶ˆæ¯è‡ªåŠ¨"æ¨é€"åˆ°è¿™é‡Œ</span>
        System.out.println(<span class="hljs-string">"æ”¶åˆ°è®¢å•: "</span> + order);
    }
}
</code></pre>
<p>çœ‹èµ·æ¥æ¶ˆæ¯æ˜¯è¢«"æ¨é€"è¿‡æ¥çš„å¯¹å§ï¼Ÿä½ ä»€ä¹ˆéƒ½ä¸ç”¨åšï¼Œæ¶ˆæ¯å°±è‡ªåŠ¨åˆ°è¾¾äº†ä½ çš„æ–¹æ³•ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆRocketMQçš„Consumerå«åš <code>PushConsumer</code>ã€‚</p>
<h3 data-id="heading-4">2.2 åº•å±‚çœŸç›¸ï¼šæœ¬è´¨æ˜¯æ‹‰æ¨¡å¼</h3>
<p>ä½†å®é™…ä¸Šï¼ŒRocketMQçš„åº•å±‚å®ç°æ˜¯<strong>æ‹‰æ¨¡å¼</strong>ã€‚Consumerå¹¶ä¸æ˜¯è¢«åŠ¨ç­‰å¾…ï¼Œè€Œæ˜¯ä¸»åŠ¨å»Brokeræ‹‰å–æ¶ˆæ¯ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant C as Consumer
    participant B as Broker
    
    rect rgb(230, 245, 255)
    Note over C,B: æ‹‰æ¨¡å¼çš„çœŸå®æµç¨‹
    C-&gt;&gt;B: å‘èµ·æ‹‰å–è¯·æ±‚
    B--&gt;&gt;C: æ²¡æœ‰æ–°æ¶ˆæ¯ï¼Œç­‰å¾…...
    Note over B: BrokeræŒ‚èµ·è¯·æ±‚æœ€å¤š30ç§’
    B-&gt;&gt;B: æœ‰æ–°æ¶ˆæ¯åˆ°è¾¾
    B--&gt;&gt;C: ç«‹å³è¿”å›æ¶ˆæ¯
    C-&gt;&gt;C: å¤„ç†æ¶ˆæ¯
    C-&gt;&gt;B: ç«‹å³å‘èµ·ä¸‹ä¸€æ¬¡æ‹‰å–
    end
</code></pre>
<h3 data-id="heading-5">2.3 ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡ï¼Ÿ</h3>
<p>RocketMQæŠŠæ‹‰å–é€»è¾‘å°è£…åœ¨SDKé‡Œï¼Œå¯¹å¤–æš´éœ²æˆæ¨æ¨¡å¼çš„æ¥å£ï¼Œç›®çš„æ˜¯ï¼š</p>
<ol>
<li><strong>ç®€åŒ–å¼€å‘</strong>ï¼šå¼€å‘è€…åªéœ€å†™Listenerï¼Œæ— éœ€å…³å¿ƒæ‹‰å–é€»è¾‘</li>
<li><strong>æµé‡æ§åˆ¶</strong>ï¼šConsumerå¯ä»¥æ§åˆ¶æ‹‰å–é€Ÿåº¦ï¼Œé¿å…è¢«å‹å®</li>
<li><strong>å®æ—¶æ€§å¥½</strong>ï¼šé•¿è½®è¯¢æœºåˆ¶ä¿è¯æ¶ˆæ¯åŠæ—¶é€è¾¾</li>
</ol>
<p><strong>å…³é”®ç†è§£ï¼š</strong></p>
<ul>
<li><strong>æ¨æ¨¡å¼ï¼ˆè¡¨è±¡ï¼‰</strong>ï¼šå¼€å‘è€…æ— éœ€å…³å¿ƒæ‹‰å–ï¼Œä¸“æ³¨ä¸šåŠ¡é€»è¾‘</li>
<li><strong>æ‹‰æ¨¡å¼ï¼ˆæœ¬è´¨ï¼‰</strong>ï¼šConsumerä¸»åŠ¨æ§åˆ¶æ‹‰å–é€Ÿåº¦</li>
<li><strong>é•¿è½®è¯¢ï¼ˆå®ç°ï¼‰</strong>ï¼šå…¼é¡¾å®æ—¶æ€§å’Œæ€§èƒ½</li>
</ul>
<h2 data-id="heading-6">ä¸‰ã€é•¿è½®è¯¢ï¼šæ¨æ‹‰æ¨¡å¼çš„å®Œç¾ç»“åˆ</h2>
<h3 data-id="heading-7">3.1 ä»€ä¹ˆæ˜¯é•¿è½®è¯¢</h3>
<p>é•¿è½®è¯¢ï¼ˆLong Pollingï¼‰æ˜¯RocketMQå®ç°"ç±»æ¨æ¨¡å¼"çš„æ ¸å¿ƒæŠ€æœ¯ã€‚å®ƒè§£å†³äº†ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>å¦‚ä½•åšåˆ°å®æ—¶æ€§é«˜ï¼ˆåƒæ¨æ¨¡å¼ï¼‰</li>
<li>å¦‚ä½•é¿å…é¢‘ç¹ç©ºè½®è¯¢æµªè´¹èµ„æºï¼ˆåƒæ‹‰æ¨¡å¼ï¼‰</li>
</ul>
<h3 data-id="heading-8">3.2 é•¿è½®è¯¢çš„å·¥ä½œæµç¨‹</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant C as Consumer
    participant B as Broker
    participant S as Storage
    
    rect rgb(255, 243, 224)
    Note over C,B: åœºæ™¯1: æœ‰æ¶ˆæ¯
    C-&gt;&gt;B: æ‹‰å–è¯·æ±‚(timeout=30s)
    B-&gt;&gt;S: æŸ¥è¯¢æ–°æ¶ˆæ¯
    S--&gt;&gt;B: æœ‰3æ¡æ¶ˆæ¯
    B--&gt;&gt;C: ç«‹å³è¿”å›(è€—æ—¶&lt;5ms)
    end
    
    rect rgb(232, 245, 233)
    Note over C,B: åœºæ™¯2: æš‚æ— æ¶ˆæ¯
    C-&gt;&gt;B: æ‹‰å–è¯·æ±‚(timeout=30s)
    B-&gt;&gt;S: æŸ¥è¯¢æ–°æ¶ˆæ¯
    S--&gt;&gt;B: æš‚æ— æ¶ˆæ¯
    Note over B: æŒ‚èµ·è¯·æ±‚ï¼Œç­‰å¾…æœ€å¤š30ç§’
    S-&gt;&gt;B: æ–°æ¶ˆæ¯åˆ°è¾¾
    B--&gt;&gt;C: ç«‹å³è¿”å›æ¶ˆæ¯
    end
</code></pre>
<h3 data-id="heading-9">3.3 é•¿è½®è¯¢çš„ä¼˜åŠ¿</h3>





























<table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>çŸ­è½®è¯¢</th><th>é•¿è½®è¯¢</th><th>çœŸæ¨é€</th></tr></thead><tbody><tr><td><strong>å®æ—¶æ€§</strong></td><td>å·®</td><td>å¥½</td><td>æœ€å¥½</td></tr><tr><td><strong>æœåŠ¡å™¨å‹åŠ›</strong></td><td>å¤§</td><td>å°</td><td>å°</td></tr><tr><td><strong>Consumeræ§åˆ¶åŠ›</strong></td><td>é«˜</td><td>é«˜</td><td>ä½</td></tr></tbody></table>
<p><strong>RocketMQé€‰æ‹©é•¿è½®è¯¢çš„åŸå› ï¼š</strong></p>
<ol>
<li>å…¼é¡¾å®æ—¶æ€§ï¼šæ–°æ¶ˆæ¯åˆ°è¾¾æ—¶ç«‹å³è¿”å›</li>
<li>é™ä½å‹åŠ›ï¼šé¿å…é¢‘ç¹çš„ç©ºè½®è¯¢</li>
<li>Consumerå¯æ§ï¼šæ§åˆ¶æ‹‰å–é€Ÿåº¦ï¼Œä¸ä¼šè¢«å‹å®</li>
<li>å®ç°ç®€å•ï¼šæ¯”ç»´æŠ¤é•¿è¿æ¥ç®€å•</li>
</ol>
<h3 data-id="heading-10">3.4 é…ç½®å‚æ•°</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">rocketmq:</span>
  <span class="hljs-attr">consumer:</span>
    <span class="hljs-attr">pull-timeout:</span> <span class="hljs-number">30000</span>        <span class="hljs-comment"># é•¿è½®è¯¢è¶…æ—¶30ç§’(æ¨èé»˜è®¤å€¼)</span>
    <span class="hljs-attr">pull-interval:</span> <span class="hljs-number">0</span>           <span class="hljs-comment"># æ‹‰å–é—´éš”0æ¯«ç§’(ç«‹å³æ‹‰å–)</span>
    <span class="hljs-attr">pull-batch-size:</span> <span class="hljs-number">32</span>        <span class="hljs-comment"># æ¯æ¬¡æ‹‰å–32æ¡æ¶ˆæ¯</span>
</code></pre>
<h2 data-id="heading-11">å››ã€é˜Ÿåˆ—åˆ†é…æœºåˆ¶ï¼šConsumerå¦‚ä½•ç“œåˆ†é˜Ÿåˆ—</h2>
<h3 data-id="heading-12">4.1 é˜Ÿåˆ—åˆ†é…åŸç†</h3>
<p>å‡è®¾ä¸€ä¸ªTopicæœ‰8ä¸ªé˜Ÿåˆ—ï¼Œ2ä¸ªConsumerï¼Œå®ƒä»¬æ˜¯æ€ä¹ˆåˆ†é…çš„ï¼Ÿ</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph Topic: order-topic
    Q1[Queue-0]
    Q2[Queue-1]
    Q3[Queue-2]
    Q4[Queue-3]
    Q5[Queue-4]
    Q6[Queue-5]
    Q7[Queue-6]
    Q8[Queue-7]
    end
    
    subgraph Consumer Group
    C1[Consumer-1&lt;br/&gt;Pod-1]
    C2[Consumer-2&lt;br/&gt;Pod-2]
    end
    
    Q1 &amp; Q2 &amp; Q3 &amp; Q4 --&gt; C1
    Q5 &amp; Q6 &amp; Q7 &amp; Q8 --&gt; C2
    
    style Q1 fill:#e1f5ff,stroke:#01579b
    style Q2 fill:#e1f5ff,stroke:#01579b
    style Q3 fill:#e1f5ff,stroke:#01579b
    style Q4 fill:#e1f5ff,stroke:#01579b
    style Q5 fill:#fff3e0,stroke:#e65100
    style Q6 fill:#fff3e0,stroke:#e65100
    style Q7 fill:#fff3e0,stroke:#e65100
    style Q8 fill:#fff3e0,stroke:#e65100
    style C1 fill:#e1f5ff,stroke:#01579b,stroke-width:3px
    style C2 fill:#fff3e0,stroke:#e65100,stroke-width:3px
</code></pre>
<p><strong>åˆ†é…ç­–ç•¥ï¼šå¹³å‡åˆ†é…ï¼ˆé»˜è®¤ï¼‰</strong></p>
<p>RocketMQä½¿ç”¨ <code>AllocateMessageQueueAveragely</code> ç­–ç•¥ï¼š</p>
<ul>
<li>8ä¸ªé˜Ÿåˆ— Ã· 2ä¸ªConsumer = æ¯ä¸ªConsumeråˆ†é…4ä¸ªé˜Ÿåˆ—</li>
<li>Consumer-1 åˆ†é… Queue 0-3</li>
<li>Consumer-2 åˆ†é… Queue 4-7</li>
</ul>
<h3 data-id="heading-13">4.2 å¸¸è§çš„é˜Ÿåˆ—åˆ†é…åœºæ™¯</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    subgraph S1["åœºæ™¯1: é˜Ÿåˆ—æ•° = Consumeræ•°"]
    A1["8 Queues"] --&gt;|å®Œç¾å‡åˆ†| B1["8 Consumersæ¯äºº1ä¸ª"]
    end
    
    subgraph S2["åœºæ™¯2: é˜Ÿåˆ—æ•° &gt; Consumeræ•°"]
    A2["8 Queues"] --&gt;|å‡åˆ†| B2["2 Consumersæ¯äºº4ä¸ª"]
    end
    
    subgraph S3["åœºæ™¯3: é˜Ÿåˆ—æ•° &lt; Consumeræ•°"]
    A3["4 Queues"] --&gt;|æœ‰äººç©ºé—²| B3["8 Consumers 4äººå·¥ä½œ 4äººç©ºé—²"]
    end
    
    style A1 fill:#e8f5e9,stroke:#2e7d32
    style B1 fill:#e8f5e9,stroke:#2e7d32
    style A2 fill:#fff3e0,stroke:#e65100
    style B2 fill:#fff3e0,stroke:#e65100
    style A3 fill:#ffebee,stroke:#c62828
    style B3 fill:#ffebee,stroke:#c62828
</code></pre>
<p><strong>é‡è¦ç»“è®ºï¼š</strong></p>
<ul>
<li>é˜Ÿåˆ—æ˜¯æ¶ˆè´¹å¹¶å‘çš„åŸºæœ¬å•ä½</li>
<li>Consumeræ•°é‡ &gt; é˜Ÿåˆ—æ•°é‡æ—¶ï¼Œå¤šä½™çš„Consumerä¼šç©ºé—²</li>
<li>æƒ³æé«˜æ¶ˆè´¹å¹¶å‘ï¼Œåº”è¯¥å¢åŠ é˜Ÿåˆ—æ•°ï¼Œè€Œä¸æ˜¯ç›²ç›®å¢åŠ Consumer</li>
</ul>
<h3 data-id="heading-14">4.3 Rebalanceï¼šåŠ¨æ€é‡åˆ†é…</h3>
<p>å½“Consumeræ•°é‡å˜åŒ–æ—¶ï¼ˆæ–°å¢ã€ä¸‹çº¿ã€å´©æºƒï¼‰ï¼Œä¼šè§¦å‘Rebalanceé‡æ–°åˆ†é…é˜Ÿåˆ—ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant C1 as Consumer-1
    participant C2 as Consumer-2
    participant C3 as Consumer-3(æ–°åŠ å…¥)
    participant B as Broker
    
    rect rgb(232, 245, 233)
    Note over C1,C2: åˆå§‹çŠ¶æ€ï¼š2ä¸ªConsumer
    Note over C1: æŒæœ‰ Q0,Q1,Q2,Q3
    Note over C2: æŒæœ‰ Q4,Q5,Q6,Q7
    end
    
    rect rgb(255, 243, 224)
    Note over C1,C3: Consumer-3 åŠ å…¥
    C3-&gt;&gt;B: æˆ‘åŠ å…¥äº† ConsumerGroup
    B-&gt;&gt;C1: è§¦å‘ Rebalance
    B-&gt;&gt;C2: è§¦å‘ Rebalance
    B-&gt;&gt;C3: è§¦å‘ Rebalance
    end
    
    rect rgb(227, 242, 253)
    Note over C1,C3: é‡æ–°åˆ†é…å®Œæˆ
    Note over C1: æŒæœ‰ Q0,Q1,Q2
    Note over C2: æŒæœ‰ Q3,Q4,Q5
    Note over C3: æŒæœ‰ Q6,Q7
    end
</code></pre>
<p><strong>Rebalanceçš„å½±å“ï¼š</strong></p>
<ul>
<li>ä¼šçŸ­æš‚æš‚åœæ¶ˆè´¹ï¼ˆé€šå¸¸å‡ ç§’ï¼‰</li>
<li>å¯èƒ½å¯¼è‡´æ¶ˆæ¯é‡å¤æ¶ˆè´¹ï¼ˆéœ€è¦ä¸šåŠ¡ä¿è¯å¹‚ç­‰ï¼‰</li>
<li>é¢‘ç¹Rebalanceä¼šå½±å“æ€§èƒ½</li>
</ul>
<h2 data-id="heading-15">äº”ã€çº¿ç¨‹æ¨¡å‹ï¼šæ‹‰å–çº¿ç¨‹ vs æ¶ˆè´¹çº¿ç¨‹</h2>
<p>è¿™æ˜¯ç†è§£RocketMQæ¶ˆè´¹æœºåˆ¶æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ã€‚å¾ˆå¤šäººä»¥ä¸ºConsumeråªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œå…¶å®å†…éƒ¨æœ‰ä¸¤å¥—å®Œå…¨ç‹¬ç«‹çš„çº¿ç¨‹æœºåˆ¶ã€‚</p>
<h3 data-id="heading-16">5.1 åŒçº¿ç¨‹æ¨¡å‹æ€»è§ˆ</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph Consumer["Consumerè¿›ç¨‹"]
        subgraph Pull["æ‹‰å–å±‚"]
        PT["PullMessageService&lt;br/&gt;æ‹‰å–çº¿ç¨‹(å•çº¿ç¨‹)"]
        end
        
        subgraph Cache["ç¼“å­˜å±‚"]
        PQ1["ProcessQueue-1"]
        PQ2["ProcessQueue-2"]
        PQ3["ProcessQueue-3"]
        PQ4["ProcessQueue-4"]
        end
        
        subgraph Consume["æ¶ˆè´¹å±‚"]
        TP["æ¶ˆè´¹çº¿ç¨‹æ± &lt;br/&gt;(é»˜è®¤20-64çº¿ç¨‹)"]
        end
    end
    
    Broker --&gt;|é•¿è½®è¯¢æ‹‰å–| PT
    PT --&gt;|åˆ†å‘åˆ°å¯¹åº”é˜Ÿåˆ—| PQ1 &amp; PQ2 &amp; PQ3 &amp; PQ4
    PQ1 &amp; PQ2 &amp; PQ3 &amp; PQ4 --&gt;|æäº¤æ¶ˆè´¹ä»»åŠ¡| TP
    TP --&gt;|å›è°ƒ| Listener["ä½ çš„ onMessage æ–¹æ³•"]
    
    style PT fill:#fff3e0,stroke:#e65100,stroke-width:2px
    style PQ1 fill:#f3e5f5,stroke:#4a148c
    style PQ2 fill:#f3e5f5,stroke:#4a148c
    style PQ3 fill:#f3e5f5,stroke:#4a148c
    style PQ4 fill:#f3e5f5,stroke:#4a148c
    style TP fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px
    style Listener fill:#fff9c4,stroke:#f57f17,stroke-width:2px
</code></pre>
<h3 data-id="heading-17">5.2 æ‹‰å–çº¿ç¨‹ï¼šå•çº¿ç¨‹è½®è¯¢</h3>
<p>æ‹‰å–çº¿ç¨‹æ˜¯ä¸€ä¸ªå•çº¿ç¨‹ï¼ŒèŒè´£å¾ˆç®€å•ï¼šä¸åœåœ°è½®è¯¢æ‰€æœ‰åˆ†é…çš„é˜Ÿåˆ—ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
    Start(["å¯åŠ¨"]) --&gt; Loop{"è¿è¡Œä¸­?"}
    Loop --&gt;|æ˜¯| Q1["æ‹‰å– Queue-0"]
    Q1 --&gt; Q2["æ‹‰å– Queue-1"]
    Q2 --&gt; Q3["æ‹‰å– Queue-2"]
    Q3 --&gt; Q4["æ‹‰å– Queue-3"]
    Q4 --&gt; Loop
    Loop --&gt;|å¦| End(["ç»“æŸ"])
    
    style Start fill:#e8f5e9,stroke:#2e7d32
    style Loop fill:#fff3e0,stroke:#e65100
    style Q1 fill:#e1f5ff,stroke:#01579b
    style Q2 fill:#e1f5ff,stroke:#01579b
    style Q3 fill:#e1f5ff,stroke:#01579b
    style Q4 fill:#e1f5ff,stroke:#01579b
    style End fill:#ffebee,stroke:#c62828
</code></pre>
<p><strong>å…³é”®ç‚¹ï¼š</strong></p>
<ul>
<li>åªæœ‰1ä¸ªä¸“é—¨çš„æ‹‰å–çº¿ç¨‹</li>
<li>è½®è¯¢æ‰€æœ‰é˜Ÿåˆ—ï¼ˆQueue-0, 1, 2, 3...ï¼‰</li>
<li>ä½¿ç”¨é•¿è½®è¯¢ï¼Œä¸ä¼šé¢‘ç¹å ç”¨CPU</li>
<li>æ‹‰å–åˆ°çš„æ¶ˆæ¯æ”¾å…¥ProcessQueue</li>
</ul>
<h3 data-id="heading-18">5.3 ProcessQueueï¼šæœ¬åœ°æ¶ˆæ¯ç¼“å­˜</h3>
<p>ProcessQueueæ˜¯è¿æ¥æ‹‰å–å’Œæ¶ˆè´¹çš„æ¡¥æ¢ï¼Œæ¯ä¸ªé˜Ÿåˆ—éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ProcessQueueã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A["æ‹‰å–çº¿ç¨‹"] --&gt;|æ”¾å…¥æ¶ˆæ¯| B["ProcessQueue&lt;br/&gt;æœ¬åœ°ç¼“å­˜&lt;br/&gt;æœ€å¤š1000æ¡"]
    B --&gt;|å–å‡ºæ¶ˆæ¯| C["æ¶ˆè´¹çº¿ç¨‹æ± "]
    B --&gt;|è¶…è¿‡1000æ¡| D["æš‚åœæ‹‰å–&lt;br/&gt;é˜²æ­¢å†…å­˜æº¢å‡º"]
    
    style A fill:#fff3e0,stroke:#e65100
    style B fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    style C fill:#e8f5e9,stroke:#1b5e20
    style D fill:#ffebee,stroke:#c62828
</code></pre>
<p><strong>ProcessQueueçš„ä½œç”¨ï¼š</strong></p>
<ol>
<li>è§£è€¦æ‹‰å–å’Œæ¶ˆè´¹ï¼šæ‹‰å–çº¿ç¨‹å’Œæ¶ˆè´¹çº¿ç¨‹äº’ä¸é˜»å¡</li>
<li>æµé‡æ§åˆ¶ï¼šç¼“å­˜æ»¡äº†å°±æš‚åœæ‹‰å–</li>
<li>æ‰¹é‡å¤„ç†ï¼šæ¶ˆè´¹çº¿ç¨‹å¯ä»¥æ‰¹é‡å–æ¶ˆæ¯</li>
</ol>
<h3 data-id="heading-19">5.4 æ¶ˆè´¹çº¿ç¨‹æ± ï¼šå¤šçº¿ç¨‹å¹¶å‘æ¶ˆè´¹</h3>
<p>æ¶ˆè´¹çº¿ç¨‹æ± æ˜¯çœŸæ­£æ‰§è¡Œä¸šåŠ¡é€»è¾‘çš„åœ°æ–¹ï¼Œé»˜è®¤æœ‰20-64ä¸ªçº¿ç¨‹ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant PQ1 as ProcessQueue-1
    participant PQ2 as ProcessQueue-2
    participant Pool as æ¶ˆè´¹çº¿ç¨‹æ± 
    participant T1 as Thread-1
    participant T2 as Thread-2
    
    rect rgb(232, 245, 233)
    PQ1-&gt;&gt;Pool: æäº¤æ¶ˆè´¹ä»»åŠ¡(3æ¡æ¶ˆæ¯)
    Pool-&gt;&gt;T1: åˆ†é…ç»™Thread-1
    T1-&gt;&gt;T1: onMessage(msg1)&lt;br/&gt;onMessage(msg2)&lt;br/&gt;onMessage(msg3)
    end
    
    rect rgb(255, 243, 224)
    PQ2-&gt;&gt;Pool: æäº¤æ¶ˆè´¹ä»»åŠ¡(5æ¡æ¶ˆæ¯)
    Pool-&gt;&gt;T2: åˆ†é…ç»™Thread-2
    T2-&gt;&gt;T2: onMessage(msg4)&lt;br/&gt;onMessage(msg5)
    end
</code></pre>
<p><strong>æ¶ˆè´¹çº¿ç¨‹æ± çš„ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>å¤šä¸ªçº¿ç¨‹å¹¶å‘æ¶ˆè´¹ï¼ˆé»˜è®¤20-64ä¸ªï¼‰</li>
<li>ä¸ç»‘å®šç‰¹å®šé˜Ÿåˆ—ï¼šå“ªä¸ªçº¿ç¨‹ç©ºé—²å°±æ¶ˆè´¹å“ªä¸ªæ¶ˆæ¯</li>
<li>ä½ çš„<code>onMessage()</code>æ–¹æ³•æ˜¯è¢«è¿™äº›çº¿ç¨‹è°ƒç”¨çš„</li>
</ul>
<h3 data-id="heading-20">5.5 å®Œæ•´çš„æ¶ˆæ¯æµè½¬</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant B as Broker
    participant PT as æ‹‰å–çº¿ç¨‹
    participant PQ as ProcessQueue
    participant Pool as æ¶ˆè´¹çº¿ç¨‹æ± 
    participant Listener as Listener
    
    Note over B,PT: æ‹‰å–çº¿ç¨‹å·¥ä½œ
    PT-&gt;&gt;B: æ‹‰å– Queue-0
    B--&gt;&gt;PT: è¿”å› msg1, msg2
    PT-&gt;&gt;PQ: æ”¾å…¥ç¼“å­˜
    
    Note over PQ,Pool: æäº¤æ¶ˆè´¹ä»»åŠ¡
    PQ-&gt;&gt;Pool: æäº¤ä»»åŠ¡(msg1, msg2)
    
    Note over Pool,Listener: æ¶ˆè´¹çº¿ç¨‹å¤„ç†
    Pool-&gt;&gt;Listener: Thread-1: onMessage(msg1)
    Pool-&gt;&gt;Listener: Thread-2: onMessage(msg2)
    
    Listener--&gt;&gt;Pool: SUCCESS
    Pool-&gt;&gt;B: ACK
</code></pre>
<p><strong>å…³é”®ç†è§£ï¼š</strong></p>
<ol>
<li>æ‹‰å–çº¿ç¨‹åªè´Ÿè´£æ‹‰æ¶ˆæ¯</li>
<li>æ¶ˆè´¹çº¿ç¨‹åªè´Ÿè´£æ¶ˆè´¹</li>
<li>ProcessQueueæ˜¯ä¸­é—´ç¼“å†²åŒº</li>
<li>æ¶ˆè´¹çº¿ç¨‹ä¸ç»‘å®šé˜Ÿåˆ—ï¼Œçµæ´»è°ƒåº¦</li>
</ol>
<h2 data-id="heading-21">å…­ã€çº¿ç¨‹é…ç½®ï¼šä¸è¦è¿·ä¿¡çº¿ç¨‹æ•°</h2>
<p>å¾ˆå¤šäººé‡åˆ°æ¶ˆè´¹æ…¢çš„ç¬¬ä¸€ååº”æ˜¯ï¼šåŠ çº¿ç¨‹ï¼ä½†è¿™å¾€å¾€æ˜¯é”™è¯¯çš„ã€‚</p>
<h3 data-id="heading-22">6.1 Spring Boot Starterçš„çº¿ç¨‹é…ç½®</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RocketMQMessageListener(
    topic = "order-topic",
    consumerGroup = "order-group",
    consumeThreadMin = 20,      // æœ€å°æ¶ˆè´¹çº¿ç¨‹æ•°
    consumeThreadMax = 64,      // æœ€å¤§æ¶ˆè´¹çº¿ç¨‹æ•°
    consumeTimeout = 15         // å•æ¡æ¶ˆæ¯æ¶ˆè´¹è¶…æ—¶æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RocketMQListener</span>&lt;Order&gt; {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-comment">// ä½ çš„ä¸šåŠ¡é€»è¾‘</span>
    }
}
</code></pre>
<h3 data-id="heading-23">6.2 æ¶ˆè´¹æ€§èƒ½çš„çœŸæ­£ç“¶é¢ˆ</h3>
<p>å¾ˆå¤šäººé‡åˆ°æ¶ˆè´¹æ…¢çš„ç¬¬ä¸€ååº”æ˜¯ï¼šåŠ çº¿ç¨‹ï¼ä½†è¿™å¾€å¾€æ˜¯é”™è¯¯çš„ã€‚</p>
<p><strong>æ€§èƒ½ç“¶é¢ˆåˆ†æï¼š</strong></p>
<ol>
<li>
<p><strong>é˜Ÿåˆ—æ•°ä¸å¤Ÿ</strong>ï¼šè¿™æ˜¯æœ€å¸¸è§çš„é—®é¢˜</p>
<ul>
<li>4ä¸ªé˜Ÿåˆ— + 40ä¸ªçº¿ç¨‹ = å®é™…åªæœ‰4ä¸ªçº¿ç¨‹å·¥ä½œ</li>
<li>è§£å†³ï¼šå¢åŠ é˜Ÿåˆ—æ•°åˆ°16-32ä¸ª</li>
</ul>
</li>
<li>
<p><strong>çº¿ç¨‹æ•°ä¸å¤Ÿ</strong>ï¼šé˜Ÿåˆ—å¤Ÿä½†çº¿ç¨‹å…¨å¿™</p>
<ul>
<li>é˜Ÿåˆ—æ•° = 16ï¼Œçº¿ç¨‹æ•° = 5ï¼Œæœ‰11ä¸ªé˜Ÿåˆ—åœ¨ç­‰å¾…</li>
<li>è§£å†³ï¼šå¢åŠ çº¿ç¨‹æ•°åˆ°16-20ä¸ª</li>
</ul>
</li>
<li>
<p><strong>ä¸šåŠ¡å¤„ç†æ…¢</strong>ï¼šçº¿ç¨‹å¤Ÿä½†æ¯æ¡æ¶ˆæ¯å¤„ç†å¾ˆæ…¢</p>
<ul>
<li>ä¸šåŠ¡è€—æ—¶100msï¼Œå³ä½¿100ä¸ªçº¿ç¨‹ä¹Ÿæ…¢</li>
<li>è§£å†³ï¼šä¼˜åŒ–ä¸šåŠ¡é€»è¾‘ï¼ŒåŠ ç¼“å­˜/ç´¢å¼•/å¼‚æ­¥å¤„ç†</li>
</ul>
</li>
</ol>
<p><strong>ä¼˜åŒ–é¡ºåºï¼šé˜Ÿåˆ—æ•° â†’ ä¸šåŠ¡ä¼˜åŒ– â†’ çº¿ç¨‹æ•°</strong></p>
<h3 data-id="heading-24">6.3 é˜Ÿåˆ—æ•°æ‰æ˜¯æ¶ˆè´¹å¹¶å‘çš„ä¸Šé™</h3>
<p><strong>æ ¸å¿ƒåŸåˆ™ï¼šæ¶ˆè´¹å¹¶å‘åº¦ = min(é˜Ÿåˆ—æ•°, Consumeræ•° Ã— çº¿ç¨‹æ•°)</strong></p>
<p>çœ‹è¿™ä¸ªä¾‹å­ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    Q["Topicæœ‰4ä¸ªé˜Ÿåˆ—"] --&gt; C1["Consumer-1æŒæœ‰2ä¸ªé˜Ÿåˆ—&lt;br/&gt;é…ç½®20çº¿ç¨‹"]
    Q --&gt; C2["Consumer-2æŒæœ‰2ä¸ªé˜Ÿåˆ—&lt;br/&gt;é…ç½®20çº¿ç¨‹"]
    C1 --&gt; R["å®é™…ç»“æœ:&lt;br/&gt;æœ€å¤š4ä¸ªçº¿ç¨‹åœ¨å·¥ä½œ&lt;br/&gt;å…¶ä½™36ä¸ªçº¿ç¨‹ç©ºé—²"]
    C2 --&gt; R
    
    style Q fill:#e1f5ff,stroke:#01579b,stroke-width:2px
    style C1 fill:#fff3e0,stroke:#e65100
    style C2 fill:#fff3e0,stroke:#e65100
    style R fill:#ffebee,stroke:#c62828,stroke-width:3px
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li>4ä¸ªé˜Ÿåˆ—è¢«å¹³å‡åˆ†é…ï¼šæ¯ä¸ªConsumeræŒæœ‰2ä¸ªé˜Ÿåˆ—</li>
<li>æ¯ä¸ªé˜Ÿåˆ—åŒä¸€æ—¶åˆ»åªèƒ½è¢«1ä¸ªçº¿ç¨‹æ¶ˆè´¹</li>
<li>æ‰€ä»¥å®é™…å·¥ä½œçš„çº¿ç¨‹æœ€å¤šåªæœ‰4ä¸ª</li>
<li>å…¶ä½™çš„36ä¸ªçº¿ç¨‹éƒ½åœ¨ç©ºé—²ç­‰å¾…</li>
</ul>
<p><strong>æ­£ç¡®çš„åšæ³•ï¼š</strong></p>
<ol>
<li>å…ˆå¢åŠ é˜Ÿåˆ—æ•°åˆ°16-32ä¸ª</li>
<li>æ ¹æ®é˜Ÿåˆ—æ•°è°ƒæ•´Consumeræ•°é‡</li>
<li>æœ€åè°ƒæ•´çº¿ç¨‹æ•°ï¼ˆç•¥å¤§äºå¹³å‡é˜Ÿåˆ—æ•°ï¼‰</li>
</ol>
<h3 data-id="heading-25">6.4 çº¿ç¨‹é…ç½®çš„å®è·µå»ºè®®</h3>
<p><strong>è§„åˆ™1ï¼šé˜Ÿåˆ—æ•°ä¼˜å…ˆäºçº¿ç¨‹æ•°</strong></p>
<p>å…ˆç¡®ä¿é˜Ÿåˆ—æ•°è¶³å¤Ÿï¼ˆå»ºè®®16-32ä¸ªï¼‰ï¼Œå†è°ƒæ•´çº¿ç¨‹æ•°ã€‚</p>
<p><strong>è§„åˆ™2ï¼šçº¿ç¨‹æ•°ç•¥å¤§äºå¹³å‡é˜Ÿåˆ—æ•°</strong></p>
<pre><code class="hljs language-ini" lang="ini">å‡è®¾ï¼šé˜Ÿåˆ—æ•° = 16, Consumeræ•° = 2
å¹³å‡æ¯ä¸ªConsumeråˆ†é… = 16 / <span class="hljs-attr">2</span> = <span class="hljs-number">8</span>ä¸ªé˜Ÿåˆ—
å»ºè®®çº¿ç¨‹æ•° = 8 åˆ° 16ä¸ªçº¿ç¨‹
</code></pre>
<p><strong>è§„åˆ™3ï¼šæ ¹æ®ä¸šåŠ¡è€—æ—¶è°ƒæ•´</strong></p>
<ul>
<li>ä¸šåŠ¡å¾ˆå¿«ï¼ˆå‡ æ¯«ç§’ï¼‰ï¼šçº¿ç¨‹æ•° = é˜Ÿåˆ—æ•°</li>
<li>ä¸šåŠ¡è¾ƒæ…¢ï¼ˆå‡ åæ¯«ç§’ï¼‰ï¼šçº¿ç¨‹æ•° = é˜Ÿåˆ—æ•° Ã— 1.5</li>
<li>ä¸šåŠ¡å¾ˆæ…¢ï¼ˆæœ‰IOæ“ä½œï¼‰ï¼šçº¿ç¨‹æ•° = é˜Ÿåˆ—æ•° Ã— 2ï¼Œä½†æ›´åº”è¯¥ä¼˜åŒ–ä¸šåŠ¡é€»è¾‘</li>
</ul>
<p><strong>é…ç½®ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RocketMQMessageListener(
    topic = "order-topic",
    consumerGroup = "order-group",
    consumeThreadMin = 10,     // æœ€å°çº¿ç¨‹æ•°
    consumeThreadMax = 20      // æœ€å¤§çº¿ç¨‹æ•°
)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RocketMQListener</span>&lt;Order&gt; {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘</span>
    }
}
</code></pre>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># application.yml</span>
<span class="hljs-attr">rocketmq:</span>
  <span class="hljs-attr">consumer:</span>
    <span class="hljs-attr">pull-batch-size:</span> <span class="hljs-number">32</span>        <span class="hljs-comment"># æ¯æ¬¡æ‹‰å–æ¶ˆæ¯æ•°</span>
    <span class="hljs-attr">pull-timeout:</span> <span class="hljs-number">30000</span>        <span class="hljs-comment"># é•¿è½®è¯¢è¶…æ—¶30ç§’</span>
</code></pre>
<h2 data-id="heading-26">ä¸ƒã€æ€»ç»“</h2>
<h3 data-id="heading-27">æ ¸å¿ƒè¦ç‚¹</h3>
<ol>
<li>
<p><strong>æ¨æ‹‰æ¨¡å¼çš„æœ¬è´¨</strong></p>
<ul>
<li>è¡¨é¢æ˜¯æ¨æ¨¡å¼ï¼Œåº•å±‚æ˜¯æ‹‰æ¨¡å¼</li>
<li>é€šè¿‡é•¿è½®è¯¢å®ç°é«˜å®æ—¶æ€§å’Œä½èµ„æºæ¶ˆè€—</li>
</ul>
</li>
<li>
<p><strong>åŒçº¿ç¨‹æ¶æ„</strong></p>
<ul>
<li>æ‹‰å–çº¿ç¨‹ï¼šå•çº¿ç¨‹è½®è¯¢æ‰€æœ‰é˜Ÿåˆ—</li>
<li>æ¶ˆè´¹çº¿ç¨‹æ± ï¼šå¤šçº¿ç¨‹å¹¶å‘æ¶ˆè´¹</li>
<li>ProcessQueueï¼šè¿æ¥æ‹‰å–å’Œæ¶ˆè´¹çš„æ¡¥æ¢</li>
</ul>
</li>
<li>
<p><strong>æ€§èƒ½å…³é”®å› ç´ </strong></p>
<ul>
<li>é˜Ÿåˆ—æ•°æ˜¯æ¶ˆè´¹å¹¶å‘çš„çœŸæ­£ä¸Šé™</li>
<li>æ¶ˆè´¹å¹¶å‘åº¦ = min(é˜Ÿåˆ—æ•°, Consumeræ•° Ã— çº¿ç¨‹æ•°)</li>
<li>ä¸è¦ç›²ç›®å¢åŠ çº¿ç¨‹æ•°ï¼Œä¼˜å…ˆå¢åŠ é˜Ÿåˆ—æ•°</li>
</ul>
</li>
<li>
<p><strong>é…ç½®å»ºè®®</strong></p>
<ul>
<li>é˜Ÿåˆ—æ•°ï¼š16-32ä¸ªï¼ˆæ ¹æ®ä¸šåŠ¡é‡è°ƒæ•´ï¼‰</li>
<li>çº¿ç¨‹æ•°ï¼šç•¥å¤§äºå¹³å‡é˜Ÿåˆ—æ•°ï¼ˆ1.5-2å€ï¼‰</li>
<li>é•¿è½®è¯¢ä¿æŒ30ç§’é»˜è®¤å€¼</li>
</ul>
</li>
</ol>
<h3 data-id="heading-28">æ•´ä½“æ¶æ„</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    subgraph Producer[ç”Ÿäº§ç«¯]
    P[Producer]
    end
    
    subgraph Broker[Brokeré›†ç¾¤]
    T[Topic: 16ä¸ªé˜Ÿåˆ—]
    end
    
    subgraph Consumer1[Consumer-1]
    PT1[æ‹‰å–çº¿ç¨‹]
    PQ1[ProcessQueue]
    TP1[æ¶ˆè´¹çº¿ç¨‹æ± ]
    L1[Listener]
    end
    
    subgraph Consumer2[Consumer-2]
    PT2[æ‹‰å–çº¿ç¨‹]
    PQ2[ProcessQueue]
    TP2[æ¶ˆè´¹çº¿ç¨‹æ± ]
    L2[Listener]
    end
    
    P --&gt;|å‘é€æ¶ˆæ¯| T
    T --&gt;|é•¿è½®è¯¢æ‹‰å–| PT1
    T --&gt;|é•¿è½®è¯¢æ‹‰å–| PT2
    PT1 --&gt; PQ1
    PT2 --&gt; PQ2
    PQ1 --&gt; TP1
    PQ2 --&gt; TP2
    TP1 --&gt; L1
    TP2 --&gt; L2
    
    style P fill:#e1f5ff,stroke:#01579b
    style T fill:#fff3e0,stroke:#e65100,stroke-width:2px
    style PT1 fill:#f3e5f5,stroke:#4a148c
    style PT2 fill:#f3e5f5,stroke:#4a148c
    style PQ1 fill:#fff9c4,stroke:#f57f17
    style PQ2 fill:#fff9c4,stroke:#f57f17
    style TP1 fill:#e8f5e9,stroke:#1b5e20
    style TP2 fill:#e8f5e9,stroke:#1b5e20
    style L1 fill:#ffebee,stroke:#c62828
    style L2 fill:#ffebee,stroke:#c62828
</code></pre>
<p>ç†è§£äº†RocketMQçš„æ¶ˆè´¹æœºåˆ¶ï¼Œå°±èƒ½åœ¨å®é™…å·¥ä½œä¸­åˆç†é…ç½®Consumerï¼Œé¿å…æ€§èƒ½é—®é¢˜ã€‚è®°ä½ï¼š<strong>ç†è§£åŸç†æ¯”è®°ä½é…ç½®æ›´é‡è¦</strong>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - æ€§èƒ½è§‚æµ‹ [7 - 3]ï¼šåˆ†å±‚çº§çš„ç³»ç»ŸåŒ–æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7602465642534043698</link>    <guid>https://juejin.cn/post/7602465642534043698</guid>    <pubDate>2026-02-04T01:26:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602465642534043698" data-draft-id="7602471311509454875" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - æ€§èƒ½è§‚æµ‹ [7 - 3]ï¼šåˆ†å±‚çº§çš„ç³»ç»ŸåŒ–æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-04T01:26:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ç‹å£®å£®"/> <meta itemprop="url" content="https://juejin.cn/user/4473272506789485"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - æ€§èƒ½è§‚æµ‹ [7 - 3]ï¼šåˆ†å±‚çº§çš„ç³»ç»ŸåŒ–æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4473272506789485/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ç‹å£®å£®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T01:26:48.000Z" title="Wed Feb 04 2026 01:26:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><blockquote>
<p><strong>å†™åœ¨å‰é¢</strong></p>
<p>å¾ˆå¤šé¡¹ç›®çš„æ€§èƒ½ä¼˜åŒ–æ–‡æ¡£é‡Œåªæœ‰ä¸€è¡Œå­—ï¼šâ€œå›¾ç‰‡å‹ç¼©ï¼Œä»£ç åˆ†åŒ…â€ã€‚ è¿™å¤ªåˆçº§äº†ã€‚</p>
<p>çœŸæ­£çš„ç³»ç»ŸåŒ–ä¼˜åŒ–ï¼Œåº”è¯¥åƒå‰¥æ´‹è‘±ä¸€æ ·ï¼Œåˆ†ä¸ºå››å±‚ï¼š</p>
<ol>
<li><strong>é“¾è·¯å±‚ (Network):</strong> è®©æ•°æ®è·‘å¾—æ›´å¿«ã€‚</li>
<li><strong>èµ„æºå±‚ (Assets):</strong> è®©æ•°æ®å˜å¾—æ›´å°ã€‚</li>
<li><strong>æ¸²æŸ“å±‚ (Runtime):</strong> è®©æµè§ˆå™¨ç”»å¾—æ›´é¡ºã€‚</li>
<li><strong>æ„ŸçŸ¥å±‚ (Psychology):</strong> è®©ç”¨æˆ·è§‰å¾—æ›´å¿«ã€‚</li>
</ol>
<p>æœ¬ç¯‡æˆ‘ä»¬å°†æŒ‰ç…§è¿™ä¸ªå±‚çº§ï¼Œæ¢³ç†å‡ºæ¶æ„å¸ˆçº§åˆ«çš„æˆ˜æœ¯æ‰‹å†Œã€‚</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8daf9025d2184adf8b4bb83a4dba7669~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv546L5aOu5aOu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770773208&amp;x-signature=KmblQGtnamq6B0uF%2BGsqCplLtEQ%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-0">ç¬¬ä¸€å±‚ï¼šé“¾è·¯å±‚â€”â€”ç®¡é“çš„æ‹“å®½ä¸åŠ é€Ÿ</h2>
<p>è¿™æ˜¯ä¼˜åŒ–çš„â€œç‰©ç†åŸºç¡€â€ã€‚å¦‚æœé«˜é€Ÿå…¬è·¯åªæœ‰ä¸€æ¡è½¦é“ï¼Œä½ çš„æ³•æ‹‰åˆ©ï¼ˆä»£ç ï¼‰è·‘å¾—å†å¿«ä¹Ÿæ²¡ç”¨ã€‚</p>
<h3 data-id="heading-1">1.1 åè®®å‡çº§ï¼šä» HTTP/1.1 åˆ° QUIC</h3>
<ul>
<li>
<p><strong>ç—›ç‚¹ï¼š</strong> TCP çš„é˜Ÿå¤´é˜»å¡ï¼ˆHead-of-Line Blockingï¼‰å’Œæ…¢å¯åŠ¨ã€‚</p>
</li>
<li>
<p><strong>æˆ˜æœ¯ï¼š</strong></p>
<ul>
<li><strong>å…¨ç«™ HTTP/2:</strong> å¤šè·¯å¤ç”¨æ˜¯æ ‡é…ã€‚</li>
<li><strong>æ¿€è¿›çš„ HTTP/3 (QUIC):</strong> åŸºäº UDPï¼Œå½»åº•è§£å†³ä¸¢åŒ…å¯¼è‡´çš„é˜»å¡ï¼Œä¸”æ”¯æŒ 0-RTT å»ºè¿ï¼ˆç”¨æˆ·ç¬¬äºŒæ¬¡è®¿é—®æ—¶å‡ ä¹ 0 å»¶è¿Ÿï¼‰ã€‚</li>
<li><em>æ¶æ„å†³ç­–ï¼š</em> åœ¨ç½‘å…³å±‚ï¼ˆNginx/Ingressï¼‰å¼€å¯ QUIC æ”¯æŒï¼Œå¯¹ç§»åŠ¨ç«¯å¼±ç½‘ç¯å¢ƒæœ‰å¥‡æ•ˆã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-2">1.2 è¾¹ç¼˜è®¡ç®—ä¸ CDN ç­–ç•¥</h3>
<p>ä¸è¦åªæŠŠ CDN å½“ä½œå›¾ç‰‡å­˜å‚¨æ¡¶ã€‚</p>
<ul>
<li>
<p><strong>æˆ˜æœ¯ï¼š</strong></p>
<ul>
<li><strong>HTML è¾¹ç¼˜ç¼“å­˜:</strong> åˆ©ç”¨ Edge Computing (å¦‚ Cloudflare Workers) ç¼“å­˜ HTML é™æ€éƒ¨åˆ†ï¼ŒåŠ¨æ€æ•°æ®é€šè¿‡æµå¼ä¼ è¾“ (Streaming) è¡¥å…¨ã€‚</li>
<li><strong>DNS é¢„è§£æ:</strong> <code>&lt;link rel="dns-prefetch" href="//api.example.com"&gt;</code>ï¼Œåœ¨ JS å‘èµ·è¯·æ±‚å‰ï¼Œå…ˆæŠŠåŸŸåè§£æåšå¥½ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-3">ç¬¬äºŒå±‚ï¼šèµ„æºå±‚â€”â€”ä½“ç§¯çš„æè‡´å‹ç¼©</h2>
<p>è¿™æ˜¯ä¼˜åŒ–çš„â€œå‡è‚¥è®¡åˆ’â€ã€‚ç½‘ç»œå†å¿«ï¼Œä¹Ÿæ‰›ä¸ä½ä½ å‘ 10MB çš„ JS åŒ…ã€‚</p>
<h3 data-id="heading-4">2.1 ç°ä»£æ ¼å¼çš„é™ç»´æ‰“å‡»</h3>
<ul>
<li>
<p><strong>å›¾ç‰‡ï¼š</strong> æ”¾å¼ƒ JPG/PNGã€‚å…¨é¢æ‹¥æŠ± <strong>AVIF</strong> (æ¯” WebP æ›´å° 20%)ã€‚</p>
<ul>
<li><em>å…¼å®¹æ–¹æ¡ˆï¼š</em> <code>&lt;picture&gt;</code> æ ‡ç­¾åšé™çº§å¤„ç†ã€‚</li>
</ul>
</li>
<li>
<p><strong>å­—ä½“ï¼š</strong> å­—ä½“æ–‡ä»¶é€šå¸¸æ˜¯ LCP çš„æ€æ‰‹ã€‚</p>
<ul>
<li><strong>å­é›†åŒ– (Subsetting):</strong> åªæ‰“åŒ…ç”¨åˆ°çš„å­—å½¢ã€‚</li>
<li><strong>Woff2:</strong> å‹ç¼©ç‡æœ€é«˜çš„å­—ä½“æ ¼å¼ã€‚</li>
</ul>
</li>
<li>
<p><strong>å‹ç¼©ç®—æ³•ï¼š</strong> å¼€å¯ <strong>Brotli (br)</strong> å‹ç¼©ï¼Œæ¯” Gzip å¼º 15%-20%ã€‚</p>
</li>
</ul>
<h3 data-id="heading-5">2.2 æ„å»ºç­–ç•¥ï¼šTree Shaking ä¸åˆ†åŒ…</h3>
<ul>
<li><strong>Deep Tree Shaking:</strong> ç¡®ä¿ä½ çš„ npm åŒ…æ˜¯ ESM æ ¼å¼ï¼Œå¹¶åœ¨ <code>package.json</code> ä¸­æ­£ç¡®é…ç½® <code>sideEffects: false</code>ï¼Œå¦åˆ™ Webpack ä¸æ•¢åˆ ä»£ç ã€‚</li>
<li><strong>è·¯ç”±çº§ä»£ç åˆ†å‰²:</strong> è¿™æ˜¯åŸºæ“ã€‚</li>
<li><strong>Granular Chunking (ç»†ç²’åº¦åˆ†åŒ…):</strong> ä¹Ÿå°±æ˜¯ Vite/Rollup çš„ç­–ç•¥ã€‚ä¸è¦æŠŠæ‰€æœ‰ <code>node_modules</code> æ‰“æˆä¸€ä¸ªå·¨å¤§çš„ <code>vendor.js</code>ï¼Œè€Œæ˜¯æ‹†åˆ†æˆå¤šä¸ªå°å—ï¼Œåˆ©ç”¨ HTTP/2 çš„å¹¶å‘èƒ½åŠ›ä¸‹è½½ï¼Œæœ€å¤§åŒ–ç¼“å­˜å‘½ä¸­ç‡ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-6">ç¬¬ä¸‰å±‚ï¼šæ¸²æŸ“å±‚â€”â€”æµè§ˆå™¨çš„å‡è´Ÿè¿åŠ¨</h2>
<p>è¿™æ˜¯ä¼˜åŒ–çš„â€œå†…åŠŸå¿ƒæ³•â€ã€‚èµ„æºä¸‹è½½å®Œäº†ï¼Œä¸»çº¿ç¨‹ï¼ˆMain Threadï¼‰å¦‚æœä¸å¹²æ´»ï¼Œé¡µé¢è¿˜æ˜¯ç™½çš„ã€‚</p>
<h3 data-id="heading-7">3.1 å…³é”®æ¸²æŸ“è·¯å¾„ (CRP) ä¼˜åŒ–</h3>
<p>æµè§ˆå™¨æ¸²æŸ“é¡µé¢çš„é¡ºåºæ˜¯ï¼šHTML -&gt; CSSOM -&gt; RenderTree -&gt; Layout -&gt; Paintã€‚</p>
<ul>
<li>
<p><strong>æˆ˜æœ¯ï¼š</strong></p>
<ul>
<li><strong>Critical CSS Inlining:</strong> æå–é¦–å±å¯è§çš„ CSSï¼Œç›´æ¥å†…è”åœ¨ HTML çš„ <code>&lt;style&gt;</code> é‡Œã€‚è®©é¡µé¢åœ¨ CSS æ–‡ä»¶è¿˜æ²¡ä¸‹è½½å®Œä¹‹å‰å°±èƒ½æ¸²æŸ“å‡ºæ ·å¼ã€‚</li>
<li><strong>å¼‚æ­¥åŠ è½½éå…³é”® CSS:</strong> <code>&lt;link rel="stylesheet" media="print" onload="this.media='all'"&gt;</code>ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-8">3.2 é¿å…å›æµä¸é‡ç»˜ (Reflow &amp; Repaint)</h3>
<ul>
<li><strong>CSS æ–°ç‰¹æ€§ï¼š</strong> <code>content-visibility: auto</code>ã€‚è¿™ä¸ªå±æ€§å‘Šè¯‰æµè§ˆå™¨ï¼šâ€œå±å¹•å¤–çš„å…ƒç´ å…ˆåˆ«ç®—å¸ƒå±€â€ï¼Œç­‰æ»šåˆ°äº†å†ç®—ã€‚è¿™èƒ½æå¤§é™ä½é•¿åˆ—è¡¨é¡µé¢çš„æ¸²æŸ“æˆæœ¬ã€‚</li>
<li><strong>GPU åŠ é€Ÿï¼š</strong> å¯¹åŠ¨ç”»å…ƒç´ ä½¿ç”¨ <code>transform</code> å’Œ <code>opacity</code>ï¼Œå°†å›¾å±‚æå‡åˆ° GPU åˆæˆå±‚ï¼Œä¸å ç”¨ä¸»çº¿ç¨‹ CPUã€‚</li>
</ul>
<h3 data-id="heading-9">3.3 æ¡†æ¶å±‚é¢çš„ä¼˜åŒ–</h3>
<ul>
<li><strong>React:</strong> é¿å…ä¸å¿…è¦çš„ re-renderï¼ˆä½¿ç”¨ React Compiler æˆ– useMemoï¼‰ã€‚</li>
<li><strong>Vue:</strong> å–„ç”¨ <code>&lt;KeepAlive&gt;</code> ç¼“å­˜ç»„ä»¶å®ä¾‹ã€‚</li>
<li><strong>è™šæ‹Ÿåˆ—è¡¨ (Virtual Scroll):</strong> DOM èŠ‚ç‚¹æ°¸è¿œä¸è¦è¶…è¿‡ 1000 ä¸ªã€‚é•¿åˆ—è¡¨å¿…é¡»å›æ”¶ DOMã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-10">ç¬¬å››å±‚ï¼šæ„ŸçŸ¥å±‚â€”â€”å¿ƒç†æ—¶é—´çš„é­”æœ¯</h2>
<p>è¿™æ˜¯ä¼˜åŒ–çš„â€œéšœçœ¼æ³•â€ã€‚å½“ç‰©ç†é€Ÿåº¦è¾¾åˆ°æé™æ—¶ï¼Œæˆ‘ä»¬è¦æ¬ºéª—ç”¨æˆ·çš„å¤§è„‘ã€‚</p>
<h3 data-id="heading-11">4.1 éª¨æ¶å± (Skeleton) vs Loading è½¬åœˆ</h3>
<ul>
<li><strong>å¿ƒç†å­¦åŸç†ï¼š</strong> éª¨æ¶å±ç»™å‡ºäº†é¡µé¢çš„â€œç»“æ„é¢„æœŸâ€ï¼Œç”¨æˆ·ä¼šè§‰å¾—â€œåŠ è½½å·²ç»å¼€å§‹äº†â€ï¼Œç„¦è™‘æ„Ÿæ›´ä½ã€‚Loading è½¬åœˆåˆ™è®©ç”¨æˆ·è§‰å¾—â€œè¿˜åœ¨è¿æ¥æœåŠ¡å™¨â€ã€‚</li>
</ul>
<h3 data-id="heading-12">4.2 ä¹è§‚ UI (Optimistic UI)</h3>
<ul>
<li><strong>åœºæ™¯ï¼š</strong> ç”¨æˆ·ç‚¹èµã€è¯„è®ºã€‚</li>
<li><strong>æˆ˜æœ¯ï¼š</strong> å…ˆæ”¹ UI çŠ¶æ€ï¼ˆå˜çº¢ã€æ˜¾ç¤ºè¯„è®ºï¼‰ï¼Œå†å‘è¯·æ±‚ã€‚å¦‚æœè¯·æ±‚å¤±è´¥äº†ï¼Œå†æ‚„æ‚„å›æ»šå¹¶æç¤ºã€‚</li>
<li><strong>æ•ˆæœï¼š</strong> ç”¨æˆ·æ„Ÿè§‰æ“ä½œæ˜¯ <strong>0 å»¶è¿Ÿ</strong> çš„ã€‚</li>
</ul>
<h3 data-id="heading-13">4.3 é¢„æµ‹æ€§é¢„åŠ è½½ (Predictive Preloading)</h3>
<ul>
<li>
<p><strong>æˆ˜æœ¯ï¼š</strong></p>
<ul>
<li><strong>é¼ æ ‡æ‚¬åœé¢„åŠ è½½:</strong> å½“é¼ æ ‡ hover åˆ°é“¾æ¥ä¸Šè¶…è¿‡ 200msï¼Œæå¤§ç¨åç‚¹å‡»ï¼Œæ­¤æ—¶ç«‹åˆ»åå°åŠ è½½ä¸‹ä¸€ä¸ªé¡µé¢çš„èµ„æºã€‚</li>
<li><strong>Guess.js:</strong> åˆ©ç”¨ Google Analytics æ•°æ®ï¼ŒåŸºäºæœºå™¨å­¦ä¹ é¢„æµ‹ç”¨æˆ·ä¸‹ä¸€æ­¥æœ€å¯èƒ½å»çš„é¡µé¢ï¼Œå¹¶æå‰ <code>prefetch</code>ã€‚</li>
</ul>
</li>
</ul>
<hr/>
<h2 data-id="heading-14">äº”ã€ æ¶æ„å¸ˆçš„å†³ç­–çŸ©é˜µï¼šROI åˆ†æ</h2>
<p>æ‰‹é‡Œæœ‰è¿™ä¹ˆå¤šæˆ˜æœ¯ï¼Œå…ˆç”¨å“ªä¸ªï¼Ÿ æ¶æ„å¸ˆåˆ‡å¿Œâ€œä¸ºäº†ä¼˜åŒ–è€Œä¼˜åŒ–â€ã€‚ä½ éœ€è¦ä¸€ä¸ª <strong>æŠ•å…¥äº§å‡ºæ¯” (ROI)</strong> çŸ©é˜µã€‚</p>















































<table><thead><tr><th>æˆ˜æœ¯æ‰‹æ®µ</th><th>å®æ–½éš¾åº¦</th><th>æ”¶ç›Š (LCP/INP)</th><th>ä¼˜å…ˆçº§</th></tr></thead><tbody><tr><td><strong>å¼€å¯ HTTP/2 &amp; Gzip/Brotli</strong></td><td>ä½ (æ”¹é…ç½®)</td><td>é«˜</td><td><strong>P0 (å¿…é¡»åš)</strong></td></tr><tr><td><strong>å›¾ç‰‡æ ¼å¼å‡çº§ AVIF/WebP</strong></td><td>ä¸­ (æ”¹æ„å»º)</td><td>é«˜</td><td><strong>P0 (å¿…é¡»åš)</strong></td></tr><tr><td><strong>CDN ç¼“å­˜ç­–ç•¥</strong></td><td>ä½</td><td>ä¸­</td><td><strong>P1</strong></td></tr><tr><td><strong>è·¯ç”±æ‡’åŠ è½½</strong></td><td>ä½</td><td>ä¸­</td><td><strong>P1</strong></td></tr><tr><td><strong>å…³é”® CSS å†…è”</strong></td><td>é«˜ (æ˜“æ ·å¼é”™ä¹±)</td><td>ä¸­</td><td><strong>P2</strong></td></tr><tr><td><strong>Web Workers å¤šçº¿ç¨‹è®¡ç®—</strong></td><td>é«˜ (é‡æ„ä»£ç )</td><td>ä½ (ä»…ç‰¹å®šåœºæ™¯)</td><td><strong>P3</strong></td></tr></tbody></table>
<hr/>
<h2 data-id="heading-15">ç»“è¯­ï¼šæ€§èƒ½ä¼˜åŒ–çš„ç»ˆå±€</h2>
<p>ä¼˜åŒ–çš„æœ€é«˜å¢ƒç•Œï¼Œä¸æ˜¯æŠŠæ‰€æœ‰æŠ€å·§éƒ½ç”¨ä¸Šä¸€éï¼Œè€Œæ˜¯**â€œå› åœ°åˆ¶å®œâ€**ã€‚ å¯¹äºä¸€ä¸ªæ–°é—»ç½‘ç«™ï¼ŒLCP (é¦–å±å†…å®¹) æ˜¯å‘½è„‰ï¼›å¯¹äºä¸€ä¸ªåœ¨çº¿æ–‡æ¡£å·¥å…·ï¼ŒINP (äº¤äº’å“åº”) æ‰æ˜¯æ ¸å¿ƒã€‚</p>
<p>ç°åœ¨ï¼Œä½ çš„æ­¦å™¨åº“é‡Œå·²ç»è£…æ»¡äº†å„ç§é•¿æªçŸ­ç‚®ã€‚ ä½†æ˜¯ï¼Œ<strong>æ”»åŸå®¹æ˜“å®ˆåŸéš¾</strong>ã€‚ ä»Šå¤©ä½ æŠŠ LCP ä¼˜åŒ–åˆ°äº† 1.5sï¼Œä¸‹å‘¨å®ä¹ ç”Ÿæäº¤äº†ä¸€å¼  5MB çš„èƒŒæ™¯å›¾ï¼ŒLCP ç¬é—´å˜å› 5sã€‚</p>
<p>å¦‚ä½•é˜²æ­¢æ€§èƒ½é€€åŒ–ï¼Ÿå¦‚ä½•æŠŠæ€§èƒ½æ ‡å‡†å˜æˆåƒâ€œç¦æ­¢éšåœ°å¤§å°ä¾¿â€ä¸€æ ·çš„é“å¾‹ï¼Ÿ æˆ‘ä»¬éœ€è¦ <strong>CI/CD æµæ°´çº¿ä¸Šçš„å®ˆé—¨å‘˜</strong>ã€‚</p>
<blockquote>
<p><strong>Next Step:</strong> ä¸‹ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†è¿æ¥æœ¬é˜¶æ®µçš„æœ€ç»ˆç« ã€‚æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åœ¨ä»£ç æäº¤é˜¶æ®µï¼Œå°±è‡ªåŠ¨æ‹¦æˆªä¸åˆæ ¼çš„æ€§èƒ½ä»£ç ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Jetpack Compose ä»å…¥é—¨åˆ°ç²¾é€šï¼ˆäº”ï¼‰ï¼šåŠ¨ç”»ä¸äº¤äº’]]></title>    <link>https://juejin.cn/post/7602497125268946950</link>    <guid>https://juejin.cn/post/7602497125268946950</guid>    <pubDate>2026-02-04T03:05:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602497125268946950" data-draft-id="7602497125268930566" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Jetpack Compose ä»å…¥é—¨åˆ°ç²¾é€šï¼ˆäº”ï¼‰ï¼šåŠ¨ç”»ä¸äº¤äº’"/> <meta itemprop="keywords" content="Android,Android Jetpack,Kotlin"/> <meta itemprop="datePublished" content="2026-02-04T03:05:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é‚¹é˜¿æ¶›æ¶›æ¶›æ¶›æ¶›æ¶›æ¶›æ¶›"/> <meta itemprop="url" content="https://juejin.cn/user/3808364009106839"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Jetpack Compose ä»å…¥é—¨åˆ°ç²¾é€šï¼ˆäº”ï¼‰ï¼šåŠ¨ç”»ä¸äº¤äº’
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808364009106839/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é‚¹é˜¿æ¶›æ¶›æ¶›æ¶›æ¶›æ¶›æ¶›æ¶›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T03:05:13.000Z" title="Wed Feb 04 2026 03:05:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ·±å…¥ç†è§£ Compose åŠ¨ç”»ç³»ç»Ÿæ¶æ„ï¼ŒæŒæ¡å±æ€§åŠ¨ç”»ã€è¿‡æ¸¡åŠ¨ç”»ã€æ‰‹åŠ¿å¤„ç†çš„å®Œæ•´å®ç°æ–¹æ¡ˆï¼Œä»¥åŠè‡ªå®šä¹‰åŠ¨ç”»çš„è®¾è®¡æ€è·¯ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>åŠ¨ç”»æ˜¯æå‡ç”¨æˆ·ä½“éªŒçš„é‡è¦æ‰‹æ®µã€‚å¥½çš„åŠ¨ç”»èƒ½è®©ç•Œé¢æ›´æµç•…ã€æ›´è‡ªç„¶ï¼Œå¸®åŠ©ç”¨æˆ·ç†è§£ç•Œé¢å˜åŒ–ã€‚</p>
<p>Compose çš„åŠ¨ç”»ç³»ç»Ÿç›¸æ¯”ä¼ ç»Ÿ View ç³»ç»Ÿæœ‰è´¨çš„é£è·ƒï¼š</p>
<ul>
<li><strong>å£°æ˜å¼</strong>ï¼šç”¨ä»£ç æè¿°åŠ¨ç”»ç›®æ ‡çŠ¶æ€ï¼Œç³»ç»Ÿè‡ªåŠ¨å¤„ç†è¿‡æ¸¡</li>
<li><strong>å¯ç»„åˆ</strong>ï¼šåŠ¨ç”»å¯ä»¥åƒç»„ä»¶ä¸€æ ·ç»„åˆä½¿ç”¨</li>
<li><strong>é«˜æ€§èƒ½</strong>ï¼šåŸºäºåº•å±‚æ¸²æŸ“ä¼˜åŒ–ï¼Œ60fps æµç•…è¿è¡Œ</li>
</ul>
<p>æœ¬ç¯‡æ–‡ç« å°†æ·±å…¥è®²è§£ï¼š</p>
<ul>
<li>Compose åŠ¨ç”»ç³»ç»Ÿçš„æ¶æ„è®¾è®¡</li>
<li>å±æ€§åŠ¨ç”»ä¸è¿‡æ¸¡åŠ¨ç”»çš„å®ç°åŸç†</li>
<li>æ‰‹åŠ¿æ£€æµ‹ä¸å¤„ç†çš„å®Œæ•´æ–¹æ¡ˆ</li>
<li>è‡ªå®šä¹‰åŠ¨ç”»çš„è®¾è®¡æ€è·¯</li>
</ul>
<hr/>
<h2 data-id="heading-1">ä¸€ã€Compose åŠ¨ç”»ç³»ç»Ÿæ¶æ„</h2>
<h3 data-id="heading-2">1.1 åŠ¨ç”»ç³»ç»Ÿçš„å±‚æ¬¡ç»“æ„</h3>
<p>Compose åŠ¨ç”»ç³»ç»Ÿåˆ†ä¸ºä¸‰å±‚ï¼š</p>
<pre><code class="hljs language-css" lang="css">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Compose åŠ¨ç”»ç³»ç»Ÿæ¶æ„                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  é«˜å±‚ APIï¼ˆ declarative ï¼‰                                â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ animate*AsStateï¼ˆå±æ€§åŠ¨ç”»ï¼‰                          â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ AnimatedVisibilityï¼ˆå¯è§æ€§åŠ¨ç”»ï¼‰                     â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ AnimatedContentï¼ˆå†…å®¹åˆ‡æ¢åŠ¨ç”»ï¼‰                      â”‚   â”‚
â”‚  â”‚  â””â”€â”€ Crossfadeï¼ˆæ·¡å…¥æ·¡å‡ºï¼‰                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â†“                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ä¸­å±‚ APIï¼ˆ imperative ï¼‰                                 â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Animatableï¼ˆå¯æ§åŠ¨ç”»ï¼‰                               â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ animateDecayï¼ˆè¡°å‡åŠ¨ç”»ï¼‰                             â”‚   â”‚
â”‚  â”‚  â””â”€â”€ <span class="hljs-attribute">Transition</span>ï¼ˆçŠ¶æ€è¿‡æ¸¡ï¼‰                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â†“                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  åº•å±‚ APIï¼ˆåº•å±‚æ§åˆ¶ï¼‰                                     â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ <span class="hljs-attribute">Animation</span>ï¼ˆåŠ¨ç”»æ ¸å¿ƒï¼‰                                â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ AnimationVectorï¼ˆåŠ¨ç”»å‘é‡ï¼‰                          â”‚   â”‚
â”‚  â”‚  â””â”€â”€ AnimationSpecï¼ˆåŠ¨ç”»è§„æ ¼ï¼‰                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-3">1.2 åŠ¨ç”»çš„æ ¸å¿ƒæ¦‚å¿µ</h3>
<h4 data-id="heading-4">1.2.1 AnimationSpecï¼šåŠ¨ç”»è§„æ ¼</h4>
<p>AnimationSpec å®šä¹‰äº†åŠ¨ç”»çš„æ‰§è¡Œæ–¹å¼ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. tweenï¼šè¡¥é—´åŠ¨ç”»ï¼ŒæŒ‡å®šæ—¶é•¿å’Œç¼“åŠ¨æ›²çº¿</span>
<span class="hljs-keyword">val</span> tweenSpec = tween&lt;<span class="hljs-built_in">Float</span>&gt;(
    durationMillis = <span class="hljs-number">300</span>,
    easing = FastOutSlowInEasing
)

<span class="hljs-comment">// 2. springï¼šå¼¹ç°§åŠ¨ç”»ï¼Œç‰©ç†æ¨¡æ‹Ÿ</span>
<span class="hljs-keyword">val</span> springSpec = spring&lt;<span class="hljs-built_in">Float</span>&gt;(
    dampingRatio = Spring.DampingRatioMediumBouncy,
    stiffness = Spring.StiffnessLow
)

<span class="hljs-comment">// 3. keyframesï¼šå…³é”®å¸§åŠ¨ç”»</span>
<span class="hljs-keyword">val</span> keyframesSpec = keyframes&lt;<span class="hljs-built_in">Float</span>&gt; {
    durationMillis = <span class="hljs-number">900</span>
    <span class="hljs-number">0f</span> at <span class="hljs-number">0</span>
    <span class="hljs-number">0.4f</span> at <span class="hljs-number">300</span>
    <span class="hljs-number">0.4f</span> at <span class="hljs-number">600</span>
    <span class="hljs-number">1f</span> at <span class="hljs-number">900</span>
}

<span class="hljs-comment">// 4. repeatableï¼šé‡å¤åŠ¨ç”»</span>
<span class="hljs-keyword">val</span> repeatableSpec = repeatable&lt;<span class="hljs-built_in">Float</span>&gt;(
    iterations = <span class="hljs-number">3</span>,
    animation = tween(<span class="hljs-number">100</span>),
    repeatMode = RepeatMode.Reverse
)

<span class="hljs-comment">// 5. infiniteRepeatableï¼šæ— é™é‡å¤</span>
<span class="hljs-keyword">val</span> infiniteSpec = infiniteRepeatable&lt;<span class="hljs-built_in">Float</span>&gt;(
    animation = tween(<span class="hljs-number">1000</span>),
    repeatMode = RepeatMode.Reverse
)
</code></pre>
<h4 data-id="heading-5">1.2.2 Easingï¼šç¼“åŠ¨æ›²çº¿</h4>
<p>ç¼“åŠ¨æ›²çº¿å†³å®šäº†åŠ¨ç”»çš„é€Ÿåº¦å˜åŒ–ï¼š</p>
<pre><code class="hljs">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç¼“åŠ¨æ›²çº¿å¯¹æ¯”                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Linearï¼ˆçº¿æ€§ï¼‰                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    åŒ€é€Ÿè¿åŠ¨                               â”‚   â”‚
â”‚  â”‚  é€Ÿåº¦: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  FastOutSlowInï¼ˆå…ˆå¿«åæ…¢ï¼‰                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    è‡ªç„¶å‡é€Ÿ                               â”‚   â”‚
â”‚  â”‚  é€Ÿåº¦: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  FastOutLinearInï¼ˆå…ˆå¿«ååŒ€é€Ÿï¼‰                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    å¿«é€Ÿå¯åŠ¨                               â”‚   â”‚
â”‚  â”‚  é€Ÿåº¦: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  LinearOutSlowInï¼ˆå…ˆåŒ€é€Ÿåæ…¢ï¼‰                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    ç¼“æ…¢åœæ­¢                               â”‚   â”‚
â”‚  â”‚  é€Ÿåº¦: â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  Springï¼ˆå¼¹ç°§ï¼‰                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    ç‰©ç†æ¨¡æ‹Ÿ                               â”‚   â”‚
â”‚  â”‚  é€Ÿåº¦: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–‘â–‘â–‘â–ˆâ–‘â–‘                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h2 data-id="heading-6">äºŒã€å±æ€§åŠ¨ç”»ï¼ˆanimate*AsStateï¼‰</h2>
<h3 data-id="heading-7">2.1 ä»€ä¹ˆæ˜¯å±æ€§åŠ¨ç”»ï¼Ÿ</h3>
<p>å±æ€§åŠ¨ç”»æ˜¯æœ€å¸¸ç”¨çš„åŠ¨ç”» APIï¼Œç”¨äºå°†æŸä¸ªå±æ€§çš„å˜åŒ–è¿‡ç¨‹åŠ¨ç”»åŒ–ã€‚</p>
<h3 data-id="heading-8">2.2 animate*AsState ç³»åˆ—å‡½æ•°</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. åŠ¨ç”»åŒ– Float å€¼</span>
<span class="hljs-keyword">val</span> alpha <span class="hljs-keyword">by</span> animateFloatAsState(
    targetValue = <span class="hljs-keyword">if</span> (visible) <span class="hljs-number">1f</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0f</span>,
    animationSpec = tween(<span class="hljs-number">300</span>)
)

<span class="hljs-comment">// 2. åŠ¨ç”»åŒ– Dp å€¼</span>
<span class="hljs-keyword">val</span> size <span class="hljs-keyword">by</span> animateDpAsState(
    targetValue = <span class="hljs-keyword">if</span> (expanded) <span class="hljs-number">200.</span>dp <span class="hljs-keyword">else</span> <span class="hljs-number">100.</span>dp,
    animationSpec = spring()
)

<span class="hljs-comment">// 3. åŠ¨ç”»åŒ– Offset</span>
<span class="hljs-keyword">val</span> offset <span class="hljs-keyword">by</span> animateOffsetAsState(
    targetValue = <span class="hljs-keyword">if</span> (moved) Offset(<span class="hljs-number">100f</span>, <span class="hljs-number">100f</span>) <span class="hljs-keyword">else</span> Offset.Zero,
    animationSpec = tween(<span class="hljs-number">500</span>)
)

<span class="hljs-comment">// 4. åŠ¨ç”»åŒ– Color</span>
<span class="hljs-keyword">val</span> color <span class="hljs-keyword">by</span> animateColorAsState(
    targetValue = <span class="hljs-keyword">if</span> (selected) Color.Blue <span class="hljs-keyword">else</span> Color.Gray,
    animationSpec = tween(<span class="hljs-number">200</span>)
)

<span class="hljs-comment">// 5. åŠ¨ç”»åŒ–ä»»ä½•ç±»å‹ï¼ˆéœ€è¦æŒ‡å®š TwoWayConverterï¼‰</span>
<span class="hljs-keyword">val</span> rect <span class="hljs-keyword">by</span> animateValueAsState(
    targetValue = <span class="hljs-keyword">if</span> (expanded) Rect(<span class="hljs-number">0f</span>, <span class="hljs-number">0f</span>, <span class="hljs-number">200f</span>, <span class="hljs-number">200f</span>) <span class="hljs-keyword">else</span> Rect(<span class="hljs-number">0f</span>, <span class="hljs-number">0f</span>, <span class="hljs-number">100f</span>, <span class="hljs-number">100f</span>),
    typeConverter = Rect.VectorConverter,
    animationSpec = tween(<span class="hljs-number">300</span>)
)
</code></pre>
<h3 data-id="heading-9">2.3 å®æˆ˜ï¼šå¯å±•å¼€å¡ç‰‡</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">ExpandableCard</span><span class="hljs-params">(
    title: <span class="hljs-type">String</span>,
    content: <span class="hljs-type">String</span>
)</span></span> {
    <span class="hljs-keyword">var</span> expanded <span class="hljs-keyword">by</span> remember { mutableStateOf(<span class="hljs-literal">false</span>) }
    
    <span class="hljs-comment">// åŠ¨ç”»åŒ–é«˜åº¦</span>
    <span class="hljs-keyword">val</span> cardHeight <span class="hljs-keyword">by</span> animateDpAsState(
        targetValue = <span class="hljs-keyword">if</span> (expanded) <span class="hljs-number">200.</span>dp <span class="hljs-keyword">else</span> <span class="hljs-number">80.</span>dp,
        animationSpec = spring(
            dampingRatio = Spring.DampingRatioMediumBouncy,
            stiffness = Spring.StiffnessLow
        ),
        label = <span class="hljs-string">"cardHeight"</span>
    )
    
    <span class="hljs-comment">// åŠ¨ç”»åŒ–æ—‹è½¬è§’åº¦</span>
    <span class="hljs-keyword">val</span> rotation <span class="hljs-keyword">by</span> animateFloatAsState(
        targetValue = <span class="hljs-keyword">if</span> (expanded) <span class="hljs-number">180f</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0f</span>,
        animationSpec = tween(<span class="hljs-number">300</span>),
        label = <span class="hljs-string">"rotation"</span>
    )
    
    Card(
        modifier = Modifier
            .fillMaxWidth()
            .height(cardHeight)
            .clickable { expanded = !expanded },
        colors = CardDefaults.cardColors(
            containerColor = MaterialTheme.colorScheme.surfaceVariant
        )
    ) {
        Column(
            modifier = Modifier.padding(<span class="hljs-number">16.</span>dp)
        ) {
            Row(
                modifier = Modifier.fillMaxWidth(),
                horizontalArrangement = Arrangement.SpaceBetween,
                verticalAlignment = Alignment.CenterVertically
            ) {
                Text(
                    text = title,
                    style = MaterialTheme.typography.titleMedium
                )
                
                Icon(
                    imageVector = Icons.Default.ExpandMore,
                    contentDescription = <span class="hljs-keyword">if</span> (expanded) <span class="hljs-string">"æ”¶èµ·"</span> <span class="hljs-keyword">else</span> <span class="hljs-string">"å±•å¼€"</span>,
                    modifier = Modifier.rotate(rotation)
                )
            }
            
            AnimatedVisibility(visible = expanded) {
                Text(
                    text = content,
                    style = MaterialTheme.typography.bodyMedium,
                    modifier = Modifier.padding(top = <span class="hljs-number">16.</span>dp)
                )
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-10">2.4 animate*AsState çš„æºç è§£æ</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// animateFloatAsState ç®€åŒ–å®ç°</span>
<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">animateFloatAsState</span><span class="hljs-params">(
    targetValue: <span class="hljs-type">Float</span>,
    animationSpec: <span class="hljs-type">AnimationSpec</span>&lt;<span class="hljs-type">Float</span>&gt; = defaultAnimationSpec,
    label: <span class="hljs-type">String</span> = <span class="hljs-string">"FloatAnimation"</span>
)</span></span>: State&lt;<span class="hljs-built_in">Float</span>&gt; {
    <span class="hljs-comment">// åˆ›å»º Animatable ä¿å­˜åŠ¨ç”»çŠ¶æ€</span>
    <span class="hljs-keyword">val</span> animatable = remember { Animatable(targetValue) }
    
    <span class="hljs-comment">// å½“ targetValue å˜åŒ–æ—¶å¯åŠ¨åŠ¨ç”»</span>
    LaunchedEffect(targetValue) {
        animatable.animateTo(
            targetValue = targetValue,
            animationSpec = animationSpec
        )
    }
    
    <span class="hljs-keyword">return</span> animatable.asState()
}
</code></pre>
<p><strong>æ‰§è¡Œæµç¨‹</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> é¦–æ¬¡ç»„åˆ
   â”œâ”€â”€ åˆ›å»º Animatableï¼Œåˆå§‹å€¼ä¸º targetValue
   â”œâ”€â”€ è¿”å›å½“å‰å€¼
   
<span class="hljs-bullet">2.</span> targetValue å˜åŒ–
   â”œâ”€â”€ LaunchedEffect æ£€æµ‹åˆ°å˜åŒ–
   â”œâ”€â”€ å¯åŠ¨åŠ¨ç”»ï¼Œä»å½“å‰å€¼è¿‡æ¸¡åˆ°æ–°å€¼
   â”œâ”€â”€ æ¯å¸§æ›´æ–° Animatable çš„å€¼
   â”œâ”€â”€ è§¦å‘é‡ç»„ï¼ŒUI æ›´æ–°
   
<span class="hljs-bullet">3.</span> åŠ¨ç”»å®Œæˆ
   â”œâ”€â”€ Animatable çš„å€¼ç¨³å®šåœ¨ targetValue
   â”œâ”€â”€ åœæ­¢æ›´æ–°
</code></pre>
<hr/>
<h2 data-id="heading-11">ä¸‰ã€è¿‡æ¸¡åŠ¨ç”»</h2>
<h3 data-id="heading-12">3.1 AnimatedVisibilityï¼šå¯è§æ€§åŠ¨ç”»</h3>
<p>AnimatedVisibility ç”¨äºæ§åˆ¶ç»„ä»¶çš„æ˜¾ç¤º/éšè—åŠ¨ç”»ã€‚</p>
<h4 data-id="heading-13">3.1.1 åŸºæœ¬ç”¨æ³•</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">var</span> visible <span class="hljs-keyword">by</span> remember { mutableStateOf(<span class="hljs-literal">true</span>) }

AnimatedVisibility(
    visible = visible,
    enter = fadeIn() + expandVertically(),
    exit = fadeOut() + shrinkVertically()
) {
    Text(<span class="hljs-string">"Hello, World!"</span>)
}
</code></pre>
<h4 data-id="heading-14">3.1.2 å†…ç½®åŠ¨ç”»æ•ˆæœ</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// è¿›å…¥åŠ¨ç”»</span>
fadeIn(animationSpec = tween(<span class="hljs-number">300</span>))           <span class="hljs-comment">// æ·¡å…¥</span>
slideInHorizontally { it }                   <span class="hljs-comment">// æ°´å¹³æ»‘å…¥</span>
slideInVertically { it }                     <span class="hljs-comment">// å‚ç›´æ»‘å…¥</span>
expandIn(expandFrom = Alignment.TopStart)    <span class="hljs-comment">// æ‰©å±•è¿›å…¥</span>
expandHorizontally()                         <span class="hljs-comment">// æ°´å¹³æ‰©å±•</span>
expandVertically()                           <span class="hljs-comment">// å‚ç›´æ‰©å±•</span>
scaleIn(initialScale = <span class="hljs-number">0.5f</span>)                 <span class="hljs-comment">// ç¼©æ”¾è¿›å…¥</span>

<span class="hljs-comment">// é€€å‡ºåŠ¨ç”»</span>
fadeOut(animationSpec = tween(<span class="hljs-number">300</span>))          <span class="hljs-comment">// æ·¡å‡º</span>
slideOutHorizontally { it }                  <span class="hljs-comment">// æ°´å¹³æ»‘å‡º</span>
slideOutVertically { it }                    <span class="hljs-comment">// å‚ç›´æ»‘å‡º</span>
shrinkOut(shrinkTowards = Alignment.TopStart)<span class="hljs-comment">// æ”¶ç¼©é€€å‡º</span>
shrinkHorizontally()                         <span class="hljs-comment">// æ°´å¹³æ”¶ç¼©</span>
shrinkVertically()                           <span class="hljs-comment">// å‚ç›´æ”¶ç¼©</span>
scaleOut(targetScale = <span class="hljs-number">0.5f</span>)                 <span class="hljs-comment">// ç¼©æ”¾é€€å‡º</span>

<span class="hljs-comment">// ç»„åˆåŠ¨ç”»</span>
enter = fadeIn() + slideInVertically()       <span class="hljs-comment">// æ·¡å…¥ + ä¸Šæ»‘</span>
exit = fadeOut() + slideOutVertically()      <span class="hljs-comment">// æ·¡å‡º + ä¸‹æ»‘</span>
</code></pre>
<h4 data-id="heading-15">3.1.3 å®æˆ˜ï¼šåˆ—è¡¨é¡¹åˆ é™¤åŠ¨ç”»</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">DeletableListItem</span><span class="hljs-params">(
    item: <span class="hljs-type">String</span>,
    onDelete: () -&gt; <span class="hljs-type">Unit</span>
)</span></span> {
    <span class="hljs-keyword">var</span> visible <span class="hljs-keyword">by</span> remember { mutableStateOf(<span class="hljs-literal">true</span>) }
    
    AnimatedVisibility(
        visible = visible,
        enter = fadeIn() + expandVertically(),
        exit = fadeOut() + shrinkVertically(
            animationSpec = tween(<span class="hljs-number">300</span>),
            shrinkTowards = Alignment.Top
        )
    ) {
        Card(
            modifier = Modifier
                .fillMaxWidth()
                .padding(<span class="hljs-number">8.</span>dp)
        ) {
            Row(
                modifier = Modifier.padding(<span class="hljs-number">16.</span>dp),
                horizontalArrangement = Arrangement.SpaceBetween
            ) {
                Text(item)
                IconButton(
                    onClick = {
                        visible = <span class="hljs-literal">false</span>  <span class="hljs-comment">// è§¦å‘åŠ¨ç”»</span>
                        <span class="hljs-comment">// åŠ¨ç”»å®ŒæˆåçœŸæ­£åˆ é™¤</span>
                        Handler(Looper.getMainLooper()).postDelayed({
                            onDelete()
                        }, <span class="hljs-number">300</span>)
                    }
                ) {
                    Icon(Icons.Default.Delete, contentDescription = <span class="hljs-string">"åˆ é™¤"</span>)
                }
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-16">3.2 AnimatedContentï¼šå†…å®¹åˆ‡æ¢åŠ¨ç”»</h3>
<p>AnimatedContent ç”¨äºåœ¨å†…å®¹å˜åŒ–æ—¶æ’­æ”¾è¿‡æ¸¡åŠ¨ç”»ã€‚</p>
<h4 data-id="heading-17">3.2.1 åŸºæœ¬ç”¨æ³•</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">var</span> count <span class="hljs-keyword">by</span> remember { mutableStateOf(<span class="hljs-number">0</span>) }

AnimatedContent(
    targetState = count,
    transitionSpec = {
        <span class="hljs-comment">// è¿›å…¥åŠ¨ç”»</span>
        (slideInVertically { it } + fadeIn())
            .togetherWith(
                <span class="hljs-comment">// é€€å‡ºåŠ¨ç”»</span>
                slideOutVertically { -it } + fadeOut()
            )
    },
    label = <span class="hljs-string">"count"</span>
) { targetCount -&gt;
    Text(
        text = <span class="hljs-string">"<span class="hljs-variable">$targetCount</span>"</span>,
        style = MaterialTheme.typography.headlineLarge
    )
}
</code></pre>
<h4 data-id="heading-18">3.2.2 å®æˆ˜ï¼šé¡µé¢åˆ‡æ¢åŠ¨ç”»</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">sealed</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Screen</span> {
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">object</span> Home : Screen()
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">object</span> Profile : Screen()
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">object</span> Settings : Screen()
}

<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">AppNavigation</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">var</span> currentScreen <span class="hljs-keyword">by</span> remember { mutableStateOf&lt;Screen&gt;(Screen.Home) }
    
    AnimatedContent(
        targetState = currentScreen,
        transitionSpec = {
            <span class="hljs-comment">// æ ¹æ®å¯¼èˆªæ–¹å‘é€‰æ‹©åŠ¨ç”»</span>
            <span class="hljs-keyword">val</span> direction = <span class="hljs-keyword">if</span> (targetState &gt; initialState) <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> -<span class="hljs-number">1</span>
            
            (slideInHorizontally { it * direction } + fadeIn())
                .togetherWith(
                    slideOutHorizontally { -it * direction } + fadeOut()
                )
        },
        label = <span class="hljs-string">"screen"</span>
    ) { screen -&gt;
        <span class="hljs-keyword">when</span> (screen) {
            <span class="hljs-keyword">is</span> Screen.Home -&gt; HomeScreen()
            <span class="hljs-keyword">is</span> Screen.Profile -&gt; ProfileScreen()
            <span class="hljs-keyword">is</span> Screen.Settings -&gt; SettingsScreen()
        }
    }
}
</code></pre>
<h3 data-id="heading-19">3.3 Crossfadeï¼šæ·¡å…¥æ·¡å‡º</h3>
<p>Crossfade ç”¨äºä¸¤ä¸ªå†…å®¹ä¹‹é—´çš„äº¤å‰æ·¡å…¥æ·¡å‡ºã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">var</span> currentPage <span class="hljs-keyword">by</span> remember { mutableStateOf(<span class="hljs-string">"A"</span>) }

Crossfade(
    targetState = currentPage,
    animationSpec = tween(<span class="hljs-number">500</span>),
    label = <span class="hljs-string">"page"</span>
) { page -&gt;
    <span class="hljs-keyword">when</span> (page) {
        <span class="hljs-string">"A"</span> -&gt; PageA()
        <span class="hljs-string">"B"</span> -&gt; PageB()
        <span class="hljs-string">"C"</span> -&gt; PageC()
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-20">å››ã€Animatableï¼šå¯æ§åŠ¨ç”»</h2>
<h3 data-id="heading-21">4.1 ä»€ä¹ˆæ˜¯ Animatableï¼Ÿ</h3>
<p>Animatable æ˜¯ä¸€ä¸ªå¯åŠ¨ç”»åŒ–çš„å€¼å®¹å™¨ï¼Œæä¾›äº†æ›´ç»†ç²’åº¦çš„åŠ¨ç”»æ§åˆ¶ï¼š</p>
<ul>
<li>åœæ­¢åŠ¨ç”»</li>
<li>è·³è½¬ç›®æ ‡å€¼</li>
<li>å¿«ç…§å½“å‰å€¼</li>
</ul>
<h3 data-id="heading-22">4.2 Animatable çš„åŸºæœ¬ç”¨æ³•</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">DraggableBox</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> offsetX = remember { Animatable(<span class="hljs-number">0f</span>) }
    <span class="hljs-keyword">val</span> scope = rememberCoroutineScope()
    
    Box(
        modifier = Modifier
            .offset { IntOffset(offsetX.value.toInt(), <span class="hljs-number">0</span>) }
            .size(<span class="hljs-number">100.</span>dp)
            .background(Color.Blue)
            .pointerInput(<span class="hljs-built_in">Unit</span>) {
                detectDragGestures(
                    onDrag = { change, dragAmount -&gt;
                        change.consume()
                        scope.launch {
                            offsetX.snapTo(offsetX.value + dragAmount.x)
                        }
                    },
                    onDragEnd = {
                        scope.launch {
                            <span class="hljs-comment">// å¼¹å›åŸç‚¹</span>
                            offsetX.animateTo(
                                targetValue = <span class="hljs-number">0f</span>,
                                animationSpec = spring()
                            )
                        }
                    }
                )
            }
    )
}
</code></pre>
<h3 data-id="heading-23">4.3 Animatable çš„æ–¹æ³•</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> animatable = remember { Animatable(<span class="hljs-number">0f</span>) }

<span class="hljs-comment">// 1. animateToï¼šåŠ¨ç”»åˆ°ç›®æ ‡å€¼</span>
animatable.animateTo(<span class="hljs-number">100f</span>, tween(<span class="hljs-number">300</span>))

<span class="hljs-comment">// 2. snapToï¼šç«‹å³è·³è½¬åˆ°ç›®æ ‡å€¼ï¼ˆæ— åŠ¨ç”»ï¼‰</span>
animatable.snapTo(<span class="hljs-number">100f</span>)

<span class="hljs-comment">// 3. stopï¼šåœæ­¢å½“å‰åŠ¨ç”»</span>
animatable.stop()

<span class="hljs-comment">// 4. è·å–å½“å‰å€¼</span>
<span class="hljs-keyword">val</span> currentValue = animatable.value
</code></pre>
<hr/>
<h2 data-id="heading-24">äº”ã€æ‰‹åŠ¿å¤„ç†</h2>
<h3 data-id="heading-25">5.1 ç‚¹å‡»æ‰‹åŠ¿</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. clickableï¼šåŸºç¡€ç‚¹å‡»</span>
Box(
    modifier = Modifier.clickable { <span class="hljs-comment">/* ç‚¹å‡»å¤„ç† */</span> }
)

<span class="hljs-comment">// 2. combinedClickableï¼šç»„åˆç‚¹å‡»ï¼ˆå•å‡»ã€åŒå‡»ã€é•¿æŒ‰ï¼‰</span>
Box(
    modifier = Modifier.combinedClickable(
        onClick = { <span class="hljs-comment">/* å•å‡» */</span> },
        onDoubleClick = { <span class="hljs-comment">/* åŒå‡» */</span> },
        onLongClick = { <span class="hljs-comment">/* é•¿æŒ‰ */</span> }
    )
)

<span class="hljs-comment">// 3. indicationï¼šè‡ªå®šä¹‰æ¶Ÿæ¼ªæ•ˆæœ</span>
Box(
    modifier = Modifier.clickable(
        interactionSource = remember { MutableInteractionSource() },
        indication = ripple(color = Color.Red),
        onClick = { }
    )
)
</code></pre>
<h3 data-id="heading-26">5.2 æ‹–åŠ¨æ‰‹åŠ¿</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">DraggableCard</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">var</span> offsetX <span class="hljs-keyword">by</span> remember { mutableStateOf(<span class="hljs-number">0f</span>) }
    <span class="hljs-keyword">var</span> offsetY <span class="hljs-keyword">by</span> remember { mutableStateOf(<span class="hljs-number">0f</span>) }
    
    Card(
        modifier = Modifier
            .offset { IntOffset(offsetX.toInt(), offsetY.toInt()) }
            .pointerInput(<span class="hljs-built_in">Unit</span>) {
                detectDragGestures { change, dragAmount -&gt;
                    change.consume()
                    offsetX += dragAmount.x
                    offsetY += dragAmount.y
                }
            }
    ) {
        Text(<span class="hljs-string">"æ‹–åŠ¨æˆ‘"</span>)
    }
}
</code></pre>
<h3 data-id="heading-27">5.3 æ»‘åŠ¨æ‰‹åŠ¿</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">SwipeableCard</span><span class="hljs-params">(
    onDismiss: () -&gt; <span class="hljs-type">Unit</span>
)</span></span> {
    <span class="hljs-keyword">val</span> scope = rememberCoroutineScope()
    <span class="hljs-keyword">val</span> offsetX = remember { Animatable(<span class="hljs-number">0f</span>) }
    
    <span class="hljs-comment">// æ»‘åŠ¨é˜ˆå€¼</span>
    <span class="hljs-keyword">val</span> dismissThreshold = <span class="hljs-number">300f</span>
    
    Card(
        modifier = Modifier
            .offset { IntOffset(offsetX.value.toInt(), <span class="hljs-number">0</span>) }
            .pointerInput(<span class="hljs-built_in">Unit</span>) {
                detectHorizontalDragGestures(
                    onDragEnd = {
                        scope.launch {
                            <span class="hljs-keyword">if</span> (abs(offsetX.value) &gt; dismissThreshold) {
                                <span class="hljs-comment">// æ»‘è¿‡é˜ˆå€¼ï¼Œæ‰§è¡Œåˆ é™¤</span>
                                offsetX.animateTo(
                                    <span class="hljs-keyword">if</span> (offsetX.value &gt; <span class="hljs-number">0</span>) <span class="hljs-number">1000f</span> <span class="hljs-keyword">else</span> -<span class="hljs-number">1000f</span>
                                )
                                onDismiss()
                            } <span class="hljs-keyword">else</span> {
                                <span class="hljs-comment">// æœªæ»‘è¿‡é˜ˆå€¼ï¼Œå¼¹å›</span>
                                offsetX.animateTo(<span class="hljs-number">0f</span>, spring())
                            }
                        }
                    },
                    onHorizontalDrag = { change, dragAmount -&gt;
                        change.consume()
                        scope.launch {
                            offsetX.snapTo(offsetX.value + dragAmount)
                        }
                    }
                )
            }
    ) {
        Text(<span class="hljs-string">"å·¦å³æ»‘åŠ¨"</span>)
    }
}
</code></pre>
<h3 data-id="heading-28">5.4 ç¼©æ”¾æ‰‹åŠ¿</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">ZoomableImage</span><span class="hljs-params">(
    painter: <span class="hljs-type">Painter</span>
)</span></span> {
    <span class="hljs-keyword">var</span> scale <span class="hljs-keyword">by</span> remember { mutableStateOf(<span class="hljs-number">1f</span>) }
    <span class="hljs-keyword">var</span> offsetX <span class="hljs-keyword">by</span> remember { mutableStateOf(<span class="hljs-number">0f</span>) }
    <span class="hljs-keyword">var</span> offsetY <span class="hljs-keyword">by</span> remember { mutableStateOf(<span class="hljs-number">0f</span>) }
    
    Image(
        painter = painter,
        contentDescription = <span class="hljs-literal">null</span>,
        modifier = Modifier
            .fillMaxSize()
            .graphicsLayer {
                scaleX = scale
                scaleY = scale
                translationX = offsetX
                translationY = offsetY
            }
            .pointerInput(<span class="hljs-built_in">Unit</span>) {
                detectTransformGestures { _, pan, zoom, _ -&gt;
                    scale = (scale * zoom).coerceIn(<span class="hljs-number">1f</span>, <span class="hljs-number">5f</span>)
                    offsetX += pan.x
                    offsetY += pan.y
                }
            }
    )
}
</code></pre>
<h3 data-id="heading-29">5.5 åµŒå¥—æ»šåŠ¨</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">NestedScrollDemo</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> scrollState = rememberScrollState()
    
    Column(
        modifier = Modifier
            .fillMaxSize()
            .nestedScroll(
                connection = remember {
                    <span class="hljs-keyword">object</span> : NestedScrollConnection {
                        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onPreScroll</span><span class="hljs-params">(
                            available: <span class="hljs-type">Offset</span>,
                            source: <span class="hljs-type">NestedScrollSource</span>
                        )</span></span>: Offset {
                            <span class="hljs-comment">// åœ¨å­ç»„ä»¶æ»šåŠ¨å‰å¤„ç†</span>
                            <span class="hljs-keyword">return</span> Offset.Zero
                        }
                        
                        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onPostScroll</span><span class="hljs-params">(
                            consumed: <span class="hljs-type">Offset</span>,
                            available: <span class="hljs-type">Offset</span>,
                            source: <span class="hljs-type">NestedScrollSource</span>
                        )</span></span>: Offset {
                            <span class="hljs-comment">// åœ¨å­ç»„ä»¶æ»šåŠ¨åå¤„ç†</span>
                            <span class="hljs-keyword">return</span> Offset.Zero
                        }
                    }
                }
            )
            .verticalScroll(scrollState)
    ) {
        <span class="hljs-comment">// å†…å®¹</span>
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-30">å…­ã€è‡ªå®šä¹‰åŠ¨ç”»</h2>
<h3 data-id="heading-31">6.1 æ— é™å¾ªç¯åŠ¨ç”»</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">PulsingDot</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> infiniteTransition = rememberInfiniteTransition(label = <span class="hljs-string">"pulse"</span>)
    
    <span class="hljs-keyword">val</span> scale <span class="hljs-keyword">by</span> infiniteTransition.animateFloat(
        initialValue = <span class="hljs-number">1f</span>,
        targetValue = <span class="hljs-number">1.5f</span>,
        animationSpec = infiniteRepeatable(
            animation = tween(<span class="hljs-number">1000</span>),
            repeatMode = RepeatMode.Reverse
        ),
        label = <span class="hljs-string">"scale"</span>
    )
    
    <span class="hljs-keyword">val</span> alpha <span class="hljs-keyword">by</span> infiniteTransition.animateFloat(
        initialValue = <span class="hljs-number">1f</span>,
        targetValue = <span class="hljs-number">0.5f</span>,
        animationSpec = infiniteRepeatable(
            animation = tween(<span class="hljs-number">1000</span>),
            repeatMode = RepeatMode.Reverse
        ),
        label = <span class="hljs-string">"alpha"</span>
    )
    
    Box(
        modifier = Modifier
            .size(<span class="hljs-number">20.</span>dp)
            .scale(scale)
            .alpha(alpha)
            .background(Color.Red, CircleShape)
    )
}
</code></pre>
<h3 data-id="heading-32">6.2 å…³é”®å¸§åŠ¨ç”»</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">BouncingBall</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> ballY <span class="hljs-keyword">by</span> animateFloatAsState(
        targetValue = <span class="hljs-number">300f</span>,
        animationSpec = keyframes {
            durationMillis = <span class="hljs-number">1000</span>
            <span class="hljs-number">0f</span> at <span class="hljs-number">0</span> with FastOutSlowInEasing
            <span class="hljs-number">300f</span> at <span class="hljs-number">300</span> with LinearEasing
            <span class="hljs-number">150f</span> at <span class="hljs-number">500</span> with FastOutSlowInEasing
            <span class="hljs-number">300f</span> at <span class="hljs-number">700</span> with LinearEasing
            <span class="hljs-number">225f</span> at <span class="hljs-number">850</span> with FastOutSlowInEasing
            <span class="hljs-number">300f</span> at <span class="hljs-number">1000</span>
        },
        label = <span class="hljs-string">"bounce"</span>
    )
    
    Box(
        modifier = Modifier
            .offset(y = ballY.dp)
            .size(<span class="hljs-number">50.</span>dp)
            .background(Color.Blue, CircleShape)
    )
}
</code></pre>
<h3 data-id="heading-33">6.3 æ‰‹åŠ¿é©±åŠ¨çš„åŠ¨ç”»</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">SwipeToDismissItem</span><span class="hljs-params">(
    content: @<span class="hljs-type">Composable</span> () -&gt; <span class="hljs-type">Unit</span>,
    onDismiss: () -&gt; <span class="hljs-type">Unit</span>
)</span></span> {
    <span class="hljs-keyword">val</span> scope = rememberCoroutineScope()
    <span class="hljs-keyword">val</span> offsetX = remember { Animatable(<span class="hljs-number">0f</span>) }
    
    Box(
        modifier = Modifier
            .offset { IntOffset(offsetX.value.toInt(), <span class="hljs-number">0</span>) }
            .draggable(
                orientation = Orientation.Horizontal,
                state = rememberDraggableState { delta -&gt;
                    scope.launch {
                        offsetX.snapTo(offsetX.value + delta)
                    }
                },
                onDragStopped = {
                    scope.launch {
                        <span class="hljs-keyword">if</span> (abs(offsetX.value) &gt; <span class="hljs-number">200f</span>) {
                            offsetX.animateTo(<span class="hljs-keyword">if</span> (offsetX.value &gt; <span class="hljs-number">0</span>) <span class="hljs-number">1000f</span> <span class="hljs-keyword">else</span> -<span class="hljs-number">1000f</span>)
                            onDismiss()
                        } <span class="hljs-keyword">else</span> {
                            offsetX.animateTo(<span class="hljs-number">0f</span>, spring())
                        }
                    }
                }
            )
    ) {
        content()
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-34">ä¸ƒã€åŠ¨ç”»æ€§èƒ½ä¼˜åŒ–</h2>
<h3 data-id="heading-35">7.1 åŠ¨ç”»æ€§èƒ½åŸåˆ™</h3>
<pre><code class="hljs language-arduino" lang="arduino">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åŠ¨ç”»æ€§èƒ½ä¼˜åŒ–åŸåˆ™                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  âœ… æ¨è                                                         â”‚
â”‚  â”œâ”€â”€ ä½¿ç”¨ graphicsLayer è¿›è¡Œå˜æ¢ï¼ˆscaleã€rotationã€alphaï¼‰       â”‚
â”‚  â”œâ”€â”€ ä½¿ç”¨ offset è¿›è¡Œä½ç½®ç§»åŠ¨                                    â”‚
â”‚  â”œâ”€â”€ é¿å…åŠ¨ç”»åŒ–å°ºå¯¸å˜åŒ–ï¼ˆwidthã€heightï¼‰                         â”‚
â”‚  â””â”€â”€ ä½¿ç”¨ derivedStateOf å‡å°‘ä¸å¿…è¦çš„åŠ¨ç”»è®¡ç®—                    â”‚
â”‚                                                                 â”‚
â”‚  âŒ é¿å…                                                         â”‚
â”‚  â”œâ”€â”€ åŠ¨ç”»åŒ–å¤æ‚å¸ƒå±€ï¼ˆConstraintLayoutã€è‡ªå®šä¹‰ Layoutï¼‰           â”‚
â”‚  â”œâ”€â”€ åœ¨åŠ¨ç”»ä¸­è¯»å–/å†™å…¥å¤§é‡çŠ¶æ€                                   â”‚
â”‚  â””â”€â”€ åŒæ—¶è¿è¡Œè¿‡å¤šçš„åŠ¨ç”»                                          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-36">7.2 ä½¿ç”¨ graphicsLayer ä¼˜åŒ–</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// âœ… æ¨èï¼šä½¿ç”¨ graphicsLayer è¿›è¡Œå˜æ¢</span>
Box(
    modifier = Modifier
        .graphicsLayer {
            scaleX = scale
            scaleY = scale
            rotationZ = rotation
            alpha = alpha
            translationX = offsetX
            translationY = offsetY
        }
)

<span class="hljs-comment">// âŒ é¿å…ï¼šç›´æ¥ä¿®æ”¹å°ºå¯¸</span>
Box(
    modifier = Modifier
        .size(size)  <span class="hljs-comment">// è¿™ä¼šè§¦å‘é‡æ–°æµ‹é‡å’Œå¸ƒå±€</span>
)
</code></pre>
<h3 data-id="heading-37">7.3 åŠ¨ç”»è°ƒè¯•</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ä½¿ç”¨ label æ ‡è¯†åŠ¨ç”»ï¼Œä¾¿äºè°ƒè¯•</span>
<span class="hljs-keyword">val</span> alpha <span class="hljs-keyword">by</span> animateFloatAsState(
    targetValue = <span class="hljs-keyword">if</span> (visible) <span class="hljs-number">1f</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0f</span>,
    label = <span class="hljs-string">"fadeAlpha"</span>  <span class="hljs-comment">// åœ¨ Android Studio åŠ¨ç”»æ£€æŸ¥å™¨ä¸­æ˜¾ç¤º</span>
)
</code></pre>
<hr/>
<h2 data-id="heading-38">å…«ã€æœ¬ç¯‡å°ç»“</h2>
<p>ä»Šå¤©æˆ‘ä»¬æ·±å…¥æ¢è®¨äº† Compose çš„åŠ¨ç”»ä¸äº¤äº’ç³»ç»Ÿï¼š</p>
<h3 data-id="heading-39">åŠ¨ç”»ç³»ç»Ÿæ¶æ„</h3>
<ul>
<li>ç†è§£äº†é«˜å±‚ã€ä¸­å±‚ã€åº•å±‚ API çš„åˆ†å±‚è®¾è®¡</li>
<li>æŒæ¡äº† AnimationSpec å’Œ Easing çš„ä½¿ç”¨</li>
</ul>
<h3 data-id="heading-40">å±æ€§åŠ¨ç”»</h3>
<ul>
<li>æŒæ¡äº† animate*AsState ç³»åˆ—å‡½æ•°</li>
<li>ç†è§£äº† Animatable çš„åº•å±‚å®ç°</li>
</ul>
<h3 data-id="heading-41">è¿‡æ¸¡åŠ¨ç”»</h3>
<ul>
<li>æŒæ¡äº† AnimatedVisibilityã€AnimatedContentã€Crossfade</li>
<li>å­¦ä¼šäº†ç»„åˆåŠ¨ç”»æ•ˆæœ</li>
</ul>
<h3 data-id="heading-42">æ‰‹åŠ¿å¤„ç†</h3>
<ul>
<li>æŒæ¡äº†ç‚¹å‡»ã€æ‹–åŠ¨ã€æ»‘åŠ¨ã€ç¼©æ”¾æ‰‹åŠ¿</li>
<li>ç†è§£äº†åµŒå¥—æ»šåŠ¨çš„å¤„ç†</li>
</ul>
<h3 data-id="heading-43">è‡ªå®šä¹‰åŠ¨ç”»</h3>
<ul>
<li>å­¦ä¼šäº†æ— é™å¾ªç¯åŠ¨ç”»ã€å…³é”®å¸§åŠ¨ç”»</li>
<li>æŒæ¡äº†æ‰‹åŠ¿é©±åŠ¨çš„åŠ¨ç”»</li>
</ul>
<h3 data-id="heading-44">æ€§èƒ½ä¼˜åŒ–</h3>
<ul>
<li>ç†è§£äº†åŠ¨ç”»æ€§èƒ½åŸåˆ™</li>
<li>å­¦ä¼šäº†ä½¿ç”¨ graphicsLayer ä¼˜åŒ–</li>
</ul>
<hr/>
<h2 data-id="heading-45">ä¸‹ç¯‡é¢„å‘Š</h2>
<p><strong>ç¬¬å…­ç¯‡ï¼šæ¶æ„ä¸å·¥ç¨‹åŒ–</strong> å°†æ·±å…¥è®²è§£ï¼š</p>
<ul>
<li>Navigation ç»„ä»¶ä¸ Compose é›†æˆ</li>
<li>Hilt ä¾èµ–æ³¨å…¥åœ¨ Compose ä¸­çš„åº”ç”¨</li>
<li>å‰¯ä½œç”¨ API è¯¦è§£</li>
<li>Compose æ€§èƒ½ä¼˜åŒ–å®æˆ˜</li>
</ul>
<p>æ•¬è¯·æœŸå¾…ï¼</p>
<hr/>
<blockquote>
<p>ğŸ“Œ <strong>ç³»åˆ—æ–‡ç« å¯¼èˆª</strong></p>
<ul>
<li>ç¬¬ä¸€ç¯‡ï¼šåˆè¯† Compose âœ…</li>
<li>ç¬¬äºŒç¯‡ï¼šæ ¸å¿ƒåŸºçŸ³ âœ…</li>
<li>ç¬¬ä¸‰ç¯‡ï¼šçŠ¶æ€ç®¡ç† âœ…</li>
<li>ç¬¬å››ç¯‡ï¼šMaterial ç»„ä»¶ä¸ä¸»é¢˜ âœ…</li>
<li>ç¬¬äº”ç¯‡ï¼šåŠ¨ç”»ä¸äº¤äº’ï¼ˆå½“å‰ï¼‰âœ…</li>
<li>ç¬¬å…­ç¯‡ï¼šæ¶æ„ä¸å·¥ç¨‹åŒ–</li>
<li>ç¬¬ä¸ƒç¯‡ï¼šé«˜çº§ç‰¹æ€§ä¸å®æˆ˜</li>
</ul>
</blockquote>
<hr/>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ <strong>ç‚¹èµ</strong>ã€<strong>æ”¶è—</strong>ã€<strong>å…³æ³¨</strong>ï¼æœ‰ä»»ä½•é—®é¢˜å¯ä»¥åœ¨è¯„è®ºåŒºç•™è¨€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java ä»£ç æ³¨é‡Šçš„è‰ºæœ¯ï¼šæ„å»ºé«˜è´¨é‡ã€å¯è¯»æ€§ä¸æ¶æ„çº§æ–‡æ¡£çš„ç»ˆææŒ‡å—]]></title>    <link>https://juejin.cn/post/7602497125269012486</link>    <guid>https://juejin.cn/post/7602497125269012486</guid>    <pubDate>2026-02-04T03:11:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602497125269012486" data-draft-id="7602454700504776745" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java ä»£ç æ³¨é‡Šçš„è‰ºæœ¯ï¼šæ„å»ºé«˜è´¨é‡ã€å¯è¯»æ€§ä¸æ¶æ„çº§æ–‡æ¡£çš„ç»ˆææŒ‡å—"/> <meta itemprop="keywords" content="åç«¯,Java,ä»£ç è§„èŒƒ"/> <meta itemprop="datePublished" content="2026-02-04T03:11:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Shepherd"/> <meta itemprop="url" content="https://juejin.cn/user/3415500769991869"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java ä»£ç æ³¨é‡Šçš„è‰ºæœ¯ï¼šæ„å»ºé«˜è´¨é‡ã€å¯è¯»æ€§ä¸æ¶æ„çº§æ–‡æ¡£çš„ç»ˆææŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3415500769991869/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Shepherd
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T03:11:54.000Z" title="Wed Feb 04 2026 03:11:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1.æ¦‚è¿°ï¼šä»£ç å³æ–‡å­¦ï¼Œæ³¨é‡Šå³çµé­‚</h2>
<p>åœ¨ä¼ä¸šçº§ Java åç«¯å¼€å‘çš„æµ©ç€šå·¥ç¨‹ä¸­ï¼Œä»£ç è´¨é‡å¾€å¾€ä¸ä»…ä»…å–å†³äºç®—æ³•çš„å¤æ‚åº¦æˆ–æ¶æ„çš„è§£è€¦ç¨‹åº¦ï¼Œæ›´å–å†³äºå…¶å¯è¯»æ€§ä¸å¯ç»´æŠ¤æ€§ã€‚ä½œä¸ºä¸€åæ·±è€• Java æŠ€æœ¯æ ˆå¤šå¹´çš„å¼€å‘è€…ï¼Œæˆ‘ä»¬æ·±çŸ¥â€œä»£ç æ˜¯å†™ç»™äººçœ‹çš„ï¼Œé¡ºä¾¿ç»™æœºå™¨è¿è¡Œâ€è¿™ä¸€è‡³ç†åè¨€ã€‚ç„¶è€Œï¼Œåœ¨å®é™…çš„å¼€å‘è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸é™·å…¥ä¸€ä¸ªè¯¯åŒºï¼šç›²ç›®è¿½æ±‚â€œä»£ç è‡ªè§£é‡Šâ€ï¼ˆSelf-documenting Codeï¼‰ï¼Œè€Œå¿½è§†äº†é«˜è´¨é‡æ–‡æ¡£æ³¨é‡Šï¼ˆJavadocï¼‰çš„é‡è¦æ€§ã€‚äº‹å®ä¸Šï¼Œå¯¹äºå¤æ‚çš„ä¸šåŠ¡é€»è¾‘ã€å…¬å…± API æ¥å£ä»¥åŠåº•å±‚æ¡†æ¶å°è£…ï¼Œæ²¡æœ‰ä»»ä½•å˜é‡å‘½åèƒ½å¤Ÿæ›¿ä»£ä¸€æ®µç²¾å‡†ã€è¯¦å®ä¸”å¯Œæœ‰æ´å¯ŸåŠ›çš„ Javadoc</p>
<p>å½“æˆ‘ä»¬ç¿»é˜… JDK æºç ï¼ˆå¦‚ <code>java.util.concurrent</code> åŒ…ï¼‰ã€Spring Framework çš„æ ¸å¿ƒå®¹å™¨ä»£ç ï¼Œæˆ–æ˜¯ Google Guava çš„å·¥å…·ç±»æ—¶ï¼Œä¼šè¢«å…¶ä¸¥è°¨çš„æ³¨é‡Šä½“ç³»æ‰€éœ‡æ’¼ã€‚è¿™äº›æ¡†æ¶ä¹‹æ‰€ä»¥èƒ½æˆä¸ºå·¥ä¸šç•Œçš„æ ‡å‡†ï¼Œä¸ä»…å› ä¸ºå…¶ä»£ç é²æ£’ï¼Œæ›´å› ä¸ºå…¶æ–‡æ¡£è¯¦å°½åœ°é˜è¿°äº†æ¯ä¸€ä¸ªç±»ã€æ¯ä¸€ä¸ªæ–¹æ³•çš„â€œå‰ç½®æ¡ä»¶â€ï¼ˆPreconditionsï¼‰ã€â€œåç½®æ¡ä»¶â€ï¼ˆPostconditionsï¼‰ã€â€œå‰¯ä½œç”¨â€ï¼ˆSide Effectsï¼‰ä»¥åŠâ€œçº¿ç¨‹å®‰å…¨æ€§â€ï¼ˆThread Safetyï¼‰ã€‚</p>
<p>å…ˆæ¥çœ‹ä¸€ä¸ªå®Œç¾æ³¨é‡Šçš„å®Œæ•´ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * ç”¨æˆ·æœåŠ¡ç±»
 * æä¾›ç”¨æˆ·ç›¸å…³çš„ä¸šåŠ¡æ“ä½œï¼ŒåŒ…æ‹¬ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ä¿¡æ¯æŸ¥è¯¢ç­‰åŠŸèƒ½
 * 
 * <span class="hljs-doctag">@author</span> <span class="hljs-variable">ZhangSan</span>
 * <span class="hljs-doctag">@version</span> 1.2.0
 * <span class="hljs-doctag">@since</span> 2026-01-01
 * <span class="hljs-doctag">@see</span> <span class="hljs-variable">User</span>
 * <span class="hljs-doctag">@see</span> <span class="hljs-variable">UserDao</span>
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
 Â  Â 
 Â  Â <span class="hljs-comment">/**
 Â  Â  * ç”¨æˆ·æ³¨å†Œ
 Â  Â  * è¯¥æ–¹æ³•ç”¨äºæ–°ç”¨æˆ·æ³¨å†Œï¼Œä¼šå¯¹ç”¨æˆ·åè¿›è¡Œå”¯ä¸€æ€§æ ¡éªŒ
 Â  Â  *
 Â  Â  * <span class="hljs-doctag">@param</span> username ç”¨æˆ·åï¼Œå¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œé•¿åº¦3-20å­—ç¬¦
 Â  Â  * <span class="hljs-doctag">@param</span> password å¯†ç ï¼Œéœ€è¦æ»¡è¶³å¯†ç å¼ºåº¦è¦æ±‚
 Â  Â  * <span class="hljs-doctag">@param</span> email é‚®ç®±åœ°å€ï¼Œç”¨äºéªŒè¯å’Œé€šçŸ¥
 Â  Â  * <span class="hljs-doctag">@return</span> æ³¨å†ŒæˆåŠŸçš„ç”¨æˆ·IDï¼Œå¦‚æœæ³¨å†Œå¤±è´¥è¿”å›null
 Â  Â  * <span class="hljs-doctag">@throws</span> UserExistsException å½“ç”¨æˆ·åå·²å­˜åœ¨æ—¶æŠ›å‡º
 Â  Â  * <span class="hljs-doctag">@throws</span> InvalidParameterException å½“å‚æ•°ä¸ç¬¦åˆè¦æ±‚æ—¶æŠ›å‡º
 Â  Â  * <span class="hljs-doctag">@see</span> <span class="hljs-variable">User</span>
 Â  Â  * <span class="hljs-doctag">@since</span> 1.0.0
 Â  Â  */</span>
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-title class_">Long</span> <span class="hljs-title function_">registerUser</span>(<span class="hljs-title class_">String</span> username, <span class="hljs-title class_">String</span> password, <span class="hljs-title class_">String</span> email) 
 Â  Â  Â  Â  Â  Â throws <span class="hljs-title class_">UserExistsException</span>, <span class="hljs-title class_">InvalidParameterException</span> {
 Â  Â  Â  Â <span class="hljs-comment">// æ–¹æ³•å®ç°</span>
 Â  Â  Â  Â <span class="hljs-keyword">return</span> 1L;
 Â   }
 Â  Â 
 Â  Â <span class="hljs-comment">/**
 Â  Â  * <span class="hljs-doctag">@deprecated</span> è¯¥æ–¹æ³•å·²è¿‡æ—¶ï¼Œè¯·ä½¿ç”¨ {<span class="hljs-doctag">@link</span> #registerUser(String, String, String)}
 Â  Â  * æ›¿ä»£ã€‚æ–°æ–¹æ³•æä¾›äº†æ›´å®Œå–„çš„å‚æ•°æ ¡éªŒã€‚
 Â  Â  */</span>
 Â  Â <span class="hljs-meta">@Deprecated</span>
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-title class_">Long</span> <span class="hljs-title function_">register</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> username, <span class="hljs-built_in">String</span> password</span>) {
 Â  Â  Â  Â <span class="hljs-comment">// æ—§æ–¹æ³•å®ç°</span>
 Â  Â  Â  Â <span class="hljs-keyword">return</span> 1L;
 Â   }
}
</code></pre>
<h2 data-id="heading-1">2.å¸¸ç”¨Javadocæ ‡ç­¾è¯¦è§£</h2>
<p><strong>@param å‚æ•°è¯´æ˜</strong></p>
<pre><code class="hljs language-typescript" lang="typescript">â€‹
<span class="hljs-comment">/**
 * å¤„ç†ç”¨æˆ·åˆ—è¡¨
 * 
 * <span class="hljs-doctag">@param</span> users ç”¨æˆ·åˆ—è¡¨ï¼Œä¸èƒ½ä¸ºnullä½†å¯ä»¥ä¸ºç©ºåˆ—è¡¨
 * <span class="hljs-doctag">@param</span> options å¤„ç†é€‰é¡¹ï¼ŒåŒ…å«æ’åºã€è¿‡æ»¤ç­‰è®¾ç½®
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">processUsers</span>(<span class="hljs-params">List&lt;User&gt; users, ProcessOptions options</span>) {
 Â  Â <span class="hljs-comment">// æ–¹æ³•å®ç°</span>
}
</code></pre>
<p><strong>@return è¿”å›å€¼è¯´æ˜</strong></p>
<pre><code class="hljs language-csharp" lang="csharp">â€‹
<span class="hljs-comment">/**
 * è·å–æ‰€æœ‰æ´»è·ƒç”¨æˆ·
 * 
 * @return æ´»è·ƒç”¨æˆ·åˆ—è¡¨ï¼Œä¸ä¼šè¿”å›nullï¼Œä½†å¯èƒ½è¿”å›ç©ºåˆ—è¡¨
 */</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title">getActiveUsers</span>()</span> {
 Â  Â <span class="hljs-keyword">return</span> userDAO.findByStatus(<span class="hljs-string">"active"</span>);
}
â€‹
</code></pre>
<p><strong>@throws / @exception å¼‚å¸¸è¯´æ˜</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * æ–‡ä»¶ä¸Šä¼ å¤„ç†
 * 
 * <span class="hljs-doctag">@param</span> file ä¸Šä¼ çš„æ–‡ä»¶
 * <span class="hljs-doctag">@throws</span> FileNotFoundException å½“æ–‡ä»¶ä¸å­˜åœ¨æ—¶æŠ›å‡º
 * <span class="hljs-doctag">@throws</span> FileSizeExceededException å½“æ–‡ä»¶å¤§å°è¶…è¿‡é™åˆ¶æ—¶æŠ›å‡º
 * <span class="hljs-doctag">@throws</span> IOException å½“æ–‡ä»¶è¯»å†™å‘ç”Ÿé”™è¯¯æ—¶æŠ›å‡º
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">uploadFile</span><span class="hljs-params">(File file)</span> <span class="hljs-keyword">throws</span> FileNotFoundException, 
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â FileSizeExceededException, 
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â IOException {
 Â  Â <span class="hljs-keyword">if</span> (!file.exists()) {
 Â  Â  Â  Â <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileNotFoundException</span>(<span class="hljs-string">"æ–‡ä»¶ä¸å­˜åœ¨: "</span> + file.getName());
 Â   }
 Â  Â <span class="hljs-comment">// å…¶ä»–å¤„ç†é€»è¾‘</span>
}
â€‹
<span class="hljs-comment">/**
 * ç”¨æˆ·ç™»å½•éªŒè¯
 * 
 * <span class="hljs-doctag">@param</span> username ç”¨æˆ·å
 * <span class="hljs-doctag">@param</span> password å¯†ç 
 * <span class="hljs-doctag">@exception</span> AuthenticationException å½“ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯æ—¶æŠ›å‡º
 * <span class="hljs-doctag">@exception</span> AccountLockedException å½“è´¦æˆ·è¢«é”å®šæ—¶æŠ›å‡º
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">login</span><span class="hljs-params">(String username, String password)</span> 
 Â  Â  Â  Â <span class="hljs-keyword">throws</span> AuthenticationException, AccountLockedException {
 Â  Â <span class="hljs-comment">// ç™»å½•é€»è¾‘</span>
}
</code></pre>
<p><strong>@see å‚è€ƒé“¾æ¥</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * è®¢å•æ”¯ä»˜æœåŠ¡
 * 
 * <span class="hljs-doctag">@see</span> Order è®¢å•å®ä½“ç±»
 * <span class="hljs-doctag">@see</span> PaymentController#processPayment(Long) æ”¯ä»˜å¤„ç†æ–¹æ³•
 * <span class="hljs-doctag">@see</span> &lt;a href="https://example.com/payment-api"&gt;æ”¯ä»˜APIæ–‡æ¡£&lt;/a&gt;
 * <span class="hljs-doctag">@see</span> "Javaç¼–ç¨‹è§„èŒƒ"
 * <span class="hljs-doctag">@see</span> #refund(Long) é€€æ¬¾æ–¹æ³•
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PaymentService</span> {
 Â  Â 
 Â  Â <span class="hljs-comment">/**
 Â  Â  * æ‰§è¡Œæ”¯ä»˜
 Â  Â  * <span class="hljs-doctag">@see</span> PaymentGateway æ”¯ä»˜ç½‘å…³æ¥å£
 Â  Â  */</span>
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">processPayment</span>(<span class="hljs-params">Order order</span>) {
 Â  Â  Â  Â <span class="hljs-comment">// æ”¯ä»˜é€»è¾‘</span>
 Â   }
 Â  Â 
 Â  Â <span class="hljs-comment">/**
 Â  Â  * è®¢å•é€€æ¬¾
 Â  Â  * 
 Â  Â  * <span class="hljs-doctag">@see</span> #processPayment(Order)
 Â  Â  */</span>
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">refund</span>(<span class="hljs-params">Long orderId</span>) {
 Â  Â  Â  Â <span class="hljs-comment">// é€€æ¬¾é€»è¾‘</span>
 Â   }
}
</code></pre>
<p><strong>@deprecated è¿‡æ—¶è¯´æ˜</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OldClass</span> {
 Â  Â 
 Â  Â <span class="hljs-comment">/**
 Â  Â  * <span class="hljs-doctag">@deprecated</span> è¿™ä¸ªå­—æ®µå·²è¿‡æ—¶ï¼Œè¯·ä½¿ç”¨ {<span class="hljs-doctag">@link</span> #newField} æ›¿ä»£ã€‚
 Â  Â  * å°†åœ¨ä¸‹ä¸€ä¸ªä¸»è¦ç‰ˆæœ¬ä¸­ç§»é™¤ã€‚
 Â  Â  */</span>
 Â  Â <span class="hljs-meta">@Deprecated</span>
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> oldField;
 Â  Â 
 Â  Â <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> newField;
 Â  Â 
 Â  Â <span class="hljs-comment">/**
 Â  Â  * <span class="hljs-doctag">@deprecated</span> è¿™ä¸ªæ–¹æ³•å·²è¿‡æ—¶ï¼Œå› ä¸ºæ€§èƒ½é—®é¢˜ã€‚
 Â  Â  * è¯·ä½¿ç”¨ {<span class="hljs-doctag">@link</span> #newMethod(String)} æ›¿ä»£ã€‚
 Â  Â  * 
 Â  Â  * <span class="hljs-doctag">@param</span> name ç”¨æˆ·å
 Â  Â  * <span class="hljs-doctag">@return</span> å¤„ç†ç»“æœ
 Â  Â  */</span>
 Â  Â <span class="hljs-meta">@Deprecated</span>(since = <span class="hljs-string">"2.0"</span>, forRemoval = <span class="hljs-literal">true</span>)
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">oldMethod</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> name</span>) {
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">"old result"</span>;
 Â   }
 Â  Â 
 Â  Â <span class="hljs-comment">/**
 Â  Â  * æ–°çš„å¤„ç†æ–¹æ³•
 Â  Â  */</span>
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">newMethod</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> name</span>) {
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">"new result"</span>;
 Â   }
}
</code></pre>
<p><strong>{@code} - ä»£ç æ ¼å¼</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * è®¾ç½®é…ç½®é¡¹
 * 
 * ä½¿ç”¨æ–¹æ³•ï¼š
 * {<span class="hljs-doctag">@code</span>
 * Config config = new Config();
 * config.setProperty("key", "value");
 * }
 * 
 * æˆ–è€…å•è¡Œä»£ç ï¼š{<span class="hljs-doctag">@code</span> String name = "John";}
 * 
 * <span class="hljs-doctag">@param</span> key é…ç½®é”®ï¼Œæ ¼å¼ä¸º {<span class="hljs-doctag">@code</span> "section.name"}
 * <span class="hljs-doctag">@param</span> value é…ç½®å€¼
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setProperty</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> key, <span class="hljs-built_in">String</span> value</span>) {
 Â  Â <span class="hljs-comment">// æ–¹æ³•å®ç°</span>
}
</code></pre>
<h3 data-id="heading-2">{@link} - å†…éƒ¨é“¾æ¥</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * ç”¨æˆ·ç®¡ç†æœåŠ¡
 * 
 * ç›¸å…³æ–¹æ³•ï¼š
 * - {<span class="hljs-doctag">@link</span> #createUser(User)}
 * - {<span class="hljs-doctag">@link</span> #updateUser(User)}
 * - {<span class="hljs-doctag">@link</span> #deleteUser(Long)}
 * 
 * ç›¸å…³ç±»ï¼š
 * - {<span class="hljs-doctag">@link</span> User}
 * - {<span class="hljs-doctag">@link</span> UserDao}
 * 
 * <span class="hljs-doctag">@see</span> UserService
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserManager</span> {
 Â  Â 
 Â  Â <span class="hljs-comment">/**
 Â  Â  * åˆ›å»ºç”¨æˆ·
 Â  Â  * 
 Â  Â  * <span class="hljs-doctag">@param</span> user ç”¨æˆ·å¯¹è±¡ï¼Œå‚è€ƒ {<span class="hljs-doctag">@link</span> User} ç±»å®šä¹‰
 Â  Â  * <span class="hljs-doctag">@return</span> ç”¨æˆ·ID
 Â  Â  * <span class="hljs-doctag">@see</span> #updateUser(User)
 Â  Â  */</span>
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-built_in">Long</span> createUser(User user) {
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-number">1L</span>;
 Â   }
}
</code></pre>
<p><strong>{@literal} - æ–‡æœ¬å­—é¢é‡</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">/**
 * ç‰¹æ®Šå­—ç¬¦è¯´æ˜
 * 
 * åœ¨XMLä¸­éœ€è¦ä½¿ç”¨ {<span class="hljs-doctag">@literal</span> &lt;root&gt;} å’Œ {<span class="hljs-doctag">@literal</span> &lt;/root&gt;} æ ‡ç­¾ã€‚
 * åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ä½¿ç”¨ {<span class="hljs-doctag">@literal</span> [a-z]+} åŒ¹é…å°å†™å­—æ¯ã€‚
 * 
 * æ¯”è¾ƒæ“ä½œï¼š{<span class="hljs-doctag">@literal</span> a &lt; b &amp;&amp; c &gt; d}
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpecialCharacters</span> {
    <span class="hljs-comment">// ç±»å®ç°</span>
}
</code></pre>
<h2 data-id="heading-3">3.Javaæ³¨é‡Šä¸­çš„HTMLæ ‡ç­¾è¯¦è§£</h2>
<p><strong><code>&lt;p&gt;</code> - æ®µè½æ ‡ç­¾</strong></p>
<pre><code class="hljs language-xml" lang="xml">/**
 * ç”¨æˆ·æœåŠ¡ç±»
 * 
 * <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è¿™ä¸ªç±»è´Ÿè´£å¤„ç†ç”¨æˆ·ç›¸å…³çš„æ‰€æœ‰ä¸šåŠ¡é€»è¾‘ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 * 
 * <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>åŒ…æ‹¬ç”¨æˆ·æ³¨å†Œã€ç™»å½•éªŒè¯ã€ä¿¡æ¯ä¿®æ”¹ç­‰åŠŸèƒ½ã€‚
 * æ¯ä¸ªåŠŸèƒ½éƒ½ç»è¿‡ä¸¥æ ¼æµ‹è¯•ï¼Œç¡®ä¿ä¸šåŠ¡é€»è¾‘çš„æ­£ç¡®æ€§ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 * 
 * <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>åœ¨ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œå»ºè®®é…åˆSpringå®¹å™¨ä½¿ç”¨ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 */
public class UserService {
    // åœ¨Javadocä¸­ï¼Œ<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ ‡ç­¾ä¼šè‡ªåŠ¨åœ¨æ®µè½é—´åˆ›å»ºç©ºè¡Œï¼Œä½¿æ–‡æ¡£æ›´æ˜“è¯»
}
</code></pre>
<p><strong><code>&lt;br&gt;</code> - æ¢è¡Œæ ‡ç­¾</strong></p>
<pre><code class="hljs language-xml" lang="xml">/**
 * åœ°å€éªŒè¯å·¥å…·
 * 
 * <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>éªŒè¯è§„åˆ™ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
 * 1. åœ°å€ä¸èƒ½ä¸ºç©º<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
 * 2. åœ°å€é•¿åº¦ä¸è¶…è¿‡200å­—ç¬¦<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
 * 3. å¿…é¡»åŒ…å«çœå¸‚åŒºä¿¡æ¯<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
 * 4. è¯¦ç»†åœ°å€ä¸èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 * 
 * <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ³¨æ„ï¼šæ­¤éªŒè¯ä»…é’ˆå¯¹ä¸­å›½å¤§é™†åœ°å€ï¼Œ<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
 * å›½é™…åœ°å€éœ€è¦ä½¿ç”¨å…¶ä»–éªŒè¯è§„åˆ™ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 */
public class AddressValidator {
    // <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>é€‚åˆåœ¨åŒä¸€ä¸ªæ®µè½å†…åˆ›å»ºåˆ—è¡¨å¼å†…å®¹
}
</code></pre>
<p><strong><code>&lt;b&gt;</code> å’Œ <code>&lt;strong&gt;</code> - ç²—ä½“æ ‡ç­¾</strong></p>
<p><strong>ç”¨é€”</strong>ï¼šå¼ºè°ƒé‡è¦æ–‡æœ¬</p>
<pre><code class="hljs language-xml" lang="xml">/**
 * æ”¯ä»˜å®‰å…¨æœåŠ¡
 * 
 * <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>é‡è¦æç¤ºï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span>æ‰€æœ‰æ”¯ä»˜æ“ä½œéƒ½å¿…é¡»è®°å½•å®¡è®¡æ—¥å¿—ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 * 
 * <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>å®‰å…¨è­¦å‘Šï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>APIå¯†é’¥å¿…é¡»åŠ å¯†å­˜å‚¨ï¼Œ<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
 * ä¸¥ç¦åœ¨æ—¥å¿—ä¸­è¾“å‡ºæ•æ„Ÿä¿¡æ¯ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 * 
 * <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ™®é€šæ–‡æœ¬ï¼Œ<span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>å…³é”®æ“ä½œ<span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span>éœ€è¦åŒé‡éªŒè¯ï¼Œ<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
 * <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>é«˜é£é™©æ“ä½œ<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>éœ€è¦ç®¡ç†å‘˜å®¡æ‰¹ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 */
public class PaymentSecurityService {
    // <span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>å’Œ<span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>åœ¨è§†è§‰ä¸Šæ•ˆæœç›¸åŒï¼Œä½†<span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>è¯­ä¹‰ä¸Šæ›´å¼ºè°ƒé‡è¦æ€§
}
</code></pre>
<p><strong><code>&lt;i&gt;</code> å’Œ <code>&lt;em&gt;</code> - æ–œä½“æ ‡ç­¾</strong></p>
<p><strong>ç”¨é€”</strong>ï¼šè¡¨ç¤ºæŠ€æœ¯æœ¯è¯­ã€å¤–æ¥è¯­æˆ–å¼ºè°ƒ</p>
<pre><code class="hljs language-xml" lang="xml">/**
 * ç§‘å­¦è®¡ç®—å·¥å…·
 * 
 * <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æœ¬ç±»æä¾›å¸¸ç”¨çš„ç§‘å­¦è®¡ç®—åŠŸèƒ½ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 * 
 * <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">i</span>&gt;</span>æ¬§æ‹‰å…¬å¼<span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span>ï¼še^(iÏ€) + 1 = 0<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
 * <span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å‹¾è‚¡å®šç†<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>ï¼šaÂ² + bÂ² = cÂ²<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 * 
 * <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æ³¨æ„ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">i</span>&gt;</span>æµ®ç‚¹æ•°è®¡ç®—<span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span>å¯èƒ½å­˜åœ¨ç²¾åº¦é—®é¢˜ï¼Œ<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
 * <span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>å¤§è§„æ¨¡çŸ©é˜µè¿ç®—<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>å»ºè®®ä½¿ç”¨ä¸“ä¸šæ•°å­¦åº“ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 */
public class MathUtils {
    // <span class="hljs-tag">&lt;<span class="hljs-name">i</span>&gt;</span>é€šå¸¸ç”¨äºæŠ€æœ¯æœ¯è¯­ï¼Œ<span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>ç”¨äºè¯­ä¹‰å¼ºè°ƒ
}
</code></pre>
<p><strong><code>&lt;ul&gt;</code> - æ— åºåˆ—è¡¨</strong></p>
<p><strong>ç”¨é€”</strong>ï¼šåˆ›å»ºé¡¹ç›®ç¬¦å·åˆ—è¡¨</p>
<pre><code class="hljs language-xml" lang="xml">/**
 * åŠŸèƒ½ç‰¹æ€§è¯´æ˜
 * 
 * <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>ä¸»è¦åŠŸèƒ½ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 * <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
 *   <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>ç”¨æˆ·è®¤è¯å’Œæˆæƒ<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *   <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>æ•°æ®åŠ å¯†å­˜å‚¨
 *     <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
 *       <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>AES-256åŠ å¯†æ•æ„Ÿæ•°æ®<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *       <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>RSAåŠ å¯†ä¼ è¾“æ•°æ®<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *     <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
 *   <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *   <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å®¡è®¡æ—¥å¿—è®°å½•<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *   <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>æ€§èƒ½ç›‘æ§å’Œç»Ÿè®¡<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 * <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
 * 
 * <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>æŠ€æœ¯ç‰¹ç‚¹ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 * <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
 *   <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>åŸºäºSpring Bootæ¡†æ¶<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *   <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>æ”¯æŒå¤šæ•°æ®æº<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *   <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å†…ç½®ç¼“å­˜æœºåˆ¶<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 * <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
 */
public class SystemFeatures {
    // <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>åˆ›å»ºå¸¦é¡¹ç›®ç¬¦å·çš„åˆ—è¡¨ï¼Œé€‚åˆåˆ—ä¸¾ç‰¹æ€§ã€åŠŸèƒ½ç‚¹ç­‰
}
</code></pre>
<p><strong><code>&lt;ol&gt;</code> - æœ‰åºåˆ—è¡¨</strong></p>
<p><strong>ç”¨é€”</strong>ï¼šåˆ›å»ºå¸¦ç¼–å·çš„æ­¥éª¤åˆ—è¡¨</p>
<pre><code class="hljs language-xml" lang="xml">/**
 * å®‰è£…é…ç½®æŒ‡å—
 * 
 * <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>å®‰è£…æ­¥éª¤ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 * <span class="hljs-tag">&lt;<span class="hljs-name">ol</span>&gt;</span>
 *   <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>ä¸‹è½½å®‰è£…åŒ…<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *   <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>è§£å‹åˆ°ç›®æ ‡ç›®å½•<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *   <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>ä¿®æ”¹é…ç½®æ–‡ä»¶
 *     <span class="hljs-tag">&lt;<span class="hljs-name">ol</span>&gt;</span>
 *       <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>é…ç½®æ•°æ®åº“è¿æ¥<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *       <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>è®¾ç½®ç®¡ç†å‘˜è´¦å·<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *       <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>é…ç½®æ—¥å¿—è·¯å¾„<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *     <span class="hljs-tag">&lt;/<span class="hljs-name">ol</span>&gt;</span>
 *   <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *   <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å¯åŠ¨æœåŠ¡<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *   <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>éªŒè¯å®‰è£…ç»“æœ<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 * <span class="hljs-tag">&lt;/<span class="hljs-name">ol</span>&gt;</span>
 * 
 * <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>å¯åŠ¨é¡ºåºï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
 * <span class="hljs-tag">&lt;<span class="hljs-name">ol</span>&gt;</span>
 *   <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>æ•°æ®åº“æœåŠ¡<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *   <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>ç¼“å­˜æœåŠ¡<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *   <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>åº”ç”¨æœåŠ¡<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 *   <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>ç›‘æ§æœåŠ¡<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
 * <span class="hljs-tag">&lt;/<span class="hljs-name">ol</span>&gt;</span>
 */
public class InstallationGuide {
    // <span class="hljs-tag">&lt;<span class="hljs-name">ol</span>&gt;</span>åˆ›å»ºå¸¦æ•°å­—ç¼–å·çš„åˆ—è¡¨ï¼Œé€‚åˆæ­¥éª¤ã€æµç¨‹è¯´æ˜
}
</code></pre>
<h2 data-id="heading-4">4.æ€»ç»“</h2>
<p>ç¼–å†™æ–‡æ¡£æ³¨é‡Šå¹¶éå•çº¯çš„ä½“åŠ›åŠ³åŠ¨ï¼Œå®ƒæ˜¯ä¸€ç§è®¾è®¡æ´»åŠ¨ã€‚å½“ä½ è¢«è¿«ç”¨è‡ªç„¶è¯­è¨€æ¸…æ™°åœ°æè¿°ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œå¾€å¾€ä¼šå‘ç°ä»£ç é€»è¾‘æœ¬èº«çš„æ¨¡ç³Šæˆ–è®¾è®¡ä¸Šçš„ç¼ºé™·ã€‚é«˜è´¨é‡çš„ Javadoc æ˜¯ä»£ç é‡æ„çš„å‚¬åŒ–å‰‚ã€‚</p>
<p>ä½œä¸º Java åç«¯é«˜çº§å¼€å‘ï¼Œå½“æˆ‘ä»¬ä»å•çº¯å…³æ³¨â€œä»£ç æ€ä¹ˆè·‘â€è½¬å˜ä¸ºå…³æ³¨â€œä»£ç æ€ä¹ˆè¯»â€æ—¶ï¼Œæˆ‘ä»¬å°±è·¨è¶Šäº†ä»å·¥åŒ åˆ°å¤§å¸ˆçš„é—¨æ§›ã€‚å¸Œæœ›è¿™ç¯‡åšæ–‡èƒ½æˆä¸ºä½ å›¢é˜Ÿä¸­çš„â€œæ–‡æ¡£åœ£ç»â€ï¼Œä¸ä»…æå‡ä»£ç åº“çš„å¥åº·åº¦ï¼Œæ›´åœ¨æŠ€æœ¯ç¤¾åŒºä¸­æ ‘ç«‹ä½ ä½œä¸º uncompromising engineerï¼ˆä¸å¦¥åçš„å·¥ç¨‹å¸ˆï¼‰çš„ä¸“ä¸šå½¢è±¡ã€‚è®©æˆ‘ä»¬ä¸€èµ·ï¼Œç”¨æ³¨é‡Šç‚¹äº®ä»£ç çš„é»‘æš—è§’è½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ··ç”¨ @Transactional å’Œ TransactionTemplate è¢«æ€¼äº†ï¼Œä¸‰ç§äº‹åŠ¡ç®¡ç†åˆ°åº•æ€ä¹ˆé€‰ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7602531501457621001</link>    <guid>https://juejin.cn/post/7602531501457621001</guid>    <pubDate>2026-02-04T07:34:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602531501457621001" data-draft-id="7602901565032333358" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ··ç”¨ @Transactional å’Œ TransactionTemplate è¢«æ€¼äº†ï¼Œä¸‰ç§äº‹åŠ¡ç®¡ç†åˆ°åº•æ€ä¹ˆé€‰ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-04T07:34:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¥å¥‡å°æ±¤åœ†"/> <meta itemprop="url" content="https://juejin.cn/user/1151943919285431"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ··ç”¨ @Transactional å’Œ TransactionTemplate è¢«æ€¼äº†ï¼Œä¸‰ç§äº‹åŠ¡ç®¡ç†åˆ°åº•æ€ä¹ˆé€‰ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1151943919285431/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¥å¥‡å°æ±¤åœ†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T07:34:19.000Z" title="Wed Feb 04 2026 07:34:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å¼•è¨€</h3>
<p>â€œåªè¦ä½ ä¸è€ƒè™‘äº‹åŠ¡çš„é—®é¢˜ï¼Œæ€»æœ‰ä¸€å¤©äº‹åŠ¡ä¼šæ¥è€ƒè™‘ä½ ã€‚â€</p>
<p>å¿˜è®°æ˜¯å“ªä½å“²äººè¯´çš„è¿™å¥è¯äº†ï¼Œåœ¨æœ€è¿‘çš„ä¸€æ¬¡code reviewä¸­ï¼Œæˆ‘é€æ¸ä½“ä¼šåˆ°äº†è¿™å¥è¯çš„åˆ†é‡ã€‚</p>
<p>å½“æˆ‘çœ‹åˆ°åŒäº‹åœ¨ä¸€ä¸ªå¤æ‚çš„ä¸šåŠ¡é€»è¾‘ä¸­æ··ç”¨äº†<code>@Transactional</code>æ³¨è§£å’Œ<code>TransactionTemplate</code>æ—¶ï¼Œå°±é¢„æ„Ÿåˆ°å¯èƒ½ä¼šæœ‰é—®é¢˜ã€‚</p>
<p>æˆ‘é—®ä»–ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Œä»–çš„å›ç­”è®©æˆ‘æœ‰äº›æ„å¤–ï¼š"åæ­£éƒ½èƒ½å®ç°äº‹åŠ¡ï¼Œåº”è¯¥æ²¡ä»€ä¹ˆåŒºåˆ«å§ï¼Ÿ"</p>
<p>è¿™ä¸ªå›ç­”è®©æˆ‘æ„è¯†åˆ°ï¼Œå¾ˆå¤šå¼€å‘è€…å¯¹Springçš„äº‹åŠ¡ç®¡ç†æœºåˆ¶å…¶å®ç†è§£å¾—å¹¶ä¸æ·±å…¥ã€‚å¤§å®¶å¾€å¾€çŸ¥é“åŠ ä¸ª<code>@Transactional</code>å°±èƒ½å¼€å¯äº‹åŠ¡ï¼Œä½†å¯¹äºä»€ä¹ˆæ—¶å€™è¯¥ç”¨å£°æ˜å¼ã€ä»€ä¹ˆæ—¶å€™è¯¥ç”¨ç¼–ç¨‹å¼ï¼Œä»¥åŠå®ƒä»¬èƒŒåçš„å·¥ä½œåŸç†ï¼Œå´å¾ˆå°‘æ·±ç©¶ã€‚</p>
<p>äº‹åŠ¡ç®¡ç†çœ‹ä¼¼ç®€å•ï¼Œå®åˆ™æš—è—ç„æœºã€‚</p>
<p>ä»Šå¤©æˆ‘ä»¬å°±æ¥æ·±å…¥èŠèŠSpringä¸­çš„ä¸‰ç§äº‹åŠ¡ç®¡ç†æ–¹å¼ï¼Œä»¥åŠå®ƒä»¬å„è‡ªçš„é€‚ç”¨åœºæ™¯å’Œæ½œåœ¨çš„é£é™©ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d964424c74b45938a57897c2554b256~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56We5aWH5bCP5rGk5ZyG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770795260&amp;x-signature=seLeQjuDQreb1FaVcLBrPus82qg%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-1">æ­£æ–‡</h3>
<h4 data-id="heading-2">ä¸‰ç§æ–¹å¼ï¼Œå„æœ‰åƒç§‹</h4>
<p>Springç»™æˆ‘ä»¬æä¾›äº†ä¸‰ç§å¤„ç†äº‹åŠ¡çš„æ–¹å¼ï¼š<code>@Transactional</code>æ³¨è§£ã€<code>TransactionTemplate</code>å’Œç›´æ¥ä½¿ç”¨<code>TransactionManager</code>ã€‚</p>
<p>å°±åƒæ­¦ä¾ å°è¯´é‡Œçš„ä¸‰ç§å…µå™¨ï¼Œæ¯ç§éƒ½æœ‰è‡ªå·±çš„æ‹›å¼å’Œé€‚ç”¨åœºæ™¯ã€‚</p>
<h5 data-id="heading-3">@Transactionalï¼šæœ€çœå¿ƒçš„</h5>
<p>æåˆ°äº‹åŠ¡ç®¡ç†ï¼ŒåŸºæœ¬ä¸Šéƒ½ä¼šæƒ³åˆ°å»ç”¨<code>@Transactional</code>ã€‚</p>
<p>ç¡®å®ï¼Œè¿™ç©æ„å„¿ç”¨èµ·æ¥ç®€å•ç²—æš´ï¼Œåœ¨æ–¹æ³•ä¸ŠåŠ ä¸€ä¸ªæ³¨è§£å°±å®Œäº‹äº†ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">UserService</span>Â {
Â  Â Â 
Â  Â Â <span class="hljs-meta">@Transactional</span>
Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">createUser</span>(<span class="hljs-params">User user</span>)Â {
Â  Â  Â  Â  userRepository.<span class="hljs-title function_">save</span>(user);
Â  Â  Â  Â Â <span class="hljs-comment">// å¦‚æœè¿™é‡ŒæŠ›å¼‚å¸¸ï¼Œä¸Šé¢çš„æ“ä½œä¼šå›æ»š</span>
Â  Â  Â  Â  <span class="hljs-title function_">sendWelcomeEmail</span>(user);
Â  Â  }
}
</code></pre>
<p>æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯<strong>æ— ä¾µå…¥</strong>ã€‚</p>
<p>ä¸šåŠ¡ä»£ç ä¾ç„¶å¹²å‡€ï¼Œäº‹åŠ¡é€»è¾‘å®Œå…¨äº¤ç»™Springåœ¨èƒŒåæå®šäº†ã€‚ä½†æ˜¯ï¼Œè¿™ç§é»‘ç›’å¼çš„ä¾¿åˆ©å¿…ç„¶æœ‰ä»£ä»·ã€‚</p>
<p>Springé€šè¿‡AOPæ¥å®ç°å£°æ˜å¼äº‹åŠ¡ï¼Œç»™æ–¹æ³•å¤–é¢åŒ…äº†ä¸€å±‚ä»£ç†ï¼Œè¿™å°±ä¼šå¯¼è‡´ä¸€äº›è®©äººå¤´ç–¼çš„é—®é¢˜ï¼š</p>
<p><strong>å†…éƒ¨æ–¹æ³•è°ƒç”¨å¤±æ•ˆ</strong>ï¼šè¿™æ˜¯æœ€å®¹æ˜“è¸©çš„å‘ï¼å½“åŒä¸€ä¸ªç±»å†…éƒ¨çš„æ–¹æ³•è°ƒç”¨å¸¦æœ‰<code>@Transactional</code>æ³¨è§£çš„æ–¹æ³•æ—¶ï¼Œäº‹åŠ¡ä¸ä¼šç”Ÿæ•ˆã€‚å› ä¸ºå†…éƒ¨è°ƒç”¨ä¸ä¼šèµ°ä»£ç†ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Service</span>Â Â 
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">UserService</span>Â {
Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">batchCreate</span>(<span class="hljs-params">List&lt;User&gt; users</span>)Â {
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-title class_">User</span> user : users) {
Â  Â  Â  Â  Â  Â  <span class="hljs-title function_">createUser</span>(user);Â <span class="hljs-comment">// âŒ è¿™é‡Œäº‹åŠ¡ä¸ä¼šç”Ÿæ•ˆï¼</span>
Â  Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â Â <span class="hljs-meta">@Transactional</span>
Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">createUser</span>(<span class="hljs-params">User user</span>)Â {
Â  Â  Â  Â  userRepository.<span class="hljs-title function_">save</span>(user);
Â  Â  }
}
</code></pre>
<p><strong>åªå¯¹publicæ–¹æ³•ç”Ÿæ•ˆ</strong>ï¼šç§æœ‰æ–¹æ³•æˆ–è€…protectedæ–¹æ³•ä¸ŠåŠ <code>@Transactional</code>æ¯«æ— åµç”¨ã€‚</p>
<p><strong>è¦åŒ¹é…å¼‚å¸¸ç±»å‹</strong>ï¼šé»˜è®¤åªæœ‰<code>RuntimeException</code>å’Œ<code>Error</code>ä¼šè§¦å‘å›æ»šï¼Œæ£€æŸ¥å‹å¼‚å¸¸éœ€è¦ç‰¹æ®Šé…ç½®ã€‚</p>
<p>å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š</p>
<p><a href="https://juejin.cn/post/7496344493709885455" target="_blank" title="https://juejin.cn/post/7496344493709885455">juejin.cn/post/749634â€¦</a></p>
<p>è™½ç„¶è¿™äº›éƒ½æ˜¯è€ç”Ÿå¸¸è°ˆçš„é—®é¢˜äº†ï¼Œä½†åœ¨å®é™…å¼€å‘ä¸­ï¼Œè¿˜æ˜¯æœ‰å¤ªå¤šå› ä¸ºè¿™ç§ç»†èŠ‚å‡ºbugçš„æƒ…å†µã€‚</p>
<h5 data-id="heading-4">TransactionTemplateï¼šå¯æ§çš„</h5>
<p><code>TransactionTemplate</code>ç®—æ˜¯å£°æ˜å¼å’Œç¼–ç¨‹å¼äº‹åŠ¡çš„ä¸€ä¸ªå¹³è¡¡ç‚¹ã€‚å®ƒæ—¢ä¿æŒäº†ä¸€å®šçš„çµæ´»æ€§ï¼Œåˆä¸ä¼šè®©ä»£ç å˜å¾—è¿‡äºå¤æ‚ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span><span class="hljs-keyword">class</span>Â <span class="hljs-title class_">AccountService</span>Â {
Â  Â Â 
Â  Â Â <span class="hljs-meta">@Autowired</span>
Â  Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">TransactionTemplate</span> transactionTemplate;
Â  Â Â 
Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">transfer</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> fromAccount, <span class="hljs-built_in">String</span> toAccount, BigDecimal amount</span>)Â {
Â  Â  Â  Â  transactionTemplate.<span class="hljs-title function_">execute</span>(status -&gt; {
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">try</span>Â {
Â  Â  Â  Â  Â  Â  Â  Â  accountRepository.<span class="hljs-title function_">debit</span>(fromAccount, amount);
Â  Â  Â  Â  Â  Â  Â  Â  accountRepository.<span class="hljs-title function_">credit</span>(toAccount, amount);
Â  Â  Â  Â  Â  Â  Â  Â Â returnnull;
Â  Â  Â  Â  Â  Â  }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">InsufficientFundsException</span> e) {
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-comment">// å¯ä»¥æ ¹æ®ä¸šåŠ¡é€»è¾‘å†³å®šæ˜¯å¦å›æ»š</span>
Â  Â  Â  Â  Â  Â  Â  Â  status.<span class="hljs-title function_">setRollbackOnly</span>();
Â  Â  Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">throw</span>Â e;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  }
}
</code></pre>
<p>ç”¨<code>TransactionTemplate</code>çš„å¥½å¤„æ˜¯ä½ å¯ä»¥ç²¾ç¡®æ§åˆ¶äº‹åŠ¡çš„è¾¹ç•Œï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒæ–¹æ³•è°ƒç”¨çš„é—®é¢˜ã€‚</p>
<p>è€Œä¸”è¿˜å¯ä»¥åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­è·å–åˆ°äº‹åŠ¡çš„çŠ¶æ€ä¿¡æ¯ï¼Œåšç‚¹æ›´ç»†è‡´çš„æ§åˆ¶ã€‚</p>
<p>ä½†è¿™ç§æ–¹å¼ä¹Ÿæœ‰äº›é—®é¢˜ã€‚</p>
<p>æœ€æ˜æ˜¾çš„å°±æ˜¯ä»£ç çš„å¯è¯»æ€§ä¼šå˜å·®ä¸€äº›ï¼Œä¸šåŠ¡é€»è¾‘å’Œäº‹åŠ¡é€»è¾‘ä¼šæ··åœ¨ä¸€èµ·ã€‚</p>
<p>å¦å¤–ï¼Œå¦‚æœä¸šåŠ¡é€»è¾‘æ¯”è¾ƒå¤æ‚ï¼ŒåµŒå¥—å±‚æ¬¡æ·±çš„è¯ï¼Œä»£ç ä¹Ÿä¼šå˜å¾—ä¸å¤ªå¥½ç»´æŠ¤ã€‚</p>
<p>å½“ç„¶ä¸€èˆ¬æ¥è¯´éƒ½ä¼šåœ¨é¢å¤–å°è£…ä¸€äº›æ–¹æ³•ä»¥ä¾›ä¸šåŠ¡ä¾§æ¥è°ƒç”¨ã€‚</p>
<h5 data-id="heading-5">TransactionManagerï¼šæœ€çµæ´»çš„</h5>
<p>å¦‚æœæƒ³è¦å®Œå…¨çš„æ§åˆ¶æƒï¼Œé‚£å°±å¾—ç›´æ¥ç”¨<code>TransactionManager</code>äº†ã€‚è¿™ç§æ–¹å¼æœ€çµæ´»ï¼Œä½†çµæ´»çš„ä»£ä»·å°±æ˜¯å®¹æ˜“å‡ºé”™ã€‚</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@Service</span>
publicclassÂ PaymentServiceÂ {
Â  Â Â 
Â  Â Â <span class="hljs-keyword">@Autowired</span>
Â  Â Â privateÂ PlatformTransactionManager transactionManager;
Â  Â Â 
Â  Â Â publicÂ voidÂ <span class="hljs-built_in">processPayment</span>(Payment payment)Â {
Â  Â  Â  Â  DefaultTransactionDefinition def =Â newÂ <span class="hljs-built_in">DefaultTransactionDefinition</span>();
Â  Â  Â  Â  def<span class="hljs-selector-class">.setIsolationLevel</span>(TransactionDefinition.ISOLATION_READ_COMMITTED);
Â  Â  Â  Â  def<span class="hljs-selector-class">.setPropagationBehavior</span>(TransactionDefinition.PROPAGATION_REQUIRED);
Â  Â  Â  Â Â 
Â  Â  Â  Â  TransactionStatus status = transactionManager<span class="hljs-selector-class">.getTransaction</span>(def);
Â  Â  Â  Â Â tryÂ {
Â  Â  Â  Â  Â  Â  paymentRepository<span class="hljs-selector-class">.save</span>(payment);
Â  Â  Â  Â  Â  Â  notificationService<span class="hljs-selector-class">.sendPaymentConfirmation</span>(payment);
Â  Â  Â  Â  Â  Â  transactionManager<span class="hljs-selector-class">.commit</span>(status);
Â  Â  Â  Â  }Â catchÂ (Exception e) {
Â  Â  Â  Â  Â  Â  transactionManager<span class="hljs-selector-class">.rollback</span>(status);
Â  Â  Â  Â  Â  Â Â throwÂ e;
Â  Â  Â  Â  }
Â  Â  }
}
</code></pre>
<p>è¿™ç§æ–¹å¼çš„å¥½å¤„æ˜¯å¯ä»¥ç²¾ç¡®æ§åˆ¶äº‹åŠ¡çš„æ¯ä¸€ä¸ªç»†èŠ‚ï¼Œæ¯”å¦‚éš”ç¦»çº§åˆ«ã€ä¼ æ’­è¡Œä¸ºã€è¶…æ—¶æ—¶é—´ç­‰ç­‰ã€‚</p>
<p>ä½†æ˜¯ä»£ç é‡ä¼šå¢åŠ å¾ˆå¤šï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚</p>
<p>ä¸€æ—¦å¿˜è®°æäº¤æˆ–è€…å›æ»šï¼Œé‚£è¿Ÿæ—©ä¼šæœ‰æ•°æ®ä¸ä¸€è‡´çš„æƒŠå–œã€‚</p>
<h4 data-id="heading-6">è¯¥é€‰å“ªä¸ªï¼Ÿ</h4>
<p>ç»è¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œåˆ°åº•è¯¥æ€ä¹ˆé€‰æ‹©å‘¢ï¼Ÿ</p>
<p>æˆ‘çš„å»ºè®®æ˜¯è¿™æ ·çš„ï¼š</p>
<p><strong>å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œ@Transactionalå°±å¤Ÿç”¨äº†</strong>ã€‚å®ƒç®€å•ã€ç›´æ¥ï¼Œèƒ½è§£å†³90%çš„åœºæ™¯ã€‚é™¤éä½ é‡åˆ°äº†å®ƒè§£å†³ä¸äº†çš„é—®é¢˜ï¼Œå¦åˆ™æ²¡å¿…è¦æå¤æ‚ã€‚</p>
<p><strong>éœ€è¦ç²¾ç»†æ§åˆ¶æ—¶ï¼Œè€ƒè™‘TransactionTemplate</strong>ã€‚æ¯”å¦‚ä½ éœ€è¦åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­æ ¹æ®æŸäº›æ¡ä»¶å†³å®šæ˜¯å¦å›æ»šï¼Œæˆ–è€…éœ€è¦åœ¨ä¸€ä¸ªæ–¹æ³•é‡Œç®¡ç†å¤šä¸ªäº‹åŠ¡ï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨ä¸Š<code>TransactionTemplate</code>äº†ã€‚</p>
<p><strong>æå°‘æ•°æƒ…å†µä¸‹æ‰ç›´æ¥ç”¨TransactionManager</strong>ã€‚é€šå¸¸æ˜¯åœ¨å†™æ¡†æ¶ä»£ç æˆ–è€…æœ‰éå¸¸ç‰¹æ®Šçš„éœ€æ±‚æ—¶æ‰ä¼šç”¨åˆ°ã€‚</p>
<h4 data-id="heading-7">ä¸€ä¸ªä¾‹å­</h4>
<p>è®©æˆ‘ä¸¾ä¸ªå®é™…çš„ä¾‹å­æ¥è¯´æ˜è¿™ä¸‰ç§æ–¹å¼çš„å·®å¼‚ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªæ‰¹é‡å¯¼å…¥ç”¨æˆ·çš„åŠŸèƒ½ï¼Œè¦æ±‚æ˜¯ï¼šå¦‚æœæŸä¸ªç”¨æˆ·å¯¼å…¥å¤±è´¥ï¼Œä¸åº”è¯¥å½±å“å…¶ä»–ç”¨æˆ·çš„å¯¼å…¥ã€‚</p>
<p>ç”¨<code>@Transactional</code>çš„è¯ï¼Œå¯èƒ½ä¼šè¿™æ ·å†™ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span><span class="hljs-keyword">class</span>Â <span class="hljs-title class_">UserImportService</span>Â {
Â  Â Â 
Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">importUsers</span>(<span class="hljs-params">List&lt;User&gt; users</span>)Â {
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-title class_">User</span> user : users) {
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">try</span>Â {
Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-title function_">createUserWithTransaction</span>(user); Â <span class="hljs-comment">// æ³¨æ„ï¼Œè¿™æ ·å†™äº‹åŠ¡ä¸ä¼šç”Ÿæ•ˆï¼</span>
Â  Â  Â  Â  Â  Â  }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">Exception</span> e) {
Â  Â  Â  Â  Â  Â  Â  Â  log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"å¯¼å…¥ç”¨æˆ·å¤±è´¥: {}"</span>, user.<span class="hljs-title function_">getUsername</span>(), e);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â Â <span class="hljs-meta">@Transactional</span>
Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">createUserWithTransaction</span>(<span class="hljs-params">User user</span>)Â {
Â  Â  Â  Â  userRepository.<span class="hljs-title function_">save</span>(user);
Â  Â  Â  Â  userProfileRepository.<span class="hljs-title function_">save</span>(user.<span class="hljs-title function_">getProfile</span>());
Â  Â  }
}
</code></pre>
<p><strong>âš ï¸ ä¸Šé¢çš„ä»£ç ä¸­ï¼Œäº‹åŠ¡æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ï¼</strong></p>
<p>è¿™æ˜¯å› ä¸º<code>importUsers</code>æ–¹æ³•è°ƒç”¨åŒä¸€ä¸ªç±»ä¸­çš„<code>createUserWithTransaction</code>æ–¹æ³•ï¼Œå±äº<strong>å†…éƒ¨æ–¹æ³•è°ƒç”¨</strong>ã€‚Spring AOPé€šè¿‡ä»£ç†å®ç°äº‹åŠ¡ï¼Œè€ŒåŒä¸€ä¸ªç±»å†…éƒ¨çš„æ–¹æ³•è°ƒç”¨ä¸ä¼šèµ°ä»£ç†ï¼Œæ‰€ä»¥<code>@Transactional</code>æ³¨è§£å®Œå…¨å¤±æ•ˆã€‚</p>
<p>é€šä¿—çš„åšæ³•æ˜¯å°†æœ‰äº‹åŠ¡çš„æ–¹æ³•æŠ½å–åˆ°å¦ä¸€ä¸ªServiceä¸­ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span><span class="hljs-keyword">class</span>Â <span class="hljs-title class_">UserImportService</span>Â {
Â  Â Â 
Â  Â Â <span class="hljs-meta">@Autowired</span>
Â  Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">UserTransactionService</span> userTransactionService;
Â  Â Â 
Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">importUsers</span>(<span class="hljs-params">List&lt;User&gt; users</span>)Â {
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-title class_">User</span> user : users) {
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">try</span>Â {
Â  Â  Â  Â  Â  Â  Â  Â  userTransactionService.<span class="hljs-title function_">createUserWithTransaction</span>(user); Â <span class="hljs-comment">// âœ… è¿™æ ·æ‰ä¼šç”Ÿæ•ˆ</span>
Â  Â  Â  Â  Â  Â  }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">Exception</span> e) {
Â  Â  Â  Â  Â  Â  Â  Â  log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"å¯¼å…¥ç”¨æˆ·å¤±è´¥: {}"</span>, user.<span class="hljs-title function_">getUsername</span>(), e);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  }
}

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span><span class="hljs-keyword">class</span>Â <span class="hljs-title class_">UserTransactionService</span>Â {
Â  Â Â 
Â  Â Â <span class="hljs-meta">@Transactional</span>
Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">createUserWithTransaction</span>(<span class="hljs-params">User user</span>)Â {
Â  Â  Â  Â  userRepository.<span class="hljs-title function_">save</span>(user);
Â  Â  Â  Â  userProfileRepository.<span class="hljs-title function_">save</span>(user.<span class="hljs-title function_">getProfile</span>());
Â  Â  }
}
</code></pre>
<p>è¿™ç§æ–¹å¼çš„é—®é¢˜æ˜¯éœ€è¦é¢å¤–åˆ›å»ºä¸€ä¸ªServiceç±»ï¼Œå¢åŠ äº†ä»£ç å¤æ‚åº¦ã€‚</p>
<p>å½“ç„¶è¿˜æœ‰å¦ä¸€ç§æ–¹å¼ä½¿ç”¨Springçš„Â <code>AopContext.currentProxy()</code>Â æ‹¿åˆ°å½“å‰ä»£ç†å¯¹è±¡å†å»è°ƒç”¨ï¼Œæˆ–è€…ç”¨Â <code>ApplicationContext</code>Â å»ä»å®¹å™¨é‡Œè·å–ä»£ç†å¯¹è±¡ï¼Œä½†å§‹ç»ˆè§‰å¾—ä¸å¤ªä¼˜é›…ã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæœ‰æ—¶å€™<code>TransactionTemplate</code>ä¼šæ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</p>
<p>ç”¨<code>TransactionTemplate</code>çš„è¯ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span><span class="hljs-keyword">class</span>Â <span class="hljs-title class_">UserImportService</span>Â {
Â  Â Â 
Â  Â Â <span class="hljs-meta">@Autowired</span>
Â  Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">TransactionTemplate</span> transactionTemplate;
Â  Â Â 
Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">importUsers</span>(<span class="hljs-params">List&lt;User&gt; users</span>)Â {
Â  Â  Â  Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-title class_">User</span> user : users) {
Â  Â  Â  Â  Â  Â Â <span class="hljs-keyword">try</span>Â {
Â  Â  Â  Â  Â  Â  Â  Â  transactionTemplate.<span class="hljs-title function_">execute</span>(status -&gt; {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  userRepository.<span class="hljs-title function_">save</span>(user);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  userProfileRepository.<span class="hljs-title function_">save</span>(user.<span class="hljs-title function_">getProfile</span>());
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â returnnull;
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">Exception</span> e) {
Â  Â  Â  Â  Â  Â  Â  Â  log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"å¯¼å…¥ç”¨æˆ·å¤±è´¥: {}"</span>, user.<span class="hljs-title function_">getUsername</span>(), e);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  }
}
</code></pre>
<p>è¿™ç§æ–¹å¼å°±å¾ˆæ¸…æ™°ï¼Œäº‹åŠ¡è¾¹ç•Œåœ¨ä»£ç ä¸­ä¸€ç›®äº†ç„¶ï¼Œè€Œä¸”ä¸ç”¨æ‹…å¿ƒæ–¹æ³•è°ƒç”¨çš„é—®é¢˜ã€‚</p>
<p>é‚£<code>TransactionManager</code>å‘¢ï¼Ÿ</p>
<p>å†™ä¸šåŠ¡çš„æ—¶å€™åŸºæœ¬ä¸å¤ªä¼šç”¨åˆ°ï¼Œæ‰€ä»¥å’±ä¹Ÿä¸å¤šè´¹å£èˆŒäº†ã€‚</p>
<h4 data-id="heading-8">è¸©è¿‡çš„å‘</h4>
<p>è¯´åˆ°äº‹åŠ¡ç®¡ç†ï¼Œæˆ‘è‡ªå·±ä¹Ÿè¸©è¿‡ä¸å°‘å‘ã€‚</p>
<p>å°è±¡æœ€æ·±çš„ä¸€æ¬¡æ˜¯åœ¨å¤„ç†ä¸€ä¸ªæŠ¥è¡¨ç»Ÿè®¡çš„åŠŸèƒ½æ—¶ï¼Œç”±äºæ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œæˆ‘æƒ³ç€ç”¨åªè¯»äº‹åŠ¡æ¥æé«˜æ€§èƒ½ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Transactional</span>(readOnly =Â <span class="hljs-literal">true</span>)
<span class="hljs-keyword">public</span>Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">ReportData</span>&gt;Â <span class="hljs-title function_">generateReport</span>(<span class="hljs-params">ReportQuery query</span>)Â {
Â  Â Â <span class="hljs-comment">// å¤æ‚çš„æŸ¥è¯¢é€»è¾‘</span>
Â  Â Â <span class="hljs-keyword">return</span>Â reportRepository.<span class="hljs-title function_">findComplexData</span>(query);
}
</code></pre>
<p>ç»“æœå‘ç°æ€§èƒ½æå‡å¹¶ä¸æ˜æ˜¾ï¼Œåæ¥æ‰çŸ¥é“åªè¯»äº‹åŠ¡åœ¨æŸäº›æ•°æ®åº“è¿æ¥æ± é…ç½®ä¸‹ï¼Œæ•ˆæœå¹¶ä¸ç†æƒ³ã€‚</p>
<p>å¦ä¸€ä¸ªå¸¸è§çš„é—®é¢˜æ˜¯äº‹åŠ¡è¶…æ—¶ã€‚</p>
<p>æœ‰äº›å¼€å‘è€…å–œæ¬¢æŠŠäº‹åŠ¡è¶…æ—¶è®¾ç½®å¾—å¾ˆé•¿ï¼Œç”Ÿæ€•ä¸šåŠ¡é€»è¾‘æ‰§è¡Œæ—¶é—´è¿‡é•¿å¯¼è‡´äº‹åŠ¡å›æ»šã€‚ä½†è¿™æ ·åšçš„é£é™©å¾ˆæ˜æ˜¾ï¼Œå¦‚æœçœŸå‡ºç°äº†æ­»é”æˆ–è€…å…¶ä»–é—®é¢˜ï¼Œç³»ç»Ÿä¼šé•¿æ—¶é—´æ— å“åº”ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è¿™æ ·è®¾ç½®å¿…ç„¶æ˜¯ä¸å¤ªå¥½çš„ï¼Œæå…¶ä¸æ¨èï¼Œé™¤éä½ æ˜ç¡®çŸ¥é“è‡ªå·±åœ¨åšä»€ä¹ˆ</span>
<span class="hljs-meta">@Transactional(timeout =Â 300)</span>Â <span class="hljs-comment">// 5åˆ†é’Ÿè¶…æ—¶</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">processLargeDataSet</span><span class="hljs-params">(List&lt;Data&gt; dataList)</span>Â {
Â  Â Â <span class="hljs-comment">// å¤§é‡æ•°æ®å¤„ç†é€»è¾‘</span>
}
</code></pre>
<p>æ›´å¥½çš„åšæ³•æ˜¯ï¼ŒæŠŠå¤§äº‹åŠ¡æ‹†åˆ†æˆå°äº‹åŠ¡ï¼Œæˆ–è€…æ”¹å†™æˆæ‰¹å¤„ç†ã€‚</p>
<h4 data-id="heading-9">æ··åˆä½¿ç”¨çš„é—®é¢˜</h4>
<p>å›åˆ°æ–‡ç« å¼€å¤´æåˆ°çš„é‚£ä¸ªåŒäº‹çš„ä»£ç ï¼Œæ··åˆä½¿ç”¨ä¸åŒçš„äº‹åŠ¡ç®¡ç†æ–¹å¼å¾ˆå®¹æ˜“å‡ºé—®é¢˜ã€‚</p>
<p>æœ€å¸¸è§çš„æƒ…å†µæ˜¯äº‹åŠ¡ä¼ æ’­è¡Œä¸ºçš„ç†è§£åå·®ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span><span class="hljs-keyword">class</span>Â <span class="hljs-title class_">OrderService</span>Â {
Â  Â Â 
Â  Â Â <span class="hljs-meta">@Autowired</span>
Â  Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">TransactionTemplate</span> transactionTemplate;
Â  Â Â 
Â  Â Â <span class="hljs-meta">@Transactional</span>
Â  Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">processOrder</span>(<span class="hljs-params">Order order</span>)Â {
Â  Â  Â  Â  orderRepository.<span class="hljs-title function_">save</span>(order);
Â  Â  Â  Â Â 
Â  Â  Â  Â Â <span class="hljs-comment">// è¿™é‡Œåˆå¼€äº†ä¸€ä¸ªäº‹åŠ¡æ¨¡æ¿ï¼Œä¼ æ’­è¡Œä¸ºå¯èƒ½å’Œé¢„æœŸä¸ä¸€è‡´</span>
Â  Â  Â  Â  transactionTemplate.<span class="hljs-title function_">execute</span>(status -&gt; {
Â  Â  Â  Â  Â  Â  auditRepository.<span class="hljs-title function_">save</span>(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">OrderAudit</span>(order));
Â  Â  Â  Â  Â  Â Â returnnull;
Â  Â  Â  Â  });
Â  Â  }
}
</code></pre>
<p>è¿™ç§æ··ç”¨çš„ä»£ç å¾ˆè›‹ç–¼ï¼Œå¾ˆéš¾ç†è§£äº‹åŠ¡çš„è¾¹ç•Œï¼Œè°ƒè¯•èµ·æ¥ä¹Ÿå¾ˆçƒ¦ã€‚</p>
<p>æ‰€ä»¥åœ¨ä¸€ä¸ªserviceç±»ä¸­å°½é‡ä¿æŒäº‹åŠ¡ç®¡ç†æ–¹å¼çš„ä¸€è‡´æ€§ï¼Œæ²¡äº‹å°‘æŠ˜è…¾ã€‚</p>
<h3 data-id="heading-10">ç»“å°¾/æ€»ç»“</h3>
<p>ç¨å¾®æ€»ç»“ä¸€ä¸‹ã€‚</p>
<p>å¯¹äºæ–°æ‰‹ï¼Œå»ºè®®å…ˆæŠŠ<code>@Transactional</code>çš„å„ç§ç‰¹æ€§å’Œå‘ç‚¹ææ˜ç™½ï¼ŒåŸºæœ¬èƒ½è§£å†³å¤§éƒ¨åˆ†é—®é¢˜ã€‚ç­‰åˆ°çœŸæ­£éœ€è¦æ›´ç²¾ç»†æ§åˆ¶çš„æ—¶å€™ï¼Œå†è€ƒè™‘å…¶ä»–æ–¹æ¡ˆã€‚</p>
<p>å¯¹äºæœ‰ç»éªŒçš„å¼€å‘è€…ï¼Œåœ¨å·²ç»ç†Ÿç»ƒæŒæ¡ç¼–ç¨‹æ—¶äº‹åŠ¡æ§åˆ¶çš„å‰æä¸‹ï¼Œå†å¤šå…³æ³¨äº‹åŠ¡çš„æ€§èƒ½å½±å“ã€‚</p>
<p>äº‹åŠ¡ä¸æ˜¯ä¸‡é‡‘æ²¹ï¼Œè¿‡åº¦ä½¿ç”¨æˆ–è€…ä¸å½“ä½¿ç”¨éƒ½ä¼šå¸¦æ¥ä¸å¯é¢„æ–™çš„æ€§èƒ½é—®é¢˜ã€‚</p>
<p>æœ€é‡è¦çš„æ˜¯ï¼Œæ— è®ºé€‰æ‹©å“ªç§æ–¹å¼ï¼Œéƒ½è¦ä¿è¯ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
<p>æŠ€æœ¯æ˜¯ä¸ºä¸šåŠ¡æœåŠ¡çš„ï¼Œè€Œä»£ç æ˜¯è¦ç»™æ•´ä¸ªå›¢é˜Ÿä¸€èµ·ç»´æŠ¤çš„ï¼Œä¸è¦ä¸ºäº†ç‚«æŠ€è®©ä»£ç å˜å¾—æ™¦æ¶©éš¾æ‡‚ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®ä½ ç†æ¸…æ¥šè¿™ä¸‰ç§æ–¹å¼çš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Swift è‡ªå®šä¹‰å­—ç¬¦ä¸²æ’å€¼è¯¦è§£ï¼šä»åŸºç¡€åˆ°è¿›é˜¶åº”ç”¨]]></title>    <link>https://juejin.cn/post/7602996277664858166</link>    <guid>https://juejin.cn/post/7602996277664858166</guid>    <pubDate>2026-02-05T07:52:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602996277664858166" data-draft-id="7603142147642163243" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Swift è‡ªå®šä¹‰å­—ç¬¦ä¸²æ’å€¼è¯¦è§£ï¼šä»åŸºç¡€åˆ°è¿›é˜¶åº”ç”¨"/> <meta itemprop="keywords" content="Swift"/> <meta itemprop="datePublished" content="2026-02-05T07:52:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="unravel2025"/> <meta itemprop="url" content="https://juejin.cn/user/1116759541421880"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Swift è‡ªå®šä¹‰å­—ç¬¦ä¸²æ’å€¼è¯¦è§£ï¼šä»åŸºç¡€åˆ°è¿›é˜¶åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1116759541421880/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    unravel2025
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T07:52:07.000Z" title="Thu Feb 05 2026 07:52:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>Swift çš„å­—ç¬¦ä¸²æ’å€¼åŠŸèƒ½è¿œä¸æ­¢ç®€å•çš„å€¼æ›¿æ¢ã€‚è™½ç„¶å¤§å¤šæ•°å¼€å‘è€…ä¹ æƒ¯ä½¿ç”¨ <code>\()</code> è¯­æ³•å°†å˜é‡ç›´æ¥åµŒå…¥å­—ç¬¦ä¸²ï¼Œä½† Swift çš„å­—ç¬¦ä¸²æ’å€¼ç³»ç»Ÿå®é™…ä¸Šæ˜¯ä¸€ä¸ªé«˜åº¦å¯å®šåˆ¶ã€åŠŸèƒ½å¼ºå¤§çš„æœºåˆ¶ã€‚é€šè¿‡æ‰©å±• <code>String.StringInterpolation</code>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å­—ç¬¦ä¸²å­—é¢é‡ä¸­ç›´æ¥æ‰§è¡Œæ ¼å¼åŒ–ã€éªŒè¯ã€æ¡ä»¶é€»è¾‘ç­‰æ“ä½œï¼Œä½¿ä»£ç æ›´åŠ ç®€æ´ã€è¡¨è¾¾åŠ›æ›´å¼ºã€‚</p>
<h2 data-id="heading-1">æ ¸å¿ƒæ¦‚å¿µè§£æ</h2>
<p>String.StringInterpolation æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p><code>String.StringInterpolation</code> æ˜¯ Swift æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªç»“æ„ä½“ï¼Œè´Ÿè´£åœ¨ç¼–è¯‘æ—¶æ•è·å­—ç¬¦ä¸²å­—é¢é‡ä¸­çš„æ’å€¼æ®µã€‚æ¯å½“ä½ åœ¨å­—ç¬¦ä¸²ä¸­ä½¿ç”¨ <code>\(...)</code> è¯­æ³•æ—¶ï¼ŒSwift ç¼–è¯‘å™¨å®é™…ä¸Šä¼šï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ª <code>String.StringInterpolation</code> å®ä¾‹</li>
<li>æŒ‰é¡ºåºè°ƒç”¨ <code>appendLiteral(_:)</code> æ·»åŠ å­—é¢é‡éƒ¨åˆ†</li>
<li>è°ƒç”¨ <code>appendInterpolation(...)</code> æ–¹æ³•å¤„ç†æ’å€¼éƒ¨åˆ†</li>
<li>æœ€åé€šè¿‡ <code>String(stringInterpolation:)</code> åˆå§‹åŒ–å™¨ç”Ÿæˆæœ€ç»ˆå­—ç¬¦ä¸²</li>
</ol>
<p>è‡ªå®šä¹‰æ’å€¼çš„å…³é”®åœ¨äºï¼šä¸º <code>String.StringInterpolation</code> æ·»åŠ é‡è½½çš„ <code>appendInterpolation</code> æ–¹æ³•ã€‚</p>
<p>appendInterpolation æ–¹æ³•çš„é­”æ³•</p>
<p><code>appendInterpolation</code> æ–¹æ³•æœ‰å‡ ä¸ªç‰¹æ®Šä¹‹å¤„ï¼š</p>
<ul>
<li>æ–¹æ³•åå›ºå®šï¼šå¿…é¡»å‘½åä¸º <code>appendInterpolation</code></li>
<li>å‚æ•°è‡ªç”±ï¼šå¯ä»¥å®šä¹‰ä»»æ„æ•°é‡å’Œç±»å‹çš„å‚æ•°</li>
<li>å¯å˜æ–¹æ³•ï¼šå¿…é¡»æ ‡è®°ä¸º <code>mutating</code>ï¼Œå› ä¸ºå®ƒä¼šä¿®æ”¹æ’å€¼çŠ¶æ€</li>
</ul>
<p>ç¼–è¯‘å™¨ä¼šæ ¹æ®æ’å€¼ä¸­çš„å‚æ•°ç±»å‹è‡ªåŠ¨é€‰æ‹©åŒ¹é…çš„é‡è½½ç‰ˆæœ¬ã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li><code>\(age)</code> ä¼šåŒ¹é… <code>appendInterpolation(_ value: Int)</code></li>
<li><code>\(score, format: .number)</code> ä¼šåŒ¹é… <code>appendInterpolation(_ value: Double, format: FormatStyle)</code></li>
</ul>
<h2 data-id="heading-2">åŸºç¡€å®ç°ï¼šæ ¼å¼åŒ–æ’å€¼</h2>
<p>FormatStyle åè®®æ‰©å±•ï¼šå®ç°å¯¹ <code>FormatStyle</code> åè®®çš„è‡ªå®šä¹‰æ’å€¼æ”¯æŒï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> Foundation

<span class="hljs-keyword">extension</span> <span class="hljs-title class_">String</span>.<span class="hljs-title class_">StringInterpolation</span> {
    <span class="hljs-comment">// æ·»åŠ ä¸€ä¸ªæ³›å‹æ’å€¼æ–¹æ³•ï¼Œæ¥å—ä»»ä½•ç¬¦åˆ FormatStyle åè®®çš„ç±»å‹</span>
    <span class="hljs-keyword">mutating</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">appendInterpolation</span>&lt;<span class="hljs-type">F</span>: <span class="hljs-type">FormatStyle</span>&gt;(
        <span class="hljs-keyword">_</span> <span class="hljs-params">value</span>: <span class="hljs-type">F</span>.<span class="hljs-type">FormatInput</span>,          <span class="hljs-comment">// è¦æ ¼å¼åŒ–çš„å€¼</span>
        <span class="hljs-params">format</span>: <span class="hljs-type">F</span>                        <span class="hljs-comment">// æ ¼å¼åŒ–å™¨å®ä¾‹</span>
    ) <span class="hljs-keyword">where</span> <span class="hljs-type">F</span>.<span class="hljs-type">FormatInput</span>: <span class="hljs-type">Equatable</span>, <span class="hljs-type">F</span>.<span class="hljs-type">FormatOutput</span> <span class="hljs-operator">==</span> <span class="hljs-type">String</span> {
        <span class="hljs-comment">// è°ƒç”¨æ ¼å¼åŒ–å™¨çš„ format æ–¹æ³•å¹¶è¿½åŠ ç»“æœ</span>
        appendLiteral(format.format(value))
    }
}
</code></pre>
<p>ä»£ç è§£æï¼š</p>
<ul>
<li><code>&lt;F: FormatStyle&gt;</code>ï¼šæ³›å‹å‚æ•°ï¼Œæ¥å—ä»»ä½•ç¬¦åˆ <code>FormatStyle</code> åè®®çš„ç±»å‹</li>
<li><code>F.FormatInput</code>ï¼šæ ¼å¼åŒ–å™¨çš„è¾“å…¥ç±»å‹</li>
<li><code>F.FormatOutput == String</code>ï¼šçº¦æŸè¾“å‡ºå¿…é¡»æ˜¯å­—ç¬¦ä¸²</li>
<li><code>appendLiteral(_:)</code>ï¼šå°†æ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²æ·»åŠ åˆ°æœ€ç»ˆç»“æœä¸­</li>
</ul>
<p>ä½¿ç”¨ç¤ºä¾‹</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">let</span> today <span class="hljs-operator">=</span> <span class="hljs-type">Date</span>()

<span class="hljs-comment">// åœ¨å­—ç¬¦ä¸²ä¸­ç›´æ¥è¿›è¡Œæ—¥æœŸæ ¼å¼åŒ–</span>
<span class="hljs-keyword">let</span> formattedString <span class="hljs-operator">=</span> <span class="hljs-string">"""
Today's date is <span class="hljs-subst">\(today, format: .dateTime.year().month().day())</span>
"""</span>

<span class="hljs-built_in">print</span>(formattedString)
<span class="hljs-comment">// è¾“å‡º: Today's date is 13 Jan 2026</span>

<span class="hljs-comment">// æ›´å¤š FormatStyle ç¤ºä¾‹</span>
<span class="hljs-keyword">let</span> price <span class="hljs-operator">=</span> <span class="hljs-number">99.99</span>
<span class="hljs-keyword">let</span> priceString <span class="hljs-operator">=</span> <span class="hljs-string">"Price: <span class="hljs-subst">\(price, format: .currency(code: <span class="hljs-string">"USD"</span>))</span>"</span>
<span class="hljs-comment">// è¾“å‡º: Price: $99.99</span>

<span class="hljs-keyword">let</span> number <span class="hljs-operator">=</span> <span class="hljs-number">1234567.89</span>
<span class="hljs-keyword">let</span> numberString <span class="hljs-operator">=</span> <span class="hljs-string">"Number: <span class="hljs-subst">\(number, format: .number.precision(.fractionLength(<span class="hljs-number">2</span>)))</span>"</span>
<span class="hljs-comment">// è¾“å‡º: Number: 1,234,567.89</span>
</code></pre>
<h2 data-id="heading-3">è¿›é˜¶åº”ç”¨åœºæ™¯</h2>
<p>åœºæ™¯ä¸€ï¼šæ•°å€¼èŒƒå›´éªŒè¯ä¸æ˜¾ç¤º</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">extension</span> <span class="hljs-title class_">String</span>.<span class="hljs-title class_">StringInterpolation</span> {
    <span class="hljs-comment">// æ·»åŠ æ¸©åº¦æ’å€¼ï¼Œè‡ªåŠ¨éªŒè¯èŒƒå›´å¹¶æ·»åŠ å•ä½</span>
    <span class="hljs-keyword">mutating</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">appendInterpolation</span>(<span class="hljs-params">temperature</span>: <span class="hljs-type">Double</span>) {
        <span class="hljs-keyword">if</span> temperature <span class="hljs-operator">&lt;</span> <span class="hljs-operator">-</span><span class="hljs-number">273.15</span> {
            appendLiteral(<span class="hljs-string">"Invalid (below absolute zero)"</span>)
        } <span class="hljs-keyword">else</span> {
            appendLiteral(<span class="hljs-type">String</span>(format: <span class="hljs-string">"%.1fÂ°C"</span>, temperature))
        }
    }
}

<span class="hljs-keyword">let</span> temp1 <span class="hljs-operator">=</span> <span class="hljs-number">25.5</span>
<span class="hljs-keyword">let</span> temp2 <span class="hljs-operator">=</span> <span class="hljs-operator">-</span><span class="hljs-number">300.0</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Room temp: <span class="hljs-subst">\(temperature: temp1)</span>"</span>)  <span class="hljs-comment">// Room temp: 25.5Â°C</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Invalid: <span class="hljs-subst">\(temperature: temp2)</span>"</span>)    <span class="hljs-comment">// Invalid: Invalid (below absolute zero)</span>
</code></pre>
<p>åœºæ™¯äºŒï¼šæ¡ä»¶é€»è¾‘ä¸å¯é€‰å€¼å¤„ç†</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">extension</span> <span class="hljs-title class_">String</span>.<span class="hljs-title class_">StringInterpolation</span> {
    <span class="hljs-comment">// ä¼˜é›…å¤„ç†å¯é€‰å€¼</span>
    <span class="hljs-keyword">mutating</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">appendInterpolation</span>&lt;<span class="hljs-type">T</span>&gt;(
        <span class="hljs-keyword">_</span> <span class="hljs-params">value</span>: <span class="hljs-type">T</span>?, 
        <span class="hljs-params">default</span> <span class="hljs-params">defaultValue</span>: <span class="hljs-type">String</span> <span class="hljs-operator">=</span> <span class="hljs-string">"N/A"</span>
    ) {
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> value <span class="hljs-operator">=</span> value {
            appendLiteral(<span class="hljs-string">"<span class="hljs-subst">\(value)</span>"</span>)
        } <span class="hljs-keyword">else</span> {
            appendLiteral(defaultValue)
        }
    }
}

<span class="hljs-keyword">let</span> name: <span class="hljs-type">String</span>? <span class="hljs-operator">=</span> <span class="hljs-string">"Alice"</span>
<span class="hljs-keyword">let</span> age: <span class="hljs-type">Int</span>? <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Name: <span class="hljs-subst">\(name, <span class="hljs-keyword">default</span>: <span class="hljs-string">"Unknown"</span>)</span>"</span>)  <span class="hljs-comment">// Name: Alice</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"Age: <span class="hljs-subst">\(age)</span>"</span>)                        <span class="hljs-comment">// Age: N/A</span>
</code></pre>
<p>åœºæ™¯ä¸‰ï¼šæ„å»ºé¢†åŸŸä¸“ç”¨è¯­è¨€(DSL)</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// ä¸º HTML æ„å»ºè‡ªå®šä¹‰æ’å€¼</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">HTMLTag</span> {
    <span class="hljs-keyword">let</span> name: <span class="hljs-type">String</span>
    <span class="hljs-keyword">let</span> content: <span class="hljs-type">String</span>
    
    <span class="hljs-keyword">var</span> htmlString: <span class="hljs-type">String</span> {
        <span class="hljs-string">"&lt;<span class="hljs-subst">\(name)</span>&gt;<span class="hljs-subst">\(content)</span>&lt;/<span class="hljs-subst">\(name)</span>&gt;"</span>
    }
}

<span class="hljs-keyword">extension</span> <span class="hljs-title class_">String</span>.<span class="hljs-title class_">StringInterpolation</span> {
    <span class="hljs-comment">// ç›´æ¥åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥ HTML</span>
    <span class="hljs-keyword">mutating</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">appendInterpolation</span>(<span class="hljs-params">html</span> <span class="hljs-params">tag</span>: <span class="hljs-type">HTMLTag</span>) {
        appendLiteral(tag.htmlString)
    }
}

<span class="hljs-keyword">let</span> title <span class="hljs-operator">=</span> <span class="hljs-type">HTMLTag</span>(name: <span class="hljs-string">"h1"</span>, content: <span class="hljs-string">"Hello World"</span>)
<span class="hljs-keyword">let</span> paragraph <span class="hljs-operator">=</span> <span class="hljs-type">HTMLTag</span>(name: <span class="hljs-string">"p"</span>, content: <span class="hljs-string">"This is a paragraph."</span>)

<span class="hljs-keyword">let</span> html <span class="hljs-operator">=</span> <span class="hljs-string">"""
&lt;!DOCTYPE html&gt;
<span class="hljs-subst">\(html: title)</span>
<span class="hljs-subst">\(html: paragraph)</span>
"""</span>
</code></pre>
<h2 data-id="heading-4">æ·±å…¥åŸç†åˆ†æ</h2>
<h3 data-id="heading-5">ç¼–è¯‘æ—¶è½¬æ¢æœºåˆ¶</h3>
<p>Swift ç¼–è¯‘å™¨ä¼šå°†å­—ç¬¦ä¸²å­—é¢é‡è½¬æ¢ä¸ºä¸€ç³»åˆ—æ–¹æ³•è°ƒç”¨ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// æºä»£ç </span>
<span class="hljs-keyword">let</span> s <span class="hljs-operator">=</span> <span class="hljs-string">"Hello <span class="hljs-subst">\(name)</span>!

Welcome, <span class="hljs-subst">\(age)</span> year-old <span class="hljs-subst">\(name)</span>."</span>
</code></pre>
<p>// ç¼–è¯‘å™¨å®é™…ç”Ÿæˆçš„ä»£ç 
var interpolation = String.StringInterpolation(literalCapacity: 25, interpolationCount: 3)
interpolation.appendLiteral("Hello ")
interpolation.appendInterpolation(name)
interpolation.appendLiteral("!\n\nWelcome, ")
interpolation.appendInterpolation(age)
interpolation.appendLiteral(" year-old ")
interpolation.appendInterpolation(name)
interpolation.appendLiteral(".")
let s = String(stringInterpolation: interpolation)</p>
<pre><code class="hljs language-swift" lang="swift">
### æ€§èƒ½ä¼˜åŒ–ï¼šé¢„ç•™å®¹é‡

`<span class="hljs-type">String</span>.<span class="hljs-type">StringInterpolation</span>` çš„åˆå§‹åŒ–å™¨æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š
<span class="hljs-operator">-</span> `literalCapacity`ï¼šé¢„ä¼°çš„å­—é¢é‡å­—ç¬¦æ€»æ•°
<span class="hljs-operator">-</span> `interpolationCount`ï¼šé¢„ä¼°çš„æ’å€¼æ®µæ•°é‡

è¿™å…è®¸å†…éƒ¨å®ç°é¢„å…ˆåˆ†é…å†…å­˜ï¼Œé¿å…é‡å¤åˆ†é…<span class="hljs-operator">ã€‚</span>è‡ªå®šä¹‰ `appendInterpolation` åº”å°½å¯èƒ½é«˜æ•ˆ<span class="hljs-operator">ã€‚</span>

### è®¾è®¡å“²å­¦

<span class="hljs-type">Swift</span> çš„å­—ç¬¦ä¸²æ’å€¼è®¾è®¡éµå¾ªå‡ ä¸ªæ ¸å¿ƒåŸåˆ™ï¼š

<span class="hljs-number">1</span>. <span class="hljs-operator">**</span>ç±»å‹å®‰å…¨<span class="hljs-operator">**</span>ï¼šæ’å€¼æ–¹æ³•å¯ä»¥é’ˆå¯¹å…·ä½“ç±»å‹ï¼Œé¿å…è¿è¡Œæ—¶é”™è¯¯
<span class="hljs-number">2</span>. <span class="hljs-operator">**</span>å¯æ‰©å±•æ€§<span class="hljs-operator">**</span>ï¼šé€šè¿‡åè®®å’Œæ³›å‹ï¼Œç¬¬ä¸‰æ–¹åº“ä¹Ÿèƒ½æä¾›è‡ªå®šä¹‰æ’å€¼
<span class="hljs-number">3</span>. <span class="hljs-operator">**</span>è¡¨è¾¾åŠ›<span class="hljs-operator">**</span>ï¼šå°†æ ¼å¼åŒ–é€»è¾‘ä»ä»£ç ä¸­ç§»åˆ°å­—ç¬¦ä¸²å­—é¢é‡ä¸­ï¼Œæé«˜å¯è¯»æ€§
<span class="hljs-number">4</span>. <span class="hljs-operator">**</span>é›¶æˆæœ¬æŠ½è±¡<span class="hljs-operator">**</span>ï¼šåŸºæœ¬æ’å€¼ä¸å­—ç¬¦ä¸²æ‹¼æ¥æ€§èƒ½ç›¸å½“

## æ‰©å±•åœºæ™¯ä¸æœ€ä½³å®è·µ

### åœºæ™¯å››ï¼šæ—¥å¿—ç³»ç»Ÿå¢å¼º

```swift
<span class="hljs-comment">// ä¸ºæ—¥å¿—çº§åˆ«æ·»åŠ é¢œè‰²æ ‡è®°</span>
<span class="hljs-keyword">enum</span> <span class="hljs-title class_">LogLevel</span> {
    <span class="hljs-keyword">case</span> debug, info, warning, error
    
    <span class="hljs-keyword">var</span> <span class="hljs-keyword">prefix</span>: <span class="hljs-type">String</span> {
        <span class="hljs-keyword">switch</span> <span class="hljs-keyword">self</span> {
        <span class="hljs-keyword">case</span> .debug:   <span class="hljs-keyword">return</span> <span class="hljs-string">"ğŸ› DEBUG"</span>
        <span class="hljs-keyword">case</span> .info:    <span class="hljs-keyword">return</span> <span class="hljs-string">"â„¹ï¸ INFO"</span>
        <span class="hljs-keyword">case</span> .warning: <span class="hljs-keyword">return</span> <span class="hljs-string">"âš ï¸ WARNING"</span>
        <span class="hljs-keyword">case</span> .error:   <span class="hljs-keyword">return</span> <span class="hljs-string">"âŒ ERROR"</span>
        }
    }
}

<span class="hljs-keyword">extension</span> <span class="hljs-title class_">String</span>.<span class="hljs-title class_">StringInterpolation</span> {
    <span class="hljs-keyword">mutating</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">appendInterpolation</span>(
        <span class="hljs-params">log</span> <span class="hljs-params">message</span>: <span class="hljs-keyword">@autoclosure</span> () -&gt; <span class="hljs-type">String</span>,
        <span class="hljs-params">level</span>: <span class="hljs-type">LogLevel</span> <span class="hljs-operator">=</span> .info,
        <span class="hljs-params">file</span>: <span class="hljs-type">String</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">#file</span>,
        <span class="hljs-params">line</span>: <span class="hljs-type">Int</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">#line</span>
    ) {
        <span class="hljs-keyword">let</span> filename <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(fileURLWithPath: file).lastPathComponent
        appendLiteral(<span class="hljs-string">"[<span class="hljs-subst">\(level.prefix)</span>] <span class="hljs-subst">\(filename)</span>:<span class="hljs-subst">\(line)</span> - <span class="hljs-subst">\(message())</span>"</span>)
    }
}

<span class="hljs-keyword">func</span> <span class="hljs-title function_">logDebug</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">msg</span>: <span class="hljs-type">String</span>) {
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"<span class="hljs-subst">\(log: msg, level: .debug)</span>"</span>)
}
</code></pre>
<p>åœºæ™¯äº”ï¼šæœ¬åœ°åŒ–æ”¯æŒ</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">extension</span> <span class="hljs-title class_">String</span>.<span class="hljs-title class_">StringInterpolation</span> {
    <span class="hljs-comment">// æ”¯æŒæœ¬åœ°åŒ–é”®</span>
    <span class="hljs-keyword">mutating</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">appendInterpolation</span>(
        <span class="hljs-params">localized</span> <span class="hljs-params">key</span>: <span class="hljs-type">String</span>,
        <span class="hljs-params">tableName</span>: <span class="hljs-type">String</span>? <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>,
        <span class="hljs-params">bundle</span>: <span class="hljs-type">Bundle</span> <span class="hljs-operator">=</span> .main
    ) {
        <span class="hljs-keyword">let</span> localized <span class="hljs-operator">=</span> <span class="hljs-type">NSLocalizedString</span>(key, tableName: tableName, bundle: bundle, comment: <span class="hljs-string">""</span>)
        appendLiteral(localized)
    }
}

<span class="hljs-comment">// ä½¿ç”¨: "Welcome message: \(localized: "welcome.message")"</span>
</code></pre>
<p>åœºæ™¯å…­ï¼šJSON æ„å»º</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">extension</span> <span class="hljs-title class_">String</span>.<span class="hljs-title class_">StringInterpolation</span> {
    <span class="hljs-comment">// å®‰å…¨åœ°æ’å…¥ JSON å€¼</span>
    <span class="hljs-keyword">mutating</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">appendInterpolation</span>(<span class="hljs-params">json</span> <span class="hljs-params">value</span>: <span class="hljs-keyword">Any</span>) {
        <span class="hljs-keyword">if</span> <span class="hljs-type">JSONSerialization</span>.isValidJSONObject([value]),
           <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> <span class="hljs-type">JSONSerialization</span>.data(withJSONObject: value),
           <span class="hljs-keyword">let</span> string <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(data: data, encoding: .utf8) {
            appendLiteral(string)
        } <span class="hljs-keyword">else</span> {
            appendLiteral(<span class="hljs-string">"null"</span>)
        }
    }
}

<span class="hljs-keyword">let</span> dict <span class="hljs-operator">=</span> [<span class="hljs-string">"name"</span>: <span class="hljs-string">"Swift"</span>, <span class="hljs-string">"age"</span>: <span class="hljs-number">7</span>]
<span class="hljs-keyword">let</span> jsonString <span class="hljs-operator">=</span> <span class="hljs-string">"""
{
  "language": <span class="hljs-subst">\(json: <span class="hljs-string">"Swift"</span>)</span>,
  "details": <span class="hljs-subst">\(json: dict)</span>
}
"""</span>
</code></pre>
<p>æ³¨æ„äº‹é¡¹ä¸é™·é˜±</p>
<ol>
<li>é¿å…è¿‡åº¦ä½¿ç”¨ï¼šè™½ç„¶å¼ºå¤§ï¼Œä½†è¿‡å¤šçš„è‡ªå®šä¹‰æ’å€¼ä¼šé™ä½ä»£ç å¯è¯»æ€§</li>
<li>å‘½åå†²çªï¼šä¸åŒæ¨¡å—çš„ <code>appendInterpolation</code> å¯èƒ½äº§ç”Ÿæ­§ä¹‰ï¼Œå»ºè®®ä½¿ç”¨ç‰¹å®šæ ‡ç­¾</li>
<li>å¤æ‚é€»è¾‘ï¼šæ’å€¼ä¸­ä¸åº”åŒ…å«å¤æ‚ä¸šåŠ¡é€»è¾‘ï¼Œä¿æŒç®€å•å’Œèšç„¦</li>
<li>æ€§èƒ½æ•æ„Ÿï¼šåœ¨çƒ­è·¯å¾„ä¸­ï¼Œå¤§é‡æ’å€¼å¯èƒ½å½±å“æ€§èƒ½ï¼Œè€ƒè™‘é¢„æ ¼å¼åŒ–</li>
</ol>
<h2 data-id="heading-6">è§è§£ä¸æ€»ç»“</h2>
<p>Swift çš„è‡ªå®šä¹‰å­—ç¬¦ä¸²æ’å€¼æ˜¯ä¸€ä¸ªè¢«ä½ä¼°çš„å¼ºå¤§ç‰¹æ€§ã€‚å®ƒä¸ä»…ä»…æ˜¯è¯­æ³•ç³–ï¼Œæ›´æ˜¯è¯­è¨€å¯æ‰©å±•æ€§çš„ä½“ç°ã€‚ç›¸æ¯”å…¶ä»–è¯­è¨€çš„å­—ç¬¦ä¸²æ ¼å¼åŒ–ï¼ˆå¦‚ C çš„ <code>printf</code>ã€Python çš„ <code>f-string</code>ï¼‰ï¼ŒSwift çš„æ–¹æ¡ˆæä¾›äº†ï¼š</p>
<ul>
<li>ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥ï¼šé¿å… <code>%d</code> å¯¹åº”å­—ç¬¦ä¸²çš„è¿è¡Œæ—¶é”™è¯¯</li>
<li>IDE æ”¯æŒï¼šXcode èƒ½æä¾›å®Œæ•´çš„è‡ªåŠ¨è¡¥å…¨å’Œç±»å‹ä¿¡æ¯</li>
<li>æ— é™æ‰©å±•ï¼šä»»ä½•ç±»å‹ã€ä»»ä½•åº“éƒ½å¯ä»¥æ·»åŠ è‡ªå·±çš„æ’å€¼è¡Œä¸º</li>
</ul>
<p>æ ¸å¿ƒä¼˜åŠ¿ï¼š</p>
<ol>
<li>å£°æ˜å¼æ ¼å¼åŒ–ï¼šå°†"å¦‚ä½•æ˜¾ç¤º"ä¸"æ˜¾ç¤ºä»€ä¹ˆ"åˆ†ç¦»</li>
<li>å‡å°‘é‡å¤ï¼šæ ¼å¼åŒ–é€»è¾‘é›†ä¸­å®šä¹‰ï¼Œå¤šå¤„å¤ç”¨</li>
<li>æå‡å¯è¯»æ€§ï¼šæ ¼å¼åŒ–æ„å›¾ç›´æ¥ä½“ç°åœ¨å­—ç¬¦ä¸²å­—é¢é‡ä¸­</li>
</ol>
<p>æ¨èåº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>ç»Ÿä¸€çš„æ—¥æœŸã€æ•°å­—ã€è´§å¸æ ¼å¼åŒ–</li>
<li>é¢†åŸŸç‰¹å®šè¯­è¨€ï¼ˆDSLï¼‰æ„å»º</li>
<li>æ—¥å¿—ã€è°ƒè¯•ä¿¡æ¯çš„å¢å¼º</li>
<li>æ¨¡æ¿å¼•æ“çš„ç®€å•å®ç°</li>
</ul>
<p>åº”é¿å…çš„åœºæ™¯ï¼š</p>
<ul>
<li>å¤æ‚çš„ä¸šåŠ¡é€»è¾‘è®¡ç®—</li>
<li>ä¾èµ–å¤–éƒ¨çŠ¶æ€çš„æ ¼å¼åŒ–</li>
<li>éœ€è¦å›½é™…åŒ–/æœ¬åœ°åŒ–çš„é•¿æ–‡æœ¬</li>
</ul>
<p>å‚è€ƒèµ„æ–™</p>
<ol>
<li>
<p>å®˜æ–¹æ–‡æ¡£ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.swift.org%2Fswift-book%2Fdocumentation%2Fthe-swift-programming-language%2Fstringsandcharacters%2F%23String-Interpolation" target="_blank" title="https://docs.swift.org/swift-book/documentation/the-swift-programming-language/stringsandcharacters/#String-Interpolation" ref="nofollow noopener noreferrer">String Interpolation</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Fdocumentation%2Fswift%2Fstring%2Fstringinterpolation" target="_blank" title="https://developer.apple.com/documentation/swift/string/stringinterpolation" ref="nofollow noopener noreferrer">String.StringInterpolation Structure</a></li>
</ul>
</li>
<li>
<p>ç›¸å…³åšå®¢ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fnilcoalescing.com%2Fblog%2FDefiningCustomStringInterpolationBehaviorInSwift%2F" target="_blank" title="https://nilcoalescing.com/blog/DefiningCustomStringInterpolationBehaviorInSwift/" ref="nofollow noopener noreferrer">DefiningCustomStringInterpolationBehaviorInSwift</a></li>
</ul>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ¬¡ TimeZone é”ç«äº‰å¼•å‘çš„æ€§èƒ½ä¼˜åŒ–]]></title>    <link>https://juejin.cn/post/7602531501457899529</link>    <guid>https://juejin.cn/post/7602531501457899529</guid>    <pubDate>2026-02-04T08:17:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602531501457899529" data-draft-id="7602555027304005672" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ¬¡ TimeZone é”ç«äº‰å¼•å‘çš„æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="keywords" content="åç«¯,Java,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-02-04T08:17:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ¡¦è¯´ç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/2212689394274136"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ¬¡ TimeZone é”ç«äº‰å¼•å‘çš„æ€§èƒ½ä¼˜åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2212689394274136/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ¡¦è¯´ç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T08:17:47.000Z" title="Wed Feb 04 2026 08:17:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    28
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>åœ¨é«˜å¹¶å‘æœåŠ¡çš„æ€§èƒ½æ’æŸ¥ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡çº¿ç¨‹ dump å‘ç°äº†å¤§é‡çº¿ç¨‹é˜»å¡åœ¨åŒä¸€æŠŠé”ä¸Šã€‚æœ¬æ–‡å°†è¯¦ç»†åˆ†æé—®é¢˜æ ¹å› ï¼Œå¹¶ä»‹ç»æˆ‘çš„ä¼˜åŒ–æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-1">é—®é¢˜å‘ç°</h2>
<p>åœ¨ç”Ÿäº§ç¯å¢ƒè¿›è¡Œ thread dump æ—¶ï¼Œå‘ç°å¤šä¸ªå·¥ä½œçº¿ç¨‹ï¼ˆ20+ï¼‰å¤„äº BLOCKED çŠ¶æ€ï¼Œç­‰å¾…åŒä¸€ä¸ª Class å¯¹è±¡é”ï¼š</p>
<pre><code class="hljs language-php" lang="php">at java.util.TimeZone.<span class="hljs-title function_ invoke__">getTimeZone</span>(TimeZone.<span class="hljs-attr">java</span>:<span class="hljs-number">549</span>)
    - waiting on java.lang.Class@<span class="hljs-number">37</span>b99a71

at org.joda.time.DateTimeZone.<span class="hljs-title function_ invoke__">toTimeZone</span>(DateTimeZone.<span class="hljs-attr">java</span>:<span class="hljs-number">1250</span>)
at org.joda.time.base.AbstractDateTime.<span class="hljs-title function_ invoke__">toGregorianCalendar</span>(AbstractDateTime.<span class="hljs-attr">java</span>:<span class="hljs-number">296</span>)
at xxx.common.DateTimeUtils.<span class="hljs-title function_ invoke__">toCalendar</span>(DateTimeUtils.<span class="hljs-attr">java</span>:<span class="hljs-number">469</span>)
at xxx.business.RefundEndorseBusiness.<span class="hljs-title function_ invoke__">doSetRefundEndorseFee</span>(...)
...
at java.util.concurrent.ThreadPoolExecutor<span class="hljs-variable">$Worker</span>.<span class="hljs-title function_ invoke__">run</span>(ThreadPoolExecutor.<span class="hljs-attr">java</span>:<span class="hljs-number">642</span>)
</code></pre>
<p>å…³é”®ä¿¡æ¯ï¼š</p>
<ul>
<li><strong>é˜»å¡ä½ç½®</strong>: <code>java.util.TimeZone.getTimeZone</code></li>
<li><strong>ç­‰å¾…å¯¹è±¡</strong>: <code>java.lang.Class@37b99a71</code>ï¼ˆç±»é”ï¼‰</li>
<li><strong>è°ƒç”¨æ¥æº</strong>: Joda-Time çš„ <code>DateTimeZone.toTimeZone()</code> æ–¹æ³•</li>
</ul>
<h2 data-id="heading-2">é—®é¢˜åˆ†æ</h2>
<h3 data-id="heading-3">JDK TimeZone.getTimeZone çš„é”æœºåˆ¶</h3>
<p><code>TimeZone.getTimeZone(String ID)</code> æ–¹æ³•å†…éƒ¨å®ç°ä½¿ç”¨äº† <code>synchronized</code> å…³é”®å­—ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> TimeZone <span class="hljs-title function_">getTimeZone</span><span class="hljs-params">(String ID)</span> {
    <span class="hljs-comment">// ä»ç¼“å­˜æˆ–æ–‡ä»¶åŠ è½½æ—¶åŒºä¿¡æ¯</span>
    ...
}
</code></pre>
<p>è¿™æ„å‘³ç€<strong>æ‰€æœ‰è°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹éƒ½éœ€è¦ç«äº‰åŒä¸€æŠŠç±»é”</strong>ã€‚</p>
<h3 data-id="heading-4">Joda-Time çš„è°ƒç”¨é“¾</h3>
<p>åˆ†æ Joda-Time æºç ï¼Œ<code>DateTime.toGregorianCalendar()</code> çš„å®ç°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// org.joda.time.base.AbstractDateTime</span>
<span class="hljs-keyword">public</span> GregorianCalendar <span class="hljs-title function_">toGregorianCalendar</span><span class="hljs-params">()</span> {
    <span class="hljs-type">DateTimeZone</span> <span class="hljs-variable">zone</span> <span class="hljs-operator">=</span> getZone();
    <span class="hljs-type">GregorianCalendar</span> <span class="hljs-variable">cal</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GregorianCalendar</span>(zone.toTimeZone());
    cal.setTime(toDate());
    <span class="hljs-keyword">return</span> cal;
}
</code></pre>
<p>æ¯æ¬¡è°ƒç”¨éƒ½ä¼šæ‰§è¡Œ <code>zone.toTimeZone()</code>ï¼Œæœ€ç»ˆè§¦å‘ <code>TimeZone.getTimeZone()</code>ã€‚</p>
<h3 data-id="heading-5">é—®é¢˜æ ¹å› </h3>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      é«˜å¹¶å‘è¯·æ±‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Thread-<span class="hljs-number">1</span>    Thread-<span class="hljs-number">2</span>    Thread-<span class="hljs-number">3</span>    ...    Thread-N           â”‚
â”‚      â”‚           â”‚           â”‚                   â”‚              â”‚
â”‚      â–¼           â–¼           â–¼                   â–¼              â”‚
â”‚  <span class="hljs-built_in">toCalendar</span>()  <span class="hljs-built_in">toCalendar</span>()  <span class="hljs-built_in">toCalendar</span>()   <span class="hljs-built_in">toCalendar</span>()        â”‚
â”‚      â”‚           â”‚           â”‚                   â”‚              â”‚
â”‚      â–¼           â–¼           â–¼                   â–¼              â”‚
â”‚  <span class="hljs-built_in">toGregorianCalendar</span>() â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚      â”‚           â”‚           â”‚                   â”‚              â”‚
â”‚      â–¼           â–¼           â–¼                   â–¼              â”‚
â”‚  <span class="hljs-built_in">toTimeZone</span>() â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚      â”‚           â”‚           â”‚                   â”‚              â”‚
â”‚      â–¼           â–¼           â–¼                   â–¼              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚     TimeZone<span class="hljs-selector-class">.getTimeZone</span>() - synchronized ç±»é”           â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚   Thread-<span class="hljs-number">1</span>: è·å–é”ï¼Œæ‰§è¡Œä¸­...                             â”‚   â”‚
â”‚  â”‚   Thread-<span class="hljs-number">2</span>: BLOCKED (waiting on java.lang.Class)        â”‚   â”‚
â”‚  â”‚   Thread-<span class="hljs-number">3</span>: BLOCKED (waiting on java.lang.Class)        â”‚   â”‚
â”‚  â”‚   ...                                                    â”‚   â”‚
â”‚  â”‚   Thread-N: BLOCKED (waiting on java.lang.Class)        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>æ ¸å¿ƒé—®é¢˜</strong>ï¼š</p>
<ol>
<li>æ¯æ¬¡æ—¶é—´è½¬æ¢éƒ½è§¦å‘ <code>toTimeZone()</code> è°ƒç”¨</li>
<li><code>TimeZone.getTimeZone()</code> æ˜¯åŒæ­¥æ–¹æ³•ï¼ˆJDK 8ï¼‰</li>
<li>é«˜å¹¶å‘ä¸‹å¤§é‡çº¿ç¨‹ç«äº‰åŒä¸€æŠŠç±»é”</li>
<li>å®é™…ä¸šåŠ¡ä¸­æ—¶åŒºç§ç±»éå¸¸æœ‰é™ï¼ˆå¦‚ä»… <code>Asia/Shanghai</code>ã€<code>UTC</code> ç­‰ï¼‰</li>
</ol>
<h2 data-id="heading-6">åŸå§‹å®ç°</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Calendar <span class="hljs-title function_">toCalendar</span><span class="hljs-params">(DateTime dateTime)</span> {
    Calendar result;
    <span class="hljs-keyword">if</span> (dateTime == <span class="hljs-literal">null</span> || DateTimeUtils.isLogicMin(dateTime)) {
        result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GregorianCalendar</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        result.setTimeZone(TimeZone.getTimeZone(<span class="hljs-string">"UTC"</span>));
        <span class="hljs-keyword">return</span> result;
    }
    <span class="hljs-keyword">if</span> (DateTimeUtils.isLogicMax(dateTime)) {
        result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GregorianCalendar</span>(<span class="hljs-number">9999</span>, Calendar.DECEMBER, <span class="hljs-number">31</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        result.setTimeZone(TimeZone.getTimeZone(<span class="hljs-string">"UTC"</span>));
        <span class="hljs-keyword">return</span> result;
    }
    <span class="hljs-comment">// é—®é¢˜æ‰€åœ¨ï¼šæ¯æ¬¡éƒ½è°ƒç”¨ toGregorianCalendar()</span>
    result = dateTime.toGregorianCalendar();
    <span class="hljs-keyword">return</span> result;
}
</code></pre>
<h2 data-id="heading-7">ä¼˜åŒ–æ–¹æ¡ˆ</h2>
<h3 data-id="heading-8">è®¾è®¡æ€è·¯</h3>
<p>ç”±äºåº•å±‚APIåœ¨é¡¹ç›®ä¸­é¢‘ç¹ä½¿ç”¨ï¼Œå…¨éƒ¨æ”¹åŠ¨é£é™©æ¯”è¾ƒå¤§ï¼Œæˆ‘ä¹Ÿä¸æƒ³å› ä¸ºå‡ºé”™è€ŒèƒŒé”…ï¼Œæ‰€ä»¥è€ƒè™‘æ¶ˆé™¤é”ç«äº‰çš„æ–¹æ¡ˆã€‚</p>
<p>æ—¢ç„¶æ—¶åŒºæ•°é‡æœ‰é™ï¼Œæˆ‘ä»¬å¯ä»¥<strong>ç¼“å­˜ <code>DateTimeZone</code> åˆ° <code>TimeZone</code> çš„æ˜ å°„</strong>ï¼Œé¿å…é‡å¤è°ƒç”¨ <code>toTimeZone()</code>ã€‚</p>
<h3 data-id="heading-9">æŠ€æœ¯é€‰å‹ï¼šä¸ºä»€ä¹ˆé€‰æ‹© Caffeine</h3>






























<table><thead><tr><th>æ–¹æ¡ˆ</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td><code>HashMap</code> + <code>synchronized</code></td><td>å®ç°ç®€å•</td><td>é”ç²’åº¦ç²—ï¼Œä¸åŸé—®é¢˜ç±»ä¼¼</td></tr><tr><td><code>ConcurrentHashMap.computeIfAbsent</code></td><td>JDK åŸç”Ÿï¼Œæ— ä¾èµ–</td><td>é¦–æ¬¡åŠ è½½æ—¶ä»æœ‰é”ç«äº‰ï¼›é•¿ key å¯èƒ½ hash å†²çª</td></tr><tr><td><strong>Caffeine</strong></td><td>é«˜æ€§èƒ½ã€è‡ªåŠ¨é©±é€ã€ç»Ÿè®¡ç›‘æ§</td><td>å¼•å…¥é¢å¤–ä¾èµ–</td></tr><tr><td>Guava Cache</td><td>åŠŸèƒ½å®Œå–„</td><td>æ€§èƒ½ç•¥é€Šäº Caffeine</td></tr></tbody></table>
<p>é€‰æ‹© <strong>Caffeine</strong> çš„åŸå› ï¼š</p>
<ol>
<li><strong>é«˜æ€§èƒ½</strong>: åŸºäº W-TinyLFU ç®—æ³•ï¼Œè¿‘ä¹ O(1) çš„è¯»å†™æ€§èƒ½</li>
<li><strong>æ— é”è¯»å–</strong>: è¯»æ“ä½œå‡ ä¹æ— é”ç«äº‰</li>
<li><strong>è‡ªåŠ¨ç®¡ç†</strong>: æ”¯æŒå®¹é‡é™åˆ¶å’Œè‡ªåŠ¨é©±é€</li>
<li><strong>é¡¹ç›®å·²æœ‰ä¾èµ–</strong>: æ— éœ€å¼•å…¥æ–°çš„ jar åŒ…</li>
</ol>
<h3 data-id="heading-10">ä¼˜åŒ–åçš„å®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * ç¼“å­˜å¼€å…³ï¼Œé©±é€æ—¶é™çº§ä¸ºç›´æ¥è°ƒç”¨
 */</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">zoneCacheEnable</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;

<span class="hljs-comment">/**
 * DateTimeZone -&gt; TimeZone ç¼“å­˜
 * ç”Ÿäº§ç¯å¢ƒæ—¶åŒºç§ç±»æœ‰é™ï¼ˆé€šå¸¸ &lt; 5 ç§ï¼‰ï¼Œè®¾ç½® maximumSize = 24 è¶³å¤Ÿ
 */</span>
<span class="hljs-keyword">static</span> LoadingCache&lt;DateTimeZone, TimeZone&gt; zoneCache = Caffeine.newBuilder()
        .maximumSize(<span class="hljs-number">24</span>)
        .evictionListener((k, v, c) -&gt; {
            <span class="hljs-comment">// æ­£å¸¸æƒ…å†µä¸åº”è¯¥è§¦å‘é©±é€ï¼Œå¦‚æœè§¦å‘è¯´æ˜æ—¶åŒºç§ç±»å¼‚å¸¸å¤š</span>
            LOGGER.error(<span class="hljs-string">"zone cache evicted k={}, v={}, cause={}"</span>, k, v, c);
            zoneCacheEnable = <span class="hljs-literal">false</span>;
        })
        .build(DateTimeZone::toTimeZone);

<span class="hljs-comment">/**
 * ä»ç¼“å­˜è·å– TimeZoneï¼Œå¸¦ fallback
 */</span>
<span class="hljs-keyword">static</span> TimeZone <span class="hljs-title function_">getTimeZoneFromCache</span><span class="hljs-params">(DateTimeZone zone)</span> {
    <span class="hljs-keyword">return</span> zoneCacheEnable ? zoneCache.get(zone) : zone.toTimeZone();
}

<span class="hljs-comment">/**
 * ä¼˜åŒ–åçš„ toCalendar æ–¹æ³•
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Calendar <span class="hljs-title function_">toCalendar</span><span class="hljs-params">(DateTime dateTime)</span> {
    Calendar result;
    <span class="hljs-keyword">if</span> (dateTime == <span class="hljs-literal">null</span> || DateTimeUtils.isLogicMin(dateTime)) {
        result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GregorianCalendar</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        result.setTimeZone(TimeZone.getTimeZone(<span class="hljs-string">"UTC"</span>));
        <span class="hljs-keyword">return</span> result;
    }
    <span class="hljs-keyword">if</span> (DateTimeUtils.isLogicMax(dateTime)) {
        result = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GregorianCalendar</span>(<span class="hljs-number">9999</span>, Calendar.DECEMBER, <span class="hljs-number">31</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
        result.setTimeZone(TimeZone.getTimeZone(<span class="hljs-string">"UTC"</span>));
        <span class="hljs-keyword">return</span> result;
    }

    <span class="hljs-comment">// ä¼˜åŒ–ï¼šä»ç¼“å­˜è·å– TimeZoneï¼Œé¿å…é”ç«äº‰</span>
    <span class="hljs-type">DateTimeZone</span> <span class="hljs-variable">zone</span> <span class="hljs-operator">=</span> dateTime.getZone();
    <span class="hljs-type">TimeZone</span> <span class="hljs-variable">timeZone</span> <span class="hljs-operator">=</span> getTimeZoneFromCache(zone);
    <span class="hljs-type">GregorianCalendar</span> <span class="hljs-variable">cal</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GregorianCalendar</span>(timeZone);
    cal.setTime(dateTime.toDate());
    <span class="hljs-keyword">return</span> cal;
}
</code></pre>
<h3 data-id="heading-11">ä¼˜åŒ–å‰åå¯¹æ¯”</h3>
<pre><code class="hljs language-scss" lang="scss">ä¼˜åŒ–å‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  N ä¸ªçº¿ç¨‹åŒæ—¶è°ƒç”¨ <span class="hljs-built_in">toCalendar</span>()                           â”‚
â”‚           â”‚                                             â”‚
â”‚           â–¼                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  TimeZone<span class="hljs-selector-class">.getTimeZone</span>() - synchronized ç±»é”     â”‚    â”‚
â”‚  â”‚  æ‰€æœ‰çº¿ç¨‹ä¸²è¡Œç­‰å¾…                                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä¼˜åŒ–åï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  N ä¸ªçº¿ç¨‹åŒæ—¶è°ƒç”¨ <span class="hljs-built_in">toCalendar</span>()                           â”‚
â”‚           â”‚                                             â”‚
â”‚           â–¼                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Caffeine Cache - æ— é”è¯»å–                       â”‚    â”‚
â”‚  â”‚  æ‰€æœ‰çº¿ç¨‹å¹¶è¡Œè·å–ç¼“å­˜çš„ TimeZone                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 data-id="heading-12">å…³é”®è®¾è®¡å†³ç­–</h2>
<h3 data-id="heading-13">1. ä¸ºä»€ä¹ˆè®¾ç½® maximumSize = 24</h3>
<ul>
<li>å›½å†…ä¸šåŠ¡ä¸»è¦æ¶‰åŠ <code>Asia/Shanghai</code>ã€<code>UTC</code>ã€<code>Asia/Hong_Kong</code> ç­‰å°‘æ•°å‡ ä¸ªæ—¶åŒº</li>
<li>å¦‚æœè¶…è¿‡ 24 ä¸ªä¸åŒæ—¶åŒºï¼Œè¯´æ˜æ•°æ®å¼‚å¸¸ï¼Œè§¦å‘å‘Šè­¦</li>
</ul>
<h3 data-id="heading-14">2. evictionListener çš„ä½œç”¨</h3>
<pre><code class="hljs language-java" lang="java">.evictionListener((k, v, c) -&gt; {
    LOGGER.error(<span class="hljs-string">"zone cache evicted k={}, v={}, cause={}"</span>, k, v, c);
    zoneCacheEnable = <span class="hljs-literal">false</span>;
})
</code></pre>
<ul>
<li>æ­£å¸¸æƒ…å†µä¸‹ä¸åº”è¯¥è§¦å‘é©±é€ï¼ˆæ—¶åŒºæ•°é‡ &lt; 8ï¼‰</li>
<li>å¦‚æœè§¦å‘ï¼Œè¯´æ˜ï¼š
<ul>
<li>å­˜åœ¨å¼‚å¸¸æ•°æ®å¯¼è‡´æ—¶åŒºç§ç±»è¿‡å¤š</li>
<li>æˆ–è€…ç¼“å­˜é…ç½®éœ€è¦è°ƒæ•´</li>
</ul>
</li>
<li>è®°å½•é”™è¯¯æ—¥å¿—ä¾¿äºæ’æŸ¥</li>
<li>ç¦ç”¨ç¼“å­˜ä½œä¸º fallbackï¼Œé¿å…é¢‘ç¹é©±é€å¸¦æ¥çš„æ€§èƒ½æŸè€—</li>
</ul>
<h3 data-id="heading-15">3. volatile å…³é”®å­—çš„ä½¿ç”¨</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">zoneCacheEnable</span> <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;
</code></pre>
<ul>
<li>ä¿è¯å¤šçº¿ç¨‹é—´çš„å¯è§æ€§</li>
<li>å…è®¸åœ¨å‘ç°å¼‚å¸¸æ—¶å¿«é€Ÿé™çº§</li>
</ul>
<h2 data-id="heading-16">æ€»ç»“</h2>
<p>é€šè¿‡å¼•å…¥ Caffeine ç¼“å­˜ï¼Œæˆ‘ä»¬æˆåŠŸæ¶ˆé™¤äº† <code>TimeZone.getTimeZone()</code> çš„é”ç«äº‰é—®é¢˜ã€‚è¿™ä¸ªä¼˜åŒ–çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong>å¯¹äºæ•°é‡æœ‰é™ã€åˆ›å»ºæˆæœ¬é«˜çš„å¯¹è±¡ï¼Œä½¿ç”¨ç¼“å­˜æ¥æ¢å–å¹¶å‘æ€§èƒ½</strong>ã€‚</p>
<p>ä¸è¦ä½¿ç”¨è¿‡æ—¶çš„APIã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å½»åº•ææ‡‚å¤§æ–‡ä»¶ä¸Šä¼ ï¼šä»å¹¼å„¿å›­åˆ°åšå£«é˜¶æ®µçš„å…¨æ ˆæ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7602982045137780782</link>    <guid>https://juejin.cn/post/7602982045137780782</guid>    <pubDate>2026-02-05T07:58:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602982045137780782" data-draft-id="7602935146707058734" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å½»åº•ææ‡‚å¤§æ–‡ä»¶ä¸Šä¼ ï¼šä»å¹¼å„¿å›­åˆ°åšå£«é˜¶æ®µçš„å…¨æ ˆæ–¹æ¡ˆ"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2026-02-05T07:58:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è±†è‹—å­¦å‰ç«¯"/> <meta itemprop="url" content="https://juejin.cn/user/1935598759719400"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å½»åº•ææ‡‚å¤§æ–‡ä»¶ä¸Šä¼ ï¼šä»å¹¼å„¿å›­åˆ°åšå£«é˜¶æ®µçš„å…¨æ ˆæ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1935598759719400/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è±†è‹—å­¦å‰ç«¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T07:58:10.000Z" title="Thu Feb 05 2026 07:58:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç¬¬ä¸€å±‚ï¼šå¹¼å„¿å›­é˜¶æ®µ â€”â€” ä¸ºä»€ä¹ˆè¦æå¤æ‚ä¸Šä¼ ï¼Ÿ</h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼šä½ è¦æŠŠå®¶é‡Œçš„**ä¸€ä¸‡æœ¬ä¹¦ï¼ˆ10GB æ–‡ä»¶ï¼‰**æ¬åˆ°æ–°å®¶ã€‚</p>
<p><strong>æ™®é€šæ–¹æ¡ˆï¼ˆç®€å•ä¸Šä¼ ï¼‰</strong>ï¼šä½ è¯•å›¾ä¸€æ¬¡æ€§æŠŠä¸€ä¸‡æœ¬ä¹¦å¡è¿›ä¸€ä¸ªå°ä¸‰è½®è½¦ã€‚ç»“æœï¼šè½¦çˆ†èƒäº†ï¼ˆæµè§ˆå™¨å†…å­˜æº¢å‡ºï¼‰ï¼Œæˆ–è€…è·¯ä¸Šå µè½¦å¤ªä¹…ï¼Œæ–°å®¶ç®¡ç†å‘˜ç­‰å¾—ä¸è€çƒ¦æŠŠé—¨å…³äº†ï¼ˆè¯·æ±‚è¶…æ—¶ï¼‰ã€‚</p>
<p><strong>å…¨æ ˆæ–¹æ¡ˆï¼ˆåˆ†ç‰‡ä¸Šä¼ ï¼‰</strong>ï¼šä½ æŠŠä¹¦è£…æˆ 100 ä¸ªå°ç®±å­ï¼Œä¸€ç®±ä¸€ç®±è¿ã€‚å³ä¾¿è·¯ä¸Šæœ‰ä¸€ç®±ä¸¢äº†ï¼Œä½ åªéœ€è¦è¡¥å‘é‚£ä¸€ç®±ï¼Œè€Œä¸æ˜¯é‡æ–°æ¬ä¸€ä¸‡æœ¬ä¹¦ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ ·åšï¼Ÿ</strong></p>
<ul>
<li>é™ä½å•æ¬¡ä¼ è¾“çš„æ•°æ®é‡ï¼Œé¿å…å†…å­˜æº¢å‡º</li>
<li>å‡å°‘å•ä¸ªè¯·æ±‚çš„å¤„ç†æ—¶é—´ï¼Œé™ä½è¶…æ—¶é£é™©</li>
<li>æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œæé«˜ä¸Šä¼ æˆåŠŸç‡</li>
</ul>
<h2 data-id="heading-1">ç¬¬äºŒå±‚ï¼šå°å­¦é˜¶æ®µ â€”â€” ç®€å•ä¸Šä¼ çš„æé™</h2>
<p>å¯¹äºå°äº 10MB çš„å›¾ç‰‡æˆ–æ–‡æ¡£ï¼Œæˆ‘ä»¬ç”¨ FormDataã€‚</p>
<p><strong>å‰ç«¯ (Vue)</strong>ï¼šinput type="file" è·å–æ–‡ä»¶ï¼Œå°å…¥ FormDataï¼Œé€šè¿‡ axios å‘é€ã€‚</p>
<p><strong>åç«¯ (Node)</strong>ï¼šä½¿ç”¨ multer æˆ– formidable ä¸­é—´ä»¶æ¥æ”¶ã€‚</p>
<p><strong>æ•°æ®åº“ (MySQL)</strong>ï¼šåˆ‡è®°ï¼ æ•°æ®åº“ä¸å­˜æ–‡ä»¶äºŒè¿›åˆ¶æµï¼Œåªå­˜æ–‡ä»¶çš„è®¿é—®è·¯å¾„ï¼ˆURLï¼‰ã€æ–‡ä»¶åã€å¤§å°å’Œä¸Šä¼ æ—¶é—´ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆæ•°æ®åº“ä¸å­˜æ–‡ä»¶ï¼Ÿ</strong></p>
<ul>
<li>æ–‡ä»¶ä½“ç§¯å¤ªå¤§ï¼Œå½±å“æ•°æ®åº“æ€§èƒ½</li>
<li>æ•°æ®åº“å¤‡ä»½å’Œè¿ç§»å˜å¾—å›°éš¾</li>
<li>ç£ç›˜ç©ºé—´æµªè´¹ï¼Œéš¾ä»¥æ¸…ç†</li>
</ul>
<p><strong>ç®€å•ä¸Šä¼ çš„ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å‰ç«¯</span>
<span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormData</span>();
formData.<span class="hljs-title function_">append</span>(<span class="hljs-string">'file'</span>, fileInput.<span class="hljs-property">files</span>[<span class="hljs-number">0</span>]);
axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/upload'</span>, formData);

<span class="hljs-comment">// åç«¯</span>
<span class="hljs-keyword">const</span> upload = <span class="hljs-title function_">multer</span>({ <span class="hljs-attr">dest</span>: <span class="hljs-string">'uploads/'</span> });
app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/upload'</span>, upload.<span class="hljs-title function_">single</span>(<span class="hljs-string">'file'</span>), <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  <span class="hljs-comment">// å¤„ç†ä¸Šä¼ </span>
});
</code></pre>
<h2 data-id="heading-2">ç¬¬ä¸‰å±‚ï¼šä¸­å­¦é˜¶æ®µ â€”â€” åˆ†ç‰‡ä¸Šä¼  (Chunking) çš„é€»è¾‘å…¬å¼</h2>
<p>è¿™æ˜¯é¢è¯•çš„æ ¸å¿ƒèµ·ç‚¹ã€‚è¯·èƒŒè¯µæµç¨‹ï¼š</p>
<p><strong>åˆ‡ç‰‡</strong>ï¼šåˆ©ç”¨ File å¯¹è±¡çš„ slice æ–¹æ³•ï¼ˆåº•å±‚æ˜¯ Blobï¼‰ï¼Œå°†å¤§æ–‡ä»¶åˆ‡æˆ N ä»½ã€‚
<strong>æ ‡è¯†</strong>ï¼šç»™æ¯ä¸ªç‰‡èµ·ä¸ªåå­—ï¼Œé€šå¸¸æ˜¯ æ–‡ä»¶å + ä¸‹æ ‡ã€‚
<strong>å¹¶å‘å‘é€</strong>ï¼šåŒæ—¶å‘é€å¤šä¸ª HTTP è¯·æ±‚ã€‚
<strong>åˆå¹¶</strong>ï¼šå‰ç«¯å‘ä¸ª"æŒ‡ä»¤"ï¼Œåç«¯æŠŠæ‰€æœ‰ç¢ç‰‡æŒ‰é¡ºåºåˆæˆä¸€ä¸ªå®Œæ•´æ–‡ä»¶ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆè¦ç”¨sliceæ–¹æ³•ï¼Ÿ</strong></p>
<ul>
<li>å®ƒä¸ä¼šå¤åˆ¶æ•´ä¸ªæ–‡ä»¶åˆ°å†…å­˜ï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªæŒ‡å‘åŸæ–‡ä»¶éƒ¨åˆ†çš„å¼•ç”¨</li>
<li>å†…å­˜å ç”¨æå°ï¼Œé€‚åˆå¤„ç†å¤§æ–‡ä»¶</li>
<li>å¯ä»¥ç²¾ç¡®æ§åˆ¶æ¯ä¸ªåˆ†ç‰‡çš„å¤§å°</li>
</ul>
<p><strong>åˆ†ç‰‡ä¸Šä¼ çš„å®ç°é€»è¾‘</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ†ç‰‡å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createFileChunks</span>(<span class="hljs-params">file, chunkSize = <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">2</span></span>) { <span class="hljs-comment">// 2MB per chunk</span>
  <span class="hljs-keyword">const</span> chunks = [];
  <span class="hljs-keyword">let</span> start = <span class="hljs-number">0</span>;
  
  <span class="hljs-keyword">while</span> (start &lt; file.<span class="hljs-property">size</span>) {
    <span class="hljs-keyword">const</span> end = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(start + chunkSize, file.<span class="hljs-property">size</span>);
    <span class="hljs-keyword">const</span> chunk = file.<span class="hljs-title function_">slice</span>(start, end); <span class="hljs-comment">// æ ¸å¿ƒAPI</span>
    chunks.<span class="hljs-title function_">push</span>({
      <span class="hljs-attr">blob</span>: chunk,
      <span class="hljs-attr">index</span>: chunks.<span class="hljs-property">length</span>,
      start,
      end
    });
    start = end;
  }
  
  <span class="hljs-keyword">return</span> chunks;
}
</code></pre>
<h2 data-id="heading-3">ç¬¬å››å±‚ï¼šå¤§å­¦é˜¶æ®µ â€”â€” ç§’ä¼ ä¸å”¯ä¸€æ ‡è¯† (MD5)</h2>
<p>é¢è¯•å®˜é—®ï¼š"å¦‚æœç”¨æˆ·ä¸Šä¼ ä¸€ä¸ªæœåŠ¡å™¨å·²ç»æœ‰çš„æ–‡ä»¶ï¼Œæ€ä¹ˆå®ç°ç§’ä¼ ï¼Ÿ"</p>
<p><strong>æ ¸å¿ƒ</strong>ï¼šæ–‡ä»¶çš„"èº«ä»½è¯"ã€‚ä¸èƒ½ç”¨æ–‡ä»¶åï¼Œè¦ç”¨æ–‡ä»¶çš„å†…å®¹ç”Ÿæˆ MD5 å“ˆå¸Œå€¼ã€‚</p>
<p><strong>æµç¨‹</strong>ï¼š</p>
<ol>
<li>å‰ç«¯ç”¨ spark-md5 è®¡ç®—æ–‡ä»¶å“ˆå¸Œã€‚</li>
<li>ä¸Šä¼ å‰å…ˆé—®åç«¯ï¼š"è¿™ä¸ª MD5 å¯¹åº”çš„æ–‡ä»¶ä½ æœ‰æ²¡æœ‰ï¼Ÿ"</li>
<li>åç«¯æŸ¥ MySQLï¼Œå¦‚æœæœ‰ï¼Œç›´æ¥è¿”å›æˆåŠŸâ€”â€”è¿™å°±æ˜¯ç§’ä¼ ã€‚</li>
</ol>
<p><strong>ä¸ºä»€ä¹ˆç”¨MD5è€Œä¸æ˜¯æ–‡ä»¶åï¼Ÿ</strong></p>
<ul>
<li>æ–‡ä»¶åå¯ä»¥é‡å¤ï¼Œä½†å†…å®¹ä¸åŒçš„æ–‡ä»¶</li>
<li>æ–‡ä»¶åå¯ä»¥è¢«ä¿®æ”¹ï¼Œä½†å†…å®¹ä¸å˜</li>
<li>MD5æ˜¯å†…å®¹çš„æ•°å­—æŒ‡çº¹ï¼Œç›¸åŒå†…å®¹å¿…å®šæœ‰ç›¸åŒçš„MD5</li>
</ul>
<p><strong>MD5è®¡ç®—ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">SparkMD5</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'spark-md5'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">calculateFileHash</span>(<span class="hljs-params">file</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> fileReader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileReader</span>();
    <span class="hljs-keyword">const</span> spark = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SparkMD5</span>.<span class="hljs-title class_">ArrayBuffer</span>();
    <span class="hljs-keyword">let</span> chunkIndex = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> chunkSize = <span class="hljs-number">2097152</span>; <span class="hljs-comment">// 2MB</span>
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">loadNext</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">const</span> start = chunkIndex * chunkSize;
      <span class="hljs-keyword">const</span> end = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(start + chunkSize, file.<span class="hljs-property">size</span>);
      
      fileReader.<span class="hljs-title function_">readAsArrayBuffer</span>(file.<span class="hljs-title function_">slice</span>(start, end));
    };
    
    fileReader.<span class="hljs-property">onload</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      spark.<span class="hljs-title function_">append</span>(e.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>);
      chunkIndex++;
      
      <span class="hljs-keyword">if</span> (chunkIndex * chunkSize &lt; file.<span class="hljs-property">size</span>) {
        <span class="hljs-title function_">loadNext</span>(); <span class="hljs-comment">// ç»§ç»­è¯»å–ä¸‹ä¸€ä¸ªåˆ†ç‰‡</span>
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title function_">resolve</span>(spark.<span class="hljs-title function_">end</span>()); <span class="hljs-comment">// è¿”å›æœ€ç»ˆå“ˆå¸Œå€¼</span>
      }
    };
    
    <span class="hljs-title function_">loadNext</span>();
  });
}
</code></pre>
<h2 data-id="heading-4">ç¬¬äº”å±‚ï¼šåšå£«é˜¶æ®µ â€”â€” æ–­ç‚¹ç»­ä¼  (Resumable)</h2>
<p>å¦‚æœä¼ åˆ°ä¸€åŠæ–­ç½‘äº†ï¼Œå‰©ä¸‹çš„æ€ä¹ˆåŠï¼Ÿ</p>
<p><strong>æ–¹æ¡ˆ A</strong>ï¼šå‰ç«¯è®°å½•ï¼ˆä¸å¯é ï¼‰
<strong>æ–¹æ¡ˆ Bï¼ˆæ¨èï¼‰</strong>ï¼šåç«¯ MySQL è®°å½•å·²æ”¶åˆ°çš„åˆ†ç‰‡åºå·ã€‚</p>
<p><strong>æµç¨‹</strong>ï¼š</p>
<ol>
<li>é‡æ–°ä¸Šä¼ å‰ï¼Œè°ƒç”¨ checkChunks æ¥å£</li>
<li>åç«¯æŸ¥åº“è¿”å›ï¼š{ uploadedList: [1, 2, 5] }</li>
<li>å‰ç«¯è¿‡æ»¤æ‰å·²å­˜åœ¨çš„åºå·ï¼Œåªå‘å‰©ä¸‹çš„</li>
</ol>
<p><strong>ä¸ºä»€ä¹ˆé€‰æ‹©åç«¯è®°å½•ï¼Ÿ</strong></p>
<ul>
<li>å‰ç«¯å­˜å‚¨ä¸å¯é ï¼ˆlocalStorageå¯èƒ½è¢«æ¸…é™¤ï¼‰</li>
<li>æ”¯æŒè·¨è®¾å¤‡ç»­ä¼ ï¼ˆä»æ‰‹æœºä¸Šä¼ ä¸€åŠï¼Œä»ç”µè„‘ç»§ç»­ï¼‰</li>
<li>æ•°æ®ä¸€è‡´æ€§æ›´å¥½ï¼Œä¸å®¹æ˜“å‡ºç°è„æ•°æ®</li>
</ul>
<p><strong>æ–­ç‚¹ç»­ä¼ å®ç°</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ£€æŸ¥å·²ä¸Šä¼ åˆ†ç‰‡</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">checkUploadedChunks</span>(<span class="hljs-params">fileHash</span>) {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">checkChunks</span>({ fileHash });
  <span class="hljs-keyword">return</span> response.<span class="hljs-property">uploadedList</span> || []; <span class="hljs-comment">// å·²ä¸Šä¼ çš„åˆ†ç‰‡ç´¢å¼•æ•°ç»„</span>
}

<span class="hljs-comment">// è¿‡æ»¤æœªä¸Šä¼ çš„åˆ†ç‰‡</span>
<span class="hljs-keyword">const</span> uploadedList = <span class="hljs-keyword">await</span> <span class="hljs-title function_">checkUploadedChunks</span>(fileHash);
<span class="hljs-keyword">const</span> needUploadChunks = allChunks.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">chunk</span> =&gt;</span> 
  !uploadedList.<span class="hljs-title function_">includes</span>(chunk.<span class="hljs-property">index</span>)
);
</code></pre>
<h2 data-id="heading-5">ç¬¬å…­å±‚ï¼šæ€§èƒ½å·…å³° â€”â€” åªæœ‰ 1% çš„äººçŸ¥é“çš„ Worker è®¡ç®—</h2>
<p>æµè§ˆå™¨æ˜¯"å•çº¿ç¨‹"çš„ï¼ŒJavaScript å¼•æ“å’Œé¡µé¢æ¸²æŸ“ï¼ˆDOM æ ‘æ„å»ºã€å¸ƒå±€ã€ç»˜åˆ¶ï¼‰å…±ç”¨ä¸€ä¸ªçº¿ç¨‹ï¼Œå¦‚æœä½ åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œä¸€ä¸ªè€—æ—¶ 10 ç§’çš„å¾ªç¯ï¼ˆæ¯”å¦‚è®¡ç®—å¤§æ–‡ä»¶çš„ MD5ï¼‰ï¼Œæµè§ˆå™¨ä¼šç›´æ¥å¡æ­»ã€‚ç”¨æˆ·ç‚¹ä¸åŠ¨æŒ‰é’®ã€åŠ¨ç”»åœæ­¢ã€ç”šè‡³æµè§ˆå™¨å¼¹å‡º"é¡µé¢æ— å“åº”"ã€‚</p>
<p>å±å¹•åˆ·æ–°ç‡é€šå¸¸æ˜¯ 60Hzï¼Œæ„å‘³ç€æµè§ˆå™¨æ¯ 16.7ms å°±è¦æ¸²æŸ“ä¸€å¸§ã€‚å¦‚æœä½ çš„è®¡ç®—ä»»åŠ¡å æ®äº†è¿™ 16.7msï¼Œé¡µé¢å°±ä¼šæ‰å¸§ã€å¡é¡¿ã€‚</p>
<h3 data-id="heading-6">äºŒã€ ä»€ä¹ˆæ˜¯ Web Workerï¼Ÿï¼ˆå®šä¹‰ï¼‰</h3>
<p>Web Worker æ˜¯ HTML5 æ ‡å‡†å¼•å…¥çš„ä¸€é¡¹æŠ€æœ¯ï¼Œå®ƒå…è®¸ JavaScript è„šæœ¬åœ¨åå°çº¿ç¨‹ä¸­è¿è¡Œï¼Œä¸å ç”¨ä¸»çº¿ç¨‹ã€‚</p>
<p>å®ƒçš„åœ°ä½ï¼š å®ƒæ˜¯ä¸»çº¿ç¨‹çš„"æ‰“å·¥ä»”"ã€‚</p>
<p>å®ƒçš„ç¯å¢ƒï¼š å®ƒè¿è¡Œåœ¨å¦ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„ç¯å¢ƒä¸­ï¼Œæ‹¥æœ‰è‡ªå·±çš„å…¨å±€å¯¹è±¡ï¼ˆself è€Œä¸æ˜¯ windowï¼‰ã€‚</p>
<h3 data-id="heading-7">ä¸‰ã€ Web Worker èƒ½å¹²ä»€ä¹ˆï¼Ÿï¼ˆèŒè´£ä¸å±€é™ï¼‰</h3>
<p><strong>èƒ½å¹²ä»€ä¹ˆï¼š</strong></p>
<p>CPU å¯†é›†å‹è®¡ç®—ï¼š MD5 è®¡ç®—ã€åŠ å¯†è§£å¯†ã€å›¾åƒ/è§†é¢‘å¤„ç†ã€å¤§æ•°æ®æ’åºã€‚</p>
<p>ç½‘ç»œè¯·æ±‚ï¼š å¯ä»¥åœ¨åå°è½®è¯¢æ¥å£ã€‚</p>
<p><strong>ä¸èƒ½å¹²ä»€ä¹ˆï¼ˆé¢è¯•å¿…è€ƒç‚¹ï¼‰ï¼š</strong></p>
<p>ä¸èƒ½æ“ä½œ DOMï¼š å®ƒæ‹¿ä¸åˆ° windowã€documentã€parent å¯¹è±¡ã€‚</p>
<p>ä¸èƒ½å¼¹çª—ï¼š æ— æ³•ä½¿ç”¨ alert()ã€‚</p>
<p>å—é™é€šä¿¡ï¼š å®ƒå’Œä¸»çº¿ç¨‹ä¹‹é—´åªèƒ½é€šè¿‡ "æ¶ˆæ¯ä¼ é€’"ï¼ˆPostMessageï¼‰æ²Ÿé€šã€‚</p>
<h3 data-id="heading-8">å››ã€ æ€ä¹ˆå¹²ï¼Ÿï¼ˆæ ¸å¿ƒ API å®æˆ˜ï¼‰</h3>
<p>æˆ‘ä»¬è¦å®ç°çš„ç›®æ ‡æ˜¯ï¼šåœ¨ä¸å¡é¡¿é¡µé¢çš„æƒ…å†µä¸‹ï¼Œè®¡ç®—ä¸€ä¸ª 1GB æ–‡ä»¶çš„ MD5ã€‚</p>
<p><strong>æ­¥éª¤ 1ï¼šä¸»çº¿ç¨‹é€»è¾‘ï¼ˆVue/JS ç¯å¢ƒï¼‰</strong></p>
<p>ä¸»çº¿ç¨‹è´Ÿè´£é›‡ä½£ Workerï¼Œå¹¶ç»™å®ƒæ´¾æ´»ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 1. åˆ›å»º Worker å®ä¾‹ (è·¯å¾„æŒ‡å‘ worker è„šæœ¬)</span>
<span class="hljs-keyword">const</span> myWorker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'hash-worker.js'</span>);

<span class="hljs-comment">// 2. å‘é€ä»»åŠ¡ (æŠŠæ–‡ä»¶å¯¹è±¡ä¼ ç»™ Worker)</span>
myWorker.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">file</span>: fileObject });

<span class="hljs-comment">// 3. æ¥æ”¶ç»“æœ (ç›‘å¬ Worker å›ä¼ çš„æ¶ˆæ¯)</span>
myWorker.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { hash, percentage } = e.<span class="hljs-property">data</span>;
    <span class="hljs-keyword">if</span> (hash) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"è®¡ç®—å®Œæˆï¼MD5 ä¸º:"</span>, hash);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å½“å‰è¿›åº¦:"</span>, percentage);
    }
};

<span class="hljs-comment">// 4. å¼‚å¸¸å¤„ç†</span>
myWorker.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Worker æŠ¥é”™äº†:"</span>, err);
};
</code></pre>
<p><strong>æ­¥éª¤ 2ï¼šWorker çº¿ç¨‹é€»è¾‘ï¼ˆhash-worker.jsï¼‰</strong></p>
<p>Worker è´Ÿè´£åŸ‹å¤´è‹¦å¹²ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¼•å…¥è®¡ç®— MD5 çš„åº“ (Worker å†…éƒ¨å¼•ç”¨è„šæœ¬çš„æ–¹å¼)</span>
importScripts(<span class="hljs-string">'spark-md5.min.js'</span>);

self.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) {
    <span class="hljs-keyword">const</span> { file } = e.<span class="hljs-property">data</span>;
    <span class="hljs-keyword">const</span> spark = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SparkMD5</span>.<span class="hljs-title class_">ArrayBuffer</span>(); <span class="hljs-comment">// å¢é‡è®¡ç®—å®ä¾‹</span>
    <span class="hljs-keyword">const</span> reader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileReader</span>();
    <span class="hljs-keyword">const</span> chunkSize = <span class="hljs-number">2</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>; <span class="hljs-comment">// æ¯æ¬¡è¯» 2MB</span>
    <span class="hljs-keyword">let</span> currentChunk = <span class="hljs-number">0</span>;

    <span class="hljs-comment">// åˆ†å—è¯»å–çš„æ ¸å¿ƒé€»è¾‘</span>
    reader.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) {
        spark.<span class="hljs-title function_">append</span>(event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>); <span class="hljs-comment">// å°† 2MB æ•°æ®å–‚ç»™ spark</span>
        currentChunk++;

        <span class="hljs-keyword">if</span> (currentChunk &lt; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(file.<span class="hljs-property">size</span> / chunkSize)) {
            <span class="hljs-title function_">loadNext</span>(); <span class="hljs-comment">// ç»§ç»­è¯»ä¸‹ä¸€å—</span>
            <span class="hljs-comment">// åé¦ˆè¿›åº¦</span>
            self.<span class="hljs-title function_">postMessage</span>({ 
                <span class="hljs-attr">percentage</span>: (currentChunk / <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(file.<span class="hljs-property">size</span> / chunkSize) * <span class="hljs-number">100</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>) 
            });
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// å…¨éƒ¨è¯»å®Œï¼Œç”Ÿæˆæœ€ç»ˆ MD5</span>
            <span class="hljs-keyword">const</span> md5 = spark.<span class="hljs-title function_">end</span>();
            self.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">hash</span>: md5 }); <span class="hljs-comment">// å®Œå·¥ï¼Œå›ä¼ ç»“æœ</span>
        }
    };

    <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadNext</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">const</span> start = currentChunk * chunkSize;
        <span class="hljs-keyword">const</span> end = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(start + chunkSize, file.<span class="hljs-property">size</span>);
        <span class="hljs-comment">// å…³é”®ç‚¹ï¼šä½¿ç”¨ slice åˆ‡ç‰‡è¯»å–ï¼Œé¿å…ä¸€æ¬¡æ€§è¯»å…¥å†…å­˜</span>
        reader.<span class="hljs-title function_">readAsArrayBuffer</span>(file.<span class="hljs-title function_">slice</span>(start, end));
    }

    <span class="hljs-title function_">loadNext</span>(); <span class="hljs-comment">// å¼€å§‹ä»»åŠ¡</span>
};
</code></pre>
<h3 data-id="heading-9">äº”ã€ å…³é”®æ€è·¯è¿‡ç¨‹ï¼ˆç»™é¢è¯•å®˜è®²å‡ºæ·±åº¦ï¼‰</h3>
<p>å½“ä½ å‘é¢è¯•å®˜å¤è¿°è¿™ä¸ªè¿‡ç¨‹æ—¶ï¼Œè¦æŒ‰ç…§è¿™ä¸ªé€»è¾‘é“¾æ¡ï¼š</p>
<p><strong>å®ä¾‹åŒ–ï¼ˆNew Workerï¼‰ï¼š</strong></p>
<p>"é¦–å…ˆï¼Œæˆ‘é€šè¿‡ new Worker å¯åŠ¨ä¸€ä¸ªç‹¬ç«‹çº¿ç¨‹ï¼Œå°†è€—æ—¶çš„è®¡ç®—é€»è¾‘ä»ä¸»çº¿ç¨‹å‰¥ç¦»ã€‚"</p>
<p><strong>æ•°æ®ä¼ è¾“ï¼ˆPostMessageï¼‰ï¼š</strong></p>
<p>"ä¸»çº¿ç¨‹å°† File å¯¹è±¡å‘é€ç»™ Workerã€‚è¿™é‡Œè¦æ³¨æ„ï¼ŒFile å¯¹è±¡æ˜¯ File å¥æŸ„ï¼Œå‘é€å®ƒå¹¶ä¸ä¼šç¬é—´å æ®å¤§é‡å†…å­˜ï¼Œå› ä¸ºå®ƒæ˜¯åŸºäº Blob çš„ï¼Œæ˜¯æƒ°æ€§çš„ã€‚"</p>
<p><strong>åˆ†å—è¯»å–ä¸å¢é‡è®¡ç®—ï¼ˆChunked Hashingï¼‰ï¼š</strong></p>
<p>"è¿™æ˜¯æœ€æ ¸å¿ƒçš„ä¸€æ­¥ã€‚å³ä¾¿åœ¨ Worker å†…éƒ¨ï¼Œæˆ‘ä¹Ÿä¸èƒ½ç›´æ¥è¯»å–æ•´ä¸ªæ–‡ä»¶ï¼ˆæ¯”å¦‚ 5GB è¯»è¿›å†…å­˜ä¼šç›´æ¥è®© Worker è¿›ç¨‹æŒ‚æ‰ï¼‰ã€‚</p>
<p>æˆ‘ä½¿ç”¨äº† file.slice é…åˆ FileReaderï¼Œæ¯æ¬¡åªè¯»å– 2MB æ•°æ®ã€‚</p>
<p>é…åˆ spark-md5 çš„ append æ–¹æ³•ï¼Œå°†æ•°æ®'å–‚'ç»™è®¡ç®—å¼•æ“ï¼Œå¤„ç†å®Œåï¼Œä¹‹å‰çš„å†…å­˜å—ä¼šè¢«é‡Šæ”¾ã€‚"</p>
<p><strong>å¼‚æ­¥é€šä¿¡ï¼ˆMessagingï¼‰ï¼š</strong></p>
<p>"åœ¨è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä¸æ–­é€šè¿‡ self.postMessage å‘ä¸»çº¿ç¨‹å‘é€è®¡ç®—è¿›åº¦ï¼Œä»¥ä¾¿ç”¨æˆ·åœ¨ç•Œé¢ä¸Šèƒ½çœ‹åˆ°åŠ¨æ€çš„ç™¾åˆ†æ¯”ã€‚</p>
<p>æœ€åè®¡ç®—å®Œæˆï¼Œé€šè¿‡æ¶ˆæ¯å›ä¼ æœ€ç»ˆ MD5ã€‚"</p>
<h3 data-id="heading-10">å…­ã€ æ€»ç»“ï¼šæ ¸å¿ƒ API è®°äº‹æœ¬</h3>
<p>new Worker('path'): å¼€å¯æ‹›è˜ã€‚</p>
<p>postMessage(data): äº’å‘çŸ­ä¿¡ã€‚</p>
<p>onmessage: æ¥æ”¶çŸ­ä¿¡ã€‚</p>
<p>importScripts(): Worker å†…éƒ¨åŠ è½½æ’ä»¶ã€‚</p>
<p>file.slice(): ç‰©ç†ä¸Šçš„"åˆ‡ç‰‡"ï¼ŒMD5 ä¸å´©æºƒçš„ç§˜è¯€ã€‚</p>
<p>FileReader.readAsArrayBuffer(): å°†äºŒè¿›åˆ¶å†…å®¹è¯»å…¥å†…å­˜è¿›è¡Œè®¡ç®—ã€‚</p>
<h3 data-id="heading-11">ä¸ƒ. è°ˆ å†…å­˜ç®¡ç† (Memory Management)</h3>
<p><strong>é¢è¯•å®˜å¯èƒ½ä¼šé—®ï¼š</strong> "åœ¨Workerå†…éƒ¨å¦‚ä½•é¿å…å†…å­˜æº¢å‡ºï¼Ÿ"</p>
<p><strong>å›ç­”ï¼š</strong> "åœ¨ Worker å†…éƒ¨ï¼Œæˆ‘æ²¡æœ‰ä½¿ç”¨ fileReader.readAsArrayBuffer(file) ç›´æ¥è¯»å–æ•´ä¸ªæ–‡ä»¶ã€‚å› ä¸º 4GB çš„æ–‡ä»¶å¦‚æœç›´æ¥è¯»å…¥å†…å­˜ï¼ŒV8 å¼•æ“ä¼šç›´æ¥ OOM (Out of Memory) å´©æºƒã€‚æˆ‘é‡‡ç”¨äº† 'åˆ†å—è¯»å– -&gt; å¢é‡å“ˆå¸Œ' çš„ç­–ç•¥ã€‚åˆ©ç”¨ spark.append() æ¯æ¬¡åªå¤„ç† 2MB çš„æ•°æ®ï¼Œå¤„ç†å®Œå V8 çš„åƒåœ¾å›æ”¶æœºåˆ¶ä¼šè‡ªåŠ¨é‡Šæ”¾è¿™å—å†…å­˜ï¼Œä»è€Œå®ç°ç”¨æå°çš„å†…å­˜å¼€é”€å¤„ç†æå¤§çš„æ–‡ä»¶ã€‚"</p>
<h3 data-id="heading-12">å…«. è°ˆ æŠ½æ ·å“ˆå¸Œ (æ€§èƒ½æ€æ‰‹é”) â€”â€” åªæœ‰ 1% çš„äººçŸ¥é“çš„é»‘ç§‘æŠ€</h3>
<p><strong>é¢è¯•å®˜ï¼š</strong> "å¦‚æœæ–‡ä»¶ 100GBï¼ŒWorker è®¡ç®—ä¹Ÿè¦å¥½å‡ åˆ†é’Ÿï¼Œç”¨æˆ·ç­‰ä¸åŠæ€ä¹ˆåŠï¼Ÿ"</p>
<p><strong>ä½ çš„æ€æ‰‹é”ï¼š</strong> "å¦‚æœå¯¹å®Œæ•´æ€§æ ¡éªŒè¦æ±‚ä¸æ˜¯ 100% ä¸¥è‹›ï¼Œæˆ‘ä¼šé‡‡ç”¨ 'æŠ½æ ·å“ˆå¸Œ' æ–¹æ¡ˆï¼š</p>
<ul>
<li>æ–‡ä»¶å¤´ 2MB å…¨éƒ¨å–æ ·</li>
<li>æ–‡ä»¶å°¾ 2MB å…¨éƒ¨å–æ ·</li>
<li>ä¸­é—´éƒ¨åˆ†ï¼šæ¯éš”ä¸€æ®µè·ç¦»å–æ ·å‡ ä¸ªå­—èŠ‚</li>
</ul>
<p>è¿™æ · 10GB çš„æ–‡ä»¶æˆ‘ä¹Ÿåªéœ€è¦è®¡ç®— 10MB å·¦å³çš„æ•°æ®ï¼ŒMD5 è®¡ç®—ä¼šåœ¨ 1ç§’å†… å®Œæˆï¼Œé…åˆåç«¯æ ¡éªŒï¼Œèƒ½å®ç°'ç§’çº§'é¢„åˆ¤ï¼Œæå¤§æå‡ç”¨æˆ·ä½“éªŒã€‚"</p>
<h3 data-id="heading-13">D. æ€»ç»“ï¼šé¢è¯•åŠ åˆ†å…³é”®è¯</h3>
<ul>
<li><strong>å¢é‡è®¡ç®— (Incremental Hashing)</strong>ï¼šä¸æ˜¯ä¸€æ¬¡æ€§ç®—ï¼Œæ˜¯æ”’ç€ç®—</li>
<li><strong>Blob.slice</strong>ï¼šæ–‡ä»¶åˆ‡ç‰‡çš„æ ¸å¿ƒåº•å±‚ API</li>
<li><strong>éé˜»å¡ (Non-blocking)</strong>ï¼šWorker çš„æ ¸å¿ƒä»·å€¼</li>
<li><strong>OOM é¢„é˜²</strong>ï¼šé€šè¿‡åˆ†å—è¯»å–æ§åˆ¶å†…å­˜å³°å€¼</li>
<li><strong>æŠ½æ ·å“ˆå¸Œ</strong>ï¼šå¤§æ–‡ä»¶å¿«é€Ÿè¯†åˆ«çš„æœ‰æ•ˆæ‰‹æ®µ</li>
</ul>
<p>"å…¶å® Web Worker ä¹Ÿæœ‰å¼€é”€ï¼Œåˆ›å»ºå®ƒéœ€è¦æ—¶é—´å’Œå†…å­˜ã€‚å¯¹äºå‡ ç™¾ KB çš„å°æ–‡ä»¶ï¼Œç›´æ¥åœ¨ä¸»çº¿ç¨‹ç®—å¯èƒ½æ›´å¿«ï¼›ä½†å¯¹äºå¤§æ–‡ä»¶ä¸Šä¼ ï¼ŒWorker æ˜¯ä¿è¯ UI å“åº”æ€§ çš„å”¯ä¸€æ­£ç¡®è§£ã€‚"</p>
<h2 data-id="heading-14">ç¬¬ä¸ƒå±‚ï¼šNode.js åç«¯å‹æµ‹ â€”â€” ç¢ç‰‡åˆå¹¶çš„è‰ºæœ¯</h2>
<p>å½“ 1000 ä¸ªåˆ‡ç‰‡ä¼ ä¸Šæ¥ï¼ŒNode å¦‚ä½•é«˜æ•ˆåˆå¹¶ï¼Ÿ</p>
<p><strong>åˆçº§</strong>ï¼šfs.readFileSyncã€‚ ç¬é—´æ’‘çˆ†å†…å­˜ï¼ŒNode.jsï¼ˆV8ï¼‰é»˜è®¤å†…å­˜é™åˆ¶é€šå¸¸åœ¨ 1GB~2GB å·¦å³ã€‚æ‰§è¡Œ readFile åˆå¹¶å¤§æ–‡ä»¶ï¼ŒæœåŠ¡å™¨ä¼šç¬é—´ Crashã€‚</p>
<p><strong>é«˜çº§</strong>ï¼šfs.createReadStream å’Œ fs.createWriteStreamã€‚</p>
<p>åˆ©ç”¨"æµï¼ˆStreamï¼‰"çš„ç®¡é“æ¨¡å¼ï¼Œè¾¹è¯»è¾¹å†™ï¼Œå†…å­˜å ç”¨æä½ã€‚</p>
<h3 data-id="heading-15">ä¸€ã€ ä»€ä¹ˆæ˜¯ Streamï¼Ÿï¼ˆæœ¬è´¨å®šä¹‰ï¼‰</h3>
<p>æµï¼ˆStreamï¼‰æ˜¯ Node.js æä¾›çš„å¤„ç† æµå¼æ•°æ® çš„æŠ½è±¡æ¥å£ã€‚å®ƒå°†æ•°æ®åˆ†æˆä¸€å°å—ä¸€å°å—ï¼ˆBufferï¼‰ï¼Œåƒæµæ°´ä¸€æ ·ä»ä¸€å¤´æµå‘å¦ä¸€å¤´ã€‚</p>
<p>Readableï¼ˆå¯è¯»æµï¼‰ï¼š æ•°æ®çš„æºå¤´ï¼ˆå¦‚ï¼šåˆ†ç‰‡æ–‡ä»¶ï¼‰ã€‚</p>
<p>Writableï¼ˆå¯å†™æµï¼‰ï¼š æ•°æ®çš„ç»ˆç‚¹ï¼ˆå¦‚ï¼šæœ€ç»ˆåˆå¹¶çš„å¤§æ–‡ä»¶ï¼‰ã€‚</p>
<p>Pipeï¼ˆç®¡é“ï¼‰ï¼š è¿æ¥ä¸¤è€…çš„æ°´ç®¡ï¼Œæ•°æ®é€šè¿‡ç®¡é“è‡ªåŠ¨æµè¿‡å»ã€‚</p>
<h3 data-id="heading-16">äºŒã€ èƒ½å¹²ä»€ä¹ˆï¼Ÿ</h3>
<p>åœ¨æ–‡ä»¶ä¸Šä¼ åœºæ™¯ä¸­ï¼Œå®ƒèƒ½ï¼š</p>
<p>ä½å†…å­˜åˆå¹¶ï¼š æ— è®ºæ–‡ä»¶å¤šå¤§ï¼ˆ1G æˆ– 100Gï¼‰ï¼Œå†…å­˜å ç”¨å§‹ç»ˆç¨³å®šåœ¨å‡ å MBã€‚</p>
<p>è¾¹è¯»è¾¹å†™ï¼š è¯»å…¥ä¸€å°å—åˆ†ç‰‡ï¼Œç«‹å³å†™å…¥ç›®æ ‡æ–‡ä»¶ï¼Œä¸éœ€è¦ç­‰å¾…æ•´ä¸ªåˆ†ç‰‡è¯»å®Œã€‚</p>
<p>è‡ªåŠ¨èƒŒå‹å¤„ç†ï¼ˆBackpressureï¼‰ï¼š å¦‚æœå†™çš„é€Ÿåº¦æ…¢ï¼Œè¯»çš„é€Ÿåº¦å¿«ï¼Œç®¡é“ä¼šè‡ªåŠ¨è®©è¯»å–æ…¢ä¸‹æ¥ï¼Œé˜²æ­¢å†…å­˜ç§¯å‹ã€‚</p>
<h3 data-id="heading-17">ä¸‰ã€ æ€ä¹ˆå¹²ï¼Ÿï¼ˆæ ¸å¿ƒ API ä¸å®æˆ˜ï¼‰</h3>
<p><strong>1. æ ¸å¿ƒ API è®°äº‹æœ¬</strong></p>
<p>fs.createReadStream(path)ï¼šåˆ›å»ºä¸€ä¸ªæŒ‡å‘åˆ†ç‰‡æ–‡ä»¶çš„æ°´é¾™å¤´ã€‚</p>
<p>fs.createWriteStream(path, { flags: 'a' })ï¼šåˆ›å»ºä¸€ä¸ªæŒ‡å‘ç›®æ ‡æ–‡ä»¶çš„æ¥æ”¶æ¡¶ã€‚flags: 'a' è¡¨ç¤ºè¿½åŠ å†™å…¥ï¼ˆAppendï¼‰ã€‚</p>
<p>reader.pipe(writer)ï¼šæŠŠæ°´é¾™å¤´æ¥åˆ°æ¡¶ä¸Šã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-comment">/**
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} targetFile æœ€ç»ˆæ–‡ä»¶å­˜æ”¾è·¯å¾„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">string</span>} chunkDir åˆ†ç‰‡ä¸´æ—¶å­˜æ”¾ç›®å½•
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} chunkCount åˆ†ç‰‡æ€»æ•°
 */</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">mergeFileChunks</span>(<span class="hljs-params">targetFile, chunkDir, chunkCount</span>) {
    <span class="hljs-comment">// 1. åˆ›å»ºä¸€ä¸ªå¯å†™æµï¼Œå‡†å¤‡å†™å…¥æœ€ç»ˆæ–‡ä»¶</span>
    <span class="hljs-comment">// flags: 'a' è¡¨ç¤ºè¿½åŠ æ¨¡å¼ï¼Œå¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œå°±åœ¨æœ«å°¾æ¥ç€å†™</span>
    <span class="hljs-keyword">const</span> writeStream = fs.<span class="hljs-title function_">createWriteStream</span>(targetFile, { <span class="hljs-attr">flags</span>: <span class="hljs-string">'a'</span> });

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; chunkCount; i++) {
        <span class="hljs-keyword">const</span> chunkPath = path.<span class="hljs-title function_">join</span>(chunkDir, <span class="hljs-string">`<span class="hljs-subst">${i}</span>.part`</span>);
        
        <span class="hljs-comment">// 2. ä¾æ¬¡è¯»å–æ¯ä¸ªåˆ†ç‰‡</span>
        <span class="hljs-keyword">const</span> readStream = fs.<span class="hljs-title function_">createReadStream</span>(chunkPath);

        <span class="hljs-comment">// 3. æ ¸å¿ƒï¼šé€šè¿‡ Promise å°è£…ï¼Œç¡®ä¿"æŒ‰é¡ºåº"åˆå¹¶</span>
        <span class="hljs-comment">// å¿…é¡»ç­‰ç¬¬ 0 ç‰‡åˆå®Œäº†ï¼Œæ‰èƒ½åˆç¬¬ 1 ç‰‡ï¼Œå¦åˆ™æ–‡ä»¶å†…å®¹ä¼šé”™ä¹±</span>
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
            <span class="hljs-comment">// å°†è¯»å–æµçš„å†…å®¹å¯¼å‘å†™å…¥æµ</span>
            <span class="hljs-comment">// æ³¨æ„ï¼šend: false è¡¨ç¤ºè¯»å®Œè¿™ä¸€ä¸ªåˆ†ç‰‡åï¼Œä¸è¦å…³é—­ç›®æ ‡æ–‡ä»¶å†™å…¥æµ</span>
            readStream.<span class="hljs-title function_">pipe</span>(writeStream, { <span class="hljs-attr">end</span>: <span class="hljs-literal">false</span> });
            
            readStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">'end'</span>, <span class="hljs-function">() =&gt;</span> {
                <span class="hljs-comment">// è¯»å–å®Œåï¼Œåˆ é™¤è¿™ä¸ªä¸´æ—¶åˆ†ç‰‡ï¼ˆèŠ‚çœç©ºé—´ï¼‰</span>
                fs.<span class="hljs-title function_">unlinkSync</span>(chunkPath); 
                <span class="hljs-title function_">resolve</span>();
            });
            
            readStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
                <span class="hljs-title function_">reject</span>(err);
            });
        });
    }

    <span class="hljs-comment">// 4. æ‰€æœ‰åˆ†ç‰‡è¯»å®Œäº†ï¼Œæ‰‹åŠ¨å…³é—­å†™å…¥æµ</span>
    writeStream.<span class="hljs-title function_">end</span>();
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"åˆå¹¶å®Œæˆï¼"</span>);
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆç”¨Streamè€Œä¸æ˜¯readFileSyncï¼Ÿ</strong></p>
<ul>
<li>readFileSyncä¼šå°†æ•´ä¸ªæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ï¼Œå¤§æ–‡ä»¶ä¼šçˆ†å†…å­˜</li>
<li>Streamæ˜¯æµå¼å¤„ç†ï¼Œå†…å­˜å ç”¨å›ºå®š</li>
<li>æ€§èƒ½æ›´å¥½ï¼Œé€‚åˆå¤„ç†å¤§æ–‡ä»¶</li>
</ul>
<p><strong>åŠæ‰“é¢è¯•å®˜ï¼š</strong></p>
<p>"åœ¨å¤§æ–‡ä»¶åˆå¹¶çš„å¤„ç†ä¸Šï¼Œæˆ‘ç»å¯¹ä¸ä¼šä½¿ç”¨ fs.readFileSyncã€‚æˆ‘ä¼šä½¿ç”¨ Node.js çš„ Stream APIã€‚</p>
<p>å…·ä½“çš„å®ç°æ€è·¯æ˜¯ï¼š</p>
<p>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ª WriteStream æŒ‡å‘æœ€ç»ˆæ–‡ä»¶ã€‚</p>
<p>ç„¶åï¼Œéå†æ‰€æœ‰åˆ†ç‰‡ï¼Œé€šè¿‡ createReadStream é€ä¸ªè¯»å–ã€‚</p>
<p>å…³é”®ç‚¹åœ¨äºåˆ©ç”¨ pipe ç®¡é“å°†è¯»æµå¯¼å‘å†™æµã€‚ä¸ºäº†ä¿è¯æ–‡ä»¶çš„æ­£ç¡®æ€§ï¼Œæˆ‘ä¼šé€šè¿‡ Promise åŒ…è£…å®ç°ä¸²è¡Œåˆå¹¶ã€‚åŒæ—¶ï¼Œè®¾ç½® pipe çš„ end å‚æ•°ä¸º falseï¼Œç¡®ä¿å†™å…¥æµåœ¨åˆå¹¶è¿‡ç¨‹ä¸­ä¸è¢«æå‰å…³é—­ã€‚</p>
<p>è¿™ç§åšæ³•çš„ä¼˜åŠ¿åœ¨äºï¼šåˆ©ç”¨äº† Stream çš„èƒŒå‹æœºåˆ¶ï¼Œå†…å­˜å ç”¨æä½ï¼ˆé€šå¸¸åªæœ‰å‡ å KBï¼‰ï¼Œå³ä¾¿æ˜¯åœ¨ä½é…ç½®çš„æœåŠ¡å™¨ä¸Šï¼Œä¹Ÿèƒ½ç¨³å®šåˆå¹¶å‡ å GB çš„å¤§æ–‡ä»¶ã€‚"</p>
<h2 data-id="heading-18">ç¬¬å…«å±‚ï¼šMySQL è¡¨ç»“æ„è®¾è®¡ (å®æˆ˜æ¶æ„)</h2>
<p>ä½ éœ€è¦ä¸¤å¼ è¡¨æ¥æ”¯æ’‘è¿™ä¸ªç³»ç»Ÿï¼š</p>
<p><strong>æ–‡ä»¶è¡¨ (Files)</strong>ï¼šid, file_md5, file_name, file_url, status(0:ä¸Šä¼ ä¸­, 1:å·²å®Œæˆ)ã€‚
<strong>åˆ‡ç‰‡è®°å½•è¡¨ (Chunks)</strong>ï¼šid, file_md5, chunk_index, chunk_nameã€‚</p>
<p><strong>æŸ¥è¯¢ä¼˜åŒ–</strong>ï¼šç»™ file_md5 åŠ å”¯ä¸€ç´¢å¼•ï¼Œæå¤§æå‡æŸ¥è¯¢é€Ÿåº¦ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æ–‡ä»¶ä¸»è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> files (
  id <span class="hljs-type">INT</span> AUTO_INCREMENT <span class="hljs-keyword">PRIMARY</span> KEY,
  file_md5 <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">UNIQUE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'æ–‡ä»¶MD5'</span>,
  file_name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'åŸå§‹æ–‡ä»¶å'</span>,
  file_size <span class="hljs-type">BIGINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'æ–‡ä»¶å¤§å°(å­—èŠ‚)'</span>,
  file_url <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">500</span>) COMMENT <span class="hljs-string">'å­˜å‚¨è·¯å¾„'</span>,
  status TINYINT <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span> COMMENT <span class="hljs-string">'çŠ¶æ€:0-ä¸Šä¼ ä¸­,1-å·²å®Œæˆ'</span>,
  upload_time <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
  INDEX idx_file_md5 (file_md5)
);

<span class="hljs-comment">-- åˆ†ç‰‡è®°å½•è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> chunks (
  id <span class="hljs-type">INT</span> AUTO_INCREMENT <span class="hljs-keyword">PRIMARY</span> KEY,
  file_md5 <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  chunk_index <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'åˆ†ç‰‡ç´¢å¼•'</span>,
  chunk_name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'åˆ†ç‰‡æ–‡ä»¶å'</span>,
  upload_status TINYINT <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span> COMMENT <span class="hljs-string">'ä¸Šä¼ çŠ¶æ€'</span>,
  created_at <span class="hljs-type">TIMESTAMP</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
  <span class="hljs-keyword">FOREIGN</span> KEY (file_md5) <span class="hljs-keyword">REFERENCES</span> files(file_md5),
  INDEX idx_file_chunk (file_md5, chunk_index)
);
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆfile_md5è¦åŠ ç´¢å¼•ï¼Ÿ</strong></p>
<ul>
<li>ç§’ä¼ æŸ¥è¯¢æ—¶éœ€è¦å¿«é€Ÿå®šä½æ–‡ä»¶æ˜¯å¦å­˜åœ¨</li>
<li>æ–­ç‚¹ç»­ä¼ æ—¶éœ€è¦å¿«é€Ÿè·å–æŸä¸ªæ–‡ä»¶çš„æ‰€æœ‰åˆ†ç‰‡</li>
<li>æå‡æŸ¥è¯¢æ€§èƒ½ï¼Œé¿å…å…¨è¡¨æ‰«æ</li>
</ul>
<h3 data-id="heading-19">ä¸€ã€ ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆå»ºè¡¨ï¼Ÿï¼ˆæ ¸å¿ƒç—›ç‚¹ï¼‰</h3>
<p>å¦‚æœä¸å­˜æ•°æ®åº“ï¼Œåªå­˜æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œä½ ä¼šé¢ä¸´ä¸‰ä¸ªæ­»ç©´ï¼š</p>
<p>æ–­ç‚¹ç»­ä¼ æ²¡ä¾æ®ï¼š ç”¨æˆ·åˆ·æ–°ç½‘é¡µï¼Œå‰ç«¯å†…å­˜ä¸¢äº†ï¼Œæ€ä¹ˆçŸ¥é“å“ªäº›ç‰‡ä¼ è¿‡ï¼Ÿå¿…é¡»æŸ¥åº“ã€‚</p>
<p>ç§’ä¼ æ— æ³•å®ç°ï¼š 10GB çš„æ–‡ä»¶ï¼Œæ€ä¹ˆç¬é—´åˆ¤æ–­æœåŠ¡å™¨æœ‰æ²¡æœ‰ï¼Ÿå…¨ç›˜æ‰«æç‰©ç†æ–‡ä»¶ï¼Ÿå¤ªæ…¢ï¼å¿…é¡»æŸ¥ç´¢å¼•ã€‚</p>
<p>å¹¶å‘åˆå¹¶é£é™©ï¼š å¤šä¸ªè¯·æ±‚åŒæ—¶è§¦å‘åˆå¹¶é€»è¾‘æ€ä¹ˆåŠï¼Ÿéœ€è¦æ•°æ®åº“çš„çŠ¶æ€é”ï¼ˆStatusï¼‰æ¥æ§åˆ¶ã€‚</p>
<h3 data-id="heading-20">äºŒã€ è¡¨ç»“æ„è¯¦è§£ï¼šå®ƒä»¬å„å¸å…¶èŒ</h3>
<p><strong>1. æ–‡ä»¶å…ƒæ•°æ®è¡¨ (files) â€”â€” "èº«ä»½è¯"</strong></p>
<p>file_md5 (æ ¸å¿ƒ)ï¼š è¿™æ˜¯æ–‡ä»¶çš„å”¯ä¸€ç‰©ç†æ ‡è¯†ã€‚ä¸ç®¡æ–‡ä»¶åå«"é«˜æ¸….mp4"è¿˜æ˜¯"å­¦ä¹ èµ„æ–™.avi"ï¼Œåªè¦å†…å®¹ä¸€æ ·ï¼ŒMD5 å°±ä¸€æ ·ã€‚</p>
<p>statusï¼š æ ‡è®°æ–‡ä»¶çŠ¶æ€ã€‚</p>
<p>0 (Uploading): è¿˜æ²¡ä¼ å®Œæˆ–æ­£åœ¨åˆå¹¶ã€‚</p>
<p>1 (Completed): å·²ç»åˆå¹¶æˆåŠŸï¼Œå¯ä»¥ç›´æ¥è®¿é—®ã€‚</p>
<p>file_urlï¼š æœ€ç»ˆåˆå¹¶åçš„è®¿é—®è·¯å¾„ã€‚</p>
<p><strong>2. åˆ‡ç‰‡è®°å½•è¡¨ (chunks) â€”â€” "è¿›åº¦è¡¨"</strong></p>
<p>chunk_indexï¼š è®°å½•è¿™æ˜¯ç¬¬å‡ ä¸ªåˆ†ç‰‡ã€‚</p>
<p>å…³ç³»ï¼š é€šè¿‡ file_md5 å…³è”ã€‚ä¸€ä¸ª files è®°å½•å¯¹åº”å¤šä¸ª chunks è®°å½•ã€‚</p>
<h3 data-id="heading-21">ä¸‰ã€ æ€ä¹ˆå»ºç«‹è”ç³»ï¼Ÿï¼ˆé€»è¾‘å…³è”å›¾ï¼‰</h3>
<p>ä¸€å¯¹å¤šå…³ç³»ï¼š</p>
<p>files.file_md5 (1) &lt;â€”â€”â€”â€”&gt; chunks.file_md5 (N)</p>
<p><strong>ç§’ä¼ é€»è¾‘ï¼š</strong></p>
<p>å‰ç«¯ä¼  MD5 ç»™åç«¯ã€‚</p>
<p>SQL: SELECT file_url FROM files WHERE file_md5 = 'xxx' AND status = 1;</p>
<p>ç»“æœï¼š æœ‰è®°å½•ï¼Ÿç›´æ¥è¿”å› URLï¼ˆç§’ä¼ æˆåŠŸï¼‰ã€‚æ²¡è®°å½•ï¼Ÿè¿›å…¥ä¸‹ä¸€æ­¥ã€‚</p>
<p><strong>ç»­ä¼ é€»è¾‘ï¼š</strong></p>
<p>å‰ç«¯é—®ï¼š"è¿™ä¸ª MD5 æˆ‘ä¼ äº†å¤šå°‘äº†ï¼Ÿ"</p>
<p>SQL: SELECT chunk_index FROM chunks WHERE file_md5 = 'xxx';</p>
<p>ç»“æœï¼š åç«¯è¿”å› [0, 1, 2, 5]ï¼Œå‰ç«¯å‘ç°å°‘äº† 3 å’Œ 4ï¼Œäºæ˜¯åªè¡¥ä¼  3 å’Œ 4ã€‚</p>
<h3 data-id="heading-22">å››ã€ å…³é”®æ€è·¯ä¸å®æˆ˜ SQL</h3>
<p><strong>1. ä¸ºä»€ä¹ˆåŠ å”¯ä¸€ç´¢å¼•ï¼ˆUnique Indexï¼‰ï¼Ÿ</strong></p>
<p>file_md5 å¿…é¡»æ˜¯ UNIQUEã€‚</p>
<p>é¢è¯•ç‚¹ï¼š "æˆ‘ç»™ file_md5 åŠ äº†å”¯ä¸€ç´¢å¼•ï¼Œè¿™ä¸ä»…æ˜¯ä¸ºäº†æŸ¥è¯¢å¿«ï¼Œæ›´æ˜¯ä¸€ç§ä¸šåŠ¡å…œåº•ã€‚åœ¨é«˜å¹¶å‘ä¸‹ï¼Œå¦‚æœä¸¤ä¸ªç”¨æˆ·åŒæ—¶ä¸Šä¼ åŒä¸€ä¸ªæ–‡ä»¶ï¼Œæ•°æ®åº“çš„å”¯ä¸€çº¦æŸèƒ½é˜²æ­¢äº§ç”Ÿä¸¤æ¡é‡å¤çš„æ–‡ä»¶è®°å½•ã€‚"</p>
<p><strong>2. å¤åˆç´¢å¼•ä¼˜åŒ–</strong></p>
<p>åœ¨ chunks è¡¨ï¼Œæˆ‘å»ºè®®å»ºç«‹å¤åˆç´¢å¼•ï¼šINDEX idx_md5_index (file_md5, chunk_index)ã€‚</p>
<p>åŸå› ï¼š ç»­ä¼ æŸ¥è¯¢æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸è¦æŸ¥"æŸä¸ª MD5 ä¸‹çš„ç´¢å¼•æƒ…å†µ"ï¼Œå¤åˆç´¢å¼•èƒ½è®©è¿™ç§æœç´¢è¾¾åˆ°æ¯«ç§’çº§ã€‚</p>
<h3 data-id="heading-23">äº”ã€ å…¨æµç¨‹æ¼”ç»ƒï¼ˆæ€ä¹ˆå¹²ï¼‰</h3>
<p><strong>ç¬¬ä¸€æ­¥ï¼šåˆå§‹åŒ– (Pre-check)</strong></p>
<p>ç”¨æˆ·é€‰å¥½æ–‡ä»¶ï¼Œè®¡ç®— MD5ï¼Œå‘ç»™åç«¯ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å°è¯•æ’å…¥ä¸»è¡¨ï¼Œå¦‚æœ MD5 å·²å­˜åœ¨åˆ™å¿½ç•¥ï¼ˆæˆ–è¿”å›å·²å­˜åœ¨è®°å½•ï¼‰</span>
<span class="hljs-keyword">INSERT</span> IGNORE <span class="hljs-keyword">INTO</span> files (file_md5, file_name, file_size, status) 
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'abc123hash'</span>, <span class="hljs-string">'video.mp4'</span>, <span class="hljs-number">102400</span>, <span class="hljs-number">0</span>);
</code></pre>
<p><strong>ç¬¬äºŒæ­¥ï¼šåˆ†ç‰‡ä¸Šä¼  (Chunk Upload)</strong></p>
<p>æ¯æ”¶åˆ°ä¸€ä¸ªç‰‡ï¼Œå­˜å…¥ chunks è¡¨ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- è®°å½•å·²æ”¶åˆ°çš„åˆ†ç‰‡</span>
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> chunks (file_md5, chunk_index, chunk_name) 
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'abc123hash'</span>, <span class="hljs-number">0</span>, <span class="hljs-string">'abc123hash_0.part'</span>);
</code></pre>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šåˆå¹¶è§¦å‘ (Merge)</strong></p>
<p>å‰ç«¯å‘åˆå¹¶æŒ‡ä»¤ï¼Œåç«¯æ ¡éªŒåˆ†ç‰‡æ•°é‡ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æ£€æŸ¥åˆ†ç‰‡æ˜¯å¦é½å…¨</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> chunks <span class="hljs-keyword">WHERE</span> file_md5 <span class="hljs-operator">=</span> <span class="hljs-string">'abc123hash'</span>;
<span class="hljs-comment">-- å¦‚æœ Count == æ€»ç‰‡æ•°ï¼Œå¼€å§‹ Stream åˆå¹¶</span>
</code></pre>
<p><strong>ç¬¬å››æ­¥ï¼šå®Œå·¥ (Finish)</strong></p>
<p>åˆå¹¶æˆåŠŸï¼Œæ›´æ–°ä¸»è¡¨ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æ›´æ–°çŠ¶æ€å’Œæœ€ç»ˆè·¯å¾„</span>
<span class="hljs-keyword">UPDATE</span> files <span class="hljs-keyword">SET</span> status <span class="hljs-operator">=</span> <span class="hljs-number">1</span>, file_url <span class="hljs-operator">=</span> <span class="hljs-string">'/uploads/2023/video.mp4'</span> 
<span class="hljs-keyword">WHERE</span> file_md5 <span class="hljs-operator">=</span> <span class="hljs-string">'abc123hash'</span>;
</code></pre>
<h3 data-id="heading-24">å…­ã€ æ€»ç»“è¯æœ¯ï¼ˆåŠæ‰“é¢è¯•å®˜ç‰ˆï¼‰</h3>
<p>"æˆ‘çš„æ•°æ®åº“è®¾è®¡æ ¸å¿ƒæ€è·¯æ˜¯ 'å†…å®¹æ ‡è¯†èƒœäºæ–‡ä»¶æ ‡è¯†'ã€‚</p>
<p>æˆ‘é€šè¿‡ files è¡¨å­˜å‚¨æ–‡ä»¶çš„ MD5 å’Œå…¨å±€çŠ¶æ€ï¼Œé…åˆ UNIQUE ç´¢å¼•å®ç°ç§’ä¼ çš„å¿«é€Ÿæ£€ç´¢å’Œå¹¶å‘æ§åˆ¶ã€‚</p>
<p>é€šè¿‡ chunks è¡¨è®°å½•æ¯ä¸€ä¸ªåˆ†ç‰‡çš„åˆ°è¾¾çŠ¶æ€ï¼Œå®ç°æ–­ç‚¹ç»­ä¼ ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„ç»†èŠ‚æ˜¯ï¼š</p>
<p>æˆ‘ä½¿ç”¨äº† BIGINT æ¥å­˜å‚¨ file_sizeï¼Œå› ä¸º 4GB ä»¥ä¸Šçš„æ–‡ä»¶ INT ä¼šæº¢å‡ºã€‚</p>
<p>æˆ‘ç»™ file_md5 åšäº†ç´¢å¼•ä¼˜åŒ–ï¼Œç¡®ä¿åœ¨ç™¾ä¸‡çº§æ–‡ä»¶è®°å½•ä¸­ï¼Œæ ¡éªŒæ–‡ä»¶çŠ¶æ€ä¾ç„¶æ˜¯ O(1) çš„å¤æ‚åº¦ã€‚</p>
<p>åˆå¹¶é€»è¾‘å®Œæˆåï¼Œæˆ‘ä¼šé€šè¿‡äº‹åŠ¡æˆ–çŠ¶æ€é”æ›´æ–° status å­—æ®µï¼Œç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§ã€‚"</p>
<h2 data-id="heading-25">ç¬¬ä¹å±‚ï¼šä¸Šå¸è§†è§’ â€”â€” å¹¶å‘æ§åˆ¶ (Concurrency Control)</h2>
<p>è¿™ä¸€å±‚æ˜¯é¢è¯•ä¸­çš„é«˜å…‰æ—¶åˆ»ã€‚å¦‚æœè¯´ MD5 æ˜¯ä¸ºäº†"å‡†ç¡®"ï¼ŒStream æ˜¯ä¸ºäº†"ç¨³å¥"ï¼Œé‚£ä¹ˆå¹¶å‘æ§åˆ¶å°±æ˜¯ä¸ºäº†"å¹³è¡¡"ã€‚</p>
<p>å¦‚æœä¸€ä¸ªæ–‡ä»¶åˆ‡äº† 1000 ç‰‡ï¼Œæµè§ˆå™¨ç¬é—´å‘å‡º 1000 ä¸ªè¯·æ±‚ï¼Œä¼šå¯¼è‡´æµè§ˆå™¨å´©æºƒæˆ–æœåŠ¡å™¨å®•æœºã€‚</p>
<p><strong>é¢è¯•åŠ åˆ†é¡¹</strong>ï¼šå¼‚æ­¥å¹¶å‘é™åˆ¶é˜Ÿåˆ—ã€‚</p>
<p>é™åˆ¶åŒæ—¶åªæœ‰ 6 ä¸ªè¯·æ±‚åœ¨è·‘ï¼ˆChrome çš„é»˜è®¤é™åˆ¶ï¼‰ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendRequest</span>(<span class="hljs-params">tasks, limit = <span class="hljs-number">6</span></span>) {
    <span class="hljs-keyword">const</span> pool = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> task <span class="hljs-keyword">of</span> tasks) {
        <span class="hljs-keyword">const</span> promise = <span class="hljs-title function_">task</span>();
        pool.<span class="hljs-title function_">add</span>(promise);
        promise.<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> pool.<span class="hljs-title function_">delete</span>(promise));
        <span class="hljs-keyword">if</span> (pool.<span class="hljs-property">size</span> &gt;= limit) <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>(pool);
    }
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆé™åˆ¶6ä¸ªå¹¶å‘ï¼Ÿ</strong></p>
<ul>
<li>æµè§ˆå™¨å¯¹åŒä¸€åŸŸåæœ‰æœ€å¤§è¿æ¥æ•°é™åˆ¶ï¼ˆé€šå¸¸ä¸º6ï¼‰</li>
<li>é¿å…è¿‡å¤šHTTPè¯·æ±‚å¯¼è‡´ç½‘ç»œæ‹¥å µ</li>
<li>å¹³è¡¡ä¸Šä¼ é€Ÿåº¦å’Œç³»ç»Ÿç¨³å®šæ€§</li>
</ul>
<h3 data-id="heading-26">ä¸€ã€ ä¸ºä»€ä¹ˆè¦æå¹¶å‘æ§åˆ¶ï¼Ÿï¼ˆç—›ç‚¹ï¼‰</h3>
<ol>
<li>
<p>æµè§ˆå™¨"è‡ªä¿"æœºåˆ¶ï¼š
Chrome æµè§ˆå™¨å¯¹åŒä¸€ä¸ªåŸŸåçš„ HTTP è¿æ¥æ•°æœ‰é™åˆ¶ï¼ˆé€šå¸¸æ˜¯ 6 ä¸ªï¼‰ã€‚
å¦‚æœä½ ç¬é—´å‘èµ· 1000 ä¸ªè¯·æ±‚ï¼Œå‰©ä¸‹çš„ 994 ä¸ªä¼šå¤„äº Pendingï¼ˆæ’é˜Ÿï¼‰çŠ¶æ€ã€‚è™½ç„¶ä¸ä¼šç›´æ¥å´©æºƒï¼Œä½†ä¼šé˜»å¡è¯¥åŸŸåçš„å…¶ä»–æ‰€æœ‰è¯·æ±‚ï¼ˆæ¯”å¦‚ä½ åŒæ—¶æƒ³åŠ è½½ä¸€å¼ å›¾ç‰‡ï¼Œéƒ½è¦æ’åœ¨ 900 å¤šä¸ªåˆ‡ç‰‡åé¢ï¼‰ã€‚</p>
</li>
<li>
<p>å†…å­˜ä¸æ€§èƒ½å‹åŠ›ï¼š
å‰ç«¯ï¼š 1000 ä¸ª Promise å¯¹è±¡è¢«åˆ›å»ºï¼Œä¼šç¬é—´åƒæ‰å¤§é‡å†…å­˜ã€‚
åç«¯ï¼ˆNodeï¼‰ï¼š æœåŠ¡å™¨ç¬é—´æ¥æ”¶ 1000 ä¸ªå¹¶å‘è¿æ¥ï¼Œç£ç›˜ IO ä¼šè¢«å æ»¡ï¼ŒCPU å¯èƒ½ä¼šé£™å‡ï¼Œç”šè‡³è§¦å‘æœåŠ¡å™¨çš„æ‹’ç»æœåŠ¡ä¿æŠ¤ã€‚</p>
</li>
</ol>
<h3 data-id="heading-27">äºŒã€ ä»€ä¹ˆæ˜¯å¹¶å‘æ§åˆ¶ï¼Ÿï¼ˆæœ¬è´¨å®šä¹‰ï¼‰</h3>
<p>å¹¶å‘æ§åˆ¶ï¼ˆConcurrency Controlï¼‰ å°±åƒæ˜¯ä¸€ä¸ª"åå­—è·¯å£çš„çº¢ç»¿ç¯"æˆ–è€…"é“¶è¡Œçš„æ’å·æœº"ã€‚</p>
<p>å®ƒä¸æ”¹å˜ä»»åŠ¡æ€»é‡ã€‚</p>
<p>å®ƒæ§åˆ¶åŒä¸€æ—¶åˆ»æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡æ•°é‡ã€‚</p>
<h3 data-id="heading-28">ä¸‰ã€ æ€ä¹ˆå¹²ï¼Ÿï¼ˆæ ¸å¿ƒé€»è¾‘å…¬å¼ï¼‰</h3>
<p>æˆ‘ä»¬è¦å®ç°ä¸€ä¸ª"å·¥ä½œæ± ï¼ˆPoolï¼‰"ï¼Œé€»è¾‘å¦‚ä¸‹ï¼š</p>
<p>å¡«æ»¡ï¼š å…ˆä¸€æ¬¡æ€§å‘å‡º limitï¼ˆæ¯”å¦‚ 6 ä¸ªï¼‰ä¸ªè¯·æ±‚ã€‚</p>
<p>æ¥æ›¿ï¼š åªè¦è¿™ 6 ä¸ªè¯·æ±‚ä¸­ä»»ä½•ä¸€ä¸ªå®Œæˆäº†ï¼Œç©ºå‡ºä¸€ä¸ªä½å­ï¼Œå°±ç«‹åˆ»è¡¥ä¸Šç¬¬ 7 ä¸ªã€‚</p>
<p>å¾ªç¯ï¼š å§‹ç»ˆä¿æŒæœ‰ 6 ä¸ªè¯·æ±‚åœ¨è·‘ï¼Œç›´åˆ° 1000 ä¸ªå…¨éƒ¨å‘å®Œã€‚</p>
<h3 data-id="heading-29">å››ã€ ä»£ç è¯¦è§£ï¼šè¿™ 10 è¡Œä»£ç å€¼ 5k è–ªèµ„</h3>
<p>è¿™æ˜¯åˆ©ç”¨ Promise.race å®ç°çš„æå…¶ç²¾å¦™çš„æ–¹æ¡ˆã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">Array</span>} <span class="hljs-variable">tasks</span> - æ‰€æœ‰çš„ä¸Šä¼ ä»»åŠ¡ï¼ˆå‡½æ•°æ•°ç»„ï¼Œæ‰§è¡Œå‡½æ•°æ‰å‘è¯·æ±‚ï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">limit</span> - æœ€å¤§å¹¶å‘æ•°
 */</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendRequest</span>(<span class="hljs-params">tasks, limit = <span class="hljs-number">6</span></span>) {
    <span class="hljs-keyword">const</span> pool = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(); <span class="hljs-comment">// æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡æ± </span>
    <span class="hljs-keyword">const</span> results = [];     <span class="hljs-comment">// å­˜å‚¨æ‰€æœ‰è¯·æ±‚ç»“æœ</span>

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> task <span class="hljs-keyword">of</span> tasks) {
        <span class="hljs-comment">// 1. å¼€å§‹æ‰§è¡Œä»»åŠ¡ (task æ˜¯ä¸€ä¸ªè¿”å› Promise çš„å‡½æ•°)</span>
        <span class="hljs-keyword">const</span> promise = <span class="hljs-title function_">task</span>();
        results.<span class="hljs-title function_">push</span>(promise);
        pool.<span class="hljs-title function_">add</span>(promise);

        <span class="hljs-comment">// 2. ä»»åŠ¡æ‰§è¡Œå®Œåï¼Œä»æ± å­é‡Œåˆ æ‰è‡ªå·±</span>
        promise.<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> pool.<span class="hljs-title function_">delete</span>(promise));

        <span class="hljs-comment">// 3. æ ¸å¿ƒï¼šå¦‚æœæ± å­æ»¡äº†ï¼Œå°±ç­‰æœ€å¿«çš„ä¸€ä¸ªå®Œæˆ</span>
        <span class="hljs-keyword">if</span> (pool.<span class="hljs-property">size</span> &gt;= limit) {
            <span class="hljs-comment">// Promise.race ä¼šåœ¨ pool ä¸­ä»»ä½•ä¸€ä¸ª promise å®Œæˆæ—¶ resolve</span>
            <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>(pool);
        }
    }

    <span class="hljs-comment">// 4. ç­‰æœ€åå‰©ä¸‹çš„å‡ ä¸ªä¹Ÿè·‘å®Œ</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(results);
}
</code></pre>
<h3 data-id="heading-30">äº”ã€ å…³é”®æ€è·¯æ‹†è§£ï¼ˆç»™é¢è¯•å®˜è®²é€ï¼‰</h3>
<ol>
<li>
<p>ä¸ºä»€ä¹ˆè¦ä¼ å…¥ tasks å‡½æ•°æ•°ç»„ï¼Œè€Œä¸æ˜¯ Promise æ•°ç»„ï¼Ÿ
å›ç­”ï¼š "å› ä¸º Promise ä¸€æ—¦åˆ›å»ºå°±ä¼šç«‹å³æ‰§è¡Œã€‚å¦‚æœæˆ‘ä¼  [axios(), axios()]ï¼Œé‚£å¹¶å‘æ§åˆ¶å°±æ²¡æ„ä¹‰äº†ã€‚æˆ‘å¿…é¡»ä¼  [() =&gt; axios(), () =&gt; axios()]ï¼Œè¿™æ ·æˆ‘æ‰èƒ½åœ¨å¾ªç¯é‡Œæ‰‹åŠ¨æ§åˆ¶ä»€ä¹ˆæ—¶å€™æ‰§è¡Œå®ƒã€‚"</p>
</li>
<li>
<p>Promise.race èµ·åˆ°äº†ä»€ä¹ˆä½œç”¨ï¼Ÿ
å›ç­”ï¼š "å®ƒå……å½“äº†'é˜»å¡å™¨'ã€‚å½“æ± å­æ»¡äº†ï¼Œawait Promise.race(pool) ä¼šè®© for å¾ªç¯åœä¸‹æ¥ã€‚åªæœ‰å½“æ± å­é‡Œæœ€å¿«çš„ä¸€ä¸ªè¯·æ±‚å®Œæˆäº†ï¼Œrace æ‰ä¼šè§£é™¤é˜»å¡ï¼Œå¾ªç¯ç»§ç»­ï¼Œä»è€Œå‘èµ·ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚"</p>
</li>
<li>
<p>ä¸ºä»€ä¹ˆæ˜¯ 6 ä¸ªï¼Ÿ
å›ç­”ï¼š "è¿™æ˜¯åŸºäº RFC 2616 æ ‡å‡†å»ºè®®å’Œä¸»æµæµè§ˆå™¨ï¼ˆChrome/Firefoxï¼‰çš„é»˜è®¤é™åˆ¶ã€‚è¶…è¿‡ 6 ä¸ªï¼Œæµè§ˆå™¨ä¹Ÿä¼šè®©å‰©ä¸‹çš„æ’é˜Ÿã€‚æ‰€ä»¥æˆ‘ä»¬å°†å¹¶å‘æ•°è®¾ä¸º 6ï¼Œæ—¢èƒ½æ¦¨å¹²å¸¦å®½ï¼Œåˆèƒ½ä¿æŒæµè§ˆå™¨çš„å“åº”é¡ºç•…ã€‚"</p>
</li>
</ol>
<h3 data-id="heading-31">å…­ã€ è¿›é˜¶ï¼šå¦‚æœè¯·æ±‚å¤±è´¥äº†æ€ä¹ˆåŠï¼Ÿï¼ˆæ–­ç‚¹ç»­ä¼ çš„ç»“åˆï¼‰</h3>
<p>åœ¨å®æˆ˜ä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åŠ ä¸Šé‡è¯•æœºåˆ¶ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼ªä»£ç ï¼šå¸¦é‡è¯•çš„ task</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">createTask</span> = (<span class="hljs-params">chunk</span>) =&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">async</span> () =&gt; {
        <span class="hljs-keyword">let</span> retries = <span class="hljs-number">3</span>;
        <span class="hljs-keyword">while</span> (retries &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/upload'</span>, chunk);
            } <span class="hljs-keyword">catch</span> (err) {
                retries--;
                <span class="hljs-keyword">if</span> (retries === <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> err;
            }
        }
    };
};
</code></pre>
<h3 data-id="heading-32">ä¸ƒã€ æ€»ç»“</h3>
<p>"åœ¨å¤§æ–‡ä»¶ä¸Šä¼ åœºæ™¯ä¸‹ï¼Œç›²ç›®å‘èµ·æˆç™¾ä¸Šåƒä¸ªåˆ‡ç‰‡è¯·æ±‚ä¼šå¯¼è‡´æµè§ˆå™¨ç½‘ç»œå±‚é˜»å¡å’ŒæœåŠ¡å™¨å‹åŠ›è¿‡å¤§ã€‚</p>
<p>æˆ‘çš„è§£å†³æ–¹æ¡ˆæ˜¯å®ç°ä¸€ä¸ª 'å¼‚æ­¥å¹¶å‘æ§åˆ¶é˜Ÿåˆ—'ã€‚</p>
<p>æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨ Promise.raceã€‚æˆ‘å°†å¹¶å‘æ•°é™åˆ¶åœ¨ 6 ä¸ªã€‚åœ¨ for å¾ªç¯ä¸­ï¼Œæˆ‘ç»´æŠ¤ä¸€ä¸ª Set ç»“æ„çš„æ‰§è¡Œæ± ã€‚æ¯å½“ä¸€ä¸ªåˆ‡ç‰‡è¯·æ±‚å¼€å§‹ï¼Œå°±åŠ å…¥æ± å­ï¼›å®Œæˆåç§»å‡ºã€‚å½“æ± å­è¾¾åˆ°é™åˆ¶æ•°æ—¶ï¼Œåˆ©ç”¨ await Promise.race é˜»å¡å¾ªç¯ï¼Œå®ç°**'èµ°ä¸€ä¸ªï¼Œè¡¥ä¸€ä¸ª'**çš„åŠ¨æ€å¹³è¡¡ã€‚</p>
<p>è¿™æ ·åšä¸ä»…éµå®ˆäº†æµè§ˆå™¨çš„è¿æ¥é™åˆ¶ï¼Œæ›´é‡è¦çš„æ˜¯ä¿è¯äº†å‰ç«¯é¡µé¢çš„æµç•…åº¦å’Œåç«¯ IO çš„ç¨³å®šæ€§ã€‚å¦‚æœé‡åˆ°å¤±è´¥çš„è¯·æ±‚ï¼Œæˆ‘è¿˜ä¼šé…åˆé‡è¯•é€»è¾‘å’Œæ–­ç‚¹ç»­ä¼ è®°å½•ï¼Œç¡®ä¿æ•´ä¸ªä¸Šä¼ è¿‡ç¨‹çš„å¼ºå£®æ€§ã€‚"</p>
<h2 data-id="heading-33">ç¬¬åå±‚ï¼šç»ˆæå›ç­”ç­–ç•¥ (æ¶æ„å¸ˆæ”¶ç½‘ç‰ˆ)</h2>
<p>å¦‚æœé¢è¯•å®˜è®©ä½ æ€»ç»“ä¸€å¥—"å®Œç¾çš„æ–‡ä»¶ä¸Šä¼ æ–¹æ¡ˆ"ï¼Œè¯·æŒ‰ç…§äº”ä¸ªç»´åº¦æ·±åº¦æ”¶ç½‘ï¼š</p>
<h3 data-id="heading-34">ç”¨æˆ·ä½“éªŒå±‚ (Performance)ï¼š</h3>
<p>é‡‡ç”¨ Web Worker å¼€å¯åå°çº¿ç¨‹ï¼Œé…åˆ Spark-MD5 å®ç°å¢é‡å“ˆå¸Œè®¡ç®—ã€‚</p>
<p>æ ¸å¿ƒäº®ç‚¹ï¼šé€šè¿‡"åˆ†å—è¯»å– -&gt; å¢é‡ç´¯åŠ "ç­–ç•¥é¿å… 4GB+ å¤§æ–‡ä»¶å¯¼è‡´çš„æµè§ˆå™¨ OOMï¼ˆå†…å­˜æº¢å‡ºï¼‰ï¼Œå¹¶åˆ©ç”¨ Worker çš„éé˜»å¡ç‰¹æ€§ç¡®ä¿ UI å“åº”å§‹ç»ˆä¿æŒ 60fpsã€‚å¯¹äºè¶…å¤§æ–‡ä»¶ï¼Œå¯é€‰æŠ½æ ·å“ˆå¸Œæ–¹æ¡ˆï¼Œç§’çº§ç”ŸæˆæŒ‡çº¹ã€‚</p>
<h3 data-id="heading-35">ä¼ è¾“ç­–ç•¥å±‚ (Strategy)ï¼š</h3>
<p><strong>ç§’ä¼ </strong>ï¼šä¸Šä¼ å‰é¢„æ£€ MD5ï¼Œå®ç°"å†…å®¹å³è·¯å¾„"çš„ç¬é—´å®Œæˆã€‚</p>
<p><strong>æ–­ç‚¹ç»­ä¼ </strong>ï¼šä»¥åç«¯å­˜å‚¨ä¸ºå‡†ï¼Œé€šè¿‡æ¥å£æŸ¥è¯¢ MySQL ä¸­å·²å­˜åœ¨çš„ chunk_indexï¼Œå‰ç«¯æ‰§è¡Œ filter å¢é‡ä¸Šä¼ ã€‚</p>
<p><strong>å¹¶å‘æ§åˆ¶</strong>ï¼šæ‰‹å†™å¼‚æ­¥å¹¶å‘æ± ï¼Œåˆ©ç”¨ Promise.race å®ç°"èµ°ä¸€ä¸ªï¼Œè¡¥ä¸€ä¸ª"çš„æ§½ä½æ§åˆ¶ï¼ˆé™åˆ¶ 6 ä¸ªå¹¶å‘ï¼‰ï¼Œæ—¢æ¦¨å¹²å¸¦å®½åˆé˜²æ­¢ TCP é˜»å¡åŠæœåŠ¡å™¨ IO çˆ†è¡¨ã€‚</p>
<h3 data-id="heading-36">åç«¯å¤„ç†å±‚ (Processing)ï¼š</h3>
<p><strong>æµå¼åˆå¹¶</strong>ï¼šæ”¾å¼ƒ fs.readFileï¼ŒåšæŒä½¿ç”¨ Node.js Stream (pipe)ã€‚</p>
<p>æ ¸å¿ƒäº®ç‚¹ï¼šåˆ©ç”¨ WriteStream çš„è¿½åŠ æ¨¡å¼ä¸è¯»æµå¯¹æ¥ï¼Œé€šè¿‡ Promise ä¸²è¡ŒåŒ– ä¿è¯åˆ‡ç‰‡é¡ºåºï¼Œå¹¶ä¾é  Stream çš„èƒŒå‹ï¼ˆBackpressureï¼‰æœºåˆ¶è‡ªåŠ¨å¹³è¡¡è¯»å†™é€Ÿåº¦ï¼Œå°†å†…å­˜å ç”¨ç¨³å®šåœ¨ 30MB å·¦å³ã€‚</p>
<h3 data-id="heading-37">æŒä¹…åŒ–è®¾è®¡å±‚ (Database)ï¼š</h3>
<p><strong>æ–‡ä»¶å…ƒæ•°æ®ç®¡ç†</strong>ï¼šMySQL è®°å½•æ–‡ä»¶ MD5ã€çŠ¶æ€ä¸æœ€ç»ˆå­˜å‚¨ URLã€‚</p>
<p><strong>æŸ¥è¯¢ä¼˜åŒ–</strong>ï¼šç»™ file_md5 åŠ  Unique Indexï¼ˆå”¯ä¸€ç´¢å¼•ï¼‰ï¼Œä¸ä»…æå‡ç§’ä¼ æŸ¥è¯¢æ•ˆç‡ï¼Œæ›´åœ¨æ•°æ®åº“å±‚é¢å…œåº•é«˜å¹¶å‘ä¸‹çš„é‡å¤å†™å…¥é£é™©ã€‚</p>
<h3 data-id="heading-38">å®‰å…¨é˜²æŠ¤å±‚ (Security)ï¼š</h3>
<p><strong>äºŒè¿›åˆ¶æ ¡éªŒ</strong>ï¼šä¸ä¿¡ä»»å‰ç«¯åç¼€åï¼Œåç«¯è¯»å–æ–‡ä»¶æµå‰ 8 å­—èŠ‚çš„ Magic Numberï¼ˆé­”æ•°ï¼‰ æ ¡éªŒäºŒè¿›åˆ¶å¤´ï¼Œé˜²æ­¢ä¼ªé€ åç¼€çš„æœ¨é©¬æ”»å‡»ã€‚</p>
<h3 data-id="heading-39">æ€»ç»“è¯æœ¯ï¼šä¸€åˆ†é’Ÿ"åŠæ‰“"é¢è¯•å®˜</h3>
<p>"åœ¨å¤„ç†å¤§æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œæˆ‘çš„æ ¸å¿ƒæ€è·¯æ˜¯ 'åˆ†è€Œæ²»ä¹‹' ä¸ 'çŠ¶æ€æŒä¹…åŒ–'ã€‚</p>
<p>åœ¨å‰ç«¯å±‚é¢ï¼Œæˆ‘é€šè¿‡ Web Worker é…åˆå¢é‡å“ˆå¸Œ è§£å†³äº†è®¡ç®—å¤§æ–‡ä»¶ MD5 æ—¶çš„ UI é˜»å¡å’Œå†…å­˜æº¢å‡ºé—®é¢˜ã€‚åˆ©ç”¨ Blob.slice å®ç°é€»è¾‘åˆ‡ç‰‡åï¼Œæˆ‘æ²¡æœ‰ç›²ç›®å‘èµ·è¯·æ±‚ï¼Œè€Œæ˜¯è®¾è®¡äº†ä¸€ä¸ªåŸºäº Promise.race çš„å¹¶å‘æ§åˆ¶é˜Ÿåˆ—ï¼Œåœ¨éµå®ˆæµè§ˆå™¨ TCP é™åˆ¶çš„åŒæ—¶ï¼Œä¿è¯äº†ä¼ è¾“çš„å¹³ç¨³æ€§ã€‚</p>
<p>åœ¨çŠ¶æ€ç®¡ç†ä¸Šï¼Œæˆ‘é‡‡ç”¨ 'åç«¯é©±åŠ¨'çš„æ–­ç‚¹ç»­ä¼ æ–¹æ¡ˆã€‚å‰ç«¯åœ¨ä¸Šä¼ å‰ä¼šé€šè¿‡æ¥å£æŸ¥è¯¢ MySQL è·å–å·²ä¸Šä¼ åˆ†ç‰‡åˆ—è¡¨ï¼Œè¿™ç§æ–¹æ¡ˆæ¯” localStorage æ›´å¯é ï¼Œä¸”å¤©ç„¶æ”¯æŒè·¨è®¾å¤‡ç»­ä¼ ã€‚</p>
<p>åœ¨åç«¯å¤„ç†ä¸Šï¼Œæˆ‘æ·±åº¦ä½¿ç”¨äº† Node.js çš„ Stream æµ è¿›è¡Œåˆ†ç‰‡åˆå¹¶ã€‚é€šè¿‡ç®¡é“æ¨¡å¼ä¸èƒŒå‹å¤„ç†ï¼Œæˆ‘ç¡®ä¿äº†æœåŠ¡å™¨åœ¨å¤„ç†å‡ å GB æ•°æ®æ—¶ï¼Œå†…å­˜æ°´ä½ä¾ç„¶ä¿æŒåœ¨æä½èŒƒå›´ã€‚</p>
<p>åœ¨å®‰å…¨æ€§ä¸ä¸¥è°¨æ€§ä¸Šï¼Œæˆ‘é€šè¿‡ MySQL å”¯ä¸€ç´¢å¼• å¤„ç†å¹¶å‘å†™å†²çªï¼Œé€šè¿‡ æ–‡ä»¶å¤´äºŒè¿›åˆ¶æ ¡éªŒ è¿‡æ»¤æ¶æ„æ–‡ä»¶ã€‚</p>
<p>è¿™å¥—æ–¹æ¡ˆä¸ä»…æ˜¯åŠŸèƒ½çš„å †ç Œï¼Œæ›´æ˜¯å¯¹æµè§ˆå™¨æ¸²æŸ“æœºåˆ¶ã€ç½‘ç»œæ‹¥å¡æ§åˆ¶ã€å†…å­˜ç®¡ç†ä»¥åŠæœåŠ¡å™¨ IO ç“¶é¢ˆçš„ç»¼åˆä¼˜åŒ–æ–¹æ¡ˆã€‚"</p>
<h3 data-id="heading-40">ğŸ’¡ é¢è¯•å®˜å¯èƒ½è¿½é—®çš„"è¡¥ä¸"</h3>
<p><strong>è¿½é—®</strong>ï¼šå¦‚æœåˆå¹¶è¿‡ç¨‹ä¸­æœåŠ¡å™¨æ–­ç”µäº†æ€ä¹ˆåŠï¼Ÿ</p>
<p><strong>å›ç­”</strong>ï¼š ç”±äºæˆ‘ä»¬æ˜¯é€šè¿‡æ•°æ®åº“è®°å½• status çš„ï¼Œåˆå¹¶æœªå®Œæˆå‰ status å§‹ç»ˆä¸º 0ã€‚æœåŠ¡å™¨é‡å¯åï¼Œå¯ä»¥æ ¹æ® status=0 ä¸”åˆ‡ç‰‡å·²é½å…¨çš„è®°å½•ï¼Œé‡æ–°è§¦å‘åˆå¹¶ä»»åŠ¡ï¼Œæˆ–è€…ç”±å‰ç«¯ä¸‹æ¬¡è§¦å‘é¢„æ£€æ—¶é‡æ–°åˆå¹¶ã€‚</p>
<p><strong>è¿½é—®</strong>ï¼šåˆ‡ç‰‡å¤§å°è®¾ä¸ºå¤šå°‘åˆé€‚ï¼Ÿ</p>
<p><strong>å›ç­”</strong>ï¼š é€šå¸¸å»ºè®® 2MB - 5MBã€‚å¤ªå°ä¼šå¯¼è‡´è¯·æ±‚ç¢ç‰‡è¿‡å¤šï¼ˆHTTP å¤´éƒ¨å¼€é”€å¤§ï¼‰ï¼Œå¤ªå¤§å®¹æ˜“è§¦å‘ç½‘ç»œæ³¢åŠ¨å¯¼è‡´çš„å•ä¸ªè¯·æ±‚å¤±è´¥ã€‚</p>
<p><strong>è¿½é—®</strong>ï¼šä¸Šä¼ è¿‡ç¨‹ä¸­è¿›åº¦æ¡å¦‚ä½•å®ç°ï¼Ÿ</p>
<p><strong>å›ç­”</strong>ï¼š ä¸¤ä¸ªç»´åº¦ã€‚ä¸€æ˜¯ MD5 è¿›åº¦ï¼ˆWorker è¿”å›ï¼‰ï¼ŒäºŒæ˜¯ä¸Šä¼ è¿›åº¦ï¼ˆä½¿ç”¨ axios çš„ onUploadProgress ç›‘æ§æ¯ä¸ªåˆ†ç‰‡ï¼Œç»“åˆå·²ä¸Šä¼ åˆ†ç‰‡æ•°é‡è®¡ç®—åŠ æƒå¹³å‡è¿›åº¦ï¼‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¥ä¸€èµ·å®ç°ä¸€ä¸ªæŒ‰é’®æ•ˆæœ]]></title>    <link>https://juejin.cn/post/7602579671476142099</link>    <guid>https://juejin.cn/post/7602579671476142099</guid>    <pubDate>2026-02-04T09:57:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602579671476142099" data-draft-id="7602579671476043795" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¥ä¸€èµ·å®ç°ä¸€ä¸ªæŒ‰é’®æ•ˆæœ"/> <meta itemprop="keywords" content="Flutter,Android"/> <meta itemprop="datePublished" content="2026-02-04T09:57:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç«æŸ´å°±æ˜¯æˆ‘"/> <meta itemprop="url" content="https://juejin.cn/user/272334614705575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¥ä¸€èµ·å®ç°ä¸€ä¸ªæŒ‰é’®æ•ˆæœ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/272334614705575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç«æŸ´å°±æ˜¯æˆ‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T09:57:15.000Z" title="Wed Feb 04 2026 09:57:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fdbbf3423beb43edb667935812c1d84e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54Gr5p-05bCx5piv5oiR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770803834&amp;x-signature=xzpDfRhn9tXwwIWxOlEXb0vljCI%3D" alt="image.png" width="70%" loading="lazy"/>
<p>æ•ˆæœç‚¹ï¼š1 æŒ‰é’®å¤–éƒ¨æ˜¯ç™½è‰²ï¼Œé‡Œé¢çš„é¢œè‰²åœ¨å››å‘¨åƒæ˜¯æ¸å˜å‡å¼±</p>
<p>2 æœ‰é˜´å½±å¹¶ä¸”é˜´å½±çœ‹ç€å¾ˆè‡ªç„¶ï¼ˆç›¸å¯¹äºç›´æ¥è®¾ç½®BoxShadowï¼‰</p>
<p>å®ç°çš„æ•ˆæœ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f36ea769d4e348bc856be7b27eceed9f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54Gr5p-05bCx5piv5oiR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770803834&amp;x-signature=sAPgK9BD0%2BgfXeuVbXECHM0w7QA%3D" alt="image.png" loading="lazy"/></p>
<p>æ²¡æœ‰ç›´æ¥ç”¨BoxShadow,BoxShadowä¹Ÿæ˜¯ç”¨..maskFilter = MaskFilter.blur(BlurStyle.normal, 10); api æ¥å®ç°çš„é˜´å½±ï¼Œæˆ‘è¿™é‡Œå°±æ˜¯ç›´æ¥ç”¨çš„è¿™ä¸ªapiè¿›è¡Œç»˜åˆ¶ã€‚</p>
<p>ä¸»è¦ç»˜åˆ¶ä»£ç </p>
<pre><code class="hljs language-js" lang="js">      
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ShadowPainter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">CustomPainter</span> {
  @override
  <span class="hljs-keyword">void</span> <span class="hljs-title function_">paint</span>(<span class="hljs-params">Canvas canvas, Size size</span>) {
<span class="hljs-comment">// 1. åˆ›å»ºç»˜åˆ¶è·¯å¾„ï¼ˆåœ†å½¢ï¼‰</span>
    <span class="hljs-keyword">var</span> rect = <span class="hljs-title class_">RRect</span>.<span class="hljs-title function_">fromLTRBR</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, size.<span class="hljs-property">width</span>, size.<span class="hljs-property">height</span>, <span class="hljs-title class_">Radius</span>.<span class="hljs-title function_">circular</span>(size.<span class="hljs-property">height</span>/<span class="hljs-number">2</span>));
    final path = <span class="hljs-title class_">Path</span>()..<span class="hljs-title function_">addRRect</span>(rect);
    final path2 = <span class="hljs-title class_">Path</span>()..<span class="hljs-title function_">addRRect</span>(rect.<span class="hljs-title function_">deflate</span>(<span class="hljs-number">5</span>));

    final path3 = <span class="hljs-title class_">Path</span>()..<span class="hljs-title function_">addRRect</span>(rect.<span class="hljs-title function_">deflate</span>(<span class="hljs-number">10</span>));

    <span class="hljs-comment">//ç»˜åˆ¶åº•éƒ¨é˜´å½±</span>
    <span class="hljs-comment">//path3 æ¯”rect å° è¿™æ ·è®¾ç½®outeræ¨¡å¼çš„æ—¶å€™å¤–æ•£çš„å…‰è¶…å‡ºç»„ä»¶çš„éƒ¨åˆ†å°±çœ‹ç€å¾ˆæŸ”å’Œ</span>
    final <span class="hljs-title class_">Paint</span> paint3 = <span class="hljs-title class_">Paint</span>()
      ..<span class="hljs-property">color</span> = <span class="hljs-title class_">Color</span>.<span class="hljs-title function_">fromRGBO</span>(<span class="hljs-number">249</span>, <span class="hljs-number">142</span>, <span class="hljs-number">119</span>, <span class="hljs-number">1</span>)
      ..<span class="hljs-property">maskFilter</span> = <span class="hljs-title class_">MaskFilter</span>.<span class="hljs-title function_">blur</span>(<span class="hljs-title class_">BlurStyle</span>.<span class="hljs-property">outer</span>, <span class="hljs-number">30</span>);
    canvas.<span class="hljs-title function_">drawPath</span>(path3, paint3);

    <span class="hljs-comment">//ç»˜åˆ¶ç™½è‰²åº•è‰²</span>
    final <span class="hljs-title class_">Paint</span> paint = <span class="hljs-title class_">Paint</span>()
      ..<span class="hljs-property">color</span> = <span class="hljs-title class_">Colors</span>.<span class="hljs-property">white</span>;
    canvas.<span class="hljs-title function_">drawPath</span>(path, paint);

    <span class="hljs-comment">//ç»˜åˆ¶ä¸­å¿ƒé¢œè‰² </span>
    <span class="hljs-comment">//å°±å¯ä»¥è®©å››å‘¨çš„é¢œè‰²æ¸å˜</span>
    final <span class="hljs-title class_">Paint</span> paint1 = <span class="hljs-title class_">Paint</span>()
      ..<span class="hljs-property">color</span> = <span class="hljs-title class_">Color</span>.<span class="hljs-title function_">fromRGBO</span>(<span class="hljs-number">249</span>, <span class="hljs-number">142</span>, <span class="hljs-number">119</span>, <span class="hljs-number">1</span>)
      ..<span class="hljs-property">maskFilter</span> = <span class="hljs-title class_">MaskFilter</span>.<span class="hljs-title function_">blur</span>(<span class="hljs-title class_">BlurStyle</span>.<span class="hljs-property">normal</span>, <span class="hljs-number">10</span>);

    canvas.<span class="hljs-title function_">drawPath</span>(path2, paint1);
  }

  @override
  bool <span class="hljs-title function_">shouldRepaint</span>(covariant <span class="hljs-title class_">CustomPainter</span> oldDelegate) =&gt; <span class="hljs-literal">false</span>;
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Swiftä¸­çš„AutoreleasePoolï¼šåŸç†ã€å®è·µä¸æœ€ä½³ä½¿ç”¨åœºæ™¯]]></title>    <link>https://juejin.cn/post/7602454700504563753</link>    <guid>https://juejin.cn/post/7602454700504563753</guid>    <pubDate>2026-02-04T02:20:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602454700504563753" data-draft-id="7602482736913645603" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Swiftä¸­çš„AutoreleasePoolï¼šåŸç†ã€å®è·µä¸æœ€ä½³ä½¿ç”¨åœºæ™¯"/> <meta itemprop="keywords" content="Swift"/> <meta itemprop="datePublished" content="2026-02-04T02:20:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="unravel2025"/> <meta itemprop="url" content="https://juejin.cn/user/1116759541421880"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Swiftä¸­çš„AutoreleasePoolï¼šåŸç†ã€å®è·µä¸æœ€ä½³ä½¿ç”¨åœºæ™¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1116759541421880/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    unravel2025
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T02:20:08.000Z" title="Wed Feb 04 2026 02:20:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ ¸å¿ƒæ¦‚å¿µè§£æ</h2>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯AutoreleasePoolï¼Ÿ</h3>
<p>AutoreleasePoolï¼ˆè‡ªåŠ¨é‡Šæ”¾æ± ï¼‰æ˜¯iOSå†…å­˜ç®¡ç†ä¸­çš„é‡è¦æœºåˆ¶ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå±€éƒ¨ä¸Šä¸‹æ–‡æˆ–å®¹å™¨ã€‚æ‰€æœ‰åœ¨è¿™ä¸ªå®¹å™¨å†…å®šä¹‰çš„å¯¹è±¡ï¼Œåœ¨å®¹å™¨é€€å‡ºä½œç”¨åŸŸæ—¶åº”è¯¥è¢«é‡Šæ”¾ã€‚å®ƒæ˜¯ä¸€ç§å»¶è¿Ÿé‡Šæ”¾ç­–ç•¥ï¼Œå…è®¸å¯¹è±¡åœ¨æ–¹æ³•è¿”å›åä»èƒ½è¢«ä½¿ç”¨ï¼Œè€Œä¸æ˜¯ç«‹å³é‡Šæ”¾ã€‚</p>
<p>åœ¨Swiftä¸­ï¼Œå°½ç®¡æˆ‘ä»¬ä½¿ç”¨ARCï¼ˆè‡ªåŠ¨å¼•ç”¨è®¡æ•°ï¼‰è‡ªåŠ¨ç®¡ç†å†…å­˜ï¼Œä½†autoreleasepoolå¹¶æœªæ¶ˆå¤±ã€‚ç¼–è¯‘å™¨ä¼šåœ¨åˆé€‚çš„ä½ç½®è‡ªåŠ¨æ’å…¥<code>retain</code>ã€<code>release</code>å’Œ<code>autorelease</code>è°ƒç”¨ï¼Œä½†autoreleasepoolæä¾›äº†ä¸€ç§æ‰‹åŠ¨æ§åˆ¶é‡Šæ”¾æ—¶æœºçš„æ‰‹æ®µã€‚</p>
<p>å…³é”®ç†è§£ç‚¹ï¼š</p>
<ul>
<li>AutoreleasePoolä¸ä¼šé˜»æ­¢å¯¹è±¡é‡Šæ”¾ï¼Œè€Œæ˜¯æ§åˆ¶é‡Šæ”¾çš„æ—¶æœº</li>
<li>å®ƒç®¡ç†çš„æ˜¯autoreleaseå¯¹è±¡ï¼ˆé€šè¿‡<code>autorelease</code>æ¶ˆæ¯æ ‡è®°çš„å¯¹è±¡ï¼‰</li>
<li>Swift nativeå¯¹è±¡é€šå¸¸ä¸æ˜¯autoreleaseå¯¹è±¡ï¼Œä½†Objective-Cå¯¹è±¡ï¼ˆåŒ…æ‹¬Cocoaæ¡†æ¶ç±»ï¼‰ä»ç„¶æ˜¯</li>
</ul>
<h3 data-id="heading-2">ä¸ºä»€ä¹ˆSwiftè¿˜éœ€è¦AutoreleasePoolï¼Ÿ</h3>
<ol>
<li>ä¸Objective-Cçš„äº’æ“ä½œæ€§ï¼šSwiftå®Œå…¨å…¼å®¹Objective-Cè¿è¡Œæ—¶ï¼Œå½“è°ƒç”¨Cocoaæ¡†æ¶æˆ–æ··åˆOCä»£ç æ—¶ï¼Œä¼šå¤„ç†å¤§é‡autoreleaseå¯¹è±¡</li>
<li>æ§åˆ¶å†…å­˜å³°å€¼ï¼šåœ¨å¤§é‡ä¸´æ—¶å¯¹è±¡åˆ›å»ºçš„åœºæ™¯ä¸‹ï¼Œé˜²æ­¢å†…å­˜æš´æ¶¨</li>
<li>å•å…ƒæµ‹è¯•å†…å­˜æ³„æ¼ï¼šéªŒè¯å¯¹è±¡æ˜¯å¦è¢«æ­£ç¡®é‡Šæ”¾</li>
</ol>
<h2 data-id="heading-3">å·¥ä½œåŸç†æ·±åº¦å‰–æ</h2>
<h3 data-id="heading-4">åº•å±‚å®ç°æœºåˆ¶</h3>
<p>AutoreleasePoolçš„åº•å±‚å®ç°åŸºäº<code>AutoreleasePoolPage</code>ç±»ï¼Œè¿™æ˜¯ä¸€ä¸ªæ ˆç»“æ„çš„å†…å­˜ç®¡ç†ç³»ç»Ÿï¼š</p>
<pre><code class="hljs language-objc" lang="objc"><span class="hljs-comment">// AutoreleasePoolPageçš„æ ¸å¿ƒç»“æ„ï¼ˆåŸºäºAppleå¼€æºä»£ç ï¼‰</span>
<span class="hljs-keyword">class</span> AutoreleasePoolPage {
    <span class="hljs-comment">// æˆå‘˜å˜é‡</span>
    magic_t <span class="hljs-keyword">const</span> magic;           <span class="hljs-comment">// é­”æ•°ï¼Œç”¨äºæ ¡éªŒ</span>
    <span class="hljs-type">id</span> *next;                      <span class="hljs-comment">// æŒ‡å‘ä¸‹ä¸€ä¸ªå¯å­˜å‚¨autoreleaseå¯¹è±¡çš„åœ°å€</span>
    pthread_t <span class="hljs-keyword">const</span> thread;        <span class="hljs-comment">// å½“å‰çº¿ç¨‹</span>
    AutoreleasePoolPage * <span class="hljs-keyword">const</span> parent;  <span class="hljs-comment">// ä¸Šä¸€ä¸ªpage</span>
    AutoreleasePoolPage *child;    <span class="hljs-comment">// ä¸‹ä¸€ä¸ªpage</span>
    uint32_t <span class="hljs-keyword">const</span> depth;          <span class="hljs-comment">// æ± æ·±åº¦</span>
    uint32_t hiwat;                <span class="hljs-comment">// é«˜æ°´ä½æ ‡è®°</span>
    
    <span class="hljs-comment">// æ ¸å¿ƒå‡½æ•°</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-type">id</span> autorelease(<span class="hljs-type">id</span> obj);  <span class="hljs-comment">// å°†å¯¹è±¡åŠ å…¥è‡ªåŠ¨é‡Šæ”¾æ± </span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> *push();            <span class="hljs-comment">// åˆ›å»ºæ–°æ± è¾¹ç•Œ</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> pop(<span class="hljs-type">void</span> *token);   <span class="hljs-comment">// é‡Šæ”¾æ± å†…å¯¹è±¡</span>
}
</code></pre>
<p>å·¥ä½œæµç¨‹ï¼š</p>
<ol>
<li>Pushé˜¶æ®µï¼šè°ƒç”¨<code>autoreleasepool {}</code>æ—¶ï¼Œç³»ç»Ÿæ’å…¥ä¸€ä¸ª<code>POOL_BOUNDARY</code>ï¼ˆè¾¹ç•Œæ ‡è®°ï¼‰åˆ°å½“å‰page</li>
<li>æ·»åŠ å¯¹è±¡ï¼šè°ƒç”¨OCå¯¹è±¡çš„<code>autorelease</code>æ–¹æ³•æ—¶ï¼Œå¯¹è±¡æŒ‡é’ˆè¢«æ·»åŠ åˆ°pageçš„æ ˆä¸­</li>
<li>Popé˜¶æ®µï¼šä½œç”¨åŸŸç»“æŸæ—¶ï¼Œ<code>pop</code>å‡½æ•°ä»æ ˆé¡¶å‘ä¸‹é‡Šæ”¾å¯¹è±¡ï¼Œç›´åˆ°é‡åˆ°<code>POOL_BOUNDARY</code></li>
</ol>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// Swiftä¸­çš„autoreleasepoolå®é™…ä¸Šè°ƒç”¨äº†åº•å±‚Cå‡½æ•°</span>
autoreleasepool {
    <span class="hljs-comment">// ç­‰ä»·äºï¼švoid *token = objc_autoreleasePoolPush();</span>
    <span class="hljs-keyword">let</span> image <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(named: <span class="hljs-string">"example"</span>) <span class="hljs-comment">// å¯èƒ½äº§ç”Ÿautoreleaseå¯¹è±¡</span>
    <span class="hljs-comment">// ...</span>
} <span class="hljs-comment">// ç­‰ä»·äºï¼šobjc_autoreleasePoolPop(token);</span>
</code></pre>
<h3 data-id="heading-5">çº¿ç¨‹ä¸RunLoopçš„å…³ç³»</h3>
<ul>
<li>ä¸»çº¿ç¨‹ï¼šæ•´ä¸ªä¸»çº¿ç¨‹è¿è¡Œåœ¨è‡ªåŠ¨é‡Šæ”¾æ± ä¸­ï¼Œæ¯ä¸ªä¸»RunLoopç»“æŸæ—¶æ‰§è¡Œdrainæ“ä½œ</li>
<li>åå°çº¿ç¨‹ï¼šéœ€è¦æ‰‹åŠ¨åˆ›å»ºautoreleasepoolï¼Œå¦åˆ™å¯èƒ½é€ æˆå†…å­˜æ³„æ¼</li>
<li>GCDé˜Ÿåˆ—ï¼šç³»ç»Ÿç®¡ç†çš„å…¨å±€å¹¶å‘é˜Ÿåˆ—å·²ç»å†…ç½®autoreleasepoolï¼Œä½†è‡ªå®šä¹‰é˜Ÿåˆ—éœ€è¦æ‰‹åŠ¨å¤„ç†</li>
</ul>
<h2 data-id="heading-6">ä½¿ç”¨åœºæ™¯ä¸å®æˆ˜ç¤ºä¾‹</h2>
<h3 data-id="heading-7">å¾ªç¯ä¸­å¤§é‡åˆ›å»ºä¸´æ—¶å¯¹è±¡</h3>
<p>è¿™æ˜¯æœ€å…¸å‹çš„åº”ç”¨åœºæ™¯ï¼Œé˜²æ­¢å†…å­˜å³°å€¼è¿‡é«˜ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// âŒ ä¸æ¨èï¼šå¯èƒ½å¯¼è‡´å†…å­˜æš´æ¶¨</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">processLargeData</span>() {
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span><span class="hljs-operator">..&lt;</span><span class="hljs-number">10000</span> {
        <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> <span class="hljs-type">Data</span>(repeating: <span class="hljs-type">UInt8</span>(i <span class="hljs-operator">%</span> <span class="hljs-number">256</span>), count: <span class="hljs-number">1024</span>)
        <span class="hljs-keyword">let</span> string <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(data: data, encoding: .utf8)
        <span class="hljs-built_in">print</span>(string) <span class="hljs-comment">// æ‰“å°å¯èƒ½æ¶‰åŠOCå¯¹è±¡è½¬æ¢</span>
    }
}

<span class="hljs-comment">// âœ… æ¨èï¼šä½¿ç”¨autoreleasepoolåŠæ—¶é‡Šæ”¾</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">processLargeDataOptimized</span>() {
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">0</span><span class="hljs-operator">..&lt;</span><span class="hljs-number">10000</span> {
        autoreleasepool {
            <span class="hljs-comment">// æ¯æ¬¡å¾ªç¯ç»“æŸç«‹å³é‡Šæ”¾ä¸´æ—¶å¯¹è±¡</span>
            <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> <span class="hljs-type">Data</span>(repeating: <span class="hljs-type">UInt8</span>(i <span class="hljs-operator">%</span> <span class="hljs-number">256</span>), count: <span class="hljs-number">1024</span>)
            <span class="hljs-keyword">let</span> string <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(data: data, encoding: .utf8)
            <span class="hljs-built_in">print</span>(string) <span class="hljs-comment">// printå¯èƒ½åˆ›å»ºautoreleaseå­—ç¬¦ä¸²</span>
        }
    }
}
</code></pre>
<p>å†…å­˜å¯¹æ¯”ï¼š</p>
<ul>
<li>æ— autoreleasepoolï¼šå†…å­˜æŒç»­ç´¯ç§¯ï¼Œå³°å€¼å¯èƒ½è¾¾åˆ°æ•°ç™¾MB</li>
<li>æœ‰autoreleasepoolï¼šæ¯æ¬¡å¾ªç¯é‡Šæ”¾ï¼Œå†…å­˜ä¿æŒå¹³ç¨³åœ¨è¾ƒä½æ°´å¹³</li>
</ul>
<h3 data-id="heading-8">å›¾åƒå¤„ç†ä¸å¤§é‡IOæ“ä½œ</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">resizeImages</span>(<span class="hljs-params">in</span> <span class="hljs-params">directory</span>: <span class="hljs-type">URL</span>, <span class="hljs-params">to</span> <span class="hljs-params">size</span>: <span class="hljs-type">CGSize</span>) {
    <span class="hljs-keyword">let</span> fileManager <span class="hljs-operator">=</span> <span class="hljs-type">FileManager</span>.default
    <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> files <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> fileManager.contentsOfDirectory(at: directory, includingPropertiesForKeys: <span class="hljs-literal">nil</span>) 
    <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }
    
    <span class="hljs-keyword">for</span> fileURL <span class="hljs-keyword">in</span> files {
        autoreleasepool {
            <span class="hljs-comment">// å›¾åƒæ“ä½œäº§ç”Ÿå¤§é‡autoreleaseå¯¹è±¡</span>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> image <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(contentsOfFile: fileURL.path),
               <span class="hljs-keyword">let</span> resized <span class="hljs-operator">=</span> resizeImage(image, to: size) {
                saveImage(resized, to: fileURL)
            }
            <span class="hljs-comment">// UIImageã€CGImageç­‰å¯¹è±¡åœ¨æ­¤å¤„è¢«é‡Šæ”¾</span>
        }
    }
}

<span class="hljs-comment">// è¾…åŠ©å‡½æ•°</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">resizeImage</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">image</span>: <span class="hljs-type">UIImage</span>, <span class="hljs-params">to</span> <span class="hljs-params">size</span>: <span class="hljs-type">CGSize</span>) -&gt; <span class="hljs-type">UIImage</span>? {
    <span class="hljs-type">UIGraphicsBeginImageContextWithOptions</span>(size, <span class="hljs-literal">false</span>, <span class="hljs-number">0.0</span>)
    <span class="hljs-keyword">defer</span> { <span class="hljs-type">UIGraphicsEndImageContext</span>() }
    image.draw(in: <span class="hljs-type">CGRect</span>(origin: .zero, size: size))
    <span class="hljs-keyword">return</span> <span class="hljs-type">UIGraphicsGetImageFromCurrentImageContext</span>()
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">saveImage</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">image</span>: <span class="hljs-type">UIImage</span>, <span class="hljs-params">to</span> <span class="hljs-params">url</span>: <span class="hljs-type">URL</span>) {
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> image.pngData() {
        <span class="hljs-keyword">try?</span> data.write(to: url)
    }
}
</code></pre>
<h3 data-id="heading-9">å•å…ƒæµ‹è¯•ä¸­éªŒè¯å†…å­˜æ³„æ¼</h3>
<p>è¿™æ˜¯autoreleasepoolåœ¨Swiftä¸­æœ€æœ‰ä»·å€¼çš„åº”ç”¨ä¹‹ä¸€ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-keyword">import</span> XCTest

<span class="hljs-comment">// æ‰©å±•XCTestCaseä»¥æ£€æµ‹å¯¹è±¡é‡Šæ”¾</span>
<span class="hljs-keyword">extension</span> <span class="hljs-title class_">XCTestCase</span> {
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">assertDeallocation</span>&lt;<span class="hljs-type">T</span>: <span class="hljs-type">AnyObject</span>&gt;(<span class="hljs-params">of</span> <span class="hljs-params">objectFactory</span>: () -&gt; <span class="hljs-type">T</span>) {
        <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> weakReference: <span class="hljs-type">T</span>?
        <span class="hljs-keyword">let</span> expectation <span class="hljs-operator">=</span> <span class="hljs-keyword">self</span>.expectation(description: <span class="hljs-string">"Object should deallocate"</span>)
        
        autoreleasepool {
            <span class="hljs-keyword">let</span> object <span class="hljs-operator">=</span> objectFactory()
            weakReference <span class="hljs-operator">=</span> object
            <span class="hljs-type">XCTAssertNotNil</span>(weakReference, <span class="hljs-string">"å¯¹è±¡åº”è¯¥å­˜åœ¨"</span>)
            expectation.fulfill()
        }
        
        <span class="hljs-comment">// ç­‰å¾…autoreleasepoolæ’ç©ºåéªŒè¯</span>
        wait(for: [expectation], timeout: <span class="hljs-number">1.0</span>)
        
        <span class="hljs-comment">// å»¶è¿Ÿæ£€æŸ¥ç¡®ä¿é‡Šæ”¾å®Œæˆ</span>
        <span class="hljs-type">DispatchQueue</span>.main.asyncAfter(deadline: .now() <span class="hljs-operator">+</span> <span class="hljs-number">0.1</span>) {
            <span class="hljs-type">XCTAssertNil</span>(weakReference, <span class="hljs-string">"å¯¹è±¡åº”è¯¥è¢«é‡Šæ”¾ï¼Œå­˜åœ¨å†…å­˜æ³„æ¼"</span>)
        }
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewControllerTests</span>: <span class="hljs-title class_">XCTestCase</span> {
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">testViewControllerDeallocation</span>() {
        assertDeallocation {
            <span class="hljs-keyword">let</span> storyboard <span class="hljs-operator">=</span> <span class="hljs-type">UIStoryboard</span>(name: <span class="hljs-string">"Main"</span>, bundle: <span class="hljs-literal">nil</span>)
            <span class="hljs-keyword">return</span> storyboard.instantiateViewController(withIdentifier: <span class="hljs-string">"TestVC"</span>)
        }
    }
    
    <span class="hljs-keyword">func</span> <span class="hljs-title function_">testCustomObjectDeallocation</span>() {
        assertDeallocation {
            <span class="hljs-keyword">return</span> <span class="hljs-type">MyServiceManager</span>()
        }
    }
}

<span class="hljs-comment">// è‡ªå®šä¹‰ç±»æµ‹è¯•</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyServiceManager</span> {
    <span class="hljs-keyword">init</span>() {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"MyServiceManageråˆå§‹åŒ–"</span>)
    }
    
    <span class="hljs-keyword">deinit</span> {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"MyServiceManagerè¢«é‡Šæ”¾äº†"</span>) <span class="hljs-comment">// åº”è¯¥è¢«æ‰“å°</span>
    }
}
</code></pre>
<h3 data-id="heading-10">å¤šçº¿ç¨‹ä¸GCD</h3>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// åœ¨è‡ªå®šä¹‰åå°é˜Ÿåˆ—ä¸­å¿…é¡»ä½¿ç”¨autoreleasepool</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">processInBackground</span>() {
    <span class="hljs-keyword">let</span> queue <span class="hljs-operator">=</span> <span class="hljs-type">DispatchQueue</span>(label: <span class="hljs-string">"com.example.processing"</span>, attributes: .concurrent)
    
    queue.async {
        autoreleasepool {
            <span class="hljs-comment">// å¤§é‡æ•°æ®å¤„ç†</span>
            <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> largeDataSet {
                <span class="hljs-keyword">let</span> processed <span class="hljs-operator">=</span> <span class="hljs-keyword">self</span>.processItem(item)
                <span class="hljs-keyword">self</span>.saveToTempStorage(processed)
            }
            <span class="hljs-comment">// ç¡®ä¿ä¸´æ—¶å¯¹è±¡åœ¨çº¿ç¨‹ç»“æŸæ—¶é‡Šæ”¾</span>
        }
    }
}

<span class="hljs-comment">// ç³»ç»Ÿå…¨å±€é˜Ÿåˆ—å·²å†…ç½®autoreleasepoolï¼Œä½†æ˜¾å¼å£°æ˜æ›´å®‰å…¨</span>
<span class="hljs-keyword">func</span> <span class="hljs-title function_">processOnGlobalQueue</span>() {
    <span class="hljs-type">DispatchQueue</span>.global().async {
        autoreleasepool {
            <span class="hljs-keyword">let</span> strings <span class="hljs-operator">=</span> (<span class="hljs-number">0</span><span class="hljs-operator">..&lt;</span><span class="hljs-number">1000</span>).map { <span class="hljs-string">"Item-<span class="hljs-subst">\(<span class="hljs-variable">$0</span>)</span>"</span> }
            <span class="hljs-built_in">print</span>(strings.joined(separator: <span class="hljs-string">", "</span>))
        }
    }
}
</code></pre>
<h2 data-id="heading-11">æ·±å…¥åŸç†åˆ†æ</h2>
<h3 data-id="heading-12">AutoreleasePoolPageçš„å†…å­˜å¸ƒå±€</h3>
<p>AutoreleasePoolä½¿ç”¨åˆ†é¡µæ ˆç»“æ„ç®¡ç†å†…å­˜ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Pageç»“æ„ï¼š
+-------------------+
|  magic            |
|  next (æŒ‡é’ˆ)       |
|  thread           |
|  parent           |
|  child            |
|  depth            |
|  hiwat            |
+-------------------+
|  å¯¹è±¡æŒ‡é’ˆæ ˆ        |
|  <span class="hljs-selector-attr">[0]</span> = POOL_BOUNDARY
|  <span class="hljs-selector-attr">[1]</span> = <span class="hljs-number">0</span>x600003f2a8c0 (å¯¹è±¡<span class="hljs-number">1</span>)
|  <span class="hljs-selector-attr">[2]</span> = <span class="hljs-number">0</span>x600003f2a8d0 (å¯¹è±¡<span class="hljs-number">2</span>)
|  ...              |
+-------------------+
</code></pre>
<p>å½“å½“å‰pageæ»¡æ—¶ï¼ˆé€šå¸¸ä¸º4096å­—èŠ‚ï¼‰ï¼Œä¼šåˆ›å»ºæ–°çš„pageå¹¶é“¾æ¥æˆåŒå‘é“¾è¡¨ã€‚<code>hotPage()</code>æ€»æ˜¯æŒ‡å‘æœ€æ–°pageï¼Œæ–°autoreleaseå¯¹è±¡è¿½åŠ åˆ°<code>next</code>æŒ‡é’ˆä½ç½®ã€‚</p>
<h3 data-id="heading-13">Popæ“ä½œçš„é‡Šæ”¾é€»è¾‘</h3>
<pre><code class="hljs language-c" lang="c"><span class="hljs-comment">// ä¼ªä»£ç ï¼špopå‡½æ•°çš„è¡Œä¸º</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">pop</span><span class="hljs-params">(<span class="hljs-type">void</span> *token)</span> {
    AutoreleasePoolPage *page = pageForPointer(token);
    id *stop = (id *)token;
    
    <span class="hljs-comment">// ä»æ ˆé¡¶å‘ä¸‹é‡Šæ”¾ï¼Œç›´åˆ°é‡åˆ°token</span>
    <span class="hljs-keyword">while</span> (page-&gt;next &gt; stop) {
        id obj = *--page-&gt;next;
        <span class="hljs-keyword">if</span> (obj != POOL_BOUNDARY) {
            [obj release]; <span class="hljs-comment">// å®é™…é‡Šæ”¾å¯¹è±¡</span>
        }
    }
    
    <span class="hljs-comment">// æ¸…ç†ç©ºpage</span>
    <span class="hljs-keyword">if</span> (page-&gt;empty() &amp;&amp; page-&gt;child) {
        page-&gt;child-&gt;kill(); <span class="hljs-comment">// å›æ”¶å†…å­˜</span>
    }
}
</code></pre>
<p>å…³é”®ç†è§£ï¼šé‡Šæ”¾æ˜¯å•å‘çº¿æ€§çš„ï¼Œä»æœ€æ–°å¯¹è±¡å‘æ—§å¯¹è±¡é‡Šæ”¾ï¼Œç›´åˆ°è¾¹ç•Œæ ‡è®°ã€‚è¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆautoreleasepoolèƒ½ç²¾ç¡®æ§åˆ¶ä½œç”¨åŸŸã€‚</p>
<h3 data-id="heading-14">æ€§èƒ½è€ƒé‡</h3>
<ul>
<li>æ— å¼€é”€ï¼šåœ¨æ²¡æœ‰autoreleaseå¯¹è±¡æ—¶ï¼Œautoreleasepoolå‡ ä¹æ²¡æœ‰æ€§èƒ½æŸå¤±</li>
<li>åŠæ—¶é‡Šæ”¾ï¼šé¿å…å†…å­˜ç§¯å‹ï¼Œå‡å°‘å³°å€¼å†…å­˜å ç”¨</li>
<li>ç¼“å­˜å‹å¥½ï¼šAutoreleasePoolPageç»“æ„ç´§å‡‘ï¼Œåˆ©ç”¨äº†CPUç¼“å­˜</li>
</ul>
<h2 data-id="heading-15">å¸¸è§è¯¯åŒºä¸æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-16">è¯¯åŒºä¸€ï¼šSwiftä¸­autoreleasepoolæ— ç”¨</h3>
<p>çœŸç›¸ï¼šè™½ç„¶Swift nativeå¯¹è±¡ä¸ä½¿ç”¨autoreleaseï¼Œä½†Cocoaæ¡†æ¶ï¼ˆUIKitã€Foundationï¼‰å¤§é‡ä½¿ç”¨ã€‚ä»»ä½•æ¶‰åŠ<code>NSString</code>ã€<code>NSData</code>ã€<code>UIImage</code>ç­‰ç±»çš„å¯†é›†æ“ä½œéƒ½å¯èƒ½éœ€è¦ã€‚</p>
<h3 data-id="heading-17">è¯¯åŒºäºŒï¼šautoreleasepoolè§£å†³å†…å­˜æ³„æ¼</h3>
<p>çœŸç›¸ï¼šautoreleasepoolä¸èƒ½è§£å†³çœŸæ­£çš„å†…å­˜æ³„æ¼ï¼ˆå¼ºå¼•ç”¨å¾ªç¯ï¼‰ã€‚å®ƒä»…æ§åˆ¶é‡Šæ”¾æ—¶æœºï¼Œä¸èƒ½é‡Šæ”¾è¢«å¼ºæŒæœ‰çš„å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">// âŒ é”™è¯¯ç¤ºä¾‹ï¼šautoreleasepoolæ— æ³•è§£å†³å¾ªç¯å¼•ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {
    <span class="hljs-keyword">var</span> b: <span class="hljs-type">B</span>?
    <span class="hljs-keyword">deinit</span> { <span class="hljs-built_in">print</span>(<span class="hljs-string">"A deinit"</span>) }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> {
    <span class="hljs-keyword">var</span> a: <span class="hljs-type">A</span>?
    <span class="hljs-keyword">deinit</span> { <span class="hljs-built_in">print</span>(<span class="hljs-string">"B deinit"</span>) }
}

autoreleasepool {
    <span class="hljs-keyword">let</span> a <span class="hljs-operator">=</span> <span class="hljs-type">A</span>()
    <span class="hljs-keyword">let</span> b <span class="hljs-operator">=</span> <span class="hljs-type">B</span>()
    a.b <span class="hljs-operator">=</span> b
    b.a <span class="hljs-operator">=</span> a <span class="hljs-comment">// å¾ªç¯å¼•ç”¨ï¼</span>
} <span class="hljs-comment">// aå’Œbéƒ½ä¸ä¼šè¢«é‡Šæ”¾</span>
</code></pre>
<h3 data-id="heading-18">è¯¯åŒºä¸‰ï¼šè¿‡åº¦ä½¿ç”¨autoreleasepool</h3>
<p>ä¸å¿…è¦åœºæ™¯ï¼š</p>
<ul>
<li>å°‘é‡å¯¹è±¡çš„æ™®é€šå¾ªç¯</li>
<li>Swift value typeï¼ˆStructã€Enumï¼‰çš„æ“ä½œ</li>
<li>å·²ç»ç”±ç³»ç»Ÿç®¡ç†çš„ä»£ç å—ï¼ˆå¦‚UIViewåŠ¨ç”»ï¼‰</li>
</ul>
<h2 data-id="heading-19">è§è§£ä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-20">ä½¿ç”¨åŸåˆ™</h3>








































<table><thead><tr><th align="left">åœºæ™¯</th><th align="left">æ˜¯å¦éœ€è¦ <code>autoreleasepool</code></th><th align="left">åŸå› </th></tr></thead><tbody><tr><td align="left">å¾ªç¯ &gt;1000 æ¬¡åˆ›å»ºå¯¹è±¡</td><td align="left">âœ… å¼ºçƒˆæ¨è</td><td align="left">å¤§é‡ä¸´æ—¶ autorelease å¯¹è±¡ä¼šå †ç§¯ï¼Œç›´åˆ°å¾ªç¯ç»“æŸæ‰é‡Šæ”¾ï¼Œå®¹æ˜“å†²é«˜å†…å­˜å³°å€¼ã€‚åœ¨å¾ªç¯å†…ä½¿ç”¨ <code>@autoreleasepool {}</code> å¯åŠæ—¶é‡Šæ”¾ï¼Œé™ä½å³°å€¼ã€‚</td></tr><tr><td align="left">å›¾åƒ/è§†é¢‘æ‰¹é‡å¤„ç†</td><td align="left">âœ… å¿…é¡»</td><td align="left"><code>UIImage</code>/<code>NSData</code> ç­‰å¤§é‡ API è¿”å› autorelease å¯¹è±¡ã€‚è‹¥ä¸æ‰‹åŠ¨åŠ æ± ï¼Œæ‰€æœ‰å¯¹è±¡ä¼šç­‰åˆ° RunLoop æˆ–çº¿ç¨‹ç»“æŸæ—¶æ‰é‡Šæ”¾ï¼Œææ˜“å› å†…å­˜æš´æ¶¨è€Œè¢«ç³»ç»Ÿæ€è¿›ç¨‹ã€‚</td></tr><tr><td align="left">å•å…ƒæµ‹è¯•éªŒè¯ <code>deinit</code></td><td align="left">âœ… å¿…é¡»</td><td align="left">æµ‹è¯•æ¡†æ¶çš„é‡Šæ”¾æ—¶æœºä¸ç¡®å®šï¼Œå¯¹è±¡å¯èƒ½å»¶è¿Ÿåˆ°æµ‹è¯•ç»“æŸåæ‰é‡Šæ”¾ã€‚ä½¿ç”¨ <code>@autoreleasepool {}</code> åŒ…è£¹è¢«æµ‹ä»£ç ï¼Œå¯åœ¨æ–­è¨€å‰å¼ºåˆ¶æ’ç©ºæ± ï¼Œç¡®ä¿ <code>deinit</code> è¢«åŠæ—¶è°ƒç”¨ã€‚</td></tr><tr><td align="left">è‡ªå®šä¹‰åå°çº¿ç¨‹</td><td align="left">âœ… æ¨è</td><td align="left">å­çº¿ç¨‹é»˜è®¤æ²¡æœ‰ RunLoop è‡ªåŠ¨ç®¡ç† autoreleasepoolã€‚é•¿æ—¶é—´è¿è¡Œçš„çº¿ç¨‹è‹¥ä¸æ‰‹åŠ¨åˆ›å»ºï¼Œautorelease å¯¹è±¡ä¼šä¸€ç›´å †ç§¯ï¼Œé€ æˆå†…å­˜æ³„æ¼æˆ–å³°å€¼ã€‚æ¨èåœ¨çº¿ç¨‹å…¥å£å¤„ä½¿ç”¨ <code>@autoreleasepool {}</code> åŒ…è£¹ä»»åŠ¡ã€‚</td></tr><tr><td align="left">æ™®é€šä¸šåŠ¡é€»è¾‘</td><td align="left">âŒ ä¸éœ€è¦</td><td align="left">ä¸»çº¿ç¨‹ RunLoop ä¼šåœ¨æ¯ä¸ªäº‹ä»¶å¾ªç¯ç»“æŸæ—¶è‡ªåŠ¨åˆ›å»ºå’Œé‡Šæ”¾ autoreleasepoolã€‚æ™®é€šä¸šåŠ¡ä»£ç äº§ç”Ÿçš„ä¸´æ—¶å¯¹è±¡èƒ½åŠæ—¶å¾—åˆ°é‡Šæ”¾ï¼Œæ— éœ€é¢å¤–æ·»åŠ ã€‚</td></tr><tr><td align="left">Swift çº¯å€¼ç±»å‹æ“ä½œ</td><td align="left">âŒ å®Œå…¨ä¸éœ€è¦</td><td align="left">çº¯å€¼ç±»å‹ï¼ˆ<code>struct</code>/<code>enum</code>/<code>Int</code> ç­‰ï¼‰ä¸æ¶‰åŠ Objective-C çš„å¼•ç”¨è®¡æ•°å’Œ autorelease æœºåˆ¶ï¼Œå› æ­¤ <code>@autoreleasepool</code> å¯¹å…¶æ— æ•ˆä¹Ÿæ— å¿…è¦ã€‚</td></tr></tbody></table>
<h2 data-id="heading-21">æ€»ç»“</h2>
<p>AutoreleasePoolåœ¨Swiftä¸­æ˜¯ä¸€ä¸ªè¢«ä½ä¼°ä½†å¼ºå¤§çš„å·¥å…·ã€‚å®ƒä¸æ˜¯ARCçš„æ›¿ä»£å“ï¼Œè€Œæ˜¯è¡¥å……å’Œå¢å¼ºï¼š</p>
<ol>
<li>æ ¸å¿ƒä½œç”¨ï¼šæ§åˆ¶Objective-Cå¯¹è±¡çš„é‡Šæ”¾æ—¶æœºï¼Œé™ä½å†…å­˜å³°å€¼</li>
<li>ä¸‰å¤§åº”ç”¨åœºæ™¯ï¼šå¤§æ‰¹é‡æ•°æ®å¤„ç†ã€å•å…ƒæµ‹è¯•å†…å­˜éªŒè¯ã€åå°çº¿ç¨‹ç®¡ç†</li>
<li>æ€§èƒ½å½±å“ï¼šå‡ ä¹æ— å¼€é”€ï¼Œä½†èƒ½æ˜¾è‘—ä¼˜åŒ–å†…å­˜ä½¿ç”¨</li>
<li>æœªæ¥è¶‹åŠ¿ï¼šä»ä¼šé•¿æœŸå­˜åœ¨ï¼Œæ˜¯æ··åˆç¼–ç¨‹ç¯å¢ƒä¸­çš„é‡è¦å·¥å…·</li>
</ol>
<h2 data-id="heading-22">å‚è€ƒèµ„æ–™</h2>
<ol>
<li>Appleå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.apple.com%2Flibrary%2Farchive%2Fdocumentation%2FCocoa%2FConceptual%2FMemoryMgmt%2FArticles%2FMemoryMgmt.html" target="_blank" title="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html" ref="nofollow noopener noreferrer">Advanced Memory Management Programming Guide</a></li>
<li>Swiftæºç : <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fswiftlang%2Fswift%2Fblob%2Fmain%2Fstdlib%2Fpublic%2Fcore%2FBridgeObjectiveC.swift" target="_blank" title="https://github.com/swiftlang/swift/blob/main/stdlib/public/core/BridgeObjectiveC.swift" ref="nofollow noopener noreferrer">Swift/stdlib/public/core/BridgeObjectiveC.swift</a> - autoreleasepoolå®ç°</li>
<li>Objective-Cè¿è¡Œæ—¶: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fapple-oss-distributions%2Fobjc4" target="_blank" title="https://github.com/apple-oss-distributions/objc4" ref="nofollow noopener noreferrer">objc4/runtime/NSObject.mm</a> - AutoreleasePoolPageå®ç°</li>
<li>Stack Overflow: <a href="https://link.juejin.cn?target=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F25860942%2Fis-it-necessary-to-use-autoreleasepool-in-a-swift-program" target="_blank" title="https://stackoverflow.com/questions/25860942/is-it-necessary-to-use-autoreleasepool-in-a-swift-program" ref="nofollow noopener noreferrer">Is it necessary to use autoreleasepool in a Swift program?</a> - æ·±å…¥çš„æŠ€æœ¯è®¨è®º</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ–‡å¿ƒå¿«ç 2025æ–©è·å¤šé¡¹æƒå¨å¥–é¡¹ï¼Œå¼•é¢†è½¯ä»¶ç ”å‘æ™ºèƒ½å˜é©]]></title>    <link>https://juejin.cn/post/7602929352716943360</link>    <guid>https://juejin.cn/post/7602929352716943360</guid>    <pubDate>2026-02-05T07:52:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602929352716943360" data-draft-id="7602936997175066676" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ–‡å¿ƒå¿«ç 2025æ–©è·å¤šé¡¹æƒå¨å¥–é¡¹ï¼Œå¼•é¢†è½¯ä»¶ç ”å‘æ™ºèƒ½å˜é©"/> <meta itemprop="keywords" content="å‰ç«¯,ç¨‹åºå‘˜,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-02-05T07:52:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ–‡å¿ƒå¿«ç BaiduComate"/> <meta itemprop="url" content="https://juejin.cn/user/992209294070809"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ–‡å¿ƒå¿«ç 2025æ–©è·å¤šé¡¹æƒå¨å¥–é¡¹ï¼Œå¼•é¢†è½¯ä»¶ç ”å‘æ™ºèƒ½å˜é©
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/992209294070809/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ–‡å¿ƒå¿«ç BaiduComate
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T07:52:42.000Z" title="Thu Feb 05 2026 07:52:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ•°å­—åŒ–æµªæ½®ä¸äººå·¥æ™ºèƒ½æŠ€æœ¯æ·±åº¦èåˆçš„2025å¹´ï¼Œè¡Œä¸šçš„ç›®å…‰æ­£èšç„¦äºé‚£äº›ä»¥åˆ›æ–°é©±åŠ¨å˜é©ã€ä»¥å®è·µå®šä¹‰æœªæ¥çš„å…ˆé”‹åŠ›é‡ã€‚<strong>ç™¾åº¦æ–‡å¿ƒå¿«ç ï¼Œä½œä¸ºâ€œAI+è½¯ä»¶å·¥ç¨‹â€é¢†åŸŸçš„å¼€æ‹“è€…ä¸æ·±è€•è€…ï¼Œ</strong> å‡­å€Ÿä¸€ç³»åˆ—çªç ´æ€§çš„æŠ€æœ¯æˆæœä¸æ·±åº¦äº§ä¸šå®è·µï¼Œåœ¨2025å¹´æ”¶è·å¤šé¡¹é‡é‡çº§å¥–é¡¹ä¸æƒå¨è®¤å¯ã€‚</p>
<p><strong>å¸‚åœºè®¤å¯ç»´åº¦</strong>ï¼Œæ–‡å¿ƒå¿«ç ç»¼åˆå®åŠ›å¤‡å—é’çï¼Œå±¡è·æƒå¨è‚¯å®šï¼Œä»åœ¨IDCã€Šä¸­å›½å¸‚åœºä»£ç ç”Ÿæˆäº§å“è¯„ä¼°ã€‹ä¸­æ–©è·3é¡¹ç¬¬ä¸€ï¼Œåˆ°è£è†ºä¸­å›½è½¯ä»¶è¡Œä¸šåä¼šâ€œå¹´åº¦ä¼˜ç§€è½¯ä»¶äº§å“â€ï¼Œè¯æ˜äº†Comateä½œä¸ºä¼ä¸šçº§ç”Ÿäº§å·¥å…·çš„æˆç†Ÿã€å¯é ï¼›</p>
<p><strong>æŠ€æœ¯æ ‡å‡†ç»´åº¦ï¼Œ</strong> æ–‡å¿ƒå¿«ç ç§¯æå¼•é¢†æŠ€æœ¯æ ‡å‡†è§„èŒƒï¼Œå‚ä¸ç¼–åˆ¶äº†ã€Šé¢å‘è½¯ä»¶å·¥ç¨‹æ™ºèƒ½ä½“çš„æŠ€æœ¯å’Œåº”ç”¨è¦æ±‚ ç¬¬1éƒ¨åˆ†ï¼šå¼€å‘æ™ºèƒ½ä½“ã€‹è¿™ä¸€è¡Œä¸šé¦–ä¸ªæ™ºèƒ½ä½“æŠ€æœ¯æ ‡å‡†ï¼Œå¹¶è”åˆäººå·¥æ™ºèƒ½å…³é”®æŠ€æœ¯å’Œåº”ç”¨è¯„æµ‹é‡ç‚¹å®éªŒå®¤ï¼Œå…±åŒç¼–å†™äº†ã€Šé¢å‘è½¯ä»¶å·¥ç¨‹æ™ºèƒ½ä½“çš„æŠ€æœ¯å’Œåº”ç”¨è¦æ±‚ ç¬¬ä¸€éƒ¨åˆ†ï¼šå¼€å‘æ™ºèƒ½ä½“ã€‹æ–‡çŒ®ï¼Œä¸ºâ€œAI+è½¯ä»¶å·¥ç¨‹â€çš„æ ‡å‡†åŒ–å‘å±•è´¡çŒ®äº†æ ¸å¿ƒåŠ›é‡ï¼›</p>
<p><strong>åœ¨äº§ä¸šå®è·µä¸­ï¼Œ</strong> æ–‡å¿ƒå¿«ç ç›´å‡»ç”¨æˆ·ç—›ç‚¹ï¼Œå…ˆååœ¨AIIAã€æœè´¸ä¼šã€AiDDå³°ä¼šã€ITæ–°æ²»ç†é¢†å¯¼åŠ›è®ºå›ç­‰è¡Œä¸šå³°ä¼šçš„é‡é‡çº§è¯„é€‰ä¸­ï¼Œåˆ†åˆ«å›Šè·2025å¹´åå¤§AI4SEâ€œé“¶å¼¹â€æ ‡æ†æ¡ˆä¾‹ã€â€œæ•°æ™ºå½±å“åŠ›â€å…ˆé”‹æ¡ˆä¾‹ã€AI+ç ”å‘å·¥å…·å…ˆé”‹å¥–ã€2025XOpsåˆ›æ–°å®è·µå¥–ç­‰é‡é‡çº§å¥–é¡¹ï¼Œå°è¯äº†æ–‡å¿ƒå¿«ç åœ¨çœŸå®ä¸šåŠ¡åœºæ™¯ä¸­è§£å†³å¤æ‚ç ”å‘éš¾é¢˜ã€æ¨åŠ¨å…¨æµç¨‹æ•ˆèƒ½å˜é©çš„è½åœ°å®æˆ˜èƒ½åŠ›ï¼›</p>
<p><strong>é¢å‘ç¤¾ä¼šä»·å€¼</strong>ï¼Œæ–‡å¿ƒå¿«ç è‡´åŠ›äºè·µè¡Œç§‘æŠ€å‘å–„ï¼Œè½å®æŠ€æœ¯æ™®æƒ ï¼Œè·å¾—äº†å¯åŠä¿¡æ¯æ— éšœç¢ä¼˜ç§€æ¡ˆä¾‹å’Œç™¾åº¦é«˜ä»·å€¼ä¸“åˆ©å¥–ï¼Œä½“ç°äº†æŠ€æœ¯æ¸©åº¦ä¸ä¼ä¸šæˆ˜ç•¥çš„ç»Ÿä¸€ã€‚</p>
<p>æ–‡å¿ƒå¿«ç æ–©è·çš„å¤šç»´åº¦é‡ç£…è£èª‰ï¼Œä¸ä»…æ˜¯å¯¹å…¶è¿‡å»ä¸€å¹´åœ¨å„æ–¹é¢æˆå°±çš„é›†ä¸­è‚¯å®šï¼Œæ›´æ˜¯æ–‡å¿ƒå¿«ç ä½œä¸ºâ€œAI+è½¯ä»¶å·¥ç¨‹â€å¼€æ‹“è€…ä¸æ·±è€•è€…çš„æœ€ä½³æ³¨è„šã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å¸‚åœºè®¤å¯â€”â€”å®åŠ›å¤‡å—é’çï¼Œå±¡è·æƒå¨è‚¯å®š</h2>
<h3 data-id="heading-1">1.IDCã€Šä¸­å›½å¸‚åœºä»£ç ç”Ÿæˆäº§å“è¯„ä¼°ã€‹3é¡¹ç¬¬ä¸€</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5896947ff24e4e2ea4f4e0cf477888c3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883054&amp;x-signature=YLSJLWgf62WEstNw3tfCi3%2Bywcw%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c358eed698e54ae887a078c488fb36da~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883054&amp;x-signature=%2FGQk%2Fv7YCFgDnUrHUcpbAAZNWqI%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>2025å¹´6æœˆï¼Œå›½é™…æƒå¨è¯„æµ‹æœºæ„IDCæ­£å¼å‘å¸ƒäº†ã€Šä¸­å›½å¸‚åœºä»£ç ç”Ÿæˆäº§å“è¯„ä¼°ã€‹ï¼Œå›½å†…å¸‚åœº10å®¶å¤´éƒ¨ä»£ç ç”Ÿæˆå¤´éƒ¨äº§å“å‚è¯„ã€‚<strong>åœ¨æœ¬æ¬¡è¯„ä¼°ä¸­ï¼Œç™¾åº¦æ™ºèƒ½ä»£ç åŠ©æ‰‹æ–‡å¿ƒå¿«ç è„±é¢–è€Œå‡ºï¼Œæ–©è·3é¡¹ç¬¬ä¸€ï¼š</strong></p>
<ul>
<li>åœ¨æ¶‰åŠçš„9é¡¹è¯„åˆ†ç»´åº¦ä¸­è¾¾æˆ8é¡¹æ»¡åˆ†ï¼Œæ»¡åˆ†ç»´åº¦æ•°é‡ç¬¬ä¸€</li>
<li>C++äº§å“èƒ½åŠ›å®æµ‹æ€»åˆ†ç¬¬ä¸€</li>
<li>â€œæ ¸å¿ƒä»£ç å®ç°â€ï¼ˆå³ä»£ç è´¨é‡ï¼‰æ€»åˆ†æ•°æ’åç¬¬ä¸€</li>
</ul>
<h3 data-id="heading-2">2.ä¸­å›½è½¯ä»¶è¡Œä¸šåä¼šâ€œ2025å¹´åº¦ä¼˜ç§€è½¯ä»¶äº§å“â€</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6b9163e412394bb2bb66eeaf0c53839c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883054&amp;x-signature=FD3SYRPFqIzqY5%2FTB1DF5ifgUPY%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>2025å¹´9æœˆï¼Œä¸­å›½è½¯ä»¶è¡Œä¸šåä¼šæ­æ™“â€œ2025å¹´åº¦ä¼˜ç§€è½¯ä»¶äº§å“â€è¯„é€‰ç»“æœã€‚<strong>ç™¾åº¦æ™ºèƒ½ä»£ç åŠ©æ‰‹æ–‡å¿ƒå¿«ç å‡­å€Ÿåœ¨AIèµ‹èƒ½ç ”å‘é¢†åŸŸçš„æŒç»­çªç ´ä¸åˆ›æ–°ï¼ŒæˆåŠŸæ‘˜å¾—è¿™ä¸€è£èª‰ã€‚</strong></p>
<p><strong>æœ¬æ¬¡è¯„é€‰ä»¥è½¯ä»¶çš„è‡ªä¸»çŸ¥è¯†äº§æƒã€å•†å“åŒ–ç¨‹åº¦ã€æŠ€æœ¯æ°´å¹³ã€ç¨³å®šæ€§ã€å¯é æ€§ã€ç”¨æˆ·æ»¡æ„åº¦ç­‰ä½œä¸ºä¸»è¦è€ƒè¯„æŒ‡æ ‡ã€‚æ–‡å¿ƒå¿«ç è·è¯„â€œä¼˜ç§€è½¯ä»¶äº§å“â€ï¼Œè¯æ˜äº†å…¶é¢†èˆªAIç¼–ç æ–°æ—¶ä»£çš„æ ‡æ†æ¨¡èŒƒä½œç”¨ã€‚</strong></p>
<h2 data-id="heading-3">äºŒã€æŠ€æœ¯æ ‡å‡†â€”â€”å¼•é¢†æŠ€æœ¯å®è·µã€å…±å»ºæ ‡å‡†è§„èŒƒ</h2>
<h3 data-id="heading-4">3.å‚ç¼–ã€Šé¢å‘è½¯ä»¶å·¥ç¨‹æ™ºèƒ½ä½“çš„æŠ€æœ¯å’Œåº”ç”¨è¦æ±‚ã€‹</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5bfbb5d53c6b4533bd668c3717b5a04f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883054&amp;x-signature=fPYMQzwAd8WbNj9nSnqyBNC2y9M%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6eed005f07f5487685e9292e6b3db62b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883054&amp;x-signature=8%2BbW5b1ugIZVfR1yesWSlg7z1Io%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>2025å¹´5æœˆ30æ—¥ï¼Œä¸­å›½ä¿¡æ¯é€šä¿¡ç ”ç©¶é™¢ï¼ˆç®€ç§°â€œä¸­å›½ä¿¡é€šé™¢â€ï¼‰ä¸ä¸­å›½å·¥å•†é“¶è¡Œã€åŒ—äº¬å…´äº‘æ•°ç§‘æŠ€æœ¯æœ‰é™å…¬å¸ã€<strong>åŒ—äº¬ç™¾åº¦ç½‘è®¯ç§‘æŠ€æœ‰é™å…¬å¸</strong>ç‰µå¤´ï¼Œè”åˆå†œä¸šé“¶è¡Œã€é‚®å‚¨é“¶è¡Œã€ç§‘å¤§è®¯é£ã€è…¾è®¯ã€é˜¿é‡Œã€åä¸ºç­‰äºŒåä½™å®¶å¤´éƒ¨ä¼ä¸šï¼Œå…±åŒç¼–åˆ¶å¹¶æ­£å¼å‘å¸ƒäº† <strong>ã€Šé¢å‘è½¯ä»¶å·¥ç¨‹æ™ºèƒ½ä½“çš„æŠ€æœ¯å’Œåº”ç”¨è¦æ±‚ ç¬¬1éƒ¨åˆ†ï¼šå¼€å‘æ™ºèƒ½ä½“ã€‹</strong> ï¼ˆæŠ€æœ¯è§„èŒƒç¼–å·AIIA/T 0219-2025ï¼‰ã€‚</p>
<p>è¯¥æ ‡å‡†çš„å‘å¸ƒæ ‡å¿—ç€æˆ‘å›½åœ¨AI æ™ºèƒ½ä½“é¢†åŸŸçš„æ ‡å‡†åŒ–è¿›ç¨‹è¿ˆå‡ºå…³é”®ä¸€æ­¥ï¼Œä¸ºä¼ä¸šå¼€å‘æ™ºèƒ½ä½“æä¾›èƒ½åŠ›å»ºè®¾æŒ‡å¯¼ï¼ŒåŠ©åŠ›äº§å“å¿«é€Ÿè¿­ä»£ï¼ŒåŒæ—¶ä¸ºä¼ä¸šæä¾›æŠ€æœ¯é€‰å‹å‚è€ƒï¼Œæ¨åŠ¨å¼€å‘æ™ºèƒ½ä½“çš„è½åœ°åº”ç”¨ã€‚</p>
<h3 data-id="heading-5">4.åˆä½œäººå·¥æ™ºèƒ½å…³é”®æŠ€æœ¯å’Œåº”ç”¨è¯„æµ‹é‡ç‚¹å®éªŒå®¤ç¼–å†™æ–‡çŒ®</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b15f6307b26c46ccad76af3630b71282~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883054&amp;x-signature=O1pBl7cjJ0Zw2ARVg2vRYJqD8jc%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>ç”±ç™¾åº¦ç‰µå¤´ï¼Œè”åˆäººå·¥æ™ºèƒ½å…³é”®æŠ€æœ¯å’Œåº”ç”¨è¯„æµ‹é‡ç‚¹å®éªŒå®¤ï¼Œå…±åŒç¼–å†™äº†ã€Šé¢å‘è½¯ä»¶å·¥ç¨‹æ™ºèƒ½ä½“çš„æŠ€æœ¯å’Œåº”ç”¨è¦æ±‚ ç¬¬ä¸€éƒ¨åˆ†ï¼šå¼€å‘æ™ºèƒ½ä½“ã€‹ã€‚è¿™æ ‡å¿—ç€ç™¾åº¦åœ¨â€œAI+è½¯ä»¶å·¥ç¨‹â€é¢†åŸŸçš„æŠ€æœ¯ç§¯ç´¯å’Œäº§ä¸šæ´å¯Ÿå·²ä¸Šå‡è‡³è¡Œä¸šè§„èŒƒåˆ¶å®šå±‚é¢ï¼Œä¸ºè½¯ä»¶å¼€å‘æ™ºèƒ½ä½“çš„æŠ€æœ¯èƒ½åŠ›ã€åº”ç”¨åœºæ™¯åŠè¯„ä»·ä½“ç³»å»ºç«‹äº†æƒå¨å‚è€ƒæ¡†æ¶ã€‚</p>
<h2 data-id="heading-6">ä¸‰ã€äº§ä¸šå®è·µâ€”â€”ç›´å‡»ç”¨æˆ·ç—›ç‚¹ï¼Œé©±åŠ¨æ•ˆèƒ½è·ƒå‡</h2>
<h3 data-id="heading-7">5.AIIA 2025å¹´åå¤§AI4SEâ€œé“¶å¼¹â€æ ‡æ†æ¡ˆä¾‹</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c2897c159fe9401b93a73c7c7497b604~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883054&amp;x-signature=h92AZNdZ8H73LEwXgUrcu%2BdWSh4%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>2025å¹´9æœˆï¼Œä¸­å›½äººå·¥æ™ºèƒ½äº§ä¸šå‘å±•è”ç›Ÿï¼ˆAIIAï¼‰åœ¨ä¸­å›½å›½é™…æœåŠ¡è´¸æ˜“äº¤æ˜“ä¼š â€œå¤§æ¨¡å‹é©±åŠ¨ä¼ä¸šæ•°æ™ºåŒ–è½¬å‹è®ºå›â€ ä¸Šå…¬å¸ƒ 2025å¹´åå¤§äººå·¥æ™ºèƒ½AI4SEâ€œé“¶å¼¹â€æ ‡æ†æ¡ˆä¾‹ã€‚â€œ<strong>ç™¾åº¦åŸºäºç¼–ç æ™ºèƒ½ä½“Zuluçš„ææ•ˆå®è·µâ€æˆåŠŸå…¥é€‰ã€‚</strong> AI4SEâ€œé“¶å¼¹â€æ¡ˆä¾‹æ—¨åœ¨å‘æ˜å’Œæ¨å¹¿èƒ½å¤Ÿæ˜¾è‘—æå‡è½¯ä»¶ç ”å‘æ•ˆç‡ä¸è´¨é‡çš„å…¸å‹è½åœ°å®è·µã€‚<strong>æ–‡å¿ƒå¿«ç çš„å…¥é€‰ä½“ç°äº†å…¶åœ¨æ¨åŠ¨AIèµ‹èƒ½è½¯ä»¶å·¥ç¨‹é¢†åŸŸçš„æŒç»­çªç ´ä¸é¢†å…ˆå®åŠ›ã€‚</strong></p>
<h3 data-id="heading-8">6.2025æœè´¸ä¼šâ€œæ•°æ™ºå½±å“åŠ›â€å…ˆé”‹æ¡ˆä¾‹</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/59ac6e1f5f564179858c5f6423c72fb8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883054&amp;x-signature=K3WOtx5Rju0%2FVafutT54N56o1xw%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>2025å¹´9æœˆï¼Œåœ¨2025ä¸­å›½å›½é™…æœåŠ¡è´¸æ˜“äº¤æ˜“ä¼šâ€œå¤§æ¨¡å‹é©±åŠ¨ä¼ä¸šæ•°æ™ºåŒ–è½¬å‹è®ºå›â€ä¸Šï¼Œâ€œ<strong>ç™¾åº¦æ™ºèƒ½ä»£ç åŠ©æ‰‹â€”â€”æ–‡å¿ƒå¿«ç çš„ææ•ˆå®è·µâ€å…¥é€‰â€œæ•°æ™ºå½±å“åŠ›â€å…ˆé”‹æ¡ˆä¾‹ã€‚</strong> æ ‡å¿—ç€å…¶åœ¨æ¨åŠ¨è½¯ä»¶å¼€å‘äº§ä¸šæ™ºèƒ½åŒ–è½¬å‹æ–¹é¢çš„å“è¶Šæˆæœè·å¾—äº†å…¨çƒæœåŠ¡è´¸æ˜“é¢†åŸŸçš„é«˜åº¦è®¤å¯ã€‚</p>
<h3 data-id="heading-9">7.AI+ç ”å‘å·¥å…·å…ˆé”‹å¥–</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f87279a391094c01b6d4eeee34e72f99~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883054&amp;x-signature=KJPZjKQ58vUVZuBZCenJ3B2JIIw%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>2025å¹´12æœˆï¼Œåœ¨AiDDå³°ä¼šï¼ˆå…¨çƒè½¯ä»¶å¼€å‘å¤§ä¼šï¼‰ä¸Šï¼Œç™¾åº¦æ–‡å¿ƒå¿«ç å‡­å€Ÿå…¶åœ¨AI+ç ”å‘é¢†åŸŸçš„çªç ´æ€§è´¡çŒ®ï¼Œ<strong>è£è†ºç»„å§”ä¼šé¢å‘çš„â€œAI+ç ”å‘å·¥å…·å…ˆé”‹å¥–â€ã€‚</strong> ä½œä¸ºâ€œAI+ç ”å‘â€èµ›é“çš„å¼€æ‹“è€…ï¼Œæ–‡å¿ƒå¿«ç æ™ºèƒ½ç ”å‘è§£å†³æ–¹æ¡ˆï¼Œæ¨åŠ¨äº†è¡Œä¸šå‘æ™ºèƒ½åŒ–ã€è‡ªåŠ¨åŒ–ç ”å‘æ¨¡å¼çš„ç³»ç»Ÿæ€§æ¼”è¿›ï¼Œ<strong>å±•ç°äº†ç™¾åº¦åœ¨AIèµ‹èƒ½äº§ä¸šå‡çº§æ–¹é¢çš„æŠ€æœ¯å®åŠ›ä¸ç”Ÿæ€å½±å“åŠ›ã€‚</strong></p>
<h3 data-id="heading-10">8.2025XOpsåˆ›æ–°å®è·µå¥–</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/36d6f23592674acd8450e01725edd1fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883054&amp;x-signature=TaaAVDs28yPrcOIBdfPFvkSz8Fo%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>åœ¨ç¬¬å…­å±ŠITæ–°æ²»ç†é¢†å¯¼åŠ›è®ºå›ï¼Œç™¾åº¦æ–‡å¿ƒå¿«ç <strong>å‡­å€Ÿå…¶å¼€åˆ›æ€§çš„â€œæ™ºèƒ½ä½“äººæœºååŒç ”å‘æ–°èŒƒå¼â€å®è·µï¼Œè£è·â€œ2025 XOpsåˆ›æ–°å®è·µâ€å¥–ã€‚</strong> æ–‡å¿ƒå¿«ç ä»¥å…¶æ™ºèƒ½ä½“ä¸ºæ ¸å¿ƒï¼Œæ„å»ºäº†é«˜æ•ˆçš„äººæœºååŒä½“ç³»ï¼Œæ˜¾è‘—æå‡äº†ä»£ç ç”Ÿæˆã€æµ‹è¯•ã€è¿ç»´çš„è‡ªåŠ¨åŒ–å’Œæ™ºèƒ½åŒ–æ°´å¹³ã€‚</p>
<h2 data-id="heading-11">å››ã€ç¤¾ä¼šä»·å€¼ä¸ä¼ä¸šæˆ˜ç•¥â€”â€”è·µè¡Œç§‘æŠ€å‘å–„ï¼Œè½å®æŠ€æœ¯æ™®æƒ </h2>
<h3 data-id="heading-12">9.å¯åŠä¿¡æ¯æ— éšœç¢ä¼˜ç§€æ¡ˆä¾‹</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/351e01ed3bc74ccc9b324bedb1e7ff2a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883054&amp;x-signature=y4860hrUM26HgY50Ix0DMyXQuMY%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>åœ¨2025å¹´ä¿¡æ¯æ— éšœç¢é¢†åŸŸè¯„é€‰ä¸­ï¼Œç™¾åº¦æ–‡å¿ƒå¿«ç æ— éšœç¢é€‚é…ç‰ˆ<strong>å‡­å€Ÿå…¶åˆ›æ–°çš„æŠ€æœ¯ç†å¿µä¸åˆ‡å®çš„ç¤¾ä¼šä»·å€¼ï¼Œè£è†ºâ€œå¯åŠä¿¡æ¯æ— éšœç¢ä¼˜ç§€æ¡ˆä¾‹â€å¥–é¡¹ã€‚</strong> æ–‡å¿ƒå¿«ç ä»¥AIæŠ€æœ¯å¼¥åˆæ•°å­—é¸¿æ²Ÿï¼Œä¸ä»…ä½“ç°äº†ç™¾åº¦ <strong>â€œç”¨ç§‘æŠ€è®©å¤æ‚çš„ç¤¾ä¼šæ›´ç®€å•â€</strong> çš„ç¤¾ä¼šè´£ä»»æ‹…å½“ï¼Œæ›´ä¸ºæ¨åŠ¨ç ”å‘å·¥å…·æ™®æƒ åŒ–ã€æ„å»ºåŒ…å®¹æ€§æ•°å­—ç”Ÿæ€æ ‘ç«‹äº†è¡Œä¸šæ ‡æ†ã€‚</p>
<h3 data-id="heading-13">10.2025ç™¾åº¦é«˜ä»·å€¼ä¸“åˆ©å¥–</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7ebd3642d7d4e0c97ef7cbb0ae4da38~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5paH5b-D5b-r56CBQmFpZHVDb21hdGU=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883054&amp;x-signature=tRSlb37sTdK5N7GVIyIr%2FofpZzI%3D" alt="" loading="lazy"/><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer"/></p>
<p>2025å¹´ï¼Œ<strong>å‡­å€Ÿæ ¸å¿ƒæŠ€æœ¯æˆæœâ€œäº‘ç«¯ä»£ç å¼€å‘ç³»ç»Ÿã€æ–¹æ³•ã€è£…ç½®ã€è®¾å¤‡åŠå‚¨å­˜ä»‹è´¨â€ï¼Œè£è·â€œç™¾åº¦é«˜ä»·å€¼ä¸“åˆ©å¥–â€ã€‚</strong> è¯¥å¥–é¡¹ä½“ç°äº†ç™¾åº¦åœ¨AIå¼€å‘å·¥å…·é¢†åŸŸæŒç»­æŠ•å…¥æ‰€å½¢æˆçš„æŠ€æœ¯å£å’ä¸çŸ¥è¯†äº§æƒä¼˜åŠ¿ã€‚</p>
<h2 data-id="heading-14">å¯„è¯­</h2>
<p>è£è€€å±äºè¿‡å»ï¼Œå¥‹æ–—å®šä¹‰æœªæ¥ã€‚æ„Ÿæ©2025å¹´æ¥è‡ªè¡Œä¸šã€æœºæ„çš„æ¯ä¸€ä»½è®¤å¯ä¸ä¿¡èµ–ï¼Œè¿™ä¸ä»…æ˜¯æ–‡å¿ƒå¿«ç å‰è¡Œè·¯ä¸Šçš„ç’€ç’¨æ³¨è„šï¼Œæ›´æ˜¯æˆ‘ä»¬è‚©è´Ÿçš„è´£ä»»ä¸æœŸè®¸ã€‚è¿ˆå‘2026ï¼Œæˆ‘ä»¬å°†ç»§ç»­ä»¥åˆ›æ–°ä¸ºç‚¬ï¼Œç»§ç»­æ·±è€•â€œAI+è½¯ä»¶å·¥ç¨‹â€çš„æŠ€æœ¯æ·±æ°´åŒºï¼Œä¸æ–­çªç ´æ™ºèƒ½ç ”å‘çš„æ•ˆèƒ½è¾¹ç•Œã€‚æ–‡å¿ƒå¿«ç å°†ä»¥æ›´åšå®çš„æŠ€æœ¯ã€æ›´å¼€æ”¾çš„ç”Ÿæ€ï¼Œå›é¦ˆæ¯ä¸€ä»½æ”¯æŒï¼Œä¸è¡Œä¸šå¹¶è‚©åŒè¡Œï¼Œå…±åŒè¿æ¥è½¯ä»¶å¼€å‘æ™ºèƒ½åŒ–å˜é©çš„æ˜Ÿè¾°å¤§æµ·ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Windows ä¹Ÿèƒ½è·‘ OpenClawï¼æœ€å®Œæ•´å®‰è£…æ•™ç¨‹ + é£ä¹¦æ¥å…¥ï¼Œå…¨ç¨‹é¿å‘]]></title>    <link>https://juejin.cn/post/7603142147642196011</link>    <guid>https://juejin.cn/post/7603142147642196011</guid>    <pubDate>2026-02-05T07:58:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603142147642196011" data-draft-id="7603030564837392438" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Windows ä¹Ÿèƒ½è·‘ OpenClawï¼æœ€å®Œæ•´å®‰è£…æ•™ç¨‹ + é£ä¹¦æ¥å…¥ï¼Œå…¨ç¨‹é¿å‘"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜,AIGC,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-02-05T07:58:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åˆ«æƒ¹CC"/> <meta itemprop="url" content="https://juejin.cn/user/4095037267779687"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Windows ä¹Ÿèƒ½è·‘ OpenClawï¼æœ€å®Œæ•´å®‰è£…æ•™ç¨‹ + é£ä¹¦æ¥å…¥ï¼Œå…¨ç¨‹é¿å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4095037267779687/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åˆ«æƒ¹CC
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T07:58:42.000Z" title="Thu Feb 05 2026 07:58:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>âš ï¸ å°è´´å£«ï¼šåœ¨å¼€å§‹ä¹‹å‰ï¼Œæœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„æé†’ï¼šç”±äºæ­¤ç±»å·¥å…·æ¶‰åŠè‡ªåŠ¨åŒ–æ“ä½œå’Œç¯å¢ƒé…ç½®ï¼Œå¦‚æœä½ çš„ç”µè„‘å­˜æœ‰é‡è¦çš„å•†ä¸š/èµ„äº§æˆ–ä¸ªäººéšç§ä¿¡æ¯ï¼Œ<strong>å¼ºçƒˆå»ºè®®å¼„ä¸€å°å¹²å‡€çš„å¤‡ç”¨è®¾å¤‡ï¼Œæˆ–è€…ç›´æ¥ç§Ÿç”¨ä¸€ä¸ªäº‘ç«¯è™šæ‹Ÿæœºï¼ˆVPSï¼‰æ¥è¿è¡Œã€‚</strong> è¿™æ ·æ—¢èƒ½ä¿æŠ¤éšç§ï¼Œä¹Ÿèƒ½é¿å…ç¯å¢ƒå†²çªã€‚</p>
</blockquote>
<p>æœ€è¿‘ <strong>OpenClaw</strong> çƒ­åº¦å¾ˆé«˜ï¼Œä½†å®˜æ–¹å¯¹ <strong>Windows åŸç”Ÿç¯å¢ƒ</strong>å¹¶ä¸ç®—å‹å¥½ï¼Œå¾ˆå¤šäººä¼šå¡åœ¨ Node ç¯å¢ƒã€æƒé™ã€è·¯å¾„ã€æ’ä»¶å®‰è£…ç­‰é—®é¢˜ä¸Šã€‚ä¸‹é¢æˆ‘æŠŠè‡ªå·±å®Œæ•´è·‘é€šçš„æµç¨‹æ•´ç†æˆä¸€ç¯‡â€œç…§åšå°±èƒ½æˆâ€çš„æ•™ç¨‹ï¼šä»ç¯å¢ƒå‡†å¤‡ â†’ OpenClaw å®‰è£… â†’ åˆå§‹åŒ–é…ç½® â†’ <strong>æ¥å…¥é£ä¹¦æœºå™¨äºº</strong>ï¼Œæœ€åå†è¡¥ä¸€ä»½å¸¸ç”¨æ’é”™å‘½ä»¤ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ç¯å¢ƒå‡†å¤‡</h2>
<h3 data-id="heading-1">1ï¼‰å®‰è£… nvm for Windowsï¼ˆå»ºè®®ç”¨æœ€æ–°ç‰ˆï¼‰</h3>
<p><strong>Windows ç”¨æˆ·</strong> åˆ° GitHub Releases ä¸‹è½½ <code>nvm-setup.exe</code>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fcoreybutler%2Fnvm-windows%2Freleases" target="_blank" title="https://github.com/coreybutler/nvm-windows/releases" ref="nofollow noopener noreferrer">github.com/coreybutlerâ€¦</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/37bc339dcc8c43cb9bb38a0668f7fcaf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=uPTeJKXAsHhnx1goZXysFyyRz%2BA%3D" alt="1.png" loading="lazy"/></p>
<p>å®‰è£…è¿‡ç¨‹ä¸€è·¯ Next å³å¯ã€‚å®‰è£…æˆåŠŸåå»ºè®®ä½ ç”¨ <strong>ç®¡ç†å‘˜æƒé™</strong>æ‰“å¼€ PowerShellï¼š</p>
<ul>
<li>æŒ‰ <strong>Win é”® + S</strong></li>
<li>æœç´¢ <strong>PowerShell</strong></li>
<li>é¼ æ ‡å³é”® â†’ <strong>ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ</strong></li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18d05ee8ba88475bb627d4c764fcfb60~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=ff2Ks1qaV3dqAhlvEr%2F1ZO1N9QU%3D" alt="2.png" loading="lazy"/></p>
<h3 data-id="heading-2">2.å®‰è£… node.js 22.22.0 ç‰ˆæœ¬</h3>
<p>æŒ‰ç…§é¡ºåºåˆ†åˆ«åœ¨ <code>powershell</code> ä¸­è¿è¡Œä¸‹åˆ—æŒ‡ä»¤ã€‚</p>
<pre><code class="hljs language-powershell" lang="powershell"># å®‰è£…æŒ‡ä»¤
nvm install 22

# ä½¿ç”¨æŒ‡ä»¤
nvm use 22.22.0
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a96291aab9274019af9d0cd804cae559~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=r1LSdREFT3K7mTdNnleaSTubJcM%3D" alt="3.png" loading="lazy"/></p>
<p>æˆåŠŸåä¼šçœ‹åˆ°ç±»ä¼¼æç¤ºï¼š<code>Now using node v22.22.0</code></p>
<blockquote>
<p>å¦‚æœä½ ä»ç„¶ä¸‹è½½å¤±è´¥ï¼Œæˆ–è€…å…¬å¸ç½‘ç»œæ‹¦æˆªäº†ä¸‹è½½ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨å»å®˜ç½‘ä¸‹è½½å®‰è£…ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fzh-cn%2Fdownload" target="_blank" title="https://nodejs.org/zh-cn/download" ref="nofollow noopener noreferrer">nodejs.org/zh-cn/downlâ€¦</a></p>
</blockquote>
<h2 data-id="heading-3">äºŒã€å®‰è£… + é…ç½® OpenClaw</h2>
<h3 data-id="heading-4">1ï¼‰ä¸€é”®å®‰è£…ï¼ˆPowerShellï¼‰</h3>
<p>åœ¨ <strong>ç®¡ç†å‘˜ PowerShell</strong> ä¸­è¿è¡Œï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">iwr -useb https://openclaw.ai/install.ps1 | iex
</code></pre>
<p>å¦‚æœé‡åˆ°æ‰§è¡Œç­–ç•¥æŠ¥é”™ï¼ˆå¸¸è§äºé¦–æ¬¡è¿è¡Œè„šæœ¬ï¼‰ï¼Œåœ¨ PowerShell è¾“å…¥ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c1e1a8aa13404874aa31b1b8a71fcaec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=xW6EJeCaMUVjZ2rbQm3%2BjBZJcEE%3D" alt="4.png" loading="lazy"/></p>
<h3 data-id="heading-5">2ï¼‰åˆå§‹åŒ–é…ç½®</h3>
<p>å®‰è£…å®Œæˆåé€šå¸¸ä¼šè‡ªåŠ¨è¿›å…¥é…ç½®æµç¨‹ã€‚
å¦‚æœä½ ä¸å°å¿ƒå…³é—­äº† PowerShellï¼Œé‡æ–°æ‰“å¼€åæ‰§è¡Œï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">openclaw onboard --flow quickstart
</code></pre>
<p>ç¬¬ä¸€ä¸ªé£é™©æç¤ºï¼š</p>
<blockquote>
<p>I understand this is powerful and inherently risky. Continue?</p>
</blockquote>
<p>é€‰æ‹© <strong>Yes</strong>ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9fb74ec6a75441f7b11b96f96ba4dfc5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=Gdm6csrAoM%2Bxr3UQ9ilvMYGwLGc%3D" alt="5.png" loading="lazy"/></p>
<p>å¦‚æœæœ‰å°ä¼™ä¼´é‡åˆ°è¿™ä¸ªé—®é¢˜ï¼šç³»ç»Ÿä¸çŸ¥é“å®ƒè¢«å®‰è£…åœ¨å“ªé‡Œäº†ã€‚å¤„ç†æ–¹å¼é€šå¸¸å¾ˆç®€å•ï¼š</p>
<blockquote>
<ul>
<li><strong>å…³é—­å½“å‰ PowerShell</strong></li>
<li><strong>é‡æ–°ç”¨ç®¡ç†å‘˜æ–¹å¼æ‰“å¼€ PowerShell</strong></li>
<li>ä¸€èˆ¬ <code>nvm</code>/ç¯å¢ƒå˜é‡ä¼šè‡ªåŠ¨åˆ·æ–°è·¯å¾„ï¼Œé—®é¢˜å³å¯æ¶ˆå¤±</li>
</ul>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/49925214147e446f90a6c7c403e07ce4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=wcNv7PJkF%2FCbIArk18eZSkXUtAc%3D" alt="7.png" loading="lazy"/></p>
<p>ä¹‹åæŒ‰æç¤ºé€‰æ‹©æ¨¡å‹ã€‚æˆ‘è¿™é‡Œç¤ºä¾‹ç”¨çš„æ˜¯ <strong>Kimi</strong>ï¼Œä½ ä¹Ÿå¯ä»¥æŒ‰è‡ªå·±ä¹ æƒ¯é€‰æ‹©ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/605f91a9d9924256a68a83d883dff7ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=hm83q3D%2FonPWJT6IWOHIPldUGAc%3D" alt="8.png" loading="lazy"/></p>
<p>å¯ä»¥çœ‹ä¸‹é…ç½®ï¼Œä¸»è¦è¾“å…¥API  keyï¼Œå…¶ä»–éƒ½å¯ä»¥é»˜è®¤ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e19602e5230742e284b0e69ad4c0d020~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=ZpgZxx6gXGuEO6O6oQ6p7TkCDYY%3D" alt="9.png" loading="lazy"/></p>
<p>æ¥ç€é…ç½®é€šè®¯å·¥å…·ï¼Œè™½ç„¶å®˜æ–¹è¿™é‡Œç›´æ¥å¯ä»¥é€‰é£ä¹¦ï¼Œä½†å®˜æ–¹æ–‡æ¡£æ˜ç¡®å»ºè®® <strong>Windows é€šè¿‡ WSL2 è¿è¡Œ</strong>ï¼Œå¹¶ä¸”æåˆ°åŸç”Ÿ Windows æœªæµ‹è¯•ã€æ›´å®¹æ˜“å‡ºé—®é¢˜ã€‚å¹¶ä¸”æˆ‘å®æµ‹è¿™é‡Œä¸‹è½½æ’ä»¶ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œå…ˆè·³è¿‡ï¼Œåç»­å†å®‰è£…ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2a7ad10229ca4b329d81bb6adb4e9b6d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=Mk86ZoZxlv111T1OFlpKBvs8Sic%3D" alt="11.png" loading="lazy"/></p>
<p>skillä¹Ÿå…ˆè·³è¿‡ï¼Œåç»­å’±ä»¬åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­æ ¹æ®è‡ªå·±çš„å·¥ä½œæµæ…¢æ…¢è¿­ä»£è‡ªå·±çš„skillã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc4331d063754f92ad641c657cda633d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=3rt3v3aDB%2BcZ%2B5GzjSNgqiikcJs%3D" alt="12.png" loading="lazy"/></p>
<p>å®‰è£…å¯åŠ¨ç½‘å…³åï¼Œå®ƒä¼šè‡ªåŠ¨æ–°å¼€ä¸€ä¸ª PowerShell çª—å£ï¼Œéƒ½ä¸è¦å…³é—­ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fbbe48a09c064117aad539748ad8c130~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=kdMzJ77ZX%2FjLBYvm0Bx2fkMSxGo%3D" alt="13.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b06d6a5211dc4b3baecb867c7e7b0360~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=NHrTxSjXPRL65%2BwajTcInq6lG2A%3D" alt="14.png" loading="lazy"/></p>
<p>æµè§ˆå™¨ä¼šè‡ªåŠ¨æ‰“å¼€æ§åˆ¶å°ã€‚åç»­ä½ ä¹Ÿå¯ä»¥ç›´æ¥è®¿é—®ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2F127.0.0.1%3A18789%2F" target="_blank" title="http://127.0.0.1:18789/" ref="nofollow noopener noreferrer">http://127.0.0.1:18789/</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b29ea936ddc1486eae25ec47ccaba6b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=a2kyjAYc4%2Bk8MRjpBB6VgLVFsBQ%3D" alt="15.png" loading="lazy"/></p>
<p>å‘æ¶ˆæ¯æµ‹è¯•ï¼Œæœ‰å›å¤å°±è¯´æ˜å®‰è£…æˆåŠŸï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b3db6be653243069073215c181f80e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=gere4Pt2inaARPMNSOofBbIErT0%3D" alt="16.png" loading="lazy"/></p>
<h2 data-id="heading-6">ä¸‰ã€é…ç½®è¿æ¥é£ä¹¦</h2>
<p>æ•´ä½“æ€è·¯æ˜¯ä¸¤æ­¥ï¼š</p>
<ol>
<li>åœ¨ OpenClaw é‡Œå®‰è£…é£ä¹¦æ’ä»¶</li>
<li>åœ¨é£ä¹¦å¼€æ”¾å¹³å°åˆ›å»ºåº”ç”¨ â†’ é…æƒé™/äº‹ä»¶ â†’ å‘å¸ƒç‰ˆæœ¬ â†’ å›åˆ° OpenClaw å¡« AppID/Secret</li>
</ol>
<h3 data-id="heading-7">1ï¼‰å®‰è£…é£ä¹¦æ’ä»¶</h3>
<p>ä½ å¯ä»¥åœ¨æ§åˆ¶å°é‡Œè®©å®ƒå¸®ä½ æ‰§è¡Œå®‰è£…å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">openclaw plugins install @m1heng-clawd/feishu
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92eb563ef66046f99663e0b783cf7dc8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=6Fu%2Facx3Sq2KpJGF1P5lwtoSsuY%3D" alt="17.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8655dae9cb7d4f6a824d7afa1b40c46f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=mDjDaFqjOunB0di04G1OlDASq2E%3D" alt="18.png" loading="lazy"/></p>
<blockquote>
<p>æ’ä»¶å®‰è£…å¯èƒ½è¦ç­‰ä¸€ä¼šå„¿ï¼Œè¿™æ®µæ—¶é—´ä½ å¯ä»¥å»é£ä¹¦å¼€æ”¾å¹³å°æŠŠåº”ç”¨å…ˆå»ºå¥½ã€‚</p>
</blockquote>
<h3 data-id="heading-8">2ï¼‰é£ä¹¦å¼€æ”¾å¹³å°åˆ›å»ºåº”ç”¨</h3>
<p>è¿›å…¥é£ä¹¦å¼€æ”¾å¹³å°ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.feishu.cn%2F%25EF%25BC%258C%25E5%2588%259B%25E5%25BB%25BA%25E4%25B8%2580%25E4%25B8%25AA%25E5%25BA%2594%25E7%2594%25A8%25EF%25BC%258C%25E5%25B9%25B6%25E6%25B7%25BB%25E5%258A%25A0%25E6%259C%25BA%25E5%2599%25A8%25E4%25BA%25BA%25E5%25BA%2594%25E7%2594%25A8%25E8%2583%25BD%25E5%258A%259B%25E3%2580%2582" target="_blank" title="https://open.feishu.cn/%EF%BC%8C%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%BA%94%E7%94%A8%EF%BC%8C%E5%B9%B6%E6%B7%BB%E5%8A%A0%E6%9C%BA%E5%99%A8%E4%BA%BA%E5%BA%94%E7%94%A8%E8%83%BD%E5%8A%9B%E3%80%82" ref="nofollow noopener noreferrer">open.feishu.cn/ï¼Œåˆ›å»ºä¸€ä¸ªåº”ç”¨ï¼Œå¹¶æ·»åŠ â€¦</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de92703fe3854d6a991f5d24628f0a3a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=4mrZ2zRIB%2BvceNoEmGtbhmOyNEM%3D" alt="19.png" loading="lazy"/></p>
<p>ç„¶åæŠŠ <strong>App ID</strong> å’Œ <strong>App Secret</strong> å¤åˆ¶å‡ºæ¥å¤‡ç”¨ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/960d82e1c33546959f087c49364cf475~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=4%2F9GNQ%2BDdWgb0TTKmq991AhNOGQ%3D" alt="20.png" loading="lazy"/></p>
<p>æŠŠè¿™ä¸¤é¡¹æä¾›ç»™ OpenClaw ï¼Œè®©å®ƒå®Œæˆé…ç½®ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30220fa6129047eba58d3c062163064e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=hnAYZixJqsK1ZJyJPALrppK%2Bzvo%3D" alt="20-1.png" loading="lazy"/></p>
<h3 data-id="heading-9">3ï¼‰æ‰¹é‡å¯¼å…¥æƒé™</h3>
<p>è¿›å…¥ <strong>æƒé™ç®¡ç†</strong> â†’ æ‰¾åˆ°ã€Œæ‰¹é‡å¯¼å…¥å¯¼å‡ºæƒé™ã€â†’ æƒé™é…ç½® JSON â†’ ç²˜è´´å¯¼å…¥ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scopes"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"tenant"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-string">"aily:file:read"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"aily:file:write"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"application:application.app_message_stats.overview:readonly"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"application:application:self_manage"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"application:bot.menu:write"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"contact:user.employee_id:readonly"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"corehr:file:download"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"event:ip_list"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"im:chat.access_event.bot_p2p_chat:read"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"im:chat.members:bot_access"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"im:message"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"im:message.group_at_msg:readonly"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"im:message.p2p_msg:readonly"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"im:message:readonly"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"im:message:send_as_bot"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">"im:resource"</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"user"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"aily:file:read"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"aily:file:write"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"im:chat.access_event.bot_p2p_chat:read"</span><span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å¯¼å…¥å®Œæˆåç‚¹å‡»ã€Œç¡®è®¤æ–°å¢æƒé™ã€ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb41ddaca6dc48fda9561c0ca1a96072~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=T5CL5kZ%2B7ZCI1fV9bJaHaxEHgkc%3D" alt="21.png" loading="lazy"/></p>
<h3 data-id="heading-10">4ï¼‰äº‹ä»¶è®¢é˜…</h3>
<p>è¿›å…¥ã€Œäº‹ä»¶ä¸å›è°ƒã€é¡µé¢ï¼š</p>
<ul>
<li>ã€Œäº‹ä»¶é…ç½®ã€â†’ã€Œè®¢é˜…æ–¹å¼ã€</li>
<li>é€‰æ‹©ï¼š<strong>ä½¿ç”¨é•¿è¿æ¥æ¥æ”¶äº‹ä»¶</strong></li>
<li>ä¿å­˜</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a900916b4654ffeb7ece91fae52d655~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=YYlV1Cs2OXeT7VrHGoLWXBezZLs%3D" alt="22.png" loading="lazy"/></p>
<blockquote>
<p>å¦‚æœæç¤ºâ€œæ²¡æœ‰å»ºç«‹é•¿è¿æ¥â€ï¼š</p>
<ul>
<li>å…ˆåˆ«æ…Œï¼Œé€šå¸¸ç­‰ 1ï½2 åˆ†é’Ÿå†ç‚¹ä¿å­˜å°±å¥½</li>
<li>å¦‚æœç­‰å¾ˆä¹…ä»ä¸è¡Œï¼Œä¼˜å…ˆæ£€æŸ¥ <strong>OpenClaw ç½‘å…³æ˜¯å¦æ­£å¸¸è¿è¡Œ</strong>ï¼Œå¹¶æŸ¥çœ‹æ—¥å¿—ï¼ˆä¸‹é¢ç¬¬å››éƒ¨åˆ†ç»™äº†å‘½ä»¤ï¼‰</li>
</ul>
</blockquote>
<h3 data-id="heading-11">5ï¼‰æ·»åŠ æ¥æ”¶æ¶ˆæ¯äº‹ä»¶</h3>
<p>åœ¨ã€Œäº‹ä»¶é…ç½®ã€é¡µé¢ç‚¹å‡»ã€Œæ·»åŠ äº‹ä»¶ã€ï¼Œæœç´¢å¹¶æ·»åŠ ï¼š</p>
<ul>
<li><code>im.message.receive_v1</code></li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bfc212bebfeb4ddfa56522801cfd0234~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=76Z84VjoXbcnCAhs6r4yUTJaKrg%3D" alt="23.png" loading="lazy"/></p>
<blockquote>
<p>ä¸æ·»åŠ è¿™ä¸ªäº‹ä»¶ï¼Œæœºå™¨äººå°±æ— æ³•æ”¶åˆ°ä½ çš„æ¶ˆæ¯ã€‚</p>
</blockquote>
<h3 data-id="heading-12">6ï¼‰å‘å¸ƒç‰ˆæœ¬</h3>
<p>è¿›å…¥ã€Œç‰ˆæœ¬ç®¡ç†ä¸å‘å¸ƒã€ï¼š</p>
<ul>
<li>åˆ›å»ºç‰ˆæœ¬</li>
<li>å‘å¸ƒ</li>
</ul>
<p>åªæœ‰å‘å¸ƒåï¼Œå‰é¢çš„é…ç½®æ‰ä¼šçœŸæ­£ç”Ÿæ•ˆã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/51bbee8f79aa438cba32668d7326cae5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=EeS0zraMXSXFXPXv%2Bg8v79Sx4G8%3D" alt="24.png" loading="lazy"/></p>
<p>ç„¶ååœ¨é£ä¹¦é‡Œæ‰¾åˆ°ä½ åˆšåˆ›å»ºçš„æœºå™¨äººï¼Œå‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œå®ƒä¼šè‡ªåŠ¨å›å¤ä¸€ä¸ªé…å¯¹ç </p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f7e0fa260f5419587638caa4a680261~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=XrLshMDNpIOUvgpTussheMy6uBw%3D" alt="25.png" loading="lazy"/></p>
<p>å¤åˆ¶è¿™ä¸ªé…å¯¹ç ï¼Œæ‰“å¼€ Clawdbot çš„ Web UIï¼ˆå°±æ˜¯å‰é¢é‚£ä¸ªæ§åˆ¶å°ï¼‰ï¼ŒæŠŠé…å¯¹ç å‘ç»™å®ƒï¼ŒClawdbot ä¼šè‡ªåŠ¨å®Œæˆç»‘å®šã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f2177ca181c4b889deb7aab211272fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=mxK8jd%2By%2BBICCbaAXvWynROfaIA%3D" alt="26.png" loading="lazy"/></p>
<p>ç»‘å®šæˆåŠŸåï¼Œä½ å°±å¯ä»¥åœ¨é£ä¹¦é‡Œè·Ÿ Clawdbot æ„‰å¿«äº¤æµäº†ï¼Œä¹Ÿå¯ä»¥æŠŠæœºå™¨äººæ‹‰åˆ°å…¬å¸ç¾¤é‡Œï¼Œè®©æ‰€æœ‰å°ä¼™ä¼´éƒ½èƒ½ç”¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/633ab41e53e347918d013af6c3c54c40~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yir5oO5Q0M=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770883122&amp;x-signature=qKftuS4vOMmfBtISIv2flG51klw%3D" alt="27.png" loading="lazy"/></p>
<h2 data-id="heading-13">å››ã€å¸¸ç”¨å‘½ä»¤ï¼ˆæ’æŸ¥/ä¿®å¤å¿…å¤‡ï¼‰</h2>
<p>ä¸‹é¢è¿™äº›å‘½ä»¤éå¸¸å®ç”¨ï¼šé…ç½®è¿‡ç¨‹ä¸­é‡åˆ°å¡æ­»ã€æ’ä»¶å¼‚å¸¸ã€ç½‘å…³æ²¡èµ·ç­‰é—®é¢˜ï¼Œä¼˜å…ˆç”¨å®ƒä»¬è‡ªæŸ¥ã€‚</p>
<pre><code class="hljs language-powershell" lang="powershell"># å¯åŠ¨ç½‘å…³
openclaw gateway start

# é‡å¯ç½‘å…³ï¼ˆåˆ·æ–°æœºå™¨äººçŠ¶æ€ï¼‰
openclaw gateway restart

# é‡ç½®/æ›´æ”¹ API ç­‰é…ç½®
openclaw config

# è¯Šæ–­æ£€æŸ¥
openclaw doctor

# å®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼ˆå¼ºçƒˆæ¨èï¼šå‡º bug åŸºæœ¬éƒ½é å®ƒå®šä½ï¼‰
openclaw logs follow
</code></pre>
<p>å¥½äº†ï¼Œè¿™å°±æ˜¯æ•´ä¸ªå®‰è£…å’Œé…ç½®æµç¨‹ã€‚</p>
<p>å¦‚æœä½ è§‰å¾—å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œå¯ä»¥å¸®æˆ‘ç‚¹ä¸ªèµğŸ‘ï¼Œä¹Ÿå¯ä»¥è½¬å‘ç»™å…¶ä»–ä½ è§‰å¾—éœ€è¦çš„æœ‹å‹ä»¬ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯å¹¶å‘å¤„ç†æœ€ä½³å®è·µï¼šToken å…±äº«èµ„æºçš„å•ä¾‹ Promise æ¨¡å¼]]></title>    <link>https://juejin.cn/post/7602553969971052598</link>    <guid>https://juejin.cn/post/7602553969971052598</guid>    <pubDate>2026-02-04T09:51:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602553969971052598" data-draft-id="7602543146237591595" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯å¹¶å‘å¤„ç†æœ€ä½³å®è·µï¼šToken å…±äº«èµ„æºçš„å•ä¾‹ Promise æ¨¡å¼"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-04T09:51:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€æ‹³ä¸æ˜¯è¶…äºº"/> <meta itemprop="url" content="https://juejin.cn/user/3456520289261902"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯å¹¶å‘å¤„ç†æœ€ä½³å®è·µï¼šToken å…±äº«èµ„æºçš„å•ä¾‹ Promise æ¨¡å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3456520289261902/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€æ‹³ä¸æ˜¯è¶…äºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-04T09:51:04.000Z" title="Wed Feb 04 2026 09:51:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-04
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    17
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°è¿™æ ·çš„åœºæ™¯ï¼šå¤šä¸ªç‹¬ç«‹çš„ç»„ä»¶æˆ–äº‹ä»¶æµï¼ˆEvent Streamï¼‰å‡ ä¹åŒæ—¶è§¦å‘ï¼Œå®ƒä»¬éƒ½éœ€è¦ä¾èµ–åŒä¸€ä¸ªå¼‚æ­¥è·å–çš„èµ„æºâ€”â€”æ¯”å¦‚é‰´æƒ Tokenã€‚</p>
<p>å¦‚æœå¤„ç†ä¸å½“ï¼Œå°±ä¼šå¯¼è‡´Â <strong>Race Conditionï¼ˆç«æ€æ¡ä»¶ï¼‰</strong> Â æˆ–è€…Â <strong>é‡å¤çš„ç½‘ç»œè¯·æ±‚</strong>ã€‚ä»Šå¤©æˆ‘ä»¬æ¥åˆ†äº«ä¸€ç§ç®€å•è€Œå¥å£®çš„æœ€ä½³å®è·µï¼š<strong>Singleton Promise Patternï¼ˆå•ä¾‹ Promise æ¨¡å¼ï¼‰</strong> ã€‚</p>
<h2 data-id="heading-0">å¸¸è§é—®é¢˜ï¼šå¹¶å‘åœ°ç‹±</h2>
<p>å‡è®¾ä½ æœ‰ä¸€ä¸ªÂ <code>audio-to-text</code>ï¼ˆè¯­éŸ³è½¬æ–‡å­—ï¼‰çš„åŠŸèƒ½ï¼Œæ¯æ¬¡è§¦å‘éƒ½éœ€è¦å…ˆè·å–ä¸€ä¸ªä¸´æ—¶çš„ API Tokenã€‚</p>
<p>å¦‚æœç”¨æˆ·è¿ç»­å¿«é€Ÿæ’­æ”¾äº† 3 æ¡è¯­éŸ³ï¼Œæˆ–è€…é¡µé¢åˆå§‹åŒ–æ—¶æœ‰å¤šä¸ªç»„ä»¶åŒæ—¶è¯·æ±‚ Tokenï¼Œå¯èƒ½ä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼š</p>
<ol>
<li><strong>èµ„æºæµªè´¹</strong>ï¼šå‘èµ·äº† 3 æ¬¡è·å– Token çš„ç½‘ç»œè¯·æ±‚ï¼Œä½†å®é™…ä¸Šåªéœ€è¦ 1 æ¬¡ã€‚</li>
<li><strong>çŠ¶æ€ä¸ä¸€è‡´</strong>ï¼šç¬¬ 1 ä¸ªè¯·æ±‚æˆåŠŸäº†ï¼Œä½†åœ¨å®ƒå†™å…¥æœ¬åœ°ç¼“å­˜ä¹‹å‰ï¼Œç¬¬ 2 ä¸ªè¯·æ±‚åˆå‘èµ·äº†ã€‚</li>
<li><strong>æ­»é”/æ— é™ç­‰å¾…</strong>ï¼šä½¿ç”¨ç®€å•çš„Â <code>isLoading</code>Â é”ï¼Œå¦‚æœä»£ç é€»è¾‘åœ¨å¼‚å¸¸å¤„ç†ï¼ˆcatchï¼‰ä¸­é—æ¼äº†é‡ç½®é”ï¼Œå¯¼è‡´åç»­è¯·æ±‚ä¸€ç›´ pendingã€‚</li>
</ol>
<h2 data-id="heading-1">è§£å†³æ–¹æ¡ˆï¼šå•ä¾‹ Promise æ¨¡å¼</h2>
<p>æ ¸å¿ƒæ€æƒ³éå¸¸ç®€å•ï¼š<strong>å°†"æ­£åœ¨è¿›è¡Œçš„è¯·æ±‚"ç¼“å­˜èµ·æ¥ï¼Œè€Œä¸æ˜¯åªç¼“å­˜ç»“æœã€‚</strong></p>
<p>å¯¹äºå…±äº«èµ„æºï¼Œæˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ Promiseã€‚</p>
<ul>
<li>å½“ç¬¬ä¸€ä¸ªè¯·æ±‚è¿›æ¥æ—¶ï¼Œåˆ›å»ºä¸€ä¸ª Promise å¹¶å‘èµ·è¯·æ±‚ã€‚</li>
<li>å½“åç»­è¯·æ±‚è¿›æ¥æ—¶ï¼Œå¦‚æœå‘ç°å·²ç»æœ‰ä¸€ä¸ª Promise åœ¨ pendingï¼Œç›´æ¥å¤ç”¨å¹¶è¿”å›è¿™ä¸ª Promiseã€‚</li>
<li>æ— è®ºæˆåŠŸæˆ–å¤±è´¥ï¼ŒPromise settled åï¼Œæ¸…ç†çŠ¶æ€ï¼Œä»¥ä¾¿ä¸‹æ¬¡å¯ä»¥å‘èµ·æ–°è¯·æ±‚ã€‚</li>
</ul>
<h3 data-id="heading-2">ä»£ç å®ç°æ¨¡æ¿</h3>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå¥å£®çš„å®ç°æ¨¡æ¿ï¼ŒåŒ…å«äº†Â <strong>é˜²æŠ–ï¼ˆDebounceï¼‰</strong> ã€<strong>å¼‚å¸¸å®‰å…¨ï¼ˆException Safetyï¼‰</strong> Â å’ŒÂ <strong>çŠ¶æ€å¤ä½</strong>ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å…¨å±€çŠ¶æ€å˜é‡</span>
<span class="hljs-keyword">let</span> getTokenTask = <span class="hljs-literal">null</span>; <span class="hljs-comment">// å­˜å‚¨æ­£åœ¨è¿›è¡Œçš„ Promise</span>
<span class="hljs-keyword">let</span> isGettingToken = <span class="hljs-literal">false</span>; <span class="hljs-comment">// é”æ ‡è®°</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getSharedToken</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// 1. æ£€æŸ¥æœ¬åœ°ç¼“å­˜æ˜¯å¦æœ‰æ•ˆ</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isTokenValid</span>()) {
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">getTokenFromStorage</span>();
  }
  <span class="hljs-comment">// 2. å¹¶å‘æ‹¦æˆªï¼šå¦‚æœæœ‰æ­£åœ¨è¿›è¡Œçš„ä»»åŠ¡ï¼Œç›´æ¥å¤ç”¨ï¼Œä¸å‘èµ·æ–°è¯·æ±‚</span>
  <span class="hljs-keyword">if</span> (isGettingToken &amp;&amp; getTokenTask) {
    <span class="hljs-keyword">return</span> getTokenTask;
  }
  <span class="hljs-comment">// 3. åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„å•ä¾‹ä»»åŠ¡</span>
  isGettingToken = <span class="hljs-literal">true</span>;
  
  <span class="hljs-comment">// åˆ›å»º Promise é—­åŒ…ï¼Œç¡®ä¿æˆ‘ä»¬å¯ä»¥æ§åˆ¶ resolve</span>
  <span class="hljs-keyword">let</span> taskResolve = <span class="hljs-literal">null</span>;
  getTokenTask = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    taskResolve = resolve;
  });
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// 4. æ‰§è¡Œå®é™…çš„å¼‚æ­¥æ“ä½œ</span>
    <span class="hljs-keyword">const</span> token = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchTokenFromServer</span>();
    
    <span class="hljs-comment">// 5. ç¼“å­˜ç»“æœ</span>
    <span class="hljs-title function_">saveTokenToStorage</span>(token);
    
    <span class="hljs-keyword">return</span> token;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'è·å– Token å¤±è´¥'</span>, error);
    <span class="hljs-keyword">throw</span> error; <span class="hljs-comment">// å‘ä¸Šä¼ é€’é”™è¯¯ï¼Œè®©è°ƒç”¨æ–¹å†³å®šå¦‚ä½•å¤„ç†</span>
  } <span class="hljs-keyword">finally</span> {
    <span class="hljs-comment">// 6. å…³é”®ï¼šæ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½è¦é€šçŸ¥ç­‰å¾…çš„ Promise å¹¶é‡Šæ”¾é”</span>
    <span class="hljs-keyword">if</span> (taskResolve) {
      <span class="hljs-comment">// è·å–å½“å‰æœ€æ–°çš„ token (å¯èƒ½åœ¨ try å—ä¸­å·²ç»å­˜å…¥ï¼Œä¹Ÿå¯èƒ½ä¸ºç©º)</span>
      <span class="hljs-keyword">const</span> currentToken = <span class="hljs-title function_">getTokenFromStorage</span>();
      <span class="hljs-title function_">taskResolve</span>(currentToken);
    }
    
    <span class="hljs-comment">// é‡ç½®çŠ¶æ€ï¼Œå…è®¸ä¸‹ä¸€æ¬¡æ–°çš„è¯·æ±‚å‘èµ·</span>
    isGettingToken = <span class="hljs-literal">false</span>; 
    getTokenTask = <span class="hljs-literal">null</span>;
  }
}
</code></pre>
<h2 data-id="heading-3">ğŸ’¡ æ ¸å¿ƒè®¾è®¡ç‚¹è§£æ</h2>
<h3 data-id="heading-4">1. ä¸ºä»€ä¹ˆè¦è¿”å› Promise è€Œä¸æ˜¯ç­‰å¾…Â <code>await</code>Â åè¿”å›ç»“æœï¼Ÿ</h3>
<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆé€šè¿‡Â <code>if (isGettingToken) return getTokenTask</code>Â ç›´æ¥è¿”å› Promise å¯¹è±¡ã€‚è¿™æ ·ï¼Œä¸‰ä¸ªå¹¶å‘çš„è°ƒç”¨è€…Â <code>await getSharedToken()</code>Â å®é™…ä¸Šæ˜¯åœ¨ç­‰å¾…åŒä¸€ä¸ª Promise å¯¹è±¡ resolveã€‚ä¸€æ—¦ Leader è¯·æ±‚å®Œæˆï¼Œä¸‰ä¸ªè°ƒç”¨è€…ä¼šåŒæ—¶å¾—åˆ°é€šçŸ¥ã€‚</p>
<h3 data-id="heading-5">2. Try...Finally çš„é‡è¦æ€§</h3>
<p>å¹¶å‘æ§åˆ¶ä¸­æœ€æ€•çš„æ˜¯Â  <strong>"æ­»é”"</strong> ã€‚å¦‚æœ API è¯·æ±‚æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä½ å¿˜è®°åœ¨Â <code>catch</code>Â å—ä¸­æŠŠÂ <code>isGettingToken</code>Â è®¾ç½®å›Â <code>false</code>ï¼Œé‚£ä¹ˆæ•´ä¸ªåº”ç”¨çš„ç›¸å…³åŠŸèƒ½å°±ä¼šæ°¸ä¹…å¡æ­»ã€‚ ä½¿ç”¨Â <code>finally</code>Â å—å¯ä»¥ä¿è¯æ— è®ºä»£ç è·¯å¾„å¦‚ä½•ï¼ˆæ­£å¸¸è¿”å›ã€æŠ›å‡ºé”™è¯¯ã€ç”šè‡³æ—©é€€ï¼‰ï¼Œé”ä¸€å®šä¼šè¢«é‡Šæ”¾ã€‚</p>
<h3 data-id="heading-6">3. ä¸è¦ä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºç¼“å­˜ Map</h3>
<p>æœ‰äº›å¼€å‘è€…ä¼šæƒ³ï¼š"æˆ‘æ˜¯ä¸æ˜¯åº”è¯¥ç”¨ä¸€ä¸ª Mapï¼Œæ ¹æ® Request ID æ¥ç¼“å­˜ï¼Ÿ" å¯¹äº Token è¿™ç§Â <strong>å…¨å±€å…±äº«èµ„æº</strong>ï¼Œä¸éœ€è¦ã€‚å› ä¸ºæ— è®ºè°å‘èµ·çš„è¯·æ±‚ï¼Œä»–ä»¬è¦çš„éƒ½æ˜¯åŒä¸€ä¸ªä¸œè¥¿ã€‚Map åªä¼šå¢åŠ å†…å­˜æ³„æ¼çš„é£é™©å’Œç®¡ç†çš„å¤æ‚åº¦ã€‚</p>
<h2 data-id="heading-7">æ€»ç»“</h2>
<p>åœ¨é«˜å¹¶å‘çš„å‰ç«¯åœºæ™¯ä¸‹ï¼Œ<strong>å…±äº«èµ„æºçš„å•ä¾‹ Promise æ¨¡å¼</strong>Â æ˜¯æ€§ä»·æ¯”æé«˜çš„ä¼˜åŒ–æ‰‹æ®µã€‚å®ƒç”¨æå°‘çš„ä»£ç æˆæœ¬ï¼Œå®ç°äº†ï¼š</p>
<ul>
<li><strong>æµé‡èŠ‚çœ</strong>ï¼šN ä¸ªå¹¶å‘è¯·æ±‚åªéœ€ 1 æ¬¡ç½‘ç»œè°ƒç”¨ã€‚</li>
<li><strong>é«˜æ€§èƒ½</strong>ï¼šæ‰€æœ‰è¯·æ±‚å‡ ä¹åŒæ—¶å¾—åˆ°å“åº”ï¼Œæ²¡æœ‰é˜»å¡ã€‚</li>
<li><strong>é«˜å¥å£®æ€§</strong>ï¼šå¼‚å¸¸æƒ…å†µä¸‹ä¹Ÿèƒ½è‡ªåŠ¨æ¢å¤ï¼Œä¸ä¼šå¡æ­»ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PyTorch å…¥é—¨æŒ‡å—ï¼šæ·±åº¦å­¦ä¹ çš„ç‘å£«å†›åˆ€]]></title>    <link>https://juejin.cn/post/7602916406981673001</link>    <guid>https://juejin.cn/post/7602916406981673001</guid>    <pubDate>2026-02-05T06:48:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602916406981673001" data-draft-id="7602914378388996106" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PyTorch å…¥é—¨æŒ‡å—ï¼šæ·±åº¦å­¦ä¹ çš„ç‘å£«å†›åˆ€"/> <meta itemprop="keywords" content="Python,PyTorch"/> <meta itemprop="datePublished" content="2026-02-05T06:48:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å°å¼ è¯´æ•…äº‹"/> <meta itemprop="url" content="https://juejin.cn/user/741501567509111"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PyTorch å…¥é—¨æŒ‡å—ï¼šæ·±åº¦å­¦ä¹ çš„ç‘å£«å†›åˆ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/741501567509111/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å°å¼ è¯´æ•…äº‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:48:28.000Z" title="Thu Feb 05 2026 06:48:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. åº“çš„æ¦‚è§ˆä¸æ ¸å¿ƒä»·å€¼</h2>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æƒ³å»ºé€ ä¸€ä¸ªèƒ½å¤Ÿè¯†åˆ«å›¾ç‰‡ã€ç¿»è¯‘è¯­è¨€æˆ–è€…å¯¹è¯çš„æ™ºèƒ½ç³»ç»Ÿã€‚å¦‚æœä½ ä»é›¶å¼€å§‹ç¼–å†™æ‰€æœ‰çš„æ•°å­¦è¿ç®—ã€åå‘ä¼ æ’­ç®—æ³•å’ŒGPUåŠ é€Ÿä»£ç ï¼Œè¿™å°±åƒæƒ³è¦çƒ¤åˆ¶è›‹ç³•å´éœ€è¦å…ˆå‘æ˜çƒ¤ç®±â€”â€”æ—¢è€—æ—¶åˆå®¹æ˜“å‡ºé”™ã€‚PyTorch æ­£æ˜¯ä¸ºæ­¤è€Œç”Ÿçš„å·¥å…·ï¼Œå®ƒè®©æ·±åº¦å­¦ä¹ å˜å¾—è§¦æ‰‹å¯åŠã€‚</p>
<p>PyTorch æ˜¯ä¸€ä¸ªå¼€æºçš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œç”± Facebookï¼ˆç° Metaï¼‰AI Research å›¢é˜Ÿå¼€å‘ã€‚åœ¨ Python ç”Ÿæ€ç³»ç»Ÿä¸­ï¼ŒPyTorch ä»¥å…¶åŠ¨æ€è®¡ç®—å›¾ã€ç›´è§‚çš„ API è®¾è®¡å’Œå¼ºå¤§çš„ GPU åŠ é€Ÿèƒ½åŠ›è‘—ç§°ã€‚ä¸é™æ€æ¡†æ¶ä¸åŒï¼ŒPyTorch å…è®¸ä½ åƒç¼–å†™æ™®é€š Python ä»£ç ä¸€æ ·æ„å»ºç¥ç»ç½‘ç»œâ€”â€”å¯ä»¥éšæ—¶è°ƒè¯•ã€ä¿®æ”¹å’Œå®éªŒï¼Œè¿™ä½¿å¾—å®ƒæˆä¸ºç ”ç©¶äººå‘˜å’Œå·¥ç¨‹å¸ˆçš„é¦–é€‰å·¥å…·ã€‚</p>
<p>PyTorch çš„æ ¸å¿ƒä»·å€¼ä½“ç°åœ¨ä¸‰ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li><strong>çµæ´»æ€§</strong>ï¼šåŠ¨æ€è®¡ç®—å›¾è®©ä½ èƒ½å¤Ÿè½»æ¾å¤„ç†å˜é•¿è¾“å…¥ã€æ¡ä»¶åˆ†æ”¯å’Œå¤æ‚çš„æ§åˆ¶æµ</li>
<li><strong>ç›´è§‚æ€§</strong>ï¼šä¸ NumPy ç›¸ä¼¼çš„ API è®¾è®¡ï¼Œå­¦ä¹ æ›²çº¿å¹³ç¼“</li>
<li><strong>ç”Ÿäº§çº§æ€§èƒ½</strong>ï¼šé€šè¿‡ TorchScript ç­‰æŠ€æœ¯ï¼Œå¯ä»¥æ— ç¼å°†æ¨¡å‹éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ</li>
</ul>
<h2 data-id="heading-1">2. ç¯å¢ƒæ­å»ºä¸ "Hello, World"</h2>
<h3 data-id="heading-2">å®‰è£…è¯´æ˜</h3>
<p>PyTorch æ”¯æŒå¤šç§å®‰è£…æ–¹å¼ï¼Œæ¨èæ ¹æ®ä½ çš„ç¡¬ä»¶é…ç½®é€‰æ‹©åˆé€‚çš„ç‰ˆæœ¬ï¼š</p>
<p><strong>æ–¹æ³•ä¸€ï¼šä½¿ç”¨ pip å®‰è£…ï¼ˆæœ€ç®€å•ï¼‰</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># CPU ç‰ˆæœ¬ï¼ˆé€‚ç”¨äºæ—  NVIDIA æ˜¾å¡çš„æƒ…å†µï¼‰</span>
pip3 install torch torchvision torchaudio

<span class="hljs-comment"># GPU ç‰ˆæœ¬ï¼ˆéœ€è¦ NVIDIA æ˜¾å¡ï¼ŒCUDA 12.6ï¼‰</span>
pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu126
</code></pre>
<p><strong>æ–¹æ³•äºŒï¼šä½¿ç”¨ conda å®‰è£…ï¼ˆæ¨èï¼‰</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</span>
conda create -n pytorch_env python=3.10
conda activate pytorch_env

<span class="hljs-comment"># CPU ç‰ˆæœ¬</span>
conda install pytorch torchvision torchaudio cpuonly -c pytorch

<span class="hljs-comment"># GPU ç‰ˆæœ¬ï¼ˆCUDA 12.6ï¼‰</span>
conda install pytorch torchvision torchaudio pytorch-cuda=12.6 -c pytorch -c nvidia
</code></pre>
<p><strong>å®‰è£…æ³¨æ„äº‹é¡¹ï¼š</strong></p>
<ul>
<li>PyTorch éœ€è¦ Python 3.10 æˆ–æ›´é«˜ç‰ˆæœ¬</li>
<li>GPU ç‰ˆæœ¬éœ€è¦å®‰è£…å¯¹åº”çš„ NVIDIA é©±åŠ¨å’Œ CUDA Toolkit</li>
<li>macOS ç”¨æˆ·ï¼ˆApple Siliconï¼‰å¯ä»¥ä½¿ç”¨ MPS åŠ é€Ÿï¼š<code>conda install pytorch -c pytorch -c apple</code></li>
</ul>
<h3 data-id="heading-3">"Hello, World" ç¤ºä¾‹</h3>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­æ¥æ„Ÿå— PyTorch çš„é­…åŠ›ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> torch

<span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªéšæœºå¼ é‡</span>
x = torch.rand(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"éšæœºå¼ é‡ x:"</span>)
<span class="hljs-built_in">print</span>(x)

<span class="hljs-comment"># åŸºæœ¬è¿ç®—</span>
y = torch.ones(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
z = x + y
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\nx + y çš„ç»“æœ:"</span>)
<span class="hljs-built_in">print</span>(z)

<span class="hljs-comment"># æ£€æŸ¥ GPU æ˜¯å¦å¯ç”¨</span>
<span class="hljs-keyword">if</span> torch.cuda.is_available():
    device = torch.device(<span class="hljs-string">"cuda"</span>)
    x_gpu = x.to(device)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nå¼ é‡å·²ç§»åŠ¨åˆ°è®¾å¤‡: <span class="hljs-subst">{x_gpu.device}</span>"</span>)
<span class="hljs-keyword">else</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\næœªæ£€æµ‹åˆ° GPUï¼Œä½¿ç”¨ CPU ç‰ˆæœ¬"</span>)
</code></pre>
<p><strong>ä»£ç é€è¡Œè§£é‡Šï¼š</strong></p>
<ul>
<li><code>import torch</code>ï¼šå¯¼å…¥ PyTorch ä¸»æ¨¡å—ï¼Œæ‰€æœ‰çš„å¼ é‡æ“ä½œéƒ½åœ¨è¿™ä¸ªæ¨¡å—ä¸‹</li>
<li><code>torch.rand(2, 3)</code>ï¼šåˆ›å»ºä¸€ä¸ªå½¢çŠ¶ä¸º 2Ã—3 çš„éšæœºå¼ é‡ï¼Œå…ƒç´ å€¼åœ¨ [0, 1) åŒºé—´å‡åŒ€åˆ†å¸ƒ</li>
<li><code>torch.ones(2, 3)</code>ï¼šåˆ›å»ºä¸€ä¸ªå…¨ä¸º 1 çš„å¼ é‡</li>
<li><code>x + y</code>ï¼šå¼ é‡é—´çš„é€å…ƒç´ ç›¸åŠ ï¼ŒPyTorch é‡è½½äº†åŠ æ³•è¿ç®—ç¬¦</li>
<li><code>torch.cuda.is_available()</code>ï¼šæ£€æŸ¥ç³»ç»Ÿæ˜¯å¦æ”¯æŒ CUDAï¼ˆNVIDIA GPU åŠ é€Ÿï¼‰</li>
<li><code>x.to(device)</code>ï¼šå°†å¼ é‡ç§»åŠ¨åˆ°æŒ‡å®šè®¾å¤‡ï¼ˆGPU æˆ– CPUï¼‰</li>
</ul>
<p><strong>é¢„æœŸè¾“å‡ºç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-lua" lang="lua">éšæœºå¼ é‡ x:
tensor(<span class="hljs-string">[[0.1234, 0.5678, 0.9012],
        [0.3456, 0.7890, 0.2345]]</span>)

x + y çš„ç»“æœ:
tensor(<span class="hljs-string">[[1.1234, 1.5678, 1.9012],
        [1.3456, 1.7890, 1.2345]]</span>)

æœªæ£€æµ‹åˆ° GPUï¼Œä½¿ç”¨ CPU ç‰ˆæœ¬
</code></pre>
<h2 data-id="heading-4">3. æ ¸å¿ƒæ¦‚å¿µè§£æ</h2>
<p>PyTorch çš„æ ¸å¿ƒå»ºç«‹åœ¨ä¸‰ä¸ªåŸºæœ¬æ¦‚å¿µä¹‹ä¸Šï¼šTensorï¼ˆå¼ é‡ï¼‰ã€Autogradï¼ˆè‡ªåŠ¨æ±‚å¯¼ï¼‰å’Œ Neural Networkï¼ˆç¥ç»ç½‘ç»œï¼‰ã€‚ç†è§£è¿™äº›æ¦‚å¿µæ˜¯æŒæ¡ PyTorch çš„å…³é”®ã€‚</p>
<h3 data-id="heading-5">3.1 Tensorï¼šæ•°æ®çš„åŸºæœ¬å•å…ƒ</h3>
<p>Tensor æ˜¯ PyTorch ä¸­æœ€åŸºæœ¬çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥ç†è§£ä¸ºå¤šç»´æ•°ç»„ã€‚å®ƒä¸ NumPy çš„ ndarray éå¸¸ç›¸ä¼¼ï¼Œä½†æœ‰ä¸¤ä¸ªå…³é”®åŒºåˆ«ï¼šæ”¯æŒ GPU åŠ é€Ÿå’Œè‡ªåŠ¨æ±‚å¯¼ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä»ä¸åŒæ–¹å¼åˆ›å»ºå¼ é‡</span>
<span class="hljs-keyword">import</span> torch

<span class="hljs-comment"># ä» Python åˆ—è¡¨åˆ›å»º</span>
data = [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]]
tensor_from_list = torch.tensor(data)

<span class="hljs-comment"># åˆ›å»ºç‰¹å®šå½¢çŠ¶çš„éšæœºå¼ é‡</span>
random_tensor = torch.rand(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)  <span class="hljs-comment"># 3Ã—4 çš„éšæœºå¼ é‡</span>

<span class="hljs-comment"># åˆ›å»ºå…¨é›¶å¼ é‡</span>
zeros_tensor = torch.zeros(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)

<span class="hljs-comment"># æŸ¥çœ‹å¼ é‡å±æ€§</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å½¢çŠ¶: <span class="hljs-subst">{random_tensor.shape}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ•°æ®ç±»å‹: <span class="hljs-subst">{random_tensor.dtype}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å­˜å‚¨è®¾å¤‡: <span class="hljs-subst">{random_tensor.device}</span>"</span>)
</code></pre>
<p><strong>å¼ é‡çš„å…³é”®å±æ€§ï¼š</strong></p>
<ul>
<li><strong>shapeï¼ˆå½¢çŠ¶ï¼‰</strong>ï¼šæè¿°å¼ é‡æ¯ä¸ªç»´åº¦çš„é•¿åº¦ï¼Œå¦‚ (2, 3) è¡¨ç¤º 2 è¡Œ 3 åˆ—</li>
<li><strong>dtypeï¼ˆæ•°æ®ç±»å‹ï¼‰</strong>ï¼šå¦‚ <code>torch.float32</code>ã€<code>torch.int64</code> ç­‰</li>
<li><strong>deviceï¼ˆè®¾å¤‡ï¼‰</strong>ï¼šå¼ é‡å­˜å‚¨åœ¨ CPU è¿˜æ˜¯ GPU ä¸Š</li>
</ul>
<h3 data-id="heading-6">3.2 Autogradï¼šè‡ªåŠ¨æ±‚å¯¼å¼•æ“</h3>
<p>Autograd æ˜¯ PyTorch çš„è‡ªåŠ¨æ±‚å¯¼å¼•æ“ï¼Œå®ƒèƒ½å¤Ÿè‡ªåŠ¨è®¡ç®—ç¥ç»ç½‘ç»œä¸­å‚æ•°çš„æ¢¯åº¦ã€‚è¿™æ˜¯æ·±åº¦å­¦ä¹ çš„æ ¸å¿ƒâ€”â€”é€šè¿‡åå‘ä¼ æ’­ç®—æ³•æ›´æ–°æ¨¡å‹å‚æ•°ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ¼”ç¤ºè‡ªåŠ¨æ±‚å¯¼</span>
x = torch.tensor(<span class="hljs-number">2.0</span>, requires_grad=<span class="hljs-literal">True</span>)
y = x ** <span class="hljs-number">3</span>

<span class="hljs-comment"># è®¡ç®— y å¯¹ x çš„æ¢¯åº¦</span>
y.backward()

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"x = <span class="hljs-subst">{x}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"y = xÂ³ = <span class="hljs-subst">{y}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"dy/dx = <span class="hljs-subst">{x.grad}</span>"</span>)  <span class="hljs-comment"># dy/dx = 3xÂ² = 3 * 4 = 12</span>
</code></pre>
<p><strong>Autograd çš„å·¥ä½œåŸç†ï¼š</strong></p>
<ol>
<li>å½“ä½ åˆ›å»ºå¼ é‡å¹¶è®¾ç½® <code>requires_grad=True</code> æ—¶ï¼ŒPyTorch å¼€å§‹è·Ÿè¸ªè¯¥å¼ é‡çš„æ‰€æœ‰æ“ä½œ</li>
<li>è¿™äº›æ“ä½œè¢«è®°å½•åœ¨è®¡ç®—å›¾ä¸­</li>
<li>è°ƒç”¨ <code>.backward()</code> æ—¶ï¼ŒPyTorch è‡ªåŠ¨è®¡ç®—æ¢¯åº¦å¹¶å­˜å‚¨åœ¨ <code>.grad</code> å±æ€§ä¸­</li>
<li>æ¢¯åº¦ç”¨äºæ›´æ–°ç¥ç»ç½‘ç»œä¸­çš„æƒé‡å‚æ•°</li>
</ol>
<h3 data-id="heading-7">3.3 æ ¸å¿ƒæ¦‚å¿µå…³ç³»å›¾</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TD
    A[Tensor å¼ é‡] --&gt; B[æ•°æ®å­˜å‚¨ä¸è¿ç®—]
    A --&gt; C[GPU åŠ é€Ÿ]
    A --&gt; D[requires_grad=True]
    
    D --&gt; E[Autograd è‡ªåŠ¨æ±‚å¯¼]
    E --&gt; F[è®¡ç®—å›¾æ„å»º]
    E --&gt; G[åå‘ä¼ æ’­]
    E --&gt; H[æ¢¯åº¦è®¡ç®—]
    
    H --&gt; I[ç¥ç»ç½‘ç»œè®­ç»ƒ]
    I --&gt; J[torch.nn æ¨¡å—]
    I --&gt; K[torch.optim ä¼˜åŒ–å™¨]
    
    J --&gt; L[æ¨¡å‹å®šä¹‰]
    K --&gt; M[å‚æ•°æ›´æ–°]
    
    C --&gt; N[CUDA/MPS æ”¯æŒ]
    B --&gt; O[ä¸ NumPy äº’æ“ä½œ]
    
    style A fill:#e1f5fe
    style E fill:#fff9c4
    style I fill:#f3e5f5
</code></pre>
<p><strong>æ¦‚å¿µé—´çš„äº¤äº’ï¼š</strong></p>
<ul>
<li>Tensor æ˜¯æ•°æ®çš„åŸºç¡€è½½ä½“ï¼Œæ—¢å¯ä»¥åœ¨ CPU ä¸Šè¿è¡Œï¼Œä¹Ÿå¯ä»¥é€šè¿‡ CUDA åœ¨ GPU ä¸ŠåŠ é€Ÿ</li>
<li>å½“ Tensor è®¾ç½® <code>requires_grad=True</code> æ—¶ï¼ŒAutograd è‡ªåŠ¨å¼€å§‹è·Ÿè¸ªæ“ä½œ</li>
<li><code>torch.nn</code> æ¨¡å—åŸºäº Tensor å’Œ Autograd æ„å»ºç¥ç»ç½‘ç»œå±‚</li>
<li><code>torch.optim</code> ä¼˜åŒ–å™¨ä½¿ç”¨ Autograd è®¡ç®—çš„æ¢¯åº¦æ¥æ›´æ–°ç½‘ç»œå‚æ•°</li>
</ul>
<h2 data-id="heading-8">4. å®æˆ˜æ¼”ç»ƒï¼šæ„å»ºç®€å•çš„å›¾åƒåˆ†ç±»å™¨</h2>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­æ¥ä½“éªŒ PyTorch çš„å¼ºå¤§åŠŸèƒ½ã€‚æˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œæ¥è¯†åˆ«æ‰‹å†™æ•°å­—ï¼ˆç»å…¸çš„ MNIST æ•°æ®é›†ï¼‰ã€‚</p>
<h3 data-id="heading-9">éœ€æ±‚åˆ†æ</h3>
<p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åˆ›å»ºä¸€ä¸ªèƒ½å¤Ÿè¯†åˆ« 0-9 æ‰‹å†™æ•°å­—çš„ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚è¿™ä¸ªé—®é¢˜æ˜¯æ·±åº¦å­¦ä¹ çš„"Hello World"ï¼Œä½†æ¶µç›–äº†æ‰€æœ‰æ ¸å¿ƒæ¦‚å¿µï¼šæ•°æ®åŠ è½½ã€æ¨¡å‹å®šä¹‰ã€è®­ç»ƒå’Œè¯„ä¼°ã€‚</p>
<h3 data-id="heading-10">æ–¹æ¡ˆè®¾è®¡</h3>
<p>æˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹ PyTorch ç»„ä»¶ï¼š</p>
<ul>
<li><strong>torchvision.datasets</strong>ï¼šä¸‹è½½å’ŒåŠ è½½ MNIST æ•°æ®é›†</li>
<li><strong>torch.utils.data.DataLoader</strong>ï¼šæ‰¹é‡åŠ è½½æ•°æ®</li>
<li><strong>torch.nn</strong>ï¼šå®šä¹‰ç¥ç»ç½‘ç»œç»“æ„</li>
<li><strong>torch.optim</strong>ï¼šä½¿ç”¨ Adam ä¼˜åŒ–å™¨æ›´æ–°å‚æ•°</li>
</ul>
<h3 data-id="heading-11">ä»£ç å®ç°</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn
<span class="hljs-keyword">import</span> torch.optim <span class="hljs-keyword">as</span> optim
<span class="hljs-keyword">from</span> torchvision <span class="hljs-keyword">import</span> datasets, transforms
<span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader

<span class="hljs-comment"># 1. æ•°æ®å‡†å¤‡</span>
<span class="hljs-comment"># å®šä¹‰æ•°æ®é¢„å¤„ç†ï¼šè½¬æ¢ä¸ºå¼ é‡å¹¶å½’ä¸€åŒ–åˆ° [0, 1]</span>
transform = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize((<span class="hljs-number">0.5</span>,), (<span class="hljs-number">0.5</span>,))
])

<span class="hljs-comment"># ä¸‹è½½å¹¶åŠ è½½è®­ç»ƒé›†å’Œæµ‹è¯•é›†</span>
train_dataset = datasets.MNIST(<span class="hljs-string">'./data'</span>, train=<span class="hljs-literal">True</span>, download=<span class="hljs-literal">True</span>, transform=transform)
test_dataset = datasets.MNIST(<span class="hljs-string">'./data'</span>, train=<span class="hljs-literal">False</span>, download=<span class="hljs-literal">True</span>, transform=transform)

<span class="hljs-comment"># åˆ›å»ºæ•°æ®åŠ è½½å™¨ï¼Œæ‰¹é‡å¤§å°ä¸º 64</span>
train_loader = DataLoader(train_dataset, batch_size=<span class="hljs-number">64</span>, shuffle=<span class="hljs-literal">True</span>)
test_loader = DataLoader(test_dataset, batch_size=<span class="hljs-number">64</span>, shuffle=<span class="hljs-literal">False</span>)

<span class="hljs-comment"># 2. å®šä¹‰ç¥ç»ç½‘ç»œ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleNet</span>(nn.Module):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-built_in">super</span>(SimpleNet, self).__init__()
        <span class="hljs-comment"># è¾“å…¥å±‚ï¼š784 ä¸ªç¥ç»å…ƒï¼ˆ28Ã—28 å›¾åƒå±•å¹³ï¼‰</span>
        <span class="hljs-comment"># éšè—å±‚ï¼š128 ä¸ªç¥ç»å…ƒ</span>
        self.fc1 = nn.Linear(<span class="hljs-number">784</span>, <span class="hljs-number">128</span>)
        self.relu = nn.ReLU()
        <span class="hljs-comment"># è¾“å‡ºå±‚ï¼š10 ä¸ªç¥ç»å…ƒï¼ˆå¯¹åº” 0-9 åä¸ªæ•°å­—ï¼‰</span>
        self.fc2 = nn.Linear(<span class="hljs-number">128</span>, <span class="hljs-number">10</span>)
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):
        <span class="hljs-comment"># å±•å¹³å›¾åƒå¼ é‡ï¼š(batch_size, 1, 28, 28) -&gt; (batch_size, 784)</span>
        x = x.view(x.size(<span class="hljs-number">0</span>), -<span class="hljs-number">1</span>)
        <span class="hljs-comment"># å‰å‘ä¼ æ’­</span>
        x = self.fc1(x)
        x = self.relu(x)
        x = self.fc2(x)
        <span class="hljs-keyword">return</span> x

<span class="hljs-comment"># åˆå§‹åŒ–æ¨¡å‹</span>
model = SimpleNet()

<span class="hljs-comment"># 3. å®šä¹‰æŸå¤±å‡½æ•°å’Œä¼˜åŒ–å™¨</span>
criterion = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.parameters(), lr=<span class="hljs-number">0.001</span>)

<span class="hljs-comment"># 4. è®­ç»ƒæ¨¡å‹</span>
num_epochs = <span class="hljs-number">5</span>

<span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_epochs):
    model.train()  <span class="hljs-comment"># è®¾ç½®ä¸ºè®­ç»ƒæ¨¡å¼</span>
    running_loss = <span class="hljs-number">0.0</span>
    
    <span class="hljs-keyword">for</span> images, labels <span class="hljs-keyword">in</span> train_loader:
        <span class="hljs-comment"># æ¸…é›¶æ¢¯åº¦</span>
        optimizer.zero_grad()
        
        <span class="hljs-comment"># å‰å‘ä¼ æ’­</span>
        outputs = model(images)
        loss = criterion(outputs, labels)
        
        <span class="hljs-comment"># åå‘ä¼ æ’­å’Œä¼˜åŒ–</span>
        loss.backward()
        optimizer.step()
        
        running_loss += loss.item()
    
    <span class="hljs-comment"># æ‰“å°æ¯ä¸ª epoch çš„å¹³å‡æŸå¤±</span>
    avg_loss = running_loss / <span class="hljs-built_in">len</span>(train_loader)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f'Epoch [<span class="hljs-subst">{epoch+<span class="hljs-number">1</span>}</span>/<span class="hljs-subst">{num_epochs}</span>], Loss: <span class="hljs-subst">{avg_loss:<span class="hljs-number">.4</span>f}</span>'</span>)

<span class="hljs-comment"># 5. åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°æ¨¡å‹</span>
model.<span class="hljs-built_in">eval</span>()  <span class="hljs-comment"># è®¾ç½®ä¸ºè¯„ä¼°æ¨¡å¼</span>
correct = <span class="hljs-number">0</span>
total = <span class="hljs-number">0</span>

<span class="hljs-keyword">with</span> torch.no_grad():  <span class="hljs-comment"># ä¸è®¡ç®—æ¢¯åº¦ï¼ŒèŠ‚çœå†…å­˜</span>
    <span class="hljs-keyword">for</span> images, labels <span class="hljs-keyword">in</span> test_loader:
        outputs = model(images)
        <span class="hljs-comment"># è·å–é¢„æµ‹ç»“æœï¼ˆæœ€å¤§å€¼çš„ç´¢å¼•ï¼‰</span>
        _, predicted = torch.<span class="hljs-built_in">max</span>(outputs.data, <span class="hljs-number">1</span>)
        total += labels.size(<span class="hljs-number">0</span>)
        correct += (predicted == labels).<span class="hljs-built_in">sum</span>().item()

accuracy = <span class="hljs-number">100</span> * correct / total
<span class="hljs-built_in">print</span>(<span class="hljs-string">f'æµ‹è¯•é›†å‡†ç¡®ç‡: <span class="hljs-subst">{accuracy:<span class="hljs-number">.2</span>f}</span>%'</span>)

<span class="hljs-comment"># 6. ä¿å­˜æ¨¡å‹</span>
torch.save(model.state_dict(), <span class="hljs-string">'simple_net.pth'</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ¨¡å‹å·²ä¿å­˜ä¸º simple_net.pth"</span>)
</code></pre>
<h3 data-id="heading-12">è¿è¡Œè¯´æ˜</h3>
<p><strong>è¿è¡Œç¯å¢ƒè¦æ±‚ï¼š</strong></p>
<ul>
<li>Python 3.10+</li>
<li>PyTorch 2.0+</li>
<li>torchvisionï¼ˆå›¾åƒå¤„ç†å·¥å…·åŒ…ï¼‰</li>
<li>è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ï¼ˆMNIST æ•°æ®é›†çº¦ 50MBï¼‰</li>
</ul>
<p><strong>è¿è¡Œæ­¥éª¤ï¼š</strong></p>
<ol>
<li>ç¡®ä¿å·²å®‰è£…æ‰€æœ‰ä¾èµ–ï¼š<code>pip install torch torchvision</code></li>
<li>å°†ä¸Šè¿°ä»£ç ä¿å­˜ä¸º <code>mnist_classifier.py</code></li>
<li>è¿è¡Œç¨‹åºï¼š<code>python mnist_classifier.py</code></li>
<li>ç¨‹åºä¼šè‡ªåŠ¨ä¸‹è½½ MNIST æ•°æ®é›†å¹¶å¼€å§‹è®­ç»ƒ</li>
</ol>
<p><strong>é¢„æœŸç»“æœï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">Epoch <span class="hljs-section">[1/5]</span>, Loss: 0.3562
Epoch <span class="hljs-section">[2/5]</span>, Loss: 0.1824
Epoch <span class="hljs-section">[3/5]</span>, Loss: 0.1347
Epoch <span class="hljs-section">[4/5]</span>, Loss: 0.1078
Epoch <span class="hljs-section">[5/5]</span>, Loss: 0.0912
æµ‹è¯•é›†å‡†ç¡®ç‡: 96.85%
æ¨¡å‹å·²ä¿å­˜ä¸º simple_net.pth
</code></pre>
<p><strong>ç»“æœè§£è¯»ï¼š</strong></p>
<ul>
<li>æŸå¤±å€¼ï¼ˆLossï¼‰éšç€è®­ç»ƒé€æ¸ä¸‹é™ï¼Œè¯´æ˜æ¨¡å‹åœ¨å­¦ä¹ </li>
<li>æµ‹è¯•é›†å‡†ç¡®ç‡è¾¾åˆ° 96% ä»¥ä¸Šï¼Œè¡¨æ˜æ¨¡å‹å…·æœ‰è‰¯å¥½çš„æ³›åŒ–èƒ½åŠ›</li>
<li>æ¨¡å‹å‚æ•°è¢«ä¿å­˜ï¼Œå¯ä»¥ç”¨äºåç»­çš„é¢„æµ‹æˆ–è¿›ä¸€æ­¥è®­ç»ƒ</li>
</ul>
<h2 data-id="heading-13">5. æœ€ä½³å®è·µä¸å¸¸è§é™·é˜±</h2>
<p>åœ¨ä½¿ç”¨ PyTorch æ—¶ï¼Œæœ‰ä¸€äº›æœ€ä½³å®è·µå’Œå¸¸è§é”™è¯¯éœ€è¦ç‰¹åˆ«æ³¨æ„ã€‚éµå¾ªè¿™äº›åŸåˆ™å¯ä»¥é¿å…å¾ˆå¤šå‘ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p>
<h3 data-id="heading-14">å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ</h3>
<p><strong>é”™è¯¯ 1ï¼šè®¾å¤‡ä¸åŒ¹é…</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># âŒ é”™è¯¯åšæ³•ï¼šGPU å¼ é‡å’Œ CPU å¼ é‡ç›´æ¥è¿ç®—</span>
x = torch.tensor([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])  <span class="hljs-comment"># CPU å¼ é‡</span>
y = torch.tensor([<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]).cuda()  <span class="hljs-comment"># GPU å¼ é‡</span>
z = x + y  <span class="hljs-comment"># æŠ¥é”™ï¼è®¾å¤‡ä¸åŒ¹é…</span>

<span class="hljs-comment"># âœ… æ­£ç¡®åšæ³•ï¼šç¡®ä¿æ‰€æœ‰å¼ é‡åœ¨åŒä¸€è®¾å¤‡ä¸Š</span>
device = torch.device(<span class="hljs-string">"cuda"</span> <span class="hljs-keyword">if</span> torch.cuda.is_available() <span class="hljs-keyword">else</span> <span class="hljs-string">"cpu"</span>)
x = torch.tensor([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).to(device)
y = torch.tensor([<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]).to(device)
z = x + y  <span class="hljs-comment"># æ­£å¸¸è¿ç®—</span>
</code></pre>
<p><strong>é”™è¯¯ 2ï¼šæ¢¯åº¦ç´¯ç§¯</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># âŒ é”™è¯¯åšæ³•ï¼šå¿˜è®°æ¸…é›¶æ¢¯åº¦å¯¼è‡´æ¢¯åº¦ç´¯ç§¯</span>
optimizer = optim.Adam(model.parameters(), lr=<span class="hljs-number">0.001</span>)

<span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_epochs):
    <span class="hljs-keyword">for</span> batch_x, batch_y <span class="hljs-keyword">in</span> dataloader:
        outputs = model(batch_x)
        loss = criterion(outputs, batch_y)
        loss.backward()  <span class="hljs-comment"># æ¢¯åº¦ç´¯ç§¯ï¼</span>
        optimizer.step()
        <span class="hljs-comment"># ç¼ºå°‘ optimizer.zero_grad()</span>
</code></pre>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># âœ… æ­£ç¡®åšæ³•ï¼šæ¯æ¬¡åå‘ä¼ æ’­å‰æ¸…é›¶æ¢¯åº¦</span>
<span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_epochs):
    <span class="hljs-keyword">for</span> batch_x, batch_y <span class="hljs-keyword">in</span> dataloader:
        optimizer.zero_grad()  <span class="hljs-comment"># æ¸…é›¶æ¢¯åº¦</span>
        outputs = model(batch_x)
        loss = criterion(outputs, batch_y)
        loss.backward()
        optimizer.step()
</code></pre>
<p><strong>é”™è¯¯ 3ï¼šæ•°æ®ç±»å‹ä¸åŒ¹é…</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># âŒ é”™è¯¯åšæ³•ï¼šä¸åŒæ•°æ®ç±»å‹å¼ é‡è¿ç®—</span>
a = torch.tensor([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], dtype=torch.int32)
b = torch.tensor([<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>], dtype=torch.float32)
c = a + b  <span class="hljs-comment"># å¯èƒ½ä¼šæŠ¥é”™æˆ–ç²¾åº¦ä¸¢å¤±</span>

<span class="hljs-comment"># âœ… æ­£ç¡®åšæ³•ï¼šç»Ÿä¸€æ•°æ®ç±»å‹</span>
a = a.to(torch.float32)
c = a + b  <span class="hljs-comment"># æ­£å¸¸è¿ç®—</span>
</code></pre>
<h3 data-id="heading-15">æœ€ä½³å®è·µå»ºè®®</h3>
<p><strong>1. ä½¿ç”¨ DataLoader é«˜æ•ˆåŠ è½½æ•°æ®</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ¨èé…ç½®</span>
dataloader = DataLoader(
    dataset,
    batch_size=<span class="hljs-number">32</span>,        <span class="hljs-comment"># æ ¹æ® GPU å†…å­˜è°ƒæ•´</span>
    shuffle=<span class="hljs-literal">True</span>,         <span class="hljs-comment"># è®­ç»ƒé›†æ‰“ä¹±</span>
    num_workers=<span class="hljs-number">4</span>,        <span class="hljs-comment"># å¤šè¿›ç¨‹åŠ è½½æ•°æ®</span>
    pin_memory=<span class="hljs-literal">True</span>       <span class="hljs-comment"># åŠ é€Ÿ GPU æ•°æ®ä¼ è¾“</span>
)
</code></pre>
<p><strong>2. å–„ç”¨ GPU åŠ é€Ÿ</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ£€æŸ¥å¹¶ä½¿ç”¨ GPU</span>
device = torch.device(<span class="hljs-string">"cuda"</span> <span class="hljs-keyword">if</span> torch.cuda.is_available() <span class="hljs-keyword">else</span> <span class="hljs-string">"cpu"</span>)
model = model.to(device)

<span class="hljs-comment"># è®­ç»ƒæ—¶ç§»åŠ¨æ•°æ®åˆ° GPU</span>
<span class="hljs-keyword">for</span> inputs, labels <span class="hljs-keyword">in</span> dataloader:
    inputs, labels = inputs.to(device), labels.to(device)
</code></pre>
<p><strong>3. æ¨¡å‹ä¿å­˜ä¸åŠ è½½</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä¿å­˜æ¨¡å‹</span>
torch.save({
    <span class="hljs-string">'model_state_dict'</span>: model.state_dict(),
    <span class="hljs-string">'optimizer_state_dict'</span>: optimizer.state_dict(),
    <span class="hljs-string">'epoch'</span>: epoch,
}, <span class="hljs-string">'checkpoint.pth'</span>)

<span class="hljs-comment"># åŠ è½½æ¨¡å‹</span>
checkpoint = torch.load(<span class="hljs-string">'checkpoint.pth'</span>)
model.load_state_dict(checkpoint[<span class="hljs-string">'model_state_dict'</span>])
optimizer.load_state_dict(checkpoint[<span class="hljs-string">'optimizer_state_dict'</span>])
epoch = checkpoint[<span class="hljs-string">'epoch'</span>]
</code></pre>
<p><strong>4. ä½¿ç”¨éªŒè¯é›†ç›‘æ§è®­ç»ƒ</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ç›‘æ§éªŒè¯é›†å‡†ç¡®ç‡</span>
best_acc = <span class="hljs-number">0.0</span>

<span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_epochs):
    <span class="hljs-comment"># è®­ç»ƒä»£ç ...</span>
    
    <span class="hljs-comment"># éªŒè¯</span>
    model.<span class="hljs-built_in">eval</span>()
    val_acc = evaluate(model, val_loader)
    
    <span class="hljs-comment"># ä¿å­˜æœ€ä½³æ¨¡å‹</span>
    <span class="hljs-keyword">if</span> val_acc &gt; best_acc:
        best_acc = val_acc
        torch.save(model.state_dict(), <span class="hljs-string">'best_model.pth'</span>)
    
    model.train()
</code></pre>
<h3 data-id="heading-16">æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h3>
<ul>
<li><strong>æ‰¹é‡å¤§å°ï¼ˆBatch Sizeï¼‰</strong>ï¼šåœ¨ GPU å†…å­˜å…è®¸çš„æƒ…å†µä¸‹ï¼Œå¢å¤§æ‰¹é‡å¤§å°å¯ä»¥æé«˜ GPU åˆ©ç”¨ç‡</li>
<li><strong>æ··åˆç²¾åº¦è®­ç»ƒ</strong>ï¼šä½¿ç”¨ <code>torch.cuda.amp</code> å¯ä»¥åŠ é€Ÿè®­ç»ƒå¹¶å‡å°‘å†…å­˜å ç”¨</li>
<li><strong>æ¨¡å‹å¹¶è¡Œ</strong>ï¼šå¯¹äºè¶…å¤§æ¨¡å‹ï¼Œå¯ä»¥å°†æ¨¡å‹çš„ä¸åŒå±‚åˆ†å¸ƒåˆ°å¤šä¸ª GPU ä¸Š</li>
<li><strong>æ¢¯åº¦ç´¯ç§¯</strong>ï¼šå½“æ‰¹é‡å¤§å°å—é™äº GPU å†…å­˜æ—¶ï¼Œå¯ä»¥é€šè¿‡ç´¯ç§¯æ¢¯åº¦æ¨¡æ‹Ÿæ›´å¤§çš„æ‰¹é‡</li>
</ul>
<h2 data-id="heading-17">6. è¿›é˜¶æŒ‡å¼•</h2>
<p>æŒæ¡åŸºç¡€ä¹‹åï¼ŒPyTorch è¿˜æœ‰è®¸å¤šé«˜çº§ç‰¹æ€§å’Œä¸°å¯Œçš„ç”Ÿæ€ç³»ç»Ÿå€¼å¾—æ¢ç´¢ã€‚</p>
<h3 data-id="heading-18">é«˜çº§åŠŸèƒ½</h3>
<p><strong>1. è‡ªå®šä¹‰å±‚å’ŒæŸå¤±å‡½æ•°</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è‡ªå®šä¹‰å±‚</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomLayer</span>(nn.Module):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, in_features, out_features</span>):
        <span class="hljs-built_in">super</span>().__init__()
        self.linear = nn.Linear(in_features, out_features)
        self.custom_param = nn.Parameter(torch.randn(out_features))
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):
        <span class="hljs-keyword">return</span> self.linear(x) + self.custom_param

<span class="hljs-comment"># è‡ªå®šä¹‰æŸå¤±å‡½æ•°</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">custom_loss</span>(<span class="hljs-params">output, target</span>):
    <span class="hljs-keyword">return</span> torch.mean((output - target) ** <span class="hljs-number">2</span>) + torch.<span class="hljs-built_in">abs</span>(output).mean()
</code></pre>
<p><strong>2. ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹ï¼ˆè¿ç§»å­¦ä¹ ï¼‰</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> torchvision <span class="hljs-keyword">import</span> models

<span class="hljs-comment"># åŠ è½½é¢„è®­ç»ƒçš„ ResNet</span>
model = models.resnet18(pretrained=<span class="hljs-literal">True</span>)

<span class="hljs-comment"># å†»ç»“éƒ¨åˆ†å±‚</span>
<span class="hljs-keyword">for</span> param <span class="hljs-keyword">in</span> model.parameters():
    param.requires_grad = <span class="hljs-literal">False</span>

<span class="hljs-comment"># æ›¿æ¢æœ€åä¸€å±‚</span>
model.fc = nn.Linear(<span class="hljs-number">512</span>, num_classes)
</code></pre>
<p><strong>3. åˆ†å¸ƒå¼è®­ç»ƒ</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> torch.distributed <span class="hljs-keyword">as</span> dist

<span class="hljs-comment"># åˆå§‹åŒ–åˆ†å¸ƒå¼ç¯å¢ƒ</span>
dist.init_process_group(backend=<span class="hljs-string">'nccl'</span>)

<span class="hljs-comment"># åŒ…è£…æ¨¡å‹</span>
model = nn.parallel.DistributedDataParallel(model)
</code></pre>
<h3 data-id="heading-19">ç”Ÿæ€ç³»ç»Ÿæ‰©å±•</h3>
<p>PyTorch æ‹¥æœ‰åºå¤§çš„ç”Ÿæ€ç³»ç»Ÿï¼Œä»¥ä¸‹æ˜¯ä¸€äº›é‡è¦çš„æ‰©å±•åº“ï¼š</p>
<ul>
<li><strong>torchvision</strong>ï¼šè®¡ç®—æœºè§†è§‰å·¥å…·åŒ…ï¼ŒåŒ…å«æ•°æ®é›†ã€æ¨¡å‹å’Œå›¾åƒå˜æ¢</li>
<li><strong>torchaudio</strong>ï¼šéŸ³é¢‘å¤„ç†å·¥å…·åŒ…</li>
<li><strong>torchtext</strong>ï¼šè‡ªç„¶è¯­è¨€å¤„ç†å·¥å…·åŒ…</li>
<li><strong>PyTorch Lightning</strong>ï¼šè½»é‡çº§è®­ç»ƒæ¡†æ¶ï¼Œç®€åŒ–è®­ç»ƒå¾ªç¯</li>
<li><strong>Hugging Face Transformers</strong>ï¼šæœ€æµè¡Œçš„ NLP é¢„è®­ç»ƒæ¨¡å‹åº“</li>
<li><strong>Captum</strong>ï¼šæ¨¡å‹å¯è§£é‡Šæ€§å·¥å…·</li>
</ul>
<h3 data-id="heading-20">å­¦ä¹ èµ„æºæ¨è</h3>
<p><strong>å®˜æ–¹èµ„æºï¼š</strong></p>
<ul>
<li>PyTorch å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fpytorch.org%2Fdocs%2F" target="_blank" title="https://pytorch.org/docs/" ref="nofollow noopener noreferrer">pytorch.org/docs/</a></li>
<li>PyTorch æ•™ç¨‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fpytorch.org%2Ftutorials%2F" target="_blank" title="https://pytorch.org/tutorials/" ref="nofollow noopener noreferrer">pytorch.org/tutorials/</a></li>
<li>PyTorch è®ºæ–‡ï¼šé˜…è¯» PyTorch å›¢é˜Ÿå‘è¡¨çš„è®ºæ–‡äº†è§£è®¾è®¡ç†å¿µ</li>
</ul>
<p><strong>ç¤¾åŒºèµ„æºï¼š</strong></p>
<ul>
<li>PyTorch è®ºå›ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdiscuss.pytorch.org%2F" target="_blank" title="https://discuss.pytorch.org/" ref="nofollow noopener noreferrer">discuss.pytorch.org/</a></li>
<li>GitHub ä¸Šä¸°å¯Œçš„å¼€æºé¡¹ç›®</li>
<li>ä¼˜ç§€çš„åšå®¢å’Œè§†é¢‘æ•™ç¨‹ï¼ˆå¦‚è«çƒ¦Pythonã€å´æ©è¾¾æ·±åº¦å­¦ä¹ è¯¾ç¨‹ï¼‰</li>
</ul>
<p><strong>å®è·µé¡¹ç›®ï¼š</strong></p>
<ul>
<li>å¤ç°ç»å…¸è®ºæ–‡ï¼šå°è¯•ç”¨ PyTorch å®ç° ResNetã€Transformer ç­‰ç»å…¸æ¨¡å‹</li>
<li>å‚åŠ  Kaggle æ¯”èµ›ï¼šåœ¨çœŸå®é—®é¢˜ä¸Šç£¨ç»ƒæŠ€èƒ½</li>
<li>è´¡çŒ®å¼€æºé¡¹ç›®ï¼šä¸º PyTorch ç”Ÿæ€ç³»ç»Ÿåšå‡ºè´¡çŒ®</li>
</ul>
<p>PyTorch çš„å­¦ä¹ æ›²çº¿è™½ç„¶å¹³ç¼“ï¼Œä½†è¦ç²¾é€šä»éœ€è¦å¤§é‡çš„å®è·µå’Œæ¢ç´¢ã€‚å»ºè®®ä»ç®€å•çš„é¡¹ç›®å¼€å§‹ï¼Œé€æ­¥æŒ‘æˆ˜æ›´å¤æ‚çš„ä»»åŠ¡ï¼Œå¤šé˜…è¯»ä¼˜ç§€ä»£ç ï¼Œå…³æ³¨ç¤¾åŒºåŠ¨æ€ã€‚æ·±åº¦å­¦ä¹ æ˜¯ä¸€ä¸ªå¿«é€Ÿå‘å±•çš„é¢†åŸŸï¼Œä¿æŒå¥½å¥‡å¿ƒå’ŒæŒç»­å­¦ä¹ çš„å¿ƒæ€è‡³å…³é‡è¦ã€‚</p>
<p>ç¥ä½ åœ¨ PyTorch çš„å­¦ä¹ ä¹‹æ—…ä¸­æ”¶è·æ»¡æ»¡ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Redis è°ƒä¼˜ï¼šå¿…é¡»å…³æ³¨çš„å‡ ä¸ªå‚æ•°]]></title>    <link>https://juejin.cn/post/7602935146706632750</link>    <guid>https://juejin.cn/post/7602935146706632750</guid>    <pubDate>2026-02-05T06:49:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602935146706632750" data-draft-id="7602928386596601882" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redis è°ƒä¼˜ï¼šå¿…é¡»å…³æ³¨çš„å‡ ä¸ªå‚æ•°"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-05T06:49:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¥å¥‡å°æ±¤åœ†"/> <meta itemprop="url" content="https://juejin.cn/user/1151943919285431"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redis è°ƒä¼˜ï¼šå¿…é¡»å…³æ³¨çš„å‡ ä¸ªå‚æ•°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1151943919285431/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¥å¥‡å°æ±¤åœ†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:49:57.000Z" title="Thu Feb 05 2026 06:49:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>åœ¨ä¸€å°æœªç»è¿‡ä»»ä½•è°ƒä¼˜çš„Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269234620%26content_type%3DArticle%26match_order%3D1%26q%3DLinux%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269234620&amp;content_type=Article&amp;match_order=1&amp;q=Linux&amp;zhida_source=entity" ref="nofollow noopener noreferrer">Linux</a>Â æœåŠ¡å™¨ä¸Šéƒ¨ç½² Redisï¼Œåœ¨ Redis å¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šç¢°åˆ°ä»¥ä¸‹è­¦å‘Šä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-number">1363410</span><span class="hljs-string">:M</span> <span class="hljs-number">15</span> <span class="hljs-string">Jan</span> <span class="hljs-number">2026 13:07:34.879</span> <span class="hljs-comment"># WARNING: The TCP backlog setting of 512 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.</span>
<span class="hljs-number">1363410</span><span class="hljs-string">:M</span> <span class="hljs-number">15</span> <span class="hljs-string">Jan</span> <span class="hljs-number">2026 13:07:34.879</span> <span class="hljs-comment"># Server initialized</span>
<span class="hljs-number">1363410</span><span class="hljs-string">:M</span> <span class="hljs-number">15</span> <span class="hljs-string">Jan</span> <span class="hljs-number">2026 13:07:34.879</span> <span class="hljs-comment"># WARNING Memory overcommit must be enabled! Without it, a background save or replication may fail under low memory condition. Being disabled, it can can also cause failures without low memory condition, see https://github.com/jemalloc/jemalloc/issues/1328. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.</span>
<span class="hljs-number">1363410</span><span class="hljs-string">:M</span> <span class="hljs-number">15</span> <span class="hljs-string">Jan</span> <span class="hljs-number">2026 13:07:34.879</span> <span class="hljs-comment"># WARNING You have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo madvise &gt; /sys/kernel/mm/transparent_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled (set to 'madvise' or 'never').</span>
</code></pre>
<p>è¿™äº›è­¦å‘Šä¿¡æ¯å®é™…ä¸Šæ˜¯åœ¨æé†’æˆ‘ä»¬ï¼Œæ“ä½œç³»ç»Ÿçš„æŸäº›å‚æ•°è®¾ç½®å¾—ä¸åˆç†ï¼Œéœ€è¦è°ƒæ•´ï¼Œå¦åˆ™ä¼šå½±å“ Redis çš„æ€§èƒ½å’Œç¨³å®šæ€§ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼ŒRedis è¿˜æä¾›äº†å¤šä¸ªå‚æ•°ï¼Œç”¨äºåœ¨è¿›ç¨‹æˆ–è¿æ¥çº§åˆ«è¿›è¡Œå†…æ ¸å‚æ•°ä¼˜åŒ–ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li><strong>tcp-backlog</strong>ï¼šè®¾ç½® TCP æœåŠ¡å™¨ä¸­<code>listen()</code>çš„ backlog å‚æ•°ã€‚</li>
<li><strong>disable-thp</strong>ï¼šåœ¨è¿›ç¨‹çº§åˆ«å…³é—­é€æ˜å¤§é¡µï¼ˆTHPï¼‰ã€‚</li>
<li><strong>tcp-keepalive</strong>ï¼šåœ¨è¿æ¥çº§åˆ«è®¾ç½®Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269234620%26content_type%3DArticle%26match_order%3D1%26q%3DTCP%2BKeepalive%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269234620&amp;content_type=Article&amp;match_order=1&amp;q=TCP+Keepalive&amp;zhida_source=entity" ref="nofollow noopener noreferrer">TCP Keepalive</a>Â å‚æ•°ã€‚</li>
<li><strong>server_cpulistã€bio_cpulist</strong>ï¼šå¯å°† Redis è¿›ç¨‹æˆ–åå° I/O çº¿ç¨‹ç»‘å®šåˆ°æŒ‡å®š CPUã€‚</li>
<li><strong>oom-score-adj</strong>ã€<strong>oom-score-adj-values</strong>ï¼šè°ƒæ•´è¿›ç¨‹çš„ oom_scoreã€‚oom_score æ˜¯ Linux å†…æ ¸ä¸ºæ¯ä¸ªè¿›ç¨‹è®¡ç®—çš„ä¸€ä¸ªæ•´æ•°å€¼ï¼ˆä½äº<code>/proc/[pid]/oom_score</code>ï¼‰ï¼Œåˆ†æ•°è¶Šé«˜ï¼Œè¿›ç¨‹åœ¨å†…å­˜ä¸è¶³æ—¶è¶Šå®¹æ˜“è¢« OOM Killer æ€æ­»ã€‚</li>
</ul>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬çœ‹çœ‹è¿™äº›å‚æ•°çš„å®ç°ç»†èŠ‚å’Œè®¾ç½®å»ºè®®ã€‚</p>
<h2 data-id="heading-1">tcp-backlog</h2>
<pre><code class="hljs language-sql" lang="sql">createIntConfig("tcp-backlog", <span class="hljs-keyword">NULL</span>, IMMUTABLE_CONFIG, <span class="hljs-number">0</span>, INT_MAX, server.tcp_backlog, <span class="hljs-number">511</span>, INTEGER_CONFIG, <span class="hljs-keyword">NULL</span>, <span class="hljs-keyword">NULL</span>), <span class="hljs-comment">/* TCP listen backlog. */</span>
</code></pre>
<p>tcp-backlog ç”¨äºè®¾ç½® TCP æœåŠ¡å™¨åœ¨è°ƒç”¨<code>listen()</code>æ—¶ä½¿ç”¨çš„ backlog å‚æ•°ã€‚è¯¥å‚æ•°ç”¨äºæŒ‡å®šå·²å®Œæˆä¸‰æ¬¡æ¡æ‰‹ã€ä½†å°šæœªè¢«<code>accept()</code>å¤„ç†çš„è¿æ¥é˜Ÿåˆ—é•¿åº¦ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹çš„ TCP æœåŠ¡å™¨æµç¨‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// 1. åˆ›å»º socket</span>
int fd = <span class="hljs-built_in">socket</span>(AF_INET, SOCK_STREAM, <span class="hljs-number">0</span>); 
<span class="hljs-comment">// 2. ç»‘å®š IP + ç«¯å£</span>
<span class="hljs-built_in">bind</span>(fd, ...);   
<span class="hljs-comment">// 3. å¼€å§‹ç›‘å¬</span>
<span class="hljs-built_in">listen</span>(fd, backlog);       
<span class="hljs-comment">// 4. æ¥å—è¿æ¥</span>
int connfd = <span class="hljs-built_in">accept</span>(fd, ...);
</code></pre>
<p>å½“å®¢æˆ·ç«¯å‘èµ·è¿æ¥æ—¶ï¼š</p>
<ol>
<li>TCP ä¸‰æ¬¡æ¡æ‰‹å®Œæˆåï¼Œè¿æ¥ä¼šè¢«æ”¾å…¥å·²å®Œæˆè¿æ¥é˜Ÿåˆ—ï¼ˆaccept queueï¼‰ï¼Œå…¶é•¿åº¦ç”±<code>listen(backlog)</code>æ§åˆ¶ã€‚</li>
<li>æœåŠ¡å™¨é€šè¿‡<code>accept()</code>ä»é˜Ÿåˆ—ä¸­å–èµ°è¿æ¥ï¼Œäº¤ç»™åº”ç”¨å±‚å¤„ç†ã€‚</li>
<li>å½“å·²å®Œæˆè¿æ¥é˜Ÿåˆ—å·²æ»¡æ—¶ï¼Œæ–°å®Œæˆä¸‰æ¬¡æ¡æ‰‹çš„è¿æ¥æ— æ³•è¿›å…¥ accept queueï¼Œå†…æ ¸é€šå¸¸ä¼šä¸¢å¼ƒæˆ–å»¶è¿Ÿ ACKï¼Œå¯¼è‡´å®¢æˆ·ç«¯å‡ºç°è¿æ¥è¶…æ—¶ã€é‡ä¼ ã€‚</li>
</ol>
<p>tcp-backlog çš„é»˜è®¤å€¼ä¸º 511ï¼Œå¯¹åº”çš„å†…å­˜å˜é‡ä¸º server.tcp_backlogã€‚</p>
<pre><code class="hljs language-perl" lang="perl">static <span class="hljs-keyword">int</span> anetListen(char *err, <span class="hljs-keyword">int</span> s, struct sockaddr *sa, socklen_t len, <span class="hljs-keyword">int</span> backlog) {
    <span class="hljs-regexp">//</span> å°† <span class="hljs-keyword">socket</span> ç»‘å®šåˆ°æŒ‡å®šçš„ IP å’Œç«¯å£
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">bind</span>(s,sa,len) == -<span class="hljs-number">1</span>) {
        anetSetError(err, <span class="hljs-string">"bind: %s"</span>, strerror(errno));
        <span class="hljs-keyword">close</span>(s);
        <span class="hljs-keyword">return</span> ANET_ERR;
    }
    // å°† <span class="hljs-keyword">socket</span> è®¾ç½®ä¸ºç›‘å¬çŠ¶æ€ï¼Œå¼€å§‹æ¥æ”¶å®¢æˆ·ç«¯è¿æ¥ï¼Œbacklog æŒ‡å®šå†…æ ¸å…è®¸æ’é˜Ÿçš„æœ€å¤§æœªå¤„ç†è¿æ¥æ•°
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">listen</span>(s, backlog) == -<span class="hljs-number">1</span>) {
        anetSetError(err, <span class="hljs-string">"listen: %s"</span>, strerror(errno));
        <span class="hljs-keyword">close</span>(s);
        <span class="hljs-keyword">return</span> ANET_ERR;
    }
    <span class="hljs-keyword">return</span> ANET_OK;
}
</code></pre>
<p>å®ä¾‹åœ¨å¯åŠ¨æ—¶ï¼Œä¼šè°ƒç”¨<code>checkTcpBacklogSettings()</code>æ£€æŸ¥ server.tcp_backlog çš„é…ç½®æ˜¯å¦åˆç†ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">void <span class="hljs-built_in">checkTcpBacklogSettings</span>(void) {
<span class="hljs-selector-id">#if</span> <span class="hljs-built_in">defined</span>(HAVE_PROC_SOMAXCONN)
    FILE *fp = <span class="hljs-built_in">fopen</span>("/proc/sys/net/core/somaxconn","r");
    char buf<span class="hljs-selector-attr">[1024]</span>;
    if (!fp) return;
    if (fgets(buf,sizeof(buf),fp) != NULL) {
        int somaxconn = <span class="hljs-built_in">atoi</span>(buf);
        if (somaxconn &gt; <span class="hljs-number">0</span> &amp;&amp; somaxconn &lt; server.tcp_backlog) {
            <span class="hljs-built_in">serverLog</span>(LL_WARNING,"WARNING: The TCP backlog setting of %d cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of %d.", server.tcp_backlog, somaxconn);
        }
    }
    <span class="hljs-built_in">fclose</span>(fp);
...
<span class="hljs-selector-id">#endif</span>
}
</code></pre>
<p>å…·ä½“å®ç°ä¸Šï¼Œå®ƒä¼šè·å–<code>/proc/sys/net/core/somaxconn</code>çš„å€¼ã€‚</p>
<p>somaxconn å†³å®šäº† Linux å†…æ ¸å…è®¸çš„å•ä¸ª TCP socket çš„æœ€å¤§ backlog é˜Ÿåˆ—é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯<code>listen()</code>çš„ backlog å‚æ•°åœ¨å†…æ ¸å±‚é¢çš„ä¸Šé™ã€‚</p>
<p>å¦‚æœ somaxconn çš„å€¼å°äº tcp-backlogï¼ŒRedis ä¼šæ‰“å°å¦‚ä¸‹ä¿¡æ¯ï¼Œæ­¤æ—¶ï¼Œåœ¨<code>listen()</code>å‡½æ•°ä¸­å®é™…ç”Ÿæ•ˆçš„å°±æ˜¯ somaxconn çš„å€¼ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># WARNING: The TCP backlog setting of 512 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.</span>
</code></pre>
<p>è®¾ç½®å»ºè®®ï¼šå¯¹äºæ™®é€šçš„ Web æœåŠ¡ï¼ˆå‡ ç™¾å¹¶å‘ï¼‰ï¼Œé»˜è®¤å€¼ï¼ˆ511ï¼‰å·²ç»è¶³å¤Ÿã€‚å¦‚æœæ˜¯é«˜å¹¶å‘æœåŠ¡ï¼ˆä¸Šä¸‡å¹¶å‘ TCP è¿æ¥ï¼‰ï¼Œå¯å°† backlog è°ƒæ•´ä¸º 4096 ç”šè‡³æ›´é«˜ã€‚</p>
<h2 data-id="heading-2">disable-thp</h2>
<pre><code class="hljs language-vbscript" lang="vbscript">createBoolConfig(<span class="hljs-string">"disable-thp"</span>, <span class="hljs-literal">NULL</span>, IMMUTABLE_CONFIG, <span class="hljs-built_in">server</span>.disable_thp, <span class="hljs-number">1</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>),
</code></pre>
<p>disable-thp ç”¨æ¥æ§åˆ¶æ˜¯å¦åœ¨è¿›ç¨‹çº§åˆ«å…³é—­é€æ˜å¤§é¡µã€‚é»˜è®¤å€¼æ˜¯ 1ï¼Œå¯¹åº”çš„å†…éƒ¨å˜é‡æ˜¯ server.disable_thpã€‚</p>
<p>å®ä¾‹åœ¨å¯åŠ¨æ—¶ï¼Œä¼šè°ƒç”¨<code>linuxMemoryWarnings</code>åˆ¤æ–­ Linux ç³»ç»Ÿå†…å­˜ç›¸å…³çš„é…ç½®ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">void linuxMemoryWarnings(void) {
    sds <span class="hljs-attr">err_msg</span> = NULL<span class="hljs-comment">;</span>
    if (checkOvercommit(&amp;err_msg) &lt; 0) {
        serverLog(LL_WARNING,"WARNING %s", err_msg)<span class="hljs-comment">;</span>
        sdsfree(err_msg)<span class="hljs-comment">;</span>
    }
    if (checkTHPEnabled(&amp;err_msg) &lt; 0) {
        <span class="hljs-attr">server.thp_enabled</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span>
        if (THPDisable() == 0) {
            <span class="hljs-attr">server.thp_enabled</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
        } else {
            serverLog(LL_WARNING, "WARNING %s", err_msg)<span class="hljs-comment">;</span>
        }
        sdsfree(err_msg)<span class="hljs-comment">;</span>
    }
}
</code></pre>
<p>åœ¨å…·ä½“å®ç°ä¸Šï¼Œè¯¥å‡½æ•°é¦–å…ˆä¼šè°ƒç”¨<code>checkOvercommit</code>è·å–<code>/proc/sys/vm/overcommit_memory</code>çš„å€¼ï¼Œå¦‚æœ overcommit_memory å€¼ä¸ä¸º 1ï¼Œåˆ™ä¼šæç¤ºä»¥ä¸‹è­¦å‘Šä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># WARNING Memory overcommit must be enabled! Without it, a background save or replication may fail under low memory condition. Being disabled, it can can also cause failures without low memory condition, see https://github.com/jemalloc/jemalloc/issues/1328. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.</span>
</code></pre>
<p>åœ¨ Redis ä¸­ï¼Œå»ºè®®å°† vm.overcommit_memory è®¾ç½®ä¸º 1ï¼Œå¦åˆ™<code>fork()</code>å­è¿›ç¨‹ï¼ˆå¦‚ RDBã€AOF rewriteã€å…¨é‡å¤åˆ¶ï¼‰æ“ä½œåœ¨ä½å†…å­˜æ—¶ä¼šå¤±è´¥ã€‚</p>
<p>æ¥ç€ï¼Œä¼šè°ƒç”¨<code>checkTHPEnabled</code>è·å–<code>/sys/kernel/mm/transparent_hugepage/enabled</code>çš„å€¼ï¼Œå¦‚æœå®ƒçš„å€¼ä¸º alwaysï¼Œåˆ™ä¼šè°ƒç”¨<code>THPDisable()</code>ã€‚</p>
<p>è¯¥å‡½æ•°ä¼šåŸºäº server.disable_thp çš„å€¼æ¥å†³å®šæ˜¯å¦ç¦ç”¨å½“å‰è¿›ç¨‹çš„é€æ˜å¤§é¡µã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/prctl.h&gt;</span></span>
<span class="hljs-comment">/* since linux-3.5, kernel supports to set the state of the "THP disable" flag
 * for the calling thread. PR_SET_THP_DISABLE is defined in linux/prctl.h */</span>
<span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title">THPDisable</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> </span>{
    <span class="hljs-type">int</span> ret = -EINVAL;

    <span class="hljs-keyword">if</span> (!server.disable_thp)
        <span class="hljs-keyword">return</span> ret;

<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> PR_SET_THP_DISABLE</span>
    ret = <span class="hljs-built_in">prctl</span>(PR_SET_THP_DISABLE, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>

    <span class="hljs-keyword">return</span> ret;
}
</code></pre>
<p>å¦‚æœè¯¥å˜é‡çš„å€¼ä¸º 0ï¼Œåˆ™ä¸å…³é—­ï¼Œå¦‚æœä¸º 1ï¼Œåˆ™ä¼šè°ƒç”¨<code>prctl(PR_SET_THP_DISABLE, 1, 0, 0, 0)</code>ç¦ç”¨å½“å‰è¿›ç¨‹çš„é€æ˜å¤§é¡µã€‚</p>
<p>å¦‚æœæ“ä½œç³»ç»Ÿå¼€å¯äº†é€æ˜å¤§é¡µï¼Œä¸” Redis æ²¡æœ‰å…³é—­ï¼Œåˆ™ä¼šåœ¨æ—¥å¿—ä¸­æ‰“å°ä»¥ä¸‹ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># WARNING You have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo madvise &gt; /sys/kernel/mm/transparent_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled (set to 'madvise' or 'never').</span>
</code></pre>
<p>åœ¨ Redis ä¸­ï¼Œå»ºè®®å…³é—­é€æ˜å¤§é¡µï¼Œå¦åˆ™<code>fork()</code>Â æ“ä½œå¯èƒ½å› ç®¡ç†å¤§é¡µè€Œæ˜¾è‘—å˜æ…¢ï¼Œè€Œä¸”å†…å­˜ç´§å¼ æ—¶ï¼Œåˆå¹¶/æ‹†åˆ†å¤§é¡µæ“ä½œä¹Ÿä¼šå¢åŠ  Redis å“åº”è€—æ—¶ã€‚</p>
<p>è®¾ç½®å»ºè®®ï¼šé»˜è®¤å€¼å³å¯ã€‚</p>
<h2 data-id="heading-3">tcp-keepalive</h2>
<pre><code class="hljs language-vbscript" lang="vbscript">createIntConfig(<span class="hljs-string">"tcp-keepalive"</span>, <span class="hljs-literal">NULL</span>, MODIFIABLE_CONFIG, <span class="hljs-number">0</span>, INT_MAX, <span class="hljs-built_in">server</span>.tcpkeepalive, <span class="hljs-number">300</span>, INTEGER_CONFIG, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>),
</code></pre>
<p>tcp-keepalive çš„é»˜è®¤å€¼ä¸º 300ï¼Œå¯¹åº”çš„å†…éƒ¨å˜é‡æ˜¯ server.tcpkeepaliveã€‚</p>
<p>Redis ä¼šåœ¨å»ºç«‹ TCP è¿æ¥åè°ƒç”¨<code>anetKeepAlive</code>å‡½æ•°ï¼Œé€šè¿‡ setsockopt é…ç½®åº•å±‚ socket çš„ keepalive å‚æ•°ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">int anetKeepAlive(char *err, int fd, int interval)
{
    int <span class="hljs-keyword">val</span> = <span class="hljs-number">1</span>;
    <span class="hljs-comment">// å¯ç”¨ TCP keepalive</span>
    <span class="hljs-keyword">if</span> (setsockopt(fd, SOL_SOCKET, SO_KEEPALIVE, &amp;<span class="hljs-keyword">val</span>, sizeof(<span class="hljs-keyword">val</span>)) == -<span class="hljs-number">1</span>)
    {
        anetSetError(err, <span class="hljs-string">"setsockopt SO_KEEPALIVE: %s"</span>, strerror(errno));
        <span class="hljs-keyword">return</span> ANET_ERR;
    }
    <span class="hljs-comment">// è®¾ç½®é¦–æ¬¡æ¢æµ‹æ—¶é—´ï¼šç©ºé—² interval ç§’åå¼€å§‹å‘é€ç¬¬ä¸€ä¸ªæ¢æµ‹åŒ…</span>
    <span class="hljs-keyword">val</span> = interval;
    <span class="hljs-keyword">if</span> (setsockopt(fd, IPPROTO_TCP, TCP_KEEPIDLE, &amp;<span class="hljs-keyword">val</span>, sizeof(<span class="hljs-keyword">val</span>)) &lt; <span class="hljs-number">0</span>) {
        anetSetError(err, <span class="hljs-string">"setsockopt TCP_KEEPIDLE: %s\n"</span>, strerror(errno));
        <span class="hljs-keyword">return</span> ANET_ERR;
    }
    <span class="hljs-comment">// è®¾ç½®æ¢æµ‹é—´éš”ï¼šæ¯ interval/3 ç§’å‘é€ä¸€æ¬¡æ¢æµ‹åŒ…</span>
    <span class="hljs-keyword">val</span> = interval/<span class="hljs-number">3</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">val</span> == <span class="hljs-number">0</span>) <span class="hljs-keyword">val</span> = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (setsockopt(fd, IPPROTO_TCP, TCP_KEEPINTVL, &amp;<span class="hljs-keyword">val</span>, sizeof(<span class="hljs-keyword">val</span>)) &lt; <span class="hljs-number">0</span>) {
        anetSetError(err, <span class="hljs-string">"setsockopt TCP_KEEPINTVL: %s\n"</span>, strerror(errno));
        <span class="hljs-keyword">return</span> ANET_ERR;
    }
    <span class="hljs-comment">// è®¾ç½®æœ€å¤§æ¢æµ‹æ¬¡æ•°ï¼šè¿ç»­ 3 æ¬¡æ¢æµ‹å¤±è´¥ååˆ¤å®šè¿æ¥å·²æ­»</span>
    <span class="hljs-keyword">val</span> = <span class="hljs-number">3</span>;
    <span class="hljs-keyword">if</span> (setsockopt(fd, IPPROTO_TCP, TCP_KEEPCNT, &amp;<span class="hljs-keyword">val</span>, sizeof(<span class="hljs-keyword">val</span>)) &lt; <span class="hljs-number">0</span>) {
        anetSetError(err, <span class="hljs-string">"setsockopt TCP_KEEPCNT: %s\n"</span>, strerror(errno));
        <span class="hljs-keyword">return</span> ANET_ERR;
    }
    ...
    <span class="hljs-keyword">return</span> ANET_OK;
}
</code></pre>
<p>ä¸‹é¢æ˜¯ Redis ä¸­çš„è®¾ç½®ä¸ Linux å¯¹åº”å‚æ•°é»˜è®¤å€¼çš„å¯¹æ¯”ï¼š</p>





























<table><thead><tr><th>é€‰é¡¹</th><th>å¯¹åº”å†…æ ¸å‚æ•°</th><th>ä½œç”¨</th><th>ä»£ç é€»è¾‘ä¸é»˜è®¤å€¼å¯¹æ¯”</th></tr></thead><tbody><tr><td>TCP_KEEPIDLE</td><td>net.ipv4.tcp_keepalive_time</td><td>é¦–æ¬¡æ¢æµ‹çš„ç­‰å¾…æ—¶é—´ã€‚è¿æ¥ç©ºé—²å¤šä¹…åå‘é€ç¬¬ä¸€ä¸ªæ¢æµ‹åŒ…ã€‚</td><td>è®¾ä¸º tcp-keepaliveã€‚é»˜è®¤æ˜¯ 7200 ç§’ã€‚</td></tr><tr><td>TCP_KEEPINTVL</td><td>net.ipv4.tcp_keepalive_intvl</td><td>æ¢æµ‹é—´éš”ã€‚ä¸¤ä¸ªæ¢æµ‹åŒ…ä¹‹é—´çš„æ—¶é—´ã€‚</td><td>è®¾ä¸º tcp-keepalive/3ï¼ˆæœ€å°ä¸º1ï¼‰ã€‚é»˜è®¤æ˜¯ 75 ç§’ã€‚</td></tr><tr><td>TCP_KEEPCNT</td><td>net.ipv4.tcp_keepalive_probes</td><td>æ¢æµ‹æ¬¡æ•°ã€‚è¾¾åˆ°æ¬¡æ•°åä»æ— å“åº”åˆ™åˆ¤å®šè¿æ¥æ­»äº¡ã€‚</td><td>å›ºå®šè®¾ä¸º 3ã€‚é»˜è®¤æ˜¯ 9 æ¬¡ã€‚</td></tr></tbody></table>
<p>Redis é€šè¿‡åœ¨è¿æ¥çº§åˆ«è®¾ç½®è¾ƒçŸ­çš„ TCP Keepalive å‚æ•°ï¼Œå¯ä»¥æå‰å‘ç°æ­»æ‰æˆ–å¼‚å¸¸çš„å®¢æˆ·ç«¯è¿æ¥ï¼›é¿å…é•¿æ—¶é—´ä¿ç•™æ— æ•ˆè¿æ¥å ç”¨èµ„æºï¼›æé«˜ Redis åœ¨é•¿è¿æ¥å’Œé«˜å¹¶å‘åœºæ™¯ä¸‹çš„ç¨³å®šæ€§ã€‚</p>
<p>è®¾ç½®å»ºè®®ï¼šé»˜è®¤å€¼å³å¯ã€‚å¦‚æœç½‘ç»œè´¨é‡ç‰¹åˆ«å·®ï¼Œå¯è®¾ç½®æ›´å°çš„å€¼ã€‚</p>
<h2 data-id="heading-4">xxx_cpulist</h2>
<p>Redis æ”¯æŒé€šè¿‡å‚æ•°å¯¹ä¸åŒæ‰§è¡Œå•å…ƒè¿›è¡Œ CPU ç»‘å®šï¼Œç›¸å…³å‚æ•°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-vbscript" lang="vbscript">createStringConfig(<span class="hljs-string">"server_cpulist"</span>, <span class="hljs-literal">NULL</span>, IMMUTABLE_CONFIG, EMPTY_STRING_IS_NULL, <span class="hljs-built_in">server</span>.server_cpulist, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>),
createStringConfig(<span class="hljs-string">"bio_cpulist"</span>, <span class="hljs-literal">NULL</span>, IMMUTABLE_CONFIG, EMPTY_STRING_IS_NULL, <span class="hljs-built_in">server</span>.bio_cpulist, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>),
createStringConfig(<span class="hljs-string">"aof_rewrite_cpulist"</span>, <span class="hljs-literal">NULL</span>, IMMUTABLE_CONFIG, EMPTY_STRING_IS_NULL, <span class="hljs-built_in">server</span>.aof_rewrite_cpulist, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>),
createStringConfig(<span class="hljs-string">"bgsave_cpulist"</span>, <span class="hljs-literal">NULL</span>, IMMUTABLE_CONFIG, EMPTY_STRING_IS_NULL, <span class="hljs-built_in">server</span>.bgsave_cpulist, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>),
</code></pre>
<p>å…¶ä¸­ï¼Œserver_cpulistã€bio_cpulistã€bgsave_cpulistã€aof_rewrite_cpulist åˆ†åˆ«ç”¨äºç»‘å®š Redis ä¸»çº¿ç¨‹ã€BIO åå°çº¿ç¨‹ã€RDB å­è¿›ç¨‹å’Œ AOF rewrite å­è¿›ç¨‹ã€‚</p>
<p>åœ¨å®ç°ä¸Šï¼ŒRedis æä¾›äº†<code>setcpuaffinity</code>å‡½æ•°æ¥å°è£… CPU ç»‘å®šæ“ä½œï¼Œè¯¥å‡½æ•°ä¼šæ ¹æ®æ“ä½œç³»ç»Ÿè°ƒç”¨å¯¹åº”æ¥å£ã€‚ä¾‹å¦‚ï¼Œåœ¨ Linux ä¸Šï¼Œå®ƒä¼šä½¿ç”¨<code>sched_setaffinity</code>å°†çº¿ç¨‹ç»‘å®šåˆ°æŒ‡å®šæ ¸å¿ƒã€‚</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-type">void</span> <span class="hljs-title function_">redisSetCpuAffinity</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *cpulist)</span> {
<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> USE_SETCPUAFFINITY</span>
    setcpuaffinity(cpulist);
<span class="hljs-meta">#<span class="hljs-keyword">else</span></span>
    UNUSED(cpulist);
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
}

<span class="hljs-comment">/* set current thread cpu affinity to cpu list, this function works like
 * taskset command (actually cpulist parsing logic reference to util-linux).
 * example of this function: "0,2,3", "0,2-3", "0-20:2". */</span>
<span class="hljs-type">void</span> <span class="hljs-title function_">setcpuaffinity</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *cpulist)</span> {
...
<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> __linux__</span>
    sched_setaffinity(<span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(cpuset), &amp;cpuset);
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> __FreeBSD__</span>
    cpuset_setaffinity(CPU_LEVEL_WHICH, CPU_WHICH_TID, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span>(cpuset), &amp;cpuset);
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> __DragonFly__</span>
    pthread_setaffinity_np(pthread_self(), <span class="hljs-keyword">sizeof</span>(cpuset), &amp;cpuset);
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> __NetBSD__</span>
    pthread_setaffinity_np(pthread_self(), cpuset_size(cpuset), cpuset);
    cpuset_destroy(cpuset);
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
}
</code></pre>
<p>å¯¹äº Redis è¿™ç§å•çº¿ç¨‹åº”ç”¨ï¼ˆä¸»çº¿ç¨‹åªèƒ½åœ¨ä¸€ä¸ª CPU æ ¸å¿ƒä¸Šå¤„ç†è¯·æ±‚ï¼‰æ¥è¯´ï¼Œè¿›è¡Œ CPU ç»‘å®šçš„å¥½å¤„æ˜¾è€Œæ˜“è§ï¼šå‡å°‘ CPU ä¸Šä¸‹æ–‡åˆ‡æ¢ã€æé«˜ CPU Cache å‘½ä¸­ç‡ã€é¿å…å—åˆ°å…¶ä»–é«˜è´Ÿè½½ä»»åŠ¡çš„å¹²æ‰°ã€‚å”¯ä¸€çš„ä¸è¶³æ˜¯å¢åŠ äº†è¿ç»´çš„é…ç½®å’Œç®¡ç†æˆæœ¬ã€‚</p>
<h2 data-id="heading-5">oom-score-adjã€oom-score-adj-values</h2>
<pre><code class="hljs language-vbscript" lang="vbscript">createEnumConfig(<span class="hljs-string">"oom-score-adj"</span>, <span class="hljs-literal">NULL</span>, MODIFIABLE_CONFIG, oom_score_adj_enum, <span class="hljs-built_in">server</span>.oom_score_adj, OOM_SCORE_ADJ_NO, <span class="hljs-literal">NULL</span>, updateOOMScoreAdj),
createSpecialConfig(<span class="hljs-string">"oom-score-adj-values"</span>, <span class="hljs-literal">NULL</span>, MODIFIABLE_CONFIG | MULTI_ARG_CONFIG, setConfigOOMScoreAdjValuesOption, getConfigOOMScoreAdjValuesOption, rewriteConfigOOMScoreAdjValuesOption, updateOOMScoreAdj),
</code></pre>
<p>å…¶ä¸­ï¼Œ</p>
<ul>
<li>oom-score-adjï¼šæ˜¯å¦å¯ç”¨ OOM è°ƒæ•´ã€‚å¯é€‰å€¼æœ‰ï¼š</li>
<li>
<ul>
<li>noï¼šç¦ç”¨ã€‚é»˜è®¤å€¼ã€‚</li>
<li>yes / relativeï¼šå¯ç”¨ç›¸å¯¹æ¨¡å¼ï¼ˆåœ¨ç³»ç»ŸåŸå§‹ OOM å€¼çš„åŸºç¡€ä¸Šå åŠ ï¼‰ã€‚</li>
<li>absoluteï¼šå¯ç”¨ç»å¯¹æ¨¡å¼ï¼ˆç›´æ¥ä½¿ç”¨é…ç½®å€¼ï¼Œä¸è€ƒè™‘ç³»ç»ŸåŸå§‹å€¼ï¼‰ã€‚</li>
</ul>
</li>
<li>oom-score-adj-valuesï¼šé’ˆå¯¹ä¸åŒè§’è‰²è®¾ç½® OOM æƒé‡ã€‚è¯¥å‚æ•°éœ€è¦é…ç½®ä¸‰ä¸ªå€¼ï¼Œåˆ†åˆ«å¯¹åº”ï¼šä¸»èŠ‚ç‚¹ã€ä»èŠ‚ç‚¹ã€åå°å­è¿›ç¨‹ï¼ˆBGCHILDï¼Œç”¨äº RDB / AOF / å¤åˆ¶ï¼‰ã€‚é»˜è®¤å€¼ä¸º<code>0 200 800</code>ã€‚æ•°å€¼è¶Šå¤§ï¼Œè¡¨ç¤ºåœ¨ç³»ç»Ÿå†…å­˜ç´§å¼ æ—¶è¶Šå®¹æ˜“è¢« OOM Killer æ€æ­»ã€‚</li>
</ul>
<p>æ— è®ºæ˜¯ä¿®æ”¹ oom-score-adj è¿˜æ˜¯ oom-score-adj-valuesï¼Œéƒ½ä¼šè°ƒç”¨<code>updateOOMScoreAdj</code>Â ã€‚</p>
<p>è¯¥å‡½æ•°ä¼šæ ¹æ®è¿›ç¨‹è§’è‰²ï¼ˆä¸»èŠ‚ç‚¹ã€ä»èŠ‚ç‚¹æˆ–åå°å­è¿›ç¨‹ï¼‰ä¸ºå½“å‰è¿›ç¨‹è®¾ç½®å¯¹åº”çš„ oom_score_adj å€¼ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">static int updateOOMScoreAdj(const char **err) {
    if (setOOMScoreAdj(-1) == C_ERR) {
        *<span class="hljs-attr">err</span> = <span class="hljs-string">"Failed to set current oom_score_adj. Check server logs."</span><span class="hljs-comment">;</span>
        return 0<span class="hljs-comment">;</span>
    }

    return 1<span class="hljs-comment">;</span>
}

// æ ¹æ®è¿›ç¨‹ç±»åˆ«è®¾ç½® Redis çš„ oom_score_adjï¼Œprocess_class: è¿›ç¨‹ç±»åˆ«ï¼Œ-1 è¡¨ç¤ºè‡ªåŠ¨é€‰æ‹©
int setOOMScoreAdj(int process_class) {
    // å¦‚æœä¼ å…¥ -1ï¼Œè‡ªåŠ¨æ ¹æ®è§’è‰²é€‰æ‹© master æˆ– replica
    if (<span class="hljs-attr">process_class</span> == -<span class="hljs-number">1</span>)
        <span class="hljs-attr">process_class</span> = (server.masterhost ? CONFIG_OOM_REPLICA : CONFIG_OOM_MASTER)<span class="hljs-comment">;</span>

    serverAssert(process_class &gt;= 0 &amp;&amp; process_class &lt; CONFIG_OOM_COUNT)<span class="hljs-comment">;</span>

<span class="hljs-comment">#ifdef HAVE_PROC_OOM_SCORE_ADJ</span>
    // oom_score_adjusted_by_redisï¼šæ ‡è®° Redis æ˜¯å¦å·²ä¿®æ”¹è¿‡ OOM åˆ†æ•°ã€‚
    // oom_score_adj_baseï¼šä¿å­˜åŸå§‹ OOM åˆ†æ•°ï¼Œä»¥ä¾¿å›æ»šæˆ–ç¦ç”¨æ—¶æ¢å¤ã€‚
    static int <span class="hljs-attr">oom_score_adjusted_by_redis</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
    static int <span class="hljs-attr">oom_score_adj_base</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>

    int fd<span class="hljs-comment">;</span>
    int val<span class="hljs-comment">;</span>
    char buf<span class="hljs-section">[64]</span><span class="hljs-comment">;</span>
    // oom_score_adj ä¸ä¸º no
    if (server.oom_score_adj != OOM_SCORE_ADJ_NO) {
        // ç¬¬ä¸€æ¬¡ä¿®æ”¹æ—¶ï¼Œå¤‡ä»½åŸå§‹ oom_score_adj
        if (!oom_score_adjusted_by_redis) {
            <span class="hljs-attr">oom_score_adjusted_by_redis</span> = <span class="hljs-number">1</span><span class="hljs-comment">;</span>
            /* Backup base value before enabling Redis control over oom score */
            <span class="hljs-attr">fd</span> = open(<span class="hljs-string">"/proc/self/oom_score_adj"</span>, O_RDONLY)<span class="hljs-comment">;</span>
            if (fd &lt; 0 || read(fd, buf, sizeof(buf)) &lt; 0) {
                serverLog(LL_WARNING, "Unable to read oom_score_adj: %s", strerror(errno))<span class="hljs-comment">;</span>
                if (fd != -1) close(fd)<span class="hljs-comment">;</span>
                return C_ERR<span class="hljs-comment">;</span>
            }
            <span class="hljs-attr">oom_score_adj_base</span> = atoi(buf)<span class="hljs-comment">;</span>
            close(fd)<span class="hljs-comment">;</span>
        }
        // è·å–é…ç½®çš„ OOM åˆ†æ•°
        <span class="hljs-attr">val</span> = server.oom_score_adj_values[process_class]<span class="hljs-comment">;</span>
        // å¦‚æœæ˜¯ç›¸å¯¹æ¨¡å¼ï¼Œç´¯åŠ åŸå§‹å€¼
        if (<span class="hljs-attr">server.oom_score_adj</span> == OOM_SCORE_RELATIVE)
            val += oom_score_adj_base<span class="hljs-comment">;</span>
        // é™åˆ¶å€¼åœ¨ <span class="hljs-section">[-1000, 1000]</span>
        if (val &gt; 1000) <span class="hljs-attr">val</span> = <span class="hljs-number">1000</span><span class="hljs-comment">;</span>
        if (val &lt; -1000) <span class="hljs-attr">val</span> = -<span class="hljs-number">1000</span><span class="hljs-comment">;</span>
    } else if (oom_score_adjusted_by_redis) {
        // å¦‚æœé…ç½®ç¦ç”¨ OOM è°ƒæ•´ä¸”ä¹‹å‰å·²ä¿®æ”¹è¿‡ï¼Œæ¢å¤åŸå§‹å€¼
        <span class="hljs-attr">oom_score_adjusted_by_redis</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
        <span class="hljs-attr">val</span> = oom_score_adj_base<span class="hljs-comment">;</span>
    }
    else {
        return C_OK<span class="hljs-comment">;</span>
    }

    snprintf(buf, sizeof(buf) - 1, "%d\n", val)<span class="hljs-comment">;</span>
    // å†™å…¥ /proc/self/oom_score_adjï¼Œä½¿å†…æ ¸ç”Ÿæ•ˆ
    <span class="hljs-attr">fd</span> = open(<span class="hljs-string">"/proc/self/oom_score_adj"</span>, O_WRONLY)<span class="hljs-comment">;</span>
    if (fd &lt; 0 || write(fd, buf, strlen(buf)) &lt; 0) {
        serverLog(LL_WARNING, "Unable to write oom_score_adj: %s", strerror(errno))<span class="hljs-comment">;</span>
        if (fd != -1) close(fd)<span class="hljs-comment">;</span>
        return C_ERR<span class="hljs-comment">;</span>
    }

    close(fd)<span class="hljs-comment">;</span>
    return C_OK<span class="hljs-comment">;</span>
<span class="hljs-comment">#else</span>
    /* Unsupported */
    return C_ERR<span class="hljs-comment">;</span>
<span class="hljs-comment">#endif</span>
}
</code></pre>
<p>å…·ä½“å®ç°ä¸Šï¼Œç³»ç»Ÿçš„åŸå§‹ OOM å€¼é€šè¿‡è¯»å–<code>/proc/self/oom_score_adj</code>è·å–ã€‚</p>
<p>åœ¨ç¬¬ä¸€æ¬¡å¯ç”¨ OOM è°ƒæ•´æ—¶ï¼ŒRedis ä¼šå°†è¯¥åŸå§‹å€¼ä¿å­˜åˆ° oom_score_adj_base ä¸­ï¼Œä»¥ä¾¿åœ¨åç»­ç¦ç”¨é…ç½®æˆ–å‘ç”Ÿé…ç½®å›æ»šæ—¶ï¼Œèƒ½å¤Ÿå°†è¿›ç¨‹çš„ OOM å€¼æ¢å¤ä¸ºè°ƒæ•´å‰çš„çŠ¶æ€ã€‚</p>
<p>æ— è®ºæ˜¯ç›¸å¯¹æ¨¡å¼è¿˜æ˜¯ç»å¯¹æ¨¡å¼ï¼Œæœ€ç»ˆç”Ÿæ•ˆçš„ OOM å€¼éƒ½ä¼šå†™å›åˆ°<code>/proc/self/oom_score_adj</code>ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œoom-score-adj-values å…è®¸é…ç½®çš„å–å€¼èŒƒå›´ä¸º [-2000, 2000]ï¼Œè€Œ Linux å†…æ ¸å®é™…æ”¯æŒçš„ oom_score_adj èŒƒå›´ä»…ä¸º[-1000, 1000]ã€‚</p>
<p>ä¹‹æ‰€ä»¥æ”¾å®½é…ç½®èŒƒå›´ï¼Œæ˜¯ä¸ºäº†æ›´å¥½åœ°æ”¯æŒç›¸å¯¹æ¨¡å¼ï¼ˆrelativeï¼‰ï¼šåœ¨ç›¸å¯¹æ¨¡å¼ä¸‹ï¼Œé…ç½®å€¼ä¼šä¸ç³»ç»ŸåŸå§‹ OOM å€¼è¿›è¡Œå åŠ ï¼Œå åŠ åçš„ç»“æœå†è¢«è£å‰ªåˆ°å†…æ ¸å…è®¸çš„èŒƒå›´å†…ï¼Œä»è€Œåœ¨ä¸åŒç³»ç»Ÿåˆå§‹ OOM è®¾ç½®ä¸‹ä»èƒ½ä¿æŒåˆç†ã€å¯æ§çš„è°ƒæ•´æ•ˆæœã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenClaw è°ƒåº¦æ¶æ„æ·±åº¦å‰–æï¼šé«˜è‡ªä¸» AI ä»£ç†å¦‚ä½•å®ç°ç¡®å®šæ€§ä»»åŠ¡ç¼–æ’ä¸å®æ—¶å“åº”]]></title>    <link>https://juejin.cn/post/7602928783597060102</link>    <guid>https://juejin.cn/post/7602928783597060102</guid>    <pubDate>2026-02-05T06:50:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602928783597060102" data-draft-id="7602996277663875126" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenClaw è°ƒåº¦æ¶æ„æ·±åº¦å‰–æï¼šé«˜è‡ªä¸» AI ä»£ç†å¦‚ä½•å®ç°ç¡®å®šæ€§ä»»åŠ¡ç¼–æ’ä¸å®æ—¶å“åº”"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2026-02-05T06:50:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="RoyLin"/> <meta itemprop="url" content="https://juejin.cn/user/2928754708185917"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenClaw è°ƒåº¦æ¶æ„æ·±åº¦å‰–æï¼šé«˜è‡ªä¸» AI ä»£ç†å¦‚ä½•å®ç°ç¡®å®šæ€§ä»»åŠ¡ç¼–æ’ä¸å®æ—¶å“åº”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2928754708185917/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    RoyLin
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:50:20.000Z" title="Thu Feb 05 2026 06:50:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>OpenClawï¼ˆå‰èº« Clawdbot / Moltbotï¼‰ä½œä¸ºç›®å‰æœ€æ´»è·ƒçš„è‡ªæ‰˜ç®¡å¸¸é©»å¼ agentic AI å¹³å°ä¹‹ä¸€ï¼Œä»¥å…¶å¼ºå¤§çš„é•¿æœŸè‡ªæ²»èƒ½åŠ›ã€å¤šæºè§¦å‘å“åº”ã€å¤æ‚å·¥å…·é“¾å¹¶å‘æ‰§è¡Œè€Œåœ¨ç¤¾åŒºè¿…é€Ÿç§¯ç´¯çƒ­åº¦ã€‚å…¶åº•å±‚ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿèƒ½å¤Ÿåœ¨å¤„ç†æµ·é‡å¼‚æ­¥äº‹ä»¶ã€ç”¨æˆ·äº¤äº’ã€å®šæ—¶ä»»åŠ¡ã€å¤–éƒ¨è§¦å‘çš„åŒæ—¶ï¼Œä¿æŒä½å»¶è¿Ÿã€é«˜ç¡®å®šæ€§å’Œå¯æ§æ€§ï¼Œæˆä¸º agentic ç³»ç»Ÿå·¥ç¨‹å®è·µçš„å…¸å‹æ¡ˆä¾‹ã€‚</p>
<p>æœ¬æ–‡åŸºäº OpenClaw çš„å…¬å¼€è®¾è®¡æ–‡æ¡£ã€ç¤¾åŒºè®¨è®ºä¸å®é™…è¿è¡Œç‰¹å¾ï¼Œç³»ç»Ÿæ‹†è§£å…¶è°ƒåº¦æ¶æ„çš„æ ¸å¿ƒé€»è¾‘ã€ä¼˜å…ˆçº§ç­–ç•¥ã€å¹¶å‘éš”ç¦»æœºåˆ¶ä¸å¯é æ€§ä¿éšœæ‰‹æ®µï¼Œå¹¶ç»“åˆè‡ªåŠ¨é©¾é©¶é¢†åŸŸå¸¸è§çš„ç±»ä¼¼éœ€æ±‚è¿›è¡Œå¯¹æ¯”åˆ†æï¼Œå¸®åŠ©å¼€å‘è€…ç†è§£è¿™ç±»é«˜è‡ªä¸» AI ä»£ç†åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹çš„çœŸå®å·¥ç¨‹æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-0">OpenClaw ä»»åŠ¡è°ƒåº¦æ ¸å¿ƒæ¶æ„æ€»è§ˆ</h2>
<p>OpenClaw çš„è¿è¡Œæ—¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ°¸ä¸åœæ­¢çš„â€œäº‹ä»¶-å†³ç­–-è¡ŒåŠ¨â€é—­ç¯å¼•æ“ï¼Œä¸»è¦ç”±ä»¥ä¸‹å‡ ä¸ªå…³é”®å±‚ç»„æˆï¼š</p>
<ol>
<li>
<p><strong>äº‹ä»¶æºå±‚</strong><br/>
æŒç»­ç›‘å¬å¤šæ¸ é“è¾“å…¥ï¼šç”¨æˆ·èŠå¤©æ¶ˆæ¯ã€é‚®ä»¶/IM é€šçŸ¥ã€æ–‡ä»¶/ç›®å½•å˜æ›´ç›‘æ§ã€å®šæ—¶ Cronã€Webhookã€RSS è®¢é˜…ç­‰ã€‚æ¯ä¸ªäº‹ä»¶è¢«å°è£…ä¸ºç»Ÿä¸€çš„â€œè§¦å‘å™¨â€ï¼ˆTriggerï¼‰å¯¹è±¡ï¼Œæºå¸¦å…ƒä¿¡æ¯ï¼ˆæ¥æºã€ç´§æ€¥åº¦ã€å…³è”ä¼šè¯ç­‰ï¼‰ã€‚</p>
</li>
<li>
<p><strong>ä»»åŠ¡ç”Ÿæˆä¸ä¼˜å…ˆçº§æ ‡æ³¨å±‚</strong><br/>
è§¦å‘å™¨ç»è¿‡ LLM æ¨ç†æˆ–è§„åˆ™å¼•æ“åï¼Œç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªå¯æ‰§è¡Œçš„â€œå‘½ä»¤â€ï¼ˆCommandï¼‰ï¼Œæ¯ä¸ªå‘½ä»¤è¢«èµ‹äºˆä¼˜å…ˆçº§æ ‡ç­¾ã€‚ä¼˜å…ˆçº§é€šå¸¸åˆ†ä¸º 4â€“6 ä¸ªçº§åˆ«ï¼š</p>
<ul>
<li>æœ€é«˜ï¼šç³»ç»Ÿçº§å®‰å…¨/ç´§æ€¥å¹²é¢„ï¼ˆæ²™ç®±é€ƒé€¸æ¢å¤ã€æ•æ„Ÿæ“ä½œç¡®è®¤ã€ç«‹å³åœæ­¢ï¼‰</li>
<li>é«˜ï¼šç”¨æˆ·ç›´æ¥æŒ‡ä»¤ï¼ˆå°¤å…¶æ˜¯åŒ…å«â€œç°åœ¨â€â€œç´§æ€¥â€â€œç«‹å³â€ç­‰æ˜¾å¼æ€¥è¿«è¯­ä¹‰ï¼‰</li>
<li>ä¸­ï¼šå®æ—¶å“åº”å‹ä»»åŠ¡ï¼ˆé‚®ä»¶å›å¤ã€å¼‚å¸¸å‘Šè­¦æ¨é€ã€æµè§ˆå™¨å…³é”®æ­¥éª¤ï¼‰</li>
<li>ä½ï¼šä¸»åŠ¨è§„åˆ’å‹ä»»åŠ¡ï¼ˆæ¯æ—¥/æ¯å‘¨æ‘˜è¦ã€é•¿æœŸç›®æ ‡æ‹†è§£ï¼‰</li>
<li>æä½ï¼šåå°ç»´æŠ¤ï¼ˆç´¢å¼•æ„å»ºã€æ—¥å¿—èšåˆã€æ¨¡å‹ç¼“å­˜åˆ·æ–°ï¼‰</li>
</ul>
</li>
<li>
<p><strong>å¤šçº§æ‰§è¡Œé˜Ÿåˆ—ä¸è°ƒåº¦å™¨</strong><br/>
OpenClaw é‡‡ç”¨å¤šé˜Ÿåˆ— + ä¼˜å…ˆçº§è°ƒåº¦å™¨æ¨¡å‹ï¼Œè€Œéå•ä¸€ FIFO é˜Ÿåˆ—ã€‚è°ƒåº¦å™¨æŒ‰ä¼˜å…ˆçº§é¡ºåºè½®è¯¢å„ä¸ªé˜Ÿåˆ—ï¼Œåªæœ‰å½“å‰æœ€é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸ºç©ºæˆ–è¾¾åˆ°å¹¶å‘ä¸Šé™æ—¶ï¼Œæ‰ä¼šä¸‹æ¢åˆ°ä¸‹ä¸€çº§ã€‚è¿™ç§è®¾è®¡ç¡®ä¿äº†å…³é”®è·¯å¾„çš„ç¡®å®šæ€§å“åº”ã€‚</p>
</li>
<li>
<p><strong>æ‰§è¡Œå¼•æ“å±‚</strong><br/>
åŸºäº Tokioï¼ˆæˆ–ç±»ä¼¼å¼‚æ­¥è¿è¡Œæ—¶ï¼‰çš„å·¥ä½œè€…æ± æ‰§è¡Œå‘½ä»¤ï¼Œæ”¯æŒå·¥å…·è°ƒç”¨ï¼ˆæµè§ˆå™¨è‡ªåŠ¨åŒ–ã€shell æ‰§è¡Œã€API è¯·æ±‚ç­‰ï¼‰ã€‚æ¯ä¸ªå‘½ä»¤æ‰§è¡Œä¸Šä¸‹æ–‡ç‹¬ç«‹ï¼ŒåŒ…å«è¶…æ—¶ã€é‡è¯•ã€é”™è¯¯æ•è·ä¸ç»“æœå›ä¼ æœºåˆ¶ã€‚</p>
</li>
<li>
<p><strong>çŠ¶æ€ä¸å†å²ç®¡ç†</strong><br/>
æ‰€æœ‰å‘½ä»¤æ‰§è¡Œè®°å½•æŒä¹…åŒ–åˆ°æœ¬åœ°æ•°æ®åº“ï¼ˆé€šå¸¸ SQLite æˆ– LevelDBï¼‰ï¼Œæ”¯æŒæ–­ç‚¹ç»­è·‘ã€å¤±è´¥é‡æ”¾ã€äººå·¥å¹²é¢„ç­‰åŠŸèƒ½ã€‚</p>
</li>
</ol>
<h2 data-id="heading-1">ä¼˜å…ˆçº§ä¸å¹¶å‘éš”ç¦»çš„å…³é”®å®ç°ç»†èŠ‚</h2>
<p>OpenClaw é€šè¿‡ä»¥ä¸‹æœºåˆ¶å®ç°ä»»åŠ¡é—´çš„ä¸¥æ ¼éš”ç¦»ä¸èµ„æºå…¬å¹³ï¼š</p>
<ul>
<li>
<p><strong>ä¼˜å…ˆçº§æŠ¢å å¼è°ƒåº¦</strong><br/>
è°ƒåº¦å¾ªç¯å§‹ç»ˆä¼˜å…ˆå¤„ç†æœ€é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­çš„å¾…æ‰§è¡Œå‘½ä»¤ã€‚åªæœ‰è¯¥é˜Ÿåˆ—ä¸ºç©ºæˆ–æ´»è·ƒä»»åŠ¡æ•°è¾¾åˆ°ä¸Šé™ï¼Œæ‰ä¼šå¤„ç†æ¬¡é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ã€‚è¿™ç§ä¸¥æ ¼ä¼˜å…ˆçº§ç­–ç•¥é¿å…äº†ä½ä¼˜å…ˆçº§é•¿ä»»åŠ¡é˜»å¡ç”¨æˆ·äº¤äº’ã€‚</p>
</li>
<li>
<p><strong>åˆ†çº§å¹¶å‘é™æµ</strong><br/>
ä¸åŒä¼˜å…ˆçº§é˜Ÿåˆ—æ‹¥æœ‰ç‹¬ç«‹çš„å¹¶å‘ä¸Šé™ï¼š</p>
<ul>
<li>ç³»ç»Ÿ/ç´§æ€¥é˜Ÿåˆ—ï¼šå¹¶å‘ 1â€“2ï¼ˆç‹¬å å¼æ‰§è¡Œï¼Œé¿å…ç«äº‰ï¼‰</li>
<li>ç”¨æˆ·ç›´æ¥æŒ‡ä»¤ï¼šå¹¶å‘ 2â€“4ï¼ˆä¿è¯äº¤äº’æµç•…ï¼‰</li>
<li>å·¥å…·è°ƒç”¨é˜Ÿåˆ—ï¼šå¹¶å‘ 4â€“10ï¼ˆè§†æœ¬åœ°èµ„æºåŠ¨æ€è°ƒæ•´ï¼‰</li>
<li>åå°é˜Ÿåˆ—ï¼šå¹¶å‘ 1â€“2ï¼ˆèµ„æºç©ºé—²æ—¶æ‰§è¡Œï¼‰</li>
</ul>
</li>
<li>
<p><strong>åŠ¨æ€ä¼˜å…ˆçº§æå‡ï¼ˆPriority Boostingï¼‰</strong><br/>
åœ¨è¿è¡Œæ—¶æ£€æµ‹åˆ°é«˜ç´§æ€¥è¯­ä¹‰ï¼ˆå…³é”®è¯åŒ¹é…ã€ç”¨æˆ·è¿ç»­è¿½é—®ã€å¼‚å¸¸åˆ†æ•°è¶…é˜ˆå€¼ç­‰ï¼‰æ—¶ï¼Œå¯å°†ä»»åŠ¡ä¸´æ—¶æå‡åˆ°æ›´é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ã€‚è¿™ç§æœºåˆ¶åœ¨ç”¨æˆ·ä½“éªŒä¸ç³»ç»Ÿç¨³å®šæ€§ä¹‹é—´å–å¾—äº†è‰¯å¥½å¹³è¡¡ã€‚</p>
</li>
<li>
<p><strong>è¶…æ—¶ä¸é‡è¯•åˆ†å±‚</strong><br/>
é«˜ä¼˜å…ˆçº§å‘½ä»¤é€šå¸¸è®¾ç½®è¾ƒçŸ­è¶…æ—¶ï¼ˆ5â€“30sï¼‰ï¼Œå¤±è´¥åå¿«é€Ÿé‡è¯•æˆ–è¿›å…¥äººå·¥å®¡æ ¸ï¼›ä½ä¼˜å…ˆçº§ä»»åŠ¡åˆ™å…è®¸æ›´é•¿è¶…æ—¶ä¸æ›´å¤šé‡è¯•æ¬¡æ•°ã€‚</p>
</li>
</ul>
<h2 data-id="heading-2">å¯é æ€§ä¸å¯è§‚æµ‹æ€§ä¿éšœ</h2>
<ul>
<li>
<p><strong>æ­»ä¿¡ä¸å¤±è´¥æ•è·</strong><br/>
å¤šæ¬¡é‡è¯•å¤±è´¥çš„å‘½ä»¤è¢«æ¨å…¥æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDead Letter Queueï¼‰ï¼Œä¿ç•™å®Œæ•´ä¸Šä¸‹æ–‡ï¼ˆè¾“å…¥ã€é”™è¯¯æ ˆã€æ‰§è¡Œç¯å¢ƒå¿«ç…§ï¼‰ï¼Œä¾¿äºå¼€å‘è€…ç¦»çº¿è¯Šæ–­ä¸è¡¥å¿ã€‚</p>
</li>
<li>
<p><strong>ä¼˜é›…å…³æœºä¸æ’æ°´</strong><br/>
æ”¯æŒ drain æ¨¡å¼ï¼šåœ¨æ”¶åˆ°åœæ­¢ä¿¡å·åï¼Œå…ˆå¤„ç†å®Œæ‰€æœ‰å·²æ¥å—çš„é«˜ä¼˜å…ˆçº§ä»»åŠ¡ï¼Œå†é€æ­¥å…³é—­ä½ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚</p>
</li>
<li>
<p><strong>æŒ‡æ ‡ä¸å‘Šè­¦</strong><br/>
å®æ—¶æš´éœ²é˜Ÿåˆ—æ·±åº¦ã€å‘½ä»¤å»¶è¿Ÿåˆ†å¸ƒï¼ˆp50/p90/p99ï¼‰ã€é‡è¯•ç‡ã€å¤±è´¥ç‡ç­‰æ ¸å¿ƒæŒ‡æ ‡ã€‚ç¤¾åŒºå¸¸è§åšæ³•æ˜¯é›†æˆ Prometheus + Grafanaï¼Œæˆ–ç®€å•é€šè¿‡æ—¥å¿— + webhook å®ç°é˜ˆå€¼å‘Šè­¦ã€‚</p>
</li>
</ul>
<h2 data-id="heading-3">ä¸è‡ªåŠ¨é©¾é©¶è°ƒåº¦éœ€æ±‚çš„å¯¹æ¯”</h2>
<p>è‡ªåŠ¨é©¾é©¶ç³»ç»Ÿçš„ä»»åŠ¡è°ƒåº¦éœ€æ±‚ä¸ OpenClaw æœ‰é«˜åº¦ç›¸ä¼¼æ€§ï¼Œä½†å¯¹ç¡®å®šæ€§ä¸å»¶è¿Ÿçš„è¦æ±‚æ›´æç«¯ï¼š</p>









































<table><thead><tr><th>ç»´åº¦</th><th>OpenClawï¼ˆagentic AIï¼‰</th><th>è‡ªåŠ¨é©¾é©¶ï¼ˆL4/L5 çº§åˆ«ï¼‰</th><th>å…±åŒè§£å†³æ–¹æ¡ˆè¶‹åŠ¿</th></tr></thead><tbody><tr><td>æœ€é«˜ä¼˜å…ˆçº§ä»»åŠ¡</td><td>ç”¨æˆ·ç´§æ€¥æŒ‡ä»¤ã€å®‰å…¨å¹²é¢„</td><td>AEBã€æ¥ç®¡è¯·æ±‚ã€æ•…éšœå®‰å…¨</td><td>ä¸¥æ ¼ä¼˜å…ˆçº§ + å¹¶å‘ 1â€“2</td></tr><tr><td>æ ¸å¿ƒæ§åˆ¶å¾ªç¯</td><td>å·¥å…·è°ƒç”¨ä¸»è·¯å¾„</td><td>æ„ŸçŸ¥â†’é¢„æµ‹â†’è§„åˆ’â†’æ§åˆ¶ 100â€“200Hz ä¸»å¾ªç¯</td><td>ä¸“ç”¨é«˜ä¼˜å…ˆçº§é€šé“ + ä½æŠ–åŠ¨è°ƒåº¦</td></tr><tr><td>åå°ä»»åŠ¡</td><td>æ—¥å¿—ã€ç´¢å¼•ã€æ¨¡å‹æ›´æ–°</td><td>åœ°å›¾å¢é‡ã€è¯Šæ–­ä¸Šä¼ ã€OTA</td><td>æä½ä¼˜å…ˆçº§ + èµ„æºç©ºé—²æ‰§è¡Œ</td></tr><tr><td>åŠ¨æ€ä¼˜å…ˆçº§è°ƒæ•´</td><td>è¯­ä¹‰æ€¥è¿«åº¦ã€è¿ç»­äº¤äº’</td><td>è¡Œäºº/çº¢ç¯ç´§æ€¥åœºæ™¯ã€æ¥ç®¡ä¿¡å·</td><td>è¿è¡Œæ—¶ boosting æœºåˆ¶</td></tr><tr><td>å®¹é”™ä¸æ¢å¤</td><td>æ­»ä¿¡é˜Ÿåˆ— + äººå·¥å¹²é¢„</td><td>å…³é”®ä»»åŠ¡æŒä¹…åŒ– + èŠ‚ç‚¹é‡å¯å¿«é€Ÿæ¢å¤</td><td>DLQ + æŒä¹…åŒ–å­˜å‚¨</td></tr></tbody></table>
<p>ä¸¤è€…éƒ½å¼ºçƒˆä¾èµ–â€œå¤šé˜Ÿåˆ— + ä¸¥æ ¼ä¼˜å…ˆçº§ + å¹¶å‘éš”ç¦»â€çš„èŒƒå¼ï¼Œä»¥é¿å…ä½ä¼˜å…ˆçº§ä»»åŠ¡å¯¹å…³é”®è·¯å¾„çš„å¹²æ‰°ã€‚</p>
<h2 data-id="heading-4">æ€»ç»“</h2>
<p>OpenClaw çš„è°ƒåº¦æ¶æ„é€šè¿‡å¤šçº§ä¼˜å…ˆçº§é˜Ÿåˆ—ã€åŠ¨æ€å¹¶å‘é™æµã€ä¼˜å…ˆçº§æå‡ä¸å®Œå¤‡çš„å¯é æ€§æœºåˆ¶ï¼ŒæˆåŠŸå®ç°äº†é«˜è‡ªä¸» AI ä»£ç†åœ¨å¤æ‚ã€å¤šæºã€é•¿æ—¶é—´è¿è¡Œåœºæ™¯ä¸‹çš„ç¡®å®šæ€§ä¸å¯æ§æ€§ã€‚å…¶è®¾è®¡æ€è·¯å¯¹ä»»ä½•éœ€è¦å¤„ç†æ··åˆä¼˜å…ˆçº§å¼‚æ­¥ä»»åŠ¡çš„ç³»ç»Ÿï¼ˆåŒ…æ‹¬ä½†ä¸é™äº agentic AIã€å®æ—¶å†³ç­–å¹³å°ã€å·¥ä¸šæ§åˆ¶ç­‰ï¼‰éƒ½å…·æœ‰æé«˜çš„å‚è€ƒä»·å€¼ã€‚</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç¤¾åŒºä¸­ä¹Ÿæœ‰ä¸€äº›ä¸“æ³¨äºç±»ä¼¼åœºæ™¯çš„ Rust å¼€æºé¡¹ç›®ï¼Œä¾‹å¦‚ A3S-Lab å®ç°çš„ Lane-based Command Queueï¼Œå®ƒé‡‡ç”¨çº¯ Rust å¼€å‘çš„å¤šè½¦é“ï¼ˆLaneï¼‰ä¼˜å…ˆçº§å‘½ä»¤é˜Ÿåˆ—æ¨¡å‹ï¼Œæä¾›ä¸¥æ ¼ä¼˜å…ˆçº§è°ƒåº¦ã€ç²¾ç»†å¹¶å‘æ§åˆ¶ä¸ä¼ä¸šçº§å¯è§‚æµ‹æ€§ï¼Œå·²åœ¨éƒ¨åˆ†é«˜ç¡®å®šæ€§å¼‚æ­¥ç³»ç»Ÿä¸­å¾—åˆ°éªŒè¯ä¸åº”ç”¨ã€‚æ„Ÿå…´è¶£çš„å¼€å‘è€…å¯è¿›ä¸€æ­¥å¯¹æ¯”ä¸åŒè¯­è¨€ä¸å®ç°èŒƒå¼ä¸‹çš„å·¥ç¨‹å–èˆã€‚</p>
<p>é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FA3S-Lab%2FLane" target="_blank" title="https://github.com/A3S-Lab/Lane" ref="nofollow noopener noreferrer">github.com/A3S-Lab/Lanâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¼ ç»ŸRestful APIå¿«é€Ÿé›†æˆAI Agentï¼š3ç§æ–¹æ¡ˆ+é€‰å‹æŒ‡å—]]></title>    <link>https://juejin.cn/post/7603160727716692019</link>    <guid>https://juejin.cn/post/7603160727716692019</guid>    <pubDate>2026-02-05T06:50:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603160727716692019" data-draft-id="7602935146706616366" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¼ ç»ŸRestful APIå¿«é€Ÿé›†æˆAI Agentï¼š3ç§æ–¹æ¡ˆ+é€‰å‹æŒ‡å—"/> <meta itemprop="keywords" content="Spring Boot,RESTful,Java"/> <meta itemprop="datePublished" content="2026-02-05T06:50:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜è¶Š"/> <meta itemprop="url" content="https://juejin.cn/user/1523239911963420"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¼ ç»ŸRestful APIå¿«é€Ÿé›†æˆAI Agentï¼š3ç§æ–¹æ¡ˆ+é€‰å‹æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1523239911963420/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜è¶Š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:50:33.000Z" title="Thu Feb 05 2026 06:50:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d9e87a3b95c4aa993b816be08a6bbdf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6LaK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879035&amp;x-signature=%2FTO%2FrX0wj22bwY109xC3E%2F8Yf3Q%3D" alt="" loading="lazy"/></p>
<p>éšç€AIæŠ€æœ¯çš„é£é€Ÿæ™®åŠï¼Œè¶Šæ¥è¶Šå¤šä¼ä¸šå¼€å§‹æ¥å…¥AI Agentï¼Œå¸Œæœ›å€ŸåŠ©è‡ªç„¶è¯­è¨€äº¤äº’çš„ä¾¿æ·æ€§ï¼Œç»™ç”¨æˆ·å¸¦æ¥æ›´æµç•…çš„ä½¿ç”¨ä½“éªŒã€‚ä½†å¾ˆå¤šä¼ä¸šéƒ½ä¼šé‡åˆ°ä¸€ä¸ªå…±æ€§éš¾é¢˜ï¼š<strong>åŸæœ¬è¿è¡Œç¨³å®šçš„ä¼ ç»ŸRestful APIï¼Œæ€ä¹ˆæ‰èƒ½å¿«é€Ÿè®©AI Agentè°ƒç”¨èµ·æ¥ï¼Ÿ</strong></p>
<p>æˆ‘ä»¬ä¸å¦¨å…ˆå›æƒ³ä¸€ä¸‹ä¼ ç»ŸRestful APIçš„ä½¿ç”¨åœºæ™¯ï¼šè¿‡å»ï¼Œè¿™äº›APIçš„è°ƒç”¨å…¨é æŒ‰é’®è§¦å‘ï¼Œæ¯”å¦‚ç”¨æˆ·è¦ä¸‹å•ï¼Œå°±å¾—æ‰‹åŠ¨ç‚¹å‡»â€œåˆ›å»ºè®¢å•â€æŒ‰é’®ï¼Œç³»ç»Ÿå†è°ƒç”¨å¯¹åº”çš„APIå®Œæˆæ“ä½œï¼›è€Œç°åœ¨æœ‰äº†AI Agentï¼Œç”¨æˆ·åªéœ€è¯´ä¸€å¥â€œå¸®æˆ‘ä¸‹å•ä¹°XXå•†å“â€ï¼Œå°±èƒ½å®ç°è‡ªç„¶äº¤äº’ï¼Œä½†å°´å°¬çš„æ˜¯â€”â€”AI Agentèƒ½å¬æ‡‚ç”¨æˆ·çš„éœ€æ±‚ï¼Œå´æ²¡æ³•ç›´æ¥è°ƒç”¨ä¼ ç»ŸAPIå»æ‰§è¡Œä¸‹å•ã€æ”¯ä»˜ã€æŸ¥è¯¢ç­‰å…·ä½“åŠŸèƒ½ï¼Œç›¸å½“äºâ€œæœ‰å˜´è¯´ï¼Œæ²¡æ‰‹åšâ€ï¼Œè¿™ä¹Ÿè®©AI Agentçš„ä»·å€¼å¤§æ‰“æŠ˜æ‰£ã€‚</p>
<p>ä»Šå¤©ï¼Œå°±ç»™å¤§å®¶åˆ†äº«3ç§å®ç”¨æ–¹æ¡ˆï¼Œå¸®ä½ å¿«é€Ÿæ‰“é€šä¼ ç»ŸRestful APIä¸AI Agentçš„è¡”æ¥ï¼Œå…¼é¡¾æ•ˆç‡ä¸å®ç”¨æ€§ï¼Œæ–°æ‰‹ä¹Ÿèƒ½è½»æ¾ç†è§£ï¼</p>
<h2 data-id="heading-0">ä¸€ã€3ç§æ ¸å¿ƒé›†æˆæ–¹æ¡ˆï¼ˆä¼˜ç¼ºç‚¹ä¸€ç›®äº†ç„¶ï¼‰</h2>
<p>ç»“åˆä¼ä¸šå®é™…å¼€å‘åœºæ™¯ï¼ˆä»å°é¡¹ç›®åˆ°å¤§å¾®æœåŠ¡æ¶æ„ï¼‰ï¼Œæˆ‘ä»¬æ•´ç†äº†3ç§æœ€å¸¸ç”¨çš„é›†æˆæ–¹æ¡ˆï¼Œæ¯ç§æ–¹æ¡ˆéƒ½æ˜ç¡®äº†é€‚ç”¨åœºæ™¯ã€ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Œå¯ä»¥æŒ‰éœ€é€‰æ‹©ï¼Œé¿å¼€è¸©å‘ï¼</p>
<h3 data-id="heading-1">æ–¹æ¡ˆ1ï¼šç›´æ¥ä½¿ç”¨AI Function Callè°ƒç”¨åç«¯API</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7bd80c5f7804a4dbdf29f94f5e06364~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6LaK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879035&amp;x-signature=1b9fJMDea40zcT%2F5s35M4JdtiuM%3D" alt="" loading="lazy"/></p>
<p>è¿™æ˜¯æœ€åŸºç¡€ã€æœ€å¿«æ·çš„é›†æˆæ–¹å¼ï¼Œæ ¸å¿ƒé€»è¾‘å°±æ˜¯ï¼šå°†ä¼ ç»ŸRestful APIçš„è°ƒç”¨é€»è¾‘ï¼Œå°è£…æˆAI Agentèƒ½è¯†åˆ«çš„<strong>Functionï¼ˆå‡½æ•°ï¼‰</strong>ï¼Œå½“ç”¨æˆ·è§¦å‘ç›¸å…³éœ€æ±‚æ—¶ï¼ŒAI Agentç›´æ¥è°ƒç”¨å¯¹åº”Functionï¼Œè¿›è€Œè§¦å‘åç«¯APIæ‰§è¡Œæ“ä½œï¼ˆæ¯”å¦‚æŸ¥è¯¢è®¢å•ã€å‘èµ·æ”¯ä»˜ï¼‰ã€‚</p>
<h4 data-id="heading-2">æ ¸å¿ƒä¼˜ç¼ºç‚¹</h4>
<ul>
<li>
<p><strong>ä¼˜ç‚¹</strong>ï¼šé›†æˆé—¨æ§›æä½ã€é€Ÿåº¦æœ€å¿«ï¼Œä¸éœ€è¦é¢å¤–å¼€å‘ä¸­é—´æœåŠ¡ï¼Œå‡ è¡Œä»£ç å°±èƒ½å®Œæˆå°è£…ã€‚å¦‚æœæ˜¯å°å‹é¡¹ç›®ï¼ˆæ¯”å¦‚åªæœ‰å‡ ä¸ªAPIã€æ²¡æœ‰å¤æ‚å¾®æœåŠ¡ï¼‰ï¼Œç”¨è¿™ç§æ–¹å¼æœ€çœå¿ƒï¼Œèƒ½å¿«é€Ÿå®ç°AI Agentä¸APIçš„è¡”æ¥ï¼Œä¸ç”¨æŠ•å…¥è¿‡å¤šäººåŠ›å’Œæ—¶é—´æˆæœ¬ã€‚</p>
</li>
<li>
<p><strong>ç¼ºç‚¹</strong>ï¼šæ‰©å±•æ€§æå·®ï¼Œåªé€‚åˆå°é¡¹ç›®ã€‚ä¸€æ—¦é¡¹ç›®è§„æ¨¡æ‰©å¤§ï¼Œé‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼ˆæ¯”å¦‚è®¢å•ã€ç”¨æˆ·ã€æ”¯ä»˜ç­‰æ¨¡å—åˆ†åˆ«ç”±ä¸åŒå›¢é˜Ÿå¼€å‘ï¼‰ï¼Œé—®é¢˜å°±ä¼šå‡¸æ˜¾â€”â€”è¦è®©AI Agentè°ƒç”¨æ‰€æœ‰æ¨¡å—çš„APIï¼Œå°±éœ€è¦æ‰€æœ‰å¾®æœåŠ¡å›¢é˜Ÿéƒ½å‚ä¸åˆ°AI Agentçš„å¼€å‘ä¸­ï¼ŒæŠŠå„è‡ªçš„APIå°è£…æˆFunctionï¼Œä¸ä»…æ²Ÿé€šæˆæœ¬æé«˜ï¼Œè¿˜ä¼šå¯¼è‡´AI Agentçš„ä»£ç è¶Šæ¥è¶Šè‡ƒè‚¿ï¼Œéš¾ä»¥ç»´æŠ¤ï¼Œå®Œå…¨ä¸ç¬¦åˆç°ä»£è½¯ä»¶â€œåˆ†å·¥åä½œã€ç‹¬ç«‹éƒ¨ç½²â€çš„å¼€å‘æ¨¡å¼ã€‚</p>
</li>
</ul>
<h3 data-id="heading-3">æ–¹æ¡ˆ2ï¼šåˆ›å»ºMCPæœåŠ¡ä½œä¸ºä¸­é—´å±‚è¡”æ¥</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad36659168f543ccb1fc8b51535c89b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6LaK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879035&amp;x-signature=49vHmQ0Gz9%2FPHx7%2FnSs2rg0Z%2Bp0%3D" alt="" loading="lazy"/></p>
<p>é’ˆå¯¹å¾®æœåŠ¡æ¶æ„çš„ç—›ç‚¹ï¼Œè¿™ç§æ–¹æ¡ˆåº”è¿è€Œç”Ÿâ€”â€”æ ¸å¿ƒé€»è¾‘æ˜¯ï¼šä¸ºæ¯ä¸ªå¾®æœåŠ¡ï¼ˆè®¢å•ã€ç”¨æˆ·ã€æ”¯ä»˜ç­‰ï¼‰ï¼Œå•ç‹¬åˆ›å»ºä¸€ä¸ª<strong>MCPæœåŠ¡ï¼ˆä¸­é—´é€šä¿¡æœåŠ¡ï¼‰</strong>ï¼ŒMCPæœåŠ¡ä¸“é—¨è´Ÿè´£æ¥æ”¶AI Agentçš„è°ƒç”¨è¯·æ±‚ï¼Œå†å°†è¯·æ±‚è½¬æ¢ä¸ºåç«¯Restful APIèƒ½è¯†åˆ«çš„æ ¼å¼ï¼ŒåŒæ—¶å¤„ç†APIçš„è¿”å›ç»“æœï¼Œå†åé¦ˆç»™AI Agentã€‚ç®€å•è¯´ï¼ŒMCPæœåŠ¡å°±æ˜¯AI Agentå’Œä¼ ç»ŸAPIä¹‹é—´çš„â€œç¿»è¯‘å®˜â€ï¼Œè®©ä¸¤è€…èƒ½é¡ºç•…æ²Ÿé€šã€‚</p>
<h4 data-id="heading-4">æ ¸å¿ƒä¼˜ç¼ºç‚¹</h4>
<ul>
<li>
<p><strong>ä¼˜ç‚¹</strong>ï¼šå®Œå…¨é€‚é…å¾®æœåŠ¡æ¶æ„ï¼Œåˆ†å·¥æ¸…æ™°ã€äº’ä¸å¹²æ‰°ã€‚æ¯ä¸ªå¾®æœåŠ¡å›¢é˜Ÿå¯ä»¥ç‹¬ç«‹å¼€å‘è‡ªå·±çš„MCPæœåŠ¡ï¼Œä¸ç”¨å‚ä¸AI Agentçš„å¼€å‘ï¼Œåªéœ€ä¿è¯è‡ªå·±çš„MCPæœåŠ¡èƒ½æ­£å¸¸è°ƒç”¨æœ¬å›¢é˜Ÿçš„APIå³å¯ï¼Œæ—¢èƒ½æå‡å¼€å‘æ•ˆç‡ï¼Œåˆèƒ½é™ä½æ²Ÿé€šæˆæœ¬ï¼Œåç»­å¾®æœåŠ¡å‡çº§ã€APIè¿­ä»£æ—¶ï¼Œä¹Ÿä¸ä¼šå½±å“åˆ°AI Agentï¼Œç»´æŠ¤èµ·æ¥æ›´è½»æ¾ï¼Œç¬¦åˆç°ä»£è½¯ä»¶çš„å¼€å‘æ¨¡å¼ã€‚</p>
</li>
<li>
<p><strong>ç¼ºç‚¹</strong>ï¼šéœ€è¦é¢å¤–æŠ•å…¥äººåŠ›å’Œèµ„æºæˆæœ¬ã€‚æ¯ä¸ªå¾®æœåŠ¡éƒ½è¦å¼€å‘å¯¹åº”çš„MCPæœåŠ¡ï¼Œè¿˜è¦åšæµ‹è¯•ã€éƒ¨ç½²ã€ç»´æŠ¤ï¼Œå¯¹äºèµ„æºç´§å¼ çš„ä¸­å°ä¼ä¸šæ¥è¯´ï¼Œä¼šå¢åŠ ä¸€å®šçš„è´Ÿæ‹…ï¼›å¦‚æœå¾®æœåŠ¡æ•°é‡è¾ƒå¤šï¼ŒMCPæœåŠ¡çš„ç®¡ç†ä¹Ÿä¼šå¸¦æ¥å°‘é‡é¢å¤–æˆæœ¬ã€‚</p>
</li>
</ul>
<h3 data-id="heading-5">æ–¹æ¡ˆ3ï¼šä½¿ç”¨Higress + Nacosï¼Œç›´æ¥å°†ä¼ ç»ŸAPIè½¬æ¢ä¸ºMCPæœåŠ¡</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1856e56966b4efa8396c5615179d8fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6LaK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879035&amp;x-signature=%2BSZyzXdyPQba92N3jW4cX8GnwEQ%3D" alt="" loading="lazy"/></p>
<p>è¿™æ˜¯å…¼é¡¾æ•ˆç‡å’Œæˆæœ¬çš„â€œæœ€ä¼˜è§£â€ä¹‹ä¸€ï¼Œæ ¸å¿ƒé€»è¾‘æ˜¯ï¼šå€ŸåŠ©**Higressï¼ˆç½‘å…³å·¥å…·ï¼‰<strong>å’Œ</strong>Nacosï¼ˆæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼‰**çš„åŸç”Ÿèƒ½åŠ›ï¼Œä¸ç”¨æ‰‹åŠ¨å¼€å‘MCPæœåŠ¡ï¼Œé€šè¿‡ç®€å•çš„é…ç½®æ“ä½œï¼Œå°±èƒ½ç›´æ¥å°†ä¼ ç»ŸRestful APIè½¬æ¢ä¸ºAI Agentèƒ½è¯†åˆ«çš„MCPæœåŠ¡ï¼Œç›¸å½“äºâ€œé›¶ä»£ç /å°‘ä»£ç â€å®Œæˆé›†æˆã€‚</p>
<p>ç®€å•è¯´ï¼Œå°±æ˜¯åˆ©ç”¨ç°æˆçš„å·¥å…·ï¼Œè‡ªåŠ¨å®Œæˆâ€œç¿»è¯‘å®˜â€ï¼ˆMCPæœåŠ¡ï¼‰çš„åˆ›å»ºï¼Œä¸ç”¨æ¯ä¸ªå›¢é˜Ÿå•ç‹¬å¼€å‘ï¼Œå¤§å¤§èŠ‚çœäººåŠ›æˆæœ¬ã€‚</p>
<h4 data-id="heading-6">æ ¸å¿ƒä¼˜ç¼ºç‚¹</h4>
<ul>
<li>
<p><strong>ä¼˜ç‚¹</strong>ï¼šæ•ˆç‡æœ€é«˜ã€æˆæœ¬æœ€ä½ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œä¸ç”¨ç¼–å†™ä¸€è¡Œä»£ç ï¼Œåªéœ€åœ¨Higresså’ŒNacosä¸Šåšä¸€äº›é…ç½®ï¼ˆæ¯”å¦‚æ³¨å†ŒAPIã€è®¾ç½®è½¬æ¢è§„åˆ™ï¼‰ï¼Œå°±èƒ½å®Œæˆä¼ ç»ŸAPIåˆ°MCPæœåŠ¡çš„è½¬æ¢ï¼Œé€‚é…AI Agentçš„è°ƒç”¨ï¼›åŒæ—¶ï¼Œä¸å½±å“åŸæœ‰å¾®æœåŠ¡çš„æ¶æ„ï¼Œåç»­APIè¿­ä»£æ—¶ï¼Œåªéœ€è°ƒæ•´é…ç½®å³å¯ï¼Œç»´æŠ¤æˆæœ¬æä½ã€‚</p>
</li>
<li>
<p><strong>ç¼ºç‚¹</strong>ï¼šå¯¹ç°æœ‰é¡¹ç›®æœ‰ä¸€å®šçš„ç¯å¢ƒè¦æ±‚ï¼Œæœ‰å°‘é‡æ”¹é€ æˆæœ¬ã€‚â‘  å¦‚æœé¡¹ç›®ä¸­æœ‰å¤§é‡APIï¼Œé…ç½®çš„ç»´æŠ¤ä¾ç„¶éœ€è¦æŠ•å…¥ä¸€å®šçš„äººåŠ›ï¼›â‘¡ è€é¡¹ç›®å¦‚æœæ²¡æœ‰ä½¿ç”¨Nacosï¼ˆæˆ–å…¶ä»–æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼‰ï¼Œå°±éœ€è¦é¢å¤–éƒ¨ç½²Nacoså¹¶æ”¹é€ é¡¹ç›®ï¼Œè®©APIæ”¯æŒæœåŠ¡æ³¨å†Œï¼›â‘¢ éœ€è¦ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„Higresså’ŒNacosï¼Œè€é¡¹ç›®çš„ç›¸å…³ç»„ä»¶ç‰ˆæœ¬è¿‡ä½æ—¶ï¼Œéœ€è¦å‡çº§ç»„ä»¶ï¼Œå¯èƒ½ä¼šå¸¦æ¥çŸ­æš‚çš„ä¸ç¨³å®šé£é™©ï¼ˆæ¯”å¦‚å…¼å®¹æ€§é—®é¢˜ï¼‰ã€‚</p>
</li>
</ul>
<h2 data-id="heading-7">äºŒã€æ–¹æ¡ˆé€‰å‹æŒ‡å—ï¼ˆæŒ‰éœ€é€‰æ‹©ï¼Œä¸è¸©å‘ï¼‰</h2>
<p>å¾ˆå¤šä¼ä¸šçº ç»“â€œé€‰å“ªç§æ–¹æ¡ˆâ€ï¼Œæ ¸å¿ƒè¿˜æ˜¯çœ‹<strong>é¡¹ç›®è§„æ¨¡ã€å¾®æœåŠ¡æ¶æ„ã€äººåŠ›èµ„æº</strong>è¿™3ä¸ªå…³é”®å› ç´ ï¼Œè¿™é‡Œç»™å¤§å®¶æ˜ç¡®çš„é€‰å‹å»ºè®®ï¼Œç›´æ¥å¯¹å·å…¥åº§å³å¯ï¼š</p>
<ol>
<li>
<p>å¦‚æœæ˜¯<strong>å°å‹é¡¹ç›®</strong>ï¼ˆæ— å¤æ‚å¾®æœåŠ¡ï¼ŒAPIæ•°é‡å°‘ï¼Œæ¯”å¦‚ä¸ªäººé¡¹ç›®ã€å°å‹å·¥å…·ç±»äº§å“ï¼‰ï¼šä¼˜å…ˆé€‰ã€æ–¹æ¡ˆ1ï¼šAI Function Callç›´æ¥è°ƒç”¨ã€‘ï¼Œå¿«é€Ÿè½åœ°ï¼ŒèŠ‚çœæˆæœ¬ï¼Œä¸ç”¨è¿‡åº¦è®¾è®¡æ¶æ„ã€‚</p>
</li>
<li>
<p>å¦‚æœæ˜¯<strong>ä¸­å¤§å‹é¡¹ç›®</strong>ï¼ˆé‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œå¤šä¸ªå›¢é˜Ÿåˆ†å·¥å¼€å‘ï¼ŒAPIæ•°é‡å¤šï¼Œéœ€è¦é•¿æœŸç»´æŠ¤ï¼‰ï¼šä¼˜å…ˆé€‰ã€æ–¹æ¡ˆ2ï¼šåˆ›å»ºMCPæœåŠ¡ã€‘ï¼Œè™½ç„¶å‰æœŸæœ‰å¼€å‘æˆæœ¬ï¼Œä½†é•¿æœŸæ¥çœ‹ï¼Œèƒ½ä¿è¯æ¶æ„çš„çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œé¿å…åç»­å‡ºç°â€œç‰µä¸€å‘è€ŒåŠ¨å…¨èº«â€çš„é—®é¢˜ã€‚</p>
</li>
<li>
<p>å¦‚æœæ˜¯<strong>ä¸­å¤§å‹é¡¹ç›®ï¼Œä¸”å¸Œæœ›èŠ‚çœäººåŠ›æˆæœ¬ã€å¿«é€Ÿè½åœ°</strong>ï¼ˆç°æœ‰é¡¹ç›®å·²ä½¿ç”¨Nacosï¼Œç»„ä»¶ç‰ˆæœ¬è¾ƒæ–°ï¼‰ï¼šä¼˜å…ˆé€‰ã€æ–¹æ¡ˆ3ï¼šHigress + Nacosè½¬æ¢ã€‘ï¼Œä¸ç”¨å¼€å‘MCPæœåŠ¡ï¼Œé€šè¿‡é…ç½®å°±èƒ½å®Œæˆé›†æˆï¼Œå…¼é¡¾æ•ˆç‡å’Œå®ç”¨æ€§ï¼›å¦‚æœé¡¹ç›®æœªä½¿ç”¨Nacosï¼Œå¯è¯„ä¼°æ”¹é€ æˆæœ¬ï¼Œè‹¥æ”¹é€ ç®€å•ï¼Œä¹Ÿå¯ä¼˜å…ˆé€‰æ‹©æ­¤æ–¹æ¡ˆã€‚</p>
</li>
</ol>
<blockquote>
<p>ğŸ”” è¡¥å……æé†’ï¼šå¦‚æœä¼ä¸šå‰æœŸä¸ç¡®å®šå“ªç§æ–¹æ¡ˆæ›´åˆé€‚ï¼Œå¯å…ˆé‡‡ç”¨æ–¹æ¡ˆ1å¿«é€ŸéªŒè¯åœºæ™¯ï¼ˆæ¯”å¦‚å…ˆè®©AI Agentè°ƒç”¨1-2ä¸ªæ ¸å¿ƒAPIï¼‰ï¼Œåç»­éšç€é¡¹ç›®è§„æ¨¡æ‰©å¤§ï¼Œå†é€æ­¥è¿ç§»åˆ°æ–¹æ¡ˆ2æˆ–æ–¹æ¡ˆ3ï¼Œé™ä½è¯•é”™æˆæœ¬ã€‚</p>
</blockquote>
<h2 data-id="heading-8">ä¸‰ã€æ€»ç»“ï¼šé«˜æ•ˆé›†æˆçš„æ ¸å¿ƒé€»è¾‘</h2>
<p>ä¼ ç»ŸRestful APIé›†æˆAI Agentï¼Œæ ¸å¿ƒä¸æ˜¯â€œé‡æ„APIâ€ï¼Œè€Œæ˜¯â€œæ‰“é€šè¡”æ¥é€šé“â€â€”â€”è®©AI Agentèƒ½é¡ºåˆ©è°ƒç”¨APIã€è·å–è¿”å›ç»“æœï¼ŒåŒæ—¶ä¸å½±å“åŸæœ‰ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
<p>æˆ‘ä»¬æ¢³ç†çš„3ç§æ–¹æ¡ˆï¼Œæœ¬è´¨ä¸Šæ˜¯â€œä»ç®€å•åˆ°å¤æ‚ã€ä»å¿«é€Ÿè½åœ°åˆ°é•¿æœŸé€‚é…â€çš„æ¢¯åº¦é€‰æ‹©ï¼šæ–¹æ¡ˆ1é€‚åˆå¿«é€ŸéªŒè¯ï¼Œæ–¹æ¡ˆ2é€‚åˆé•¿æœŸç»´æŠ¤ï¼Œæ–¹æ¡ˆ3é€‚åˆå…¼é¡¾æ•ˆç‡ä¸æˆæœ¬ã€‚</p>
<p>æœ€åæé†’å¤§å®¶ï¼šé›†æˆæ—¶ä¸ç”¨è¿½æ±‚â€œæœ€å…ˆè¿›â€ï¼Œè€Œæ˜¯è¦â€œæœ€é€‚é…â€â€”â€”ç»“åˆè‡ªå·±çš„é¡¹ç›®è§„æ¨¡ã€äººåŠ›æˆæœ¬ï¼Œé€‰æ‹©èƒ½å¿«é€Ÿè½åœ°ã€åç»­å¥½ç»´æŠ¤çš„æ–¹æ¡ˆï¼Œå°±æ˜¯æœ€ä¼˜è§£ã€‚åªè¦æ‰“é€šäº†ä¼ ç»ŸAPIä¸AI Agentçš„è¡”æ¥ï¼Œå°±èƒ½è®©AI AgentçœŸæ­£â€œè½åœ°å¯ç”¨â€ï¼Œæ—¢ä¿ç•™åŸæœ‰ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œåˆèƒ½å€ŸåŠ©AIçš„ä¼˜åŠ¿ï¼Œæå‡ç”¨æˆ·ä½“éªŒå’Œä¸šåŠ¡æ•ˆç‡ã€‚</p>
<h2 data-id="heading-9">å‚è€ƒèµ„æ–™</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fjava2ai.com%2Fintegration%2Fmcps%2Fnacos%2Fspring-ai-alibaba-mcp-nacos-introduce" target="_blank" title="https://java2ai.com/integration/mcps/nacos/spring-ai-alibaba-mcp-nacos-introduce" ref="nofollow noopener noreferrer">java2ai.com/integrationâ€¦</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fnacos.io%2Fdocs%2Flatest%2Fmanual%2Fuser%2Fai%2Fapi-to-mcp%2F%3Fspm%3D5238cd80.6a33be36.0.0.2f431e5d0fwVgN%26source%3Dblog" target="_blank" title="https://nacos.io/docs/latest/manual/user/ai/api-to-mcp/?spm=5238cd80.6a33be36.0.0.2f431e5d0fwVgN&amp;source=blog" ref="nofollow noopener noreferrer">nacos.io/docs/latestâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MybatisToolsâ€”â€” ç›´æ¥è¿è¡Œæµ‹è¯• sql]]></title>    <link>https://juejin.cn/post/7602936997175099444</link>    <guid>https://juejin.cn/post/7602936997175099444</guid>    <pubDate>2026-02-05T06:54:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602936997175099444" data-draft-id="7602916013877641231" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MybatisToolsâ€”â€” ç›´æ¥è¿è¡Œæµ‹è¯• sql"/> <meta itemprop="keywords" content="IntelliJ IDEA,MyBatis"/> <meta itemprop="datePublished" content="2026-02-05T06:54:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¢§ç‰ç¬™"/> <meta itemprop="url" content="https://juejin.cn/user/3263006244611949"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MybatisToolsâ€”â€” ç›´æ¥è¿è¡Œæµ‹è¯• sql
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3263006244611949/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¢§ç‰ç¬™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:54:20.000Z" title="Thu Feb 05 2026 06:54:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ¬¡æ›´æ–°ä¸»è¦æ˜¯é€‚é…æ–°ç‰ˆæœ¬ï¼ˆ2025.2+ï¼‰ï¼Œå¦å¤–å¸¦æ¥å‡ ä¸ªæ–°åŠŸèƒ½ã€‚</p>
<p>è¿˜ä¸çŸ¥é“è¿™ä¸ªæ’ä»¶å¹²ä»€ä¹ˆçš„å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« <code>[MybatisTools ä½¿ç”¨æ‰‹å†Œ](https://www.toutiao.com/article/7431384971811553846/?log_from=d4b7047673e2b8_1770197767606)</code>ã€‚æœ¬ç¯‡ä»…è®²æ›´æ–°çš„åŠŸèƒ½ï¼šè¿è¡Œå’Œæµ‹è¯• sqlã€‚</p>
<p>åœ¨ mapper çš„ xmlæˆ–è€…æ¥å£ç±»é‡Œé¼ æ ‡å³é”®ç‚¹å‡»å·¦ä¾§ icon
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f125308f523c4d21bbf67f4507f876ac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56Kn546J56yZ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879260&amp;x-signature=kvaDn1J96QzEgVn%2FUdrC%2FpRvC4E%3D" alt="image.png" loading="lazy"/>
åœ¨å¼¹å‡ºçš„çª—å£é‡Œè¾“å…¥å‚æ•°ï¼Œç‚¹å‡» transform å¯ä»¥æŸ¥çœ‹ sql æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæ²¡æœ‰é—®é¢˜åˆ™å¯ä»¥ç›´æ¥ç‚¹å‡» run è¿›è¡Œæ‰§è¡Œ
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/66778d11e6f8420db7f3b75a9951884a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56Kn546J56yZ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879260&amp;x-signature=3ekZICvBsbR4TIKNp2irOykqcbw%3D" alt="image.png" loading="lazy"/>
ç‚¹å‡» run æŒ‰é’®å¯ä»¥å¾—åˆ°ç»“æœ
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c55b86de72114325a14361d009bca797~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56Kn546J56yZ:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879260&amp;x-signature=0wStQQ8lMGvXNYwWe47Msq8g870%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ZSTDæ¥å£ä¸åŒçš„å‚æ•°ç»„åˆçš„æ•ˆæœ]]></title>    <link>https://juejin.cn/post/7602936997175115828</link>    <guid>https://juejin.cn/post/7602936997175115828</guid>    <pubDate>2026-02-05T06:55:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602936997175115828" data-draft-id="7602931486597513251" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ZSTDæ¥å£ä¸åŒçš„å‚æ•°ç»„åˆçš„æ•ˆæœ"/> <meta itemprop="keywords" content="C++"/> <meta itemprop="datePublished" content="2026-02-05T06:55:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€åªå…¬ç¾Š"/> <meta itemprop="url" content="https://juejin.cn/user/928423275930535"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ZSTDæ¥å£ä¸åŒçš„å‚æ•°ç»„åˆçš„æ•ˆæœ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/928423275930535/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€åªå…¬ç¾Š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:55:45.000Z" title="Thu Feb 05 2026 06:55:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Zstandard (ZSTD) è¿™ç§å‹ç¼©ç®—æ³•ä¹‹æ‰€ä»¥åœ¨å·¥ä¸šç•Œå¤§æ”¾å¼‚å½©ï¼Œæ ¸å¿ƒå°±åœ¨äºå®ƒçš„<strong>é«˜åº¦å¯å®šåˆ¶æ€§</strong>ã€‚å®ƒä¸ä»…ä»…æä¾› 1-22 çº§çš„å‹ç¼©ç­‰çº§ï¼Œè¿˜å…è®¸å¼€å‘è€…æ·±å…¥åº•å±‚ï¼Œåƒè°ƒéŸ³å¸ˆä¸€æ ·è°ƒæ•´å„é¡¹å‚æ•°ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ ZSTD æ¥å£å‚æ•°çš„æ·±åº¦è§£æã€ç»„åˆæ•ˆæœåŠä»£ç ç¤ºä¾‹ã€‚</p>
<hr/>
<h2 data-id="heading-0">1. æ ¸å¿ƒåŸºç¡€å‚æ•°ï¼šå‹ç¼©ç­‰çº§ (Compression Level)</h2>
<p>è¿™æ˜¯æœ€å¸¸ç”¨çš„å‚æ•°ï¼Œå†³å®šäº†å‹ç¼©é€Ÿåº¦ä¸å‹ç¼©ç‡ä¹‹é—´çš„å¹³è¡¡ã€‚</p>
<ul>
<li>
<p><strong>èŒƒå›´</strong>ï¼š1 åˆ° 22ã€‚</p>
<ul>
<li><strong>1-3</strong>ï¼šå¿«é€Ÿæ¨¡å¼ï¼Œé€‚ç”¨äºå¯¹å»¶è¿Ÿæå…¶æ•æ„Ÿçš„åœºæ™¯ï¼ˆå¦‚æ—¥å¿—å®æ—¶ä¼ è¾“ï¼‰ã€‚</li>
<li><strong>4-15</strong>ï¼šå¹³è¡¡æ¨¡å¼ï¼Œé€‚ç”¨äºé€šç”¨çš„æ–‡ä»¶å­˜å‚¨ã€‚</li>
<li><strong>16-22 (Ultra)</strong> ï¼šæè‡´æ¨¡å¼ï¼Œæ¶ˆè€—å¤§é‡ CPU å’Œå†…å­˜ï¼Œæ¢å–æœ€å°çš„ä½“ç§¯ï¼ˆé€‚ç”¨äºå†·å¤‡ä»½ã€å®‰è£…åŒ…ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>è´Ÿæ•°ç­‰çº§</strong>ï¼šZSTD æ”¯æŒ <code>--fast</code> æ¨¡å¼ï¼ˆå¦‚ -1 åˆ° -5ï¼‰ï¼Œæ¯”ç­‰çº§ 1 æ›´å¿«ï¼Œç‰ºç‰²æ›´å¤šå‹ç¼©ç‡ã€‚</p>
</li>
</ul>
<hr/>
<h2 data-id="heading-1">2. è¿›é˜¶å¾®è°ƒå‚æ•° (ZSTD_cParameter)</h2>
<p>å½“ä½ ä½¿ç”¨ <code>ZSTD_CCtx_setParameter()</code> æ¥å£æ—¶ï¼Œå¯ä»¥ç²¾ç»†æ§åˆ¶å‹ç¼©å¼•æ“çš„å†…éƒ¨è¡Œä¸ºã€‚</p>








































<table><thead><tr><th><strong>å‚æ•°å (C API)</strong></th><th><strong>åŠŸèƒ½æè¿°</strong></th><th><strong>æ•ˆæœè¯´æ˜</strong></th></tr></thead><tbody><tr><td><code>ZSTD_c_windowLog</code></td><td>æŸ¥æ‰¾çª—å£å¤§å° (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>x</mi></msup></mrow><annotation encoding="application/x-tex">2^x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"/><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span></span> å­—èŠ‚)</td><td><strong>æ ¸å¿ƒå‚æ•°</strong>ã€‚å€¼è¶Šå¤§ï¼Œèƒ½åŒ¹é…åˆ°çš„é‡å¤æ•°æ®è¶Šè¿œï¼Œå‹ç¼©ç‡è¶Šé«˜ï¼Œä½†è§£å‹/å‹ç¼©å†…å­˜å ç”¨ç¿»å€ã€‚</td></tr><tr><td><code>ZSTD_c_hashLog</code></td><td>å“ˆå¸Œè¡¨å¤§å°</td><td>å½±å“å“ˆå¸Œç¢°æ’ç‡ã€‚è°ƒå¤§å¯æå‡æœç´¢æ•ˆç‡ï¼Œé€‚åˆå¤§æ–‡ä»¶ã€‚</td></tr><tr><td><code>ZSTD_c_chainLog</code></td><td>æœç´¢é“¾é•¿åº¦</td><td>å†³å®šäº†åœ¨å“ˆå¸Œå†²çªæ—¶æœç´¢çš„æ·±åº¦ã€‚è¶Šå¤§è¶Šæ…¢ï¼Œä½†å‹ç¼©ç‡è¶Šé«˜ã€‚</td></tr><tr><td><code>ZSTD_c_searchLog</code></td><td>æœç´¢èŒƒå›´</td><td>é™åˆ¶æœç´¢æ¬¡æ•°ã€‚å€¼è¶Šå¤§ï¼Œæœç´¢è¶Šå½»åº•ã€‚</td></tr><tr><td><code>ZSTD_c_minMatch</code></td><td>æœ€å°åŒ¹é…é•¿åº¦</td><td>é€šå¸¸ä¸º 3-7ã€‚å€¼è¶Šå°ï¼Œèƒ½å‘ç°çš„ç»†å¾®é‡å¤è¶Šå¤šï¼ˆå‹ç¼©ç‡é«˜ï¼‰ï¼Œä½†å¤„ç†å˜æ…¢ã€‚</td></tr><tr><td><code>ZSTD_c_strategy</code></td><td>æœç´¢ç­–ç•¥</td><td>ä» <code>Fast</code> åˆ° <code>BTUltra2</code>ã€‚ç­–ç•¥è¶Šå¤æ‚ï¼Œå‹ç¼©è´¨é‡è¶Šé«˜ï¼Œè€—æ—¶å‘ˆæŒ‡æ•°å¢é•¿ã€‚</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">3. ç‰¹è‰²åŠŸèƒ½å‚æ•°</h2>
<h3 data-id="heading-3">A. å¤šçº¿ç¨‹å‚æ•° (<code>ZSTD_c_nbWorkers</code>)</h3>
<p>ZSTD åŸç”Ÿæ”¯æŒå¹¶è¡Œå‹ç¼©ã€‚</p>
<ul>
<li><strong>æ•ˆæœ</strong>ï¼šè®¾ç½®ä¸º <code>n</code> æ—¶ï¼Œä¼šå°†æ•°æ®åˆ†æˆå¤šä¸ªå—å¹¶è¡Œå¤„ç†ã€‚</li>
<li><strong>æ³¨æ„</strong>ï¼šå¤šçº¿ç¨‹ä¼šç•¥å¾®é™ä½å‹ç¼©ç‡ï¼ˆå› ä¸ºå—ä¹‹é—´å­˜åœ¨è¾¹ç•Œï¼‰ï¼Œä½†ä¼šæå¤§åœ°ç¼©çŸ­å‹ç¼©æ—¶é—´ã€‚</li>
</ul>
<h3 data-id="heading-4">B. è¿œç¨‹åŒ¹é… (Long Distance Matching - LDM)</h3>
<ul>
<li><strong>å‚æ•°</strong>ï¼š<code>ZSTD_c_enableLongDistanceMatching</code></li>
<li><strong>æ•ˆæœ</strong>ï¼šä¸“é—¨ç”¨äºå¤„ç†<strong>æå…¶åºå¤§ä¸”æœ‰è¿œè·ç¦»é‡å¤</strong>çš„æ•°æ®ï¼ˆå¦‚è™šæ‹Ÿæœºé•œåƒã€ç›¸ä¼¼åº¦é«˜çš„æµ·é‡æ—¥å¿—ï¼‰ã€‚å®ƒå¯ä»¥åœ¨å‡ ç™¾ MB ç”šè‡³ GB ä¹‹å¤–å¯»æ‰¾é‡å¤æ•°æ®ï¼Œè€Œä¸å— <code>windowLog</code> çš„å†…å­˜é™åˆ¶ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-5">4. å…¸å‹åœºæ™¯å‚æ•°ç»„åˆä¸æ•ˆæœ</h2>
<h3 data-id="heading-6">åœºæ™¯ä¸€ï¼šæé€Ÿæ—¥å¿—æµ (Low Latency)</h3>
<ul>
<li><strong>ç»„åˆ</strong>ï¼š<code>Level 1</code> + <code>nbWorkers=0</code> (å•çº¿ç¨‹å‡å°‘å¼€é”€) + <code>windowLog=10</code> (1KB çª—å£)</li>
<li><strong>æ•ˆæœ</strong>ï¼šæä½çš„ CPU å ç”¨ï¼Œäºšæ¯«ç§’çº§å»¶è¿Ÿï¼Œé€‚åˆååé‡å·¨å¤§çš„å®æ—¶æ•°æ®æµã€‚</li>
</ul>
<h3 data-id="heading-7">åœºæ™¯äºŒï¼šå¸¸è§„ Web é™æ€èµ„æºå‹ç¼©</h3>
<ul>
<li><strong>ç»„åˆ</strong>ï¼š<code>Level 3</code> (é»˜è®¤) + <code>nbWorkers=4</code></li>
<li><strong>æ•ˆæœ</strong>ï¼šåœ¨ä¸æ˜æ˜¾æ‹–æ…¢æ„å»ºé€Ÿåº¦çš„å‰æä¸‹ï¼Œè¾¾åˆ°ä¼˜äº Gzip çš„å‹ç¼©ç‡ã€‚</li>
</ul>
<h3 data-id="heading-8">åœºæ™¯ä¸‰ï¼šç¦»çº¿å¤§æ•°æ®å­˜æ¡£ (Maximum Compression)</h3>
<ul>
<li><strong>ç»„åˆ</strong>ï¼š<code>Level 22</code> + <code>windowLog=27</code> (128MB) + <code>enableLDM=1</code> + <code>strategy=BTUltra2</code></li>
<li><strong>æ•ˆæœ</strong>ï¼šå‹ç¼©æå…¶ç¼“æ…¢ï¼Œä½†æ–‡ä»¶ä½“ç§¯ä¼šè¾¾åˆ°æƒŠäººçš„å°ï¼Œé€‚åˆä¸€æ—¦å­˜å…¥åŸºæœ¬ä¸åŠ¨çš„æ•°æ®ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-9">5. ä»£ç ç¤ºä¾‹ (Python æ¥å£æ¼”ç¤º)</h2>
<p>è™½ç„¶ C æ˜¯åŸç”Ÿæ¥å£ï¼Œä½† Python çš„ <code>zstandard</code> åº“èƒ½æ›´ç›´è§‚åœ°å±•ç¤ºå‚æ•°ç»„åˆã€‚</p>
<p>Python</p>
<pre><code class="hljs language-ini" lang="ini">import zstandard as zstd

<span class="hljs-comment"># æ¨¡æ‹Ÿä¸€ä»½å…·æœ‰é‡å¤ç»“æ„çš„å¤§æ•°æ®</span>
<span class="hljs-attr">data</span> = b<span class="hljs-string">"Welcome to ZSTD exploration! "</span> * <span class="hljs-number">10000</span> 

<span class="hljs-comment"># 1. åˆ›å»ºä¸€ä¸ªé«˜æ€§èƒ½å‹ç¼©å™¨ï¼šå¤šçº¿ç¨‹ + ä½ç­‰çº§</span>
<span class="hljs-attr">params_fast</span> = zstd.ZstdCompressionParameters.from_level(<span class="hljs-number">1</span>, threads=<span class="hljs-number">4</span>)
<span class="hljs-attr">cctx_fast</span> = zstd.ZstdCompressor(compression_params=params_fast)
<span class="hljs-attr">compressed_fast</span> = cctx_fast.compress(data)

<span class="hljs-comment"># 2. åˆ›å»ºä¸€ä¸ªæè‡´å‹ç¼©å™¨ï¼šé«˜ç­‰çº§ + è¿œç¨‹åŒ¹é… (LDM)</span>
<span class="hljs-comment"># æ˜¾å¼è°ƒæ•´é«˜çº§å‚æ•°</span>
<span class="hljs-attr">params_ultra</span> = zstd.ZstdCompressionParameters(
    <span class="hljs-attr">compression_level</span>=<span class="hljs-number">22</span>,
    <span class="hljs-attr">enable_ldm</span>=<span class="hljs-literal">True</span>,           <span class="hljs-comment"># å¼€å¯é•¿è·ç¦»åŒ¹é…</span>
    <span class="hljs-attr">window_log</span>=<span class="hljs-number">22</span>,             <span class="hljs-comment"># 4MB çª—å£</span>
    <span class="hljs-attr">min_match</span>=<span class="hljs-number">3</span>,               <span class="hljs-comment"># å°½å¯èƒ½åŒ¹é…çŸ­é‡å¤é¡¹</span>
    <span class="hljs-attr">strategy</span>=zstd.STRATEGY_BTULTRA2 <span class="hljs-comment"># æœ€å¼ºæœç´¢ç­–ç•¥</span>
)
<span class="hljs-attr">cctx_ultra</span> = zstd.ZstdCompressor(compression_params=params_ultra)
<span class="hljs-attr">compressed_ultra</span> = cctx_ultra.compress(data)

print(f"åŸå§‹å¤§å°: {len(data) / 1024:.2f} KB")
print(f"å¿«é€Ÿæ¨¡å¼å¤§å°: {len(compressed_fast) / 1024:.2f} KB")
print(f"æè‡´æ¨¡å¼å¤§å°: {len(compressed_ultra) / 1024:.2f} KB")
</code></pre>
<hr/>
<h2 data-id="heading-10">6. ä½¿ç”¨å»ºè®®ä¸é¿å‘æŒ‡å—</h2>
<ol>
<li><strong>å†…å­˜å ç”¨è®¡ç®—</strong>ï¼šå‹ç¼©æ—¶å†…å­˜å¼€é”€çº¦ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>Ã—</mo><msup><mn>2</mn><mrow><mi>w</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>o</mi><mi>w</mi><mi>L</mi><mi>o</mi><mi>g</mi></mrow></msup></mrow><annotation encoding="application/x-tex">3 \times 2^{windowLog}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.8491em;"/><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mord mathnormal mtight">L</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span></span></span></span></span></span></span></span></span></span>ã€‚å¦‚æœå°† <code>windowLog</code> è®¾ä¸º 31ï¼ˆ2GBï¼‰ï¼Œå•ä¸ªå‹ç¼©ä»»åŠ¡å¯èƒ½åƒæ‰ 6GB å†…å­˜ã€‚<strong>åŠ¡å¿…æ ¹æ®æœåŠ¡å™¨è§„æ ¼é™åˆ¶ <code>windowLog</code></strong>ã€‚</li>
<li><strong>è§£å‹å†…å­˜å›ºå®š</strong>ï¼šZSTD æœ€å¤§çš„ä¼˜åŠ¿ä¹‹ä¸€æ˜¯<strong>è§£å‹å†…å­˜æ’å®š</strong>ã€‚è§£å‹æ—¶éœ€è¦çš„å†…å­˜ä»…ç­‰äºå‹ç¼©æ—¶è®¾ç½®çš„ <code>windowLog</code>ã€‚å› æ­¤ï¼Œå³ä½¿å‹ç¼©æ—¶ç”¨äº† Level 22ï¼Œåªè¦çª—å£è®¾å¾—åˆç†ï¼Œæ‰‹æœºç«¯ä¹Ÿèƒ½è½»æ¾è§£å‹ã€‚</li>
<li><strong>å­—å…¸å‹ç¼© (Dictionary Compression)</strong> ï¼šå¦‚æœä½ åœ¨å¤„ç†å¤§é‡<strong>å°æ•°æ®</strong>ï¼ˆå¦‚ JSON API å“åº”ï¼Œæ¯ä¸ªä»… 1KBï¼‰ï¼Œå‚æ•°è°ƒæ•´çš„æ•ˆæœä¸å¦‚<strong>è®­ç»ƒä¸€ä¸ªå­—å…¸</strong>æ•ˆæœå¥½ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[uni-appä½¿ç”¨éuni_modulesçš„uchartsç»„ä»¶ï¼Œæœ¬åœ°è¿è¡Œæ²¡é—®é¢˜ï¼Œéƒ¨ç½²åˆ°çº¿ä¸Šå‡ºé—®é¢˜ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7602996277663957046</link>    <guid>https://juejin.cn/post/7602996277663957046</guid>    <pubDate>2026-02-05T06:47:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602996277663957046" data-draft-id="7602921143490314283" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="uni-appä½¿ç”¨éuni_modulesçš„uchartsç»„ä»¶ï¼Œæœ¬åœ°è¿è¡Œæ²¡é—®é¢˜ï¼Œéƒ¨ç½²åˆ°çº¿ä¸Šå‡ºé—®é¢˜ï¼Ÿ"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2026-02-05T06:47:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¾™luckGå‰ç«¯"/> <meta itemprop="url" content="https://juejin.cn/user/1464996737332168"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            uni-appä½¿ç”¨éuni_modulesçš„uchartsç»„ä»¶ï¼Œæœ¬åœ°è¿è¡Œæ²¡é—®é¢˜ï¼Œéƒ¨ç½²åˆ°çº¿ä¸Šå‡ºé—®é¢˜ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1464996737332168/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¾™luckGå‰ç«¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:47:06.000Z" title="Thu Feb 05 2026 06:47:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>é—®é¢˜èƒŒæ™¯</strong>ï¼šä½¿ç”¨éuni_modulesçš„uchartsç»„ä»¶ï¼Œæœ¬åœ°è¿è¡Œæ²¡ç”¨é—®é¢˜ï¼Œå‘å¸ƒä¸ºh5åæœªè§æŠ¥é”™ï¼Œä½†uchartså´å§‹ç»ˆå‡ºä¸æ¥ã€‚</p>
<p><strong>æ­¥éª¤å¤ç°</strong>ï¼š</p>
<ol>
<li>
<p>æ‰‹ä¸Šæœ‰ä¸ªéœ€æ±‚ï¼Œéœ€è¦ä½¿ç”¨uni-appå¼€å‘å¾®ä¿¡å°ç¨‹åºï¼Œåˆå§‹æ—¶ä½¿ç”¨h5ä½œä¸ºæ¼”ç¤ºç³»ç»Ÿï¼Œéœ€æ±‚é‡Œé¢å­˜åœ¨å›¾è¡¨å±•ç¤ºåŠŸèƒ½ã€‚è¿™æ—¶ï¼Œç½‘ä¸Šå»æ‰¾å¯¹åº”é€‚åˆçš„chartsç»„ä»¶ï¼Œå‘ç°uchartså¯ä»¥ç”¨äºç§»åŠ¨ç«¯å›¾è¡¨å±•ç¤ºã€‚</p>
</li>
<li>
<p>å¼•å…¥å®˜æ–¹éuni_modulesç»„ä»¶ï¼ˆå®˜æ–¹æœ‰è¯´æ˜æ–‡æ¡£ï¼‰ï¼Œè¿›è¡Œå¼€å‘ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d77bee669cd647f68289179135a52e49~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6b6ZbHVja0fliY3nq68=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770878826&amp;x-signature=2L3o6tk6MLUDntQSaXnXbN%2FbP1A%3D" alt="image.png" loading="lazy"/></p>
</li>
<li>
<p>æŒ‰ç…§æ­¥éª¤å¼•å…¥qiun-data-charts.vueç»„ä»¶åï¼Œæœ¬åœ°è¿è¡Œå¯ä»¥æ­£å¸¸å‡ºæ¥ï¼Œä¹Ÿæ²¡è§æŠ¥é”™ï¼Œè¿™æ—¶buildä¸ºh5åå‘å¸ƒåˆ°æœåŠ¡å™¨ï¼Œç¥å¥‡çš„ä¸€å¹•å‡ºç°äº†ï¼Œchartsç«Ÿç„¶å‡ºä¸æ¥ï¼ï¼ï¼èµ¶ç´§æŸåº¦ï¼Œç”šè‡³ä¸Šäº†AIï¼Œä½†éƒ½æ²¡è§£å†³é—®é¢˜ï¼Œåé¢æˆ‘å°±ç¢ç£¨æ˜¯å¦é…ç½®æœ‰é—®é¢˜ï¼Œæ¯”å¦‚optsæˆ–è€…eoptså‡ºé—®é¢˜äº†ï¼Œä½†å¯¹æ¯”äº†ä¸€ä¸‹å®˜æ–¹apiå‡æœªå‘ç°é—®é¢˜ï¼Œåªèƒ½å»ç¿»uchartsæºç ã€‚</p>
</li>
<li>
<p>çœ‹äº†ä¸€ä¸‹æºç åå‘ç°æœ‰ä¸€æ®µä»£ç ç”¨åˆ°äº†<strong>è·¯å¾„</strong>ï¼Œå°±æ€€ç–‘æ˜¯ä¸æ˜¯è·¯å¾„è§£æå‡ºäº†é—®é¢˜ï¼ŒåŠ äº†ä¸ªæ‰“å°å†æ¬¡éƒ¨ç½²æŸ¥çœ‹ï¼Œå‘ç°æœçœŸå¤šäº†ä¸ª./ ç„¶åå»æ‰¾äº†ä¸€ä¸‹ä¸ºä»€ä¹ˆä¼šå¤šå‡ºè¿™ä¸ªä¸œè¥¿ï¼ŒåŸå› æ˜¯æ‰“åŒ…çš„æ—¶å€™é…ç½®äº†æŒ‡å®šèµ„æºæ‰“åŒ…è·¯å¾„ï¼Œ<strong>é‡æ–°ä¿®æ”¹uchartsèµ„æºè·¯å¾„</strong>ä¹‹åå°±å¯ä»¥æ­£å¸¸å‡ºæ¥äº†ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ddcf8b67564485d940e96585d91ef90~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6b6ZbHVja0fliY3nq68=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770878826&amp;x-signature=uBbQwb6%2FXiv5qELNtvFZMNRR2DE%3D" alt="image.png" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1bf91a7f614a402badfd46e464e03d44~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6b6ZbHVja0fliY3nq68=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770878826&amp;x-signature=LEkPOe%2F7c21WSomnjVCbaeow%2FFI%3D" alt="image.png" loading="lazy"/>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7e45b836ca045a6bb4d1658fa96ebc1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6b6ZbHVja0fliY3nq68=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770878826&amp;x-signature=flu6ovR5FcCfgdE4tq0SRLD9C3A%3D" alt="image.png" loading="lazy"/></p>
</li>
</ol>
<h4 data-id="heading-0">ä»¥ä¸Šå†…å®¹ä»…ä¾›å‚è€ƒ</h4></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Kotlin 2.3 å‘Šåˆ«å†—ä½™ï¼šæ·±åº¦è§£æâ€œexplicit backing fieldsâ€]]></title>    <link>https://juejin.cn/post/7602916406981689385</link>    <guid>https://juejin.cn/post/7602916406981689385</guid>    <pubDate>2026-02-05T06:48:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602916406981689385" data-draft-id="7602996277663842358" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kotlin 2.3 å‘Šåˆ«å†—ä½™ï¼šæ·±åº¦è§£æâ€œexplicit backing fieldsâ€"/> <meta itemprop="keywords" content="Kotlin,Android"/> <meta itemprop="datePublished" content="2026-02-05T06:48:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Ehtan_Zheng"/> <meta itemprop="url" content="https://juejin.cn/user/413072099642478"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kotlin 2.3 å‘Šåˆ«å†—ä½™ï¼šæ·±åº¦è§£æâ€œexplicit backing fieldsâ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/413072099642478/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Ehtan_Zheng
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:48:32.000Z" title="Thu Feb 05 2026 06:48:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Kotlin 2.3 å¼•å…¥äº†<strong>explicit backing fields</strong>ï¼Œå…è®¸ä½ ç”¨å•ä¸ªå±æ€§æ›¿æ¢ç»å…¸çš„ <code>_state</code> + <code>state</code> æ¨¡æ¿ä»£ç ï¼Œä½ çš„ ViewModel å°†å˜å¾—å‰æ‰€æœªæœ‰çš„æ¸…çˆ½ã€‚</p>
<hr/>
<h2 data-id="heading-0">ç°çŠ¶ï¼šè¢«â€œä¸‹åˆ’çº¿â€ç»Ÿæ²»çš„æ¨¡æ¿ä»£ç </h2>
<p>å¤šå¹´æ¥ï¼Œä¸ºäº†ç¡®ä¿å°è£…æ€§ï¼ŒAndroid å¼€å‘è€…ä¸€ç›´éµå¾ªç€ä¸€ç§â€œæ ‡å‡†ä»ªå¼â€ï¼šåˆ›å»ºä¸€ä¸ªç§æœ‰çš„ <code>MutableStateFlow</code> ç”¨äºå†…éƒ¨ä¿®æ”¹ï¼Œå†æš´éœ²ä¸€ä¸ªå…¬æœ‰çš„ <code>StateFlow</code> ä¾›å¤–éƒ¨è¯»å–ã€‚</p>
<h3 data-id="heading-1">â€œæ—§â€æ–¹æ¡ˆï¼ˆç¹ççš„æ ·æ¿ä»£ç ï¼‰</h3>
<p>Kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å†…éƒ¨ä½¿ç”¨çš„å¯å˜çŠ¶æ€</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _uiState = MutableStateFlow(UiState.Loading)

<span class="hljs-comment">// æš´éœ²ç»™å¤–éƒ¨çš„åªè¯»è§†å›¾</span>
<span class="hljs-keyword">val</span> uiState: StateFlow&lt;UiState&gt; = _uiState.asStateFlow()
</code></pre>
<p>è™½ç„¶è¿™ç§åšæ³•è¡Œä¹‹æœ‰æ•ˆï¼Œä½†å®ƒä¸ä»…è®© IDE çš„è‡ªåŠ¨è¡¥å…¨å……æ»¡äº†å„ç§å¸¦ä¸‹åˆ’çº¿çš„å˜é‡ï¼Œè¿˜ä¸ºæ¯ä¸€ä¸ª ViewModel å¢åŠ äº†å¤§é‡çš„å˜é‡å®šä¹‰ã€‚</p>
<hr/>
<h2 data-id="heading-2">æ˜¾å¼å¹•åå­—æ®µï¼ˆExplicit Backing Fieldsï¼‰</h2>
<p>åœ¨ <strong>Kotlin 2.3</strong> ä¸­ï¼Œä½ ç°åœ¨å¯ä»¥åœ¨å•ä¸ªå±æ€§å†…éƒ¨å®šä¹‰ä¸€ä¸ª <code>field</code> å—ã€‚è¿™è®©ä½ å¯ä»¥ä¸ºå±æ€§å®šä¹‰<strong>ç‰¹å®šçš„å†…éƒ¨å­˜å‚¨ç±»å‹</strong>ï¼ŒåŒæ—¶å¯¹å¤–ç•Œä»…æš´éœ²<strong>åªè¯»çš„ API</strong>ã€‚</p>
<h3 data-id="heading-3">â€œæ–°â€æ–¹æ¡ˆï¼ˆä¼˜é›…çš„å•å±æ€§ï¼‰</h3>
<p>Kotlin</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">UserProfileViewModel</span> : <span class="hljs-type">ViewModel</span>() {

    <span class="hljs-comment">// åŒä¸€ä¸ªå±æ€§åï¼Œä¸¤ç§ä¸åŒçš„ç±»å‹</span>
    <span class="hljs-keyword">val</span> uiState: StateFlow&lt;ProfileState&gt;
        field = MutableStateFlow(ProfileState.Loading) 

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateUsername</span><span class="hljs-params">(newName: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-comment">// åœ¨ç±»å†…éƒ¨ï¼Œ'field' è®©æˆ‘ä»¬ç›´æ¥æ‹¥æœ‰å¯å˜çš„è®¿é—®æƒé™</span>
        field.value = ProfileState.Success(username = newName)
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-4">âš ï¸ å·¥ç¨‹å®è·µä¸­çš„ç°å®é—®é¢˜</h2>
<p>åœ¨ä½ æ‰“ç®—åˆ æ‰é¡¹ç›®ä¸­æ‰€æœ‰çš„ä¸‹åˆ’çº¿å˜é‡ä¹‹å‰ï¼Œæœ‰å‡ ä¸ªå…³é”®çš„å·¥ç¨‹ç»†èŠ‚éœ€è¦ä½ çŸ¥æ™“ï¼š</p>
<ul>
<li><strong>åªè¯» vs ä¸å¯å˜ï¼š</strong> <code>StateFlow</code> æˆ– <code>List</code> åªæ˜¯<strong>åªè¯»è§†å›¾</strong>ï¼Œè€Œéç»å¯¹ä¸å¯å˜ã€‚è™½ç„¶å¤–éƒ¨ API æ²¡æœ‰æä¾›ä¿®æ”¹å·¥å…·ï¼Œä½†åº•å±‚çš„<strong>explicit backing fields</strong>ä¾ç„¶æ˜¯å¯å˜çš„ã€‚</li>
<li><strong>ä»…é™ç®€å•åˆå§‹åŒ–ï¼š</strong> <strong>explicit backing fields</strong>æœ€é€‚åˆç®€å•çš„èµ‹å€¼ã€‚å¦‚æœä½ çš„çŠ¶æ€éœ€è¦å¤æ‚çš„é“¾å¼æ“ä½œï¼ˆå¦‚ <code>.stateIn()</code>ï¼‰æˆ–è€…åŸºäºæ„é€ å‚æ•°çš„å¤æ‚æ¡ä»¶é€»è¾‘ï¼Œä¼ ç»Ÿçš„åŒå±æ€§æ–¹æ¡ˆä¾ç„¶æ›´å…·çµæ´»æ€§ã€‚</li>
<li><strong>ä¸¥æ ¼çš„å®éªŒæ€§é˜¶æ®µï¼š</strong> è¯¥ç‰¹æ€§ç›®å‰éšè—åœ¨ <code>-Xexplicit-backing-fields</code> ç¼–è¯‘å™¨å‚æ•°ä¹‹åã€‚åœ¨å½“å‰ç‰ˆæœ¬çš„ Android Studio ä¸­ï¼Œè¯­æ³•é«˜äº®å’Œé‡æ„æ”¯æŒå¯èƒ½è¿˜ä¸å¤Ÿç¨³å®šã€‚</li>
<li><strong>è¿è¡Œæ—¶å®‰å…¨ç¼ºå£ï¼š</strong> ä¼ ç»Ÿçš„ <code>_state.asStateFlow()</code> æ¨¡å¼ä¼šåˆ›å»ºä¸€ä¸ªåŒ…è£…å±‚ï¼Œé˜²æ­¢å¤–éƒ¨åœ¨è¿è¡Œæ—¶å°†å…¶å¼ºè½¬å› <code>MutableStateFlow</code>ã€‚<strong>explicit backing fields</strong>ç›®å‰åœ¨åº•å±‚å¹¶ä¸å¤©ç”Ÿå…·å¤‡è¿™ç§â€œé˜²å¼ºè½¬â€æœºåˆ¶ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-5">æ€»ç»“</h2>
<p><strong>explicit backing fields</strong>è®©ä»£ç æ›´åŠ å¹²å‡€ã€ç´§å‡‘ã€‚è™½ç„¶ç›®å‰å®ƒè¿˜å¤„äºå®éªŒé˜¶æ®µï¼Œä½†å®ƒä»£è¡¨äº† Kotlin æ¶ˆé™¤æ ·æ¿ä»£ç ã€æå‡å¼€å‘è€…å¹¸ç¦æ„Ÿçš„æ˜ç¡®æ–¹å‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[iOSâ€”â€”IPAToolå·¥å…·çš„ä½¿ç”¨]]></title>    <link>https://juejin.cn/post/7602894102993338378</link>    <guid>https://juejin.cn/post/7602894102993338378</guid>    <pubDate>2026-02-05T06:52:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602894102993338378" data-draft-id="7603160727716642867" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="iOSâ€”â€”IPAToolå·¥å…·çš„ä½¿ç”¨"/> <meta itemprop="keywords" content="iOS"/> <meta itemprop="datePublished" content="2026-02-05T06:52:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Haha_bj"/> <meta itemprop="url" content="https://juejin.cn/user/2612027844214647"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            iOSâ€”â€”IPAToolå·¥å…·çš„ä½¿ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2612027844214647/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Haha_bj
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:52:02.000Z" title="Thu Feb 05 2026 06:52:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>IPATool æ˜¯ä¸€æ¬¾å‘½ä»¤è¡Œå·¥å…·ï¼Œå¯é€šè¿‡ Apple ID ä» App Store ä¸‹è½½åŠ å¯† IPA åŒ…ï¼Œæ”¯æŒå¤šå¹³å°ï¼ˆmacOS/Windows/Linuxï¼‰ï¼Œé€‚ç”¨äºå¼€å‘è€…æµ‹è¯•ã€ç‰ˆæœ¬å½’æ¡£ç­‰åœºæ™¯ã€‚</p>
<h3 data-id="heading-0">ä¸€ã€å®‰è£…ï¼ˆåˆ†å¹³å°ï¼‰</h3>
<h4 data-id="heading-1">1. macOSï¼ˆæ¨è Homebrewï¼‰</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># å®‰è£… ipatool</span>
brew install ipatool
<span class="hljs-meta"># éªŒè¯</span>
ipatool --version
<span class="hljs-comment">// ç»“æœ ipatool version 2.1.6</span>
</code></pre>
<ol>
<li>éªŒè¯ï¼šç»ˆç«¯è¾“å…¥ <code>ipatool --version</code> æ˜¾ç¤ºç‰ˆæœ¬å·å³å¯ã€‚</li>
</ol>
<h3 data-id="heading-2">äºŒã€æ ¸å¿ƒæµç¨‹ï¼šè®¤è¯ â†’ æœç´¢ â†’ ä¸‹è½½</h3>
<h4 data-id="heading-3">1. è´¦å·è®¤è¯ï¼ˆå¿…éœ€ï¼‰</h4>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç™»å½• Apple IDï¼ˆå¼€å¯åŒé‡éªŒè¯éœ€è¾“å…¥éªŒè¯ç ï¼‰</span>
ipatool auth login -e ä½ çš„é‚®ç®± -p ä½ çš„å¯†ç 
<span class="hljs-comment"># æŸ¥çœ‹ç™»å½•ä¿¡æ¯</span>
ipatool auth info
<span class="hljs-comment"># ç™»å‡º/æ’¤é”€å‡­è¯</span>
ipatool auth revoke
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼šåŒé‡éªŒè¯ç¯å¢ƒä¸‹ï¼Œå¯†ç éœ€ç”¨ã€ŒApp ä¸“ç”¨å¯†ç ã€ï¼ˆApple ID ç®¡ç†é¡µç”Ÿæˆï¼‰ï¼Œé¿å…ç™»å½•å¤±è´¥ã€‚</p>
<h4 data-id="heading-4">2. æœç´¢åº”ç”¨ï¼ˆè·å– Bundle ID/App IDï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æœç´¢å…³é”®è¯ï¼Œé™åˆ¶è¿”å› 5 æ¡ç»“æœ</span>
ipatool search <span class="hljs-string">"å¾®ä¿¡"</span> --<span class="hljs-built_in">limit</span> 5
<span class="hljs-comment"># è¾“å‡ºç¤ºä¾‹ï¼ˆå« Bundle IDï¼šcom.tencent.xinï¼‰</span>
</code></pre>
<h4 data-id="heading-5">3. IPAæ–‡ä»¶ä¸‹è½½</h4>
<p>æ‰¾åˆ°ç›®æ ‡åº”ç”¨åï¼Œä½¿ç”¨åº”ç”¨IDè¿›è¡Œä¸‹è½½ï¼š</p>
<pre><code class="hljs language-css" lang="css">ipatool download <span class="hljs-attr">--app-id</span> åº”ç”¨ID <span class="hljs-attr">--output</span> ä¿å­˜è·¯å¾„
//ä¾‹ ipatool download <span class="hljs-attr">--app-id</span> <span class="hljs-number">155342910943</span> <span class="hljs-attr">--output</span> ä¿å­˜è·¯å¾„
</code></pre>
<p>å¤‡æ³¨:
ä¸‹è½½æç¤ºã€Œæœªè´­ä¹°ã€æœªåŠ  <code>--purchase</code> å‚æ•°é¦–æ¬¡ä¸‹è½½æ·»åŠ  <code>--purchase</code> è·å–è®¸å¯</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é›†æˆ spring-ai 2.x å®è·µä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7602894102993207306</link>    <guid>https://juejin.cn/post/7602894102993207306</guid>    <pubDate>2026-02-05T06:30:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602894102993207306" data-draft-id="7602893600251985966" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é›†æˆ spring-ai 2.x å®è·µä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="Java,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-02-05T06:30:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="kfyty725"/> <meta itemprop="url" content="https://juejin.cn/user/2685462482255984"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é›†æˆ spring-ai 2.x å®è·µä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2685462482255984/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    kfyty725
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:30:20.000Z" title="Thu Feb 05 2026 06:30:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€æ¥å…¥ spring-ai</h2>
<h3 data-id="heading-1">ç‰ˆæœ¬é€‰æ‹©</h3>
<p>æœ¬æ¥é€‰æ‹©çš„ 1.1.2 ç‰ˆæœ¬ï¼Œå®ŒæˆåŸºç¡€é›†æˆåï¼ŒæŸ¥çœ‹ github ä»“åº“ï¼Œå‘ç°åç»­ä»…åŸºäº 2.x å¼€å‘ï¼Œè€Œ 2.x åŸºäº springboot4.x + jdk 21ï¼Œäºæ˜¯ç›´æ¥å‡çº§åˆ°äº† 2.0.0-M1ï¼Œæ ¸å¿ƒ maven ä¾èµ–å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-starter-mcp-server<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.0-M1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-starter-mcp-server-webmvc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.0-M1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-starter-mcp-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.0-M1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-2">äºŒã€é‡åˆ°çš„ä¸€äº›é›†æˆé—®é¢˜</h3>
<h4 data-id="heading-3">1ã€ä¿å­˜èŠå¤©è®°å¿†æ—¶å¦‚ä½•è·å–è¯·æ±‚ä¸Šä¸‹æ–‡ï¼Ÿ</h4>
<p>å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.openapiChatClient.prompt()
        .user(input)
        .advisors(a -&gt; a.param(<span class="hljs-string">"key1"</span>, <span class="hljs-string">"value1"</span>))
        .stream()
        .content();
</code></pre>
<p>é‚£ä¹ˆè¿™æ®µä»£ç åœ¨ ChatMemoryRepository#saveAll æ–¹æ³•æ‰§è¡Œæ—¶ï¼Œæ˜¯æ— æ³•è·å–åˆ°è®¾ç½®çš„ key1=value1 çš„ä¸Šä¸‹æ–‡çš„ã€‚å¦‚æœæƒ³è¦æ ¹æ®ä¸€äº›å‚æ•°åšç‰¹å®šä¸šåŠ¡æˆ–è€…æ‰©å±•ï¼Œå°±æ— æ³•å®ç°ã€‚æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ<br/>
è‡ªå®šä¹‰ä¸€ä¸ª DecorateMessageChatMemoryAdvisor å³å¯ï¼Œè£…é¥°ä¸‹ MessageChatMemoryAdvisorã€‚<br/>
åœ¨ MessageChatMemoryAdvisor#before å’Œ MessageChatMemoryAdvisor#after æ–¹æ³•ä¸­ï¼Œå°†è¯·æ±‚ä¸Šä¸‹æ–‡è®¾ç½®åˆ° ThreadLocal ä¸­ï¼Œè¿™æ ·åç»­å°±å¯ä»¥æ‹¿åˆ°ä¸Šä¸‹æ–‡äº†ã€‚<br/>
å¦‚ä½•é…ç½®å‘¢ï¼Ÿ</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> ChatClient <span class="hljs-title function_">openapiChatClient</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier("openaiChatClientBuilder")</span> ChatClient.Builder chatClientBuilder,
                                        ChatMemory chatMemory,
                                        ToolCallbackProvider[] mcpServerTools)</span> {
        <span class="hljs-keyword">return</span> chatClientBuilder
                .defaultAdvisors(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DecorateMessageChatMemoryAdvisor</span>(chatMemory))
                .defaultToolCallbacks(mcpServerTools)
                .build();
    }

</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DecorateMessageChatMemoryAdvisor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">BaseChatMemoryAdvisor</span> {
    <span class="hljs-comment">/**
     * èŠå¤©è®°å¿†
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ChatMemory chatMemory;

    <span class="hljs-comment">/**
     * è£…é¥°ç›®æ ‡
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> MessageChatMemoryAdvisor advisor;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DecorateMessageChatMemoryAdvisor</span><span class="hljs-params">(ChatMemory chatMemory)</span> {
        <span class="hljs-built_in">this</span>.chatMemory = chatMemory;
        <span class="hljs-built_in">this</span>.advisor = MessageChatMemoryAdvisor.builder(chatMemory)
                .conversationId(Constant.DEFAULT_CONVERSATION_ID)
                .scheduler(Schedulers.fromExecutorService(DecorateExecutorService.decorateTrace(Executors.newThreadPerTaskExecutor(Thread.ofVirtual().name(<span class="hljs-string">"vchat-memory"</span>).factory()))))
                .build();
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.advisor.getName();
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Scheduler <span class="hljs-title function_">getScheduler</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.advisor.getScheduler();
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getConversationId</span><span class="hljs-params">(Map&lt;String, Object&gt; context, String defaultConversationId)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.advisor.getConversationId(context, defaultConversationId);
    }

    <span class="hljs-comment">/**
     * è¿™é‡Œè¦å¤åˆ¶é‡å†™ï¼Œå¦åˆ™ this å°±ä¸å¯¹äº†
     */</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Flux&lt;ChatClientResponse&gt; <span class="hljs-title function_">adviseStream</span><span class="hljs-params">(ChatClientRequest chatClientRequest, StreamAdvisorChain streamAdvisorChain)</span> {
        <span class="hljs-comment">// trace_id</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">traceId</span> <span class="hljs-operator">=</span> MDC.get(Constant.TRACE_ID);

        <span class="hljs-comment">// Get the scheduler from BaseAdvisor</span>
        <span class="hljs-type">Scheduler</span> <span class="hljs-variable">scheduler</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.getScheduler();

        <span class="hljs-comment">// Process the request with the before method</span>
        <span class="hljs-keyword">return</span> Mono.just(chatClientRequest)
                .publishOn(scheduler)
                .map(request -&gt; <span class="hljs-built_in">this</span>.before(request, streamAdvisorChain))
                .flatMapMany(streamAdvisorChain::nextStream)
                .transform(flux -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">DecorateChatClientMessageAggregator</span>(traceId, chatClientRequest).aggregateChatClientResponse(flux, response -&gt; <span class="hljs-built_in">this</span>.after(response, streamAdvisorChain)));
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> ChatClientRequest <span class="hljs-title function_">before</span><span class="hljs-params">(ChatClientRequest chatClientRequest, AdvisorChain advisorChain)</span> {
        Map&lt;String, Object&gt; context = chatClientRequest.context();
        context.put(ChatMemoryConfig.CHAT_TYPE, MessageType.USER);
        Map&lt;String, Object&gt; prev = ChatMemoryConfig.setChatContext(context);
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// spring-ai ä¸å­˜åœ¨ç³»ç»Ÿæç¤ºè¯ï¼Œè¿™é‡Œæ‰‹åŠ¨ä¿å­˜</span>
            <span class="hljs-type">SystemMessage</span> <span class="hljs-variable">systemMessage</span> <span class="hljs-operator">=</span> chatClientRequest.prompt().getSystemMessage();
            <span class="hljs-built_in">this</span>.chatMemory.add(<span class="hljs-built_in">this</span>.getConversationId(chatClientRequest.context(), Constant.DEFAULT_CONVERSATION_ID), systemMessage);

            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.advisor.before(chatClientRequest, advisorChain);
        } <span class="hljs-keyword">finally</span> {
            ChatMemoryConfig.setChatContext(prev);
        }
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> ChatClientResponse <span class="hljs-title function_">after</span><span class="hljs-params">(ChatClientResponse chatClientResponse, AdvisorChain advisorChain)</span> {
        Map&lt;String, Object&gt; context = chatClientResponse.context();
        context.put(ChatMemoryConfig.CHAT_TYPE, MessageType.ASSISTANT);
        Map&lt;String, Object&gt; prev = ChatMemoryConfig.setChatContext(context);
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.advisor.after(chatClientResponse, advisorChain);
        } <span class="hljs-keyword">finally</span> {
            ChatMemoryConfig.setChatContext(prev);
        }
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getOrder</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.advisor.getOrder();
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hashCode</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.advisor.hashCode();
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">equals</span><span class="hljs-params">(Object obj)</span> {
        <span class="hljs-keyword">if</span> (obj == <span class="hljs-built_in">this</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> DecorateMessageChatMemoryAdvisor decorate) {
            <span class="hljs-keyword">return</span> decorate.advisor.equals(<span class="hljs-built_in">this</span>.advisor);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.advisor.toString();
    }
}
</code></pre>
<h4 data-id="heading-4">2ã€æ€ä¹ˆè¾“å‡ºæ€è€ƒè¿‡ç¨‹ï¼Ÿ</h4>
<p>spring-ai é»˜è®¤ä¸æ”¯æŒè¾“å‡ºæ€è€ƒè¿‡ç¨‹ï¼ˆä¹Ÿå¯èƒ½æˆ‘æ²¡æ‰¾åˆ°é…ç½®æ–¹å¼ï¼‰ï¼Œé‚£ä¹ˆæ€ä¹ˆå®ç°å‘¢ï¼Ÿ
ç­”æ¡ˆè¿˜æ˜¯è‡ªå®šä¹‰ DecorateMessageChatMemoryAdvisor + è‡ªå®šä¹‰ DecorateChatClientMessageAggregatorã€‚<br/>
åœ¨ DecorateMessageChatMemoryAdvisor#adviseStream æ–¹æ³•ä¸­ï¼Œä½¿ç”¨è‡ªå®šä¹‰èšåˆå™¨è¾“å‡ºæ€è€ƒè¿‡ç¨‹å³å¯ï¼Œè‡ªå®šä¹‰èšåˆå™¨ä»£ç å¦‚ä¸‹ï¼ˆå…¶ä¸­çš„ SSE_EMITTER_KEY éœ€è¦è®¾ç½®åˆ°è¯·æ±‚çš„ä¸Šä¸‹æ–‡ä¸­ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java">adviseStream<span class="hljs-meta">@Slf4j</span>
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DecorateChatClientMessageAggregator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ChatClientMessageAggregator</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String traceId;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ChatClientRequest chatClientRequest;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Flux&lt;ChatClientResponse&gt; <span class="hljs-title function_">aggregateChatClientResponse</span><span class="hljs-params">(Flux&lt;ChatClientResponse&gt; chatClientResponses, Consumer&lt;ChatClientResponse&gt; aggregationHandler)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">emitterKey</span> <span class="hljs-operator">=</span> Mapping.from(chatClientRequest.context()).notNullMap(e -&gt; e.get(SSE_EMITTER_KEY)).notNullMap(e -&gt; (String) e).get();
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.aggregateChatClientResponse(chatClientResponses.doOnNext(e -&gt; sendReasoning(e, emitterKey)), aggregationHandler);
    }

    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendReasoning</span><span class="hljs-params">(ChatClientResponse response, String emitterKey)</span> {
        <span class="hljs-keyword">if</span> (response.chatResponse() == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span>;
        }
        List&lt;Generation&gt; results = response.chatResponse().getResults();
        <span class="hljs-keyword">for</span> (Generation result : results) {
            Map&lt;String, Object&gt; metadata = result.getOutput().getMetadata();
            <span class="hljs-type">String</span> <span class="hljs-variable">reasoningContent</span> <span class="hljs-operator">=</span> (String) metadata.get(<span class="hljs-string">"reasoningContent"</span>);
            <span class="hljs-keyword">if</span> (reasoningContent != <span class="hljs-literal">null</span> &amp;&amp; !reasoningContent.isBlank()) {
                <span class="hljs-keyword">if</span> (emitterKey == <span class="hljs-literal">null</span>) {
                    Logs.runOnTraceId(traceId, () -&gt; log.info(<span class="hljs-string">"reasoning: {}"</span>, reasoningContent));
                    <span class="hljs-keyword">continue</span>;
                }
                Emitters.sendSseEvent(emitterKey, Constant.SseEvent.REASONING_CONTENT, reasoningContent);
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-5">3ã€æµå¼å“åº”æ—¶æ€ä¹ˆä¼ é€’ MDC çš„ trace_idï¼Ÿ</h4>
<p>spring-ai ä½¿ç”¨å“åº”å¼çš„ WebClient å‘èµ· ai ä¼šè¯è¯·æ±‚ï¼Œå› æ­¤æƒ³è¦åœ¨æ—¥å¿—ä¸­æ‰“å° trace_id éœ€è¦ä¸€äº›ç‰¹åˆ«çš„é…ç½®<br/>
è§£å†³æ–¹æ¡ˆè¿˜æ˜¯è‡ªå®šä¹‰ DecorateMessageChatMemoryAdvisorï¼Œåœ¨ DecorateMessageChatMemoryAdvisor#getScheduler æ–¹æ³•ä¸­è¿”å›è‡ªå®šä¹‰çš„è°ƒåº¦å™¨ï¼Œç„¶åè¯¥è‡ªå®šä¹‰è°ƒåº¦å™¨é…ç½®ä¸€ä¸ªä»»åŠ¡åŒ…è£…å™¨å³å¯ã€‚</p>
<h4 data-id="heading-6">4ã€æœ¬åœ°å·¥å…·è°ƒç”¨æ—¶æ€ä¹ˆä¼ é€’ MDC çš„ trace_idï¼Ÿ</h4>
<p>æ‰€è°“æœ¬åœ°å·¥å…·è°ƒç”¨ï¼Œä¹Ÿå³å·¥å…·æ˜¯å®šä¹‰åœ¨ mcp-client é‡Œçš„ï¼Œæ— éœ€è¿œç¨‹è°ƒç”¨ mcp-server çš„å·¥å…·ï¼Œè¿™ç§æƒ…å†µä¸‹æ¯”è¾ƒç®€å•ï¼Œå°† trace_id æ”¾å…¥ ToolContext å³å¯ï¼š</p>
<pre><code class="hljs language-java" lang="java">        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.openapiChatClient.prompt()
                .user(input)
                .toolContext(Map.of(<span class="hljs-string">"traceId"</span>, MDC.get(<span class="hljs-string">"traceId"</span>)))
                .stream()
                .content();
</code></pre>
<p>ç„¶åç¼–å†™ä¸€ä¸ª McpTools å·¥å…·ï¼š</p>
<pre><code class="hljs language-java" lang="java">    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; T <span class="hljs-title function_">runOnToolContext</span><span class="hljs-params">(Map&lt;String, Object&gt; context, Supplier&lt;T&gt; supplier)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">traceId</span> <span class="hljs-operator">=</span> (String) context.get(Constant.TRACE_ID);

        <span class="hljs-keyword">if</span> (traceId == <span class="hljs-literal">null</span>) {
            <span class="hljs-type">T</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> supplier.get();
            log.info(<span class="hljs-string">"å·¥å…·è°ƒç”¨å®Œæˆ: {}"</span>, result);
            <span class="hljs-keyword">return</span> result;
        }

        <span class="hljs-keyword">return</span> runOnTraceId(traceId, supplier, result -&gt; log.info(<span class="hljs-string">"å·¥å…·è°ƒç”¨å®Œæˆ: {}"</span>, result));
    }
	
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; T <span class="hljs-title function_">runOnTraceId</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String traceId, <span class="hljs-keyword">final</span> Supplier&lt;T&gt; supplier, <span class="hljs-keyword">final</span> Consumer&lt;T&gt; consumer)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">prev</span> <span class="hljs-operator">=</span> MDC.get(Constant.TRACE_ID);
        <span class="hljs-keyword">try</span> {
            MDC.put(Constant.TRACE_ID, traceId);
            <span class="hljs-type">T</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> supplier.get();
            <span class="hljs-keyword">if</span> (consumer != <span class="hljs-literal">null</span>) {
                consumer.accept(result);
            }
            <span class="hljs-keyword">return</span> result;
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">if</span> (prev == <span class="hljs-literal">null</span>) {
                MDC.remove(Constant.TRACE_ID);
            } <span class="hljs-keyword">else</span> {
                MDC.put(Constant.TRACE_ID, prev);
            }
        }
    }
</code></pre>
<h4 data-id="heading-7">5ã€è¿œç¨‹ mcp-server å·¥å…·æ€ä¹ˆä¼ é€’ trace_idï¼Ÿ</h4>
<p>è¿œç¨‹å·¥å…·è°ƒç”¨ä¼ é€’æ—¶ï¼Œæˆ‘ä»¥ä¸ºä¹Ÿå¯ä»¥åœ¨ ToolContext ä¸­ä¼ é€’å°±å¯ä»¥äº†ï¼Œç»“æœæ²¡æƒ³åˆ°è¿œç¨‹è°ƒç”¨æ—¶ï¼ŒToolContext ä¸­åªæœ‰ä¸€ä¸ª exchange çš„ keyï¼Œè‡ªå®šä¹‰çš„å·¥å…·ä¸Šä¸‹æ–‡æ ¹æœ¬æ²¡æœ‰ï¼åªå¥½ç ”ç©¶æºç äº†ã€‚æœ€ç»ˆå¾—åˆ°å¦‚ä¸‹è§£å†³æ–¹æ¡ˆï¼š</p>
<h5 data-id="heading-8">ç¬¬ä¸€æ­¥ã€mcp-client è‡ªå®šä¹‰ McpAsyncHttpClientRequestCustomizer</h5>
<p>è¯¥æ‰©å±•æ¥å£ï¼Œåœ¨è¯·æ±‚è¿œç¨‹å·¥å…·è°ƒç”¨æ—¶ï¼Œä¼šå›è°ƒï¼Œè®©å¼€å‘è€…è‡ªå®šä¹‰è¯·æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œå°† trace_id æ”¾å…¥è¯·æ±‚å¤´ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyMcpAsyncHttpClientRequestCustomizer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">McpAsyncHttpClientRequestCustomizer</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Publisher&lt;HttpRequest.Builder&gt; customize(HttpRequest.Builder builder, String method, URI endpoint, String body, McpTransportContext context) {
        <span class="hljs-type">String</span> <span class="hljs-variable">traceId</span> <span class="hljs-operator">=</span> Optional.ofNullable(JSON.parseObject(body))
                .map(e -&gt; e.getJSONObject(<span class="hljs-string">"params"</span>))
                .map(e -&gt; e.getJSONObject(<span class="hljs-string">"_meta"</span>))
                .map(e -&gt; e.getString(<span class="hljs-string">"traceId"</span>))
                .orElse(<span class="hljs-literal">null</span>);
        <span class="hljs-keyword">if</span> (StrUtil.isNotBlank(traceId)) {
            builder = builder.header(<span class="hljs-string">"traceId"</span>, traceId);
        }
        <span class="hljs-keyword">return</span> Mono.just(builder);
    }
}
</code></pre>
<p>æœ‰çš„äººå¯èƒ½ä¼šè§‰å¾—å·¥å…·ä¸Šä¸‹æ–‡æ˜¯ä¸æ˜¯åœ¨ McpTransportContext é‡Œï¼Œå¾ˆé—æ†¾ï¼Œå¹¶æ²¡æœ‰ï¼Œæ‰€ä»¥æ‰è‡ªå·±è§£æ body çš„ã€‚</p>
<h5 data-id="heading-9">ç¬¬äºŒæ­¥ã€mcp-server è‡ªå®šä¹‰ WebFluxStreamableServerTransportProvider</h5>
<p>è‡ªå®šä¹‰ WebFluxStreamableServerTransportProvider çš„ç›®çš„æ˜¯è‡ªå®šä¹‰ McpTransportContextExtractorï¼Œå› ä¸º McpTransportContextExtractor spring-ai æ²¡æœ‰æš´éœ²ä¸º beanï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StreamableServerTransportProviderConfig</span> {

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-meta">@ConditionalOnMissingBean</span>
    <span class="hljs-keyword">public</span> WebFluxStreamableServerTransportProvider <span class="hljs-title function_">webFluxStreamableServerTransportProvider</span><span class="hljs-params">(<span class="hljs-meta">@Qualifier("mcpServerObjectMapper")</span> ObjectMapper objectMapper,
                                                                                             McpServerStreamableHttpProperties serverProperties)</span> {

        <span class="hljs-keyword">return</span> WebFluxStreamableServerTransportProvider.builder()
                .jsonMapper(<span class="hljs-keyword">new</span> <span class="hljs-title class_">JacksonMcpJsonMapper</span>(objectMapper))
                .messageEndpoint(serverProperties.getMcpEndpoint())
                .keepAliveInterval(serverProperties.getKeepAliveInterval())
                .disallowDelete(serverProperties.isDisallowDelete())
                .contextExtractor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">AgentMcpTransportContextExtractor</span>())
                .build();
    }

    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AgentMcpTransportContextExtractor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">McpTransportContextExtractor</span>&lt;ServerRequest&gt; {

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> McpTransportContext <span class="hljs-title function_">extract</span><span class="hljs-params">(ServerRequest request)</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">traceId</span> <span class="hljs-operator">=</span> request.headers().firstHeader(<span class="hljs-string">"traceId"</span>);
            <span class="hljs-keyword">if</span> (traceId == <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> McpTransportContext.EMPTY;
            }
            <span class="hljs-keyword">return</span> McpTransportContext.create(Map.of(<span class="hljs-string">"traceId"</span>, traceId));
        }
    }
}
</code></pre>
<p>è¿™æ ·å°±å¾—åˆ°äº†è¯·æ±‚å¤´çš„ traceIdï¼</p>
<h4 data-id="heading-10">ç¬¬ä¸‰æ­¥ã€mcp-server å†æ·»åŠ ä¸€ä¸ª runOnToolContext æ–¹æ³•</h4>
<pre><code class="hljs language-java" lang="java">	<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; T <span class="hljs-title function_">runOnToolContext</span><span class="hljs-params">(Map&lt;String, Object&gt; context, Supplier&lt;T&gt; supplier)</span> {
        <span class="hljs-keyword">if</span> (context.containsKey(Constant.TRACE_ID)) {
            <span class="hljs-keyword">return</span> {mcp-client}.McpTools.runOnToolContext(context, supplier);
        }

        McpTransportContext transportContext;

        <span class="hljs-type">Object</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> context.get(McpToolUtils.TOOL_CONTEXT_MCP_EXCHANGE_KEY);

        <span class="hljs-keyword">if</span> (object <span class="hljs-keyword">instanceof</span> McpSyncServerExchange exchange) {
            transportContext = exchange.transportContext();
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (object <span class="hljs-keyword">instanceof</span> McpAsyncServerExchange exchange) {
            transportContext = exchange.transportContext();
        } <span class="hljs-keyword">else</span> {
            transportContext = <span class="hljs-literal">null</span>;
        }

        <span class="hljs-keyword">if</span> (transportContext == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> {mcp-client}.McpTools.runOnToolContext(context, supplier);
        }

        <span class="hljs-type">Object</span> <span class="hljs-variable">traceId</span> <span class="hljs-operator">=</span> transportContext.get(Constant.TRACE_ID);

        <span class="hljs-keyword">if</span> (traceId == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> {mcp-client}.McpTools.runOnToolContext(context, supplier);
        }

        <span class="hljs-keyword">return</span> {mcp-client}.McpTools.runOnToolContext(Map.of(Constant.TRACE_ID, traceId.toString()), supplier);
    }
</code></pre>
<p>è¿™æ ·å°±ä¼ é€’ä¸‹æ¥å•¦ï¼</p>
<h4 data-id="heading-11">6ã€æ€ä¹ˆæ‹¦æˆªå·¥å…·è°ƒç”¨ï¼Ÿ</h4>
<p>æƒ³è¦åœ¨å·¥å…·è°ƒç”¨æ—¶ï¼Œç»™å‰ç«¯å‘ä¸€ä¸ª sse æ¶ˆæ¯ï¼Œå·¥å…·æ‹¦æˆªå™¨æ˜¯æœ€åˆé€‚çš„ï¼Œå› ä¸ºæ— è®ºæœ¬åœ°å·¥å…·è¿˜æ˜¯è¿œç¨‹å·¥å…·éƒ½é€‚ç”¨ï¼Œå¯æƒœ spring-ai ç›®å‰æ²¡æœ‰æä¾›ï¼<br/>
æ²¡æœ‰å°±è‡ªå·±é€ ï¼</p>
<h5 data-id="heading-12">ç¬¬ä¸€æ­¥ã€è‡ªå®šä¹‰ DecorateToolCallingManager</h5>
<p>è‡ªå®šä¹‰ DecorateToolCallingManager ç›®çš„æ˜¯ï¼Œå¯¹ ToolCallback è¿›è¡ŒåŒ…è£…ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Slf4j</span>
<span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DecorateToolCallingManager</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ToolCallingManager</span> {
    <span class="hljs-comment">/**
     * è£…é¥°ç›®æ ‡
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ToolCallingManager decorate;

    <span class="hljs-comment">/**
     * æ‹¦æˆªå™¨
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> Collection&lt;ToolCallbackInterceptor&gt; interceptors;

    <span class="hljs-comment">/**
     * å¤„ç†å™¨
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> Collection&lt;ToolExecutionResultHandler&gt; handlers;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> List&lt;ToolDefinition&gt; <span class="hljs-title function_">resolveToolDefinitions</span><span class="hljs-params">(ToolCallingChatOptions chatOptions)</span> {
        Collection&lt;ToolCallbackInterceptor&gt; interceptors = ensureInterceptors();
        List&lt;ToolCallback&gt; toolCallbacks = chatOptions.getToolCallbacks()
                .stream()
                .map(e -&gt; e <span class="hljs-keyword">instanceof</span> DecorateToolCallback ? e : <span class="hljs-keyword">new</span> <span class="hljs-title class_">DecorateToolCallback</span>(e.getToolDefinition().name(), e, interceptors))
                .toList();
        chatOptions.setToolCallbacks(toolCallbacks);
        <span class="hljs-keyword">return</span> decorate.resolveToolDefinitions(chatOptions);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> ToolExecutionResult <span class="hljs-title function_">executeToolCalls</span><span class="hljs-params">(Prompt prompt, ChatResponse chatResponse)</span> {
        <span class="hljs-type">ContextView</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> ToolCallReactiveContextHolder.getContext();
        <span class="hljs-type">ToolExecutionResult</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> decorate.executeToolCalls(prompt, chatResponse);
        <span class="hljs-keyword">for</span> (ToolExecutionResultHandler handler : ensureHandlers()) {
            <span class="hljs-keyword">if</span> (handler.support(prompt, chatResponse, context)) {
                <span class="hljs-keyword">if</span> (handler.handle(prompt, chatResponse, result, context)) {
                    <span class="hljs-keyword">continue</span>;
                }
                <span class="hljs-keyword">break</span>;
            }
        }
        <span class="hljs-keyword">return</span> result;
    }

    <span class="hljs-keyword">protected</span> Collection&lt;ToolCallbackInterceptor&gt; <span class="hljs-title function_">ensureInterceptors</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.interceptors == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) {
                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.interceptors == <span class="hljs-literal">null</span>) {
                    <span class="hljs-built_in">this</span>.interceptors = $.getBeans(ToolCallbackInterceptor.class);
                }
            }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.interceptors;
    }

    <span class="hljs-keyword">protected</span> Collection&lt;ToolExecutionResultHandler&gt; <span class="hljs-title function_">ensureHandlers</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.handlers == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) {
                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.handlers == <span class="hljs-literal">null</span>) {
                    <span class="hljs-built_in">this</span>.handlers = $.getBeans(ToolExecutionResultHandler.class);
                }
            }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.handlers;
    }
}
</code></pre>
<p>è¿™é‡Œä¸ä»…æ‰©å±•äº†å·¥å…·è°ƒç”¨æ‹¦æˆªå™¨ï¼Œè¿˜æ‰©å±•äº†å·¥å…·è°ƒç”¨ç»“æœå¤„ç†å™¨ï¼Œä¹‹æ‰€ä»¥ä¸åœ¨æ‹¦æˆªå™¨é‡Œé¢æ·»åŠ å¤„ç†å™¨ï¼Œæ˜¯å› ä¸ºæ‹¦æˆªå™¨é‡Œé¢æ‹¿ä¸åˆ°åŸå§‹æç¤ºè¯ä»¥åŠåŸå§‹å“åº”ã€‚</p>
<h5 data-id="heading-13">ç¬¬äºŒæ­¥ã€è‡ªå®šä¹‰ ToolCallback</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@RequiredArgsConstructor</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DecorateToolCallback</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ToolCallback</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String toolName;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ToolCallback decorate;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Collection&lt;ToolCallbackInterceptor&gt; interceptors;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> ToolDefinition <span class="hljs-title function_">getToolDefinition</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> decorate.getToolDefinition();
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">call</span><span class="hljs-params">(String toolInput)</span> {
        <span class="hljs-keyword">return</span> call(toolInput, <span class="hljs-literal">null</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> ToolMetadata <span class="hljs-title function_">getToolMetadata</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> decorate.getToolMetadata();
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">call</span><span class="hljs-params">(String toolInput, <span class="hljs-meta">@Nullable</span> ToolContext toolContext)</span> {
        <span class="hljs-keyword">for</span> (ToolCallbackInterceptor interceptor : <span class="hljs-built_in">this</span>.interceptors) {
            interceptor.beforeToolCallback(toolName, toolInput, toolContext, <span class="hljs-built_in">this</span>);
        }

        <span class="hljs-type">Throwable</span> <span class="hljs-variable">ex</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;

        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> decorate.call(toolInput, toolContext);
        } <span class="hljs-keyword">catch</span> (Throwable e) {
            ex = e;
            <span class="hljs-keyword">throw</span> e;
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">for</span> (ToolCallbackInterceptor interceptor : <span class="hljs-built_in">this</span>.interceptors) {
                interceptor.afterToolCallback(toolName, toolInput, toolContext, <span class="hljs-built_in">this</span>, ex);
            }
        }
    }
}
</code></pre>
<h5 data-id="heading-14">ç¬¬ä¸‰æ­¥ã€å°†è‡ªå®šä¹‰çš„è£…é¥°å™¨ç”Ÿæ•ˆ</h5>
<p>æ·»åŠ ä¸€ä¸ª bean åç½®å¤„ç†å™¨å³å¯ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DecorateBeanConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">BeanPostProcessor</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">postProcessAfterInitialization</span><span class="hljs-params">(Object bean, String beanName)</span> <span class="hljs-keyword">throws</span> BeansException {
        <span class="hljs-keyword">if</span> (bean <span class="hljs-keyword">instanceof</span> ToolCallingManager manager) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DecorateToolCallingManager</span>(manager);
        }
        <span class="hljs-keyword">return</span> bean;
    }
}
</code></pre>
<h5 data-id="heading-15">ç¬¬å››æ­¥ã€ç›´æ¥å®ç°æ‹¦æˆªå™¨å³å¯</h5>
<p>æ‹¦æˆªå™¨å®šä¹‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ToolCallbackInterceptor</span> {
    <span class="hljs-comment">/**
     * å·¥å…·è°ƒç”¨å‰å¤„ç†
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">beforeToolCallback</span><span class="hljs-params">(String toolName, String toolInput, ToolContext toolContext, ToolCallback callback)</span>;

    <span class="hljs-comment">/**
     * å·¥å…·è°ƒç”¨åå¤„ç†
     *
     * <span class="hljs-doctag">@param</span> throwable å¦‚æœå·¥å…·è°ƒç”¨å¼‚å¸¸ï¼Œåˆ™ä¸ä¸ºç©º
     */</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterToolCallback</span><span class="hljs-params">(String toolName, String toolInput, ToolContext toolContext, ToolCallback callback, Throwable throwable)</span>;
}
</code></pre>
<p>ç»“æœå¤„ç†å™¨å®šä¹‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ToolExecutionResultHandler</span> {
    <span class="hljs-comment">/**
     * æ˜¯å¦æ”¯æŒå¤„ç†
     *
     * <span class="hljs-doctag">@return</span> true/false
     */</span>
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">support</span><span class="hljs-params">(Prompt prompt, ChatResponse chatResponse, ContextView context)</span>;

    <span class="hljs-comment">/**
     * å¤„ç†å·¥å…·è°ƒç”¨ç»“æœ
     *
     * <span class="hljs-doctag">@return</span> è¿”å› true æ—¶ï¼Œç»§ç»­åç»­é“¾çš„å¤„ç†ï¼Œè¿”å› false æ—¶ï¼Œå°†å¿½ç•¥åç»­é“¾çš„å¤„ç†
     */</span>
    <span class="hljs-type">boolean</span> <span class="hljs-title function_">handle</span><span class="hljs-params">(Prompt prompt, ChatResponse chatResponse, ToolExecutionResult result, ContextView context)</span>;
}
</code></pre>
<p>æ³¨æ„ï¼šå¤„ç†å™¨æ‹¿ä¸åˆ°å·¥å…·ä¸Šä¸‹æ–‡ï¼Œä½†æ˜¯å¯ä»¥æ‹¿åˆ° reactor-core çš„ ContextViewï¼ˆç±»ä¼¼ java çš„ ThreadLocalï¼‰ï¼Œå°†ç›¸å…³æ•°æ®å†™å…¥ Flux çš„ä¸Šä¸‹æ–‡å³å¯ã€‚</p>
<h4 data-id="heading-16">7ã€springboot4.x çš„ swagger æ–‡æ¡£é›†æˆ</h4>
<p>æ–‡æ¡£é›†æˆä¹ŸåºŸäº†ä¸€äº›äº‹ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ã€‚
maven ä¾èµ–ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- doc --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.xiaoymin<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>knife4j-openapi3-jakarta-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.4.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springdoc<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springdoc-openapi-starter-webmvc-ui<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springdoc<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>springdoc-openapi-starter-webmvc-ui<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>yaml é…ç½®ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">springdoc:</span>
  <span class="hljs-attr">group-configs:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">group:</span> <span class="hljs-string">'default'</span>
      <span class="hljs-attr">packages-to-scan:</span> <span class="hljs-string">com.aaa.bbb.controller</span>
</code></pre>
<p>ç„¶åè®¿é—® /doc.html å°±å¥½å•¦</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Java 21è™šæ‹Ÿçº¿ç¨‹ vs Kotlinåç¨‹ï¼šé«˜å¹¶å‘ç¼–ç¨‹æ¨¡å‹çš„ç»ˆæå¯¹å†³ä¸é€‰å‹æ€è€ƒ]]></title>    <link>https://juejin.cn/post/7602928386596667418</link>    <guid>https://juejin.cn/post/7602928386596667418</guid>    <pubDate>2026-02-05T06:57:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602928386596667418" data-draft-id="7602935146706731054" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Java 21è™šæ‹Ÿçº¿ç¨‹ vs Kotlinåç¨‹ï¼šé«˜å¹¶å‘ç¼–ç¨‹æ¨¡å‹çš„ç»ˆæå¯¹å†³ä¸é€‰å‹æ€è€ƒ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-05T06:57:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Javaç¼–ç¨‹çˆ±å¥½è€…"/> <meta itemprop="url" content="https://juejin.cn/user/819554264300154"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Java 21è™šæ‹Ÿçº¿ç¨‹ vs Kotlinåç¨‹ï¼šé«˜å¹¶å‘ç¼–ç¨‹æ¨¡å‹çš„ç»ˆæå¯¹å†³ä¸é€‰å‹æ€è€ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/819554264300154/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Javaç¼–ç¨‹çˆ±å¥½è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:57:53.000Z" title="Thu Feb 05 2026 06:57:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘åœ¨æŠ€æœ¯åœˆå­é‡Œï¼Œå…³äº Java 21 çš„è®¨è®ºçƒ­åº¦ç”šè‡³ç›–è¿‡äº†æŸäº›å½“çº¢çš„ AI æ¨¡å‹ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºÂ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D1%26q%3DProject%2BLoom%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=1&amp;q=Project+Loom&amp;zhida_source=entity" ref="nofollow noopener noreferrer">Project Loom</a>ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D1%26q%3D%25E8%2599%259A%25E6%258B%259F%25E7%25BA%25BF%25E7%25A8%258B%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=1&amp;q=%E8%99%9A%E6%8B%9F%E7%BA%BF%E7%A8%8B&amp;zhida_source=entity" ref="nofollow noopener noreferrer">è™šæ‹Ÿçº¿ç¨‹</a>ï¼‰</strong> Â ç»ˆäºè½åœ°äº†ã€‚</p>
<p>å¾ˆå¤šå…„å¼Ÿé—®æˆ‘ï¼šâ€œCatå“¥ï¼Œæˆ‘ç°åœ¨é¡¹ç›®é‡Œç”¨çš„Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D1%26q%3DKotlin%2B%25E5%258D%258F%25E7%25A8%258B%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=1&amp;q=Kotlin+%E5%8D%8F%E7%A8%8B&amp;zhida_source=entity" ref="nofollow noopener noreferrer">Kotlin åç¨‹</a>çˆ½å¾—é£èµ·ï¼Œè¿˜æœ‰å¿…è¦åˆ‡å› Java 21 çš„è™šæ‹Ÿçº¿ç¨‹å—ï¼Ÿâ€ æˆ–è€… â€œæˆ‘ä»¬çš„è€é¡¹ç›®å…¨æ˜¯Â <code>CompletableFuture</code>Â çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D1%26q%3D%25E5%259B%259E%25E8%25B0%2583%25E5%259C%25B0%25E7%258B%25B1%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=1&amp;q=%E5%9B%9E%E8%B0%83%E5%9C%B0%E7%8B%B1&amp;zhida_source=entity" ref="nofollow noopener noreferrer">å›è°ƒåœ°ç‹±</a>ï¼Œå‡åˆ° Java 21 èƒ½æ•‘å‘½å—ï¼Ÿâ€</p>
<p>è®²çœŸï¼Œè¿™ä¸¤ä¸ªé—®é¢˜ç›´å‡»çµé­‚ã€‚ä½œä¸ºä¸€ååœ¨åç«¯æ‘¸çˆ¬æ»šæ‰“åå¤šå¹´çš„æ¶æ„å¸ˆï¼Œæˆ‘çœ‹è¿‡å¤ªå¤šæŠ€æœ¯é€‰å‹çš„â€œè¡€æ³ªå²â€ã€‚ä»Šå¤©ï¼Œå’±ä»¬ä¸è°ˆè™šçš„ï¼Œç›´æ¥ä»åº•å±‚åŸç†ã€ä»£ç å®æˆ˜ã€ç”Ÿäº§å‘ç‚¹è¿™å‡ ä¸ªç»´åº¦ï¼Œæ¥ä¸€åœº Java 21 è™šæ‹Ÿçº¿ç¨‹ä¸ Kotlin åç¨‹çš„ç»ˆæå¯¹å†³ã€‚</p>
<p>è¿™ä¸ä»…ä»…æ˜¯ä¸€æ¬¡è¯­è¨€ç‰¹æ€§çš„å¯¹æ¯”ï¼Œæ›´æ˜¯ä¸€æ¬¡<strong>æ¶æ„æ€ç»´çš„å‡çº§</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ å¼€ç¯‡ï¼šè‹¦â€œé«˜å¹¶å‘â€ä¹…çŸ£</h2>
<p>åœ¨è™šæ‹Ÿçº¿ç¨‹å‡ºç°ä¹‹å‰ï¼ŒJava ç¨‹åºå‘˜ä¸ºäº†å¤„ç†é«˜å¹¶å‘ï¼ŒåŸºæœ¬åªæœ‰ä¸¤æ¡è·¯ï¼š</p>
<ol>
<li><strong>Thread-per-Requestï¼ˆæ¯è¯·æ±‚æ¯çº¿ç¨‹ï¼‰</strong> ï¼šè¿™æ˜¯æœ€ä¼ ç»Ÿçš„ Servlet æ¨¡å‹ï¼ˆå¦‚ Tomcat é»˜è®¤é…ç½®ï¼‰ã€‚ä»£ç ç®€å•ï¼Œç¬¦åˆäººç±»ç›´è§‰ã€‚ä½†æ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼ˆOS Threadï¼‰å¤ªè´µäº†ï¼ä¸€ä¸ªçº¿ç¨‹å ç”¨ 1MB æ ˆå†…å­˜ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢æˆæœ¬é«˜ï¼Œå‡ åƒä¸ªå¹¶å‘å°±èƒ½æŠŠ CPU ä¹Ÿå°±æ˜¯ Context Switch è·‘æ»¡ã€‚</li>
<li><strong>å¼‚æ­¥å“åº”å¼ç¼–ç¨‹ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D1%26q%3DReactive%2BProgramming%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=1&amp;q=Reactive+Programming&amp;zhida_source=entity" ref="nofollow noopener noreferrer">Reactive Programming</a>ï¼‰</strong> ï¼šä¸ºäº†è§£å†³çº¿ç¨‹ä¸å¤Ÿç”¨çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥äº†Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D1%26q%3DNetty%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=1&amp;q=Netty&amp;zhida_source=entity" ref="nofollow noopener noreferrer">Netty</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D1%26q%3DWebFlux%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=1&amp;q=WebFlux&amp;zhida_source=entity" ref="nofollow noopener noreferrer">WebFlux</a>ã€RxJavaã€‚æ€§èƒ½æ˜¯ä¸Šå»äº†ï¼Œä½†ä»£ä»·æ˜¯<strong>ä»£ç å¯è¯»æ€§å´©å¡Œ</strong>ã€‚ä½ å¾—å†™å„ç§å›è°ƒï¼Œå †æ ˆä¿¡æ¯ï¼ˆStack Traceï¼‰ä¹±å¾—åƒä¸€å›¢æµ†ç³Šï¼Œè°ƒè¯•ç®€ç›´æ˜¯å™©æ¢¦ã€‚</li>
</ol>
<p><strong>Kotlin åç¨‹</strong>Â åœ¨å‡ å¹´å‰æ¨ªç©ºå‡ºä¸–ï¼Œç”¨â€œæŒ‚èµ·å‡½æ•°â€ï¼ˆSuspend Functionï¼‰è¿™ç§è¯­æ³•ç³–ï¼Œè®©æˆ‘ä»¬èƒ½ç”¨åŒæ­¥çš„ä»£ç é£æ ¼å†™<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D1%26q%3D%25E5%25BC%2582%25E6%25AD%25A5%25E9%2580%25BB%25E8%25BE%2591%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=1&amp;q=%E5%BC%82%E6%AD%A5%E9%80%BB%E8%BE%91&amp;zhida_source=entity" ref="nofollow noopener noreferrer">å¼‚æ­¥é€»è¾‘</a>ï¼Œç¡®å®æ”¶å‰²äº†ä¸€å¤§æ³¢å¥½æ„Ÿã€‚</p>
<p>ä½†ç°åœ¨ï¼Œ<strong>Java 21 å¸¦ç€è™šæ‹Ÿçº¿ç¨‹ï¼ˆVirtual Threadsï¼‰æ¥äº†</strong>ã€‚å®˜æ–¹å·ç§°ï¼š <strong>â€œWrite sync, run asyncâ€</strong> ï¼ˆå†™ç€æ˜¯åŒæ­¥ï¼Œè·‘èµ·æ¥æ˜¯å¼‚æ­¥ï¼‰ã€‚å®ƒä¸éœ€è¦å¼•å…¥é¢å¤–çš„å…³é”®å­—ï¼ˆæ¯”å¦‚Â <code>suspend</code>ï¼‰ï¼Œä¸éœ€è¦ä¿®æ”¹ä»£ç ç»“æ„ï¼Œå°±èƒ½è·å¾—ç™¾ä¸‡çº§å¹¶å‘ã€‚</p>
<p>è¿™æ˜¯å¦æ„å‘³ç€ Kotlin åç¨‹è¦å‡‰ï¼Ÿå’±ä»¬å¾€ä¸‹çœ‹ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€ æ ¸å¿ƒåŸç†æ‹†è§£ï¼šM:N æ¨¡å‹ä¹‹äº‰</h2>
<p>è¦ç†è§£å®ƒä»¬çš„åŒºåˆ«ï¼Œå¿…é¡»å…ˆçœ‹åº•å±‚æ¨¡å‹ã€‚</p>
<h3 data-id="heading-2">1. ä¼ ç»Ÿçš„ JavaÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D1%26q%3D%25E7%25BA%25BF%25E7%25A8%258B%25E6%25A8%25A1%25E5%259E%258B%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=1&amp;q=%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B&amp;zhida_source=entity" ref="nofollow noopener noreferrer">çº¿ç¨‹æ¨¡å‹</a>ï¼ˆ1:1ï¼‰</h3>
<p>åœ¨ Java 19 ä¹‹å‰ï¼ŒJava çš„Â <code>java.lang.Thread</code>Â æ˜¯ä¸€ä¸€å¯¹åº”æ“ä½œç³»ç»Ÿçš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D1%26q%3D%25E5%2586%2585%25E6%25A0%25B8%25E7%25BA%25BF%25E7%25A8%258B%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=1&amp;q=%E5%86%85%E6%A0%B8%E7%BA%BF%E7%A8%8B&amp;zhida_source=entity" ref="nofollow noopener noreferrer">å†…æ ¸çº¿ç¨‹</a>çš„ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd85cfd8501446c595ca2109c99ac695~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2Yee8lueoi-eIseWlveiAhQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879474&amp;x-signature=SEc5CN6ZhA8gmf%2FT7ST1lz%2BdjWo%3D" alt="" loading="lazy"/></p>
<p>è¿™ç§æ¨¡å‹æœ€å¤§çš„ç“¶é¢ˆåœ¨äºï¼š<strong>OS çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æº</strong>ã€‚</p>
<h3 data-id="heading-3">2. è™šæ‹Ÿçº¿ç¨‹ä¸åç¨‹çš„é€šç”¨æ¨¡å‹ï¼ˆM:Nï¼‰</h3>
<p>æ— è®ºæ˜¯ Java è™šæ‹Ÿçº¿ç¨‹è¿˜æ˜¯ Kotlin åç¨‹ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯Â <strong>User-Mode Threadsï¼ˆç”¨æˆ·æ€çº¿ç¨‹ï¼‰</strong> ã€‚å®ƒä»¬çš„è°ƒåº¦åœ¨ JVM å±‚æˆ–è¯­è¨€åº“å±‚å®Œæˆï¼Œè€Œä¸æ˜¯ç”± OS è°ƒåº¦ã€‚</p>
<ul>
<li><strong>M ä¸ªè™šæ‹Ÿçº¿ç¨‹</strong>Â æ˜ å°„åˆ°Â <strong>N ä¸ª<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D1%26q%3D%25E5%25B9%25B3%25E5%258F%25B0%25E7%25BA%25BF%25E7%25A8%258B%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=1&amp;q=%E5%B9%B3%E5%8F%B0%E7%BA%BF%E7%A8%8B&amp;zhida_source=entity" ref="nofollow noopener noreferrer">å¹³å°çº¿ç¨‹</a>ï¼ˆCarrier Threadsï¼‰</strong> Â ä¸Šã€‚</li>
<li>å½“è™šæ‹Ÿçº¿ç¨‹æ‰§è¡Œé˜»å¡ I/Oï¼ˆå¦‚æŸ¥æ•°æ®åº“ã€è°ƒ HTTP æ¥å£ï¼‰æ—¶ï¼Œå®ƒä¼š<strong>å¸è½½ï¼ˆUnmountï¼‰</strong> ï¼ŒæŠŠåº•å±‚çš„å¹³å°çº¿ç¨‹è®©å‡ºæ¥å»æ‰§è¡Œå…¶ä»–ä»»åŠ¡ã€‚</li>
<li>I/O ç»“æŸåï¼Œè™šæ‹Ÿçº¿ç¨‹è¢«<strong>æŒ‚è½½ï¼ˆMountï¼‰</strong> Â å›å¹³å°çº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/22b16260eea74784b04846529830a759~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSmF2Yee8lueoi-eIseWlveiAhQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879474&amp;x-signature=SpXj9cmbDrX1%2B1C9388mRvqLoMs%3D" alt="" loading="lazy"/></p>
<p><strong>å…³é”®åŒºåˆ«åœ¨äºå®ç°æ–¹å¼ï¼š</strong></p>
<ul>
<li><strong>Kotlin åç¨‹</strong>ï¼šåŸºäº<strong>ç¼–è¯‘å™¨</strong>ã€‚ç¼–è¯‘å™¨ä¼šå°†Â <code>suspend</code>Â å‡½æ•°è½¬æ¢æˆçŠ¶æ€æœºï¼ˆState Machineï¼‰ã€‚è¿™æ˜¯ä¸€ç§<strong>æœ‰æ ˆåç¨‹ï¼ˆStackless Coroutineï¼‰çš„æ¨¡æ‹Ÿ</strong>ï¼ˆè™½ç„¶ Kotlin åç¨‹è¡¨ç°å¾—åƒæœ‰æ ˆï¼Œä½†åº•å±‚æ˜¯ Continuation Passing Styleï¼‰ã€‚å®ƒå…·æœ‰<strong>ä¼ æŸ“æ€§</strong>ï¼ˆFunction Coloringï¼‰ï¼Œå¼‚æ­¥å‡½æ•°å¿…é¡»æ ‡ä¸ºÂ <code>suspend</code>ï¼Œä¸”åªèƒ½è¢«å…¶ä»–Â <code>suspend</code>Â å‡½æ•°è°ƒç”¨ã€‚</li>
<li><strong>Java è™šæ‹Ÿçº¿ç¨‹</strong>ï¼šåŸºäºÂ <strong>JVM è¿è¡Œæ—¶</strong>ã€‚JVM ä¹Ÿå°±æ˜¯ HotSpot å†…éƒ¨é‡å†™äº†æ‰€æœ‰çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D1%26q%3D%25E9%2598%25BB%25E5%25A1%259E%25E8%25B0%2583%25E7%2594%25A8%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=1&amp;q=%E9%98%BB%E5%A1%9E%E8%B0%83%E7%94%A8&amp;zhida_source=entity" ref="nofollow noopener noreferrer">é˜»å¡è°ƒç”¨</a>ï¼ˆSocket, Lock, Sleepï¼‰ã€‚å½“ä½ è°ƒç”¨Â <code>Thread.sleep</code>Â æˆ–Â <code>socket.read</code>Â æ—¶ï¼ŒJVM è‡ªåŠ¨æŠŠå½“å‰è™šæ‹Ÿçº¿ç¨‹çš„æ ˆå¸§ï¼ˆStack Frameï¼‰ä¿å­˜åˆ°å †å†…å­˜ä¸­ï¼Œç„¶åæŒ‚èµ·ã€‚è¿™å¯¹å¼€å‘è€…æ˜¯<strong>é€æ˜</strong>çš„ã€‚ä½ ä¸éœ€è¦åŠ ä»»ä½•å…³é”®å­—ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€ ä»£ç å®æˆ˜ï¼šåˆ€åˆ€è§è¡€</h2>
<p>å…‰è¯´ä¸ç»ƒå‡æŠŠå¼ã€‚æˆ‘ä»¬é€šè¿‡ 6 ä¸ªä¾‹å­æ¥å¯¹æ¯”ã€‚</p>
<h3 data-id="heading-5">åœºæ™¯ä¸€ï¼šåˆ›å»º 10 ä¸‡ä¸ª<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D1%26q%3D%25E5%25B9%25B6%25E5%258F%2591%25E4%25BB%25BB%25E5%258A%25A1%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=1&amp;q=%E5%B9%B6%E5%8F%91%E4%BB%BB%E5%8A%A1&amp;zhida_source=entity" ref="nofollow noopener noreferrer">å¹¶å‘ä»»åŠ¡</a></h3>
<p>æˆ‘ä»¬è¦æ¨¡æ‹Ÿ 10 ä¸‡ä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡ç¡ 1 ç§’ã€‚</p>
<h3 data-id="heading-6">ç¤ºä¾‹ 1: Java 21 è™šæ‹Ÿçº¿ç¨‹</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.time.Duration;
<span class="hljs-keyword">import</span> java.time.Instant;
<span class="hljs-keyword">import</span> java.util.concurrent.Executors;
<span class="hljs-keyword">import</span> java.util.stream.IntStream;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VirtualThreadDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">var</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> Instant.now();
        
        <span class="hljs-comment">// ä½¿ç”¨è™šæ‹Ÿçº¿ç¨‹æ‰§è¡Œå™¨</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">var</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newVirtualThreadPerTaskExecutor()) {
            IntStream.range(<span class="hljs-number">0</span>, <span class="hljs-number">100_000</span>).forEach(i -&gt; {
                executor.submit(() -&gt; {
                    <span class="hljs-keyword">try</span> {
                        <span class="hljs-comment">// è¿™é‡Œçš„ sleep ä¸ä¼šé˜»å¡ OS çº¿ç¨‹ï¼Œåªä¼šå¸è½½è™šæ‹Ÿçº¿ç¨‹</span>
                        Thread.sleep(<span class="hljs-number">1000</span>); 
                    } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                        <span class="hljs-comment">// handle exception</span>
                    }
                    <span class="hljs-keyword">return</span> i;
                });
            });
        } <span class="hljs-comment">// try-with-resources ä¼šè‡ªåŠ¨ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ</span>

        <span class="hljs-type">var</span> <span class="hljs-variable">end</span> <span class="hljs-operator">=</span> Instant.now();
        System.out.println(<span class="hljs-string">"è€—æ—¶: "</span> + Duration.between(start, end).toMillis() + <span class="hljs-string">"ms"</span>);
    }
}
</code></pre>
<p><strong>è¿è¡Œç»“æœè¯´æ˜</strong>ï¼šè€—æ—¶å¤§çº¦åœ¨ 1000ms å¤šä¸€ç‚¹ç‚¹ã€‚å¦‚æœæ˜¯ä¼ ç»Ÿ<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D1%26q%3D%25E7%25BA%25BF%25E7%25A8%258B%25E6%25B1%25A0%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=1&amp;q=%E7%BA%BF%E7%A8%8B%E6%B1%A0&amp;zhida_source=entity" ref="nofollow noopener noreferrer">çº¿ç¨‹æ± </a>ï¼Œ10 ä¸‡ä¸ªçº¿ç¨‹ç›´æ¥ OOM æˆ–è€…å¡æ­»ã€‚</p>
<h3 data-id="heading-7">ç¤ºä¾‹ 2: Kotlin åç¨‹</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*
<span class="hljs-keyword">import</span> kotlin.system.measureTimeMillis

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> = runBlocking {
    <span class="hljs-keyword">val</span> time = measureTimeMillis {
        <span class="hljs-keyword">val</span> jobs = List(<span class="hljs-number">100_000</span>) {
            launch {
                delay(<span class="hljs-number">1000</span>) <span class="hljs-comment">// æŒ‚èµ·å‡½æ•°ï¼Œéé˜»å¡</span>
            }
        }
        jobs.joinAll()
    }
    println(<span class="hljs-string">"è€—æ—¶: <span class="hljs-subst">${time}</span>ms"</span>)
}
</code></pre>
<p><strong>è¿è¡Œç»“æœè¯´æ˜</strong>ï¼šåŒæ ·ä¹Ÿæ˜¯ 1000ms å‡ºå¤´ã€‚æ€§èƒ½ä¸Šä¸¤è€…åœ¨çº¯ I/O åœºæ™¯ä¸‹<strong>ä¸åˆ†ä¼¯ä»²</strong>ã€‚</p>
<p><strong>ğŸ’¡ æ¶æ„å¸ˆç‚¹è¯„</strong>ï¼š Java çš„ä¼˜åŠ¿åœ¨äº<strong>æ²¡æœ‰å¿ƒæ™ºè´Ÿæ‹…</strong>ã€‚ä½ ç”¨çš„æ˜¯ç†Ÿæ‚‰çš„Â <code>ExecutorService</code>ï¼Œç†Ÿæ‚‰çš„Â <code>Thread.sleep</code>ã€‚è€Œ Kotlin éœ€è¦ç†è§£Â <code>runBlocking</code>ã€<code>launch</code>ã€<code>delay</code>Â ä»¥åŠÂ <code>CoroutineScope</code>ã€‚</p>
<hr/>
<h3 data-id="heading-8">åœºæ™¯äºŒï¼šç»“æ„åŒ–å¹¶å‘ï¼ˆStructured Concurrencyï¼‰</h3>
<p>è¿™æ˜¯<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D1%26q%3D%25E9%25AB%2598%25E5%25B9%25B6%25E5%258F%2591%25E7%25BC%2596%25E7%25A8%258B%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=1&amp;q=%E9%AB%98%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B&amp;zhida_source=entity" ref="nofollow noopener noreferrer">é«˜å¹¶å‘ç¼–ç¨‹</a>ä¸­éå¸¸é‡è¦çš„æ¦‚å¿µï¼š<strong>çˆ¶ä»»åŠ¡åº”è¯¥ç­‰å¾…å­ä»»åŠ¡å®Œæˆï¼Œå¦‚æœå­ä»»åŠ¡å¤±è´¥ï¼Œåº”è¯¥èƒ½å¤Ÿä¼˜é›…åœ°å–æ¶ˆå…¶ä»–å…„å¼Ÿä»»åŠ¡ã€‚</strong></p>
<h3 data-id="heading-9">ç¤ºä¾‹ 3: Kotlin çš„ç»“æ„åŒ–å¹¶å‘ï¼ˆåŸç”Ÿæ”¯æŒï¼‰</h3>
<p>Kotlin å¤©ç”Ÿæ”¯æŒç»“æ„åŒ–å¹¶å‘ï¼Œè¿™æ˜¯å®ƒçš„æ€æ‰‹é”ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.coroutines.*

<span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">fetchUserData</span><span class="hljs-params">()</span></span>: String = coroutineScope {
    <span class="hljs-keyword">val</span> userDeferred = async { 
        delay(<span class="hljs-number">100</span>); <span class="hljs-string">"User: Howell"</span> 
    }
    <span class="hljs-keyword">val</span> ordersDeferred = async { 
        delay(<span class="hljs-number">200</span>); <span class="hljs-string">"Orders: [A, B]"</span> 
    }
    
    <span class="hljs-comment">// å¦‚æœ fetchOrders å¤±è´¥ï¼ŒfetchUser ä¹Ÿä¼šè¢«å–æ¶ˆ</span>
    <span class="hljs-string">"<span class="hljs-subst">${userDeferred.await()}</span> | <span class="hljs-subst">${ordersDeferred.await()}</span>"</span>
}
</code></pre>
<h3 data-id="heading-10">ç¤ºä¾‹ 4: Java 21 çš„ç»“æ„åŒ–å¹¶å‘ï¼ˆPreview APIï¼‰</h3>
<p>Java 21 å¼•å…¥äº†Â <code>StructuredTaskScope</code>ï¼ˆç›®å‰æ˜¯ Preview åŠŸèƒ½ï¼Œä½†åœ¨ Java 21+ ç”Ÿäº§ä¸­å·²æœ‰äººå°è¯•ä½¿ç”¨ï¼‰ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.concurrent.StructuredTaskScope;
<span class="hljs-keyword">import</span> java.util.concurrent.ExecutionException;
<span class="hljs-keyword">import</span> java.util.function.Supplier;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StructuredConcurrencyDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException, ExecutionException {
        
        <span class="hljs-comment">// ä½¿ç”¨ ShutdownOnFailure ç­–ç•¥ï¼šåªè¦æœ‰ä¸€ä¸ªå¤±è´¥ï¼Œå°±å…¨éƒ¨å–æ¶ˆ</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">var</span> <span class="hljs-variable">scope</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StructuredTaskScope</span>.ShutdownOnFailure()) {
            
            Supplier&lt;String&gt; userTask = scope.fork(() -&gt; {
                Thread.sleep(<span class="hljs-number">100</span>);
                <span class="hljs-keyword">return</span> <span class="hljs-string">"User: Howell"</span>;
            });
            
            Supplier&lt;String&gt; orderTask = scope.fork(() -&gt; {
                Thread.sleep(<span class="hljs-number">200</span>);
                <span class="hljs-keyword">return</span> <span class="hljs-string">"Orders: [A, B]"</span>;
            });

            scope.join(); <span class="hljs-comment">// ç­‰å¾…æ‰€æœ‰å­ä»»åŠ¡</span>
            scope.throwIfFailed(); <span class="hljs-comment">// å¦‚æœæœ‰å¼‚å¸¸åˆ™æŠ›å‡º</span>

            System.out.println(userTask.get() + <span class="hljs-string">" | "</span> + orderTask.get());
        }
    }
}
</code></pre>
<p><strong>è¿è¡Œç»“æœè¯´æ˜</strong>ï¼šä¸¤è€…éƒ½èƒ½å®ç°å¹¶è¡Œè·å–æ•°æ®å¹¶åœ¨ 200ms å·¦å³è¿”å›ã€‚</p>
<p><strong>ğŸ’¡ æ¶æ„å¸ˆç‚¹è¯„</strong>ï¼š Kotlin çš„è¯­æ³•æ›´ç®€æ´ï¼ˆ<code>async/await</code>Â é£æ ¼ï¼‰ã€‚Java çš„Â <code>StructuredTaskScope</code>Â è™½ç„¶ä»£ç é‡ç¨å¤šï¼Œä½†é€»è¾‘éå¸¸æ¸…æ™°ï¼Œä¸”é€šè¿‡Â <code>try-with-resources</code>Â å—å¼ºåˆ¶äº†ä½œç”¨åŸŸçš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿™æ˜¯ä¸€ç§éå¸¸å·¥ç¨‹åŒ–çš„è®¾è®¡ï¼Œé˜²æ­¢äº†â€œçº¿ç¨‹æ³„æ¼â€ã€‚</p>
<hr/>
<h3 data-id="heading-11">åœºæ™¯ä¸‰ï¼šç”Ÿäº§ç¯å¢ƒçš„éšå½¢æ€æ‰‹â€”â€”<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D1%26q%3DPinning%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=1&amp;q=Pinning&amp;zhida_source=entity" ref="nofollow noopener noreferrer">Pinning</a>ï¼ˆè½½ä½“çº¿ç¨‹é’‰ä½ï¼‰</h3>
<p>è¿™æ˜¯ Java è™šæ‹Ÿçº¿ç¨‹ç›®å‰æœ€å¤§çš„<strong>å‘</strong>ã€‚</p>
<p>å¦‚æœä½ çš„ä»£ç åœ¨Â <code>synchronized</code>Â å—ä¸­æ‰§è¡Œäº†é˜»å¡æ“ä½œï¼Œæˆ–è€…è°ƒç”¨äº†æœ¬åœ°æ–¹æ³•ï¼ˆNative Methodï¼‰ï¼Œè™šæ‹Ÿçº¿ç¨‹å°±ä¼šè¢«Â <strong>Pinï¼ˆé’‰ä½ï¼‰</strong> Â åœ¨å¹³å°çº¿ç¨‹ä¸Šï¼Œæ— æ³•å¸è½½ã€‚è¿™ä¼šå¯¼è‡´æ€§èƒ½é€€åŒ–å›ä¼ ç»Ÿçº¿ç¨‹æ¨¡å¼ï¼Œç”šè‡³æ›´å·®ã€‚</p>
<h3 data-id="heading-12">ç¤ºä¾‹ 5: Java 21 ä¸­çš„ Pinning é—®é¢˜</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.concurrent.Executors;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PinningDemo</span> {
    
    <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªåä¹ æƒ¯ï¼šåœ¨ synchronized ä¸­åš IO</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">badMethod</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">try</span> {
            System.out.println(Thread.currentThread() + <span class="hljs-string">" start sleep"</span>);
            Thread.sleep(<span class="hljs-number">1000</span>); <span class="hljs-comment">// è¿™é‡Œä¼šå¯¼è‡´ Pinningï¼</span>
            System.out.println(Thread.currentThread() + <span class="hljs-string">" end sleep"</span>);
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            e.printStackTrace();
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">var</span> <span class="hljs-variable">demo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PinningDemo</span>();
        <span class="hljs-keyword">try</span> (<span class="hljs-type">var</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> Executors.newVirtualThreadPerTaskExecutor()) {
            <span class="hljs-comment">// å¯åŠ¨ 10 ä¸ªè™šæ‹Ÿçº¿ç¨‹ï¼Œä½†å¦‚æœ Carrier çº¿ç¨‹åªæœ‰å‡ ä¸ªï¼Œ</span>
            <span class="hljs-comment">// è¿™é‡Œçš„ synchronized ä¼šå¯¼è‡´å®ƒä»¬ä¸²è¡ŒåŒ–ï¼Œå› ä¸ºè™šæ‹Ÿçº¿ç¨‹æ— æ³•å¸è½½</span>
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
                executor.submit(() -&gt; demo.badMethod());
            }
        }
    }
}
</code></pre>
<p><strong>è¿è¡Œç»“æœè¯´æ˜</strong>ï¼šè™½ç„¶æ˜¯è™šæ‹Ÿçº¿ç¨‹ï¼Œä½†ä½ ä¼šå‘ç°æ‰§è¡Œé€Ÿåº¦å˜æ…¢äº†ï¼Œä¸å†æ˜¯å¹¶è¡Œçš„ã€‚JVM å¯åŠ¨å‚æ•°åŠ ä¸ŠÂ <code>-Djdk.tracePinnedThreads=short</code>Â å¯ä»¥çœ‹åˆ°è­¦å‘Šã€‚</p>
<h3 data-id="heading-13">ç¤ºä¾‹ 6: è§£å†³æ–¹æ¡ˆ - ä½¿ç”¨ ReentrantLock</h3>
<pre><code class="hljs language-csharp" lang="csharp">import java.util.concurrent.locks.ReentrantLock;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">NoPinningDemo</span> {
    <span class="hljs-keyword">private</span> final ReentrantLock <span class="hljs-keyword">lock</span> = <span class="hljs-keyword">new</span> ReentrantLock();

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">goodMethod</span>()</span> {
        <span class="hljs-keyword">lock</span>.<span class="hljs-keyword">lock</span>(); <span class="hljs-comment">// ReentrantLock ä¸ä¼šå¯¼è‡´ Pinning</span>
        <span class="hljs-keyword">try</span> {
            Thread.sleep(<span class="hljs-number">1000</span>); <span class="hljs-comment">// æ­¤æ—¶è™šæ‹Ÿçº¿ç¨‹å¯ä»¥æ­£å¸¸å¸è½½</span>
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">lock</span>.unlock();
        }
    }
    <span class="hljs-comment">// ... main æ–¹æ³•åŒä¸Šï¼Œè°ƒç”¨ goodMethod</span>
}
</code></pre>
<p><strong>ğŸ’¡ æ¶æ„å¸ˆç‚¹è¯„</strong>ï¼š Kotlin åç¨‹æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºå®ƒæ ¹æœ¬ä¸æ”¯æŒÂ <code>synchronized</code>Â å…³é”®å­—ï¼ˆåœ¨æŒ‚èµ·å‡½æ•°ä¸­ï¼‰ï¼Œå®ƒå¼ºè¿«ä½ ä½¿ç”¨Â <code>Mutex</code>ã€‚Java è¿™ç§â€œå…¼å®¹æ—§ä»£ç â€çš„ç­–ç•¥æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ï¼Œè€ä»£ç åº“é‡Œçš„Â <code>synchronized</code>Â å¯èƒ½æ˜¯å‡çº§ Java 21 æœ€å¤§çš„é›·ã€‚</p>
<hr/>
<h2 data-id="heading-14">å››ã€Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhida.zhihu.com%2Fsearch%3Fcontent_id%3D269766626%26content_type%3DArticle%26match_order%3D5%26q%3D%25E6%259E%25B6%25E6%259E%2584%25E5%25B8%2588%26zhida_source%3Dentity" target="_blank" title="https://zhida.zhihu.com/search?content_id=269766626&amp;content_type=Article&amp;match_order=5&amp;q=%E6%9E%B6%E6%9E%84%E5%B8%88&amp;zhida_source=entity" ref="nofollow noopener noreferrer">æ¶æ„å¸ˆ</a>æ€ç»´ï¼šå¦‚ä½•é€‰å‹ä¸é¿å‘</h2>
<p>ä½œä¸ºæ¶æ„å¸ˆï¼Œé€‰å‹ä¸èƒ½åªçœ‹ Demoï¼Œè¦çœ‹ç”Ÿæ€ã€ç»´æŠ¤æˆæœ¬å’Œå›¢é˜Ÿèƒ½åŠ›ã€‚</p>
<h3 data-id="heading-15">1. å¸¸è§è¯¯åŒºä¸å‘ç‚¹</h3>
<ul>
<li>
<p><strong>è¯¯åŒºï¼šè™šæ‹Ÿçº¿ç¨‹æ¯”å¹³å°çº¿ç¨‹å¿«ã€‚</strong></p>
</li>
<li>
<ul>
<li><strong>çœŸç›¸</strong>ï¼šè™šæ‹Ÿçº¿ç¨‹<strong>ä¸ä¼šé™ä½å•ä¸ªè¯·æ±‚çš„å»¶è¿Ÿ</strong>ï¼Œå®ƒæå‡çš„æ˜¯<strong>ååé‡</strong>ã€‚å¦‚æœä½ çš„ä»»åŠ¡æ˜¯ CPU å¯†é›†å‹ï¼ˆæ¯”å¦‚è®¡ç®—å“ˆå¸Œã€è§†é¢‘ç¼–ç ï¼‰ï¼Œè™šæ‹Ÿçº¿ç¨‹åè€Œå› ä¸ºè°ƒåº¦å¼€é”€ä¼šæ›´æ…¢ã€‚å®ƒåªé€‚åˆ I/O å¯†é›†å‹ä»»åŠ¡ã€‚</li>
</ul>
</li>
<li>
<p><strong>å‘ç‚¹ï¼šThreadLocal çš„æ»¥ç”¨ã€‚</strong></p>
</li>
<li>
<ul>
<li>
<p>åœ¨ä¼ ç»Ÿ Web å®¹å™¨ä¸­ï¼Œæˆ‘ä»¬ä¹ æƒ¯ç”¨Â <code>ThreadLocal</code>Â å­˜ç”¨æˆ·ä¿¡æ¯ã€‚ä½†åœ¨è™šæ‹Ÿçº¿ç¨‹æ¨¡å¼ä¸‹ï¼Œä¸€ä¸ªè¯·æ±‚å¯èƒ½äº§ç”Ÿæ•°åƒä¸ªè™šæ‹Ÿçº¿ç¨‹ï¼Œå¦‚æœæ¯ä¸ªéƒ½å¤åˆ¶åºå¤§çš„Â <code>ThreadLocal</code>Â Mapï¼Œå†…å­˜ä¼šç¬é—´çˆ†ç‚¸ã€‚</p>
</li>
<li>
<p><strong>å»ºè®®</strong>ï¼šå‡å°‘Â <code>ThreadLocal</code>Â ä½¿ç”¨ï¼Œæˆ–è€…åˆ‡æ¢åˆ° Java 21 çš„Â <code>ScopedValue</code>ï¼ˆé¢„è§ˆç‰¹æ€§ï¼‰ã€‚</p>
</li>
</ul>
</li>
</ul>
<h3 data-id="heading-16">2. ç”Ÿæ€å¯¹æ¯”</h3>



































<table><thead><tr><th>ç‰¹æ€§</th><th>Java 21 è™šæ‹Ÿçº¿ç¨‹</th><th>Kotlin åç¨‹</th></tr></thead><tbody><tr><td>å­¦ä¹ æ›²çº¿</td><td>ä½ã€‚å‡ ä¹ä¸éœ€è¦æ”¹ä»£ç ä¹ æƒ¯ã€‚</td><td>ä¸­é«˜ã€‚éœ€è¦ç†è§£ Scope, Context, Suspendã€‚</td></tr><tr><td>è°ƒè¯•ä½“éªŒ</td><td>ä¼˜ç§€ã€‚æ ‡å‡†çš„ Stack Traceï¼Œå·¥å…·é“¾å®Œç¾æ”¯æŒã€‚</td><td>ä¸€èˆ¬ã€‚å¼‚æ­¥å †æ ˆæœ‰æ—¶éš¾ä»¥è¿½è¸ªã€‚</td></tr><tr><td>ç”Ÿæ€å…¼å®¹</td><td>å®Œç¾ã€‚JDBC, Spring, Tomcat æ— ç¼åˆ‡æ¢ã€‚</td><td>å‰²è£‚ã€‚JDBC æ˜¯é˜»å¡çš„ï¼Œéœ€è¦ç”¨Â <a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttp%253A%2F%2FDispatchers.IO" target="_blank" title="https://link.zhihu.com/?target=http%3A//Dispatchers.IO" ref="nofollow noopener noreferrer">Dispatchers.IO</a>Â åŒ…è£…ã€‚</td></tr><tr><td>ç¼–ç¨‹èŒƒå¼</td><td>å‘½ä»¤å¼ã€åŒæ­¥é£æ ¼ã€‚</td><td>å£°æ˜å¼ã€å‡½æ•°å¼é£æ ¼ã€‚</td></tr><tr><td>æ€§èƒ½ä¸Šé™</td><td>æé«˜ï¼ˆç™¾ä¸‡çº§ï¼‰ã€‚</td><td>æé«˜ï¼ˆç™¾ä¸‡çº§ï¼‰ã€‚</td></tr></tbody></table>
<h3 data-id="heading-17">3. é‚ªä¿®ç‰ˆæœ¬æ¶æ„è®¾è®¡ï¼ˆUnorthodox Architectureï¼‰</h3>
<p>å¦‚æœä¸æƒ³é‡æ„è€ä»£ç ï¼Œåˆæƒ³åˆ©ç”¨æ–°ç‰¹æ€§ï¼Œå¯ä»¥å°è¯•è¿™ç§â€œé‚ªä¿®â€ç©æ³•ï¼š</p>
<ul>
<li><strong>Spring Boot 3.2 + è™šæ‹Ÿçº¿ç¨‹å¼€å…³</strong>ï¼š åœ¨Â <code>application.yml</code>Â ä¸­é…ç½®Â <code>spring.threads.virtual.enabled=true</code>ã€‚ è¿™è¡Œé…ç½®ä¼šè®© Tomcat å’Œ Jetty çš„å¤„ç†çº¿ç¨‹æ± ç›´æ¥æ¢æˆè™šæ‹Ÿçº¿ç¨‹ã€‚è€çš„ Controller ä»£ç ä¸€è¡Œä¸ç”¨æ”¹ï¼Œå¹¶å‘èƒ½åŠ›ç¬é—´æå‡ 10 å€ã€‚</li>
<li><strong>ç”¨è™šæ‹Ÿçº¿ç¨‹åŒ…è£… JDBC</strong>ï¼š ä»¥å‰ç”¨ WebFlux æœ€å¤´ç–¼çš„æ˜¯æ•°æ®åº“é©±åŠ¨å¿…é¡»æ˜¯ R2DBCã€‚ç°åœ¨ä½ å¯ä»¥ç»§ç»­ç”¨æˆç†Ÿçš„ HikariCP + MySQL Connectorï¼ŒæŠŠå®ƒä»¬è·‘åœ¨è™šæ‹Ÿçº¿ç¨‹é‡Œï¼Œæ•ˆæœç­‰åŒäºå¼‚æ­¥é©±åŠ¨ï¼Œä½†ä»£ç æå…¶ç®€å•ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-18">äº”ã€ æ€»ç»“ä¸ Takeaway</h2>
<p>è¿™åœºå¯¹å†³æ²¡æœ‰ç»å¯¹çš„èµ¢å®¶ï¼Œåªæœ‰æœ€é€‚åˆçš„åœºæ™¯ã€‚</p>
<p><strong>æ ¸å¿ƒç»“è®ºï¼š</strong></p>
<ol>
<li><strong>å¦‚æœä½ æ˜¯çº¯ Java å›¢é˜Ÿ</strong>ï¼š<strong>æ— è„‘æ‹¥æŠ± Java 21 è™šæ‹Ÿçº¿ç¨‹</strong>ã€‚è¿™æ˜¯ Java æ—¢ç„¶ 8 ä¹‹åæœ€å¤§çš„çº¢åˆ©ã€‚å®ƒæŠ¹å¹³äº†åŒæ­¥å’Œå¼‚æ­¥çš„æ€§èƒ½é¸¿æ²Ÿï¼Œè®©ä½ å¯ä»¥ç”¨æœ€ç®€å•çš„ä»£ç å†™å‡ºæœ€é«˜æ€§èƒ½çš„æœåŠ¡ã€‚</li>
<li><strong>å¦‚æœä½ å·²ç»æ˜¯ Kotlin é‡åº¦ç”¨æˆ·</strong>ï¼š<strong>ç»§ç»­ä½¿ç”¨åç¨‹</strong>ã€‚Kotlin çš„ç»“æ„åŒ–å¹¶å‘ã€Flow æ•°æ®æµå¤„ç†ã€Channel é€šä¿¡æœºåˆ¶ï¼Œæä¾›äº†æ¯” Java æ›´é«˜çº§çš„æŠ½è±¡èƒ½åŠ›ã€‚è™šæ‹Ÿçº¿ç¨‹åªèƒ½æ›¿ä»£Â <code>launch</code>ï¼Œæ›¿ä»£ä¸äº†Â <code>Flow</code>ã€‚</li>
<li><strong>å¦‚æœä½ åœ¨åšé—ç•™ç³»ç»Ÿæ”¹é€ </strong>ï¼šJava 21 æ˜¯æ•‘æ˜Ÿã€‚åˆ«å»æŠ˜è…¾ WebFlux äº†ï¼ŒæŠŠ JDK å‡ä¸Šæ¥ï¼Œå¼€å¯è™šæ‹Ÿçº¿ç¨‹æ”¯æŒï¼Œè§£å†³æ‰Â <code>synchronized</code>Â çš„ Pinning é—®é¢˜ï¼Œä½ çš„ç³»ç»Ÿå°±èƒ½ç„•å‘ç¬¬äºŒæ˜¥ã€‚</li>
</ol>
<p><strong>æ¶æ„å¸ˆçš„å»ºè®® (Takeaway)</strong> ï¼š</p>
<blockquote>
<p><strong>ä¸è¦ä¸ºäº†æŠ€æœ¯è€ŒæŠ€æœ¯ã€‚</strong> Â è™šæ‹Ÿçº¿ç¨‹è§£å†³äº†â€œçº¿ç¨‹ä¸å¤Ÿç”¨â€çš„é—®é¢˜ï¼Œä½†æ²¡æœ‰è§£å†³â€œæ•°æ®åº“è¿æ¥æ± ä¸å¤Ÿç”¨â€çš„é—®é¢˜ã€‚ åœ¨é«˜å¹¶å‘æ¶æ„ä¸­ï¼Œ<strong>ç“¶é¢ˆå¾€å¾€ä¼šè½¬ç§»</strong>ã€‚å½“ä½ æŠŠåº”ç”¨å±‚çš„å¹¶å‘èƒ½åŠ›æå‡äº† 100 å€ï¼Œå‹åŠ›å°±ä¼šç¬é—´ä¼ å¯¼åˆ°æ•°æ®åº“å’Œä¸‹æ¸¸æœåŠ¡ã€‚ æ‰€ä»¥ï¼Œå‡çº§ Java 21 çš„åŒæ—¶ï¼Œè¯·åŠ¡å¿…åšå¥½<strong>é™æµï¼ˆRate Limitingï¼‰</strong> å’Œ<strong>ç†”æ–­ï¼ˆCircuit Breakingï¼‰</strong> ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å·²ç» Push åˆ°è¿œç¨‹çš„æäº¤ï¼Œå¦‚ä½•ä¿®æ”¹ Commit ä¿¡æ¯ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7602921143491248171</link>    <guid>https://juejin.cn/post/7602921143491248171</guid>    <pubDate>2026-02-05T06:58:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602921143491248171" data-draft-id="7602996277664120886" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å·²ç» Push åˆ°è¿œç¨‹çš„æäº¤ï¼Œå¦‚ä½•ä¿®æ”¹ Commit ä¿¡æ¯ï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-05T06:58:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="XuCoder"/> <meta itemprop="url" content="https://juejin.cn/user/948203954903908"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å·²ç» Push åˆ°è¿œç¨‹çš„æäº¤ï¼Œå¦‚ä½•ä¿®æ”¹ Commit ä¿¡æ¯ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/948203954903908/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    XuCoder
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:58:43.000Z" title="Thu Feb 05 2026 06:58:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ IDEA ä¸­å†™å®Œäº†æ–°å¢å„ç§å·¥å…·ç±»çš„ä»£ç ï¼Œå®Œæˆäº† Commit å’Œ Pushï¼Œä»£ç å·²ç»åˆ°äº† GitHubè¿œç¨‹ä»“åº“ã€‚</p>
<p>ç»§ç»­å†™ç€ä¸‹ä¸€ä¸ªåŠŸèƒ½çš„ä»£ç ï¼Œçªç„¶ï¼Œæˆ‘å‘ç°åˆšæ‰çš„Commit Messageå°‘å†™äº†ä¸€ä¸ªå·²ç»å®Œæˆçš„åŠŸèƒ½å®ç°ã€‚</p>
<p>æ­¤æ—¶ï¼Œæˆ‘çš„å·¥ä½œåŒºé‡Œå·²ç»æœ‰æ­£åœ¨ä¿®æ”¹ä½†æš‚æ—¶è¿˜ä¸æƒ³æäº¤çš„æ–‡ä»¶ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef4b0bcc989547e9ae651606e2bcffb1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWHVDb2Rlcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879526&amp;x-signature=QgSTjV0%2BKJe751ZSld%2FzWb%2BiYas%3D" alt="" loading="lazy"/></p>
<p>äºæ˜¯ï¼Œæˆ‘ä½¿ç”¨äº† IDEA çš„<strong>ä¿®æ­£æäº¤</strong>åŠŸèƒ½ï¼Œè¡¥å…¨äº†ä¿¡æ¯ï¼Œé‡æ–°ç‚¹å‡»äº† Commitï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c74dab738fe4f64bed0c8479e58e7a8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWHVDb2Rlcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879526&amp;x-signature=YVTuTVW48CBjH8LlI2FkuOzaaso%3D" alt="" loading="lazy"/></p>
<p>ä½†æ˜¯ï¼Œå½“æˆ‘å†æ¬¡ç‚¹å‡» <strong>Push</strong> æ—¶ï¼Œå‡ºç°äº†å¦‚ä¸‹æŠ¥é”™ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">error: failed to push some refs to <span class="hljs-string">'github.com:xxx/xxx.git'</span>
!	refs/heads/main:refs/heads/main	[rejected] (non-fast-forward)
hint: Updates were rejected because the tip of your current branch is behind
hint: its remote counterpart.
</code></pre>
<p>è¿™ä¸ªé”™è¯¯è¯´äººè¯å°±æ˜¯ï¼šæ¨é€åˆ°è¿œç¨‹è¢«æ‹’ç»äº†ï¼å¹¶ä¸”Git æç¤ºä½ éœ€è¦å…ˆ Pullã€‚</p>
<h3 data-id="heading-0">åŸå› åˆ†æ</h3>
<p><strong>è¿œç¨‹ä»“åº“</strong>ä¿å­˜ç€<strong>ä¿®æ”¹å‰</strong>çš„é‚£æ¬¡æäº¤ï¼Œæˆ‘ä»¬æŠŠå®ƒè®°ä¸º Commit Aï¼›</p>
<p><strong>æœ¬åœ°ä»“åº“</strong>åœ¨æˆ‘ä½¿ç”¨<strong>ä¿®æ­£</strong>åŠŸèƒ½æ—¶ï¼ŒGit å¹¶æ²¡æœ‰ç›´æ¥ä¿®æ”¹ Commit Aï¼Œè€Œæ˜¯<strong>æŠŠ Commit A æ‰”æ‰äº†ï¼Œç”Ÿæˆäº†ä¸€ä¸ªå…¨æ–°çš„ Commit Aâ€™</strong>ï¼Œè¿™ä¸ªæ–°çš„commitæœ‰ç€æ–°çš„ Hash å€¼ï¼Œæ–°çš„å¤‡æ³¨ã€‚</p>
<p>å½“æˆ‘ç‚¹å‡» Push æ—¶ï¼Œè¿œç¨‹ä»“åº“å‘ç°ç°åœ¨æ¨é€çš„ Commit Aâ€™ å’Œå·²æœ‰çš„ Commit A å¯¹ä¸ä¸Šï¼Œä¸ºäº†é˜²æ­¢è¦†ç›–ä»£ç ï¼ŒGit é»˜è®¤æ‹¦æˆªäº†è¿™æ¬¡æ¨é€ã€‚</p>
<h3 data-id="heading-1">è§£å†³æ–¹æ¡ˆ</h3>
<p>æœ¬æ¥æˆ‘æƒ³ä½¿ç”¨ IDEA çš„å›¾å½¢ç•Œé¢ï¼Œä½†æ˜¯ï¼Œå¼ºåˆ¶æ¨é€çš„æŒ‰é’®å±…ç„¶æ˜¯ç°è‰²çš„ï¼Œé€‰ä¸ä¸Šã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27633a510cd64e888900ccc40bff292a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWHVDb2Rlcg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879526&amp;x-signature=lLAfqGe86SPJjp13NXhPBzRXN3s%3D" alt="" loading="lazy"/></p>
<p>æ‰€æœ‰ï¼Œæˆ‘ä½¿ç”¨å‘½ä»¤è¡Œï¼Œåœ¨ IDEA ä¸‹æ–¹çš„ <strong>Terminal</strong> ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">git push -f origin main
</code></pre>
<p>ä¹‹åï¼Œå°±æ¨é€æˆåŠŸäº†ã€‚</p>
<h3 data-id="heading-2">å°è´´å£«</h3>
<ol>
<li>è¿™æ ·æ“ä½œåï¼ŒGitHub ä¸Šå¹¶ä¸ä¼šå¤šå‡ºä¸€æ¡è®°å½•ï¼ŒGitHub ä¸Šçš„è®°å½•ä¼š<strong>åŸåœ°åˆ·æ–°</strong>ã€‚æ—§çš„æäº¤ï¼ˆä¹Ÿå°±æ˜¯å°‘ä¿¡æ¯çš„é‚£ä¸ªï¼‰ä¼šè¢«å½»åº•åˆ é™¤ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä¿®æ”¹åçš„æ–°æäº¤ã€‚å†å²è®°å½•çœ‹èµ·æ¥éå¸¸å¹²å‡€ï¼Œå°±åƒä»æ¥æ²¡æœ‰çŠ¯è¿‡é”™ä¸€æ ·ã€‚</li>
<li>å·¥ä½œåŒºé‡Œé‚£ä¸ªå·²ä¿®æ”¹ä½†æ²¡å‹¾é€‰çš„æ–‡ä»¶ä¸ä¼šå—åˆ°ä»»ä½•å½±å“ï¼Œå¯ä»¥åœ¨ä¸‹ä¸€æ¬¡å‡†å¤‡å¥½æ—¶å†æäº¤ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[DNSéš§é“ï¼ˆè¯¦ç»†æ“ä½œï¼‰]]></title>    <link>https://juejin.cn/post/7602916406981623849</link>    <guid>https://juejin.cn/post/7602916406981623849</guid>    <pubDate>2026-02-05T06:43:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602916406981623849" data-draft-id="7602900131541270569" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="DNSéš§é“ï¼ˆè¯¦ç»†æ“ä½œï¼‰"/> <meta itemprop="keywords" content="é»‘å®¢"/> <meta itemprop="datePublished" content="2026-02-05T06:43:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å—ç“œä¸€æ—"/> <meta itemprop="url" content="https://juejin.cn/user/4496350807863529"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            DNSéš§é“ï¼ˆè¯¦ç»†æ“ä½œï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4496350807863529/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å—ç“œä¸€æ—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:43:53.000Z" title="Thu Feb 05 2026 06:43:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€åŸºæœ¬åŸç†ä»‹ç»</h2>
<p><strong>ã€DNSéš§é“ã€‘</strong>
DNSéš§é“æ”»å‡»ï¼ˆDNS Tunneling Attackï¼‰ æ˜¯ä¸€ç§åˆ©ç”¨ DNS åè®®æ¥è¿›è¡Œæ•°æ®ä¼ è¾“çš„æ”»å‡»æ–¹å¼ã€‚åœ¨è¿™ç§æ”»å‡»ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡ DNS è¯·æ±‚å’Œå“åº”é€šé“ï¼Œç»•è¿‡ä¼ ç»Ÿçš„ç½‘ç»œé˜²ç«å¢™å’Œå®‰å…¨è®¾å¤‡ï¼Œè¿›è¡Œæ•°æ®ä¼ è¾“ã€è¿œç¨‹æ§åˆ¶æˆ–è€…æ¸—é€æ”»å‡»ã€‚ç”±äº DNS é€šå¸¸è¢«ç”¨æ¥è¿›è¡ŒåŸŸåè§£æï¼Œå¾ˆå¤šç»„ç»‡çš„é˜²ç«å¢™å…è®¸ DNS æµé‡é€šè¿‡ï¼Œå› æ­¤æ”»å‡»è€…åˆ©ç”¨è¿™ä¸€ç‚¹éšè—æ¶æ„æµé‡ã€‚</p>
<p><strong>1. åŸºæœ¬åŸç†</strong>
DNS æ˜¯ä¸€ä¸ªç”¨äºå°†åŸŸåè½¬æ¢ä¸º IP åœ°å€çš„åè®®ï¼Œä½†å®ƒä¹Ÿå¯ä»¥è¢«æ»¥ç”¨ä¸ºæ•°æ®é€šé“ï¼Œæ”»å‡»è€…å°†ç½‘ç»œæ•°æ®åµŒå…¥åˆ° DNS è¯·æ±‚æˆ–å“åº”çš„åŸŸåä¸­ã€‚è¿™äº›æ•°æ®é€šè¿‡äº’è”ç½‘ä¸­çš„ DNS æœåŠ¡å™¨ä¼ è¾“ï¼Œæœ€ç»ˆåˆ°è¾¾æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼Œä»è€Œä½¿å¾—æ”»å‡»è€…èƒ½å¤Ÿç»•è¿‡é˜²ç«å¢™ã€‚
<strong>å·¥ä½œæµç¨‹ï¼š</strong>
æ•°æ®åµŒå…¥ï¼š æ”»å‡»è€…å°†æ¶æ„æ•°æ®æˆ–å‘½ä»¤åµŒå…¥åˆ° DNS æŸ¥è¯¢çš„å­åŸŸåéƒ¨åˆ†ï¼Œä¾‹å¦‚ï¼Œå°†æ•°æ®ç¼–ç æˆ base64 å¹¶ä½œä¸ºæŸ¥è¯¢è¯·æ±‚çš„åŸŸåå‘é€ã€‚ä¾‹å¦‚ï¼Œdata1.attackersite.com å¯èƒ½è¢«è½¬æ¢æˆ data1.base64encoding.attackersite.comï¼Œå°†æ•°æ®åµŒå…¥åŸŸåä¸­ã€‚</p>
<p>DNS æŸ¥è¯¢ï¼š å®¢æˆ·ç«¯å‘ DNS æœåŠ¡å™¨å‘èµ·æŸ¥è¯¢ï¼Œè¯·æ±‚è§£ææŸä¸ªåŸŸåã€‚åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼ŒDNS æœåŠ¡å™¨ä¼šè¿”å›è¯¥åŸŸåçš„ IP åœ°å€ã€‚</p>
<p>è½¬å‘åˆ°æ”»å‡»è€…ï¼š æ”»å‡»è€…è®¾ç½®è‡ªå·±çš„ DNS æœåŠ¡å™¨ï¼Œå°†æ¥æ”¶åˆ°çš„æŸ¥è¯¢æ•°æ®æå–å‡ºæ¥ï¼Œå¹¶ä»ä¸­æå–æ¶æ„æ•°æ®ã€‚æ”»å‡»è€…è¿˜å¯ä»¥å°†å“åº”æ•°æ®ï¼ˆä¾‹å¦‚ï¼šå‘½ä»¤æˆ–æ–‡ä»¶ï¼‰åµŒå…¥åˆ° DNS å“åº”åŒ…ä¸­ã€‚</p>
<p>æ•°æ®ä¼ è¾“ï¼š å®¢æˆ·ç«¯æ”¶åˆ° DNS å“åº”åï¼Œå°†åµŒå…¥å…¶ä¸­çš„æ”»å‡»è€…æ•°æ®æå–å‡ºæ¥ï¼Œä»è€Œå®ç°æ•°æ®çš„ä¸Šä¼ æˆ–ä¸‹è½½ã€‚</p>
<p><strong>2. æ”»å‡»ç›®æ ‡</strong></p>
<p>DNS éš§é“æ”»å‡»çš„ç›®æ ‡é€šå¸¸æ˜¯ç»•è¿‡é˜²ç«å¢™æˆ–å…¶ä»–å®‰å…¨è®¾å¤‡ã€‚å› ä¸ºå¤§å¤šæ•°é˜²ç«å¢™å¯¹ DNS æµé‡çš„æ£€æµ‹è¾ƒå°‘ï¼ŒDNS è¯·æ±‚å‡ ä¹æ€»æ˜¯è¢«å…è®¸é€šè¿‡ã€‚æ”»å‡»è€…é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ©ç”¨è¿™ä¸€ç‚¹ï¼š</p>
<p>æ•°æ® exfiltrationï¼ˆæ•°æ®å¤–æ³„ï¼‰ï¼š å°†æ•æ„Ÿä¿¡æ¯ä»å—å®³ç½‘ç»œä¸­ä¼ é€’åˆ°æ”»å‡»è€…çš„æ§åˆ¶æœåŠ¡å™¨ã€‚</p>
<p>è¿œç¨‹æ§åˆ¶ï¼š é€šè¿‡ DNS éš§é“å‘é€å‘½ä»¤å’Œæ¥æ”¶ç»“æœï¼Œæ§åˆ¶è¢«æ„ŸæŸ“çš„ç³»ç»Ÿã€‚</p>
<p>ç»•è¿‡å®‰å…¨æ£€æµ‹ï¼š å°†æ¶æ„æµé‡åŒ…è£…åœ¨çœ‹ä¼¼æ­£å¸¸çš„ DNS æŸ¥è¯¢ä¸­ï¼Œèº²é¿ä¼ ç»Ÿé˜²ç«å¢™å’Œå…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼ˆIDSï¼‰çš„æ£€æµ‹ã€‚</p>
<p><strong>3. æ”»å‡»çš„å®é™…åº”ç”¨</strong></p>
<p>DNS éš§é“æ”»å‡»ä¸ä»…ä»…æ˜¯æ¶æ„è½¯ä»¶æˆ–é»‘å®¢æ”»å‡»çš„ä¸€éƒ¨åˆ†ï¼Œè¿˜å¯ç”¨äºï¼š</p>
<p>ç»•è¿‡ä¼ä¸šé˜²ç«å¢™ï¼šä¼ä¸šé˜²ç«å¢™å¯èƒ½ä¼šé˜»æ­¢ HTTPã€HTTPS æˆ–å…¶ä»–åè®®çš„æµé‡ï¼Œä½†å®ƒä»¬å¾€å¾€å¯¹ DNS æµé‡ä¸ä½œç‰¹åˆ«é™åˆ¶ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ç»•è¿‡é˜²ç«å¢™ã€‚</p>
<p>ç½‘ç»œæ¸—é€ï¼šæ”»å‡»è€…é€šè¿‡ DNS éš§é“åœ¨è¢«æ”»å‡»ç³»ç»Ÿä¸å¤–éƒ¨çš„æ¶æ„æœåŠ¡å™¨ä¹‹é—´å»ºç«‹éšè”½çš„é€šä¿¡é€šé“ï¼Œä»è€Œé¿å…è¢«æ£€æµ‹ã€‚</p>
<p>æ•°æ®å¤–æ³„ï¼šé€šè¿‡ DNS éš§é“ï¼Œæ”»å‡»è€…å¯ä»¥å°†å†…éƒ¨æ•°æ®é€æ­¥åœ°é€šè¿‡ DNS è¯·æ±‚å‘é€åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œé¿å…ä¼ ç»Ÿçš„æ•°æ®æ³„éœ²æ£€æµ‹ç³»ç»Ÿã€‚</p>
<p><strong>4. é˜²èŒƒå’Œæ£€æµ‹æ–¹æ³•</strong></p>
<ol>
<li>DNS æµé‡ç›‘æ§</li>
</ol>
<p>æ£€æµ‹å¼‚å¸¸çš„ DNS æŸ¥è¯¢ï¼š DNS éš§é“æ”»å‡»å¾€å¾€ä¼šç”Ÿæˆå¤§é‡çš„ DNS è¯·æ±‚ï¼Œè¿™äº›è¯·æ±‚çš„åŸŸåé€šå¸¸è¾ƒé•¿ï¼Œå¹¶ä¸”é¢‘ç¹å‡ºç°ç›¸ä¼¼çš„æ¨¡å¼ã€‚é€šè¿‡ç›‘æ§ DNS æŸ¥è¯¢ï¼Œå¯ä»¥å‘ç°å¼‚å¸¸æµé‡ã€‚</p>
<p>æ£€æŸ¥é•¿åŸŸåæˆ–ä¸å¸¸è§çš„å­—ç¬¦ï¼šé€šè¿‡åˆ†æ DNS è¯·æ±‚çš„é•¿åº¦å’Œæ¨¡å¼ï¼Œå¯ä»¥è¯†åˆ«å‡ºè¢«ç”¨äº DNS éš§é“çš„å¯ç–‘è¯·æ±‚ã€‚</p>
<ol start="2">
<li>DNS ç­–ç•¥</li>
</ol>
<p>é™åˆ¶å¤–éƒ¨ DNS æœåŠ¡å™¨è®¿é—®ï¼šç»„ç»‡å¯ä»¥é…ç½®é˜²ç«å¢™æˆ–è·¯ç”±å™¨ï¼Œåªå…è®¸ç‰¹å®šçš„ DNS æœåŠ¡å™¨è¿›è¡Œè§£æï¼Œä»è€Œé˜²æ­¢æ”»å‡»è€…ä½¿ç”¨è‡ªå®šä¹‰çš„ DNS æœåŠ¡å™¨è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚</p>
<p>DNS over HTTPSï¼ˆDoHï¼‰å’Œ DNS over TLSï¼ˆDoTï¼‰ï¼šåŠ å¯†çš„ DNS åè®®å¯ä»¥é˜²æ­¢ DNS è¯·æ±‚è¢«çªƒå¬æˆ–ç¯¡æ”¹ï¼Œä½†ä»ç„¶æ— æ³•å®Œå…¨é˜»æ­¢ DNS éš§é“æ”»å‡»ã€‚å¦‚æœåŒæ—¶åŠ å¯† DNS è¯·æ±‚å¹¶åŠ ä»¥è¿‡æ»¤ï¼Œå¯ä»¥å¢åŠ é˜²èŒƒçš„éš¾åº¦ã€‚</p>
<ol start="3">
<li>DPIï¼ˆæ·±åº¦åŒ…æ£€æµ‹ï¼‰</li>
</ol>
<p>æ·±åº¦åŒ…æ£€æµ‹ï¼šä¸€äº›å…ˆè¿›çš„é˜²ç«å¢™å’Œå…¥ä¾µæ£€æµ‹ç³»ç»Ÿå¯ä»¥æ‰§è¡Œæ·±åº¦åŒ…æ£€æµ‹ï¼Œåˆ†æ DNS æµé‡ä¸­çš„å†…å®¹ï¼Œè¯†åˆ«å‡ºå¯èƒ½éšè—çš„æ•°æ®æµã€‚</p>
<ol start="4">
<li>é¢‘ç¹æ£€æµ‹å’Œå“åº”</li>
</ol>
<p>DNS è¯·æ±‚é€Ÿç‡ï¼šå¼‚å¸¸çš„ DNS è¯·æ±‚é€Ÿç‡å¯èƒ½æ˜¯ DNS éš§é“æ´»åŠ¨çš„è¿¹è±¡ã€‚é€šè¿‡è®¾ç½®é˜ˆå€¼æ¥æ£€æµ‹çªå‘æµé‡ï¼Œå¯ä»¥åŠæ—¶å‘ç°æ½œåœ¨çš„éš§é“æ”»å‡»ã€‚</p>
<ol start="5">
<li>è®¿é—®æ§åˆ¶å’Œç­–ç•¥</li>
</ol>
<p>æ§åˆ¶ DNS æŸ¥è¯¢ï¼šé€šè¿‡ç­–ç•¥é™åˆ¶æŸäº› DNS æŸ¥è¯¢æ“ä½œï¼ˆå¦‚ä¸å…è®¸ç‰¹å®šç±»å‹çš„å­åŸŸåè§£æï¼‰ï¼Œå¯ä»¥å‡å°‘ DNS éš§é“çš„æˆåŠŸç‡ã€‚</p>
<p>æ•°æ®åŠ å¯†ï¼šå¯¹ä¼ è¾“æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œé˜²æ­¢æ•æ„Ÿä¿¡æ¯é€šè¿‡ DNS éš§é“æ³„éœ²ã€‚</p>
<p><strong>5. å·¥å…·å’ŒæŠ€æœ¯</strong></p>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ DNS éš§é“æ”»å‡»å·¥å…·ï¼š</p>
<p>Iodineï¼šä¸€ä¸ªå¸¸ç”¨çš„ DNS éš§é“å·¥å…·ï¼Œå®ƒæ”¯æŒåœ¨ DNS æŸ¥è¯¢ä¸­åµŒå…¥ IP æµé‡ï¼Œå®ç°éš§é“é€šä¿¡ã€‚</p>
<p>DNSCat2ï¼šå¦ä¸€ä¸ªå¸¸è§çš„ DNS éš§é“å·¥å…·ï¼Œèƒ½å¤Ÿé€šè¿‡ DNS é€šé“ä¼ è¾“æ•°æ®ã€‚</p>
<p>DNScapyï¼šä¸€ä¸ªåŸºäº Python çš„ DNS éš§é“å·¥å…·ï¼Œå¯ä»¥é€šè¿‡ DNS é€šé“è¿›è¡Œæ•°æ®äº¤æ¢ã€‚</p>
<h2 data-id="heading-1">äºŒã€ä½¿ç”¨Iodineè¿›è¡ŒDNSéš§é“</h2>
<h3 data-id="heading-2">a. çœŸå®æ”»å‡»çš„æ‹“æ‰‘å›¾</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7ede7a86a99e41a1bf588b80e623f113~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2X55Oc5LiA5peP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879016&amp;x-signature=cNtPCgCzH9mlQO5OdTrg2ssZxp4%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">b.å‰æœŸå‡†å¤‡æ¸…å•</h3>






























<table><thead><tr><th align="left">é¡¹ç›®</th><th align="left">è¦æ±‚</th><th align="left">ç”¨é€”</th></tr></thead><tbody><tr><td align="left"><strong>å…¬ç½‘ VPS</strong></td><td align="left">1å°ï¼Œå…¬ç½‘IPï¼ˆå¦‚ 1.2.3.4ï¼‰ï¼Œå¼€æ”¾ UDP 53</td><td align="left">è¿è¡Œ iodined æœåŠ¡ç«¯</td></tr><tr><td align="left"><strong>åŸŸå</strong></td><td align="left">1ä¸ªï¼ˆæ¨èÂ <code>.shop</code>Â <code>.xyz</code>Â <code>.top</code>Â ä¾¿å®œåŸŸåï¼‰</td><td align="left">DNS éš§é“ä¼ªè£…</td></tr><tr><td align="left"><strong>æ”»å‡»æœº</strong></td><td align="left">1å°ï¼ˆå¯ä»¥æ˜¯æœåŠ¡ç«¯åŒä¸€å°ï¼‰</td><td align="left">SSH è¿æ¥éš§é“</td></tr><tr><td align="left"><strong>ç›®æ ‡æœº</strong></td><td align="left">1å°ï¼ˆæµ‹è¯•ç”¨ï¼Œä»…å…è®¸ DNS å‡ºç½‘ï¼‰</td><td align="left">è¿è¡Œ iodine å®¢æˆ·ç«¯</td></tr></tbody></table>
<p>è´­ä¹°å¥½åŸŸååï¼Œå°†å…¶IPæŒ‡å®šæ”»å‡»æœåŠ¡å™¨ï¼ˆè¿è¡ŒiodinedæœåŠ¡ç«¯çš„å…¬ç½‘IPï¼‰
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b212844099054f3cb7f65cf59fc5291e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2X55Oc5LiA5peP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879016&amp;x-signature=8DNuudJTz%2BixvAFsyGqW%2Fm%2Bn4gM%3D" alt="image.png" loading="lazy"/></p>
<p><strong>é…ç½®å®Œæˆåæ•ˆæœï¼š</strong></p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">éªŒè¯ NS è®°å½•æ˜¯å¦ç”Ÿæ•ˆï¼ˆå…¨çƒåŒæ­¥éœ€ 5-30 åˆ†é’Ÿï¼‰</span>
<span class="hljs-meta prompt_">$ </span><span class="bash">nslookup -<span class="hljs-built_in">type</span>=NS kennylin.shop</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">åº”è¯¥è¿”å›ï¼š</span>
<span class="hljs-meta prompt_"># </span><span class="bash">kennylin.shop   nameserver = ns1.kennylin.shop</span>
<span class="hljs-meta prompt_"># </span><span class="bash">kennylin.shop   nameserver = ns2.kennylin.shop</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">éªŒè¯ ns1 çš„ IP</span>
<span class="hljs-meta prompt_">$ </span><span class="bash">nslookup ns1.kennylin.shop</span>
<span class="hljs-meta prompt_"># </span><span class="bash">Address: 1.2.3.4</span>
</code></pre>
<h3 data-id="heading-4">cã€VPS æœåŠ¡ç«¯éƒ¨ç½²ï¼ˆiodinedï¼‰</h3>
<h4 data-id="heading-5">Step 1ï¼šå‡†å¤‡ VPS ç¯å¢ƒ</h4>
<p><strong>è¦æ±‚ï¼š</strong></p>
<ul>
<li>Ubuntu 20.04/22.04 / CentOS 7/8</li>
<li>å…¬ç½‘ IPï¼šå‡è®¾ä¸º <code>1.2.3.4</code></li>
<li>é˜²ç«å¢™å¼€æ”¾ <strong>UDP 53 ç«¯å£</strong></li>
</ul>
<p><strong>è´­ä¹°æ¨èï¼š</strong></p>
<ul>
<li>Vultr / DigitalOcean / AWS Lightsail / é˜¿é‡Œäº‘ ECS</li>
<li>é…ç½®ï¼š1æ ¸1G è¶³å¤Ÿï¼Œæœˆæµé‡ 1TB å·¦å³</li>
</ul>
<hr/>
<h4 data-id="heading-6">Step 2ï¼šè¿æ¥ VPS å¹¶å®‰è£… iodine</h4>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># SSH ç™»å½•ä½ çš„ VPS</span>
ssh root@1.<span class="hljs-number">2.3</span>.<span class="hljs-number">4</span>

<span class="hljs-comment"># æ›´æ–°ç³»ç»Ÿï¼ˆUbuntu/Debianï¼‰</span>
apt update &amp;&amp; apt upgrade -<span class="hljs-keyword">y</span>

<span class="hljs-comment"># å®‰è£… iodine</span>
apt install iodine -<span class="hljs-keyword">y</span>

<span class="hljs-comment"># CentOS/RHEL å®‰è£…æ–¹å¼ï¼š</span>
<span class="hljs-comment"># yum install epel-release -y</span>
<span class="hljs-comment"># yum install iodine -y</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dbb1ccdd3ad941f9b2afb7400b27d9c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2X55Oc5LiA5peP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879016&amp;x-signature=GoJ3IJ0tsSW309Eb%2FWyxWMhQKrg%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-7">Step 3ï¼šå¯åŠ¨ iodined æœåŠ¡ç«¯</h4>
<pre><code class="hljs language-r" lang="r"><span class="hljs-comment"># åˆ›å»ºè™šæ‹Ÿç½‘å¡ dns0ï¼Œåˆ†é…éš§é“ç½‘æ®µ 192.168.200.0/24</span>
<span class="hljs-comment"># æœåŠ¡ç«¯ IP: 192.168.200.1</span>
<span class="hljs-comment"># å®¢æˆ·ç«¯ IP: 192.168.200.2ï¼ˆè‡ªåŠ¨åˆ†é…ï¼‰</span>

<span class="hljs-comment"># iodined -f -c -P Kenny123 -d dns0 192.168.200.1 ns.kennylin.shop</span>
iodined <span class="hljs-operator">-</span>f <span class="hljs-operator">-</span><span class="hljs-built_in">c</span> <span class="hljs-operator">-</span>P Kenny123Â  <span class="hljs-number">192.168</span>.200.1 ns.kennylin.shop <span class="hljs-operator">-</span>DD

<span class="hljs-comment"># å‚æ•°è¯´æ˜ï¼š</span>
<span class="hljs-comment"># -f      å‰å°è¿è¡Œï¼ˆè°ƒè¯•æ—¶ï¼Œåå°è¿è¡Œå»æ‰ -fï¼‰</span>
<span class="hljs-comment"># -c      ç¦æ­¢æ£€æŸ¥å®¢æˆ·ç«¯ IPï¼ˆå…è®¸å¤šä¸ªå®¢æˆ·ç«¯æˆ– NAT ç¯å¢ƒï¼‰</span>
<span class="hljs-comment"># -P      è®¤è¯å¯†ç ï¼ˆå®¢æˆ·ç«¯å¿…é¡»ä¸€è‡´ï¼‰</span>
<span class="hljs-comment"># -d dns0 åˆ›å»ºè™šæ‹Ÿç½‘å¡ dns0</span>
<span class="hljs-comment"># 192.168.200.1  æœåŠ¡ç«¯éš§é“ IP</span>
<span class="hljs-comment"># ns.kennylin.shop  ä½ çš„åŸŸå</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7c66a6f938745f2a04807e3b11a4a9d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2X55Oc5LiA5peP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879016&amp;x-signature=00CLzt6Q0MokMbNOZCGkxvAa7Mo%3D" alt="image.png" loading="lazy"/></p>
<p><strong>åå°è¿è¡Œæ–¹å¼ï¼ˆæ¨è--å¯è·³è¿‡è¿™ä¸ªæ“ä½œï¼‰ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ä½¿ç”¨ nohup æˆ– screen</span>
nohup iodined -c -P Kenny123 -d dns0 192.168.200.1 ns.kennylin.shop &gt; /var/log/iodined.log 2&gt;&amp;1 &amp;

<span class="hljs-comment"># æˆ– systemd æœåŠ¡ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰</span>
cat &gt; /etc/systemd/system/iodined.service &lt;&lt; 'EOF'
<span class="hljs-section">[Unit]</span>
<span class="hljs-attr">Description</span>=Iodine DNS Tunnel Server
<span class="hljs-attr">After</span>=network.target

<span class="hljs-section">[Service]</span>
<span class="hljs-attr">Type</span>=simple
<span class="hljs-attr">ExecStart</span>=/usr/bin/iodined -c -P Kenny123 -d dns0 <span class="hljs-number">192.168</span>.<span class="hljs-number">200.1</span> ns.kennylin.shop
<span class="hljs-attr">Restart</span>=always

<span class="hljs-section">[Install]</span>
<span class="hljs-attr">WantedBy</span>=multi-user.target
EOF

systemctl daemon-reload
systemctl enable iodined
systemctl start iodined
systemctl status iodined
</code></pre>
<hr/>
<h4 data-id="heading-8">Step 4ï¼šéªŒè¯æœåŠ¡ç«¯è¿è¡Œï¼ˆæ–°å»ºä¸€ä¸ªä¼šè¯çª—å£ï¼‰</h4>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># æŸ¥çœ‹è¿›ç¨‹</span>
ps aux | <span class="hljs-keyword">grep</span> iodine

<span class="hljs-comment"># æŸ¥çœ‹ç½‘å¡</span>
ip addr show dns<span class="hljs-number">0</span>
<span class="hljs-comment"># åº”è¯¥æ˜¾ç¤ºï¼š192.168.200.1</span>

<span class="hljs-comment"># æŸ¥çœ‹ç›‘å¬ç«¯å£</span>
ss -tunlp | <span class="hljs-keyword">grep</span> iodine
<span class="hljs-comment"># udp 0.0.0.0:53</span>

<span class="hljs-comment"># æµ‹è¯•æœ¬åœ° DNS è§£æ</span>
dig @127.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span> test.ns.kennylin.shop
<span class="hljs-comment"># åº”è¯¥è¿”å› iodine çš„å“åº”ï¼ˆä¸ä¸€å®šæ˜¯çœŸå®IPï¼Œä½†ä¼šå“åº”ï¼‰</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f872a7f84ae46a2ac96ab80e369b524~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2X55Oc5LiA5peP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879016&amp;x-signature=PpaiMmtM8PGXq0bzD6xxWwmeVmE%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6024fcbf11dd4a0c82e3cc4949e49dd0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2X55Oc5LiA5peP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879016&amp;x-signature=vnPkT1vt%2FnsfTUrYhIsnrq5u8Yo%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-9">dã€ç›®æ ‡æœºï¼ˆå®¢æˆ·ç«¯ï¼‰éƒ¨ç½²</h3>
<h4 data-id="heading-10">Step 1ï¼šå‡†å¤‡ç›®æ ‡ç¯å¢ƒ</h4>
<p><strong>æ¨¡æ‹Ÿåœºæ™¯ï¼š</strong> ä¸€å°åªèƒ½è§£æ DNSã€æ— æ³•ç›´æ¥å‡ºç½‘çš„æœºå™¨</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£… iodine å®¢æˆ·ç«¯ï¼ˆUbuntu/Debianï¼‰</span>
apt install iodine -y

<span class="hljs-comment"># CentOS</span>
yum install iodine -y
</code></pre>
<hr/>
<h4 data-id="heading-11">Step 2ï¼šè¿æ¥ DNS éš§é“</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹æ³• 1ï¼šè‡ªåŠ¨è¿­ä»£è§£æï¼ˆæ¨èï¼Œæ— éœ€æŒ‡å®š DNSï¼‰</span>
iodine -f -P Kenny123 ns.kennylin.shop

<span class="hljs-comment"># æ–¹æ³• 2ï¼šå¼ºåˆ¶é€šè¿‡ç‰¹å®š DNS æœåŠ¡å™¨ï¼ˆä½ ä¹‹å‰ç”¨çš„æ–¹å¼ï¼Œå¯èƒ½ä¸ç¨³å®šï¼‰--å»ºè®®ä½¿ç”¨è¿™ä¸ª</span>
iodine -f -r -P Kenny123 223.5.5.5 ns.kennylin.shop

<span class="hljs-comment"># å‚æ•°è¯´æ˜ï¼š</span>
<span class="hljs-comment"># -f      å‰å°è¿è¡Œ</span>
<span class="hljs-comment"># -P      å¯†ç ï¼ˆå¿…é¡»ä¸æœåŠ¡ç«¯ä¸€è‡´ï¼‰</span>
<span class="hljs-comment"># -r      é€’å½’æ¨¡å¼ï¼Œå¼ºåˆ¶é€šè¿‡æŒ‡å®š DNS æŸ¥è¯¢</span>
<span class="hljs-comment"># 223.5.5.5  æŒ‡å®šçš„ DNS æœåŠ¡å™¨ï¼ˆå¯é€‰ï¼Œä¸ç¨³å®šï¼‰</span>
<span class="hljs-comment"># ns.kennylin.shop  åŸŸå</span>
</code></pre>
<h2 data-id="heading-12">ğŸ“‹ iodine å‘½ä»¤å‚æ•°è§£æ</h2>
<p>bash</p>
<p>å¤åˆ¶</p>
<pre><code class="hljs language-css" lang="css">iodine -f -r -<span class="hljs-selector-tag">P</span> Kenny123 <span class="hljs-number">223.5</span>.<span class="hljs-number">5.5</span> ns<span class="hljs-selector-class">.kennylin</span><span class="hljs-selector-class">.shop</span>
</code></pre>
<p>è¡¨æ ¼</p>
<p>å¤åˆ¶</p>

































<table><thead><tr><th align="left">å‚æ•°</th><th align="left">å«ä¹‰</th></tr></thead><tbody><tr><td align="left"><code>-f</code></td><td align="left">å‰å°è¿è¡Œï¼ˆä¸å®ˆæŠ¤è¿›ç¨‹åŒ–ï¼‰</td></tr><tr><td align="left"><code>-r</code></td><td align="left"><strong>å¼ºåˆ¶é€šè¿‡æŒ‡å®š DNS æœåŠ¡å™¨æŸ¥è¯¢</strong>ï¼ˆrecursive modeï¼Œé€’å½’æ¨¡å¼ï¼‰</td></tr><tr><td align="left"><code>-P Kenny123</code></td><td align="left">è®¤è¯å¯†ç </td></tr><tr><td align="left"><code>223.5.5.5</code></td><td align="left"><strong>ä¸Šæ¸¸ DNS æœåŠ¡å™¨çš„ IP åœ°å€</strong>ï¼ˆè¿™é‡Œæ˜¯é˜¿é‡Œäº‘ DNSï¼‰</td></tr><tr><td align="left"><code>ns.kennylin.shop</code></td><td align="left"><strong>iodine æœåŠ¡ç«¯åŸŸåçš„å‰ç¼€</strong>ï¼Œå®Œæ•´çš„æŸ¥è¯¢åŸŸåä¼šæ˜¯Â <code>xxx.ns.kennylin.shop</code></td></tr><tr><td align="left"><strong>è¿æ¥æˆåŠŸæ ‡å¿—ï¼š</strong></td><td align="left"/></tr></tbody></table>
<pre><code class="hljs language-sql" lang="sql">Opened dns0
Version ok, <span class="hljs-keyword">both</span> <span class="hljs-keyword">using</span> protocol v <span class="hljs-number">0x00000502</span>. You <span class="hljs-keyword">are</span> <span class="hljs-keyword">user</span> #<span class="hljs-number">0</span>
Setting IP <span class="hljs-keyword">of</span> dns0 <span class="hljs-keyword">to</span> <span class="hljs-number">192.168</span><span class="hljs-number">.200</span><span class="hljs-number">.2</span>
Server tunnel IP <span class="hljs-keyword">is</span> <span class="hljs-number">192.168</span><span class="hljs-number">.200</span><span class="hljs-number">.1</span>
Connection setup complete, transmitting data.
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c14b96d9ad05429f81230364bf8b1e65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2X55Oc5LiA5peP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879016&amp;x-signature=mQgYbx0IpE%2FjhWoVj17kvAJ8uv0%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-13">eã€æ”»å‡»æœºè¿æ¥éš§é“</h3>
<h4 data-id="heading-14">Step 1ï¼šSSH é€šè¿‡éš§é“è¿æ¥</h4>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># åœ¨æ”»å‡»æœºä¸Šï¼ˆå¯ä»¥æ˜¯æœåŠ¡ç«¯åŒä¸€å°æœºå™¨ï¼‰</span>
<span class="hljs-comment"># ç›´æ¥è¿æ¥å®¢æˆ·ç«¯çš„éš§é“ IP</span>
ssh root@192.<span class="hljs-number">168.200</span>.<span class="hljs-number">2</span>

<span class="hljs-comment"># æˆ–è€…å¦‚æœå®¢æˆ·ç«¯è¿è¡Œäº† SSH æœåŠ¡ï¼š</span>
ssh -p <span class="hljs-number">22</span> user@192.<span class="hljs-number">168.200</span>.<span class="hljs-number">2</span>
</code></pre>
<p><strong>å¦‚æœiodineæœåŠ¡å™¨å’Œæ”»å‡»æœºæ˜¯åŒä¸€å°ï¼š</strong></p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># æœåŠ¡ç«¯å·²ç»æœ‰ dns0 ç½‘å¡ 192.168.200.1</span>
<span class="hljs-comment"># ç›´æ¥è®¿é—®å®¢æˆ·ç«¯ 192.168.200.2</span>

<span class="hljs-comment"># æµ‹è¯•è¿é€šæ€§</span>
ping <span class="hljs-number">192.168</span>.<span class="hljs-number">200.2</span>

<span class="hljs-comment"># SSH è¿æ¥</span>
ssh root@192.<span class="hljs-number">168.200</span>.<span class="hljs-number">2</span>
</code></pre>
<p>ä¸Šé¢æˆåŠŸåœ¨æ”»å‡»ç”µè„‘ä¸­ç›´æ¥SSHç™»å½•åˆ°å¦ä¸€å°</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ddab3525f6e449a9005cadc914e2aa4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2X55Oc5LiA5peP:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879016&amp;x-signature=vwrNI73P5KYzPb4BX%2Ffb1PqqjYs%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h4 data-id="heading-15">Step 2ï¼šç«¯å£è½¬å‘ï¼ˆé«˜çº§ç”¨æ³•ï¼‰</h4>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># é€šè¿‡éš§é“è½¬å‘ç«¯å£</span>
<span class="hljs-comment"># å®¢æˆ·ç«¯è¿è¡Œï¼šå°†æœ¬åœ° 8080 è½¬å‘åˆ°æœåŠ¡ç«¯</span>
iodine ... -L <span class="hljs-number">8080</span><span class="hljs-symbol">:localhost</span><span class="hljs-symbol">:</span><span class="hljs-number">80</span>

<span class="hljs-comment"># æˆ–è€…ä½¿ç”¨ SSH åŠ¨æ€ä»£ç†</span>
ssh -D <span class="hljs-number">1080</span> root<span class="hljs-variable">@192</span>.<span class="hljs-number">168.200</span>.<span class="hljs-number">2</span>
<span class="hljs-comment"># ç„¶åæµè§ˆå™¨è®¾ç½® SOCKS5 ä»£ç† 127.0.0.1:1080</span>
</code></pre>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€å‘ä½æé†’ã€‘Flutter é¸¿è’™å¼€å‘ï¼šMac è·‘å¾—å¥½å¥½çš„ï¼ŒWindows æŠ¥ Git ä¾èµ–ç‰ˆæœ¬é”™è¯¯ï¼ŸåŠå¤©å¿ƒè¡€æ€»ç»“å‡ºçš„çœŸç›¸ï¼]]></title>    <link>https://juejin.cn/post/7602936997175132212</link>    <guid>https://juejin.cn/post/7602936997175132212</guid>    <pubDate>2026-02-05T07:00:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602936997175132212" data-draft-id="7602901195154440244" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€å‘ä½æé†’ã€‘Flutter é¸¿è’™å¼€å‘ï¼šMac è·‘å¾—å¥½å¥½çš„ï¼ŒWindows æŠ¥ Git ä¾èµ–ç‰ˆæœ¬é”™è¯¯ï¼ŸåŠå¤©å¿ƒè¡€æ€»ç»“å‡ºçš„çœŸç›¸ï¼"/> <meta itemprop="keywords" content="Flutter,HarmonyOS"/> <meta itemprop="datePublished" content="2026-02-05T07:00:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æµ…è“è‰²"/> <meta itemprop="url" content="https://juejin.cn/user/1919072243027988"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€å‘ä½æé†’ã€‘Flutter é¸¿è’™å¼€å‘ï¼šMac è·‘å¾—å¥½å¥½çš„ï¼ŒWindows æŠ¥ Git ä¾èµ–ç‰ˆæœ¬é”™è¯¯ï¼ŸåŠå¤©å¿ƒè¡€æ€»ç»“å‡ºçš„çœŸç›¸ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1919072243027988/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æµ…è“è‰²
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T07:00:26.000Z" title="Thu Feb 05 2026 07:00:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>åœ¨è¿›è¡Œ Flutter é¸¿è’™å¼€å‘æ—¶ï¼Œç”±äºå¾ˆå¤šæ’ä»¶ï¼ˆå¦‚ <code>image_picker</code>, <code>file_selector</code>ï¼‰éœ€è¦å¼•ç”¨åä¸ºæˆ– SIG ç»´æŠ¤çš„ç‰¹å®šåˆ†æ”¯ã€‚ä½ å¯èƒ½ä¼šé‡åˆ°ä¸€ä¸ªæå…¶ç¦»è°±çš„ç°è±¡ï¼š<strong>åŒä¸€ä¸ªé¡¹ç›®ä»£ç ï¼Œä¹‹å‰åœ¨ Mac ä¸Š <code>flutter pub get</code> ç§’è¿‡ï¼Œåœ¨ Windows ä¸Šå´æ­»æ´»æŠ¥é”™ï¼š</strong></p>
<p><code>ERR: Package not available (the pubspec for image_picker 1.1.2 from git has version 1.0.2).</code></p>
<p>æ˜æ˜ Git ä»“åº“é‡Œç‰ˆæœ¬æ˜¯å¯¹çš„ï¼Œä¸ºä»€ä¹ˆ Windows å›ºæ‰§åœ°è®¤ä¸ºå®ƒæ˜¯æ—§ç‰ˆæœ¬ï¼Ÿæœ¬æ–‡å¸¦ä½ ä¸€åˆ†é’Ÿè·³å‘ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€ ç°è±¡æè¿°</h3>
<p>åœ¨ <code>pubspec.yaml</code> ä¸­é…ç½®äº†å¦‚ä¸‹ä¾èµ–ï¼š</p>
<p>YAML</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">image_picker:</span>
  <span class="hljs-attr">git:</span>
    <span class="hljs-attr">url:</span> <span class="hljs-string">https://gitcode.com/openharmony-sig/flutter_packages.git</span>
    <span class="hljs-attr">path:</span> <span class="hljs-string">packages/image_picker/image_picker</span>
    <span class="hljs-attr">ref:</span> <span class="hljs-string">br_image_picker-v1.1.2_ohos</span>  <span class="hljs-comment"># æ˜ç¡®æŒ‡å‘ 1.1.2 ç‰ˆæœ¬</span>
</code></pre>
<p><strong>æŠ¥é”™ä¿¡æ¯ï¼š</strong></p>
<blockquote>
<p><code>Package not available (the pubspec for image_picker 1.1.2 from git has version 1.0.2).</code></p>
</blockquote>
<p>ä½ å»æµè§ˆå™¨é‡Œç¿»openharmony-sigçš„æºç ï¼Œæ˜æ˜br_image_picker-v1.1.2_ohosçš„ç‰ˆæœ¬å·å°±æ˜¯ <code>1.1.2</code>ã€‚ä½ ç”šè‡³æ€€ç–‘æ˜¯ä¸æ˜¯ GitCode æŒ‚äº†ï¼Œæˆ–è€…æ˜¯è‡ªå·±çœ¼ç›èŠ±äº†ã€‚</p>
<hr/>
<h3 data-id="heading-2">äºŒã€ å¹•åçœŸå‡¶ï¼šWindows çš„â€œé•¿è·¯å¾„é™åˆ¶â€</h3>
<p>è¿™å…¶å®ä¸æ˜¯ Flutter çš„ Bugï¼Œä¹Ÿä¸æ˜¯ Git çš„ Bugï¼Œè€Œæ˜¯ <strong>Windows æ–‡ä»¶ç³»ç»Ÿé»˜è®¤é™åˆ¶ï¼ˆMAX_PATH: 260å­—ç¬¦ï¼‰</strong> ä¸ <strong>Git é™é»˜å¤±è´¥</strong> å…±åŒé…¿æˆçš„æƒ¨å‰§ã€‚</p>
<h4 data-id="heading-3">1. è·¯å¾„å¤ªæ·±äº†</h4>
<p>Flutter åœ¨ç¼“å­˜ Git ä¾èµ–æ—¶ï¼Œè·¯å¾„ææ·±ï¼š</p>
<p><code>C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Local\Pub\Cache\git\flutter_packages-xxxx\packages\image_picker\image_picker\pubspec.yaml</code></p>
<p>è¿™ä¸ªè·¯å¾„è½»è½»æ¾æ¾å°±ä¼šçªç ´ 260 ä¸ªå­—ç¬¦ã€‚</p>
<h4 data-id="heading-4">2. Git çš„â€œæ‘†çƒ‚â€è¡Œä¸º</h4>
<p>å½“è·¯å¾„è¶…è¿‡é™åˆ¶æ—¶ï¼ŒWindows ç‰ˆ Git åœ¨æ‰§è¡Œ <code>checkout</code>ï¼ˆåˆ‡æ¢åˆ†æ”¯ï¼‰æ—¶ä¼š<strong>é™é»˜å¤±è´¥</strong>ã€‚</p>
<ul>
<li><strong>ç»“æœï¼š</strong> Git ä»¥ä¸ºè‡ªå·±åˆ‡åˆ°äº†æ–°åˆ†æ”¯ï¼Œä½†ç£ç›˜ä¸Šçš„æ–‡ä»¶å®é™…ä¸Šè¿˜æ˜¯<strong>é»˜è®¤åˆ†æ”¯</strong>ï¼ˆå¯èƒ½æ˜¯ master æˆ–æ—§ç‰ˆï¼‰çš„å†…å®¹ã€‚</li>
<li><strong>Pub çš„ååº”ï¼š</strong> Pub å·¥å…·å»è¯»ç£ç›˜ä¸Šçš„ <code>pubspec.yaml</code>ï¼Œå‘ç°ç‰ˆæœ¬å·è·Ÿé¢„æœŸä¸ç¬¦ï¼Œç›´æ¥æŠ¥é”™é€€å‡ºã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-5">ä¸‰ã€ ç»ˆæè§£å†³æ–¹æ¡ˆï¼ˆä¸‰æ­¥èµ°ï¼‰</h3>
<p>å¦‚æœä½ åœ¨ Windows ä¸Šé‡åˆ°è¿™ä¸ªâ€œç‰ˆæœ¬å¯¹ä¸ä¸Šâ€çš„é€†å¤©æŠ¥é”™ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p>
<h4 data-id="heading-6">1. å¼€å¯ Windows ç³»ç»Ÿé•¿è·¯å¾„æ”¯æŒ</h4>
<p>ä»¥<strong>ç®¡ç†å‘˜èº«ä»½</strong>æ‰“å¼€ PowerShellï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<p>PowerShell</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">New</span><span class="hljs-operator">-</span>ItemProperty <span class="hljs-operator">-</span>Path "HKLM:\System\CurrentControlSet\Control\FileSystem" `
<span class="hljs-operator">-</span>Name "LongPathsEnabled" <span class="hljs-operator">-</span><span class="hljs-keyword">Value</span> <span class="hljs-number">1</span> <span class="hljs-operator">-</span>PropertyType DWORD <span class="hljs-operator">-</span>Force
</code></pre>
<h4 data-id="heading-7">2. å¼€å¯ Git çš„é•¿è·¯å¾„æ”¯æŒ</h4>
<p>åœ¨ç»ˆç«¯è¿è¡Œï¼š</p>
<p>Bash</p>
<pre><code class="hljs language-arduino" lang="arduino">git config --global core.longpaths <span class="hljs-literal">true</span>
</code></pre>
<h4 data-id="heading-8">3. å¼ºåŠ›æ¸…é™¤â€œæœ‰æ¯’â€ç¼“å­˜</h4>
<p>è¿™æ˜¯æœ€å…³é”®çš„ä¸€æ­¥ï¼Œå¿…é¡»æ‰‹åŠ¨æ¸…ç†å·²ç»å‡ºé”™çš„æœ¬åœ°ç¼“å­˜ï¼š</p>
<ol>
<li>
<p><strong>åˆ é™¤ Pub ç¼“å­˜ä¸­çš„ Git ç›®å½•ï¼š</strong></p>
<p>ç›´æ¥åˆ é™¤ <code>C:\Users\ä½ çš„ç”¨æˆ·å\AppData\Local\Pub\Cache\git</code> ä¸‹çš„æ‰€æœ‰å†…å®¹ã€‚</p>
</li>
<li>
<p><strong>åˆ é™¤é¡¹ç›®é”æ–‡ä»¶ï¼š</strong></p>
<p>åˆ é™¤é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ <code>pubspec.lock</code>ã€‚</p>
</li>
<li>
<p><strong>é‡æ–°è·å–ï¼š</strong></p>
<p>è¿è¡Œ <code>flutter pub get</code>ã€‚</p>
</li>
</ol>
<hr/>
<h3 data-id="heading-9">å››ã€ æ€»ç»“</h3>
<p>é¸¿è’™é€‚é…ä¹‹è·¯æœ¬å°±åå·ï¼ŒWindows çš„è¿™ä¸ªç¯å¢ƒå‘æ›´æ˜¯æ€äººäºæ— å½¢ã€‚</p>
<ul>
<li><strong>Mac æ²¡äº‹ï¼š</strong> å› ä¸º Unix ç³»ç³»ç»Ÿæ²¡æœ‰è¿™ç§å¤è€çš„è·¯å¾„é•¿åº¦é™åˆ¶ã€‚</li>
<li><strong>Windows æŠ¥é”™ï¼š</strong> å¾€å¾€æ˜¯å› ä¸ºè·¯å¾„è¿‡æ·±å¯¼è‡´ Git åˆ‡æ¢åˆ†æ”¯å¤±è´¥ã€‚</li>
</ul>
<p><strong>ä¸€å¥è¯ç»éªŒï¼šåœ¨ Windows ä¸Šæ Flutter å¼€å‘ï¼Œç¬¬ä¸€ä»¶äº‹å°±æ˜¯æŠŠç³»ç»Ÿçš„ <code>LongPathsEnabled</code> ç»™å¼€äº†ï¼</strong></p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡æ¡£èƒ½å¸®åˆ°æ­£åœ¨ç»æœ›ä¸­çš„ä½ ã€‚å¦‚æœè§£å†³äº†ä½ çš„é—®é¢˜ï¼Œè®°å¾—ç‚¹ä¸ªèµï¼</p>
<hr/>
<h3 data-id="heading-10">äº’åŠ¨ç¯èŠ‚</h3>
<blockquote>
<p>ä½ åœ¨é¸¿è’™é€‚é…è¿‡ç¨‹ä¸­è¿˜é‡åˆ°äº†å“ªäº›â€œç¦»è°±â€çš„æŠ¥é”™ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµï¼Œæˆ‘ä»¬ä¸€èµ·æ’å‘ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[DebugExtensions]]></title>    <link>https://juejin.cn/post/7602900131542237225</link>    <guid>https://juejin.cn/post/7602900131542237225</guid>    <pubDate>2026-02-05T06:33:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602900131542237225" data-draft-id="7603004323911548934" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="DebugExtensions"/> <meta itemprop="keywords" content="Unity3D"/> <meta itemprop="datePublished" content="2026-02-05T06:33:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Wembanyama"/> <meta itemprop="url" content="https://juejin.cn/user/3699191947468376"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            DebugExtensions
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3699191947468376/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Wembanyama
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:33:14.000Z" title="Thu Feb 05 2026 06:33:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°ï¼ˆOverviewï¼‰</h2>
<p>DebugExtensions æ˜¯ä¸€ä¸ªç®€å•çš„ <strong>Unity è°ƒè¯•æ—¥å¿—æ§åˆ¶ç±»</strong>ï¼Œä½äº PFGameFramework.Library å‘½åç©ºé—´ã€‚</p>
<p>ä¸»è¦åŠŸèƒ½ï¼š</p>
<ul>
<li>é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„å¼€å…³ï¼ˆdebugOnOffï¼‰æ§åˆ¶æ‰€æœ‰ Debug.Logã€Debug.LogWarningã€Debug.LogError çš„è¾“å‡º</li>
<li>é¿å…åœ¨æ­£å¼å‘å¸ƒç‰ˆæœ¬ä¸­è¾“å‡ºå¤§é‡è°ƒè¯•æ—¥å¿—ï¼ˆå°¤å…¶åœ¨ç§»åŠ¨ç«¯æˆ–æ€§èƒ½æ•æ„Ÿåœºæ™¯ï¼‰</li>
<li>æä¾›å¸¦å‰ç¼€çš„æ—¥å¿—æ ¼å¼ï¼Œä¾¿äºåœ¨æ§åˆ¶å°ä¸­å¿«é€ŸåŒºåˆ†</li>
<li>è°ƒè¯•æœŸé—´å¼€å¯ï¼Œéƒ¨ç½²/å‘å¸ƒæ—¶å…³é—­</li>
</ul>
<p>è¯¥ç±»é‡‡ç”¨ <strong>MonoBehaviour + é™æ€æ–¹æ³•</strong> çš„è®¾è®¡æ¨¡å¼ï¼š</p>
<ul>
<li>åœ¨åœºæ™¯ä¸­æŒ‚è½½ä¸€ä¸ª GameObject å¹¶è®¾ç½® debugOnOff å¼€å…³</li>
<li>å…¶ä»–è„šæœ¬é€šè¿‡é™æ€æ–¹æ³• DebugExtensions.Log ç­‰è°ƒç”¨</li>
</ul>
<p><strong>å…¸å‹ä½¿ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>å¼€å‘é˜¶æ®µå¼€å¯æ—¥å¿—</li>
<li>ææµ‹/å‘å¸ƒæ—¶å…³é—­æ‰€æœ‰è°ƒè¯•è¾“å‡º</li>
<li>ç»Ÿä¸€ç®¡ç†æ—¥å¿—æ ¼å¼ï¼Œä¾¿äºç­›é€‰å’Œæ’æŸ¥</li>
</ul>
<hr/>
<h2 data-id="heading-1">ç»„ä»¶å±æ€§</h2>

















<table><thead><tr><th>å±æ€§å</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>debugOnOff</td><td>bool</td><td>true</td><td>æ˜¯å¦å¼€å¯è°ƒè¯•æ—¥å¿—ï¼ˆInspector å¯è§†åŒ–å¼€å…³ï¼‰</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">é™æ€æ–¹æ³•ä¸€è§ˆï¼ˆAPI Indexï¼‰</h2>

































<table><thead><tr><th>æ–¹æ³•å</th><th>é™æ€</th><th>å‚æ•°ç±»å‹</th><th>åŠŸèƒ½</th><th>å…¸å‹ç”¨æ³•</th></tr></thead><tbody><tr><td>Log</td><td>æ˜¯</td><td>object</td><td>è¾“å‡ºæ™®é€šæ—¥å¿—ï¼ˆå¸¦â€œè¾“å‡ºå†…å®¹ï¼šâ€å‰ç¼€ï¼‰</td><td>å¸¸è§„è°ƒè¯•ä¿¡æ¯</td></tr><tr><td>LogWarning</td><td>æ˜¯</td><td>object</td><td>è¾“å‡ºè­¦å‘Šæ—¥å¿—ï¼ˆå¸¦â€œè¾“å‡ºè­¦å‘Šï¼šâ€å‰ç¼€ï¼‰</td><td>å¯èƒ½æœ‰é—®é¢˜ä½†ä¸è‡´å‘½çš„æƒ…å†µ</td></tr><tr><td>LogError</td><td>æ˜¯</td><td>object</td><td>è¾“å‡ºé”™è¯¯æ—¥å¿—ï¼ˆå¸¦â€œè¾“å‡ºé”™è¯¯ï¼šâ€å‰ç¼€ï¼‰</td><td>ä¸¥é‡é”™è¯¯ã€å¼‚å¸¸æƒ…å†µ</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-3">æ–¹æ³•è¯¦æƒ…</h2>
<h3 data-id="heading-4">Log</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> è¾“å‡ºæ™®é€šè°ƒè¯•ä¿¡æ¯ï¼Œä»…åœ¨ debugOnOff ä¸º true æ—¶ç”Ÿæ•ˆ</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> æ—¥å¿—æ ¼å¼ï¼šè¾“å‡ºå†…å®¹ï¼š{å†…å®¹}</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="des"&gt;</span>è¦è¾“å‡ºçš„å†…å®¹ï¼ˆæ”¯æŒä»»æ„å¯¹è±¡ï¼Œä¼šè°ƒç”¨ ToString()ï¼‰<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Log</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> des</span>)
</span></code></pre>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">DebugExtensions.<span class="hljs-built_in">Log</span>("ç©å®¶è¡€é‡ï¼š" <span class="hljs-operator">+</span> playerHealth);
DebugExtensions.<span class="hljs-built_in">Log</span>(gameObject);
</code></pre>
<p><strong>è¾“å‡ºç¤ºä¾‹</strong>ï¼ˆæ§åˆ¶å°ï¼‰ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">è¾“å‡ºå†…å®¹ï¼šç©å®¶è¡€é‡ï¼š<span class="hljs-number">85</span>
è¾“å‡ºå†…å®¹ï¼šPlayer (UnityEngine.GameObject)
</code></pre>
<hr/>
<h3 data-id="heading-5">LogWarning</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> è¾“å‡ºè­¦å‘Šä¿¡æ¯ï¼Œä»…åœ¨ debugOnOff ä¸º true æ—¶ç”Ÿæ•ˆ</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> æ—¥å¿—æ ¼å¼ï¼šè¾“å‡ºè­¦å‘Šï¼š{å†…å®¹}</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="des"&gt;</span>è¦è¾“å‡ºçš„è­¦å‘Šå†…å®¹<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">LogWarning</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> des</span>)
</span></code></pre>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-erlang" lang="erlang"><span class="hljs-function"><span class="hljs-title">if</span> <span class="hljs-params">(itemCount &lt;= <span class="hljs-number">0</span>)</span>
    D<span class="hljs-title">ebugExtensions</span>.L<span class="hljs-title">ogWarning</span><span class="hljs-params">(<span class="hljs-string">"èƒŒåŒ…å·²ç©ºï¼Œæ— æ³•ä½¿ç”¨ç‰©å“"</span>)</span>;
</span></code></pre>
<p><strong>è¾“å‡ºç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs">è¾“å‡ºè­¦å‘Šï¼šèƒŒåŒ…å·²ç©ºï¼Œæ— æ³•ä½¿ç”¨ç‰©å“
</code></pre>
<hr/>
<h3 data-id="heading-6">LogError</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> è¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œä»…åœ¨ debugOnOff ä¸º true æ—¶ç”Ÿæ•ˆ</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> æ—¥å¿—æ ¼å¼ï¼šè¾“å‡ºé”™è¯¯ï¼š{å†…å®¹}</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="des"&gt;</span>è¦è¾“å‡ºçš„é”™è¯¯å†…å®¹<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">LogError</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> des</span>)
</span></code></pre>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">if (<span class="hljs-attr">target</span> == null)
    DebugExtensions.LogError("ç›®æ ‡ç‰©ä½“ä¸ºç©ºï¼Œæ— æ³•ç§»åŠ¨ï¼")<span class="hljs-comment">;</span>
</code></pre>
<p><strong>è¾“å‡ºç¤ºä¾‹</strong>ï¼ˆçº¢è‰²ï¼‰ï¼š</p>
<pre><code class="hljs">è¾“å‡ºé”™è¯¯ï¼šç›®æ ‡ç‰©ä½“ä¸ºç©ºï¼Œæ— æ³•ç§»åŠ¨ï¼
</code></pre>
<hr/>
<h2 data-id="heading-7">ä½¿ç”¨æ–¹å¼</h2>
<h3 data-id="heading-8">1. æŒ‚è½½æ–¹å¼ï¼ˆæ¨èï¼‰</h3>
<ol>
<li>
<p>åœ¨åœºæ™¯ä¸­åˆ›å»ºä¸€ä¸ªç©º GameObjectï¼ˆå»ºè®®å‘½åä¸º DebugControllerï¼‰</p>
</li>
<li>
<p>å°† DebugExtensions è„šæœ¬æŒ‚è½½åˆ°è¯¥ç‰©ä½“ä¸Š</p>
</li>
<li>
<p>åœ¨ Inspector ä¸­è®¾ç½® debugOnOff å¼€å…³</p>
<ul>
<li>å¼€å‘/è°ƒè¯•æ—¶ï¼šå‹¾é€‰ï¼ˆtrueï¼‰</li>
<li>æ‰“åŒ…/å‘å¸ƒæ—¶ï¼šå–æ¶ˆå‹¾é€‰ï¼ˆfalseï¼‰</li>
</ul>
</li>
</ol>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// ä»»æ„è„šæœ¬ä¸­è°ƒç”¨</span>
DebugExtensions.<span class="hljs-built_in">Log</span>(<span class="hljs-string">"å½“å‰å¸§ç‡ï¼š"</span> + (<span class="hljs-number">1f</span> / Time.deltaTime));
</code></pre>
<h3 data-id="heading-9">2. å…¨å±€å¼€å…³æ§åˆ¶</h3>
<p>debugOnOff åªåœ¨ Awake æ—¶è¯»å–ä¸€æ¬¡ï¼Œå­˜å‚¨åœ¨é™æ€å­—æ®µ _openDebug ä¸­ã€‚</p>
<p>å¦‚æœéœ€è¦åœ¨è¿è¡Œæ—¶åŠ¨æ€å¼€å…³ï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹é™æ€å­—æ®µï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">DebugExtensions._openDebug</span> = <span class="hljs-literal">false</span><span class="hljs-comment">;  // è¿è¡Œä¸­å…³é—­æ—¥å¿—ï¼ˆä¸æ¨èé¢‘ç¹æ”¹ï¼‰</span>
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼š_openDebug æ˜¯ private staticï¼Œå»ºè®®é€šè¿‡æš´éœ²å…¬å…±æ–¹æ³•æ¥æ§åˆ¶å¼€å…³ï¼ˆå¦‚ SetDebugEnabled(bool)ï¼‰ã€‚</p>
<hr/>
<h2 data-id="heading-10">æ”¹è¿›å»ºè®®</h2>
<p>å½“å‰å®ç°è¾ƒä¸ºåŸºç¡€ï¼Œå¯è€ƒè™‘ä»¥ä¸‹å¢å¼ºï¼š</p>
<ol>
<li><strong>æ·»åŠ å¼€å…³æ§åˆ¶æ–¹æ³•</strong></li>
</ol>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title">SetDebugEnabled</span><span class="hljs-params">(<span class="hljs-type">bool</span> enabled)</span>
</span>{
    _openDebug = enabled;
}
</code></pre>
<ol start="2">
<li><strong>æ”¯æŒæ—¥å¿—æ ‡ç­¾/åˆ†ç±»</strong></li>
</ol>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Log</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> message, <span class="hljs-built_in">string</span> tag = <span class="hljs-string">"Default"</span></span>)</span>
{
    <span class="hljs-keyword">if</span> (_openDebug)
        Debug.Log(<span class="hljs-string">$"[<span class="hljs-subst">{tag}</span>] <span class="hljs-subst">{message}</span>"</span>);
}
</code></pre>
<ol start="3">
<li><strong>æ”¯æŒæ¡ä»¶ç¼–è¯‘</strong></li>
</ol>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta">#<span class="hljs-keyword">if</span> UNITY_EDITOR || DEVELOPMENT_BUILD</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Log</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> des</span>)</span> { ... }
<span class="hljs-meta">#<span class="hljs-keyword">else</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Log</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> des</span>)</span> { }
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>
</code></pre>
<ol start="4">
<li><strong>é›†æˆç¬¬ä¸‰æ–¹æ—¥å¿—ç³»ç»Ÿ</strong>ï¼ˆå¦‚ Serilogã€Log4Unity ç­‰ï¼‰</li>
<li><strong>æ·»åŠ é¢œè‰²/å¯Œæ–‡æœ¬æ”¯æŒ</strong></li>
</ol>
<pre><code class="hljs language-css" lang="css">DebugExtensions<span class="hljs-selector-class">.Log</span>("&lt;<span class="hljs-attribute">color</span>=yellow&gt;é‡è¦ä¿¡æ¯&lt;/<span class="hljs-attribute">color</span>&gt;");
</code></pre>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MathExtensions]]></title>    <link>https://juejin.cn/post/7603004323911663622</link>    <guid>https://juejin.cn/post/7603004323911663622</guid>    <pubDate>2026-02-05T06:38:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603004323911663622" data-draft-id="7602916406981509161" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MathExtensions"/> <meta itemprop="keywords" content="Unity3D"/> <meta itemprop="datePublished" content="2026-02-05T06:38:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Wembanyama"/> <meta itemprop="url" content="https://juejin.cn/user/3699191947468376"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MathExtensions
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3699191947468376/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Wembanyama
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:38:57.000Z" title="Thu Feb 05 2026 06:38:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°ï¼ˆOverviewï¼‰</h2>
<p>MathExtensions æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ <strong>æ•°å­¦ä¸å‘é‡è¿ç®—æ‰©å±•æ–¹æ³•</strong> é™æ€ç±»ï¼Œä½äº PFGameFramework.Library å‘½åç©ºé—´ã€‚</p>
<p>å½“å‰ä¸»è¦æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>é«˜ç²¾åº¦å››èˆäº”å…¥ï¼ˆä½¿ç”¨ MidpointRounding.AwayFromZero è§„åˆ™ï¼‰</li>
<li>Vector3 å¸¸ç”¨æ“ä½œçš„ç®€æ´æ‰©å±•æ–¹æ³•ï¼ˆè§’åº¦ã€å½’ä¸€åŒ–ã€çº¿æ€§æ’å€¼ï¼‰</li>
</ul>
<p>è¿™äº›æ–¹æ³•æ—¨åœ¨è®©ä»£ç æ›´ç®€æ´ã€å¯è¯»æ€§æ›´å¼ºï¼Œå°¤å…¶é€‚åˆåœ¨ Unity é¡¹ç›®ä¸­é¢‘ç¹ä½¿ç”¨çš„å‘é‡è®¡ç®—åœºæ™¯ã€‚</p>
<p><strong>ä¾èµ–</strong>ï¼š</p>
<ul>
<li>Systemï¼ˆMath.Roundï¼‰</li>
<li>UnityEngineï¼ˆVector3 ç›¸å…³æ–¹æ³•ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-1">æ–¹æ³•ä¸€è§ˆï¼ˆAPI Indexï¼‰</h2>








































<table><thead><tr><th>æ–¹æ³•å</th><th>æ‰©å±•ç±»å‹</th><th>è¿”å›ç±»å‹</th><th>ä¸»è¦åŠŸèƒ½</th><th>å…¸å‹ç”¨é€”</th></tr></thead><tbody><tr><td>MathRound</td><td>static</td><td>double</td><td>å››èˆäº”å…¥ä¿ç•™æŒ‡å®šå°æ•°ä½ï¼ˆAwayFromZeroï¼‰</td><td>ç²¾ç¡®æ•°å€¼æ˜¾ç¤ºã€ç‰©ç†è®¡ç®—ç»“æœå¤„ç†</td></tr><tr><td>AngleBetween</td><td>Vector3</td><td>float</td><td>è®¡ç®—ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„å¤¹è§’ï¼ˆåº¦ï¼‰</td><td>æœå‘åˆ¤æ–­ã€æ—‹è½¬è§’åº¦è®¡ç®—</td></tr><tr><td>ToNormalized</td><td>Vector3</td><td>Vector3</td><td>è¿”å›å‘é‡çš„å•ä½å‘é‡ï¼ˆå½’ä¸€åŒ–ï¼‰</td><td>æ–¹å‘å‘é‡ã€å•ä½åŒ–é€Ÿåº¦/åŠ›</td></tr><tr><td>LerpTo</td><td>Vector3</td><td>Vector3</td><td>ä»å½“å‰å‘é‡çº¿æ€§æ’å€¼åˆ°ç›®æ ‡å‘é‡</td><td>å¹³æ»‘ç§»åŠ¨ã€æ’å€¼åŠ¨ç”»ã€è¿‡æ¸¡æ•ˆæœ</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">æ–¹æ³•è¯¦æƒ…</h2>
<h3 data-id="heading-3">MathRound</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> ä¿ç•™æŒ‡å®šçš„å°æ•°ä½æ•°ï¼Œé‡‡ç”¨å››èˆäº”å…¥æ–¹å¼ï¼ˆäº”æ—¶å‘è¿œç¦»é›¶çš„æ–¹å‘èˆå…¥ï¼‰</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> ä½¿ç”¨ Math.Round + MidpointRounding.AwayFromZero è§„åˆ™</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="number"&gt;</span>è¦å¤„ç†çš„æ•°å­—<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="decimaDigit"&gt;</span>ä¿ç•™çš„å°æ•°ä½æ•°ï¼ˆå¯ä¸º 0 æˆ–è´Ÿæ•°ï¼‰<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>å››èˆäº”å…¥åçš„ double å€¼<span class="hljs-doctag">&lt;/returns&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;remarks&gt;</span>å‚è€ƒ MSDNï¼šMidpointRounding.AwayFromZero - äº”æ—¶å‘è¿œç¦»é›¶çš„æ–¹å‘èˆå…¥<span class="hljs-doctag">&lt;/remarks&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">double</span> <span class="hljs-title">MathRound</span>(<span class="hljs-params"><span class="hljs-built_in">double</span> number, <span class="hljs-built_in">int</span> decimaDigit</span>)
</span></code></pre>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">double <span class="hljs-attr">value</span> = <span class="hljs-number">3.1415926535</span><span class="hljs-comment">;</span>
double <span class="hljs-attr">rounded</span> = value.MathRound(<span class="hljs-number">4</span>)<span class="hljs-comment">;     // â†’ 3.1416</span>
double <span class="hljs-attr">rounded2</span> = value.MathRound(<span class="hljs-number">2</span>)<span class="hljs-comment">;    // â†’ 3.14</span>
double <span class="hljs-attr">rounded3</span> = <span class="hljs-number">2.5</span>.MathRound(<span class="hljs-number">0</span>)<span class="hljs-comment">;      // â†’ 3ï¼ˆäº”å‘è¿œç¦»é›¶ï¼‰</span>
double <span class="hljs-attr">rounded4</span> = (-<span class="hljs-number">2.5</span>).MathRound(<span class="hljs-number">0</span>)<span class="hljs-comment">;   // â†’ -3</span>
</code></pre>
<p><strong>æ³¨æ„</strong>ï¼š</p>
<ul>
<li>ä¸é»˜è®¤ Math.Roundï¼ˆToEvenï¼‰ä¸åŒï¼Œæ­¤å¤„ä½¿ç”¨ <strong>AwayFromZero</strong>ï¼Œæ›´ç¬¦åˆæ—¥å¸¸â€œå››èˆäº”å…¥â€ç›´è§‰</li>
<li>è´Ÿæ•°åŒæ ·å‘è¿œç¦»é›¶æ–¹å‘èˆå…¥</li>
</ul>
<hr/>
<h3 data-id="heading-4">AngleBetween</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> è®¡ç®—å½“å‰å‘é‡ä¸ç›®æ ‡å‘é‡ä¹‹é—´çš„å¤¹è§’ï¼ˆå•ä½ï¼šåº¦ï¼‰</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> ç»“æœèŒƒå›´ [0, 180]</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="vector1"&gt;</span>ç¬¬ä¸€ä¸ªå‘é‡ï¼ˆthisï¼‰<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="vector2"&gt;</span>ç¬¬äºŒä¸ªå‘é‡<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„å¤¹è§’ï¼ˆåº¦ï¼‰<span class="hljs-doctag">&lt;/returns&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">float</span> <span class="hljs-title">AngleBetween</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> Vector3 vector1, Vector3 vector2</span>)
</span></code></pre>
<p><strong>ç­‰ä»·äº</strong>ï¼šVector3.Angle(vector1, vector2)</p>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Vector3 <span class="hljs-attr">forward</span> = transform.forward<span class="hljs-comment">;</span>
Vector3 <span class="hljs-attr">toTarget</span> = (target.position - transform.position).normalized<span class="hljs-comment">;</span>
float <span class="hljs-attr">angle</span> = forward.AngleBetween(toTarget)<span class="hljs-comment">;</span>

if (angle &lt; 45f)
{
    Debug.Log("ç›®æ ‡åœ¨è§†é‡å‰æ–¹")<span class="hljs-comment">;</span>
}
</code></pre>
<hr/>
<h3 data-id="heading-5">ToNormalized</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> è¿”å›å½“å‰å‘é‡çš„å•ä½å‘é‡ï¼ˆé•¿åº¦ä¸º 1ï¼‰</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> è‹¥å‘é‡é•¿åº¦ä¸º 0ï¼Œåˆ™è¿”å› Vector3.zero</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>å½’ä¸€åŒ–åçš„å‘é‡<span class="hljs-doctag">&lt;/returns&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Vector3 <span class="hljs-title">ToNormalized</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> Vector3 vector</span>)
</span></code></pre>
<p><strong>ç­‰ä»·äº</strong>ï¼švector.normalized</p>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Vector3 <span class="hljs-attr">direction</span> = (player.position - transform.position).ToNormalized()<span class="hljs-comment">;</span>
<span class="hljs-attr">rigidbody.velocity</span> = direction * speed<span class="hljs-comment">;</span>
</code></pre>
<hr/>
<h3 data-id="heading-6">LerpTo</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> ä»å½“å‰å‘é‡çº¿æ€§æ’å€¼åˆ°ç›®æ ‡å‘é‡</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> t = 0 æ—¶è¿”å›å½“å‰å‘é‡ï¼Œt = 1 æ—¶è¿”å›ç›®æ ‡å‘é‡</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="start"&gt;</span>èµ·å§‹å‘é‡ï¼ˆthisï¼‰<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="end"&gt;</span>ç›®æ ‡å‘é‡<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="t"&gt;</span>æ’å€¼å› å­ [0,1]<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>æ’å€¼ç»“æœå‘é‡<span class="hljs-doctag">&lt;/returns&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Vector3 <span class="hljs-title">LerpTo</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> Vector3 start, Vector3 end, <span class="hljs-built_in">float</span> t</span>)
</span></code></pre>
<p><strong>ç­‰ä»·äº</strong>ï¼šVector3.Lerp(start, end, t)</p>
<p><strong>ç¤ºä¾‹</strong>ï¼ˆå¹³æ»‘è·Ÿéšï¼‰ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Update</span><span class="hljs-params">()</span>
</span>{
    transform.position = transform.position.<span class="hljs-built_in">LerpTo</span>(target.position, Time.deltaTime * followSpeed);
}
</code></pre>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[GameObjectExtensions]]></title>    <link>https://juejin.cn/post/7602916406981460009</link>    <guid>https://juejin.cn/post/7602916406981460009</guid>    <pubDate>2026-02-05T06:35:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602916406981460009" data-draft-id="7602928783596863494" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="GameObjectExtensions"/> <meta itemprop="keywords" content="Unity3D"/> <meta itemprop="datePublished" content="2026-02-05T06:35:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Wembanyama"/> <meta itemprop="url" content="https://juejin.cn/user/3699191947468376"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            GameObjectExtensions
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3699191947468376/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Wembanyama
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:35:32.000Z" title="Thu Feb 05 2026 06:35:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°ï¼ˆOverviewï¼‰</h2>
<p>GameObjectExtensions æ˜¯ä¸€ä¸ªä¸“æ³¨äº <strong>Unity GameObject å¸¸ç”¨æ“ä½œ</strong> çš„é™æ€æ‰©å±•æ–¹æ³•é›†åˆï¼Œä½äº PFGameFramework.Library å‘½åç©ºé—´ã€‚</p>
<p>ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li>æ¿€æ´»çŠ¶æ€åˆ¤æ–­ä¸é€’å½’è®¾ç½®</li>
<li>å®‰å…¨è·å–ç»„ä»¶/è„šæœ¬ï¼ˆå¸¦æ—¥å¿—æç¤ºï¼‰</li>
<li>æ˜¾ç¤º/éšè—å¿«æ·æ–¹æ³•</li>
<li>å­ç‰©ä½“æŸ¥æ‰¾ï¼ˆæŒ‰åç§°ã€å®‰å…¨æŸ¥æ‰¾ã€è·å–å…¨éƒ¨ï¼‰</li>
<li>å±‚çº§ï¼ˆLayerï¼‰æ‰¹é‡è®¾ç½®ï¼ˆé€’å½’ï¼‰</li>
<li>çˆ¶ç‰©ä½“è·å–</li>
<li>æŸ¥æ‰¾å¹¶æ¿€æ´»ç‰©ä½“</li>
<li>ç‰©ä½“å…‹éš†ï¼ˆæŒ‡å®šä½ç½®ä¸æ—‹è½¬ï¼‰</li>
<li>Tag è®¾ç½®ï¼ˆé¿å…é‡å¤è®¾ç½®ï¼‰</li>
</ul>
<p>é€‚ç”¨äºå¿«é€Ÿç®¡ç†ç‰©ä½“çŠ¶æ€ã€å±‚çº§æ§åˆ¶ã€å­ç‰©ä½“æŸ¥æ‰¾ã€è°ƒè¯•æç¤ºç­‰å¸¸è§ 3D/2D åœºæ™¯æ“ä½œã€‚</p>
<hr/>
<h2 data-id="heading-1">æ–¹æ³•ä¸€è§ˆï¼ˆAPI Indexï¼‰</h2>



















































































<table><thead><tr><th>æ–¹æ³•å</th><th>è¿”å›ç±»å‹</th><th>ä¸»è¦åŠŸèƒ½</th><th>å…¸å‹ç”¨é€”</th></tr></thead><tbody><tr><td>IsActive</td><td>bool</td><td>åˆ¤æ–­ç‰©ä½“è‡ªèº«å’Œå±‚çº§æ˜¯å¦æ¿€æ´»</td><td>æ›¿ä»£ activeSelf &amp;&amp; activeInHierarchy</td></tr><tr><td>SetActiveRecursively</td><td>void</td><td>é€’å½’æ¿€æ´»/ç¦ç”¨ç‰©ä½“åŠå…¶æ‰€æœ‰å­ç‰©ä½“</td><td>æ•´ç»„æ˜¾éšæ§åˆ¶</td></tr><tr><td>GetScriptSafe</td><td>void</td><td>å®‰å…¨æ£€æŸ¥æŒ‡å®šè„šæœ¬æ˜¯å¦å­˜åœ¨å¹¶æ‰“å°æ—¥å¿—</td><td>è°ƒè¯•è„šæœ¬æŒ‚è½½æƒ…å†µ</td></tr><tr><td>GetComponentSafe</td><td>void</td><td>å®‰å…¨è·å–ç»„ä»¶ï¼Œå­˜åœ¨/ä¸å­˜åœ¨æ—¶åˆ†åˆ«æ‰§è¡Œå›è°ƒå¹¶æ‰“å°æ—¥å¿—</td><td>å¸¦æç¤ºçš„ç»„ä»¶æ£€æŸ¥</td></tr><tr><td>Show / Hide</td><td>void</td><td>å¿«é€Ÿæ¿€æ´»/ç¦ç”¨ç‰©ä½“</td><td>ç®€æ´æ˜¾éšæ“ä½œ</td></tr><tr><td>FindChild / FindChildSafe</td><td>GameObject or null</td><td>æŒ‰åç§°æŸ¥æ‰¾å­ç‰©ä½“ï¼ˆå®‰å…¨ç‰ˆè¿”å› null ä¸æŠ¥é”™ï¼‰</td><td>å¿«é€Ÿå®šä½å­ç‰©ä½“</td></tr><tr><td>GetAllChildren</td><td>List</td><td>è·å–æ‰€æœ‰ç›´æ¥å­ç‰©ä½“åˆ—è¡¨</td><td>æ‰¹é‡å¤„ç†å­ç‰©ä½“</td></tr><tr><td>SetLayer (int / string)</td><td>void</td><td>é€’å½’è®¾ç½®ç‰©ä½“åŠå­ç‰©ä½“çš„å±‚çº§ï¼ˆæ”¯æŒå±‚åï¼‰</td><td>ç»Ÿä¸€å±‚çº§ç®¡ç†ï¼ˆå¦‚å°„çº¿æ£€æµ‹ã€æ¸²æŸ“åˆ†ç»„ï¼‰</td></tr><tr><td>GetParent</td><td>GameObject or null</td><td>è·å–çˆ¶ç‰©ä½“ï¼ˆè‹¥æ— çˆ¶ç‰©ä½“è¿”å› nullï¼‰</td><td>å±‚çº§å¯¼èˆª</td></tr><tr><td>FindAndActivate</td><td>GameObject or null</td><td>å…¨å±€æŸ¥æ‰¾ç‰©ä½“å¹¶æ¿€æ´»</td><td>å¿«é€Ÿæ¿€æ´»åœºæ™¯ä¸­ç‰¹å®šç‰©ä½“</td></tr><tr><td>Clone</td><td>GameObject</td><td>åœ¨æŒ‡å®šä½ç½®å’Œæ—‹è½¬å…‹éš†ç‰©ä½“</td><td>åŠ¨æ€ç”Ÿæˆå‰¯æœ¬</td></tr><tr><td>SetTag</td><td>void</td><td>è®¾ç½® Tagï¼ˆé¿å…é‡å¤è®¾ç½®ï¼‰</td><td>å®‰å…¨æ‰¹é‡æ‰“æ ‡ç­¾</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">æ–¹æ³•è¯¦æƒ…</h2>
<h3 data-id="heading-3">æ¿€æ´»çŠ¶æ€ç›¸å…³</h3>
<h4 data-id="heading-4">IsActive</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> åˆ¤æ–­ç‰©ä½“æ˜¯å¦çœŸæ­£å¤„äºæ¿€æ´»çŠ¶æ€ï¼ˆè‡ªèº« + å±‚çº§ï¼‰</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">IsActive</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> GameObject gameObject</span>)
</span></code></pre>
<p>ç­‰ä»·äº gameObject.activeSelf &amp;&amp; gameObject.activeInHierarchy</p>
<h4 data-id="heading-5">SetActiveRecursively</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> é€’å½’è®¾ç½®ç‰©ä½“åŠå…¶æ‰€æœ‰å­ç‰©ä½“çš„æ¿€æ´»çŠ¶æ€</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetActiveRecursively</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> GameObject gameObject, <span class="hljs-built_in">bool</span> active</span>)
</span></code></pre>
<p><strong>å…¸å‹ç”¨æ³•</strong>ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">panel.<span class="hljs-built_in">SetActiveRecursively</span>(<span class="hljs-literal">false</span>); <span class="hljs-comment">// å…³é—­æ•´ä¸ª UI é¢æ¿åŠå…¶æ‰€æœ‰å­å…ƒç´ </span>
</code></pre>
<hr/>
<h3 data-id="heading-6">ç»„ä»¶/è„šæœ¬å®‰å…¨æ£€æŸ¥</h3>
<h4 data-id="heading-7">GetScriptSafe</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> æ£€æŸ¥æŒ‡å®šè„šæœ¬æ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ‰“å°ç›¸åº”æ—¥å¿—ï¼ˆä»…é’ˆå¯¹ MonoBehaviourï¼‰</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">GetScriptSafe</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params"><span class="hljs-keyword">this</span> GameObject gameObject</span>) <span class="hljs-keyword">where</span> T : MonoBehaviour
</span></code></pre>
<p><strong>è¾“å‡ºç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-erlang" lang="erlang">Player ä¸Šå­˜åœ¨è„šæœ¬ PlayerController.
Cube ä¸Šæ²¡æœ‰æ‰¾åˆ°è„šæœ¬ MoveController.
</code></pre>
<h4 data-id="heading-8">GetComponentSafe</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> å®‰å…¨è·å–ä»»æ„ç»„ä»¶ï¼Œå­˜åœ¨/ä¸å­˜åœ¨æ—¶åˆ†åˆ«æ‰§è¡Œå›è°ƒå¹¶æ‰“å°æ—¥å¿—</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="onComponentFound"&gt;</span>ç»„ä»¶å­˜åœ¨æ—¶å›è°ƒ<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="onComponentNotFound"&gt;</span>ç»„ä»¶ä¸å­˜åœ¨æ—¶å›è°ƒ<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">GetComponentSafe</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">
    <span class="hljs-keyword">this</span> GameObject gameObject,
    Action&lt;T&gt; onComponentFound = <span class="hljs-literal">null</span>,
    Action onComponentNotFound = <span class="hljs-literal">null</span></span>)
    <span class="hljs-keyword">where</span> T : Component
</span></code></pre>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">go.GetComponentSafe&lt;Rigidbody&gt;(
    <span class="hljs-attr">rb</span> =&gt; rb.mass = <span class="hljs-number">10</span>f,
    () =&gt; Debug.Log("éœ€è¦æ·»åŠ åˆšä½“ç»„ä»¶ï¼")
)<span class="hljs-comment">;</span>
</code></pre>
<hr/>
<h3 data-id="heading-9">æ˜¾ç¤º/éšè—å¿«æ·æ–¹æ³•</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">Show</span><span class="hljs-params">(<span class="hljs-built_in">this</span> GameObject gameObject)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">Hide</span><span class="hljs-params">(<span class="hljs-built_in">this</span> GameObject gameObject)</span>
</code></pre>
<p><strong>ç®€æ´æ›¿ä»£</strong>ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby">button.<span class="hljs-title class_">Show</span>();      <span class="hljs-regexp">//</span> ç­‰ä»·äº button.<span class="hljs-title class_">SetActive</span>(<span class="hljs-literal">true</span>);
effect.<span class="hljs-title class_">Hide</span>();      <span class="hljs-regexp">//</span> ç­‰ä»·äº effect.<span class="hljs-title class_">SetActive</span>(<span class="hljs-literal">false</span>);
</code></pre>
<hr/>
<h3 data-id="heading-10">å­ç‰©ä½“æŸ¥æ‰¾</h3>
<h4 data-id="heading-11">FindChild / FindChildSafe</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> æŸ¥æ‰¾æŒ‡å®šåç§°çš„ç›´æ¥å­ç‰©ä½“</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> GameObject <span class="hljs-title">FindChild</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> GameObject gameObject, <span class="hljs-built_in">string</span> childName</span>)

<span class="hljs-comment">/// &lt;summary&gt;</span>
<span class="hljs-comment">/// å®‰å…¨æŸ¥æ‰¾å­ç‰©ä½“ï¼Œä¸å­˜åœ¨è¿”å› null</span>
<span class="hljs-comment">/// &lt;/summary&gt;</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> GameObject <span class="hljs-title">FindChildSafe</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> GameObject gameObject, <span class="hljs-built_in">string</span> childName</span>)
</span></code></pre>
<p><strong>åŒºåˆ«</strong>ï¼šFindChild ä½¿ç”¨ transform.Find()ï¼Œè‹¥è·¯å¾„é”™è¯¯ä¼šæŠ›å¼‚å¸¸ï¼›FindChildSafe æ›´å®‰å…¨ã€‚</p>
<h4 data-id="heading-12">GetAllChildren</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> è·å–æ‰€æœ‰ç›´æ¥å­ç‰©ä½“ï¼ˆä¸åŒ…å«å­å­™ï¼‰</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;GameObject&gt; <span class="hljs-title">GetAllChildren</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> GameObject gameObject</span>)
</span></code></pre>
<hr/>
<h3 data-id="heading-13">å±‚çº§ï¼ˆLayerï¼‰ç®¡ç†</h3>
<h4 data-id="heading-14">SetLayerï¼ˆä¸¤ç§é‡è½½ï¼‰</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> é€’å½’è®¾ç½®ç‰©ä½“åŠæ‰€æœ‰å­ç‰©ä½“çš„ Layerï¼ˆintï¼‰</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetLayer</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> GameObject gameObject, <span class="hljs-built_in">int</span> layer</span>)

<span class="hljs-comment">/// &lt;summary&gt;</span>
<span class="hljs-comment">/// é€’å½’è®¾ç½® Layerï¼ˆä¼ å…¥å±‚åç§°å­—ç¬¦ä¸²ï¼‰</span>
<span class="hljs-comment">/// &lt;/summary&gt;</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetLayer</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> GameObject gameObject, <span class="hljs-built_in">string</span> layerName</span>)
</span></code></pre>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">player</span><span class="hljs-selector-class">.SetLayer</span>(<span class="hljs-string">"Player"</span>);          <span class="hljs-comment">// ä½¿ç”¨å±‚å</span>
<span class="hljs-selector-tag">uiRoot</span><span class="hljs-selector-class">.SetLayer</span>(LayerMask.<span class="hljs-built_in">NameToLayer</span>(<span class="hljs-string">"UI"</span>));
</code></pre>
<hr/>
<h3 data-id="heading-15">å…¶ä»–å¸¸ç”¨æ“ä½œ</h3>
<h4 data-id="heading-16">GetParent</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> è·å–çˆ¶ç‰©ä½“ï¼Œè‹¥æ— çˆ¶ç‰©ä½“è¿”å› null</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> GameObject <span class="hljs-title">GetParent</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> GameObject gameObject</span>)
</span></code></pre>
<h4 data-id="heading-17">FindAndActivate</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> å…¨å±€æŸ¥æ‰¾ç‰©ä½“å¹¶æ¿€æ´»ï¼ˆGameObject.Find + SetActiveï¼‰</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> GameObject <span class="hljs-title">FindAndActivate</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> GameObject gameObject, <span class="hljs-built_in">string</span> name</span>)
</span></code></pre>
<p><strong>æ³¨æ„</strong>ï¼šGameObject.Find æ€§èƒ½è¾ƒä½ï¼Œä»…å»ºè®®åœ¨åˆå§‹åŒ–æˆ–å°‘é‡ä½¿ç”¨æ—¶è°ƒç”¨ã€‚</p>
<h4 data-id="heading-18">Clone</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> åœ¨æŒ‡å®šä½ç½®å’Œæ—‹è½¬å…‹éš†ç‰©ä½“</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> GameObject <span class="hljs-title">Clone</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> GameObject gameObject, Vector3 position, Quaternion rotation</span>)
</span></code></pre>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">var <span class="hljs-attr">bullet</span> = bulletPrefab.Clone(spawnPoint.position, spawnPoint.rotation)<span class="hljs-comment">;</span>
</code></pre>
<h4 data-id="heading-19">SetTag</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> è®¾ç½® Tagï¼Œä»…åœ¨ä¸åŒæ—¶æ‰ä¿®æ”¹</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetTag</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> GameObject gameObject, <span class="hljs-built_in">string</span> tag</span>)
</span></code></pre>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ImageEffectController]]></title>    <link>https://juejin.cn/post/7603004323911647238</link>    <guid>https://juejin.cn/post/7603004323911647238</guid>    <pubDate>2026-02-05T06:37:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603004323911647238" data-draft-id="7602900131542253609" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ImageEffectController"/> <meta itemprop="keywords" content="Unity3D"/> <meta itemprop="datePublished" content="2026-02-05T06:37:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Wembanyama"/> <meta itemprop="url" content="https://juejin.cn/user/3699191947468376"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ImageEffectController
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3699191947468376/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Wembanyama
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:37:48.000Z" title="Thu Feb 05 2026 06:37:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°ï¼ˆOverviewï¼‰</h2>
<p>ImageEffectController æ˜¯ä¸€ä¸ªä½¿ç”¨ <strong>DOTween</strong> å®ç°å¤šç§ 3D/2D ç‰©ä½“è§†è§‰åŠ¨ç”»æ•ˆæœçš„ç»„ä»¶ï¼ŒæŒ‚è½½åœ¨å¸¦æœ‰ Renderer çš„ GameObject ä¸Šã€‚</p>
<p>ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li>ç‰©ä½“æ•´ä½“åŠ¨ç”»åºåˆ—ï¼ˆç¼©æ”¾ + æ·¡å…¥ + æ—‹è½¬ + ç§»åŠ¨ + é¢œè‰²å˜åŒ– + æŠ–åŠ¨ï¼‰</li>
<li>æ”¯æŒå•ç‹¬è§¦å‘æ¯ç§åŠ¨ç”»æ•ˆæœ</li>
<li>æ”¯æŒé‡ç½®ç‰©ä½“çŠ¶æ€ï¼ˆä½ç½®ã€ç¼©æ”¾ã€é¢œè‰²ã€é€æ˜åº¦ã€æ¿€æ´»çŠ¶æ€ï¼‰</li>
<li>åŠ¨ç”»å‚æ•°å…¨éƒ¨å…¬å¼€ï¼Œå¯åœ¨ Inspector ä¸­è°ƒèŠ‚</li>
<li>é€‚ç”¨äº UI å›¾ç‰‡ç‰¹æ•ˆã€3D ç‰©ä½“å±•ç¤ºã€æ•™å­¦å¼•å¯¼ã€ç‰©å“å‡ºç°/æ¶ˆå¤±ç­‰åœºæ™¯</li>
</ul>
<p><strong>æ ¸å¿ƒä¾èµ–</strong>ï¼š</p>
<ul>
<li>DOTweenï¼ˆæ‰€æœ‰åŠ¨ç”»å‡ä½¿ç”¨ DOTween å®ç°ï¼‰</li>
<li>éœ€è¦ç‰©ä½“ä¸Šæœ‰ Renderer ç»„ä»¶ï¼ˆç”¨äºæè´¨é€æ˜åº¦/é¢œè‰²æ§åˆ¶ï¼‰</li>
</ul>
<p><strong>å…¸å‹ä½¿ç”¨æ–¹å¼</strong>ï¼š</p>
<ul>
<li>æŒ‚è½½è„šæœ¬åï¼Œåœ¨ Inspector é…ç½®å‚æ•°</li>
<li>è°ƒç”¨ AnimateImage() æ’­æ”¾å®Œæ•´ç»„åˆåŠ¨ç”»</li>
<li>æˆ–å•ç‹¬è°ƒç”¨ FadeIn()ã€Scale() ç­‰æ–¹æ³•è§¦å‘å•ä¸€æ•ˆæœ</li>
</ul>
<hr/>
<h2 data-id="heading-1">ç»„ä»¶å±æ€§ï¼ˆInspector å¯è°ƒå‚æ•°ï¼‰</h2>































































































<table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>é»˜è®¤å€¼ç¤ºä¾‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>targetScale</td><td>Vector3</td><td>(2, 2, 1)</td><td>ç›®æ ‡ç¼©æ”¾å€¼ï¼ˆé€šå¸¸ z ä¿æŒ 1ï¼‰</td></tr><tr><td>scaleDuration</td><td>float</td><td>1f</td><td>ç¼©æ”¾åŠ¨ç”»æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰</td></tr><tr><td>fadeDuration</td><td>float</td><td>1f</td><td>æ·¡å…¥/æ·¡å‡º / é¢œè‰²å˜åŒ–çš„æŒç»­æ—¶é—´</td></tr><tr><td>fadeIn</td><td>bool</td><td>true</td><td>æ˜¯å¦æ‰§è¡Œæ·¡å…¥ï¼ˆæè´¨ alpha â†’ 1ï¼‰</td></tr><tr><td>fadeOut</td><td>bool</td><td>false</td><td>æ˜¯å¦æ‰§è¡Œæ·¡å‡ºï¼ˆæè´¨ alpha â†’ 0ï¼‰</td></tr><tr><td>targetColor</td><td>Color</td><td>Color.red</td><td>ç›®æ ‡é¢œè‰²ï¼ˆå½“ changeColor = true æ—¶ä½¿ç”¨ï¼‰</td></tr><tr><td>changeColor</td><td>bool</td><td>false</td><td>æ˜¯å¦æ‰§è¡Œé¢œè‰²æ¸å˜</td></tr><tr><td>offScreenPosition</td><td>Vector3</td><td>(-Screen.width, 0, 0)</td><td>åˆå§‹å±å¹•å¤–ä½ç½®ï¼ˆç”¨äºæ»‘å…¥æ•ˆæœï¼‰</td></tr><tr><td>onScreenPosition</td><td>Vector3</td><td>(0, 0, 0)</td><td>ç›®æ ‡å±å¹•å†…ä½ç½®</td></tr><tr><td>moveDuration</td><td>float</td><td>1f</td><td>ç§»åŠ¨åŠ¨ç”»æŒç»­æ—¶é—´</td></tr><tr><td>rotationAngle</td><td>float</td><td>360f</td><td>æ—‹è½¬è§’åº¦ï¼ˆç»• Z è½´ï¼‰</td></tr><tr><td>rotateDuration</td><td>float</td><td>2f</td><td>æ—‹è½¬åŠ¨ç”»æŒç»­æ—¶é—´</td></tr><tr><td>shakeStrength</td><td>Vector3</td><td>(20, 20, 0)</td><td>æŠ–åŠ¨å¼ºåº¦ï¼ˆx/y å¹³é¢æŠ–åŠ¨ï¼‰</td></tr><tr><td>shakeDuration</td><td>float</td><td>1f</td><td>æŠ–åŠ¨æŒç»­æ—¶é—´</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">æ ¸å¿ƒæ–¹æ³•</h2>
<h3 data-id="heading-3">AnimateImage</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> æ’­æ”¾å®Œæ•´çš„ç»„åˆåŠ¨ç”»åºåˆ—ï¼ˆæ¨èå…¥å£æ–¹æ³•ï¼‰</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> é¡ºåºï¼šæ·¡å…¥/æ·¡å‡º â†’ ç¼©æ”¾ â†’ æ—‹è½¬ â†’ ç§»åŠ¨ â†’ é¢œè‰²å˜åŒ–ï¼ˆå¹¶è¡Œï¼‰ â†’ æŠ–åŠ¨</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> åŠ¨ç”»å®Œæˆåæ‰“å° "All image effects completed"</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">AnimateImage</span>()
</span></code></pre>
<p><strong>æ‰§è¡Œæµç¨‹</strong>ï¼š</p>
<ol>
<li>æ¿€æ´»ç‰©ä½“ gameObject.SetActive(true)</li>
<li>åˆ›å»º DOTween Sequence</li>
<li>ä¾æ¬¡/å¹¶è¡Œæ·»åŠ å„ç§åŠ¨ç”»</li>
<li>æœ€åæŠ–åŠ¨æ•ˆæœ</li>
<li>OnComplete å›è°ƒæ‰“å°å®Œæˆæ—¥å¿—</li>
</ol>
<p><strong>å…¸å‹è°ƒç”¨</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// åœ¨å…¶ä»–è„šæœ¬ä¸­</span>
GetComponent&lt;ImageEffectController&gt;()<span class="hljs-selector-class">.AnimateImage</span>();
</code></pre>
<hr/>
<h3 data-id="heading-4">ResetImage</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> é‡ç½®ç‰©ä½“åˆ°åˆå§‹çŠ¶æ€ï¼ˆå¸¸ç”¨äºä¸‹æ¬¡é‡æ–°æ’­æ”¾å‰å‡†å¤‡ï¼‰</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> - ä½ç½®å›åˆ° offScreenPosition</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> - ç¼©æ”¾å›åˆ° (1,1,1)</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> - é¢œè‰²æ¢å¤ä¸ºç™½è‰²</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> - é€æ˜åº¦è®¾ä¸º 0</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> - ç‰©ä½“è®¾ä¸ºéæ¿€æ´»</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ResetImage</span>()
</span></code></pre>
<p><strong>æ¨èç”¨æ³•</strong>ï¼šåœ¨åŠ¨ç”»æ’­æ”¾ç»“æŸæˆ–éœ€è¦é‡æ–°å±•ç¤ºæ—¶è°ƒç”¨ã€‚</p>
<hr/>
<h3 data-id="heading-5">å•ä¸€æ•ˆæœæ–¹æ³•ï¼ˆå¯å•ç‹¬è°ƒç”¨ï¼‰</h3>













































<table><thead><tr><th>æ–¹æ³•å</th><th>åŠŸèƒ½æè¿°</th><th>åŠ¨ç”»æ ¸å¿ƒè°ƒç”¨</th></tr></thead><tbody><tr><td>FadeIn()</td><td>æè´¨æ·¡å…¥ï¼ˆalpha â†’ 1ï¼‰</td><td>_material.DOFade(1f, fadeDuration)</td></tr><tr><td>FadeOut()</td><td>æè´¨æ·¡å‡ºï¼ˆalpha â†’ 0ï¼‰</td><td>_material.DOFade(0f, fadeDuration)</td></tr><tr><td>Scale()</td><td>ç¼©æ”¾åˆ° targetScale</td><td>transform.DOScale(targetScale, scaleDuration)</td></tr><tr><td>Rotate()</td><td>ç»• Z è½´æ—‹è½¬ rotationAngle åº¦</td><td>transform.DORotate(..., RotateMode.FastBeyond360)</td></tr><tr><td>Move()</td><td>ä» offScreenPosition ç§»åŠ¨åˆ° onScreenPosition</td><td>transform.DOLocalMove(onScreenPosition, moveDuration)</td></tr><tr><td>ChangeColor()</td><td>æè´¨é¢œè‰²æ¸å˜åˆ° targetColor</td><td>_material.DOColor(targetColor, fadeDuration)</td></tr><tr><td>Shake()</td><td>ä½ç½®æŠ–åŠ¨</td><td>transform.DOShakePosition(...)</td></tr></tbody></table>
<p><strong>ä½¿ç”¨ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">var <span class="hljs-attr">effect</span> = GetComponent&lt;ImageEffectController&gt;()<span class="hljs-comment">;</span>

// åªæƒ³è®©ç‰©ä½“æŠ–åŠ¨ä¸€ä¸‹
effect.Shake()<span class="hljs-comment">;</span>

// å•ç‹¬åšæ·¡å…¥ + æ”¾å¤§
effect.FadeIn()<span class="hljs-comment">;</span>
effect.Scale()<span class="hljs-comment">;</span>
</code></pre>
<hr/>
<h2 data-id="heading-6">å†…éƒ¨å­—æ®µï¼ˆç§æœ‰ï¼‰</h2>




















<table><thead><tr><th>å­—æ®µå</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>_renderer</td><td>Renderer</td><td>ç‰©ä½“çš„ Renderer ç»„ä»¶</td></tr><tr><td>_material</td><td>Material</td><td>å½“å‰ä½¿ç”¨çš„æè´¨ï¼ˆå–è‡ª rendererï¼‰</td></tr></tbody></table>
<p><strong>æ³¨æ„</strong>ï¼šè„šæœ¬åœ¨ Start() ä¸­è‡ªåŠ¨è·å– _renderer å’Œ _materialï¼Œè‹¥ç‰©ä½“æ²¡æœ‰ Renderer ä¼šå¯¼è‡´ç©ºå¼•ç”¨ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[UIExtensions]]></title>    <link>https://juejin.cn/post/7603004323911729158</link>    <guid>https://juejin.cn/post/7603004323911729158</guid>    <pubDate>2026-02-05T06:44:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7603004323911729158" data-draft-id="7602928783596961798" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="UIExtensions"/> <meta itemprop="keywords" content="Unity3D"/> <meta itemprop="datePublished" content="2026-02-05T06:44:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Wembanyama"/> <meta itemprop="url" content="https://juejin.cn/user/3699191947468376"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            UIExtensions
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3699191947468376/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Wembanyama
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T06:44:49.000Z" title="Thu Feb 05 2026 06:44:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¦‚è¿°ï¼ˆOverviewï¼‰Â Â </h2>
<p>UIExtensions æ˜¯ä¸€ä¸ªä¸“æ³¨äº <strong>Unity UI ç»„ä»¶ï¼ˆuGUI &amp; TextMeshProï¼‰</strong> çš„é™æ€æ‰©å±•æ–¹æ³•é›†åˆï¼Œä½äº PFGameFramework.Library å‘½åç©ºé—´ã€‚</p>
<p>ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<ul>
<li>InputField / TMP_InputField è¾“å…¥åˆæ³•æ€§æ ¡éªŒ</li>
<li>æ–‡æœ¬å†…å®¹å¿«é€Ÿè®¾ç½®ï¼ˆText / TMP_Textï¼‰</li>
<li>Toggle å•é€‰/å¤šé€‰çŠ¶æ€åˆ¤æ–­ &amp; ç­”æ¡ˆæ¯”å¯¹</li>
<li>ç®€å•æç¤ºæ–‡æœ¬è®¾ç½®</li>
<li>TextAssetï¼ˆ.txtï¼‰é€è¡Œè¯»å–å¹¶è§£æä¸ºå­—å…¸</li>
<li>CSV æ–‡ä»¶è¯»å–ï¼ˆè¿”å› List&lt;List&gt;ï¼‰</li>
<li>å¸¦å­—ä½“å¤§å°çš„æ–‡æœ¬è®¾ç½®</li>
</ul>
<p>é€‚ç”¨äºï¼š</p>
<ul>
<li>è¡¨å•è¾“å…¥éªŒè¯</li>
<li>åŠ¨æ€æ–‡æœ¬æ›´æ–°</li>
<li>é€‰æ‹©é¢˜/å•é€‰å¤šé€‰é€»è¾‘åˆ¤æ–­</li>
<li>é…ç½®è¡¨/æ­¥éª¤è¯´æ˜è¯»å–</li>
<li>CSV æ•°æ®å¯¼å…¥</li>
</ul>
<p><strong>ä¾èµ–</strong>ï¼š</p>
<ul>
<li>UnityEngine.UI</li>
<li>TMProï¼ˆTextMeshProï¼‰</li>
<li>System.IOï¼ˆCSV æ–‡ä»¶è¯»å–ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-1">æ–¹æ³•ä¸€è§ˆï¼ˆAPI Indexï¼‰</h2>

























































































<table><thead><tr><th>æ–¹æ³•å</th><th>æ‰©å±•ç±»å‹</th><th>è¿”å›ç±»å‹</th><th>ä¸»è¦åŠŸèƒ½</th><th>å…¸å‹ç”¨é€”</th></tr></thead><tbody><tr><td>CheckInputField</td><td>InputField</td><td>bool</td><td>æ ¡éªŒè¾“å…¥æ¡†æ˜¯å¦åˆæ³•ï¼ˆéç©ºã€éç‰¹æ®Šå­—ç¬¦ï¼‰</td><td>é˜²æ­¢éæ³•è¾“å…¥</td></tr><tr><td>CheckInputField</td><td>TMP_InputField</td><td>bool</td><td>åŒä¸Šï¼Œæ”¯æŒ TMP_InputField</td><td>TMP è¡¨å•éªŒè¯</td></tr><tr><td>SetTextContent</td><td>TMP_Text</td><td>void</td><td>è®¾ç½® TMP_Text å†…å®¹</td><td>å¿«é€Ÿæ›´æ–° TMP æ–‡æœ¬</td></tr><tr><td>SetText</td><td>Text</td><td>void</td><td>è®¾ç½® uGUI Text å†…å®¹</td><td>å¿«é€Ÿæ›´æ–°æ™®é€šæ–‡æœ¬</td></tr><tr><td>SetTextWithSize</td><td>Text</td><td>void</td><td>è®¾ç½®æ–‡æœ¬å†…å®¹ + å­—ä½“å¤§å°</td><td>å¸¦æ ·å¼çš„æ–‡æœ¬æ›´æ–°</td></tr><tr><td>IsSingleSelected</td><td>List</td><td>bool</td><td>åˆ¤æ–­æ˜¯å¦<strong>æ­£å¥½</strong>é€‰ä¸­ä¸€ä¸ª Toggleï¼ˆå•é€‰ï¼‰</td><td>å•é€‰é¢˜éªŒè¯</td></tr><tr><td>IsMultipleSelected</td><td>List</td><td>bool</td><td>åˆ¤æ–­æ˜¯å¦é€‰ä¸­äº†å¤šä¸ª Toggleï¼ˆå¤šé€‰ï¼‰</td><td>å¤šé€‰é¢˜åˆæ­¥ç­›é€‰</td></tr><tr><td>IsAnswerCorrectByNames</td><td>List, HashSet</td><td>bool</td><td>åˆ¤æ–­é€‰ä¸­çš„ Toggle åç§°é›†åˆä¸æ­£ç¡®ç­”æ¡ˆå®Œå…¨åŒ¹é…</td><td>ä¸¥æ ¼é€‰æ‹©é¢˜ç­”æ¡ˆæ¯”å¯¹</td></tr><tr><td>SetText (GameObject)</td><td>GameObject</td><td>void</td><td>è®¾ç½®å­ç‰©ä½“ä¸­çš„ Text ç»„ä»¶å†…å®¹</td><td>æç¤º/çŠ¶æ€æ–‡æœ¬æ›´æ–°</td></tr><tr><td>ReadTxtByText</td><td>TextAsset</td><td>void</td><td>è¯»å– TextAssetï¼ŒæŒ‰ Tab åˆ†å‰²è§£æä¸º int â†’ string å­—å…¸</td><td>æ­¥éª¤/é…ç½®è¡¨è¯»å–</td></tr><tr><td>ReadCsv</td><td>static</td><td>List&lt;List&gt;</td><td>è¯»å– CSV æ–‡ä»¶ï¼Œè¿”å›äºŒç»´å­—ç¬¦ä¸²åˆ—è¡¨</td><td>è¡¨æ ¼æ•°æ®å¯¼å…¥</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-2">æ–¹æ³•è¯¦æƒ…</h2>
<h3 data-id="heading-3">è¾“å…¥æ ¡éªŒ</h3>
<h4 data-id="heading-4">CheckInputField</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> æ ¡éªŒ InputField æ˜¯å¦åˆæ³•ï¼ˆéç©ºã€éçº¯ç©ºç™½ã€é , . -ï¼‰</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">CheckInputField</span>(<span class="hljs-params">InputField inputField</span>)

<span class="hljs-comment">/// &lt;summary&gt;</span>
<span class="hljs-comment">/// æ ¡éªŒ TMP_InputField æ˜¯å¦åˆæ³•</span>
<span class="hljs-comment">/// &lt;/summary&gt;</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">CheckInputField</span>(<span class="hljs-params">TMP_InputField inputField</span>)
</span></code></pre>
<p><strong>å…¸å‹ç”¨æ³•</strong>ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">if</span> (!inputField.<span class="hljs-built_in">CheckInputField</span>())
{
    <span class="hljs-comment">// æ˜¾ç¤ºé”™è¯¯æç¤º</span>
    <span class="hljs-selector-tag">errorText</span><span class="hljs-selector-class">.SetText</span>(<span class="hljs-string">"è¯·è¾“å…¥æœ‰æ•ˆæ•°å­—ï¼"</span>);
}
</code></pre>
<p><strong>å½“å‰è§„åˆ™</strong>ï¼šæ’é™¤ ,ã€.ã€- ä½œä¸ºå•ç‹¬è¾“å…¥ï¼ˆé˜²æ­¢å°æ•°ç‚¹æˆ–è´Ÿå·è¯¯åˆ¤ï¼‰ï¼Œå¯æ ¹æ®éœ€æ±‚æ‰©å±•ã€‚</p>
<hr/>
<h3 data-id="heading-5">æ–‡æœ¬è®¾ç½®</h3>
<h4 data-id="heading-6">SetTextContent / SetText</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> è®¾ç½® TMP_Text å†…å®¹ï¼ˆç®€æ´æ‰©å±•ï¼‰</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetTextContent</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> TMP_Text text, <span class="hljs-built_in">string</span> content</span>)

<span class="hljs-comment">/// &lt;summary&gt;</span>
<span class="hljs-comment">/// è®¾ç½® uGUI Text å†…å®¹</span>
<span class="hljs-comment">/// &lt;/summary&gt;</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetText</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> Text text, <span class="hljs-built_in">string</span> str</span>)

<span class="hljs-comment">/// &lt;summary&gt;</span>
<span class="hljs-comment">/// è®¾ç½® GameObject ä¸‹å­çº§ Text å†…å®¹</span>
<span class="hljs-comment">/// &lt;/summary&gt;</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetText</span>(<span class="hljs-params">GameObject go, <span class="hljs-built_in">string</span> txt</span>)
</span></code></pre>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">scoreText.SetTextContent(<span class="hljs-string">$"å¾—åˆ†ï¼š<span class="hljs-subst">{score}</span>"</span>);
hintObj.SetText(<span class="hljs-string">"æ“ä½œæˆåŠŸï¼"</span>);
</code></pre>
<h4 data-id="heading-7">SetTextWithSize</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> è®¾ç½® uGUI Text å†…å®¹å¹¶åŒæ—¶è®¾ç½®å­—ä½“å¤§å°</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SetTextWithSize</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> Text text, <span class="hljs-built_in">string</span> str, <span class="hljs-built_in">int</span> size</span>)
</span></code></pre>
<hr/>
<h3 data-id="heading-8">Toggle ç›¸å…³åˆ¤æ–­</h3>
<h4 data-id="heading-9">IsSingleSelected</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> åˆ¤æ–­ Toggle åˆ—è¡¨ä¸­æ˜¯å¦**æ­£å¥½**åªæœ‰ä¸€ä¸ªè¢«é€‰ä¸­ï¼ˆä¸¥æ ¼å•é€‰ï¼‰</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">IsSingleSelected</span>(<span class="hljs-params">List&lt;Toggle&gt; toggles</span>)
</span></code></pre>
<h4 data-id="heading-10">IsMultipleSelected</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> åˆ¤æ–­ Toggle åˆ—è¡¨ä¸­æ˜¯å¦è‡³å°‘æœ‰ä¸¤ä¸ªè¢«é€‰ä¸­</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">IsMultipleSelected</span>(<span class="hljs-params">List&lt;Toggle&gt; toggles</span>)
</span></code></pre>
<h4 data-id="heading-11">IsAnswerCorrectByNames</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> åˆ¤æ–­é€‰ä¸­çš„ Toggle åç§°é›†åˆä¸æ­£ç¡®ç­”æ¡ˆåç§°é›†åˆæ˜¯å¦å®Œå…¨ç›¸ç­‰ï¼ˆé¡ºåºæ— å…³ï¼‰</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">IsAnswerCorrectByNames</span>(<span class="hljs-params">List&lt;Toggle&gt; toggles, HashSet&lt;<span class="hljs-built_in">string</span>&gt; correctNames</span>)
</span></code></pre>
<p><strong>æ¨èåšæ³•</strong>ï¼šToggle çš„ name å­—æ®µè®¾ç½®ä¸ºé€‰é¡¹å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚ "A"ã€"B"ã€"æ­£ç¡®ç­”æ¡ˆ1" ç­‰ï¼‰ã€‚</p>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">var</span> correct = <span class="hljs-keyword">new</span> HashSet&lt;<span class="hljs-built_in">string</span>&gt; { <span class="hljs-string">"A"</span>, <span class="hljs-string">"C"</span> };
<span class="hljs-keyword">if</span> (toggles.IsAnswerCorrectByNames(correct))
{
    Debug.Log(<span class="hljs-string">"ç­”æ¡ˆæ­£ç¡®ï¼"</span>);
}
</code></pre>
<hr/>
<h3 data-id="heading-12">æ–‡ä»¶è¯»å–</h3>
<h4 data-id="heading-13">ReadTxtByTextï¼ˆTextAsset â†’ Dictionaryï¼‰</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> ä» TextAsset è¯»å– Tab åˆ†éš”æ–‡æœ¬ï¼Œè§£æä¸º int â†’ string å­—å…¸ï¼ˆè·³è¿‡é¦–è¡Œï¼‰</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ReadTxtByText</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> TextAsset textAsset, Dictionary&lt;<span class="hljs-built_in">int</span>, <span class="hljs-built_in">string</span>&gt; dictionary</span>)
</span></code></pre>
<p><strong>æ–‡ä»¶æ ¼å¼ç¤ºä¾‹</strong>ï¼ˆUTF-8ï¼‰ï¼š</p>
<pre><code class="hljs">1	ç¬¬ä¸€æ­¥ï¼šç‚¹å‡»å¼€å§‹
2	ç¬¬äºŒæ­¥ï¼šè§‚å¯Ÿå˜åŒ–
</code></pre>
<h4 data-id="heading-14">ReadCsv</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> è¯»å–æœ¬åœ° CSV æ–‡ä»¶ï¼Œè¿”å› List<span class="hljs-doctag">&lt;List&lt;string&gt;</span>&gt;ï¼ˆäºŒç»´åˆ—è¡¨ï¼‰</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="file"&gt;</span>æ–‡ä»¶å®Œæ•´è·¯å¾„<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="rowsNum"&gt;</span>æ–‡ä»¶è¡Œæ•°ï¼ˆç”¨äºé˜²æ­¢æœ«å°¾ç©ºè¡Œï¼‰<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="splitChar"&gt;</span>åˆ—åˆ†éš”ç¬¦ï¼ˆé€šå¸¸ ,ï¼‰<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;List&lt;<span class="hljs-built_in">string</span>&gt;&gt; ReadCsv(<span class="hljs-built_in">string</span> file, <span class="hljs-built_in">int</span> rowsNum, <span class="hljs-built_in">char</span> splitChar = <span class="hljs-string">','</span>)
</code></pre>
<p><strong>è¿”å›æ ¼å¼</strong>ï¼š</p>
<ul>
<li>å¤–å±‚ Listï¼šæ¯ä¸€è¡Œ</li>
<li>å†…å±‚ Listï¼šæ¯è¡Œæ‹†åˆ†åçš„å•å…ƒæ ¼</li>
</ul>
<p><strong>æ³¨æ„</strong>ï¼šä½¿ç”¨ File.ReadAllTextï¼Œé€‚ç”¨äºæœ¬åœ°æ–‡ä»¶ï¼ˆEditor æˆ– StreamingAssets éœ€å…ˆæ‹·è´ï¼‰ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[H3C IPv6åŠ¨æ€åˆ†é…åœ°å€é…ç½®å®éªŒï¼ˆDHCPv6ã€å‰ç¼€å§”æ´¾ï¼‰]]></title>    <link>https://juejin.cn/post/7602931486597546019</link>    <guid>https://juejin.cn/post/7602931486597546019</guid>    <pubDate>2026-02-05T07:01:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602931486597546019" data-draft-id="7602916013877477391" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="H3C IPv6åŠ¨æ€åˆ†é…åœ°å€é…ç½®å®éªŒï¼ˆDHCPv6ã€å‰ç¼€å§”æ´¾ï¼‰"/> <meta itemprop="keywords" content="ç½‘ç»œåè®®"/> <meta itemprop="datePublished" content="2026-02-05T07:01:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸åšèœé¸Ÿçš„ç½‘å·¥"/> <meta itemprop="url" content="https://juejin.cn/user/3283597248432442"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            H3C IPv6åŠ¨æ€åˆ†é…åœ°å€é…ç½®å®éªŒï¼ˆDHCPv6ã€å‰ç¼€å§”æ´¾ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3283597248432442/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸åšèœé¸Ÿçš„ç½‘å·¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T07:01:15.000Z" title="Thu Feb 05 2026 07:01:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">DHCPv6é…ç½®</h2>
<p>æ–‡ç« æ‰€å±IPv6åœ°å€å‡ä¸ºæ¨¡æ‹Ÿåœ°å€ï¼Œé…ç½®ç¯å¢ƒä¸ºHCLæ¨¡æ‹Ÿç¯å¢ƒã€‚</p>
<h3 data-id="heading-1">ç½‘ç»œæ‹“æ‰‘ä¸è§’è‰²</h3>
<ul>
<li><strong>R1</strong>ï¼šISPè¾¹ç¼˜è·¯ç”±å™¨ï¼ˆDHCPv6æœåŠ¡å™¨ï¼‰</li>
<li><strong>R2</strong>ï¼šCPE/å®¢æˆ·ç«¯è·¯ç”±å™¨ï¼ˆDHCPv6å‰ç¼€å§”æ´¾å®¢æˆ·ç«¯ï¼‰</li>
<li><strong>PC1</strong>ã€<strong>PC2</strong>ï¼šIPv6ç»ˆç«¯ (æµ‹è¯•è·å–ipv6åœ°å€)</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7c18d0ce55bc486998b3ba8c44396edd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5YGa6I-c6bif55qE572R5bel:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879816&amp;x-signature=o%2FtFukjxX%2FDiwLsgCpIudXN3l9M%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-2">ä¸€ã€R1é…ç½®è¯¦è§£ï¼ˆISPä¾§ï¼‰</h3>
<h4 data-id="heading-3">1. åŸºç¡€DHCPv6é…ç½®</h4>
<pre><code class="hljs language-bash" lang="bash">dhcp <span class="hljs-built_in">enable</span>  <span class="hljs-comment"># å…¨å±€å¯ç”¨DHCPæœåŠ¡</span>
ipv6 dhcp prefix-pool 1 prefix 2001::/64 assign-len 80
<span class="hljs-comment"># åˆ›å»ºå‰ç¼€æ± "1"ï¼Œä»2001::/64åˆ†é…ï¼Œç»™å®¢æˆ·ç«¯åˆ†é…/80å‰ç¼€</span>
</code></pre>
<h4 data-id="heading-4">2. DHCPv6åœ°å€æ± é…ç½®</h4>
<pre><code class="hljs language-bash" lang="bash">ipv6 dhcp pool 1
 network 2001::/64            <span class="hljs-comment"># åœ°å€åˆ†é…èŒƒå›´</span>
 dns-server 2001::1           <span class="hljs-comment"># DNSæœåŠ¡å™¨</span>
 prefix-pool 1 preferred-lifetime 86400 valid-lifetime 259200  <span class="hljs-comment"># å‰ç¼€å§”æ´¾é…ç½®</span>
 static-bind prefix 2001:1234:1::/80 duid 000300011a79de090400  <span class="hljs-comment"># é™æ€ç»‘å®šç»™R2</span>
</code></pre>
<h4 data-id="heading-5">3. R1ä¸‹è”æ¥å£é…ç½®</h4>
<pre><code class="hljs language-bash" lang="bash">interface GigabitEthernet0/0
 ipv6 address 2001::1/64                     <span class="hljs-comment"># æ¥å£åœ°å€</span>
 ipv6 address FE80::187B:48FF:FE0D:105 link-local  <span class="hljs-comment"># é“¾è·¯æœ¬åœ°åœ°å€</span>
 ipv6 dhcp select server                    <span class="hljs-comment"># å¯ç”¨DHCPv6æœåŠ¡å™¨åŠŸèƒ½</span>
 ipv6 dhcp server allow-hint preference 255 rapid-commit  <span class="hljs-comment"># å…è®¸å®¢æˆ·ç«¯æç¤ºï¼Œä¼˜å…ˆçº§æœ€é«˜</span>
 ipv6 nd autoconfig managed-address-flag    <span class="hljs-comment"># å‘ŠçŸ¥å®¢æˆ·ç«¯ä½¿ç”¨DHCPv6è·å–åœ°å€</span>
 ipv6 nd autoconfig other-flag              <span class="hljs-comment"># å‘ŠçŸ¥å®¢æˆ·ç«¯ä½¿ç”¨DHCPv6è·å–å…¶ä»–é…ç½®</span>
 undo ipv6 nd ra halt                       <span class="hljs-comment"># å‘é€RAæ¶ˆæ¯</span>
 ipv6 nd ra router-lifetime 1800            <span class="hljs-comment"># è·¯ç”±å™¨ç”Ÿå­˜æ—¶é—´1800ç§’</span>
</code></pre>
<h4 data-id="heading-6">4. å›ç¨‹è·¯ç”±é…ç½®</h4>
<p>å»å¾€å‰ç¼€å§”æ´¾çš„ç½‘æ®µéœ€æ‰‹åŠ¨é…ç½®</p>
<pre><code class="hljs language-bash" lang="bash">ipv6 route-static 2001:1234:1:: 80 GigabitEthernet0/0 FE80::1879:DEFF:FE09:405
<span class="hljs-comment"># æŒ‡å‘R2è·å–çš„å‰ç¼€ï¼Œä½¿ç”¨R2çš„é“¾è·¯æœ¬åœ°åœ°å€ä½œä¸ºä¸‹ä¸€è·³</span>
</code></pre>
<h3 data-id="heading-7">äºŒã€R2é…ç½®è¯¦è§£ï¼ˆå®¢æˆ·ç«¯ä¾§ï¼‰</h3>
<h4 data-id="heading-8">1. R2-WANå£é…ç½®</h4>
<pre><code class="hljs language-bash" lang="bash">interface GigabitEthernet0/0
 ipv6 address FE80::1879:DEFF:FE09:405 link-local
 ipv6 address auto link-local              <span class="hljs-comment"># è‡ªåŠ¨ç”Ÿæˆé“¾è·¯æœ¬åœ°åœ°å€</span>
 ipv6 address dhcp-alloc                   <span class="hljs-comment"># é€šè¿‡DHCPv6è·å–å…¨çƒå•æ’­åœ°å€</span>
 ipv6 dhcp client pd 1                     <span class="hljs-comment"># è¯·æ±‚å‰ç¼€å§”æ´¾ï¼ˆéœ€äº‹å…ˆå¼€å¯DHCPï¼‰</span>
</code></pre>
<h4 data-id="heading-9">2. R2-LANå£é…ç½®</h4>
<pre><code class="hljs language-bash" lang="bash">interface GigabitEthernet0/1
 ipv6 address 2001:1234:1::1/80           <span class="hljs-comment"># ä½¿ç”¨ä»R1è·å–çš„å‰ç¼€</span>
 ipv6 dhcp select server                  <span class="hljs-comment"># å¯ç”¨DHCPv6æœåŠ¡å™¨</span>
 ipv6 dhcp server apply pool 1            <span class="hljs-comment"># åº”ç”¨åœ°å€æ± </span>
 undo ipv6 nd ra halt
 ipv6 nd ra router-lifetime 1800          <span class="hljs-comment"># é€šå‘Šè‡ªå·±ä¸ºé»˜è®¤ç½‘å…³</span>
</code></pre>
<h4 data-id="heading-10">3. DHCPv6æœåŠ¡é…ç½®</h4>
<pre><code class="hljs language-bash" lang="bash">dhcp <span class="hljs-built_in">enable</span>
ipv6 dhcp pool 1
 network 2001:1234:1::/80  <span class="hljs-comment"># ä½¿ç”¨å§”æ´¾çš„å‰ç¼€åˆ†é…åœ°å€</span>
 dns-server 2001:1234:1::1  <span class="hljs-comment"># DNSæœåŠ¡å™¨ï¼ˆæŒ‡å‘è‡ªå·±æˆ–ISPçš„DNSï¼‰</span>
</code></pre>
<h3 data-id="heading-11">ä¸‰ã€å·¥ä½œåŸç†æµç¨‹</h3>
<h4 data-id="heading-12">1. å‰ç¼€å§”æ´¾è¿‡ç¨‹</h4>
<pre><code class="hljs language-scss" lang="scss">R2 (å®¢æˆ·ç«¯)                          R1 (æœåŠ¡å™¨)
  |---<span class="hljs-attr">--Solicit</span> (è¯·æ±‚PD)--------------&gt;|
  |&lt;---<span class="hljs-attr">--Advertise</span> (é€šå‘Šå¯ç”¨PD)--------|
  |---<span class="hljs-attr">--Request</span> (è¯·æ±‚PD)--------------&gt;|
  |&lt;---<span class="hljs-attr">--Reply</span> (åˆ†é…<span class="hljs-number">2001</span>:<span class="hljs-number">1234</span>:<span class="hljs-number">1</span>::/<span class="hljs-number">80</span>)--|
</code></pre>
<h4 data-id="heading-13">2. åœ°å€åˆ†é…è¿‡ç¨‹</h4>
<pre><code class="hljs language-scss" lang="scss">ä¸‹æ¸¸è®¾å¤‡                           R2 (DHCPæœåŠ¡å™¨)
  |---<span class="hljs-attr">--Solicit----------------------</span>&gt;|
  |&lt;---<span class="hljs-attr">--Advertise--------------------</span>|
  |---<span class="hljs-attr">--Request----------------------</span>&gt;|
  |&lt;---<span class="hljs-attr">--Reply</span> (åˆ†é…<span class="hljs-number">2001</span>:<span class="hljs-number">1234</span>:<span class="hljs-number">1</span>::/<span class="hljs-number">128</span>)|
</code></pre>
<h4 data-id="heading-14">3. è·¯ç”±æµç¨‹</h4>
<pre><code class="hljs language-javascript" lang="javascript">äº’è”ç½‘ â†’ <span class="hljs-variable constant_">R1</span> â†’ <span class="hljs-number">2001</span>::<span class="hljs-regexp">/64ç½‘ç»œ â†’ R2 â†’ 2001:1234:1::/</span><span class="hljs-number">80</span>ç½‘ç»œ â†’ å†…éƒ¨è®¾å¤‡
å†…éƒ¨è®¾å¤‡ â†’ <span class="hljs-variable constant_">R2</span> â†’ <span class="hljs-variable constant_">R1</span> (é€šè¿‡é»˜è®¤è·¯ç”±) â†’ äº’è”ç½‘
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d5753db890245b084372956654ee65c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5YGa6I-c6bif55qE572R5bel:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879816&amp;x-signature=U0WfZTus9sussni1GNSNonO4dew%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e877d621ef434ab88c22c863643054f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5YGa6I-c6bif55qE572R5bel:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879816&amp;x-signature=wrqW1OO8J6%2Fa5ZP3bZ%2BmBbeGty8%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-15">å››ã€å…³é”®æŠ€æœ¯ç‚¹</h3>
<h4 data-id="heading-16">1. DHCPv6åˆ†é…æ–¹å¼</h4>
<ul>
<li><strong>å‰ç¼€å§”æ´¾ (PD)</strong>ï¼šä¸ºç«™ç‚¹/è·¯ç”±å™¨åˆ†é…åœ°å€å—ï¼ˆå¦‚/56, /60, /64ï¼‰
<ul>
<li>ç”¨é€”ï¼šä¼ä¸šç«™ç‚¹ã€å®¶åº­ç½‘ç»œä¸‹çº§è·¯ç”±</li>
<li>ç¤ºä¾‹ï¼šåˆ†é…2001:1234:1::/80ç»™R2ï¼Œç„¶åR2å†å¾€ä¸‹æ¸¸åˆ†é…</li>
</ul>
</li>
<li><strong>åœ°å€åˆ†é… (IA_NA)</strong>ï¼šä¸ºç»ˆç«¯åˆ†é…å•ä¸ªIPv6åœ°å€ï¼ˆ/128ï¼‰
<ul>
<li>ç”¨é€”ï¼šPCã€æ‰‹æœºç­‰ç»ˆç«¯è®¾å¤‡</li>
<li>ç¤ºä¾‹ï¼šåˆ†é…2001::100/128ç»™å®¢æˆ·ç«¯</li>
</ul>
</li>
</ul>
<h4 data-id="heading-17">2. RAæ ‡å¿—ä½å«ä¹‰</h4>
<pre><code class="hljs language-bash" lang="bash">ipv6 nd autoconfig managed-address-flag  <span class="hljs-comment"># Mæ ‡å¿—=1ï¼Œä½¿ç”¨DHCPv6è·å–åœ°å€</span>
ipv6 nd autoconfig other-flag           <span class="hljs-comment"># Oæ ‡å¿—=1ï¼Œä½¿ç”¨DHCPv6è·å–å…¶ä»–é…ç½®</span>
<span class="hljs-comment"># ç»„åˆæ„ä¹‰ï¼š</span>
<span class="hljs-comment"># M=1,O=0: ä»…åœ°å€é€šè¿‡DHCPv6è·å–</span>
<span class="hljs-comment"># M=0,O=1: SLAACè·å–åœ°å€ï¼Œå…¶ä»–é…ç½®é€šè¿‡DHCPv6</span>
<span class="hljs-comment"># M=1,O=1: åœ°å€å’Œå…¶ä»–é…ç½®éƒ½é€šè¿‡DHCPv6</span>
</code></pre>
<h4 data-id="heading-18">3. é™æ€å‰ç¼€ç»‘å®š</h4>
<pre><code class="hljs language-bash" lang="bash">static-bind prefix 2001:1234:1::/80 duid 000300011a79de090400
<span class="hljs-comment"># åŸºäºDUIDå›ºå®šåˆ†é…ç‰¹å®šå‰ç¼€ç»™ç‰¹å®šå®¢æˆ·ç«¯</span>
<span class="hljs-comment"># DUIDè·å–ï¼šåœ¨å®¢æˆ·ç«¯æ‰§è¡Œ `display ipv6 dhcp duid`</span>
</code></pre>
<h4 data-id="heading-19">4. é“¾è·¯æœ¬åœ°åœ°å€è·¯ç”±</h4>
<pre><code class="hljs language-bash" lang="bash">ipv6 route-static 2001:1234:1:: 80 GigabitEthernet0/0 FE80::1879:DEFF:FE09:405
<span class="hljs-comment"># ä½¿ç”¨é“¾è·¯æœ¬åœ°åœ°å€ä½œä¸ºä¸‹ä¸€è·³</span>
<span class="hljs-comment"># ä¼˜åŠ¿ï¼šä¸ä¾èµ–å…¨çƒå•æ’­åœ°å€å˜åŒ–ï¼Œæ›´ç¨³å®š</span>
</code></pre>
<h3 data-id="heading-20">äº”ã€éªŒè¯å‘½ä»¤</h3>
<h4 data-id="heading-21">åœ¨R1ä¸ŠæŸ¥çœ‹</h4>
<pre><code class="hljs language-bash" lang="bash">dis ipv6 dhcp server ip-in-use      <span class="hljs-comment"># æŸ¥çœ‹åˆ†é…çš„IPv6åœ°å€</span>
dis ipv6 dhcp server pd-in-use     <span class="hljs-comment"># æŸ¥çœ‹å‰ç¼€å§”æ´¾åˆ†é…æƒ…å†µ</span>
dis ipv6 dhcp server statistics    <span class="hljs-comment"># æŸ¥çœ‹DHCPv6æœåŠ¡å™¨ç»Ÿè®¡</span>
dis ipv6 dhcp server pool 1        <span class="hljs-comment"># æŸ¥çœ‹åœ°å€æ± ä¿¡æ¯</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2d04c77d0cc43fe8b84392a187ef926~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5YGa6I-c6bif55qE572R5bel:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879816&amp;x-signature=MqEWz5AduOvl5UVOJXrklGZPFRs%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-22">åœ¨R2ä¸ŠæŸ¥çœ‹</h4>
<pre><code class="hljs language-bash" lang="bash">dis ipv6 dhcp client               <span class="hljs-comment"># æŸ¥çœ‹DHCPv6å®¢æˆ·ç«¯çŠ¶æ€</span>
dis ipv6 dhcp server ip-in-use    <span class="hljs-comment"># æŸ¥çœ‹R2åˆ†é…çš„åœ°å€</span>
dis ipv6 dhcp duid                <span class="hljs-comment"># æŸ¥çœ‹æœ¬æœºDUID</span>
dis ipv6 interface brief          <span class="hljs-comment"># æŸ¥çœ‹IPv6æ¥å£åœ°å€</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f0bcf4cddcc94750bcc354375ff6433a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5YGa6I-c6bif55qE572R5bel:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879816&amp;x-signature=nzOoLUHc6Gql%2Bsl3asQNsNAvg2U%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-23">PC1è¿é€šæ€§æµ‹è¯•</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d4b2406fcc5245e5a3edbf22f0afee79~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5YGa6I-c6bif55qE572R5bel:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879816&amp;x-signature=lwglvmUlcqohdwmRWOi8RVwd0Fk%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-24">PC2 è¿é€šæ€§æµ‹è¯•</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ca56b7a2757458f9fbc2b0a8442dbfa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiN5YGa6I-c6bif55qE572R5bel:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770879816&amp;x-signature=2fGDZzd0bs28XrNwnupYBUCikUk%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-25">å…­ã€å¸¸è§é—®é¢˜ä¸æ’é”™</h3>
<ol>
<li>
<p><strong>å‰ç¼€åˆ†é…å¤±è´¥</strong></p>
<ul>
<li>æ£€æŸ¥å‰ç¼€æ± é…ç½®ï¼š<code>assign-len</code>ä¸èƒ½å°äºå‰ç¼€é•¿åº¦</li>
<li>æ£€æŸ¥å®¢æˆ·ç«¯DUIDæ˜¯å¦åŒ¹é…é™æ€ç»‘å®š</li>
<li>æ£€æŸ¥æ¥å£æ˜¯å¦å¯ç”¨<code>ipv6 dhcp client pd</code></li>
</ul>
</li>
<li>
<p><strong>è·¯ç”±ä¸é€š</strong></p>
<ul>
<li>æ£€æŸ¥å›ç¨‹è·¯ç”±é…ç½®æ˜¯å¦æ­£ç¡®</li>
<li>éªŒè¯é“¾è·¯æœ¬åœ°åœ°å€å¯è¾¾æ€§</li>
<li>æ£€æŸ¥RAæ˜¯å¦è¢«æŠ‘åˆ¶ï¼ˆ<code>undo ipv6 nd ra halt</code>ï¼‰</li>
</ul>
</li>
<li>
<p><strong>åœ°å€è·å–å¤±è´¥</strong></p>
<ul>
<li>ç¡®è®¤M/Oæ ‡å¿—ä½è®¾ç½®æ­£ç¡®</li>
<li>æ£€æŸ¥DHCPv6æœåŠ¡å™¨æ˜¯å¦å¯ç”¨<code>allow-hint</code></li>
<li>éªŒè¯ç½‘ç»œè¿é€šæ€§ï¼ˆé“¾è·¯æœ¬åœ°åœ°å€å¯pingé€šï¼‰</li>
</ul>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[çº¢å¤–å°ç›®æ ‡æ£€æµ‹æ–°çªç ´ï¼æµ™å¤§å›¢é˜Ÿæå‡ºDQAlignerï¼šå¤§ä½ç§»åœºæ™¯ä¸‹ä¾ç„¶ç¨³å®šè·Ÿè¸ª]]></title>    <link>https://juejin.cn/post/7602936997174657076</link>    <guid>https://juejin.cn/post/7602936997174657076</guid>    <pubDate>2026-02-05T05:32:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602936997174657076" data-draft-id="7602929352716419072" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="çº¢å¤–å°ç›®æ ‡æ£€æµ‹æ–°çªç ´ï¼æµ™å¤§å›¢é˜Ÿæå‡ºDQAlignerï¼šå¤§ä½ç§»åœºæ™¯ä¸‹ä¾ç„¶ç¨³å®šè·Ÿè¸ª"/> <meta itemprop="keywords" content="ç®—æ³•,è®¡ç®—æœºè§†è§‰,æ·±åº¦å­¦ä¹ "/> <meta itemprop="datePublished" content="2026-02-05T05:32:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="CoovallyAIHub"/> <meta itemprop="url" content="https://juejin.cn/user/2461151071843739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            çº¢å¤–å°ç›®æ ‡æ£€æµ‹æ–°çªç ´ï¼æµ™å¤§å›¢é˜Ÿæå‡ºDQAlignerï¼šå¤§ä½ç§»åœºæ™¯ä¸‹ä¾ç„¶ç¨³å®šè·Ÿè¸ª
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2461151071843739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    CoovallyAIHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T05:32:34.000Z" title="Thu Feb 05 2026 05:32:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>çº¢å¤–æˆåƒé¢†åŸŸçš„å°ç›®æ ‡æ£€æµ‹ä¸€ç›´æ˜¯ä¸ªæŠ€æœ¯éš¾é¢˜â€”â€”ç›®æ ‡å¯èƒ½åªæ˜¯å‡ ä¸ªåƒç´ ç‚¹ï¼Œè¿˜å¸¸å¸¸æ·¹æ²¡åœ¨å¤æ‚çš„äº‘å±‚ã€æµ·é¢èƒŒæ™¯æˆ–è€…ä¼ æ„Ÿå™¨å™ªå£°é‡Œã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªéš¾é¢˜ï¼Œç ”ç©¶è€…ä»¬å¼€å§‹åˆ©ç”¨å¤šå¸§æ—¶ç©ºä¿¡æ¯ï¼Œä½†æ–°çš„é—®é¢˜éšä¹‹è€Œæ¥ï¼šå½“æ‘„åƒæœºæˆ–ç›®æ ‡å¿«é€Ÿç§»åŠ¨æ—¶ï¼Œä¼ ç»Ÿå¯¹é½æ–¹æ³•å®¹æ˜“â€œæŠ“çâ€ã€‚</p>
<p>æœ€è¿‘ï¼Œæ¥è‡ªæµ™æ±Ÿå¤§å­¦ã€ç”µå­ç§‘æŠ€å¤§å­¦ä¸­å±±å­¦é™¢ä»¥åŠè¥¿ç­ç‰™åŸƒæ–¯ç‰¹é›·é©¬æœæ‹‰å¤§å­¦çš„ç ”ç©¶å›¢é˜Ÿåœ¨ IEEE TGRS 2025 ä¸Šå‘è¡¨äº†ä¸€é¡¹åˆ›æ–°ç ”ç©¶ï¼Œæå‡ºäº† DQAligner æ¡†æ¶ï¼Œä¸ºè§£å†³å¤§ä½ç§»çº¢å¤–å°ç›®æ ‡æ£€æµ‹é—®é¢˜æä¾›äº†å…¨æ–°æ€è·¯ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d456ef802905499c8b39b56923ef6acc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770874357&amp;x-signature=elcq4ZEPPkXGrPieP5NWP%2FIvscM%3D" alt="å›¾ç‰‡1.png" loading="lazy"/></p>
<blockquote>
<p><strong>è®ºæ–‡åœ°å€ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fdoi.org%2F10.1109%2FTGRS.2026.3657842" target="_blank" title="https://doi.org/10.1109/TGRS.2026.3657842" ref="nofollow noopener noreferrer">doi.org/10.1109/TGRâ€¦</a></p>
<p>****<strong>ä»£ç ä»“åº“ï¼š</strong> <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fdengfa02%2FDQAligner_MIRSTD" target="_blank" title="https://github.com/dengfa02/DQAligner_MIRSTD" ref="nofollow noopener noreferrer">github.com/dengfa02/DQâ€¦</a></p>
</blockquote>
<h2 data-id="heading-0"><strong>ä¸ºä»€ä¹ˆå¤§ä½ç§»æˆäº†å¤šå¸§æ£€æµ‹çš„å™©æ¢¦ï¼Ÿ</strong></h2>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ¯”å¦‚æ— äººæœºè½½çº¢å¤–ç›¸æœºæˆ–é«˜é€Ÿç§»åŠ¨ç›®æ ‡ç›‘æ§ï¼Œå¹³å°æŠ–åŠ¨å’Œç›®æ ‡æœºåŠ¨ä¼šå¯¼è‡´ç›¸é‚»å¸§ä¹‹é—´å‡ºç°å¤§å¹…ä½ç§»ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ac7e4bfe38e04d58b361559bee42c79f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770874357&amp;x-signature=0JIpksUbvGgRyr%2B%2BVay3NwxSEZs%3D" alt="å›¾ç‰‡2.png" loading="lazy"/></p>
<p>ç ”ç©¶å›¢é˜Ÿå‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„ç°è±¡ï¼šé•¿å°¾æ•ˆåº”ã€‚åœ¨ç°æœ‰è®­ç»ƒé›†ä¸­ï¼Œç»å¤§å¤šæ•°æ ·æœ¬çš„ä½ç§»éƒ½å¾ˆå°ï¼ˆå°äº10åƒç´ çš„å 84%ä»¥ä¸Šï¼‰ï¼Œè¿™å¯¼è‡´æ¨¡å‹åœ¨é¢å¯¹ä¸åˆ°16%çš„å¤§ä½ç§»åœºæ™¯æ—¶è¡¨ç°æŒ£æ‰ã€‚</p>
<p>ä¼ ç»Ÿçš„å¯¹é½æ–¹æ¡ˆï¼Œå¦‚å…‰æµæ³•æˆ–å¯å˜å½¢å·ç§¯ç½‘ç»œï¼Œé€šå¸¸æ„Ÿå—é‡æœ‰é™ã€‚å½“ç›®æ ‡è·³å‡ºè¿™ä¸ªèŒƒå›´ï¼Œæˆ–è€…èƒŒæ™¯ä¸­æœ‰ç›¸ä¼¼å¹²æ‰°ç‰©æ—¶ï¼Œæ¨¡å‹å°±ä¼šé™·å…¥â€œå¯¹é½ç„¦è™‘â€ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c246e7ff3d64dcca4bbc9130de9cbcf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770874357&amp;x-signature=S9t4ESh9%2B%2F5P%2B5BE3%2BASwG0FB0Y%3D" alt="å›¾ç‰‡3.png" loading="lazy"/></p>
<h2 data-id="heading-1"><strong>DQAlignerï¼šä»â€œç¡¬å¯¹é½â€åˆ°â€œæŸ”æ€§åŒ¹é…â€</strong></h2>
<p>DQAligner çš„æ ¸å¿ƒæ€æƒ³æ˜¯ä»å…¨å±€è§†è§’å‡ºå‘ï¼Œå»ºç«‹æ›´ç¨³å¥çš„ç‰¹å¾å…³è”ï¼Œå…¶åˆ›æ–°ç‚¹ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li><strong>å¹¶è¡Œéª¨å¹²ç½‘ç»œè®¾è®¡</strong></li>
</ul>
<p>ä¸ºäº†è®©æ¨¡å‹é€‚åº”â€œå¤§ä½ç§»â€åœºæ™¯ï¼Œç ”ç©¶å›¢é˜Ÿå¼•å…¥äº†å…¨å±€éšæœºå¤§ä½ç§»å¢å¼ºç­–ç•¥ï¼Œæ¨¡æ‹Ÿå¹³å°å‰§çƒˆæŠ–åŠ¨ã€‚æ¶æ„ä¸Šé‡‡ç”¨å¹¶è¡Œéª¨å¹²ç½‘ç»œï¼Œä¸€æ¬¡æ€§å¤„ç†å¤šå¸§å›¾åƒã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e730f38aab44f389936615d0d2b2517~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770874357&amp;x-signature=UpjDhzc2bBOO9Q5aSpLoW1swzME%3D" alt="å›¾ç‰‡4.png" loading="lazy"/></p>
<p>è¿™ç§è®¾è®¡å°†æ—¶é—´ç»´åº¦å’ŒBatchç»´åº¦åˆå¹¶å¤„ç†ï¼Œä¸ä»…æé«˜äº†æ¨ç†æ•ˆç‡ï¼Œè¿˜è®©BatchNormç»Ÿè®¡é‡åœ¨æ—¶ç©ºç»´åº¦ä¸Šæ›´ç¨³å®šï¼Œå®é™…ä¸Šæ‰©å¤§äº†æ¨¡å‹çš„æ—¶é—´æ„Ÿå—é‡ã€‚</p>
<ul>
<li><strong>å¿«é€Ÿå°ºåº¦èµ„æºåˆ†é…æ¨¡å—</strong></li>
</ul>
<p>å¤šå¸§åŠ å¤šå°ºåº¦é€šå¸¸ä¼šå¯¼è‡´è®¡ç®—é‡çˆ†ç‚¸ã€‚ä¸ºäº†å…¼é¡¾æ•ˆç‡ï¼ŒDQAlignerè®¾è®¡äº†å¿«é€Ÿå°ºåº¦èµ„æºåˆ†é…æ¨¡å—ï¼ŒæŠŠå¤æ‚çš„æ—¶ç©ºæ³¨æ„åŠ›æ‹†è§£ä¸ºä¸‰ä¸ªæ”¯è·¯ï¼š</p>
<ul>
<li>é€šé“åˆ†é…å™¨ï¼šé€šè¿‡å…¨å±€å¹³å‡æ± åŒ–æå–è¯­ä¹‰æƒé‡</li>
<li>ç©ºé—´åˆ†é…å™¨ï¼šå®šä½å…³é”®çš„ç©ºé—´åŒºåŸŸ</li>
<li>å¸§åˆ†é…å™¨ï¼šåœ¨æ—¶é—´è½´ä¸Šåˆ†é…æƒé‡</li>
</ul>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b035a247278b44beba539ec546f30d41~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770874357&amp;x-signature=rNCrEV6uaqjz5lFOG%2Bu7s9%2FdVzk%3D" alt="å›¾ç‰‡5.png" loading="lazy"/></p>
<p>è¿™ç§è®¾è®¡å¦‚åŒç»™æ¨¡å‹å®‰è£…äº†ä¸€ä¸ªâ€œè°ƒåº¦ä¸­å¿ƒâ€ï¼Œè®©å®ƒçŸ¥é“åœ¨å“ªä¸ªå°ºåº¦ã€å“ªä¸€å¸§ã€å“ªä¸ªé€šé“è¯¥æŠ•å…¥æ›´å¤šè®¡ç®—èµ„æºã€‚</p>
<ul>
<li><strong>åŒå‘å…±äº«è¿åŠ¨äº¤äº’æœºåˆ¶</strong></li>
</ul>
<p>è·¨å¸§è¿åŠ¨äº¤äº’æ¨¡å—é€šè¿‡åŒå‘å…±äº«æ³¨æ„åŠ›æœºåˆ¶ï¼Œè®©å‚è€ƒå¸§å’Œå½“å‰å¸§äº’ç›¸â€œå¯¹è´¨â€ã€‚</p>
<p>å…¶æ ¸å¿ƒé€»è¾‘æ˜¯ï¼šå¦‚æœä¸€ä¸ªç‚¹åœ¨æ­£å‘æœç´¢ï¼ˆå‚è€ƒå¸§åˆ°å…³é”®å¸§ï¼‰å’Œåå‘æœç´¢ä¸­éƒ½èƒ½åŒ¹é…ä¸Šï¼Œé‚£å®ƒå¤§æ¦‚ç‡æ˜¯çœŸå®ç›®æ ‡ã€‚è¿™ç§å…±äº«æœºåˆ¶èƒ½è®©éšæœºçš„èƒŒæ™¯å™ªå£°åœ¨æ¢¯åº¦æ›´æ–°ä¸­äº’ç›¸æŠµæ¶ˆï¼Œè€ŒçœŸæ­£ç¨³å®šçš„ç›®æ ‡ä¿¡å·åˆ™ä¼šå¾—åˆ°åŠ å¼ºã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f684b4302da34e1796cbd52047436cbc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770874357&amp;x-signature=rQqwjLqWBWQi3ZIADaBqkVH6c%2FY%3D" alt="å›¾ç‰‡6.png" loading="lazy"/></p>
<ul>
<li><strong>åŠ¨æ€æ„Ÿå—é‡é‡‘å­—å¡”å¯¹é½</strong></li>
</ul>
<p>å¯¹äºå…·ä½“çš„å¯¹é½æ“ä½œï¼ŒåŠ¨æ€æ„Ÿå—é‡é‡‘å­—å¡”å¯¹é½æ¨¡å—é‡‡ç”¨é‡‘å­—å¡”ç»“æ„ã€‚å®ƒä¸å†ä½¿ç”¨å›ºå®šçš„å·ç§¯æ ¸ï¼Œè€Œæ˜¯é€šè¿‡åŠ¨æ€ç”Ÿæˆå™¨å†³å®šæ„Ÿå—é‡çš„å¤§å°ï¼ˆç­‰æ•ˆæ„Ÿå—é‡ä»3x3ä¸€ç›´è¦†ç›–åˆ°49x49ï¼‰ã€‚</p>
<p>è¿™ç§ä»ç²—åˆ°ç²¾çš„ç­–ç•¥èƒ½æ›´å¥½åœ°åˆ†è§£å¤æ‚çš„éçº¿æ€§è¿åŠ¨ã€‚å³ä½¿ç›®æ ‡è·‘å¾—å¿«ï¼ŒåŠ¨æ€æ„Ÿå—é‡ä¹Ÿèƒ½â€œè·Ÿå¾—ä¸Šâ€ã€‚</p>
<ul>
<li><strong>æ ¸å¿ƒåˆ›æ–°ï¼šç±»æŸ¥è¯¢å­˜å‚¨æœºåˆ¶</strong></li>
</ul>
<p>è¿™æ˜¯DQAligneræœ€æ ¸å¿ƒçš„åˆ›æ–°ã€‚ç±»æŸ¥è¯¢å­˜å‚¨å°±åƒä¸€ä¸ªæ‹¥æœ‰â€œçŸ­æœŸè®°å¿†â€çš„è®°äº‹æœ¬ï¼Œé€šè¿‡éšè—çŠ¶æ€è¿­ä»£å­¦ä¹ ç›®æ ‡çš„ç‰¹å¾ã€‚</p>
<p>å…·ä½“è®¡ç®—æµç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç‰¹å¾æå–ï¼šä»å‚è€ƒå¸§æå–åˆå§‹ç‰¹å¾</li>
<li>é€’å½’æ›´æ–°ï¼šé€šè¿‡é—¨æ§å•å…ƒä¸æ–­æ›´æ–°è¿™ä¸ªå…¨å±€Query</li>
<li>æ©ç çº¦æŸï¼šæœ€åç”¨è¿™ä¸ªQueryå»â€œè¿‡æ»¤â€å¯¹é½åçš„ç‰¹å¾ï¼Œç”Ÿæˆè¿åŠ¨æ©ç </li>
</ul>
<p>è¿™ä¸ªè®¾è®¡çš„å¦™å¤„åœ¨äºï¼šå³ä½¿åœ¨æç«¯å¤§ä½ç§»ä¸‹åƒç´ çº§å¯¹é½å¤±è´¥ï¼ŒCQMä¾ç„¶èƒ½å‡­å€Ÿå­¦åˆ°çš„å…¨å±€è¯­ä¹‰ä¿¡æ¯ï¼Œç›´æ¥ä»å½“å‰å¸§é‡ŒæŠŠç›®æ ‡â€œæœâ€å‡ºæ¥ã€‚è¿™å®ç°äº†ä»ç¡¬æ€§åƒç´ å¯¹é½åˆ°æŸ”æ€§è¯­ä¹‰åŒ¹é…çš„èŒƒå¼è½¬å˜ã€‚</p>
<h2 data-id="heading-2"><strong>å®éªŒç»“æœï¼šæ€§èƒ½æ˜¾è‘—æå‡</strong></h2>
<p>ç ”ç©¶å›¢é˜Ÿåœ¨ä¸¤ä¸ªé‡é‡çº§æ•°æ®é›†ä¸Šè¿›è¡Œäº†æµ‹è¯•ï¼šNUDT-MIRSDTï¼ˆæ¨¡æ‹Ÿé™æ€å¹³å°ï¼‰å’ŒIRDSTï¼ˆçœŸå®/æ¨¡æ‹Ÿç§»åŠ¨å¹³å°ï¼‰ã€‚</p>
<p>åœ¨æ›´å…·æŒ‘æˆ˜æ€§çš„IRDSTæ•°æ®é›†ä¸Šï¼ŒDQAlignerçš„è¡¨ç°éå¸¸æŠ¢çœ¼ï¼š</p>
<ul>
<li>IoUè¾¾åˆ°69.465%</li>
<li>F1åˆ†æ•°è¾¾åˆ°81.982%</li>
</ul>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d023812506554c97b38fb9b77a1c2a02~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770874357&amp;x-signature=AvSMi2gHN1jJRkVrLL%2BWzd8TXeg%3D" alt="å›¾ç‰‡7.png" loading="lazy"/></p>
<p>å‚æ•°é‡ä»…ä¸º0.55Mï¼Œæ¯”å¾ˆå¤šå•å¸§æ–¹æ³•è¿˜è¦è½»é‡</p>
<p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œä¹‹å‰çš„å¤šå¸§SOTAæ–¹æ³•å¦‚DNANet-DTUMåœ¨å¤§ä½ç§»ä¸‹çš„IoUä»…ä¸º65.49%ã€‚</p>
<p>åœ¨ä½ä¿¡å™ªæ¯”ï¼ˆSCRâ‰¤3ï¼‰çš„æç«¯æƒ…å†µä¸‹ï¼ŒDQAlignerçš„ä¼˜åŠ¿æ›´åŠ æ˜æ˜¾ã€‚ä»ROCæ›²çº¿å¯ä»¥çœ‹å‡ºï¼Œå®ƒçš„æ›²çº¿æœ€é è¿‘å·¦ä¸Šè§’ï¼Œæ„å‘³ç€åœ¨ä¿æŒé«˜æ£€å‡ºç‡çš„åŒæ—¶ï¼Œè™šè­¦æ§åˆ¶å¾—æå¥½ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a672bfb44d4b4306b31179b5e5db86d7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770874357&amp;x-signature=2xeFQfM9r72pYgpIyHsj6Brb%2B%2FE%3D" alt="å›¾ç‰‡8.png" loading="lazy"/></p>
<p>å¯è§†åŒ–ç»“æœä¹Ÿå°è¯äº†è¿™ä¸€ä¼˜åŠ¿ã€‚åœ¨ä¸€äº›èƒŒæ™¯å¿«é€Ÿç§»åŠ¨ï¼ˆå¦‚æ¥¼æˆ¿è¾¹ç¼˜ã€å¤æ‚äº‘å±‚ï¼‰çš„åœºæ™¯ä¸­ï¼Œå…¶ä»–æ–¹æ³•å®¹æ˜“æŠŠè¾¹ç¼˜è¯¯åˆ¤ä¸ºç›®æ ‡æˆ–è·Ÿä¸¢ç›®æ ‡ï¼Œè€ŒDQAlignerèƒ½å¤Ÿç¨³å®šåœ°é”å®šçœŸå®ç›®æ ‡ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be54b08a4455405e9299572ad7b37a69~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770874357&amp;x-signature=klMOAd0qzJHxbC9ub%2BI0ZfgEtYs%3D" alt="å›¾ç‰‡9.png" loading="lazy"/></p>
<h2 data-id="heading-3"><strong>æŠ€æœ¯åŸç†æ·±åº¦è§£æ</strong></h2>
<p>ä¸ºä»€ä¹ˆCQMå’ŒDFDAå¦‚æ­¤æœ‰æ•ˆï¼Ÿç ”ç©¶å›¢é˜Ÿé€šè¿‡è¯¦å°½çš„æ¶ˆèå®éªŒè¿›è¡Œäº†éªŒè¯ã€‚</p>
<p>å®éªŒè¡¨æ˜ï¼Œåœ¨ä¸åŒä½ç§»ï¼ˆå¤§ã€ä¸­ã€å°ï¼‰åœºæ™¯ä¸‹ï¼ŒDFDAè´Ÿè´£åˆæ­¥å¯¹é½ï¼Œè€ŒCQMè´Ÿè´£è¿›ä¸€æ­¥ç²¾ç»†åŒ–å®šä½ã€‚ç‰¹åˆ«æ˜¯åœ¨å¤§ä½ç§»åœºæ™¯ä¸‹ï¼Œå•çº¯çš„å¯¹é½å·²ç»å¤±æ•ˆï¼Œä½†ç»è¿‡CQMçš„çº¦æŸï¼Œç›®æ ‡ç‰¹å¾ä¾ç„¶èƒ½è¢«æ¸…æ™°åœ°æå–å‡ºæ¥ã€‚</p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2da7a35d6a05403a9c6eb599070767d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770874357&amp;x-signature=U8ggW3iWwFgDjrsSBpdUx8CcV8s%3D" alt="å›¾ç‰‡10.png" loading="lazy"/></p>
<p align="center"><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9ebce4dfa7742d48b3af501f0cd512a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ29vdmFsbHlBSUh1Yg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770874357&amp;x-signature=pAkgwm5LyZF7dujSQv%2BLVxjT5CQ%3D" alt="å›¾ç‰‡11.png" loading="lazy"/></p>
<p>CMIæ¨¡å—çš„ä½œç”¨ä¹Ÿé€šè¿‡å®éªŒå¾—åˆ°è¯å®ï¼šæœ‰äº†åŒå‘å…±äº«æ³¨æ„åŠ›ï¼Œç›®æ ‡çš„èƒ½é‡è¢«æ˜¾è‘—æ”¾å¤§ï¼Œè€ŒèƒŒæ™¯å™ªå£°è¢«æœ‰æ•ˆæŠ‘åˆ¶ã€‚</p>
<h2 data-id="heading-4"><strong>æ€»ç»“ä¸å±•æœ›</strong></h2>
<p>DQAlignerçš„æˆåŠŸç»™æˆ‘ä»¬å¸¦æ¥äº†ä¸€ä¸ªé‡è¦å¯å‘ï¼šåœ¨å¤„ç†åŠ¨æ€è§†è§‰ä»»åŠ¡æ—¶ï¼Œä¸ä¸€å®šéè¦è¿½æ±‚åƒç´ çº§çš„å®Œç¾å¯¹é½ã€‚ç»™æ¨¡å‹ä¸€ä¸ªâ€œå…¨å±€è§†é‡â€ï¼Œè®©å®ƒå­¦ä¼šåˆ©ç”¨è¯­ä¹‰ä¸€è‡´æ€§å»å¼¥è¡¥å‡ ä½•å¯¹é½çš„ä¸è¶³ï¼Œåè€Œèƒ½æ”¶åˆ°å¥‡æ•ˆã€‚</p>
<p>è¿™ç§ä»â€œç¡¬å¯¹é½â€å‘â€œæŸ”æ€§åŒ¹é…â€çš„è½¬å˜ï¼Œä¸ä»…æå‡äº†æ¨¡å‹å¯¹å¤§ä½ç§»è¿åŠ¨çš„é²æ£’æ€§ï¼Œä¹Ÿä¸ºä½ä¿¡å™ªæ¯”ä¸‹çš„å¼±å°ç›®æ ‡æ£€æµ‹æä¾›äº†ä¸€æ¡æ–°è·¯å¾„ã€‚</p>
<p>ç›®å‰ï¼Œè¯¥é¡¹ç›®å·²åœ¨GitHubä¸Šå®Œæ•´å¼€æºï¼Œä¸ºçº¢å¤–åœºæ™¯ä¸‹çš„ç›®æ ‡æ£€æµ‹ç ”ç©¶æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„æ–°åŸºå‡†ã€‚å¯¹äºæ­£åœ¨è¢«â€œè·Ÿä¸¢â€æˆ–â€œè™šè­¦â€é—®é¢˜å›°æ‰°çš„ç ”ç©¶è€…å’Œå·¥ç¨‹å¸ˆæ¥è¯´ï¼ŒDQAligneræ— ç–‘æ˜¯ä¸€ä¸ªå€¼å¾—å°è¯•çš„åˆ›æ–°æ–¹æ¡ˆã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[NotebookLM æŠŠæ–‡ç« åšæˆ Podcastï¼šæˆ‘çš„å®é™…ä½¿ç”¨è®°å½•]]></title>    <link>https://juejin.cn/post/7602940720690921518</link>    <guid>https://juejin.cn/post/7602940720690921518</guid>    <pubDate>2026-02-05T05:31:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602940720690921518" data-draft-id="7602935146706255918" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="NotebookLM æŠŠæ–‡ç« åšæˆ Podcastï¼šæˆ‘çš„å®é™…ä½¿ç”¨è®°å½•"/> <meta itemprop="keywords" content="AIç¼–ç¨‹,OpenAI"/> <meta itemprop="datePublished" content="2026-02-05T05:31:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="HBLOG"/> <meta itemprop="url" content="https://juejin.cn/user/131597124767479"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            NotebookLM æŠŠæ–‡ç« åšæˆ Podcastï¼šæˆ‘çš„å®é™…ä½¿ç”¨è®°å½•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/131597124767479/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    HBLOG
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T05:31:57.000Z" title="Thu Feb 05 2026 05:31:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘åœ¨æ•´ç†åšå®¢å†…å®¹çš„æ—¶å€™ï¼Œæˆ‘ä¸€ç›´åœ¨æƒ³ä¸€ä»¶äº‹ï¼š<br/>
<strong>å·²ç»å†™å¥½çš„æ–‡ç« ï¼Œèƒ½ä¸èƒ½é¡ºæ‰‹å˜æˆæ’­å®¢ï¼Ÿ</strong></p>
<p>ä¸æ˜¯é‚£ç§è¦å½•éŸ³ã€å‰ªè¾‘ã€é…èƒŒæ™¯éŸ³ä¹çš„ä¼ ç»Ÿæ’­å®¢ï¼Œè€Œæ˜¯æ›´è½»é‡çš„â€”â€”<br/>
å†™å®Œå†…å®¹ï¼Œå°±èƒ½ç”Ÿæˆä¸€æ®µèƒ½å¬çš„éŸ³é¢‘ã€‚</p>
<p>åæ¥è¯•äº† Google çš„ <strong>NotebookLM</strong>ï¼Œå‘ç°å®ƒçš„ Podcast åŠŸèƒ½æ¯”æˆ‘æƒ³è±¡ä¸­å®ç”¨å¾ˆå¤šï¼Œäºæ˜¯å°±è®°å½•ä¸€ä¸‹æ•´ä¸ªè¿‡ç¨‹ï¼Œç»™åŒæ ·æƒ³åšå†…å®¹å¤ç”¨çš„äººä¸€ä¸ªå‚è€ƒã€‚</p>
<h2 data-id="heading-0">NotebookLM æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fadmin.liuhaihua.cn%2Fwp-content%2Fuploads%2F2026%2F01%2Fimage-7.png" target="_blank" title="https://admin.liuhaihua.cn/wp-content/uploads/2026/01/image-7.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c0231d8c4ba41ada2683733417406bf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSEJMT0c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770874323&amp;x-signature=lwDddig7IwtiMdVas7uPp5ANUfU%3D" alt="" loading="lazy"/></a></p>
<p>NotebookLM å¯ä»¥ç®€å•ç†è§£ä¸ºä¸€ä¸ªâ€œåŸºäºèµ„æ–™å·¥ä½œçš„ AI ç¬”è®°æœ¬â€ã€‚</p>
<p>ä½ æŠŠæ–‡æ¡£ä¸¢ç»™å®ƒï¼Œå®ƒä¸ä¼šè‡ªå·±çå‘æŒ¥ï¼Œè€Œæ˜¯<strong>åªå›´ç»•ä½ æä¾›çš„å†…å®¹æ¥ç†è§£å’Œæ•´ç†</strong>ã€‚è¿™ä¸€ç‚¹å’Œæ™®é€šèŠå¤©å¼ AI å¾ˆä¸ä¸€æ ·ã€‚</p>
<p>æˆ‘ä¸€èˆ¬æ‹¿å®ƒæ¥åšå‡ ä»¶äº‹ï¼š</p>
<ul>
<li>çœ‹é•¿æ–‡æ¡£çš„é‡ç‚¹</li>
<li>æ•´ç†æ–‡ç« ç»“æ„</li>
<li>æŠŠå·²æœ‰å†…å®¹æ¢ä¸€ç§å½¢å¼è¾“å‡º</li>
</ul>
<p>è€Œ Podcast åŠŸèƒ½ï¼Œæ­£å¥½å±äºæœ€åè¿™ä¸€ç±»ã€‚</p>
<h2 data-id="heading-1">NotebookLM çš„ Podcast æ˜¯æ€ä¹ˆä¸€å›äº‹ï¼Ÿ</h2>
<p>NotebookLM é‡Œæœ‰ä¸€ä¸ªå« <strong>Audio Overview</strong> çš„åŠŸèƒ½ã€‚</p>
<p>å®ƒåšçš„äº‹æƒ…å…¶å®å¾ˆç®€å•ï¼š</p>
<blockquote>
<p>æŠŠä½ ä¸Šä¼ çš„èµ„æ–™ï¼Œæ•´ç†æˆä¸€æ®µå¯ä»¥â€œå¬â€çš„å†…å®¹ã€‚</p>
</blockquote>
<p>ç”Ÿæˆçš„éŸ³é¢‘é€šå¸¸æ˜¯ä¸¤ä¸ªäººå¯¹è¯çš„å½¢å¼ï¼Œæœ‰ç‚¹åƒæ’­å®¢é‡Œä¸»æŒäººå’Œå˜‰å®¾åœ¨èŠå¤©é‚£ç§æ„Ÿè§‰ï¼Œä½†å†…å®¹å…¨éƒ¨æ¥è‡ªä½ è‡ªå·±çš„æ–‡æ¡£ã€‚</p>
<p>ä¸æ˜¯å¿µæ–‡ç« ï¼Œä¹Ÿä¸æ˜¯é€å­—æœ—è¯»ï¼Œè€Œæ˜¯<strong>é‡æ–°ç»„ç»‡ä¹‹åè®²ç»™ä½ å¬</strong>ã€‚</p>
<p>ç¬¬ä¸€æ¬¡ç‚¹ç”Ÿæˆçš„æ—¶å€™ï¼Œæˆ‘å…¶å®æ²¡æŠ±å¤ªå¤§æœŸæœ›ï¼Œä½†å‡ºæ¥çš„æ•ˆæœæ„å¤–åœ°è¿˜å¯ä»¥ã€‚</p>
<h2 data-id="heading-2">æˆ‘æ˜¯æ€ä¹ˆç”¨å®ƒåš Podcast çš„ï¼Ÿ</h2>
<p>æ•´ä¸ªæµç¨‹éå¸¸ç®€å•ã€‚</p>
<h3 data-id="heading-3">1. å…ˆå‡†å¤‡ä¸€ç¯‡å®Œæ•´æ–‡ç« </h3>
<p>æˆ‘ä¸€èˆ¬ç”¨ï¼š</p>
<ul>
<li>åšå®¢æ­£æ–‡</li>
<li>æ•™ç¨‹æ–‡æ¡£</li>
<li>å­¦ä¹ ç¬”è®°</li>
</ul>
<p>å­—æ•°å¤§æ¦‚åœ¨ 2000â€“4000 å­—å·¦å³æ¯”è¾ƒåˆé€‚ã€‚</p>
<p>å†…å®¹ç»“æ„è¶Šæ¸…æ™°ï¼Œåé¢ç”Ÿæˆçš„éŸ³é¢‘å°±è¶Šè‡ªç„¶ã€‚</p>
<p>æˆ‘è¿™é‡Œé€‰æ‹©ä¹‹å‰å†™çš„ä¸€ç¯‡æ–‡ç« å¦‚ä¸‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.liuhaihua.cn%2Farchives%2F719898.html" target="_blank" title="https://www.liuhaihua.cn/archives/719898.html" ref="nofollow noopener noreferrer">www.liuhaihua.cn/archives/71â€¦</a></p>
<h3 data-id="heading-4">2. æ–°å»ºä¸€ä¸ª Notebook</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fadmin.liuhaihua.cn%2Fwp-content%2Fuploads%2F2026%2F01%2Fimage-8.png" target="_blank" title="https://admin.liuhaihua.cn/wp-content/uploads/2026/01/image-8.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d29f2d7619c4484292f40488471515c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSEJMT0c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770874323&amp;x-signature=1ZuYL%2FANX5f7zboo2w4sFN7Tuao%3D" alt="" loading="lazy"/></a></p>
<p>æ‰“å¼€ NotebookLMï¼Œæ–°å»º notebookï¼Œç„¶åæŠŠæ–‡ç« ä¸¢è¿›å»ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fadmin.liuhaihua.cn%2Fwp-content%2Fuploads%2F2026%2F01%2Fimage-9.png" target="_blank" title="https://admin.liuhaihua.cn/wp-content/uploads/2026/01/image-9.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ca22eb1273d4905b81646a26743efde~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSEJMT0c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770874323&amp;x-signature=Li8y9KTTZKqixO31crcBNuUjrOU%3D" alt="" loading="lazy"/></a></p>
<p>ä¸éœ€è¦é¢å¤–æç¤ºè¯ï¼Œä¹Ÿä¸ç”¨å†™è„šæœ¬ã€‚</p>
<p>å®ƒä¼šå…ˆâ€œè¯»â€ä½ çš„å†…å®¹ã€‚</p>
<h3 data-id="heading-5">3. ç”Ÿæˆ Audio Overview</h3>
<p>ç‚¹å‡» Audio Overviewï¼Œç­‰ä¸€ä¼šå„¿ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fadmin.liuhaihua.cn%2Fwp-content%2Fuploads%2F2026%2F01%2Fimage-10.png" target="_blank" title="https://admin.liuhaihua.cn/wp-content/uploads/2026/01/image-10.png" ref="nofollow noopener noreferrer"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b17de08f1a04189bdd8f24f0961b116~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSEJMT0c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770874323&amp;x-signature=QccoJj515%2F4ci5H1a%2BGlwf6P6zw%3D" alt="" loading="lazy"/></a></p>
<p>é€šå¸¸ä¸€ä¸¤åˆ†é’Ÿï¼Œå°±èƒ½ç”Ÿæˆä¸€æ®µå®Œæ•´éŸ³é¢‘ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>ç®€å•å¼€åœº</li>
<li>ä¸»é¢˜è§£é‡Š</li>
<li>é‡ç‚¹æ‹†è§£</li>
<li>æœ€åçš„æ€»ç»“</li>
</ul>
<p>æ•´ä½“å¬ä¸‹æ¥ï¼Œå¾ˆåƒä¸€æœŸ 5â€“10 åˆ†é’Ÿçš„çŸ¥è¯†æ’­å®¢ã€‚</p>
<h3 data-id="heading-6">4. ä¸‹è½½éŸ³é¢‘</h3>
<p>ç”Ÿæˆåå¯ä»¥ç›´æ¥ä¸‹è½½éŸ³é¢‘æ–‡ä»¶ï¼Œç”¨æ¥ï¼š</p>
<ul>
<li>åµŒå…¥åšå®¢é¡µé¢</li>
<li>ä¸Šä¼ æ’­å®¢å¹³å°</li>
<li>å½“ä½œå­¦ä¹ éŸ³é¢‘</li>
</ul>
<p>æˆ‘ä¸Šä¼ å–œé©¬æ‹‰é›…äº†ï¼Œå¤§å®¶å¯ä»¥å»å¬ä¸€ä¸‹æ•ˆæœ</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fm.ximalaya.com%2Fsound%2F953017573%3Ffrom%3Dpc" target="_blank" title="https://m.ximalaya.com/sound/953017573?from=pc" ref="nofollow noopener noreferrer">m.ximalaya.com/sound/95301â€¦</a></p>
<h2 data-id="heading-7">å®é™…ç”¨ä¸‹æ¥ï¼Œæœ‰å“ªäº›ä¼˜ç‚¹ï¼Ÿ</h2>
<h3 data-id="heading-8">1. ä¸ç”¨å½•éŸ³ï¼ŒçœŸçš„çœäº‹</h3>
<p>ä»¥å‰æƒ³åšæ’­å®¢ï¼Œæœ€å¤§çš„é—®é¢˜ä¸æ˜¯ä¸ä¼šè¯´ï¼Œè€Œæ˜¯å¤ªéº»çƒ¦ï¼š</p>
<ul>
<li>æ‰¾æ—¶é—´</li>
<li>è°ƒç¯å¢ƒ</li>
<li>å‰ªæ‚éŸ³</li>
</ul>
<p>NotebookLM è¿™ä¸€å¥—ï¼ŒåŸºæœ¬æ˜¯<strong>ç‚¹ä¸€ä¸‹å°±å¥½</strong>ã€‚</p>
<p>å¯¹ä¸ªäººç«™é•¿æ¥è¯´å¾ˆå‹å¥½ã€‚</p>
<h3 data-id="heading-9">2. å†…å®¹ä¸ä¼šè·‘å</h3>
<p>å®ƒä¸ä¼šå‡­ç©ºåŠ è§‚ç‚¹ï¼Œä¹Ÿä¸ä¼šä¹±å‘æŒ¥ã€‚</p>
<p>æ’­å®¢é‡Œçš„å†…å®¹åŸºæœ¬éƒ½èƒ½åœ¨åŸæ–‡é‡Œæ‰¾åˆ°å¯¹åº”ä½ç½®ï¼Œè¿™ç‚¹æˆ‘ä¸ªäººå¾ˆçœ‹é‡ã€‚</p>
<p>å°¤å…¶æ˜¯æŠ€æœ¯ç±»ã€æ•™ç¨‹ç±»å†…å®¹ï¼Œå‡†ç¡®æ€§æ¯”â€œå¬èµ·æ¥åƒäººâ€æ›´é‡è¦ã€‚</p>
<h3 data-id="heading-10">3. ç‰¹åˆ«é€‚åˆå†…å®¹å¤ç”¨</h3>
<p>å¦‚æœä½ æœ¬æ¥å°±æœ‰ï¼š</p>
<ul>
<li>åšå®¢</li>
<li>æ•™ç¨‹</li>
<li>æ–‡æ¡£</li>
<li>ç¬”è®°</li>
</ul>
<p>é‚£å‡ ä¹æ˜¯â€œç™½é€â€çš„ä¸€ä¸ªå†…å®¹å½¢æ€ã€‚</p>
<p>å†™ä¸€æ¬¡ï¼Œå¤šç”¨ä¸€æ¬¡ã€‚</p>
<h2 data-id="heading-11">å“ªäº›äººæ¯”è¾ƒé€‚åˆç”¨ï¼Ÿ</h2>
<p>æˆ‘è§‰å¾—æœ€é€‚åˆçš„å‡ ç±»äººæ˜¯ï¼š</p>
<ul>
<li>å†™æŠ€æœ¯åšå®¢çš„</li>
<li>åšçŸ¥è¯†ç±»å†…å®¹çš„</li>
<li>ç‹¬ç«‹ç«™ç«™é•¿</li>
<li>ä¸æƒ³éœ²è„¸ã€ä¸æƒ³å½•éŸ³çš„äºº</li>
</ul>
<p>å¦‚æœä½ å·²ç»åœ¨å†™ä¸œè¥¿ï¼Œé‚£ç”¨ NotebookLM åš Podcast å‡ ä¹æ²¡æœ‰é¢å¤–æˆæœ¬ã€‚</p>
<h2 data-id="heading-12">ä¸€ç‚¹ä¸ªäººä½¿ç”¨å»ºè®®</h2>
<p>ç”¨äº†ä¸€æ®µæ—¶é—´åï¼Œæˆ‘è‡ªå·±æ€»ç»“äº†å‡ ç‚¹ï¼š</p>
<ul>
<li><strong>æ–‡ç« ç»“æ„æ¯”æ–‡é‡‡æ›´é‡è¦</strong></li>
<li>å°æ ‡é¢˜æ¸…æ™°ï¼Œç”Ÿæˆæ•ˆæœä¼šå¥½å¾ˆå¤š</li>
<li>å•ç¯‡æ§åˆ¶åœ¨ 10 åˆ†é’Ÿä»¥å†…ä½“éªŒæœ€å¥½</li>
</ul>
<p>å®ƒæ›´é€‚åˆâ€œè®²æ¸…æ¥šä¸€ä»¶äº‹â€ï¼Œè€Œä¸æ˜¯æƒ…ç»ªè¡¨è¾¾å‹æ’­å®¢ã€‚</p>
<h2 data-id="heading-13">å†™åœ¨æœ€å</h2>
<p>NotebookLM å¹¶ä¸æ˜¯è¦æ›¿ä»£çœŸäººæ’­å®¢ã€‚</p>
<p>ä½†å¯¹äºå·²ç»åœ¨æŒç»­è¾“å‡ºæ–‡å­—å†…å®¹çš„äººæ¥è¯´ï¼Œå®ƒç¡®å®æä¾›äº†ä¸€æ¡å¾ˆçœåŠ›çš„è·¯ï¼š</p>
<blockquote>
<p>æ–‡ç« å†™å®Œï¼Œä¸åªæ˜¯ç»™äººçœ‹ï¼Œä¹Ÿå¯ä»¥ç»™äººå¬ã€‚</p>
</blockquote>
<p>å¦‚æœä½ æœ¬æ¥å°±æœ‰å†…å®¹ï¼Œé‚£è¿™ä¸ªåŠŸèƒ½å€¼å¾—ä¸€è¯•ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring Bootæµ‹è¯•å¯åŠ¨å¤±è´¥ï¼šSLF4Jæ—¥å¿—å¤šå®ç°å†²çªè§£å†³æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7602928783596421126</link>    <guid>https://juejin.cn/post/7602928783596421126</guid>    <pubDate>2026-02-05T04:22:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602928783596421126" data-draft-id="7603004323871244331" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring Bootæµ‹è¯•å¯åŠ¨å¤±è´¥ï¼šSLF4Jæ—¥å¿—å¤šå®ç°å†²çªè§£å†³æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-05T04:22:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="XuCoder"/> <meta itemprop="url" content="https://juejin.cn/user/948203954903908"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring Bootæµ‹è¯•å¯åŠ¨å¤±è´¥ï¼šSLF4Jæ—¥å¿—å¤šå®ç°å†²çªè§£å†³æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/948203954903908/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    XuCoder
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T04:22:41.000Z" title="Thu Feb 05 2026 04:22:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å¼€å‘ Spring Boot +LangGraph4Jé¡¹ç›®æ—¶ï¼Œæ‰“ç®—åˆ©ç”¨é˜¿é‡Œäº‘ç™¾ç‚¼çš„æ–‡ç”Ÿå›¾æ¨¡å‹ç”ŸæˆLogoå›¾ç‰‡ï¼Œåœ¨å¼•å…¥äº†é˜¿é‡Œäº‘ç™¾ç‚¼ SDKï¼ˆdashscope-sdk-javaï¼‰åï¼Œæ‰§è¡Œå•å…ƒæµ‹è¯•ï¼ˆLogoGeneratorToolTestï¼‰æ—¶ï¼Œé¡¹ç›®ç›´æ¥å¯åŠ¨å¤±è´¥ï¼Œæ§åˆ¶å°æ‰“å°å¤§é‡æŠ¥é”™æ—¥å¿—:</p>
<pre><code class="hljs language-bash" lang="bash">SLF4J(W): Class path contains multiple SLF4J providers.
SLF4J(W): Found provider [org.slf4j.simple.SimpleServiceProvider@206a70ef]
SLF4J(W): Found provider [ch.qos.logback.classic.spi.LogbackServiceProvider@292b08d6]
...
Caused by: java.lang.IllegalStateException: LoggerFactory is not a Logback LoggerContext but Logback is on the classpath. Either remove Logback or the competing implementation (class org.slf4j.simple.SimpleLoggerFactory loaded from .../slf4j-simple-2.0.17.jar)
</code></pre>
<h3 data-id="heading-0">åŸå› åˆ†æ</h3>
<p>SLF4Jï¼ˆSimple Logging Facade for Javaï¼‰æ˜¯æ—¥å¿—é—¨é¢æ¥å£ï¼Œæœ¬èº«ä¸å®ç°æ—¥å¿—æ‰“å°åŠŸèƒ½ï¼Œéœ€è¦ç»‘å®šä¸€ä¸ªå…·ä½“çš„æ—¥å¿—å®ç°ç»„ä»¶ï¼ˆå¦‚Logbackã€Log4jã€SLF4J-Simpleç­‰ï¼‰ã€‚</p>
<p>å…¶ä¸­ï¼ŒLogbackæ˜¯ç”±spring-boot-starter-loggingè‡ªåŠ¨å¼•å…¥ï¼ŒSpring Bootå®˜æ–¹æ¨èçš„æ—¥å¿—ç»„ä»¶ï¼Œæ”¯æŒæ—¥å¿—é…ç½®ã€æ–‡ä»¶æ»šåŠ¨ã€å¼‚æ­¥æ‰“å°ç­‰ä¼ä¸šçº§ç‰¹æ€§ã€‚</p>
<p>è€ŒSLF4J-Simpleæ˜¯ç”±é˜¿é‡Œé€šä¹‰SDKï¼ˆdashscope-sdk-javaï¼‰ä¾èµ–ä¼ é€’å¼•å…¥ï¼Œæ˜¯ä¸€ä¸ªè½»é‡ä½†åŠŸèƒ½ç®€å•çš„æ—¥å¿—å®ç°ã€‚</p>
<p>ç”±äºåœ¨è¿™ä¸ªé¡¹ç›®ç±»è·¯å¾„ä¸‹åŒæ—¶å­˜åœ¨ä¸¤ä¸ªSLF4Jçš„å®ç°ç»„ä»¶ï¼Œè¿åäº†â€œä¸€ä¸ªæ—¥å¿—é—¨é¢+ä¸€ä¸ªå®ç°â€çš„è§„èŒƒï¼Œå¯¼è‡´Springå®¹å™¨å¯åŠ¨æ—¶æ— æ³•ç¡®å®šä½¿ç”¨å“ªä¸ªæ—¥å¿—å·¥å‚ï¼Œæœ€ç»ˆåŠ è½½åº”ç”¨ä¸Šä¸‹æ–‡å¤±è´¥ã€‚</p>
<h3 data-id="heading-1">è§£å†³æ–¹æ¡ˆ</h3>
<p>ä¿ç•™Logbackï¼Œæ’é™¤å†²çªçš„SLF4J-Simpleä¾èµ–ï¼Œä¿®æ”¹pom.xmlï¼Œæ’é™¤å†²çªä¾èµ–ï¼Œé€šè¿‡æ ‡ç­¾æ’é™¤å…¶ä¸­çš„slf4j-simpleä¾èµ–ï¼Œå…·ä½“é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">&lt;!-- é˜¿é‡Œé€šä¹‰SDKä¾èµ– --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
    &lt;artifactId&gt;dashscope-sdk-java&lt;/artifactId&gt;
    &lt;version&gt;2.21.1&lt;/version&gt;
    &lt;!-- æ’é™¤å†²çªçš„slf4j-simpleä¾èµ– --&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
            &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
</code></pre>
<p>æ¥ä¸‹æ¥ï¼Œæ‰“å¼€Mavené¢æ¿â¡ï¸ å³é”®é¡¹ç›®â¡ï¸é€‰æ‹©â€œReload Projectâ€ï¼Œç­‰å¾…ä¾èµ–åˆ·æ–°å®Œæˆï¼Œé‡æ–°è¿è¡Œä¹‹å‰å¤±è´¥çš„å•å…ƒæµ‹è¯•ï¼Œæ—¥å¿—å†²çªé—®é¢˜è§£å†³ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æè‡´æ€§èƒ½ï¼šä¸º OpenClaw é‡èº«æ‰“é€ â€œæ»¡è¡€ç‰ˆâ€ Python 3.12 ç¼–è¯‘æŒ‡å—]]></title>    <link>https://juejin.cn/post/7602929352716369920</link>    <guid>https://juejin.cn/post/7602929352716369920</guid>    <pubDate>2026-02-05T04:57:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602929352716369920" data-draft-id="7602825342229397538" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æè‡´æ€§èƒ½ï¼šä¸º OpenClaw é‡èº«æ‰“é€ â€œæ»¡è¡€ç‰ˆâ€ Python 3.12 ç¼–è¯‘æŒ‡å—"/> <meta itemprop="keywords" content="æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-02-05T04:57:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="HarmonSir"/> <meta itemprop="url" content="https://juejin.cn/user/4355613340469737"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æè‡´æ€§èƒ½ï¼šä¸º OpenClaw é‡èº«æ‰“é€ â€œæ»¡è¡€ç‰ˆâ€ Python 3.12 ç¼–è¯‘æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4355613340469737/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    HarmonSir
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T04:57:23.000Z" title="Thu Feb 05 2026 04:57:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨ Proxmox VE (PVE) ç¯å¢ƒä¸‹ï¼ŒLXC å®¹å™¨æ˜¯éƒ¨ç½²é«˜æ€§èƒ½æœåŠ¡çš„ç†æƒ³é€‰æ‹©ã€‚è¿‘æœŸåœ¨é…ç½® <strong>OpenClaw</strong> ç¯å¢ƒæ—¶ï¼Œæˆ‘å‘ç°å®˜æ–¹é¢„è£…æˆ–å¸¸è§„å®‰è£…çš„ Python å¾€å¾€åœ¨æ€§èƒ½ä¸Šæœ‰æ‰€ä¿ç•™ï¼Œç”šè‡³ç¼ºå¤±å…³é”®çš„æ‰©å±•æ¨¡å—ã€‚ä¸ºäº†å®ç° OpenClaw çš„æè‡´å“åº”ï¼Œæˆ‘ä»¬éœ€è¦ä»æºç å¼€å§‹ï¼Œå‰”é™¤è‡ƒè‚¿çš„å·¥å…·åŒ…ï¼Œç²¾å‡†æ„å»ºä¸€ä¸ªä¸“å±äºå½“å‰ç¡¬ä»¶æ¶æ„çš„â€œæ»¡è¡€ç‰ˆâ€ Python 3.12ã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€ æ¸…ç†ä¸ç²¾å‡†å®šä½ï¼šæ‹’ç»â€œå…¨å®¶æ¡¶â€</h2>
<p>è®¸å¤šæ•™ç¨‹ä¼šæ¨èå®‰è£… <code>build-essential</code>ï¼Œä½†è¿™åŒ…å«äº†å¾ˆå¤šæˆ‘ä»¬ä¸éœ€è¦çš„å†—ä½™å·¥å…·ã€‚ä½œä¸ºè¿½æ±‚ç²¾å‡†çš„å¼€å‘è€…ï¼Œæˆ‘ä»¬åº”ç›´æ¥ç„å‡†æ ¸å¿ƒã€‚</p>
<h3 data-id="heading-2">1. å½»åº•æ¸…ç†æ—§ç‰ˆæœ¬</h3>
<p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œç¡®ä¿æ²¡æœ‰ä»»ä½•â€œåŠæˆå“â€å¹²æ‰°ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">pyenv uninstall -f 3.12.12
</code></pre>
<h3 data-id="heading-3">2. ç²¾å‡†å®‰è£…æ ¸å¿ƒç»„ä»¶</h3>
<p>é™¤äº†ç¼–è¯‘å™¨ <code>gcc</code> å’Œæ„å»ºå·¥å…· <code>make</code>ï¼ŒPython çš„æ ¸å¿ƒåŠŸèƒ½ï¼ˆå¦‚ SSL è”ç½‘ã€LZMA å‹ç¼©ã€FFI è°ƒç”¨ï¼‰éœ€è¦ç‰¹å®šçš„å¼€å‘åº“æ”¯æŒã€‚</p>
<pre><code class="hljs language-bash" lang="bash">sudo apt update
sudo apt install -y --no-install-recommends \
    gcc make pkg-config \
    libssl-dev \
    libffi-dev \
    zlib1g-dev \
    liblzma-dev \
    libsqlite3-dev
</code></pre>
<ul>
<li><strong>å…³é”®ç‚¹</strong>ï¼š<code>libssl-dev</code> æ˜¯ OpenClaw è”ç½‘åŠ <code>pip</code> å®‰è£…åŒ…çš„åŸºç¡€ï¼›<code>liblzma-dev</code> è§£å†³äº†å¸¸è§çš„ <code>_lzma</code> æ¨¡å—ç¼ºå¤±æŠ¥é”™ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-4">äºŒã€ æ€§èƒ½å‹æ¦¨ï¼šPGO + LTO + Native ä¸‰ç®­é½å‘</h2>
<p>ä¸ºäº†è®© Python è¿è¡Œæ•ˆç‡æœ€å¤§åŒ–ï¼Œæˆ‘ä»¬å°†å¼€å¯ç¼–è¯‘å™¨æœ€é¡¶çº§çš„ä¸‰ä¸ªå¼€å…³ï¼š</p>
<ol>
<li><strong>PGO (Profile Guided Optimization)</strong>ï¼šé€šè¿‡çœŸå®çš„è‡ªåŠ¨åŒ–æµ‹è¯•â€œè®­ç»ƒâ€ç¼–è¯‘å™¨ï¼Œè®©å®ƒçŸ¥é“å“ªäº›ä»£ç è·¯å¾„æœ€å¸¸ç”¨ï¼Œä»è€Œè¿›è¡Œé‡ç‚¹ä¼˜åŒ–ã€‚</li>
<li><strong>LTO (Link Time Optimization)</strong>ï¼šåœ¨é“¾æ¥é˜¶æ®µè¿›è¡Œå…¨å±€ä¼˜åŒ–ï¼ŒæŠ¹å¹³å‡½æ•°è·¨æ¨¡å—è°ƒç”¨çš„å¼€é”€ã€‚</li>
<li><strong>-march=native</strong>ï¼šæ”¾å¼ƒé€šç”¨æ€§ï¼Œç›´æ¥é’ˆå¯¹ä½ å½“å‰çš„ç‰©ç† CPU æŒ‡ä»¤é›†ï¼ˆå¦‚ AVX2ã€AVX-512ï¼‰ç”Ÿæˆæœºå™¨ç ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€ å®æˆ˜æŒ‡ä»¤ï¼šæè‡´æ€§èƒ½çš„è”åˆç¼–è¯‘</h2>
<p>åœ¨ <code>pyenv</code> ç¯å¢ƒä¸‹ï¼Œé€šè¿‡ç¯å¢ƒå˜é‡æ³¨å…¥ï¼Œç¡®ä¿æ¯ä¸€ä¸ªä¼˜åŒ–å‚æ•°éƒ½ç‰©ç†å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å¼ºåˆ¶æŒ‡å®šæ”¯æŒ LTO çš„äºŒè¿›åˆ¶å·¥å…·é“¾</span>
<span class="hljs-built_in">export</span> AR=<span class="hljs-string">"gcc-ar"</span>
<span class="hljs-built_in">export</span> NM=<span class="hljs-string">"gcc-nm"</span>
<span class="hljs-built_in">export</span> RANLIB=<span class="hljs-string">"gcc-ranlib"</span>

<span class="hljs-comment"># 2. æ³¨å…¥ç¡¬ä»¶åŸç”Ÿä¼˜åŒ–ä¸å…¨é‡ä¼˜åŒ–æ ‡å¿—</span>
<span class="hljs-built_in">export</span> CFLAGS=<span class="hljs-string">"-march=native -O3 -flto=auto"</span>
<span class="hljs-built_in">export</span> LDFLAGS=<span class="hljs-string">"-flto=auto -fuse-linker-plugin"</span>

<span class="hljs-comment"># 3. å¯åŠ¨â€œç‚¼ä¸¹â€ï¼šå…¨é‡ä¼˜åŒ–å¹¶å¼€å¯å…±äº«åº“æ”¯æŒ</span>
PYTHON_CONFIGURE_OPTS=<span class="hljs-string">"--enable-optimizations --with-lto --enable-shared"</span> \
pyenv install 3.12.12
</code></pre>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šç”±äºå¼€å¯äº† <code>--enable-optimizations</code>ï¼Œç³»ç»Ÿä¼šè¿è¡Œæ•°ç™¾ä¸ªæµ‹è¯•ç”¨ä¾‹ã€‚è¿™ä¼šå¯¼è‡´ç¼–è¯‘æ—¶é—´å»¶é•¿ 3-5 å€ï¼Œä¸” CPU ä¼šæ»¡è½½ï¼Œè¿™æ˜¯æ­£å¸¸ç°è±¡ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-6">å››ã€ æ·±åº¦éªŒè¯ï¼šç¡®ä¿â€œä¼˜åŒ–â€å¹¶éè™šæœ‰å…¶è¡¨</h2>
<p>ç¼–è¯‘å®Œæˆåï¼Œæˆ‘ä»¬å¿…é¡»éªŒè¯è¿™äº›æè‡´å‚æ•°æ˜¯å¦çœŸçš„ç”Ÿæ•ˆäº†ï¼Œè€Œä¸æ˜¯è¢«ç¼–è¯‘å™¨æ‚„æ‚„ä¸¢å¼ƒã€‚</p>
<h3 data-id="heading-7">1. æ£€æŸ¥ç¼–è¯‘é…ç½®è®°å½•</h3>
<p>è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹ Python è®°å½•çš„é…ç½®å‚æ•°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python3.12 -c <span class="hljs-string">"import sysconfig; print(sysconfig.get_config_var('CONFIG_ARGS'))"</span>
</code></pre>
<ul>
<li><strong>è¦ç‚¹</strong>ï¼šè¾“å‡ºç»“æœä¸­å¿…é¡»åŒ…å« <code>--with-lto</code> å’Œ <code>-march=native</code>ã€‚åªè¦è¿™äº›å­—ç¬¦ä¸²å­˜åœ¨ï¼Œè¯´æ˜äºŒè¿›åˆ¶æ–‡ä»¶å·²ç»â€œå…¥å‘³â€äº†ã€‚</li>
</ul>
<h3 data-id="heading-8">2. åŠŸèƒ½æ¨¡å—è‡ªæ£€</h3>
<p>ç¡®ä¿ OpenClaw ä¾èµ–çš„åº•å±‚æ‰©å±•ç¼–è¯‘æˆåŠŸï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python3.12 -c <span class="hljs-string">"import _ssl, _lzma, _sqlite3; print('æ»¡è¡€çŠ¶æ€æ£€æµ‹ï¼šæ¨¡å—å®Œæ•´ï¼Œæ€§èƒ½å…¨å¼€ï¼')"</span>
</code></pre>
<hr/>
<h2 data-id="heading-9">äº”ã€ éƒ¨ç½²è¦ç‚¹ï¼šæ€§èƒ½ä¸å…¼å®¹æ€§çš„åšå¼ˆ</h2>
<p>è™½ç„¶ <code>-march=native</code> å¸¦æ¥äº†æé«˜çš„è¿è¡Œæ•ˆç‡ï¼Œä½†ä½ ä¹Ÿéœ€è¦è®°ä½å®ƒçš„ä»£ä»·ï¼š</p>
<ul>
<li><strong>ç¡¬ä»¶ç»‘å®š</strong>ï¼šæ­¤ Python åªèƒ½åœ¨ç›¸åŒæˆ–æ›´é«˜æ¶æ„çš„ CPU ä¸Šè¿è¡Œã€‚å¦‚æœä½ å°†æ­¤ LXC å®¹å™¨è¿ç§»åˆ°ä¸€å°æŒ‡ä»¤é›†è¿‡æ—§çš„å®¿ä¸»æœºä¸Šï¼Œç¨‹åºä¼šæŠ¥ <code>Illegal instruction</code> å´©æºƒã€‚</li>
<li><strong>ç¯å¢ƒä¸€è‡´æ€§</strong>ï¼šç”±äºå¼€å¯äº† <code>--enable-shared</code>ï¼Œå¦‚æœéœ€è¦è¿ç§»ï¼Œå¿…é¡»ç¡®ä¿ç›®æ ‡ç³»ç»Ÿçš„ <code>glibc</code> ç‰ˆæœ¬ä¸ä½äºç¼–è¯‘ç¯å¢ƒã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-10">ç»“è¯­</h2>
<p>é€šè¿‡è¿™ç§å¾ªåºæ¸è¿›çš„ç²¾å‡†ç¼–è¯‘ç­–ç•¥ï¼Œæˆ‘ä»¬ä¸ä»…è§£å†³äº† <code>ModuleNotFoundError</code> ç­‰ç—›ç‚¹ï¼Œæ›´åœ¨ LXC å®¹å™¨å†…æ‰“é€ å‡ºäº†ä¸€ä¸ªæå…¶å¼ºæ‚çš„ Python ç¯å¢ƒã€‚å¯¹äº <strong>OpenClaw</strong> è¿™ç§å¯¹åº•å±‚å“åº”æœ‰è¦æ±‚çš„åº”ç”¨ï¼Œè¿™ç§æ·±åº¦çš„æ€§èƒ½å‹æ¦¨ç»å¯¹å€¼å¾—ä¸€è¯•ã€‚</p>
<hr/>
<p><strong>åšæ–‡å°è´´å£«</strong>ï¼š</p>
<ul>
<li><strong>é€‚ç”¨è¯»è€…</strong>ï¼šè¿½æ±‚æè‡´æ€§èƒ½çš„ PVE ç”¨æˆ·ã€OpenClaw å¼€å‘è€…ã€‚</li>
<li><strong>æ‰€éœ€è€—æ—¶</strong>ï¼šæ ¹æ® CPU æ€§èƒ½ï¼Œå¤§çº¦ 15-45 åˆ†é’Ÿã€‚</li>
</ul>
<h2 data-id="heading-11">é™„å½•ï¼šä¸€é”®â€œæ»¡è¡€ç‚¼ä¸¹â€è„šæœ¬</h2>
<p>å¦‚æœä½ ä¸æƒ³æ‰‹åŠ¨è¾“å…¥ä¸Šè¿°æŒ‡ä»¤ï¼Œå¯ä»¥å°†ä»¥ä¸‹ä»£ç ä¿å­˜ä¸º <code>build_python.sh</code> å¹¶è¿è¡Œã€‚å®ƒé›†æˆäº†ä¾èµ–æ£€æŸ¥ã€ç¯å¢ƒæ¸…ç†ä¸æè‡´æ€§èƒ½ç¼–è¯‘æµç¨‹ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment"># 1. ç²¾å‡†ä¾èµ–æ£€æŸ¥</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"æ­£åœ¨å®‰è£…æ ¸å¿ƒç¼–è¯‘ä¾èµ–..."</span>
sudo apt update &amp;&amp; sudo apt install -y --no-install-recommends \
    gcc make pkg-config libssl-dev libffi-dev zlib1g-dev \
    liblzma-dev libsqlite3-dev

<span class="hljs-comment"># 2. è®¾ç½®æè‡´æ€§èƒ½ç¯å¢ƒå˜é‡</span>
<span class="hljs-built_in">export</span> AR=<span class="hljs-string">"gcc-ar"</span>
<span class="hljs-built_in">export</span> NM=<span class="hljs-string">"gcc-nm"</span>
<span class="hljs-built_in">export</span> RANLIB=<span class="hljs-string">"gcc-ranlib"</span>
<span class="hljs-built_in">export</span> CFLAGS=<span class="hljs-string">"-march=native -O3 -flto=auto"</span>
<span class="hljs-built_in">export</span> LDFLAGS=<span class="hljs-string">"-flto=auto -fuse-linker-plugin"</span>

<span class="hljs-comment"># 3. æ‰§è¡Œå®‰è£… (ä»¥ 3.12.12 ä¸ºä¾‹)</span>
VERSION=<span class="hljs-string">"3.12.12"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"å¼€å§‹ç¼–è¯‘ Python <span class="hljs-variable">$VERSION</span>ï¼Œè¿™å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œè¯·ä¿æŒ CPU å‡‰çˆ½..."</span>

pyenv uninstall -f <span class="hljs-variable">$VERSION</span>
PYTHON_CONFIGURE_OPTS=<span class="hljs-string">"--enable-optimizations --with-lto --enable-shared"</span> \
pyenv install <span class="hljs-variable">$VERSION</span>

<span class="hljs-comment"># 4. æœ€ç»ˆéªŒè¯</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"æ­£åœ¨éªŒè¯ç¼–è¯‘æˆæœ..."</span>
~/.pyenv/versions/<span class="hljs-variable">$VERSION</span>/bin/python3 -c <span class="hljs-string">"import _ssl, _lzma; print('âœ… ç¼–è¯‘æˆåŠŸï¼šSSL/LZMA æ¨¡å—æ­£å¸¸')"</span>
~/.pyenv/versions/<span class="hljs-variable">$VERSION</span>/bin/python3 -c <span class="hljs-string">"import sysconfig; print('âœ… å‚æ•°ç¡®è®¤ï¼š', sysconfig.get_config_var('CONFIG_ARGS'))"</span>
</code></pre>
<p>è¡¥å……ï¼š</p>
<p>å¦‚ä½•é…ç½®å…¥ OpenClawã€‚ç¼–è¾‘<code>openclaw.json</code>ï¼ŒåŠ å…¥æ”¹å†™ç¯å¢ƒå˜é‡ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-attr">"env"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"PYENV_ROOT"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/root/.pyenv"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"PATH"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/root/.pyenv/shims:/root/.pyenv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"</span>
<span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
</code></pre>
<hr/>
<h3 data-id="heading-12">ğŸ’¡ æœ€åçš„åšä¸»å»ºè®®</h3>
<p>åœ¨æ‰§è¡Œè„šæœ¬å‰ï¼Œå»ºè®®é€šè¿‡ <code>htop</code> è§‚å¯Ÿä½ çš„ PVE å®¿ä¸»æœºçŠ¶æ€ã€‚å¼€å¯ PGO ä¼˜åŒ–åï¼ŒPython ç¼–è¯‘å™¨çš„å¹¶è¡Œæ•ˆç‡æé«˜ï¼Œå¦‚æœä½ åˆ†é…äº†å¤šä¸ª CPU æ ¸å¿ƒï¼Œå®ƒä»¬ä¼šå…¨éƒ¨è¿›å…¥æ»¡è½½çŠ¶æ€ã€‚è¿™æ­£æ˜¯ç¡¬ä»¶è¢«æ¨å‘æé™çš„è¯æ˜ã€‚</p>
<p>ç¥ä½ çš„ OpenClaw åœ¨è¿™ä¸ªæ»¡è¡€ç‰ˆ Python ç¯å¢ƒä¸‹è·‘å¾—æ¯”ä»¥å¾€ä»»ä½•æ—¶å€™éƒ½å¿«ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Reactå­¦ä¹ -Diff]]></title>    <link>https://juejin.cn/post/7602901195153915956</link>    <guid>https://juejin.cn/post/7602901195153915956</guid>    <pubDate>2026-02-05T04:03:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602901195153915956" data-draft-id="7602929352716255232" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Reactå­¦ä¹ -Diff"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-05T04:03:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="web_bee"/> <meta itemprop="url" content="https://juejin.cn/user/428665740231"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Reactå­¦ä¹ -Diff
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/428665740231/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    web_bee
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T04:03:51.000Z" title="Thu Feb 05 2026 04:03:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Diff ç®—æ³•</h2>
<p>å…ˆçœ‹ä¸€å¼ å›¾ï¼Œæè¿°äº†åœ¨state\props æ›´æ–°åï¼Œreactçš„å·¥ä½œæµç¨‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8c4baeefd3bd421dbb3fdd6cbb2d66b9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2ViX2JlZQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770869031&amp;x-signature=FeBE9YGWBqyFMcosibJLx367JQA%3D" alt="diff1.png" loading="lazy"/></p>
<p>React çš„ <strong>Diff ç®—æ³•</strong>ï¼ˆä¹Ÿç§°ä¸º <strong>Reconciliation ç®—æ³•</strong>ï¼‰æ˜¯ React ç”¨äºé«˜æ•ˆæ›´æ–° UI çš„æ ¸å¿ƒæœºåˆ¶ä¹‹ä¸€ã€‚å®ƒçš„ç›®æ ‡æ˜¯åœ¨ç»„ä»¶çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä»¥æœ€å°çš„ DOM æ“ä½œä»£ä»·å°†æ—§çš„è™šæ‹Ÿ DOMï¼ˆVirtual DOMï¼‰æ ‘æ›´æ–°ä¸ºæ–°çš„è™šæ‹Ÿ DOM æ ‘ã€‚</p>
<p>Diff ç®—æ³•çš„æ ¸å¿ƒå°±æ˜¯ - å¤ç”¨ï¼</p>
<h3 data-id="heading-1">1. Diff çš„ä¸‰å¤§æ ¸å¿ƒæ¯”è¾ƒåŸåˆ™</h3>
<ul>
<li><strong>åŒä¸€å±‚çº§çš„èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒï¼ˆTree Diff åªåœ¨åŒä¸€å±‚çº§è¿›è¡Œï¼‰</strong></li>
<li><strong>DOMå…ƒç´ \ç»„ä»¶ï¼Œé€šè¿‡ç±»å‹åˆ¤æ–­æ˜¯å¦å¤ç”¨</strong></li>
<li><strong>ä½¿ç”¨ key å±æ€§æ¥åˆ¤æ–­åˆ—è¡¨ä¸­å…ƒç´ æ˜¯å¦å¤ç”¨</strong></li>
</ul>
<h3 data-id="heading-2">2. æ¯”è¾ƒåŸåˆ™è¯¦è§£</h3>
<h4 data-id="heading-3"><strong>2.1 åŸºæœ¬å‰æï¼šDiff åªåœ¨åŒä¸€å±‚çº§è¿›è¡Œ</strong></h4>
<p>React çš„ Diff æ˜¯<strong>é€å±‚æ¯”è¾ƒ</strong>ï¼ˆlevel-by-levelï¼‰ï¼Œä¸ä¼šè·¨å±‚çº§ç§»åŠ¨èŠ‚ç‚¹ã€‚ ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// æ—§æ ‘</span>
&lt;<span class="hljs-selector-tag">div</span>&gt;
 Â &lt;<span class="hljs-selector-tag">span</span>&gt;<span class="hljs-selector-tag">A</span>&lt;/<span class="hljs-selector-tag">span</span>&gt;
 Â &lt;<span class="hljs-selector-tag">p</span>&gt;<span class="hljs-selector-tag">B</span>&lt;/<span class="hljs-selector-tag">p</span>&gt;
&lt;/<span class="hljs-selector-tag">div</span>&gt;
â€‹
<span class="hljs-comment">// æ–°æ ‘</span>
&lt;<span class="hljs-selector-tag">div</span>&gt;
 Â &lt;<span class="hljs-selector-tag">p</span>&gt;<span class="hljs-selector-tag">B</span>&lt;/<span class="hljs-selector-tag">p</span>&gt;
 Â &lt;<span class="hljs-selector-tag">span</span>&gt;<span class="hljs-selector-tag">A</span>&lt;/<span class="hljs-selector-tag">span</span>&gt;
&lt;/<span class="hljs-selector-tag">div</span>&gt;
</code></pre>
<p>React <strong>ä¸ä¼š</strong>è®¤ä¸º <code>&lt;span&gt;</code> å’Œ <code>&lt;p&gt;</code> æ˜¯â€œäº¤æ¢äº†ä½ç½®â€ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹ï¼š<code>&lt;span&gt;</code> â†’ <code>&lt;p&gt;</code>ï¼šç±»å‹ä¸åŒ â†’ é”€æ¯ <code>&lt;span&gt;</code>ï¼Œåˆ›å»º <code>&lt;p&gt;</code></li>
<li>ç¬¬äºŒä¸ªå­èŠ‚ç‚¹ï¼š<code>&lt;p&gt;</code> â†’ <code>&lt;span&gt;</code>ï¼šç±»å‹ä¸åŒ â†’ é”€æ¯ <code>&lt;p&gt;</code>ï¼Œåˆ›å»º <code>&lt;span&gt;</code></li>
</ul>
<p><strong>é™¤éä½¿ç”¨ <code>key</code></strong>ï¼Œå¦åˆ™ React ä¸ä¼šå°è¯•â€œç§»åŠ¨â€èŠ‚ç‚¹ã€‚</p>
<h4 data-id="heading-4"><strong>2.2 DOM å…ƒç´ ï¼ˆå¦‚</strong> <code>&lt;div&gt;</code> <strong>,</strong> <code>&lt;span&gt;</code> <strong>ï¼‰çš„å¤ç”¨åˆ¤æ–­</strong></h4>
<p>åˆ¤æ–­æ¡ä»¶ï¼šæ ‡ç­¾åï¼ˆtypeï¼‰å¿…é¡»å®Œå…¨ç›¸åŒ</p>
<ul>
<li>å¦‚æœæ–°æ—§è™šæ‹Ÿ DOM èŠ‚ç‚¹çš„ <code>type</code> ç›¸åŒï¼ˆæ¯”å¦‚éƒ½æ˜¯ <code>'div'</code>ï¼‰ï¼Œåˆ™<strong>å¤ç”¨çœŸå® DOM èŠ‚ç‚¹</strong>ã€‚</li>
<li>ç„¶åå¯¹æ¯” <code>props</code>ï¼Œåªæ›´æ–°å‘ç”Ÿå˜åŒ–çš„å±æ€§ï¼ˆå¦‚ <code>className</code>, <code>style</code>, <code>onClick</code> ç­‰ï¼‰ã€‚</li>
</ul>
<p><strong>ç¤ºä¾‹ 1ï¼šå¤ç”¨ âœ…</strong></p>
<pre><code class="hljs language-css" lang="css">// æ—§ VNode: { type: <span class="hljs-string">'div'</span>, props: { className: <span class="hljs-string">'red'</span> } }
// æ–° VNode: { type: <span class="hljs-string">'div'</span>, props: { className: <span class="hljs-string">'blue'</span> } }
</code></pre>
<p>â†’ å¤ç”¨åŒä¸€ä¸ª <code>&lt;div&gt;</code> å…ƒç´ ï¼Œä»…å°† <code>className</code> ä» <code>'red'</code> æ”¹ä¸º <code>'blue'</code>ã€‚</p>
<p><strong>ç¤ºä¾‹ 2ï¼šä¸å¤ç”¨ âŒ</strong></p>
<pre><code class="hljs language-css" lang="css">// æ—§ VNode: { type: <span class="hljs-string">'div'</span>, ... }
// æ–° VNode: { type: <span class="hljs-string">'span'</span>, ... }
</code></pre>
<p>â†’ ç±»å‹ä¸åŒï¼Œ<strong>é”€æ¯æ•´ä¸ªæ—§å­æ ‘</strong>ï¼Œåˆ›å»ºæ–°çš„ <code>&lt;span&gt;</code> åŠå…¶å­æ ‘ã€‚</p>
<blockquote>
<p>ğŸ’¡ æ³¨æ„ï¼š<code>type</code> æ˜¯å­—ç¬¦ä¸²ï¼ˆåŸç”Ÿ DOM æ ‡ç­¾ï¼‰æˆ–å‡½æ•°/ç±»ï¼ˆç»„ä»¶ï¼‰ã€‚</p>
</blockquote>
<h4 data-id="heading-5"><strong>2.3 ç»„ä»¶ï¼ˆComponentï¼‰çš„å¤ç”¨åˆ¤æ–­</strong></h4>
<p>ç»„ä»¶åˆ†ä¸º <strong>å‡½æ•°ç»„ä»¶</strong> å’Œ <strong>ç±»ç»„ä»¶</strong>ï¼Œä½† React å¯¹å®ƒä»¬çš„å¤ç”¨åˆ¤æ–­é€»è¾‘ä¸€è‡´ã€‚</p>
<p><strong>åˆ¤æ–­æ¡ä»¶ï¼šç»„ä»¶çš„æ„é€ å‡½æ•°ï¼ˆæˆ–å‡½æ•°å¼•ç”¨ï¼‰å¿…é¡»æ˜¯åŒä¸€ä¸ª</strong></p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œç»„ä»¶çš„ <code>type</code> å¿…é¡»ä¸¥æ ¼ç›¸ç­‰ï¼ˆ===ï¼‰ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼šå¤ç”¨ âœ…ï¼ˆåŒä¸€ç»„ä»¶ï¼‰</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">MyButton</span>(<span class="hljs-params">{ label }</span>) {
 Â <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>{label}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
}
â€‹
<span class="hljs-comment">// æ¸²æŸ“</span>
&lt;<span class="hljs-title class_">MyButton</span> label=<span class="hljs-string">"Click"</span> /&gt;
<span class="hljs-comment">// ä¸‹æ¬¡æ›´æ–°</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">MyButton</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"Press"</span> /&gt;</span></span>
</code></pre>
<p>â†’ <code>type</code> éƒ½æ˜¯ <code>MyButton</code> å‡½æ•°ï¼ˆå¼•ç”¨ç›¸åŒï¼‰â†’ <strong>å¤ç”¨ç»„ä»¶å®ä¾‹</strong>ï¼ˆå¯¹å‡½æ•°ç»„ä»¶æ¥è¯´æ˜¯ Fiber èŠ‚ç‚¹ï¼‰ï¼Œè°ƒç”¨æ–° <code>render</code>ï¼ˆå³é‡æ–°æ‰§è¡Œå‡½æ•°ï¼‰ï¼Œä½†ä¸ä¼šå¸è½½/é‡å»ºã€‚</p>
<p>å¯¹äºç±»ç»„ä»¶ï¼Œè¿˜ä¼š<strong>ä¿ç•™ state å’Œ ref</strong>ã€‚</p>
<p><strong>ç¤ºä¾‹ 2ï¼šä¸å¤ç”¨ âŒï¼ˆä¸åŒç»„ä»¶ï¼‰</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">{condition ? <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LoginButton</span> /&gt;</span></span> : <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LogoutButton</span> /&gt;</span></span>}
</code></pre>
<p>â†’ <code>LoginButton !== LogoutButton</code> â†’ å³ä½¿ç»“æ„ç›¸ä¼¼ï¼ŒReact ä¹Ÿä¼šï¼š</p>
<ul>
<li>å¸è½½ <code>LoginButton</code>ï¼ˆè§¦å‘ <code>componentWillUnmount</code> / <code>useEffect cleanup</code>ï¼‰</li>
<li>åˆ›å»º <code>LogoutButton</code>ï¼ˆè§¦å‘ <code>constructor</code> / <code>useEffect</code>ï¼‰</li>
</ul>
<p><strong>ç¤ºä¾‹ 3ï¼šåŠ¨æ€ç»„ä»¶é™·é˜± âŒ</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params"/>) {
 Â <span class="hljs-comment">// âŒ æ¯æ¬¡æ¸²æŸ“éƒ½å®šä¹‰æ–°ç»„ä»¶ï¼</span>
 Â <span class="hljs-keyword">const</span> <span class="hljs-title function_">TempButton</span> = (<span class="hljs-params"/>) =&gt; <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Temp<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
 Â <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TempButton</span> /&gt;</span></span>;
}
</code></pre>
<p>â†’ æ¯æ¬¡ <code>Parent</code> é‡æ¸²æŸ“ï¼Œ<code>TempButton</code> éƒ½æ˜¯ä¸€ä¸ª<strong>æ–°çš„å‡½æ•°å¼•ç”¨</strong> â†’ React è®¤ä¸ºç»„ä»¶ç±»å‹å˜äº† â†’ <strong>ä¸æ–­é”€æ¯é‡å»º</strong> â†’ çŠ¶æ€ä¸¢å¤±ã€æ€§èƒ½å·®ã€‚</p>
<p>âœ… æ­£ç¡®åšæ³•ï¼šå°†ç»„ä»¶å®šä¹‰æåˆ°å¤–éƒ¨æˆ–ç”¨ <code>useMemo</code> ç¼“å­˜ï¼ˆä½†é€šå¸¸åº”é¿å…å†…è”å®šä¹‰ç»„ä»¶ï¼‰ã€‚</p>
<h4 data-id="heading-6">2.4 åˆ—è¡¨ä¸­èŠ‚ç‚¹çš„å¤ç”¨ï¼š<code>key</code> çš„ä½œç”¨</h4>
<p>å½“å¤„ç†å…„å¼ŸèŠ‚ç‚¹åˆ—è¡¨æ—¶ï¼ˆå¦‚ <code>map()</code> æ¸²æŸ“ï¼‰ï¼ŒReact é»˜è®¤æŒ‰<strong>ç´¢å¼•ä½ç½®</strong>æ¯”å¯¹ã€‚ä½†è¿™æ ·æ— æ³•æ­£ç¡®è¯†åˆ«â€œç§»åŠ¨â€æˆ–â€œæ’å…¥â€ã€‚</p>
<p><strong><code>key</code> çš„æ ¸å¿ƒä½œç”¨ï¼šæ ‡è¯†èŠ‚ç‚¹çš„å”¯ä¸€èº«ä»½</strong></p>
<p>React é€šè¿‡ <code>key</code> å»ºç«‹ <strong>â€œæ—§èŠ‚ç‚¹ key â†’ æ—§èŠ‚ç‚¹â€ çš„æ˜ å°„è¡¨</strong>ï¼Œç„¶åéå†æ–°åˆ—è¡¨ï¼š</p>
<ol>
<li>å¯¹æ¯ä¸ªæ–°èŠ‚ç‚¹ï¼Œç”¨ <code>key</code> æŸ¥æ‰¾æ˜¯å¦æœ‰å¯¹åº”çš„æ—§èŠ‚ç‚¹ã€‚</li>
<li>å¦‚æœæ‰¾åˆ°ä¸” <code>type</code> ç›¸åŒ â†’ <strong>å¤ç”¨è¯¥ DOM/ç»„ä»¶</strong>ã€‚</li>
<li>å¦‚æœ <code>type</code> ä¸åŒ â†’ é”€æ¯æ—§èŠ‚ç‚¹ï¼Œåˆ›å»ºæ–°èŠ‚ç‚¹ã€‚</li>
<li>å¦‚æœ <code>key</code> ä¸å­˜åœ¨äºæ—§åˆ—è¡¨ â†’ åˆ›å»ºæ–°èŠ‚ç‚¹ã€‚</li>
<li>æ—§åˆ—è¡¨ä¸­æœªè¢«åŒ¹é…çš„èŠ‚ç‚¹ â†’ åˆ é™¤ã€‚</li>
</ol>
<p><strong>ç¤ºä¾‹ï¼šå¸¦ key çš„åˆ—è¡¨æ›´æ–°</strong></p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// æ—§</span>
[
  { key: <span class="hljs-string">'a'</span>, <span class="hljs-keyword">type</span>: <span class="hljs-string">'li'</span>, children: <span class="hljs-string">'Apple'</span> },
  { key: <span class="hljs-string">'b'</span>, <span class="hljs-keyword">type</span>: <span class="hljs-string">'li'</span>, children: <span class="hljs-string">'Banana'</span> }
]
â€‹
<span class="hljs-comment">// æ–°</span>
[
  { key: <span class="hljs-string">'b'</span>, <span class="hljs-keyword">type</span>: <span class="hljs-string">'li'</span>, children: <span class="hljs-string">'Banana!'</span> },
  { key: <span class="hljs-string">'c'</span>, <span class="hljs-keyword">type</span>: <span class="hljs-string">'li'</span>, children: <span class="hljs-string">'Cherry'</span> }
]
</code></pre>
<p>Diff è¿‡ç¨‹ï¼š</p>
<ul>
<li><code>key='b'</code>ï¼šå­˜åœ¨ï¼Œtype ç›¸åŒ â†’ <strong>å¤ç”¨</strong> <code>&lt;li&gt;</code>ï¼Œæ›´æ–°æ–‡æœ¬ä¸º <code>'Banana!'</code></li>
<li><code>key='c'</code>ï¼šæ–°å¢ â†’ åˆ›å»ºæ–° <code>&lt;li&gt;</code></li>
<li><code>key='a'</code>ï¼šæœªè¢«ä½¿ç”¨ â†’ åˆ é™¤</li>
</ul>
<p>âœ… ç»“æœï¼šåªæœ‰ Apple è¢«åˆ ï¼ŒBanana èŠ‚ç‚¹è¢«å¤ç”¨ï¼ˆä¿æŒ focusã€åŠ¨ç”»çŠ¶æ€ç­‰ï¼‰ï¼ŒCherry æ–°å¢ã€‚</p>
<p><strong>å¦‚æœä¸ç”¨ keyï¼ˆæˆ–ç”¨ indexï¼‰ï¼š</strong></p>
<ul>
<li>æ’å…¥åˆ°å¼€å¤´ä¼šå¯¼è‡´åç»­æ‰€æœ‰é¡¹è¢«é‡æ–°æ¸²æŸ“ï¼Œå³ä½¿å†…å®¹æ²¡å˜ã€‚</li>
</ul>
<h3 data-id="heading-7">3. æ¯”è¾ƒè¿‡ç¨‹</h3>
<p>ä¸»è¦åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š</p>
<p><strong>ç¬¬ä¸€ä¸ªé˜¶æ®µï¼š</strong></p>
<p>é€šè¿‡ç´¢å¼•ä¸€ä¸€å¯¹æ¯”ï¼Œå¦‚æœå¯ä»¥å¤ç”¨å°±ä¸‹ä¸€ä¸ªï¼Œä¸å¯ä»¥å¤ç”¨å°±ç»“æŸã€‚</p>
<p><strong>ç¬¬äºŒä¸ªé˜¶æ®µï¼š</strong></p>
<p>æŠŠå‰©ä¸‹çš„<code>æ—§ fiber</code> æ”¾åˆ° map é‡Œï¼Œéå†å‰©ä½™çš„ <code>æ–° vdom</code>ï¼Œä¸€ä¸€æŸ¥æ‰¾ map ä¸­æ˜¯å¦æœ‰å¯å¤ç”¨çš„èŠ‚ç‚¹ã€‚</p>
<p>æœ€åï¼Œ</p>
<p>æŠŠå‰©ä¸‹çš„è€ fiber åˆ æ‰</p>
<p>å‰©ä¸‹çš„æ–° vdom æ–°å¢</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JS å¯¹è±¡éå†å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7602846823327055907</link>    <guid>https://juejin.cn/post/7602846823327055907</guid>    <pubDate>2026-02-05T05:25:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602846823327055907" data-draft-id="7602825342229430306" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JS å¯¹è±¡éå†å…¨è§£æ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2026-02-05T05:25:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸æƒ³ç§ƒå¤´çš„ç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/2754702534251820"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JS å¯¹è±¡éå†å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2754702534251820/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸æƒ³ç§ƒå¤´çš„ç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T05:25:28.000Z" title="Thu Feb 05 2026 05:25:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">JS å¯¹è±¡éå†å…¨è§£æï¼šä»åŸºç¡€åˆ°å®æˆ˜ï¼Œæ–°æ‰‹ä¹Ÿèƒ½è½»æ¾ä¸Šæ‰‹</h2>
<p>åœ¨ JavaScript å¼€å‘ä¸­ï¼Œå¯¹è±¡ï¼ˆObjectï¼‰æ˜¯æœ€å¸¸ç”¨çš„æ•°æ®ç»“æ„ä¹‹ä¸€ï¼Œå‡ ä¹æ‰€æœ‰ä¸šåŠ¡åœºæ™¯éƒ½ä¼šæ¶‰åŠåˆ°å¯¹è±¡çš„éå†â€”â€”æ¯”å¦‚è·å–å¯¹è±¡çš„æ‰€æœ‰å±æ€§ã€ç­›é€‰ç¬¦åˆæ¡ä»¶çš„é”®å€¼å¯¹ã€æ‰¹é‡å¤„ç†å¯¹è±¡æ•°æ®ç­‰ã€‚</p>
<p>ä½†å¾ˆå¤šæ–°æ‰‹åœ¨é¢å¯¹å¯¹è±¡éå†æ—¶ï¼Œæ€»ä¼šå›°æƒ‘ï¼š<code>for...in</code> å’Œ <code>Object.keys()</code> æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿä»€ä¹ˆæ—¶å€™ç”¨ <code>Object.values()</code>ï¼Ÿå¦‚ä½•éå†å¯¹è±¡çš„åŸå‹é“¾å±æ€§ï¼Ÿ</p>
<p>ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œå°±å¸¦ä½ å½»åº•åƒé€ JS å¯¹è±¡éå†çš„æ‰€æœ‰å¸¸ç”¨æ–¹æ³•ï¼Œä»åŸºç¡€ç”¨æ³•åˆ°è¿›é˜¶æŠ€å·§ï¼Œå†åˆ°å®æˆ˜åœºæ™¯å¯¹æ¯”ï¼Œå¸®ä½ é¿å¼€å‘ç‚¹ã€çµæ´»è¿ç”¨ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€å…ˆæ˜ç¡®ï¼šä»€ä¹ˆæ˜¯ JS å¯¹è±¡ï¼Ÿ</h3>
<p>åœ¨å¼€å§‹éå†ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç®€å•å›é¡¾ä¸‹ JS å¯¹è±¡çš„åŸºç¡€â€”â€”å¯¹è±¡æ˜¯ç”± <code>é”®ï¼ˆkeyï¼‰</code> å’Œ <code>å€¼ï¼ˆvalueï¼‰</code> ç»„æˆçš„æ— åºé›†åˆï¼Œé”®é€šå¸¸æ˜¯å­—ç¬¦ä¸²ï¼ˆES6 åæ”¯æŒ Symbolï¼‰ï¼Œå€¼å¯ä»¥æ˜¯ä»»æ„æ•°æ®ç±»å‹ï¼ˆå­—ç¬¦ä¸²ã€æ•°å­—ã€å‡½æ•°ã€å¯¹è±¡ç­‰ï¼‰ã€‚</p>
<p>ç¤ºä¾‹å¯¹è±¡ï¼ˆåæ–‡æ‰€æœ‰æ–¹æ³•å‡åŸºäºæ­¤å¯¹è±¡æ¼”ç¤ºï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// åŸºç¡€å¯¹è±¡</span>
<span class="hljs-keyword">const</span> user = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"æ˜é‡‘å°å†Œ"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">3</span>,
  <span class="hljs-attr">gender</span>: <span class="hljs-string">"male"</span>,
  <span class="hljs-attr">isVip</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">hobbies</span>: [<span class="hljs-string">"coding"</span>, <span class="hljs-string">"writing"</span>],
  <span class="hljs-comment">// æ–¹æ³•</span>
  <span class="hljs-attr">sayHello</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Hello, Juejin!"</span>);
  }
};

<span class="hljs-comment">// åŸå‹é“¾ä¸Šçš„å±æ€§ï¼ˆç”¨äºåç»­æ¼”ç¤ºåŒºåˆ«ï¼‰</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">protoProp</span> = <span class="hljs-string">"æˆ‘æ˜¯åŸå‹é“¾ä¸Šçš„å±æ€§"</span>;
</code></pre>
<h3 data-id="heading-2">äºŒã€å¸¸ç”¨å¯¹è±¡éå†æ–¹æ³•ï¼ˆæŒ‰ä½¿ç”¨é¢‘ç‡æ’åºï¼‰</h3>
<p>ä»¥ä¸‹æ–¹æ³•æ˜¯å¼€å‘ä¸­æœ€å¸¸ç”¨çš„ï¼Œé‡ç‚¹æŒæ¡å‰ 4 ç§ï¼ŒåŸºæœ¬èƒ½è¦†ç›– 90%+ çš„ä¸šåŠ¡åœºæ™¯ã€‚</p>
<h4 data-id="heading-3">1. for...in å¾ªç¯ï¼ˆæœ€åŸºç¡€ï¼Œéå†å¯æšä¸¾å±æ€§ï¼‰</h4>
<p><code>for...in</code> æ˜¯æœ€æ—©çš„å¯¹è±¡éå†æ–¹æ³•ï¼Œä¹Ÿæ˜¯æœ€åŸºç¡€çš„æ–¹å¼ï¼Œå®ƒä¼šéå†å¯¹è±¡<strong>è‡ªèº«çš„å¯æšä¸¾å±æ€§</strong>å’Œ<strong>åŸå‹é“¾ä¸Šçš„å¯æšä¸¾å±æ€§</strong>ï¼ˆè¿™æ˜¯å®ƒçš„å‘ç‚¹ï¼Œä¹Ÿæ˜¯é‡ç‚¹æ³¨æ„äº‹é¡¹ï¼‰ã€‚</p>
<h5 data-id="heading-4">åŸºç¡€ç”¨æ³•</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// for...in éå†å¯¹è±¡</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> user) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"é”®ï¼š"</span>, key); <span class="hljs-comment">// è¾“å‡ºå¯¹è±¡çš„é”®</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å€¼ï¼š"</span>, user[key]); <span class="hljs-comment">// è¾“å‡ºå¯¹åº”çš„å€¼</span>
}
</code></pre>
<h5 data-id="heading-5">è¾“å‡ºç»“æœï¼ˆé‡ç‚¹çœ‹æœ€åä¸€è¡Œï¼‰</h5>
<pre><code class="hljs language-js" lang="js">é”®ï¼š nameï¼Œå€¼ï¼š æ˜é‡‘å°å†Œ
é”®ï¼š ageï¼Œå€¼ï¼š <span class="hljs-number">3</span>
é”®ï¼š genderï¼Œå€¼ï¼š male
é”®ï¼š isVipï¼Œå€¼ï¼š <span class="hljs-literal">true</span>
é”®ï¼š hobbiesï¼Œå€¼ï¼š [ <span class="hljs-string">'coding'</span>, <span class="hljs-string">'writing'</span> ]
é”®ï¼š sayHelloï¼Œå€¼ï¼š [<span class="hljs-title class_">Function</span>: sayHello]
é”®ï¼š protoPropï¼Œå€¼ï¼š æˆ‘æ˜¯åŸå‹é“¾ä¸Šçš„å±æ€§
</code></pre>
<h5 data-id="heading-6">æ ¸å¿ƒæ³¨æ„äº‹é¡¹ï¼ˆé¿å‘å…³é”®ï¼‰</h5>
<ul>
<li>ä¼šéå†åŸå‹é“¾ä¸Šçš„å¯æšä¸¾å±æ€§ï¼ˆå¦‚ä¸Šé¢çš„ <code>protoProp</code>ï¼‰ï¼Œè¿™é€šå¸¸ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œæ‰€ä»¥ä¸€å®šè¦æ­é… <code>hasOwnProperty()</code> ä½¿ç”¨ã€‚</li>
<li>ä¸èƒ½éå† Symbol ç±»å‹çš„é”®ï¼ˆåæ–‡ä¼šè®²ä¸“é—¨éå† Symbol çš„æ–¹æ³•ï¼‰ã€‚</li>
</ul>
<h5 data-id="heading-7">æ­£ç¡®ç”¨æ³•ï¼ˆæ­é… hasOwnPropertyï¼‰</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> user) {
  <span class="hljs-comment">// åªéå†å¯¹è±¡è‡ªèº«çš„å±æ€§ï¼Œè¿‡æ»¤åŸå‹é“¾å±æ€§</span>
  <span class="hljs-keyword">if</span> (user.<span class="hljs-title function_">hasOwnProperty</span>(key)) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"é”®ï¼š"</span>, key, <span class="hljs-string">"å€¼ï¼š"</span>, user[key]);
  }
}
</code></pre>
<p>è¿™æ ·å°±ä¸ä¼šè¾“å‡ºåŸå‹é“¾ä¸Šçš„ <code>protoProp</code> äº†ï¼Œè¿™æ˜¯ <code>for...in</code> çš„æ ‡å‡†ç”¨æ³•ã€‚</p>
<h4 data-id="heading-8">2. Object.keys() + forEachï¼ˆæœ€å¸¸ç”¨ï¼Œéå†è‡ªèº«å¯æšä¸¾é”®ï¼‰</h4>
<p>ES5 æ–°å¢çš„ <code>Object.keys()</code> æ–¹æ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡<strong>è‡ªèº«å¯æšä¸¾å±æ€§é”®</strong>çš„æ•°ç»„ï¼ˆä¸åŒ…å«åŸå‹é“¾å±æ€§ï¼Œä¹Ÿä¸åŒ…å« Symbol é”®ï¼‰ï¼Œå†æ­é… <code>forEach</code> å¾ªç¯ï¼Œæ˜¯ç›®å‰å¼€å‘ä¸­æœ€å¸¸ç”¨çš„éå†æ–¹å¼ã€‚</p>
<h5 data-id="heading-9">åŸºç¡€ç”¨æ³•</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// 1. è·å–å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å¯æšä¸¾é”®ï¼Œè¿”å›æ•°ç»„</span>
<span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(user);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(keys); <span class="hljs-comment">// è¾“å‡ºï¼š['name', 'age', 'gender', 'isVip', 'hobbies', 'sayHello']</span>

<span class="hljs-comment">// 2. æ­é… forEach éå†</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(user).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"é”®ï¼š"</span>, key);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å€¼ï¼š"</span>, user[key]);
});
</code></pre>
<h5 data-id="heading-10">æ ¸å¿ƒä¼˜åŠ¿</h5>
<ul>
<li>è‡ªåŠ¨è¿‡æ»¤åŸå‹é“¾å±æ€§ï¼Œæ— éœ€æ‰‹åŠ¨å†™ <code>hasOwnProperty()</code>ï¼Œæ›´ç®€æ´ã€æ›´å®‰å…¨ã€‚</li>
<li>è¿”å›çš„æ˜¯æ•°ç»„ï¼Œå¯ç›´æ¥ä½¿ç”¨æ•°ç»„çš„æ–¹æ³•ï¼ˆå¦‚ <code>forEach</code>ã€<code>map</code>ã€<code>filter</code> ç­‰ï¼‰ï¼Œçµæ´»åº¦æ›´é«˜ã€‚</li>
</ul>
<h5 data-id="heading-11">å®æˆ˜åœºæ™¯</h5>
<p>ç­›é€‰å¯¹è±¡ä¸­å€¼ä¸ºå¸ƒå°”ç±»å‹çš„é”®å€¼å¯¹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> boolProps = {};
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(user).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> user[key] === <span class="hljs-string">"boolean"</span>) {
    boolProps[key] = user[key];
  }
});
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(boolProps); <span class="hljs-comment">// è¾“å‡ºï¼š{ isVip: true }</span>
</code></pre>
<h4 data-id="heading-12">3. Object.values() + forEachï¼ˆéå†è‡ªèº«å¯æšä¸¾å€¼ï¼‰</h4>
<p>ES2017ï¼ˆES8ï¼‰æ–°å¢çš„ <code>Object.values()</code> æ–¹æ³•ï¼Œå’Œ <code>Object.keys()</code> å¯¹åº”ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡<strong>è‡ªèº«å¯æšä¸¾å±æ€§å€¼</strong>çš„æ•°ç»„ï¼ˆä¸åŒ…å«åŸå‹é“¾å±æ€§ã€Symbol é”®å¯¹åº”çš„å€¼ï¼‰ã€‚</p>
<h5 data-id="heading-13">åŸºç¡€ç”¨æ³•</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è·å–å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å¯æšä¸¾å€¼ï¼Œè¿”å›æ•°ç»„</span>
<span class="hljs-keyword">const</span> values = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(user);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(values); 
<span class="hljs-comment">// è¾“å‡ºï¼š['æ˜é‡‘å°å†Œ', 3, 'male', true, ['coding', 'writing'], [Function: sayHello]]</span>

<span class="hljs-comment">// æ­é… forEach éå†å€¼</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(user).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å€¼ï¼š"</span>, value);
});
</code></pre>
<h5 data-id="heading-14">å®æˆ˜åœºæ™¯</h5>
<p>ç»Ÿè®¡å¯¹è±¡ä¸­æ‰€æœ‰æ•°å€¼ç±»å‹çš„å€¼çš„æ€»å’Œï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> sum = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">values</span>(user).<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">total, value</span>) =&gt;</span> {
  <span class="hljs-comment">// åªç´¯åŠ æ•°å€¼ç±»å‹çš„å€¼</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> value === <span class="hljs-string">"number"</span> ? total + value : total;
}, <span class="hljs-number">0</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(sum); <span class="hljs-comment">// è¾“å‡ºï¼š3</span>
</code></pre>
<h4 data-id="heading-15">4. Object.entries() + forEachï¼ˆéå†è‡ªèº«å¯æšä¸¾é”®å€¼å¯¹ï¼‰</h4>
<p>åŒæ ·æ˜¯ ES2017 æ–°å¢çš„æ–¹æ³•ï¼Œ<code>Object.entries()</code> æ˜¯æœ€çµæ´»çš„éå†æ–¹æ³•ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡<strong>è‡ªèº«å¯æšä¸¾é”®å€¼å¯¹</strong>çš„äºŒç»´æ•°ç»„ï¼ˆæ¯ä¸ªå­æ•°ç»„æ˜¯ [key, value]ï¼‰ï¼Œå®Œç¾å…¼é¡¾é”®å’Œå€¼çš„è·å–ã€‚</p>
<h5 data-id="heading-16">åŸºç¡€ç”¨æ³•</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è·å–å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å¯æšä¸¾é”®å€¼å¯¹ï¼Œè¿”å›äºŒç»´æ•°ç»„</span>
<span class="hljs-keyword">const</span> entries = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(user);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(entries);
<span class="hljs-comment">// è¾“å‡ºï¼š[</span>
<span class="hljs-comment">//   ['name', 'æ˜é‡‘å°å†Œ'],</span>
<span class="hljs-comment">//   ['age', 3],</span>
<span class="hljs-comment">//   ...</span>
<span class="hljs-comment">// ]</span>

<span class="hljs-comment">// æ­é… forEach éå†é”®å€¼å¯¹</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(user).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[key, value]</span>) =&gt;</span> {
  <span class="hljs-comment">// è§£æ„èµ‹å€¼ï¼Œç›´æ¥è·å– key å’Œ valueï¼Œæ›´ç®€æ´</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`é”®ï¼š<span class="hljs-subst">${key}</span>ï¼Œå€¼ï¼š<span class="hljs-subst">${value}</span>`</span>);
});
</code></pre>
<h5 data-id="heading-17">å®æˆ˜åœºæ™¯</h5>
<p>å°†å¯¹è±¡è½¬æ¢ä¸º Mapï¼ˆMap æ”¯æŒæ›´å¤šçµæ´»æ“ä½œï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Object.entries() å¯ç›´æ¥ä½œä¸º Map çš„æ„é€ å‚æ•°</span>
<span class="hljs-keyword">const</span> userMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(user));
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(userMap.<span class="hljs-title function_">get</span>(<span class="hljs-string">"name"</span>)); <span class="hljs-comment">// è¾“å‡ºï¼šæ˜é‡‘å°å†Œ</span>

<span class="hljs-comment">// éå† Mapï¼ˆè¡¥å……ï¼‰</span>
userMap.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">value, key</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"é”®ï¼š"</span>, key, <span class="hljs-string">"å€¼ï¼š"</span>, value);
});
</code></pre>
<h4 data-id="heading-18">5. è¿›é˜¶ï¼šéå† Symbol ç±»å‹çš„é”®</h4>
<p>å¦‚æœå¯¹è±¡çš„é”®æ˜¯ Symbol ç±»å‹ï¼ˆES6 æ–°å¢ï¼Œç”¨äºè¡¨ç¤ºå”¯ä¸€é”®ï¼‰ï¼Œä¸Šé¢çš„ 4 ç§æ–¹æ³•éƒ½æ— æ³•éå†åˆ°ï¼Œæ­¤æ—¶éœ€è¦ä½¿ç”¨ <code>Object.getOwnPropertySymbols()</code> æ–¹æ³•ã€‚</p>
<h5 data-id="heading-19">ç¤ºä¾‹ç”¨æ³•</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªåŒ…å« Symbol é”®çš„å¯¹è±¡</span>
<span class="hljs-keyword">const</span> obj = {
  [<span class="hljs-title class_">Symbol</span>(<span class="hljs-string">"id"</span>)]: <span class="hljs-number">123</span>,
  <span class="hljs-attr">name</span>: <span class="hljs-string">"æµ‹è¯•"</span>
};

<span class="hljs-comment">// éå† Symbol ç±»å‹çš„é”®</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertySymbols</span>(obj).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">symbolKey</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Symbol é”®ï¼š"</span>, symbolKey);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"å¯¹åº”å€¼ï¼š"</span>, obj[symbolKey]); <span class="hljs-comment">// è¾“å‡ºï¼š123</span>
});
</code></pre>
<h4 data-id="heading-20">6. é«˜é˜¶ï¼šéå†æ‰€æœ‰å±æ€§ï¼ˆè‡ªèº«+åŸå‹é“¾ï¼Œå¯æšä¸¾+ä¸å¯æšä¸¾ï¼‰</h4>
<p>å¼€å‘ä¸­å¾ˆå°‘ç”¨åˆ°ï¼Œä½†é¢è¯•å¯èƒ½ä¼šé—®â€”â€”å¦‚æœéœ€è¦éå†å¯¹è±¡<strong>è‡ªèº«çš„æ‰€æœ‰å±æ€§</strong>ï¼ˆåŒ…æ‹¬ä¸å¯æšä¸¾ï¼‰ï¼Œæˆ–è€…<strong>åŸå‹é“¾ä¸Šçš„æ‰€æœ‰å±æ€§</strong>ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<ul>
<li><code>Object.getOwnPropertyNames(obj)</code>ï¼šè¿”å›å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å±æ€§é”®ï¼ˆåŒ…æ‹¬ä¸å¯æšä¸¾ï¼Œä¸åŒ…æ‹¬ Symbolï¼‰ã€‚</li>
<li><code>Reflect.ownKeys(obj)</code>ï¼šè¿”å›å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å±æ€§é”®ï¼ˆåŒ…æ‹¬ä¸å¯æšä¸¾ã€Symbol é”®ï¼‰ï¼Œç›¸å½“äº <code>Object.keys(obj) + Object.getOwnPropertySymbols(obj) + ä¸å¯æšä¸¾é”®</code>ã€‚</li>
</ul>
<h5 data-id="heading-21">ç¤ºä¾‹</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// éå†è‡ªèº«æ‰€æœ‰å±æ€§ï¼ˆåŒ…æ‹¬ä¸å¯æšä¸¾ï¼‰</span>
<span class="hljs-keyword">const</span> allOwnKeys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertyNames</span>(user);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(allOwnKeys); <span class="hljs-comment">// åŒ…å« sayHelloï¼ˆå‡½æ•°ä¹Ÿæ˜¯å±æ€§ï¼‰</span>

<span class="hljs-comment">// éå†è‡ªèº«æ‰€æœ‰å±æ€§ï¼ˆåŒ…æ‹¬ä¸å¯æšä¸¾ã€Symbolï¼‰</span>
<span class="hljs-keyword">const</span> allKeys = <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">ownKeys</span>(user);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(allKeys);
</code></pre>
<h3 data-id="heading-22">ä¸‰ã€å¸¸ç”¨æ–¹æ³•å¯¹æ¯”è¡¨ï¼ˆä¸€ç›®äº†ç„¶ï¼‰</h3>





























































<table><thead><tr><th>æ–¹æ³•</th><th>éå†èŒƒå›´</th><th>æ˜¯å¦åŒ…å«åŸå‹é“¾</th><th>æ˜¯å¦åŒ…å« Symbol é”®</th><th>æ˜¯å¦åŒ…å«ä¸å¯æšä¸¾</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>for...in</td><td>è‡ªèº«å¯æšä¸¾ + åŸå‹é“¾å¯æšä¸¾</td><td>æ˜¯ï¼ˆéœ€æ‰‹åŠ¨è¿‡æ»¤ï¼‰</td><td>å¦</td><td>å¦</td><td>å…¼å®¹æ—§ç¯å¢ƒï¼Œéœ€è¿‡æ»¤åŸå‹é“¾</td></tr><tr><td>Object.keys()</td><td>è‡ªèº«å¯æšä¸¾é”®</td><td>å¦</td><td>å¦</td><td>å¦</td><td>ä»…éœ€è·å–é”®ï¼Œæ­é…æ•°ç»„æ–¹æ³•</td></tr><tr><td>Object.values()</td><td>è‡ªèº«å¯æšä¸¾å€¼</td><td>å¦</td><td>å¦</td><td>å¦</td><td>ä»…éœ€è·å–å€¼ï¼Œå¦‚ç»Ÿè®¡ã€ç­›é€‰</td></tr><tr><td>Object.entries()</td><td>è‡ªèº«å¯æšä¸¾é”®å€¼å¯¹</td><td>å¦</td><td>å¦</td><td>å¦</td><td>éœ€åŒæ—¶æ“ä½œé”®å’Œå€¼ï¼ˆæœ€å¸¸ç”¨ï¼‰</td></tr><tr><td>Object.getOwnPropertySymbols()</td><td>è‡ªèº« Symbol é”®</td><td>å¦</td><td>æ˜¯</td><td>å¦</td><td>éå† Symbol ç±»å‹çš„é”®</td></tr><tr><td>Reflect.ownKeys()</td><td>è‡ªèº«æ‰€æœ‰é”®ï¼ˆå¯æšä¸¾+ä¸å¯æšä¸¾+Symbolï¼‰</td><td>å¦</td><td>æ˜¯</td><td>æ˜¯</td><td>é«˜é˜¶åœºæ™¯ï¼Œéœ€è·å–æ‰€æœ‰è‡ªèº«å±æ€§</td></tr></tbody></table>
<h3 data-id="heading-23">å››ã€é¿å‘æŒ‡å—ï¼ˆæ–°æ‰‹å¿…çœ‹ï¼‰</h3>
<ol>
<li>æ°¸è¿œä¸è¦ç”¨ <code>for...in</code> éå†æ•°ç»„ï¼è™½ç„¶æ•°ç»„ä¹Ÿæ˜¯å¯¹è±¡ï¼Œä½† <code>for...in</code> ä¼šéå†æ•°ç»„çš„åŸå‹é“¾å±æ€§ï¼Œè¿˜ä¼šæŒ‰ç…§â€œå­—ç¬¦ä¸²ç´¢å¼•â€æ’åºï¼Œå¯¼è‡´éå†é¡ºåºé”™ä¹±ã€‚</li>
<li>ä½¿ç”¨ <code>for...in</code> å¿…é¡»æ­é… <code>hasOwnProperty()</code>ï¼Œå¦åˆ™ä¼šéå†åˆ°åŸå‹é“¾ä¸Šçš„æ— å…³å±æ€§ï¼Œå¯¼è‡´ä¸šåŠ¡é€»è¾‘å‡ºé”™ã€‚</li>
<li>Symbol ç±»å‹çš„é”®æ— æ³•è¢« <code>Object.keys()</code>ã€<code>Object.values()</code>ã€<code>for...in</code> éå†ï¼Œéœ€ç”¨ä¸“é—¨çš„ <code>Object.getOwnPropertySymbols()</code>ã€‚</li>
<li>å¯¹è±¡æ˜¯æ— åºçš„ï¼è™½ç„¶ ES6 åå¯¹è±¡çš„é”®ä¼šæŒ‰ç…§â€œæ•°å­—ä¼˜å…ˆã€æ’å…¥é¡ºåºâ€æ’åˆ—ï¼Œä½†ä¸è¦ä¾èµ–å¯¹è±¡çš„éå†é¡ºåºæ¥å®ç°ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚éœ€æœ‰åºï¼Œå»ºè®®ç”¨ Mapï¼‰ã€‚</li>
</ol>
<h3 data-id="heading-24">äº”ã€å®æˆ˜æ¡ˆä¾‹ï¼ˆç»¼åˆè¿ç”¨ï¼‰</h3>
<p>éœ€æ±‚ï¼šéå†ä¸€ä¸ªç”¨æˆ·å¯¹è±¡ï¼Œç­›é€‰å‡ºæ‰€æœ‰éå‡½æ•°ç±»å‹çš„å±æ€§ï¼Œå°†å…¶è½¬æ¢ä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆå¦‚ï¼šname=æ˜é‡‘å°å†Œ&amp;age=3ï¼‰ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> user = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"æ˜é‡‘å°å†Œ"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">3</span>,
  <span class="hljs-attr">gender</span>: <span class="hljs-string">"male"</span>,
  <span class="hljs-attr">isVip</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">sayHello</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Hello"</span>);
  }
};

<span class="hljs-comment">// 1. éå†å¯¹è±¡ï¼Œç­›é€‰éå‡½æ•°å±æ€§</span>
<span class="hljs-keyword">const</span> queryArr = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(user).<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">[key, value]</span>) =&gt;</span> {
  <span class="hljs-comment">// æ’é™¤å‡½æ•°ç±»å‹çš„å±æ€§</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> value !== <span class="hljs-string">"function"</span>;
}).<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">[key, value]</span>) =&gt;</span> {
  <span class="hljs-comment">// å°†é”®å€¼å¯¹è½¬æ¢ä¸º "key=value" æ ¼å¼</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${key}</span>=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(value)}</span>`</span>;
});

<span class="hljs-comment">// 2. æ‹¼æ¥ä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²</span>
<span class="hljs-keyword">const</span> queryStr = queryArr.<span class="hljs-title function_">join</span>(<span class="hljs-string">"&amp;"</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(queryStr);
<span class="hljs-comment">// è¾“å‡ºï¼šname=æ˜é‡‘å°å†Œ&amp;age=3&amp;gender=male&amp;isVip=true</span>
</code></pre>
<p>è§£æï¼šè¿™é‡Œç»“åˆäº† <code>Object.entries()</code>ã€<code>filter()</code>ã€<code>map()</code> æ–¹æ³•ï¼Œæ—¢éå†äº†é”®å€¼å¯¹ï¼Œåˆå®Œæˆäº†ç­›é€‰å’Œæ ¼å¼è½¬æ¢ï¼Œæ˜¯å¼€å‘ä¸­éå¸¸å…¸å‹çš„åœºæ™¯ã€‚</p>
<h3 data-id="heading-25">å…­ã€æ€»ç»“</h3>
<p>JS å¯¹è±¡éå†çš„æ ¸å¿ƒæ˜¯â€œæ˜ç¡®éå†èŒƒå›´â€â€”â€”ä½ æ˜¯è¦éå†è‡ªèº«å±æ€§ï¼Œè¿˜æ˜¯åŸå‹é“¾å±æ€§ï¼Ÿæ˜¯è¦é”®ã€å€¼ï¼Œè¿˜æ˜¯é”®å€¼å¯¹ï¼Ÿæ˜¯åŒ…å« Symbol æˆ–ä¸å¯æšä¸¾å±æ€§ï¼Ÿ</p>
<p>å¯¹äºç»å¤§å¤šæ•°å¼€å‘åœºæ™¯ï¼š</p>
<ul>
<li>ä»…éœ€é”® â†’ ç”¨ <code>Object.keys()</code></li>
<li>ä»…éœ€å€¼ â†’ ç”¨ <code>Object.values()</code></li>
<li>éœ€é”®å€¼å¯¹ â†’ ç”¨ <code>Object.entries()</code>ï¼ˆæœ€å¸¸ç”¨ï¼‰</li>
<li>å…¼å®¹æ—§ç¯å¢ƒ â†’ ç”¨ <code>for...in + hasOwnProperty()</code></li>
</ul>
<p>æœ€åï¼Œç¥å¤§å®¶åœ¨ JS çš„ä¸–ç•Œé‡Œï¼Œéå†æ— å‘ï¼Œç¼–ç æ— å¿§ï¼ğŸš€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥ OpenTelemetry æºç ä¸å®æˆ˜ï¼ˆä¸Šç¯‡ï¼‰]]></title>    <link>https://juejin.cn/post/7602825342229348386</link>    <guid>https://juejin.cn/post/7602825342229348386</guid>    <pubDate>2026-02-05T04:34:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602825342229348386" data-draft-id="7602846823326990371" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥ OpenTelemetry æºç ä¸å®æˆ˜ï¼ˆä¸Šç¯‡ï¼‰"/> <meta itemprop="keywords" content="åç«¯,Go"/> <meta itemprop="datePublished" content="2026-02-05T04:34:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸‹æ¬¡ä¸€å®š57"/> <meta itemprop="url" content="https://juejin.cn/user/3722294009017404"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥ OpenTelemetry æºç ä¸å®æˆ˜ï¼ˆä¸Šç¯‡ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3722294009017404/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸‹æ¬¡ä¸€å®š57
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T04:34:54.000Z" title="Thu Feb 05 2026 04:34:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»19åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œé“¾è·¯è¿½è¸ªæ˜¯æ’æŸ¥é—®é¢˜ã€ä¼˜åŒ–æ€§èƒ½çš„æ ¸å¿ƒåˆ©å™¨ï¼Œè€Œ <code>OpenTelemetry</code> ä½œä¸ºå¯è§‚æµ‹æ€§é¢†åŸŸçš„æ ‡å‡†ï¼Œä¸ºæˆ‘ä»¬æä¾›äº†ç»Ÿä¸€çš„è¿½è¸ªæ–¹æ¡ˆã€‚ å¾ˆå¤šå¼€å‘è€…åœ¨ä½¿ç”¨ <code>OpenTelemetry</code> æ—¶ï¼Œå¾€å¾€åªæ˜¯â€œå¤åˆ¶ç²˜è´´ä»£ç â€ï¼Œæ—¢ä¸æ¸…æ¥šåº•å±‚è¿è¡Œæµç¨‹ï¼Œä¹Ÿæ— æ³•åº”å¯¹åç»­çš„å®šåˆ¶åŒ–éœ€æ±‚ï¼ˆæ¯”å¦‚æ›´æ¢è¿½è¸ªåç«¯ã€è°ƒæ•´é‡‡æ ·ç­–ç•¥ï¼‰ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œ<code>OpenTelemetry</code> çš„ Go å®ç°ä¸­è•´å«äº†å¤§é‡ç»å…¸çš„ Go ç¼–ç¨‹æ€æƒ³ï¼ˆé¢å‘æ¥å£ã€é€‰é¡¹æ¨¡å¼ã€åç¨‹å®‰å…¨ç­‰ï¼‰ï¼Œåƒé€å®ƒä¸ä»…èƒ½æå®šé“¾è·¯è¿½è¸ªï¼Œæ›´èƒ½æå‡è‡ªèº«çš„ Go ç¼–ç¨‹åŠŸåº•ã€‚ æœ¬ç¯‡ä½œä¸ºä¸Šç¯‡ï¼Œå°†èšç„¦ <code>OpenTelemetry</code> è¿½è¸ªçš„<strong>æ ¸å¿ƒåˆå§‹åŒ–æµç¨‹</strong>ï¼Œå¸¦ç€å¤§å®¶é€è¡Œæ‹†è§£åˆå§‹åŒ–æºç ï¼Œææ‡‚æ¯ä¸€ä¸ªé…ç½®ã€æ¯ä¸€ä¸ªå‡½æ•°çš„åº•å±‚é€»è¾‘ã€‚æˆ‘ä»¬ä¼šé‡ç‚¹æŒæ¡ <code>TracerProvider</code> çš„æ„å»ºã€é‡‡æ ·ç­–ç•¥çš„å®ç°ã€è¿½è¸ªåç«¯ï¼ˆ<code>Jaeger</code> / <code>Zipkin</code>ï¼‰çš„æ³¨å†Œç­‰æ ¸å¿ƒå†…å®¹ï¼ŒåŒæ—¶è®°ä½å…³é”®ç»“æ„ä½“å’Œå¸¸é‡çš„å«ä¹‰ï¼Œä¸ºä¸‹ç¯‡çš„å®æˆ˜è½åœ°æ‰“ä¸‹åšå®åŸºç¡€ã€‚</p>
<h2 data-id="heading-1">ä»æºç å…¥æ‰‹ï¼Œæ­å»º <code>OpenTelemetry</code> è¿½è¸ªåŸºç¡€æ¡†æ¶</h2>
<p>å¯¹äºè¿™æ®µæ¡ˆä¾‹ï¼Œä¼šå¸¦ç€å¤§å®¶æ·±å…¥æºç ï¼Œç†è§£æ¯ä¸€æ­¥åœ¨åšä»€ä¹ˆï¼Œè¿™æ ·å¤§å®¶åœ¨ç”¨çš„æ—¶å€™ä¼šå°‘ä¸€äº›ç–‘æƒ‘ï¼Œä¸ä¼šç”¨å®Œå°±å¿˜ï¼Œæ¸…æ™°äº†è§£å®ƒçš„è¿è¡Œæµç¨‹ï¼Œæ›´é‡è¦çš„æ˜¯é˜…è¯»æºç ä¼šå­¦åˆ°å¾ˆå¤šç¼–ç¨‹è§„èŒƒï¼Œäº†è§£goè¯­è¨€çš„ç¼–ç¨‹æ€æƒ³ã€‚</p>
<p>å½“çœ‹è¿™æ®µä»£ç çœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œåé¢ä¸»è¦æ˜¯å¯¹è¿™äº›ä»£ç çš„å±•å¼€ï¼Œä½†å¤§å®¶è¦è®°ä½çš„æ˜¯ <code>Options</code> ç»“æ„ä½“æ˜¯æˆ‘ä»¬èµ‹å€¼çš„ï¼Œæ¯ä¸ªå­—æ®µå¸Œæœ›å¤§å®¶èƒ½è®°ä½ï¼Œåç»­ç”¨åˆ°çš„æ—¶å€™å¤§å®¶ä¹Ÿå¯ä»¥å›è¿‡å¤´æ¥çœ‹ä¸€ä¸‹ä»£è¡¨ä»€ä¹ˆæ„æ€ï¼Œè¿˜æœ‰æˆ‘è‡ªå·±å®šä¹‰çš„è¿™äº›å¸¸é‡å’Œå˜é‡ï¼Œåç»­ä¼šç”¨åˆ°</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> trace

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"go.opentelemetry.io/otel"</span>
	<span class="hljs-string">"go.opentelemetry.io/otel/exporters/jaeger"</span>
	<span class="hljs-string">"go.opentelemetry.io/otel/exporters/zipkin"</span>
	<span class="hljs-string">"go.opentelemetry.io/otel/propagation"</span>
	<span class="hljs-string">"go.opentelemetry.io/otel/sdk/resource"</span>
	<span class="hljs-string">"go.opentelemetry.io/otel/sdk/trace"</span>
	semconv <span class="hljs-string">"go.opentelemetry.io/otel/semconv/v1.38.0"</span>

	<span class="hljs-string">"log"</span>
)

<span class="hljs-keyword">type</span> Options <span class="hljs-keyword">struct</span> {
    Name     <span class="hljs-type">string</span>  <span class="hljs-string">`json:"name"`</span>      <span class="hljs-comment">// æœåŠ¡åç§°ï¼Œä¼šæ˜¾ç¤ºåœ¨ Jaeger/Zipkin UI ä¸­</span>
    Endpoint <span class="hljs-type">string</span>  <span class="hljs-string">`json:"endpoint"`</span>  <span class="hljs-comment">// æ”¶é›†å™¨åœ°å€ å¦‚æœæ˜¯ jaeger æˆ‘ä»¬å¡«çš„å°±æ˜¯http://jaeger:14268/api/traces</span>
    Sampler  <span class="hljs-type">float64</span> <span class="hljs-string">`json:"sampler"`</span>   <span class="hljs-comment">// é‡‡æ ·ç‡ï¼Œ0.0~1.0</span>
    Batcher  <span class="hljs-type">string</span>  <span class="hljs-string">`json:"batcher"`</span>   <span class="hljs-comment">// åç«¯ç±»å‹: "jaeger" æˆ– "zipkin" è¿™ä¸ªå­—æ®µå†³å®š Endpointå­—æ®µå¡«ä»€ä¹ˆ</span>
}

<span class="hljs-comment">// æ¯”å¦‚æˆ‘ä»¬çš„ç³»ç»Ÿç°åœ¨åªæ”¯æŒè¿™ä¸¤ä¸ª ä½ ä¼ æ¥çš„ Batcher è¿™ä¸ªå­—æ®µå¿…é¡»åœ¨è¿™é‡Œé¢</span>
<span class="hljs-keyword">const</span> (  
	kindJaeger = <span class="hljs-string">"jaeger"</span>
	kindZipkin = <span class="hljs-string">"zipkin"</span>
)

<span class="hljs-comment">// åˆå§‹åŒ–å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">InitTracerProvider</span><span class="hljs-params">(o Options)</span></span> (*trace.TracerProvider,<span class="hljs-type">error</span>) {
	<span class="hljs-keyword">var</span> sexp trace.SpanExporter
	<span class="hljs-keyword">var</span> err <span class="hljs-type">error</span>
	
    <span class="hljs-comment">// ç»å…¸ æ„é€ é€‰é¡¹</span>
	opts := []trace.TracerProviderOption{
        <span class="hljs-comment">// ä¸‹é¢å…ˆä»è¿™ä¸ªå‡½æ•°ä»‹ç» ä»å†…åˆ°å¤–</span>
        trace.WithResource(resource.NewSchemaless(semconv.ServiceNameKey.String(o.Name))),
		trace.WithSampler(trace.ParentBased(trace.TraceIDRatioBased(o.Sampler))),

	}

	<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(o.Endpoint) &gt; <span class="hljs-number">0</span> {
		<span class="hljs-keyword">switch</span> o.Batcher {
		<span class="hljs-keyword">case</span> kindJaeger:
			sexp, err = jaeger.New(jaeger.WithCollectorEndpoint(jaeger.WithEndpoint(o.Endpoint)))
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
			}
		<span class="hljs-keyword">case</span> kindZipkin:
			sexp, err = zipkin.New(o.Endpoint)
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
			}
		}
		opts = <span class="hljs-built_in">append</span>(opts, trace.WithBatcher(sexp))
	}

	tp := trace.NewTracerProvider(opts...)
	otel.SetTracerProvider(tp)
	otel.SetTextMapPropagator(propagation.NewCompositeTextMapPropagator(propagation.TraceContext{}, propagation.Baggage{}))
	otel.SetErrorHandler(otel.ErrorHandlerFunc(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(err <span class="hljs-type">error</span>)</span></span> {
		log.Printf(<span class="hljs-string">"[otel] error: %v"</span>, err)
	}))
	<span class="hljs-keyword">return</span> tp, <span class="hljs-literal">nil</span>
}
</code></pre>
<h3 data-id="heading-2"><code>semconv.ServiceNameKey.String(o.Name))</code> å‡½æ•°è®²è§£</h3>
<p>è¿™ä¸ªå‡½æ•°æœ¬è´¨ä¸Šå°±æ˜¯æŠŠå…¨å±€çš„ <code>service.name</code> èµ‹å€¼ä¸Šï¼Œè¿”å›çš„ç»“æ„ä½“ <code>KeyValue</code>  æ­£æ˜¯ <code>NewSchemaless()</code> å‡½æ•°éœ€è¦çš„</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">const</span> ServiceNameKey = attribute.Key(<span class="hljs-string">"service.name"</span>)

<span class="hljs-comment">// å† attribute è¿™ä¸ªåŒ…ä¸‹å®šä¹‰çš„ key</span>
<span class="hljs-keyword">type</span> Key <span class="hljs-type">string</span>

<span class="hljs-comment">// æœ‰ä¸€ç³»åˆ—æ–¹æ³•  æœ‰int string bool ç­‰ç­‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(k Key)</span></span> String(v <span class="hljs-type">string</span>) KeyValue {
	<span class="hljs-keyword">return</span> KeyValue{
		Key:   k,
		Value: StringValue(v),
	}
}
<span class="hljs-comment">// è¿”å›çš„ç»“æ„ä½“</span>
<span class="hljs-keyword">type</span> KeyValue <span class="hljs-keyword">struct</span> {
	Key   Key   
	Value Value
}

<span class="hljs-comment">// å…¶ä¸­çš„å­—æ®µ</span>
<span class="hljs-keyword">type</span> Value <span class="hljs-keyword">struct</span> {
	vtype    Type
	numeric  <span class="hljs-type">uint64</span>
	stringly <span class="hljs-type">string</span>
	slice    any
}
</code></pre>
<h3 data-id="heading-3"><code>NewSchemaless()</code> å‡½æ•°</h3>
<p>åœ¨ UI é¦–é¡µï¼Œé€‰æ‹©å¯¹åº”çš„æœåŠ¡ï¼Œé€‰ä¸­åï¼Œæ‰¾åˆ°å…·ä½“çš„è¿½è¸ªé“¾è·¯ï¼Œè¿™é‡Œä¸»è¦è®¾ç½®è¿™æ¡é“¾è·¯å±äºå“ªä¸ªæœåŠ¡åçš„</p>
<p>å°±ç±»ä¼¼ä½ å…ˆé€‰æ‹©å“ªä¸ªæ•°æ®åº“ç³»ç»Ÿç±»å‹ï¼ˆ<code>mySQL</code>ã€<code>NoSQL</code>ï¼‰å†å»å»ºè¡¨</p>
<p>é€‰æ‹©å“ªä¸ªæ•°æ®åº“ç³»ç»Ÿç±»å‹ å°±æ˜¯æˆ‘ä»¬è¿™é‡Œè®¾ç½®çš„æœåŠ¡åï¼Œå»ºè¡¨å°±æ˜¯è®¾ç½® <code>TracerID</code> å’Œ <code>SpanID</code></p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewSchemaless</span><span class="hljs-params">(attrs ...attribute.KeyValue)</span></span> *Resource {
	<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(attrs) == <span class="hljs-number">0</span> {
		<span class="hljs-keyword">return</span> &amp;Resource{}
	}

	<span class="hljs-comment">/*  
	NewSetWithFiltered å»é‡ã€éªŒè¯åˆæ³•æ€§å¹¶ä¸”é‡æ’ æŒ‰ç…§å­—ç¬¦ä¸² a - z é‡æ’ é‡å¤åªè¦æœ€åä¸€ä¸ª å£°æ˜è¿™é‡Œçš„
	ç¤ºä¾‹ï¼ša=1, ""=2, b=INVALID, a=3, c=4, a=6  è¿™é‡Œç®€å•å†™äº†å…¶å® a å°±æ˜¯ KeyValue ç»“æ„ä½“çš„ key 1 å°±æ˜¯ç»“æ„ä½“çš„ value åšæ¯”å–»ï¼Œ å…ˆæ’åº [ ""=2, a=1, a=3, b=INVALID, c=4 ] å†å»é‡ï¼ˆlast-value-winsï¼‰[ ""=2, a=3, b=INVALID, c=4 ] æœ€åè¿‡æ»¤ï¼ˆkv.Validï¼‰ [ a=3, c=4 ] é‡ç‚¹æ˜¯ è¿”å›ç±»å‹ï¼šSet ä¸€ä¸ªç»“æ„ä½“  å¦‚æœä¸å°è£…æˆ Setï¼Œè€Œæ˜¯ç›´æ¥è¿”å› []KeyValue åˆ‡ç‰‡ï¼Œä¼šå­˜åœ¨ä¸€ä¸ªè‡´å‘½é—®é¢˜ï¼šåˆ‡ç‰‡æ˜¯å¼•ç”¨ç±»å‹ï¼Œå¤–éƒ¨æ‹¿åˆ°åå¯ä»¥éšæ„ä¿®æ”¹ï¼ˆè¿½åŠ ã€åˆ é™¤ã€ä¿®æ”¹å…ƒç´ ï¼‰ï¼Œå¾ˆå®¹æ˜“ç ´åå”¯ä¸€ã€åˆæ³•çš„çº¦æŸã€‚
	*/</span>
	s, _ := attribute.NewSetWithFiltered(attrs, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(kv attribute.KeyValue)</span></span> <span class="hljs-type">bool</span> {
		<span class="hljs-keyword">return</span> kv.Valid()   <span class="hljs-comment">// è¿‡æ»¤é€»è¾‘æ”¾åœ¨ä¸‹ä¸ªå‡½æ•°</span>
	})


	<span class="hljs-keyword">if</span> s.Len() == <span class="hljs-number">0</span> {
		<span class="hljs-keyword">return</span> &amp;Resource{}
	}

	<span class="hljs-keyword">return</span> &amp;Resource{attrs: s} 
}

<span class="hljs-comment">// è¿‡æ»¤é€»è¾‘æˆ‘å¤åˆ¶è¿‡æ¥äº†  </span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(kv KeyValue)</span></span> Valid() <span class="hljs-type">bool</span> {
	<span class="hljs-keyword">return</span> kv.Key.Defined() &amp;&amp; kv.Value.Type() != INVALID
}
</code></pre>
<h3 data-id="heading-4"><code>OpenTelemetry</code> å‡½æ•°å¼é€‰é¡¹æ¨¡å¼</h3>
<p>è¿™ç§é€‰é¡¹æ¨¡å¼æ˜¯ä¸å¯å˜é…ç½®å‹ï¼Œæˆ‘ä¹‹å‰çš„æ–‡ç« è¯¦ç»†ä»‹ç»è¿‡è¿™ç§é€‰é¡¹æ¨¡å¼ï¼Œå¤§å®¶æœ‰æ—¶é—´å¯ä»¥äº†è§£ä¸€ä¸‹ï¼Œä¸»è¦ä½“ç°å‡º Go çš„ç¼–ç¨‹æ€æƒ³</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// é¢å‘æ¥å£ç¼–ç¨‹</span>
<span class="hljs-keyword">type</span> TracerProviderOption <span class="hljs-keyword">interface</span> {  <span class="hljs-comment">//æ¥å£</span>
	apply(tracerProviderConfig) tracerProviderConfig
}
<span class="hljs-comment">// å®ç°äº†ä¸Šé¢æ¥å£</span>
<span class="hljs-keyword">type</span> traceProviderOptionFunc <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(tracerProviderConfig)</span></span> tracerProviderConfig

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(fn traceProviderOptionFunc)</span></span> apply(cfg tracerProviderConfig) tracerProviderConfig {
	<span class="hljs-keyword">return</span> fn(cfg)  <span class="hljs-comment">// è°ƒç”¨å‡½æ•°ç±»å‹æœ¬èº« å› ä¸ºè‡ªå·±å°±æ˜¯ä¸€ä¸ªå‡½æ•°</span>
}

</code></pre>
<h3 data-id="heading-5"><code>WithResource()</code> å‡½æ•°</h3>
<p>è¿™å°±æ˜¯ <code>OpenTelemetry</code>  å°è£…ä¸€ç³»åˆ—<code>WithXXX</code>å‘½åçš„å·¥å‚å‡½æ•°ï¼Œä½¿ç”¨å·¥å‚å‡½æ•°è¾¾åˆ°èµ‹å€¼çš„ç›®çš„</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">WithResource</span><span class="hljs-params">(r *resource.Resource)</span></span> TracerProviderOption {
    <span class="hljs-comment">// å¯ä»¥ç†è§£æˆåŒç­¾åå‡½æ•°ç±»å‹çš„å®‰å…¨è½¬æ¢  è½¬æ¢çš„åŒæ–¹æ˜¯ â€œåŒæ„â€ çš„ï¼Œæ²¡æœ‰æ•°æ®ä¸¢å¤± </span>
	<span class="hljs-keyword">return</span> traceProviderOptionFunc(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(cfg tracerProviderConfig)</span></span> tracerProviderConfig {
        <span class="hljs-comment">// apply æ–¹æ³•</span>
		<span class="hljs-keyword">var</span> err <span class="hljs-type">error</span>
        <span class="hljs-comment">// æ‹¿å‡º ç¯å¢ƒå˜é‡é‡Œé¢çš„ Resource ä¸»è¦é’ˆå¯¹åœ¨ Kubernetes ä¸­è¿è¡ŒæœåŠ¡ Merge å°±æ˜¯å†²çªçš„ç”¨rä¸­çš„ï¼Œä¸å†²çªå°±ç›¸è</span>
        <span class="hljs-comment">// åœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­ï¼Œåªä¼ å…¥äº†ä¸€ä¸ªå¹¶ä¸”æ²¡æœ‰ç¯å¢ƒå˜é‡ è¿™ä¸ªå‡½æ•°ç›¸å½“äºä¸æ‰§è¡Œè¿˜æ˜¯åŸæ¥çš„ r *resource.Resource</span>
		cfg.resource, err = resource.Merge(resource.Environment(), r)
		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
            <span class="hljs-comment">// é”™è¯¯</span>
			otel.Handle(err)
		}
		<span class="hljs-keyword">return</span> cfg
	})
}

</code></pre>
<h3 data-id="heading-6">æ ¸å¿ƒé€»è¾‘å›¾è§£</h3>
<pre><code class="hljs language-css" lang="css">     Resource <span class="hljs-selector-tag">A</span> (æ¥è‡ªç¯å¢ƒå˜é‡)          Resource <span class="hljs-selector-tag">B</span> (ä»£ç ä¸­ä¼ å…¥)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ service<span class="hljs-selector-class">.namespace</span>=shop  â”‚      â”‚ service<span class="hljs-selector-class">.name</span>=<span class="hljs-attribute">order</span>-svc  â”‚
    â”‚ deployment<span class="hljs-selector-class">.env</span>=prod     â”‚      â”‚ 						   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                          Merge(<span class="hljs-selector-tag">A</span>, <span class="hljs-selector-tag">B</span>)
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ service<span class="hljs-selector-class">.name</span>=<span class="hljs-attribute">order</span>-svc  â”‚  â†  <span class="hljs-selector-tag">B</span> è¦†ç›–äº† <span class="hljs-selector-tag">A</span>
                    â”‚                         â”‚
                    â”‚ deployment<span class="hljs-selector-class">.env</span>=prod     â”‚  â† æ¥è‡ª <span class="hljs-selector-tag">A</span>ï¼ˆ<span class="hljs-selector-tag">B</span> æ²¡æœ‰è¿™ä¸ª keyï¼‰
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-7"><code>trace.TraceIDRatioBased(o.Sampler)</code> å‡½æ•°</h3>
<p><code>Sampler</code> æ˜¯ä¸€ä¸ªæ¥å£ï¼Œä¾¿äºæ‰©å±•æ€§ï¼Œå¦‚æœä¸æƒ³ç”¨åŸºäºé‡‡æ ·ç‡ï¼Œæˆ–è€…åç»­æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œé‚£åªè¦å®ç°è¿™ä¸ªæ¥å£å°±ä¸éœ€è¦æ›´æ”¹ä»£ç ï¼Œå†ä¸€æ¬¡ä½“ç°äº†goè¯­è¨€é¢å‘æ¥å£ç¼–ç¨‹</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TraceIDRatioBased</span><span class="hljs-params">(fraction <span class="hljs-type">float64</span>)</span></span> Sampler {
	<span class="hljs-keyword">if</span> fraction &gt;= <span class="hljs-number">1</span> {
		<span class="hljs-keyword">return</span> AlwaysSample()  <span class="hljs-comment">//é‡‡æ ·ç‡ 100%  åç»­ä¸éœ€è¦åˆ¤æ–­æ˜¯å¦é‡‡æ ·</span>
	}

	<span class="hljs-keyword">if</span> fraction &lt;= <span class="hljs-number">0</span> {
        <span class="hljs-comment">/*
        é‡‡æ ·å™¨ä¼šç»§æ‰¿çˆ¶ Span çš„é‡‡æ ·å†³å®šï¼Œå¦‚æœçˆ¶ Span è¢«é‡‡æ ·äº†ï¼Œå³ä½¿å­ Span çš„é‡‡æ ·æ¯”ä¾‹æ˜¯ 0%ï¼Œ
        å­ Span ä¹Ÿä¼šè¢«é‡‡æ ·ï¼Œé¿å…é“¾è·¯æ–­è£‚
        */</span>
		fraction = <span class="hljs-number">0</span>
	}
    
	<span class="hljs-comment">// è¿”å›ç”¨é‡‡æ ·çš„ç»“æ„ä½“ åé¢æœ‰ä¾‹å­æ¥æè¿°å¦‚ä½•é‡‡æ ·</span>
	<span class="hljs-keyword">return</span> &amp;traceIDRatioSampler{
        <span class="hljs-comment">// ç”±äºé‚£å8ä¸ªå­—èŠ‚å¯¹æ¯” æœ€å¤§å€¼ä¸º 2çš„64æ¬¡æ–¹ - 1 è¿™é‡Œé˜²æ­¢æº¢å‡º èŒƒå›´è°ƒæ•´ å·¦ç§»63ä½ ä¹Ÿå°±æ˜¯ä¹˜2çš„63æ¬¡æ–¹ </span>
        <span class="hljs-comment">// ä¾‹å¦‚0.1 * 2çš„63æ¬¡æ–¹</span>
		traceIDUpperBound: <span class="hljs-type">uint64</span>(fraction * (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">63</span>)),  
		description:       fmt.Sprintf(<span class="hljs-string">"TraceIDRatioBased{%g}"</span>, fraction), <span class="hljs-comment">// æè¿°</span>
	}
}


<span class="hljs-comment">// ä¸Šé¢ç”¨çš„ç»“æ„ä½“</span>
<span class="hljs-keyword">type</span> traceIDRatioSampler <span class="hljs-keyword">struct</span> {
    traceIDUpperBound <span class="hljs-type">uint64</span>   <span class="hljs-comment">// é‡‡æ ·é˜ˆå€¼</span>
    description       <span class="hljs-type">string</span>   <span class="hljs-comment">// æè¿°ä¿¡æ¯</span>
}

<span class="hljs-comment">// é‡ç‚¹æ–¹æ³• ç”¨äºåˆ¤æ–­æ˜¯å¦é‡‡æ ·</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(ts traceIDRatioSampler)</span></span> ShouldSample(p SamplingParameters) SamplingResult {
	psc := trace.SpanContextFromContext(p.ParentContext)
     <span class="hljs-comment">// å­˜å‚¨æ–¹å¼æ˜¯å¤§ç«¯ æ˜¯é«˜ä½åœ¨å‰ æˆ‘ä»¬è¦å–ä½8ä½ å› ä¸º TraceID ç”Ÿæˆçš„æ—¶å€™å8ä½æ˜¯çº¯éšæœºæ•° æ›´é€‚åˆéšæœºé‡‡æ ·</span>
     <span class="hljs-comment">// å·¦ç§»ä¸€ä½æ˜¯å¯¹é½ (1 &lt;&lt; 63) è¿™æ ·æ‰èƒ½è¿›è¡Œæ¯”è¾ƒ</span>
	x := binary.BigEndian.Uint64(p.TraceID[<span class="hljs-number">8</span>:<span class="hljs-number">16</span>]) &gt;&gt; <span class="hljs-number">1</span> 
    <span class="hljs-comment">// æ¯”è¾ƒé€»è¾‘ </span>
	<span class="hljs-keyword">if</span> x &lt; ts.traceIDUpperBound { 
		<span class="hljs-keyword">return</span> SamplingResult{
			Decision:   RecordAndSample,
			Tracestate: psc.TraceState(),
		}
	}
	<span class="hljs-keyword">return</span> SamplingResult{
		Decision:   Drop,
		Tracestate: psc.TraceState(),
	}
}
</code></pre>
<h3 data-id="heading-8">æ¯”è¾ƒå†³ç­–çš„ä¾‹å­</h3>
<pre><code class="hljs language-ini" lang="ini">å‡è®¾ <span class="hljs-attr">fraction</span> = <span class="hljs-number">0.1</span> (<span class="hljs-number">10</span>% é‡‡æ ·)

<span class="hljs-attr">traceIDUpperBound</span> = <span class="hljs-number">0.1</span> Ã— <span class="hljs-number">2</span>^<span class="hljs-number">63</span> = <span class="hljs-number">922</span>,<span class="hljs-number">337</span>,<span class="hljs-number">203</span>,<span class="hljs-number">685</span>,<span class="hljs-number">477</span>,<span class="hljs-number">580</span>

x çš„å–å€¼èŒƒå›´ (å³ç§»å): 0 ~ 2^<span class="hljs-attr">63-1</span> = <span class="hljs-number">0</span> ~ <span class="hljs-number">9</span>,<span class="hljs-number">223</span>,<span class="hljs-number">372</span>,<span class="hljs-number">036</span>,<span class="hljs-number">854</span>,<span class="hljs-number">775</span>,<span class="hljs-number">807</span>

æ•°è½´è¡¨ç¤º:
0                                                    2^63-1
|&lt;------ 10% é‡‡æ ·åŒºé—´ ------&gt;|&lt;----- 90% ä¸¢å¼ƒåŒºé—´ -------&gt;|
0            922,337,203,685,477,580        9,223,372,036,854,775,807

è¿™æ˜¯åä¸€ä¸ªè¯·æ±‚è¿‡æ¥ç”Ÿæˆä¸€ä¸ª TraceID
<span class="hljs-attr">TraceID</span> = <span class="hljs-number">0</span>xaabbccdd11223344_fedcba9876543210

å–å‡ºä½å…«ä½å¹¶è½¬æˆuintç”¨äºæ¯”è¾ƒ
<span class="hljs-attr">uint64_val</span> = <span class="hljs-number">0</span>xFEDCBA9876543210 = <span class="hljs-number">18</span>,<span class="hljs-number">364</span>,<span class="hljs-number">758</span>,<span class="hljs-number">544</span>,<span class="hljs-number">493</span>,<span class="hljs-number">543</span>,<span class="hljs-number">952</span>

å³ç§» 1 ä½ å¯¹é½é€»è¾‘
<span class="hljs-attr">x</span> = <span class="hljs-number">18</span>,<span class="hljs-number">364</span>,<span class="hljs-number">758</span>,<span class="hljs-number">544</span>,<span class="hljs-number">493</span>,<span class="hljs-number">543</span>,<span class="hljs-number">952</span> &gt;&gt; <span class="hljs-number">1</span> = <span class="hljs-number">9</span>,<span class="hljs-number">182</span>,<span class="hljs-number">379</span>,<span class="hljs-number">272</span>,<span class="hljs-number">246</span>,<span class="hljs-number">771</span>,<span class="hljs-number">976</span>

æ¯”è¾ƒ
<span class="hljs-attr">x</span> = <span class="hljs-number">9</span>,<span class="hljs-number">182</span>,<span class="hljs-number">379</span>,<span class="hljs-number">272</span>,<span class="hljs-number">246</span>,<span class="hljs-number">771</span>,<span class="hljs-number">976</span>  ï¼ˆ<span class="hljs-number">19</span>ä½ï¼‰
<span class="hljs-attr">traceIDUpperBound</span> = <span class="hljs-number">922</span>,<span class="hljs-number">337</span>,<span class="hljs-number">203</span>,<span class="hljs-number">685</span>,<span class="hljs-number">477</span>,<span class="hljs-number">580</span>   ï¼ˆ<span class="hljs-number">18</span>ä½ï¼‰

æ­£å¥½å·®äº†10å€ æƒ³è¦çœŸæ­£å–æ ·çš„è¯ï¼Œè¦æ¯” traceIDUpperBound è¿™ä¸ªå° æ¯”ä»–å°çš„ä»æ¦‚ç‡ä¸Šå°±æ˜¯10%  
9,182,379,272,246,771,976 &lt; 922,337,203,685,477,580     âœ— ä¸æˆç«‹ï¼
ç»“æœ: Drop (ä¸¢å¼ƒ)
</code></pre>
<h3 data-id="heading-9"><code>trace.WithSampler(trace.ParentBased()</code> ä¸¤ä¸ªå‡½æ•°</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åŒç† æ„é€ å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">WithSampler</span><span class="hljs-params">(s Sampler)</span></span> TracerProviderOption {
	<span class="hljs-keyword">return</span> traceProviderOptionFunc(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(cfg tracerProviderConfig)</span></span> tracerProviderConfig {
		<span class="hljs-keyword">if</span> s != <span class="hljs-literal">nil</span> {
			cfg.sampler = s
		}
		<span class="hljs-keyword">return</span> cfg
	})
}
<span class="hljs-comment">// è¿”å›ä¸€ä¸ª æ ¹ Span</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ParentBased</span><span class="hljs-params">(root Sampler, samplers ...ParentBasedSamplerOption)</span></span> Sampler {
    <span class="hljs-keyword">return</span> parentBased{
        root:   root,    <span class="hljs-comment">// æŠŠåˆšå¾—åˆ°çš„ç»“æ„ä½“ traceIDRatioSampler æ”¾ä¸Šå»                         </span>
        config: configureSamplersForParentBased(samplers), 
    }
}


<span class="hljs-comment">// è¿™é‡Œäº†è§£ä¸€ä¸‹å°±å¥½</span>
<span class="hljs-keyword">type</span> parentBased <span class="hljs-keyword">struct</span> {
    root   Sampler
    config samplerConfig
}

<span class="hljs-keyword">type</span> samplerConfig <span class="hljs-keyword">struct</span> {
    remoteParentSampled    Sampler  <span class="hljs-comment">// è¿œç¨‹çˆ¶ Span å·²é‡‡æ ·æ—¶ç”¨</span>
    remoteParentNotSampled Sampler  <span class="hljs-comment">// è¿œç¨‹çˆ¶ Span æœªé‡‡æ ·æ—¶ç”¨</span>
    localParentSampled     Sampler  <span class="hljs-comment">// æœ¬åœ°çˆ¶ Span å·²é‡‡æ ·æ—¶ç”¨</span>
    localParentNotSampled  Sampler  <span class="hljs-comment">// æœ¬åœ°çˆ¶ Span æœªé‡‡æ ·æ—¶ç”¨</span>
}
</code></pre>
<h3 data-id="heading-10">åˆ›å»º Exporter</h3>
<p>å½“æ‰§è¡Œç¬¬ä¸€ä¸ªï¼šåˆ›å»ºä¸€ä¸ª <code>Jaeger Exporter</code> ï¼Œè´Ÿè´£æŠŠä½ æœåŠ¡äº§ç”Ÿçš„é“¾è·¯è¿½è¸ªæ•°æ®ï¼ˆSpanï¼‰æ‰“åŒ…æˆ <code>Jaeger</code> èƒ½çœ‹æ‡‚çš„æ ¼å¼ï¼ˆThrift äºŒè¿›åˆ¶ï¼‰ï¼Œç„¶åé€šè¿‡ HTTP å‘é€åˆ° Jaeger æœåŠ¡å™¨çš„åœ°å€ï¼ˆæ¯”å¦‚ <a href="https://link.juejin.cn?target=http%3A%2F%2Fjaeger%3A14268%2Fapi%2Ftraces%25EF%25BC%2589%25E3%2580%2582%25E4%25B9%259F%25E5%25B0%25B1%25E6%2598%25AF%25E6%2596%25B0%25E5%25BB%25BA%25E4%25B8%2580%25E4%25B8%25AA%25E5%25AE%259E%25E4%25BE%258B" target="_blank" title="http://jaeger:14268/api/traces%EF%BC%89%E3%80%82%E4%B9%9F%E5%B0%B1%E6%98%AF%E6%96%B0%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%AE%9E%E4%BE%8B" ref="nofollow noopener noreferrer">http://jaeger:14268/api/tracesï¼‰ã€‚ä¹Ÿå°±æ˜¯æ–°å»ºä¸€ä¸ªå®ä¾‹</a></p>
<p>å½“æ‰§è¡Œç¬¬äºŒä¸ªï¼šåˆ›å»ºä¸€ä¸ª <code>Zipkin Exporter</code> ï¼Œè´Ÿè´£æŠŠä½ æœåŠ¡äº§ç”Ÿçš„é“¾è·¯è¿½è¸ªæ•°æ®ï¼ˆSpanï¼‰æ‰“åŒ…æˆ JSON æ ¼å¼ï¼Œç„¶åé€šè¿‡ HTTP å‘é€åˆ° <code>Zipkin</code> æœåŠ¡å™¨çš„åœ°å€ï¼ˆæ¯”å¦‚ <a href="https://link.juejin.cn?target=http%3A%2F%2Fzipkin%3A9411%2Fapi%2Fv2%2Fspans%25EF%25BC%2589%25E3%2580%2582%25E4%25B9%259F%25E6%2598%25AF%25E6%2596%25B0%25E5%25BB%25BA%25E5%25AE%259E%25E4%25BE%258B" target="_blank" title="http://zipkin:9411/api/v2/spans%EF%BC%89%E3%80%82%E4%B9%9F%E6%98%AF%E6%96%B0%E5%BB%BA%E5%AE%9E%E4%BE%8B" ref="nofollow noopener noreferrer">http://zipkin:9411/api/v2/spansï¼‰ã€‚ä¹Ÿæ˜¯æ–°å»ºå®ä¾‹</a></p>
<p>ä¸¤è€…åŠŸèƒ½ä¸€æ ·ï¼Œåªæ˜¯å‘é€çš„ç›®æ ‡å’Œæ•°æ®æ ¼å¼ä¸åŒ</p>
<p><strong>è¿™é‡Œå¤§å®¶ä¸ç”¨æ·±ç©¶è¿™ä¸¤ä¸ªçš„å†…éƒ¨å®ç°ï¼Œåªéœ€è¦çŸ¥é“æ˜¯åšä»€ä¹ˆå°±å¥½</strong></p>
<pre><code class="hljs language-go" lang="go">	<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(o.Endpoint) &gt; <span class="hljs-number">0</span> {
		<span class="hljs-keyword">switch</span> o.Batcher {
		<span class="hljs-keyword">case</span> kindJaeger:  <span class="hljs-comment">// è‡ªå·±å®šä¹‰çš„å¸¸é‡</span>
            <span class="hljs-comment">// è¿™é‡Œçš„ With...(With...) å°±æ˜¯æ ‡å‡†çš„é€‰é¡¹æ„é€ å‡½æ•°  åªä¸è¿‡è¿™ä¸ªæ˜¯é…ç½®é‡Œé¢å¢åŠ é…ç½®è€Œå·²</span>
			sexp, err = jaeger.New(jaeger.WithCollectorEndpoint(jaeger.WithEndpoint(o.Endpoint)))
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				<span class="hljs-keyword">return</span> err
			}
		<span class="hljs-keyword">case</span> kindZipkin:
			sexp, err = zipkin.New(o.Endpoint)
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				<span class="hljs-keyword">return</span> err
			}
		}
        <span class="hljs-comment">/*
        é‡ç‚¹ trace.WithBatcher(sexp) è¿™ä¸ªå‡½æ•°å†…éƒ¨åšä¸¤ä»¶äº‹
        ç¬¬ä¸€ä»¶ï¼šå°† sexp åŒ…è£…æˆä¸€ä¸ª BatchSpanProcessor è¿™ä¸ªçš„ä½œç”¨å°±æ˜¯æŠŠäº§ç”Ÿçš„ Span å…ˆç¼“å­˜èµ·æ¥ï¼Œè¾¾åˆ°ä¸€å®šæ•°é‡æˆ–æ—¶é—´åå†æ‰¹é‡å‘		 é€ï¼Œè€Œä¸æ˜¯æ¯äº§ç”Ÿä¸€æ¡å°±ç«‹å³å‘é€ï¼Œä»è€Œå‡å°‘ç½‘ç»œå¼€é”€ã€æå‡æ€§èƒ½ã€‚
        ç¬¬äºŒä»¶ï¼šé€šè¿‡ WithSpanProcessor() å‡½æ•°è¿›è¡Œæ³¨å†Œï¼Œå¦‚æœåˆšå¼€å§‹ä½¿ç”¨ å¯ä»¥ç›´æ¥WithSpanProcessor(sexp) ä¼ å…¥
		opentelemetryä½œä¸ºä¸€ä¸ªæ ‡å‡†ä»–å¹¶ä¸æ˜¯çœŸæ­£çš„æ‰§è¡Œè€…ï¼Œå®ƒè§„å®šæ¥å£ï¼Œå½“Span æ•°æ®æ¥ä¸´æ—¶ï¼Œå®ƒä¼šè½¬å‘ç»™æ³¨å†Œçš„ jaeger æˆ–è€… zipkin		 ç­‰ç­‰ï¼Œå¦‚æœä¸å»æ³¨å†Œï¼ŒSpan æ•°æ®æ— å¤„å¯å»ä¼šè¢«ç›´æ¥ä¸¢å¼ƒï¼Œæ³¨å†Œä¹Ÿå¯ä»¥æ³¨å†Œå¾ˆå¤š æ¯”å¦‚ jaeger å’Œ zipkin éƒ½æ³¨å†Œäº†ï¼Œå†…éƒ¨æ˜¯ä¸€ä¸ªåˆ‡ç‰‡
		ç›´æ¥ä½¿ç”¨ WithSpanProcessor(jaeger) åœ¨æ‰§è¡Œä¸€é WithSpanProcessor(zipkin),å†…éƒ¨é€»è¾‘æˆ‘è´´åœ¨è¡¥å…… å¯ä»¥çœ‹ä¸€ä¸‹
		*/</span>
		opts = <span class="hljs-built_in">append</span>(opts, trace.WithBatcher(sexp))
	}


<span class="hljs-comment">// è¡¥å……</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">WithSpanProcessor</span><span class="hljs-params">(sp SpanProcessor)</span></span> TracerProviderOption {
	<span class="hljs-keyword">return</span> traceProviderOptionFunc(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(cfg tracerProviderConfig)</span></span> tracerProviderConfig {
		cfg.processors = <span class="hljs-built_in">append</span>(cfg.processors, sp)
		<span class="hljs-keyword">return</span> cfg
	})
}
</code></pre>
<h3 data-id="heading-11"><code>trace.NewTracerProvider(opts...)</code> å‡½æ•°</h3>
<p>å¤§å®¶å¦‚æœçœ‹è¿‡æˆ‘ä¹‹å‰çš„æ–‡ç« ï¼Œæˆ‘ç›¸ä¿¡å¤§å®¶å¯¹äºè¿™ç§æºç å·²ç»éå¸¸ç†Ÿæ‚‰äº†ï¼Œè¿™æ˜¯goè¯­è¨€ç»å…¸çš„ç¼–ç¨‹æ€æƒ³</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewTracerProvider</span><span class="hljs-params">(opts ...TracerProviderOption)</span></span> *TracerProvider {
    <span class="hljs-comment">// åˆ›å»ºä¸€äº›é»˜è®¤çš„ è¿™é‡Œåªæœ‰ä¸€ä¸ªé»˜è®¤ spanLimits å°±æ˜¯é™åˆ¶ spanå†…å®¹æ¯”å¦‚å±æ€§å€¼æœ€é•¿ 4096 å­—ç¬¦ï¼Œå¤ªå¤§æˆªæ–­</span>
    <span class="hljs-comment">// é˜²æ­¢æŸä¸ª Span å†™å…¥è¿‡å¤šæ•°æ®å¯¼è‡´å†…å­˜çˆ†ç‚¸æˆ–ç½‘ç»œä¼ è¾“è¿‡å¤§ã€‚åšä¸€äº›é™åˆ¶</span>
	o := tracerProviderConfig{
		spanLimits: NewSpanLimits(),
	}
    <span class="hljs-comment">// äº†è§£ä¸€ä¸‹å°±å¯ä»¥ åŒæ ·å…ˆä»ç¯å¢ƒå˜é‡è¯»å– åç»­å†é€šè¿‡ä¼ æ¥çš„è¿›è¡Œè¦†ç›– ä¸»è¦åº”ç”¨åœ¨ K8s ä¸­</span>
	o = applyTracerProviderEnvConfigs(o)

    <span class="hljs-comment">// è¯»å–æˆ‘ä»¬ä¼ æ¥çš„</span>
	<span class="hljs-keyword">for</span> _, opt := <span class="hljs-keyword">range</span> opts {
		o = opt.apply(o)
	}
    <span class="hljs-comment">// æ£€æŸ¥é…ç½®æ˜¯å¦å®Œæ•´ï¼Œæ¯”å¦‚ å¦‚æœæ²¡æœ‰è®¾ç½® sampler å–æ ·ç‡å°±ä½¿ç”¨é»˜è®¤å…¨å–æ ·ï¼Œè¿˜æœ‰ TraceID å’Œ SpanID çš„IDç”Ÿæˆå™¨æ²¡ä¼ å°±ä½¿ç”¨é»˜è®¤</span>
	o = ensureValidTracerProviderConfig(o)
    
	<span class="hljs-comment">// åˆ›å»º TracerProvider å®ä¾‹ </span>
	tp := &amp;TracerProvider{
		namedTracer: <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[instrumentation.Scope]*tracer), <span class="hljs-comment">// ç¼“å­˜å·²åˆ›å»ºçš„ Tracer åç»­å¤§å®¶ä¼šæ˜ç™½</span>
		sampler:     o.sampler,  <span class="hljs-comment">// é‡‡æ ·å™¨ åˆ°æ—¶å€™æ‰§è¡Œ å®ƒå†…éƒ¨ ShouldSample æ–¹æ³•å†³å®šæ˜¯å¦å–æ · ä¸Šé¢å·²ç»è®²è¿‡</span>
		idGenerator: o.idGenerator, <span class="hljs-comment">// IDç”Ÿæˆå™¨</span>
		spanLimits:  o.spanLimits,  <span class="hljs-comment">// ç®€å•ç†è§£ä¸€äº›å±æ€§çš„é™åˆ¶</span>
        <span class="hljs-comment">// æœåŠ¡èµ„æºä¿¡æ¯ï¼ŒåŒ…å« service.nameã€service.namespace ç­‰æ ‡è¯†å½“å‰æœåŠ¡èº«ä»½çš„å…ƒæ•°æ®</span>
        <span class="hljs-comment">// è¿™äº›ä¿¡æ¯ä¼šé™„åŠ åˆ°æ‰€æœ‰ Span ä¸Šï¼Œåœ¨ Jaege ræˆ– Zipkin UI ä¸­ç”¨äºç­›é€‰å’Œåˆ†ç»„</span>
		resource:    o.resource,   
	}
	global.Info(<span class="hljs-string">"TracerProvider created"</span>, <span class="hljs-string">"config"</span>, o)

    <span class="hljs-comment">// ç”±äºå¯ä»¥æœ‰å¤šä¸ª processor ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨å’Œå…³é—­ å¿…é¡»è¦å®šä¹‰ä¸€ç§ç»“æ„ä½“ï¼Œä¸ç„¶ä¸çŸ¥é“å’‹å…³é—­å…¶ä¸­ä¸€ä¸ªä¹Ÿä¸çŸ¥é“æ˜¯å¦å…³é—­</span>
    <span class="hljs-comment">// è¿™ä¸ªå·²ç»æ”¾åœ¨è¡¥å……äº† æœ¬è´¨ä¸Šå°±æ˜¯åˆ‡ç‰‡ é‡Œé¢ç»“æ„ä½“ä¸€ä¸ªæ˜¯ processor ä¸€ä¸ªæ˜¯ æ˜¯å¦å…³é—­</span>
	spss := <span class="hljs-built_in">make</span>(spanProcessorStates, <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(o.processors))
	<span class="hljs-keyword">for</span> _, sp := <span class="hljs-keyword">range</span> o.processors {
		spss = <span class="hljs-built_in">append</span>(spss, newSpanProcessorState(sp))
	}
    
    <span class="hljs-comment">// è¿™é‡ŒTracerProvider å¯èƒ½è¢«å¤šä¸ª goroutine å¹¶å‘ä½¿ç”¨ï¼Œæ‰€ä»¥è¦ç”¨åŸå­æ“ä½œ</span>
	tp.spanProcessors.Store(&amp;spss)

	<span class="hljs-keyword">return</span> tp
}

<span class="hljs-comment">// è¡¥å…… </span>
<span class="hljs-keyword">type</span> spanProcessorStates []*spanProcessorState

<span class="hljs-keyword">type</span> spanProcessorState <span class="hljs-keyword">struct</span> {
	sp    SpanProcessor   <span class="hljs-comment">// å…·ä½“çš„ processor</span>
    <span class="hljs-comment">// åªå…è®¸å†™ä¸€æ¬¡ åç»­åœ¨æ‰§è¡Œå•¥éƒ½ä¸åš ä¸»è¦ç”¨äº Shutdown é˜²æ­¢nä¸ª goroutine éƒ½è°ƒç”¨ Shutdown å¯¼è‡´å¯¼è‡´é‡å¤å…³é—­è¿æ¥ panic</span>
	state sync.Once   
}
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">newSpanProcessorState</span><span class="hljs-params">(sp SpanProcessor)</span></span> *spanProcessorState {
	<span class="hljs-keyword">return</span> &amp;spanProcessorState{sp: sp}  <span class="hljs-comment">//è¿™æ˜¯åˆå§‹åŒ– ä¸èƒ½è®¾ç½® stateï¼Œä¼ å…¥ä»£è¡¨å…³é—­äº†</span>
}

<span class="hljs-comment">// é‡ç‚¹é€»è¾‘ n ä¸ª goroutine æ‰§è¡Œè¿™ä¸ª ç”±äº sync.Once ç‰¹æ€§ åªæ‰§è¡Œä¸€æ¬¡ å·§å¦™çš„ è§£å†³äº†é—®é¢˜</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *spanProcessorState)</span></span> shutdown(ctx context.Context) <span class="hljs-type">error</span> {
    <span class="hljs-keyword">var</span> err <span class="hljs-type">error</span>
    s.state.Do(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå³ä½¿ shutdown è¢«è°ƒç”¨å¤šæ¬¡</span>
        err = s.sp.Shutdown(ctx)
    })
    <span class="hljs-keyword">return</span> err
}

</code></pre>
<h3 data-id="heading-12"><code>otel.SetTracerProvider(tp)</code> æ ¸å¿ƒå‡½æ•°</h3>
<p>è¿™ä¸ªç®€å•æ¥è¯´å°±æ˜¯æœ‰ä¸€ä¸ªå…¨å±€çš„ <code>TracerProvider</code> ï¼ŒæŠŠæˆ‘ä»¬åˆšæ‰åˆ›å»ºçš„æ³¨å†Œåˆ° <code>opentelemetry</code> ä¸Šï¼Œä¸ºä»€ä¹ˆè¦å»æ”¾åˆ°ä¸Šé¢è€Œä¸æ˜¯ç›´æ¥ç”¨æˆ‘ä»¬åˆ›å»ºçš„è¿™ä¸ªå‘¢ï¼Œå¤§å®¶æ€è€ƒä¸€ä¸‹ï¼Œ<code>opentelemetry</code>  ä½œä¸ºä¸€ä¸ªè§„èŒƒï¼Œç¬¬ä¸‰æ–¹åº“è‚¯å®šä¼šæ”¯æŒçš„ï¼Œæ¯”å¦‚ <code>gRPC</code> ä¸­é—´ä»¶ã€ <code>Gorm</code> æ•°æ®åº“é“¾è·¯è·Ÿè¸ªç­‰ç­‰ï¼Œå®ƒä»¬æ€ä¹ˆæ‹¿åˆ°è¿™ä¸ªé“¾è·¯å‘¢ï¼Œè¦ä¸ç„¶é“¾è·¯å°±æ–­äº†ï¼Œæ‰€ä»¥ç»Ÿä¸€æ”¾åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œå®ƒä»¬å†…éƒ¨åªéœ€è¦è°ƒç”¨ <code>otel.Tracer()</code> è¿™ä¸ªå‡½æ•°å°±å¯ä»¥æ‹¿åˆ°å…¨å±€çš„é“¾è·¯ï¼Œè¿™æ ·å°±ä¿è¯é“¾è·¯é¡ºé€šï¼Œå¦‚æœæ„Ÿè§‰ä¸‹é¢è¿™ä¸ªä»£ç æœ‰ç‚¹ç¹çï¼Œåªéœ€è¦è®°ä½æ³¨å†Œä¸Šå»å°±å¥½ï¼Œ</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆ Seté‡Œé¢å¥—Set è€Œä¸æ˜¯ç›´æ¥æ‰§è¡Œé€»è¾‘ï¼Œç¬¬ä¸€å°±æ˜¯è®©ä½¿ç”¨è€…ä¸€ç¬é—´å°±çŸ¥é“åªæ˜¯ä¸€ä¸ªæ³¨å†Œè€Œå·²éšè—å†…éƒ¨ç»†èŠ‚</span>
<span class="hljs-comment">// ç¬¬äºŒå°±æ˜¯é¢„ç•™æ‰©å±•æ€§ï¼Œæ¯”å¦‚åç»­æ¥ä¸ªæ ¡éªŒï¼Œæˆ‘å¯ä»¥ç›´æ¥åœ¨è¿™å±‚å»åšï¼Œè€Œä¸å»æ ¸å¿ƒé€»è¾‘å±‚ä¿®æ”¹</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">SetTracerProvider</span><span class="hljs-params">(tp trace.TracerProvider)</span></span> {
	global.SetTracerProvider(tp)
}

<span class="hljs-comment">/* å…¨å±€å˜é‡ åˆå§‹åŒ–ä¸€ä¸ªé»˜è®¤çš„ å¯ä»¥ç†è§£æˆç©º
é¦–å…ˆç¬¬ä¸€ç‚¹å¿…é¡»æ˜¯çº¿ç¨‹å®‰å…¨çš„ç±»å‹ atomic.Value 
å…¶æ¬¡æ˜¯å†…éƒ¨æ˜¯å­˜æ”¾ä»€ä¹ˆçš„ï¼š æ˜¯ä¸€ä¸ªç»“æ„ä½“ tracerProviderHolder
	tracerProviderHolder struct {
		tp trace.TracerProvider  //é‡Œé¢æ˜¯æ¥å£  åç»­ç”¨äºå­˜æ”¾æˆ‘ä»¬åˆšåˆšæ–°å»ºçš„ TracerProvider
	}
*/</span>
<span class="hljs-keyword">var</span> globalTracer = defaultTracerValue() 

<span class="hljs-comment">// çœŸæ­£çš„å†…éƒ¨</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TracerProvider</span><span class="hljs-params">()</span></span> trace.TracerProvider {
    <span class="hljs-comment">//æ–­è¨€æˆ tracerProviderHolder è¿™ä¸ªç±»å‹æ‰èƒ½æ‹¿åˆ°å†…éƒ¨tp é™æ€è¯­è¨€çš„è§„èŒƒ</span>
	<span class="hljs-keyword">return</span> globalTracer.Load().(tracerProviderHolder).tp  
}


<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">SetTracerProvider</span><span class="hljs-params">(tp trace.TracerProvider)</span></span> {
    <span class="hljs-comment">// å‡½æ•°å¦‚ä¸Š</span>
	current := TracerProvider()
	<span class="hljs-comment">//è¿™é‡Œä¸»è¦æ˜¯é˜²æ­¢ä¸€ä»¶äº‹æƒ… å°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„ tp å°±æ˜¯é»˜è®¤åˆå§‹åŒ–çš„globalTracer ä¹Ÿå°±æ˜¯ current == tp</span>
    <span class="hljs-comment">// è¿™ä¸ªæ—¶å€™è¦æŠ¥é”™çš„ï¼Œå› ä¸ºåç»­ ä¼šè®¾ç½®å§”æ‰˜ è‡ªå·±å§”æ‰˜è‡ªå·±ï¼Œè€Œä¸”å§”æ‰˜åªæœ‰ä¸€æ¬¡ æ‰€ä»¥ä¼šé™·å…¥æ­»å¾ªç¯ æ‰€ä»¥è¿™é‡Œè¦åˆ¤æ–­ä¸€ä¸‹ </span>
	<span class="hljs-keyword">if</span> _, cOk := current.(*tracerProvider); cOk {
		<span class="hljs-keyword">if</span> _, tpOk := tp.(*tracerProvider); tpOk &amp;&amp; current == tp {
			<span class="hljs-comment">// delegate è¿™ä¸ªè‹±æ–‡æ˜¯ å§”æ‰˜ çš„æ„æ€</span>
			Error(
				errors.New(<span class="hljs-string">"no delegate configured in tracer provider"</span>),
				<span class="hljs-string">"Setting tracer provider to its current value. No delegate will be configured"</span>,
			)
			<span class="hljs-keyword">return</span>
		}
	}
	<span class="hljs-comment">/*
    è¿™é‡Œå°±æ˜¯è®¾ç½®å§”æ‰˜äº† ä¸ºä»€ä¹ˆè¦è®¾ç½®å§”æ‰˜ å› ä¸ºæœ‰äº›ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚æœåœ¨æˆ‘è¿˜æ²¡æœ‰ SetTracerProvider çš„æ—¶å€™ å®ƒå°±è°ƒç”¨
    otel.Tracer() è¿™ä¸ªå‡½æ•°  å®ƒæ‹¿åˆ°çš„ TracerProvider æ˜¯é»˜è®¤ç©ºçš„å ä½ç¬¦ï¼Œè¿™ä¸ªæ—¶å€™å¹¶ä¸æŠ¥é”™ï¼Œæ‰§è¡Œ tracer ç©ºé€»è¾‘ï¼Œ
    ç›¸å½“äºæ²¡æœ‰è®°å½•ã€‚ç­‰è¿™è¾¹ SetTracerProvider æ‰§è¡Œä¹‹åï¼Œé‚£è¾¹æ‹¿åˆ°çš„ä¾æ—§æ˜¯ç©ºå ä½ç¬¦ï¼Œè¿™ä¸ªæ—¶å€™å®ƒè¿˜æ˜¯ä¼šæ‰§è¡Œ tracer è¿™ä¸ªæ—¶å€™
    delegate è¿™ä¸ªä»£ç†å·²ç»æœ‰å€¼äº†ï¼Œå°±æ˜¯ä¸‹é¢è¿™ä¸ªè¯­å¥å­˜è¿›å»äº†ï¼Œè¿™ä¸ªæ—¶å€™ä»–å°±ä¼šè½¬å‘ç»™å­˜å…¥çš„è¿™ä¸ªtp
    å°±ç›¸å½“äºç›´æ¥æ‰§è¡Œäº† TracerProvider.tracer è¿™é‡Œ delegateTraceOnce æ˜¯ sync.Once ç±»å‹ åªå†™ä¸€æ¬¡
    ä¹Ÿå¾ˆå¥½ç†è§£ æ‹¿åˆ°é»˜è®¤å ä½ç¬¦çš„é‚£äº›ç¬¬ä¸‰æ–¹åº“ï¼Œç»è¿‡è¿™ä¸ªæ‰§è¡Œåéƒ½å¯ä»¥æ­£å¸¸æ‰§è¡Œï¼Œä»¥åè°ƒç”¨çš„ç¬¬ä¸‰æ–¹åº“ç›´æ¥å°±æ‹¿äº†tp æ ¹æœ¬ä¸ç”¨èµ°å§”æ‰˜
    */</span>
	delegateTraceOnce.Do(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
		<span class="hljs-keyword">if</span> def, ok := current.(*tracerProvider); ok {
			def.setDelegate(tp)
		}
	})
    <span class="hljs-comment">// å­˜å…¥å…¨å±€å˜é‡ è¿™ä¸ªæ—¶å€™ç¬¬ä¸‰æ–¹åº“å’Œè‡ªå·±ç”¨éƒ½å¯ä»¥ç›´æ¥æ‹¿åˆ° å¹¶ä¸éœ€è¦èµ°å§”æ‰˜</span>
	globalTracer.Store(tracerProviderHolder{tp: tp})
}


</code></pre>
<h3 data-id="heading-13"><code>otel.SetTextMapPropagator()  </code> æ ¸å¿ƒå‡½æ•°</h3>
<p>ä¸Šä¸‹æ–‡ä¼ æ’­å™¨ï¼Œè´Ÿè´£åœ¨æœåŠ¡é—´ä¼ é€’è¿½è¸ªä¿¡æ¯ï¼ˆtrace-idã€span-id ç­‰ï¼‰ã€‚å¦‚æœæ²¡æœ‰ <code>Propagator</code>ï¼Œæ¯ä¸ªæœåŠ¡éƒ½ä¼šç”Ÿæˆæ–°çš„ <code> trace-id</code>ï¼Œæ— æ³•å½¢æˆå®Œæ•´çš„è°ƒç”¨é“¾ã€‚ä»£ç é€»è¾‘ä¸ä¸Šé¢å‡ ä¹ä¸€æ¨¡ä¸€æ ·ï¼Œçœ‹å®Œä¸Šé¢å†çœ‹è¿™é‡Œä¼šæ¯”è¾ƒå®¹æ˜“</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åŒ…è£…å±‚ éšè—å†…éƒ¨ç»†èŠ‚</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">SetTextMapPropagator</span><span class="hljs-params">(propagator propagation.TextMapPropagator)</span></span> {
	global.SetTextMapPropagator(propagator)
}

<span class="hljs-comment">/* å…¨å±€å˜é‡ åŒä¸Š åˆå§‹åŒ–ä¸€ä¸ªé»˜è®¤çš„ å¯ä»¥ç†è§£æˆç©º
é¦–å…ˆç¬¬ä¸€ç‚¹å¿…é¡»æ˜¯çº¿ç¨‹å®‰å…¨çš„ç±»å‹ atomic.Value 
å…¶æ¬¡æ˜¯å†…éƒ¨æ˜¯å­˜æ”¾ä»€ä¹ˆçš„ï¼š æ˜¯ä¸€ä¸ªç»“æ„ä½“ propagatorsHolder
		propagatorsHolder struct {
		tm propagation.TextMapPropagator  // è¿™ä¸ªæ”¾ æˆ‘ä»¬æ”¾è¿›å»çš„ åé¢ä¼šè®²
	}
*/</span>
<span class="hljs-keyword">var</span> globalPropagators = defaultPropagatorsValue()


<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TextMapPropagator</span><span class="hljs-params">()</span></span> propagation.TextMapPropagator {
	<span class="hljs-keyword">return</span> globalPropagators.Load().(propagatorsHolder).tm
}

<span class="hljs-comment">// çœŸæ­£çš„å†…éƒ¨</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">SetTextMapPropagator</span><span class="hljs-params">(p propagation.TextMapPropagator)</span></span> {
	current := TextMapPropagator() <span class="hljs-comment">//å»æ‹¿é»˜è®¤çš„</span>

    <span class="hljs-comment">//åŒæ ·éœ€è¦å¯¹æ¯” é¿å…è‡ªå·±å§”æ‰˜è‡ªå·±  </span>
	<span class="hljs-keyword">if</span> _, cOk := current.(*textMapPropagator); cOk {
		<span class="hljs-keyword">if</span> _, pOk := p.(*textMapPropagator); pOk &amp;&amp; current == p {
			Error(
				errors.New(<span class="hljs-string">"no delegate configured in text map propagator"</span>),
				<span class="hljs-string">"Setting text map propagator to its current value. No delegate will be configured"</span>,
			)
			<span class="hljs-keyword">return</span>
		}
	}

	<span class="hljs-comment">/*
    è¿™ä¸ªä¹Ÿæ˜¯æœ‰äº›ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚æœåœ¨æˆ‘è¿˜æ²¡æœ‰ SetTextMapPropagator çš„æ—¶å€™ï¼Œå°±æ³¨å…¥æˆ–è€…æå–ï¼šp.Inject(spanCtx, header)
    p.Extract(savedCtx, c.Request.Header)  è¿™äº›åç»­ä¼šè®²ï¼Œç®€å•ç†è§£ï¼šInject å°±æ˜¯æŠŠç¬¬ä¸€ä¸ªå‚æ•°çš„ Trace ä¿¡æ¯æ³¨å…¥åˆ°ç¬¬äºŒä¸ª
    Extract å°±æ˜¯åå‘ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„å†…å®¹æå–åˆ°ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå…¶å®æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„ context ä»¥ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºåŸºç¡€çš„æ–°ä¸Šä¸‹æ–‡
    æ¯”å¦‚åœ¨ gin å®˜æ–¹æ”¯æŒçš„ä¸­é—´ä»¶ä¸­ï¼Œä½ å…ˆåˆå§‹åŒ–äº†ä¸­é—´ä»¶å†æ³¨å†Œï¼Œå®ƒå†…éƒ¨æ˜¯ç©ºçš„å ä½ç¬¦ï¼Œå½“æ¥ä¿¡æ¯è¯·æ±‚æ—¶ï¼Œä»–ä¼šæ‰§è¡Œ Extract æå–
    è¿™æ—¶å€™å°±ä¼šèµ°åˆ°è¿™ä¸ªä»£ç†ï¼Œç”±äºå·²ç»æ³¨å†Œäº†ï¼Œå¯ä»¥è½¬å‘åˆ°çœŸæ­£çš„ globalPropagators.Extract
    */</span>
	delegateTextMapPropagatorOnce.Do(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
		<span class="hljs-keyword">if</span> def, ok := current.(*textMapPropagator); ok {
			def.SetDelegate(p)
		}
	})
	
    <span class="hljs-comment">// æŠŠæˆ‘ä»¬ä¼ å…¥çš„å­˜åˆ° å…¨å±€å˜é‡ä¸­</span>
	globalPropagators.Store(propagatorsHolder{tm: p})
}

</code></pre>
<h3 data-id="heading-14"><code>propagation.NewCompositeTextMapPropagator()</code>æ ¸å¿ƒå‡½æ•°</h3>
<p><code>propagation.NewCompositeTextMapPropagator(propagation.TraceContext{}, propagation.Baggage{})</code> è¿™ä¸ªå‡½æ•°ä¸»è¦æ˜¯ä¼ æ’­å™¨ç»„åˆå™¨ï¼ŒæŠŠå¤šä¸ªç‹¬ç«‹çš„ <code>TextMapPropagator</code>ï¼ˆæ¥å£ï¼‰ï¼Œç»„åˆæˆä¸€ä¸ªç»Ÿä¸€çš„ã€å¯æ‰¹é‡è°ƒç”¨çš„ä¼ æ’­å™¨ã€‚</p>
<p>æˆ‘ä»¬è¿™è¾¹æ³¨å†Œäº†ä¸¤ä¸ªï¼Œè¯¥ç»„åˆèƒ½å¤Ÿè¦†ç›–ç»å¤§å¤šæ•°åˆ†å¸ƒå¼ç³»ç»Ÿçš„è¿½è¸ªéœ€æ±‚ï¼Œä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„ã€‚</p>
<p>é¦–å…ˆç¬¬ä¸€ä¸ª <code>propagation.TraceContext{}</code>  ä¸»è¦ä¼ é€’ <code>TracerID</code> å’Œ <code>SpanID</code> é˜²æ­¢æ–­é“¾ ï¼ˆæ ¸å¿ƒï¼‰</p>
<p>ç¬¬äºŒä¸ª <code>propagation.Baggage{}</code> ä¸»è¦æ˜¯ä¼ é€’<strong>ç”¨æˆ·è‡ªå®šä¹‰çš„è½»é‡å…ƒæ•°æ®</strong>ï¼ˆç§°ä¸ºè¡Œæï¼‰ï¼Œæ¯”å¦‚è‡ªå·±æƒ³ä¼ ä¸€äº› <code>user-id=123</code> æˆ–è€… <code>order-no=ABC789</code> å­˜æ”¾ä¸€äº›è‡ªå·±æƒ³è¦çš„ä¸šåŠ¡é€»è¾‘ç›¸å…³</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// ç±»ä¼¼æ„é€ å‡½æ•° é¥­åè¿™ä¸ªç»„åˆå™¨   æ¥æ”¶å‚æ•°ä¸ºä¸‹é¢çš„æ¥å£ åªè¦å®ç°å°±å¯ä»¥ä¼ å…¥ è¶³å¤Ÿçš„æ‰©å±•æ€§ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å®ç°ä¸€ä¸ªæ”¾è¿›å»</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewCompositeTextMapPropagator</span><span class="hljs-params">(p ...TextMapPropagator)</span></span> TextMapPropagator {
	<span class="hljs-keyword">return</span> compositeTextMapPropagator(p)
}


<span class="hljs-comment">// å®ç°è¿™ä¸ªæ¥å£å°±å¯ä»¥ propagation.TraceContext{} å’Œ propagation.Baggage{} å®ç°äº†è¿™ä¸ªæ¥å£</span>
<span class="hljs-keyword">type</span> TextMapPropagator <span class="hljs-keyword">interface</span> {
    
	Inject(ctx context.Context, carrier TextMapCarrier)
    
	Extract(ctx context.Context, carrier TextMapCarrier) context.Context
    
	Fields() []<span class="hljs-type">string</span>
}

<span class="hljs-comment">// å®šä¹‰è¿™ä¸ªç»„åˆå™¨ ç»„åˆå™¨é¡¾åæ€ä¹‰å†…éƒ¨æœ‰å¤šä¸ªä¼ æ’­å™¨ æ‰€ä»¥æ˜¯å®ç° TextMapPropagator æ¥å£çš„åˆ‡ç‰‡</span>
<span class="hljs-keyword">type</span> compositeTextMapPropagator []TextMapPropagator

<span class="hljs-comment">// éå†æ‰€æœ‰ç»„åˆè¿›æ¥çš„ä¼ æ’­å™¨ï¼Œä¾æ¬¡è°ƒç”¨å®ƒä»¬çš„ Inject æ–¹æ³• æ¯”è¾ƒç®€å•</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(p compositeTextMapPropagator)</span></span> Inject(ctx context.Context, carrier TextMapCarrier) {
	<span class="hljs-keyword">for</span> _, i := <span class="hljs-keyword">range</span> p {
		i.Inject(ctx, carrier)
	}
}
<span class="hljs-comment">/*
ä¹Ÿæ˜¯éå†ï¼Œä¸åŒçš„æ˜¯æœ‰åµŒå¥—å…³ç³» æ¯”å¦‚ç©º ctx ä¼ è¿›æ¥ æ‰§è¡Œç¬¬ä¸€ä¸ª TraceContext ç”Ÿæˆ ctx1 æ‹¿ç€ ctx1 å†æ‰§è¡Œ Baggage ç”Ÿæˆ ctx2
 ctx2ï¼ˆè¿½åŠ äº† order-noï¼‰â†’ctx1ï¼ˆåŒ…å« SpanContext/TraceIDï¼‰â†’ctx å¤§å®¶å¦‚æœçœ‹è¿‡æˆ‘çš„ Context æ–‡ç« å°±çŸ¥é“ï¼Œå½“å»æ‰¾å­˜å…¥çš„å€¼çš„æ—¶å€™
 å®ƒå†…éƒ¨ä¼šä»è‡ªå·±å¼€å§‹ä¸€ç›´é€’å½’æ‰¾åˆ°æ ¹ï¼Œæ‰€ä»¥åœ¨ç”¨æ³•ä¸Šå¹¶ä¸æ˜¯åµŒå¥—ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä¸€å±‚å±‚å‰¥å¼€  
 åç»­ä¼šè®²ä»–ä»¬å„è‡ªçš„ Extract æ–¹æ³•ï¼Œåˆ°æ—¶å€™ç»“åˆè¿™é‡Œçš„ç†è§£
 */</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(p compositeTextMapPropagator)</span></span> Extract(ctx context.Context, carrier TextMapCarrier) context.Context {
	<span class="hljs-keyword">for</span> _, i := <span class="hljs-keyword">range</span> p {
		ctx = i.Extract(ctx, carrier)
	}
	<span class="hljs-keyword">return</span> ctx
}


<span class="hljs-comment">/*
è¿™ä¸ªä¸»è¦æ˜¯ å‘Šè¯‰ç”¨æˆ· è¿™äº›ä¼ æ’­å™¨ä¼šå‘ header æ”¾å…¥é‚£äº›å­—æ®µï¼Œæ¯”å¦‚æœ‰çš„ç³»ç»Ÿå¯¹ HTTP Header æœ‰å®‰å…¨ç™½åå•ï¼Œåªå…è®¸ä¿®æ”¹æŒ‡å®šçš„ Header é”®
è¿™ä¸ªæ—¶å€™å°±å¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè¿”å›æ‰€æœ‰ä¼ æ’­å™¨å‘headerå¡«å…¥çš„å­—æ®µ æ‹¿æˆ‘ä»¬è¿™ä¸ªä¸¾ä¾‹å­ï¼Œ["traceparent", "tracestate", "baggage"]
è¿”å›çš„æ˜¯é‡åçš„åˆ‡ç‰‡ï¼Œè§£é‡Šä¸€ä¸‹ å‰ä¸¤ä¸ªæ˜¯ç”± TraceContext è¿”å›çš„ å†…éƒ¨è‚¯å®šè¦å®ç°Fields()æ–¹æ³• è¿”å›å„è‡ªè¦å¡«å…¥çš„å­—æ®µ
traceparent: 00-4f9f9e8a7b6c5d4e3f2a1b0c9d8e7f6a-1a2b3c4d5e6f7a8b-01    æ ¼å¼ï¼š 00-TracerID-SpanID-01 ï¼ˆæ ¸å¿ƒï¼‰
tracestate: &lt;vendor1&gt;=&lt;value1&gt;,&lt;vendor2&gt;=&lt;value2&gt;,... è¿™ä¸ªå°±æ˜¯å¯é€‰çš„ç¬¬ä¸‰æ–¹çš„é”®å€¼å¯¹ï¼Œéæ ¸å¿ƒä½†æœ‰ç”¨ é¿å…æ±¡æŸ“æ ¸å¿ƒ
baggage: &lt;key1&gt;=&lt;value1&gt;,&lt;key2&gt;=&lt;value2&gt;,...  è¿™ä¸ªå°±çº¯è‡ªå·±ä¸šåŠ¡çš„é”®å€¼å¯¹ user_id=123  è‡ªå·±æƒ³å’‹å¡«å’‹å¡«
*/</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(p compositeTextMapPropagator)</span></span> Fields() []<span class="hljs-type">string</span> {
    <span class="hljs-comment">// ç”¨mapæ˜¯ç”¨äºå»é‡çš„ åˆ‡ç‰‡å»ä¸äº†é‡ è¿™æ ·åŠ è¿›å»è‡ªåŠ¨æ›´æ–°æˆæ–°çš„</span>
	unique := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">struct</span>{})
    <span class="hljs-comment">// è¿˜æ˜¯éå†æ‰€æœ‰çš„ä¼ æ’­å™¨</span>
	<span class="hljs-keyword">for</span> _, i := <span class="hljs-keyword">range</span> p {
		<span class="hljs-keyword">for</span> _, k := <span class="hljs-keyword">range</span> i.Fields() {
			unique[k] = <span class="hljs-keyword">struct</span>{}{}
		}
	}
	
    <span class="hljs-comment">// å†è½¬æ¢ä¸ºåˆ‡ç‰‡ è¿”å›</span>
	fields := <span class="hljs-built_in">make</span>([]<span class="hljs-type">string</span>, <span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(unique))
	<span class="hljs-keyword">for</span> k := <span class="hljs-keyword">range</span> unique {
		fields = <span class="hljs-built_in">append</span>(fields, k)
	}
	<span class="hljs-keyword">return</span> fields
}
</code></pre>
<h3 data-id="heading-15"><code>otel.SetErrorHandler(otel.ErrorHandlerFunc())</code> å‡½æ•°</h3>
<pre><code class="hljs language-bash" lang="bash">å†…å®¹è·Ÿ SetTracerProvider å’Œ SetTextMapPropagator ä¸€æ ·çš„ è¿™é‡Œä¸»è¦è¯´ä¸€ä¸‹ä¸ºä»€ä¹ˆè¦è®¾ç½®

å¦‚æœä¸è®¾ç½® OpenTelemetry å†…éƒ¨å‡ºé”™æ¯”å¦‚æŸä¸ªä¼ æ’­å™¨å®•æœºäº†æˆ–è€…æŸå¤„ panic æ•´ä¸ªæœåŠ¡æŒ‚äº†ï¼Œå®ƒä¹Ÿä¸çŸ¥é“è¯¥æ€ä¹ˆå¤„ç†è¿™ä¸ªé”™è¯¯
å½“è®¾ç½®ä¹‹åè‡ªåŠ¨è°ƒç”¨ä½ çš„ ErrorHandlerï¼Œä¸ä¼šå½±å“ä¸šåŠ¡ä»£ç 

é”™è¯¯å¤„ç†æµç¨‹

OpenTelemetry å†…éƒ¨å‘ç”Ÿé”™è¯¯
         â”‚
         â–¼
    otel.Handle(err)
         â”‚
         â–¼
    globalErrorHandler.Load() è·å– ErrorHandler
         â”‚
         â–¼
    ErrorHandler.Handle(err)
         â”‚
         â”œâ”€â†’ è®°å½•åˆ°æ—¥å¿—  //æˆ‘çš„ç¤ºä¾‹ä»£ç å°±åªæ˜¯ç®€å•çš„åšäº†è¿™ä¸ª
         â”œâ”€â†’ å‘é€åˆ°ç›‘æ§ ï¼ˆåç»­å¯é€‰ï¼‰
         â””â”€â†’ å‘é€å‘Šè­¦   ï¼ˆåç»­å¯é€‰ï¼‰
</code></pre>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº† <code>TracerProvider</code> çš„å®Œæ•´åˆå§‹åŒ–ã€‚ä¸‹ç¯‡å°†å¸¦å¤§å®¶è¿›å…¥å®æˆ˜ç¯èŠ‚ï¼Œçœ‹çœ‹å¦‚ä½•åˆ›å»º Spanã€å¦‚ä½•å®ç°è·¨æœåŠ¡çš„é“¾è·¯è¿½è¸ªã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3 è·¯ç”±å®Œå…¨æŒ‡å—ï¼šä»å…¥é—¨åˆ°å®æˆ˜ï¼Œæ–°æ‰‹ä¹Ÿèƒ½å¿«é€Ÿä¸Šæ‰‹]]></title>    <link>https://juejin.cn/post/7602916013877166095</link>    <guid>https://juejin.cn/post/7602916013877166095</guid>    <pubDate>2026-02-05T05:29:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602916013877166095" data-draft-id="7602825342229463074" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3 è·¯ç”±å®Œå…¨æŒ‡å—ï¼šä»å…¥é—¨åˆ°å®æˆ˜ï¼Œæ–°æ‰‹ä¹Ÿèƒ½å¿«é€Ÿä¸Šæ‰‹"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2026-02-05T05:29:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸æƒ³ç§ƒå¤´çš„ç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/2754702534251820"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3 è·¯ç”±å®Œå…¨æŒ‡å—ï¼šä»å…¥é—¨åˆ°å®æˆ˜ï¼Œæ–°æ‰‹ä¹Ÿèƒ½å¿«é€Ÿä¸Šæ‰‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2754702534251820/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸æƒ³ç§ƒå¤´çš„ç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T05:29:48.000Z" title="Thu Feb 05 2026 05:29:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Vue3 è·¯ç”±å®Œå…¨æŒ‡å—ï¼šä»å…¥é—¨åˆ°å®æˆ˜ï¼Œæ–°æ‰‹ä¹Ÿèƒ½å¿«é€Ÿä¸Šæ‰‹</h2>
<p>åœ¨ Vue3 é¡¹ç›®å¼€å‘ä¸­ï¼Œè·¯ç”±ï¼ˆVue Routerï¼‰æ˜¯ä¸å¯æˆ–ç¼ºçš„æ ¸å¿ƒæ¨¡å—â€”â€”å®ƒè´Ÿè´£ç®¡ç†é¡µé¢ä¹‹é—´çš„è·³è½¬ã€å®ç°ç»„ä»¶çš„æŒ‰éœ€åŠ è½½ã€å¤„ç†è·¯ç”±å‚æ•°ä¼ é€’ï¼Œç”šè‡³æ§åˆ¶é¡µé¢æƒé™ã€‚</p>
<p>å¾ˆå¤šåˆšæ¥è§¦ Vue3 çš„æ–°æ‰‹ï¼Œåœ¨ä½¿ç”¨è·¯ç”±æ—¶æ€»ä¼šé‡åˆ°å„ç§é—®é¢˜ï¼šVue3 è·¯ç”±å’Œ Vue2 æœ‰å“ªäº›åŒºåˆ«ï¼Ÿå¦‚ä½•é…ç½®è·¯ç”±ï¼ŸåµŒå¥—è·¯ç”±æ€ä¹ˆå®ç°ï¼Ÿè·¯ç”±å®ˆå«è¯¥æ€ä¹ˆç”¨ï¼Ÿ</p>
<p>ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œå°±å¸¦ä½ ä»é›¶åƒé€ Vue3 + Vue Router 4ï¼ˆè·¯ç”±æœ€æ–°ç‰ˆæœ¬ï¼‰çš„ä½¿ç”¨ï¼Œä»ç¯å¢ƒæ­å»ºã€åŸºç¡€é…ç½®åˆ°è¿›é˜¶æŠ€å·§ã€å®æˆ˜æ¡ˆä¾‹ï¼Œæ¯ä¸€æ­¥éƒ½æœ‰æ¸…æ™°ç¤ºä¾‹ï¼Œå¸®ä½ é¿å¼€å‘ç‚¹ï¼Œå¿«é€Ÿè¿ç”¨åˆ°å®é™…é¡¹ç›®ä¸­ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€å‰è¨€ï¼šVue3 è·¯ç”±çš„æ ¸å¿ƒå˜åŒ–</h3>
<p>é¦–å…ˆæ˜ç¡®ä¸€ä¸ªé‡ç‚¹ï¼šVue3 å¿…é¡»æ­é…<strong>Vue Router 4.x</strong> ç‰ˆæœ¬ï¼ˆä»¥ä¸‹ç®€ç§° Vue Routerï¼‰ï¼Œå®ƒå’Œ Vue2 å¯¹åº”çš„ Vue Router 3.x æœ‰ä¸€äº›æ ¸å¿ƒå·®å¼‚ï¼Œæ–°æ‰‹æ— éœ€æ·±ç©¶åº•å±‚ï¼Œä½†è¦è®°ä½è¿™å‡ ç‚¹å…³é”®å˜åŒ–ï¼š</p>
<ul>
<li>ä¸å†æ”¯æŒ <code>new VueRouter()</code>ï¼Œæ”¹ç”¨ <code>createRouter()</code> å·¥å‚å‡½æ•°åˆ›å»ºè·¯ç”±å®ä¾‹ï¼Œæ›´è´´åˆ Vue3 çš„ç»„åˆå¼ API é£æ ¼ã€‚</li>
<li>è·¯ç”±æ¨¡å¼çš„é…ç½®æ–¹å¼å˜åŒ–ï¼Œ<code>mode: 'history'</code> æ”¹ä¸º <code>history: createWebHistory()</code>ã€‚</li>
<li>æ”¯æŒç»„åˆå¼ API ç”¨æ³•ï¼Œæ–°å¢ <code>useRouter()</code>ã€<code>useRoute()</code> ç­‰é’©å­ï¼Œæ›¿ä»£ Vue2 ä¸­çš„ <code>this.$router</code>ã€<code>this.$route</code>ã€‚</li>
<li>ç§»é™¤äº† <code>router-link</code> çš„ <code>tag</code> å±æ€§ï¼Œæ”¹ç”¨<code>custom</code> + æ’æ§½å®ç°è‡ªå®šä¹‰æ ‡ç­¾ã€‚</li>
</ul>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»ç¯å¢ƒæ­å»ºå¼€å§‹ï¼Œä¸€æ­¥æ­¥å®ç° Vue3 è·¯ç”±çš„å„ç§ç”¨æ³•ã€‚</p>
<h3 data-id="heading-2">äºŒã€ç¯å¢ƒæ­å»ºï¼šå®‰è£… Vue Router 4</h3>
<p>é¦–å…ˆç¡®ä¿ä½ å·²ç»åˆ›å»ºäº† Vue3 é¡¹ç›®ï¼ˆæ¨èä½¿ç”¨ Vite åˆ›å»ºï¼Œæ•ˆç‡æ›´é«˜ï¼‰ï¼Œå¦‚æœè¿˜æ²¡æœ‰åˆ›å»ºï¼Œå…ˆæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">// åˆ›å»º Vue3 é¡¹ç›®ï¼ˆViteï¼‰
npm create vite@latest vue3-router-demo -- --template vue
cd vue3-router-demo
npm install

// å®‰è£… Vue Router 4ï¼ˆæ ¸å¿ƒæ­¥éª¤ï¼‰
npm install vue-router@4
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹é…ç½®è·¯ç”±äº†ã€‚</p>
<h3 data-id="heading-3">ä¸‰ã€åŸºç¡€é…ç½®ï¼šå®ç°ç®€å•çš„é¡µé¢è·³è½¬</h3>
<p>Vue3 è·¯ç”±çš„é…ç½®æ ¸å¿ƒåˆ†ä¸º 3 æ­¥ï¼š<strong>åˆ›å»ºè·¯ç”±å®ä¾‹ â†’ å®šä¹‰è·¯ç”±è§„åˆ™ â†’ åœ¨å…¥å£æ–‡ä»¶æŒ‚è½½è·¯ç”±</strong>ï¼Œä¸‹é¢æˆ‘ä»¬ä¸€æ­¥æ­¥æ“ä½œã€‚</p>
<h4 data-id="heading-4">1. æ–°å»ºè·¯ç”±é…ç½®æ–‡ä»¶</h4>
<p>åœ¨é¡¹ç›®çš„ <code>src</code> ç›®å½•ä¸‹ï¼Œæ–°å»º <code>router</code> æ–‡ä»¶å¤¹ï¼Œç„¶ååˆ›å»º <code>index.js</code> æ–‡ä»¶ï¼ˆè·¯ç”±çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼‰ï¼Œå†™å…¥ä»¥ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/router/index.js</span>
<span class="hljs-comment">// 1. å¼•å…¥å¿…è¦çš„ä¾èµ–</span>
<span class="hljs-keyword">import</span> { createRouter, createWebHistory } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>

<span class="hljs-comment">// 2. å¼•å…¥éœ€è¦è·³è½¬çš„ç»„ä»¶ï¼ˆé¡µé¢çº§ç»„ä»¶ï¼‰</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Home</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../views/Home.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">About</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../views/About.vue'</span>

<span class="hljs-comment">// 3. å®šä¹‰è·¯ç”±è§„åˆ™ï¼ˆæ•°ç»„å½¢å¼ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡å¯¹åº”ä¸€ä¸ªè·¯ç”±ï¼‰</span>
<span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>, <span class="hljs-comment">// è·¯ç”±è·¯å¾„ï¼ˆURL ä¸­æ˜¾ç¤ºçš„è·¯å¾„ï¼‰</span>
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Home'</span>, <span class="hljs-comment">// è·¯ç”±åç§°ï¼ˆå¯é€‰ï¼Œç”¨äºç¼–ç¨‹å¼å¯¼èˆªï¼‰</span>
    <span class="hljs-attr">component</span>: <span class="hljs-title class_">Home</span> <span class="hljs-comment">// è·¯ç”±å¯¹åº”çš„ç»„ä»¶</span>
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/about'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'About'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-title class_">About</span>
    <span class="hljs-comment">// ä¹Ÿå¯ä»¥ä½¿ç”¨æ‡’åŠ è½½ï¼ˆæ¨èï¼Œä¼˜åŒ–æ€§èƒ½ï¼‰</span>
    <span class="hljs-comment">// component: () =&gt; import('../views/About.vue')</span>
  }
]

<span class="hljs-comment">// 4. åˆ›å»ºè·¯ç”±å®ä¾‹</span>
<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>({
  <span class="hljs-attr">history</span>: <span class="hljs-title function_">createWebHistory</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">BASE_URL</span>), <span class="hljs-comment">// è·¯ç”±æ¨¡å¼ï¼ˆhistory æ¨¡å¼ï¼‰</span>
  routes <span class="hljs-comment">// ä¼ å…¥è·¯ç”±è§„åˆ™ï¼ˆç­‰åŒäº routes: routesï¼‰</span>
})

<span class="hljs-comment">// 5. å¯¼å‡ºè·¯ç”±å®ä¾‹ï¼ˆä¾›å…¥å£æ–‡ä»¶æŒ‚è½½ï¼‰</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router
</code></pre>
<h4 data-id="heading-5">2. æŒ‚è½½è·¯ç”±åˆ° Vue å®ä¾‹</h4>
<p>æ‰“å¼€é¡¹ç›®å…¥å£æ–‡ä»¶ <code>src/main.js</code>ï¼Œå¼•å…¥è·¯ç”±å®ä¾‹ï¼Œå¹¶ç”¨ <code>use()</code> æ–¹æ³•æŒ‚è½½ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/main.js</span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>
<span class="hljs-comment">// å¼•å…¥è·¯ç”±å®ä¾‹</span>
<span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">'./router'</span>

<span class="hljs-comment">// åˆ›å»º App å®ä¾‹ï¼Œå¹¶æŒ‚è½½è·¯ç”±</span>
<span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)
  .<span class="hljs-title function_">use</span>(router) <span class="hljs-comment">// æŒ‚è½½è·¯ç”±</span>
  .<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>)
</code></pre>
<h4 data-id="heading-6">3. æ–°å»ºé¡µé¢ç»„ä»¶</h4>
<p>åœ¨ <code>src</code> ç›®å½•ä¸‹ï¼Œæ–°å»º <code>views</code> æ–‡ä»¶å¤¹ï¼ˆç”¨äºå­˜æ”¾é¡µé¢çº§ç»„ä»¶ï¼‰ï¼Œåˆ†åˆ«åˆ›å»º <code>Home.vue</code> å’Œ <code>About.vue</code> ä¸¤ä¸ªç»„ä»¶ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/views/Home.vue</span>
&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"home"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>é¦–é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è¿™æ˜¯ Vue3 è·¯ç”±çš„é¦–é¡µé¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="hljs-comment">// src/views/About.vue</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"about"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>å…³äºæˆ‘ä»¬<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è¿™æ˜¯ Vue3 è·¯ç”±çš„å…³äºé¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-7">4. ä½¿ç”¨ router-link å’Œ router-view</h4>
<p>è·¯ç”±æŒ‚è½½å®Œæˆåï¼Œéœ€è¦åœ¨<code>App.vue</code> ä¸­ä½¿ç”¨ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼š</p>
<ul>
<li><code>&lt;router-link&gt;</code>ï¼šç”¨äºå®ç°è·¯ç”±è·³è½¬ï¼ˆç±»ä¼¼ a æ ‡ç­¾ï¼Œä½†ä¸ä¼šåˆ·æ–°é¡µé¢ï¼‰ï¼Œé»˜è®¤æ¸²æŸ“ä¸º a æ ‡ç­¾ã€‚</li>
<li><code>&lt;router-view&gt;</code>ï¼šç”¨äºæ¸²æŸ“å½“å‰è·¯ç”±å¯¹åº”çš„ç»„ä»¶ï¼ˆé¡µé¢å†…å®¹ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œï¼‰ã€‚</li>
</ul>
<p>ä¿®æ”¹ <code>App.vue</code> ä»£ç ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/App.vue</span>
&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- è·¯ç”±å¯¼èˆªï¼šè·³è½¬æŒ‰é’® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/"</span>&gt;</span>é¦–é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span> |
      <span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/about"</span>&gt;</span>å…³äºæˆ‘ä»¬<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>
    
    <span class="hljs-comment">&lt;!-- è·¯ç”±è§†å›¾ï¼šæ¸²æŸ“å½“å‰è·¯ç”±å¯¹åº”çš„ç»„ä»¶ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">router-view</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
<span class="hljs-comment">/* æ¿€æ´»è·¯ç”±çš„æ ·å¼ï¼ˆé»˜è®¤ç±»åï¼šrouter-link-activeï¼‰ */</span>
<span class="hljs-selector-class">.router-link-active</span> {
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#42b983</span>;
  <span class="hljs-attribute">text-decoration</span>: none;
  <span class="hljs-attribute">font-weight</span>: bold;
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-8">5. è¿è¡Œæµ‹è¯•</h4>
<p>æ‰§è¡Œ <code>npm run dev</code> å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®æœ¬åœ°åœ°å€ï¼Œç‚¹å‡»â€œé¦–é¡µâ€å’Œâ€œå…³äºæˆ‘ä»¬â€ï¼Œå°±èƒ½å®ç°é¡µé¢æ— åˆ·æ–°è·³è½¬ï¼Œå¹¶ä¸”æ¿€æ´»çš„è·¯ç”±ä¼šæ˜¾ç¤ºå¯¹åº”æ ·å¼â€”â€”è¿™å°±æ˜¯ Vue3 è·¯ç”±çš„åŸºç¡€ç”¨æ³•ï¼</p>
<h5 data-id="heading-9">è¡¥å……ï¼šè·¯ç”±æ‡’åŠ è½½ï¼ˆæ¨èä¼˜åŒ–ï¼‰</h5>
<p>ä¸Šé¢çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬ç›´æ¥å¼•å…¥äº† Home å’Œ About ç»„ä»¶ï¼Œè¿™ç§æ–¹å¼ä¼šåœ¨é¡¹ç›®æ‰“åŒ…æ—¶ï¼Œå°†æ‰€æœ‰é¡µé¢ç»„ä»¶æ‰“åŒ…åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå¯¼è‡´æ–‡ä»¶ä½“ç§¯è¿‡å¤§ï¼Œå½±å“é¦–å±åŠ è½½é€Ÿåº¦ã€‚</p>
<p>æ¨èä½¿ç”¨<strong>è·¯ç”±æ‡’åŠ è½½</strong>ï¼ˆæŒ‰éœ€åŠ è½½ï¼‰ï¼Œåªæœ‰å½“ç”¨æˆ·è®¿é—®è¯¥è·¯ç”±æ—¶ï¼Œæ‰ä¼šåŠ è½½å¯¹åº”çš„ç»„ä»¶ï¼Œä¼˜åŒ–é¦–å±æ€§èƒ½ï¼Œä¿®æ”¹è·¯ç”±è§„åˆ™å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/router/index.js</span>
<span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Home'</span>,
    <span class="hljs-comment">// æ‡’åŠ è½½å†™æ³•ï¼šç®­å¤´å‡½æ•° + import()</span>
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/Home.vue'</span>)
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/about'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'About'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/About.vue'</span>)
  }
]
</code></pre>
<h3 data-id="heading-10">å››ã€æ ¸å¿ƒç”¨æ³•ï¼šè·¯ç”±å‚æ•°ä¼ é€’</h3>
<p>å¼€å‘ä¸­ç»å¸¸éœ€è¦åœ¨é¡µé¢è·³è½¬æ—¶ä¼ é€’å‚æ•°ï¼ˆæ¯”å¦‚è¯¦æƒ…é¡µéœ€è¦æ¥æ”¶åˆ—è¡¨é¡µçš„ IDï¼‰ï¼ŒVue3 è·¯ç”±æ”¯æŒä¸¤ç§å¸¸ç”¨çš„å‚æ•°ä¼ é€’æ–¹å¼ï¼š<strong>åŠ¨æ€è·¯ç”±å‚æ•°</strong>å’Œ<strong>æŸ¥è¯¢å‚æ•°</strong>ã€‚</p>
<h4 data-id="heading-11">1. åŠ¨æ€è·¯ç”±å‚æ•°ï¼ˆæ¨èï¼Œç”¨äºä¼ é€’å¿…å¡«å‚æ•°ï¼‰</h4>
<p>åŠ¨æ€è·¯ç”±å‚æ•°æ˜¯å°†å‚æ•°åµŒå…¥åˆ°è·¯ç”±è·¯å¾„ä¸­ï¼Œæ ¼å¼ä¸º <code>path: '/xxx/:å‚æ•°å'</code>ï¼Œé€‚ç”¨äºè¯¦æƒ…é¡µã€ç¼–è¾‘é¡µç­‰éœ€è¦å”¯ä¸€æ ‡è¯†çš„åœºæ™¯ã€‚</p>
<h5 data-id="heading-12">æ­¥éª¤ 1ï¼šé…ç½®åŠ¨æ€è·¯ç”±</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/router/index.js</span>
<span class="hljs-comment">// å¼•å…¥è¯¦æƒ…é¡µç»„ä»¶</span>
<span class="hljs-keyword">const</span> routes = [
  <span class="hljs-comment">// å…¶ä»–è·¯ç”±...</span>
  {
    <span class="hljs-comment">// åŠ¨æ€è·¯ç”±ï¼šid æ˜¯å‚æ•°åï¼ˆå¯è‡ªå®šä¹‰ï¼‰</span>
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/user/:id'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'User'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/User.vue'</span>)
  }
]
</code></pre>
<h5 data-id="heading-13">æ­¥éª¤ 2ï¼šè·³è½¬æ—¶ä¼ é€’å‚æ•°</h5>
<p>æœ‰ä¸¤ç§è·³è½¬æ–¹å¼ï¼ˆå£°æ˜å¼å¯¼èˆª + ç¼–ç¨‹å¼å¯¼èˆªï¼‰ï¼Œåˆ†åˆ«å¯¹åº”å‚æ•°ä¼ é€’ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// 1. å£°æ˜å¼å¯¼èˆªï¼ˆrouter-linkï¼‰ï¼šç›´æ¥åœ¨ to ä¸­æ‹¼æ¥å‚æ•°</span>
&lt;router-link to=<span class="hljs-string">"/user/123"</span>&gt;ç”¨æˆ·<span class="hljs-number">123</span>&lt;/router-link&gt;
<span class="hljs-comment">// æˆ–è€…ç”¨å¯¹è±¡å½¢å¼ï¼ˆæ¨èï¼Œæ›´çµæ´»ï¼‰</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">:to</span>=<span class="hljs-string">"{ name: 'User', params: { id: 123 } }"</span>&gt;</span>ç”¨æˆ·123<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span></span>

<span class="hljs-comment">// 2. ç¼–ç¨‹å¼å¯¼èˆªï¼ˆuseRouterï¼‰ï¼šé€šè¿‡ push æ–¹æ³•ä¼ é€’</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// å¼•å…¥ useRouter é’©å­ï¼ˆç»„åˆå¼ APIï¼‰</span>
<span class="hljs-keyword">import</span> { useRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>
<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>()

<span class="hljs-comment">// è·³è½¬å¹¶ä¼ é€’å‚æ•°</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">goToUser</span> = (<span class="hljs-params"/>) =&gt; {
  router.<span class="hljs-title function_">push</span>({
    <span class="hljs-attr">name</span>: <span class="hljs-string">'User'</span>, <span class="hljs-comment">// å¿…é¡»ç”¨ name åŒ¹é…ï¼Œä¸èƒ½ç”¨ pathï¼ˆpath éœ€æ‰‹åŠ¨æ‹¼æ¥å‚æ•°ï¼‰</span>
    <span class="hljs-attr">params</span>: { <span class="hljs-attr">id</span>: <span class="hljs-number">123</span> }
  })
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h5 data-id="heading-14">æ­¥éª¤ 3ï¼šæ¥æ”¶åŠ¨æ€è·¯ç”±å‚æ•°</h5>
<p>åœ¨ç›®æ ‡ç»„ä»¶ï¼ˆUser.vueï¼‰ä¸­ï¼Œä½¿ç”¨ <code>useRoute()</code> é’©å­è·å–è·¯ç”±ä¿¡æ¯ï¼Œè¿›è€Œè·å–å‚æ•°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/views/User.vue</span>
&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ç”¨æˆ·è¯¦æƒ…é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ç”¨æˆ· IDï¼š{{ $route.params.id }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span> 
   <span class="hljs-comment">&lt;!-- æˆ–è€…ç”¨ç»„åˆå¼ APIï¼ˆæ¨èï¼‰ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ç”¨æˆ· IDï¼š{{ route.params.id }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// å¼•å…¥ useRoute é’©å­ï¼Œè·å–å½“å‰è·¯ç”±ä¿¡æ¯</span>
<span class="hljs-keyword">import</span> { useRoute } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>
<span class="hljs-keyword">const</span> route = <span class="hljs-title function_">useRoute</span>()

<span class="hljs-comment">// æ‰“å°å‚æ•°ï¼ˆå¯åœ¨ç”Ÿå‘½å‘¨æœŸæˆ–æ–¹æ³•ä¸­ä½¿ç”¨ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(route.<span class="hljs-property">params</span>.<span class="hljs-property">id</span>) <span class="hljs-comment">// è¾“å‡ºï¼š123</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-15">2. æŸ¥è¯¢å‚æ•°ï¼ˆç”¨äºä¼ é€’å¯é€‰å‚æ•°ï¼‰</h4>
<p>æŸ¥è¯¢å‚æ•°ç±»ä¼¼ GET è¯·æ±‚çš„å‚æ•°ï¼Œæ ¼å¼ä¸º<code>path?key=value&amp;key2=value2</code>ï¼Œé€‚ç”¨äºç­›é€‰ã€æœç´¢ç­‰å¯é€‰å‚æ•°åœºæ™¯ï¼Œä¸éœ€è¦ä¿®æ”¹è·¯ç”±é…ç½®ã€‚</p>
<h5 data-id="heading-16">æ­¥éª¤ 1ï¼šè·³è½¬æ—¶ä¼ é€’æŸ¥è¯¢å‚æ•°</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// 1. å£°æ˜å¼å¯¼èˆª</span>
&lt;router-link to=<span class="hljs-string">"/search?keyword=vue3&amp;page=1"</span>&gt;æœç´¢ <span class="hljs-title class_">Vue3</span>&lt;/router-link&gt;
<span class="hljs-comment">// æˆ–è€…ç”¨å¯¹è±¡å½¢å¼ï¼ˆæ¨èï¼‰</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">:to</span>=<span class="hljs-string">"{ 
  path: '/search', 
  query: { keyword: 'vue3', page: 1 } 
}"</span>&gt;</span>æœç´¢ Vue3<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span></span>

<span class="hljs-comment">// 2. ç¼–ç¨‹å¼å¯¼èˆª</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { useRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>
<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>()

<span class="hljs-keyword">const</span> <span class="hljs-title function_">goToSearch</span> = (<span class="hljs-params"/>) =&gt; {
  router.<span class="hljs-title function_">push</span>({
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/search'</span>,
    <span class="hljs-attr">query</span>: { <span class="hljs-attr">keyword</span>: <span class="hljs-string">'vue3'</span>, <span class="hljs-attr">page</span>: <span class="hljs-number">1</span> }
  })
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h5 data-id="heading-17">æ­¥éª¤ 2ï¼šæ¥æ”¶æŸ¥è¯¢å‚æ•°</h5>
<p>æ¥æ”¶æ–¹å¼å’ŒåŠ¨æ€è·¯ç”±å‚æ•°ç±»ä¼¼ï¼Œé€šè¿‡ <code>route.query</code> è·å–ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/views/Search.vue</span>
&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"search"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>æœç´¢é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>æœç´¢å…³é”®è¯ï¼š{{ route.query.keyword }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å½“å‰é¡µç ï¼š{{ route.query.page }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { useRoute } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>
<span class="hljs-keyword">const</span> route = <span class="hljs-title function_">useRoute</span>()

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(route.<span class="hljs-property">query</span>) <span class="hljs-comment">// è¾“å‡ºï¼š{ keyword: 'vue3', page: '1' }</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h5 data-id="heading-18">ä¸¤ç§å‚æ•°çš„åŒºåˆ«ï¼ˆé‡ç‚¹ï¼‰</h5>


























<table><thead><tr><th>å‚æ•°ç±»å‹</th><th>URL æ˜¾ç¤º</th><th>æ˜¯å¦éœ€è¦é…ç½®è·¯ç”±</th><th>é¡µé¢åˆ·æ–°åæ˜¯å¦ä¿ç•™</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>åŠ¨æ€è·¯ç”±å‚æ•°</td><td>/user/123ï¼ˆåµŒå…¥è·¯å¾„ï¼‰</td><td>æ˜¯ï¼ˆéœ€é…ç½® :idï¼‰</td><td>æ˜¯</td><td>å¿…å¡«å‚æ•°ï¼ˆè¯¦æƒ…é¡µ IDï¼‰</td></tr><tr><td>æŸ¥è¯¢å‚æ•°</td><td>/search?keyword=vue3ï¼ˆæ‹¼æ¥åœ¨è·¯å¾„åï¼‰</td><td>å¦</td><td>æ˜¯</td><td>å¯é€‰å‚æ•°ï¼ˆç­›é€‰ã€æœç´¢ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-19">äº”ã€è¿›é˜¶ç”¨æ³•ï¼šåµŒå¥—è·¯ç”±ã€è·¯ç”±å®ˆå«</h3>
<p>æŒæ¡åŸºç¡€ç”¨æ³•åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸¤ä¸ªå¼€å‘ä¸­é«˜é¢‘ä½¿ç”¨çš„è¿›é˜¶æŠ€å·§ï¼šåµŒå¥—è·¯ç”±å’Œè·¯ç”±å®ˆå«ã€‚</p>
<h4 data-id="heading-20">1. åµŒå¥—è·¯ç”±ï¼ˆå¤šçº§è·¯ç”±ï¼‰</h4>
<p>åµŒå¥—è·¯ç”±ç”¨äºå®ç°é¡µé¢çš„å¤šçº§å¯¼èˆªï¼ˆæ¯”å¦‚é¦–é¡µä¸‹æœ‰â€œæ¨èâ€â€œçƒ­é—¨â€ä¸¤ä¸ªå­é¡µé¢ï¼‰ï¼Œæ ¸å¿ƒæ˜¯åœ¨çˆ¶è·¯ç”±ä¸­æ·»åŠ  <code>children</code>æ•°ç»„ï¼Œé…ç½®å­è·¯ç”±è§„åˆ™ã€‚</p>
<h5 data-id="heading-21">ç¤ºä¾‹ï¼šå®ç°é¦–é¡µåµŒå¥—å­è·¯ç”±</h5>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/router/index.js</span>
<span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Home'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/Home.vue'</span>),
    <span class="hljs-comment">// å­è·¯ç”±ï¼ˆåµŒå¥—è·¯ç”±ï¼‰</span>
    <span class="hljs-attr">children</span>: [
      {
        <span class="hljs-attr">path</span>: <span class="hljs-string">''</span>, <span class="hljs-comment">// å­è·¯ç”±é»˜è®¤è·¯å¾„ï¼ˆè®¿é—® / æ—¶ï¼Œé»˜è®¤æ˜¾ç¤ºè¯¥å­ç»„ä»¶ï¼‰</span>
        <span class="hljs-attr">name</span>: <span class="hljs-string">'HomeRecommend'</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/HomeRecommend.vue'</span>)
      },
      {
        <span class="hljs-attr">path</span>: <span class="hljs-string">'hot'</span>, <span class="hljs-comment">// å­è·¯ç”±è·¯å¾„ï¼ˆå®Œæ•´è·¯å¾„ï¼š/hotï¼‰</span>
        <span class="hljs-attr">name</span>: <span class="hljs-string">'HomeHot'</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/HomeHot.vue'</span>)
      }
    ]
  }
]
</code></pre>
<p>ç„¶ååœ¨çˆ¶ç»„ä»¶ï¼ˆHome.vueï¼‰ä¸­ï¼Œæ·»åŠ  <code>&lt;router-view&gt;</code> æ¸²æŸ“å­è·¯ç”±ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/views/Home.vue</span>
&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"home"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>é¦–é¡µ<span class="hljs-symbol">&amp;lt;</span>/h1<span class="hljs-symbol">&amp;gt;</span>
    <span class="hljs-comment">&lt;!-- å­è·¯ç”±å¯¼èˆª --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"sub-nav"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/"</span>&gt;</span>æ¨è<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span> |
      <span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/hot"</span>&gt;</span>çƒ­é—¨<span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span>
    <span class="hljs-symbol">&amp;lt;</span>/div<span class="hljs-symbol">&amp;gt;</span>
    <span class="hljs-comment">&lt;!-- å­è·¯ç”±è§†å›¾ï¼šæ¸²æŸ“å­è·¯ç”±å¯¹åº”çš„ç»„ä»¶ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">router-view</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</span></code></pre>
<p>æ­¤æ—¶è®¿é—® <code>/</code>ï¼Œä¼šæ˜¾ç¤º Home ç»„ä»¶ + HomeRecommend ç»„ä»¶ï¼›è®¿é—® <code>/hot</code>ï¼Œä¼šæ˜¾ç¤º Home ç»„ä»¶ + HomeHot ç»„ä»¶ï¼Œå®ç°å¤šçº§å¯¼èˆªã€‚</p>
<h4 data-id="heading-22">2. è·¯ç”±å®ˆå«ï¼ˆè·¯ç”±æ‹¦æˆªï¼‰</h4>
<p>è·¯ç”±å®ˆå«ç”¨äºåœ¨è·¯ç”±è·³è½¬å‰ã€è·³è½¬åæ‰§è¡Œä¸€äº›é€»è¾‘ï¼ˆæ¯”å¦‚æƒé™åˆ¤æ–­ã€é¡µé¢åŸ‹ç‚¹ã€å–æ¶ˆè¯·æ±‚ï¼‰ï¼ŒVue Router 4 æ”¯æŒ 3 ç§å¸¸ç”¨å®ˆå«ï¼š<strong>å…¨å±€å®ˆå«</strong>ã€<strong>è·¯ç”±ç‹¬äº«å®ˆå«</strong>ã€<strong>ç»„ä»¶å†…å®ˆå«</strong>ã€‚</p>
<h5 data-id="heading-23">ï¼ˆ1ï¼‰å…¨å±€å®ˆå«ï¼ˆå½±å“æ‰€æœ‰è·¯ç”±ï¼‰</h5>
<p>åœ¨è·¯ç”±é…ç½®æ–‡ä»¶ä¸­å®šä¹‰ï¼Œé€‚ç”¨äºå…¨å±€æƒé™æ§åˆ¶ï¼ˆæ¯”å¦‚æœªç™»å½•ç¦æ­¢è®¿é—®ä¸ªäººä¸­å¿ƒï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/router/index.js</span>
<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>({ ... })

<span class="hljs-comment">// 1. å…¨å±€å‰ç½®å®ˆå«ï¼ˆè·³è½¬å‰æ‰§è¡Œï¼Œæœ€å¸¸ç”¨ï¼‰</span>
router.<span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span>, next</span>) =&gt;</span> {
  <span class="hljs-comment">// toï¼šå³å°†è·³è½¬çš„è·¯ç”±ä¿¡æ¯</span>
  <span class="hljs-comment">// fromï¼šå½“å‰è¦ç¦»å¼€çš„è·¯ç”±ä¿¡æ¯</span>
  <span class="hljs-comment">// next()ï¼šæ”¾è¡Œï¼›next('/login')ï¼šå¼ºåˆ¶è·³è½¬ï¼›next(false)ï¼šå–æ¶ˆè·³è½¬</span>
  
  <span class="hljs-comment">// ç¤ºä¾‹ï¼šæœªç™»å½•ç¦æ­¢è®¿é—® /user</span>
  <span class="hljs-keyword">const</span> isLogin = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'token'</span>) <span class="hljs-comment">// æ¨¡æ‹Ÿç™»å½•çŠ¶æ€</span>
  <span class="hljs-keyword">if</span> (to.<span class="hljs-property">path</span> === <span class="hljs-string">'/user'</span> &amp;&amp; !isLogin) {
    <span class="hljs-comment">// æœªç™»å½•ï¼Œå¼ºåˆ¶è·³è½¬åˆ°ç™»å½•é¡µ</span>
    <span class="hljs-title function_">next</span>(<span class="hljs-string">'/login'</span>)
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// å·²ç™»å½•ï¼Œæ”¾è¡Œ</span>
    <span class="hljs-title function_">next</span>()
  }
})

<span class="hljs-comment">// 2. å…¨å±€åç½®å®ˆå«ï¼ˆè·³è½¬åæ‰§è¡Œï¼Œç”¨äºåŸ‹ç‚¹ã€ä¿®æ”¹é¡µé¢æ ‡é¢˜ï¼‰</span>
router.<span class="hljs-title function_">afterEach</span>(<span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span></span>) =&gt;</span> {
  <span class="hljs-comment">// ä¿®æ”¹é¡µé¢æ ‡é¢˜</span>
  <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = to.<span class="hljs-property">name</span> || <span class="hljs-string">'Vue3 è·¯ç”±æ¼”ç¤º'</span>
  <span class="hljs-comment">// é¡µé¢åŸ‹ç‚¹ï¼ˆç¤ºä¾‹ï¼‰</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`è·³è½¬è‡³ï¼š<span class="hljs-subst">${to.path}</span>`</span>)
})

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router
</code></pre>
<h5 data-id="heading-24">ï¼ˆ2ï¼‰ç»„ä»¶å†…å®ˆå«ï¼ˆå½±å“å½“å‰ç»„ä»¶ï¼‰</h5>
<p>åœ¨ç»„ä»¶å†…éƒ¨å®šä¹‰ï¼Œé€‚ç”¨äºå½“å‰ç»„ä»¶çš„è·¯ç”±æ‹¦æˆªï¼ˆæ¯”å¦‚ç¦»å¼€ç»„ä»¶æ—¶æç¤ºä¿å­˜ï¼‰ï¼ŒVue3 ç»„åˆå¼ API ä¸­ä½¿ç”¨<code>onBeforeRouteEnter</code>ã€<code>onBeforeRouteLeave</code> ç­‰é’©å­ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/views/Edit.vueï¼ˆç¼–è¾‘é¡µï¼‰</span>
&lt;script setup&gt;
<span class="hljs-keyword">import</span> { onBeforeRouteLeave } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>

<span class="hljs-comment">// ç»„ä»¶å†…å®ˆå«ï¼šç¦»å¼€å½“å‰ç»„ä»¶æ—¶æ‰§è¡Œ</span>
<span class="hljs-title function_">onBeforeRouteLeave</span>(<span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span>, next</span>) =&gt;</span> {
  <span class="hljs-comment">// ç¤ºä¾‹ï¼šæç¤ºç”¨æˆ·ä¿å­˜å†…å®¹</span>
  <span class="hljs-keyword">const</span> isSave = <span class="hljs-title function_">confirm</span>(<span class="hljs-string">'å†…å®¹æœªä¿å­˜ï¼Œç¡®å®šè¦ç¦»å¼€å—ï¼Ÿ'</span>)
  <span class="hljs-keyword">if</span> (isSave) {
    <span class="hljs-title function_">next</span>() <span class="hljs-comment">// ç¡®è®¤ç¦»å¼€ï¼Œæ”¾è¡Œ</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">next</span>(<span class="hljs-literal">false</span>) <span class="hljs-comment">// å–æ¶ˆç¦»å¼€</span>
  }
})
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-25">å…­ã€å®æˆ˜æ¡ˆä¾‹ï¼šå®ç°ç™»å½•è·³è½¬+æƒé™æ§åˆ¶</h3>
<p>ç»“åˆä¸Šé¢çš„çŸ¥è¯†ç‚¹ï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ªå¸¸è§çš„å®æˆ˜åœºæ™¯ï¼šæœªç™»å½•ç”¨æˆ·è®¿é—®ä¸ªäººä¸­å¿ƒæ—¶ï¼Œè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µï¼Œç™»å½•æˆåŠŸåè·³è½¬å›ä¸ªäººä¸­å¿ƒã€‚</p>
<h4 data-id="heading-26">1. é…ç½®è·¯ç”±</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/router/index.js</span>
<span class="hljs-keyword">const</span> routes = [
  { <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>, <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/Home.vue'</span>) },
  { <span class="hljs-attr">path</span>: <span class="hljs-string">'/login'</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Login'</span>, <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/Login.vue'</span>) },
  { 
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/user'</span>, 
    <span class="hljs-attr">name</span>: <span class="hljs-string">'User'</span>, 
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/User.vue'</span>),
    <span class="hljs-attr">meta</span>: { <span class="hljs-attr">requiresAuth</span>: <span class="hljs-literal">true</span> } <span class="hljs-comment">// æ ‡è®°è¯¥è·¯ç”±éœ€è¦ç™»å½•æƒé™</span>
  }
]

<span class="hljs-comment">// å…¨å±€å‰ç½®å®ˆå«ï¼šæƒé™æ§åˆ¶</span>
router.<span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span>, next</span>) =&gt;</span> {
  <span class="hljs-comment">// åˆ¤æ–­å½“å‰è·¯ç”±æ˜¯å¦éœ€è¦ç™»å½•</span>
  <span class="hljs-keyword">if</span> (to.<span class="hljs-property">meta</span>.<span class="hljs-property">requiresAuth</span>) {
    <span class="hljs-keyword">const</span> token = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'token'</span>)
    <span class="hljs-keyword">if</span> (token) {
      <span class="hljs-comment">// å·²ç™»å½•ï¼Œæ”¾è¡Œ</span>
      <span class="hljs-title function_">next</span>()
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// æœªç™»å½•ï¼Œè·³è½¬åˆ°ç™»å½•é¡µï¼Œå¹¶è®°å½•å½“å‰è·¯ç”±ï¼ˆç™»å½•åè·³è½¬å›æ¥ï¼‰</span>
      <span class="hljs-title function_">next</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'Login'</span>, <span class="hljs-attr">query</span>: { <span class="hljs-attr">redirect</span>: to.<span class="hljs-property">path</span> } })
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// ä¸éœ€è¦ç™»å½•ï¼Œæ”¾è¡Œ</span>
    <span class="hljs-title function_">next</span>()
  }
})
</code></pre>
<h4 data-id="heading-27">2. ç™»å½•ç»„ä»¶ï¼ˆLogin.vueï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/views/Login.vue</span>
&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"login"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ç™»å½•é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"login"</span>&gt;</span>æ¨¡æ‹Ÿç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { useRouter, useRoute } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>
<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>()
<span class="hljs-keyword">const</span> route = <span class="hljs-title function_">useRoute</span>()

<span class="hljs-keyword">const</span> <span class="hljs-title function_">login</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// æ¨¡æ‹Ÿç™»å½•ï¼šå­˜å‚¨ token</span>
  <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'token'</span>, <span class="hljs-string">'vue3-router-demo-token'</span>)
  
  <span class="hljs-comment">// è·å–ç™»å½•å‰çš„è·³è½¬è·¯å¾„ï¼ˆå¦‚æœæœ‰ï¼Œå°±è·³å›å»ï¼›æ²¡æœ‰å°±è·³é¦–é¡µï¼‰</span>
  <span class="hljs-keyword">const</span> redirect = route.<span class="hljs-property">query</span>.<span class="hljs-property">redirect</span> || <span class="hljs-string">'/'</span>
  router.<span class="hljs-title function_">push</span>(redirect)
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-28">3. ä¸ªäººä¸­å¿ƒç»„ä»¶ï¼ˆUser.vueï¼‰</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/views/User.vue</span>
&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ä¸ªäººä¸­å¿ƒ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"logout"</span>&gt;</span>é€€å‡ºç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { useRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>
<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>()

<span class="hljs-keyword">const</span> <span class="hljs-title function_">logout</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// æ¨¡æ‹Ÿé€€å‡ºï¼šæ¸…é™¤ token</span>
  <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">removeItem</span>(<span class="hljs-string">'token'</span>)
  <span class="hljs-comment">// è·³è½¬åˆ°ç™»å½•é¡µ</span>
  router.<span class="hljs-title function_">push</span>(<span class="hljs-string">'/login'</span>)
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<p>æµ‹è¯•æµç¨‹ï¼šè®¿é—® <code>/user</code> â†’ æœªç™»å½•ï¼Œè‡ªåŠ¨è·³è½¬åˆ° <code>/login?redirect=/user</code> â†’ ç‚¹å‡»ç™»å½• â†’ è·³å› <code>/user</code> â†’ ç‚¹å‡»é€€å‡ºç™»å½• â†’ è·³å› <code>/login</code>ï¼Œå®Œç¾å®ç°æƒé™æ§åˆ¶ï¼</p>
<h3 data-id="heading-29">ä¸ƒã€é¿å‘æŒ‡å—ï¼ˆæ–°æ‰‹å¿…çœ‹ï¼‰</h3>
<ol>
<li>Vue3 å¿…é¡»ä½¿ç”¨ Vue Router 4.xï¼Œä¸èƒ½ä½¿ç”¨ 3.x ç‰ˆæœ¬ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼ˆç‰ˆæœ¬ä¸å…¼å®¹ï¼‰ã€‚</li>
<li>ç»„åˆå¼ API ä¸­ï¼Œä¸è¦åœ¨ <code>&lt;script setup&gt;</code> ä¸­ä½¿ç”¨ <code>this.$router</code>ã€<code>this.$route</code>ï¼Œå¿…é¡»ç”¨<code>useRouter()</code>ã€<code>useRoute()</code> é’©å­ã€‚</li>
<li>åŠ¨æ€è·¯ç”±å‚æ•°è·³è½¬æ—¶ï¼Œç”¨ <code>name</code>åŒ¹é…è·¯ç”±ï¼Œä¸è¦ç”¨ <code>path</code>ï¼ˆç”¨ path ä¼šå¯¼è‡´ params å‚æ•°å¤±æ•ˆï¼‰ã€‚</li>
<li>è·¯ç”±æ‡’åŠ è½½æ—¶ï¼Œç»„ä»¶è·¯å¾„ä¸è¦å†™é”™ï¼ˆç›¸å¯¹è·¯å¾„è¦æ­£ç¡®ï¼Œæ¯”å¦‚ <code>../views/Home.vue</code>ï¼Œä¸è¦å†™æˆ <code>./views/Home.vue</code>ï¼‰ã€‚</li>
<li>åµŒå¥—è·¯ç”±çš„å­è·¯ç”± <code>path</code> ä¸è¦åŠ  <code>/</code>ï¼Œå¦åˆ™ä¼šè¢«å½“ä½œæ ¹è·¯ç”±ï¼ˆæ¯”å¦‚å­è·¯ç”± path å†™ <code>'hot'</code>ï¼Œä¸è¦å†™ <code>'/hot'</code>ï¼‰ã€‚</li>
<li>å…¨å±€å‰ç½®å®ˆå«ä¸­ï¼Œå¿…é¡»è°ƒç”¨ <code>next()</code>ã€<code>next('/xxx')</code> æˆ– <code>next(false)</code>ï¼Œå¦åˆ™è·¯ç”±ä¼šå¡ä½ï¼Œæ— æ³•è·³è½¬ã€‚</li>
</ol>
<h3 data-id="heading-30">å…«ã€æ€»ç»“</h3>
<p>Vue3 + Vue Router 4 çš„æ ¸å¿ƒç”¨æ³•å…¶å®å¹¶ä¸å¤æ‚ï¼Œå…³é”®æ˜¯æŒæ¡ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>åŸºç¡€é…ç½®ï¼š<code>createRouter()</code> åˆ›å»ºå®ä¾‹ â†’ æŒ‚è½½åˆ° Vue å®ä¾‹ â†’ ç”¨ <code>router-link</code> å’Œ <code>router-view</code> å®ç°è·³è½¬å’Œæ¸²æŸ“ã€‚</li>
<li>å‚æ•°ä¼ é€’ï¼šåŠ¨æ€è·¯ç”±å‚æ•°ï¼ˆå¿…å¡«ï¼‰å’ŒæŸ¥è¯¢å‚æ•°ï¼ˆå¯é€‰ï¼‰ï¼Œæ¥æ”¶ç”¨<code>route.params</code> å’Œ <code>route.query</code>ã€‚</li>
<li>è¿›é˜¶æŠ€å·§ï¼šåµŒå¥—è·¯ç”±ç”¨ <code>children</code> é…ç½®ï¼Œæƒé™æ§åˆ¶ç”¨å…¨å±€å‰ç½®å®ˆå«ã€‚</li>
<li>æ€§èƒ½ä¼˜åŒ–ï¼šè·¯ç”±æ‡’åŠ è½½æŒ‰éœ€åŠ è½½ç»„ä»¶ï¼Œæå‡é¦–å±é€Ÿåº¦ã€‚</li>
</ul>
<p>æœ¬æ–‡æ¶µç›–äº† Vue3 è·¯ç”±çš„æ‰€æœ‰é«˜é¢‘ç”¨æ³•ï¼Œä»åŸºç¡€åˆ°å®æˆ˜ï¼Œæ¯ä¸€æ­¥éƒ½æœ‰æ¸…æ™°ç¤ºä¾‹ï¼Œæ–°æ‰‹å¯ä»¥è·Ÿç€æ­¥éª¤ä¸€æ­¥æ­¥æ“ä½œï¼Œå¾ˆå¿«å°±èƒ½ä¸Šæ‰‹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026 å¹´ï¼Œæˆ‘ä»¬ç»ˆäºä¸ä»…ä¸ºäº†â€œå°‘å†™ä»£ç â€è€Œæ”¾å¼ƒ Reduxï¼Œæ›´æ˜¯ä¸ºäº†æ€§èƒ½]]></title>    <link>https://juejin.cn/post/7602901195154079796</link>    <guid>https://juejin.cn/post/7602901195154079796</guid>    <pubDate>2026-02-05T05:29:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7602901195154079796" data-draft-id="7602929352716435456" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026 å¹´ï¼Œæˆ‘ä»¬ç»ˆäºä¸ä»…ä¸ºäº†â€œå°‘å†™ä»£ç â€è€Œæ”¾å¼ƒ Reduxï¼Œæ›´æ˜¯ä¸ºäº†æ€§èƒ½"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,React.js"/> <meta itemprop="datePublished" content="2026-02-05T05:29:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="404æ˜Ÿçƒçš„çŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/193147068224126"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026 å¹´ï¼Œæˆ‘ä»¬ç»ˆäºä¸ä»…ä¸ºäº†â€œå°‘å†™ä»£ç â€è€Œæ”¾å¼ƒ Reduxï¼Œæ›´æ˜¯ä¸ºäº†æ€§èƒ½
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/193147068224126/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    404æ˜Ÿçƒçš„çŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-05T05:29:32.000Z" title="Thu Feb 05 2026 05:29:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-05
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1. å¼•è¨€ï¼šRedux çš„é»„æ˜</h2>
<p>åœ¨ 2020 å¹´ï¼ŒRedux Toolkit (RTK) çš„å‡ºç°æŒ½æ•‘äº† Redux çš„å£ç¢‘ã€‚å®ƒæ¶ˆé™¤äº† boilerplateï¼Œè®© Redux å˜å¾—â€œèƒ½ç”¨â€ã€‚</p>
<p>ä½†åœ¨ 2026 å¹´çš„ä»Šå¤©ï¼Œå½“æˆ‘ä»¬é¢å¯¹è¶Šæ¥è¶Šå¤æ‚çš„äº¤äº’å’Œå¯¹æ€§èƒ½çš„æè‡´è¿½æ±‚æ—¶ï¼ŒRTK ä¾ç„¶æ˜¾å¾—å¤ªé‡äº†ã€‚æˆ‘ä»¬å†³å®šå…¨é¢è½¬å‘ Zustandï¼Œè¿™ä¸ä»…æ˜¯ä¸ºäº†å°‘å†™ä»£ç ï¼Œæ›´æ˜¯ä¸ºäº†<strong>æ€§èƒ½</strong>ã€‚</p>
<h2 data-id="heading-1">2. æ ¸å¿ƒå·®å¼‚ï¼šé€‰æ‹©å™¨æœºåˆ¶çš„é™ç»´æ‰“å‡»</h2>
<p>ä¸ºä»€ä¹ˆè¯´ Zustand æ€§èƒ½æ›´å¥½ï¼Ÿè¿™æ¶‰åŠåˆ° React æ¸²æŸ“åŸç†çš„æ ¹æœ¬å·®å¼‚ã€‚</p>
<h3 data-id="heading-2">2.1 ä¸Šä¸‹æ–‡ (Context) çš„é™·é˜±</h3>
<p>Redux ä¾èµ– React Context ä¼ é€’ Storeã€‚è™½ç„¶ <code>react-redux</code> åšäº†å¤§é‡ä¼˜åŒ–ï¼Œä½†åœ¨å¤§å‹åº”ç”¨ä¸­ï¼ŒContext Provider çš„æ›´æ–°ä¾ç„¶å®¹æ˜“å¼•å‘â€œç€‘å¸ƒå¼â€çš„æ— æ•ˆæ¸²æŸ“æ£€æŸ¥ã€‚</p>
<h3 data-id="heading-3">2.2 Zustand çš„å¤–éƒ¨å­˜å‚¨</h3>
<p>Zustand çš„ Store å­˜åœ¨äº React ç»„ä»¶æ ‘ä¹‹å¤–ã€‚å®ƒé€šè¿‡è®¢é˜…æ¨¡å¼ (Subscription) ç²¾ç¡®é€šçŸ¥ç»„ä»¶ã€‚åªæœ‰å½“ç»„ä»¶ <code>useStore(selector)</code> è¿”å›çš„å€¼å‘ç”Ÿæµ…æ¯”è¾ƒå˜åŒ–æ—¶ï¼Œç»„ä»¶æ‰ä¼šé‡ç»˜ã€‚</p>
<p><strong>åŸç†ç»“è®º</strong>ï¼šRedux æ˜¯è‡ªä¸Šè€Œä¸‹çš„å¹¿æ’­ï¼ŒZustand æ˜¯ç‚¹å¯¹ç‚¹çš„ç²¾å‡†æŠ•é€ã€‚</p>
<h2 data-id="heading-4">3. æ•°æ®è¯´è¯ï¼š10å€çš„å·®è·</h2>
<p>æˆ‘ä»¬å¯¹ä¸€ä¸ªåŒ…å« 5000 ä¸ªåˆ—è¡¨é¡¹çš„çœ‹æ¿åº”ç”¨è¿›è¡Œäº†é‡æ„å¯¹æ¯”ï¼š</p>
<ul>
<li>
<p><strong>Bundle Size (Gzip)</strong>: Redux Toolkit (12.4KB) vs Zustand (1.1KB)ã€‚Zustand è½»äº† 10 å€ã€‚</p>
</li>
<li>
<p><strong>Re-renders</strong>: åœ¨é«˜é¢‘æ‹–æ‹½åœºæ™¯ä¸‹ï¼ŒZustand çš„æ— æ•ˆæ¸²æŸ“æ¬¡æ•°å‡å°‘äº† 65%ã€‚</p>
</li>
<li>
<p><strong>Boilerplate</strong>: å®šä¹‰ä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨ï¼ŒRTK éœ€è¦ åˆ›å»º Sliceã€å¯¼å‡º Actionã€é…ç½® Storeï¼›Zustand åªéœ€è¦ 4 è¡Œä»£ç ã€‚</p>
</li>
</ul>
<h2 data-id="heading-5">4. ä»£ç å®æˆ˜ï¼šä»ç¹çåˆ°æç®€</h2>
<h3 data-id="heading-6">Before: Redux Toolkit</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// 1. Slice</span>
<span class="hljs-keyword">const</span> counterSlice = <span class="hljs-title function_">createSlice</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'counter'</span>,
  <span class="hljs-attr">initialState</span>: { <span class="hljs-attr">value</span>: <span class="hljs-number">0</span> },
  <span class="hljs-attr">reducers</span>: {
    <span class="hljs-attr">increment</span>: <span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> { state.<span class="hljs-property">value</span> += <span class="hljs-number">1</span> }
  }
})
<span class="hljs-comment">// 2. Store</span>
<span class="hljs-keyword">const</span> store = <span class="hljs-title function_">configureStore</span>({ <span class="hljs-attr">reducer</span>: { <span class="hljs-attr">counter</span>: counterSlice.<span class="hljs-property">reducer</span> } })
<span class="hljs-comment">// 3. Component</span>
<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">useSelector</span>(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.<span class="hljs-property">counter</span>.<span class="hljs-property">value</span>)
<span class="hljs-keyword">const</span> dispatch = <span class="hljs-title function_">useDispatch</span>()
<span class="hljs-comment">// call</span>
<span class="hljs-title function_">dispatch</span>(counterSlice.<span class="hljs-property">actions</span>.<span class="hljs-title function_">increment</span>())
</code></pre>
<h3 data-id="heading-7">After: Zustand</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// 1. Store &amp; Hook (All in one)</span>
<span class="hljs-keyword">const</span> useStore = <span class="hljs-title function_">create</span>(<span class="hljs-function"><span class="hljs-params">set</span> =&gt;</span> ({
  <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">increment</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">set</span>(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> ({ <span class="hljs-attr">count</span>: state.<span class="hljs-property">count</span> + <span class="hljs-number">1</span> }))
}))

<span class="hljs-comment">// 2. Component</span>
<span class="hljs-keyword">const</span> { count, increment } = <span class="hljs-title function_">useStore</span>()
</code></pre>
<p>Zustand å°† State å’Œ Actions å°è£…åœ¨ä¸€èµ·ï¼ŒHook æ—¢æ˜¯ Store ä¹Ÿæ˜¯ Accessorã€‚è¿™ç§å¿ƒæ™ºæ¨¡å‹æ¯” Redux çš„ Flux æ¶æ„æ›´åŠ ç›´è§‚ã€‚</p>
<h2 data-id="heading-8">5. è¿ç§»ç­–ç•¥ï¼šå’Œå¹³å…±å¤„</h2>
<p>ä¸€å®šè¦ä¸€æŠŠæ¢­é‡æ„å—ï¼Ÿä¸ã€‚</p>
<ul>
<li>
<p><strong>æ–°åŠŸèƒ½ä¼˜å…ˆ</strong>ï¼šå¯¹äºæ–°çš„ä¾§è¾¹æ ã€æ¨¡æ€æ¡†çŠ¶æ€ï¼Œç›´æ¥ç”¨ Zustandã€‚</p>
</li>
<li>
<p><strong>Redux ç˜¦èº«</strong>ï¼šé€æ­¥å°† Redux ä¸­çš„åŒæ­¥ UI çŠ¶æ€ (UI State) æ‹†åˆ†åˆ° Zustandï¼Œåªä¿ç•™å¤æ‚çš„æœåŠ¡å™¨ç¼“å­˜æ•°æ® (æˆ–è€…äº¤ç»™ TanStack Query)ã€‚</p>
</li>
<li>
<p><strong>åŒå‘æ¡¥æ¥</strong>ï¼šç”šè‡³å¯ä»¥åœ¨ Redux ä¸­ dispatch Zustand actionsï¼Œåä¹‹äº¦ç„¶ï¼Œå®ç°å¹³æ»‘è¿‡æ¸¡ã€‚</p>
</li>
</ul>
<h2 data-id="heading-9">6. æ€»ç»“</h2>
<p>Redux è¿™ä½è€å°†å®Œæˆäº†å®ƒçš„å†å²ä½¿å‘½ã€‚åœ¨ 2026 å¹´ï¼Œå¦‚æœä½ ä¾ç„¶åœ¨å†™ <code>dispatch({ type: ... })</code>ï¼Œé‚£å°±åƒåœ¨å¼€æ‰‹åŠ¨æŒ¡çš„æ±½è½¦â€”â€”è™½ç„¶ç¡¬æ ¸ï¼Œä½†ç¡®å®ä¸å¤Ÿå¿«ã€‚</p>
<p>æ‹¥æŠ± Zustandï¼ŒæŠŠæ€§èƒ½ä¼˜åŒ–äº¤ç»™åº“ä½œè€…ï¼ŒæŠŠæ—¶é—´ç•™ç»™ä¸šåŠ¡é€»è¾‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>